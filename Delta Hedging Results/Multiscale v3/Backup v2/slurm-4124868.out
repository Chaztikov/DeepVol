WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-17 01:28:57.967982: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-17 01:28:58.225236: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-12-17 01:28:58.225783: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 01:28:58.227698: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-17 01:28:58.229501: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-17 01:28:58.230449: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-17 01:28:58.232723: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-17 01:28:58.234535: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-17 01:28:58.239354: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-17 01:28:58.281806: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-17 01:28:58.282192: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-17 01:28:58.288962: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2399950000 Hz
2019-12-17 01:28:58.289156: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5634edfa18f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-17 01:28:58.289175: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-17 01:28:58.311346: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-12-17 01:28:58.311379: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 01:28:58.311394: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-17 01:28:58.311405: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-17 01:28:58.311417: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-17 01:28:58.311428: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-17 01:28:58.311439: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-17 01:28:58.311450: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-17 01:28:58.356645: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-17 01:28:58.356688: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 01:28:59.156655: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-17 01:28:59.156691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-17 01:28:59.156702: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-17 01:28:59.224871: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2019-12-17 01:28:59.227042: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5634ee5daac0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-17 01:28:59.227061: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
INFO   Y0_true: -1.0000e+00
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-17 01:29:17.355655: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 7.9985e+01,   Y0: 2.5375e+00,  elapsed time  18
INFO   step:     1,    loss: 6.8099e+01,   Y0: 2.5325e+00,  elapsed time  26
INFO   step:     2,    loss: 6.8091e+01,   Y0: 2.5303e+00,  elapsed time  27
INFO   step:     3,    loss: 6.8083e+01,   Y0: 2.5267e+00,  elapsed time  29
INFO   step:     4,    loss: 6.8073e+01,   Y0: 2.5226e+00,  elapsed time  31
INFO   step:     5,    loss: 6.8062e+01,   Y0: 2.5204e+00,  elapsed time  32
INFO   step:     6,    loss: 6.8050e+01,   Y0: 2.5185e+00,  elapsed time  34
INFO   step:     7,    loss: 6.8037e+01,   Y0: 2.5166e+00,  elapsed time  35
INFO   step:     8,    loss: 6.8025e+01,   Y0: 2.5136e+00,  elapsed time  37
INFO   step:     9,    loss: 6.8013e+01,   Y0: 2.5104e+00,  elapsed time  39
INFO   step:    10,    loss: 6.8004e+01,   Y0: 2.5073e+00,  elapsed time  40
INFO   step:    11,    loss: 6.7997e+01,   Y0: 2.5043e+00,  elapsed time  42
INFO   step:    12,    loss: 6.7990e+01,   Y0: 2.5014e+00,  elapsed time  44
INFO   step:    13,    loss: 6.7983e+01,   Y0: 2.5002e+00,  elapsed time  45
INFO   step:    14,    loss: 6.7977e+01,   Y0: 2.4996e+00,  elapsed time  47
INFO   step:    15,    loss: 6.7970e+01,   Y0: 2.4993e+00,  elapsed time  49
INFO   step:    16,    loss: 6.7963e+01,   Y0: 2.4994e+00,  elapsed time  50
INFO   step:    17,    loss: 6.7956e+01,   Y0: 2.4995e+00,  elapsed time  52
INFO   step:    18,    loss: 6.7948e+01,   Y0: 2.4985e+00,  elapsed time  54
INFO   step:    19,    loss: 6.7940e+01,   Y0: 2.4979e+00,  elapsed time  55
INFO   step:    20,    loss: 6.7931e+01,   Y0: 2.4972e+00,  elapsed time  57
INFO   step:    21,    loss: 6.7922e+01,   Y0: 2.4960e+00,  elapsed time  59
INFO   step:    22,    loss: 6.7914e+01,   Y0: 2.4941e+00,  elapsed time  60
INFO   step:    23,    loss: 6.7905e+01,   Y0: 2.4928e+00,  elapsed time  62
INFO   step:    24,    loss: 6.7896e+01,   Y0: 2.4912e+00,  elapsed time  63
INFO   step:    25,    loss: 6.7888e+01,   Y0: 2.4901e+00,  elapsed time  65
INFO   step:    26,    loss: 6.7880e+01,   Y0: 2.4886e+00,  elapsed time  67
INFO   step:    27,    loss: 6.7871e+01,   Y0: 2.4876e+00,  elapsed time  68
INFO   step:    28,    loss: 6.7863e+01,   Y0: 2.4866e+00,  elapsed time  70
INFO   step:    29,    loss: 6.7855e+01,   Y0: 2.4865e+00,  elapsed time  72
INFO   step:    30,    loss: 6.7846e+01,   Y0: 2.4868e+00,  elapsed time  73
INFO   step:    31,    loss: 6.7837e+01,   Y0: 2.4862e+00,  elapsed time  75
INFO   step:    32,    loss: 6.7828e+01,   Y0: 2.4864e+00,  elapsed time  77
INFO   step:    33,    loss: 6.7820e+01,   Y0: 2.4872e+00,  elapsed time  78
INFO   step:    34,    loss: 6.7813e+01,   Y0: 2.4884e+00,  elapsed time  80
INFO   step:    35,    loss: 6.7807e+01,   Y0: 2.4894e+00,  elapsed time  82
INFO   step:    36,    loss: 6.7800e+01,   Y0: 2.4903e+00,  elapsed time  83
INFO   step:    37,    loss: 6.7793e+01,   Y0: 2.4909e+00,  elapsed time  85
INFO   step:    38,    loss: 6.7786e+01,   Y0: 2.4910e+00,  elapsed time  86
INFO   step:    39,    loss: 6.7779e+01,   Y0: 2.4904e+00,  elapsed time  88
INFO   step:    40,    loss: 6.7773e+01,   Y0: 2.4895e+00,  elapsed time  90
INFO   step:    41,    loss: 6.7766e+01,   Y0: 2.4884e+00,  elapsed time  91
INFO   step:    42,    loss: 6.7760e+01,   Y0: 2.4877e+00,  elapsed time  93
INFO   step:    43,    loss: 6.7753e+01,   Y0: 2.4875e+00,  elapsed time  95
INFO   step:    44,    loss: 6.7746e+01,   Y0: 2.4877e+00,  elapsed time  96
INFO   step:    45,    loss: 6.7737e+01,   Y0: 2.4891e+00,  elapsed time  98
INFO   step:    46,    loss: 6.7730e+01,   Y0: 2.4910e+00,  elapsed time 100
INFO   step:    47,    loss: 6.7723e+01,   Y0: 2.4931e+00,  elapsed time 101
INFO   step:    48,    loss: 6.7718e+01,   Y0: 2.4956e+00,  elapsed time 103
INFO   step:    49,    loss: 6.7711e+01,   Y0: 2.4970e+00,  elapsed time 105
INFO   step:    50,    loss: 6.7703e+01,   Y0: 2.4985e+00,  elapsed time 106
INFO   step:    51,    loss: 6.7695e+01,   Y0: 2.4996e+00,  elapsed time 108
INFO   step:    52,    loss: 6.7688e+01,   Y0: 2.5008e+00,  elapsed time 110
INFO   step:    53,    loss: 6.7681e+01,   Y0: 2.5022e+00,  elapsed time 111
INFO   step:    54,    loss: 6.7673e+01,   Y0: 2.5035e+00,  elapsed time 113
INFO   step:    55,    loss: 6.7665e+01,   Y0: 2.5056e+00,  elapsed time 115
INFO   step:    56,    loss: 6.7655e+01,   Y0: 2.5069e+00,  elapsed time 116
INFO   step:    57,    loss: 6.7647e+01,   Y0: 2.5082e+00,  elapsed time 118
INFO   step:    58,    loss: 6.7639e+01,   Y0: 2.5098e+00,  elapsed time 119
INFO   step:    59,    loss: 6.7631e+01,   Y0: 2.5119e+00,  elapsed time 121
INFO   step:    60,    loss: 6.7622e+01,   Y0: 2.5137e+00,  elapsed time 123
INFO   step:    61,    loss: 6.7614e+01,   Y0: 2.5145e+00,  elapsed time 124
INFO   step:    62,    loss: 6.7605e+01,   Y0: 2.5145e+00,  elapsed time 126
INFO   step:    63,    loss: 6.7595e+01,   Y0: 2.5144e+00,  elapsed time 128
INFO   step:    64,    loss: 6.7584e+01,   Y0: 2.5137e+00,  elapsed time 129
INFO   step:    65,    loss: 6.7574e+01,   Y0: 2.5129e+00,  elapsed time 131
INFO   step:    66,    loss: 6.7562e+01,   Y0: 2.5121e+00,  elapsed time 133
INFO   step:    67,    loss: 6.7551e+01,   Y0: 2.5113e+00,  elapsed time 134
INFO   step:    68,    loss: 6.7539e+01,   Y0: 2.5099e+00,  elapsed time 136
INFO   step:    69,    loss: 6.7527e+01,   Y0: 2.5083e+00,  elapsed time 138
INFO   step:    70,    loss: 6.7517e+01,   Y0: 2.5076e+00,  elapsed time 139
INFO   step:    71,    loss: 6.7508e+01,   Y0: 2.5066e+00,  elapsed time 141
INFO   step:    72,    loss: 6.7500e+01,   Y0: 2.5065e+00,  elapsed time 143
INFO   step:    73,    loss: 6.7491e+01,   Y0: 2.5067e+00,  elapsed time 144
INFO   step:    74,    loss: 6.7483e+01,   Y0: 2.5072e+00,  elapsed time 146
INFO   step:    75,    loss: 6.7474e+01,   Y0: 2.5075e+00,  elapsed time 147
INFO   step:    76,    loss: 6.7465e+01,   Y0: 2.5071e+00,  elapsed time 149
INFO   step:    77,    loss: 6.7457e+01,   Y0: 2.5067e+00,  elapsed time 151
INFO   step:    78,    loss: 6.7450e+01,   Y0: 2.5055e+00,  elapsed time 152
INFO   step:    79,    loss: 6.7442e+01,   Y0: 2.5043e+00,  elapsed time 154
INFO   step:    80,    loss: 6.7435e+01,   Y0: 2.5027e+00,  elapsed time 156
INFO   step:    81,    loss: 6.7427e+01,   Y0: 2.5011e+00,  elapsed time 157
INFO   step:    82,    loss: 6.7419e+01,   Y0: 2.4992e+00,  elapsed time 159
INFO   step:    83,    loss: 6.7411e+01,   Y0: 2.4974e+00,  elapsed time 161
INFO   step:    84,    loss: 6.7403e+01,   Y0: 2.4955e+00,  elapsed time 162
INFO   step:    85,    loss: 6.7393e+01,   Y0: 2.4931e+00,  elapsed time 164
INFO   step:    86,    loss: 6.7386e+01,   Y0: 2.4920e+00,  elapsed time 166
INFO   step:    87,    loss: 6.7377e+01,   Y0: 2.4909e+00,  elapsed time 167
INFO   step:    88,    loss: 6.7368e+01,   Y0: 2.4892e+00,  elapsed time 169
INFO   step:    89,    loss: 6.7359e+01,   Y0: 2.4880e+00,  elapsed time 171
INFO   step:    90,    loss: 6.7351e+01,   Y0: 2.4875e+00,  elapsed time 172
INFO   step:    91,    loss: 6.7343e+01,   Y0: 2.4872e+00,  elapsed time 174
INFO   step:    92,    loss: 6.7334e+01,   Y0: 2.4859e+00,  elapsed time 175
INFO   step:    93,    loss: 6.7325e+01,   Y0: 2.4841e+00,  elapsed time 177
INFO   step:    94,    loss: 6.7317e+01,   Y0: 2.4828e+00,  elapsed time 179
INFO   step:    95,    loss: 6.7310e+01,   Y0: 2.4807e+00,  elapsed time 180
INFO   step:    96,    loss: 6.7303e+01,   Y0: 2.4792e+00,  elapsed time 182
INFO   step:    97,    loss: 6.7295e+01,   Y0: 2.4775e+00,  elapsed time 184
INFO   step:    98,    loss: 6.7288e+01,   Y0: 2.4772e+00,  elapsed time 185
INFO   step:    99,    loss: 6.7281e+01,   Y0: 2.4765e+00,  elapsed time 187
INFO   step:   100,    loss: 6.7273e+01,   Y0: 2.4754e+00,  elapsed time 189
INFO   step:   101,    loss: 6.7264e+01,   Y0: 2.4746e+00,  elapsed time 190
INFO   step:   102,    loss: 6.7257e+01,   Y0: 2.4736e+00,  elapsed time 192
INFO   step:   103,    loss: 6.7249e+01,   Y0: 2.4733e+00,  elapsed time 194
INFO   step:   104,    loss: 6.7241e+01,   Y0: 2.4735e+00,  elapsed time 195
INFO   step:   105,    loss: 6.7234e+01,   Y0: 2.4741e+00,  elapsed time 197
INFO   step:   106,    loss: 6.7225e+01,   Y0: 2.4752e+00,  elapsed time 199
INFO   step:   107,    loss: 6.7218e+01,   Y0: 2.4773e+00,  elapsed time 200
INFO   step:   108,    loss: 6.7210e+01,   Y0: 2.4789e+00,  elapsed time 202
INFO   step:   109,    loss: 6.7202e+01,   Y0: 2.4796e+00,  elapsed time 203
INFO   step:   110,    loss: 6.7194e+01,   Y0: 2.4806e+00,  elapsed time 205
INFO   step:   111,    loss: 6.7187e+01,   Y0: 2.4807e+00,  elapsed time 207
INFO   step:   112,    loss: 6.7181e+01,   Y0: 2.4809e+00,  elapsed time 208
INFO   step:   113,    loss: 6.7174e+01,   Y0: 2.4803e+00,  elapsed time 210
INFO   step:   114,    loss: 6.7168e+01,   Y0: 2.4795e+00,  elapsed time 212
INFO   step:   115,    loss: 6.7161e+01,   Y0: 2.4785e+00,  elapsed time 213
INFO   step:   116,    loss: 6.7154e+01,   Y0: 2.4771e+00,  elapsed time 215
INFO   step:   117,    loss: 6.7147e+01,   Y0: 2.4761e+00,  elapsed time 217
INFO   step:   118,    loss: 6.7139e+01,   Y0: 2.4758e+00,  elapsed time 218
INFO   step:   119,    loss: 6.7132e+01,   Y0: 2.4754e+00,  elapsed time 220
INFO   step:   120,    loss: 6.7125e+01,   Y0: 2.4756e+00,  elapsed time 222
INFO   step:   121,    loss: 6.7118e+01,   Y0: 2.4759e+00,  elapsed time 223
INFO   step:   122,    loss: 6.7111e+01,   Y0: 2.4772e+00,  elapsed time 225
INFO   step:   123,    loss: 6.7104e+01,   Y0: 2.4774e+00,  elapsed time 227
INFO   step:   124,    loss: 6.7096e+01,   Y0: 2.4772e+00,  elapsed time 228
INFO   step:   125,    loss: 6.7088e+01,   Y0: 2.4762e+00,  elapsed time 230
INFO   step:   126,    loss: 6.7080e+01,   Y0: 2.4746e+00,  elapsed time 231
INFO   step:   127,    loss: 6.7072e+01,   Y0: 2.4737e+00,  elapsed time 233
INFO   step:   128,    loss: 6.7064e+01,   Y0: 2.4727e+00,  elapsed time 235
INFO   step:   129,    loss: 6.7055e+01,   Y0: 2.4705e+00,  elapsed time 236
INFO   step:   130,    loss: 6.7045e+01,   Y0: 2.4681e+00,  elapsed time 238
INFO   step:   131,    loss: 6.7035e+01,   Y0: 2.4666e+00,  elapsed time 240
INFO   step:   132,    loss: 6.7024e+01,   Y0: 2.4647e+00,  elapsed time 241
INFO   step:   133,    loss: 6.7014e+01,   Y0: 2.4639e+00,  elapsed time 243
INFO   step:   134,    loss: 6.7003e+01,   Y0: 2.4635e+00,  elapsed time 245
INFO   step:   135,    loss: 6.6993e+01,   Y0: 2.4636e+00,  elapsed time 246
INFO   step:   136,    loss: 6.6983e+01,   Y0: 2.4640e+00,  elapsed time 248
INFO   step:   137,    loss: 6.6973e+01,   Y0: 2.4649e+00,  elapsed time 250
INFO   step:   138,    loss: 6.6964e+01,   Y0: 2.4658e+00,  elapsed time 251
INFO   step:   139,    loss: 6.6954e+01,   Y0: 2.4656e+00,  elapsed time 253
INFO   step:   140,    loss: 6.6944e+01,   Y0: 2.4655e+00,  elapsed time 254
INFO   step:   141,    loss: 6.6935e+01,   Y0: 2.4649e+00,  elapsed time 256
INFO   step:   142,    loss: 6.6926e+01,   Y0: 2.4643e+00,  elapsed time 258
INFO   step:   143,    loss: 6.6917e+01,   Y0: 2.4637e+00,  elapsed time 259
INFO   step:   144,    loss: 6.6908e+01,   Y0: 2.4619e+00,  elapsed time 261
INFO   step:   145,    loss: 6.6899e+01,   Y0: 2.4601e+00,  elapsed time 263
INFO   step:   146,    loss: 6.6891e+01,   Y0: 2.4584e+00,  elapsed time 264
INFO   step:   147,    loss: 6.6882e+01,   Y0: 2.4569e+00,  elapsed time 266
INFO   step:   148,    loss: 6.6873e+01,   Y0: 2.4560e+00,  elapsed time 268
INFO   step:   149,    loss: 6.6864e+01,   Y0: 2.4550e+00,  elapsed time 269
Delta:  100 ,  100.05
Other1:  -10.05 ,  -10
Other2:  -10.05 ,  -10
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_10:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_11:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_12:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_13:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_14:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_15:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_16:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_17:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_18:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_19:0' shape=(?, 3) dtype=float64>]
num_iterations:  150
total time intervals:  20
# of dimensions:  3
Loss out:  56.65865021995704
Output_Z_Vals:  [[[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
  [ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
  [ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
  ...
  [ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
  [ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
  [ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]]

 [[-2.31203789e-01 -3.81187025e-02  9.83353350e-02]
  [-2.23710048e-01 -2.49420777e-02  6.12828627e-02]
  [-2.92514766e-01 -3.16388526e-02  9.32849798e-02]
  ...
  [-1.44681335e-01 -6.89671556e-02  1.63992602e-01]
  [-3.01080771e-01 -4.91571688e-02  1.42263150e-01]
  [-1.27796454e-01 -6.88710473e-02  1.60311854e-01]]

 [[ 4.45555961e-02  4.02484826e-02  1.73530451e-02]
  [ 4.94881438e-02  4.86809724e-02  6.64258868e-02]
  [ 1.96713790e-02  6.17551515e-02  5.07455701e-02]
  ...
  [-3.91972208e-01  2.91812202e-01  5.16635634e-02]
  [-1.38729693e-01  1.58607396e-01  8.76224894e-02]
  [ 3.46642996e-02  4.55833590e-02  1.65279570e-02]]

 ...

 [[-9.51290748e-02  7.39930292e-02  5.18499976e-02]
  [-9.16699679e-02  5.35626743e-02  8.07506066e-02]
  [-1.29174899e-01  1.62858321e-02  8.13484824e-02]
  ...
  [-7.02009590e-02  1.12873733e-01  3.43422489e-02]
  [ 4.97098719e-03 -6.54635055e-03 -3.22552344e-02]
  [-1.29474602e-01  1.56839854e-02  8.17220143e-02]]

 [[-4.78044976e-02 -4.90689989e-02  2.23543183e-02]
  [-4.12824225e-02 -2.88669272e-02  2.11143608e-02]
  [-4.44113677e-02 -3.84791172e-02  2.16588920e-02]
  ...
  [-5.03617872e-02 -5.80354273e-02  2.35007044e-02]
  [ 3.78157828e-02  4.65085188e-02  1.44533584e-01]
  [-4.14657922e-02 -2.93122851e-02  2.10717677e-02]]

 [[-2.61388335e-02  5.31371847e-01  2.63983236e-01]
  [-2.74023502e-02  5.19062434e-01  2.55493918e-01]
  [-2.78706599e-02  5.18522750e-01  2.42783100e-01]
  ...
  [-3.81670580e-02  4.33849346e-01  1.67567505e-01]
  [-4.34800546e-02  3.96144582e-01  1.10343240e-01]
  [-2.83380357e-02  5.04228884e-01  2.51868134e-01]]]
Z_Vals dimensionality:  (20, 200, 3)
X_test:  [[[100.          99.57323915 100.61926321 ... 100.94419238 100.65631007
   100.10832407]
  [ -1.          -0.63920102  -0.73497427 ...  -1.1298322   -0.76923523
    -0.21464788]
  [ -1.          -0.99716848  -1.01561099 ...  -0.94786933  -0.95384573
    -0.95859405]]

 [[100.         101.48093809 101.14102919 ... 103.75120873 101.23632794
   100.76853951]
  [ -1.          -1.38792473  -1.167094   ...  -0.80515353  -0.78664424
    -0.69042986]
  [ -1.          -1.01547481  -0.98577649 ...  -1.10985426  -1.15245696
    -1.1238671 ]]

 [[100.         100.02813087 100.50291969 ... 102.36244978  99.40942545
    99.58235423]
  [ -1.          -0.88363605  -0.91630631 ...  -0.79606227  -0.6727154
    -0.81463328]
  [ -1.          -0.9948237   -0.95864906 ...  -1.05218242  -1.05630306
    -1.05625668]]

 ...

 [[100.          99.02351387  98.03917456 ...  99.22190239  98.91556527
    98.85226996]
  [ -1.          -0.96376235  -0.92148224 ...  -1.31777271  -1.32918755
    -1.22039705]
  [ -1.          -0.99128889  -0.98708804 ...  -1.07755262  -1.07743412
    -1.1125329 ]]

 [[100.          99.63707892  99.00348086 ...  95.20506167  95.25729483
    93.66316206]
  [ -1.          -1.10433783  -1.31059915 ...  -1.17057315  -1.3569535
    -0.6039905 ]
  [ -1.          -1.02095057  -1.02631492 ...  -0.9599224   -0.96142766
    -1.00943565]]

 [[100.          98.94676215 100.51844493 ... 103.82031063 103.06888565
   102.64611753]
  [ -1.          -0.95714732  -0.69221136 ...  -1.10560847  -1.19300451
    -1.25231713]
  [ -1.          -0.97629183  -0.98929144 ...  -1.11780246  -1.09368202
    -1.08238951]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.31203789e-01 -3.81187025e-02  9.83353350e-02]
 [ 4.45555961e-02  4.02484826e-02  1.73530451e-02]
 [-5.73113095e-04 -7.82001327e-02  3.47353384e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 8.48484449e-01 -5.10037369e-01 -2.14908363e-01]
 [-2.21754209e-02  5.22110532e-02  1.13008998e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 1.82998348e-01 -1.77024055e-04  3.87815534e-03]
 [-7.80392344e-02  2.41565563e-02  5.46965980e-02]
 [-1.50527307e-01  1.37332706e-01 -8.73800173e-03]
 [ 6.89164059e-02 -1.23064387e-01  1.40108402e-03]
 [ 4.38189572e-02  9.13427747e-02  3.70159482e-02]
 [-1.67621535e-02  1.80576773e-01  4.75948198e-02]
 [ 2.48298838e-02 -1.15780813e-01 -7.40648553e-03]
 [-1.12037801e-01 -7.83523228e-02  1.69060246e-01]
 [ 5.98654703e-03  1.49094296e-01  2.23722815e-01]
 [-9.51290748e-02  7.39930292e-02  5.18499976e-02]
 [-4.78044976e-02 -4.90689989e-02  2.23543183e-02]
 [-2.61388335e-02  5.31371847e-01  2.63983236e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.78750809]
curr_Stock_Price:  99.57323915421071
curr_Factors:  [99.57323915 -0.63920102 -0.99716848]
mat_Sqrt:  [[19.38547241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01094198 -0.01205419  0.28052334]
Stock Position:  -0.010941977027514116
Bond Position:  [0.30202]


portfolio before change:  [-0.79887815]
curr_Stock_Price:  100.61926320829382
curr_Factors:  [100.61926321  -0.73497427  -1.01561099]
mat_Sqrt:  [[17.47477586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00281188 0.01272769 0.04950341]
Stock Position:  0.002811880586999476
Bond Position:  [-1.0818075]


portfolio before change:  [-0.79808793]
curr_Stock_Price:  100.99648796602449
curr_Factors:  [100.99648797  -0.91824928  -1.02571087]
mat_Sqrt:  [[14.4562319   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00031115 -0.02472905  0.09909025]
Stock Position:  0.0003111522734478703
Bond Position:  [-0.82951321]


portfolio before change:  [-0.79857005]
curr_Stock_Price:  100.11358907869365
curr_Factors:  [100.11358908  -1.3479952   -1.00473202]
mat_Sqrt:  [[ 9.52174574  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00398496 -0.00455813 -0.02970002]
Stock Position:  -0.003984958035501073
Bond Position:  [-0.39962159]


portfolio before change:  [-0.79664108]
curr_Stock_Price:  99.60445362436059
curr_Factors:  [99.60445362 -1.44937193 -0.95887746]
mat_Sqrt:  [[ 8.961678    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08831464 -0.16128798 -0.61307374]
Stock Position:  0.08831463874745578
Bond Position:  [-9.59317242]


portfolio before change:  [-0.84332607]
curr_Stock_Price:  99.10299205149171
curr_Factors:  [99.10299205 -1.53952344 -0.97704196]
mat_Sqrt:  [[ 8.0012216   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00231472  0.01651058  0.03223832]
Stock Position:  -0.0023147153950178927
Bond Position:  [-0.61393085]


portfolio before change:  [-0.84130593]
curr_Stock_Price:  98.1639398378075
curr_Factors:  [98.16393984 -1.302185   -0.98095901]
mat_Sqrt:  [[10.00910246  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056611 -0.02845143  0.0120735 ]
Stock Position:  -0.0005661140855741226
Bond Position:  [-0.78573395]


portfolio before change:  [-0.84175867]
curr_Stock_Price:  98.61663103497297
curr_Factors:  [98.61663103 -0.97175746 -0.99126033]
mat_Sqrt:  [[13.84912602  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.32705415e-02 -5.59799213e-05  1.10632977e-02]
Stock Position:  0.013270541540542212
Bond Position:  [-2.15045477]


portfolio before change:  [-0.83231917]
curr_Stock_Price:  99.36845973391083
curr_Factors:  [99.36845973 -1.06954748 -0.9813138 ]
mat_Sqrt:  [[12.78117621  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00518345  0.00763897  0.15603417]
Stock Position:  -0.0051834523961350265
Bond Position:  [-0.31724749]


portfolio before change:  [-0.83157801]
curr_Stock_Price:  99.21017061586363
curr_Factors:  [99.21017062 -0.77893182 -0.96378172]
mat_Sqrt:  [[17.36622086  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00856634  0.04342841 -0.02492709]
Stock Position:  -0.008566344428303027
Bond Position:  [0.01829048]


portfolio before change:  [-0.83490807]
curr_Stock_Price:  99.59944147556455
curr_Factors:  [99.59944148 -0.61879709 -0.96788025]
mat_Sqrt:  [[20.3784754   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00323993 -0.03891638  0.0039969 ]
Stock Position:  0.0032399328663845956
Bond Position:  [-1.15760357]


portfolio before change:  [-0.83366973]
curr_Stock_Price:  100.07098761864032
curr_Factors:  [100.07098762  -0.64061977  -0.9614873 ]
mat_Sqrt:  [[20.16145761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00266515 0.02888512 0.1055962 ]
Stock Position:  0.002665147893656645
Bond Position:  [-1.10037371]


portfolio before change:  [-0.83314762]
curr_Stock_Price:  100.37012039617963
curr_Factors:  [100.3701204   -0.50566454  -0.94445915]
mat_Sqrt:  [[23.54093608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.01288637e-04  5.71033894e-02  1.35774773e-01]
Stock Position:  -0.00010128863693827012
Bond Position:  [-0.82298127]


portfolio before change:  [-0.83303666]
curr_Stock_Price:  97.24313931951939
curr_Factors:  [97.24313932 -0.69629586 -0.9856279 ]
mat_Sqrt:  [[18.08875861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112382 -0.03661311 -0.02112864]
Stock Position:  0.0011238246884647143
Bond Position:  [-0.9423209]


portfolio before change:  [-0.83364476]
curr_Stock_Price:  96.9116926256928
curr_Factors:  [96.91169263 -0.81497691 -0.95639718]
mat_Sqrt:  [[16.48459132  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00482581 -0.02477718  0.48228182]
Stock Position:  -0.004825813994622461
Bond Position:  [-0.36596696]


portfolio before change:  [-0.84458712]
curr_Stock_Price:  99.16019431908589
curr_Factors:  [99.16019432 -1.13003483 -0.96058493]
mat_Sqrt:  [[12.2572416   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00452821 0.04714776 0.63821892]
Stock Position:  0.0045282107861814485
Bond Position:  [-1.29360538]


portfolio before change:  [-0.83793441]
curr_Stock_Price:  100.70079145605436
curr_Factors:  [100.70079146  -1.02602009  -0.9357564 ]
mat_Sqrt:  [[14.15937809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00583604  0.02339865  0.14791361]
Stock Position:  -0.005836043508128715
Bond Position:  [-0.25024021]


portfolio before change:  [-0.83941748]
curr_Stock_Price:  100.9441923827727
curr_Factors:  [100.94419238  -1.1298322   -0.94786933]
mat_Sqrt:  [[12.63999874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00352123 -0.01551698  0.06377065]
Stock Position:  -0.0035212343400870096
Bond Position:  [-0.48396932]


portfolio before change:  [-0.83852478]
curr_Stock_Price:  100.65631007471083
curr_Factors:  [100.65631007  -0.76923523  -0.95384573]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.83852478]
Stock Price:  100.1083240728672
PL:  [-0.94684885]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.23710048e-01 -2.49420777e-02  6.12828627e-02]
 [ 4.94881438e-02  4.86809724e-02  6.64258868e-02]
 [-6.03006609e-03 -7.70488605e-02  3.09462073e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.81660220e-01 -2.83321169e-01 -2.06457143e-01]
 [-1.51069601e-02 -6.00106666e-02 -9.19451300e-02]
 [ 3.11225627e-03 -7.76424787e-02  2.26962415e-03]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [-6.76221140e-02 -2.85543457e-02 -1.23089882e-01]
 [-3.81198710e-01  3.72408888e-01  4.21788438e-02]
 [ 1.17739047e-01 -1.51392334e-01 -4.10825118e-03]
 [-2.29056853e-02  5.08135236e-02  3.61491253e-02]
 [-6.08968176e-02  1.70989941e-01 -7.88598022e-03]
 [-8.23553462e-02 -6.91626938e-02  5.63376069e-02]
 [-1.72667571e-01 -1.25731048e-01  2.51955941e-01]
 [ 3.67433756e-02  6.40818368e-02  9.40031186e-02]
 [-9.16699679e-02  5.35626743e-02  8.07506066e-02]
 [-4.12824225e-02 -2.88669272e-02  2.11143608e-02]
 [-2.74023502e-02  5.19062434e-01  2.55493918e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.90750254]
curr_Stock_Price:  101.48093809187904
curr_Factors:  [101.48093809  -1.38792473  -1.01547481]
mat_Sqrt:  [[ 9.1748995   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0230896  -0.00788738  0.17482295]
Stock Position:  -0.02308959761795677
Bond Position:  [15.25065657]


portfolio before change:  [12.91916404]
curr_Stock_Price:  101.14102919143163
curr_Factors:  [101.14102919  -1.167094    -0.98577649]
mat_Sqrt:  [[11.74755799  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00547384 0.01539428 0.18949457]
Stock Position:  0.005473836225809979
Bond Position:  [12.36553462]


portfolio before change:  [12.92650229]
curr_Stock_Price:  101.9168061973223
curr_Factors:  [101.9168062   -1.14885985  -0.99971214]
mat_Sqrt:  [[11.88865835  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00014321 -0.02436499  0.08828092]
Stock Position:  -0.00014321136552897747
Bond Position:  [12.94109794]


portfolio before change:  [12.92970665]
curr_Stock_Price:  102.13546910549006
curr_Factors:  [102.13546911  -1.04286238  -1.01484541]
mat_Sqrt:  [[13.04744431  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00290814 -0.00455813 -0.02970002]
Stock Position:  -0.0029081371256256673
Bond Position:  [13.2267306]


portfolio before change:  [12.9358505]
curr_Stock_Price:  101.16001564035042
curr_Factors:  [101.16001564  -1.00305287  -0.9980463 ]
mat_Sqrt:  [[13.6754794   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0242918  -0.08959402 -0.58896476]
Stock Position:  0.02429180004578443
Bond Position:  [10.47849163]


portfolio before change:  [12.97491841]
curr_Stock_Price:  102.66043797659448
curr_Factors:  [102.66043798  -1.17611118  -1.02906155]
mat_Sqrt:  [[11.31641235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00313038 -0.01897704 -0.26229386]
Stock Position:  -0.003130378144238803
Bond Position:  [13.2962844]


portfolio before change:  [12.97898496]
curr_Stock_Price:  102.42338646718765
curr_Factors:  [102.42338647  -0.79664282  -1.04771852]
mat_Sqrt:  [[16.19582879  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.69892436e-05 -2.45527076e-02  6.47460596e-03]
Stock Position:  9.698924356268183e-05
Bond Position:  [12.96905099]


portfolio before change:  [12.9822874]
curr_Stock_Price:  103.03960663948835
curr_Factors:  [103.03960664  -0.83535732  -1.03783215]
mat_Sqrt:  [[15.83027081  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00881762 -0.01496598 -0.14840805]
Stock Position:  -0.008817621369492918
Bond Position:  [13.89085163]


portfolio before change:  [12.97520018]
curr_Stock_Price:  104.23725014020512
curr_Factors:  [104.23725014  -0.97074119  -1.04334227]
mat_Sqrt:  [[13.9096952   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00672085 -0.00902968 -0.35114117]
Stock Position:  -0.006720851868331572
Bond Position:  [13.67576329]


portfolio before change:  [12.98354389]
curr_Stock_Price:  103.50455337089501
curr_Factors:  [103.50455337  -0.92173608  -1.02520635]
mat_Sqrt:  [[14.77110895  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0245732   0.11776603  0.1203245 ]
Stock Position:  -0.024573201258483605
Bond Position:  [15.52698211]


portfolio before change:  [13.00865953]
curr_Stock_Price:  102.64046516743156
curr_Factors:  [102.64046517  -0.87856825  -1.04417436]
mat_Sqrt:  [[15.006593    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00752946 -0.04787446 -0.0117197 ]
Stock Position:  0.007529458616228682
Bond Position:  [12.2358324]


portfolio before change:  [13.00884973]
curr_Stock_Price:  102.25940906831018
curr_Factors:  [102.25940907  -1.12882083  -1.0433276 ]
mat_Sqrt:  [[11.65067805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00122008  0.01606865  0.10312339]
Stock Position:  -0.0012200814760115137
Bond Position:  [13.13361454]


portfolio before change:  [13.00997028]
curr_Stock_Price:  104.03245926010051
curr_Factors:  [104.03245926  -0.72437096  -1.0864528 ]
mat_Sqrt:  [[17.01132329  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00341488  0.05407177 -0.02249651]
Stock Position:  -0.0034148780949675114
Bond Position:  [13.36522844]


portfolio before change:  [13.01574995]
curr_Stock_Price:  103.31853891120319
curr_Factors:  [103.31853891  -0.99133035  -1.07802906]
mat_Sqrt:  [[13.0456849   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00556822 -0.02187116  0.16071551]
Stock Position:  -0.005568220757798571
Bond Position:  [13.59105039]


portfolio before change:  [13.01553538]
curr_Stock_Price:  103.96735598848176
curr_Factors:  [103.96735599  -1.31638848  -1.10069375]
mat_Sqrt:  [[ 9.27195954  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01342582 -0.03975965  0.71876017]
Stock Position:  -0.013425818045063174
Bond Position:  [14.41138219]


portfolio before change:  [13.02140632]
curr_Stock_Price:  103.79845474782829
curr_Factors:  [103.79845475  -1.170068    -1.09248147]
mat_Sqrt:  [[10.80383984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00533017 0.02026446 0.26816473]
Stock Position:  0.005330166732201483
Bond Position:  [12.46814325]


portfolio before change:  [13.02805648]
curr_Stock_Price:  104.46123703603583
curr_Factors:  [104.46123704  -1.32670721  -1.10260222]
mat_Sqrt:  [[ 9.20278942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00801972  0.016938    0.230359  ]
Stock Position:  -0.008019724631825499
Bond Position:  [13.86580684]


portfolio before change:  [13.0372176]
curr_Stock_Price:  103.75120873486323
curr_Factors:  [103.75120873  -0.80515353  -1.10985426]
mat_Sqrt:  [[15.28677409  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00246735 -0.00912852  0.06023339]
Stock Position:  -0.002467349375615708
Bond Position:  [13.29320808]


portfolio before change:  [13.04674641]
curr_Stock_Price:  101.23632793605562
curr_Factors:  [101.23632794  -0.78664424  -1.15245696]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.04674641]
Stock Price:  100.76853951160797
PL:  [12.27820689]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.92514766e-01 -3.16388526e-02  9.32849798e-02]
 [ 1.96713790e-02  6.17551515e-02  5.07455701e-02]
 [-5.07497694e-02 -3.15249652e-01  3.40422655e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 6.84764687e-01 -4.21325531e-01 -1.90411365e-01]
 [-1.15351007e-01  7.49669381e-02  2.81051643e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-5.45644330e-03 -3.30538634e-02 -6.54050629e-03]
 [-4.75226866e-02  2.73778525e-02  1.57409435e-02]
 [-2.95392637e-01  2.79167390e-01  3.44896077e-02]
 [ 5.92293060e-02 -1.17553146e-01  3.35119505e-03]
 [ 6.71659502e-03  7.29534487e-02  4.41341297e-02]
 [-2.24738235e-02  1.64589405e-01  3.46956662e-02]
 [-4.27942901e-02 -1.05231422e-01 -6.07358021e-02]
 [-1.48358032e-01 -1.07741710e-01  2.21526653e-01]
 [ 2.73092004e-02  6.75922094e-02  8.28732953e-02]
 [-1.29174899e-01  1.62858321e-02  8.13484824e-02]
 [-4.44113677e-02 -3.84791172e-02  2.16588920e-02]
 [-2.78706599e-02  5.18522750e-01  2.42783100e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.47807365]
curr_Stock_Price:  100.0281308653844
curr_Factors:  [100.02813087  -0.88363605  -0.9948237 ]
mat_Sqrt:  [[15.28683045  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01794289 -0.01000508  0.26611608]
Stock Position:  -0.017942892866125774
Bond Position:  [4.27286769]


portfolio before change:  [2.47062292]
curr_Stock_Price:  100.50291968521847
curr_Factors:  [100.50291969  -0.91630631  -0.95864906]
mat_Sqrt:  [[15.41330978  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00205175 0.01952869 0.14476299]
Stock Position:  0.0020517518153675175
Bond Position:  [2.26441587]


portfolio before change:  [2.47018459]
curr_Stock_Price:  100.01333763414033
curr_Factors:  [100.01333763  -1.22493415  -0.97488715]
mat_Sqrt:  [[11.08377418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00468619 -0.09969069  0.09711311]
Stock Position:  -0.004686186421531119
Bond Position:  [2.93886573]


portfolio before change:  [2.47022298]
curr_Stock_Price:  100.16194745438813
curr_Factors:  [100.16194745  -0.95068794  -0.97223956]
mat_Sqrt:  [[14.64151295  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259152 -0.00455813 -0.02970002]
Stock Position:  -0.002591518877106852
Bond Position:  [2.72979456]


portfolio before change:  [2.47189412]
curr_Stock_Price:  99.78047052369377
curr_Factors:  [99.78047052 -1.00941003 -0.94350311]
mat_Sqrt:  [[14.15487847  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04486217 -0.13323483 -0.54319062]
Stock Position:  0.04486216911761161
Bond Position:  [-2.00447422]


portfolio before change:  [2.37875351]
curr_Stock_Price:  97.71549165300596
curr_Factors:  [97.71549165 -1.12005511 -0.93466423]
mat_Sqrt:  [[12.52016786  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0086004   0.02370663  0.08017621]
Stock Position:  -0.008600397951836149
Bond Position:  [3.21914562]


portfolio before change:  [2.37394935]
curr_Stock_Price:  98.36767577919353
curr_Factors:  [98.36767578 -1.13389595 -0.89652456]
mat_Sqrt:  [[12.91373838  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043878 -0.02845143  0.0120735 ]
Stock Position:  -0.0004387802912893418
Bond Position:  [2.41711115]


portfolio before change:  [2.37372972]
curr_Stock_Price:  100.24557152484675
curr_Factors:  [100.24557152  -0.9728492   -0.92031415]
mat_Sqrt:  [[15.09644882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00050641 -0.01045255 -0.01865824]
Stock Position:  -0.0005064082108153322
Bond Position:  [2.4244949]


portfolio before change:  [2.37430701]
curr_Stock_Price:  100.30267604450871
curr_Factors:  [100.30267604  -1.36909914  -0.94198087]
mat_Sqrt:  [[ 9.94542223  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0043842   0.00865764  0.04490453]
Stock Position:  -0.004384196650990369
Bond Position:  [2.81405366]


portfolio before change:  [2.3751336]
curr_Stock_Price:  100.27462238056405
curr_Factors:  [100.27462238  -1.47640015  -0.97704606]
mat_Sqrt:  [[ 8.62328787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03260292  0.08828048  0.09838925]
Stock Position:  -0.03260292457149247
Bond Position:  [5.64437955]


portfolio before change:  [2.37593433]
curr_Stock_Price:  100.2933488307853
curr_Factors:  [100.29334883  -1.08660602  -1.01332589]
mat_Sqrt:  [[12.28240149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00463087 -0.03717357  0.00956003]
Stock Position:  0.0046308661011887796
Bond Position:  [1.91148926]


portfolio before change:  [2.37855045]
curr_Stock_Price:  100.7550737006043
curr_Factors:  [100.7550737   -1.30406987  -0.9780752 ]
mat_Sqrt:  [[10.2835701   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00171235 0.02306991 0.12590239]
Stock Position:  0.0017123514785696234
Bond Position:  [2.20602235]


portfolio before change:  [2.38106979]
curr_Stock_Price:  101.9042308187761
curr_Factors:  [101.90423082  -1.2944453   -0.97994541]
mat_Sqrt:  [[10.48182441  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106298  0.05204774  0.09897708]
Stock Position:  -0.0010629752746511058
Bond Position:  [2.48939146]


portfolio before change:  [2.38233266]
curr_Stock_Price:  101.3017249920938
curr_Factors:  [101.30172499  -1.23858746  -0.98490163]
mat_Sqrt:  [[10.96396905  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00528175 -0.0332771  -0.17326234]
Stock Position:  -0.005281754917666528
Bond Position:  [2.91738355]


portfolio before change:  [2.37927199]
curr_Stock_Price:  102.01931035777616
curr_Factors:  [102.01931036  -1.12645413  -1.00938983]
mat_Sqrt:  [[12.05305503  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00878789 -0.03407092  0.63195388]
Stock Position:  -0.008787894230242113
Bond Position:  [3.2758069]


portfolio before change:  [2.37244101]
curr_Stock_Price:  102.88983020415426
curr_Factors:  [102.8898302   -0.78257833  -1.02416087]
mat_Sqrt:  [[16.89334246  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00272124 0.02137453 0.23641444]
Stock Position:  0.0027212414830887093
Bond Position:  [2.09245293]


portfolio before change:  [2.37249276]
curr_Stock_Price:  102.71659097278028
curr_Factors:  [102.71659097  -0.93693231  -1.05185047]
mat_Sqrt:  [[14.05798932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00797761  0.00515003  0.23206458]
Stock Position:  -0.007977613933713327
Bond Position:  [3.19192607]


portfolio before change:  [2.37611604]
curr_Stock_Price:  102.36244977830172
curr_Factors:  [102.36244978  -0.79606227  -1.05218242]
mat_Sqrt:  [[16.12345837  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254187 -0.01216817  0.06178679]
Stock Position:  -0.002541873490872412
Bond Position:  [2.63630844]


portfolio before change:  [2.38428142]
curr_Stock_Price:  99.40942545111253
curr_Factors:  [99.40942545 -0.6727154  -1.05630306]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.38428142]
Stock Price:  99.58235423078678
PL:  [2.38428142]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.03658424e-01 -2.29904497e-02  5.19565485e-02]
 [ 8.89802850e-02  2.90273289e-03 -3.76588010e-02]
 [ 4.16038019e-03 -1.32880196e-01  2.07973890e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 2.36445898e-01 -2.10959655e-01 -2.02016054e-01]
 [ 6.07016747e-02 -8.84111239e-02 -8.36490676e-02]
 [ 7.70008167e-06 -8.28718049e-02  3.10208999e-03]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [ 1.36684964e-02  3.10757147e-02 -7.23714907e-02]
 [-2.24058451e-01  2.13764469e-01  1.73912090e-02]
 [ 7.94797574e-02 -1.29273015e-01  8.32052706e-04]
 [-2.67485112e-02  4.79605395e-02  3.50632002e-02]
 [-2.83769011e-02  1.67338582e-01  2.88385130e-02]
 [-5.20434564e-02 -8.22392378e-02 -3.23842541e-02]
 [-1.71698867e-01 -1.22658997e-01  2.44177673e-01]
 [ 3.75867755e-02  9.86302286e-02  1.60740548e-01]
 [-1.42376023e-01  4.25019902e-03  8.02424160e-02]
 [-4.10275435e-02 -2.94075041e-02  2.19060022e-02]
 [-1.29550178e-02  5.83343504e-01  3.49650462e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.06788069]
curr_Stock_Price:  101.08538209447507
curr_Factors:  [101.08538209  -0.71464432  -1.01951754]
mat_Sqrt:  [[17.84643317  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01085071 -0.00727022  0.14821757]
Stock Position:  -0.010850708754518774
Bond Position:  [11.16472873]


portfolio before change:  [10.06435285]
curr_Stock_Price:  101.66777492430185
curr_Factors:  [101.66777492  -0.5775292   -1.05286753]
mat_Sqrt:  [[19.91182276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00408642  0.00091792 -0.10743008]
Stock Position:  0.004086424615327379
Bond Position:  [9.64889515]


portfolio before change:  [10.07501394]
curr_Stock_Price:  103.68630508861906
curr_Factors:  [103.68630509  -0.57662521  -1.04791196]
mat_Sqrt:  [[20.42649575  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00024354 -0.04202041  0.05932916]
Stock Position:  0.00024354042980885587
Bond Position:  [10.04976214]


portfolio before change:  [10.07739922]
curr_Stock_Price:  103.16286413746593
curr_Factors:  [103.16286414  -0.6402125   -1.05987299]
mat_Sqrt:  [[18.84454453  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00201351 -0.00455813 -0.02970002]
Stock Position:  -0.0020135141571267904
Bond Position:  [10.28511911]


portfolio before change:  [10.08228664]
curr_Stock_Price:  102.01272619452382
curr_Factors:  [102.01272619  -0.65151454  -1.08607508]
mat_Sqrt:  [[17.94852518  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0105726  -0.0667113  -0.57629557]
Stock Position:  0.010572600629168285
Bond Position:  [9.00374683]


portfolio before change:  [10.090731]
curr_Stock_Price:  102.59849881050012
curr_Factors:  [102.59849881  -0.76659745  -1.05274426]
mat_Sqrt:  [[16.63454558  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00248544 -0.02795805 -0.23862751]
Stock Position:  0.0024854369889138676
Bond Position:  [9.83572889]


portfolio before change:  [10.09239674]
curr_Stock_Price:  102.27923857893751
curr_Factors:  [102.27923858  -0.85888364  -1.03993181]
mat_Sqrt:  [[15.31589619  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.78610219e-05 -2.62063657e-02  8.84939928e-03]
Stock Position:  -9.786102189534066e-05
Bond Position:  [10.10240589]


portfolio before change:  [10.09494756]
curr_Stock_Price:  102.02471163850966
curr_Factors:  [102.02471164  -0.86778192  -1.00869617]
mat_Sqrt:  [[15.6228872   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00893467 -0.01496598 -0.14840805]
Stock Position:  -0.008934669524100804
Bond Position:  [11.00650464]


portfolio before change:  [10.10298276]
curr_Stock_Price:  101.43339385374532
curr_Factors:  [101.43339385  -0.55950435  -0.98557333]
mat_Sqrt:  [[21.63526645  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.39541034e-05  9.82700383e-03 -2.06455719e-01]
Stock Position:  -1.3954103378660284e-05
Bond Position:  [10.10439817]


portfolio before change:  [10.10551342]
curr_Stock_Price:  101.1294442737996
curr_Factors:  [101.12944427  -0.63513935  -0.97803104]
mat_Sqrt:  [[20.15053681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01066915  0.06759826  0.04961228]
Stock Position:  -0.010669150506309595
Bond Position:  [11.18447868]


portfolio before change:  [10.10962384]
curr_Stock_Price:  101.00628989575208
curr_Factors:  [101.0062899   -0.99917449  -0.94031415]
mat_Sqrt:  [[14.52242713  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00525475 -0.04087972  0.00237361]
Stock Position:  0.005254754172871089
Bond Position:  [9.57886062]


portfolio before change:  [10.11851236]
curr_Stock_Price:  102.24202943431922
curr_Factors:  [102.24202943  -0.97986816  -0.96319619]
mat_Sqrt:  [[14.64762912  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00125296  0.01516645  0.10002555]
Stock Position:  -0.0012529624753156443
Bond Position:  [10.24661779]


portfolio before change:  [10.12051326]
curr_Stock_Price:  102.68983207564816
curr_Factors:  [102.68983208  -1.33887263  -0.91708723]
mat_Sqrt:  [[10.75911437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168876  0.05291711  0.08226825]
Stock Position:  -0.0016887635982786543
Bond Position:  [10.29393211]


portfolio before change:  [10.12355459]
curr_Stock_Price:  102.41298259630388
curr_Factors:  [102.4129826   -1.33383479  -0.90230571]
mat_Sqrt:  [[10.94489339  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00555303 -0.02600633 -0.09238326]
Stock Position:  -0.005553025550456106
Bond Position:  [10.6922565]


portfolio before change:  [10.12077708]
curr_Stock_Price:  103.39459382918952
curr_Factors:  [103.39459383  -1.30199724  -0.95146047]
mat_Sqrt:  [[10.86009393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01151218 -0.03878818  0.69657094]
Stock Position:  -0.0115121794372163
Bond Position:  [11.3110742]


portfolio before change:  [10.13985502]
curr_Stock_Price:  101.98306144764851
curr_Factors:  [101.98306145  -1.06831736  -0.92722654]
mat_Sqrt:  [[13.86354645  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0052616  0.03118962 0.45854804]
Stock Position:  0.005261599129471952
Bond Position:  [9.60326103]


portfolio before change:  [10.14095207]
curr_Stock_Price:  101.73521625649717
curr_Factors:  [101.73521626  -0.76124309  -0.91760125]
mat_Sqrt:  [[18.98272161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00663166  0.00134403  0.22890928]
Stock Position:  -0.006631655443785413
Bond Position:  [10.81562497]


portfolio before change:  [10.13243118]
curr_Stock_Price:  103.42787515323639
curr_Factors:  [103.42787515  -0.63534213  -0.87956304]
mat_Sqrt:  [[22.73644963  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164121 -0.00929947  0.06249173]
Stock Position:  -0.0016412104193304774
Bond Position:  [10.30217809]


portfolio before change:  [10.13507743]
curr_Stock_Price:  103.38499377056645
curr_Factors:  [103.38499377  -0.5563788   -0.83584311]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.13507743]
Stock Price:  101.51006729138845
PL:  [8.62501014]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.79671103e-01 -3.03887767e-02  8.73111976e-02]
 [-4.41931143e-03  8.00929940e-02  7.21809748e-02]
 [-2.02355320e-02 -1.44473608e-01  3.84600516e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.88548988e-01 -2.90509103e-01 -2.15931679e-01]
 [ 2.51099662e-03  1.24467872e-02 -4.24480681e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-1.17467769e-01 -4.61370819e-02 -4.96278695e-02]
 [ 5.52591172e-03  3.29776095e-02 -5.19778196e-02]
 [-1.17860819e-01  1.02570682e-01 -2.73220899e-02]
 [ 7.89882609e-02 -1.28975144e-01  7.88096165e-04]
 [-2.51002042e-02  4.91842727e-02  3.55289871e-02]
 [-2.84408595e-02  1.54707846e-01  2.38649919e-02]
 [-4.22647260e-02 -1.39881366e-01 -6.54399565e-02]
 [-1.67764086e-01 -1.16896040e-01  2.31303984e-01]
 [ 3.56676325e-02  7.25899846e-02  1.04958474e-01]
 [-1.29373172e-01  1.65273282e-02  8.08196046e-02]
 [-4.70823366e-02 -4.64678476e-02  2.19869459e-02]
 [-2.44078029e-02  5.43695348e-01  2.82898803e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.04356471]
curr_Stock_Price:  100.2462019361853
curr_Factors:  [100.24620194  -1.01681764  -0.98353698]
mat_Sqrt:  [[13.56203801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01936534 -0.00960977  0.24907454]
Stock Position:  -0.0193653353903229
Bond Position:  [5.98486603]


portfolio before change:  [4.04308696]
curr_Stock_Price:  100.3481448714823
curr_Factors:  [100.34814487  -1.0667217   -0.97101238]
mat_Sqrt:  [[13.07773947  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00094684 0.02532763 0.20591223]
Stock Position:  0.000946842579085898
Bond Position:  [3.94807306]


portfolio before change:  [4.04493462]
curr_Stock_Price:  101.25698266537451
curr_Factors:  [101.25698267  -1.36835474  -1.01829736]
mat_Sqrt:  [[ 9.30925966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00173109 -0.04568657  0.10971582]
Stock Position:  -0.001731093548828473
Bond Position:  [4.22021993]


portfolio before change:  [4.04668574]
curr_Stock_Price:  100.85496620319743
curr_Factors:  [100.8549662   -1.60067809  -1.01444653]
mat_Sqrt:  [[ 7.3784153   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00514253 -0.00455813 -0.02970002]
Stock Position:  -0.005142534764462069
Bond Position:  [4.56533591]


portfolio before change:  [4.04549136]
curr_Stock_Price:  101.30918829208065
curr_Factors:  [101.30918829  -1.16505514  -1.02180733]
mat_Sqrt:  [[11.37382472  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0296269  -0.09186704 -0.61599298]
Stock Position:  0.029626903318534053
Bond Position:  [1.04401384]


portfolio before change:  [4.03728699]
curr_Stock_Price:  101.02345454435118
curr_Factors:  [101.02345454  -1.06143716  -1.00301341]
mat_Sqrt:  [[12.81866286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045499  0.00393602 -0.12109252]
Stock Position:  -0.0004549853909633634
Bond Position:  [4.08325119]


portfolio before change:  [4.03811369]
curr_Stock_Price:  101.45038420039877
curr_Factors:  [101.4503842   -1.41098567  -1.04485322]
mat_Sqrt:  [[ 8.70354978  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00065103 -0.02845143  0.0120735 ]
Stock Position:  -0.0006510325130221152
Bond Position:  [4.10416118]


portfolio before change:  [4.03901403]
curr_Stock_Price:  101.64365619898628
curr_Factors:  [101.6436562   -0.78247811  -1.03495455]
mat_Sqrt:  [[16.51122533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0078001  -0.01458983 -0.1415745 ]
Stock Position:  -0.0078001037137845715
Bond Position:  [4.83184509]


portfolio before change:  [4.0436921]
curr_Stock_Price:  101.19879598262307
curr_Factors:  [101.19879598  -0.67909898  -1.04396201]
mat_Sqrt:  [[18.06589428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00023428  0.01042844 -0.14827825]
Stock Position:  -0.00023428334031644316
Bond Position:  [4.06740129]


portfolio before change:  [4.04519066]
curr_Stock_Price:  99.14320667367383
curr_Factors:  [99.14320667 -0.46068787 -1.06560301]
mat_Sqrt:  [[21.54781587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00560565  0.0324357  -0.07794232]
Stock Position:  -0.005605651838261429
Bond Position:  [4.60095296]


portfolio before change:  [4.03920341]
curr_Stock_Price:  100.41649854515929
curr_Factors:  [100.41649855  -0.71372082  -1.12086768]
mat_Sqrt:  [[16.03442585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00472851 -0.04078552  0.00224822]
Stock Position:  0.004728513960971627
Bond Position:  [3.5643826]


portfolio before change:  [4.05012779]
curr_Stock_Price:  102.53834289333679
curr_Factors:  [102.53834289  -1.36505047  -1.13837783]
mat_Sqrt:  [[ 8.38805359  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00197638  0.01555343  0.10135431]
Stock Position:  -0.0019763759760582727
Bond Position:  [4.25278211]


portfolio before change:  [4.05130759]
curr_Stock_Price:  102.47941029395538
curr_Factors:  [102.47941029  -1.60529033  -1.10205773]
mat_Sqrt:  [[ 6.83675937  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286318  0.04892292  0.06808018]
Stock Position:  -0.002863183852092031
Bond Position:  [4.34472499]


portfolio before change:  [4.05162363]
curr_Stock_Price:  102.74844134616471
curr_Factors:  [102.74844135  -1.66415863  -1.07116745]
mat_Sqrt:  [[ 6.66558421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00888659 -0.04423437 -0.18668198]
Stock Position:  -0.00888659127935569
Bond Position:  [4.96470703]


portfolio before change:  [4.06133072]
curr_Stock_Price:  101.79579688321144
curr_Factors:  [101.79579688  -1.36325507  -1.04616707]
mat_Sqrt:  [[ 9.14810428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01350745 -0.03696577  0.65984588]
Stock Position:  -0.01350745429815138
Bond Position:  [5.43633279]


portfolio before change:  [4.05515224]
curr_Stock_Price:  102.35383913395634
curr_Factors:  [102.35383913  -0.95770216  -1.05324707]
mat_Sqrt:  [[13.70124337  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00430373 0.02295497 0.29941731]
Stock Position:  0.004303730330220926
Bond Position:  [3.61464892]


portfolio before change:  [4.05648691]
curr_Stock_Price:  102.45395981184213
curr_Factors:  [102.45395981  -1.08581814  -1.07826778]
mat_Sqrt:  [[11.76733652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00955605  0.0052264   0.23055584]
Stock Position:  -0.009556045692730698
Bond Position:  [5.03554163]


portfolio before change:  [4.06779208]
curr_Stock_Price:  101.40267512745942
curr_Factors:  [101.40267513  -1.21138825  -1.02810316]
mat_Sqrt:  [[10.80066884  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00405475 -0.01469442  0.06272264]
Stock Position:  -0.0040547548832788076
Bond Position:  [4.47895507]


portfolio before change:  [4.06705679]
curr_Stock_Price:  101.86020324800259
curr_Factors:  [101.86020325  -0.7705022   -0.97904968]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.06705679]
Stock Price:  99.27047692739784
PL:  [4.06705679]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.84686946e-01 -5.54930247e-02  1.35763149e-01]
 [ 3.10454917e-02  4.52636598e-02  6.26161174e-03]
 [-7.80096750e-02 -3.40032832e-01  8.55266040e-03]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [-1.05819355e-01  4.60819170e-02 -5.49135725e-02]
 [-1.24474407e-01  7.68561052e-02  3.57631419e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-4.90512676e-03 -3.26939653e-02 -6.98199868e-03]
 [-1.34179167e-01  1.37042249e-02  1.49318850e-01]
 [-5.49197969e-02  6.15569555e-02 -3.92295946e-02]
 [-1.10002813e-02 -7.54267595e-02  4.86573556e-04]
 [ 1.15150942e-01  9.09333314e-02 -6.50968029e-02]
 [ 2.14013882e-02  1.51632391e-01  8.11291154e-02]
 [ 4.93394229e-03 -1.36939862e-01 -4.46823302e-02]
 [-5.31564408e-02 -5.15672284e-02  1.42156055e-01]
 [-2.26980746e-02  1.78555550e-01  2.61331388e-01]
 [-3.11088532e-02  8.78250874e-02  1.25956929e-02]
 [ 2.82131385e-03  1.06788051e-02  8.75498680e-02]
 [-3.69981951e-02  4.46730770e-01  1.61789303e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.95256104]
curr_Stock_Price:  99.27164981504954
curr_Factors:  [99.27164982 -0.80228775 -1.04312544]
mat_Sqrt:  [[15.68095381  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01010189 -0.01754844  0.38729447]
Stock Position:  -0.010101887632273392
Bond Position:  [-1.94972999]


portfolio before change:  [-2.9648817]
curr_Stock_Price:  100.44303087886844
curr_Factors:  [100.44303088  -0.72312241  -1.11836265]
mat_Sqrt:  [[15.92843146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00210268 0.01431363 0.01786264]
Stock Position:  0.0021026766240493135
Bond Position:  [-3.17608091]


portfolio before change:  [-2.96828089]
curr_Stock_Price:  99.20409922039401
curr_Factors:  [99.20409922 -0.91746093 -1.06016412]
mat_Sqrt:  [[13.72960277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00619417 -0.10752782  0.02439836]
Stock Position:  -0.006194169043671126
Bond Position:  [-2.35379393]


portfolio before change:  [-2.97050535]
curr_Stock_Price:  99.46820920479
curr_Factors:  [99.4682092  -0.75419051 -1.01732863]
mat_Sqrt:  [[16.91699847  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224294 -0.00455813 -0.02970002]
Stock Position:  -0.0022429367282818784
Bond Position:  [-2.74740445]


portfolio before change:  [-2.9647361]
curr_Stock_Price:  96.5897538853493
curr_Factors:  [96.58975389 -0.34520304 -0.96683308]
mat_Sqrt:  [[26.00884169  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00445382  0.01457238 -0.15665314]
Stock Position:  -0.004453820446118682
Bond Position:  [-2.53454267]


portfolio before change:  [-2.96811324]
curr_Stock_Price:  97.20572599996024
curr_Factors:  [97.205726   -0.47171483 -0.9281298 ]
mat_Sqrt:  [[23.97436155  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00480471  0.02430403  0.10202229]
Stock Position:  -0.004804710633542615
Bond Position:  [-2.50106785]


portfolio before change:  [-2.97087267]
curr_Stock_Price:  97.64989225725355
curr_Factors:  [97.64989226 -0.47610675 -0.95989864]
mat_Sqrt:  [[23.22857406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024394 -0.02845143  0.0120735 ]
Stock Position:  -0.00024393636351008086
Bond Position:  [-2.94705232]


portfolio before change:  [-2.97213437]
curr_Stock_Price:  99.80145384974237
curr_Factors:  [99.80145385 -0.75672735 -0.95081794]
mat_Sqrt:  [[18.09503273  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039649 -0.01033874 -0.0199177 ]
Stock Position:  -0.0003964886902933509
Bond Position:  [-2.93256423]


portfolio before change:  [-2.97215598]
curr_Stock_Price:  98.00663232953583
curr_Factors:  [98.00663233 -0.71406783 -0.97496681]
mat_Sqrt:  [[18.10160336  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0057092   0.00433366  0.42596512]
Stock Position:  -0.0057092038139948155
Bond Position:  [-2.41261614]


portfolio before change:  [-2.97415426]
curr_Stock_Price:  98.25098410129543
curr_Factors:  [98.2509841  -0.4552249  -1.00812388]
mat_Sqrt:  [[22.74115969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00269723  0.01946602 -0.11191111]
Stock Position:  -0.0026972287880842735
Bond Position:  [-2.70914888]


portfolio before change:  [-2.97172983]
curr_Stock_Price:  97.1009880074364
curr_Factors:  [97.10098801 -0.44439112 -1.00172221]
mat_Sqrt:  [[22.86570573  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056191 -0.02385204  0.00138806]
Stock Position:  -0.000561910076374529
Bond Position:  [-2.91716781]


portfolio before change:  [-2.97217892]
curr_Stock_Price:  96.60215999925663
curr_Factors:  [96.60216    -0.38282333 -0.99436664]
mat_Sqrt:  [[24.37141979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00427595  0.02875564 -0.18570306]
Stock Position:  0.004275951192518517
Bond Position:  [-3.38524504]


portfolio before change:  [-2.97353691]
curr_Stock_Price:  96.48252117585092
curr_Factors:  [96.48252118 -0.51608869 -1.02407598]
mat_Sqrt:  [[20.68062338  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00202494 0.04795037 0.23143878]
Stock Position:  0.002024935627349141
Bond Position:  [-3.1689078]


portfolio before change:  [-2.97093773]
curr_Stock_Price:  98.15739222709034
curr_Factors:  [98.15739223 -0.93324175 -1.05404617]
mat_Sqrt:  [[13.45410576  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057399 -0.04330419 -0.12746625]
Stock Position:  -0.0005739937207415776
Bond Position:  [-2.914596]


portfolio before change:  [-2.97121224]
curr_Stock_Price:  97.36604181019895
curr_Factors:  [97.36604181 -1.34375408 -1.06168181]
mat_Sqrt:  [[ 8.78496392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00289932 -0.01630699  0.40553166]
Stock Position:  -0.0028993195546503834
Bond Position:  [-2.68891697]


portfolio before change:  [-2.97008666]
curr_Stock_Price:  96.74593323590204
curr_Factors:  [96.74593324 -1.12228734 -1.0769693 ]
mat_Sqrt:  [[10.72772656  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00328646 0.05646422 0.74550571]
Stock Position:  0.003286461096592924
Bond Position:  [-3.2880384]


portfolio before change:  [-2.97060719]
curr_Stock_Price:  96.83769748149166
curr_Factors:  [96.83769748 -1.01524997 -1.09924948]
mat_Sqrt:  [[11.68769887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224767  0.02777273  0.03593201]
Stock Position:  -0.0022476737710897476
Bond Position:  [-2.75294764]


portfolio before change:  [-2.97033523]
curr_Stock_Price:  96.41046385027656
curr_Factors:  [96.41046385 -0.95600997 -1.09406461]
mat_Sqrt:  [[12.41046611  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00168955 0.00337693 0.2497554 ]
Stock Position:  0.0016895482580442814
Bond Position:  [-3.13322536]


portfolio before change:  [-2.9705595]
curr_Stock_Price:  96.74140268820089
curr_Factors:  [96.74140269 -0.95035733 -1.134075  ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.9705595]
Stock Price:  96.79153147722982
PL:  [-2.9705595]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.00342363e-01 -4.74707446e-02  1.17301573e-01]
 [-7.28799029e-03  7.33113855e-02  3.54053457e-02]
 [ 2.10187401e-02  2.99131076e-02  3.42027883e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 5.60255809e-01 -3.48541213e-01 -1.63937919e-01]
 [ 3.08591348e-02  3.69498096e-02  8.31075812e-04]
 [-3.29577149e-03 -8.84361849e-02  3.98789365e-03]
 [-1.17349484e-01 -6.31992434e-02 -5.28848982e-02]
 [-6.96281608e-02 -2.89091027e-02 -1.21317445e-01]
 [-4.96524239e-01  4.86188433e-01  4.32975366e-02]
 [ 9.68283194e-02 -1.93889107e-01  7.16781889e-02]
 [-1.02592502e-01  6.61786576e-03  1.88416402e-03]
 [-7.58048300e-02  1.52655082e-01 -3.24813642e-02]
 [-1.07639143e-01  3.11833239e-02  1.00674798e-01]
 [-1.65105647e-01 -1.28180285e-01  2.64918204e-01]
 [ 1.86956924e-02  5.22491669e-02  5.28478889e-02]
 [-9.46132640e-02  4.82975270e-02  8.36359731e-02]
 [-3.86196177e-02 -2.01507152e-02  2.03123920e-02]
 [-2.37570533e-02  4.88252951e-01  2.59365532e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.12388407]
curr_Stock_Price:  99.38708354644437
curr_Factors:  [99.38708355 -0.70858637 -1.02773031]
mat_Sqrt:  [[17.50883278  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01014482 -0.01501157  0.33462874]
Stock Position:  -0.010144820694149806
Bond Position:  [-1.11561993]


portfolio before change:  [-2.13218163]
curr_Stock_Price:  100.17749825390439
curr_Factors:  [100.17749825  -0.81473862  -1.01804992]
mat_Sqrt:  [[16.0250809   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00011432 0.0231831  0.1010016 ]
Stock Position:  0.00011432001384848158
Bond Position:  [-2.14363392]


portfolio before change:  [-2.1325396]
curr_Stock_Price:  101.73453463900667
curr_Factors:  [101.73453464  -0.85685414  -1.06298894]
mat_Sqrt:  [[14.91733162  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00192881 0.00945936 0.09757103]
Stock Position:  0.0019288106548542567
Bond Position:  [-2.32876625]


portfolio before change:  [-2.13660412]
curr_Stock_Price:  99.92914245128951
curr_Factors:  [99.92914245 -1.11766514 -1.04861693]
mat_Sqrt:  [[11.45217056  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331324 -0.00455813 -0.02970002]
Stock Position:  -0.0033132371707834548
Bond Position:  [-1.80551517]


portfolio before change:  [-2.13705965]
curr_Stock_Price:  99.93037698663034
curr_Factors:  [99.93037699 -0.98903541 -1.07218558]
mat_Sqrt:  [[12.72098162  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04070384 -0.11021841 -0.46766925]
Stock Position:  0.040703842032128464
Bond Position:  [-6.20460993]


portfolio before change:  [-2.13663234]
curr_Stock_Price:  99.978988075043
curr_Factors:  [99.97898808 -0.8388279  -1.09913692]
mat_Sqrt:  [[14.39664544  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00222155 0.01168456 0.00237083]
Stock Position:  0.0022215465090106024
Bond Position:  [-2.35874031]


portfolio before change:  [-2.13383137]
curr_Stock_Price:  101.50528123120144
curr_Factors:  [101.50528123  -0.85764991  -1.09511669]
mat_Sqrt:  [[14.40167077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033088 -0.02796598  0.01137635]
Stock Position:  -0.00033087540027417617
Bond Position:  [-2.10024577]


portfolio before change:  [-2.13430107]
curr_Stock_Price:  101.3377910912544
curr_Factors:  [101.33779109  -0.41354764  -1.13111344]
mat_Sqrt:  [[21.62388123  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00600153 -0.01998536 -0.15086589]
Stock Position:  -0.0060015297331704074
Bond Position:  [-1.52611931]


portfolio before change:  [-2.15254735]
curr_Stock_Price:  104.31448235886386
curr_Factors:  [104.31448236  -0.71532878  -1.17353535]
mat_Sqrt:  [[15.77688797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00603024 -0.00914186 -0.3460849 ]
Stock Position:  -0.006030239334424381
Bond Position:  [-1.52350606]


portfolio before change:  [-2.15925336]
curr_Stock_Price:  105.3633765860831
curr_Factors:  [105.36337659  -0.98380886  -1.1714188 ]
mat_Sqrt:  [[12.20917159  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03891606  0.15374628  0.12351582]
Stock Position:  -0.03891605843918881
Bond Position:  [1.94107396]


portfolio before change:  [-2.18443403]
curr_Stock_Price:  106.02289872700345
curr_Factors:  [106.02289873  -0.90681735  -1.1841656 ]
mat_Sqrt:  [[13.10078493  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00812572 -0.06131312  0.20447792]
Stock Position:  0.008125724818619059
Bond Position:  [-3.04594693]


portfolio before change:  [-2.19034621]
curr_Stock_Price:  105.38903632525033
curr_Factors:  [105.38903633  -0.92083505  -1.19095086]
mat_Sqrt:  [[12.754354    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00800017  0.00209275  0.005375  ]
Stock Position:  -0.008000171990351407
Bond Position:  [-1.34721579]


portfolio before change:  [-2.19224122]
curr_Stock_Price:  105.58380259019192
curr_Factors:  [105.58380259  -1.1641223   -1.19250217]
mat_Sqrt:  [[10.00295451  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00784703  0.04827378 -0.09266029]
Stock Position:  -0.007847033928863368
Bond Position:  [-1.36372154]


portfolio before change:  [-2.19555805]
curr_Stock_Price:  105.96303620773384
curr_Factors:  [105.96303621  -1.19256533  -1.16584605]
mat_Sqrt:  [[10.02096042  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00861034  0.00986103  0.28719718]
Stock Position:  -0.008610335957229567
Bond Position:  [-1.28318071]


portfolio before change:  [-2.19628744]
curr_Stock_Price:  106.01048572972599
curr_Factors:  [106.01048573  -1.1963462   -1.20381572]
mat_Sqrt:  [[ 9.61549716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01189112 -0.04053417  0.7557379 ]
Stock Position:  -0.011891121543025535
Bond Position:  [-0.93570387]


portfolio before change:  [-2.18858541]
curr_Stock_Price:  105.3430985429929
curr_Factors:  [105.34309854  -1.13951173  -1.18306651]
mat_Sqrt:  [[10.32578733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00298595 0.01652264 0.15076032]
Stock Position:  0.0029859505409433767
Bond Position:  [-2.5031347]


portfolio before change:  [-2.18729861]
curr_Stock_Price:  105.98365295502317
curr_Factors:  [105.98365296  -1.65763518  -1.21507734]
mat_Sqrt:  [[ 5.99288147  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01273079  0.01527302  0.23859015]
Stock Position:  -0.012730788367644238
Bond Position:  [-0.83804316]


portfolio before change:  [-2.17963865]
curr_Stock_Price:  105.36550633082048
curr_Factors:  [105.36550633  -1.53674989  -1.23207121]
mat_Sqrt:  [[ 6.61020206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00529389 -0.00637222  0.0579456 ]
Stock Position:  -0.005293886176167656
Bond Position:  [-1.62184566]


portfolio before change:  [-2.18120708]
curr_Stock_Price:  105.5851777374572
curr_Factors:  [105.58517774  -1.51166184  -1.19175784]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.18120708]
Stock Price:  105.33185345027712
PL:  [-7.51306053]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.85192804e-01 -3.09262047e-02  8.98794241e-02]
 [-1.97679070e-02  9.06882726e-02  8.10647373e-02]
 [-1.19330675e-01 -3.67076033e-01 -2.67316785e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 5.65417285e-01 -3.52288308e-01 -1.73698446e-01]
 [ 4.56665353e-02  2.85158152e-02 -8.79782835e-03]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 4.55453330e-03 -3.18818395e-02 -2.29787741e-03]
 [-7.72528771e-02  2.42395633e-02  5.36927801e-02]
 [-2.35451604e-01  2.20383785e-01  1.39811833e-02]
 [ 7.59202763e-02 -1.27206988e-01  1.22792421e-03]
 [-2.72998506e-02  4.75512151e-02  3.49074000e-02]
 [-1.73085447e-02  1.71028895e-01  4.32510908e-02]
 [-4.43732093e-02 -8.73082458e-02 -5.68339627e-02]
 [-1.51153747e-01 -1.06898037e-01  2.16906757e-01]
 [ 3.02152595e-02  1.34937353e-01  2.20469597e-01]
 [-9.35109939e-02  6.13041748e-02  6.91685872e-02]
 [-4.28998405e-02 -3.44661420e-02  2.17940601e-02]
 [-3.35809136e-02  4.68511267e-01  2.08510298e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.13308134]
curr_Stock_Price:  100.11937266977766
curr_Factors:  [100.11937267  -0.95328297  -0.92664214]
mat_Sqrt:  [[15.2783698   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01751789 -0.00977972  0.25640098]
Stock Position:  -0.01751788689654585
Bond Position:  [4.88696119]


portfolio before change:  [3.13234701]
curr_Stock_Price:  100.23104300593343
curr_Factors:  [100.23104301  -1.0743437   -0.9230709 ]
mat_Sqrt:  [[13.59991236  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.46383298e-05  2.86781499e-02  2.31255131e-01]
Stock Position:  -6.46383297928479e-05
Bond Position:  [3.13882578]


portfolio before change:  [3.13324011]
curr_Stock_Price:  98.55568637813022
curr_Factors:  [98.55568638 -0.66266605 -0.9177129 ]
mat_Sqrt:  [[20.29232594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00661655 -0.11607963 -0.07625804]
Stock Position:  -0.006616546509506233
Bond Position:  [3.78533839]


portfolio before change:  [3.11963127]
curr_Stock_Price:  100.75551739475235
curr_Factors:  [100.75551739  -0.7887656   -0.94462098]
mat_Sqrt:  [[17.80199243  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213143 -0.00455813 -0.02970002]
Stock Position:  -0.0021314331723641
Bond Position:  [3.33438493]


portfolio before change:  [3.1246546]
curr_Stock_Price:  98.78988015232163
curr_Factors:  [98.78988015 -1.03049513 -0.93836483]
mat_Sqrt:  [[13.79264132  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03776399 -0.11140334 -0.49551332]
Stock Position:  0.0377639918066637
Bond Position:  [-0.60604563]


portfolio before change:  [3.17102367]
curr_Stock_Price:  100.02175740384074
curr_Factors:  [100.0217574   -1.02866027  -0.9508864 ]
mat_Sqrt:  [[13.81618966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0032286   0.00901749 -0.02509776]
Stock Position:  0.0032286008201629045
Bond Position:  [2.84809334]


portfolio before change:  [3.17460017]
curr_Stock_Price:  100.90894880307648
curr_Factors:  [100.9089488   -1.08042466  -0.93530912]
mat_Sqrt:  [[13.44335361  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042149 -0.02845143  0.0120735 ]
Stock Position:  -0.0004214940745548897
Bond Position:  [3.21713269]


portfolio before change:  [3.17565896]
curr_Stock_Price:  100.30536263737365
curr_Factors:  [100.30536264  -1.16453751  -0.97231504]
mat_Sqrt:  [[11.83861459  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00027556 -0.01008192 -0.0065552 ]
Stock Position:  0.00027556395655504404
Bond Position:  [3.14801842]


portfolio before change:  [3.17622387]
curr_Stock_Price:  99.49904762779721
curr_Factors:  [99.49904763 -1.23977007 -1.00389869]
mat_Sqrt:  [[10.55372956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00622216  0.00766522  0.15317056]
Stock Position:  -0.006222162613638619
Bond Position:  [3.79532313]


portfolio before change:  [3.17284589]
curr_Stock_Price:  100.19445404713156
curr_Factors:  [100.19445405  -1.03459258  -1.02055038]
mat_Sqrt:  [[12.83235712  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01768244  0.06969147  0.03988442]
Stock Position:  -0.017682442901710945
Bond Position:  [4.9445286]


portfolio before change:  [3.1558834]
curr_Stock_Price:  101.22365421678323
curr_Factors:  [101.22365422  -1.13311369  -1.02467892]
mat_Sqrt:  [[11.69942699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00622992 -0.04022638  0.00350293]
Stock Position:  0.0062299166520688
Bond Position:  [2.52526848]


portfolio before change:  [3.16302419]
curr_Stock_Price:  102.26851387638916
curr_Factors:  [102.26851388  -1.22710925  -0.99345793]
mat_Sqrt:  [[11.10099417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170675  0.01503701  0.0995811 ]
Stock Position:  -0.0017067516708605141
Bond Position:  [3.33757115]


portfolio before change:  [3.16613045]
curr_Stock_Price:  100.93746947928001
curr_Factors:  [100.93746948  -0.93016442  -0.9750855 ]
mat_Sqrt:  [[15.0180271   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027061  0.05408409  0.12338332]
Stock Position:  -0.0002706084961774779
Bond Position:  [3.19344499]


portfolio before change:  [3.16691358]
curr_Stock_Price:  100.9941051499016
curr_Factors:  [100.99410515  -1.08625627  -0.96097993]
mat_Sqrt:  [[13.03744957  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00446626 -0.02760929 -0.16213148]
Stock Position:  -0.004466263305846302
Bond Position:  [3.61797985]


portfolio before change:  [3.16526227]
curr_Stock_Price:  101.56637748731855
curr_Factors:  [101.56637749  -1.22568594  -0.91345063]
mat_Sqrt:  [[11.96009843  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00916698 -0.03380413  0.6187746 ]
Stock Position:  -0.0091669760596195
Bond Position:  [4.09631882]


portfolio before change:  [3.16368922]
curr_Stock_Price:  101.849705686101
curr_Factors:  [101.84970569  -1.48548448  -0.8958285 ]
mat_Sqrt:  [[ 9.4138807   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00836026 0.04267094 0.62893839]
Stock Position:  0.008360260507366763
Bond Position:  [2.31219915]


portfolio before change:  [3.17335703]
curr_Stock_Price:  102.93695585801308
curr_Factors:  [102.93695586  -1.42554125  -0.93388365]
mat_Sqrt:  [[ 9.72492156  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00800101  0.01938608  0.19731873]
Stock Position:  -0.008001005224866657
Bond Position:  [3.99695616]


portfolio before change:  [3.17280401]
curr_Stock_Price:  103.13097945859602
curr_Factors:  [103.13097946  -1.5017407   -0.94178202]
mat_Sqrt:  [[ 8.95737399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00439203 -0.01089915  0.06217239]
Stock Position:  -0.004392030366007142
Bond Position:  [3.62575841]


portfolio before change:  [3.17697451]
curr_Stock_Price:  102.38782793884039
curr_Factors:  [102.38782794  -1.6224177   -0.93851929]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.17697451]
Stock Price:  102.61766910125814
PL:  [0.55930541]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.36305780e-01 -2.61680224e-02  6.71413284e-02]
 [-1.75009867e-01  1.58930701e-01  1.76052636e-04]
 [-8.79417470e-02 -3.12866193e-01 -4.40223434e-03]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.16816850e-01 -2.39337399e-01 -1.77876810e-01]
 [-9.29249298e-02  6.91460928e-02  3.01585798e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 2.92649525e-01  1.85139147e-02  1.15319169e-02]
 [-2.00913718e-01  2.58775284e-03  2.55161780e-01]
 [-1.45560212e-01  1.20885225e-01 -3.02716048e-02]
 [-3.17966326e-02 -6.32994221e-02  2.35677619e-03]
 [ 9.66395518e-02  1.09808981e-01 -2.04726200e-02]
 [ 1.71955147e-02  1.49302868e-01  7.52928628e-02]
 [-4.99191544e-03 -1.18248261e-01 -4.80119528e-02]
 [-5.21024333e-02 -5.02910595e-02  1.39453452e-01]
 [-1.91443799e-02  1.79147131e-01  2.88439315e-01]
 [-3.81106122e-02  9.46223069e-02  1.25898214e-02]
 [ 3.22057707e-02  4.37197736e-02  1.36057432e-01]
 [-3.74356378e-02  4.45050925e-01  1.54816965e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.09857478]
curr_Stock_Price:  100.81106008763221
curr_Factors:  [100.81106009  -1.0347059   -1.00111583]
mat_Sqrt:  [[13.16321689  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01696214 -0.00827506  0.19153552]
Stock Position:  -0.016962135515532713
Bond Position:  [9.80854564]


portfolio before change:  [8.12129821]
curr_Stock_Price:  99.61598710919313
curr_Factors:  [99.61598711 -0.60280668 -1.00110932]
mat_Sqrt:  [[20.033516    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00852922  0.0502583   0.00050223]
Stock Position:  -0.008529224586929863
Bond Position:  [8.97094534]


portfolio before change:  [8.12954365]
curr_Stock_Price:  98.9122394036321
curr_Factors:  [98.9122394  -0.69103573 -1.02645691]
mat_Sqrt:  [[17.75629923  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00545826 -0.09893698 -0.01255835]
Stock Position:  -0.0054582612274004265
Bond Position:  [8.66943249]


portfolio before change:  [8.12486216]
curr_Stock_Price:  100.16705648653912
curr_Factors:  [100.16705649  -0.66873107  -1.03176854]
mat_Sqrt:  [[18.28973083  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207459 -0.00455813 -0.02970002]
Stock Position:  -0.0020745935270819076
Bond Position:  [8.33266808]


portfolio before change:  [8.1252883]
curr_Stock_Price:  100.96590324103806
curr_Factors:  [100.96590324  -0.66257862  -1.01699238]
mat_Sqrt:  [[18.82549116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01457217 -0.07568513 -0.50743303]
Stock Position:  0.014572168674221566
Bond Position:  [6.65399613]


portfolio before change:  [8.08563361]
curr_Stock_Price:  98.13047108261755
curr_Factors:  [98.13047108 -0.57145273 -1.01547037]
mat_Sqrt:  [[20.07298395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00423372  0.02186591  0.08603403]
Stock Position:  -0.004233724855531287
Bond Position:  [8.50109103]


portfolio before change:  [8.08347672]
curr_Stock_Price:  99.1419753138224
curr_Factors:  [99.14197531 -0.70052036 -1.0130453 ]
mat_Sqrt:  [[17.86756851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00031713 -0.02845143  0.0120735 ]
Stock Position:  -0.00031712730719610916
Bond Position:  [8.11491735]


portfolio before change:  [8.08585117]
curr_Stock_Price:  98.05261373727416
curr_Factors:  [98.05261374 -1.17251958 -1.00992774]
mat_Sqrt:  [[11.05692465  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02672366 0.00585461 0.03289735]
Stock Position:  0.026723660016474714
Bond Position:  [5.46552646]


portfolio before change:  [8.06114225]
curr_Stock_Price:  97.07686896703773
curr_Factors:  [97.07686897 -1.06419717 -1.02241981]
mat_Sqrt:  [[12.04784917  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01234762  0.00081832  0.72790553]
Stock Position:  -0.012347616589188037
Bond Position:  [9.25981021]


portfolio before change:  [8.06254165]
curr_Stock_Price:  97.151040777215
curr_Factors:  [97.15104078 -1.34327704 -1.00584635]
mat_Sqrt:  [[ 9.27333887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01602639  0.03822726 -0.08635646]
Stock Position:  -0.016026388806135133
Bond Position:  [9.619522]


portfolio before change:  [8.0625546]
curr_Stock_Price:  97.30030872958845
curr_Factors:  [97.30030873 -1.12653274 -0.99983091]
mat_Sqrt:  [[11.60502878  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00283928 -0.02001703  0.00672323]
Stock Position:  -0.0028392813478890482
Bond Position:  [8.33881756]


portfolio before change:  [8.06304578]
curr_Stock_Price:  97.86164283130914
curr_Factors:  [97.86164283 -1.128866   -1.08170845]
mat_Sqrt:  [[10.72932044  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00888182  0.03472465 -0.05840269]
Stock Position:  0.00888181613265938
Bond Position:  [7.19385667]


portfolio before change:  [8.0580235]
curr_Stock_Price:  97.09367290750443
curr_Factors:  [97.09367291 -0.79025577 -1.09962174]
mat_Sqrt:  [[14.66991357  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0024826  0.04721371 0.21478958]
Stock Position:  0.0024826042284286044
Bond Position:  [7.81697834]


portfolio before change:  [8.05954327]
curr_Stock_Price:  96.91856521778297
curr_Factors:  [96.91856522 -0.41077378 -1.1601267 ]
mat_Sqrt:  [[20.14529188  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00088584 -0.03739338 -0.13696474]
Stock Position:  -0.0008858383060151204
Bond Position:  [8.14539745]


portfolio before change:  [8.062768]
curr_Stock_Price:  95.5773226353418
curr_Factors:  [95.57732264 -0.79808058 -1.14922359]
mat_Sqrt:  [[13.63488274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182877 -0.01590343  0.39782188]
Stock Position:  -0.001828774523909242
Bond Position:  [8.23755737]


portfolio before change:  [8.06516015]
curr_Stock_Price:  95.39550668625614
curr_Factors:  [95.39550669 -0.97727517 -1.12065033]
mat_Sqrt:  [[11.70605214  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00378937 0.0566513  0.82283708]
Stock Position:  0.003789373849235529
Bond Position:  [7.70367091]


portfolio before change:  [8.06388627]
curr_Stock_Price:  94.5510321946012
curr_Factors:  [94.55103219 -0.34958181 -1.10613897]
mat_Sqrt:  [[22.05234476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00150086  0.0299222   0.03591526]
Stock Position:  -0.0015008648075371012
Bond Position:  [8.20579459]


portfolio before change:  [8.06545089]
curr_Stock_Price:  94.87556885134066
curr_Factors:  [94.87556885 -0.4096367  -1.04591569]
mat_Sqrt:  [[22.1317635   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00276106 0.01382541 0.38813398]
Stock Position:  0.0027610640882155817
Bond Position:  [7.80349337]


portfolio before change:  [8.06999679]
curr_Stock_Price:  95.81534516227892
curr_Factors:  [95.81534516 -0.94554692 -1.03049881]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.06999679]
Stock Price:  93.34693341434064
PL:  [8.06999679]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.80123228e-01 -3.04327820e-02  8.75214876e-02]
 [ 6.38538667e-02  3.20286086e-02  2.85638783e-02]
 [ 6.37812282e-03 -1.91679140e-02  3.36349557e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 4.27339215e-01 -2.83279894e-01 -1.59961045e-01]
 [-2.66041783e-02  5.30871744e-02  1.57443081e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 1.25080168e-01 -1.05553249e-02  2.17635332e-03]
 [-1.83288085e-02  3.04595291e-02 -2.15262676e-02]
 [-1.72034340e-01  1.57335156e-01 -5.14886963e-03]
 [ 7.43110553e-02 -1.26270457e-01  1.38737680e-03]
 [ 5.66725418e-02  9.65401972e-02  2.04544038e-02]
 [-1.27894751e-02  1.66983774e-01  4.69824285e-02]
 [-4.40664015e-02 -1.24219223e-01 -5.57755681e-02]
 [-1.45136639e-01 -1.08662496e-01  2.26706839e-01]
 [ 3.24770560e-02  7.05055996e-02  9.44179424e-02]
 [-1.03243057e-01  4.20652294e-02  8.09287133e-02]
 [-3.87052876e-02 -2.12178496e-02  2.08350975e-02]
 [-3.02522764e-02  4.76372620e-01  2.26577993e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.35085779]
curr_Stock_Price:  100.28900750189378
curr_Factors:  [100.2890075   -1.10545586  -0.99936273]
mat_Sqrt:  [[12.22199876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02152215 -0.00962369  0.24967444]
Stock Position:  -0.021522154858005897
Bond Position:  [6.50929334]


portfolio before change:  [4.32737978]
curr_Stock_Price:  101.4555048546807
curr_Factors:  [101.45550485  -0.98028079  -1.00969917]
mat_Sqrt:  [[13.86878126  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00508418 0.01012834 0.08148479]
Stock Position:  0.005084182796287379
Bond Position:  [3.81156145]


portfolio before change:  [4.32941904]
curr_Stock_Price:  101.66915842848617
curr_Factors:  [101.66915843  -1.06220891  -1.0051251 ]
mat_Sqrt:  [[12.86345046  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0009911  -0.00606143  0.09595117]
Stock Position:  0.0009910961323072727
Bond Position:  [4.22865513]


portfolio before change:  [4.32914278]
curr_Stock_Price:  100.32362070819632
curr_Factors:  [100.32362071  -0.93042515  -0.9993166 ]
mat_Sqrt:  [[14.5655538   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260503 -0.00455813 -0.02970002]
Stock Position:  -0.002605033609272556
Bond Position:  [4.59048918]


portfolio before change:  [4.3318922]
curr_Stock_Price:  99.70879101321076
curr_Factors:  [99.70879101 -0.70513293 -0.99150963]
mat_Sqrt:  [[18.27641235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02119525 -0.08958097 -0.45632434]
Stock Position:  0.02119524558212095
Bond Position:  [2.21853989]


portfolio before change:  [4.32498526]
curr_Stock_Price:  99.35674796447255
curr_Factors:  [99.35674796 -1.0489761  -0.97613944]
mat_Sqrt:  [[13.11296392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00167923  0.01678764  0.04491413]
Stock Position:  -0.00167922981109024
Bond Position:  [4.49182808]


portfolio before change:  [4.32652286]
curr_Stock_Price:  99.10991164065554
curr_Factors:  [99.10991164 -1.04222741 -0.98996098]
mat_Sqrt:  [[12.98819746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043626 -0.02845143  0.0120735 ]
Stock Position:  -0.0004362648400951973
Bond Position:  [4.36976103]


portfolio before change:  [4.32759329]
curr_Stock_Price:  99.16065799158079
curr_Factors:  [99.16065799 -1.02811681 -1.00598516]
mat_Sqrt:  [[12.97000482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00965704 -0.00333789  0.00620853]
Stock Position:  0.00965704168198003
Bond Position:  [3.36999469]


portfolio before change:  [4.34509518]
curr_Stock_Price:  100.88575001168728
curr_Factors:  [100.88575001  -1.12847124  -1.01170005]
mat_Sqrt:  [[11.86766415  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184842  0.00963215 -0.06140845]
Stock Position:  -0.001848415791950635
Bond Position:  [4.531574]


portfolio before change:  [4.34792362]
curr_Stock_Price:  99.96852905239265
curr_Factors:  [99.96852905 -0.59081518 -1.05818999]
mat_Sqrt:  [[19.21805611  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00879501  0.04975375 -0.01468829]
Stock Position:  -0.008795008776755042
Bond Position:  [5.22714772]


portfolio before change:  [4.34382787]
curr_Stock_Price:  100.58282098752882
curr_Factors:  [100.58282099  -0.87799047  -1.10838666]
mat_Sqrt:  [[13.79911348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00516946 -0.03993022  0.0039578 ]
Stock Position:  0.005169459856015571
Bond Position:  [3.82386902]


portfolio before change:  [4.33949722]
curr_Stock_Price:  99.5601339049794
curr_Factors:  [99.5601339  -0.88087369 -1.1079014 ]
mat_Sqrt:  [[13.62609541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00464847 0.03052869 0.05835072]
Stock Position:  0.004648465666920565
Bond Position:  [3.87669535]


portfolio before change:  [4.34198872]
curr_Stock_Price:  99.88759772496317
curr_Factors:  [99.88759772 -0.80291909 -1.11869087]
mat_Sqrt:  [[14.62065954  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [7.60756029e-05 5.28049057e-02 1.34027791e-01]
Stock Position:  7.607560293863281e-05
Bond Position:  [4.33438971]


portfolio before change:  [4.3431252]
curr_Stock_Price:  100.58093334519305
curr_Factors:  [100.58093335  -0.98532787  -1.14125533]
mat_Sqrt:  [[11.99367601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00489082 -0.03928157 -0.15911217]
Stock Position:  -0.004890816476357413
Bond Position:  [4.83504808]


portfolio before change:  [4.3336707]
curr_Stock_Price:  102.76122668134337
curr_Factors:  [102.76122668  -1.10613796  -1.09847721]
mat_Sqrt:  [[11.33383996  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00897012 -0.0343621   0.64673151]
Stock Position:  -0.008970124307586386
Bond Position:  [5.25545167]


portfolio before change:  [4.33929098]
curr_Stock_Price:  102.28115995961103
curr_Factors:  [102.28115996  -0.99438595  -1.10895638]
mat_Sqrt:  [[12.48319275  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00429141 0.02229583 0.26934811]
Stock Position:  0.004291408909647818
Bond Position:  [3.9003607]


portfolio before change:  [4.34654715]
curr_Stock_Price:  103.74477218303622
curr_Factors:  [103.74477218  -1.30113115  -1.08957902]
mat_Sqrt:  [[ 9.49935207  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00901508  0.01330219  0.23086709]
Stock Position:  -0.009015081476328898
Bond Position:  [5.28181473]


portfolio before change:  [4.33601349]
curr_Stock_Price:  105.05971145409492
curr_Factors:  [105.05971145  -1.4260944   -1.08798581]
mat_Sqrt:  [[ 8.50325185  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00411609 -0.00670967  0.05943673]
Stock Position:  -0.004116093975244198
Bond Position:  [4.76844913]


portfolio before change:  [4.33955573]
curr_Stock_Price:  104.48878545642918
curr_Factors:  [104.48878546  -1.69305956  -1.08142815]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.33955573]
Stock Price:  104.7415326899922
PL:  [-0.40197696]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.43017652e-01 -1.70882732e-02  2.37516067e-02]
 [ 7.43734146e-02  1.98346285e-02  8.38770872e-04]
 [-9.39596066e-03 -1.35942003e-01  3.82560369e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 2.04433336e-01 -1.81890581e-01 -1.72856336e-01]
 [ 1.17653274e-01 -7.13364053e-02 -5.43048859e-02]
 [ 1.88824615e-02 -7.47892830e-02 -1.75708841e-03]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [-3.62324095e-02 -9.29785372e-03 -1.18659808e-01]
 [-3.80871597e-01  3.71689752e-01  3.18728014e-02]
 [ 1.05436921e-01 -1.84358872e-01  5.11221358e-02]
 [-7.34146925e-02  2.24785114e-02  1.46831243e-02]
 [-8.70708840e-02  1.61957479e-01 -4.20869180e-02]
 [-1.27707782e-01 -2.15539310e-02  1.86557225e-01]
 [-1.54954860e-01 -1.10243477e-01  2.23149451e-01]
 [ 3.74113448e-03  9.56952158e-02  1.23360887e-01]
 [-1.76666447e-02  6.22091711e-02  2.47439654e-03]
 [ 9.66989299e-02  5.08090280e-02  1.75767876e-01]
 [-3.65783990e-02  4.59688718e-01  1.32214309e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.30004193]
curr_Stock_Price:  102.09281368166346
curr_Factors:  [102.09281368  -0.68562871  -1.00845518]
mat_Sqrt:  [[18.76134165  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0073881  -0.00540379  0.06775672]
Stock Position:  -0.007388095993728398
Bond Position:  [18.05431343]


portfolio before change:  [17.30986865]
curr_Stock_Price:  101.37374108509616
curr_Factors:  [101.37374109  -0.78460951  -1.04099232]
mat_Sqrt:  [[16.33340279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00459529 0.00627226 0.00239278]
Stock Position:  0.0045952920431362515
Bond Position:  [16.8440267]


portfolio before change:  [17.3095732]
curr_Stock_Price:  100.39295858134983
curr_Factors:  [100.39295858  -0.76735949  -1.04801125]
mat_Sqrt:  [[16.3417196   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003119  -0.04298864  0.10913382]
Stock Position:  -0.0003119003007164318
Bond Position:  [17.34088579]


portfolio before change:  [17.3139567]
curr_Stock_Price:  100.23990987084382
curr_Factors:  [100.23990987  -0.60701451  -1.10227953]
mat_Sqrt:  [[18.14277437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0020914  -0.00455813 -0.02970002]
Stock Position:  -0.002091397733102665
Bond Position:  [17.52359822]


portfolio before change:  [17.31588786]
curr_Stock_Price:  101.41150936572643
curr_Factors:  [101.41150937  -0.66747748  -1.12343443]
mat_Sqrt:  [[16.91624956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00972159 -0.05751885 -0.49311101]
Stock Position:  0.00972158685744657
Bond Position:  [16.33000707]


portfolio before change:  [17.3237105]
curr_Stock_Price:  101.7961812371482
curr_Factors:  [101.79618124  -0.48915526  -1.13487486]
mat_Sqrt:  [[20.06430701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00521954 -0.02255855 -0.15491672]
Stock Position:  0.00521953924700313
Bond Position:  [16.79238133]


portfolio before change:  [17.3328569]
curr_Stock_Price:  102.74411624240624
curr_Factors:  [102.74411624  -0.76905254  -1.10494399]
mat_Sqrt:  [[15.7721394   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00105203 -0.02365045 -0.00501248]
Stock Position:  0.001052028890428568
Bond Position:  [17.22476712]


portfolio before change:  [17.33713889]
curr_Stock_Price:  102.72060456661147
curr_Factors:  [102.72060457  -0.75739247  -1.05620526]
mat_Sqrt:  [[16.75028029  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00833331 -0.01496598 -0.14840805]
Stock Position:  -0.008333313336992403
Bond Position:  [18.19314188]


portfolio before change:  [17.33542733]
curr_Stock_Price:  103.47185676958229
curr_Factors:  [103.47185677  -0.71226029  -1.07514832]
mat_Sqrt:  [[17.32050494  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00350416 -0.00294024 -0.3385034 ]
Stock Position:  -0.0035041594460958167
Bond Position:  [17.69800921]


portfolio before change:  [17.3383299]
curr_Stock_Price:  103.90633693933724
curr_Factors:  [103.90633694  -0.70697305  -1.09063717]
mat_Sqrt:  [[17.21669699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02118691  0.11753862  0.09092423]
Stock Position:  -0.02118690948816099
Bond Position:  [19.53978405]


portfolio before change:  [17.3401963]
curr_Stock_Price:  104.04883770637815
curr_Factors:  [104.04883771  -0.41794433  -1.11797539]
mat_Sqrt:  [[22.39730548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00496096 -0.05829939  0.14583722]
Stock Position:  0.0049609564818920045
Bond Position:  [16.82401455]


portfolio before change:  [17.34629555]
curr_Stock_Price:  104.4303606375287
curr_Factors:  [104.43036064  -0.47476923  -1.13794629]
mat_Sqrt:  [[20.81772784  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00335469  0.00710833  0.04188687]
Stock Position:  -0.003354694621208433
Bond Position:  [17.69662752]


portfolio before change:  [17.34698914]
curr_Stock_Price:  105.54257053063968
curr_Factors:  [105.54257053  -0.56026565  -1.15058045]
mat_Sqrt:  [[19.07289634  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00479634  0.05121545 -0.12006226]
Stock Position:  -0.00479634106685891
Bond Position:  [17.8532073]


portfolio before change:  [17.35519732]
curr_Stock_Price:  104.76190892460423
curr_Factors:  [104.76190892  -0.31229428  -1.11514797]
mat_Sqrt:  [[25.13466569  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00358801 -0.00681595  0.53219584]
Stock Position:  -0.0035880114464913104
Bond Position:  [17.73108424]


portfolio before change:  [17.38032539]
curr_Stock_Price:  98.9941593987943
curr_Factors:  [ 9.89941594e+01 -4.63616984e-02 -1.08064446e+00]
mat_Sqrt:  [[32.07428748  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00349972 -0.03486205  0.63658327]
Stock Position:  -0.003499723692865651
Bond Position:  [17.7267776]


portfolio before change:  [17.39139331]
curr_Stock_Price:  97.09810298482148
curr_Factors:  [97.09810298 -0.09902749 -1.10506771]
mat_Sqrt:  [[29.12586572  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00107784 0.03026148 0.35191427]
Stock Position:  0.0010778361123186672
Bond Position:  [17.28673747]


portfolio before change:  [17.39107434]
curr_Stock_Price:  92.79206974433761
curr_Factors:  [92.79206974 -0.11554996 -1.09892061]
mat_Sqrt:  [[27.54691653  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056468  0.01967227  0.00705876]
Stock Position:  -0.000564684862385861
Bond Position:  [17.44347262]


portfolio before change:  [17.39589287]
curr_Stock_Price:  91.9825686888647
curr_Factors:  [91.98256869 -0.14524671 -1.07753484]
mat_Sqrt:  [[27.08059828  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0049441  0.01606723 0.50141683]
Stock Position:  0.004944103504079859
Bond Position:  [16.94112153]


portfolio before change:  [17.39557071]
curr_Stock_Price:  91.0606697671963
curr_Factors:  [91.06066977 -0.32232333 -1.03432565]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.39557071]
Stock Price:  89.75854953517933
PL:  [17.39557071]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.61011878e-01 -5.02177794e-02  1.37003742e-01]
 [ 8.61611689e-03  7.47936253e-02  8.08630647e-02]
 [-8.38614624e-03 -9.78607747e-02  3.36508915e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.72779260e-01 -3.14223056e-01 -2.82292766e-01]
 [ 1.38870086e-01 -4.88842585e-02 -3.36909465e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 9.54634495e-02 -1.37247665e-02 -8.58934228e-03]
 [-1.12620625e-01  1.91583994e-02  1.05677164e-01]
 [-1.49407416e-01  1.31803340e-01 -1.80747397e-02]
 [ 4.65432803e-02 -1.09952668e-01  2.90488693e-03]
 [ 5.90728004e-02  9.68743840e-02  1.96874169e-02]
 [ 3.71828022e-03  1.64617832e-01  6.54257738e-02]
 [-4.23581764e-02 -7.80788087e-02 -6.71275769e-02]
 [-1.34033484e-01 -9.46970521e-02  1.96781833e-01]
 [ 9.25905401e-03  1.22616511e-01  1.77284525e-01]
 [-4.32127606e-02  1.10563994e-01  1.95865314e-02]
 [-5.02802838e-02 -5.79657836e-02  2.36006777e-02]
 [-3.42348861e-02  4.67772156e-01  1.97424048e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.9576418]
curr_Stock_Price:  99.54953972882076
curr_Factors:  [99.54953973 -0.96561762 -1.01873194]
mat_Sqrt:  [[13.68507533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01712396 -0.01588026  0.39083354]
Stock Position:  -0.017123963036217757
Bond Position:  [0.74704084]


portfolio before change:  [-0.97390885]
curr_Stock_Price:  100.51040592017509
curr_Factors:  [100.51040592  -1.17830636  -1.00033827]
mat_Sqrt:  [[11.37726009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00237785 0.02365182 0.23067982]
Stock Position:  0.002377847015634839
Bond Position:  [-1.21290722]


portfolio before change:  [-0.97270384]
curr_Stock_Price:  101.144708720484
curr_Factors:  [101.14470872  -1.07065971  -0.98441405]
mat_Sqrt:  [[12.95495696  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00031215 -0.03094629  0.09599663]
Stock Position:  -0.00031215396027946686
Bond Position:  [-0.94113112]


portfolio before change:  [-0.97377068]
curr_Stock_Price:  103.80854283972126
curr_Factors:  [103.80854284  -0.62028193  -1.03899522]
mat_Sqrt:  [[19.75232335  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00192098 -0.00455813 -0.02970002]
Stock Position:  -0.0019209769164991904
Bond Position:  [-0.77435686]


portfolio before change:  [-0.97480485]
curr_Stock_Price:  104.24611178439767
curr_Factors:  [104.24611178  -0.5312585   -1.05786195]
mat_Sqrt:  [[21.27715806  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01443065 -0.09936606 -0.80530269]
Stock Position:  0.014430653057606971
Bond Position:  [-2.47914432]


portfolio before change:  [-1.02023978]
curr_Stock_Price:  101.14056525009794
curr_Factors:  [101.14056525  -0.30098237  -1.06546103]
mat_Sqrt:  [[25.79209049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00506864 -0.01545856 -0.09611089]
Stock Position:  0.005068637770801454
Bond Position:  [-1.53288467]


portfolio before change:  [-1.03887038]
curr_Stock_Price:  97.54051864515742
curr_Factors:  [97.54051865 -0.26867043 -1.06169489]
mat_Sqrt:  [[25.78782672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00021973 -0.02845143  0.0120735 ]
Stock Position:  -0.0002197274686113328
Bond Position:  [-1.01743805]


portfolio before change:  [-1.03933821]
curr_Stock_Price:  98.51191364278776
curr_Factors:  [98.51191364 -0.5357648  -1.10294582]
mat_Sqrt:  [[19.13400024  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00487905 -0.00434015 -0.024503  ]
Stock Position:  0.00487905217018574
Bond Position:  [-1.51998298]


portfolio before change:  [-1.03923692]
curr_Stock_Price:  98.61056795747089
curr_Factors:  [98.61056796 -0.87794344 -1.0521372 ]
mat_Sqrt:  [[14.31199204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00632719  0.00605842  0.30146753]
Stock Position:  -0.006327190250428975
Bond Position:  [-0.41530909]


portfolio before change:  [-1.03931112]
curr_Stock_Price:  98.6058840521703
curr_Factors:  [98.60588405 -0.89764795 -1.03020994]
mat_Sqrt:  [[14.34315808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0104366   0.04167988 -0.0515622 ]
Stock Position:  -0.010436596889237431
Bond Position:  [-0.01020126]


portfolio before change:  [-1.04513571]
curr_Stock_Price:  99.16373210083154
curr_Factors:  [99.1637321  -0.79836442 -1.04098218]
mat_Sqrt:  [[15.75922239  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00281088 -0.03477009  0.00828683]
Stock Position:  0.002810879314161907
Bond Position:  [-1.32387299]


portfolio before change:  [-1.04472797]
curr_Stock_Price:  99.4265482328749
curr_Factors:  [99.42654823 -0.84741879 -1.02799007]
mat_Sqrt:  [[15.24132208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00430361 0.03063437 0.05616272]
Stock Position:  0.004303613757439458
Bond Position:  [-1.47262143]


portfolio before change:  [-1.04733679]
curr_Stock_Price:  98.90591231612537
curr_Factors:  [98.90591232 -0.92962903 -1.03497368]
mat_Sqrt:  [[13.86775425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00153764 0.05205673 0.18664152]
Stock Position:  0.001537644388481072
Bond Position:  [-1.19941891]


portfolio before change:  [-1.04698519]
curr_Stock_Price:  99.32960546400021
curr_Factors:  [99.32960546 -0.74301483 -0.99517754]
mat_Sqrt:  [[17.46591552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332513 -0.02469069 -0.19149629]
Stock Position:  -0.0033251347035376526
Bond Position:  [-0.71670088]


portfolio before change:  [-1.04621742]
curr_Stock_Price:  99.0448141891059
curr_Factors:  [99.04481419 -0.81041582 -0.96348698]
mat_Sqrt:  [[16.80488499  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00573111 -0.02994584  0.5613638 ]
Stock Position:  -0.00573110903437643
Bond Position:  [-0.47858079]


portfolio before change:  [-1.04484726]
curr_Stock_Price:  98.7848611544685
curr_Factors:  [98.78486115 -0.68703789 -0.96812043]
mat_Sqrt:  [[18.87401387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00257566 0.03877475 0.5057434 ]
Stock Position:  0.0025756604339977774
Bond Position:  [-1.29928352]


portfolio before change:  [-1.04832395]
curr_Stock_Price:  97.56116506969188
curr_Factors:  [97.56116507 -0.84440368 -0.89592284]
mat_Sqrt:  [[17.11838425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00212403  0.0349634   0.05587492]
Stock Position:  -0.0021240279454735776
Bond Position:  [-0.84110131]


portfolio before change:  [-1.05222681]
curr_Stock_Price:  99.29963570955853
curr_Factors:  [99.29963571 -1.18517657 -0.8936456 ]
mat_Sqrt:  [[12.42014474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00378091 -0.01833039  0.06732616]
Stock Position:  -0.003780912922102339
Bond Position:  [-0.67678354]


portfolio before change:  [-1.05022988]
curr_Stock_Price:  98.72671897227282
curr_Factors:  [98.72671897 -1.18572044 -0.85480844]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.05022988]
Stock Price:  97.55312084325932
PL:  [-1.05022988]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.53308388e-01 -2.78228891e-02  7.50494991e-02]
 [ 4.73983989e-02  5.11033491e-02  7.19335761e-02]
 [-1.39192791e-02 -1.73882171e-01  3.33534323e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.41263752e-01 -2.89186127e-01 -2.61545717e-01]
 [-4.77235545e-02 -8.49860045e-02 -1.17894507e-01]
 [ 1.84593650e-03 -7.97754725e-02  2.60917927e-03]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [-1.75386165e-02  2.19828651e-03 -1.12642463e-01]
 [-3.72731847e-01  3.59405520e-01  2.58606753e-02]
 [ 1.03904046e-01 -1.43384824e-01 -2.39155244e-03]
 [-2.85173414e-02  4.68840783e-02  3.43775234e-02]
 [-5.51842683e-02  1.74576560e-01  2.04890740e-04]
 [-1.13288358e-01 -3.91946601e-02  1.45102170e-01]
 [-1.35968792e-01 -1.10111662e-01  2.38183915e-01]
 [-3.38126898e-02  1.83011662e-02 -5.73658179e-02]
 [-9.24377338e-02  5.21892477e-02  8.15032615e-02]
 [-3.86080104e-02 -2.06264320e-02  2.06333683e-02]
 [-1.68453790e-02  5.43016589e-01  3.19234465e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.23711319]
curr_Stock_Price:  100.55176066908058
curr_Factors:  [100.55176067  -0.93039511  -1.00840877]
mat_Sqrt:  [[14.46697914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01650015 -0.00879837  0.21409533]
Stock Position:  -0.016500152134055254
Bond Position:  [7.89623254]


portfolio before change:  [6.22364119]
curr_Stock_Price:  101.48789174332529
curr_Factors:  [101.48789174  -1.31642469  -1.01816021]
mat_Sqrt:  [[ 9.82917103  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00645032 0.0161603  0.20520647]
Stock Position:  0.006450316235030962
Bond Position:  [5.56901219]


portfolio before change:  [6.23659007]
curr_Stock_Price:  103.27950219661952
curr_Factors:  [103.2795022   -1.49733483  -1.05641685]
mat_Sqrt:  [[ 8.03403787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144394 -0.05498637  0.09514806]
Stock Position:  -0.0014439385014841653
Bond Position:  [6.38571932]


portfolio before change:  [6.23813011]
curr_Stock_Price:  103.318690058437
curr_Factors:  [103.31869006  -1.2903911   -1.05823241]
mat_Sqrt:  [[ 9.86698939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00384553 -0.00455813 -0.02970002]
Stock Position:  -0.0038455252853423073
Bond Position:  [6.63544475]


portfolio before change:  [6.23891373]
curr_Stock_Price:  103.54634516348214
curr_Factors:  [103.54634516  -1.35569906  -1.1096691 ]
mat_Sqrt:  [[ 8.79911487  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03186789 -0.09144868 -0.74611713]
Stock Position:  0.03186788740983518
Bond Position:  [2.93911046]


portfolio before change:  [6.2372814]
curr_Stock_Price:  103.47206342797222
curr_Factors:  [103.47206343  -1.45215364  -1.12473768]
mat_Sqrt:  [[ 7.86490404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00940673 -0.02687493 -0.33632021]
Stock Position:  -0.009406726217378964
Bond Position:  [7.21061477]


portfolio before change:  [6.23945136]
curr_Stock_Price:  103.43303918053127
curr_Factors:  [103.43303918  -1.3856338   -1.14439988]
mat_Sqrt:  [[ 8.23909701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.86861750e-05 -2.52272195e-02  7.44326220e-03]
Stock Position:  3.868617502490667e-05
Bond Position:  [6.23544994]


portfolio before change:  [6.24100465]
curr_Stock_Price:  103.28372494083018
curr_Factors:  [103.28372494  -1.28102215  -1.16378589]
mat_Sqrt:  [[ 8.95911789  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01558025 -0.01496598 -0.14840805]
Stock Position:  -0.015580254196745174
Bond Position:  [7.85019133]


portfolio before change:  [6.25135245]
curr_Stock_Price:  102.74554307575372
curr_Factors:  [102.74554308  -1.1795923   -1.16789864]
mat_Sqrt:  [[ 9.82337285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00412027  0.00069516 -0.32133759]
Stock Position:  -0.004120265410599716
Bond Position:  [6.67469136]


portfolio before change:  [6.2524636]
curr_Stock_Price:  102.88090680310769
curr_Factors:  [102.8809068   -0.99777389  -1.12323916]
mat_Sqrt:  [[12.336459    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02903372  0.113654    0.07377331]
Stock Position:  -0.029033716098131195
Bond Position:  [9.23947864]


portfolio before change:  [6.26997094]
curr_Stock_Price:  102.35747442886864
curr_Factors:  [102.35747443  -1.01655499  -1.11141874]
mat_Sqrt:  [[12.18855759  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00818093 -0.04534226 -0.00682243]
Stock Position:  0.008180926329933573
Bond Position:  [5.43259198]


portfolio before change:  [6.27501641]
curr_Stock_Price:  102.80817548769444
curr_Factors:  [102.80817549  -0.89725916  -1.13345766]
mat_Sqrt:  [[13.49269007  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00150374  0.01482605  0.09806951]
Stock Position:  -0.001503741432777622
Bond Position:  [6.42961332]


portfolio before change:  [6.27595666]
curr_Stock_Price:  103.25197174752738
curr_Factors:  [103.25197175  -0.58962322  -1.1179223 ]
mat_Sqrt:  [[18.72064279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270476  0.05520596  0.0005845 ]
Stock Position:  -0.002704762777233317
Bond Position:  [6.55522875]


portfolio before change:  [6.27444121]
curr_Stock_Price:  104.41823299847474
curr_Factors:  [104.418233    -0.6466874   -1.14693049]
mat_Sqrt:  [[17.37072675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00487495 -0.01239444  0.4139361 ]
Stock Position:  -0.004874954565433692
Bond Position:  [6.78347535]


portfolio before change:  [6.27606089]
curr_Stock_Price:  104.43390614796644
curr_Factors:  [104.43390615  -0.68784429  -1.12485107]
mat_Sqrt:  [[17.04503632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00529144 -0.03482036  0.67947241]
Stock Position:  -0.005291439302236449
Bond Position:  [6.82866656]


portfolio before change:  [6.26705759]
curr_Stock_Price:  106.45805758223484
curr_Factors:  [106.45805758  -0.5785576   -1.1833422 ]
mat_Sqrt:  [[18.28079929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00246433  0.00578734 -0.16364871]
Stock Position:  -0.0024643290224801244
Bond Position:  [6.52940527]


portfolio before change:  [6.27007523]
curr_Stock_Price:  105.89600531888684
curr_Factors:  [105.89600532  -0.67755575  -1.16950815]
mat_Sqrt:  [[16.69974804  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00445836  0.01650369  0.23250612]
Stock Position:  -0.004458356466220133
Bond Position:  [6.74219737]


portfolio before change:  [6.27606398]
curr_Stock_Price:  104.93085271523222
curr_Factors:  [104.93085272  -0.77640492  -1.16485846]
mat_Sqrt:  [[15.05993953  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00231932 -0.00652265  0.05886126]
Stock Position:  -0.0023193196623121554
Bond Position:  [6.51943217]


portfolio before change:  [6.27967375]
curr_Stock_Price:  104.07728266660983
curr_Factors:  [104.07728267  -0.73079847  -1.14095033]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.27967375]
Stock Price:  104.96052544833405
PL:  [1.3191483]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.11332769e-01 -4.06533762e-02  1.21408106e-01]
 [-7.38034171e-02  1.24456369e-01  9.68416331e-02]
 [-1.80642706e-01 -6.72427455e-01 -5.16041396e-02]
 [-3.44333096e-02 -1.27602151e-02 -9.37163965e-03]
 [ 6.60631543e-01 -3.97326307e-01 -1.66666489e-01]
 [ 5.36544427e-02  2.38422982e-02 -1.54760966e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 2.62386147e-02 -2.79707268e-02 -2.09780176e-03]
 [-7.98240154e-03  3.04497696e-02 -3.87240177e-02]
 [-4.04619115e-01  3.88640008e-01  4.20233617e-02]
 [ 6.06461352e-02 -1.18370507e-01  3.15439654e-03]
 [-7.91913052e-02  1.66017063e-02  4.69062987e-04]
 [-9.15221974e-03  1.45084331e-01  4.27551984e-02]
 [-8.17253486e-03 -1.70180717e-01 -1.56870700e-01]
 [-7.58591536e-02 -8.93938545e-02  2.29190199e-01]
 [ 2.57928131e-02  1.56965133e-01  2.57311129e-01]
 [-5.05756410e-02  1.15407087e-01  2.10789654e-02]
 [-4.72427388e-02 -4.69218348e-02  2.19903714e-02]
 [-3.66886837e-02  4.43535168e-01  1.80403441e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.13340932]
curr_Stock_Price:  99.840820699569
curr_Factors:  [99.8408207  -1.23948937 -0.98681699]
mat_Sqrt:  [[10.77545391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0266903  -0.01285573  0.34634353]
Stock Position:  -0.026690301053125975
Bond Position:  [3.79819088]


portfolio before change:  [1.13466661]
curr_Stock_Price:  99.82929487770163
curr_Factors:  [99.82929488 -1.31974019 -1.00179796]
mat_Sqrt:  [[ 9.79550421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00518832  0.03935656  0.27626222]
Stock Position:  -0.005188324230913814
Bond Position:  [1.65261336]


portfolio before change:  [1.14176167]
curr_Stock_Price:  98.54143266886052
curr_Factors:  [98.54143267 -1.53963761 -0.9789162 ]
mat_Sqrt:  [[ 7.94007951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02626401 -0.21264023 -0.14721225]
Stock Position:  -0.026264014010640824
Bond Position:  [3.72985523]


portfolio before change:  [1.12097106]
curr_Stock_Price:  99.36854113858037
curr_Factors:  [99.36854114 -1.24315583 -1.05279972]
mat_Sqrt:  [[10.00294975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366649 -0.00403513 -0.02673468]
Stock Position:  -0.0036664939691464014
Bond Position:  [1.48530521]


portfolio before change:  [1.12034956]
curr_Stock_Price:  99.63933709586264
curr_Factors:  [99.6393371  -1.17724461 -1.094233  ]
mat_Sqrt:  [[10.27875793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05996366 -0.12564561 -0.4754531 ]
Stock Position:  0.05996366204480066
Bond Position:  [-4.85438998]


portfolio before change:  [1.15753761]
curr_Stock_Price:  100.27975490973435
curr_Factors:  [100.27975491  -0.95499572  -1.09263563]
mat_Sqrt:  [[12.94011882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00394981  0.0075396  -0.044149  ]
Stock Position:  0.003949809417204502
Bond Position:  [0.76145169]


portfolio before change:  [1.15668229]
curr_Stock_Price:  100.0150078411686
curr_Factors:  [100.01500784  -0.88557513  -1.08950784]
mat_Sqrt:  [[13.87706242  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00040832 -0.02845143  0.0120735 ]
Stock Position:  -0.0004083208473191835
Bond Position:  [1.19752051]


portfolio before change:  [1.1569973]
curr_Stock_Price:  99.97683489502084
curr_Factors:  [99.9768349  -1.07558754 -1.07090804]
mat_Sqrt:  [[11.68660048  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00214675 -0.00884512 -0.00598444]
Stock Position:  0.00214674931713923
Bond Position:  [0.9423721]


portfolio before change:  [1.16005451]
curr_Stock_Price:  101.29119110889627
curr_Factors:  [101.29119111  -1.28852095  -1.08293553]
mat_Sqrt:  [[ 9.4549931   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00159711  0.00962906 -0.11046884]
Stock Position:  -0.0015971136867657994
Bond Position:  [1.32182806]


portfolio before change:  [1.15929522]
curr_Stock_Price:  101.97353980144422
curr_Factors:  [101.9735398   -1.64008625  -1.06587173]
mat_Sqrt:  [[ 6.81247432  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05666172  0.12289876  0.11988095]
Stock Position:  -0.05666171671946857
Bond Position:  [6.93729105]


portfolio before change:  [1.14514066]
curr_Stock_Price:  102.25396024630739
curr_Factors:  [102.25396025  -1.82949889  -1.08903886]
mat_Sqrt:  [[ 5.52300319  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01054385 -0.03743204  0.00899862]
Stock Position:  0.010543848773018385
Bond Position:  [0.06699037]


portfolio before change:  [1.14394271]
curr_Stock_Price:  102.13875578847289
curr_Factors:  [102.13875579  -1.69036419  -1.07900206]
mat_Sqrt:  [[ 6.4042766   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0122835   0.00524992  0.00133811]
Stock Position:  -0.012283495666130035
Bond Position:  [2.39856367]


portfolio before change:  [1.15058063]
curr_Stock_Price:  101.64718511940575
curr_Factors:  [101.64718512  -2.03740336  -1.03479184]
mat_Sqrt:  [[ 4.70823285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0007054  0.04587969 0.12196868]
Stock Position:  0.0007054047697634798
Bond Position:  [1.07887822]


portfolio before change:  [1.15054122]
curr_Stock_Price:  101.20890579426577
curr_Factors:  [101.20890579  -2.14364921  -1.03278533]
mat_Sqrt:  [[ 4.22387188  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01055612 -0.05381587 -0.44750844]
Stock Position:  -0.010556115526956178
Bond Position:  [2.21891412]


portfolio before change:  [1.14862978]
curr_Stock_Price:  101.44253740280898
curr_Factors:  [101.4425374   -2.14009866  -1.02819024]
mat_Sqrt:  [[ 4.26824868  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00735291 -0.02826882  0.65381584]
Stock Position:  -0.007352907921619691
Bond Position:  [1.89452741]


portfolio before change:  [1.14777153]
curr_Stock_Price:  101.62368203615999
curr_Factors:  [101.62368204  -1.98430938  -1.00033627]
mat_Sqrt:  [[ 5.13783071  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01603187 0.04963673 0.73403703]
Stock Position:  0.016031873057707674
Bond Position:  [-0.48144644]


portfolio before change:  [1.14316734]
curr_Stock_Price:  101.3440007247228
curr_Factors:  [101.34400072  -1.92953853  -1.02727648]
mat_Sqrt:  [[ 5.26828916  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00821768  0.03649493  0.06013242]
Stock Position:  -0.008217680472478232
Bond Position:  [1.97597995]


portfolio before change:  [1.1411188]
curr_Stock_Price:  101.65340628879713
curr_Factors:  [101.65340629  -2.00762956  -1.00539571]
mat_Sqrt:  [[ 4.99553133  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00880096 -0.01483799  0.06273241]
Stock Position:  -0.0088009636344278
Bond Position:  [2.03576673]


portfolio before change:  [1.14046852]
curr_Stock_Price:  101.78512851601872
curr_Factors:  [101.78512852  -1.73189311  -1.0126938 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.14046852]
Stock Price:  102.46692944738068
PL:  [-1.32646093]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.08886201e-01 -3.32322871e-02  1.00899582e-01]
 [-2.60384777e-02  9.93321541e-02  1.03623969e-01]
 [-3.93746314e-02 -2.34472433e-01  4.02882361e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 5.76291360e-01 -3.66738652e-01 -1.86581981e-01]
 [ 1.18441254e-02  4.37010402e-02  8.74034872e-03]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 9.23397897e-02 -1.74966203e-02  6.18895799e-03]
 [-3.93415162e-02  2.82414487e-02  5.29733602e-03]
 [-3.39259206e-01  3.23861212e-01  3.02376925e-02]
 [ 7.26022064e-02 -1.25285559e-01  1.63200598e-03]
 [ 3.74381490e-02  8.96544676e-02  4.19782536e-02]
 [ 1.58802199e-03  1.61910110e-01  6.18772060e-02]
 [-3.71756458e-02 -1.20208568e-01 -8.02209977e-02]
 [-1.38278036e-01 -9.78511280e-02  2.02131325e-01]
 [ 2.71050144e-02  1.27342772e-01  2.02715687e-01]
 [-1.10593331e-01  5.28789331e-02  5.90646584e-02]
 [-4.91289173e-02 -5.26353864e-02  2.22675687e-02]
 [-2.70955429e-02  5.07892911e-01  2.59012606e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.87563181]
curr_Stock_Price:  99.9442114230874
curr_Factors:  [99.94421142 -1.11666568 -1.02705956]
mat_Sqrt:  [[11.71519724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02468146 -0.01050897  0.28783842]
Stock Position:  -0.02468146355930818
Bond Position:  [4.34240122]


portfolio before change:  [1.86585848]
curr_Stock_Price:  100.38418002894565
curr_Factors:  [100.38418003  -1.2748237   -1.04442607]
mat_Sqrt:  [[ 9.87251713  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.35155659e-04  3.14115852e-02  2.95610342e-01]
Stock Position:  -0.0002351556591255582
Bond Position:  [1.88946439]


portfolio before change:  [1.86627753]
curr_Stock_Price:  100.61113295673019
curr_Factors:  [100.61113296  -1.2252193   -1.0429007 ]
mat_Sqrt:  [[10.41391526  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00357261 -0.07414669  0.11493112]
Stock Position:  -0.0035726123103933306
Bond Position:  [2.22572211]


portfolio before change:  [1.86621991]
curr_Stock_Price:  100.78302967220687
curr_Factors:  [100.78302967  -1.13030837  -1.04329926]
mat_Sqrt:  [[11.46572742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330932 -0.00455813 -0.02970002]
Stock Position:  -0.0033093196638907
Bond Position:  [2.19974318]


portfolio before change:  [1.86871651]
curr_Stock_Price:  100.19481570492759
curr_Factors:  [100.1948157   -1.11641947  -1.03517222]
mat_Sqrt:  [[11.65254671  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04537517 -0.11597294 -0.53226646]
Stock Position:  0.04537517286961811
Bond Position:  [-2.67764058]


portfolio before change:  [1.83040293]
curr_Stock_Price:  99.3651971103759
curr_Factors:  [99.36519711 -1.41516268 -1.05837522]
mat_Sqrt:  [[ 8.3751084   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00176196 0.01381948 0.02493378]
Stock Position:  0.0017619590051101708
Bond Position:  [1.65532552]


portfolio before change:  [1.83025757]
curr_Stock_Price:  99.04780260531197
curr_Factors:  [99.04780261 -1.22803728 -1.02751493]
mat_Sqrt:  [[10.38175954  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054579 -0.02845143  0.0120735 ]
Stock Position:  -0.0005457932121049214
Bond Position:  [1.88431719]


portfolio before change:  [1.83021542]
curr_Stock_Price:  99.98824760132737
curr_Factors:  [99.9882476  -1.39225612 -1.04314071]
mat_Sqrt:  [[ 8.75527012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01063946 -0.00553292  0.01765537]
Stock Position:  0.010639459818365483
Bond Position:  [0.76639448]


portfolio before change:  [1.83701727]
curr_Stock_Price:  100.6095413218066
curr_Factors:  [100.60954132  -1.50308442  -1.05107088]
mat_Sqrt:  [[ 7.82318527  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00479741  0.00893073  0.01511183]
Stock Position:  -0.004797407919229311
Bond Position:  [2.31968228]


portfolio before change:  [1.83381361]
curr_Stock_Price:  101.39822876036108
curr_Factors:  [101.39822876  -1.35870102  -1.05411048]
mat_Sqrt:  [[ 9.08154312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03575658  0.10241391  0.08625972]
Stock Position:  -0.035756577759538256
Bond Position:  [5.45946726]


portfolio before change:  [1.85557235]
curr_Stock_Price:  100.8278804152035
curr_Factors:  [100.82788042  -1.02664478  -1.05939698]
mat_Sqrt:  [[12.52057316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00556688 -0.03961877  0.00465566]
Stock Position:  0.005566876064944075
Bond Position:  [1.29427604]


portfolio before change:  [1.85212784]
curr_Stock_Price:  100.1509967884065
curr_Factors:  [100.15099679  -1.14280446  -1.01774379]
mat_Sqrt:  [[11.54359535  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00418603 0.02835123 0.11975227]
Stock Position:  0.004186026197530418
Bond Position:  [1.43289314]


portfolio before change:  [1.84912538]
curr_Stock_Price:  99.34815335323152
curr_Factors:  [99.34815335 -1.09530519 -1.03056216]
mat_Sqrt:  [[11.85515779  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.001552   0.05120047 0.17651845]
Stock Position:  0.0015519957776947036
Bond Position:  [1.69493747]


portfolio before change:  [1.85077137]
curr_Stock_Price:  100.13565698764168
curr_Factors:  [100.13565699  -1.13536996  -1.04464618]
mat_Sqrt:  [[11.31930525  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00500512 -0.03801329 -0.22884818]
Stock Position:  -0.0050051181626505565
Bond Position:  [2.35196217]


portfolio before change:  [1.84988136]
curr_Stock_Price:  100.43096924752945
curr_Factors:  [100.43096925  -1.35883387  -1.02492247]
mat_Sqrt:  [[ 9.26009472  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01074985 -0.03094324  0.57662441]
Stock Position:  -0.010749853078938167
Bond Position:  [2.92949953]


portfolio before change:  [1.84758689]
curr_Stock_Price:  100.71254903711738
curr_Factors:  [100.71254904  -1.45567376  -1.04432566]
mat_Sqrt:  [[ 8.26699424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00868177 0.04026932 0.57829143]
Stock Position:  0.008681771746386142
Bond Position:  [0.97322352]


portfolio before change:  [1.85036907]
curr_Stock_Price:  101.00498361290592
curr_Factors:  [101.00498361  -1.04297307  -1.05218196]
mat_Sqrt:  [[12.42878099  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00781826  0.01672179  0.16849503]
Stock Position:  -0.007818263143220087
Bond Position:  [2.64005261]


portfolio before change:  [1.85585065]
curr_Stock_Price:  100.38828908324454
curr_Factors:  [100.38828908  -0.84831029  -1.02414878]
mat_Sqrt:  [[15.43421022  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297667 -0.01664477  0.06352318]
Stock Position:  -0.00297667376932022
Bond Position:  [2.15467384]


portfolio before change:  [1.84758376]
curr_Stock_Price:  103.34649864109875
curr_Factors:  [103.34649864  -1.22705639  -1.03457848]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.84758376]
Stock Price:  105.21075122705545
PL:  [-3.36316747]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.25215690e-01 -2.50886221e-02  6.19831597e-02]
 [ 6.57767557e-02  2.97996468e-02  2.34959510e-02]
 [-9.97341049e-02 -3.67656412e-01 -9.42509819e-03]
 [-1.91953925e-02  1.03749809e-01  6.97024846e-02]
 [ 1.62789843e-01 -1.35595019e-01 -1.23602238e-01]
 [ 7.61871114e-02  2.86438895e-03 -2.35432528e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [-1.01415185e-02  3.13237712e-02 -3.19776870e-02]
 [-3.96576070e-01  3.83270385e-01  4.22155027e-02]
 [ 6.75993076e-02 -1.22390433e-01  2.25657209e-03]
 [-2.78145740e-02  4.72660928e-02  3.46857950e-02]
 [-3.20157184e-02  1.68807507e-01  2.51404565e-02]
 [-6.14359116e-02 -8.44516096e-02 -4.02021549e-03]
 [-1.57565680e-01 -1.12183546e-01  2.26439917e-01]
 [ 3.21726385e-02  7.78977734e-02  1.05369822e-01]
 [-1.30712671e-01  2.22078471e-02  7.23345731e-02]
 [-4.92282229e-02 -5.34579585e-02  2.26117178e-02]
 [-3.43382626e-02  4.64012908e-01  2.02585734e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.90677828]
curr_Stock_Price:  100.92364188913024
curr_Factors:  [100.92364189  -0.95019751  -1.02425244]
mat_Sqrt:  [[14.01200221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01521633 -0.00793372  0.1768207 ]
Stock Position:  -0.01521632759759768
Bond Position:  [10.44246548]


portfolio before change:  [8.90911502]
curr_Stock_Price:  100.94166229637607
curr_Factors:  [100.9416623   -0.86754599  -1.05642921]
mat_Sqrt:  [[14.74003927  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00484003 0.00942348 0.06702741]
Stock Position:  0.004840032572209178
Bond Position:  [8.42055409]


portfolio before change:  [8.90128291]
curr_Stock_Price:  98.88847039522548
curr_Factors:  [98.8884704  -0.83723825 -1.05051143]
mat_Sqrt:  [[14.972916    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00742346 -0.11626317 -0.02688718]
Stock Position:  -0.00742345997908927
Bond Position:  [9.63537751]


portfolio before change:  [8.91081729]
curr_Stock_Price:  97.9286432513949
curr_Factors:  [97.92864325 -0.62125064 -1.05030847]
mat_Sqrt:  [[18.40606037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.24340775e-04  3.28085703e-02  1.98841787e-01]
Stock Position:  -0.00012434077490993282
Bond Position:  [8.92299381]


portfolio before change:  [8.91294163]
curr_Stock_Price:  98.78668699059199
curr_Factors:  [98.78668699 -0.57547603 -1.04393877]
mat_Sqrt:  [[19.56120076  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00685329 -0.04287891 -0.35260278]
Stock Position:  0.006853290624279298
Bond Position:  [8.23592775]


portfolio before change:  [8.92734706]
curr_Stock_Price:  100.58818621373312
curr_Factors:  [100.58818621  -0.69900083  -1.03353682]
mat_Sqrt:  [[17.78752144  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00401716  0.0009058  -0.06716235]
Stock Position:  0.004017160202626717
Bond Position:  [8.52326821]


portfolio before change:  [8.93093109]
curr_Stock_Price:  100.94987058833982
curr_Factors:  [100.94987059  -0.98963698  -1.04541571]
mat_Sqrt:  [[13.19148271  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042954 -0.02845143  0.0120735 ]
Stock Position:  -0.0004295418498466041
Bond Position:  [8.97429329]


portfolio before change:  [8.93265249]
curr_Stock_Price:  102.16616836776195
curr_Factors:  [102.16616837  -0.95866522  -1.0376763 ]
mat_Sqrt:  [[13.87736472  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01005849 -0.01496598 -0.14840805]
Stock Position:  -0.010058489994300908
Bond Position:  [9.96028988]


portfolio before change:  [8.94796639]
curr_Stock_Price:  100.8912739349856
curr_Factors:  [100.89127393  -0.80328037  -1.05136722]
mat_Sqrt:  [[15.79030038  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00100442  0.00990545 -0.09122344]
Stock Position:  -0.0010044242289934306
Bond Position:  [9.04930403]


portfolio before change:  [8.94856326]
curr_Stock_Price:  102.5496747651448
curr_Factors:  [102.54967477  -1.37556354  -1.05077219]
mat_Sqrt:  [[ 9.06129081  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04172285  0.12120074  0.12042908]
Stock Position:  -0.04172284895339372
Bond Position:  [13.22722785]


portfolio before change:  [8.97970691]
curr_Stock_Price:  101.88250000694391
curr_Factors:  [101.88250001  -1.5579214   -1.05491476]
mat_Sqrt:  [[ 7.47066506  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00868729 -0.03870325  0.00643737]
Stock Position:  0.00868728828071036
Bond Position:  [8.09462427]


portfolio before change:  [8.9857277]
curr_Stock_Price:  102.34258359917733
curr_Factors:  [102.3425836   -1.30645392  -1.02309929]
mat_Sqrt:  [[ 9.96194809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195885  0.01494685  0.09894892]
Stock Position:  -0.001958849845992739
Bond Position:  [9.18620146]


portfolio before change:  [8.9880713]
curr_Stock_Price:  102.3187127515096
curr_Factors:  [102.31871275  -1.09601039  -1.01921083]
mat_Sqrt:  [[12.34031263  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182535  0.05338162  0.07171872]
Stock Position:  -0.0018253470412218761
Bond Position:  [9.17483846]


portfolio before change:  [8.99041373]
curr_Stock_Price:  102.2921801690132
curr_Factors:  [102.29218017  -1.02002384  -0.99655459]
mat_Sqrt:  [[13.6161256   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00473241 -0.02670594 -0.01146856]
Stock Position:  -0.004732408305901074
Bond Position:  [9.47450209]


portfolio before change:  [8.99841762]
curr_Stock_Price:  101.1014609005693
curr_Factors:  [101.1014609   -0.67811777  -0.9569874 ]
mat_Sqrt:  [[19.70789673  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00579668 -0.03547555  0.64597006]
Stock Position:  -0.0057966810725953236
Bond Position:  [9.58447054]


portfolio before change:  [8.99931564]
curr_Stock_Price:  101.35995258880484
curr_Factors:  [101.35995259  -0.63959802  -0.96690343]
mat_Sqrt:  [[20.33160596  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00273921 0.02463344 0.30059077]
Stock Position:  0.002739206899396407
Bond Position:  [8.72166976]


portfolio before change:  [9.00043227]
curr_Stock_Price:  100.97149795616687
curr_Factors:  [100.97149796  -0.67474207  -0.92737892]
mat_Sqrt:  [[20.34260162  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00567155  0.00702274  0.2063504 ]
Stock Position:  -0.005671547615201852
Bond Position:  [9.57309693]


portfolio before change:  [9.00688356]
curr_Stock_Price:  100.25604807766344
curr_Factors:  [100.25604808  -0.99258709  -0.9233332 ]
mat_Sqrt:  [[14.75832163  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031164  -0.01690489  0.06450494]
Stock Position:  -0.0031164047712419997
Bond Position:  [9.31932198]


portfolio before change:  [9.00778456]
curr_Stock_Price:  100.71462561664113
curr_Factors:  [100.71462562  -1.42257682  -0.91744877]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.00778456]
Stock Price:  99.9008353788146
PL:  [9.00778456]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.73717367e-01 -2.98092985e-02  8.45420244e-02]
 [ 4.72401090e-02  4.23841846e-02  3.32972411e-02]
 [-4.08691439e-02 -2.24710286e-01  3.73026839e-02]
 [-1.78357062e-02  1.11050299e-01  7.78937860e-02]
 [-9.79377728e-02  1.81939524e-02 -8.73198369e-02]
 [-1.52077259e-01  8.35185579e-02  4.21402921e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-1.00056898e-01 -8.96050119e-02 -5.43182206e-02]
 [-3.67690955e-03  3.20061689e-02 -4.02300318e-02]
 [-2.07919295e-01  2.01848119e-01  3.22113510e-02]
 [ 9.59566728e-02 -1.38810566e-01 -1.20513159e-03]
 [-4.92041836e-02  3.56390026e-02  2.53031590e-02]
 [-2.35647799e-02  1.82624473e-01  4.04105923e-02]
 [-5.16751576e-02 -3.54585294e-02 -3.68604259e-02]
 [-1.42005758e-01 -1.00621154e-01  2.06829446e-01]
 [ 1.34283303e-02  1.17266536e-01  1.70043266e-01]
 [-1.27247720e-01  2.88594709e-02  6.83878917e-02]
 [-4.49943905e-02 -4.12086825e-02  2.23531379e-02]
 [-1.03654386e-02  5.63292633e-01  3.59265034e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.91362545]
curr_Stock_Price:  100.36740037731376
curr_Factors:  [100.36740038  -1.11406822  -0.98601802]
mat_Sqrt:  [[12.28957346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02093075 -0.00942653  0.24117486]
Stock Position:  -0.02093074848287913
Bond Position:  [7.01439026]


portfolio before change:  [4.90826131]
curr_Stock_Price:  100.70747219314549
curr_Factors:  [100.70747219  -0.86279741  -1.01376153]
mat_Sqrt:  [[15.41993352  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00357532 0.01340306 0.09498776]
Stock Position:  0.003575322471233093
Bond Position:  [4.54819962]


portfolio before change:  [4.90539229]
curr_Stock_Price:  99.5869561917648
curr_Factors:  [99.58695619 -0.66823314 -0.98665386]
mat_Sqrt:  [[19.03242675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00205212 -0.07105963  0.10641417]
Stock Position:  -0.002052116659405881
Bond Position:  [5.10975634]


portfolio before change:  [4.91026909]
curr_Stock_Price:  97.83305911325377
curr_Factors:  [97.83305911 -0.64448325 -0.94336423]
mat_Sqrt:  [[19.99365681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [4.65949096e-05 3.51171878e-02 2.22209290e-01]
Stock Position:  4.659490956239143e-05
Bond Position:  [4.90571057]


portfolio before change:  [4.91147178]
curr_Stock_Price:  97.32029889285903
curr_Factors:  [97.32029889 -0.12199996 -0.95469658]
mat_Sqrt:  [[33.15889624  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347696  0.00575343 -0.24909919]
Stock Position:  -0.0034769581356652716
Bond Position:  [5.24985039]


portfolio before change:  [4.91651922]
curr_Stock_Price:  96.24613654882059
curr_Factors:  [96.24613655 -0.26314613 -0.90376541]
mat_Sqrt:  [[29.96401874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00471629  0.02641089  0.12021452]
Stock Position:  -0.004716288857308435
Bond Position:  [5.37044381]


portfolio before change:  [4.91778719]
curr_Stock_Price:  96.26199892048076
curr_Factors:  [96.26199892 -0.16475683 -0.8801187 ]
mat_Sqrt:  [[33.85877184  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00016735 -0.02845143  0.0120735 ]
Stock Position:  -0.000167350839342614
Bond Position:  [4.93389672]


portfolio before change:  [4.91815751]
curr_Stock_Price:  101.42070953690032
curr_Factors:  [101.42070954  -0.22335565  -0.90521377]
mat_Sqrt:  [[32.80916455  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00345812 -0.02833559 -0.15495476]
Stock Position:  -0.003458123706533835
Bond Position:  [5.26888287]


portfolio before change:  [4.92088058]
curr_Stock_Price:  101.0142195039762
curr_Factors:  [101.0142195   -0.80166763  -0.86336725]
mat_Sqrt:  [[19.11028     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057887  0.01012124 -0.11476508]
Stock Position:  -0.0005788735008323135
Bond Position:  [4.97935504]


portfolio before change:  [4.92206067]
curr_Stock_Price:  101.12634754393193
curr_Factors:  [101.12634754  -0.63194796  -0.84701135]
mat_Sqrt:  [[23.04413732  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00851117  0.06382998  0.09189002]
Stock Position:  -0.008511166287279253
Bond Position:  [5.78276383]


portfolio before change:  [4.92440621]
curr_Stock_Price:  101.02064357352617
curr_Factors:  [101.02064357  -0.70458111  -0.8549306 ]
mat_Sqrt:  [[21.23844919  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00433773 -0.04389576 -0.0034379 ]
Stock Position:  0.0043377273973325735
Bond Position:  [4.48620619]


portfolio before change:  [4.93353707]
curr_Stock_Price:  102.86704199150306
curr_Factors:  [102.86704199  -0.51099913  -0.86700029]
mat_Sqrt:  [[25.93096685  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166284  0.01127004  0.07218287]
Stock Position:  -0.0016628382210924489
Bond Position:  [5.10458832]


portfolio before change:  [4.93710118]
curr_Stock_Price:  101.49119779762528
curr_Factors:  [101.4911978   -0.65633482  -0.85046444]
mat_Sqrt:  [[22.49229506  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004713   0.05775093  0.11528017]
Stock Position:  -0.0004713017771569433
Bond Position:  [4.98493417]


portfolio before change:  [4.93874839]
curr_Stock_Price:  100.64075569665931
curr_Factors:  [100.6407557   -0.74534035  -0.86642717]
mat_Sqrt:  [[20.08131491  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00299357 -0.01121297 -0.10515254]
Stock Position:  -0.002993568702140045
Bond Position:  [5.2400234]


portfolio before change:  [4.94234615]
curr_Stock_Price:  99.87658530818948
curr_Factors:  [99.87658531 -0.71281506 -0.89505246]
mat_Sqrt:  [[20.00671084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00511753 -0.0318192   0.59002684]
Stock Position:  -0.005117527937854925
Bond Position:  [5.45346737]


portfolio before change:  [4.94832278]
curr_Stock_Price:  98.97515591237058
curr_Factors:  [98.97515591 -0.50177717 -0.88788097]
mat_Sqrt:  [[24.66069631  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0020748  0.03708293 0.48508611]
Stock Position:  0.002074802551180635
Bond Position:  [4.74296888]


portfolio before change:  [4.95075066]
curr_Stock_Price:  99.5737599007684
curr_Factors:  [99.5737599  -0.21314852 -0.8795787 ]
mat_Sqrt:  [[33.38716207  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337085  0.00912617  0.19509162]
Stock Position:  -0.003370845102912228
Bond Position:  [5.28639838]


portfolio before change:  [4.94509139]
curr_Stock_Price:  101.64476263755785
curr_Factors:  [101.64476264  -0.2907268   -0.88768727]
mat_Sqrt:  [[31.28284731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132646 -0.01303133  0.06376728]
Stock Position:  -0.0013264642597692632
Bond Position:  [5.07991954]


portfolio before change:  [4.94148685]
curr_Stock_Price:  105.31970976896434
curr_Factors:  [105.31970977  -0.82520414  -0.86195872]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.94148685]
Stock Price:  104.86731100844301
PL:  [0.07417584]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.36873143e-01 -2.62232440e-02  6.74052178e-02]
 [ 7.71499183e-02  1.66161793e-02 -6.47892608e-03]
 [-2.04817884e-02 -1.90380958e-01  4.54608999e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.12971769e-01 -2.69020536e-01 -2.47259922e-01]
 [ 1.50520630e-01 -1.03788279e-01 -6.28255066e-02]
 [ 3.63732851e-02 -8.45399267e-02 -1.37497112e-02]
 [ 1.94959028e-01  4.36279705e-03 -6.86511175e-03]
 [-1.07685003e-01  1.73773278e-02  1.11052789e-01]
 [-1.47778488e-01  1.33245443e-01 -1.49583105e-02]
 [ 8.45618592e-02 -1.32197886e-01  7.15947182e-05]
 [ 5.67959132e-02  9.63658413e-02  2.11149591e-02]
 [ 9.28120627e-03  1.60920916e-01  7.05164282e-02]
 [ 2.66512920e-02 -1.36411844e-01 -1.57742434e-02]
 [-1.19784277e-01 -8.41086362e-02  1.78823280e-01]
 [ 1.03229849e-03  1.40732916e-01  2.03977521e-01]
 [-5.91666180e-02  1.25438791e-01  3.22279634e-02]
 [-4.20562860e-02 -4.72230454e-02  3.13416130e-02]
 [-3.05790906e-02  4.96960383e-01  2.23656668e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.4447055]
curr_Stock_Price:  100.71997686322611
curr_Factors:  [100.71997686  -0.88089302  -0.97423023]
mat_Sqrt:  [[15.75599478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01420356 -0.00829252  0.19228832]
Stock Position:  -0.0142035583887591
Bond Position:  [8.87528757]


portfolio before change:  [7.43947706]
curr_Stock_Price:  101.24432019747019
curr_Factors:  [101.2443202   -0.67685691  -1.01444729]
mat_Sqrt:  [[18.65720508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00408724  0.0052545  -0.01848257]
Stock Position:  0.004087238182045953
Bond Position:  [7.0256674]


portfolio before change:  [7.43521102]
curr_Stock_Price:  99.77078899465694
curr_Factors:  [99.77078899 -0.62067504 -1.01857893]
mat_Sqrt:  [[19.36798563  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083218 -0.06020374  0.12968729]
Stock Position:  -0.0008321844415507499
Bond Position:  [7.51823872]


portfolio before change:  [7.43524572]
curr_Stock_Price:  101.98795664613796
curr_Factors:  [101.98795665  -0.28587937  -1.06942065]
mat_Sqrt:  [[26.29962597  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144275 -0.00455813 -0.02970002]
Stock Position:  -0.0014427489288189228
Bond Position:  [7.58238874]


portfolio before change:  [7.4352334]
curr_Stock_Price:  103.31054004555205
curr_Factors:  [103.31054005  -0.52700493  -1.07013934]
mat_Sqrt:  [[20.9176884   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01221712 -0.08507176 -0.70536373]
Stock Position:  0.01221712283551512
Bond Position:  [6.17307584]


portfolio before change:  [7.42269474]
curr_Stock_Price:  102.15788591048063
curr_Factors:  [102.15788591  -0.27706081  -1.08703868]
mat_Sqrt:  [[26.11265399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00517054 -0.03282074 -0.17922368]
Stock Position:  0.005170543967642609
Bond Position:  [6.8944829]


portfolio before change:  [7.42783197]
curr_Stock_Price:  102.81804623232578
curr_Factors:  [ 1.02818046e+02  2.14647366e-04 -1.09474701e+00]
mat_Sqrt:  [[34.4127977   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00091198 -0.02673387 -0.0392241 ]
Stock Position:  0.0009119812290308282
Bond Position:  [7.33406384]


portfolio before change:  [7.42478785]
curr_Stock_Price:  97.46940594356087
curr_Factors:  [97.46940594 -0.3821893  -1.09597748]
mat_Sqrt:  [[22.22842249  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00871273  0.00137964 -0.01958425]
Stock Position:  0.008712734345623375
Bond Position:  [6.57556281]


portfolio before change:  [7.43332462]
curr_Stock_Price:  98.26050912878728
curr_Factors:  [98.26050913 -0.33735846 -1.06577256]
mat_Sqrt:  [[24.15499488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00350105  0.00549519  0.3168027 ]
Stock Position:  -0.003501046756642007
Bond Position:  [7.77733926]


portfolio before change:  [7.42912827]
curr_Stock_Price:  100.01453581108413
curr_Factors:  [100.01453581  -0.35657159  -1.08836597]
mat_Sqrt:  [[23.57950662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00625083  0.04213591 -0.0426719 ]
Stock Position:  -0.006250828738064677
Bond Position:  [8.05430201]


portfolio before change:  [7.4307236]
curr_Stock_Price:  100.08148687848409
curr_Factors:  [100.08148688  -0.46012845  -1.14219697]
mat_Sqrt:  [[20.15917058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00402611 -0.04180464  0.00020424]
Stock Position:  0.004026114979356467
Bond Position:  [7.02778403]


portfolio before change:  [7.43077485]
curr_Stock_Price:  99.65777348170732
curr_Factors:  [99.65777348 -0.59422431 -1.08242541]
mat_Sqrt:  [[18.6359466   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00341244 0.03047355 0.0602351 ]
Stock Position:  0.0034124449323190966
Bond Position:  [7.09069818]


portfolio before change:  [7.42813822]
curr_Stock_Price:  98.36558462295149
curr_Factors:  [98.36558462 -0.91293453 -1.02720303]
mat_Sqrt:  [[14.13357856  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00196909 0.05088766 0.20116374]
Stock Position:  0.001969088858890187
Bond Position:  [7.23444764]


portfolio before change:  [7.42849338]
curr_Stock_Price:  97.62733859480814
curr_Factors:  [97.62733859 -0.89289484 -1.00878488]
mat_Sqrt:  [[14.57747951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00136575 -0.04313721 -0.04499953]
Stock Position:  0.0013657538884806533
Bond Position:  [7.29515847]


portfolio before change:  [7.43010394]
curr_Stock_Price:  97.47104383721467
curr_Factors:  [97.47104384 -0.82961761 -1.01903288]
mat_Sqrt:  [[15.34676742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0055682  -0.02659749  0.51013304]
Stock Position:  -0.005568195639705364
Bond Position:  [7.97284178]


portfolio before change:  [7.42650425]
curr_Stock_Price:  98.47552529894784
curr_Factors:  [98.4755253  -0.86504504 -0.97983587]
mat_Sqrt:  [[15.56347983  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00297509 0.04450366 0.58189109]
Stock Position:  0.0029750893963974103
Bond Position:  [7.13353076]


portfolio before change:  [7.42835341]
curr_Stock_Price:  98.49755969051219
curr_Factors:  [98.49755969 -0.90975839 -0.95940979]
mat_Sqrt:  [[15.19343745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324807  0.03966723  0.09193741]
Stock Position:  -0.0032480666084462448
Bond Position:  [7.74828005]


portfolio before change:  [7.43124756]
curr_Stock_Price:  98.2029746800723
curr_Factors:  [98.20297468 -1.10808159 -0.94889391]
mat_Sqrt:  [[12.55427209  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00293749 -0.01493324  0.0894089 ]
Stock Position:  -0.002937486107030418
Bond Position:  [7.71971743]


portfolio before change:  [7.43047329]
curr_Stock_Price:  99.12363804250383
curr_Factors:  [99.12363804 -0.89822847 -0.96116939]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.43047329]
Stock Price:  100.69060625704824
PL:  [6.73986703]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.83874605e-01 -3.07979042e-02  8.92663099e-02]
 [-1.84617216e-02  8.59775069e-02  6.35992523e-02]
 [-2.36765599e-02 -2.09129785e-01  1.85161926e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 4.39101005e-01 -3.66911175e-01 -3.25953193e-01]
 [ 2.73707915e-02 -2.17797417e-01 -1.72661719e-01]
 [ 6.17591211e-02 -9.39757808e-02 -1.24755682e-02]
 [-1.53282342e-01 -2.70018713e-02 -4.94240392e-02]
 [-1.94466458e-01 -9.90821119e-02 -1.23890622e-01]
 [-6.45293732e-01  6.44994381e-01  1.00624903e-01]
 [ 7.52430036e-02 -2.02570795e-01  1.03811039e-01]
 [-2.03283398e-01 -4.81162859e-02 -4.22842925e-02]
 [-1.91932576e-01  6.41656320e-02 -2.02998721e-01]
 [-1.21679181e-01  1.12417742e-01  3.00516881e-02]
 [-1.29454800e-01 -1.15315841e-01  2.57976153e-01]
 [ 5.05876570e-03  2.63555026e-02 -3.24094360e-03]
 [-9.20687553e-02  5.28492989e-02  8.11415452e-02]
 [-3.48886827e-02 -1.01750846e-02  2.06016164e-02]
 [ 2.30425076e-03  5.82712125e-01  4.20808868e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.08556225]
curr_Stock_Price:  100.39135097291872
curr_Factors:  [100.39135097  -1.4436301   -0.98741671]
mat_Sqrt:  [[ 8.82888949  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03017915 -0.00973915  0.25465194]
Stock Position:  -0.030179151569599178
Bond Position:  [8.11528805]


portfolio before change:  [5.09408027]
curr_Stock_Price:  100.17633690027107
curr_Factors:  [100.1763369   -0.96206439  -0.94987361]
mat_Sqrt:  [[14.80542985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00022017  0.02718847  0.18143096]
Stock Position:  -0.00022016577165892058
Bond Position:  [5.11613567]


portfolio before change:  [5.09460741]
curr_Stock_Price:  103.59220138411024
curr_Factors:  [103.59220138  -1.21926027  -0.98100717]
mat_Sqrt:  [[11.47527367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00220445 -0.06613264  0.05282154]
Stock Position:  -0.002204449889980505
Bond Position:  [5.32297122]


portfolio before change:  [5.09547301]
curr_Stock_Price:  103.80327775099391
curr_Factors:  [103.80327775  -0.93807213  -0.92805536]
mat_Sqrt:  [[16.06061585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236253 -0.00455813 -0.02970002]
Stock Position:  -0.0023625343850059597
Bond Position:  [5.34071182]


portfolio before change:  [5.09465938]
curr_Stock_Price:  104.71288114782251
curr_Factors:  [104.71288115  -0.75572493  -0.95052033]
mat_Sqrt:  [[19.01022278  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01909985 -0.1160275  -0.92985373]
Stock Position:  0.019099854165513144
Bond Position:  [3.09465863]


portfolio before change:  [5.10966234]
curr_Stock_Price:  105.4578708389419
curr_Factors:  [105.45787084  -0.93370628  -0.9331664 ]
mat_Sqrt:  [[16.3044629   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00082782 -0.06887359 -0.49255582]
Stock Position:  -0.0008278187043232781
Bond Position:  [5.19696234]


portfolio before change:  [5.11021856]
curr_Stock_Price:  106.35563380274588
curr_Factors:  [106.3556338   -1.17002774  -0.9498677 ]
mat_Sqrt:  [[12.76737489  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00444775 -0.02971775 -0.03558932]
Stock Position:  0.004447751606289964
Bond Position:  [4.63717512]


portfolio before change:  [5.1124951]
curr_Stock_Price:  106.60679520113979
curr_Factors:  [106.6067952   -1.20187172  -0.94012802]
mat_Sqrt:  [[12.51774846  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01310684 -0.00853874 -0.14099303]
Stock Position:  -0.013106843290231764
Bond Position:  [6.50977366]


portfolio before change:  [5.10535803]
curr_Stock_Price:  107.2755084820684
curr_Factors:  [107.27550848  -1.13860363  -0.96909716]
mat_Sqrt:  [[13.03580223  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0170541  -0.03133251 -0.35342546]
Stock Position:  -0.017054095365428627
Bond Position:  [6.93484478]


portfolio before change:  [5.08921581]
curr_Stock_Price:  108.3237110953973
curr_Factors:  [108.3237111   -1.19994638  -0.99059626]
mat_Sqrt:  [[12.11666068  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0501871   0.20396513  0.28705484]
Stock Position:  -0.05018710125923998
Bond Position:  [10.52566887]


portfolio before change:  [5.12256785]
curr_Stock_Price:  107.71159565431998
curr_Factors:  [107.71159565  -1.28409561  -0.93817452]
mat_Sqrt:  [[11.6719336   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00781387 -0.06405851  0.296144  ]
Stock Position:  0.007813871364167765
Bond Position:  [4.2809233]


portfolio before change:  [5.13469901]
curr_Stock_Price:  109.12712906686971
curr_Factors:  [109.12712907  -1.41814139  -0.97651628]
mat_Sqrt:  [[ 9.95281927  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02141675 -0.01521571 -0.12062532]
Stock Position:  -0.021416745836160316
Bond Position:  [7.471847]


portfolio before change:  [5.11753708]
curr_Stock_Price:  110.01569201481249
curr_Factors:  [110.01569201  -1.09949542  -1.02632892]
mat_Sqrt:  [[13.1286736   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01764937  0.02029095 -0.57909885]
Stock Position:  -0.017649366115843574
Bond Position:  [7.05924431]


portfolio before change:  [5.11666947]
curr_Stock_Price:  110.16485550177205
curr_Factors:  [110.1648555   -1.10527338  -1.03863408]
mat_Sqrt:  [[12.91088133  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0087246   0.03554961  0.0857291 ]
Stock Position:  -0.0087246013269623
Bond Position:  [6.07781392]


portfolio before change:  [5.13345475]
curr_Stock_Price:  108.41513296944817
curr_Factors:  [108.41513297  -0.79640168  -1.013292  ]
mat_Sqrt:  [[17.74802073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00449476 -0.03646607  0.73593416]
Stock Position:  -0.004494759265352346
Bond Position:  [5.62075467]


portfolio before change:  [5.14655167]
curr_Stock_Price:  105.813980805023
curr_Factors:  [105.81398081  -0.84424252  -1.04648071]
mat_Sqrt:  [[15.97395243  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00031787  0.00833434 -0.00924551]
Stock Position:  0.00031787417880474434
Bond Position:  [5.11291613]


portfolio before change:  [5.1482802]
curr_Stock_Price:  107.23009701984189
curr_Factors:  [107.23009702  -0.82556533  -1.08141687]
mat_Sqrt:  [[15.92666532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00465516  0.01671242  0.23147424]
Stock Position:  -0.004655164297240416
Bond Position:  [5.64745392]


portfolio before change:  [5.15418952]
curr_Stock_Price:  106.26401365596554
curr_Factors:  [106.26401366  -0.67116322  -1.06007529]
mat_Sqrt:  [[18.81563528  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016447  -0.00321764  0.05877068]
Stock Position:  -0.00164470210326986
Bond Position:  [5.32896216]


portfolio before change:  [5.15307436]
curr_Stock_Price:  107.75216294586406
curr_Factors:  [107.75216295  -0.55434923  -1.06843787]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.15307436]
Stock Price:  106.55356070717241
PL:  [-1.40048634]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.52053892e-01 -5.26988354e-02  1.41879250e-01]
 [-6.69269261e-02  1.17109876e-01  8.14578320e-02]
 [-5.36520977e-02 -2.64581157e-01  3.66520338e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 2.09781886e-01 -1.88409455e-01 -1.81894660e-01]
 [-3.73439992e-02  5.55140475e-02  2.11587209e-02]
 [-2.40680925e-02 -6.36452340e-02 -1.60817998e-03]
 [-3.83491960e-02 -3.69071764e-02 -2.08310754e-02]
 [-1.43224631e-04  3.23791811e-02 -4.47409290e-02]
 [-1.81954222e-01  1.66072535e-01 -1.16574908e-02]
 [ 1.09805684e-01 -1.71340442e-01  2.97266589e-02]
 [ 1.01045356e-01  1.11559441e-01 -2.60359098e-02]
 [-9.52354297e-03  1.69068337e-01  5.16212811e-02]
 [-6.39403433e-02 -1.32565794e-01  6.49618732e-03]
 [-1.57753223e-01 -1.17641417e-01  2.41502947e-01]
 [-1.16923822e-03  7.38492841e-02  6.21326374e-02]
 [-1.69513776e-01 -2.44140316e-02  8.27270752e-02]
 [-5.05470009e-02 -5.73981965e-02  2.27710660e-02]
 [-2.08692092e-02  5.75111743e-01  2.91279519e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.26926864]
curr_Stock_Price:  99.5061304751553
curr_Factors:  [99.50613048 -0.9882983  -1.00394495]
mat_Sqrt:  [[13.57155429  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01653853 -0.01666483  0.40474201]
Stock Position:  -0.016538532345940993
Bond Position:  [0.37641672]


portfolio before change:  [-1.27194337]
curr_Stock_Price:  99.67354835453067
curr_Factors:  [99.67354835 -1.02011355 -1.01075477]
mat_Sqrt:  [[13.07931548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361454  0.03703339  0.23237652]
Stock Position:  -0.0036145356259994414
Bond Position:  [-0.91166977]


portfolio before change:  [-1.27155993]
curr_Stock_Price:  99.50440301360288
curr_Factors:  [99.50440301 -0.76486698 -1.10609029]
mat_Sqrt:  [[15.32130926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00345936 -0.08366791  0.10455805]
Stock Position:  -0.0034593641981909787
Bond Position:  [-0.92733796]


portfolio before change:  [-1.27962244]
curr_Stock_Price:  101.76801028713753
curr_Factors:  [101.76801029  -0.9450638   -1.14136925]
mat_Sqrt:  [[12.63237249  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300369 -0.00455813 -0.02970002]
Stock Position:  -0.003003692080592943
Bond Position:  [-0.97394267]


portfolio before change:  [-1.27920661]
curr_Stock_Price:  101.54849908976648
curr_Factors:  [101.54849909  -0.87067532  -1.14014083]
mat_Sqrt:  [[13.59524855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01234167 -0.0595803  -0.51889483]
Stock Position:  0.012341670879702433
Bond Position:  [-2.53248476]


portfolio before change:  [-1.30113788]
curr_Stock_Price:  99.82279488261281
curr_Factors:  [99.82279488 -0.50608802 -1.14922487]
mat_Sqrt:  [[19.06937545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00165667  0.01755508  0.06035994]
Stock Position:  -0.0016566681458466557
Bond Position:  [-1.13576464]


portfolio before change:  [-1.30071012]
curr_Stock_Price:  99.39317592673459
curr_Factors:  [99.39317593 -0.56336365 -1.17276841]
mat_Sqrt:  [[17.51313895  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148687 -0.02012639 -0.00458769]
Stock Position:  -0.001486865019603829
Bond Position:  [-1.15292589]


portfolio before change:  [-1.30235838]
curr_Stock_Price:  100.30784410314867
curr_Factors:  [100.3078441   -0.68483734  -1.18853298]
mat_Sqrt:  [[15.40779546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282677 -0.01167107 -0.05942526]
Stock Position:  -0.0028267678346761706
Bond Position:  [-1.01881139]


portfolio before change:  [-1.30417976]
curr_Stock_Price:  100.86206269899024
curr_Factors:  [100.8620627  -0.3337458  -1.1499169]
mat_Sqrt:  [[22.87606499  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036894  0.0102392  -0.12763342]
Stock Position:  -0.0003689402728929764
Bond Position:  [-1.26696768]


portfolio before change:  [-1.30423986]
curr_Stock_Price:  100.16634979532459
curr_Factors:  [100.1663498   -0.54133543  -1.11396675]
mat_Sqrt:  [[19.1352106   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00940914  0.05251675 -0.03325558]
Stock Position:  -0.009409137228927097
Bond Position:  [-0.36176093]


portfolio before change:  [-1.32683913]
curr_Stock_Price:  102.55857927037334
curr_Factors:  [102.55857927  -0.19805868  -1.15809733]
mat_Sqrt:  [[26.42414358  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00421772 -0.05418261  0.08480188]
Stock Position:  0.004217719337114123
Bond Position:  [-1.75940243]


portfolio before change:  [-1.34632343]
curr_Stock_Price:  98.04325067680833
curr_Factors:  [98.04325068 -0.39949436 -1.16039142]
mat_Sqrt:  [[20.60477701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00478584  0.03527819 -0.0742732 ]
Stock Position:  0.004785844125094676
Bond Position:  [-1.81554314]


portfolio before change:  [-1.34154803]
curr_Stock_Price:  99.13591761045068
curr_Factors:  [99.13591761 -0.58007818 -1.16188834]
mat_Sqrt:  [[17.36619126  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00030974 0.0534641  0.14726115]
Stock Position:  0.0003097358845789112
Bond Position:  [-1.37225399]


portfolio before change:  [-1.34120749]
curr_Stock_Price:  101.3431242712591
curr_Factors:  [101.34312427  -0.39458081  -1.17957837]
mat_Sqrt:  [[20.99643904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00314516 -0.04192098  0.01853181]
Stock Position:  -0.003145159449525841
Bond Position:  [-1.02246721]


portfolio before change:  [-1.34454695]
curr_Stock_Price:  102.32361910642658
curr_Factors:  [102.32361911  -0.56240927  -1.18320854]
mat_Sqrt:  [[17.85927021  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00624293 -0.03720148  0.68894069]
Stock Position:  -0.0062429274908966745
Bond Position:  [-0.70574802]


portfolio before change:  [-1.34352362]
curr_Stock_Price:  102.1314349908511
curr_Factors:  [102.13143499  -0.5337308   -1.1677525 ]
mat_Sqrt:  [[18.63007599  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00072036 0.02335319 0.17724712]
Stock Position:  0.000720357426078339
Bond Position:  [-1.41709476]


portfolio before change:  [-1.34479283]
curr_Stock_Price:  100.86137611948563
curr_Factors:  [ 1.00861376e+02 -7.97113508e-02 -1.18314767e+00]
mat_Sqrt:  [[28.52805635  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00537217 -0.00772039  0.23599732]
Stock Position:  -0.005372169355999277
Bond Position:  [-0.80294844]


portfolio before change:  [-1.33789198]
curr_Stock_Price:  99.5394497039162
curr_Factors:  [99.5394497  -0.18935651 -1.18431813]
mat_Sqrt:  [[25.20089238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188013 -0.0181509   0.06495951]
Stock Position:  -0.001880127529733189
Bond Position:  [-1.15074512]


portfolio before change:  [-1.33868981]
curr_Stock_Price:  99.81076432083763
curr_Factors:  [ 9.98107643e+01 -9.81706392e-02 -1.23412213e+00]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.33868981]
Stock Price:  102.09756710318001
PL:  [-3.43625691]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.09253891e-01 -3.35814096e-02  1.01915584e-01]
 [-4.59197517e-02  1.09789645e-01  1.00800947e-01]
 [-4.73329738e-02 -2.55643811e-01  3.90170864e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.87266758e-01 -3.25732389e-01 -2.91830066e-01]
 [-1.93912426e-01 -2.92440596e-02 -1.33306107e-01]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [-4.41303381e-02 -2.24356988e-02 -1.38507870e-01]
 [-5.25174278e-01  5.12845135e-01  7.39202765e-02]
 [ 8.87756585e-02 -1.34716777e-01  1.75281158e-04]
 [-1.81856515e-01 -4.19977018e-02 -4.84306813e-02]
 [-5.05549596e-02  1.51536738e-01 -3.30108889e-03]
 [-5.88528006e-02  1.00964907e-01 -6.36984345e-02]
 [-2.77016933e-01 -1.82486375e-01  3.25524911e-01]
 [ 3.40711582e-02  1.20840969e-01  2.09299333e-01]
 [-8.60737536e-02  6.35735232e-02  7.52645363e-02]
 [-3.81416828e-02 -1.99213526e-02  2.10117124e-02]
 [-2.44009273e-02  4.94445230e-01  2.60802249e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.6560909]
curr_Stock_Price:  99.91362963089928
curr_Factors:  [99.91362963 -1.0937234  -1.00535557]
mat_Sqrt:  [[12.2463403   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02362482 -0.01061937  0.29073679]
Stock Position:  -0.023624815275867274
Bond Position:  [4.01653194]


portfolio before change:  [1.65114084]
curr_Stock_Price:  100.16566622989079
curr_Factors:  [100.16566623  -1.29269153  -0.98820091]
mat_Sqrt:  [[10.23622641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00219896  0.03471853  0.28755704]
Stock Position:  -0.0021989634783194916
Bond Position:  [1.87140148]


portfolio before change:  [1.65062801]
curr_Stock_Price:  100.61166477401878
curr_Factors:  [100.61166477  -1.30560809  -0.98557999]
mat_Sqrt:  [[10.17648969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00451721 -0.08084167  0.11130489]
Stock Position:  -0.004517209824550877
Bond Position:  [2.10511201]


portfolio before change:  [1.64231736]
curr_Stock_Price:  102.56795962677305
curr_Factors:  [102.56795963  -1.59403751  -1.0187278 ]
mat_Sqrt:  [[ 7.5214601   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00504473 -0.00455813 -0.02970002]
Stock Position:  -0.005044732895071608
Bond Position:  [2.15974532]


portfolio before change:  [1.63864959]
curr_Stock_Price:  103.40205273398425
curr_Factors:  [103.40205273  -1.63660888  -0.99129965]
mat_Sqrt:  [[ 7.46866515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04275019 -0.10300563 -0.83250995]
Stock Position:  0.04275018564535599
Bond Position:  [-2.78180736]


portfolio before change:  [1.64352773]
curr_Stock_Price:  103.53243065384784
curr_Factors:  [103.53243065  -2.14565724  -0.954391  ]
mat_Sqrt:  [[ 4.66382842  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04757433 -0.00924778 -0.38028522]
Stock Position:  -0.04757432719359035
Bond Position:  [6.56901346]


portfolio before change:  [1.63151231]
curr_Stock_Price:  103.81951571666714
curr_Factors:  [103.81951572  -2.20856444  -0.93482289]
mat_Sqrt:  [[ 4.47840358  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126525 -0.02845143  0.0120735 ]
Stock Position:  -0.0012652486055735445
Bond Position:  [1.76286981]


portfolio before change:  [1.63236169]
curr_Stock_Price:  103.4965683776878
curr_Factors:  [103.49656838  -1.77374887  -0.98569753]
mat_Sqrt:  [[ 6.55410814  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02129738 -0.01496598 -0.14840805]
Stock Position:  -0.02129738038046214
Bond Position:  [3.83656748]


portfolio before change:  [1.62987208]
curr_Stock_Price:  103.65850717227903
curr_Factors:  [103.65850717  -1.9539119   -0.99012601]
mat_Sqrt:  [[ 5.45789949  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01337189 -0.00709479 -0.3951244 ]
Stock Position:  -0.013371888965308366
Bond Position:  [3.01598213]


portfolio before change:  [1.62809649]
curr_Stock_Price:  103.84768607989731
curr_Factors:  [103.84768608  -1.92012142  -1.01725969]
mat_Sqrt:  [[ 5.50438014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09026334  0.16217587  0.21087397]
Stock Position:  -0.09026334437366389
Bond Position:  [11.00173594]


portfolio before change:  [1.62554278]
curr_Stock_Price:  103.90645287184486
curr_Factors:  [103.90645287  -1.86991405  -1.00962039]
mat_Sqrt:  [[ 5.83548024  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01462314 -0.04260119  0.00050003]
Stock Position:  0.014623143566213663
Bond Position:  [0.1061038]


portfolio before change:  [1.63330488]
curr_Stock_Price:  104.43544752750554
curr_Factors:  [104.43544753  -1.87498535  -0.99522079]
mat_Sqrt:  [[ 5.92015722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03257122 -0.01328084 -0.13815925]
Stock Position:  -0.03257122328798424
Bond Position:  [5.03489516]


portfolio before change:  [1.61701161]
curr_Stock_Price:  104.97433276017443
curr_Factors:  [104.97433276  -1.82263297  -1.01542495]
mat_Sqrt:  [[ 6.14511803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00769979  0.04792012 -0.00941709]
Stock Position:  -0.007699791859986656
Bond Position:  [2.42529212]


portfolio before change:  [1.61813837]
curr_Stock_Price:  104.9067512709965
curr_Factors:  [104.90675127  -1.74305507  -1.01450563]
mat_Sqrt:  [[ 6.65594988  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01040397  0.03192791 -0.1817139 ]
Stock Position:  -0.01040396752153643
Bond Position:  [2.7095848]


portfolio before change:  [1.61749699]
curr_Stock_Price:  105.03351649286867
curr_Factors:  [105.03351649  -2.07008893  -1.01270397]
mat_Sqrt:  [[ 4.81379909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04472169 -0.05770726  0.92863196]
Stock Position:  -0.044721687110864224
Bond Position:  [6.31477305]


portfolio before change:  [1.619265]
curr_Stock_Price:  105.02928765440178
curr_Factors:  [105.02928765  -2.15030456  -1.02936816]
mat_Sqrt:  [[ 4.36914142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01829062 0.03821327 0.59707274]
Stock Position:  0.018290620120930287
Bond Position:  [-0.3017858]


portfolio before change:  [1.6190453]
curr_Stock_Price:  105.02140163972251
curr_Factors:  [105.02140164  -2.06948198  -1.00325602]
mat_Sqrt:  [[ 4.86188463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01420622  0.02010371  0.21470877]
Stock Position:  -0.014206215978664762
Bond Position:  [3.11100202]


portfolio before change:  [1.61545673]
curr_Stock_Price:  105.32876134436216
curr_Factors:  [105.32876134  -1.7873791   -1.00717482]
mat_Sqrt:  [[ 6.44002617  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00533648 -0.00629968  0.05994057]
Stock Position:  -0.005336477077542999
Bond Position:  [2.17754125]


portfolio before change:  [1.61618586]
curr_Stock_Price:  105.29415595100305
curr_Factors:  [105.29415595  -1.58877291  -1.01177355]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.61618586]
Stock Price:  104.65757063537787
PL:  [-3.04138478]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.88128129e-01 -3.12119004e-02  9.12446884e-02]
 [ 2.92180908e-02  3.57904982e-02  7.49893647e-02]
 [-6.95397396e-03 -9.16008468e-02  3.74340575e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 2.91814606e-01 -2.50965530e-01 -2.30989826e-01]
 [-1.90927720e-02 -1.33243919e-02 -6.51886430e-02]
 [ 4.05234264e-02 -7.92984074e-02 -7.21106244e-03]
 [-8.50949823e-02 -1.21312596e-01 -5.53293894e-02]
 [-1.06810451e-01 -5.08766260e-02 -1.24587782e-01]
 [-5.41265833e-01  5.32617294e-01  5.26454467e-02]
 [ 9.74130791e-02 -2.00517119e-01  8.02660530e-02]
 [-1.46771530e-01 -1.73972309e-02 -1.74951398e-02]
 [-1.24858549e-01  1.20888299e-01 -1.02333344e-01]
 [-1.17348116e-01  4.15704792e-03  1.43998468e-01]
 [-1.52221332e-01 -1.20963111e-01  2.55250591e-01]
 [ 6.08761538e-03  1.54700083e-02 -1.86051354e-02]
 [-9.17640906e-02  5.33943019e-02  8.08428768e-02]
 [-3.22624786e-02 -2.36115090e-03  2.03048986e-02]
 [-3.24639499e-03  5.38743410e-01  3.71108620e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.15387198]
curr_Stock_Price:  100.26156760908447
curr_Factors:  [100.26156761  -1.21946569  -1.04286274]
mat_Sqrt:  [[10.4380107   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02589658 -0.00987007  0.2602957 ]
Stock Position:  -0.025896579392858915
Bond Position:  [6.75030362]


portfolio before change:  [4.11561807]
curr_Stock_Price:  101.80392151277418
curr_Factors:  [101.80392151  -1.56398637  -1.0711915 ]
mat_Sqrt:  [[ 7.29997378  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00622596 0.01131795 0.21392378]
Stock Position:  0.0062259590010791755
Bond Position:  [3.48179103]


portfolio before change:  [4.11721415]
curr_Stock_Price:  101.92045308126498
curr_Factors:  [101.92045308  -1.3086338   -1.06310115]
mat_Sqrt:  [[ 9.51108243  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00017642 -0.02896673  0.10678895]
Stock Position:  -0.0001764155324801046
Bond Position:  [4.1351945]


portfolio before change:  [4.11827359]
curr_Stock_Price:  101.77583763266627
curr_Factors:  [101.77583763  -1.44559452  -1.0815391 ]
mat_Sqrt:  [[ 8.13063566  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00466676 -0.00455813 -0.02970002]
Stock Position:  -0.004666763924605809
Bond Position:  [4.5932374]


portfolio before change:  [4.11778185]
curr_Stock_Price:  102.12729975378154
curr_Factors:  [102.12729975  -1.12150093  -1.05088041]
mat_Sqrt:  [[11.63291671  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02047501 -0.07936227 -0.65894968]
Stock Position:  0.020475011461315876
Bond Position:  [2.02672422]


portfolio before change:  [4.11076235]
curr_Stock_Price:  101.75971772740661
curr_Factors:  [101.75971773  -1.19736203  -1.05685498]
mat_Sqrt:  [[10.68026153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306578 -0.00421354 -0.18596505]
Stock Position:  -0.003065784692709883
Bond Position:  [4.42273574]


portfolio before change:  [4.10646478]
curr_Stock_Price:  103.5222023009697
curr_Factors:  [103.5222023   -0.72337828  -1.09777719]
mat_Sqrt:  [[16.75389286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00220868 -0.02507636 -0.02057115]
Stock Position:  0.002208680615390764
Bond Position:  [3.87781729]


portfolio before change:  [4.11049088]
curr_Stock_Price:  104.90607475946737
curr_Factors:  [104.90607476  -0.80000598  -1.08769425]
mat_Sqrt:  [[15.88484003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00626518 -0.03836241 -0.15783935]
Stock Position:  -0.0062651763681484075
Bond Position:  [4.76774594]


portfolio before change:  [4.109757]
curr_Stock_Price:  105.21348378672678
curr_Factors:  [105.21348379  -0.92643167  -1.13739478]
mat_Sqrt:  [[13.35866206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00999767 -0.0160886  -0.35541426]
Stock Position:  -0.009997667000373104
Bond Position:  [5.16164637]


portfolio before change:  [4.1004105]
curr_Stock_Price:  106.27743918688935
curr_Factors:  [106.27743919  -0.99130406  -1.16875836]
mat_Sqrt:  [[12.25569346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04216551  0.16842838  0.15018281]
Stock Position:  -0.04216550524964408
Bond Position:  [8.58165242]


portfolio before change:  [4.09373844]
curr_Stock_Price:  106.4865612339786
curr_Factors:  [106.48656123  -0.89264339  -1.16758762]
mat_Sqrt:  [[13.56900012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00800501 -0.06340908  0.22897671]
Stock Position:  0.0080050105276264
Bond Position:  [3.2413124]


portfolio before change:  [4.09687746]
curr_Stock_Price:  106.7774529388841
curr_Factors:  [106.77745294  -1.04696694  -1.1844272 ]
mat_Sqrt:  [[11.46561608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01315166 -0.00550149 -0.04990876]
Stock Position:  -0.013151661761255621
Bond Position:  [5.50117841]


portfolio before change:  [4.09020053]
curr_Stock_Price:  107.3897256686547
curr_Factors:  [107.38972567  -0.96642191  -1.20544927]
mat_Sqrt:  [[12.23858091  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0116538   0.03822824 -0.29192855]
Stock Position:  -0.011653796643995917
Bond Position:  [5.34169855]


portfolio before change:  [4.11004963]
curr_Stock_Price:  105.80110044386751
curr_Factors:  [105.80110044  -1.05396389  -1.15194918]
mat_Sqrt:  [[11.65398121  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00753796  0.00131457  0.41078755]
Stock Position:  -0.007537957664133383
Bond Position:  [4.90757385]


portfolio before change:  [4.10991002]
curr_Stock_Price:  105.98240477040578
curr_Factors:  [105.98240477  -1.08721598  -1.11964038]
mat_Sqrt:  [[11.66294504  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00885212 -0.03825189  0.72815889]
Stock Position:  -0.008852118973954867
Bond Position:  [5.04807887]


portfolio before change:  [4.10105798]
curr_Stock_Price:  107.12497952405442
curr_Factors:  [107.12497952  -1.09008261  -1.09973595]
mat_Sqrt:  [[11.99125489  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00022427  0.00489205 -0.05307527]
Stock Position:  0.00022427109828582797
Bond Position:  [4.07703295]


portfolio before change:  [4.10230437]
curr_Stock_Price:  108.13716346211973
curr_Factors:  [108.13716346  -1.03068294  -1.08511222]
mat_Sqrt:  [[13.03457309  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00566827  0.01688476  0.23062223]
Stock Position:  -0.005668269453847713
Bond Position:  [4.71525495]


portfolio before change:  [4.10750442]
curr_Stock_Price:  107.42776051317522
curr_Factors:  [107.42776051  -0.8556464   -1.05636636]
mat_Sqrt:  [[15.87595753  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00177493 -0.00074666  0.05792422]
Stock Position:  -0.0017749306247821762
Bond Position:  [4.29818124]


portfolio before change:  [4.10561825]
curr_Stock_Price:  109.09591215962966
curr_Factors:  [109.09591216  -1.25095779  -1.06810915]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.10561825]
Stock Price:  108.00088170206885
PL:  [-3.89526345]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.68326353e-01 -1.95515733e-02  3.55230668e-02]
 [ 1.19632675e-01 -2.28701254e-02 -9.01878737e-02]
 [ 2.77760894e-02  3.94988112e-02  3.51473000e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 4.74094154e-01 -3.94710853e-01 -3.48989616e-01]
 [ 4.45459975e-02 -3.14364360e-01 -2.25014928e-01]
 [ 7.60377641e-02 -1.32195626e-01 -1.57738715e-02]
 [-1.62954886e-02 -2.57446317e-01 -6.02288751e-02]
 [-2.02999545e-01 -1.03050171e-01 -1.22122189e-01]
 [-6.65429794e-01  6.66344867e-01  9.54577569e-02]
 [ 8.85823508e-02 -2.23806928e-01  1.20613406e-01]
 [-2.03283398e-01 -4.81162859e-02 -4.22842925e-02]
 [-1.43696419e-01  9.87855003e-02 -1.32999111e-01]
 [-1.23782013e-01  6.66257461e-02  8.47904053e-02]
 [-1.01127764e-01 -1.02297777e-01  2.44664610e-01]
 [-2.74349656e-02 -5.34045107e-03 -8.56723596e-02]
 [-9.17986338e-02  5.33325089e-02  8.08767401e-02]
 [-2.49659089e-02  1.89674863e-02  1.97213895e-02]
 [ 1.28249772e-02  5.95467695e-01  4.69699241e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.29643336]
curr_Stock_Price:  102.51020749804462
curr_Factors:  [102.5102075   -1.00338133  -1.01003889]
mat_Sqrt:  [[13.68830971  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01180424 -0.00618275  0.10133742]
Stock Position:  -0.01180423732690531
Bond Position:  [21.50648818]


portfolio before change:  [20.29316815]
curr_Stock_Price:  103.24236006931012
curr_Factors:  [103.24236007  -0.50326486  -1.04193879]
mat_Sqrt:  [[22.01833652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0045704  -0.00723217 -0.2572809 ]
Stock Position:  0.0045704019665928
Bond Position:  [19.82130907]


portfolio before change:  [20.29238202]
curr_Stock_Price:  101.985998017518
curr_Factors:  [101.98599802  -0.65994507  -1.03637588]
mat_Sqrt:  [[18.69983281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00192357 0.01249062 0.10026546]
Stock Position:  0.0019235656962005919
Bond Position:  [20.09620525]


portfolio before change:  [20.30117857]
curr_Stock_Price:  103.94687575907399
curr_Factors:  [103.94687576  -0.54486133  -1.06297083]
mat_Sqrt:  [[20.82278447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182222 -0.00455813 -0.02970002]
Stock Position:  -0.0018222230202514544
Bond Position:  [20.49059296]


portfolio before change:  [20.30193507]
curr_Stock_Price:  106.34328827890968
curr_Factors:  [106.34328828  -0.77834717  -1.03933921]
mat_Sqrt:  [[17.27026185  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02273651 -0.12481853 -0.99557023]
Stock Position:  0.022736514330248852
Bond Position:  [17.88405937]


portfolio before change:  [20.32831855]
curr_Stock_Price:  107.30702035750417
curr_Factors:  [107.30702036  -0.98804093  -1.07152221]
mat_Sqrt:  [[13.68268191  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069444 -0.09941074 -0.64190496]
Stock Position:  -0.0006944424524324332
Bond Position:  [20.4028371]


portfolio before change:  [20.33288992]
curr_Stock_Price:  108.07018392749083
curr_Factors:  [108.07018393  -0.36550557  -1.07498594]
mat_Sqrt:  [[25.59224456  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00271194 -0.04180393 -0.04499846]
Stock Position:  0.002711941091052666
Bond Position:  [20.03980995]


portfolio before change:  [20.33869892]
curr_Stock_Price:  108.36459452109243
curr_Factors:  [108.36459452  -0.73585537  -1.05828618]
mat_Sqrt:  [[18.01779478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195567 -0.08141167 -0.17181622]
Stock Position:  -0.0019556717111545306
Bond Position:  [20.5506245]


portfolio before change:  [20.34553836]
curr_Stock_Price:  107.49474739375745
curr_Factors:  [107.49474739  -0.95778223  -1.04437372]
mat_Sqrt:  [[14.51650138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01588457 -0.03258733 -0.34838061]
Stock Position:  -0.015884569575240353
Bond Position:  [22.05304615]


portfolio before change:  [20.32183378]
curr_Stock_Price:  109.33417554632032
curr_Factors:  [109.33417555  -0.92321263  -1.04829547]
mat_Sqrt:  [[15.22442312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04129809  0.21071675  0.27231441]
Stock Position:  -0.041298090962225066
Bond Position:  [24.83712651]


portfolio before change:  [20.35664897]
curr_Stock_Price:  108.64152534592893
curr_Factors:  [108.64152535  -1.02540386  -1.04753036]
mat_Sqrt:  [[13.66884942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00785902 -0.07077396  0.34407648]
Stock Position:  0.007859022072517168
Bond Position:  [19.50283283]


portfolio before change:  [20.35902749]
curr_Stock_Price:  108.3236999682251
curr_Factors:  [108.32369997  -1.05295272  -1.03906428]
mat_Sqrt:  [[13.37125107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01594144 -0.01521571 -0.12062532]
Stock Position:  -0.015941440303494165
Bond Position:  [22.08586329]


portfolio before change:  [20.35916719]
curr_Stock_Price:  108.66133947823845
curr_Factors:  [108.66133948  -1.32030528  -1.05219447]
mat_Sqrt:  [[10.13238082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01660953  0.03123872 -0.37940944]
Stock Position:  -0.016609533406456684
Bond Position:  [22.16398134]


portfolio before change:  [20.36461427]
curr_Stock_Price:  108.66703556368894
curr_Factors:  [108.66703556  -1.01764335  -1.04858102]
mat_Sqrt:  [[13.764105    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00761066  0.02106891  0.24188343]
Stock Position:  -0.0076106637481508374
Bond Position:  [21.19164254]


portfolio before change:  [20.36837177]
curr_Stock_Price:  108.86952361812988
curr_Factors:  [108.86952362  -0.58006294  -1.04094391]
mat_Sqrt:  [[21.52345512  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00250086 -0.0323494   0.69796003]
Stock Position:  -0.0025008589951176527
Bond Position:  [20.6406391]


portfolio before change:  [20.37864963]
curr_Stock_Price:  106.82340719210288
curr_Factors:  [106.82340719  -0.50607381  -1.02706654]
mat_Sqrt:  [[23.05855187  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195418 -0.0016888  -0.2443994 ]
Stock Position:  -0.001954183977598177
Bond Position:  [20.58740222]


portfolio before change:  [20.3839767]
curr_Stock_Price:  106.73151316656772
curr_Factors:  [106.73151317  -0.54265082  -1.03409812]
mat_Sqrt:  [[22.05562166  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0033512   0.01686522  0.23071883]
Stock Position:  -0.00335119544640861
Bond Position:  [20.74165486]


portfolio before change:  [20.3773661]
curr_Stock_Price:  110.25164835759314
curr_Factors:  [110.25164836  -0.59257632  -1.00279277]
mat_Sqrt:  [[22.36274441  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00091449  0.00599805  0.05625964]
Stock Position:  -0.0009144923512706621
Bond Position:  [20.47819039]


portfolio before change:  [20.38231036]
curr_Stock_Price:  110.44402937486177
curr_Factors:  [110.44402937  -0.63373939  -1.03933296]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.38231036]
Stock Price:  111.57581407251809
PL:  [8.80649628]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.55309169e-01 -5.67899321e-02  1.33307429e-01]
 [-2.65826716e-01  2.24728399e-01  6.63659128e-02]
 [-1.93718644e-01 -5.19846062e-01 -7.95696275e-02]
 [-3.26787300e-02  2.02799082e-01  1.35414643e-01]
 [-4.38183033e-02  1.32394402e-01  1.21167073e-01]
 [-2.51990844e-01  1.07997576e-01  5.87845199e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 3.89057252e-01  4.28198576e-02 -1.81831319e-02]
 [-4.67086175e-01 -3.07361944e-02  6.21453803e-01]
 [-1.16380721e-01  9.31989410e-02 -3.17618444e-02]
 [-8.61371657e-02 -1.09899287e-02  1.30860409e-02]
 [ 1.57900972e-01  2.61405984e-02 -2.04714729e-01]
 [ 1.06428277e-03  5.71602261e-02  1.72416663e-02]
 [ 2.12207134e-01 -4.19587215e-01  1.21462342e-01]
 [ 4.66956549e-03  4.99910531e-02 -3.58987436e-02]
 [-2.48245578e-02  1.97500141e-01  3.23200394e-01]
 [ 1.17894410e-02 -3.32370539e-02 -5.43382198e-02]
 [ 3.15950869e-02  4.40161288e-02  1.36521796e-01]
 [-3.78132340e-02  4.44068919e-01  1.40110801e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.8717791]
curr_Stock_Price:  99.14360381577687
curr_Factors:  [99.14360382 -0.74393441 -1.05063099]
mat_Sqrt:  [[16.47763395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00786304 -0.01795855  0.38028899]
Stock Position:  -0.007863035046776056
Bond Position:  [-3.09220947]


portfolio before change:  [-3.86952587]
curr_Stock_Price:  98.7587164696758
curr_Factors:  [98.75871647 -0.88601361 -1.03478583]
mat_Sqrt:  [[14.46714526  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01703704  0.07106536  0.18932348]
Stock Position:  -0.017037042465384407
Bond Position:  [-2.18696942]


portfolio before change:  [-3.85133573]
curr_Stock_Price:  97.65893949016547
curr_Factors:  [97.65893949 -0.64583646 -1.00331712]
mat_Sqrt:  [[18.77127201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01190026 -0.16438976 -0.22699   ]
Stock Position:  -0.01190026405399292
Bond Position:  [-2.68916857]


portfolio before change:  [-3.82548282]
curr_Stock_Price:  95.42997330219886
curr_Factors:  [95.4299733  -0.39051461 -1.03045632]
mat_Sqrt:  [[23.04437682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [8.63195306e-06 6.41307008e-02 3.86300283e-01]
Stock Position:  8.631953055088842e-06
Bond Position:  [-3.82630657]


portfolio before change:  [-3.82646372]
curr_Stock_Price:  92.62625271857348
curr_Factors:  [92.62625272 -0.41000185 -1.06238281]
mat_Sqrt:  [[21.24641025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00073738  0.04186679  0.34565593]
Stock Position:  -0.0007373843046365636
Bond Position:  [-3.75816258]


portfolio before change:  [-3.82730553]
curr_Stock_Price:  92.4935540469307
curr_Factors:  [92.49355405 -0.34492909 -1.07500568]
mat_Sqrt:  [[22.35844688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0106091   0.03415183  0.16769587]
Stock Position:  -0.010609100906087736
Bond Position:  [-2.84603208]


portfolio before change:  [-3.8080312]
curr_Stock_Price:  90.6097062899619
curr_Factors:  [90.60970629 -0.34121577 -1.06660144]
mat_Sqrt:  [[22.17009093  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00025558 -0.02845143  0.0120735 ]
Stock Position:  -0.0002555827986706918
Bond Position:  [-3.78487291]


portfolio before change:  [-3.8091436]
curr_Stock_Price:  91.25945988764595
curr_Factors:  [91.25945989 -0.5125792  -1.06804185]
mat_Sqrt:  [[18.78550582  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02057178  0.01354083 -0.05187141]
Stock Position:  0.020571777155264682
Bond Position:  [-5.68651287]


portfolio before change:  [-3.7835885]
curr_Stock_Price:  92.57081479873986
curr_Factors:  [92.5708148  -0.70053923 -1.12585911]
mat_Sqrt:  [[14.90319435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02288275 -0.00971964  1.77283472]
Stock Position:  -0.02288274884625884
Bond Position:  [-1.6653138]


portfolio before change:  [-3.78155895]
curr_Stock_Price:  92.46392483776684
curr_Factors:  [92.46392484 -0.95991089 -1.10082648]
mat_Sqrt:  [[11.77620764  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0102289   0.02947209 -0.0906077 ]
Stock Position:  -0.010228903737148451
Bond Position:  [-2.83575436]


portfolio before change:  [-3.78742109]
curr_Stock_Price:  92.96770490457106
curr_Factors:  [92.9677049  -1.02421713 -1.09747903]
mat_Sqrt:  [[11.14015349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00751783 -0.00347532  0.03733083]
Stock Position:  -0.007517827069827114
Bond Position:  [-3.08850596]


portfolio before change:  [-3.78066217]
curr_Stock_Price:  91.96593353507117
curr_Factors:  [91.96593354 -1.21139831 -1.07156957]
mat_Sqrt:  [[ 9.37878603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01245243  0.00826638 -0.58399414]
Stock Position:  0.012452432544962406
Bond Position:  [-4.92586176]


portfolio before change:  [-3.77648575]
curr_Stock_Price:  92.40022926240866
curr_Factors:  [92.40022926 -0.95324103 -1.10076311]
mat_Sqrt:  [[11.8476001   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00051146 0.01807565 0.04918567]
Stock Position:  0.0005114617151725257
Bond Position:  [-3.82374493]


portfolio before change:  [-3.77741935]
curr_Stock_Price:  92.4441382769882
curr_Factors:  [92.44413828 -1.24947496 -1.08773779]
mat_Sqrt:  [[ 8.9297804   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02532726 -0.13268513  0.34649825]
Stock Position:  0.025327256157426075
Bond Position:  [-6.11877572]


portfolio before change:  [-3.76624009]
curr_Stock_Price:  92.94593553430067
curr_Factors:  [92.94593553 -0.99699158 -1.11870074]
mat_Sqrt:  [[11.20461413  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00012205  0.01580856 -0.10240912]
Stock Position:  -0.00012204538300334512
Bond Position:  [-3.75489647]


portfolio before change:  [-3.76741579]
curr_Stock_Price:  94.8866995722202
curr_Factors:  [94.88669957 -1.10007836 -1.11499293]
mat_Sqrt:  [[10.35647843  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0044656  0.06245503 0.92200076]
Stock Position:  0.00446559883768813
Bond Position:  [-4.19114173]


portfolio before change:  [-3.77102263]
curr_Stock_Price:  94.31366904196457
curr_Factors:  [94.31366904 -1.0817614  -1.10535073]
mat_Sqrt:  [[10.58580549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.51597980e-05 -1.05104793e-02 -1.55011816e-01]
Stock Position:  -1.5159797963162464e-05
Bond Position:  [-3.76959286]


portfolio before change:  [-3.77197503]
curr_Stock_Price:  94.96578764816205
curr_Factors:  [94.96578765 -0.63756807 -1.17520758]
mat_Sqrt:  [[15.49846591  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00391    0.01391912 0.38945868]
Stock Position:  0.00390999817137416
Bond Position:  [-4.14329109]


portfolio before change:  [-3.77632712]
curr_Stock_Price:  94.11767026175472
curr_Factors:  [94.11767026 -0.68838624 -1.14938491]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.77632712]
Stock Price:  94.97872264703932
PL:  [-3.77632712]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.51299212e-01 -2.76273357e-02  7.41150012e-02]
 [ 4.85246124e-02  4.97978724e-02  6.89653506e-02]
 [-1.51714448e-02 -1.85066419e-01  3.22086196e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.67902995e-01 -3.10349195e-01 -2.79082661e-01]
 [-9.86247766e-02 -1.08123002e-01 -1.48860386e-01]
 [-1.56387321e-03 -8.55189689e-02  3.52349679e-03]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [-2.27586495e-02 -1.67676860e-03 -1.13964840e-01]
 [-4.44227670e-01  4.28289010e-01  3.97364655e-02]
 [ 1.00486191e-01 -1.41406879e-01 -1.96539698e-03]
 [ 4.05047964e-02  9.12456201e-02  3.67436868e-02]
 [-1.55009095e-02  1.71444798e-01  4.55324509e-02]
 [-9.84458182e-03 -1.55193670e-01 -7.36947994e-02]
 [-1.30565966e-01 -9.21203805e-02  1.92411652e-01]
 [ 1.36583796e-02  9.21587036e-02  1.26082268e-01]
 [-9.06658292e-02  8.72574122e-02  4.10689031e-02]
 [-4.36646263e-02 -4.94721214e-02  2.99213211e-02]
 [-3.63320932e-02  4.50557035e-01  1.70635930e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.4390598]
curr_Stock_Price:  100.57989159515365
curr_Factors:  [100.5798916   -0.88288457  -1.0587234 ]
mat_Sqrt:  [[14.43050522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01641549 -0.00873653  0.21142947]
Stock Position:  -0.016415494976295082
Bond Position:  [8.0901285]


portfolio before change:  [6.42704119]
curr_Stock_Price:  101.43526558020142
curr_Factors:  [101.43526558  -1.35188077  -1.09500971]
mat_Sqrt:  [[ 8.78047346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00727613 0.01574747 0.19673895]
Stock Position:  0.007276131686425362
Bond Position:  [5.68898484]


portfolio before change:  [6.44193639]
curr_Stock_Price:  103.28690486796046
curr_Factors:  [103.28690487  -1.38318089  -1.1172241 ]
mat_Sqrt:  [[ 8.47487257  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00157823 -0.05852314  0.09188223]
Stock Position:  -0.0015782281264165071
Bond Position:  [6.60494669]


portfolio before change:  [6.44184658]
curr_Stock_Price:  104.39019916525876
curr_Factors:  [104.39019917  -1.37338019  -1.10364151]
mat_Sqrt:  [[ 8.76804702  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0043275  -0.00455813 -0.02970002]
Stock Position:  -0.004327503843442541
Bond Position:  [6.89359557]


portfolio before change:  [6.44538278]
curr_Stock_Price:  103.97134829771237
curr_Factors:  [103.9713483   -1.6165864   -1.10214908]
mat_Sqrt:  [[ 6.85775333  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04417224 -0.09814103 -0.79614515]
Stock Position:  0.04417223675063545
Bond Position:  [1.85273576]


portfolio before change:  [6.46325204]
curr_Stock_Price:  104.36539714062411
curr_Factors:  [104.36539714  -1.7456353   -1.1054952 ]
mat_Sqrt:  [[ 6.03012462  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02185734 -0.0341915  -0.42465725]
Stock Position:  -0.021857342550291863
Bond Position:  [8.74440227]


portfolio before change:  [6.4654454]
curr_Stock_Price:  104.36507737397777
curr_Factors:  [104.36507737  -1.79633967  -1.12893671]
mat_Sqrt:  [[ 5.599172    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054521 -0.02704347  0.01005156]
Stock Position:  -0.0005452114564001052
Bond Position:  [6.52234643]


portfolio before change:  [6.46742368]
curr_Stock_Price:  103.72772004562322
curr_Factors:  [103.72772005  -1.82241935  -1.10166382]
mat_Sqrt:  [[ 5.57162206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02505291 -0.01496598 -0.14840805]
Stock Position:  -0.02505290785640219
Bond Position:  [9.0661047]


portfolio before change:  [6.49336623]
curr_Stock_Price:  102.78269075268875
curr_Factors:  [102.78269075  -1.55836099  -1.12864887]
mat_Sqrt:  [[ 6.99787898  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0065827  -0.00053024 -0.32510997]
Stock Position:  -0.006582697308400891
Bond Position:  [7.16995357]


portfolio before change:  [6.49434381]
curr_Stock_Price:  102.90651911547782
curr_Factors:  [102.90651912  -1.53563518  -1.13232152]
mat_Sqrt:  [[ 7.14108188  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05952293  0.13543688  0.11335708]
Stock Position:  -0.05952293088594453
Bond Position:  [12.61964144]


portfolio before change:  [6.55861517]
curr_Stock_Price:  101.87975421161829
curr_Factors:  [101.87975421  -0.8825815   -1.13279485]
mat_Sqrt:  [[13.57753903  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00710246 -0.04471678 -0.00560673]
Stock Position:  0.0071024576961041
Bond Position:  [5.83501853]


portfolio before change:  [6.5481205]
curr_Stock_Price:  100.1967295044507
curr_Factors:  [100.1967295   -0.91316962  -1.12564002]
mat_Sqrt:  [[13.04396936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00386087 0.0288544  0.10481951]
Stock Position:  0.003860866304498046
Bond Position:  [6.16127432]


portfolio before change:  [6.54825537]
curr_Stock_Price:  99.83265638885429
curr_Factors:  [99.83265639 -0.60400353 -1.11902735]
mat_Sqrt:  [[17.82254932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.98707446e-05  5.42156056e-02  1.29891409e-01]
Stock Position:  -9.987074457425389e-05
Bond Position:  [6.55822573]


portfolio before change:  [6.55004809]
curr_Stock_Price:  98.30112619542308
curr_Factors:  [98.3011262  -0.94053483 -1.16762939]
mat_Sqrt:  [[11.93972718  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242003 -0.04907655 -0.21023075]
Stock Position:  -0.002420034615633268
Bond Position:  [6.78794022]


portfolio before change:  [6.55164529]
curr_Stock_Price:  98.34244602224176
curr_Factors:  [98.34244602 -0.97202294 -1.15223821]
mat_Sqrt:  [[11.75401145  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00796908 -0.02913102  0.54889689]
Stock Position:  -0.007969078482865226
Bond Position:  [7.33534396]


portfolio before change:  [6.55133702]
curr_Stock_Price:  98.61127763323917
curr_Factors:  [98.61127763 -0.62100174 -1.15570846]
mat_Sqrt:  [[16.68442136  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00250379 0.02914314 0.35967762]
Stock Position:  0.002503793300087041
Bond Position:  [6.30443476]


portfolio before change:  [6.55249895]
curr_Stock_Price:  98.44577832239285
curr_Factors:  [98.44577832 -0.53126889 -1.15141328]
mat_Sqrt:  [[18.29858534  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00437355  0.02759322  0.11715815]
Stock Position:  -0.004373545621371268
Bond Position:  [6.98305605]


portfolio before change:  [6.55485129]
curr_Stock_Price:  98.30713494514178
curr_Factors:  [98.30713495 -1.03810519 -1.14904414]
mat_Sqrt:  [[11.03362335  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00351964 -0.01564446  0.0853572 ]
Stock Position:  -0.003519635001871681
Bond Position:  [6.90085652]


portfolio before change:  [6.55900801]
curr_Stock_Price:  97.61635703413883
curr_Factors:  [97.61635703 -0.95901851 -1.20077498]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.55900801]
Stock Price:  96.54266450718696
PL:  [6.55900801]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.93095667e-01 -3.16953918e-02  9.35551658e-02]
 [-1.44938687e-05  6.98537604e-02  3.80533868e-02]
 [ 2.59275183e-02 -1.02657170e-02  4.20496426e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 4.43330950e-01 -3.70271579e-01 -3.28737818e-01]
 [ 1.35931096e-01 -1.34632488e-01 -8.62697990e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 2.88879623e-01  1.86940207e-02  7.46012700e-03]
 [-1.59010824e-01  7.96413404e-03  1.96836560e-01]
 [-2.03503680e-02  4.24955330e-02 -4.89626242e-02]
 [ 4.21091018e-02 -1.07049180e-01  8.15424497e-04]
 [ 6.35155584e-02  9.84609626e-02  1.47300439e-02]
 [-1.28927863e-02  1.78847145e-01  5.14621668e-02]
 [-3.69402220e-02 -6.67016915e-02 -6.32264267e-02]
 [-1.14949826e-01 -8.05162135e-02  1.72730327e-01]
 [ 3.34169226e-03  1.14983730e-01  1.69065116e-01]
 [-8.82585357e-02  9.15893345e-02  3.86779224e-02]
 [ 5.06961805e-02  4.40232129e-02  1.43444894e-01]
 [-2.39667517e-02  5.61543556e-01  2.31895335e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.68080697]
curr_Stock_Price:  100.05637137956339
curr_Factors:  [100.05637138  -0.95692391  -0.99863285]
mat_Sqrt:  [[14.15654382  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01941273 -0.01002296  0.26688685]
Stock Position:  -0.01941273054026068
Bond Position:  [4.62317435]


portfolio before change:  [2.67801914]
curr_Stock_Price:  100.25952508755019
curr_Factors:  [100.25952509  -0.82996412  -1.00159701]
mat_Sqrt:  [[16.05790008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00059514 0.0220897  0.10855572]
Stock Position:  0.0005951424201233863
Bond Position:  [2.61835044]


portfolio before change:  [2.67893845]
curr_Stock_Price:  100.70419713454723
curr_Factors:  [100.70419713  -0.51059791  -1.06167732]
mat_Sqrt:  [[20.90340894  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00163829 -0.0032463   0.11995593]
Stock Position:  0.0016382880952997849
Bond Position:  [2.51395597]


portfolio before change:  [2.68243025]
curr_Stock_Price:  102.45189258165101
curr_Factors:  [102.45189258  -0.49354141  -1.08585442]
mat_Sqrt:  [[21.11529208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00179698 -0.00455813 -0.02970002]
Stock Position:  -0.0017969799829168937
Bond Position:  [2.86653425]


portfolio before change:  [2.67635564]
curr_Stock_Price:  106.23119489929888
curr_Factors:  [106.2311949   -0.37673888  -1.08360901]
mat_Sqrt:  [[24.66215582  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01486761 -0.11709015 -0.93779749]
Stock Position:  0.014867607515234523
Bond Position:  [1.09695193]


portfolio before change:  [2.62707976]
curr_Stock_Price:  102.89843609484433
curr_Factors:  [102.89843609  -0.36178034  -1.06655228]
mat_Sqrt:  [[24.66560667  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00465608 -0.04257453 -0.24610372]
Stock Position:  0.0046560846046378645
Bond Position:  [2.14797594]


portfolio before change:  [2.60681993]
curr_Stock_Price:  98.43183077580166
curr_Factors:  [98.43183078 -0.50367146 -1.06322524]
mat_Sqrt:  [[20.54191715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027584 -0.02845143  0.0120735 ]
Stock Position:  -0.0002758405578796264
Bond Position:  [2.63397142]


portfolio before change:  [2.60767026]
curr_Stock_Price:  97.73667353166178
curr_Factors:  [97.73667353 -0.99627178 -1.08025185]
mat_Sqrt:  [[12.25278458  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02374033 0.00591157 0.02128167]
Stock Position:  0.023740325356928885
Bond Position:  [0.28736983]


portfolio before change:  [2.60020129]
curr_Stock_Price:  97.4190359866551
curr_Factors:  [97.41903599 -0.50537858 -1.06585665]
mat_Sqrt:  [[20.24254132  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00586024  0.00251848  0.56151992]
Stock Position:  -0.005860237341234213
Bond Position:  [3.17109997]


portfolio before change:  [2.60214148]
curr_Stock_Price:  97.22325670849636
curr_Factors:  [97.22325671 -0.55660088 -1.03559706]
mat_Sqrt:  [[19.78278281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00147844  0.01343827 -0.13967674]
Stock Position:  -0.0014784366873583853
Bond Position:  [2.74587991]


portfolio before change:  [2.6010463]
curr_Stock_Price:  98.42840669181756
curr_Factors:  [98.42840669 -0.40911777 -1.04260225]
mat_Sqrt:  [[23.04870148  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00171426 -0.03385192  0.00232618]
Stock Position:  0.0017142636739276452
Bond Position:  [2.43231406]


portfolio before change:  [2.60344619]
curr_Stock_Price:  99.47359733638181
curr_Factors:  [99.47359734 -0.37241374 -1.06544552]
mat_Sqrt:  [[23.61856373  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00292416 0.03113609 0.04202072]
Stock Position:  0.002924164567342988
Bond Position:  [2.31256902]


portfolio before change:  [2.60412304]
curr_Stock_Price:  99.50733147690622
curr_Factors:  [99.50733148 -0.36228094 -1.04099738]
mat_Sqrt:  [[24.45789349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [9.11647570e-05 5.65564330e-02 1.46807238e-01]
Stock Position:  9.116475697871983e-05
Bond Position:  [2.59505148]


portfolio before change:  [2.60462328]
curr_Stock_Price:  97.87726566354756
curr_Factors:  [97.87726566 -0.37938603 -1.0307096 ]
mat_Sqrt:  [[23.89379199  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215824 -0.02109293 -0.1803674 ]
Stock Position:  -0.0021582381157561775
Bond Position:  [2.81586573]


portfolio before change:  [2.6090065]
curr_Stock_Price:  96.17255853831828
curr_Factors:  [96.17255854 -0.47692948 -1.03225071]
mat_Sqrt:  [[21.26290208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00384568 -0.02546146  0.49275155]
Stock Position:  -0.0038456799076928808
Bond Position:  [2.97885538]


portfolio before change:  [2.60579959]
curr_Stock_Price:  97.2001321464448
curr_Factors:  [97.20013215 -0.28548569 -1.00747906]
mat_Sqrt:  [[26.67714793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00153018 0.03636105 0.48229572]
Stock Position:  0.0015301797547464964
Bond Position:  [2.45706592]


portfolio before change:  [2.60587438]
curr_Stock_Price:  96.84752386130774
curr_Factors:  [ 9.68475239e+01  8.12246198e-02 -1.02373091e+00]
mat_Sqrt:  [[37.73664118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00206692  0.02896309  0.11033735]
Stock Position:  -0.0020669198139568147
Bond Position:  [2.80605045]


portfolio before change:  [2.61303518]
curr_Stock_Price:  93.72248530209765
curr_Factors:  [93.7224853   0.24568577 -0.99540231]
mat_Sqrt:  [[44.28391825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00183167 0.01392136 0.40920836]
Stock Position:  0.0018316676711780994
Bond Position:  [2.44136674]


portfolio before change:  [2.61210649]
curr_Stock_Price:  92.88220444681879
curr_Factors:  [92.88220445  0.32726197 -0.99250757]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.61210649]
Stock Price:  89.87171639461796
PL:  [2.61210649]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.67797724e-01 -5.61899258e-02  1.54484159e-01]
 [-1.09065386e-01  1.41526709e-01  8.53539069e-02]
 [-6.62841782e-02 -2.67657535e-01  1.44544177e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 6.80673846e-01 -4.17269513e-01 -1.87089801e-01]
 [ 7.32247305e-02  1.27045875e-02 -4.50277269e-03]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 1.46234732e-01 -6.68068804e-03  2.40920039e-03]
 [-1.28841927e-03  3.22582955e-02 -4.32790400e-02]
 [-2.40625299e-01  2.29926300e-01  3.16950872e-02]
 [ 9.65496799e-02 -1.39147211e-01 -1.33024301e-03]
 [-1.49130326e-02  5.67474149e-02  3.84077294e-02]
 [-1.03598304e-01  1.52230961e-01 -6.52430788e-02]
 [-1.68371617e-01 -7.62620684e-02  3.04969279e-01]
 [-1.21893923e-01 -1.06358423e-01  2.39138685e-01]
 [-4.80607073e-02  3.77550366e-04 -1.02405411e-01]
 [-8.98247673e-02  5.68634815e-02  7.89417230e-02]
 [-3.68781649e-02 -1.65391124e-02  2.11072011e-02]
 [ 5.47567843e-03  6.67434712e-01  4.48177452e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.32050932]
curr_Stock_Price:  99.49899270722764
curr_Factors:  [99.49899271 -1.13637623 -0.97982989]
mat_Sqrt:  [[11.98842258  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01982868 -0.01776881  0.44070031]
Stock Position:  -0.019828679940662938
Bond Position:  [0.65242436]


portfolio before change:  [-1.31954393]
curr_Stock_Price:  99.45853263117263
curr_Factors:  [99.45853263 -0.99951401 -0.99172625]
mat_Sqrt:  [[13.57867498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0064799   0.04475468  0.24349094]
Stock Position:  -0.006479895018436382
Bond Position:  [-0.67506308]


portfolio before change:  [-1.31830352]
curr_Stock_Price:  99.2410605123254
curr_Factors:  [99.24106051 -0.70276447 -0.93994841]
mat_Sqrt:  [[19.19863077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365883 -0.08464074  0.04123443]
Stock Position:  -0.003658832302221321
Bond Position:  [-0.95519712]


portfolio before change:  [-1.3204542]
curr_Stock_Price:  99.76359234190215
curr_Factors:  [99.76359234 -1.32032217 -0.96765376]
mat_Sqrt:  [[10.12317539  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00374821 -0.00455813 -0.02970002]
Stock Position:  -0.0037482070336373585
Bond Position:  [-0.94651961]


portfolio before change:  [-1.32003503]
curr_Stock_Price:  99.58861936653575
curr_Factors:  [99.58861937 -1.06188309 -0.96254909]
mat_Sqrt:  [[13.15255083  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0480295  -0.13195221 -0.53371513]
Stock Position:  0.0480295005809109
Bond Position:  [-6.10322668]


portfolio before change:  [-1.29994845]
curr_Stock_Price:  100.0386048736933
curr_Factors:  [100.03860487  -0.73113006  -0.93099708]
mat_Sqrt:  [[18.98082047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00382669  0.00401754 -0.01284516]
Stock Position:  0.003826685838142689
Bond Position:  [-1.68276476]


portfolio before change:  [-1.30424662]
curr_Stock_Price:  99.02534470149804
curr_Factors:  [99.0253447  -1.07910557 -0.91960179]
mat_Sqrt:  [[13.4189578   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042226 -0.02845143  0.0120735 ]
Stock Position:  -0.0004222603551307525
Bond Position:  [-1.26243214]


portfolio before change:  [-1.30449197]
curr_Stock_Price:  98.8588654973705
curr_Factors:  [98.8588655  -0.88986105 -0.89044423]
mat_Sqrt:  [[16.66628724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00879344 -0.00211262  0.00687278]
Stock Position:  0.008793440991433445
Bond Position:  [-2.17380157]


portfolio before change:  [-1.28488696]
curr_Stock_Price:  101.15017892508324
curr_Factors:  [101.15017893  -0.91318211  -0.90002066]
mat_Sqrt:  [[16.50071254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056299  0.01020097 -0.12346305]
Stock Position:  -0.0005629945178632063
Bond Position:  [-1.22793996]


portfolio before change:  [-1.28490327]
curr_Stock_Price:  100.63381842449255
curr_Factors:  [100.63381842  -1.01426927  -0.90954967]
mat_Sqrt:  [[14.69738267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01552786  0.07270908  0.09041726]
Stock Position:  -0.015527859598810936
Bond Position:  [0.27772453]


portfolio before change:  [-1.28562301]
curr_Stock_Price:  100.68464163404855
curr_Factors:  [100.68464163  -0.52978762  -0.94077982]
mat_Sqrt:  [[23.13683257  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00400597 -0.04400221 -0.00379481]
Stock Position:  0.0040059666517096165
Bond Position:  [-1.68896233]


portfolio before change:  [-1.28090209]
curr_Stock_Price:  101.9685286679822
curr_Factors:  [101.96852867  -0.32164601  -0.96252312]
mat_Sqrt:  [[28.2331012   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00019863  0.01794511  0.10956656]
Stock Position:  -0.0001986276911429153
Bond Position:  [-1.26064832]


portfolio before change:  [-1.28203059]
curr_Stock_Price:  106.06310090181246
curr_Factors:  [106.0631009   -0.45315019  -1.00088415]
mat_Sqrt:  [[24.77908287  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00455971  0.04813966 -0.18612034]
Stock Position:  -0.004559708918081162
Bond Position:  [-0.79841372]


portfolio before change:  [-1.28989197]
curr_Stock_Price:  107.74341663906822
curr_Factors:  [107.74341664  -0.36755815  -1.00734962]
mat_Sqrt:  [[27.24431449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0039674  -0.02411618  0.86999247]
Stock Position:  -0.003967400303583545
Bond Position:  [-0.86243071]


portfolio before change:  [-1.28263229]
curr_Stock_Price:  105.85923237983859
curr_Factors:  [105.85923238  -0.40124502  -0.98592259]
mat_Sqrt:  [[26.44170782  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286767 -0.03363349  0.68219611]
Stock Position:  -0.002867670517815488
Bond Position:  [-0.97906289]


portfolio before change:  [-1.28796454]
curr_Stock_Price:  107.63330372788391
curr_Factors:  [ 1.07633304e+02  5.22461389e-02 -9.69137163e-01]
mat_Sqrt:  [[43.02748467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.60256581e-03  1.19391909e-04 -2.92134134e-01]
Stock Position:  -0.0016025658143981566
Bond Position:  [-1.11547509]


portfolio before change:  [-1.28755278]
curr_Stock_Price:  107.20232733227374
curr_Factors:  [107.20232733  -0.12411509  -0.94797102]
mat_Sqrt:  [[36.69468223  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196875  0.01798181  0.22519876]
Stock Position:  -0.001968749758417196
Bond Position:  [-1.07649822]


portfolio before change:  [-1.28338946]
curr_Stock_Price:  104.95091199215724
curr_Factors:  [104.95091199   0.25551607  -1.00850008]
mat_Sqrt:  [[49.42758775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066758 -0.00523013  0.06021297]
Stock Position:  -0.0006675768554536599
Bond Position:  [-1.21332666]


portfolio before change:  [-1.28299844]
curr_Stock_Price:  103.91074036089142
curr_Factors:  [103.91074036   0.39867682  -0.98897497]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.28299844]
Stock Price:  109.2748993869968
PL:  [-10.55789782]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-9.12095083e-02 -6.53919227e-02  1.43515545e-01]
 [-5.28764462e-01  3.63764519e-01  3.22398795e-02]
 [-1.65121835e-01 -4.46106941e-01 -5.74425314e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [-1.13036435e-01  4.85110531e-02 -6.01420543e-02]
 [-2.19915804e-01  1.00294245e-01  5.06901421e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 1.40444245e-01 -6.74516689e-03 -2.26582500e-03]
 [-8.81331134e-02  2.16946062e-02  7.46646849e-02]
 [ 1.33901857e-02  5.40825642e-02 -2.71524754e-02]
 [-6.13166226e-02 -2.80975214e-02  1.54430801e-03]
 [ 1.31610618e-01  5.82180333e-02 -1.24908834e-01]
 [ 3.55058389e-02  1.19889586e-01  8.43655981e-02]
 [ 1.64201327e-01 -2.34477503e-01  1.14384721e-01]
 [ 5.33951352e-02  4.63977644e-02  9.24198091e-03]
 [-3.81546159e-02  2.33002316e-01  3.49877322e-01]
 [-2.71317740e-02  9.48832443e-02  1.33888710e-02]
 [-4.83122956e-02 -5.57420676e-02  2.56722446e-02]
 [-3.20760779e-02  4.87515152e-01  2.09720185e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.69706945]
curr_Stock_Price:  98.75004418123946
curr_Factors:  [98.75004418 -1.02842538 -1.01069392]
mat_Sqrt:  [[12.85165447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00494901 -0.02067874  0.4094099 ]
Stock Position:  -0.004949007362328164
Bond Position:  [-6.20835475]


portfolio before change:  [-6.69246808]
curr_Stock_Price:  97.50663274885149
curr_Factors:  [97.50663275 -0.73729035 -1.02032787]
mat_Sqrt:  [[16.81551856  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03049511  0.11503244  0.0919714 ]
Stock Position:  -0.030495114577098043
Bond Position:  [-3.71899214]


portfolio before change:  [-6.70620241]
curr_Stock_Price:  97.9265186546631
curr_Factors:  [97.92651865 -0.56265511 -1.01376829]
mat_Sqrt:  [[20.24269492  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00930537 -0.1410714  -0.16386755]
Stock Position:  -0.009305365466683852
Bond Position:  [-5.79496036]


portfolio before change:  [-6.70820167]
curr_Stock_Price:  97.98566077351171
curr_Factors:  [97.98566077 -0.40397174 -0.98940157]
mat_Sqrt:  [[24.3236186   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155996 -0.00455813 -0.02970002]
Stock Position:  -0.0015599552769873808
Bond Position:  [-6.55534842]


portfolio before change:  [-6.70731875]
curr_Stock_Price:  96.36897285650056
curr_Factors:  [96.36897286 -0.14624337 -0.94749572]
mat_Sqrt:  [[32.27991484  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00384327  0.01534054 -0.17156854]
Stock Position:  -0.0038432669769070684
Bond Position:  [-6.33694706]


portfolio before change:  [-6.69968734]
curr_Stock_Price:  93.97105202853874
curr_Factors:  [93.97105203 -0.5478157  -0.92711833]
mat_Sqrt:  [[21.49999601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00962694  0.03171582  0.14460487]
Stock Position:  -0.00962693833678746
Bond Position:  [-5.79503381]


portfolio before change:  [-6.73277496]
curr_Stock_Price:  97.2575258642599
curr_Factors:  [97.25752586 -0.48003591 -0.93361265]
mat_Sqrt:  [[23.65829534  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00023951 -0.02845143  0.0120735 ]
Stock Position:  -0.0002395055858977405
Bond Position:  [-6.70948124]


portfolio before change:  [-6.73474887]
curr_Stock_Price:  98.49478938214892
curr_Factors:  [98.49478938 -0.66336255 -0.93862784]
mat_Sqrt:  [[19.84621383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00704455 -0.00213301 -0.00646377]
Stock Position:  0.007044546486278101
Bond Position:  [-7.42859999]


portfolio before change:  [-6.73524812]
curr_Stock_Price:  98.6875815277428
curr_Factors:  [98.68758153 -0.52049006 -0.91881844]
mat_Sqrt:  [[23.39800167  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309138  0.00686044  0.21299756]
Stock Position:  -0.0030913792161265546
Bond Position:  [-6.43016738]


portfolio before change:  [-6.72840761]
curr_Stock_Price:  95.95473885424504
curr_Factors:  [95.95473885 -0.58422404 -0.9106542 ]
mat_Sqrt:  [[21.52033649  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00042955  0.01710241 -0.07745845]
Stock Position:  0.0004295525596868807
Bond Position:  [-6.76962521]


portfolio before change:  [-6.73113159]
curr_Stock_Price:  93.55371508574866
curr_Factors:  [93.55371509 -0.82573009 -0.91166565]
mat_Sqrt:  [[16.46340474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00374934 -0.00888522  0.00440548]
Stock Position:  -0.0037493378748249045
Bond Position:  [-6.3803671]


portfolio before change:  [-6.73612775]
curr_Stock_Price:  94.46077471877517
curr_Factors:  [94.46077472 -0.94136737 -0.93195932]
mat_Sqrt:  [[14.51028883  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00741659  0.01841016 -0.35633014]
Stock Position:  0.007416591975112794
Bond Position:  [-7.43670478]


portfolio before change:  [-6.73142341]
curr_Stock_Price:  95.34578420165128
curr_Factors:  [95.3457842  -1.21182019 -0.89897677]
mat_Sqrt:  [[11.55032018  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00483298 0.03791242 0.24067157]
Stock Position:  0.004832976865034078
Bond Position:  [-7.19222738]


portfolio before change:  [-6.73110166]
curr_Stock_Price:  95.78444389617297
curr_Factors:  [95.7844439  -1.44555634 -0.82069425]
mat_Sqrt:  [[ 9.93287242  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01827224 -0.0741483   0.32630777]
Stock Position:  0.01827223988699703
Bond Position:  [-8.48129799]


portfolio before change:  [-6.72906752]
curr_Stock_Price:  96.01182338358441
curr_Factors:  [96.01182338 -1.69213373 -0.8362102 ]
mat_Sqrt:  [[ 7.66088424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00737247 0.01467226 0.0263648 ]
Stock Position:  0.0073724690323093214
Bond Position:  [-7.43691171]


portfolio before change:  [-6.72961285]
curr_Stock_Price:  96.19007149785
curr_Factors:  [96.1900715  -1.19354513 -0.82991797]
mat_Sqrt:  [[12.71602553  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00308901 0.0736818  0.99810261]
Stock Position:  0.0030890066417936833
Bond Position:  [-7.02674462]


portfolio before change:  [-6.72314183]
curr_Stock_Price:  98.85368515893437
curr_Factors:  [98.85368516 -1.27465704 -0.81125022]
mat_Sqrt:  [[12.27707339  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0017878   0.03000472  0.03819472]
Stock Position:  -0.0017877963776393258
Bond Position:  [-6.54641157]


portfolio before change:  [-6.72488206]
curr_Stock_Price:  98.91153288515156
curr_Factors:  [98.91153289 -1.19901702 -0.76439221]
mat_Sqrt:  [[13.88510405  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00320568 -0.01762719  0.07323577]
Stock Position:  -0.003205681746685818
Bond Position:  [-6.40780316]


portfolio before change:  [-6.72333736]
curr_Stock_Price:  97.92988596563896
curr_Factors:  [97.92988597 -1.02819358 -0.72856016]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.72333736]
Stock Price:  99.98456087555205
PL:  [-6.72333736]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.70937562e-01 -5.20145362e-02  1.43860478e-01]
 [-1.63505925e-01  1.58259874e-01  2.54110802e-02]
 [-2.82568749e-02 -2.04007160e-01  4.15344060e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 5.61282428e-01 -3.55244666e-01 -1.77459529e-01]
 [ 7.24114886e-02 -9.75372175e-03 -3.23998451e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [ 2.57834662e-03  2.15048751e-02 -8.86321666e-02]
 [-3.08677267e-01  2.95516015e-01  3.96719071e-02]
 [ 7.19812037e-02 -1.24931619e-01  1.75203930e-03]
 [-5.36459370e-02  3.36337676e-02  1.27342229e-02]
 [-1.38224578e-02  1.58339673e-01  4.24185136e-02]
 [-4.90843519e-02 -1.11581989e-01 -4.02120064e-02]
 [-1.50612638e-01 -1.10410974e-01  2.27138902e-01]
 [ 3.07277726e-02  6.25073547e-02  7.86035882e-02]
 [-1.33677705e-01  1.17449997e-02  8.14996153e-02]
 [-4.75257696e-02 -4.79904202e-02  2.21653888e-02]
 [-2.08217055e-02  5.75368962e-01  2.99915037e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.00558641]
curr_Stock_Price:  99.54286110056061
curr_Factors:  [99.5428611  -1.07172185 -0.97176467]
mat_Sqrt:  [[12.89838092  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.018833   -0.01644844  0.4103939 ]
Stock Position:  -0.01883299743388668
Bond Position:  [0.86910404]


portfolio before change:  [-1.00124854]
curr_Stock_Price:  99.32406614120994
curr_Factors:  [99.32406614 -0.7991176  -0.93474208]
mat_Sqrt:  [[17.54077589  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00879281  0.05004617  0.07249074]
Stock Position:  -0.00879280701468125
Bond Position:  [-0.12791119]


portfolio before change:  [-1.00714812]
curr_Stock_Price:  99.99138367277759
curr_Factors:  [99.99138367 -0.7947229  -0.97373879]
mat_Sqrt:  [[17.05805154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146829 -0.06451273  0.1184861 ]
Stock Position:  -0.001468288562866777
Bond Position:  [-0.86033191]


portfolio before change:  [-1.00853936]
curr_Stock_Price:  100.79240883514984
curr_Factors:  [100.79240884  -0.84289475  -1.00460367]
mat_Sqrt:  [[15.88800824  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0023882  -0.00455813 -0.02970002]
Stock Position:  -0.0023882010019498287
Bond Position:  [-0.76782683]


portfolio before change:  [-1.00546203]
curr_Stock_Price:  99.4234671030566
curr_Factors:  [99.4234671  -0.91721355 -0.95540118]
mat_Sqrt:  [[15.2834944   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03375447 -0.11233823 -0.50624264]
Stock Position:  0.03375447143344633
Bond Position:  [-4.36144862]


portfolio before change:  [-0.95767626]
curr_Stock_Price:  100.87146103941522
curr_Factors:  [100.87146104  -0.59280708  -0.94731077]
mat_Sqrt:  [[21.62238652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0030314  -0.0030844  -0.09242774]
Stock Position:  0.00303139793582654
Bond Position:  [-1.2634578]


portfolio before change:  [-0.95954969]
curr_Stock_Price:  100.35766307444085
curr_Factors:  [100.35766307  -0.5968235   -0.93045543]
mat_Sqrt:  [[21.79022575  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00026004 -0.02845143  0.0120735 ]
Stock Position:  -0.0002600383287697923
Bond Position:  [-0.93345285]


portfolio before change:  [-0.96056693]
curr_Stock_Price:  103.37200358750505
curr_Factors:  [103.37200359  -0.76754697  -0.92973775]
mat_Sqrt:  [[18.93570788  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00737154 -0.01496598 -0.14840805]
Stock Position:  -0.007371540320302244
Bond Position:  [-0.19855604]


portfolio before change:  [-0.95012642]
curr_Stock_Price:  101.94894167906777
curr_Factors:  [101.94894168  -1.06087518  -0.93542561]
mat_Sqrt:  [[13.84842247  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108015  0.00680044 -0.2528429 ]
Stock Position:  -0.0010801493935763717
Bond Position:  [-0.84000633]


portfolio before change:  [-0.94923452]
curr_Stock_Price:  100.92878506522575
curr_Factors:  [100.92878507  -1.39342173  -0.95136413]
mat_Sqrt:  [[ 9.67581344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03027643  0.09345037  0.11317291]
Stock Position:  -0.030276429370796405
Bond Position:  [2.10652871]


portfolio before change:  [-0.96754512]
curr_Stock_Price:  101.5509619813048
curr_Factors:  [101.55096198  -1.35832637  -0.97963962]
mat_Sqrt:  [[ 9.80208161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00705086 -0.03950685  0.00499808]
Stock Position:  0.007050861182967109
Bond Position:  [-1.68356686]


portfolio before change:  [-0.96864937]
curr_Stock_Price:  101.45405167977869
curr_Factors:  [101.45405168  -1.54482359  -0.97830085]
mat_Sqrt:  [[ 8.13748829  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0061663   0.01063593  0.03632719]
Stock Position:  -0.00616629513069224
Bond Position:  [-0.34305374]


portfolio before change:  [-0.96697971]
curr_Stock_Price:  101.16937015293513
curr_Factors:  [101.16937015  -1.42288835  -1.03114122]
mat_Sqrt:  [[ 8.69515935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00012369  0.0500714   0.12100821]
Stock Position:  -0.00012368976023778254
Bond Position:  [-0.95446609]


portfolio before change:  [-0.96728509]
curr_Stock_Price:  101.70889988225909
curr_Factors:  [101.70889988  -1.19197661  -1.03901839]
mat_Sqrt:  [[10.92572185  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00550752 -0.03528532 -0.11471366]
Stock Position:  -0.005507519664730327
Bond Position:  [-0.40712132]


portfolio before change:  [-0.96961493]
curr_Stock_Price:  102.11344577680897
curr_Factors:  [102.11344578  -0.90355557  -1.02863157]
mat_Sqrt:  [[14.78920126  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0072417  -0.03491502  0.64796406]
Stock Position:  -0.007241696208375355
Bond Position:  [-0.23014037]


portfolio before change:  [-0.98129405]
curr_Stock_Price:  103.71825991563252
curr_Factors:  [103.71825992  -0.88021279  -1.00749829]
mat_Sqrt:  [[15.70481106  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.003081   0.01976656 0.22423416]
Stock Position:  0.003081004641793654
Bond Position:  [-1.30085049]


portfolio before change:  [-0.98507856]
curr_Stock_Price:  102.59548917005301
curr_Factors:  [102.59548917  -0.8518687   -1.05253853]
mat_Sqrt:  [[15.27758525  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00764116  0.0037141   0.23249572]
Stock Position:  -0.007641155926660162
Bond Position:  [-0.20113043]


portfolio before change:  [-0.97177093]
curr_Stock_Price:  100.84733477004572
curr_Factors:  [100.84733477  -0.40665447  -1.01779784]
mat_Sqrt:  [[24.2679252   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.001823   -0.0151759   0.06323168]
Stock Position:  -0.001822998276973668
Bond Position:  [-0.78792641]


portfolio before change:  [-0.97147346]
curr_Stock_Price:  100.57608943538874
curr_Factors:  [100.57608944  -0.35064163  -0.9996815 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.97147346]
Stock Price:  99.917857772674
PL:  [-0.97147346]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.14255197e-01 -5.05949429e-02  1.48810132e-01]
 [-1.32402255e-01  1.55279183e-01  8.85209478e-02]
 [-1.41855341e-01 -5.37839399e-01 -3.74312883e-02]
 [-3.37648576e-02 -1.16690093e-02 -8.68579607e-03]
 [ 7.73911858e-01 -4.41891580e-01 -1.68771833e-01]
 [-1.22093053e-01  7.66224221e-02  2.91632072e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 3.57022023e-01  2.82114274e-02  2.19290230e-02]
 [-2.20298366e-01  1.32525012e-04  2.81981573e-01]
 [-2.03144679e-02  5.50640695e-02 -3.65260975e-02]
 [ 2.04365942e-02 -9.42241632e-02  1.30182409e-03]
 [ 7.48392134e-02  1.01351830e-01  6.30846265e-03]
 [ 2.06022255e-02  1.60445627e-01  8.36098157e-02]
 [-4.98066530e-02 -1.46140330e-02 -4.89014806e-02]
 [-1.36615465e-01 -9.66156909e-02  2.00035954e-01]
 [-1.63353682e-02  1.79325662e-01  2.80648133e-01]
 [-4.08809476e-02  1.09211614e-01  1.80343230e-02]
 [-4.56579299e-02 -5.22595235e-02  2.81610760e-02]
 [-3.27976397e-02  4.82766202e-01  1.95646695e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.14406729]
curr_Stock_Price:  99.66286970452242
curr_Factors:  [99.6628697  -1.2664519  -0.97359308]
mat_Sqrt:  [[10.60948288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02688027 -0.01599953  0.42451388]
Stock Position:  -0.026880274447922195
Bond Position:  [2.534898]


portfolio before change:  [-0.12770358]
curr_Stock_Price:  99.07768558141744
curr_Factors:  [99.07768558 -1.20874242 -0.95508486]
mat_Sqrt:  [[11.38249852  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0096924   0.04910359  0.25252562]
Stock Position:  -0.00969239758604796
Bond Position:  [0.83259674]


portfolio before change:  [-0.12472177]
curr_Stock_Price:  98.7915201000867
curr_Factors:  [98.7915201  -1.29343485 -0.91723913]
mat_Sqrt:  [[10.83019198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01508588 -0.17007975 -0.10678105]
Stock Position:  -0.0150858751597927
Bond Position:  [1.36563477]


portfolio before change:  [-0.13474987]
curr_Stock_Price:  99.47888853538832
curr_Factors:  [99.47888854 -1.38268867 -0.91423858]
mat_Sqrt:  [[10.00433195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00358236 -0.00369006 -0.02477816]
Stock Position:  -0.0035823612183588133
Bond Position:  [0.22161944]


portfolio before change:  [-0.13011578]
curr_Stock_Price:  98.20076944383955
curr_Factors:  [98.20076944 -1.41674691 -0.9305588 ]
mat_Sqrt:  [[ 9.390592    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07752992 -0.13973839 -0.48145906]
Stock Position:  0.07752992147390228
Bond Position:  [-7.74361372]


portfolio before change:  [-0.18760058]
curr_Stock_Price:  97.48428923385697
curr_Factors:  [97.48428923 -1.12590027 -0.9359336 ]
mat_Sqrt:  [[12.40199506  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00920511  0.02423014  0.08319451]
Stock Position:  -0.009205112168352363
Bond Position:  [0.70975324]


portfolio before change:  [-0.19151945]
curr_Stock_Price:  97.92929583402915
curr_Factors:  [97.92929583 -1.37544338 -0.89458267]
mat_Sqrt:  [[10.11702546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056008 -0.02845143  0.0120735 ]
Stock Position:  -0.0005600750840648087
Bond Position:  [-0.13667169]


portfolio before change:  [-0.19173567]
curr_Stock_Price:  98.25432730166123
curr_Factors:  [98.2543273  -1.57187514 -0.93309104]
mat_Sqrt:  [[ 8.0252524   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04513586 0.00892124 0.0625574 ]
Stock Position:  0.045135861699206054
Bond Position:  [-4.6265294]


portfolio before change:  [-0.26295771]
curr_Stock_Price:  96.70200815023631
curr_Factors:  [96.70200815 -1.07138848 -0.90792133]
mat_Sqrt:  [[13.36079083  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.21800946e-02  4.19080885e-05  8.04414939e-01]
Stock Position:  -0.01218009462902031
Bond Position:  [0.9148819]


portfolio before change:  [-0.26650116]
curr_Stock_Price:  97.01171006396106
curr_Factors:  [97.01171006 -0.78488079 -0.90465536]
mat_Sqrt:  [[17.90885974  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00147126  0.01741279 -0.10419879]
Stock Position:  -0.0014712593976177538
Bond Position:  [-0.12377177]


portfolio before change:  [-0.26820369]
curr_Stock_Price:  98.14786751080815
curr_Factors:  [98.14786751 -0.61421231 -0.88353028]
mat_Sqrt:  [[21.94924186  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00083235 -0.0297963   0.00371374]
Stock Position:  0.0008323508680176282
Bond Position:  [-0.34989715]


portfolio before change:  [-0.26775609]
curr_Stock_Price:  98.79072379527354
curr_Factors:  [98.7907238  -0.67268524 -0.89758199]
mat_Sqrt:  [[20.54744234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00383229 0.03205026 0.01799629]
Stock Position:  0.003832292830899151
Bond Position:  [-0.64635107]


portfolio before change:  [-0.27508491]
curr_Stock_Price:  96.92050861774187
curr_Factors:  [96.92050862 -0.46181138 -0.90143373]
mat_Sqrt:  [[24.79509969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00168629 0.05073736 0.23851553]
Stock Position:  0.001686288680897132
Bond Position:  [-0.43852087]


portfolio before change:  [-0.27277211]
curr_Stock_Price:  98.35706298739406
curr_Factors:  [98.35706299 -0.25778345 -0.88421769]
mat_Sqrt:  [[31.39357371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191651 -0.00462136 -0.13950231]
Stock Position:  -0.0019165055622550004
Bond Position:  [-0.08427025]


portfolio before change:  [-0.2729584]
curr_Stock_Price:  98.44327258708981
curr_Factors:  [98.44327259 -0.28288874 -0.88474234]
mat_Sqrt:  [[30.62600195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00320897 -0.03055256  0.5706469 ]
Stock Position:  -0.003208969402182971
Bond Position:  [0.04294305]


portfolio before change:  [-0.26525178]
curr_Stock_Price:  96.04503136006446
curr_Factors:  [96.04503136 -0.58991266 -0.86924548]
mat_Sqrt:  [[22.32392607  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00204184 0.05670775 0.80061101]
Stock Position:  0.0020418389060078935
Bond Position:  [-0.46136026]


portfolio before change:  [-0.26364343]
curr_Stock_Price:  96.88922143715934
curr_Factors:  [96.88922144 -0.63641028 -0.84591643]
mat_Sqrt:  [[22.00438097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00156241  0.03453574  0.0514469 ]
Stock Position:  -0.0015624104657960105
Bond Position:  [-0.1122627]


portfolio before change:  [-0.2664113]
curr_Stock_Price:  98.64279118305062
curr_Factors:  [98.64279118 -0.70766885 -0.85723416]
mat_Sqrt:  [[20.62702577  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200024 -0.01652591  0.08033571]
Stock Position:  -0.002000235511997247
Bond Position:  [-0.06910248]


portfolio before change:  [-0.26268606]
curr_Stock_Price:  96.77175568430245
curr_Factors:  [96.77175568 -0.84989453 -0.86022247]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.26268606]
Stock Price:  99.23674057059212
PL:  [-0.26268606]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.48152647e-01 -6.83717827e-02  1.63090466e-01]
 [-6.26400399e-02  1.16085521e-01  8.74645664e-02]
 [-3.07298743e-02 -2.16551486e-01  4.26073771e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.81560411e-01 -3.21199084e-01 -2.88073507e-01]
 [ 8.09203347e-02 -1.78822102e-01 -1.31279127e-01]
 [ 5.51077501e-02 -9.64312587e-02 -1.07665637e-02]
 [-3.85465050e-02 -1.87963546e-01 -5.93020701e-02]
 [-4.88537708e-02 -1.36009340e-02 -1.12368703e-01]
 [-2.60042342e-01  2.50688880e-01  3.17554528e-03]
 [ 6.41524872e-02 -1.19930933e-01 -9.53809969e-04]
 [ 9.95734391e-02  8.18509114e-02 -5.98182426e-02]
 [ 3.97334722e-02  1.38433633e-01  9.73417593e-02]
 [ 6.77840034e-02 -4.64389102e-02  8.54204152e-02]
 [-1.41962208e-01 -1.21816150e-01  1.32736025e-01]
 [-6.15674337e-04  1.57081763e-01  2.98720704e-01]
 [ 2.61340420e-03  4.10796008e-03 -1.66635349e-02]
 [ 8.71020237e-02  4.92279022e-02  1.68642155e-01]
 [-3.61359460e-02  4.64113251e-01  1.36476525e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.60557686]
curr_Stock_Price:  99.04138664771293
curr_Factors:  [99.04138665 -0.96044758 -0.99488788]
mat_Sqrt:  [[14.01603935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00832099 -0.02162106  0.4652517 ]
Stock Position:  -0.008320988092773774
Bond Position:  [-3.78145466]


portfolio before change:  [-4.61262631]
curr_Stock_Price:  99.77494867837243
curr_Factors:  [99.77494868 -1.05795197 -1.01355402]
mat_Sqrt:  [[12.57123349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332418  0.03670946  0.24951206]
Stock Position:  -0.0033241841246176174
Bond Position:  [-4.28095601]


portfolio before change:  [-4.61395127]
curr_Stock_Price:  99.85153589827485
curr_Factors:  [99.8515359  -0.76216478 -1.03542875]
mat_Sqrt:  [[16.54511532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166962 -0.06847959  0.12154699]
Stock Position:  -0.0016696175672909768
Bond Position:  [-4.44723739]


portfolio before change:  [-4.61772844]
curr_Stock_Price:  101.44784396663314
curr_Factors:  [101.44784397  -0.68325672  -1.05090352]
mat_Sqrt:  [[17.91045428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00211853 -0.00455813 -0.02970002]
Stock Position:  -0.0021185256727120714
Bond Position:  [-4.40280858]


portfolio before change:  [-4.62415767]
curr_Stock_Price:  103.96298247121898
curr_Factors:  [103.96298247  -0.74385904  -1.01643653]
mat_Sqrt:  [[17.88101117  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0175865  -0.10157207 -0.82179353]
Stock Position:  0.01758649579808302
Bond Position:  [-6.45250222]


portfolio before change:  [-4.62089784]
curr_Stock_Price:  104.2400790267661
curr_Factors:  [104.24007903  -0.66071013  -1.00950645]
mat_Sqrt:  [[19.61863949  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00252341 -0.05654851 -0.37450281]
Stock Position:  0.0025234129186141215
Bond Position:  [-4.8839386]


portfolio before change:  [-4.61912012]
curr_Stock_Price:  105.42849065484101
curr_Factors:  [105.42849065  -0.76953528  -1.06115022]
mat_Sqrt:  [[16.90057105  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00298334 -0.03049424 -0.03071401]
Stock Position:  0.002983342395396161
Bond Position:  [-4.93364941]


portfolio before change:  [-4.62475681]
curr_Stock_Price:  103.95258813016108
curr_Factors:  [103.95258813  -0.46857616  -1.05852047]
mat_Sqrt:  [[22.5748913   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00245869 -0.05943929 -0.1691723 ]
Stock Position:  -0.0024586912289052357
Bond Position:  [-4.36916949]


portfolio before change:  [-4.62536886]
curr_Stock_Price:  103.75720671668218
curr_Factors:  [103.75720672  -0.3861548   -1.10022639]
mat_Sqrt:  [[23.46881307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00307396 -0.00430099 -0.32055663]
Stock Position:  -0.003073956513289297
Bond Position:  [-4.30642371]


portfolio before change:  [-4.62362909]
curr_Stock_Price:  102.84095883622435
curr_Factors:  [102.84095884  -0.14483232  -1.11427031]
mat_Sqrt:  [[29.19744124  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00866245  0.07927478  0.00905895]
Stock Position:  -0.008662450094128414
Bond Position:  [-3.73277442]


portfolio before change:  [-4.58591576]
curr_Stock_Price:  98.37956016992815
curr_Factors:  [ 9.83795602e+01 -9.53968692e-03 -1.10778518e+00]
mat_Sqrt:  [[32.1852475   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00189097 -0.03792549 -0.00272095]
Stock Position:  0.0018909653603189985
Bond Position:  [-4.7719481]


portfolio before change:  [-4.58968136]
curr_Stock_Price:  97.01916072359982
curr_Factors:  [97.01916072  0.36369532 -1.07905825]
mat_Sqrt:  [[47.44378583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00188595  0.02588353 -0.1706448 ]
Stock Position:  0.0018859471560437903
Bond Position:  [-4.77265437]


portfolio before change:  [-4.59932124]
curr_Stock_Price:  92.54047445267229
curr_Factors:  [92.54047445  0.63935644 -1.03708265]
mat_Sqrt:  [[62.1729425   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00101616 0.04377656 0.27768894]
Stock Position:  0.00101615934703968
Bond Position:  [-4.69335711]


portfolio before change:  [-4.60070431]
curr_Stock_Price:  92.3342267922103
curr_Factors:  [92.33422679  0.84757117 -1.05426602]
mat_Sqrt:  [[ 7.50924518e+01  0.00000000e+00  0.00000000e+00]
 [-8.16496581e-02  3.16227766e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [ 0.00111891 -0.01468527  0.24368067]
Stock Position:  0.0011189050710213155
Bond Position:  [-4.70401754]


portfolio before change:  [-4.60259832]
curr_Stock_Price:  91.69265518945136
curr_Factors:  [91.69265519  0.64242809 -1.0208326 ]
mat_Sqrt:  [[62.8051931   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00187903 -0.03852165  0.37865893]
Stock Position:  -0.001879030289960098
Bond Position:  [-4.43030504]


portfolio before change:  [-4.60725574]
curr_Stock_Price:  93.58177550958082
curr_Factors:  [ 9.35817755e+01 -7.66985017e-02 -9.67195370e-01]
mat_Sqrt:  [[32.94836987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00195507 0.04967362 0.85216702]
Stock Position:  0.001955066909866164
Bond Position:  [-4.79021438]


portfolio before change:  [-4.60975912]
curr_Stock_Price:  92.91393721969362
curr_Factors:  [92.91393722 -0.35357156 -0.93797276]
mat_Sqrt:  [[25.53702439  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.67046989e-05  1.29905104e-03 -4.75364269e-02]
Stock Position:  -2.670469890644081e-05
Bond Position:  [-4.60727788]


portfolio before change:  [-4.61089841]
curr_Stock_Price:  92.4396640894151
curr_Factors:  [ 9.24396641e+01 -4.83074042e-02 -9.37470577e-01]
mat_Sqrt:  [[34.49375076  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00355998 0.01556723 0.48108913]
Stock Position:  0.0035599787138957586
Bond Position:  [-4.93998165]


portfolio before change:  [-4.61748731]
curr_Stock_Price:  90.93579374786384
curr_Factors:  [90.93579375 -0.36205571 -0.9129781 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.61748731]
Stock Price:  89.96812663416962
PL:  [-4.61748731]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.10166301e-01 -2.36238625e-02  5.49834607e-02]
 [ 9.81400894e-03  7.30409471e-02  7.61086566e-02]
 [-2.76193259e-02 -1.94712847e-01  3.90191273e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 4.47554626e-01 -2.91204340e-01 -1.55360860e-01]
 [ 4.88139256e-02  2.73601218e-02 -1.02699760e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 1.21026770e-01 -1.04552701e-02 -1.76834930e-03]
 [-6.89473914e-02  2.51162821e-02  4.30904787e-02]
 [-1.45141105e-01  1.26383642e-01 -2.08668717e-02]
 [ 1.60172965e-02 -9.16548947e-02  1.76059687e-03]
 [ 1.06812810e-01  1.07563179e-01 -3.43188782e-02]
 [ 1.22808834e-02  1.64513049e-01  7.54276790e-02]
 [ 6.47214759e-02 -1.01477365e-01  5.26533800e-02]
 [-1.24782912e-01 -8.78230624e-02  1.85123157e-01]
 [ 5.87483350e-03  1.14264158e-01  1.77196268e-01]
 [ 1.02344109e-02 -2.06597466e-02 -2.87536880e-02]
 [ 9.59928454e-02  5.09523871e-02  1.75844014e-01]
 [-3.15790224e-02  5.00285878e-01  1.73559896e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.13830391]
curr_Stock_Price:  101.09519196623854
curr_Factors:  [101.09519197  -0.91069189  -1.02330814]
mat_Sqrt:  [[14.61520667  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01365378 -0.00747052  0.15685251]
Stock Position:  -0.013653779858666162
Bond Position:  [11.5186354]


portfolio before change:  [10.14925837]
curr_Stock_Price:  100.5038216266508
curr_Factors:  [100.50382163  -1.13295144  -0.99009928]
mat_Sqrt:  [[12.02689071  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00226455 0.02309758 0.21711681]
Stock Position:  0.0022645530930210894
Bond Position:  [9.92166213]


portfolio before change:  [10.15181204]
curr_Stock_Price:  100.53603400716439
curr_Factors:  [100.53603401  -1.0483209   -1.04456045]
mat_Sqrt:  [[12.39923608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199061 -0.06157361  0.11131071]
Stock Position:  -0.001990610052571285
Bond Position:  [10.35194008]


portfolio before change:  [10.15662807]
curr_Stock_Price:  99.41691815650013
curr_Factors:  [99.41691816 -0.98905868 -1.02783495]
mat_Sqrt:  [[13.22922872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286818 -0.00455813 -0.02970002]
Stock Position:  -0.0028681760660088083
Bond Position:  [10.4417733]


portfolio before change:  [10.15751984]
curr_Stock_Price:  100.01625525994382
curr_Factors:  [100.01625526  -0.71820268  -1.03464805]
mat_Sqrt:  [[17.33074337  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02356061 -0.0920869  -0.44320129]
Stock Position:  0.023560608521818797
Bond Position:  [7.801076]


portfolio before change:  [10.16282151]
curr_Stock_Price:  100.15849112564577
curr_Factors:  [100.15849113  -0.92345548  -1.07341978]
mat_Sqrt:  [[13.59739982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00348773  0.00865203 -0.02929738]
Stock Position:  0.003487726437767089
Bond Position:  [9.8134961]


portfolio before change:  [10.16337538]
curr_Stock_Price:  99.61377752030492
curr_Factors:  [99.61377752 -0.836741   -1.09107377]
mat_Sqrt:  [[14.4903907   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039104 -0.02845143  0.0120735 ]
Stock Position:  -0.0003910380337352533
Bond Position:  [10.20232816]


portfolio before change:  [10.16622065]
curr_Stock_Price:  98.86100523650234
curr_Factors:  [98.86100524 -0.86064687 -1.07675963]
mat_Sqrt:  [[14.24360982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00845262 -0.00330625 -0.00504461]
Stock Position:  0.008452622256567984
Bond Position:  [9.33058591]


portfolio before change:  [10.17293318]
curr_Stock_Price:  99.37913976557677
curr_Factors:  [99.37913977 -0.71172959 -1.03839384]
mat_Sqrt:  [[17.26737361  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00344598  0.00794247  0.12292514]
Stock Position:  -0.003445983504545112
Bond Position:  [10.51539206]


portfolio before change:  [10.17978534]
curr_Stock_Price:  98.15366077792042
curr_Factors:  [98.15366078 -1.01146673 -1.01461144]
mat_Sqrt:  [[12.94171795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01129196  0.03996602 -0.05952738]
Stock Position:  -0.01129195723887941
Bond Position:  [11.28813228]


portfolio before change:  [10.18294075]
curr_Stock_Price:  98.12416836831397
curr_Factors:  [98.12416837 -0.64957249 -0.99533851]
mat_Sqrt:  [[18.94088291  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00073968 -0.02898382  0.00502249]
Stock Position:  0.0007396781704211766
Bond Position:  [10.11036044]


portfolio before change:  [10.18495517]
curr_Stock_Price:  97.4299695815211
curr_Factors:  [97.42996958 -0.66697246 -0.98737265]
mat_Sqrt:  [[18.63029002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00550634  0.03401446 -0.09790221]
Stock Position:  0.005506343055116323
Bond Position:  [9.64847234]


portfolio before change:  [10.18928856]
curr_Stock_Price:  97.778833646268
curr_Factors:  [97.77883365 -0.59018661 -0.95591696]
mat_Sqrt:  [[20.83438115  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00153233 0.05202359 0.21517417]
Stock Position:  0.001532332653969717
Bond Position:  [10.03945886]


portfolio before change:  [10.18858862]
curr_Stock_Price:  95.68391317925054
curr_Factors:  [95.68391318 -0.39160428 -0.91636947]
mat_Sqrt:  [[25.86980452  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00281599 -0.03208996  0.15020544]
Stock Position:  0.0028159922032681335
Bond Position:  [9.91914347]


portfolio before change:  [10.19344149]
curr_Stock_Price:  96.52652097444329
curr_Factors:  [ 9.65265210e+01 -3.47070927e-02 -9.39346456e-01]
mat_Sqrt:  [[36.44354135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244933 -0.02777209  0.52810484]
Stock Position:  -0.002449333528402408
Bond Position:  [10.42986714]


portfolio before change:  [10.19540809]
curr_Stock_Price:  96.78830486670401
curr_Factors:  [96.78830487 -0.12425827 -0.96803195]
mat_Sqrt:  [[32.46738156  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00138586 0.0361335  0.50549163]
Stock Position:  0.0013858573114053946
Bond Position:  [10.06127331]


portfolio before change:  [10.19145951]
curr_Stock_Price:  92.12388976851739
curr_Factors:  [92.12388977 -0.2913372  -0.94142914]
mat_Sqrt:  [[26.85274256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00014269 -0.00653319 -0.08202627]
Stock Position:  0.00014269144017137265
Bond Position:  [10.17831422]


portfolio before change:  [10.19401752]
curr_Stock_Price:  92.2157862416375
curr_Factors:  [92.21578624 -0.27352839 -0.93469941]
mat_Sqrt:  [[27.54727267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00483541 0.01611256 0.50163403]
Stock Position:  0.00483541296384029
Bond Position:  [9.74811611]


portfolio before change:  [10.19481253]
curr_Stock_Price:  91.87614057468699
curr_Factors:  [91.87614057 -0.1325578  -0.93748565]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.19481253]
Stock Price:  90.7101917837788
PL:  [10.19481253]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.05966842e-01 -4.58507452e-02  1.34336703e-01]
 [-1.42967185e-01  1.60836305e-01  8.70207908e-02]
 [-9.99314908e-02 -4.57228583e-01 -4.33629195e-05]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 7.19367046e-01 -4.51135332e-01 -2.22236757e-01]
 [-1.67603939e-02  3.65627273e-02 -3.43905529e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 1.95121105e-01 -1.56531308e-04  1.41956734e-02]
 [-7.73308552e-02  2.42313321e-02  5.37923223e-02]
 [-2.93475666e-01  2.70303257e-01  2.45282483e-02]
 [-2.05399997e-02 -7.05329937e-02  6.58625328e-03]
 [ 4.47726160e-02  8.38917570e-02 -2.34699963e-02]
 [ 2.07528099e-02  1.42844681e-01  7.69603493e-02]
 [ 8.13480770e-02 -2.33609906e-01  5.60267087e-03]
 [ 1.63093014e-01  2.56797918e-02  1.04868021e-01]
 [-2.43698265e-02  2.33664716e-01  3.55961232e-01]
 [ 1.27841279e-02 -4.03020834e-02 -7.40479875e-02]
 [-4.51620484e-02 -4.50688571e-02  2.44951747e-02]
 [-4.04688301e-02  4.15311080e-01  1.47471006e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.05294169]
curr_Stock_Price:  99.67556339409727
curr_Factors:  [99.67556339 -1.06581419 -1.00993121]
mat_Sqrt:  [[12.50558255  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02236836 -0.01449928  0.38322522]
Stock Position:  -0.022368357286134136
Bond Position:  [2.17663693]


portfolio before change:  [-0.03922113]
curr_Stock_Price:  99.08650228903174
curr_Factors:  [99.08650229 -1.1532449  -1.03134328]
mat_Sqrt:  [[11.14961586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.010857    0.05086091  0.24824609]
Stock Position:  -0.010856998713640946
Bond Position:  [1.0365609]


portfolio before change:  [-0.04083532]
curr_Stock_Price:  99.25905078977347
curr_Factors:  [99.25905079 -1.28578997 -1.01681743]
mat_Sqrt:  [[ 9.92568363  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.12582607e-02 -1.44588373e-01 -1.23702340e-04]
Stock Position:  -0.011258260653108965
Bond Position:  [1.07664895]


portfolio before change:  [-0.04800818]
curr_Stock_Price:  99.92008139052666
curr_Factors:  [99.92008139 -1.23284017 -1.02507946]
mat_Sqrt:  [[10.44842291  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00363153 -0.00455813 -0.02970002]
Stock Position:  -0.003631529613428325
Bond Position:  [0.31485456]


portfolio before change:  [-0.04903851]
curr_Stock_Price:  100.22547795737383
curr_Factors:  [100.22547796  -1.52214918  -1.00773113]
mat_Sqrt:  [[ 7.98481902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08295177 -0.14266152 -0.63397961]
Stock Position:  0.08295177286050355
Bond Position:  [-8.36291959]


portfolio before change:  [-0.0380675]
curr_Stock_Price:  100.38294292160016
curr_Factors:  [100.38294292  -1.92271496  -1.03334696]
mat_Sqrt:  [[ 5.22226062  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00437287  0.01156215 -0.09810667]
Stock Position:  -0.00437287455128121
Bond Position:  [0.40089451]


portfolio before change:  [-0.03764388]
curr_Stock_Price:  100.30899033225549
curr_Factors:  [100.30899033  -2.06129496  -1.04774983]
mat_Sqrt:  [[ 4.47815236  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126532 -0.02845143  0.0120735 ]
Stock Position:  -0.0012653195862179095
Bond Position:  [0.08927905]


portfolio before change:  [-0.03736026]
curr_Stock_Price:  100.1024797025399
curr_Factors:  [100.1024797   -2.0093351   -1.07241349]
mat_Sqrt:  [[ 4.59259793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.31160633e-02 -4.94995457e-05  4.04963050e-02]
Stock Position:  0.04311606333587621
Bond Position:  [-4.35338511]


portfolio before change:  [-0.04697267]
curr_Stock_Price:  99.90478243673348
curr_Factors:  [99.90478244 -1.87179464 -1.06087035]
mat_Sqrt:  [[ 5.3204217   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01235332  0.00766262  0.15345452]
Stock Position:  -0.01235332399388967
Bond Position:  [1.18718348]


portfolio before change:  [-0.03806421]
curr_Stock_Price:  99.2076724382452
curr_Factors:  [99.20767244 -1.7204587  -1.05595037]
mat_Sqrt:  [[ 6.17683673  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04557181  0.0854774   0.06997227]
Stock Position:  -0.045571814673601385
Bond Position:  [4.48300945]


portfolio before change:  [-0.01377377]
curr_Stock_Price:  98.69925410691764
curr_Factors:  [98.69925411 -1.5937904  -1.03426059]
mat_Sqrt:  [[ 7.12796938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00294849 -0.02230449  0.01878875]
Stock Position:  -0.0029484891599809585
Bond Position:  [0.27723991]


portfolio before change:  [-0.01228758]
curr_Stock_Price:  98.21871266158912
curr_Factors:  [98.21871266 -1.76075585 -1.06624706]
mat_Sqrt:  [[ 5.81356421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00724992  0.0265289  -0.06695337]
Stock Position:  0.007249924042543386
Bond Position:  [-0.72436579]


portfolio before change:  [-0.0137984]
curr_Stock_Price:  98.03530292381424
curr_Factors:  [98.03530292 -1.49903914 -1.07072634]
mat_Sqrt:  [[ 7.5049452   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00534987 0.04517145 0.21954645]
Stock Position:  0.005349873731068875
Bond Position:  [-0.53827489]


portfolio before change:  [-0.01303857]
curr_Stock_Price:  98.20248722121748
curr_Factors:  [98.20248722 -1.70070585 -1.03664531]
mat_Sqrt:  [[ 6.3577871   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01202619 -0.07387394  0.01598286]
Stock Position:  0.01202618683628888
Bond Position:  [-1.19404003]


portfolio before change:  [-0.00935024]
curr_Stock_Price:  98.53400402254746
curr_Factors:  [98.53400402 -2.21695087 -1.07624097]
mat_Sqrt:  [[ 3.6590731   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05060357 0.00812066 0.29915927]
Stock Position:  0.0506035691544721
Bond Position:  [-4.99552252]


portfolio before change:  [-0.01029087]
curr_Stock_Price:  98.54009847383124
curr_Factors:  [98.54009847 -2.29166172 -1.06170709]
mat_Sqrt:  [[ 3.44558858  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01576615 0.07389127 1.01545832]
Stock Position:  0.015766146027378896
Bond Position:  [-1.56388845]


portfolio before change:  [-0.00642752]
curr_Stock_Price:  98.80994061631499
curr_Factors:  [98.80994062 -2.24167949 -1.03156441]
mat_Sqrt:  [[ 3.74325035  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090067 -0.01274464 -0.2112383 ]
Stock Position:  -0.000900674349631589
Bond Position:  [0.08256806]


portfolio before change:  [-0.00633231]
curr_Stock_Price:  98.72715389130545
curr_Factors:  [98.72715389 -1.9558639  -1.0549296 ]
mat_Sqrt:  [[ 4.86256718  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00849873 -0.01425202  0.06987792]
Stock Position:  -0.00849873393619017
Bond Position:  [0.8327235]


portfolio before change:  [-0.00817356]
curr_Stock_Price:  98.968301963358
curr_Factors:  [98.96830196 -1.55411141 -1.05158668]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.00817356]
Stock Price:  98.74158897657522
PL:  [-0.00817356]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.28293695e-01 -6.80938603e-02  1.58316744e-01]
 [-5.18279938e-01  3.58249690e-01  3.37286195e-02]
 [-2.25799575e-01 -6.52532071e-01 -9.50861108e-02]
 [-1.56507681e-02  1.51814055e-01  1.08917424e-01]
 [-4.29114226e-02  1.35353374e-02 -5.63715437e-02]
 [ 7.37603642e-02  7.14126150e-03 -2.17824573e-02]
 [ 4.16524069e-03 -7.58688277e-02  1.98727347e-03]
 [-1.03284159e-01 -8.46769857e-02 -5.40507241e-02]
 [-8.03860179e-03  1.00109144e-02 -1.07316021e-01]
 [-4.59964471e-01  4.57017882e-01  5.26638632e-02]
 [ 1.06927384e-01 -2.09553514e-01  8.38295924e-02]
 [-1.63024255e-01 -2.62319833e-02 -2.46244615e-02]
 [-1.19193059e-01  1.35553677e-01 -9.00010523e-02]
 [-1.28807713e-01 -2.29414794e-02  1.89862935e-01]
 [-1.17168827e-01 -1.05313454e-01  2.40058682e-01]
 [-2.88502112e-02  2.08006548e-02 -4.70617193e-02]
 [-9.21416584e-02  5.27188855e-02  8.12130134e-02]
 [-3.28621943e-02 -3.65801012e-03  2.00647290e-02]
 [ 8.43202566e-03  6.08967873e-01  4.54792000e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.23207792]
curr_Stock_Price:  98.95411578475462
curr_Factors:  [98.95411578 -0.91786059 -1.01947467]
mat_Sqrt:  [[14.25804067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00685477 -0.02153317  0.4516336 ]
Stock Position:  -0.006854770816886619
Bond Position:  [-4.55377013]


portfolio before change:  [-5.22216222]
curr_Stock_Price:  97.34147503383713
curr_Factors:  [97.34147503 -0.93112614 -0.9993987 ]
mat_Sqrt:  [[14.12152621  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03555884  0.1132885   0.09621836]
Stock Position:  -0.035558843806866386
Bond Position:  [-1.76081191]


portfolio before change:  [-5.23007472]
curr_Stock_Price:  97.55161241244272
curr_Factors:  [97.55161241 -0.97437626 -1.01500506]
mat_Sqrt:  [[13.34311178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01963989 -0.20634876 -0.27125421]
Stock Position:  -0.01963989031950904
Bond Position:  [-3.31417175]


portfolio before change:  [-5.2357691]
curr_Stock_Price:  97.79935965734087
curr_Factors:  [97.79935966 -0.8662999  -1.00172929]
mat_Sqrt:  [[15.10293121  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00069534 0.04800782 0.3107111 ]
Stock Position:  0.0006953438328295702
Bond Position:  [-5.30377328]


portfolio before change:  [-5.23773704]
curr_Stock_Price:  96.87630551953698
curr_Factors:  [96.87630552 -0.56055234 -0.99353177]
mat_Sqrt:  [[20.47799414  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264033  0.00428025 -0.16081232]
Stock Position:  -0.0026403335479841424
Bond Position:  [-4.98195129]


portfolio before change:  [-5.2485707]
curr_Stock_Price:  100.50766962041388
curr_Factors:  [100.50766962  -0.76620229  -1.04096549]
mat_Sqrt:  [[16.49514759  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00421326  0.00225827 -0.06213929]
Stock Position:  0.004213264834681061
Bond Position:  [-5.67203613]


portfolio before change:  [-5.24388899]
curr_Stock_Price:  101.95545257210487
curr_Factors:  [101.95545257  -0.553965    -1.02592021]
mat_Sqrt:  [[21.00269507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00012436 -0.02399183  0.00566914]
Stock Position:  0.00012436339569288243
Bond Position:  [-5.25656852]


portfolio before change:  [-5.24500268]
curr_Stock_Price:  103.56865699321033
curr_Factors:  [103.56865699  -0.73242368  -1.06381891]
mat_Sqrt:  [[17.18423103  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00677968 -0.02677721 -0.15419167]
Stock Position:  -0.006779678841135421
Bond Position:  [-4.54284044]


portfolio before change:  [-5.24011381]
curr_Stock_Price:  102.68001386544631
curr_Factors:  [102.68001387  -0.49025915  -1.06790801]
mat_Sqrt:  [[21.61635758  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137331  0.00316573 -0.30614274]
Stock Position:  -0.0013733077840921918
Bond Position:  [-5.09910255]


portfolio before change:  [-5.24624968]
curr_Stock_Price:  106.21959188913645
curr_Factors:  [106.21959189  -0.4877862   -1.05483102]
mat_Sqrt:  [[22.7119531   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01925921  0.14452174  0.15023534]
Stock Position:  -0.019259213509647023
Bond Position:  [-3.20054388]


portfolio before change:  [-5.25631173]
curr_Stock_Price:  106.70049482774712
curr_Factors:  [106.70049483  -0.75808137  -1.05078904]
mat_Sqrt:  [[17.48171336  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00678586 -0.06626664  0.23914249]
Stock Position:  0.006785855416343971
Bond Position:  [-5.98036586]


portfolio before change:  [-5.25348629]
curr_Stock_Price:  107.33721832074244
curr_Factors:  [107.33721832  -0.17878073  -1.092625  ]
mat_Sqrt:  [[30.10134097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00560533 -0.00829528 -0.07024673]
Stock Position:  -0.0056053319771701415
Bond Position:  [-4.65182555]


portfolio before change:  [-5.25093582]
curr_Stock_Price:  106.67471123080946
curr_Factors:  [106.67471123  -0.5656907   -1.12107583]
mat_Sqrt:  [[19.74731618  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.006789    0.04286584 -0.25674795]
Stock Position:  -0.006788996783025418
Bond Position:  [-4.52672155]


portfolio before change:  [-5.24151706]
curr_Stock_Price:  105.12064040105506
curr_Factors:  [105.1206404   -0.52601012  -1.14447117]
mat_Sqrt:  [[19.77913026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00458283 -0.00725473  0.5416261 ]
Stock Position:  -0.004582832990372612
Bond Position:  [-4.75976672]


portfolio before change:  [-5.2494678]
curr_Stock_Price:  106.5958529613891
curr_Factors:  [106.59585296  -0.72668273  -1.13966176]
mat_Sqrt:  [[16.48910937  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429897 -0.03330304  0.6848206 ]
Stock Position:  -0.004298972969328654
Bond Position:  [-4.79121511]


portfolio before change:  [-5.24813217]
curr_Stock_Price:  106.00650496650903
curr_Factors:  [106.00650497  -0.53358638  -1.14670196]
mat_Sqrt:  [[19.75115789  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191987  0.00657774 -0.13425399]
Stock Position:  -0.0019198658659806236
Bond Position:  [-5.0446139]


portfolio before change:  [-5.24835312]
curr_Stock_Price:  105.46461455425225
curr_Factors:  [105.46461455  -0.78035668  -1.1385194 ]
mat_Sqrt:  [[15.47923451  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00479371  0.01667118  0.23167812]
Stock Position:  -0.00479370770281576
Bond Position:  [-4.74278659]


portfolio before change:  [-5.25805745]
curr_Stock_Price:  107.2416281123005
curr_Factors:  [107.24162811  -0.66852551  -1.1507593 ]
mat_Sqrt:  [[17.38833683  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00165979 -0.00115676  0.05723909]
Stock Position:  -0.0016597877244336806
Bond Position:  [-5.08005911]


portfolio before change:  [-5.26037919]
curr_Stock_Price:  107.87518456410429
curr_Factors:  [107.87518456  -0.17810506  -1.17147158]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.26037919]
Stock Price:  106.56260320877999
PL:  [-11.8229824]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.88632436e-01 -5.21502325e-02  1.47812122e-01]
 [ 5.63673088e-02  4.07068273e-02  4.82952987e-02]
 [-6.94342844e-02 -4.10851378e-01  2.22525007e-02]
 [-2.62167853e-02  6.52741486e-04 -9.41341369e-04]
 [ 2.97150628e-01 -1.63886780e-01 -8.38713782e-02]
 [-1.60886294e-01  8.61375484e-02  3.54356979e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 4.15507773e-01  4.19446205e-02  8.58733064e-03]
 [-4.15266445e-01 -2.41762868e-02  5.49775904e-01]
 [-1.08641830e-01  8.79463343e-02 -2.83920074e-02]
 [-1.68782375e-01  3.79449591e-02  5.66303475e-02]
 [ 1.58203912e-01  9.56283991e-03 -2.25194501e-01]
 [-3.27141746e-02  6.05861822e-03 -4.44591333e-02]
 [ 2.22635433e-01 -4.65118119e-01  1.26713032e-01]
 [ 8.27017696e-03  1.04994421e-01 -1.44137056e-01]
 [-3.50668861e-02  2.63133274e-01  5.01575080e-01]
 [ 5.69869509e-02 -1.80308713e-01 -1.20436846e-01]
 [ 1.89883458e-01  6.48395680e-02  2.41901172e-01]
 [-5.14177011e-02  3.41655605e-01  1.06890882e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.68383403]
curr_Stock_Price:  99.5876808299043
curr_Factors:  [99.58768083 -1.10386522 -1.03562959]
mat_Sqrt:  [[11.72289369  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02216235 -0.01649135  0.42166684]
Stock Position:  -0.022162354532832936
Bond Position:  [1.52326346]


portfolio before change:  [-0.71449461]
curr_Stock_Price:  100.98831910599093
curr_Factors:  [100.98831911  -1.05009428  -1.0434607 ]
mat_Sqrt:  [[12.44662964  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00540521 0.01287263 0.13777304]
Stock Position:  0.0054052055128568826
Bond Position:  [-1.26035723]


portfolio before change:  [-0.7218773]
curr_Stock_Price:  99.68077239376635
curr_Factors:  [99.68077239 -1.36972285 -1.00640586]
mat_Sqrt:  [[ 9.26129696  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00815222 -0.12992261  0.06348019]
Stock Position:  -0.008152221982760326
Bond Position:  [0.09074249]


portfolio before change:  [-0.71655089]
curr_Stock_Price:  99.03018694241631
curr_Factors:  [99.03018694 -1.14283844 -1.01570557]
mat_Sqrt:  [[11.43730882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00230754  0.00020641 -0.00268538]
Stock Position:  -0.0023075430153014316
Bond Position:  [-0.48803447]


portfolio before change:  [-0.71275394]
curr_Stock_Price:  97.33185380632297
curr_Factors:  [97.33185381 -1.00762511 -1.0378106 ]
mat_Sqrt:  [[12.58732807  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02191084 -0.05182555 -0.2392617 ]
Stock Position:  0.021910838763323552
Bond Position:  [-2.84537649]


portfolio before change:  [-0.74191962]
curr_Stock_Price:  96.03321582951487
curr_Factors:  [96.03321583 -1.17769638 -1.00271003]
mat_Sqrt:  [[10.85133069  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01395487  0.02723908  0.10108818]
Stock Position:  -0.013954873838096807
Bond Position:  [0.59821179]


portfolio before change:  [-0.73217073]
curr_Stock_Price:  95.34533289276034
curr_Factors:  [95.34533289 -1.16069224 -1.01246131]
mat_Sqrt:  [[10.85202653  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052214 -0.02845143  0.0120735 ]
Stock Position:  -0.0005221415440259432
Bond Position:  [-0.68238697]


portfolio before change:  [-0.73239812]
curr_Stock_Price:  95.4540658356052
curr_Factors:  [95.45406584 -1.09259412 -1.01888201]
mat_Sqrt:  [[11.55558671  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03620272 0.01326405 0.02449726]
Stock Position:  0.03620271910377121
Bond Position:  [-4.18809485]


portfolio before change:  [-0.8024699]
curr_Stock_Price:  93.54745147961343
curr_Factors:  [93.54745148 -0.99224221 -1.02006153]
mat_Sqrt:  [[12.50545653  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02428285 -0.00764521  1.56835763]
Stock Position:  -0.024282850950160334
Bond Position:  [1.46912892]


portfolio before change:  [-0.7711195]
curr_Stock_Price:  92.27152747891398
curr_Factors:  [92.27152748 -0.93758328 -1.03889991]
mat_Sqrt:  [[12.78474199  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00877347  0.02781107 -0.08099449]
Stock Position:  -0.008773470712664596
Bond Position:  [0.03842205]


portfolio before change:  [-0.75849483]
curr_Stock_Price:  90.83366293340467
curr_Factors:  [90.83366293 -0.80393827 -1.05377749]
mat_Sqrt:  [[14.17265208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01102426  0.01199925  0.16155062]
Stock Position:  -0.011024261233269772
Bond Position:  [0.2428792]


portfolio before change:  [-0.76500197]
curr_Stock_Price:  91.42942781057275
curr_Factors:  [91.42942781 -1.05957353 -1.08848701]
mat_Sqrt:  [[10.67075532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01054126  0.00302404 -0.64241723]
Stock Position:  0.010541258336591919
Bond Position:  [-1.72878319]


portfolio before change:  [-0.76309233]
curr_Stock_Price:  91.65159180630009
curr_Factors:  [91.65159181 -1.07553153 -1.05523835]
mat_Sqrt:  [[10.88324519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00382541  0.0019159  -0.12682953]
Stock Position:  -0.0038254145380525236
Bond Position:  [-0.412487]


portfolio before change:  [-0.76118228]
curr_Stock_Price:  91.12532526220983
curr_Factors:  [91.12532526 -1.05628365 -1.06749223]
mat_Sqrt:  [[10.89669888  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02170302 -0.14708326  0.36147701]
Stock Position:  0.021703024645604863
Bond Position:  [-2.73887746]


portfolio before change:  [-0.77013838]
curr_Stock_Price:  90.74421253538765
curr_Factors:  [90.74421254 -1.14201221 -1.04940471]
mat_Sqrt:  [[10.14141738  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00181836  0.03320215 -0.4111829 ]
Stock Position:  -0.0018183584573087826
Bond Position:  [-0.60513287]


portfolio before change:  [-0.76971272]
curr_Stock_Price:  90.42691293799513
curr_Factors:  [90.42691294 -0.98150342 -1.05068436]
mat_Sqrt:  [[11.85031142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00625391 0.08321005 1.43085409]
Stock Position:  0.006253909092373074
Bond Position:  [-1.33523441]


portfolio before change:  [-0.77275113]
curr_Stock_Price:  89.99445350412319
curr_Factors:  [89.9944535  -1.17012316 -1.03167742]
mat_Sqrt:  [[ 9.95373103  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00278763 -0.05701862 -0.3435728 ]
Stock Position:  0.002787631245715991
Bond Position:  [-1.02362248]


portfolio before change:  [-0.77646888]
curr_Stock_Price:  88.75260490261769
curr_Factors:  [88.7526049  -1.10990782 -1.0277789 ]
mat_Sqrt:  [[10.46635744  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02301999 0.02050407 0.69007671]
Stock Position:  0.023019993351717123
Bond Position:  [-2.81955326]


portfolio before change:  [-0.79441619]
curr_Stock_Price:  88.0035896106221
curr_Factors:  [88.00358961 -1.03470504 -1.00482296]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.79441619]
Stock Price:  87.42505189806049
PL:  [-0.79441619]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.02254761e-01 -3.25868479e-02  9.78151991e-02]
 [-1.40594042e-02  9.30311973e-02  1.05324926e-01]
 [-1.71426473e-02 -1.33288715e-01  4.19421736e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.07729667e-01 -2.62545576e-01 -2.39469814e-01]
 [-3.45290560e-02  2.33685640e-02 -4.82793442e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-9.17159677e-02 -4.31310553e-02 -3.99890688e-02]
 [-2.79288794e-02 -7.78067384e-03 -1.24131282e-01]
 [-3.97418994e-01  3.86113283e-01  4.31371530e-02]
 [ 1.11707111e-01 -1.47901247e-01 -3.35888541e-03]
 [-5.33712746e-02  3.33738307e-02  2.34752481e-02]
 [-3.14799900e-02  1.58728534e-01  2.18599065e-02]
 [-5.44069566e-02 -9.39686256e-02 -2.96545361e-02]
 [-1.89296985e-01 -1.31643228e-01  2.54947450e-01]
 [ 3.95634968e-02  9.17633817e-02  1.56488869e-01]
 [-9.17241399e-02  5.34657681e-02  8.08037124e-02]
 [-3.87902217e-02 -2.16636616e-02  2.09666611e-02]
 [-2.65569336e-02  4.93123378e-01  2.51615387e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.13440894]
curr_Stock_Price:  99.98025877396628
curr_Factors:  [99.98025877 -1.01000307 -1.02975302]
mat_Sqrt:  [[13.00347543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02177339 -0.01030487  0.27903954]
Stock Position:  -0.02177338725321333
Bond Position:  [4.31131783]


portfolio before change:  [2.12459845]
curr_Stock_Price:  100.48033970775413
curr_Factors:  [100.48033971  -1.28215697  -1.02940793]
mat_Sqrt:  [[ 9.95820848  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00098833 0.02941905 0.3004627 ]
Stock Position:  0.0009883315461399035
Bond Position:  [2.02529056]


portfolio before change:  [2.12589084]
curr_Stock_Price:  101.27562866423897
curr_Factors:  [101.27562866  -1.46841987  -1.02013827]
mat_Sqrt:  [[ 8.40887468  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00142977 -0.04214959  0.11964935]
Stock Position:  -0.0014297676292298672
Bond Position:  [2.27069146]


portfolio before change:  [2.12594993]
curr_Stock_Price:  101.63139006355865
curr_Factors:  [101.63139006  -1.60252332  -1.04556458]
mat_Sqrt:  [[ 7.19412377  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00527427 -0.00455813 -0.02970002]
Stock Position:  -0.00527427083397703
Bond Position:  [2.66198141]


portfolio before change:  [2.12251853]
curr_Stock_Price:  102.40817534850291
curr_Factors:  [102.40817535  -1.39216377  -1.07411047]
mat_Sqrt:  [[ 8.69451442  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02899175 -0.0830242  -0.68314072]
Stock Position:  0.028991751176166328
Bond Position:  [-0.8464738]


portfolio before change:  [2.08630494]
curr_Stock_Price:  101.16637559110217
curr_Factors:  [101.16637559  -1.31051078  -1.11091292]
mat_Sqrt:  [[ 8.98307939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00487368  0.00738979 -0.13772753]
Stock Position:  -0.004873680867217101
Bond Position:  [2.57935757]


portfolio before change:  [2.08285847]
curr_Stock_Price:  102.0058611673675
curr_Factors:  [102.00586117  -1.42692297  -1.08343493]
mat_Sqrt:  [[ 8.28687032  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00068377 -0.02845143  0.0120735 ]
Stock Position:  -0.0006837676547420574
Bond Position:  [2.15260678]


portfolio before change:  [2.08360231]
curr_Stock_Price:  101.70514339784812
curr_Factors:  [101.7051434   -1.21567787  -1.03639613]
mat_Sqrt:  [[10.69743376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0094408  -0.01363924 -0.11407768]
Stock Position:  -0.009440800806343042
Bond Position:  [3.04378031]


portfolio before change:  [2.07086534]
curr_Stock_Price:  103.13489680022016
curr_Factors:  [103.1348968   -1.49257799  -1.0291631 ]
mat_Sqrt:  [[ 8.28375795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00645455 -0.00246047 -0.354112  ]
Stock Position:  -0.0064545545349977375
Bond Position:  [2.73655515]


portfolio before change:  [2.07189582]
curr_Stock_Price:  103.0812510207166
curr_Factors:  [103.08125102  -1.18946471  -1.0435468 ]
mat_Sqrt:  [[11.05083522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03426386  0.12209974  0.12305829]
Stock Position:  -0.0342638588104155
Bond Position:  [5.60385725]


portfolio before change:  [2.06583411]
curr_Stock_Price:  103.29905632854455
curr_Factors:  [103.29905633  -1.2632971   -1.05666449]
mat_Sqrt:  [[10.15195856  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0105598  -0.04677048 -0.00958197]
Stock Position:  0.010559803535357128
Bond Position:  [0.97501637]


portfolio before change:  [2.06592294]
curr_Stock_Price:  103.28438234411209
curr_Factors:  [103.28438234  -1.35793076  -1.06636567]
mat_Sqrt:  [[ 9.14483959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00521799  0.01055373  0.06696835]
Stock Position:  -0.005217992136965711
Bond Position:  [2.60486004]


portfolio before change:  [2.06858732]
curr_Stock_Price:  102.8985868692719
curr_Factors:  [102.89858687  -1.56364195  -1.03639274]
mat_Sqrt:  [[ 7.64238106  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.002999    0.05019437  0.06236023]
Stock Position:  -0.002999000179008066
Bond Position:  [2.3771802]


portfolio before change:  [2.0686659]
curr_Stock_Price:  103.07057213856646
curr_Factors:  [103.07057214  -1.57277412  -1.0300776 ]
mat_Sqrt:  [[ 7.63362024  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00823809 -0.02971549 -0.08459614]
Stock Position:  -0.00823808638743231
Bond Position:  [2.91777018]


portfolio before change:  [2.06858783]
curr_Stock_Price:  103.1686056347105
curr_Factors:  [103.16860563  -1.45774674  -1.04456886]
mat_Sqrt:  [[ 8.44900765  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01664753 -0.04162924  0.72729411]
Stock Position:  -0.016647525234017385
Bond Position:  [3.78608979]


portfolio before change:  [2.0597167]
curr_Stock_Price:  103.75834895864628
curr_Factors:  [103.75834896  -1.53024129  -1.03663287]
mat_Sqrt:  [[ 7.96606355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00927384 0.02901813 0.44641919]
Stock Position:  0.009273836868425934
Bond Position:  [1.0974787]


portfolio before change:  [2.06891599]
curr_Stock_Price:  104.72072185113662
curr_Factors:  [104.72072185  -1.55998279  -1.04193718]
mat_Sqrt:  [[ 7.76306355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00951295  0.01690736  0.2305105 ]
Stock Position:  -0.009512954580208873
Bond Position:  [3.06511946]


portfolio before change:  [2.06656385]
curr_Stock_Price:  105.04854048223775
curr_Factors:  [105.04854048  -1.62610293  -1.04605571]
mat_Sqrt:  [[ 7.25915834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00483111 -0.00685065  0.05981205]
Stock Position:  -0.004831107361320005
Bond Position:  [2.57406462]


portfolio before change:  [2.06925681]
curr_Stock_Price:  104.62433812902447
curr_Factors:  [104.62433813  -1.53434269  -1.02879501]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.06925681]
Stock Price:  104.28907719109513
PL:  [-2.21982038]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.92910945e-01 -3.16774127e-02  9.34692485e-02]
 [ 1.38943084e-02  7.15992897e-02  7.97787838e-02]
 [-7.90649065e-03 -9.84327290e-02  3.40990422e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 1.83057162e-01 -1.46619436e-01 -1.25802934e-01]
 [-7.81547119e-02  6.55219493e-02  2.77940529e-02]
 [-1.97680882e-02 -5.63793521e-02 -1.34064666e-02]
 [-1.69950628e-02 -1.50321315e-01 -4.73682054e-02]
 [-4.05038507e-01 -2.33758655e-02  5.38135771e-01]
 [-4.78865496e-02  6.88988274e-02 -2.69214862e-02]
 [-1.64638334e-01  2.32669062e-02  6.28007908e-02]
 [ 1.01509194e-01 -3.77742265e-02 -2.15496128e-01]
 [-5.53947389e-02 -3.01039636e-02 -8.93789211e-02]
 [ 2.74961187e-01 -6.93577130e-01  1.53059258e-01]
 [-4.40601869e-03  7.21751546e-02 -1.35517917e-01]
 [-4.41342727e-02  2.24931265e-01  5.00234817e-01]
 [ 5.80293325e-02 -1.81514661e-01 -1.14607055e-01]
 [ 1.86265494e-01  6.32208340e-02  2.36850411e-01]
 [-4.79261100e-02  3.66654472e-01  4.80154941e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.93921431]
curr_Stock_Price:  100.09236721975667
curr_Factors:  [100.09236722  -1.01553948  -1.01232187]
mat_Sqrt:  [[13.17382735  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02084812 -0.01001728  0.26664175]
Stock Position:  -0.020848119101231348
Bond Position:  [5.02595191]


portfolio before change:  [2.93075704]
curr_Stock_Price:  100.5583048733878
curr_Factors:  [100.55830487  -1.19378966  -1.01960826]
mat_Sqrt:  [[10.99389134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00291323 0.02264168 0.22758666]
Stock Position:  0.002913233280581405
Bond Position:  [2.63780724]


portfolio before change:  [2.93305069]
curr_Stock_Price:  101.1192358218998
curr_Factors:  [101.11923582  -1.0567197   -0.99634169]
mat_Sqrt:  [[12.97778422  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00026873 -0.03112716  0.09727508]
Stock Position:  -0.0002687342376345767
Bond Position:  [2.96022489]


portfolio before change:  [2.9337306]
curr_Stock_Price:  101.34338837696642
curr_Factors:  [101.34338838  -0.9803731   -1.03804179]
mat_Sqrt:  [[13.46508098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281794 -0.00455813 -0.02970002]
Stock Position:  -0.0028179375414220413
Bond Position:  [3.21930994]


portfolio before change:  [2.94161801]
curr_Stock_Price:  98.83003494044587
curr_Factors:  [98.83003494 -0.59930957 -1.04654576]
mat_Sqrt:  [[19.05912956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00805871 -0.04636514 -0.35888075]
Stock Position:  0.008058712606823436
Bond Position:  [2.14517516]


portfolio before change:  [2.94437236]
curr_Stock_Price:  99.10526398223915
curr_Factors:  [99.10526398 -0.44973799 -1.03533836]
mat_Sqrt:  [[22.44586052  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00315379  0.02071986  0.0792887 ]
Stock Position:  -0.0031537888713509227
Bond Position:  [3.25692944]


portfolio before change:  [2.94197195]
curr_Stock_Price:  100.1245915771031
curr_Factors:  [100.12459158  -0.14298416  -1.00499272]
mat_Sqrt:  [[31.76733142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00075425 -0.01782872 -0.03824492]
Stock Position:  -0.0007542459287740126
Bond Position:  [3.01749051]


portfolio before change:  [2.94301987]
curr_Stock_Price:  99.73551910159985
curr_Factors:  [99.7355191   0.14166016 -1.02510449]
mat_Sqrt:  [[41.22634711  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00074092 -0.04753577 -0.13512831]
Stock Position:  -0.0007409178603786557
Bond Position:  [3.0169157]


portfolio before change:  [2.94874083]
curr_Stock_Price:  93.03216128844203
curr_Factors:  [ 9.30321613e+01  2.51695435e-02 -1.02052581e+00]
mat_Sqrt:  [[34.38391917  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00860273 -0.0073921   1.53515157]
Stock Position:  -0.00860272977649271
Bond Position:  [3.74907138]


portfolio before change:  [2.97510043]
curr_Stock_Price:  90.07702794244952
curr_Factors:  [90.07702794  0.22308235 -0.97370899]
mat_Sqrt:  [[42.52272031  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00121354  0.02178772 -0.07679951]
Stock Position:  -0.00121353748169564
Bond Position:  [3.08441228]


portfolio before change:  [2.97494031]
curr_Stock_Price:  90.84447043364565
curr_Factors:  [ 9.08444704e+01  5.03155256e-02 -9.99823411e-01]
mat_Sqrt:  [[35.15057733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430202  0.00735764  0.17915318]
Stock Position:  -0.004302018301788684
Bond Position:  [3.36575488]


portfolio before change:  [2.97325724]
curr_Stock_Price:  91.43131548719815
curr_Factors:  [91.43131549  0.19826997 -0.9734601 ]
mat_Sqrt:  [[42.11474483  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00134266 -0.01194526 -0.61475047]
Stock Position:  0.0013426628713738206
Bond Position:  [2.8504958]


portfolio before change:  [2.96468183]
curr_Stock_Price:  84.51363025455957
curr_Factors:  [84.51363025  0.26581635 -1.01377052]
mat_Sqrt:  [[40.0031684   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00186026 -0.00951971 -0.25497318]
Stock Position:  -0.001860263043527653
Bond Position:  [3.12189941]


portfolio before change:  [2.96602413]
curr_Stock_Price:  84.21166634169491
curr_Factors:  [ 8.42116663e+01  6.76029938e-03 -9.79140257e-01]
mat_Sqrt:  [[31.84732876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00905245 -0.21932835  0.43663546]
Stock Position:  0.009052445015225197
Bond Position:  [2.20370266]


portfolio before change:  [2.98633068]
curr_Stock_Price:  86.39401112465872
curr_Factors:  [ 8.63940111e+01  4.21818744e-02 -1.01466670e+00]
mat_Sqrt:  [[32.66922605  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00092457  0.02282379 -0.3865949 ]
Stock Position:  -0.0009245686812579849
Bond Position:  [3.06620788]


portfolio before change:  [2.98881233]
curr_Stock_Price:  84.53909364824034
curr_Factors:  [84.53909365 -0.11381115 -1.03846658]
mat_Sqrt:  [[26.70728423  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00238824 0.07112951 1.42703069]
Stock Position:  0.002388241027085147
Bond Position:  [2.7869126]


portfolio before change:  [2.99829771]
curr_Stock_Price:  88.21902399375213
curr_Factors:  [88.21902399 -0.6507349  -1.04361891]
mat_Sqrt:  [[16.20741443  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00184783 -0.05739998 -0.32694203]
Stock Position:  0.0018478318753956018
Bond Position:  [2.83528378]


portfolio before change:  [2.99972147]
curr_Stock_Price:  88.6058869383681
curr_Factors:  [88.60588694 -0.68971431 -1.05932463]
mat_Sqrt:  [[15.41219935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01532842 0.01999218 0.6756683 ]
Stock Position:  0.015328424632092674
Bond Position:  [1.64153281]


portfolio before change:  [3.02636397]
curr_Stock_Price:  90.31722113023369
curr_Factors:  [90.31722113 -1.01754095 -1.06445469]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.02636397]
Stock Price:  89.22479565257694
PL:  [3.02636397]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.26127673e-01 -7.47845490e-02  1.75920868e-01]
 [-8.22159488e-02  1.28881336e-01  9.56471038e-02]
 [-1.19799849e-01 -5.02572055e-01 -1.31058895e-02]
 [-2.51473290e-02  1.00270280e-01  6.59510314e-02]
 [ 6.81601665e-01 -3.70116350e-01 -1.25036689e-01]
 [-1.21824217e-01  7.64448388e-02  3.10998559e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 3.37214679e-01  2.85549466e-02  3.32597746e-03]
 [-1.15234467e-01  2.02302647e-02  1.02177874e-01]
 [-2.09786609e-01  1.92625237e-01  6.23830369e-03]
 [ 5.81123908e-02 -1.16836024e-01  2.93633752e-03]
 [ 6.30677605e-02  9.84167457e-02  1.48068778e-02]
 [-1.37376646e-03  1.58649885e-01  5.71391145e-02]
 [-1.86166885e-03 -1.69510166e-01 -7.06430353e-02]
 [-1.37348260e-01 -9.71602223e-02  2.00959510e-01]
 [ 1.56642607e-02  1.34315629e-01  2.06186874e-01]
 [-5.13740343e-02  1.13856635e-01  2.07638191e-02]
 [-4.78384955e-02 -4.82158306e-02  2.17553859e-02]
 [-3.59039367e-02  4.49577575e-01  1.87346792e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.32694771]
curr_Stock_Price:  98.80160170582057
curr_Factors:  [98.80160171 -1.41700245 -0.97626528]
mat_Sqrt:  [[ 9.02362454  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01021196 -0.02364895  0.50185327]
Stock Position:  -0.010211961353116783
Bond Position:  [-5.31798957]


portfolio before change:  [-6.33812065]
curr_Stock_Price:  99.76549907235234
curr_Factors:  [99.76549907 -1.39743981 -0.99766884]
mat_Sqrt:  [[ 9.09489961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00652721  0.04075586  0.27285456]
Stock Position:  -0.006527214839055304
Bond Position:  [-5.68692981]


portfolio before change:  [-6.33486135]
curr_Stock_Price:  99.04831552854581
curr_Factors:  [99.04831553 -1.30789969 -1.01596885]
mat_Sqrt:  [[ 9.69625012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01396947 -0.15892724 -0.03738745]
Stock Position:  -0.013969465604421024
Bond Position:  [-4.95120932]


portfolio before change:  [-6.32821921]
curr_Stock_Price:  98.48422075545321
curr_Factors:  [98.48422076 -1.43059547 -1.03827549]
mat_Sqrt:  [[ 8.33968441  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109071  0.03170825  0.18813994]
Stock Position:  -0.0010907083720161613
Bond Position:  [-6.22080164]


portfolio before change:  [-6.32902487]
curr_Stock_Price:  97.79684440589679
curr_Factors:  [97.79684441 -1.4670269  -1.03597494]
mat_Sqrt:  [[ 8.00359221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08077901 -0.11704107 -0.35669487]
Stock Position:  0.08077901494094265
Bond Position:  [-14.22895763]


portfolio before change:  [-6.37509982]
curr_Stock_Price:  97.27050402926912
curr_Factors:  [97.27050403 -0.96961398 -1.01662797]
mat_Sqrt:  [[13.34649567  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00850427  0.02417398  0.08871923]
Stock Position:  -0.00850426889285003
Bond Position:  [-5.54788529]


portfolio before change:  [-6.36924608]
curr_Stock_Price:  96.41906374084925
curr_Factors:  [96.41906374 -0.96039617 -1.02777321]
mat_Sqrt:  [[13.20419475  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042913 -0.02845143  0.0120735 ]
Stock Position:  -0.0004291283183624776
Bond Position:  [-6.32786993]


portfolio before change:  [-6.37096285]
curr_Stock_Price:  96.7327364052334
curr_Factors:  [96.73273641 -0.61350397 -1.06763979]
mat_Sqrt:  [[18.00785622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01880462 0.00902987 0.00948809]
Stock Position:  0.01880461907821372
Bond Position:  [-8.18998512]


portfolio before change:  [-6.33374348]
curr_Stock_Price:  98.82090049217148
curr_Factors:  [98.82090049 -1.1812523  -1.06159649]
mat_Sqrt:  [[10.49039776  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00894677  0.00639737  0.29148503]
Stock Position:  -0.008946767782748654
Bond Position:  [-5.44961583]


portfolio before change:  [-6.34155859]
curr_Stock_Price:  99.54211490128625
curr_Factors:  [99.5421149  -1.04585326 -1.03850458]
mat_Sqrt:  [[12.38174208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01643869  0.06091345  0.01779614]
Stock Position:  -0.01643869315284214
Bond Position:  [-4.70521631]


portfolio before change:  [-6.34715878]
curr_Stock_Price:  99.8112201669204
curr_Factors:  [99.81122017 -0.89796577 -1.04431557]
mat_Sqrt:  [[14.31058195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00389188 -0.03694679  0.00837655]
Stock Position:  0.003891880513837191
Bond Position:  [-6.73561212]


portfolio before change:  [-6.35101378]
curr_Stock_Price:  99.25342150194838
curr_Factors:  [99.2534215  -0.9355636  -1.06025135]
mat_Sqrt:  [[13.48882338  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00508801 0.03112211 0.0422399 ]
Stock Position:  0.005088013184995253
Bond Position:  [-6.8560165]


portfolio before change:  [-6.35133672]
curr_Stock_Price:  99.52686364004947
curr_Factors:  [99.52686364 -1.17138006 -1.088904  ]
mat_Sqrt:  [[10.38272676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00138557 0.0501695  0.16300199]
Stock Position:  0.0013855732906555807
Bond Position:  [-6.48923848]


portfolio before change:  [-6.35311509]
curr_Stock_Price:  99.41437483376274
curr_Factors:  [99.41437483 -1.39711186 -1.06805545]
mat_Sqrt:  [[ 8.44968712  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244487 -0.05360382 -0.20152492]
Stock Position:  -0.002444865874925283
Bond Position:  [-6.11006028]


portfolio before change:  [-6.35520428]
curr_Stock_Price:  99.64403295659767
curr_Factors:  [99.64403296 -1.13857309 -1.08133643]
mat_Sqrt:  [[10.82322889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00913186 -0.03072476  0.57328154]
Stock Position:  -0.009131862495379329
Bond Position:  [-5.44526868]


portfolio before change:  [-6.35824819]
curr_Stock_Price:  99.82826937122515
curr_Factors:  [99.82826937 -1.39549356 -1.09093338]
mat_Sqrt:  [[ 8.30638472  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00737023 0.04247433 0.58819376]
Stock Position:  0.007370233486413352
Bond Position:  [-7.09400585]


portfolio before change:  [-6.35348128]
curr_Stock_Price:  100.71570886160947
curr_Factors:  [100.71570886  -1.81609622  -1.08480969]
mat_Sqrt:  [[ 5.53668463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00798237  0.03600463  0.0592334 ]
Stock Position:  -0.007982371178976436
Bond Position:  [-5.54953111]


portfolio before change:  [-6.36047057]
curr_Stock_Price:  101.41747258363952
curr_Factors:  [101.41747258  -1.69513255  -1.10238871]
mat_Sqrt:  [[ 6.18250875  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00722079 -0.01524718  0.06206206]
Stock Position:  -0.007220794195379223
Bond Position:  [-5.62815588]


portfolio before change:  [-6.36424718]
curr_Stock_Price:  101.74560782354004
curr_Factors:  [101.74560782  -1.61286089  -1.06729064]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.36424718]
Stock Price:  102.08486662445094
PL:  [-8.44911381]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.97991762e-01 -5.64699557e-02  1.41093778e-01]
 [ 8.06366283e-02  1.25744778e-02 -1.56684284e-02]
 [-4.03250871e-02 -2.40209701e-01  4.10659563e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 2.34565727e-01 -1.78657762e-01 -1.34097520e-01]
 [ 5.80334619e-02  2.11646771e-02 -9.72325390e-03]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [-2.64054077e-02  2.96069713e-02 -1.12161496e-02]
 [-1.42978462e-01  1.27804952e-01 -1.68482103e-02]
 [ 7.67183036e-02 -1.27583101e-01  4.57139812e-04]
 [ 7.90179947e-02  1.03244324e-01  1.83119875e-04]
 [-2.40932171e-02  1.84900037e-01  4.06733405e-02]
 [-5.11963713e-02 -4.49892053e-02 -3.69245775e-02]
 [-1.64640834e-01 -1.18567902e-01  2.38498369e-01]
 [ 1.28440351e-02  7.25575510e-02  7.66127594e-02]
 [-1.42457411e-01  2.92755390e-03  8.17501332e-02]
 [-4.70126371e-02 -4.60278782e-02  2.18321633e-02]
 [-2.12475747e-02  5.74542592e-01  2.85815751e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.60047744]
curr_Stock_Price:  99.32069464820043
curr_Factors:  [99.32069465 -0.88446151 -0.98602725]
mat_Sqrt:  [[15.30018924  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0111534  -0.01785737  0.40250128]
Stock Position:  -0.0111534021119822
Bond Position:  [-1.4927138]


portfolio before change:  [-2.61954733]
curr_Stock_Price:  100.99701435735531
curr_Factors:  [100.99701436  -0.56252118  -1.02576283]
mat_Sqrt:  [[20.63125057  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00376918  0.0039764  -0.04469766]
Stock Position:  0.0037691847667026784
Bond Position:  [-3.00022374]


portfolio before change:  [-2.62511388]
curr_Stock_Price:  99.71918048290559
curr_Factors:  [99.71918048 -0.78221799 -1.00370911]
mat_Sqrt:  [[16.71707969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00228178 -0.07596098  0.11714974]
Stock Position:  -0.0022817814105721085
Bond Position:  [-2.3975765]


portfolio before change:  [-2.62356856]
curr_Stock_Price:  98.77921837769478
curr_Factors:  [98.77921838 -0.52502963 -0.9903564 ]
mat_Sqrt:  [[21.70410076  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174823 -0.00455813 -0.02970002]
Stock Position:  -0.0017482298672103058
Bond Position:  [-2.45087978]


portfolio before change:  [-2.62599022]
curr_Stock_Price:  99.81390061830083
curr_Factors:  [99.81390062 -0.472648   -1.04986565]
mat_Sqrt:  [[21.77568134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00930305 -0.05649654 -0.3825429 ]
Stock Position:  0.009303050436823782
Bond Position:  [-3.55456397]


portfolio before change:  [-2.62326945]
curr_Stock_Price:  100.20189355603668
curr_Factors:  [100.20189356  -0.78585353  -1.0591837 ]
mat_Sqrt:  [[15.83384681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00357432  0.00669286 -0.02773774]
Stock Position:  0.0035743165420480017
Bond Position:  [-2.98142274]


portfolio before change:  [-2.61919217]
curr_Stock_Price:  101.55116769454276
curr_Factors:  [101.55116769  -0.90079773  -1.07844231]
mat_Sqrt:  [[14.0317517   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00040382 -0.02845143  0.0120735 ]
Stock Position:  -0.00040381942394718625
Bond Position:  [-2.57818383]


portfolio before change:  [-2.62005125]
curr_Stock_Price:  102.0822343125777
curr_Factors:  [102.08223431  -0.66332613  -1.07456658]
mat_Sqrt:  [[17.95531183  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00777404 -0.01496598 -0.14840805]
Stock Position:  -0.007774041212944218
Bond Position:  [-1.82645975]


portfolio before change:  [-2.60658721]
curr_Stock_Price:  100.29156798551111
curr_Factors:  [100.29156799  -0.46971381  -1.11127228]
mat_Sqrt:  [[20.63720553  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013534   0.00936255 -0.03199655]
Stock Position:  -0.00135340251931727
Bond Position:  [-2.47085234]


portfolio before change:  [-2.60612667]
curr_Stock_Price:  99.49481940598695
curr_Factors:  [99.49481941 -0.53202571 -1.06326906]
mat_Sqrt:  [[20.18239743  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00709121  0.04041547 -0.04806325]
Stock Position:  -0.007091213006823676
Bond Position:  [-1.90058772]


portfolio before change:  [-2.60678228]
curr_Stock_Price:  99.52025962540583
curr_Factors:  [99.52025963 -0.4158126  -1.02414386]
mat_Sqrt:  [[23.58013863  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00311777 -0.04034532  0.00130409]
Stock Position:  0.003117769429099082
Bond Position:  [-2.91706351]


portfolio before change:  [-2.60960667]
curr_Stock_Price:  98.84829387228737
curr_Factors:  [98.84829387 -0.29926173 -0.9992518 ]
mat_Sqrt:  [[26.97937686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00302902 0.03264872 0.00052239]
Stock Position:  0.003029022177678019
Bond Position:  [-2.90902035]


portfolio before change:  [-2.60547716]
curr_Stock_Price:  100.45173631645075
curr_Factors:  [100.45173632  -0.24793733  -1.00003893]
mat_Sqrt:  [[28.83820633  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00038202  0.05847053  0.11602972]
Stock Position:  -0.0003820177887647382
Bond Position:  [-2.56710281]


portfolio before change:  [-2.60568412]
curr_Stock_Price:  99.31332061150516
curr_Factors:  [99.31332061 -0.25915403 -1.04209015]
mat_Sqrt:  [[27.03238317  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221568 -0.01422684 -0.10533554]
Stock Position:  -0.002215682762143409
Bond Position:  [-2.38563731]


portfolio before change:  [-2.61054143]
curr_Stock_Price:  101.2363524928666
curr_Factors:  [101.23635249  -0.32478762  -1.03103798]
mat_Sqrt:  [[26.0920929   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0045615  -0.03749446  0.68036946]
Stock Position:  -0.00456149566038944
Bond Position:  [-2.14875225]


portfolio before change:  [-2.61488381]
curr_Stock_Price:  102.07053540928295
curr_Factors:  [102.07053541  -0.52103016  -1.0535094 ]
mat_Sqrt:  [[21.13910274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00143601 0.02294471 0.21855488]
Stock Position:  0.0014360106683033009
Bond Position:  [-2.76145819]


portfolio before change:  [-2.61443233]
curr_Stock_Price:  102.86574583137588
curr_Factors:  [102.86574583  -0.38211667  -1.04434477]
mat_Sqrt:  [[24.70395287  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00508804  0.00092577  0.23321038]
Stock Position:  -0.0050880378031174815
Bond Position:  [-2.09104752]


portfolio before change:  [-2.60589829]
curr_Stock_Price:  101.0857143041368
curr_Factors:  [101.0857143   -0.15898791  -1.10587639]
mat_Sqrt:  [[28.53423284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00153306 -0.01455529  0.06228108]
Stock Position:  -0.001533056815311605
Bond Position:  [-2.45092814]


portfolio before change:  [-2.60299762]
curr_Stock_Price:  98.79390184315325
curr_Factors:  [98.79390184 -0.15175145 -1.02690388]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.60299762]
Stock Price:  96.70001941690673
PL:  [-2.60299762]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.64537366e-01 -7.21632654e-02  1.76635325e-01]
 [-2.99312611e-01  2.43073531e-01  6.48206733e-02]
 [-2.15195926e-01 -6.34135018e-01 -9.25597180e-02]
 [-7.41839200e-03  2.24046292e-01  1.73010020e-01]
 [ 5.02236407e-01 -2.58511090e-01 -9.33287045e-02]
 [-1.10130956e-01  7.39970824e-02  2.17539613e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 3.74141395e-01  3.05290163e-02  2.59041207e-02]
 [-1.53336459e-01  1.45161662e-02  1.59398986e-01]
 [-1.73065017e-01  1.49878113e-01 -1.62412041e-02]
 [-3.10504527e-02 -6.38930170e-02  3.53071262e-03]
 [ 1.02777668e-01  1.10930312e-01 -2.34087889e-02]
 [ 1.44799806e-02  1.64214434e-01  7.78910528e-02]
 [ 8.55732954e-02 -1.50662166e-01  5.44708968e-02]
 [-9.44729473e-02 -6.87328609e-02  1.56492620e-01]
 [-9.36919518e-03  1.58012515e-01  2.50568104e-01]
 [-5.01504064e-02  1.15275406e-01  2.44519911e-02]
 [-3.90252011e-02 -4.29844273e-02  3.40183013e-02]
 [-2.22909071e-02  5.68311485e-01  2.71787581e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.29508392]
curr_Stock_Price:  99.08463795051625
curr_Factors:  [99.08463795 -1.09321702 -0.95267042]
mat_Sqrt:  [[12.80821771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01017668 -0.02282003  0.50389142]
Stock Position:  -0.01017667573349879
Bond Position:  [-3.28673169]


portfolio before change:  [-4.29082658]
curr_Stock_Price:  98.58554309507294
curr_Factors:  [98.5855431 -0.8884213 -0.9635211]
mat_Sqrt:  [[15.47123085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0180855   0.0768666   0.18491534]
Stock Position:  -0.018085504463927014
Bond Position:  [-2.5078573]


portfolio before change:  [-4.27567482]
curr_Stock_Price:  97.71308745391096
curr_Factors:  [97.71308745 -1.01444125 -0.9494851 ]
mat_Sqrt:  [[13.70977595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01826893 -0.2005311  -0.26404711]
Stock Position:  -0.018268926944969555
Bond Position:  [-2.49056157]


portfolio before change:  [-4.27001412]
curr_Stock_Price:  97.36914727534376
curr_Factors:  [97.36914728 -1.12228884 -0.92453727]
mat_Sqrt:  [[12.57465509  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00267856 0.07084966 0.49354943]
Stock Position:  0.0026785610026944977
Bond Position:  [-4.53082333]


portfolio before change:  [-4.2735648]
curr_Stock_Price:  96.46648929602705
curr_Factors:  [96.4664893  -1.32499864 -0.92408382]
mat_Sqrt:  [[10.17682662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04682315 -0.08174838 -0.26624082]
Stock Position:  0.04682314583347202
Bond Position:  [-8.79042929]


portfolio before change:  [-4.19900703]
curr_Stock_Price:  98.10575649776489
curr_Factors:  [98.1057565  -1.68672209 -0.92214464]
mat_Sqrt:  [[ 7.22234224  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01436928  0.02339993  0.062058  ]
Stock Position:  -0.014369279088720334
Bond Position:  [-2.78929804]


portfolio before change:  [-4.19366067]
curr_Stock_Price:  97.68515245317421
curr_Factors:  [97.68515245 -1.44997424 -0.98048717]
mat_Sqrt:  [[ 8.59592425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00065918 -0.02845143  0.0120735 ]
Stock Position:  -0.0006591837858147132
Bond Position:  [-4.1292682]


portfolio before change:  [-4.19520181]
curr_Stock_Price:  98.45685719173471
curr_Factors:  [98.45685719 -1.79361603 -0.96230777]
mat_Sqrt:  [[ 6.25696135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06076709 0.00965412 0.07389725]
Stock Position:  0.06076708570671315
Bond Position:  [-10.17813809]


portfolio before change:  [-4.20191946]
curr_Stock_Price:  98.38818848401019
curr_Factors:  [98.38818848 -1.59841352 -0.98346865]
mat_Sqrt:  [[ 7.4412481   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01618337  0.00459041  0.45472094]
Stock Position:  -0.016183370005130367
Bond Position:  [-2.609667]


portfolio before change:  [-4.1901671]
curr_Stock_Price:  97.62167002644198
curr_Factors:  [97.62167003 -1.40756698 -0.98825102]
mat_Sqrt:  [[ 8.89315166  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01939812  0.04739562 -0.04633163]
Stock Position:  -0.019398117668960494
Bond Position:  [-2.29649046]


portfolio before change:  [-4.1896568]
curr_Stock_Price:  97.56576262200899
curr_Factors:  [97.56576262 -1.066632   -0.96630525]
mat_Sqrt:  [[12.77626802  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00250304 -0.02020475  0.01007214]
Stock Position:  -0.002503036066306373
Bond Position:  [-3.94544618]


portfolio before change:  [-4.19076704]
curr_Stock_Price:  97.61520593060459
curr_Factors:  [97.61520593 -0.89775887 -0.92975394]
mat_Sqrt:  [[15.6977984   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00642533  0.03507924 -0.06677876]
Stock Position:  0.006425332710406961
Bond Position:  [-4.81797722]


portfolio before change:  [-4.19325688]
curr_Stock_Price:  97.41518650454954
curr_Factors:  [97.4151865  -0.46842705 -0.93842195]
mat_Sqrt:  [[23.85832254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00145104 0.05192916 0.22220149]
Stock Position:  0.0014510418147046858
Bond Position:  [-4.33461039]


portfolio before change:  [-4.19647427]
curr_Stock_Price:  95.94478997519835
curr_Factors:  [95.94478998 -0.74791253 -0.96402737]
mat_Sqrt:  [[17.31949974  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00535824 -0.04764356  0.15539031]
Stock Position:  0.005358240226931733
Bond Position:  [-4.71056951]


portfolio before change:  [-4.19539733]
curr_Stock_Price:  96.36558739436887
curr_Factors:  [96.36558739 -0.83716996 -0.94989088]
mat_Sqrt:  [[16.13657307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00398497 -0.02173524  0.44642989]
Stock Position:  -0.00398496629028114
Bond Position:  [-3.81138371]


portfolio before change:  [-4.19506306]
curr_Stock_Price:  96.04256499855838
curr_Factors:  [96.042565   -0.50803093 -0.95854525]
mat_Sqrt:  [[22.15836987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00206954 0.04996794 0.71480106]
Stock Position:  0.0020695416998009358
Bond Position:  [-4.39382716]


portfolio before change:  [-4.19486236]
curr_Stock_Price:  96.67038199840668
curr_Factors:  [96.670382   -0.60892923 -0.99215804]
mat_Sqrt:  [[19.49620431  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00216364  0.03645328  0.06975472]
Stock Position:  -0.002163639945796092
Bond Position:  [-3.98570246]


portfolio before change:  [-4.19965699]
curr_Stock_Price:  98.42579486677822
curr_Factors:  [98.42579487 -0.43254434 -0.93738218]
mat_Sqrt:  [[25.01251722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132698 -0.01359287  0.09704474]
Stock Position:  -0.0013269794999554367
Bond Position:  [-4.06904798]


portfolio before change:  [-4.19941921]
curr_Stock_Price:  97.4799078109045
curr_Factors:  [97.47990781 -0.12204626 -0.95466398]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.19941921]
Stock Price:  97.38794054487866
PL:  [-4.19941921]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.91554628e-01 -3.15454022e-02  9.28384052e-02]
 [ 6.18319457e-02  3.43723656e-02  3.38928124e-02]
 [-2.06314694e-02 -1.67503072e-01  3.68722049e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.53720839e-01 -2.99082436e-01 -2.69746372e-01]
 [-4.90362864e-02 -1.13890032e-01 -1.35725636e-01]
 [ 1.01386954e-02 -8.10095685e-02  5.15025205e-04]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [-6.76803967e-02 -3.13879211e-02 -1.29664132e-01]
 [-4.43786774e-01  4.32050209e-01  3.90031602e-02]
 [ 1.13798117e-01 -1.63390478e-01  1.54903319e-02]
 [-4.07226049e-02  4.02494692e-02  2.90236367e-02]
 [-6.02591073e-02  1.69947326e-01 -7.54240108e-03]
 [-1.25487999e-01 -3.55164264e-02  1.80646282e-01]
 [-1.26188915e-01 -1.09287913e-01  2.43821170e-01]
 [ 1.91446741e-02  5.97793064e-02  6.40848051e-02]
 [-9.89711988e-02  4.53131034e-02  8.20713340e-02]
 [-3.81432197e-02 -1.89579912e-02  2.04005162e-02]
 [-1.74410214e-02  5.28874983e-01  3.09877163e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.56596994]
curr_Stock_Price:  100.04037471516045
curr_Factors:  [100.04037472  -0.87373852  -1.004363  ]
mat_Sqrt:  [[15.29417952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0178773  -0.00997553  0.26484213]
Stock Position:  -0.017877295530484397
Bond Position:  [4.35442128]


portfolio before change:  [2.54396269]
curr_Stock_Price:  101.33229177413197
curr_Factors:  [101.33229177  -0.97864583  -0.99539906]
mat_Sqrt:  [[14.07443796  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00494782 0.0108695  0.09668676]
Stock Position:  0.004947819437566418
Bond Position:  [2.04258881]


portfolio before change:  [2.53983519]
curr_Stock_Price:  100.39486516163358
curr_Factors:  [100.39486516  -0.8853469   -0.99997233]
mat_Sqrt:  [[15.23799288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00114384 -0.05296912  0.10518614]
Stock Position:  -0.0011438430863154304
Bond Position:  [2.65467116]


portfolio before change:  [2.53713001]
curr_Stock_Price:  103.34014110287698
curr_Factors:  [103.3401411   -1.39210396  -1.01195527]
mat_Sqrt:  [[ 9.33682874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00406388 -0.00455813 -0.02970002]
Stock Position:  -0.004063880601702503
Bond Position:  [2.957092]


portfolio before change:  [2.53942447]
curr_Stock_Price:  102.957476827609
curr_Factors:  [102.95747683  -1.27905468  -1.0089991 ]
mat_Sqrt:  [[10.44645064  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0278503  -0.09457817 -0.76951132]
Stock Position:  0.027850303045647038
Bond Position:  [-0.32797246]


portfolio before change:  [2.56953313]
curr_Stock_Price:  104.04151039862997
curr_Factors:  [104.0415104   -1.41174948  -1.04333379]
mat_Sqrt:  [[ 8.93259272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00892034 -0.03601519 -0.38718746]
Stock Position:  -0.008920343334357119
Bond Position:  [3.49761913]


portfolio before change:  [2.5672289]
curr_Stock_Price:  104.39785801035062
curr_Factors:  [104.39785801  -1.42045039  -1.05488137]
mat_Sqrt:  [[ 8.78352137  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00092812 -0.02561747  0.00146922]
Stock Position:  0.0009281205191694773
Bond Position:  [2.47033511]


portfolio before change:  [2.56702407]
curr_Stock_Price:  103.5116656160188
curr_Factors:  [103.51166562  -1.0199175   -1.0375259 ]
mat_Sqrt:  [[13.22674504  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01055326 -0.01496598 -0.14840805]
Stock Position:  -0.010553264145721466
Bond Position:  [3.65941002]


portfolio before change:  [2.55983257]
curr_Stock_Price:  104.2798131184541
curr_Factors:  [104.27981312  -1.21159592  -1.09505796]
mat_Sqrt:  [[10.38563827  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00914324 -0.00992573 -0.36989568]
Stock Position:  -0.0091432425340639
Bond Position:  [3.5132882]


portfolio before change:  [2.56223955]
curr_Stock_Price:  104.11263620071203
curr_Factors:  [104.1126362   -1.08076297  -1.1311716 ]
mat_Sqrt:  [[11.39914986  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03725451  0.13662627  0.11126516]
Stock Position:  -0.0372545149905057
Bond Position:  [6.44090531]


portfolio before change:  [2.60477673]
curr_Stock_Price:  103.01406438804656
curr_Factors:  [103.01406439  -0.64167686  -1.10930887]
mat_Sqrt:  [[17.88352319  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0063042  -0.05166861  0.04418961]
Stock Position:  0.0063042020608639416
Bond Position:  [1.95535526]


portfolio before change:  [2.60697215]
curr_Stock_Price:  103.28475964912677
curr_Factors:  [103.28475965  -0.71589812  -1.13962701]
mat_Sqrt:  [[16.150721    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209024  0.012728    0.08279636]
Stock Position:  -0.0020902437114717243
Bond Position:  [2.82286247]


portfolio before change:  [2.60715676]
curr_Stock_Price:  103.53410760936943
curr_Factors:  [103.53410761  -0.6270912   -1.17979192]
mat_Sqrt:  [[16.99667914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337776  0.05374206 -0.02151637]
Stock Position:  -0.003377758204338812
Bond Position:  [2.95686994]


portfolio before change:  [2.60280883]
curr_Stock_Price:  105.04020509205293
curr_Factors:  [105.04020509  -0.65762706  -1.21875672]
mat_Sqrt:  [[16.08616218  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0055657  -0.01123128  0.51533356]
Stock Position:  -0.00556570054548059
Bond Position:  [3.18743116]


portfolio before change:  [2.59873461]
curr_Stock_Price:  105.91541912877388
curr_Factors:  [105.91541913  -0.68306172  -1.21599487]
mat_Sqrt:  [[15.85657514  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00499735 -0.03455987  0.69555393]
Stock Position:  -0.004997354606782597
Bond Position:  [3.12803152]


portfolio before change:  [2.60949781]
curr_Stock_Price:  103.91814297616504
curr_Factors:  [103.91814298  -1.07790926  -1.20649286]
mat_Sqrt:  [[10.58249665  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00319106 0.01890388 0.18281611]
Stock Position:  0.0031910641103292292
Bond Position:  [2.27788836]


portfolio before change:  [2.61218282]
curr_Stock_Price:  104.58107704711306
curr_Factors:  [104.58107705  -1.15372654  -1.21015898]
mat_Sqrt:  [[ 9.83627521  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00823975  0.01432926  0.23412667]
Stock Position:  -0.008239753042423033
Bond Position:  [3.47390507]


portfolio before change:  [2.60707997]
curr_Stock_Price:  105.30578784958425
curr_Factors:  [105.30578785  -1.0374653   -1.20844661]
mat_Sqrt:  [[11.14461555  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309284 -0.00599504  0.05819699]
Stock Position:  -0.0030928366150545215
Bond Position:  [2.93277357]


portfolio before change:  [2.60948685]
curr_Stock_Price:  104.76466799046263
curr_Factors:  [104.76466799  -0.91130378  -1.18338602]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.60948685]
Stock Price:  105.071065370521
PL:  [-2.46157852]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [ 8.15315678e-02 -1.33869722e-01  2.69434473e-02]
 [-1.02680607e-01  1.39645685e-01  9.27412445e-02]
 [-4.89278429e-02 -2.79714027e-01  4.40640569e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.33495376e-01 -2.29897861e-01 -1.41376176e-01]
 [ 4.00892893e-02  2.77073694e-02  5.16177365e-03]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 1.24937699e-01 -9.34868142e-03 -3.53199641e-03]
 [-4.11377616e-02  2.80518388e-02  7.59031873e-03]
 [-2.44044684e-01  2.29986013e-01  1.10560119e-02]
 [ 6.60911749e-02 -1.21518405e-01  2.45043149e-03]
 [ 9.95954149e-03  7.52132678e-02  4.54363466e-02]
 [-1.92986990e-02  1.68724609e-01  4.00233049e-02]
 [-4.56306243e-02 -1.01081552e-01 -5.18018324e-02]
 [-1.40868206e-01 -9.97758523e-02  2.05395766e-01]
 [ 3.46875730e-02  8.58061961e-02  1.32238546e-01]
 [-1.52893737e-01 -7.30361959e-03  8.17446200e-02]
 [-4.97169542e-02 -5.41669981e-02  2.21963027e-02]
 [-2.20173029e-02  5.66224592e-01  2.86038221e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.82118318]
curr_Stock_Price:  98.17555996994774
curr_Factors:  [98.17555997 -1.07484336 -0.97246343]
mat_Sqrt:  [[12.67270558  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00659487 -0.04233332  0.07686216]
Stock Position:  0.006594872268389461
Bond Position:  [-11.46863846]


portfolio before change:  [-10.81543937]
curr_Stock_Price:  99.48132141049429
curr_Factors:  [99.48132141 -1.34510448 -1.02435063]
mat_Sqrt:  [[ 9.30465483  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00861335  0.04415984  0.26456496]
Stock Position:  -0.008613349426954669
Bond Position:  [-9.95857198]


portfolio before change:  [-10.8223881]
curr_Stock_Price:  99.99898043259033
curr_Factors:  [99.99898043 -1.05877635 -1.05378485]
mat_Sqrt:  [[12.09266152  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00389951 -0.08845334  0.12570249]
Stock Position:  -0.0038995129438451014
Bond Position:  [-10.43244078]


portfolio before change:  [-10.8250984]
curr_Stock_Price:  100.02510284903767
curr_Factors:  [100.02510285  -0.87552006  -1.09131027]
mat_Sqrt:  [[13.99347093  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00271153 -0.00455813 -0.02970002]
Stock Position:  -0.0027115329273743644
Bond Position:  [-10.55387704]


portfolio before change:  [-10.82880114]
curr_Stock_Price:  100.41748020225862
curr_Factors:  [100.4174802   -0.66292863  -1.11458925]
mat_Sqrt:  [[16.97630277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01759518 -0.07270009 -0.40330688]
Stock Position:  0.01759518263774698
Bond Position:  [-12.59566505]


portfolio before change:  [-10.83952574]
curr_Stock_Price:  99.9869481681949
curr_Factors:  [99.98694817 -0.68846673 -1.06726458]
mat_Sqrt:  [[17.27582889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00242294 0.00876184 0.0147251 ]
Stock Position:  0.0024229420992109237
Bond Position:  [-11.08178833]


portfolio before change:  [-10.84471551]
curr_Stock_Price:  98.98858548203785
curr_Factors:  [98.98858548 -0.72378165 -1.0348493 ]
mat_Sqrt:  [[17.05380937  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033226 -0.02845143  0.0120735 ]
Stock Position:  -0.0003322597177832364
Bond Position:  [-10.81182559]


portfolio before change:  [-10.84729277]
curr_Stock_Price:  98.60925864433558
curr_Factors:  [98.60925864 -0.70098702 -1.02617874]
mat_Sqrt:  [[17.53150242  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00707158 -0.00295631 -0.0100758 ]
Stock Position:  0.007071575958995864
Bond Position:  [-11.54461563]


portfolio before change:  [-10.83959698]
curr_Stock_Price:  100.10571563794865
curr_Factors:  [100.10571564  -0.77748513  -1.03070441]
mat_Sqrt:  [[16.41240167  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236797  0.00887077  0.02165307]
Stock Position:  -0.0023679714729595213
Bond Position:  [-10.6025495]


portfolio before change:  [-10.84389087]
curr_Stock_Price:  100.79952855861586
curr_Factors:  [100.79952856  -0.84754815  -1.04913109]
mat_Sqrt:  [[15.12659491  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01559172  0.07272796  0.03153972]
Stock Position:  -0.015591722624170367
Bond Position:  [-9.27225258]


portfolio before change:  [-10.84406353]
curr_Stock_Price:  100.66191118161284
curr_Factors:  [100.66191118  -1.08300627  -1.07498546]
mat_Sqrt:  [[11.63218417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00545502 -0.03842749  0.0069904 ]
Stock Position:  0.005455018117312461
Bond Position:  [-11.39317608]


portfolio before change:  [-10.84537116]
curr_Stock_Price:  100.9444083654039
curr_Factors:  [100.94440837  -1.18055092  -1.06259495]
mat_Sqrt:  [[10.71263708  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00197675 0.02378452 0.12961725]
Stock Position:  0.0019767490448928185
Bond Position:  [-11.04491292]


portfolio before change:  [-10.84847099]
curr_Stock_Price:  100.77329152635458
curr_Factors:  [100.77329153  -0.89249947  -1.06156007]
mat_Sqrt:  [[14.279341    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047429  0.05335541  0.11417535]
Stock Position:  -0.00047428837151984176
Bond Position:  [-10.80067538]


portfolio before change:  [-10.85124289]
curr_Stock_Price:  100.9238236442478
curr_Factors:  [100.92382364  -1.02504029  -1.04065212]
mat_Sqrt:  [[12.79012767  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00459843 -0.03196479 -0.14777621]
Stock Position:  -0.004598432874940833
Bond Position:  [-10.38715146]


portfolio before change:  [-10.84718327]
curr_Stock_Price:  99.47621510646036
curr_Factors:  [99.47621511 -0.83282504 -1.04066547]
mat_Sqrt:  [[15.27821656  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00664463 -0.03155189  0.58593695]
Stock Position:  -0.006644634995987889
Bond Position:  [-10.18620013]


portfolio before change:  [-10.85572485]
curr_Stock_Price:  100.37840348065858
curr_Factors:  [100.37840348  -0.87147552  -1.0745817 ]
mat_Sqrt:  [[14.33766314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00445653 0.0271343  0.37723976]
Stock Position:  0.0044565253764664746
Bond Position:  [-11.30306375]


portfolio before change:  [-10.8548891]
curr_Stock_Price:  101.20008978444557
curr_Factors:  [101.20008978  -0.60630301  -1.09474092]
mat_Sqrt:  [[18.4682992   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00738543 -0.00230961  0.23319465]
Stock Position:  -0.007385426427892237
Bond Position:  [-10.10748329]


portfolio before change:  [-10.84852871]
curr_Stock_Price:  99.99669482825408
curr_Factors:  [99.99669483 -0.31543593 -1.08116863]
mat_Sqrt:  [[24.74275152  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188276 -0.01712911  0.06331987]
Stock Position:  -0.0018827630685940369
Bond Position:  [-10.66025862]


portfolio before change:  [-10.85094366]
curr_Stock_Price:  99.86367737774852
curr_Factors:  [99.86367738 -0.29561304 -1.07871189]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.85094366]
Stock Price:  100.34373521507501
PL:  [-11.19467888]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.00023501e-01 -3.23696790e-02  9.67774060e-02]
 [-2.61973209e-01  2.06448002e-01 -4.38646734e-03]
 [ 4.22279806e-03 -1.10504128e-01  4.55256311e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 5.47360814e-02 -8.67928565e-02 -1.21700115e-01]
 [ 1.71016880e-01 -8.48994802e-02 -4.45969156e-02]
 [-2.10278568e-02 -6.76751295e-02 -7.14145788e-04]
 [-2.31964172e-03 -3.10819027e-02 -1.22241036e-02]
 [ 9.86697635e-03  2.77949890e-02 -7.79453817e-02]
 [-1.88212420e-01  1.76834208e-01  1.08026723e-02]
 [ 1.16483610e-01 -1.61703895e-01  1.08450853e-02]
 [-8.99555004e-02  1.34871614e-02  7.42743412e-03]
 [-4.68172694e-02  1.66498168e-01  6.88502357e-03]
 [-8.30542273e-02 -6.41433386e-02  5.80570164e-02]
 [-1.39403193e-01 -1.07784003e-01  2.28908926e-01]
 [ 1.33632486e-02  4.53396072e-02  3.52205397e-02]
 [-9.57070159e-02  4.98822510e-02  8.04121108e-02]
 [-4.10455224e-02 -2.85370306e-02  2.13244343e-02]
 [-1.92494147e-02  5.23766967e-01  2.99564138e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.24040644]
curr_Stock_Price:  99.99502410117955
curr_Factors:  [99.9950241  -0.96711225 -1.04264182]
mat_Sqrt:  [[13.40149613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02097562 -0.01023619  0.276079  ]
Stock Position:  -0.02097561900908443
Bond Position:  [4.33786397]


portfolio before change:  [2.26465371]
curr_Stock_Price:  98.89075774867453
curr_Factors:  [98.89075775 -0.69330626 -1.00861261]
mat_Sqrt:  [[18.03107952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01428301  0.06528459 -0.01251337]
Stock Position:  -0.014283012181569944
Bond Position:  [3.67711161]


portfolio before change:  [2.2492316]
curr_Stock_Price:  100.03487933275859
curr_Factors:  [100.03487933  -0.47356902  -1.02866478]
mat_Sqrt:  [[22.27099408  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00047876 -0.03494447  0.12987195]
Stock Position:  0.00047876059094909945
Bond Position:  [2.20133884]


portfolio before change:  [2.24911272]
curr_Stock_Price:  98.63693132421332
curr_Factors:  [98.63693132 -0.38288571 -1.05247095]
mat_Sqrt:  [[23.47859336  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016161  -0.00455813 -0.02970002]
Stock Position:  -0.001616100104899846
Bond Position:  [2.40851988]


portfolio before change:  [2.24773409]
curr_Stock_Price:  99.86262251571524
curr_Factors:  [99.86262252 -0.16519159 -1.03113366]
mat_Sqrt:  [[30.18877651  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00091601 -0.02744631 -0.34717655]
Stock Position:  0.0009160082216183424
Bond Position:  [2.1562591]


portfolio before change:  [2.24984789]
curr_Stock_Price:  101.58168057049105
curr_Factors:  [ 1.01581681e+02 -9.80202467e-02 -1.02173127e+00]
mat_Sqrt:  [[33.15228668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00481781 -0.02684757 -0.12722259]
Stock Position:  0.0048178117966984
Bond Position:  [1.76044647]


portfolio before change:  [2.23929114]
curr_Stock_Price:  99.29912725198152
curr_Factors:  [99.29912725 -0.28304531 -1.02165069]
mat_Sqrt:  [[26.93538325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085096 -0.02140076 -0.00203726]
Stock Position:  -0.0008509622954905149
Bond Position:  [2.32379096]


portfolio before change:  [2.23988092]
curr_Stock_Price:  99.28883575255041
curr_Factors:  [99.28883575 -0.4884444  -1.0149752 ]
mat_Sqrt:  [[22.07870434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00025443 -0.00982896 -0.03487197]
Stock Position:  -0.0002544265103974793
Bond Position:  [2.26514263]


portfolio before change:  [2.23985215]
curr_Stock_Price:  101.62791601990396
curr_Factors:  [101.62791602  -0.38853542  -0.99593533]
mat_Sqrt:  [[25.45335388  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.09241366e-04  8.78954729e-03 -2.22356478e-01]
Stock Position:  -0.0002092413658458279
Bond Position:  [2.26111692]


portfolio before change:  [2.24066882]
curr_Stock_Price:  100.42683202002387
curr_Factors:  [100.42683202  -0.62366623  -0.97411596]
mat_Sqrt:  [[20.32084555  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00892884  0.05591989  0.03081702]
Stock Position:  -0.008928835856857305
Bond Position:  [3.13736352]


portfolio before change:  [2.21629676]
curr_Stock_Price:  103.24427685724525
curr_Factors:  [103.24427686  -0.80762364  -1.03192114]
mat_Sqrt:  [[16.40445622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00698116 -0.05113526  0.03093801]
Stock Position:  0.006981162685699053
Bond Position:  [1.49553166]


portfolio before change:  [2.22635016]
curr_Stock_Price:  104.63078965364508
curr_Factors:  [104.63078965  -0.8372537   -1.05818798]
mat_Sqrt:  [[15.72098099  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00560341  0.00426501  0.0211884 ]
Stock Position:  -0.00560341271435072
Bond Position:  [2.81263966]


portfolio before change:  [2.23293634]
curr_Stock_Price:  103.5809063187878
curr_Factors:  [103.58090632  -1.15775714  -1.05137619]
mat_Sqrt:  [[11.37274477  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361504  0.05265134  0.01964106]
Stock Position:  -0.0036150380973656534
Bond Position:  [2.60738526]


portfolio before change:  [2.23347321]
curr_Stock_Price:  103.6127322575494
curr_Factors:  [103.61273226  -1.15809367  -1.07248475]
mat_Sqrt:  [[11.13487193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00654337 -0.0202839   0.16562051]
Stock Position:  -0.006543367792792855
Bond Position:  [2.91144943]


portfolio before change:  [2.23500993]
curr_Stock_Price:  103.48913115744361
curr_Factors:  [103.48913116  -0.99669758  -1.08193514]
mat_Sqrt:  [[12.94660872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00737338 -0.03408429  0.65301345]
Stock Position:  -0.007373384622852376
Bond Position:  [2.9980751]


portfolio before change:  [2.2255906]
curr_Stock_Price:  104.86827314836557
curr_Factors:  [104.86827315  -0.85884814  -1.06767243]
mat_Sqrt:  [[15.27449515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00142219 0.01433764 0.1004744 ]
Stock Position:  0.0014221926532909845
Bond Position:  [2.07644771]


portfolio before change:  [2.22597247]
curr_Stock_Price:  104.7717274125111
curr_Factors:  [104.77172741  -0.9197108   -1.05373979]
mat_Sqrt:  [[14.5608055   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00535719  0.01577415  0.22939337]
Stock Position:  -0.0053571904639570615
Bond Position:  [2.78725457]


portfolio before change:  [2.23119447]
curr_Stock_Price:  103.92704999254774
curr_Factors:  [103.92704999  -1.27163065  -1.02618821]
mat_Sqrt:  [[10.44235733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00358439 -0.0090242   0.06083268]
Stock Position:  -0.0035843930871598626
Bond Position:  [2.60370987]


portfolio before change:  [2.22861398]
curr_Stock_Price:  104.82859649048645
curr_Factors:  [104.82859649  -1.13011297  -1.04070982]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.22861398]
Stock Price:  104.97882246275562
PL:  [-2.75020848]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.65227840e-01 -4.69793321e-02  1.29124817e-01]
 [-2.12324768e-01  1.97318186e-01  7.71724279e-02]
 [-1.29009932e-01 -4.77943454e-01 -2.56605338e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.72328108e-01 -2.34915615e-01 -1.29705103e-01]
 [-7.60525294e-02  6.50567675e-02  2.65595957e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-2.62745086e-02 -3.54891864e-02 -1.50849475e-02]
 [-4.16261115e-02  2.80002891e-02  8.21371782e-03]
 [-1.30760810e-01  1.13633270e-01 -2.65983512e-02]
 [ 4.52447695e-02 -1.08953694e-01  1.12832173e-03]
 [ 3.44524216e-02  8.90516992e-02  4.36159803e-02]
 [-1.39513063e-02  1.75394963e-01  4.88818541e-02]
 [-5.09945643e-02 -4.80074728e-02 -3.71545424e-02]
 [-1.55394542e-01 -1.10570199e-01  2.23703590e-01]
 [ 7.18399028e-03  9.89973450e-02  1.42569425e-01]
 [-1.47389531e-01  7.07110476e-04  7.85755015e-02]
 [-4.87147767e-02 -5.09845305e-02  2.19563590e-02]
 [-2.99592045e-02  5.01575313e-01  2.25656727e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.69257416]
curr_Stock_Price:  99.58646334070784
curr_Factors:  [99.58646334 -0.92446296 -1.00967306]
mat_Sqrt:  [[14.3951338   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01667809 -0.01485617  0.36835716]
Stock Position:  -0.016678090753817536
Bond Position:  [0.96833792]


portfolio before change:  [-0.67950092]
curr_Stock_Price:  98.81712337913352
curr_Factors:  [98.81712338 -1.06934742 -1.05510723]
mat_Sqrt:  [[11.80846036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01621526  0.06239749  0.22015146]
Stock Position:  -0.01621526200744145
Bond Position:  [0.92284463]


portfolio before change:  [-0.67846874]
curr_Stock_Price:  98.76769818491462
curr_Factors:  [98.76769818 -1.09580249 -1.0123301 ]
mat_Sqrt:  [[11.99677685  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01221897 -0.15113899 -0.07320236]
Stock Position:  -0.012218974715826602
Bond Position:  [0.52837127]


portfolio before change:  [-0.69027934]
curr_Stock_Price:  99.74508928886407
curr_Factors:  [99.74508929 -0.96841115 -1.04433044]
mat_Sqrt:  [[13.32812198  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00284689 -0.00455813 -0.02970002]
Stock Position:  -0.002846894502831533
Bond Position:  [-0.4063156]


portfolio before change:  [-0.68703746]
curr_Stock_Price:  98.57066131347007
curr_Factors:  [98.57066131 -0.90759487 -1.04409714]
mat_Sqrt:  [[14.00034059  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02426989 -0.07428684 -0.37001256]
Stock Position:  0.024269885968142668
Bond Position:  [-3.07933617]


portfolio before change:  [-0.67576608]
curr_Stock_Price:  99.06680348156242
curr_Factors:  [99.06680348 -0.57694382 -1.02775495]
mat_Sqrt:  [[19.90748184  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00346359  0.02057276  0.07576713]
Stock Position:  -0.003463588046280041
Bond Position:  [-0.33263948]


portfolio before change:  [-0.67641025]
curr_Stock_Price:  99.22877362691827
curr_Factors:  [99.22877363 -0.75019173 -1.0215679 ]
mat_Sqrt:  [[16.87221861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033584 -0.02845143  0.0120735 ]
Stock Position:  -0.0003358357319836564
Bond Position:  [-0.64308568]


portfolio before change:  [-0.67680878]
curr_Stock_Price:  99.93668830318623
curr_Factors:  [99.9366883  -0.57950579 -1.05922574]
mat_Sqrt:  [[19.4103289   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155948 -0.01122267 -0.04303316]
Stock Position:  -0.0015594809152861097
Bond Position:  [-0.52095942]


portfolio before change:  [-0.67724561]
curr_Stock_Price:  100.13327472463044
curr_Factors:  [100.13327472  -0.82579414  -1.07962677]
mat_Sqrt:  [[14.89582746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263339  0.00885447  0.02343145]
Stock Position:  -0.002633390397481951
Bond Position:  [-0.41355561]


portfolio before change:  [-0.67395846]
curr_Stock_Price:  98.84575189262453
curr_Factors:  [98.84575189 -0.65843141 -1.07887622]
mat_Sqrt:  [[17.39622002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00766007  0.035934   -0.07587769]
Stock Position:  -0.007660065071303035
Bond Position:  [0.08320643]


portfolio before change:  [-0.67185199]
curr_Stock_Price:  98.57347308530471
curr_Factors:  [98.57347309 -0.44082497 -1.0870097 ]
mat_Sqrt:  [[21.39094095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00199439 -0.03445418  0.00321879]
Stock Position:  0.0019943916915453417
Bond Position:  [-0.8684461]


portfolio before change:  [-0.66793741]
curr_Stock_Price:  100.64514117168393
curr_Factors:  [100.64514117  -0.39714946  -1.11752706]
mat_Sqrt:  [[22.12978331  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00206305 0.02816062 0.12442425]
Stock Position:  0.0020630478228884385
Bond Position:  [-0.87557315]


portfolio before change:  [-0.67099746]
curr_Stock_Price:  99.26798859083888
curr_Factors:  [99.26798859 -0.3523567  -1.13798069]
mat_Sqrt:  [[22.36474338  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.48309941e-05 5.54647572e-02 1.39446324e-01]
Stock Position:  2.4830994065152924e-05
Bond Position:  [-0.67346238]


portfolio before change:  [-0.67117891]
curr_Stock_Price:  98.74179912343979
curr_Factors:  [ 9.87417991e+01 -6.83387447e-02 -1.11508871e+00]
mat_Sqrt:  [[30.2374402   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00197828 -0.0151813  -0.10599157]
Stock Position:  -0.00197828423196082
Bond Position:  [-0.47583957]


portfolio before change:  [-0.67093702]
curr_Stock_Price:  98.55938477007955
curr_Factors:  [ 9.85593848e+01  7.96730401e-02 -1.13416950e+00]
mat_Sqrt:  [[34.33491599  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00327906 -0.03496537  0.63816407]
Stock Position:  -0.003279057035172889
Bond Position:  [-0.34775517]


portfolio before change:  [-0.66706537]
curr_Stock_Price:  97.35214729280437
curr_Factors:  [97.35214729 -0.33479039 -1.11597026]
mat_Sqrt:  [[22.81855769  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00170221 0.03130571 0.40671089]
Stock Position:  0.0017022089351660884
Bond Position:  [-0.83277906]


portfolio before change:  [-0.66170117]
curr_Stock_Price:  100.62578482799896
curr_Factors:  [100.62578483  -0.47980048  -1.06276338]
mat_Sqrt:  [[21.51702902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.10363616e-03  2.23607966e-04  2.24154034e-01]
Stock Position:  -0.006103636160655437
Bond Position:  [-0.04751799]


portfolio before change:  [-0.66143262]
curr_Stock_Price:  100.57983890346797
curr_Factors:  [100.5798389   -0.59837267  -1.10909066]
mat_Sqrt:  [[18.23765667  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249755 -0.01612272  0.06263538]
Stock Position:  -0.0024975450187978347
Bond Position:  [-0.41022994]


portfolio before change:  [-0.65778368]
curr_Stock_Price:  99.0777619807384
curr_Factors:  [99.07776198 -0.75716732 -1.09093853]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.65778368]
Stock Price:  97.73696474602757
PL:  [-0.65778368]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.08239626e-01 -6.37498190e-02  1.62802315e-01]
 [-2.96901417e-01  2.41805250e-01  6.51630484e-02]
 [-1.28114893e-01 -4.76189559e-01 -3.14340503e-02]
 [-2.59123419e-02  5.38223976e-02  3.47806723e-02]
 [ 9.08796150e-01 -5.28688663e-01 -2.03162346e-01]
 [-1.64368429e-02  5.08240167e-02  1.00092596e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 3.43677829e-01  2.56828641e-02  2.21731470e-02]
 [-1.62929649e-01  1.20110579e-02  1.79214889e-01]
 [-2.03312085e-01  1.83939361e-01  4.82074034e-03]
 [-1.83494250e-02 -7.16612738e-02  5.22116382e-03]
 [ 5.57809663e-02  9.25737332e-02  7.45202203e-03]
 [ 2.46272189e-02  1.48496111e-01  8.36961645e-02]
 [ 1.12546565e-01 -2.23510662e-01  5.20068822e-02]
 [ 1.55360861e-01  3.67395326e-02  8.58738737e-02]
 [-3.54376934e-02  2.59221076e-01  3.92223083e-01]
 [ 1.26714978e-02 -3.54508650e-02 -6.10000955e-02]
 [-1.18384775e-02 -9.60818386e-03  7.38766349e-02]
 [-4.32886032e-02  3.95451363e-01  1.21953483e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.67468693]
curr_Stock_Price:  99.31035735377837
curr_Factors:  [99.31035735 -1.05587329 -0.96520166]
mat_Sqrt:  [[13.15990785  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01342363 -0.02015946  0.46442969]
Stock Position:  -0.01342363164259374
Bond Position:  [-1.34158127]


portfolio before change:  [-2.66349381]
curr_Stock_Price:  98.45153242032796
curr_Factors:  [98.45153242 -1.00351339 -0.94590565]
mat_Sqrt:  [[14.0152403   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01978965  0.07646553  0.18589204]
Stock Position:  -0.019789648625763087
Bond Position:  [-0.71517258]


portfolio before change:  [-2.6707593]
curr_Stock_Price:  98.80963206631603
curr_Factors:  [98.80963207 -1.12488205 -0.93174858]
mat_Sqrt:  [[12.63618414  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01161953 -0.15058436 -0.0896726 ]
Stock Position:  -0.011619528639763154
Bond Position:  [-1.52263795]


portfolio before change:  [-2.67184074]
curr_Stock_Price:  98.86993852889806
curr_Factors:  [98.86993853 -1.41227166 -0.89939949]
mat_Sqrt:  [[ 9.79756687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00177831  0.01702014  0.09921958]
Stock Position:  -0.0017783066716322994
Bond Position:  [-2.49601966]


portfolio before change:  [-2.67220188]
curr_Stock_Price:  98.72208114297315
curr_Factors:  [98.72208114 -1.48089407 -0.8960747 ]
mat_Sqrt:  [[ 9.1645234   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09314998 -0.16718603 -0.57956562]
Stock Position:  0.09314997518483281
Bond Position:  [-11.86816129]


portfolio before change:  [-2.65084731]
curr_Stock_Price:  98.98318682480233
curr_Factors:  [98.98318682 -1.87085115 -0.89347906]
mat_Sqrt:  [[ 6.23775163  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209714  0.01607197  0.02855363]
Stock Position:  -0.002097140392658163
Bond Position:  [-2.44326567]


portfolio before change:  [-2.65022021]
curr_Stock_Price:  98.39286310169052
curr_Factors:  [98.3928631  -1.88648152 -0.89455172]
mat_Sqrt:  [[ 6.09784256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00092923 -0.02845143  0.0120735 ]
Stock Position:  -0.0009292292862953809
Bond Position:  [-2.55879068]


portfolio before change:  [-2.65089553]
curr_Stock_Price:  98.43112026731275
curr_Factors:  [98.43112027 -1.60649386 -0.91684628]
mat_Sqrt:  [[ 7.89332032  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04419775 0.00812163 0.06325382]
Stock Position:  0.0441977544026507
Bond Position:  [-7.00133001]


portfolio before change:  [-2.66727831]
curr_Stock_Price:  98.10005769075119
curr_Factors:  [98.10005769 -1.56526461 -0.87258658]
mat_Sqrt:  [[ 8.56887769  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01470875  0.00379823  0.51125019]
Stock Position:  -0.014708745175692732
Bond Position:  [-1.22434956]


portfolio before change:  [-2.66905663]
curr_Stock_Price:  98.20014729064172
curr_Factors:  [98.20014729 -1.51380501 -0.90060413]
mat_Sqrt:  [[ 8.7810727   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02250053  0.05816673  0.01375223]
Stock Position:  -0.022500526751269935
Bond Position:  [-0.45950159]


portfolio before change:  [-2.67436234]
curr_Stock_Price:  98.4308452877473
curr_Factors:  [98.43084529 -1.4238137  -0.85765985]
mat_Sqrt:  [[10.05309626  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190329 -0.02266128  0.01489453]
Stock Position:  -0.0019032888049962029
Bond Position:  [-2.48702002]


portfolio before change:  [-2.67557979]
curr_Stock_Price:  98.74378265827869
curr_Factors:  [98.74378266 -1.44600346 -0.89222612]
mat_Sqrt:  [[ 9.52861009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00626454 0.02927438 0.02125854]
Stock Position:  0.0062645387812535844
Bond Position:  [-3.29416404]


portfolio before change:  [-2.67932507]
curr_Stock_Price:  98.27740539706609
curr_Factors:  [98.2774054  -1.53530445 -0.91424397]
mat_Sqrt:  [[ 8.48454039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00536809 0.04695859 0.23876186]
Stock Position:  0.005368090421149225
Bond Position:  [-3.20688707]


portfolio before change:  [-2.68376796]
curr_Stock_Price:  97.5991256730777
curr_Factors:  [97.59912567 -1.66800866 -0.92387776]
mat_Sqrt:  [[ 7.30809115  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01606321 -0.07068028  0.14836116]
Stock Position:  0.01606321027673723
Bond Position:  [-4.25152324]


portfolio before change:  [-2.67820778]
curr_Stock_Price:  98.01144594825892
curr_Factors:  [98.01144595 -2.21368138 -0.92977798]
mat_Sqrt:  [[ 4.22755966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04112027 0.01161806 0.24497426]
Stock Position:  0.041120271937049105
Bond Position:  [-6.70846509]


portfolio before change:  [-2.67997303]
curr_Stock_Price:  98.00930791433701
curr_Factors:  [98.00930791 -2.17952207 -0.91748999]
mat_Sqrt:  [[ 4.42845337  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01158815 0.0819729  1.11890328]
Stock Position:  0.011588146745040098
Bond Position:  [-3.81571927]


portfolio before change:  [-2.68209676]
curr_Stock_Price:  97.90837011685495
curr_Factors:  [97.90837012 -1.87275495 -0.91162236]
mat_Sqrt:  [[ 6.0475591   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.14993818e-04 -1.12105478e-02 -1.74016293e-01]
Stock Position:  -0.0001149938180186353
Bond Position:  [-2.6708379]


portfolio before change:  [-2.6826746]
curr_Stock_Price:  97.12613519973053
curr_Factors:  [97.1261352  -1.69491778 -0.91957659]
mat_Sqrt:  [[ 7.11009871  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00042101 -0.00303837  0.21074948]
Stock Position:  0.0004210131782393104
Bond Position:  [-2.72356598]


portfolio before change:  [-2.6834769]
curr_Stock_Price:  96.83796521126182
curr_Factors:  [96.83796521 -1.56469112 -0.9116249 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.6834769]
Stock Price:  96.049826329689
PL:  [-2.6834769]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.68051268e-01 -2.92578162e-02  8.19066363e-02]
 [ 4.54248830e-02  5.23807694e-02  7.27033422e-02]
 [-5.46995542e-02 -2.92405277e-01  4.47187191e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 5.18607217e-01 -3.24845074e-01 -1.57532095e-01]
 [-2.33466716e-02  5.22781739e-02  1.53950663e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 7.59884941e-02 -1.83262136e-02 -4.01489035e-03]
 [-3.84125356e-02  2.83395109e-02  4.11145330e-03]
 [-1.45992995e-01  1.31756984e-01 -1.32847562e-02]
 [ 6.35623443e-02 -1.20033425e-01  2.59718886e-03]
 [ 6.91884395e-02  1.00103979e-01  9.79925720e-03]
 [-3.17413853e-04  1.68126791e-01  6.20534206e-02]
 [-4.59509233e-02 -7.17943650e-02 -5.33940859e-02]
 [-1.58731320e-01 -1.13049719e-01  2.27908996e-01]
 [ 2.56708347e-02  8.77723394e-02  1.25041462e-01]
 [-5.77573038e-02  1.24186413e-01  3.11334132e-02]
 [-2.40242102e-02 -2.20072945e-02  4.72653652e-02]
 [-3.16339416e-02  4.88296202e-01  2.13683103e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.96915752]
curr_Stock_Price:  100.37513593053976
curr_Factors:  [100.37513593  -0.93636141  -1.02261344]
mat_Sqrt:  [[14.15318478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01781137 -0.00925213  0.23365683]
Stock Position:  -0.01781136780562049
Bond Position:  [6.75697599]


portfolio before change:  [4.96252964]
curr_Stock_Price:  100.84210384092476
curr_Factors:  [100.84210384  -1.21580969  -1.06199327]
mat_Sqrt:  [[10.33724106  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00596076 0.01656425 0.2074024 ]
Stock Position:  0.005960764175506897
Bond Position:  [4.36143364]


portfolio before change:  [4.96176492]
curr_Stock_Price:  100.53086615760202
curr_Factors:  [100.53086616  -1.44125392  -1.0587178 ]
mat_Sqrt:  [[ 8.25230935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00643714 -0.09246667  0.12757006]
Stock Position:  -0.006437138192446572
Bond Position:  [5.608896]


portfolio before change:  [4.96624983]
curr_Stock_Price:  100.05200304912147
curr_Factors:  [100.05200305  -1.28529865  -1.05342878]
mat_Sqrt:  [[ 9.65004564  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00393198 -0.00455813 -0.02970002]
Stock Position:  -0.003931976968381952
Bond Position:  [5.359652]


portfolio before change:  [4.96981052]
curr_Stock_Price:  99.48724564491096
curr_Factors:  [99.48724564 -0.97106977 -1.06711173]
mat_Sqrt:  [[12.95974417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03688836 -0.10272503 -0.44939522]
Stock Position:  0.03688835536307739
Bond Position:  [1.29988965]


portfolio before change:  [4.96718694]
curr_Stock_Price:  99.40731261509757
curr_Factors:  [99.40731262 -1.05426422 -1.04172587]
mat_Sqrt:  [[12.22197537  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154266  0.01653181  0.04391784]
Stock Position:  -0.0015426598123515556
Bond Position:  [5.1205386]


portfolio before change:  [4.96933675]
curr_Stock_Price:  98.8436621449962
curr_Factors:  [98.84366214 -0.97667134 -1.06477106]
mat_Sqrt:  [[12.83398885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044151 -0.02845143  0.0120735 ]
Stock Position:  -0.00044150684189884934
Bond Position:  [5.01297691]


portfolio before change:  [4.97044011]
curr_Stock_Price:  99.1835071667759
curr_Factors:  [99.18350717 -0.83534481 -1.07257064]
mat_Sqrt:  [[14.71778016  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00507521 -0.00579526 -0.01145336]
Stock Position:  0.0050752067525753255
Bond Position:  [4.4670633]


portfolio before change:  [4.97627778]
curr_Stock_Price:  100.11366860738998
curr_Factors:  [100.11366861  -0.67706214  -1.05025132]
mat_Sqrt:  [[17.79633908  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207018  0.00896174  0.01172883]
Stock Position:  -0.0020701766556030167
Bond Position:  [5.18353076]


portfolio before change:  [4.97880375]
curr_Stock_Price:  99.51954879605319
curr_Factors:  [99.5195488  -0.5733172  -1.03219981]
mat_Sqrt:  [[19.9821043   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00727165  0.04166522 -0.03789771]
Stock Position:  -0.007271645747121978
Bond Position:  [5.70247466]


portfolio before change:  [4.97648969]
curr_Stock_Price:  100.03385597700714
curr_Factors:  [100.03385598  -0.87449742  -1.07647983]
mat_Sqrt:  [[14.21832238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00428976 -0.0379579   0.00740906]
Stock Position:  0.0042897637205566354
Bond Position:  [4.54736809]


portfolio before change:  [4.97341215]
curr_Stock_Price:  99.05139553996231
curr_Factors:  [99.05139554 -0.75361445 -1.00554028]
mat_Sqrt:  [[17.05569449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00432544 0.03165566 0.02795455]
Stock Position:  0.0043254397035000025
Bond Position:  [4.54497131]


portfolio before change:  [4.97542608]
curr_Stock_Price:  99.25427587865495
curr_Factors:  [99.25427588 -0.85572694 -1.00314685]
mat_Sqrt:  [[15.46858519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00107897 0.05316636 0.17702114]
Stock Position:  0.0010789740923668044
Bond Position:  [4.86833329]


portfolio before change:  [4.9768389]
curr_Stock_Price:  99.43553705219949
curr_Factors:  [99.43553705 -0.55140073 -1.05928562]
mat_Sqrt:  [[19.86229519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295553 -0.02270337 -0.15231847]
Stock Position:  -0.002955532954395844
Bond Position:  [5.2707239]


portfolio before change:  [4.97603442]
curr_Stock_Price:  100.15362065153302
curr_Factors:  [100.15362065  -0.38305215  -1.067335  ]
mat_Sqrt:  [[23.48396997  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00490243 -0.03574946  0.65016093]
Stock Position:  -0.004902430123051433
Bond Position:  [5.46703055]


portfolio before change:  [4.97943632]
curr_Stock_Price:  99.73852679691696
curr_Factors:  [99.7385268  -0.63657593 -1.04881004]
mat_Sqrt:  [[18.48881681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00289154 0.02775605 0.35670849]
Stock Position:  0.00289153648272017
Bond Position:  [4.69103873]


portfolio before change:  [4.97549881]
curr_Stock_Price:  97.97115496912474
curr_Factors:  [97.97115497 -0.8883455  -1.02871203]
mat_Sqrt:  [[14.40557914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00334563  0.03927119  0.08881496]
Stock Position:  -0.003345630364864247
Bond Position:  [5.30327408]


portfolio before change:  [4.97915409]
curr_Stock_Price:  97.27493354117263
curr_Factors:  [97.27493354 -0.89358769 -1.04305051]
mat_Sqrt:  [[14.02586517  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106549 -0.00695932  0.13483493]
Stock Position:  -0.001065491052696314
Bond Position:  [5.08279966]


portfolio before change:  [4.97872321]
curr_Stock_Price:  98.87207570222212
curr_Factors:  [98.8720757  -0.8944018  -1.03041428]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.97872321]
Stock Price:  98.74982547453632
PL:  [4.97872321]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.56591129e-01 -2.81423989e-02  7.65763517e-02]
 [-4.10285123e-01  2.77044770e-01 -5.79728387e-02]
 [-1.42497791e-01 -3.40648143e-01 -3.48834446e-02]
 [ 3.69429286e-02  1.23470829e-02 -4.77206919e-02]
 [-6.40162731e-02  1.30018609e-01  1.08530986e-01]
 [-2.58813490e-01  1.09677761e-01  5.97681186e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 3.94987837e-01  4.26236169e-02 -1.21808110e-02]
 [-5.25936391e-01 -3.81015067e-02  7.02427339e-01]
 [-1.16739088e-01  9.56037743e-02 -2.37883617e-02]
 [-7.49531991e-02 -1.68404666e-02  6.66076378e-03]
 [ 1.48444369e-01  3.64321077e-02 -1.79920012e-01]
 [ 1.74561984e-02  8.21550575e-02  4.72858885e-02]
 [ 2.12929160e-01 -4.22739648e-01  1.21825885e-01]
 [ 5.65617060e-02  1.04000471e-01 -1.09462058e-02]
 [-2.63941718e-02  2.04299598e-01  3.43911550e-01]
 [ 3.35259252e-02 -1.05363506e-01 -9.50652827e-02]
 [ 7.87426918e-02  5.12974516e-02  1.70404368e-01]
 [-3.97644458e-02  4.29565310e-01  1.22530348e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.7416676]
curr_Stock_Price:  100.48274567935907
curr_Factors:  [100.48274568  -0.86724618  -1.01152896]
mat_Sqrt:  [[15.35146465  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01574356 -0.00889941  0.21845102]
Stock Position:  -0.015743558395856297
Bond Position:  [7.32362358]


portfolio before change:  [5.76603572]
curr_Stock_Price:  99.05124035054763
curr_Factors:  [ 9.90512404e+01 -8.75665659e-02 -1.03201517e+00]
mat_Sqrt:  [[32.33193874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01283454  0.08760925 -0.16538037]
Stock Position:  -0.012834538534123708
Bond Position:  [7.03731268]


portfolio before change:  [5.78213886]
curr_Stock_Price:  97.93366346259899
curr_Factors:  [97.93366346 -0.23560324 -1.0699938 ]
mat_Sqrt:  [[26.54106892  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00596863 -0.1077224  -0.09951276]
Stock Position:  -0.005968630787645297
Bond Position:  [6.36666873]


portfolio before change:  [5.78652162]
curr_Stock_Price:  97.4660690627011
curr_Factors:  [ 9.74660691e+01  4.92071496e-03 -1.07055010e+00]
mat_Sqrt:  [[33.57812873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0008196   0.00390449 -0.13613385]
Stock Position:  0.0008196044409498364
Bond Position:  [5.706638]


portfolio before change:  [5.78459365]
curr_Stock_Price:  93.37286903216491
curr_Factors:  [93.37286903 -0.25324149 -1.05557388]
mat_Sqrt:  [[25.22373587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152655  0.04111549  0.30960869]
Stock Position:  -0.00152655469468616
Bond Position:  [5.92713244]


portfolio before change:  [5.78767023]
curr_Stock_Price:  92.32828922848856
curr_Factors:  [92.32828923 -0.33843466 -1.04213493]
mat_Sqrt:  [[23.21459067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01050122  0.03468315  0.17050181]
Stock Position:  -0.01050121922561039
Bond Position:  [6.75722984]


portfolio before change:  [5.78617095]
curr_Stock_Price:  92.6319485292669
curr_Factors:  [92.63194853 -0.50543425 -1.0476022 ]
mat_Sqrt:  [[19.60133429  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00028908 -0.02845143  0.0120735 ]
Stock Position:  -0.0002890769477235883
Bond Position:  [5.81294872]


portfolio before change:  [5.78771493]
curr_Stock_Price:  92.3187050856178
curr_Factors:  [92.31870509 -0.61896005 -1.08719779]
mat_Sqrt:  [[16.76157291  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0234824   0.01347877 -0.03474846]
Stock Position:  0.023482401016374145
Bond Position:  [3.61985007]


portfolio before change:  [5.77115651]
curr_Stock_Price:  91.57502081304287
curr_Factors:  [91.57502081 -0.67495891 -1.08486989]
mat_Sqrt:  [[15.75770944  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02433969 -0.01204875  2.00382968]
Stock Position:  -0.02433969159578561
Bond Position:  [8.00006427]


portfolio before change:  [5.79046163]
curr_Stock_Price:  90.86404824492854
curr_Factors:  [90.86404824 -0.89668818 -1.08314435]
mat_Sqrt:  [[12.54763109  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00949393  0.03023257 -0.06786157]
Stock Position:  -0.009493934549232178
Bond Position:  [6.65311895]


portfolio before change:  [5.76937008]
curr_Stock_Price:  93.2608459275027
curr_Factors:  [93.26084593 -1.10414293 -1.09794117]
mat_Sqrt:  [[10.31208249  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0071788  -0.00532542  0.01900131]
Stock Position:  -0.007178801706455884
Bond Position:  [6.43887119]


portfolio before change:  [5.7738703]
curr_Stock_Price:  92.85822930967375
curr_Factors:  [92.85822931 -1.17311838 -1.11615972]
mat_Sqrt:  [[ 9.41021506  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01197199  0.01152084 -0.51326171]
Stock Position:  0.011971992453810929
Bond Position:  [4.66217228]


portfolio before change:  [5.78147709]
curr_Stock_Price:  93.3962435009629
curr_Factors:  [93.3962435  -1.17617841 -1.09711414]
mat_Sqrt:  [[ 9.61725213  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00303929 0.02597971 0.13489348]
Stock Position:  0.003039290643282421
Bond Position:  [5.49761876]


portfolio before change:  [5.78312279]
curr_Stock_Price:  93.48545077789946
curr_Factors:  [93.48545078 -1.57408671 -1.12637868]
mat_Sqrt:  [[ 6.27981445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03612872 -0.13368201  0.34753534]
Stock Position:  0.03612872263509433
Bond Position:  [2.40561287]


portfolio before change:  [5.81201645]
curr_Stock_Price:  94.26854465110333
curr_Factors:  [94.26854465 -1.33002422 -1.16637533]
mat_Sqrt:  [[ 7.76594397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00734136  0.03288784 -0.03122648]
Stock Position:  0.0073413614563657735
Bond Position:  [5.11995699]


portfolio before change:  [5.81324362]
curr_Stock_Price:  94.26132794167293
curr_Factors:  [94.26132794 -1.16449376 -1.1609681 ]
mat_Sqrt:  [[ 9.2129413   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00532745 0.06460521 0.98108393]
Stock Position:  0.005327448731691356
Bond Position:  [5.31107123]


portfolio before change:  [5.81011404]
curr_Stock_Price:  93.42462121745251
curr_Factors:  [93.42462122 -1.26360851 -1.10575735]
mat_Sqrt:  [[ 8.7389414   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00130454 -0.03331887 -0.27119479]
Stock Position:  0.0013045437770696086
Bond Position:  [5.68823753]


portfolio before change:  [5.81142031]
curr_Stock_Price:  93.33572765600174
curr_Factors:  [93.33572766 -1.07191621 -1.07222816]
mat_Sqrt:  [[10.93598352  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0105021  0.01622168 0.48611623]
Stock Position:  0.010502103636792834
Bond Position:  [4.83119883]


portfolio before change:  [5.8119472]
curr_Stock_Price:  93.27087731662475
curr_Factors:  [93.27087732 -0.77737334 -1.07805078]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.8119472]
Stock Price:  92.92994234761129
PL:  [5.8119472]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.11485703e-01 -2.37522802e-02  5.55971349e-02]
 [ 6.70972140e-02  2.82690067e-02  2.00157778e-02]
 [ 3.56665914e-02  3.50214232e-02  4.33151804e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.15772667e-01 -2.70556501e-01 -2.47809515e-01]
 [ 6.90292742e-02 -8.12145147e-02 -7.65303584e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-4.56077217e-02 -3.77506272e-02 -2.29936440e-02]
 [ 6.90583494e-03  2.52395133e-02 -8.22870868e-02]
 [-2.68058291e-01  2.54106292e-01  1.72847673e-02]
 [ 7.22933086e-02 -1.25110908e-01  1.70271672e-03]
 [-2.40091936e-02  4.99942589e-02  3.58372904e-02]
 [-3.58927560e-02  1.81351449e-01  2.54581692e-02]
 [-6.52748567e-02 -8.98235195e-02  7.59486831e-03]
 [-1.47506706e-01 -1.11704728e-01  2.33265164e-01]
 [ 3.41335792e-02  7.53332060e-02  1.05790349e-01]
 [-1.44948938e-01  6.81041667e-04  8.15109959e-02]
 [-5.00696865e-02 -5.79661116e-02  2.39728693e-02]
 [-2.43206042e-02  5.46120412e-01  2.76848076e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.9394099]
curr_Stock_Price:  102.18187689204596
curr_Factors:  [102.18187689  -1.3723721   -1.03317857]
mat_Sqrt:  [[ 9.2184201   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02177708 -0.00751113  0.15860315]
Stock Position:  -0.021777079454674504
Bond Position:  [20.16463276]


portfolio before change:  [17.95222256]
curr_Stock_Price:  101.82504004498595
curr_Factors:  [101.82504004  -1.00386616  -1.0123616 ]
mat_Sqrt:  [[13.55869845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00530381 0.00893944 0.05709944]
Stock Position:  0.0053038144068710165
Bond Position:  [17.41216144]


portfolio before change:  [17.95162624]
curr_Stock_Price:  100.89176813537979
curr_Factors:  [100.89176814  -0.45389017  -1.04020396]
mat_Sqrt:  [[22.64534268  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00200538 0.01107475 0.12356615]
Stock Position:  0.0020053798925713188
Bond Position:  [17.74929992]


portfolio before change:  [17.95921262]
curr_Stock_Price:  102.46179513643705
curr_Factors:  [102.46179514  -0.84242136  -1.0179284 ]
mat_Sqrt:  [[15.94491933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00237968 -0.00455813 -0.02970002]
Stock Position:  -0.0023796769623861194
Bond Position:  [18.20303859]


portfolio before change:  [17.96339402]
curr_Stock_Price:  102.61724825926673
curr_Factors:  [102.61724826  -0.93712638  -1.02247231]
mat_Sqrt:  [[14.46030546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01785599 -0.08555748 -0.70693157]
Stock Position:  0.017855986732383696
Bond Position:  [16.1310618]


portfolio before change:  [17.96313605]
curr_Stock_Price:  102.37692336659161
curr_Factors:  [102.37692337  -0.70109202  -1.035328  ]
mat_Sqrt:  [[18.03368345  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00284527 -0.02568228 -0.21831981]
Stock Position:  0.002845266227863009
Bond Position:  [17.67184645]


portfolio before change:  [17.96442916]
curr_Stock_Price:  101.27846520150511
curr_Factors:  [101.2784652   -1.05402486  -1.07681736]
mat_Sqrt:  [[12.0255264   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047119 -0.02845143  0.0120735 ]
Stock Position:  -0.00047118884448963446
Bond Position:  [18.01215044]


portfolio before change:  [17.96907351]
curr_Stock_Price:  100.97974453940145
curr_Factors:  [100.97974454  -1.0869416   -1.064561  ]
mat_Sqrt:  [[11.7448794   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00436582 -0.0119378  -0.06559447]
Stock Position:  -0.0043658172129043184
Bond Position:  [18.40993262]


portfolio before change:  [17.97034348]
curr_Stock_Price:  101.74319614692678
curr_Factors:  [101.74319615  -1.00023743  -1.08612242]
mat_Sqrt:  [[12.63021687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00073152  0.00798143 -0.23474215]
Stock Position:  -0.0007315206844008652
Bond Position:  [18.04477074]


portfolio before change:  [17.97539511]
curr_Stock_Price:  101.0051788905864
curr_Factors:  [101.00517889  -0.9647665   -1.04101095]
mat_Sqrt:  [[13.59081697  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01898113  0.08035547  0.04930863]
Stock Position:  -0.01898112944761108
Bond Position:  [19.89258749]


portfolio before change:  [17.97938942]
curr_Stock_Price:  101.05678082721428
curr_Factors:  [101.05678083  -1.14266951  -1.00481429]
mat_Sqrt:  [[11.80117078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00588166 -0.03956354  0.00485738]
Stock Position:  0.0058816642577406535
Bond Position:  [17.38500736]


portfolio before change:  [17.99088818]
curr_Stock_Price:  102.27275768398096
curr_Factors:  [102.27275768  -1.02471581  -1.01970284]
mat_Sqrt:  [[13.23976356  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0011634   0.01580957  0.10223381]
Stock Position:  -0.001163396239778935
Bond Position:  [18.10987192]


portfolio before change:  [17.99596424]
curr_Stock_Price:  101.80170492822323
curr_Factors:  [101.80170493  -0.5060533   -1.01734376]
mat_Sqrt:  [[22.18973493  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00117233  0.05734836  0.07262507]
Stock Position:  -0.0011723283199752404
Bond Position:  [18.11530926]


portfolio before change:  [18.00042046]
curr_Stock_Price:  101.86412088770216
curr_Factors:  [101.86412089  -0.61138282  -1.01994426]
mat_Sqrt:  [[19.93172516  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0033135  -0.02840469  0.02166605]
Stock Position:  -0.0033135011390538847
Bond Position:  [18.33794734]


portfolio before change:  [18.00183164]
curr_Stock_Price:  102.82198283253094
curr_Factors:  [102.82198283  -0.69089413  -1.05130576]
mat_Sqrt:  [[18.00769711  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00570733 -0.03532414  0.66544058]
Stock Position:  -0.005707329292385967
Bond Position:  [18.58867056]


portfolio before change:  [18.01220488]
curr_Stock_Price:  101.81880077420722
curr_Factors:  [101.81880077  -0.83167285  -1.0263671 ]
mat_Sqrt:  [[15.88149851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00363146 0.02382245 0.30179042]
Stock Position:  0.003631460766998608
Bond Position:  [17.6424539]


portfolio before change:  [18.0175229]
curr_Stock_Price:  102.06852297270436
curr_Factors:  [102.06852297  -0.7145841   -1.01985203]
mat_Sqrt:  [[18.01506321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.12142889e-03  2.15364285e-04  2.32528183e-01]
Stock Position:  -0.00712142888720874
Bond Position:  [18.74439663]


portfolio before change:  [18.04259068]
curr_Stock_Price:  99.20658443480555
curr_Factors:  [99.20658443 -0.81934952 -0.99414882]
mat_Sqrt:  [[16.17886967  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288481 -0.01833049  0.06838792]
Stock Position:  -0.0028848074388872634
Bond Position:  [18.32878257]


portfolio before change:  [18.04266821]
curr_Stock_Price:  100.76829673098443
curr_Factors:  [100.76829673  -0.63094954  -0.98587016]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.04266821]
Stock Price:  100.20687247962972
PL:  [17.83579573]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.57884825e-01 -2.82683145e-02  7.71780694e-02]
 [-1.59417976e-01  1.54791422e-01  2.02089439e-02]
 [-7.08511096e-02 -2.43224909e-01  1.64660134e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 2.24683216e-01 -2.01465930e-01 -1.91913754e-01]
 [ 1.63762405e-01 -2.74784034e-01 -1.61279663e-01]
 [ 8.65124725e-02 -1.47139944e-01 -1.83050122e-02]
 [ 4.23352238e-02 -3.51312399e-01 -6.49764974e-02]
 [-2.94869827e-01 -1.50802470e-01 -1.14888940e-01]
 [-7.89068390e-01  7.98593912e-01  1.52243726e-01]
 [ 1.07446080e-01 -2.86848135e-01  1.89866709e-01]
 [-2.03283398e-01 -4.81162859e-02 -4.22842925e-02]
 [-2.59683002e-01  1.08701097e-02 -3.03128273e-01]
 [-1.19127036e-01  1.39036212e-01 -3.18147361e-03]
 [-1.98931215e-01 -1.58838267e-01  3.22944859e-01]
 [-1.11571288e-02 -1.20301490e-02 -7.66223967e-02]
 [-8.98278615e-02  5.68579462e-02  7.89447564e-02]
 [-3.11334640e-02  1.48573928e-03  1.98693264e-02]
 [-2.62824038e-03  5.48972345e-01  3.80096768e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.21894829]
curr_Stock_Price:  100.40993149127333
curr_Factors:  [100.40993149  -0.83083586  -0.93030123]
mat_Sqrt:  [[17.25538089  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0140745  -0.00893923  0.22016755]
Stock Position:  -0.014074496755184917
Bond Position:  [6.63216754]


portfolio before change:  [5.23219861]
curr_Stock_Price:  99.58630917806045
curr_Factors:  [99.58630918 -0.69085756 -0.92844872]
mat_Sqrt:  [[19.72167761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00767157  0.04894935  0.05765049]
Stock Position:  -0.007671565689437407
Bond Position:  [5.99618152]


portfolio before change:  [5.23766458]
curr_Stock_Price:  99.06923787597175
curr_Factors:  [99.06923788 -0.51774239 -0.95758173]
mat_Sqrt:  [[22.65758922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325586 -0.07691447  0.04697295]
Stock Position:  -0.0032558644307437113
Bond Position:  [5.56022059]


portfolio before change:  [5.23357442]
curr_Stock_Price:  100.75247594316434
curr_Factors:  [100.75247594  -0.1423496   -0.96458719]
mat_Sqrt:  [[33.30574775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113926 -0.00455813 -0.02970002]
Stock Position:  -0.0011392555266788772
Bond Position:  [5.34835723]


portfolio before change:  [5.23402409]
curr_Stock_Price:  101.53156529083233
curr_Factors:  [101.53156529  -0.16561131  -0.96765469]
mat_Sqrt:  [[32.69112857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00551548 -0.06370912 -0.54747652]
Stock Position:  0.005515476671141838
Bond Position:  [4.67402911]


portfolio before change:  [5.25686774]
curr_Stock_Price:  105.4614154818283
curr_Factors:  [105.46141548  -0.19009258  -0.9630408 ]
mat_Sqrt:  [[33.28849274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00371739 -0.08689434 -0.46008599]
Stock Position:  0.003717393869580721
Bond Position:  [4.86482612]


portfolio before change:  [5.27255065]
curr_Stock_Price:  109.35299955685853
curr_Factors:  [109.35299956  -0.1697768   -0.98919526]
mat_Sqrt:  [[34.31591084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00230146 -0.04652974 -0.0522191 ]
Stock Position:  0.002301464206246811
Bond Position:  [5.02087864]


portfolio before change:  [5.27163842]
curr_Stock_Price:  108.411158116387
curr_Factors:  [108.41115812  -0.3966266   -0.97150692]
mat_Sqrt:  [[27.59949552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00072469 -0.11109474 -0.18535986]
Stock Position:  0.0007246909493275824
Bond Position:  [5.19307383]


portfolio before change:  [5.27384057]
curr_Stock_Price:  109.65820340736863
curr_Factors:  [109.65820341  -0.73663283  -0.97177876]
mat_Sqrt:  [[19.86494653  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01622029 -0.04768793 -0.32774617]
Stock Position:  -0.016220287143864753
Bond Position:  [7.05252812]


portfolio before change:  [5.23836226]
curr_Stock_Price:  111.95419598108764
curr_Factors:  [111.95419598  -0.71788046  -0.994177  ]
mat_Sqrt:  [[20.20706649  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03649081  0.25253757  0.43430897]
Stock Position:  -0.03649080700391846
Bond Position:  [9.32366122]


portfolio before change:  [5.22412164]
curr_Stock_Price:  112.40833312887862
curr_Factors:  [112.40833313  -0.65850597  -1.00711073]
mat_Sqrt:  [[21.25349553  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00653051 -0.09070934  0.54163687]
Stock Position:  0.00653050563895481
Bond Position:  [4.49003838]


portfolio before change:  [5.21684892]
curr_Stock_Price:  111.12277164003983
curr_Factors:  [111.12277164  -0.81923697  -1.00047393]
mat_Sqrt:  [[18.00995657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01183551 -0.01521571 -0.12062532]
Stock Position:  -0.011835508862601882
Bond Position:  [6.53204347]


portfolio before change:  [5.20619582]
curr_Stock_Price:  112.16086096335611
curr_Factors:  [112.16086096  -0.97668227  -1.03000561]
mat_Sqrt:  [[15.07814304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02130754  0.00343743 -0.86474059]
Stock Position:  -0.021307540045230514
Bond Position:  [7.59606786]


portfolio before change:  [5.23620934]
curr_Stock_Price:  110.84140929112426
curr_Factors:  [110.84140929  -1.17458166  -1.06508248]
mat_Sqrt:  [[11.80397438  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.009843    0.04396711 -0.00907586]
Stock Position:  -0.009843002688198637
Bond Position:  [6.32722163]


portfolio before change:  [5.23430273]
curr_Stock_Price:  111.19583566193867
curr_Factors:  [111.19583566  -1.18748965  -1.07799178]
mat_Sqrt:  [[11.53991041  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01188151 -0.05022907  0.92127179]
Stock Position:  -0.011881509729549421
Bond Position:  [6.55547713]


portfolio before change:  [5.26148041]
curr_Stock_Price:  109.0463940273962
curr_Factors:  [109.04639403  -0.94117075  -1.08404883]
mat_Sqrt:  [[14.39029243  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188379 -0.00380427 -0.21858237]
Stock Position:  -0.0018837856992560047
Bond Position:  [5.46690045]


portfolio before change:  [5.26278272]
curr_Stock_Price:  109.08068126702506
curr_Factors:  [109.08068127  -0.96462466  -1.11455071]
mat_Sqrt:  [[13.63871489  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00529707  0.01798006  0.22520742]
Stock Position:  -0.005297072732671998
Bond Position:  [5.84059102]


portfolio before change:  [5.26936791]
curr_Stock_Price:  108.1131923802192
curr_Factors:  [108.11319238  -1.06009129  -1.13925464]
mat_Sqrt:  [[11.98712107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0022557   0.00046983  0.05668166]
Stock Position:  -0.0022556953367409783
Bond Position:  [5.51323833]


portfolio before change:  [5.27031824]
curr_Stock_Price:  108.30300060377776
curr_Factors:  [108.3030006   -0.92831724  -1.18722158]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.27031824]
Stock Price:  107.02253723662024
PL:  [-1.752219]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-5.04255074e-02 -8.14192639e-02  1.02089214e-01]
 [-7.33020182e-02  1.11459531e-01  4.10561410e-02]
 [-4.20805341e-02 -2.56003761e-01  4.39252969e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 2.82363052e-01 -2.22990214e-01 -1.79157707e-01]
 [ 3.37348462e-02  3.09347905e-02  7.24162495e-03]
 [-1.01738482e-02 -8.20623435e-02  2.47766436e-03]
 [ 2.63572096e-01  1.63503110e-02 -3.42695667e-03]
 [-1.82450264e-01  4.49438445e-03  2.31807216e-01]
 [-5.55405257e-02  5.79352612e-02 -4.21221159e-02]
 [ 1.11348139e-01 -1.67905630e-01  2.37370994e-02]
 [-5.88070910e-02  3.04189976e-02  2.10908060e-02]
 [-7.16594962e-02  1.79220106e-01 -1.73169943e-02]
 [-5.58136402e-02 -1.19491965e-01 -1.82040363e-02]
 [-1.63144160e-01 -1.21800734e-01  2.48724827e-01]
 [-1.73831431e-02  7.79968847e-02  4.31083473e-02]
 [-1.60146721e-01 -1.39927325e-02  8.12296979e-02]
 [-4.52543974e-02 -5.16952304e-02  2.85174272e-02]
 [-2.44736644e-02  5.51069384e-01  2.47411754e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.84407795]
curr_Stock_Price:  98.72956606951615
curr_Factors:  [98.72956607 -0.69442955 -1.00122728]
mat_Sqrt:  [[18.11476984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174934 -0.02574703  0.29123211]
Stock Position:  -0.0017493388306829526
Bond Position:  [-6.67136648]


portfolio before change:  [-6.84747756]
curr_Stock_Price:  99.71940805239709
curr_Factors:  [99.71940805 -0.88961558 -1.03323814]
mat_Sqrt:  [[14.57789878  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.004256    0.0352466   0.11712174]
Stock Position:  -0.004256004016134326
Bond Position:  [-6.42307136]


portfolio before change:  [-6.84965596]
curr_Stock_Price:  99.85390752814874
curr_Factors:  [99.85390753 -0.89958414 -1.05234021]
mat_Sqrt:  [[14.17930969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280157 -0.0809555   0.12530665]
Stock Position:  -0.002801568618492451
Bond Position:  [-6.56990839]


portfolio before change:  [-6.85330078]
curr_Stock_Price:  100.56855517190158
curr_Factors:  [100.56855517  -0.63723905  -1.04127673]
mat_Sqrt:  [[18.77120138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202138 -0.00455813 -0.02970002]
Stock Position:  -0.0020213813932746954
Bond Position:  [-6.65001337]


portfolio before change:  [-6.85613138]
curr_Stock_Price:  101.1463236268347
curr_Factors:  [101.14632363  -0.69695287  -1.04981541]
mat_Sqrt:  [[17.63348993  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01361245 -0.0705157  -0.51108707]
Stock Position:  0.013612453146475873
Bond Position:  [-8.23298097]


portfolio before change:  [-6.87440761]
curr_Stock_Price:  99.95493504150276
curr_Factors:  [99.95493504 -0.68290303 -1.06204248]
mat_Sqrt:  [[17.45757975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00206282 0.00978244 0.02065834]
Stock Position:  0.0020628156969797395
Bond Position:  [-7.08059621]


portfolio before change:  [-6.87810487]
curr_Stock_Price:  99.02082557000416
curr_Factors:  [99.02082557 -0.49589268 -1.10274621]
mat_Sqrt:  [[20.01918977  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058878 -0.02595039  0.00706809]
Stock Position:  -0.0005887819542823115
Bond Position:  [-6.8198032]


portfolio before change:  [-6.87861006]
curr_Stock_Price:  96.98275885169475
curr_Factors:  [96.98275885 -0.42622008 -1.10766565]
mat_Sqrt:  [[20.9187834   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01258652  0.00517042 -0.00977615]
Stock Position:  0.01258652234273294
Bond Position:  [-8.09928572]


portfolio before change:  [-6.88275433]
curr_Stock_Price:  96.81438822832267
curr_Factors:  [96.81438823 -0.13186228 -1.13233245]
mat_Sqrt:  [[27.34683736  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0049372   0.00142125  0.66128147]
Stock Position:  -0.0049371986769963785
Bond Position:  [-6.40476246]


portfolio before change:  [-6.89658137]
curr_Stock_Price:  99.2906190760097
curr_Factors:  [ 9.92906191e+01  3.50242947e-02 -1.12135931e+00]
mat_Sqrt:  [[33.50571702  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00186961  0.01832074 -0.12016267]
Stock Position:  -0.0018696148062749452
Bond Position:  [-6.71094616]


portfolio before change:  [-6.90456448]
curr_Stock_Price:  102.66305936310474
curr_Factors:  [102.66305936  -0.34982616  -1.14522881]
mat_Sqrt:  [[23.02078224  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00485901 -0.05309642  0.06771534]
Stock Position:  0.004859007331114291
Bond Position:  [-7.40340504]


portfolio before change:  [-6.89953668]
curr_Stock_Price:  104.07875627745663
curr_Factors:  [104.07875628  -0.15188628  -1.14564898]
mat_Sqrt:  [[28.43476828  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188911  0.00961933  0.0601662 ]
Stock Position:  -0.0018891145007163908
Bond Position:  [-6.70291999]


portfolio before change:  [-6.9004439]
curr_Stock_Price:  103.67183837979557
curr_Factors:  [ 1.03671838e+02 -6.66945287e-02 -1.18528904e+00]
mat_Sqrt:  [[29.64362035  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00238051  0.05667437 -0.04940056]
Stock Position:  -0.0023805078048731174
Bond Position:  [-6.65365228]


portfolio before change:  [-6.89499583]
curr_Stock_Price:  100.68437011542775
curr_Factors:  [100.68437012  -0.38283966  -1.13301182]
mat_Sqrt:  [[22.11241245  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00283166 -0.03778668 -0.05193105]
Stock Position:  -0.002831658144805623
Bond Position:  [-6.60989212]


portfolio before change:  [-6.9005492]
curr_Stock_Price:  102.06189869552749
curr_Factors:  [ 1.02061899e+02 -3.77922963e-02 -1.10719736e+00]
mat_Sqrt:  [[32.47887315  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355672 -0.03851677  0.7095427 ]
Stock Position:  -0.003556721260773498
Bond Position:  [-6.53754348]


portfolio before change:  [-6.90368993]
curr_Stock_Price:  102.48536136641884
curr_Factors:  [102.48536137  -0.24958747  -1.1008047 ]
mat_Sqrt:  [[26.55791443  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024738  0.02466478  0.12297612]
Stock Position:  -0.00024737701564903373
Bond Position:  [-6.87833741]


portfolio before change:  [-6.90493472]
curr_Stock_Price:  100.56516786382028
curr_Factors:  [100.56516786  -0.184283    -1.11373678]
mat_Sqrt:  [[27.46153172  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524104 -0.00442489  0.23172572]
Stock Position:  -0.005241043027859867
Bond Position:  [-6.37786835]


portfolio before change:  [-6.89875101]
curr_Stock_Price:  99.08104031536286
curr_Factors:  [ 9.90810403e+01 -5.92047097e-02 -1.10814712e+00]
mat_Sqrt:  [[30.83302265  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132222 -0.01634747  0.08135228]
Stock Position:  -0.0013222209035471711
Bond Position:  [-6.76774399]


portfolio before change:  [-6.89693429]
curr_Stock_Price:  96.4272757164959
curr_Factors:  [ 9.64272757e+01 -2.71358032e-02 -1.13239198e+00]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.89693429]
Stock Price:  94.89823485438275
PL:  [-6.89693429]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.06202862e-01 -3.29711173e-02  9.96515206e-02]
 [-2.06321418e-03  8.67212372e-02  1.07028314e-01]
 [-7.70932846e-03 -1.25058737e-01  3.69406427e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.56679290e-01 -2.71064601e-01 -2.07982894e-01]
 [-5.78823625e-03 -4.26948414e-02 -7.84058070e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-1.43862977e-02 -3.41009698e-02 -1.05635337e-02]
 [ 9.31490003e-03  3.14956959e-02 -6.36290470e-02]
 [-3.16856093e-01  3.03086877e-01  1.96587244e-02]
 [ 1.15870461e-01 -1.59182298e-01  7.99079584e-03]
 [ 7.16922569e-03  7.31416864e-02  4.46478451e-02]
 [-5.03295788e-02  1.71463624e-01  4.69138033e-03]
 [-1.27189144e-01 -2.08388184e-02  1.84943528e-01]
 [-1.20126808e-01 -1.05146111e-01  2.37192592e-01]
 [ 4.94134879e-03  2.95601418e-02  2.63393807e-03]
 [-9.21832228e-02  5.26445327e-02  8.12537597e-02]
 [-3.73601897e-02 -1.70180812e-02  2.05583138e-02]
 [-1.40194897e-02  5.55468165e-01  3.35979207e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.75982533]
curr_Stock_Price:  99.92807971654678
curr_Factors:  [99.92807972 -1.00717252 -1.02774399]
mat_Sqrt:  [[13.05974008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02195395 -0.01042638  0.28427805]
Stock Position:  -0.021953950797210457
Bond Position:  [3.95364148]


portfolio before change:  [1.74497504]
curr_Stock_Price:  100.64953650502662
curr_Factors:  [100.64953651  -1.37996655  -1.04771794]
mat_Sqrt:  [[ 8.8814076   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00247967 0.02742366 0.30532199]
Stock Position:  0.002479672435841875
Bond Position:  [1.49539716]


portfolio before change:  [1.74558145]
curr_Stock_Price:  100.74330504813804
curr_Factors:  [100.74330505  -0.91494609  -1.07676812]
mat_Sqrt:  [[13.74756252  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024716 -0.03954705  0.10538137]
Stock Position:  -0.0002471604742429894
Bond Position:  [1.77048122]


portfolio before change:  [1.74574765]
curr_Stock_Price:  101.86193356176075
curr_Factors:  [101.86193356  -1.16677037  -1.10427673]
mat_Sqrt:  [[10.51256505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00360937 -0.00455813 -0.02970002]
Stock Position:  -0.0036093719306448525
Bond Position:  [2.11340525]


portfolio before change:  [1.74811866]
curr_Stock_Price:  101.35143019054192
curr_Factors:  [101.35143019  -1.21089428  -1.07720637]
mat_Sqrt:  [[10.28301318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02987705 -0.08571815 -0.59331731]
Stock Position:  0.029877050243043865
Bond Position:  [-1.27996311]


portfolio before change:  [1.77457338]
curr_Stock_Price:  102.24759474551612
curr_Factors:  [102.24759475  -1.15228618  -1.08004793]
mat_Sqrt:  [[10.96889083  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208728 -0.01350129 -0.22366994]
Stock Position:  -0.002087278560369569
Bond Position:  [1.9879926]


portfolio before change:  [1.77714162]
curr_Stock_Price:  101.25530777425905
curr_Factors:  [101.25530777  -1.15788428  -1.06545473]
mat_Sqrt:  [[10.96059009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051697 -0.02845143  0.0120735 ]
Stock Position:  -0.0005169697836140961
Bond Position:  [1.82948756]


portfolio before change:  [1.77805365]
curr_Stock_Price:  100.37596028262573
curr_Factors:  [100.37596028  -0.99842614  -1.07779307]
mat_Sqrt:  [[12.58749079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138416 -0.01078367 -0.03013482]
Stock Position:  -0.0013841561858176795
Bond Position:  [1.91698966]


portfolio before change:  [1.77715465]
curr_Stock_Price:  101.37173115597614
curr_Factors:  [101.37173116  -0.69330309  -1.09188069]
mat_Sqrt:  [[17.00675267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.68174929e-04  9.95981354e-03 -1.81515960e-01]
Stock Position:  -0.00016817492869952442
Bond Position:  [1.79420284]


portfolio before change:  [1.77750924]
curr_Stock_Price:  101.9307760273727
curr_Factors:  [101.93077603  -0.95115713  -1.08978191]
mat_Sqrt:  [[13.24148722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.023035    0.09584449  0.05608087]
Stock Position:  -0.023034995828037412
Bond Position:  [4.12548424]


portfolio before change:  [1.73703421]
curr_Stock_Price:  103.7326660678425
curr_Factors:  [103.73266607  -1.07406132  -1.07551747]
mat_Sqrt:  [[12.08830287  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00938027 -0.05033786  0.02279552]
Stock Position:  0.009380266796839225
Bond Position:  [0.76399413]


portfolio before change:  [1.71409484]
curr_Stock_Price:  101.26680925168957
curr_Factors:  [101.26680925  -0.68062932  -1.07836677]
mat_Sqrt:  [[17.43993376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00104194 0.02312943 0.12736787]
Stock Position:  0.0010419442746920752
Bond Position:  [1.60858047]


portfolio before change:  [1.71639783]
curr_Stock_Price:  103.09108423556928
curr_Factors:  [103.09108424  -0.77739201  -1.12442227]
mat_Sqrt:  [[15.39124176  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00292015  0.05422156  0.0133832 ]
Stock Position:  -0.0029201531463472815
Bond Position:  [2.01743958]


portfolio before change:  [1.71117634]
curr_Stock_Price:  105.05190946419245
curr_Factors:  [105.05190946  -0.5333905   -1.12818927]
mat_Sqrt:  [[19.94293277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00451166 -0.00658981  0.52759241]
Stock Position:  -0.004511661404162771
Bond Position:  [2.18513499]


portfolio before change:  [1.70700596]
curr_Stock_Price:  106.09736414873741
curr_Factors:  [106.09736415  -0.81137902  -1.12569719]
mat_Sqrt:  [[15.29125345  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00486716 -0.03325012  0.67664444]
Stock Position:  -0.004867157149371407
Bond Position:  [2.2233985]


portfolio before change:  [1.70751095]
curr_Stock_Price:  106.107828231024
curr_Factors:  [106.10782823  -0.95349738  -1.11081802]
mat_Sqrt:  [[13.46562877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00046357 0.00934774 0.00751389]
Stock Position:  0.00046356830707957854
Bond Position:  [1.65832272]


portfolio before change:  [1.70752411]
curr_Stock_Price:  105.24179147932101
curr_Factors:  [105.24179148  -0.97176336  -1.13536744]
mat_Sqrt:  [[12.79596225  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00580168  0.01664766  0.23179436]
Stock Position:  -0.0058016811127048415
Bond Position:  [2.31810343]


portfolio before change:  [1.70669811]
curr_Stock_Price:  105.48406523668196
curr_Factors:  [105.48406524  -0.9394455   -1.14157587]
mat_Sqrt:  [[13.16469367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00255252 -0.00538159  0.05864715]
Stock Position:  -0.0025525201924594763
Bond Position:  [1.97594832]


portfolio before change:  [1.71025049]
curr_Stock_Price:  104.28590687189569
curr_Factors:  [104.28590687  -0.6533023   -1.09297641]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.71025049]
Stock Price:  104.34204536108994
PL:  [-2.63179487]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.70507870e-01 -2.94969176e-02  8.30492390e-02]
 [-3.41059740e-01  2.42812346e-01 -3.85805279e-02]
 [-3.82859002e-02 -1.99267912e-01  3.37172853e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 2.86072863e-01 -2.07934284e-01 -1.43663406e-01]
 [ 6.04074459e-02  1.90324218e-02 -4.92826091e-03]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 1.36684697e-01 -7.97874649e-03  2.15730734e-04]
 [-1.24268577e-01  1.67129669e-02  1.26713266e-01]
 [-1.10115094e-01  9.19942803e-02 -3.33371760e-02]
 [-4.10603410e-03 -8.00857323e-02  4.86803838e-03]
 [ 1.07184819e-01  1.12775077e-01 -2.93164733e-02]
 [ 2.27567376e-02  1.48686541e-01  8.15762471e-02]
 [ 2.51417121e-02 -1.63089621e-01 -3.16899464e-02]
 [-1.23731746e-01 -8.70419533e-02  1.83798352e-01]
 [-8.61649293e-03  1.47358608e-01  2.07939142e-01]
 [-6.31082849e-02  1.21311044e-01  3.25456205e-02]
 [-4.01887955e-02 -4.46115781e-02  3.29907552e-02]
 [-3.09173202e-02  4.93800697e-01  2.21185529e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.86401962]
curr_Stock_Price:  100.2211915150777
curr_Factors:  [100.22119152  -0.70700328  -0.98708047]
mat_Sqrt:  [[18.41740073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01380852 -0.00932774  0.23691636]
Stock Position:  -0.01380852413125427
Bond Position:  [5.24792636]


portfolio before change:  [3.88114668]
curr_Stock_Price:  99.0758908848919
curr_Factors:  [99.07589088 -0.33793918 -0.95885331]
mat_Sqrt:  [[27.08807645  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01265005  0.07678401 -0.11005951]
Stock Position:  -0.012650051774934988
Bond Position:  [5.13446182]


portfolio before change:  [3.87791769]
curr_Stock_Price:  99.43262972401685
curr_Factors:  [99.43262972 -0.50659272 -0.98307418]
mat_Sqrt:  [[22.41686154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016304  -0.06301405  0.09618603]
Stock Position:  -0.0016304005549399318
Bond Position:  [4.0400327]


portfolio before change:  [3.87718968]
curr_Stock_Price:  100.49871134234583
curr_Factors:  [100.49871134  -0.84167043  -1.03096832]
mat_Sqrt:  [[15.44841097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00245616 -0.00455813 -0.02970002]
Stock Position:  -0.002456159229847232
Bond Position:  [4.12403052]


portfolio before change:  [3.88002366]
curr_Stock_Price:  99.76470061248412
curr_Factors:  [99.76470061 -0.51805475 -1.01587498]
mat_Sqrt:  [[21.51789016  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01168232 -0.06575459 -0.40983171]
Stock Position:  0.01168231882832503
Bond Position:  [2.71454062]


portfolio before change:  [3.88503412]
curr_Stock_Price:  100.1354945960107
curr_Factors:  [100.1354946   -0.69650553  -1.03941943]
mat_Sqrt:  [[17.64759046  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00339383  0.00601858 -0.01405896]
Stock Position:  0.003393827844368176
Bond Position:  [3.54519149]


portfolio before change:  [3.88619069]
curr_Stock_Price:  100.21509756252559
curr_Factors:  [100.21509756  -0.84328016  -1.02891296]
mat_Sqrt:  [[15.41168102  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036766 -0.02845143  0.0120735 ]
Stock Position:  -0.00036766228674271143
Bond Position:  [3.923036]


portfolio before change:  [3.88768095]
curr_Stock_Price:  98.82964308418804
curr_Factors:  [98.82964308 -0.88625065 -1.01289562]
mat_Sqrt:  [[14.79443834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00922798 -0.0025231   0.00061542]
Stock Position:  0.009227976050562137
Bond Position:  [2.97568337]


portfolio before change:  [3.8841275]
curr_Stock_Price:  98.36394424788135
curr_Factors:  [98.36394425 -0.89423067 -0.99831455]
mat_Sqrt:  [[14.82224498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00660978  0.0052851   0.36147768]
Stock Position:  -0.006609782338897944
Bond Position:  [4.53429176]


portfolio before change:  [3.88923027]
curr_Stock_Price:  97.76346300772711
curr_Factors:  [97.76346301 -0.88750796 -1.00085154]
mat_Sqrt:  [[14.79355215  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00774288  0.02909115 -0.09510168]
Stock Position:  -0.007742882415660786
Bond Position:  [4.64620127]


portfolio before change:  [3.88397214]
curr_Stock_Price:  98.59258844256492
curr_Factors:  [98.59258844 -1.27025306 -0.9863382 ]
mat_Sqrt:  [[10.32331395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00050179 -0.02532533  0.01388716]
Stock Position:  -0.0005017918339873138
Bond Position:  [3.9334451]


portfolio before change:  [3.88561511]
curr_Stock_Price:  97.2783382892972
curr_Factors:  [97.27833829 -1.2525873  -0.95760681]
mat_Sqrt:  [[10.66942553  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00975802  0.03566261 -0.08363174]
Stock Position:  0.009758019213455217
Bond Position:  [2.93637121]


portfolio before change:  [3.89420926]
curr_Stock_Price:  98.08382678592962
curr_Factors:  [98.08382679 -1.3984105  -0.95571902]
mat_Sqrt:  [[ 9.31562379  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00464247 0.04701881 0.23271433]
Stock Position:  0.004642468418344183
Bond Position:  [3.43885819]


portfolio before change:  [3.89911203]
curr_Stock_Price:  98.95468791483526
curr_Factors:  [98.95468791 -1.39600088 -0.97201745]
mat_Sqrt:  [[ 9.26870542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00156031 -0.05157347 -0.0904026 ]
Stock Position:  0.001560312073159251
Bond Position:  [3.74471184]


portfolio before change:  [3.89958834]
curr_Stock_Price:  98.65988669899559
curr_Factors:  [98.6598867  -1.11384411 -0.97206679]
mat_Sqrt:  [[12.25296002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0072196  -0.02752508  0.52432554]
Stock Position:  -0.007219600640533255
Bond Position:  [4.61187332]


portfolio before change:  [3.90751636]
curr_Stock_Price:  97.72148191610015
curr_Factors:  [97.72148192 -0.75768077 -0.98848325]
mat_Sqrt:  [[17.04671285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00220768 0.04659888 0.59319249]
Stock Position:  0.0022076801547705168
Bond Position:  [3.69177859]


portfolio before change:  [3.90733165]
curr_Stock_Price:  97.21969799120018
curr_Factors:  [97.21969799 -0.48554938 -0.97674148]
mat_Sqrt:  [[22.52627675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236758  0.03836192  0.0928436 ]
Stock Position:  -0.0023675772428323454
Bond Position:  [4.13750679]


portfolio before change:  [3.90550011]
curr_Stock_Price:  98.43023512145014
curr_Factors:  [98.43023512 -0.53601814 -1.00256808]
mat_Sqrt:  [[21.13143647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00163768 -0.01410742  0.09411344]
Stock Position:  -0.0016376762591989967
Bond Position:  [4.06669697]


portfolio before change:  [3.90522202]
curr_Stock_Price:  99.22092583075151
curr_Factors:  [99.22092583 -0.90272702 -1.00490869]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.90522202]
Stock Price:  98.75319339940097
PL:  [3.90522202]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.79592638e-01 -7.28338123e-02  1.81494431e-01]
 [-1.25498654e-01  1.51647910e-01  8.95012179e-02]
 [-1.14986835e-01 -4.23050880e-01 -1.93332066e-02]
 [-3.35510613e-02 -1.13200004e-02 -8.46643736e-03]
 [ 2.50746363e-01 -1.88915003e-01 -1.37543951e-01]
 [-7.59020628e-02  6.49817813e-02  2.72106558e-02]
 [-3.16046431e-03 -8.82082730e-02  3.95161194e-03]
 [-6.36072478e-02 -3.98625495e-02 -3.12923178e-02]
 [-5.44674309e-02  2.66447723e-02  2.46062012e-02]
 [ 2.45169826e-03  4.58567745e-02 -3.84308731e-02]
 [-2.40182202e-02 -6.70173568e-02 -4.61974503e-03]
 [ 1.19331919e-01  1.03655845e-02 -1.73634021e-01]
 [-9.66439045e-03  1.82701456e-01  5.67433468e-02]
 [ 1.29445785e-01 -1.73124801e-01  1.00587820e-01]
 [-4.53333106e-02 -4.27906766e-02  1.09494258e-01]
 [-1.56768401e-02  2.01538991e-01  3.92199143e-01]
 [ 5.05767506e-03 -8.31087636e-03 -3.06032091e-02]
 [ 1.08141204e-01  5.29792582e-02  1.84922882e-01]
 [-3.49854099e-02  4.71374333e-01  1.47528999e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.89589359]
curr_Stock_Price:  99.14024469666101
curr_Factors:  [99.1402447  -1.10917718 -1.02159438]
mat_Sqrt:  [[11.77247167  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0122681  -0.02303207  0.51775309]
Stock Position:  -0.012268095197055963
Bond Position:  [-2.67963163]


portfolio before change:  [-3.89632216]
curr_Stock_Price:  99.12056643202047
curr_Factors:  [99.12056643 -1.20161055 -1.00694222]
mat_Sqrt:  [[10.8893383   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00948761  0.04795528  0.25532206]
Stock Position:  -0.009487607029839817
Bond Position:  [-2.95590518]


portfolio before change:  [-3.89423725]
curr_Stock_Price:  98.8229168312891
curr_Factors:  [98.82291683 -0.9670643  -1.01592114]
mat_Sqrt:  [[13.60373094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00954564 -0.13378043 -0.05515226]
Stock Position:  -0.009545641285176196
Bond Position:  [-2.95090914]


portfolio before change:  [-3.89848616]
curr_Stock_Price:  99.1907377779496
curr_Factors:  [99.19073778 -0.72492919 -1.02082693]
mat_Sqrt:  [[17.31007195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00205496 -0.0035797  -0.02415239]
Stock Position:  -0.002054962385946804
Bond Position:  [-3.69465292]


portfolio before change:  [-3.90140703]
curr_Stock_Price:  100.16257743961036
curr_Factors:  [100.16257744  -0.40317781  -1.03414226]
mat_Sqrt:  [[23.79497853  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00915288 -0.05974017 -0.39237461]
Stock Position:  0.00915287890958878
Bond Position:  [-4.81818297]


portfolio before change:  [-3.91011188]
curr_Stock_Price:  99.34314596101692
curr_Factors:  [99.34314596 -0.43290567 -1.03097771]
mat_Sqrt:  [[22.98166203  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00298803  0.02054904  0.07762443]
Stock Position:  -0.002988029695531284
Bond Position:  [-3.61327161]


portfolio before change:  [-3.91562207]
curr_Stock_Price:  100.88488212446919
curr_Factors:  [100.88488212  -0.59730739  -1.07097903]
mat_Sqrt:  [[19.02385407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024345 -0.02789391  0.01127285]
Stock Position:  -0.0002434508119296023
Bond Position:  [-3.89106156]


portfolio before change:  [-3.91664454]
curr_Stock_Price:  101.08857773187144
curr_Factors:  [101.08857773  -0.86774248  -1.04540294]
mat_Sqrt:  [[14.92222512  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00475961 -0.01260564 -0.08926827]
Stock Position:  -0.004759612691010842
Bond Position:  [-3.43550207]


portfolio before change:  [-3.91021217]
curr_Stock_Price:  99.5566555680567
curr_Factors:  [99.55665557 -0.42429216 -1.04060932]
mat_Sqrt:  [[23.00761867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00211916  0.00842582  0.07019464]
Stock Position:  -0.0021191565598065636
Bond Position:  [-3.69923603]


portfolio before change:  [-3.90327777]
curr_Stock_Price:  95.84795199654968
curr_Factors:  [95.847952   -0.39885152 -1.04644745]
mat_Sqrt:  [[22.58902414  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018633  0.01450119 -0.10963258]
Stock Position:  -0.00018632739541394689
Bond Position:  [-3.88541867]


portfolio before change:  [-3.90407832]
curr_Stock_Price:  94.93062709610156
curr_Factors:  [ 9.49306271e+01 -3.56112419e-02 -1.06264837e+00]
mat_Sqrt:  [[31.65470412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084321 -0.02119275 -0.01317885]
Stock Position:  -0.0008432112445145682
Bond Position:  [-3.82403175]


portfolio before change:  [-3.90352708]
curr_Stock_Price:  93.14296892687658
curr_Factors:  [93.14296893 -0.10240998 -1.03709757]
mat_Sqrt:  [[29.80356653  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00282371  0.00327789 -0.49532953]
Stock Position:  0.002823711083177815
Bond Position:  [-4.16653591]


portfolio before change:  [-3.88814261]
curr_Stock_Price:  98.96021950422684
curr_Factors:  [98.9602195  -0.15758294 -1.03075365]
mat_Sqrt:  [[30.15592284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00022004 0.05777527 0.16187297]
Stock Position:  0.00022004393810664681
Bond Position:  [-3.9099182]


portfolio before change:  [-3.89030861]
curr_Stock_Price:  93.5594911610397
curr_Factors:  [93.55949116 -0.30161641 -1.08551889]
mat_Sqrt:  [[23.37021155  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00622622 -0.05474687  0.28694905]
Stock Position:  0.006226221960704026
Bond Position:  [-4.47283077]


portfolio before change:  [-3.88978568]
curr_Stock_Price:  93.82309848000615
curr_Factors:  [93.82309848 -0.50232944 -1.07747423]
mat_Sqrt:  [[19.32901637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012462  -0.0135316   0.31235664]
Stock Position:  -0.001246195819234299
Bond Position:  [-3.77286372]


portfolio before change:  [-3.88810584]
curr_Stock_Price:  91.71815803800162
curr_Factors:  [91.71815804 -0.60536042 -1.12442878]
mat_Sqrt:  [[16.26362752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00427852 0.06373222 1.11883499]
Stock Position:  0.004278515909392566
Bond Position:  [-4.28052344]


portfolio before change:  [-3.8876077]
curr_Stock_Price:  92.08473538848816
curr_Factors:  [92.08473539 -0.37087727 -1.12749651]
mat_Sqrt:  [[20.58032278  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.82090739e-05 -2.62812986e-03 -8.73024374e-02]
Stock Position:  -6.820907385989658e-05
Bond Position:  [-3.88132669]


portfolio before change:  [-3.88854841]
curr_Stock_Price:  91.6487057297636
curr_Factors:  [91.64870573 -0.40692287 -1.10651543]
mat_Sqrt:  [[20.17662081  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00729837 0.01675351 0.52753351]
Stock Position:  0.007298365245266366
Bond Position:  [-4.55743414]


portfolio before change:  [-3.8879815]
curr_Stock_Price:  91.88251280662433
curr_Factors:  [91.88251281 -0.27301905 -1.08127515]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.8879815]
Stock Price:  90.46233400609671
PL:  [-3.8879815]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.19196937e-01 -3.54793721e-02  8.87846663e-02]
 [-3.01051624e-01  2.24316106e-01 -2.17226227e-02]
 [-8.63988266e-02 -2.55277358e-01  1.56638429e-03]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 2.63908925e-01 -1.76500838e-01 -1.26579355e-01]
 [ 5.75588316e-02  1.98944101e-02 -1.61793841e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 9.44402053e-02 -1.63417423e-02  2.64669052e-03]
 [-1.30985586e-01  1.49249109e-02  1.40760599e-01]
 [-1.61160548e-01  1.51108812e-01  3.31420112e-03]
 [ 4.84205343e-02 -1.11131782e-01  3.39705130e-03]
 [ 6.29025919e-02  9.73092225e-02  1.88231772e-02]
 [ 1.43019650e-02  1.67885417e-01  7.91059664e-02]
 [-8.84516455e-03 -4.52863131e-02 -1.50069483e-02]
 [-1.48800921e-01 -1.09423693e-01  2.25856316e-01]
 [ 2.24954940e-02  3.50005173e-02  3.14221591e-02]
 [-9.10115785e-02  5.47404412e-02  8.01051756e-02]
 [-3.59694324e-02 -1.36937304e-02  2.09151136e-02]
 [-1.94638210e-02  5.21903397e-01  2.97520829e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.02220208]
curr_Stock_Price:  99.5405465573212
curr_Factors:  [99.54054656 -0.54163039 -1.03341887]
mat_Sqrt:  [[20.60462996  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00980313 -0.01121956  0.25327794]
Stock Position:  -0.009803132437120022
Bond Position:  [-0.04639292]


portfolio before change:  [-1.01436063]
curr_Stock_Price:  98.73947132186593
curr_Factors:  [98.73947132 -0.62858213 -1.00819489]
mat_Sqrt:  [[19.21531761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01559662  0.07093498 -0.0619686 ]
Stock Position:  -0.015596615414216487
Bond Position:  [0.52564093]


portfolio before change:  [-1.01440924]
curr_Stock_Price:  98.75101458614866
curr_Factors:  [98.75101459 -0.41992006 -0.94803557]
mat_Sqrt:  [[25.14467254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00368549 -0.08072579  0.00446846]
Stock Position:  -0.003685485368523202
Bond Position:  [-0.65046382]


portfolio before change:  [-1.01745002]
curr_Stock_Price:  99.5319542100436
curr_Factors:  [99.53195421 -0.53162976 -0.92391137]
mat_Sqrt:  [[23.21822688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00163422 -0.00455813 -0.02970002]
Stock Position:  -0.0016342228627682798
Bond Position:  [-0.85479262]


portfolio before change:  [-1.01466096]
curr_Stock_Price:  97.69451777346487
curr_Factors:  [97.69451777 -0.74837009 -0.89499994]
mat_Sqrt:  [[18.88702938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01236371 -0.05581447 -0.36109567]
Stock Position:  0.012363711918208783
Bond Position:  [-2.22252784]


portfolio before change:  [-0.98422162]
curr_Stock_Price:  100.20145464944088
curr_Factors:  [100.20145465  -1.02461263  -0.94429302]
mat_Sqrt:  [[13.98908041  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00391519  0.00629116 -0.04615528]
Stock Position:  0.003915189451679407
Bond Position:  [-1.3765293]


portfolio before change:  [-0.98196355]
curr_Stock_Price:  100.86610799220774
curr_Factors:  [100.86610799  -1.23603341  -0.9108227 ]
mat_Sqrt:  [[11.78630036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048075 -0.02845143  0.0120735 ]
Stock Position:  -0.0004807525445070693
Bond Position:  [-0.93347191]


portfolio before change:  [-0.98153621]
curr_Stock_Price:  99.491719296351
curr_Factors:  [99.4917193  -1.0060155  -0.85624225]
mat_Sqrt:  [[15.45320868  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00611902 -0.00516771  0.00755027]
Stock Position:  0.006119021539130695
Bond Position:  [-1.59032818]


portfolio before change:  [-0.99013503]
curr_Stock_Price:  98.1514404544042
curr_Factors:  [98.15144045 -0.90693344 -0.86134706]
mat_Sqrt:  [[16.74720032  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00608266  0.00471967  0.40155081]
Stock Position:  -0.00608266384014186
Bond Position:  [-0.39311281]


portfolio before change:  [-0.99848115]
curr_Stock_Price:  99.5073971898101
curr_Factors:  [99.50739719 -0.82759609 -0.87991183]
mat_Sqrt:  [[18.04239139  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00867858  0.0477848   0.00945449]
Stock Position:  -0.008678584960002822
Bond Position:  [-0.13489775]


portfolio before change:  [-0.99795173]
curr_Stock_Price:  99.44250747972892
curr_Factors:  [99.44250748 -0.97421248 -0.87511246]
mat_Sqrt:  [[15.64661682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00295556 -0.03514296  0.00969084]
Stock Position:  0.0029555618791348797
Bond Position:  [-1.29186021]


portfolio before change:  [-0.9993433]
curr_Stock_Price:  99.0809651641302
curr_Factors:  [99.08096516 -1.06702073 -0.872002  ]
mat_Sqrt:  [[14.25224761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0048594  0.03077188 0.05369729]
Stock Position:  0.004859399865043339
Bond Position:  [-1.48081732]


portfolio before change:  [-1.00677353]
curr_Stock_Price:  97.62811360023333
curr_Factors:  [97.6281136  -0.46367557 -0.88295748]
mat_Sqrt:  [[25.39449598  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00136975 0.05309003 0.2256673 ]
Stock Position:  0.0013697529439957803
Bond Position:  [-1.14049993]


portfolio before change:  [-1.00728325]
curr_Stock_Price:  97.46417800196117
curr_Factors:  [97.464178   -0.35753654 -0.87409582]
mat_Sqrt:  [[28.44159118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045981 -0.01432079 -0.04281065]
Stock Position:  -0.00045981016133373316
Bond Position:  [-0.96246823]


portfolio before change:  [-1.00965254]
curr_Stock_Price:  102.0935876894003
curr_Factors:  [102.09358769  -0.68253354  -0.90003945]
mat_Sqrt:  [[20.97469951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00503099 -0.03460281  0.6443052 ]
Stock Position:  -0.005030989893186028
Bond Position:  [-0.49602073]


portfolio before change:  [-1.02596833]
curr_Stock_Price:  105.31199399847817
curr_Factors:  [105.311994    -0.9351548   -0.96363837]
mat_Sqrt:  [[15.77039025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00189046 0.01106814 0.08963867]
Stock Position:  0.0018904557422113543
Bond Position:  [-1.225056]


portfolio before change:  [-1.02553702]
curr_Stock_Price:  105.70217135379525
curr_Factors:  [105.70217135  -0.70505063  -0.99814577]
mat_Sqrt:  [[19.24842103  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380534  0.01731045  0.22851777]
Stock Position:  -0.0038053399703166517
Bond Position:  [-0.62330432]


portfolio before change:  [-1.02614988]
curr_Stock_Price:  105.8222683710348
curr_Factors:  [105.82226837  -0.90728231  -0.99599294]
mat_Sqrt:  [[15.77593572  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00203181 -0.00433034  0.059665  ]
Stock Position:  -0.0020318112281682006
Bond Position:  [-0.811139]


portfolio before change:  [-1.02475652]
curr_Stock_Price:  105.03667801712719
curr_Factors:  [105.03667802  -1.24130985  -0.97269012]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.02475652]
Stock Price:  104.91993889122706
PL:  [-5.94469541]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.10628884e-01 -2.36688858e-02  5.51986151e-02]
 [ 1.88349118e-02  6.07274353e-02  4.41884135e-02]
 [-2.01811389e-02 -1.69431038e-01  3.80459383e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 5.33429979e-01 -3.34975706e-01 -1.65862689e-01]
 [-2.13315363e-02  3.62150521e-02 -3.61304023e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 4.37405789e-02 -2.50643093e-02 -5.19986323e-04]
 [-7.13883239e-02  2.48586197e-02  4.62064316e-02]
 [-1.59935046e-01  1.43238004e-01 -1.24906307e-02]
 [ 4.03867656e-02 -1.06561172e-01  5.01439145e-03]
 [ 5.09266119e-02  9.42756744e-02  2.76427257e-02]
 [-9.83427775e-03  1.65883394e-01  5.00216406e-02]
 [-3.52457231e-02 -1.18559649e-01 -8.80615515e-02]
 [-1.47233337e-01 -1.04505705e-01  2.13417865e-01]
 [ 3.84275061e-02  8.07750795e-02  1.24129302e-01]
 [-1.17875917e-01  4.29582193e-02  6.24349011e-02]
 [-4.62707968e-02 -4.38568165e-02  2.17712054e-02]
 [-3.14316778e-02  4.85249354e-01  2.27636774e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.5341743]
curr_Stock_Price:  101.1503362472608
curr_Factors:  [101.15033625  -1.08572161  -0.98334116]
mat_Sqrt:  [[12.77570237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01565258 -0.00748476  0.15746628]
Stock Position:  -0.015652575162868113
Bond Position:  [12.11743754]


portfolio before change:  [10.54786416]
curr_Stock_Price:  100.46929019016542
curr_Factors:  [100.46929019  -0.88393771  -0.98138375]
mat_Sqrt:  [[15.55731045  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00189125 0.0192037  0.12605724]
Stock Position:  0.0018912529683764853
Bond Position:  [10.35785131]


portfolio before change:  [10.5501528]
curr_Stock_Price:  100.3100623521371
curr_Factors:  [100.31006235  -0.84494744  -1.00996927]
mat_Sqrt:  [[15.69511164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106974 -0.0535788   0.10853447]
Stock Position:  -0.0010697429387551806
Bond Position:  [10.65745879]


portfolio before change:  [10.55288716]
curr_Stock_Price:  100.24494631877866
curr_Factors:  [100.24494632  -1.19652472  -1.0040245 ]
mat_Sqrt:  [[11.10135788  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00341794 -0.00455813 -0.02970002]
Stock Position:  -0.0034179383836450018
Bond Position:  [10.89551821]


portfolio before change:  [10.5595305]
curr_Stock_Price:  99.09831324031408
curr_Factors:  [99.09831324 -1.00821725 -1.01024393]
mat_Sqrt:  [[13.1661777   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03728678 -0.10592862 -0.47316008]
Stock Position:  0.03728677942374312
Bond Position:  [6.86447355]


portfolio before change:  [10.61927433]
curr_Stock_Price:  100.65456187761022
curr_Factors:  [100.65456188  -1.48337787  -1.02120197]
mat_Sqrt:  [[ 8.22447642  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0033767   0.01145221 -0.10306998]
Stock Position:  -0.0033766958177900235
Bond Position:  [10.95915417]


portfolio before change:  [10.62300553]
curr_Stock_Price:  100.3610592593786
curr_Factors:  [100.36105926  -1.29079703  -1.05537278]
mat_Sqrt:  [[ 9.60808049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058974 -0.02845143  0.0120735 ]
Stock Position:  -0.000589742549871647
Bond Position:  [10.68219272]


portfolio before change:  [10.62593459]
curr_Stock_Price:  99.92328878440175
curr_Factors:  [99.92328878 -1.13093424 -1.07598308]
mat_Sqrt:  [[10.995493    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00390954 -0.00792603 -0.00148338]
Stock Position:  0.003909536345190192
Bond Position:  [10.23528086]


portfolio before change:  [10.62677821]
curr_Stock_Price:  99.48448650187746
curr_Factors:  [99.4844865  -0.9747495  -1.04089556]
mat_Sqrt:  [[13.25475905  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00462586  0.00786099  0.13181409]
Stock Position:  -0.004625857666602083
Bond Position:  [11.08697929]


portfolio before change:  [10.63204415]
curr_Stock_Price:  98.94537640109117
curr_Factors:  [98.9453764  -0.8746978  -1.02797616]
mat_Sqrt:  [[14.75960388  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01075817  0.04529583 -0.03563229]
Stock Position:  -0.01075816786164333
Bond Position:  [11.69651512]


portfolio before change:  [10.62507653]
curr_Stock_Price:  99.86487468634242
curr_Factors:  [99.86487469 -1.27295631 -1.03189046]
mat_Sqrt:  [[ 9.96392678  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00387989 -0.0336976   0.01430466]
Stock Position:  0.0038798886392718414
Bond Position:  [10.23761194]


portfolio before change:  [10.62667018]
curr_Stock_Price:  99.61587954192912
curr_Factors:  [99.61587954 -1.17760959 -1.03580265]
mat_Sqrt:  [[10.89070148  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00541777 0.02981259 0.078857  ]
Stock Position:  0.005417772880855273
Bond Position:  [10.08697397]


portfolio before change:  [10.63193486]
curr_Stock_Price:  100.1221057433592
curr_Factors:  [100.12210574  -0.97609109  -1.0454605 ]
mat_Sqrt:  [[13.26115267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00035136 0.05245693 0.14269782]
Stock Position:  0.0003513599312456455
Bond Position:  [10.59675596]


portfolio before change:  [10.63436011]
curr_Stock_Price:  99.48383353697326
curr_Factors:  [99.48383354 -1.06620847 -1.03700275]
mat_Sqrt:  [[12.1433772   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00463482 -0.03749185 -0.25121509]
Stock Position:  -0.004634823420258067
Bond Position:  [11.09545011]


portfolio before change:  [10.63489162]
curr_Stock_Price:  99.96771501189275
curr_Factors:  [99.96771501 -0.77632223 -1.04405561]
mat_Sqrt:  [[16.19122533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00656948 -0.03304761  0.60882176]
Stock Position:  -0.006569479551415059
Bond Position:  [11.29162748]


portfolio before change:  [10.62918473]
curr_Stock_Price:  101.26616646019971
curr_Factors:  [101.26616646  -0.88283168  -1.02961253]
mat_Sqrt:  [[14.95892556  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00440211 0.02554332 0.35410635]
Stock Position:  0.0044021141202216785
Bond Position:  [10.18339951]


portfolio before change:  [10.63001714]
curr_Stock_Price:  100.87686333424833
curr_Factors:  [100.87686333  -0.93407194  -1.07654291]
mat_Sqrt:  [[13.5080492   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00770076  0.01358458  0.17810939]
Stock Position:  -0.007700761855703902
Bond Position:  [11.40684584]


portfolio before change:  [10.62587838]
curr_Stock_Price:  101.78467354795822
curr_Factors:  [101.78467355  -1.18516149  -1.06547756]
mat_Sqrt:  [[10.72117211  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00400694 -0.01386874  0.06210719]
Stock Position:  -0.004006944933632786
Bond Position:  [11.03372396]


portfolio before change:  [10.62684983]
curr_Stock_Price:  102.23072913278257
curr_Factors:  [102.23072913  -1.30796237  -1.06342538]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.62684983]
Stock Price:  101.16509968124969
PL:  [9.46175015]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.09625218e-01 -3.48445975e-02  1.05397319e-01]
 [-4.47740855e-02  9.90293172e-02  5.64044922e-02]
 [-3.35240761e-02 -2.21105736e-01  4.17965910e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 2.97270263e-01 -2.06885583e-01 -1.33814000e-01]
 [-8.65202105e-02  6.76395867e-02  2.79802605e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 8.96143930e-02 -1.55511227e-02 -5.15831783e-03]
 [-1.44875217e-01  1.06771562e-02  1.72599526e-01]
 [-1.93369864e-02  4.79899801e-02 -4.31484371e-02]
 [ 1.39401531e-02 -9.04401663e-02  1.92039167e-03]
 [ 5.17414813e-02  9.44063822e-02  2.73192828e-02]
 [-7.97923998e-03  1.66586937e-01  5.24701501e-02]
 [-4.48521840e-02 -7.10632827e-02 -5.81330455e-02]
 [-1.44484618e-01 -1.02463165e-01  2.09953601e-01]
 [ 2.79739590e-02  9.55361809e-02  1.44105967e-01]
 [-1.09008809e-01  5.67680815e-02  5.62318733e-02]
 [-4.95471324e-02 -5.75939520e-02  2.46608080e-02]
 [-3.90768729e-02  4.28265552e-01  1.58006740e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.54047877]
curr_Stock_Price:  99.89752499685483
curr_Factors:  [99.897525   -1.12413408 -0.99158808]
mat_Sqrt:  [[12.04226746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0239997  -0.01101883  0.30066922]
Stock Position:  -0.023999696472295613
Bond Position:  [3.93798905]


portfolio before change:  [1.54365407]
curr_Stock_Price:  99.8062452659483
curr_Factors:  [99.80624527 -0.97378189 -1.03920898]
mat_Sqrt:  [[13.33296966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00230284  0.03131582  0.16090632]
Stock Position:  -0.0023028358727875753
Bond Position:  [1.77349148]


portfolio before change:  [1.54259393]
curr_Stock_Price:  100.45916660352192
curr_Factors:  [100.4591666   -1.09388883  -1.08500718]
mat_Sqrt:  [[11.36860178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270054 -0.06991977  0.11923404]
Stock Position:  -0.0027005351132631692
Bond Position:  [1.81388744]


portfolio before change:  [1.54266129]
curr_Stock_Price:  100.60216462344518
curr_Factors:  [100.60216462  -1.06609262  -1.09532797]
mat_Sqrt:  [[11.58548688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00327511 -0.00455813 -0.02970002]
Stock Position:  -0.0032751111445831487
Bond Position:  [1.87214456]


portfolio before change:  [1.54770553]
curr_Stock_Price:  99.20491541563779
curr_Factors:  [99.20491542 -0.7447976  -1.09461869]
mat_Sqrt:  [[15.76466865  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01678525 -0.06542297 -0.38173409]
Stock Position:  0.01678524536585467
Bond Position:  [-0.11747332]


portfolio before change:  [1.53143324]
curr_Stock_Price:  98.2372254261775
curr_Factors:  [98.23722543 -0.73865754 -1.09376058]
mat_Sqrt:  [[15.72052372  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00502924  0.02138952  0.07981989]
Stock Position:  -0.005029241932707702
Bond Position:  [2.02549202]


portfolio before change:  [1.53209373]
curr_Stock_Price:  98.20659461355224
curr_Factors:  [98.20659461 -0.70299752 -1.08175193]
mat_Sqrt:  [[16.48290725  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034377 -0.02845143  0.0120735 ]
Stock Position:  -0.00034376786816181867
Bond Position:  [1.565854]


portfolio before change:  [1.53225422]
curr_Stock_Price:  98.87861752200897
curr_Factors:  [98.87861752 -0.69370519 -1.02800548]
mat_Sqrt:  [[17.67555027  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00498768 -0.0049177  -0.01471524]
Stock Position:  0.004987676545904833
Bond Position:  [1.03907966]


portfolio before change:  [1.52645528]
curr_Stock_Price:  97.66387413819484
curr_Factors:  [97.66387414 -0.50221673 -1.03312521]
mat_Sqrt:  [[21.03504349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00519931  0.00337641  0.49237841]
Stock Position:  -0.005199314357803579
Bond Position:  [2.03424046]


portfolio before change:  [1.53156329]
curr_Stock_Price:  96.77925972624293
curr_Factors:  [96.77925973 -0.59515787 -1.00729859]
mat_Sqrt:  [[19.49145683  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138038  0.01517576 -0.12309048]
Stock Position:  -0.0013803754408471171
Bond Position:  [1.665155]


portfolio before change:  [1.5301394]
curr_Stock_Price:  98.11239943163312
curr_Factors:  [98.11239943 -0.67173547 -1.01669082]
mat_Sqrt:  [[18.13216561  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00066164 -0.02859969  0.00547834]
Stock Position:  0.0006616416692803199
Bond Position:  [1.46522415]


portfolio before change:  [1.53156954]
curr_Stock_Price:  99.720196148241
curr_Factors:  [99.72019615 -0.83349411 -1.02556284]
mat_Sqrt:  [[15.53835177  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00384568 0.02985392 0.07793431]
Stock Position:  0.003845682591327577
Bond Position:  [1.14807731]


portfolio before change:  [1.53296634]
curr_Stock_Price:  100.00876604974363
curr_Factors:  [100.00876605  -0.96357672  -1.02503439]
mat_Sqrt:  [[13.68974119  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0005137  0.05267942 0.14968273]
Stock Position:  0.0005137015149112832
Bond Position:  [1.48159168]


portfolio before change:  [1.53303403]
curr_Stock_Price:  99.4194186210269
curr_Factors:  [99.41941862 -0.63133359 -1.01886493]
mat_Sqrt:  [[19.0897002   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306728 -0.02247218 -0.1658374 ]
Stock Position:  -0.003067276473307224
Bond Position:  [1.83798088]


portfolio before change:  [1.53352209]
curr_Stock_Price:  99.4101274468341
curr_Factors:  [99.41012745 -0.59855326 -1.0169579 ]
mat_Sqrt:  [[19.76164295  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00527657 -0.0324017   0.59893918]
Stock Position:  -0.0052765656442605065
Bond Position:  [2.05806615]


portfolio before change:  [1.53116528]
curr_Stock_Price:  99.95430492640517
curr_Factors:  [99.95430493 -0.81354514 -1.04244652]
mat_Sqrt:  [[15.62264504  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00383137 0.03021119 0.41109421]
Stock Position:  0.0038313742527077955
Bond Position:  [1.14820293]


portfolio before change:  [1.53160501]
curr_Stock_Price:  99.99414553996134
curr_Factors:  [99.99414554 -0.7236217  -1.04612968]
mat_Sqrt:  [[17.03653667  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00563875  0.01795164  0.16041388]
Stock Position:  -0.005638750568671022
Bond Position:  [2.09544705]


portfolio before change:  [1.53714349]
curr_Stock_Price:  99.10484291565783
curr_Factors:  [99.10484292 -0.99560808 -0.98130002]
mat_Sqrt:  [[13.725703    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0033514  -0.01821281  0.07035042]
Stock Position:  -0.0033514010511246604
Bond Position:  [1.86928357]


portfolio before change:  [1.5411532]
curr_Stock_Price:  98.04787416909839
curr_Factors:  [98.04787417 -1.3808279  -0.95107055]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.5411532]
Stock Price:  97.5859193752697
PL:  [1.5411532]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.05000390e-01 -2.31210635e-02  5.25807172e-02]
 [ 6.28702558e-02  3.31687841e-02  3.11562632e-02]
 [-4.22105412e-02 -2.41086967e-01  3.91114579e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.72519703e-01 -3.14016856e-01 -2.82121897e-01]
 [-6.13600938e-02 -1.08096544e-01 -1.36366337e-01]
 [-1.52513138e-03 -8.54537120e-02  3.51310842e-03]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [-1.05332975e-01 -5.48992949e-02 -1.35946931e-01]
 [-5.66966667e-01  5.60158014e-01  7.82563274e-02]
 [ 8.84884631e-02 -1.98339591e-01  8.56039201e-02]
 [-1.58443272e-01 -2.37418254e-02 -2.26149952e-02]
 [-1.47633659e-01  9.69667294e-02 -1.38322218e-01]
 [-1.10564072e-01  9.58442143e-02  3.44133025e-02]
 [-2.35303863e-01 -1.69938806e-01  3.24384045e-01]
 [ 2.85681126e-02  2.57816542e-02  4.28885987e-02]
 [-9.32980896e-02  5.06501909e-02  8.23466839e-02]
 [-3.09392229e-02  1.44455400e-03  2.02384340e-02]
 [ 4.79154590e-04  5.58842275e-01  3.98411818e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.56954927]
curr_Stock_Price:  101.15526393934242
curr_Factors:  [101.15526394  -0.92970813  -0.99475052]
mat_Sqrt:  [[14.76409102  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01319854 -0.00731152  0.14999815]
Stock Position:  -0.013198535471220407
Bond Position:  [11.90465061]


portfolio before change:  [10.57237328]
curr_Stock_Price:  101.16681966925832
curr_Factors:  [101.16681967  -0.92414864  -0.99936626]
mat_Sqrt:  [[14.77971952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00474207 0.01048889 0.08888015]
Stock Position:  0.004742066700767133
Bond Position:  [10.09263348]


portfolio before change:  [10.5709489]
curr_Stock_Price:  100.33430161530008
curr_Factors:  [100.33430162  -1.11009223  -0.97950027]
mat_Sqrt:  [[12.41512044  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325827 -0.07623839  0.1115741 ]
Stock Position:  -0.0032582677876677457
Bond Position:  [10.89786492]


portfolio before change:  [10.56700464]
curr_Stock_Price:  102.38111647287415
curr_Factors:  [102.38111647  -1.40298366  -1.01104054]
mat_Sqrt:  [[ 9.15846044  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00414303 -0.00455813 -0.02970002]
Stock Position:  -0.004143027906350077
Bond Position:  [10.99117246]


portfolio before change:  [10.56683346]
curr_Stock_Price:  103.08574972546762
curr_Factors:  [103.08574973  -1.25646917  -0.97323487]
mat_Sqrt:  [[11.08792998  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02767189 -0.09930085 -0.80481524]
Stock Position:  0.027671885780491418
Bond Position:  [7.71425637]


portfolio before change:  [10.59453898]
curr_Stock_Price:  104.0172624673075
curr_Factors:  [104.01726247  -1.45210892  -1.00610391]
mat_Sqrt:  [[ 8.90260597  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01033257 -0.03418313 -0.3890152 ]
Stock Position:  -0.010332569670369336
Bond Position:  [11.66930459]


portfolio before change:  [10.59731371]
curr_Stock_Price:  104.03109782357149
curr_Factors:  [104.03109782  -1.44204489  -1.01520597]
mat_Sqrt:  [[ 8.91235949  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033823 -0.02702284  0.01002192]
Stock Position:  -0.0003382299020746926
Bond Position:  [10.63250014]


portfolio before change:  [10.59979734]
curr_Stock_Price:  104.54799200273372
curr_Factors:  [104.547992    -1.85066832  -1.01001396]
mat_Sqrt:  [[ 5.98325023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02332935 -0.01496598 -0.14840805]
Stock Position:  -0.023329349219559915
Bond Position:  [13.03883396]


portfolio before change:  [10.58791834]
curr_Stock_Price:  105.19692218647614
curr_Factors:  [105.19692219  -1.59085146  -1.03908606]
mat_Sqrt:  [[ 7.58290621  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01773733 -0.01736068 -0.38781875]
Stock Position:  -0.017737331294685035
Bond Position:  [12.453831]


portfolio before change:  [10.57628121]
curr_Stock_Price:  106.02855667923862
curr_Factors:  [106.02855668  -1.40763181  -1.03775474]
mat_Sqrt:  [[ 9.19189311  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05836985  0.17713752  0.22324352]
Stock Position:  -0.058369852387572384
Bond Position:  [16.76515241]


portfolio before change:  [10.53797367]
curr_Stock_Price:  106.7566612244316
curr_Factors:  [106.75666122  -1.05133736  -1.08827188]
mat_Sqrt:  [[12.56534739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00802534 -0.06272049  0.24420416]
Stock Position:  0.008025339913346948
Bond Position:  [9.68121517]


portfolio before change:  [10.54114934]
curr_Stock_Price:  106.85074604359946
curr_Factors:  [106.85074604  -1.12146494  -1.08260017]
mat_Sqrt:  [[11.7913694   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01388071 -0.00750782 -0.06451429]
Stock Position:  -0.013880707510153028
Bond Position:  [12.02431329]


portfolio before change:  [10.51863449]
curr_Stock_Price:  108.68936231186419
curr_Factors:  [108.68936231  -1.25213442  -1.06350159]
mat_Sqrt:  [[10.72800827  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01616003  0.03066357 -0.39459479]
Stock Position:  -0.01616002606304493
Bond Position:  [12.27505742]


portfolio before change:  [10.52587191]
curr_Stock_Price:  108.43142542418458
curr_Factors:  [108.43142542  -1.17650108  -1.06427265]
mat_Sqrt:  [[11.53451939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00876194  0.0303086   0.09817157]
Stock Position:  -0.008761942802171303
Bond Position:  [11.47594186]


portfolio before change:  [10.52780605]
curr_Stock_Price:  108.53816058806285
curr_Factors:  [108.53816059  -1.55747271  -1.05495793]
mat_Sqrt:  [[ 7.96192802  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02178832 -0.05373937  0.92537739]
Stock Position:  -0.02178832156697011
Bond Position:  [12.89267039]


portfolio before change:  [10.5333066]
curr_Stock_Price:  108.43365599807247
curr_Factors:  [108.433656    -1.64971869  -0.99867087]
mat_Sqrt:  [[ 7.67331684  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00495071 0.00815287 0.12234923]
Stock Position:  0.004950713146164424
Bond Position:  [9.99648267]


portfolio before change:  [10.53283575]
curr_Stock_Price:  107.83368668920866
curr_Factors:  [107.83368669  -1.12880563  -1.01692467]
mat_Sqrt:  [[12.61466218  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00595984  0.016017    0.23491217]
Stock Position:  -0.005959839414397594
Bond Position:  [11.17550721]


portfolio before change:  [10.53403925]
curr_Stock_Price:  108.10059411099977
curr_Factors:  [108.10059411  -1.26411934  -1.01997107]
mat_Sqrt:  [[11.01184822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243109  0.00045681  0.05773462]
Stock Position:  -0.0024310879616770494
Bond Position:  [10.79684131]


portfolio before change:  [10.53455982]
curr_Stock_Price:  108.99689344632222
curr_Factors:  [108.99689345  -1.02875994  -1.01514199]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.53455982]
Stock Price:  109.59005179785937
PL:  [0.94450802]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.98678895e-01 -4.31857195e-02  1.25672985e-01]
 [-2.58716655e-01  2.20037339e-01  6.32028894e-02]
 [-3.54442621e-02 -2.25052441e-01  4.08842018e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 6.59048499e-01 -3.87311556e-01 -1.57322244e-01]
 [-2.51574381e-02  5.27945930e-02  1.44059253e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 2.39471449e-01  9.67050772e-03  6.79588024e-03]
 [-1.14960445e-01  2.01852731e-02  1.02202983e-01]
 [-1.52255730e-01  1.30838067e-01 -2.48584661e-02]
 [ 2.24245579e-02 -9.55885181e-02  2.72918259e-03]
 [ 8.50639945e-02  1.05895535e-01 -8.36159410e-03]
 [-4.99727221e-03  1.75854750e-01  5.95617985e-02]
 [-5.09834308e-02 -3.87419821e-02 -3.90833612e-02]
 [-1.53203456e-01 -1.08942029e-01  2.20942122e-01]
 [-3.41415139e-02  1.06038610e-01  5.05627677e-02]
 [-1.75250243e-01 -3.03657233e-02  8.31219420e-02]
 [-4.98454666e-02 -5.47275142e-02  2.23233423e-02]
 [-1.46385694e-02  5.93991982e-01  3.37155225e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.01329818]
curr_Stock_Price:  99.68479053050274
curr_Factors:  [99.68479053 -0.99025176 -1.00007794]
mat_Sqrt:  [[13.62196288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02012493 -0.01365652  0.35851004]
Stock Position:  -0.0201249303868399
Bond Position:  [2.01944765]


portfolio before change:  [0.03150155]
curr_Stock_Price:  98.80536185582537
curr_Factors:  [98.80536186 -0.87468853 -1.01158309]
mat_Sqrt:  [[14.98246109  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01602768  0.06958192  0.18030025]
Stock Position:  -0.016027679159495718
Bond Position:  [1.61512219]


portfolio before change:  [0.00754956]
curr_Stock_Price:  100.32497165145014
curr_Factors:  [100.32497165  -1.04188174  -1.04417243]
mat_Sqrt:  [[12.45796853  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264165 -0.07116783  0.11663125]
Stock Position:  -0.002641653675627714
Bond Position:  [0.27257339]


portfolio before change:  [0.00752185]
curr_Stock_Price:  100.36126191377295
curr_Factors:  [100.36126191  -1.07154048  -1.06242003]
mat_Sqrt:  [[11.87951855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00319405 -0.00455813 -0.02970002]
Stock Position:  -0.0031940483990532446
Bond Position:  [0.32808058]


portfolio before change:  [0.01202314]
curr_Stock_Price:  98.97766806410583
curr_Factors:  [98.97766806 -1.26371889 -1.06537782]
mat_Sqrt:  [[ 9.63880886  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0640053  -0.12247867 -0.44879657]
Stock Position:  0.06400530376964976
Bond Position:  [-6.32307257]


portfolio before change:  [0.03181469]
curr_Stock_Price:  99.3115858295441
curr_Factors:  [99.31158583 -1.21933657 -1.07239124]
mat_Sqrt:  [[10.03957146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207715  0.01669512  0.04109609]
Stock Position:  -0.0020771494573534025
Bond Position:  [0.23809969]


portfolio before change:  [0.03254018]
curr_Stock_Price:  98.99097358977319
curr_Factors:  [98.99097359 -1.1846926  -1.07892205]
mat_Sqrt:  [[10.292485    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055053 -0.02845143  0.0120735 ]
Stock Position:  -0.0005505272911112689
Bond Position:  [0.08703741]


portfolio before change:  [0.03296783]
curr_Stock_Price:  98.25370569850551
curr_Factors:  [98.2537057  -1.05546324 -1.05018502]
mat_Sqrt:  [[11.9640307   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02015277 0.00305808 0.01938675]
Stock Position:  0.020152768745428252
Bond Position:  [-1.94711638]


portfolio before change:  [0.04363761]
curr_Stock_Price:  98.80730832815132
curr_Factors:  [98.80730833 -1.15803393 -1.06131008]
mat_Sqrt:  [[10.73841568  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00871424  0.00638314  0.29155666]
Stock Position:  -0.008714243277624704
Bond Position:  [0.90466853]


portfolio before change:  [0.04936292]
curr_Stock_Price:  98.17625952033775
curr_Factors:  [98.17625952 -0.99564146 -1.09368888]
mat_Sqrt:  [[12.15127479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01266959  0.04137463 -0.07091428]
Stock Position:  -0.012669594082497607
Bond Position:  [1.29321628]


portfolio before change:  [0.04555463]
curr_Stock_Price:  98.50236560534093
curr_Factors:  [98.50236561 -0.75917597 -1.11979215]
mat_Sqrt:  [[15.04600399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00136339 -0.03022774  0.0077856 ]
Stock Position:  0.0013633895802804504
Bond Position:  [-0.08874247]


portfolio before change:  [0.04568442]
curr_Stock_Price:  98.6138332693782
curr_Factors:  [98.61383327 -0.45245993 -1.102303  ]
mat_Sqrt:  [[20.83113255  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00413282  0.03348711 -0.0238533 ]
Stock Position:  0.004132823888932838
Bond Position:  [-0.36186919]


portfolio before change:  [0.04451529]
curr_Stock_Price:  98.35283796171218
curr_Factors:  [98.35283796 -0.19291885 -1.09324236]
mat_Sqrt:  [[27.17779271  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00043055 0.05561015 0.16991323]
Stock Position:  0.00043054560239278654
Bond Position:  [0.00216991]


portfolio before change:  [0.04455039]
curr_Stock_Price:  98.43309186398669
curr_Factors:  [ 9.84330919e+01 -5.08454305e-02 -1.09024394e+00]
mat_Sqrt:  [[31.44649961  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190678 -0.01225129 -0.11149395]
Stock Position:  -0.0019067814501357125
Bond Position:  [0.23224078]


portfolio before change:  [0.04529633]
curr_Stock_Price:  98.07234114515087
curr_Factors:  [98.07234115  0.24375605 -1.11088156]
mat_Sqrt:  [[41.20583518  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00269177 -0.03445049  0.63028637]
Stock Position:  -0.0026917718024630707
Bond Position:  [0.30928469]


portfolio before change:  [0.04108794]
curr_Stock_Price:  99.66449505584661
curr_Factors:  [99.66449506  0.22260112 -1.09529348]
mat_Sqrt:  [[41.64232759  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00050628  0.03353235  0.1442415 ]
Stock Position:  -0.0005062763841053385
Bond Position:  [0.09154572]


portfolio before change:  [0.04016159]
curr_Stock_Price:  101.53944195830888
curr_Factors:  [ 1.01539442e+02  8.96570620e-02 -1.11310467e+00]
mat_Sqrt:  [[36.48859355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435936 -0.00960248  0.23712376]
Stock Position:  -0.004359364718005037
Bond Position:  [0.48280905]


portfolio before change:  [0.04796482]
curr_Stock_Price:  99.77714242192006
curr_Factors:  [ 9.97771424e+01 -1.74649659e-02 -1.05867047e+00]
mat_Sqrt:  [[34.01507093  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137297 -0.01730636  0.06368228]
Stock Position:  -0.0013729735233520102
Bond Position:  [0.18495619]


portfolio before change:  [0.0449733]
curr_Stock_Price:  101.98968556599205
curr_Factors:  [101.98968557  -0.23566174  -1.03106306]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.0449733]
Stock Price:  101.35111869629225
PL:  [-1.3061454]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.16254047e-01 -6.46812238e-02  1.66938122e-01]
 [-2.26484782e-01  2.04766311e-01  7.51617903e-02]
 [-1.47435994e-01 -5.34041416e-01 -4.02390988e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 5.51648542e-01 -3.53200329e-01 -1.81747377e-01]
 [ 3.99303238e-02  3.33960132e-02 -1.00500158e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-1.87281882e-02 -3.46096517e-02 -1.24555379e-02]
 [ 9.74532352e-03  3.26100213e-02 -6.03079614e-02]
 [-2.28705845e-01  2.13437392e-01 -1.98851659e-03]
 [ 1.09323792e-01 -1.46517617e-01 -3.09602243e-03]
 [ 2.03099941e-02  8.28540590e-02  4.83000125e-02]
 [-1.23261279e-02  1.74855341e-01  5.05786459e-02]
 [-4.42180215e-02 -1.00808853e-01 -5.63582616e-02]
 [-1.58892686e-01 -1.13169628e-01  2.28112369e-01]
 [ 3.82116758e-02  7.77396400e-02  1.18856899e-01]
 [-1.60012383e-01 -1.61044205e-02  8.39513101e-02]
 [-5.00847540e-02 -5.45365363e-02  2.17800556e-02]
 [-3.27820740e-02  4.74723999e-01  2.14509729e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.63777837]
curr_Stock_Price:  99.31549867311271
curr_Factors:  [99.31549867 -1.11174269 -0.95719837]
mat_Sqrt:  [[12.54548177  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01465452 -0.020454    0.476228  ]
Stock Position:  -0.014654519487577906
Bond Position:  [-1.18235745]


portfolio before change:  [-2.62673199]
curr_Stock_Price:  98.54153956097974
curr_Factors:  [98.54153956 -1.23072369 -0.927707  ]
mat_Sqrt:  [[11.3821631   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01808579  0.06475279  0.21441567]
Stock Position:  -0.018085789222564885
Bond Position:  [-0.84453048]


portfolio before change:  [-2.62891126]
curr_Stock_Price:  98.6503599997949
curr_Factors:  [98.65036    -1.20471238 -0.9563197 ]
mat_Sqrt:  [[11.36512901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01490864 -0.16887872 -0.11479095]
Stock Position:  -0.014908643371646074
Bond Position:  [-1.15816822]


portfolio before change:  [-2.64250366]
curr_Stock_Price:  99.54264982646141
curr_Factors:  [99.54264983 -1.2023302  -0.98636422]
mat_Sqrt:  [[11.15504399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00340149 -0.00455813 -0.02970002]
Stock Position:  -0.0034014887994939925
Bond Position:  [-2.30391046]


portfolio before change:  [-2.64524185]
curr_Stock_Price:  100.1782952384196
curr_Factors:  [100.17829524  -0.97046218  -1.0079318 ]
mat_Sqrt:  [[13.85377239  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0364832  -0.11169175 -0.51847468]
Stock Position:  0.03648319795152852
Bond Position:  [-6.30006643]


portfolio before change:  [-2.64945617]
curr_Stock_Price:  100.10595787787376
curr_Factors:  [100.10595788  -1.03933543  -1.08697169]
mat_Sqrt:  [[11.94033406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00324456  0.01056075 -0.0286699 ]
Stock Position:  0.0032445620104379807
Bond Position:  [-2.97425615]


portfolio before change:  [-2.65092391]
curr_Stock_Price:  99.88278946574825
curr_Factors:  [99.88278947 -0.97644654 -1.09541131]
mat_Sqrt:  [[12.58039358  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045041 -0.02845143  0.0120735 ]
Stock Position:  -0.0004504067261170875
Bond Position:  [-2.60593603]


portfolio before change:  [-2.65176611]
curr_Stock_Price:  100.30603639936571
curr_Factors:  [100.3060364   -0.91080723  -1.12573813]
mat_Sqrt:  [[13.08780025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00169351 -0.01094453 -0.03553218]
Stock Position:  -0.0016935070189082607
Bond Position:  [-2.48189713]


portfolio before change:  [-2.65408104]
curr_Stock_Price:  101.306553680021
curr_Factors:  [101.30655368  -0.62377572  -1.10609561]
mat_Sqrt:  [[17.96238364  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.59227040e-05  1.03121942e-02 -1.72041827e-01]
Stock Position:  -9.592270399774517e-05
Bond Position:  [-2.64436344]


portfolio before change:  [-2.65469401]
curr_Stock_Price:  100.80405232684372
curr_Factors:  [100.80405233  -0.66633008  -1.11324317]
mat_Sqrt:  [[17.00666466  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01314783  0.06749483 -0.00567268]
Stock Position:  -0.013147834941801361
Bond Position:  [-1.32933897]


portfolio before change:  [-2.66420242]
curr_Stock_Price:  101.50196427773359
curr_Factors:  [101.50196428  -0.54668139  -1.15489887]
mat_Sqrt:  [[18.51345728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00566662 -0.04633294 -0.00883209]
Stock Position:  0.005666621238644676
Bond Position:  [-3.23937561]


portfolio before change:  [-2.66756447]
curr_Stock_Price:  101.05159015281667
curr_Factors:  [101.05159015  -0.28889335  -1.14729756]
mat_Sqrt:  [[24.03329749  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00134432 0.02620075 0.13778649]
Stock Position:  0.0013443213725134857
Bond Position:  [-2.80341028]


portfolio before change:  [-2.67076054]
curr_Stock_Price:  99.19553754346406
curr_Factors:  [99.19553754 -0.38080023 -1.12947044]
mat_Sqrt:  [[21.90735371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.14707623e-04 5.52941138e-02 1.44286798e-01]
Stock Position:  0.00011470762285705785
Bond Position:  [-2.68213902]


portfolio before change:  [-2.67138439]
curr_Stock_Price:  99.60326513536614
curr_Factors:  [99.60326514 -0.63284305 -1.1569705 ]
mat_Sqrt:  [[16.63287905  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00350661 -0.03187856 -0.16077443]
Stock Position:  -0.0035066074030155065
Bond Position:  [-2.32211484]


portfolio before change:  [-2.67614146]
curr_Stock_Price:  100.79429410897775
curr_Factors:  [100.79429411  -0.8883713   -1.19444702]
mat_Sqrt:  [[12.5568135   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0091784  -0.03578738  0.65074109]
Stock Position:  -0.00917840110830716
Bond Position:  [-1.751011]


portfolio before change:  [-2.68197988]
curr_Stock_Price:  101.38269928276127
curr_Factors:  [101.38269928  -1.17545093  -1.17787925]
mat_Sqrt:  [[ 9.63663786  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00669118 0.02458343 0.33906565]
Stock Position:  0.0066911788535818535
Bond Position:  [-3.36034966]


portfolio before change:  [-2.68141334]
curr_Stock_Price:  101.59293605048707
curr_Factors:  [101.59293605  -0.74400804  -1.22063932]
mat_Sqrt:  [[14.24387015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01005989 -0.00509266  0.23948972]
Stock Position:  -0.010059885881831734
Bond Position:  [-1.6594]


portfolio before change:  [-2.66868585]
curr_Stock_Price:  100.28652016777883
curr_Factors:  [100.28652017  -0.93053525  -1.19195059]
mat_Sqrt:  [[12.00766802  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00391808 -0.01724597  0.06213244]
Stock Position:  -0.003918083510278478
Bond Position:  [-2.27575489]


portfolio before change:  [-2.67150437]
curr_Stock_Price:  100.86065477981711
curr_Factors:  [100.86065478  -1.07206571  -1.22535122]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.67150437]
Stock Price:  100.59888243013444
PL:  [-3.2703868]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.05107305e-01 -3.28644865e-02  9.91419605e-02]
 [-7.94639344e-02  1.27433785e-01  9.60378734e-02]
 [-6.46898589e-02 -4.22181358e-01  3.08909319e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 7.10355508e-01 -4.35817532e-01 -1.98001146e-01]
 [-1.13727208e-02  3.38725925e-02 -3.42051379e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-7.82662632e-02 -4.15802830e-02 -3.77277767e-02]
 [-3.72302262e-02  2.84643143e-02  2.60218565e-03]
 [-1.83085445e-01  1.66734760e-01 -1.57566092e-02]
 [ 5.53398997e-02 -1.14943835e-01  1.02865376e-03]
 [ 6.00558384e-02  9.79873872e-02  1.58059009e-02]
 [-1.02849205e-02  1.64422792e-01  4.89266529e-02]
 [-3.80481881e-02 -1.23037049e-01 -7.60009790e-02]
 [-1.55650572e-01 -1.10760452e-01  2.24026270e-01]
 [ 1.24222672e-02  7.47028267e-02  7.93050174e-02]
 [-1.07121669e-01  6.06382879e-02  5.37821299e-02]
 [-4.90324855e-02 -5.12014777e-02  2.15322090e-02]
 [-3.49659385e-02  4.56340798e-01  1.95378667e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.0558168]
curr_Stock_Price:  100.10860980944439
curr_Factors:  [100.10860981  -1.36108783  -1.03561902]
mat_Sqrt:  [[ 9.11160474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03135766 -0.01039266  0.28282442]
Stock Position:  -0.03135765902554186
Bond Position:  [6.19498845]


portfolio before change:  [3.06940298]
curr_Stock_Price:  99.72474074305997
curr_Factors:  [99.72474074 -1.25495346 -1.02103768]
mat_Sqrt:  [[10.24123951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00552374  0.0402981   0.27396932]
Stock Position:  -0.005523741469141331
Bond Position:  [3.62025666]


portfolio before change:  [3.06950449]
curr_Stock_Price:  99.8702342565603
curr_Factors:  [99.87023426 -1.53356211 -1.02441935]
mat_Sqrt:  [[ 7.73604233  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00895612 -0.13350547  0.08812323]
Stock Position:  -0.00895612338487673
Bond Position:  [3.96395463]


portfolio before change:  [3.07372594]
curr_Stock_Price:  99.50954947050947
curr_Factors:  [99.50954947 -1.18153122 -1.02526156]
mat_Sqrt:  [[10.95132917  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00346476 -0.00455813 -0.02970002]
Stock Position:  -0.003464762735372932
Bond Position:  [3.41850291]


portfolio before change:  [3.07325343]
curr_Stock_Price:  99.89261817033555
curr_Factors:  [99.89261817 -1.33584994 -1.02627729]
mat_Sqrt:  [[ 9.41184082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06998481 -0.1378176  -0.56484216]
Stock Position:  0.06998481445143737
Bond Position:  [-3.91771292]


portfolio before change:  [3.12450167]
curr_Stock_Price:  100.63889147604975
curr_Factors:  [100.63889148  -1.39991679  -1.04249131]
mat_Sqrt:  [[ 8.75067359  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199759  0.01071145 -0.09757774]
Stock Position:  -0.0019975866511687326
Bond Position:  [3.32553658]


portfolio before change:  [3.12241099]
curr_Stock_Price:  102.10174409171825
curr_Factors:  [102.10174409  -1.34943342  -1.08681858]
mat_Sqrt:  [[ 8.93269199  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063433 -0.02845143  0.0120735 ]
Stock Position:  -0.000634332168916448
Bond Position:  [3.18717741]


portfolio before change:  [3.12375695]
curr_Stock_Price:  101.23616599111891
curr_Factors:  [101.23616599  -0.79612875  -1.11636079]
mat_Sqrt:  [[14.9538161   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00582066 -0.01314884 -0.10762685]
Stock Position:  -0.005820655484364578
Bond Position:  [3.71301779]


portfolio before change:  [3.1310348]
curr_Stock_Price:  100.14531171489455
curr_Factors:  [100.14531171  -0.66564352  -1.10091575]
mat_Sqrt:  [[17.11684362  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00210109  0.00900121  0.00742331]
Stock Position:  -0.0021010948411083526
Bond Position:  [3.3414496]


portfolio before change:  [3.13162077]
curr_Stock_Price:  100.26405923617314
curr_Factors:  [100.26405924  -0.48710128  -1.14203601]
mat_Sqrt:  [[19.6616495   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00925643  0.05272616 -0.04494922]
Stock Position:  -0.009256429676058822
Bond Position:  [4.05970798]


portfolio before change:  [3.14673636]
curr_Stock_Price:  98.74073556420886
curr_Factors:  [98.74073556 -0.36759446 -1.16434944]
mat_Sqrt:  [[21.33936898  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00246409 -0.03634843  0.00293446]
Stock Position:  0.0024640857837715203
Bond Position:  [2.90343072]


portfolio before change:  [3.14947737]
curr_Stock_Price:  99.5585069929499
curr_Factors:  [99.55850699 -0.66525449 -1.17182644]
mat_Sqrt:  [[15.85784853  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00415014 0.03098633 0.04508984]
Stock Position:  0.004150135983671035
Bond Position:  [2.73629603]


portfolio before change:  [3.14977166]
curr_Stock_Price:  99.46456476428366
curr_Factors:  [99.46456476 -0.79217574 -1.17640836]
mat_Sqrt:  [[13.89066952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00028419 0.05199505 0.13957412]
Stock Position:  0.00028418853215319314
Bond Position:  [3.12150497]


portfolio before change:  [3.15044941]
curr_Stock_Price:  99.10312949857965
curr_Factors:  [99.1031295  -0.71477957 -1.19869176]
mat_Sqrt:  [[14.62437547  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00387973 -0.03890773 -0.21680964]
Stock Position:  -0.0038797298401732822
Bond Position:  [3.53494278]


portfolio before change:  [3.14882951]
curr_Stock_Price:  99.74847060999075
curr_Factors:  [99.74847061 -0.597986   -1.21843298]
mat_Sqrt:  [[16.2198003   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00695331 -0.03502553  0.63908459]
Stock Position:  -0.006953305326775624
Bond Position:  [3.84241108]


portfolio before change:  [3.13982471]
curr_Stock_Price:  101.18167740436776
curr_Factors:  [101.1816774   -0.82464468  -1.25016767]
mat_Sqrt:  [[12.70639409  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00240345 0.02362311 0.22623514]
Stock Position:  0.002403447785897351
Bond Position:  [2.89663983]


portfolio before change:  [3.13989872]
curr_Stock_Price:  100.91113298721699
curr_Factors:  [100.91113299  -1.21962331  -1.23578092]
mat_Sqrt:  [[ 8.66105056  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0109199   0.01917551  0.15342545]
Stock Position:  -0.010919895087367593
Bond Position:  [4.24183771]


portfolio before change:  [3.13994759]
curr_Stock_Price:  101.0037825377169
curr_Factors:  [101.00378254  -1.50108209  -1.21089055]
mat_Sqrt:  [[ 6.70722515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0068522  -0.01619133  0.0614254 ]
Stock Position:  -0.006852201497861913
Bond Position:  [3.83204586]


portfolio before change:  [3.13779851]
curr_Stock_Price:  101.45724445557016
curr_Factors:  [101.45724446  -1.33844388  -1.24615308]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.13779851]
Stock Price:  101.60629822666652
PL:  [1.53150028]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.87193007e-01 -3.11208848e-02  9.08097488e-02]
 [ 5.91083443e-02  3.75294919e-02  4.10710811e-02]
 [-3.34170915e-04 -6.94112950e-02  3.48193300e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.57712530e-01 -2.95681910e-01 -2.59535378e-01]
 [-4.94144128e-02 -6.43127189e-02 -1.06021573e-01]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-6.53548590e-02 -4.00475030e-02 -2.91988314e-02]
 [-1.08453177e-02  3.08784114e-02 -3.24229234e-02]
 [-2.60687065e-01  2.46512499e-01  2.02106389e-02]
 [ 7.60873291e-02 -1.27306259e-01  1.22742421e-03]
 [ 9.46551430e-03  7.48464930e-02  4.52967419e-02]
 [-2.18073306e-02  1.71874678e-01  3.83027611e-02]
 [-4.25003333e-02 -1.20531786e-01 -6.09817891e-02]
 [-1.54172909e-01 -1.10492000e-01  2.24476608e-01]
 [ 2.99868699e-02  1.11066344e-01  1.74211707e-01]
 [-8.66697585e-02  8.87195565e-02  4.40497271e-02]
 [-4.76435689e-02 -5.50362076e-02  2.64075994e-02]
 [-2.49769157e-02  5.43235948e-01  2.62728267e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.47277742]
curr_Stock_Price:  100.16669193489992
curr_Factors:  [100.16669193  -1.03555958  -0.99770265]
mat_Sqrt:  [[13.11259844  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02054971 -0.00984129  0.25905494]
Stock Position:  -0.020549708985832905
Bond Position:  [5.53117379]


portfolio before change:  [3.44768082]
curr_Stock_Price:  101.45525334551436
curr_Factors:  [101.45525335  -1.08072709  -1.01844503]
mat_Sqrt:  [[12.43413776  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00550589 0.01186787 0.11716436]
Stock Position:  0.005505886478495567
Bond Position:  [2.88907971]


portfolio before change:  [3.44667324]
curr_Stock_Price:  101.1410541724797
curr_Factors:  [101.14105417  -0.97562676  -1.02214035]
mat_Sqrt:  [[13.71855107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00036309 -0.02194978  0.09932986]
Stock Position:  0.00036309250954463405
Bond Position:  [3.40994968]


portfolio before change:  [3.44769158]
curr_Stock_Price:  101.59755870038855
curr_Factors:  [101.5975587   -1.43023146  -0.99873956]
mat_Sqrt:  [[ 8.95353558  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00423785 -0.00455813 -0.02970002]
Stock Position:  -0.004237851837461329
Bond Position:  [3.87824699]


portfolio before change:  [3.44605116]
curr_Stock_Price:  102.21346321015895
curr_Factors:  [102.21346321  -1.53937811  -1.00356449]
mat_Sqrt:  [[ 8.03752178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03696421 -0.09350283 -0.74038219]
Stock Position:  0.03696420702833655
Bond Position:  [-0.33218846]


portfolio before change:  [3.4762556]
curr_Stock_Price:  103.03283691573637
curr_Factors:  [103.03283692  -1.36453069  -1.01121116]
mat_Sqrt:  [[ 9.57643975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00759327 -0.02033747 -0.30245004]
Stock Position:  -0.007593273160233497
Bond Position:  [4.25861207]


portfolio before change:  [3.48576518]
curr_Stock_Price:  101.92069469258853
curr_Factors:  [101.92069469  -1.40088088  -1.02657545]
mat_Sqrt:  [[ 8.99562794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00062989 -0.02845143  0.0120735 ]
Stock Position:  -0.000629894202777865
Bond Position:  [3.54996444]


portfolio before change:  [3.48698925]
curr_Stock_Price:  101.38653251958056
curr_Factors:  [101.38653252  -1.29628457  -1.03895825]
mat_Sqrt:  [[ 9.81289607  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00737286 -0.01266413 -0.08329614]
Stock Position:  -0.007372855785683684
Bond Position:  [4.23449753]


portfolio before change:  [3.48913784]
curr_Stock_Price:  101.23871589584786
curr_Factors:  [101.2387159   -1.37371808  -1.02263941]
mat_Sqrt:  [[ 9.21768351  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180808  0.00976461 -0.09249358]
Stock Position:  -0.0018080835647255684
Bond Position:  [3.6721859]


portfolio before change:  [3.49112859]
curr_Stock_Price:  100.64549880134628
curr_Factors:  [100.6454988   -1.06865902  -1.0130521 ]
mat_Sqrt:  [[12.55216679  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01993255  0.0779541   0.05765533]
Stock Position:  -0.01993254745062993
Bond Position:  [5.49724977]


portfolio before change:  [3.48869628]
curr_Stock_Price:  100.83648223836227
curr_Factors:  [100.83648224  -0.97918981  -0.99941541]
mat_Sqrt:  [[13.94184845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00523968 -0.04025777  0.0035015 ]
Stock Position:  0.00523968129193535
Bond Position:  [2.96034525]


portfolio before change:  [3.48915463]
curr_Stock_Price:  100.78269426700679
curr_Factors:  [100.78269427  -1.0807515   -0.98585959]
mat_Sqrt:  [[12.76051407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00161782 0.02366854 0.129219  ]
Stock Position:  0.0016178189258639042
Bond Position:  [3.32610648]


portfolio before change:  [3.49082084]
curr_Stock_Price:  101.29856285146877
curr_Factors:  [101.29856285  -0.92050339  -0.98039976]
mat_Sqrt:  [[15.13740863  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063096  0.05435155  0.10926712]
Stock Position:  -0.0006309552287653092
Bond Position:  [3.5547357]


portfolio before change:  [3.49154845]
curr_Stock_Price:  101.55402104826375
curr_Factors:  [101.55402105  -1.34768398  -1.01149337]
mat_Sqrt:  [[ 9.59664476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00605006 -0.0381155  -0.17396407]
Stock Position:  -0.006050063078186636
Bond Position:  [4.10595669]


portfolio before change:  [3.49234999]
curr_Stock_Price:  101.59122500130202
curr_Factors:  [101.591225    -1.03630595  -1.04155188]
mat_Sqrt:  [[12.7190305   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00874317 -0.03494064  0.64036928]
Stock Position:  -0.008743174574239754
Bond Position:  [4.3805798]


portfolio before change:  [3.50290334]
curr_Stock_Price:  100.50945839312092
curr_Factors:  [100.50945839  -1.06063923  -0.98659662]
mat_Sqrt:  [[12.9748905   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00527291 0.03512226 0.49697751]
Stock Position:  0.005272908183537548
Bond Position:  [2.9729262]


portfolio before change:  [3.49727877]
curr_Stock_Price:  99.30179493322932
curr_Factors:  [99.30179493 -0.68092937 -0.95030484]
mat_Sqrt:  [[19.43216032  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00387952  0.02805559  0.12566161]
Stock Position:  -0.0038795180404069224
Bond Position:  [3.88252187]


portfolio before change:  [3.49965353]
curr_Stock_Price:  98.93989204694711
curr_Factors:  [98.93989205 -0.46411874 -0.94686054]
mat_Sqrt:  [[24.13186667  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180981 -0.01740398  0.07533353]
Stock Position:  -0.001809813125199921
Bond Position:  [3.67871624]


portfolio before change:  [3.5001586]
curr_Stock_Price:  99.1690461704412
curr_Factors:  [99.16904617 -0.49186675 -0.98205452]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.5001586]
Stock Price:  100.73520698203909
PL:  [2.76495161]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.15034581e-01 -5.13985405e-02  1.30871063e-01]
 [-4.35192522e-01  2.91429392e-01 -5.58795941e-02]
 [-3.05555897e-01 -7.95479177e-01 -1.49603374e-01]
 [-2.14999133e-02  2.37733123e-01  1.69337970e-01]
 [-6.69417915e-02  1.25240981e-01  9.76315986e-02]
 [-1.57074094e-01  8.44563771e-02  4.80525625e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 3.77023063e-01  4.32180640e-02 -3.03628845e-02]
 [-4.80504853e-01 -3.28185753e-02  6.41960863e-01]
 [-2.43494750e-03  5.71414666e-02 -2.70094912e-02]
 [-1.74153498e-01  2.47965711e-02  7.05883036e-02]
 [ 6.81876704e-02 -2.42362908e-01 -4.50328820e-01]
 [-3.55657537e-02 -6.26770119e-04 -5.53379984e-02]
 [ 2.76471111e-01 -7.00169596e-01  1.53819511e-01]
 [-2.44675881e-01 -2.51460364e-01  1.82298996e-02]
 [-6.15854182e-02  1.97650756e-01  5.20344011e-01]
 [ 1.25801351e-01 -3.95170551e-01 -1.72037354e-01]
 [ 4.14489721e-01  8.82776010e-02  3.77305277e-01]
 [-4.77014808e-02  3.86522833e-01 -1.16327324e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.87492459]
curr_Stock_Price:  99.42176331083952
curr_Factors:  [99.42176331 -0.81839309 -1.02584731]
mat_Sqrt:  [[15.72309474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01206173 -0.01625365  0.37333872]
Stock Position:  -0.01206173118992784
Bond Position:  [-0.675726]


portfolio before change:  [-1.86111912]
curr_Stock_Price:  98.26318811773649
curr_Factors:  [98.26318812 -0.38491075 -1.03418546]
mat_Sqrt:  [[23.77306596  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0184694   0.09215807 -0.15940893]
Stock Position:  -0.01846939820314517
Bond Position:  [-0.04625717]


portfolio before change:  [-1.82915814]
curr_Stock_Price:  96.53207927708188
curr_Factors:  [96.53207928 -0.85722144 -1.05267361]
mat_Sqrt:  [[14.2960078   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02494632 -0.2515526  -0.42677678]
Stock Position:  -0.024946316973417166
Bond Position:  [0.5789617]


portfolio before change:  [-1.81172299]
curr_Stock_Price:  95.8389751293693
curr_Factors:  [95.83897513 -0.50331887 -1.04398149]
mat_Sqrt:  [[20.39661749  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00094154 0.07517781 0.48307409]
Stock Position:  0.0009415432708075209
Bond Position:  [-1.90195953]


portfolio before change:  [-1.81456927]
curr_Stock_Price:  93.32105460671254
curr_Factors:  [ 9.33210546e+01  2.86291110e-02 -1.02009689e+00]
mat_Sqrt:  [[34.62506953  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126438  0.03960468  0.27851578]
Stock Position:  -0.001264376281303899
Bond Position:  [-1.69657634]


portfolio before change:  [-1.81799013]
curr_Stock_Price:  95.69112812310652
curr_Factors:  [95.69112812  0.20052316 -1.01300602]
mat_Sqrt:  [[42.46340862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0034167   0.02670745  0.13708059]
Stock Position:  -0.003416700548289216
Bond Position:  [-1.4910422]


portfolio before change:  [-1.82017945]
curr_Stock_Price:  96.22278326094204
curr_Factors:  [96.22278326 -0.10247195 -0.98238438]
mat_Sqrt:  [[32.51852199  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00017425 -0.02845143  0.0120735 ]
Stock Position:  -0.00017424819887989818
Bond Position:  [-1.8034128]


portfolio before change:  [-1.81951053]
curr_Stock_Price:  89.79618240384201
curr_Factors:  [ 8.97961824e+01  8.33027386e-02 -9.90529496e-01]
mat_Sqrt:  [[36.24551702  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01026171  0.01366675 -0.08661686]
Stock Position:  0.010261714589007088
Bond Position:  [-2.74097333]


portfolio before change:  [-1.80006489]
curr_Stock_Price:  91.75793770529376
curr_Factors:  [ 9.17579377e+01  4.73579154e-02 -9.60242251e-01]
mat_Sqrt:  [[36.82841384  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00951202 -0.01037814  1.83133565]
Stock Position:  -0.009512017366387458
Bond Position:  [-0.92726179]


portfolio before change:  [-1.8089884]
curr_Stock_Price:  92.67169479435019
curr_Factors:  [ 9.26716948e+01  9.13814501e-02 -9.12758875e-01]
mat_Sqrt:  [[40.75936621  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00015881  0.01806972 -0.07705056]
Stock Position:  -0.00015880645566552476
Bond Position:  [-1.79427154]


portfolio before change:  [-1.80910114]
curr_Stock_Price:  90.55662794274126
curr_Factors:  [90.55662794  0.39195595 -0.92445444]
mat_Sqrt:  [[53.16907298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00299243  0.00784136  0.20136878]
Stock Position:  -0.002992425237233139
Bond Position:  [-1.5381172]


portfolio before change:  [-1.78578287]
curr_Stock_Price:  82.63567971989782
curr_Factors:  [82.63567972  0.5187904  -0.91998715]
mat_Sqrt:  [[55.32610131  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.42114801e-04 -7.66418811e-02 -1.28466277e+00]
Stock Position:  -0.0005421148008308111
Bond Position:  [-1.74098485]


portfolio before change:  [-1.78219789]
curr_Stock_Price:  75.21975730106996
curr_Factors:  [75.2197573   1.27270461 -0.92637264]
mat_Sqrt:  [[ 1.06351102e+02  0.00000000e+00  0.00000000e+00]
 [-8.16496581e-02  3.16227766e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [-0.00044078 -0.0001982  -0.15786391]
Stock Position:  -0.0004407830076901703
Bond Position:  [-1.7490423]


portfolio before change:  [-1.78482791]
curr_Stock_Price:  80.19432141447938
curr_Factors:  [80.19432141  1.19602643 -0.92866824]
mat_Sqrt:  [[ 1.04774550e+02  0.00000000e+00  0.00000000e+00]
 [-8.16496581e-02  3.16227766e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [ 0.00276585 -0.22141307  0.43880425]
Stock Position:  0.002765853798832268
Bond Position:  [-2.00663368]


portfolio before change:  [-1.76142102]
curr_Stock_Price:  88.83852908476918
curr_Factors:  [88.83852908  0.77014423 -0.89407852]
mat_Sqrt:  [[ 7.84833224e+01  0.00000000e+00  0.00000000e+00]
 [-8.16496581e-02  3.16227766e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [-0.00315287 -0.07951875  0.05200483]
Stock Position:  -0.003152865983859413
Bond Position:  [-1.48132504]


portfolio before change:  [-1.72674099]
curr_Stock_Price:  77.72153017790491
curr_Factors:  [77.72153018  0.82762533 -0.9401642 ]
mat_Sqrt:  [[69.44905418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [7.16103042e-04 6.25026570e-02 1.48439663e+00]
Stock Position:  0.0007161030418654047
Bond Position:  [-1.78239761]


portfolio before change:  [-1.7297423]
curr_Stock_Price:  74.15268721778509
curr_Factors:  [74.15268722  0.59580199 -0.90656864]
mat_Sqrt:  [[54.34538284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00148092 -0.1249639  -0.49077468]
Stock Position:  0.0014809190552661665
Bond Position:  [-1.83955643]


portfolio before change:  [-1.72355703]
curr_Stock_Price:  78.63991310944324
curr_Factors:  [78.63991311  0.16718912 -0.91037302]
mat_Sqrt:  [[37.4009264   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01320251 0.02791583 1.07634693]
Stock Position:  0.013202511381108022
Bond Position:  [-2.76180138]


portfolio before change:  [-1.71194233]
curr_Stock_Price:  79.57195073333794
curr_Factors:  [79.57195073  0.11795388 -0.85865585]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.71194233]
Stock Price:  77.8066721906699
PL:  [-1.71194233]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.88815523e-01 -3.63973321e-02  8.51036464e-02]
 [-1.50398617e-01  1.40218738e-01 -2.16254627e-02]
 [-7.46884902e-03 -1.47791341e-01  4.54013190e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 2.57267573e-01 -2.28302236e-01 -2.17227866e-01]
 [ 2.43144557e-02  3.20781303e-02  9.86529560e-03]
 [-4.27674647e-02 -2.73766043e-02 -1.41496488e-02]
 [ 1.55082975e-02 -2.66072995e-01 -6.38970184e-02]
 [-2.60504513e-02  1.39819724e-02 -6.68791945e-02]
 [-1.07054595e+00  1.10036951e+00  2.86399227e-01]
 [ 1.55161909e-01 -3.30340040e-01  2.05220445e-01]
 [-2.03283398e-01 -4.81162859e-02 -4.22842925e-02]
 [-3.37197497e-01 -2.94495976e-02 -4.09677154e-01]
 [-2.20618726e-01 -7.48341624e-02  3.72281708e-01]
 [-6.25007479e-02 -9.30946183e-02  2.50343639e-01]
 [-5.83116639e-03 -1.62772224e-02 -5.96136413e-02]
 [-8.24578463e-02  7.00418783e-02  7.17197968e-02]
 [-1.43375648e-02  3.96371703e-02  1.22824118e-02]
 [ 3.50606715e-02  6.34457035e-01  5.80732394e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.94168144]
curr_Stock_Price:  99.41246415982525
curr_Factors:  [99.41246416 -0.51581846 -0.96006003]
mat_Sqrt:  [[22.72348606  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00758614 -0.01150985  0.24277701]
Stock Position:  -0.007586141876640858
Bond Position:  [-1.18752438]


portfolio before change:  [-1.94538738]
curr_Stock_Price:  99.86183991952134
curr_Factors:  [99.86183992 -0.48106284 -0.99991926]
mat_Sqrt:  [[22.71000397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00665753  0.04434106 -0.06169143]
Stock Position:  -0.006657526980779962
Bond Position:  [-1.28055449]


portfolio before change:  [-1.94611032]
curr_Stock_Price:  99.92233596422831
curr_Factors:  [99.92233596 -0.54834703 -1.01394085]
mat_Sqrt:  [[20.9493027   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.62943560e-05 -4.67357257e-02  1.29517326e-01]
Stock Position:  -9.629435598603297e-05
Bond Position:  [-1.93648836]


portfolio before change:  [-1.94662197]
curr_Stock_Price:  100.20766771084551
curr_Factors:  [100.20766771  -0.71153171  -1.03193551]
mat_Sqrt:  [[17.5276124   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0021648  -0.00455813 -0.02970002]
Stock Position:  -0.0021647989656172857
Bond Position:  [-1.72969252]


portfolio before change:  [-1.95085671]
curr_Stock_Price:  101.96407188607868
curr_Factors:  [101.96407189  -0.70612155  -1.01643615]
mat_Sqrt:  [[18.2116739   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01136806 -0.07219551 -0.61969064]
Stock Position:  0.01136805891820828
Bond Position:  [-3.10999029]


portfolio before change:  [-1.97282787]
curr_Stock_Price:  100.09976404027437
curr_Factors:  [100.09976404  -0.411415    -1.038652  ]
mat_Sqrt:  [[23.47885733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00115663 0.010144   0.02814294]
Stock Position:  0.0011566344197708944
Bond Position:  [-2.0886067]


portfolio before change:  [-1.97469789]
curr_Stock_Price:  98.93448131347458
curr_Factors:  [ 9.89344813e+01  3.85631299e-02 -1.06875515e+00]
mat_Sqrt:  [[35.31351705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131289 -0.00865724 -0.04036501]
Stock Position:  -0.001312885670062332
Bond Position:  [-1.84480823]


portfolio before change:  [-1.97513576]
curr_Stock_Price:  98.91666235642684
curr_Factors:  [98.91666236  0.68060667 -1.07854165]
mat_Sqrt:  [[66.44288613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.62915507e-05 -8.41396687e-02 -1.82280408e-01]
Stock Position:  -6.629155068338175e-05
Bond Position:  [-1.96857842]


portfolio before change:  [-1.9758905]
curr_Stock_Price:  102.87704442151244
curr_Factors:  [102.87704442   0.79573201  -1.07106329]
mat_Sqrt:  [[ 7.81166517e+01  0.00000000e+00  0.00000000e+00]
 [-8.16496581e-02  3.16227766e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [-0.00050362  0.00442149 -0.19078773]
Stock Position:  -0.0005036198545299328
Bond Position:  [-1.92407958]


portfolio before change:  [-1.98426524]
curr_Stock_Price:  118.55088868595129
curr_Factors:  [118.55088869   0.43303312  -1.03288035]
mat_Sqrt:  [[65.07204751  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01511668  0.34796739  0.81701728]
Stock Position:  -0.015116683315184152
Bond Position:  [-0.192169]


portfolio before change:  [-1.90544148]
curr_Stock_Price:  113.33335443772616
curr_Factors:  [113.33335444   0.151405    -1.05924546]
mat_Sqrt:  [[45.71804403  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0041236  -0.10446269  0.58543681]
Stock Position:  0.004123601921849187
Bond Position:  [-2.37278312]


portfolio before change:  [-1.91374587]
curr_Stock_Price:  111.46335863152486
curr_Factors:  [111.46335863   0.18904793  -1.00887937]
mat_Sqrt:  [[49.10026725  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00434126 -0.01521571 -0.12062532]
Stock Position:  -0.004341259479658768
Bond Position:  [-1.4298545]


portfolio before change:  [-1.92215613]
curr_Stock_Price:  113.31829349101731
curr_Factors:  [ 1.13318293e+02  6.43982310e-02 -1.01993937e+00]
mat_Sqrt:  [[43.58266481  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00967318 -0.00931278 -1.16869489]
Stock Position:  -0.00967317816104306
Bond Position:  [-0.82600809]


portfolio before change:  [-1.91866058]
curr_Stock_Price:  112.93557801205372
curr_Factors:  [ 1.12935578e+02  1.73597676e-02 -9.93354318e-01]
mat_Sqrt:  [[42.55609122  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00344391 -0.02366464  1.06201609]
Stock Position:  -0.003443907694599072
Bond Position:  [-1.52972088]


portfolio before change:  [-1.91898572]
curr_Stock_Price:  112.91892859380341
curr_Factors:  [ 1.12918929e+02 -1.09019684e-01 -9.48623240e-01]
mat_Sqrt:  [[39.21373981  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.52000581e-04 -2.94391032e-02  7.14160721e-01]
Stock Position:  -0.0003520005809843474
Bond Position:  [-1.87923819]


portfolio before change:  [-1.91955787]
curr_Stock_Price:  113.20950178147501
curr_Factors:  [113.20950178  -0.27924216  -0.94354345]
mat_Sqrt:  [[33.32988658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055266 -0.00514731 -0.17006113]
Stock Position:  -0.0005526579273659715
Bond Position:  [-1.85699174]


portfolio before change:  [-1.92034929]
curr_Stock_Price:  113.80139268147552
curr_Factors:  [113.80139268  -0.50834937  -0.93531737]
mat_Sqrt:  [[26.86402466  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00245718  0.02214919  0.20459662]
Stock Position:  -0.0024571757739550912
Bond Position:  [-1.64071926]


portfolio before change:  [-1.92135774]
curr_Stock_Price:  114.04484951378787
curr_Factors:  [114.04484951  -0.60763629  -0.89107186]
mat_Sqrt:  [[25.47974023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042414  0.01253437  0.0350383 ]
Stock Position:  -0.00042414092764247595
Bond Position:  [-1.87298665]


portfolio before change:  [-1.92240401]
curr_Stock_Price:  115.40753778489498
curr_Factors:  [115.40753778  -0.65703446  -0.90399276]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.92240401]
Stock Price:  112.55825608556938
PL:  [-14.4806601]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.81645500e-01 -3.05809451e-02  8.82295195e-02]
 [ 3.01394477e-02  4.45040017e-02  7.09932266e-04]
 [-1.74369575e-02 -1.72939645e-01  4.40324036e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 2.45273229e-01 -1.82291838e-01 -1.37185152e-01]
 [-7.85401476e-02  6.56367201e-02  2.74975407e-02]
 [-1.65507505e-02 -7.36096270e-02  6.02425264e-04]
 [ 5.59558167e-02 -2.09614489e-02 -9.02176502e-03]
 [-5.65887315e-02  2.64208499e-02  2.73141305e-02]
 [-1.99382028e-01  1.86412534e-01  1.15220639e-02]
 [-7.13375372e-03 -7.81377706e-02  3.71215494e-03]
 [ 1.02837904e-02  7.54539962e-02  4.55279745e-02]
 [-1.83003887e-02  1.74577632e-01  4.34641060e-02]
 [-5.23383936e-02 -7.06485038e-02 -3.16162761e-02]
 [-1.39052429e-01 -1.08978597e-01  2.32523700e-01]
 [ 1.64417263e-02  5.93309440e-02  5.84767617e-02]
 [-1.05926714e-01  4.03681201e-02  7.97944730e-02]
 [-3.38600307e-02 -7.58285130e-03  2.07812409e-02]
 [-1.16225463e-02  5.62365853e-01  3.51231748e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.9164721]
curr_Stock_Price:  99.8106015983672
curr_Factors:  [99.8106016  -0.628571   -0.99256287]
mat_Sqrt:  [[19.73000423  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01340219 -0.00967054  0.25169426]
Stock Position:  -0.013402192850284452
Bond Position:  [2.25415303]


portfolio before change:  [0.90693426]
curr_Stock_Price:  100.5643173953924
curr_Factors:  [100.5643174   -0.61286563  -1.00623016]
mat_Sqrt:  [[19.91955084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00157802 0.0140734  0.00202524]
Stock Position:  0.0015780200398429435
Bond Position:  [0.74824175]


portfolio before change:  [0.90567162]
curr_Stock_Price:  99.64561905572748
curr_Factors:  [99.64561906 -0.49666632 -1.03615045]
mat_Sqrt:  [[21.51613906  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060021 -0.05468832  0.12561219]
Stock Position:  -0.0006002082046904496
Bond Position:  [0.96547974]


portfolio before change:  [0.90514641]
curr_Stock_Price:  100.92285528885249
curr_Factors:  [100.92285529  -0.61475276  -1.01754273]
mat_Sqrt:  [[19.72843357  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019233  -0.00455813 -0.02970002]
Stock Position:  -0.0019233030874239749
Bond Position:  [1.09925165]


portfolio before change:  [0.90944061]
curr_Stock_Price:  98.83303807244171
curr_Factors:  [98.83303807 -0.65272226 -1.01458118]
mat_Sqrt:  [[18.65526658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0113943  -0.05764574 -0.39135105]
Stock Position:  0.011394298282829162
Bond Position:  [-0.21669251]


portfolio before change:  [0.91197323]
curr_Stock_Price:  99.06006360588195
curr_Factors:  [99.06006361 -0.49545387 -1.01476794]
mat_Sqrt:  [[21.87850302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325582  0.02075615  0.07844283]
Stock Position:  -0.0032558216049579035
Bond Position:  [1.23449512]


portfolio before change:  [0.91014055]
curr_Stock_Price:  99.7177588549058
curr_Factors:  [99.71775885 -0.37571767 -0.98763351]
mat_Sqrt:  [[25.50801236  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071853 -0.02327741  0.00171855]
Stock Position:  -0.0007185339669292454
Bond Position:  [0.98179115]


portfolio before change:  [0.91099031]
curr_Stock_Price:  98.87677554229695
curr_Factors:  [98.87677554 -0.50401396 -0.97944165]
mat_Sqrt:  [[22.43043568  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00238841 -0.00662859 -0.02573658]
Stock Position:  0.0023884081031297017
Bond Position:  [0.67483221]


portfolio before change:  [0.91298997]
curr_Stock_Price:  99.64336642748661
curr_Factors:  [99.64336643 -0.67131435 -0.95626184]
mat_Sqrt:  [[19.5704599   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257179  0.00835501  0.07791961]
Stock Position:  -0.002571788030803438
Bond Position:  [1.16925158]


portfolio before change:  [0.91259841]
curr_Stock_Price:  99.90929151685582
curr_Factors:  [99.90929152 -0.91194674 -0.96161268]
mat_Sqrt:  [[15.34367397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01252744  0.05894882  0.03286924]
Stock Position:  -0.012527439400102439
Bond Position:  [2.16420601]


portfolio before change:  [0.93468746]
curr_Stock_Price:  98.18923287302046
curr_Factors:  [98.18923287 -1.07257259 -0.95461833]
mat_Sqrt:  [[12.93201025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064905 -0.02470933  0.01058974]
Stock Position:  -0.0006490500442720917
Bond Position:  [0.99841719]


portfolio before change:  [0.93329586]
curr_Stock_Price:  100.71791303368883
curr_Factors:  [100.71791303  -0.93937236  -0.95820894]
mat_Sqrt:  [[15.10071922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00142545 0.02386065 0.12987864]
Stock Position:  0.0014254528417202287
Bond Position:  [0.78972722]


portfolio before change:  [0.9338029]
curr_Stock_Price:  100.93509883698388
curr_Factors:  [100.93509884  -0.81215605  -0.949591  ]
mat_Sqrt:  [[17.33505379  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00028386  0.05520629  0.123991  ]
Stock Position:  -0.0002838606783174939
Bond Position:  [0.96245441]


portfolio before change:  [0.93397616]
curr_Stock_Price:  101.17249576553859
curr_Factors:  [101.17249577  -0.79163287  -0.94909525]
mat_Sqrt:  [[17.74491199  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00341597 -0.02234102 -0.09019244]
Stock Position:  -0.003415974983312843
Bond Position:  [1.27957887]


portfolio before change:  [0.92602076]
curr_Stock_Price:  103.59503485698428
curr_Factors:  [103.59503486  -0.56094995  -0.96001524]
mat_Sqrt:  [[22.63560727  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00417053 -0.03446206  0.66332539]
Stock Position:  -0.004170532794333427
Bond Position:  [1.35806725]


portfolio before change:  [0.92942661]
curr_Stock_Price:  102.85980794211997
curr_Factors:  [102.85980794  -0.49572925  -0.94098466]
mat_Sqrt:  [[24.45055857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00122329 0.01876209 0.16681792]
Stock Position:  0.0012232916296263093
Bond Position:  [0.80359907]


portfolio before change:  [0.93168295]
curr_Stock_Price:  104.54004566168365
curr_Factors:  [104.54004566  -0.55543654  -0.95885289]
mat_Sqrt:  [[22.9950917   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00385284  0.01276552  0.22763142]
Stock Position:  -0.003852841116746529
Bond Position:  [1.33445914]


portfolio before change:  [0.92447759]
curr_Stock_Price:  106.49678792602221
curr_Factors:  [106.49678793  -0.50739298  -0.98137399]
mat_Sqrt:  [[24.03107664  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124064 -0.00239791  0.0592831 ]
Stock Position:  -0.001240637966741485
Bond Position:  [1.05660155]


portfolio before change:  [0.92690427]
curr_Stock_Price:  104.7537391522282
curr_Factors:  [104.75373915  -0.68245974  -0.99547168]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.92690427]
Stock Price:  106.50462919542376
PL:  [-5.57772493]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.63270713e-01 -7.23848333e-02  1.76976160e-01]
 [-3.70139100e-01  2.80328052e-01  5.47637345e-02]
 [-2.92040701e-01 -8.04132210e-01 -1.43613840e-01]
 [-3.89919886e-03  3.79260221e-01  2.85412671e-01]
 [ 3.36953282e-01 -1.74992953e-01 -8.10280935e-02]
 [-1.87540203e-01  9.25481293e-02  4.19984723e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 4.14427126e-01  4.19803787e-02  7.49361212e-03]
 [-2.02786875e-01  2.21952874e-03  2.58417701e-01]
 [-4.23447968e-02  5.58931633e-02 -4.14088605e-02]
 [-5.85486759e-03 -7.88581251e-02  3.39802557e-03]
 [ 8.27774409e-02  1.04989480e-01 -5.48312992e-03]
 [ 1.54410882e-02  1.56839680e-01  7.61581659e-02]
 [ 4.18635304e-02 -1.58921400e-01 -7.46790223e-03]
 [-1.21233313e-01 -8.51853975e-02  1.80649528e-01]
 [-1.39482249e-02  1.58235645e-01  2.25057798e-01]
 [-5.13006644e-02  1.11601993e-01  2.36569763e-02]
 [-2.11935888e-02 -2.00525993e-02  5.66075576e-02]
 [-3.85101090e-02  4.31169950e-01  1.61299615e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.34672013]
curr_Stock_Price:  99.07744508679266
curr_Factors:  [99.07744509 -1.07785179 -0.98345718]
mat_Sqrt:  [[12.61129505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01023008 -0.02289009  0.50486372]
Stock Position:  -0.010230081286552489
Bond Position:  [-3.33314982]


portfolio before change:  [-4.33745616]
curr_Stock_Price:  98.09041778284677
curr_Factors:  [98.09041778 -0.97427087 -0.97341878]
mat_Sqrt:  [[13.98800302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02514458  0.08864751  0.15622569]
Stock Position:  -0.025144579926345844
Bond Position:  [-1.87101381]


portfolio before change:  [-4.30737127]
curr_Stock_Price:  96.87533677997487
curr_Factors:  [96.87533678 -1.07271604 -0.9487606 ]
mat_Sqrt:  [[12.83208055  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02666118 -0.25428893 -0.40969031]
Stock Position:  -0.02666117594578791
Bond Position:  [-1.72456087]


portfolio before change:  [-4.28486749]
curr_Stock_Price:  96.01509819387967
curr_Factors:  [96.01509819 -0.94852446 -0.96098088]
mat_Sqrt:  [[14.2249877   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00450987 0.11993261 0.81420291]
Stock Position:  0.004509872125544737
Bond Position:  [-4.7178833]


portfolio before change:  [-4.28369367]
curr_Stock_Price:  96.53694028728883
curr_Factors:  [96.53694029 -1.09899697 -0.9418552 ]
mat_Sqrt:  [[12.5418815   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02518723 -0.05533763 -0.2311506 ]
Stock Position:  0.025187225138870825
Bond Position:  [-6.71519132]


portfolio before change:  [-4.31969996]
curr_Stock_Price:  95.17405537358634
curr_Factors:  [95.17405537 -0.90735605 -0.93694677]
mat_Sqrt:  [[15.0503997   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01173243  0.02926629  0.11980995]
Stock Position:  -0.011732427153617869
Bond Position:  [-3.20307729]


portfolio before change:  [-4.32233647]
curr_Stock_Price:  95.3305137267582
curr_Factors:  [95.33051373 -0.91881405 -0.95827508]
mat_Sqrt:  [[14.58889775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003884  -0.02845143  0.0120735 ]
Stock Position:  -0.0003883976696268109
Bond Position:  [-4.28531032]


portfolio before change:  [-4.32355773]
curr_Stock_Price:  95.7162134189118
curr_Factors:  [95.71621342 -0.79242134 -0.96463737]
mat_Sqrt:  [[16.51598979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02525072 0.01327536 0.02137719]
Stock Position:  0.025250722889982213
Bond Position:  [-6.74046132]


portfolio before change:  [-4.29658344]
curr_Stock_Price:  96.85121539665984
curr_Factors:  [96.8512154  -0.80867651 -0.98002146]
mat_Sqrt:  [[16.1913633   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.26298004e-03  7.01876616e-04  7.37193770e-01]
Stock Position:  -0.009262980035569156
Bond Position:  [-3.39945257]


portfolio before change:  [-4.28917113]
curr_Stock_Price:  95.9592473056408
curr_Factors:  [95.95924731 -0.68670341 -1.01289246]
mat_Sqrt:  [[17.53725924  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281425  0.01767497 -0.11812795]
Stock Position:  -0.0028142476030541914
Bond Position:  [-4.01911805]


portfolio before change:  [-4.29616912]
curr_Stock_Price:  98.08880029996025
curr_Factors:  [98.0888003  -0.97585949 -1.02348886]
mat_Sqrt:  [[13.28352902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054183 -0.02493713  0.00969362]
Stock Position:  -0.0005418256361162092
Bond Position:  [-4.2430221]


portfolio before change:  [-4.29742858]
curr_Stock_Price:  98.45528476128644
curr_Factors:  [98.45528476 -0.97648184 -1.05581199]
mat_Sqrt:  [[12.90104938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0065397   0.03320059 -0.01564184]
Stock Position:  0.006539701996301384
Bond Position:  [-4.9412968]


portfolio before change:  [-4.30952761]
curr_Stock_Price:  96.79411591163291
curr_Factors:  [96.79411591 -0.39719251 -1.04877017]
mat_Sqrt:  [[22.79687642  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00153689 0.04959706 0.21725805]
Stock Position:  0.0015368944052210239
Bond Position:  [-4.45828994]


portfolio before change:  [-4.31043527]
curr_Stock_Price:  96.92883576481965
curr_Factors:  [96.92883576 -0.82248114 -1.08796254]
mat_Sqrt:  [[14.34689261  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00252569 -0.05025536 -0.02130385]
Stock Position:  0.002525691055332103
Bond Position:  [-4.55524756]


portfolio before change:  [-4.31104216]
curr_Stock_Price:  97.13949546325651
curr_Factors:  [97.13949546 -0.71511157 -1.07826129]
mat_Sqrt:  [[16.16381628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00535504 -0.02693799  0.51534282]
Stock Position:  -0.005355038584595808
Bond Position:  [-3.79085642]


portfolio before change:  [-4.31451268]
curr_Stock_Price:  97.61058226256925
curr_Factors:  [97.61058226 -1.14496239 -1.11933898]
mat_Sqrt:  [[10.14199314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0035572  0.0500385  0.64202725]
Stock Position:  0.0035572033918791547
Bond Position:  [-4.66173338]


portfolio before change:  [-4.31548716]
curr_Stock_Price:  97.6643041204565
curr_Factors:  [97.66430412 -1.03970136 -1.13655966]
mat_Sqrt:  [[11.0814785   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0039336   0.03529165  0.06748677]
Stock Position:  -0.0039336044643794275
Bond Position:  [-3.93131442]


portfolio before change:  [-4.31485606]
curr_Stock_Price:  97.25397845168894
curr_Factors:  [97.25397845 -1.55899818 -1.14778839]
mat_Sqrt:  [[ 6.49179661  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00156449 -0.00634119  0.16148561]
Stock Position:  -0.0015644937819287662
Bond Position:  [-4.16270281]


portfolio before change:  [-4.31789073]
curr_Stock_Price:  98.52842553951145
curr_Factors:  [98.52842554 -1.23875579 -1.17526524]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.31789073]
Stock Price:  99.50805515039453
PL:  [-4.31789073]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.95838289e-01 -3.19623316e-02  9.48308008e-02]
 [-4.57965121e-02  1.09724821e-01  1.00818447e-01]
 [-3.30326273e-02 -2.01682191e-01  4.61660509e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 5.83965526e-01 -3.76494728e-01 -2.00684874e-01]
 [ 4.65335247e-03  4.53668566e-02  1.16397676e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 2.93353058e-01  2.19266224e-02 -3.66244537e-03]
 [-6.10438406e-02  2.59505730e-02  3.30012643e-02]
 [-1.31949991e-01  1.22449226e-01 -7.15163337e-03]
 [ 1.13786291e-01 -1.49118972e-01 -3.50469127e-03]
 [ 8.99916309e-02  1.06453857e-01 -9.46931125e-03]
 [ 3.75811925e-02  1.46467942e-01  9.81024980e-02]
 [ 1.30557901e-01 -1.27962263e-01  1.25628305e-01]
 [-1.61633781e-01 -1.46926814e-01  1.20930305e-01]
 [ 9.61110658e-03  1.32166076e-01  2.60654726e-01]
 [-2.95806028e-03  2.02754089e-02 -7.66016201e-03]
 [ 7.60505050e-03  1.81424140e-02  8.91306002e-02]
 [-3.15087068e-02  4.96435064e-01  1.91388010e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.16040181]
curr_Stock_Price:  100.2624772078502
curr_Factors:  [100.26247721  -1.43120443  -1.04475986]
mat_Sqrt:  [[ 8.43025678  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03289417 -0.01010738  0.27052588]
Stock Position:  -0.03289416969510495
Bond Position:  [7.45845275]


portfolio before change:  [4.16684925]
curr_Stock_Price:  100.12316402641925
curr_Factors:  [100.12316403  -1.19039845  -1.05131491]
mat_Sqrt:  [[10.6407152   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00210361  0.03469804  0.28760697]
Stock Position:  -0.002103613311530488
Bond Position:  [4.37746967]


portfolio before change:  [4.1662386]
curr_Stock_Price:  100.93375056246019
curr_Factors:  [100.93375056  -1.52686019  -1.04472778]
mat_Sqrt:  [[ 7.7127623   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0037362  -0.06377751  0.13169889]
Stock Position:  -0.0037362014150649483
Bond Position:  [4.54334742]


portfolio before change:  [4.17024034]
curr_Stock_Price:  100.1667241049736
curr_Factors:  [100.1667241   -1.6215694   -1.05243393]
mat_Sqrt:  [[ 6.90905389  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00549189 -0.00455813 -0.02970002]
Stock Position:  -0.005491889019756089
Bond Position:  [4.72034487]


portfolio before change:  [4.17011707]
curr_Stock_Price:  100.40407527292007
curr_Factors:  [100.40407527  -1.29423967  -1.04858916]
mat_Sqrt:  [[ 9.64436652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05529444 -0.11905809 -0.57249808]
Stock Position:  0.05529444001325492
Bond Position:  [-1.38167005]


portfolio before change:  [4.12244134]
curr_Stock_Price:  99.54810734384895
curr_Factors:  [99.54810734 -1.02938889 -1.01993623]
mat_Sqrt:  [[12.8239677   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00063948 0.01434626 0.03320502]
Stock Position:  0.0006394805005834688
Bond Position:  [4.05878227]


portfolio before change:  [4.12304718]
curr_Stock_Price:  98.90854939633084
curr_Factors:  [98.9085494  -0.53479438 -0.97766351]
mat_Sqrt:  [[21.79624681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00025997 -0.02845143  0.0120735 ]
Stock Position:  -0.00025996649494670047
Bond Position:  [4.14876009]


portfolio before change:  [4.12470961]
curr_Stock_Price:  96.50394214023699
curr_Factors:  [96.50394214 -0.20017751 -0.94806292]
mat_Sqrt:  [[30.61051025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00957748  0.00693381 -0.01044794]
Stock Position:  0.009577481885779317
Bond Position:  [3.20044486]


portfolio before change:  [4.15090999]
curr_Stock_Price:  99.1560133145768
curr_Factors:  [ 9.91560133e+01 -7.11617695e-02 -9.53621038e-01]
mat_Sqrt:  [[35.58455495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00150732  0.00820629  0.09414342]
Stock Position:  -0.0015073237503963623
Bond Position:  [4.3003702]


portfolio before change:  [4.15065723]
curr_Stock_Price:  100.03703906431544
curr_Factors:  [100.03703906  -0.34461908  -0.94878557]
mat_Sqrt:  [[27.44367852  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00474602  0.03872185 -0.02040162]
Stock Position:  -0.0047460178072277195
Bond Position:  [4.62543479]


portfolio before change:  [4.15147021]
curr_Stock_Price:  100.10941958363559
curr_Factors:  [ 1.00109420e+02  4.37166286e-02 -9.31940139e-01]
mat_Sqrt:  [[41.18360634  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00265204 -0.04715556 -0.00999791]
Stock Position:  0.0026520422491818334
Bond Position:  [3.8859758]


portfolio before change:  [4.14824218]
curr_Stock_Price:  98.52586924741402
curr_Factors:  [ 9.85258692e+01  6.89263256e-02 -9.34961829e-01]
mat_Sqrt:  [[41.44153515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00219122  0.03366367 -0.02701331]
Stock Position:  0.002191215702583837
Bond Position:  [3.93235075]


portfolio before change:  [4.13986932]
curr_Stock_Price:  94.25606179427471
curr_Factors:  [ 9.42560618e+01  7.96156983e-02 -9.10981249e-01]
mat_Sqrt:  [[41.04420225  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00149566 0.04631723 0.27985912]
Stock Position:  0.0014956574537854394
Bond Position:  [3.99889454]


portfolio before change:  [4.13945902]
curr_Stock_Price:  93.31323097731476
curr_Factors:  [93.31323098 -0.11284774 -0.88728719]
mat_Sqrt:  [[34.32338772  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00445462 -0.04046522  0.35838259]
Stock Position:  0.004454621469571234
Bond Position:  [3.7237839]


portfolio before change:  [4.13952081]
curr_Stock_Price:  93.11809158881172
curr_Factors:  [ 9.31180916e+01  3.55549918e-02 -8.88688461e-01]
mat_Sqrt:  [[39.67554569  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00354734 -0.04646234  0.3449805 ]
Stock Position:  -0.003547339244176701
Bond Position:  [4.46984227]


portfolio before change:  [4.1389598]
curr_Stock_Price:  93.59129552172442
curr_Factors:  [93.59129552  0.34113919 -0.92838079]
mat_Sqrt:  [[52.02351241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00127307 0.04179458 0.74357538]
Stock Position:  0.0012730694263986104
Bond Position:  [4.01981158]


portfolio before change:  [4.1376651]
curr_Stock_Price:  91.78481432497396
curr_Factors:  [ 9.17848143e+01  6.79847168e-02 -9.11553765e-01]
mat_Sqrt:  [[39.48330066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00010126  0.00641165 -0.02185231]
Stock Position:  -0.00010126244330005876
Bond Position:  [4.14695945]


portfolio before change:  [4.13825575]
curr_Stock_Price:  96.19139249213605
curr_Factors:  [96.19139249 -0.3185772  -0.93811413]
mat_Sqrt:  [[27.37550275  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00095951 0.00573714 0.25426479]
Stock Position:  0.0009595145496499143
Bond Position:  [4.04595871]


portfolio before change:  [4.13785498]
curr_Stock_Price:  94.71941798939682
curr_Factors:  [94.71941799 -0.47466089 -0.92002994]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.13785498]
Stock Price:  95.13518727000137
PL:  [4.13785498]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.31064832e-01 -6.80048939e-02  1.58638371e-01]
 [-3.21187984e-01  2.54579912e-01  6.17145008e-02]
 [-8.49875960e-02 -2.74890145e-01  1.02091337e-03]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 1.43787789e-01 -1.30406214e-01 -1.25287803e-01]
 [-8.36279441e-02  6.67114682e-02  3.13916462e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 2.87790170e-01  2.02795732e-02 -8.15703166e-04]
 [-4.27875189e-02  2.78776921e-02  9.69630309e-03]
 [-2.85399078e-01  2.73267672e-01  1.83311914e-02]
 [ 7.25002739e-02 -1.25229389e-01  1.66679300e-03]
 [ 1.81978541e-02  8.02916006e-02  4.63061581e-02]
 [-2.81157320e-02  1.76736692e-01  3.27896393e-02]
 [-6.97335569e-02 -9.26276456e-02  2.08587696e-02]
 [-1.45341630e-01 -1.11534951e-01  2.34548227e-01]
 [ 4.25211233e-02  7.43601593e-02  1.23335585e-01]
 [-8.20543881e-02  7.85313410e-02  6.19009297e-02]
 [-4.43181424e-02 -3.78846117e-02  2.14480551e-02]
 [-2.97656951e-02  4.96343955e-01  2.41283359e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.09783921]
curr_Stock_Price:  98.97281508014059
curr_Factors:  [98.97281508 -0.89299613 -1.02987361]
mat_Sqrt:  [[14.4685232   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00694188 -0.02150504  0.45255111]
Stock Position:  -0.006941882565642738
Bond Position:  [-4.41078155]


portfolio before change:  [-5.09539121]
curr_Stock_Price:  98.46130770557905
curr_Factors:  [98.46130771 -0.8903312  -1.00877069]
mat_Sqrt:  [[14.73995404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02048971  0.08050524  0.17605429]
Stock Position:  -0.020489706993795542
Bond Position:  [-3.07794787]


portfolio before change:  [-5.10340851]
curr_Stock_Price:  98.81503219668356
curr_Factors:  [98.8150322  -0.51784991 -1.0422027 ]
mat_Sqrt:  [[20.76351039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00442492 -0.0869279   0.00291238]
Stock Position:  -0.004424918244453233
Bond Position:  [-4.66616007]


portfolio before change:  [-5.10373704]
curr_Stock_Price:  98.62561510001633
curr_Factors:  [98.6256151  -0.50115882 -1.0560697 ]
mat_Sqrt:  [[20.78231731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182577 -0.00455813 -0.02970002]
Stock Position:  -0.0018257712376443446
Bond Position:  [-4.92366923]


portfolio before change:  [-5.10664978]
curr_Stock_Price:  99.5466867113063
curr_Factors:  [99.54668671 -0.40580583 -1.05556646]
mat_Sqrt:  [[23.08664828  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00497458 -0.04123807 -0.35741123]
Stock Position:  0.004974583045809481
Bond Position:  [-5.60185304]


portfolio before change:  [-5.10839642]
curr_Stock_Price:  99.47713295484054
curr_Factors:  [ 9.94771330e+01 -4.76195868e-03 -1.04015079e+00]
mat_Sqrt:  [[34.98834652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215779  0.02109602  0.08955163]
Stock Position:  -0.002157794692823202
Bond Position:  [-4.89374519]


portfolio before change:  [-5.10274937]
curr_Stock_Price:  96.29303023956143
curr_Factors:  [96.29303024 -0.13929356 -1.00825998]
mat_Sqrt:  [[30.56459777  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018539 -0.02845143  0.0120735 ]
Stock Position:  -0.00018538748423510838
Bond Position:  [-5.08489784]


portfolio before change:  [-5.10413027]
curr_Stock_Price:  96.88378581407187
curr_Factors:  [96.88378581 -0.43063342 -1.00005015]
mat_Sqrt:  [[23.16931106  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01243659  0.00641296 -0.00232697]
Stock Position:  0.012436592547927365
Bond Position:  [-6.30903444]


portfolio before change:  [-5.06598201]
curr_Stock_Price:  100.07804608111704
curr_Factors:  [100.07804608  -0.79015924  -1.05764029]
mat_Sqrt:  [[15.77065299  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254197  0.0088157   0.02766085]
Stock Position:  -0.0025419664228133743
Bond Position:  [-4.81158698]


portfolio before change:  [-5.07160328]
curr_Stock_Price:  101.81615645240008
curr_Factors:  [101.81615645  -0.78232561  -1.05487369]
mat_Sqrt:  [[16.21553134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01693447  0.08641483  0.05229379]
Stock Position:  -0.016934474265514282
Bond Position:  [-3.34740019]


portfolio before change:  [-5.04436516]
curr_Stock_Price:  100.15829159949179
curr_Factors:  [100.1582916   -0.77338147  -0.99767948]
mat_Sqrt:  [[17.04217065  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0040844  -0.03960101  0.0047549 ]
Stock Position:  0.0040844032755597585
Bond Position:  [-5.45345201]


portfolio before change:  [-5.04344771]
curr_Stock_Price:  100.71675395648623
curr_Factors:  [100.71675396  -0.70094864  -1.00879638]
mat_Sqrt:  [[18.22086084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00163127 0.02539043 0.13209858]
Stock Position:  0.0016312719539814914
Bond Position:  [-5.20774412]


portfolio before change:  [-5.04408255]
curr_Stock_Price:  101.12579389424376
curr_Factors:  [101.12579389  -0.58988919  -1.05393037]
mat_Sqrt:  [[19.54160272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00086274  0.05588905  0.09353971]
Stock Position:  -0.0008627364600021643
Bond Position:  [-4.95683764]


portfolio before change:  [-5.04637165]
curr_Stock_Price:  102.34254026283124
curr_Factors:  [102.34254026  -0.79633878  -1.07596391]
mat_Sqrt:  [[15.73712759  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00431257 -0.02929143  0.05950426]
Stock Position:  -0.004312566795776997
Bond Position:  [-4.60501261]


portfolio before change:  [-5.05113703]
curr_Stock_Price:  103.1805537349962
curr_Factors:  [103.18055373  -0.74551323  -1.09704839]
mat_Sqrt:  [[16.34494666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00613918 -0.03527045  0.66910081]
Stock Position:  -0.00613917535737555
Bond Position:  [-4.41769352]


portfolio before change:  [-5.04829838]
curr_Stock_Price:  102.53825049291778
curr_Factors:  [102.53825049  -1.2079179   -1.10188968]
mat_Sqrt:  [[10.18003375  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00683857 0.02351475 0.35184209]
Stock Position:  0.00683856919194919
Bond Position:  [-5.7495133]


portfolio before change:  [-5.04690031]
curr_Stock_Price:  102.9529034585822
curr_Factors:  [102.95290346  -1.65936035  -1.07767803]
mat_Sqrt:  [[ 6.66742184  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01010754  0.02483379  0.17658612]
Stock Position:  -0.01010754153636164
Bond Position:  [-4.00629956]


portfolio before change:  [-5.04564046]
curr_Stock_Price:  102.72915472174142
curr_Factors:  [102.72915472  -1.40899703  -1.08932861]
mat_Sqrt:  [[ 8.4466534   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00484432 -0.01198017  0.06118533]
Stock Position:  -0.0048443153810992096
Bond Position:  [-4.54798803]


portfolio before change:  [-5.04885518]
curr_Stock_Price:  103.15802432251205
curr_Factors:  [103.15802432  -1.3029561   -1.09614363]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.04885518]
Stock Price:  102.7682423261532
PL:  [-7.8170975]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.07117836e-01 -2.33271549e-02  5.35655734e-02]
 [-9.54802050e-02  1.10120171e-01 -1.91425401e-02]
 [-3.22744584e-03 -1.40004587e-01  4.84616872e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 2.44919420e-01 -1.91619650e-01 -1.51849509e-01]
 [ 6.53972990e-02  1.54557319e-02 -1.38004422e-03]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-1.10320236e-01 -4.53048822e-02 -4.72608804e-02]
 [ 2.28910319e-03  2.83820339e-02 -6.32496216e-02]
 [-2.17306575e-01  2.05918874e-01  2.27390908e-02]
 [ 8.32447881e-02 -1.31454260e-01  3.81293398e-04]
 [ 4.29188767e-03  7.10054982e-02  4.38347524e-02]
 [-1.02213531e-02  1.71689959e-01  5.18195923e-02]
 [-3.98155572e-02 -7.16978085e-02 -6.96252180e-02]
 [-1.32294252e-01 -9.34046490e-02  1.94589845e-01]
 [ 1.45877249e-02  1.17398031e-01  1.71941456e-01]
 [-1.15595198e-01  4.49828385e-02  6.26924025e-02]
 [-4.59639369e-02 -4.35634029e-02  2.21278946e-02]
 [-2.43789592e-02  5.46876332e-01  2.73106582e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.86376169]
curr_Stock_Price:  101.0569485569194
curr_Factors:  [101.05694856  -0.79569446  -0.97450757]
mat_Sqrt:  [[17.2098548   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0114345  -0.00737669  0.15280767]
Stock Position:  -0.01143450166818841
Bond Position:  [11.01929754]


portfolio before change:  [9.87672201]
curr_Stock_Price:  100.16446076316966
curr_Factors:  [100.16446076  -0.45840309  -0.94229871]
mat_Sqrt:  [[24.68292345  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00391138  0.03482306 -0.05460834]
Stock Position:  -0.003911383077307262
Bond Position:  [10.26850359]


portfolio before change:  [9.88072831]
curr_Stock_Price:  99.79659936939984
curr_Factors:  [99.79659937 -0.4501885  -0.93359482]
mat_Sqrt:  [[25.01187695  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.21936140e-04 -4.42733379e-02  1.38247704e-01]
Stock Position:  0.00012193614029943597
Bond Position:  [9.86855949]


portfolio before change:  [9.88317284]
curr_Stock_Price:  99.60866965118295
curr_Factors:  [99.60866965 -0.64754661 -0.89939938]
mat_Sqrt:  [[21.20640424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00178926 -0.00455813 -0.02970002]
Stock Position:  -0.0017892593564681652
Bond Position:  [10.06139858]


portfolio before change:  [9.8861958]
curr_Stock_Price:  99.32514823633146
curr_Factors:  [99.32514824 -0.45989085 -0.93526623]
mat_Sqrt:  [[24.61218663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00849074 -0.06059545 -0.43318438]
Stock Position:  0.00849073971833187
Bond Position:  [9.04285182]


portfolio before change:  [9.89447852]
curr_Stock_Price:  100.03435921249766
curr_Factors:  [100.03435921  -0.69338178  -0.96882349]
mat_Sqrt:  [[18.978532    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00345204  0.00488753 -0.00393688]
Stock Position:  0.003452040651254999
Bond Position:  [9.54915584]


portfolio before change:  [9.89477806]
curr_Stock_Price:  99.42948760244782
curr_Factors:  [99.4294876  -0.83641437 -0.94694209]
mat_Sqrt:  [[16.71141916  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033907 -0.02845143  0.0120735 ]
Stock Position:  -0.00033906718708368245
Bond Position:  [9.92849134]


portfolio before change:  [9.89642312]
curr_Stock_Price:  101.89915280078412
curr_Factors:  [101.8991528   -1.13422083  -0.95946552]
mat_Sqrt:  [[12.55723862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00964679 -0.01432666 -0.13482214]
Stock Position:  -0.009646793620114173
Bond Position:  [10.87942321]


portfolio before change:  [9.90297899]
curr_Stock_Price:  101.5015410935289
curr_Factors:  [101.50154109  -1.09958292  -0.93841915]
mat_Sqrt:  [[13.22450973  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00074777  0.00897519 -0.18043357]
Stock Position:  -0.0007477669111819888
Bond Position:  [9.97887848]


portfolio before change:  [9.90629529]
curr_Stock_Price:  100.4032510399438
curr_Factors:  [100.40325104  -0.894937    -0.93538374]
mat_Sqrt:  [[16.1008786   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01287807  0.06511727  0.0648683 ]
Stock Position:  -0.0128780658397543
Bond Position:  [11.19929496]


portfolio before change:  [9.90533919]
curr_Stock_Price:  100.69493034848419
curr_Factors:  [100.69493035  -0.80846789  -0.9035711 ]
mat_Sqrt:  [[18.17517157  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00439767 -0.04156949  0.00108772]
Stock Position:  0.004397674301444356
Bond Position:  [9.46251569]


portfolio before change:  [9.90851326]
curr_Stock_Price:  100.87869646914152
curr_Factors:  [100.87869647  -1.02731398  -0.93785325]
mat_Sqrt:  [[14.1363789   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00106625 0.02245391 0.12504835]
Stock Position:  0.0010662541817210724
Bond Position:  [9.80095093]


portfolio before change:  [9.91056602]
curr_Stock_Price:  100.50562904806533
curr_Factors:  [100.50562905  -0.93662588  -0.92091623]
mat_Sqrt:  [[15.68447907  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00030535 0.05429313 0.14782687]
Stock Position:  0.00030535235374784563
Bond Position:  [9.87987639]


portfolio before change:  [9.91264541]
curr_Stock_Price:  99.22549021283828
curr_Factors:  [99.22549021 -0.81886737 -0.92421498]
mat_Sqrt:  [[17.36249794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00321837 -0.02267284 -0.19862137]
Stock Position:  -0.0032183718586552266
Bond Position:  [10.23198993]


portfolio before change:  [9.91949539]
curr_Stock_Price:  97.89200048747149
curr_Factors:  [97.89200049 -0.29568245 -0.92518916]
mat_Sqrt:  [[28.87549263  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328948 -0.02953714  0.55511066]
Stock Position:  -0.003289483744153905
Bond Position:  [10.24150953]


portfolio before change:  [9.91794819]
curr_Stock_Price:  99.14079771315559
curr_Factors:  [99.14079771 -0.66421599 -0.94222131]
mat_Sqrt:  [[19.88774553  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00265069 0.03712452 0.49050112]
Stock Position:  0.002650694205064663
Bond Position:  [9.65515625]


portfolio before change:  [9.9244401]
curr_Stock_Price:  100.67919648411916
curr_Factors:  [100.67919648  -0.79582255  -0.96456081]
mat_Sqrt:  [[17.31469963  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00586997  0.01422482  0.17884397]
Stock Position:  -0.005869966848283128
Bond Position:  [10.51542365]


portfolio before change:  [9.92221367]
curr_Stock_Price:  101.5063941874806
curr_Factors:  [101.50639419  -0.58922562  -0.97312531]
mat_Sqrt:  [[21.28006809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200055 -0.01377596  0.06312472]
Stock Position:  -0.002000552881002481
Bond Position:  [10.12528257]


portfolio before change:  [9.9275482]
curr_Stock_Price:  100.10533066886121
curr_Factors:  [100.10533067  -0.58579447  -0.94518357]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.9275482]
Stock Price:  100.52045786852943
PL:  [9.40709034]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.80137351e-01 -3.04341567e-02  8.75280565e-02]
 [-2.04496696e-01  1.71326587e-01 -1.76716076e-02]
 [-6.23150721e-03 -1.48470256e-01  4.71241601e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.11865901e-02 -3.11241698e-02 -6.55731684e-02]
 [-1.24312189e-01  7.67261680e-02  3.73357952e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 4.06354080e-01  4.22475125e-02 -6.77083493e-04]
 [-3.52266719e-01 -1.65806449e-02  4.64558747e-01]
 [-4.18072311e-02  5.16362295e-02 -4.46670814e-02]
 [-3.58241662e-02 -5.47095606e-02 -3.83187890e-03]
 [ 1.29557211e-01  4.27781947e-02 -1.46351227e-01]
 [ 2.53672113e-02  1.39810502e-01  8.11955637e-02]
 [ 9.55443135e-02 -1.93318243e-01  4.53509165e-02]
 [-2.81353771e-02 -2.60018017e-02  1.12392595e-01]
 [-1.94903719e-02  1.84809637e-01  3.11476473e-01]
 [-4.29196495e-04  7.00153000e-03 -3.07241185e-02]
 [ 9.98597278e-02  5.31311077e-02  1.82279481e-01]
 [-4.01052906e-02  4.30347660e-01  1.03105060e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.80751345]
curr_Stock_Price:  100.21332027155876
curr_Factors:  [100.21332027  -0.91978122  -1.01965139]
mat_Sqrt:  [[14.40922318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01825612 -0.00962413  0.24969318]
Stock Position:  -0.018256124204845483
Bond Position:  [5.63702027]


portfolio before change:  [3.82023088]
curr_Stock_Price:  99.59391149509437
curr_Factors:  [99.5939115  -0.49722037 -0.99243027]
mat_Sqrt:  [[22.4535873   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00907117  0.05417822 -0.05041218]
Stock Position:  -0.009071168064939792
Bond Position:  [4.72366399]


portfolio before change:  [3.81944955]
curr_Stock_Price:  99.81024464568489
curr_Factors:  [99.81024465 -0.48814646 -1.01823211]
mat_Sqrt:  [[22.1290729   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.01460696e-05 -4.69504175e-02  1.34432112e-01]
Stock Position:  -2.0146069592695826e-05
Bond Position:  [3.82146033]


portfolio before change:  [3.82041754]
curr_Stock_Price:  99.1892988479517
curr_Factors:  [99.18929885 -0.499476   -1.06195228]
mat_Sqrt:  [[20.81350095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182304 -0.00455813 -0.02970002]
Stock Position:  -0.001823035792313151
Bond Position:  [4.00124319]


portfolio before change:  [3.82440858]
curr_Stock_Price:  97.548851232394
curr_Factors:  [97.54885123 -0.63569058 -1.07544175]
mat_Sqrt:  [[17.62328369  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00096451 -0.00984233 -0.187062  ]
Stock Position:  0.0009645138129862702
Bond Position:  [3.73032136]


portfolio before change:  [3.82461282]
curr_Stock_Price:  96.79360234409899
curr_Factors:  [96.79360234 -0.42332459 -1.11677599]
mat_Sqrt:  [[20.74863207  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00552856  0.02426294  0.10650863]
Stock Position:  -0.005528556784354433
Bond Position:  [4.35974175]


portfolio before change:  [3.83433378]
curr_Stock_Price:  95.23245576074143
curr_Factors:  [95.23245576 -0.24244865 -1.13550142]
mat_Sqrt:  [[24.00760701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00023602 -0.02845143  0.0120735 ]
Stock Position:  -0.00023602076978466966
Bond Position:  [3.85681062]


portfolio before change:  [3.83528049]
curr_Stock_Price:  95.30707888770517
curr_Factors:  [95.30707889 -0.39018565 -1.15583298]
mat_Sqrt:  [[20.30943296  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02005505  0.01335984 -0.00193153]
Stock Position:  0.020055050191797312
Bond Position:  [1.92389224]


portfolio before change:  [3.81367027]
curr_Stock_Price:  94.20554823673835
curr_Factors:  [94.20554824 -0.2973667  -1.19777453]
mat_Sqrt:  [[21.12247944  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01220819 -0.00524326  1.3252568 ]
Stock Position:  -0.012208186708511619
Bond Position:  [4.9637492]


portfolio before change:  [3.81013435]
curr_Stock_Price:  94.5968440578478
curr_Factors:  [94.59684406 -0.4088414  -1.15509057]
mat_Sqrt:  [[19.80020214  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0025046   0.01632881 -0.12742275]
Stock Position:  -0.0025046016648611483
Bond Position:  [4.04706177]


portfolio before change:  [3.8115597]
curr_Stock_Price:  94.43176812204904
curr_Factors:  [94.43176812 -0.61095324 -1.1370676 ]
mat_Sqrt:  [[16.44229054  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00231227 -0.01730068 -0.01093128]
Stock Position:  -0.00231226542664291
Bond Position:  [4.02991101]


portfolio before change:  [3.81307556]
curr_Stock_Price:  94.21195691925347
curr_Factors:  [94.21195692 -0.32621101 -1.11335404]
mat_Sqrt:  [[22.33113859  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00451334  0.01352765 -0.41749932]
Stock Position:  0.004513335469601848
Bond Position:  [3.38786539]


portfolio before change:  [3.82196446]
curr_Stock_Price:  95.9937498888244
curr_Factors:  [95.99374989 -0.69565642 -1.13086962]
mat_Sqrt:  [[15.45228732  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00294785 0.04421196 0.23162834]
Stock Position:  0.002947853416736943
Bond Position:  [3.53898896]


portfolio before change:  [3.82097771]
curr_Stock_Price:  95.3588425733399
curr_Factors:  [95.35884257 -0.73940568 -1.12374971]
mat_Sqrt:  [[14.79799465  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00674484 -0.0611326   0.12937354]
Stock Position:  0.006744837889352123
Bond Position:  [3.17779777]


portfolio before change:  [3.81507354]
curr_Stock_Price:  94.36568095363766
curr_Factors:  [94.36568095 -0.65260991 -1.14617384]
mat_Sqrt:  [[15.61752547  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037552 -0.00822249  0.32062479]
Stock Position:  -0.0003755203289288878
Bond Position:  [3.85050977]


portfolio before change:  [3.81595389]
curr_Stock_Price:  94.58509703007768
curr_Factors:  [94.58509703 -0.98384467 -1.16112476]
mat_Sqrt:  [[11.07323017  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00441256 0.05844194 0.88855568]
Stock Position:  0.004412557169596757
Bond Position:  [3.39859175]


portfolio before change:  [3.81431395]
curr_Stock_Price:  94.02086659768804
curr_Factors:  [94.0208666  -0.81403738 -1.15283352]
mat_Sqrt:  [[13.15294709  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004957   0.00221408 -0.08764736]
Stock Position:  -0.000495702761825326
Bond Position:  [3.86092035]


portfolio before change:  [3.81619712]
curr_Stock_Price:  92.16931078078426
curr_Factors:  [92.16931078 -0.78094811 -1.18562693]
mat_Sqrt:  [[12.897741    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0107336  0.01680153 0.51999262]
Stock Position:  0.010733601365181424
Bond Position:  [2.82688848]


portfolio before change:  [3.80114344]
curr_Stock_Price:  90.70097841086364
curr_Factors:  [90.70097841 -0.42643233 -1.18065164]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.80114344]
Stock Price:  92.52174516740321
PL:  [3.80114344]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.55414341e-01 -2.80278619e-02  7.60290098e-02]
 [-1.42607908e-01  1.43576742e-01  1.21877642e-02]
 [-2.14224482e-01 -6.01960581e-01 -9.29622788e-02]
 [-6.37417711e-03  3.24765220e-01  2.43658676e-01]
 [ 1.39526581e-01 -8.35118653e-02 -7.63925125e-02]
 [-1.14678367e-01  7.47306009e-02  2.92619321e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 1.09685172e-01 -1.44180088e-02  6.83513553e-03]
 [-9.19116793e-02  2.26921948e-02  7.24053565e-02]
 [-2.15931558e-01  2.00927316e-01  1.53079768e-02]
 [ 7.53411867e-02 -1.26878478e-01  1.35193197e-03]
 [-1.08536762e-02  5.97611551e-02  3.95548428e-02]
 [-5.57084174e-03  1.67799055e-01  5.57648990e-02]
 [-4.35269042e-02 -7.38735240e-02 -6.30990447e-02]
 [-1.30771633e-01 -9.22732091e-02  1.92670858e-01]
 [ 2.48619942e-02  1.17888842e-01  1.80947188e-01]
 [-4.42915865e-02  1.14242576e-01  2.14023838e-02]
 [-5.00082068e-02 -5.77332967e-02  2.39344114e-02]
 [-3.69966226e-02  4.43557491e-01  1.79072713e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.27843249]
curr_Stock_Price:  100.55751640014867
curr_Factors:  [100.5575164   -1.0071607   -1.00237578]
mat_Sqrt:  [[13.47981501  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01785029 -0.00886319  0.2168896 ]
Stock Position:  -0.017850293967188183
Bond Position:  [8.07341372]


portfolio before change:  [6.29613207]
curr_Stock_Price:  99.67904535439612
curr_Factors:  [99.67904535 -0.6804492  -1.01671215]
mat_Sqrt:  [[18.2614836   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00746998  0.04540295  0.0347683 ]
Stock Position:  -0.0074699820940212595
Bond Position:  [7.04073275]


portfolio before change:  [6.31351563]
curr_Stock_Price:  97.58758698327941
curr_Factors:  [97.58758698 -0.85300458 -0.98800184]
mat_Sqrt:  [[15.48301914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01606553 -0.19035665 -0.26519551]
Stock Position:  -0.016065528348407056
Bond Position:  [7.88131177]


portfolio before change:  [6.33856366]
curr_Stock_Price:  96.15112883041061
curr_Factors:  [96.15112883 -0.6949634  -0.98810839]
mat_Sqrt:  [[17.86510589  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00289659 0.10269978 0.69509038]
Stock Position:  0.0028965875767791582
Bond Position:  [6.06005349]


portfolio before change:  [6.34236875]
curr_Stock_Price:  96.94167578628958
curr_Factors:  [96.94167579 -0.77831179 -0.96711882]
mat_Sqrt:  [[16.92308913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00719589 -0.02640877 -0.21792657]
Stock Position:  0.007195894097689403
Bond Position:  [5.64478672]


portfolio before change:  [6.34872343]
curr_Stock_Price:  97.62863789855625
curr_Factors:  [97.6286379  -1.00933739 -0.96924134]
mat_Sqrt:  [[13.49868322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00791009  0.02363189  0.08347615]
Stock Position:  -0.007910087393568624
Bond Position:  [7.12097449]


portfolio before change:  [6.3376548]
curr_Stock_Price:  99.25303107708825
curr_Factors:  [99.25303108 -0.98456616 -0.94901542]
mat_Sqrt:  [[14.35489325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039473 -0.02845143  0.0120735 ]
Stock Position:  -0.00039472908567330875
Bond Position:  [6.37683286]


portfolio before change:  [6.33904439]
curr_Stock_Price:  99.77193452761895
curr_Factors:  [99.77193453 -1.29464624 -0.94307297]
mat_Sqrt:  [[10.64582421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01039921 -0.00455937  0.01949874]
Stock Position:  0.010399205793004277
Bond Position:  [5.30149551]


portfolio before change:  [6.33626348]
curr_Stock_Price:  99.37705366296268
curr_Factors:  [99.37705366 -1.57082395 -0.95960088]
mat_Sqrt:  [[ 7.91291638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00967356  0.0071759   0.20655233]
Stock Position:  -0.00967356208344792
Bond Position:  [7.29759358]


portfolio before change:  [6.3373209]
curr_Stock_Price:  99.45636316863512
curr_Factors:  [99.45636317 -1.18527511 -0.94479987]
mat_Sqrt:  [[11.81823893  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01756767  0.0635388   0.0436694 ]
Stock Position:  -0.01756766898415112
Bond Position:  [8.08453737]


portfolio before change:  [6.31385403]
curr_Stock_Price:  100.90722486380574
curr_Factors:  [100.90722486  -1.03750585  -0.95062348]
mat_Sqrt:  [[13.81938344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00523476 -0.0401225   0.00385669]
Stock Position:  0.005234760350644073
Bond Position:  [5.78562889]


portfolio before change:  [6.31882646]
curr_Stock_Price:  101.58077013457095
curr_Factors:  [101.58077013  -0.76441612  -0.93536894]
mat_Sqrt:  [[18.56112208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.66205044e-05  1.88981366e-02  1.12838956e-01]
Stock Position:  -6.662050437740771e-05
Bond Position:  [6.32559383]


portfolio before change:  [6.32049041]
curr_Stock_Price:  100.3446207386066
curr_Factors:  [100.34462074  -1.09537519  -0.91693795]
mat_Sqrt:  [[13.41397846  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00075628 0.05306272 0.15908173]
Stock Position:  0.0007562762675480349
Bond Position:  [6.24460216]


portfolio before change:  [6.32183644]
curr_Stock_Price:  100.05991278520166
curr_Factors:  [100.05991279  -0.92240717  -0.93005375]
mat_Sqrt:  [[15.69446678  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0037156  -0.02336086 -0.18000401]
Stock Position:  -0.003715599245930596
Bond Position:  [6.69361898]


portfolio before change:  [6.32672723]
curr_Stock_Price:  99.19405772422397
curr_Factors:  [99.19405772 -0.86945777 -0.8730915 ]
mat_Sqrt:  [[17.36625292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00540274 -0.02917935  0.54963633]
Stock Position:  -0.005402739608041778
Bond Position:  [6.86264689]


portfolio before change:  [6.32367873]
curr_Stock_Price:  100.07590161788089
curr_Factors:  [100.07590162  -0.76190744  -0.85919778]
mat_Sqrt:  [[19.78301397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00327764 0.03727973 0.51619196]
Stock Position:  0.003277638140575111
Bond Position:  [5.99566614]


portfolio before change:  [6.32028826]
curr_Stock_Price:  98.58410521792293
curr_Factors:  [98.58410522 -1.04917276 -0.84904439]
mat_Sqrt:  [[14.77140014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00250302  0.03612667  0.06105504]
Stock Position:  -0.0025030201740692546
Bond Position:  [6.56704627]


portfolio before change:  [6.32035086]
curr_Stock_Price:  99.21509078831122
curr_Factors:  [99.21509079 -1.26084662 -0.85834059]
mat_Sqrt:  [[11.91863235  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00391096 -0.01825687  0.06827821]
Stock Position:  -0.003910959031326557
Bond Position:  [6.70837702]


portfolio before change:  [6.31990767]
curr_Stock_Price:  99.75728482475148
curr_Factors:  [99.75728482 -1.51161082 -0.89378555]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.31990767]
Stock Price:  99.94474542052147
PL:  [6.31990767]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.95625096e-01 -2.22085646e-02  4.82201261e-02]
 [ 5.85237339e-02  9.64360598e-03  7.39715790e-03]
 [-1.83299839e-02 -1.61513951e-01  2.34202739e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.87343557e-01 -3.25793400e-01 -2.91880623e-01]
 [-8.41618946e-02 -9.13101401e-02 -1.33901168e-01]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-1.45980611e-01 -4.93988515e-02 -5.06989455e-02]
 [-7.64098932e-02 -4.33050307e-02 -1.46295760e-01]
 [-5.94192531e-01  5.82691146e-01  9.27070085e-02]
 [ 9.04612726e-02 -1.44238074e-01  1.17446176e-02]
 [-2.00630519e-01 -5.29579248e-02 -5.87886541e-02]
 [-5.91306568e-02  1.70274689e-01 -6.09195267e-03]
 [-1.04200861e-01 -1.25229478e-03  1.15945142e-01]
 [-1.26092873e-01 -1.04232504e-01  2.29805876e-01]
 [-1.13432727e-02  5.14823038e-03 -5.42966957e-02]
 [-9.02053688e-02  5.61826383e-02  7.93148335e-02]
 [-4.22260344e-02 -3.25874303e-02  2.17975865e-02]
 [-5.78140306e-03  5.91740955e-01  3.83696001e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.11161219]
curr_Stock_Price:  102.34516329653798
curr_Factors:  [102.3451633   -1.24700228  -1.01441649]
mat_Sqrt:  [[10.66462609  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01747418 -0.00702296  0.1375586 ]
Stock Position:  -0.017474182906041143
Bond Position:  [20.90001029]


portfolio before change:  [19.11414612]
curr_Stock_Price:  102.49920290273676
curr_Factors:  [102.4992029   -1.15196673  -1.01809854]
mat_Sqrt:  [[11.70235088  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00515133 0.00304958 0.02110203]
Stock Position:  0.005151329838330156
Bond Position:  [18.58613892]


portfolio before change:  [19.1202959]
curr_Stock_Price:  102.79090626172096
curr_Factors:  [102.79090626  -1.12950978  -1.02539442]
mat_Sqrt:  [[11.91493541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148718 -0.0510752   0.06681152]
Stock Position:  -0.0014871765694471947
Bond Position:  [19.27316413]


portfolio before change:  [19.12412264]
curr_Stock_Price:  103.45804511084098
curr_Factors:  [103.45804511  -1.26154388  -1.00293184]
mat_Sqrt:  [[10.74768572  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00353041 -0.00455813 -0.02970002]
Stock Position:  -0.0035304118653009687
Bond Position:  [19.48937215]


portfolio before change:  [19.1283302]
curr_Stock_Price:  103.64651951190864
curr_Factors:  [103.64651951  -1.12471035  -0.98866657]
mat_Sqrt:  [[12.5235308   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02550013 -0.10302492 -0.83265417]
Stock Position:  0.025500134894559254
Bond Position:  [16.48532997]


portfolio before change:  [19.13806083]
curr_Stock_Price:  103.86647074792333
curr_Factors:  [103.86647075  -1.5642487   -0.98997112]
mat_Sqrt:  [[ 8.07591622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01409772 -0.0288748  -0.38198276]
Stock Position:  -0.01409771605684909
Bond Position:  [20.60234085]


portfolio before change:  [19.14469005]
curr_Stock_Price:  103.76163177184782
curr_Factors:  [103.76163177  -1.63060467  -0.97302843]
mat_Sqrt:  [[ 7.67879913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00073791 -0.02845143  0.0120735 ]
Stock Position:  -0.000737914065640267
Bond Position:  [19.22125722]


portfolio before change:  [19.14919131]
curr_Stock_Price:  104.17449684779697
curr_Factors:  [104.17449685  -2.46328935  -0.97616658]
mat_Sqrt:  [[ 3.34214033  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0471569  -0.01562129 -0.14462998]
Stock Position:  -0.04715689573441979
Bond Position:  [24.0617372]


portfolio before change:  [19.13842025]
curr_Stock_Price:  104.53048398059862
curr_Factors:  [104.53048398  -2.12737348  -0.99622768]
mat_Sqrt:  [[ 4.59917795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02334994 -0.01369425 -0.41734108]
Stock Position:  -0.023349938301164407
Bond Position:  [21.5792006]


portfolio before change:  [19.14358431]
curr_Stock_Price:  104.54039471487089
curr_Factors:  [104.54039471  -2.22476661  -0.98766324]
mat_Sqrt:  [[ 4.20865744  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.13311223  0.18426312  0.26446729]
Stock Position:  -0.13311222869442313
Bond Position:  [33.05918924]


portfolio before change:  [19.09740574]
curr_Stock_Price:  104.94940597087664
curr_Factors:  [104.94940597  -1.92502244  -1.00187448]
mat_Sqrt:  [[ 5.6214041   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01585626 -0.04561208  0.03350412]
Stock Position:  0.01585625584984907
Bond Position:  [17.43330111]


portfolio before change:  [19.09686791]
curr_Stock_Price:  104.64058759191566
curr_Factors:  [104.64058759  -1.93736806  -0.98728483]
mat_Sqrt:  [[ 5.61745446  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0380952  -0.01674677 -0.16770767]
Stock Position:  -0.03809520339823441
Bond Position:  [23.08317237]


portfolio before change:  [19.09860143]
curr_Stock_Price:  104.74658494154379
curr_Factors:  [104.74658494  -1.0056265   -0.94595147]
mat_Sqrt:  [[14.87922562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00376214  0.05384558 -0.01737865]
Stock Position:  -0.0037621378492474654
Bond Position:  [19.49267252]


portfolio before change:  [19.10492224]
curr_Stock_Price:  104.36195439689769
curr_Factors:  [104.3619544   -0.82641787  -0.93121871]
mat_Sqrt:  [[17.99742358  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00447653 -0.00039601  0.33075922]
Stock Position:  -0.0044765292073607145
Bond Position:  [19.57210158]


portfolio before change:  [19.10760797]
curr_Stock_Price:  104.85517391225255
curr_Factors:  [104.85517391  -0.7629258   -0.96706412]
mat_Sqrt:  [[18.58937501  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00440441 -0.03296121  0.6555722 ]
Stock Position:  -0.004404409350738299
Bond Position:  [19.56943307]


portfolio before change:  [19.10743311]
curr_Stock_Price:  106.00579854620115
curr_Factors:  [106.00579855  -0.53664117  -0.95198998]
mat_Sqrt:  [[23.92353371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093187  0.00162801 -0.15489336]
Stock Position:  -0.0009318695497536327
Bond Position:  [19.20621669]


portfolio before change:  [19.11264542]
curr_Stock_Price:  105.56565846576726
curr_Factors:  [105.56565847  -0.5916356   -0.94090203]
mat_Sqrt:  [[22.80079676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00318255  0.01776651  0.22626314]
Stock Position:  -0.0031825496033269346
Bond Position:  [19.44861337]


portfolio before change:  [19.12596931]
curr_Stock_Price:  102.90705816680007
curr_Factors:  [102.90705817  -0.30118347  -0.95987488]
mat_Sqrt:  [[29.15912472  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132439 -0.01030505  0.06218245]
Stock Position:  -0.0013243890166990482
Bond Position:  [19.26225829]


portfolio before change:  [19.12824112]
curr_Stock_Price:  104.82821160534573
curr_Factors:  [104.82821161  -0.38601905  -0.99995609]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.12824112]
Stock Price:  104.6090132881254
PL:  [14.51922783]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.10241745e-01 -3.69419107e-02  1.11178162e-01]
 [-1.24402426e-01  1.36545000e-01  2.59339369e-02]
 [-4.18333214e-02 -2.48267558e-01  4.18150567e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.80982066e-01 -3.20739628e-01 -2.87692775e-01]
 [ 5.42236348e-03 -9.55270674e-02 -1.06441084e-01]
 [-2.84968705e-04 -8.33647773e-02  3.18056715e-03]
 [-9.23271246e-02 -1.01408371e-01 -5.49589147e-02]
 [-1.48548538e-02  5.46172944e-03 -1.10063597e-01]
 [-3.58101005e-01  3.50171756e-01  4.51272114e-02]
 [ 1.08030410e-01 -1.90531121e-01  5.71429632e-02]
 [-1.26594981e-01 -6.42954349e-03 -8.64461756e-03]
 [-1.07127980e-01  1.54817830e-01 -6.83795643e-02]
 [-1.25755916e-01 -2.11447478e-02  1.82546344e-01]
 [-1.04202221e-01 -9.96892843e-02  2.34898720e-01]
 [-1.75107170e-03  2.23545246e-02 -1.95358029e-02]
 [-1.15935297e-01  3.13238514e-02  7.88580152e-02]
 [-4.25498978e-02 -3.42402137e-02  2.22694731e-02]
 [-1.96544794e-02  5.64178405e-01  3.13461502e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.62646253]
curr_Stock_Price:  99.90950243386155
curr_Factors:  [99.90950243 -1.19722285 -1.02665419]
mat_Sqrt:  [[10.80909336  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02669062 -0.01168206  0.31716035]
Stock Position:  -0.026690622825244686
Bond Position:  [4.29310937]


portfolio before change:  [1.63718447]
curr_Stock_Price:  99.54800748591629
curr_Factors:  [99.54800749 -0.80713403 -1.00672988]
mat_Sqrt:  [[16.22861613  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00712218  0.04317932  0.0739823 ]
Stock Position:  -0.007122178861890921
Bond Position:  [2.34618318]


portfolio before change:  [1.63663264]
curr_Stock_Price:  99.70785220078429
curr_Factors:  [99.7078522  -0.80174741 -1.04755657]
mat_Sqrt:  [[15.68869604  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.002531   -0.0785091   0.11928672]
Stock Position:  -0.002531000623755969
Bond Position:  [1.88899328]


portfolio before change:  [1.63049891]
curr_Stock_Price:  102.3179040654216
curr_Factors:  [102.31790407  -1.05895036  -1.02987066]
mat_Sqrt:  [[12.67033786  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00299469 -0.00455813 -0.02970002]
Stock Position:  -0.0029946918237784923
Bond Position:  [1.9369095]


portfolio before change:  [1.62632962]
curr_Stock_Price:  103.8718441564723
curr_Factors:  [103.87184416  -1.0002171   -1.02255836]
mat_Sqrt:  [[13.74097723  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02284958 -0.10142678 -0.82070741]
Stock Position:  0.02284958032687068
Bond Position:  [-0.74709842]


portfolio before change:  [1.61097668]
curr_Stock_Price:  103.20810564958893
curr_Factors:  [103.20810565  -1.08449156  -1.04248355]
mat_Sqrt:  [[12.30212827  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152586 -0.03020831 -0.30364679]
Stock Position:  -0.0015258603799269057
Bond Position:  [1.76845784]


portfolio before change:  [1.61346414]
curr_Stock_Price:  101.86768966262193
curr_Factors:  [101.86768966  -0.65727909  -1.0031497 ]
mat_Sqrt:  [[19.36071512  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.23626755e-05 -2.63622573e-02  9.07327279e-03]
Stock Position:  -9.236267550329445e-05
Bond Position:  [1.62287291]


portfolio before change:  [1.61373416]
curr_Stock_Price:  103.3374100140693
curr_Factors:  [103.33741001  -0.59776015  -0.97385495]
mat_Sqrt:  [[21.46415561  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0049461  -0.03206814 -0.15678249]
Stock Position:  -0.004946102744039912
Bond Position:  [2.1248516]


portfolio before change:  [1.61659879]
curr_Stock_Price:  102.86565331184947
curr_Factors:  [102.86565331  -0.61541746  -0.95468321]
mat_Sqrt:  [[21.39854939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00173752  0.00172715 -0.31398081]
Stock Position:  -0.001737522929443636
Bond Position:  [1.79533022]


portfolio before change:  [1.61659328]
curr_Stock_Price:  103.12717618134538
curr_Factors:  [103.12717618  -0.93076217  -0.97511456]
mat_Sqrt:  [[15.33420901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02216274  0.11073403  0.12873537]
Stock Position:  -0.022162737929028627
Bond Position:  [3.90217386]


portfolio before change:  [1.58269349]
curr_Stock_Price:  104.7007837780358
curr_Factors:  [104.70078378  -0.54132788  -0.93660929]
mat_Sqrt:  [[23.88306041  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00480571 -0.06025123  0.16301297]
Stock Position:  0.004805714773796225
Bond Position:  [1.07953139]


portfolio before change:  [1.58751746]
curr_Stock_Price:  105.64841681397141
curr_Factors:  [105.64841681  -0.45947851  -0.94854576]
mat_Sqrt:  [[25.84436233  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00497306 -0.0020332  -0.02466069]
Stock Position:  -0.004973060059530804
Bond Position:  [2.11291339]


portfolio before change:  [1.58672136]
curr_Stock_Price:  105.9147305906039
curr_Factors:  [105.91473059  -0.23770241  -0.94134467]
mat_Sqrt:  [[32.57637278  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00359428  0.0489577  -0.19506786]
Stock Position:  -0.003594277414520844
Bond Position:  [1.96740829]


portfolio before change:  [1.59057061]
curr_Stock_Price:  104.98065197111798
curr_Factors:  [104.98065197  -0.25310587  -0.89562844]
mat_Sqrt:  [[33.28283364  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267525 -0.00668656  0.52075391]
Stock Position:  -0.002675245615877753
Bond Position:  [1.87141964]


portfolio before change:  [1.58353609]
curr_Stock_Price:  107.78504374205457
curr_Factors:  [107.78504374  -0.61048936  -0.86297733]
mat_Sqrt:  [[24.69676392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.002382   -0.03152452  0.67010066]
Stock Position:  -0.0023819998209995293
Bond Position:  [1.84028005]


portfolio before change:  [1.59303223]
curr_Stock_Price:  103.99158602436322
curr_Factors:  [103.99158602  -0.26156463  -0.82430632]
mat_Sqrt:  [[35.10835168  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00014702  0.00706912 -0.05573021]
Stock Position:  -0.00014701941796267431
Bond Position:  [1.60832102]


portfolio before change:  [1.59338496]
curr_Stock_Price:  104.32761279934059
curr_Factors:  [104.3276128   -0.13984977  -0.83264041]
mat_Sqrt:  [[39.45046714  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00251023  0.00990547  0.22495997]
Stock Position:  -0.00251022866084512
Bond Position:  [1.85527113]


portfolio before change:  [1.59822367]
curr_Stock_Price:  102.58481081693384
curr_Factors:  [102.58481082  -0.31390406  -0.83379505]
mat_Sqrt:  [[32.55694688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00119447 -0.01082771  0.06352861]
Stock Position:  -0.001194468242214958
Bond Position:  [1.72075797]


portfolio before change:  [1.59879526]
curr_Stock_Price:  102.46647759152523
curr_Factors:  [102.46647759  -0.7182183   -0.83341344]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.59879526]
Stock Price:  106.37956353861065
PL:  [-4.78076828]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.98864614e-01 -4.97013834e-02  1.23017573e-01]
 [-4.15258678e-01  2.97677078e-01  2.03532907e-02]
 [-1.76264120e-01 -5.13841231e-01 -6.74109638e-02]
 [-9.32108375e-03  1.90537214e-01  1.45376090e-01]
 [-1.32649057e-02 -1.22460433e-03 -6.02742392e-02]
 [-9.33114809e-02  6.91390538e-02  3.20275213e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 2.43515293e-01  1.33923408e-02 -6.96049921e-03]
 [-1.82493232e-01  4.50985847e-03  2.31760578e-01]
 [ 1.65415077e-02  4.22455895e-02 -3.85532890e-02]
 [-2.53697050e-02 -6.62073220e-02 -4.21597006e-03]
 [ 1.30623085e-01  6.01361367e-02 -1.21695911e-01]
 [ 3.74908797e-02  1.38637684e-01  9.49598099e-02]
 [ 7.79215825e-02 -1.71514718e-01  3.34980079e-02]
 [-7.36242254e-02 -5.83755759e-02  1.44532078e-01]
 [-2.77955711e-02  1.96828342e-01  2.88186262e-01]
 [ 9.82879114e-03 -2.64280491e-02 -5.52459297e-02]
 [-3.42431541e-02 -3.62972934e-02  3.82412278e-02]
 [-4.53673430e-02  3.77238876e-01  1.03923039e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.26619489]
curr_Stock_Price:  99.36725981580953
curr_Factors:  [99.36725982 -0.75695231 -1.00363805]
mat_Sqrt:  [[17.08553716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01024475 -0.01571696  0.35093489]
Stock Position:  -0.01024474905952155
Bond Position:  [-1.24820225]


portfolio before change:  [-2.25430138]
curr_Stock_Price:  98.1758591124412
curr_Factors:  [98.17585911 -0.67003518 -0.98470891]
mat_Sqrt:  [[18.76542832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02149794  0.09413376  0.05806227]
Stock Position:  -0.02149794205912163
Bond Position:  [-0.14372245]


portfolio before change:  [-2.25013369]
curr_Stock_Price:  97.98032310042063
curr_Factors:  [97.9803231  -0.79991405 -0.99966531]
mat_Sqrt:  [[16.20285259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01254666 -0.16249086 -0.19230472]
Stock Position:  -0.01254665795679545
Bond Position:  [-1.02080809]


portfolio before change:  [-2.24419946]
curr_Stock_Price:  97.48700711645174
curr_Factors:  [97.48700712 -0.88833525 -0.96430916]
mat_Sqrt:  [[15.2880993   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00165314 0.06025316 0.41471752]
Stock Position:  0.0016531378796400787
Bond Position:  [-2.40535892]


portfolio before change:  [-2.24611689]
curr_Stock_Price:  96.69093619685488
curr_Factors:  [96.6909362  -0.59546418 -0.95684645]
mat_Sqrt:  [[20.47509021  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012503  -0.00038725 -0.17194563]
Stock Position:  -0.0012502974182721622
Bond Position:  [-2.12522446]


portfolio before change:  [-2.24868318]
curr_Stock_Price:  98.31848134088443
curr_Factors:  [98.31848134 -0.31050317 -0.97348252]
mat_Sqrt:  [[27.22746836  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00312143  0.02186369  0.0913656 ]
Stock Position:  -0.0031214333491647577
Bond Position:  [-1.94178859]


portfolio before change:  [-2.24750279]
curr_Stock_Price:  97.78478611421218
curr_Factors:  [97.78478611 -0.44807872 -0.98291273]
mat_Sqrt:  [[23.37758257  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024238 -0.02845143  0.0120735 ]
Stock Position:  -0.00024238151524565922
Bond Position:  [-2.22380157]


portfolio before change:  [-2.24781953]
curr_Stock_Price:  96.79759509087518
curr_Factors:  [96.79759509 -0.1481491  -0.97268658]
mat_Sqrt:  [[31.55671692  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00768268  0.00423503 -0.01985637]
Stock Position:  0.007682683723936308
Bond Position:  [-2.99148484]


portfolio before change:  [-2.24828163]
curr_Stock_Price:  96.83480491356154
curr_Factors:  [96.83480491 -0.31305355 -0.9556524 ]
mat_Sqrt:  [[27.22948899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00496039  0.00142614  0.66114842]
Stock Position:  -0.004960389032266158
Bond Position:  [-1.76794332]


portfolio before change:  [-2.25134832]
curr_Stock_Price:  97.36392611820362
curr_Factors:  [97.36392612 -0.52304961 -0.94521818]
mat_Sqrt:  [[22.42525969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00043534  0.01335923 -0.1099818 ]
Stock Position:  0.00043534064098472075
Bond Position:  [-2.29373479]


portfolio before change:  [-2.25253395]
curr_Stock_Price:  95.95783736870247
curr_Factors:  [95.95783737 -1.06837154 -0.94109516]
mat_Sqrt:  [[12.86412208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217191 -0.02093659 -0.01202699]
Stock Position:  -0.0021719128463716614
Bond Position:  [-2.04412189]


portfolio before change:  [-2.25041315]
curr_Stock_Price:  94.74605345887154
curr_Factors:  [94.74605346 -0.56389942 -0.96178823]
mat_Sqrt:  [[20.60456281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00520927  0.01901672 -0.34716456]
Stock Position:  0.005209269451066742
Bond Position:  [-2.74397088]


portfolio before change:  [-2.24936003]
curr_Stock_Price:  95.07992003773958
curr_Factors:  [95.07992004 -0.53656967 -0.97235647]
mat_Sqrt:  [[21.02667054  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00287511 0.04384109 0.27089391]
Stock Position:  0.0028751142123224385
Bond Position:  [-2.52272566]


portfolio before change:  [-2.24432175]
curr_Stock_Price:  97.05168100109148
curr_Factors:  [97.051681   -1.12362244 -0.95719845]
mat_Sqrt:  [[12.11473821  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00663084 -0.05423772  0.09556049]
Stock Position:  0.006630836122340618
Bond Position:  [-2.88785555]


portfolio before change:  [-2.24893447]
curr_Stock_Price:  96.46492844355882
curr_Factors:  [96.46492844 -1.02997421 -0.93176731]
mat_Sqrt:  [[13.56425453  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00336391 -0.01845998  0.41230979]
Stock Position:  -0.003363914270053589
Bond Position:  [-1.92443472]


portfolio before change:  [-2.25032674]
curr_Stock_Price:  96.73577404996094
curr_Factors:  [96.73577405 -1.10851331 -0.95968682]
mat_Sqrt:  [[12.22866951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00295308 0.06224259 0.82211519]
Stock Position:  0.0029530840785893346
Bond Position:  [-2.53599561]


portfolio before change:  [-2.24944338]
curr_Stock_Price:  97.24962106023942
curr_Factors:  [97.24962106 -1.69124777 -0.96224172]
mat_Sqrt:  [[ 6.84686991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00031118 -0.00835728 -0.15760126]
Stock Position:  -0.0003111796151021615
Bond Position:  [-2.21918128]


portfolio before change:  [-2.25015684]
curr_Stock_Price:  97.75927078669915
curr_Factors:  [97.75927079 -1.44736497 -1.00297404]
mat_Sqrt:  [[ 8.4331387   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324605 -0.01147821  0.10909158]
Stock Position:  -0.003246049807900846
Bond Position:  [-1.93282538]


portfolio before change:  [-2.25002479]
curr_Stock_Price:  97.56971178675745
curr_Factors:  [97.56971179 -1.77254009 -1.01719958]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.25002479]
Stock Price:  97.73696435288925
PL:  [-2.25002479]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.57445831e-01 -2.82255871e-02  7.69738865e-02]
 [ 4.44805983e-02  5.33514846e-02  7.46486760e-02]
 [-1.20356005e-01 -4.57666626e-01 -2.51943561e-02]
 [-2.14440954e-02  9.34642516e-02  6.11112030e-02]
 [ 3.50201374e-01 -2.43757449e-01 -1.51900842e-01]
 [ 6.34021013e-02 -1.51258312e-01 -1.20559993e-01]
 [ 4.56974983e-02 -8.69827221e-02 -8.45876485e-03]
 [-4.88895261e-02 -3.81392742e-02 -2.50240319e-02]
 [-5.03399957e-04  1.86908725e-02 -9.33571841e-02]
 [-3.44697304e-01  3.35520998e-01  3.18704380e-02]
 [ 1.14384972e-01 -1.68764302e-01  2.22094160e-02]
 [-3.96633152e-02  4.08252841e-02  2.94882982e-02]
 [-8.58624662e-02  1.62025271e-01 -4.06433489e-02]
 [-1.38269916e-01 -3.68992823e-02  2.20126993e-01]
 [-1.37783660e-01 -1.09390815e-01  2.34702113e-01]
 [-1.35253774e-03  7.31971116e-02  6.11059889e-02]
 [-1.63661041e-01 -1.85351465e-02  8.25588709e-02]
 [-4.47875902e-02 -3.92597649e-02  2.14874340e-02]
 [-2.38794522e-02  5.06658792e-01  2.70680524e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.71878142]
curr_Stock_Price:  100.61885648921898
curr_Factors:  [100.61885649  -1.18908281  -1.00914957]
mat_Sqrt:  [[11.16861147  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02170927 -0.00892571  0.21958507]
Stock Position:  -0.02170926835135118
Bond Position:  [8.90314317]


portfolio before change:  [6.71620045]
curr_Stock_Price:  100.8402842733818
curr_Factors:  [100.84028427  -1.13761335  -0.95977688]
mat_Sqrt:  [[12.38080999  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00493471 0.01687122 0.21295189]
Stock Position:  0.00493471145566235
Bond Position:  [6.21858274]


portfolio before change:  [6.70809433]
curr_Stock_Price:  98.8825285673034
curr_Factors:  [98.88252857 -1.10665715 -0.94782386]
mat_Sqrt:  [[12.67271886  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01083553 -0.14472689 -0.07187249]
Stock Position:  -0.010835534539095254
Bond Position:  [7.77953938]


portfolio before change:  [6.71665477]
curr_Stock_Price:  98.27200777101775
curr_Factors:  [98.27200777 -0.85481349 -0.97410779]
mat_Sqrt:  [[15.78117763  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041547  0.02955599  0.17433325]
Stock Position:  -0.00041546878450777553
Bond Position:  [6.75748373]


portfolio before change:  [6.71751907]
curr_Stock_Price:  100.25839289409852
curr_Factors:  [100.25839289  -0.48192769  -0.99615875]
mat_Sqrt:  [[22.86630297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01368393 -0.07708287 -0.43333082]
Stock Position:  0.013683932843845528
Bond Position:  [5.34558996]


portfolio before change:  [6.76766096]
curr_Stock_Price:  103.82500769820601
curr_Factors:  [103.8250077   -0.73257731  -0.98804308]
mat_Sqrt:  [[18.58001368  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00187769 -0.04783208 -0.3439241 ]
Stock Position:  0.0018776855404549864
Bond Position:  [6.57271024]


portfolio before change:  [6.76984178]
curr_Stock_Price:  104.11123033858527
curr_Factors:  [104.11123034  -0.5366181   -1.00785553]
mat_Sqrt:  [[22.21985404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00187782 -0.02750635 -0.0241305 ]
Stock Position:  0.0018778240332038743
Bond Position:  [6.57433921]


portfolio before change:  [6.76448655]
curr_Stock_Price:  100.38403710951346
curr_Factors:  [100.38403711  -0.54817226  -1.00591022]
mat_Sqrt:  [[21.21950311  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259112 -0.0120607  -0.0713866 ]
Stock Position:  -0.0025911203849195686
Bond Position:  [7.02459368]


portfolio before change:  [6.76154727]
curr_Stock_Price:  102.19624414814287
curr_Factors:  [102.19624415  -0.64242052  -1.05375394]
mat_Sqrt:  [[18.74112793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101794  0.00591057 -0.26632206]
Stock Position:  -0.0010179354830999673
Bond Position:  [6.86557646]


portfolio before change:  [6.76227131]
curr_Stock_Price:  103.17133191327196
curr_Factors:  [103.17133191  -0.74602859  -1.04315952]
mat_Sqrt:  [[17.23949393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01911475  0.10610106  0.09091749]
Stock Position:  -0.019114752710499307
Bond Position:  [8.7343658]


portfolio before change:  [6.77299451]
curr_Stock_Price:  102.72459090818646
curr_Factors:  [102.72459091  -0.37886257  -1.02682389]
mat_Sqrt:  [[25.18793391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00454825 -0.05336796  0.06335728]
Stock Position:  0.004548248183839451
Bond Position:  [6.30577758]


portfolio before change:  [6.7758762]
curr_Stock_Price:  103.01152309408589
curr_Factors:  [103.01152309  -0.65188245  -1.04688508]
mat_Sqrt:  [[18.84171569  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172967  0.01291009  0.08412191]
Stock Position:  -0.0017296693029799565
Bond Position:  [6.95405206]


portfolio before change:  [6.77309725]
curr_Stock_Price:  105.6233965306603
curr_Factors:  [105.62339653  -0.62153793  -1.10456623]
mat_Sqrt:  [[18.79847499  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00478631  0.05123689 -0.11594416]
Stock Position:  -0.004786307431740582
Bond Position:  [7.2786433]


portfolio before change:  [6.77491118]
curr_Stock_Price:  105.62464189270084
curr_Factors:  [105.62464189  -0.33785037  -1.07703166]
mat_Sqrt:  [[25.661958    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367429 -0.01166858  0.62796104]
Stock Position:  -0.003674287733503913
Bond Position:  [7.1630065]


portfolio before change:  [6.78258655]
curr_Stock_Price:  104.02313576235764
curr_Factors:  [104.02313576  -0.80307319  -1.10955611]
mat_Sqrt:  [[15.36333823  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00603383 -0.03459241  0.6695398 ]
Stock Position:  -0.006033828652078943
Bond Position:  [7.41024432]


portfolio before change:  [6.79443304]
curr_Stock_Price:  102.36685694925553
curr_Factors:  [102.36685695  -0.45332428  -1.11868599]
mat_Sqrt:  [[21.25416181  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00061214 0.02314696 0.17431838]
Stock Position:  0.0006121441733918881
Bond Position:  [6.73176977]


portfolio before change:  [6.79560674]
curr_Stock_Price:  101.53461269386456
curr_Factors:  [101.53461269  -0.30197909  -1.09434604]
mat_Sqrt:  [[25.13030815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00586095 -0.00586133  0.23551748]
Stock Position:  -0.005860945154205089
Bond Position:  [7.39069554]


portfolio before change:  [6.79328396]
curr_Stock_Price:  102.24621976274298
curr_Factors:  [102.24621976  -0.6564933   -1.11813149]
mat_Sqrt:  [[17.33554526  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00238903 -0.01241503  0.06129767]
Stock Position:  -0.00238903179570893
Bond Position:  [7.03755343]


portfolio before change:  [6.7898932]
curr_Stock_Price:  104.40205595515317
curr_Factors:  [104.40205596  -1.26962755  -1.09354129]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.7898932]
Stock Price:  104.95982885326696
PL:  [1.83006435]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.57450141e-02 -8.91317588e-02  9.52332056e-02]
 [-9.93490171e-03  8.22987954e-02  6.83473382e-02]
 [-6.43486270e-02 -2.51863295e-01  2.02603047e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.78929263e-01 -2.67689569e-01 -1.72313965e-01]
 [-8.01741500e-02  6.60205737e-02  2.80620352e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-5.21100831e-02 -3.85032804e-02 -2.45082121e-02]
 [-1.99821670e-01  2.15379410e-03  2.56553462e-01]
 [ 2.05909906e-02  4.98264454e-02 -2.81685986e-02]
 [-7.50768617e-02 -2.95149422e-02  1.53618913e-02]
 [ 1.08535196e-01  1.04456039e-01 -3.79211619e-02]
 [ 4.62670088e-03  1.76984109e-01  7.12871487e-02]
 [-5.14060967e-02 -4.18525075e-02 -3.66855893e-02]
 [-1.44254788e-01 -1.02292381e-01  2.09663941e-01]
 [-1.30089747e-02  4.67284791e-02  7.72475687e-03]
 [-1.15208039e-01  3.08735394e-02  8.02696133e-02]
 [-4.38177818e-02 -3.74068736e-02  2.20301068e-02]
 [-1.72548365e-02  5.98257307e-01  3.25404879e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.95435547]
curr_Stock_Price:  98.57490571043277
curr_Factors:  [98.57490571 -0.9113336  -0.97051434]
mat_Sqrt:  [[15.0137851   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057327 -0.02818594  0.27167383]
Stock Position:  -0.0005732724592440101
Bond Position:  [-7.8978452]


portfolio before change:  [-7.95730702]
curr_Stock_Price:  100.27887434054152
curr_Factors:  [100.27887434  -1.03451534  -0.97660729]
mat_Sqrt:  [[13.42115795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00045759 0.02602516 0.19497593]
Stock Position:  0.0004575898783437223
Bond Position:  [-8.00319362]


portfolio before change:  [-7.95977629]
curr_Stock_Price:  99.25565226723364
curr_Factors:  [99.25565227 -0.63757231 -0.93766728]
mat_Sqrt:  [[20.5417476   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324783 -0.07964617  0.05779701]
Stock Position:  -0.0032478294068649946
Bond Position:  [-7.63741086]


portfolio before change:  [-7.96399268]
curr_Stock_Price:  99.96591183894826
curr_Factors:  [99.96591184 -0.5944006  -0.93039177]
mat_Sqrt:  [[21.75920481  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0017438  -0.00455813 -0.02970002]
Stock Position:  -0.0017438025667660592
Bond Position:  [-7.78967186]


portfolio before change:  [-7.96698406]
curr_Stock_Price:  100.5644436308695
curr_Factors:  [100.56444363  -0.3387882   -0.91429424]
mat_Sqrt:  [[28.72352033  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01172712 -0.08465087 -0.49156378]
Stock Position:  0.011727117837695235
Bond Position:  [-9.14631514]


portfolio before change:  [-7.98159078]
curr_Stock_Price:  99.51389932680651
curr_Factors:  [99.51389933 -0.32338308 -0.94243535]
mat_Sqrt:  [[28.06375519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.002592    0.02087754  0.08005318]
Stock Position:  -0.002592004050709983
Bond Position:  [-7.72365035]


portfolio before change:  [-7.98229121]
curr_Stock_Price:  99.03908368998799
curr_Factors:  [99.03908369 -0.25139657 -0.91735438]
mat_Sqrt:  [[30.77687545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018411 -0.02845143  0.0120735 ]
Stock Position:  -0.00018410880911387336
Bond Position:  [-7.96405724]


portfolio before change:  [-7.98437125]
curr_Stock_Price:  99.5212635366205
curr_Factors:  [ 9.95212635e+01 -8.07113970e-02 -9.27602051e-01]
mat_Sqrt:  [[36.30871798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00160036 -0.01217581 -0.06991511]
Stock Position:  -0.0016003581130207298
Bond Position:  [-7.82510159]


portfolio before change:  [-7.98112961]
curr_Stock_Price:  96.27314354218878
curr_Factors:  [96.27314354  0.10021955 -0.94951967]
mat_Sqrt:  [[41.17738834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.57956900e-03  6.81089498e-04  7.31875618e-01]
Stock Position:  -0.0035795689972944315
Bond Position:  [-7.63651325]


portfolio before change:  [-7.97357679]
curr_Stock_Price:  93.62975580978697
curr_Factors:  [ 9.36297558e+01  8.11659338e-02 -9.36568645e-01]
mat_Sqrt:  [[39.80312894  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040518  0.01575651 -0.08035717]
Stock Position:  0.0004051845458658824
Bond Position:  [-8.01151412]


portfolio before change:  [-7.97578116]
curr_Stock_Price:  93.13309306955475
curr_Factors:  [93.13309307 -0.13805648 -0.91255432]
mat_Sqrt:  [[32.57088482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223215 -0.00933344  0.0438232 ]
Stock Position:  -0.00223215309198993
Bond Position:  [-7.76789384]


portfolio before change:  [-7.98707785]
curr_Stock_Price:  97.32387752722939
curr_Factors:  [97.32387753 -0.39359138 -0.91177647]
mat_Sqrt:  [[26.38185617  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00392283  0.0330319  -0.10817852]
Stock Position:  0.003922832947938706
Bond Position:  [-8.36886316]


portfolio before change:  [-7.98747952]
curr_Stock_Price:  97.75489347695955
curr_Factors:  [ 9.77548935e+01 -6.98458782e-02 -9.34056151e-01]
mat_Sqrt:  [[35.82196415  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00066294 0.05596729 0.20336239]
Stock Position:  0.0006629407344075647
Bond Position:  [-8.05228522]


portfolio before change:  [-7.98848563]
curr_Stock_Price:  99.27420691882618
curr_Factors:  [ 9.92742069e+01 -9.43571925e-02 -9.66382787e-01]
mat_Sqrt:  [[34.36868425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174505 -0.01323492 -0.10465378]
Stock Position:  -0.0017450519179595463
Bond Position:  [-7.81524699]


portfolio before change:  [-7.98888972]
curr_Stock_Price:  98.38600233090516
curr_Factors:  [ 9.83860023e+01 -9.81492111e-03 -9.41196604e-01]
mat_Sqrt:  [[38.01143425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273861 -0.03234769  0.59811287]
Stock Position:  -0.002738609978957032
Bond Position:  [-7.71944884]


portfolio before change:  [-8.00316828]
curr_Stock_Price:  102.89502450730053
curr_Factors:  [102.89502451  -0.11430508  -0.94848042]
mat_Sqrt:  [[35.54941795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00028765  0.01477684  0.02203658]
Stock Position:  -0.0002876458108314989
Bond Position:  [-7.97357096]


portfolio before change:  [-8.00575704]
curr_Stock_Price:  104.96395701427353
curr_Factors:  [ 1.04963957e+02 -9.66611161e-03 -9.69812410e-01]
mat_Sqrt:  [[39.4146866   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00248704  0.00976307  0.22898686]
Stock Position:  -0.0024870404938450064
Bond Position:  [-7.74470743]


portfolio before change:  [-8.00051226]
curr_Stock_Price:  102.07650915788024
curr_Factors:  [ 1.02076509e+02  7.15830272e-02 -9.55732703e-01]
mat_Sqrt:  [[42.16426012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095547 -0.01182909  0.06284576]
Stock Position:  -0.000955471441915352
Bond Position:  [-7.90298107]


portfolio before change:  [-8.00150899]
curr_Stock_Price:  101.05160785501477
curr_Factors:  [101.05160786  -0.21319848  -0.96664702]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.00150899]
Stock Price:  102.53867658026535
PL:  [-10.54018557]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.56950289e-01 -6.54953465e-02  1.77380326e-01]
 [-2.35372489e-02  8.55522793e-02  4.93018929e-02]
 [-6.17799900e-02 -2.90335425e-01  1.73401568e-02]
 [-8.31012318e-03  1.95308647e-01  1.50366150e-01]
 [ 4.29449743e-01 -2.50657133e-01 -1.20121720e-01]
 [-8.32044463e-02  6.70025055e-02  2.43189979e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 7.56427654e-02 -2.03135515e-02  4.88825151e-03]
 [-2.70117684e-02  2.95286670e-02 -8.51885220e-03]
 [-4.09794513e-01  3.91452214e-01  5.08872254e-02]
 [ 5.60899061e-02 -1.15733342e-01  3.71910995e-03]
 [-7.24061295e-02  2.24719533e-02  2.12587295e-04]
 [-5.42989925e-03  1.60278902e-01  5.30137020e-02]
 [-1.11247761e-02 -1.54204089e-01 -7.48660776e-02]
 [-1.38784712e-01 -9.82276324e-02  2.02769898e-01]
 [ 2.50506844e-02  1.27760772e-01  2.01090989e-01]
 [-6.78931767e-02  1.15086378e-01  3.44038485e-02]
 [-4.84047847e-02 -5.04828979e-02  2.21870645e-02]
 [-3.61680238e-02  4.49146050e-01  1.85943102e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.04623264]
curr_Stock_Price:  99.39790029966714
curr_Factors:  [99.3979003  -1.2508361  -1.01947417]
mat_Sqrt:  [[10.2658281   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0216674  -0.02071145  0.5060167 ]
Stock Position:  -0.02166739614341277
Bond Position:  [0.10746104]


portfolio before change:  [-2.06078847]
curr_Stock_Price:  100.07092516880606
curr_Factors:  [100.07092517  -0.90367475  -1.01745406]
mat_Sqrt:  [[14.65454284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00076868  0.02705401  0.14064458]
Stock Position:  -0.000768675754580658
Bond Position:  [-1.98386637]


portfolio before change:  [-2.06075769]
curr_Stock_Price:  99.38558429179074
curr_Factors:  [99.38558429 -0.85077818 -1.01536416]
mat_Sqrt:  [[15.37687478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00427505 -0.09181212  0.04946664]
Stock Position:  -0.004275047738140946
Bond Position:  [-1.63587957]


portfolio before change:  [-2.05267878]
curr_Stock_Price:  97.40012413476356
curr_Factors:  [97.40012413 -0.88967647 -1.02595681]
mat_Sqrt:  [[14.34202733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00191229 0.06176202 0.42895277]
Stock Position:  0.001912287964848144
Bond Position:  [-2.23893586]


portfolio before change:  [-2.05235497]
curr_Stock_Price:  97.86219587485573
curr_Factors:  [97.86219587 -1.05862835 -0.99576488]
mat_Sqrt:  [[12.54305457  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03176723 -0.07926475 -0.34267383]
Stock Position:  0.031767226872378866
Bond Position:  [-5.16116554]


portfolio before change:  [-2.02937235]
curr_Stock_Price:  98.62628736401298
curr_Factors:  [98.62628736 -1.00921249 -1.0058239 ]
mat_Sqrt:  [[13.14841787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00581898  0.02118805  0.06937533]
Stock Position:  -0.005818978002242847
Bond Position:  [-1.45546815]


portfolio before change:  [-2.0329459]
curr_Stock_Price:  99.17786868088594
curr_Factors:  [99.17786868 -1.62551422 -0.99392501]
mat_Sqrt:  [[ 7.22448291  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078432 -0.02845143  0.0120735 ]
Stock Position:  -0.0007843182627296421
Bond Position:  [-1.95515889]


portfolio before change:  [-2.0342967]
curr_Stock_Price:  100.27683927902658
curr_Factors:  [100.27683928  -1.50316626  -1.05276769]
mat_Sqrt:  [[ 7.78345871  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00977921 -0.00642371  0.01394482]
Stock Position:  0.009779210598437647
Bond Position:  [-3.01492503]


portfolio before change:  [-2.02631085]
curr_Stock_Price:  101.17053847272791
curr_Factors:  [101.17053847  -1.83599423  -1.02503284]
mat_Sqrt:  [[ 5.78796361  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00483559  0.00933778 -0.02430191]
Stock Position:  -0.004835594488045418
Bond Position:  [-1.53709115]


portfolio before change:  [-2.02708759]
curr_Stock_Price:  101.25169008337954
curr_Factors:  [101.25169008  -1.94109211  -1.02780736]
mat_Sqrt:  [[ 5.20026676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07486153  0.12378806  0.14516709]
Stock Position:  -0.07486153438994583
Bond Position:  [5.55276929]


portfolio before change:  [-2.03605969]
curr_Stock_Price:  101.39008514262406
curr_Factors:  [101.39008514  -1.5825948   -1.06124266]
mat_Sqrt:  [[ 7.20761313  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00747277 -0.0365981   0.01060959]
Stock Position:  0.007472771250091464
Bond Position:  [-2.7937246]


portfolio before change:  [-2.03630122]
curr_Stock_Price:  101.45123872196123
curr_Factors:  [101.45123872  -1.67101279  -1.02319204]
mat_Sqrt:  [[ 6.85770914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01046742  0.00710626  0.00060645]
Stock Position:  -0.010467418563418384
Bond Position:  [-0.97436864]


portfolio before change:  [-2.0240805]
curr_Stock_Price:  100.26046353535133
curr_Factors:  [100.26046354  -1.27140793  -1.01749036]
mat_Sqrt:  [[10.16421424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00093759 0.05068464 0.15123334]
Stock Position:  0.000937589524882388
Bond Position:  [-2.11808366]


portfolio before change:  [-2.02516315]
curr_Stock_Price:  99.67058812630997
curr_Factors:  [99.67058813 -1.37983092 -1.03150562]
mat_Sqrt:  [[ 8.93998655  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00339914 -0.04876361 -0.21357208]
Stock Position:  -0.003399141872927504
Bond Position:  [-1.68636868]


portfolio before change:  [-2.02698617]
curr_Stock_Price:  100.08286131308856
curr_Factors:  [100.08286131  -1.17102973  -1.02154754]
mat_Sqrt:  [[11.17211772  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00894465 -0.0310623   0.57844608]
Stock Position:  -0.008944652099239706
Bond Position:  [-1.13177979]


portfolio before change:  [-2.03079819]
curr_Stock_Price:  100.47740318342207
curr_Factors:  [100.47740318  -1.28747773  -0.99314895]
mat_Sqrt:  [[10.27081296  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00675672 0.0404015  0.57365662]
Stock Position:  0.006756717299708048
Bond Position:  [-2.70969559]


portfolio before change:  [-2.0352391]
curr_Stock_Price:  99.92041663255077
curr_Factors:  [99.92041663 -1.13742919 -0.9771041 ]
mat_Sqrt:  [[12.05935547  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00480117  0.03639351  0.0981446 ]
Stock Position:  -0.004801168945621745
Bond Position:  [-1.55550429]


portfolio before change:  [-2.04095021]
curr_Stock_Price:  101.02893593998357
curr_Factors:  [101.02893594  -1.7195827   -0.99514874]
mat_Sqrt:  [[ 6.69041254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00675285 -0.01596409  0.06329352]
Stock Position:  -0.006752846953398731
Bond Position:  [-1.35871727]


portfolio before change:  [-2.0385558]
curr_Stock_Price:  100.62405016085309
curr_Factors:  [100.62405016  -1.54162785  -0.94878489]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.0385558]
Stock Price:  101.28617174634745
PL:  [-3.32472755]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-9.10843952e-02 -6.35768523e-02  1.38595418e-01]
 [-1.78691621e-01  1.79627251e-01  8.19481340e-02]
 [-5.72682174e-02 -3.11877855e-01  2.13784912e-02]
 [-3.29319110e-02 -1.03092767e-02 -7.83117828e-03]
 [ 5.08758732e-01 -3.52293760e-01 -2.24366492e-01]
 [ 4.63984169e-02 -8.06164764e-02 -8.37484917e-02]
 [ 5.50028808e-02 -9.96162301e-02 -1.07128190e-02]
 [-3.14598304e-02 -1.97027666e-01 -5.99348688e-02]
 [-3.27017011e-02 -5.57070541e-03 -1.14497678e-01]
 [-3.62558312e-01  3.51546361e-01  2.74557978e-02]
 [ 1.18329749e-01 -1.55081335e-01  2.93653296e-04]
 [-7.75953430e-02  2.02059687e-02  1.28492656e-02]
 [-1.15620841e-01  1.35385707e-01 -8.58765641e-02]
 [-1.43228201e-01 -4.17312997e-02  2.32862380e-01]
 [-1.19018958e-01 -1.04156317e-01  2.35332006e-01]
 [ 6.33986394e-03  7.40014036e-03 -3.19605187e-02]
 [-9.32723001e-02  5.06963249e-02  8.23214019e-02]
 [-3.72274265e-02 -1.72607379e-02  2.09460851e-02]
 [-1.36042758e-02  5.30184330e-01  3.25524614e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.35324713]
curr_Stock_Price:  98.7979382267792
curr_Factors:  [98.79793823 -0.8791479  -0.985734  ]
mat_Sqrt:  [[15.30523352  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00421002 -0.02010477  0.39537415]
Stock Position:  -0.004210015558172826
Bond Position:  [-5.93730627]


portfolio before change:  [-6.35617093]
curr_Stock_Price:  99.1398104739711
curr_Factors:  [99.13981047 -0.96492867 -0.97327077]
mat_Sqrt:  [[14.27245768  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01102305  0.05680312  0.23377522]
Stock Position:  -0.01102305407667024
Bond Position:  [-5.26334744]


portfolio before change:  [-6.36219013]
curr_Stock_Price:  99.5664794859347
curr_Factors:  [99.56647949 -1.01390619 -0.98260007]
mat_Sqrt:  [[13.5220177   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00450798 -0.09862444  0.06098688]
Stock Position:  -0.004507981286346105
Bond Position:  [-5.9133463]


portfolio before change:  [-6.36264729]
curr_Stock_Price:  99.33991234352483
curr_Factors:  [99.33991234 -1.14986168 -0.96150071]
mat_Sqrt:  [[12.02737182  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00289312 -0.00326008 -0.02234017]
Stock Position:  -0.002893119834095299
Bond Position:  [-6.07524502]


portfolio before change:  [-6.36885381]
curr_Stock_Price:  100.96014195075905
curr_Factors:  [100.96014195  -1.20750233  -0.9641746 ]
mat_Sqrt:  [[11.50807404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03943874 -0.11140507 -0.64005515]
Stock Position:  0.03943873893560352
Bond Position:  [-10.35059449]


portfolio before change:  [-6.30902394]
curr_Stock_Price:  102.54279507877499
curr_Factors:  [102.54279508  -0.79849514  -0.99076446]
mat_Sqrt:  [[17.1332432   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00158883 -0.02549317 -0.23891114]
Stock Position:  0.001588830484399857
Bond Position:  [-6.47194706]


portfolio before change:  [-6.30620658]
curr_Stock_Price:  105.334501982576
curr_Factors:  [105.33450198  -0.53360741  -1.01957247]
mat_Sqrt:  [[22.2860548   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00225451 -0.03150142 -0.03056069]
Stock Position:  0.0022545065173075
Bond Position:  [-6.5436839]


portfolio before change:  [-6.31156926]
curr_Stock_Price:  103.68156309086436
curr_Factors:  [103.68156309  -0.41957736  -1.07534516]
mat_Sqrt:  [[23.25224739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209791 -0.06230562 -0.1709775 ]
Stock Position:  -0.002097914058304071
Bond Position:  [-6.09405426]


portfolio before change:  [-6.31242989]
curr_Stock_Price:  103.36549850338051
curr_Factors:  [103.3654985   -0.53621449  -1.05952821]
mat_Sqrt:  [[20.95816988  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268236 -0.00176161 -0.32663001]
Stock Position:  -0.002682356196277725
Bond Position:  [-6.03516681]


portfolio before change:  [-6.31360873]
curr_Stock_Price:  103.24241752233638
curr_Factors:  [103.24241752  -0.80777738  -1.09688983]
mat_Sqrt:  [[15.36992355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02263362  0.11116872  0.07832375]
Stock Position:  -0.022633621533386977
Bond Position:  [-3.97685892]


portfolio before change:  [-6.31282437]
curr_Stock_Price:  103.16383110896588
curr_Factors:  [103.16383111  -0.9732959   -1.05217052]
mat_Sqrt:  [[13.61064074  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00840412 -0.04904102  0.00083771]
Stock Position:  0.008404123625005333
Bond Position:  [-7.17982596]


portfolio before change:  [-6.30516606]
curr_Stock_Price:  104.28869381957193
curr_Factors:  [104.28869382  -0.5616959   -1.04849293]
mat_Sqrt:  [[20.84208212  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00357214  0.00638969  0.03665538]
Stock Position:  -0.0035721374372215398
Bond Position:  [-5.93263252]


portfolio before change:  [-6.31587683]
curr_Stock_Price:  106.87185995631252
curr_Factors:  [106.87185996  -0.74188066  -1.03277772]
mat_Sqrt:  [[18.11920039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00715565  0.04281272 -0.24498193]
Stock Position:  -0.007155651183405322
Bond Position:  [-5.55113908]


portfolio before change:  [-6.31346505]
curr_Stock_Price:  106.34084729984163
curr_Factors:  [106.3408473   -0.53651751  -1.05652858]
mat_Sqrt:  [[21.61966639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00447615 -0.0131966   0.66429155]
Stock Position:  -0.004476149750964604
Bond Position:  [-5.83746749]


portfolio before change:  [-6.31348883]
curr_Stock_Price:  106.02008855999564
curr_Factors:  [106.02008856  -0.71653186  -1.04321758]
mat_Sqrt:  [[18.24478265  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00403794 -0.03293712  0.67133671]
Stock Position:  -0.00403793892720218
Bond Position:  [-5.88538619]


portfolio before change:  [-6.31987339]
curr_Stock_Price:  107.23680397840995
curr_Factors:  [107.23680398  -1.0401263   -1.03922117]
mat_Sqrt:  [[13.40586167  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.23740403e-07  2.34012985e-03 -9.11744636e-02]
Stock Position:  5.237404028185033e-07
Bond Position:  [-6.31992955]


portfolio before change:  [-6.32145402]
curr_Stock_Price:  106.37377329369086
curr_Factors:  [106.37377329  -1.56545242  -1.03731646]
mat_Sqrt:  [[ 7.87891476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00953933  0.01603159  0.23484005]
Stock Position:  -0.009539326554286829
Bond Position:  [-5.30671986]


portfolio before change:  [-6.31386595]
curr_Stock_Price:  105.43922978613966
curr_Factors:  [105.43922979  -1.13964063  -1.01898864]
mat_Sqrt:  [[12.17647114  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00274279 -0.00545832  0.05975335]
Stock Position:  -0.0027427893273674927
Bond Position:  [-6.02466836]


portfolio before change:  [-6.31771685]
curr_Stock_Price:  106.29403175968905
curr_Factors:  [106.29403176  -1.17519116  -1.02993381]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.31771685]
Stock Price:  106.95992762009413
PL:  [-13.27764447]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.07287164e-01 -3.30766525e-02  1.00155846e-01]
 [-6.34210966e-02  1.18995300e-01  9.83158607e-02]
 [-1.32403083e-01 -5.82941968e-01 -1.88384637e-02]
 [-3.53783220e-02 -1.43028879e-02 -1.03412389e-02]
 [ 8.47858315e-01 -5.00155037e-01 -2.01215416e-01]
 [ 1.10491140e-02  4.39393862e-02  8.10008706e-03]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 2.07046175e-01  3.37276132e-03  8.09991457e-03]
 [-1.16360448e-01  1.94046208e-02  1.07200072e-01]
 [-2.84808239e-01  2.70213733e-01  3.92253075e-02]
 [ 1.64004636e-02 -9.23435433e-02  5.36952821e-03]
 [-2.49196754e-03  6.48941108e-02  2.10221314e-02]
 [ 9.89449849e-03  1.55898628e-01  6.92879540e-02]
 [ 4.23339792e-02 -1.70490101e-01 -1.28863666e-02]
 [-1.18462286e-01 -8.31262804e-02  1.77157149e-01]
 [-5.05315706e-03  1.53135589e-01  2.21012444e-01]
 [-4.97130705e-02  1.18061904e-01  2.52539998e-02]
 [-2.31005563e-02 -2.13863564e-02  5.03714917e-02]
 [-3.48047295e-02  4.66063178e-01  1.78753470e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.60382968]
curr_Stock_Price:  100.04564853259741
curr_Factors:  [100.04564853  -1.33974509  -0.98327075]
mat_Sqrt:  [[ 9.80223798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02935013 -0.01045976  0.28571675]
Stock Position:  -0.029350131430506514
Bond Position:  [5.54018261]


portfolio before change:  [2.6036195]
curr_Stock_Price:  100.10000577960119
curr_Factors:  [100.10000578  -1.58920038  -0.93658692]
mat_Sqrt:  [[ 8.00753079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00503027  0.03762962  0.28046778]
Stock Position:  -0.0050302660336386685
Bond Position:  [3.10714916]


portfolio before change:  [2.60900935]
curr_Stock_Price:  99.18296364770977
curr_Factors:  [99.18296365 -1.71760914 -0.91835315]
mat_Sqrt:  [[ 7.10645816  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02129049 -0.18434244 -0.05374089]
Stock Position:  -0.021290488436530756
Bond Position:  [4.72066309]


portfolio before change:  [2.60071908]
curr_Stock_Price:  99.62779098521918
curr_Factors:  [99.62779099 -1.66113014 -0.92045014]
mat_Sqrt:  [[ 7.53727616  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00502284 -0.00452297 -0.02950068]
Stock Position:  -0.005022838050678212
Bond Position:  [3.10113333]


portfolio before change:  [2.60540877]
curr_Stock_Price:  98.84848782452589
curr_Factors:  [98.84848782 -1.38428285 -0.90636776]
mat_Sqrt:  [[10.0035261   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07935916 -0.15816291 -0.57401158]
Stock Position:  0.07935916142498828
Bond Position:  [-5.23912433]


portfolio before change:  [2.64297304]
curr_Stock_Price:  99.33833949811455
curr_Factors:  [99.3383395  -1.36386318 -0.91814494]
mat_Sqrt:  [[10.1403597   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00136455 0.01389485 0.02310729]
Stock Position:  0.0013645519316462123
Bond Position:  [2.50742072]


portfolio before change:  [2.64389304]
curr_Stock_Price:  99.55310738936527
curr_Factors:  [99.55310739 -1.11723488 -0.90179903]
mat_Sqrt:  [[13.21902833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042865 -0.02845143  0.0120735 ]
Stock Position:  -0.00042864677699560986
Bond Position:  [2.68656616]


portfolio before change:  [2.64493163]
curr_Stock_Price:  98.69723134497163
curr_Factors:  [98.69723134 -1.10026524 -0.91451724]
mat_Sqrt:  [[13.16121716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01586378 0.00106656 0.0231068 ]
Stock Position:  0.01586377951421013
Bond Position:  [1.07922052]


portfolio before change:  [2.64504705]
curr_Stock_Price:  98.68749699856983
curr_Factors:  [98.687497  -1.1613086 -0.9225086]
mat_Sqrt:  [[12.28207719  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00765158  0.00613628  0.30581197]
Stock Position:  -0.007651580244395762
Bond Position:  [3.40016235]


portfolio before change:  [2.63383613]
curr_Stock_Price:  100.26378170190347
curr_Factors:  [100.2637817   -1.44407754  -0.93065594]
mat_Sqrt:  [[ 9.32847034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02892484  0.08544909  0.11189888]
Stock Position:  -0.028924840628042802
Bond Position:  [5.53395003]


portfolio before change:  [2.66416519]
curr_Stock_Price:  99.26307093167748
curr_Factors:  [99.26307093 -1.37206148 -0.9155252 ]
mat_Sqrt:  [[10.07630797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00149978 -0.02920159  0.01531777]
Stock Position:  0.0014997769036805332
Bond Position:  [2.51529272]


portfolio before change:  [2.66589404]
curr_Stock_Price:  99.9964853063737
curr_Factors:  [99.99648531 -1.41726808 -0.89092951]
mat_Sqrt:  [[ 9.94368276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00034944 0.02052132 0.05997029]
Stock Position:  0.00034943952644686787
Bond Position:  [2.63095132]


portfolio before change:  [2.66644117]
curr_Stock_Price:  99.67971105644364
curr_Factors:  [99.67971106 -1.55386153 -0.91229431]
mat_Sqrt:  [[ 8.46386829  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00331564 0.04929947 0.19765925]
Stock Position:  0.0033156385675177074
Bond Position:  [2.33593928]


portfolio before change:  [2.66566699]
curr_Stock_Price:  99.27006443254824
curr_Factors:  [99.27006443 -1.62797829 -0.88844843]
mat_Sqrt:  [[ 8.01582197  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00440398 -0.0539137  -0.03676122]
Stock Position:  0.004403980687342547
Bond Position:  [2.22848354]


portfolio before change:  [2.66198689]
curr_Stock_Price:  98.30791416120883
curr_Factors:  [98.30791416 -1.07887886 -0.90745313]
mat_Sqrt:  [[13.48762423  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00626104 -0.02628684  0.50538003]
Stock Position:  -0.006261039318468357
Bond Position:  [3.2774966]


portfolio before change:  [2.6637715]
curr_Stock_Price:  98.15376406868144
curr_Factors:  [98.15376407 -0.80436269 -0.91554081]
mat_Sqrt:  [[17.5777126   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00250401 0.04842573 0.63048698]
Stock Position:  0.002504009706324893
Bond Position:  [2.41799353]


portfolio before change:  [2.66308432]
curr_Stock_Price:  97.63788765047539
curr_Factors:  [97.63788765 -0.78875626 -0.9176919 ]
mat_Sqrt:  [[17.72218866  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00234225  0.03733445  0.07204263]
Stock Position:  -0.0023422487462307125
Bond Position:  [2.89177654]


portfolio before change:  [2.66455565]
curr_Stock_Price:  97.31840808196665
curr_Factors:  [97.31840808 -1.11992115 -0.92902724]
mat_Sqrt:  [[12.54145769  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106612 -0.00676296  0.14369585]
Stock Position:  -0.0010661210432243208
Bond Position:  [2.76830886]


portfolio before change:  [2.66607754]
curr_Stock_Price:  96.54014850106557
curr_Factors:  [96.5401485  -0.89855137 -0.95399159]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.66607754]
Stock Price:  96.17449074315554
PL:  [2.66607754]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.49135791e-01 -6.85252823e-02  1.63703640e-01]
 [-1.43224820e-01  1.49200531e-01  3.53467462e-02]
 [-6.03672399e-02 -2.46365726e-01  2.55797846e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.25202753e-01 -2.57315733e-01 -2.07636156e-01]
 [ 1.48029277e-02 -1.12508586e-01 -1.13517773e-01]
 [ 1.80740527e-03 -8.03027092e-02  2.62344929e-03]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [-1.23934761e-02  5.18992431e-03 -1.14574859e-01]
 [-3.93166214e-01  3.90038269e-01  6.98760194e-02]
 [ 1.23601546e-01 -1.54798290e-01 -4.73527316e-03]
 [-5.23283525e-02  3.39407484e-02  2.39327300e-02]
 [-2.69033461e-02  1.76215186e-01  3.40093181e-02]
 [-6.47413943e-02 -3.99907826e-02  2.74688621e-03]
 [-2.46020148e-01 -1.58611532e-01  2.84113164e-01]
 [ 3.23698744e-02  1.25765894e-01  2.08919176e-01]
 [-8.61130496e-02  7.13265425e-02  6.58122797e-02]
 [-4.14382740e-02 -3.13022898e-02  2.23773071e-02]
 [-2.08659489e-02  5.38339401e-01  3.02584928e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.58396274]
curr_Stock_Price:  99.04439746908422
curr_Factors:  [99.04439747 -0.96557994 -0.99527494]
mat_Sqrt:  [[13.93931587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00842862 -0.0216696   0.46700092]
Stock Position:  -0.008428623148820305
Bond Position:  [-3.74915484]


portfolio before change:  [-4.58773747]
curr_Stock_Price:  99.38102593368046
curr_Factors:  [99.38102593 -0.84820789 -0.98251779]
mat_Sqrt:  [[15.93050021  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00829587  0.04718135  0.10083443]
Stock Position:  -0.008295869705042412
Bond Position:  [-3.76328542]


portfolio before change:  [-4.58835188]
curr_Stock_Price:  99.34166550043432
curr_Factors:  [99.3416655  -0.64844408 -0.94126472]
mat_Sqrt:  [[20.26420994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303525 -0.07790768  0.07297201]
Stock Position:  -0.003035249050162117
Bond Position:  [-4.28682518]


portfolio before change:  [-4.59070685]
curr_Stock_Price:  99.76441133497114
curr_Factors:  [99.76441133 -0.83136269 -0.95652016]
mat_Sqrt:  [[16.6919852   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227317 -0.00455813 -0.02970002]
Stock Position:  -0.002273172228902133
Bond Position:  [-4.36392517]


portfolio before change:  [-4.59540299]
curr_Stock_Price:  101.35031073231664
curr_Factors:  [101.35031073  -0.66584949  -0.94548861]
mat_Sqrt:  [[20.23158193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0136507  -0.08137038 -0.59232816]
Stock Position:  0.013650704005391477
Bond Position:  [-5.97890609]


portfolio before change:  [-4.56843439]
curr_Stock_Price:  103.43544231790514
curr_Factors:  [103.43544232  -0.95034884  -0.92792359]
mat_Sqrt:  [[15.81051528  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071305 -0.03557834 -0.32383461]
Stock Position:  -0.0007130539238181663
Bond Position:  [-4.49467935]


portfolio before change:  [-4.56972025]
curr_Stock_Price:  103.66270335209623
curr_Factors:  [103.66270335  -1.02646284  -0.93712248]
mat_Sqrt:  [[14.54950647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.85234862e-05 -2.53939463e-02  7.48397060e-03]
Stock Position:  1.8523486164697904e-05
Bond Position:  [-4.57164045]


portfolio before change:  [-4.57085185]
curr_Stock_Price:  104.2811195945361
curr_Factors:  [104.28111959  -1.13250425  -0.91083806]
mat_Sqrt:  [[13.51429509  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01032872 -0.01496598 -0.14840805]
Stock Position:  -0.010328717346068295
Bond Position:  [-3.49376164]


portfolio before change:  [-4.5558422]
curr_Stock_Price:  102.74334881794714
curr_Factors:  [102.74334882  -1.03098303  -0.89326096]
mat_Sqrt:  [[14.99909904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00237661  0.0016412  -0.32685018]
Stock Position:  -0.002376607286571287
Bond Position:  [-4.31166161]


portfolio before change:  [-4.55977063]
curr_Stock_Price:  103.94269849015828
curr_Factors:  [103.94269849  -1.00733076  -0.85819113]
mat_Sqrt:  [[16.09192963  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02292031  0.12334093  0.19933683]
Stock Position:  -0.02292031442189807
Bond Position:  [-2.1773713]


portfolio before change:  [-4.53120242]
curr_Stock_Price:  102.6725316590846
curr_Factors:  [102.67253166  -0.83157123  -0.85784913]
mat_Sqrt:  [[18.95607131  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00625858 -0.04895152 -0.01350842]
Stock Position:  0.006258579952158799
Bond Position:  [-5.17378667]


portfolio before change:  [-4.53127071]
curr_Stock_Price:  102.86831348436341
curr_Factors:  [102.86831348  -0.73349316  -0.85686436]
mat_Sqrt:  [[20.96998539  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00222064  0.01073301  0.06827342]
Stock Position:  -0.002220638557283346
Bond Position:  [-4.30283737]


portfolio before change:  [-4.53086996]
curr_Stock_Price:  102.20337223654478
curr_Factors:  [102.20337224  -0.97973543  -0.86617399]
mat_Sqrt:  [[16.13603956  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095509  0.05572413  0.09701912]
Stock Position:  -0.0009550897880032214
Bond Position:  [-4.43325657]


portfolio before change:  [-4.53266405]
curr_Stock_Price:  102.9212461476754
curr_Factors:  [102.92124615  -1.2412791   -0.84387622]
mat_Sqrt:  [[12.79185673  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00509803 -0.0126462   0.0078361 ]
Stock Position:  -0.005098028177517839
Bond Position:  [-4.00796864]


portfolio before change:  [-4.53408162]
curr_Stock_Price:  103.0027378601868
curr_Factors:  [103.00273786  -1.82219519  -0.81921622]
mat_Sqrt:  [[ 7.34003898  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0261744  -0.05015737  0.81049577]
Stock Position:  -0.02617440094442699
Bond Position:  [-1.83804666]


portfolio before change:  [-4.53736995]
curr_Stock_Price:  103.11081143774588
curr_Factors:  [103.11081144  -1.41605206  -0.82018456]
mat_Sqrt:  [[11.01841134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00710289 0.03977067 0.59598826]
Stock Position:  0.00710289184087785
Bond Position:  [-5.26975489]


portfolio before change:  [-4.5402928]
curr_Stock_Price:  102.88481170401359
curr_Factors:  [102.8848117   -1.40554728  -0.77828163]
mat_Sqrt:  [[11.58581048  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00611416  0.02255543  0.18774412]
Stock Position:  -0.006114162749934013
Bond Position:  [-3.91123832]


portfolio before change:  [-4.5433735]
curr_Stock_Price:  103.2287284151455
curr_Factors:  [103.22872842  -1.04402635  -0.74307328]
mat_Sqrt:  [[17.28514662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217983 -0.00989865  0.06383623]
Stock Position:  -0.002179833806298947
Bond Position:  [-4.31835202]


portfolio before change:  [-4.54580455]
curr_Stock_Price:  103.8486507243076
curr_Factors:  [103.84865072  -1.16199587  -0.7402384 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.54580455]
Stock Price:  104.3866885525372
PL:  [-8.9324931]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.96469178e-01 -7.94629035e-02  2.02791246e-01]
 [-1.33329999e-01  1.55767173e-01  8.83892137e-02]
 [-1.38171332e-01 -5.96021924e-01 -1.32796166e-02]
 [-2.94050480e-02 -4.55189577e-03 -4.21255487e-03]
 [ 8.60102426e-01 -5.14709870e-01 -2.13664608e-01]
 [-5.95197939e-03  3.12710476e-02 -3.39553455e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 8.05961382e-02 -1.94546699e-02  5.19377056e-03]
 [-3.94601451e-02  2.82289263e-02  5.44877076e-03]
 [-3.77647419e-01  3.60402356e-01  4.76386763e-02]
 [ 4.33767642e-02 -1.08382821e-01  5.35669294e-03]
 [-9.29234599e-02  1.08956790e-02 -1.51289259e-02]
 [-4.15502574e-03  1.46559910e-01  4.91883610e-02]
 [ 1.00880784e-02 -2.06955666e-01 -7.99825568e-02]
 [ 1.33520298e-01 -8.22504027e-03  1.58742335e-01]
 [ 1.46595070e-02  1.76701306e-01  2.84240281e-01]
 [-4.23654986e-02  9.95282199e-02  5.30942889e-03]
 [-4.73621722e-02 -4.70832402e-02  2.18813598e-02]
 [-3.67703695e-02  4.42633439e-01  1.79521841e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.08283537]
curr_Stock_Price:  98.97490509671101
curr_Factors:  [98.9749051  -1.70373971 -0.98994354]
mat_Sqrt:  [[ 6.69380911  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02347338 -0.02512838  0.57850698]
Stock Position:  -0.023473378081219978
Bond Position:  [-2.75956]


portfolio before change:  [-5.09317633]
curr_Stock_Price:  99.38605106462074
curr_Factors:  [99.38605106 -1.87845009 -0.9865171 ]
mat_Sqrt:  [[ 5.66351418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01964606  0.04925791  0.25214982]
Stock Position:  -0.019646059243943532
Bond Position:  [-3.14063208]


portfolio before change:  [-5.08864049]
curr_Stock_Price:  99.1152030842747
curr_Factors:  [99.11520308 -1.80909924 -0.99415756]
mat_Sqrt:  [[ 6.00760426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02601224 -0.18847868 -0.03788305]
Stock Position:  -0.026012239797404548
Bond Position:  [-2.51043206]


portfolio before change:  [-5.0958598]
curr_Stock_Price:  99.3686076513562
curr_Factors:  [99.36860765 -1.71692704 -0.97353325]
mat_Sqrt:  [[ 6.74213039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00450636 -0.00143944 -0.01201725]
Stock Position:  -0.004506359236288414
Bond Position:  [-4.64806916]


portfolio before change:  [-5.09791812]
curr_Stock_Price:  99.56747239213658
curr_Factors:  [99.56747239 -1.51528913 -0.98268144]
mat_Sqrt:  [[ 8.18959922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09807544 -0.16276555 -0.60952565]
Stock Position:  0.09807544267311967
Bond Position:  [-14.86304205]


portfolio before change:  [-5.02406487]
curr_Stock_Price:  100.35838878165539
curr_Factors:  [100.35838878  -1.87576256  -0.97363046]
mat_Sqrt:  [[ 5.80868752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0020789   0.00988877 -0.09686515]
Stock Position:  -0.002078898243841893
Bond Position:  [-4.81542999]


portfolio before change:  [-5.02442279]
curr_Stock_Price:  99.95139904538722
curr_Factors:  [99.95139905 -1.99446091 -0.95558887]
mat_Sqrt:  [[ 5.23116641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108318 -0.02845143  0.0120735 ]
Stock Position:  -0.0010831798202096013
Bond Position:  [-4.91615745]


portfolio before change:  [-5.02599122]
curr_Stock_Price:  100.26459112058286
curr_Factors:  [100.26459112  -1.48084541  -0.96051474]
mat_Sqrt:  [[ 8.72726873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0092989  -0.00615211  0.01481638]
Stock Position:  0.009298899496945586
Bond Position:  [-5.95834158]


portfolio before change:  [-5.02453023]
curr_Stock_Price:  100.58191486338599
curr_Factors:  [100.58191486  -1.4917809   -0.9583451 ]
mat_Sqrt:  [[ 8.67848063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00433475  0.00892677  0.01554383]
Stock Position:  -0.004334750893596412
Bond Position:  [-4.58853269]


portfolio before change:  [-5.0276267]
curr_Stock_Price:  101.03158107424538
curr_Factors:  [101.03158107  -1.80221953  -1.0037566 ]
mat_Sqrt:  [[ 6.1071305   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05872114  0.11396923  0.13589988]
Stock Position:  -0.0587211402400048
Bond Position:  [0.90506294]


portfolio before change:  [-5.02676045]
curr_Stock_Price:  101.02068283261471
curr_Factors:  [101.02068283  -1.6927174   -1.02970929]
mat_Sqrt:  [[ 6.63858333  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00627721 -0.03427366  0.01528115]
Stock Position:  0.006277207064457433
Bond Position:  [-5.66088819]


portfolio before change:  [-5.02774692]
curr_Stock_Price:  101.08901349840914
curr_Factors:  [101.0890135   -1.79316137  -1.01208902]
mat_Sqrt:  [[ 6.11503843  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0156549   0.00344552 -0.04315861]
Stock Position:  -0.015654899779120646
Bond Position:  [-3.44520855]


portfolio before change:  [-5.02746624]
curr_Stock_Price:  101.01605910442429
curr_Factors:  [101.0160591   -1.90962968  -1.03738387]
mat_Sqrt:  [[ 5.30296427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00182345 0.04634631 0.1403207 ]
Stock Position:  0.0018234456267350297
Bond Position:  [-5.21166353]


portfolio before change:  [-5.02919967]
curr_Stock_Price:  100.78004615351186
curr_Factors:  [100.78004615  -2.04137862  -1.01214564]
mat_Sqrt:  [[ 4.75604346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243519 -0.06544513 -0.22816797]
Stock Position:  -0.002435189059595309
Bond Position:  [-4.78378121]


portfolio before change:  [-5.03107145]
curr_Stock_Price:  101.05751023493573
curr_Factors:  [101.05751023  -2.51774833  -1.04441363]
mat_Sqrt:  [[ 2.86775013  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05778435 -0.00260099  0.4528477 ]
Stock Position:  0.05778434806027483
Bond Position:  [-10.87061379]


portfolio before change:  [-5.04641377]
curr_Stock_Price:  100.83903704732138
curr_Factors:  [100.83903705  -2.21788904  -1.07748151]
mat_Sqrt:  [[ 3.73652116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02067223 0.05587786 0.81085841]
Stock Position:  0.02067222860527661
Bond Position:  [-7.1309814]


portfolio before change:  [-5.03656803]
curr_Stock_Price:  101.40156497094566
curr_Factors:  [101.40156497  -2.10610893  -1.0827455 ]
mat_Sqrt:  [[ 4.17967755  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00926194  0.03147359  0.01514632]
Stock Position:  -0.009261936577354904
Bond Position:  [-4.09739317]


portfolio before change:  [-5.03875244]
curr_Stock_Price:  101.52680142374176
curr_Factors:  [101.52680142  -1.67173729  -1.05185781]
mat_Sqrt:  [[ 6.66405209  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0066193  -0.01488903  0.06242143]
Stock Position:  -0.006619297365019474
Bond Position:  [-4.36671635]


portfolio before change:  [-5.0415004]
curr_Stock_Price:  101.77700036489613
curr_Factors:  [101.77700036  -1.70372599  -1.05485907]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.0415004]
Stock Price:  101.79342978380643
PL:  [-6.83493018]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.85135338e-01 -3.09206115e-02  8.98526958e-02]
 [-2.12107214e-01  1.97203753e-01  7.72033193e-02]
 [-7.82456701e-02 -2.90216309e-01  2.49696590e-03]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 5.97308812e-01 -3.90075537e-01 -2.16550097e-01]
 [-4.62508728e-02  4.31175016e-02 -4.03214704e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-4.95631785e-02 -3.81956140e-02 -2.20597575e-02]
 [-2.42539112e-02  2.83940194e-02 -1.71501523e-02]
 [-3.10073819e-01  2.96532922e-01  3.57469471e-02]
 [ 7.11573693e-02 -1.24456908e-01  1.87081210e-03]
 [-1.28290115e-03  6.68666732e-02  4.22594005e-02]
 [-2.19403148e-02  1.77582589e-01  4.03604601e-02]
 [-5.38926630e-02 -9.24932542e-02 -2.56177857e-02]
 [-1.51934683e-01 -1.09366357e-01  2.23154298e-01]
 [ 3.75644375e-02  7.86178982e-02  1.18768164e-01]
 [-1.12431122e-01  3.45298005e-02  7.91380900e-02]
 [-4.66705953e-02 -4.61354973e-02  2.25042969e-02]
 [-1.99271459e-02  5.82653237e-01  3.07957574e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.4547331]
curr_Stock_Price:  100.16417838258167
curr_Factors:  [100.16417838  -0.97545652  -0.9959346 ]
mat_Sqrt:  [[13.94916288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01918342 -0.00977796  0.25632473]
Stock Position:  -0.019183416375759415
Bond Position:  [5.37622424]


portfolio before change:  [3.47962927]
curr_Stock_Price:  98.93645427126225
curr_Factors:  [98.93645427 -0.98233472 -0.97135537]
mat_Sqrt:  [[14.02424584  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01363755  0.0623613   0.22023958]
Stock Position:  -0.013637551380449404
Bond Position:  [4.82888025]


portfolio before change:  [3.47951015]
curr_Stock_Price:  99.03372184283586
curr_Factors:  [99.03372184 -0.68689015 -0.97951562]
mat_Sqrt:  [[18.70993465  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0045553  -0.09177446  0.00712315]
Stock Position:  -0.004555298217045114
Bond Position:  [3.93063828]


portfolio before change:  [3.46898146]
curr_Stock_Price:  101.56077261338864
curr_Factors:  [101.56077261  -0.94092348  -0.99966363]
mat_Sqrt:  [[14.58611794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260136 -0.00455813 -0.02970002]
Stock Position:  -0.0026013609214219965
Bond Position:  [3.73317768]


portfolio before change:  [3.47242671]
curr_Stock_Price:  100.59518435089792
curr_Factors:  [100.59518435  -1.42245092  -1.03597143]
mat_Sqrt:  [[ 8.60791425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06308543 -0.12335272 -0.61775715]
Stock Position:  0.06308543344470773
Bond Position:  [-2.87366409]


portfolio before change:  [3.47946616]
curr_Stock_Price:  100.71815972188212
curr_Factors:  [100.71815972  -1.65259605  -1.02301749]
mat_Sqrt:  [[ 6.93591215  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00769447  0.01363495 -0.11502593]
Stock Position:  -0.007694470200614801
Bond Position:  [4.25443904]


portfolio before change:  [3.47912008]
curr_Stock_Price:  100.90138580136107
curr_Factors:  [100.9013858   -1.60445427  -1.04517944]
mat_Sqrt:  [[ 7.13141701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079455 -0.02845143  0.0120735 ]
Stock Position:  -0.0007945537162124317
Bond Position:  [3.55929165]


portfolio before change:  [3.4797326]
curr_Stock_Price:  101.25053108229649
curr_Factors:  [101.25053108  -1.43485394  -1.02556072]
mat_Sqrt:  [[ 8.64674796  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00636682 -0.01207851 -0.06293035]
Stock Position:  -0.0063668230444418
Bond Position:  [4.12437681]


portfolio before change:  [3.48055942]
curr_Stock_Price:  101.28263495599506
curr_Factors:  [101.28263496  -1.83975488  -0.99225472]
mat_Sqrt:  [[ 5.96497802  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00453003  0.00897898 -0.04892461]
Stock Position:  -0.004530031935067126
Bond Position:  [3.93937299]


portfolio before change:  [3.48260962]
curr_Stock_Price:  101.04748539383074
curr_Factors:  [101.04748539  -1.33432542  -0.97854474]
mat_Sqrt:  [[10.00135319  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02950806  0.09377194  0.10197609]
Stock Position:  -0.029508062645186135
Bond Position:  [6.46432515]


portfolio before change:  [3.47163746]
curr_Stock_Price:  101.47409590116018
curr_Factors:  [101.4740959   -1.34955787  -0.95853097]
mat_Sqrt:  [[10.09171427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00677048 -0.03935673  0.00533691]
Stock Position:  0.006770483380913788
Bond Position:  [2.78460878]


portfolio before change:  [3.47025594]
curr_Stock_Price:  101.16721221166391
curr_Factors:  [101.16721221  -1.06255704  -0.96312844]
mat_Sqrt:  [[13.34429887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00067967 0.0211451  0.12055431]
Stock Position:  0.000679672497687189
Bond Position:  [3.40149537]


portfolio before change:  [3.47094402]
curr_Stock_Price:  100.92826433586332
curr_Factors:  [100.92826434  -0.64607285  -0.97464796]
mat_Sqrt:  [[19.95918023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045676  0.05615655  0.11513716]
Stock Position:  -0.0004567626308694474
Bond Position:  [3.51704428]


portfolio before change:  [3.47177905]
curr_Stock_Price:  101.02534386384121
curr_Factors:  [101.02534386  -0.47665285  -0.96008488]
mat_Sqrt:  [[24.01392049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00256143 -0.02924894 -0.07308041]
Stock Position:  -0.0025614325297379555
Bond Position:  [3.73054865]


portfolio before change:  [3.47105899]
curr_Stock_Price:  101.6706129267501
curr_Factors:  [101.67061293  -0.92970074  -0.96230642]
mat_Sqrt:  [[15.32876521  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00712434 -0.03458468  0.6365971 ]
Stock Position:  -0.007124339649033265
Bond Position:  [4.19539497]


portfolio before change:  [3.47144136]
curr_Stock_Price:  101.76418072920404
curr_Factors:  [101.76418073  -0.7477895   -0.94897271]
mat_Sqrt:  [[18.65092921  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00342277 0.02486116 0.33881251]
Stock Position:  0.0034227674152526376
Bond Position:  [3.12312624]


portfolio before change:  [3.4787641]
curr_Stock_Price:  103.67545960909625
curr_Factors:  [103.67545961  -0.70448036  -0.87940036]
mat_Sqrt:  [[21.27185249  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00448412  0.01091928  0.22575894]
Stock Position:  -0.0044841215377625305
Bond Position:  [3.94365746]


portfolio before change:  [3.49185943]
curr_Stock_Price:  100.97497783559511
curr_Factors:  [100.97497784  -0.31659665  -0.89622976]
mat_Sqrt:  [[30.0254792   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144105 -0.01458933  0.06419849]
Stock Position:  -0.001441047388450136
Bond Position:  [3.63736915]


portfolio before change:  [3.4930611]
curr_Stock_Price:  100.77219459903567
curr_Factors:  [100.7721946   -0.3379221   -0.96067234]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.4930611]
Stock Price:  101.10788262205703
PL:  [2.38517848]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.87155830e-01 -7.22037798e-02  2.01592108e-01]
 [-8.42678234e-02  1.29960616e-01  9.53557499e-02]
 [-3.56138152e-02 -2.20915933e-01  3.89384096e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 4.36704739e-01 -3.00805080e-01 -1.85861959e-01]
 [-4.11616732e-02 -2.76234948e-02 -8.11822176e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-6.00302283e-02 -3.94292930e-02 -2.76873931e-02]
 [-1.93645577e-02  7.84167993e-05 -1.16092904e-01]
 [-3.37176161e-01  3.27105160e-01  4.98134732e-02]
 [ 9.64817740e-02 -1.39107027e-01 -1.32871130e-03]
 [-3.73915206e-02  4.20601996e-02  3.04848298e-02]
 [-4.03663360e-02  1.88859336e-01  2.31231288e-02]
 [-5.71090887e-02 -8.38437209e-02 -1.67525737e-02]
 [-1.44642601e-01 -1.02580560e-01  2.10152710e-01]
 [ 3.77109320e-02  9.72237143e-02  1.56474608e-01]
 [-1.45228020e-01  1.57124906e-03  8.00989916e-02]
 [-5.05253148e-02 -5.74819657e-02  2.28622812e-02]
 [-2.82558138e-02  5.16085622e-01  2.42880924e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.10315797]
curr_Stock_Price:  99.38997066832106
curr_Factors:  [99.38997067 -1.51482924 -1.00431762]
mat_Sqrt:  [[ 8.00370337  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03096945 -0.02283284  0.57508617]
Stock Position:  -0.030969451946115462
Bond Position:  [0.97489495]


portfolio before change:  [-2.11312152]
curr_Stock_Price:  99.71956357957264
curr_Factors:  [99.71956358 -1.36157312 -1.00016419]
mat_Sqrt:  [[ 9.3991999   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00653756  0.04109716  0.27202341]
Stock Position:  -0.006537561113348266
Bond Position:  [-1.46119878]


portfolio before change:  [-2.1161722]
curr_Stock_Price:  100.13031764014805
curr_Factors:  [100.13031764  -0.93320912  -0.97861494]
mat_Sqrt:  [[14.80031476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00225465 -0.06985975  0.11108044]
Stock Position:  -0.002254652760476408
Bond Position:  [-1.8904131]


portfolio before change:  [-2.11904088]
curr_Stock_Price:  101.19301670907014
curr_Factors:  [101.19301671  -0.90190267  -1.01016177]
mat_Sqrt:  [[14.95379791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0025374  -0.00455813 -0.02970002]
Stock Position:  -0.0025373993560301586
Bond Position:  [-1.86227378]


portfolio before change:  [-2.11802171]
curr_Stock_Price:  100.6078539002145
curr_Factors:  [100.6078539   -0.77645816  -0.96603971]
mat_Sqrt:  [[17.61467659  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02219735 -0.09512292 -0.53021244]
Stock Position:  0.022197346010155196
Bond Position:  [-4.35124906]


portfolio before change:  [-2.08372265]
curr_Stock_Price:  102.2020539824862
curr_Factors:  [102.20205398  -1.25087768  -0.94969747]
mat_Sqrt:  [[11.31779909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00516409 -0.00873532 -0.23159027]
Stock Position:  -0.005164092333595762
Bond Position:  [-1.55594181]


portfolio before change:  [-2.08720194]
curr_Stock_Price:  102.80046638957255
curr_Factors:  [102.80046639  -1.33635459  -0.90638952]
mat_Sqrt:  [[10.91399359  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051918 -0.02845143  0.0120735 ]
Stock Position:  -0.0005191769482632686
Bond Position:  [-2.03383031]


portfolio before change:  [-2.08687191]
curr_Stock_Price:  101.18531086034866
curr_Factors:  [101.18531086  -1.12416244  -0.95933401]
mat_Sqrt:  [[12.59698056  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00529492 -0.01246864 -0.07898443]
Stock Position:  -0.005294915983973325
Bond Position:  [-1.55110419]


portfolio before change:  [-2.09589083]
curr_Stock_Price:  102.81538273713552
curr_Factors:  [102.81538274  -1.399941    -0.95515098]
mat_Sqrt:  [[ 9.75561483  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.41385792e-03  2.47975693e-05 -3.31180741e-01]
Stock Position:  -0.0044138579176330635
Bond Position:  [-1.64207834]


portfolio before change:  [-2.09210577]
curr_Stock_Price:  101.86482420290378
curr_Factors:  [101.8648242   -1.29289174  -0.92058281]
mat_Sqrt:  [[11.13587788  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02860683  0.10343973  0.14210397]
Stock Position:  -0.02860683398242261
Bond Position:  [0.82192434]


portfolio before change:  [-2.08716684]
curr_Stock_Price:  101.69935943477368
curr_Factors:  [101.69935943  -0.94836732  -0.93205773]
mat_Sqrt:  [[15.51172144  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00597089 -0.0439895  -0.00379044]
Stock Position:  0.005970892677946576
Bond Position:  [-2.6944028]


portfolio before change:  [-2.08278472]
curr_Stock_Price:  102.54610090535674
curr_Factors:  [102.54610091  -0.82222727  -0.92704735]
mat_Sqrt:  [[17.83277116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168694  0.0133006   0.08696473]
Stock Position:  -0.001686941464764649
Bond Position:  [-1.90979545]


portfolio before change:  [-2.08283218]
curr_Stock_Price:  102.29117188408095
curr_Factors:  [102.29117188  -0.36128798  -0.92242588]
mat_Sqrt:  [[28.33533212  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108592  0.05972257  0.06596385]
Stock Position:  -0.0010859241000926096
Bond Position:  [-1.97175173]


portfolio before change:  [-2.08248755]
curr_Stock_Price:  101.51981852780175
curr_Factors:  [101.51981853  -0.63453249  -0.93764575]
mat_Sqrt:  [[21.07475321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297482 -0.02651371 -0.04779043]
Stock Position:  -0.002974816757983967
Bond Position:  [-1.78048469]


portfolio before change:  [-2.07868166]
curr_Stock_Price:  100.09079935645332
curr_Factors:  [100.09079936  -0.73179449  -0.91817213]
mat_Sqrt:  [[19.22307051  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00543066 -0.03243882  0.59950719]
Stock Position:  -0.005430660919993298
Bond Position:  [-1.53512246]


portfolio before change:  [-2.08681877]
curr_Stock_Price:  101.51848685855097
curr_Factors:  [101.51848686  -0.89204352  -0.89387277]
mat_Sqrt:  [[17.01890243  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00424008 0.03074484 0.4463785 ]
Stock Position:  0.004240078550354068
Bond Position:  [-2.51726513]


portfolio before change:  [-2.08619271]
curr_Stock_Price:  101.81457968077747
curr_Factors:  [101.81457968  -0.60772609  -0.88666343]
mat_Sqrt:  [[22.84571995  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00563945  0.00049687  0.22850013]
Stock Position:  -0.005639450755145932
Bond Position:  [-1.5120144]


portfolio before change:  [-2.07406931]
curr_Stock_Price:  99.59779427090047
curr_Factors:  [99.59779427 -0.80554197 -0.89844143]
mat_Sqrt:  [[18.1225428   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261237 -0.01817739  0.06521972]
Stock Position:  -0.0026123679059206354
Bond Position:  [-1.81388323]


portfolio before change:  [-2.07407325]
curr_Stock_Price:  99.42569538053134
curr_Factors:  [99.42569538 -0.82205812 -0.88636147]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.07407325]
Stock Price:  100.09837686659645
PL:  [-2.17245012]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.82013631e-01 -3.06167753e-02  8.84007429e-02]
 [ 4.37711674e-02  4.08993501e-02  6.37297356e-02]
 [-1.06725757e-02 -1.13229961e-01  3.27136766e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 5.38518281e-01 -3.39333473e-01 -1.66015024e-01]
 [ 4.06048477e-02 -8.76227105e-02 -8.99041287e-02]
 [ 1.22192273e-02 -7.63747107e-02 -5.24841018e-05]
 [-7.49836869e-02 -1.27891790e-01 -5.63964520e-02]
 [-2.07255786e-02  4.91776621e-03 -1.02363256e-01]
 [-3.80382000e-01  3.75974697e-01  4.79257281e-02]
 [ 1.15291337e-01 -2.20687585e-01  9.13588345e-02]
 [-2.03283398e-01 -4.81162859e-02 -4.22842925e-02]
 [-1.82437763e-01  8.20290005e-02 -1.84934996e-01]
 [-1.53641717e-01  2.61016529e-02  1.69982987e-01]
 [-2.07588431e-01 -1.62504869e-01  3.26143491e-01]
 [-6.30147550e-03 -1.33487452e-02 -6.48376486e-02]
 [-8.39032053e-02  6.74563322e-02  7.31367084e-02]
 [-1.43650306e-02  3.66582299e-02  1.53423873e-02]
 [ 2.78127280e-02  6.25407961e-01  5.46930834e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.5247238]
curr_Stock_Price:  100.31322683346595
curr_Factors:  [100.31322683  -1.1996251   -1.00914511]
mat_Sqrt:  [[11.01796741  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02402979 -0.00968187  0.25218271]
Stock Position:  -0.024029788550951996
Bond Position:  [6.93522943]


portfolio before change:  [4.49152729]
curr_Stock_Price:  101.7668615538455
curr_Factors:  [101.76686155  -1.35124631  -1.00743732]
mat_Sqrt:  [[ 9.6215069   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00601111 0.01293351 0.1818032 ]
Stock Position:  0.006011112653795151
Bond Position:  [3.87979522]


portfolio before change:  [4.4948722]
curr_Stock_Price:  102.16193658653093
curr_Factors:  [102.16193659  -1.22778131  -1.05712575]
mat_Sqrt:  [[10.39840164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066534 -0.03580646  0.09332301]
Stock Position:  -0.0006653435518749339
Bond Position:  [4.56284498]


portfolio before change:  [4.49632077]
curr_Stock_Price:  101.69944292581445
curr_Factors:  [101.69944293  -0.97185357  -1.05226179]
mat_Sqrt:  [[13.43558073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282412 -0.00455813 -0.02970002]
Stock Position:  -0.0028241248337925445
Bond Position:  [4.78353269]


portfolio before change:  [4.50225205]
curr_Stock_Price:  100.02273077409453
curr_Factors:  [100.02273077  -0.93848077  -1.05482091]
mat_Sqrt:  [[13.62758155  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03638716 -0.10730667 -0.47359465]
Stock Position:  0.036387164613114524
Bond Position:  [0.86270848]


portfolio before change:  [4.60153321]
curr_Stock_Price:  102.74526934867124
curr_Factors:  [102.74526935  -0.86431926  -1.02796005]
mat_Sqrt:  [[15.48657462  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00129085 -0.02770873 -0.25647145]
Stock Position:  0.0012908494046242763
Bond Position:  [4.46890454]


portfolio before change:  [4.6026006]
curr_Stock_Price:  102.7065547367499
curr_Factors:  [102.70655474  -0.63290625  -0.99380022]
mat_Sqrt:  [[20.1896373   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00050702 -0.0241518  -0.00014972]
Stock Position:  0.0005070188893380586
Bond Position:  [4.55052644]


portfolio before change:  [4.60346016]
curr_Stock_Price:  102.15783326949789
curr_Factors:  [102.15783327  -0.27497285  -0.96225684]
mat_Sqrt:  [[29.64487657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302911 -0.04044293 -0.16088338]
Stock Position:  -0.003029114189807191
Bond Position:  [4.91290791]


portfolio before change:  [4.60226966]
curr_Stock_Price:  102.9563795227993
curr_Factors:  [102.95637952  -0.3819671   -0.94970737]
mat_Sqrt:  [[27.18406422  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152639  0.00155513 -0.29201388]
Stock Position:  -0.0015263874525834784
Bond Position:  [4.75942098]


portfolio before change:  [4.6012139]
curr_Stock_Price:  104.42767144726211
curr_Factors:  [104.42767145  -0.60941306  -0.9822339 ]
mat_Sqrt:  [[21.26043288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0169748   0.11889364  0.13671876]
Stock Position:  -0.016974799106384282
Bond Position:  [6.37385264]


portfolio before change:  [4.55703212]
curr_Stock_Price:  107.12434179520207
curr_Factors:  [107.1243418   -0.62673832  -0.98934931]
mat_Sqrt:  [[21.28287171  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00602558 -0.06978754  0.26062133]
Stock Position:  0.006025584988009769
Bond Position:  [3.9115453]


portfolio before change:  [4.56734977]
curr_Stock_Price:  108.6743379554443
curr_Factors:  [108.67433796  -0.65186015  -1.04988429]
mat_Sqrt:  [[19.81840887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01075551 -0.01521571 -0.12062532]
Stock Position:  -0.01075550525237281
Bond Position:  [5.73619718]


portfolio before change:  [4.56479461]
curr_Stock_Price:  109.04525354081647
curr_Factors:  [109.04525354  -0.65797703  -1.03122224]
mat_Sqrt:  [[20.13709628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01082924  0.02593985 -0.52756807]
Stock Position:  -0.010829241608409038
Bond Position:  [5.74567201]


portfolio before change:  [4.55494629]
curr_Stock_Price:  110.08733186010338
curr_Factors:  [110.08733186  -0.70447641  -1.03621006]
mat_Sqrt:  [[19.30931264  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00612503  0.00825407  0.48491415]
Stock Position:  -0.006125031237303155
Bond Position:  [5.22923464]


portfolio before change:  [4.55126207]
curr_Stock_Price:  110.9022976039981
curr_Factors:  [110.9022976   -1.26390217  -1.08633661]
mat_Sqrt:  [[10.57413402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01373262 -0.05138855  0.9303966 ]
Stock Position:  -0.013732616494293942
Bond Position:  [6.07424079]


portfolio before change:  [4.54298273]
curr_Stock_Price:  111.6157882138304
curr_Factors:  [111.61578821  -0.90819904  -1.11510368]
mat_Sqrt:  [[14.75762343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00134717 -0.00422124 -0.18496376]
Stock Position:  -0.0013471727549108114
Bond Position:  [4.69334848]


portfolio before change:  [4.54439314]
curr_Stock_Price:  111.43991717435145
curr_Factors:  [111.43991717  -0.39884393  -1.08743079]
mat_Sqrt:  [[25.20924692  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266698  0.02133157  0.20863867]
Stock Position:  -0.002666978604856814
Bond Position:  [4.84160101]


portfolio before change:  [4.54171709]
curr_Stock_Price:  112.89722221536906
curr_Factors:  [112.89722222  -0.15369489  -1.08907578]
mat_Sqrt:  [[32.58028005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00031574  0.01159235  0.04376756]
Stock Position:  -0.000315736004816956
Bond Position:  [4.57736281]


portfolio before change:  [4.54277284]
curr_Stock_Price:  113.17827597031282
curr_Factors:  [113.17827597  -0.38563056  -1.11001537]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.54277284]
Stock Price:  108.82551976548717
PL:  [-4.28274693]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-7.33946654e-02 -7.16617414e-02  1.17323826e-01]
 [-1.87269895e-01  1.64720354e-01 -4.45602918e-03]
 [ 3.77604782e-03 -1.05386649e-01  4.25971595e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.64824164e-01 -2.46321066e-01 -1.44206735e-01]
 [-7.70692279e-02  6.52878322e-02  2.70487144e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-1.07523866e-01 -7.82029557e-02 -5.36993095e-02]
 [-1.35590791e-01  1.24500902e-02  1.56726065e-01]
 [ 3.45529029e-02  2.94938796e-02 -4.54252234e-02]
 [-2.82247231e-02 -6.50272183e-02 -7.45927873e-04]
 [ 6.68518589e-02  9.92144810e-02  1.26077432e-02]
 [-2.69338515e-02  1.78681735e-01  3.49301282e-02]
 [-5.21594790e-02 -6.81339170e-02 -3.23067726e-02]
 [-1.44977287e-01 -1.02829262e-01  2.10574521e-01]
 [ 1.26848947e-02  1.09775880e-01  1.55521461e-01]
 [-7.37172024e-02  1.09979800e-01  3.36692945e-02]
 [-1.88008634e-02 -1.47030543e-02  5.18779944e-02]
 [-2.97188908e-02  5.06382500e-01  2.24017327e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.30356124]
curr_Stock_Price:  98.80485941296129
curr_Factors:  [98.80485941 -0.68188642 -1.01709692]
mat_Sqrt:  [[18.0683799   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00283901 -0.02266143  0.33469222]
Stock Position:  -0.0028390114822089887
Bond Position:  [-6.02305311]


portfolio before change:  [-6.30687404]
curr_Stock_Price:  99.44129502478553
curr_Factors:  [99.44129502 -0.64842577 -1.06520279]
mat_Sqrt:  [[17.92038538  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01026353  0.05208915 -0.01271181]
Stock Position:  -0.01026353023299951
Bond Position:  [-5.2862553]


portfolio before change:  [-6.31611771]
curr_Stock_Price:  100.21314853737805
curr_Factors:  [100.21314854  -0.5538599   -1.07461979]
mat_Sqrt:  [[19.66459326  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00049582 -0.03332618  0.12151784]
Stock Position:  0.0004958193071799679
Bond Position:  [-6.36580533]


portfolio before change:  [-6.31726927]
curr_Stock_Price:  101.10074714133403
curr_Factors:  [101.10074714  -0.39539478  -1.06566005]
mat_Sqrt:  [[23.45450742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00161776 -0.00455813 -0.02970002]
Stock Position:  -0.0016177597134886988
Bond Position:  [-6.15371256]


portfolio before change:  [-6.31715786]
curr_Stock_Price:  100.08079398520968
curr_Factors:  [100.08079399  -0.61459002  -1.05996742]
mat_Sqrt:  [[18.75424938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01754419 -0.07789356 -0.41138168]
Stock Position:  0.01754418951229474
Bond Position:  [-8.07299427]


portfolio before change:  [-6.33676135]
curr_Stock_Price:  99.078468088572
curr_Factors:  [99.07846809 -0.52863042 -1.02637818]
mat_Sqrt:  [[20.92414048  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00333883  0.02064583  0.07716245]
Stock Position:  -0.0033388328506076433
Bond Position:  [-6.00595491]


portfolio before change:  [-6.33537087]
curr_Stock_Price:  98.21225058545937
curr_Factors:  [98.21225059 -0.23181776 -1.02620961]
mat_Sqrt:  [[27.91330855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.000203   -0.02845143  0.0120735 ]
Stock Position:  -0.00020299613991114088
Bond Position:  [-6.31543417]


portfolio before change:  [-6.33749917]
curr_Stock_Price:  100.91792071900892
curr_Factors:  [100.91792072  -0.25237455  -1.03633492]
mat_Sqrt:  [[27.81562893  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00433225 -0.02472995 -0.15318918]
Stock Position:  -0.004332254500384563
Bond Position:  [-5.90029705]


portfolio before change:  [-6.32558737]
curr_Stock_Price:  97.82783045172627
curr_Factors:  [97.82783045 -0.48943811 -1.02847934]
mat_Sqrt:  [[21.44071429  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0048169   0.00393706  0.44709584]
Stock Position:  -0.004816899062369469
Bond Position:  [-5.85436059]


portfolio before change:  [-6.32410809]
curr_Stock_Price:  97.21684532669899
curr_Factors:  [97.21684533 -0.276014   -1.03338844]
mat_Sqrt:  [[26.24673413  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0009922   0.00932678 -0.12958552]
Stock Position:  0.0009922014150677918
Bond Position:  [-6.42056678]


portfolio before change:  [-6.32650193]
curr_Stock_Price:  96.42214763524174
curr_Factors:  [96.42214764 -0.48595211 -1.01957048]
mat_Sqrt:  [[21.39619984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00140473 -0.02056341 -0.00212792]
Stock Position:  -0.0014047345218393473
Bond Position:  [-6.19105441]


portfolio before change:  [-6.3318451]
curr_Stock_Price:  99.1238724606209
curr_Factors:  [99.12387246 -0.77016269 -0.9860165 ]
mat_Sqrt:  [[17.11903687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00420509 0.03137437 0.03596638]
Stock Position:  0.004205091158889891
Bond Position:  [-6.74867002]


portfolio before change:  [-6.32395871]
curr_Stock_Price:  101.40058048542926
curr_Factors:  [101.40058049  -0.6541808   -0.96709023]
mat_Sqrt:  [[20.04155328  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00075794  0.05650413  0.09964593]
Stock Position:  -0.0007579365829814519
Bond Position:  [-6.2471035]


portfolio before change:  [-6.32532253]
curr_Stock_Price:  101.13913991490968
curr_Factors:  [101.13913991  -0.77036318  -0.93602849]
mat_Sqrt:  [[18.35873566  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00329616 -0.02154584 -0.09216223]
Stock Position:  -0.003296157349228665
Bond Position:  [-5.99195201]


portfolio before change:  [-6.32440998]
curr_Stock_Price:  100.40776551684212
curr_Factors:  [100.40776552  -0.84801423  -0.91031976]
mat_Sqrt:  [[17.303444    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00604787 -0.03251747  0.6007105 ]
Stock Position:  -0.006047870203975014
Bond Position:  [-5.71715684]


portfolio before change:  [-6.31559375]
curr_Stock_Price:  98.71366609995933
curr_Factors:  [98.7136661  -0.34808121 -0.89748157]
mat_Sqrt:  [[28.40771087  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00166381 0.03471418 0.44365944]
Stock Position:  0.0016638081588155212
Bond Position:  [-6.47983435]


portfolio before change:  [-6.31938469]
curr_Stock_Price:  97.4089637640619
curr_Factors:  [97.40896376 -0.17945322 -0.91123738]
mat_Sqrt:  [[32.72789033  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195567  0.03477867  0.09604913]
Stock Position:  -0.001955665934093066
Bond Position:  [-6.12888529]


portfolio before change:  [-6.32047662]
curr_Stock_Price:  97.18373021786694
curr_Factors:  [97.18373022 -0.40957406 -0.91042947]
mat_Sqrt:  [[25.96111367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033092 -0.00464951  0.14799348]
Stock Position:  -0.00033091582489770433
Bond Position:  [-6.28831698]


portfolio before change:  [-6.32230025]
curr_Stock_Price:  97.94331233768128
curr_Factors:  [97.94331234 -0.76238316 -0.87054296]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.32230025]
Stock Price:  100.00596815561465
PL:  [-6.32826841]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.82378341e-01 -3.06522726e-02  8.85703751e-02]
 [-6.32812721e-02  1.18921753e-01  9.83357149e-02]
 [-4.37094637e-02 -2.51968042e-01  4.15346557e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.82658808e-01 -2.77666892e-01 -1.94734750e-01]
 [ 8.41535128e-03  2.64260120e-02 -3.20596844e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-1.01937403e-01 -4.43375956e-02 -4.57457863e-02]
 [-6.22986279e-02 -2.52802620e-02 -1.22319068e-01]
 [-4.60388005e-01  4.51928922e-01  5.15345217e-02]
 [ 1.06516262e-01 -1.81562001e-01  4.64011317e-02]
 [-1.32099783e-01 -9.42187640e-03 -1.10593207e-02]
 [-8.39543912e-02  1.53192318e-01 -4.18311222e-02]
 [-1.41916929e-01 -1.81747503e-02  2.05003304e-01]
 [-1.14912088e-01 -1.07530844e-01  2.48070926e-01]
 [-2.01681642e-02 -1.03473256e-02 -8.20512239e-02]
 [-8.91562744e-02  5.80593222e-02  7.82863873e-02]
 [-2.60779665e-02  1.61657022e-02  1.95268003e-02]
 [-7.53962670e-03  5.12090464e-01  3.37382140e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.79383116]
curr_Stock_Price:  100.35071317390955
curr_Factors:  [100.35071317  -1.26809491  -1.03081136]
mat_Sqrt:  [[10.07205653  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02631939 -0.0096931   0.25266663]
Stock Position:  -0.02631939433106721
Bond Position:  [7.43500115]


portfolio before change:  [4.80401786]
curr_Stock_Price:  100.0343034280771
curr_Factors:  [100.03430343  -1.42729389  -1.04667336]
mat_Sqrt:  [[ 8.42788553  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00476253  0.03760636  0.28052442]
Stock Position:  -0.004762526939415557
Bond Position:  [5.28043392]


portfolio before change:  [4.80326078]
curr_Stock_Price:  100.47048921434808
curr_Factors:  [100.47048921  -1.21116707  -1.04566826]
mat_Sqrt:  [[10.51737566  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00396839 -0.07967929  0.11848681]
Stock Position:  -0.003968387723423531
Bond Position:  [5.20196664]


portfolio before change:  [4.80288614]
curr_Stock_Price:  100.89264965874389
curr_Factors:  [100.89264966  -1.15659902  -1.05169451]
mat_Sqrt:  [[11.08689244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0034224  -0.00455813 -0.02970002]
Stock Position:  -0.0034223978825446643
Bond Position:  [5.14818093]


portfolio before change:  [4.80366501]
curr_Stock_Price:  101.04118241438708
curr_Factors:  [101.04118241  -1.08771304  -1.06825314]
mat_Sqrt:  [[11.69968592  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02869645 -0.08780598 -0.55552404]
Stock Position:  0.02869644689158704
Bond Position:  [1.90414209]


portfolio before change:  [4.79391535]
curr_Stock_Price:  100.68484010989066
curr_Factors:  [100.68484011  -1.18389871  -1.08981224]
mat_Sqrt:  [[10.36344067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0002464   0.00835664 -0.09145736]
Stock Position:  0.00024639619086164714
Bond Position:  [4.76910699]


portfolio before change:  [4.79543335]
curr_Stock_Price:  102.00618372782104
curr_Factors:  [102.00618373  -1.22893948  -1.08872759]
mat_Sqrt:  [[10.0479272   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056393 -0.02845143  0.0120735 ]
Stock Position:  -0.000563926646026763
Bond Position:  [4.85295735]


portfolio before change:  [4.79680548]
curr_Stock_Price:  101.72469669680127
curr_Factors:  [101.7246967   -1.00268234  -1.09756896]
mat_Sqrt:  [[12.45371307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00902703 -0.01402078 -0.1305    ]
Stock Position:  -0.009027027790915241
Bond Position:  [5.71507714]


portfolio before change:  [4.77662529]
curr_Stock_Price:  104.11852310162473
curr_Factors:  [104.1185231   -0.87271701  -1.08893908]
mat_Sqrt:  [[14.64170275  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00600474 -0.00799432 -0.34894225]
Stock Position:  -0.006004741269499227
Bond Position:  [5.40183008]


portfolio before change:  [4.77424778]
curr_Stock_Price:  104.7393880322429
curr_Factors:  [104.73938803  -1.03274891  -1.06940188]
mat_Sqrt:  [[12.79845496  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03423849  0.14291247  0.14701365]
Stock Position:  -0.034238492943116386
Bond Position:  [8.36036658]


portfolio before change:  [4.75824303]
curr_Stock_Price:  105.26788975697666
curr_Factors:  [105.26788976  -1.00999172  -1.09135727]
mat_Sqrt:  [[12.87335212  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00864576 -0.05741495  0.13236951]
Stock Position:  0.008645762314219204
Bond Position:  [3.84812188]


portfolio before change:  [4.76588818]
curr_Stock_Price:  106.04086988991952
curr_Factors:  [106.04086989  -1.17335741  -1.10779031]
mat_Sqrt:  [[10.8338649   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01242405 -0.00297946 -0.03154916]
Stock Position:  -0.012424054618170092
Bond Position:  [6.08334574]


portfolio before change:  [4.76486969]
curr_Stock_Price:  106.24527345685668
curr_Factors:  [106.24527346  -1.08635938  -1.08710801]
mat_Sqrt:  [[12.08884262  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00732392  0.04844366 -0.11933255]
Stock Position:  -0.007323920698032652
Bond Position:  [5.54300165]


portfolio before change:  [4.75881915]
curr_Stock_Price:  107.26063922736056
curr_Factors:  [107.26063923  -0.73881667  -1.07055113]
mat_Sqrt:  [[17.56474817  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00572397 -0.00574736  0.58481737]
Stock Position:  -0.005723969029553447
Bond Position:  [5.37277573]


portfolio before change:  [4.75540498]
curr_Stock_Price:  108.09179879169854
curr_Factors:  [108.09179879  -0.72305705  -1.09103387]
mat_Sqrt:  [[17.61745095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380596 -0.03400424  0.7076773 ]
Stock Position:  -0.0038059567538714957
Bond Position:  [5.1667977]


portfolio before change:  [4.75396379]
curr_Stock_Price:  108.80989753802871
curr_Factors:  [108.80989754  -0.75241805  -1.0906944 ]
mat_Sqrt:  [[17.22720551  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215844 -0.00327211 -0.2340693 ]
Stock Position:  -0.002158444499163235
Bond Position:  [4.98882392]


portfolio before change:  [4.75225141]
curr_Stock_Price:  110.18113789640037
curr_Factors:  [110.1811379   -1.09433295  -1.08683777]
mat_Sqrt:  [[12.44047161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0057616   0.01835997  0.22332927]
Stock Position:  -0.005761602094392127
Bond Position:  [5.38707128]


portfolio before change:  [4.75364058]
curr_Stock_Price:  110.1738072207542
curr_Factors:  [110.17380722  -1.2142952   -1.07303112]
mat_Sqrt:  [[11.18678161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193753  0.00511204  0.05570453]
Stock Position:  -0.0019375258365726994
Bond Position:  [4.96710518]


portfolio before change:  [4.75590458]
curr_Stock_Price:  109.64629800716271
curr_Factors:  [109.64629801  -1.67596484  -1.04405933]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.75590458]
Stock Price:  109.81472974179235
PL:  [-5.05882517]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.48161775e-01 -5.78005002e-02  1.54848412e-01]
 [-1.34688452e-01  1.41315201e-01  2.16649199e-02]
 [-3.91275790e-02 -2.42077884e-01  4.25729532e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.73401021e-01 -3.14717003e-01 -2.82702079e-01]
 [ 5.82669553e-02 -8.46897484e-02 -8.22251843e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-9.89746417e-02 -4.39878870e-02 -4.40795128e-02]
 [-5.44379729e-03  1.29800687e-02 -1.02535734e-01]
 [-3.73640393e-01  3.64606162e-01  4.89075371e-02]
 [ 1.15385536e-01 -1.68822879e-01  2.14039324e-02]
 [-4.14597025e-02  3.98487933e-02  2.87003059e-02]
 [-5.07007886e-02  1.75937017e-01  5.99090290e-03]
 [-6.26379814e-02 -7.97749619e-02 -8.02173210e-04]
 [-1.45670797e-01 -1.03344600e-01  2.11448565e-01]
 [ 8.21426203e-03  1.28568510e-01  1.87450937e-01]
 [-9.86952207e-02  7.07483918e-02  5.15431218e-02]
 [-5.09316112e-02 -5.85223359e-02  2.28017496e-02]
 [-3.34341682e-02  4.78158108e-01  1.85796538e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.6314193]
curr_Stock_Price:  99.45568331166646
curr_Factors:  [99.45568331 -1.0557782  -1.03109587]
mat_Sqrt:  [[12.33990205  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01766998 -0.01827812  0.44173942]
Stock Position:  -0.017669984523807972
Bond Position:  [0.12596108]


portfolio before change:  [-1.63411563]
curr_Stock_Price:  99.61005915497135
curr_Factors:  [99.61005915 -0.74872992 -1.0002829 ]
mat_Sqrt:  [[17.32672897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00730763  0.04468779  0.06180399]
Stock Position:  -0.007307632955889771
Bond Position:  [-0.90620188]


portfolio before change:  [-1.63555012]
curr_Stock_Price:  99.77535396876569
curr_Factors:  [99.77535397 -0.8149586  -0.98233802]
mat_Sqrt:  [[16.53740159  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221848 -0.07655175  0.12144879]
Stock Position:  -0.002218476418403832
Bond Position:  [-1.41420085]


portfolio before change:  [-1.63913953]
curr_Stock_Price:  101.2339285792097
curr_Factors:  [101.23392858  -1.21670666  -0.98022487]
mat_Sqrt:  [[11.251511    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337233 -0.00455813 -0.02970002]
Stock Position:  -0.0033723254755524314
Bond Position:  [-1.29774577]


portfolio before change:  [-1.6457441]
curr_Stock_Price:  103.09617335599808
curr_Factors:  [103.09617336  -1.13566797  -0.96523495]
mat_Sqrt:  [[12.61339522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02438429 -0.09952225 -0.80647034]
Stock Position:  0.024384294426642625
Bond Position:  [-4.15967154]


portfolio before change:  [-1.66083158]
curr_Stock_Price:  102.52008795794217
curr_Factors:  [102.52008796  -0.7208973   -0.9771496 ]
mat_Sqrt:  [[18.7653459   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00209408 -0.02678125 -0.23456556]
Stock Position:  0.002094079702628933
Bond Position:  [-1.87551682]


portfolio before change:  [-1.66510767]
curr_Stock_Price:  100.70203571205185
curr_Factors:  [100.70203571  -0.86442682  -0.95227142]
mat_Sqrt:  [[16.37028455  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034613 -0.02845143  0.0120735 ]
Stock Position:  -0.000346132889056684
Bond Position:  [-1.63025138]


portfolio before change:  [-1.66582954]
curr_Stock_Price:  101.6099522901536
curr_Factors:  [101.60995229  -0.93347576  -0.95473661]
mat_Sqrt:  [[15.37786477  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00709514 -0.01391019 -0.12574658]
Stock Position:  -0.007095139578351686
Bond Position:  [-0.94489275]


portfolio before change:  [-1.67114831]
curr_Stock_Price:  102.32628967527232
curr_Factors:  [102.32628968  -1.08661111  -0.94549649]
mat_Sqrt:  [[13.41078227  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00194162  0.00410466 -0.29250591]
Stock Position:  -0.0019416221862862688
Bond Position:  [-1.47246931]


portfolio before change:  [-1.67271519]
curr_Stock_Price:  102.94366869543336
curr_Factors:  [102.9436687   -1.12253208  -0.97290711]
mat_Sqrt:  [[12.66373947  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02797302  0.11529859  0.13951959]
Stock Position:  -0.027973024376125796
Bond Position:  [1.20693057]


portfolio before change:  [-1.700158]
curr_Stock_Price:  103.93550228086542
curr_Factors:  [103.93550228  -0.88814695  -0.96719206]
mat_Sqrt:  [[16.2555035   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00709886 -0.05338648  0.06105946]
Stock Position:  0.007098863937765329
Bond Position:  [-2.43798199]


portfolio before change:  [-1.70825055]
curr_Stock_Price:  102.88139277502832
curr_Factors:  [102.88139278  -0.75914804  -0.99186461]
mat_Sqrt:  [[17.86001016  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193574  0.01260129  0.08187398]
Stock Position:  -0.0019357427762306458
Bond Position:  [-1.50909864]


portfolio before change:  [-1.71012009]
curr_Stock_Price:  103.65226791768117
curr_Factors:  [103.65226792  -0.81398555  -0.97794675]
mat_Sqrt:  [[17.27239248  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260156  0.05563617  0.01709038]
Stock Position:  -0.0026015635313822146
Bond Position:  [-1.44046213]


portfolio before change:  [-1.70590471]
curr_Stock_Price:  101.89350293527903
curr_Factors:  [101.89350294  -0.6969347   -0.96368509]
mat_Sqrt:  [[19.36192256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00334995 -0.02522706 -0.00228838]
Stock Position:  -0.0033499516775153705
Bond Position:  [-1.3645664]


portfolio before change:  [-1.70049877]
curr_Stock_Price:  100.17791752892137
curr_Factors:  [100.17791753  -0.85166453  -0.99129767]
mat_Sqrt:  [[15.86294006  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00663038 -0.03268043  0.6032039 ]
Stock Position:  -0.006630384099990278
Bond Position:  [-1.0362807]


portfolio before change:  [-1.69188165]
curr_Stock_Price:  98.83919861725437
curr_Factors:  [98.83919862 -0.77809024 -0.96641708]
mat_Sqrt:  [[17.27027752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0028834  0.04065693 0.53474535]
Stock Position:  0.002883401780546423
Bond Position:  [-1.97687477]


portfolio before change:  [-1.68930631]
curr_Stock_Price:  99.90378161174364
curr_Factors:  [99.90378161 -0.75493868 -0.97463229]
mat_Sqrt:  [[17.71898332  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00487315  0.02237261  0.14703818]
Stock Position:  -0.004873152588550817
Bond Position:  [-1.20245994]


portfolio before change:  [-1.6869553]
curr_Stock_Price:  99.35964530257664
curr_Factors:  [99.3596453  -0.60823082 -0.97820892]
mat_Sqrt:  [[20.33424291  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00235014 -0.01850639  0.06504704]
Stock Position:  -0.002350137351259935
Bond Position:  [-1.45344649]


portfolio before change:  [-1.67965704]
curr_Stock_Price:  96.09955136096622
curr_Factors:  [96.09955136 -0.75464805 -0.94680478]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.67965704]
Stock Price:  96.36169541068205
PL:  [-1.67965704]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.28628090e-01 -2.54207515e-02  6.35703185e-02]
 [ 2.33390840e-02  7.33597044e-02  1.10635289e-01]
 [-7.55092165e-03 -7.52021008e-02  3.44112182e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 4.02343600e-01 -3.37709915e-01 -3.01755337e-01]
 [-3.00044170e-02 -7.79363588e-02 -1.07719456e-01]
 [ 3.07313002e-03 -7.85048390e-02  2.28689975e-03]
 [-9.41902135e-02 -9.85634354e-02 -5.48044897e-02]
 [-6.81951919e-02  2.51956835e-02  4.21302646e-02]
 [-5.15051588e-02  7.63568745e-02 -2.27376659e-02]
 [ 2.54641095e-02 -9.68730325e-02 -1.36600999e-03]
 [ 1.17593780e-01  7.85598988e-02 -8.38016794e-02]
 [ 1.93478853e-02  1.54259126e-01  7.97394022e-02]
 [-4.00599677e-03 -7.51826648e-02 -2.42324246e-02]
 [-1.26623042e-01 -8.91904408e-02  1.87442309e-01]
 [ 9.33214831e-03  1.01755696e-01  1.61456310e-01]
 [-6.08492172e-02  1.22079783e-01  3.17893463e-02]
 [ 1.04938325e-01  5.12347445e-02  1.79731405e-01]
 [-2.86672203e-02  5.22887137e-01  1.91825934e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.16204685]
curr_Stock_Price:  100.95920050230036
curr_Factors:  [100.9592005   -1.13888248  -1.00762369]
mat_Sqrt:  [[11.80130732  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01832917 -0.00803875  0.18134842]
Stock Position:  -0.01832917387455583
Bond Position:  [11.0125456]


portfolio before change:  [9.16536048]
curr_Stock_Price:  100.92864022704572
curr_Factors:  [100.92864023  -1.48263098  -0.97858856]
mat_Sqrt:  [[ 8.61232398  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00555211 0.02319838 0.31561168]
Stock Position:  0.005552108491947695
Bond Position:  [8.60499372]


portfolio before change:  [9.17252072]
curr_Stock_Price:  101.83077001328107
curr_Factors:  [101.83077001  -1.36054275  -0.94081731]
mat_Sqrt:  [[10.19555928  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024211 -0.02378099  0.09816563]
Stock Position:  -0.00024211237294325758
Bond Position:  [9.19717521]


portfolio before change:  [9.17449327]
curr_Stock_Price:  103.1815224602543
curr_Factors:  [103.18152246  -1.39423981  -0.95335016]
mat_Sqrt:  [[ 9.86407951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00384666 -0.00455813 -0.02970002]
Stock Position:  -0.003846659708076097
Bond Position:  [9.57139747]


portfolio before change:  [9.17671613]
curr_Stock_Price:  103.22579138848913
curr_Factors:  [103.22579139  -1.30881826  -0.91458798]
mat_Sqrt:  [[11.173138    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02971667 -0.10679325 -0.86082398]
Stock Position:  0.029716666591625227
Bond Position:  [6.1091897]


portfolio before change:  [9.17516512]
curr_Stock_Price:  103.12219660681062
curr_Factors:  [103.12219661  -1.20664398  -0.94405796]
mat_Sqrt:  [[12.00367336  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00449903 -0.02464564 -0.30729363]
Stock Position:  -0.0044990283806617525
Bond Position:  [9.63911481]


portfolio before change:  [9.17789862]
curr_Stock_Price:  103.05031052209819
curr_Factors:  [103.05031052  -0.74934887  -0.92284365]
mat_Sqrt:  [[19.3564325   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.81629180e-05 -2.48254099e-02  6.52388843e-03]
Stock Position:  7.816291803810956e-05
Bond Position:  [9.16984391]


portfolio before change:  [9.18017393]
curr_Stock_Price:  102.82716526849124
curr_Factors:  [102.82716527  -0.48971576  -0.94324283]
mat_Sqrt:  [[24.53476231  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00439874 -0.03116849 -0.15634195]
Stock Position:  -0.004398739581212594
Bond Position:  [9.63248385]


portfolio before change:  [9.19924995]
curr_Stock_Price:  99.03798878428903
curr_Factors:  [99.03798878 -0.16399332 -0.95513013]
mat_Sqrt:  [[32.34243218  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182252  0.00796757  0.12018592]
Stock Position:  -0.0018225233526133144
Bond Position:  [9.379749]


portfolio before change:  [9.20023406]
curr_Stock_Price:  99.7848217025746
curr_Factors:  [ 9.97848217e+01  4.85474254e-02 -1.00678552e+00]
mat_Sqrt:  [[38.27427458  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00141544  0.02414616 -0.06486423]
Stock Position:  -0.0014154400043951648
Bond Position:  [9.34147349]


portfolio before change:  [9.20594579]
curr_Stock_Price:  97.39964697493221
curr_Factors:  [ 9.73996470e+01 -4.14673927e-02 -1.00268318e+00]
mat_Sqrt:  [[34.28376815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00066165 -0.03063394 -0.00389685]
Stock Position:  0.0006616548922070781
Bond Position:  [9.14150084]


portfolio before change:  [9.20739383]
curr_Stock_Price:  96.1336880068174
curr_Factors:  [ 9.61336880e+01 -9.15901654e-02 -1.01087183e+00]
mat_Sqrt:  [[31.92143763  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00321152  0.02484282 -0.23906287]
Stock Position:  0.0032115170664343434
Bond Position:  [8.89865885]


portfolio before change:  [9.20998199]
curr_Stock_Price:  96.24678678509368
curr_Factors:  [96.24678679 -0.28633238 -1.03932226]
mat_Sqrt:  [[25.56593879  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00154923 0.04878102 0.22747432]
Stock Position:  0.0015492322217121421
Bond Position:  [9.06087336]


portfolio before change:  [9.21254659]
curr_Stock_Price:  96.43985116513383
curr_Factors:  [96.43985117 -0.13648572 -1.05769935]
mat_Sqrt:  [[29.21652414  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037286 -0.02377485 -0.06912836]
Stock Position:  -0.00037285844610694533
Bond Position:  [9.248505]


portfolio before change:  [9.21490737]
curr_Stock_Price:  96.3101454578868
curr_Factors:  [96.31014546 -0.13719172 -1.10384391]
mat_Sqrt:  [[27.84178716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325642 -0.02820449  0.53472073]
Stock Position:  -0.003256415532049409
Bond Position:  [9.52853322]


portfolio before change:  [9.22072803]
curr_Stock_Price:  95.25431080142705
curr_Factors:  [95.2543108   0.17489236 -1.13321581]
mat_Sqrt:  [[36.5333967   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00122947 0.03217798 0.46058991]
Stock Position:  0.0012294668565778015
Bond Position:  [9.10361602]


portfolio before change:  [9.22043064]
curr_Stock_Price:  93.16105942909019
curr_Factors:  [93.16105943  0.35483698 -1.12669773]
mat_Sqrt:  [[43.05459962  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118938  0.03860502  0.09068616]
Stock Position:  -0.0011893771640014155
Bond Position:  [9.33123428]


portfolio before change:  [9.22486159]
curr_Stock_Price:  91.39723876532965
curr_Factors:  [ 9.13972388e+01  8.97383780e-02 -1.18300308e+00]
mat_Sqrt:  [[30.629101    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00466709 0.01620185 0.51272367]
Stock Position:  0.004667088320394535
Bond Position:  [8.7983026]


portfolio before change:  [9.2306084]
curr_Stock_Price:  92.15723419536687
curr_Factors:  [92.1572342   0.20851108 -1.17491495]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.2306084]
Stock Price:  93.07032225326974
PL:  [9.2306084]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.06844029e-01 -2.33005052e-02  5.34382216e-02]
 [-1.09555297e-01  1.37657796e-01  6.71820396e-02]
 [-7.53150075e-02 -2.87513503e-01  4.11636703e-03]
 [-2.22821276e-02  1.77253963e-02  1.02549534e-02]
 [ 5.09531421e-01 -3.17232970e-01 -1.65404478e-01]
 [-1.22257104e-01  7.65345301e-02  3.14622529e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 2.09240534e-01  4.06030671e-03  6.80178550e-03]
 [-1.50965992e-01  1.11146713e-02  1.74894584e-01]
 [-3.18433436e-02  6.25340845e-02 -3.21211684e-02]
 [-2.84346974e-02 -6.43254627e-02 -3.52104543e-03]
 [ 1.22051464e-01  7.75347786e-02 -8.75100737e-02]
 [ 3.76040896e-02  1.40596322e-01  9.58521944e-02]
 [ 7.56440598e-02 -1.11559662e-01  6.17910455e-02]
 [-1.09279079e-01 -7.63023489e-02  1.65583374e-01]
 [-1.11540083e-02  1.62449186e-01  2.32541087e-01]
 [-3.80947249e-02  1.06632273e-01  1.61218163e-02]
 [-2.93747234e-02 -2.94893620e-02  4.25404379e-02]
 [-2.89027451e-02  5.15005772e-01  2.25590732e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.39851344]
curr_Stock_Price:  101.13143884940092
curr_Factors:  [101.13143885  -0.96805772  -0.95758516]
mat_Sqrt:  [[14.74314404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01333078 -0.00736827  0.15244437]
Stock Position:  -0.013330780283658293
Bond Position:  [11.74667443]


portfolio before change:  [10.42342099]
curr_Stock_Price:  99.48333460259276
curr_Factors:  [99.4833346  -0.95086958 -0.99069726]
mat_Sqrt:  [[14.2737659   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00646553  0.04353122  0.19165166]
Stock Position:  -0.006465533492817651
Bond Position:  [11.06663383]


portfolio before change:  [10.42873314]
curr_Stock_Price:  99.08968765155115
curr_Factors:  [99.08968765 -0.70928426 -0.95815615]
mat_Sqrt:  [[18.70114902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00437932 -0.09091975  0.01174285]
Stock Position:  -0.004379320445617082
Bond Position:  [10.86267863]


portfolio before change:  [10.43291764]
curr_Stock_Price:  98.75436356233251
curr_Factors:  [98.75436356 -0.74651738 -0.91000492]
mat_Sqrt:  [[18.84246849  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00104717  0.00560526  0.02925453]
Stock Position:  -0.0010471651463113962
Bond Position:  [10.53632976]


portfolio before change:  [10.43612909]
curr_Stock_Price:  98.20331227513776
curr_Factors:  [98.20331228 -0.98112191 -0.87059386]
mat_Sqrt:  [[15.41473959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03033314 -0.10031787 -0.47185294]
Stock Position:  0.030333139967592848
Bond Position:  [7.45731427]


portfolio before change:  [10.41755984]
curr_Stock_Price:  97.52966595755272
curr_Factors:  [97.52966596 -0.84620262 -0.86908728]
mat_Sqrt:  [[17.54671397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0064889   0.02420234  0.08975305]
Stock Position:  -0.0064888950370564965
Bond Position:  [11.05041961]


portfolio before change:  [10.42178501]
curr_Stock_Price:  97.30432414981549
curr_Factors:  [97.30432415 -0.87976441 -0.90443657]
mat_Sqrt:  [[16.34043064  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034677 -0.02845143  0.0120735 ]
Stock Position:  -0.0003467652726412999
Bond Position:  [10.45552677]


portfolio before change:  [10.4239714]
curr_Stock_Price:  98.53808050509036
curr_Factors:  [98.53808051 -1.01047413 -0.90768935]
mat_Sqrt:  [[14.47292401  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01456055 0.00128398 0.0194036 ]
Stock Position:  0.014560553169163593
Bond Position:  [8.98920244]


portfolio before change:  [10.41545503]
curr_Stock_Price:  97.79882643711109
curr_Factors:  [97.79882644 -0.9403114  -0.86451472]
mat_Sqrt:  [[16.08820603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00714678  0.00351477  0.49892557]
Stock Position:  -0.007146775991639584
Bond Position:  [11.11440134]


portfolio before change:  [10.42724224]
curr_Stock_Price:  96.53836152729372
curr_Factors:  [96.53836153 -0.90053618 -0.8671197 ]
mat_Sqrt:  [[16.48225872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223182  0.01977501 -0.09163275]
Stock Position:  -0.0022318195058130333
Bond Position:  [10.64269844]


portfolio before change:  [10.4329865]
curr_Stock_Price:  95.15686287334783
curr_Factors:  [95.15686287 -0.5128165  -0.84676134]
mat_Sqrt:  [[24.43334693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126116 -0.0203415  -0.01004456]
Stock Position:  -0.0012611577184720045
Bond Position:  [10.55299431]


portfolio before change:  [10.43509676]
curr_Stock_Price:  95.57577861787877
curr_Factors:  [95.57577862 -0.84067302 -0.87576962]
mat_Sqrt:  [[17.17537697  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00618272  0.02451865 -0.24964188]
Stock Position:  0.0061827163731408815
Bond Position:  [9.84417883]


portfolio before change:  [10.43731867]
curr_Stock_Price:  95.53705143700202
curr_Factors:  [95.53705144 -0.703779   -0.92137383]
mat_Sqrt:  [[18.80948585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00323241 0.04446046 0.27343963]
Stock Position:  0.003232412558069989
Bond Position:  [10.12850351]


portfolio before change:  [10.44118432]
curr_Stock_Price:  95.94949875249313
curr_Factors:  [95.94949875 -0.57579968 -0.87497611]
mat_Sqrt:  [[22.48944756  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0037963  -0.03527826  0.17627265]
Stock Position:  0.0037962980576198256
Bond Position:  [10.07693142]


portfolio before change:  [10.44426725]
curr_Stock_Price:  96.09790134225891
curr_Factors:  [96.09790134 -0.44164558 -0.88365786]
mat_Sqrt:  [[25.5353569   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303304 -0.02412892  0.47236328]
Stock Position:  -0.0030330350410399205
Bond Position:  [10.73573555]


portfolio before change:  [10.44187944]
curr_Stock_Price:  97.77017799687732
curr_Factors:  [97.770178   -0.73402817 -0.87464416]
mat_Sqrt:  [[19.56901152  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00206999 0.05137094 0.66337499]
Stock Position:  0.0020699902096614283
Bond Position:  [10.23949613]


portfolio before change:  [10.44444149]
curr_Stock_Price:  97.77107376809826
curr_Factors:  [97.77107377 -0.90184874 -0.83234634]
mat_Sqrt:  [[17.26072494  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185685  0.03372009  0.04599105]
Stock Position:  -0.0018568536151214502
Bond Position:  [10.62598806]


portfolio before change:  [10.44722592]
curr_Stock_Price:  97.70235630904658
curr_Factors:  [97.70235631 -0.60174271 -0.81953654]
mat_Sqrt:  [[23.58583747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090955 -0.00932536  0.12135603]
Stock Position:  -0.0009095545152657771
Bond Position:  [10.53609154]


portfolio before change:  [10.45047565]
curr_Stock_Price:  97.02578572012771
curr_Factors:  [97.02578572 -0.65807931 -0.7834811 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.45047565]
Stock Price:  97.10416713679429
PL:  [10.45047565]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.68033342e-01 -3.53180441e-02  9.82458636e-02]
 [-3.31109435e-01  2.59798565e-01  6.03057140e-02]
 [-5.17287000e-02 -2.29994051e-01  3.01689102e-02]
 [-2.64521646e-02  2.68499612e-04 -1.18284469e-03]
 [ 3.41328051e-01 -2.28270780e-01 -1.47724742e-01]
 [ 8.22502948e-02  2.98490913e-03 -1.79847176e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 1.70489203e-01 -1.92718837e-03  1.23602787e-03]
 [-1.05470459e-01  1.89061202e-02  1.01657424e-01]
 [-4.61079594e-03  4.49946458e-02 -4.18664640e-02]
 [ 2.82041114e-02 -9.86778443e-02  8.65955667e-06]
 [ 7.52478217e-02  1.02160981e-01  3.42867572e-03]
 [ 2.93076943e-03  1.75573826e-01  6.87511541e-02]
 [ 7.69178105e-02 -7.48323898e-02  8.26415332e-02]
 [-8.83093588e-02 -4.41592608e-02 -9.16963645e-02]
 [-1.85126670e-02  2.09848704e-01  4.30411450e-01]
 [ 5.49719235e-02 -1.67378351e-01 -9.75019375e-02]
 [ 2.49990191e-01  7.02098708e-02  2.76051283e-01]
 [-4.19683051e-02  4.22185108e-01  7.07999513e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.07883666]
curr_Stock_Price:  99.69391996392693
curr_Factors:  [99.69391996 -0.73231919 -0.96814173]
mat_Sqrt:  [[18.204044    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01367229 -0.01116855  0.2802681 ]
Stock Position:  -0.013672286087026335
Bond Position:  [1.44188046]


portfolio before change:  [0.09589108]
curr_Stock_Price:  98.47291731992377
curr_Factors:  [98.47291732 -0.84243409 -0.95806566]
mat_Sqrt:  [[16.26933106  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01918282  0.08215552  0.17203542]
Stock Position:  -0.019182817741427195
Bond Position:  [1.9848791]


portfolio before change:  [0.07830388]
curr_Stock_Price:  99.4156085859913
curr_Factors:  [99.41560859 -0.61691064 -0.94204418]
mat_Sqrt:  [[20.91265133  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00246305 -0.0727305   0.0860635 ]
Stock Position:  -0.0024630505743710967
Bond Position:  [0.32316955]


portfolio before change:  [0.07923939]
curr_Stock_Price:  99.06859741071683
curr_Factors:  [99.06859741 -1.01774842 -0.91402586]
mat_Sqrt:  [[14.35413757  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.85916284e-03  8.49070325e-05 -3.37432667e-03]
Stock Position:  -0.00185916283794452
Bond Position:  [0.26342405]


portfolio before change:  [0.08101333]
curr_Stock_Price:  98.1498643868982
curr_Factors:  [98.14986439 -0.77665578 -0.89254417]
mat_Sqrt:  [[18.49121187  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01650946 -0.07218556 -0.42141757]
Stock Position:  0.016509460845266673
Bond Position:  [-1.53938801]


portfolio before change:  [0.11715254]
curr_Stock_Price:  100.36217803499272
curr_Factors:  [100.36217803  -0.73159374  -0.90376151]
mat_Sqrt:  [[19.55889515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00402151  0.00094391 -0.05130539]
Stock Position:  0.004021507815401084
Bond Position:  [-0.28645474]


portfolio before change:  [0.1112628]
curr_Stock_Price:  98.91542717234782
curr_Factors:  [98.91542717 -0.76474129 -0.93289548]
mat_Sqrt:  [[18.11297333  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00031283 -0.02845143  0.0120735 ]
Stock Position:  -0.0003128306867656916
Bond Position:  [0.14220658]


portfolio before change:  [0.11144175]
curr_Stock_Price:  98.4570288045316
curr_Factors:  [98.4570288  -0.77078179 -0.90581838]
mat_Sqrt:  [[18.41232044  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00927052 -0.00060943  0.00352604]
Stock Position:  0.009270517890212744
Bond Position:  [-0.80130589]


portfolio before change:  [0.11133594]
curr_Stock_Price:  98.46722684436489
curr_Factors:  [98.46722684 -0.63080247 -0.94663407]
mat_Sqrt:  [[20.333855    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00414243  0.00597864  0.29000033]
Stock Position:  -0.004142429974367247
Bond Position:  [0.51922954]


portfolio before change:  [0.11861149]
curr_Stock_Price:  96.74221888532409
curr_Factors:  [96.74221889 -0.50723824 -1.01451012]
mat_Sqrt:  [[21.12171256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0005679   0.01422856 -0.11943337]
Stock Position:  -0.0005678988072084566
Bond Position:  [0.17355128]


portfolio before change:  [0.1180144]
curr_Stock_Price:  97.87004119507027
curr_Factors:  [97.8700412  -0.2886661  -1.01934439]
mat_Sqrt:  [[26.45988982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.69695196e-04 -3.12046742e-02  2.47033048e-05]
Stock Position:  0.0009696951958081058
Bond Position:  [0.02311029]


portfolio before change:  [0.11918295]
curr_Stock_Price:  99.06915618671871
curr_Factors:  [99.06915619 -0.1827176  -1.03484643]
mat_Sqrt:  [[29.31953834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00268031 0.03230614 0.00978106]
Stock Position:  0.0026803110429846205
Bond Position:  [-0.1463532]


portfolio before change:  [0.11365126]
curr_Stock_Price:  97.01898579715491
curr_Factors:  [97.0189858   0.27952218 -1.02098312]
mat_Sqrt:  [[46.22153194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0004651  0.05552132 0.19612791]
Stock Position:  0.00046510437390287593
Bond Position:  [0.06852731]


portfolio before change:  [0.11199205]
curr_Stock_Price:  93.41473478189317
curr_Factors:  [93.41473478  0.35434495 -1.00072252]
mat_Sqrt:  [[48.94374206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00187674 -0.02366408  0.23575329]
Stock Position:  0.0018767420500429529
Bond Position:  [-0.06332332]


portfolio before change:  [0.10307715]
curr_Stock_Price:  88.67297184848833
curr_Factors:  [ 8.86729718e+01 -4.84372761e-02 -9.78082969e-01]
mat_Sqrt:  [[31.7672182   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00340499 -0.01396438 -0.2615842 ]
Stock Position:  -0.003404987725458894
Bond Position:  [0.40500753]


portfolio before change:  [0.09933]
curr_Stock_Price:  89.80319851749258
curr_Factors:  [89.80319852 -0.12243533 -0.92901929]
mat_Sqrt:  [[31.37985017  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00238252 0.06635999 1.22784406]
Stock Position:  0.0023825152816814455
Bond Position:  [-0.11462749]


portfolio before change:  [0.09349818]
curr_Stock_Price:  87.3674682470352
curr_Factors:  [87.36746825 -0.23859979 -0.94920442]
mat_Sqrt:  [[26.63746785  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011543  -0.05292968 -0.27814589]
Stock Position:  0.0011543039144592622
Bond Position:  [-0.00735043]


portfolio before change:  [0.09180646]
curr_Stock_Price:  85.90348297906043
curr_Factors:  [85.90348298 -0.47416645 -0.94096118]
mat_Sqrt:  [[20.86549292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01476849 0.02220231 0.78749747]
Stock Position:  0.014768485708823418
Bond Position:  [-1.1768579]


portfolio before change:  [0.10522456]
curr_Stock_Price:  86.83197027554154
curr_Factors:  [86.83197028 -0.2781046  -0.93285563]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.10522456]
Stock Price:  88.5958543262846
PL:  [0.10522456]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.55125885e-01 -4.97886834e-02  1.34653838e-01]
 [-1.87535237e-01  1.84278966e-01  8.06923934e-02]
 [-1.18752462e-01 -4.72298095e-01 -1.40208017e-02]
 [-3.21716657e-02 -9.06822429e-03 -7.05115324e-03]
 [ 3.21456381e-01 -2.21405745e-01 -1.44729557e-01]
 [-7.51916893e-02  6.48433346e-02  2.64609831e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 2.32837850e-01  1.00700344e-02 -7.51350910e-04]
 [-1.62968569e-01  6.94046773e-03  2.04961879e-01]
 [-1.46905646e-01  1.31309136e-01 -1.63125689e-02]
 [ 3.51120543e-02 -1.03227310e-01  3.46870817e-03]
 [ 4.17352935e-02  9.13560249e-02  3.65731161e-02]
 [-1.57655888e-02  1.72825859e-01  4.57576340e-02]
 [-4.55623116e-02 -7.88193371e-02 -5.35905347e-02]
 [-1.53042492e-01 -1.08822419e-01  2.20739256e-01]
 [ 1.10381775e-02  7.70203895e-02  8.13536698e-02]
 [-1.29165096e-01  1.61275543e-02  8.15521600e-02]
 [-4.65168194e-02 -4.45930801e-02  2.18016893e-02]
 [-3.13046208e-02  4.86841820e-01  2.29118632e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.01690998]
curr_Stock_Price:  99.54128374035047
curr_Factors:  [99.54128374 -0.93682282 -1.01358755]
mat_Sqrt:  [[14.1563333   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01617123 -0.01574456  0.38412992]
Stock Position:  -0.016171230128235823
Bond Position:  [0.59279503]


portfolio before change:  [-1.00867201]
curr_Stock_Price:  99.04102821180587
curr_Factors:  [99.04102821 -1.00105639 -1.03325125]
mat_Sqrt:  [[12.95169353  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01284048  0.05827413  0.23019294]
Stock Position:  -0.01284047589466693
Bond Position:  [0.26306192]


portfolio before change:  [-1.00725918]
curr_Stock_Price:  98.93612084381095
curr_Factors:  [98.93612084 -1.16031936 -1.04383627]
mat_Sqrt:  [[10.9169734   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01225698 -0.14935377 -0.03999744]
Stock Position:  -0.012256980535400317
Bond Position:  [0.20539893]


portfolio before change:  [-1.0112927]
curr_Stock_Price:  99.26938986297145
curr_Factors:  [99.26938986 -1.11731555 -1.00542065]
mat_Sqrt:  [[11.88290802  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00284822 -0.00286762 -0.02011498]
Stock Position:  -0.0028482183653580646
Bond Position:  [-0.7285518]


portfolio before change:  [-1.0099402]
curr_Stock_Price:  98.73057843531859
curr_Factors:  [98.73057844 -0.74911221 -0.98759016]
mat_Sqrt:  [[17.38647045  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0164609  -0.07001464 -0.41287314]
Stock Position:  0.016460897723634328
Bond Position:  [-2.63513416]


portfolio before change:  [-0.99785752]
curr_Stock_Price:  99.50462779201689
curr_Factors:  [99.50462779 -0.46361241 -0.98682304]
mat_Sqrt:  [[23.33066762  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0029196   0.02050526  0.07548582]
Stock Position:  -0.002919595664727741
Bond Position:  [-0.70734424]


portfolio before change:  [-0.99451423]
curr_Stock_Price:  98.29892818969759
curr_Factors:  [98.29892819 -0.54912565 -1.03022411]
mat_Sqrt:  [[20.26030124  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027967 -0.02845143  0.0120735 ]
Stock Position:  -0.00027967471063307484
Bond Position:  [-0.9670225]


portfolio before change:  [-0.99455179]
curr_Stock_Price:  97.56869851867064
curr_Factors:  [97.56869852 -0.58925286 -1.01839759]
mat_Sqrt:  [[19.54865108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01191614  0.00318442 -0.0021434 ]
Stock Position:  0.01191614129768721
Bond Position:  [-2.15719418]


portfolio before change:  [-1.00009873]
curr_Stock_Price:  97.14846365200955
curr_Factors:  [97.14846365 -0.26429229 -1.00737727]
mat_Sqrt:  [[27.23684907  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00444074  0.00219477  0.58469919]
Stock Position:  -0.0044407375427661265
Bond Position:  [-0.5686879]


portfolio before change:  [-1.01126091]
curr_Stock_Price:  99.63003219348762
curr_Factors:  [99.63003219 -0.49548134 -1.08434262]
mat_Sqrt:  [[20.5249186   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00715448  0.04152359 -0.04653522]
Stock Position:  -0.007154476498302781
Bond Position:  [-0.29846019]


portfolio before change:  [-1.00714256]
curr_Stock_Price:  99.0439689452233
curr_Factors:  [99.04396895 -0.90060108 -1.08115037]
mat_Sqrt:  [[13.65099531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00242874 -0.03264334  0.00989526]
Stock Position:  0.002428744787936343
Bond Position:  [-1.24769509]


portfolio before change:  [-1.00483666]
curr_Stock_Price:  100.12183746163399
curr_Factors:  [100.12183746  -0.89472537  -1.07414758]
mat_Sqrt:  [[13.97842208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00368851 0.02888931 0.10433292]
Stock Position:  0.0036885101728352456
Bond Position:  [-1.37413707]


portfolio before change:  [-1.00630071]
curr_Stock_Price:  99.81806320368763
curr_Factors:  [99.8180632  -0.55646209 -1.10932705]
mat_Sqrt:  [[18.86974831  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.04029284e-04  5.46523352e-02  1.30533793e-01]
Stock Position:  -0.00010402928364945816
Bond Position:  [-0.99591671]


portfolio before change:  [-1.00649887]
curr_Stock_Price:  99.32924187654969
curr_Factors:  [99.32924188 -0.50272946 -1.10778814]
mat_Sqrt:  [[19.8444109   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00294977 -0.02492486 -0.15287888]
Stock Position:  -0.0029497746498563905
Bond Position:  [-0.71349999]


portfolio before change:  [-1.00791593]
curr_Stock_Price:  99.74916126252522
curr_Factors:  [99.74916126 -0.44040452 -1.05906279]
mat_Sqrt:  [[22.26890558  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00497528 -0.03441267  0.62970766]
Stock Position:  -0.004975281012413607
Bond Position:  [-0.51163582]


portfolio before change:  [-1.01567544]
curr_Stock_Price:  101.28306072040633
curr_Factors:  [101.28306072  -0.4263708   -1.05373395]
mat_Sqrt:  [[23.05342663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00128541 0.02435599 0.23207938]
Stock Position:  0.0012854090734959079
Bond Position:  [-1.1458656]


portfolio before change:  [-1.01406283]
curr_Stock_Price:  102.76049463890348
curr_Factors:  [102.76049464  -0.94248416  -1.07179694]
mat_Sqrt:  [[13.70992305  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0081767   0.00509998  0.23264561]
Stock Position:  -0.008176699372304043
Bond Position:  [-0.17382116]


portfolio before change:  [-1.00490962]
curr_Stock_Price:  101.6357534619115
curr_Factors:  [101.63575346  -1.06873849  -1.06838643]
mat_Sqrt:  [[11.9923681   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00360379 -0.01410157  0.06219415]
Stock Position:  -0.003603788362608208
Bond Position:  [-0.63863588]


portfolio before change:  [-1.00466028]
curr_Stock_Price:  101.5222551889911
curr_Factors:  [101.52225519  -1.16870372  -1.07389196]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.00466028]
Stock Price:  101.91298316811137
PL:  [-2.91764345]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.72473523e-01 -2.96882350e-02  8.39634940e-02]
 [-6.92760271e-02  1.22074976e-01  9.74844955e-02]
 [-7.62019810e-02 -3.69928164e-01  9.93348522e-03]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 4.76265213e-01 -3.08493856e-01 -1.65276328e-01]
 [-3.49379276e-02  5.50789578e-02  1.80194144e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-7.05389640e-02 -4.06749989e-02 -3.43636247e-02]
 [-8.95715970e-02  2.29392116e-02  6.94181431e-02]
 [-1.66774536e-01  1.49051837e-01 -1.39184759e-02]
 [ 7.60334744e-02 -1.27264651e-01  1.15236608e-03]
 [ 2.21678856e-02  8.34941544e-02  4.77864639e-02]
 [-3.88740343e-02  1.78632677e-01  2.09072075e-02]
 [-5.47553498e-02 -1.04618037e-01 -2.22883638e-02]
 [-1.49331718e-01 -1.06064987e-01  2.16062496e-01]
 [-5.60822655e-03  1.34850951e-01  1.91393409e-01]
 [-1.99273592e-02  7.08155367e-02  5.60311009e-03]
 [ 7.73670423e-02  4.87720596e-02  1.64068188e-01]
 [-3.53122924e-02  4.65466552e-01  1.59569703e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.2642534]
curr_Stock_Price:  100.4162424402875
curr_Factors:  [100.41624244  -1.14239398  -1.02711038]
mat_Sqrt:  [[11.47097124  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02232602 -0.00938824  0.23952448]
Stock Position:  -0.022326016544146586
Bond Position:  [7.50614809]


portfolio before change:  [5.27908201]
curr_Stock_Price:  99.83611936319471
curr_Factors:  [99.83611936 -1.22752619 -1.00911321]
mat_Sqrt:  [[10.6641819   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00433462  0.0386035   0.27809613]
Stock Position:  -0.0043346152484450805
Bond Position:  [5.71183317]


portfolio before change:  [5.28247713]
curr_Stock_Price:  99.38233478750848
curr_Factors:  [99.38233479 -1.10198881 -1.00407766]
mat_Sqrt:  [[12.09640031  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00692155 -0.11698156  0.02833747]
Stock Position:  -0.006921548459206761
Bond Position:  [5.97035677]


portfolio before change:  [5.27666568]
curr_Stock_Price:  100.43762219154489
curr_Factors:  [100.43762219  -1.2352441   -0.98078889]
mat_Sqrt:  [[10.95180041  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00346461 -0.00455813 -0.02970002]
Stock Position:  -0.0034646136511019836
Bond Position:  [5.62464324]


portfolio before change:  [5.28174213]
curr_Stock_Price:  99.37830715206594
curr_Factors:  [99.37830715 -0.84108398 -0.98704797]
mat_Sqrt:  [[15.97143642  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02720876 -0.09755432 -0.47148736]
Stock Position:  0.0272087641822917
Bond Position:  [2.57778121]


portfolio before change:  [5.28436877]
curr_Stock_Price:  99.45115545058097
curr_Factors:  [99.45115545 -0.88190673 -0.98759373]
mat_Sqrt:  [[15.33543498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00194566  0.0174175   0.05140437]
Stock Position:  -0.0019456635895827243
Bond Position:  [5.47786726]


portfolio before change:  [5.2842763]
curr_Stock_Price:  100.20262362052074
curr_Factors:  [100.20262362  -0.64046501  -1.03691343]
mat_Sqrt:  [[18.72418376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030262 -0.02845143  0.0120735 ]
Stock Position:  -0.00030261900644699784
Bond Position:  [5.31459952]


portfolio before change:  [5.28548858]
curr_Stock_Price:  100.587713812323
curr_Factors:  [100.58771381  -0.47613406  -1.09142762]
mat_Sqrt:  [[20.97787772  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00374698 -0.01286256 -0.09802986]
Stock Position:  -0.0037469773892895076
Bond Position:  [5.66238847]


portfolio before change:  [5.2927863]
curr_Stock_Price:  99.01793010685427
curr_Factors:  [99.01793011 -0.84434594 -1.0868553 ]
mat_Sqrt:  [[14.3550201   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00521137  0.00725402  0.19803064]
Stock Position:  -0.00521137479703399
Bond Position:  [5.80880585]


portfolio before change:  [5.29196228]
curr_Stock_Price:  99.45474547905606
curr_Factors:  [99.45474548 -0.69337134 -1.11067042]
mat_Sqrt:  [[16.37344734  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01012414  0.04713433 -0.03970554]
Stock Position:  -0.010124143547525114
Bond Position:  [6.2988564]


portfolio before change:  [5.28160444]
curr_Stock_Price:  100.63338803986221
curr_Factors:  [100.63338804  -0.85701695  -1.13353623]
mat_Sqrt:  [[13.74851623  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00530841 -0.04024462  0.00328738]
Stock Position:  0.005308408535889451
Bond Position:  [4.74740131]


portfolio before change:  [5.2841828]
curr_Stock_Price:  100.89549201527709
curr_Factors:  [100.89549202  -0.48707333  -1.11527919]
mat_Sqrt:  [[20.32258297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00167686 0.02640317 0.13632148]
Stock Position:  0.0016768570473196767
Bond Position:  [5.11499548]


portfolio before change:  [5.28674414]
curr_Stock_Price:  101.66027951961314
curr_Factors:  [101.66027952  -0.46389197  -1.12129718]
mat_Sqrt:  [[20.8311094   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00143987  0.05648861  0.05964244]
Stock Position:  -0.0014398701467561125
Bond Position:  [5.43312175]


portfolio before change:  [5.28916858]
curr_Stock_Price:  100.91994494212406
curr_Factors:  [100.91994494  -0.59697051  -1.09337188]
mat_Sqrt:  [[18.61532529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00333092 -0.03308313 -0.0635825 ]
Stock Position:  -0.003330920523001734
Bond Position:  [5.6253249]


portfolio before change:  [5.29471079]
curr_Stock_Price:  99.67833444991628
curr_Factors:  [99.67833445 -0.514688   -1.02396427]
mat_Sqrt:  [[21.39797047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00504565 -0.03354069  0.61636616]
Stock Position:  -0.005045652930389024
Bond Position:  [5.79765307]


portfolio before change:  [5.30765887]
curr_Stock_Price:  97.39944619392436
curr_Factors:  [97.39944619 -0.57097238 -1.01093765]
mat_Sqrt:  [[20.02357824  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00184491 0.04264362 0.54599212]
Stock Position:  0.0018449063214153018
Bond Position:  [5.12796601]


portfolio before change:  [5.30433257]
curr_Stock_Price:  94.9015170227797
curr_Factors:  [94.90151702 -0.51344752 -0.97409582]
mat_Sqrt:  [[21.44081507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079079  0.02239384  0.01598411]
Stock Position:  -0.0007907898932045972
Bond Position:  [5.37937973]


portfolio before change:  [5.30721386]
curr_Stock_Price:  92.95881034126099
curr_Factors:  [92.95881034 -0.28367124 -0.98433394]
mat_Sqrt:  [[26.15790177  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00428615 0.01542308 0.46804087]
Stock Position:  0.004286146917291068
Bond Position:  [4.90877874]


portfolio before change:  [5.31329797]
curr_Stock_Price:  94.0919417251337
curr_Factors:  [94.09194173 -0.60392796 -1.0139042 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.31329797]
Stock Price:  92.96690117417242
PL:  [5.31329797]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.63080520e-01 -6.48025494e-02  1.56490170e-01]
 [-3.79971748e-01  2.80656790e-01  3.21217187e-02]
 [-1.52046481e-01 -4.80812042e-01 -5.25426633e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 7.53071952e-01 -4.56414201e-01 -1.97466363e-01]
 [-2.08671790e-02  5.18074294e-02  1.25568656e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 2.98942028e-01  1.96539979e-02  1.16587753e-02]
 [-1.70003116e-01  6.33809853e-03  2.13230724e-01]
 [-8.17360789e-02  5.96108042e-02 -5.31740868e-02]
 [-3.03748321e-02 -6.39871723e-02  1.12174314e-03]
 [ 9.72184242e-02  1.09890285e-01 -2.06601833e-02]
 [ 2.89891129e-02  1.39410235e-01  8.52882328e-02]
 [ 4.07904915e-02 -1.32833605e-01  4.73487591e-03]
 [-7.73649603e-02 -6.81543616e-02  1.31563986e-01]
 [-3.80516378e-03  1.60732508e-01  3.10275185e-01]
 [ 1.43752120e-02 -3.86571335e-02 -4.59180224e-02]
 [ 8.20680721e-02  4.98556300e-02  1.68273261e-01]
 [-3.74149107e-02  4.50115507e-01  1.31101838e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.0053807]
curr_Stock_Price:  99.1249932700948
curr_Factors:  [99.12499327 -0.93553642 -0.99623119]
mat_Sqrt:  [[14.3624046   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00924708 -0.02049237  0.4464229 ]
Stock Position:  -0.009247079161037938
Bond Position:  [-3.08876404]


portfolio before change:  [-3.99869137]
curr_Stock_Price:  98.31807728430724
curr_Factors:  [98.31807728 -0.72410449 -0.97409636]
mat_Sqrt:  [[17.99343679  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02035011  0.08875147  0.09163432]
Stock Position:  -0.020350109162312363
Bond Position:  [-1.99790777]


portfolio before change:  [-3.99977815]
curr_Stock_Price:  98.34693412034419
curr_Factors:  [98.34693412 -0.90019021 -0.94913059]
mat_Sqrt:  [[15.47429992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01132111 -0.15204612 -0.14988959]
Stock Position:  -0.011321107987030014
Bond Position:  [-2.88638189]


portfolio before change:  [-4.01480123]
curr_Stock_Price:  99.61018482703147
curr_Factors:  [99.61018483 -1.41805558 -0.93276563]
mat_Sqrt:  [[ 9.49194176  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00399747 -0.00455813 -0.02970002]
Stock Position:  -0.003997470502826514
Bond Position:  [-3.61661246]


portfolio before change:  [-4.01460522]
curr_Stock_Price:  99.33494184286633
curr_Factors:  [99.33494184 -1.1910285  -0.93716685]
mat_Sqrt:  [[11.82601819  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05927437 -0.14433084 -0.56331657]
Stock Position:  0.05927436643041953
Bond Position:  [-9.90262097]


portfolio before change:  [-4.02403306]
curr_Stock_Price:  99.21765890154185
curr_Factors:  [99.2176589  -1.3152477  -0.94464496]
mat_Sqrt:  [[10.35452217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00163855  0.01638295  0.03582124]
Stock Position:  -0.0016385456756160077
Bond Position:  [-3.8614604]


portfolio before change:  [-4.0245209]
curr_Stock_Price:  98.92615400191468
curr_Factors:  [98.926154   -0.73233354 -0.97192253]
mat_Sqrt:  [[17.99542551  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00031487 -0.02845143  0.0120735 ]
Stock Position:  -0.00031487412635539043
Bond Position:  [-3.99337162]


portfolio before change:  [-4.02521915]
curr_Stock_Price:  97.97268506253722
curr_Factors:  [97.97268506 -1.14090883 -0.98261827]
mat_Sqrt:  [[11.71841597  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02575684 0.00621514 0.03325924]
Stock Position:  0.025756836934609867
Bond Position:  [-6.54868562]


portfolio before change:  [-4.04396489]
curr_Stock_Price:  97.30845876923807
curr_Factors:  [97.30845877 -0.67207886 -1.00474368]
mat_Sqrt:  [[18.19348172  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00694281  0.00200428  0.6082879 ]
Stock Position:  -0.006942812231542102
Bond Position:  [-3.36837053]


portfolio before change:  [-4.04307227]
curr_Stock_Price:  97.05858607176529
curr_Factors:  [97.05858607 -0.85721529 -1.06161567]
mat_Sqrt:  [[14.24610899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00639129  0.01885059 -0.15169087]
Stock Position:  -0.006391292503191131
Bond Position:  [-3.42274246]


portfolio before change:  [-4.04362101]
curr_Stock_Price:  97.0105438242765
curr_Factors:  [97.01054382 -1.0407732  -1.0417184 ]
mat_Sqrt:  [[12.08938836  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263024 -0.02023452  0.00320002]
Stock Position:  -0.002630240501697682
Bond Position:  [-3.78845995]


portfolio before change:  [-4.04690609]
curr_Stock_Price:  97.89937615905083
curr_Factors:  [97.89937616 -0.96337678 -1.0691316 ]
mat_Sqrt:  [[12.82545405  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00747253  0.03475036 -0.05893775]
Stock Position:  0.0074725258423188135
Bond Position:  [-4.77846171]


portfolio before change:  [-4.06159409]
curr_Stock_Price:  96.09366359561045
curr_Factors:  [96.0936636  -0.8291836  -1.06505643]
mat_Sqrt:  [[14.45562124  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00345873 0.04408539 0.24330359]
Stock Position:  0.0034587276785733017
Bond Position:  [-4.3939559]


portfolio before change:  [-4.06287354]
curr_Stock_Price:  96.04138252862943
curr_Factors:  [96.04138253 -0.44954435 -1.09379639]
mat_Sqrt:  [[20.52078809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186773 -0.04200567  0.01350728]
Stock Position:  0.0018677277363093007
Bond Position:  [-4.24225269]


portfolio before change:  [-4.06864344]
curr_Stock_Price:  93.52002941671032
curr_Factors:  [93.52002942 -0.1955443  -1.06744528]
mat_Sqrt:  [[26.44814567  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00197629 -0.0215523   0.37531543]
Stock Position:  -0.0019762940181229038
Bond Position:  [-3.88382036]


portfolio before change:  [-4.06874891]
curr_Stock_Price:  93.08203855915845
curr_Factors:  [93.08203856 -0.36873134 -1.13455817]
mat_Sqrt:  [[20.70120131  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00307613 0.05082808 0.88512874]
Stock Position:  0.0030761301123178146
Bond Position:  [-4.35508138]


portfolio before change:  [-4.07526519]
curr_Stock_Price:  91.31768962540151
curr_Factors:  [91.31768963 -0.3415631  -1.12486991]
mat_Sqrt:  [[21.07129126  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00019003 -0.01222446 -0.13099134]
Stock Position:  0.00019002689200244282
Bond Position:  [-4.092618]


portfolio before change:  [-4.07603028]
curr_Stock_Price:  92.67636919466476
curr_Factors:  [92.67636919 -0.39745038 -1.17265404]
mat_Sqrt:  [[19.27885882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00610534 0.01576573 0.48003678]
Stock Position:  0.006105339301784145
Bond Position:  [-4.64185096]


portfolio before change:  [-4.07970064]
curr_Stock_Price:  92.2652955018348
curr_Factors:  [92.2652955  -0.41188057 -1.19210224]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.07970064]
Stock Price:  92.70758328835387
PL:  [-4.07970064]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.99282892e-01 -2.25645785e-02  4.99214223e-02]
 [ 8.36140728e-02  9.12310331e-03 -2.35157208e-02]
 [ 2.80843553e-02  4.97781418e-02  3.65437755e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 5.20488519e-01 -3.38648762e-01 -1.82257187e-01]
 [-1.38809425e-02  4.98773914e-02  1.52665481e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 2.61167361e-03 -3.14690244e-02 -4.83661100e-03]
 [-5.17236438e-02  2.69344037e-02  2.11036418e-02]
 [-4.07300590e-01  3.89483667e-01  5.29485037e-02]
 [ 3.73347657e-02 -1.04891142e-01  6.14828269e-03]
 [-1.64046240e-02  5.91128853e-02  2.89210993e-02]
 [-5.41196428e-04  1.54069180e-01  5.63390744e-02]
 [-3.99924105e-02 -1.00764642e-01 -7.24028701e-02]
 [-1.30981693e-01 -9.24293026e-02  1.92935602e-01]
 [ 1.35262993e-02  1.34803554e-01  2.04381929e-01]
 [-4.90371036e-02  1.14025318e-01  2.34935798e-02]
 [-4.95469246e-02 -5.51498836e-02  2.31174446e-02]
 [-3.89379075e-02  4.27160031e-01  1.61052033e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.64198325]
curr_Stock_Price:  101.16535390788044
curr_Factors:  [101.16535391  -0.77391163  -1.01421389]
mat_Sqrt:  [[16.92227554  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01120862 -0.00713555  0.14241192]
Stock Position:  -0.01120861900383268
Bond Position:  [11.77590715]


portfolio before change:  [10.63655253]
curr_Stock_Price:  101.91255238457533
curr_Factors:  [101.91255238  -0.71673135  -1.02912723]
mat_Sqrt:  [[17.78324158  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00444517  0.00288498 -0.06708381]
Stock Position:  0.004445168421257885
Bond Position:  [10.18353407]


portfolio before change:  [10.63878481]
curr_Stock_Price:  101.84193241425467
curr_Factors:  [101.84193241  -0.6105182   -1.02015938]
mat_Sqrt:  [[19.94033074  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00184696 0.01574123 0.10424922]
Stock Position:  0.0018469647691539176
Bond Position:  [10.45068635]


portfolio before change:  [10.64046819]
curr_Stock_Price:  101.33860902614839
curr_Factors:  [101.33860903  -0.81212313  -1.00277665]
mat_Sqrt:  [[16.50342107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00229914 -0.00455813 -0.02970002]
Stock Position:  -0.002299144949389941
Bond Position:  [10.87346034]


portfolio before change:  [10.64559512]
curr_Stock_Price:  100.29116686415011
curr_Factors:  [100.29116686  -0.92878558  -1.00258736]
mat_Sqrt:  [[14.53710991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03264346 -0.10709014 -0.51992902]
Stock Position:  0.03264345907507838
Bond Position:  [7.37174452]


portfolio before change:  [10.62426833]
curr_Stock_Price:  99.58137832960985
curr_Factors:  [99.58137833 -0.86675927 -1.01679335]
mat_Sqrt:  [[15.14124616  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0006259   0.01577262  0.04355121]
Stock Position:  -0.0006258958237202656
Bond Position:  [10.6865959]


portfolio before change:  [10.62655991]
curr_Stock_Price:  100.1891484272527
curr_Factors:  [100.18914843  -1.08873298  -1.00392509]
mat_Sqrt:  [[12.35921355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045847 -0.02845143  0.0120735 ]
Stock Position:  -0.0004584671882993002
Bond Position:  [10.67249335]


portfolio before change:  [10.62897439]
curr_Stock_Price:  100.74312344854987
curr_Factors:  [100.74312345  -1.57239415  -0.98647418]
mat_Sqrt:  [[ 7.79673936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00010413 -0.00995138 -0.0137975 ]
Stock Position:  0.00010413042750543607
Bond Position:  [10.61848397]


portfolio before change:  [10.63159564]
curr_Stock_Price:  100.4195033558817
curr_Factors:  [100.41950336  -1.70377206  -0.99692089]
mat_Sqrt:  [[ 6.74406933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00692763  0.00851741  0.06020282]
Stock Position:  -0.00692763306417853
Bond Position:  [11.32726512]


portfolio before change:  [10.62869957]
curr_Stock_Price:  101.24637222381381
curr_Factors:  [101.24637222  -1.93931503  -1.01086067]
mat_Sqrt:  [[ 5.29827435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07293622  0.12316555  0.15104734]
Stock Position:  -0.07293621874779248
Bond Position:  [18.01322712]


portfolio before change:  [10.63988553]
curr_Stock_Price:  101.15475672630237
curr_Factors:  [101.15475673  -1.87975305  -0.98746394]
mat_Sqrt:  [[ 5.75134995  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0062388  -0.03316949  0.01753934]
Stock Position:  0.006238796340814087
Bond Position:  [10.0088016]


portfolio before change:  [10.63920558]
curr_Stock_Price:  100.64464870453006
curr_Factors:  [100.6446487   -1.43014243  -0.98239796]
mat_Sqrt:  [[ 9.0164942   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00099538  0.01869314  0.08250385]
Stock Position:  -0.0009953803544909688
Bond Position:  [10.73938529]


portfolio before change:  [10.64198333]
curr_Stock_Price:  100.55165570620233
curr_Factors:  [100.55165571  -1.64334992  -0.96408002]
mat_Sqrt:  [[ 7.4130477   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00201496 0.04872095 0.1607197 ]
Stock Position:  0.0020149631730746165
Bond Position:  [10.43937544]


portfolio before change:  [10.64447409]
curr_Stock_Price:  100.49239659417928
curr_Factors:  [100.49239659  -1.16255271  -0.96234209]
mat_Sqrt:  [[12.00336786  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00477977 -0.03186458 -0.20654524]
Stock Position:  -0.0047797682294255855
Bond Position:  [11.12480446]


portfolio before change:  [10.65185004]
curr_Stock_Price:  99.531178340325
curr_Factors:  [99.53117834 -1.23902614 -1.00321178]
mat_Sqrt:  [[10.57225402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00888982 -0.02922871  0.55039157]
Stock Position:  -0.008889815992490504
Bond Position:  [11.5366639]


portfolio before change:  [10.65440514]
curr_Stock_Price:  99.56823472371353
curr_Factors:  [99.56823472 -1.17845169 -1.01934732]
mat_Sqrt:  [[11.05678402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00531133 0.04262863 0.58304475]
Stock Position:  0.005311327286243801
Bond Position:  [10.12556566]


portfolio before change:  [10.65827292]
curr_Stock_Price:  99.81978643242219
curr_Factors:  [99.81978643 -1.52844655 -1.02567564]
mat_Sqrt:  [[ 7.76203263  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00532043  0.03605797  0.06702064]
Stock Position:  -0.00532043314797836
Bond Position:  [11.18935742]


portfolio before change:  [10.66332573]
curr_Stock_Price:  99.39592767389499
curr_Factors:  [99.39592767 -1.64516928 -0.96635994]
mat_Sqrt:  [[ 7.29786567  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00633775 -0.01743992  0.06594763]
Stock Position:  -0.006337751600378532
Bond Position:  [11.29327243]


portfolio before change:  [10.66135921]
curr_Stock_Price:  100.15174577069233
curr_Factors:  [100.15174577  -1.69524804  -0.95884877]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.66135921]
Stock Price:  100.1734530369915
PL:  [10.48790617]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.10015278e-01 -3.61715103e-02  1.09054701e-01]
 [-1.30207166e-01  1.54124573e-01  8.88326373e-02]
 [-5.21409223e-02 -2.81390684e-01  3.21100300e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 2.04645074e-01 -1.61690447e-01 -1.30863503e-01]
 [-7.26000209e-02  6.42592839e-02  2.51262520e-02]
 [-8.00962938e-03 -8.49310605e-02  3.11409057e-03]
 [-3.32916115e-02 -3.63051628e-02 -1.72591556e-02]
 [-2.33380097e-05  3.23918362e-02 -4.48939693e-02]
 [-1.92665106e-01  1.78207735e-01 -7.38471304e-03]
 [ 5.09783519e-02 -1.12290121e-01  5.57125631e-04]
 [ 8.46236241e-02  1.05698054e-01 -7.72323765e-03]
 [-1.53349797e-02  1.70040658e-01  4.51824996e-02]
 [-4.14247931e-02 -9.04814348e-02 -6.85075531e-02]
 [-1.56727352e-01 -1.11560594e-01  2.25383357e-01]
 [ 1.16962775e-02  8.66261856e-02  1.04281081e-01]
 [-1.29682135e-01  2.92434029e-02  6.50256098e-02]
 [-4.71586882e-02 -4.59940468e-02  2.15528200e-02]
 [-2.45964064e-02  5.45676296e-01  2.59724704e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.8933497]
curr_Stock_Price:  99.94667950465254
curr_Factors:  [99.9466795  -1.25935267 -1.01507979]
mat_Sqrt:  [[10.28004239  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02808243 -0.01143844  0.31110271]
Stock Position:  -0.02808242550297035
Bond Position:  [4.70009488]


portfolio before change:  [1.91254995]
curr_Stock_Price:  99.30481636443125
curr_Factors:  [99.30481636 -1.03905272 -1.00349464]
mat_Sqrt:  [[12.87962639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0083927   0.04873847  0.25341479]
Stock Position:  -0.008392696939776128
Bond Position:  [2.74598518]


portfolio before change:  [1.9106821]
curr_Stock_Price:  99.60917946878742
curr_Factors:  [99.60917947 -0.89568464 -1.0256201 ]
mat_Sqrt:  [[14.58435793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00362388 -0.08898355  0.09160098]
Stock Position:  -0.003623880212019754
Bond Position:  [2.27165384]


portfolio before change:  [1.91140899]
curr_Stock_Price:  99.56533061609981
curr_Factors:  [99.56533062 -0.73605984 -1.07603533]
mat_Sqrt:  [[16.26017476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00233354 -0.00455813 -0.02970002]
Stock Position:  -0.002333539323483223
Bond Position:  [2.1437486]


portfolio before change:  [1.91248205]
curr_Stock_Price:  99.3351845081064
curr_Factors:  [99.33518451 -0.53929511 -1.05615912]
mat_Sqrt:  [[20.14680273  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00862459 -0.05113101 -0.37331715]
Stock Position:  0.00862458655241388
Bond Position:  [1.05575715]


portfolio before change:  [1.90931792]
curr_Stock_Price:  98.9377039177085
curr_Factors:  [98.93770392 -0.74131264 -1.05691748]
mat_Sqrt:  [[16.38326321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00401703  0.02032057  0.0716782 ]
Stock Position:  -0.0040170250470644465
Bond Position:  [2.30675315]


portfolio before change:  [1.90755622]
curr_Stock_Price:  99.51984070515992
curr_Factors:  [99.51984071 -0.63763696 -1.09649134]
mat_Sqrt:  [[17.5706294   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054448 -0.02685756  0.00888363]
Stock Position:  -0.0005444812840329456
Bond Position:  [1.96174291]


portfolio before change:  [1.9078896]
curr_Stock_Price:  99.80840398024415
curr_Factors:  [99.80840398 -0.48879733 -1.09137375]
mat_Sqrt:  [[20.55452903  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183668 -0.0114807  -0.04923557]
Stock Position:  -0.001836676342275429
Bond Position:  [2.09120533]


portfolio before change:  [1.90635754]
curr_Stock_Price:  100.92723244315478
curr_Factors:  [100.92723244  -0.44378104  -1.11365931]
mat_Sqrt:  [[21.26280766  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039275  0.0102432  -0.12807   ]
Stock Position:  -0.00039274810925259786
Bond Position:  [1.94599652]


portfolio before change:  [1.90698482]
curr_Stock_Price:  100.56892488854992
curr_Factors:  [100.56892489  -0.48750593  -1.09915366]
mat_Sqrt:  [[20.57720122  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00921268  0.05635423 -0.02106653]
Stock Position:  -0.00921268145779195
Bond Position:  [2.83349429]


portfolio before change:  [1.92667101]
curr_Stock_Price:  98.50896850852536
curr_Factors:  [98.50896851 -0.29773111 -1.13922463]
mat_Sqrt:  [[23.41066877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00205858 -0.03550925  0.00158932]
Stock Position:  0.0020585809285277273
Bond Position:  [1.72388232]


portfolio before change:  [1.92747532]
curr_Stock_Price:  98.69030103173813
curr_Factors:  [98.69030103 -0.30635999 -1.0996712 ]
mat_Sqrt:  [[24.19039083  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00354588  0.03342466 -0.02203225]
Stock Position:  0.0035458805700973517
Bond Position:  [1.5775313]


portfolio before change:  [1.93233604]
curr_Stock_Price:  99.94987343979236
curr_Factors:  [99.94987344 -0.68302337 -1.11403975]
mat_Sqrt:  [[16.5701962   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.03904002e-04  5.37715774e-02  1.28893095e-01]
Stock Position:  -0.00010390400187362807
Bond Position:  [1.94272124]


portfolio before change:  [1.93293756]
curr_Stock_Price:  98.83559784009826
curr_Factors:  [98.83559784 -0.57458998 -1.10351139]
mat_Sqrt:  [[18.45539009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031289  -0.02861274 -0.19543298]
Stock Position:  -0.003128899424786635
Bond Position:  [2.24218421]


portfolio before change:  [1.92970105]
curr_Stock_Price:  100.04916484625211
curr_Factors:  [100.04916485  -0.51562431  -1.11936896]
mat_Sqrt:  [[19.50495316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00582425 -0.03527856  0.64295598]
Stock Position:  -0.0058242461940376045
Bond Position:  [2.51241202]


portfolio before change:  [1.93630712]
curr_Stock_Price:  99.0227843039994
curr_Factors:  [99.0227843  -0.54316769 -1.14318379]
mat_Sqrt:  [[18.3384232   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00192052 0.02739361 0.2974849 ]
Stock Position:  0.0019205163923308695
Bond Position:  [1.74613224]


portfolio before change:  [1.93778177]
curr_Stock_Price:  99.56329202070991
curr_Factors:  [99.56329202 -0.42566207 -1.15227875]
mat_Sqrt:  [[20.54983122  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00562797  0.00924758  0.18549997]
Stock Position:  -0.0056279672029856615
Bond Position:  [2.49812071]


portfolio before change:  [1.92909668]
curr_Stock_Price:  101.21747602672883
curr_Factors:  [101.21747603  -0.31671284  -1.18562021]
mat_Sqrt:  [[22.53204193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195041 -0.01454459  0.0614842 ]
Stock Position:  -0.0019504134860372179
Bond Position:  [2.12651261]


portfolio before change:  [1.93416866]
curr_Stock_Price:  98.8896178721947
curr_Factors:  [98.88961787 -0.25407711 -1.23374914]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.93416866]
Stock Price:  99.11859869778486
PL:  [1.93416866]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.22802002e-01 -2.48536974e-02  6.08605168e-02]
 [ 6.03859506e-02  2.10580058e-02  1.92227147e-02]
 [-2.03534989e-02 -1.79553932e-01  1.78550166e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 4.38050129e-01 -3.66076325e-01 -3.25261388e-01]
 [-1.70420208e-02 -1.46989790e-01 -1.44928444e-01]
 [ 3.41290847e-03 -8.03625509e-02  2.21648932e-03]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [-4.73491555e-02 -1.93722588e-02 -1.27866900e-01]
 [-4.26247835e-01  4.14720502e-01  4.59896060e-02]
 [ 1.05123325e-01 -1.44094497e-01 -2.51174277e-03]
 [-4.30498326e-02  3.89844210e-02  2.80027891e-02]
 [-5.09084286e-02  1.56225250e-01 -1.89733086e-03]
 [-8.61774935e-02 -7.50570857e-02  6.79378386e-02]
 [-1.64156457e-01 -1.21125905e-01  2.46022374e-01]
 [ 3.97827260e-02  8.86607444e-02  1.46417702e-01]
 [-1.29601353e-01  2.39920117e-02  7.14924009e-02]
 [-4.53522358e-02 -4.14317084e-02  2.18619331e-02]
 [-2.58098261e-02  5.31379507e-01  2.73773646e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.92152906]
curr_Stock_Price:  101.06499548391157
curr_Factors:  [101.06499548  -1.22266521  -0.99457254]
mat_Sqrt:  [[11.00694108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0191716  -0.00785943  0.17361811]
Stock Position:  -0.01917159538470613
Bond Position:  [11.85910626]


portfolio before change:  [9.90098425]
curr_Stock_Price:  102.29128693310454
curr_Factors:  [102.29128693  -1.10794191  -0.96834269]
mat_Sqrt:  [[12.82684051  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00505608 0.00665913 0.05483705]
Stock Position:  0.005056076445361793
Bond Position:  [9.38379168]


portfolio before change:  [9.90745765]
curr_Stock_Price:  103.10756440680905
curr_Factors:  [103.10756441  -0.99837699  -0.99315695]
mat_Sqrt:  [[14.07272914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00151676 -0.05677994  0.05093539]
Stock Position:  -0.0015167577892604563
Bond Position:  [10.06384685]


portfolio before change:  [9.90873535]
curr_Stock_Price:  103.92415581361404
curr_Factors:  [103.92415581  -1.11817862  -0.99113387]
mat_Sqrt:  [[12.60821853  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300945 -0.00455813 -0.02970002]
Stock Position:  -0.003009446347470915
Bond Position:  [10.22148952]


portfolio before change:  [9.90967089]
curr_Stock_Price:  104.46251226648472
curr_Factors:  [104.46251227  -1.21041537  -0.95177054]
mat_Sqrt:  [[12.02084666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03013135 -0.1157635  -0.9278802 ]
Stock Position:  0.030131353127479214
Bond Position:  [6.76207404]


portfolio before change:  [9.91019458]
curr_Stock_Price:  104.42378046818466
curr_Factors:  [104.42378047  -1.20522832  -0.99570673]
mat_Sqrt:  [[11.55967069  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00436177 -0.04648225 -0.41344051]
Stock Position:  -0.004361774401461892
Bond Position:  [10.36566755]


portfolio before change:  [9.91470412]
curr_Stock_Price:  103.98409570069471
curr_Factors:  [103.9840957   -1.2463771   -1.00018238]
mat_Sqrt:  [[10.99761561  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0001628  -0.02541287  0.00632303]
Stock Position:  0.00016279849876143316
Bond Position:  [9.89777567]


portfolio before change:  [9.91711573]
curr_Stock_Price:  103.59622315235876
curr_Factors:  [103.59622315  -1.22152385  -1.00448315]
mat_Sqrt:  [[11.18410829  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01248069 -0.01496598 -0.14840805]
Stock Position:  -0.012480685140955483
Bond Position:  [11.21006758]


portfolio before change:  [9.9178083]
curr_Stock_Price:  103.76530871138463
curr_Factors:  [103.76530871  -1.20504112  -1.03233068]
mat_Sqrt:  [[11.07577075  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00667674 -0.00612605 -0.36476868]
Stock Position:  -0.00667674227433307
Bond Position:  [10.61062252]


portfolio before change:  [9.92248152]
curr_Stock_Price:  103.46273064607723
curr_Factors:  [103.46273065  -1.2517171   -1.06357208]
mat_Sqrt:  [[10.21566455  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03975779  0.13114614  0.13119554]
Stock Position:  -0.03975778634174939
Bond Position:  [14.03593066]


portfolio before change:  [9.97495024]
curr_Stock_Price:  102.23129147743457
curr_Factors:  [102.23129148  -0.95658412  -1.05904775]
mat_Sqrt:  [[13.62090763  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.007407   -0.04556668 -0.0071653 ]
Stock Position:  0.007407003760829222
Bond Position:  [9.21772268]


portfolio before change:  [9.98365261]
curr_Stock_Price:  103.09502227573525
curr_Factors:  [103.09502228  -1.14405463  -1.09459286]
mat_Sqrt:  [[10.99019621  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330542  0.01232796  0.07988416]
Stock Position:  -0.0033054199500972712
Bond Position:  [10.32442496]


portfolio before change:  [9.98270675]
curr_Stock_Price:  104.16214701758734
curr_Factors:  [104.16214702  -1.45692492  -1.1118723 ]
mat_Sqrt:  [[ 7.98170117  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00592129  0.04940276 -0.00541256]
Stock Position:  -0.005921294223581269
Bond Position:  [10.59948146]


portfolio before change:  [9.98739121]
curr_Stock_Price:  103.81859595270699
curr_Factors:  [103.81859595  -1.21915538  -1.14561349]
mat_Sqrt:  [[ 9.75593909  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00761051 -0.02373513  0.19380774]
Stock Position:  -0.007610513472529731
Bond Position:  [10.77750404]


portfolio before change:  [9.98991753]
curr_Stock_Price:  103.84072285288896
curr_Factors:  [103.84072285  -1.26368187  -1.11335325]
mat_Sqrt:  [[ 9.63905518  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01214484 -0.03830337  0.70183335]
Stock Position:  -0.012144842575504184
Bond Position:  [11.25104676]


portfolio before change:  [10.01209529]
curr_Stock_Price:  102.24624780813541
curr_Factors:  [102.24624781  -1.30903698  -1.07896079]
mat_Sqrt:  [[ 9.38756867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00766538 0.02803699 0.41768895]
Stock Position:  0.0076653846478123965
Bond Position:  [9.22833847]


portfolio before change:  [10.01050286]
curr_Stock_Price:  101.7374921150756
curr_Factors:  [101.73749212  -1.04166705  -1.04795824]
mat_Sqrt:  [[12.58833506  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00908687  0.00758694  0.20394792]
Stock Position:  -0.009086869375427645
Bond Position:  [10.93497816]


portfolio before change:  [10.01182991]
curr_Stock_Price:  101.89233470438987
curr_Factors:  [101.8923347   -0.70336021  -1.02655037]
mat_Sqrt:  [[18.0655379   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00232262 -0.01310186  0.06236601]
Stock Position:  -0.0023226238681919504
Bond Position:  [10.24848748]


portfolio before change:  [10.01384878]
curr_Stock_Price:  102.12636906890404
curr_Factors:  [102.12636907  -0.85967488  -1.03776015]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.01384878]
Stock Price:  102.68050578386831
PL:  [7.33334299]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.84818873e-01 -3.08898100e-02  8.97055033e-02]
 [-3.03553480e-02  9.22638974e-02  6.20436907e-02]
 [-5.93644720e-02 -3.41860395e-01  1.94992168e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 5.28722395e-01 -3.58718532e-01 -2.17185645e-01]
 [ 2.31196252e-02  4.84367595e-03 -4.01220347e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-3.67153155e-02 -3.67135109e-02 -1.97952018e-02]
 [-2.19391581e-01 -5.23080278e-05  2.82246992e-01]
 [ 5.55293181e-03  5.66243494e-02 -2.57541897e-02]
 [-3.07588856e-02 -6.29088430e-02 -2.94285050e-03]
 [ 1.28118662e-01  6.48808689e-02 -1.14552877e-01]
 [ 3.55419849e-02  1.17518218e-01  8.37230575e-02]
 [ 1.56272445e-01 -2.27212216e-01  1.07723553e-01]
 [-7.61473342e-02 -6.00493422e-02  1.47151314e-01]
 [-1.10676061e-02  1.45897193e-01  2.03667937e-01]
 [-5.47919112e-02  1.19358432e-01  2.80418723e-02]
 [-3.89586026e-02 -4.28912971e-02  3.40771130e-02]
 [-3.01747878e-02  4.99500903e-01  2.27404284e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.44902079]
curr_Stock_Price:  100.302681493508
curr_Factors:  [100.30268149  -1.2943652   -0.97093067]
mat_Sqrt:  [[10.41135008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02567442 -0.00976822  0.25590483]
Stock Position:  -0.02567442102674347
Bond Position:  [7.02423407]


portfolio before change:  [4.45718897]
curr_Stock_Price:  100.05294280359497
curr_Factors:  [100.0529428   -0.94920545  -0.96581589]
mat_Sqrt:  [[14.74166936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103845  0.02917641  0.17699338]
Stock Position:  -0.0010384501714657982
Bond Position:  [4.56108896]


portfolio before change:  [4.4587821]
curr_Stock_Price:  99.61698951455935
curr_Factors:  [99.61698951 -1.14704655 -0.96801514]
mat_Sqrt:  [[12.0163838   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00534362 -0.10810575  0.05562584]
Stock Position:  -0.00534362163932754
Bond Position:  [4.9910976]


portfolio before change:  [4.45737004]
curr_Stock_Price:  100.11477691296452
curr_Factors:  [100.11477691  -1.24516005  -0.93220283]
mat_Sqrt:  [[11.34701167  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00334394 -0.00455813 -0.02970002]
Stock Position:  -0.0033439427302441125
Bond Position:  [4.79214812]


portfolio before change:  [4.45638431]
curr_Stock_Price:  100.76787306601871
curr_Factors:  [100.76787307  -1.13753455  -0.95599984]
mat_Sqrt:  [[12.41971572  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03825591 -0.11343676 -0.61957019]
Stock Position:  0.03825590690119701
Bond Position:  [0.60141794]


portfolio before change:  [4.4645547]
curr_Stock_Price:  100.97751436268302
curr_Factors:  [100.97751436  -0.93756307  -0.95597436]
mat_Sqrt:  [[15.20098806  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099038  0.0015317  -0.114457  ]
Stock Position:  0.0009903838025702614
Bond Position:  [4.36454821]


portfolio before change:  [4.46586539]
curr_Stock_Price:  101.19905535615095
curr_Factors:  [101.19905536  -0.66430877  -0.96395165]
mat_Sqrt:  [[19.86241017  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00028528 -0.02845143  0.0120735 ]
Stock Position:  -0.0002852772568208551
Bond Position:  [4.49473518]


portfolio before change:  [4.46723662]
curr_Stock_Price:  100.33180873073466
curr_Factors:  [100.33180873  -0.64845178  -0.95087586]
mat_Sqrt:  [[20.27026727  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00205739 -0.01160983 -0.0564702 ]
Stock Position:  -0.0020573943302762076
Bond Position:  [4.67365871]


portfolio before change:  [4.47671755]
curr_Stock_Price:  96.29156556617984
curr_Factors:  [96.29156557 -0.39965924 -0.95170697]
mat_Sqrt:  [[24.92856959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.48972278e-03 -1.65412508e-05  8.05172105e-01]
Stock Position:  -0.006489722781086874
Bond Position:  [5.10162312]


portfolio before change:  [4.49337957]
curr_Stock_Price:  93.92067092649334
curr_Factors:  [93.92067093 -0.27271308 -0.96144638]
mat_Sqrt:  [[27.33836522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.43020994e-05  1.79061915e-02 -7.34695345e-02]
Stock Position:  6.430209935473333e-05
Bond Position:  [4.48734027]


portfolio before change:  [4.49454377]
curr_Stock_Price:  94.57739408824315
curr_Factors:  [94.57739409 -0.25905594 -0.98960126]
mat_Sqrt:  [[27.13328713  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00121562 -0.01989352 -0.00839513]
Stock Position:  -0.001215624617563213
Bond Position:  [4.60951438]


portfolio before change:  [4.49505971]
curr_Stock_Price:  95.10106081232635
curr_Factors:  [95.10106081 -0.46178776 -1.03310288]
mat_Sqrt:  [[21.32861264  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00498911  0.02051713 -0.32678747]
Stock Position:  0.004989113551518043
Bond Position:  [4.02058972]


portfolio before change:  [4.4919781]
curr_Stock_Price:  94.28190138504259
curr_Factors:  [94.28190139 -0.7457082  -1.0802682 ]
mat_Sqrt:  [[15.18507197  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00366585 0.03716252 0.23883858]
Stock Position:  0.0036658495853696634
Bond Position:  [4.14635483]


portfolio before change:  [4.49321191]
curr_Stock_Price:  94.3356635752809
curr_Factors:  [94.33566358 -0.87854588 -1.07103485]
mat_Sqrt:  [[13.42714733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01283927 -0.07185081  0.30730531]
Stock Position:  0.012839274420160444
Bond Position:  [3.28201043]


portfolio before change:  [4.50636757]
curr_Stock_Price:  95.29639211242764
curr_Factors:  [95.29639211 -0.61128599 -1.04711861]
mat_Sqrt:  [[18.14848977  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262615 -0.01898927  0.41978174]
Stock Position:  -0.002626150495745156
Bond Position:  [4.75663024]


portfolio before change:  [4.50178783]
curr_Stock_Price:  97.49315905046403
curr_Factors:  [97.49315905 -0.78455263 -1.04151622]
mat_Sqrt:  [[15.70082652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00218288 0.04613674 0.58100793]
Stock Position:  0.0021828778683050712
Bond Position:  [4.28897218]


portfolio before change:  [4.50147232]
curr_Stock_Price:  96.85735000345139
curr_Factors:  [96.85735    -0.64748143 -1.04201291]
mat_Sqrt:  [[17.88111165  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257177  0.03774445  0.07999566]
Stock Position:  -0.0025717677649011172
Bond Position:  [4.75056693]


portfolio before change:  [4.49935956]
curr_Stock_Price:  98.14072733086172
curr_Factors:  [98.14072733 -0.8446045  -1.01107847]
mat_Sqrt:  [[15.34392261  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215786 -0.01356342  0.09721252]
Stock Position:  -0.0021578634390412776
Bond Position:  [4.71113385]


portfolio before change:  [4.49771711]
curr_Stock_Price:  99.44775014385566
curr_Factors:  [99.44775014 -0.86214286 -1.02566938]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.49771711]
Stock Price:  100.43501229287882
PL:  [4.06270482]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.06958031e-01 -4.86913598e-02  1.42197958e-01]
 [-4.92593906e-01  3.44738914e-01  3.73758828e-02]
 [-3.65281764e-02 -2.33632792e-01  4.22432268e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 5.65515224e-01 -3.52785403e-01 -1.67055865e-01]
 [ 2.79931358e-02  3.96350926e-02  6.35496422e-03]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 2.80499520e-01  1.50456751e-02  1.71518398e-02]
 [-1.53721108e-01  1.40811702e-02  1.61890376e-01]
 [-2.10950352e-01  1.85567612e-01 -5.80889418e-03]
 [-5.15234142e-03 -7.95017866e-02  5.16736896e-03]
 [ 4.95945459e-02  9.39207974e-02  2.86875210e-02]
 [-3.34779544e-03  1.63141898e-01  5.65660116e-02]
 [-3.35330592e-02 -1.33837117e-01 -9.26707444e-02]
 [-1.58747463e-01 -1.10120873e-01  2.19731016e-01]
 [ 3.36130573e-02  1.18501655e-01  1.94166704e-01]
 [-7.62524512e-02  9.12399746e-02  5.33868408e-02]
 [-4.48407448e-02 -3.98834666e-02  2.17874897e-02]
 [-3.20800388e-02  4.80939766e-01  2.22297729e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.25036345]
curr_Stock_Price:  99.64806277354567
curr_Factors:  [99.64806277 -1.13510801 -0.99591907]
mat_Sqrt:  [[11.82974986  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0236006  -0.01539756  0.40565119]
Stock Position:  -0.023600600485016693
Bond Position:  [2.10139067]


portfolio before change:  [-0.20243876]
curr_Stock_Price:  97.63966996322796
curr_Factors:  [97.63966996 -0.80279208 -0.99455069]
mat_Sqrt:  [[16.18267293  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0294181   0.10901602  0.10662299]
Stock Position:  -0.029418098431808072
Bond Position:  [2.66993466]


portfolio before change:  [-0.26621947]
curr_Stock_Price:  99.83043939024796
curr_Factors:  [99.83043939 -0.81369345 -1.00545885]
mat_Sqrt:  [[16.18881932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209637 -0.07388118  0.12050817]
Stock Position:  -0.0020963657637276456
Bond Position:  [-0.05693835]


portfolio before change:  [-0.26630109]
curr_Stock_Price:  99.86258449939122
curr_Factors:  [99.8625845  -0.79493987 -1.00564773]
mat_Sqrt:  [[16.49747752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00229997 -0.00455813 -0.02970002]
Stock Position:  -0.0022999732623367746
Bond Position:  [-0.03661982]


portfolio before change:  [-0.26620796]
curr_Stock_Price:  99.81811258390138
curr_Factors:  [99.81811258 -0.92316456 -1.02846417]
mat_Sqrt:  [[14.17841756  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03683812 -0.11156054 -0.47656388]
Stock Position:  0.03683811724331128
Bond Position:  [-3.9433193]


portfolio before change:  [-0.26966108]
curr_Stock_Price:  99.75113937647032
curr_Factors:  [99.75113938 -0.94341248 -0.99707079]
mat_Sqrt:  [[14.32770687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00211574 0.01253372 0.01812894]
Stock Position:  0.002115740599578267
Bond Position:  [-0.48070862]


portfolio before change:  [-0.27130704]
curr_Stock_Price:  99.02999046255128
curr_Factors:  [99.02999046 -1.5170458  -1.01318265]
mat_Sqrt:  [[ 7.88683009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071845 -0.02845143  0.0120735 ]
Stock Position:  -0.0007184501024937119
Bond Position:  [-0.20015893]


portfolio before change:  [-0.27117532]
curr_Stock_Price:  98.77699667339073
curr_Factors:  [98.77699667 -1.57258247 -1.04490171]
mat_Sqrt:  [[ 7.2093628   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03944719 0.00475786 0.04892942]
Stock Position:  0.0394471897879686
Bond Position:  [-4.16765026]


portfolio before change:  [-0.28986027]
curr_Stock_Price:  98.32974287528248
curr_Factors:  [98.32974288 -1.47675944 -1.05755522]
mat_Sqrt:  [[ 7.79912764  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01542631  0.00445286  0.46182818]
Stock Position:  -0.015426314984673081
Bond Position:  [1.22700532]


portfolio before change:  [-0.28223626]
curr_Stock_Price:  97.85540947016905
curr_Factors:  [97.85540947 -1.58145778 -1.02490917]
mat_Sqrt:  [[ 7.22194298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02871038  0.05868163 -0.01657116]
Stock Position:  -0.028710383436539474
Bond Position:  [2.52723006]


portfolio before change:  [-0.30415934]
curr_Stock_Price:  98.64101250901994
curr_Factors:  [98.64101251 -1.31120117 -1.0195117 ]
mat_Sqrt:  [[ 9.59051176  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064129 -0.02514067  0.01474107]
Stock Position:  -0.000641288401045565
Bond Position:  [-0.240902]


portfolio before change:  [-0.30481938]
curr_Stock_Price:  99.57632282514068
curr_Factors:  [99.57632283 -1.33936081 -1.03074844]
mat_Sqrt:  [[ 9.30745008  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00621818 0.02970036 0.08183751]
Stock Position:  0.006218178515579404
Bond Position:  [-0.92400273]


portfolio before change:  [-0.30384229]
curr_Stock_Price:  99.77061095837962
curr_Factors:  [99.77061096 -1.08511572 -1.02853939]
mat_Sqrt:  [[12.05185447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0010298  0.05159    0.16136709]
Stock Position:  0.001029799940789268
Bond Position:  [-0.40658606]


portfolio before change:  [-0.30367706]
curr_Stock_Price:  100.02977581576779
curr_Factors:  [100.02977582  -1.28642211  -1.03192944]
mat_Sqrt:  [[ 9.84650285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00567766 -0.04232301 -0.26436384]
Stock Position:  -0.005677655917655351
Bond Position:  [0.26425759]


portfolio before change:  [-0.30919869]
curr_Stock_Price:  101.0139328980147
curr_Factors:  [101.0139329   -1.41603268  -1.05240988]
mat_Sqrt:  [[ 8.55756672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01364154 -0.03482328  0.62683143]
Stock Position:  -0.013641537331532805
Bond Position:  [1.06878664]


portfolio before change:  [-0.3200334]
curr_Stock_Price:  101.82776626387835
curr_Factors:  [101.82776626  -1.53222474  -1.02387434]
mat_Sqrt:  [[ 7.90253611  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.009656   0.03747351 0.55390356]
Stock Position:  0.009655997556102221
Bond Position:  [-1.30328206]


portfolio before change:  [-0.31386504]
curr_Stock_Price:  102.50032439816782
curr_Factors:  [102.5003244   -1.65481853  -0.98957228]
mat_Sqrt:  [[ 7.28250683  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00865074  0.02885261  0.1522978 ]
Stock Position:  -0.00865074395378274
Bond Position:  [0.57283902]


portfolio before change:  [-0.31291774]
curr_Stock_Price:  102.40737622268003
curr_Factors:  [102.40737622  -1.45898187  -1.00641163]
mat_Sqrt:  [[ 8.70210753  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00476013 -0.01261226  0.06215364]
Stock Position:  -0.004760131802837151
Bond Position:  [0.17455486]


portfolio before change:  [-0.30966803]
curr_Stock_Price:  101.73385027496843
curr_Factors:  [101.73385027  -1.34558805  -0.98252317]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.30966803]
Stock Price:  102.42807674918876
PL:  [-2.73774478]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.63190171e-01 -2.87846847e-02  7.96456661e-02]
 [ 6.43427754e-02  3.14618786e-02  2.72753204e-02]
 [-3.01281305e-02 -2.65212859e-01  1.08427257e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.70415187e-01 -3.12344961e-01 -2.80736468e-01]
 [ 1.06207571e-01 -1.79929916e-01 -1.23478233e-01]
 [ 5.10071359e-02 -9.96476840e-02 -9.69844845e-03]
 [ 9.07919000e-03 -2.58489754e-01 -6.33064027e-02]
 [-7.01687967e-02  2.49873518e-02  4.46496539e-02]
 [ 5.39814791e-03  2.07633224e-02 -6.20333042e-02]
 [-2.94218808e-02 -6.44481318e-02  2.93971339e-04]
 [ 1.11027005e-01  9.85498358e-02 -5.49848562e-02]
 [ 1.19454909e-02  1.52716717e-01  7.04594118e-02]
 [ 3.68207420e-02 -1.83472915e-01 -2.69319580e-02]
 [-1.24290845e-01 -8.74574132e-02  1.84502996e-01]
 [-3.21209216e-03  1.23588916e-01  1.72231299e-01]
 [-4.33240307e-02  1.01190417e-01  1.62669846e-02]
 [ 1.01981022e-01  5.19179765e-02  1.80241729e-01]
 [-4.33140468e-02  4.00725859e-01  9.52118257e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.68892219]
curr_Stock_Price:  100.47539830530438
curr_Factors:  [100.47539831  -1.04066587  -1.00387736]
mat_Sqrt:  [[13.00546518  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01904398 -0.00910252  0.22720692]
Stock Position:  -0.019043977368264877
Bond Position:  [7.6023734]


portfolio before change:  [5.6767554]
curr_Stock_Price:  101.21408962582703
curr_Factors:  [101.21408963  -0.94330799  -1.04039922]
mat_Sqrt:  [[13.92284151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00507961 0.00994912 0.0778089 ]
Stock Position:  0.005079614606686173
Bond Position:  [5.16262683]


portfolio before change:  [5.69249223]
curr_Stock_Price:  104.05800928755697
curr_Factors:  [104.05800929  -0.86733862  -1.03350884]
mat_Sqrt:  [[15.55062857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223545 -0.08386767  0.03093128]
Stock Position:  -0.00223544886583371
Bond Position:  [5.92510859]


portfolio before change:  [5.69254915]
curr_Stock_Price:  104.69526231222929
curr_Factors:  [104.69526231  -0.69171015  -1.02031406]
mat_Sqrt:  [[18.89750035  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200787 -0.00455813 -0.02970002]
Stock Position:  -0.002007871755402962
Bond Position:  [5.90276381]


portfolio before change:  [5.69531641]
curr_Stock_Price:  104.05210050091486
curr_Factors:  [104.0521005   -0.67225491  -1.05081711]
mat_Sqrt:  [[18.57505796  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01642231 -0.09877215 -0.800863  ]
Stock Position:  0.016422311263217405
Bond Position:  [3.98654043]


portfolio before change:  [5.69674195]
curr_Stock_Price:  104.07821008169572
curr_Factors:  [104.07821008  -0.58755458  -1.10549279]
mat_Sqrt:  [[19.14602776  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00398813 -0.05689884 -0.35224903]
Stock Position:  0.003988133359857021
Bond Position:  [5.28166417]


portfolio before change:  [5.70091323]
curr_Stock_Price:  104.79300522457561
curr_Factors:  [104.79300522  -0.35987823  -1.08175252]
mat_Sqrt:  [[24.7879161   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00187408 -0.03151136 -0.02766697]
Stock Position:  0.0018740807457422641
Bond Position:  [5.50452268]


portfolio before change:  [5.69954562]
curr_Stock_Price:  103.32886898208307
curr_Factors:  [103.32886898  -0.20394746  -1.10545586]
mat_Sqrt:  [[27.89684184  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037701 -0.08174164 -0.18059555]
Stock Position:  -0.000377008700329637
Bond Position:  [5.73850151]


portfolio before change:  [5.70260933]
curr_Stock_Price:  99.00827164213347
curr_Factors:  [99.00827164 -0.14620503 -1.1141881 ]
mat_Sqrt:  [[28.07305621  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215187  0.00790169  0.12737303]
Stock Position:  -0.0021518695070150006
Bond Position:  [5.91566221]


portfolio before change:  [5.70738746]
curr_Stock_Price:  97.47517289423115
curr_Factors:  [97.47517289 -0.21650102 -1.15036745]
mat_Sqrt:  [[24.84680686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027079  0.00656594 -0.17696375]
Stock Position:  -0.000270788944850056
Bond Position:  [5.73378266]


portfolio before change:  [5.70904346]
curr_Stock_Price:  96.65394486153858
curr_Factors:  [96.65394486 -0.67466267 -1.18228004]
mat_Sqrt:  [[15.09244536  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00205573 -0.02038029  0.00083862]
Stock Position:  -0.0020557250312980067
Bond Position:  [5.9077374]


portfolio before change:  [5.70968087]
curr_Stock_Price:  97.06242068037534
curr_Factors:  [97.06242068 -0.5357665  -1.14989955]
mat_Sqrt:  [[17.98770061  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00568988  0.03116419 -0.15685649]
Stock Position:  0.005689877556877191
Bond Position:  [5.15740758]


portfolio before change:  [5.71359647]
curr_Stock_Price:  97.52395831813034
curr_Factors:  [97.52395832 -0.79371966 -1.12865948]
mat_Sqrt:  [[14.26371554  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00212224 0.04829327 0.20100109]
Stock Position:  0.002122244143716065
Bond Position:  [5.50662682]


portfolio before change:  [5.71510601]
curr_Stock_Price:  97.58648987697973
curr_Factors:  [97.58648988 -1.07737471 -1.12747717]
mat_Sqrt:  [[10.7605556   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00247069 -0.05801923 -0.07682938]
Stock Position:  0.0024706929414689193
Bond Position:  [5.47399976]


portfolio before change:  [5.7162158]
curr_Stock_Price:  97.48170792631876
curr_Factors:  [97.48170793 -0.78772939 -1.1095375 ]
mat_Sqrt:  [[14.62010834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00607981 -0.02765646  0.52633569]
Stock Position:  -0.006079809225941312
Bond Position:  [6.30888598]


portfolio before change:  [5.71757284]
curr_Stock_Price:  97.51795447680036
curr_Factors:  [97.51795448 -0.6343695  -1.10062707]
mat_Sqrt:  [[17.20224579  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0020425  0.03908225 0.49132796]
Stock Position:  0.002042496493233977
Bond Position:  [5.51839276]


portfolio before change:  [5.71387023]
curr_Stock_Price:  95.02963661977137
curr_Factors:  [95.02963662 -0.41442279 -1.11039329]
mat_Sqrt:  [[20.68425385  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180769  0.03199922  0.04640518]
Stock Position:  -0.0018076949386924284
Bond Position:  [5.88565483]


portfolio before change:  [5.72103763]
curr_Stock_Price:  91.87877513748832
curr_Factors:  [91.87877514 -0.31164405 -1.06622971]
mat_Sqrt:  [[23.16392912  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00604877 0.01641791 0.51417948]
Stock Position:  0.006048767738001117
Bond Position:  [5.16528426]


portfolio before change:  [5.72834975]
curr_Stock_Price:  92.87412429813797
curr_Factors:  [92.8741243  -0.97570438 -1.08719754]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.72834975]
Stock Price:  92.74086643478391
PL:  [5.72834975]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.11697944e-01 -4.18956338e-02  1.24832152e-01]
 [-2.84793277e-01  2.35436405e-01  6.68823321e-02]
 [-2.52875169e-01 -6.67608494e-01 -1.25330133e-01]
 [ 2.03862492e-04  2.94258008e-01  2.32944782e-01]
 [ 5.76773337e-01 -3.13614929e-01 -1.17589195e-01]
 [-1.33310443e-01  7.95338525e-02  2.81382596e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 4.27206203e-01  4.15575241e-02  2.04272637e-02]
 [-2.81128816e-01 -7.20567231e-03  3.64285220e-01]
 [-1.32649249e-01  1.07079716e-01 -3.21189488e-02]
 [-3.65121703e-02 -5.38171893e-02 -3.85958870e-03]
 [ 1.36695589e-01  1.18958913e-01 -6.87789207e-02]
 [ 3.19860403e-02  1.11066612e-01  7.67058078e-02]
 [ 1.29310567e-01 -2.05092293e-01  8.37229326e-02]
 [-5.51597057e-02 -4.97119179e-02  1.35358822e-01]
 [-2.12886404e-02  1.85696448e-01  2.86668685e-01]
 [-3.08284975e-02  9.16598849e-02  1.08177359e-02]
 [-8.50757012e-03 -1.23752741e-03  6.41385259e-02]
 [-2.21523531e-02  5.70049262e-01  2.70157703e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.79797353]
curr_Stock_Price:  99.79409488667055
curr_Factors:  [99.79409489 -1.20584167 -0.96990907]
mat_Sqrt:  [[11.32891453  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02535975 -0.01324856  0.35611138]
Stock Position:  -0.025359748935135592
Bond Position:  [3.32872672]


portfolio before change:  [0.83224917]
curr_Stock_Price:  98.47533750010442
curr_Factors:  [98.4753375  -1.03670155 -0.9323292 ]
mat_Sqrt:  [[13.7463782   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01928232  0.07445153  0.19079668]
Stock Position:  -0.01928231801282251
Bond Position:  [2.73108194]


portfolio before change:  [0.859183]
curr_Stock_Price:  97.11393587953584
curr_Factors:  [97.11393588 -0.80711219 -0.91807316]
mat_Sqrt:  [[17.29987946  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01709235 -0.21111634 -0.35753198]
Stock Position:  -0.01709235334084295
Bond Position:  [2.51908871]


portfolio before change:  [0.86668169]
curr_Stock_Price:  96.71207018914762
curr_Factors:  [96.71207019 -1.05993871 -0.94978948]
mat_Sqrt:  [[12.96184485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00427032 0.09305255 0.66452662]
Stock Position:  0.004270320063276737
Bond Position:  [0.45369019]


portfolio before change:  [0.8693768]
curr_Stock_Price:  97.31663301777542
curr_Factors:  [97.31663302 -1.32883289 -0.96658903]
mat_Sqrt:  [[ 9.80162316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05556968 -0.09917375 -0.33544924]
Stock Position:  0.05556967771022765
Bond Position:  [-4.53847713]


portfolio before change:  [0.85542122]
curr_Stock_Price:  97.08591685865726
curr_Factors:  [97.08591686 -1.46252082 -0.99463036]
mat_Sqrt:  [[ 8.31819385  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.015089    0.02515081  0.08027062]
Stock Position:  -0.01508899544647499
Bond Position:  [2.32035017]


portfolio before change:  [0.86970338]
curr_Stock_Price:  96.17783758127223
curr_Factors:  [96.17783758 -1.91403474 -0.94031868]
mat_Sqrt:  [[ 5.53917479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102295 -0.02845143  0.0120735 ]
Stock Position:  -0.0010229491028362796
Bond Position:  [0.96808841]


portfolio before change:  [0.8697241]
curr_Stock_Price:  96.39420440887567
curr_Factors:  [96.39420441 -1.75911482 -0.96391027]
mat_Sqrt:  [[ 6.33076446  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06830911 0.01314164 0.0582733 ]
Stock Position:  0.06830911410946483
Bond Position:  [-5.71487861]


portfolio before change:  [0.84618671]
curr_Stock_Price:  96.07055082748671
curr_Factors:  [96.07055083 -1.58004413 -0.93491456]
mat_Sqrt:  [[ 7.76886546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02663908 -0.00227863  1.03920433]
Stock Position:  -0.02663908362254484
Bond Position:  [3.40541815]


portfolio before change:  [0.86693896]
curr_Stock_Price:  95.32349875876517
curr_Factors:  [95.32349876 -1.5099974  -0.92722837]
mat_Sqrt:  [[ 8.33155897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01637637  0.03386158 -0.09162642]
Stock Position:  -0.016376372744987964
Bond Position:  [2.4279921]


portfolio before change:  [0.87145644]
curr_Stock_Price:  95.08471479910851
curr_Factors:  [95.0847148  -1.62525641 -0.91889617]
mat_Sqrt:  [[ 7.46791357  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00518077 -0.01701849 -0.01101033]
Stock Position:  -0.0051807722600446535
Bond Position:  [1.3640687]


portfolio before change:  [0.86956303]
curr_Stock_Price:  95.51601560068629
curr_Factors:  [95.5160156  -1.83430101 -0.96764475]
mat_Sqrt:  [[ 5.79704424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02168823  0.03761811 -0.19620712]
Stock Position:  0.021688234830426537
Bond Position:  [-1.20201074]


portfolio before change:  [0.86731739]
curr_Stock_Price:  95.42633096306854
curr_Factors:  [95.42633096 -1.45565915 -0.99000433]
mat_Sqrt:  [[ 8.27046772  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00610743 0.03512235 0.21882032]
Stock Position:  0.006107426693475499
Bond Position:  [0.28450807]


portfolio before change:  [0.86997853]
curr_Stock_Price:  95.85040585422509
curr_Factors:  [95.85040585 -1.14510676 -0.96315815]
mat_Sqrt:  [[11.64088871  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0121215  -0.06485588  0.23883822]
Stock Position:  0.01212149534863316
Bond Position:  [-0.29187172]


portfolio before change:  [0.87710643]
curr_Stock_Price:  96.44446389932718
curr_Factors:  [96.4444639  -1.14433415 -0.95544381]
mat_Sqrt:  [[11.81286723  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243914 -0.01572029  0.38614104]
Stock Position:  -0.002439141784630166
Bond Position:  [1.11234815]


portfolio before change:  [0.87833557]
curr_Stock_Price:  96.05456258551071
curr_Factors:  [96.05456259 -0.8950909  -0.98152349]
mat_Sqrt:  [[14.7066827   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00285734 0.05872237 0.81778597]
Stock Position:  0.0028573419621361687
Bond Position:  [0.60387484]


portfolio before change:  [0.87635485]
curr_Stock_Price:  95.30851586812128
curr_Factors:  [95.30851587 -0.46600035 -0.96164566]
mat_Sqrt:  [[22.86193177  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00114836  0.0289854   0.03085999]
Stock Position:  -0.0011483582693204558
Bond Position:  [0.98580317]


portfolio before change:  [0.87475363]
curr_Stock_Price:  96.91751490581223
curr_Factors:  [ 9.69175149e+01 -4.93800643e-02 -9.47156118e-01]
mat_Sqrt:  [[35.77767417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.27249714e-04 -3.91340528e-04  1.82969362e-01]
Stock Position:  0.000127249714477688
Bond Position:  [0.8624209]


portfolio before change:  [0.87498948]
curr_Stock_Price:  97.07646661306966
curr_Factors:  [ 9.70764666e+01 -5.68335033e-02 -9.65835440e-01]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.87498948]
Stock Price:  100.5220908682247
PL:  [0.35289862]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.13921467e-01 -6.41185709e-02  1.64948117e-01]
 [ 4.26937848e-02  5.17859117e-02  6.34043079e-02]
 [-5.24211451e-02 -2.94503092e-01  3.84218917e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 6.95613029e-01 -4.35096688e-01 -2.10279373e-01]
 [-5.14213664e-02  2.46351919e-02 -5.31736269e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-8.75947956e-02 -4.26613585e-02 -4.00868396e-02]
 [-8.13423195e-02  2.38078859e-02  5.89131249e-02]
 [-2.86401491e-01  2.68929368e-01  2.45112431e-02]
 [ 2.50278283e-02 -9.74702063e-02  5.34269186e-03]
 [ 7.95572451e-02  1.03944582e-01 -2.27397559e-03]
 [ 7.06952484e-03  1.64536249e-01  6.93245995e-02]
 [-4.07895350e-02 -9.29689385e-02 -7.06562655e-02]
 [-1.36989882e-01 -9.68939156e-02  2.00507838e-01]
 [ 1.65095036e-02  9.88388923e-02  1.40014714e-01]
 [-2.05799132e-02  7.45799249e-02  7.43682402e-03]
 [-8.31186505e-03 -2.58647719e-03  6.98527939e-02]
 [-3.41182983e-02  4.68969224e-01  1.93411488e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.56919183]
curr_Stock_Price:  99.32505269757634
curr_Factors:  [99.3250527  -1.06095747 -1.00357573]
mat_Sqrt:  [[12.6021147   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01443465 -0.02027607  0.47055107]
Stock Position:  -0.014434649438964258
Bond Position:  [-1.13546951]


portfolio before change:  [-2.59046496]
curr_Stock_Price:  100.77913917685244
curr_Factors:  [100.77913918  -1.0864449   -1.00405253]
mat_Sqrt:  [[12.45888409  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0045729  0.01637614 0.18087484]
Stock Position:  0.004572900837010733
Bond Position:  [-3.05131797]


portfolio before change:  [-2.59340603]
curr_Stock_Price:  100.30282218606574
curr_Factors:  [100.30282219  -1.28662245  -0.9941873 ]
mat_Sqrt:  [[10.25109039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00509042 -0.09313005  0.10960696]
Stock Position:  -0.005090419109676052
Bond Position:  [-2.08282263]


portfolio before change:  [-2.59678259]
curr_Stock_Price:  100.86383482905404
curr_Factors:  [100.86383483  -1.06498366  -0.95233004]
mat_Sqrt:  [[13.41613027  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282822 -0.00455813 -0.02970002]
Stock Position:  -0.002828219199322057
Bond Position:  [-2.31151756]


portfolio before change:  [-2.59512795]
curr_Stock_Price:  100.07443475861184
curr_Factors:  [100.07443476  -1.25799853  -0.96169575]
mat_Sqrt:  [[10.87231857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05899899 -0.13758965 -0.59986852]
Stock Position:  0.05899898717078132
Bond Position:  [-8.49941824]


portfolio before change:  [-2.52954469]
curr_Stock_Price:  101.22205408017109
curr_Factors:  [101.22205408  -1.39468491  -0.99582976]
mat_Sqrt:  [[ 9.27017259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00664921  0.00779033 -0.15168956]
Stock Position:  -0.00664920842010523
Bond Position:  [-1.85649816]


portfolio before change:  [-2.52695924]
curr_Stock_Price:  100.76340746018964
curr_Factors:  [100.76340746  -1.11096587  -1.02044633]
mat_Sqrt:  [[11.95755225  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047387 -0.02845143  0.0120735 ]
Stock Position:  -0.0004738673743548475
Bond Position:  [-2.47921075]


portfolio before change:  [-2.52792787]
curr_Stock_Price:  101.49937083396254
curr_Factors:  [101.49937083  -0.97650904  -1.06369207]
mat_Sqrt:  [[13.19517846  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.007342   -0.01349071 -0.1143566 ]
Stock Position:  -0.00734199990769111
Bond Position:  [-1.7827195]


portfolio before change:  [-2.5124894]
curr_Stock_Price:  99.33589968940468
curr_Factors:  [99.33589969 -1.12911853 -1.04244998]
mat_Sqrt:  [[11.32416037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00606685  0.00752871  0.16806275]
Stock Position:  -0.006066852550990227
Bond Position:  [-1.90983314]


portfolio before change:  [-2.51821286]
curr_Stock_Price:  100.20058870345447
curr_Factors:  [100.2005887   -1.39268125  -1.02879233]
mat_Sqrt:  [[ 8.89687848  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0308484   0.08504293  0.06992375]
Stock Position:  -0.03084839568750915
Bond Position:  [0.57281455]


portfolio before change:  [-2.49312424]
curr_Stock_Price:  99.39194389679409
curr_Factors:  [99.3919439  -1.28906386 -1.04256829]
mat_Sqrt:  [[ 9.65464276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0024446  -0.03082279  0.01524121]
Stock Position:  0.0024445990807966007
Bond Position:  [-2.73609769]


portfolio before change:  [-2.4962119]
curr_Stock_Price:  98.40873685887787
curr_Factors:  [98.40873686 -1.29978494 -1.03238235]
mat_Sqrt:  [[ 9.5540228   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00855942  0.03287016 -0.00648702]
Stock Position:  0.008559421617510131
Bond Position:  [-3.33853377]


portfolio before change:  [-2.49450909]
curr_Stock_Price:  98.7051993190857
curr_Factors:  [98.70519932 -0.92918246 -1.00297695]
mat_Sqrt:  [[14.29597762  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00178153 0.05203093 0.19776379]
Stock Position:  0.0017815260921195055
Bond Position:  [-2.67035497]


portfolio before change:  [-2.49319861]
curr_Stock_Price:  99.81556621707124
curr_Factors:  [99.81556622 -0.92842402 -1.00113134]
mat_Sqrt:  [[14.49449309  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00397479 -0.02939936 -0.20156266]
Stock Position:  -0.003974794572683701
Bond Position:  [-2.09645224]


portfolio before change:  [-2.49122751]
curr_Stock_Price:  99.18779144597833
curr_Factors:  [99.18779145 -0.86284765 -1.03312959]
mat_Sqrt:  [[14.89518039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00661712 -0.03064055  0.57199305]
Stock Position:  -0.006617118968573152
Bond Position:  [-1.8348901]


portfolio before change:  [-2.4898897]
curr_Stock_Price:  98.9162841781308
curr_Factors:  [98.91628418 -0.53608453 -1.02940489]
mat_Sqrt:  [[20.67208947  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00230465 0.0312556  0.39942301]
Stock Position:  0.0023046483393096583
Bond Position:  [-2.71785695]


portfolio before change:  [-2.49738186]
curr_Stock_Price:  95.96025390374764
curr_Factors:  [95.9602539  -0.80536373 -1.00673977]
mat_Sqrt:  [[15.67129322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109348  0.02358424  0.02121519]
Stock Position:  -0.0010934791522804095
Bond Position:  [-2.39245132]


portfolio before change:  [-2.49886846]
curr_Stock_Price:  96.77271678923393
curr_Factors:  [96.77271679 -0.84408974 -0.99041209]
mat_Sqrt:  [[15.4539291   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00038049 -0.00081792  0.19927058]
Stock Position:  0.00038048538956008803
Bond Position:  [-2.53568906]


portfolio before change:  [-2.49894552]
curr_Stock_Price:  98.23647610973619
curr_Factors:  [98.23647611 -1.03555728 -0.97389343]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.49894552]
Stock Price:  97.9031969298492
PL:  [-2.49894552]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [ 7.32844257e-03 -1.06256529e-01  6.27438075e-02]
 [ 1.24714154e-02  7.41214867e-02  8.73577456e-02]
 [-4.63334084e-02 -2.47054288e-01  3.67344202e-02]
 [-2.61684450e-02  2.88451397e-02  1.80077854e-02]
 [ 7.59514817e-01 -4.48122713e-01 -1.85502901e-01]
 [-9.53518625e-02  7.02548041e-02  2.14446318e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 2.45983337e-01  9.93252057e-03  1.11760707e-02]
 [-1.09765638e-01  1.94688300e-02  1.01986696e-01]
 [-6.97556729e-02  6.61832039e-02 -3.97043864e-02]
 [-1.70081696e-02 -7.23823066e-02  4.62189220e-03]
 [ 4.83757874e-02  9.17770847e-02  2.33193832e-02]
 [ 7.84554492e-03  1.64676488e-01  7.02891331e-02]
 [ 4.00998168e-02 -1.44860398e-01 -2.45354815e-03]
 [-1.23362518e-01 -8.67675844e-02  1.83333007e-01]
 [-2.71152712e-02  2.03194180e-01  2.95068931e-01]
 [-2.20315411e-02  8.00330956e-02  9.39268874e-03]
 [ 1.00114576e-02  1.89591208e-02  9.99586473e-02]
 [-3.54556175e-02  4.56899370e-01  1.88234685e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.24403227]
curr_Stock_Price:  98.53455407266078
curr_Factors:  [98.53455407 -0.72732067 -1.00606075]
mat_Sqrt:  [[17.40967131  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099901 -0.03360126  0.17899062]
Stock Position:  0.0009990100655482114
Bond Position:  [-8.34246928]


portfolio before change:  [-8.24408115]
curr_Stock_Price:  100.57357080090415
curr_Factors:  [100.5735708   -1.16690257  -0.92552309]
mat_Sqrt:  [[12.40951917  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00259616 0.02343927 0.24920733]
Stock Position:  0.002596156118555998
Bond Position:  [-8.50518584]


portfolio before change:  [-8.24669229]
curr_Stock_Price:  100.38691729800637
curr_Factors:  [100.3869173   -1.16659472  -0.91300904]
mat_Sqrt:  [[12.54632925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00360376 -0.07812543  0.10479308]
Stock Position:  -0.00360375849052407
Bond Position:  [-7.88492208]


portfolio before change:  [-8.24368922]
curr_Stock_Price:  99.00653850657538
curr_Factors:  [99.00653851 -1.3704903  -0.9078789 ]
mat_Sqrt:  [[10.14333353  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214405  0.00912163  0.0513712 ]
Stock Position:  -0.0021440528180387275
Bond Position:  [-8.03141397]


portfolio before change:  [-8.2448539]
curr_Stock_Price:  98.61316111157184
curr_Factors:  [98.61316111 -1.30934317 -0.91495647]
mat_Sqrt:  [[10.66433605  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06658443 -0.14170884 -0.52918814]
Stock Position:  0.06658442810966214
Bond Position:  [-14.81095483]


portfolio before change:  [-8.25379938]
curr_Stock_Price:  98.53442984388145
curr_Factors:  [98.53442984 -1.46682658 -0.92427278]
mat_Sqrt:  [[ 9.01875834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00988612  0.02221652  0.06117557]
Stock Position:  -0.009886119661467015
Bond Position:  [-7.27967621]


portfolio before change:  [-8.24966404]
curr_Stock_Price:  97.93202105477215
curr_Factors:  [97.93202105 -1.42881323 -0.90597129]
mat_Sqrt:  [[ 9.48288933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00059753 -0.02845143  0.0120735 ]
Stock Position:  -0.0005975282098629551
Bond Position:  [-8.19114689]


portfolio before change:  [-8.2520655]
curr_Stock_Price:  98.52349154395851
curr_Factors:  [98.52349154 -1.18019266 -0.90593841]
mat_Sqrt:  [[12.23332696  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02031509 0.00314094 0.03188222]
Stock Position:  0.020315086834230143
Bond Position:  [-10.25357879]


portfolio before change:  [-8.25285554]
curr_Stock_Price:  98.61079964873673
curr_Factors:  [98.61079965 -0.92846653 -0.9116426 ]
mat_Sqrt:  [[15.65940438  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00564804  0.00615658  0.29093966]
Stock Position:  -0.0056480442055025885
Bond Position:  [-7.69589739]


portfolio before change:  [-8.24567152]
curr_Stock_Price:  96.99816331453867
curr_Factors:  [96.99816331 -0.99154315 -0.90889208]
mat_Sqrt:  [[14.50156857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00525126  0.02092897 -0.11326556]
Stock Position:  -0.00525125633857379
Bond Position:  [-7.7363093]


portfolio before change:  [-8.25416594]
curr_Stock_Price:  98.24740775586893
curr_Factors:  [98.24740776 -1.27464921 -0.92359705]
mat_Sqrt:  [[10.90523124  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016445  -0.0228893   0.01318497]
Stock Position:  -0.0016444981763793205
Bond Position:  [-8.09259826]


portfolio before change:  [-8.25798112]
curr_Stock_Price:  99.33696713486577
curr_Factors:  [99.33696713 -1.38358062 -0.94620461]
mat_Sqrt:  [[ 9.66714048  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00574167 0.02902246 0.06652371]
Stock Position:  0.0057416679568365
Bond Position:  [-8.828341]


portfolio before change:  [-8.26222769]
curr_Stock_Price:  98.98180775996211
curr_Factors:  [98.98180776 -1.04779768 -0.95441156]
mat_Sqrt:  [[13.36616925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00197852 0.05207528 0.20051533]
Stock Position:  0.0019785162269111635
Bond Position:  [-8.4580648]


portfolio before change:  [-8.2666229]
curr_Stock_Price:  97.82921127769846
curr_Factors:  [97.82921128 -1.06722547 -0.95698963]
mat_Sqrt:  [[12.92299289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0027748  -0.04580888 -0.00699929]
Stock Position:  0.002774799098596949
Bond Position:  [-8.53807931]


portfolio before change:  [-8.26707304]
curr_Stock_Price:  98.43633366158448
curr_Factors:  [98.43633366 -1.01148737 -0.96233725]
mat_Sqrt:  [[13.67521901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00644817 -0.02743832  0.52299804]
Stock Position:  -0.0064481712531650175
Bond Position:  [-7.63233871]


portfolio before change:  [-8.26191992]
curr_Stock_Price:  97.34122540938824
curr_Factors:  [97.34122541 -1.25576156 -0.92287006]
mat_Sqrt:  [[11.01866846  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00348153 0.06425564 0.84174953]
Stock Position:  0.003481534388499692
Bond Position:  [-8.60081674]


portfolio before change:  [-8.26437315]
curr_Stock_Price:  97.25426469427333
curr_Factors:  [97.25426469 -1.04869058 -0.9305201 ]
mat_Sqrt:  [[13.43842515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.001343    0.02530869  0.02679473]
Stock Position:  -0.0013430011856063117
Bond Position:  [-8.13376056]


portfolio before change:  [-8.2651028]
curr_Stock_Price:  96.28327273986886
curr_Factors:  [96.28327274 -0.99245632 -0.94172064]
mat_Sqrt:  [[13.91709086  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00222065 0.0059954  0.2851542 ]
Stock Position:  0.002220647527469512
Bond Position:  [-8.47891401]


portfolio before change:  [-8.26142348]
curr_Stock_Price:  98.89481371091739
curr_Factors:  [98.89481371 -1.21736719 -0.96038955]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.26142348]
Stock Price:  98.42677275183328
PL:  [-8.26142348]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.83527048e-01 -5.15524997e-02  1.45165631e-01]
 [ 7.32523815e-02  2.11341003e-02  3.79334304e-03]
 [-1.89737522e-02 -1.58745378e-01  3.58085017e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 2.70237763e-01 -2.30846261e-01 -2.09099578e-01]
 [ 8.85892882e-02 -1.81299194e-02 -3.20226470e-02]
 [ 2.48726239e-02 -7.28864387e-02 -9.46476230e-03]
 [-8.80748436e-02 -1.07901602e-01 -5.53113715e-02]
 [-9.59566760e-02 -3.89365197e-02 -1.10660711e-01]
 [-2.30931184e-01  2.23923134e-01  1.29593236e-02]
 [ 1.11853233e-01 -2.14590125e-01  8.61681794e-02]
 [-1.22306758e-01 -4.09852619e-03 -6.76357194e-03]
 [-3.90942812e-02  1.87402766e-01  2.40501488e-02]
 [-5.18578757e-02 -3.50956053e-02 -3.61707740e-02]
 [-1.45344358e-01 -1.03102027e-01  2.11037147e-01]
 [-6.61385844e-03  1.46515088e-01  2.16513760e-01]
 [-6.54113420e-02  1.18899263e-01  3.27312228e-02]
 [ 2.33611565e-02  3.64004165e-02  1.15936812e-01]
 [-2.91776243e-02  5.14634342e-01  2.12979140e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.79081211]
curr_Stock_Price:  99.57277890927813
curr_Factors:  [99.57277891 -1.10860532 -0.97882624]
mat_Sqrt:  [[12.34754509  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02067021 -0.01630233  0.41411714]
Stock Position:  -0.020670207373656657
Bond Position:  [1.26737788]


portfolio before change:  [-0.83296563]
curr_Stock_Price:  101.62744655301464
curr_Factors:  [101.62744655  -0.82643675  -0.9989084 ]
mat_Sqrt:  [[16.37848348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00455307 0.00668319 0.01082135]
Stock Position:  0.004553069557161783
Bond Position:  [-1.29568246]


portfolio before change:  [-0.83807957]
curr_Stock_Price:  100.57541411043412
curr_Factors:  [100.57541411  -0.95057541  -0.9993422 ]
mat_Sqrt:  [[14.31045267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00110151 -0.0501997   0.10215169]
Stock Position:  -0.001101513754985891
Bond Position:  [-0.72729436]


portfolio before change:  [-0.83804329]
curr_Stock_Price:  100.37739530787368
curr_Factors:  [100.37739531  -0.92266606  -1.01693266]
mat_Sqrt:  [[14.43041759  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262943 -0.00455813 -0.02970002]
Stock Position:  -0.0026294289094749316
Bond Position:  [-0.57410807]


portfolio before change:  [-0.84150398]
curr_Stock_Price:  101.6389404213387
curr_Factors:  [101.63894042  -0.79954592  -1.01437327]
mat_Sqrt:  [[16.56857017  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01337442 -0.073      -0.5965029 ]
Stock Position:  0.013374422986322666
Bond Position:  [-2.20086616]


portfolio before change:  [-0.85173806]
curr_Stock_Price:  100.91488694451532
curr_Factors:  [100.91488694  -0.50354722  -0.96756294]
mat_Sqrt:  [[23.17715974  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00352004 -0.00573318 -0.0913517 ]
Stock Position:  0.0035200421974633466
Bond Position:  [-1.20696272]


portfolio before change:  [-0.84692565]
curr_Stock_Price:  102.36776511167265
curr_Factors:  [102.36776511  -0.31253928  -0.97972634]
mat_Sqrt:  [[28.11508477  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074902 -0.02304872 -0.02700033]
Stock Position:  0.0007490184653714865
Bond Position:  [-0.923601]


portfolio before change:  [-0.8467718]
curr_Stock_Price:  102.88147849588508
curr_Factors:  [102.8814785  -0.5137635  -1.0155537]
mat_Sqrt:  [[22.29272587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00458227 -0.03412148 -0.15778795]
Stock Position:  -0.004582267685687934
Bond Position:  [-0.37534132]


portfolio before change:  [-0.855965]
curr_Stock_Price:  104.8672541358647
curr_Factors:  [104.86725414  -0.4019392   -1.03656978]
mat_Sqrt:  [[24.88303689  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0048045  -0.01231281 -0.31568421]
Stock Position:  -0.004804499392798386
Bond Position:  [-0.35213034]


portfolio before change:  [-0.8442647]
curr_Stock_Price:  102.41364832080352
curr_Factors:  [102.41364832  -0.17571416  -1.01108107]
mat_Sqrt:  [[31.25641897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00711867  0.07081071  0.03696934]
Stock Position:  -0.007118672248735231
Bond Position:  [-0.1152155]


portfolio before change:  [-0.87273863]
curr_Stock_Price:  106.40949526629089
curr_Factors:  [106.40949527  -0.5119286   -0.99139179]
mat_Sqrt:  [[23.66446194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00523576 -0.06785936  0.24581383]
Stock Position:  0.005235764326063915
Bond Position:  [-1.42987367]


portfolio before change:  [-0.87744217]
curr_Stock_Price:  105.57943037925881
curr_Factors:  [105.57943038  -0.70013479  -1.00225538]
mat_Sqrt:  [[19.24157678  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00643363 -0.00129607 -0.01929459]
Stock Position:  -0.006433630234424391
Bond Position:  [-0.19818315]


portfolio before change:  [-0.85489568]
curr_Stock_Price:  102.06725466823896
curr_Factors:  [102.06725467  -0.35704963  -0.95505415]
mat_Sqrt:  [[27.48191563  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106784  0.05926196  0.06860838]
Stock Position:  -0.0010678421024110244
Bond Position:  [-0.74590397]


portfolio before change:  [-0.85246207]
curr_Stock_Price:  99.61361035621348
curr_Factors:  [99.61361036 -0.33604945 -0.94888784]
mat_Sqrt:  [[27.55989144  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218242 -0.0110982  -0.10318515]
Stock Position:  -0.002182424006182327
Bond Position:  [-0.63506294]


portfolio before change:  [-0.85138097]
curr_Stock_Price:  99.04548813179544
curr_Factors:  [99.04548813 -0.18322613 -0.89555038]
mat_Sqrt:  [[33.67658232  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311578 -0.03260372  0.60203024]
Stock Position:  -0.0031157753015933023
Bond Position:  [-0.54277749]


portfolio before change:  [-0.8452935]
curr_Stock_Price:  97.04817296406763
curr_Factors:  [97.04817296 -0.39764471 -0.88466319]
mat_Sqrt:  [[26.92080958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00153654 0.04633214 0.61765349]
Stock Position:  0.001536537408289673
Bond Position:  [-0.99441165]


portfolio before change:  [-0.84382446]
curr_Stock_Price:  98.16606157272075
curr_Factors:  [98.16606157 -0.57411893 -0.89878001]
mat_Sqrt:  [[22.50554253  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247317  0.03759925  0.09337307]
Stock Position:  -0.0024731749190061874
Bond Position:  [-0.60104261]


portfolio before change:  [-0.83738668]
curr_Stock_Price:  95.50225606616993
curr_Factors:  [95.50225607 -0.13710283 -0.89624667]
mat_Sqrt:  [[33.98096002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00141157 0.01151082 0.33073545]
Stock Position:  0.0014115702982467147
Bond Position:  [-0.97219483]


portfolio before change:  [-0.8376039]
curr_Stock_Price:  95.52057583177961
curr_Factors:  [95.52057583 -0.42622497 -0.8883276 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.8376039]
Stock Price:  97.92464159915842
PL:  [-0.8376039]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.70455158e-01 -2.94917872e-02  8.30247219e-02]
 [-5.58446842e-02  9.29130047e-02  2.45754819e-03]
 [-1.08708978e-01 -3.29140247e-01 -1.72592423e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 5.12839892e-01 -3.28765264e-01 -1.71014469e-01]
 [-8.03663524e-02  6.61998135e-02  2.57502386e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-3.36704616e-02 -3.63440471e-02 -1.66307375e-02]
 [-3.84399321e-02  2.83366190e-02  4.14642608e-03]
 [-2.67297057e-01  2.57228790e-01  3.51482680e-02]
 [ 8.70016206e-02 -1.33627346e-01 -9.51876714e-05]
 [ 4.46406466e-02  9.12794120e-02  3.74030482e-02]
 [-2.75399978e-02  1.81104748e-01  3.51589209e-02]
 [-9.94702586e-02 -1.25151008e-02  1.02810411e-01]
 [-1.30258120e-01 -1.04956651e-01  2.28445671e-01]
 [-6.50904616e-03  1.27301984e-02 -3.67374130e-02]
 [-9.34286345e-02  5.04166643e-02  8.24746594e-02]
 [-2.78191634e-02  1.06014254e-02  1.99657976e-02]
 [ 4.60548112e-03  5.81231147e-01  4.28732334e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.3882761]
curr_Stock_Price:  100.2942198295234
curr_Factors:  [100.29421983  -0.91767802  -0.93682899]
mat_Sqrt:  [[15.69906329  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01619646 -0.00932612  0.23684642]
Stock Position:  -0.01619646203302983
Bond Position:  [6.01268763]


portfolio before change:  [4.39063859]
curr_Stock_Price:  100.24117603188033
curr_Factors:  [100.24117603  -0.56692447  -0.92308541]
mat_Sqrt:  [[22.59139686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00234355  0.02938167  0.0070107 ]
Stock Position:  -0.002343548568991383
Bond Position:  [4.62555865]


portfolio before change:  [4.39563635]
curr_Stock_Price:  98.60210869852945
curr_Factors:  [98.6021087  -0.56944602 -0.94913793]
mat_Sqrt:  [[21.59601261  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0055904  -0.10408329 -0.04923581]
Stock Position:  -0.005590400998415761
Bond Position:  [4.94686168]


portfolio before change:  [4.38740054]
curr_Stock_Price:  100.29656318511982
curr_Factors:  [100.29656319  -0.70534935  -0.95670206]
mat_Sqrt:  [[19.03120543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199377 -0.00455813 -0.02970002]
Stock Position:  -0.0019937653103282178
Bond Position:  [4.58736835]


portfolio before change:  [4.39042458]
curr_Stock_Price:  99.35510329296547
curr_Factors:  [99.35510329 -0.87922584 -0.97019972]
mat_Sqrt:  [[15.63129161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03003226 -0.1039647  -0.48785668]
Stock Position:  0.030032260879118724
Bond Position:  [1.4065662]


portfolio before change:  [4.3718434]
curr_Stock_Price:  98.72468566346375
curr_Factors:  [98.72468566 -0.7891739  -0.97140403]
mat_Sqrt:  [[16.97526173  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00432399  0.02093422  0.07345826]
Stock Position:  -0.004323988414491071
Bond Position:  [4.7987278]


portfolio before change:  [4.37068429]
curr_Stock_Price:  99.27023372305368
curr_Factors:  [99.27023372 -0.8616871  -1.023679  ]
mat_Sqrt:  [[15.06658933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037608 -0.02845143  0.0120735 ]
Stock Position:  -0.00037608338308409703
Bond Position:  [4.40801817]


portfolio before change:  [4.37115918]
curr_Stock_Price:  100.93807554023265
curr_Factors:  [100.93807554  -1.30004778  -1.01307731]
mat_Sqrt:  [[ 9.98797756  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380493 -0.011493   -0.04744286]
Stock Position:  -0.0038049340523116757
Bond Position:  [4.7552219]


portfolio before change:  [4.37440137]
curr_Stock_Price:  100.39845066588276
curr_Factors:  [100.39845067  -1.15927676  -0.95898173]
mat_Sqrt:  [[12.07199484  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305351  0.00896083  0.0118286 ]
Stock Position:  -0.003053505122996777
Bond Position:  [4.68096856]


portfolio before change:  [4.37318486]
curr_Stock_Price:  101.18014374569552
curr_Factors:  [101.18014375  -1.00513375  -0.92187348]
mat_Sqrt:  [[14.73013371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01720832  0.08134289  0.10026823]
Stock Position:  -0.01720831819667931
Bond Position:  [6.11432497]


portfolio before change:  [4.38750958]
curr_Stock_Price:  100.4365525263744
curr_Factors:  [100.43655253  -0.62712265  -0.90830844]
mat_Sqrt:  [[21.63030023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0038618  -0.04225668 -0.00027154]
Stock Position:  0.00386180248725742
Bond Position:  [3.99964346]


portfolio before change:  [4.38633886]
curr_Stock_Price:  99.87444219119962
curr_Factors:  [99.87444219 -0.92305076 -0.89098746]
mat_Sqrt:  [[16.27899464  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.003356   0.02886508 0.10670049]
Stock Position:  0.003356001852807908
Bond Position:  [4.05116005]


portfolio before change:  [4.39312611]
curr_Stock_Price:  101.59503977436161
curr_Factors:  [101.59503977  -0.6385707   -0.91684166]
mat_Sqrt:  [[21.44694797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00073144  0.05727035  0.10029862]
Stock Position:  -0.0007314378082680624
Bond Position:  [4.46743656]


portfolio before change:  [4.39264912]
curr_Stock_Price:  103.77429054392837
curr_Factors:  [103.77429054  -0.6070923   -0.93137251]
mat_Sqrt:  [[22.28142671  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00353691 -0.00395762  0.29328949]
Stock Position:  -0.003536905912295253
Bond Position:  [4.75968902]


portfolio before change:  [4.39200175]
curr_Stock_Price:  104.29379543106589
curr_Factors:  [104.29379543  -0.7392398   -0.93787992]
mat_Sqrt:  [[19.493716    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00442896 -0.03319021  0.65169191]
Stock Position:  -0.004428956052684025
Bond Position:  [4.85391439]


portfolio before change:  [4.38527782]
curr_Stock_Price:  106.08599103114312
curr_Factors:  [106.08599103  -0.67699822  -1.00809247]
mat_Sqrt:  [[19.6712723   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0006954   0.00402564 -0.10480161]
Stock Position:  -0.0006953971589642385
Bond Position:  [4.45904972]


portfolio before change:  [4.38496418]
curr_Stock_Price:  108.14027292021066
curr_Factors:  [108.14027292  -1.1692481   -0.97633051]
mat_Sqrt:  [[12.65244648  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00595077  0.01594315  0.23527725]
Stock Position:  -0.0059507710701053405
Bond Position:  [5.02848219]


portfolio before change:  [4.37936398]
curr_Stock_Price:  109.29264173741008
curr_Factors:  [109.29264174  -1.08582248  -1.00593515]
mat_Sqrt:  [[13.49435491  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00173924  0.00335247  0.05695686]
Stock Position:  -0.0017392409282835958
Bond Position:  [4.56945022]


portfolio before change:  [4.38120068]
curr_Stock_Price:  108.89350580198392
curr_Factors:  [108.8935058   -0.78900257  -0.94908463]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.38120068]
Stock Price:  109.47683890781073
PL:  [-5.09563823]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.60952278e-01 -4.40778010e-02  1.20433738e-01]
 [-3.10483799e-01  2.48949542e-01  6.32344313e-02]
 [-1.67545315e-01 -4.83462895e-01 -6.25510821e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 4.63631889e-01 -3.15461983e-01 -1.91202995e-01]
 [ 5.02595346e-02  2.51640685e-02 -1.61714688e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 1.77347622e-01 -1.39260365e-03  4.65202651e-03]
 [-1.48127462e-01  1.37002982e-02  1.59676467e-01]
 [-2.03640249e-01  1.80048995e-01 -4.98639823e-03]
 [-3.28465537e-02 -6.29506962e-02  4.51512582e-03]
 [ 1.10603896e-01  9.98623309e-02 -4.94867385e-02]
 [ 3.08113831e-02  1.38791936e-01  8.71856681e-02]
 [ 1.12125493e-01 -2.10202312e-01  5.83985198e-02]
 [-4.43418661e-02 -4.54758128e-02  1.32325307e-01]
 [-2.64724435e-02  1.92467748e-01  2.80498805e-01]
 [-4.82665194e-02  1.15947905e-01  2.38326187e-02]
 [-5.06106108e-02 -5.82480445e-02  2.31954935e-02]
 [-3.16510556e-02  4.86813657e-01  2.21542574e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.53579108]
curr_Stock_Price:  99.60830303935553
curr_Factors:  [99.60830304 -0.84045538 -1.02414674]
mat_Sqrt:  [[15.43508882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01538747 -0.01393862  0.34356393]
Stock Position:  -0.015387467526624682
Bond Position:  [0.99692845]


portfolio before change:  [-0.51918656]
curr_Stock_Price:  98.54540825782179
curr_Factors:  [98.54540826 -0.87017179 -1.00712375]
mat_Sqrt:  [[15.07777647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01930976  0.07872476  0.18039023]
Stock Position:  -0.019309761980636143
Bond Position:  [1.38370182]


portfolio before change:  [-0.50894345]
curr_Stock_Price:  98.03286248359741
curr_Factors:  [98.03286248 -0.7389408  -0.99529465]
mat_Sqrt:  [[17.30624294  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01114028 -0.15288439 -0.17844083]
Stock Position:  -0.011140283862344573
Bond Position:  [0.58317046]


portfolio before change:  [-0.52498638]
curr_Stock_Price:  99.48603381536667
curr_Factors:  [99.48603382 -0.95253227 -0.99970299]
mat_Sqrt:  [[14.1226799   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268673 -0.00455813 -0.02970002]
Stock Position:  -0.002686725002927294
Bond Position:  [-0.25769477]


portfolio before change:  [-0.5281492]
curr_Stock_Price:  100.6392541532888
curr_Factors:  [100.63925415  -0.97093028  -1.00825933]
mat_Sqrt:  [[13.9064502   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02994708 -0.09975784 -0.54544892]
Stock Position:  0.02994707793050717
Bond Position:  [-3.54200079]


portfolio before change:  [-0.54249944]
curr_Stock_Price:  100.18964001446182
curr_Factors:  [100.18964001  -1.09563968  -0.99284175]
mat_Sqrt:  [[12.41100225  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00383597  0.00795758 -0.0461327 ]
Stock Position:  0.00383597390942136
Bond Position:  [-0.92682429]


portfolio before change:  [-0.54736841]
curr_Stock_Price:  98.98075828259226
curr_Factors:  [98.98075828 -1.38298339 -0.96548123]
mat_Sqrt:  [[ 9.45421672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00059934 -0.02845143  0.0120735 ]
Stock Position:  -0.0005993403849073383
Bond Position:  [-0.48804525]


portfolio before change:  [-0.54734953]
curr_Stock_Price:  98.7456480594523
curr_Factors:  [98.74564806 -1.00911371 -0.96356582]
mat_Sqrt:  [[13.73390783  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01297965 -0.00044038  0.01327094]
Stock Position:  0.012979645580821096
Bond Position:  [-1.82903304]


portfolio before change:  [-0.55503024]
curr_Stock_Price:  98.18913092066298
curr_Factors:  [98.18913092 -1.2395391  -0.98716739]
mat_Sqrt:  [[10.59295367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01087326  0.00433241  0.45551252]
Stock Position:  -0.010873256223759549
Bond Position:  [0.51260534]


portfolio before change:  [-0.55228086]
curr_Stock_Price:  97.94806113370586
curr_Factors:  [97.94806113 -1.51821087 -0.99924592]
mat_Sqrt:  [[ 7.90093071  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02531464  0.05693649 -0.01422481]
Stock Position:  -0.025314643962666795
Bond Position:  [1.92723943]


portfolio before change:  [-0.54796074]
curr_Stock_Price:  97.79643934087157
curr_Factors:  [97.79643934 -1.23142362 -1.01241683]
mat_Sqrt:  [[10.37135545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0032349  -0.01990676  0.0128804 ]
Stock Position:  -0.0032348990151874536
Bond Position:  [-0.23159913]


portfolio before change:  [-0.5447841]
curr_Stock_Price:  96.79654914100361
curr_Factors:  [96.79654914 -1.14607993 -1.00180263]
mat_Sqrt:  [[11.29916448  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00912288  0.03157924 -0.14117189]
Stock Position:  0.009122877368133478
Bond Position:  [-1.42784715]


portfolio before change:  [-0.54888641]
curr_Stock_Price:  96.38600941038166
curr_Factors:  [96.38600941 -1.02475497 -1.02496858]
mat_Sqrt:  [[12.41167431  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00420505 0.04388986 0.24871644]
Stock Position:  0.004205047129598685
Bond Position:  [-0.95419412]


portfolio before change:  [-0.54982823]
curr_Stock_Price:  96.21877181757384
curr_Factors:  [96.21877182 -1.17366022 -1.02009187]
mat_Sqrt:  [[10.72816344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01105675 -0.06647181  0.16659472]
Stock Position:  0.011056751787941336
Bond Position:  [-1.61369531]


portfolio before change:  [-0.54817845]
curr_Stock_Price:  96.40447368479492
curr_Factors:  [96.40447368 -1.16764195 -1.02346735]
mat_Sqrt:  [[10.77731335  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00171706 -0.01438071  0.37748727]
Stock Position:  -0.0017170565349206377
Bond Position:  [-0.38264652]


portfolio before change:  [-0.5489892]
curr_Stock_Price:  96.82093179479621
curr_Factors:  [96.82093179 -1.08778199 -0.96839743]
mat_Sqrt:  [[12.38744913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00288628 0.06086365 0.80018502]
Stock Position:  0.002886278758120122
Bond Position:  [-0.8284414]


portfolio before change:  [-0.5443828]
curr_Stock_Price:  98.4886617872749
curr_Factors:  [98.48866179 -1.06524252 -0.93477722]
mat_Sqrt:  [[13.32872792  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303164  0.03666595  0.06798783]
Stock Position:  -0.0030316429814359913
Bond Position:  [-0.24580034]


portfolio before change:  [-0.546895]
curr_Stock_Price:  99.29704923605155
curr_Factors:  [99.29704924 -0.86704047 -0.96253689]
mat_Sqrt:  [[15.93532741  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297326 -0.01841965  0.06617029]
Stock Position:  -0.0029732560433556312
Bond Position:  [-0.25165945]


portfolio before change:  [-0.54896037]
curr_Stock_Price:  99.97053501593886
curr_Factors:  [99.97053502 -1.08691276 -0.94274764]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.54896037]
Stock Price:  100.46949982046631
PL:  [-1.01846019]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-7.71796299e-02 -6.60463355e-02  1.33588195e-01]
 [-1.23625962e-01  1.39820879e-01  4.22062044e-02]
 [-4.39803527e-02 -2.06552379e-01  3.10226658e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 4.75084962e-01 -3.11675870e-01 -1.70115200e-01]
 [-1.91568857e-02  5.10911717e-02  1.75436823e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 3.99938333e-01  4.04576252e-02  2.09837559e-03]
 [-1.78192307e-01  4.86511128e-03  2.26771121e-01]
 [-2.20052267e-01  2.17267943e-01  3.12806177e-02]
 [ 5.40919860e-02 -1.13949325e-01 -9.48587127e-04]
 [ 1.12618283e-01  9.66696754e-02 -4.99934078e-02]
 [ 2.96769271e-02  1.12908435e-01  7.39158193e-02]
 [ 1.01464311e-01 -1.07643695e-01  9.78769226e-02]
 [-1.09719517e-01 -7.66296331e-02  1.66138467e-01]
 [-1.62174444e-02  2.00679262e-01  3.56609345e-01]
 [ 3.71806903e-02 -1.07644455e-01 -7.06601367e-02]
 [ 1.63222071e-01  5.94374155e-02  2.19770846e-01]
 [-3.56448714e-02  4.69027789e-01  1.40282846e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.88615555]
curr_Stock_Price:  98.72370470803753
curr_Factors:  [98.72370471 -0.95150704 -0.95886239]
mat_Sqrt:  [[14.61364455  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00353207 -0.02088569  0.38108994]
Stock Position:  -0.0035320663938149567
Bond Position:  [-6.53745687]


portfolio before change:  [-6.89041841]
curr_Stock_Price:  99.46782700558134
curr_Factors:  [99.46782701 -0.87049369 -0.96330445]
mat_Sqrt:  [[15.89550079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0070083   0.04421524  0.12040255]
Stock Position:  -0.007008303681186619
Bond Position:  [-6.19331767]


portfolio before change:  [-6.8913857]
curr_Stock_Price:  99.38489225901272
curr_Factors:  [99.38489226 -0.5152091  -0.95329927]
mat_Sqrt:  [[22.88523046  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00187811 -0.0653176   0.08849903]
Stock Position:  -0.0018781124836763307
Bond Position:  [-6.7047297]


portfolio before change:  [-6.89376655]
curr_Stock_Price:  99.75998187138663
curr_Factors:  [99.75998187 -0.77345109 -0.98626525]
mat_Sqrt:  [[17.1680618   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221014 -0.00455813 -0.02970002]
Stock Position:  -0.0022101363356286483
Bond Position:  [-6.67328339]


portfolio before change:  [-6.89652861]
curr_Stock_Price:  100.25476063895444
curr_Factors:  [100.25476064  -0.75456437  -0.9976717 ]
mat_Sqrt:  [[17.38275255  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02487022 -0.09856056 -0.48529131]
Stock Position:  0.024870221495398
Bond Position:  [-9.38988672]


portfolio before change:  [-6.9121991]
curr_Stock_Price:  99.7190710728938
curr_Factors:  [99.71907107 -0.61634985 -0.96906967]
mat_Sqrt:  [[20.42863144  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069787  0.01615645  0.05004724]
Stock Position:  -0.0006978748532419728
Bond Position:  [-6.84260766]


portfolio before change:  [-6.9123592]
curr_Stock_Price:  97.49695394253919
curr_Factors:  [97.49695394 -0.13077096 -0.96738289]
mat_Sqrt:  [[32.5138869   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00017427 -0.02845143  0.0120735 ]
Stock Position:  -0.000174273039221207
Bond Position:  [-6.89536811]


portfolio before change:  [-6.91378074]
curr_Stock_Price:  95.76104183983679
curr_Factors:  [95.76104184 -0.25240373 -0.91764559]
mat_Sqrt:  [[29.71959599  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01350662 0.01279382 0.00598608]
Stock Position:  0.013506619462172504
Bond Position:  [-8.20718869]


portfolio before change:  [-6.90394387]
curr_Stock_Price:  96.64127123310931
curr_Factors:  [ 9.66412712e+01  1.82434108e-02 -8.82688026e-01]
mat_Sqrt:  [[40.71356271  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00323669  0.00153848  0.64691489]
Stock Position:  -0.003236691177523251
Bond Position:  [-6.59114592]


portfolio before change:  [-6.9244087]
curr_Stock_Price:  102.45487434367357
curr_Factors:  [102.45487434  -0.20317989  -0.87533575]
mat_Sqrt:  [[34.84490075  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00597095  0.06870616  0.0892349 ]
Stock Position:  -0.0059709541066086036
Bond Position:  [-6.31265534]


portfolio before change:  [-6.90113621]
curr_Stock_Price:  98.29291838603358
curr_Factors:  [98.29291839 -0.17238465 -0.82201596]
mat_Sqrt:  [[36.36298572  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00140132 -0.03603394 -0.00270606]
Stock Position:  0.0014013205048290574
Bond Position:  [-7.03887609]


portfolio before change:  [-6.9050862]
curr_Stock_Price:  96.73006763491549
curr_Factors:  [96.73006763 -0.6045153  -0.8069682 ]
mat_Sqrt:  [[23.58098781  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0044489   0.03056964 -0.14261728]
Stock Position:  0.004448898535150923
Bond Position:  [-7.33542846]


portfolio before change:  [-6.92210461]
curr_Stock_Price:  93.3170152917539
curr_Factors:  [93.31701529 -0.42375845 -0.76456786]
mat_Sqrt:  [[28.43657435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00167672 0.03570478 0.21086126]
Stock Position:  0.0016767214347599862
Bond Position:  [-7.07857125]


portfolio before change:  [-6.92019514]
curr_Stock_Price:  95.51137878954242
curr_Factors:  [95.51137879 -0.58156086 -0.79056112]
mat_Sqrt:  [[24.21866016  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00489969 -0.03403993  0.27921562]
Stock Position:  0.004899693277551937
Bond Position:  [-7.3881716]


portfolio before change:  [-6.91868426]
curr_Stock_Price:  96.19676037761019
curr_Factors:  [96.19676038 -0.39179424 -0.84016956]
mat_Sqrt:  [[28.06243574  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277186 -0.02423242  0.4739468 ]
Stock Position:  -0.0027718624836816125
Bond Position:  [-6.65204006]


portfolio before change:  [-6.91349631]
curr_Stock_Price:  93.72507683059317
curr_Factors:  [93.72507683 -0.35443767 -0.82717994]
mat_Sqrt:  [[28.75317446  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00214782 0.06346035 1.0173072 ]
Stock Position:  0.002147820221142848
Bond Position:  [-7.11480092]


portfolio before change:  [-6.92146483]
curr_Stock_Price:  90.84327092231415
curr_Factors:  [90.84327092 -0.5075329  -0.83498951]
mat_Sqrt:  [[23.7269924   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00084199 -0.03404017 -0.2015737 ]
Stock Position:  0.0008419896653836015
Bond Position:  [-6.99795393]


portfolio before change:  [-6.92427931]
curr_Stock_Price:  89.57868386347262
curr_Factors:  [89.57868386 -0.4205758  -0.84265445]
mat_Sqrt:  [[25.32740831  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0082763  0.01879576 0.62694505]
Stock Position:  0.008276301785446267
Bond Position:  [-7.66565953]


portfolio before change:  [-6.91678786]
curr_Stock_Price:  90.7154354527368
curr_Factors:  [90.71543545 -0.37716261 -0.80568995]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.91678786]
Stock Price:  91.25290041620642
PL:  [-6.91678786]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.57936856e-01 -2.82733787e-02  7.72022699e-02]
 [ 2.53908355e-02  6.74219787e-02  8.96136517e-02]
 [-4.93217908e-02 -3.05456130e-01  3.34281960e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 4.90216834e-01 -3.18751192e-01 -1.70031924e-01]
 [-8.71826677e-02  6.77854133e-02  2.83828481e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 1.77052220e-01 -2.18140142e-03  8.04992703e-03]
 [-4.93748725e-02  2.71823376e-02  1.81053367e-02]
 [-2.14435771e-01  2.03128249e-01  2.17755182e-02]
 [ 7.40384650e-02 -1.26131196e-01  1.56617701e-03]
 [ 4.27915493e-02  9.05941363e-02  3.95574549e-02]
 [ 2.93623034e-03  1.65142444e-01  6.47120139e-02]
 [-4.77600706e-02 -5.08688525e-02 -5.00866849e-02]
 [-1.55417742e-01 -1.11268691e-01  2.25631990e-01]
 [ 1.82971696e-02  1.37251547e-01  2.12116094e-01]
 [-7.76166026e-02  1.00074741e-01  4.10459323e-02]
 [-5.01402911e-02 -5.60022214e-02  2.26077195e-02]
 [-3.13022232e-02  4.89810347e-01  2.23181226e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.60308584]
curr_Stock_Price:  100.60274023058635
curr_Factors:  [100.60274023  -1.21677498  -0.96281779]
mat_Sqrt:  [[11.37691984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02135095 -0.00894083  0.22023659]
Stock Position:  -0.021350948030777344
Bond Position:  [8.75104972]


portfolio before change:  [6.60298766]
curr_Stock_Price:  100.70981815786345
curr_Factors:  [100.70981816  -1.24399719  -0.97308776]
mat_Sqrt:  [[10.96993495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00414077 0.0213207  0.2556428 ]
Stock Position:  0.004140769636053708
Bond Position:  [6.1859715]


portfolio before change:  [6.6005751]
curr_Stock_Price:  99.75365722589196
curr_Factors:  [99.75365723 -1.05626126 -0.98946494]
mat_Sqrt:  [[12.89677803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0039068  -0.09659371  0.09536134]
Stock Position:  -0.003906799982021464
Bond Position:  [6.99029269]


portfolio before change:  [6.60164412]
curr_Stock_Price:  99.92739879648786
curr_Factors:  [99.9273988  -0.84665478 -0.97808135]
mat_Sqrt:  [[16.11431128  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00235466 -0.00455813 -0.02970002]
Stock Position:  -0.0023546620483330762
Bond Position:  [6.83693937]


portfolio before change:  [6.60343158]
curr_Stock_Price:  99.89426733711765
curr_Factors:  [99.89426734 -0.71941966 -0.95988965]
mat_Sqrt:  [[18.63055535  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02400782 -0.10079798 -0.48505375]
Stock Position:  0.024007823895929176
Bond Position:  [4.2051876]


portfolio before change:  [6.56801565]
curr_Stock_Price:  98.37528933679573
curr_Factors:  [98.37528934 -0.65202979 -1.00502886]
mat_Sqrt:  [[18.76007609  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00424512  0.02143563  0.08096837]
Stock Position:  -0.004245123040927229
Bond Position:  [6.98563086]


portfolio before change:  [6.5765709]
curr_Stock_Price:  96.77142001256698
curr_Factors:  [96.77142001 -0.77494326 -0.94343471]
mat_Sqrt:  [[17.35661568  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00032646 -0.02845143  0.0120735 ]
Stock Position:  -0.00032646306111128913
Bond Position:  [6.6081632]


portfolio before change:  [6.57747425]
curr_Stock_Price:  99.06538939654197
curr_Factors:  [99.0653894  -1.18570291 -0.92921061]
mat_Sqrt:  [[11.95161739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01494685 -0.00068982  0.0229642 ]
Stock Position:  0.014946854072894502
Bond Position:  [5.09675834]


portfolio before change:  [6.59299273]
curr_Stock_Price:  100.01837443733037
curr_Factors:  [100.01837444  -0.99469635  -0.92366828]
mat_Sqrt:  [[14.68738971  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306231  0.00859581  0.05164949]
Stock Position:  -0.0030623066546893256
Bond Position:  [6.89927967]


portfolio before change:  [6.59387114]
curr_Stock_Price:  100.29483999816844
curr_Factors:  [100.29484     -0.91973372  -0.92631377]
mat_Sqrt:  [[15.83253118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01293199  0.06423479  0.06211949]
Stock Position:  -0.012931988644668223
Bond Position:  [7.89088288]


portfolio before change:  [6.58986981]
curr_Stock_Price:  100.75681829394443
curr_Factors:  [100.75681829  -1.02428239  -0.87581569]
mat_Sqrt:  [[15.0685801   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00471852 -0.03988619  0.00446787]
Stock Position:  0.004718524614065506
Bond Position:  [6.11444629]


portfolio before change:  [6.58710722]
curr_Stock_Price:  99.84733993626921
curr_Factors:  [99.84733994 -1.13125375 -0.87062936]
mat_Sqrt:  [[13.48744581  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0039448  0.02864838 0.11284641]
Stock Position:  0.003944802611681929
Bond Position:  [6.19322917]


portfolio before change:  [6.58959753]
curr_Stock_Price:  100.0860863989702
curr_Factors:  [100.0860864   -1.27878052  -0.85089379]
mat_Sqrt:  [[11.89783395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00171539 0.05222263 0.18460536]
Stock Position:  0.0017153941217171104
Bond Position:  [6.41791044]


portfolio before change:  [6.59117288]
curr_Stock_Price:  100.06899033132873
curr_Factors:  [100.06899033  -0.75258055  -0.90457606]
mat_Sqrt:  [[19.08119406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00310764 -0.01608614 -0.14288337]
Stock Position:  -0.003107635730500872
Bond Position:  [6.90215085]


portfolio before change:  [6.58880865]
curr_Stock_Price:  101.38509714725335
curr_Factors:  [101.38509715  -0.70474516  -0.91967989]
mat_Sqrt:  [[19.97539089  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0056186  -0.03518625  0.64366526]
Stock Position:  -0.00561860095121819
Bond Position:  [7.15845106]


portfolio before change:  [6.5982978]
curr_Stock_Price:  100.01477249632795
curr_Factors:  [100.0147725   -1.15041822  -0.92995037]
mat_Sqrt:  [[12.49026203  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00521518 0.04340275 0.60510817]
Stock Position:  0.005215183279596109
Bond Position:  [6.07670243]


portfolio before change:  [6.60033272]
curr_Stock_Price:  100.11362913855389
curr_Factors:  [100.11362914  -1.03878853  -0.92822811]
mat_Sqrt:  [[14.00324643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00475991  0.03164641  0.11709262]
Stock Position:  -0.004759911809000843
Bond Position:  [7.07686476]


portfolio before change:  [6.60285387]
curr_Stock_Price:  99.95570297941217
curr_Factors:  [99.95570298 -1.07310876 -0.95058127]
mat_Sqrt:  [[13.21083183  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355553 -0.01770946  0.06449353]
Stock Position:  -0.003555527879291843
Bond Position:  [6.95824916]


portfolio before change:  [6.60490018]
curr_Stock_Price:  99.86948999686442
curr_Factors:  [99.86949    -1.04174642 -0.95484709]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.60490018]
Stock Price:  98.29309001556648
PL:  [6.60490018]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.32855752e-01 -2.58322306e-02  6.55366684e-02]
 [-6.72570047e-02  1.21012976e-01  9.77711846e-02]
 [-7.18707582e-02 -3.46053460e-01  3.74649818e-03]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 7.31367908e-01 -4.44783657e-01 -1.94877511e-01]
 [ 3.12012908e-02  3.85188362e-02 -4.90585887e-03]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 7.39773539e-02 -1.94842542e-02 -3.81302598e-04]
 [-3.38810359e-02  2.88178515e-02 -1.67319635e-03]
 [-1.72753568e-01  1.59822888e-01  8.36183050e-04]
 [ 1.01943624e-01 -1.42265059e-01 -2.03159552e-03]
 [ 3.84362894e-03  7.06727027e-02  4.37080812e-02]
 [-1.22622818e-02  1.64066694e-01  4.64694257e-02]
 [-4.44704360e-02 -1.02160966e-01 -5.54844887e-02]
 [-1.51408149e-01 -1.07607958e-01  2.18679462e-01]
 [ 3.24339039e-02  7.73433290e-02  1.05090715e-01]
 [-1.00526660e-01  4.48202455e-02  8.08185194e-02]
 [-4.13015268e-02 -2.89482265e-02  2.11319667e-02]
 [-3.20964014e-02  4.78462326e-01  2.20783503e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.57616257]
curr_Stock_Price:  100.87758750831345
curr_Factors:  [100.87758751  -1.1227409   -0.96516395]
mat_Sqrt:  [[12.50342901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01760678 -0.00816887  0.18695787]
Stock Position:  -0.017606779793066716
Bond Position:  [10.35229204]


portfolio before change:  [8.5948087]
curr_Stock_Price:  99.965567616023
curr_Factors:  [99.96556762 -1.44120321 -0.92977672]
mat_Sqrt:  [[ 9.33570108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00473184  0.03826766  0.27891398]
Stock Position:  -0.004731835695826911
Bond Position:  [9.06782934]


portfolio before change:  [8.5997208]
curr_Stock_Price:  99.40661850588192
curr_Factors:  [99.40661851 -1.06055755 -0.91457314]
mat_Sqrt:  [[13.79199034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00580345 -0.10943171  0.01068772]
Stock Position:  -0.005803445868276473
Bond Position:  [9.17662173]


portfolio before change:  [8.59843435]
curr_Stock_Price:  100.0236470032543
curr_Factors:  [100.023647    -1.22588391  -0.91611805]
mat_Sqrt:  [[11.74473037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0032307  -0.00455813 -0.02970002]
Stock Position:  -0.003230704834233841
Bond Position:  [8.92158123]


portfolio before change:  [8.60287737]
curr_Stock_Price:  99.33885926258152
curr_Factors:  [99.33885926 -1.1639978  -0.94152745]
mat_Sqrt:  [[12.09765425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05621788 -0.14065294 -0.55593129]
Stock Position:  0.0562178770147844
Bond Position:  [3.0182576]


portfolio before change:  [8.63367384]
curr_Stock_Price:  99.87324101398174
curr_Factors:  [99.87324101 -1.1502185  -0.95626809]
mat_Sqrt:  [[12.15104533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00256722  0.01218073 -0.01399505]
Stock Position:  0.002567222639014518
Bond Position:  [8.37727699]


portfolio before change:  [8.63581223]
curr_Stock_Price:  99.8903073128213
curr_Factors:  [99.89030731 -1.32356008 -0.95522153]
mat_Sqrt:  [[10.22965703  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055391 -0.02845143  0.0120735 ]
Stock Position:  -0.0005539084906448954
Bond Position:  [8.69114232]


portfolio before change:  [8.63820341]
curr_Stock_Price:  99.49651550476285
curr_Factors:  [99.4965155  -0.95629353 -0.9514164 ]
mat_Sqrt:  [[14.76726182  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00497021 -0.00616146 -0.00108775]
Stock Position:  0.004970213196465955
Bond Position:  [8.14368452]


portfolio before change:  [8.64438229]
curr_Stock_Price:  100.33002080119452
curr_Factors:  [100.3300208   -0.87038237  -0.96101713]
mat_Sqrt:  [[16.07178832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208306  0.009113   -0.00477316]
Stock Position:  -0.0020830601598769154
Bond Position:  [8.85337576]


portfolio before change:  [8.64835651]
curr_Stock_Price:  99.48481948760707
curr_Factors:  [99.48481949 -0.86364077 -0.95401754]
mat_Sqrt:  [[16.15689279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01042628  0.05054043  0.0023854 ]
Stock Position:  -0.010426279117632858
Bond Position:  [9.68561301]


portfolio before change:  [8.62595447]
curr_Stock_Price:  101.86570243368612
curr_Factors:  [101.86570243  -0.90453666  -0.94440924]
mat_Sqrt:  [[16.03396675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00610302 -0.04498816 -0.00579558]
Stock Position:  0.006103022374496829
Bond Position:  [8.00426581]


portfolio before change:  [8.62268726]
curr_Stock_Price:  101.00243665991198
curr_Factors:  [101.00243666  -1.05118657  -0.97828333]
mat_Sqrt:  [[13.27224137  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00109931 0.02234867 0.12468699]
Stock Position:  0.0010993067857905014
Bond Position:  [8.51165459]


portfolio before change:  [8.62456616]
curr_Stock_Price:  100.77567988654774
curr_Factors:  [100.77567989  -1.17945702  -1.00120767]
mat_Sqrt:  [[11.38426757  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.28197428e-04 5.18824441e-02 1.32564337e-01]
Stock Position:  0.00012819742797480195
Bond Position:  [8.61164698]


portfolio before change:  [8.62678561]
curr_Stock_Price:  101.29263156197148
curr_Factors:  [101.29263156  -1.18209897  -0.99394346]
mat_Sqrt:  [[11.49567917  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00508312 -0.03230613 -0.1582818 ]
Stock Position:  -0.005083122428955078
Bond Position:  [9.14166846]


portfolio before change:  [8.63025134]
curr_Stock_Price:  101.06048624133572
curr_Factors:  [101.06048624  -1.05349334  -1.02434161]
mat_Sqrt:  [[12.65287244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00865802 -0.03402862  0.62383164]
Stock Position:  -0.008658019512182376
Bond Position:  [9.505235]


portfolio before change:  [8.63122715]
curr_Stock_Price:  101.22227741433171
curr_Factors:  [101.22227741  -0.82691262  -1.06620404]
mat_Sqrt:  [[15.24424731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00366581 0.02445811 0.29979456]
Stock Position:  0.003665805946023422
Bond Position:  [8.26016593]


portfolio before change:  [8.64213092]
curr_Stock_Price:  103.63333290969128
curr_Factors:  [103.63333291  -1.45783577  -1.08912885]
mat_Sqrt:  [[ 8.11646248  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01021041  0.01417341  0.23055274]
Stock Position:  -0.010210408132743239
Bond Position:  [9.70026954]


portfolio before change:  [8.63920757]
curr_Stock_Price:  104.15718236108954
curr_Factors:  [104.15718236  -1.88270175  -1.06913727]
mat_Sqrt:  [[ 5.44154     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0069347  -0.00915423  0.06028362]
Stock Position:  -0.006934695358341704
Bond Position:  [9.3615059]


portfolio before change:  [8.6447319]
curr_Stock_Price:  103.6980911959529
curr_Factors:  [103.6980912   -1.59760338  -1.08377421]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.6447319]
Stock Price:  104.10821287368994
PL:  [4.53651902]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [ 2.05026368e-02 -1.10718836e-01  5.78985218e-02]
 [-1.64657895e-01  1.72245553e-01  8.39408393e-02]
 [ 1.19730022e-02 -1.23452847e-02  3.09367604e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 4.07739073e-01 -2.82706922e-01 -1.75906086e-01]
 [ 6.52117650e-02  5.10152038e-03 -2.58722799e-02]
 [-1.32644529e-02 -7.79656827e-02  1.56881825e-03]
 [-7.84707803e-02 -4.16019336e-02 -3.74836597e-02]
 [ 1.04682490e-02  3.34993177e-02 -5.82869206e-02]
 [-1.80446251e-01  1.78184490e-01  2.21619062e-02]
 [ 1.13436277e-01 -1.83797968e-01  4.32962050e-02]
 [-1.63813742e-03  6.66029393e-02  4.21590161e-02]
 [ 3.71433846e-02  1.51714161e-01  9.96236322e-02]
 [-1.16305625e-02  1.65218400e-03  5.82202522e-03]
 [-1.48961163e-01 -1.05789632e-01  2.15595477e-01]
 [ 6.31903095e-03  1.21521955e-01  1.70654364e-01]
 [-4.06127370e-02  1.10470743e-01  1.83644548e-02]
 [-2.46360711e-02 -2.28629105e-02  4.67250435e-02]
 [-2.45020013e-02  5.51244546e-01  2.57826103e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.68014957]
curr_Stock_Price:  98.47380344270822
curr_Factors:  [98.47380344 -0.79612464 -0.95170135]
mat_Sqrt:  [[17.1494237   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00171798 -0.03501237  0.16516837]
Stock Position:  0.0017179804715370464
Bond Position:  [-8.84932564]


portfolio before change:  [-8.68122328]
curr_Stock_Price:  99.13673592506272
curr_Factors:  [99.13673593 -1.02759221 -0.95025652]
mat_Sqrt:  [[13.71721123  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01043041  0.05446883  0.23945985]
Stock Position:  -0.01043041329126003
Bond Position:  [-7.64718615]


portfolio before change:  [-8.71307775]
curr_Stock_Price:  102.00742129872296
curr_Factors:  [102.0074213   -0.91320853  -0.97130165]
mat_Sqrt:  [[15.49527889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115966 -0.00390392  0.08825397]
Stock Position:  0.001159655673005038
Bond Position:  [-8.83137123]


portfolio before change:  [-8.71594503]
curr_Stock_Price:  101.4390096469317
curr_Factors:  [101.43900965  -0.85743534  -0.96705237]
mat_Sqrt:  [[16.36213805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.002319   -0.00455813 -0.02970002]
Stock Position:  -0.00231899749849294
Bond Position:  [-8.48070822]


portfolio before change:  [-8.7159867]
curr_Stock_Price:  100.54260022487675
curr_Factors:  [100.54260022  -0.62484842  -0.95580163]
mat_Sqrt:  [[20.69581422  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01761385 -0.08939978 -0.5018111 ]
Stock Position:  0.017613848288638913
Bond Position:  [-10.48692881]


portfolio before change:  [-8.71841102]
curr_Stock_Price:  100.5538267673357
curr_Factors:  [100.55382677  -0.8519172   -0.94514807]
mat_Sqrt:  [[16.67028692  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00360296  0.00161324 -0.07380641]
Stock Position:  0.0036029571059278806
Bond Position:  [-9.08070214]


portfolio before change:  [-8.72381629]
curr_Stock_Price:  99.6837584085977
curr_Factors:  [99.68375841 -0.27506271 -0.91363914]
mat_Sqrt:  [[30.36531216  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00049258 -0.02465491  0.0044754 ]
Stock Position:  -0.0004925779923221981
Bond Position:  [-8.67471427]


portfolio before change:  [-8.72637509]
curr_Stock_Price:  100.47520516371534
curr_Factors:  [100.47520516  -0.29362814  -0.90759659]
mat_Sqrt:  [[30.22550933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288486 -0.01315569 -0.10693045]
Stock Position:  -0.002884856518162904
Bond Position:  [-8.43651854]


portfolio before change:  [-8.72996054]
curr_Stock_Price:  100.98686079852138
curr_Factors:  [100.9868608   -0.18988978  -0.90270616]
mat_Sqrt:  [[33.86542159  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.66709930e-05  1.05934144e-02 -1.66276361e-01]
Stock Position:  -1.667099300959509e-05
Bond Position:  [-8.72827699]


portfolio before change:  [-8.732164]
curr_Stock_Price:  102.25347573036325
curr_Factors:  [ 1.02253476e+02  3.41495568e-02 -8.80537270e-01]
mat_Sqrt:  [[43.86282163  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00390585  0.05634688  0.06322175]
Stock Position:  -0.003905853760669136
Bond Position:  [-8.33277687]


portfolio before change:  [-8.73782573]
curr_Stock_Price:  103.1696088314882
curr_Factors:  [103.16960883  -0.14057425  -0.86210893]
mat_Sqrt:  [[37.85227748  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00310492 -0.05812202  0.12351202]
Stock Position:  0.003104923737994256
Bond Position:  [-9.0581595]


portfolio before change:  [-8.74587062]
curr_Stock_Price:  101.30802847410321
curr_Factors:  [101.30802847   0.12201345  -0.86976531]
mat_Sqrt:  [[47.96222902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00018113 0.0210617  0.12026794]
Stock Position:  0.00018112619828295653
Bond Position:  [-8.76422016]


portfolio before change:  [-8.74934782]
curr_Stock_Price:  94.20873760673705
curr_Factors:  [94.20873761  0.25954277 -0.85307026]
mat_Sqrt:  [[52.03858377  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00117982 0.04797623 0.28419849]
Stock Position:  0.0011798210418684752
Bond Position:  [-8.86049727]


portfolio before change:  [-8.74891341]
curr_Stock_Price:  96.45468332262782
curr_Factors:  [96.45468332  0.12578322 -0.82902881]
mat_Sqrt:  [[47.74277339  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00021782  0.00052247  0.01660862]
Stock Position:  -0.00021782327655482826
Bond Position:  [-8.72790333]


portfolio before change:  [-8.75159852]
curr_Stock_Price:  98.76328196859671
curr_Factors:  [98.76328197  0.2133128  -0.83513318]
mat_Sqrt:  [[53.03253095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00203053 -0.03345362  0.61503389]
Stock Position:  -0.002030534744806252
Bond Position:  [-8.55105624]


portfolio before change:  [-8.7528234]
curr_Stock_Price:  98.31356980567674
curr_Factors:  [98.31356981 -0.1790211  -0.79619244]
mat_Sqrt:  [[37.0752086   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00119464 0.03842862 0.4868294 ]
Stock Position:  0.0011946363108195786
Bond Position:  [-8.87027236]


portfolio before change:  [-8.75742539]
curr_Stock_Price:  96.31785512349204
curr_Factors:  [96.31785512 -0.42539346 -0.7977872 ]
mat_Sqrt:  [[28.34563502  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00119989  0.03493392  0.05238868]
Stock Position:  -0.0011998943059252445
Bond Position:  [-8.64185415]


portfolio before change:  [-8.76122474]
curr_Stock_Price:  97.68348935221127
curr_Factors:  [97.68348935 -0.20064326 -0.78336769]
mat_Sqrt:  [[36.51494423  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042965 -0.00722989  0.13329354]
Stock Position:  -0.00042965092054635036
Bond Position:  [-8.71925494]


portfolio before change:  [-8.76320993]
curr_Stock_Price:  97.2298581656049
curr_Factors:  [97.22985817 -0.38247049 -0.76625032]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.76320993]
Stock Price:  96.96536566864667
PL:  [-8.76320993]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.31245399e-01 -6.17779943e-02  1.41882631e-01]
 [-2.59291400e-02  8.48298054e-02  4.02738949e-02]
 [-1.49912481e-02 -1.60270914e-01  4.17236950e-02]
 [-2.63646816e-02  4.11310143e-04 -1.09308556e-03]
 [ 2.56946468e-01 -2.22630412e-01 -2.04949950e-01]
 [ 7.41009520e-02  8.91147062e-03 -1.99146484e-02]
 [ 3.63144647e-03 -7.67679527e-02  2.13040679e-03]
 [-6.74857063e-02 -1.39341202e-01 -5.70179336e-02]
 [-1.07774967e-01 -4.91848069e-02 -1.19364871e-01]
 [-4.99248997e-01  4.95941914e-01  6.57683290e-02]
 [ 1.06310448e-01 -1.87394408e-01  5.44384884e-02]
 [-1.13374178e-01  7.57098377e-04 -2.84526069e-03]
 [-5.94308842e-02  1.59341552e-01 -1.06842086e-02]
 [-8.90603936e-02  5.53974345e-02  4.49264865e-02]
 [-2.25199981e-01 -1.57661083e-01  2.98353346e-01]
 [ 3.34497095e-02  4.11816193e-02  5.96901974e-02]
 [-9.16367854e-02  5.36220331e-02  8.07180772e-02]
 [-3.87343995e-02 -2.16022191e-02  2.10264531e-02]
 [-1.54667516e-02  5.30808589e-01  3.18715001e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.79699304]
curr_Stock_Price:  99.01472259924059
curr_Factors:  [99.0147226  -0.79600927 -0.99917916]
mat_Sqrt:  [[16.4459643   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00631637 -0.01953592  0.40475165]
Stock Position:  -0.006316372066772514
Bond Position:  [-4.17157921]


portfolio before change:  [-4.80499325]
curr_Stock_Price:  100.11617586891353
curr_Factors:  [100.11617587  -0.80222476  -0.9601868 ]
mat_Sqrt:  [[17.18298605  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0009031   0.02682554  0.11489021]
Stock Position:  -0.0009031008616891761
Bond Position:  [-4.71457824]


portfolio before change:  [-4.80620188]
curr_Stock_Price:  100.14922153982988
curr_Factors:  [100.14922154  -0.72207352  -0.93211342]
mat_Sqrt:  [[19.15328706  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055409 -0.05068211  0.11902609]
Stock Position:  -0.0005540882697971393
Bond Position:  [-4.75071038]


portfolio before change:  [-4.80654811]
curr_Stock_Price:  98.63032472293004
curr_Factors:  [98.63032472 -0.60881532 -0.93048692]
mat_Sqrt:  [[21.15923649  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00125606  0.00013007 -0.00311827]
Stock Position:  -0.0012560560377655155
Bond Position:  [-4.68266289]


portfolio before change:  [-4.81147839]
curr_Stock_Price:  101.62340301719833
curr_Factors:  [101.62340302  -0.64525111  -1.00478286]
mat_Sqrt:  [[19.51610224  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0107277  -0.07040192 -0.58466516]
Stock Position:  0.010727702680396686
Bond Position:  [-5.90166405]


portfolio before change:  [-4.82612257]
curr_Stock_Price:  100.39587340058387
curr_Factors:  [100.3958734   -0.83573631  -0.98308665]
mat_Sqrt:  [[16.2858746   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00431454  0.00281805 -0.05681095]
Stock Position:  0.004314535531678576
Bond Position:  [-5.25928413]


portfolio before change:  [-4.81805444]
curr_Stock_Price:  102.57064086463541
curr_Factors:  [102.57064086  -0.70444873  -0.99194266]
mat_Sqrt:  [[18.80570636  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00011083 -0.02427616  0.00607746]
Stock Position:  0.00011082667585091112
Bond Position:  [-4.829422]


portfolio before change:  [-4.81918322]
curr_Stock_Price:  103.28098270198156
curr_Factors:  [103.2809827   -0.48960844  -0.9894771 ]
mat_Sqrt:  [[23.53215354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00351528 -0.04406356 -0.16265629]
Stock Position:  -0.0035152846275702133
Bond Position:  [-4.45612117]


portfolio before change:  [-4.82699327]
curr_Stock_Price:  105.18577383989299
curr_Factors:  [105.18577384  -0.82244488  -1.03056982]
mat_Sqrt:  [[16.48932754  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0080907  -0.0155536  -0.34051475]
Stock Position:  -0.008090697734191748
Bond Position:  [-3.97596697]


portfolio before change:  [-4.83667389]
curr_Stock_Price:  106.25941402148337
curr_Factors:  [106.25941402  -0.80757655  -1.02372373]
mat_Sqrt:  [[17.02330225  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02778656  0.1568306   0.18761874]
Stock Position:  -0.02778655524067901
Bond Position:  [-1.88409081]


portfolio before change:  [-4.80124684]
curr_Stock_Price:  104.9674893829606
curr_Factors:  [104.96748938  -0.72291403  -1.03108563]
mat_Sqrt:  [[18.16780413  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0061969  -0.05925932  0.15529785]
Stock Position:  0.006196904916062543
Bond Position:  [-5.45172039]


portfolio before change:  [-4.8008816]
curr_Stock_Price:  105.24639266295847
curr_Factors:  [105.24639266  -0.91159557  -1.01257575]
mat_Sqrt:  [[15.36562508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00741495  0.00023942 -0.00811674]
Stock Position:  -0.0074149548633972995
Bond Position:  [-4.02048435]


portfolio before change:  [-4.8002682]
curr_Stock_Price:  105.02809846023425
curr_Factors:  [105.02809846  -1.35594935  -1.02265325]
mat_Sqrt:  [[ 9.73400398  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00590688  0.05038822 -0.03047907]
Stock Position:  -0.005906881490916377
Bond Position:  [-4.17987967]


portfolio before change:  [-4.80328733]
curr_Stock_Price:  105.36228872513246
curr_Factors:  [105.36228873  -1.36633335  -1.0121354 ]
mat_Sqrt:  [[ 9.76628379  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00803371  0.01751821  0.12816276]
Stock Position:  -0.008033706470146723
Bond Position:  [-3.95683763]


portfolio before change:  [-4.80931503]
curr_Stock_Price:  105.9894432014327
curr_Factors:  [105.9894432   -1.5913115   -1.03710731]
mat_Sqrt:  [[ 7.65164522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02200437 -0.04985681  0.85111905]
Stock Position:  -0.022004372381084557
Bond Position:  [-2.47708386]


portfolio before change:  [-4.81199717]
curr_Stock_Price:  106.08318764154743
curr_Factors:  [106.08318764  -1.27590437  -1.03135962]
mat_Sqrt:  [[10.55879951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00442259 0.01302277 0.17027952]
Stock Position:  0.0044225884560918595
Bond Position:  [-5.28115945]


portfolio before change:  [-4.81778263]
curr_Stock_Price:  105.07359751589763
curr_Factors:  [105.07359752  -1.35279201  -1.02854373]
mat_Sqrt:  [[ 9.71164122  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00759663  0.01695678  0.23026621]
Stock Position:  -0.007596631741262148
Bond Position:  [-4.0195772]


portfolio before change:  [-4.81762859]
curr_Stock_Price:  104.92102303334654
curr_Factors:  [104.92102303  -1.31499272  -1.0375418 ]
mat_Sqrt:  [[ 9.98090121  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00350671 -0.00683122  0.05998262]
Stock Position:  -0.0035067133596953263
Bond Position:  [-4.44970064]


portfolio before change:  [-4.82127796]
curr_Stock_Price:  105.64443659992794
curr_Factors:  [105.6444366   -1.12698756  -1.01700271]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.82127796]
Stock Price:  104.09749784809055
PL:  [-8.91877581]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.82255195e-01 -2.09072698e-02  4.20015822e-02]
 [ 8.29237584e-02 -1.79221923e-02 -5.60257876e-02]
 [-5.06107940e-03 -1.06675515e-01  2.39042289e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 4.19083858e-01 -3.51008912e-01 -3.12775656e-01]
 [ 7.64752585e-02 -1.96133668e-01 -1.43183940e-01]
 [ 5.42466241e-02 -9.38951760e-02 -1.05696159e-02]
 [-1.17826797e-01 -6.82181864e-02 -5.26968052e-02]
 [-7.80517207e-02 -3.27328002e-02 -1.19352448e-01]
 [-3.96365570e-01  3.88013003e-01  4.43598553e-02]
 [ 1.19298909e-01 -1.53418671e-01 -2.80234599e-03]
 [-2.75264071e-02  4.74227362e-02  3.48122005e-02]
 [-5.94981100e-02  1.78109986e-01 -3.48419543e-03]
 [-1.00996338e-01 -3.08503412e-02  1.08494991e-01]
 [-1.50425368e-01 -1.10896101e-01  2.28643229e-01]
 [ 3.34906114e-02  7.90221718e-02  1.10138809e-01]
 [-1.20455055e-01  2.59606035e-02  7.99866834e-02]
 [-4.59845473e-02 -4.37024021e-02  2.21792849e-02]
 [-2.78618372e-02  5.16319967e-01  2.54820438e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.16938546]
curr_Stock_Price:  101.65671690406649
curr_Factors:  [101.6567169   -1.01104814  -0.99376941]
mat_Sqrt:  [[13.69162144  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01272468 -0.00661146  0.11981882]
Stock Position:  -0.012724678490395687
Bond Position:  [15.4629345]


portfolio before change:  [14.15428704]
curr_Stock_Price:  103.1470993646083
curr_Factors:  [103.14709936  -0.83794694  -1.02862713]
mat_Sqrt:  [[15.95196546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00445242 -0.00566749 -0.15982598]
Stock Position:  0.004452416445993669
Bond Position:  [13.6950332]


portfolio before change:  [14.15547995]
curr_Stock_Price:  102.64595962735254
curr_Factors:  [102.64595963  -0.92616686  -1.06277839]
mat_Sqrt:  [[14.04604038  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00020903 -0.03373376  0.06819211]
Stock Position:  -0.00020902681253760663
Bond Position:  [14.1769357]


portfolio before change:  [14.15850652]
curr_Stock_Price:  105.12461576641991
curr_Factors:  [105.12461577  -0.83688765  -1.05332295]
mat_Sqrt:  [[15.87802148  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0023897  -0.00455813 -0.02970002]
Stock Position:  -0.0023897031023698036
Bond Position:  [14.40972314]


portfolio before change:  [14.16295214]
curr_Stock_Price:  104.77195877066167
curr_Factors:  [104.77195877  -0.92945034  -1.01843875]
mat_Sqrt:  [[14.93783239  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02317443 -0.11099876 -0.89226189]
Stock Position:  0.023174432135579077
Bond Position:  [11.7349215]


portfolio before change:  [14.16274604]
curr_Stock_Price:  104.63645610435461
curr_Factors:  [104.6364561   -0.71682346  -1.03758656]
mat_Sqrt:  [[18.10307823  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0023302  -0.06202291 -0.40846392]
Stock Position:  0.002330200927674306
Bond Position:  [13.91892208]


portfolio before change:  [14.16783662]
curr_Stock_Price:  105.32756108960005
curr_Factors:  [105.32756109  -0.82874973  -1.05285132]
mat_Sqrt:  [[16.0462323   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0030951  -0.02969226 -0.03015217]
Stock Position:  0.0030951033472250314
Bond Position:  [13.84183694]


portfolio before change:  [14.16951041]
curr_Stock_Price:  104.75016539730204
curr_Factors:  [104.7501654   -0.94269955  -1.074507  ]
mat_Sqrt:  [[13.93455295  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00935408 -0.02157248 -0.15032932]
Stock Position:  -0.009354076459346087
Bond Position:  [15.14935147]


portfolio before change:  [14.17588721]
curr_Stock_Price:  104.47338964546732
curr_Factors:  [104.47338965  -0.79683588  -1.04383113]
mat_Sqrt:  [[16.58113142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00622754 -0.01035102 -0.34047931]
Stock Position:  -0.006227536091658925
Bond Position:  [14.82649901]


portfolio before change:  [14.18362393]
curr_Stock_Price:  103.82632319296192
curr_Factors:  [103.82632319  -0.91376274  -1.03073781]
mat_Sqrt:  [[14.85325434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02540132  0.12270049  0.12654632]
Stock Position:  -0.02540131553188236
Bond Position:  [16.82094912]


portfolio before change:  [14.2103332]
curr_Stock_Price:  102.94040396628812
curr_Factors:  [102.94040397  -0.93517566  -1.04354111]
mat_Sqrt:  [[14.23115319  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00806439 -0.04851524 -0.00799431]
Stock Position:  0.008064394243599102
Bond Position:  [13.3801812]


portfolio before change:  [14.21129954]
curr_Stock_Price:  102.64538812196223
curr_Factors:  [102.64538812  -0.54607874  -1.04582585]
mat_Sqrt:  [[20.89219447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00091881  0.01499639  0.09930952]
Stock Position:  -0.0009188094966959566
Bond Position:  [14.3056111]


portfolio before change:  [14.21377734]
curr_Stock_Price:  103.8415581339356
curr_Factors:  [103.84155813  -0.53246309  -1.0236227 ]
mat_Sqrt:  [[21.90643596  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253855  0.05632332 -0.00993944]
Stock Position:  -0.002538547960719505
Bond Position:  [14.47738411]


portfolio before change:  [14.21766239]
curr_Stock_Price:  103.73706826788698
curr_Factors:  [103.73706827  -0.5716001   -1.01859948]
mat_Sqrt:  [[21.15042361  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00376571 -0.00975573  0.30950601]
Stock Position:  -0.0037657138284865046
Bond Position:  [14.6083065]


portfolio before change:  [14.22728244]
curr_Stock_Price:  102.15237190052339
curr_Factors:  [102.1523719   -0.70314327  -0.96929124]
mat_Sqrt:  [[19.18312586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00555786 -0.03506843  0.65225549]
Stock Position:  -0.0055578580176878
Bond Position:  [14.79503082]


portfolio before change:  [14.23535985]
curr_Stock_Price:  101.36462432962408
curr_Factors:  [101.36462433  -0.60770833  -0.93630145]
mat_Sqrt:  [[21.64369897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00268036 0.024989   0.31419537]
Stock Position:  0.0026803618679949025
Bond Position:  [13.96366597]


portfolio before change:  [14.24338748]
curr_Stock_Price:  103.05703712859211
curr_Factors:  [103.05703713  -0.87714965  -0.94259376]
mat_Sqrt:  [[16.70217891  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00619425  0.00820946  0.22817974]
Stock Position:  -0.006194254175906095
Bond Position:  [14.88174896]


portfolio before change:  [14.25614286]
curr_Stock_Price:  101.59851186261517
curr_Factors:  [101.59851186  -0.90267248  -0.94843341]
mat_Sqrt:  [[15.95740523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266871 -0.01381991  0.06327133]
Stock Position:  -0.0026687052365838996
Bond Position:  [14.52727934]


portfolio before change:  [14.26100604]
curr_Stock_Price:  101.13727382551377
curr_Factors:  [101.13727383  -0.94731884  -0.95473001]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.26100604]
Stock Price:  101.9446271024953
PL:  [12.31637894]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.57710699e-01 -2.82513668e-02  7.70970806e-02]
 [ 3.22348084e-02  6.86805799e-02  1.11898428e-01]
 [-2.52702221e-03 -6.64581581e-02  4.31227522e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 4.89389642e-01 -3.41567502e-01 -2.24107452e-01]
 [-7.23639202e-02  2.64990799e-02 -5.90647674e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-2.34712543e-02 -3.51639791e-02 -1.43269099e-02]
 [ 1.15095675e-02  2.92125512e-02 -7.55369703e-02]
 [-2.45369613e-01  2.33230185e-01  6.18725455e-03]
 [ 5.48596761e-02 -1.14666470e-01  1.09279739e-03]
 [ 6.85236226e-02  1.00193203e-01  9.34733995e-03]
 [-5.83360110e-03  1.70925751e-01  5.66693342e-02]
 [-4.22912741e-03 -1.39754097e-01 -5.82320474e-02]
 [-9.62876654e-02 -7.30964917e-02  1.67185183e-01]
 [-1.87432025e-02  1.83433606e-01  2.66645632e-01]
 [-4.94369279e-02  1.14363652e-01  2.37980044e-02]
 [-3.20945191e-02 -3.32926785e-02  4.01386427e-02]
 [-3.68608412e-02  4.45396189e-01  1.75858480e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.66949468]
curr_Stock_Price:  100.75128973229914
curr_Factors:  [100.75128973  -1.51688512  -0.9783876 ]
mat_Sqrt:  [[ 8.30935743  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02920837 -0.00893387  0.21993651]
Stock Position:  -0.029208368032903966
Bond Position:  [10.61227543]


portfolio before change:  [7.66198758]
curr_Stock_Price:  101.09915233209242
curr_Factors:  [101.09915233  -1.48567132  -1.00777026]
mat_Sqrt:  [[ 8.35332916  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00680559 0.02171871 0.31921507]
Stock Position:  0.00680558652027684
Bond Position:  [6.97394855]


portfolio before change:  [7.66850864]
curr_Stock_Price:  101.80112777996511
curr_Factors:  [101.80112778  -1.52582435  -1.00930153]
mat_Sqrt:  [[ 8.06791672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00056513 -0.02101591  0.12301721]
Stock Position:  0.0005651310757082883
Bond Position:  [7.61097766]


portfolio before change:  [7.67038714]
curr_Stock_Price:  101.75781735004783
curr_Factors:  [101.75781735  -1.82716661  -1.03673655]
mat_Sqrt:  [[ 5.80484259  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00653657 -0.00455813 -0.02970002]
Stock Position:  -0.006536569531228541
Bond Position:  [8.33553419]


portfolio before change:  [7.67657326]
curr_Stock_Price:  101.13027588454437
curr_Factors:  [101.13027588  -1.47843439  -1.07017061]
mat_Sqrt:  [[ 7.90744362  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05498928 -0.10801313 -0.63931618]
Stock Position:  0.054989284237141355
Bond Position:  [2.11549177]


portfolio before change:  [7.69286742]
curr_Stock_Price:  101.41697221318213
curr_Factors:  [101.41697221  -1.51199986  -1.08814004]
mat_Sqrt:  [[ 7.53154768  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01111807  0.00837974 -0.16849534]
Stock Position:  -0.011118068364058263
Bond Position:  [8.82042825]


portfolio before change:  [7.69693238]
curr_Stock_Price:  101.2497150230902
curr_Factors:  [101.24971502  -1.43223316  -1.05447595]
mat_Sqrt:  [[ 8.42228172  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00067277 -0.02845143  0.0120735 ]
Stock Position:  -0.0006727742046956588
Bond Position:  [7.76505058]


portfolio before change:  [7.69956525]
curr_Stock_Price:  100.22208675657997
curr_Factors:  [100.22208676  -0.7692463   -1.04627993]
mat_Sqrt:  [[16.31136928  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016739  -0.01111983 -0.04087069]
Stock Position:  -0.0016739031602483114
Bond Position:  [7.86732731]


portfolio before change:  [7.69932236]
curr_Stock_Price:  101.54233349932544
curr_Factors:  [101.5423335   -0.52131281  -1.07569545]
mat_Sqrt:  [[20.56246929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.53439119e-04  9.23781980e-03 -2.15485951e-01]
Stock Position:  -0.0001534391188715436
Bond Position:  [7.71490293]


portfolio before change:  [7.70124102]
curr_Stock_Price:  101.60952508008353
curr_Factors:  [101.60952508  -0.52554008  -1.07936831]
mat_Sqrt:  [[20.41416221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01166272  0.07375386  0.01765052]
Stock Position:  -0.011662720487037688
Bond Position:  [8.88628451]


portfolio before change:  [7.73602374]
curr_Stock_Price:  98.81764892277798
curr_Factors:  [98.81764892 -0.44877335 -1.0318    ]
mat_Sqrt:  [[22.48172767  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00231842 -0.03626072  0.00311745]
Stock Position:  0.0023184191024562427
Bond Position:  [7.50692301]


portfolio before change:  [7.73866209]
curr_Stock_Price:  99.1460555920355
curr_Factors:  [99.14605559 -0.67992034 -1.06270929]
mat_Sqrt:  [[17.35645424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.004207   0.03168387 0.02666536]
Stock Position:  0.004207000847128153
Bond Position:  [7.32155455]


portfolio before change:  [7.74100733]
curr_Stock_Price:  99.26838250022016
curr_Factors:  [99.2683825  -0.65859823 -1.05799905]
mat_Sqrt:  [[17.83619531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00056891 0.05405147 0.16166184]
Stock Position:  0.0005689140563783511
Bond Position:  [7.68453216]


portfolio before change:  [7.74256675]
curr_Stock_Price:  98.63215911883405
curr_Factors:  [98.63215912 -1.04020996 -1.05656038]
mat_Sqrt:  [[12.11721324  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162778 -0.04419413 -0.16611982]
Stock Position:  -0.0016277777054094977
Bond Position:  [7.90311798]


portfolio before change:  [7.7454595]
curr_Stock_Price:  98.0689818555183
curr_Factors:  [98.06898186 -1.23764808 -1.03710009]
mat_Sqrt:  [[10.08372718  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00635167 -0.02311514  0.47693279]
Stock Position:  -0.006351666895752118
Bond Position:  [8.36836101]


portfolio before change:  [7.74979252]
curr_Stock_Price:  97.71621379312451
curr_Factors:  [97.71621379 -1.29253246 -1.01532126]
mat_Sqrt:  [[ 9.72027381  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00415851 0.0580068  0.76066577]
Stock Position:  0.004158508833880304
Bond Position:  [7.34343878]


portfolio before change:  [7.75511998]
curr_Stock_Price:  98.55578545097161
curr_Factors:  [98.55578545 -1.16341825 -1.01488356]
mat_Sqrt:  [[11.15983232  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00373001  0.03616496  0.06788908]
Stock Position:  -0.003730013374010974
Bond Position:  [8.12273437]


portfolio before change:  [7.76045172]
curr_Stock_Price:  97.67085264812181
curr_Factors:  [97.67085265 -1.18218525 -1.00951943]
mat_Sqrt:  [[10.91238625  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226906 -0.01052807  0.11450438]
Stock Position:  -0.0022690606524986548
Bond Position:  [7.98207281]


portfolio before change:  [7.76027698]
curr_Stock_Price:  98.62742214904901
curr_Factors:  [98.62742215 -1.24273655 -1.02081618]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.76027698]
Stock Price:  98.43677422800528
PL:  [7.76027698]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.21473072e-01 -5.63273673e-02  1.25203432e-01]
 [-3.29068048e-01  2.48055818e-01  1.37936284e-02]
 [-8.63370724e-02 -3.71257879e-01 -4.13972160e-03]
 [-2.17469139e-02  6.02855325e-02  3.88281500e-02]
 [-2.13159955e-02 -3.88239578e-02 -1.14344659e-01]
 [-1.68747333e-01  8.74926641e-02  4.68699224e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 3.26171516e-01  2.71332895e-02  4.22223561e-04]
 [-3.72299415e-01 -1.92154154e-02  4.92769481e-01]
 [-1.28347555e-02  6.48393755e-02 -2.28816091e-02]
 [-1.22857705e-01  1.11041306e-03  3.88685107e-02]
 [ 1.19527429e-01 -2.49730308e-02 -2.15430408e-01]
 [ 3.14331092e-02  1.15817460e-01  7.73002292e-02]
 [ 1.31437475e-01 -1.30746999e-01  1.25334352e-01]
 [-1.93238000e-01 -2.02001826e-01  8.15299661e-02]
 [-9.86755211e-03  1.77433994e-01  3.06849863e-01]
 [-2.63059177e-02  8.82130227e-02  9.42553845e-03]
 [ 6.63953177e-02  4.84573580e-02  1.59373351e-01]
 [-3.45782031e-02  4.73512594e-01  1.63392662e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.82690141]
curr_Stock_Price:  99.01055639805267
curr_Factors:  [99.0105564  -0.69093066 -0.96465466]
mat_Sqrt:  [[18.90905952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0051494  -0.01781228  0.35717054]
Stock Position:  -0.005149404413009382
Bond Position:  [-4.31705601]


portfolio before change:  [-4.82579108]
curr_Stock_Price:  98.58531838220829
curr_Factors:  [98.58531838 -0.69340169 -0.95029704]
mat_Sqrt:  [[19.05298193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01678728  0.07844214  0.03934938]
Stock Position:  -0.016787275742150116
Bond Position:  [-3.17081216]


portfolio before change:  [-4.83704556]
curr_Stock_Price:  99.2085092372846
curr_Factors:  [99.20850924 -1.02635773 -0.94786714]
mat_Sqrt:  [[13.77697779  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00702389 -0.11740205 -0.01180947]
Stock Position:  -0.007023886390540621
Bond Position:  [-4.14021626]


portfolio before change:  [-4.83307067]
curr_Stock_Price:  98.49521776235369
curr_Factors:  [98.49521776 -0.80007578 -0.92197566]
mat_Sqrt:  [[17.60101476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069681  0.01906396  0.1107659 ]
Stock Position:  -0.0006968112578145411
Bond Position:  [-4.76443809]


portfolio before change:  [-4.83389517]
curr_Stock_Price:  97.96887906172729
curr_Factors:  [97.96887906 -0.31473538 -0.90910601]
mat_Sqrt:  [[28.81247556  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00158469 -0.01227721 -0.32619349]
Stock Position:  -0.0015846931120960636
Bond Position:  [-4.67864456]


portfolio before change:  [-4.83134103]
curr_Stock_Price:  95.61893131038347
curr_Factors:  [ 9.56189313e+01 -5.11294070e-02 -8.98232899e-01]
mat_Sqrt:  [[37.00335265  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00424072  0.02766761  0.13370684]
Stock Position:  -0.00424072383344648
Bond Position:  [-4.42584755]


portfolio before change:  [-4.83190291]
curr_Stock_Price:  95.49048071813479
curr_Factors:  [95.49048072 -0.27835897 -0.8842248 ]
mat_Sqrt:  [[29.85770097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018978 -0.02845143  0.0120735 ]
Stock Position:  -0.00018977663059836466
Bond Position:  [-4.81378104]


portfolio before change:  [-4.8332905]
curr_Stock_Price:  96.46004727943814
curr_Factors:  [96.46004728 -0.29187802 -0.86391023]
mat_Sqrt:  [[30.36651889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01076706 0.0085803  0.00120449]
Stock Position:  0.010767064916939005
Bond Position:  [-5.87188209]


portfolio before change:  [-4.86484473]
curr_Stock_Price:  93.66577801574994
curr_Factors:  [93.66577802 -0.29194646 -0.82612805]
mat_Sqrt:  [[30.62015288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00888988 -0.00607645  1.40573417]
Stock Position:  -0.00888987742026192
Bond Position:  [-4.03216745]


portfolio before change:  [-4.86670728]
curr_Stock_Price:  93.76188488464744
curr_Factors:  [93.76188488 -0.35159159 -0.84176065]
mat_Sqrt:  [[28.42889876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055687  0.02050401 -0.06527486]
Stock Position:  -0.0005568734489676484
Bond Position:  [-4.81449378]


portfolio before change:  [-4.86687097]
curr_Stock_Price:  91.89415563688512
curr_Factors:  [91.89415564 -0.11438816 -0.77501099]
mat_Sqrt:  [[37.7595448   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304281  0.00035114  0.11088104]
Stock Position:  -0.0030428076772622474
Bond Position:  [-4.58725472]


portfolio before change:  [-4.86573044]
curr_Stock_Price:  91.14238911877251
curr_Factors:  [91.14238912 -0.31074897 -0.77044534]
mat_Sqrt:  [[30.91460376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00242306 -0.00789717 -0.61456299]
Stock Position:  0.0024230645404781466
Bond Position:  [-5.08657433]


portfolio before change:  [-4.86092087]
curr_Stock_Price:  93.65217379966154
curr_Factors:  [93.6521738  -0.51232353 -0.7774008 ]
mat_Sqrt:  [[25.7868149   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00194682 0.0366247  0.22051604]
Stock Position:  0.0019468223033118877
Bond Position:  [-5.04324502]


portfolio before change:  [-4.86186095]
curr_Stock_Price:  93.81700534847587
curr_Factors:  [93.81700535 -0.30134903 -0.79911999]
mat_Sqrt:  [[31.21432475  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00492227 -0.04134583  0.35754402]
Stock Position:  0.004922271133984355
Bond Position:  [-5.32365368]


portfolio before change:  [-4.86764132]
curr_Stock_Price:  92.91309506382174
curr_Factors:  [92.91309506 -0.24120729 -0.77672487]
mat_Sqrt:  [[33.57334469  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00541535 -0.06387859  0.2325823 ]
Stock Position:  -0.005415350546771771
Bond Position:  [-4.36448434]


portfolio before change:  [-4.8782067]
curr_Stock_Price:  94.66258929205979
curr_Factors:  [94.66258929 -0.23393417 -0.82585746]
mat_Sqrt:  [[32.80323873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00174828 0.05610956 0.87535725]
Stock Position:  0.00174827981113028
Bond Position:  [-5.04370339]


portfolio before change:  [-4.8774102]
curr_Stock_Price:  95.83950574660211
curr_Factors:  [95.83950575 -0.53017027 -0.83764934]
mat_Sqrt:  [[24.40664333  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090567  0.02789541  0.02688844]
Stock Position:  -0.0009056668305516559
Bond Position:  [-4.79061154]


portfolio before change:  [-4.87676865]
curr_Stock_Price:  93.8085629670153
curr_Factors:  [93.80856297 -0.68851158 -0.83092291]
mat_Sqrt:  [[20.52865383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00487993 0.01532356 0.45464781]
Stock Position:  0.004879931782932311
Bond Position:  [-5.33454804]


portfolio before change:  [-4.88014647]
curr_Stock_Price:  93.38970053093588
curr_Factors:  [93.38970053 -0.59914555 -0.83014091]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.88014647]
Stock Price:  94.27600792696775
PL:  [-4.88014647]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-9.29780776e-02 -6.38722645e-02  1.39775806e-01]
 [-4.98314256e-01  3.47747801e-01  3.65636272e-02]
 [-4.12784794e-01 -9.02023288e-01 -2.30082310e-01]
 [-4.15520763e-02  3.72749494e-01  2.50298820e-01]
 [-1.18119222e-01  8.51022468e-02 -4.17901897e-03]
 [-1.83338143e-01  9.12531825e-02  4.60062167e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 4.01136585e-01  4.24201573e-02 -5.95768853e-03]
 [-3.29886452e-01 -1.36890831e-02  4.33305672e-01]
 [ 2.33957585e-03  4.52427602e-02 -3.85642532e-02]
 [-2.58556596e-02 -6.61731764e-02 -2.80379153e-03]
 [ 1.18097030e-01  7.80071029e-02 -8.75479074e-02]
 [ 9.17698120e-03  1.61421870e-01  7.05884713e-02]
 [-4.14978629e-02 -7.27086749e-02 -7.18128469e-02]
 [-1.56237463e-01 -1.11196564e-01  2.24765940e-01]
 [ 1.25876489e-02  8.06716288e-02  8.53695369e-02]
 [-1.26375960e-01  3.28443698e-02  6.45908879e-02]
 [-4.58375023e-02 -4.26533659e-02  2.17764193e-02]
 [-3.00181600e-02  4.98665567e-01  2.36280923e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.44303379]
curr_Stock_Price:  98.78543105099618
curr_Factors:  [98.78543105 -0.91859604 -1.04714064]
mat_Sqrt:  [[13.83516394  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00477737 -0.02019818  0.39874147]
Stock Position:  -0.004777365542497936
Bond Position:  [-5.97109967]


portfolio before change:  [-6.43873838]
curr_Stock_Price:  97.57380730967343
curr_Factors:  [97.57380731 -0.82010407 -1.04048228]
mat_Sqrt:  [[15.18066733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03174247  0.10996751  0.10430585]
Stock Position:  -0.03174247325488676
Bond Position:  [-3.34150441]


portfolio before change:  [-6.35315403]
curr_Stock_Price:  94.85127749163719
curr_Factors:  [94.85127749 -0.28901379 -1.02675459]
mat_Sqrt:  [[25.44557298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01898327 -0.28524481 -0.65636079]
Stock Position:  -0.018983274244218865
Bond Position:  [-4.55256622]


portfolio before change:  [-6.32952722]
curr_Stock_Price:  93.54670328818277
curr_Factors:  [93.54670329 -0.3593217  -1.01737519]
mat_Sqrt:  [[23.61220918  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00081163 0.11787374 0.71403286]
Stock Position:  0.0008116270164076489
Bond Position:  [-6.40545225]


portfolio before change:  [-6.32938993]
curr_Stock_Price:  95.68913548414712
curr_Factors:  [95.68913548 -0.19720737 -1.0455319 ]
mat_Sqrt:  [[27.61517641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00422865  0.02691169 -0.01192158]
Stock Position:  -0.004228650506324128
Bond Position:  [-5.92475402]


portfolio before change:  [-6.32783127]
curr_Stock_Price:  94.97022288257456
curr_Factors:  [94.97022288 -0.47737119 -1.03407781]
mat_Sqrt:  [[20.94949204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0081907   0.02885679  0.13124293]
Stock Position:  -0.008190700558282589
Bond Position:  [-5.54995862]


portfolio before change:  [-6.32141048]
curr_Stock_Price:  94.01689034179505
curr_Factors:  [94.01689034 -0.51736463 -1.06265376]
mat_Sqrt:  [[19.36478201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00029261 -0.02845143  0.0120735 ]
Stock Position:  -0.0002926081938312124
Bond Position:  [-6.29390036]


portfolio before change:  [-6.32284383]
curr_Stock_Price:  93.53736712586424
curr_Factors:  [93.53736713 -0.59928061 -1.04488881]
mat_Sqrt:  [[18.06888835  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02219372  0.01341443 -0.01699563]
Stock Position:  0.022193715143725843
Bond Position:  [-8.39878552]


portfolio before change:  [-6.29895891]
curr_Stock_Price:  94.70818905715801
curr_Factors:  [94.70818906 -0.59457283 -1.09241309]
mat_Sqrt:  [[17.52826214  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01379439 -0.00432887  1.23610047]
Stock Position:  -0.013794393947488687
Bond Position:  [-4.99251684]


portfolio before change:  [-6.30432071]
curr_Stock_Price:  95.00639163299631
curr_Factors:  [95.00639163 -0.27258217 -1.10976316]
mat_Sqrt:  [[23.84557935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018302  0.01430702 -0.11001308]
Stock Position:  -0.0001830174166649136
Bond Position:  [-6.28693289]


portfolio before change:  [-6.30604846]
curr_Stock_Price:  95.85776548311732
curr_Factors:  [95.85776548 -0.13623065 -1.07555821]
mat_Sqrt:  [[28.53343675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098609 -0.0209258  -0.00799844]
Stock Position:  -0.000986091003108902
Bond Position:  [-6.21152398]


portfolio before change:  [-6.30789002]
curr_Stock_Price:  96.15031460599974
curr_Factors:  [ 9.61503146e+01 -7.32722435e-02 -1.10186576e+00]
mat_Sqrt:  [[29.68894472  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00344372  0.02466801 -0.24974981]
Stock Position:  0.0034437236975179935
Bond Position:  [-6.63900513]


portfolio before change:  [-6.30605119]
curr_Stock_Price:  97.16630196140545
curr_Factors:  [97.16630196 -0.31892536 -1.08402629]
mat_Sqrt:  [[23.89029507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00116171 0.05104608 0.20136926]
Stock Position:  0.001161713878745939
Bond Position:  [-6.41893064]


portfolio before change:  [-6.30669897]
curr_Stock_Price:  97.99022182474341
curr_Factors:  [97.99022182 -0.39843547 -1.06302585]
mat_Sqrt:  [[22.72365332  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0025539  -0.0229925  -0.20486206]
Stock Position:  -0.0025538995840752067
Bond Position:  [-6.05644178]


portfolio before change:  [-6.31135593]
curr_Stock_Price:  99.22075565609993
curr_Factors:  [ 9.92207557e+01 -8.30011438e-02 -1.07537997e+00]
mat_Sqrt:  [[31.154731    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00363439 -0.03516344  0.64119467]
Stock Position:  -0.0036343883341495445
Bond Position:  [-5.95074917]


portfolio before change:  [-6.31428265]
curr_Stock_Price:  99.61665359530024
curr_Factors:  [99.6166536  -0.53189018 -1.13523297]
mat_Sqrt:  [[18.80656864  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00170667 0.02551061 0.24353553]
Stock Position:  0.0017066677992577542
Bond Position:  [-6.48429518]


portfolio before change:  [-6.31555773]
curr_Stock_Price:  99.81950224619014
curr_Factors:  [99.81950225 -0.50415263 -1.1009932 ]
mat_Sqrt:  [[20.04977142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00560322  0.0103863   0.18425982]
Stock Position:  -0.005603224112179572
Bond Position:  [-5.75624669]


portfolio before change:  [-6.32773367]
curr_Stock_Price:  101.73566756376256
curr_Factors:  [101.73566756  -0.65974081  -1.06796767]
mat_Sqrt:  [[18.07752546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00235064 -0.01348818  0.06212206]
Stock Position:  -0.0023506377901756047
Bond Position:  [-6.08858997]


portfolio before change:  [-6.32697946]
curr_Stock_Price:  100.76718667843723
curr_Factors:  [100.76718668  -1.00038213  -1.03416102]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.32697946]
Stock Price:  101.0355205612329
PL:  [-7.36250003]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.74680649e-01 -2.01700380e-02  3.84785465e-02]
 [ 7.00204446e-02  1.59793676e-02  1.33759688e-03]
 [-3.33314136e-03 -7.51994514e-02  3.23489977e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.19754100e-01 -2.72098171e-01 -2.47385647e-01]
 [ 1.25930349e-02 -1.51890791e-01 -1.37954040e-01]
 [ 2.89406631e-02 -8.19497755e-02 -4.24882351e-03]
 [-1.35469299e-01 -3.82468551e-02 -5.13128104e-02]
 [-3.63971565e-02 -1.17401339e-02 -1.24177502e-01]
 [-4.47430318e-01  4.38289090e-01  4.81955069e-02]
 [ 1.10266755e-01 -1.73324627e-01  3.19915487e-02]
 [-8.51616542e-02  1.60930286e-02  9.53027354e-03]
 [-6.74359190e-02  1.58243977e-01 -2.04984806e-02]
 [-1.27427560e-01  4.61747484e-04  1.63732688e-01]
 [-1.52862941e-01 -1.21953571e-01  2.57491254e-01]
 [ 6.29367266e-03  1.76930698e-02 -1.41996346e-02]
 [-9.38749728e-02  4.96182272e-02  8.29122129e-02]
 [-3.74647342e-02 -1.70525676e-02  2.03954360e-02]
 [-2.29591964e-02  5.00344521e-01  2.70209549e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.34568273]
curr_Stock_Price:  101.54197607890521
curr_Factors:  [101.54197608  -0.89921058  -1.03069869]
mat_Sqrt:  [[14.73997214  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01135328 -0.00637833  0.10976858]
Stock Position:  -0.011353280423465095
Bond Position:  [14.49851726]


portfolio before change:  [13.34044357]
curr_Stock_Price:  102.32274159841757
curr_Factors:  [102.3227416   -1.03159236  -1.04181583]
mat_Sqrt:  [[12.86774459  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00549483 0.00505312 0.00381579]
Stock Position:  0.005494829761959884
Bond Position:  [12.77819752]


portfolio before change:  [13.34166739]
curr_Stock_Price:  101.96401741088161
curr_Factors:  [101.96401741  -1.10054482  -1.05619324]
mat_Sqrt:  [[11.79743244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0001126  -0.02378015  0.09228269]
Stock Position:  0.00011260320079997603
Bond Position:  [13.33018591]


portfolio before change:  [13.34508535]
curr_Stock_Price:  102.71890999878329
curr_Factors:  [102.71891     -1.32674473  -1.06929104]
mat_Sqrt:  [[ 9.35546307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00405579 -0.00455813 -0.02970002]
Stock Position:  -0.004055786114929887
Bond Position:  [13.76169128]


portfolio before change:  [13.34708976]
curr_Stock_Price:  103.07308213830851
curr_Factors:  [103.07308214  -1.10397812  -1.09922401]
mat_Sqrt:  [[11.38431063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02303444 -0.086045   -0.70572239]
Stock Position:  0.023034435778890864
Bond Position:  [10.97285947]


portfolio before change:  [13.37812392]
curr_Stock_Price:  104.30126946448001
curr_Factors:  [104.30126946  -1.10767059  -1.0904506 ]
mat_Sqrt:  [[11.57864368  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168314 -0.04803209 -0.39354448]
Stock Position:  -0.0016831435048475652
Bond Position:  [13.55367792]


portfolio before change:  [13.38119015]
curr_Stock_Price:  104.49294169103892
curr_Factors:  [104.49294169  -1.20154662  -1.04715262]
mat_Sqrt:  [[11.02781031  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00235382 -0.02591479 -0.01212071]
Stock Position:  0.0023538164690247057
Bond Position:  [13.13523294]


portfolio before change:  [13.3844917]
curr_Stock_Price:  104.50030575484324
curr_Factors:  [104.50030575  -1.01311057  -1.08027948]
mat_Sqrt:  [[12.88160014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01140627 -0.01209472 -0.14638117]
Stock Position:  -0.01140627025824238
Bond Position:  [14.57645043]


portfolio before change:  [13.39957371]
curr_Stock_Price:  103.49757358215066
curr_Factors:  [103.49757358  -0.9755256   -1.07244837]
mat_Sqrt:  [[13.35077186  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00464751 -0.00371256 -0.35424385]
Stock Position:  -0.004647514958270054
Bond Position:  [13.88058023]


portfolio before change:  [13.3986077]
curr_Stock_Price:  104.45218717834335
curr_Factors:  [104.45218718  -1.03502073  -1.07442017]
mat_Sqrt:  [[12.670653    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03364277  0.13859918  0.13748837]
Stock Position:  -0.03364277083989359
Bond Position:  [16.9126687]


portfolio before change:  [13.38843217]
curr_Stock_Price:  104.88033942635651
curr_Factors:  [104.88033943  -1.10991349  -1.07126055]
mat_Sqrt:  [[11.841923    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0094851  -0.05481006  0.09126298]
Stock Position:  0.009485096283997558
Bond Position:  [12.39363205]


portfolio before change:  [13.38617542]
curr_Stock_Price:  104.31571162431744
curr_Factors:  [104.31571162  -1.47149568  -1.07586521]
mat_Sqrt:  [[ 8.16666886  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01013887  0.00508906  0.02718722]
Stock Position:  -0.0101388676934553
Bond Position:  [14.44381862]


portfolio before change:  [13.38317426]
curr_Stock_Price:  104.96791079858552
curr_Factors:  [104.9679108   -1.11083892  -1.14050411]
mat_Sqrt:  [[11.04868771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00611243  0.05004114 -0.05847646]
Stock Position:  -0.006112428341797813
Bond Position:  [14.02478309]


portfolio before change:  [13.37692809]
curr_Stock_Price:  106.56348107147802
curr_Factors:  [106.56348107  -0.93685327  -1.14735149]
mat_Sqrt:  [[13.25713796  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.09005541e-03  1.46017375e-04  4.67083784e-01]
Stock Position:  -0.007090055414306527
Bond Position:  [14.13246907]


portfolio before change:  [13.38296972]
curr_Stock_Price:  106.20973642519071
curr_Factors:  [106.20973643  -1.08323109  -1.12536458]
mat_Sqrt:  [[11.66765058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00886653 -0.03856511  0.73455088]
Stock Position:  -0.008866531097189725
Bond Position:  [14.32468165]


portfolio before change:  [13.37630101]
curr_Stock_Price:  107.36580555104909
curr_Factors:  [107.36580555  -1.17818121  -1.14747345]
mat_Sqrt:  [[10.4917275   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00036715  0.00559504 -0.04050761]
Stock Position:  0.00036714806859718466
Bond Position:  [13.33688186]


portfolio before change:  [13.37933002]
curr_Stock_Price:  106.53337029801288
curr_Factors:  [106.5333703   -1.23781011  -1.14251996]
mat_Sqrt:  [[ 9.85647113  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00767713  0.01569066  0.23652546]
Stock Position:  -0.00767713414091524
Bond Position:  [14.19720099]


portfolio before change:  [13.38922449]
curr_Stock_Price:  105.70692574068454
curr_Factors:  [105.70692574  -1.42356284  -1.17549196]
mat_Sqrt:  [[ 7.85865609  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429359 -0.0053925   0.0581825 ]
Stock Position:  -0.004293587642082044
Bond Position:  [13.84308644]


portfolio before change:  [13.39569938]
curr_Stock_Price:  105.00502264370773
curr_Factors:  [105.00502264  -1.32036141  -1.17470844]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.39569938]
Stock Price:  105.24390403381828
PL:  [8.15179534]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.58478781e-01 -2.83261243e-02  7.74543271e-02]
 [-5.30399193e-02  1.13534832e-01  9.97899259e-02]
 [-6.19331312e-02 -2.88948039e-01  1.65642387e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 1.66564482e-01 -1.43979441e-01 -1.31812746e-01]
 [-9.49748305e-02  6.95428617e-02  3.23705188e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 4.09987762e-01  4.21272754e-02  3.00055038e-03]
 [-3.34903044e-01 -1.43777145e-02  4.40516444e-01]
 [-2.95892452e-02  6.29490124e-02 -3.01863930e-02]
 [-2.92720886e-02 -6.38150631e-02 -3.31272523e-03]
 [ 1.34993464e-01  5.15501535e-02 -1.36732261e-01]
 [ 4.07296252e-02  1.30380935e-01  9.50729034e-02]
 [ 1.24159950e-01 -1.63109187e-01  9.88469178e-02]
 [-5.21554128e-02 -4.86761885e-02  1.34908621e-01]
 [-1.66969273e-02  1.66674078e-01  2.45639165e-01]
 [-4.51721762e-02  1.07179418e-01  1.92652619e-02]
 [-4.88434766e-03  2.47527001e-03  7.19616996e-02]
 [-3.20372953e-02  4.86377866e-01  2.05962708e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.41703557]
curr_Stock_Price:  100.57682364575915
curr_Factors:  [100.57682365  -1.13583893  -0.99998302]
mat_Sqrt:  [[11.88289416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02048321 -0.00895751  0.22095564]
Stock Position:  -0.020483213633966376
Bond Position:  [8.47717213]


portfolio before change:  [6.42990663]
curr_Stock_Price:  100.0519302181415
curr_Factors:  [100.05193022  -1.23316649  -1.03615015]
mat_Sqrt:  [[10.34364905  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00287509  0.03590287  0.28467288]
Stock Position:  -0.0028750906993365126
Bond Position:  [6.717565]


portfolio before change:  [6.43352277]
curr_Stock_Price:  99.3783719618762
curr_Factors:  [99.37837196 -0.84425185 -1.01036933]
mat_Sqrt:  [[15.55392975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00424411 -0.09137339  0.04725316]
Stock Position:  -0.004244109201483968
Bond Position:  [6.85529543]


portfolio before change:  [6.43030387]
curr_Stock_Price:  100.54067492944098
curr_Factors:  [100.54067493  -0.54761034  -1.04949247]
mat_Sqrt:  [[20.35770705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00186385 -0.00455813 -0.02970002]
Stock Position:  -0.0018638522065793606
Bond Position:  [6.61769683]


portfolio before change:  [6.43430641]
curr_Stock_Price:  99.28096701981369
curr_Factors:  [99.28096702 -0.46114654 -1.02585536]
mat_Sqrt:  [[22.44239891  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00605732 -0.0455303  -0.37602507]
Stock Position:  0.00605731968531792
Bond Position:  [5.83292985]


portfolio before change:  [6.42841025]
curr_Stock_Price:  98.0668034333518
curr_Factors:  [98.06680343 -0.35271556 -0.98196018]
mat_Sqrt:  [[25.81545062  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00335348  0.02199138  0.09234408]
Stock Position:  -0.003353481536746453
Bond Position:  [6.75727546]


portfolio before change:  [6.43330506]
curr_Stock_Price:  97.11099498366713
curr_Factors:  [97.11099498 -0.45758846 -0.96973775]
mat_Sqrt:  [[23.3017485   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024317 -0.02845143  0.0120735 ]
Stock Position:  -0.00024317033065822264
Bond Position:  [6.45691958]


portfolio before change:  [6.43530035]
curr_Stock_Price:  95.54480338405335
curr_Factors:  [95.54480338 -0.42029849 -0.96059014]
mat_Sqrt:  [[24.01567284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01714247 0.01332181 0.00855974]
Stock Position:  0.017142470702204125
Bond Position:  [4.79742635]


portfolio before change:  [6.41908523]
curr_Stock_Price:  94.52892747412515
curr_Factors:  [94.52892747 -0.5740737  -0.94424978]
mat_Sqrt:  [[20.7092905   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01184754 -0.00454663  1.2566708 ]
Stock Position:  -0.011847544093635719
Bond Position:  [7.53902087]


portfolio before change:  [6.41420067]
curr_Stock_Price:  95.10031605945666
curr_Factors:  [95.10031606 -0.71466758 -0.95126831]
mat_Sqrt:  [[17.97526058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189848  0.01990623 -0.08611338]
Stock Position:  -0.0018984804253520471
Bond Position:  [6.59474676]


portfolio before change:  [6.41573283]
curr_Stock_Price:  95.16180218800275
curr_Factors:  [95.16180219 -0.79265523 -0.93507251]
mat_Sqrt:  [[16.90908206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00186858 -0.02018009 -0.00945028]
Stock Position:  -0.0018685812455129865
Bond Position:  [6.59355039]


portfolio before change:  [6.41922975]
curr_Stock_Price:  94.17264393084888
curr_Factors:  [94.17264393 -0.70209314 -0.91926645]
mat_Sqrt:  [[18.61132268  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00582517  0.01630159 -0.39005908]
Stock Position:  0.005825170487505635
Bond Position:  [5.87065804]


portfolio before change:  [6.42645241]
curr_Stock_Price:  95.16056581071904
curr_Factors:  [95.16056581 -0.86275232 -0.93894724]
mat_Sqrt:  [[15.70322435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00404393 0.04123007 0.27121653]
Stock Position:  0.004043928827521525
Bond Position:  [6.04162985]


portfolio before change:  [6.42641608]
curr_Stock_Price:  94.77803478535107
curr_Factors:  [94.77803479 -0.64054141 -0.95186952]
mat_Sqrt:  [[19.28112703  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0072675  -0.05157965  0.28198274]
Stock Position:  0.007267496917194124
Bond Position:  [5.737617]


portfolio before change:  [6.43710614]
curr_Stock_Price:  96.05157883541342
curr_Factors:  [96.05157884 -1.02021541 -1.01181081]
mat_Sqrt:  [[12.58944922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00205522 -0.01539276  0.38485674]
Stock Position:  -0.002055222531742831
Bond Position:  [6.63451351]


portfolio before change:  [6.4372171]
curr_Stock_Price:  96.80472268764635
curr_Factors:  [96.80472269 -0.85868363 -1.01291752]
mat_Sqrt:  [[14.89602841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00253406 0.05270697 0.70074016]
Stock Position:  0.00253406226076154
Bond Position:  [6.1919079]


portfolio before change:  [6.43835205]
curr_Stock_Price:  96.6416594735861
curr_Factors:  [96.64165947 -0.73466944 -1.03644647]
mat_Sqrt:  [[16.44290375  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00233975  0.03389311  0.05495843]
Stock Position:  -0.0023397516028060045
Bond Position:  [6.66446953]


portfolio before change:  [6.44013862]
curr_Stock_Price:  96.59027064662673
curr_Factors:  [96.59027065 -0.55310782 -1.00456675]
mat_Sqrt:  [[20.34435443  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00048508 0.00078275 0.2052867 ]
Stock Position:  0.0004850821872515489
Bond Position:  [6.3932844]


portfolio before change:  [6.44242894]
curr_Stock_Price:  98.016430748675
curr_Factors:  [98.01643075 -0.83256358 -1.01581734]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.44242894]
Stock Price:  97.65051142484377
PL:  [6.44242894]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.84515981e-01 -3.08603295e-02  8.95646237e-02]
 [ 3.71635568e-02  6.29673059e-02  9.89083189e-02]
 [-2.31618759e-02 -1.66244758e-01  3.41276309e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.29342988e-01 -2.58360929e-01 -2.06676990e-01]
 [-3.06760023e-02  2.65910143e-03 -5.94500320e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [ 5.74484847e-03  2.42375777e-02 -8.39893564e-02]
 [-2.90659745e-01  2.81083425e-01  3.33430419e-02]
 [ 1.16451017e-01 -1.67524130e-01  1.87129409e-02]
 [-3.66624805e-02  4.24564955e-02  3.08046261e-02]
 [-3.34241132e-02  1.73754032e-01  2.54070216e-02]
 [-4.84579489e-02 -7.40614758e-02 -4.39425597e-02]
 [-1.52505200e-01 -1.07315724e-01  2.16974835e-01]
 [ 3.80581358e-02  9.65442003e-02  1.57887251e-01]
 [-1.05365056e-01  5.74633121e-02  5.97238763e-02]
 [-4.33619875e-02 -3.60861096e-02  2.20009651e-02]
 [-3.15237473e-02  4.85499133e-01  2.27380485e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.15691244]
curr_Stock_Price:  100.12269231424189
curr_Factors:  [100.12269231  -0.882733    -0.98232955]
mat_Sqrt:  [[15.50765556  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01721927 -0.00975889  0.25550294]
Stock Position:  -0.017219268778547025
Bond Position:  [4.88095199]


portfolio before change:  [3.14073877]
curr_Stock_Price:  101.13284331044268
curr_Factors:  [101.13284331  -1.40300835  -0.98278622]
mat_Sqrt:  [[ 9.30582329  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00633785 0.01991201 0.2821579 ]
Stock Position:  0.006337853169439677
Bond Position:  [2.49977366]


portfolio before change:  [3.13915199]
curr_Stock_Price:  100.78386022346311
curr_Factors:  [100.78386022  -1.09059691  -0.96380379]
mat_Sqrt:  [[12.91742954  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00158608 -0.05257121  0.09735663]
Stock Position:  -0.0015860758920979616
Bond Position:  [3.29900284]


portfolio before change:  [3.13945872]
curr_Stock_Price:  101.11053164288256
curr_Factors:  [101.11053164  -1.02891137  -0.99082505]
mat_Sqrt:  [[13.41640041  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282816 -0.00455813 -0.02970002]
Stock Position:  -0.002828162252576372
Bond Position:  [3.42541571]


portfolio before change:  [3.13961459]
curr_Stock_Price:  101.35825240164114
curr_Factors:  [101.3582524   -0.97913859  -1.00789946]
mat_Sqrt:  [[13.89630868  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02018409 -0.0817009  -0.58959192]
Stock Position:  0.020184092038387218
Bond Position:  [1.09379029]


portfolio before change:  [3.14313825]
curr_Stock_Price:  101.51927931452549
curr_Factors:  [101.51927931  -1.21856423  -1.00692354]
mat_Sqrt:  [[10.96557639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00389788  0.00084088 -0.16959439]
Stock Position:  -0.0038978827993770213
Bond Position:  [3.5388485]


portfolio before change:  [3.14049598]
curr_Stock_Price:  102.42415336808723
curr_Factors:  [102.42415337  -1.20485821  -0.99849389]
mat_Sqrt:  [[11.31094066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00050096 -0.02845143  0.0120735 ]
Stock Position:  -0.0005009569102550853
Bond Position:  [3.19180607]


portfolio before change:  [3.14140259]
curr_Stock_Price:  102.20745944065982
curr_Factors:  [102.20745944  -0.99399021  -0.99509106]
mat_Sqrt:  [[13.98413395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00998169 -0.01496598 -0.14840805]
Stock Position:  -0.00998169315614677
Bond Position:  [4.16160608]


portfolio before change:  [3.14650352]
curr_Stock_Price:  101.80067414992364
curr_Factors:  [101.80067415  -0.94972863  -0.98187956]
mat_Sqrt:  [[14.75244053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00073029  0.0076646  -0.23959826]
Stock Position:  -0.0007302924231551774
Bond Position:  [3.22084778]


portfolio before change:  [3.14724751]
curr_Stock_Price:  101.88464988207292
curr_Factors:  [101.88464988  -0.88349778  -0.96338096]
mat_Sqrt:  [[16.07013449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01721181  0.08888638  0.09511842]
Stock Position:  -0.01721180877007567
Bond Position:  [4.90086662]


portfolio before change:  [3.11607045]
curr_Stock_Price:  103.76721954961718
curr_Factors:  [103.76721955  -0.86371943  -0.94952295]
mat_Sqrt:  [[16.92696201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00684974 -0.05297578  0.05338281]
Stock Position:  0.006849742159374461
Bond Position:  [2.40529175]


portfolio before change:  [3.1090395]
curr_Stock_Price:  102.65296673064472
curr_Factors:  [102.65296673  -0.67944225  -0.95709583]
mat_Sqrt:  [[19.98168234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146526  0.01342592  0.08787702]
Stock Position:  -0.001465256531767462
Bond Position:  [3.25945243]


portfolio before change:  [3.11034416]
curr_Stock_Price:  102.31876336984625
curr_Factors:  [102.31876337  -0.93200696  -0.98355637]
mat_Sqrt:  [[15.0673439   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00157636  0.05494585  0.07247916]
Stock Position:  -0.0015763638881373925
Bond Position:  [3.27163577]


portfolio before change:  [3.11290108]
curr_Stock_Price:  101.21564860624675
curr_Factors:  [101.21564861  -1.00586867  -0.94564552]
mat_Sqrt:  [[14.37857399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00412697 -0.0234203  -0.12535589]
Stock Position:  -0.0041269701327800255
Bond Position:  [3.53061504]


portfolio before change:  [3.11331003]
curr_Stock_Price:  101.33045747912871
curr_Factors:  [101.33045748  -1.29011307  -0.97331619]
mat_Sqrt:  [[10.5376839   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01053232 -0.03393621  0.61896881]
Stock Position:  -0.010532321720220436
Bond Position:  [4.18055501]


portfolio before change:  [3.10691167]
curr_Stock_Price:  102.0371993022365
curr_Factors:  [102.0371993   -1.1544562   -0.97531792]
mat_Sqrt:  [[12.12856389  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00600067 0.03052996 0.45040838]
Stock Position:  0.006000668919658387
Bond Position:  [2.49462022]


portfolio before change:  [3.10519932]
curr_Stock_Price:  101.64789553431203
curr_Factors:  [101.64789553  -1.20030876  -0.92094457]
mat_Sqrt:  [[12.18568021  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00752443  0.01817149  0.1703756 ]
Stock Position:  -0.007524428108623174
Bond Position:  [3.8700416]


portfolio before change:  [3.09806673]
curr_Stock_Price:  102.72441850597147
curr_Factors:  [102.72441851  -1.1278104   -0.90937904]
mat_Sqrt:  [[13.39471746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297153 -0.01141143  0.06276263]
Stock Position:  -0.0029715295399559637
Bond Position:  [3.40331538]


portfolio before change:  [3.10002226]
curr_Stock_Price:  102.35269444803026
curr_Factors:  [102.35269445  -1.48599496  -0.87770784]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.10002226]
Stock Price:  101.91217745180398
PL:  [1.18784481]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [ 1.27535186e-02 -1.09155942e-01  5.71042152e-02]
 [-6.69207143e-01  4.37636949e-01  1.22978570e-02]
 [-2.18648309e-01 -5.38004524e-01 -9.49773297e-02]
 [-5.58739818e-03  2.97390226e-01  2.25786100e-01]
 [ 4.23265888e-02 -3.35152539e-02 -6.99173245e-02]
 [-1.10415089e-01  7.34369149e-02  3.29711057e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-4.28348733e-02 -3.74299070e-02 -2.23822659e-02]
 [-1.20523413e-02  3.11220667e-02 -2.95384416e-02]
 [-2.03321949e-01  1.93807359e-01  1.83357766e-02]
 [ 1.07676187e-01 -1.45582060e-01 -2.75018508e-03]
 [-1.32747208e-01 -9.77380723e-03 -1.13433160e-02]
 [-9.46490110e-02  1.47303384e-01 -5.66580467e-02]
 [-1.32761109e-01 -3.00085726e-02  2.03623877e-01]
 [-1.00578723e-01 -9.97061362e-02  2.37885163e-01]
 [-3.08659726e-02 -9.34438126e-03 -9.52008863e-02]
 [-1.06003276e-01  4.02651403e-02  7.98283069e-02]
 [-3.86522953e-02 -2.16704207e-02  2.12145539e-02]
 [-1.48770614e-02  5.40403164e-01  3.27151136e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.21616118]
curr_Stock_Price:  98.53843648298499
curr_Factors:  [98.53843648 -0.67662196 -0.98687824]
mat_Sqrt:  [[18.67053254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115645 -0.03451814  0.16290243]
Stock Position:  0.00115644657317344
Bond Position:  [-8.33011561]


portfolio before change:  [-8.21997081]
curr_Stock_Price:  97.04520117104819
curr_Factors:  [97.04520117 -0.48604679 -0.91909948]
mat_Sqrt:  [[23.80821274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02752819  0.13839295  0.03508236]
Stock Position:  -0.027528194717508885
Bond Position:  [-5.54849162]


portfolio before change:  [-8.22803583]
curr_Stock_Price:  97.28777862503406
curr_Factors:  [97.28777863 -0.49605173 -0.8952617 ]
mat_Sqrt:  [[24.20017711  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01041012 -0.17013197 -0.27094388]
Stock Position:  -0.01041011772042938
Bond Position:  [-7.2152586]


portfolio before change:  [-8.22073088]
curr_Stock_Price:  96.4127654983819
curr_Factors:  [96.4127655  -0.71520611 -0.90926131]
mat_Sqrt:  [[18.99491285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00253645 0.09404305 0.6441049 ]
Stock Position:  0.002536446437568644
Bond Position:  [-8.46527669]


portfolio before change:  [-8.22187513]
curr_Stock_Price:  96.79611067406337
curr_Factors:  [96.79611067 -0.64430715 -0.94605106]
mat_Sqrt:  [[19.73213663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00137793 -0.01059845 -0.19945467]
Stock Position:  0.0013779255169579536
Bond Position:  [-8.35525296]


portfolio before change:  [-8.2227228]
curr_Stock_Price:  97.69702789996728
curr_Factors:  [97.6970279  -0.52431806 -0.93111824]
mat_Sqrt:  [[22.79257517  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00446587  0.02322279  0.09405739]
Stock Position:  -0.004465873500701191
Bond Position:  [-7.78642024]


portfolio before change:  [-8.22686686]
curr_Stock_Price:  98.1890265402019
curr_Factors:  [98.18902654 -0.48252713 -0.96171172]
mat_Sqrt:  [[23.16530322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0002446  -0.02845143  0.0120735 ]
Stock Position:  -0.00024460262115599704
Bond Position:  [-8.20284956]


portfolio before change:  [-8.22946367]
curr_Stock_Price:  100.42059777965147
curr_Factors:  [100.42059778  -0.63003494  -0.94353345]
mat_Sqrt:  [[20.8176036   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00232352 -0.01183638 -0.06385037]
Stock Position:  -0.002323517688067176
Bond Position:  [-7.99613464]


portfolio before change:  [-8.23210296]
curr_Stock_Price:  100.69604207224121
curr_Factors:  [100.69604207  -0.59516223  -0.95986193]
mat_Sqrt:  [[21.26542108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00081251  0.00984166 -0.08426495]
Stock Position:  -0.000812505994280454
Bond Position:  [-8.15028682]


portfolio before change:  [-8.23428877]
curr_Stock_Price:  100.87817509392798
curr_Factors:  [100.87817509  -0.60026471  -0.94385014]
mat_Sqrt:  [[21.53756794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00903422  0.06128727  0.05230687]
Stock Position:  -0.009034218272827611
Bond Position:  [-7.32293331]


portfolio before change:  [-8.24200346]
curr_Stock_Price:  101.52944729411409
curr_Factors:  [101.52944729  -0.65590639  -0.93703034]
mat_Sqrt:  [[20.64374047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00500665 -0.04603709 -0.00784551]
Stock Position:  0.005006645716230514
Bond Position:  [-8.75032544]


portfolio before change:  [-8.2230923]
curr_Stock_Price:  105.74365031882195
curr_Factors:  [105.74365032  -0.74258194  -0.94360795]
mat_Sqrt:  [[19.58625165  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00690867 -0.00309075 -0.03235932]
Stock Position:  -0.006908673151694058
Bond Position:  [-7.49254398]


portfolio before change:  [-8.23074751]
curr_Stock_Price:  106.58054672717037
curr_Factors:  [106.58054673  -1.00711448  -0.97250538]
mat_Sqrt:  [[14.72108988  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00695675  0.04658142 -0.16162964]
Stock Position:  -0.006956749138231055
Bond Position:  [-7.48929339]


portfolio before change:  [-8.22598917]
curr_Stock_Price:  105.62738667023734
curr_Factors:  [105.62738667  -0.49054689  -1.0056358 ]
mat_Sqrt:  [[23.6587965   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00388741 -0.00948954  0.58088224]
Stock Position:  -0.003887407279318047
Bond Position:  [-7.8153725]


portfolio before change:  [-8.23759958]
curr_Stock_Price:  108.1113874420038
curr_Factors:  [108.11138744  -0.58273653  -0.99550948]
mat_Sqrt:  [[22.30734618  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0024474  -0.03152985  0.67862016]
Stock Position:  -0.002447400902359496
Bond Position:  [-7.97300768]


portfolio before change:  [-8.23636149]
curr_Stock_Price:  106.79096808471671
curr_Factors:  [106.79096808  -0.34818636  -0.97703282]
mat_Sqrt:  [[28.37913455  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00178089 -0.00295495 -0.27158163]
Stock Position:  -0.0017808873974573213
Bond Position:  [-8.0461788]


portfolio before change:  [-8.2340179]
curr_Stock_Price:  104.34534179064242
curr_Factors:  [104.34534179  -0.67179656  -0.96393755]
mat_Sqrt:  [[20.32744386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00436202  0.01273296  0.22772794]
Stock Position:  -0.00436202160516589
Bond Position:  [-7.77886127]


portfolio before change:  [-8.2372761]
curr_Stock_Price:  104.64640347037553
curr_Factors:  [104.64640347  -0.74791601  -0.99986235]
mat_Sqrt:  [[18.22526331  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019139  -0.00685279  0.06051922]
Stock Position:  -0.0019139048844522186
Bond Position:  [-8.03699283]


portfolio before change:  [-8.24029539]
curr_Stock_Price:  105.17401478844488
curr_Factors:  [105.17401479  -0.97660077  -1.0012852 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.24029539]
Stock Price:  106.09278824552301
PL:  [-14.33308364]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.08646545e-01 -7.95119454e-02  2.05391133e-01]
 [-7.64753992e-02  1.25861824e-01  9.64622276e-02]
 [-7.51332122e-02 -4.50675840e-01  3.26850290e-02]
 [-3.34243181e-02 -1.11131001e-02 -8.33639658e-03]
 [ 8.38056762e-01 -4.91480197e-01 -1.91782079e-01]
 [ 4.53885277e-03  5.76109431e-02  7.27942606e-03]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 1.48320432e-01 -6.85844272e-03  5.02352359e-03]
 [-8.11552557e-02  2.38276322e-02  5.86743301e-02]
 [-1.38308100e-01  1.20249858e-01 -2.32702254e-02]
 [ 5.48416209e-02 -1.15001788e-01  3.80302001e-03]
 [-1.08721337e-02  6.13158278e-02  3.54557249e-02]
 [-2.52642699e-02  1.56922239e-01  2.84494112e-02]
 [-5.12883355e-02 -1.27211968e-01 -3.24077253e-02]
 [-1.47345284e-01 -1.04588892e-01  2.13558954e-01]
 [ 1.24375280e-02  1.01589495e-01  1.42626843e-01]
 [-6.63275214e-02  1.17939832e-01  3.28050572e-02]
 [ 4.65122052e-03  1.49267766e-02  8.33974741e-02]
 [-2.56190145e-02  5.39431597e-01  2.47874057e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.78285046]
curr_Stock_Price:  99.15599147138563
curr_Factors:  [99.15599147 -1.37175658 -1.02815631]
mat_Sqrt:  [[ 8.99601226  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01876101 -0.02514388  0.58592373]
Stock Position:  -0.018761006554067716
Bond Position:  [-1.92258426]


portfolio before change:  [-3.79869121]
curr_Stock_Price:  99.97471320654536
curr_Factors:  [99.97471321 -1.62095081 -1.03868301]
mat_Sqrt:  [[ 6.99561463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00765271  0.039801    0.27517989]
Stock Position:  -0.007652707295660947
Bond Position:  [-3.033614]


portfolio before change:  [-3.79767433]
curr_Stock_Price:  99.74271967471562
curr_Factors:  [99.74271967 -1.67167849 -1.06909909]
mat_Sqrt:  [[ 6.43541599  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01244641 -0.14251621  0.09324129]
Stock Position:  -0.012446407340143328
Bond Position:  [-2.55623581]


portfolio before change:  [-3.79459666]
curr_Stock_Price:  99.4440942333918
curr_Factors:  [99.44409423 -1.65632903 -1.07397101]
mat_Sqrt:  [[ 6.48372754  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00546181 -0.00351427 -0.02378142]
Stock Position:  -0.005461814473096252
Bond Position:  [-3.25145146]


portfolio before change:  [-3.79572202]
curr_Stock_Price:  99.501290382674
curr_Factors:  [99.50129038 -1.5793993  -1.07005231]
mat_Sqrt:  [[ 7.03374308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.11177824 -0.15541968 -0.54710089]
Stock Position:  0.11177824339149826
Bond Position:  [-14.91780147]


portfolio before change:  [-3.7930245]
curr_Stock_Price:  99.55879200012025
curr_Factors:  [99.558792   -1.28898996 -1.06633705]
mat_Sqrt:  [[ 9.44439396  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00079542 0.01821818 0.02076618]
Stock Position:  0.0007954208156944118
Bond Position:  [-3.87221564]


portfolio before change:  [-3.79432273]
curr_Stock_Price:  99.1438557960456
curr_Factors:  [99.1438558  -1.40145112 -1.04711866]
mat_Sqrt:  [[ 8.56772387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066135 -0.02845143  0.0120735 ]
Stock Position:  -0.000661353467209698
Bond Position:  [-3.72875359]


portfolio before change:  [-3.79528079]
curr_Stock_Price:  99.18279965086491
curr_Factors:  [99.18279965 -1.17445307 -1.04479718]
mat_Sqrt:  [[10.78023492  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01383725 -0.00216883  0.01433071]
Stock Position:  0.013837246731599993
Bond Position:  [-5.16769766]


portfolio before change:  [-3.79389666]
curr_Stock_Price:  99.37620592185543
curr_Factors:  [99.37620592 -1.18593815 -1.04250173]
mat_Sqrt:  [[10.70245147  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00640631  0.00753496  0.16738153]
Stock Position:  -0.006406306216265461
Bond Position:  [-3.15726226]


portfolio before change:  [-3.78829641]
curr_Stock_Price:  98.37880255262483
curr_Factors:  [98.37880255 -0.88277007 -1.03361232]
mat_Sqrt:  [[14.47528866  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00966843  0.03802634 -0.06638348]
Stock Position:  -0.009668427378018037
Bond Position:  [-2.8371281]


portfolio before change:  [-3.80696238]
curr_Stock_Price:  100.23604428210295
curr_Factors:  [100.23604428  -1.14166545  -1.03873534]
mat_Sqrt:  [[11.32629547  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00464835 -0.03636676  0.01084896]
Stock Position:  0.004648349132159582
Bond Position:  [-4.27289451]


portfolio before change:  [-3.80308481]
curr_Stock_Price:  101.30006407021246
curr_Factors:  [101.30006407  -1.42740852  -1.08633346]
mat_Sqrt:  [[ 8.20172964  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00025014  0.01938977  0.10114531]
Stock Position:  -0.0002501419028382307
Bond Position:  [-3.77774542]


portfolio before change:  [-3.80420112]
curr_Stock_Price:  101.98669614091152
curr_Factors:  [101.98669614  -1.46057046  -1.10334038]
mat_Sqrt:  [[ 7.85328205  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196164  0.04962317  0.08115825]
Stock Position:  -0.0019616439686600843
Bond Position:  [-3.60413953]


portfolio before change:  [-3.80457493]
curr_Stock_Price:  101.71787387642144
curr_Factors:  [101.71787388  -1.14694961  -1.1201075 ]
mat_Sqrt:  [[10.53966676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00580551 -0.04022796 -0.09245022]
Stock Position:  -0.005805509327186238
Bond Position:  [-3.21405086]


portfolio before change:  [-3.79671207]
curr_Stock_Price:  100.22507158978331
curr_Factors:  [100.22507159  -0.97318033  -1.09280116]
mat_Sqrt:  [[12.69790321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00838353 -0.03307391  0.60922425]
Stock Position:  -0.008383527354881345
Bond Position:  [-2.95647244]


portfolio before change:  [-3.78447614]
curr_Stock_Price:  98.67737738221763
curr_Factors:  [98.67737738 -0.69744384 -1.12133388]
mat_Sqrt:  [[16.00783032  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00275953 0.03212542 0.40687468]
Stock Position:  0.0027595332410631198
Bond Position:  [-4.05677964]


portfolio before change:  [-3.79162425]
curr_Stock_Price:  96.45461333925714
curr_Factors:  [96.45461334 -0.41015687 -1.13109767]
mat_Sqrt:  [[20.65212099  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273996  0.03729585  0.0935837 ]
Stock Position:  -0.0027399618573063765
Bond Position:  [-3.52734229]


portfolio before change:  [-3.79211822]
curr_Stock_Price:  96.31301399082659
curr_Factors:  [96.31301399 -0.18179901 -1.13972876]
mat_Sqrt:  [[25.6893287   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00085872 0.00472026 0.23790978]
Stock Position:  0.0008587249054026556
Bond Position:  [-3.8748246]


portfolio before change:  [-3.79180275]
curr_Stock_Price:  97.80859621512329
curr_Factors:  [97.80859622 -0.27868069 -1.12140798]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.79180275]
Stock Price:  99.51099697112649
PL:  [-3.79180275]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.81489057e-01 -3.05657184e-02  8.81567554e-02]
 [ 4.91537751e-02  4.90685637e-02  6.73071421e-02]
 [-1.21179031e-02 -1.13157324e-01  2.99124258e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.43525711e-01 -2.57308581e-01 -1.88695749e-01]
 [ 9.39005492e-02 -3.25349676e-02 -3.89116846e-02]
 [-2.44841562e-02 -1.21566460e-02 -4.65966991e-02]
 [ 1.20437118e-01 -4.53152511e-01 -7.19002831e-02]
 [-1.15623599e-01 -4.42289728e-02 -9.75423425e-02]
 [-9.29251757e-02  1.04092766e-01 -7.20979223e-03]
 [ 8.75964897e-02 -1.33882342e-01 -8.68425833e-04]
 [ 6.81810946e-02  9.94593097e-02  1.19645956e-02]
 [-9.30567391e-03  1.84327088e-01  5.77945232e-02]
 [-5.12817302e-02 -5.57974436e-02 -3.56943241e-02]
 [-1.66432493e-01 -1.18772368e-01  2.37614934e-01]
 [-2.95117233e-02  9.24112631e-02  4.28266676e-02]
 [-1.28675791e-01  1.64164295e-02  8.17838987e-02]
 [-3.51546185e-02 -1.11139823e-02  2.07249155e-02]
 [ 1.04442726e-02  6.17452201e-01  4.68823713e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.60539031]
curr_Stock_Price:  100.32446358440585
curr_Factors:  [100.32446358  -1.2147329   -1.00435149]
mat_Sqrt:  [[10.90613176  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02423255 -0.00966573  0.25148669]
Stock Position:  -0.02423254586443231
Bond Position:  [7.03650748]


portfolio before change:  [4.59384933]
curr_Stock_Price:  100.8733258328069
curr_Factors:  [100.87332583  -1.11680372  -0.99061701]
mat_Sqrt:  [[12.26126124  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00523272 0.01551684 0.19200854]
Stock Position:  0.005232718852801826
Bond Position:  [4.06600758]


portfolio before change:  [4.60189034]
curr_Stock_Price:  102.21572127780756
curr_Factors:  [102.21572128  -1.23507517  -0.99723305]
mat_Sqrt:  [[10.9657554   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008147  -0.03578349  0.08533182]
Stock Position:  -0.0008146966561688528
Bond Position:  [4.68516514]


portfolio before change:  [4.60295533]
curr_Stock_Price:  102.34637208788878
curr_Factors:  [102.34637209  -0.74207627  -0.99033196]
mat_Sqrt:  [[18.10077269  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209625 -0.00455813 -0.02970002]
Stock Position:  -0.0020962506880721973
Bond Position:  [4.81749899]


portfolio before change:  [4.60696257]
curr_Stock_Price:  101.0093607732686
curr_Factors:  [101.00936077  -0.7720724   -0.99204738]
mat_Sqrt:  [[17.30669493  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01723984 -0.08136812 -0.53829645]
Stock Position:  0.01723984127911582
Bond Position:  [2.86557722]


portfolio before change:  [4.61034407]
curr_Stock_Price:  101.16394567760328
curr_Factors:  [101.16394568  -0.48723346  -0.97726741]
mat_Sqrt:  [[23.38843241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00363931 -0.01028846 -0.11100421]
Stock Position:  0.003639306990897234
Bond Position:  [4.24217742]


portfolio before change:  [4.60840998]
curr_Stock_Price:  100.34104996475149
curr_Factors:  [100.34104996   0.19136789  -0.98092358]
mat_Sqrt:  [[45.55950142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00075307 -0.00384427 -0.13292741]
Stock Position:  -0.0007530712523742242
Bond Position:  [4.68397394]


portfolio before change:  [4.60566961]
curr_Stock_Price:  105.53512789099224
curr_Factors:  [105.53512789   0.25668033  -0.94393082]
mat_Sqrt:  [[53.07963718  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00177206 -0.14329941 -0.20511149]
Stock Position:  0.0017720578364122182
Bond Position:  [4.41865526]


portfolio before change:  [4.60628877]
curr_Stock_Price:  105.26107548514295
curr_Factors:  [ 1.05261075e+02  8.41465396e-02 -9.41255009e-01]
mat_Sqrt:  [[44.67147825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305959 -0.01398643 -0.27826115]
Stock Position:  -0.00305958832496015
Bond Position:  [4.92834433]


portfolio before change:  [4.6223282]
curr_Stock_Price:  100.42147513025668
curr_Factors:  [ 1.00421475e+02 -1.01270220e-02 -9.36615551e-01]
mat_Sqrt:  [[38.96381937  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0023537   0.03291702 -0.02056753]
Stock Position:  -0.002353701617106647
Bond Position:  [4.85869039]


portfolio before change:  [4.62575952]
curr_Stock_Price:  99.47976943808207
curr_Factors:  [99.47976944 -0.19954752 -0.97288987]
mat_Sqrt:  [[30.80006847  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00272605 -0.04233731 -0.00247738]
Stock Position:  0.002726045751129837
Bond Position:  [4.35457312]


portfolio before change:  [4.62617888]
curr_Stock_Price:  99.23420488166182
curr_Factors:  [99.23420488 -0.3518036  -0.96883463]
mat_Sqrt:  [[26.4920459   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00276277 0.0314518  0.03413166]
Stock Position:  0.0027627683432193133
Bond Position:  [4.35201776]


portfolio before change:  [4.62613822]
curr_Stock_Price:  98.82563141092523
curr_Factors:  [ 9.88256314e+01 -7.91673653e-02 -1.02732477e+00]
mat_Sqrt:  [[32.6833201   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00022185 0.05828934 0.16487169]
Stock Position:  0.00022185287984433837
Bond Position:  [4.60421347]


portfolio before change:  [4.62744171]
curr_Stock_Price:  99.51205535416798
curr_Factors:  [99.51205535 -0.22728452 -1.03731672]
mat_Sqrt:  [[28.09741433  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213573 -0.0176447  -0.10182597]
Stock Position:  -0.002135729881565525
Bond Position:  [4.83997258]


portfolio before change:  [4.6265124]
curr_Stock_Price:  100.5137982750707
curr_Factors:  [100.51379828  -0.2014881   -1.0679569 ]
mat_Sqrt:  [[28.24312362  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0042841  -0.03755912  0.67784927]
Stock Position:  -0.004284095428613284
Bond Position:  [5.0571231]


portfolio before change:  [4.62314083]
curr_Stock_Price:  101.59594235136885
curr_Factors:  [ 1.01595942e+02 -2.21592103e-02 -1.08761412e+00]
mat_Sqrt:  [[33.48944335  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054894  0.02922301  0.12217256]
Stock Position:  -0.000548940680638011
Bond Position:  [4.67891097]


portfolio before change:  [4.62284168]
curr_Stock_Price:  104.27204914208023
curr_Factors:  [104.27204914  -0.1100357   -1.08137074]
mat_Sqrt:  [[31.67719116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00352171  0.00519133  0.2333067 ]
Stock Position:  -0.003521709104414388
Bond Position:  [4.9900575]


portfolio before change:  [4.61862226]
curr_Stock_Price:  105.82444618756213
curr_Factors:  [ 1.05824446e+02  6.57984085e-02 -1.05776288e+00]
mat_Sqrt:  [[39.24472677  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079529 -0.00351455  0.05912242]
Stock Position:  -0.0007952947358432121
Bond Position:  [4.70278388]


portfolio before change:  [4.61792714]
curr_Stock_Price:  108.17698114682177
curr_Factors:  [108.17698115  -0.20884848  -1.04595945]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.61792714]
Stock Price:  107.10653051383376
PL:  [-2.48860337]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.91816758e-01 -6.62794157e-02  1.66296034e-01]
 [-4.05749148e-01  2.99058831e-01  4.97073202e-02]
 [-1.52566757e-01 -4.47794427e-01 -5.13070433e-02]
 [-8.39328169e-03  1.90424714e-01  1.46422301e-01]
 [ 5.00423139e-01 -3.10440848e-01 -1.56236210e-01]
 [ 6.19426692e-03  1.49914860e-02 -3.96835742e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 2.50449007e-02 -2.82997516e-02 -9.58124245e-04]
 [-7.17722053e-02  2.48180976e-02  4.66964724e-02]
 [-3.95357863e-01  3.78172453e-01  5.71833315e-02]
 [ 1.08893069e-02 -8.95233327e-02  8.94777930e-03]
 [-8.21617844e-02  1.76411583e-02 -8.84016435e-03]
 [-1.15263897e-02  1.55715178e-01  4.40935855e-02]
 [-4.04967942e-02 -1.45727717e-01 -6.62745743e-02]
 [-1.69618968e-01 -1.18115208e-01  2.33197997e-01]
 [ 3.17937991e-02  7.26992469e-02  9.63193075e-02]
 [-1.31121255e-01  1.41932845e-02  8.15712207e-02]
 [-4.69501041e-02 -4.57024783e-02  2.17370871e-02]
 [-2.52337545e-02  5.13387338e-01  2.69765615e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.23331436]
curr_Stock_Price:  99.23254120667869
curr_Factors:  [99.23254121 -1.03866247 -0.99448458]
mat_Sqrt:  [[12.99180728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01228336 -0.02095939  0.4743963 ]
Stock Position:  -0.012283360253695867
Bond Position:  [-2.01440531]


portfolio before change:  [-3.21885072]
curr_Stock_Price:  98.01403909809079
curr_Factors:  [98.0140391  -0.88234457 -1.00005453]
mat_Sqrt:  [[14.92013467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02599715  0.09457071  0.14180115]
Stock Position:  -0.025997152596405254
Bond Position:  [-0.67076479]


portfolio before change:  [-3.22352881]
curr_Stock_Price:  98.1875341448517
curr_Factors:  [98.18753414 -0.71266082 -0.99380368]
mat_Sqrt:  [[17.82166333  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00979716 -0.14160503 -0.14636471]
Stock Position:  -0.009797164395362497
Bond Position:  [-2.2615694]


portfolio before change:  [-3.21666605]
curr_Stock_Price:  97.42933255725256
curr_Factors:  [97.42933256 -0.83731276 -0.99749316]
mat_Sqrt:  [[15.55405542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00169806 0.06021758 0.41770207]
Stock Position:  0.0016980645630817331
Bond Position:  [-3.38210735]


portfolio before change:  [-3.2155072]
curr_Stock_Price:  98.60978229932316
curr_Factors:  [98.6097823  -1.00279488 -0.96961791]
mat_Sqrt:  [[13.71867004  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03356856 -0.09817002 -0.44569842]
Stock Position:  0.03356856071737507
Bond Position:  [-6.52569567]


portfolio before change:  [-3.14040785]
curr_Stock_Price:  100.89558140754043
curr_Factors:  [100.89558141  -1.12251195  -0.97483945]
mat_Sqrt:  [[12.38808014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00012262  0.00474072 -0.11320619]
Stock Position:  -0.00012262031146875486
Bond Position:  [-3.128036]


portfolio before change:  [-3.14110089]
curr_Stock_Price:  100.16923112091095
curr_Factors:  [100.16923112  -1.46310124  -0.9661452 ]
mat_Sqrt:  [[ 8.82522966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064206 -0.02845143  0.0120735 ]
Stock Position:  -0.000642056253261134
Bond Position:  [-3.07678661]


portfolio before change:  [-3.14204318]
curr_Stock_Price:  100.43868487306287
curr_Factors:  [100.43868487  -1.39097872  -0.97125958]
mat_Sqrt:  [[ 9.46223999  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00254893 -0.00894917 -0.00273326]
Stock Position:  0.002548934291673545
Bond Position:  [-3.39805479]


portfolio before change:  [-3.14454527]
curr_Stock_Price:  99.7903888209607
curr_Factors:  [99.79038882 -1.50294286 -0.95517666]
mat_Sqrt:  [[ 8.54163422  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00721168  0.00784817  0.13321204]
Stock Position:  -0.00721167936736643
Bond Position:  [-2.42488898]


portfolio before change:  [-3.15411926]
curr_Stock_Price:  101.03388474608062
curr_Factors:  [101.03388475  -1.95412489  -0.96953461]
mat_Sqrt:  [[ 5.42922528  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06887189  0.11958863  0.16312813]
Stock Position:  -0.06887188759904062
Bond Position:  [3.80427509]


portfolio before change:  [-3.10907036]
curr_Stock_Price:  100.39359869353515
curr_Factors:  [100.39359869  -2.09681183  -0.95582245]
mat_Sqrt:  [[ 4.74202453  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00219406 -0.02830976  0.02552552]
Stock Position:  0.00219405911333472
Bond Position:  [-3.32933985]


portfolio before change:  [-3.10852553]
curr_Stock_Price:  101.02132590412211
curr_Factors:  [101.0213259   -1.73778977  -1.00157612]
mat_Sqrt:  [[ 6.52711963  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01279443  0.00557862 -0.02521853]
Stock Position:  -0.01279443113430422
Bond Position:  [-1.81601513]


portfolio before change:  [-3.11092854]
curr_Stock_Price:  101.17365353262792
curr_Factors:  [101.17365353  -1.54702785  -1.02399266]
mat_Sqrt:  [[ 7.73548261  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00019323 0.04924146 0.12578673]
Stock Position:  0.0001932296211668203
Bond Position:  [-3.13047828]


portfolio before change:  [-3.11150243]
curr_Stock_Price:  102.2543588931127
curr_Factors:  [102.25435889  -1.66630021  -1.00902118]
mat_Sqrt:  [[ 7.04375942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0082041  -0.04608315 -0.18906291]
Stock Position:  -0.008204100267750215
Bond Position:  [-2.27259742]


portfolio before change:  [-3.10930411]
curr_Stock_Price:  101.917144933483
curr_Factors:  [101.91714493  -1.36934916  -1.03716077]
mat_Sqrt:  [[ 9.18572134  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01361541 -0.03735131  0.66524898]
Stock Position:  -0.013615408418401776
Bond Position:  [-1.72166056]


portfolio before change:  [-3.11088717]
curr_Stock_Price:  102.00179780088773
curr_Factors:  [102.0017978   -0.84102743  -1.0485772 ]
mat_Sqrt:  [[15.41568979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00345959 0.02298952 0.27477217]
Stock Position:  0.0034595910146356813
Bond Position:  [-3.46377167]


portfolio before change:  [-3.11016829]
curr_Stock_Price:  102.4599241046474
curr_Factors:  [102.4599241   -1.04397669  -1.06994655]
mat_Sqrt:  [[12.37339372  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00922173  0.00448831  0.23269999]
Stock Position:  -0.009221732767538059
Bond Position:  [-2.16531025]


portfolio before change:  [-3.10124064]
curr_Stock_Price:  101.43310641799414
curr_Factors:  [101.43310642  -0.8823714   -1.10694278]
mat_Sqrt:  [[13.87495402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00314906 -0.01445239  0.06200986]
Stock Position:  -0.003149060716918183
Bond Position:  [-2.78182163]


portfolio before change:  [-3.1081078]
curr_Stock_Price:  103.39293137718921
curr_Factors:  [103.39293138  -1.07014461  -1.12032374]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.1081078]
Stock Price:  103.09865517537273
PL:  [-6.20676297]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.70749390e-01 -2.95204249e-02  8.31615737e-02]
 [ 2.84925133e-02  6.53847034e-02  8.82739275e-02]
 [ 8.70182112e-04 -9.18810232e-02  3.61191924e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 2.67528408e-01 -2.20076108e-01 -1.88223955e-01]
 [ 7.06184589e-02 -1.42706349e-01 -1.12997867e-01]
 [ 3.93505219e-02 -8.08676945e-02 -6.90001733e-03]
 [-1.24453641e-01 -4.69457103e-02 -5.12562940e-02]
 [-4.20476413e-02  2.79557928e-02  8.75181830e-03]
 [-1.29296626e-02  4.18842664e-02 -4.63844730e-02]
 [ 9.83142326e-02 -1.40160899e-01 -1.60880042e-03]
 [ 1.96124556e-02  8.18841614e-02  4.74678343e-02]
 [-1.67623262e-02  1.71032152e-01  4.38929797e-02]
 [-3.95089449e-02 -1.11394523e-01 -7.22632656e-02]
 [-9.26044099e-02 -7.00412583e-02  1.61655903e-01]
 [-2.37642851e-03  1.49187923e-01  2.17342864e-01]
 [-6.74541175e-02  1.16760051e-01  3.28958491e-02]
 [-4.32912358e-02 -4.89499783e-02  3.02510545e-02]
 [-2.70731999e-02  5.27102032e-01  2.41031378e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.52098107]
curr_Stock_Price:  100.45200430354366
curr_Factors:  [100.4520043   -1.1815052   -1.01888405]
mat_Sqrt:  [[11.12606775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02287747 -0.00933518  0.23723682]
Stock Position:  -0.02287747344188394
Bond Position:  [7.81906913]


portfolio before change:  [5.51645615]
curr_Stock_Price:  100.73524905887258
curr_Factors:  [100.73524906  -1.25659715  -0.99443294]
mat_Sqrt:  [[10.60648578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00454435 0.02067646 0.25182094]
Stock Position:  0.004544349570018268
Bond Position:  [5.05867997]


portfolio before change:  [5.51765993]
curr_Stock_Price:  100.7218140250872
curr_Factors:  [100.72181403  -0.79496617  -1.00137448]
mat_Sqrt:  [[16.7102408   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00035132 -0.02905533  0.103038  ]
Stock Position:  0.0003513189096777187
Bond Position:  [5.48227445]


portfolio before change:  [5.51960633]
curr_Stock_Price:  102.36039035536308
curr_Factors:  [102.36039036  -0.7636045   -1.04158346]
mat_Sqrt:  [[16.83250549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0022542  -0.00455813 -0.02970002]
Stock Position:  -0.0022541954447741694
Bond Position:  [5.75034666]


portfolio before change:  [5.52335956]
curr_Stock_Price:  101.3332096022534
curr_Factors:  [101.3332096   -0.60965259  -1.02557783]
mat_Sqrt:  [[19.75059813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01131232 -0.06959418 -0.53695055]
Stock Position:  0.01131231633755247
Bond Position:  [4.37704624]


portfolio before change:  [5.55012641]
curr_Stock_Price:  103.60263399558585
curr_Factors:  [103.602634    -0.71457308  -1.02494687]
mat_Sqrt:  [[18.19310745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00241125 -0.04512771 -0.32235146]
Stock Position:  0.0024112540363858096
Bond Position:  [5.30031414]


portfolio before change:  [5.55203073]
curr_Stock_Price:  103.84278992856329
curr_Factors:  [103.84278993  -0.72618714  -0.99711069]
mat_Sqrt:  [[18.53350712  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00193455 -0.02557261 -0.01968383]
Stock Position:  0.001934553815732414
Bond Position:  [5.35114126]


portfolio before change:  [5.54941444]
curr_Stock_Price:  101.79878047719556
curr_Factors:  [101.79878048  -0.86318197  -1.03825736]
mat_Sqrt:  [[15.20400378  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00895346 -0.01484554 -0.14621994]
Stock Position:  -0.008953458793065038
Bond Position:  [6.46086562]


portfolio before change:  [5.56560114]
curr_Stock_Price:  100.1713323496729
curr_Factors:  [100.17133235  -0.91679525  -1.03393535]
mat_Sqrt:  [[14.24137479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277637  0.0088404   0.0249665 ]
Stock Position:  -0.0027763729951638732
Bond Position:  [5.84371413]


portfolio before change:  [5.57282494]
curr_Stock_Price:  98.09571634327945
curr_Factors:  [98.09571634 -0.28077803 -1.05037027]
mat_Sqrt:  [[25.91431193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00082257  0.01324497 -0.13232199]
Stock Position:  -0.0008225727335383702
Bond Position:  [5.6535158]


portfolio before change:  [5.57251388]
curr_Stock_Price:  100.19232655302628
curr_Factors:  [100.19232655  -0.26473077  -1.03731715]
mat_Sqrt:  [[27.24973197  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00346304 -0.04432277 -0.00458946]
Stock Position:  0.0034630395210819703
Bond Position:  [5.22554389]


portfolio before change:  [5.57598219]
curr_Stock_Price:  100.81656409714763
curr_Factors:  [100.8165641   -0.67053001  -1.08131221]
mat_Sqrt:  [[17.48704719  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00179653 0.02589405 0.13541252]
Stock Position:  0.0017965312423219608
Bond Position:  [5.39486208]


portfolio before change:  [5.57629061]
curr_Stock_Price:  100.23741516086328
curr_Factors:  [100.23741516  -0.71659326  -1.07919683]
mat_Sqrt:  [[16.63903485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00020354  0.05408512  0.12521445]
Stock Position:  -0.0002035381303779691
Bond Position:  [5.59669275]


portfolio before change:  [5.5776954]
curr_Stock_Price:  100.21070604686732
curr_Factors:  [100.21070605  -1.04149356  -1.05145351]
mat_Sqrt:  [[12.35830078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00462327 -0.03522604 -0.20614698]
Stock Position:  -0.004623274465026762
Bond Position:  [6.040997]


portfolio before change:  [5.59349122]
curr_Stock_Price:  97.12082218745807
curr_Factors:  [97.12082219 -1.00642545 -1.03068068]
mat_Sqrt:  [[12.66509335  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00484915 -0.02214899  0.46115929]
Stock Position:  -0.004849154503269567
Bond Position:  [6.06444509]


portfolio before change:  [5.58873448]
curr_Stock_Price:  98.41445802803749
curr_Factors:  [98.41445803 -1.06689855 -1.03076778]
mat_Sqrt:  [[12.07964     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00379486 0.04717736 0.62001869]
Stock Position:  0.0037948575807213105
Bond Position:  [5.21526563]


portfolio before change:  [5.59199412]
curr_Stock_Price:  98.92980461557782
curr_Factors:  [98.92980462 -0.91396201 -1.03172699]
mat_Sqrt:  [[14.13595504  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00408353  0.03692277  0.0938427 ]
Stock Position:  -0.0040835266280502885
Bond Position:  [5.99597662]


portfolio before change:  [5.59560851]
curr_Stock_Price:  98.4118198821623
curr_Factors:  [98.41181988 -0.84347577 -1.03102801]
mat_Sqrt:  [[15.09943223  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254183 -0.01547934  0.08629784]
Stock Position:  -0.002541827241712569
Bond Position:  [5.84575435]


portfolio before change:  [5.59765953]
curr_Stock_Price:  98.17994082249749
curr_Factors:  [98.17994082 -0.47394164 -1.0527944 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.59765953]
Stock Price:  98.60437475494076
PL:  [5.59765953]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.76314090e-01 -2.03290210e-02  3.92382843e-02]
 [ 6.58426230e-02  1.79843700e-02  8.84996221e-03]
 [ 1.47354961e-02 -6.41729601e-03  3.13265378e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.74648850e-01 -3.15708319e-01 -2.83523541e-01]
 [-4.67301111e-04 -8.47075230e-02 -1.01903124e-01]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [-2.67116828e-02 -6.84383206e-03 -1.25263957e-01]
 [-3.74601426e-01  3.67161543e-01  5.29381268e-02]
 [ 1.18991100e-01 -1.61625467e-01  8.52313388e-03]
 [-6.30767786e-02  2.80980556e-02  1.92178908e-02]
 [-5.79386558e-02  1.83440421e-01  4.12064066e-04]
 [-1.12563060e-01 -1.11766639e-02  1.41128675e-01]
 [-1.32411575e-01 -1.08231231e-01  2.35827444e-01]
 [-1.62486438e-03  4.28232255e-02  1.60573728e-02]
 [-9.81140201e-02  4.77829276e-02  8.00949800e-02]
 [-3.30304887e-02 -4.98167511e-03  2.06035231e-02]
 [ 6.77443822e-03  6.24214779e-01  4.51804568e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.93317078]
curr_Stock_Price:  102.18100778886543
curr_Factors:  [102.18100779  -1.04621353  -0.96221319]
mat_Sqrt:  [[13.71265465  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01231195 -0.0064286   0.1119359 ]
Stock Position:  -0.01231194875240392
Bond Position:  [19.19121811]


portfolio before change:  [17.93550621]
curr_Stock_Price:  102.3810550255261
curr_Factors:  [102.38105503  -1.03128954  -0.9561587 ]
mat_Sqrt:  [[14.03077935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00485457 0.00568716 0.02524648]
Stock Position:  0.0048545748429967206
Bond Position:  [17.43848972]


portfolio before change:  [17.93843138]
curr_Stock_Price:  102.08545838628957
curr_Factors:  [102.08545839  -0.8754083   -0.92553912]
mat_Sqrt:  [[16.85863308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00124354 -0.00202933  0.08936589]
Stock Position:  0.0012435352784116397
Bond Position:  [17.81148451]


portfolio before change:  [17.94404322]
curr_Stock_Price:  103.01700776800557
curr_Factors:  [103.01700777  -1.06238283  -0.93750875]
mat_Sqrt:  [[13.94334763  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00272128 -0.00455813 -0.02970002]
Stock Position:  -0.0027212802989079036
Bond Position:  [18.22438138]


portfolio before change:  [17.94956476]
curr_Stock_Price:  102.66244325614143
curr_Factors:  [102.66244326  -1.28436006  -0.92318106]
mat_Sqrt:  [[11.28986299  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02733632 -0.09983574 -0.80881374]
Stock Position:  0.027336319012082062
Bond Position:  [15.14315146]


portfolio before change:  [17.96275758]
curr_Stock_Price:  103.00654807665848
curr_Factors:  [103.00654808  -1.03341115  -0.9382661 ]
mat_Sqrt:  [[14.340896    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00163556 -0.02678687 -0.29070125]
Stock Position:  -0.001635555272761397
Bond Position:  [18.13123048]


portfolio before change:  [17.96694726]
curr_Stock_Price:  103.21668774516549
curr_Factors:  [103.21668775  -1.34019354  -0.96725192]
mat_Sqrt:  [[10.27162337  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055165 -0.02845143  0.0120735 ]
Stock Position:  -0.000551645410193709
Bond Position:  [18.02388627]


portfolio before change:  [17.97157785]
curr_Stock_Price:  102.9918056862404
curr_Factors:  [102.99180569  -1.39384748  -0.97212526]
mat_Sqrt:  [[ 9.66660037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01443996 -0.01496598 -0.14840805]
Stock Position:  -0.01443996119214244
Bond Position:  [19.45877552]


portfolio before change:  [17.97307151]
curr_Stock_Price:  103.22529920991327
curr_Factors:  [103.22529921  -1.2313569   -0.91612404]
mat_Sqrt:  [[12.05443965  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435174 -0.00216421 -0.3573432 ]
Stock Position:  -0.004351740068561273
Bond Position:  [18.42228118]


portfolio before change:  [17.97775491]
curr_Stock_Price:  103.20754736958722
curr_Factors:  [103.20754737  -1.05569795  -0.94662037]
mat_Sqrt:  [[13.9352788   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02542579  0.11610667  0.15101774]
Stock Position:  -0.025425785265380894
Bond Position:  [20.60188785]


portfolio before change:  [17.98565568]
curr_Stock_Price:  103.0994031085383
curr_Factors:  [103.09940311  -0.77218471  -0.94791718]
mat_Sqrt:  [[18.45973203  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00631416 -0.05111046  0.02431413]
Stock Position:  0.006314161330550804
Bond Position:  [17.33466941]


portfolio before change:  [17.9924915]
curr_Stock_Price:  103.49559422046048
curr_Factors:  [103.49559422  -0.88463352  -0.97283574]
mat_Sqrt:  [[16.15225692  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361736  0.00888539  0.05482329]
Stock Position:  -0.0036173554386492663
Bond Position:  [18.36687185]


portfolio before change:  [17.99683766]
curr_Stock_Price:  103.56363746986177
curr_Factors:  [103.56363747  -0.36608867  -0.99466345]
mat_Sqrt:  [[26.56073944  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199987  0.05800895  0.0011755 ]
Stock Position:  -0.001999874002702547
Bond Position:  [18.20395188]


portfolio before change:  [18.00026158]
curr_Stock_Price:  104.12749043993256
curr_Factors:  [104.12749044  -0.40967901  -1.00583125]
mat_Sqrt:  [[25.28233051  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332421 -0.00353437  0.40260083]
Stock Position:  -0.003324213743027097
Bond Position:  [18.34640361]


portfolio before change:  [18.00341277]
curr_Stock_Price:  104.55946829323095
curr_Factors:  [104.55946829  -0.55762499  -1.01123548]
mat_Sqrt:  [[21.77789601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.003998   -0.03422572  0.67275006]
Stock Position:  -0.003997999511849874
Bond Position:  [18.42144147]


portfolio before change:  [18.00909788]
curr_Stock_Price:  104.28953998850679
curr_Factors:  [104.28953999  -0.54897836  -1.04352491]
mat_Sqrt:  [[21.21413719  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00013003 0.01354189 0.04580722]
Stock Position:  0.00013003234673437952
Bond Position:  [17.99553686]


portfolio before change:  [18.01373277]
curr_Stock_Price:  105.33116954526656
curr_Factors:  [105.33116955  -0.44749988  -1.00802521]
mat_Sqrt:  [[24.57142782  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00327742  0.01511029  0.22848868]
Stock Position:  -0.003277422518963699
Bond Position:  [18.35894751]


portfolio before change:  [18.01334728]
curr_Stock_Price:  106.84937484125666
curr_Factors:  [106.84937484  -0.43206348  -1.00888306]
mat_Sqrt:  [[25.291632    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00114478 -0.00157534  0.05877612]
Stock Position:  -0.0011447833187622329
Bond Position:  [18.13566666]


portfolio before change:  [18.01796122]
curr_Stock_Price:  106.77996152096557
curr_Factors:  [106.77996152  -0.14521782  -0.98109668]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.01796122]
Stock Price:  107.66807210990646
PL:  [10.34988911]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.34879138e-01 -7.11484066e-02  1.67888542e-01]
 [-2.69104226e-01  2.27184011e-01  6.91100836e-02]
 [-3.99866307e-02 -2.24463344e-01  3.58084465e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 5.01656870e-01 -3.59127492e-01 -2.46500223e-01]
 [ 2.66938485e-02  1.13271426e-02 -3.50240979e-02]
 [-3.19947071e-03 -8.82739756e-02  3.96207124e-03]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [-3.39413977e-02 -6.91308712e-03 -1.16038194e-01]
 [-4.00639483e-01  3.93146107e-01  5.13416744e-02]
 [ 1.12116241e-01 -1.74394729e-01  3.17981039e-02]
 [-1.01764258e-01  7.06808747e-03  2.24747646e-03]
 [-5.71695220e-02  1.60931886e-01 -7.41522782e-03]
 [-9.64909220e-02 -3.01381915e-02  9.52318801e-02]
 [-1.44850538e-01 -1.07412512e-01  2.23454291e-01]
 [ 2.84561209e-02  5.94381685e-02  7.13479571e-02]
 [-9.07407624e-02  5.52248936e-02  7.98396896e-02]
 [-3.40425255e-02 -8.11042950e-03  2.07921254e-02]
 [-2.79687323e-03  5.97506387e-01  3.99815958e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.30362294]
curr_Stock_Price:  98.94414964652827
curr_Factors:  [98.94414965 -1.07204913 -0.98406272]
mat_Sqrt:  [[12.65995278  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00809214 -0.0224991   0.47893928]
Stock Position:  -0.008092137362425172
Bond Position:  [-4.50295329]


portfolio before change:  [-5.30116596]
curr_Stock_Price:  98.50139170509685
curr_Factors:  [98.50139171 -1.08183763 -0.94322487]
mat_Sqrt:  [[13.00076469  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01916282  0.07184189  0.19715183]
Stock Position:  -0.019162820750551417
Bond Position:  [-3.41360145]


portfolio before change:  [-5.33957967]
curr_Stock_Price:  100.46144769529478
curr_Factors:  [100.4614477  -1.1272186  -0.9186488]
mat_Sqrt:  [[12.98645192  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296254 -0.07098154  0.10215153]
Stock Position:  -0.0029625398051266435
Bond Position:  [-5.04195864]


portfolio before change:  [-5.34226538]
curr_Stock_Price:  100.94247298018189
curr_Factors:  [100.94247298  -1.26220162  -0.93619533]
mat_Sqrt:  [[11.20268885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00338702 -0.00455813 -0.02970002]
Stock Position:  -0.003387022321528963
Bond Position:  [-5.00037097]


portfolio before change:  [-5.34474972]
curr_Stock_Price:  101.30683172908152
curr_Factors:  [101.30683173  -1.33018742  -0.93571525]
mat_Sqrt:  [[10.5092012   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04206481 -0.11356608 -0.70319652]
Stock Position:  0.042064813729334724
Bond Position:  [-9.60620272]


portfolio before change:  [-5.37107195]
curr_Stock_Price:  100.73817644118296
curr_Factors:  [100.73817644  -1.07383577  -0.9166707 ]
mat_Sqrt:  [[13.76347536  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144128  0.00358196 -0.099914  ]
Stock Position:  0.0014412820545460334
Bond Position:  [-5.51626407]


portfolio before change:  [-5.37097916]
curr_Stock_Price:  101.7595047470285
curr_Factors:  [101.75950475  -0.62513655  -0.94935202]
mat_Sqrt:  [[21.07576191  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00022158 -0.02791468  0.01130269]
Stock Position:  -0.0002215787297070983
Bond Position:  [-5.34843142]


portfolio before change:  [-5.37229386]
curr_Stock_Price:  101.65759249572847
curr_Factors:  [101.6575925   -0.62717001  -0.95911754]
mat_Sqrt:  [[20.8076911   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00670835 -0.01496598 -0.14840805]
Stock Position:  -0.006708352864045354
Bond Position:  [-4.69033885]


portfolio before change:  [-5.38505833]
curr_Stock_Price:  103.38554843498319
curr_Factors:  [103.38554843  -0.68585526  -1.00153874]
mat_Sqrt:  [[19.12643087  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302231 -0.00218611 -0.33102467]
Stock Position:  -0.003022314533675767
Bond Position:  [-5.07259468]


portfolio before change:  [-5.38758861]
curr_Stock_Price:  103.80310117409688
curr_Factors:  [103.80310117  -0.99305325  -0.99099341]
mat_Sqrt:  [[14.27413535  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02662217  0.12432372  0.14646351]
Stock Position:  -0.026622167289493633
Bond Position:  [-2.62412508]


portfolio before change:  [-5.41221098]
curr_Stock_Price:  104.70333816142625
curr_Factors:  [104.70333816  -1.0236172   -0.99648722]
mat_Sqrt:  [[13.88801982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00821601 -0.05514846  0.09071114]
Stock Position:  0.008216012849389753
Bond Position:  [-6.27245495]


portfolio before change:  [-5.41316672]
curr_Stock_Price:  104.77789588201094
curr_Factors:  [104.77789588  -1.24551849  -1.02015701]
mat_Sqrt:  [[10.87174627  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00930145  0.00223513  0.00641142]
Stock Position:  -0.00930144925717751
Bond Position:  [-4.43858044]


portfolio before change:  [-5.41367499]
curr_Stock_Price:  104.71322666387667
curr_Factors:  [104.71322666  -1.29655504  -1.03424109]
mat_Sqrt:  [[10.18004367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00535635  0.05089113 -0.02115358]
Stock Position:  -0.005356352823638196
Bond Position:  [-4.852794]


portfolio before change:  [-5.41298531]
curr_Stock_Price:  104.3579417681408
curr_Factors:  [104.35794177  -1.14466618  -1.02133361]
mat_Sqrt:  [[11.96310045  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00650584 -0.00953053  0.27167005]
Stock Position:  -0.006505835254553953
Bond Position:  [-4.73404973]


portfolio before change:  [-5.40321457]
curr_Stock_Price:  102.67416063162018
curr_Factors:  [102.67416063  -1.1547857   -1.015516  ]
mat_Sqrt:  [[11.71955466  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00870438 -0.03396682  0.63745289]
Stock Position:  -0.008704383700412377
Bond Position:  [-4.50949928]


portfolio before change:  [-5.41235068]
curr_Stock_Price:  103.59422528817969
curr_Factors:  [103.59422529  -0.79533228  -0.97383626]
mat_Sqrt:  [[17.66019168  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00252289 0.018796   0.20353586]
Stock Position:  0.00252288590211784
Bond Position:  [-5.67370709]


portfolio before change:  [-5.40762953]
curr_Stock_Price:  106.0278495210008
curr_Factors:  [106.02784952  -0.62438333  -0.94596666]
mat_Sqrt:  [[22.05086439  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331133  0.01746364  0.22776041]
Stock Position:  -0.0033113283942611464
Bond Position:  [-5.0565365]


portfolio before change:  [-5.41051221]
curr_Stock_Price:  106.51659440548386
curr_Factors:  [106.51659441  -0.74137487  -0.9761319 ]
mat_Sqrt:  [[19.12113034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00156935 -0.00256474  0.05931415]
Stock Position:  -0.0015693507948144174
Bond Position:  [-5.24335031]


portfolio before change:  [-5.41008432]
curr_Stock_Price:  105.40855906786456
curr_Factors:  [105.40855907  -0.35544715  -0.99206732]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.41008432]
Stock Price:  107.11189693434233
PL:  [-12.52198125]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.55103503e-01 -2.79976080e-02  7.58844344e-02]
 [ 1.68072048e-02  5.81155615e-02  2.77641615e-02]
 [ 2.09919340e-03 -9.09462509e-02  3.66395950e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 2.32837420e-01 -2.08562127e-01 -2.00521658e-01]
 [-7.90499783e-02  6.56152259e-02  3.01790922e-02]
 [-4.65998262e-02  7.72752831e-04 -3.67312876e-02]
 [-5.38473933e-02 -1.60166897e-01 -5.81483660e-02]
 [-9.58931952e-02 -4.17960222e-02 -1.17453926e-01]
 [-3.14871973e-01  3.04887443e-01  2.16841777e-03]
 [ 1.04687349e-01 -2.03021125e-01  7.69201272e-02]
 [-1.07865712e-01  3.75142269e-03 -4.28950589e-04]
 [-1.40128826e-01  1.24802578e-01 -1.18724846e-01]
 [-1.03007204e-01 -5.26929124e-02  1.15832721e-01]
 [-1.58170262e-01 -1.17087167e-01  2.39619528e-01]
 [ 1.19010184e-02  6.24372636e-02  6.03288769e-02]
 [-9.13938841e-02  5.40565497e-02  8.04799567e-02]
 [-3.74749748e-02 -1.77689595e-02  2.08298375e-02]
 [-1.31046941e-02  5.48123055e-01  3.38978321e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.27651937]
curr_Stock_Price:  100.41795107625944
curr_Factors:  [100.41795108  -0.70546687  -0.99279177]
mat_Sqrt:  [[18.37667774  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01307835 -0.00885362  0.21647717]
Stock Position:  -0.01307834617050861
Bond Position:  [6.5898201]


portfolio before change:  [5.27858864]
curr_Stock_Price:  100.3857140979799
curr_Factors:  [100.3857141   -0.78077767  -1.01380429]
mat_Sqrt:  [[16.68379598  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00143703 0.01837775 0.07920342]
Stock Position:  0.0014370277541875958
Bond Position:  [5.13433158]


portfolio before change:  [5.28027638]
curr_Stock_Price:  100.66684719682927
curr_Factors:  [100.6668472   -0.7596795   -1.04952624]
mat_Sqrt:  [[16.48763619  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00043851 -0.02875973  0.10452257]
Stock Position:  0.0004385102405362811
Bond Position:  [5.23613294]


portfolio before change:  [5.28217531]
curr_Stock_Price:  102.0117127461895
curr_Factors:  [102.01171275  -0.9270652   -1.06661778]
mat_Sqrt:  [[13.89327139  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273109 -0.00455813 -0.02970002]
Stock Position:  -0.002731088749797064
Bond Position:  [5.56077836]


portfolio before change:  [5.28309803]
curr_Stock_Price:  102.18294551938664
curr_Factors:  [102.18294552  -0.51641364  -1.09820288]
mat_Sqrt:  [[20.33102958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00917421 -0.06595314 -0.57203247]
Stock Position:  0.00917420619772191
Bond Position:  [4.34565062]


portfolio before change:  [5.2575123]
curr_Stock_Price:  99.27563358091065
curr_Factors:  [99.27563358 -0.1586619  -1.12089581]
mat_Sqrt:  [[27.61453997  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257819  0.02074936  0.08609255]
Stock Position:  -0.0025781895737865927
Bond Position:  [5.5134637]


portfolio before change:  [5.25766782]
curr_Stock_Price:  99.75000633589364
curr_Factors:  [99.75000634 -0.20011771 -1.15393126]
mat_Sqrt:  [[25.7547261   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209972  0.00024437 -0.10478414]
Stock Position:  -0.002099716233013326
Bond Position:  [5.46711452]


portfolio before change:  [5.25269611]
curr_Stock_Price:  102.76882193636015
curr_Factors:  [102.76882194  -0.44390617  -1.20590692]
mat_Sqrt:  [[19.74043223  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00353854 -0.05064922 -0.1658811 ]
Stock Position:  -0.003538543103682346
Bond Position:  [5.61634802]


portfolio before change:  [5.24638917]
curr_Stock_Price:  104.94802397553431
curr_Factors:  [104.94802398  -0.46092354  -1.23329631]
mat_Sqrt:  [[19.28341436  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0062721  -0.01321706 -0.33506336]
Stock Position:  -0.006272102228491441
Bond Position:  [5.90463391]


portfolio before change:  [5.25486999]
curr_Stock_Price:  103.83125753426143
curr_Factors:  [103.83125753  -0.12531628  -1.19341752]
mat_Sqrt:  [[27.7721372   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0110383   0.09641388  0.00618589]
Stock Position:  -0.011038300157001118
Bond Position:  [6.40099057]


portfolio before change:  [5.23633077]
curr_Stock_Price:  105.65578390669836
curr_Factors:  [105.65578391  -0.50609746  -1.15240366]
mat_Sqrt:  [[20.11941697  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00572316 -0.06420092  0.21943171]
Stock Position:  0.005723158930117129
Bond Position:  [4.63164592]


portfolio before change:  [5.23701255]
curr_Stock_Price:  105.57256538197143
curr_Factors:  [105.57256538  -0.2545435   -1.11688927]
mat_Sqrt:  [[26.78831459  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00402625  0.0011863  -0.00122368]
Stock Position:  -0.0040262484571196066
Bond Position:  [5.66207393]


portfolio before change:  [5.23261223]
curr_Stock_Price:  107.01708912547439
curr_Factors:  [107.01708913  -0.29090484  -1.09011772]
mat_Sqrt:  [[26.89568801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00599133  0.03946604 -0.33868894]
Stock Position:  -0.005991333829407854
Bond Position:  [5.87378734]


portfolio before change:  [5.25624631]
curr_Stock_Price:  103.31750377398811
curr_Factors:  [103.31750377  -0.26627953  -1.10649829]
mat_Sqrt:  [[26.18087014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0030833  -0.01666296  0.33043851]
Stock Position:  -0.003083299896940412
Bond Position:  [5.57480516]


portfolio before change:  [5.26151535]
curr_Stock_Price:  102.06068176744881
curr_Factors:  [102.06068177  -0.42329043  -1.0837941 ]
mat_Sqrt:  [[22.61205179  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00496555 -0.03702621  0.68356782]
Stock Position:  -0.004965551514074388
Bond Position:  [5.76830292]


portfolio before change:  [5.25685626]
curr_Stock_Price:  103.28941603349917
curr_Factors:  [103.28941603  -0.60123844  -1.04045738]
mat_Sqrt:  [[20.00213648  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00129125 0.0197444  0.17210149]
Stock Position:  0.001291248164907435
Bond Position:  [5.12348399]


portfolio before change:  [5.26107139]
curr_Stock_Price:  105.56170946573626
curr_Factors:  [105.56170947  -0.65901409  -1.06400649]
mat_Sqrt:  [[18.84551819  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00390386  0.01709418  0.22958692]
Stock Position:  -0.0039038590974163354
Bond Position:  [5.67316943]


portfolio before change:  [5.26338276]
curr_Stock_Price:  105.33298570426439
curr_Factors:  [105.3329857   -0.96768612  -1.06606543]
mat_Sqrt:  [[13.78216108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244388 -0.00561904  0.05942173]
Stock Position:  -0.002443876138065872
Bond Position:  [5.52080353]


portfolio before change:  [5.2653455]
curr_Stock_Price:  105.09469028987822
curr_Factors:  [105.09469029  -0.81233062  -1.05505226]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.2653455]
Stock Price:  104.85218399475119
PL:  [0.41316151]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [ 4.15335539e-02 -1.18811360e-01  4.68379259e-02]
 [ 4.95563142e-02  4.86019512e-02  6.62462183e-02]
 [-1.71206417e-02 -1.50840087e-01  3.67294482e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 4.96347859e-01 -3.27307525e-01 -1.84860984e-01]
 [ 2.98798968e-02  2.38002679e-02 -2.64521632e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-6.02480184e-02 -3.94707599e-02 -3.00834006e-02]
 [-8.44599332e-03  3.15027492e-02 -3.41420962e-02]
 [-2.17504627e-01  2.02952288e-01  1.22084632e-04]
 [ 6.57019124e-02 -1.21235154e-01  2.04486742e-03]
 [ 3.84248560e-02  9.03756056e-02  3.95295460e-02]
 [-1.48295098e-02  1.76034315e-01  4.80998207e-02]
 [-6.70717205e-02 -1.16100164e-01  1.45969712e-02]
 [-1.57321191e-01 -1.12001869e-01  2.26131784e-01]
 [ 1.58681723e-02  8.51492869e-02  1.05218073e-01]
 [-1.11851652e-01  5.27008820e-02  5.77834829e-02]
 [-4.68578483e-02 -4.55103660e-02  2.17786986e-02]
 [-2.27619868e-02  5.57259519e-01  2.88734329e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.53554119]
curr_Stock_Price:  98.35464839232266
curr_Factors:  [98.35464839 -0.91707119 -1.02051768]
mat_Sqrt:  [[14.16807128  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00338978 -0.03757145  0.13361557]
Stock Position:  0.003389777509590887
Bond Position:  [-9.86894157]


portfolio before change:  [-9.52830983]
curr_Stock_Price:  101.21587077559619
curr_Factors:  [101.21587078  -1.24154433  -1.05069156]
mat_Sqrt:  [[10.2268813   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00629064 0.01536929 0.18898202]
Stock Position:  0.006290643447140794
Bond Position:  [-10.16502278]


portfolio before change:  [-9.53265696]
curr_Stock_Price:  100.92884733852905
curr_Factors:  [100.92884734  -1.10773994  -1.05180725]
mat_Sqrt:  [[11.64490324  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00116085 -0.04769982  0.10477889]
Stock Position:  -0.0011608468136494981
Bond Position:  [-9.41549403]


portfolio before change:  [-9.53509367]
curr_Stock_Price:  100.99994664914438
curr_Factors:  [100.99994665  -1.0858605   -1.05562654]
mat_Sqrt:  [[11.86547542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00319783 -0.00455813 -0.02970002]
Stock Position:  -0.003197828647075586
Bond Position:  [-9.21211314]


portfolio before change:  [-9.5357789]
curr_Stock_Price:  100.49395265309944
curr_Factors:  [100.49395265  -1.14014661  -1.0790366 ]
mat_Sqrt:  [[10.92347717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04121052 -0.10350373 -0.52735693]
Stock Position:  0.04121052459573808
Bond Position:  [-13.67718741]


portfolio before change:  [-9.53610607]
curr_Stock_Price:  100.56899557524353
curr_Factors:  [100.56899558  -1.06422094  -1.115074  ]
mat_Sqrt:  [[11.37649154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00220586  0.00752631 -0.07546066]
Stock Position:  0.0022058551028264527
Bond Position:  [-9.7579467]


portfolio before change:  [-9.53849613]
curr_Stock_Price:  100.59154041902119
curr_Factors:  [100.59154042  -1.01067108  -1.12542641]
mat_Sqrt:  [[11.88135872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047691 -0.02845143  0.0120735 ]
Stock Position:  -0.00047690622084569907
Bond Position:  [-9.4905234]


portfolio before change:  [-9.54106365]
curr_Stock_Price:  100.9995702233115
curr_Factors:  [100.99957022  -0.86081568  -1.11681162]
mat_Sqrt:  [[13.97806011  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00482241 -0.01248175 -0.08581957]
Stock Position:  -0.004822407184536586
Bond Position:  [-9.0540026]


portfolio before change:  [-9.54261768]
curr_Stock_Price:  100.85239299917986
curr_Factors:  [100.852393    -0.65491354  -1.11674091]
mat_Sqrt:  [[17.15009207  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085141  0.00996204 -0.0973979 ]
Stock Position:  -0.0008514136232751776
Bond Position:  [-9.45675058]


portfolio before change:  [-9.54482736]
curr_Stock_Price:  100.67057525183664
curr_Factors:  [100.67057525  -0.65652952  -1.08426147]
mat_Sqrt:  [[17.65576869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01202097  0.06417915  0.00034827]
Stock Position:  -0.012020972024432362
Bond Position:  [-8.3346692]


portfolio before change:  [-9.53607231]
curr_Stock_Price:  99.76890241226407
curr_Factors:  [99.76890241 -0.72071414 -1.07937625]
mat_Sqrt:  [[16.49019797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00381979 -0.03833792  0.00583344]
Stock Position:  0.00381978682521869
Bond Position:  [-9.91716825]


portfolio before change:  [-9.53562608]
curr_Stock_Price:  100.5348690438023
curr_Factors:  [100.53486904  -0.29120298  -1.12125913]
mat_Sqrt:  [[24.48455521  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00199421 0.02857928 0.11276679]
Stock Position:  0.0019942073071020873
Bond Position:  [-9.73611345]


portfolio before change:  [-9.54037267]
curr_Stock_Price:  99.37538152715001
curr_Factors:  [99.37538153 -0.34977898 -1.12742664]
mat_Sqrt:  [[22.68488378  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.05418082e-05  5.56669383e-02  1.37215400e-01]
Stock Position:  -2.0541808162694852e-05
Bond Position:  [-9.53833132]


portfolio before change:  [-9.54280637]
curr_Stock_Price:  101.75198365874229
curr_Factors:  [101.75198366  -0.53330267  -1.14037303]
mat_Sqrt:  [[19.08423523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00351546 -0.0367141   0.0416411 ]
Stock Position:  -0.0035154575885275384
Bond Position:  [-9.18510159]


portfolio before change:  [-9.53985031]
curr_Stock_Price:  100.25783159804249
curr_Factors:  [100.2578316   -0.63166668  -1.14681038]
mat_Sqrt:  [[16.93306334  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00673559 -0.0354181   0.64509104]
Stock Position:  -0.006735586331381081
Bond Position:  [-8.86455503]


portfolio before change:  [-9.53614484]
curr_Stock_Price:  99.37863810426349
curr_Factors:  [99.3786381  -0.61480979 -1.13828574]
mat_Sqrt:  [[17.2160425   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00229694 0.02692657 0.30015788]
Stock Position:  0.0022969429063338606
Bond Position:  [-9.7644119]


portfolio before change:  [-9.53640201]
curr_Stock_Price:  100.3295724552503
curr_Factors:  [100.32957246  -0.83681392  -1.0874624 ]
mat_Sqrt:  [[14.64624757  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00673865  0.01666548  0.16484019]
Stock Position:  -0.006738648679290135
Bond Position:  [-8.86031626]


portfolio before change:  [-9.5464613]
curr_Stock_Price:  101.49359522480894
curr_Factors:  [101.49359522  -0.99802592  -1.08815617]
mat_Sqrt:  [[12.60147166  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00345891 -0.01439164  0.06212857]
Stock Position:  -0.0034589105031247644
Bond Position:  [-9.19540404]


portfolio before change:  [-9.548404]
curr_Stock_Price:  101.39054395781936
curr_Factors:  [101.39054396  -0.47168836  -1.15856515]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.548404]
Stock Price:  99.46638859291326
PL:  [-9.548404]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.22088031e-01 -6.83426898e-02  1.77994349e-01]
 [-1.73707730e-01  1.77005739e-01  8.26558168e-02]
 [-4.06364922e-02 -2.41869246e-01  4.07428841e-02]
 [-2.43719454e-02  2.48630496e-02  1.52025182e-02]
 [ 4.83297100e-01 -2.95210452e-01 -1.42692372e-01]
 [-9.53044866e-02  6.99677337e-02  2.63223648e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 1.32447916e-01 -6.16218123e-03 -1.18328185e-02]
 [-9.55476285e-02  1.95771916e-02  9.08994844e-02]
 [-1.31887967e-01  1.12631863e-01 -3.15403959e-02]
 [ 4.92294134e-02 -1.11555353e-01  2.94740923e-03]
 [ 8.40542165e-02  1.06314941e-01 -1.00854981e-02]
 [-1.17397033e-02  1.63614542e-01  4.69069700e-02]
 [-5.12235428e-02 -1.15422201e-01 -3.31552202e-02]
 [-1.66474411e-01 -1.18803517e-01  2.37667765e-01]
 [ 2.24979699e-03  7.75299396e-02  7.13544248e-02]
 [-1.06881395e-01  6.16384013e-02  5.28547342e-02]
 [-5.18029187e-02 -5.92668589e-02  2.17329905e-02]
 [-3.75973867e-02  4.36684563e-01  1.71249710e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.72742076]
curr_Stock_Price:  99.30301159274197
curr_Factors:  [99.30301159 -1.17023133 -1.01441704]
mat_Sqrt:  [[11.17330587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01678283 -0.02161186  0.50776833]
Stock Position:  -0.01678282953272944
Bond Position:  [-1.06083524]


portfolio before change:  [-2.72367607]
curr_Stock_Price:  99.06408098783223
curr_Factors:  [99.06408099 -1.0419417  -1.02173829]
mat_Sqrt:  [[12.57973182  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01210403  0.05597413  0.23579404]
Stock Position:  -0.012104026993654707
Bond Position:  [-1.52460176]


portfolio before change:  [-2.73598645]
curr_Stock_Price:  100.04963621319048
curr_Factors:  [100.04963621  -0.96059381  -0.99810322]
mat_Sqrt:  [[14.11120826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273293 -0.07648577  0.11622811]
Stock Position:  -0.0027329284746971188
Bond Position:  [-2.46255795]


portfolio before change:  [-2.73320105]
curr_Stock_Price:  98.80513869188366
curr_Factors:  [98.80513869 -1.07437451 -1.02113725]
mat_Sqrt:  [[12.1537511   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00169715  0.00786239  0.04336855]
Stock Position:  -0.0016971536646798369
Bond Position:  [-2.56551354]


portfolio before change:  [-2.73369842]
curr_Stock_Price:  98.72023853480496
curr_Factors:  [98.72023853 -1.03487965 -1.04101677]
mat_Sqrt:  [[12.38385434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03605887 -0.09335374 -0.40706162]
Stock Position:  0.03605887373172547
Bond Position:  [-6.29343903]


portfolio before change:  [-2.75735868]
curr_Stock_Price:  98.10772072585226
curr_Factors:  [98.10772073 -1.04153207 -1.0600969 ]
mat_Sqrt:  [[11.9943666   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00734719  0.02212574  0.07509038]
Stock Position:  -0.007347190580168112
Bond Position:  [-2.03654256]


portfolio before change:  [-2.75581593]
curr_Stock_Price:  97.8284380076874
curr_Factors:  [97.82843801 -0.69277498 -1.10339037]
mat_Sqrt:  [[16.23306079  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034906 -0.02845143  0.0120735 ]
Stock Position:  -0.0003490588718884556
Bond Position:  [-2.72166805]


portfolio before change:  [-2.75647139]
curr_Stock_Price:  97.75669216208527
curr_Factors:  [97.75669216 -0.26849968 -1.12891715]
mat_Sqrt:  [[24.1688553   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00537359 -0.00194865 -0.03375574]
Stock Position:  0.005373586933611254
Bond Position:  [-3.28177547]


portfolio before change:  [-2.75351122]
curr_Stock_Price:  98.46026628173588
curr_Factors:  [98.46026628 -0.26266959 -1.10916652]
mat_Sqrt:  [[24.97354262  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306274  0.00619085  0.25931093]
Stock Position:  -0.003062735998978567
Bond Position:  [-2.45195342]


portfolio before change:  [-2.75617567]
curr_Stock_Price:  99.130054852766
curr_Factors:  [99.13005485 -0.48510304 -1.17195059]
mat_Sqrt:  [[18.904104    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00716342  0.03561732 -0.08997597]
Stock Position:  -0.0071634170707062786
Bond Position:  [-2.04606574]


portfolio before change:  [-2.75687977]
curr_Stock_Price:  99.15693057823505
curr_Factors:  [99.15693058 -0.72031465 -1.2003914 ]
mat_Sqrt:  [[14.52683604  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.003232   -0.0352769   0.00840814]
Stock Position:  0.0032319979245211943
Bond Position:  [-3.07735477]


portfolio before change:  [-2.75894388]
curr_Stock_Price:  98.7563512231303
curr_Factors:  [98.75635122 -0.41668803 -1.23526043]
mat_Sqrt:  [[18.92922938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0044767   0.03361974 -0.02877112]
Stock Position:  0.004476704312055447
Bond Position:  [-3.20104686]


portfolio before change:  [-2.75764191]
curr_Stock_Price:  99.22596770365834
curr_Factors:  [99.2259677  -0.70304854 -1.24837819]
mat_Sqrt:  [[14.09715526  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0001461  0.05173946 0.13381253]
Stock Position:  0.00014610402848250909
Bond Position:  [-2.77213922]


portfolio before change:  [-2.75818918]
curr_Stock_Price:  100.2242552765383
curr_Factors:  [100.22425528  -0.64456058  -1.22764754]
mat_Sqrt:  [[15.41285827  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00395589 -0.0364997  -0.09458261]
Stock Position:  -0.003955886125215679
Bond Position:  [-2.36171343]


portfolio before change:  [-2.76077602]
curr_Stock_Price:  100.72890514140775
curr_Factors:  [100.72890514  -0.5684003   -1.22441728]
mat_Sqrt:  [[16.7703964   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00721677 -0.03756897  0.67799998]
Stock Position:  -0.007216774873827581
Bond Position:  [-2.03383818]


portfolio before change:  [-2.7637929]
curr_Stock_Price:  101.07647910856018
curr_Factors:  [101.07647911  -0.69335697  -1.26638895]
mat_Sqrt:  [[14.24109119  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0013213  0.02451712 0.20355431]
Stock Position:  0.001321301306109657
Bond Position:  [-2.89734539]


portfolio before change:  [-2.76534116]
curr_Stock_Price:  100.45297813922177
curr_Factors:  [100.45297814  -1.06431735  -1.22776606]
mat_Sqrt:  [[10.15134617  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00930921  0.01949177  0.15077984]
Stock Position:  -0.00930920584814634
Bond Position:  [-1.83020371]


portfolio before change:  [-2.75958472]
curr_Stock_Price:  99.7854613389344
curr_Factors:  [99.78546134 -1.24098904 -1.26541188]
mat_Sqrt:  [[ 8.13862773  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00600801 -0.01874183  0.06199817]
Stock Position:  -0.006008009703010501
Bond Position:  [-2.1600727]


portfolio before change:  [-2.75814726]
curr_Stock_Price:  99.45630949340605
curr_Factors:  [99.45630949 -1.19434635 -1.30113332]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.75814726]
Stock Price:  99.2783830305282
PL:  [-2.75814726]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.01580384e-01 -3.25212107e-02  9.75015361e-02]
 [ 6.32511500e-02  3.27272618e-02  3.01523864e-02]
 [ 1.64185884e-03 -1.08101197e-01  4.18210210e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 2.81363713e-01 -2.40706607e-01 -2.18096725e-01]
 [ 4.10302252e-03  4.21434556e-02  1.53022906e-02]
 [ 1.54373611e-02 -7.83732931e-02 -8.52208615e-04]
 [-8.22099491e-02 -1.20291514e-01 -5.57087478e-02]
 [-6.44736399e-02 -2.10969868e-02 -1.09677204e-01]
 [-3.42553938e-01  3.36010376e-01  4.99250880e-02]
 [ 1.19927852e-01 -1.52669210e-01 -4.30132422e-03]
 [ 1.56217105e-02  7.76857672e-02  4.46042149e-02]
 [-3.52580839e-02  1.84620187e-01  2.74702327e-02]
 [-6.33930410e-02 -6.04267149e-02  1.38002033e-04]
 [-1.49022019e-01 -1.08315862e-01  2.22588603e-01]
 [ 3.87216397e-02  9.37741048e-02  1.54552658e-01]
 [-1.00611732e-01  4.55725730e-02  7.98046200e-02]
 [-4.36420528e-02 -3.63131412e-02  2.16496756e-02]
 [-3.01953491e-02  4.95269058e-01  2.38866977e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.46703092]
curr_Stock_Price:  100.02659262652065
curr_Factors:  [100.02659263  -1.11793774  -1.00551757]
mat_Sqrt:  [[11.96494081  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02361212 -0.01028411  0.27814474]
Stock Position:  -0.02361212352877553
Bond Position:  [4.82887118]


portfolio before change:  [2.44868461]
curr_Stock_Price:  100.85471314362414
curr_Factors:  [100.85471314  -0.84664511  -1.00076926]
mat_Sqrt:  [[15.89916559  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00441853 0.01034927 0.08601637]
Stock Position:  0.0044185334073859
Bond Position:  [2.00305469]


portfolio before change:  [2.44669706]
curr_Stock_Price:  100.29154555219515
curr_Factors:  [100.29154555  -0.60855152  -0.9938263 ]
mat_Sqrt:  [[20.20042366  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0003657  -0.0341846   0.11930373]
Stock Position:  0.0003657041164458787
Bond Position:  [2.41002003]


portfolio before change:  [2.44793331]
curr_Stock_Price:  102.02428367979124
curr_Factors:  [102.02428368  -0.91162178  -1.01062185]
mat_Sqrt:  [[14.9239488   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254247 -0.00455813 -0.02970002]
Stock Position:  -0.0025424743613517787
Bond Position:  [2.70732743]


portfolio before change:  [2.44943562]
curr_Stock_Price:  101.69964343027942
curr_Factors:  [101.69964343  -0.66050427  -0.95844611]
mat_Sqrt:  [[20.14736323  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01144715 -0.07611811 -0.62216925]
Stock Position:  0.011447149912897405
Bond Position:  [1.28526455]


portfolio before change:  [2.43095755]
curr_Stock_Price:  100.05736380694037
curr_Factors:  [100.05736381  -0.27339447  -0.92557116]
mat_Sqrt:  [[30.16788751  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00027562 0.01332693 0.04365318]
Stock Position:  0.0002756152164903886
Bond Position:  [2.40338022]


portfolio before change:  [2.43238625]
curr_Stock_Price:  103.06073838274892
curr_Factors:  [103.06073838  -0.6484756   -0.95157029]
mat_Sqrt:  [[20.8066493   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00063633 -0.02478381 -0.00243111]
Stock Position:  0.0006363261464411103
Bond Position:  [2.366806]


portfolio before change:  [2.43363617]
curr_Stock_Price:  104.09503506166044
curr_Factors:  [104.09503506  -0.63910796  -0.95439449]
mat_Sqrt:  [[21.15342495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00457077 -0.03803952 -0.15892155]
Stock Position:  -0.004570766361843299
Bond Position:  [2.90943026]


portfolio before change:  [2.4344371]
curr_Stock_Price:  104.07895868606762
curr_Factors:  [104.07895869  -0.47131239  -0.94332798]
mat_Sqrt:  [[25.29253928  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00345581 -0.00667145 -0.31287854]
Stock Position:  -0.0034558067247433422
Bond Position:  [2.79411387]


portfolio before change:  [2.43901031]
curr_Stock_Price:  102.95777505911879
curr_Factors:  [102.95777506  -0.92280005  -0.92255006]
mat_Sqrt:  [[16.26424026  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01990178  0.10625581  0.14242238]
Stock Position:  -0.019901776332330163
Bond Position:  [4.48805292]


portfolio before change:  [2.45621583]
curr_Stock_Price:  102.1496377062504
curr_Factors:  [102.14963771  -0.67217097  -0.91931391]
mat_Sqrt:  [[20.80001907  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00553403 -0.04827824 -0.01227048]
Stock Position:  0.0055340307824011175
Bond Position:  [1.89091659]


portfolio before change:  [2.44884641]
curr_Stock_Price:  100.73254853870216
curr_Factors:  [100.73254854  -0.39416217  -0.91565222]
mat_Sqrt:  [[27.18470719  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00098336 0.0245664  0.12724341]
Stock Position:  0.0009833597045204175
Bond Position:  [2.34979008]


portfolio before change:  [2.45094611]
curr_Stock_Price:  102.2703147460127
curr_Factors:  [102.27031475  -0.58511988  -0.89244145]
mat_Sqrt:  [[23.33742095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106626  0.05838203  0.07836493]
Stock Position:  -0.0010662649241064818
Bond Position:  [2.55999335]


portfolio before change:  [2.45202972]
curr_Stock_Price:  101.85434653971878
curr_Factors:  [101.85434654  -0.60197565  -0.87973413]
mat_Sqrt:  [[23.14627921  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280499 -0.01910861  0.00039368]
Stock Position:  -0.0028049900327236023
Bond Position:  [2.73773014]


portfolio before change:  [2.45256466]
curr_Stock_Price:  101.90767245474187
curr_Factors:  [101.90767245  -0.87553665  -0.92036604]
mat_Sqrt:  [[16.9143866   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0062895  -0.03425248  0.63498333]
Stock Position:  -0.006289498811959845
Bond Position:  [3.09351284]


portfolio before change:  [2.44964717]
curr_Stock_Price:  102.49451693783041
curr_Factors:  [102.49451694  -1.11952146  -0.9398996 ]
mat_Sqrt:  [[13.07089812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00556127 0.02965398 0.44089571]
Stock Position:  0.005561270941448372
Bond Position:  [1.87964739]


portfolio before change:  [2.45742608]
curr_Stock_Price:  103.80877360409819
curr_Factors:  [103.8087736   -1.19753139  -0.9857255 ]
mat_Sqrt:  [[11.69654622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00710851  0.01441131  0.22766037]
Stock Position:  -0.007108508906152623
Bond Position:  [3.19535167]


portfolio before change:  [2.46458687]
curr_Stock_Price:  102.913811201316
curr_Factors:  [102.9138112   -1.47712807  -1.00762687]
mat_Sqrt:  [[ 8.57745211  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00468209 -0.01148322  0.0617605 ]
Stock Position:  -0.004682093467746124
Bond Position:  [2.94643895]


portfolio before change:  [2.46738432]
curr_Stock_Price:  102.47367719117358
curr_Factors:  [102.47367719  -1.27669677  -1.01931264]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.46738432]
Stock Price:  103.9583586615701
PL:  [-1.49097434]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [ 2.00496310e-02 -1.09265512e-01  6.25263776e-02]
 [-3.19371915e-01  2.38163924e-01 -5.84972060e-03]
 [-6.96950935e-02 -3.12189074e-01  6.56340510e-03]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 4.87034051e-01 -3.11701770e-01 -1.61381747e-01]
 [-8.84566788e-02  6.82077047e-02  2.66413454e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 2.39032105e-01  1.21210233e-02 -4.92578442e-03]
 [-3.06242487e-01 -1.07025988e-02  4.00634564e-01]
 [-5.10318088e-02  4.97866061e-02 -5.06678493e-02]
 [-3.01718580e-02 -6.32666432e-02 -3.08888703e-03]
 [ 1.27701120e-01  7.60279864e-02 -1.01734297e-01]
 [ 3.94003802e-02  1.26749979e-01  9.21826696e-02]
 [ 1.53233532e-01 -2.02276607e-01  1.16733068e-01]
 [-1.28344108e-01 -9.04693442e-02  1.89611401e-01]
 [ 1.56633179e-02  1.37870632e-01  2.12046311e-01]
 [-7.22103283e-02  1.09473596e-01  3.60763015e-02]
 [-5.05861769e-02 -5.68524512e-02  2.23571626e-02]
 [-2.73748292e-02  5.21414259e-01  2.51467905e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.05229746]
curr_Stock_Price:  98.42196367837786
curr_Factors:  [98.42196368 -0.9223122  -1.00799067]
mat_Sqrt:  [[14.28144459  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210004 -0.03455279  0.17837035]
Stock Position:  0.0021000362256533697
Bond Position:  [-9.25898715]


portfolio before change:  [-9.05417392]
curr_Stock_Price:  98.63080458954977
curr_Factors:  [98.63080459 -0.66350266 -1.01420701]
mat_Sqrt:  [[18.42436467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01706526  0.07531405 -0.01668762]
Stock Position:  -0.017065262434321642
Bond Position:  [-7.37101336]


portfolio before change:  [-9.06721517]
curr_Stock_Price:  99.28700679170221
curr_Factors:  [99.28700679 -0.89274047 -0.98189386]
mat_Sqrt:  [[15.23172449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0050169  -0.09872285  0.01872357]
Stock Position:  -0.00501689952283475
Bond Position:  [-8.56910223]


portfolio before change:  [-9.0730833]
curr_Stock_Price:  100.02961424950674
curr_Factors:  [100.02961425  -0.92986325  -0.9749327 ]
mat_Sqrt:  [[14.88970955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254832 -0.00455813 -0.02970002]
Stock Position:  -0.0025483208428833714
Bond Position:  [-8.81817575]


portfolio before change:  [-9.07374698]
curr_Stock_Price:  99.42484785449514
curr_Factors:  [99.42484785 -0.88548086 -1.02072917]
mat_Sqrt:  [[14.77877505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03018139 -0.09856875 -0.4603772 ]
Stock Position:  0.030181394175296916
Bond Position:  [-12.0745275]


portfolio before change:  [-9.10669316]
curr_Stock_Price:  98.43327101970621
curr_Factors:  [98.43327102 -0.844579   -0.98691265]
mat_Sqrt:  [[15.76649651  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0051538   0.02156917  0.07600034]
Stock Position:  -0.005153803290914772
Bond Position:  [-8.59938744]


portfolio before change:  [-9.10468087]
curr_Stock_Price:  97.62563394603474
curr_Factors:  [97.62563395 -0.34836849 -0.99065433]
mat_Sqrt:  [[25.58784115  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00022144 -0.02845143  0.0120735 ]
Stock Position:  -0.00022144478128248435
Bond Position:  [-9.08306218]


portfolio before change:  [-9.10682635]
curr_Stock_Price:  97.05857862033362
curr_Factors:  [97.05857862 -0.28984529 -0.98141791]
mat_Sqrt:  [[27.22270847  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00875518  0.003833   -0.01405189]
Stock Position:  0.008755175746263354
Bond Position:  [-9.95659126]


portfolio before change:  [-9.12609809]
curr_Stock_Price:  95.14173697189943
curr_Factors:  [95.14173697 -0.75333758 -0.99258118]
mat_Sqrt:  [[16.6007685   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01353791 -0.00338446  1.1428989 ]
Stock Position:  -0.013537905694913862
Bond Position:  [-7.83807823]


portfolio before change:  [-9.15419114]
curr_Stock_Price:  97.07211547270975
curr_Factors:  [97.07211547 -0.70939511 -1.03665524]
mat_Sqrt:  [[16.93536106  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00354813  0.01574391 -0.14454127]
Stock Position:  -0.0035481295829915003
Bond Position:  [-8.8097667]


portfolio before change:  [-9.1494431]
curr_Stock_Price:  95.1131240638451
curr_Factors:  [95.11312406 -0.98858654 -1.00423707]
mat_Sqrt:  [[12.9648695   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00250183 -0.02000667 -0.00881173]
Stock Position:  -0.0025018309753666377
Bond Position:  [-8.91148614]


portfolio before change:  [-9.15167634]
curr_Stock_Price:  95.11515932231877
curr_Factors:  [95.11515932 -1.19019274 -1.0004183 ]
mat_Sqrt:  [[10.63847679  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01023621  0.02404216 -0.29021963]
Stock Position:  0.010236214219729542
Bond Position:  [-10.12529549]


portfolio before change:  [-9.14811442]
curr_Stock_Price:  95.7104541301424
curr_Factors:  [95.71045413 -1.20493964 -0.99462321]
mat_Sqrt:  [[10.60965761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00579564 0.04008186 0.2629715 ]
Stock Position:  0.005795640298555219
Bond Position:  [-9.70281778]


portfolio before change:  [-9.15385455]
curr_Stock_Price:  95.13862365224702
curr_Factors:  [95.13862365 -1.05224069 -0.91863704]
mat_Sqrt:  [[13.25609304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01296301 -0.06396548  0.33300695]
Stock Position:  0.012963005763425491
Bond Position:  [-10.38713708]


portfolio before change:  [-9.10143122]
curr_Stock_Price:  99.3830437789144
curr_Factors:  [99.38304378 -1.23168965 -0.96933513]
mat_Sqrt:  [[11.00067599  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00836092 -0.02860892  0.54090855]
Stock Position:  -0.008360918084450502
Bond Position:  [-8.27049773]


portfolio before change:  [-9.10749868]
curr_Stock_Price:  99.86140968564563
curr_Factors:  [99.86140969 -1.31275367 -1.0243196 ]
mat_Sqrt:  [[ 9.64760844  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.006479   0.04359852 0.6049091 ]
Stock Position:  0.006479004060575565
Bond Position:  [-9.75450116]


portfolio before change:  [-9.10856463]
curr_Stock_Price:  100.07332161542807
curr_Factors:  [100.07332162  -1.18967405  -1.0374825 ]
mat_Sqrt:  [[10.7913683   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00574716  0.03461859  0.10291565]
Stock Position:  -0.0057471570134350995
Bond Position:  [-8.53342754]


portfolio before change:  [-9.1096075]
curr_Stock_Price:  99.88353114719717
curr_Factors:  [99.88353115 -1.0219971  -1.03853125]
mat_Sqrt:  [[12.72382822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0037324  -0.01797832  0.06377876]
Stock Position:  -0.0037324037533376414
Bond Position:  [-8.73680183]


portfolio before change:  [-9.11308833]
curr_Stock_Price:  100.23085705259099
curr_Factors:  [100.23085705  -0.74736167  -1.03781539]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.11308833]
Stock Price:  101.33225998184194
PL:  [-10.44534831]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.04381994e-01 -3.27938918e-02  9.88046071e-02]
 [-8.75927722e-02  1.31709529e-01  9.48836270e-02]
 [-6.36943900e-02 -4.14111509e-01  2.56362023e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 5.83120003e-01 -3.52878390e-01 -1.61647529e-01]
 [-9.81042457e-02  7.05580828e-02  2.84842807e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 3.06436701e-01  2.14750950e-02  9.66553777e-03]
 [-2.03079130e-01  2.29824292e-03  2.58235064e-01]
 [-6.08368960e-02  5.90325135e-02 -4.41241913e-02]
 [-2.82833493e-02 -6.44177111e-02 -3.55869672e-03]
 [ 1.27787000e-01  9.68185526e-02 -7.83452191e-02]
 [ 3.78829845e-02  1.35524519e-01  9.42013893e-02]
 [ 1.50717340e-01 -2.14429295e-01  1.07072140e-01]
 [ 7.02945929e-03  2.49605019e-02  2.82312938e-02]
 [-3.57520464e-02  2.26472913e-01  3.48994529e-01]
 [ 5.17405302e-03 -6.41958189e-03 -3.10859322e-02]
 [ 4.58106207e-02  4.82488986e-02  1.51448216e-01]
 [-4.17324811e-02  4.10934187e-01  1.23537417e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.6382812]
curr_Stock_Price:  100.05044758960322
curr_Factors:  [100.05044759  -1.23316643  -1.01828975]
mat_Sqrt:  [[10.529895    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02707153 -0.01037034  0.28186204]
Stock Position:  -0.027071525618913923
Bond Position:  [5.34679946]


portfolio before change:  [2.65119203]
curr_Stock_Price:  99.62291499159271
curr_Factors:  [99.62291499 -1.2692644  -0.99172925]
mat_Sqrt:  [[10.38537489  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00624186  0.04165021  0.27067658]
Stock Position:  -0.0062418553251598
Bond Position:  [3.27302385]


portfolio before change:  [2.6507771]
curr_Stock_Price:  99.82049902502041
curr_Factors:  [99.82049903 -1.45519754 -0.97356673]
mat_Sqrt:  [[ 8.7987467   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0078595  -0.13095356  0.07313295]
Stock Position:  -0.007859498372990494
Bond Position:  [3.43531614]


portfolio before change:  [2.65278321]
curr_Stock_Price:  99.6745378828644
curr_Factors:  [99.67453788 -1.31202953 -0.97656711]
mat_Sqrt:  [[10.10786281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00375389 -0.00455813 -0.02970002]
Stock Position:  -0.003753885258905108
Bond Position:  [3.02694999]


portfolio before change:  [2.65709364]
curr_Stock_Price:  98.72789313572306
curr_Factors:  [98.72789314 -1.11733155 -0.98710814]
mat_Sqrt:  [[12.03630889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04494838 -0.11158995 -0.46113541]
Stock Position:  0.044948377748787155
Bond Position:  [-1.78056499]


portfolio before change:  [2.6313581]
curr_Stock_Price:  98.16524000520955
curr_Factors:  [98.16524001 -0.7943072  -0.95024752]
mat_Sqrt:  [[17.15170279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00527459  0.02231242  0.08125772]
Stock Position:  -0.005274585006992647
Bond Position:  [3.149139]


portfolio before change:  [2.63344897]
curr_Stock_Price:  97.91811467786178
curr_Factors:  [97.91811468 -0.97371391 -0.92775588]
mat_Sqrt:  [[14.62396727  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00038747 -0.02845143  0.0120735 ]
Stock Position:  -0.0003874662589034036
Bond Position:  [2.67138893]


portfolio before change:  [2.63421835]
curr_Stock_Price:  97.65627265816417
curr_Factors:  [97.65627266 -0.96065807 -0.93477778]
mat_Sqrt:  [[14.67313169  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02105646 0.00679102 0.02757309]
Stock Position:  0.0210564562247178
Bond Position:  [0.57792332]


portfolio before change:  [2.62072295]
curr_Stock_Price:  97.00849508530119
curr_Factors:  [97.00849509 -1.10455401 -0.91624755]
mat_Sqrt:  [[12.8583961   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.16894655e-02  7.26768223e-04  7.36672758e-01]
Stock Position:  -0.011689465534237787
Bond Position:  [3.75470041]


portfolio before change:  [2.62401406]
curr_Stock_Price:  96.80726090520264
curr_Factors:  [96.80726091 -0.89061409 -0.95905538]
mat_Sqrt:  [[15.22673146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00448681  0.01866772 -0.12587404]
Stock Position:  -0.004486812949357038
Bond Position:  [3.05837013]


portfolio before change:  [2.62997237]
curr_Stock_Price:  95.64973133550089
curr_Factors:  [95.64973134 -1.34467529 -0.95286911]
mat_Sqrt:  [[ 9.61330887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00319068 -0.02037067 -0.01015197]
Stock Position:  -0.003190683226994927
Bond Position:  [2.93516036]


portfolio before change:  [2.63091866]
curr_Stock_Price:  95.5831581488321
curr_Factors:  [95.58315815 -1.41048109 -0.95783551]
mat_Sqrt:  [[ 8.95023725  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01277002  0.03061671 -0.2234971 ]
Stock Position:  0.012770018294331898
Bond Position:  [1.41031999]


portfolio before change:  [2.63917639]
curr_Stock_Price:  96.2021945303833
curr_Factors:  [96.20219453 -1.17287559 -0.94648864]
mat_Sqrt:  [[11.55464984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00524559 0.04285662 0.26873034]
Stock Position:  0.005245593023750832
Bond Position:  [2.13453883]


portfolio before change:  [2.63688398]
curr_Stock_Price:  95.66343482121664
curr_Factors:  [95.66343482 -1.24378276 -0.91813461]
mat_Sqrt:  [[11.01126428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01516963 -0.0678085   0.30544701]
Stock Position:  0.015169630303583597
Bond Position:  [1.18570504]


portfolio before change:  [2.63793788]
curr_Stock_Price:  95.71336557452796
curr_Factors:  [95.71336557 -1.54556431 -0.92575523]
mat_Sqrt:  [[ 8.08522566  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00166187 0.0078932  0.08053602]
Stock Position:  0.0016618738880121247
Bond Position:  [2.47887433]


portfolio before change:  [2.63854695]
curr_Stock_Price:  95.70691612756035
curr_Factors:  [95.70691613 -1.22100325 -0.92611492]
mat_Sqrt:  [[11.18051349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00369694 0.07161702 0.99558425]
Stock Position:  0.0036969383406760836
Bond Position:  [2.28472439]


portfolio before change:  [2.63744867]
curr_Stock_Price:  95.25531757173881
curr_Factors:  [95.25531757 -0.99592287 -0.89826953]
mat_Sqrt:  [[14.33018916  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.33057609e-05 -2.03005004e-03 -8.86795119e-02]
Stock Position:  -9.33057609110034e-05
Bond Position:  [2.64633654]


portfolio before change:  [2.63812272]
curr_Stock_Price:  95.12264399022926
curr_Factors:  [95.12264399 -1.46339222 -0.88581998]
mat_Sqrt:  [[ 9.07891644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0085881  0.01525764 0.4320396 ]
Stock Position:  0.00858809968782161
Bond Position:  [1.82119997]


portfolio before change:  [2.63969667]
curr_Stock_Price:  95.2528935158681
curr_Factors:  [95.25289352 -1.27789988 -0.89736308]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.63969667]
Stock Price:  95.85527992130382
PL:  [2.63969667]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.03202920e-01 -3.26791324e-02  9.82562023e-02]
 [-5.17187728e-02  1.12839913e-01  9.99775208e-02]
 [-4.48684934e-02 -3.01119229e-01  4.42162092e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 6.95498885e-01 -4.31455120e-01 -2.06235501e-01]
 [-6.42509166e-02  5.41198864e-02 -3.97286721e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 7.46143487e-02 -2.04870542e-02  4.80813735e-03]
 [-4.77103786e-02  2.73483206e-02  1.72879574e-02]
 [-3.05415654e-01  2.84705117e-01  1.97869822e-02]
 [ 3.54376441e-02 -1.03678801e-01  5.48840980e-03]
 [ 6.50911377e-02  9.92582348e-02  1.21145609e-02]
 [ 7.16303510e-03  1.55626250e-01  6.59787562e-02]
 [-3.63574618e-02 -1.20558362e-01 -8.35682391e-02]
 [-1.26860421e-01 -8.93668346e-02  1.87741482e-01]
 [-1.56417276e-02  1.63350630e-01  2.31911578e-01]
 [-3.34929084e-02  9.26653821e-02  1.28129676e-02]
 [-1.58287607e-02 -1.15101668e-02  5.77922145e-02]
 [-3.14404554e-02  4.91708182e-01  2.07326222e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.0704852]
curr_Stock_Price:  100.11065309988474
curr_Factors:  [100.1106531   -1.36350489  -0.98829784]
mat_Sqrt:  [[ 9.53027308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02979875 -0.01033405  0.2802976 ]
Stock Position:  -0.029798750381655473
Bond Position:  [6.05365756]


portfolio before change:  [3.06455829]
curr_Stock_Price:  100.36034519019232
curr_Factors:  [100.36034519  -1.75661759  -1.00968781]
mat_Sqrt:  [[ 6.31205794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00449892  0.03568311  0.28520804]
Stock Position:  -0.004498918272588679
Bond Position:  [3.51607128]


portfolio before change:  [3.06558877]
curr_Stock_Price:  100.32670233663619
curr_Factors:  [100.32670234  -1.71606152  -1.03633854]
mat_Sqrt:  [[ 6.39829676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00681709 -0.09522226  0.12613654]
Stock Position:  -0.006817089647752411
Bond Position:  [3.7495249]


portfolio before change:  [3.07051834]
curr_Stock_Price:  99.7411053073122
curr_Factors:  [99.74110531 -1.49455014 -1.06908637]
mat_Sqrt:  [[ 7.68247203  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.004939   -0.00455813 -0.02970002]
Stock Position:  -0.004939003624122907
Bond Position:  [3.56314002]


portfolio before change:  [3.0694006]
curr_Stock_Price:  100.1477938858684
curr_Factors:  [100.14779389  -1.59912363  -1.09889323]
mat_Sqrt:  [[ 6.74384455  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09523664 -0.13643809 -0.58833248]
Stock Position:  0.09523664295799462
Bond Position:  [-6.46833909]


portfolio before change:  [3.11858432]
curr_Stock_Price:  100.68121259722514
curr_Factors:  [100.6812126   -1.79159051  -1.10273094]
mat_Sqrt:  [[ 5.57135208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01273715  0.01711421 -0.11333484]
Stock Position:  -0.012737146644291349
Bond Position:  [4.40097569]


portfolio before change:  [3.12287615]
curr_Stock_Price:  100.43064999435114
curr_Factors:  [100.43064999  -1.72569365  -1.08096803]
mat_Sqrt:  [[ 6.06664515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093401 -0.02845143  0.0120735 ]
Stock Position:  -0.0009340077988267782
Bond Position:  [3.21667916]


portfolio before change:  [3.12383948]
curr_Stock_Price:  100.2603573972288
curr_Factors:  [100.2603574   -1.50333682  -1.08811217]
mat_Sqrt:  [[ 7.51064524  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00999472 -0.00647858  0.01371628]
Stock Position:  0.00999472478810054
Bond Position:  [2.1217648]


portfolio before change:  [3.12823524]
curr_Stock_Price:  100.64708677293206
curr_Factors:  [100.64708677  -1.81275459  -1.12551572]
mat_Sqrt:  [[ 5.32999288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00815674  0.0086483   0.04931773]
Stock Position:  -0.00815673854812015
Bond Position:  [3.94918721]


portfolio before change:  [3.13418631]
curr_Stock_Price:  100.03855302820938
curr_Factors:  [100.03855303  -1.52279875  -1.09137549]
mat_Sqrt:  [[ 7.32564648  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04013647  0.09003166  0.05644675]
Stock Position:  -0.04013647109558844
Bond Position:  [7.1493808]


portfolio before change:  [3.14763526]
curr_Stock_Price:  99.74800979237507
curr_Factors:  [99.74800979 -1.30273195 -1.0967971 ]
mat_Sqrt:  [[ 9.05319787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00374243 -0.03278612  0.01565691]
Stock Position:  0.0037424329394693248
Bond Position:  [2.77433502]


portfolio before change:  [3.14601515]
curr_Stock_Price:  99.12975571873395
curr_Factors:  [99.12975572 -1.07685064 -1.08303058]
mat_Sqrt:  [[11.43350904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00613345 0.03138821 0.03455947]
Stock Position:  0.006133449362819048
Bond Position:  [2.53800782]


portfolio before change:  [3.14507414]
curr_Stock_Price:  98.87286944954009
curr_Factors:  [98.87286945 -1.23751469 -1.09061789]
mat_Sqrt:  [[ 9.63789082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00255752 0.04921334 0.18821903]
Stock Position:  0.002557524799711737
Bond Position:  [2.89220432]


portfolio before change:  [3.14791101]
curr_Stock_Price:  99.69934642854015
curr_Factors:  [99.69934643 -1.05004698 -1.06391388]
mat_Sqrt:  [[12.03956441  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00469523 -0.0381239  -0.23839693]
Stock Position:  -0.0046952330452911355
Bond Position:  [3.61602268]


portfolio before change:  [3.15804541]
curr_Stock_Price:  97.7334637552981
curr_Factors:  [97.73346376 -0.69757603 -1.05784652]
mat_Sqrt:  [[16.89168452  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00537811 -0.02826027  0.53557419]
Stock Position:  -0.005378107393570418
Bond Position:  [3.68366647]


portfolio before change:  [3.16029091]
curr_Stock_Price:  97.48719316791362
curr_Factors:  [97.48719317 -0.96200067 -1.0161176 ]
mat_Sqrt:  [[13.4853343   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00266324 0.051656   0.66157918]
Stock Position:  0.0026632428542647997
Bond Position:  [2.90065884]


portfolio before change:  [3.15774333]
curr_Stock_Price:  96.25830117785551
curr_Factors:  [96.25830118 -0.77049485 -1.03641515]
mat_Sqrt:  [[15.80182141  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180263  0.02930337  0.03655183]
Stock Position:  -0.0018026315934593995
Bond Position:  [3.33126158]


portfolio before change:  [3.15730567]
curr_Stock_Price:  96.96314772519773
curr_Factors:  [96.96314773 -0.83670287 -1.05505771]
mat_Sqrt:  [[14.62263122  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00029606 -0.00363983  0.1648651 ]
Stock Position:  -0.00029605926815072866
Bond Position:  [3.18601251]


portfolio before change:  [3.15789686]
curr_Stock_Price:  97.65695730397087
curr_Factors:  [97.6569573  -0.71900359 -1.05676779]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.15789686]
Stock Price:  97.40842698770221
PL:  [3.15789686]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.90241336e-01 -2.16845623e-02  4.57160575e-02]
 [ 4.60252495e-02  5.22762688e-02  7.50363031e-02]
 [-4.84138308e-02 -2.90336338e-01  3.48260129e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 5.53947314e-01 -3.49612702e-01 -1.72427281e-01]
 [-7.78543563e-02  6.55290378e-02  2.63131426e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 2.88506846e-01  1.95453115e-02  3.19901644e-03]
 [-3.90467673e-01 -2.13442003e-02  5.17032028e-01]
 [ 2.91056647e-02  5.12234669e-02 -2.52323954e-02]
 [-6.84287601e-02 -3.01805447e-02  9.62287638e-03]
 [ 1.15086021e-01  2.90339242e-02 -1.41736080e-01]
 [-3.78220691e-02 -2.62046381e-04 -5.39204961e-02]
 [ 2.79909023e-01 -7.15179833e-01  1.55550513e-01]
 [ 8.28740120e-02  3.05794612e-01 -2.00097009e-01]
 [-7.47410284e-02  3.08317512e-01  6.31422660e-01]
 [ 8.89030059e-02 -2.76641603e-01 -1.33655692e-01]
 [ 3.45427463e-01  8.07624708e-02  3.34958068e-01]
 [-4.04549326e-02  4.35209224e-01  8.25659276e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.15998023]
curr_Stock_Price:  102.07330325108761
curr_Factors:  [102.07330325  -1.15416619  -1.00214447]
mat_Sqrt:  [[11.81512568  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01535908 -0.00685726  0.13041519]
Stock Position:  -0.015359081421774248
Bond Position:  [18.7277324]


portfolio before change:  [17.17330427]
curr_Stock_Price:  101.51067039828226
curr_Factors:  [101.5106704   -1.32676407  -0.99708984]
mat_Sqrt:  [[ 9.9374457   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00630864 0.01653121 0.21405769]
Stock Position:  0.006308637049822683
Bond Position:  [16.53291029]


portfolio before change:  [17.16832478]
curr_Stock_Price:  100.06610512985883
curr_Factors:  [100.06610513  -1.16102391  -0.94936508]
mat_Sqrt:  [[12.12709279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00402417 -0.09181241  0.09934892]
Stock Position:  -0.0040241675013727544
Bond Position:  [17.57100754]


portfolio before change:  [17.16972802]
curr_Stock_Price:  100.80913090257779
curr_Factors:  [100.8091309   -1.16709994  -0.98913247]
mat_Sqrt:  [[11.66970914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325147 -0.00455813 -0.02970002]
Stock Position:  -0.0032514741148589508
Bond Position:  [17.4975063]


portfolio before change:  [17.17797133]
curr_Stock_Price:  99.61939704343322
curr_Factors:  [99.61939704 -0.89866729 -0.98480638]
mat_Sqrt:  [[15.14822294  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03364908 -0.11055724 -0.49188704]
Stock Position:  0.03364908105306936
Bond Position:  [13.82587016]


portfolio before change:  [17.16091198]
curr_Stock_Price:  99.00968494616188
curr_Factors:  [99.00968495 -0.62927048 -0.97410342]
mat_Sqrt:  [[19.92238103  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355335  0.0207221   0.07506407]
Stock Position:  -0.003553353182859699
Bond Position:  [17.51272836]


portfolio before change:  [17.16337532]
curr_Stock_Price:  99.54872203274039
curr_Factors:  [99.54872203 -0.54822174 -0.95204663]
mat_Sqrt:  [[22.20636188  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00025517 -0.02845143  0.0120735 ]
Stock Position:  -0.0002551653403212615
Bond Position:  [17.1887767]


portfolio before change:  [17.16826165]
curr_Stock_Price:  97.24199120745342
curr_Factors:  [97.24199121 -0.62691992 -0.94815797]
mat_Sqrt:  [[20.12825877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01439094 0.00618077 0.0091259 ]
Stock Position:  0.014390936793725488
Bond Position:  [15.7688583]


portfolio before change:  [17.11936946]
curr_Stock_Price:  93.57059089743994
curr_Factors:  [93.5705909  -0.52940059 -0.89781411]
mat_Sqrt:  [[22.45473345  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01271358 -0.00674963  1.47494846]
Stock Position:  -0.012713580303972976
Bond Position:  [18.30898668]


portfolio before change:  [17.10036348]
curr_Stock_Price:  95.42559959813386
curr_Factors:  [95.4255996  -0.35466564 -0.8953904 ]
mat_Sqrt:  [[27.33836004  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00092462  0.01619828 -0.071981  ]
Stock Position:  0.0009246241452802807
Bond Position:  [17.01213067]


portfolio before change:  [17.10267955]
curr_Stock_Price:  93.33015982570502
curr_Factors:  [93.33015983 -0.38641471 -0.92932449]
mat_Sqrt:  [[25.03823644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268564 -0.00954393  0.02745139]
Stock Position:  -0.002685642704050124
Bond Position:  [17.35333101]


portfolio before change:  [17.10502025]
curr_Stock_Price:  94.07418091114687
curr_Factors:  [ 9.40741809e+01 -2.76506171e-02 -9.38188992e-01]
mat_Sqrt:  [[35.81060292  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00242676  0.00918133 -0.40433358]
Stock Position:  0.002426764994315247
Bond Position:  [16.87672432]


portfolio before change:  [17.09611916]
curr_Stock_Price:  88.66747883472765
curr_Factors:  [88.66747883  0.09007826 -0.91745725]
mat_Sqrt:  [[38.7648612   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.25978293e-03 -8.28663416e-05 -1.53820167e-01]
Stock Position:  -0.001259782925979612
Bond Position:  [17.20782094]


portfolio before change:  [17.10567451]
curr_Stock_Price:  84.49782580913238
curr_Factors:  [84.49782581 -0.1978188  -0.89297835]
mat_Sqrt:  [[28.38692496  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01032851 -0.22615972  0.44374232]
Stock Position:  0.010328514792345787
Bond Position:  [16.23293747]


portfolio before change:  [17.10193223]
curr_Stock_Price:  83.74253554664752
curr_Factors:  [83.74253555 -0.73349125 -0.87080892]
mat_Sqrt:  [[16.83477796  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00296558  0.09670075 -0.57082107]
Stock Position:  0.002965584936276616
Bond Position:  [16.85358663]


portfolio before change:  [17.10518876]
curr_Stock_Price:  83.41970085090344
curr_Factors:  [83.41970085 -0.62643991 -0.8564337 ]
mat_Sqrt:  [[18.93497792  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00328008 0.09749856 1.80127309]
Stock Position:  0.0032800833696820736
Bond Position:  [16.83156519]


portfolio before change:  [17.10708829]
curr_Stock_Price:  82.71579014291386
curr_Factors:  [82.71579014 -0.38459245 -0.81839143]
mat_Sqrt:  [[24.83928888  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00219321 -0.08748176 -0.38128249]
Stock Position:  0.0021932107967331683
Bond Position:  [16.92567513]


portfolio before change:  [17.1093214]
curr_Stock_Price:  81.80441381288291
curr_Factors:  [81.80441381 -0.15826952 -0.83018575]
mat_Sqrt:  [[30.44360435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01366086 0.02553934 0.95554213]
Stock Position:  0.013660858463828704
Bond Position:  [15.99180288]


portfolio before change:  [17.18146566]
curr_Stock_Price:  86.79281277673608
curr_Factors:  [86.79281278 -0.23013768 -0.84250242]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.18146566]
Stock Price:  88.24415210256
PL:  [17.18146566]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.88761287e-01 -3.12735258e-02  9.15391799e-02]
 [-9.72719816e-02  1.20622025e-01  2.25374798e-02]
 [-2.60796294e-02 -1.93130242e-01  4.04281825e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 2.29963297e-01 -1.82871832e-01 -1.48834585e-01]
 [ 2.11707049e-02 -2.81109051e-02 -6.06034116e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 7.97306089e-02 -1.79100241e-02 -2.72743027e-03]
 [-8.43533155e-02  2.34900482e-02  6.27567877e-02]
 [-2.94289070e-01  2.81826550e-01  3.74530775e-02]
 [ 5.00260521e-02 -1.12201663e-01  4.29920985e-03]
 [ 6.06825289e-02  9.68404602e-02  2.01160938e-02]
 [ 7.55615579e-03  1.67010341e-01  7.08548521e-02]
 [ 4.93284023e-03 -1.05095729e-01 -2.80615616e-02]
 [-1.19069396e-01 -8.35774171e-02  1.77922302e-01]
 [ 6.18902302e-03  1.44402351e-01  2.14754207e-01]
 [-7.54447119e-02  1.03629752e-01  3.93173663e-02]
 [-5.08146865e-02 -5.83566828e-02  2.29036469e-02]
 [-2.59414168e-02  5.31982044e-01  2.70703932e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.6048096]
curr_Stock_Price:  100.04578503418593
curr_Factors:  [100.04578503  -0.84557788  -0.96972606]
mat_Sqrt:  [[16.2862955   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0166326  -0.00988956  0.2611358 ]
Stock Position:  -0.016632598213957066
Bond Position:  [4.26883094]


portfolio before change:  [2.6083093]
curr_Stock_Price:  99.8995444579223
curr_Factors:  [99.89954446 -0.69566543 -0.95023716]
mat_Sqrt:  [[19.26447138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00464882  0.03814403  0.06429316]
Stock Position:  -0.004648821592502995
Bond Position:  [3.07272446]


portfolio before change:  [2.60808437]
curr_Stock_Price:  100.1131917423482
curr_Factors:  [100.11319174  -0.82303229  -0.94179666]
mat_Sqrt:  [[17.1409874   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00133095 -0.06107314  0.11533035]
Stock Position:  -0.0013309538167375682
Bond Position:  [2.7413304]


portfolio before change:  [2.60724046]
curr_Stock_Price:  101.26223621099975
curr_Factors:  [101.26223621  -0.44558989  -0.95000052]
mat_Sqrt:  [[25.08131473  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00151283 -0.00455813 -0.02970002]
Stock Position:  -0.0015128296741775049
Bond Position:  [2.76043298]


portfolio before change:  [2.61092179]
curr_Stock_Price:  99.28505442694116
curr_Factors:  [99.28505443 -0.46058958 -0.94708428]
mat_Sqrt:  [[24.29622972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00802021 -0.05782915 -0.42458364]
Stock Position:  0.008020208757837433
Bond Position:  [1.81463493]


portfolio before change:  [2.63060877]
curr_Stock_Price:  101.6831544681562
curr_Factors:  [101.68315447  -0.88819778  -0.95022511]
mat_Sqrt:  [[16.17454569  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0004992  -0.00888945 -0.17288466]
Stock Position:  0.0004991957762278156
Bond Position:  [2.57984897]


portfolio before change:  [2.63035657]
curr_Stock_Price:  99.88577652937057
curr_Factors:  [99.88577653 -0.94547889 -0.90860573]
mat_Sqrt:  [[15.64173535  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036225 -0.02845143  0.0120735 ]
Stock Position:  -0.00036225481116374675
Bond Position:  [2.66654067]


portfolio before change:  [2.6312836]
curr_Stock_Price:  99.16718033046364
curr_Factors:  [99.16718033 -0.76036396 -0.90501181]
mat_Sqrt:  [[18.7544553   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00419695 -0.00566365 -0.0077806 ]
Stock Position:  0.0041969461907256575
Bond Position:  [2.21508429]


portfolio before change:  [2.63212111]
curr_Stock_Price:  99.2347693375681
curr_Factors:  [99.23476934 -1.12291714 -0.92189683]
mat_Sqrt:  [[12.84140197  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00552406  0.00742821  0.17902765]
Stock Position:  -0.005524056450447385
Bond Position:  [3.18029958]


portfolio before change:  [2.62348222]
curr_Stock_Price:  100.94258397701454
curr_Factors:  [100.94258398  -1.28182409  -0.94566165]
mat_Sqrt:  [[10.88152223  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02567355  0.08912138  0.10684321]
Stock Position:  -0.025673546096182474
Bond Position:  [5.21503631]


portfolio before change:  [2.64248652]
curr_Stock_Price:  100.25314358669387
curr_Factors:  [100.25314359  -1.27391627  -0.93398165]
mat_Sqrt:  [[11.02097747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00435593 -0.03548128  0.01226445]
Stock Position:  0.004355928525987512
Bond Position:  [2.205791]


portfolio before change:  [2.63901972]
curr_Stock_Price:  99.33064992841003
curr_Factors:  [99.33064993 -0.7725491  -0.9317706 ]
mat_Sqrt:  [[18.06785666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00372424 0.03062364 0.05738562]
Stock Position:  0.0037242446959487104
Bond Position:  [2.26908808]


portfolio before change:  [2.63832193]
curr_Stock_Price:  98.99094702648897
curr_Factors:  [98.99094703 -0.98201601 -0.92997216]
mat_Sqrt:  [[14.62950278  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00179989 0.05281331 0.20212917]
Stock Position:  0.0017998923662358266
Bond Position:  [2.46014888]


portfolio before change:  [2.63810033]
curr_Stock_Price:  98.52607713618481
curr_Factors:  [98.52607714 -0.96339204 -0.9084952 ]
mat_Sqrt:  [[15.15656863  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0002315  -0.03323419 -0.08005182]
Stock Position:  -0.0002315010864379312
Bond Position:  [2.66090922]


portfolio before change:  [2.63878706]
curr_Stock_Price:  98.43356385123946
curr_Factors:  [98.43356385 -1.11621724 -0.91166462]
mat_Sqrt:  [[12.95523541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00655404 -0.0264295   0.5075628 ]
Stock Position:  -0.006554039010493957
Bond Position:  [3.28392447]


portfolio before change:  [2.63573142]
curr_Stock_Price:  99.0250651513632
curr_Factors:  [99.02506515 -0.95873138 -0.92687629]
mat_Sqrt:  [[15.02574897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00357746 0.04566403 0.61263398]
Stock Position:  0.003577458583013432
Bond Position:  [2.28147335]


portfolio before change:  [2.63891656]
curr_Stock_Price:  99.75594748835681
curr_Factors:  [99.75594749 -0.93650515 -0.91621909]
mat_Sqrt:  [[15.64267006  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0041389  0.0327706  0.1121615]
Stock Position:  -0.004138895672904666
Bond Position:  [3.05179602]


portfolio before change:  [2.64070602]
curr_Stock_Price:  99.5079533282447
curr_Factors:  [99.50795333 -0.89335209 -0.8927152 ]
mat_Sqrt:  [[16.6793309   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00285661 -0.018454    0.06533773]
Stock Position:  -0.0028566051307140775
Bond Position:  [2.92496095]


portfolio before change:  [2.63594568]
curr_Stock_Price:  101.43040224313434
curr_Factors:  [101.43040224  -0.87750546  -0.90982074]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.63594568]
Stock Price:  100.61489125214591
PL:  [2.02105443]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.01870358e-01 -3.69646053e-02  1.09542977e-01]
 [-2.43849630e-01  2.09061905e-01  5.14719312e-02]
 [-3.12471361e-02 -2.10377344e-01  3.99480071e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.40407632e-01 -2.65617923e-01 -2.10242937e-01]
 [-3.29021968e-03 -2.61484004e-02 -6.76133457e-02]
 [ 2.39480587e-03 -7.88509549e-02  2.46200364e-03]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [-1.08112534e-02  7.36259775e-03 -1.10272564e-01]
 [-3.44355698e-01  3.35144368e-01  5.19262587e-02]
 [ 8.78442939e-02 -1.34109505e-01 -2.43362200e-04]
 [ 9.94472429e-04  6.85574369e-02  4.29029522e-02]
 [-2.46891427e-02  1.77963583e-01  3.72842902e-02]
 [-8.54339041e-02 -5.19901034e-02  6.42368741e-02]
 [-1.63700287e-01 -1.16742099e-01  2.34171482e-01]
 [ 1.41607906e-02  5.15882737e-02  4.42411139e-02]
 [-1.45414778e-01  8.43651128e-04  8.07594614e-02]
 [-5.01122957e-02 -5.62003867e-02  2.27823344e-02]
 [-2.19095225e-02  5.66853406e-01  2.92456348e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.48642435]
curr_Stock_Price:  99.75069645183495
curr_Factors:  [99.75069645 -0.87614313 -1.00613062]
mat_Sqrt:  [[15.18639997  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01846813 -0.01168923  0.31249562]
Stock Position:  -0.018468130322917917
Bond Position:  [2.32863322]


portfolio before change:  [0.502945]
curr_Stock_Price:  98.88767367687946
curr_Factors:  [98.88767368 -0.85209759 -1.01657675]
mat_Sqrt:  [[15.26114809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0149363   0.06611118  0.14683509]
Stock Position:  -0.014936295058101534
Bond Position:  [1.97996047]


portfolio before change:  [0.48567037]
curr_Stock_Price:  100.0773721602492
curr_Factors:  [100.07737216  -0.86475663  -1.01278533]
mat_Sqrt:  [[15.30839919  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00186334 -0.06652716  0.11396054]
Stock Position:  -0.0018633367615625742
Bond Position:  [0.67214821]


portfolio before change:  [0.48587454]
curr_Stock_Price:  100.05799192856136
curr_Factors:  [100.05799193  -0.63857862  -1.00294852]
mat_Sqrt:  [[19.37963546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195792 -0.00455813 -0.02970002]
Stock Position:  -0.001957919036693023
Bond Position:  [0.68177998]


portfolio before change:  [0.48352488]
curr_Stock_Price:  101.34513661882079
curr_Factors:  [101.34513662  -0.90730133  -0.97370181]
mat_Sqrt:  [[15.44876002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01881276 -0.08399576 -0.59976458]
Stock Position:  0.01881275563883914
Bond Position:  [-1.42305641]


portfolio before change:  [0.49278996]
curr_Stock_Price:  101.85653919788653
curr_Factors:  [101.8565392   -1.04311042  -0.96756665]
mat_Sqrt:  [[13.63838539  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00130271 -0.00826885 -0.19288206]
Stock Position:  -0.001302711748186252
Bond Position:  [0.62547967]


portfolio before change:  [0.49165334]
curr_Stock_Price:  102.84909338424103
curr_Factors:  [102.84909338  -0.76144298  -0.95247426]
mat_Sqrt:  [[18.52915729  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.64909086e-05 -2.49348613e-02  7.02341111e-03]
Stock Position:  4.649090858744669e-05
Bond Position:  [0.48687179]


portfolio before change:  [0.49177086]
curr_Stock_Price:  102.75853690687258
curr_Factors:  [102.75853691  -1.25122374  -0.9557111 ]
mat_Sqrt:  [[11.30728364  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01234473 -0.01496598 -0.14840805]
Stock Position:  -0.012344727403835515
Bond Position:  [1.76029699]


portfolio before change:  [0.49427361]
curr_Stock_Price:  102.59145171581888
curr_Factors:  [102.59145172  -1.11850318  -0.9257529 ]
mat_Sqrt:  [[13.28317949  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249417  0.00232826 -0.31457693]
Stock Position:  -0.0024941652693421163
Bond Position:  [0.75015365]


portfolio before change:  [0.49557269]
curr_Stock_Price:  102.14580673794134
curr_Factors:  [102.14580674  -1.24804359  -0.91553712]
mat_Sqrt:  [[11.73787225  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02769692  0.10598195  0.14813116]
Stock Position:  -0.027696919674428912
Bond Position:  [3.32469689]


portfolio before change:  [0.50538418]
curr_Stock_Price:  101.82157529367132
curr_Factors:  [101.82157529  -1.16488587  -0.94657944]
mat_Sqrt:  [[12.32656525  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00684148 -0.04240915 -0.00069424]
Stock Position:  0.006841478027004776
Bond Position:  [-0.19122589]


portfolio before change:  [0.50150598]
curr_Stock_Price:  101.26169805681303
curr_Factors:  [101.26169806  -0.4968594   -0.96426085]
mat_Sqrt:  [[23.4903096   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00049051 0.02167977 0.12239018]
Stock Position:  0.0004905063615227804
Bond Position:  [0.45183647]


portfolio before change:  [0.50152588]
curr_Stock_Price:  101.07195332945447
curr_Factors:  [101.07195333  -0.61893087  -0.99193769]
mat_Sqrt:  [[20.18549157  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00061844  0.05627703  0.1063617 ]
Stock Position:  -0.0006184401733467993
Bond Position:  [0.56403283]


portfolio before change:  [0.50066545]
curr_Stock_Price:  102.6912737513969
curr_Factors:  [102.69127375  -0.42162659  -0.98858458]
mat_Sqrt:  [[25.06609106  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00293879 -0.01644071  0.18324992]
Stock Position:  -0.0029387903229812725
Bond Position:  [0.80245357]


portfolio before change:  [0.50588908]
curr_Stock_Price:  100.98207010994925
curr_Factors:  [100.98207011  -0.35994747  -0.96452984]
mat_Sqrt:  [[26.85536642  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00442796 -0.03691709  0.66802606]
Stock Position:  -0.00442796047489507
Bond Position:  [0.9530337]


portfolio before change:  [0.49501324]
curr_Stock_Price:  103.49205874801588
curr_Factors:  [103.49205875  -0.56473198  -0.95669342]
mat_Sqrt:  [[22.60270262  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00108498 0.01631364 0.12620758]
Stock Position:  0.0010849797071324245
Bond Position:  [0.38272646]


portfolio before change:  [0.49390896]
curr_Stock_Price:  102.38607520210705
curr_Factors:  [102.3860752   -0.39557335  -0.93991067]
mat_Sqrt:  [[26.93069462  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00478666  0.00026679  0.23038426]
Stock Position:  -0.004786658536570507
Bond Position:  [0.98399614]


portfolio before change:  [0.50773854]
curr_Stock_Price:  99.54828215498021
curr_Factors:  [99.54828215 -0.20132337 -0.92874495]
mat_Sqrt:  [[32.15520896  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00145895 -0.01777212  0.06499166]
Stock Position:  -0.001458953632355071
Bond Position:  [0.65297487]


portfolio before change:  [0.50660474]
curr_Stock_Price:  100.4373194257549
curr_Factors:  [100.43731943  -0.45478978  -0.93827762]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.50660474]
Stock Price:  97.55673473853261
PL:  [0.50660474]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.04372633e-01 -6.35822111e-02  1.41302611e-01]
 [ 6.50117429e-02  3.06864293e-02  2.55122032e-02]
 [-5.07808941e-03 -1.30339318e-01  4.17752476e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 2.49211337e-01 -2.21617700e-01 -2.11390222e-01]
 [ 3.11317526e-02 -2.63863805e-02 -5.62302946e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-1.39837798e-01 -3.31123488e-02 -5.09110238e-02]
 [-4.52255814e-02 -1.24486822e-02 -1.14376017e-01]
 [-2.54153487e-01  2.51389157e-01  4.07073368e-02]
 [ 1.11543139e-01 -1.89063289e-01  5.20611671e-02]
 [-7.61970811e-02  2.09660441e-02  1.34626187e-02]
 [-8.37349869e-02  1.49037390e-01 -4.31851794e-02]
 [-1.14448466e-01  4.40217229e-02  9.58104429e-02]
 [-1.31214007e-01 -1.19228214e-01  2.67455755e-01]
 [ 4.34528263e-03 -1.25165824e-02 -5.77018442e-02]
 [-9.18723658e-02  5.32006125e-02  8.09490209e-02]
 [-3.10588558e-02  1.15609237e-04  2.08665152e-02]
 [-4.85482941e-03  5.67014043e-01  3.82971573e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.66993286]
curr_Stock_Price:  98.89312310408974
curr_Factors:  [98.8931231  -0.76632997 -0.98766637]
mat_Sqrt:  [[17.11650783  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00450857 -0.02010646  0.40309702]
Stock Position:  -0.004508574118441048
Bond Position:  [-5.22406589]


portfolio before change:  [-5.68068614]
curr_Stock_Price:  100.98848484571462
curr_Factors:  [100.98848485  -0.80560301  -0.95954076]
mat_Sqrt:  [[17.28540877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00410819 0.0097039  0.07277921]
Stock Position:  0.0041081886309597485
Bond Position:  [-6.09556588]


portfolio before change:  [-5.6854121]
curr_Stock_Price:  100.20909507487674
curr_Factors:  [100.20909507  -0.64428401  -1.01301334]
mat_Sqrt:  [[19.10522009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.39150000e-06 -4.12169113e-02  1.19173153e-01]
Stock Position:  4.391500004894939e-06
Bond Position:  [-5.68585217]


portfolio before change:  [-5.68682965]
curr_Stock_Price:  101.13917901024577
curr_Factors:  [101.13917901  -0.54062314  -1.00675995]
mat_Sqrt:  [[21.52283544  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176295 -0.00455813 -0.02970002]
Stock Position:  -0.0017629534591263431
Bond Position:  [-5.50852599]


portfolio before change:  [-5.68938248]
curr_Stock_Price:  101.80597128389131
curr_Factors:  [101.80597128  -0.77186595  -1.02858886]
mat_Sqrt:  [[16.82076188  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01191024 -0.07008167 -0.60303746]
Stock Position:  0.011910241959085063
Bond Position:  [-6.90191623]


portfolio before change:  [-5.69370029]
curr_Stock_Price:  101.58833417212746
curr_Factors:  [101.58833417  -0.88893593  -1.0279407 ]
mat_Sqrt:  [[14.940148    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012699  -0.00834411 -0.16040938]
Stock Position:  0.001269900296480053
Bond Position:  [-5.82270734]


portfolio before change:  [-5.6947477]
curr_Stock_Price:  101.90997080260172
curr_Factors:  [101.9099708   -0.86406775  -0.98393777]
mat_Sqrt:  [[16.05602667  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035291 -0.02845143  0.0120735 ]
Stock Position:  -0.00035290760297901043
Bond Position:  [-5.6587829]


portfolio before change:  [-5.69713553]
curr_Stock_Price:  104.66695275620967
curr_Factors:  [104.66695276  -0.98566518  -0.94125307]
mat_Sqrt:  [[15.23911059  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00991429 -0.01047104 -0.14523498]
Stock Position:  -0.009914287551603368
Bond Position:  [-4.65943726]


portfolio before change:  [-5.68793556]
curr_Stock_Price:  103.62149383079198
curr_Factors:  [103.62149383  -0.74942272  -0.89666923]
mat_Sqrt:  [[19.97842277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00344842 -0.00393662 -0.32628294]
Stock Position:  -0.0034484159490448247
Bond Position:  [-5.33060554]


portfolio before change:  [-5.68602448]
curr_Stock_Price:  102.68080394235683
curr_Factors:  [102.68080394  -0.39775444  -0.86028006]
mat_Sqrt:  [[29.18312662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00820177  0.07949623  0.1161267 ]
Stock Position:  -0.008201770136352773
Bond Position:  [-4.84386013]


portfolio before change:  [-5.698821]
curr_Stock_Price:  104.09335300064477
curr_Factors:  [104.093353    -0.36143931  -0.84398162]
mat_Sqrt:  [[31.18281659  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00376132 -0.05978706  0.14851602]
Stock Position:  0.003761317935159951
Bond Position:  [-6.0903492]


portfolio before change:  [-5.70234682]
curr_Stock_Price:  103.56081736701881
curr_Factors:  [103.56081737  -0.83309488  -0.83642078]
mat_Sqrt:  [[19.50446441  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.003738    0.00663005  0.0384051 ]
Stock Position:  -0.0037380003414340234
Bond Position:  [-5.31523645]


portfolio before change:  [-5.71602134]
curr_Stock_Price:  106.86353172130553
curr_Factors:  [106.86353172  -1.38978048  -0.83155288]
mat_Sqrt:  [[11.59088776  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00765274  0.04712976 -0.1231953 ]
Stock Position:  -0.007652735297246877
Bond Position:  [-4.89822302]


portfolio before change:  [-5.72093858]
curr_Stock_Price:  107.34604298030592
curr_Factors:  [107.34604298  -1.01915953  -0.85886542]
mat_Sqrt:  [[16.41232733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00571245  0.01392089  0.27332052]
Stock Position:  -0.005712450376868961
Bond Position:  [-5.10772963]


portfolio before change:  [-5.73652551]
curr_Stock_Price:  109.85106942112584
curr_Factors:  [109.85106942  -0.71721148  -0.87502006]
mat_Sqrt:  [[22.35151254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00356568 -0.03770327  0.76297682]
Stock Position:  -0.0035656776753604414
Bond Position:  [-5.344832]


portfolio before change:  [-5.73015493]
curr_Stock_Price:  107.68964106532005
curr_Factors:  [107.68964107  -0.90797894  -0.87713502]
mat_Sqrt:  [[18.06794605  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042928 -0.00395809 -0.1646073 ]
Stock Position:  -0.00042928143255515044
Bond Position:  [-5.68392576]


portfolio before change:  [-5.73158201]
curr_Stock_Price:  107.7034451753214
curr_Factors:  [107.70344518  -0.8407866   -0.85689936]
mat_Sqrt:  [[19.72122795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00375104  0.01682351  0.23092502]
Stock Position:  -0.0037510383401342627
Bond Position:  [-5.32758226]


portfolio before change:  [-5.73229073]
curr_Stock_Price:  107.53726525561399
curr_Factors:  [107.53726526  -0.64512007  -0.86371687]
mat_Sqrt:  [[23.78370084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.12667542e-03  3.65588509e-05  5.95263597e-02]
Stock Position:  -0.0011266754217916228
Bond Position:  [-5.61113113]


portfolio before change:  [-5.73304504]
curr_Stock_Price:  106.96154563722145
curr_Factors:  [106.96154564  -0.93234723  -0.83971155]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.73304504]
Stock Price:  107.08140282087189
PL:  [-12.81444786]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.10302617e-01 -5.60836170e-02  1.42546607e-01]
 [-2.39233792e-01  2.07306883e-01  5.50791582e-02]
 [-8.27911737e-02 -3.74938959e-01  7.02241305e-04]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 5.02666323e-01 -3.39020442e-01 -2.00948943e-01]
 [ 7.60265204e-02 -3.26625685e-03 -2.72858378e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-3.01115910e-02 -3.59410730e-02 -1.70954781e-02]
 [ 2.02775441e-03  2.10297121e-02 -8.94394597e-02]
 [-2.55091992e-01  2.42129719e-01  1.51041565e-02]
 [ 7.33078538e-02 -1.25609348e-01  8.81638396e-04]
 [ 4.20751111e-02  9.13337961e-02  3.67186761e-02]
 [-2.07440292e-02  1.73194572e-01  4.00617283e-02]
 [ 8.31355066e-03 -1.37100016e-01 -4.03102039e-02]
 [-4.97422114e-02 -4.66577879e-02  1.31239472e-01]
 [-2.83903584e-02  2.02721674e-01  3.08357047e-01]
 [ 3.43903043e-02 -1.06787487e-01 -9.39184239e-02]
 [ 4.16180429e-02  4.89847565e-02  1.51633551e-01]
 [-4.67604194e-02  3.68385272e-01  9.10906386e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.22323971]
curr_Stock_Price:  99.37324342147228
curr_Factors:  [99.37324342 -0.90906169 -0.9879993 ]
mat_Sqrt:  [[14.90686594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01225298 -0.0177352   0.40664579]
Stock Position:  -0.012252977024303403
Bond Position:  [-1.00562165]


portfolio before change:  [-2.21793713]
curr_Stock_Price:  98.91996386513054
curr_Factors:  [98.91996387 -0.8531036  -0.97726944]
mat_Sqrt:  [[15.86218592  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01403578  0.06555619  0.15712551]
Stock Position:  -0.014035780849651586
Bond Position:  [-0.82951819]


portfolio before change:  [-2.22332739]
curr_Stock_Price:  99.28922407329594
curr_Factors:  [99.28922407 -1.07602377 -0.95936354]
mat_Sqrt:  [[12.97013936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00711856 -0.11856611  0.0020033 ]
Stock Position:  -0.007118559715342519
Bond Position:  [-1.51653112]


portfolio before change:  [-2.23159732]
curr_Stock_Price:  100.39769964887803
curr_Factors:  [100.39769965  -1.01446691  -0.96171264]
mat_Sqrt:  [[13.91489356  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00272684 -0.00455813 -0.02970002]
Stock Position:  -0.0027268449480713584
Bond Position:  [-1.95782836]


portfolio before change:  [-2.23265956]
curr_Stock_Price:  100.60773141848787
curr_Factors:  [100.60773142  -0.97045506  -0.96050459]
mat_Sqrt:  [[14.58902395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0310435  -0.10720768 -0.5732514 ]
Stock Position:  0.031043497064627154
Bond Position:  [-5.35587538]


portfolio before change:  [-2.23200823]
curr_Stock_Price:  100.67184999067732
curr_Factors:  [100.67184999  -0.68488174  -0.95113168]
mat_Sqrt:  [[19.60633631  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00358927 -0.00103288 -0.0778389 ]
Stock Position:  0.0035892726980754335
Bond Position:  [-2.59334695]


portfolio before change:  [-2.23408766]
curr_Stock_Price:  100.27315910620203
curr_Factors:  [100.27315911  -0.84938889  -0.98357216]
mat_Sqrt:  [[16.03761662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035331 -0.02845143  0.0120735 ]
Stock Position:  -0.0003533127159382916
Bond Position:  [-2.19865988]


portfolio before change:  [-2.23470065]
curr_Stock_Price:  100.45218896426564
curr_Factors:  [100.45218896  -0.82808498  -0.9971468 ]
mat_Sqrt:  [[16.19091213  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213263 -0.01136557 -0.04876864]
Stock Position:  -0.002132627555851604
Bond Position:  [-2.02047354]


portfolio before change:  [-2.2384665]
curr_Stock_Price:  101.98113368709696
curr_Factors:  [101.98113369  -0.98341068  -1.01587317]
mat_Sqrt:  [[13.81153325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113572  0.00665018 -0.25514588]
Stock Position:  -0.0011357185140426194
Bond Position:  [-2.12264464]


portfolio before change:  [-2.23802866]
curr_Stock_Price:  101.12830923685135
curr_Factors:  [101.12830924  -0.82188536  -1.03659206]
mat_Sqrt:  [[15.766898    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0155869   0.07656814  0.04308795]
Stock Position:  -0.01558690280760114
Bond Position:  [-0.66175153]


portfolio before change:  [-2.21358903]
curr_Stock_Price:  99.54973497992388
curr_Factors:  [99.54973498 -0.49504156 -1.02497227]
mat_Sqrt:  [[21.77240914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00322631 -0.03972116  0.00251507]
Stock Position:  0.0032263126056288807
Bond Position:  [-2.5347676]


portfolio before change:  [-2.21218474]
curr_Stock_Price:  100.18143616974794
curr_Factors:  [100.18143617  -0.69513552  -1.05889172]
mat_Sqrt:  [[17.33895418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0029949  0.02888228 0.10474816]
Stock Position:  0.002994904269603119
Bond Position:  [-2.51221855]


portfolio before change:  [-2.21167684]
curr_Stock_Price:  100.56075710653049
curr_Factors:  [100.56075711  -0.67166026  -1.06651156]
mat_Sqrt:  [[17.68276203  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045777  0.05476893  0.11428496]
Stock Position:  -0.0004577677681841321
Bond Position:  [-2.16564337]


portfolio before change:  [-2.21119066]
curr_Stock_Price:  98.31581972504055
curr_Factors:  [98.31581973 -1.00683731 -1.02346532]
mat_Sqrt:  [[12.90845233  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00026763 -0.04335483 -0.11499379]
Stock Position:  -0.0002676263869777058
Bond Position:  [-2.18487875]


portfolio before change:  [-2.21105722]
curr_Stock_Price:  95.77597911688848
curr_Factors:  [95.77597912 -0.98239075 -0.98054071]
mat_Sqrt:  [[13.45136315  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00179593 -0.01475449  0.37438968]
Stock Position:  -0.0017959343532893265
Bond Position:  [-2.03904985]


portfolio before change:  [-2.21215984]
curr_Stock_Price:  96.1060526470126
curr_Factors:  [96.10605265 -1.10344784 -0.97697593]
mat_Sqrt:  [[12.00146256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00331518 0.06410622 0.87965682]
Stock Position:  0.003315180212291037
Bond Position:  [-2.53076872]


portfolio before change:  [-2.2157089]
curr_Stock_Price:  95.2263751874557
curr_Factors:  [95.22637519 -1.76970248 -0.93619446]
mat_Sqrt:  [[ 6.36210951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00195879 -0.03376917 -0.26792312]
Stock Position:  0.0019587913801802433
Bond Position:  [-2.4022375]


portfolio before change:  [-2.21571161]
curr_Stock_Price:  95.53162696551526
curr_Factors:  [95.53162697 -1.88068476 -0.92789396]
mat_Sqrt:  [[ 5.75966118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01281931 0.01549034 0.43256831]
Stock Position:  0.012819311877044322
Bond Position:  [-3.44036133]


portfolio before change:  [-2.2138252]
curr_Stock_Price:  95.74588192320125
curr_Factors:  [95.74588192 -1.67942518 -0.91542851]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.2138252]
Stock Price:  95.70237678062779
PL:  [-2.2138252]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.13167628e-01 -4.68952316e-02  1.38612586e-01]
 [-5.58885546e-02  1.15033205e-01  9.93854367e-02]
 [-1.71251401e-02 -1.59888425e-01  3.79661064e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 7.59705513e-01 -4.90443723e-01 -2.68900219e-01]
 [-7.13625298e-02  4.35419118e-02 -4.84747748e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-3.92712097e-02 -3.70010733e-02 -1.91954530e-02]
 [-4.31934165e-02  2.78348459e-02  1.02144485e-02]
 [-2.75807843e-01  2.58112723e-01  1.88297124e-02]
 [ 3.35019144e-02 -1.02451623e-01  4.89213664e-03]
 [ 6.51832931e-02  9.94048335e-02  1.15962437e-02]
 [ 1.07779735e-02  1.57423973e-01  7.09156927e-02]
 [ 8.17586316e-03 -1.27578454e-01 -3.55216016e-02]
 [-1.41949559e-01 -1.00579392e-01  2.06758616e-01]
 [ 3.49573961e-02  8.42538647e-02  1.28060534e-01]
 [-1.11151035e-01  5.27272042e-02  5.85851589e-02]
 [-5.06684034e-02 -5.82974277e-02  2.31246042e-02]
 [-2.65435152e-02  5.28846289e-01  2.53779246e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.10359225]
curr_Stock_Price:  99.83666721657396
curr_Factors:  [99.83666722 -1.4751766  -0.99267651]
mat_Sqrt:  [[ 8.46281971  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03380484 -0.01482957  0.39542313]
Stock Position:  -0.03380484187394474
Bond Position:  [4.478555]


portfolio before change:  [1.09944898]
curr_Stock_Price:  99.99235651068383
curr_Factors:  [99.99235651 -1.21783016 -0.97059202]
mat_Sqrt:  [[11.20849043  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291131  0.03637669  0.28351899]
Stock Position:  -0.00291131468069123
Bond Position:  [1.39055819]


portfolio before change:  [1.09873962]
curr_Stock_Price:  100.35543617494689
curr_Factors:  [100.35543617  -0.83396387  -1.03754448]
mat_Sqrt:  [[15.443835    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00087437 -0.05056116  0.10830673]
Stock Position:  -0.0008743710654049792
Bond Position:  [1.18648751]


portfolio before change:  [1.09933711]
curr_Stock_Price:  100.01138748961453
curr_Factors:  [100.01138749  -1.58386643  -1.0167151 ]
mat_Sqrt:  [[ 7.42388512  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00511104 -0.00455813 -0.02970002]
Stock Position:  -0.005111037761093515
Bond Position:  [1.61049908]


portfolio before change:  [1.09483694]
curr_Stock_Price:  100.97065348445645
curr_Factors:  [100.97065348  -2.33063524  -1.0582488 ]
mat_Sqrt:  [[ 3.40738754  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.20313313 -0.15509192 -0.76709748]
Stock Position:  0.20313312594560548
Bond Position:  [-19.41564754]


portfolio before change:  [1.04466745]
curr_Stock_Price:  100.74757335503793
curr_Factors:  [100.74757336  -2.16101956  -1.06965938]
mat_Sqrt:  [[ 3.98261714  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02012073  0.01376916 -0.13828504]
Stock Position:  -0.02012072753610943
Bond Position:  [3.07178193]


portfolio before change:  [1.0460352]
curr_Stock_Price:  100.71776816197367
curr_Factors:  [100.71776816  -1.68076745  -1.10629794]
mat_Sqrt:  [[ 6.20438836  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00091327 -0.02845143  0.0120735 ]
Stock Position:  -0.0009132719553451332
Bond Position:  [1.13801791]


portfolio before change:  [1.04602375]
curr_Stock_Price:  101.04186664693852
curr_Factors:  [101.04186665  -1.31636688  -1.08546733]
mat_Sqrt:  [[ 9.14951384  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00482483 -0.01170077 -0.05475928]
Stock Position:  -0.00482482779493263
Bond Position:  [1.53353335]


portfolio before change:  [1.04939765]
curr_Stock_Price:  100.42205709152266
curr_Factors:  [100.42205709  -1.35242418  -1.06285264]
mat_Sqrt:  [[ 8.97196809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00450177  0.00880215  0.02913898]
Stock Position:  -0.004501766827374193
Bond Position:  [1.50147434]


portfolio before change:  [1.05094478]
curr_Stock_Price:  100.16177767677375
curr_Factors:  [100.16177768  -1.31265813  -1.04981375]
mat_Sqrt:  [[ 9.43394894  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02812182  0.08162241  0.05371593]
Stock Position:  -0.02812181872850231
Bond Position:  [3.86767614]


portfolio before change:  [1.07228488]
curr_Stock_Price:  99.43732027489392
curr_Factors:  [99.43732027 -1.17378282 -1.07741781]
mat_Sqrt:  [[10.46804073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00304309 -0.03239805  0.0139559 ]
Stock Position:  0.0030430936278580617
Bond Position:  [0.76968781]


portfolio before change:  [1.07116433]
curr_Stock_Price:  99.00585031060018
curr_Factors:  [99.00585031 -1.32386206 -1.08193187]
mat_Sqrt:  [[ 8.9297198   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00785209 0.03143457 0.03308086]
Stock Position:  0.007852092759475631
Bond Position:  [0.29376121]


portfolio before change:  [1.06189196]
curr_Stock_Price:  97.81561765705554
curr_Factors:  [97.81561766 -0.77738571 -1.07367456]
mat_Sqrt:  [[15.363952    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00190825 0.04978183 0.20230273]
Stock Position:  0.0019082491360883534
Bond Position:  [0.87523539]


portfolio before change:  [1.06193777]
curr_Stock_Price:  97.72494643481933
curr_Factors:  [97.72494643 -0.78455979 -1.05145563]
mat_Sqrt:  [[15.58239009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00015203 -0.04034385 -0.10133324]
Stock Position:  -0.00015203154996699757
Bond Position:  [1.07679505]


portfolio before change:  [1.06195384]
curr_Stock_Price:  99.39014379152115
curr_Factors:  [99.39014379 -0.81139265 -1.07923383]
mat_Sqrt:  [[15.00564516  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00682024 -0.031806    0.58982478]
Stock Position:  -0.0068202386880273635
Bond Position:  [1.73981835]


portfolio before change:  [1.05478746]
curr_Stock_Price:  100.50467765757878
curr_Factors:  [100.50467766  -0.89424691  -1.08600908]
mat_Sqrt:  [[13.87305237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00456086 0.02664341 0.36532106]
Stock Position:  0.004560861372795872
Bond Position:  [0.59639956]


portfolio before change:  [1.05726037]
curr_Stock_Price:  101.01418411444358
curr_Factors:  [101.01418411  -1.0815051   -1.09913608]
mat_Sqrt:  [[11.41147875  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00857303  0.01667381  0.16712715]
Stock Position:  -0.008573032576951894
Bond Position:  [1.92325826]


portfolio before change:  [1.0723125]
curr_Stock_Price:  99.3145223163187
curr_Factors:  [99.31452232 -1.08184603 -1.06113874]
mat_Sqrt:  [[11.65001003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00407325 -0.01843527  0.06596806]
Stock Position:  -0.004073245115621037
Bond Position:  [1.47684489]


portfolio before change:  [1.07085167]
curr_Stock_Price:  99.76381675898482
curr_Factors:  [99.76381676 -0.60253779 -1.0815753 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.07085167]
Stock Price:  101.52357346445217
PL:  [-0.45272179]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.99885439e-01 -3.23562413e-02  9.67131912e-02]
 [ 5.72832887e-02  3.32679744e-02  1.79066621e-02]
 [-1.68164261e-02 -1.58703690e-01  3.85162940e-02]
 [-3.26444727e-02 -9.84005180e-03 -7.53626151e-03]
 [ 3.01314731e-01 -2.23769073e-01 -1.59116783e-01]
 [ 5.93833050e-02 -8.73085695e-02 -8.34271183e-02]
 [ 9.54858688e-03 -8.19380325e-02  6.72700762e-04]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [-7.06827916e-02 -2.65891708e-02 -1.14503435e-01]
 [-3.49286003e-01  3.44728371e-01  5.76052452e-02]
 [ 1.11883655e-01 -1.79217256e-01  3.84989553e-02]
 [-1.13408958e-01  7.38192608e-04 -2.86051695e-03]
 [-8.92730535e-02  1.51351310e-01 -4.87830369e-02]
 [-1.09147849e-01  2.28975622e-02  1.11229953e-01]
 [-1.33034880e-01 -1.06234856e-01  2.29756414e-01]
 [ 3.86465640e-02  6.65819104e-02  1.13312035e-01]
 [-8.36612956e-02  6.78890749e-02  7.28995600e-02]
 [-4.10629747e-02 -2.91960037e-02  2.17098305e-02]
 [-2.84585904e-02  5.06054544e-01  2.52523329e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.67254005]
curr_Stock_Price:  99.91592097885568
curr_Factors:  [99.91592098 -0.80585765 -1.02902893]
mat_Sqrt:  [[15.94973893  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01761655 -0.01023194  0.27589581]
Stock Position:  -0.017616550137434118
Bond Position:  [3.43271388]


portfolio before change:  [1.65875741]
curr_Stock_Price:  100.7470101587042
curr_Factors:  [100.74701016  -0.74030447  -0.99894637]
mat_Sqrt:  [[17.69640816  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00349209 0.01052026 0.05108272]
Stock Position:  0.0034920897879739273
Bond Position:  [1.30693981]


portfolio before change:  [1.65764965]
curr_Stock_Price:  100.33621368939892
curr_Factors:  [100.33621369  -0.82041041  -0.97100686]
mat_Sqrt:  [[16.7284258   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078023 -0.05018651  0.10987627]
Stock Position:  -0.00078023074484129
Bond Position:  [1.73593505]


portfolio before change:  [1.65899539]
curr_Stock_Price:  99.16771129968888
curr_Factors:  [99.1677113  -0.65120976 -0.89621383]
mat_Sqrt:  [[21.10244433  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00163189 -0.0031117  -0.02149886]
Stock Position:  -0.0016318903214996455
Bond Position:  [1.82082622]


portfolio before change:  [1.6580325]
curr_Stock_Price:  100.03673878992562
curr_Factors:  [100.03673879  -0.36684179  -0.91626626]
mat_Sqrt:  [[27.72763205  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0094872  -0.07076199 -0.45391589]
Stock Position:  0.009487195329641191
Bond Position:  [0.70896441]


portfolio before change:  [1.6820245]
curr_Stock_Price:  102.54693714965735
curr_Factors:  [102.54693715  -0.67537123  -0.92461911]
mat_Sqrt:  [[20.70406959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00193679 -0.02760939 -0.23799435]
Stock Position:  0.001936794021121397
Bond Position:  [1.48341221]


portfolio before change:  [1.68505704]
curr_Stock_Price:  103.9211867737562
curr_Factors:  [103.92118677  -0.96467382  -0.90412145]
mat_Sqrt:  [[16.03602137  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00047208 -0.02591108  0.00191903]
Stock Position:  0.0004720790940824398
Bond Position:  [1.63599802]


portfolio before change:  [1.68529124]
curr_Stock_Price:  103.55081214107935
curr_Factors:  [103.55081214  -0.9302637   -0.88920088]
mat_Sqrt:  [[16.78688369  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00831514 -0.01496598 -0.14840805]
Stock Position:  -0.008315142747928536
Bond Position:  [2.54633103]


portfolio before change:  [1.6803541]
curr_Stock_Price:  104.2211322762276
curr_Factors:  [104.22113228  -0.82925551  -0.84576191]
mat_Sqrt:  [[19.52113049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00485332 -0.00840823 -0.32664643]
Stock Position:  -0.004853317120399751
Bond Position:  [2.1861723]


portfolio before change:  [1.68553913]
curr_Stock_Price:  103.2654110818298
curr_Factors:  [103.26541108  -0.89951794  -0.88020239]
mat_Sqrt:  [[17.41935857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01886559  0.10901268  0.16433173]
Stock Position:  -0.01886559326536739
Bond Position:  [3.63370237]


portfolio before change:  [1.65938465]
curr_Stock_Price:  104.69992830739245
curr_Factors:  [104.69992831  -0.88723418  -0.94401441]
mat_Sqrt:  [[16.77433175  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00686256 -0.05667347  0.1098268 ]
Stock Position:  0.006862559618221211
Bond Position:  [0.94087515]


portfolio before change:  [1.66227714]
curr_Stock_Price:  105.0871373338915
curr_Factors:  [105.08713733  -0.93080729  -0.95748844]
mat_Sqrt:  [[15.90278354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00716691  0.00023344 -0.00816026]
Stock Position:  -0.007166908746252847
Bond Position:  [2.41542707]


portfolio before change:  [1.6536293]
curr_Stock_Price:  106.37803899824016
curr_Factors:  [106.378039    -1.01063018  -1.00426607]
mat_Sqrt:  [[14.18383464  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00672054  0.04786149 -0.13916443]
Stock Position:  -0.00672053626853305
Bond Position:  [2.36854677]


portfolio before change:  [1.65646802]
curr_Stock_Price:  106.04376292276126
curr_Factors:  [106.04376292  -1.11701593  -1.01010454]
mat_Sqrt:  [[12.63829378  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.006793    0.00724084  0.3173081 ]
Stock Position:  -0.006792998995051622
Bond Position:  [2.3768232]


portfolio before change:  [1.66739505]
curr_Stock_Price:  104.52267556583897
curr_Factors:  [104.52267557  -0.98316318  -0.98162618]
mat_Sqrt:  [[14.65255431  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00606577 -0.03359441  0.6554311 ]
Stock Position:  -0.0060657697223880525
Bond Position:  [2.30140553]


portfolio before change:  [1.66483118]
curr_Stock_Price:  105.04021841961504
curr_Factors:  [105.04021842  -1.26308697  -0.93896655]
mat_Sqrt:  [[11.614912    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00546672 0.02105505 0.3232477 ]
Stock Position:  0.005466715871572794
Bond Position:  [1.09060615]


portfolio before change:  [1.65977106]
curr_Stock_Price:  104.06471445581931
curr_Factors:  [104.06471446  -1.73960138  -0.94673095]
mat_Sqrt:  [[ 7.0899666   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0094539   0.02146841  0.20796215]
Stock Position:  -0.009453901649104838
Bond Position:  [2.64358864]


portfolio before change:  [1.66271206]
curr_Stock_Price:  103.82354252193223
curr_Factors:  [103.82354252  -1.45956608  -0.90944154]
mat_Sqrt:  [[ 9.71513652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00384815 -0.00923259  0.0619321 ]
Stock Position:  -0.0038481509303491136
Bond Position:  [2.06224072]


portfolio before change:  [1.66521656]
curr_Stock_Price:  103.30670208296876
curr_Factors:  [103.30670208  -1.38661057  -0.89893322]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.66521656]
Stock Price:  102.4880792560961
PL:  [-0.8228627]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.16870868e-01 -5.94929816e-02  1.73335872e-01]
 [-1.54956301e-01  1.67142544e-01  8.53184078e-02]
 [-1.26182356e-01 -4.74088647e-01 -1.96698889e-02]
 [-1.61478678e-02  1.60621567e-01  1.15203752e-01]
 [ 1.41328929e-01 -5.95605653e-02 -4.48190774e-02]
 [-1.65584417e-01  8.70404517e-02  4.06194615e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 4.16455230e-01  4.19132695e-02  9.54624842e-03]
 [-1.47235455e-01  1.27930049e-02  1.63617173e-01]
 [-1.13493784e-01  9.46273463e-02 -3.25214055e-02]
 [-2.72164025e-02 -6.55149609e-02 -1.62179562e-03]
 [ 7.72997620e-02  1.03422119e-01 -7.91887309e-04]
 [-3.86035605e-03  1.60004961e-01  5.47482806e-02]
 [-3.49926704e-02 -1.36503404e-01 -8.60309523e-02]
 [-1.48131346e-01 -1.05173005e-01  2.14549643e-01]
 [ 2.85257899e-02  1.04772701e-01  1.62205987e-01]
 [-9.05974973e-02  8.39487285e-02  4.51641040e-02]
 [-4.73367032e-02 -4.76119808e-02  2.22603115e-02]
 [-2.03673885e-02  5.65653398e-01  3.04813064e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.00453243]
curr_Stock_Price:  99.6835694712912
curr_Factors:  [99.68356947 -1.62613698 -1.01408981]
mat_Sqrt:  [[ 7.11193291  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03979578 -0.01881333  0.494479  ]
Stock Position:  -0.03979578225703136
Bond Position:  [3.97151805]


portfolio before change:  [0.0370539]
curr_Stock_Price:  98.89131300804898
curr_Factors:  [98.89131301 -1.4672265  -1.04996052]
mat_Sqrt:  [[ 7.9791699   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01669662  0.05285511  0.24338967]
Stock Position:  -0.01669661807685304
Bond Position:  [1.68820438]


portfolio before change:  [0.03917221]
curr_Stock_Price:  98.78972297330637
curr_Factors:  [98.78972297 -1.0884693  -1.06001036]
mat_Sqrt:  [[11.52494616  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01235914 -0.14991999 -0.05611272]
Stock Position:  -0.012359135547853112
Bond Position:  [1.26012779]


portfolio before change:  [0.05180924]
curr_Stock_Price:  97.79273148451558
curr_Factors:  [97.79273148 -0.99363685 -1.02022942]
mat_Sqrt:  [[13.0525561   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00088222 0.050793   0.32864424]
Stock Position:  0.0008822203488696929
Bond Position:  [-0.0344655]


portfolio before change:  [0.05031093]
curr_Stock_Price:  96.104167382912
curr_Factors:  [96.10416738 -0.93847062 -0.98041673]
mat_Sqrt:  [[14.10522535  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00926199 -0.0188347  -0.12785635]
Stock Position:  0.009261987883734784
Bond Position:  [-0.8398047]


portfolio before change:  [0.0471376]
curr_Stock_Price:  95.78421917082723
curr_Factors:  [95.78421917 -0.69584386 -0.97029849]
mat_Sqrt:  [[18.10079014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00856568  0.02752461  0.11587602]
Stock Position:  -0.008565682931621132
Bond Position:  [0.86759485]


portfolio before change:  [0.05141656]
curr_Stock_Price:  95.30999696390882
curr_Factors:  [95.30999696 -1.31559805 -0.94999029]
mat_Sqrt:  [[ 9.89021976  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057292 -0.02845143  0.0120735 ]
Stock Position:  -0.000572918906301453
Bond Position:  [0.10602146]


portfolio before change:  [0.05122232]
curr_Stock_Price:  95.69531588074388
curr_Factors:  [95.69531588 -0.98352764 -0.94244274]
mat_Sqrt:  [[13.94608698  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03007912 0.01325414 0.02723279]
Stock Position:  0.03007912158632969
Bond Position:  [-2.82720873]


portfolio before change:  [0.12070949]
curr_Stock_Price:  98.0289633783931
curr_Factors:  [98.02896338 -1.05062504 -0.9602129 ]
mat_Sqrt:  [[13.12376934  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00864896  0.0040455   0.46675425]
Stock Position:  -0.008648957689381615
Bond Position:  [0.96855785]


portfolio before change:  [0.12484506]
curr_Stock_Price:  97.57880557834285
curr_Factors:  [97.57880558 -0.99124299 -0.97678799]
mat_Sqrt:  [[13.63485437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00863148  0.02992379 -0.09277452]
Stock Position:  -0.008631476179007093
Bond Position:  [0.96709419]


portfolio before change:  [0.13532565]
curr_Stock_Price:  96.39258973527157
curr_Factors:  [96.39258974 -0.81867958 -1.00768583]
mat_Sqrt:  [[15.51898188  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188408 -0.02071765 -0.00462653]
Stock Position:  -0.001884082307175478
Bond Position:  [0.31693723]


portfolio before change:  [0.13092766]
curr_Stock_Price:  98.76894207280264
curr_Factors:  [98.76894207 -0.82516386 -1.10792652]
mat_Sqrt:  [[14.29189835  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00558418  0.03270495 -0.00225903]
Stock Position:  0.005584175340224625
Bond Position:  [-0.42061544]


portfolio before change:  [0.13502289]
curr_Stock_Price:  99.52113928748304
curr_Factors:  [99.52113929 -1.07613348 -1.11447424]
mat_Sqrt:  [[11.13131559  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00102831 0.05059801 0.15618161]
Stock Position:  0.0010283061482573878
Bond Position:  [0.03268469]


portfolio before change:  [0.13547863]
curr_Stock_Price:  99.9563836916188
curr_Factors:  [99.95638369 -1.13886417 -1.10746039]
mat_Sqrt:  [[10.57411853  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00530334 -0.04316617 -0.24542236]
Stock Position:  -0.005303342075680563
Bond Position:  [0.66558152]


portfolio before change:  [0.13365833]
curr_Stock_Price:  100.33099939502556
curr_Factors:  [100.3309994   -0.99222993  -1.09631609]
mat_Sqrt:  [[12.42771046  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00861399 -0.03325862  0.61205041]
Stock Position:  -0.00861398722571636
Bond Position:  [0.99790827]


portfolio before change:  [0.134332]
curr_Stock_Price:  100.28175808360585
curr_Factors:  [100.28175808  -1.09733489  -1.07496247]
mat_Sqrt:  [[11.42365775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00563227 0.03313204 0.46272853]
Stock Position:  0.00563227376528568
Bond Position:  [-0.43048232]


portfolio before change:  [0.12952172]
curr_Stock_Price:  99.44681182701676
curr_Factors:  [99.44681183 -0.75233695 -1.02958752]
mat_Sqrt:  [[16.73828273  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00473232  0.02654692  0.12884062]
Stock Position:  -0.004732317382845697
Bond Position:  [0.6001356]


portfolio before change:  [0.12260981]
curr_Stock_Price:  100.93909660617163
curr_Factors:  [100.93909661  -0.57213145  -0.97892654]
mat_Sqrt:  [[21.40146418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00205697 -0.01505623  0.06350247]
Stock Position:  -0.0020569701108927143
Bond Position:  [0.33023851]


portfolio before change:  [0.12080504]
curr_Stock_Price:  101.85662893171343
curr_Factors:  [101.85662893  -0.50022319  -1.04966765]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.12080504]
Stock Price:  101.73729785422574
PL:  [-1.61649281]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.89255807e-01 -2.15886406e-02  4.52576733e-02]
 [ 7.05588793e-02  2.42563363e-02  1.08922828e-02]
 [-1.01550540e-02 -1.02989116e-01  3.46880123e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 6.66223761e-01 -4.36723246e-01 -2.45929312e-01]
 [ 3.23752936e-02  3.18764971e-02 -2.07571074e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 1.39600303e-01 -8.87129486e-03  6.85190347e-03]
 [-2.09064819e-02  3.01874325e-02 -1.82357593e-02]
 [-2.91800840e-01  2.74403740e-01  5.29487126e-03]
 [ 6.46792618e-02 -1.20680832e-01  2.46604084e-03]
 [ 1.68533607e-02  8.03313650e-02  4.73844367e-02]
 [-2.21806466e-02  1.71093877e-01  3.75621083e-02]
 [-5.33181652e-02 -9.06692792e-02 -2.75491884e-02]
 [-1.51067990e-01 -1.08597703e-01  2.21714565e-01]
 [ 3.44890120e-02  1.14985800e-01  1.90343433e-01]
 [-7.55157276e-02  9.29357331e-02  5.22062171e-02]
 [-4.35579178e-02 -3.63744590e-02  2.18370155e-02]
 [-2.99129068e-02  4.97665299e-01  2.41494986e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.79940654]
curr_Stock_Price:  101.3265816162618
curr_Factors:  [101.32658162  -0.85378777  -1.00962986]
mat_Sqrt:  [[15.71995867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01148699 -0.00682693  0.12910754]
Stock Position:  -0.011486992018577395
Bond Position:  [12.96334417]


portfolio before change:  [11.80078436]
curr_Stock_Price:  101.48880177123397
curr_Factors:  [101.48880177  -0.86662241  -1.02028157]
mat_Sqrt:  [[15.37963891  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0047731  0.00767053 0.03107265]
Stock Position:  0.004773099914912732
Bond Position:  [11.31636817]


portfolio before change:  [11.80232339]
curr_Stock_Price:  101.21845112871108
curr_Factors:  [101.21845113  -1.12919397  -1.00280629]
mat_Sqrt:  [[12.00449066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047762 -0.03256802  0.09895524]
Stock Position:  -0.0004776179919643253
Bond Position:  [11.85066715]


portfolio before change:  [11.80525954]
curr_Stock_Price:  101.27475828846043
curr_Factors:  [101.27475829  -1.27781623  -0.99595119]
mat_Sqrt:  [[10.42357205  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364019 -0.00455813 -0.02970002]
Stock Position:  -0.0036401875480251383
Bond Position:  [12.17391865]


portfolio before change:  [11.81017876]
curr_Stock_Price:  100.75957409275355
curr_Factors:  [100.75957409  -1.61271524  -0.97928434]
mat_Sqrt:  [[ 7.54388761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08016391 -0.13810402 -0.70156787]
Stock Position:  0.08016390701901109
Bond Position:  [3.73289763]


portfolio before change:  [11.75177179]
curr_Stock_Price:  100.01933673686878
curr_Factors:  [100.01933674  -1.75898777  -1.04474519]
mat_Sqrt:  [[ 6.05951992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00477947  0.01008023 -0.05921425]
Stock Position:  0.004779473425500848
Bond Position:  [11.27373202]


portfolio before change:  [11.75005174]
curr_Stock_Price:  99.0696850346098
curr_Factors:  [99.06968503 -1.60472362 -1.03448351]
mat_Sqrt:  [[ 7.07534609  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00080085 -0.02845143  0.0120735 ]
Stock Position:  -0.000800850420105587
Bond Position:  [11.82939173]


portfolio before change:  [11.7526736]
curr_Stock_Price:  99.4890534440134
curr_Factors:  [99.48905344 -1.33511568 -1.07774668]
mat_Sqrt:  [[ 8.91009822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01579892 -0.00280535  0.01954657]
Stock Position:  0.01579891514263916
Bond Position:  [10.18085449]


portfolio before change:  [11.77820995]
curr_Stock_Price:  100.94426853230728
curr_Factors:  [100.94426853  -1.29208253  -1.11413263]
mat_Sqrt:  [[ 9.10071887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262061  0.0095461  -0.05202155]
Stock Position:  -0.0026206066638247666
Bond Position:  [12.04274518]


portfolio before change:  [11.78074534]
curr_Stock_Price:  101.1257821697004
curr_Factors:  [101.12578217  -0.99939766  -1.1525134 ]
mat_Sqrt:  [[11.75706159  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02412465  0.08677408  0.01510479]
Stock Position:  -0.024124646475999423
Bond Position:  [14.22036908]


portfolio before change:  [11.81147705]
curr_Stock_Price:  99.99929226532431
curr_Factors:  [99.99929227 -0.8229072  -1.12884346]
mat_Sqrt:  [[14.20242108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00437015 -0.03816263  0.00703493]
Stock Position:  0.004370147467920481
Bond Position:  [11.37446539]


portfolio before change:  [11.81798719]
curr_Stock_Price:  100.83820512102967
curr_Factors:  [100.83820512  -0.95113263  -1.09918412]
mat_Sqrt:  [[12.97728532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00220384 0.02540301 0.13517461]
Stock Position:  0.0022038365157265637
Bond Position:  [11.59575627]


portfolio before change:  [11.82070447]
curr_Stock_Price:  100.75561130401404
curr_Factors:  [100.7556113   -0.75730339  -1.08349924]
mat_Sqrt:  [[15.98890854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063142  0.05410463  0.10715424]
Stock Position:  -0.0006314182364610198
Bond Position:  [11.8843234]


portfolio before change:  [11.82313783]
curr_Stock_Price:  101.60781486198702
curr_Factors:  [101.60781486  -1.00865104  -1.02204749]
mat_Sqrt:  [[13.33539697  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00459549 -0.02867214 -0.07859017]
Stock Position:  -0.004595490526573431
Bond Position:  [12.29007558]


portfolio before change:  [11.8258399]
curr_Stock_Price:  101.68850994891955
curr_Factors:  [101.68850995  -1.00983579  -0.96699428]
mat_Sqrt:  [[14.08463163  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00771157 -0.03434161  0.63248994]
Stock Position:  -0.0077115737118162615
Bond Position:  [12.61001834]


portfolio before change:  [11.82178716]
curr_Stock_Price:  102.62290215265182
curr_Factors:  [102.62290215  -1.44285861  -0.9409668 ]
mat_Sqrt:  [[ 9.4615452   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00806545 0.0363617  0.54299683]
Stock Position:  0.008065450366020138
Bond Position:  [10.99408724]


portfolio before change:  [11.8227578]
curr_Stock_Price:  102.40242815268249
curr_Factors:  [102.40242815  -1.61829688  -0.92731707]
mat_Sqrt:  [[ 8.03089898  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00777741  0.02938886  0.14892981]
Stock Position:  -0.007777409229211812
Bond Position:  [12.61918339]


portfolio before change:  [11.82148492]
curr_Stock_Price:  102.97177926896451
curr_Factors:  [102.97177927  -1.75905078  -0.9415405 ]
mat_Sqrt:  [[ 6.91618063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00578927 -0.01150261  0.06229493]
Stock Position:  -0.005789270456336797
Bond Position:  [12.4176164]


portfolio before change:  [11.82383218]
curr_Stock_Price:  103.10262938311382
curr_Factors:  [103.10262938  -1.45017489  -0.9051969 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.82383218]
Stock Price:  102.45988510481317
PL:  [9.36394708]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.13614085e-01 -4.84139976e-02  1.42798773e-01]
 [-1.03182096e-01  1.39909467e-01  9.26700360e-02]
 [-6.71445869e-02 -3.61183485e-01  1.50485138e-02]
 [-2.62059513e-02  6.70427343e-04 -9.30225472e-04]
 [ 6.79990356e-01 -4.18898382e-01 -1.91367532e-01]
 [-9.06498254e-02  6.88258800e-02  2.55727310e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-5.20024320e-03 -3.30227796e-02 -6.27477823e-03]
 [-1.00640975e-01  2.11470010e-02  8.67122825e-02]
 [-1.24498441e-01  1.09363675e-01 -2.08245159e-02]
 [-2.52628341e-02 -6.64599366e-02 -3.31874364e-03]
 [ 1.32467894e-01  3.98498385e-02 -1.47809619e-01]
 [ 1.39166449e-02  8.13948776e-02  4.19594991e-02]
 [ 1.56330350e-01 -2.09557955e-01  1.17015190e-01]
 [-1.23943746e-01 -1.16907539e-01  3.94982022e-02]
 [-1.27641215e-02  1.97207799e-01  3.73051418e-01]
 [-1.69894332e-02  6.01137721e-02  1.88806261e-03]
 [ 1.48323163e-02  2.76384813e-02  9.75975044e-02]
 [-1.67629277e-02  6.10297276e-01  3.27328156e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.52517278]
curr_Stock_Price:  99.7560940627397
curr_Factors:  [99.75609406 -1.36895787 -0.98529366]
mat_Sqrt:  [[ 9.4732934   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0301601  -0.01530985  0.40736515]
Stock Position:  -0.030160097392337396
Bond Position:  [3.5338263]


portfolio before change:  [0.53502801]
curr_Stock_Price:  99.45862611664185
curr_Factors:  [99.45862612 -1.33500707 -0.97690448]
mat_Sqrt:  [[ 9.85353418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00818523  0.04424326  0.26436182]
Stock Position:  -0.00818523138882211
Bond Position:  [1.34911988]


portfolio before change:  [0.53471078]
curr_Stock_Price:  99.53859459498854
curr_Factors:  [99.53859459 -1.16136334 -0.97335075]
mat_Sqrt:  [[11.77326602  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00623434 -0.11421625  0.04292922]
Stock Position:  -0.006234339663868194
Bond Position:  [1.15526818]


portfolio before change:  [0.53826206]
curr_Stock_Price:  99.01529451944329
curr_Factors:  [99.01529452 -0.90535078 -0.92570284]
mat_Sqrt:  [[15.86667046  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166251  0.00021201 -0.00265367]
Stock Position:  -0.001662511517637877
Bond Position:  [0.70287613]


portfolio before change:  [0.53767008]
curr_Stock_Price:  99.47707482865562
curr_Factors:  [99.47707483 -1.05055494 -0.93289873]
mat_Sqrt:  [[13.68737053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04603599 -0.1324673  -0.5459183 ]
Stock Position:  0.04603599431844298
Bond Position:  [-4.04185597]


portfolio before change:  [0.49103542]
curr_Stock_Price:  98.4860226984113
curr_Factors:  [98.4860227  -0.96812582 -0.94591912]
mat_Sqrt:  [[14.52497661  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00575923  0.02176465  0.07295188]
Stock Position:  -0.005759233849741621
Bond Position:  [1.05823946]


portfolio before change:  [0.48227123]
curr_Stock_Price:  100.05372814769696
curr_Factors:  [100.05372815  -0.88208354  -0.94113789]
mat_Sqrt:  [[16.15914094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035066 -0.02845143  0.0120735 ]
Stock Position:  -0.00035065563859097335
Bond Position:  [0.51735564]


portfolio before change:  [0.48241004]
curr_Stock_Price:  100.02678005954172
curr_Factors:  [100.02678006  -0.86902268  -0.99092658]
mat_Sqrt:  [[15.57222202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047095 -0.01044272 -0.0179002 ]
Stock Position:  -0.0004709489394323778
Bond Position:  [0.52951755]


portfolio before change:  [0.48313619]
curr_Stock_Price:  98.76602199783285
curr_Factors:  [98.766022   -0.86793461 -0.95692086]
mat_Sqrt:  [[15.92512693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00517389  0.00668727  0.24736601]
Stock Position:  -0.0051738922809593
Bond Position:  [0.99414095]


portfolio before change:  [0.48636006]
curr_Stock_Price:  98.19095966357989
curr_Factors:  [98.19095966 -0.91423072 -0.93494297]
mat_Sqrt:  [[15.45203109  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00814944  0.03458383 -0.05940655]
Stock Position:  -0.008149444465443533
Bond Position:  [1.28656184]


portfolio before change:  [0.50468145]
curr_Stock_Price:  95.9822569553052
curr_Factors:  [95.98225696 -0.56568148 -0.92169986]
mat_Sqrt:  [[21.68849662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00127516 -0.02101648 -0.00946745]
Stock Position:  -0.0012751579074872616
Bond Position:  [0.62707398]


portfolio before change:  [0.5075786]
curr_Stock_Price:  93.83321406678783
curr_Factors:  [93.83321407 -0.46586015 -0.89876121]
mat_Sqrt:  [[23.97226492  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0043102   0.01260163 -0.4216597 ]
Stock Position:  0.004310201819833244
Bond Position:  [0.10313851]


portfolio before change:  [0.49898611]
curr_Stock_Price:  91.83370664836728
curr_Factors:  [91.83370665 -0.46985232 -0.85189777]
mat_Sqrt:  [[24.48912914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00100384 0.02573932 0.11969877]
Stock Position:  0.0010038412702471694
Bond Position:  [0.40679965]


portfolio before change:  [0.5001542]
curr_Stock_Price:  92.89600410416803
curr_Factors:  [92.8960041  -0.41148176 -0.90281707]
mat_Sqrt:  [[24.95768526  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00700406 -0.06626804  0.33381177]
Stock Position:  0.007004063523715887
Bond Position:  [-0.15049531]


portfolio before change:  [0.49805298]
curr_Stock_Price:  92.60137614791891
curr_Factors:  [92.60137615 -0.41972127 -0.91577573]
mat_Sqrt:  [[24.35670092  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0048816  -0.03696941  0.11267738]
Stock Position:  -0.004881603186882759
Bond Position:  [0.95009615]


portfolio before change:  [0.49837029]
curr_Stock_Price:  92.58503742064408
curr_Factors:  [92.58503742 -0.29968902 -0.92193826]
mat_Sqrt:  [[27.28945207  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00250927 0.06236258 1.06421186]
Stock Position:  0.0025092685468352327
Bond Position:  [0.26604957]


portfolio before change:  [0.50036057]
curr_Stock_Price:  93.35169813537524
curr_Factors:  [93.35169814 -0.12363327 -0.93173545]
mat_Sqrt:  [[32.49237157  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046324  0.01900964  0.00538612]
Stock Position:  -0.0004632442146366766
Bond Position:  [0.5436052]


portfolio before change:  [0.49924383]
curr_Stock_Price:  96.05579316058085
curr_Factors:  [ 9.60557932e+01  9.19246442e-02 -8.91942274e-01]
mat_Sqrt:  [[43.15988913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00082178 0.00874006 0.27841851]
Stock Position:  0.0008217802851483755
Bond Position:  [0.42030708]


portfolio before change:  [0.50268076]
curr_Stock_Price:  100.11020907947704
curr_Factors:  [ 1.00110209e+02 -9.12196835e-02 -8.82254570e-01]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.50268076]
Stock Price:  98.77972353206948
PL:  [0.50268076]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.80507165e-01 -3.91139357e-02  1.11010105e-01]
 [-1.26405310e-01  1.39579097e-01  3.43378354e-02]
 [-6.06704027e-02 -3.10979943e-01  1.43560695e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 5.77750175e-01 -3.61128181e-01 -1.77076549e-01]
 [-8.96599917e-03  4.89158856e-02  1.01438775e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 1.70255429e-01 -3.79551022e-03  9.68436138e-03]
 [-1.21789735e-01  1.89227313e-02  1.13668113e-01]
 [-1.86215013e-01  1.72918649e-01  6.86673929e-03]
 [ 4.33830076e-02 -1.08166376e-01  3.63246358e-03]
 [ 2.03700149e-02  7.93604978e-02  3.76001695e-02]
 [-4.49934958e-03  1.68700426e-01  5.73711588e-02]
 [-5.60027633e-02 -7.23792542e-02 -2.07531819e-02]
 [-1.44606137e-01 -1.05797934e-01  2.19151517e-01]
 [ 3.27496414e-02  9.41830074e-02  1.43763357e-01]
 [-9.88770188e-02  6.80238503e-02  5.46320661e-02]
 [-4.92037392e-02 -5.36142771e-02  2.27536986e-02]
 [-3.09500671e-02  4.91321335e-01  2.33274576e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.00327882]
curr_Stock_Price:  99.68339484430703
curr_Factors:  [99.68339484 -0.85325463 -0.97468553]
mat_Sqrt:  [[16.02354103  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01615481 -0.01236891  0.31668093]
Stock Position:  -0.016154808653951278
Bond Position:  [1.61364499]


portfolio before change:  [0.00754264]
curr_Stock_Price:  99.44443428101262
curr_Factors:  [99.44443428 -0.86272083 -1.01591512]
mat_Sqrt:  [[15.19494927  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00762044  0.04413879  0.09795629]
Stock Position:  -0.007620440851914465
Bond Position:  [0.76535307]


portfolio before change:  [0.00747582]
curr_Stock_Price:  99.47831474699242
curr_Factors:  [99.47831475 -0.98402967 -0.96245681]
mat_Sqrt:  [[14.20299988  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00463067 -0.09834049  0.04095387]
Stock Position:  -0.004630673125831605
Bond Position:  [0.46812738]


portfolio before change:  [0.00709187]
curr_Stock_Price:  99.58650465667988
curr_Factors:  [99.58650466 -1.01691907 -0.9838889 ]
mat_Sqrt:  [[13.46668266  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0028176  -0.00455813 -0.02970002]
Stock Position:  -0.0028176023871731796
Bond Position:  [0.28768705]


portfolio before change:  [0.00897195]
curr_Stock_Price:  98.94477318934189
curr_Factors:  [98.94477319 -1.03389201 -0.95034186]
mat_Sqrt:  [[13.60351178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03912815 -0.11419876 -0.5051501 ]
Stock Position:  0.039128152708089226
Bond Position:  [-3.86255425]


portfolio before change:  [0.01857019]
curr_Stock_Price:  99.21475798384249
curr_Factors:  [99.21475798 -1.40374336 -0.93169352]
mat_Sqrt:  [[ 9.60083325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058666  0.01546856  0.02893766]
Stock Position:  -0.0005866559671028349
Bond Position:  [0.07677512]


portfolio before change:  [0.01815509]
curr_Stock_Price:  99.95504830190175
curr_Factors:  [99.9550483  -1.13941129 -0.95087983]
mat_Sqrt:  [[12.35955503  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045845 -0.02845143  0.0120735 ]
Stock Position:  -0.00045845452136058064
Bond Position:  [0.06397994]


portfolio before change:  [0.01846299]
curr_Stock_Price:  99.31835087429785
curr_Factors:  [99.31835087 -1.31415145 -0.94387533]
mat_Sqrt:  [[10.3843885   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01657625 -0.00120025  0.02762679]
Stock Position:  0.016576252033633145
Bond Position:  [-1.62786303]


portfolio before change:  [0.00752543]
curr_Stock_Price:  98.68307185280543
curr_Factors:  [98.68307185 -1.2584265  -0.94865437]
mat_Sqrt:  [[10.8572445   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00903533  0.00598389  0.32426349]
Stock Position:  -0.009035326207676738
Bond Position:  [0.89915917]


portfolio before change:  [0.00195503]
curr_Stock_Price:  99.32446739816214
curr_Factors:  [99.3244674  -1.03073674 -0.92133633]
mat_Sqrt:  [[14.10203156  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01278884  0.05468168  0.0195889 ]
Stock Position:  -0.012788838565991171
Bond Position:  [1.27219961]


portfolio before change:  [0.00175889]
curr_Stock_Price:  99.364676216455
curr_Factors:  [99.36467622 -0.99583514 -0.93345886]
mat_Sqrt:  [[14.43278968  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00286373 -0.03420521  0.01036241]
Stock Position:  0.0028637316981033425
Bond Position:  [-0.28279488]


portfolio before change:  [0.00386029]
curr_Stock_Price:  100.12316376315194
curr_Factors:  [100.12316376  -1.30079142  -0.91390809]
mat_Sqrt:  [[10.93207972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00275283 0.02509599 0.10726282]
Stock Position:  0.0027528336178011758
Bond Position:  [-0.27176212]


portfolio before change:  [0.0036597]
curr_Stock_Price:  100.07497955653834
curr_Factors:  [100.07497956  -1.00904559  -0.93224934]
mat_Sqrt:  [[14.36255931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00080538 0.05334776 0.16366395]
Stock Position:  0.0008053798198032524
Bond Position:  [-0.07693867]


portfolio before change:  [0.00537375]
curr_Stock_Price:  102.2271166538936
curr_Factors:  [102.22711665  -1.12959851  -0.91327985]
mat_Sqrt:  [[13.25425482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00468588 -0.02288833 -0.05920305]
Stock Position:  -0.0046858773981201095
Bond Position:  [0.48439748]


portfolio before change:  [0.00586579]
curr_Stock_Price:  102.1479590016353
curr_Factors:  [102.147959    -0.96403835  -0.88060371]
mat_Sqrt:  [[16.14774281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00635406 -0.03345624  0.62517828]
Stock Position:  -0.006354059099429078
Bond Position:  [0.65491995]


portfolio before change:  [0.0182593]
curr_Stock_Price:  100.22324205154852
curr_Factors:  [100.22324205  -0.50656008  -0.86800257]
mat_Sqrt:  [[25.35148903  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00254529 0.02978328 0.41011684]
Stock Position:  0.002545294619997736
Bond Position:  [-0.23683838]


portfolio before change:  [0.01904156]
curr_Stock_Price:  100.55384346851218
curr_Factors:  [100.55384347  -0.87985626  -0.87787528]
mat_Sqrt:  [[17.33906061  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00495811  0.02151103  0.15585008]
Stock Position:  -0.00495810751529041
Bond Position:  [0.51759833]


portfolio before change:  [0.02116639]
curr_Stock_Price:  100.15138940504136
curr_Factors:  [100.15138941  -0.86249451  -0.88605291]
mat_Sqrt:  [[17.42900051  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263604 -0.01695432  0.06490997]
Stock Position:  -0.0026360361031016162
Bond Position:  [0.28516907]


portfolio before change:  [0.01894813]
curr_Stock_Price:  101.01995101621006
curr_Factors:  [101.01995102  -1.21202456  -0.87603777]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.01894813]
Stock Price:  102.17535116903169
PL:  [-2.15640304]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.07605533e-01 -2.33746225e-02  5.37924087e-02]
 [ 7.19092855e-02  9.33473276e-03 -9.13313557e-03]
 [-2.87058681e-02 -2.54184634e-01  1.39332783e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.65612787e-01 -3.08529781e-01 -2.77574988e-01]
 [-4.11033599e-02 -5.69640677e-02 -9.88169202e-02]
 [-3.35074495e-03 -8.85287825e-02  4.00263441e-03]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [-1.20478886e-01 -6.16704462e-02 -1.32169676e-01]
 [-4.85357982e-01  4.77540044e-01  5.88241274e-02]
 [ 1.11211327e-01 -1.72048420e-01  2.94377869e-02]
 [-1.19499659e-01 -2.57262660e-03 -5.53222683e-03]
 [-1.06176468e-01  1.47316167e-01 -7.01729242e-02]
 [-1.17436122e-01 -9.31319005e-03  1.56334744e-01]
 [-1.31639909e-01 -1.05845112e-01  2.29801538e-01]
 [ 2.01393437e-02  7.22810163e-02  8.27564935e-02]
 [-1.17355806e-01  2.91333569e-02  7.98252401e-02]
 [-3.82984934e-02 -2.10759652e-02  2.14640132e-02]
 [ 1.02584701e-03  6.00472158e-01  4.21311708e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.95988294]
curr_Stock_Price:  101.07033813477042
curr_Factors:  [101.07033813  -0.81107577  -1.00002581]
mat_Sqrt:  [[16.52236833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01193707 -0.0073917   0.15345477]
Stock Position:  -0.011937074010204088
Bond Position:  [11.16636705]


portfolio before change:  [9.94544407]
curr_Stock_Price:  102.51380904348896
curr_Factors:  [102.51380904  -0.98677797  -1.01549127]
mat_Sqrt:  [[13.84228823  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00507763  0.0029519  -0.02605429]
Stock Position:  0.005077629697059424
Bond Position:  [9.4249169]


portfolio before change:  [9.95624875]
curr_Stock_Price:  104.17760853341967
curr_Factors:  [104.17760853  -1.17555435  -1.0077721 ]
mat_Sqrt:  [[11.73728775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00276254 -0.08038024  0.03974776]
Stock Position:  -0.0027625435585867664
Bond Position:  [10.24404393]


portfolio before change:  [9.95548684]
curr_Stock_Price:  105.38057185544574
curr_Factors:  [105.38057186  -1.2603898   -1.00834288]
mat_Sqrt:  [[10.90090283  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00348079 -0.00455813 -0.02970002]
Stock Position:  -0.00348079033202222
Bond Position:  [10.32229451]


portfolio before change:  [9.96521413]
curr_Stock_Price:  103.32747522276479
curr_Factors:  [103.32747522  -1.14065615  -1.0108141 ]
mat_Sqrt:  [[12.01833094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02504398 -0.09756568 -0.79184418]
Stock Position:  0.025043978814658033
Bond Position:  [7.37748303]


portfolio before change:  [9.95421663]
curr_Stock_Price:  102.81469316016853
curr_Factors:  [102.81469316  -1.31451128  -1.01394046]
mat_Sqrt:  [[10.01893237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00626265 -0.01801362 -0.28189717]
Stock Position:  -0.0062626518305771975
Bond Position:  [10.59810926]


portfolio before change:  [9.95177093]
curr_Stock_Price:  103.62833640212702
curr_Factors:  [103.6283364   -1.29325785  -0.97265976]
mat_Sqrt:  [[10.74986506  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044833 -0.02799526  0.0114184 ]
Stock Position:  -0.00044833250741438635
Bond Position:  [9.99823088]


portfolio before change:  [9.95407389]
curr_Stock_Price:  104.06754526951438
curr_Factors:  [104.06754527  -1.28978673  -1.0113962 ]
mat_Sqrt:  [[10.42135676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01339416 -0.01496598 -0.14840805]
Stock Position:  -0.013394161374035242
Bond Position:  [11.34797138]


portfolio before change:  [9.93701393]
curr_Stock_Price:  105.55306606125117
curr_Factors:  [105.55306606  -1.38496579  -1.06318875]
mat_Sqrt:  [[ 9.1253776   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0163336  -0.01950191 -0.3770433 ]
Stock Position:  -0.016333596121789425
Bond Position:  [11.66107508]


portfolio before change:  [9.94796651]
curr_Stock_Price:  105.06101575963184
curr_Factors:  [105.06101576  -1.11965787  -1.05514373]
mat_Sqrt:  [[11.93815625  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0386174   0.15101142  0.16780886]
Stock Position:  -0.038617397614651404
Bond Position:  [14.00514953]


portfolio before change:  [9.96872382]
curr_Stock_Price:  104.61418141742996
curr_Factors:  [104.61418142  -1.04321154  -1.05947062]
mat_Sqrt:  [[12.77636466  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00882708 -0.05440649  0.08397781]
Stock Position:  0.008827082036174458
Bond Position:  [9.04528585]


portfolio before change:  [9.9797159]
curr_Stock_Price:  105.60323728761028
curr_Factors:  [105.60323729  -0.513713    -1.02185788]
mat_Sqrt:  [[22.73983308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00530766 -0.00081354 -0.0157819 ]
Stock Position:  -0.005307661870969832
Bond Position:  [10.54022217]


portfolio before change:  [9.97831698]
curr_Stock_Price:  106.36332770368651
curr_Factors:  [106.3633277   -0.58641289  -0.97569701]
mat_Sqrt:  [[22.30366355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00523218  0.04658546 -0.20018382]
Stock Position:  -0.005232179417338801
Bond Position:  [10.53482899]


portfolio before change:  [9.98761125]
curr_Stock_Price:  105.09039000282036
curr_Factors:  [105.09039     -0.73976305  -0.93563255]
mat_Sqrt:  [[19.67650398  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435875 -0.00294509  0.44597951]
Stock Position:  -0.004358746444283926
Bond Position:  [10.44567362]


portfolio before change:  [9.99403394]
curr_Stock_Price:  104.21606957261135
curr_Factors:  [104.21606957  -0.6620055   -0.93389667]
mat_Sqrt:  [[21.12726029  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0041399  -0.03347116  0.65555982]
Stock Position:  -0.004139901439930968
Bond Position:  [10.4254782]


portfolio before change:  [10.00525422]
curr_Stock_Price:  102.13544332721371
curr_Factors:  [102.13544333  -0.46749709  -0.9548554 ]
mat_Sqrt:  [[24.62955939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00157933 0.02285726 0.23608124]
Stock Position:  0.0015793311353776293
Bond Position:  [9.84394854]


portfolio before change:  [10.01082928]
curr_Stock_Price:  104.10701463322059
curr_Factors:  [104.10701463  -0.35968892  -0.9266056 ]
mat_Sqrt:  [[28.76400663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00348732  0.00921278  0.22771919]
Stock Position:  -0.003487321096953789
Bond Position:  [10.37388387]


portfolio before change:  [10.01184332]
curr_Stock_Price:  104.56001633053627
curr_Factors:  [104.56001633  -0.47795696  -0.9259381 ]
mat_Sqrt:  [[25.68394721  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00134175 -0.00666481  0.06123086]
Stock Position:  -0.0013417466103506212
Bond Position:  [10.15213636]


portfolio before change:  [10.01180948]
curr_Stock_Price:  106.47705701644831
curr_Factors:  [106.47705702  -0.41486399  -0.93127373]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.01180948]
Stock Price:  107.60141700790086
PL:  [2.41039248]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.37780076e-02 -9.73790512e-02  7.64383640e-02]
 [-8.39560666e-02  1.01771319e-01 -2.75394639e-02]
 [ 2.78705474e-02  1.19052192e-02  3.24069184e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.35076483e-01 -2.84647227e-01 -2.58179580e-01]
 [ 2.12030295e-03 -6.62476034e-02 -8.99293239e-02]
 [ 3.62102809e-02 -8.33261953e-02 -6.08209651e-03]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [-6.83961831e-02 -2.43885841e-02 -1.12308342e-01]
 [-2.84418415e-01  2.83960341e-01  4.00711952e-02]
 [ 1.23086351e-01 -1.56950769e-01 -1.39274445e-03]
 [ 1.04434611e-01  4.19270757e-02 -1.11888105e-01]
 [ 3.27577894e-02  1.53090509e-01  9.50138231e-02]
 [ 5.52237384e-02 -5.54728738e-02  6.41451690e-02]
 [-1.23836471e-01 -8.71197734e-02  1.83930339e-01]
 [ 1.17501021e-02  9.83152426e-02  1.47957492e-01]
 [-1.35003700e-01  1.97006405e-02  7.02706091e-02]
 [-3.99615485e-02 -2.56795535e-02  2.14342416e-02]
 [-2.36263052e-02  5.53871864e-01  2.71880317e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.61999709]
curr_Stock_Price:  98.62148144166926
curr_Factors:  [98.62148144 -0.6829158  -0.97271793]
mat_Sqrt:  [[18.83384226  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.66047534e-05 -3.07939598e-02  2.18057376e-01]
Stock Position:  -3.6604753395036424e-05
Bond Position:  [-7.61638707]


portfolio before change:  [-7.6219617]
curr_Stock_Price:  100.26812826740931
curr_Factors:  [100.26812827  -0.41189516  -0.94237008]
mat_Sqrt:  [[25.88290321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00335935  0.03218292 -0.07856242]
Stock Position:  -0.0033593531333060145
Bond Position:  [-7.28512565]


portfolio before change:  [-7.63134164]
curr_Stock_Price:  102.51809518137222
curr_Factors:  [102.51809518  -0.60540429  -0.95662832]
mat_Sqrt:  [[21.49900622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00161835 0.00376476 0.09244792]
Stock Position:  0.0016183526359979813
Bond Position:  [-7.79725207]


portfolio before change:  [-7.63380057]
curr_Stock_Price:  102.20334888230231
curr_Factors:  [102.20334888  -0.56083528  -0.94871976]
mat_Sqrt:  [[22.58778795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00167984 -0.00455813 -0.02970002]
Stock Position:  -0.0016798350186629065
Bond Position:  [-7.46211581]


portfolio before change:  [-7.63610394]
curr_Stock_Price:  102.46385339944064
curr_Factors:  [102.4638534   -1.187496    -0.99158372]
mat_Sqrt:  [[11.59333507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02372279 -0.09001336 -0.73651448]
Stock Position:  0.02372278860328443
Bond Position:  [-10.06683227]


portfolio before change:  [-7.6350612]
curr_Stock_Price:  102.61391002100429
curr_Factors:  [102.61391002  -1.01472483  -0.94558264]
mat_Sqrt:  [[14.44958983  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124204 -0.02094933 -0.25654333]
Stock Position:  -0.0012420386596734938
Bond Position:  [-7.50761075]


portfolio before change:  [-7.63902443]
curr_Stock_Price:  104.29348220091396
curr_Factors:  [104.2934822   -0.82739122  -0.93731062]
mat_Sqrt:  [[17.85899024  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00183758 -0.02635006 -0.01735053]
Stock Position:  0.0018375789756180064
Bond Position:  [-7.83067194]


portfolio before change:  [-7.64162538]
curr_Stock_Price:  103.94354574587476
curr_Factors:  [103.94354575  -0.85707171  -0.95031423]
mat_Sqrt:  [[17.05531677  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00818427 -0.01496598 -0.14840805]
Stock Position:  -0.008184270985975309
Bond Position:  [-6.79092323]


portfolio before change:  [-7.64528677]
curr_Stock_Price:  104.18345069821547
curr_Factors:  [104.1834507   -0.59958329  -0.94070637]
mat_Sqrt:  [[22.3284944   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00411809 -0.00771235 -0.32038444]
Stock Position:  -0.004118089485371006
Bond Position:  [-7.21624999]


portfolio before change:  [-7.64623584]
curr_Stock_Price:  103.97577883964773
curr_Factors:  [103.97577884  -0.10883022  -0.90117742]
mat_Sqrt:  [[37.86966294  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00710086  0.08979614  0.11431197]
Stock Position:  -0.007100857814933258
Bond Position:  [-6.90791862]


portfolio before change:  [-7.62011592]
curr_Stock_Price:  100.05412303949983
curr_Factors:  [100.05412304   0.3246433   -0.92323903]
mat_Sqrt:  [[54.98803063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00215955 -0.04963219 -0.00397311]
Stock Position:  0.002159553731577839
Bond Position:  [-7.83618817]


portfolio before change:  [-7.63294554]
curr_Stock_Price:  95.02052422112556
curr_Factors:  [95.02052422  0.21351425 -0.91252547]
mat_Sqrt:  [[47.23247548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00175045  0.01325851 -0.31918562]
Stock Position:  0.0017504502802718233
Bond Position:  [-7.79927424]


portfolio before change:  [-7.6360044]
curr_Stock_Price:  94.38708944898886
curr_Factors:  [94.38708945  0.30221234 -0.90581411]
mat_Sqrt:  [[51.61449435  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.001087   0.04841147 0.27104799]
Stock Position:  0.0010870044447117862
Bond Position:  [-7.73860358]


portfolio before change:  [-7.63784353]
curr_Stock_Price:  94.47518210568535
curr_Factors:  [94.47518211  0.19637119 -0.92462579]
mat_Sqrt:  [[45.60797407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00146652 -0.01754206  0.18298831]
Stock Position:  0.0014665201446817523
Bond Position:  [-7.77639329]


portfolio before change:  [-7.63700659]
curr_Stock_Price:  96.37170370238081
curr_Factors:  [ 9.63717037e+01 -4.71916806e-02 -9.62816602e-01]
mat_Sqrt:  [[35.10011287  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252254 -0.02754969  0.52470206]
Stock Position:  -0.002522535216036438
Bond Position:  [-7.39390557]


portfolio before change:  [-7.63992563]
curr_Stock_Price:  96.79601327373456
curr_Factors:  [96.79601327  0.17932781 -0.94116853]
mat_Sqrt:  [[45.18499607  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00098463 0.03109001 0.42208154]
Stock Position:  0.0009846252335739354
Bond Position:  [-7.73523343]


portfolio before change:  [-7.63989281]
curr_Stock_Price:  98.7935912700177
curr_Factors:  [ 9.87935913e+01  9.42161140e-02 -9.28609593e-01]
mat_Sqrt:  [[42.89002401  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280138  0.00622989  0.20046249]
Stock Position:  -0.002801376448952545
Bond Position:  [-7.36313477]


portfolio before change:  [-7.65585255]
curr_Stock_Price:  103.83351511955539
curr_Factors:  [103.83351512  -0.14125497  -0.99836206]
mat_Sqrt:  [[33.22065359  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109117 -0.00812059  0.06114593]
Stock Position:  -0.001091168942718544
Bond Position:  [-7.54255265]


portfolio before change:  [-7.65280568]
curr_Stock_Price:  99.31290831807195
curr_Factors:  [99.31290832 -0.36198432 -1.05436963]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.65280568]
Stock Price:  101.18912717091463
PL:  [-8.84193285]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.85934022e-01 -4.10001408e-02  1.17196413e-01]
 [-2.13837245e-01  1.98113744e-01  7.69576652e-02]
 [-4.63251494e-02 -2.60774003e-01  4.16263519e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.28731843e-01 -2.51793266e-01 -1.92379380e-01]
 [ 6.93092143e-02 -2.68707411e-02 -4.37379600e-02]
 [-1.69364984e-03 -8.57375652e-02  3.55829552e-03]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [-7.96686649e-02 -3.57622006e-02 -1.24362236e-01]
 [-4.12483746e-01  4.04663438e-01  5.32628064e-02]
 [ 1.17832696e-01 -1.56514090e-01  2.70745002e-03]
 [-9.60737219e-02  1.01613825e-02  4.74365226e-03]
 [-5.73526939e-02  1.65814141e-01 -5.73660076e-03]
 [-1.00873859e-01  3.45275018e-02  8.58227384e-02]
 [-1.88878733e-01 -1.37859796e-01  2.72616972e-01]
 [ 1.71485341e-02  2.61505210e-02  7.79367174e-03]
 [-9.84869776e-02  4.73144097e-02  8.02196052e-02]
 [-4.21252503e-02 -3.16979720e-02  2.14138021e-02]
 [-1.87622801e-02  5.27891539e-01  3.04100171e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.01649828]
curr_Stock_Price:  99.68063991814586
curr_Factors:  [99.68063992 -0.89652872 -0.99894575]
mat_Sqrt:  [[14.97672022  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01756526 -0.01296538  0.33432875]
Stock Position:  -0.01756526258992613
Bond Position:  [1.73441834]


portfolio before change:  [-0.00301799]
curr_Stock_Price:  98.9378879568332
curr_Factors:  [98.93788796 -0.97077109 -1.02849288]
mat_Sqrt:  [[13.39964599  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01440434  0.06264907  0.2195388 ]
Stock Position:  -0.014404339696472628
Bond Position:  [1.42211696]


portfolio before change:  [-0.02318106]
curr_Stock_Price:  100.36236453724408
curr_Factors:  [100.36236454  -1.18663862  -1.02921309]
mat_Sqrt:  [[10.94557843  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00407117 -0.08246398  0.1187484 ]
Stock Position:  -0.004071174671566873
Bond Position:  [0.38541166]


portfolio before change:  [-0.02588392]
curr_Stock_Price:  101.04993675016667
curr_Factors:  [101.04993675  -1.07081918  -1.02418519]
mat_Sqrt:  [[12.43618599  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305108 -0.00455813 -0.02970002]
Stock Position:  -0.00305107669088389
Bond Position:  [0.28242719]


portfolio before change:  [-0.02605171]
curr_Stock_Price:  101.12807447378809
curr_Factors:  [101.12807447  -0.75846163  -0.99380032]
mat_Sqrt:  [[17.53371897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01613812 -0.07962402 -0.54880482]
Stock Position:  0.016138121762179193
Bond Position:  [-1.65806889]


portfolio before change:  [-0.0242876]
curr_Stock_Price:  101.26307631113399
curr_Factors:  [101.26307631  -0.63968304  -0.99281877]
mat_Sqrt:  [[19.7908566   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00301591 -0.00849727 -0.12477223]
Stock Position:  0.003015909933869457
Bond Position:  [-0.32968792]


portfolio before change:  [-0.02124079]
curr_Stock_Price:  102.3006548892823
curr_Factors:  [102.30065489  -0.80401432  -0.97870508]
mat_Sqrt:  [[17.2049421   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018489 -0.0271126   0.01015083]
Stock Position:  -0.0001848916552729411
Bond Position:  [-0.00232625]


portfolio before change:  [-0.02140545]
curr_Stock_Price:  103.18810032248638
curr_Factors:  [103.18810032  -1.10400434  -0.96656546]
mat_Sqrt:  [[13.01345397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01072623 -0.01496598 -0.14840805]
Stock Position:  -0.010726232593033735
Bond Position:  [1.08541411]


portfolio before change:  [-0.03532773]
curr_Stock_Price:  104.51136692439053
curr_Factors:  [104.51136692  -1.13515495  -0.96672517]
mat_Sqrt:  [[12.7740494   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0082963  -0.011309   -0.35477084]
Stock Position:  -0.008296302350204053
Bond Position:  [0.83173017]


portfolio before change:  [-0.02968274]
curr_Stock_Price:  103.85601095248082
curr_Factors:  [103.85601095  -1.0617714   -0.99476156]
mat_Sqrt:  [[13.28283332  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02944877  0.12796581  0.15194396]
Stock Position:  -0.029448773964134152
Bond Position:  [3.02874945]


portfolio before change:  [-0.0389721]
curr_Stock_Price:  104.19716734566425
curr_Factors:  [104.19716735  -1.36280099  -0.99574368]
mat_Sqrt:  [[ 9.85264825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01160543 -0.0494941   0.0077236 ]
Stock Position:  0.011605425571998538
Bond Position:  [-1.24822457]


portfolio before change:  [-0.03384729]
curr_Stock_Price:  104.66564685839022
curr_Factors:  [104.66564686  -0.92723672  -1.00949164]
mat_Sqrt:  [[15.09015561  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0062851   0.00321331  0.01353232]
Stock Position:  -0.006285095041011302
Bond Position:  [0.62398625]


portfolio before change:  [-0.03208717]
curr_Stock_Price:  104.41042357557713
curr_Factors:  [104.41042358  -1.0787429   -1.03540664]
mat_Sqrt:  [[12.60608935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430287  0.05243504 -0.01636493]
Stock Position:  -0.004302870494206098
Bond Position:  [0.41717736]


portfolio before change:  [-0.03734105]
curr_Stock_Price:  105.6556819450228
curr_Factors:  [105.65568195  -1.22600536  -1.03514635]
mat_Sqrt:  [[11.01253111  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00748818  0.01091855  0.24482838]
Stock Position:  -0.007488184942440865
Bond Position:  [0.75382824]


portfolio before change:  [-0.03668705]
curr_Stock_Price:  105.59351531069792
curr_Factors:  [105.59351531  -1.34266298  -1.0100232 ]
mat_Sqrt:  [[10.04335052  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01362001 -0.0435951   0.77770034]
Stock Position:  -0.013620011691883137
Bond Position:  [1.40149786]


portfolio before change:  [-0.04094305]
curr_Stock_Price:  105.93172496511619
curr_Factors:  [105.93172497  -0.97911268  -1.00431582]
mat_Sqrt:  [[14.57585343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00133197 0.00826952 0.02223318]
Stock Position:  0.0013319710116339294
Bond Position:  [-0.18204104]


portfolio before change:  [-0.04289767]
curr_Stock_Price:  104.49843084278972
curr_Factors:  [104.49843084  -0.94030678  -1.02760702]
mat_Sqrt:  [[14.60345656  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00553914  0.01496213  0.2288442 ]
Stock Position:  -0.005539138358999436
Bond Position:  [0.53593359]


portfolio before change:  [-0.03678654]
curr_Stock_Price:  103.41935774574833
curr_Factors:  [103.41935775  -1.08395063  -1.04086934]
mat_Sqrt:  [[12.35390475  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031223  -0.01002378  0.06108762]
Stock Position:  -0.003122301419326299
Bond Position:  [0.28611987]


portfolio before change:  [-0.0405923]
curr_Stock_Price:  104.66116538781118
curr_Factors:  [104.66116539  -1.04694642  -1.05490537]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.0405923]
Stock Price:  104.3159037908893
PL:  [-4.35649609]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.96114023e-01 -2.22561519e-02  4.84475333e-02]
 [-3.36585024e-02  9.61189788e-02  7.08641425e-02]
 [ 7.33185870e-04 -7.14507314e-02  3.42665254e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.51607397e-01 -2.97403450e-01 -2.68355066e-01]
 [-4.83540357e-02 -5.06327275e-02 -9.74352501e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-1.37599336e-01 -4.84464645e-02 -5.13076136e-02]
 [-4.06519049e-03  1.73570728e-02 -9.06666604e-02]
 [-4.11902671e-01  4.00869654e-01  6.17657558e-02]
 [ 9.75455757e-02 -1.39720740e-01 -1.47638507e-03]
 [-2.99660636e-02  4.60965734e-02  3.37420357e-02]
 [-3.16257349e-02  1.86430122e-01  3.24323254e-02]
 [-5.45055225e-02 -9.66719719e-02 -2.35447168e-02]
 [-1.46243333e-01 -1.03770045e-01  2.12170143e-01]
 [ 1.95862101e-02  1.04300227e-01  1.51611883e-01]
 [-9.32101045e-02  7.92495180e-02  4.77563703e-02]
 [-5.00017997e-02 -5.77464063e-02  2.39540089e-02]
 [-2.71687029e-02  5.29570354e-01  2.34045624e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.63725222]
curr_Stock_Price:  101.3039937099876
curr_Factors:  [101.30399371  -1.02993057  -0.97494223]
mat_Sqrt:  [[13.64336111  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01369159 -0.00703801  0.13820733]
Stock Position:  -0.013691594125889285
Bond Position:  [13.02426539]


portfolio before change:  [11.65761662]
curr_Stock_Price:  100.05447347880403
curr_Factors:  [100.05447348  -0.9767187   -0.92366678]
mat_Sqrt:  [[14.95924189  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111714  0.03039549  0.20215567]
Stock Position:  -0.0011171447466047694
Bond Position:  [11.76939195]


portfolio before change:  [11.65946999]
curr_Stock_Price:  101.02958774271929
curr_Factors:  [101.02958774  -0.91367187  -0.91508161]
mat_Sqrt:  [[16.22673098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00036255 -0.02259471  0.09775286]
Stock Position:  0.0003625475226972013
Bond Position:  [11.62284196]


portfolio before change:  [11.66275445]
curr_Stock_Price:  102.07326951476638
curr_Factors:  [102.07326951  -1.28769088  -0.92761613]
mat_Sqrt:  [[11.13823605  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00340662 -0.00455813 -0.02970002]
Stock Position:  -0.003406621751912995
Bond Position:  [12.01047947]


portfolio before change:  [11.6645393]
curr_Stock_Price:  102.43085034343635
curr_Factors:  [102.43085034  -1.34415187  -0.96073317]
mat_Sqrt:  [[10.21955355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02829387 -0.09404723 -0.76554231]
Stock Position:  0.028293870426650547
Bond Position:  [8.76637409]


portfolio before change:  [11.67557789]
curr_Stock_Price:  102.74352303533205
curr_Factors:  [102.74352304  -1.34202682  -0.99884908]
mat_Sqrt:  [[ 9.8883759   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00703354 -0.01601147 -0.27795565]
Stock Position:  -0.007033536644017205
Bond Position:  [12.39822822]


portfolio before change:  [11.68577492]
curr_Stock_Price:  101.7344881966419
curr_Factors:  [101.7344882   -1.53880189  -0.96366876]
mat_Sqrt:  [[ 8.3302687   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00068021 -0.02845143  0.0120735 ]
Stock Position:  -0.0006802054160095236
Bond Position:  [11.75497527]


portfolio before change:  [11.68812374]
curr_Stock_Price:  102.60229232586296
curr_Factors:  [102.60229233  -1.70411284  -0.96731325]
mat_Sqrt:  [[ 7.09531132  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02104535 -0.01532012 -0.14636634]
Stock Position:  -0.021045354298564797
Bond Position:  [13.84742534]


portfolio before change:  [11.70115031]
curr_Stock_Price:  102.147832227179
curr_Factors:  [102.14783223  -1.51633467  -0.96769169]
mat_Sqrt:  [[ 8.51981601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0025968   0.00548879 -0.25864675]
Stock Position:  -0.002596803419887957
Bond Position:  [11.96640815]


portfolio before change:  [11.70318699]
curr_Stock_Price:  102.51570258657334
curr_Factors:  [102.51570259  -1.60776264  -0.94405609]
mat_Sqrt:  [[ 7.99005194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04867858  0.12676612  0.17620051]
Stock Position:  -0.04867857954704659
Bond Position:  [16.69350578]


portfolio before change:  [11.71106223]
curr_Stock_Price:  102.43966632291914
curr_Factors:  [102.43966632  -1.22813049  -0.93764325]
mat_Sqrt:  [[11.74585328  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00797189 -0.04418358 -0.00421172]
Stock Position:  0.007971888777093606
Bond Position:  [10.8944246]


portfolio before change:  [11.71287822]
curr_Stock_Price:  102.32577163767691
curr_Factors:  [102.32577164  -0.87619049  -0.94158816]
mat_Sqrt:  [[16.61627966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131728  0.01457702  0.09625664]
Stock Position:  -0.0013172798867326662
Bond Position:  [11.8476699]


portfolio before change:  [11.71710574]
curr_Stock_Price:  101.36528288596998
curr_Factors:  [101.36528289  -0.32850896  -0.95767157]
mat_Sqrt:  [[28.00967889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072089  0.05895438  0.0925204 ]
Stock Position:  -0.000720890417798543
Bond Position:  [11.790179]


portfolio before change:  [11.72039494]
curr_Stock_Price:  100.8918631693135
curr_Factors:  [100.89186317  -0.32030276  -0.95339564]
mat_Sqrt:  [[28.22903005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218951 -0.03057036 -0.06716652]
Stock Position:  -0.002189505879386748
Bond Position:  [11.94129827]


portfolio before change:  [11.72712344]
curr_Stock_Price:  99.18243561840421
curr_Factors:  [99.18243562 -0.31093726 -0.95666517]
mat_Sqrt:  [[27.92042542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00378266 -0.03281497  0.60526236]
Stock Position:  -0.0037826649617756962
Bond Position:  [12.10229736]


portfolio before change:  [11.72986746]
curr_Stock_Price:  99.25696907158877
curr_Factors:  [99.25696907 -0.47000953 -0.91700371]
mat_Sqrt:  [[24.79641012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00214656 0.03298263 0.4325065 ]
Stock Position:  0.0021465557405760606
Bond Position:  [11.51680684]


portfolio before change:  [11.73236286]
curr_Stock_Price:  99.07800522177881
curr_Factors:  [99.07800522 -0.50015891 -0.91984799]
mat_Sqrt:  [[23.94837724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00339963  0.0250609   0.13623563]
Stock Position:  -0.00339963170140089
Bond Position:  [12.06919159]


portfolio before change:  [11.73456298]
curr_Stock_Price:  99.31849044438529
curr_Factors:  [99.31849044 -0.3473451  -0.88684987]
mat_Sqrt:  [[28.90853247  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00161209 -0.01826102  0.06833412]
Stock Position:  -0.0016120919978837214
Bond Position:  [11.89467352]


portfolio before change:  [11.7418387]
curr_Stock_Price:  96.65010506235257
curr_Factors:  [96.65010506 -0.42834566 -0.87208655]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.7418387]
Stock Price:  98.07203580978181
PL:  [11.7418387]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.59775779e-01 -2.84523614e-02  7.80575810e-02]
 [-1.75363567e-02  9.48600639e-02  1.04831220e-01]
 [-1.11946647e-02 -9.46014186e-02  3.46263016e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 5.63328078e-01 -3.91310232e-01 -2.54873127e-01]
 [-2.85454383e-02  3.05601750e-02 -4.19485279e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [-3.08960268e-03  1.57159563e-02 -9.81424865e-02]
 [-3.23956528e-01  3.22881346e-01  3.92732113e-02]
 [ 1.05873506e-01 -1.93637754e-01  6.32336108e-02]
 [-9.73696350e-02  9.45694238e-03  4.17519491e-03]
 [-7.45541390e-02  1.74157021e-01 -2.26755283e-02]
 [-1.23700686e-01 -1.69908885e-02  1.74958841e-01]
 [-1.22296385e-01 -1.05824126e-01  2.37322715e-01]
 [-1.80383166e-02 -9.64036829e-03 -8.37969832e-02]
 [-9.26397208e-02  5.18279212e-02  8.17012730e-02]
 [-2.58203925e-02  1.64303474e-02  1.98146051e-02]
 [ 5.34583981e-03  5.84760329e-01  4.33887183e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.34496832]
curr_Stock_Price:  100.56678476311139
curr_Factors:  [100.56678476  -1.11477393  -1.03279905]
mat_Sqrt:  [[11.74290295  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02082764 -0.00899743  0.22267655]
Stock Position:  -0.020827642051343576
Bond Position:  [8.43953732]


portfolio before change:  [6.34996673]
curr_Stock_Price:  100.42811055615498
curr_Factors:  [100.42811056  -1.24792719  -1.00039822]
mat_Sqrt:  [[10.60278541  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00059527 0.02999739 0.29905429]
Stock Position:  0.0005952683732066319
Bond Position:  [6.29018505]


portfolio before change:  [6.3521413]
curr_Stock_Price:  101.43913959014554
curr_Factors:  [101.43913959  -1.23317478  -0.99111866]
mat_Sqrt:  [[10.97001421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00059883 -0.0299156   0.0987792 ]
Stock Position:  -0.0005988322800339131
Bond Position:  [6.41288634]


portfolio before change:  [6.35397024]
curr_Stock_Price:  101.06254534932079
curr_Factors:  [101.06254535  -1.50676589  -1.01337196]
mat_Sqrt:  [[ 8.13033182  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00466694 -0.00455813 -0.02970002]
Stock Position:  -0.004666938329954493
Bond Position:  [6.82562291]


portfolio before change:  [6.35455403]
curr_Stock_Price:  101.30313775823417
curr_Factors:  [101.30313776  -1.68920025  -1.00687949]
mat_Sqrt:  [[ 6.83487135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07332965 -0.12374316 -0.72708209]
Stock Position:  0.07332965119522267
Bond Position:  [-1.07396972]


portfolio before change:  [6.32247004]
curr_Stock_Price:  100.8692687429849
curr_Factors:  [100.86926874  -1.41127895  -1.01941353]
mat_Sqrt:  [[ 8.87406374  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00409272  0.00966398 -0.11966747]
Stock Position:  -0.0040927230704163675
Bond Position:  [6.73530003]


portfolio before change:  [6.3230216]
curr_Stock_Price:  101.14597487850625
curr_Factors:  [101.14597488  -0.98357683  -0.98914525]
mat_Sqrt:  [[14.06715549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004028  -0.02845143  0.0120735 ]
Stock Position:  -0.000402803103346376
Bond Position:  [6.36376351]


portfolio before change:  [6.32426296]
curr_Stock_Price:  102.01433570302846
curr_Factors:  [102.0143357   -0.71576564  -0.97445631]
mat_Sqrt:  [[18.81945918  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00741707 -0.01496598 -0.14840805]
Stock Position:  -0.007417074679324517
Bond Position:  [7.0809109]


portfolio before change:  [6.32336599]
curr_Stock_Price:  102.37396730895682
curr_Factors:  [102.37396731  -0.60806522  -0.98336933]
mat_Sqrt:  [[20.84674657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108972  0.00496982 -0.2799732 ]
Stock Position:  -0.0010897177422887964
Bond Position:  [6.43492472]


portfolio before change:  [6.3224968]
curr_Stock_Price:  104.6480658178282
curr_Factors:  [104.64806582  -0.10983297  -0.95890757]
mat_Sqrt:  [[35.94041488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0085587   0.10210405  0.11203554]
Stock Position:  -0.008558697999448668
Bond Position:  [7.21814799]


portfolio before change:  [6.32749016]
curr_Stock_Price:  104.27550897045812
curr_Factors:  [104.27550897  -0.2601279   -0.98144966]
mat_Sqrt:  [[30.12812017  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00377658 -0.06123363  0.18038789]
Stock Position:  0.003776581717298388
Bond Position:  [5.93368518]


portfolio before change:  [6.3313305]
curr_Stock_Price:  104.89954744219519
curr_Factors:  [104.89954744  -0.31688654  -1.00656874]
mat_Sqrt:  [[27.92571409  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00344747  0.00299055  0.01191067]
Stock Position:  -0.0034474749479797523
Bond Position:  [6.69296906]


portfolio before change:  [6.33293353]
curr_Stock_Price:  104.91997456903644
curr_Factors:  [104.91997457  -0.46435458  -1.05354543]
mat_Sqrt:  [[22.9954852   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324786  0.05507329 -0.06468697]
Stock Position:  -0.0032478569683357743
Bond Position:  [6.6736986]


portfolio before change:  [6.3343078]
curr_Stock_Price:  105.01060861736491
curr_Factors:  [105.01060862  -0.53412159  -1.02925797]
mat_Sqrt:  [[21.99206753  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00402082 -0.00537299  0.49910887]
Stock Position:  -0.004020816345165726
Bond Position:  [6.75653617]


portfolio before change:  [6.33300721]
curr_Stock_Price:  105.7542214291075
curr_Factors:  [105.75422143  -0.56448038  -1.02280904]
mat_Sqrt:  [[21.62452983  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0035416  -0.03346453  0.67701565]
Stock Position:  -0.003541600965500182
Bond Position:  [6.70754647]


portfolio before change:  [6.32981736]
curr_Stock_Price:  107.12844372541674
curr_Factors:  [107.12844373  -0.62548177  -0.98239645]
mat_Sqrt:  [[21.45913227  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164928 -0.00304855 -0.23904947]
Stock Position:  -0.001649284646792653
Bond Position:  [6.50650266]


portfolio before change:  [6.33090679]
curr_Stock_Price:  107.45428381758707
curr_Factors:  [107.45428382  -0.83916542  -0.99015955]
mat_Sqrt:  [[17.24876441  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00432636  0.01638943  0.23307099]
Stock Position:  -0.004326357838481483
Bond Position:  [6.79579247]


portfolio before change:  [6.32198334]
curr_Stock_Price:  109.90960826192605
curr_Factors:  [109.90960826  -0.62253097  -1.00193048]
mat_Sqrt:  [[21.65414377  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098602  0.00519573  0.05652555]
Stock Position:  -0.0009860248287588019
Bond Position:  [6.43035694]


portfolio before change:  [6.32480172]
curr_Stock_Price:  108.68185590727612
curr_Factors:  [108.68185591  -0.62657583  -1.04527683]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.32480172]
Stock Price:  107.78625289316949
PL:  [-1.46145117]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.09171087e-01 -3.32997259e-02  1.01139177e-01]
 [-1.74563765e-01  1.61961213e-01  1.45627713e-02]
 [-8.78823985e-02 -4.15653823e-01  9.39405029e-03]
 [-2.27505107e-02  4.28292162e-02  2.71646523e-02]
 [ 4.72701883e-01 -3.04834443e-01 -1.62168951e-01]
 [ 6.76079164e-02  1.57852323e-02 -7.51004981e-03]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-5.21589892e-02 -3.85217252e-02 -2.63637897e-02]
 [-1.31376668e-01  1.37888612e-02  1.46812516e-01]
 [-5.07392013e-02  8.13666040e-02 -1.93827184e-02]
 [-1.83702353e-02 -7.12582462e-02  2.16165281e-03]
 [ 1.10073877e-01  1.01528000e-01 -4.24184776e-02]
 [ 1.77049427e-02  1.61927356e-01  8.07864246e-02]
 [ 2.19858300e-02 -1.12964062e-01 -9.68581997e-03]
 [-1.28732395e-01 -9.07578760e-02  1.90100767e-01]
 [-7.26746313e-03  1.49692854e-01  2.12542744e-01]
 [-6.12332393e-02  1.23274608e-01  3.23945114e-02]
 [-8.58007768e-03 -1.56020798e-03  6.48302186e-02]
 [-2.96943779e-02  5.08020761e-01  2.16902366e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.82922137]
curr_Stock_Price:  99.79844767495746
curr_Factors:  [99.79844767 -0.85819337 -0.98075765]
mat_Sqrt:  [[15.8663673   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01823895 -0.0105303   0.28852192]
Stock Position:  -0.018238953411247018
Bond Position:  [2.64944061]


portfolio before change:  [0.83979599]
curr_Stock_Price:  99.25498613719498
curr_Factors:  [99.25498614 -0.78760849 -1.0170143 ]
mat_Sqrt:  [[16.33106903  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01025097  0.05121663  0.04154353]
Stock Position:  -0.010250971979926868
Bond Position:  [1.85725607]


portfolio before change:  [0.83966317]
curr_Stock_Price:  99.3132432249485
curr_Factors:  [99.31324322 -1.18805681 -1.06066111]
mat_Sqrt:  [[10.48096764  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00922596 -0.13144128  0.02679861]
Stock Position:  -0.009225959364023163
Bond Position:  [1.75592311]


portfolio before change:  [0.84673216]
curr_Stock_Price:  98.59462339876173
curr_Factors:  [98.5946234  -0.88696018 -1.01417585]
mat_Sqrt:  [[14.72991857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109299  0.01354379  0.07749319]
Stock Position:  -0.0010929933933395556
Bond Position:  [0.95449543]


portfolio before change:  [0.84628818]
curr_Stock_Price:  99.21917788021835
curr_Factors:  [99.21917788 -0.8934062  -1.00732797]
mat_Sqrt:  [[14.82918429  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02911344 -0.09639711 -0.46262288]
Stock Position:  0.029113435001318754
Bond Position:  [-2.04232291]


portfolio before change:  [0.87291734]
curr_Stock_Price:  100.15138694168374
curr_Factors:  [100.15138694  -0.71354361  -1.00653664]
mat_Sqrt:  [[17.93228386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00370742  0.00499173 -0.02142408]
Stock Position:  0.0037074199458533037
Bond Position:  [0.50161409]


portfolio before change:  [0.87461529]
curr_Stock_Price:  100.57554412263858
curr_Factors:  [100.57554412  -0.91375609  -0.99327659]
mat_Sqrt:  [[14.93752411  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037933 -0.02845143  0.0120735 ]
Stock Position:  -0.00037933286976038537
Bond Position:  [0.9127669]


portfolio before change:  [0.87474705]
curr_Stock_Price:  100.82982856134032
curr_Factors:  [100.82982856  -0.78830902  -0.92874534]
mat_Sqrt:  [[18.1084716   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00323247 -0.01218164 -0.07520855]
Stock Position:  -0.00323247059480998
Bond Position:  [1.20067651]


portfolio before change:  [0.88428362]
curr_Stock_Price:  97.97245927105503
curr_Factors:  [97.97245927 -0.71304954 -0.84881099]
mat_Sqrt:  [[20.5492794   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00491758  0.00436042  0.41881524]
Stock Position:  -0.0049175769131197065
Bond Position:  [1.36607072]


portfolio before change:  [0.88455701]
curr_Stock_Price:  97.98632268260266
curr_Factors:  [97.98632268 -0.73308809 -0.84409588]
mat_Sqrt:  [[20.23965776  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0025986   0.02573038 -0.0552935 ]
Stock Position:  -0.0025986015198622347
Bond Position:  [1.13918441]


portfolio before change:  [0.88612337]
curr_Stock_Price:  97.49316115142797
curr_Factors:  [97.49316115 -0.83141003 -0.88551822]
mat_Sqrt:  [[17.51143306  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00112891 -0.02253384  0.00616659]
Stock Position:  -0.0011289121642961118
Bond Position:  [0.99618458]


portfolio before change:  [0.88687711]
curr_Stock_Price:  97.0461212609036
curr_Factors:  [97.04612126 -0.5934136  -0.86563247]
mat_Sqrt:  [[22.55913944  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00461173  0.03210597 -0.12100811]
Stock Position:  0.004611731006546557
Bond Position:  [0.43932651]


portfolio before change:  [0.89085539]
curr_Stock_Price:  97.88494479459831
curr_Factors:  [97.88494479 -0.82528979 -0.8854465 ]
mat_Sqrt:  [[17.69100758  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00216926 0.05120593 0.23046118]
Stock Position:  0.0021692573881260608
Bond Position:  [0.67851775]


portfolio before change:  [0.89128711]
curr_Stock_Price:  98.00575640073201
curr_Factors:  [98.0057564  -0.92116763 -0.91164569]
mat_Sqrt:  [[15.67728573  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00109024 -0.03572237 -0.02763095]
Stock Position:  0.001090239790427881
Bond Position:  [0.78443734]


portfolio before change:  [0.89178242]
curr_Stock_Price:  98.280164806258
curr_Factors:  [98.28016481 -0.59551503 -0.90308143]
mat_Sqrt:  [[21.96006914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00420179 -0.02870016  0.54230458]
Stock Position:  -0.004201789900829447
Bond Position:  [1.30473502]


portfolio before change:  [0.89395683]
curr_Stock_Price:  97.84030775363286
curr_Factors:  [97.84030775 -0.65278843 -0.90745126]
mat_Sqrt:  [[20.55485052  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00194517 0.04733704 0.60632529]
Stock Position:  0.001945170829248646
Bond Position:  [0.70364071]


portfolio before change:  [0.89315851]
curr_Stock_Price:  97.33945259906537
curr_Factors:  [97.3394526  -0.47330016 -0.90995525]
mat_Sqrt:  [[24.4089281   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00210734  0.03898285  0.09241252]
Stock Position:  -0.0021073354970622695
Bond Position:  [1.09828539]


portfolio before change:  [0.89455899]
curr_Stock_Price:  96.80518719214123
curr_Factors:  [96.80518719 -0.25699427 -0.90953982]
mat_Sqrt:  [[30.14944398  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.53006168e-04 -4.93381084e-04  1.84942568e-01]
Stock Position:  0.00015300616760108833
Bond Position:  [0.8797472]


portfolio before change:  [0.89478994]
curr_Stock_Price:  96.8769553230252
curr_Factors:  [96.87695532 -0.59546358 -0.92661367]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.89478994]
Stock Price:  100.18531490705337
PL:  [0.70947503]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.02712914e-01 -4.15377598e-02  1.22046323e-01]
 [-1.97017221e-01  1.89266462e-01  7.93460083e-02]
 [-8.65093039e-02 -3.85637471e-01  3.24208245e-03]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 4.72788039e-01 -3.34931271e-01 -2.24881924e-01]
 [ 1.02859679e-03  8.07388994e-03 -4.55756249e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-5.67667653e-02 -3.90509068e-02 -2.68352156e-02]
 [-2.91052446e-03  3.20870677e-02 -4.12083546e-02]
 [-1.47013228e-01  1.33802454e-01 -1.03106649e-02]
 [ 9.47707001e-02 -1.38111792e-01 -1.15468199e-03]
 [ 9.40223200e-03  7.47995111e-02  4.52788593e-02]
 [-2.59220873e-02  1.75668498e-01  3.49481563e-02]
 [-5.42858601e-02 -9.80195120e-02 -2.41002950e-02]
 [-1.52305108e-01 -1.08274477e-01  2.19809916e-01]
 [ 2.71213087e-02  1.08686915e-01  1.67229581e-01]
 [-9.60526568e-02  7.35398786e-02  5.13008352e-02]
 [-4.71946876e-02 -4.69358292e-02  2.20840850e-02]
 [-2.99315133e-02  4.99625126e-01  2.37712317e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.14758635]
curr_Stock_Price:  99.7034967147412
curr_Factors:  [99.70349671 -0.9897851  -0.97574051]
mat_Sqrt:  [[13.96668899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.019967   -0.01313539  0.34816419]
Stock Position:  -0.01996699524485267
Bond Position:  [2.13836559]


portfolio before change:  [0.16422604]
curr_Stock_Price:  98.89691414581617
curr_Factors:  [98.89691415 -1.07594623 -0.98043776]
mat_Sqrt:  [[12.65046583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01390731  0.05985131  0.22635208]
Stock Position:  -0.013907309648288152
Bond Position:  [1.53961605]


portfolio before change:  [0.1598974]
curr_Stock_Price:  99.23584344849866
curr_Factors:  [99.23584345 -1.0700347  -1.0181665 ]
mat_Sqrt:  [[12.29629594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00779134 -0.12194928  0.00924876]
Stock Position:  -0.007791340881721123
Bond Position:  [0.93307768]


portfolio before change:  [0.15054979]
curr_Stock_Price:  100.46552929766614
curr_Factors:  [100.4655293   -1.02863222  -1.02725162]
mat_Sqrt:  [[12.85754551  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295109 -0.00455813 -0.02970002]
Stock Position:  -0.002951088695105054
Bond Position:  [0.44703248]


portfolio before change:  [0.14870065]
curr_Stock_Price:  101.13000191636618
curr_Factors:  [101.13000192  -1.2715351   -0.99881222]
mat_Sqrt:  [[10.44433274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04004433 -0.10591457 -0.64152553]
Stock Position:  0.04004433131050866
Bond Position:  [-3.90098266]


portfolio before change:  [0.1479053]
curr_Stock_Price:  101.13449747726176
curr_Factors:  [101.13449748  -1.01563066  -0.98682883]
mat_Sqrt:  [[13.653444    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00059077  0.00255319 -0.13001457]
Stock Position:  -0.000590768288033436
Bond Position:  [0.20765235]


portfolio before change:  [0.14741639]
curr_Stock_Price:  102.04996250085473
curr_Factors:  [102.0499625   -1.01019711  -1.02274457]
mat_Sqrt:  [[13.36341617  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042402 -0.02845143  0.0120735 ]
Stock Position:  -0.00042401537268970605
Bond Position:  [0.19068715]


portfolio before change:  [0.14783963]
curr_Stock_Price:  101.1642511749357
curr_Factors:  [101.16425117  -1.13867344  -1.03664975]
mat_Sqrt:  [[11.48936998  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00550533 -0.01234898 -0.0765534 ]
Stock Position:  -0.005505329785925986
Bond Position:  [0.70478219]


portfolio before change:  [0.14802451]
curr_Stock_Price:  101.16267630058364
curr_Factors:  [101.1626763   -0.95597488  -1.03534667]
mat_Sqrt:  [[13.8102121   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00075985  0.01014682 -0.11755597]
Stock Position:  -0.000759847858679989
Bond Position:  [0.22489276]


portfolio before change:  [0.14907179]
curr_Stock_Price:  99.85840693720999
curr_Factors:  [99.85840694 -0.45902487 -1.03026441]
mat_Sqrt:  [[22.52135513  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00646778  0.04231205 -0.02941346]
Stock Position:  -0.006467777744390322
Bond Position:  [0.79493377]


portfolio before change:  [0.14208795]
curr_Stock_Price:  100.96892698100928
curr_Factors:  [100.96892698  -0.65890785  -1.01490361]
mat_Sqrt:  [[18.93479726  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00480433 -0.04367478 -0.00329399]
Stock Position:  0.004804327675295471
Bond Position:  [-0.34299986]


portfolio before change:  [0.14269095]
curr_Stock_Price:  101.11228852985771
curr_Factors:  [101.11228853  -0.81523577  -1.07170392]
mat_Sqrt:  [[15.32203469  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00134291 0.02365368 0.12916798]
Stock Position:  0.0013429062091695387
Bond Position:  [0.00690663]


portfolio before change:  [0.14258633]
curr_Stock_Price:  101.03309846012702
curr_Factors:  [101.03309846  -0.63896411  -1.04565343]
mat_Sqrt:  [[18.74319279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00076041  0.05555126  0.09969736]
Stock Position:  -0.0007604138654319934
Bond Position:  [0.2194133]


portfolio before change:  [0.1423216]
curr_Stock_Price:  101.45338635506761
curr_Factors:  [101.45338636  -0.75578836  -1.00063032]
mat_Sqrt:  [[17.51715638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00352433 -0.03099649 -0.06875143]
Stock Position:  -0.0035243257401986333
Bond Position:  [0.49987638]


portfolio before change:  [0.14405508]
curr_Stock_Price:  100.99698669949662
curr_Factors:  [100.9969867   -0.94470006  -1.0015966 ]
mat_Sqrt:  [[14.42256534  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00764304 -0.0342394   0.62705651]
Stock Position:  -0.007643039137901635
Bond Position:  [0.915979]


portfolio before change:  [0.15062825]
curr_Stock_Price:  100.16693203971548
curr_Factors:  [100.16693204  -0.92890884  -0.98516046]
mat_Sqrt:  [[14.77252174  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00433665 0.03436982 0.47705945]
Stock Position:  0.0043366453696291095
Bond Position:  [-0.28376022]


portfolio before change:  [0.15284643]
curr_Stock_Price:  100.69478905966423
curr_Factors:  [100.69478906  -1.06775998  -0.99678018]
mat_Sqrt:  [[12.77581454  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00655004  0.02325535  0.146347  ]
Stock Position:  -0.006550042335583425
Bond Position:  [0.81240156]


portfolio before change:  [0.14898136]
curr_Stock_Price:  101.31588230800554
curr_Factors:  [101.31588231  -1.20440159  -1.00391523]
mat_Sqrt:  [[11.1331413   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00394306 -0.01484241  0.06299975]
Stock Position:  -0.0039430623660885915
Bond Position:  [0.54847621]


portfolio before change:  [0.15128342]
curr_Stock_Price:  100.76683624283297
curr_Factors:  [100.76683624  -1.03118802  -0.98184121]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.15128342]
Stock Price:  100.41926080947714
PL:  [-0.26797739]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.45107679e-01 -2.70247127e-02  7.12352250e-02]
 [ 5.11184635e-02 -1.37468069e-02 -1.25054603e-02]
 [-1.90268215e-02 -2.01172377e-01  2.65943498e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 4.10496542e-01 -3.44186873e-01 -3.07122520e-01]
 [-9.68577222e-02 -8.30717359e-02 -1.33195333e-01]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [-4.46846947e-02 -2.28486431e-02 -1.38653860e-01]
 [-5.36924246e-01  5.24670342e-01  7.77124288e-02]
 [ 1.00828335e-01 -1.41681611e-01 -1.40711939e-03]
 [-1.00365525e-01  6.82343259e-03  3.52907759e-05]
 [-5.59958056e-02  1.72162661e-01 -1.68307958e-03]
 [-8.62976302e-02 -3.99736308e-02  6.59788500e-02]
 [-1.42125546e-01 -1.13966649e-01  2.43936148e-01]
 [ 2.85780507e-02  3.12606117e-02  4.55513643e-02]
 [-9.32393909e-02  5.07551948e-02  8.22891404e-02]
 [-3.05762881e-02  2.49794690e-03  2.02141494e-02]
 [-5.30716278e-03  5.48998435e-01  3.69697703e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.39474193]
curr_Stock_Price:  100.71301699691875
curr_Factors:  [100.713017    -1.05261681  -1.01124257]
mat_Sqrt:  [[12.78682925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01808616 -0.00854596  0.20321427]
Stock Position:  -0.01808615879778859
Bond Position:  [9.21625355]


portfolio before change:  [7.35404206]
curr_Stock_Price:  103.09075900637119
curr_Factors:  [103.09075901  -1.20365625  -0.9868581 ]
mat_Sqrt:  [[11.53164972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00418074 -0.00434712 -0.0356746 ]
Stock Position:  0.004180742323900345
Bond Position:  [6.92304616]


portfolio before change:  [7.35846672]
curr_Stock_Price:  103.73506494154499
curr_Factors:  [103.73506494  -1.49858897  -0.97856034]
mat_Sqrt:  [[ 8.71190852  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215711 -0.06361629  0.07586628]
Stock Position:  -0.002157107244142588
Bond Position:  [7.58223438]


portfolio before change:  [7.36049469]
curr_Stock_Price:  103.67379156183246
curr_Factors:  [103.67379156  -1.58767188  -0.99733466]
mat_Sqrt:  [[ 7.81654636  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00485429 -0.00455813 -0.02970002]
Stock Position:  -0.004854286723400666
Bond Position:  [7.863757]


portfolio before change:  [7.36063667]
curr_Stock_Price:  104.04958406403395
curr_Factors:  [104.04958406  -1.85193863  -1.01424122]
mat_Sqrt:  [[ 5.92207985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05722965 -0.10884145 -0.87613506]
Stock Position:  0.057229649413081826
Bond Position:  [1.40591545]


portfolio before change:  [7.34770681]
curr_Stock_Price:  103.81751239317151
curr_Factors:  [103.81751239  -1.65789066  -1.02091376]
mat_Sqrt:  [[ 7.12657138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01770711 -0.02626959 -0.37996921]
Stock Position:  -0.01770711354689688
Bond Position:  [9.18601529]


portfolio before change:  [7.36370325]
curr_Stock_Price:  103.0438315668249
curr_Factors:  [103.04383157  -1.31851825  -1.00939331]
mat_Sqrt:  [[10.04668652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.000564   -0.02845143  0.0120735 ]
Stock Position:  -0.000563996286379115
Bond Position:  [7.42181959]


portfolio before change:  [7.36520186]
curr_Stock_Price:  103.67696431851616
curr_Factors:  [103.67696432  -1.4553094   -1.00874638]
mat_Sqrt:  [[ 8.82178448  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0158228  -0.01496598 -0.14840805]
Stock Position:  -0.01582280030068185
Bond Position:  [9.00566176]


portfolio before change:  [7.36750305]
curr_Stock_Price:  103.67383618145301
curr_Factors:  [103.67383618  -1.94045627  -1.02622331]
mat_Sqrt:  [[ 5.33650104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01378754 -0.00722538 -0.39554087]
Stock Position:  -0.013787544374202276
Bond Position:  [8.79691067]


portfolio before change:  [7.36634534]
curr_Stock_Price:  103.9173324283898
curr_Factors:  [103.91733243  -1.9935632   -1.00853601]
mat_Sqrt:  [[ 5.16288997  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09830044  0.16591533  0.22169193]
Stock Position:  -0.09830043556592097
Bond Position:  [17.58146438]


portfolio before change:  [7.34352833]
curr_Stock_Price:  104.19416658739844
curr_Factors:  [104.19416659  -1.75974648  -1.00527268]
mat_Sqrt:  [[ 6.56161644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0147651  -0.04480366 -0.00401412]
Stock Position:  0.014765097252897574
Bond Position:  [5.80509133]


portfolio before change:  [7.3437141]
curr_Stock_Price:  104.10844463000838
curr_Factors:  [104.10844463  -1.52089293  -1.00433621]
mat_Sqrt:  [[ 8.33283682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01202257  0.00215776  0.00010067]
Stock Position:  -0.01202257325371749
Bond Position:  [8.5953655]


portfolio before change:  [7.34611145]
curr_Stock_Price:  104.0877965177814
curr_Factors:  [104.08779652  -0.86703395  -1.00533829]
mat_Sqrt:  [[16.00438109  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0032425   0.05444261 -0.00480136]
Stock Position:  -0.003242496018617195
Bond Position:  [7.68361571]


portfolio before change:  [7.34999094]
curr_Stock_Price:  103.48383408769675
curr_Factors:  [103.48383409  -0.90817319  -0.97531772]
mat_Sqrt:  [[15.73558157  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00469394 -0.01264077  0.18821929]
Stock Position:  -0.004693939544116892
Bond Position:  [7.8357378]


portfolio before change:  [7.34134726]
curr_Stock_Price:  105.7426731783144
curr_Factors:  [105.74267318  -0.98728965  -0.94324934]
mat_Sqrt:  [[15.34008809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00621084 -0.03603942  0.69588193]
Stock Position:  -0.006210844033791629
Bond Position:  [7.99809851]


portfolio before change:  [7.33939846]
curr_Stock_Price:  106.37842801385199
curr_Factors:  [106.37842801  -1.18320767  -0.9279905 ]
mat_Sqrt:  [[12.88166057  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00300298 0.00988547 0.12994536]
Stock Position:  0.0030029769317711607
Bond Position:  [7.0199465]


portfolio before change:  [7.34410945]
curr_Stock_Price:  107.36271240426285
curr_Factors:  [107.3627124   -1.25140292  -0.97929893]
mat_Sqrt:  [[11.53644423  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00651255  0.0160502   0.23474801]
Stock Position:  -0.006512552344755394
Bond Position:  [8.04331474]


portfolio before change:  [7.3399674]
curr_Stock_Price:  108.30752442365767
curr_Factors:  [108.30752442  -1.4266321   -1.01003412]
mat_Sqrt:  [[ 9.47170005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00278573  0.00078992  0.05766534]
Stock Position:  -0.0027857296182928746
Bond Position:  [7.64168287]


portfolio before change:  [7.34328908]
curr_Stock_Price:  107.80100665232884
curr_Factors:  [107.80100665  -1.08323087  -0.99469956]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.34328908]
Stock Price:  107.45888928747995
PL:  [-0.11560021]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.94657956e-01 -3.66675331e-02  1.07280323e-01]
 [ 1.32357272e-02  6.08460226e-02  3.09939762e-02]
 [ 1.29725898e-02 -3.35357019e-02  3.87981582e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 4.08175225e-01 -2.69909621e-01 -1.51415630e-01]
 [ 2.70256122e-02  4.25736996e-02 -3.22539346e-03]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-3.66570475e-03 -3.28460581e-02 -6.04752086e-03]
 [-3.03868320e-02  2.91784115e-02 -5.01926597e-03]
 [-3.27852581e-01  3.09929006e-01  1.84379421e-02]
 [ 6.14453924e-02 -1.18828022e-01  3.01540537e-03]
 [-2.88966783e-03  6.56737803e-02  4.18053523e-02]
 [-3.13957086e-02  1.62592570e-01  2.34573227e-02]
 [-5.54798076e-02 -1.14800055e-01 -1.94924178e-02]
 [-1.53532596e-01 -1.13022691e-01  2.32050972e-01]
 [ 4.19427609e-02  7.91857031e-02  1.33687983e-01]
 [-1.27928492e-01  1.99844405e-02  7.83445531e-02]
 [-4.67510302e-02 -4.51021403e-02  2.17095300e-02]
 [-3.01325898e-02  4.98858862e-01  2.29650972e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.47942834]
curr_Stock_Price:  99.74972191475314
curr_Factors:  [99.74972191 -0.80624922 -1.05975992]
mat_Sqrt:  [[15.43526965  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01773252 -0.01159529  0.3060409 ]
Stock Position:  -0.017732518443283964
Bond Position:  [2.24824212]


portfolio before change:  [0.46911567]
curr_Stock_Price:  100.36299082572414
curr_Factors:  [100.36299083  -0.86755758  -1.08651657]
mat_Sqrt:  [[14.22099469  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00148607 0.0192412  0.08841719]
Stock Position:  0.0014860692983453543
Bond Position:  [0.31996931]


portfolio before change:  [0.47016986]
curr_Stock_Price:  101.0185380567305
curr_Factors:  [101.01853806  -0.78213148  -1.13604501]
mat_Sqrt:  [[14.83705188  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00134975 -0.01060492  0.11068035]
Stock Position:  0.0013497521404386818
Bond Position:  [0.33381987]


portfolio before change:  [0.47115232]
curr_Stock_Price:  101.68458755840417
curr_Factors:  [101.68458756  -0.66777798  -1.13065559]
mat_Sqrt:  [[16.8346989   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0022539  -0.00455813 -0.02970002]
Stock Position:  -0.002253901743176732
Bond Position:  [0.70033939]


portfolio before change:  [0.4744136]
curr_Stock_Price:  100.3153312470062
curr_Factors:  [100.31533125  -0.842065    -1.11767614]
mat_Sqrt:  [[14.13391745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02619929 -0.08535292 -0.43194665]
Stock Position:  0.026199290025853486
Bond Position:  [-2.15377686]


portfolio before change:  [0.46539532]
curr_Stock_Price:  99.99166740833819
curr_Factors:  [99.99166741 -1.00779719 -1.15868095]
mat_Sqrt:  [[11.45708957  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00239733  0.01346299 -0.00920115]
Stock Position:  0.0023973348169841102
Bond Position:  [0.22568182]


portfolio before change:  [0.46457892]
curr_Stock_Price:  99.62758342156079
curr_Factors:  [99.62758342 -1.31340917 -1.1154754 ]
mat_Sqrt:  [[ 8.78068566  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064531 -0.02845143  0.0120735 ]
Stock Position:  -0.0006453133740094741
Bond Position:  [0.52886993]


portfolio before change:  [0.46415814]
curr_Stock_Price:  100.48456038912335
curr_Factors:  [100.48456039  -1.22124586  -1.10775232]
mat_Sqrt:  [[ 9.78651984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058736 -0.01038684 -0.01725189]
Stock Position:  -0.0005873621512795156
Bond Position:  [0.52317896]


portfolio before change:  [0.46399965]
curr_Stock_Price:  100.97709432412711
curr_Factors:  [100.97709432  -1.67141433  -1.10558825]
mat_Sqrt:  [[ 6.28327362  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0048793   0.00922702 -0.01431857]
Stock Position:  -0.004879303988382651
Bond Position:  [0.95669759]


portfolio before change:  [0.46387684]
curr_Stock_Price:  101.05128930280878
curr_Factors:  [101.0512893   -1.34096069  -1.11712387]
mat_Sqrt:  [[ 8.64986439  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03654238  0.09800816  0.05259832]
Stock Position:  -0.036542378572543846
Bond Position:  [4.15653131]


portfolio before change:  [0.45643708]
curr_Stock_Price:  101.28332179038775
curr_Factors:  [101.28332179  -1.42083529  -1.10172011]
mat_Sqrt:  [[ 8.12841834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0072576  -0.03757672  0.00860211]
Stock Position:  0.0072575968171470365
Bond Position:  [-0.27863643]


portfolio before change:  [0.45919017]
curr_Stock_Price:  101.67226055894935
curr_Factors:  [101.67226056  -1.21371334  -1.13770078]
mat_Sqrt:  [[ 9.68269612  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.000758   0.02076787 0.11925903]
Stock Position:  0.0007580020699441426
Bond Position:  [0.38212239]


portfolio before change:  [0.45967572]
curr_Stock_Price:  102.18677413846757
curr_Factors:  [102.18677414  -1.23295857  -1.10414236]
mat_Sqrt:  [[ 9.87198877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227     0.05141629  0.06691721]
Stock Position:  -0.002269996561782528
Bond Position:  [0.69163934]


portfolio before change:  [0.46083964]
curr_Stock_Price:  101.7502131458674
curr_Factors:  [101.75021315  -0.94972209  -1.09168944]
mat_Sqrt:  [[13.2117871   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00472478 -0.03630297 -0.05560644]
Stock Position:  -0.004724781356361043
Bond Position:  [0.94158715]


portfolio before change:  [0.45893845]
curr_Stock_Price:  102.20242914993561
curr_Factors:  [102.20242915  -0.92265875  -1.1431261 ]
mat_Sqrt:  [[12.95096878  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00842282 -0.03574091  0.66197683]
Stock Position:  -0.008422815694381865
Bond Position:  [1.31977067]


portfolio before change:  [0.4533944]
curr_Stock_Price:  102.89982435680098
curr_Factors:  [102.89982436  -1.48112929  -1.16454703]
mat_Sqrt:  [[ 7.30149866  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00976187 0.02504072 0.3813746 ]
Stock Position:  0.009761868835151722
Bond Position:  [-0.55110019]


portfolio before change:  [0.44818085]
curr_Stock_Price:  102.37986708104715
curr_Factors:  [102.37986708  -1.15387264  -1.15629592]
mat_Sqrt:  [[10.16064097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01096589  0.00631963  0.2234952 ]
Stock Position:  -0.010965890955846916
Bond Position:  [1.57086731]


portfolio before change:  [0.45755795]
curr_Stock_Price:  101.5605693041826
curr_Factors:  [101.5605693   -0.9911304   -1.10493173]
mat_Sqrt:  [[12.48581535  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00348268 -0.01426255  0.06193125]
Stock Position:  -0.0034826819021812686
Bond Position:  [0.8112611]


portfolio before change:  [0.46348909]
curr_Stock_Price:  99.91577435187669
curr_Factors:  [99.91577435 -0.87601465 -1.07976201]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.46348909]
Stock Price:  100.12844578799978
PL:  [0.3350433]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.20089722e-01 -6.77177635e-02  1.55640048e-01]
 [ 2.77503628e-02  6.41148562e-02  8.08856272e-02]
 [-1.90356795e-02 -1.72515827e-01  4.05363325e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 5.94861446e-01 -3.86006708e-01 -2.10867512e-01]
 [ 3.15570724e-02  2.28907100e-02 -2.64378399e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [-4.15777133e-02 -1.56485345e-02 -1.26622557e-01]
 [-3.41194931e-01  3.30486721e-01  2.33512342e-02]
 [ 1.09590558e-01 -1.74682195e-01  3.44176812e-02]
 [-1.37478171e-01 -1.23454921e-02 -1.34185715e-02]
 [-1.16446793e-01  1.39961297e-01 -8.50707452e-02]
 [-9.21046404e-02 -6.68022961e-02  8.47806908e-02]
 [-1.59351973e-01 -1.18945755e-01  2.43842171e-01]
 [-2.77163044e-02  9.54621472e-02  4.92631856e-02]
 [-1.24471442e-01  3.66706749e-02  6.22150789e-02]
 [-4.56807971e-02 -5.22915005e-02  2.81408825e-02]
 [-2.31590973e-02  5.56478019e-01  2.77296748e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.52384499]
curr_Stock_Price:  98.9134729730343
curr_Factors:  [98.91347297 -0.94274395 -0.98767978]
mat_Sqrt:  [[14.35103014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00627609 -0.02141424  0.44399773]
Stock Position:  -0.006276085744909423
Bond Position:  [-4.90305556]


portfolio before change:  [-5.53627906]
curr_Stock_Price:  100.69932374635663
curr_Factors:  [100.69932375  -1.18900211  -0.98533872]
mat_Sqrt:  [[11.44780786  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00401094 0.0202749  0.23074418]
Stock Position:  0.004010943522939913
Bond Position:  [-5.94017836]


portfolio before change:  [-5.54000524]
curr_Stock_Price:  100.1406167391439
curr_Factors:  [100.14061674  -0.76153458  -1.0166391 ]
mat_Sqrt:  [[16.91839835  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00089935 -0.05455429  0.11563887]
Stock Position:  -0.000899350783905645
Bond Position:  [-5.44994369]


portfolio before change:  [-5.54178712]
curr_Stock_Price:  100.60676218326412
curr_Factors:  [100.60676218  -1.30336036  -1.02126862]
mat_Sqrt:  [[ 9.84132627  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00385555 -0.00455813 -0.02970002]
Stock Position:  -0.0038555532205474443
Bond Position:  [-5.15389239]


portfolio before change:  [-5.54282859]
curr_Stock_Price:  100.54265649698287
curr_Factors:  [100.5426565   -1.44586668  -1.06470976]
mat_Sqrt:  [[ 8.16621602  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06635284 -0.12206604 -0.60154632]
Stock Position:  0.06635284248142263
Bond Position:  [-12.21411964]


portfolio before change:  [-5.54715141]
curr_Stock_Price:  100.52353282532091
curr_Factors:  [100.52353283  -1.10353865  -1.05842984]
mat_Sqrt:  [[11.57009045  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00231213  0.00723868 -0.0754198 ]
Stock Position:  0.0023121259633112796
Bond Position:  [-5.77957448]


portfolio before change:  [-5.54477641]
curr_Stock_Price:  102.17572510810727
curr_Factors:  [102.17572511  -1.10196356  -1.06415634]
mat_Sqrt:  [[11.71153471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048382 -0.02845143  0.0120735 ]
Stock Position:  -0.0004838216362468348
Bond Position:  [-5.49534158]


portfolio before change:  [-5.54628796]
curr_Stock_Price:  102.460009053513
curr_Factors:  [102.46000905  -1.1327266   -1.09663401]
mat_Sqrt:  [[11.02441068  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01266148 -0.01496598 -0.14840805]
Stock Position:  -0.01266147808440099
Bond Position:  [-4.2489928]


portfolio before change:  [-5.56232038]
curr_Stock_Price:  103.6423384716254
curr_Factors:  [103.64233847  -1.04414454  -1.10847558]
mat_Sqrt:  [[12.04109999  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00563308 -0.0049485  -0.36121891]
Stock Position:  -0.005633079859784172
Bond Position:  [-4.97849481]


portfolio before change:  [-5.56050433]
curr_Stock_Price:  103.09897208218467
curr_Factors:  [103.09897208  -0.69770035  -1.0945047 ]
mat_Sqrt:  [[17.1755072   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01909086  0.10450908  0.06661457]
Stock Position:  -0.019090862692015848
Bond Position:  [-3.59225601]


portfolio before change:  [-5.58403891]
curr_Stock_Price:  104.2846912341847
curr_Factors:  [104.28469123  -0.81954601  -1.08959351]
mat_Sqrt:  [[15.45581105  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00725331 -0.05523936  0.09818406]
Stock Position:  0.007253308310104297
Bond Position:  [-6.34044793]


portfolio before change:  [-5.57103982]
curr_Stock_Price:  106.29541471870888
curr_Factors:  [106.29541472  -0.75255336  -1.08657816]
mat_Sqrt:  [[16.89623173  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00831759 -0.00390399 -0.03827945]
Stock Position:  -0.008317593336622752
Bond Position:  [-4.68691779]


portfolio before change:  [-5.57349881]
curr_Stock_Price:  106.45015990519568
curr_Factors:  [106.45015991  -0.47382483  -1.11681788]
mat_Sqrt:  [[21.69396649  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00600158  0.04425965 -0.24268316]
Stock Position:  -0.006001576572115468
Bond Position:  [-4.93463002]


portfolio before change:  [-5.55288093]
curr_Stock_Price:  102.80916855284441
curr_Factors:  [102.80916855  -0.31306595  -1.09250175]
mat_Sqrt:  [[25.21166634  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303525 -0.02112474  0.24185571]
Stock Position:  -0.003035248887089008
Bond Position:  [-5.24082952]


portfolio before change:  [-5.5523179]
curr_Stock_Price:  102.1919535773586
curr_Factors:  [102.19195358  -0.26730957  -1.10239595]
mat_Sqrt:  [[25.97533475  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00433677 -0.03761395  0.69561384]
Stock Position:  -0.0043367704762075215
Bond Position:  [-5.10913485]


portfolio before change:  [-5.54901658]
curr_Stock_Price:  101.136152720952
curr_Factors:  [ 1.01136153e+02 -9.20124794e-02 -1.13118241e+00]
mat_Sqrt:  [[29.76320109  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051055  0.03018778  0.14053416]
Stock Position:  -0.0005105525004522973
Bond Position:  [-5.49738126]


portfolio before change:  [-5.54948134]
curr_Stock_Price:  99.35425412287604
curr_Factors:  [99.35425412 -0.393353   -1.12250951]
mat_Sqrt:  [[21.82004996  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00507904  0.01159629  0.1774823 ]
Stock Position:  -0.005079044725707577
Bond Position:  [-5.04485664]


portfolio before change:  [-5.54905657]
curr_Stock_Price:  99.0222728564053
curr_Factors:  [99.02227286 -0.18352819 -1.12178978]
mat_Sqrt:  [[26.84358379  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00153805 -0.01653602  0.0802781 ]
Stock Position:  -0.0015380481442867616
Bond Position:  [-5.39675554]


portfolio before change:  [-5.55172686]
curr_Stock_Price:  99.8811132320555
curr_Factors:  [99.88111323 -0.33967653 -1.13372623]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.55172686]
Stock Price:  100.12439559001137
PL:  [-5.67612245]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.49666612e-01 -5.10739116e-02  1.37013492e-01]
 [-3.51909702e-01  2.70739443e-01  5.73522002e-02]
 [-2.52525926e-01 -6.18913603e-01 -1.19626514e-01]
 [-2.07741290e-02 -8.98995949e-03 -1.79732395e-02]
 [-1.28344088e-01  6.49572473e-02 -4.35409514e-02]
 [-7.99651983e-02  6.58880562e-02  2.94695903e-02]
 [-2.34382226e-02 -6.42764578e-02 -1.88898957e-03]
 [-7.87875026e-02 -4.16406777e-02 -3.78579531e-02]
 [-6.02156134e-02  2.60379999e-02  3.19439976e-02]
 [-2.15202544e-01  2.03239385e-01  3.23516135e-03]
 [ 8.69239514e-02 -1.33567011e-01 -2.06013702e-04]
 [ 8.26791417e-02  1.04690993e-01 -4.41088442e-03]
 [-7.36175900e-03  1.75542573e-01  5.66675696e-02]
 [-5.13145939e-02 -4.32210426e-02 -3.67898594e-02]
 [-1.52867571e-01 -1.17903779e-01  2.46197700e-01]
 [-3.71979563e-02  4.21846071e-02 -3.34230125e-02]
 [-1.33109738e-01  1.20682492e-02  8.17832478e-02]
 [-3.77776810e-02 -1.86069202e-02  2.08244338e-02]
 [ 2.03547659e-03  6.16882357e-01  4.24106479e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.20533276]
curr_Stock_Price:  99.5150366672836
curr_Factors:  [99.51503667 -0.95284415 -0.9943406 ]
mat_Sqrt:  [[14.19832509  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01570732 -0.01615099  0.39086136]
Stock Position:  -0.015707315601442756
Bond Position:  [0.35778132]


portfolio before change:  [-1.18746963]
curr_Stock_Price:  98.38348258094274
curr_Factors:  [98.38348258 -0.82231218 -0.99523608]
mat_Sqrt:  [[15.97978799  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02085211  0.08561533  0.16360986]
Stock Position:  -0.020852108357135107
Bond Position:  [0.86403341]


portfolio before change:  [-1.15614724]
curr_Stock_Price:  96.8917217467373
curr_Factors:  [96.89172175 -0.53146097 -1.00900158]
mat_Sqrt:  [[20.76214845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0141086  -0.19571767 -0.34126115]
Stock Position:  -0.014108600915155717
Bond Position:  [0.2108594]


portfolio before change:  [-1.14538454]
curr_Stock_Price:  96.13261182271356
curr_Factors:  [96.13261182 -0.11500161 -1.00399298]
mat_Sqrt:  [[31.39768041  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078589 -0.00284287 -0.05127265]
Stock Position:  -0.00078588674668416
Bond Position:  [-1.06983519]


portfolio before change:  [-1.14590197]
curr_Stock_Price:  96.45065605541885
curr_Factors:  [96.45065606 -0.18737074 -1.03056267]
mat_Sqrt:  [[28.53405048  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00475063  0.02054129 -0.12421021]
Stock Position:  -0.004750627973503043
Bond Position:  [-0.68770079]


portfolio before change:  [-1.15961093]
curr_Stock_Price:  99.30017684355788
curr_Factors:  [99.30017684 -0.23211303 -1.05421192]
mat_Sqrt:  [[27.43507778  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263344  0.02083563  0.08406854]
Stock Position:  -0.0026334359829088224
Bond Position:  [-0.89811028]


portfolio before change:  [-1.16150524]
curr_Stock_Price:  99.93423480846286
curr_Factors:  [99.93423481 -0.36312401 -1.06615666]
mat_Sqrt:  [[23.93236311  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106481 -0.020326   -0.00538876]
Stock Position:  -0.0010648101003232003
Bond Position:  [-1.05509426]


portfolio before change:  [-1.16261201]
curr_Stock_Price:  100.72588757979804
curr_Factors:  [100.72588758  -0.47968907  -1.06822937]
mat_Sqrt:  [[21.42341331  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00408854 -0.01316794 -0.1079982 ]
Stock Position:  -0.004088535349565011
Bond Position:  [-0.75079066]


portfolio before change:  [-1.15745633]
curr_Stock_Price:  99.41896440291109
curr_Factors:  [99.4189644  -0.42300807 -1.06729063]
mat_Sqrt:  [[22.39962439  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236713  0.00823394  0.09112733]
Stock Position:  -0.002367127816938048
Bond Position:  [-0.92211893]


portfolio before change:  [-1.16188646]
curr_Stock_Price:  101.19308831062612
curr_Factors:  [101.19308831  -0.46699992  -1.05827475]
mat_Sqrt:  [[22.01569893  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0095066   0.06426994  0.00922901]
Stock Position:  -0.009506604884606662
Bond Position:  [-0.19988376]


portfolio before change:  [-1.14996433]
curr_Stock_Price:  99.93374142938343
curr_Factors:  [99.93374143 -0.38031861 -1.05018934]
mat_Sqrt:  [[23.90289133  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00349051 -0.0422376  -0.0005877 ]
Stock Position:  0.003490507173621802
Bond Position:  [-1.49878377]


portfolio before change:  [-1.15461104]
curr_Stock_Price:  98.70985933008808
curr_Factors:  [98.70985933 -0.34304146 -1.03612546]
mat_Sqrt:  [[24.85398011  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00339913  0.0331062  -0.01258303]
Stock Position:  0.003399128955088266
Bond Position:  [-1.49013858]


portfolio before change:  [-1.15311794]
curr_Stock_Price:  99.2587281780387
curr_Factors:  [99.25872818 -0.49746432 -1.0297878 ]
mat_Sqrt:  [[21.55219648  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00040543 0.05551144 0.1616568 ]
Stock Position:  0.00040543199227066466
Bond Position:  [-1.19336061]


portfolio before change:  [-1.15358339]
curr_Stock_Price:  98.84665064423162
curr_Factors:  [ 9.88466506e+01 -6.01953860e-02 -1.06088093e+00]
mat_Sqrt:  [[32.21697066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00186052 -0.01366769 -0.10495123]
Stock Position:  -0.0018605180384269721
Bond Position:  [-0.96967742]


portfolio before change:  [-1.16157057]
curr_Stock_Price:  103.00932613529484
curr_Factors:  [103.00932614  -0.15318829  -1.08525743]
mat_Sqrt:  [[29.85564135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00353893 -0.03728445  0.70233351]
Stock Position:  -0.003538927109622502
Bond Position:  [-0.79702808]


portfolio before change:  [-1.1661]
curr_Stock_Price:  104.23290161969157
curr_Factors:  [104.23290162  -0.17587882  -1.07455689]
mat_Sqrt:  [[29.85021755  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00143822  0.01333994 -0.09534655]
Stock Position:  -0.001438220618048421
Bond Position:  [-1.01619009]


portfolio before change:  [-1.16554228]
curr_Stock_Price:  103.66845140607266
curr_Factors:  [103.66845141  -0.28782892  -1.07200772]
mat_Sqrt:  [[26.61197237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00436286  0.00381632  0.23330484]
Stock Position:  -0.004362855924406803
Bond Position:  [-0.71325176]


portfolio before change:  [-1.17135361]
curr_Stock_Price:  104.95957871896356
curr_Factors:  [104.95957872  -0.28877481  -1.10002155]
mat_Sqrt:  [[26.17432454  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00129926 -0.00588402  0.05940631]
Stock Position:  -0.0012992633211600685
Bond Position:  [-1.03498348]


portfolio before change:  [-1.17246608]
curr_Stock_Price:  105.61663175484955
curr_Factors:  [ 1.05616632e+02 -8.64598597e-02 -1.08941505e+00]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.17246608]
Stock Price:  110.44732245740124
PL:  [-11.61978853]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.24187312e-01 -2.49885299e-02  6.15048455e-02]
 [ 4.70586259e-02  5.14972050e-02  7.28290751e-02]
 [-2.01011212e-02 -1.34297624e-01  3.25981149e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 4.04111956e-01 -3.23489198e-01 -2.70349045e-01]
 [-4.11352489e-02  2.29136488e-02 -5.07651594e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-7.09424875e-02 -4.07106354e-02 -3.28604437e-02]
 [-6.01975127e-04  1.85711408e-02 -9.35480563e-02]
 [-2.56662887e-01  2.50332521e-01  3.54303827e-02]
 [ 1.17919262e-01 -1.66661893e-01  1.62538748e-02]
 [-1.12703228e-01  1.12181765e-03 -2.55094559e-03]
 [-5.60173472e-02  1.75119031e-01 -5.61791776e-04]
 [-8.16685482e-02  7.59062009e-02  1.17435310e-02]
 [-1.76604482e-01 -1.29723160e-01  2.59891231e-01]
 [ 3.78246975e-02  1.01332068e-01  1.74696926e-01]
 [-8.98122967e-02  5.68857896e-02  7.89294979e-02]
 [-4.24446020e-02 -3.34581553e-02  2.19614940e-02]
 [-2.38002177e-02  5.50746776e-01  2.82350649e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.97617669]
curr_Stock_Price:  100.93330900586595
curr_Factors:  [100.93330901  -0.99431102  -0.97592925]
mat_Sqrt:  [[14.07246043  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01508463 -0.00790207  0.1754562 ]
Stock Position:  -0.015084632147916608
Bond Position:  [10.49871853]


portfolio before change:  [8.97331879]
curr_Stock_Price:  101.29678506787464
curr_Factors:  [101.29678507  -1.21669622  -0.94881658]
mat_Sqrt:  [[11.61784037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0054446  0.01628485 0.20776108]
Stock Position:  0.005444596297783285
Bond Position:  [8.42179869]


portfolio before change:  [8.97525369]
curr_Stock_Price:  101.2654121833592
curr_Factors:  [101.26541218  -1.26043659  -0.93969827]
mat_Sqrt:  [[11.21901443  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00150767 -0.04246864  0.09299335]
Stock Position:  -0.00150767330744466
Bond Position:  [9.12792885]


portfolio before change:  [8.97751891]
curr_Stock_Price:  101.27671901160886
curr_Factors:  [101.27671901  -1.32884142  -0.92899233]
mat_Sqrt:  [[10.59119309  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00358258 -0.00455813 -0.02970002]
Stock Position:  -0.0035825762838797128
Bond Position:  [9.34035049]


portfolio before change:  [8.977224]
curr_Stock_Price:  102.01090990016748
curr_Factors:  [102.0109099   -1.4063176   -0.91785356]
mat_Sqrt:  [[ 9.9832492   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03411462 -0.10229627 -0.77123058]
Stock Position:  0.034114618028679565
Bond Position:  [5.49716077]


portfolio before change:  [8.94627862]
curr_Stock_Price:  101.06352025991148
curr_Factors:  [101.06352026  -1.45615916  -0.88461161]
mat_Sqrt:  [[ 9.72770955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00523309  0.00724593 -0.14481887]
Stock Position:  -0.005233093727336731
Bond Position:  [9.4751535]


portfolio before change:  [8.95682865]
curr_Stock_Price:  99.50021097976695
curr_Factors:  [99.50021098 -1.0521443  -0.8995832 ]
mat_Sqrt:  [[14.13186618  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00040096 -0.02845143  0.0120735 ]
Stock Position:  -0.000400958643089287
Bond Position:  [8.99672412]


portfolio before change:  [8.95840663]
curr_Stock_Price:  101.17490539662343
curr_Factors:  [101.1749054   -0.89448866  -0.87631989]
mat_Sqrt:  [[17.21949555  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00457047 -0.01287383 -0.0937417 ]
Stock Position:  -0.00457047312418969
Bond Position:  [9.42082382]


portfolio before change:  [8.95648652]
curr_Stock_Price:  102.11039178140729
curr_Factors:  [102.11039178  -0.97173273  -0.89510767]
mat_Sqrt:  [[15.78743085  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00121729  0.00587271 -0.26686657]
Stock Position:  -0.0012172903584534434
Bond Position:  [9.08078451]


portfolio before change:  [8.95889448]
curr_Stock_Price:  101.99745195890206
curr_Factors:  [101.99745196  -0.63494945  -0.90147886]
mat_Sqrt:  [[21.94456554  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01107186  0.07916209  0.10107302]
Stock Position:  -0.011071858843722943
Bond Position:  [10.08819587]


portfolio before change:  [8.9384215]
curr_Stock_Price:  104.07436995126187
curr_Factors:  [104.07436995  -1.02794354  -0.90288967]
mat_Sqrt:  [[15.09362587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00774724 -0.05270312  0.04636778]
Stock Position:  0.007747235825482855
Bond Position:  [8.13213281]


portfolio before change:  [8.94719024]
curr_Stock_Price:  104.94377134287006
curr_Factors:  [104.94377134  -1.05332484  -0.92883209]
mat_Sqrt:  [[14.45828719  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00782907  0.00035475 -0.00727714]
Stock Position:  -0.007829072039999803
Bond Position:  [9.76880259]


portfolio before change:  [8.95168951]
curr_Stock_Price:  104.6810627294396
curr_Factors:  [104.68106273  -0.96271447  -0.86612428]
mat_Sqrt:  [[16.8117742   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0030699   0.0553775  -0.00160264]
Stock Position:  -0.0030699001730670663
Bond Position:  [9.27304993]


portfolio before change:  [8.95060309]
curr_Stock_Price:  105.79021159272241
curr_Factors:  [105.79021159  -1.42030738  -0.86122295]
mat_Sqrt:  [[10.8041213   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00715574  0.02400365  0.03350103]
Stock Position:  -0.007155743454842733
Bond Position:  [9.70761071]


portfolio before change:  [8.95684422]
curr_Stock_Price:  105.25722358176651
curr_Factors:  [105.25722358  -1.23889655  -0.86879232]
mat_Sqrt:  [[12.79069852  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00992157 -0.04102206  0.74139734]
Stock Position:  -0.00992157264386793
Bond Position:  [10.00116141]


portfolio before change:  [8.96387619]
curr_Stock_Price:  104.8005049805
curr_Factors:  [104.80050498  -1.51555382  -0.88398088]
mat_Sqrt:  [[ 9.51171208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00800076 0.03204401 0.4983617 ]
Stock Position:  0.008000761612175597
Bond Position:  [8.12539233]


portfolio before change:  [8.96458961]
curr_Stock_Price:  104.63574773843199
curr_Factors:  [104.63574774  -1.11721335  -0.90938126]
mat_Sqrt:  [[13.78926847  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00523828  0.01798887  0.22516389]
Stock Position:  -0.00523828336734122
Bond Position:  [9.51270131]


portfolio before change:  [8.97574507]
curr_Stock_Price:  102.96020121997378
curr_Factors:  [102.96020122  -0.8277099   -0.90186715]
mat_Sqrt:  [[18.26096034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00212615 -0.0105804   0.06265003]
Stock Position:  -0.0021261541541923883
Bond Position:  [9.19465433]


portfolio before change:  [8.98255721]
curr_Stock_Price:  100.8374992430587
curr_Factors:  [100.83749924  -0.66708761  -0.89411755]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.98255721]
Stock Price:  99.53576125716698
PL:  [8.98255721]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.21574534e-01 -2.47342277e-02  6.02896027e-02]
 [ 6.87470115e-02  2.29662986e-02  1.14878490e-02]
 [-1.93886496e-02 -2.05756799e-01  2.64177250e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.63935706e-01 -3.07197454e-01 -2.76470945e-01]
 [ 7.11187693e-02 -2.63739675e-01 -1.85656116e-01]
 [ 5.16825699e-02 -9.13100902e-02 -9.94088967e-03]
 [-7.70274709e-02 -1.37835939e-01 -5.58894343e-02]
 [-6.93572568e-02 -3.17704949e-02 -1.28384449e-01]
 [-4.61349917e-01  4.52522285e-01  5.21689313e-02]
 [ 9.18828104e-02 -1.68683620e-01  4.29118966e-02]
 [-1.46368685e-01 -1.71782501e-02 -1.73184303e-02]
 [-6.80841381e-02  1.63009166e-01 -1.94106795e-02]
 [-1.04193767e-01  2.46543095e-02  1.00937607e-01]
 [-1.42796466e-01 -1.15871219e-01  2.48701346e-01]
 [ 4.45386419e-02  6.85440858e-02  1.21445711e-01]
 [-1.05673412e-01  4.00883051e-02  8.04353120e-02]
 [-3.97890852e-02 -2.50176123e-02  2.13207714e-02]
 [-1.30518145e-02  5.61600586e-01  3.44222510e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.13208978]
curr_Stock_Price:  100.95502751744706
curr_Factors:  [100.95502752  -0.90272668  -1.03900223]
mat_Sqrt:  [[14.48257554  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01449373 -0.00782165  0.17198946]
Stock Position:  -0.014493734531127556
Bond Position:  [10.59530515]


portfolio before change:  [9.11689355]
curr_Stock_Price:  102.18627650767195
curr_Factors:  [102.18627651  -1.03827656  -1.01813387]
mat_Sqrt:  [[13.07088143  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00548432 0.00726258 0.03277164]
Stock Position:  0.00548432380675676
Bond Position:  [8.55647092]


portfolio before change:  [9.12723035]
curr_Stock_Price:  103.68097652148597
curr_Factors:  [103.68097652  -1.4125609   -1.02995155]
mat_Sqrt:  [[ 9.01424585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214203 -0.06506601  0.07536242]
Stock Position:  -0.002142028525877403
Bond Position:  [9.34931796]


portfolio before change:  [9.13097527]
curr_Stock_Price:  103.02398377978331
curr_Factors:  [103.02398378  -0.91682185  -1.06058678]
mat_Sqrt:  [[14.26135137  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0026606  -0.00455813 -0.02970002]
Stock Position:  -0.002660600402018436
Bond Position:  [9.40508092]


portfolio before change:  [9.13084492]
curr_Stock_Price:  103.95682146254153
curr_Factors:  [103.95682146  -0.69587121  -1.05847634]
mat_Sqrt:  [[17.98661885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01665513 -0.09714436 -0.78869465]
Stock Position:  0.016655131761915395
Bond Position:  [7.39943037]


portfolio before change:  [9.16775196]
curr_Stock_Price:  106.06169531237126
curr_Factors:  [106.06169531  -0.81528648  -1.08118899]
mat_Sqrt:  [[15.9195113   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00165911 -0.08340181 -0.52962522]
Stock Position:  0.0016591052158071984
Bond Position:  [8.99178445]


portfolio before change:  [9.16824114]
curr_Stock_Price:  105.00145576529225
curr_Factors:  [105.00145577  -0.82588116  -1.07663453]
mat_Sqrt:  [[15.66546382  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00301911 -0.02887479 -0.02835859]
Stock Position:  0.0030191112387703755
Bond Position:  [8.85123007]


portfolio before change:  [9.17155497]
curr_Stock_Price:  105.36604911000697
curr_Factors:  [105.36604911  -0.78146673  -1.05703746]
mat_Sqrt:  [[16.75901431  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00548927 -0.04358755 -0.159437  ]
Stock Position:  -0.005489270479875249
Bond Position:  [9.74993772]


portfolio before change:  [9.17981398]
curr_Stock_Price:  104.30557700906513
curr_Factors:  [104.30557701  -1.19673619  -1.0611433 ]
mat_Sqrt:  [[10.90744238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00883653 -0.01004671 -0.3662451 ]
Stock Position:  -0.00883652922814184
Bond Position:  [10.10151326]


portfolio before change:  [9.17952829]
curr_Stock_Price:  104.62373176217909
curr_Factors:  [104.62373176  -1.0857867   -1.06709847]
mat_Sqrt:  [[12.15189639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03612744  0.14310011  0.14882344]
Stock Position:  -0.03612743960909325
Bond Position:  [12.95931584]


portfolio before change:  [9.14697588]
curr_Stock_Price:  105.61446470052603
curr_Factors:  [105.6144647   -1.48266549  -1.02846951]
mat_Sqrt:  [[ 8.57336529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01123092 -0.05334244  0.1224157 ]
Stock Position:  0.011230919136758132
Bond Position:  [7.96082837]


portfolio before change:  [9.15656208]
curr_Stock_Price:  106.2907887902308
curr_Factors:  [106.29078879  -1.24673857  -1.03854178]
mat_Sqrt:  [[10.81461301  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01390224 -0.00543224 -0.04940466]
Stock Position:  -0.013902239024884766
Bond Position:  [10.63424203]


portfolio before change:  [9.1724786]
curr_Stock_Price:  105.33715618897607
curr_Factors:  [105.33715619  -1.07561617  -1.02832876]
mat_Sqrt:  [[12.84842571  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00527983  0.05154802 -0.05537327]
Stock Position:  -0.00527982567100591
Bond Position:  [9.72864042]


portfolio before change:  [9.1738856]
curr_Stock_Price:  105.53137963428881
curr_Factors:  [105.53137963  -1.17324039  -1.02283075]
mat_Sqrt:  [[11.73924151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00706633  0.00779638  0.2879469 ]
Stock Position:  -0.007066333276942323
Bond Position:  [9.9196055]


portfolio before change:  [9.1726182]
curr_Stock_Price:  106.06172628768266
curr_Factors:  [106.06172629  -1.00029319  -1.04515057]
mat_Sqrt:  [[13.71619825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00692774 -0.0366417   0.70947572]
Stock Position:  -0.006927743166702103
Bond Position:  [9.9073866]


portfolio before change:  [9.18345362]
curr_Stock_Price:  104.85523557518417
curr_Factors:  [104.85523558  -1.35166175  -1.01447258]
mat_Sqrt:  [[ 9.83990795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00722552 0.02167554 0.34645081]
Stock Position:  0.007225519277606448
Bond Position:  [8.42582009]


portfolio before change:  [9.17954658]
curr_Stock_Price:  104.02294173790742
curr_Factors:  [104.02294174  -0.96629788  -1.02901069]
mat_Sqrt:  [[14.14417524  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00623716  0.01267704  0.22945956]
Stock Position:  -0.006237164435166767
Bond Position:  [9.82835477]


portfolio before change:  [9.1806193]
curr_Stock_Price:  104.24494596716309
curr_Factors:  [104.24494597  -0.90484103  -0.99990064]
mat_Sqrt:  [[15.5180167   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00232523 -0.00791126  0.06082223]
Stock Position:  -0.002325229673381222
Bond Position:  [9.42301274]


portfolio before change:  [9.18262362]
curr_Stock_Price:  104.3962116596516
curr_Factors:  [104.39621166  -0.69418448  -0.9753966 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.18262362]
Stock Price:  103.20940569781932
PL:  [5.97321792]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.59576552e-01 -2.84329706e-02  7.79649174e-02]
 [ 3.31517293e-03  7.16974818e-02  5.42969829e-02]
 [ 9.07715059e-03 -1.01666313e-02  3.12590737e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.32838189e-01 -2.88132870e-01 -2.66591781e-01]
 [ 7.18015278e-02 -6.87910878e-02 -6.81268869e-02]
 [ 2.35971166e-02 -8.33923711e-02 -2.88036680e-03]
 [-1.15642332e-01 -8.24980839e-02 -5.25950562e-02]
 [-1.14951956e-01 -5.10079841e-02 -1.14323741e-01]
 [-4.00662886e-01  3.99549435e-01  6.51308453e-02]
 [ 1.08191117e-01 -1.91065137e-01  5.77201633e-02]
 [-4.24889730e-02  3.92892964e-02  2.82488124e-02]
 [-5.71195616e-02  1.89169867e-01  3.59474780e-03]
 [-1.58454330e-01 -6.80467805e-02  2.80807932e-01]
 [-1.08135964e-01 -1.03835541e-01  2.43266298e-01]
 [-2.31584306e-02 -1.15026069e-02 -8.86065245e-02]
 [-9.09735716e-02  5.48084304e-02  8.00679167e-02]
 [-3.28472787e-02 -4.78102587e-03  2.08003976e-02]
 [-3.11283238e-03  5.67436604e-01  3.90018309e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.65380825]
curr_Stock_Price:  100.60980580273701
curr_Factors:  [100.6098058   -1.24889363  -0.98942769]
mat_Sqrt:  [[10.72876456  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02277953 -0.00899129  0.22241221]
Stock Position:  -0.022779525541182875
Bond Position:  [8.94565189]


portfolio before change:  [6.66184342]
curr_Stock_Price:  100.35525790032949
curr_Factors:  [100.3552579   -0.95466804  -0.99277879]
mat_Sqrt:  [[14.31445185  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0011352  0.02267273 0.15489418]
Stock Position:  0.0011351967465041404
Bond Position:  [6.54792046]


portfolio before change:  [6.66511942]
curr_Stock_Price:  101.79890099098081
curr_Factors:  [101.79890099  -0.99608622  -0.96737228]
mat_Sqrt:  [[14.28972595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00106338 -0.00321497  0.08917344]
Stock Position:  0.0010633780561694075
Bond Position:  [6.55686871]


portfolio before change:  [6.6672381]
curr_Stock_Price:  102.24959100714486
curr_Factors:  [102.24959101  -0.89173549  -0.94201899]
mat_Sqrt:  [[16.34075542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00232203 -0.00455813 -0.02970002]
Stock Position:  -0.0023220320122712985
Bond Position:  [6.90466492]


portfolio before change:  [6.6677674]
curr_Stock_Price:  102.76512422779801
curr_Factors:  [102.76512423  -0.6416966   -0.90880009]
mat_Sqrt:  [[21.80085862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01242982 -0.09111561 -0.76051215]
Stock Position:  0.012429822844110061
Bond Position:  [5.39041511]


portfolio before change:  [6.66038075]
curr_Stock_Price:  102.062425782062
curr_Factors:  [102.06242578  -0.58162826  -0.90884512]
mat_Sqrt:  [[22.9911937   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00244089 -0.02175365 -0.19434705]
Stock Position:  0.002440891401384618
Bond Position:  [6.41125745]


portfolio before change:  [6.66681722]
curr_Stock_Price:  104.04262680626972
curr_Factors:  [104.04262681  -0.75652795  -0.8640794 ]
mat_Sqrt:  [[20.57739899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00101354 -0.02637098 -0.00821688]
Stock Position:  0.001013538320672675
Bond Position:  [6.56136603]


portfolio before change:  [6.67046954]
curr_Stock_Price:  106.02752651033273
curr_Factors:  [106.02752651  -0.93717881  -0.89373238]
mat_Sqrt:  [[16.99276302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00756253 -0.02608818 -0.15003906]
Stock Position:  -0.007562533752977631
Bond Position:  [7.47230629]


portfolio before change:  [6.67788611]
curr_Stock_Price:  105.29387551729164
curr_Factors:  [105.29387552  -0.79819577  -0.87119825]
mat_Sqrt:  [[19.83327802  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00703894 -0.01613014 -0.32613381]
Stock Position:  -0.007038937904853174
Bond Position:  [7.41904316]


portfolio before change:  [6.68252151]
curr_Stock_Price:  104.89887173908397
curr_Factors:  [104.89887174  -0.67171064  -0.89562767]
mat_Sqrt:  [[21.88187037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01723124  0.12634863  0.18580017]
Stock Position:  -0.017231241190778224
Bond Position:  [8.49005927]


portfolio before change:  [6.69116892]
curr_Stock_Price:  104.52022083910495
curr_Factors:  [104.52022084  -0.45320596  -0.92781436]
mat_Sqrt:  [[26.26823019  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00437943 -0.0604201   0.16465956]
Stock Position:  0.004379431523221822
Bond Position:  [6.23342977]


portfolio before change:  [6.68598883]
curr_Stock_Price:  102.98151980397505
curr_Factors:  [ 1.02981520e+02  6.60523119e-02 -9.19132570e-01]
mat_Sqrt:  [[43.88046775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00081376  0.01242437  0.080586  ]
Stock Position:  -0.0008137621331131018
Bond Position:  [6.76979129]


portfolio before change:  [6.68733179]
curr_Stock_Price:  103.4112605884379
curr_Factors:  [103.41126059  -0.20223431  -0.94750772]
mat_Sqrt:  [[32.7522554   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00157245  0.05982076  0.01025481]
Stock Position:  -0.0015724548195832318
Bond Position:  [6.84994132]


portfolio before change:  [6.68395887]
curr_Stock_Price:  106.64545054363305
curr_Factors:  [ 1.06645451e+02 -3.14365623e-03 -9.11578365e-01]
mat_Sqrt:  [[42.72515107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00240822 -0.02151828  0.80106687]
Stock Position:  -0.0024082211263380766
Bond Position:  [6.94078469]


portfolio before change:  [6.6835615]
curr_Stock_Price:  107.53107382443203
curr_Factors:  [107.53107382  -0.17223471  -0.93776186]
mat_Sqrt:  [[35.43795075  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172585 -0.03283568  0.69397104]
Stock Position:  -0.001725846432426172
Bond Position:  [6.86914362]


portfolio before change:  [6.68518802]
curr_Stock_Price:  107.58379402130839
curr_Factors:  [107.58379402  -0.3443631   -0.93313797]
mat_Sqrt:  [[29.98714993  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138533 -0.00363744 -0.25276975]
Stock Position:  -0.0013853319775330014
Bond Position:  [6.83422729]


portfolio before change:  [6.68616014]
curr_Stock_Price:  108.1155406992979
curr_Factors:  [108.1155407   -0.61823613  -0.94879067]
mat_Sqrt:  [[22.55989277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324534  0.01733195  0.22841148]
Stock Position:  -0.0032453447221568676
Bond Position:  [7.03703234]


portfolio before change:  [6.69196158]
curr_Stock_Price:  106.87007570347562
curr_Factors:  [106.8700757   -0.53655395  -0.94289124]
mat_Sqrt:  [[24.341158    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118009 -0.00151189  0.05933774]
Stock Position:  -0.0011800942632425476
Bond Position:  [6.81807835]


portfolio before change:  [6.6932357]
curr_Stock_Price:  107.23497270804495
curr_Factors:  [107.23497271  -0.81142603  -0.9747054 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.6932357]
Stock Price:  107.1346181333144
PL:  [-0.44138243]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.43754067e-01 -2.68929654e-02  7.06056396e-02]
 [-2.78056800e-02  9.23717900e-02  6.87621455e-02]
 [-4.59865547e-02 -2.70771854e-01  3.59198017e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 5.76577373e-01 -3.65263696e-01 -1.81228452e-01]
 [ 8.65317974e-02 -7.48922396e-03 -2.63090919e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 1.27401910e-01 -8.22597439e-03 -6.61286445e-03]
 [-8.10631835e-02  2.29574262e-02  6.30197952e-02]
 [ 6.94999161e-02  3.51145588e-02 -2.99532424e-02]
 [-3.45345794e-02 -5.71399417e-02 -3.46137869e-03]
 [ 1.30312722e-01  6.05250263e-02 -1.22483110e-01]
 [ 3.37550562e-02  1.16512888e-01  8.08519758e-02]
 [ 2.02801029e-01 -3.78519301e-01  1.16726330e-01]
 [-1.83602094e-02  4.53002087e-02 -1.27242974e-01]
 [-3.55196704e-02  2.68092573e-01  5.02921055e-01]
 [ 3.28352465e-02 -9.47799449e-02 -6.77476235e-02]
 [ 1.31152956e-01  5.53465927e-02  1.98716977e-01]
 [-4.12552960e-02  4.24862676e-01  8.92978545e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.87728984]
curr_Stock_Price:  100.64093652714006
curr_Factors:  [100.64093653  -0.89627421  -0.97595077]
mat_Sqrt:  [[15.47667608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01486341 -0.0085043   0.20141824]
Stock Position:  -0.014863406274762273
Bond Position:  [8.37315697]


portfolio before change:  [6.88736253]
curr_Stock_Price:  100.10410527191694
curr_Factors:  [100.10410527  -0.98844255  -0.94688353]
mat_Sqrt:  [[14.4527486   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078771  0.02921052  0.19615926]
Stock Position:  -0.0007877142813412245
Bond Position:  [6.96621597]


portfolio before change:  [6.88915574]
curr_Stock_Price:  100.03880964066713
curr_Factors:  [100.03880964  -1.0737685   -0.93725731]
mat_Sqrt:  [[13.39032458  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00340886 -0.08562558  0.1024692 ]
Stock Position:  -0.0034088609899115504
Bond Position:  [7.23017414]


portfolio before change:  [6.89171231]
curr_Stock_Price:  99.81914596835728
curr_Factors:  [99.81914597 -0.82220885 -0.97040632]
mat_Sqrt:  [[16.62229449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0022827  -0.00455813 -0.02970002]
Stock Position:  -0.0022827027415063973
Bond Position:  [7.11956975]


portfolio before change:  [6.89296507]
curr_Stock_Price:  100.05016822396486
curr_Factors:  [100.05016822  -0.9028041   -0.97605807]
mat_Sqrt:  [[15.28404652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0346867  -0.11550652 -0.51699433]
Stock Position:  0.03468670427487858
Bond Position:  [3.42255447]


portfolio before change:  [6.91721235]
curr_Stock_Price:  100.72453408302967
curr_Factors:  [100.72453408  -0.54246624  -0.99908696]
mat_Sqrt:  [[21.55992373  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00375549 -0.0023683  -0.07505252]
Stock Position:  0.0037554912792670163
Bond Position:  [6.53894224]


portfolio before change:  [6.91890371]
curr_Stock_Price:  100.73955742967232
curr_Factors:  [100.73955743  -0.51735739  -0.99969227]
mat_Sqrt:  [[22.09803929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00025642 -0.02845143  0.0120735 ]
Stock Position:  -0.0002564161377493891
Bond Position:  [6.94473496]


portfolio before change:  [6.92127502]
curr_Stock_Price:  98.26344576006119
curr_Factors:  [98.26344576 -0.49272847 -1.00751987]
mat_Sqrt:  [[21.920094    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00574084 -0.00260128 -0.01886466]
Stock Position:  0.0057408362690089
Bond Position:  [6.35716067]


portfolio before change:  [6.92575698]
curr_Stock_Price:  98.76728586603723
curr_Factors:  [98.76728587 -0.30882454 -1.00600769]
mat_Sqrt:  [[26.52092939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254918  0.00725978  0.17977793]
Stock Position:  -0.0025491777638028796
Bond Position:  [7.17753234]


portfolio before change:  [6.93477992]
curr_Stock_Price:  95.93172798191524
curr_Factors:  [ 9.59317280e+01 -1.08924136e-02 -9.69762581e-01]
mat_Sqrt:  [[35.98066739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00178686  0.0111042  -0.08544826]
Stock Position:  0.0017868592985285502
Bond Position:  [6.76336342]


portfolio before change:  [6.93361023]
curr_Stock_Price:  94.33073564302813
curr_Factors:  [94.33073564 -0.28234558 -0.99698348]
mat_Sqrt:  [[26.24506594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00139899 -0.01806924 -0.00987435]
Stock Position:  -0.0013989859056448553
Bond Position:  [7.0655776]


portfolio before change:  [6.93473867]
curr_Stock_Price:  94.78690246504975
curr_Factors:  [94.78690247 -0.59987545 -1.02079575]
mat_Sqrt:  [[18.74561828  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00570126  0.01913969 -0.34941022]
Stock Position:  0.005701263620363419
Bond Position:  [6.39433355]


portfolio before change:  [6.93195981]
curr_Stock_Price:  94.01906458506707
curr_Factors:  [94.01906459 -0.65475648 -0.96177436]
mat_Sqrt:  [[18.67091076  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00285295 0.03684461 0.23064818]
Stock Position:  0.0028529538363639556
Bond Position:  [6.66372776]


portfolio before change:  [6.92827544]
curr_Stock_Price:  92.14363774529002
curr_Factors:  [92.14363775 -0.99503754 -0.98137114]
mat_Sqrt:  [[12.7679735   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01698424 -0.11969831  0.33298773]
Stock Position:  0.01698424301590027
Bond Position:  [5.36328551]


portfolio before change:  [6.91449841]
curr_Stock_Price:  91.25351730752912
curr_Factors:  [91.25351731 -1.07483551 -0.95040653]
mat_Sqrt:  [[12.04198752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00358445  0.01432518 -0.36298879]
Stock Position:  -0.0035844520071076718
Bond Position:  [7.24159226]


portfolio before change:  [6.91781212]
curr_Stock_Price:  90.83418205202528
curr_Factors:  [90.83418205 -0.81921973 -0.90364365]
mat_Sqrt:  [[16.21881996  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00456635 0.08477832 1.43469378]
Stock Position:  0.004566348276628764
Bond Position:  [6.50303161]


portfolio before change:  [6.91823091]
curr_Stock_Price:  90.56981901944604
curr_Factors:  [90.56981902 -0.30755668 -0.93937356]
mat_Sqrt:  [[26.02846628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00063619 -0.02997205 -0.19326511]
Stock Position:  0.0006361924252406037
Bond Position:  [6.86061108]


portfolio before change:  [6.92008206]
curr_Stock_Price:  90.78325617294406
curr_Factors:  [90.78325617 -0.3214025  -0.92745869]
mat_Sqrt:  [[26.03947549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00664932 0.01750213 0.56688422]
Stock Position:  0.006649324871072118
Bond Position:  [6.3164347]


portfolio before change:  [6.9096828]
curr_Stock_Price:  88.9817848913048
curr_Factors:  [88.98178489 -0.50828709 -0.89381295]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.9096828]
Stock Price:  88.13175002676122
PL:  [6.9096828]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.38099298e-01 -2.63425859e-02  6.79755212e-02]
 [ 8.26970880e-03  7.47138429e-02  7.96645886e-02]
 [-1.73380089e-01 -5.56473812e-01 -6.43266760e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 6.54929907e-01 -4.15000762e-01 -2.08875390e-01]
 [ 5.91669564e-02  1.96795611e-02 -1.16671985e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-4.07290902e-02 -3.71837868e-02 -2.15492705e-02]
 [-2.22513261e-02  3.00454720e-02 -1.65190092e-02]
 [-4.41262129e-02  6.35263480e-02 -3.39676474e-02]
 [ 8.31948233e-02 -1.31329321e-01 -3.64516678e-04]
 [ 5.91841541e-02  9.61937569e-02  2.21959202e-02]
 [-2.64965327e-02  1.84429942e-01  3.76723276e-02]
 [-5.21187761e-02 -6.75618513e-02 -3.24638598e-02]
 [-1.52408933e-01 -1.13384960e-01  2.33972428e-01]
 [-7.40488503e-03  9.30395966e-02  7.24871540e-02]
 [-1.29472126e-01  1.63772610e-02  8.08839193e-02]
 [-3.91919604e-02 -2.34489615e-02  2.13846947e-02]
 [-8.95885386e-03  5.84379108e-01  3.68145667e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.92983571]
curr_Stock_Price:  100.78755493400374
curr_Factors:  [100.78755493  -1.03954553  -0.99484454]
mat_Sqrt:  [[13.17900218  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01706533 -0.00833026  0.19391524]
Stock Position:  -0.01706532959120805
Bond Position:  [9.64980856]


portfolio before change:  [7.93711602]
curr_Stock_Price:  100.50232465120202
curr_Factors:  [100.50232465  -1.09674858  -0.9210813 ]
mat_Sqrt:  [[13.3611464   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00198039 0.02362659 0.2272609 ]
Stock Position:  0.001980389795970696
Bond Position:  [7.73808224]


portfolio before change:  [7.93456369]
curr_Stock_Price:  98.23656626226544
curr_Factors:  [98.23656626 -1.06247838 -0.93000171]
mat_Sqrt:  [[13.39522655  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0149963  -0.17597247 -0.1835061 ]
Stock Position:  -0.014996298019005174
Bond Position:  [9.40774852]


portfolio before change:  [7.90349813]
curr_Stock_Price:  100.46496894987625
curr_Factors:  [100.46496895  -1.00261318  -0.92703807]
mat_Sqrt:  [[14.58739574  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260113 -0.00455813 -0.02970002]
Stock Position:  -0.0026011330516786902
Bond Position:  [8.16482089]


portfolio before change:  [7.9062221]
curr_Stock_Price:  100.2025815216051
curr_Factors:  [100.20258152  -1.22150114  -0.96825187]
mat_Sqrt:  [[11.21711729  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05363037 -0.13123476 -0.59586335]
Stock Position:  0.0536303675779818
Bond Position:  [2.53232082]


portfolio before change:  [7.90605881]
curr_Stock_Price:  100.18773077069231
curr_Factors:  [100.18773077  -0.86091444  -0.99528758]
mat_Sqrt:  [[15.6558354   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00365956  0.00622322 -0.03328327]
Stock Position:  0.0036595634859291418
Bond Position:  [7.53941545]


portfolio before change:  [7.908035]
curr_Stock_Price:  100.21262563713032
curr_Factors:  [100.21262564  -0.41902749  -1.04583068]
mat_Sqrt:  [[23.16021701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024466 -0.02845143  0.0120735 ]
Stock Position:  -0.0002446563383080904
Bond Position:  [7.93255266]


portfolio before change:  [7.91004889]
curr_Stock_Price:  100.08793372145635
curr_Factors:  [100.08793372  -0.45203928  -1.01861919]
mat_Sqrt:  [[22.99761855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200403 -0.01175855 -0.06147407]
Stock Position:  -0.0020040291455481318
Bond Position:  [8.11062803]


portfolio before change:  [7.91133509]
curr_Stock_Price:  100.45804420611135
curr_Factors:  [100.45804421  -0.6082709   -0.98952991]
mat_Sqrt:  [[20.32678284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012224   0.00950121 -0.04712414]
Stock Position:  -0.0012224012124578698
Bond Position:  [8.03413513]


portfolio before change:  [7.91565861]
curr_Stock_Price:  98.56445193121738
curr_Factors:  [98.56445193 -0.33809749 -0.9906825 ]
mat_Sqrt:  [[26.09987899  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189348  0.0200888  -0.09690024]
Stock Position:  -0.0018934795299536805
Bond Position:  [8.10228838]


portfolio before change:  [7.91593655]
curr_Stock_Price:  99.48755748210121
curr_Factors:  [99.48755748 -0.2926695  -0.96178663]
mat_Sqrt:  [[28.37692874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00280966 -0.04152998 -0.00103986]
Stock Position:  0.0028096595250138644
Bond Position:  [7.63641039]


portfolio before change:  [7.91794938]
curr_Stock_Price:  99.5243910065823
curr_Factors:  [99.52439101 -0.43165707 -0.92067531]
mat_Sqrt:  [[25.7406221   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00257176 0.03041914 0.06331878]
Stock Position:  0.0025717556160365254
Bond Position:  [7.66199697]


portfolio before change:  [7.92395238]
curr_Stock_Price:  101.11367792406757
curr_Factors:  [101.11367792  -0.41876905  -0.93804554]
mat_Sqrt:  [[26.03471439  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00053946  0.05832187  0.10746866]
Stock Position:  -0.0005394620503894745
Bond Position:  [7.97849937]


portfolio before change:  [7.92625968]
curr_Stock_Price:  100.5345267478159
curr_Factors:  [100.53452675  -0.42166584  -0.93261429]
mat_Sqrt:  [[25.95128383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0023309  -0.02136493 -0.09261036]
Stock Position:  -0.002330900991278935
Bond Position:  [8.16059571]


portfolio before change:  [7.92437569]
curr_Stock_Price:  102.21816693041681
curr_Factors:  [102.21816693  -0.41085126  -0.95122944]
mat_Sqrt:  [[26.18086309  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.004109   -0.03585547  0.66745821]
Stock Position:  -0.004108997387005868
Bond Position:  [8.34438987]


portfolio before change:  [7.93853524]
curr_Stock_Price:  99.2799333968077
curr_Factors:  [ 9.92799334e+01  8.72069219e-02 -9.61423892e-01]
mat_Sqrt:  [[41.41845272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00023646 0.0294217  0.20678567]
Stock Position:  0.00023645898700696438
Bond Position:  [7.91505961]


portfolio before change:  [7.94157709]
curr_Stock_Price:  103.77472484418192
curr_Factors:  [103.77472484  -0.23357259  -0.99368624]
mat_Sqrt:  [[30.41584247  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00370001  0.00517894  0.23073931]
Stock Position:  -0.003700009505739975
Bond Position:  [8.32554455]


portfolio before change:  [7.94184792]
curr_Stock_Price:  104.26413145761217
curr_Factors:  [104.26413146  -0.4671378   -0.9773601 ]
mat_Sqrt:  [[24.59220458  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144079 -0.00741521  0.06100458]
Stock Position:  -0.0014407930501565873
Bond Position:  [8.09207096]


portfolio before change:  [7.94369698]
curr_Stock_Price:  104.38504805436826
curr_Factors:  [104.38504805  -0.49823118  -0.93548042]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.94369698]
Stock Price:  104.328591628808
PL:  [3.61510535]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.32114724e-01 -6.15454842e-02  1.41431772e-01]
 [-2.52621789e-02  8.82668229e-02  5.69848172e-02]
 [-2.15520710e-02 -1.70123239e-01  3.72105714e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 2.94537052e-01 -2.53741344e-01 -2.33933320e-01]
 [ 5.00339229e-02 -1.73588925e-01 -1.38472680e-01]
 [ 5.52666455e-02 -1.06447878e-01 -1.07215698e-02]
 [-4.40484139e-02 -1.95875301e-01 -5.84244841e-02]
 [-1.11864276e-01 -5.15680157e-02 -1.19647613e-01]
 [-4.82707020e-01  4.74970945e-01  4.47876306e-02]
 [ 8.97503222e-02 -2.00272379e-01  8.70885191e-02]
 [-1.99848087e-01 -4.62488992e-02 -4.07773798e-02]
 [-1.37953044e-01  9.66627033e-02 -1.27086338e-01]
 [-1.04280151e-01  1.11749622e-01  8.49183478e-03]
 [-1.52274919e-01 -1.26675183e-01  2.71130937e-01]
 [-1.04169354e-02  5.53821238e-03 -4.94840329e-02]
 [-9.22214995e-02  5.25760609e-02  8.12912830e-02]
 [-2.99881085e-02  5.07490884e-03  1.96253998e-02]
 [-1.36707775e-02  4.98963298e-01  3.05257048e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.76049826]
curr_Stock_Price:  99.01980627843196
curr_Factors:  [99.01980628 -0.79559082 -0.9964201 ]
mat_Sqrt:  [[16.49915193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00635391 -0.01946239  0.40346548]
Stock Position:  -0.006353913348134847
Bond Position:  [-4.13133499]


portfolio before change:  [-4.76829071]
curr_Stock_Price:  100.08363584538094
curr_Factors:  [100.08363585  -0.94752389  -1.00113441]
mat_Sqrt:  [[14.25842415  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007961   0.02791242  0.16256182]
Stock Position:  -0.000796102155800946
Bond Position:  [-4.68861391]


portfolio before change:  [-4.76996435]
curr_Stock_Price:  100.71338279719708
curr_Factors:  [100.7133828   -1.05778035  -1.03734546]
mat_Sqrt:  [[12.39326121  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148057 -0.05379769  0.1061514 ]
Stock Position:  -0.0014805673616954283
Bond Position:  [-4.6208514]


portfolio before change:  [-4.77370528]
curr_Stock_Price:  102.45972610345518
curr_Factors:  [102.4597261   -0.85326637  -1.09573587]
mat_Sqrt:  [[14.59191436  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260033 -0.00455813 -0.02970002]
Stock Position:  -0.0026003275699403466
Bond Position:  [-4.50727643]


portfolio before change:  [-4.77659472]
curr_Stock_Price:  103.13751408619038
curr_Factors:  [103.13751409  -0.58154629  -1.11278909]
mat_Sqrt:  [[18.94855752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01267822 -0.08024006 -0.66734665]
Stock Position:  0.012678223111707932
Bond Position:  [-6.08419513]


portfolio before change:  [-4.76176165]
curr_Stock_Price:  104.42746663596226
curr_Factors:  [104.42746664  -0.91357747  -1.10778563]
mat_Sqrt:  [[13.83400415  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00124955 -0.05489364 -0.39502401]
Stock Position:  0.0012495484699321625
Bond Position:  [-4.89224883]


portfolio before change:  [-4.76179902]
curr_Stock_Price:  105.37648308415886
curr_Factors:  [105.37648308  -0.37467526  -1.13077802]
mat_Sqrt:  [[23.38479936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00215224 -0.03366177 -0.03058565]
Stock Position:  0.0021522374880215286
Bond Position:  [-4.98859424]


portfolio before change:  [-4.7613733]
curr_Stock_Price:  106.15382454332756
curr_Factors:  [106.15382454  -0.73023879  -1.13694245]
mat_Sqrt:  [[16.40699844  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00371986 -0.06194121 -0.16666879]
Stock Position:  -0.003719860185117472
Bond Position:  [-4.36649592]


portfolio before change:  [-4.75934262]
curr_Stock_Price:  105.3144254496743
curr_Factors:  [105.31442545  -0.69837514  -1.1350204 ]
mat_Sqrt:  [[16.83659634  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00817379 -0.01630724 -0.34132134]
Stock Position:  -0.008173785249150349
Bond Position:  [-3.89852512]


portfolio before change:  [-4.76376304]
curr_Stock_Price:  105.73597752440516
curr_Factors:  [105.73597752  -0.7655165   -1.14059799]
mat_Sqrt:  [[15.71837981  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02934788  0.150199    0.12776664]
Stock Position:  -0.029347877537623152
Bond Position:  [-1.66063652]


portfolio before change:  [-4.79654463]
curr_Stock_Price:  106.83882983418123
curr_Factors:  [106.83882983  -1.02521705  -1.10673036]
mat_Sqrt:  [[12.67173635  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00807752 -0.06333169  0.2484393 ]
Stock Position:  0.008077518213696696
Bond Position:  [-5.65953722]


portfolio before change:  [-4.78652385]
curr_Stock_Price:  108.25459128843842
curr_Factors:  [108.25459129  -1.39947649  -1.13184579]
mat_Sqrt:  [[ 8.61205957  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02431078 -0.01462519 -0.11632651]
Stock Position:  -0.024310778930376344
Bond Position:  [-2.15477042]


portfolio before change:  [-4.80013869]
curr_Stock_Price:  108.7924627118901
curr_Factors:  [108.79246271  -1.58660591  -1.13249818]
mat_Sqrt:  [[ 7.17310035  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02250054  0.03056743 -0.36254195]
Stock Position:  -0.022500537501948283
Bond Position:  [-2.3522498]


portfolio before change:  [-4.7896767]
curr_Stock_Price:  108.3013581088125
curr_Factors:  [108.30135811  -1.27475474  -1.13215946]
mat_Sqrt:  [[ 9.75718077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01021416  0.03533833  0.02422484]
Stock Position:  -0.010214159357459751
Bond Position:  [-3.68346937]


portfolio before change:  [-4.78716359]
curr_Stock_Price:  107.9651485915512
curr_Factors:  [107.96514859  -1.00963721  -1.15488683]
mat_Sqrt:  [[12.39489178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00808408 -0.04005821  0.77346109]
Stock Position:  -0.008084079239642444
Bond Position:  [-3.91436477]


portfolio before change:  [-4.78762207]
curr_Stock_Price:  107.90079555598359
curr_Factors:  [107.90079556  -1.05047992  -1.17671272]
mat_Sqrt:  [[11.63502107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175116  0.00175134 -0.14116417]
Stock Position:  -0.0017511635922625903
Bond Position:  [-4.59867012]


portfolio before change:  [-4.78867285]
curr_Stock_Price:  107.84424267798033
curr_Factors:  [107.84424268  -1.14964258  -1.14621311]
mat_Sqrt:  [[10.8572417   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00684064  0.01662601  0.2319014 ]
Stock Position:  -0.006840639620177264
Bond Position:  [-4.05094925]


portfolio before change:  [-4.79667419]
curr_Stock_Price:  108.86585506548981
curr_Factors:  [108.86585507  -1.63855552  -1.15385951]
mat_Sqrt:  [[ 6.67054399  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0038754   0.00160483  0.0559858 ]
Stock Position:  -0.0038754046131356757
Bond Position:  [-4.37477495]


portfolio before change:  [-4.79565575]
curr_Stock_Price:  108.32080843377483
curr_Factors:  [108.32080843  -1.64165289  -1.14328522]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.79565575]
Stock Price:  108.28364616942957
PL:  [-13.07930191]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [ 1.36181274e-01 -1.84072285e-01 -4.80795867e-02]
 [-3.12750292e-01  2.50141711e-01  6.29126027e-02]
 [-2.03188886e-01 -5.75266773e-01 -8.51519983e-02]
 [-8.13221452e-04  2.90421075e-01  2.27799120e-01]
 [ 6.61732395e-01 -3.61859176e-01 -1.28339541e-01]
 [-1.44883850e-01  8.22325413e-02  3.24928364e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 4.18178364e-01  4.18562517e-02  1.12902253e-02]
 [-3.50598284e-01 -1.62932568e-02  4.61864557e-01]
 [-5.63867198e-02  8.04900497e-02 -1.92005674e-02]
 [-3.62082546e-02 -5.45310575e-02 -3.71295173e-03]
 [ 7.83590551e-02  1.02783567e-01  1.74228109e-03]
 [ 3.02539946e-02  1.42392831e-01  8.79284572e-02]
 [ 3.79988159e-02 -1.74117903e-01 -2.04955736e-02]
 [-1.21449766e-01 -8.53462413e-02  1.80922328e-01]
 [-3.46375404e-02  2.14169304e-01  3.16850249e-01]
 [-3.96718768e-04  9.15217896e-03 -2.76447954e-02]
 [ 3.47536844e-02  4.69375732e-02  1.44418351e-01]
 [-4.40496802e-02  3.90848105e-01  1.08293827e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.12211063]
curr_Stock_Price:  97.99434230031282
curr_Factors:  [97.9943423  -0.85774424 -0.9929125 ]
mat_Sqrt:  [[15.39823667  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00789794 -0.05820877 -0.13715768]
Stock Position:  0.007897939589789326
Bond Position:  [-12.89606402]


portfolio before change:  [-12.1231171]
curr_Stock_Price:  98.27516887470622
curr_Factors:  [98.27516887 -1.07107346 -0.99349678]
mat_Sqrt:  [[12.4684462   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02353538  0.07910175  0.17947214]
Stock Position:  -0.0235353848576381
Bond Position:  [-9.81017317]


portfolio before change:  [-12.11191149]
curr_Stock_Price:  97.69483165887196
curr_Factors:  [97.69483166 -0.82993059 -0.99805902]
mat_Sqrt:  [[15.70311424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01499217 -0.18191533 -0.24291495]
Stock Position:  -0.014992171996952753
Bond Position:  [-10.64725377]


portfolio before change:  [-12.09838396]
curr_Stock_Price:  96.614956351181
curr_Factors:  [96.61495635 -0.89167266 -1.00996194]
mat_Sqrt:  [[14.42696407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00368648 0.09183921 0.64984748]
Stock Position:  0.0036864803190074817
Bond Position:  [-12.45455309]


portfolio before change:  [-12.09766135]
curr_Stock_Price:  97.65568636606451
curr_Factors:  [97.65568637 -1.41964252 -0.99451373]
mat_Sqrt:  [[ 8.73459551  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07169102 -0.11442992 -0.36611699]
Stock Position:  0.07169101662049322
Bond Position:  [-19.09869679]


portfolio before change:  [-12.16944395]
curr_Stock_Price:  96.72101792924343
curr_Factors:  [96.72101793 -1.16826184 -0.93510875]
mat_Sqrt:  [[11.80425599  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01153212  0.02600421  0.09269302]
Stock Position:  -0.011532115384483144
Bond Position:  [-11.05404601]


portfolio before change:  [-12.1533845]
curr_Stock_Price:  95.0887667902283
curr_Factors:  [95.08876679 -1.2926926  -0.91741709]
mat_Sqrt:  [[10.43015525  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054326 -0.02845143  0.0120735 ]
Stock Position:  -0.0005432607424709214
Bond Position:  [-12.10172651]


portfolio before change:  [-12.15679705]
curr_Stock_Price:  95.80064597745816
curr_Factors:  [95.80064598 -1.05978392 -0.90094633]
mat_Sqrt:  [[13.48447709  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03126289 0.01323611 0.03220787]
Stock Position:  0.03126288789663936
Bond Position:  [-15.1518019]


portfolio before change:  [-12.20654229]
curr_Stock_Price:  94.33063417588178
curr_Factors:  [94.33063418 -0.71341007 -0.87934164]
mat_Sqrt:  [[19.18357207  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01338339 -0.00515238  1.31757102]
Stock Position:  -0.013383392077056569
Bond Position:  [-10.94407842]


portfolio before change:  [-12.19070638]
curr_Stock_Price:  92.94292390653732
curr_Factors:  [92.94292391 -0.77759686 -0.88652697]
mat_Sqrt:  [[17.59934616  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330852  0.02545319 -0.05477387]
Stock Position:  -0.003308519221813268
Bond Position:  [-11.88320293]


portfolio before change:  [-12.19949704]
curr_Stock_Price:  94.70186536613214
curr_Factors:  [94.70186537 -0.98638553 -0.88424109]
mat_Sqrt:  [[14.58665515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263077 -0.01724423 -0.01059202]
Stock Position:  -0.002630770599319528
Bond Position:  [-11.95035816]


portfolio before change:  [-12.2122476]
curr_Stock_Price:  98.4127937579905
curr_Factors:  [98.41279376 -1.2243084  -0.9082084 ]
mat_Sqrt:  [[11.66571284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00697502 0.03250302 0.00497024]
Stock Position:  0.006975017993040811
Bond Position:  [-12.89867861]


portfolio before change:  [-12.2256408]
curr_Stock_Price:  96.95500185354423
curr_Factors:  [96.95500185 -1.18574916 -0.95907569]
mat_Sqrt:  [[11.35231998  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00456989 0.04502857 0.25083541]
Stock Position:  0.0045698925818279945
Bond Position:  [-12.66871475]


portfolio before change:  [-12.22145386]
curr_Stock_Price:  98.56434329847262
curr_Factors:  [98.5643433  -1.37937278 -0.99152235]
mat_Sqrt:  [[ 9.20562255  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00318495 -0.05506092 -0.05846817]
Stock Position:  0.0031849523949664736
Bond Position:  [-12.5353766]


portfolio before change:  [-12.22580739]
curr_Stock_Price:  98.18151266437772
curr_Factors:  [98.18151266 -1.05826487 -1.00688085]
mat_Sqrt:  [[12.44939742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00696602 -0.02698885  0.51612104]
Stock Position:  -0.006966022375805711
Bond Position:  [-11.54187278]


portfolio before change:  [-12.21641009]
curr_Stock_Price:  96.418220309073
curr_Factors:  [96.41822031 -1.34279933 -0.99877603]
mat_Sqrt:  [[ 9.2731195   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00383572 0.06772628 0.90388557]
Stock Position:  0.003835718235468327
Bond Position:  [-12.58624321]


portfolio before change:  [-12.22366514]
curr_Stock_Price:  95.34720767185958
curr_Factors:  [95.34720767 -1.02687359 -1.00977101]
mat_Sqrt:  [[12.43954423  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046653  0.00289417 -0.07886291]
Stock Position:  -0.0004665268001920599
Bond Position:  [-12.17918312]


portfolio before change:  [-12.22685628]
curr_Stock_Price:  95.6600773895708
curr_Factors:  [95.66007739 -1.63188001 -0.96665092]
mat_Sqrt:  [[ 7.11546171  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00919756 0.01484296 0.41198536]
Stock Position:  0.009197559117193119
Bond Position:  [-13.1066955]


portfolio before change:  [-12.23070499]
curr_Stock_Price:  95.59792846480062
curr_Factors:  [95.59792846 -1.43229887 -0.96866901]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.23070499]
Stock Price:  95.87675015433469
PL:  [-12.23070499]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.87542724e-01 -2.14219059e-02  4.44608924e-02]
 [-9.85373791e-02  1.37466359e-01  9.33295581e-02]
 [-4.74594847e-02 -2.96938663e-01  3.67148779e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 6.45014713e-01 -3.92284239e-01 -1.76485004e-01]
 [-8.14336083e-02  6.64957504e-02  2.53168954e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 2.37506448e-01  9.58592973e-03  5.49965807e-03]
 [-1.44503465e-01  1.38192598e-02  1.56387186e-01]
 [-1.78286475e-01  1.61500481e-01 -4.22381423e-03]
 [-6.74793881e-03 -7.84221554e-02  4.14264952e-03]
 [ 9.32383611e-02  1.08172073e-01 -1.51341612e-02]
 [ 5.33733415e-03  1.66650063e-01  6.81128102e-02]
 [-4.23004611e-02 -7.19695064e-02 -6.86098238e-02]
 [-1.00598585e-01 -7.32602976e-02  1.64144716e-01]
 [-2.46295162e-02  2.00826878e-01  2.93273340e-01]
 [-5.15552314e-02  1.18420293e-01  2.62249694e-02]
 [-1.33331935e-02 -9.14265847e-03  6.38286199e-02]
 [-3.74820530e-02  4.44323542e-01  1.57703413e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.3102117]
curr_Stock_Price:  101.39773617733667
curr_Factors:  [101.39773618  -0.95034473  -1.02002021]
mat_Sqrt:  [[14.1354499   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01266463 -0.0067742   0.12683455]
Stock Position:  -0.012664633591640204
Bond Position:  [13.59437688]


portfolio before change:  [12.33776764]
curr_Stock_Price:  99.49030455189711
curr_Factors:  [99.49030455 -1.27396913 -1.0095324 ]
mat_Sqrt:  [[10.1407166   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00748835  0.04347068  0.26624325]
Stock Position:  -0.007488346209806781
Bond Position:  [13.08278549]


portfolio before change:  [12.33835963]
curr_Stock_Price:  99.8480768983792
curr_Factors:  [99.8480769  -1.06574559 -0.9882608 ]
mat_Sqrt:  [[12.80253763  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00372051 -0.09390025  0.10473733]
Stock Position:  -0.0037205135693357846
Bond Position:  [12.70984575]


portfolio before change:  [12.34313336]
curr_Stock_Price:  99.4191379897087
curr_Factors:  [99.41913799 -0.81047927 -0.98255497]
mat_Sqrt:  [[16.54874705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00229285 -0.00455813 -0.02970002]
Stock Position:  -0.002292847735153809
Bond Position:  [12.5710863]


portfolio before change:  [12.34726817]
curr_Stock_Price:  98.98664241523531
curr_Factors:  [98.98664242 -1.15088457 -0.97838097]
mat_Sqrt:  [[11.77194765  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05087188 -0.12405117 -0.50346259]
Stock Position:  0.05087188159197865
Bond Position:  [7.31163142]


portfolio before change:  [12.33581514]
curr_Stock_Price:  98.72557154758293
curr_Factors:  [98.72557155 -0.84737612 -0.96279574]
mat_Sqrt:  [[16.15407174  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00461487  0.0210278   0.07222206]
Stock Position:  -0.004614867817393416
Bond Position:  [12.7914206]


portfolio before change:  [12.34639302]
curr_Stock_Price:  97.12647353444909
curr_Factors:  [97.12647353 -0.99726154 -0.98224751]
mat_Sqrt:  [[13.41676356  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042233 -0.02845143  0.0120735 ]
Stock Position:  -0.0004223294136812008
Bond Position:  [12.38741239]


portfolio before change:  [12.34907104]
curr_Stock_Price:  98.11910423704697
curr_Factors:  [98.11910424 -0.93814042 -0.99871416]
mat_Sqrt:  [[14.14452328  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01688827 0.00303134 0.01568899]
Stock Position:  0.0168882728677209
Bond Position:  [10.69200884]


portfolio before change:  [12.35249854]
curr_Stock_Price:  98.1637603726193
curr_Factors:  [98.16376037 -1.10111576 -1.01826986]
mat_Sqrt:  [[11.78999726  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0095186   0.00437003  0.44612911]
Stock Position:  -0.009518598701552602
Bond Position:  [13.28687999]


portfolio before change:  [12.34846567]
curr_Stock_Price:  98.93645950250057
curr_Factors:  [98.9364595  -1.02998296 -0.99820653]
mat_Sqrt:  [[13.01741821  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01344189  0.05107094 -0.01204937]
Stock Position:  -0.013441892223395101
Bond Position:  [13.67835889]


portfolio before change:  [12.36052776]
curr_Stock_Price:  98.2935384067245
curr_Factors:  [98.29353841 -1.11900082 -1.02122312]
mat_Sqrt:  [[11.56212126  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00068562 -0.02479926  0.01181783]
Stock Position:  -0.000685616003038763
Bond Position:  [12.42791938]


portfolio before change:  [12.36372034]
curr_Stock_Price:  98.1692469733543
curr_Factors:  [98.16924697 -0.60922915 -1.01657038]
mat_Sqrt:  [[19.31522163  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00481186  0.03420701 -0.04317355]
Stock Position:  0.004811858028689224
Bond Position:  [11.89134386]


portfolio before change:  [12.3680037]
curr_Stock_Price:  98.4415213771083
curr_Factors:  [98.44152138 -0.70702471 -1.02048621]
mat_Sqrt:  [[17.49564107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00134569 0.05269938 0.19430689]
Stock Position:  0.001345688868232428
Bond Position:  [12.23553204]


portfolio before change:  [12.37180887]
curr_Stock_Price:  98.99581860660965
curr_Factors:  [98.99581861 -0.67435962 -0.98285661]
mat_Sqrt:  [[18.87543581  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308145 -0.02275876 -0.19572473]
Stock Position:  -0.003081445535429879
Bond Position:  [12.6768591]


portfolio before change:  [12.37914908]
curr_Stock_Price:  97.6423639372631
curr_Factors:  [97.64236394 -1.14638735 -0.94885073]
mat_Sqrt:  [[12.01400887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00574198 -0.02316694  0.46825919]
Stock Position:  -0.005741984959317204
Bond Position:  [12.93981007]


portfolio before change:  [12.38289217]
curr_Stock_Price:  97.55393990849493
curr_Factors:  [97.55393991 -1.3622897  -0.9600184 ]
mat_Sqrt:  [[ 9.56487323  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00422588 0.06350704 0.83662721]
Stock Position:  0.004225877360181002
Bond Position:  [11.97064118]


portfolio before change:  [12.38616065]
curr_Stock_Price:  97.61912051955579
curr_Factors:  [97.61912052 -0.81720589 -0.96885163]
mat_Sqrt:  [[16.36288825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263673  0.03744778  0.07481254]
Stock Position:  -0.0026367278491730424
Bond Position:  [12.6435557]


portfolio before change:  [12.39103448]
curr_Stock_Price:  96.96962500611164
curr_Factors:  [96.96962501 -0.99668717 -0.9750995 ]
mat_Sqrt:  [[13.49893946  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.00248815e-05 -2.89116246e-03  1.82085286e-01]
Stock Position:  -4.0024881450440776e-05
Bond Position:  [12.39491567]


portfolio before change:  [12.39416447]
curr_Stock_Price:  96.19824797960997
curr_Factors:  [96.19824798 -1.0346892  -0.97282202]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.39416447]
Stock Price:  95.60139371879558
PL:  [12.39416447]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.37407479e-01 -7.01424794e-02  1.65688163e-01]
 [-4.27000167e-01  3.02325422e-01  1.19847096e-02]
 [-1.96211830e-01 -4.94801055e-01 -7.85414496e-02]
 [-1.00441781e-03  2.89586158e-01  2.26749004e-01]
 [ 6.03349611e-01 -3.66797695e-01 -1.69243098e-01]
 [-6.26320393e-02  6.20135975e-02  1.99808048e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 2.78182483e-01  1.55157653e-02  1.29854938e-02]
 [-1.22636874e-01  1.94488740e-02  1.11627358e-01]
 [-1.68215081e-01  1.48227252e-01 -1.20679417e-02]
 [-1.25068806e-02 -7.51755088e-02  5.53508450e-03]
 [ 8.02885844e-02  1.03026394e-01 -7.06064690e-03]
 [ 2.63035564e-02  1.50253876e-01  8.63439404e-02]
 [ 4.68603594e-02 -1.48850134e-01  4.37705897e-03]
 [-3.20050325e-02 -2.46381940e-02  9.81158129e-02]
 [-4.77168194e-02  2.56135835e-01  3.74878418e-01]
 [ 2.38057889e-02 -6.93218860e-02 -7.17270065e-02]
 [ 4.04936678e-02  4.81447872e-02  1.49284963e-01]
 [-5.05193555e-02  3.38324114e-01  5.87782018e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.10115341]
curr_Stock_Price:  98.97235341489774
curr_Factors:  [98.97235341 -0.99628024 -1.02397656]
mat_Sqrt:  [[13.12585243  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00802977 -0.022181    0.47266221]
Stock Position:  -0.008029771447824451
Bond Position:  [-4.30642804]


portfolio before change:  [-5.09549269]
curr_Stock_Price:  98.13329309184651
curr_Factors:  [98.13329309 -0.63298799 -1.00835442]
mat_Sqrt:  [[19.01036356  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02192214  0.09560369  0.03418904]
Stock Position:  -0.02192213676387145
Bond Position:  [-2.94420122]


portfolio before change:  [-5.08286001]
curr_Stock_Price:  97.52346099141322
curr_Factors:  [97.52346099 -0.49171773 -0.97715015]
mat_Sqrt:  [[22.4485291   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01002381 -0.15646983 -0.22405689]
Stock Position:  -0.010023807963905286
Bond Position:  [-4.10530357]


portfolio before change:  [-5.07525778]
curr_Stock_Price:  96.66264166548775
curr_Factors:  [96.66264167 -0.88673787 -0.94858949]
mat_Sqrt:  [[15.4236128   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00342057 0.09157518 0.64685179]
Stock Position:  0.003420574150419116
Bond Position:  [-5.40589951]


portfolio before change:  [-5.06954205]
curr_Stock_Price:  98.72877805700436
curr_Factors:  [98.72877806 -1.11665868 -0.95955595]
mat_Sqrt:  [[12.38098522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04517672 -0.11599162 -0.48280345]
Stock Position:  0.04517672239535558
Bond Position:  [-9.52978465]


portfolio before change:  [-5.05270603]
curr_Stock_Price:  99.15419106339496
curr_Factors:  [99.15419106 -1.11501285 -0.96494627]
mat_Sqrt:  [[12.38786057  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00459743  0.01961042  0.05699967]
Stock Position:  -0.004597427458276315
Bond Position:  [-4.59685183]


portfolio before change:  [-5.05329998]
curr_Stock_Price:  99.03338395581238
curr_Factors:  [99.03338396 -1.12604524 -0.9957353 ]
mat_Sqrt:  [[11.86599164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047752 -0.02845143  0.0120735 ]
Stock Position:  -0.0004775238394615945
Bond Position:  [-5.00600918]


portfolio before change:  [-5.05423079]
curr_Stock_Price:  98.36148730282514
curr_Factors:  [98.3614873  -1.28117612 -0.99152123]
mat_Sqrt:  [[10.1345663   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02774995 0.00490652 0.037044  ]
Stock Position:  0.02774995426590631
Bond Position:  [-7.78375757]


portfolio before change:  [-5.03997643]
curr_Stock_Price:  98.94529168646162
curr_Factors:  [98.94529169 -1.61654163 -0.98988484]
mat_Sqrt:  [[ 7.30194402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01360581  0.00615027  0.31844178]
Stock Position:  -0.013605810629989157
Bond Position:  [-3.69374553]


portfolio before change:  [-5.02752345]
curr_Stock_Price:  97.96214278682363
curr_Factors:  [97.96214279 -1.28195013 -0.96259499]
mat_Sqrt:  [[10.38161013  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01607181  0.04687357 -0.03442648]
Stock Position:  -0.01607180641612428
Bond Position:  [-3.45309485]


portfolio before change:  [-5.03900463]
curr_Stock_Price:  98.6227905296306
curr_Factors:  [98.62279053 -1.43483459 -0.9350058 ]
mat_Sqrt:  [[ 9.22080173  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144435 -0.02377258  0.01579006]
Stock Position:  -0.0014443494027991124
Bond Position:  [-4.89655886]


portfolio before change:  [-5.0393174]
curr_Stock_Price:  97.9916921946967
curr_Factors:  [97.99169219 -1.52530048 -0.91022019]
mat_Sqrt:  [[ 8.57938329  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00950039  0.03257981 -0.02014206]
Stock Position:  0.009500387521914767
Bond Position:  [-5.97027645]


portfolio before change:  [-5.0428515]
curr_Stock_Price:  97.77682270247607
curr_Factors:  [97.7768227  -1.27880523 -0.88650485]
mat_Sqrt:  [[11.21640547  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00426233 0.04751445 0.24631523]
Stock Position:  0.004262326104820055
Bond Position:  [-5.4596082]


portfolio before change:  [-5.04237476]
curr_Stock_Price:  98.20893568960257
curr_Factors:  [98.20893569 -1.24557659 -0.90194115]
mat_Sqrt:  [[11.46821702  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00382889 -0.04707055  0.01248653]
Stock Position:  0.0038288889065333587
Bond Position:  [-5.41840587]


portfolio before change:  [-5.0497033]
curr_Stock_Price:  96.64875173856184
curr_Factors:  [96.64875174 -1.49263903 -0.88487473]
mat_Sqrt:  [[ 8.96716467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00140662 -0.00779128  0.2798971 ]
Stock Position:  -0.0014066186980920214
Bond Position:  [-4.91375536]


portfolio before change:  [-5.05096878]
curr_Stock_Price:  96.67497330665857
curr_Factors:  [96.67497331 -1.62221528 -0.85148963]
mat_Sqrt:  [[ 8.14699916  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00434741 0.08099726 1.06942378]
Stock Position:  0.004347406381307933
Bond Position:  [-5.47125418]


portfolio before change:  [-5.05359315]
curr_Stock_Price:  96.38597790851223
curr_Factors:  [96.38597791 -1.64069904 -0.84395853]
mat_Sqrt:  [[ 8.03416571  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00091792 -0.02192151 -0.20461718]
Stock Position:  0.0009179162960927727
Bond Position:  [-5.14206741]


portfolio before change:  [-5.05570132]
curr_Stock_Price:  95.48992796181433
curr_Factors:  [95.48992796 -1.65863555 -0.86334208]
mat_Sqrt:  [[ 7.66790276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0094171  0.01522472 0.42586845]
Stock Position:  0.009417102517789594
Bond Position:  [-5.95493976]


portfolio before change:  [-5.05700013]
curr_Stock_Price:  95.51011590422884
curr_Factors:  [95.5101159  -1.98482479 -0.87902454]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.05700013]
Stock Price:  95.07713450839539
PL:  [-5.05700013]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.60149093e-01 -4.47911957e-02  1.22194820e-01]
 [-1.84333015e-01  1.65383116e-01  5.64492563e-03]
 [-1.20947614e-01 -4.18239827e-01 -3.09003510e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 2.79373046e-01 -2.31867312e-01 -2.00639826e-01]
 [ 1.05004490e-01 -3.48095516e-02 -3.65621327e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-2.39105426e-02 -3.52115328e-02 -1.39540010e-02]
 [-4.18684901e-04  1.88154146e-02 -9.31642118e-02]
 [-3.49402686e-01  3.48741056e-01  4.84340954e-02]
 [ 1.15094348e-01 -1.76459438e-01  3.19466901e-02]
 [-1.06585514e-01  4.44732043e-03  1.32613410e-04]
 [-5.89971675e-02  1.93636989e-01  3.12508034e-03]
 [-5.39904307e-02 -9.38673480e-02 -2.52404644e-02]
 [-1.38926924e-01 -1.09530604e-01  2.34164368e-01]
 [-1.67886645e-02 -1.28630232e-02 -8.60159099e-02]
 [-9.07426056e-02  5.52215964e-02  7.98414965e-02]
 [-2.90952574e-02  6.24410227e-03  2.04639803e-02]
 [-5.00870315e-03  5.89849317e-01  3.90256535e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.63973485]
curr_Stock_Price:  99.59382379366565
curr_Factors:  [99.59382379 -0.87284281 -0.99119727]
mat_Sqrt:  [[15.44152124  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01530696 -0.01416422  0.34858781]
Stock Position:  -0.015306955845890487
Bond Position:  [0.88474341]


portfolio before change:  [-0.63878705]
curr_Stock_Price:  99.54635616411716
curr_Factors:  [99.54635616 -0.62405812 -0.97355935]
mat_Sqrt:  [[20.14600406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0088807   0.05229873  0.0161034 ]
Stock Position:  -0.008880697881992606
Bond Position:  [0.24525406]


portfolio before change:  [-0.63130234]
curr_Stock_Price:  98.71045469924829
curr_Factors:  [98.7104547  -0.90650573 -0.95105646]
mat_Sqrt:  [[15.40402253  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00896221 -0.13225905 -0.0881501 ]
Stock Position:  -0.008962206301285115
Bond Position:  [0.25336111]


portfolio before change:  [-0.64665144]
curr_Stock_Price:  100.43017021424143
curr_Factors:  [100.43017021  -0.59849926  -0.93228688]
mat_Sqrt:  [[21.72962459  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174618 -0.00455813 -0.02970002]
Stock Position:  -0.001746176379959781
Bond Position:  [-0.47128265]


portfolio before change:  [-0.64853312]
curr_Stock_Price:  101.4402898464404
curr_Factors:  [101.44028985  -0.48052271  -0.9634866 ]
mat_Sqrt:  [[23.93785368  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00970976 -0.07332288 -0.57236958]
Stock Position:  0.009709760461780998
Bond Position:  [-1.63349404]


portfolio before change:  [-0.65210611]
curr_Stock_Price:  101.11437387829275
curr_Factors:  [101.11437388  -0.4204629   -0.97312114]
mat_Sqrt:  [[25.0949907   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00385107 -0.01100775 -0.10430159]
Stock Position:  0.003851067273577878
Bond Position:  [-1.04150437]


portfolio before change:  [-0.65891572]
curr_Stock_Price:  99.41375594164296
curr_Factors:  [99.41375594 -0.50670983 -0.9362192 ]
mat_Sqrt:  [[23.48498935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024127 -0.02845143  0.0120735 ]
Stock Position:  -0.00024127300221440156
Bond Position:  [-0.63492986]


portfolio before change:  [-0.65917794]
curr_Stock_Price:  99.84262713961397
curr_Factors:  [99.84262714 -0.48812013 -0.90721938]
mat_Sqrt:  [[24.73590192  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111854 -0.01113486 -0.03980688]
Stock Position:  -0.0011185381114895531
Bond Position:  [-0.54750016]


portfolio before change:  [-0.66213314]
curr_Stock_Price:  102.36225762322123
curr_Factors:  [102.36225762  -0.30001714  -0.91553134]
mat_Sqrt:  [[30.35525304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00062427  0.00594996 -0.26577156]
Stock Position:  -0.0006242721171953072
Bond Position:  [-0.59823124]


portfolio before change:  [-0.66381793]
curr_Stock_Price:  104.82145711917663
curr_Factors:  [104.82145712  -0.26636093  -0.93368753]
mat_Sqrt:  [[31.57008625  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01046914  0.1102816   0.13816899]
Stock Position:  -0.010469140312566265
Bond Position:  [0.43357262]


portfolio before change:  [-0.64128745]
curr_Stock_Price:  102.67972724304872
curr_Factors:  [102.67972724  -0.15457464  -0.90601838]
mat_Sqrt:  [[35.55289816  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00329254 -0.05580137  0.09113501]
Stock Position:  0.0032925382212361616
Bond Position:  [-0.97936437]


portfolio before change:  [-0.63414233]
curr_Stock_Price:  104.9241946981514
curr_Factors:  [104.9241947   -0.28570411  -0.90376983]
mat_Sqrt:  [[31.93696749  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00333293  0.00140637  0.00037831]
Stock Position:  -0.003332928063658647
Bond Position:  [-0.28443753]


portfolio before change:  [-0.62958151]
curr_Stock_Price:  103.53444625221113
curr_Factors:  [ 1.03534446e+02 -6.41430050e-02 -8.97237666e-01]
mat_Sqrt:  [[39.58790729  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00134788  0.06123339  0.00891498]
Stock Position:  -0.0013478756841273447
Bond Position:  [-0.49002995]


portfolio before change:  [-0.6255247]
curr_Stock_Price:  100.43376287800527
curr_Factors:  [ 1.00433763e+02 -2.57860673e-02 -9.20940420e-01]
mat_Sqrt:  [[38.96921391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00157987 -0.02968346 -0.07200402]
Stock Position:  -0.001579869267217416
Bond Position:  [-0.46685248]


portfolio before change:  [-0.63067482]
curr_Stock_Price:  103.6197189008263
curr_Factors:  [103.6197189   -0.32351875  -0.88705022]
mat_Sqrt:  [[30.8815428   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304248 -0.03463662  0.66800576]
Stock Position:  -0.0030424772330231004
Bond Position:  [-0.31541419]


portfolio before change:  [-0.64233576]
curr_Stock_Price:  107.42650944095709
curr_Factors:  [107.42650944  -0.44734639  -0.9068685 ]
mat_Sqrt:  [[27.73214154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00125049 -0.00406765 -0.24537945]
Stock Position:  -0.0012504880074437766
Bond Position:  [-0.5080002]


portfolio before change:  [-0.64451792]
curr_Stock_Price:  109.06998706103045
curr_Factors:  [109.06998706  -0.82441519  -0.93741187]
mat_Sqrt:  [[18.73067779  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00389838  0.0174626   0.22776557]
Stock Position:  -0.0038983753626792633
Bond Position:  [-0.21932217]


portfolio before change:  [-0.6418581]
curr_Stock_Price:  108.3736302701448
curr_Factors:  [108.37363027  -0.49187089  -0.922767  ]
mat_Sqrt:  [[26.33626548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094003  0.00197456  0.05837804]
Stock Position:  -0.0009400286034985711
Bond Position:  [-0.53998379]


portfolio before change:  [-0.63913607]
curr_Stock_Price:  105.33431765944063
curr_Factors:  [105.33431766  -0.51967936  -0.88484656]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.63913607]
Stock Price:  105.41124699251071
PL:  [-6.05038306]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.02762641e-01 -3.26362800e-02  9.80514218e-02]
 [-1.06776171e-02  9.12523874e-02  1.05805120e-01]
 [-4.96085688e-02 -2.63404616e-01  4.38278438e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 4.57607638e-01 -3.19197050e-01 -2.05948234e-01]
 [ 9.35977696e-03  3.56326778e-02 -2.62037894e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 6.41126313e-02 -2.13174507e-02  7.30547752e-04]
 [-4.60442911e-02  2.75026985e-02  1.80522407e-02]
 [-4.61329752e-01  4.39342938e-01  5.41938026e-02]
 [ 2.52433870e-02 -9.78944543e-02  7.66144984e-03]
 [-7.52215650e-02  2.32962515e-02 -8.19075316e-03]
 [-6.89744191e-03  1.57917683e-01  5.03767745e-02]
 [-8.07211329e-03 -1.81666837e-01 -8.51765989e-02]
 [-1.97573252e-01 -1.29408675e-01  2.42004183e-01]
 [ 3.03360337e-02  1.34518520e-01  2.20212777e-01]
 [-8.73756681e-02  8.49412277e-02  4.77934642e-02]
 [-4.68698716e-02 -4.59824604e-02  2.20556474e-02]
 [-2.92837184e-02  5.03235159e-01  2.47484333e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.20779328]
curr_Stock_Price:  99.85118229859472
curr_Factors:  [99.8511823  -0.77666539 -0.99845757]
mat_Sqrt:  [[16.92104208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01675964 -0.0103205   0.27971341]
Stock Position:  -0.016759644133560785
Bond Position:  [2.88126357]


portfolio before change:  [1.19604842]
curr_Stock_Price:  100.59494924666102
curr_Factors:  [100.59494925  -1.38705407  -0.99910943]
mat_Sqrt:  [[ 9.25291421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00143478 0.02885654 0.30183256]
Stock Position:  0.0014347792234243868
Bond Position:  [1.05171688]


portfolio before change:  [1.19639603]
curr_Stock_Price:  100.65394737085592
curr_Factors:  [100.65394737  -1.50629092  -0.99467796]
mat_Sqrt:  [[ 8.25417795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00575022 -0.08329585  0.12502864]
Stock Position:  -0.0057502183557575194
Bond Position:  [1.77517821]


portfolio before change:  [1.1968106]
curr_Stock_Price:  100.65903978801117
curr_Factors:  [100.65903979  -1.32575345  -0.99408638]
mat_Sqrt:  [[ 9.89370931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00383514 -0.00455813 -0.02970002]
Stock Position:  -0.0038351396850463703
Bond Position:  [1.58285208]


portfolio before change:  [1.19631983]
curr_Stock_Price:  100.89019915242446
curr_Factors:  [100.89019915  -1.09405782  -1.00474725]
mat_Sqrt:  [[12.36942527  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03293015 -0.10093897 -0.58751299]
Stock Position:  0.03293014745538363
Bond Position:  [-2.1260093]


portfolio before change:  [1.1778793]
curr_Stock_Price:  100.34635193939133
curr_Factors:  [100.34635194  -1.42964498  -0.99266309]
mat_Sqrt:  [[ 8.90238882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00055389  0.01126804 -0.07475212]
Stock Position:  0.0005538943233470862
Bond Position:  [1.12229802]


portfolio before change:  [1.17820966]
curr_Stock_Price:  100.43617213784849
curr_Factors:  [100.43617214  -1.53039986  -0.9746569 ]
mat_Sqrt:  [[ 8.20271886  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069078 -0.02845143  0.0120735 ]
Stock Position:  -0.0006907824080735612
Bond Position:  [1.2475892]


portfolio before change:  [1.17830102]
curr_Stock_Price:  100.75547472667705
curr_Factors:  [100.75547473  -1.86157164  -0.97995689]
mat_Sqrt:  [[ 5.8777146   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01083947 -0.00674117  0.00208405]
Stock Position:  0.010839474831402783
Bond Position:  [0.08616459]


portfolio before change:  [1.18162519]
curr_Stock_Price:  101.06015924751419
curr_Factors:  [101.06015925  -2.31733169  -1.00062046]
mat_Sqrt:  [[ 3.66110066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01137616  0.00869712  0.05149802]
Stock Position:  -0.011376162546629215
Bond Position:  [2.33130199]


portfolio before change:  [1.17950688]
curr_Stock_Price:  101.29760370086751
curr_Factors:  [101.2976037   -2.24124222  -1.08454698]
mat_Sqrt:  [[ 3.64105528  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12054849  0.13893244  0.15459983]
Stock Position:  -0.12054848617165902
Bond Position:  [13.39077966]


portfolio before change:  [1.24223987]
curr_Stock_Price:  100.80498138706503
curr_Factors:  [100.80498139  -1.96399795  -1.02787449]
mat_Sqrt:  [[ 5.0597412   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0047986  -0.03095694  0.02185598]
Stock Position:  0.004798595227348561
Bond Position:  [0.75851756]


portfolio before change:  [1.24150825]
curr_Stock_Price:  100.61299491603836
curr_Factors:  [100.61299492  -1.74636727  -1.01445051]
mat_Sqrt:  [[ 6.36276891  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01199038  0.00736692 -0.02336594]
Stock Position:  -0.011990375558692862
Bond Position:  [2.44789585]


portfolio before change:  [1.24401232]
curr_Stock_Price:  100.45520064912145
curr_Factors:  [100.45520065  -1.36322707  -1.03809594]
mat_Sqrt:  [[ 9.10104146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00082003 0.04993796 0.14371092]
Stock Position:  0.0008200260607989726
Bond Position:  [1.16163644]


portfolio before change:  [1.24439783]
curr_Stock_Price:  100.57112697097625
curr_Factors:  [100.57112697  -1.77333871  -1.02017568]
mat_Sqrt:  [[ 6.15552972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00489793 -0.0574481  -0.24298513]
Stock Position:  -0.004897926363101531
Bond Position:  [1.7369878]


portfolio before change:  [1.24288431]
curr_Stock_Price:  100.96880975726785
curr_Factors:  [100.96880976  -1.71597037  -0.99734689]
mat_Sqrt:  [[ 6.69589323  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02262815 -0.04092262  0.69037057]
Stock Position:  -0.022628149395777102
Bond Position:  [3.52762162]


portfolio before change:  [1.22870315]
curr_Stock_Price:  101.63449261091299
curr_Factors:  [101.63449261  -1.73290211  -1.02853694]
mat_Sqrt:  [[ 6.4233765   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01226147 0.04253849 0.62820576]
Stock Position:  0.012261468988799342
Bond Position:  [-0.01748503]


portfolio before change:  [1.22281364]
curr_Stock_Price:  101.15452282890581
curr_Factors:  [101.15452283  -1.30481497  -0.97451243]
mat_Sqrt:  [[10.35347158  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00728516  0.02686077  0.13634145]
Stock Position:  -0.007285159802640516
Bond Position:  [1.95974051]


portfolio before change:  [1.22096376]
curr_Stock_Price:  101.47570710360644
curr_Factors:  [101.4757071   -1.27727267  -0.99939377]
mat_Sqrt:  [[10.41402023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00418235 -0.01454093  0.06291862]
Stock Position:  -0.004182346734080625
Bond Position:  [1.64537035]


portfolio before change:  [1.2195452]
curr_Stock_Price:  101.91324991609987
curr_Factors:  [101.91324992  -1.1178761   -1.00015049]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.2195452]
Stock Price:  101.66051541905902
PL:  [-0.44097022]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.83229368e-01 -2.10020862e-02  4.24546850e-02]
 [ 6.82090929e-02  2.69801463e-02  1.70853324e-02]
 [-2.69069168e-02 -2.25569083e-01  1.41477172e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.81881359e-01 -3.21454055e-01 -2.88284791e-01]
 [-7.06281139e-02 -6.16219178e-02 -1.11505953e-01]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 1.06331166e-01 -1.51361552e-02  7.27889314e-03]
 [-7.21740161e-02  2.47756828e-02  4.72094007e-02]
 [-3.54204338e-01  3.36237374e-01  5.55590075e-02]
 [-1.58398733e-03 -8.21538875e-02  9.32017612e-03]
 [-8.40852208e-02  1.60315371e-02 -3.23820065e-02]
 [ 1.16575875e-02  1.46241613e-01  6.76105442e-02]
 [ 1.22027460e-02 -1.99908456e-01 -6.79678175e-02]
 [-1.65717643e-01 -1.12654312e-01  2.21139239e-01]
 [ 1.78632687e-02  1.56833443e-01  2.49071173e-01]
 [-4.55933673e-02  1.06053185e-01  1.17026509e-02]
 [-4.89917129e-02 -5.19934799e-02  2.21044739e-02]
 [-3.88062033e-02  4.26250914e-01  1.61097284e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.8957246]
curr_Stock_Price:  101.61859626598144
curr_Factors:  [101.61859627  -1.00526717  -1.02186952]
mat_Sqrt:  [[13.38440029  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01308281 -0.00664144  0.1211114 ]
Stock Position:  -0.013082813509364915
Bond Position:  [15.22518174]


portfolio before change:  [13.9073278]
curr_Stock_Price:  101.02266722216063
curr_Factors:  [101.02266722  -0.78950745  -1.00211486]
mat_Sqrt:  [[16.83942065  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00429903 0.00853187 0.0487397 ]
Stock Position:  0.004299034250175384
Bond Position:  [13.47302789]


portfolio before change:  [13.92182497]
curr_Stock_Price:  103.61127178445298
curr_Factors:  [103.61127178  -1.02179781  -1.01787664]
mat_Sqrt:  [[13.47682679  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221441 -0.07133121  0.0403595 ]
Stock Position:  -0.00221440813006902
Bond Position:  [14.15126262]


portfolio before change:  [13.9254237]
curr_Stock_Price:  103.58396632689467
curr_Factors:  [103.58396633  -1.28280845  -1.02477773]
mat_Sqrt:  [[10.30672274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00368146 -0.00455813 -0.02970002]
Stock Position:  -0.003681457061592088
Bond Position:  [14.30676362]


portfolio before change:  [13.9298709]
curr_Stock_Price:  103.34762896047799
curr_Factors:  [103.34762896  -1.56218212  -0.9950213 ]
mat_Sqrt:  [[ 8.01163554  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03928481 -0.1016527  -0.82239627]
Stock Position:  0.03928480810464717
Bond Position:  [9.86987913]


portfolio before change:  [13.92441183]
curr_Stock_Price:  103.14585001974153
curr_Factors:  [103.14585002  -1.45615673  -0.97124408]
mat_Sqrt:  [[ 9.10426701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0104325  -0.01948656 -0.31809545]
Stock Position:  -0.01043249745065931
Bond Position:  [15.00048065]


portfolio before change:  [13.94609042]
curr_Stock_Price:  101.42737394277596
curr_Factors:  [101.42737394  -1.19031444  -0.93838558]
mat_Sqrt:  [[12.06903404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046949 -0.02845143  0.0120735 ]
Stock Position:  -0.0004694902565620385
Bond Position:  [13.99370958]


portfolio before change:  [13.95032862]
curr_Stock_Price:  99.85260878794294
curr_Factors:  [99.85260879 -1.3006183  -0.88570932]
mat_Sqrt:  [[11.21629426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00957769 -0.00478647  0.02076466]
Stock Position:  0.009577686494848893
Bond Position:  [12.99397164]


portfolio before change:  [13.95274475]
curr_Stock_Price:  99.76565954266984
curr_Factors:  [99.76565954 -1.48713733 -0.92945268]
mat_Sqrt:  [[ 8.90162662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00695353  0.00783476  0.13467528]
Stock Position:  -0.006953530496033413
Bond Position:  [14.6464683]


portfolio before change:  [13.95307823]
curr_Stock_Price:  100.24435016033688
curr_Factors:  [100.24435016  -1.93491856  -0.93236293]
mat_Sqrt:  [[ 5.69921938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05863641  0.10632759  0.15849438]
Stock Position:  -0.058636414774499
Bond Position:  [19.83104753]


portfolio before change:  [13.97191314]
curr_Stock_Price:  100.00769650212025
curr_Factors:  [100.0076965   -2.12077054  -0.96122267]
mat_Sqrt:  [[ 4.58712716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.000393   -0.02597934  0.02658787]
Stock Position:  -0.00039299512187916533
Bond Position:  [14.01121567]


portfolio before change:  [13.975471]
curr_Stock_Price:  99.86871708219215
curr_Factors:  [99.86871708 -1.90948734 -0.99883048]
mat_Sqrt:  [[ 5.44958074  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01656664  0.00506962 -0.09237685]
Stock Position:  -0.016566639170807643
Bond Position:  [15.62996]


portfolio before change:  [13.98182002]
curr_Stock_Price:  99.72136983616109
curr_Factors:  [99.72136984 -1.86476962 -0.99131458]
mat_Sqrt:  [[ 5.73332588  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00509904 0.04624566 0.19287406]
Stock Position:  0.005099042827015877
Bond Position:  [13.47333649]


portfolio before change:  [13.98894996]
curr_Stock_Price:  100.45899433337058
curr_Factors:  [100.45899433  -1.91500809  -1.00292037]
mat_Sqrt:  [[ 5.42935951  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00125848 -0.0632166  -0.19389326]
Stock Position:  -0.0012584800855797735
Bond Position:  [14.1153756]


portfolio before change:  [13.99214314]
curr_Stock_Price:  100.72606745009325
curr_Factors:  [100.72606745  -1.52037169  -1.02393462]
mat_Sqrt:  [[ 7.90976692  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0156119  -0.03562442  0.63084869]
Stock Position:  -0.01561190206638425
Bond Position:  [15.56466864]


portfolio before change:  [13.99873876]
curr_Stock_Price:  100.5528680628434
curr_Factors:  [100.55286806  -1.70701016  -0.99849397]
mat_Sqrt:  [[ 6.72061395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01082552 0.04959509 0.71053073]
Stock Position:  0.010825518563466204
Bond Position:  [12.91020182]


portfolio before change:  [14.01085221]
curr_Stock_Price:  101.37366000627131
curr_Factors:  [101.37366001  -2.0307208   -1.05564126]
mat_Sqrt:  [[ 4.62951097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00874094  0.03353696  0.03338441]
Stock Position:  -0.008740943169407624
Bond Position:  [14.89695361]


portfolio before change:  [14.01846641]
curr_Stock_Price:  100.92868580029906
curr_Factors:  [100.9286858   -1.91897671  -1.03075965]
mat_Sqrt:  [[ 5.28397061  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00867191 -0.01644178  0.06305791]
Stock Position:  -0.008671910832854512
Bond Position:  [14.89371098]


portfolio before change:  [14.01808542]
curr_Stock_Price:  101.40204022811854
curr_Factors:  [101.40204023  -1.7783123   -1.10405218]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.01808542]
Stock Price:  101.64272336164892
PL:  [12.37536206]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.86964854e-01 -4.71926534e-02  1.34104899e-01]
 [ 1.88897620e-02  6.40004507e-02  5.86805981e-02]
 [ 3.87370629e-04 -8.36493264e-02  3.54344234e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 4.57313325e-01 -3.00572624e-01 -1.65072948e-01]
 [ 4.94918945e-02  2.46965061e-02  9.89045423e-04]
 [-3.06181087e-03 -8.80421008e-02  3.92515869e-03]
 [-7.21092462e-03 -3.32540583e-02 -6.53260566e-03]
 [-8.04461418e-02  2.39024855e-02  5.77691164e-02]
 [-2.98696598e-01  2.84048466e-01  2.77043189e-02]
 [ 6.72734456e-02 -1.22207793e-01  2.34371365e-03]
 [-1.33547636e-02  5.79043022e-02  3.88480729e-02]
 [-3.06581781e-02  1.73818382e-01  2.86759708e-02]
 [-7.44100434e-02 -8.00604081e-02  3.37488165e-02]
 [-1.56448413e-01 -1.13770684e-01  2.31770812e-01]
 [ 1.84501470e-02  7.34283660e-02  8.30558791e-02]
 [-1.22862954e-01  3.62857354e-02  6.45958785e-02]
 [-4.82396533e-02 -4.98629940e-02  2.20871953e-02]
 [-2.18675809e-02  5.68525602e-01  2.84114810e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.38518731]
curr_Stock_Price:  99.62928196796771
curr_Factors:  [99.62928197 -1.00574507 -1.0255257 ]
mat_Sqrt:  [[13.06824649  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01995748 -0.01492363  0.38256395]
Stock Position:  -0.019957483606789894
Bond Position:  [1.60316245]


portfolio before change:  [-0.40268169]
curr_Stock_Price:  100.5259493463004
curr_Factors:  [100.52594935  -1.06560146  -1.05546419]
mat_Sqrt:  [[12.05344185  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00269802 0.02023872 0.16739941]
Stock Position:  0.002698015541839715
Bond Position:  [-0.67390227]


portfolio before change:  [-0.40194864]
curr_Stock_Price:  100.8601017051938
curr_Factors:  [100.86010171  -0.85383581  -1.04849012]
mat_Sqrt:  [[15.05045908  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00036282 -0.02645224  0.10108455]
Stock Position:  0.000362817883045152
Bond Position:  [-0.43854249]


portfolio before change:  [-0.4020337]
curr_Stock_Price:  100.92789227116131
curr_Factors:  [100.92789227  -0.69721875  -1.00612073]
mat_Sqrt:  [[18.37639284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00206481 -0.00455813 -0.02970002]
Stock Position:  -0.002064809864049974
Bond Position:  [-0.19363679]


portfolio before change:  [-0.40071922]
curr_Stock_Price:  100.26783753749923
curr_Factors:  [100.26783754  -0.77205901  -1.02772493]
mat_Sqrt:  [[16.57774343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02508527 -0.09504941 -0.47090717]
Stock Position:  0.02508527172179805
Bond Position:  [-2.91596517]


portfolio before change:  [-0.40834688]
curr_Stock_Price:  99.99283266955696
curr_Factors:  [99.99283267 -0.74295466 -1.02155394]
mat_Sqrt:  [[17.1258654   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00293891 0.00780972 0.00282147]
Stock Position:  0.0029389138822725506
Bond Position:  [-0.7022172]


portfolio before change:  [-0.40532333]
curr_Stock_Price:  101.08137287617963
curr_Factors:  [101.08137288  -0.53351643  -1.01295656]
mat_Sqrt:  [[21.53011992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00021058 -0.02784136  0.01119739]
Stock Position:  -0.00021058073507160995
Bond Position:  [-0.38403754]


portfolio before change:  [-0.40517907]
curr_Stock_Price:  99.94032942697869
curr_Factors:  [99.94032943 -0.84223463 -1.00052901]
mat_Sqrt:  [[15.82846116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00059406 -0.01051586 -0.01863571]
Stock Position:  -0.0005940566911735954
Bond Position:  [-0.34580885]


portfolio before change:  [-0.40485398]
curr_Stock_Price:  99.24754499976277
curr_Factors:  [99.247545   -0.96932625 -0.98896181]
mat_Sqrt:  [[14.00380565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00485846  0.00755863  0.16479921]
Stock Position:  -0.004858458651298941
Bond Position:  [0.07733611]


portfolio before change:  [-0.41291092]
curr_Stock_Price:  100.9098583969681
curr_Factors:  [100.9098584   -1.26229238  -1.01600185]
mat_Sqrt:  [[10.3391059   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02763366  0.08982401  0.07903271]
Stock Position:  -0.027633663879376217
Bond Position:  [2.37559819]


portfolio before change:  [-0.41734162]
curr_Stock_Price:  101.09168996116956
curr_Factors:  [101.09168996  -1.258407    -0.99772242]
mat_Sqrt:  [[10.58987658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00609983 -0.0386455   0.00668596]
Stock Position:  0.006099831471793535
Bond Position:  [-1.03398389]


portfolio before change:  [-0.4132814]
curr_Stock_Price:  101.79970076114606
curr_Factors:  [101.79970076  -0.98915826  -1.00312028]
mat_Sqrt:  [[13.88388237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00028305  0.01831095  0.11082274]
Stock Position:  -0.00028305132271844673
Bond Position:  [-0.38446686]


portfolio before change:  [-0.41335093]
curr_Stock_Price:  101.70571885317766
curr_Factors:  [101.70571885  -0.79612125  -1.03652671]
mat_Sqrt:  [[16.27183293  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124858  0.0549662   0.08180456]
Stock Position:  -0.001248583909908046
Bond Position:  [-0.28636281]


portfolio before change:  [-0.41480389]
curr_Stock_Price:  102.81205705509737
curr_Factors:  [102.81205706  -0.93376347  -1.06441161]
mat_Sqrt:  [[13.93951411  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00499216 -0.02531732  0.09627598]
Stock Position:  -0.004992157214730795
Bond Position:  [0.09845007]


portfolio before change:  [-0.40977974]
curr_Stock_Price:  101.8105799800215
curr_Factors:  [101.81057998  -0.80177152  -1.08977193]
mat_Sqrt:  [[15.35698746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00729804 -0.03597745  0.66117761]
Stock Position:  -0.007298042039185619
Bond Position:  [0.33323815]


portfolio before change:  [-0.40901387]
curr_Stock_Price:  101.71705556846
curr_Factors:  [101.71705557  -0.69396473  -1.10674237]
mat_Sqrt:  [[16.80183153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00221998 0.02322009 0.2369353 ]
Stock Position:  0.002219982359188748
Bond Position:  [-0.63482394]


portfolio before change:  [-0.41133071]
curr_Stock_Price:  100.7449278533857
curr_Factors:  [100.74492785  -0.84791252  -1.09653807]
mat_Sqrt:  [[14.41315414  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00754453  0.01147456  0.18427406]
Stock Position:  -0.007544530543775264
Bond Position:  [0.34874248]


portfolio before change:  [-0.4099965]
curr_Stock_Price:  100.57964113846522
curr_Factors:  [100.57964114  -0.3011108   -1.06641089]
mat_Sqrt:  [[25.62140595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175707 -0.01576806  0.06300862]
Stock Position:  -0.0017570690895204876
Bond Position:  [-0.23327112]


portfolio before change:  [-0.40778276]
curr_Stock_Price:  99.28654030437123
curr_Factors:  [99.2865403  -0.23910861 -1.04751823]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.40778276]
Stock Price:  99.70479776422678
PL:  [-0.40778276]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.38467870e-01 -5.90467594e-02  1.56244867e-01]
 [-8.70358035e-02  1.31416565e-01  9.49627132e-02]
 [-6.57005042e-02 -4.09722639e-01  2.59196859e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 6.83780695e-01 -4.33309760e-01 -2.20654757e-01]
 [ 2.15129525e-02  3.57172982e-02 -2.20833661e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 1.95451680e-01 -1.00760549e-04  1.42214253e-02]
 [-8.34521697e-02  2.35851722e-02  6.16064373e-02]
 [-2.32429707e-01  2.14459889e-01  1.64955082e-02]
 [ 1.86639884e-02 -9.36781652e-02  5.28073355e-03]
 [ 1.68014641e-02  7.39112287e-02  1.32693816e-02]
 [ 1.34613656e-04  1.54333012e-01  5.72340104e-02]
 [ 5.16384618e-02 -1.88537074e-01 -1.00394865e-02]
 [-1.49129802e-01 -1.00455456e-01  2.00588337e-01]
 [-2.06496142e-02  2.29956603e-01  3.49657355e-01]
 [ 7.25986725e-03 -1.57730317e-02 -4.76844508e-02]
 [-4.64417186e-02 -4.57071477e-02  2.26380131e-02]
 [-4.45025903e-02  3.84747360e-01  1.12069327e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.90071054]
curr_Stock_Price:  99.4181713580894
curr_Factors:  [99.41817136 -1.06605739 -0.99338161]
mat_Sqrt:  [[12.67835122  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01641374 -0.01867222  0.44572311]
Stock Position:  -0.016413735305279478
Bond Position:  [-0.26888699]


portfolio before change:  [-1.90625355]
curr_Stock_Price:  99.75178123137852
curr_Factors:  [99.75178123 -1.47723192 -1.00779541]
mat_Sqrt:  [[ 8.31164536  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00773114  0.04155757  0.27090219]
Stock Position:  -0.007731135877084413
Bond Position:  [-1.13505898]


portfolio before change:  [-1.90651754]
curr_Stock_Price:  99.74921884723956
curr_Factors:  [99.74921885 -1.40086027 -1.00910392]
mat_Sqrt:  [[ 8.95932631  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00792344 -0.12956567  0.07394165]
Stock Position:  -0.007923437660225232
Bond Position:  [-1.11616082]


portfolio before change:  [-1.91032365]
curr_Stock_Price:  100.19435757345636
curr_Factors:  [100.19435757  -1.47257836  -1.02064849]
mat_Sqrt:  [[ 8.28034819  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00458239 -0.00455813 -0.02970002]
Stock Position:  -0.004582386674852298
Bond Position:  [-1.45119436]


portfolio before change:  [-1.91134861]
curr_Stock_Price:  100.33885041781924
curr_Factors:  [100.33885042  -1.50594242  -1.0203569 ]
mat_Sqrt:  [[ 8.02252848  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07822368 -0.13702458 -0.6294666 ]
Stock Position:  0.07822368267100048
Bond Position:  [-9.76022301]


portfolio before change:  [-1.93180221]
curr_Stock_Price:  100.10857190602422
curr_Factors:  [100.10857191  -1.65896666  -1.0192295 ]
mat_Sqrt:  [[ 6.87615176  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00260719  0.0112948  -0.0629977 ]
Stock Position:  0.002607188085180363
Bond Position:  [-2.19280408]


portfolio before change:  [-1.93303378]
curr_Stock_Price:  99.84648638839899
curr_Factors:  [99.84648639 -1.49499214 -1.0252485 ]
mat_Sqrt:  [[ 8.03167607  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00070549 -0.02845143  0.0120735 ]
Stock Position:  -0.0007054933285704065
Bond Position:  [-1.86259275]


portfolio before change:  [-1.93338186]
curr_Stock_Price:  99.67975614326697
curr_Factors:  [99.67975614 -1.69289327 -0.99336493]
mat_Sqrt:  [[ 6.79172123  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.92049700e-02 -3.18632833e-05  4.05697680e-02]
Stock Position:  0.02920496997441093
Bond Position:  [-4.84452615]


portfolio before change:  [-1.9392163]
curr_Stock_Price:  99.52145593350598
curr_Factors:  [99.52145593 -1.5275261  -0.97658496]
mat_Sqrt:  [[ 8.1357033   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00863697  0.00745829  0.17574602]
Stock Position:  -0.008636972026058036
Bond Position:  [-1.07965227]


portfolio before change:  [-1.93624889]
curr_Stock_Price:  99.14663142924276
curr_Factors:  [99.14663143 -1.37171842 -0.97293118]
mat_Sqrt:  [[ 9.50625764  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02351348  0.06781817  0.04705709]
Stock Position:  -0.023513484796263404
Bond Position:  [0.39503392]


portfolio before change:  [-1.93877893]
curr_Stock_Price:  99.25843137472465
curr_Factors:  [99.25843137 -1.32114348 -0.97540915]
mat_Sqrt:  [[ 9.98590138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00173476 -0.02962364  0.01506446]
Stock Position:  0.0017347611487902768
Bond Position:  [-2.1109686]


portfolio before change:  [-1.93884538]
curr_Stock_Price:  99.52437760436473
curr_Factors:  [99.5243776  -1.4693931  -0.92743914]
mat_Sqrt:  [[ 9.05729385  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00236477 0.02337278 0.03785385]
Stock Position:  0.002364773114565423
Bond Position:  [-2.17419796]


portfolio before change:  [-1.9369095]
curr_Stock_Price:  100.57289333852015
curr_Factors:  [100.57289334  -1.65878463  -0.94644749]
mat_Sqrt:  [[ 7.43092722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00212656 0.04880438 0.1632727 ]
Stock Position:  0.0021265607754514626
Bond Position:  [-2.15078387]


portfolio before change:  [-1.94006216]
curr_Stock_Price:  99.34325607712778
curr_Factors:  [99.34325608 -1.76161781 -0.9008231 ]
mat_Sqrt:  [[ 6.93194319  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00645146 -0.05962066 -0.02863986]
Stock Position:  0.006451459945960292
Bond Position:  [-2.5809712]


portfolio before change:  [-1.93989351]
curr_Stock_Price:  99.46942469211737
curr_Factors:  [99.46942469 -1.70800353 -0.86142836]
mat_Sqrt:  [[ 7.61727284  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01454308 -0.0317668   0.57222269]
Stock Position:  -0.014543082514397248
Bond Position:  [-0.49330146]


portfolio before change:  [-1.92728938]
curr_Stock_Price:  98.59426779344513
curr_Factors:  [98.59426779 -1.77772684 -0.83244653]
mat_Sqrt:  [[ 7.24882764  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00781662 0.07271866 0.99747511]
Stock Position:  0.00781662241436977
Bond Position:  [-2.69796354]


portfolio before change:  [-1.92696449]
curr_Stock_Price:  98.72213092317303
curr_Factors:  [98.72213092 -1.89592047 -0.82190556]
mat_Sqrt:  [[ 6.51744943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044203 -0.00498787 -0.13603047]
Stock Position:  -0.0004420346450700998
Bond Position:  [-1.88332589]


portfolio before change:  [-1.92764309]
curr_Stock_Price:  99.19202883290163
curr_Factors:  [99.19202883 -1.95895381 -0.82338573]
mat_Sqrt:  [[ 6.13934535  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00700415 -0.01445387  0.06457995]
Stock Position:  -0.007004151838939092
Bond Position:  [-1.23288706]


portfolio before change:  [-1.92468763]
curr_Stock_Price:  98.72605873245885
curr_Factors:  [98.72605873 -2.10421089 -0.75411842]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.92468763]
Stock Price:  99.06265891821323
PL:  [-1.92468763]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.22439359e-01 -2.48184014e-02  6.06918462e-02]
 [ 1.74105798e-02  6.39394686e-02  5.47899761e-02]
 [ 2.92067627e-02  4.30452823e-02  3.89330340e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.02660792e-01 -2.39266208e-01 -1.93254389e-01]
 [ 3.28408886e-02  1.33776570e-03 -3.89763635e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-8.10129604e-02 -5.29648193e-02 -4.22462821e-02]
 [-3.94977855e-02  2.82249530e-02  5.49682035e-03]
 [-1.59457762e-01  1.44147217e-01 -1.05097941e-02]
 [ 7.85411456e-02 -1.28721240e-01  8.81793932e-04]
 [ 4.02011883e-02  9.08749526e-02  3.80408626e-02]
 [ 3.08433985e-03  1.63333143e-01  6.41840309e-02]
 [-3.59533823e-02 -1.20229196e-01 -8.53233194e-02]
 [-1.36015531e-01 -9.61698876e-02  1.99279846e-01]
 [ 6.94903824e-03  8.99152866e-02  1.06187845e-01]
 [-1.43906839e-01  7.84535671e-03  7.40595875e-02]
 [-4.45603089e-02 -3.86838353e-02  2.15251173e-02]
 [-1.79846388e-02  5.99026062e-01  3.14611971e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.27041135]
curr_Stock_Price:  100.97429554909507
curr_Factors:  [100.97429555  -1.00592176  -1.00365352]
mat_Sqrt:  [[13.53515946  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01556624 -0.00784827  0.17313694]
Stock Position:  -0.015566236735997777
Bond Position:  [10.84220114]


portfolio before change:  [9.28056316]
curr_Stock_Price:  100.4962789843384
curr_Factors:  [100.49627898  -0.99433448  -1.0127267 ]
mat_Sqrt:  [[13.50499372  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00223958 0.02021944 0.15630055]
Stock Position:  0.002239575040309752
Bond Position:  [9.0554942]


portfolio before change:  [9.28460287]
curr_Stock_Price:  101.28908794430161
curr_Factors:  [101.28908794  -0.69354556  -1.04463153]
mat_Sqrt:  [[17.81073916  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00214844 0.01361211 0.11106511]
Stock Position:  0.0021484430866505503
Bond Position:  [9.06698903]


portfolio before change:  [9.28536318]
curr_Stock_Price:  100.58778127671413
curr_Factors:  [100.58778128  -0.64961141  -1.02434198]
mat_Sqrt:  [[18.86064368  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0020118  -0.00455813 -0.02970002]
Stock Position:  -0.0020117954527615924
Bond Position:  [9.48772522]


portfolio before change:  [9.28635933]
curr_Stock_Price:  101.27178755603755
curr_Factors:  [101.27178756  -0.85889177  -1.03323765]
mat_Sqrt:  [[15.26676819  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01683625 -0.07566262 -0.55130098]
Stock Position:  0.01683624686570689
Bond Position:  [7.58132251]


portfolio before change:  [9.2838825]
curr_Stock_Price:  101.01208658663225
curr_Factors:  [101.01208659  -0.8613247   -1.02298906]
mat_Sqrt:  [[15.34709822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00162372  0.00042304 -0.11118872]
Stock Position:  0.0016237214577166951
Bond Position:  [9.11986701]


portfolio before change:  [9.2869737]
curr_Stock_Price:  101.51151940917578
curr_Factors:  [101.51151941  -0.86694727  -1.03716484]
mat_Sqrt:  [[15.12063212  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037474 -0.02845143  0.0120735 ]
Stock Position:  -0.0003747392200702451
Bond Position:  [9.32501404]


portfolio before change:  [9.28971023]
curr_Stock_Price:  100.43080970864288
curr_Factors:  [100.43080971  -0.24882708  -1.06705719]
mat_Sqrt:  [[26.93926151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337812 -0.01674895 -0.12051688]
Stock Position:  -0.003378117560285228
Bond Position:  [9.62897731]


portfolio before change:  [9.29362834]
curr_Stock_Price:  99.98364699462716
curr_Factors:  [99.98364699 -0.51117736 -1.05518783]
mat_Sqrt:  [[20.87686158  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180329  0.00892551  0.0156809 ]
Stock Position:  -0.0018032876476665363
Bond Position:  [9.47392761]


portfolio before change:  [9.29666146]
curr_Stock_Price:  99.6152408142046
curr_Factors:  [99.61524081 -0.62223692 -1.05816005]
mat_Sqrt:  [[18.55832     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0085073   0.04558335 -0.02998152]
Stock Position:  -0.00850730021561062
Bond Position:  [10.14411822]


portfolio before change:  [9.29026752]
curr_Stock_Price:  100.66496131113335
curr_Factors:  [100.66496131  -0.84318824  -1.05724203]
mat_Sqrt:  [[15.04984243  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00500986 -0.04070523  0.00251551]
Stock Position:  0.005009857962124315
Bond Position:  [8.78595036]


portfolio before change:  [9.29000607]
curr_Stock_Price:  100.17428557890348
curr_Factors:  [100.17428558  -0.92122104  -1.07855404]
mat_Sqrt:  [[13.56016486  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00371033 0.02873718 0.10851999]
Stock Position:  0.0037103256901137027
Bond Position:  [8.91832684]


portfolio before change:  [9.28758258]
curr_Stock_Price:  98.9201241580107
curr_Factors:  [98.92012416 -0.95375333 -1.05831103]
mat_Sqrt:  [[13.22684317  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00154255 0.05165047 0.18309917]
Stock Position:  0.001542552039841758
Bond Position:  [9.13499314]


portfolio before change:  [9.29104661]
curr_Stock_Price:  99.68508677320884
curr_Factors:  [99.68508677 -1.07706844 -1.04945534]
mat_Sqrt:  [[11.88755801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0047507  -0.03801981 -0.24340368]
Stock Position:  -0.004750701225533989
Bond Position:  [9.76462067]


portfolio before change:  [9.29586499]
curr_Stock_Price:  99.18475632945803
curr_Factors:  [99.18475633 -0.97375876 -1.07267386]
mat_Sqrt:  [[12.8141717   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0076338  -0.03041159  0.56848993]
Stock Position:  -0.007633798056034361
Bond Position:  [10.05302139]


portfolio before change:  [9.30331356]
curr_Stock_Price:  98.53828933075336
curr_Factors:  [98.53828933 -0.32581725 -1.08083825]
mat_Sqrt:  [[24.13805647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00128205 0.02843371 0.30292436]
Stock Position:  0.0012820478773258972
Bond Position:  [9.17698275]


portfolio before change:  [9.30665409]
curr_Stock_Price:  99.35417206873801
curr_Factors:  [99.35417207 -0.10267183 -1.06235239]
mat_Sqrt:  [[30.99006728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00414929  0.00248092  0.21127139]
Stock Position:  -0.004149294732769764
Bond Position:  [9.71890383]


portfolio before change:  [9.29731289]
curr_Stock_Price:  102.19109557446593
curr_Factors:  [102.19109557  -0.34514503  -1.11057669]
mat_Sqrt:  [[23.83423126  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172715 -0.0122329   0.06140517]
Stock Position:  -0.0017271513657435528
Bond Position:  [9.47381238]


portfolio before change:  [9.30331325]
curr_Stock_Price:  100.0884319269663
curr_Factors:  [ 1.00088432e+02  5.72512846e-03 -1.13821368e+00]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.30331325]
Stock Price:  97.88536662982644
PL:  [9.30331325]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.23808844e-01 -2.49516935e-02  6.13288142e-02]
 [-4.61266040e-01  3.28260550e-01  4.18242527e-02]
 [-7.13931196e-02 -2.74556055e-01  9.29227160e-03]
 [-2.21234212e-02  1.65727590e-02  9.46875130e-03]
 [ 2.14198706e-01 -1.63676719e-01 -1.27710636e-01]
 [ 4.29873037e-02  3.10102684e-02 -1.51780195e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-9.51752149e-02 -4.35488045e-02 -4.32960827e-02]
 [-9.03184971e-03  1.06844919e-02 -1.02089602e-01]
 [-3.44796171e-01  3.30618622e-01  1.65300955e-02]
 [ 1.15065701e-01 -1.52674978e-01 -6.23485904e-05]
 [-1.65325738e-02  5.55450379e-02  3.79500713e-02]
 [-5.50912301e-02  1.66746363e-01 -2.72273245e-03]
 [-8.94190950e-02 -9.01807421e-02  7.84431467e-02]
 [-1.38970615e-01 -1.14438456e-01  2.47810781e-01]
 [-5.60420743e-02  6.84454433e-02 -2.68149361e-02]
 [-1.50028309e-01 -5.85280071e-03  8.33939208e-02]
 [-4.28111492e-02 -3.31960703e-02  2.11485116e-02]
 [-1.22768510e-02  5.46936882e-01  3.41444831e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.95313727]
curr_Stock_Price:  100.93009964174536
curr_Factors:  [100.93009964  -0.92911595  -1.02093508]
mat_Sqrt:  [[14.35900341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01475969 -0.00789042  0.17495404]
Stock Position:  -0.014759687424128986
Bond Position:  [10.44283399]


portfolio before change:  [9.00035651]
curr_Stock_Price:  97.90779931083087
curr_Factors:  [97.90779931 -0.71893102 -1.01595588]
mat_Sqrt:  [[17.27290877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02571964  0.1038051   0.11931295]
Stock Position:  -0.025719643132199262
Bond Position:  [11.51851017]


portfolio before change:  [8.9724802]
curr_Stock_Price:  99.10362855967972
curr_Factors:  [99.10362856 -0.66675198 -1.0241643 ]
mat_Sqrt:  [[18.26980634  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00419191 -0.08682225  0.02650826]
Stock Position:  -0.004191908114230307
Bond Position:  [9.3879135]


portfolio before change:  [8.97765941]
curr_Stock_Price:  98.42805598231425
curr_Factors:  [98.42805598 -0.59042645 -1.04647898]
mat_Sqrt:  [[19.15225485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103187  0.00524077  0.02701171]
Stock Position:  -0.001031873991967222
Bond Position:  [9.07922476]


portfolio before change:  [8.97930181]
curr_Stock_Price:  99.0363588049469
curr_Factors:  [99.0363588  -0.64095192 -1.07809412]
mat_Sqrt:  [[17.75098482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0103602  -0.05175912 -0.3643229 ]
Stock Position:  0.010360200786112753
Bond Position:  [7.95326524]


portfolio before change:  [8.99343761]
curr_Stock_Price:  100.20884940230123
curr_Factors:  [100.2088494   -1.10051131  -1.09940095]
mat_Sqrt:  [[11.10443132  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00366428  0.00980631 -0.04329866]
Stock Position:  0.003664283564216572
Bond Position:  [8.62624397]


portfolio before change:  [8.99933961]
curr_Stock_Price:  101.2309247346935
curr_Factors:  [101.23092473  -1.29309295  -1.13184888]
mat_Sqrt:  [[ 8.95724285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063259 -0.02845143  0.0120735 ]
Stock Position:  -0.000632593531568536
Bond Position:  [9.06337764]


portfolio before change:  [9.00133423]
curr_Stock_Price:  101.66011987951099
curr_Factors:  [101.66011988  -1.03240915  -1.15470275]
mat_Sqrt:  [[11.41037678  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00921419 -0.01377134 -0.12351167]
Stock Position:  -0.00921419319426153
Bond Position:  [9.93805022]


portfolio before change:  [8.99743203]
curr_Stock_Price:  102.35329217195286
curr_Factors:  [102.35329217  -1.16338979  -1.1472942 ]
mat_Sqrt:  [[10.15276916  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291496  0.00337873 -0.29123322]
Stock Position:  -0.0029149613765580324
Bond Position:  [9.29578793]


portfolio before change:  [8.99920434]
curr_Stock_Price:  102.54263551334114
curr_Factors:  [102.54263551  -0.88529501  -1.1468116 ]
mat_Sqrt:  [[13.43914962  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02476983  0.10455079  0.04715576]
Stock Position:  -0.0247698293958067
Bond Position:  [11.53916793]


portfolio before change:  [9.00096192]
curr_Stock_Price:  102.58815762238706
curr_Factors:  [102.58815762  -0.77175327  -1.20813511]
mat_Sqrt:  [[14.16584975  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00784358 -0.04828007 -0.00017786]
Stock Position:  0.007843576297316461
Bond Position:  [8.19630388]


portfolio before change:  [9.00309392]
curr_Stock_Price:  102.59869685876487
curr_Factors:  [102.59869686  -0.74094493  -1.21297702]
mat_Sqrt:  [[14.53999731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00050563  0.01756488  0.10826099]
Stock Position:  -0.0005056315366005456
Bond Position:  [9.05497106]


portfolio before change:  [9.00502538]
curr_Stock_Price:  103.25642595428795
curr_Factors:  [103.25642595  -0.79330911  -1.20446453]
mat_Sqrt:  [[14.00538405  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366585  0.05272983 -0.0077672 ]
Stock Position:  -0.003665849704483053
Bond Position:  [9.38354791]


portfolio before change:  [9.0073939]
curr_Stock_Price:  103.25033196959711
curr_Factors:  [103.25033197  -0.75620985  -1.20301809]
mat_Sqrt:  [[14.55491163  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00520343 -0.02851765  0.22377646]
Stock Position:  -0.005203426403106522
Bond Position:  [9.5446494]


portfolio before change:  [9.00187766]
curr_Stock_Price:  104.7690812102183
curr_Factors:  [104.76908121  -0.46944047  -1.2291688 ]
mat_Sqrt:  [[19.16622162  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00476574 -0.03618862  0.70693518]
Stock Position:  -0.004765740528137978
Bond Position:  [9.50117991]


portfolio before change:  [9.00786409]
curr_Stock_Price:  104.01141407422914
curr_Factors:  [104.01141407  -0.10905705  -1.24005167]
mat_Sqrt:  [[26.98798936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221389  0.02164435 -0.07649555]
Stock Position:  -0.002213888394557356
Bond Position:  [9.23813376]


portfolio before change:  [9.01202116]
curr_Stock_Price:  103.17702302453488
curr_Factors:  [103.17702302  -0.14793238  -1.17918468]
mat_Sqrt:  [[27.36675952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00486564 -0.00185082  0.23789964]
Stock Position:  -0.004865636889756917
Bond Position:  [9.51404309]


portfolio before change:  [9.01477004]
curr_Stock_Price:  103.10096469716336
curr_Factors:  [103.1009647   -0.61036338  -1.15485504]
mat_Sqrt:  [[17.64566835  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223009 -0.01049752  0.06033082]
Stock Position:  -0.002230085331490327
Bond Position:  [9.24469399]


portfolio before change:  [9.01226482]
curr_Stock_Price:  105.26083042249233
curr_Factors:  [105.26083042  -0.74479952  -1.15012832]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.01226482]
Stock Price:  106.09836296924524
PL:  [2.91390185]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.13497227e-01 -4.80164673e-02  1.41703057e-01]
 [ 2.44774361e-02  2.75784291e-02  7.05846155e-02]
 [-3.45342277e-03 -1.13213936e-01  4.66622428e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.19285376e-01 -2.71938849e-01 -2.47477195e-01]
 [-2.21393095e-02 -4.72557732e-03 -6.10348717e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [-1.00092501e-02  8.76971592e-03 -1.06896387e-01]
 [-3.33077457e-01  3.22352429e-01  3.94710590e-02]
 [ 1.11724438e-01 -1.47917475e-01 -3.31248165e-03]
 [-5.63467266e-02  3.17564169e-02  2.21700545e-02]
 [-4.80947937e-02  1.78309390e-01  9.96737573e-03]
 [-9.76359446e-02 -2.97568481e-02  9.85655670e-02]
 [-1.40804622e-01 -1.09020565e-01  2.31219277e-01]
 [ 2.54756095e-02  8.19876282e-02  1.03551954e-01]
 [-1.52329289e-01 -6.60852650e-03  8.15729665e-02]
 [-4.61340049e-02 -4.40092074e-02  2.21090787e-02]
 [-5.74760895e-03  6.51277115e-01  3.89102630e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.08165415]
curr_Stock_Price:  99.67156378227332
curr_Factors:  [99.67156378 -1.16979005 -0.9847878 ]
mat_Sqrt:  [[11.55713009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02473036 -0.01518414  0.40423938]
Stock Position:  -0.024730360306030454
Bond Position:  [2.38325954]


portfolio before change:  [-0.14062886]
curr_Stock_Price:  102.08036813240585
curr_Factors:  [102.08036813  -1.57395583  -1.00472581]
mat_Sqrt:  [[ 7.74524254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0051125  0.00872107 0.20135826]
Stock Position:  0.005112497406919353
Bond Position:  [-0.66251447]


portfolio before change:  [-0.13722367]
curr_Stock_Price:  102.77882034122733
curr_Factors:  [102.77882034  -1.85715995  -1.00460609]
mat_Sqrt:  [[ 5.87562986  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00053582 -0.03580139  0.13311439]
Stock Position:  0.0005358227902987759
Bond Position:  [-0.1922949]


portfolio before change:  [-0.13748829]
curr_Stock_Price:  102.37469286408331
curr_Factors:  [102.37469286  -1.530174    -1.03414255]
mat_Sqrt:  [[ 7.87996132  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00481522 -0.00455813 -0.02970002]
Stock Position:  -0.004815221250604795
Bond Position:  [0.35546851]


portfolio before change:  [-0.13759971]
curr_Stock_Price:  102.41628927036437
curr_Factors:  [102.41628927  -1.15594825  -1.02812271]
mat_Sqrt:  [[11.53025917  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02270095 -0.08599461 -0.70598355]
Stock Position:  0.0227009531988258
Bond Position:  [-2.4625471]


portfolio before change:  [-0.15685106]
curr_Stock_Price:  101.59537046871762
curr_Factors:  [101.59537047  -1.17083342  -1.00476139]
mat_Sqrt:  [[11.53519913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300992 -0.00149436 -0.1741155 ]
Stock Position:  -0.003009918946686733
Bond Position:  [0.14894277]


portfolio before change:  [-0.16095323]
curr_Stock_Price:  102.97062493514154
curr_Factors:  [102.97062494  -1.25886217  -1.00919629]
mat_Sqrt:  [[10.65879419  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00053161 -0.02845143  0.0120735 ]
Stock Position:  -0.0005316074021111348
Bond Position:  [-0.10621328]


portfolio before change:  [-0.1608027]
curr_Stock_Price:  102.63752431550232
curr_Factors:  [102.63752432  -1.06174332  -0.98810405]
mat_Sqrt:  [[13.21504861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0105626  -0.01496598 -0.14840805]
Stock Position:  -0.010562604671773872
Bond Position:  [0.92331689]


portfolio before change:  [-0.15894882]
curr_Stock_Price:  102.4838670623807
curr_Factors:  [102.48386706  -1.1651785   -0.99357365]
mat_Sqrt:  [[11.83372184  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267058  0.00277323 -0.30494564]
Stock Position:  -0.002670584203974821
Bond Position:  [0.11474297]


portfolio before change:  [-0.1579435]
curr_Stock_Price:  102.1181676235443
curr_Factors:  [102.11816762  -1.10862021  -0.98161904]
mat_Sqrt:  [[12.62768209  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02507961  0.10193679  0.11259994]
Stock Position:  -0.02507961118233529
Bond Position:  [2.40314043]


portfolio before change:  [-0.15000116]
curr_Stock_Price:  101.82544059714373
curr_Factors:  [101.8254406   -0.67529817  -1.00845279]
mat_Sqrt:  [[18.90656124  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00567153 -0.04677561 -0.00944959]
Stock Position:  0.0056715267529014405
Bond Position:  [-0.72750687]


portfolio before change:  [-0.14115864]
curr_Stock_Price:  103.41662190851441
curr_Factors:  [103.41662191  -0.63894732  -0.99472931]
mat_Sqrt:  [[20.18801418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252632  0.01004226  0.06324499]
Stock Position:  -0.002526317625345958
Bond Position:  [0.1201046]


portfolio before change:  [-0.14091151]
curr_Stock_Price:  103.33069005665227
curr_Factors:  [103.33069006  -0.74373942  -0.97782412]
mat_Sqrt:  [[18.47412097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224402  0.05638638  0.02843415]
Stock Position:  -0.00224401924387845
Bond Position:  [0.09096454]


portfolio before change:  [-0.14163394]
curr_Stock_Price:  103.66275980308178
curr_Factors:  [103.6627598   -0.6302493   -0.99384815]
mat_Sqrt:  [[20.43083928  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00383169 -0.00940994  0.28118013]
Stock Position:  -0.003831690412644148
Bond Position:  [0.25556966]


portfolio before change:  [-0.1402756]
curr_Stock_Price:  103.32493578641841
curr_Factors:  [103.32493579  -0.59916011  -0.95438513]
mat_Sqrt:  [[21.85289698  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00441233 -0.03447533  0.65960424]
Stock Position:  -0.004412325015586756
Bond Position:  [0.31562759]


portfolio before change:  [-0.12686553]
curr_Stock_Price:  100.3035898863474
curr_Factors:  [100.30358989  -0.51271381  -0.99659313]
mat_Sqrt:  [[22.17342604  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00219767 0.02592676 0.2954049 ]
Stock Position:  0.0021976745953228532
Bond Position:  [-0.34730018]


portfolio before change:  [-0.12225193]
curr_Stock_Price:  102.44241200151214
curr_Factors:  [102.442412    -0.21103689  -0.99662695]
mat_Sqrt:  [[30.61949721  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00443668 -0.0020898   0.23270497]
Stock Position:  -0.004436679929281426
Bond Position:  [0.33225226]


portfolio before change:  [-0.11685807]
curr_Stock_Price:  101.24539323510625
curr_Factors:  [ 1.01245393e+02 -5.87630494e-02 -1.00176032e+00]
mat_Sqrt:  [[35.05870118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00121959 -0.01391693  0.06307105]
Stock Position:  -0.0012195922707543766
Bond Position:  [0.00662003]


portfolio before change:  [-0.11714508]
curr_Stock_Price:  101.48208801495763
curr_Factors:  [101.48208801   0.30784086  -0.97067188]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.11714508]
Stock Price:  98.90350112534536
PL:  [-0.11714508]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.55465385e-01 -2.80328300e-02  7.60527511e-02]
 [-6.29938977e-02  1.07982484e-01  5.10519925e-02]
 [-2.30146245e-02 -1.82887896e-01  4.02038716e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 2.28096885e-01 -1.79673760e-01 -1.40725083e-01]
 [ 5.79131029e-02  1.80131947e-02  5.76126565e-04]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 1.38953432e-01 -5.82115136e-03 -7.82389853e-03]
 [-7.97530843e-02  2.39756440e-02  5.68843995e-02]
 [-1.08093004e-01  9.35279923e-02 -2.94709558e-02]
 [ 8.96511479e-02 -1.35150764e-01 -5.02990633e-04]
 [-2.75306489e-03  6.57751968e-02  4.18439543e-02]
 [-4.22177811e-02  1.83135680e-01  1.87319105e-02]
 [-5.61826941e-02 -1.24678897e-01 -1.67797233e-02]
 [-1.44428707e-01 -1.02421618e-01  2.09883135e-01]
 [-1.33221211e-02  9.25265503e-02  6.13666334e-02]
 [-7.06551296e-02  1.13407925e-01  3.31538171e-02]
 [ 2.23183194e-02  3.54358775e-02  1.13329700e-01]
 [-2.69207403e-02  5.30391737e-01  2.32586062e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.36831264]
curr_Stock_Price:  100.57003659954387
curr_Factors:  [100.5700366   -1.07669834  -0.963864  ]
mat_Sqrt:  [[13.06964051  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01841405 -0.00886476  0.21695733]
Stock Position:  -0.01841404791120838
Bond Position:  [8.22021412]


portfolio before change:  [6.38371195]
curr_Stock_Price:  99.84537241972052
curr_Factors:  [99.84537242 -0.87609135 -0.96605505]
mat_Sqrt:  [[15.82318567  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00314632  0.03414706  0.14563712]
Stock Position:  -0.0031463232935034177
Bond Position:  [6.69785778]


portfolio before change:  [6.38440797]
curr_Stock_Price:  100.15641918304829
curr_Factors:  [100.15641918  -0.80929088  -0.95376855]
mat_Sqrt:  [[17.17875984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113688 -0.05783423  0.11469046]
Stock Position:  -0.0011368800160006026
Bond Position:  [6.49827381]


portfolio before change:  [6.38627428]
curr_Stock_Price:  99.94396591906987
curr_Factors:  [99.94396592 -0.65756709 -0.97074823]
mat_Sqrt:  [[19.61499585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193443 -0.00455813 -0.02970002]
Stock Position:  -0.0019344259613632193
Bond Position:  [6.57960848]


portfolio before change:  [6.38760786]
curr_Stock_Price:  100.10500914117104
curr_Factors:  [100.10500914  -0.34122458  -0.99801346]
mat_Sqrt:  [[26.23204337  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00742345 -0.05681783 -0.40144949]
Stock Position:  0.007423452986394483
Bond Position:  [5.64448303]


portfolio before change:  [6.38874815]
curr_Stock_Price:  100.06850157984155
curr_Factors:  [100.06850158  -0.6435647   -1.02374583]
mat_Sqrt:  [[18.88833317  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00309693 0.00569627 0.00164353]
Stock Position:  0.003096927736847201
Bond Position:  [6.07884323]


portfolio before change:  [6.38611782]
curr_Stock_Price:  98.72839080605998
curr_Factors:  [98.72839081 -0.50217556 -1.05242441]
mat_Sqrt:  [[20.85873035  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027165 -0.02845143  0.0120735 ]
Stock Position:  -0.0002716509486848883
Bond Position:  [6.41293748]


portfolio before change:  [6.38791041]
curr_Stock_Price:  98.03209324778636
curr_Factors:  [98.03209325 -0.43246373 -1.05676292]
mat_Sqrt:  [[22.11084601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00620537 -0.00184081 -0.0223194 ]
Stock Position:  0.006205374679512835
Bond Position:  [5.77958454]


portfolio before change:  [6.39552971]
curr_Stock_Price:  99.02707411173743
curr_Factors:  [99.02707411 -0.57081984 -1.05553565]
mat_Sqrt:  [[19.47317342  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00346747  0.00758176  0.16227536]
Stock Position:  -0.0034674654705474446
Bond Position:  [6.73890267]


portfolio before change:  [6.39730179]
curr_Stock_Price:  99.00194247407183
curr_Factors:  [99.00194247 -0.4557717  -1.0417635 ]
mat_Sqrt:  [[22.1448346   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00504379  0.02957615 -0.08407243]
Stock Position:  -0.005043788203701433
Bond Position:  [6.89664662]


portfolio before change:  [6.39356637]
curr_Stock_Price:  100.08442303411097
curr_Factors:  [100.08442303  -0.3945765   -1.02902123]
mat_Sqrt:  [[24.10492849  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00357018 -0.04273842 -0.00143489]
Stock Position:  0.0035701785072438036
Bond Position:  [6.03624711]


portfolio before change:  [6.40095137]
curr_Stock_Price:  101.73021085395786
curr_Factors:  [101.73021085  -0.32463243  -1.05649174]
mat_Sqrt:  [[25.56438424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00029285 0.02079994 0.11936915]
Stock Position:  0.00029285292836402066
Bond Position:  [6.37115938]


portfolio before change:  [6.40257789]
curr_Stock_Price:  101.84470035327344
curr_Factors:  [101.84470035  -0.32657572  -1.09282256]
mat_Sqrt:  [[24.63210883  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136674  0.05791259  0.05343693]
Stock Position:  -0.0013667365287668683
Bond Position:  [6.54177276]


portfolio before change:  [6.40641676]
curr_Stock_Price:  100.23266625785337
curr_Factors:  [ 1.00232666e+02 -3.21102014e-02 -1.12052398e+00]
mat_Sqrt:  [[31.65385575  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198481 -0.03942693 -0.04786788]
Stock Position:  -0.001984814631647553
Bond Position:  [6.60536003]


portfolio before change:  [6.41198552]
curr_Stock_Price:  98.25907397914683
curr_Factors:  [98.25907398 -0.21706189 -1.09918015]
mat_Sqrt:  [[26.34729356  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00395604 -0.03238856  0.59873817]
Stock Position:  -0.003956042256707645
Bond Position:  [6.80070257]


portfolio before change:  [6.41207223]
curr_Stock_Price:  98.66697636862905
curr_Factors:  [98.66697637 -0.16239652 -1.13996394]
mat_Sqrt:  [[26.82649042  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [5.93933725e-05 2.92594643e-02 1.75061924e-01]
Stock Position:  5.9393372505585126e-05
Bond Position:  [6.40621207]


portfolio before change:  [6.4135573]
curr_Stock_Price:  96.70231489146643
curr_Factors:  [96.70231489 -0.2840373  -1.07256283]
mat_Sqrt:  [[24.9042185   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244776  0.03586273  0.09457861]
Stock Position:  -0.0024477561892111157
Bond Position:  [6.65026099]


portfolio before change:  [6.41778275]
curr_Stock_Price:  95.65536610592925
curr_Factors:  [95.65536611 -0.43047621 -1.06743546]
mat_Sqrt:  [[21.3882162   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00216786 0.01120581 0.32329809]
Stock Position:  0.002167857170616116
Bond Position:  [6.21041558]


portfolio before change:  [6.42169176]
curr_Stock_Price:  96.74225067801204
curr_Factors:  [96.74225068 -0.25442138 -1.10860642]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.42169176]
Stock Price:  95.44747636949448
PL:  [6.42169176]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.84917794e-01 -3.08994379e-02  8.97515127e-02]
 [-3.86105702e-02  1.05945037e-01  1.01838807e-01]
 [-4.70995294e-03 -6.95108238e-02  3.92523988e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 5.39391634e-01 -3.76117829e-01 -2.45495266e-01]
 [-8.10715979e-02  2.84292269e-02 -6.08191751e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [ 3.90845251e-03  2.26527614e-02 -8.66819295e-02]
 [-2.30428831e-01  2.19969604e-01  1.23322122e-02]
 [ 1.10670060e-01 -1.73875136e-01  3.23765357e-02]
 [-1.29277562e-01 -7.88775677e-03 -9.82134228e-03]
 [-1.17577453e-01  1.32256909e-01 -8.93847756e-02]
 [-1.25758911e-01 -1.76919428e-02  1.79431875e-01]
 [-1.53500380e-01 -1.25955018e-01  2.68129177e-01]
 [-2.84029008e-02 -4.82578896e-03 -8.54615793e-02]
 [-9.22709277e-02  5.24876407e-02  8.13397384e-02]
 [-3.64606545e-02 -1.44795707e-02  2.05438081e-02]
 [-1.61936556e-02  5.23320821e-01  3.11122177e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.41028844]
curr_Stock_Price:  100.297286122419
curr_Factors:  [100.29728612  -1.21345273  -1.03859633]
mat_Sqrt:  [[10.54961723  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02534643 -0.00977126  0.25603608]
Stock Position:  -0.02534643267884637
Bond Position:  [6.95246685]


portfolio before change:  [4.41215488]
curr_Stock_Price:  100.2922319950277
curr_Factors:  [100.292232    -1.34550667  -1.00412965]
mat_Sqrt:  [[ 9.56826524  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00157681  0.03350276  0.29051777]
Stock Position:  -0.001576808467048684
Bond Position:  [4.57029652]


portfolio before change:  [4.41098914]
curr_Stock_Price:  101.75624078331504
curr_Factors:  [101.75624078  -1.41682502  -0.99581415]
mat_Sqrt:  [[ 9.11517849  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0001654  -0.02198125  0.11197617]
Stock Position:  0.00016539968502051443
Bond Position:  [4.39415869]


portfolio before change:  [4.41196726]
curr_Stock_Price:  101.02736427682022
curr_Factors:  [101.02736428  -1.44079095  -0.98211935]
mat_Sqrt:  [[ 8.95740989  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00423602 -0.00455813 -0.02970002]
Stock Position:  -0.004236018856724404
Bond Position:  [4.83992108]


portfolio before change:  [4.41244962]
curr_Stock_Price:  101.199169972535
curr_Factors:  [101.19916997  -1.4744192   -0.97741835]
mat_Sqrt:  [[ 8.71680701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05501657 -0.1189389  -0.70032966]
Stock Position:  0.05501656763139217
Bond Position:  [-1.15518136]


portfolio before change:  [4.4221261]
curr_Stock_Price:  101.38030302643955
curr_Factors:  [101.38030303  -1.55989045  -0.96367352]
mat_Sqrt:  [[ 8.12799969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01141144  0.00899011 -0.17350018]
Stock Position:  -0.011411444891083495
Bond Position:  [5.57902185]


portfolio before change:  [4.4208393]
curr_Stock_Price:  101.61530690427072
curr_Factors:  [101.6153069   -1.54219526  -0.98360896]
mat_Sqrt:  [[ 8.12861023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069708 -0.02845143  0.0120735 ]
Stock Position:  -0.0006970802792350198
Bond Position:  [4.49167333]


portfolio before change:  [4.42137455]
curr_Stock_Price:  102.45854663675415
curr_Factors:  [102.45854664  -1.4569566   -0.9788871 ]
mat_Sqrt:  [[ 8.96756873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01556557 -0.01496598 -0.14840805]
Stock Position:  -0.015565571719630073
Bond Position:  [6.01620041]


portfolio before change:  [4.43152441]
curr_Stock_Price:  101.90311441083394
curr_Factors:  [101.90311441  -0.70088897  -0.9909457 ]
mat_Sqrt:  [[18.76864822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00070333  0.00716343 -0.24727942]
Stock Position:  -0.0007033287815987361
Bond Position:  [4.5031958]


portfolio before change:  [4.43295688]
curr_Stock_Price:  101.4672946703898
curr_Factors:  [101.46729467  -0.51972285  -1.01868886]
mat_Sqrt:  [[21.78724733  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01020009  0.0695605   0.03518037]
Stock Position:  -0.010200092512731003
Bond Position:  [5.46793267]


portfolio before change:  [4.40448612]
curr_Stock_Price:  104.39255344135275
curr_Factors:  [104.39255344  -0.89616114  -1.05980842]
mat_Sqrt:  [[14.76395581  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00763951 -0.05498415  0.09236124]
Stock Position:  0.007639514576888235
Bond Position:  [3.60697769]


portfolio before change:  [4.4164937]
curr_Stock_Price:  105.84627461663332
curr_Factors:  [105.84627462  -0.95346052  -1.04558911]
mat_Sqrt:  [[14.33835593  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00917023 -0.00249433 -0.02801756]
Stock Position:  -0.009170228211305725
Bond Position:  [5.38712819]


portfolio before change:  [4.4069365]
curr_Stock_Price:  107.03535595276583
curr_Factors:  [107.03535595  -0.80820058  -1.03270875]
mat_Sqrt:  [[16.98362896  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00779622  0.04182331 -0.25498988]
Stock Position:  -0.007796224542147552
Bond Position:  [5.24140817]


portfolio before change:  [4.41785194]
curr_Stock_Price:  105.80335988767894
curr_Factors:  [105.80335989  -0.90918717  -1.06523017]
mat_Sqrt:  [[14.68996989  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00609867 -0.00559468  0.51186919]
Stock Position:  -0.006098673967623444
Bond Position:  [5.06311213]


portfolio before change:  [4.40743008]
curr_Stock_Price:  107.71980897909283
curr_Factors:  [107.71980898  -1.00748159  -1.05511649]
mat_Sqrt:  [[13.69369379  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00745021 -0.03983047  0.76489791]
Stock Position:  -0.007450209356849421
Bond Position:  [5.20996521]


portfolio before change:  [4.41443745]
curr_Stock_Price:  106.95409612129987
curr_Factors:  [106.95409612  -0.53742641  -1.05159384]
mat_Sqrt:  [[21.8320589   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00210572 -0.00152605 -0.2437981 ]
Stock Position:  -0.002105723248086126
Bond Position:  [4.63965318]


portfolio before change:  [4.417689]
curr_Stock_Price:  105.96085446303334
curr_Factors:  [105.96085446  -0.75288602  -1.10418286]
mat_Sqrt:  [[16.54362532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0044919   0.01659805  0.23203963]
Stock Position:  -0.004491899244801724
Bond Position:  [4.89365448]


portfolio before change:  [4.41922754]
curr_Stock_Price:  105.89073564023371
curr_Factors:  [105.89073564  -1.12199746  -1.1112016 ]
mat_Sqrt:  [[11.34989749  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00287589 -0.00457884  0.05860577]
Stock Position:  -0.0028758874815988504
Bond Position:  [4.72375738]


portfolio before change:  [4.4208629]
curr_Stock_Price:  105.73277468669934
curr_Factors:  [105.73277469  -1.13091539  -1.11820541]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.4208629]
Stock Price:  105.96712417493845
PL:  [-1.54626127]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-6.70248124e-02 -6.74389028e-02  1.36878872e-01]
 [-8.81961021e-02  1.32026879e-01  9.47979577e-02]
 [-7.95038733e-02 -3.47518937e-01  3.25585494e-03]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 2.68970350e-01 -2.35159848e-01 -2.20350547e-01]
 [ 8.90933468e-02 -9.36654373e-02 -7.73035994e-02]
 [ 3.28185872e-02 -8.10626438e-02 -5.24058024e-03]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [-1.34350624e-02  3.09761080e-02 -2.77733400e-02]
 [-2.67677009e-01  2.54170664e-01  1.15345888e-02]
 [ 9.22299131e-02 -1.36638352e-01 -8.61866800e-04]
 [ 6.73255364e-03  7.28174931e-02  4.45244481e-02]
 [-1.03367335e-02  1.55319720e-01  4.53354906e-02]
 [-4.16125346e-02 -1.42579694e-01 -6.28294802e-02]
 [-1.65817210e-01 -1.15027659e-01  2.27674760e-01]
 [ 3.74414970e-02  8.73560396e-02  1.38246457e-01]
 [-1.06879946e-01  5.97012458e-02  5.52065003e-02]
 [-4.55403562e-02 -4.19142626e-02  2.18344428e-02]
 [-2.80845639e-02  5.13664469e-01  2.53490781e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.83877372]
curr_Stock_Price:  98.59100611273306
curr_Factors:  [98.59100611 -1.20860622 -1.00563463]
mat_Sqrt:  [[10.76972759  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00379079 -0.02132605  0.39047732]
Stock Position:  -0.0037907917504761686
Bond Position:  [-7.46503575]


portfolio before change:  [-7.84430157]
curr_Stock_Price:  99.55686005281434
curr_Factors:  [99.55686005 -1.16680466 -0.99107681]
mat_Sqrt:  [[11.50575647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00568729  0.04175056  0.27043219]
Stock Position:  -0.005687294947046982
Bond Position:  [-7.27809234]


portfolio before change:  [-7.84425384]
curr_Stock_Price:  99.22849978503069
curr_Factors:  [99.22849979 -0.96089368 -0.99874507]
mat_Sqrt:  [[13.98221997  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00628027 -0.10989514  0.00928805]
Stock Position:  -0.006280274182540426
Bond Position:  [-7.22107165]


portfolio before change:  [-7.85125296]
curr_Stock_Price:  100.0554743487253
curr_Factors:  [100.05547435  -0.77508021  -1.04523197]
mat_Sqrt:  [[16.20650317  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00234127 -0.00455813 -0.02970002]
Stock Position:  -0.002341267379141103
Bond Position:  [-7.61699634]


portfolio before change:  [-7.85804553]
curr_Stock_Price:  102.14326706721468
curr_Factors:  [102.14326707  -0.84464716  -1.05556073]
mat_Sqrt:  [[15.2742516   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01426713 -0.07436407 -0.62859878]
Stock Position:  0.0142671266448413
Bond Position:  [-9.31533645]


portfolio before change:  [-7.8557976]
curr_Stock_Price:  102.46407795729749
curr_Factors:  [102.46407796  -0.60452577  -1.05378084]
mat_Sqrt:  [[19.51543444  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00363279 -0.02961961 -0.22052565]
Stock Position:  0.003632785355966132
Bond Position:  [-8.2280276]


portfolio before change:  [-7.85179072]
curr_Stock_Price:  104.13335964859584
curr_Factors:  [104.13335965  -0.98908093  -1.03362199]
mat_Sqrt:  [[13.77657202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00215263 -0.02563426 -0.01494992]
Stock Position:  0.002152627645017155
Bond Position:  [-8.07595107]


portfolio before change:  [-7.85520022]
curr_Stock_Price:  103.48751874416776
curr_Factors:  [103.48751874  -0.8489946   -1.03574248]
mat_Sqrt:  [[15.71654421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00888143 -0.01496598 -0.14840805]
Stock Position:  -0.00888142662399339
Bond Position:  [-6.93608341]


portfolio before change:  [-7.83329228]
curr_Stock_Price:  100.82553974486096
curr_Factors:  [100.82553974  -0.83635034  -1.02414913]
mat_Sqrt:  [[15.68793937  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00116679  0.00979551 -0.07922961]
Stock Position:  -0.0011667862530038338
Bond Position:  [-7.71565043]


portfolio before change:  [-7.83590523]
curr_Stock_Price:  101.41158686692728
curr_Factors:  [101.41158687  -0.77604304  -1.07643092]
mat_Sqrt:  [[15.90627038  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01626779  0.08037582  0.03290497]
Stock Position:  -0.016267789747825216
Bond Position:  [-6.18616286]


portfolio before change:  [-7.84500398]
curr_Stock_Price:  101.87581785460277
curr_Factors:  [101.87581785  -1.07100181  -1.04405343]
mat_Sqrt:  [[12.28893616  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00720372 -0.04320884 -0.00245867]
Stock Position:  0.007203715358728633
Bond Position:  [-8.57888837]


portfolio before change:  [-7.85322879]
curr_Stock_Price:  101.03183285815186
curr_Factors:  [101.03183286  -1.26187311  -1.0559    ]
mat_Sqrt:  [[ 9.95089539  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00177886 0.02302691 0.12701586]
Stock Position:  0.0017788558149752479
Bond Position:  [-8.03294986]


portfolio before change:  [-7.85597251]
curr_Stock_Price:  100.61851561485823
curr_Factors:  [100.61851561  -1.4057043   -1.09888535]
mat_Sqrt:  [[ 8.22145038  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0003561  0.04911641 0.12932954]
Stock Position:  0.0003561017246703148
Bond Position:  [-7.89180294]


portfolio before change:  [-7.85775751]
curr_Stock_Price:  101.14702522452632
curr_Factors:  [101.14702522  -1.26548139  -1.12239836]
mat_Sqrt:  [[ 9.28774146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0062576  -0.04508766 -0.17923502]
Stock Position:  -0.006257596704537312
Bond Position:  [-7.22482022]


portfolio before change:  [-7.86014904]
curr_Stock_Price:  101.24052731566448
curr_Factors:  [101.24052732  -1.44666163  -1.14919796]
mat_Sqrt:  [[ 7.5506946   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01619895 -0.03637494  0.64949272]
Stock Position:  -0.0161989461862514
Bond Position:  [-6.22015918]


portfolio before change:  [-7.85361161]
curr_Stock_Price:  100.740947494197
curr_Factors:  [100.74094749  -1.11900398  -1.13389955]
mat_Sqrt:  [[10.58723268  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00641494 0.02762441 0.39437866]
Stock Position:  0.006414939784342169
Bond Position:  [-8.49985872]


portfolio before change:  [-7.85759824]
curr_Stock_Price:  100.45078089631008
curr_Factors:  [100.4507809   -0.94031668  -1.09085875]
mat_Sqrt:  [[13.17725769  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00713878  0.01887919  0.15748878]
Stock Position:  -0.007138775679010377
Bond Position:  [-7.14050265]


portfolio before change:  [-7.86946852]
curr_Stock_Price:  101.86347827098335
curr_Factors:  [101.86347827  -0.77450361  -1.03801421]
mat_Sqrt:  [[16.62845941  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253575 -0.01325445  0.06228759]
Stock Position:  -0.002535751496787945
Bond Position:  [-7.61116805]


portfolio before change:  [-7.87019592]
curr_Stock_Price:  101.39985867033684
curr_Factors:  [101.39985867  -0.93375144  -1.03997653]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.87019592]
Stock Price:  100.58324971632405
PL:  [-8.45344564]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.72372325e-01 -2.96783854e-02  8.39164254e-02]
 [ 5.65271077e-02  3.07305353e-02  3.58031839e-02]
 [-8.95009885e-03 -9.80746182e-02  3.43146613e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.25868591e-01 -2.76955718e-01 -2.51410892e-01]
 [-9.66482346e-02 -2.88845362e-02 -1.00520736e-01]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-6.13760813e-02 -3.95618677e-02 -2.46528006e-02]
 [-1.61849468e-02  2.35598942e-02 -4.72514617e-02]
 [-3.89961473e-01  3.73317987e-01  4.42966360e-02]
 [ 6.20436734e-02 -1.19179795e-01  2.98421059e-03]
 [-1.18129103e-02  5.90490023e-02  3.92837776e-02]
 [-1.68957562e-02  1.63955839e-01  4.09921205e-02]
 [-4.46593962e-02 -1.31034601e-01 -5.35564395e-02]
 [-1.53338245e-01 -1.10884765e-01  2.26248635e-01]
 [ 2.42977934e-02  7.29637157e-02  8.78035606e-02]
 [-1.44171370e-01  4.10388052e-03  7.82837793e-02]
 [-4.62906233e-02 -4.38330728e-02  2.17211882e-02]
 [-2.57968534e-02  5.31985296e-01  2.71014783e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.94112939]
curr_Stock_Price:  100.37123164449318
curr_Factors:  [100.37123164  -1.06019255  -1.00978763]
mat_Sqrt:  [[12.66567335  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02021284 -0.00938513  0.2393902 ]
Stock Position:  -0.020212841618828702
Bond Position:  [6.9699172]


portfolio before change:  [4.90979777]
curr_Stock_Price:  102.00753399239457
curr_Factors:  [102.00753399  -1.18932416  -1.01088906]
mat_Sqrt:  [[11.30034724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00571919 0.00971785 0.10213652]
Stock Position:  0.005719192484670474
Bond Position:  [4.32639705]


portfolio before change:  [4.91101917]
curr_Stock_Price:  102.03195452520507
curr_Factors:  [102.03195453  -1.29329104  -1.02259887]
mat_Sqrt:  [[10.06834293  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044475 -0.03101392  0.09789018]
Stock Position:  -0.00044475279945916827
Bond Position:  [4.95639816]


portfolio before change:  [4.91214798]
curr_Stock_Price:  102.28027490014223
curr_Factors:  [102.2802749  -1.2645122  -1.0023908]
mat_Sqrt:  [[10.59957427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00357974 -0.00455813 -0.02970002]
Stock Position:  -0.003579743507943053
Bond Position:  [5.27828513]


portfolio before change:  [4.91345599]
curr_Stock_Price:  102.28355022961924
curr_Factors:  [102.28355023  -1.33493525  -1.01050783]
mat_Sqrt:  [[ 9.79924923  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02728766 -0.08758109 -0.7172053 ]
Stock Position:  0.02728766108211578
Bond Position:  [2.12237714]


portfolio before change:  [4.92600356]
curr_Stock_Price:  102.72392888413054
curr_Factors:  [102.72392888  -1.63707709  -1.03064782]
mat_Sqrt:  [[ 7.13006377  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0165374  -0.00913409 -0.28675768]
Stock Position:  -0.01653740319619673
Bond Position:  [6.62479059]


portfolio before change:  [4.93527303]
curr_Stock_Price:  102.26357443862122
curr_Factors:  [102.26357444  -1.70346372  -1.02887747]
mat_Sqrt:  [[ 6.65396123  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085157 -0.02845143  0.0120735 ]
Stock Position:  -0.0008515670127989121
Bond Position:  [5.02235731]


portfolio before change:  [4.93707073]
curr_Stock_Price:  101.62715556673936
curr_Factors:  [101.62715557  -1.76052346  -1.03418006]
mat_Sqrt:  [[ 6.21277252  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01085341 -0.01251056 -0.07032758]
Stock Position:  -0.01085341463537288
Bond Position:  [6.04007239]


portfolio before change:  [4.93829558]
curr_Stock_Price:  101.65344743447085
curr_Factors:  [101.65344743  -1.76886689  -1.04470562]
mat_Sqrt:  [[ 6.09822007  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00413593  0.00745029 -0.13479527]
Stock Position:  -0.004135927681858952
Bond Position:  [5.35872689]


portfolio before change:  [4.94042618]
curr_Stock_Price:  101.46225561522162
curr_Factors:  [101.46225562  -1.73198432  -1.03566993]
mat_Sqrt:  [[ 6.37275971  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05826054  0.11805351  0.12636597]
Stock Position:  -0.058260541358524084
Bond Position:  [10.85167212]


portfolio before change:  [4.93694479]
curr_Stock_Price:  101.56858233671427
curr_Factors:  [101.56858234  -1.54856631  -1.02504453]
mat_Sqrt:  [[ 7.74558826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00769155 -0.03768796  0.00851312]
Stock Position:  0.007691554438835608
Bond Position:  [4.15572451]


portfolio before change:  [4.9391771]
curr_Stock_Price:  101.72372086674959
curr_Factors:  [101.72372087  -1.27134797  -1.03162097]
mat_Sqrt:  [[10.16846819  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00022319  0.01867293  0.11206568]
Stock Position:  -0.00022319035895273994
Bond Position:  [4.96188086]


portfolio before change:  [4.94058294]
curr_Stock_Price:  100.98351868584217
curr_Factors:  [100.98351869  -1.14263127  -1.04484252]
mat_Sqrt:  [[11.33033374  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037907  0.05184739  0.11693911]
Stock Position:  -0.0003790667779359044
Bond Position:  [4.97886243]


portfolio before change:  [4.94169736]
curr_Stock_Price:  101.32764602259118
curr_Factors:  [101.32764602  -1.22081241  -1.09727328]
mat_Sqrt:  [[ 9.97691168  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00591113 -0.04143678 -0.15278161]
Stock Position:  -0.005911133561740018
Bond Position:  [5.54065861]


portfolio before change:  [4.94004212]
curr_Stock_Price:  101.84202798628782
curr_Factors:  [101.84202799  -1.08012604  -1.09526593]
mat_Sqrt:  [[11.56555058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0095126  -0.03506484  0.64542438]
Stock Position:  -0.009512600958778627
Bond Position:  [5.90882469]


portfolio before change:  [4.9417223]
curr_Stock_Price:  101.82070987113707
curr_Factors:  [101.82070987  -0.74270714  -1.07503363]
mat_Sqrt:  [[16.53489092  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00266736 0.02307315 0.25047912]
Stock Position:  0.0026673617254946626
Bond Position:  [4.67012963]


portfolio before change:  [4.94176359]
curr_Stock_Price:  101.39842628340463
curr_Factors:  [101.39842628  -0.77745885  -1.06701931]
mat_Sqrt:  [[16.03188276  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00798944  0.00129776  0.22332183]
Stock Position:  -0.007989442069004826
Bond Position:  [5.75188045]


portfolio before change:  [4.94080391]
curr_Stock_Price:  101.6985515118814
curr_Factors:  [101.69855151  -0.92649854  -1.08920814]
mat_Sqrt:  [[13.54891376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00317284 -0.01386123  0.0619645 ]
Stock Position:  -0.003172842496019415
Bond Position:  [5.2634774]


portfolio before change:  [4.94202574]
curr_Stock_Price:  101.72824359678678
curr_Factors:  [101.7282436  -0.7913165  -1.0668535]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.94202574]
Stock Price:  103.04976839319
PL:  [1.89225734]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.36482919e-01 -6.84119179e-02  1.81098033e-01]
 [-7.32531642e-02  1.24166938e-01  9.69197657e-02]
 [-5.45126380e-02 -3.43187973e-01  2.99078982e-02]
 [-2.32656596e-02  4.27610640e-02  2.71556190e-02]
 [ 2.87142792e-01 -2.11380270e-01 -1.53863197e-01]
 [ 5.57867867e-02  1.72049875e-02  2.14264397e-03]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 2.90673162e-01  2.00770340e-02  2.59816038e-03]
 [-2.51506223e-01 -4.00673287e-03  3.26105509e-01]
 [ 5.47644938e-02  4.41440641e-02 -2.56446519e-02]
 [-1.31233290e-02 -7.40851145e-02 -1.33838509e-04]
 [ 1.33661661e-01  5.46261274e-02 -1.28290283e-01]
 [ 1.35539599e-02  8.14524863e-02  4.14534170e-02]
 [ 2.13586942e-01 -4.25611581e-01  1.22157081e-01]
 [-6.43991858e-02 -1.35800271e-02 -1.03846985e-01]
 [-2.70519921e-02  2.49335586e-01  4.69820010e-01]
 [ 3.13912210e-02 -8.66706740e-02 -5.69696818e-02]
 [ 5.79145605e-02  4.69869583e-02  1.52907217e-01]
 [-3.50949231e-02  4.71702059e-01  1.53236158e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.53832556]
curr_Stock_Price:  99.32935233208936
curr_Factors:  [99.32935233 -1.23196562 -1.01062394]
mat_Sqrt:  [[10.54710644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01908418 -0.02163375  0.51662228]
Stock Position:  -0.019084175061307863
Bond Position:  [-0.64270681]


portfolio before change:  [-2.54592742]
curr_Stock_Price:  99.71926490085235
curr_Factors:  [99.7192649  -1.12191861 -0.98116555]
mat_Sqrt:  [[12.17366164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00412887  0.03926503  0.27648511]
Stock Position:  -0.004128874682078815
Bond Position:  [-2.13419907]


portfolio before change:  [-2.54646755]
curr_Stock_Price:  99.72084242834501
curr_Factors:  [99.72084243 -1.18386368 -1.01635551]
mat_Sqrt:  [[11.04696271  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00518412 -0.10852557  0.08531891]
Stock Position:  -0.00518412080672247
Bond Position:  [-2.02950265]


portfolio before change:  [-2.54138529]
curr_Stock_Price:  98.64260739855962
curr_Factors:  [98.6426074  -0.96575559 -1.00397025]
mat_Sqrt:  [[13.76015987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00120772  0.01352224  0.07746742]
Stock Position:  -0.001207722610619403
Bond Position:  [-2.42225238]


portfolio before change:  [-2.54217381]
curr_Stock_Price:  98.79403387319093
curr_Factors:  [98.79403387 -0.64742255 -0.94718766]
mat_Sqrt:  [[20.05396747  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01248021 -0.06684431 -0.43892887]
Stock Position:  0.012480212869744193
Bond Position:  [-3.77514438]


portfolio before change:  [-2.52651873]
curr_Stock_Price:  100.1240577693511
curr_Factors:  [100.12405777  -0.47715949  -0.94789066]
mat_Sqrt:  [[24.0794756   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00235339 0.00544069 0.00611237]
Stock Position:  0.002353389413538177
Bond Position:  [-2.76214963]


portfolio before change:  [-2.53268864]
curr_Stock_Price:  97.79580659299556
curr_Factors:  [97.79580659 -0.3083377  -0.90265532]
mat_Sqrt:  [[29.13349915  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00019449 -0.02845143  0.0120735 ]
Stock Position:  -0.00019449410648722317
Bond Position:  [-2.51366793]


portfolio before change:  [-2.53318606]
curr_Stock_Price:  97.12187906806969
curr_Factors:  [97.12187907 -0.5351204  -0.88964645]
mat_Sqrt:  [[23.36408054  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01248591 0.00634892 0.00741183]
Stock Position:  0.012485913826601672
Bond Position:  [-3.74584147]


portfolio before change:  [-2.55017272]
curr_Stock_Price:  95.83642341902446
curr_Factors:  [95.83642342 -0.59836656 -0.83382335]
mat_Sqrt:  [[22.88434162  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00808604 -0.00126704  0.93028825]
Stock Position:  -0.008086038549896788
Bond Position:  [-1.77523571]


portfolio before change:  [-2.55706672]
curr_Stock_Price:  96.63411152876442
curr_Factors:  [96.63411153 -0.31027385 -0.83458488]
mat_Sqrt:  [[30.75562997  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00164749  0.01395958 -0.07315705]
Stock Position:  0.001647490103862716
Bond Position:  [-2.71627047]


portfolio before change:  [-2.55724265]
curr_Stock_Price:  96.93956251866479
curr_Factors:  [96.93956252 -0.40530889 -0.85614831]
mat_Sqrt:  [[27.45725734  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054862 -0.02342777 -0.0003818 ]
Stock Position:  -0.000548616997560472
Bond Position:  [-2.50405996]


portfolio before change:  [-2.55642092]
curr_Stock_Price:  94.30051915514792
curr_Factors:  [94.30051916 -0.66968437 -0.81134193]
mat_Sqrt:  [[21.44433272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00507756  0.0172743  -0.36597647]
Stock Position:  0.005077563306923541
Bond Position:  [-3.03523777]


portfolio before change:  [-2.56752097]
curr_Stock_Price:  92.26388282613702
curr_Factors:  [92.26388283 -0.67916479 -0.78949492]
mat_Sqrt:  [[21.24226963  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00113541 0.02575754 0.11825506]
Stock Position:  0.0011354105652210433
Bond Position:  [-2.67227836]


portfolio before change:  [-2.57034596]
curr_Stock_Price:  90.3642727822342
curr_Factors:  [90.36427278 -0.70976653 -0.77219232]
mat_Sqrt:  [[20.53005934  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01108292 -0.1345902   0.34848015]
Stock Position:  0.011082915243706078
Bond Position:  [-3.57184554]


portfolio before change:  [-2.57976352]
curr_Stock_Price:  89.59511710265119
curr_Factors:  [89.5951171  -0.64615677 -0.75865552]
mat_Sqrt:  [[21.98781703  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00390887 -0.00429438 -0.29624654]
Stock Position:  -0.003908869060716489
Bond Position:  [-2.22954794]


portfolio before change:  [-2.58724217]
curr_Stock_Price:  91.3657536777988
curr_Factors:  [91.36575368 -0.43017168 -0.77719704]
mat_Sqrt:  [[27.3168028   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00275609 0.07884684 1.34026572]
Stock Position:  0.0027560850930791274
Bond Position:  [-2.83905396]


portfolio before change:  [-2.58787775]
curr_Stock_Price:  91.39270022083188
curr_Factors:  [91.39270022 -0.41098416 -0.76863073]
mat_Sqrt:  [[28.09385092  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00062378 -0.02740767 -0.16251864]
Stock Position:  0.0006237844085573345
Bond Position:  [-2.64488709]


portfolio before change:  [-2.58681729]
curr_Stock_Price:  94.15288852867981
curr_Factors:  [94.15288853 -0.56361352 -0.74765202]
mat_Sqrt:  [[25.37220792  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00356058 0.01485858 0.43620173]
Stock Position:  0.003560581476340852
Bond Position:  [-2.92205632]


portfolio before change:  [-2.59494237]
curr_Stock_Price:  92.07612807340661
curr_Factors:  [92.07612807 -0.54070039 -0.74584377]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.59494237]
Stock Price:  90.32075178381263
PL:  [-2.59494237]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.86282632e-01 -2.12992610e-02  4.38748045e-02]
 [ 8.20142779e-02 -3.00911875e-02 -6.55299295e-02]
 [-3.08733258e-02 -2.86494024e-01  9.02352437e-03]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 5.03772802e-01 -4.18288522e-01 -3.68527438e-01]
 [ 4.69559695e-02 -3.58234477e-01 -2.50604605e-01]
 [ 6.83002494e-02 -1.14109086e-01 -1.39641840e-02]
 [-2.45490281e-02 -2.33722067e-01 -5.98321505e-02]
 [-1.11485905e-02  1.12297840e-02 -9.87492305e-02]
 [-3.53819750e-01  3.50001113e-01  3.33711796e-02]
 [ 1.20536166e-01 -2.46556528e-01  1.22108967e-01]
 [-2.03283398e-01 -4.81162859e-02 -4.22842925e-02]
 [-1.85161997e-01  7.43754299e-02 -1.91098322e-01]
 [-1.39455627e-01  8.40692459e-02  8.60877561e-02]
 [-1.72193545e-01 -1.45972817e-01  3.08769434e-01]
 [-1.28856593e-02 -1.26336679e-02 -7.29408820e-02]
 [-8.62924524e-02  6.31823014e-02  7.54789307e-02]
 [-2.36815653e-02  2.25154804e-02  1.93319931e-02]
 [ 2.18430804e-02  6.04454756e-01  5.10362953e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.21133217]
curr_Stock_Price:  102.49835300138837
curr_Factors:  [102.498353    -1.1738633   -1.02850492]
mat_Sqrt:  [[11.33027684  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01569923 -0.00673542  0.1251626 ]
Stock Position:  -0.015699234203321904
Bond Position:  [21.82047781]


portfolio before change:  [20.20248528]
curr_Stock_Price:  103.4093967383711
curr_Factors:  [103.40939674  -0.87927781  -1.04593699]
mat_Sqrt:  [[15.08168418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00449957 -0.00951567 -0.18693865]
Stock Position:  0.004499569484462321
Bond Position:  [19.73718751]


portfolio before change:  [20.21181967]
curr_Stock_Price:  104.38715156683175
curr_Factors:  [104.38715157  -0.79064875  -1.05691323]
mat_Sqrt:  [[16.45360529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221402 -0.09059737  0.0257416 ]
Stock Position:  -0.002214022391431427
Bond Position:  [20.44293516]


portfolio before change:  [20.21630935]
curr_Stock_Price:  104.66794966356916
curr_Factors:  [104.66794966  -0.91462125  -1.00138844]
mat_Sqrt:  [[15.40640395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00246286 -0.00455813 -0.02970002]
Stock Position:  -0.002462856180395772
Bond Position:  [20.47409145]


portfolio before change:  [20.21707407]
curr_Stock_Price:  106.43599309166946
curr_Factors:  [106.43599309  -0.76878528  -0.97238813]
mat_Sqrt:  [[18.65977962  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02238758 -0.13227444 -1.0513062 ]
Stock Position:  0.02238757899474929
Bond Position:  [17.83422987]


portfolio before change:  [20.25998278]
curr_Stock_Price:  108.15344495469111
curr_Factors:  [108.15344495  -0.94840484  -1.00964721]
mat_Sqrt:  [[15.26402812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00088103 -0.11328369 -0.71490518]
Stock Position:  -0.0008810292730745318
Bond Position:  [20.35526913]


portfolio before change:  [20.26597695]
curr_Stock_Price:  107.12655436544205
curr_Factors:  [107.12655437  -0.70492866  -1.03163446]
mat_Sqrt:  [[18.8676303   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00331274 -0.03608446 -0.03983593]
Stock Position:  0.003312739190361131
Bond Position:  [19.91109462]


portfolio before change:  [20.27037196]
curr_Stock_Price:  106.95044911424995
curr_Factors:  [106.95044911  -0.61883745  -0.99426442]
mat_Sqrt:  [[21.31186081  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200813 -0.07390941 -0.17068447]
Stock Position:  -0.0020081255641876783
Bond Position:  [20.48514189]


portfolio before change:  [20.28399451]
curr_Stock_Price:  102.71733563084793
curr_Factors:  [102.71733563  -0.21123567  -1.03176336]
mat_Sqrt:  [[29.63576372  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00104656  0.00355117 -0.28170407]
Stock Position:  -0.0010465645948803436
Bond Position:  [20.39149483]


portfolio before change:  [20.28693028]
curr_Stock_Price:  104.78384530949452
curr_Factors:  [104.78384531  -0.21592059  -1.03895617]
mat_Sqrt:  [[29.87502496  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01131282  0.11068007  0.09519869]
Stock Position:  -0.011312823908956883
Bond Position:  [21.47233147]


portfolio before change:  [20.24698777]
curr_Stock_Price:  108.78914607016847
curr_Factors:  [108.78914607  -0.50200622  -1.0330146 ]
mat_Sqrt:  [[23.43875268  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00593442 -0.07796802  0.3483429 ]
Stock Position:  0.005934423823188832
Bond Position:  [19.60138687]


portfolio before change:  [20.25111459]
curr_Stock_Price:  108.6586959514422
curr_Factors:  [108.65869595  -0.84317383  -1.06280967]
mat_Sqrt:  [[16.15497795  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01319451 -0.01521571 -0.12062532]
Stock Position:  -0.013194508919309442
Bond Position:  [21.68481272]


portfolio before change:  [20.24660801]
curr_Stock_Price:  109.411164974709
curr_Factors:  [109.41116497  -0.87182965  -1.0836776 ]
mat_Sqrt:  [[15.48087958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01435638  0.02351958 -0.54515032]
Stock Position:  -0.014356381521970869
Bond Position:  [21.81735643]


portfolio before change:  [20.23280706]
curr_Stock_Price:  110.75244751076441
curr_Factors:  [110.75244751  -0.92374493  -1.08174049]
mat_Sqrt:  [[14.90671949  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00803077  0.02658503  0.24558441]
Stock Position:  -0.008030766213786426
Bond Position:  [21.12223408]


portfolio before change:  [20.23153002]
curr_Stock_Price:  111.56909030229399
curr_Factors:  [111.5690903   -0.97207433  -1.04094142]
mat_Sqrt:  [[14.90397992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00757752 -0.04616066  0.88083325]
Stock Position:  -0.007577522958299518
Bond Position:  [21.07694736]


portfolio before change:  [20.24594473]
curr_Stock_Price:  110.36225478482844
curr_Factors:  [110.36225478  -0.68057145  -1.05221154]
mat_Sqrt:  [[19.5111323   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144025 -0.00399512 -0.20808003]
Stock Position:  -0.0014402472389731583
Bond Position:  [20.40489367]


portfolio before change:  [20.25005119]
curr_Stock_Price:  111.05339094290461
curr_Factors:  [111.05339094  -0.67886615  -1.03776819]
mat_Sqrt:  [[19.95294492  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347087  0.01998     0.21532038]
Stock Position:  -0.0034708671070688034
Bond Position:  [20.63550275]


portfolio before change:  [20.25608283]
curr_Stock_Price:  110.80212081506797
curr_Factors:  [110.80212082  -0.62652767  -1.04334364]
mat_Sqrt:  [[20.86085845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00091818  0.00712002  0.0551488 ]
Stock Position:  -0.0009181832865346771
Bond Position:  [20.35781949]


portfolio before change:  [20.2592944]
curr_Stock_Price:  112.84803822745992
curr_Factors:  [112.84803823  -0.7134438   -1.03616708]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.2592944]
Stock Price:  110.6029153520309
PL:  [9.65637905]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.77462229e-01 -3.01737866e-02  8.62838168e-02]
 [ 2.98357520e-02  6.99424764e-02  1.11557777e-01]
 [-2.90053530e-02 -1.77494383e-01  4.47189480e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 7.46278572e-01 -4.56980213e-01 -2.05725615e-01]
 [-8.52817472e-02  6.75469753e-02  2.40349368e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 2.90904122e-01  1.79169953e-02  1.27961206e-02]
 [-1.87551651e-01  4.72214243e-03  2.34432887e-01]
 [-1.28343286e-01  1.03971268e-01 -3.90692554e-02]
 [-2.50903329e-02 -6.64290825e-02 -4.03179537e-03]
 [ 1.26073723e-01  6.88457653e-02 -1.07958721e-01]
 [ 3.82983300e-02  1.23564030e-01  8.94684877e-02]
 [ 1.59371873e-01 -2.19187428e-01  1.15998718e-01]
 [-8.40383855e-02 -4.80365167e-02 -5.50009959e-02]
 [-2.76585344e-02  2.23411872e-01  3.85065657e-01]
 [ 2.29872491e-02 -6.59475772e-02 -6.39445468e-02]
 [ 1.10456310e-01  5.40849129e-02  1.88316293e-01]
 [-4.90997212e-02  3.57367717e-01  4.28921757e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.51066149]
curr_Stock_Price:  100.31126797095604
curr_Factors:  [100.31126797  -1.08651138  -0.9939386 ]
mat_Sqrt:  [[12.52627016  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02080657 -0.00954179  0.24614371]
Stock Position:  -0.020806568873878894
Bond Position:  [6.5977948]


portfolio before change:  [4.49612738]
curr_Stock_Price:  101.08908798611732
curr_Factors:  [101.08908799  -1.61998594  -1.00824836]
mat_Sqrt:  [[ 7.29922289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00745467 0.02211775 0.31824329]
Stock Position:  0.007454669578936679
Bond Position:  [3.74254164]


portfolio before change:  [4.4967156]
curr_Stock_Price:  101.04246825840062
curr_Factors:  [101.04246826  -1.57078882  -0.98424353]
mat_Sqrt:  [[ 7.84996094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311594 -0.05612865  0.12757071]
Stock Position:  -0.0031159417751806975
Bond Position:  [4.81155805]


portfolio before change:  [4.49698676]
curr_Stock_Price:  101.3415364298617
curr_Factors:  [101.34153643  -1.43892058  -0.98289518]
mat_Sqrt:  [[ 8.99510551  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00421827 -0.00455813 -0.02970002]
Stock Position:  -0.004218267051731139
Bond Position:  [4.92447243]


portfolio before change:  [4.50454689]
curr_Stock_Price:  99.84119042844624
curr_Factors:  [99.84119043 -1.31609789 -0.979586  ]
mat_Sqrt:  [[10.05325978  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06888172 -0.14450983 -0.58687792]
Stock Position:  0.06888172026748443
Bond Position:  [-2.37268606]


portfolio before change:  [4.41339533]
curr_Stock_Price:  98.52649738182726
curr_Factors:  [98.52649738 -1.09097745 -1.0318879 ]
mat_Sqrt:  [[11.79245787  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00666796  0.02136023  0.06856498]
Stock Position:  -0.0066679552076377
Bond Position:  [5.0703656]


portfolio before change:  [4.41904783]
curr_Stock_Price:  97.86891267133295
curr_Factors:  [97.86891267 -1.28475972 -0.98948329]
mat_Sqrt:  [[10.06824038  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056279 -0.02845143  0.0120735 ]
Stock Position:  -0.0005627888961046524
Bond Position:  [4.47412736]


portfolio before change:  [4.41998042]
curr_Stock_Price:  98.19955233925182
curr_Factors:  [98.19955234 -1.25417098 -1.01096079]
mat_Sqrt:  [[10.19471943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02883637 0.00566585 0.03650377]
Stock Position:  0.02883637319716384
Bond Position:  [1.58826148]


portfolio before change:  [4.39402515]
curr_Stock_Price:  97.28569318777963
curr_Factors:  [97.28569319 -1.00259606 -1.05582046]
mat_Sqrt:  [[12.41909752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01123885  0.00149327  0.66877177]
Stock Position:  -0.011238845045947148
Bond Position:  [5.48740398]


portfolio before change:  [4.3947261]
curr_Stock_Price:  97.3454030320282
curr_Factors:  [97.34540303 -1.08559079 -1.08916923]
mat_Sqrt:  [[11.06188582  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01208056  0.0328786  -0.11145371]
Stock Position:  -0.012080556610820315
Bond Position:  [5.57071275]


portfolio before change:  [4.41346113]
curr_Stock_Price:  95.90985895157702
curr_Factors:  [95.90985895 -0.89159599 -1.05490042]
mat_Sqrt:  [[13.69337808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00201765 -0.02100672 -0.01150159]
Stock Position:  -0.0020176548884200066
Bond Position:  [4.60697412]


portfolio before change:  [4.4159739]
curr_Stock_Price:  95.23536904316798
curr_Factors:  [95.23536904 -0.70999431 -1.05371656]
mat_Sqrt:  [[16.32406692  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00648211  0.02177094 -0.30797618]
Stock Position:  0.006482105953214875
Bond Position:  [3.79864815]


portfolio before change:  [4.41141538]
curr_Stock_Price:  94.38559930332038
curr_Factors:  [94.3855993  -0.65210616 -1.04524523]
mat_Sqrt:  [[17.28842362  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00345615 0.03907438 0.25522869]
Stock Position:  0.0034561518998429625
Bond Position:  [4.08520442]


portfolio before change:  [4.4101188]
curr_Stock_Price:  93.71490842956719
curr_Factors:  [93.71490843 -0.68958428 -1.00842205]
mat_Sqrt:  [[17.15433575  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01034086 -0.06931315  0.33091205]
Stock Position:  0.010340861877724991
Bond Position:  [3.44102588]


portfolio before change:  [4.39668999]
curr_Stock_Price:  92.33309154625415
curr_Factors:  [92.33309155 -0.84418526 -0.93727358]
mat_Sqrt:  [[15.5481827   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00620688 -0.01519048 -0.15690253]
Stock Position:  -0.006206880645952282
Bond Position:  [4.96979047]


portfolio before change:  [4.38939432]
curr_Stock_Price:  93.70870496747007
curr_Factors:  [93.70870497 -0.83905243 -0.93140132]
mat_Sqrt:  [[15.95444285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00355457 0.07064904 1.09848514]
Stock Position:  0.0035545668367207212
Bond Position:  [4.05630047]


portfolio before change:  [4.39034372]
curr_Stock_Price:  93.690472777822
curr_Factors:  [93.69047278 -0.97392811 -0.95246893]
mat_Sqrt:  [[13.64808841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00060315 -0.02085445 -0.18241599]
Stock Position:  0.0006031514275889026
Bond Position:  [4.33383418]


portfolio before change:  [4.39035245]
curr_Stock_Price:  91.90840246027233
curr_Factors:  [91.90840246 -0.74814951 -0.94560637]
mat_Sqrt:  [[16.89531859  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00889552 0.01710315 0.53721397]
Stock Position:  0.008895522008970088
Bond Position:  [3.57277924]


portfolio before change:  [4.37829409]
curr_Stock_Price:  90.45242636919217
curr_Factors:  [90.45242637 -1.21765761 -0.92152407]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.37829409]
Stock Price:  90.64018792266766
PL:  [4.37829409]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.10261270e-01 -3.70083321e-02  1.11361240e-01]
 [-4.62644029e-02  1.09970930e-01  1.00752009e-01]
 [-8.20417389e-02 -4.48917968e-01  2.02896007e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 5.14076098e-01 -3.39067882e-01 -1.92123993e-01]
 [ 6.33788724e-02  1.25505741e-02 -2.20039292e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 6.80321729e-02 -1.87539222e-02 -8.86865775e-03]
 [-2.73378098e-02  2.95085479e-02 -1.00258993e-02]
 [-2.97057118e-01  2.81344013e-01  1.95705446e-02]
 [ 5.83164918e-02 -1.17019590e-01  3.42348578e-03]
 [ 3.71309991e-03  7.05757956e-02  4.36711957e-02]
 [-1.72092527e-02  1.60391676e-01  3.92421705e-02]
 [-3.25623530e-02 -1.52360224e-01 -9.29632643e-02]
 [-1.37860045e-01 -9.75405232e-02  2.01604522e-01]
 [ 1.68872000e-02  1.25252384e-01  1.90215555e-01]
 [-6.84607532e-02  1.15705894e-01  3.29769734e-02]
 [-3.10597826e-02 -3.18457204e-02  4.10523971e-02]
 [-3.90855512e-02  4.29046725e-01  1.50750946e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.55760189]
curr_Stock_Price:  99.89991022811849
curr_Factors:  [99.89991023 -1.18995729 -1.01638485]
mat_Sqrt:  [[10.99924511  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02622774 -0.01170306  0.31768262]
Stock Position:  -0.026227736602519102
Bond Position:  [4.17775043]


portfolio before change:  [1.5509362]
curr_Stock_Price:  100.19388390630571
curr_Factors:  [100.19388391  -1.32993964  -1.03949204]
mat_Sqrt:  [[ 9.37152156  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0024392   0.03477586  0.28741744]
Stock Position:  -0.002439203479806915
Bond Position:  [1.79532947]


portfolio before change:  [1.55293161]
curr_Stock_Price:  99.55985382898237
curr_Factors:  [99.55985383 -1.40662367 -1.0695312 ]
mat_Sqrt:  [[ 8.36958367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01069243 -0.14196033  0.05788058]
Stock Position:  -0.010692425947357797
Bond Position:  [2.61746798]


portfolio before change:  [1.54895676]
curr_Stock_Price:  99.9928056550936
curr_Factors:  [99.99280566 -1.28497189 -1.06132358]
mat_Sqrt:  [[ 9.5716229   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00396419 -0.00455813 -0.02970002]
Stock Position:  -0.003964192653402952
Bond Position:  [1.9453475]


portfolio before change:  [1.5472744]
curr_Stock_Price:  100.53989198183164
curr_Factors:  [100.53989198  -1.20934378  -1.07278296]
mat_Sqrt:  [[10.26179574  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04542132 -0.10722268 -0.54807628]
Stock Position:  0.04542131501791704
Bond Position:  [-3.01937971]


portfolio before change:  [1.54601797]
curr_Stock_Price:  100.52885117548635
curr_Factors:  [100.52885118  -0.81126819  -1.10646422]
mat_Sqrt:  [[14.77168762  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00400844  0.00396884 -0.06277109]
Stock Position:  0.004008437976020317
Bond Position:  [1.14305431]


portfolio before change:  [1.54454557]
curr_Stock_Price:  100.09022524910333
curr_Factors:  [100.09022525  -0.71341317  -1.09814894]
mat_Sqrt:  [[16.35461186  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034646 -0.02845143  0.0120735 ]
Stock Position:  -0.0003464645896778887
Bond Position:  [1.57922329]


portfolio before change:  [1.54539073]
curr_Stock_Price:  98.79050947600993
curr_Factors:  [98.79050948 -0.54879048 -1.05673241]
mat_Sqrt:  [[19.83560687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00331412 -0.00593051 -0.02529981]
Stock Position:  0.003314123031020383
Bond Position:  [1.21798683]


portfolio before change:  [1.55125666]
curr_Stock_Price:  100.46859941663897
curr_Factors:  [100.46859942  -0.79776269  -1.08005756]
mat_Sqrt:  [[15.36396738  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00186296  0.00933142 -0.0286011 ]
Stock Position:  -0.0018629582941392957
Bond Position:  [1.73842547]


portfolio before change:  [1.55072562]
curr_Stock_Price:  100.98697084323801
curr_Factors:  [100.98697084  -1.17291547  -1.06676726]
mat_Sqrt:  [[10.75433333  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02657515  0.08896879  0.05582932]
Stock Position:  -0.02657515042345087
Bond Position:  [4.23446956]


portfolio before change:  [1.56050325]
curr_Stock_Price:  100.65888656852262
curr_Factors:  [100.65888657  -1.2291933   -1.09644635]
mat_Sqrt:  [[ 9.83647866  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00569247 -0.03700484  0.00976625]
Stock Position:  0.005692471573400932
Bond Position:  [0.9875054]


portfolio before change:  [1.56516341]
curr_Stock_Price:  101.43416459635965
curr_Factors:  [101.4341646   -1.28111204  -1.15756264]
mat_Sqrt:  [[ 8.85281312  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00163222 0.02231803 0.12458177]
Stock Position:  0.0016322161552475623
Bond Position:  [1.39960093]


portfolio before change:  [1.56429478]
curr_Stock_Price:  100.68759017291131
curr_Factors:  [100.68759017  -1.13459795  -1.14009324]
mat_Sqrt:  [[10.35356979  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004885   0.0507203   0.11194699]
Stock Position:  -0.0004884965346758389
Bond Position:  [1.61348032]


portfolio before change:  [1.56491633]
curr_Stock_Price:  100.24107309252881
curr_Factors:  [100.24107309  -1.31568422  -1.11191648]
mat_Sqrt:  [[ 8.84610551  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00627082 -0.04818053 -0.26519832]
Stock Position:  -0.006270818708306351
Bond Position:  [2.19350992]


portfolio before change:  [1.56690021]
curr_Stock_Price:  100.01216490164806
curr_Factors:  [100.0121649   -1.26702687  -1.0716515 ]
mat_Sqrt:  [[ 9.64667649  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01028605 -0.03084502  0.57512158]
Stock Position:  -0.010286048194209781
Bond Position:  [2.59563016]


portfolio before change:  [1.57079388]
curr_Stock_Price:  99.6967205049515
curr_Factors:  [99.6967205  -1.21302289 -1.07919923]
mat_Sqrt:  [[10.07352472  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00585185 0.03960828 0.54263203]
Stock Position:  0.005851853427428354
Bond Position:  [0.98738328]


portfolio before change:  [1.56704605]
curr_Stock_Price:  99.0140817309983
curr_Factors:  [99.01408173 -0.93258708 -1.04732017]
mat_Sqrt:  [[13.67206681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429649  0.03658942  0.09407413]
Stock Position:  -0.004296485980882358
Bond Position:  [1.99245867]


portfolio before change:  [1.57363472]
curr_Stock_Price:  97.59652960524838
curr_Factors:  [97.59652961 -1.33421859 -1.03577133]
mat_Sqrt:  [[ 9.12348635  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257602 -0.0100705   0.11711106]
Stock Position:  -0.0025760163618906064
Bond Position:  [1.82504498]


portfolio before change:  [1.57520486]
curr_Stock_Price:  97.16414764767765
curr_Factors:  [97.16414765 -1.19289125 -1.07061321]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.57520486]
Stock Price:  96.9261526158662
PL:  [1.57520486]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.10483960e-01 -2.36547803e-02  5.51312087e-02]
 [ 6.96154615e-02  2.53499212e-02  1.33787357e-02]
 [-5.97205475e-03 -8.17766227e-02  3.82116710e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 2.94057647e-01 -2.51960988e-01 -2.30989391e-01]
 [ 5.51918451e-03  7.49056616e-03 -4.44229316e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 4.75250572e-03 -3.17648630e-02 -2.98808310e-03]
 [-3.54106407e-02  2.86563880e-02  2.79408366e-04]
 [-2.75847967e-01  2.61189028e-01  2.15442190e-02]
 [ 8.02590188e-02 -1.29718640e-01  6.93055640e-04]
 [-1.97016366e-02  5.31922678e-02  3.70545415e-02]
 [-4.09688321e-02  1.60082301e-01  1.12560600e-02]
 [-6.20528569e-02  6.59882835e-02 -4.49142514e-02]
 [-2.56523870e-01 -1.68497939e-01  3.03153114e-01]
 [ 3.62945025e-02  1.09075971e-01  1.87945213e-01]
 [-9.20082790e-02  5.29574827e-02  8.10822591e-02]
 [-3.59448532e-02 -1.38189298e-02  2.10376075e-02]
 [-1.84802750e-02  5.09375000e-01  2.93278447e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.16987389]
curr_Stock_Price:  101.37818728460324
curr_Factors:  [101.37818728  -1.23339385  -1.03530299]
mat_Sqrt:  [[10.48725919  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01905561 -0.0074803   0.15727399]
Stock Position:  -0.019055609212585967
Bond Position:  [14.10169701]


portfolio before change:  [12.16172521]
curr_Stock_Price:  101.99084404820853
curr_Factors:  [101.99084405  -1.03550542  -1.05980193]
mat_Sqrt:  [[12.54818068  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00581765 0.00801635 0.03816581]
Stock Position:  0.0058176494668086085
Bond Position:  [11.56837823]


portfolio before change:  [12.16311502]
curr_Stock_Price:  101.73255278735334
curr_Factors:  [101.73255279  -1.27040764  -1.07794574]
mat_Sqrt:  [[ 9.71813728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.91818674e-05 -2.58600387e-02  1.09007261e-01]
Stock Position:  -2.9181867351610284e-05
Bond Position:  [12.16608376]


portfolio before change:  [12.1661533]
curr_Stock_Price:  101.8566376899879
curr_Factors:  [101.85663769  -1.05033071  -1.077226  ]
mat_Sqrt:  [[12.13397788  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00312707 -0.00455813 -0.02970002]
Stock Position:  -0.0031270666213454837
Bond Position:  [12.48466579]


portfolio before change:  [12.16798977]
curr_Stock_Price:  102.26759098631514
curr_Factors:  [102.26759099  -1.11824492  -1.0737122 ]
mat_Sqrt:  [[11.42307797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02104525 -0.07967706 -0.65894844]
Stock Position:  0.021045249903955312
Bond Position:  [10.01574276]


portfolio before change:  [12.14664111]
curr_Stock_Price:  101.13418012591329
curr_Factors:  [101.13418013  -1.05293879  -1.06914339]
mat_Sqrt:  [[12.11405043  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027697  0.00236873 -0.12672626]
Stock Position:  -0.00027696787748130385
Bond Position:  [12.17465203]


portfolio before change:  [12.14992764]
curr_Stock_Price:  100.2586675179175
curr_Factors:  [100.25866752  -1.08630534  -1.02245424]
mat_Sqrt:  [[12.17024385  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046559 -0.02845143  0.0120735 ]
Stock Position:  -0.0004655858958543416
Bond Position:  [12.19660666]


portfolio before change:  [12.1530377]
curr_Stock_Price:  100.12866626890855
curr_Factors:  [100.12866627  -1.04534594  -1.03484049]
mat_Sqrt:  [[12.50676366  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00026565 -0.01004493 -0.00852417]
Stock Position:  0.00026564830585799773
Bond Position:  [12.12643869]


portfolio before change:  [12.15614333]
curr_Stock_Price:  100.40589312296328
curr_Factors:  [100.40589312  -1.0397942   -0.99933029]
mat_Sqrt:  [[13.06708425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264892  0.00906195  0.00079707]
Stock Position:  -0.0026489231474270602
Bond Position:  [12.42211083]


portfolio before change:  [12.15833414]
curr_Stock_Price:  100.75135849135991
curr_Factors:  [100.75135849  -1.13552765  -1.0250966 ]
mat_Sqrt:  [[11.61191154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02279611  0.08259522  0.06145966]
Stock Position:  -0.022796108884557836
Bond Position:  [14.45507308]


portfolio before change:  [12.14490572]
curr_Stock_Price:  101.49897031654066
curr_Factors:  [101.49897032  -1.16884392  -0.99435773]
mat_Sqrt:  [[11.66796434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00660365 -0.04102064  0.00197709]
Stock Position:  0.006603651255985927
Bond Position:  [11.47464191]


portfolio before change:  [12.15127922]
curr_Stock_Price:  102.02965868074561
curr_Factors:  [102.02965868  -0.90249835  -0.98186068]
mat_Sqrt:  [[15.50099952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069444  0.01682087  0.10570629]
Stock Position:  -0.0006944385460562837
Bond Position:  [12.22213255]


portfolio before change:  [12.15310587]
curr_Stock_Price:  103.79981900181869
curr_Factors:  [103.799819    -1.57128055  -1.01551704]
mat_Sqrt:  [[ 7.81204392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00442111  0.05062247  0.03211041]
Stock Position:  -0.004421108182201674
Bond Position:  [12.61201609]


portfolio before change:  [12.15243506]
curr_Stock_Price:  104.66480569259527
curr_Factors:  [104.66480569  -1.68018375  -1.04377945]
mat_Sqrt:  [[ 6.86749707  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01012263  0.02086733 -0.12812786]
Stock Position:  -0.010122629710979925
Bond Position:  [13.21191814]


portfolio before change:  [12.16110747]
curr_Stock_Price:  104.13440812841527
curr_Factors:  [104.13440813  -1.89395955  -1.02997041]
mat_Sqrt:  [[ 5.59432385  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03557063 -0.05328373  0.86481145]
Stock Position:  -0.03557062535877153
Bond Position:  [15.86523349]


portfolio before change:  [12.14847619]
curr_Stock_Price:  104.60103172785335
curr_Factors:  [104.60103173  -1.84458739  -1.0003723 ]
mat_Sqrt:  [[ 6.08114944  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01274019 0.03449285 0.53615538]
Stock Position:  0.0127401881037906
Bond Position:  [10.81583937]


portfolio before change:  [12.16231048]
curr_Stock_Price:  105.47464526077691
curr_Factors:  [105.47464526  -1.6167425   -0.98326915]
mat_Sqrt:  [[ 7.83388807  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00945764  0.01674663  0.23130512]
Stock Position:  -0.009457637791068582
Bond Position:  [13.15985147]


portfolio before change:  [12.16029781]
curr_Stock_Price:  106.03536123530851
curr_Factors:  [106.03536124  -1.5687886   -0.9376901 ]
mat_Sqrt:  [[ 8.64770473  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00370126 -0.00436993  0.06001444]
Stock Position:  -0.003701256437107495
Bond Position:  [12.55276187]


portfolio before change:  [12.16228999]
curr_Stock_Price:  106.34509435106625
curr_Factors:  [106.34509435  -1.54243326  -0.94607654]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.16228999]
Stock Price:  106.05998182862353
PL:  [6.10230816]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.92423486e-01 -3.16299682e-02  9.32425239e-02]
 [-4.75722175e-02  1.10658837e-01  1.00566307e-01]
 [-1.41122164e-01 -5.13208263e-01 -4.29525813e-02]
 [-7.69458903e-03  1.99819060e-01  1.53987752e-01]
 [ 2.16529747e-01 -1.34593139e-01 -1.03391101e-01]
 [-9.54098288e-02  7.01703383e-02  2.32042605e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 4.23199293e-01  4.16901112e-02  1.63718867e-02]
 [-2.06584776e-01  2.74042884e-03  2.58590477e-01]
 [-1.94369715e-01  1.79860435e-01  1.31576836e-02]
 [-3.53790720e-02 -6.17432382e-02  6.85254686e-03]
 [ 4.33377277e-02  8.02983377e-02 -2.17837015e-02]
 [ 3.26672284e-02  1.52587570e-01  9.47125578e-02]
 [ 9.80018800e-02 -1.42247345e-01  7.52493494e-02]
 [-1.03211080e-01 -7.17932914e-02  1.57935757e-01]
 [-6.79460498e-03  1.85042854e-01  2.76629643e-01]
 [ 1.27146073e-03  9.37350728e-03 -2.05484700e-02]
 [-3.44317650e-02 -3.37161328e-02  3.85399263e-02]
 [-4.23721544e-02  4.03287316e-01  1.32163149e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.92755766]
curr_Stock_Price:  100.09074346176325
curr_Factors:  [100.09074346  -1.07635311  -0.93917061]
mat_Sqrt:  [[13.33715152  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02055965 -0.01000227  0.26599497]
Stock Position:  -0.02055964627189254
Bond Position:  [4.98538794]


portfolio before change:  [2.92823919]
curr_Stock_Price:  100.11822333637004
curr_Factors:  [100.11822334  -1.27180979  -0.92292631]
mat_Sqrt:  [[11.15196385  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00216886  0.0349934   0.28688768]
Stock Position:  -0.002168856314875643
Bond Position:  [3.14538123]


portfolio before change:  [2.93205676]
curr_Stock_Price:  98.720654769257
curr_Factors:  [98.72065477 -1.19303676 -0.88119964]
mat_Sqrt:  [[12.4044812   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01315176 -0.1622907  -0.12253176]
Stock Position:  -0.013151763510115195
Bond Position:  [4.23040746]


portfolio before change:  [2.94987301]
curr_Stock_Price:  97.44641352375547
curr_Factors:  [97.44641352 -0.87440661 -0.88911405]
mat_Sqrt:  [[16.70623426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00172973 0.06318834 0.43928419]
Stock Position:  0.001729733624429975
Bond Position:  [2.78131667]


portfolio before change:  [2.94951643]
curr_Stock_Price:  96.83823037398277
curr_Factors:  [96.83823037 -0.78599563 -0.8545705 ]
mat_Sqrt:  [[18.77405241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01022421 -0.04256209 -0.29494603]
Stock Position:  0.010224214957083973
Bond Position:  [1.95942155]


portfolio before change:  [2.96818525]
curr_Stock_Price:  98.61625438594457
curr_Factors:  [98.61625439 -1.23680851 -0.84964036]
mat_Sqrt:  [[12.24095416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00725936  0.02218981  0.0661953 ]
Stock Position:  -0.007259359645723128
Bond Position:  [3.68407611]


portfolio before change:  [2.98047836]
curr_Stock_Price:  97.0497280726269
curr_Factors:  [97.04972807 -1.12646993 -0.81651054]
mat_Sqrt:  [[13.90492428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004075  -0.02845143  0.0120735 ]
Stock Position:  -0.0004075026783514983
Bond Position:  [3.02002639]


portfolio before change:  [2.98140982]
curr_Stock_Price:  96.61695369098432
curr_Factors:  [96.61695369 -1.03715185 -0.78400644]
mat_Sqrt:  [[15.63631269  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02734773 0.01318357 0.04670444]
Stock Position:  0.027347727895176054
Bond Position:  [0.33915566]


portfolio before change:  [2.99743693]
curr_Stock_Price:  97.19990202680087
curr_Factors:  [97.19990203 -1.55928703 -0.78001947]
mat_Sqrt:  [[ 9.36953247  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01640738  0.0008666   0.73768665]
Stock Position:  -0.01640737772512114
Bond Position:  [4.59223244]


portfolio before change:  [2.98006337]
curr_Stock_Price:  98.32876968052403
curr_Factors:  [98.32876968 -1.51113171 -0.77088474]
mat_Sqrt:  [[10.03722024  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01863464  0.05687686  0.03753521]
Stock Position:  -0.0186346351750764
Bond Position:  [4.81238412]


portfolio before change:  [2.97672919]
curr_Stock_Price:  98.57226394776508
curr_Factors:  [98.57226395 -1.8062154  -0.76131347]
mat_Sqrt:  [[ 7.56294796  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00470379 -0.01952493  0.01954841]
Stock Position:  -0.004703788181838984
Bond Position:  [3.44039224]


portfolio before change:  [2.98023915]
curr_Stock_Price:  98.00894035598776
curr_Factors:  [98.00894036 -1.56231213 -0.75041005]
mat_Sqrt:  [[ 9.70204336  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00422225  0.02539256 -0.06214284]
Stock Position:  0.004222248955028105
Bond Position:  [2.56642101]


portfolio before change:  [2.98027435]
curr_Stock_Price:  97.8652995909078
curr_Factors:  [97.86529959 -1.38569179 -0.73579339]
mat_Sqrt:  [[11.72949794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00476918 0.04825243 0.27018856]
Stock Position:  0.004769184724834222
Bond Position:  [2.51353666]


portfolio before change:  [2.97873861]
curr_Stock_Price:  97.41151117178433
curr_Factors:  [97.41151117 -1.28340621 -0.73155074]
mat_Sqrt:  [[12.98750107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00844576 -0.04498256  0.21466545]
Stock Position:  0.00844575703121961
Bond Position:  [2.15602466]


portfolio before change:  [2.98212543]
curr_Stock_Price:  97.74869159717406
curr_Factors:  [97.7486916  -1.15596097 -0.70207852]
mat_Sqrt:  [[15.2466579   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00477654 -0.02270303  0.45054675]
Stock Position:  -0.004776540127079083
Bond Position:  [3.44902598]


portfolio before change:  [2.97872781]
curr_Stock_Price:  98.64054734168853
curr_Factors:  [98.64054734 -0.93625063 -0.70978228]
mat_Sqrt:  [[19.01920952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00286289 0.05851569 0.78914737]
Stock Position:  0.002862893453775591
Bond Position:  [2.69633043]


portfolio before change:  [2.97606892]
curr_Stock_Price:  97.47631930171893
curr_Factors:  [97.4763193  -1.31786346 -0.70004206]
mat_Sqrt:  [[12.95787809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0002069   0.00296416 -0.05861907]
Stock Position:  -0.0002068977042724475
Bond Position:  [2.99623654]


portfolio before change:  [2.97672569]
curr_Stock_Price:  97.92282373614442
curr_Factors:  [97.92282374 -1.66073221 -0.66893587]
mat_Sqrt:  [[ 9.53063714  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00287865 -0.01066198  0.10994368]
Stock Position:  -0.0028786514385891965
Bond Position:  [3.25861137]


portfolio before change:  [2.97706164]
curr_Stock_Price:  98.089151783485
curr_Factors:  [98.08915178 -1.91752337 -0.62139069]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.97706164]
Stock Price:  97.6049585806945
PL:  [2.97706164]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.07069715e-01 -3.30554882e-02  1.00054707e-01]
 [-3.04918828e-02  9.49802957e-02  7.36253681e-02]
 [-4.85900712e-02 -2.43188461e-01  3.51091760e-02]
 [-4.99425157e-03  2.12371787e-01  1.66983296e-01]
 [ 5.43434920e-01 -3.36563860e-01 -1.64273946e-01]
 [-1.14764002e-02  4.93769096e-02  1.32939403e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 2.00011591e-01  1.63209212e-03  1.01159992e-02]
 [-7.83091812e-02  2.41280609e-02  5.50411965e-02]
 [-1.81031730e-01  1.62601661e-01 -5.77501070e-03]
 [ 5.21383736e-02 -1.13400005e-01  3.84726032e-03]
 [ 2.00699006e-02  8.10702225e-02  4.59764625e-02]
 [-2.34784831e-02  1.74237776e-01  3.72592380e-02]
 [-5.73848129e-02 -8.73996590e-02 -1.57094886e-02]
 [-1.49176596e-01 -1.05949717e-01  2.15866991e-01]
 [ 2.17416584e-02  8.37358372e-02  1.01584227e-01]
 [-3.78795272e-03  2.43769822e-02 -9.57068451e-03]
 [ 9.64178295e-02  5.16965552e-02  1.77718216e-01]
 [-3.79925468e-02  4.48719081e-01  1.23762639e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.9907369]
curr_Stock_Price:  99.82094659825476
curr_Factors:  [99.8209466  -0.7829984  -1.04198648]
mat_Sqrt:  [[16.09314116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01786473 -0.01045306  0.28542823]
Stock Position:  -0.017864730042923174
Bond Position:  [2.77401116]


portfolio before change:  [0.98636477]
curr_Stock_Price:  100.10450645398312
curr_Factors:  [100.10450645  -1.06998702  -1.01066722]
mat_Sqrt:  [[12.49789792  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00104104  0.03003541  0.21003268]
Stock Position:  -0.001041038007143047
Bond Position:  [1.09057736]


portfolio before change:  [0.98721262]
curr_Stock_Price:  99.55200416648486
curr_Factors:  [99.55200417 -0.72033555 -1.01405289]
mat_Sqrt:  [[17.57173637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00271473 -0.07690294  0.10015671]
Stock Position:  -0.0027147311325195224
Bond Position:  [1.25746955]


portfolio before change:  [0.99379268]
curr_Stock_Price:  97.24398451103377
curr_Factors:  [97.24398451 -0.86643789 -1.00380195]
mat_Sqrt:  [[14.98400481  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00230743 0.06715786 0.47635686]
Stock Position:  0.002307426309009078
Bond Position:  [0.76940935]


portfolio before change:  [0.9975818]
curr_Stock_Price:  98.80275317362114
curr_Factors:  [98.80275317 -1.03647115 -0.97554329]
mat_Sqrt:  [[13.21180877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03793671 -0.10643084 -0.46862784]
Stock Position:  0.0379367131645305
Bond Position:  [-2.75066991]


portfolio before change:  [1.01954786]
curr_Stock_Price:  99.39990064238138
curr_Factors:  [99.39990064 -1.10301337 -0.99058047]
mat_Sqrt:  [[12.25038388  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00061124  0.01561435  0.03792391]
Stock Position:  -0.0006112363276821302
Bond Position:  [1.08030469]


portfolio before change:  [1.02001042]
curr_Stock_Price:  99.08505377093074
curr_Factors:  [99.08505377 -1.32189313 -0.97215158]
mat_Sqrt:  [[ 9.99349022  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.000567   -0.02845143  0.0120735 ]
Stock Position:  -0.0005669984922325223
Bond Position:  [1.07619149]


portfolio before change:  [1.02032052]
curr_Stock_Price:  99.01269473553619
curr_Factors:  [99.01269474 -1.28420237 -0.96641683]
mat_Sqrt:  [[10.4294013   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0193797  0.00051611 0.02885813]
Stock Position:  0.019379698342773075
Bond Position:  [-0.89851563]


portfolio before change:  [1.02619739]
curr_Stock_Price:  99.32753551674784
curr_Factors:  [99.32753552 -1.01647679 -0.97638762]
mat_Sqrt:  [[13.5387835   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00490819  0.00762996  0.15701721]
Stock Position:  -0.004908192835488724
Bond Position:  [1.51371608]


portfolio before change:  [1.03006076]
curr_Stock_Price:  98.61752017231937
curr_Factors:  [98.61752017 -1.13774356 -1.00487556]
mat_Sqrt:  [[11.57247937  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01538237  0.05141916 -0.0164745 ]
Stock Position:  -0.015382372788465756
Bond Position:  [2.54703221]


portfolio before change:  [1.00909414]
curr_Stock_Price:  100.02194910301081
curr_Factors:  [100.0219491   -1.11104356  -1.01898299]
mat_Sqrt:  [[11.88602225  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00420626 -0.03586023  0.01097516]
Stock Position:  0.004206261418195652
Bond Position:  [0.58837568]


portfolio before change:  [1.01139355]
curr_Stock_Price:  100.53363657276756
curr_Factors:  [100.53363657  -0.99648727  -0.98333427]
mat_Sqrt:  [[13.8830799   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00227241 0.02563666 0.13115805]
Stock Position:  0.002272408650473947
Bond Position:  [0.78294004]


portfolio before change:  [1.01347125]
curr_Stock_Price:  101.36180675797348
curr_Factors:  [101.36180676  -0.83953968  -0.96950565]
mat_Sqrt:  [[16.60412278  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00068502  0.05509882  0.10629024]
Stock Position:  -0.0006850210107761289
Bond Position:  [1.08290621]


portfolio before change:  [1.01384543]
curr_Stock_Price:  101.21082953272175
curr_Factors:  [101.21082953  -0.4219408   -0.94082065]
mat_Sqrt:  [[25.90521556  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242608 -0.0276382  -0.0448148 ]
Stock Position:  -0.0024260808847773024
Bond Position:  [1.25939109]


portfolio before change:  [1.01757178]
curr_Stock_Price:  99.80466958407195
curr_Factors:  [99.80466958 -0.39900714 -0.91959548]
mat_Sqrt:  [[26.69863253  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00403948 -0.03350424  0.61580844]
Stock Position:  -0.004039478063085097
Bond Position:  [1.42073055]


portfolio before change:  [1.01707047]
curr_Stock_Price:  100.01671092494085
curr_Factors:  [100.01671092  -0.30166923  -0.92891964]
mat_Sqrt:  [[29.21693209  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00152786 0.0264796  0.28979152]
Stock Position:  0.0015278641058473082
Bond Position:  [0.86425852]


portfolio before change:  [1.00886396]
curr_Stock_Price:  94.50405209789118
curr_Factors:  [94.5040521  -0.63235735 -0.9115445 ]
mat_Sqrt:  [[20.18098566  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00025332  0.00770868 -0.0273025 ]
Stock Position:  -0.00025331515659252117
Bond Position:  [1.03280327]


portfolio before change:  [1.00965694]
curr_Stock_Price:  92.39307080994153
curr_Factors:  [92.39307081 -0.526629   -0.89728186]
mat_Sqrt:  [[22.24553078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00602499 0.01634789 0.5069806 ]
Stock Position:  0.006024994824273887
Bond Position:  [0.45298917]


portfolio before change:  [1.00112792]
curr_Stock_Price:  90.95866627851238
curr_Factors:  [90.95866628 -0.5015121  -0.90560301]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.00112792]
Stock Price:  89.97448889225426
PL:  [1.00112792]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.41180143e-01 -2.66424450e-02  6.94084687e-02]
 [ 2.96929802e-02  5.76417382e-02  5.72480555e-02]
 [-9.75173456e-03 -1.10128777e-01  3.50513931e-02]
 [-3.53375670e-02 -1.42363581e-02 -1.02994236e-02]
 [ 2.91878946e-01 -1.75483570e-01 -1.01933190e-01]
 [-3.86018017e-02  5.60122070e-02  1.79984850e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 8.84981110e-02 -1.51475456e-02 -7.98540815e-03]
 [-1.62568200e-01  7.96436806e-03  1.99471902e-01]
 [-2.25813189e-02  3.47332010e-02 -5.69170844e-02]
 [-1.17691462e-02 -7.48558861e-02 -4.03769007e-04]
 [ 1.05732412e-01  1.09323613e-01 -3.36432551e-02]
 [-2.95364931e-02  1.82080408e-01  3.31957409e-02]
 [-5.48187597e-02 -1.05509243e-01 -2.20436418e-02]
 [-1.43290858e-01 -1.01576096e-01  2.08449082e-01]
 [ 9.46596547e-03  1.06175064e-01  1.75785581e-01]
 [-5.80727775e-02  1.21762747e-01  3.04061599e-02]
 [-2.43756599e-02 -2.24987558e-02  4.69550072e-02]
 [-2.68130072e-02  5.31341372e-01  2.34943119e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.46571446]
curr_Stock_Price:  100.72290338719483
curr_Factors:  [100.72290339  -0.96281612  -1.01445106]
mat_Sqrt:  [[13.9447911   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01632869 -0.00842508  0.19800304]
Stock Position:  -0.016328685179167576
Bond Position:  [9.11038704]


portfolio before change:  [7.46955821]
curr_Stock_Price:  100.6270067197459
curr_Factors:  [100.62700672  -1.02519965  -1.00826574]
mat_Sqrt:  [[13.17018139  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00325485 0.01822792 0.16331277]
Stock Position:  0.003254852203426522
Bond Position:  [7.14203217]


portfolio before change:  [7.47280832]
curr_Stock_Price:  101.0769118416691
curr_Factors:  [101.07691184  -1.06765005  -1.01735917]
mat_Sqrt:  [[12.56446395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.000433   -0.03482578  0.09999187]
Stock Position:  -0.0004329999040630431
Bond Position:  [7.51657461]


portfolio before change:  [7.4754271]
curr_Stock_Price:  99.36927048950471
curr_Factors:  [99.36927049 -1.05987424 -1.01991148]
mat_Sqrt:  [[12.41688443  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304485 -0.00450193 -0.02938139]
Stock Position:  -0.003044846676159295
Bond Position:  [7.7779913]


portfolio before change:  [7.48217523]
curr_Stock_Price:  97.79172522690166
curr_Factors:  [97.79172523 -0.90901659 -1.02609962]
mat_Sqrt:  [[14.1218572   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01887436 -0.05549278 -0.29078702]
Stock Position:  0.018874355561102896
Bond Position:  [5.63641943]


portfolio before change:  [7.51387587]
curr_Stock_Price:  99.3966203216721
curr_Factors:  [99.39662032 -0.98411288 -1.05702537]
mat_Sqrt:  [[12.90971161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259352  0.01771262  0.05134467]
Stock Position:  -0.002593524039805681
Bond Position:  [7.77166339]


portfolio before change:  [7.51655639]
curr_Stock_Price:  99.11230934332035
curr_Factors:  [99.11230934 -0.74168467 -1.05324337]
mat_Sqrt:  [[16.46646027  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034411 -0.02845143  0.0120735 ]
Stock Position:  -0.00034411122929769474
Bond Position:  [7.55066205]


portfolio before change:  [7.51860353]
curr_Stock_Price:  98.64955913228594
curr_Factors:  [98.64955913 -0.57999309 -1.09140161]
mat_Sqrt:  [[18.54460793  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00466319 -0.00479007 -0.02278015]
Stock Position:  0.004663187746603213
Bond Position:  [7.05858212]


portfolio before change:  [7.51482609]
curr_Stock_Price:  97.46103612689582
curr_Factors:  [97.46103613 -0.63519232 -1.06861941]
mat_Sqrt:  [[17.73678876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00685837  0.00251855  0.56903782]
Stock Position:  -0.006858373886820479
Bond Position:  [8.18325032]


portfolio before change:  [7.51805057]
curr_Stock_Price:  97.28921510360443
curr_Factors:  [97.2892151  -0.44366318 -1.10443007]
mat_Sqrt:  [[20.68884957  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00160969  0.0109836  -0.1623686 ]
Stock Position:  -0.0016096913727503392
Bond Position:  [7.67465618]


portfolio before change:  [7.52083263]
curr_Stock_Price:  96.75299149049025
curr_Factors:  [96.75299149 -0.21632888 -1.11987914]
mat_Sqrt:  [[25.43060148  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054204 -0.02367151 -0.00115184]
Stock Position:  -0.0005420373522588842
Bond Position:  [7.57327637]


portfolio before change:  [7.52212012]
curr_Stock_Price:  97.87112086880889
curr_Factors:  [ 9.78711209e+01 -3.37903981e-02 -1.11782707e+00]
mat_Sqrt:  [[30.93951128  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00328666  0.03457116 -0.09597484]
Stock Position:  0.003286662623123389
Bond Position:  [7.20045077]


portfolio before change:  [7.53295433]
curr_Stock_Price:  100.61976551509031
curr_Factors:  [100.61976552  -0.25159849  -1.0955232 ]
mat_Sqrt:  [[26.1598823   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069034  0.05757888  0.09469821]
Stock Position:  -0.0006903373922003472
Bond Position:  [7.60241591]


portfolio before change:  [7.53472305]
curr_Stock_Price:  100.81114477998689
curr_Factors:  [100.81114478  -0.45901361  -1.06659843]
mat_Sqrt:  [[21.9252046   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282974 -0.03336495 -0.06288437]
Stock Position:  -0.0028297403514201255
Bond Position:  [7.81999242]


portfolio before change:  [7.5448982]
curr_Stock_Price:  97.90631741225357
curr_Factors:  [97.90631741 -0.10710976 -1.09917097]
mat_Sqrt:  [[29.30418516  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00352728 -0.03212118  0.59464721]
Stock Position:  -0.0035272794791820126
Bond Position:  [7.89024115]


portfolio before change:  [7.55359796]
curr_Stock_Price:  95.99919426111856
curr_Factors:  [ 9.59991943e+01 -2.91066554e-02 -1.05557235e+00]
mat_Sqrt:  [[32.44871345  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00148201 0.0335755  0.50146733]
Stock Position:  0.0014820148541813704
Bond Position:  [7.41132573]


portfolio before change:  [7.55338661]
curr_Stock_Price:  94.6062131259722
curr_Factors:  [ 9.46062131e+01 -3.39653387e-03 -1.06092716e+00]
mat_Sqrt:  [[32.63546101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149292  0.03850476  0.08674031]
Stock Position:  -0.0014929234633609169
Bond Position:  [7.69462644]


portfolio before change:  [7.55069011]
curr_Stock_Price:  97.70108077293297
curr_Factors:  [97.70108077 -0.17340491 -1.04134665]
mat_Sqrt:  [[28.99609217  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00053014 -0.00711473  0.13394957]
Stock Position:  -0.0005301378009983854
Bond Position:  [7.60248514]


portfolio before change:  [7.55303407]
curr_Stock_Price:  96.8652543658055
curr_Factors:  [96.86525437 -0.29996227 -1.0538729 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.55303407]
Stock Price:  93.38927088367157
PL:  [7.55303407]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.12832364e-01 -4.57547258e-02  1.35469000e-01]
 [-1.03675336e-01  1.40168909e-01  9.25999989e-02]
 [-8.16139251e-02 -4.29833056e-01  9.30987686e-03]
 [-2.60483936e-02  3.17041706e-02  1.99212213e-02]
 [ 7.55108385e-01 -4.35555291e-01 -1.69842312e-01]
 [-4.11185533e-02  3.47286801e-02 -4.36504620e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 4.43183176e-02 -2.50506756e-02  5.51991936e-04]
 [-5.01616821e-02  2.70992828e-02  1.91097322e-02]
 [-3.48004353e-01  3.30357116e-01  4.05382456e-02]
 [ 3.58223738e-02 -1.03969239e-01  5.97137121e-03]
 [ 5.77135016e-03  7.25987598e-02  4.29610460e-02]
 [-6.85288785e-03  1.65680293e-01  5.34395594e-02]
 [-4.24757253e-02 -9.95470439e-02 -6.22751511e-02]
 [-1.50551432e-01 -1.10464716e-01  2.27338372e-01]
 [ 1.59419532e-02  7.13734081e-02  7.77800250e-02]
 [-1.51292138e-01 -5.81322039e-03  8.18421738e-02]
 [-4.69537478e-02 -4.58361972e-02  2.18151111e-02]
 [-2.68291353e-02  5.24910987e-01  2.58161477e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.58596805]
curr_Stock_Price:  99.76456277247779
curr_Factors:  [99.76456277 -1.2949735  -0.9716295 ]
mat_Sqrt:  [[10.34196657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02768925 -0.01446891  0.38645535]
Stock Position:  -0.027689245615620778
Bond Position:  [3.34837354]


portfolio before change:  [0.59801399]
curr_Stock_Price:  99.35975804572996
curr_Factors:  [99.35975805 -1.17889176 -0.95956899]
mat_Sqrt:  [[11.7081646   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00693143  0.0443253   0.26416202]
Stock Position:  -0.0069314275371248485
Bond Position:  [1.28671895]


portfolio before change:  [0.59712627]
curr_Stock_Price:  99.53424359693734
curr_Factors:  [99.5342436  -1.35681808 -0.95891279]
mat_Sqrt:  [[ 9.82343515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0092444  -0.13592515  0.02655849]
Stock Position:  -0.009244403292173355
Bond Position:  [1.51726096]


portfolio before change:  [0.60310782]
curr_Stock_Price:  98.92823519579416
curr_Factors:  [98.9282352  -1.35355821 -0.98569489]
mat_Sqrt:  [[ 9.53664348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221917  0.01002574  0.0568297 ]
Stock Position:  -0.0022191658094099774
Bond Position:  [0.82264598]


portfolio before change:  [0.60438305]
curr_Stock_Price:  98.44627900634197
curr_Factors:  [98.44627901 -1.3765251  -0.95749689]
mat_Sqrt:  [[ 9.53995734  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07433927 -0.13773468 -0.48451284]
Stock Position:  0.07433927154587622
Bond Position:  [-6.71404162]


portfolio before change:  [0.78088408]
curr_Stock_Price:  100.84312451006608
curr_Factors:  [100.84312451  -1.5521313   -0.97696649]
mat_Sqrt:  [[ 8.04031529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0061107   0.01098217 -0.12452262]
Stock Position:  -0.006110702641163317
Bond Position:  [1.39710643]


portfolio before change:  [0.78286605]
curr_Stock_Price:  100.57594507601056
curr_Factors:  [100.57594508  -1.4120839   -1.0202608 ]
mat_Sqrt:  [[ 8.83365108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064144 -0.02845143  0.0120735 ]
Stock Position:  -0.0006414441587144267
Bond Position:  [0.84737991]


portfolio before change:  [0.78311485]
curr_Stock_Price:  100.51837730479625
curr_Factors:  [100.5183773   -1.56193613  -1.01292306]
mat_Sqrt:  [[ 7.65593666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00571898 -0.00792172  0.00157468]
Stock Position:  0.005718984983539154
Bond Position:  [0.20825176]


portfolio before change:  [0.78287886]
curr_Stock_Price:  100.46800844214741
curr_Factors:  [100.46800844  -1.70827295  -1.03436509]
mat_Sqrt:  [[ 6.47016303  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00704174  0.00856955  0.05451475]
Stock Position:  -0.007041742795501876
Bond Position:  [1.49034874]


portfolio before change:  [0.78172838]
curr_Stock_Price:  100.68430719811462
curr_Factors:  [100.6843072   -1.69346133  -1.0107441 ]
mat_Sqrt:  [[ 6.73814407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04915296  0.10446809  0.11564433]
Stock Position:  -0.049152961203660486
Bond Position:  [5.73066022]


portfolio before change:  [0.80357265]
curr_Stock_Price:  100.26904367038415
curr_Factors:  [100.26904367  -1.54715188  -0.97904993]
mat_Sqrt:  [[ 8.0177289   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0042851  -0.03287796  0.01703466]
Stock Position:  0.004285103802954285
Bond Position:  [0.37390939]


portfolio before change:  [0.80546128]
curr_Stock_Price:  100.68796890507689
curr_Factors:  [100.68796891  -1.31565911  -0.9800657 ]
mat_Sqrt:  [[10.13810915  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00161916 0.02295774 0.12255591]
Stock Position:  0.0016191607937912872
Bond Position:  [0.64243127]


portfolio before change:  [0.80500067]
curr_Stock_Price:  100.30429058165994
curr_Factors:  [100.30429058  -1.10911076  -0.96960333]
mat_Sqrt:  [[12.54716039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00066416 0.05239271 0.15244819]
Stock Position:  0.0006641553183766689
Bond Position:  [0.73838304]


portfolio before change:  [0.80553511]
curr_Stock_Price:  100.8310010620799
curr_Factors:  [100.83100106  -1.09849913  -1.00240619]
mat_Sqrt:  [[12.3362309   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00468197 -0.03147954 -0.17765367]
Stock Position:  -0.004681971455551451
Bond Position:  [1.27762298]


portfolio before change:  [0.79976928]
curr_Stock_Price:  102.13072547890846
curr_Factors:  [102.13072548  -0.89351707  -1.02806585]
mat_Sqrt:  [[14.949393    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00715737 -0.03493201  0.6485331 ]
Stock Position:  -0.00715737208479942
Bond Position:  [1.53075688]


portfolio before change:  [0.79932959]
curr_Stock_Price:  102.2456320697375
curr_Factors:  [102.24563207  -0.5937905   -1.05584383]
mat_Sqrt:  [[19.64344588  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00171363 0.02257025 0.22188476]
Stock Position:  0.001713629471000041
Bond Position:  [0.62411846]


portfolio before change:  [0.79823393]
curr_Stock_Price:  101.51519158128707
curr_Factors:  [101.51519158  -0.69644902  -1.06588581]
mat_Sqrt:  [[17.42443656  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0077326  -0.0018383   0.23347294]
Stock Position:  -0.0077326041540472425
Bond Position:  [1.58321073]


portfolio before change:  [0.79935296]
curr_Stock_Price:  101.42166878454796
curr_Factors:  [101.42166878  -0.94489739  -1.08248727]
mat_Sqrt:  [[13.35515032  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00327097 -0.01449468  0.06223244]
Stock Position:  -0.0032709659854302086
Bond Position:  [1.13109979]


portfolio before change:  [0.80169988]
curr_Stock_Price:  100.79062774787988
curr_Factors:  [100.79062775  -0.75330949  -1.0679314 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.80169988]
Stock Price:  101.21633770134943
PL:  [-0.41463782]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.17015216e-01 -2.42904686e-02  5.81689949e-02]
 [ 6.24318706e-02  3.36769487e-02  3.23116626e-02]
 [-2.76351161e-04 -7.86425765e-02  3.45721650e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 6.96872971e-01 -4.21809977e-01 -1.81640492e-01]
 [-7.94038323e-02  6.62944513e-02  1.97288970e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 1.77377595e-01 -3.15001363e-03  1.28134452e-02]
 [-1.10749684e-01  2.07036739e-02  9.64528608e-02]
 [-2.86055177e-01  2.66970763e-01  3.04476276e-02]
 [ 6.99057437e-03 -8.68469892e-02  6.14368569e-03]
 [ 5.45925604e-02  9.55340852e-02  2.37376387e-02]
 [ 1.44176332e-03  1.60942901e-01  6.13305613e-02]
 [-1.39641038e-02 -1.28031010e-01 -6.49474830e-02]
 [-1.19504055e-01 -8.39004069e-02  1.78470111e-01]
 [-1.36388520e-02  1.61774363e-01  2.29860550e-01]
 [-7.76300220e-02  1.00191735e-01  4.08880353e-02]
 [-4.80395579e-02 -4.95118326e-02  2.22188284e-02]
 [-2.82257099e-02  5.14564828e-01  2.47189961e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.8026683]
curr_Stock_Price:  101.32703597582815
curr_Factors:  [101.32703598  -1.29035635  -1.03473852]
mat_Sqrt:  [[ 9.90716657  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02076968 -0.00768132  0.16593995]
Stock Position:  -0.02076968175015927
Bond Position:  [13.90719859]


portfolio before change:  [11.8066002]
curr_Stock_Price:  101.30514513251724
curr_Factors:  [101.30514513  -1.01620734  -1.05677268]
mat_Sqrt:  [[12.74523132  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00548417 0.01064959 0.09217618]
Stock Position:  0.005484168500421551
Bond Position:  [11.25102571]


portfolio before change:  [11.80752685]
curr_Stock_Price:  100.9611634863326
curr_Factors:  [100.96116349  -0.89898609  -1.02379612]
mat_Sqrt:  [[14.76048548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00032181 -0.02486897  0.09862476]
Stock Position:  0.00032181325459066203
Bond Position:  [11.77503621]


portfolio before change:  [11.81012837]
curr_Stock_Price:  99.8965371467751
curr_Factors:  [99.89653715 -1.10830932 -0.99123611]
mat_Sqrt:  [[12.23853514  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00310035 -0.00455813 -0.02970002]
Stock Position:  -0.003100351207760836
Bond Position:  [12.11984272]


portfolio before change:  [11.81456943]
curr_Stock_Price:  99.44151789510532
curr_Factors:  [99.4415179  -1.17318515 -1.01153551]
mat_Sqrt:  [[11.18808142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05799964 -0.13338803 -0.51816976]
Stock Position:  0.05799963819608328
Bond Position:  [6.04699737]


portfolio before change:  [11.78405861]
curr_Stock_Price:  98.88939797998249
curr_Factors:  [98.88939798 -1.42473185 -1.00703374]
mat_Sqrt:  [[ 8.69055188  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00847644  0.02096415  0.05628105]
Stock Position:  -0.008476443582763348
Bond Position:  [12.62228901]


portfolio before change:  [11.78301969]
curr_Stock_Price:  99.38428538807563
curr_Factors:  [99.38428539 -1.48513393 -1.0217161 ]
mat_Sqrt:  [[ 8.10226765  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069935 -0.02845143  0.0120735 ]
Stock Position:  -0.0006993466679217084
Bond Position:  [11.85252376]


portfolio before change:  [11.78571959]
curr_Stock_Price:  99.76121986706877
curr_Factors:  [99.76121987 -1.67027623 -1.02759026]
mat_Sqrt:  [[ 6.71882335  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02677728 -0.00099612  0.03655319]
Stock Position:  0.026777277223456134
Bond Position:  [9.11438575]


portfolio before change:  [11.77146631]
curr_Stock_Price:  99.14382501417252
curr_Factors:  [99.14382501 -1.63668898 -0.99145736]
mat_Sqrt:  [[ 7.15939319  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01264447  0.00654708  0.27515316]
Stock Position:  -0.012644473857757507
Bond Position:  [13.02508782]


portfolio before change:  [11.76781726]
curr_Stock_Price:  99.68997141674924
curr_Factors:  [99.68997142 -1.56825424 -1.00009342]
mat_Sqrt:  [[ 7.64244388  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03571461  0.08442357  0.08685861]
Stock Position:  -0.03571461306408606
Bond Position:  [15.32820602]


portfolio before change:  [11.78828679]
curr_Stock_Price:  99.22413982806921
curr_Factors:  [99.22413983 -1.48119339 -1.01374057]
mat_Sqrt:  [[ 8.18618002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00073322 -0.02746343  0.01752623]
Stock Position:  0.0007332198077953237
Bond Position:  [11.71553368]


portfolio before change:  [11.79129778]
curr_Stock_Price:  99.33563222345201
curr_Factors:  [99.33563222 -1.36995268 -1.00892466]
mat_Sqrt:  [[ 9.20389716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00672592 0.03021053 0.06771688]
Stock Position:  0.006725918814526644
Bond Position:  [11.12317439]


portfolio before change:  [11.79600286]
curr_Stock_Price:  99.62167948410537
curr_Factors:  [99.62167948 -1.20598554 -1.00024932]
mat_Sqrt:  [[10.96978801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00165148 0.05089461 0.17495902]
Stock Position:  0.001651475812089047
Bond Position:  [11.63148006]


portfolio before change:  [11.79851704]
curr_Stock_Price:  99.38307537352371
curr_Factors:  [99.38307537 -1.19282416 -0.98427752]
mat_Sqrt:  [[11.26702311  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270943 -0.04048696 -0.18527709]
Stock Position:  -0.0027094290525288777
Bond Position:  [12.06778843]


portfolio before change:  [11.80635376]
curr_Stock_Price:  97.60432505696647
curr_Factors:  [97.60432506 -0.81236349 -0.9665004 ]
mat_Sqrt:  [[16.47852347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00517281 -0.02653164  0.50912555]
Stock Position:  -0.005172811498733445
Bond Position:  [12.31124254]


portfolio before change:  [11.8096025]
curr_Stock_Price:  97.5713559808623
curr_Factors:  [97.57135598 -0.80722537 -0.94081228]
mat_Sqrt:  [[16.9886643   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0022049  0.05115755 0.65572817]
Stock Position:  0.002204895675364736
Bond Position:  [11.59446784]


portfolio before change:  [11.81871575]
curr_Stock_Price:  100.38975109642043
curr_Factors:  [100.3897511   -1.16766123  -0.97045038]
mat_Sqrt:  [[11.83366591  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00563619  0.03168341  0.11664218]
Stock Position:  -0.005636194884196344
Bond Position:  [12.38453195]


portfolio before change:  [11.81925262]
curr_Stock_Price:  100.84389572348823
curr_Factors:  [100.84389572  -0.93961019  -1.00070712]
mat_Sqrt:  [[14.48706859  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309121 -0.01565702  0.06338413]
Stock Position:  -0.003091208429198666
Bond Position:  [12.13098212]


portfolio before change:  [11.82392165]
curr_Stock_Price:  100.31468405772952
curr_Factors:  [100.31468406  -0.86941926  -0.96440076]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.82392165]
Stock Price:  100.44087156627768
PL:  [11.38305008]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.82660904e-01 -3.06797745e-02  8.87017992e-02]
 [-5.56194304e-02  1.14891647e-01  9.94236507e-02]
 [-3.59930857e-02 -2.19720445e-01  3.84321061e-02]
 [-2.16147773e-02  3.87236246e-02  2.43235401e-02]
 [ 5.22797218e-01 -3.37769365e-01 -1.77622975e-01]
 [-8.92917308e-02  6.85152617e-02  2.49542140e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-4.25538577e-03 -3.23221729e-02 -8.14508697e-03]
 [-1.82678172e-02  3.04659673e-02 -2.16041256e-02]
 [-2.02679963e-01  1.89170119e-01  1.05184519e-02]
 [ 2.74920320e-03 -8.37690332e-02  1.78992300e-03]
 [ 7.33945748e-02  1.01483335e-01  5.55441297e-03]
 [ 1.32943102e-02  1.62201658e-01  7.57198500e-02]
 [ 6.36895298e-02 -1.00428292e-01  5.18404499e-02]
 [-1.21425601e-01 -1.05081768e-01  1.31911749e-01]
 [-2.49455086e-03  1.63216216e-01  3.11431114e-01]
 [-6.71846974e-04  1.51299055e-02 -9.38379317e-03]
 [ 7.07885010e-02  4.81149792e-02  1.60170284e-01]
 [-2.89196159e-02  5.11902065e-01  2.31564359e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.76366971]
curr_Stock_Price:  100.34651171892672
curr_Factors:  [100.34651172  -1.32901651  -0.97219017]
mat_Sqrt:  [[10.04849254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02640663 -0.0097018   0.25304154]
Stock Position:  -0.02640663486707887
Bond Position:  [7.41348341]


portfolio before change:  [4.7718516]
curr_Stock_Price:  100.10686425375734
curr_Factors:  [100.10686425  -1.41261411  -0.97228746]
mat_Sqrt:  [[ 9.21964641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0035097   0.03633193  0.283628  ]
Stock Position:  -0.003509697842667186
Bond Position:  [5.12319644]


portfolio before change:  [4.7729707]
curr_Stock_Price:  100.15298063500235
curr_Factors:  [100.15298064  -0.94348157  -0.92961141]
mat_Sqrt:  [[15.3882748   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00219786 -0.06948171  0.1096361 ]
Stock Position:  -0.0021978631693027307
Bond Position:  [4.99309325]


portfolio before change:  [4.77758719]
curr_Stock_Price:  98.62055460738983
curr_Factors:  [98.62055461 -0.71559033 -0.87942899]
mat_Sqrt:  [[20.01056514  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078208  0.01224549  0.06938829]
Stock Position:  -0.0007820826478826104
Bond Position:  [4.85471662]


portfolio before change:  [4.77793033]
curr_Stock_Price:  99.73385183046827
curr_Factors:  [99.73385183 -0.76422266 -0.92835007]
mat_Sqrt:  [[18.35555812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02603129 -0.10681205 -0.50670891]
Stock Position:  0.02603129306299577
Bond Position:  [2.18172921]


portfolio before change:  [4.74626096]
curr_Stock_Price:  98.49630766798983
curr_Factors:  [98.49630767 -1.02575312 -0.97172049]
mat_Sqrt:  [[13.36374515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0061681   0.02166643  0.07118743]
Stock Position:  -0.006168100019485629
Bond Position:  [5.35379604]


portfolio before change:  [4.74010779]
curr_Stock_Price:  99.71090862073895
curr_Factors:  [99.71090862 -1.10111868 -0.99622741]
mat_Sqrt:  [[12.24268965  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046283 -0.02845143  0.0120735 ]
Stock Position:  -0.00046283080348438017
Bond Position:  [4.78625707]


portfolio before change:  [4.74131323]
curr_Stock_Price:  99.69205909350424
curr_Factors:  [99.69205909 -0.70468748 -0.97403225]
mat_Sqrt:  [[18.60380805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036297 -0.01022117 -0.02323567]
Stock Position:  -0.00036296598941420755
Bond Position:  [4.77749806]


portfolio before change:  [4.7422208]
curr_Stock_Price:  100.48266049115614
curr_Factors:  [100.48266049  -0.48614779  -1.00494616]
mat_Sqrt:  [[22.62128396  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00096772  0.00963418 -0.06163056]
Stock Position:  -0.0009677219467867285
Bond Position:  [4.83946007]


portfolio before change:  [4.74376428]
curr_Stock_Price:  100.1380720975481
curr_Factors:  [100.1380721   -0.82249063  -0.9975596 ]
mat_Sqrt:  [[16.22413136  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01205911  0.05982084  0.03000622]
Stock Position:  -0.012059107307168348
Bond Position:  [5.95134003]


portfolio before change:  [4.77293567]
curr_Stock_Price:  97.8424321832354
curr_Factors:  [97.84243218 -0.69559609 -0.95381899]
mat_Sqrt:  [[18.80162447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.06159756e-05 -2.64900942e-02  5.10615209e-03]
Stock Position:  5.061597555151756e-05
Bond Position:  [4.76798328]


portfolio before change:  [4.77417809]
curr_Stock_Price:  98.83586857947721
curr_Factors:  [98.83586858 -0.85817127 -0.99654631]
mat_Sqrt:  [[15.46753021  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00498778 0.03209185 0.01584519]
Stock Position:  0.0049877809878276684
Bond Position:  [4.28120643]


portfolio before change:  [4.76931651]
curr_Stock_Price:  97.64655890008069
curr_Factors:  [97.6465589  -0.61247986 -0.97434665]
mat_Sqrt:  [[19.97592716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00164891 0.05129267 0.21600766]
Stock Position:  0.0016489141336220995
Bond Position:  [4.60830572]


portfolio before change:  [4.76623552]
curr_Stock_Price:  95.07928322868385
curr_Factors:  [95.07928323 -0.18344767 -0.97855531]
mat_Sqrt:  [[29.74640017  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00240965 -0.03175821  0.14788637]
Stock Position:  0.0024096485496561937
Bond Position:  [4.53712786]


portfolio before change:  [4.76447119]
curr_Stock_Price:  93.87630763016351
curr_Factors:  [93.87630763 -0.22241232 -0.95460399]
mat_Sqrt:  [[28.93239005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00335999 -0.03322977  0.3763075 ]
Stock Position:  -0.003359986077219171
Bond Position:  [5.07989428]


portfolio before change:  [4.76751777]
curr_Stock_Price:  93.34760145567284
curr_Factors:  [93.34760146 -0.12629642 -0.97523352]
mat_Sqrt:  [[31.02521414  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00210443 0.0516135  0.88842628]
Stock Position:  0.0021044265310362436
Bond Position:  [4.5710746]


portfolio before change:  [4.76710309]
curr_Stock_Price:  92.60745004838421
curr_Factors:  [92.60745005 -0.22326052 -0.95394102]
mat_Sqrt:  [[28.53604576  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.69781936e-05  4.78449621e-03 -2.67693500e-02]
Stock Position:  -7.697819363241913e-05
Bond Position:  [4.77423184]


portfolio before change:  [4.76824281]
curr_Stock_Price:  93.30880735482859
curr_Factors:  [93.30880735 -0.34640697 -0.94352406]
mat_Sqrt:  [[25.68696027  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00407699 0.01521529 0.45692124]
Stock Position:  0.004076988700656973
Bond Position:  [4.38782385]


portfolio before change:  [4.79028774]
curr_Stock_Price:  98.44687384187482
curr_Factors:  [98.44687384 -0.71782572 -0.93732459]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.79028774]
Stock Price:  97.55936086900006
PL:  [4.79028774]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.64377114e-01 -2.89002101e-02  8.01977314e-02]
 [-3.10234768e-01  2.48818553e-01  6.32697921e-02]
 [-1.31208793e-01 -4.47474954e-01 -3.08301507e-02]
 [-2.32808670e-02  5.32349621e-02  3.41978715e-02]
 [ 4.72836168e-01 -3.22117164e-01 -1.96446535e-01]
 [-6.96706850e-03  4.82237362e-02  1.34007913e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-6.08730126e-02 -3.95380321e-02 -2.94973902e-02]
 [ 8.89724187e-03  2.69581047e-02 -7.93672324e-02]
 [-3.56478773e-01  3.47120354e-01  3.55561606e-02]
 [ 1.17295703e-01 -1.61980090e-01  1.04992891e-02]
 [-1.17787150e-01 -1.64173105e-03 -4.78102821e-03]
 [-4.78154416e-02  1.79452746e-01  1.07384319e-02]
 [-5.32091683e-02 -8.28869593e-02 -2.82556399e-02]
 [-1.47319597e-01 -1.08884359e-01  2.25554473e-01]
 [ 3.57240408e-02  6.41867864e-02  9.25025680e-02]
 [-1.22359727e-01  2.38527527e-02  8.02775829e-02]
 [-4.32066962e-02 -3.54831670e-02  2.18944281e-02]
 [-1.60785588e-02  5.67837112e-01  3.28879140e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.13335658]
curr_Stock_Price:  100.39800866736522
curr_Factors:  [100.39800867  -0.91538006  -0.99416972]
mat_Sqrt:  [[14.87367086  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01672439 -0.00913905  0.2287818 ]
Stock Position:  -0.016724386543001228
Bond Position:  [6.81245169]


portfolio before change:  [5.1669272]
curr_Stock_Price:  98.49257015269892
curr_Factors:  [98.49257015 -0.91322187 -0.98901326]
mat_Sqrt:  [[14.69850801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01979081  0.07868334  0.18049111]
Stock Position:  -0.019790811990363262
Bond Position:  [7.11617514]


portfolio before change:  [5.16666596]
curr_Stock_Price:  98.59567390485924
curr_Factors:  [98.5956739  -0.91944763 -1.02644705]
mat_Sqrt:  [[14.08531419  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01058235 -0.14150401 -0.08794984]
Stock Position:  -0.010582349980321395
Bond Position:  [6.21003989]


portfolio before change:  [5.16854858]
curr_Stock_Price:  98.56449753779835
curr_Factors:  [98.56449754 -0.99745881 -1.04361727]
mat_Sqrt:  [[12.80243075  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00116585  0.01683437  0.09755701]
Stock Position:  -0.001165851638258694
Bond Position:  [5.28346016]


portfolio before change:  [5.16738635]
curr_Stock_Price:  100.69449284403129
curr_Factors:  [100.69449284  -1.04318503  -1.01313149]
mat_Sqrt:  [[12.88127348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03294858 -0.10186239 -0.56040728]
Stock Position:  0.03294857904811794
Bond Position:  [1.8496459]


portfolio before change:  [5.12896528]
curr_Stock_Price:  99.51436461285543
curr_Factors:  [99.51436461 -1.00993451 -1.03222633]
mat_Sqrt:  [[12.91179403  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0002313   0.01524968  0.03822873]
Stock Position:  -0.00023130108121922294
Bond Position:  [5.15198306]


portfolio before change:  [5.13013509]
curr_Stock_Price:  100.02598122371968
curr_Factors:  [100.02598122  -1.15318555  -1.0084582 ]
mat_Sqrt:  [[11.51656248  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00049201 -0.02845143  0.0120735 ]
Stock Position:  -0.0004920126034483814
Bond Position:  [5.17934914]


portfolio before change:  [5.13090832]
curr_Stock_Price:  101.08646206815314
curr_Factors:  [101.08646207  -0.93769503  -1.00316207]
mat_Sqrt:  [[14.51407856  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00467925 -0.01250302 -0.08414784]
Stock Position:  -0.004679250529605081
Bond Position:  [5.6039172]


portfolio before change:  [5.12964666]
curr_Stock_Price:  101.65553193924096
curr_Factors:  [101.65553194  -0.7864978   -1.01688533]
mat_Sqrt:  [[16.74679393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039455  0.0085249  -0.22641262]
Stock Position:  -0.00039455142061441763
Bond Position:  [5.16975499]


portfolio before change:  [5.13033982]
curr_Stock_Price:  103.174814540105
curr_Factors:  [103.17481454  -0.84356573  -1.03547215]
mat_Sqrt:  [[15.75861027  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0215919   0.10976909  0.10143183]
Stock Position:  -0.021591897210933932
Bond Position:  [7.35807981]


portfolio before change:  [5.13934139]
curr_Stock_Price:  102.84312456397925
curr_Factors:  [102.84312456  -0.64100131  -1.00789445]
mat_Sqrt:  [[19.7728344   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00582904 -0.0512226   0.02995155]
Stock Position:  0.005829035468620959
Bond Position:  [4.53986517]


portfolio before change:  [5.15544078]
curr_Stock_Price:  105.4103213917363
curr_Factors:  [105.41032139  -0.6300356   -0.98656017]
mat_Sqrt:  [[20.93170059  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00567586 -0.00051916 -0.01363894]
Stock Position:  -0.005675862906906606
Bond Position:  [5.75373531]


portfolio before change:  [5.16863548]
curr_Stock_Price:  103.33907874754465
curr_Factors:  [103.33907875  -0.72596818  -0.96010592]
mat_Sqrt:  [[19.1430841   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214124  0.05674794  0.03063376]
Stock Position:  -0.002141244233947742
Bond Position:  [5.38990969]


portfolio before change:  [5.17452738]
curr_Stock_Price:  101.21683072006503
curr_Factors:  [101.21683072  -0.66615993  -0.94627391]
mat_Sqrt:  [[20.18280925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302817 -0.02621116 -0.08060548]
Stock Position:  -0.0030281690713272924
Bond Position:  [5.48102905]


portfolio before change:  [5.17255482]
curr_Stock_Price:  102.32079473525269
curr_Factors:  [102.32079474  -0.87071387  -0.97471797]
mat_Sqrt:  [[16.16229533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00644029 -0.03443226  0.64344413]
Stock Position:  -0.00644028976418241
Bond Position:  [5.83153038]


portfolio before change:  [5.16411616]
curr_Stock_Price:  103.85748371575625
curr_Factors:  [103.85748372  -0.95613895  -0.98664449]
mat_Sqrt:  [[14.88324635  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00378031 0.02029764 0.26388408]
Stock Position:  0.003780313971129782
Bond Position:  [4.77150226]


portfolio before change:  [5.16254752]
curr_Stock_Price:  103.12694618073516
curr_Factors:  [103.12694618  -0.80454178  -0.96434417]
mat_Sqrt:  [[17.58550117  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00599114  0.0075429   0.2290096 ]
Stock Position:  -0.00599114334920378
Bond Position:  [5.78039584]


portfolio before change:  [5.16692805]
curr_Stock_Price:  102.63701481520853
curr_Factors:  [102.63701482  -0.63781022  -0.95163648]
mat_Sqrt:  [[20.9419      0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189351 -0.01122076  0.06245871]
Stock Position:  -0.00189350948293186
Bond Position:  [5.36127221]


portfolio before change:  [5.16734842]
curr_Stock_Price:  103.12294671488227
curr_Factors:  [103.12294671  -0.58211539  -0.9798951 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.16734842]
Stock Price:  101.2599627586112
PL:  [3.90738566]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.44970456e-01 -2.70113568e-02  7.11714005e-02]
 [ 8.84164805e-02  3.55628000e-03 -3.61728495e-02]
 [ 3.03106859e-02  3.53949194e-02  3.74962841e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 4.09141042e-01 -3.43110021e-01 -3.06230178e-01]
 [ 8.59732460e-02 -2.14638738e-01 -1.51138030e-01]
 [ 6.56911202e-02 -1.16674009e-01 -1.32801505e-02]
 [ 9.05697584e-03 -2.69893046e-01 -6.30090100e-02]
 [-7.43617288e-02 -2.79125555e-02 -1.12831842e-01]
 [-4.76889102e-01  4.73677799e-01  6.71906579e-02]
 [ 1.02936049e-01 -1.93425850e-01  6.56704462e-02]
 [-9.25967451e-02  1.20514180e-02  6.26884179e-03]
 [-5.56357719e-02  1.80109666e-01  1.82122440e-03]
 [-1.19394415e-01 -1.23012116e-02  1.62687927e-01]
 [-1.42265936e-01 -1.16156264e-01  2.49926356e-01]
 [ 3.27110597e-03  9.02891472e-03 -3.40009563e-02]
 [-9.28809312e-02  5.13964293e-02  8.19377359e-02]
 [-3.55456516e-02 -1.28125183e-02  2.11070566e-02]
 [-1.91568415e-02  5.17753504e-01  2.96036960e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.97096272]
curr_Stock_Price:  100.65398504914272
curr_Factors:  [100.65398505  -0.90424081  -1.0265849 ]
mat_Sqrt:  [[14.59768614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01583402 -0.00854174  0.2030322 ]
Stock Position:  -0.015834022075123345
Bond Position:  [8.56472014]


portfolio before change:  [6.96317269]
curr_Stock_Price:  101.28120919023148
curr_Factors:  [101.28120919  -0.48183888  -1.0325843 ]
mat_Sqrt:  [[22.27528384  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00364191  0.00112459 -0.10319107]
Stock Position:  0.0036419087587223997
Bond Position:  [6.59431576]


portfolio before change:  [6.96857818]
curr_Stock_Price:  102.31273146553936
curr_Factors:  [ 1.02312731e+02 -9.88915917e-02 -1.00012845e+00]
mat_Sqrt:  [[34.09034067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00114045 0.01119286 0.10696646]
Stock Position:  0.0011404543029023043
Bond Position:  [6.85189519]


portfolio before change:  [6.96983115]
curr_Stock_Price:  101.90919168208882
curr_Factors:  [101.90919168  -0.29579842  -1.00196821]
mat_Sqrt:  [[27.83559264  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136314 -0.00455813 -0.02970002]
Stock Position:  -0.001363138112097018
Bond Position:  [7.10874745]


portfolio before change:  [6.96774965]
curr_Stock_Price:  104.74009301788054
curr_Factors:  [104.74009302  -0.43213675  -1.01233983]
mat_Sqrt:  [[24.70499371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01367226 -0.10850092 -0.87358946]
Stock Position:  0.013672256300079694
Bond Position:  [5.53571625]


portfolio before change:  [6.97166329]
curr_Stock_Price:  104.92510572321382
curr_Factors:  [104.92510572  -0.65937595  -1.02283103]
mat_Sqrt:  [[19.5121986   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00254099 -0.06787473 -0.43115473]
Stock Position:  0.0025409938416016483
Bond Position:  [6.70504925]


portfolio before change:  [6.97783921]
curr_Stock_Price:  106.6958499667799
curr_Factors:  [106.69584997  -0.38202923  -1.02203186]
mat_Sqrt:  [[26.20423836  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00228848 -0.03689556 -0.03788457]
Stock Position:  0.002288477536324631
Bond Position:  [6.73366816]


portfolio before change:  [6.97508688]
curr_Stock_Price:  104.75745797126717
curr_Factors:  [104.75745797  -0.28407427  -1.03157307]
mat_Sqrt:  [[28.10648745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003833  -0.08534768 -0.17974717]
Stock Position:  -0.0003833027155568219
Bond Position:  [7.01524069]


portfolio before change:  [6.97699966]
curr_Stock_Price:  104.34328331387907
curr_Factors:  [104.34328331  -0.55891494  -0.99111919]
mat_Sqrt:  [[22.14589467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00443035 -0.00882673 -0.32187784]
Stock Position:  -0.004430353014404478
Bond Position:  [7.43927724]


portfolio before change:  [6.97258591]
curr_Stock_Price:  105.75937909257776
curr_Factors:  [105.75937909  -0.85746292  -0.98523092]
mat_Sqrt:  [[16.75124633  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02692     0.14979007  0.19167624]
Stock Position:  -0.026920000424536416
Bond Position:  [9.81962844]


portfolio before change:  [6.96846268]
curr_Stock_Price:  106.00374913070613
curr_Factors:  [106.00374913  -0.9704044   -0.95321466]
mat_Sqrt:  [[15.48474594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00719074 -0.06116662  0.1873395 ]
Stock Position:  0.0071907371898428454
Bond Position:  [6.20621758]


portfolio before change:  [6.95835708]
curr_Stock_Price:  104.38258745062463
curr_Factors:  [104.38258745  -0.75669969  -0.92910954]
mat_Sqrt:  [[19.3415116   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00470521  0.00381099  0.01788326]
Stock Position:  -0.004705214292265246
Bond Position:  [7.44949952]


portfolio before change:  [6.96215437]
curr_Stock_Price:  103.97141005748193
curr_Factors:  [103.97141006  -0.6424544   -0.93213113]
mat_Sqrt:  [[21.53178957  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00235065  0.05695568  0.00519545]
Stock Position:  -0.002350645510700193
Bond Position:  [7.20655429]


portfolio before change:  [6.96085768]
curr_Stock_Price:  105.28957769374873
curr_Factors:  [105.28957769  -0.75289515  -0.91599153]
mat_Sqrt:  [[19.84253285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0043595  -0.00388998  0.46410337]
Stock Position:  -0.004359498712471458
Bond Position:  [7.41986746]


portfolio before change:  [6.95669524]
curr_Stock_Price:  106.66992957231874
curr_Factors:  [106.66992957  -0.93451319  -0.87939834]
mat_Sqrt:  [[17.38882502  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00542009 -0.03673184  0.71297033]
Stock Position:  -0.0054200944284980256
Bond Position:  [7.53485633]


portfolio before change:  [6.96170179]
curr_Stock_Price:  106.09381396874326
curr_Factors:  [106.09381397  -0.72712718  -0.93174305]
mat_Sqrt:  [[20.19537289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00017015  0.00285519 -0.09699526]
Stock Position:  -0.0001701471233810856
Bond Position:  [6.97975335]


portfolio before change:  [6.96321384]
curr_Stock_Price:  107.4638293404485
curr_Factors:  [107.46382934  -1.15703046  -0.94372278]
mat_Sqrt:  [[13.14972807  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00569049  0.01625298  0.23374555]
Stock Position:  -0.005690491118101828
Bond Position:  [7.57473581]


portfolio before change:  [6.97396815]
curr_Stock_Price:  105.90677856211111
curr_Factors:  [105.90677856  -0.94428363  -0.92609373]
mat_Sqrt:  [[16.31658204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193472 -0.00405167  0.06021256]
Stock Position:  -0.0019347195020472056
Bond Position:  [7.17886806]


portfolio before change:  [6.97652728]
curr_Stock_Price:  105.51179337607729
curr_Factors:  [105.51179338  -1.36760459  -0.94117246]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.97652728]
Stock Price:  105.35474454921085
PL:  [1.62178273]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [ 1.35055608e-01 -1.81031876e-01 -5.63818631e-02]
 [-4.31320507e-01  3.12509289e-01  4.60763398e-02]
 [-3.65391185e-01 -1.00841903e+00 -1.81911215e-01]
 [-7.81916070e-03  5.35725306e-01  3.90382609e-01]
 [ 1.17604455e-01 -5.34326223e-03  2.58036853e-02]
 [-1.19328188e-01  7.59923603e-02  2.78630784e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 3.40605874e-01  2.65061120e-02  1.57234993e-02]
 [-1.28852855e-01  1.87927213e-02  1.19562319e-01]
 [-2.84599422e-01  2.59909370e-01  1.59200264e-02]
 [-8.39840733e-03 -7.78220799e-02  7.12924119e-03]
 [-5.00264994e-02  3.25204335e-02 -4.43250778e-02]
 [ 1.59626325e-02  1.41304011e-01  7.07447398e-02]
 [ 4.98789877e-02 -2.37135220e-01 -3.77267999e-02]
 [-1.12182521e-01 -8.80225817e-02  1.95901091e-01]
 [ 7.51647564e-03  1.69665483e-01  2.64588375e-01]
 [-2.14002034e-02  7.25005112e-02 -9.40137676e-03]
 [-5.09661682e-02 -5.83335959e-02  2.26214978e-02]
 [-3.87914652e-02  4.26952689e-01  1.61570299e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.84476772]
curr_Stock_Price:  98.17227467152118
curr_Factors:  [98.17227467 -0.46423447 -0.99394879]
mat_Sqrt:  [[22.84062113  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00520443 -0.05724731 -0.16084176]
Stock Position:  0.005204433154424675
Bond Position:  [-11.35569876]


portfolio before change:  [-10.8503998]
curr_Stock_Price:  97.6356536513801
curr_Factors:  [97.63565365 -1.06827958 -1.00261846]
mat_Sqrt:  [[12.30917224  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03362097  0.09882411  0.13144297]
Stock Position:  -0.03362096573008534
Bond Position:  [-7.56779484]


portfolio before change:  [-10.80477429]
curr_Stock_Price:  96.22231837043638
curr_Factors:  [96.22231837 -1.31308043 -1.00712923]
mat_Sqrt:  [[ 9.45412994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04533055 -0.3188901  -0.51894206]
Stock Position:  -0.045330551428172904
Bond Position:  [-6.44296354]


portfolio before change:  [-10.74653126]
curr_Stock_Price:  94.90192919497417
curr_Factors:  [94.90192919 -1.17588365 -1.04147182]
mat_Sqrt:  [[10.33450772  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00829258 0.16941122 1.11365292]
Stock Position:  0.008292579192404833
Bond Position:  [-11.53351303]


portfolio before change:  [-10.74652227]
curr_Stock_Price:  95.25076302400139
curr_Factors:  [95.25076302 -1.1107221  -1.07845692]
mat_Sqrt:  [[10.66891111  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01150386 -0.00168969  0.07361073]
Stock Position:  0.011503858913806078
Bond Position:  [-11.84227361]


portfolio before change:  [-10.72611503]
curr_Stock_Price:  97.28209734490552
curr_Factors:  [97.28209734 -1.32100376 -1.10514178]
mat_Sqrt:  [[ 8.59748262  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01298968  0.02403089  0.07948561]
Stock Position:  -0.012989679855798516
Bond Position:  [-9.46245173]


portfolio before change:  [-10.72509122]
curr_Stock_Price:  97.02114321742562
curr_Factors:  [97.02114322 -1.33211756 -1.10202412]
mat_Sqrt:  [[ 8.50613147  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066614 -0.02845143  0.0120735 ]
Stock Position:  -0.0006661422885065535
Bond Position:  [-10.66046134]


portfolio before change:  [-10.72837498]
curr_Stock_Price:  97.94934055998745
curr_Factors:  [97.94934056 -1.39855835 -1.12013502]
mat_Sqrt:  [[ 7.89126967  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04365581 0.00838197 0.04485477]
Stock Position:  0.043655814426364126
Bond Position:  [-15.00443322]


portfolio before change:  [-10.68694855]
curr_Stock_Price:  98.98420880006194
curr_Factors:  [98.9842088  -1.71065246 -1.12754508]
mat_Sqrt:  [[ 5.79365176  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01794414  0.00594278  0.34107802]
Stock Position:  -0.017944135678343794
Bond Position:  [-8.91076247]


portfolio before change:  [-10.69016445]
curr_Stock_Price:  99.0392650426382
curr_Factors:  [99.03926504 -1.67283579 -1.09994996]
mat_Sqrt:  [[ 6.18873457  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04437724  0.08219056  0.0454154 ]
Stock Position:  -0.04437723512553832
Bond Position:  [-6.2950757]


portfolio before change:  [-10.69460232]
curr_Stock_Price:  99.10380038067294
curr_Factors:  [99.10380038 -1.63439471 -1.12061104]
mat_Sqrt:  [[ 6.30385932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00142016 -0.0246095   0.02033774]
Stock Position:  -0.0014201640750023145
Bond Position:  [-10.55385866]


portfolio before change:  [-10.69724956]
curr_Stock_Price:  99.10974741211864
curr_Factors:  [99.10974741 -2.00853521 -1.09380165]
mat_Sqrt:  [[ 4.45439361  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01307353  0.01028386 -0.12644711]
Stock Position:  -0.01307352899175169
Bond Position:  [-9.4015354]


portfolio before change:  [-10.70131916]
curr_Stock_Price:  99.24122900622908
curr_Factors:  [99.24122901 -1.94031507 -1.05697682]
mat_Sqrt:  [[ 4.95432857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00687314 0.04468425 0.20181505]
Stock Position:  0.006873140420437957
Bond Position:  [-11.38341807]


portfolio before change:  [-10.70097336]
curr_Stock_Price:  99.70564743701117
curr_Factors:  [99.70564744 -2.00866536 -1.03728186]
mat_Sqrt:  [[ 4.74112806  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00760478 -0.07498874 -0.10762406]
Stock Position:  0.007604779175501807
Bond Position:  [-11.45921279]


portfolio before change:  [-10.70346925]
curr_Stock_Price:  99.75420518690652
curr_Factors:  [99.75420519 -1.75928013 -1.05140012]
mat_Sqrt:  [[ 6.00161716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01240784 -0.02783518  0.55885128]
Stock Position:  -0.012407841061277337
Bond Position:  [-9.46573493]


portfolio before change:  [-10.70815852]
curr_Stock_Price:  99.9413886426012
curr_Factors:  [99.94138864 -1.82883855 -1.05786832]
mat_Sqrt:  [[ 5.57268529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01182663 0.05365294 0.75479699]
Stock Position:  0.011826631512156896
Bond Position:  [-11.8901285]


portfolio before change:  [-10.71450165]
curr_Stock_Price:  99.65641983481872
curr_Factors:  [99.65641983 -1.83777792 -1.05911206]
mat_Sqrt:  [[ 5.50049722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00389916  0.02292667 -0.02681951]
Stock Position:  -0.0038991559055435426
Bond Position:  [-10.32592573]


portfolio before change:  [-10.71727206]
curr_Stock_Price:  99.70479138184577
curr_Factors:  [99.70479138 -1.7232504  -1.10107721]
mat_Sqrt:  [[ 5.9173347   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00808721 -0.0184467   0.06453284]
Stock Position:  -0.00808721218945541
Bond Position:  [-9.91093826]


portfolio before change:  [-10.7258612]
curr_Stock_Price:  100.46044038581651
curr_Factors:  [100.46044039  -1.58343003  -1.14685609]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.7258612]
Stock Price:  100.2135286765078
PL:  [-10.93938987]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.47258833e-01 -4.89154944e-02  1.30704887e-01]
 [ 5.67764236e-02  3.57195791e-02  2.74196738e-02]
 [-9.15168645e-02 -3.28112944e-01 -6.89118082e-03]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [-5.96614433e-02 -6.01908440e-03 -8.72264109e-02]
 [-8.49798263e-02  6.71638219e-02  2.94683082e-02]
 [ 8.95322714e-05 -7.79895771e-02 -6.02178163e-03]
 [ 4.21322946e-02 -2.39721278e-02 -6.95745762e-03]
 [-9.60170467e-02  2.02767539e-02  8.76991961e-02]
 [-6.20005409e-02  5.60262487e-02 -4.77969443e-02]
 [-3.17387668e-02 -6.33274129e-02  2.30651164e-03]
 [ 9.97412724e-02  1.10297893e-01 -2.16722905e-02]
 [ 9.43086173e-03  1.62333415e-01  7.12397513e-02]
 [-2.67069738e-02 -1.07355987e-01 -7.09557753e-02]
 [-1.25584560e-01 -8.84187574e-02  1.86133490e-01]
 [-6.88383824e-03  1.43937255e-01  2.19155934e-01]
 [-6.54588033e-02  1.18849561e-01  3.27350477e-02]
 [-5.01924917e-02 -5.68277586e-02  2.30369445e-02]
 [-2.08734030e-02  5.75729465e-01  2.96073797e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.08714669]
curr_Stock_Price:  99.53149984857164
curr_Factors:  [99.53149985 -0.89786065 -0.99836677]
mat_Sqrt:  [[14.94305659  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01484581 -0.01546844  0.37286466]
Stock Position:  -0.014845811563834079
Bond Position:  [0.3904792]


portfolio before change:  [-1.10556686]
curr_Stock_Price:  100.77884178791919
curr_Factors:  [100.77884179  -0.84908635  -1.03675121]
mat_Sqrt:  [[15.28834643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00414013 0.01129552 0.0782207 ]
Stock Position:  0.0041401283598094495
Bond Position:  [-1.5228042]


portfolio before change:  [-1.11375994]
curr_Stock_Price:  98.8918648812463
curr_Factors:  [98.89186488 -0.72641709 -1.050538  ]
mat_Sqrt:  [[16.72779808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00606149 -0.10375842 -0.01965862]
Stock Position:  -0.006061488797675796
Bond Position:  [-0.51432801]


portfolio before change:  [-1.11476004]
curr_Stock_Price:  99.03564259903142
curr_Factors:  [99.0356426  -0.36249153 -1.07769883]
mat_Sqrt:  [[23.45982671  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00161739 -0.00455813 -0.02970002]
Stock Position:  -0.0016173929017146635
Bond Position:  [-0.9545805]


portfolio before change:  [-1.11353387]
curr_Stock_Price:  98.12995916208676
curr_Factors:  [98.12995916 -0.37283411 -1.041858  ]
mat_Sqrt:  [[23.8456212   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325518 -0.0019034  -0.24883267]
Stock Position:  -0.003255183468701818
Bond Position:  [-0.79410285]


portfolio before change:  [-1.1155657]
curr_Stock_Price:  98.69314645923052
curr_Factors:  [98.69314646 -0.42705409 -1.00234307]
mat_Sqrt:  [[23.63239266  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00326799  0.02123907  0.08406488]
Stock Position:  -0.003267992020259343
Bond Position:  [-0.79303729]


portfolio before change:  [-1.12157254]
curr_Stock_Price:  100.47055393422093
curr_Factors:  [100.47055393  -0.27815722  -1.05220936]
mat_Sqrt:  [[26.5624378   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00011871 -0.02466247 -0.01717847]
Stock Position:  -0.00011871429137255478
Bond Position:  [-1.10964525]


portfolio before change:  [-1.12170836]
curr_Stock_Price:  99.27760030476541
curr_Factors:  [99.2776003  -0.70525591 -1.02808339]
mat_Sqrt:  [[17.54169589  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00228559 -0.00758065 -0.01984769]
Stock Position:  0.0022855915441240514
Bond Position:  [-1.34861641]


portfolio before change:  [-1.12365325]
curr_Stock_Price:  98.57419716100941
curr_Factors:  [98.57419716 -0.45392508 -1.05449591]
mat_Sqrt:  [[21.81043548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355756  0.00641207  0.2501814 ]
Stock Position:  -0.0035575621482030915
Bond Position:  [-0.77296942]


portfolio before change:  [-1.11940167]
curr_Stock_Price:  97.32478852562866
curr_Factors:  [97.32478853 -0.72207423 -1.02609955]
mat_Sqrt:  [[16.9434264   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00414972  0.01771706 -0.13635138]
Stock Position:  -0.004149719075150571
Bond Position:  [-0.71553114]


portfolio before change:  [-1.11905993]
curr_Stock_Price:  97.19932216678687
curr_Factors:  [97.19932217 -0.92345524 -1.02251688]
mat_Sqrt:  [[13.88475696  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236973 -0.02002589  0.00657984]
Stock Position:  -0.002369725231234133
Bond Position:  [-0.88872424]


portfolio before change:  [-1.1205797]
curr_Stock_Price:  97.74687968928939
curr_Factors:  [97.74687969 -0.9700037  -0.99318127]
mat_Sqrt:  [[13.7246888   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00715246  0.03487926 -0.06182501]
Stock Position:  0.007152461915774752
Bond Position:  [-1.81971053]


portfolio before change:  [-1.11679798]
curr_Stock_Price:  98.33922116902984
curr_Factors:  [98.33922117 -0.86340142 -1.00744089]
mat_Sqrt:  [[15.14363981  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00185979 0.05133433 0.20322718]
Stock Position:  0.0018597936957131193
Bond Position:  [-1.29968864]


portfolio before change:  [-1.11682981]
curr_Stock_Price:  98.49683740413076
curr_Factors:  [98.4968374  -0.76301339 -1.06055072]
mat_Sqrt:  [[15.90224559  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00276456 -0.03394894 -0.20241708]
Stock Position:  -0.0027645580114414874
Bond Position:  [-0.84452959]


portfolio before change:  [-1.11422321]
curr_Stock_Price:  97.47759414696348
curr_Factors:  [97.47759415 -0.53720741 -0.99945455]
mat_Sqrt:  [[20.96722662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00428636 -0.02796047  0.53098704]
Stock Position:  -0.004286364846073211
Bond Position:  [-0.69639868]


portfolio before change:  [-1.11066546]
curr_Stock_Price:  96.60695623532177
curr_Factors:  [96.60695624 -0.56921132 -1.02482031]
mat_Sqrt:  [[19.62136692  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00211849 0.04551696 0.62519088]
Stock Position:  0.0021184876410230745
Bond Position:  [-1.3153261]


portfolio before change:  [-1.10943117]
curr_Stock_Price:  97.34482526829588
curr_Factors:  [97.34482527 -0.49054356 -0.999486  ]
mat_Sqrt:  [[21.93821344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253932  0.03758353  0.09338398]
Stock Position:  -0.0025393183153779694
Bond Position:  [-0.86224167]


portfolio before change:  [-1.11510446]
curr_Stock_Price:  99.4941053201932
curr_Factors:  [99.49410532 -0.16755466 -1.01963644]
mat_Sqrt:  [[30.35336234  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154702 -0.01797052  0.06571799]
Stock Position:  -0.0015470240487233749
Bond Position:  [-0.96118469]


portfolio before change:  [-1.11618255]
curr_Stock_Price:  100.03563905663611
curr_Factors:  [100.03563906  -0.28008165  -1.01466825]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.11618255]
Stock Price:  98.98303442244512
PL:  [-1.11618255]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [ 1.27092454e-01 -1.58968538e-01 -2.12643259e-02]
 [-3.62662154e-01  2.76395201e-01  5.58254162e-02]
 [-1.23229783e-01 -4.32997843e-01 -2.68767683e-02]
 [-1.17970794e-02  1.80175853e-01  1.34827365e-01]
 [ 5.65654995e-01 -3.06047243e-01 -1.13308674e-01]
 [-1.47343461e-01  8.29098302e-02  3.15780572e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 4.33908289e-01  4.13357548e-02  2.72104166e-02]
 [-1.90193397e-01  1.10448738e-02  2.04321772e-01]
 [-3.05733905e-01  2.76315691e-01  2.47893349e-02]
 [-3.56511804e-02 -6.14349089e-02  5.70499114e-03]
 [-4.41945290e-02  3.16317940e-02 -6.37201129e-02]
 [ 2.10270306e-02  1.47700998e-01  7.91653644e-02]
 [ 3.52565955e-02 -1.83325024e-01 -2.89169542e-02]
 [-7.88172886e-02 -6.51946389e-02  1.59329176e-01]
 [-1.89070088e-03  1.40071655e-01  2.01105807e-01]
 [-5.59179924e-02  1.19506622e-01  2.86099207e-02]
 [-5.07649797e-02 -5.83799510e-02  2.30061423e-02]
 [-3.10219925e-02  4.93325520e-01  2.14979231e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.03624545]
curr_Stock_Price:  98.1456020476812
curr_Factors:  [98.14560205 -0.75151392 -0.99952097]
mat_Sqrt:  [[17.03750735  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00696389 -0.05027027 -0.0606612 ]
Stock Position:  0.006963890865282978
Bond Position:  [-11.71972071]


portfolio before change:  [-11.03891984]
curr_Stock_Price:  98.18234984352642
curr_Factors:  [98.18234984 -0.93521971 -0.95825462]
mat_Sqrt:  [[14.7811414   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02328172  0.08740384  0.15925437]
Stock Position:  -0.0232817166131806
Bond Position:  [-8.75306619]


portfolio before change:  [-11.05325731]
curr_Stock_Price:  98.70417274906919
curr_Factors:  [98.70417275 -0.93691569 -1.00408307]
mat_Sqrt:  [[14.17001992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00987267 -0.13692594 -0.07667194]
Stock Position:  -0.009872670390867002
Bond Position:  [-10.07878355]


portfolio before change:  [-11.04481613]
curr_Stock_Price:  97.5939170074752
curr_Factors:  [97.59391701 -0.9327229  -0.98981952]
mat_Sqrt:  [[14.27161713  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00142777 0.05697661 0.38462494]
Stock Position:  0.0014277682500007892
Bond Position:  [-11.18415763]


portfolio before change:  [-11.04797995]
curr_Stock_Price:  97.33656910602522
curr_Factors:  [97.33656911 -1.3294295  -0.98527585]
mat_Sqrt:  [[ 9.6163945   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05559504 -0.09678064 -0.32323811]
Stock Position:  0.05559504167782357
Bond Position:  [-16.45941057]


portfolio before change:  [-11.09419974]
curr_Stock_Price:  96.57922789853957
curr_Factors:  [96.5792279  -1.3397687  -0.98852455]
mat_Sqrt:  [[ 9.4127998   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0147413   0.02621839  0.09008341]
Stock Position:  -0.01474129884334469
Bond Position:  [-9.67049648]


portfolio before change:  [-11.09925899]
curr_Stock_Price:  96.75840686821927
curr_Factors:  [96.75840687 -1.48587399 -0.98790313]
mat_Sqrt:  [[ 8.15344143  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069496 -0.02845143  0.0120735 ]
Stock Position:  -0.0006949573302220848
Bond Position:  [-11.03201603]


portfolio before change:  [-11.1027515]
curr_Stock_Price:  97.81482013634258
curr_Factors:  [97.81482014 -1.8041892  -1.01559238]
mat_Sqrt:  [[ 5.8316182   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07554162 0.01307151 0.07762374]
Stock Position:  0.07554161829930983
Bond Position:  [-18.49184131]


portfolio before change:  [-11.0698701]
curr_Stock_Price:  98.31130064438133
curr_Factors:  [98.31130064 -2.33702615 -0.99644794]
mat_Sqrt:  [[ 3.50666306  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04226275  0.0034927   0.58287314]
Stock Position:  -0.04226274680438631
Bond Position:  [-6.91496449]


portfolio before change:  [-11.06788858]
curr_Stock_Price:  98.22350512865829
curr_Factors:  [98.22350513 -2.17207848 -1.01026293]
mat_Sqrt:  [[ 4.07513608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07203179  0.08737869  0.07071707]
Stock Position:  -0.07203179407469497
Bond Position:  [-3.99267328]


portfolio before change:  [-11.0765765]
curr_Stock_Price:  98.33025839290488
curr_Factors:  [98.33025839 -1.9985915  -1.0342556 ]
mat_Sqrt:  [[ 4.73738216  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00761452 -0.01942742  0.01627475]
Stock Position:  -0.007614521108864689
Bond Position:  [-10.32783867]


portfolio before change:  [-11.07979712]
curr_Stock_Price:  98.41408999380991
curr_Factors:  [98.41408999 -2.07492398 -1.00576711]
mat_Sqrt:  [[ 4.5199137   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01247471  0.01000285 -0.18177575]
Stock Position:  -0.012474710124921108
Bond Position:  [-9.85210988]


portfolio before change:  [-11.07867577]
curr_Stock_Price:  98.12673389454893
curr_Factors:  [98.12673389 -1.41153216 -0.99782582]
mat_Sqrt:  [[ 8.81894163  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00464911 0.04670716 0.22583675]
Stock Position:  0.004649108482304782
Bond Position:  [-11.5348776]


portfolio before change:  [-11.07842939]
curr_Stock_Price:  98.80008010527509
curr_Factors:  [98.80008011 -1.46607577 -1.01124622]
mat_Sqrt:  [[ 8.29602449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00296775 -0.05797246 -0.08249202]
Stock Position:  0.002967748605470526
Bond Position:  [-11.37164319]


portfolio before change:  [-11.08267424]
curr_Stock_Price:  98.32781020147851
curr_Factors:  [98.3278102  -1.42464313 -1.05685449]
mat_Sqrt:  [[ 8.22196539  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0058353  -0.02061636  0.45452179]
Stock Position:  -0.005835304911309075
Bond Position:  [-10.50890148]


portfolio before change:  [-11.08483508]
curr_Stock_Price:  98.24782942721475
curr_Factors:  [98.24782943 -0.96081718 -1.06060993]
mat_Sqrt:  [[13.01452516  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00328683 0.04429455 0.57369889]
Stock Position:  0.0032868263779503235
Bond Position:  [-11.40775864]


portfolio before change:  [-11.08696884]
curr_Stock_Price:  98.46643932036743
curr_Factors:  [98.46643932 -1.1339657  -1.0946462 ]
mat_Sqrt:  [[10.60264903  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00443213  0.03779131  0.08161614]
Stock Position:  -0.00443213474192468
Bond Position:  [-10.65055232]


portfolio before change:  [-11.093423]
curr_Stock_Price:  99.32182519441231
curr_Factors:  [99.32182519 -1.03480734 -1.09052427]
mat_Sqrt:  [[11.85836746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00401204 -0.01846136  0.06563012]
Stock Position:  -0.004012039140056745
Bond Position:  [-10.69493995]


portfolio before change:  [-11.09330331]
curr_Stock_Price:  98.62548088249828
curr_Factors:  [98.62548088 -0.75509457 -1.12507024]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.09330331]
Stock Price:  97.916131292187
PL:  [-11.09330331]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.60774445e-01 -4.01118402e-02  1.09702536e-01]
 [-6.19855828e-02  1.04455380e-01  3.80493080e-02]
 [-5.79914718e-02 -2.36562655e-01  2.63562023e-02]
 [ 6.98105050e-03  1.27067173e-03 -3.22782979e-02]
 [ 1.75297308e-01 -1.51256813e-01 -1.36632126e-01]
 [-8.58622162e-02  6.73215442e-02  3.06522369e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-1.10299720e-01 -7.39642287e-02 -5.34692286e-02]
 [-7.61612489e-02 -2.53046552e-02 -1.04374726e-01]
 [-4.10688042e-01  4.13470890e-01  6.79846908e-02]
 [ 1.06752263e-01 -1.93584360e-01  6.23849813e-02]
 [-1.38928870e-01 -1.31340715e-02 -1.40549262e-02]
 [-5.01967300e-02  1.96651745e-01  1.46157600e-02]
 [-1.28025047e-01 -2.37193687e-02  1.89105825e-01]
 [-1.40981305e-01 -1.12736819e-01  2.41435928e-01]
 [-3.06364120e-02  9.21486230e-03 -6.71333984e-02]
 [-1.05789279e-01  4.02579936e-02  8.00915949e-02]
 [-3.09475668e-02  1.24149664e-03  2.03519516e-02]
 [ 1.62264568e-02  6.11663694e-01  4.93260884e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.33072786]
curr_Stock_Price:  99.63686810591796
curr_Factors:  [99.63686811 -0.79065191 -0.97924363]
mat_Sqrt:  [[16.97321855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01410559 -0.01268448  0.3129508 ]
Stock Position:  -0.014105585851303656
Bond Position:  [1.07470854]


portfolio before change:  [-0.33431908]
curr_Stock_Price:  99.9105134467128
curr_Factors:  [99.91051345 -0.82023135 -1.00791465]
mat_Sqrt:  [[16.05674348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00320873  0.03303169  0.10854408]
Stock Position:  -0.003208731211416853
Bond Position:  [-0.01373309]


portfolio before change:  [-0.33236655]
curr_Stock_Price:  99.30093917330284
curr_Factors:  [99.30093917 -0.58870362 -0.98846975]
mat_Sqrt:  [[20.51141709  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286277 -0.07480768  0.07518691]
Stock Position:  -0.002862774218825096
Bond Position:  [-0.04809038]


portfolio before change:  [-0.32761397]
curr_Stock_Price:  97.63660859800746
curr_Factors:  [97.6366086  -0.1761261  -0.97395034]
mat_Sqrt:  [[30.91297715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.37508311e-05  4.01821681e-04 -9.20809994e-02]
Stock Position:  1.3750831105008759e-05
Bond Position:  [-0.32895656]


portfolio before change:  [-0.32766974]
curr_Stock_Price:  99.56266421905399
curr_Factors:  [99.56266422 -0.37925542 -0.99623247]
mat_Sqrt:  [[25.16110489  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00570332 -0.0478316  -0.38977342]
Stock Position:  0.005703324986378613
Bond Position:  [-0.89550797]


portfolio before change:  [-0.3286596]
curr_Stock_Price:  99.42836323365412
curr_Factors:  [99.42836323 -0.10923473 -0.94670224]
mat_Sqrt:  [[34.58778015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00225129  0.02128894  0.0874423 ]
Stock Position:  -0.002251289888685438
Bond Position:  [-0.10481753]


portfolio before change:  [-0.33364654]
curr_Stock_Price:  101.63186819893596
curr_Factors:  [101.6318682   -0.66422356  -0.94197742]
mat_Sqrt:  [[20.39227529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027786 -0.02845143  0.0120735 ]
Stock Position:  -0.00027786472119887206
Bond Position:  [-0.30540663]


portfolio before change:  [-0.33392505]
curr_Stock_Price:  102.35936665853937
curr_Factors:  [102.35936666  -0.44037615  -0.90434745]
mat_Sqrt:  [[26.67605162  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00461552 -0.02338954 -0.15253283]
Stock Position:  -0.004615519217014235
Bond Position:  [0.13851658]


portfolio before change:  [-0.34299368]
curr_Stock_Price:  104.33168286703271
curr_Factors:  [104.33168287  -0.25911109  -0.91737594]
mat_Sqrt:  [[32.17172808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304988 -0.00800203 -0.29775204]
Stock Position:  -0.0030498832315909385
Bond Position:  [-0.02479423]


portfolio before change:  [-0.34824653]
curr_Stock_Price:  106.05196244700375
curr_Factors:  [106.05196245  -0.32623801  -0.88584261]
mat_Sqrt:  [[31.55867662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01223546  0.13075098  0.1939414 ]
Stock Position:  -0.012235460859294485
Bond Position:  [0.94934811]


portfolio before change:  [-0.33037156]
curr_Stock_Price:  104.6104471609218
curr_Factors:  [104.61044716  -0.40830409  -0.94474178]
mat_Sqrt:  [[27.03676357  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00423454 -0.06121675  0.17796699]
Stock Position:  0.004234538528752155
Bond Position:  [-0.77334853]


portfolio before change:  [-0.32509162]
curr_Stock_Price:  105.90298303382382
curr_Factors:  [105.90298303  -0.50085163  -0.89988538]
mat_Sqrt:  [[26.09611407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00544667 -0.00415336 -0.04009479]
Stock Position:  -0.0054466706939831355
Bond Position:  [0.25172705]


portfolio before change:  [-0.30795726]
curr_Stock_Price:  102.76869612532231
curr_Factors:  [ 1.02768696e+02 -4.68390779e-02 -8.96004101e-01]
mat_Sqrt:  [[40.03033794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0010526   0.06218674  0.0416947 ]
Stock Position:  -0.0010525960176382125
Bond Position:  [-0.19978334]


portfolio before change:  [-0.30997135]
curr_Stock_Price:  104.63469185599459
curr_Factors:  [ 1.04634692e+02  1.15938106e-02 -9.35929640e-01]
mat_Sqrt:  [[41.51850907  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00216858 -0.00750072  0.53946628]
Stock Position:  -0.002168584952789626
Bond Position:  [-0.08306213]


portfolio before change:  [-0.3082419]
curr_Stock_Price:  103.82761422367423
curr_Factors:  [ 1.03827614e+02 -2.26843992e-02 -9.04738972e-01]
mat_Sqrt:  [[41.07125962  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00230354 -0.03565051  0.6887495 ]
Stock Position:  -0.002303539165273865
Bond Position:  [-0.06907092]


portfolio before change:  [-0.31108262]
curr_Stock_Price:  105.05331691969727
curr_Factors:  [105.05331692  -0.15609593  -0.959858  ]
mat_Sqrt:  [[34.41574205  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00128145  0.002914   -0.1915129 ]
Stock Position:  -0.0012814494241596484
Bond Position:  [-0.17646211]


portfolio before change:  [-0.31139537]
curr_Stock_Price:  105.2629412317678
curr_Factors:  [105.26294123  -0.18176845  -0.98171505]
mat_Sqrt:  [[32.88372698  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0026883   0.0127307   0.22847903]
Stock Position:  -0.0026882960554509526
Bond Position:  [-0.02841742]


portfolio before change:  [-0.31791255]
curr_Stock_Price:  107.68457932565099
curr_Factors:  [107.68457933  -0.33513347  -1.01879985]
mat_Sqrt:  [[27.80659075  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0009624   0.0003926   0.05805845]
Stock Position:  -0.000962404455100055
Bond Position:  [-0.21427643]


portfolio before change:  [-0.3205574]
curr_Stock_Price:  110.37707605025346
curr_Factors:  [110.37707605  -0.3967794   -1.05448478]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.3205574]
Stock Price:  111.40408433051962
PL:  [-11.72464173]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.24924424e-01 -6.64406018e-02  1.73439681e-01]
 [-4.19360541e-02  1.07694232e-01  1.01366609e-01]
 [-6.87715357e-02 -3.82423180e-01  1.52546712e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 7.24545261e-01 -4.46697881e-01 -2.05717481e-01]
 [-2.48966019e-02  5.29228744e-02  1.09538406e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 1.36331811e-01 -8.51463698e-03  2.39345951e-03]
 [-8.36872701e-02  2.35603553e-02  6.19065528e-02]
 [-1.83348052e-01  1.67932417e-01  3.57826241e-03]
 [ 1.40871670e-03 -8.32896231e-02  4.27794988e-03]
 [ 7.45900054e-02  1.01071498e-01  7.28579552e-03]
 [ 1.81464831e-02  1.63204969e-01  8.17997694e-02]
 [ 5.80793700e-02 -1.36021148e-01  2.58649277e-02]
 [-1.10650282e-01 -7.73212734e-02  1.67311528e-01]
 [-1.80898333e-02  1.99463878e-01  2.94373187e-01]
 [-2.31964723e-02  8.24784142e-02  9.55864432e-03]
 [-4.84116102e-02 -5.44423135e-02  2.46758673e-02]
 [-3.53414248e-02  4.61164863e-01  1.83722305e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.60891288]
curr_Stock_Price:  99.31951960140626
curr_Factors:  [99.3195196  -1.16784821 -0.97794368]
mat_Sqrt:  [[11.6179374   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01646047 -0.02101036  0.49477513]
Stock Position:  -0.016460467981143225
Bond Position:  [-0.97406711]


portfolio before change:  [-2.62259344]
curr_Stock_Price:  100.13583978975514
curr_Factors:  [100.13583979  -1.16014105  -0.96497327]
mat_Sqrt:  [[11.95815346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154405  0.03405591  0.28917072]
Stock Position:  -0.0015440534956121992
Bond Position:  [-2.46797835]


portfolio before change:  [-2.62237934]
curr_Stock_Price:  99.59753401019034
curr_Factors:  [99.59753401 -1.25400569 -0.9591666 ]
mat_Sqrt:  [[10.89130886  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00693505 -0.12093283  0.04351733]
Stock Position:  -0.006935053809692608
Bond Position:  [-1.93166508]


portfolio before change:  [-2.62727021]
curr_Stock_Price:  100.23312966625534
curr_Factors:  [100.23312967  -1.49054285  -0.97241468]
mat_Sqrt:  [[ 8.53812332  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00444404 -0.00455813 -0.02970002]
Stock Position:  -0.004444039491587952
Bond Position:  [-2.18183022]


portfolio before change:  [-2.62638843]
curr_Stock_Price:  99.9119579089116
curr_Factors:  [99.91195791 -1.27748752 -0.97364713]
mat_Sqrt:  [[10.51870107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06379302 -0.14125827 -0.58685471]
Stock Position:  0.06379301604159072
Bond Position:  [-9.00007356]


portfolio before change:  [-2.6842707]
curr_Stock_Price:  99.0398880557346
curr_Factors:  [99.03988806 -1.59405194 -0.93409279]
mat_Sqrt:  [[ 7.90407106  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00269408  0.01673568  0.03124826]
Stock Position:  -0.0026940794995725177
Bond Position:  [-2.41744936]


portfolio before change:  [-2.68404213]
curr_Stock_Price:  98.73068931332013
curr_Factors:  [98.73068931 -1.22102601 -0.88596714]
mat_Sqrt:  [[12.00595388  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047196 -0.02845143  0.0120735 ]
Stock Position:  -0.00047195699280660103
Bond Position:  [-2.63744549]


portfolio before change:  [-2.68480911]
curr_Stock_Price:  98.95853430816831
curr_Factors:  [98.95853431 -0.88610328 -0.85785566]
mat_Sqrt:  [[17.30061371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0078957  -0.00269256  0.00682787]
Stock Position:  0.007895704101963798
Bond Position:  [-3.46615641]


portfolio before change:  [-2.6846427]
curr_Stock_Price:  99.0893713708214
curr_Factors:  [99.08937137 -0.86773061 -0.91339052]
mat_Sqrt:  [[16.69152413  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00422025  0.00745044  0.17660216]
Stock Position:  -0.004220245053930573
Bond Position:  [-2.26646127]


portfolio before change:  [-2.68307225]
curr_Stock_Price:  98.58297064646834
curr_Factors:  [98.58297065 -1.24629336 -0.89623641]
mat_Sqrt:  [[11.56945871  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01540968  0.05310489  0.01020779]
Stock Position:  -0.01540967904103366
Bond Position:  [-1.16394032]


portfolio before change:  [-2.68370183]
curr_Stock_Price:  98.60494074610708
curr_Factors:  [98.60494075 -1.21097454 -0.86974781]
mat_Sqrt:  [[12.30984098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.06760715e-05 -2.63384914e-02  1.22038003e-02]
Stock Position:  1.0676071478538252e-05
Bond Position:  [-2.68475454]


portfolio before change:  [-2.68437346]
curr_Stock_Price:  98.57124132990411
curr_Factors:  [98.57124133 -1.1384769  -0.84391588]
mat_Sqrt:  [[13.5771302   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00579554 0.03196161 0.02078435]
Stock Position:  0.0057955448519269705
Bond Position:  [-3.25564751]


portfolio before change:  [-2.68328065]
curr_Stock_Price:  98.90025679131153
curr_Factors:  [98.90025679 -1.28734167 -0.8087559 ]
mat_Sqrt:  [[12.15832673  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00321243 0.05160994 0.23335197]
Stock Position:  0.003212426032451795
Bond Position:  [-3.00099041]


portfolio before change:  [-2.68720348]
curr_Stock_Price:  97.91268748997904
curr_Factors:  [97.91268749 -1.18147345 -0.83813455]
mat_Sqrt:  [[12.99374565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00460583 -0.04301366  0.07378544]
Stock Position:  0.004605829367901278
Bond Position:  [-3.13817262]


portfolio before change:  [-2.68755128]
curr_Stock_Price:  98.00753312593443
curr_Factors:  [98.00753313 -1.15816776 -0.82896651]
mat_Sqrt:  [[13.4356292   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00584226 -0.02445113  0.47729322]
Stock Position:  -0.005842256030927218
Bond Position:  [-2.11496618]


portfolio before change:  [-2.68795768]
curr_Stock_Price:  97.98658033152913
curr_Factors:  [97.98658033 -1.08466803 -0.77750591]
mat_Sqrt:  [[15.22070386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00309769 0.06307602 0.83976477]
Stock Position:  0.003097687040170917
Bond Position:  [-2.99148944]


portfolio before change:  [-2.68968179]
curr_Stock_Price:  97.67145981508759
curr_Factors:  [97.67145982 -0.98028896 -0.75286254]
mat_Sqrt:  [[17.26114286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00110744  0.02608196  0.02726815]
Stock Position:  -0.0011074433966452191
Bond Position:  [-2.58151618]


portfolio before change:  [-2.69173131]
curr_Stock_Price:  98.93930007086759
curr_Factors:  [98.93930007 -1.28973355 -0.75471938]
mat_Sqrt:  [[12.80779023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00349634 -0.01721617  0.07039338]
Stock Position:  -0.0034963380571423597
Bond Position:  [-2.34580607]


portfolio before change:  [-2.68705946]
curr_Stock_Price:  97.4353346200326
curr_Factors:  [97.43533462 -1.19138769 -0.74263247]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.68705946]
Stock Price:  99.04869938652504
PL:  [-2.68705946]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.56523011e-01 -4.69277484e-02  1.27221755e-01]
 [-9.40237079e-02  1.35092182e-01  9.39704725e-02]
 [ 2.68508931e-02 -3.70582979e-02  4.63233198e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 5.60345769e-01 -4.63231900e-01 -4.05770123e-01]
 [ 2.10640953e-01 -2.11200915e-01 -1.07324342e-01]
 [ 5.67752084e-02 -1.01187019e-01 -1.11492481e-02]
 [-4.88298268e-02 -1.73573684e-01 -5.84157978e-02]
 [-1.28857589e-02  1.39452680e-02 -8.78934310e-02]
 [ 3.80765290e-02  5.01470443e-02 -2.29998962e-02]
 [-5.06296806e-03 -7.85345566e-02 -2.82397764e-03]
 [ 1.01675768e-01 -4.73923100e-03 -1.69937827e-01]
 [-2.06126914e-02  2.00286071e-01  5.07225125e-02]
 [ 2.79488587e-02 -5.55488338e-02  2.81459227e-02]
 [-1.27539791e-01 -8.98716662e-02  1.88597705e-01]
 [ 1.85145488e-02  8.73763752e-02  1.11143726e-01]
 [-1.41063042e-01  9.36565453e-03  7.55988636e-02]
 [-2.17687849e-02 -1.88533457e-02  4.92570845e-02]
 [-2.28974868e-02  5.65973614e-01  2.57555624e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.90923955]
curr_Stock_Price:  99.55628210525566
curr_Factors:  [99.55628211 -0.9366253  -0.93586932]
mat_Sqrt:  [[15.30574902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01514239 -0.01483986  0.36292825]
Stock Position:  -0.015142391818684962
Bond Position:  [0.59828068]


portfolio before change:  [-0.90747817]
curr_Stock_Price:  99.44984018735036
curr_Factors:  [99.44984019 -1.08312524 -0.92300282]
mat_Sqrt:  [[13.37684645  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00533414  0.0427199   0.2680716 ]
Stock Position:  -0.0053341421428453545
Bond Position:  [-0.37699859]


portfolio before change:  [-0.9119601]
curr_Stock_Price:  100.27240224800079
curr_Factors:  [100.27240225  -0.33623254  -0.95368916]
mat_Sqrt:  [[27.60422416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00128059 -0.01171886  0.13214754]
Stock Position:  0.0012805924123546672
Bond Position:  [-1.04036818]


portfolio before change:  [-0.90836636]
curr_Stock_Price:  103.28184126092958
curr_Factors:  [103.28184126   0.1360832   -0.95461166]
mat_Sqrt:  [[45.5555799   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083291 -0.00455813 -0.02970002]
Stock Position:  -0.0008329112982009368
Bond Position:  [-0.82234175]


portfolio before change:  [-0.9124335]
curr_Stock_Price:  107.91802674826596
curr_Factors:  [107.91802675   0.17234208  -0.93463379]
mat_Sqrt:  [[50.35410881  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00924567 -0.14648679 -1.15754922]
Stock Position:  0.009245674372204997
Bond Position:  [-1.91020844]


portfolio before change:  [-0.95126516]
curr_Stock_Price:  103.76970376688263
curr_Factors:  [103.76970377   0.13727235  -0.93391842]
mat_Sqrt:  [[46.78337851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00391764 -0.06678759 -0.30616647]
Stock Position:  0.003917636677973575
Bond Position:  [-1.35779715]


portfolio before change:  [-0.94489986]
curr_Stock_Price:  105.48114150466446
curr_Factors:  [105.4811415   -0.39655874  -0.907366  ]
mat_Sqrt:  [[28.63436138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00181204 -0.03199814 -0.0318057 ]
Stock Position:  0.0018120446043808783
Bond Position:  [-1.13603639]


portfolio before change:  [-0.9476871]
curr_Stock_Price:  104.09972095360301
curr_Factors:  [104.09972095  -0.44290983  -0.90292052]
mat_Sqrt:  [[27.09959936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00240725 -0.05488882 -0.16664401]
Stock Position:  -0.0024072516342528126
Bond Position:  [-0.69709287]


portfolio before change:  [-0.94438392]
curr_Stock_Price:  102.65513869546275
curr_Factors:  [ 1.02655139e+02 -4.43188170e-02 -9.22609858e-01]
mat_Sqrt:  [[39.03452565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078051  0.00440988 -0.25073549]
Stock Position:  -0.0007805107046248012
Bond Position:  [-0.86426048]


portfolio before change:  [-0.94191398]
curr_Stock_Price:  99.21376409897834
curr_Factors:  [99.2137641   0.17684548 -0.90595076]
mat_Sqrt:  [[47.8548021   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00072462  0.01585789 -0.0656123 ]
Stock Position:  0.0007246187303341014
Bond Position:  [-1.01380613]


portfolio before change:  [-0.9442881]
curr_Stock_Price:  96.28721368762328
curr_Factors:  [96.28721369  0.14498769 -0.91516013]
mat_Sqrt:  [[44.57455104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00017201 -0.02483481 -0.00805602]
Stock Position:  -0.00017200764646352015
Bond Position:  [-0.92772596]


portfolio before change:  [-0.94395686]
curr_Stock_Price:  93.01297479068799
curr_Factors:  [93.01297479  0.25183393 -0.92797894]
mat_Sqrt:  [[47.30395891  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00141352 -0.00149868 -0.48478532]
Stock Position:  0.0014135178069122655
Bond Position:  [-1.07543236]


portfolio before change:  [-0.93534413]
curr_Stock_Price:  99.29632493436046
curr_Factors:  [99.29632493  0.45402462 -0.9470561 ]
mat_Sqrt:  [[60.64741861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.38887766e-05  6.33360168e-02  1.44697210e-01]
Stock Position:  -8.388877659950952e-05
Bond Position:  [-0.92701428]


portfolio before change:  [-0.9352462]
curr_Stock_Price:  95.36602783076286
curr_Factors:  [ 9.53660278e+01  7.33770985e-02 -9.56705779e-01]
mat_Sqrt:  [[39.42474766  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00081826 -0.01756608  0.08029248]
Stock Position:  0.0008182641190576956
Bond Position:  [-1.0132808]


portfolio before change:  [-0.93404448]
curr_Stock_Price:  97.14427781088968
curr_Factors:  [97.14427781 -0.23573987 -0.96420442]
mat_Sqrt:  [[29.26092443  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00312235 -0.02841992  0.53801676]
Stock Position:  -0.003122352556037315
Bond Position:  [-0.63072579]


portfolio before change:  [-0.94143913]
curr_Stock_Price:  99.46206529168877
curr_Factors:  [99.46206529 -0.36319891 -0.98701962]
mat_Sqrt:  [[25.77893765  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00168578 0.02763084 0.31706211]
Stock Position:  0.0016857837847282394
Bond Position:  [-1.10911066]


portfolio before change:  [-0.94092074]
curr_Stock_Price:  99.93406844343633
curr_Factors:  [99.93406844 -0.22685381 -0.9495808 ]
mat_Sqrt:  [[30.81729463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00406881  0.00296168  0.21566252]
Stock Position:  -0.004068808430349086
Bond Position:  [-0.53430816]


portfolio before change:  [-0.93171705]
curr_Stock_Price:  97.6392224483694
curr_Factors:  [ 9.76392224e+01 -2.15555362e-02 -9.54752336e-01]
mat_Sqrt:  [[36.78063227  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033172 -0.00596195  0.14051675]
Stock Position:  -0.0003317239303247777
Bond Position:  [-0.89932778]


portfolio before change:  [-0.93133188]
curr_Stock_Price:  95.80025786493448
curr_Factors:  [ 9.58002579e+01  2.90027513e-02 -9.49401040e-01]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.93133188]
Stock Price:  94.06497434438198
PL:  [-0.93133188]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.09383146e-01 -2.35476379e-02  5.46192035e-02]
 [ 6.93087633e-02  2.57054375e-02  1.41870632e-02]
 [ 5.98289819e-03 -3.58651979e-02  3.01333254e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 4.08142125e-01 -3.42316449e-01 -3.05572579e-01]
 [ 6.38551960e-02 -1.50768133e-01 -1.20113332e-01]
 [ 1.36908168e-02 -8.05559224e-02 -3.90351834e-04]
 [-7.42166079e-02 -4.10948877e-02 -3.43833660e-02]
 [-1.48671611e-01  1.10180828e-02  1.73684015e-01]
 [-1.33244556e-01  1.17428050e-01 -2.05709442e-02]
 [ 4.82702193e-02 -1.11094384e-01  3.80418323e-03]
 [ 3.93251666e-02  8.98764978e-02  4.15240055e-02]
 [-2.64804613e-02  1.77826795e-01  3.51303147e-02]
 [-5.29764357e-02 -7.96159788e-02 -2.91538395e-02]
 [-1.69808433e-01 -1.18278862e-01  2.33500524e-01]
 [ 3.81032014e-02  9.78227374e-02  1.63674956e-01]
 [-8.95139734e-02  5.74194485e-02  7.86370461e-02]
 [-3.63970118e-02 -1.58305460e-02  2.15095295e-02]
 [-6.18069925e-03  5.98455933e-01  3.86452429e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.01746635]
curr_Stock_Price:  101.2176582639095
curr_Factors:  [101.21765826  -1.14974899  -1.02858539]
mat_Sqrt:  [[11.46087262  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01734964 -0.00744642  0.15581338]
Stock Position:  -0.017349642715030734
Bond Position:  [12.77355655]


portfolio before change:  [11.01005054]
curr_Stock_Price:  101.82917486758669
curr_Factors:  [101.82917487  -0.9697652   -1.02133166]
mat_Sqrt:  [[13.9043229   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0052407  0.00812877 0.04047174]
Stock Position:  0.00524070086393839
Bond Position:  [10.4763943]


portfolio before change:  [11.01363839]
curr_Stock_Price:  102.01396280189483
curr_Factors:  [102.0139628   -0.96780304  -1.02919613]
mat_Sqrt:  [[13.84758062  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00080937 -0.01134157  0.08596199]
Stock Position:  0.0008093689702534241
Bond Position:  [10.93107145]


portfolio before change:  [11.01685768]
curr_Stock_Price:  102.61466211502649
curr_Factors:  [102.61466212  -0.74306657  -0.99315824]
mat_Sqrt:  [[18.07908982  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209876 -0.00455813 -0.02970002]
Stock Position:  -0.002098764792740004
Bond Position:  [11.23222172]


portfolio before change:  [11.01646892]
curr_Stock_Price:  104.13802045676074
curr_Factors:  [104.13802046  -0.86105543  -0.97364843]
mat_Sqrt:  [[16.62675726  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02026425 -0.10824997 -0.87171351]
Stock Position:  0.020264252733857804
Bond Position:  [8.90618975]


portfolio before change:  [11.01179191]
curr_Stock_Price:  103.79733006883781
curr_Factors:  [103.79733007  -0.69583942  -0.94394701]
mat_Sqrt:  [[20.13891105  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00175999 -0.04767707 -0.3426499 ]
Stock Position:  0.0017599932863825154
Bond Position:  [10.8291093]


portfolio before change:  [11.0142217]
curr_Stock_Price:  103.63947811163533
curr_Factors:  [103.63947811  -0.86271443  -0.93571568]
mat_Sqrt:  [[17.15840624  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00067204 -0.02547402 -0.00111357]
Stock Position:  0.0006720432808454631
Bond Position:  [10.94457149]


portfolio before change:  [11.01532746]
curr_Stock_Price:  101.21295129644484
curr_Factors:  [101.2129513   -0.87602459  -0.89535742]
mat_Sqrt:  [[17.21609533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00478019 -0.01299534 -0.09808617]
Stock Position:  -0.004780186620808022
Bond Position:  [11.49914425]


portfolio before change:  [11.03471182]
curr_Stock_Price:  97.75927480752418
curr_Factors:  [97.75927481 -0.78597891 -0.93136518]
mat_Sqrt:  [[17.55193126  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00643428  0.00348422  0.49547215]
Stock Position:  -0.006434279073289163
Bond Position:  [11.66372228]


portfolio before change:  [11.03236722]
curr_Stock_Price:  98.5769108850968
curr_Factors:  [98.57691089 -0.81821358 -0.99475278]
mat_Sqrt:  [[16.08473519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00835647  0.03713401 -0.05868318]
Stock Position:  -0.008356469748157286
Bond Position:  [11.85612219]


portfolio before change:  [11.02652887]
curr_Stock_Price:  99.63031648757783
curr_Factors:  [99.63031649 -1.03426486 -0.98135193]
mat_Sqrt:  [[13.27456384  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00347871 -0.03513113  0.01085228]
Stock Position:  0.003478705655337615
Bond Position:  [10.67994432]


portfolio before change:  [11.03102083]
curr_Stock_Price:  100.15397149189424
curr_Factors:  [100.15397149  -0.86266733  -0.95844923]
mat_Sqrt:  [[16.20941354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00309214 0.02842144 0.11845643]
Stock Position:  0.0030921427089790686
Bond Position:  [10.72133046]


portfolio before change:  [11.03805777]
curr_Stock_Price:  101.56279134079077
curr_Factors:  [101.56279134  -0.73976025  -0.94360601]
mat_Sqrt:  [[18.86504963  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078018  0.05623377  0.10021701]
Stock Position:  -0.0007801754058104125
Bond Position:  [11.11729456]


portfolio before change:  [11.04048619]
curr_Stock_Price:  102.01301262697243
curr_Factors:  [102.01301263  -1.12280484  -0.93021001]
mat_Sqrt:  [[13.09310212  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00465765 -0.02517678 -0.08316779]
Stock Position:  -0.004657652057895925
Bond Position:  [11.51562731]


portfolio before change:  [11.04256188]
curr_Stock_Price:  102.18554038661672
curr_Factors:  [102.18554039  -1.33764026  -0.93752513]
mat_Sqrt:  [[10.50262047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01192077 -0.03740306  0.666112  ]
Stock Position:  -0.011920766356703296
Bond Position:  [12.26069183]


portfolio before change:  [11.03297355]
curr_Stock_Price:  103.24703945797371
curr_Factors:  [103.24703946  -1.2497107   -0.91197513]
mat_Sqrt:  [[11.8869211   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00622861 0.03093427 0.46691909]
Stock Position:  0.006228609023345243
Bond Position:  [10.38988811]


portfolio before change:  [11.04412443]
curr_Stock_Price:  104.62023109205292
curr_Factors:  [104.62023109  -1.20428847  -0.86296041]
mat_Sqrt:  [[13.23795488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00543737  0.01815762  0.2243296 ]
Stock Position:  -0.005437372345720843
Bond Position:  [11.61298358]


portfolio before change:  [11.04277083]
curr_Stock_Price:  105.40318294395327
curr_Factors:  [105.40318294  -0.90797105  -0.83831106]
mat_Sqrt:  [[18.38455152  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176317 -0.00500606  0.0613607 ]
Stock Position:  -0.0017631727565937101
Bond Position:  [11.22861485]


portfolio before change:  [11.04701178]
curr_Stock_Price:  104.59019324547756
curr_Factors:  [104.59019325  -0.46468209  -0.81545763]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.04701178]
Stock Price:  107.0935904873305
PL:  [3.95342129]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.23418050e-01 -2.49136575e-02  6.11470500e-02]
 [ 5.79105565e-02  3.89179356e-02  4.42279463e-02]
 [ 2.13066971e-02  3.32748976e-02  3.53251613e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.13939103e-01 -2.67478551e-01 -2.43557562e-01]
 [-3.78261535e-02 -1.10798648e-01 -1.30111822e-01]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-1.04429475e-01 -4.46229003e-02 -4.58711675e-02]
 [-1.58150922e-02  3.33180211e-03 -1.12776263e-01]
 [-3.04655391e-01  2.89720820e-01  4.37048905e-03]
 [ 1.16988667e-01 -1.52790642e-01 -1.60623693e-03]
 [-6.86094844e-02  2.50905547e-02  1.67909477e-02]
 [-5.39520141e-02  1.54827500e-01 -6.00904364e-03]
 [-7.54663443e-02 -7.57858286e-02  3.65657497e-02]
 [-1.48529272e-01 -1.09790174e-01  2.27098342e-01]
 [ 3.81242146e-02  9.63217374e-02  1.57774177e-01]
 [-7.49261695e-02  9.37397915e-02  5.19322501e-02]
 [-4.59118529e-02 -4.27323657e-02  2.16949898e-02]
 [-3.54644407e-02  4.53859936e-01  1.91758572e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.97868922]
curr_Stock_Price:  100.93365899812557
curr_Factors:  [100.933659    -0.95213421  -0.99645201]
mat_Sqrt:  [[14.38055915  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0147129  -0.00787839  0.17443551]
Stock Position:  -0.014712899972737052
Bond Position:  [10.46371605]


portfolio before change:  [8.98105008]
curr_Stock_Price:  100.9510172359788
curr_Factors:  [100.95101724  -1.01306802  -1.04524547]
mat_Sqrt:  [[12.88832594  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0052717  0.01230693 0.12617002]
Stock Position:  0.005271701333973346
Bond Position:  [8.44886647]


portfolio before change:  [8.98688343]
curr_Stock_Price:  101.65683686445163
curr_Factors:  [101.65683686  -0.87533134  -1.06741322]
mat_Sqrt:  [[14.56845014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00201645 0.01052245 0.10077285]
Stock Position:  0.002016451261128768
Bond Position:  [8.78189738]


portfolio before change:  [8.98885649]
curr_Stock_Price:  101.54640081671786
curr_Factors:  [101.54640082  -1.04990699  -1.04698554]
mat_Sqrt:  [[12.47371099  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0030419  -0.00455813 -0.02970002]
Stock Position:  -0.0030418980550539054
Bond Position:  [9.29775029]


portfolio before change:  [8.98800777]
curr_Stock_Price:  102.58964679407491
curr_Factors:  [102.58964679  -1.21362551  -1.06774126]
mat_Sqrt:  [[10.47896851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02455555 -0.08458414 -0.69480193]
Stock Position:  0.024555552146516394
Bond Position:  [6.46886235]


portfolio before change:  [9.02177594]
curr_Stock_Price:  103.89895346231877
curr_Factors:  [103.89895346  -1.38138788  -1.0909118 ]
mat_Sqrt:  [[ 8.76809136  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00766939 -0.03503761 -0.37117281]
Stock Position:  -0.007669391648227769
Bond Position:  [9.81861771]


portfolio before change:  [9.03859114]
curr_Stock_Price:  102.02654475478887
curr_Factors:  [102.02654475  -1.20204561  -1.11949201]
mat_Sqrt:  [[10.01110932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.000566   -0.02845143  0.0120735 ]
Stock Position:  -0.0005660006004633155
Bond Position:  [9.09633822]


portfolio before change:  [9.04095129]
curr_Stock_Price:  101.87498864940792
curr_Factors:  [101.87498865  -1.17164866  -1.13210133]
mat_Sqrt:  [[10.17563841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0112961  -0.014111   -0.13085767]
Stock Position:  -0.011296101722496824
Bond Position:  [10.19174152]


portfolio before change:  [9.03362272]
curr_Stock_Price:  102.74934542482018
curr_Factors:  [102.74934542  -1.04640746  -1.16165368]
mat_Sqrt:  [[11.29354526  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00343111  0.00105361 -0.32171929]
Stock Position:  -0.003431112441405275
Bond Position:  [9.38616727]


portfolio before change:  [9.03811341]
curr_Stock_Price:  102.1245154540285
curr_Factors:  [102.12451545  -0.70616168  -1.17219041]
mat_Sqrt:  [[15.60889149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01898166  0.09161777  0.01246779]
Stock Position:  -0.018981662418438766
Bond Position:  [10.97660649]


portfolio before change:  [9.03295274]
curr_Stock_Price:  102.5409788152582
curr_Factors:  [102.54097882  -0.76622812  -1.14024235]
mat_Sqrt:  [[15.23799595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00739702 -0.04831664 -0.00458215]
Stock Position:  0.007397019815516213
Bond Position:  [8.27445509]


portfolio before change:  [9.04604077]
curr_Stock_Price:  104.03065331407062
curr_Factors:  [104.03065331  -1.00522169  -1.11337315]
mat_Sqrt:  [[12.50452728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00516087  0.00793433  0.0478999 ]
Stock Position:  -0.005160867716611264
Bond Position:  [9.58292921]


portfolio before change:  [9.04615239]
curr_Stock_Price:  104.47329271828256
curr_Factors:  [104.47329272  -1.48535508  -1.10802852]
mat_Sqrt:  [[ 7.81111609  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00655233  0.04896075 -0.01714213]
Stock Position:  -0.00655232561753875
Bond Position:  [9.73069543]


portfolio before change:  [9.05550351]
curr_Stock_Price:  103.41746413407724
curr_Factors:  [103.41746413  -1.30312228  -1.07800192]
mat_Sqrt:  [[ 9.56059199  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00731745 -0.02396558  0.10431191]
Stock Position:  -0.007317452065956843
Bond Position:  [9.81225584]


portfolio before change:  [9.06535231]
curr_Stock_Price:  102.40680664823677
curr_Factors:  [102.40680665  -1.05489885  -1.09086935]
mat_Sqrt:  [[11.9793578   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00876573 -0.0347187   0.64784836]
Stock Position:  -0.008765727538037726
Bond Position:  [9.96302248]


portfolio before change:  [9.07307437]
curr_Stock_Price:  101.81005134508274
curr_Factors:  [101.81005135  -1.36784169  -1.09226737]
mat_Sqrt:  [[ 8.69718813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00837245 0.03045961 0.45008581]
Stock Position:  0.008372447409459834
Bond Position:  [8.22067507]


portfolio before change:  [9.0808779]
curr_Stock_Price:  102.49660081708433
curr_Factors:  [102.49660082  -1.72338144  -1.06740022]
mat_Sqrt:  [[ 6.29054662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00984099  0.02964312  0.14814825]
Stock Position:  -0.009840987759503862
Bond Position:  [10.08954569]


portfolio before change:  [9.08777091]
curr_Stock_Price:  102.05250831457425
curr_Factors:  [102.05250831  -1.44854903  -1.06722664]
mat_Sqrt:  [[ 8.24586448  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00516462 -0.01351316  0.06188977]
Stock Position:  -0.005164616353351978
Bond Position:  [9.61483296]


portfolio before change:  [9.09664334]
curr_Stock_Price:  100.80005965782568
curr_Factors:  [100.80005966  -1.40067062  -1.08473171]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.09664334]
Stock Price:  100.74135216208698
PL:  [8.35529117]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.10081859e-01 -3.63980067e-02  1.09678995e-01]
 [-8.49585865e-02  1.30323955e-01  9.52576656e-02]
 [ 2.86372416e-03 -3.56102003e-02  3.37186285e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.31296676e-01 -2.81267963e-01 -2.54984267e-01]
 [-1.48122759e-02 -7.17532716e-02 -9.89119825e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-9.80470277e-02 -4.38406701e-02 -3.81154782e-02]
 [-3.88937604e-03  1.88355921e-02 -8.42715270e-02]
 [-3.79326847e-01  3.61947314e-01  2.20840231e-02]
 [ 1.15439314e-01 -1.50317179e-01 -3.56820541e-03]
 [-3.50900988e-02  4.33112201e-02  3.14943575e-02]
 [-5.01108053e-02  1.63515822e-01  1.86561407e-03]
 [-9.89767359e-02 -6.87544868e-02  1.05067922e-01]
 [-1.43570933e-01 -1.11947359e-01  2.37134348e-01]
 [ 1.26590112e-02  5.90865123e-02  5.70829719e-02]
 [-1.30033696e-01  1.45090034e-02  8.24822105e-02]
 [-4.19983925e-02 -3.07809340e-02  2.10586523e-02]
 [-2.85593044e-02  5.08420597e-01  2.50690901e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.44548766]
curr_Stock_Price:  99.88429284638197
curr_Factors:  [99.88429285 -1.12116105 -1.0260925 ]
mat_Sqrt:  [[11.66693645  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02473944 -0.01151006  0.31288364]
Stock Position:  -0.024739443949142674
Bond Position:  [3.91656952]


portfolio before change:  [1.45497365]
curr_Stock_Price:  99.54044014277238
curr_Factors:  [99.54044014 -1.05466235 -1.01855116]
mat_Sqrt:  [[12.52028937  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00496388  0.04121205  0.27174361]
Stock Position:  -0.004963882629180105
Bond Position:  [1.94908071]


portfolio before change:  [1.44583412]
curr_Stock_Price:  101.47982171893861
curr_Factors:  [101.47982172  -1.06976647  -0.98762437]
mat_Sqrt:  [[12.9677971   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00068069 -0.01126093  0.09618986]
Stock Position:  0.0006806907053127709
Bond Position:  [1.37675774]


portfolio before change:  [1.44711428]
curr_Stock_Price:  102.85479746170266
curr_Factors:  [102.85479746  -1.18204636  -1.01621813]
mat_Sqrt:  [[11.4164325   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332361 -0.00455813 -0.02970002]
Stock Position:  -0.0033236089482732807
Bond Position:  [1.78896341]


portfolio before change:  [1.44819851]
curr_Stock_Price:  102.66315794342837
curr_Factors:  [102.66315794  -1.34422357  -1.03842684]
mat_Sqrt:  [[ 9.47638496  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02870144 -0.08894474 -0.72739914]
Stock Position:  0.028701443013958633
Bond Position:  [-1.49838226]


portfolio before change:  [1.45497614]
curr_Stock_Price:  102.91235355061204
curr_Factors:  [102.91235355  -1.22194144  -1.08335807]
mat_Sqrt:  [[10.26333848  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00359096 -0.02269038 -0.28216835]
Stock Position:  -0.0035909622786522008
Bond Position:  [1.82453052]


portfolio before change:  [1.45850058]
curr_Stock_Price:  102.05791710366941
curr_Factors:  [102.0579171   -1.56471546  -1.10040895]
mat_Sqrt:  [[ 7.10228138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079781 -0.02845143  0.0120735 ]
Stock Position:  -0.0007978132068629876
Bond Position:  [1.53992374]


portfolio before change:  [1.45888418]
curr_Stock_Price:  102.05970805919547
curr_Factors:  [102.05970806  -1.73432184  -1.12456911]
mat_Sqrt:  [[ 5.85131877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01827952 -0.01386364 -0.10873285]
Stock Position:  -0.01827951655664225
Bond Position:  [3.32448631]


portfolio before change:  [1.45981222]
curr_Stock_Price:  102.0544117951374
curr_Factors:  [102.0544118   -1.55546388  -1.16213319]
mat_Sqrt:  [[ 6.73898318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305757  0.00595634 -0.24040321]
Stock Position:  -0.00305756759090165
Bond Position:  [1.77185048]


portfolio before change:  [1.46021155]
curr_Stock_Price:  102.06869960277655
curr_Factors:  [102.0686996   -1.31842026  -1.16088992]
mat_Sqrt:  [[ 8.55346047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04272815  0.11445779  0.06299957]
Stock Position:  -0.04272814809516936
Bond Position:  [5.82141807]


portfolio before change:  [1.40494611]
curr_Stock_Price:  103.39618479911167
curr_Factors:  [103.3961848   -1.17500727  -1.20880791]
mat_Sqrt:  [[ 9.53293734  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01162598 -0.04753447 -0.0101791 ]
Stock Position:  0.011625984771141526
Bond Position:  [0.20286364]


portfolio before change:  [1.40335252]
curr_Stock_Price:  103.25475064846974
curr_Factors:  [103.25475065  -1.05600685  -1.23464316]
mat_Sqrt:  [[10.44944883  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263584  0.01369621  0.08984464]
Stock Position:  -0.0026358375057373915
Bond Position:  [1.67551526]


portfolio before change:  [1.40389447]
curr_Stock_Price:  103.20807931196322
curr_Factors:  [103.20807931  -1.02065274  -1.19068284]
mat_Sqrt:  [[11.30688194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00402481  0.05170824  0.00532208]
Stock Position:  -0.004024807928090084
Bond Position:  [1.81928716]


portfolio before change:  [1.40182493]
curr_Stock_Price:  103.83529356191109
curr_Factors:  [103.83529356  -0.7903399   -1.18137666]
mat_Sqrt:  [[14.45570815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00548607 -0.02174208  0.29972954]
Stock Position:  -0.0054860729468438575
Bond Position:  [1.97147292]


portfolio before change:  [1.4035187]
curr_Stock_Price:  103.61640409294272
curr_Factors:  [103.61640409  -0.83191748  -1.18426939]
mat_Sqrt:  [[13.79779489  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00710668 -0.03540086  0.67647829]
Stock Position:  -0.007106683051051218
Bond Position:  [2.13988764]


portfolio before change:  [1.40031154]
curr_Stock_Price:  104.14297826470428
curr_Factors:  [104.14297826  -0.95927487  -1.19438665]
mat_Sqrt:  [[12.08667036  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00213761 0.0186848  0.16284183]
Stock Position:  0.0021376136237569393
Bond Position:  [1.1776941]


portfolio before change:  [1.39872521]
curr_Stock_Price:  103.26311945775697
curr_Factors:  [103.26311946  -0.75418525  -1.15664973]
mat_Sqrt:  [[15.2784801   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0073844   0.00458815  0.23529879]
Stock Position:  -0.007384403653523224
Bond Position:  [2.16126176]


portfolio before change:  [1.39789322]
curr_Stock_Price:  103.4489664986829
curr_Factors:  [103.4489665   -0.63856095  -1.15411238]
mat_Sqrt:  [[17.22574519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223471 -0.00973379  0.06007447]
Stock Position:  -0.0022347116447505306
Bond Position:  [1.62907183]


portfolio before change:  [1.40190154]
curr_Stock_Price:  101.83757220714303
curr_Factors:  [101.83757221  -0.92468596  -1.17327983]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.40190154]
Stock Price:  101.90709530148587
PL:  [-0.50519376]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.92344758e-01 -2.18892887e-02  4.66943912e-02]
 [ 5.87912550e-02  3.78970534e-02  4.19067952e-02]
 [-2.32020877e-02 -1.65180972e-01  3.61881380e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.73983158e-01 -2.58519999e-01 -1.61201862e-01]
 [ 6.18725457e-02 -1.39827616e-02 -3.84734385e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [ 6.35343144e-03  2.98764248e-02 -6.45801355e-02]
 [-4.08206983e-01  4.03175694e-01  5.42659527e-02]
 [ 1.07566331e-01 -1.88041462e-01  5.41999298e-02]
 [ 1.13489522e-02  7.62447917e-02  4.58289732e-02]
 [-1.37279845e-02  1.79332741e-01  5.06709411e-02]
 [-4.64626432e-02 -3.78744973e-02 -5.81470553e-02]
 [-1.25949492e-01 -8.86899337e-02  1.86593420e-01]
 [ 2.49740852e-02  9.94771297e-02  1.47968543e-01]
 [-1.33301351e-01  1.25949797e-02  8.09162642e-02]
 [-3.98510121e-02 -2.50594052e-02  2.12377853e-02]
 [-1.29373380e-02  5.45486955e-01  3.37922952e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.91825705]
curr_Stock_Price:  101.34313735382392
curr_Factors:  [101.34313735  -0.99840139  -0.98724647]
mat_Sqrt:  [[13.91356539  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01317983 -0.006922    0.1332061 ]
Stock Position:  -0.013179834171718433
Bond Position:  [13.2539428]


portfolio before change:  [11.91865205]
curr_Stock_Price:  101.56460493405837
curr_Factors:  [101.56460493  -1.08970455  -0.99387828]
mat_Sqrt:  [[12.64310835  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00540405 0.0119841  0.11954842]
Stock Position:  0.005404046185357794
Bond Position:  [11.36979223]


portfolio before change:  [11.91884282]
curr_Stock_Price:  101.07385682248092
curr_Factors:  [101.07385682  -1.24038976  -1.02540147]
mat_Sqrt:  [[10.48620179  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191491 -0.05223481  0.10323468]
Stock Position:  -0.0019149134922164066
Bond Position:  [12.11239052]


portfolio before change:  [11.92286161]
curr_Stock_Price:  100.55670194327466
curr_Factors:  [100.55670194  -0.9631826   -1.07075966]
mat_Sqrt:  [[13.15470517  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288442 -0.00455813 -0.02970002]
Stock Position:  -0.002884424752211648
Bond Position:  [12.21290985]


portfolio before change:  [11.92593782]
curr_Stock_Price:  100.54886648672036
curr_Factors:  [100.54886649  -0.78293549  -1.07551654]
mat_Sqrt:  [[15.67695516  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02133086 -0.0817512  -0.45986404]
Stock Position:  0.02133086461900592
Bond Position:  [9.78114356]


portfolio before change:  [11.93975756]
curr_Stock_Price:  101.0820913061751
curr_Factors:  [101.08209131  -0.71625808  -1.0444866 ]
mat_Sqrt:  [[17.37770894  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00308776 -0.00442174 -0.10975401]
Stock Position:  0.0030877577030665507
Bond Position:  [11.62764055]


portfolio before change:  [11.9383234]
curr_Stock_Price:  99.67607657018624
curr_Factors:  [99.67607657 -0.69862321 -1.03732615]
mat_Sqrt:  [[17.56619532  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00032257 -0.02845143  0.0120735 ]
Stock Position:  -0.0003225680793853035
Bond Position:  [11.97047572]


portfolio before change:  [11.94058138]
curr_Stock_Price:  101.95469426683347
curr_Factors:  [101.95469427  -0.6744064   -1.00215391]
mat_Sqrt:  [[19.06717422  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00732071 -0.01496598 -0.14840805]
Stock Position:  -0.007320714258429724
Bond Position:  [12.68696256]


portfolio before change:  [11.9474844]
curr_Stock_Price:  101.44506037896141
curr_Factors:  [101.44506038  -0.88275926  -1.01233371]
mat_Sqrt:  [[15.24763495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039728  0.00944776 -0.18422915]
Stock Position:  -0.0003972765329770375
Bond Position:  [11.98778614]


portfolio before change:  [11.94926788]
curr_Stock_Price:  104.50046544731684
curr_Factors:  [104.50046545  -0.80122845  -0.97931798]
mat_Sqrt:  [[17.61313798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02195634  0.12749535  0.15480566]
Stock Position:  -0.021956339685640085
Bond Position:  [14.2437156]


portfolio before change:  [11.95755656]
curr_Stock_Price:  104.28516049172346
curr_Factors:  [104.28516049  -0.43349465  -0.99238115]
mat_Sqrt:  [[25.05950716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00454018 -0.05946393  0.15461731]
Stock Position:  0.0045401785075793715
Bond Position:  [11.48408332]


portfolio before change:  [11.94591509]
curr_Stock_Price:  101.08862152801387
curr_Factors:  [101.08862153  -0.1615197   -1.01545142]
mat_Sqrt:  [[31.15661092  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00072769 0.02411072 0.1307373 ]
Stock Position:  0.0007276909630735249
Bond Position:  [11.87235381]


portfolio before change:  [11.9477768]
curr_Stock_Price:  99.56772583058273
curr_Factors:  [99.56772583 -0.34960531 -1.03915685]
mat_Sqrt:  [[24.8305787   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [5.01611152e-05 5.67099920e-02 1.44550091e-01]
Stock Position:  5.016111521813944e-05
Bond Position:  [11.94278238]


portfolio before change:  [11.95067476]
curr_Stock_Price:  97.81120898697927
curr_Factors:  [97.81120899 -0.18423658 -0.99557753]
mat_Sqrt:  [[30.06089241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00197299 -0.01197697 -0.16587736]
Stock Position:  -0.0019729878844791707
Bond Position:  [12.14365509]


portfolio before change:  [11.95371772]
curr_Stock_Price:  97.8078326358421
curr_Factors:  [97.80783264 -0.63528117 -0.97838492]
mat_Sqrt:  [[19.4790314   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00462812 -0.02804622  0.53229909]
Stock Position:  -0.004628116857382244
Bond Position:  [12.4063838]


portfolio before change:  [11.94805997]
curr_Stock_Price:  99.70055380334493
curr_Factors:  [99.7005538  -0.64126117 -0.96943564]
mat_Sqrt:  [[19.9150241   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00289965 0.03145743 0.42211307]
Stock Position:  0.002899646298106657
Bond Position:  [11.65896363]


portfolio before change:  [11.95994739]
curr_Stock_Price:  102.79483498497231
curr_Factors:  [102.79483498  -0.6612646   -0.99352718]
mat_Sqrt:  [[19.647367    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00592747  0.00398288  0.23083158]
Stock Position:  -0.0059274704250906725
Bond Position:  [12.56926074]


portfolio before change:  [11.95534317]
curr_Stock_Price:  104.10178840309115
curr_Factors:  [104.1017884   -0.50218469  -1.03929851]
mat_Sqrt:  [[22.28437955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162279 -0.00792448  0.06058549]
Stock Position:  -0.0016227913494113336
Bond Position:  [12.12427866]


portfolio before change:  [11.95621112]
curr_Stock_Price:  105.4349856528483
curr_Factors:  [105.43498565  -0.91873219  -1.01243831]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.95621112]
Stock Price:  105.6041287194935
PL:  [6.3520824]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-2.77735618e-01 -3.02003956e-02  8.64109742e-02]
 [-2.21509812e-02  8.53673272e-02  5.18860829e-02]
 [-1.85319967e-02 -1.71094172e-01  4.13099386e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 3.92074273e-01 -3.29551632e-01 -2.94994912e-01]
 [ 4.99690533e-02 -1.04357410e-01 -9.68377842e-02]
 [ 3.22354491e-02 -8.18657068e-02 -5.08574189e-03]
 [-1.27744151e-01 -4.73265934e-02 -5.20233203e-02]
 [-2.74197169e-02  2.94999019e-02 -9.92134134e-03]
 [-3.67211263e-01  3.61868393e-01  4.99886902e-02]
 [ 1.09740188e-01 -1.46774765e-01 -3.02125731e-03]
 [-1.73573746e-02  5.49326907e-02  3.77169949e-02]
 [-2.39339240e-02  1.74596018e-01  3.68640149e-02]
 [-4.52238254e-02 -7.57064733e-02 -5.56370857e-02]
 [-1.41654230e-01 -1.00359937e-01  2.06386407e-01]
 [ 1.20697027e-02  1.21942359e-01  1.78288807e-01]
 [-8.03995955e-02  9.72546684e-02  4.11558116e-02]
 [-4.82339455e-02 -5.58617803e-02  2.58862501e-02]
 [-3.22169357e-02  4.87864633e-01  1.95497349e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.6366265]
curr_Stock_Price:  100.32881474880352
curr_Factors:  [100.32881475  -1.15384291  -0.97353152]
mat_Sqrt:  [[11.95415015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02182312 -0.0095502   0.24650646]
Stock Position:  -0.02182311746047883
Bond Position:  [6.82611401]


portfolio before change:  [4.64344469]
curr_Stock_Price:  100.09459314941911
curr_Factors:  [100.09459315  -0.87778284  -0.96426705]
mat_Sqrt:  [[15.86421254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058973  0.02699552  0.14801655]
Stock Position:  -0.0005897301235102933
Bond Position:  [4.70247349]


portfolio before change:  [4.64459923]
curr_Stock_Price:  100.13058692526707
curr_Factors:  [100.13058693  -0.75141464  -0.94759258]
mat_Sqrt:  [[18.31037757  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079284 -0.05410473  0.11784576]
Stock Position:  -0.000792844016489513
Bond Position:  [4.72398716]


portfolio before change:  [4.64410578]
curr_Stock_Price:  102.24271929285375
curr_Factors:  [102.24271929  -0.72154227  -0.93532718]
mat_Sqrt:  [[19.50128071  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00194571 -0.00455813 -0.02970002]
Stock Position:  -0.0019457059135974512
Bond Position:  [4.84304004]


portfolio before change:  [4.64311781]
curr_Stock_Price:  103.37284159414222
curr_Factors:  [103.37284159  -1.12030266  -0.94638309]
mat_Sqrt:  [[13.08748625  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02470678 -0.10421338 -0.84153837]
Stock Position:  0.024706784448173882
Bond Position:  [2.08910729]


portfolio before change:  [4.63396839]
curr_Stock_Price:  102.98137994758534
curr_Factors:  [102.98137995  -0.76325602  -0.9565262 ]
mat_Sqrt:  [[18.44449547  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00149137 -0.03300071 -0.27625124]
Stock Position:  0.0014913732230283471
Bond Position:  [4.48038472]


portfolio before change:  [4.63657324]
curr_Stock_Price:  103.97684900723979
curr_Factors:  [103.97684901  -0.7885701   -0.95415475]
mat_Sqrt:  [[18.20039725  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00159796 -0.02588821 -0.01450821]
Stock Position:  0.0015979630825068902
Bond Position:  [4.47042208]


portfolio before change:  [4.63520487]
curr_Stock_Price:  102.42104795348611
curr_Factors:  [102.42104795  -0.77712123  -0.93474897]
mat_Sqrt:  [[18.48985178  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00754929 -0.01496598 -0.14840805]
Stock Position:  -0.0075492943799230225
Bond Position:  [5.40841152]


portfolio before change:  [4.65281282]
curr_Stock_Price:  100.26777739198678
curr_Factors:  [100.26777739  -0.52348682  -0.94000598]
mat_Sqrt:  [[23.20462424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012361   0.00932869 -0.02830283]
Stock Position:  -0.0012360992252052729
Bond Position:  [4.77675374]


portfolio before change:  [4.64964917]
curr_Stock_Price:  103.79337232885808
curr_Factors:  [103.79337233  -0.77241626  -0.95302182]
mat_Sqrt:  [[18.48508202  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01880781  0.11443283  0.14260382]
Stock Position:  -0.018807812833345053
Bond Position:  [6.60177549]


portfolio before change:  [4.68969936]
curr_Stock_Price:  101.75169217887365
curr_Factors:  [101.75169218  -0.70280818  -0.94722946]
mat_Sqrt:  [[19.54066761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00539049 -0.04641426 -0.00861881]
Stock Position:  0.005390489755922964
Bond Position:  [4.14120791]


portfolio before change:  [4.69122183]
curr_Stock_Price:  101.84204363704774
curr_Factors:  [101.84204364  -0.66195823  -0.92115028]
mat_Sqrt:  [[20.91181915  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039404  0.01737124  0.10759609]
Stock Position:  -0.0003940388554650208
Bond Position:  [4.73135155]


portfolio before change:  [4.69256203]
curr_Stock_Price:  101.44306804074338
curr_Factors:  [101.44306804  -0.84575061  -0.95958526]
mat_Sqrt:  [[16.6791905   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071353  0.05521211  0.10516277]
Stock Position:  -0.0007135261527567684
Bond Position:  [4.76494431]


portfolio before change:  [4.69436263]
curr_Stock_Price:  100.58925286330675
curr_Factors:  [100.58925286  -0.96051419  -0.94655616]
mat_Sqrt:  [[14.93899746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0039183  -0.02394049 -0.15871712]
Stock Position:  -0.0039182971202508295
Bond Position:  [5.08850121]


portfolio before change:  [4.6967952]
curr_Stock_Price:  100.2931325355262
curr_Factors:  [100.29313254  -0.99687829  -0.94006015]
mat_Sqrt:  [[14.45671182  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00706364 -0.0317366   0.58876297]
Stock Position:  -0.007063643822646973
Bond Position:  [5.40523017]


portfolio before change:  [4.70711729]
curr_Stock_Price:  99.02316282291343
curr_Factors:  [99.02316282 -0.70691571 -0.94964739]
mat_Sqrt:  [[18.89298499  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00273177 0.03856156 0.50860834]
Stock Position:  0.002731770085754219
Bond Position:  [4.43660878]


portfolio before change:  [4.70965417]
curr_Stock_Price:  99.54574881589264
curr_Factors:  [99.54574882 -0.83255094 -0.94466469]
mat_Sqrt:  [[16.8340175   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00412781  0.03075463  0.11740607]
Stock Position:  -0.004127808225773275
Bond Position:  [5.12055993]


portfolio before change:  [4.71344814]
curr_Stock_Price:  98.9367881176069
curr_Factors:  [98.93678812 -0.71573286 -0.9127274 ]
mat_Sqrt:  [[19.41451297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00228655 -0.01766505  0.07384627]
Stock Position:  -0.002286551398498333
Bond Position:  [4.93967219]


portfolio before change:  [4.72066754]
curr_Stock_Price:  96.31960296950032
curr_Factors:  [96.31960297 -0.68887646 -0.95448793]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.72066754]
Stock Price:  94.59902168013876
PL:  [4.72066754]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.44681335e-01 -6.89671556e-02  1.63992602e-01]
 [-3.91972208e-01  2.91812202e-01  5.16635634e-02]
 [-2.22414077e-01 -6.42592821e-01 -9.33870376e-02]
 [-1.91760475e-02  1.43562399e-01  9.88383075e-02]
 [ 6.12510152e-01 -3.46416956e-01 -1.35817236e-01]
 [-1.26924314e-01  7.78585071e-02  2.90383635e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 3.26276702e-01  2.47857657e-02  1.13800903e-02]
 [-1.38757631e-01  1.52071209e-02  1.45089432e-01]
 [-1.80955508e-01  1.58739176e-01 -1.49028377e-02]
 [ 9.46641408e-03 -8.80537633e-02  4.06486123e-03]
 [ 7.08732307e-02  1.01121241e-01  6.40046980e-03]
 [-3.02052915e-02  1.84669782e-01  3.34155716e-02]
 [-3.41494308e-02 -9.77595465e-02 -7.57588018e-02]
 [-1.44805793e-01 -1.02701826e-01  2.10358383e-01]
 [ 3.45680792e-02  8.27989966e-02  1.22073405e-01]
 [-7.02009590e-02  1.12873733e-01  3.43422489e-02]
 [-5.03617872e-02 -5.80354273e-02  2.35007044e-02]
 [-3.81670580e-02  4.33849346e-01  1.67567505e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.73388215]
curr_Stock_Price:  99.0235138709368
curr_Factors:  [99.02351387 -0.96376235 -0.99128889]
mat_Sqrt:  [[14.01749361  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00806044 -0.02180933  0.46782525]
Stock Position:  -0.008060443092099951
Bond Position:  [-3.93570876]


portfolio before change:  [-4.72693199]
curr_Stock_Price:  98.03917456222233
curr_Factors:  [98.03917456 -0.92148224 -0.98708804]
mat_Sqrt:  [[14.53844984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02571745  0.09227912  0.14738177]
Stock Position:  -0.025717450807538542
Bond Position:  [-2.20561434]


portfolio before change:  [-4.71566662]
curr_Stock_Price:  97.57968710733923
curr_Factors:  [97.57968711 -0.96077777 -1.01232669]
mat_Sqrt:  [[13.56597593  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0190232  -0.20320569 -0.26640722]
Stock Position:  -0.019023202097854464
Bond Position:  [-2.85938851]


portfolio before change:  [-4.72337036]
curr_Stock_Price:  97.94707020715367
curr_Factors:  [97.94707021 -0.99622316 -1.02510286]
mat_Sqrt:  [[12.9759963   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00036267 0.04539842 0.28195818]
Stock Position:  0.00036266986036790174
Bond Position:  [-4.75889281]


portfolio before change:  [-4.72451635]
curr_Stock_Price:  98.06805540137874
curr_Factors:  [98.0680554  -1.29567121 -1.00974157]
mat_Sqrt:  [[ 9.77911411  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0588849  -0.10954666 -0.38744877]
Stock Position:  0.05888489704953408
Bond Position:  [-10.4992437]


portfolio before change:  [-4.77566593]
curr_Stock_Price:  97.2439997538105
curr_Factors:  [97.24399975 -1.25672813 -0.99129928]
mat_Sqrt:  [[10.26968007  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0115862   0.02462102  0.08283837]
Stock Position:  -0.01158620175029029
Bond Position:  [-3.64897732]


portfolio before change:  [-4.78545657]
curr_Stock_Price:  98.01028081263021
curr_Factors:  [98.01028081 -1.10033753 -0.99710991]
mat_Sqrt:  [[12.03266378  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047091 -0.02845143  0.0120735 ]
Stock Position:  -0.00047090935078157126
Bond Position:  [-4.73930261]


portfolio before change:  [-4.78647006]
curr_Stock_Price:  97.64611534887092
curr_Factors:  [97.64611535 -1.10328964 -1.03919684]
mat_Sqrt:  [[11.46000782  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02872944 0.00783795 0.03246423]
Stock Position:  0.02872944102990778
Bond Position:  [-7.59178837]


portfolio before change:  [-4.76918923]
curr_Stock_Price:  98.31368858250339
curr_Factors:  [98.31368858 -1.13568521 -1.03392957]
mat_Sqrt:  [[11.22954769  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00968416  0.00480891  0.41389976]
Stock Position:  -0.009684159325338402
Bond Position:  [-3.81710381]


portfolio before change:  [-4.77098057]
curr_Stock_Price:  98.40011180495324
curr_Factors:  [98.4001118  -1.12811647 -1.10118138]
mat_Sqrt:  [[10.58824148  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01699044  0.05019774 -0.04251365]
Stock Position:  -0.016990442648137878
Bond Position:  [-3.09911911]


portfolio before change:  [-4.7754986]
curr_Stock_Price:  98.62042140543214
curr_Factors:  [98.62042141 -1.05010308 -1.0811291 ]
mat_Sqrt:  [[11.70535201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00068538 -0.02784504  0.01159592]
Stock Position:  0.0006853798166447498
Bond Position:  [-4.84309105]


portfolio before change:  [-4.77643831]
curr_Stock_Price:  99.01613325162043
curr_Factors:  [99.01613325 -0.80047207 -1.08244626]
mat_Sqrt:  [[15.06485371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00496458 0.03197734 0.01825876]
Stock Position:  0.004964579260856769
Bond Position:  [-5.26801175]


portfolio before change:  [-4.77021481]
curr_Stock_Price:  100.5350274431627
curr_Factors:  [100.53502744  -0.13995128  -1.0894318 ]
mat_Sqrt:  [[29.40377649  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063312  0.05839771  0.09532532]
Stock Position:  -0.0006331232069344038
Bond Position:  [-4.70656375]


portfolio before change:  [-4.77004967]
curr_Stock_Price:  98.41549470962445
curr_Factors:  [98.41549471 -0.66245591 -1.06941092]
mat_Sqrt:  [[17.4149918   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00299384 -0.03091428 -0.21611877]
Stock Position:  -0.0029938441953354118
Bond Position:  [-4.47540901]


portfolio before change:  [-4.77451029]
curr_Stock_Price:  99.53166134965882
curr_Factors:  [99.53166135 -0.73937377 -1.0746595 ]
mat_Sqrt:  [[16.22320343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00644252 -0.03247717  0.60009391]
Stock Position:  -0.006442520281177617
Bond Position:  [-4.13327554]


portfolio before change:  [-4.78262962]
curr_Stock_Price:  100.6315232553611
curr_Factors:  [100.63152326  -0.85102311  -1.07036912]
mat_Sqrt:  [[14.73275616  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00418279 0.02618334 0.34824145]
Stock Position:  0.004182793012744107
Bond Position:  [-5.20355045]


portfolio before change:  [-4.78682145]
curr_Stock_Price:  99.94041053891063
curr_Factors:  [99.94041054 -1.18842572 -1.05759363]
mat_Sqrt:  [[10.57565602  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00569955  0.03569381  0.09796888]
Stock Position:  -0.005699550873206498
Bond Position:  [-4.217206]


portfolio before change:  [-4.78378071]
curr_Stock_Price:  99.22190238886829
curr_Factors:  [99.22190239 -1.31777271 -1.07755262]
mat_Sqrt:  [[ 9.0433841   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00520416 -0.01835241  0.06704097]
Stock Position:  -0.005204157395941128
Bond Position:  [-4.26741432]


portfolio before change:  [-4.78325347]
curr_Stock_Price:  98.91556527341028
curr_Factors:  [98.91556527 -1.32918755 -1.07743412]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.78325347]
Stock Price:  98.8522699597668
PL:  [-4.78325347]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-3.01080771e-01 -4.91571688e-02  1.42263150e-01]
 [-1.38729693e-01  1.58607396e-01  8.76224894e-02]
 [-1.54899295e-01 -5.97697728e-01 -3.63807802e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 9.14702921e-01 -5.42254841e-01 -2.15286908e-01]
 [-9.01609847e-02  6.89938553e-02  2.03878906e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [ 2.07633981e-01  1.95449803e-03  1.51704326e-02]
 [-7.46781004e-02  2.45113542e-02  5.04059694e-02]
 [-2.30132927e-01  2.14227741e-01  2.14335398e-02]
 [-9.00785353e-03 -7.72462386e-02  5.45757611e-03]
 [ 7.59243596e-02  1.02408836e-01  2.65092044e-03]
 [ 1.84883189e-02  1.57092521e-01  7.98301303e-02]
 [ 5.34457725e-02 -1.57195901e-01  8.70298134e-03]
 [-3.13454430e-02 -3.01016250e-02  1.15854789e-01]
 [-3.80615182e-02  2.33423144e-01  3.60392990e-01]
 [ 4.97098719e-03 -6.54635055e-03 -3.22552344e-02]
 [ 3.78157828e-02  4.65085188e-02  1.44533584e-01]
 [-4.34800546e-02  3.96144582e-01  1.10343240e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.32921446]
curr_Stock_Price:  99.63707892047312
curr_Factors:  [99.63707892 -1.10433783 -1.02095057]
mat_Sqrt:  [[11.89652061  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.022974   -0.01554486  0.40583717]
Stock Position:  -0.02297399962727488
Bond Position:  [1.95984775]


portfolio before change:  [-0.31416816]
curr_Stock_Price:  99.00348085815938
curr_Factors:  [99.00348086 -1.31059915 -1.02631492]
mat_Sqrt:  [[ 9.56624682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01220422  0.05015606  0.24996257]
Stock Position:  -0.012204222153596594
Bond Position:  [0.89409232]


portfolio before change:  [-0.31082239]
curr_Stock_Price:  98.74764976478323
curr_Factors:  [98.74764976 -1.43059475 -0.98609955]
mat_Sqrt:  [[ 8.80987543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02017713 -0.18900862 -0.10378424]
Stock Position:  -0.02017712752673701
Bond Position:  [1.68162154]


portfolio before change:  [-0.33538548]
curr_Stock_Price:  99.98586110688525
curr_Factors:  [99.98586111 -1.73123822 -0.97410624]
mat_Sqrt:  [[ 6.68378417  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00567699 -0.00455813 -0.02970002]
Stock Position:  -0.005676987201221033
Bond Position:  [0.23223298]


portfolio before change:  [-0.33165205]
curr_Stock_Price:  99.33844741621719
curr_Factors:  [99.33844742 -1.41522005 -0.92086907]
mat_Sqrt:  [[ 9.60653464  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08918478 -0.17147604 -0.61415362]
Stock Position:  0.08918478277109318
Bond Position:  [-9.1911299]


portfolio before change:  [-0.38421846]
curr_Stock_Price:  98.77480480446042
curr_Factors:  [98.7748048  -1.46993652 -0.89518579]
mat_Sqrt:  [[ 9.27868892  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00907649  0.02181777  0.05816098]
Stock Position:  -0.009076488187101073
Bond Position:  [0.51230988]


portfolio before change:  [-0.39366851]
curr_Stock_Price:  99.83007406356839
curr_Factors:  [99.83007406 -1.93256619 -0.87945651]
mat_Sqrt:  [[ 5.99812418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094468 -0.02845143  0.0120735 ]
Stock Position:  -0.0009446776555812589
Bond Position:  [-0.29936127]


portfolio before change:  [-0.39367731]
curr_Stock_Price:  99.76015465342641
curr_Factors:  [99.76015465 -1.77664606 -0.92387253]
mat_Sqrt:  [[ 6.70095636  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03145538 0.00061807 0.04327702]
Stock Position:  0.03145537530664413
Bond Position:  [-3.53167041]


portfolio before change:  [-0.39823858]
curr_Stock_Price:  99.64321939463017
curr_Factors:  [99.64321939 -1.39880801 -0.90236665]
mat_Sqrt:  [[ 9.97838593  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00638942  0.00775117  0.1437942 ]
Stock Position:  -0.006389424599523801
Bond Position:  [0.23842426]


portfolio before change:  [-0.39444616]
curr_Stock_Price:  99.05900288713951
curr_Factors:  [99.05900289 -1.43872782 -0.89653711]
mat_Sqrt:  [[ 9.58740958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02297038  0.06774476  0.06114392]
Stock Position:  -0.022970384844184556
Bond Position:  [1.88097726]


portfolio before change:  [-0.3852959]
curr_Stock_Price:  98.68112721022182
curr_Factors:  [98.68112721 -1.41455883 -0.93617499]
mat_Sqrt:  [[ 9.40423289  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105148 -0.02442741  0.01556895]
Stock Position:  -0.0010514754259829554
Bond Position:  [-0.28153512]


portfolio before change:  [-0.38502591]
curr_Stock_Price:  98.3573997034611
curr_Factors:  [98.3573997  -1.44916156 -0.92857142]
mat_Sqrt:  [[ 9.12369436  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00867079 0.03238452 0.00756234]
Stock Position:  0.008670792572645046
Bond Position:  [-1.23786252]


portfolio before change:  [-0.38628968]
curr_Stock_Price:  98.24734360907533
curr_Factors:  [98.24734361 -1.15244718 -0.91556972]
mat_Sqrt:  [[12.42202767  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00312668 0.04967702 0.22773314]
Stock Position:  0.0031266785515539994
Bond Position:  [-0.69347755]


portfolio before change:  [-0.38777634]
curr_Stock_Price:  97.82732413761826
curr_Factors:  [97.82732414 -1.18505643 -0.93947327]
mat_Sqrt:  [[11.68930391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00437695 -0.04970971  0.02482718]
Stock Position:  0.004376948432440755
Bond Position:  [-0.81596149]


portfolio before change:  [-0.39164273]
curr_Stock_Price:  96.99058334879922
curr_Factors:  [96.99058335 -1.49499342 -0.93205984]
mat_Sqrt:  [[ 8.56394231  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098949 -0.00951897  0.33050147]
Stock Position:  -0.0009894863172085421
Bond Position:  [-0.29567187]


portfolio before change:  [-0.39035105]
curr_Stock_Price:  95.61047246347134
curr_Factors:  [95.61047246 -1.26732992 -0.91536867]
mat_Sqrt:  [[10.7788273   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00385296 0.07381488 1.02810089]
Stock Position:  0.0038529564721950615
Bond Position:  [-0.75873404]


portfolio before change:  [-0.39279016]
curr_Stock_Price:  95.02666135587604
curr_Factors:  [95.02666136 -0.97100647 -0.93816942]
mat_Sqrt:  [[14.08318607  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00012654 -0.00207014 -0.09201521]
Stock Position:  -0.00012654175003238676
Bond Position:  [-0.38076532]


portfolio before change:  [-0.39290794]
curr_Stock_Price:  95.2050616718895
curr_Factors:  [95.20506167 -1.17057315 -0.9599224 ]
mat_Sqrt:  [[11.30830664  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00605921 0.01470728 0.41231409]
Stock Position:  0.006059211517975111
Bond Position:  [-0.96977554]


portfolio before change:  [-0.39283392]
curr_Stock_Price:  95.25729482911962
curr_Factors:  [95.25729483 -1.3569535  -0.96142766]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.39283392]
Stock Price:  93.66316206162239
PL:  [-0.39283392]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 9.92904888e+01 -9.29052183e+00 -9.28828307e+00]
 [-1.27796454e-01 -6.88710473e-02  1.60311854e-01]
 [ 3.46642996e-02  4.55833590e-02  1.65279570e-02]
 [-8.08015816e-03 -1.27016292e-01  2.18684672e-02]
 [-3.54464274e-02 -1.44140658e-02 -1.04111163e-02]
 [ 4.83362723e-01 -3.42658475e-01 -2.30054194e-01]
 [-3.35488144e-02  1.26931586e-02 -5.43745026e-02]
 [-4.20715383e-03 -8.99713208e-02  4.23227469e-03]
 [-6.22657624e-02 -3.96803979e-02 -2.71031065e-02]
 [-2.13166015e-02  3.01441406e-02 -1.77122244e-02]
 [-3.14466657e-01  3.02291557e-01  3.88485934e-02]
 [ 9.06482749e-02 -1.35727647e-01 -6.28603608e-04]
 [-5.07181645e-03  6.40537133e-02  4.11887098e-02]
 [-2.21100327e-02  1.63806579e-01  3.48187345e-02]
 [-4.93830538e-02 -1.18467720e-01 -3.89363212e-02]
 [-1.52548800e-01 -1.09887651e-01  2.24109351e-01]
 [ 3.54402276e-02  6.74450553e-02  9.63368339e-02]
 [-1.29474602e-01  1.56839854e-02  8.17220143e-02]
 [-4.14657922e-02 -2.93122851e-02  2.10717677e-02]
 [-2.83380357e-02  5.04228884e-01  2.51868134e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.29048877 -9.29052183 -9.28828307]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17881127  -2.93792096 -26.49688624]
init_Out:  [2.45500637]
Stock Position:  7.1788112726126565
Bond position:  [-715.4261209]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.28486826]
curr_Stock_Price:  98.9467621520373
curr_Factors:  [98.94676215 -0.95714732 -0.97629183]
mat_Sqrt:  [[14.31263622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00676683 -0.02177894  0.4573251 ]
Stock Position:  -0.006766830062035795
Bond Position:  [-4.61531233]


portfolio before change:  [-5.29665754]
curr_Stock_Price:  100.51844493220555
curr_Factors:  [100.51844493  -0.69221136  -0.98929144]
mat_Sqrt:  [[18.70588985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0020964  0.01441472 0.04714966]
Stock Position:  0.00209639917220887
Bond Position:  [-5.50738433]


portfolio before change:  [-5.29309869]
curr_Stock_Price:  102.8728977109131
curr_Factors:  [102.87289771  -0.9145001   -1.01550032]
mat_Sqrt:  [[14.93180955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046182 -0.04016608  0.06238465]
Stock Position:  -0.0004618209559127605
Bond Position:  [-5.24558983]


portfolio before change:  [-5.2934555]
curr_Stock_Price:  100.80554137829968
curr_Factors:  [100.80554138  -1.07498064  -1.0030188 ]
mat_Sqrt:  [[12.61887732  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0030069  -0.00455813 -0.02970002]
Stock Position:  -0.0030069043582880584
Bond Position:  [-4.99034288]


portfolio before change:  [-5.29572325]
curr_Stock_Price:  101.14476273868868
curr_Factors:  [101.14476274  -1.24889194  -0.96910209]
mat_Sqrt:  [[11.00730073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03884292 -0.10835812 -0.65628058]
Stock Position:  0.038842920223645425
Bond Position:  [-9.2244812]


portfolio before change:  [-5.29232105]
curr_Stock_Price:  101.29172909021179
curr_Factors:  [101.29172909  -1.23301077  -0.92375927]
mat_Sqrt:  [[11.71927273  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00378182  0.00401393 -0.15511532]
Stock Position:  -0.0037818240411408195
Bond Position:  [-4.90925356]


portfolio before change:  [-5.29563352]
curr_Stock_Price:  101.84305058435918
curr_Factors:  [101.84305058  -1.10098464  -0.97225907]
mat_Sqrt:  [[12.80952717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044235 -0.02845143  0.0120735 ]
Stock Position:  -0.0004423499643263555
Bond Position:  [-5.25058325]


portfolio before change:  [-5.29673321]
curr_Stock_Price:  101.36124516332494
curr_Factors:  [101.36124516  -1.35030426  -0.95708012]
mat_Sqrt:  [[10.08759483  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00682251 -0.01254804 -0.07731762]
Stock Position:  -0.006822508779444552
Bond Position:  [-4.60519522]


portfolio before change:  [-5.29433227]
curr_Stock_Price:  100.8405606074229
curr_Factors:  [100.84056061  -1.19105146  -0.95531969]
mat_Sqrt:  [[11.78903077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00204883  0.00953241 -0.05052805]
Stock Position:  -0.002048834743483143
Bond Position:  [-5.08772663]


portfolio before change:  [-5.29667658]
curr_Stock_Price:  101.36389229986061
curr_Factors:  [101.3638923   -1.26443598  -0.96293941]
mat_Sqrt:  [[10.92814465  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02733598  0.09559298  0.11082422]
Stock Position:  -0.027335983914947272
Bond Position:  [-2.52579485]


portfolio before change:  [-5.31049314]
curr_Stock_Price:  101.84622459891392
curr_Factors:  [101.8462246   -1.10556873  -0.99288327]
mat_Sqrt:  [[12.49104608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00696623 -0.04292085 -0.00179323]
Stock Position:  0.0069662291250355305
Bond Position:  [-6.01997728]


portfolio before change:  [-5.31498556]
curr_Stock_Price:  101.4174076081486
curr_Factors:  [101.41740761  -1.11034546  -1.00243292]
mat_Sqrt:  [[12.26152571  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00040694 0.02025556 0.11749992]
Stock Position:  0.00040693577720446195
Bond Position:  [-5.35625593]


portfolio before change:  [-5.3162961]
curr_Stock_Price:  101.48792051683834
curr_Factors:  [101.48792052  -1.18920389  -1.05053563]
mat_Sqrt:  [[10.80706683  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00099687  0.05180019  0.09932816]
Stock Position:  -0.0009968681384809103
Bond Position:  [-5.21512602]


portfolio before change:  [-5.31812807]
curr_Stock_Price:  102.01760499101033
curr_Factors:  [102.01760499  -1.29236016  -1.03620211]
mat_Sqrt:  [[ 9.94016012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00607533 -0.03746278 -0.11107449]
Stock Position:  -0.006075326726149034
Bond Position:  [-4.69833778]


portfolio before change:  [-5.31796014]
curr_Stock_Price:  101.7966039681043
curr_Factors:  [101.79660397  -1.1608467   -1.08618783]
mat_Sqrt:  [[10.76114779  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0101885  -0.03474953  0.6393216 ]
Stock Position:  -0.010188500256742093
Bond Position:  [-4.28080542]


portfolio before change:  [-5.33166488]
curr_Stock_Price:  103.03666883105376
curr_Factors:  [103.03666883  -1.13785268  -1.12068787]
mat_Sqrt:  [[10.76762971  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00527937 0.021328   0.27482217]
Stock Position:  0.005279372236979362
Bond Position:  [-5.87563381]


portfolio before change:  [-5.33575135]
curr_Stock_Price:  102.54089415147004
curr_Factors:  [102.54089415  -1.08484527  -1.08991868]
mat_Sqrt:  [[11.65223186  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00964521  0.00495971  0.23313016]
Stock Position:  -0.009645208590128847
Bond Position:  [-4.34672304]


portfolio before change:  [-5.34917841]
curr_Stock_Price:  103.82031063013542
curr_Factors:  [103.82031063  -1.10560847  -1.11780246]
mat_Sqrt:  [[11.23743583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337456 -0.00926936  0.06011189]
Stock Position:  -0.0033745576965366906
Bond Position:  [-4.99883078]


portfolio before change:  [-5.34789254]
curr_Stock_Price:  103.06888565022669
curr_Factors:  [103.06888565  -1.19300451  -1.09368202]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.34789254]
Stock Price:  102.6461175297638
PL:  [-7.99401007]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  -0.033867785913539256
FINAL STD P&L:  6.581941835956323
