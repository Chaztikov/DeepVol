WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-17 01:25:47.289487: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-17 01:25:47.550931: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-12-17 01:25:47.551418: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 01:25:47.553347: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-17 01:25:47.555195: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-17 01:25:47.556212: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-17 01:25:47.558530: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-17 01:25:47.560297: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-17 01:25:47.565197: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-17 01:25:47.606363: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-17 01:25:47.606757: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-17 01:25:47.613571: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2399950000 Hz
2019-12-17 01:25:47.613772: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55fdb171abf0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-17 01:25:47.613791: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-17 01:25:47.637631: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-12-17 01:25:47.637663: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 01:25:47.637677: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-17 01:25:47.637688: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-17 01:25:47.637698: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-17 01:25:47.637708: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-17 01:25:47.637718: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-17 01:25:47.637729: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-17 01:25:47.683921: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-17 01:25:47.683965: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-17 01:25:48.480973: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-17 01:25:48.481019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-17 01:25:48.481030: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-17 01:25:48.551859: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2019-12-17 01:25:48.554018: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55fdb1d53e40 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-17 01:25:48.554036: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
INFO   Y0_true: -1.0000e+00
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-17 01:25:57.730309: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 2.1992e+02,   Y0: 2.4818e+00,  elapsed time   9
INFO   step:     1,    loss: 1.2550e+02,   Y0: 2.4868e+00,  elapsed time  12
INFO   step:     2,    loss: 1.2548e+02,   Y0: 2.4886e+00,  elapsed time  13
INFO   step:     3,    loss: 1.2546e+02,   Y0: 2.4892e+00,  elapsed time  14
INFO   step:     4,    loss: 1.2544e+02,   Y0: 2.4908e+00,  elapsed time  15
INFO   step:     5,    loss: 1.2543e+02,   Y0: 2.4907e+00,  elapsed time  16
INFO   step:     6,    loss: 1.2541e+02,   Y0: 2.4909e+00,  elapsed time  17
INFO   step:     7,    loss: 1.2540e+02,   Y0: 2.4914e+00,  elapsed time  18
INFO   step:     8,    loss: 1.2538e+02,   Y0: 2.4931e+00,  elapsed time  19
INFO   step:     9,    loss: 1.2537e+02,   Y0: 2.4936e+00,  elapsed time  20
INFO   step:    10,    loss: 1.2535e+02,   Y0: 2.4936e+00,  elapsed time  21
INFO   step:    11,    loss: 1.2534e+02,   Y0: 2.4938e+00,  elapsed time  22
INFO   step:    12,    loss: 1.2532e+02,   Y0: 2.4927e+00,  elapsed time  23
INFO   step:    13,    loss: 1.2530e+02,   Y0: 2.4913e+00,  elapsed time  24
INFO   step:    14,    loss: 1.2528e+02,   Y0: 2.4899e+00,  elapsed time  25
INFO   step:    15,    loss: 1.2526e+02,   Y0: 2.4884e+00,  elapsed time  26
INFO   step:    16,    loss: 1.2525e+02,   Y0: 2.4863e+00,  elapsed time  27
INFO   step:    17,    loss: 1.2523e+02,   Y0: 2.4844e+00,  elapsed time  27
INFO   step:    18,    loss: 1.2521e+02,   Y0: 2.4825e+00,  elapsed time  28
INFO   step:    19,    loss: 1.2519e+02,   Y0: 2.4799e+00,  elapsed time  29
INFO   step:    20,    loss: 1.2517e+02,   Y0: 2.4785e+00,  elapsed time  30
INFO   step:    21,    loss: 1.2516e+02,   Y0: 2.4771e+00,  elapsed time  31
INFO   step:    22,    loss: 1.2514e+02,   Y0: 2.4754e+00,  elapsed time  32
INFO   step:    23,    loss: 1.2512e+02,   Y0: 2.4734e+00,  elapsed time  33
INFO   step:    24,    loss: 1.2511e+02,   Y0: 2.4717e+00,  elapsed time  34
INFO   step:    25,    loss: 1.2509e+02,   Y0: 2.4705e+00,  elapsed time  35
INFO   step:    26,    loss: 1.2507e+02,   Y0: 2.4696e+00,  elapsed time  36
INFO   step:    27,    loss: 1.2506e+02,   Y0: 2.4695e+00,  elapsed time  37
INFO   step:    28,    loss: 1.2504e+02,   Y0: 2.4702e+00,  elapsed time  38
INFO   step:    29,    loss: 1.2502e+02,   Y0: 2.4713e+00,  elapsed time  39
INFO   step:    30,    loss: 1.2501e+02,   Y0: 2.4726e+00,  elapsed time  40
INFO   step:    31,    loss: 1.2499e+02,   Y0: 2.4744e+00,  elapsed time  41
INFO   step:    32,    loss: 1.2497e+02,   Y0: 2.4760e+00,  elapsed time  41
INFO   step:    33,    loss: 1.2496e+02,   Y0: 2.4774e+00,  elapsed time  42
INFO   step:    34,    loss: 1.2494e+02,   Y0: 2.4788e+00,  elapsed time  43
INFO   step:    35,    loss: 1.2493e+02,   Y0: 2.4800e+00,  elapsed time  44
INFO   step:    36,    loss: 1.2491e+02,   Y0: 2.4796e+00,  elapsed time  45
INFO   step:    37,    loss: 1.2489e+02,   Y0: 2.4789e+00,  elapsed time  46
INFO   step:    38,    loss: 1.2488e+02,   Y0: 2.4778e+00,  elapsed time  47
INFO   step:    39,    loss: 1.2486e+02,   Y0: 2.4768e+00,  elapsed time  48
INFO   step:    40,    loss: 1.2485e+02,   Y0: 2.4759e+00,  elapsed time  49
INFO   step:    41,    loss: 1.2483e+02,   Y0: 2.4757e+00,  elapsed time  50
INFO   step:    42,    loss: 1.2482e+02,   Y0: 2.4761e+00,  elapsed time  51
INFO   step:    43,    loss: 1.2480e+02,   Y0: 2.4766e+00,  elapsed time  52
INFO   step:    44,    loss: 1.2478e+02,   Y0: 2.4773e+00,  elapsed time  53
INFO   step:    45,    loss: 1.2477e+02,   Y0: 2.4785e+00,  elapsed time  54
INFO   step:    46,    loss: 1.2475e+02,   Y0: 2.4791e+00,  elapsed time  55
INFO   step:    47,    loss: 1.2473e+02,   Y0: 2.4799e+00,  elapsed time  56
INFO   step:    48,    loss: 1.2471e+02,   Y0: 2.4810e+00,  elapsed time  56
INFO   step:    49,    loss: 1.2470e+02,   Y0: 2.4814e+00,  elapsed time  57
INFO   step:    50,    loss: 1.2468e+02,   Y0: 2.4819e+00,  elapsed time  58
INFO   step:    51,    loss: 1.2467e+02,   Y0: 2.4826e+00,  elapsed time  59
INFO   step:    52,    loss: 1.2465e+02,   Y0: 2.4830e+00,  elapsed time  60
INFO   step:    53,    loss: 1.2464e+02,   Y0: 2.4840e+00,  elapsed time  61
INFO   step:    54,    loss: 1.2462e+02,   Y0: 2.4854e+00,  elapsed time  62
INFO   step:    55,    loss: 1.2461e+02,   Y0: 2.4857e+00,  elapsed time  63
INFO   step:    56,    loss: 1.2459e+02,   Y0: 2.4862e+00,  elapsed time  64
INFO   step:    57,    loss: 1.2457e+02,   Y0: 2.4871e+00,  elapsed time  65
INFO   step:    58,    loss: 1.2456e+02,   Y0: 2.4876e+00,  elapsed time  66
INFO   step:    59,    loss: 1.2454e+02,   Y0: 2.4886e+00,  elapsed time  67
INFO   step:    60,    loss: 1.2452e+02,   Y0: 2.4904e+00,  elapsed time  68
INFO   step:    61,    loss: 1.2450e+02,   Y0: 2.4927e+00,  elapsed time  69
INFO   step:    62,    loss: 1.2449e+02,   Y0: 2.4945e+00,  elapsed time  70
INFO   step:    63,    loss: 1.2447e+02,   Y0: 2.4960e+00,  elapsed time  71
INFO   step:    64,    loss: 1.2445e+02,   Y0: 2.4983e+00,  elapsed time  71
INFO   step:    65,    loss: 1.2443e+02,   Y0: 2.4995e+00,  elapsed time  72
INFO   step:    66,    loss: 1.2442e+02,   Y0: 2.5005e+00,  elapsed time  73
INFO   step:    67,    loss: 1.2440e+02,   Y0: 2.5008e+00,  elapsed time  74
INFO   step:    68,    loss: 1.2438e+02,   Y0: 2.5011e+00,  elapsed time  75
INFO   step:    69,    loss: 1.2437e+02,   Y0: 2.5028e+00,  elapsed time  76
INFO   step:    70,    loss: 1.2435e+02,   Y0: 2.5036e+00,  elapsed time  77
INFO   step:    71,    loss: 1.2433e+02,   Y0: 2.5045e+00,  elapsed time  78
INFO   step:    72,    loss: 1.2432e+02,   Y0: 2.5048e+00,  elapsed time  79
INFO   step:    73,    loss: 1.2430e+02,   Y0: 2.5047e+00,  elapsed time  80
INFO   step:    74,    loss: 1.2428e+02,   Y0: 2.5050e+00,  elapsed time  81
INFO   step:    75,    loss: 1.2426e+02,   Y0: 2.5052e+00,  elapsed time  82
INFO   step:    76,    loss: 1.2424e+02,   Y0: 2.5058e+00,  elapsed time  83
INFO   step:    77,    loss: 1.2423e+02,   Y0: 2.5062e+00,  elapsed time  84
INFO   step:    78,    loss: 1.2421e+02,   Y0: 2.5057e+00,  elapsed time  85
INFO   step:    79,    loss: 1.2420e+02,   Y0: 2.5059e+00,  elapsed time  85
INFO   step:    80,    loss: 1.2418e+02,   Y0: 2.5066e+00,  elapsed time  86
INFO   step:    81,    loss: 1.2417e+02,   Y0: 2.5084e+00,  elapsed time  87
INFO   step:    82,    loss: 1.2415e+02,   Y0: 2.5099e+00,  elapsed time  88
INFO   step:    83,    loss: 1.2414e+02,   Y0: 2.5108e+00,  elapsed time  89
INFO   step:    84,    loss: 1.2412e+02,   Y0: 2.5114e+00,  elapsed time  90
INFO   step:    85,    loss: 1.2410e+02,   Y0: 2.5122e+00,  elapsed time  91
INFO   step:    86,    loss: 1.2409e+02,   Y0: 2.5133e+00,  elapsed time  92
INFO   step:    87,    loss: 1.2407e+02,   Y0: 2.5143e+00,  elapsed time  93
INFO   step:    88,    loss: 1.2406e+02,   Y0: 2.5155e+00,  elapsed time  94
INFO   step:    89,    loss: 1.2404e+02,   Y0: 2.5159e+00,  elapsed time  95
INFO   step:    90,    loss: 1.2403e+02,   Y0: 2.5170e+00,  elapsed time  96
INFO   step:    91,    loss: 1.2401e+02,   Y0: 2.5179e+00,  elapsed time  97
INFO   step:    92,    loss: 1.2399e+02,   Y0: 2.5180e+00,  elapsed time  98
INFO   step:    93,    loss: 1.2398e+02,   Y0: 2.5182e+00,  elapsed time  99
INFO   step:    94,    loss: 1.2397e+02,   Y0: 2.5187e+00,  elapsed time 100
INFO   step:    95,    loss: 1.2395e+02,   Y0: 2.5191e+00,  elapsed time 100
INFO   step:    96,    loss: 1.2394e+02,   Y0: 2.5200e+00,  elapsed time 101
INFO   step:    97,    loss: 1.2392e+02,   Y0: 2.5201e+00,  elapsed time 102
INFO   step:    98,    loss: 1.2391e+02,   Y0: 2.5209e+00,  elapsed time 103
INFO   step:    99,    loss: 1.2389e+02,   Y0: 2.5211e+00,  elapsed time 104
INFO   step:   100,    loss: 1.2388e+02,   Y0: 2.5210e+00,  elapsed time 105
INFO   step:   101,    loss: 1.2387e+02,   Y0: 2.5207e+00,  elapsed time 106
INFO   step:   102,    loss: 1.2385e+02,   Y0: 2.5206e+00,  elapsed time 107
INFO   step:   103,    loss: 1.2384e+02,   Y0: 2.5215e+00,  elapsed time 108
INFO   step:   104,    loss: 1.2382e+02,   Y0: 2.5222e+00,  elapsed time 109
INFO   step:   105,    loss: 1.2381e+02,   Y0: 2.5226e+00,  elapsed time 110
INFO   step:   106,    loss: 1.2379e+02,   Y0: 2.5213e+00,  elapsed time 111
INFO   step:   107,    loss: 1.2378e+02,   Y0: 2.5199e+00,  elapsed time 112
INFO   step:   108,    loss: 1.2377e+02,   Y0: 2.5191e+00,  elapsed time 113
INFO   step:   109,    loss: 1.2375e+02,   Y0: 2.5189e+00,  elapsed time 114
INFO   step:   110,    loss: 1.2374e+02,   Y0: 2.5188e+00,  elapsed time 115
INFO   step:   111,    loss: 1.2372e+02,   Y0: 2.5189e+00,  elapsed time 115
INFO   step:   112,    loss: 1.2371e+02,   Y0: 2.5184e+00,  elapsed time 116
INFO   step:   113,    loss: 1.2369e+02,   Y0: 2.5179e+00,  elapsed time 117
INFO   step:   114,    loss: 1.2367e+02,   Y0: 2.5176e+00,  elapsed time 118
INFO   step:   115,    loss: 1.2366e+02,   Y0: 2.5169e+00,  elapsed time 119
INFO   step:   116,    loss: 1.2364e+02,   Y0: 2.5160e+00,  elapsed time 120
INFO   step:   117,    loss: 1.2363e+02,   Y0: 2.5155e+00,  elapsed time 121
INFO   step:   118,    loss: 1.2361e+02,   Y0: 2.5151e+00,  elapsed time 122
INFO   step:   119,    loss: 1.2359e+02,   Y0: 2.5142e+00,  elapsed time 123
INFO   step:   120,    loss: 1.2357e+02,   Y0: 2.5132e+00,  elapsed time 124
INFO   step:   121,    loss: 1.2356e+02,   Y0: 2.5117e+00,  elapsed time 125
INFO   step:   122,    loss: 1.2354e+02,   Y0: 2.5104e+00,  elapsed time 126
INFO   step:   123,    loss: 1.2352e+02,   Y0: 2.5095e+00,  elapsed time 127
INFO   step:   124,    loss: 1.2350e+02,   Y0: 2.5089e+00,  elapsed time 128
INFO   step:   125,    loss: 1.2349e+02,   Y0: 2.5085e+00,  elapsed time 129
INFO   step:   126,    loss: 1.2347e+02,   Y0: 2.5078e+00,  elapsed time 129
INFO   step:   127,    loss: 1.2345e+02,   Y0: 2.5078e+00,  elapsed time 130
INFO   step:   128,    loss: 1.2343e+02,   Y0: 2.5077e+00,  elapsed time 131
INFO   step:   129,    loss: 1.2341e+02,   Y0: 2.5077e+00,  elapsed time 132
INFO   step:   130,    loss: 1.2340e+02,   Y0: 2.5076e+00,  elapsed time 133
INFO   step:   131,    loss: 1.2338e+02,   Y0: 2.5080e+00,  elapsed time 134
INFO   step:   132,    loss: 1.2336e+02,   Y0: 2.5088e+00,  elapsed time 135
INFO   step:   133,    loss: 1.2334e+02,   Y0: 2.5090e+00,  elapsed time 136
INFO   step:   134,    loss: 1.2333e+02,   Y0: 2.5091e+00,  elapsed time 137
INFO   step:   135,    loss: 1.2331e+02,   Y0: 2.5086e+00,  elapsed time 138
INFO   step:   136,    loss: 1.2329e+02,   Y0: 2.5077e+00,  elapsed time 139
INFO   step:   137,    loss: 1.2328e+02,   Y0: 2.5070e+00,  elapsed time 140
INFO   step:   138,    loss: 1.2326e+02,   Y0: 2.5056e+00,  elapsed time 141
INFO   step:   139,    loss: 1.2324e+02,   Y0: 2.5038e+00,  elapsed time 142
INFO   step:   140,    loss: 1.2322e+02,   Y0: 2.5019e+00,  elapsed time 143
INFO   step:   141,    loss: 1.2321e+02,   Y0: 2.5000e+00,  elapsed time 143
INFO   step:   142,    loss: 1.2319e+02,   Y0: 2.4975e+00,  elapsed time 144
INFO   step:   143,    loss: 1.2317e+02,   Y0: 2.4956e+00,  elapsed time 145
INFO   step:   144,    loss: 1.2315e+02,   Y0: 2.4946e+00,  elapsed time 146
INFO   step:   145,    loss: 1.2313e+02,   Y0: 2.4942e+00,  elapsed time 147
INFO   step:   146,    loss: 1.2312e+02,   Y0: 2.4937e+00,  elapsed time 148
INFO   step:   147,    loss: 1.2310e+02,   Y0: 2.4934e+00,  elapsed time 149
INFO   step:   148,    loss: 1.2308e+02,   Y0: 2.4930e+00,  elapsed time 150
INFO   step:   149,    loss: 1.2306e+02,   Y0: 2.4927e+00,  elapsed time 151
Delta:  100 ,  100.05
Other1:  -10.05 ,  -10
Other2:  -10.05 ,  -10
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 3) dtype=float64>]
num_iterations:  150
total time intervals:  10
# of dimensions:  3
Loss out:  121.10475692674243
Output_Z_Vals:  [[[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
  [ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
  [ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
  ...
  [ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
  [ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
  [ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]]

 [[-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
  [-4.84601185e-02  3.42132938e-02 -8.04134779e-02]
  [ 2.97881448e-02 -7.26024813e-02  1.45162437e-01]
  ...
  [ 1.04099033e-01 -6.88363491e-05 -6.09781451e-02]
  [-4.77520730e-02  3.60064206e-02 -8.50562267e-02]
  [ 2.08139217e-02  2.23299312e-02 -8.05289474e-02]]

 [[-2.63706212e-01  4.18555802e-02 -9.72197857e-02]
  [ 2.36646749e-02  8.04013222e-02  4.41785617e-02]
  [-7.22728584e-02  9.27922146e-02  2.34450018e-02]
  ...
  [-3.16054371e-01 -7.08154448e-03 -9.96407656e-02]
  [-2.61911566e-01  1.30663375e-02 -8.01932528e-02]
  [-3.22637301e-01 -3.03079017e-02 -1.38712464e-01]]

 ...

 [[ 9.73584947e-02 -3.77710573e-02  8.69172195e-02]
  [ 8.11502910e-02 -1.68014549e-02  6.65549059e-02]
  [ 1.38650222e-01 -3.00680975e-02 -3.94180168e-01]
  ...
  [ 1.30813629e-01 -1.52223381e-02 -2.78139115e-02]
  [ 2.54699387e-02  1.38493203e-01 -5.52152366e-02]
  [ 7.84402450e-02  6.31471031e-02 -4.85249352e-02]]

 [[ 1.24037989e-01  5.10940155e-02 -3.85689800e-02]
  [ 1.01360521e-01  2.61914032e-02  9.35149323e-03]
  [ 4.48728548e-01  2.89100443e-01 -3.21851415e-01]
  ...
  [ 1.54761628e-01  7.96354007e-02 -8.63957001e-02]
  [ 2.66290654e-01  1.59317621e-01 -1.81303251e-01]
  [ 2.73235721e-01  1.56909994e-01 -1.62969485e-01]]

 [[-9.93138239e-02 -7.68820715e-02  1.19847332e-02]
  [-9.82996820e-02 -7.72108715e-02  1.08999836e-02]
  [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]
  ...
  [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]
  [-8.67164318e-02 -8.09663344e-02 -1.48972662e-03]
  [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]]
Z_Vals dimensionality:  (10, 200, 3)
X_test:  [[[ 1.00000000e+02  9.98333964e+01  9.51196482e+01 ...  1.00466085e+02
    9.87498928e+01  9.90395845e+01]
  [-1.00000000e+00 -3.88172228e-01 -4.84541577e-01 ... -4.42687828e-01
   -4.02866926e-01 -4.22686357e-01]
  [-1.00000000e+00 -1.04737529e+00 -1.05362944e+00 ... -1.18029439e+00
   -1.20272626e+00 -1.19879162e+00]]

 [[ 1.00000000e+02  9.93500838e+01  9.92361114e+01 ...  9.74954219e+01
    9.86237046e+01  9.66239741e+01]
  [-1.00000000e+00 -1.27291990e+00 -9.23476512e-01 ... -2.13515520e-01
    5.52999548e-02  2.65098702e-02]
  [-1.00000000e+00 -1.05488284e+00 -1.08536801e+00 ... -1.13564391e+00
   -1.12087955e+00 -1.07184028e+00]]

 [[ 1.00000000e+02  9.84325451e+01  9.99298038e+01 ...  1.09750779e+02
    1.08656629e+02  1.07487935e+02]
  [-1.00000000e+00 -1.09620060e+00 -8.54363092e-01 ... -3.77101559e-01
   -6.04579860e-01 -6.27928743e-01]
  [-1.00000000e+00 -9.44489187e-01 -9.55510988e-01 ... -8.96577456e-01
   -8.58869206e-01 -8.47771799e-01]]

 ...

 [[ 1.00000000e+02  1.02306382e+02  1.01547264e+02 ...  9.99120304e+01
    1.11609572e+02  1.02802446e+02]
  [-1.00000000e+00 -1.24558302e+00 -5.98751188e-01 ...  2.76557444e-01
    1.37504883e-01 -2.08626612e-01]
  [-1.00000000e+00 -9.70261188e-01 -9.66646311e-01 ... -8.87360298e-01
   -9.42563221e-01 -8.99935234e-01]]

 [[ 1.00000000e+02  9.94970949e+01  1.01296523e+02 ...  1.03471185e+02
    1.04156225e+02  1.05301280e+02]
  [-1.00000000e+00 -1.31047407e+00 -1.22862019e+00 ... -5.07672882e-02
   -2.51718091e-01 -4.83852510e-01]
  [-1.00000000e+00 -1.04049627e+00 -1.07284674e+00 ... -1.15887785e+00
   -1.13215630e+00 -1.14972297e+00]]

 [[ 1.00000000e+02  1.01362020e+02  1.01802184e+02 ...  1.04621560e+02
    1.09056707e+02  1.08944214e+02]
  [-1.00000000e+00 -8.53053291e-01 -6.89854374e-01 ... -5.29099849e-01
   -1.80619899e-01 -2.70613947e-01]
  [-1.00000000e+00 -9.92481734e-01 -9.92877289e-01 ... -1.00256207e+00
   -1.00821119e+00 -9.90987572e-01]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-2.63706212e-01  4.18555802e-02 -9.72197857e-02]
 [-9.17078291e-03 -2.30449568e-02 -7.24626881e-02]
 [-2.32909755e-01 -4.21956237e-02 -1.48065356e-01]
 [-1.96466773e-01  3.12733436e-01  4.99420265e-01]
 [ 7.96538341e-02  1.33172416e-01 -2.58701840e-03]
 [ 9.73584947e-02 -3.77710573e-02  8.69172195e-02]
 [ 1.24037989e-01  5.10940155e-02 -3.85689800e-02]
 [-9.93138239e-02 -7.68820715e-02  1.19847332e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.93909932]
curr_Stock_Price:  99.83339643990819
curr_Factors:  [99.83339644 -0.38817223 -1.04737529]
mat_Sqrt:  [[23.75885354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259829  0.01250945 -0.27262553]
Stock Position:  -0.0025982946937354334
Bond Position:  [1.19849591]


portfolio before change:  [0.95194643]
curr_Stock_Price:  95.11964822224954
curr_Factors:  [95.11964822 -0.48454158 -1.05362944]
mat_Sqrt:  [[20.42918542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01382681  0.0132359  -0.27734099]
Stock Position:  -0.013826807339267003
Bond Position:  [2.26714748]


portfolio before change:  [0.9752454]
curr_Stock_Price:  93.51659431487853
curr_Factors:  [93.51659431 -0.85554674 -1.01988307]
mat_Sqrt:  [[14.33507156  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00171308 -0.00728746 -0.20671588]
Stock Position:  -0.001713084256327927
Bond Position:  [1.13544721]


portfolio before change:  [0.97882269]
curr_Stock_Price:  91.75986717957797
curr_Factors:  [91.75986718 -0.56926131 -1.05240093]
mat_Sqrt:  [[18.12899861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0145746  -0.01334343 -0.42238925]
Stock Position:  -0.01457460288978821
Bond Position:  [2.31618631]


portfolio before change:  [0.99468257]
curr_Stock_Price:  90.75116085761874
curr_Factors:  [ 9.07511609e+01 -8.76885113e-02 -1.08154083e+00]
mat_Sqrt:  [[28.1878751   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306686  0.098895    1.42470701]
Stock Position:  -0.0030668610443065885
Bond Position:  [1.27300377]


portfolio before change:  [0.97766053]
curr_Stock_Price:  96.50906706240838
curr_Factors:  [96.50906706 -0.45134151 -1.09846007]
mat_Sqrt:  [[20.4879186   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0040299   0.04211282 -0.00738004]
Stock Position:  0.004029899752860525
Bond Position:  [0.58873866]


portfolio before change:  [0.98757427]
curr_Stock_Price:  98.8960493847513
curr_Factors:  [98.89604938 -0.27228358 -1.09897732]
mat_Sqrt:  [[25.09850777  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00454709 -0.01194426  0.24795063]
Stock Position:  0.004547089188852156
Bond Position:  [0.53788511]


portfolio before change:  [0.99498237]
curr_Stock_Price:  100.46608495129226
curr_Factors:  [100.46608495  -0.44268783  -1.18029439]
mat_Sqrt:  [[19.82290298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0059267   0.01615735 -0.11002656]
Stock Position:  0.005926698583742395
Bond Position:  [0.39955017]


portfolio before change:  [0.98501084]
curr_Stock_Price:  98.7498927852762
curr_Factors:  [98.74989279 -0.40286693 -1.20272626]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.98501084]
Stock Price:  99.03958449660783
PL:  [0.98501084]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.84601185e-02  3.42132938e-02 -8.04134779e-02]
 [ 2.36646749e-02  8.04013222e-02  4.41785617e-02]
 [-9.98436573e-02  3.40363386e-02 -6.25153090e-02]
 [ 1.69544489e-02 -4.29097422e-02 -2.67350995e-01]
 [ 6.90328479e-02 -1.14390283e-01 -1.70763494e-01]
 [ 7.75057874e-02  1.24374171e-01 -9.17856008e-03]
 [ 8.11502910e-02 -1.68014549e-02  6.65549059e-02]
 [ 1.01360521e-01  2.61914032e-02  9.35149323e-03]
 [-9.82996820e-02 -7.72108715e-02  1.08999836e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.52978254]
curr_Stock_Price:  99.35008377421184
curr_Factors:  [99.35008377 -1.2729199  -1.05488284]
mat_Sqrt:  [[ 9.68760343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00660546  0.01081919 -0.22939727]
Stock Position:  -0.0066054590196579195
Bond Position:  [-1.87352963]


portfolio before change:  [-2.5299667]
curr_Stock_Price:  99.2361114330677
curr_Factors:  [99.23611143 -0.92347651 -1.08536801]
mat_Sqrt:  [[13.31188781  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00261109 0.02542513 0.12602914]
Stock Position:  0.002611090157041332
Bond Position:  [-2.78908113]


portfolio before change:  [-2.52809724]
curr_Stock_Price:  100.48629775872473
curr_Factors:  [100.48629776  -1.08154697  -1.03826766]
mat_Sqrt:  [[12.06377007  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00926126  0.01076324 -0.17833878]
Stock Position:  -0.009261261299346337
Bond Position:  [-1.59746738]


portfolio before change:  [-2.52523039]
curr_Stock_Price:  100.09047838702716
curr_Factors:  [100.09047839  -0.78098551  -1.08978814]
mat_Sqrt:  [[15.41438102  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00251235 -0.01356925 -0.76267797]
Stock Position:  -0.002512346697742475
Bond Position:  [-2.27376841]


portfolio before change:  [-2.52314827]
curr_Stock_Price:  98.80909194579608
curr_Factors:  [98.80909195 -0.80016775 -1.09547338]
mat_Sqrt:  [[14.84329873  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210346 -0.03617338 -0.48714072]
Stock Position:  0.0021034644483202093
Bond Position:  [-2.73098968]


portfolio before change:  [-2.52620494]
curr_Stock_Price:  98.0052601766109
curr_Factors:  [98.00526018 -0.54237963 -1.12353347]
mat_Sqrt:  [[18.52475697  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00425612  0.03933057 -0.02618388]
Stock Position:  0.00425611786099632
Bond Position:  [-2.94332688]


portfolio before change:  [-2.52210622]
curr_Stock_Price:  99.31414139085642
curr_Factors:  [99.31414139 -0.40145796 -1.12089307]
mat_Sqrt:  [[21.67017609  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00435169 -0.00531309  0.18986262]
Stock Position:  0.0043516924909449035
Bond Position:  [-2.95429082]


portfolio before change:  [-2.53149824]
curr_Stock_Price:  97.49542194062904
curr_Factors:  [97.49542194 -0.21351552 -1.13564391]
mat_Sqrt:  [[25.29599273  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00410917 0.00828245 0.02667721]
Stock Position:  0.0041091744119150925
Bond Position:  [-2.93212393]


portfolio before change:  [-2.52832836]
curr_Stock_Price:  98.62370455861176
curr_Factors:  [ 9.86237046e+01  5.52999548e-02 -1.12087955e+00]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.52832836]
Stock Price:  96.62397413473145
PL:  [-2.52832836]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 2.97881448e-02 -7.26024813e-02  1.45162437e-01]
 [-7.22728584e-02  9.27922146e-02  2.34450018e-02]
 [-8.33658539e-02  3.76716823e-03 -5.02875902e-02]
 [ 2.19132148e-01  1.03062828e-02 -1.30576883e-01]
 [ 4.79557210e-02 -1.05479221e-01 -1.28252566e-01]
 [-2.42865312e-01 -1.67369087e-01  1.34913714e-01]
 [ 1.38650222e-01 -3.00680975e-02 -3.94180168e-01]
 [ 4.48728548e-01  2.89100443e-01 -3.21851415e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.1152362]
curr_Stock_Price:  98.43254513026208
curr_Factors:  [98.43254513 -1.0962006  -0.94448919]
mat_Sqrt:  [[12.7902314   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00449911 -0.02295892  0.41410803]
Stock Position:  0.004499114467130014
Bond Position:  [-9.55809549]


portfolio before change:  [-9.1132801]
curr_Stock_Price:  99.92980375889424
curr_Factors:  [99.92980376 -0.85436309 -0.95551099]
mat_Sqrt:  [[16.35598519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00397966  0.02934347  0.06688206]
Stock Position:  -0.0039796613913943854
Bond Position:  [-8.71559332]


portfolio before change:  [-9.11552104]
curr_Stock_Price:  99.39761070130064
curr_Factors:  [99.3976107  -0.59474598 -0.93735692]
mat_Sqrt:  [[21.47791459  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435487  0.00119128 -0.1434565 ]
Stock Position:  -0.004354868671858578
Bond Position:  [-8.6826575]


portfolio before change:  [-9.14421594]
curr_Stock_Price:  104.98962518059892
curr_Factors:  [104.98962518  -0.69292632  -0.9351747 ]
mat_Sqrt:  [[20.60967272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00935213  0.00325913 -0.3724995 ]
Stock Position:  0.009352131071521733
Bond Position:  [-10.12609268]


portfolio before change:  [-9.11680653]
curr_Stock_Price:  108.46195942734093
curr_Factors:  [108.46195943  -0.47694982  -0.9575766 ]
mat_Sqrt:  [[25.83869286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00073738 -0.03335546 -0.36586887]
Stock Position:  0.000737375298139289
Bond Position:  [-9.1967837]


portfolio before change:  [-9.12086373]
curr_Stock_Price:  109.19746184202715
curr_Factors:  [109.19746184  -0.31696678  -0.91757288]
mat_Sqrt:  [[31.77304088  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00691302 -0.05292675  0.38487127]
Stock Position:  -0.006913018403510202
Bond Position:  [-8.36597967]


portfolio before change:  [-9.11168701]
curr_Stock_Price:  107.26476723866126
curr_Factors:  [107.26476724  -0.37326121  -0.89411627]
mat_Sqrt:  [[30.20244126  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00190091 -0.00950837 -1.1244863 ]
Stock Position:  0.0019009118050551442
Bond Position:  [-9.31558788]


portfolio before change:  [-9.11162028]
curr_Stock_Price:  109.75077921723883
curr_Factors:  [109.75077922  -0.37710156  -0.89657746]
mat_Sqrt:  [[30.70830491  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01271628  0.09142159 -0.9181525 ]
Stock Position:  0.012716281324549243
Bond Position:  [-10.50724207]


portfolio before change:  [-9.13078874]
curr_Stock_Price:  108.65662909767333
curr_Factors:  [108.6566291   -0.60457986  -0.85886921]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.13078874]
Stock Price:  107.48793456561322
PL:  [-16.6187233]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-1.48149841e-01  9.23475634e-02  1.83534497e-03]
 [-8.49951681e-02  6.76016363e-03 -5.14966589e-02]
 [ 9.01040685e-02 -4.27352610e-02 -3.08129725e-01]
 [ 6.89740665e-02 -1.14814786e-01 -1.70571909e-01]
 [ 6.45527287e-02  7.13193717e-02 -4.89265926e-02]
 [ 2.75779792e-01 -2.76115147e-01  3.30790559e-01]
 [ 1.14810637e-01  1.15348153e-01  2.50885531e-02]
 [-1.56803403e-01 -2.58423593e-01  3.96810885e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.13540319]
curr_Stock_Price:  100.41805942068996
curr_Factors:  [100.41805942  -0.86780964  -0.97581548]
mat_Sqrt:  [[15.89042856  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00388489  0.01250945 -0.27262553]
Stock Position:  -0.003884885975404959
Bond Position:  [5.5255159]


portfolio before change:  [5.13992229]
curr_Stock_Price:  99.96614335476366
curr_Factors:  [99.96614335 -0.42683113 -0.95946467]
mat_Sqrt:  [[24.99149974  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00581761  0.02920286  0.00523573]
Stock Position:  -0.0058176100021700965
Bond Position:  [5.72148632]


portfolio before change:  [5.14517185]
curr_Stock_Price:  99.5556477169803
curr_Factors:  [99.55564772 -0.52428178 -0.91153378]
mat_Sqrt:  [[23.68640366  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00402477  0.00213775 -0.14690563]
Stock Position:  -0.004024770256368592
Bond Position:  [5.54586046]


portfolio before change:  [5.16099518]
curr_Stock_Price:  96.31329775163654
curr_Factors:  [96.31329775 -0.37544422 -0.91936195]
mat_Sqrt:  [[26.38512021  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00098934 -0.01351408 -0.87900834]
Stock Position:  0.0009893429271864943
Bond Position:  [5.0657083]


portfolio before change:  [5.1658864]
curr_Stock_Price:  98.69642541174946
curr_Factors:  [98.69642541 -0.75226813 -0.96235602]
mat_Sqrt:  [[17.76845306  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00175545 -0.03630762 -0.48659418]
Stock Position:  0.0017554548068313268
Bond Position:  [4.99262929]


portfolio before change:  [5.16844996]
curr_Stock_Price:  98.73437686062208
curr_Factors:  [ 9.87343769e+01 -8.37282821e-02 -9.45961450e-01]
mat_Sqrt:  [[35.25979808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00159976  0.02255317 -0.13957395]
Stock Position:  0.0015997564103040816
Bond Position:  [5.01049901]


portfolio before change:  [5.16108593]
curr_Stock_Price:  92.56474664297117
curr_Factors:  [92.56474664  0.42754186 -0.97099527]
mat_Sqrt:  [[53.75598222  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00625368 -0.08731528  0.94365339]
Stock Position:  0.006253682956140932
Bond Position:  [4.58221536]


portfolio before change:  [5.15756048]
curr_Stock_Price:  91.63455389173079
curr_Factors:  [91.63455389  0.14433479 -0.95084352]
mat_Sqrt:  [[40.90693851  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00300463 0.03647629 0.07157066]
Stock Position:  0.003004627024203874
Bond Position:  [4.88223283]


portfolio before change:  [5.14305996]
curr_Stock_Price:  85.99583498080666
curr_Factors:  [ 8.59958350e+01  3.92945848e-02 -9.83143107e-01]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.14305996]
Stock Price:  91.16589016113397
PL:  [5.14305996]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-9.26133932e-02  8.40872418e-02  2.23217797e-02]
 [-1.10504663e-01  5.36202463e-02 -7.04265440e-02]
 [ 9.72802133e-02 -3.75314309e-02 -3.08036074e-01]
 [ 6.86807133e-02 -1.16933301e-01 -1.69615789e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 1.30388710e-01 -4.06987523e-02  1.29926139e-01]
 [ 7.34991156e-02  1.39182119e-02  7.95191902e-03]
 [-9.07392007e-02 -7.96620925e-02  2.81311935e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.06219612]
curr_Stock_Price:  100.68651578881527
curr_Factors:  [100.68651579  -1.22371225  -1.00772975]
mat_Sqrt:  [[10.81106223  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00571012  0.01250945 -0.27262553]
Stock Position:  -0.005710123738038128
Bond Position:  [7.63712859]


portfolio before change:  [7.0677162]
curr_Stock_Price:  100.38870205544234
curr_Factors:  [100.38870206  -1.30396323  -1.01340094]
mat_Sqrt:  [[ 9.891596    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00868271  0.02659072  0.06367782]
Stock Position:  -0.008682709626633258
Bond Position:  [7.93936214]


portfolio before change:  [7.0611604]
curr_Stock_Price:  101.60105073084846
curr_Factors:  [101.60105073  -0.99061239  -1.04953099]
mat_Sqrt:  [[13.2091596   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00934927  0.01695621 -0.20090733]
Stock Position:  -0.009349266391843077
Bond Position:  [8.01105569]


portfolio before change:  [7.05994408]
curr_Stock_Price:  102.1596877894535
curr_Factors:  [102.15968779  -1.12279261  -1.08254635]
mat_Sqrt:  [[11.25934206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00296941 -0.01186848 -0.87874118]
Stock Position:  0.0029694057967884877
Bond Position:  [6.75659051]


portfolio before change:  [7.06133989]
curr_Stock_Price:  101.491765523925
curr_Factors:  [101.49176552  -1.29595163  -1.06154146]
mat_Sqrt:  [[ 9.60692869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00323088 -0.03697756 -0.48386663]
Stock Position:  0.00323087967184097
Bond Position:  [6.73343221]


portfolio before change:  [7.06093892]
curr_Stock_Price:  100.3253575318011
curr_Factors:  [100.32535753  -0.61229639  -1.03749682]
mat_Sqrt:  [[19.27146052  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00122736 -0.00193948 -0.30510753]
Stock Position:  0.001227359266534803
Bond Position:  [6.93780366]


portfolio before change:  [7.06209994]
curr_Stock_Price:  98.44428468500246
curr_Factors:  [98.44428469  0.19971565 -1.03491202]
mat_Sqrt:  [[42.70407637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00364974 -0.01287008  0.37064311]
Stock Position:  0.003649743728496752
Bond Position:  [6.70280353]


portfolio before change:  [7.06846625]
curr_Stock_Price:  99.27011654635115
curr_Factors:  [99.27011655 -0.1694871  -1.03003312]
mat_Sqrt:  [[29.91393347  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00252329 0.00440133 0.02268461]
Stock Position:  0.0025232944037610824
Bond Position:  [6.81797852]


portfolio before change:  [7.07980731]
curr_Stock_Price:  102.41331317396433
curr_Factors:  [102.41331317  -0.3653099   -1.0687085 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.07980731]
Stock Price:  103.35895103901481
PL:  [3.72085627]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-5.35636294e-03  8.87803103e-02  4.02623626e-02]
 [-1.00900056e-01  3.59769065e-02 -6.32992327e-02]
 [-7.16296849e-03 -7.53303022e-02 -4.54720405e-01]
 [ 6.87203323e-02 -1.16647184e-01 -1.69744918e-01]
 [ 7.19421850e-02  1.01586055e-01 -2.62511491e-02]
 [ 2.94761878e-02 -6.26870845e-03 -5.04097297e-04]
 [ 9.02425410e-02  2.12938362e-02  8.79299885e-03]
 [-1.07063032e-01 -1.08964179e-01  1.35755993e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.37178041]
curr_Stock_Price:  100.72964957391063
curr_Factors:  [100.72964957  -1.02192949  -1.04625915]
mat_Sqrt:  [[12.73369395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00484797  0.01250945 -0.27262553]
Stock Position:  -0.004847965036856253
Bond Position:  [7.86011422]


portfolio before change:  [7.38071797]
curr_Stock_Price:  99.69694276985524
curr_Factors:  [99.69694277 -1.08395302 -0.98354226]
mat_Sqrt:  [[12.6118864   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0004087  0.0280748  0.11485731]
Stock Position:  0.000408698192356743
Bond Position:  [7.33997201]


portfolio before change:  [7.38503212]
curr_Stock_Price:  101.27083368939076
curr_Factors:  [101.27083369  -1.75007014  -1.010664  ]
mat_Sqrt:  [[ 6.40490631  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01762587  0.0113769  -0.18057509]
Stock Position:  -0.017625868705718264
Bond Position:  [9.17001854]


portfolio before change:  [7.40217278]
curr_Stock_Price:  100.55855686081051
curr_Factors:  [100.55855686  -1.35048925  -1.05487875]
mat_Sqrt:  [[ 9.07362828  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01123337 -0.02382153 -1.29719075]
Stock Position:  -0.011233367664308871
Bond Position:  [8.53178402]


portfolio before change:  [7.41778832]
curr_Stock_Price:  99.54830037667354
curr_Factors:  [99.54830038 -1.05102897 -1.10313265]
mat_Sqrt:  [[11.5476429   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00268968 -0.03688708 -0.484235  ]
Stock Position:  0.0026896812576327023
Bond Position:  [7.15003512]


portfolio before change:  [7.41858347]
curr_Stock_Price:  98.51443905483197
curr_Factors:  [98.51443905 -1.27461516 -1.12044399]
mat_Sqrt:  [[ 8.98129405  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00770564  0.03212433 -0.07488722]
Stock Position:  0.007705641518006731
Bond Position:  [6.65946652]


portfolio before change:  [7.42175518]
curr_Stock_Price:  98.49382315097702
curr_Factors:  [98.49382315 -1.40186983 -1.09801457]
mat_Sqrt:  [[ 8.0858      0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00361268 -0.00198234 -0.00143805]
Stock Position:  0.0036126829801615707
Bond Position:  [7.06592822]


portfolio before change:  [7.42547189]
curr_Stock_Price:  98.54444063762503
curr_Factors:  [98.54444064 -1.58355519 -1.07847947]
mat_Sqrt:  [[ 6.87899767  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0134594  0.0067337  0.02508398]
Stock Position:  0.013459404010661225
Bond Position:  [6.09912245]


portfolio before change:  [7.42908314]
curr_Stock_Price:  98.58611590410395
curr_Factors:  [98.5861159  -1.59631487 -1.04747621]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.42908314]
Stock Price:  98.18186617187727
PL:  [7.42908314]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-1.67645864e-01  7.92927099e-02 -1.88592491e-03]
 [-1.12786215e-01  5.78113817e-02 -7.21196206e-02]
 [ 1.04429104e-01  2.07707607e-02  4.08270688e-03]
 [ 6.33488973e-02 -1.25385779e-01 -1.57121916e-01]
 [-1.52178725e-01 -9.41840992e-02  9.54477677e-02]
 [ 1.92569455e-01 -8.23353273e-02 -5.05008677e-01]
 [ 4.84539993e-01  3.79929401e-01 -3.90809998e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.39327086]
curr_Stock_Price:  100.4539876284796
curr_Factors:  [100.45398763  -1.2661739   -0.966012  ]
mat_Sqrt:  [[10.77807397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0057276   0.01250945 -0.27262553]
Stock Position:  -0.00572760061222679
Bond Position:  [5.96863118]


portfolio before change:  [5.3966265]
curr_Stock_Price:  100.38928677810783
curr_Factors:  [100.38928678  -0.65873085  -0.96031968]
mat_Sqrt:  [[19.88578111  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00834684  0.02507456 -0.00538002]
Stock Position:  -0.008346843228433522
Bond Position:  [6.23456014]


portfolio before change:  [5.38799645]
curr_Stock_Price:  101.79677786749633
curr_Factors:  [101.79677787  -0.37493786  -1.03737563]
mat_Sqrt:  [[24.79556869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00508215  0.01828156 -0.2057372 ]
Stock Position:  -0.0050821535580920455
Bond Position:  [5.90534331]


portfolio before change:  [5.39372516]
curr_Stock_Price:  101.25069144909459
curr_Factors:  [ 1.01250691e+02  1.46959560e-02 -9.40884899e-01]
mat_Sqrt:  [[40.10137377  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00263828 0.00656829 0.01164683]
Stock Position:  0.0026382832279121583
Bond Position:  [5.12659716]


portfolio before change:  [5.40721899]
curr_Stock_Price:  105.39349512441086
curr_Factors:  [105.39349512  -0.58163676  -0.97683043]
mat_Sqrt:  [[22.1809481   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00126411 -0.03965046 -0.44822509]
Stock Position:  0.0012641061820623202
Bond Position:  [5.27399042]


portfolio before change:  [5.41291047]
curr_Stock_Price:  107.80929595753135
curr_Factors:  [107.80929596  -0.35422808  -0.99609744]
mat_Sqrt:  [[27.93941365  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00483644 -0.02978363  0.27228591]
Stock Position:  -0.004836442009254728
Bond Position:  [5.93432388]


portfolio before change:  [5.39533177]
curr_Stock_Price:  112.05758492599269
curr_Factors:  [112.05758493  -0.61832837  -0.99044588]
mat_Sqrt:  [[22.42639553  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00389537 -0.02603672 -1.44064919]
Stock Position:  0.0038953697044233934
Bond Position:  [4.95882605]


portfolio before change:  [5.40357226]
curr_Stock_Price:  113.53638183349146
curr_Factors:  [ 1.13536382e+02 -4.38485875e-02 -1.00130460e+00]
mat_Sqrt:  [[39.92370044  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01038421  0.12014423 -1.11487214]
Stock Position:  0.010384207039916205
Bond Position:  [4.22458697]


portfolio before change:  [5.39123526]
curr_Stock_Price:  112.14486234833025
curr_Factors:  [112.14486235  -0.35371161  -1.05985499]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.39123526]
Stock Price:  107.87271867028208
PL:  [-2.48148341]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 9.21677068e-03 -4.41083603e-02  8.48600111e-02]
 [-1.58263825e-02  8.02115300e-02  3.29527430e-02]
 [-8.95429338e-02  1.51142561e-02 -5.48714291e-02]
 [-3.55142145e-02 -5.65195796e-02 -3.09128602e-01]
 [ 5.22541386e-02 -1.07003889e-01 -1.58797152e-01]
 [ 4.43009832e-02 -1.16303245e-02 -1.11071531e-01]
 [ 7.85933785e-02  6.59203113e-02 -6.81139916e-02]
 [ 1.39881904e-01  6.58437816e-02  1.77711233e-02]
 [-1.09645272e-01 -9.90772686e-02  1.41655487e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.36622242]
curr_Stock_Price:  98.67623186914383
curr_Factors:  [98.67623187 -1.11041822 -1.03141756]
mat_Sqrt:  [[11.58844318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00219183 -0.01394829  0.24208199]
Stock Position:  0.0021918280604130732
Bond Position:  [-7.58250376]


portfolio before change:  [-7.37172903]
curr_Stock_Price:  97.89405139782374
curr_Factors:  [97.8940514  -1.59682753 -1.0432257 ]
mat_Sqrt:  [[ 6.98547192  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00100621  0.02536511  0.094005  ]
Stock Position:  -0.001006213939290687
Bond Position:  [-7.27322667]


portfolio before change:  [-7.37565491]
curr_Stock_Price:  98.18062740700418
curr_Factors:  [98.18062741 -1.16962647 -0.99832903]
mat_Sqrt:  [[11.23297244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00893381  0.00477955 -0.15653291]
Stock Position:  -0.008933812441737252
Bond Position:  [-6.4985276]


portfolio before change:  [-7.3813953]
curr_Stock_Price:  98.4593785632209
curr_Factors:  [98.45937856 -0.76190317 -1.00040921]
mat_Sqrt:  [[16.90030528  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00592144 -0.01787306 -0.88185786]
Stock Position:  -0.00592144068913814
Bond Position:  [-6.79837393]


portfolio before change:  [-7.38732601]
curr_Stock_Price:  98.88675423944579
curr_Factors:  [98.88675424 -0.34269853 -0.95851603]
mat_Sqrt:  [[26.91707214  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00063443 -0.0338376  -0.45300408]
Stock Position:  0.0006344292190255369
Bond Position:  [-7.45006266]


portfolio before change:  [-7.38898671]
curr_Stock_Price:  102.14206383833202
curr_Factors:  [102.14206384  -0.13988737  -0.9742882 ]
mat_Sqrt:  [[33.52156792  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00063626 -0.00367783 -0.31685616]
Stock Position:  0.0006362562823944997
Bond Position:  [-7.45397524]


portfolio before change:  [-7.39336785]
curr_Stock_Price:  101.11540219169443
curr_Factors:  [ 1.01115402e+02 -1.63012124e-02 -9.83747283e-01]
mat_Sqrt:  [[37.19647376  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00178489  0.02084583 -0.19431026]
Stock Position:  0.0017848929365590729
Bond Position:  [-7.57384802]


portfolio before change:  [-7.40888004]
curr_Stock_Price:  94.54676150517945
curr_Factors:  [94.54676151 -0.09799496 -0.96812519]
mat_Sqrt:  [[32.55641369  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00446024 0.02082163 0.05069607]
Stock Position:  0.004460242449291236
Bond Position:  [-7.83058152]


portfolio before change:  [-7.40497201]
curr_Stock_Price:  96.30099343088358
curr_Factors:  [96.30099343 -0.20390437 -0.90093523]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.40497201]
Stock Price:  96.5093898991929
PL:  [-7.40497201]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 4.46895428e-02 -9.27612077e-02  1.87677320e-01]
 [ 1.66465471e-02  7.99025418e-02  4.19469983e-02]
 [-9.28707567e-02  2.12273548e-02 -5.73409137e-02]
 [-3.77557972e-02 -6.46382941e-02 -3.50462027e-01]
 [ 6.87214867e-02 -1.16638847e-01 -1.69748680e-01]
 [ 5.01207352e-02  1.22069620e-02 -9.32129158e-02]
 [ 1.12384460e-01 -1.08493152e-01  1.03844860e-01]
 [ 8.88663212e-02  2.06875995e-02  8.72386659e-03]
 [-9.85597673e-02 -7.71265479e-02  1.11781769e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.46167282]
curr_Stock_Price:  98.24494869439955
curr_Factors:  [98.24494869 -1.2303538  -1.020216  ]
mat_Sqrt:  [[10.34904285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00778854 -0.02933367  0.53539115]
Stock Position:  0.007788539707947494
Bond Position:  [-11.22685751]


portfolio before change:  [-10.45878539]
curr_Stock_Price:  99.3365866760555
curr_Factors:  [99.33658668 -0.98429311 -0.97990123]
mat_Sqrt:  [[13.93382878  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00195725 0.0252674  0.11966311]
Stock Position:  0.001957252200100846
Bond Position:  [-10.65321214]


portfolio before change:  [-10.46712093]
curr_Stock_Price:  97.79994050502864
curr_Factors:  [97.79994051 -1.33535299 -0.98678774]
mat_Sqrt:  [[ 9.59059798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0108468   0.00671268 -0.16357767]
Stock Position:  -0.010846803706988949
Bond Position:  [-9.40630417]


portfolio before change:  [-10.48175407]
curr_Stock_Price:  98.71530843953846
curr_Factors:  [98.71530844 -0.90676517 -1.01864938]
mat_Sqrt:  [[14.39420199  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00770883 -0.02044042 -0.99977061]
Stock Position:  -0.007708833909009289
Bond Position:  [-9.72077416]


portfolio before change:  [-10.49711523]
curr_Stock_Price:  100.07732400483566
curr_Factors:  [100.077324    -0.6674423   -1.00456543]
mat_Sqrt:  [[18.80147643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.001652   -0.03688444 -0.48424574]
Stock Position:  0.0016520021925118492
Bond Position:  [-10.66244319]


portfolio before change:  [-10.50322465]
curr_Stock_Price:  99.60706396253828
curr_Factors:  [99.60706396 -0.65390762 -1.03254825]
mat_Sqrt:  [[18.4447027   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00170287  0.00386018 -0.2659105 ]
Stock Position:  0.0017028689109664882
Bond Position:  [-10.67284243]


portfolio before change:  [-10.51303372]
curr_Stock_Price:  96.9813103514695
curr_Factors:  [96.98131035 -0.64207882 -0.9846416 ]
mat_Sqrt:  [[19.0639262   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0068601  -0.03430855  0.29624048]
Stock Position:  0.006860099048152617
Bond Position:  [-11.17833512]


portfolio before change:  [-10.5056177]
curr_Stock_Price:  98.877287521951
curr_Factors:  [98.87728752 -0.95179264 -0.92853684]
mat_Sqrt:  [[15.0827256   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00604541 0.00654199 0.02488676]
Stock Position:  0.006045407638918754
Bond Position:  [-11.10337121]


portfolio before change:  [-10.50614097]
curr_Stock_Price:  99.7092915234369
curr_Factors:  [99.70929152 -0.91175101 -0.95562169]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.50614097]
Stock Price:  100.88503404462782
PL:  [-11.39117501]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.75643494e-02  3.58588601e-02 -8.47783209e-02]
 [-5.23476407e-02  9.06182268e-02  2.79543571e-02]
 [-8.17980765e-02  8.87213928e-04 -4.91241863e-02]
 [ 8.36937658e-02 -2.07102241e-02 -2.12058474e-01]
 [ 6.17400098e-03 -9.07473592e-02 -1.24594567e-01]
 [ 7.54343387e-02  1.15889665e-01 -1.55350520e-02]
 [ 3.47013364e-02  1.08822652e-01 -1.11630526e-01]
 [ 2.11686193e-01  1.12680523e-01 -1.09753178e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.06186757]
curr_Stock_Price:  99.41527747058487
curr_Factors:  [99.41527747 -0.75828828 -1.01331046]
mat_Sqrt:  [[16.90665023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00378217  0.01133957 -0.24184895]
Stock Position:  -0.0037821673157201036
Bond Position:  [-1.68586236]


portfolio before change:  [-2.06409824]
curr_Stock_Price:  99.7821362943797
curr_Factors:  [99.78213629 -0.84682537 -1.00790755]
mat_Sqrt:  [[15.61537883  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00283706  0.028656    0.079746  ]
Stock Position:  -0.002837057581877862
Bond Position:  [-1.78101057]


portfolio before change:  [-2.06362258]
curr_Stock_Price:  99.30051794730424
curr_Factors:  [99.30051795 -0.55206024 -1.02499759]
mat_Sqrt:  [[20.51370006  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00447518  0.00028056 -0.14013763]
Stock Position:  -0.004475184925428012
Bond Position:  [-1.6192344]


portfolio before change:  [-2.05401502]
curr_Stock_Price:  96.97270592516789
curr_Factors:  [ 9.69727059e+01 -8.59048045e-02 -1.01759765e+00]
mat_Sqrt:  [[32.16655019  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00123957 -0.00654915 -0.6049438 ]
Stock Position:  0.0012395726359952512
Bond Position:  [-2.17421973]


portfolio before change:  [-2.05313303]
curr_Stock_Price:  98.56145297187196
curr_Factors:  [98.56145297 -0.14797013 -1.0394606 ]
mat_Sqrt:  [[30.06162701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071859 -0.02869683 -0.35543362]
Stock Position:  -0.0007185853649416328
Bond Position:  [-1.98230821]


portfolio before change:  [-2.05386709]
curr_Stock_Price:  98.20333398964647
curr_Factors:  [98.20333399 -0.45348998 -0.99322208]
mat_Sqrt:  [[23.11144876  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0032562   0.03664753 -0.04431718]
Stock Position:  0.0032562007907500938
Bond Position:  [-2.37363687]


portfolio before change:  [-2.04365835]
curr_Stock_Price:  101.70307310258893
curr_Factors:  [101.7030731   -0.66035146  -1.00387723]
mat_Sqrt:  [[19.25611792  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00076467  0.03441274 -0.31845082]
Stock Position:  0.0007646733099943467
Bond Position:  [-2.12142798]


portfolio before change:  [-2.04404261]
curr_Stock_Price:  102.5880524531023
curr_Factors:  [102.58805245  -0.52156411  -0.93427587]
mat_Sqrt:  [[23.92398473  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00803346  0.03563271 -0.31309527]
Stock Position:  0.008033457642094356
Bond Position:  [-2.86817939]


portfolio before change:  [-2.0279768]
curr_Stock_Price:  104.76647510203904
curr_Factors:  [104.7664751   -0.79466931  -1.00252089]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.0279768]
Stock Price:  100.04517011680701
PL:  [-2.07314691]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-2.76574343e-01  2.06576658e-02 -6.21454317e-02]
 [-1.03967579e-01  4.16118442e-02 -6.55755565e-02]
 [ 9.36322115e-02 -2.83666964e-02 -2.63983277e-01]
 [ 6.81871775e-02 -1.20497479e-01 -1.68007216e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 8.40928014e-02 -7.95019720e-02  6.80127967e-02]
 [ 8.74864708e-02  2.00797634e-02  8.65455196e-03]
 [-1.01430012e-01 -7.61959717e-02  1.42482564e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.78811952]
curr_Stock_Price:  100.92698539001222
curr_Factors:  [100.92698539  -1.17429158  -0.9639276 ]
mat_Sqrt:  [[11.89571395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00518947  0.01250945 -0.27262553]
Stock Position:  -0.005189474404851939
Bond Position:  [9.31187753]


portfolio before change:  [8.79112567]
curr_Stock_Price:  101.24512090342807
curr_Factors:  [101.2451209   -1.039871    -0.93776963]
mat_Sqrt:  [[14.01185688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02060586  0.00653253 -0.17728362]
Stock Position:  -0.020605859015084924
Bond Position:  [10.87736836]


portfolio before change:  [8.79966774]
curr_Stock_Price:  101.09457995491832
curr_Factors:  [101.09457995  -1.30938313  -0.95943167]
mat_Sqrt:  [[10.45668735  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01112003  0.01315882 -0.18706881]
Stock Position:  -0.011120034149201761
Bond Position:  [9.92384292]


portfolio before change:  [8.79311418]
curr_Stock_Price:  102.13025312644622
curr_Factors:  [102.13025313  -0.98163952  -0.97017963]
mat_Sqrt:  [[14.50407786  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00268989 -0.00897034 -0.75307081]
Stock Position:  0.002689893577489767
Bond Position:  [8.51839467]


portfolio before change:  [8.79802471]
curr_Stock_Price:  102.37200006370418
curr_Factors:  [102.37200006  -1.2595932   -0.98468901]
mat_Sqrt:  [[10.85180072  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00283654 -0.03810465 -0.47927782]
Stock Position:  0.0028365445785705446
Bond Position:  [8.50764197]


portfolio before change:  [8.79733586]
curr_Stock_Price:  100.6291246245098
curr_Factors:  [100.62912462  -0.75343539  -0.93819706]
mat_Sqrt:  [[18.53775156  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00127594 -0.00193948 -0.30510753]
Stock Position:  0.0012759371367802779
Bond Position:  [8.66893942]


portfolio before change:  [8.79777235]
curr_Stock_Price:  97.57328779109909
curr_Factors:  [97.57328779 -0.98339366 -0.95829448]
mat_Sqrt:  [[13.99801619  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00685262 -0.02514073  0.19402158]
Stock Position:  0.0068526226894575475
Bond Position:  [8.12913943]


portfolio before change:  [8.80932179]
curr_Stock_Price:  98.6654028987726
curr_Factors:  [98.6654029  -0.62024057 -0.95658397]
mat_Sqrt:  [[20.38725226  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00440332 0.00634978 0.02468903]
Stock Position:  0.0044033168336771854
Bond Position:  [8.37486676]


portfolio before change:  [8.80979189]
curr_Stock_Price:  97.82095256730028
curr_Factors:  [97.82095257 -0.33567936 -0.92059595]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.80979189]
Stock Price:  98.94107764140041
PL:  [8.80979189]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 2.24860956e-01 -2.44495065e-01  5.38544582e-01]
 [-1.95535567e-01  7.38044813e-02 -2.09517478e-02]
 [-7.61370291e-02 -8.94920003e-03 -4.55207384e-02]
 [-4.27032730e-02 -8.25573938e-02 -4.41690480e-01]
 [ 6.87229580e-02 -1.16628221e-01 -1.69753476e-01]
 [ 4.58933245e-02 -5.10820863e-03 -1.06185238e-01]
 [ 3.61916560e-02  9.32355274e-02 -1.40246476e-01]
 [ 1.52515410e-01  6.41348414e-02 -3.87710686e-02]
 [-8.18059396e-02 -4.70385463e-02  2.84075781e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-21.60422928]
curr_Stock_Price:  96.69247764512168
curr_Factors:  [96.69247765 -1.02161503 -1.05927225]
mat_Sqrt:  [[12.06909837  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02721646 -0.07731613  1.53631779]
Stock Position:  0.027216455014162096
Bond Position:  [-24.23585575]


portfolio before change:  [-21.61083965]
curr_Stock_Price:  96.8949504741129
curr_Factors:  [96.89495047 -1.01240119 -1.03141049]
mat_Sqrt:  [[12.55119304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01576796  0.02333903 -0.0597695 ]
Stock Position:  -0.015767959315256083
Bond Position:  [-20.08300401]


portfolio before change:  [-21.63116233]
curr_Stock_Price:  97.54682098925913
curr_Factors:  [97.54682099 -0.74664197 -1.00610536]
mat_Sqrt:  [[16.90458948  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00506726 -0.00282999 -0.129858  ]
Stock Position:  -0.005067261663816909
Bond Position:  [-21.13686706]


portfolio before change:  [-21.64713281]
curr_Stock_Price:  98.61236804211882
curr_Factors:  [98.61236804 -1.1414196  -0.98346296]
mat_Sqrt:  [[11.778951    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01146066 -0.02610694 -1.26002   ]
Stock Position:  -0.011460662962557268
Bond Position:  [-20.5169697]


portfolio before change:  [-21.6828201]
curr_Stock_Price:  100.8309343738765
curr_Factors:  [100.83093437  -1.14221863  -0.90663256]
mat_Sqrt:  [[12.9953812   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00239015 -0.03688108 -0.48425942]
Stock Position:  0.0023901451322453746
Bond Position:  [-21.92382067]


portfolio before change:  [-21.69525152]
curr_Stock_Price:  100.21726257222406
curr_Factors:  [100.21726257  -1.33468033  -0.94140951]
mat_Sqrt:  [[10.29080331  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00234058 -0.00161536 -0.30291693]
Stock Position:  0.002340581139417504
Bond Position:  [-21.92981815]


portfolio before change:  [-21.70236874]
curr_Stock_Price:  101.86233495128614
curr_Factors:  [101.86233495  -0.75366954  -0.96566369]
mat_Sqrt:  [[18.25226187  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0005463   0.02948366 -0.40008416]
Stock Position:  0.0005463046107261129
Bond Position:  [-21.75801661]


portfolio before change:  [-21.71317538]
curr_Stock_Price:  101.99980070083473
curr_Factors:  [101.9998007   -0.9721735   -0.99202309]
mat_Sqrt:  [[14.30736251  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01022252  0.02028122 -0.11060307]
Stock Position:  0.010222516776086666
Bond Position:  [-22.75587005]


portfolio before change:  [-21.73882619]
curr_Stock_Price:  100.60385902231734
curr_Factors:  [100.60385902  -1.25293341  -0.95951674]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-21.73882619]
Stock Price:  101.76964662238976
PL:  [-23.50847281]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-3.97507593e-02  3.86182473e-02 -9.47462318e-02]
 [-2.99304733e-01  4.49936123e-02 -5.13281103e-02]
 [-1.40822682e-01  1.09313427e-01 -9.29247012e-02]
 [ 3.02782930e-01  9.32965740e-03 -1.62331461e-01]
 [ 4.80218265e-02 -1.05564709e-01 -1.28376544e-01]
 [-1.92360354e-01 -1.08297517e-01  1.16824857e-01]
 [ 1.20578949e-01  1.75886178e-02 -3.02580012e-01]
 [ 3.38743697e-01  1.98021813e-01 -1.99994331e-01]
 [-8.19288808e-02 -8.77916249e-02 -1.80314860e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.29017512]
curr_Stock_Price:  100.99693583548834
curr_Factors:  [100.99693584  -0.62536546  -1.02448513]
mat_Sqrt:  [[19.3993505   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00299462  0.01221216 -0.27028463]
Stock Position:  -0.002994617475157128
Bond Position:  [9.59262231]


portfolio before change:  [9.29560558]
curr_Stock_Price:  100.78557334769356
curr_Factors:  [ 1.00785573e+02  4.46564124e-03 -1.03629958e+00]
mat_Sqrt:  [[35.91522446  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00859302  0.01422823 -0.14642481]
Stock Position:  -0.008593021867570895
Bond Position:  [10.16165822]


portfolio before change:  [9.26617686]
curr_Stock_Price:  104.8017185355348
curr_Factors:  [104.80171854  -0.41040646  -1.08856445]
mat_Sqrt:  [[23.4085014   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00670561  0.03456794 -0.26508831]
Stock Position:  -0.006705614927690648
Bond Position:  [9.96893683]


portfolio before change:  [9.260958]
curr_Stock_Price:  106.32351357454274
curr_Factors:  [106.32351357  -0.41246018  -1.12007173]
mat_Sqrt:  [[22.96461505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01175234  0.0029503  -0.46308647]
Stock Position:  0.011752343733352245
Bond Position:  [8.01140752]


portfolio before change:  [9.28903616]
curr_Stock_Price:  108.37173895204815
curr_Factors:  [108.37173895  -0.75753769  -1.1105334 ]
mat_Sqrt:  [[16.73489825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00114081 -0.03338249 -0.36622255]
Stock Position:  0.001140813933150107
Bond Position:  [9.16540417]


portfolio before change:  [9.29388343]
curr_Stock_Price:  108.60264551265493
curr_Factors:  [108.60264551  -1.3352167   -1.06916705]
mat_Sqrt:  [[ 9.80911462  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01746435 -0.03424668  0.3332688 ]
Stock Position:  -0.017464349841584733
Bond Position:  [11.19055802]


portfolio before change:  [9.283476]
curr_Stock_Price:  109.51903269234718
curr_Factors:  [109.51903269  -1.63757073  -1.0658286 ]
mat_Sqrt:  [[ 7.33530525  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00807999  0.00556201 -0.86317655]
Stock Position:  0.008079990794488514
Bond Position:  [8.39856322]


portfolio before change:  [9.291353]
curr_Stock_Price:  109.97406646408163
curr_Factors:  [109.97406646  -1.47590866  -1.0747536 ]
mat_Sqrt:  [[ 8.58127336  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03531328  0.06262    -0.57052816]
Stock Position:  0.035313281961489064
Bond Position:  [5.40780778]


portfolio before change:  [9.27874829]
curr_Stock_Price:  109.5405386406123
curr_Factors:  [109.54053864  -1.67926351  -1.01138245]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.27874829]
Stock Price:  109.61784938428478
PL:  [-0.3391011]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 8.99685016e-02 -1.45550508e-01  2.96360997e-01]
 [-1.59388950e-01  7.23308389e-02  2.01742132e-03]
 [-7.71376484e-02 -7.41093980e-03 -4.59449275e-02]
 [-2.58976674e-02 -8.67334423e-02 -4.70271045e-01]
 [ 7.45092238e-02 -7.48414185e-02 -1.88612544e-01]
 [ 7.96538341e-02  1.33172416e-01 -2.58701840e-03]
 [ 1.37739666e-01 -1.49646439e-01  1.35381123e-01]
 [ 1.17951108e-01  4.27721643e-02  1.77139548e-02]
 [-1.18590853e-01 -1.28393277e-01  1.25474622e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.91835737]
curr_Stock_Price:  97.76333545780143
curr_Factors:  [97.76333546 -0.83265404 -0.97708945]
mat_Sqrt:  [[16.0034789   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00916706 -0.04602711  0.84543543]
Stock Position:  0.009167059227975253
Bond Position:  [-14.81455965]


portfolio before change:  [-13.90030269]
curr_Stock_Price:  100.54108697898744
curr_Factors:  [100.54108698  -1.00671873  -0.9718657 ]
mat_Sqrt:  [[13.90129548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01130179  0.02287302  0.00575514]
Stock Position:  -0.01130179350846438
Bond Position:  [-12.76400808]


portfolio before change:  [-13.86619676]
curr_Stock_Price:  96.95851172679633
curr_Factors:  [96.95851173 -0.83229685 -1.00800375]
mat_Sqrt:  [[15.3940732   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00563252 -0.00234354 -0.13106809]
Stock Position:  -0.005632522724318008
Bond Position:  [-13.32007574]


portfolio before change:  [-13.87879748]
curr_Stock_Price:  98.01292729098431
curr_Factors:  [98.01292729 -1.12663767 -0.962059  ]
mat_Sqrt:  [[12.1387488   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.010226   -0.02742752 -1.34155239]
Stock Position:  -0.010225995470973701
Bond Position:  [-12.87651773]


portfolio before change:  [-13.87124108]
curr_Stock_Price:  96.64423245324012
curr_Factors:  [96.64423245 -1.45742752 -0.92436033]
mat_Sqrt:  [[ 8.92850241  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00381659 -0.02366693 -0.53805909]
Stock Position:  0.0038165921599155545
Bond Position:  [-14.2400927]


portfolio before change:  [-13.87823912]
curr_Stock_Price:  96.67666803957715
curr_Factors:  [96.67666804 -1.07588437 -0.9511376 ]
mat_Sqrt:  [[12.73494929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00648328  0.04211282 -0.00738004]
Stock Position:  0.006483281262064928
Bond Position:  [-14.50502115]


portfolio before change:  [-13.89191832]
curr_Stock_Price:  95.68567661499534
curr_Factors:  [95.68567661 -0.75366863 -0.94897369]
mat_Sqrt:  [[17.4340694   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00926407 -0.04732236  0.38620466]
Stock Position:  0.009264065899496927
Bond Position:  [-14.77835673]


portfolio before change:  [-13.89641452]
curr_Stock_Price:  95.99815566483426
curr_Factors:  [95.99815566 -1.34288347 -0.87907325]
mat_Sqrt:  [[10.4058928   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01178864 0.01352575 0.05053298]
Stock Position:  0.011788640184147058
Bond Position:  [-15.02810223]


portfolio before change:  [-13.91033962]
curr_Stock_Price:  95.45448171353038
curr_Factors:  [95.45448171 -0.46359085 -0.90472029]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.91033962]
Stock Price:  96.57738460788997
PL:  [-13.91033962]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 2.03641028e-01 -2.68397441e-02 -3.76111128e-02]
 [-4.79689373e-01 -2.09681861e-01 -4.09755014e-01]
 [-1.17012213e-01  6.55743974e-02 -7.52556158e-02]
 [ 8.50437970e-02 -1.65176216e-02 -2.05083157e-01]
 [ 6.82024281e-02 -1.20387343e-01 -1.68056923e-01]
 [ 4.53510848e-02 -7.32918350e-03 -1.07849167e-01]
 [ 2.90478920e-02  8.81363898e-02 -1.47287860e-01]
 [ 2.69519630e-01  1.56380227e-01 -1.66798551e-01]
 [-8.60577938e-02 -8.11798746e-02 -2.19422089e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [26.17979562]
curr_Stock_Price:  103.3501343089509
curr_Factors:  [103.35013431  -0.56347844  -1.05321652]
mat_Sqrt:  [[20.52056646  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00951585 -0.00848747 -0.10729404]
Stock Position:  0.009515852945992737
Bond Position:  [25.19633094]


portfolio before change:  [26.19736664]
curr_Stock_Price:  103.87238877165308
curr_Factors:  [103.87238877  -0.53220784  -1.0985376 ]
mat_Sqrt:  [[20.33650756  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02796666 -0.06630723 -1.168917  ]
Stock Position:  -0.02796666168238201
Bond Position:  [29.10233059]


portfolio before change:  [26.25947443]
curr_Stock_Price:  102.17204317240572
curr_Factors:  [102.17204317  -0.76978018  -1.13083401]
mat_Sqrt:  [[15.27234845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00855668  0.02073645 -0.21468332]
Stock Position:  -0.008556678625103013
Bond Position:  [27.13372777]


portfolio before change:  [26.27842136]
curr_Stock_Price:  101.54368348044058
curr_Factors:  [101.54368348  -0.67356248  -1.11648074]
mat_Sqrt:  [[16.95301786  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00252196 -0.00522333 -0.58504516]
Stock Position:  0.002521963345643548
Bond Position:  [26.02233191]


portfolio before change:  [26.29341066]
curr_Stock_Price:  102.3267589254781
curr_Factors:  [102.32675893  -0.958467    -1.1347843 ]
mat_Sqrt:  [[12.61542054  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00244063 -0.03806982 -0.47941962]
Stock Position:  0.0024406292702623396
Bond Position:  [26.04366898]


portfolio before change:  [26.30700085]
curr_Stock_Price:  102.55829608663191
curr_Factors:  [102.55829609  -0.61903179  -1.19473073]
mat_Sqrt:  [[16.72105758  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138432 -0.00231769 -0.30766365]
Stock Position:  0.0013843159775406813
Bond Position:  [26.16502776]


portfolio before change:  [26.32338165]
curr_Stock_Price:  104.93854349686843
curr_Factors:  [104.9385435   -0.59208456  -1.28341561]
mat_Sqrt:  [[16.08479967  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.82450112e-05  2.78711737e-02 -4.20171267e-01]
Stock Position:  7.824501123115649e-05
Bond Position:  [26.31517073]


portfolio before change:  [26.33653979]
curr_Stock_Price:  104.90357338349716
curr_Factors:  [104.90357338  -0.46557013  -1.32564094]
mat_Sqrt:  [[17.49351966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01369134  0.04945177 -0.47582984]
Stock Position:  0.013691340733444014
Bond Position:  [24.90026922]


portfolio before change:  [26.34028695]
curr_Stock_Price:  104.26769055927889
curr_Factors:  [104.26769056  -0.33727408  -1.31499344]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [26.34028695]
Stock Price:  105.96690491869789
PL:  [20.37338203]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 1.61797504e-02  2.35762491e-02 -8.16167982e-02]
 [-2.72955163e-01  2.18331189e-02 -6.11686486e-02]
 [-9.73538207e-02  2.94625924e-02 -6.06676706e-02]
 [ 1.30419650e-01 -2.76048320e-02 -2.66050154e-01]
 [-7.29888033e-02  5.49679472e-02  6.79142648e-02]
 [ 1.15262879e-01  1.45252065e-01 -4.17406056e-02]
 [ 1.87964965e-01 -2.04742619e-01  2.05699736e-01]
 [ 1.55235583e-01  9.11939641e-02  6.14858362e-04]
 [-1.34114532e-01 -1.80732104e-01  9.23068788e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.95479226]
curr_Stock_Price:  101.36819183694448
curr_Factors:  [101.36819184  -1.51209142  -1.05639303]
mat_Sqrt:  [[ 7.7700368   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.65414107e-05  7.45546460e-03 -2.32830007e-01]
Stock Position:  1.6541410737227392e-05
Bond Position:  [11.95311549]


portfolio before change:  [11.96076799]
curr_Stock_Price:  101.22803434058176
curr_Factors:  [101.22803434  -0.97378119  -1.00814735]
mat_Sqrt:  [[13.94954935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02042198  0.00690424 -0.17449713]
Stock Position:  -0.02042198103362051
Bond Position:  [14.02804499]


portfolio before change:  [11.97980179]
curr_Stock_Price:  100.63954974574305
curr_Factors:  [100.63954975  -0.27423726  -1.00296737]
mat_Sqrt:  [[28.05987681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00388372  0.00931689 -0.17306798]
Stock Position:  -0.003883724685736399
Bond Position:  [12.37065809]


portfolio before change:  [12.00260784]
curr_Stock_Price:  96.36036525406485
curr_Factors:  [96.36036525 -0.12100292 -0.96108705]
mat_Sqrt:  [[32.65522897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00230896 -0.00872941 -0.75896703]
Stock Position:  0.002308960560182812
Bond Position:  [11.78011556]


portfolio before change:  [12.00555408]
curr_Stock_Price:  95.08477306490029
curr_Factors:  [95.08477306 -0.49717075 -0.94245342]
mat_Sqrt:  [[22.53669066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00256056  0.01738239  0.19374049]
Stock Position:  -0.0025605620906558836
Bond Position:  [12.24902454]


portfolio before change:  [12.01245033]
curr_Stock_Price:  94.78397605952979
curr_Factors:  [94.78397606 -0.61208365 -0.96508142]
mat_Sqrt:  [[19.57856386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00564357  0.04593274 -0.11907433]
Stock Position:  0.005643570505467264
Bond Position:  [11.47753028]


portfolio before change:  [12.01266917]
curr_Stock_Price:  93.80562991886762
curr_Factors:  [93.80562992 -0.93320241 -0.91737684]
mat_Sqrt:  [[14.74119016  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01524075 -0.0647453   0.58680409]
Stock Position:  0.015240751504401356
Bond Position:  [10.58300087]


portfolio before change:  [12.00810589]
curr_Stock_Price:  93.15893631728204
curr_Factors:  [93.15893632 -0.97776199 -0.92299569]
mat_Sqrt:  [[13.92310031  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01132763 0.02883806 0.00175402]
Stock Position:  0.011327628527021832
Bond Position:  [10.95283607]


portfolio before change:  [12.00513434]
curr_Stock_Price:  92.41303108536583
curr_Factors:  [92.41303109 -0.9281867  -0.88911573]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.00513434]
Stock Price:  92.9884845211523
PL:  [12.00513434]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 1.00114964e-01  1.00264242e-03 -6.19133872e-02]
 [-2.86728893e-01  9.98345845e-03 -7.80250739e-02]
 [-1.26688864e-01  8.33500792e-02 -8.24363888e-02]
 [ 2.24292082e-01 -1.63357040e-02 -2.44861174e-01]
 [ 6.80290228e-02 -1.21639629e-01 -1.67491746e-01]
 [ 4.38300866e-02 -1.25011721e-02 -1.10648568e-01]
 [ 3.10759631e-02  1.14799175e-01 -9.97299783e-02]
 [ 2.18209357e-01  1.14973507e-01 -1.07515726e-01]
 [-8.70913363e-02 -8.08447847e-02 -1.08872008e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.94391708]
curr_Stock_Price:  102.0633170416397
curr_Factors:  [102.06331704  -0.74542072  -1.01364482]
mat_Sqrt:  [[17.57588574  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00497857  0.00031706 -0.17662166]
Stock Position:  0.004978573265124963
Bond Position:  [16.43578738]


portfolio before change:  [16.94864445]
curr_Stock_Price:  101.36179492492167
curr_Factors:  [101.36179492  -0.80487307  -1.03220737]
mat_Sqrt:  [[16.14508705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01873003  0.00315705 -0.22258382]
Stock Position:  -0.018730027376450128
Bond Position:  [18.84715364]


portfolio before change:  [16.90164812]
curr_Stock_Price:  104.37419078227865
curr_Factors:  [104.37419078  -1.5317953   -0.97491424]
mat_Sqrt:  [[ 8.51026331  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01661101  0.02635761 -0.23516807]
Stock Position:  -0.016611005594202248
Bond Position:  [18.63540839]


portfolio before change:  [16.90872807]
curr_Stock_Price:  104.50904608616135
curr_Factors:  [104.50904609  -1.27302629  -0.94828291]
mat_Sqrt:  [[11.33578382  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01533976 -0.0051658  -0.69852077]
Stock Position:  0.015339761289115251
Bond Position:  [15.30558425]


portfolio before change:  [16.88829704]
curr_Stock_Price:  102.67813474344112
curr_Factors:  [102.67813474  -1.08850223  -0.9317598 ]
mat_Sqrt:  [[13.61724718  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00225443 -0.03846583 -0.47780733]
Stock Position:  0.0022544344841824468
Bond Position:  [16.65681591]


portfolio before change:  [16.89793867]
curr_Stock_Price:  103.2597200368222
curr_Factors:  [103.25972004  -1.15880646  -0.95292926]
mat_Sqrt:  [[12.49728783  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00167406 -0.00395322 -0.31564956]
Stock Position:  0.0016740643042338287
Bond Position:  [16.72507526]


portfolio before change:  [16.90331862]
curr_Stock_Price:  101.47682424418966
curr_Factors:  [101.47682424  -0.89832589  -0.97178594]
mat_Sqrt:  [[15.63823081  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00087496  0.03630269 -0.28450187]
Stock Position:  0.0008749562916128342
Bond Position:  [16.81453083]


portfolio before change:  [16.9132125]
curr_Stock_Price:  103.17349362585877
curr_Factors:  [103.17349363  -0.68494268  -0.91837334]
mat_Sqrt:  [[20.76140954  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00959624  0.03635782 -0.30671244]
Stock Position:  0.009596236915136206
Bond Position:  [15.92313521]


portfolio before change:  [16.93081918]
curr_Stock_Price:  104.17837927244952
curr_Factors:  [104.17837927  -0.13055272  -0.90225457]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.93081918]
Stock Price:  100.05913027606275
PL:  [16.8716889]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-2.21860796e-02  3.25724039e-03 -1.65628654e-02]
 [-2.44661110e-01  6.60348664e-02 -4.19542143e-02]
 [ 8.22937053e-02  2.26583361e-02 -1.63521871e-01]
 [ 1.26177764e-01  2.11809837e-02 -6.87560826e-03]
 [ 5.35368121e-02 -1.08107149e-01 -1.59532960e-01]
 [ 7.35140451e-02  1.08024281e-01 -2.14277056e-02]
 [ 2.80633231e-01 -2.86893406e-01  3.37796564e-01]
 [ 1.55703784e-01  8.75762750e-02  1.09143705e-03]
 [-1.28058239e-01 -1.60413742e-01  1.04896971e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.10579362]
curr_Stock_Price:  99.13050116874948
curr_Factors:  [99.13050117 -0.31896761 -1.00638442]
mat_Sqrt:  [[26.33990634  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00096746  0.00103003 -0.04724924]
Stock Position:  -0.0009674620118510055
Bond Position:  [-4.00988863]


portfolio before change:  [-4.10615719]
curr_Stock_Price:  97.4334032130578
curr_Factors:  [97.43340321 -0.20151619 -0.96784265]
mat_Sqrt:  [[30.25950223  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0083121   0.02088206 -0.1196837 ]
Stock Position:  -0.008312098579034248
Bond Position:  [-3.29628114]


portfolio before change:  [-4.10157503]
curr_Stock_Price:  96.68380723930308
curr_Factors:  [ 9.66838072e+01 -8.90142093e-02 -9.36824769e-01]
mat_Sqrt:  [[34.66071652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00142813  0.0071652  -0.46648238]
Stock Position:  0.0014281291269638773
Bond Position:  [-4.23965199]


portfolio before change:  [-4.09644371]
curr_Stock_Price:  101.76155178423434
curr_Factors:  [101.76155178  -0.15675784  -0.95163845]
mat_Sqrt:  [[33.59025722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00373088  0.00669802 -0.0196142 ]
Stock Position:  0.003730878740799611
Bond Position:  [-4.47610372]


portfolio before change:  [-4.10743038]
curr_Stock_Price:  99.41678117829349
curr_Factors:  [ 9.94167812e+01 -3.47692125e-02 -9.25865847e-01]
mat_Sqrt:  [[38.04181177  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00047792 -0.03418648 -0.45510313]
Stock Position:  0.0004779206781541906
Bond Position:  [-4.15494371]


portfolio before change:  [-4.11004193]
curr_Stock_Price:  98.30036178615232
curr_Factors:  [98.30036179 -0.19980055 -0.91888186]
mat_Sqrt:  [[32.11570946  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00223969  0.03416028 -0.06112728]
Stock Position:  0.0022396923254547237
Bond Position:  [-4.33020449]


portfolio before change:  [-4.12658202]
curr_Stock_Price:  91.8823139560477
curr_Factors:  [ 9.18823140e+01  7.02735134e-03 -9.22073264e-01]
mat_Sqrt:  [[36.79870482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00929865 -0.09072366  0.96363957]
Stock Position:  0.009298645466132271
Bond Position:  [-4.98096309]


portfolio before change:  [-4.11424276]
curr_Stock_Price:  93.47720985611222
curr_Factors:  [93.47720986  0.09460334 -0.89957585]
mat_Sqrt:  [[41.79368073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00378497 0.02769405 0.00311357]
Stock Position:  0.0037849689140254154
Bond Position:  [-4.46805109]


portfolio before change:  [-4.11738741]
curr_Stock_Price:  93.23676818455031
curr_Factors:  [93.23676818 -0.14771004 -0.8939614 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.11738741]
Stock Price:  97.16487825662443
PL:  [-4.11738741]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.29051536e-03 -2.32323277e-02  4.00175218e-02]
 [-1.86109418e-01  6.36149849e-02 -5.21202284e-03]
 [-1.02257309e-01  3.84701350e-02 -6.43064125e-02]
 [-1.83745818e-02 -8.38461912e-02 -5.02252306e-01]
 [ 6.91015353e-02 -1.13894242e-01 -1.70987366e-01]
 [ 7.96538341e-02  1.33172416e-01 -2.58701840e-03]
 [ 8.61590669e-02 -8.42650620e-02  7.05291967e-02]
 [ 9.57055649e-02  2.69130625e-02 -1.50152990e-03]
 [-9.20975392e-02 -7.92216989e-02  4.26602944e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.87355269]
curr_Stock_Price:  98.88420268487074
curr_Factors:  [98.88420268 -0.64027221 -0.96883694]
mat_Sqrt:  [[19.7833434   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0001657  -0.00734671  0.11415885]
Stock Position:  0.00016570358646593214
Bond Position:  [-5.88993815]


portfolio before change:  [-5.87620009]
curr_Stock_Price:  100.68443742011749
curr_Factors:  [100.68443742  -0.98478087  -1.011297  ]
mat_Sqrt:  [[13.67970548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01356248  0.02011682 -0.01486845]
Stock Position:  -0.013562483932021948
Bond Position:  [-4.51066902]


portfolio before change:  [-5.87134786]
curr_Stock_Price:  100.16033520122795
curr_Factors:  [100.1603352   -1.70752342  -0.99849543]
mat_Sqrt:  [[ 6.69093354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01709634  0.01216532 -0.1834483 ]
Stock Position:  -0.017096344618043255
Bond Position:  [-4.15897225]


portfolio before change:  [-5.88303479]
curr_Stock_Price:  100.72226414566475
curr_Factors:  [100.72226415  -1.51316923  -0.95920533]
mat_Sqrt:  [[ 8.49937221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01447887 -0.02651449 -1.43278603]
Stock Position:  -0.014478869841919753
Bond Position:  [-4.42469024]


portfolio before change:  [-5.85816506]
curr_Stock_Price:  98.85177105250874
curr_Factors:  [98.85177105 -1.19968848 -0.96085227]
mat_Sqrt:  [[11.39392954  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0027434  -0.03601652 -0.48777936]
Stock Position:  0.0027434037214611544
Bond Position:  [-6.12935538]


portfolio before change:  [-5.86617403]
curr_Stock_Price:  97.04980305626434
curr_Factors:  [97.04980306 -1.08599502 -0.91425779]
mat_Sqrt:  [[13.13094244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00628776  0.04211282 -0.00738004]
Stock Position:  0.006287763310995032
Bond Position:  [-6.47640023]


portfolio before change:  [-5.86669606]
curr_Stock_Price:  97.4819089504475
curr_Factors:  [97.48190895 -0.94678007 -0.9702478 ]
mat_Sqrt:  [[14.33406602  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00686337 -0.02664695  0.20120017]
Stock Position:  0.006863374575853585
Bond Position:  [-6.53575092]


portfolio before change:  [-5.85265378]
curr_Stock_Price:  100.00413423554737
curr_Factors:  [100.00413424  -0.6233204   -1.00208432]
mat_Sqrt:  [[19.68401346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00488183  0.00851066 -0.00428345]
Stock Position:  0.004881827522595653
Bond Position:  [-6.34085672]


portfolio before change:  [-5.84652455]
curr_Stock_Price:  101.90925061919518
curr_Factors:  [101.90925062  -0.51601423  -0.98830454]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.84652455]
Stock Price:  102.47056744875064
PL:  [-8.317092]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-2.67331695e-01  4.14393054e-02 -2.96783750e-02]
 [-1.16312967e-01  6.42899059e-02 -7.47367248e-02]
 [ 2.30914314e-01  1.23555876e-02 -1.14578435e-01]
 [ 6.87232896e-02 -1.16625827e-01 -1.69754557e-01]
 [ 4.52749053e-02 -7.64120954e-03 -1.08082933e-01]
 [ 4.16353116e-02  7.97599426e-02 -1.66249132e-01]
 [ 1.49257920e-01  6.90859373e-02 -5.99430477e-02]
 [-9.10080080e-02 -7.95749412e-02  3.10064180e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.99201076]
curr_Stock_Price:  100.39808082794501
curr_Factors:  [100.39808083  -1.01113166  -1.04560927]
mat_Sqrt:  [[12.83790546  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00480861  0.01250945 -0.27262553]
Stock Position:  -0.004808611753297774
Bond Position:  [5.47478615]


portfolio before change:  [4.99179169]
curr_Stock_Price:  101.01304978406571
curr_Factors:  [101.01304978  -0.76758472  -1.05246237]
mat_Sqrt:  [[16.36594458  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01663942  0.01310426 -0.08466414]
Stock Position:  -0.01663941904505208
Bond Position:  [6.67259016]


portfolio before change:  [4.97800908]
curr_Stock_Price:  102.04191671766176
curr_Factors:  [102.04191672  -0.70208085  -1.06432163]
mat_Sqrt:  [[17.44374615  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00744729  0.02033025 -0.21320307]
Stock Position:  -0.007447286706456346
Bond Position:  [5.73794448]


portfolio before change:  [4.96266229]
curr_Stock_Price:  104.48797217134153
curr_Factors:  [104.48797217  -0.35088653  -1.0783812 ]
mat_Sqrt:  [[25.023221    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00830609  0.00390718 -0.32686038]
Stock Position:  0.00830608931156979
Bond Position:  [4.09477586]


portfolio before change:  [4.9371282]
curr_Stock_Price:  101.16727755243052
curr_Factors:  [101.16727755  -0.50653164  -1.1136263 ]
mat_Sqrt:  [[20.01771067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00155168 -0.03688032 -0.4842625 ]
Stock Position:  0.0015516769349207548
Bond Position:  [4.78014927]


portfolio before change:  [4.94153136]
curr_Stock_Price:  102.46425118522251
curr_Factors:  [102.46425119  -1.021451    -1.06642759]
mat_Sqrt:  [[12.70042397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00181217 -0.00241636 -0.30833052]
Stock Position:  0.001812165786127888
Bond Position:  [4.75584915]


portfolio before change:  [4.94749559]
curr_Stock_Price:  104.4429399026586
curr_Factors:  [104.4429399   -0.75486016  -1.15148377]
mat_Sqrt:  [[15.52259901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00062871  0.02522231 -0.4742625 ]
Stock Position:  0.0006287118863514226
Bond Position:  [4.88183107]


portfolio before change:  [4.94776703]
curr_Stock_Price:  100.991302915083
curr_Factors:  [100.99130292  -0.47111064  -1.12255459]
mat_Sqrt:  [[20.51936702  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00676463  0.02184689 -0.17100083]
Stock Position:  0.006764628167432643
Bond Position:  [4.26459842]


portfolio before change:  [4.95793054]
curr_Stock_Price:  102.17845987541165
curr_Factors:  [102.17845988  -0.38023829  -1.15181073]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.95793054]
Stock Price:  101.20160586019105
PL:  [3.75632468]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.40165854e-02  3.89512100e-02 -9.37701724e-02]
 [-4.32396009e-01 -1.61375552e-01 -3.38304619e-01]
 [-1.29290878e-01  8.81298918e-02 -8.43672710e-02]
 [ 2.75658956e-01  1.05706355e-02 -1.32847000e-01]
 [ 5.83478562e-02 -1.18918399e-01 -1.47742643e-01]
 [-5.82998058e-02 -2.26706145e-02  2.03325162e-02]
 [ 6.62762461e-02  6.39385016e-02 -2.02326410e-01]
 [ 2.66695235e-01  1.46046011e-01 -1.37036678e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.36988321]
curr_Stock_Price:  99.75408864864099
curr_Factors:  [99.75408865 -0.90190081 -1.01911795]
mat_Sqrt:  [[14.60975243  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00425412  0.01231745 -0.2675002 ]
Stock Position:  -0.004254119021599312
Bond Position:  [0.79424897]


portfolio before change:  [0.35493915]
curr_Stock_Price:  103.36030519981603
curr_Factors:  [103.3603052   -1.00388881  -1.09490377]
mat_Sqrt:  [[12.67242554  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03989914 -0.05103143 -0.96508891]
Stock Position:  -0.03989913754457737
Bond Position:  [4.47892619]


portfolio before change:  [0.31024464]
curr_Stock_Price:  104.53663475966607
curr_Factors:  [104.53663476  -1.34380188  -1.11457566]
mat_Sqrt:  [[ 8.94558436  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0161238   0.02786912 -0.24067634]
Stock Position:  -0.016123795312404546
Bond Position:  [1.99577194]


portfolio before change:  [0.30463088]
curr_Stock_Price:  104.94670562879456
curr_Factors:  [104.94670563  -0.92740479  -1.06772719]
mat_Sqrt:  [[14.27230101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01743339  0.00334273 -0.37897551]
Stock Position:  0.017433391275345284
Bond Position:  [-1.5249461]


portfolio before change:  [0.32741906]
curr_Stock_Price:  106.29761012689767
curr_Factors:  [106.29761013  -1.14650838  -1.07529653]
mat_Sqrt:  [[11.52407     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00217975 -0.0376053  -0.42146864]
Stock Position:  0.0021797468852870496
Bond Position:  [0.09571718]


portfolio before change:  [0.32656862]
curr_Stock_Price:  105.88549129788224
curr_Factors:  [105.8854913   -1.46829661  -1.06394853]
mat_Sqrt:  [[ 8.41581862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0065038  -0.00716908  0.05800301]
Stock Position:  -0.006503799982552488
Bond Position:  [1.01522667]


portfolio before change:  [0.32660936]
curr_Stock_Price:  105.95729539809969
curr_Factors:  [105.9572954   -1.17408229  -1.10366791]
mat_Sqrt:  [[10.86216809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00245139  0.02021913 -0.57718093]
Stock Position:  0.0024513914046858216
Bond Position:  [0.06686656]


portfolio before change:  [0.32617342]
curr_Stock_Price:  105.76582161176924
curr_Factors:  [105.76582161  -0.99245269  -1.1058186 ]
mat_Sqrt:  [[12.9741138   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01869057  0.0461838  -0.3909275 ]
Stock Position:  0.018690573838458693
Bond Position:  [-1.65065047]


portfolio before change:  [0.32466541]
curr_Stock_Price:  105.7293070325369
curr_Factors:  [105.72930703  -1.0770394   -1.13026609]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.32466541]
Stock Price:  105.0968676351343
PL:  [-4.77220222]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 9.87997982e-02  1.35634419e-03 -6.22221164e-02]
 [-3.21911903e-01 -4.85250559e-02 -1.71386209e-01]
 [-1.17875612e-01  6.71604324e-02 -7.58963202e-02]
 [ 1.81964200e-01  1.31510303e-02 -8.47833297e-02]
 [ 6.73383925e-02 -1.26627169e-01 -1.65240787e-01]
 [-1.09134110e-03 -1.26285567e-02 -2.19578546e-02]
 [ 5.06661367e-02  7.79330666e-02 -1.72295379e-01]
 [ 2.38304256e-01  1.26944600e-01 -1.16767322e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.68632929]
curr_Stock_Price:  102.44541208310207
curr_Factors:  [102.44541208  -1.64599446  -1.07679233]
mat_Sqrt:  [[ 6.72978574  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01279889  0.00042891 -0.17750238]
Stock Position:  0.012798889286738155
Bond Position:  [18.37514181]


portfolio before change:  [19.69063777]
curr_Stock_Price:  102.06402031019671
curr_Factors:  [102.06402031  -1.39729795  -1.09587455]
mat_Sqrt:  [[ 8.43532092  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04245824 -0.01534497 -0.48891715]
Stock Position:  -0.0424582397730129
Bond Position:  [24.02409642]


portfolio before change:  [19.68178977]
curr_Stock_Price:  102.55539857191877
curr_Factors:  [102.55539857  -1.00147709  -1.08900554]
mat_Sqrt:  [[12.67866296  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01038231  0.02123799 -0.21651108]
Stock Position:  -0.010382309953580256
Bond Position:  [20.7465517]


portfolio before change:  [19.68784915]
curr_Stock_Price:  102.97115223372202
curr_Factors:  [102.97115223  -0.54470362  -1.08797657]
mat_Sqrt:  [[20.12109331  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00820022  0.00415872 -0.24186324]
Stock Position:  0.008200222078459354
Bond Position:  [18.84346284]


portfolio before change:  [19.70452048]
curr_Stock_Price:  103.85493838518137
curr_Factors:  [103.85493839  -0.80721114  -1.05339688]
mat_Sqrt:  [[16.15754449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00187771 -0.04004303 -0.47138597]
Stock Position:  0.0018777146861965628
Bond Position:  [19.50951054]


portfolio before change:  [19.71700869]
curr_Stock_Price:  105.3093713518757
curr_Factors:  [105.30937135  -0.90925743  -1.1818479 ]
mat_Sqrt:  [[13.01102499  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045343 -0.0039935  -0.06263965]
Stock Position:  -0.0004534260245068527
Bond Position:  [19.7647587]


portfolio before change:  [19.72654224]
curr_Stock_Price:  106.08412659086375
curr_Factors:  [106.08412659  -1.1038591   -1.21031685]
mat_Sqrt:  [[10.4861619   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0016697   0.0246446  -0.49151076]
Stock Position:  0.0016696969804559105
Bond Position:  [19.5494139]


portfolio before change:  [19.73437619]
curr_Stock_Price:  104.92031944480725
curr_Factors:  [104.92031944  -0.93350382  -1.20915298]
mat_Sqrt:  [[12.3116307   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01768628  0.04014341 -0.33310467]
Stock Position:  0.017686277902161242
Bond Position:  [17.87872626]


portfolio before change:  [19.77375115]
curr_Stock_Price:  106.64105230717414
curr_Factors:  [106.64105231  -0.77442073  -1.22770687]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.77375115]
Stock Price:  105.78078704747548
PL:  [13.9929641]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-2.87062351e-01  2.24894635e-02 -5.59035193e-02]
 [-7.17903533e-02 -1.12044744e-02 -4.83780886e-02]
 [ 1.70264865e-02 -9.14998983e-03 -1.06514904e-01]
 [ 4.43379325e-02 -9.16159048e-02 -1.57106865e-01]
 [ 5.92473665e-02  4.95889890e-02 -6.52067402e-02]
 [ 9.47268293e-02 -4.95571569e-02  8.30336031e-02]
 [ 1.83200023e-01  8.80696232e-02 -7.15018443e-02]
 [-9.67694365e-02 -7.77069999e-02  9.26319799e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.09918948]
curr_Stock_Price:  100.27368574868393
curr_Factors:  [100.27368575  -1.03556067  -1.01482736]
mat_Sqrt:  [[12.90371531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00478409  0.01250945 -0.27262553]
Stock Position:  -0.004784087497355032
Bond Position:  [4.57890757]


portfolio before change:  [4.0969442]
curr_Stock_Price:  101.22168349493928
curr_Factors:  [101.22168349  -0.83994777  -0.93957269]
mat_Sqrt:  [[17.07802477  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01744306  0.00711179 -0.15947718]
Stock Position:  -0.017443055493041988
Bond Position:  [5.86255964]


portfolio before change:  [4.13672018]
curr_Stock_Price:  99.10944082435472
curr_Factors:  [99.10944082 -0.32648072 -0.94282035]
mat_Sqrt:  [[27.852525    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00294245 -0.00354317 -0.13800922]
Stock Position:  -0.002942454500897734
Bond Position:  [4.4283452]


portfolio before change:  [4.1367381]
curr_Stock_Price:  99.85603029533058
curr_Factors:  [99.8560303  -0.32271797 -0.99216482]
mat_Sqrt:  [[26.8119225   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.84695034e-04 -2.89348084e-03 -3.03857373e-01]
Stock Position:  -0.00018469503375838248
Bond Position:  [4.15518101]


portfolio before change:  [4.1392186]
curr_Stock_Price:  97.67738499256724
curr_Factors:  [97.67738499 -0.8476351  -1.03454819]
mat_Sqrt:  [[14.87209694  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00066589 -0.02897149 -0.44818216]
Stock Position:  0.0006658856198805141
Bond Position:  [4.07417663]


portfolio before change:  [4.14215645]
curr_Stock_Price:  99.0293550296682
curr_Factors:  [99.02935503 -0.4647066  -1.06492395]
mat_Sqrt:  [[21.45131118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00220115  0.01568142 -0.18601668]
Stock Position:  0.0022011465028612424
Bond Position:  [3.92417833]


portfolio before change:  [4.1434825]
curr_Stock_Price:  98.74017116223622
curr_Factors:  [98.74017116 -0.41084903 -1.10393816]
mat_Sqrt:  [[21.70851714  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0050854  -0.01567135  0.23687176]
Stock Position:  0.005085397197338262
Bond Position:  [3.64134951]


portfolio before change:  [4.16642741]
curr_Stock_Price:  102.89398354360367
curr_Factors:  [102.89398354  -0.86715078  -1.11578968]
mat_Sqrt:  [[14.16478148  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01206363  0.02785006 -0.20397486]
Stock Position:  0.01206363251690914
Bond Position:  [2.92515221]


portfolio before change:  [4.13548478]
curr_Stock_Price:  100.20776299599608
curr_Factors:  [100.207763    -0.7232742   -1.09980788]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.13548478]
Stock Price:  101.3588366315939
PL:  [2.77664814]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-2.02642274e-02 -3.01510004e-03 -2.18501465e-03]
 [ 3.43520474e-02  8.00839750e-02  4.70290140e-02]
 [-1.00490746e-01  3.52250184e-02 -6.29954954e-02]
 [-5.42988549e-02 -1.23724320e-01 -6.51550091e-01]
 [ 6.87216417e-02 -1.16637727e-01 -1.69749186e-01]
 [ 4.64625968e-02 -2.77651024e-03 -1.04438357e-01]
 [ 2.21497458e-02  3.12773514e-02 -8.64133252e-03]
 [ 8.66625297e-02  1.97168102e-02  8.61316257e-03]
 [-1.17309728e-01 -1.27633129e-01  1.15853136e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.7676924]
curr_Stock_Price:  99.03828007955798
curr_Factors:  [99.03828008 -0.98301445 -1.02369747]
mat_Sqrt:  [[13.31371244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0015614  -0.00095346 -0.00623324]
Stock Position:  -0.0015614045507795406
Bond Position:  [-4.61305358]


portfolio before change:  [-4.77002214]
curr_Stock_Price:  99.05277568275939
curr_Factors:  [99.05277568 -1.14265646 -1.0437081 ]
mat_Sqrt:  [[11.12603913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0041362  0.02532478 0.13416069]
Stock Position:  0.004136203679535388
Bond Position:  [-5.1797246]


portfolio before change:  [-4.77022511]
curr_Stock_Price:  99.63000675795737
curr_Factors:  [99.63000676 -1.53069359 -1.0414585 ]
mat_Sqrt:  [[ 7.60884438  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01477756  0.01113913 -0.17970861]
Stock Position:  -0.01477755829989299
Bond Position:  [-3.29793687]


portfolio before change:  [-4.76863595]
curr_Stock_Price:  99.4108544284703
curr_Factors:  [99.41085443 -1.81043475 -1.06660982]
mat_Sqrt:  [[ 5.59692161  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03403487 -0.03912507 -1.85869105]
Stock Position:  -0.034034871592804654
Bond Position:  [-1.38520029]


portfolio before change:  [-4.79999157]
curr_Stock_Price:  100.31177894799407
curr_Factors:  [100.31177895  -1.42235171  -1.12125898]
mat_Sqrt:  [[ 7.88271538  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00394029 -0.03688409 -0.48424718]
Stock Position:  0.00394028701920032
Bond Position:  [-5.19524877]


portfolio before change:  [-4.80345411]
curr_Stock_Price:  100.09243830774165
curr_Factors:  [100.09243831  -1.04551994  -1.15881313]
mat_Sqrt:  [[11.04260609  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227053 -0.00087801 -0.29793356]
Stock Position:  0.002270525362140725
Bond Position:  [-5.03071653]


portfolio before change:  [-4.80757181]
curr_Stock_Price:  99.3870031853108
curr_Factors:  [99.38700319 -1.07060473 -1.17763139]
mat_Sqrt:  [[10.49380658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00201961  0.00989077 -0.02465132]
Stock Position:  0.002019612114306962
Bond Position:  [-5.008295]


portfolio before change:  [-4.80963134]
curr_Stock_Price:  99.60746014359994
curr_Factors:  [99.60746014 -0.98860658 -1.26234556]
mat_Sqrt:  [[10.48855771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00847874 0.006235   0.02457096]
Stock Position:  0.008478741545024218
Bond Position:  [-5.65417726]


portfolio before change:  [-4.83182789]
curr_Stock_Price:  97.3230710543757
curr_Factors:  [97.32307105 -1.27832573 -1.25173559]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.83182789]
Stock Price:  98.26198496583902
PL:  [-4.83182789]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-5.04114787e-03  9.93958859e-02  4.57513967e-02]
 [-9.57449706e-02  2.65071890e-02 -5.94737878e-02]
 [ 1.88450892e-03 -7.80889271e-02 -5.02920466e-01]
 [ 6.86082879e-02 -1.17456337e-01 -1.69379734e-01]
 [ 4.56905462e-02 -5.93877408e-03 -1.06807488e-01]
 [ 3.26969603e-02  9.74512136e-02 -1.31567143e-01]
 [ 1.54893400e-01  5.81463508e-02 -1.55050555e-02]
 [-7.76649194e-02 -6.66131141e-02  5.93626185e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.6828084]
curr_Stock_Price:  100.91231259325704
curr_Factors:  [100.91231259  -0.67980601  -1.03141584]
mat_Sqrt:  [[18.22929815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00338644  0.01250945 -0.27262553]
Stock Position:  -0.00338644431350471
Bond Position:  [9.02454233]


portfolio before change:  [8.69042008]
curr_Stock_Price:  99.99740550915803
curr_Factors:  [99.99740551 -1.2894548  -1.06366778]
mat_Sqrt:  [[ 9.50693619  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00072202 0.03143174 0.130516  ]
Stock Position:  0.0007220210046216985
Bond Position:  [8.61821985]


portfolio before change:  [8.69480638]
curr_Stock_Price:  100.10281538041235
curr_Factors:  [100.10281538  -1.16827726  -1.05685056]
mat_Sqrt:  [[10.81647018  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00991087  0.00838231 -0.16966216]
Stock Position:  -0.009910866691610232
Bond Position:  [9.68691204]


portfolio before change:  [8.68843396]
curr_Stock_Price:  101.23461236486439
curr_Factors:  [101.23461236  -1.53177217  -1.02715928]
mat_Sqrt:  [[ 7.83428226  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01312053 -0.02469389 -1.4346921 ]
Stock Position:  -0.013120531706792034
Bond Position:  [10.0166859]


portfolio before change:  [8.68851588]
curr_Stock_Price:  101.61018168633795
curr_Factors:  [101.61018169  -1.4334032   -1.04027412]
mat_Sqrt:  [[ 8.56313555  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0036203  -0.03714296 -0.48319323]
Stock Position:  0.0036202959515857073
Bond Position:  [8.32065695]


portfolio before change:  [8.69502575]
curr_Stock_Price:  102.25888591380989
curr_Factors:  [102.25888591  -1.16225824  -1.09877326]
mat_Sqrt:  [[10.65976308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00222662 -0.00187801 -0.30469203]
Stock Position:  0.002226618011830688
Bond Position:  [8.46733427]


portfolio before change:  [8.70135932]
curr_Stock_Price:  103.2015000116691
curr_Factors:  [103.20150001  -1.06773285  -1.05925221]
mat_Sqrt:  [[12.30121858  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00067937  0.03081678 -0.37532444]
Stock Position:  0.0006793724727576112
Bond Position:  [8.63124706]


portfolio before change:  [8.70597895]
curr_Stock_Price:  103.6473906210856
curr_Factors:  [103.64739062  -1.53756962  -1.07860402]
mat_Sqrt:  [[ 7.57475507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02022901  0.01838749 -0.04423161]
Stock Position:  0.020229007421233465
Bond Position:  [6.60929511]


portfolio before change:  [8.71931454]
curr_Stock_Price:  104.1432192857261
curr_Factors:  [104.14321929  -1.6708426   -1.07504267]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.71931454]
Stock Price:  104.62499259657895
PL:  [4.09432195]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 1.82137410e-03 -3.27868862e-02  6.05707630e-02]
 [-2.60585708e-01  6.44442764e-02 -4.40456019e-02]
 [ 9.59585913e-02  3.45636904e-02 -1.80380706e-01]
 [-1.84156663e-01 -2.89720742e-02 -1.00753220e-01]
 [-1.18395784e-01  1.69153348e-01  2.41739867e-01]
 [ 1.40506371e-01  1.53815409e-01 -6.94968480e-02]
 [ 2.12243732e-01 -2.38138900e-01  2.40469120e-01]
 [ 1.20977641e-01  1.11663325e-01  2.13549830e-02]
 [-1.37541026e-01 -1.92657587e-01  8.36910606e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.51114968]
curr_Stock_Price:  98.79536751673784
curr_Factors:  [98.79536752 -0.77913986 -0.87572489]
mat_Sqrt:  [[18.88156334  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00070644 -0.01036812  0.17279153]
Stock Position:  0.0007064444461750891
Bond Position:  [-6.58094312]


portfolio before change:  [-6.51593507]
curr_Stock_Price:  96.68042157818165
curr_Factors:  [96.68042158 -0.77469795 -0.79041814]
mat_Sqrt:  [[20.21237066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01325488  0.02037907 -0.12564984]
Stock Position:  -0.01325487936540645
Bond Position:  [-5.23444774]


portfolio before change:  [-6.46374176]
curr_Stock_Price:  92.54525118470356
curr_Factors:  [92.54525118 -0.61138894 -0.75751484]
mat_Sqrt:  [[23.54218565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00254993  0.01093    -0.51457595]
Stock Position:  0.002549931655350173
Bond Position:  [-6.69972583]


portfolio before change:  [-6.46959172]
curr_Stock_Price:  91.5651245065322
curr_Factors:  [91.56512451 -0.3827425  -0.70960748]
mat_Sqrt:  [[30.71344407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00668993 -0.00916177 -0.28742089]
Stock Position:  -0.0066899330228553525
Bond Position:  [-5.85702717]


portfolio before change:  [-6.4836866]
curr_Stock_Price:  93.23414498370262
curr_Factors:  [93.23414498 -0.39793217 -0.70486476]
mat_Sqrt:  [[30.94826963  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209005  0.05349099  0.68961655]
Stock Position:  -0.0020900464103121145
Bond Position:  [-6.28882291]


portfolio before change:  [-6.48837911]
curr_Stock_Price:  93.97447037647242
curr_Factors:  [93.97447038 -1.24376132 -0.71892451]
mat_Sqrt:  [[13.20159062  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00986941  0.0486407  -0.19825516]
Stock Position:  0.00986940793357606
Bond Position:  [-7.41585149]


portfolio before change:  [-6.51142423]
curr_Stock_Price:  92.01525791235312
curr_Factors:  [92.01525791 -1.62692387 -0.65171099]
mat_Sqrt:  [[ 9.42456469  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02707611 -0.07530613  0.68599147]
Stock Position:  0.027076111577559937
Bond Position:  [-9.00283962]


portfolio before change:  [-6.52116757]
curr_Stock_Price:  91.82170020221437
curr_Factors:  [91.8217002  -1.84355264 -0.5734843 ]
mat_Sqrt:  [[ 8.18916321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01565726 0.03531104 0.06091982]
Stock Position:  0.015657258225327608
Bond Position:  [-7.95884364]


portfolio before change:  [-6.5315402]
curr_Stock_Price:  91.41344118801011
curr_Factors:  [91.41344119 -1.27081917 -0.6058847 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.5315402]
Stock Price:  94.76158151155865
PL:  [-6.5315402]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-2.90635968e-01 -1.65792405e-02 -1.24134801e-01]
 [-1.12337796e-01  5.69876514e-02 -7.17868615e-02]
 [ 6.74663560e-03 -4.59573261e-02 -2.75805703e-01]
 [ 6.87228009e-02 -1.16629356e-01 -1.69752964e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 2.36909768e-02  1.20207155e-01 -3.24872097e-03]
 [ 9.10243663e-02  2.16382371e-02  8.83227262e-03]
 [-9.52941637e-02 -7.81853055e-02  7.68521229e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.95125554]
curr_Stock_Price:  99.97441822721265
curr_Factors:  [99.97441823 -1.28454324 -1.01894173]
mat_Sqrt:  [[ 9.98844936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00618039  0.01250945 -0.27262553]
Stock Position:  -0.006180389049438372
Bond Position:  [2.56913634]


portfolio before change:  [1.94219443]
curr_Stock_Price:  101.64842302958219
curr_Factors:  [101.64842303  -1.24606251  -1.05402155]
mat_Sqrt:  [[10.19029674  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03104943 -0.00524282 -0.35412204]
Stock Position:  -0.031049434575104434
Bond Position:  [5.09832049]


portfolio before change:  [1.93491481]
curr_Stock_Price:  101.96499633132515
curr_Factors:  [101.96499633  -1.12525008  -1.04274278]
mat_Sqrt:  [[11.66551118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01075991  0.01802108 -0.20478793]
Stock Position:  -0.010759906818340085
Bond Position:  [3.03204866]


portfolio before change:  [1.95766242]
curr_Stock_Price:  99.99181815079929
curr_Factors:  [99.99181815 -0.81150038 -1.02482223]
mat_Sqrt:  [[15.93894916  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00318331 -0.01453298 -0.7867969 ]
Stock Position:  -0.0031833077801758643
Bond Position:  [2.27596715]


portfolio before change:  [1.95599989]
curr_Stock_Price:  100.87165830490925
curr_Factors:  [100.8716583   -0.99777835  -1.05623215]
mat_Sqrt:  [[12.9337284   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00240153 -0.03688144 -0.48425796]
Stock Position:  0.0024015321999091488
Bond Position:  [1.71375335]


portfolio before change:  [1.95636529]
curr_Stock_Price:  100.6669167566598
curr_Factors:  [100.66691676  -1.04326697  -1.10810584]
mat_Sqrt:  [[11.71001439  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0020199  -0.00193948 -0.30510753]
Stock Position:  0.0020198955235644174
Bond Position:  [1.75302863]


portfolio before change:  [1.95745968]
curr_Stock_Price:  100.77467309871109
curr_Factors:  [100.7746731   -0.69703914  -1.16247398]
mat_Sqrt:  [[15.69549835  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00166491  0.03801284 -0.0092677 ]
Stock Position:  0.00166490857417441
Bond Position:  [1.78967906]


portfolio before change:  [1.95764593]
curr_Stock_Price:  100.34893994216644
curr_Factors:  [100.34893994  -0.82630982  -1.11440007]
mat_Sqrt:  [[14.41030559  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0064805  0.00684261 0.02519602]
Stock Position:  0.006480497074719092
Bond Position:  [1.30733492]


portfolio before change:  [1.95986736]
curr_Stock_Price:  100.59083503257304
curr_Factors:  [100.59083503  -1.18620256  -1.15305403]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.95986736]
Stock Price:  100.37945897929998
PL:  [1.58040838]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-2.78031533e-02  3.54050481e-02 -9.19415854e-02]
 [-3.54886823e-01 -8.22062446e-02 -2.21204426e-01]
 [-1.17133090e-01  6.57964435e-02 -7.53453149e-02]
 [ 1.02155452e-01 -8.32769187e-02 -5.69350981e-01]
 [ 6.79484499e-02 -1.22221504e-01 -1.67229136e-01]
 [ 4.07838535e-02 -5.98336214e-03 -8.64566608e-02]
 [ 4.86524833e-02  6.67435303e-02 -1.91900514e-01]
 [ 2.03872687e-01  1.13000170e-01 -1.22520189e-01]
 [-9.44374001e-02 -7.84630810e-02  6.76879831e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.92934284]
curr_Stock_Price:  101.08598984916499
curr_Factors:  [101.08598985  -1.05937782  -1.04942454]
mat_Sqrt:  [[12.27014623  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00372094  0.01119606 -0.26228375]
Stock Position:  -0.0037209415057519344
Bond Position:  [10.3054779]


portfolio before change:  [9.92912002]
curr_Stock_Price:  102.53101255974018
curr_Factors:  [102.53101256  -1.78948947  -1.12103763]
mat_Sqrt:  [[ 5.58250839  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07203976 -0.0259959  -0.63103465]
Stock Position:  -0.07203975618824711
Bond Position:  [17.31542917]


portfolio before change:  [9.90726372]
curr_Stock_Price:  102.95461451967078
curr_Factors:  [102.95461452  -1.37026276  -1.09772584]
mat_Sqrt:  [[ 8.72593531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01499141  0.02080666 -0.21493921]
Stock Position:  -0.014991405039389458
Bond Position:  [11.45069805]


portfolio before change:  [9.90829598]
curr_Stock_Price:  103.26776214106246
curr_Factors:  [103.26776214  -2.00962473  -1.10660634]
mat_Sqrt:  [[ 4.57723078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0035421  -0.02633447 -1.62419987]
Stock Position:  -0.003542104737111411
Bond Position:  [10.27408121]


portfolio before change:  [9.91533488]
curr_Stock_Price:  102.7311938868265
curr_Factors:  [102.73119389  -1.41346513  -1.09745691]
mat_Sqrt:  [[ 8.34108883  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00367544 -0.03864983 -0.47705818]
Stock Position:  0.0036754433867020554
Bond Position:  [9.5377522]


portfolio before change:  [9.92485425]
curr_Stock_Price:  104.02336371996869
curr_Factors:  [104.02336372  -0.95357615  -1.12776979]
mat_Sqrt:  [[12.97818131  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00177078 -0.00189211 -0.24663679]
Stock Position:  0.001770777522174924
Bond Position:  [9.74065202]


portfolio before change:  [9.92929691]
curr_Stock_Price:  103.78116108127797
curr_Factors:  [103.78116108  -0.49394068  -1.08001624]
mat_Sqrt:  [[21.5059049   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.20985543e-04  2.11061575e-02 -5.47438751e-01]
Stock Position:  0.0005209855428121975
Bond Position:  [9.87522842]


portfolio before change:  [9.93312121]
curr_Stock_Price:  101.64186909125758
curr_Factors:  [101.64186909  -0.14327154  -1.07828619]
mat_Sqrt:  [[29.96103824  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00606725  0.03573379 -0.349516  ]
Stock Position:  0.006067246694617471
Bond Position:  [9.31643492]


portfolio before change:  [9.92936687]
curr_Stock_Price:  100.25512300329774
curr_Factors:  [ 1.00255123e+02  3.75151330e-02 -1.07316504e+00]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.92936687]
Stock Price:  94.18765665394214
PL:  [9.92936687]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-6.59317184e-02  7.58766423e-02  1.66270024e-02]
 [-7.81075277e-02 -5.89219999e-03 -4.63855329e-02]
 [ 3.31264398e-02 -8.54180260e-02 -4.87483725e-01]
 [ 7.31978146e-02 -8.43120508e-02 -1.84338293e-01]
 [ 7.96538341e-02  1.33172416e-01 -2.58701840e-03]
 [ 1.29095776e-01 -1.44915475e-01  1.24276558e-01]
 [ 1.21435119e-01  4.64898598e-02  1.96614880e-02]
 [-1.16873831e-01 -1.22965081e-01  1.27890291e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.37113533]
curr_Stock_Price:  100.45090352718637
curr_Factors:  [100.45090353  -0.70483099  -1.04051667]
mat_Sqrt:  [[17.53714898  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0035201   0.01250945 -0.27262553]
Stock Position:  -0.0035200991425818396
Bond Position:  [5.72473247]


portfolio before change:  [5.38039578]
curr_Stock_Price:  98.63352002455574
curr_Factors:  [98.63352002 -0.72328736 -1.02504529]
mat_Sqrt:  [[17.16853773  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00352847  0.0239943   0.04743221]
Stock Position:  -0.0035284670239567047
Bond Position:  [5.7284209]


portfolio before change:  [5.39301707]
curr_Stock_Price:  95.86847702620594
curr_Factors:  [95.86847703 -1.02932628 -1.02941094]
mat_Sqrt:  [[12.23425739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00717069 -0.00186328 -0.13232501]
Stock Position:  -0.007170690308213974
Bond Position:  [6.08046023]


portfolio before change:  [5.38664977]
curr_Stock_Price:  97.18052468164365
curr_Factors:  [97.18052468 -1.01293457 -1.07414497]
mat_Sqrt:  [[12.05513591  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00568938 -0.02701155 -1.39065538]
Stock Position:  -0.005689379478806294
Bond Position:  [5.93954665]


portfolio before change:  [5.38978647]
curr_Stock_Price:  97.15131609848977
curr_Factors:  [97.1513161  -1.41036587 -1.02195819]
mat_Sqrt:  [[ 8.53303976  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00391338 -0.02666181 -0.52586584]
Stock Position:  0.003913375694484958
Bond Position:  [5.00959687]


portfolio before change:  [5.39102722]
curr_Stock_Price:  96.82815034513776
curr_Factors:  [96.82815035 -1.28930011 -1.01646603]
mat_Sqrt:  [[ 9.65206252  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00855405  0.04211282 -0.00738004]
Stock Position:  0.00855405338937293
Bond Position:  [4.56275405]


portfolio before change:  [5.38406257]
curr_Stock_Price:  95.7471891497977
curr_Factors:  [95.74718915 -1.03317424 -1.07957623]
mat_Sqrt:  [[11.57631034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01301986 -0.0458263   0.35452643]
Stock Position:  0.013019858341470987
Bond Position:  [4.13744773]


portfolio before change:  [5.38470643]
curr_Stock_Price:  95.63771194064003
curr_Factors:  [95.63771194 -0.88348069 -1.12026883]
mat_Sqrt:  [[12.89471708  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00982176 0.01470138 0.05608875]
Stock Position:  0.009821763878925586
Bond Position:  [4.44537541]


portfolio before change:  [5.38420226]
curr_Stock_Price:  95.36002114354258
curr_Factors:  [95.36002114 -0.27321217 -1.06222897]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.38420226]
Stock Price:  97.4567779441539
PL:  [5.38420226]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 2.53308098e-02 -6.81712732e-02  1.36317373e-01]
 [-6.92615188e-02  7.39936954e-02  1.47307411e-02]
 [-8.90569814e-02  1.42215779e-02 -5.45108174e-02]
 [ 3.71812830e-02 -3.78102867e-02 -2.88200619e-01]
 [ 6.87236083e-02 -1.16623525e-01 -1.69755595e-01]
 [ 4.73168814e-02  7.22578368e-04 -1.01816881e-01]
 [ 9.01657713e-02  1.10430574e-02 -3.05160717e-01]
 [ 4.52311420e-01  2.96307022e-01 -3.32834523e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.96112275]
curr_Stock_Price:  98.45401746141323
curr_Factors:  [98.45401746 -1.39241688 -0.93906708]
mat_Sqrt:  [[ 9.56495267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0053734  -0.02155765  0.38887552]
Stock Position:  0.00537339850380179
Bond Position:  [-9.49015542]


portfolio before change:  [-8.96746411]
curr_Stock_Price:  98.15716829264812
curr_Factors:  [98.15716829 -1.06541606 -0.92921345]
mat_Sqrt:  [[13.35566243  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00481774  0.02339886  0.0420227 ]
Stock Position:  -0.0048177400555456185
Bond Position:  [-8.49456838]


portfolio before change:  [-8.98021972]
curr_Stock_Price:  99.92299057671522
curr_Factors:  [99.92299058 -0.42442242 -0.99047897]
mat_Sqrt:  [[24.27624756  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0041117   0.00449726 -0.15550419]
Stock Position:  -0.004111704478575784
Bond Position:  [-8.56936592]


portfolio before change:  [-8.98892837]
curr_Stock_Price:  100.99867440094842
curr_Factors:  [100.9986744   -0.89589323  -1.05201692]
mat_Sqrt:  [[14.39955414  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00157114 -0.01195666 -0.82215615]
Stock Position:  -0.001571137497432076
Bond Position:  [-8.83024557]


portfolio before change:  [-8.99376048]
curr_Stock_Price:  101.2633773174848
curr_Factors:  [101.26337732  -0.52363019  -1.02388479]
mat_Sqrt:  [[21.54642361  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144159 -0.0368796  -0.48426546]
Stock Position:  0.001441593582876472
Bond Position:  [-9.13974112]


portfolio before change:  [-8.99562807]
curr_Stock_Price:  103.13867947380882
curr_Factors:  [ 1.03138679e+02 -8.92844709e-02 -9.95255479e-01]
mat_Sqrt:  [[34.86678078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.61534443e-04  2.28499343e-04 -2.90455222e-01]
Stock Position:  0.000761534443460478
Bond Position:  [-9.07417173]


portfolio before change:  [-8.99897114]
curr_Stock_Price:  104.70807558444623
curr_Factors:  [ 1.04708076e+02  3.23076076e-02 -9.82462842e-01]
mat_Sqrt:  [[40.48862262  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.95509735e-04  3.49212137e-03 -8.70538586e-01]
Stock Position:  0.0006955097351460235
Bond Position:  [-9.07179663]


portfolio before change:  [-9.00014213]
curr_Stock_Price:  109.54776452894541
curr_Factors:  [109.54776453  -0.18637486  -0.96731519]
mat_Sqrt:  [[34.55909     0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01134354  0.09370051 -0.94948425]
Stock Position:  0.011343541522543417
Bond Position:  [-10.24280174]


portfolio before change:  [-9.01113143]
curr_Stock_Price:  109.03058681836505
curr_Factors:  [ 1.09030587e+02 -6.35282313e-02 -9.86256948e-01]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.01113143]
Stock Price:  110.95748139870314
PL:  [-19.96861283]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 1.17051937e-02 -4.35297908e-02  8.24050746e-02]
 [-1.50399600e-01  7.46007437e-02  4.60938992e-03]
 [-1.05003988e-01  4.35156925e-02 -6.63446467e-02]
 [ 1.36728861e-01  2.13867535e-02 -1.24308939e-02]
 [-3.19283249e-02 -7.81551817e-02 -9.60310267e-02]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 3.33338161e-01 -3.31658644e-01  4.12899966e-01]
 [ 3.78482979e-02  1.61333692e-01  7.16823766e-02]
 [-1.60257800e-01 -2.70198801e-01  3.18541208e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.04011259]
curr_Stock_Price:  98.72166812837051
curr_Factors:  [98.72166813 -0.39906004 -1.03451013]
mat_Sqrt:  [[23.5407811   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00116403 -0.01376533  0.23507874]
Stock Position:  0.001164027845869481
Bond Position:  [-7.15502736]


portfolio before change:  [-7.04161376]
curr_Stock_Price:  100.5061866216074
curr_Factors:  [100.50618662  -0.89750819  -1.04102071]
mat_Sqrt:  [[14.46439904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0101997   0.02359083  0.01314931]
Stock Position:  -0.010199699869522927
Bond Position:  [-6.01648083]


portfolio before change:  [-7.05032451]
curr_Stock_Price:  101.0651988267537
curr_Factors:  [101.06519883  -0.64542006  -1.0365497 ]
mat_Sqrt:  [[18.79885736  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00624628  0.01376087 -0.18926281]
Stock Position:  -0.006246281879672846
Bond Position:  [-6.41904279]


portfolio before change:  [-7.05940305]
curr_Stock_Price:  102.00467227549295
curr_Factors:  [102.00467228  -0.26908093  -0.97587397]
mat_Sqrt:  [[29.37264258  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00458738  0.00676309 -0.03546188]
Stock Position:  0.004587384952327378
Bond Position:  [-7.52733775]


portfolio before change:  [-7.07745685]
curr_Stock_Price:  98.88978565128659
curr_Factors:  [98.88978565  0.36952679 -0.97204358]
mat_Sqrt:  [[54.13544554  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098916 -0.02471484 -0.27394979]
Stock Position:  -0.0009891584654931455
Bond Position:  [-6.97963918]


portfolio before change:  [-7.08236644]
curr_Stock_Price:  100.32424041775064
curr_Factors:  [100.32424042   0.67216534  -0.99965468]
mat_Sqrt:  [[ 7.23067875e+01  0.00000000e+00  0.00000000e+00]
 [-8.16496581e-02  3.16227766e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [ 0.00032712 -0.00193948 -0.30510753]
Stock Position:  0.00032712012894387015
Bond Position:  [-7.11518452]


portfolio before change:  [-7.08898418]
curr_Stock_Price:  90.97214322512572
curr_Factors:  [90.97214323  0.68661797 -0.9459086 ]
mat_Sqrt:  [[70.19399149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00582753 -0.10487967  1.17788867]
Stock Position:  0.005827530476314654
Bond Position:  [-7.61912712]


portfolio before change:  [-7.1070879]
curr_Stock_Price:  88.51944090246892
curr_Factors:  [ 8.85194409e+01 -6.09878662e-02 -9.62523847e-01]
mat_Sqrt:  [[31.80776638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00178089 0.05101819 0.20448987]
Stock Position:  0.001780886437350645
Bond Position:  [-7.26473097]


portfolio before change:  [-7.11668311]
curr_Stock_Price:  85.1717042585536
curr_Factors:  [ 8.51717043e+01 -4.61383664e-02 -9.65601491e-01]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.11668311]
Stock Price:  83.00073173004819
PL:  [-7.11668311]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-9.15119499e-02  8.83742898e-02  1.57756670e-02]
 [-6.73872536e-02 -2.11462025e-02 -4.31429451e-02]
 [-9.01706941e-03 -4.38665065e-02 -2.56667205e-01]
 [ 6.87447478e-02 -1.16470861e-01 -1.69824495e-01]
 [ 6.23161424e-02  6.21584749e-02 -5.57898289e-02]
 [ 1.75478293e-01 -1.64372599e-01  1.87569637e-01]
 [ 1.20083959e-01  4.50480732e-02  1.89062009e-02]
 [-1.58955298e-01 -2.65930076e-01  3.42108991e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.01169401]
curr_Stock_Price:  99.84351091889069
curr_Factors:  [99.84351092 -0.71301359 -1.0342996 ]
mat_Sqrt:  [[17.3968801   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00354848  0.01250945 -0.27262553]
Stock Position:  -0.003548481263154794
Bond Position:  [1.36598684]


portfolio before change:  [1.01285274]
curr_Stock_Price:  99.70949176350655
curr_Factors:  [99.70949176 -0.55928414 -1.02386844]
mat_Sqrt:  [[20.47302769  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00420113  0.0279464   0.04500359]
Stock Position:  -0.004201134403592297
Bond Position:  [1.43174572]


portfolio before change:  [1.0185902]
curr_Stock_Price:  98.51424033451796
curr_Factors:  [98.51424033 -0.45674506 -1.06680061]
mat_Sqrt:  [[21.46997482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00357428 -0.00668702 -0.12307481]
Stock Position:  -0.003574282859137407
Bond Position:  [1.37070796]


portfolio before change:  [1.01537404]
curr_Stock_Price:  99.60584217597275
curr_Factors:  [99.60584218 -0.73401117 -1.03815576]
mat_Sqrt:  [[16.92943601  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00369426 -0.01387181 -0.73220009]
Stock Position:  -0.0036942560603828193
Bond Position:  [1.38334352]


portfolio before change:  [1.01688695]
curr_Stock_Price:  99.38358715087551
curr_Factors:  [99.38358715 -0.36582521 -1.11505938]
mat_Sqrt:  [[22.60344638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00137467 -0.03683132 -0.48446201]
Stock Position:  0.0013746666193091242
Bond Position:  [0.88026765]


portfolio before change:  [1.01654847]
curr_Stock_Price:  98.81710438341659
curr_Factors:  [98.81710438 -0.36920946 -1.08669468]
mat_Sqrt:  [[23.04310452  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227977  0.01965624 -0.15915285]
Stock Position:  0.0022797716408816692
Bond Position:  [0.79126803]


portfolio before change:  [1.01005172]
curr_Stock_Price:  95.79378536571656
curr_Factors:  [ 9.57937854e+01  7.10844658e-02 -1.01323198e+00]
mat_Sqrt:  [[37.33944587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00561127 -0.05197918  0.53508396]
Stock Position:  0.005611269746856315
Bond Position:  [0.47252695]


portfolio before change:  [1.01101134]
curr_Stock_Price:  95.92268561936687
curr_Factors:  [95.92268562  0.39752871 -1.0169299 ]
mat_Sqrt:  [[51.63198351  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00242304 0.01424545 0.05393413]
Stock Position:  0.0024230389573696833
Bond Position:  [0.77858693]


portfolio before change:  [0.98522809]
curr_Stock_Price:  85.121107841454
curr_Factors:  [85.12110784  0.40355125 -0.9722549 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.98522809]
Stock Price:  92.52515104603799
PL:  [0.98522809]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-2.20498823e-01  4.66697152e-02 -2.19355736e-02]
 [-1.16792974e-01  6.51716623e-02 -7.50929245e-02]
 [ 1.13036494e-01 -2.96479330e-02 -2.75247424e-01]
 [ 6.86765745e-02 -1.16963191e-01 -1.69602299e-01]
 [ 4.54691465e-02 -6.84561118e-03 -1.07486880e-01]
 [ 2.06301231e-02  9.60743647e-02 -1.30386428e-01]
 [ 2.08791222e-01  1.04443847e-01 -8.69974556e-02]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.75220966]
curr_Stock_Price:  100.0860136301994
curr_Factors:  [100.08601363  -1.01321809  -1.02454097]
mat_Sqrt:  [[13.04325168  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00473291  0.01250945 -0.27262553]
Stock Position:  -0.004732907452987919
Bond Position:  [3.2259075]


portfolio before change:  [2.74990369]
curr_Stock_Price:  100.91411433061286
curr_Factors:  [100.91411433  -1.07909431  -1.10579557]
mat_Sqrt:  [[11.35184082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01971234  0.01475826 -0.06257609]
Stock Position:  -0.019712344415162304
Bond Position:  [4.73915747]


portfolio before change:  [2.70720258]
curr_Stock_Price:  103.20056396724678
curr_Factors:  [103.20056397  -1.57775686  -1.12486008]
mat_Sqrt:  [[ 6.91752038  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01885625  0.02060909 -0.21421921]
Stock Position:  -0.0188562549194016
Bond Position:  [4.65317872]


portfolio before change:  [2.72644801]
curr_Stock_Price:  102.30334110260529
curr_Factors:  [102.3033411   -1.02857833  -1.10699828]
mat_Sqrt:  [[12.08984353  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00463913 -0.0093755  -0.78520429]
Stock Position:  0.004639128909654513
Bond Position:  [2.25184963]


portfolio before change:  [2.72397784]
curr_Stock_Price:  101.52811425304736
curr_Factors:  [101.52811425  -0.75512133  -1.13549011]
mat_Sqrt:  [[15.32866043  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00202475 -0.03698701 -0.48382815]
Stock Position:  0.0020247479362695336
Bond Position:  [2.518409]


portfolio before change:  [2.72650795]
curr_Stock_Price:  102.15564302620733
curr_Factors:  [102.15564303  -0.71754337  -1.12884626]
mat_Sqrt:  [[16.12076082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144855 -0.00216477 -0.30663015]
Stock Position:  0.0014485498794908945
Bond Position:  [2.57853041]


portfolio before change:  [2.72927158]
curr_Stock_Price:  103.17324221245775
curr_Factors:  [103.17324221  -0.51322276  -1.18216888]
mat_Sqrt:  [[18.9351107   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.85067074e-04  3.03813817e-02 -3.71956185e-01]
Stock Position:  -0.00018506707440903787
Bond Position:  [2.74836555]


portfolio before change:  [2.73045251]
curr_Stock_Price:  104.21932651120407
curr_Factors:  [104.21932651  -1.02597726  -1.19491275]
mat_Sqrt:  [[11.30909845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01713043  0.03302804 -0.24817953]
Stock Position:  0.01713042557559707
Bond Position:  [0.9451311]


portfolio before change:  [2.75542905]
curr_Stock_Price:  105.649755148265
curr_Factors:  [105.64975515  -0.64267186  -1.20301706]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.75542905]
Stock Price:  109.13925382883528
PL:  [-6.38382478]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 1.14857391e-01 -2.96219817e-03 -5.84526693e-02]
 [-4.61485074e-01 -1.91087657e-01 -3.82252121e-01]
 [-1.27330173e-01  8.45281417e-02 -8.29122861e-02]
 [ 1.87945437e-01  1.59358245e-02 -7.30428114e-02]
 [ 6.87217148e-02 -1.16637200e-01 -1.69749424e-01]
 [ 6.84929012e-02  8.74580358e-02 -3.68356950e-02]
 [ 1.53543188e-01 -1.74815644e-01  1.56640105e-01]
 [ 1.56277643e-01  8.83645118e-02  4.86465428e-04]
 [-1.24640266e-01 -1.48156838e-01  1.14745132e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.158438]
curr_Stock_Price:  102.23253391604436
curr_Factors:  [102.23253392  -0.62908442  -1.07997993]
mat_Sqrt:  [[18.50767693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00555712 -0.00093673 -0.1667492 ]
Stock Position:  0.005557115904544204
Bond Position:  [17.59031996]


portfolio before change:  [18.17540056]
curr_Stock_Price:  103.70185588837417
curr_Factors:  [103.70185589  -0.91587737  -1.08679232]
mat_Sqrt:  [[13.99710219  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03889704 -0.06042722 -1.0904589 ]
Stock Position:  -0.0388970385787448
Bond Position:  [22.20909564]


portfolio before change:  [18.16887283]
curr_Stock_Price:  104.15523349993835
curr_Factors:  [104.1552335   -1.26439645  -1.08295364]
mat_Sqrt:  [[ 9.95955434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0142649   0.02673015 -0.23652567]
Stock Position:  -0.014264901820802225
Bond Position:  [19.65463701]


portfolio before change:  [18.18973593]
curr_Stock_Price:  103.38177415492531
curr_Factors:  [103.38177415  -0.47310685  -1.13321314]
mat_Sqrt:  [[20.74092256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00836255  0.00503935 -0.20837081]
Stock Position:  0.00836255458847478
Bond Position:  [17.3252002]


portfolio before change:  [18.17224965]
curr_Stock_Price:  100.25461440271253
curr_Factors:  [ 1.00254614e+02  1.77372504e-02 -1.10274633e+00]
mat_Sqrt:  [[33.87590553  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00091688 -0.03688392 -0.48424786]
Stock Position:  0.0009168817393840858
Bond Position:  [18.08032803]


portfolio before change:  [18.17966592]
curr_Stock_Price:  98.48103893065918
curr_Factors:  [98.48103893 -0.27800029 -1.05549278]
mat_Sqrt:  [[25.95517371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0024362   0.02765666 -0.10508198]
Stock Position:  0.0024362003491274526
Bond Position:  [17.93974638]


portfolio before change:  [18.17920208]
curr_Stock_Price:  94.60781289061414
curr_Factors:  [94.60781289 -1.2747635  -1.0241529 ]
mat_Sqrt:  [[ 9.49555382  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01906192 -0.05528156  0.44685062]
Stock Position:  0.0190619208516233
Bond Position:  [16.37579544]


portfolio before change:  [18.16152669]
curr_Stock_Price:  93.25090167115964
curr_Factors:  [93.25090167 -1.38670927 -1.01932792]
mat_Sqrt:  [[ 8.40861302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01886857 0.02794331 0.00138775]
Stock Position:  0.018868570114799754
Bond Position:  [16.40201551]


portfolio before change:  [18.20468411]
curr_Stock_Price:  95.10341960777403
curr_Factors:  [95.10341961 -0.96699947 -1.0642067 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.20468411]
Stock Price:  95.84217786739539
PL:  [18.20468411]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 2.26650705e-02 -6.18335225e-02  1.22096074e-01]
 [ 3.20337549e-02  9.10033254e-02  5.19304114e-02]
 [-7.36534357e-02 -1.40742170e-02 -4.30802753e-02]
 [-4.03790542e-02 -7.41393822e-02 -3.98833295e-01]
 [ 6.98290757e-02 -1.08640147e-01 -1.73358625e-01]
 [ 7.56232878e-02  1.16663587e-01 -1.49552387e-02]
 [ 2.85929082e-02  4.38429182e-02  2.47739144e-04]
 [ 1.13455791e-01  3.15194745e-02  9.95908020e-03]
 [-8.51986132e-02 -5.90214205e-02  1.90899701e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.40301611]
curr_Stock_Price:  98.53177739023089
curr_Factors:  [98.53177739 -0.96681612 -1.00993537]
mat_Sqrt:  [[13.64847265  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0033697  -0.01955348  0.34830611]
Stock Position:  0.003369702505855485
Bond Position:  [-8.73503889]


portfolio before change:  [-8.40349228]
curr_Stock_Price:  99.68690664423872
curr_Factors:  [99.68690664 -1.25481904 -1.05910722]
mat_Sqrt:  [[ 9.85627271  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00456397 0.02877778 0.14814301]
Stock Position:  0.004563966806727425
Bond Position:  [-8.85846002]


portfolio before change:  [-8.41887853]
curr_Stock_Price:  97.28638409257745
curr_Factors:  [97.28638409 -0.85341778 -1.11063862]
mat_Sqrt:  [[13.64813172  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00606754 -0.00445066 -0.12289603]
Stock Position:  -0.006067537776686437
Bond Position:  [-7.82858972]


portfolio before change:  [-8.43006759]
curr_Stock_Price:  98.48518863986428
curr_Factors:  [98.48518864 -0.99817585 -1.16571939]
mat_Sqrt:  [[11.31366096  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01093411 -0.02344493 -1.13776038]
Stock Position:  -0.010934111492691058
Bond Position:  [-7.35321956]


portfolio before change:  [-8.4318311]
curr_Stock_Price:  98.31013822400669
curr_Factors:  [98.31013822 -1.1378348  -1.12402887]
mat_Sqrt:  [[10.23960958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0030897  -0.03435503 -0.4945439 ]
Stock Position:  0.0030896996473509008
Bond Position:  [-8.7355799]


portfolio before change:  [-8.43650849]
curr_Stock_Price:  98.21028893991638
curr_Factors:  [98.21028894 -0.87358362 -1.1110707 ]
mat_Sqrt:  [[13.49685462  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00560003  0.03689227 -0.04266313]
Stock Position:  0.0056000309329277765
Bond Position:  [-8.98648914]


portfolio before change:  [-8.4338142]
curr_Stock_Price:  99.49397086046541
curr_Factors:  [99.49397086 -1.07173974 -1.11608834]
mat_Sqrt:  [[11.15925244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00266823 0.01386435 0.00070673]
Stock Position:  0.0026682340238309483
Bond Position:  [-8.69928739]


portfolio before change:  [-8.43259181]
curr_Stock_Price:  101.58266389571796
curr_Factors:  [101.5826639   -1.43930519  -1.13276826]
mat_Sqrt:  [[ 7.75858092  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01499018 0.00996733 0.02841048]
Stock Position:  0.014990178008808322
Bond Position:  [-9.95533402]


portfolio before change:  [-8.44772024]
curr_Stock_Price:  100.90558571226222
curr_Factors:  [100.90558571  -1.35873592  -1.1217223 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.44772024]
Stock Price:  100.84364757818156
PL:  [-9.29136782]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 7.22589388e-02 -1.24947896e-01  2.53960051e-01]
 [ 5.55698196e-02  7.89205711e-02  5.24167232e-02]
 [-9.43246157e-02  2.38980449e-02 -5.84197820e-02]
 [-4.26148516e-02 -8.22371429e-02 -4.40060042e-01]
 [ 6.96507980e-02 -1.09927619e-01 -1.72777568e-01]
 [ 7.09964466e-02  9.77123779e-02 -2.91532623e-02]
 [-1.38420955e-02  1.05389148e-01 -5.28106034e-02]
 [ 9.16241882e-02  2.19024638e-02  8.86240373e-03]
 [-9.65319451e-02 -7.06384175e-02  2.21231766e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.68507154]
curr_Stock_Price:  97.93516680997035
curr_Factors:  [97.93516681 -1.16170579 -0.99630064]
mat_Sqrt:  [[11.31692366  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01068066 -0.03951199  0.72447734]
Stock Position:  0.010680656670168969
Bond Position:  [-13.73108343]


portfolio before change:  [-12.68005337]
curr_Stock_Price:  99.04796595337693
curr_Factors:  [99.04796595 -1.32289895 -0.96860586]
mat_Sqrt:  [[10.01515487  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00682037 0.02495688 0.14953032]
Stock Position:  0.006820369702770085
Bond Position:  [-13.35559712]


portfolio before change:  [-12.69485343]
curr_Stock_Price:  97.85732858997441
curr_Factors:  [97.85732859 -1.39664208 -0.88898632]
mat_Sqrt:  [[ 9.95308137  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01061304  0.00755723 -0.16665538]
Stock Position:  -0.010613040826643353
Bond Position:  [-11.6562896]


portfolio before change:  [-12.71327112]
curr_Stock_Price:  99.04342496868182
curr_Factors:  [99.04342497 -1.1991718  -0.90592937]
mat_Sqrt:  [[12.06679206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01115169 -0.02600567 -1.25536881]
Stock Position:  -0.011151686763653376
Bond Position:  [-11.60876987]


portfolio before change:  [-12.71581323]
curr_Stock_Price:  98.75075840182537
curr_Factors:  [98.7507584  -1.66613983 -0.96228199]
mat_Sqrt:  [[ 7.12904484  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00442477 -0.03476217 -0.49288631]
Stock Position:  0.00442477309450234
Bond Position:  [-13.15276293]


portfolio before change:  [-12.72144901]
curr_Stock_Price:  98.9637066565867
curr_Factors:  [98.96370666 -2.21325303 -0.95714653]
mat_Sqrt:  [[ 4.15517118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0162613   0.03089937 -0.08316614]
Stock Position:  0.016261299868274844
Bond Position:  [-14.33072752]


portfolio before change:  [-12.73070393]
curr_Stock_Price:  98.83531812538253
curr_Factors:  [98.83531813 -2.20676586 -0.96643068]
mat_Sqrt:  [[ 4.13818991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00529238  0.03332697 -0.15065395]
Stock Position:  -0.005292381239165405
Bond Position:  [-12.20762974]


portfolio before change:  [-12.73642899]
curr_Stock_Price:  98.7634644196527
curr_Factors:  [98.76346442 -1.35136208 -0.92637028]
mat_Sqrt:  [[10.1248762   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00928394 0.00692617 0.02528197]
Stock Position:  0.009283939482816302
Bond Position:  [-13.65334302]


portfolio before change:  [-12.7396436]
curr_Stock_Price:  99.1527133757522
curr_Factors:  [99.15271338 -1.09160391 -0.9292466 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.7396436]
Stock Price:  99.92941248037467
PL:  [-12.7396436]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-2.59586233e-01  1.51355290e-02 -7.72251366e-02]
 [-1.04442734e-01  4.24846870e-02 -6.59281555e-02]
 [ 7.96031401e-02 -5.81460989e-02 -4.19656406e-01]
 [ 6.77764799e-02 -1.23463424e-01 -1.66668637e-01]
 [ 3.61008357e-02 -1.84515666e-02 -1.05769780e-01]
 [ 3.93849230e-02  9.63152790e-02 -1.35652746e-01]
 [ 1.75402202e-01  7.94264073e-02 -5.47599835e-02]
 [-9.22351274e-02 -6.65165184e-02  1.69418295e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.28874797]
curr_Stock_Price:  100.71808082416169
curr_Factors:  [100.71808082  -1.26731371  -0.93784923]
mat_Sqrt:  [[11.1024121   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00556028  0.01250945 -0.27262553]
Stock Position:  -0.005560278479031431
Bond Position:  [7.84876855]


portfolio before change:  [7.28927384]
curr_Stock_Price:  101.32947031703907
curr_Factors:  [101.32947032  -1.81690377  -0.97091645]
mat_Sqrt:  [[ 6.2373603   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04408258  0.00478627 -0.22030182]
Stock Position:  -0.044082582562812535
Bond Position:  [11.75613858]


portfolio before change:  [7.29752828]
curr_Stock_Price:  101.27559647724952
curr_Factors:  [101.27559648  -1.41184281  -0.9869235 ]
mat_Sqrt:  [[ 9.19885633  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01269759  0.01343484 -0.18807468]
Stock Position:  -0.012697590655442244
Bond Position:  [8.58348435]


portfolio before change:  [7.28643466]
curr_Stock_Price:  102.4873563776756
curr_Factors:  [102.48735638  -1.49614993  -0.95840717]
mat_Sqrt:  [[ 8.80379023  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.58742730e-04 -1.83874109e-02 -1.19716292e+00]
Stock Position:  -0.0008587427304929652
Bond Position:  [7.37444494]


portfolio before change:  [7.28960844]
curr_Stock_Price:  103.08633407509629
curr_Factors:  [103.08633408  -1.3257781   -0.94128505]
mat_Sqrt:  [[10.68139759  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00286176 -0.03904256 -0.47545923]
Stock Position:  0.0028617579854459084
Bond Position:  [6.9946003]


portfolio before change:  [7.29376374]
curr_Stock_Price:  103.3159559766546
curr_Factors:  [103.31595598  -1.58707941  -0.91818563]
mat_Sqrt:  [[ 8.4361562   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00166358 -0.0058349  -0.30173174]
Stock Position:  0.0016635837440134183
Bond Position:  [7.12188899]


portfolio before change:  [7.29507289]
curr_Stock_Price:  101.96184049967562
curr_Factors:  [101.9618405   -1.25881059  -0.89155882]
mat_Sqrt:  [[11.87255242  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011945   0.03045757 -0.38697953]
Stock Position:  0.0011945006811949412
Bond Position:  [7.1732794]


portfolio before change:  [7.29950192]
curr_Stock_Price:  102.6663177340801
curr_Factors:  [102.66631773  -1.02340617  -0.89454714]
mat_Sqrt:  [[15.08243443  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01102442  0.02511684 -0.15621499]
Stock Position:  0.01102442373592746
Bond Position:  [6.16766493]


portfolio before change:  [7.27685012]
curr_Stock_Price:  100.33182738291181
curr_Factors:  [100.33182738  -0.95637162  -0.90887975]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.27685012]
Stock Price:  99.03140905307396
PL:  [7.27685012]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-5.46089704e-02  7.56608425e-02  1.97081722e-02]
 [-1.01281977e-01  3.66784830e-02 -6.35826459e-02]
 [-7.56703247e-03 -5.89574949e-02 -3.36784596e-01]
 [ 6.87236431e-02 -1.16623274e-01 -1.69755709e-01]
 [ 4.72280785e-02  3.58847972e-04 -1.02089384e-01]
 [ 5.43615419e-02  7.65952454e-02  3.51331618e-02]
 [ 8.67620880e-02  1.97606665e-02  8.61816372e-03]
 [-1.00071773e-01 -8.06107776e-02  1.87336898e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.38374436]
curr_Stock_Price:  100.17400415079064
curr_Factors:  [100.17400415  -1.04062725  -0.9793894 ]
mat_Sqrt:  [[13.28840786  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00464559  0.01250945 -0.27262553]
Stock Position:  -0.0046455906311459174
Bond Position:  [3.84911178]


portfolio before change:  [3.3938015]
curr_Stock_Price:  98.4235046318252
curr_Factors:  [98.42350463 -0.96558443 -0.98398363]
mat_Sqrt:  [[14.0091626   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347148  0.02392606  0.05622193]
Stock Position:  -0.0034714781592759276
Bond Position:  [3.73547655]


portfolio before change:  [3.38885024]
curr_Stock_Price:  100.38793202723383
curr_Factors:  [100.38793203  -1.66831131  -0.99694424]
mat_Sqrt:  [[ 6.98514992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01622209  0.01159875 -0.18138359]
Stock Position:  -0.016222085000441925
Bond Position:  [5.01735181]


portfolio before change:  [3.39861107]
curr_Stock_Price:  99.94091658501283
curr_Factors:  [99.94091659 -0.98815058 -0.99718438]
mat_Sqrt:  [[13.72534623  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00567091 -0.018644   -0.96075271]
Stock Position:  -0.005670908037406243
Bond Position:  [3.96536681]


portfolio before change:  [3.39299255]
curr_Stock_Price:  101.28138930611422
curr_Factors:  [101.28138931  -1.14086784  -0.9843589 ]
mat_Sqrt:  [[12.09359455  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0025684  -0.03687952 -0.48426579]
Stock Position:  0.002568401314743319
Bond Position:  [3.1328613]


portfolio before change:  [3.3912534]
curr_Stock_Price:  99.99421736135598
curr_Factors:  [99.99421736 -1.06300284 -1.00891052]
mat_Sqrt:  [[12.59372913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.09615718e-03  1.13477692e-04 -2.91232596e-01]
Stock Position:  0.0020961571799971044
Bond Position:  [3.1816498]


portfolio before change:  [3.39294701]
curr_Stock_Price:  100.0430643532299
curr_Factors:  [100.04306435  -0.8367012   -1.00666601]
mat_Sqrt:  [[15.83517175  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00401074 0.02422154 0.10022513]
Stock Position:  0.004010739523300282
Bond Position:  [2.99170034]


portfolio before change:  [3.38949723]
curr_Stock_Price:  98.80987374285766
curr_Factors:  [98.80987374 -0.83163995 -1.00221902]
mat_Sqrt:  [[15.78939587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00563869 0.00624887 0.02458522]
Stock Position:  0.005638688280623718
Bond Position:  [2.83233915]


portfolio before change:  [3.39229666]
curr_Stock_Price:  99.05512673785769
curr_Factors:  [99.05512674 -1.15490596 -1.01000799]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.39229666]
Stock Price:  98.91076057008596
PL:  [3.39229666]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.60967331e-02  3.73113713e-02 -8.89177149e-02]
 [-8.45522965e-02  9.63196501e-02  2.17788670e-02]
 [-7.06364069e-02  4.40392878e-03 -6.04688491e-02]
 [ 1.37988537e-01  2.14136130e-02 -1.31752551e-02]
 [ 6.12896715e-02 -1.22722774e-01 -1.53259912e-01]
 [ 4.51556185e-02 -8.12979956e-03 -1.08448979e-01]
 [ 4.61974268e-02  8.56623361e-02 -1.56971581e-01]
 [ 1.36904261e-01  4.18487291e-02  1.11369775e-02]
 [-7.00760505e-02 -3.26610221e-02  3.38520842e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.12645451]
curr_Stock_Price:  99.54560678092467
curr_Factors:  [99.54560678 -0.78667722 -1.03902608]
mat_Sqrt:  [[16.03722533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00394604  0.01179889 -0.25365749]
Stock Position:  -0.003946044835808281
Bond Position:  [-0.73364308]


portfolio before change:  [-1.12875853]
curr_Stock_Price:  100.0365043551456
curr_Factors:  [100.03650436  -0.8246425   -1.00002689]
mat_Sqrt:  [[16.13298243  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00481125  0.03045895  0.06212905]
Stock Position:  -0.004811245633866611
Bond Position:  [-0.64745833]


portfolio before change:  [-1.12746327]
curr_Stock_Price:  99.69998786102752
curr_Factors:  [99.69998786 -0.14303598 -0.97862107]
mat_Sqrt:  [[32.47623228  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00255158  0.00139264 -0.1725008 ]
Stock Position:  -0.00255158447464338
Bond Position:  [-0.87307033]


portfolio before change:  [-1.13383141]
curr_Stock_Price:  102.02461941138375
curr_Factors:  [102.02461941  -0.29998235  -0.9944133 ]
mat_Sqrt:  [[27.96121863  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00485859  0.00677158 -0.03758534]
Stock Position:  0.004858588195069818
Bond Position:  [-1.62952702]


portfolio before change:  [-1.11621519]
curr_Stock_Price:  105.81814782930174
curr_Factors:  [105.81814783  -0.27834636  -1.01833494]
mat_Sqrt:  [[28.93467595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0009275  -0.03880835 -0.43720787]
Stock Position:  0.0009275007826534251
Bond Position:  [-1.2143616]


portfolio before change:  [-1.1204903]
curr_Stock_Price:  101.86366965319183
curr_Factors:  [101.86366965  -0.61257579  -1.02425204]
mat_Sqrt:  [[19.82229913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115066 -0.00257087 -0.30937475]
Stock Position:  0.0011506562751634904
Bond Position:  [-1.23770037]


portfolio before change:  [-1.11969363]
curr_Stock_Price:  103.0939938761201
curr_Factors:  [103.09399388  -1.14132806  -0.96588118]
mat_Sqrt:  [[12.53383639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00130587  0.02708881 -0.44779623]
Stock Position:  0.0013058674494690159
Bond Position:  [-1.25432072]


portfolio before change:  [-1.12085491]
curr_Stock_Price:  102.68509468388817
curr_Factors:  [102.68509468  -1.86131524  -0.86958275]
mat_Sqrt:  [[ 6.69103778  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02096209 0.01323373 0.0317707 ]
Stock Position:  0.020962087049940983
Bond Position:  [-3.2733488]


portfolio before change:  [-1.13907702]
curr_Stock_Price:  101.8939030771284
curr_Factors:  [101.89390308  -1.20913223  -0.82943384]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.13907702]
Stock Price:  101.76485456711923
PL:  [-2.90393159]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.82629925e-02  3.56036485e-02 -8.38643810e-02]
 [-2.91331820e-02  9.19347529e-02  3.51663214e-02]
 [-1.00435420e-01  3.51233870e-02 -6.29544398e-02]
 [ 1.33217885e-01  2.13548405e-02 -1.18757713e-02]
 [ 6.78435057e-02 -1.22979382e-01 -1.66887093e-01]
 [ 4.42814361e-02 -1.17103879e-02 -1.11131513e-01]
 [ 1.25537101e-01 -1.04909773e-02  1.24740787e-01]
 [ 1.08505495e-01  3.00255628e-02  1.02680264e-02]
 [-1.02040435e-01 -7.59980636e-02  1.49011784e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.93840627]
curr_Stock_Price:  99.43247909720164
curr_Factors:  [99.4324791  -1.09761166 -1.01444134]
mat_Sqrt:  [[12.03026815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00535836  0.01125886 -0.23924174]
Stock Position:  -0.005358355650497311
Bond Position:  [-1.40561169]


portfolio before change:  [-1.94115767]
curr_Stock_Price:  99.81476448057926
curr_Factors:  [99.81476448 -1.00424654 -1.00933882]
mat_Sqrt:  [[13.32618308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146937  0.02907232  0.10031973]
Stock Position:  -0.0014693735962113639
Bond Position:  [-1.79449249]


portfolio before change:  [-1.94340127]
curr_Stock_Price:  100.73088955623027
curr_Factors:  [100.73088956  -0.59120822  -0.97517702]
mat_Sqrt:  [[21.03246635  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00534312  0.01110699 -0.17959149]
Stock Position:  -0.0053431232246863546
Bond Position:  [-1.40518372]


portfolio before change:  [-1.9506926]
curr_Stock_Price:  101.96397994649692
curr_Factors:  [101.96397995  -0.32263445  -0.98994391]
mat_Sqrt:  [[27.44108258  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00478644  0.00675299 -0.03387827]
Stock Position:  0.0047864413627611915
Bond Position:  [-2.43873721]


portfolio before change:  [-1.94680434]
curr_Stock_Price:  103.03114655950536
curr_Factors:  [103.03114656  -0.23827725  -1.08569015]
mat_Sqrt:  [[27.41427694  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011163  -0.0388895  -0.47608242]
Stock Position:  0.001116298142513363
Bond Position:  [-2.06181782]


portfolio before change:  [-1.94865377]
curr_Stock_Price:  102.2981304310884
curr_Factors:  [ 1.02298130e+02  6.68838846e-02 -1.04513771e+00]
mat_Sqrt:  [[38.46072428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00055367 -0.00370315 -0.31702727]
Stock Position:  0.0005536674205241549
Bond Position:  [-2.00529291]


portfolio before change:  [-1.9514903]
curr_Stock_Price:  98.98632866701368
curr_Factors:  [98.98632867  0.29908519 -1.01858745]
mat_Sqrt:  [[48.2058069   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00312678 -0.00331754  0.35585074]
Stock Position:  0.003126777493752441
Bond Position:  [-2.26099853]


portfolio before change:  [-1.95889753]
curr_Stock_Price:  96.97900848104516
curr_Factors:  [96.97900848  0.54804425 -1.00366189]
mat_Sqrt:  [[61.49014479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00181129 0.00949492 0.02929182]
Stock Position:  0.0018112935768818113
Bond Position:  [-2.13455498]


portfolio before change:  [-1.96148382]
curr_Stock_Price:  96.1405238331071
curr_Factors:  [96.14052383  0.50077903 -0.97003821]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.96148382]
Stock Price:  97.164410762208
PL:  [-1.96148382]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-2.93380283e-01 -1.86887368e-02 -1.27045396e-01]
 [-1.13610946e-01  5.93263840e-02 -7.27316302e-02]
 [ 1.61644752e-01  6.52706969e-03 -1.17881587e-01]
 [ 6.80236980e-02 -1.21678083e-01 -1.67474391e-01]
 [ 4.47262847e-02 -9.88831979e-03 -1.09766441e-01]
 [ 4.41770808e-02  7.86038765e-02 -1.69110634e-01]
 [ 2.86212089e-01  1.62905790e-01 -1.63237422e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.5872951]
curr_Stock_Price:  100.89900490742647
curr_Factors:  [100.89900491  -1.12066848  -1.01420537]
mat_Sqrt:  [[11.93226666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00517358  0.01250945 -0.27262553]
Stock Position:  -0.005173577227104987
Bond Position:  [9.10930389]


portfolio before change:  [8.58797303]
curr_Stock_Price:  101.64855429662808
curr_Factors:  [101.6485543   -1.16509389  -0.98872673]
mat_Sqrt:  [[11.79529467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02711215 -0.0059099  -0.36242515]
Stock Position:  -0.027112154974897572
Bond Position:  [11.34388439]


portfolio before change:  [8.5886454]
curr_Stock_Price:  101.8330100261527
curr_Factors:  [101.83301003  -0.84262588  -0.9585189 ]
mat_Sqrt:  [[16.81362449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00754896  0.01876065 -0.2074831 ]
Stock Position:  -0.007548962872942103
Bond Position:  [9.35737901]


portfolio before change:  [8.58487945]
curr_Stock_Price:  102.95181465154795
curr_Factors:  [102.95181465  -0.61371681  -0.94103324]
mat_Sqrt:  [[21.74776538  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00633402  0.00206404 -0.33628335]
Stock Position:  0.006334020981777224
Bond Position:  [7.93278049]


portfolio before change:  [8.5874887]
curr_Stock_Price:  102.73739708550761
curr_Factors:  [102.73739709  -0.35214391  -1.0006201 ]
mat_Sqrt:  [[26.56015574  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115573 -0.03847799 -0.47775782]
Stock Position:  0.0011557317970123666
Bond Position:  [8.46875183]


portfolio before change:  [8.59138061]
curr_Stock_Price:  102.44016042042581
curr_Factors:  [102.44016042  -0.71101832  -0.99970603]
mat_Sqrt:  [[18.5145051   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00119177 -0.00312696 -0.3131331 ]
Stock Position:  0.0011917676581146175
Bond Position:  [8.46929574]


portfolio before change:  [8.59665264]
curr_Stock_Price:  103.30972522709074
curr_Factors:  [103.30972523  -0.77744711  -1.0340716 ]
mat_Sqrt:  [[16.8814065   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0006923   0.02485673 -0.48242557]
Stock Position:  0.0006923037214496968
Bond Position:  [8.52513093]


portfolio before change:  [8.60255371]
curr_Stock_Price:  105.67492443023126
curr_Factors:  [105.67492443  -0.76905761  -1.03078128]
mat_Sqrt:  [[17.47076196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01471588  0.05151533 -0.46567093]
Stock Position:  0.014715877847593125
Bond Position:  [7.04745443]


portfolio before change:  [8.62491738]
curr_Stock_Price:  106.9551110027996
curr_Factors:  [106.955111    -0.67558173  -1.00937715]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.62491738]
Stock Price:  107.34900869325809
PL:  [1.27590869]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-2.74152153e-01  5.20254203e-02 -3.52712070e-02]
 [-8.48480830e-02  6.48997332e-03 -5.13875112e-02]
 [ 6.01992933e-02 -3.45561212e-02 -2.83174166e-01]
 [ 6.87237817e-02 -1.16622273e-01 -1.69756161e-01]
 [ 4.60767047e-02 -4.35709651e-03 -1.05622514e-01]
 [ 3.21350551e-02  9.96499076e-02 -1.27423710e-01]
 [ 2.72804483e-01  1.50410539e-01 -1.42234655e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.93458345]
curr_Stock_Price:  100.1114234207902
curr_Factors:  [100.11142342  -0.79449326  -1.07951999]
mat_Sqrt:  [[15.36774064  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00401702  0.01250945 -0.27262553]
Stock Position:  -0.004017018800669023
Bond Position:  [3.33673292]


portfolio before change:  [2.93359128]
curr_Stock_Price:  100.77384245605127
curr_Factors:  [100.77384246  -0.2323431   -1.12065571]
mat_Sqrt:  [[26.04641175  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01075037  0.01645188 -0.10061894]
Stock Position:  -0.01075037016915158
Bond Position:  [4.01694739]


portfolio before change:  [2.94921601]
curr_Stock_Price:  99.50730470622271
curr_Factors:  [99.50730471 -0.62277144 -1.05939204]
mat_Sqrt:  [[18.50549237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00514279  0.00205231 -0.14659427]
Stock Position:  -0.005142794503347917
Bond Position:  [3.46096163]


portfolio before change:  [2.9415385]
curr_Stock_Price:  101.33674137070689
curr_Factors:  [101.33674137  -0.91030149  -1.11912186]
mat_Sqrt:  [[13.31679058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.12968172e-04 -1.09276050e-02 -8.07817075e-01]
Stock Position:  0.00011296817244091703
Bond Position:  [2.93009068]


portfolio before change:  [2.9430147]
curr_Stock_Price:  101.4322295067734
curr_Factors:  [101.43222951  -0.3616446   -1.11384454]
mat_Sqrt:  [[23.19418833  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00133918 -0.0368792  -0.48426708]
Stock Position:  0.0013391835902402652
Bond Position:  [2.80717832]


portfolio before change:  [2.94709124]
curr_Stock_Price:  103.42792231836036
curr_Factors:  [103.42792232  -0.67684444  -1.11724188]
mat_Sqrt:  [[17.19792355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00141901 -0.00137783 -0.30131163]
Stock Position:  0.0014190143084502305
Bond Position:  [2.80032554]


portfolio before change:  [2.94937444]
curr_Stock_Price:  104.0499637452327
curr_Factors:  [104.04996375  -1.16038264  -1.12826667]
mat_Sqrt:  [[10.55101327  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00082435  0.03151207 -0.36350438]
Stock Position:  0.0008243519927112672
Bond Position:  [2.86360064]


portfolio before change:  [2.95253542]
curr_Stock_Price:  106.14714946266746
curr_Factors:  [106.14714946  -1.0145708   -1.18550494]
mat_Sqrt:  [[11.76054869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02105808  0.04756399 -0.40575588]
Stock Position:  0.021058076955695625
Bond Position:  [0.71728057]


portfolio before change:  [2.99848328]
curr_Stock_Price:  108.31207321685595
curr_Factors:  [108.31207322  -1.02395081  -1.1732424 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.99848328]
Stock Price:  106.86093452102902
PL:  [-3.86245124]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-7.31176717e-02  7.29903053e-02  1.31335798e-02]
 [-7.37505505e-02 -1.01188634e-02 -4.71623165e-02]
 [-1.91984889e-01 -3.52449121e-02 -1.48793255e-01]
 [-1.51990547e-01  2.06021368e-01  3.15967265e-01]
 [ 3.04847376e-01  1.97604260e-01 -2.54495721e-01]
 [ 5.65603088e-01 -5.83070149e-01  7.44604203e-01]
 [-1.03858943e-01  2.46004764e-01  1.57473456e-01]
 [-1.59111197e-01 -2.66315328e-01  3.43652125e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.24356295]
curr_Stock_Price:  100.4331291117883
curr_Factors:  [100.43312911  -0.80345711  -0.92919793]
mat_Sqrt:  [[17.75801715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347632  0.01250945 -0.27262553]
Stock Position:  -0.00347631734715553
Bond Position:  [5.59270038]


portfolio before change:  [5.25297658]
curr_Stock_Price:  98.52979705029924
curr_Factors:  [98.52979705 -0.77643031 -0.92743672]
mat_Sqrt:  [[17.9302994   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00382326  0.02308156  0.03746645]
Stock Position:  -0.0038232596044902927
Bond Position:  [5.62968157]


portfolio before change:  [5.27234732]
curr_Stock_Price:  94.19967205585512
curr_Factors:  [94.19967206 -1.13565953 -0.84063473]
mat_Sqrt:  [[13.05436348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00640696 -0.00319987 -0.13454096]
Stock Position:  -0.006406960102824215
Bond Position:  [5.87588086]


portfolio before change:  [5.27940558]
curr_Stock_Price:  93.55668557958721
curr_Factors:  [93.55668558 -0.4102233  -0.80048616]
mat_Sqrt:  [[27.87856348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00800856 -0.01114542 -0.42446574]
Stock Position:  -0.0080085620112451
Bond Position:  [6.0286601]


portfolio before change:  [5.28910446]
curr_Stock_Price:  92.72210394125538
curr_Factors:  [92.72210394 -0.21904923 -0.81279497]
mat_Sqrt:  [[33.04144512  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00248701  0.06514968  0.90136666]
Stock Position:  -0.002487014419023801
Bond Position:  [5.51970567]


portfolio before change:  [5.31001716]
curr_Stock_Price:  85.4233319295677
curr_Factors:  [85.42333193 -0.34977598 -0.76011189]
mat_Sqrt:  [[28.15518148  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00916353  0.06248795 -0.72600545]
Stock Position:  0.009163527321631287
Bond Position:  [4.52723812]


portfolio before change:  [5.28298747]
curr_Stock_Price:  82.22654146659859
curr_Factors:  [82.22654147 -0.19965858 -0.74308254]
mat_Sqrt:  [[32.03205189  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02193241 -0.18438297  2.12414853]
Stock Position:  0.021932406351791417
Bond Position:  [3.47956155]


portfolio before change:  [5.29899735]
curr_Stock_Price:  82.87716182552927
curr_Factors:  [82.87716183 -0.45465754 -0.71373295]
mat_Sqrt:  [[25.76376503  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253701  0.07779354  0.44922794]
Stock Position:  -0.002537012436622229
Bond Position:  [5.50925774]


portfolio before change:  [5.29460451]
curr_Stock_Price:  85.69471362123859
curr_Factors:  [85.69471362 -0.7274853  -0.73211911]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.29460451]
Stock Price:  82.46798519663994
PL:  [5.29460451]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.78023441e-02  3.59667905e-02 -8.49389568e-02]
 [ 3.60656738e-02  7.63823839e-02  4.56289243e-02]
 [-8.45223778e-02  5.89166374e-03 -5.11458144e-02]
 [ 7.33971453e-02 -4.09865307e-02 -2.93925880e-01]
 [-2.27153589e-02 -7.88281893e-02 -1.03725691e-01]
 [ 1.47378502e-01  1.56146641e-01 -7.70530340e-02]
 [ 1.81475780e-01 -1.61136373e-01  1.96051831e-01]
 [ 1.26066006e-01  4.42114178e-02 -1.28863452e-02]
 [-8.61751867e-02 -5.88259616e-02  2.00146374e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.16708218]
curr_Stock_Price:  99.53994620493017
curr_Factors:  [99.5399462  -1.17818458 -0.92657102]
mat_Sqrt:  [[12.13147652  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00529299  0.0113737  -0.2423072 ]
Stock Position:  -0.005292989475087596
Bond Position:  [-0.6402183]


portfolio before change:  [-1.16505334]
curr_Stock_Price:  99.09614468131005
curr_Factors:  [99.09614468 -1.16679311 -0.91403536]
mat_Sqrt:  [[12.36985017  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.003828   0.02415423 0.13016662]
Stock Position:  0.0038280030108445635
Bond Position:  [-1.54439368]


portfolio before change:  [-1.1646224]
curr_Stock_Price:  99.41049277609517
curr_Factors:  [99.41049278 -0.76126943 -0.93805791]
mat_Sqrt:  [[18.17287924  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00521713  0.00186311 -0.14590477]
Stock Position:  -0.005217134285934073
Bond Position:  [-0.64598451]


portfolio before change:  [-1.14742602]
curr_Stock_Price:  96.0524313065237
curr_Factors:  [96.05243131 -0.36136472 -0.85808564]
mat_Sqrt:  [[28.37316615  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.34971142e-04 -1.29610790e-02 -8.38488724e-01]
Stock Position:  0.00043497114205628544
Bond Position:  [-1.18920605]


portfolio before change:  [-1.14721954]
curr_Stock_Price:  97.89446541266932
curr_Factors:  [97.89446541 -0.29109121 -0.91599578]
mat_Sqrt:  [[29.27702342  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00156859 -0.02492766 -0.29590053]
Stock Position:  -0.0015685888344327704
Bond Position:  [-0.99366337]


portfolio before change:  [-1.14028644]
curr_Stock_Price:  93.15769328375194
curr_Factors:  [93.15769328 -0.20449196 -0.92037219]
mat_Sqrt:  [[30.24798385  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00448565  0.0493779  -0.21981086]
Stock Position:  0.004485647922394662
Bond Position:  [-1.55815906]


portfolio before change:  [-1.1296664]
curr_Stock_Price:  95.69898103681547
curr_Factors:  [ 9.56989810e+01 -9.59941619e-03 -9.29411003e-01]
mat_Sqrt:  [[37.41969729  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00580802 -0.0509558   0.5592813 ]
Stock Position:  0.005808015161819894
Bond Position:  [-1.68548753]


portfolio before change:  [-1.0981568]
curr_Stock_Price:  101.26930868482926
curr_Factors:  [101.26930868  -1.01801763  -0.94137003]
mat_Sqrt:  [[14.27337236  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00872794  0.01398088 -0.03676116]
Stock Position:  0.00872793920062473
Bond Position:  [-1.98202917]


portfolio before change:  [-1.10321703]
curr_Stock_Price:  100.80310824313803
curr_Factors:  [100.80310824  -1.17135044  -0.99571742]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.10321703]
Stock Price:  99.3843187146921
PL:  [-1.10321703]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 6.08519493e-02 -1.11339558e-01  2.25830603e-01]
 [ 3.18456826e-03  7.69970691e-02  3.66751476e-02]
 [-8.40861703e-02  5.09036519e-03 -5.08221169e-02]
 [ 1.15540355e-02 -4.65555331e-02 -2.86810758e-01]
 [-1.07885835e-01  3.59426328e-02  6.73366009e-02]
 [ 7.04856302e-02  9.56201109e-02 -3.07207642e-02]
 [ 1.12022428e-01 -3.40050960e-02  1.06203817e-01]
 [ 1.13536063e-01  3.25515766e-02  6.68410619e-03]
 [-8.34963364e-02 -5.11190314e-02  2.56353637e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.68312832]
curr_Stock_Price:  98.07476563892136
curr_Factors:  [98.07476564 -1.06962155 -0.96291468]
mat_Sqrt:  [[12.84807346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00810041 -0.03520866  0.64423185]
Stock Position:  0.008100409247578176
Bond Position:  [-12.47757406]


portfolio before change:  [-11.68267329]
curr_Stock_Price:  98.90131430949019
curr_Factors:  [98.90131431 -1.04810507 -0.97380804]
mat_Sqrt:  [[13.09472425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00096672 0.02434861 0.10462399]
Stock Position:  0.0009667181183800342
Bond Position:  [-11.77828298]


portfolio before change:  [-11.6896037]
curr_Stock_Price:  97.8257148962263
curr_Factors:  [97.8257149  -1.00716328 -0.93205614]
mat_Sqrt:  [[14.06891925  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00670476  0.00160971 -0.14498135]
Stock Position:  -0.006704762255435486
Bond Position:  [-11.03370554]


portfolio before change:  [-11.68129511]
curr_Stock_Price:  95.76347574851306
curr_Factors:  [95.76347575 -0.47118521 -0.94859805]
mat_Sqrt:  [[23.15239189  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208156 -0.01472215 -0.81819126]
Stock Position:  -0.00208155702324153
Bond Position:  [-11.48195798]


portfolio before change:  [-11.68711957]
curr_Stock_Price:  95.80289038556744
curr_Factors:  [95.80289039 -0.16639319 -0.97689555]
mat_Sqrt:  [[30.53898637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305226  0.01136606  0.19209258]
Stock Position:  -0.0030522550241786827
Bond Position:  [-11.39470472]


portfolio before change:  [-11.70097979]
curr_Stock_Price:  98.47679516443513
curr_Factors:  [98.47679516 -0.28733951 -0.93442638]
mat_Sqrt:  [[29.02202595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00229769  0.03023773 -0.08763779]
Stock Position:  0.002297692148702408
Bond Position:  [-11.92724915]


portfolio before change:  [-11.70625317]
curr_Stock_Price:  98.777848639349
curr_Factors:  [98.77784864 -0.39265293 -0.95125045]
mat_Sqrt:  [[25.76378928  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00515542 -0.01075336  0.30296993]
Stock Position:  0.005155421128145138
Bond Position:  [-12.21549458]


portfolio before change:  [-11.69884395]
curr_Stock_Price:  101.40003882999278
curr_Factors:  [101.40003883  -1.22519838  -0.97098378]
mat_Sqrt:  [[11.27842173  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01026216 0.01029371 0.01906789]
Stock Position:  0.01026215645068734
Bond Position:  [-12.73942702]


portfolio before change:  [-11.71370389]
curr_Stock_Price:  100.57286077387492
curr_Factors:  [100.57286077  -1.30872316  -1.02704931]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.71370389]
Stock Price:  100.68497129814699
PL:  [-12.39867519]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-1.03909599e-01  8.92828208e-02  1.27439674e-02]
 [ 1.13031209e-01  6.81829242e-02 -2.04494801e-01]
 [-1.61092501e-01 -2.05528569e-02 -9.01022982e-02]
 [-2.27561977e-01  5.75637667e-01  8.90682545e-01]
 [ 3.46854536e-01  2.13549966e-01 -3.00074791e-01]
 [ 4.61285386e-01 -4.90809427e-01  5.95904265e-01]
 [-6.32446529e-02  2.21737441e-01  1.32885131e-01]
 [-1.65790817e-01 -2.88434541e-01  2.14875483e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.42853859]
curr_Stock_Price:  100.59822949806392
curr_Factors:  [100.5982295   -0.54992391  -1.03475607]
mat_Sqrt:  [[20.6239841   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00299324  0.01250945 -0.27262553]
Stock Position:  -0.002993238492275724
Bond Position:  [6.72965308]


portfolio before change:  [6.43460404]
curr_Stock_Price:  99.69626792770771
curr_Factors:  [99.69626793 -0.44047099 -1.08778532]
mat_Sqrt:  [[21.62547308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00457807  0.02823371  0.03635499]
Stock Position:  -0.004578072112934721
Bond Position:  [6.89102074]


portfolio before change:  [6.45539781]
curr_Stock_Price:  95.90703060962218
curr_Factors:  [95.90703061  0.16140988 -1.12087782]
mat_Sqrt:  [[36.74166345  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00198819  0.02156133 -0.58336675]
Stock Position:  0.0019881886347009226
Bond Position:  [6.26471655]


portfolio before change:  [6.45299197]
curr_Stock_Price:  93.1210861118396
curr_Factors:  [93.12108611 -0.17535518 -1.10658188]
mat_Sqrt:  [[25.84103125  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00696626 -0.00649938 -0.25703678]
Stock Position:  -0.0069662555704866165
Bond Position:  [7.10169726]


portfolio before change:  [6.50964319]
curr_Stock_Price:  85.4987018173537
curr_Factors:  [85.49870182 -0.27249814 -1.03337905]
mat_Sqrt:  [[23.16457104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.33347012e-03  1.82032614e-01  2.54086938e+00]
Stock Position:  -0.0013334701183343584
Bond Position:  [6.62365315]


portfolio before change:  [6.51601188]
curr_Stock_Price:  83.20690720555032
curr_Factors:  [83.20690721 -0.48871114 -1.06470422]
mat_Sqrt:  [[17.60028334  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01654041  0.06753043 -0.85602985]
Stock Position:  0.0165404076849746
Bond Position:  [5.13973571]


portfolio before change:  [6.54473943]
curr_Stock_Price:  84.78830928415937
curr_Factors:  [84.78830928 -1.12480331 -1.07062124]
mat_Sqrt:  [[ 9.43789638  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06042143 -0.15520757  1.699949  ]
Stock Position:  0.06042142939757301
Bond Position:  [1.42170858]


portfolio before change:  [6.51720534]
curr_Stock_Price:  84.32084067439841
curr_Factors:  [84.32084067 -1.25596606 -1.02597169]
mat_Sqrt:  [[ 8.60799402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00353094  0.07011954  0.37908429]
Stock Position:  -0.003530944959338463
Bond Position:  [6.81493758]


portfolio before change:  [6.51819897]
curr_Stock_Price:  85.00470498406594
curr_Factors:  [85.00470498 -1.28348643 -1.06889227]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.51819897]
Stock Price:  84.72247368976491
PL:  [6.51819897]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.63456459e-02  3.71151464e-02 -8.83370645e-02]
 [-2.62933664e-01  5.53892999e-02 -6.53874530e-02]
 [-9.60964788e-02  2.71528976e-02 -5.97346322e-02]
 [ 2.21188316e-04 -6.90734714e-02 -4.36311752e-01]
 [ 6.79121924e-02 -1.22483346e-01 -1.67110963e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [-2.22487144e-03  1.37870974e-01 -4.79200466e-02]
 [ 1.06696455e-01  2.85419282e-02  9.61953551e-03]
 [-9.36371112e-02 -7.87225466e-02  5.91279094e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.03896193]
curr_Stock_Price:  99.55779695456033
curr_Factors:  [99.55779695 -0.75619853 -0.97657061]
mat_Sqrt:  [[17.60123748  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0036031   0.01173684 -0.25200106]
Stock Position:  -0.0036031026121640915
Bond Position:  [-0.68024497]


portfolio before change:  [-1.027298]
curr_Stock_Price:  96.22618513656772
curr_Factors:  [96.22618514 -0.53686654 -0.90216916]
mat_Sqrt:  [[22.82064959  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01204395  0.01751563 -0.1865322 ]
Stock Position:  -0.012043946199326798
Bond Position:  [0.131645]


portfolio before change:  [-1.07513239]
curr_Stock_Price:  100.20330636690404
curr_Factors:  [100.20330637  -0.99763561  -0.95549759]
mat_Sqrt:  [[14.21173425  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00757041  0.0085865  -0.17040628]
Stock Position:  -0.007570411379652087
Bond Position:  [-0.31655214]


portfolio before change:  [-1.08038718]
curr_Stock_Price:  100.87651592676762
curr_Factors:  [100.87651593  -1.32942087  -0.97896711]
mat_Sqrt:  [[10.02928359  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00903594 -0.02184295 -1.24467598]
Stock Position:  -0.00903594396575846
Bond Position:  [-0.16887264]


portfolio before change:  [-1.09809203]
curr_Stock_Price:  102.82654906431372
curr_Factors:  [102.82654906  -1.3852469   -1.00423995]
mat_Sqrt:  [[ 9.42680035  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00325013 -0.03873263 -0.47672106]
Stock Position:  0.0032501275589675383
Bond Position:  [-1.43229143]


portfolio before change:  [-1.10365144]
curr_Stock_Price:  101.33642800458587
curr_Factors:  [101.336428    -1.39753963  -1.01219072]
mat_Sqrt:  [[ 9.10401564  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00259808 -0.00193948 -0.30510753]
Stock Position:  0.0025980849083192233
Bond Position:  [-1.36693208]


portfolio before change:  [-1.10369129]
curr_Stock_Price:  101.58422180647614
curr_Factors:  [101.58422181  -1.37964422  -1.04479591]
mat_Sqrt:  [[ 8.99301442  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093925  0.04359863 -0.13670255]
Stock Position:  -0.0009392508845008781
Bond Position:  [-1.00827822]


portfolio before change:  [-1.10319498]
curr_Stock_Price:  100.5189405938879
curr_Factors:  [100.51894059  -1.41471216  -1.04682934]
mat_Sqrt:  [[ 8.57460281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01275826 0.00902575 0.02744186]
Stock Position:  0.012758256695935076
Bond Position:  [-2.38564143]


portfolio before change:  [-1.09618348]
curr_Stock_Price:  101.16202433871598
curr_Factors:  [101.16202434  -1.0141834   -1.09623889]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.09618348]
Stock Price:  100.64101773797302
PL:  [-1.73720121]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-4.30499016e-02  8.30346769e-02  2.67168295e-02]
 [-9.87828232e-02  3.20876219e-02 -6.17280936e-02]
 [-1.84027529e-02 -8.52959714e-02 -5.11428261e-01]
 [ 6.87239621e-02 -1.16620970e-01 -1.69756749e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 6.86639791e-02  2.94136434e-02  5.20111192e-02]
 [ 9.12734450e-02  2.17479584e-02  8.84478470e-03]
 [-1.03567373e-01 -9.18959045e-02  2.55234086e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.66733709]
curr_Stock_Price:  100.35284466676329
curr_Factors:  [100.35284467  -0.97605224  -0.95690664]
mat_Sqrt:  [[14.52299911  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00425067  0.01250945 -0.27262553]
Stock Position:  -0.004250671819737979
Bond Position:  [5.0939041]


portfolio before change:  [4.6734419]
curr_Stock_Price:  99.51598409180498
curr_Factors:  [99.51598409 -0.75431976 -0.96685039]
mat_Sqrt:  [[17.79910426  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199181  0.02625787  0.07621568]
Stock Position:  -0.0019918084046641167
Bond Position:  [4.87165867]


portfolio before change:  [4.67557378]
curr_Stock_Price:  99.66888827684178
curr_Factors:  [99.66888828 -1.42825594 -0.97555868]
mat_Sqrt:  [[ 9.00733243  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01227384  0.010147   -0.17609307]
Stock Position:  -0.012273835741608107
Bond Position:  [5.89889334]


portfolio before change:  [4.66530908]
curr_Stock_Price:  100.74555966134042
curr_Factors:  [100.74555966  -1.53830273  -0.97288731]
mat_Sqrt:  [[ 8.17767673  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01528551 -0.02697295 -1.45896247]
Stock Position:  -0.015285507869949781
Bond Position:  [6.20525612]


portfolio before change:  [4.65761462]
curr_Stock_Price:  101.45197099015866
curr_Factors:  [101.45197099  -1.1753605   -0.97523462]
mat_Sqrt:  [[11.81051673  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00262998 -0.03687879 -0.48426875]
Stock Position:  0.0026299755664270894
Bond Position:  [4.39079842]


portfolio before change:  [4.65754974]
curr_Stock_Price:  100.59233164631542
curr_Factors:  [100.59233165  -0.54256779  -0.97980591]
mat_Sqrt:  [[21.94857743  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107766 -0.00193948 -0.30510753]
Stock Position:  0.0010776555212866517
Bond Position:  [4.54914586]


portfolio before change:  [4.65856307]
curr_Stock_Price:  99.42144246885586
curr_Factors:  [99.42144247 -0.85716283 -0.96866036]
mat_Sqrt:  [[16.0153017   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00499773 0.00930141 0.14837325]
Stock Position:  0.0049977304748545165
Bond Position:  [4.1616815]


portfolio before change:  [4.66032652]
curr_Stock_Price:  99.3578309774918
curr_Factors:  [99.35783098 -1.21071376 -0.96666532]
mat_Sqrt:  [[11.26103688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00831543 0.00687731 0.02523171]
Stock Position:  0.008315434008002588
Bond Position:  [3.83412303]


portfolio before change:  [4.65257762]
curr_Stock_Price:  98.19536130812573
curr_Factors:  [98.19536131 -1.31502261 -0.96087458]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.65257762]
Stock Price:  97.39690632601436
PL:  [4.65257762]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-9.27877698e-02  9.15531661e-02  1.70332303e-02]
 [-8.73733945e-02  1.11288855e-02 -5.32614745e-02]
 [-5.90852809e-03 -9.90746647e-03 -1.01899670e-01]
 [ 6.82369609e-02 -1.20137958e-01 -1.68169475e-01]
 [ 4.44921356e-02 -1.08473779e-02 -1.10484957e-01]
 [ 4.17646381e-02  9.53557263e-02 -1.38109922e-01]
 [ 1.33000681e-01  4.01291683e-02  1.09408872e-02]
 [-4.51923323e-02  1.10041163e-02  5.70485704e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.78773789]
curr_Stock_Price:  100.36961987932351
curr_Factors:  [100.36961988  -0.65727323  -1.06048512]
mat_Sqrt:  [[18.01313519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00342708  0.01250945 -0.27262553]
Stock Position:  -0.0034270826502124296
Bond Position:  [5.13171287]


portfolio before change:  [4.79221576]
curr_Stock_Price:  99.81189188218022
curr_Factors:  [99.81189188 -0.60308771 -1.04898295]
mat_Sqrt:  [[19.12921355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00454525  0.02895165  0.04859106]
Stock Position:  -0.0045452461202686815
Bond Position:  [5.24588538]


portfolio before change:  [4.79568884]
curr_Stock_Price:  99.62499890699657
curr_Factors:  [99.62499891 -0.78689032 -1.01122264]
mat_Sqrt:  [[16.49900645  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00593721  0.00351926 -0.15194016]
Stock Position:  -0.005937206048508335
Bond Position:  [5.38718298]


portfolio before change:  [4.80007108]
curr_Stock_Price:  99.34069406936928
curr_Factors:  [99.34069407 -0.25597576 -1.03497617]
mat_Sqrt:  [[27.31957184  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.000987   -0.00313302 -0.29069139]
Stock Position:  -0.0009870037841469392
Bond Position:  [4.89812072]


portfolio before change:  [4.79956508]
curr_Stock_Price:  102.33528295888232
curr_Factors:  [102.33528296  -0.6246382   -1.02628547]
mat_Sqrt:  [[19.63533675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00156899 -0.03799096 -0.4797407 ]
Stock Position:  0.001568985666437125
Bond Position:  [4.63900249]


portfolio before change:  [4.80237735]
curr_Stock_Price:  102.64898198032195
curr_Factors:  [102.64898198  -0.85158983  -0.94738847]
mat_Sqrt:  [[16.98510745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012752  -0.00343024 -0.31518283]
Stock Position:  0.001275200067782103
Bond Position:  [4.67147936]


portfolio before change:  [4.80465997]
curr_Stock_Price:  102.60686544749782
curr_Factors:  [102.60686545  -1.33791384  -0.927285  ]
mat_Sqrt:  [[10.65155629  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00150543  0.03015413 -0.39398916]
Stock Position:  0.0015054272086103843
Bond Position:  [4.6501928]


portfolio before change:  [4.80680533]
curr_Stock_Price:  102.4870853155311
curr_Factors:  [102.48708532  -1.78381021  -0.90123187]
mat_Sqrt:  [[ 6.99149716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01949083 0.01268996 0.03121131]
Stock Position:  0.019490834042287814
Bond Position:  [2.80924655]


portfolio before change:  [4.83594687]
curr_Stock_Price:  103.91014236576765
curr_Factors:  [103.91014237  -2.08277923  -0.82892196]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.83594687]
Stock Price:  104.32604110706906
PL:  [0.50990576]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [ 7.28068555e-02  8.15491720e-02  5.86116049e-02]
 [-1.03277651e-01  4.03444688e-02 -6.50635799e-02]
 [-5.40260368e-02 -1.23566938e-01 -6.50475374e-01]
 [ 7.00339123e-02 -1.07160874e-01 -1.74026245e-01]
 [ 7.96538341e-02  1.33172416e-01 -2.58701840e-03]
 [-3.45909275e-03  5.80793673e-02 -4.10542533e-02]
 [ 9.02135572e-02  2.12810686e-02  8.79154289e-03]
 [-9.41831701e-02 -7.20150219e-02  3.36091825e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.5955018]
curr_Stock_Price:  100.20350790961953
curr_Factors:  [100.20350791  -1.32983342  -1.01326886]
mat_Sqrt:  [[ 9.62246929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00641545  0.01250945 -0.27262553]
Stock Position:  -0.006415453372489782
Bond Position:  [4.23835274]


portfolio before change:  [3.60448898]
curr_Stock_Price:  99.13305043283817
curr_Factors:  [99.13305043 -1.36366295 -1.03975037]
mat_Sqrt:  [[ 8.9625033   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00969333 0.02578811 0.16720259]
Stock Position:  0.009693328622288992
Bond Position:  [2.64355975]


portfolio before change:  [3.60968441]
curr_Stock_Price:  99.5326366061927
curr_Factors:  [99.53263661 -1.71455252 -1.06518688]
mat_Sqrt:  [[ 6.17646559  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01870277  0.01275804 -0.18560828]
Stock Position:  -0.01870276891827823
Bond Position:  [5.47122031]


portfolio before change:  [3.62388755]
curr_Stock_Price:  98.91952704671596
curr_Factors:  [98.91952705 -1.7419947  -1.06180589]
mat_Sqrt:  [[ 5.99248434  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03170542 -0.0390753  -1.85562518]
Stock Position:  -0.03170542305009061
Bond Position:  [6.760173]


portfolio before change:  [3.63530209]
curr_Stock_Price:  98.66614417547511
curr_Factors:  [98.66614418 -1.79332634 -1.04804744]
mat_Sqrt:  [[ 5.75672129  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00551426 -0.03388724 -0.49644844]
Stock Position:  0.00551426242944761
Bond Position:  [3.09123108]


portfolio before change:  [3.63586486]
curr_Stock_Price:  98.48783665195212
curr_Factors:  [98.48783665 -2.2779207  -0.97376707]
mat_Sqrt:  [[ 3.81234807  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02165706  0.04211282 -0.00738004]
Stock Position:  0.021657061921890677
Bond Position:  [1.50290769]


portfolio before change:  [3.63708254]
curr_Stock_Price:  98.50935567955034
curr_Factors:  [98.50935568 -2.04755405 -0.96008905]
mat_Sqrt:  [[ 4.86714942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00212438  0.01836631 -0.11711636]
Stock Position:  -0.00212437576773355
Bond Position:  [3.84635343]


portfolio before change:  [3.638203]
curr_Stock_Price:  98.88744127387295
curr_Factors:  [98.88744127 -1.54152134 -0.9996266 ]
mat_Sqrt:  [[ 7.78994892  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01188167 0.00672966 0.02507982]
Stock Position:  0.011881669463062412
Bond Position:  [2.46325511]


portfolio before change:  [3.63886899]
curr_Stock_Price:  98.83980931105489
curr_Factors:  [98.83980931 -1.37573112 -0.99343598]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.63886899]
Stock Price:  99.26467977032515
PL:  [3.63886899]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 1.00528965e-01 -1.57353059e-01  3.20475267e-01]
 [-2.68253543e-02  8.30470233e-02  3.12954713e-02]
 [-7.30728971e-02 -1.32093491e-02 -4.46999222e-02]
 [-3.47835751e-02 -5.38733010e-02 -2.95656056e-01]
 [ 9.45555125e-03 -8.08022644e-02 -1.30719770e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 2.49613634e-02  1.22293641e-01 -1.51094399e-03]
 [ 1.13821767e-01  3.16806901e-02  9.97746444e-03]
 [-9.41657746e-02 -7.65716649e-02  8.43711386e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.86336009]
curr_Stock_Price:  97.63167003778776
curr_Factors:  [97.63167004 -0.95471343 -0.98773357]
mat_Sqrt:  [[13.99576707  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01156656 -0.04975941  0.91422673]
Stock Position:  0.011566559045403907
Bond Position:  [-15.99262257]


portfolio before change:  [-14.8496205]
curr_Stock_Price:  99.51104510836592
curr_Factors:  [99.51104511 -0.85142217 -0.95933272]
mat_Sqrt:  [[16.27310521  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00112412  0.02626177  0.08927727]
Stock Position:  -0.0011241203116578024
Bond Position:  [-14.73775812]


portfolio before change:  [-14.85517573]
curr_Stock_Price:  97.8960131801712
curr_Factors:  [97.89601318 -0.6449272  -1.02384869]
mat_Sqrt:  [[18.45120955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00447333 -0.00417716 -0.12751644]
Stock Position:  -0.0044733270330938844
Bond Position:  [-14.41725485]


portfolio before change:  [-14.86672362]
curr_Stock_Price:  98.86564042313371
curr_Factors:  [98.86564042 -0.77769823 -1.03880694]
mat_Sqrt:  [[16.07486047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00600473 -0.01703623 -0.84342443]
Stock Position:  -0.006004725054116116
Bond Position:  [-14.27306264]


portfolio before change:  [-14.86578088]
curr_Stock_Price:  97.51985639835885
curr_Factors:  [97.5198564  -0.66733497 -1.00040796]
mat_Sqrt:  [[18.39930849  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0010497  -0.02555192 -0.37290712]
Stock Position:  -0.0010497033371735763
Bond Position:  [-14.76341396]


portfolio before change:  [-14.87642284]
curr_Stock_Price:  100.62398347651414
curr_Factors:  [100.62398348  -0.96541109  -1.03326747]
mat_Sqrt:  [[13.63598252  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017346  -0.00193948 -0.30510753]
Stock Position:  0.00173460222725953
Bond Position:  [-15.05096543]


portfolio before change:  [-14.8843243]
curr_Stock_Price:  100.40831748762436
curr_Factors:  [100.40831749  -1.08024212  -1.02557977]
mat_Sqrt:  [[12.224268    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227503  0.03867264 -0.0043103 ]
Stock Position:  0.0022750279579130026
Bond Position:  [-15.11275603]


portfolio before change:  [-14.88994461]
curr_Stock_Price:  101.26015790676885
curr_Factors:  [101.26015791  -1.5018065   -1.08980527]
mat_Sqrt:  [[ 7.58430703  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01538392 0.01001831 0.02846293]
Stock Position:  0.015383923647955827
Bond Position:  [-16.44772315]


portfolio before change:  [-14.90718005]
curr_Stock_Price:  100.6745124092033
curr_Factors:  [100.67451241  -1.20598385  -1.15188123]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.90718005]
Stock Price:  100.1251484360336
PL:  [-15.03232849]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-5.05814229e-03  2.92879858e-02 -8.66022972e-02]
 [-4.77974406e-01 -2.07930163e-01 -4.07164058e-01]
 [-1.44855879e-01  1.16722275e-01 -9.59176249e-02]
 [ 2.03080294e-01  1.56377300e-02 -7.92744405e-02]
 [ 6.76671556e-02 -1.24252933e-01 -1.66312319e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 1.23981087e-01 -1.26099586e-01  1.18314711e-01]
 [ 1.25594642e-01  5.09283762e-02  2.19866269e-02]
 [-1.10768669e-01 -1.02983619e-01  1.38842856e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.30674703]
curr_Stock_Price:  101.13857285245183
curr_Factors:  [101.13857285  -0.15947484  -1.02999617]
mat_Sqrt:  [[30.78478486  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071397  0.00926167 -0.24705225]
Stock Position:  -0.0007139744436499521
Bond Position:  [10.37895739]


portfolio before change:  [10.31001039]
curr_Stock_Price:  103.8381365140107
curr_Factors:  [103.83813651  -0.57363462  -1.02278837]
mat_Sqrt:  [[21.039683    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02692318 -0.06575329 -1.16152572]
Stock Position:  -0.026923179165055412
Bond Position:  [13.10566314]


portfolio before change:  [10.2615009]
curr_Stock_Price:  105.8833615941047
curr_Factors:  [105.88336159  -0.83153931  -1.05784947]
mat_Sqrt:  [[16.00577101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01008519  0.03691082 -0.27362629]
Stock Position:  -0.010085189041676372
Bond Position:  [11.32935462]


portfolio before change:  [10.2895639]
curr_Stock_Price:  103.66258961155775
curr_Factors:  [103.66258961  -0.26382654  -1.03923165]
mat_Sqrt:  [[28.16508538  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00665016  0.00494508 -0.22614791]
Stock Position:  0.006650156676284036
Bond Position:  [9.60019144]


portfolio before change:  [10.2924614]
curr_Stock_Price:  103.37631102417231
curr_Factors:  [ 1.03376311e+02  5.77729381e-02 -1.04687082e+00]
mat_Sqrt:  [[38.4468955   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079358 -0.03929223 -0.47444275]
Stock Position:  0.0007935776964352326
Bond Position:  [10.21042426]


portfolio before change:  [10.29580761]
curr_Stock_Price:  101.15816429517038
curr_Factors:  [101.1581643    0.11544208  -1.09782615]
mat_Sqrt:  [[37.87537686  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0006245  -0.00193948 -0.30510753]
Stock Position:  0.0006244955856043508
Bond Position:  [10.23263479]


portfolio before change:  [10.29816007]
curr_Stock_Price:  96.73037439143549
curr_Factors:  [96.73037439 -0.3991905  -1.05543671]
mat_Sqrt:  [[22.58532249  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00641461 -0.03987619  0.33751894]
Stock Position:  0.006414612824096776
Bond Position:  [9.67767217]


portfolio before change:  [10.2938657]
curr_Stock_Price:  95.30637216044748
curr_Factors:  [95.30637216 -0.96938354 -0.95102067]
mat_Sqrt:  [[13.96693105  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00940777 0.01610497 0.06272173]
Stock Position:  0.009407765270960404
Bond Position:  [9.39724572]


portfolio before change:  [10.31307652]
curr_Stock_Price:  96.8488237244371
curr_Factors:  [96.84882372 -0.52611256 -0.97567117]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.31307652]
Stock Price:  98.267718247107
PL:  [10.31307652]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 5.24771133e-02  1.38144059e-02 -7.30961567e-02]
 [-1.23451251e-01  8.18283900e-02  1.22775594e-02]
 [-9.09094745e-02  1.76245453e-02 -5.58855009e-02]
 [ 1.11008212e-02 -5.27440026e-02 -3.30495854e-01]
 [ 6.87204114e-02 -1.16646612e-01 -1.69745176e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 1.05695100e-01 -4.51701286e-02  9.75192044e-02]
 [ 1.19679346e-01  4.46163214e-02  1.86800256e-02]
 [-1.25905296e-01 -1.52403372e-01  1.12106780e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.82508408]
curr_Stock_Price:  101.62877601415904
curr_Factors:  [101.62877601  -1.18984367  -1.01480816]
mat_Sqrt:  [[11.20852775  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00338252  0.0043685  -0.20852299]
Stock Position:  0.003382523561950415
Bond Position:  [13.48132235]


portfolio before change:  [13.82765132]
curr_Stock_Price:  100.39445931772005
curr_Factors:  [100.39445932  -0.94066417  -1.03270378]
mat_Sqrt:  [[13.95362127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00851623  0.02587641  0.03502446]
Stock Position:  -0.008516234083138154
Bond Position:  [14.68263404]


portfolio before change:  [13.8422328]
curr_Stock_Price:  99.54451526485502
curr_Factors:  [99.54451526 -1.08502616 -0.98798923]
mat_Sqrt:  [[12.52328285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00813381  0.00557337 -0.15942578]
Stock Position:  -0.008133808999572088
Bond Position:  [14.65190887]


portfolio before change:  [13.84285347]
curr_Stock_Price:  100.36911215380813
curr_Factors:  [100.36911215  -0.98301929  -1.05987181]
mat_Sqrt:  [[13.01318936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00443575 -0.01667912 -0.94281268]
Stock Position:  -0.004435746323750233
Bond Position:  [14.28806539]


portfolio before change:  [13.85365582]
curr_Stock_Price:  99.5447798111021
curr_Factors:  [99.54477981 -0.96251965 -1.05647203]
mat_Sqrt:  [[13.21848073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0023497  -0.0368869  -0.48423574]
Stock Position:  0.002349704215528233
Bond Position:  [13.61975503]


portfolio before change:  [13.86191592]
curr_Stock_Price:  100.16125135848962
curr_Factors:  [100.16125136  -0.311809    -1.0067517 ]
mat_Sqrt:  [[26.7951448   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00088273 -0.00193948 -0.30510753]
Stock Position:  0.0008827347576984694
Bond Position:  [13.77350011]


portfolio before change:  [13.86749386]
curr_Stock_Price:  98.67662032864482
curr_Factors:  [98.67662033 -0.43656856 -1.0098421 ]
mat_Sqrt:  [[23.2298335   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00535668 -0.01428405  0.27819515]
Stock Position:  0.005356682219245522
Bond Position:  [13.33891456]


portfolio before change:  [13.85897921]
curr_Stock_Price:  95.84169800981722
curr_Factors:  [95.84169801 -0.6901063  -1.05261689]
mat_Sqrt:  [[16.77642561  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00742973 0.01410892 0.05328891]
Stock Position:  0.007429733940206369
Bond Position:  [13.14690089]


portfolio before change:  [13.85906538]
curr_Stock_Price:  94.96832588004351
curr_Factors:  [94.96832588 -1.23013959 -1.03548587]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.85906538]
Stock Price:  96.94066693550768
PL:  [13.85906538]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-3.46831661e-01 -6.82855310e-02 -1.98893888e-01]
 [-9.70309594e-02  2.88695071e-02 -6.04280842e-02]
 [ 6.24944013e-02 -2.71471171e-02 -2.49081985e-01]
 [ 6.87451780e-02 -1.16467755e-01 -1.69825897e-01]
 [ 5.05204482e-02  1.38441580e-02 -9.19863478e-02]
 [ 4.78109152e-02  5.48645686e-02  2.57553964e-02]
 [ 8.54443531e-02  1.91801928e-02  8.55196937e-03]
 [-1.02609345e-01 -8.23693332e-02  1.32333521e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.79226901]
curr_Stock_Price:  99.81293885368801
curr_Factors:  [99.81293885 -0.57327529 -0.97538831]
mat_Sqrt:  [[21.2134247   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291007  0.01250945 -0.27262553]
Stock Position:  -0.002910067749182367
Bond Position:  [1.08273142]


portfolio before change:  [0.78585473]
curr_Stock_Price:  102.20318517546447
curr_Factors:  [102.20318518  -0.70181163  -1.00589896]
mat_Sqrt:  [[18.52742841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02100636 -0.02159378 -0.5673889 ]
Stock Position:  -0.021006359959297314
Bond Position:  [2.93277163]


portfolio before change:  [0.82268446]
curr_Stock_Price:  100.5197439424811
curr_Factors:  [100.51974394  -0.47795759  -0.99994918]
mat_Sqrt:  [[22.93002992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00473704  0.00912934 -0.1723845 ]
Stock Position:  -0.004737036250571203
Bond Position:  [1.29885013]


portfolio before change:  [0.81907216]
curr_Stock_Price:  101.41943733860306
curr_Factors:  [101.41943734  -0.81765704  -1.025206  ]
mat_Sqrt:  [[16.06112441  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.81759145e-04 -8.58467221e-03 -7.10561572e-01]
Stock Position:  0.0006817591452584522
Bond Position:  [0.74992854]


portfolio before change:  [0.81832911]
curr_Stock_Price:  99.77940376826254
curr_Factors:  [99.77940377 -1.2858611  -1.09426764]
mat_Sqrt:  [[ 9.23345263  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0033652  -0.03683034 -0.48446601]
Stock Position:  0.003365201364779494
Bond Position:  [0.48255133]


portfolio before change:  [0.81815458]
curr_Stock_Price:  99.65582505969539
curr_Factors:  [99.65582506 -0.9499709  -1.04621533]
mat_Sqrt:  [[13.53848363  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00237111  0.00437791 -0.26241145]
Stock Position:  0.0023711125350825207
Bond Position:  [0.58185941]


portfolio before change:  [0.81885528]
curr_Stock_Price:  99.82861272283007
curr_Factors:  [99.82861272 -0.84908529 -1.07945986]
mat_Sqrt:  [[14.51103932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00375471 0.0173497  0.07347298]
Stock Position:  0.0037547145549181762
Bond Position:  [0.44402734]


portfolio before change:  [0.81497223]
curr_Stock_Price:  98.7352876649576
curr_Factors:  [98.73528766 -0.71386938 -1.04581003]
mat_Sqrt:  [[16.99234577  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00516028 0.00606531 0.02439639]
Stock Position:  0.00516027911484259
Bond Position:  [0.30547059]


portfolio before change:  [0.81294704]
curr_Stock_Price:  98.31322364225265
curr_Factors:  [98.31322364 -0.66725808 -1.01318358]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.81294704]
Stock Price:  96.73693580602878
PL:  [0.81294704]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 3.06873180e-02 -7.32230052e-02  1.46284618e-01]
 [-2.32141756e-01  6.84601205e-02 -3.73753997e-02]
 [-3.77513005e-03  1.84709886e-03 -9.55775092e-02]
 [-3.79400207e-02 -6.53055272e-02 -3.53858997e-01]
 [ 7.05078694e-02 -1.03738087e-01 -1.75571004e-01]
 [ 6.94612132e-02  9.14241722e-02 -3.38643122e-02]
 [ 6.99896806e-02 -7.87183385e-02  4.96312746e-02]
 [ 8.68922520e-02  1.98180048e-02  8.62470231e-03]
 [-1.00397339e-01 -7.65307797e-02  1.31436860e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.1347823]
curr_Stock_Price:  98.42982180959086
curr_Factors:  [98.42982181 -1.0326491  -1.00431649]
mat_Sqrt:  [[12.83759824  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00456915 -0.02315515  0.4173093 ]
Stock Position:  0.00456915146481054
Bond Position:  [-9.58452306]


portfolio before change:  [-9.14676041]
curr_Stock_Price:  96.8573964783584
curr_Factors:  [96.85739648 -0.68126337 -0.99609219]
mat_Sqrt:  [[18.0994979   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01314972  0.02164899 -0.10662161]
Stock Position:  -0.013149720836210667
Bond Position:  [-7.87311268]


portfolio before change:  [-9.13981672]
curr_Stock_Price:  96.02990930124194
curr_Factors:  [96.0299093  -0.49978462 -0.9884332 ]
mat_Sqrt:  [[21.68112097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00107177  0.0005841  -0.27265603]
Stock Position:  -0.0010717672562562323
Bond Position:  [-9.03689501]


portfolio before change:  [-9.14738536]
curr_Stock_Price:  98.87480004583828
curr_Factors:  [98.87480005 -0.93558562 -1.04840642]
mat_Sqrt:  [[13.59717933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00822651 -0.02065142 -1.00946122]
Stock Position:  -0.008226512631422782
Bond Position:  [-8.33399057]


portfolio before change:  [-9.14403955]
curr_Stock_Price:  97.96143092797863
curr_Factors:  [97.96143093 -1.44932281 -0.99496931]
mat_Sqrt:  [[ 8.50183238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00376285 -0.03280486 -0.50085521]
Stock Position:  0.003762845572244596
Bond Position:  [-9.51265329]


portfolio before change:  [-9.14589423]
curr_Stock_Price:  98.7328778895957
curr_Factors:  [98.73287789 -1.29185305 -1.02744013]
mat_Sqrt:  [[ 9.70969453  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00668499  0.02891086 -0.09660546]
Stock Position:  0.006684994177472682
Bond Position:  [-9.80592295]


portfolio before change:  [-9.15879665]
curr_Stock_Price:  97.53643270743942
curr_Factors:  [97.53643271 -1.16063886 -0.96371465]
mat_Sqrt:  [[11.65659911  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00669905 -0.02489292  0.14158421]
Stock Position:  0.006699048547137949
Bond Position:  [-9.81219795]


portfolio before change:  [-9.15281695]
curr_Stock_Price:  99.16159314196624
curr_Factors:  [99.16159314 -1.01285198 -1.02008839]
mat_Sqrt:  [[12.98520192  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00686662 0.006267   0.02460388]
Stock Position:  0.006866621038358524
Bond Position:  [-9.83372203]


portfolio before change:  [-9.16222172]
curr_Stock_Price:  98.50818889530879
curr_Factors:  [98.5081889  -0.55908345 -1.03771088]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.16222172]
Stock Price:  96.91546961359303
PL:  [-9.16222172]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.56980634e-02  3.76256538e-02 -8.98477103e-02]
 [-1.48949329e-01  6.58243980e-02  5.23798612e-03]
 [-1.16827064e-01  6.52342842e-02 -7.51182216e-02]
 [ 6.31101876e-02 -3.02632428e-02 -2.63473740e-01]
 [ 6.87231558e-02 -1.16626793e-01 -1.69754121e-01]
 [ 4.95394894e-02  9.82622093e-03 -9.49965391e-02]
 [ 1.45678067e-01 -1.36250980e-01  1.46253742e-01]
 [ 1.02072033e-01  3.67217876e-02 -2.42237459e-02]
 [-9.30724740e-02 -7.89056105e-02  5.30884199e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.44225137]
curr_Stock_Price:  99.64093549360778
curr_Factors:  [99.64093549 -1.16177117 -1.04631261]
mat_Sqrt:  [[10.95164087  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00575865  0.01189828 -0.25631051]
Stock Position:  -0.0057586494132604
Bond Position:  [0.13154584]


portfolio before change:  [-0.44790526]
curr_Stock_Price:  100.6341682603937
curr_Factors:  [100.63416826  -1.14170079  -1.13198234]
mat_Sqrt:  [[10.35851324  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01411212  0.0208155   0.01494252]
Stock Position:  -0.014112116994267093
Bond Position:  [0.97225589]


portfolio before change:  [-0.4675038]
curr_Stock_Price:  102.05739847303917
curr_Factors:  [102.05739847  -0.62828938  -1.18833039]
mat_Sqrt:  [[16.59191648  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00786384  0.02062889 -0.21429138]
Stock Position:  -0.007863839271956548
Bond Position:  [0.33505917]


portfolio before change:  [-0.46047332]
curr_Stock_Price:  101.18468137443517
curr_Factors:  [101.18468137  -0.80889747  -1.20667001]
mat_Sqrt:  [[13.48232936  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.33973682e-04 -9.57007767e-03 -7.51617244e-01]
Stock Position:  0.0006339736824090427
Bond Position:  [-0.52462175]


portfolio before change:  [-0.46075125]
curr_Stock_Price:  101.16015750245087
curr_Factors:  [101.1601575   -0.37126559  -1.19581235]
mat_Sqrt:  [[21.10747054  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147156 -0.03688063 -0.48426126]
Stock Position:  0.0014715619342711226
Bond Position:  [-0.60961469]


portfolio before change:  [-0.46336287]
curr_Stock_Price:  99.59261342400298
curr_Factors:  [99.59261342 -0.49248997 -1.19049846]
mat_Sqrt:  [[18.50608448  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00164282  0.00310732 -0.27099868]
Stock Position:  0.001642817203848636
Bond Position:  [-0.62697533]


portfolio before change:  [-0.46837994]
curr_Stock_Price:  96.72953946965688
curr_Factors:  [96.72953947  0.10120262 -1.15608444]
mat_Sqrt:  [[33.68447374  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00510663 -0.04308634  0.41722122]
Stock Position:  0.0051066257809876696
Bond Position:  [-0.9623415]


portfolio before change:  [-0.45270192]
curr_Stock_Price:  99.89392171572993
curr_Factors:  [99.89392172 -0.24298004 -1.22264335]
mat_Sqrt:  [[23.06890149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00425142  0.01161245 -0.0691036 ]
Stock Position:  0.004251417628040243
Bond Position:  [-0.8773927]


portfolio before change:  [-0.45111637]
curr_Stock_Price:  100.37008060961674
curr_Factors:  [100.37008061   0.39331136  -1.24837713]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.45111637]
Stock Price:  96.52961577410304
PL:  [-0.45111637]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-5.12787632e-01 -2.43489031e-01 -4.59759571e-01]
 [-1.44412898e-01  1.15908533e-01 -9.55889007e-02]
 [ 2.50229976e-01  1.07707718e-02 -1.33035294e-01]
 [ 4.57119485e-02 -1.02577559e-01 -1.24044451e-01]
 [-2.80141638e-01 -2.22649877e-01  1.42549414e-01]
 [ 1.15396380e-01  1.56039177e-02 -3.04590435e-01]
 [ 3.67615886e-01  2.20730285e-01 -2.31408408e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.1105837]
curr_Stock_Price:  100.69325753742892
curr_Factors:  [100.69325754  -0.46435819  -0.99590003]
mat_Sqrt:  [[23.37858952  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264056  0.01250945 -0.27262553]
Stock Position:  -0.002640557208676427
Bond Position:  [7.37647001]


portfolio before change:  [7.10484661]
curr_Stock_Price:  104.26305220036599
curr_Factors:  [104.2630522   -0.50183306  -1.05762644]
mat_Sqrt:  [[21.92127356  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02796017 -0.07699799 -1.31156608]
Stock Position:  -0.02796016933549437
Bond Position:  [10.02005921]


portfolio before change:  [7.07781761]
curr_Stock_Price:  105.40897800599471
curr_Factors:  [105.40897801  -0.48138153  -1.16335778]
mat_Sqrt:  [[20.35056156  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.007908    0.0366535  -0.27268853]
Stock Position:  -0.007907995789403736
Bond Position:  [7.91139137]


portfolio before change:  [7.08602223]
curr_Stock_Price:  104.87180867537302
curr_Factors:  [104.87180868  -0.40413971  -1.18782011]
mat_Sqrt:  [[21.34417596  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01046432  0.00340602 -0.37951267]
Stock Position:  0.010464323435946582
Bond Position:  [5.98860971]


portfolio before change:  [7.13054047]
curr_Stock_Price:  108.83988049210589
curr_Factors:  [108.83988049  -0.36938907  -1.19697216]
mat_Sqrt:  [[22.72615791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00078073 -0.03243787 -0.35386429]
Stock Position:  0.0007807276472938469
Bond Position:  [7.04556617]


portfolio before change:  [7.13577042]
curr_Stock_Price:  111.02538372144093
curr_Factors:  [111.02538372  -0.67832009  -1.19668135]
mat_Sqrt:  [[17.02626943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01508214 -0.07040807  0.4066538 ]
Stock Position:  -0.015082144512319227
Bond Position:  [8.8102713]


portfolio before change:  [7.14305179]
curr_Stock_Price:  110.8347521507607
curr_Factors:  [110.83475215  -1.38392811  -1.23825163]
mat_Sqrt:  [[ 8.05151785  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00666024  0.00493439 -0.86891173]
Stock Position:  0.006660235960344684
Bond Position:  [6.40486619]


portfolio before change:  [7.13975457]
curr_Stock_Price:  109.85874328750972
curr_Factors:  [109.85874329  -1.14153538  -1.18331408]
mat_Sqrt:  [[10.74398356  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03034992  0.06980105 -0.66014378]
Stock Position:  0.03034992305449714
Bond Position:  [3.80555017]


portfolio before change:  [7.12985348]
curr_Stock_Price:  109.46980178143883
curr_Factors:  [109.46980178  -0.91531558  -1.15207662]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.12985348]
Stock Price:  109.42779123097921
PL:  [-2.29793775]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-1.04746621e-01  8.95701289e-02  1.69423582e-02]
 [-9.44309332e-02  2.40933464e-02 -5.84986772e-02]
 [-2.49913102e-02 -8.80218386e-02 -5.10881898e-01]
 [ 6.87227373e-02 -1.16629815e-01 -1.69752757e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 4.38160606e-02  6.83520050e-02 -1.87524005e-01]
 [ 3.41104547e-01  2.09504649e-01 -2.34229878e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.85165063]
curr_Stock_Price:  100.37852471998603
curr_Factors:  [100.37852472  -0.63902997  -0.994591  ]
mat_Sqrt:  [[19.59603626  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00315025  0.01250945 -0.27262553]
Stock Position:  -0.0031502545851048104
Bond Position:  [5.16786854]


portfolio before change:  [4.85460986]
curr_Stock_Price:  100.25960040222948
curr_Factors:  [100.2596004   -0.92833414  -0.97516674]
mat_Sqrt:  [[14.94328374  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00662342  0.02832456  0.04833183]
Stock Position:  -0.006623416051288777
Bond Position:  [5.5186709]


portfolio before change:  [4.86364316]
curr_Stock_Price:  99.31246400532844
curr_Factors:  [99.31246401 -1.24509958 -0.96013322]
mat_Sqrt:  [[10.94670265  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00966043  0.00761899 -0.16688044]
Stock Position:  -0.009660428492251504
Bond Position:  [5.82304412]


portfolio before change:  [4.855611]
curr_Stock_Price:  100.44537502233236
curr_Factors:  [100.44537502  -1.51418325  -1.0038709 ]
mat_Sqrt:  [[ 8.09753666  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01624535 -0.02783495 -1.45740385]
Stock Position:  -0.016245354654879016
Bond Position:  [6.48738174]


portfolio before change:  [4.85346544]
curr_Stock_Price:  100.77716607393434
curr_Factors:  [100.77716607  -1.01460389  -0.99003612]
mat_Sqrt:  [[13.57556914  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00228799 -0.03688159 -0.48425736]
Stock Position:  0.002287987468908684
Bond Position:  [4.62288855]


portfolio before change:  [4.85460395]
curr_Stock_Price:  100.2642642652267
curr_Factors:  [100.26426427  -0.2580133   -1.0389996 ]
mat_Sqrt:  [[27.40694482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00086303 -0.00193948 -0.30510753]
Stock Position:  0.0008630296372535373
Bond Position:  [4.76807292]


portfolio before change:  [4.85945887]
curr_Stock_Price:  103.12660278632818
curr_Factors:  [103.12660279  -0.33964454  -1.06508219]
mat_Sqrt:  [[25.31078669  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.88522228e-04  2.16148019e-02 -5.34953790e-01]
Stock Position:  0.0002885222279086215
Bond Position:  [4.82970455]


portfolio before change:  [4.86275641]
curr_Stock_Price:  106.18386790331951
curr_Factors:  [106.1838679   -0.26778976  -1.07763648]
mat_Sqrt:  [[27.65332431  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01080167  0.06625119 -0.66819264]
Stock Position:  0.010801665551200315
Bond Position:  [3.71579378]


portfolio before change:  [4.88856555]
curr_Stock_Price:  108.40119070981484
curr_Factors:  [108.40119071  -0.54071167  -1.07983184]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.88856555]
Stock Price:  110.03534500211744
PL:  [-5.14677945]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-4.33750071e-03  7.79446038e-02  3.50373131e-02]
 [-5.44533402e-02 -1.89571731e-02 -5.27444546e-02]
 [ 6.37038012e-03  1.91758877e-02  4.33453396e-02]
 [-1.59145176e-01  2.05745436e-01  3.22375243e-01]
 [ 1.42117854e-01  1.54362072e-01 -7.12687387e-02]
 [ 1.68356096e-01 -1.56560776e-01  1.77417862e-01]
 [ 1.38482785e-01  6.39219906e-02  1.92460977e-02]
 [-1.07639958e-01 -9.27966702e-02  1.44271873e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.83989483]
curr_Stock_Price:  99.81957446746715
curr_Factors:  [99.81957447 -0.84588796 -1.05416185]
mat_Sqrt:  [[14.92913226  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00413504  0.01250945 -0.27262553]
Stock Position:  -0.004135036249517322
Bond Position:  [1.25265238]


portfolio before change:  [0.84316761]
curr_Stock_Price:  99.1796033704144
curr_Factors:  [99.17960337 -0.77706907 -1.03953807]
mat_Sqrt:  [[16.12426448  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00029936 0.02464825 0.0999517 ]
Stock Position:  0.00029936136946261664
Bond Position:  [0.81347707]


portfolio before change:  [0.84329109]
curr_Stock_Price:  98.23305253915237
curr_Factors:  [98.23305254 -0.445598   -0.97048588]
mat_Sqrt:  [[23.83747358  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00275655 -0.00599478 -0.15046525]
Stock Position:  -0.0027565517289190335
Bond Position:  [1.11407558]


portfolio before change:  [0.84326247]
curr_Stock_Price:  98.44556310465701
curr_Factors:  [98.4455631   0.17809901 -0.94187328]
mat_Sqrt:  [[45.86624575  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00034259 0.00606395 0.12365219]
Stock Position:  0.0003425902765489541
Bond Position:  [0.80953598]


portfolio before change:  [0.8417107]
curr_Stock_Price:  92.73424881784253
curr_Factors:  [92.73424882 -0.17825078 -0.93588176]
mat_Sqrt:  [[30.43536705  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0028923   0.06506242  0.91964684]
Stock Position:  -0.002892302262207566
Bond Position:  [1.10992618]


portfolio before change:  [0.84044427]
curr_Stock_Price:  93.36403552268591
curr_Factors:  [ 9.33640355e+01 -5.89197775e-02 -9.25943186e-01]
mat_Sqrt:  [[34.87057148  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00377269  0.04881357 -0.20330987]
Stock Position:  0.003772688245233147
Bond Position:  [0.48821087]


portfolio before change:  [0.84935769]
curr_Stock_Price:  95.66193499697559
curr_Factors:  [95.661935   -0.25655884 -0.88409715]
mat_Sqrt:  [[30.5744433   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00655871 -0.04950886  0.50612378]
Stock Position:  0.006558712510885784
Bond Position:  [0.22193856]


portfolio before change:  [0.84304044]
curr_Stock_Price:  94.68182653179457
curr_Factors:  [94.68182653  0.10970867 -0.92108494]
mat_Sqrt:  [[42.06204573  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00342498 0.02021391 0.05490376]
Stock Position:  0.0034249840721120297
Bond Position:  [0.51875669]


portfolio before change:  [0.84817651]
curr_Stock_Price:  96.10566589778685
curr_Factors:  [ 9.61056659e+01  3.30658111e-02 -9.37539215e-01]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.84817651]
Stock Price:  97.20923474611249
PL:  [0.84817651]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 2.53977545e-02 -6.84179641e-02  1.36886512e-01]
 [ 8.36453511e-02  9.27617095e-02  6.73699612e-02]
 [-1.02095215e-01  3.81723749e-02 -6.41861275e-02]
 [ 3.98134274e-02 -3.48810498e-02 -2.78399478e-01]
 [ 6.85863886e-02 -1.17614488e-01 -1.69308358e-01]
 [ 4.50400737e-02 -8.60306267e-03 -1.08803542e-01]
 [ 2.22264085e-02  9.50120536e-02 -1.32791099e-01]
 [ 1.83828047e-01  8.87494466e-02 -7.27966264e-02]
 [-9.29405963e-02 -7.89483672e-02  5.16778261e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.03318657]
curr_Stock_Price:  98.44397694827391
curr_Factors:  [98.44397695 -1.50095072 -1.04430083]
mat_Sqrt:  [[ 7.72325628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00667763 -0.02163566  0.39049912]
Stock Position:  0.006677630614660774
Bond Position:  [-9.69055908]


portfolio before change:  [-9.02959597]
curr_Stock_Price:  99.70746154456388
curr_Factors:  [99.70746154 -1.84647474 -1.03792812]
mat_Sqrt:  [[ 5.57246586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0179081  0.02933383 0.19218775]
Stock Position:  0.01790810143609667
Bond Position:  [-10.81516731]


portfolio before change:  [-9.02336333]
curr_Stock_Price:  100.35753514730709
curr_Factors:  [100.35753515  -1.73768596  -1.04933521]
mat_Sqrt:  [[ 6.18247078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01847345  0.01207116 -0.18310516]
Stock Position:  -0.01847344717043225
Bond Position:  [-7.1694137]


portfolio before change:  [-9.03971618]
curr_Stock_Price:  101.04864904347201
curr_Factors:  [101.04864904  -0.86126462  -1.05158578]
mat_Sqrt:  [[14.92073227  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012007  -0.01103036 -0.79419622]
Stock Position:  -0.0012006952867257572
Bond Position:  [-8.91838755]


portfolio before change:  [-9.04494039]
curr_Stock_Price:  101.68486058416126
curr_Factors:  [101.68486058  -1.04854303  -1.04378066]
mat_Sqrt:  [[12.54791772  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00246971 -0.03719297 -0.48298962]
Stock Position:  0.0024697063250995557
Bond Position:  [-9.29607213]


portfolio before change:  [-9.04657749]
curr_Stock_Price:  102.90447945840197
curr_Factors:  [102.90447946  -0.95767478  -1.1024814 ]
mat_Sqrt:  [[13.11353615  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00172406 -0.00272053 -0.31038622]
Stock Position:  0.001724059272401235
Bond Position:  [-9.22399091]


portfolio before change:  [-9.05095597]
curr_Stock_Price:  103.04059189091033
curr_Factors:  [103.04059189  -0.53169673  -1.15945755]
mat_Sqrt:  [[18.99106731  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.27757978e-04  3.00454495e-02 -3.78816043e-01]
Stock Position:  -0.00012775797771160443
Bond Position:  [-9.03779171]


portfolio before change:  [-9.05548274]
curr_Stock_Price:  103.09335858135272
curr_Factors:  [103.09335858  -0.87563981  -1.20785125]
mat_Sqrt:  [[12.83459052  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01334363  0.02806504 -0.20766851]
Stock Position:  0.013343627807230272
Bond Position:  [-10.43112214]


portfolio before change:  [-9.08475698]
curr_Stock_Price:  101.29044718391201
curr_Factors:  [101.29044718  -1.09430272  -1.16800341]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.08475698]
Stock Price:  102.31111578465004
PL:  [-11.39587277]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-2.29548030e-01  3.67102592e-02 -4.33115742e-02]
 [-1.09825671e-01  5.23729617e-02 -6.99226833e-02]
 [ 1.09602431e-01 -2.18502069e-02 -2.37417021e-01]
 [ 6.79533288e-02 -1.22186269e-01 -1.67245038e-01]
 [ 4.51399884e-02 -8.19381928e-03 -1.08496942e-01]
 [ 1.04852397e-02  1.23368906e-01 -7.79864156e-02]
 [ 1.20766904e-01  3.64241642e-02  4.78617974e-03]
 [-8.49895623e-02 -5.88249600e-02  1.91278487e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.13276448]
curr_Stock_Price:  100.27836368932044
curr_Factors:  [100.27836369  -1.25461404  -0.99912217]
mat_Sqrt:  [[10.52984648  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00586262  0.01250945 -0.27262553]
Stock Position:  -0.005862621377441102
Bond Position:  [4.72065856]


portfolio before change:  [4.13076335]
curr_Stock_Price:  101.02240740819522
curr_Factors:  [101.02240741  -1.2966012   -1.11564361]
mat_Sqrt:  [[ 9.05301215  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02622786  0.0116088  -0.12355587]
Stock Position:  -0.026227857510229994
Bond Position:  [6.78036466]


portfolio before change:  [4.11803461]
curr_Stock_Price:  101.63701243768992
curr_Factors:  [101.63701244  -1.0978945   -1.12529826]
mat_Sqrt:  [[11.00351764  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01115519  0.01656178 -0.19946995]
Stock Position:  -0.01115518864157304
Bond Position:  [5.25181466]


portfolio before change:  [4.11519551]
curr_Stock_Price:  102.12697834656555
curr_Factors:  [102.12697835  -0.8733571   -1.10062382]
mat_Sqrt:  [[14.18572256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00427019 -0.00690964 -0.67728468]
Stock Position:  0.004270188844405191
Bond Position:  [3.67909403]


portfolio before change:  [4.11987843]
curr_Stock_Price:  102.79273597480815
curr_Factors:  [102.79273597  -0.74338402  -1.08492194]
mat_Sqrt:  [[16.51730683  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00185622 -0.03863869 -0.47710354]
Stock Position:  0.0018562192277117332
Bond Position:  [3.92907258]


portfolio before change:  [4.12178383]
curr_Stock_Price:  102.7606136480026
curr_Factors:  [102.76061365  -1.08023787  -1.07288556]
mat_Sqrt:  [[11.93265438  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00190918 -0.00259111 -0.30951157]
Stock Position:  0.0019091795271734748
Bond Position:  [3.92559537]


portfolio before change:  [4.12254628]
curr_Stock_Price:  102.13162877886009
curr_Factors:  [102.13162878  -1.17337891  -1.07861596]
mat_Sqrt:  [[10.74314194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.09277634e-04  3.90126734e-02 -2.22473536e-01]
Stock Position:  -0.0002092776339750271
Bond Position:  [4.14392014]


portfolio before change:  [4.12462926]
curr_Stock_Price:  102.08144292689285
curr_Factors:  [102.08144293  -1.34256842  -1.06542381]
mat_Sqrt:  [[ 9.18690156  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01335427 0.01151833 0.01365364]
Stock Position:  0.013354268176536696
Bond Position:  [2.76140629]


portfolio before change:  [4.11244403]
curr_Stock_Price:  101.06556711685661
curr_Factors:  [101.06556712  -1.17470602  -0.99944574]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.11244403]
Stock Price:  100.70862318896697
PL:  [3.40382084]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.39577802e-02  3.89975677e-02 -9.39073498e-02]
 [ 2.69200976e-02  8.66904050e-02  4.82952874e-02]
 [-7.36676851e-02 -5.72530728e-03 -5.10704090e-02]
 [ 2.22174063e-01  1.25493489e-02 -1.10791216e-01]
 [ 6.74927380e-02 -1.25512529e-01 -1.65743843e-01]
 [ 1.95286890e-02 -1.10078266e-02 -4.39113935e-02]
 [ 2.60225662e-02  1.03758528e-01 -1.18141993e-01]
 [ 1.14211223e-01  3.18522490e-02  9.99702817e-03]
 [-9.46886874e-02 -7.83816099e-02  7.03758094e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.1011576]
curr_Stock_Price:  99.71664762422333
curr_Factors:  [99.71664762 -0.8580562  -1.07522481]
mat_Sqrt:  [[14.42628131  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.004306    0.01233211 -0.26789153]
Stock Position:  -0.0043060039882455705
Bond Position:  [0.53053788]


portfolio before change:  [0.10222723]
curr_Stock_Price:  99.52986321370682
curr_Factors:  [99.52986321 -1.12843824 -1.05064529]
mat_Sqrt:  [[11.26132404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00346466 0.02741391 0.13777301]
Stock Position:  0.0034646608466650636
Bond Position:  [-0.24260999]


portfolio before change:  [0.10146015]
curr_Stock_Price:  99.34348498466187
curr_Factors:  [99.34348498 -0.24453745 -1.05029202]
mat_Sqrt:  [[27.21460875  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0030954  -0.0018105  -0.14568966]
Stock Position:  -0.003095404247828081
Bond Position:  [0.4089684]


portfolio before change:  [0.08600989]
curr_Stock_Price:  104.40091733055094
curr_Factors:  [104.40091733  -0.38920163  -1.03565793]
mat_Sqrt:  [[25.11283098  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00795939  0.00396845 -0.3160565 ]
Stock Position:  0.007959394307087187
Bond Position:  [-0.74495818]


portfolio before change:  [0.07943213]
curr_Stock_Price:  103.62131212506957
curr_Factors:  [103.62131213  -0.36241825  -1.089644  ]
mat_Sqrt:  [[24.25640672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00125409 -0.03969055 -0.47282105]
Stock Position:  0.0012540892207922344
Bond Position:  [-0.05051824]


portfolio before change:  [0.08082157]
curr_Stock_Price:  104.74938630915791
curr_Factors:  [104.74938631  -0.52504061  -1.12622407]
mat_Sqrt:  [[20.0916844   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00051171 -0.00348098 -0.12526698]
Stock Position:  0.0005117088366145251
Bond Position:  [0.02722039]


portfolio before change:  [0.08000675]
curr_Stock_Price:  103.13043240649658
curr_Factors:  [103.13043241  -1.04699108  -1.09275502]
mat_Sqrt:  [[12.1368761   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00037785  0.03281133 -0.33702622]
Stock Position:  0.0003778539425893195
Bond Position:  [0.04103851]


portfolio before change:  [0.07922185]
curr_Stock_Price:  100.99885593622487
curr_Factors:  [100.99885594  -1.5409067   -1.04114929]
mat_Sqrt:  [[ 7.63736919  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01532914 0.01007257 0.02851874]
Stock Position:  0.01532913716211893
Bond Position:  [-1.46900346]


portfolio before change:  [0.07817741]
curr_Stock_Price:  100.9786487827745
curr_Factors:  [100.97864878  -0.63763749  -1.00595794]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.07817741]
Stock Price:  99.34163256132149
PL:  [0.07817741]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-2.41584306e-01  3.69848134e-02 -4.19572451e-02]
 [-1.12655309e-01  5.75709111e-02 -7.20224786e-02]
 [ 1.17206328e-01 -2.22211848e-02 -2.41742722e-01]
 [ 6.73952508e-02 -1.26216554e-01 -1.65426104e-01]
 [ 4.44334714e-02 -1.10876624e-02 -1.10664975e-01]
 [ 6.77157907e-02  8.19953617e-02 -8.38369912e-02]
 [ 1.80940543e-01  9.22260545e-02 -8.85631940e-02]
 [-9.10757610e-02 -7.95529747e-02  3.17311202e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.28486793]
curr_Stock_Price:  99.88157171803087
curr_Factors:  [99.88157172 -0.97532474 -0.98405259]
mat_Sqrt:  [[14.07792369  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00438506  0.01250945 -0.27262553]
Stock Position:  -0.004385057374042262
Bond Position:  [1.72285435]


portfolio before change:  [1.28065939]
curr_Stock_Price:  101.03781237978812
curr_Factors:  [101.03781238  -1.4286738   -0.96520452]
mat_Sqrt:  [[ 9.22222663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02702101  0.01169562 -0.11969234]
Stock Position:  -0.0270210067983478
Bond Position:  [4.01080281]


portfolio before change:  [1.24953353]
curr_Stock_Price:  102.26396101927914
curr_Factors:  [102.26396102  -1.33591451  -0.99296242]
mat_Sqrt:  [[ 9.96102913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01263628  0.01820552 -0.20546008]
Stock Position:  -0.012636280800429096
Bond Position:  [2.54176965]


portfolio before change:  [1.24786232]
curr_Stock_Price:  102.49681478069238
curr_Factors:  [102.49681478  -0.9603228   -0.96704785]
mat_Sqrt:  [[14.91639692  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00451095 -0.00702696 -0.6896247 ]
Stock Position:  0.004510945464538232
Bond Position:  [0.78550478]


portfolio before change:  [1.25400262]
curr_Stock_Price:  103.77092545247719
curr_Factors:  [103.77092545  -1.01579642  -0.94733154]
mat_Sqrt:  [[14.57135868  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00208415 -0.03991318 -0.47191463]
Stock Position:  0.002084149587941258
Bond Position:  [1.03772848]


portfolio before change:  [1.25150986]
curr_Stock_Price:  102.32585344015975
curr_Factors:  [102.32585344  -0.58758514  -0.93620352]
mat_Sqrt:  [[22.2952512   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00096692 -0.00350623 -0.31569637]
Stock Position:  0.0009669232043572912
Bond Position:  [1.15256862]


portfolio before change:  [1.25090675]
curr_Stock_Price:  101.10595999895868
curr_Factors:  [101.10596     -0.36520738  -0.93729287]
mat_Sqrt:  [[27.48578129  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00191807  0.02592921 -0.2391636 ]
Stock Position:  0.0019180734621828909
Bond Position:  [1.05697809]


portfolio before change:  [1.25188604]
curr_Stock_Price:  101.34091968428778
curr_Factors:  [101.34091968  -0.40250503  -0.91879464]
mat_Sqrt:  [[27.03657585  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00611187  0.02916444 -0.25264614]
Stock Position:  0.006111865798512268
Bond Position:  [0.63250394]


portfolio before change:  [1.25766696]
curr_Stock_Price:  102.23501461643917
curr_Factors:  [102.23501462  -0.35006349  -1.01312847]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.25766696]
Stock Price:  101.31218086354448
PL:  [-0.0545139]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 5.86069405e-02  1.21658451e-02 -7.16572076e-02]
 [-3.75508189e-01 -1.03269286e-01 -2.52359003e-01]
 [-1.01922761e-01  3.78555814e-02 -6.40581537e-02]
 [ 1.55042582e-01 -1.45966205e-02 -2.16520156e-01]
 [ 6.12353261e-02 -1.22652495e-01 -1.53157989e-01]
 [-1.47738740e-01 -5.30813051e-02  1.00066027e-01]
 [ 1.05570491e-01  2.28254936e-02 -2.88555316e-01]
 [ 4.01385332e-01  2.47290534e-01 -2.68150893e-01]
 [-8.28369855e-02 -8.50258912e-02 -1.17075926e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.03432739]
curr_Stock_Price:  101.65792948338664
curr_Factors:  [101.65792948  -1.08321481  -0.99872686]
mat_Sqrt:  [[12.67551118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00349446  0.00384718 -0.20441807]
Stock Position:  0.003494462225122049
Bond Position:  [13.67908759]


portfolio before change:  [14.04451315]
curr_Stock_Price:  102.615018273981
curr_Factors:  [102.61501827  -0.79651156  -1.02216177]
mat_Sqrt:  [[16.64834769  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0258096  -0.03265662 -0.71990999]
Stock Position:  -0.025809597695587074
Bond Position:  [16.69296549]


portfolio before change:  [14.09842755]
curr_Stock_Price:  100.8495575754203
curr_Factors:  [100.84955758  -0.58781699  -0.99637411]
mat_Sqrt:  [[20.68562007  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0055121   0.01197099 -0.18274008]
Stock Position:  -0.005512097255251797
Bond Position:  [14.65432012]


portfolio before change:  [14.09358907]
curr_Stock_Price:  103.05696999016075
curr_Factors:  [103.05696999  -0.95291274  -1.00062621]
mat_Sqrt:  [[14.61053713  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00756089 -0.00461586 -0.61767174]
Stock Position:  0.0075608929532406475
Bond Position:  [13.31438635]


portfolio before change:  [14.12038522]
curr_Stock_Price:  105.7203185526981
curr_Factors:  [105.72031855  -1.43253816  -1.00329053]
mat_Sqrt:  [[ 9.25319058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00289686 -0.03878612 -0.43691711]
Stock Position:  0.0028968611938728957
Bond Position:  [13.81412814]


portfolio before change:  [14.13254012]
curr_Stock_Price:  107.53128204316495
curr_Factors:  [107.53128204  -1.73989348  -1.0235693 ]
mat_Sqrt:  [[ 6.78231866  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01897336 -0.01678578  0.28546052]
Stock Position:  -0.018973363999728293
Bond Position:  [16.17277028]


portfolio before change:  [14.12762787]
curr_Stock_Price:  108.21648794494918
curr_Factors:  [108.21648794  -1.19136573  -1.0808868 ]
mat_Sqrt:  [[11.15492609  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00423658  0.00721805 -0.823168  ]
Stock Position:  0.0042365798459899255
Bond Position:  [13.66916008]


portfolio before change:  [14.13891862]
curr_Stock_Price:  109.26791732215497
curr_Factors:  [109.26791732  -0.70465338  -1.10379667]
mat_Sqrt:  [[17.9098845   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0197117   0.07820013 -0.76495986]
Stock Position:  0.019711700244172445
Bond Position:  [11.98506219]


portfolio before change:  [14.19423522]
curr_Stock_Price:  111.770114662457
curr_Factors:  [111.77011466  -1.09602601  -1.10663843]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.19423522]
Stock Price:  111.87787967240477
PL:  [2.31635555]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 4.78729264e-02  1.50526598e-02 -7.41769687e-02]
 [-5.25925122e-01 -2.56907905e-01 -4.79607575e-01]
 [-1.34189704e-01  9.71288706e-02 -8.80025535e-02]
 [ 1.02956267e-01  1.67094159e-02 -2.25255468e-02]
 [-1.15652742e-01  5.38441448e-02  9.52035976e-02]
 [ 7.96538341e-02  1.33172416e-01 -2.58701840e-03]
 [ 6.07969037e-02  2.27580550e-02  4.14878221e-02]
 [ 8.32884823e-02  1.82305130e-02  8.44367257e-03]
 [-1.11115834e-01 -1.10509592e-01  1.16032905e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.51877618]
curr_Stock_Price:  101.44677063613928
curr_Factors:  [101.44677064  -0.5023866   -1.11657775]
mat_Sqrt:  [[20.09698664  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00164802  0.00476007 -0.21160624]
Stock Position:  0.0016480218980847998
Bond Position:  [12.35158968]


portfolio before change:  [12.52984298]
curr_Stock_Price:  104.41363696755985
curr_Factors:  [104.41363697  -0.38438315  -1.08373635]
mat_Sqrt:  [[24.05254437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02621169 -0.08124141 -1.36818691]
Stock Position:  -0.02621169435403546
Bond Position:  [15.26670132]


portfolio before change:  [12.54325077]
curr_Stock_Price:  104.19340942330273
curr_Factors:  [104.19340942  -0.60016718  -1.12029029]
mat_Sqrt:  [[18.64897918  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00802432  0.03071485 -0.25104679]
Stock Position:  -0.008024315549326195
Bond Position:  [13.37933157]


portfolio before change:  [12.57311929]
curr_Stock_Price:  101.30504115106243
curr_Factors:  [101.30504115  -0.27433057  -1.07458815]
mat_Sqrt:  [[26.29075772  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00375758  0.00528398 -0.06425912]
Stock Position:  0.0037575826156134038
Bond Position:  [12.19245723]


portfolio before change:  [12.55729244]
curr_Stock_Price:  95.47027727959195
curr_Factors:  [95.47027728 -0.17165395 -1.03888537]
mat_Sqrt:  [[28.45362697  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00333276  0.01702701  0.27158936]
Stock Position:  -0.0033327610264792607
Bond Position:  [12.87547206]


portfolio before change:  [12.55718015]
curr_Stock_Price:  97.43610472863553
curr_Factors:  [97.43610473 -0.77417552 -1.07408374]
mat_Sqrt:  [[15.34726927  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00537974  0.04211282 -0.00738004]
Stock Position:  0.005379736074104269
Bond Position:  [12.03299962]


portfolio before change:  [12.57448075]
curr_Stock_Price:  99.53334467042251
curr_Factors:  [99.53334467 -0.75207205 -1.08269983]
mat_Sqrt:  [[15.89049025  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00439591 0.00719673 0.11835321]
Stock Position:  0.0043959109686286316
Bond Position:  [12.13694103]


portfolio before change:  [12.57774284]
curr_Stock_Price:  98.8945929082671
curr_Factors:  [98.89459291 -0.76155153 -1.11120856]
mat_Sqrt:  [[15.19998557  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00562387 0.00576499 0.02408745]
Stock Position:  0.0056238704405021135
Bond Position:  [12.02157246]


portfolio before change:  [12.58003409]
curr_Stock_Price:  98.23294157503463
curr_Factors:  [98.23294158 -1.23182158 -1.12006192]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.58003409]
Stock Price:  99.89610184757318
PL:  [12.58003409]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 1.11543274e-01 -1.68397221e-01  3.42560555e-01]
 [-4.66441585e-02  7.50822943e-02  2.16584848e-02]
 [-9.92764744e-02  3.29944426e-02 -6.20944184e-02]
 [-3.43587811e-02 -5.23347535e-02 -2.87823112e-01]
 [ 3.78761177e-02 -9.45164882e-02 -1.50589226e-01]
 [ 1.00284488e-01  1.40170948e-01 -2.52712583e-02]
 [ 1.72218215e-01 -1.81657853e-01  1.83129717e-01]
 [ 1.42527782e-01  9.87869642e-02  8.30829665e-03]
 [-1.26325534e-01 -1.54222678e-01  1.09811462e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.9065628]
curr_Stock_Price:  97.48632260363144
curr_Factors:  [97.4863226  -1.18534959 -0.97456426]
mat_Sqrt:  [[11.24359057  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01575299 -0.05325188  0.97722991]
Stock Position:  0.015752988817966298
Bond Position:  [-17.44226375]


portfolio before change:  [-15.90132039]
curr_Stock_Price:  98.3728666234802
curr_Factors:  [98.37286662 -1.07035893 -0.94722268]
mat_Sqrt:  [[13.08129587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00307955  0.02374311  0.06178563]
Stock Position:  -0.0030795513485383148
Bond Position:  [-15.5983761]


portfolio before change:  [-15.91558401]
curr_Stock_Price:  100.47138200004643
curr_Factors:  [100.471382    -0.95142453  -0.93839828]
mat_Sqrt:  [[15.18108315  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00731829  0.01043376 -0.17713809]
Stock Position:  -0.007318287538907928
Bond Position:  [-15.18030555]


portfolio before change:  [-15.91230864]
curr_Stock_Price:  98.98641370903728
curr_Factors:  [98.98641371 -0.77917649 -0.92607915]
mat_Sqrt:  [[17.98839752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00525126 -0.0165497  -0.82107922]
Stock Position:  -0.005251257379243182
Bond Position:  [-15.3925055]


portfolio before change:  [-15.91375844]
curr_Stock_Price:  97.79653141764338
curr_Factors:  [97.79653142 -0.79263972 -0.88189786]
mat_Sqrt:  [[18.32656288  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.56284583e-04 -2.98887379e-02 -4.29589145e-01]
Stock Position:  0.0002562845827071672
Bond Position:  [-15.93882218]


portfolio before change:  [-15.9222982]
curr_Stock_Price:  95.57883603650563
curr_Factors:  [95.57883604 -0.57076413 -0.87233884]
mat_Sqrt:  [[22.57512052  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00437407  0.04432595 -0.07209187]
Stock Position:  0.004374072436287687
Bond Position:  [-16.34036696]


portfolio before change:  [-15.93381769]
curr_Stock_Price:  94.81358614757349
curr_Factors:  [94.81358615 -0.48063543 -0.87450116]
mat_Sqrt:  [[24.45356779  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00837951 -0.05744526  0.52241811]
Stock Position:  0.008379514539518707
Bond Position:  [-16.72830951]


portfolio before change:  [-15.96017902]
curr_Stock_Price:  92.66607690854231
curr_Factors:  [92.66607691 -0.67370705 -0.95717741]
mat_Sqrt:  [[18.13997382  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00809121 0.03123918 0.02370126]
Stock Position:  0.008091212052980816
Bond Position:  [-16.7099599]


portfolio before change:  [-15.95636242]
curr_Stock_Price:  94.17063179937894
curr_Factors:  [94.1706318  -0.60072313 -0.93920294]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.95636242]
Stock Price:  95.63303877375007
PL:  [-15.95636242]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 2.22954527e-02 -6.18831796e-02  1.22372846e-01]
 [ 6.98144667e-02  8.01787233e-02  5.70711427e-02]
 [-1.00309597e-01  3.48922544e-02 -6.28610700e-02]
 [-7.81446297e-03 -7.32791450e-02 -4.60327955e-01]
 [ 6.87228940e-02 -1.16628684e-01 -1.69753267e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 5.41777045e-02  9.98960889e-02 -8.56713317e-02]
 [ 9.29981930e-02  2.25077249e-02  8.93142472e-03]
 [-6.53046573e-02 -1.71762193e-02  5.45028887e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.42864632]
curr_Stock_Price:  98.52820638282856
curr_Factors:  [98.52820638 -1.0341472  -0.96801786]
mat_Sqrt:  [[13.30550427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00343293 -0.01956918  0.34909567]
Stock Position:  0.003432931771422655
Bond Position:  [-8.76688693]


portfolio before change:  [-8.4301976]
curr_Stock_Price:  99.35352515993372
curr_Factors:  [99.35352516 -1.33903662 -0.92896535]
mat_Sqrt:  [[10.28495849  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00812198 0.02535474 0.16280808]
Stock Position:  0.008121984232696243
Bond Position:  [-9.23714536]


portfolio before change:  [-8.42757673]
curr_Stock_Price:  100.24500622365375
curr_Factors:  [100.24500622  -1.58662694  -0.95475832]
mat_Sqrt:  [[ 7.89501855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01421658  0.0110339  -0.17932514]
Stock Position:  -0.014216577770922119
Bond Position:  [-7.0024358]


portfolio before change:  [-8.44201529]
curr_Stock_Price:  101.01428201114247
curr_Factors:  [101.01428201  -1.42450675  -0.87644041]
mat_Sqrt:  [[10.11798722  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01024617 -0.0231729  -1.31318753]
Stock Position:  -0.010246165612879485
Bond Position:  [-7.40700623]


portfolio before change:  [-8.4427541]
curr_Stock_Price:  100.72484446148323
curr_Factors:  [100.72484446  -1.13941751  -0.82917741]
mat_Sqrt:  [[14.0665209   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00220814 -0.03688123 -0.48425882]
Stock Position:  0.002208137602215291
Bond Position:  [-8.66516841]


portfolio before change:  [-8.44713863]
curr_Stock_Price:  100.70180807094991
curr_Factors:  [100.70180807  -1.22169475  -0.84112865]
mat_Sqrt:  [[12.79865837  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00184808 -0.00193948 -0.30510753]
Stock Position:  0.0018480847730444714
Bond Position:  [-8.63324411]


portfolio before change:  [-8.45107609]
curr_Stock_Price:  100.9075557392145
curr_Factors:  [100.90755574  -0.88991107  -0.87254809]
mat_Sqrt:  [[17.31798663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00226755  0.03158992 -0.24439646]
Stock Position:  0.002267551297713864
Bond Position:  [-8.67988915]


portfolio before change:  [-8.45870325]
curr_Stock_Price:  99.45835804610121
curr_Factors:  [99.45835805 -1.07881333 -0.88337269]
mat_Sqrt:  [[13.97895552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00682472 0.00711757 0.02547887]
Stock Position:  0.0068247201504392455
Bond Position:  [-9.13747871]


portfolio before change:  [-8.45521815]
curr_Stock_Price:  100.63862377121455
curr_Factors:  [100.63862377  -1.6325158   -0.88799875]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.45521815]
Stock Price:  101.69294212602472
PL:  [-10.14816028]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 6.84265211e-02  9.52495880e-03 -6.93521055e-02]
 [-3.56785261e-01 -8.41453442e-02 -2.24072569e-01]
 [-1.06042650e-01  4.54236788e-02 -6.71154085e-02]
 [ 6.02047322e-02 -8.79219237e-02 -5.83269200e-01]
 [ 6.77361732e-02 -1.23754507e-01 -1.66537266e-01]
 [ 4.52101798e-02 -7.90632056e-03 -1.08281551e-01]
 [ 2.82158315e-02  1.15701175e-01 -9.72307388e-02]
 [ 1.54606567e-01  5.31948027e-02  3.54102563e-04]
 [-8.15910869e-02 -7.62849426e-02 -6.94911318e-04]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.47002978]
curr_Stock_Price:  101.9972912329044
curr_Factors:  [101.99729123  -1.55978538  -1.03299055]
mat_Sqrt:  [[ 7.63062931  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00714437  0.00301206 -0.19784225]
Stock Position:  0.0071443668772180205
Bond Position:  [15.74132372]


portfolio before change:  [16.48175034]
curr_Stock_Price:  102.53588757954681
curr_Factors:  [102.53588758  -1.73134221  -1.08173871]
mat_Sqrt:  [[ 6.15418255  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06575959 -0.02660909 -0.63921667]
Stock Position:  -0.06575958761563402
Bond Position:  [23.22446803]


portfolio before change:  [16.5070614]
curr_Stock_Price:  102.3276150464056
curr_Factors:  [102.32761505  -2.01649901  -1.05069249]
mat_Sqrt:  [[ 4.76352566  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02489116  0.01436423 -0.19146158]
Stock Position:  -0.024891162399387674
Bond Position:  [19.05411468]


portfolio before change:  [16.5078946]
curr_Stock_Price:  102.67698571751421
curr_Factors:  [102.67698572  -1.96365025  -1.03339839]
mat_Sqrt:  [[ 5.12709568  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0119219  -0.02780335 -1.66390468]
Stock Position:  -0.011921901397637262
Bond Position:  [17.73199949]


portfolio before change:  [16.51133807]
curr_Stock_Price:  103.13200888547038
curr_Factors:  [103.13200889  -1.36101382  -1.00375036]
mat_Sqrt:  [[ 9.69146527  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0031519  -0.03913461 -0.47508447]
Stock Position:  0.003151904021423302
Bond Position:  [16.18627588]


portfolio before change:  [16.51949733]
curr_Stock_Price:  103.15234573901863
curr_Factors:  [103.15234574  -1.61516781  -1.03662869]
mat_Sqrt:  [[ 7.2747575   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00314831 -0.0025002  -0.30889712]
Stock Position:  0.003148305687021734
Bond Position:  [16.19474222]


portfolio before change:  [16.52761289]
curr_Stock_Price:  103.15748010162149
curr_Factors:  [103.1574801   -1.72541688  -0.98976585]
mat_Sqrt:  [[ 6.82828825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00166309  0.03658792 -0.27737223]
Stock Position:  0.0016630934588055344
Bond Position:  [16.35605236]


portfolio before change:  [16.53804528]
curr_Stock_Price:  104.51177637811324
curr_Factors:  [104.51177638  -1.89364868  -1.03354733]
mat_Sqrt:  [[ 5.5962893   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02788497 0.01682167 0.00101016]
Stock Position:  0.027884965075943596
Bond Position:  [13.62373805]


portfolio before change:  [16.54860964]
curr_Stock_Price:  104.6462856045641
curr_Factors:  [104.6462856   -1.76366244  -1.02722323]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.54860964]
Stock Price:  104.49709063612116
PL:  [12.05151901]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [ 3.25747751e-02  7.78664062e-02  4.54000582e-02]
 [-1.02758594e-01  3.93909795e-02 -6.46784025e-02]
 [-2.13325052e-02 -8.20725572e-02 -4.70538845e-01]
 [ 6.87224234e-02 -1.16632083e-01 -1.69751733e-01]
 [ 4.55064039e-02 -6.69300760e-03 -1.07372551e-01]
 [ 4.51738245e-02  1.13157665e-01 -5.87657998e-02]
 [ 9.90227446e-02  2.51615922e-02  9.23405866e-03]
 [-9.74303740e-02 -7.74927141e-02  9.97015187e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.08756894]
curr_Stock_Price:  100.13273859700887
curr_Factors:  [100.1327386   -1.20241417  -0.97005425]
mat_Sqrt:  [[11.40473104  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00541289  0.01250945 -0.27262553]
Stock Position:  -0.005412885480312607
Bond Position:  [3.62957599]


portfolio before change:  [3.09496703]
curr_Stock_Price:  99.1013394399833
curr_Factors:  [99.10133944 -1.11911218 -0.97215362]
mat_Sqrt:  [[12.242055    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00358212 0.02462352 0.12951373]
Stock Position:  0.0035821212296322236
Bond Position:  [2.73997402]


portfolio before change:  [3.09835188]
curr_Stock_Price:  99.66372093671134
curr_Factors:  [99.66372094 -1.70448006 -0.99494654]
mat_Sqrt:  [[ 6.70179322  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01715122  0.01245652 -0.18450948]
Stock Position:  -0.01715122257307227
Bond Position:  [4.80770654]


portfolio before change:  [3.09121857]
curr_Stock_Price:  100.21981935309111
curr_Factors:  [100.21981935  -1.37915182  -1.04108464]
mat_Sqrt:  [[ 8.9096014   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01341249 -0.02595362 -1.34231635]
Stock Position:  -0.013412491041686856
Bond Position:  [4.43541599]


portfolio before change:  [3.08769265]
curr_Stock_Price:  100.64809009093267
curr_Factors:  [100.64809009  -1.17284117  -1.02979477]
mat_Sqrt:  [[11.12276864  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00279252 -0.0368823  -0.48425445]
Stock Position:  0.0027925213109769127
Bond Position:  [2.80663071]


portfolio before change:  [3.09241165]
curr_Stock_Price:  101.83530837338138
curr_Factors:  [101.83530837  -1.11529875  -0.98887536]
mat_Sqrt:  [[12.41844379  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0018856  -0.00211651 -0.306304  ]
Stock Position:  0.001885603494687697
Bond Position:  [2.90039064]


portfolio before change:  [3.09225042]
curr_Stock_Price:  100.98052291203082
curr_Factors:  [100.98052291  -0.76424788  -0.9584989 ]
mat_Sqrt:  [[18.03259356  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00200193  0.0357836  -0.16764247]
Stock Position:  0.0020019318948244704
Bond Position:  [2.89009429]


portfolio before change:  [3.09279385]
curr_Stock_Price:  100.52997059957194
curr_Factors:  [100.5299706   -0.97385557  -0.96999414]
mat_Sqrt:  [[14.39104578  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00705698 0.00795679 0.0263422 ]
Stock Position:  0.007056979039693576
Bond Position:  [2.38335596]


portfolio before change:  [3.08895631]
curr_Stock_Price:  99.8172685767074
curr_Factors:  [99.81726858 -0.61314609 -0.94111929]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.08895631]
Stock Price:  100.23089952427854
PL:  [2.85805678]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-2.45224427e-01  2.98049409e-02 -5.55274478e-02]
 [-1.04672296e-01  4.29063860e-02 -6.60985075e-02]
 [ 1.30449138e-02 -9.34586770e-02 -6.00707550e-01]
 [ 6.82162212e-02 -1.20287734e-01 -1.68101878e-01]
 [ 4.45700813e-02 -1.05281177e-02 -1.10245771e-01]
 [ 8.03088242e-02  5.30975612e-02 -8.70331474e-03]
 [ 1.29125047e-01  4.60400186e-02 -1.43152571e-02]
 [-8.11266298e-02 -4.33277164e-02  3.15710781e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.49439625]
curr_Stock_Price:  100.32874915150984
curr_Factors:  [100.32874915  -1.31500912  -0.99906681]
mat_Sqrt:  [[ 9.91824861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00622413  0.01250945 -0.27262553]
Stock Position:  -0.0062241334627962585
Bond Position:  [5.11885578]


portfolio before change:  [4.49194757]
curr_Stock_Price:  101.1334792552697
curr_Factors:  [101.13347926  -1.62750121  -0.99969102]
mat_Sqrt:  [[ 7.31004182  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0349915   0.00942515 -0.15840435]
Stock Position:  -0.03499150432649817
Bond Position:  [8.03076015]


portfolio before change:  [4.46026633]
curr_Stock_Price:  102.15365905905932
curr_Factors:  [102.15365906  -2.05826918  -0.95328287]
mat_Sqrt:  [[ 5.02751634  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02328322  0.01356819 -0.18856064]
Stock Position:  -0.02328321813764114
Bond Position:  [6.83873226]


portfolio before change:  [4.46682185]
curr_Stock_Price:  102.0189997716716
curr_Factors:  [102.01899977  -1.91774453  -0.95179647]
mat_Sqrt:  [[ 5.78702341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01935142 -0.02955423 -1.71365143]
Stock Position:  -0.019351415429574265
Bond Position:  [6.4410339]


portfolio before change:  [4.46414644]
curr_Stock_Price:  102.32371828830355
curr_Factors:  [102.32371829  -1.57645256  -0.88322865]
mat_Sqrt:  [[ 8.74480916  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00352172 -0.03803832 -0.47954787]
Stock Position:  0.003521718142508479
Bond Position:  [4.10379115]


portfolio before change:  [4.46585719]
curr_Stock_Price:  102.22670151265747
curr_Factors:  [102.22670151  -0.8081178   -0.90095966]
mat_Sqrt:  [[18.50637846  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00117767 -0.00332928 -0.3145005 ]
Stock Position:  0.0011776708707808099
Bond Position:  [4.34546778]


portfolio before change:  [4.46557478]
curr_Stock_Price:  100.14150131162418
curr_Factors:  [100.14150131  -0.71584708  -0.86369687]
mat_Sqrt:  [[20.63606451  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00387202  0.01679092 -0.02482813]
Stock Position:  0.003872019328341469
Bond Position:  [4.07782495]


portfolio before change:  [4.47190158]
curr_Stock_Price:  101.24877264783963
curr_Factors:  [101.24877265  -1.01574421  -0.85907647]
mat_Sqrt:  [[15.52978671  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00820306  0.01455913 -0.04083744]
Stock Position:  0.008203055684665377
Bond Position:  [3.64135226]


portfolio before change:  [4.46807808]
curr_Stock_Price:  100.56065896812966
curr_Factors:  [100.56065897  -1.03427398  -0.7866247 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.46807808]
Stock Price:  99.22651071179519
PL:  [4.46807808]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.37304230e-02  3.91767998e-02 -9.44377167e-02]
 [-4.29727498e-02  8.23596147e-02  2.63951644e-02]
 [-8.30492405e-02  3.18556006e-03 -5.00526402e-02]
 [-3.85042749e-02 -6.73491809e-02 -3.64263502e-01]
 [ 6.88020363e-02 -1.16057140e-01 -1.70011214e-01]
 [ 4.90034674e-02  7.63071339e-03 -9.66413875e-02]
 [ 1.26650616e-01 -1.09260667e-01  1.22439834e-01]
 [ 1.17566537e-01  4.23617992e-02  1.74989829e-02]
 [-1.22514999e-01 -1.40799995e-01  1.19950563e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.02333495]
curr_Stock_Price:  99.70580474343845
curr_Factors:  [99.70580474 -0.65505623 -1.06596486]
mat_Sqrt:  [[17.83571316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347594  0.01238879 -0.26940452]
Stock Position:  -0.003475941779823299
Bond Position:  [0.36990652]


portfolio before change:  [0.0246004]
curr_Stock_Price:  99.39496558944883
curr_Factors:  [99.39496559 -0.61668369 -1.07088145]
mat_Sqrt:  [[18.3850223   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00192865  0.0260444   0.07529806]
Stock Position:  -0.001928653811956618
Bond Position:  [0.21629888]


portfolio before change:  [0.02478885]
curr_Stock_Price:  99.35334745051001
curr_Factors:  [99.35334745 -0.64846488 -1.02665721]
mat_Sqrt:  [[18.60742281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00500789  0.00100736 -0.14278625]
Stock Position:  -0.005007890830772991
Bond Position:  [0.52233957]


portfolio before change:  [0.02936566]
curr_Stock_Price:  98.49159253095155
curr_Factors:  [98.49159253 -0.91421361 -1.01656756]
mat_Sqrt:  [[14.28471406  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00802244 -0.02129768 -1.03914238]
Stock Position:  -0.008022435651430003
Bond Position:  [0.81950812]


portfolio before change:  [0.02632124]
curr_Stock_Price:  98.92216941456749
curr_Factors:  [98.92216941 -0.80968461 -1.02711579]
mat_Sqrt:  [[15.76091223  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00197337 -0.03670049 -0.48499467]
Stock Position:  0.0019733667420461527
Bond Position:  [-0.16888848]


portfolio before change:  [0.0276728]
curr_Stock_Price:  99.64987389063738
curr_Factors:  [99.64987389 -0.297336   -1.00514235]
mat_Sqrt:  [[27.09053568  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00108797  0.00241304 -0.27569098]
Stock Position:  0.0010879685541111928
Bond Position:  [-0.08074313]


portfolio before change:  [0.02464236]
curr_Stock_Price:  96.90157549493759
curr_Factors:  [96.90157549 -0.55812853 -0.93212354]
mat_Sqrt:  [[21.83346102  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00681626 -0.03455126  0.34928677]
Stock Position:  0.006816255281325728
Bond Position:  [-0.63586352]


portfolio before change:  [0.01835434]
curr_Stock_Price:  96.02572703647604
curr_Factors:  [96.02572704 -1.21593949 -0.93634665]
mat_Sqrt:  [[11.15993363  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01095278 0.01339598 0.04991973]
Stock Position:  0.01095277828302382
Bond Position:  [-1.03339416]


portfolio before change:  [0.01726339]
curr_Stock_Price:  95.97330898107771
curr_Factors:  [95.97330898 -1.50905456 -0.97539172]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.01726339]
Stock Price:  97.2002936092001
PL:  [0.01726339]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 7.79713574e-03 -4.03139315e-02  7.62710098e-02]
 [-8.19964156e-02  7.69797467e-02  1.26608450e-02]
 [-8.18173663e-02  9.22648637e-04 -4.91385007e-02]
 [-1.12852747e-01 -7.63722436e-02 -3.85850547e-01]
 [ 7.36022390e-02 -8.13914103e-02 -1.85656426e-01]
 [ 9.21390558e-02  1.37407775e-01 -1.63150255e-02]
 [ 7.86080290e-02 -9.49822204e-02  6.02640835e-02]
 [ 9.55116047e-02  2.36149046e-02  9.05768203e-03]
 [-9.64971965e-02 -7.82558469e-02  3.01528048e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.96996795]
curr_Stock_Price:  98.7314412465598
curr_Factors:  [98.73144125 -0.73334577 -0.97096036]
mat_Sqrt:  [[17.95910673  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012431  -0.01274838  0.21757996]
Stock Position:  0.0012431013145478831
Bond Position:  [-7.09270113]


portfolio before change:  [-6.97457215]
curr_Stock_Price:  97.88117842620287
curr_Factors:  [97.88117843 -1.13365979 -1.03424795]
mat_Sqrt:  [[11.19924691  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00691336  0.02434313  0.03611787]
Stock Position:  -0.006913359761103164
Bond Position:  [-6.29788435]


portfolio before change:  [-6.96662454]
curr_Stock_Price:  96.2759761127664
curr_Factors:  [96.27597611 -1.06594    -1.02692294]
mat_Sqrt:  [[11.87405632  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00773315  0.00029177 -0.14017846]
Stock Position:  -0.007733153322207502
Bond Position:  [-6.22210765]


portfolio before change:  [-6.96484434]
curr_Stock_Price:  95.64337230172858
curr_Factors:  [95.6433723  -0.94301867 -1.07138627]
mat_Sqrt:  [[12.75880302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01517275 -0.02415102 -1.10072421]
Stock Position:  -0.015172746394560161
Bond Position:  [-5.51367171]


portfolio before change:  [-6.98887402]
curr_Stock_Price:  97.04536944981338
curr_Factors:  [97.04536945 -1.23810286 -1.00897615]
mat_Sqrt:  [[10.25842769  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00327572 -0.02573822 -0.52962611]
Stock Position:  0.0032757225226001346
Bond Position:  [-7.30676772]


portfolio before change:  [-6.99515523]
curr_Stock_Price:  96.24343535806383
curr_Factors:  [96.24343536 -1.79142485 -0.96291994]
mat_Sqrt:  [[ 6.12596305  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01507626  0.04345215 -0.04654223]
Stock Position:  0.0150762611454349
Bond Position:  [-8.44614639]


portfolio before change:  [-6.99049311]
curr_Stock_Price:  96.83285541009519
curr_Factors:  [96.83285541 -1.53574067 -1.02110683]
mat_Sqrt:  [[ 7.50927451  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01177969 -0.03003602  0.17191666]
Stock Position:  0.01177969362832249
Bond Position:  [-8.13115448]


portfolio before change:  [-6.9827693]
curr_Stock_Price:  97.83376450510325
curr_Factors:  [97.83376451 -1.08116663 -1.0197742 ]
mat_Sqrt:  [[11.96910719  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00818526 0.00746769 0.02583905]
Stock Position:  0.008185258014170735
Bond Position:  [-7.7835639]


portfolio before change:  [-6.97843685]
curr_Stock_Price:  98.83864455934257
curr_Factors:  [98.83864456 -1.39597231 -1.04315732]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.97843685]
Stock Price:  99.53162008166922
PL:  [-6.97843685]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.34491066e-02  3.93985694e-02 -9.50939564e-02]
 [-1.30617997e-01  7.35342927e-02 -2.79428792e-03]
 [-1.04932538e-01  4.33844415e-02 -6.62916258e-02]
 [-4.79229003e-02 -1.01462189e-01 -5.37937239e-01]
 [ 6.87194919e-02 -1.16653253e-01 -1.69742179e-01]
 [ 5.96267546e-02  5.11429356e-02 -6.40425416e-02]
 [ 8.72761919e-02  4.14784296e-02 -5.01235169e-03]
 [ 9.18328087e-02  2.19943630e-02  8.87288346e-03]
 [-1.03100811e-01 -8.32466611e-02  1.33990723e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.98426868]
curr_Stock_Price:  99.83968980035532
curr_Factors:  [99.8396898  -1.04173599 -0.99813271]
mat_Sqrt:  [[12.98373087  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0047631   0.01245892 -0.27127659]
Stock Position:  -0.004763100308545966
Bond Position:  [1.45981514]


portfolio before change:  [0.99631262]
curr_Stock_Price:  97.46437792236871
curr_Factors:  [97.46437792 -1.10163044 -0.96012152]
mat_Sqrt:  [[12.40047771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01042619  0.02325359 -0.00797133]
Stock Position:  -0.01042618957637774
Bond Position:  [2.0124947]


portfolio before change:  [0.98695302]
curr_Stock_Price:  98.45861428432816
curr_Factors:  [98.45861428 -1.78327822 -0.90646965]
mat_Sqrt:  [[ 6.68514852  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01755295  0.01371937 -0.18911156]
Stock Position:  -0.017552950083809984
Bond Position:  [2.71519217]


portfolio before change:  [0.98622021]
curr_Stock_Price:  98.57772521987158
curr_Factors:  [98.57772522 -1.40099446 -0.90954361]
mat_Sqrt:  [[ 9.77968474  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01639609 -0.03208516 -1.53458521]
Stock Position:  -0.016396093133703115
Bond Position:  [2.60250977]


portfolio before change:  [0.98237869]
curr_Stock_Price:  98.89140382058969
curr_Factors:  [98.89140382 -0.97055608 -0.89814821]
mat_Sqrt:  [[15.26126676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00203515 -0.036889   -0.48422719]
Stock Position:  0.0020351548251509284
Bond Position:  [0.78111937]


portfolio before change:  [0.98347286]
curr_Stock_Price:  99.23708360822857
curr_Factors:  [99.23708361 -0.73250368 -0.88173704]
mat_Sqrt:  [[19.75232185  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00242375  0.01617282 -0.18269555]
Stock Position:  0.0024237469828688987
Bond Position:  [0.74294727]


portfolio before change:  [0.98567608]
curr_Stock_Price:  99.99279476362321
curr_Factors:  [99.99279476 -0.73362083 -0.83392871]
mat_Sqrt:  [[20.85405887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00418739  0.01311663 -0.01429884]
Stock Position:  0.004187387157997539
Bond Position:  [0.56696753]


portfolio before change:  [0.98103058]
curr_Stock_Price:  98.81567626652262
curr_Factors:  [98.81567627 -0.96195811 -0.82244017]
mat_Sqrt:  [[16.59096009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00567851 0.00695523 0.02531187]
Stock Position:  0.005678506244373106
Bond Position:  [0.41990514]


portfolio before change:  [0.97799309]
curr_Stock_Price:  98.24378422037994
curr_Factors:  [98.24378422 -0.68727027 -0.86094243]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.97799309]
Stock Price:  98.12023704649185
PL:  [0.97799309]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.41722522e-02  3.88284935e-02 -9.34070412e-02]
 [-2.05949168e-01  9.09759824e-02 -1.51512467e-02]
 [-1.33899936e-01  9.65965755e-02 -8.77875243e-02]
 [ 8.05300848e-03  2.12605042e-03 -4.25320287e-02]
 [ 6.70994357e-02 -1.28352849e-01 -1.64461960e-01]
 [-4.23869149e-02 -2.17622904e-02  1.31906075e-03]
 [ 6.78758231e-02  5.15312795e-02 -2.25230114e-01]
 [ 1.09044638e-01  4.07563690e-02 -2.70417845e-02]
 [-9.46940733e-02 -7.83798637e-02  7.04334189e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.34854761]
curr_Stock_Price:  99.65399105903727
curr_Factors:  [99.65399106 -0.37414046 -1.00924036]
mat_Sqrt:  [[24.98619002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249083  0.01227865 -0.26646429]
Stock Position:  -0.002490829420139172
Bond Position:  [-0.10032652]


portfolio before change:  [-0.34922916]
curr_Stock_Price:  99.90746824801928
curr_Factors:  [ 9.99074682e+01 -1.63126117e-02 -1.01305630e+00]
mat_Sqrt:  [[35.69017802  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00579131  0.02876913 -0.04322229]
Stock Position:  -0.005791310806407358
Bond Position:  [0.22936604]


portfolio before change:  [-0.3707596]
curr_Stock_Price:  103.64499121802902
curr_Factors:  [ 1.03644991e+02  6.83069268e-02 -1.00866525e+00]
mat_Sqrt:  [[40.472114    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00368959  0.03054652 -0.25043337]
Stock Position:  -0.0036895867656009224
Bond Position:  [0.01164759]


portfolio before change:  [-0.35544322]
curr_Stock_Price:  99.4953250399226
curr_Factors:  [99.49532504 -0.16266105 -1.00268915]
mat_Sqrt:  [[31.02398024  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.84989523e-05  6.72316176e-04 -1.21332039e-01]
Stock Position:  -1.8498952297902984e-05
Bond Position:  [-0.35360266]


portfolio before change:  [-0.35570893]
curr_Stock_Price:  104.29897115347077
curr_Factors:  [104.29897115  -0.63832991  -1.0033716 ]
mat_Sqrt:  [[20.19752319  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00149596 -0.04058873 -0.46916419]
Stock Position:  0.001495961763233925
Bond Position:  [-0.5117362]


portfolio before change:  [-0.35431865]
curr_Stock_Price:  105.39940731811643
curr_Factors:  [105.39940732  -1.2006957   -1.01119651]
mat_Sqrt:  [[11.54052555  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00369823 -0.00688184  0.00376291]
Stock Position:  -0.003698233885618825
Bond Position:  [0.03547301]


portfolio before change:  [-0.35096168]
curr_Stock_Price:  104.49648224628243
curr_Factors:  [104.49648225  -0.6897472   -1.01484873]
mat_Sqrt:  [[19.00225155  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00122256  0.01629562 -0.64251882]
Stock Position:  0.001222563041679437
Bond Position:  [-0.47871522]


portfolio before change:  [-0.3568597]
curr_Stock_Price:  99.86800660898336
curr_Factors:  [99.86800661 -0.25205707 -1.03772044]
mat_Sqrt:  [[27.49686138  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00380324  0.0128883  -0.07714268]
Stock Position:  0.003803237039450109
Bond Position:  [-0.73668141]


portfolio before change:  [-0.3526609]
curr_Stock_Price:  101.06888900151421
curr_Factors:  [101.068889    -0.84494943  -1.08206697]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.3526609]
Stock Price:  100.83247415945759
PL:  [-1.18513506]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.64192353e-02  3.70571338e-02 -8.81653990e-02]
 [-1.02903921e-01  9.20784877e-02  1.44495561e-02]
 [-8.14865228e-02  3.14900245e-04 -4.88929910e-02]
 [-4.76982728e-02 -1.00648619e-01 -5.33795245e-01]
 [ 7.11480144e-02 -9.91151386e-02 -1.77657417e-01]
 [ 7.96538341e-02  1.33172416e-01 -2.58701840e-03]
 [ 3.14974588e-02 -1.35352502e-02  1.85839743e-03]
 [ 9.36979834e-02  2.28159886e-02  8.96657760e-03]
 [-9.36381039e-02 -6.89348114e-02  3.54969933e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.83185999]
curr_Stock_Price:  99.58665207089123
curr_Factors:  [99.58665207 -0.81293268 -0.93600737]
mat_Sqrt:  [[17.32391808  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366309  0.01171849 -0.25151134]
Stock Position:  -0.003663092302094652
Bond Position:  [-0.46706489]


portfolio before change:  [-0.83338652]
curr_Stock_Price:  99.93961561305476
curr_Factors:  [99.93961561 -0.68885084 -0.93947861]
mat_Sqrt:  [[19.61386498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0049749   0.02911777  0.04122056]
Stock Position:  -0.004974897146038166
Bond Position:  [-0.33619721]


portfolio before change:  [-0.82091185]
curr_Stock_Price:  97.39829468182519
curr_Factors:  [97.39829468 -0.94798109 -0.96400518]
mat_Sqrt:  [[14.39415799  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.35387163e-03  9.95802009e-05 -1.39478094e-01]
Stock Position:  -0.00635387162755957
Bond Position:  [-0.20205559]


portfolio before change:  [-0.82788704]
curr_Stock_Price:  98.48017578333246
curr_Factors:  [98.48017578 -1.37213648 -0.98990879]
mat_Sqrt:  [[ 9.27952168  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01716225 -0.03182789 -1.52276925]
Stock Position:  -0.01716225388886946
Bond Position:  [0.86225474]


portfolio before change:  [-0.81433577]
curr_Stock_Price:  97.71570548345397
curr_Factors:  [97.71570548 -1.50363045 -0.9854502 ]
mat_Sqrt:  [[ 8.10905752  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00398625 -0.03134296 -0.50680716]
Stock Position:  0.003986246742462658
Bond Position:  [-1.20385468]


portfolio before change:  [-0.81315928]
curr_Stock_Price:  98.16188173992434
curr_Factors:  [98.16188174 -1.8120468  -0.96552343]
mat_Sqrt:  [[ 6.10463147  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01352486  0.04211282 -0.00738004]
Stock Position:  0.013524855433613786
Bond Position:  [-2.14078454]


portfolio before change:  [-0.81518397]
curr_Stock_Price:  98.09134279493793
curr_Factors:  [98.09134279 -1.6150023  -0.95442119]
mat_Sqrt:  [[ 7.51180382  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00419704 -0.00428022  0.00530149]
Stock Position:  0.004197037708823976
Bond Position:  [-1.22687703]


portfolio before change:  [-0.81482396]
curr_Stock_Price:  98.32331608810564
curr_Factors:  [98.32331609 -1.31758735 -0.92539532]
mat_Sqrt:  [[10.43617907  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00921002 0.00721505 0.02557915]
Stock Position:  0.00921001680578512
Bond Position:  [-1.72038335]


portfolio before change:  [-0.81178025]
curr_Stock_Price:  98.74721455412482
curr_Factors:  [98.74721455 -1.33245706 -0.94924166]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.81178025]
Stock Price:  100.53183757765476
PL:  [-1.34361783]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-4.85644131e-02  7.45529132e-02  2.08480245e-02]
 [-9.33908354e-02  2.21827219e-02 -5.77268497e-02]
 [-2.81519790e-02 -5.21224800e-02 -2.89938164e-01]
 [ 6.87197278e-02 -1.16651549e-01 -1.69742948e-01]
 [ 7.46320594e-02  1.12603587e-01 -1.79969433e-02]
 [ 9.26730031e-02 -5.08130525e-02  8.03046371e-02]
 [ 9.73939876e-02  2.44441106e-02  9.15224060e-03]
 [-9.87387395e-02 -7.70685225e-02  1.13696096e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.67607069]
curr_Stock_Price:  99.93607724861471
curr_Factors:  [99.93607725 -1.29374145 -1.00103793]
mat_Sqrt:  [[10.07192012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00612917  0.01250945 -0.27262553]
Stock Position:  -0.006129169247244188
Bond Position:  [2.28859582]


portfolio before change:  [1.68526853]
curr_Stock_Price:  98.62215417602496
curr_Factors:  [98.62215418 -0.88047988 -0.94996944]
mat_Sqrt:  [[15.81322479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268028  0.0235757   0.05947361]
Stock Position:  -0.0026802806223971375
Bond Position:  [1.94960358]


portfolio before change:  [1.68299939]
curr_Stock_Price:  99.83254405089792
curr_Factors:  [99.83254405 -1.15643464 -0.93464924]
mat_Sqrt:  [[12.33462498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00848032  0.00701479 -0.16467863]
Stock Position:  -0.008480316511203984
Bond Position:  [2.52961096]


portfolio before change:  [1.68692699]
curr_Stock_Price:  99.51858394828652
curr_Factors:  [99.51858395 -0.84671416 -0.91554269]
mat_Sqrt:  [[17.0830638   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00519117 -0.01648258 -0.82711288]
Stock Position:  -0.00519117393032641
Bond Position:  [2.20354527]


portfolio before change:  [1.69064228]
curr_Stock_Price:  99.01518333743586
curr_Factors:  [99.01518334 -0.84202327 -0.8983452 ]
mat_Sqrt:  [[17.37278216  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00178781 -0.03688846 -0.48422938]
Stock Position:  0.0017878059678831735
Bond Position:  [1.51362234]


portfolio before change:  [1.69048899]
curr_Stock_Price:  98.50601446113244
curr_Factors:  [98.50601446 -1.04566689 -0.88066869]
mat_Sqrt:  [[14.35046046  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00514728  0.03560838 -0.05134027]
Stock Position:  0.005147281583580124
Bond Position:  [1.18345079]


portfolio before change:  [1.68905195]
curr_Stock_Price:  98.1118444359363
curr_Factors:  [98.11184444 -1.01620754 -0.8386103 ]
mat_Sqrt:  [[15.35268305  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00701852 -0.0160685   0.22908678]
Stock Position:  0.007018521177873411
Bond Position:  [1.0004519]


portfolio before change:  [1.70465896]
curr_Stock_Price:  100.26424234723395
curr_Factors:  [100.26424235  -0.87708184  -0.86276574]
mat_Sqrt:  [[17.60110254  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0056754  0.00772991 0.02610879]
Stock Position:  0.005675401575712803
Bond Position:  [1.13561912]


portfolio before change:  [1.69871018]
curr_Stock_Price:  99.11600121384177
curr_Factors:  [99.11600121 -0.478984   -0.89447157]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.69871018]
Stock Price:  99.16359265955863
PL:  [1.69871018]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.56933566e-02  3.76293643e-02 -8.98586900e-02]
 [-1.44051250e-01  7.29677524e-02 -6.86821560e-03]
 [-7.89299642e-02 -4.38141177e-03 -4.69958401e-02]
 [ 1.29689280e-02 -8.55148671e-02 -4.80700258e-01]
 [ 7.45092238e-02 -7.48414185e-02 -1.88612544e-01]
 [ 7.96538341e-02  1.33172416e-01 -2.58701840e-03]
 [ 7.03154663e-02 -8.10698652e-02  4.99671899e-02]
 [ 1.10501031e-01  3.48223871e-02  1.35494244e-02]
 [-1.00599199e-01 -7.64653338e-02  1.33595996e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.53818667]
curr_Stock_Price:  99.62756901225585
curr_Factors:  [99.62756901 -0.93134155 -1.00286121]
mat_Sqrt:  [[14.40011471  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00437942  0.01189945 -0.25634183]
Stock Position:  -0.004379416426371855
Bond Position:  [-0.10187606]


portfolio before change:  [-0.53043078]
curr_Stock_Price:  97.84494774692145
curr_Factors:  [97.84494775 -0.72810763 -0.98956401]
mat_Sqrt:  [[17.56155995  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0081752   0.02307443 -0.01959311]
Stock Position:  -0.008175196272350395
Bond Position:  [0.26947087]


portfolio before change:  [-0.53083799]
curr_Stock_Price:  97.91124359569731
curr_Factors:  [97.9112436  -0.7909894  -1.03308082]
mat_Sqrt:  [[15.79970345  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00560998 -0.00138552 -0.13406605]
Stock Position:  -0.005609983616198436
Bond Position:  [0.01844248]


portfolio before change:  [-0.52486104]
curr_Stock_Price:  96.84747334229772
curr_Factors:  [96.84747334 -1.02633855 -0.99070759]
mat_Sqrt:  [[12.88535201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00677991 -0.02704218 -1.37130403]
Stock Position:  -0.006779914552205399
Bond Position:  [0.13175656]


portfolio before change:  [-0.52234007]
curr_Stock_Price:  96.48536399668136
curr_Factors:  [96.485364   -1.39642596 -1.00470122]
mat_Sqrt:  [[ 8.74309411  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00389753 -0.02366693 -0.53805909]
Stock Position:  0.003897527790916154
Bond Position:  [-0.89839446]


portfolio before change:  [-0.52125624]
curr_Stock_Price:  96.87872646841396
curr_Factors:  [96.87872647 -1.46570481 -1.02594031]
mat_Sqrt:  [[ 8.0190089   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01029607  0.04211282 -0.00738004]
Stock Position:  0.010296067644571371
Bond Position:  [-1.51872616]


portfolio before change:  [-0.5155232]
curr_Stock_Price:  97.50931575521683
curr_Factors:  [97.50931576 -1.21713129 -1.05201708]
mat_Sqrt:  [[10.08248295  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00777802 -0.02563654  0.14254248]
Stock Position:  0.007778020722145694
Bond Position:  [-1.27395268]


portfolio before change:  [-0.52266634]
curr_Stock_Price:  96.67285602381729
curr_Factors:  [96.67285602 -0.86211381 -1.0413458 ]
mat_Sqrt:  [[14.40928874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00792308 0.01101181 0.03865274]
Stock Position:  0.007923077146754533
Bond Position:  [-1.28861283]


portfolio before change:  [-0.51013718]
curr_Stock_Price:  98.33554696802308
curr_Factors:  [98.33554697 -0.48728922 -1.05150477]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.51013718]
Stock Price:  99.91044898583849
PL:  [-0.51013718]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-2.18757727e-02 -5.77719079e-04 -7.40599011e-03]
 [-8.06144986e-02  8.98457639e-02  1.95953062e-02]
 [-8.99691594e-02  1.58972183e-02 -5.51877193e-02]
 [ 9.63055280e-03  4.88000762e-03 -2.83327399e-02]
 [-6.87256107e-02  7.74210640e-02  9.22957981e-02]
 [ 1.34079625e-01  1.51635266e-01 -6.24303807e-02]
 [ 2.30176237e-01 -2.45551249e-01  2.65916884e-01]
 [ 1.01743705e-01  1.23155737e-01  3.29994135e-02]
 [-1.27297036e-01 -1.57393671e-01  1.08098513e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.59156754]
curr_Stock_Price:  99.06281921908426
curr_Factors:  [99.06281922 -0.9271519  -1.00411027]
mat_Sqrt:  [[14.36065281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162962 -0.00018269 -0.02112723]
Stock Position:  -0.001629621652390492
Bond Position:  [-4.43013263]


portfolio before change:  [-4.59496926]
curr_Stock_Price:  99.79065662032592
curr_Factors:  [99.79065662 -0.69623759 -0.98880561]
mat_Sqrt:  [[18.50482206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00401489  0.02841173  0.05589995]
Stock Position:  -0.0040148895001921115
Bond Position:  [-4.1943208]


portfolio before change:  [-4.5975215]
curr_Stock_Price:  99.90387269432468
curr_Factors:  [99.90387269 -0.62048619 -1.00346182]
mat_Sqrt:  [[19.69294487  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0051198   0.00502714 -0.1574352 ]
Stock Position:  -0.005119795019700929
Bond Position:  [-4.08603415]


portfolio before change:  [-4.5979022]
curr_Stock_Price:  99.57908969865642
curr_Factors:  [99.5790897  -0.15063262 -0.94229724]
mat_Sqrt:  [[33.38218392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00011902  0.00154319 -0.08082542]
Stock Position:  0.00011902030553797435
Bond Position:  [-4.60975414]


portfolio before change:  [-4.60080183]
curr_Stock_Price:  94.58690968833855
curr_Factors:  [94.58690969 -0.59784704 -0.91311604]
mat_Sqrt:  [[20.87507799  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00229397  0.02448269  0.26329422]
Stock Position:  -0.002293970186698234
Bond Position:  [-4.38382228]


portfolio before change:  [-4.60142313]
curr_Stock_Price:  93.90200229970003
curr_Factors:  [93.9020023  -0.61081723 -0.93678962]
mat_Sqrt:  [[19.97826352  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00626938  0.04795128 -0.1780965 ]
Stock Position:  0.006269377856365636
Bond Position:  [-5.19013026]


portfolio before change:  [-4.61199848]
curr_Stock_Price:  92.62920611275605
curr_Factors:  [92.62920611 -0.74926427 -0.89702088]
mat_Sqrt:  [[17.8556385   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01557582 -0.07765012  0.75858685]
Stock Position:  0.015575818686854296
Bond Position:  [-6.0547742]


portfolio before change:  [-4.63949908]
curr_Stock_Price:  91.05802394180607
curr_Factors:  [91.05802394 -0.59869015 -0.89260265]
mat_Sqrt:  [[20.49547507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00544801 0.03894526 0.09413814]
Stock Position:  0.005448009825124283
Bond Position:  [-5.13558409]


portfolio before change:  [-4.62512588]
curr_Stock_Price:  94.16771478836955
curr_Factors:  [94.16771479 -0.79440654 -0.98803746]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.62512588]
Stock Price:  93.37657848584588
PL:  [-4.62512588]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-3.05333857e-01 -3.15919347e-02 -1.46340242e-01]
 [-1.10853193e-01  5.42604844e-02 -7.06851785e-02]
 [ 2.69400738e-02 -4.21764429e-02 -2.96724602e-01]
 [ 6.83827790e-02 -1.19084900e-01 -1.68644737e-01]
 [ 4.47180146e-02 -9.92219363e-03 -1.09791819e-01]
 [ 1.76659992e-02  1.12695597e-01 -9.94540003e-02]
 [ 1.09181848e-01  2.96367653e-02  9.74438534e-03]
 [-8.91140982e-02 -7.14288346e-02  9.74372075e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.2727145]
curr_Stock_Price:  100.01920648843135
curr_Factors:  [100.01920649  -1.36237798  -1.00622278]
mat_Sqrt:  [[ 9.36295992  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00659327  0.01250945 -0.27262553]
Stock Position:  -0.00659326789711227
Bond Position:  [2.93216792]


portfolio before change:  [2.26199047]
curr_Stock_Price:  101.8681356906164
curr_Factors:  [101.86813569  -1.63757977  -0.98742308]
mat_Sqrt:  [[ 7.37928197  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04553575 -0.00999025 -0.41746798]
Stock Position:  -0.04553574937186758
Bond Position:  [6.90063236]


portfolio before change:  [2.25930945]
curr_Stock_Price:  102.00280336088035
curr_Factors:  [102.00280336  -1.32672147  -0.97212763]
mat_Sqrt:  [[10.23845974  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01209955  0.01715867 -0.20164514]
Stock Position:  -0.012099548937739782
Bond Position:  [3.49349736]


portfolio before change:  [2.27585892]
curr_Stock_Price:  100.77942858149201
curr_Factors:  [100.77942858  -0.91641147  -1.02136121]
mat_Sqrt:  [[14.51469479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00239189 -0.01333736 -0.8464727 ]
Stock Position:  -0.0023918913615650567
Bond Position:  [2.51691237]


portfolio before change:  [2.27408998]
curr_Stock_Price:  102.04525139583407
curr_Factors:  [102.0452514   -1.04655206  -1.01721757]
mat_Sqrt:  [[12.95713668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00238352 -0.03765795 -0.48109649]
Stock Position:  0.0023835171404624203
Bond Position:  [2.03086338]


portfolio before change:  [2.27712808]
curr_Stock_Price:  102.89374924492914
curr_Factors:  [102.89374924  -1.13130587  -0.98179517]
mat_Sqrt:  [[12.43600453  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00177313 -0.00313767 -0.3132055 ]
Stock Position:  0.0017731308601834357
Bond Position:  [2.09468399]


portfolio before change:  [2.27615545]
curr_Stock_Price:  101.75439386766104
curr_Factors:  [101.75439387  -1.02339788  -1.02005134]
mat_Sqrt:  [[13.18543467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.08430105e-05  3.56374768e-02 -2.83714580e-01]
Stock Position:  2.084301052076678e-05
Bond Position:  [2.27403459]


portfolio before change:  [2.27726604]
curr_Stock_Price:  100.47261559454036
curr_Factors:  [100.47261559  -1.60637228  -0.97304138]
mat_Sqrt:  [[ 7.61767762  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01469426 0.00937197 0.02779802]
Stock Position:  0.014694259273399407
Bond Position:  [0.80089538]


portfolio before change:  [2.29197618]
curr_Stock_Price:  101.4464376953362
curr_Factors:  [101.4464377   -1.02398038  -0.99713005]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.29197618]
Stock Price:  99.84801123129563
PL:  [2.29197618]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 6.82604910e-02  9.56961110e-03 -6.93910804e-02]
 [-1.15360183e-01  7.10272662e-02  2.30292830e-04]
 [ 1.41334708e-01  4.21088940e-02 -2.12446540e-01]
 [ 2.83331337e-02  1.42646542e-03 -5.39705196e-02]
 [ 3.19195687e-02 -8.65408230e-02 -1.48120070e-01]
 [ 7.96538341e-02  1.33172416e-01 -2.58701840e-03]
 [ 1.19937647e-01 -8.95181241e-02  1.14426694e-01]
 [ 1.04381725e-01  2.82926389e-02  1.01287834e-02]
 [-1.16532581e-01 -1.23915624e-01  1.21323797e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.0488576]
curr_Stock_Price:  101.65995394966521
curr_Factors:  [101.65995395  -0.80888981  -0.97437425]
mat_Sqrt:  [[17.08787927  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00318022  0.00302618 -0.19795344]
Stock Position:  0.003180218061281675
Bond Position:  [13.72555678]


portfolio before change:  [14.04643066]
curr_Stock_Price:  98.73832020264005
curr_Factors:  [98.7383202  -0.32208834 -0.94112856]
mat_Sqrt:  [[27.91756947  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0040648   0.02246079  0.00065696]
Stock Position:  -0.004064797215768466
Bond Position:  [14.44778191]


portfolio before change:  [14.06560101]
curr_Stock_Price:  95.79976047573253
curr_Factors:  [ 9.57997605e+01  3.57469361e-02 -9.07514870e-01]
mat_Sqrt:  [[40.06456394  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00247242  0.013316   -0.60605085]
Stock Position:  0.0024724214378983272
Bond Position:  [13.82874362]


portfolio before change:  [14.08304721]
curr_Stock_Price:  100.05878453548193
curr_Factors:  [100.05878454  -0.25277952  -0.90728667]
mat_Sqrt:  [[31.36497002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00055327  0.00045109 -0.15396287]
Stock Position:  0.0005532694166083616
Bond Position:  [14.02768774]


portfolio before change:  [14.08866748]
curr_Stock_Price:  97.5368248724139
curr_Factors:  [97.53682487 -0.80485324 -0.8807452 ]
mat_Sqrt:  [[18.07683994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.04139698e-05 -2.73666111e-02 -4.22545332e-01]
Stock Position:  -3.04139698172089e-05
Bond Position:  [14.09163397]


portfolio before change:  [14.09573314]
curr_Stock_Price:  96.94257841326807
curr_Factors:  [96.94257841 -0.76355231 -0.85681594]
mat_Sqrt:  [[19.17774669  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00430521  0.04211282 -0.00738004]
Stock Position:  0.004305211632051345
Bond Position:  [13.67837482]


portfolio before change:  [14.10388815]
curr_Stock_Price:  97.24781698342468
curr_Factors:  [97.24781698 -0.71887225 -0.86580317]
mat_Sqrt:  [[19.93719575  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00707138 -0.02830812  0.32642751]
Stock Position:  0.007071383158698445
Bond Position:  [13.41621157]


portfolio before change:  [14.1105009]
curr_Stock_Price:  97.2340956767091
curr_Factors:  [97.23409568 -1.66250299 -0.8240185 ]
mat_Sqrt:  [[ 8.08976714  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01324881 0.00894692 0.0288946 ]
Stock Position:  0.013248807475254308
Bond Position:  [12.82226509]


portfolio before change:  [14.11633904]
curr_Stock_Price:  97.190725629121
curr_Factors:  [97.19072563 -1.52420061 -0.85986586]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.11633904]
Stock Price:  97.36490411968732
PL:  [14.11633904]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-3.24831456e-01 -2.92618876e-02 -1.36172012e-01]
 [-1.17684970e-01  6.68102296e-02 -7.57548501e-02]
 [ 2.33598306e-01  2.65651285e-04 -1.68968232e-01]
 [ 6.67188301e-02 -1.29743798e-01 -1.63442104e-01]
 [-1.54757747e-01 -7.23949457e-02  9.99483107e-02]
 [ 1.41968409e-01 -1.30879538e-02 -3.64509129e-01]
 [ 3.37075832e-01  2.00663414e-01 -2.11185245e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.64264212]
curr_Stock_Price:  100.07074779534229
curr_Factors:  [100.0707478   -0.96490687  -1.01298438]
mat_Sqrt:  [[13.84585853  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00445855  0.01250945 -0.27262553]
Stock Position:  -0.004458553648635888
Bond Position:  [3.08881292]


portfolio before change:  [2.63649901]
curr_Stock_Price:  101.79505157593934
curr_Factors:  [101.79505158  -0.59768611  -1.00859111]
mat_Sqrt:  [[20.42346082  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0173028  -0.00925342 -0.38846085]
Stock Position:  -0.01730279668846707
Bond Position:  [4.3978381]


portfolio before change:  [2.62772452]
curr_Stock_Price:  102.42928193368061
curr_Factors:  [102.42928193  -0.94895044  -1.02739342]
mat_Sqrt:  [[14.19413389  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00925899  0.02112725 -0.2161075 ]
Stock Position:  -0.009258989134978657
Bond Position:  [3.57611613]


portfolio before change:  [2.61152154]
curr_Stock_Price:  104.37241923628979
curr_Factors:  [104.37241924  -0.98756045  -0.98566646]
mat_Sqrt:  [[14.50855603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.37239480e-02  8.40063123e-05 -4.82019333e-01]
Stock Position:  0.0137239480198222
Bond Position:  [1.17911989]


portfolio before change:  [2.61727806]
curr_Stock_Price:  104.74890065459817
curr_Factors:  [104.74890065  -0.41677626  -0.95416572]
mat_Sqrt:  [[26.59236341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112838 -0.04102859 -0.46625483]
Stock Position:  0.0011283833392506375
Bond Position:  [2.49908115]


portfolio before change:  [2.62151412]
curr_Stock_Price:  107.39534383622644
curr_Factors:  [107.39534384  -0.86683075  -0.899191  ]
mat_Sqrt:  [[18.36588897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00741729 -0.02289329  0.28512471]
Stock Position:  -0.007417289339486574
Bond Position:  [3.41809646]


portfolio before change:  [2.61653021]
curr_Stock_Price:  108.29774717899556
curr_Factors:  [108.29774718  -1.23321691  -0.8783227 ]
mat_Sqrt:  [[13.10959933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00512795 -0.00413877 -1.03984308]
Stock Position:  0.005127949628429271
Bond Position:  [2.06118481]


portfolio before change:  [2.60885496]
curr_Stock_Price:  106.59997369139866
curr_Factors:  [106.59997369  -0.62970043  -0.86175899]
mat_Sqrt:  [[23.9896825   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0124699   0.06345534 -0.60245272]
Stock Position:  0.012469899579336908
Bond Position:  [1.27956399]


portfolio before change:  [2.59896624]
curr_Stock_Price:  105.755647660401
curr_Factors:  [105.75564766  -0.31846399  -0.88986894]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.59896624]
Stock Price:  106.20437867165337
PL:  [-3.60541243]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-1.00370654e-03 -2.78250041e-02  4.97492827e-02]
 [-1.91437146e-01  6.81529735e-02 -2.26716937e-02]
 [-9.90408258e-02  3.25615639e-02 -6.19195501e-02]
 [ 4.51116116e-02  8.26065935e-03 -2.36049285e-02]
 [ 6.87224579e-02 -1.16631833e-01 -1.69751846e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 6.41401371e-02  9.51905919e-02 -1.45210611e-01]
 [ 1.48220397e-01  7.08263426e-02 -6.72241508e-02]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.1474647]
curr_Stock_Price:  98.84603904851329
curr_Factors:  [98.84603905 -0.62570706 -0.92962307]
mat_Sqrt:  [[20.86834364  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0004041  -0.00879904  0.14192086]
Stock Position:  0.0004040993817704943
Bond Position:  [-6.18740832]


portfolio before change:  [-6.15088923]
curr_Stock_Price:  98.0292736938665
curr_Factors:  [98.02927369 -0.28444899 -0.90944003]
mat_Sqrt:  [[29.70683409  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00654076  0.02155186 -0.06467603]
Stock Position:  -0.00654076038950253
Bond Position:  [-5.50970324]


portfolio before change:  [-6.17107059]
curr_Stock_Price:  100.69346171949435
curr_Factors:  [100.69346172  -0.4243757   -0.87105637]
mat_Sqrt:  [[27.5678103   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00402061  0.01029687 -0.17663924]
Stock Position:  -0.004020608231520143
Bond Position:  [-5.76622163]


portfolio before change:  [-6.17244073]
curr_Stock_Price:  100.31697942213111
curr_Factors:  [100.31697942  -0.22334876  -0.89387064]
mat_Sqrt:  [[32.82254302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00123411  0.00261225 -0.06733829]
Stock Position:  0.0012341080639612883
Bond Position:  [-6.29624272]


portfolio before change:  [-6.17531642]
curr_Stock_Price:  100.53837095576147
curr_Factors:  [100.53837096  -0.43367878  -0.93369993]
mat_Sqrt:  [[25.61455485  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00121261 -0.03688222 -0.48425477]
Stock Position:  0.0012126147273243317
Bond Position:  [-6.29723073]


portfolio before change:  [-6.17783571]
curr_Stock_Price:  101.05799856798671
curr_Factors:  [101.05799857  -0.64934375  -0.94671629]
mat_Sqrt:  [[20.4838046   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115472 -0.00193948 -0.30510753]
Stock Position:  0.0011547174027385658
Bond Position:  [-6.29452914]


portfolio before change:  [-6.18006286]
curr_Stock_Price:  101.85551184749201
curr_Factors:  [ 1.01855512e+02  3.91810620e-03 -9.88821510e-01]
mat_Sqrt:  [[38.04051801  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00097152  0.03010191 -0.41424545]
Stock Position:  0.0009715155764719178
Bond Position:  [-6.27901708]


portfolio before change:  [-6.18465658]
curr_Stock_Price:  100.35947047023134
curr_Factors:  [100.35947047  -0.20036788  -0.97966429]
mat_Sqrt:  [[30.83733932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00442084  0.02239726 -0.19177179]
Stock Position:  0.004420843554256097
Bond Position:  [-6.6283301]


portfolio before change:  [-6.1647545]
curr_Stock_Price:  105.61120140611202
curr_Factors:  [105.61120141  -0.94589767  -0.94452697]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.1647545]
Stock Price:  103.0910804854866
PL:  [-9.25583498]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-2.48511383e-01  6.18463361e-02 -5.14776570e-02]
 [ 7.87080538e-02  2.58407238e-02 -1.63718272e-01]
 [-2.21688874e-01 -6.29769089e-02 -2.76321723e-01]
 [ 1.18782521e-03 -5.66716310e-02 -1.19661252e-01]
 [ 4.67468092e-02 -1.61239644e-03 -1.03566217e-01]
 [ 6.14012155e-02  1.91205582e-02  4.21384623e-02]
 [ 9.70668862e-02  2.43000196e-02  9.13580917e-03]
 [-7.85286863e-02 -4.05171990e-02  3.24070006e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.44309128]
curr_Stock_Price:  100.6002570964815
curr_Factors:  [100.6002571   -0.7090519   -0.99714943]
mat_Sqrt:  [[18.26439394  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337994  0.01250945 -0.27262553]
Stock Position:  -0.0033799371207205867
Bond Position:  [6.78311382]


portfolio before change:  [6.46045347]
curr_Stock_Price:  96.46710555254346
curr_Factors:  [96.46710555 -0.66560821 -0.93621391]
mat_Sqrt:  [[19.44091674  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01324127  0.01955753 -0.14685143]
Stock Position:  -0.013241266018212437
Bond Position:  [7.73780008]


portfolio before change:  [6.48920914]
curr_Stock_Price:  94.58769335916163
curr_Factors:  [94.58769336 -0.38876825 -0.88348547]
mat_Sqrt:  [[26.50341658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00173398  0.00817155 -0.46704266]
Stock Position:  0.0017339804434372947
Bond Position:  [6.32519593]


portfolio before change:  [6.49155568]
curr_Stock_Price:  94.11661063711828
curr_Factors:  [94.11661064 -0.81420611 -0.86642723]
mat_Sqrt:  [[17.52978105  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01595678 -0.01991505 -0.78826896]
Stock Position:  -0.015956780387351575
Bond Position:  [7.99335377]


portfolio before change:  [6.45276989]
curr_Stock_Price:  96.79781963808578
curr_Factors:  [96.79781964 -0.71858917 -0.88576954]
mat_Sqrt:  [[19.4581452   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126945 -0.01792114 -0.34136024]
Stock Position:  -0.0012694519715127823
Bond Position:  [6.57565007]


portfolio before change:  [6.45189203]
curr_Stock_Price:  100.07995129121765
curr_Factors:  [100.07995129  -1.16992213  -0.88162321]
mat_Sqrt:  [[12.8638885   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00198733 -0.00050988 -0.29544559]
Stock Position:  0.0019873315800146172
Bond Position:  [6.25299998]


portfolio before change:  [6.45291127]
curr_Stock_Price:  99.0192105645263
curr_Factors:  [99.01921056 -1.08968699 -0.91822272]
mat_Sqrt:  [[13.29521456  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00530239 0.00604645 0.1202093 ]
Stock Position:  0.005302387821899173
Bond Position:  [5.92787301]


portfolio before change:  [6.45864651]
curr_Stock_Price:  99.54172239407073
curr_Factors:  [99.54172239 -1.54902966 -0.90090734]
mat_Sqrt:  [[ 8.59035343  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01158965 0.00768434 0.02606192]
Stock Position:  0.011589645303713416
Bond Position:  [5.30499325]


portfolio before change:  [6.47481353]
curr_Stock_Price:  100.70775130859688
curr_Factors:  [100.70775131  -1.26745277  -0.92047653]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.47481353]
Stock Price:  100.11471397948942
PL:  [6.36009955]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 1.66629585e-02  2.34462947e-02 -8.15033672e-02]
 [-2.66640485e-01  4.37540531e-02 -2.85465524e-02]
 [-9.52218114e-02  2.55461632e-02 -5.90855660e-02]
 [ 1.04386681e-01 -3.39524673e-02 -2.92945047e-01]
 [ 6.80934596e-02 -1.21174284e-01 -1.67701763e-01]
 [ 4.47964275e-02 -9.60102004e-03 -1.09551200e-01]
 [ 4.86459925e-02  7.12273850e-02 -1.83797093e-01]
 [ 2.79297260e-01  1.60097674e-01 -1.64367490e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.60788499]
curr_Stock_Price:  101.3198579112747
curr_Factors:  [101.31985791  -0.73206625  -1.02198057]
mat_Sqrt:  [[17.53564386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.60143067e-05  7.41436941e-03 -2.32506421e-01]
Stock Position:  3.6014306732250064e-05
Bond Position:  [11.60423602]


portfolio before change:  [11.61367636]
curr_Stock_Price:  100.98123551742059
curr_Factors:  [100.98123552  -0.71613757  -1.06518864]
mat_Sqrt:  [[17.00671913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01595474  0.01383625 -0.08143537]
Stock Position:  -0.015954741103083123
Bond Position:  [13.22480583]


portfolio before change:  [11.631518]
curr_Stock_Price:  100.27752115893094
curr_Factors:  [100.27752116  -0.7110252   -1.11378755]
mat_Sqrt:  [[16.16953318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00659407  0.00807841 -0.16855467]
Stock Position:  -0.006594068101951355
Bond Position:  [12.2927548]


portfolio before change:  [11.62555569]
curr_Stock_Price:  102.11405364777919
curr_Factors:  [102.11405365  -1.05416503  -1.16134189]
mat_Sqrt:  [[11.14045901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00392379 -0.01073671 -0.83569068]
Stock Position:  0.003923794768577143
Bond Position:  [11.2248811]


portfolio before change:  [11.63257471]
curr_Stock_Price:  102.47217102417441
curr_Factors:  [102.47217102  -1.10994912  -1.21885826]
mat_Sqrt:  [[ 9.982004    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00307882 -0.03831867 -0.47840645]
Stock Position:  0.0030788180331762227
Bond Position:  [11.31708155]


portfolio before change:  [11.64050249]
curr_Stock_Price:  103.20876060026896
curr_Factors:  [103.2087606   -0.67875264  -1.16172512]
mat_Sqrt:  [[16.38352044  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0013542  -0.00303611 -0.31251908]
Stock Position:  0.001354195228982038
Bond Position:  [11.50073768]


portfolio before change:  [11.64907706]
curr_Stock_Price:  105.2932168295646
curr_Factors:  [105.29321683  -0.72309507  -1.19077235]
mat_Sqrt:  [[15.5316763   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00083492  0.02252408 -0.52432195]
Stock Position:  0.0008349163909971999
Bond Position:  [11.56116603]


portfolio before change:  [11.65485941]
curr_Stock_Price:  105.29359427270245
curr_Factors:  [105.29359427  -0.64173629  -1.11940323]
mat_Sqrt:  [[18.09459106  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01380963  0.05062733 -0.4688947 ]
Stock Position:  0.013809629086158692
Bond Position:  [10.20079392]


portfolio before change:  [11.67655864]
curr_Stock_Price:  106.49547719999995
curr_Factors:  [106.4954772   -0.64035514  -1.16350513]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.67655864]
Stock Price:  110.13748454034456
PL:  [1.53907409]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 6.97521455e-02 -1.22153752e-01  2.48254059e-01]
 [-2.60955962e-01  4.65970666e-02 -8.62928741e-02]
 [-2.92819869e-02 -3.80586445e-02 -5.07337071e-02]
 [-3.07082662e-01 -5.97772345e-02 -2.21335916e-01]
 [ 2.20444328e-02  1.52467397e-01  1.44798064e-01]
 [ 1.95114098e-01  1.72339977e-01 -1.29540255e-01]
 [ 2.62415141e-01 -2.79909391e-01  3.11950917e-01]
 [ 7.48864394e-02  1.39203142e-01  4.92590895e-02]
 [-1.33745910e-01 -1.79244475e-01  9.39445069e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.24266302]
curr_Stock_Price:  97.99680674144378
curr_Factors:  [97.99680674 -0.81772898 -1.03270412]
mat_Sqrt:  [[15.40206816  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00761409 -0.03862841  0.70819973]
Stock Position:  0.007614094124646256
Bond Position:  [-12.98881993]


portfolio before change:  [-12.26831483]
curr_Stock_Price:  95.48097530801056
curr_Factors:  [95.48097531 -0.50352678 -1.02110532]
mat_Sqrt:  [[20.78631668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01334374  0.01473529 -0.24616955]
Stock Position:  -0.013343744078879703
Bond Position:  [-10.99424113]


portfolio before change:  [-12.23882892]
curr_Stock_Price:  92.85919171880413
curr_Factors:  [92.85919172 -1.00805935 -1.10072425]
mat_Sqrt:  [[11.27176219  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00360375 -0.0120352  -0.14472914]
Stock Position:  -0.003603751640198206
Bond Position:  [-11.90418745]


portfolio before change:  [-12.24519084]
curr_Stock_Price:  92.97250091346802
curr_Factors:  [92.97250091 -0.80482985 -1.1206144 ]
mat_Sqrt:  [[13.5564101   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02609881 -0.01890322 -0.63140976]
Stock Position:  -0.026098805371854092
Bond Position:  [-9.81871963]


portfolio before change:  [-12.22581815]
curr_Stock_Price:  92.04206469152221
curr_Factors:  [92.04206469 -1.44892494 -1.06679791]
mat_Sqrt:  [[ 7.43741133  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00746737 0.04821442 0.41306857]
Stock Position:  0.00746737038721228
Bond Position:  [-12.91313034]


portfolio before change:  [-12.24067958]
curr_Stock_Price:  90.91673612351893
curr_Factors:  [90.91673612 -1.10279413 -1.13952509]
mat_Sqrt:  [[ 9.65643834  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0179281   0.05449869 -0.36954229]
Stock Position:  0.01792810109164945
Bond Position:  [-13.87064401]


portfolio before change:  [-12.23207946]
curr_Stock_Price:  91.78337409185922
curr_Factors:  [91.78337409 -0.71872967 -1.12989915]
mat_Sqrt:  [[14.45155981  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02206437 -0.08851512  0.88990913]
Stock Position:  0.022064374379800387
Bond Position:  [-14.25722219]


portfolio before change:  [-12.28004232]
curr_Stock_Price:  89.93276793230562
curr_Factors:  [89.93276793 -0.17516124 -1.1423102 ]
mat_Sqrt:  [[24.08504074  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00367596 0.0440199  0.14052247]
Stock Position:  0.003675958845877125
Bond Position:  [-12.61063147]


portfolio before change:  [-12.27642852]
curr_Stock_Price:  92.63157039563637
curr_Factors:  [92.6315704  -0.57191471 -1.17370828]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.27642852]
Stock Price:  95.13096011197993
PL:  [-12.27642852]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-3.46498743e-02  3.72464110e-02 -9.35488222e-02]
 [-1.72139509e-01  8.19971847e-02 -3.53573398e-03]
 [-9.29370706e-02  2.13491711e-02 -5.73901234e-02]
 [ 7.32617255e-02 -1.76787191e-02 -2.07628806e-01]
 [ 6.87240770e-02 -1.16620141e-01 -1.69757123e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 3.52212813e-02  7.68523538e-02  1.01557504e-02]
 [ 8.82074150e-02  2.03973456e-02  8.69076747e-03]
 [-9.64540540e-02 -7.78092517e-02  8.92585762e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.9530854]
curr_Stock_Price:  101.08929785416252
curr_Factors:  [101.08929785  -1.08037308  -0.94993808]
mat_Sqrt:  [[13.27248506  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00397693  0.01177835 -0.26686875]
Stock Position:  -0.003976930413285675
Bond Position:  [10.3551105]


portfolio before change:  [9.96127384]
curr_Stock_Price:  100.33253632417117
curr_Factors:  [100.33253632  -0.59668519  -0.93129483]
mat_Sqrt:  [[21.76950237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00784327  0.02592979 -0.01008646]
Stock Position:  -0.007843269752397141
Bond Position:  [10.74820898]


portfolio before change:  [9.96832698]
curr_Stock_Price:  100.11863310464926
curr_Factors:  [100.1186331   -0.64522982  -0.92091873]
mat_Sqrt:  [[20.90957656  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00497861  0.0067512  -0.16371805]
Stock Position:  -0.0049786061866878345
Bond Position:  [10.46677823]


portfolio before change:  [9.96621548]
curr_Stock_Price:  101.5941876233023
curr_Factors:  [101.59418762  -0.71030955  -0.95601412]
mat_Sqrt:  [[19.19524621  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00158493 -0.0055905  -0.59230719]
Stock Position:  0.0015849346233760865
Bond Position:  [9.80519533]


portfolio before change:  [9.97089777]
curr_Stock_Price:  101.45441256992332
curr_Factors:  [101.45441257  -0.94220755  -0.92225358]
mat_Sqrt:  [[15.72337445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00197549 -0.03687853 -0.48426982]
Stock Position:  0.001975493897884978
Bond Position:  [9.77047519]


portfolio before change:  [9.97388077]
curr_Stock_Price:  100.49087728249646
curr_Factors:  [100.49087728  -0.97172077  -0.94180082]
mat_Sqrt:  [[14.82841625  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00159511 -0.00193948 -0.30510753]
Stock Position:  0.0015951134123794084
Bond Position:  [9.81358642]


portfolio before change:  [9.97731818]
curr_Stock_Price:  99.56893432045668
curr_Factors:  [99.56893432 -1.26118499 -0.9330645 ]
mat_Sqrt:  [[11.09617796  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00353983 0.02430285 0.02897153]
Stock Position:  0.0035398345770071577
Bond Position:  [9.62486063]


portfolio before change:  [9.97990489]
curr_Stock_Price:  98.93982846590826
curr_Factors:  [98.93982847 -0.88142917 -0.92720308]
mat_Sqrt:  [[16.21407389  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00558207 0.00645021 0.02479234]
Stock Position:  0.005582068289778922
Bond Position:  [9.42761601]


portfolio before change:  [9.99146089]
curr_Stock_Price:  100.16536268377646
curr_Factors:  [100.16536268  -0.56896656  -0.97484732]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.99146089]
Stock Price:  106.47107619982766
PL:  [3.52038469]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 6.43556057e-02 -1.15324485e-01  2.33998578e-01]
 [-1.37348150e-01  7.69680869e-02 -2.94417305e-03]
 [ 1.24732449e-01  7.69182927e-02 -2.17137308e-01]
 [-5.68448771e-03  2.31738504e-04 -4.75078008e-02]
 [-8.78986515e-02 -3.84389154e-02 -2.83636808e-02]
 [ 7.96538341e-02  1.33172416e-01 -2.58701840e-03]
 [ 2.70781860e-01 -2.80287163e-01  3.23782373e-01]
 [ 1.53224528e-01  8.41708385e-02  3.70510922e-03]
 [-1.30883119e-01 -1.69582092e-01  1.00097040e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.59498825]
curr_Stock_Price:  98.08704602679155
curr_Factors:  [98.08704603 -0.52015141 -0.96629802]
mat_Sqrt:  [[22.18476707  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00491971 -0.0364688   0.66753281]
Stock Position:  0.00491971358606612
Bond Position:  [-12.07754842]


portfolio before change:  [-11.5949221]
curr_Stock_Price:  99.32826279527919
curr_Factors:  [ 9.93282628e+01 -6.21120069e-02 -9.90830976e-01]
mat_Sqrt:  [[34.65656481  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00392312  0.02433945 -0.00839891]
Stock Position:  -0.003923118768017995
Bond Position:  [-11.20524553]


portfolio before change:  [-11.57688148]
curr_Stock_Price:  93.30126190609928
curr_Factors:  [93.30126191 -0.18664142 -0.94063826]
mat_Sqrt:  [[30.22151084  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00272639  0.0243237  -0.6194323 ]
Stock Position:  0.0027263859947673657
Bond Position:  [-11.83125674]


portfolio before change:  [-11.56634836]
curr_Stock_Price:  99.33497571183028
curr_Factors:  [99.33497571 -0.16139521 -0.94489802]
mat_Sqrt:  [[32.8583044   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.67948476e-04  7.32821494e-05 -1.35526532e-01]
Stock Position:  -0.00046794847614915546
Bond Position:  [-11.51986471]


portfolio before change:  [-11.57112304]
curr_Stock_Price:  97.22643337404865
curr_Factors:  [ 9.72264334e+01 -9.98453286e-03 -9.44434462e-01]
mat_Sqrt:  [[37.43565634  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252916 -0.01215545 -0.08091369]
Stock Position:  -0.002529162337193769
Bond Position:  [-11.32522161]


portfolio before change:  [-11.57685661]
curr_Stock_Price:  97.2539283548743
curr_Factors:  [97.25392835  0.12634764 -0.88285124]
mat_Sqrt:  [[45.64169994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00180897  0.04211282 -0.00738004]
Stock Position:  0.0018089654466287406
Bond Position:  [-11.75278561]


portfolio before change:  [-11.59249656]
curr_Stock_Price:  91.85742322795915
curr_Factors:  [91.85742323 -0.26093721 -0.87465549]
mat_Sqrt:  [[29.50751355  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01117128 -0.08863458  0.92366099]
Stock Position:  0.0111712793503752
Bond Position:  [-12.6186615]


portfolio before change:  [-11.57978075]
curr_Stock_Price:  93.56060477197938
curr_Factors:  [93.56060477 -0.90721476 -0.88132749]
mat_Sqrt:  [[15.64368244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00998193 0.02661716 0.01056965]
Stock Position:  0.009981928030591041
Bond Position:  [-12.51369598]


portfolio before change:  [-11.58702486]
curr_Stock_Price:  93.46185703554063
curr_Factors:  [93.46185704 -1.15977511 -0.91092186]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.58702486]
Stock Price:  92.67425062829622
PL:  [-11.58702486]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 2.68454567e-02 -6.66322418e-02  1.31948514e-01]
 [-3.71854047e-03  7.69287108e-02  3.46949566e-02]
 [ 9.90971510e-03  3.68641614e-04 -1.03998362e-01]
 [-1.07297134e-01 -2.99668689e-02 -1.64910712e-01]
 [-1.26644940e-01  2.16021011e-01  3.20022083e-01]
 [ 1.16569030e-01  1.45695150e-01 -4.31767712e-02]
 [ 1.75805958e-01 -1.82975318e-01  1.88218795e-01]
 [ 7.26216362e-02  1.40556378e-01  5.06302255e-02]
 [-1.30172170e-01 -1.67048252e-01  1.02091202e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.61639543]
curr_Stock_Price:  98.50204765897521
curr_Factors:  [98.50204766 -0.7720651  -0.97343886]
mat_Sqrt:  [[17.19422165  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0030277  -0.02107096  0.37641238]
Stock Position:  0.003027697224705615
Bond Position:  [-8.91462981]


portfolio before change:  [-8.61876545]
curr_Stock_Price:  99.19181648946967
curr_Factors:  [99.19181649 -0.78461246 -1.00373529]
mat_Sqrt:  [[16.58846823  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0003225  0.02432699 0.09897505]
Stock Position:  0.00032250287295291786
Bond Position:  [-8.65075509]


portfolio before change:  [-8.62347518]
curr_Stock_Price:  98.00338165682527
curr_Factors:  [98.00338166 -0.18749865 -1.04539537]
mat_Sqrt:  [[28.56287966  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.95945492e-04  1.16574714e-04 -2.96678380e-01]
Stock Position:  -0.00039594549205586093
Bond Position:  [-8.58467118]


portfolio before change:  [-8.62636633]
curr_Stock_Price:  94.46183929610805
curr_Factors:  [94.4618393  -0.26945855 -1.04711708]
mat_Sqrt:  [[25.32065076  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00559753 -0.00947636 -0.47044436]
Stock Position:  -0.0055975312279104815
Bond Position:  [-8.09761324]


portfolio before change:  [-8.61752923]
curr_Stock_Price:  92.15958821914872
curr_Factors:  [92.15958822 -0.44382457 -1.01735137]
mat_Sqrt:  [[21.37764582  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260754  0.06831184  0.91293393]
Stock Position:  -0.002607540054400557
Bond Position:  [-8.37721941]


portfolio before change:  [-8.62796855]
curr_Stock_Price:  94.5563538999104
curr_Factors:  [94.5563539  -0.24001842 -1.02718189]
mat_Sqrt:  [[26.62886265  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00418784  0.04607285 -0.12317131]
Stock Position:  0.004187840917238141
Bond Position:  [-9.02395552]


portfolio before change:  [-8.63021653]
curr_Stock_Price:  95.09723566208493
curr_Factors:  [95.09723566 -0.24076784 -1.04212968]
mat_Sqrt:  [[26.36407736  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00794648 -0.05786188  0.53693583]
Stock Position:  0.007946477831754473
Bond Position:  [-9.3859046]


portfolio before change:  [-8.6766385]
curr_Stock_Price:  89.84612387035726
curr_Factors:  [89.84612387 -0.64892884 -0.99901058]
mat_Sqrt:  [[17.29053169  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00500769 0.04444783 0.14443394]
Stock Position:  0.00500769087879959
Bond Position:  [-9.12656011]


portfolio before change:  [-8.66152656]
curr_Stock_Price:  93.77535246858689
curr_Factors:  [93.77535247 -1.18416296 -0.98506013]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.66152656]
Stock Price:  92.99454405282052
PL:  [-8.66152656]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-2.34498959e-01  8.46575021e-02 -2.14202020e-02]
 [-1.26510198e-01  8.30218768e-02 -8.23038061e-02]
 [ 2.53833126e-01  9.76437139e-03 -1.46589070e-01]
 [ 6.58182415e-02 -1.28579151e-01 -1.61753083e-01]
 [-1.40493398e-01 -3.50037956e-02  9.24180525e-02]
 [ 1.06896322e-01  3.90876100e-02 -2.59575920e-01]
 [ 2.74209524e-01  1.47264579e-01 -1.29778615e-01]
 [-8.29807865e-02 -8.45879293e-02 -1.07061858e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.37055678]
curr_Stock_Price:  100.31149483467044
curr_Factors:  [100.31149483  -0.59448846  -1.00702724]
mat_Sqrt:  [[20.22186803  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305276  0.01250945 -0.27262553]
Stock Position:  -0.0030527596647531023
Bond Position:  [4.67678366]


portfolio before change:  [4.37312313]
curr_Stock_Price:  100.237013775716
curr_Factors:  [100.23701378  -0.11034633  -1.00257316]
mat_Sqrt:  [[32.93770424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00718585  0.02677105 -0.06110587]
Stock Position:  -0.0071858527250816245
Bond Position:  [5.09341155]


portfolio before change:  [4.35592299]
curr_Stock_Price:  102.98511910404531
curr_Factors:  [102.9851191   -0.11615154  -1.02875429]
mat_Sqrt:  [[32.77541441  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430709  0.02625382 -0.23478985]
Stock Position:  -0.004307093574389803
Bond Position:  [4.79948954]


portfolio before change:  [4.34617287]
curr_Stock_Price:  105.80615402101886
curr_Factors:  [105.80615402  -0.78944311  -1.02056702]
mat_Sqrt:  [[17.31543933  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01294584  0.00308777 -0.41817782]
Stock Position:  0.012945837986843123
Bond Position:  [2.97642355]


portfolio before change:  [4.33599713]
curr_Stock_Price:  104.90514392208829
curr_Factors:  [104.90514392  -0.53842913  -0.98613604]
mat_Sqrt:  [[22.83949741  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00129077 -0.0406603  -0.46143652]
Stock Position:  0.0012907741287148246
Bond Position:  [4.20058828]


portfolio before change:  [4.34086972]
curr_Stock_Price:  107.05251425627544
curr_Factors:  [107.05251426  -2.1825707   -0.96485952]
mat_Sqrt:  [[ 4.59923173  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02664194 -0.01106917  0.26364298]
Stock Position:  -0.026641935695340496
Bond Position:  [7.19295592]


portfolio before change:  [4.32616978]
curr_Stock_Price:  107.73930032008926
curr_Factors:  [107.73930032  -1.89306125  -0.95846074]
mat_Sqrt:  [[ 6.22262871  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00882583  0.01236059 -0.74049785]
Stock Position:  0.008825827390592513
Bond Position:  [3.37528132]


portfolio before change:  [4.32971207]
curr_Stock_Price:  107.94939055105351
curr_Factors:  [107.94939055  -1.62588826  -0.96395465]
mat_Sqrt:  [[ 8.09963991  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03105335  0.04656915 -0.37022227]
Stock Position:  0.031053347159699526
Bond Position:  [0.97752217]


portfolio before change:  [4.34177286]
curr_Stock_Price:  108.32203665105158
curr_Factors:  [108.32203665  -1.55017455  -0.9472443 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.34177286]
Stock Price:  108.85560478998669
PL:  [-4.51383193]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 7.45423979e-02  7.88014977e-03 -6.79164312e-02]
 [-3.23159646e-01 -4.17070220e-02 -1.58856274e-01]
 [-1.12376312e-01  5.70584025e-02 -7.18154425e-02]
 [ 1.05494466e-01 -4.35698248e-02 -3.44450569e-01]
 [ 6.86587852e-02 -1.17091660e-01 -1.69544319e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [-1.78782318e-02  1.30134825e-01 -5.71390100e-02]
 [ 1.05335060e-01  2.79422221e-02  9.55114798e-03]
 [-9.25962621e-02 -7.90600055e-02  4.79947480e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.18599155]
curr_Stock_Price:  101.95771673031382
curr_Factors:  [101.95771673  -1.25930185  -1.04805119]
mat_Sqrt:  [[10.14727445  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00599988  0.00249192 -0.19374667]
Stock Position:  0.005999884929725271
Bond Position:  [15.57425699]


portfolio before change:  [16.19350346]
curr_Stock_Price:  101.91152019226371
curr_Factors:  [101.91152019  -0.52888093  -1.16862454]
mat_Sqrt:  [[18.66405568  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01910961 -0.01318892 -0.45317273]
Stock Position:  -0.019109614978058166
Bond Position:  [18.14099337]


portfolio before change:  [16.20756565]
curr_Stock_Price:  101.65042493445557
curr_Factors:  [101.65042493  -0.75010399  -1.18065443]
mat_Sqrt:  [[14.7431902   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00851663  0.01804345 -0.20486947]
Stock Position:  -0.008516632699056526
Bond Position:  [17.07328498]


portfolio before change:  [16.21144084]
curr_Stock_Price:  102.19801031783155
curr_Factors:  [102.19801032  -1.20952221  -1.24329897]
mat_Sqrt:  [[ 8.79418786  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00387288 -0.01377799 -0.9826216 ]
Stock Position:  0.00387287835192132
Bond Position:  [15.81564038]


portfolio before change:  [16.21647005]
curr_Stock_Price:  101.45422588024107
curr_Factors:  [101.45422588  -1.24073105  -1.30830569]
mat_Sqrt:  [[ 7.92934932  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00391298 -0.03702763 -0.48366275]
Stock Position:  0.0039129821605415555
Bond Position:  [15.81948148]


portfolio before change:  [16.22616909]
curr_Stock_Price:  101.91099169791873
curr_Factors:  [101.9109917   -1.53799603  -1.42165376]
mat_Sqrt:  [[ 5.28276701  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00447739 -0.00193948 -0.30510753]
Stock Position:  0.004477389516620196
Bond Position:  [15.76987388]


portfolio before change:  [16.23599159]
curr_Stock_Price:  102.34329551127117
curr_Factors:  [102.34329551  -1.8039926   -1.43189204]
mat_Sqrt:  [[ 4.0246911   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00650525  0.04115225 -0.16300169]
Stock Position:  -0.006505248721828966
Bond Position:  [16.90176018]


portfolio before change:  [16.25133368]
curr_Stock_Price:  101.28428943966479
curr_Factors:  [101.28428944  -1.4160276   -1.38226425]
mat_Sqrt:  [[ 6.16963368  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01750609 0.00883611 0.02724677]
Stock Position:  0.01750608719540282
Bond Position:  [14.47824208]


portfolio before change:  [16.25786943]
curr_Stock_Price:  101.24400719770404
curr_Factors:  [101.2440072   -1.29945377  -1.32852274]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.25786943]
Stock Price:  100.53052274197645
PL:  [15.72734669]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.65552918e-02  3.69498767e-02 -8.78480139e-02]
 [-2.46229187e-01  4.99642025e-02 -2.29160586e-02]
 [-1.08400786e-01  4.97554950e-02 -6.88653154e-02]
 [ 5.40187651e-02 -5.92381184e-02 -4.18241064e-01]
 [ 6.75026697e-02 -1.25440804e-01 -1.65776213e-01]
 [ 1.58586886e-02 -1.30179407e-02 -5.35812201e-02]
 [ 4.22178014e-02  1.01254675e-01 -1.27589441e-01]
 [ 1.92266254e-01  8.28147928e-02 -4.06211176e-02]
 [-8.28801949e-02 -8.48942923e-02 -1.14066897e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.0722743]
curr_Stock_Price:  99.55315560509608
curr_Factors:  [99.55315561 -0.89323159 -0.9944882 ]
mat_Sqrt:  [[15.07400804  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00421475  0.01168458 -0.25060593]
Stock Position:  -0.0042147483675764935
Bond Position:  [-0.6526828]


portfolio before change:  [-1.07819741]
curr_Stock_Price:  100.88103576833514
curr_Factors:  [100.88103577  -0.71604909  -1.05667114]
mat_Sqrt:  [[17.1366891   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01456622  0.01580007 -0.06537314]
Stock Position:  -0.014566223151772069
Bond Position:  [0.39125827]


portfolio before change:  [-1.08351159]
curr_Stock_Price:  101.25929857501082
curr_Factors:  [101.25929858  -0.80307977  -1.08153813]
mat_Sqrt:  [[15.37997962  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00787863  0.01573407 -0.19645358]
Stock Position:  -0.00787863058467612
Bond Position:  [-0.28572698]


portfolio before change:  [-1.08859453]
curr_Stock_Price:  101.88631626521018
curr_Factors:  [101.88631627  -1.38746956  -1.039006  ]
mat_Sqrt:  [[ 9.00141765  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365319 -0.01873274 -1.19312534]
Stock Position:  -0.00365318636099644
Bond Position:  [-0.71638483]


portfolio before change:  [-1.09477806]
curr_Stock_Price:  103.48088193421106
curr_Factors:  [103.48088193  -1.64111084  -1.08230068]
mat_Sqrt:  [[ 6.79356174  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00447849 -0.03966787 -0.47291339]
Stock Position:  0.004478486468418375
Bond Position:  [-1.55821579]


portfolio before change:  [-1.09054567]
curr_Stock_Price:  104.59994075860126
curr_Factors:  [104.59994076  -0.94529994  -1.110676  ]
mat_Sqrt:  [[13.38543327  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00034256 -0.00411663 -0.15285231]
Stock Position:  0.00034256239034564175
Bond Position:  [-1.12637768]


portfolio before change:  [-1.09090729]
curr_Stock_Price:  105.18877555840534
curr_Factors:  [105.18877556  -1.67682548  -1.11919989]
mat_Sqrt:  [[ 6.42201049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00292558  0.03201954 -0.36397716]
Stock Position:  0.0029255792049673475
Bond Position:  [-1.39864538]


portfolio before change:  [-1.08892641]
curr_Stock_Price:  106.10496277368303
curr_Factors:  [106.10496277  -1.86900017  -1.21648803]
mat_Sqrt:  [[ 4.84981529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03837523  0.02618834 -0.11588074]
Stock Position:  0.0383752289926605
Bond Position:  [-5.16072865]


portfolio before change:  [-1.06052543]
curr_Stock_Price:  106.91230613247563
curr_Factors:  [106.91230613  -1.89427136  -1.21500145]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.06052543]
Stock Price:  106.40213420611649
PL:  [-7.46265964]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 1.45346961e-01 -1.11620888e-02 -5.12953809e-02]
 [-2.18587041e-01  4.91060650e-02 -1.66876314e-02]
 [-9.69697856e-02  2.87571329e-02 -6.03826889e-02]
 [ 1.75907967e-02 -5.52125968e-02 -3.73052422e-01]
 [ 6.87217568e-02 -1.16636897e-01 -1.69749561e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 1.13084768e-01  1.18817097e-03  3.73163587e-02]
 [ 2.61170532e-01  1.50978528e-01 -1.61546967e-01]
 [-8.56693356e-02 -8.13058186e-02 -2.60972466e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.74248863]
curr_Stock_Price:  102.8712209091749
curr_Factors:  [102.87122091  -1.2992073   -0.98516279]
mat_Sqrt:  [[10.47621904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01284701 -0.00352976 -0.14633144]
Stock Position:  0.01284701386857606
Bond Position:  [21.42090063]


portfolio before change:  [22.72773253]
curr_Stock_Price:  100.88871915067611
curr_Factors:  [100.88871915  -1.16492675  -1.02502315]
mat_Sqrt:  [[11.29170314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01954758  0.0155287  -0.04760517]
Stock Position:  -0.019547580519401968
Bond Position:  [24.69986289]


portfolio before change:  [22.75159491]
curr_Stock_Price:  100.29993191938215
curr_Factors:  [100.29993192  -0.94358944  -1.01515031]
mat_Sqrt:  [[14.14590621  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0076738  0.0090938 -0.172255 ]
Stock Position:  -0.00767379924634793
Bond Position:  [23.52127646]


portfolio before change:  [22.75808629]
curr_Stock_Price:  100.9869719339033
curr_Factors:  [100.98697193  -1.14943299  -1.00673906]
mat_Sqrt:  [[11.69100174  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00513077 -0.01745976 -1.06421472]
Stock Position:  -0.005130765911267388
Bond Position:  [23.2762268]


portfolio before change:  [22.77389393]
curr_Stock_Price:  100.17488734259149
curr_Factors:  [100.17488734  -1.00031424  -0.92654874]
mat_Sqrt:  [[14.585889    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00212947 -0.03688383 -0.48424825]
Stock Position:  0.0021294705487588054
Bond Position:  [22.56057445]


portfolio before change:  [22.78611762]
curr_Stock_Price:  100.61658931990759
curr_Factors:  [100.61658932  -0.5802017   -0.94931314]
mat_Sqrt:  [[21.79765306  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00108512 -0.00193948 -0.30510753]
Stock Position:  0.0010851170802492986
Bond Position:  [22.67693684]


portfolio before change:  [22.79662773]
curr_Stock_Price:  99.85059264316638
curr_Factors:  [ 9.98505926e+01 -6.76625348e-02 -9.11337758e-01]
mat_Sqrt:  [[37.51251843  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00321846 0.00037573 0.10645318]
Stock Position:  0.0032184620229820165
Bond Position:  [22.47526239]


portfolio before change:  [22.8200281]
curr_Stock_Price:  103.62877255911569
curr_Factors:  [103.62877256  -0.32254809  -0.94433335]
mat_Sqrt:  [[29.19313508  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00795026  0.0477436  -0.46084853]
Stock Position:  0.00795026446872057
Bond Position:  [21.99615195]


portfolio before change:  [22.8295416]
curr_Stock_Price:  103.44169362884557
curr_Factors:  [103.44169363  -0.89334412  -0.92502747]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.8295416]
Stock Price:  102.86203268063441
PL:  [19.96750892]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-7.61343891e-02  9.09943136e-02  2.14421529e-02]
 [-9.85335686e-02  3.16297496e-02 -6.15431287e-02]
 [ 2.72338626e-02 -4.71626309e-02 -3.33340089e-01]
 [ 6.87223265e-02 -1.16632782e-01 -1.69751418e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 1.80087806e-02  1.15547347e-01 -9.44056544e-02]
 [ 1.19307381e-01  3.55360730e-02  5.51936687e-03]
 [-8.38920028e-02 -5.11245746e-02  2.89650407e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.2121462]
curr_Stock_Price:  100.4287518769641
curr_Factors:  [100.42875188  -0.93501264  -1.04589531]
mat_Sqrt:  [[13.85353715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00445608  0.01250945 -0.27262553]
Stock Position:  -0.004456082401242336
Bond Position:  [5.659665]


portfolio before change:  [5.21792624]
curr_Stock_Price:  99.76684839255128
curr_Factors:  [99.76684839 -0.66580774 -1.06066252]
mat_Sqrt:  [[17.7496481   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00391039  0.02877493  0.06116849]
Stock Position:  -0.003910391040501958
Bond Position:  [5.60805363]


portfolio before change:  [5.21797083]
curr_Stock_Price:  100.47269521751869
curr_Factors:  [100.47269522  -0.83955511  -1.06099916]
mat_Sqrt:  [[15.01923531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00734254  0.01000221 -0.17556542]
Stock Position:  -0.007342539632448701
Bond Position:  [5.95569558]


portfolio before change:  [5.21720602]
curr_Stock_Price:  100.98251921548831
curr_Factors:  [100.98251922  -1.02996312  -1.03696759]
mat_Sqrt:  [[12.78172888  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328802 -0.01491413 -0.95092649]
Stock Position:  -0.0032880240535415046
Bond Position:  [5.54923897]


portfolio before change:  [5.22134324]
curr_Stock_Price:  100.5683181581029
curr_Factors:  [100.56831816  -0.9389321   -1.01557327]
mat_Sqrt:  [[14.24394501  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00218061 -0.03688252 -0.48425354]
Stock Position:  0.0021806120400801165
Bond Position:  [5.00204275]


portfolio before change:  [5.22408946]
curr_Stock_Price:  100.68047818552715
curr_Factors:  [100.68047819  -1.17626511  -1.05437739]
mat_Sqrt:  [[10.8190602   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00218623 -0.00193948 -0.30510753]
Stock Position:  0.0021862347751918404
Bond Position:  [5.0039783]


portfolio before change:  [5.22945957]
curr_Stock_Price:  101.99209294712456
curr_Factors:  [101.99209295  -1.16097242  -1.02502574]
mat_Sqrt:  [[11.46039453  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.50232765e-04  3.65392794e-02 -2.69313054e-01]
Stock Position:  0.00015023276502947118
Bond Position:  [5.21413702]


portfolio before change:  [5.2320527]
curr_Stock_Price:  101.89496831722631
curr_Factors:  [101.89496832  -1.31879089  -1.01808726]
mat_Sqrt:  [[ 9.84599142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01232497 0.01123749 0.01574522]
Stock Position:  0.01232497058103451
Bond Position:  [3.97620021]


portfolio before change:  [5.21392711]
curr_Stock_Price:  100.26298124651335
curr_Factors:  [100.26298125  -1.35618522  -1.02347639]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.21392711]
Stock Price:  100.33359942189034
PL:  [4.88032768]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 6.00915002e-02 -1.10572332e-01  2.24294369e-01]
 [-1.52550424e-01  7.20207450e-02 -9.74517917e-03]
 [-9.81689121e-02  3.09598879e-02 -6.12725272e-02]
 [-4.07520104e-02 -9.48129165e-02 -5.22680379e-01]
 [ 6.87218089e-02 -1.16636520e-01 -1.69749731e-01]
 [ 4.72978419e-02  6.44593708e-04 -1.01875306e-01]
 [ 2.57513467e-02  1.22179926e-01 -4.83961085e-04]
 [ 1.24341422e-01  4.43542251e-02 -1.59419591e-02]
 [-9.04316963e-02 -7.97617901e-02  2.48420560e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.59997604]
curr_Stock_Price:  98.08635108775057
curr_Factors:  [98.08635109 -1.04001479 -0.98449195]
mat_Sqrt:  [[12.95318226  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00795329 -0.03496604  0.6398494 ]
Stock Position:  0.007953291251119671
Bond Position:  [-12.38008536]


portfolio before change:  [-11.61026632]
curr_Stock_Price:  97.57100590721704
curr_Factors:  [97.57100591 -0.87259501 -0.94973305]
mat_Sqrt:  [[15.77225391  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0096803   0.02277496 -0.02780028]
Stock Position:  -0.009680295755670516
Bond Position:  [-10.66575012]


portfolio before change:  [-11.64131134]
curr_Stock_Price:  100.227000124398
curr_Factors:  [100.22700012  -1.42855244  -0.97759996]
mat_Sqrt:  [[ 9.03662002  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01215905  0.00979038 -0.17479347]
Stock Position:  -0.012159052087040777
Bond Position:  [-10.42264602]


portfolio before change:  [-11.64405289]
curr_Stock_Price:  100.02377113460157
curr_Factors:  [100.02377113  -1.52633575  -0.99180307]
mat_Sqrt:  [[ 8.06286577  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01859038 -0.02998248 -1.49106164]
Stock Position:  -0.018590382044249128
Bond Position:  [-9.78457277]


portfolio before change:  [-11.6529628]
curr_Stock_Price:  100.23981843939367
curr_Factors:  [100.23981844  -1.10428871  -0.95976162]
mat_Sqrt:  [[12.72432066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00244101 -0.03688371 -0.48424873]
Stock Position:  0.0024410142635333514
Bond Position:  [-11.89764963]


portfolio before change:  [-11.65948428]
curr_Stock_Price:  100.00582974745143
curr_Factors:  [100.00582975  -1.21564752  -0.96218106]
mat_Sqrt:  [[11.32938621  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.34075129e-03  2.03838428e-04 -2.90621892e-01]
Stock Position:  0.002340751290217181
Bond Position:  [-11.89357306]


portfolio before change:  [-11.66505649]
curr_Stock_Price:  100.1664920456838
curr_Factors:  [100.16649205  -1.23653849  -0.94709993]
mat_Sqrt:  [[11.28185073  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00255341  0.03863669 -0.00138061]
Stock Position:  0.0025534135621244633
Bond Position:  [-11.92082297]


portfolio before change:  [-11.66851685]
curr_Stock_Price:  101.14617609016473
curr_Factors:  [101.14617609  -0.93146501  -1.00537399]
mat_Sqrt:  [[14.58112321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00838293  0.01402604 -0.04547797]
Stock Position:  0.008382927892560836
Bond Position:  [-12.51641795]


portfolio before change:  [-11.66536133]
curr_Stock_Price:  102.26932728998958
curr_Factors:  [102.26932729  -0.72526197  -1.07818031]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.66536133]
Stock Price:  101.53103902699547
PL:  [-13.19640036]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 1.96655067e-01 -2.29838734e-01  4.95682304e-01]
 [-2.69722620e-01  3.43340158e-02 -1.08662402e-01]
 [-8.05666650e-02 -1.37484760e-03 -4.82103901e-02]
 [-1.16794185e-01 -6.48747510e-02 -3.25532743e-01]
 [ 9.72925216e-03  2.52343910e-02 -2.13601906e-02]
 [ 1.15926110e-01  1.45477052e-01 -4.24698554e-02]
 [ 1.43511051e-01 -1.50102856e-01  1.42898187e-01]
 [ 1.19856051e-01  4.48048781e-02  1.87788020e-02]
 [-1.22819869e-01 -1.41908063e-01  1.19020757e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.33402268]
curr_Stock_Price:  96.86945309805331
curr_Factors:  [96.8694531  -0.88456694 -0.96410181]
mat_Sqrt:  [[15.25176872  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01913885 -0.07268139  1.41404364]
Stock Position:  0.01913885454507036
Bond Position:  [-22.18799306]


portfolio before change:  [-20.39854564]
curr_Stock_Price:  94.07794937082448
curr_Factors:  [94.07794937 -0.74763151 -0.98439315]
mat_Sqrt:  [[16.64481942  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01748392  0.01085737 -0.30998359]
Stock Position:  -0.017483922913145787
Bond Position:  [-18.75369402]


portfolio before change:  [-20.42993122]
curr_Stock_Price:  95.33661399435937
curr_Factors:  [95.33661399 -1.12406399 -0.9403568 ]
mat_Sqrt:  [[12.09743135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00747622 -0.00043476 -0.13753082]
Stock Position:  -0.007476220815125091
Bond Position:  [-19.71717365]


portfolio before change:  [-20.43821727]
curr_Stock_Price:  95.12594541674781
curr_Factors:  [95.12594542 -0.79285713 -0.92697555]
mat_Sqrt:  [[17.03668683  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01085413 -0.0205152  -0.9286543 ]
Stock Position:  -0.01085412550288903
Bond Position:  [-19.40570832]


portfolio before change:  [-20.44564419]
curr_Stock_Price:  94.91603767598974
curr_Factors:  [94.91603768 -1.05451809 -0.93690664]
mat_Sqrt:  [[12.95611605  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0004647   0.00797982 -0.06093468]
Stock Position:  0.0004646971869254102
Bond Position:  [-20.4897514]


portfolio before change:  [-20.45599769]
curr_Stock_Price:  94.68779251559877
curr_Factors:  [94.68779252 -0.38516139 -0.96323868]
mat_Sqrt:  [[24.58619265  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00451527  0.04600388 -0.12115468]
Stock Position:  0.004515265548263996
Bond Position:  [-20.88353822]


portfolio before change:  [-20.46035724]
curr_Stock_Price:  96.03540478141797
curr_Factors:  [96.03540478 -0.32168352 -1.0055744 ]
mat_Sqrt:  [[25.46892307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00662786 -0.04746669  0.40764875]
Stock Position:  0.00662785708338568
Bond Position:  [-21.09686618]


portfolio before change:  [-20.47235546]
curr_Stock_Price:  95.81706117869793
curr_Factors:  [95.81706118 -0.94479531 -1.00607145]
mat_Sqrt:  [[13.62047251  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00916606 0.01416855 0.05357069]
Stock Position:  0.009166063390623955
Bond Position:  [-21.35062072]


portfolio before change:  [-20.4840188]
curr_Stock_Price:  95.70956000441967
curr_Factors:  [95.70956    -1.23216246 -1.01005022]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.4840188]
Stock Price:  96.38894901221
PL:  [-20.4840188]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-7.67162376e-02  7.55022141e-02  1.33972626e-02]
 [-4.29090163e-02 -1.04780989e-02 -6.26435232e-02]
 [-3.84772344e-01 -8.21410478e-02 -3.13116902e-01]
 [-8.01384725e-03  7.52778930e-02  5.19008918e-02]
 [ 1.17035187e-01  1.45853284e-01 -4.36893298e-02]
 [ 2.51597177e-01 -2.66900370e-01  2.96483910e-01]
 [ 1.26873096e-01  1.08140750e-01  1.77858115e-02]
 [-1.31044383e-01 -1.70229310e-01  9.93930716e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.28445165]
curr_Stock_Price:  100.57815414119591
curr_Factors:  [100.57815414  -0.88980461  -0.99525737]
mat_Sqrt:  [[15.26974015  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0040428   0.01250945 -0.27262553]
Stock Position:  -0.004042799843122742
Bond Position:  [6.691069]


portfolio before change:  [6.2947816]
curr_Stock_Price:  98.85074223901218
curr_Factors:  [98.85074224 -0.48666782 -1.04502892]
mat_Sqrt:  [[21.36842409  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337096  0.0238759   0.03821866]
Stock Position:  -0.0033709586520808492
Bond Position:  [6.62800337]


portfolio before change:  [6.30586348]
curr_Stock_Price:  96.5466349032692
curr_Factors:  [96.5466349  -0.57762562 -1.03215988]
mat_Sqrt:  [[19.30261659  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00289943 -0.00331347 -0.17870454]
Stock Position:  -0.0028994315363916547
Bond Position:  [6.58579384]


portfolio before change:  [6.31823905]
curr_Stock_Price:  93.41434913706806
curr_Factors:  [93.41434914 -1.1433536  -0.9979306 ]
mat_Sqrt:  [[10.97654543  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04107011 -0.02597528 -0.89323537]
Stock Position:  -0.041070110767801205
Bond Position:  [10.15477672]


portfolio before change:  [6.29855064]
curr_Stock_Price:  94.01739271838164
curr_Factors:  [94.01739272 -1.07944052 -0.97290381]
mat_Sqrt:  [[12.07497905  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00037466 0.02380496 0.1480588 ]
Stock Position:  0.0003746627429317017
Bond Position:  [6.26332583]


portfolio before change:  [6.30195495]
curr_Stock_Price:  94.74302028479156
curr_Factors:  [94.74302028 -0.68042286 -0.93802225]
mat_Sqrt:  [[18.77869662  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00595798  0.04612286 -0.1246335 ]
Stock Position:  0.005957977663911639
Bond Position:  [5.73747816]


portfolio before change:  [6.28893366]
curr_Stock_Price:  92.07588201662796
curr_Factors:  [92.07588202 -0.66611755 -0.96313255]
mat_Sqrt:  [[18.05392195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01690632 -0.08440131  0.84578607]
Stock Position:  0.016906318996222535
Bond Position:  [4.73226943]


portfolio before change:  [6.29098364]
curr_Stock_Price:  92.05714650216187
curr_Factors:  [92.0571465  -0.42178181 -0.97043721]
mat_Sqrt:  [[22.87833796  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00582629 0.03419711 0.05073797]
Stock Position:  0.005826288238913433
Bond Position:  [5.75463217]


portfolio before change:  [6.30006534]
curr_Stock_Price:  93.12191888429298
curr_Factors:  [93.12191888 -0.68208719 -0.98585316]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.30006534]
Stock Price:  93.83473270374378
PL:  [6.30006534]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 1.37900056e-01 -9.15931196e-03 -5.30435080e-02]
 [-5.47796135e-01 -2.79247359e-01 -5.12650108e-01]
 [-1.37243105e-01  1.02737865e-01 -9.02683972e-02]
 [ 2.53378330e-01  9.79580159e-03 -1.45874183e-01]
 [ 6.54439302e-02 -1.28095089e-01 -1.61051075e-01]
 [ 1.70088345e-02 -1.76226955e-02 -8.27131360e-02]
 [ 5.14201720e-02  7.39620787e-02 -1.79699409e-01]
 [ 1.95269987e-01  1.04615174e-01 -1.07834624e-01]
 [-8.70804875e-02 -8.08483021e-02 -1.10032430e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.66544824]
curr_Stock_Price:  102.72115893483438
curr_Factors:  [102.72115893  -1.118346    -1.04198779]
mat_Sqrt:  [[11.84237649  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01071036 -0.00289643 -0.15131836]
Stock Position:  0.010710358948115783
Bond Position:  [20.56526776]


portfolio before change:  [21.69756404]
curr_Stock_Price:  104.7594282783218
curr_Factors:  [104.75942828  -1.07149862  -0.99939052]
mat_Sqrt:  [[13.20740184  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04994552 -0.08830577 -1.46244806]
Stock Position:  -0.04994551867855209
Bond Position:  [26.92982802]


portfolio before change:  [21.68466714]
curr_Stock_Price:  105.28730704213685
curr_Factors:  [105.28730704  -1.15769741  -1.00821873]
mat_Sqrt:  [[12.07064804  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01267673  0.03248857 -0.25751061]
Stock Position:  -0.012676733160057125
Bond Position:  [23.01936624]


portfolio before change:  [21.69071088]
curr_Stock_Price:  105.71871365934012
curr_Factors:  [105.71871366  -0.78072785  -1.05468315]
mat_Sqrt:  [[16.86720018  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0132716   0.0030977  -0.41613844]
Stock Position:  0.013271604710522269
Bond Position:  [20.2876539]


portfolio before change:  [21.68979808]
curr_Stock_Price:  104.88541902937281
curr_Factors:  [104.88541903  -1.49923927  -0.98451455]
mat_Sqrt:  [[ 8.75053369  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00334404 -0.04050722 -0.45943389]
Stock Position:  0.00334403788106483
Bond Position:  [21.33905727]


portfolio before change:  [21.69729627]
curr_Stock_Price:  103.93626493015546
curr_Factors:  [103.93626493  -1.44172069  -1.00677287]
mat_Sqrt:  [[ 8.98255462  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.67300540e-05 -5.57278562e-03 -2.35957554e-01]
Stock Position:  -3.6730053983471274e-05
Bond Position:  [21.70111386]


portfolio before change:  [21.70818028]
curr_Stock_Price:  103.09932608794412
curr_Factors:  [103.09932609  -0.88068588  -0.96381275]
mat_Sqrt:  [[16.3004746   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00102137  0.02338886 -0.5126324 ]
Stock Position:  0.0010213737152773316
Bond Position:  [21.60287734]


portfolio before change:  [21.71742702]
curr_Stock_Price:  101.57451262007964
curr_Factors:  [101.57451262  -0.27798735  -0.99599023]
mat_Sqrt:  [[28.4120988   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00619312  0.03308222 -0.30762217]
Stock Position:  0.006193118306571819
Bond Position:  [21.08836405]


portfolio before change:  [21.74196958]
curr_Stock_Price:  103.83439886467053
curr_Factors:  [103.83439886   0.26550189  -1.04182085]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.74196958]
Stock Price:  107.65862364231313
PL:  [14.08334594]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 2.27254126e-02 -6.19770096e-02  1.22418049e-01]
 [-7.81649731e-02  7.75916654e-02  1.40518989e-02]
 [-8.55943383e-02  7.86081905e-03 -5.19412864e-02]
 [ 7.19680291e-02 -6.51944312e-02 -4.57478387e-01]
 [ 6.75561478e-02 -1.25054600e-01 -1.65950513e-01]
 [ 4.55870877e-02 -6.36253248e-03 -1.07124963e-01]
 [ 2.49444580e-02  1.11555845e-01 -1.03726016e-01]
 [ 1.46277463e-01  5.66053150e-02 -2.33540871e-02]
 [-8.81471227e-02 -8.05024830e-02  4.05732555e-05]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.44388307]
curr_Stock_Price:  98.52608347596491
curr_Factors:  [98.52608348 -1.02664372 -1.07368075]
mat_Sqrt:  [[12.0612381   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00382329 -0.01959885  0.34922462]
Stock Position:  0.0038232934603131346
Bond Position:  [-8.8205772]


portfolio before change:  [-8.44955617]
curr_Stock_Price:  98.19607614505935
curr_Factors:  [98.19607615 -0.92730502 -1.07275216]
mat_Sqrt:  [[13.28863402  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00551548  0.02453664  0.04008616]
Stock Position:  -0.005515482850118143
Bond Position:  [-7.9079574]


portfolio before change:  [-8.46062542]
curr_Stock_Price:  99.48595009450518
curr_Factors:  [99.48595009 -0.79629995 -1.07631156]
mat_Sqrt:  [[15.2931484   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00627692  0.00248581 -0.14817403]
Stock Position:  -0.006276918326919802
Bond Position:  [-7.83616024]


portfolio before change:  [-8.48262891]
curr_Stock_Price:  102.36705104013089
curr_Factors:  [102.36705104  -1.57002652  -1.04237771]
mat_Sqrt:  [[ 7.50943821  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00307582 -0.02061629 -1.3050585 ]
Stock Position:  -0.0030758184388734538
Bond Position:  [-8.16776645]


portfolio before change:  [-8.48995236]
curr_Stock_Price:  103.4199561910664
curr_Factors:  [103.41995619  -1.51695585  -1.02393012]
mat_Sqrt:  [[ 8.14913651  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00373693 -0.03954574 -0.47341062]
Stock Position:  0.00373692908745384
Bond Position:  [-8.87642541]


portfolio before change:  [-8.49987441]
curr_Stock_Price:  101.95278335652382
curr_Factors:  [101.95278336  -1.36143823  -0.97279106]
mat_Sqrt:  [[ 9.87770806  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00238477 -0.00201201 -0.3055977 ]
Stock Position:  0.0023847653929599958
Bond Position:  [-8.74300788]


portfolio before change:  [-8.50313966]
curr_Stock_Price:  102.41712603116272
curr_Factors:  [102.41712603  -1.29772564  -1.00952081]
mat_Sqrt:  [[10.19408336  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00065252  0.03527706 -0.29590145]
Stock Position:  0.0006525190180925349
Bond Position:  [-8.56996878]


portfolio before change:  [-8.5074601]
curr_Stock_Price:  102.3644217118325
curr_Factors:  [102.36442171  -1.18946893  -0.99733619]
mat_Sqrt:  [[11.49295325  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01243996  0.01790017 -0.06662271]
Stock Position:  0.012439959472346525
Bond Position:  [-9.78086936]


portfolio before change:  [-8.50906614]
curr_Stock_Price:  102.62853946889874
curr_Factors:  [102.62853947  -0.9303281   -1.03353276]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.50906614]
Stock Price:  100.18921180230248
PL:  [-8.69827795]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-1.66940468e-02  3.24173557e-02 -8.93337731e-02]
 [-2.16447308e-01  4.41808383e-02 -2.76705709e-02]
 [-1.02777113e-01  3.94249985e-02 -6.46921450e-02]
 [ 2.09007091e-01 -2.69497226e-02 -2.90289292e-01]
 [ 6.73189480e-02 -1.26767591e-01 -1.65177412e-01]
 [-3.45304079e-02 -2.19399994e-02 -1.52874549e-02]
 [ 6.95942522e-02  7.25049626e-02 -1.87857193e-01]
 [ 2.44542823e-01  1.28639655e-01 -1.12989568e-01]
 [-8.41515102e-02 -8.17979203e-02 -4.23322556e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.45138458]
curr_Stock_Price:  101.15872492485852
curr_Factors:  [101.15872492  -0.94048587  -1.01668467]
mat_Sqrt:  [[14.28943237  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00238583  0.01025127 -0.25484439]
Stock Position:  -0.0023858340505859246
Bond Position:  [10.69273251]


portfolio before change:  [10.45727129]
curr_Stock_Price:  100.93280540090754
curr_Factors:  [100.9328054   -1.28950867  -1.06045424]
mat_Sqrt:  [[ 9.62623418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0229534   0.01397121 -0.07893644]
Stock Position:  -0.022953399082061638
Bond Position:  [12.77402225]


portfolio before change:  [10.46749744]
curr_Stock_Price:  100.76561708630078
curr_Factors:  [100.76561709  -0.92185134  -1.07107681]
mat_Sqrt:  [[13.73392502  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00837083  0.01246728 -0.18454868]
Stock Position:  -0.008370833021322592
Bond Position:  [11.31098959]


portfolio before change:  [10.44452279]
curr_Stock_Price:  104.18601279650245
curr_Factors:  [104.1860128   -1.36575706  -1.065817  ]
mat_Sqrt:  [[ 9.15778034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01627645 -0.00852225 -0.82811455]
Stock Position:  0.01627645487722275
Bond Position:  [8.74874385]


portfolio before change:  [10.44238769]
curr_Stock_Price:  103.78601400002529
curr_Factors:  [103.786014    -1.94370273  -1.02452684]
mat_Sqrt:  [[ 5.3340012   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.005686   -0.04008743 -0.47120518]
Stock Position:  0.0056859988689874465
Bond Position:  [9.85226053]


portfolio before change:  [10.4546995]
curr_Stock_Price:  105.08472092145726
curr_Factors:  [105.08472092  -1.34554599  -0.99317716]
mat_Sqrt:  [[10.13549628  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00377065 -0.00693804 -0.04361085]
Stock Position:  -0.0037706525583142006
Bond Position:  [10.85093747]


portfolio before change:  [10.45837761]
curr_Stock_Price:  105.54848955422563
curr_Factors:  [105.54848955  -1.64685371  -0.99973564]
mat_Sqrt:  [[ 7.48260588  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00442628  0.02292808 -0.53590428]
Stock Position:  0.004426283288229457
Bond Position:  [9.9911901]


portfolio before change:  [10.46158769]
curr_Stock_Price:  105.14481655695009
curr_Factors:  [105.14481656  -1.07744112  -1.01729687]
mat_Sqrt:  [[12.94358901  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0173677   0.04067943 -0.32232779]
Stock Position:  0.01736770113862518
Bond Position:  [8.63546393]


portfolio before change:  [10.46027992]
curr_Stock_Price:  104.82084855782558
curr_Factors:  [104.82084856  -0.32257802  -1.01807492]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.46027992]
Stock Price:  102.66628494125622
PL:  [7.79399498]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.62796957e-02  3.37015529e-02 -8.00972719e-02]
 [-3.69413243e-01 -7.52720702e-02 -2.04369265e-01]
 [-8.65667143e-02  1.01619428e-02 -5.32095278e-02]
 [ 2.36251620e-05 -4.22409524e-02 -2.54206593e-01]
 [-1.53045505e-01  7.00280381e-02  1.38445079e-01]
 [ 1.17679221e-01  1.46071760e-01 -4.43974716e-02]
 [ 1.50855885e-01 -1.21624544e-01  1.53569277e-01]
 [ 1.14342098e-01  1.15628109e-01  2.53722114e-02]
 [-1.40830220e-01 -2.03875619e-01  7.62177099e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.12605496]
curr_Stock_Price:  99.40633436499236
curr_Factors:  [99.40633436 -0.75866646 -0.90610739]
mat_Sqrt:  [[18.81100341  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328315  0.01065737 -0.22849522]
Stock Position:  -0.003283148224422052
Bond Position:  [-1.79968923]


portfolio before change:  [-2.13646564]
curr_Stock_Price:  102.30313045122563
curr_Factors:  [102.30313045  -0.41272604  -0.95007664]
mat_Sqrt:  [[26.18371344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01577597 -0.02380312 -0.58300863]
Stock Position:  -0.015775969373840147
Bond Position:  [-0.52253459]


portfolio before change:  [-2.09672864]
curr_Stock_Price:  99.76773414616449
curr_Factors:  [99.76773415 -0.42199294 -0.94973   ]
mat_Sqrt:  [[25.30803396  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00383932  0.00321349 -0.15179197]
Stock Position:  -0.003839321681523819
Bond Position:  [-1.71368821]


portfolio before change:  [-2.09094094]
curr_Stock_Price:  98.03702266156269
curr_Factors:  [98.03702266 -0.51771587 -1.00505014]
mat_Sqrt:  [[21.38263586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247662 -0.01335776 -0.72518065]
Stock Position:  -0.002476623340397318
Bond Position:  [-1.84814016]


portfolio before change:  [-2.08559368]
curr_Stock_Price:  95.5047218491152
curr_Factors:  [ 9.55047218e+01  7.63606421e-02 -1.01015563e+00]
mat_Sqrt:  [[37.53901148  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00327599  0.02214481  0.39494527]
Stock Position:  -0.0032759894531261885
Bond Position:  [-1.77272122]


portfolio before change:  [-2.08359592]
curr_Stock_Price:  94.62427127254291
curr_Factors:  [94.62427127 -0.43413685 -0.95577972]
mat_Sqrt:  [[23.57053569  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00476816  0.04619195 -0.12665363]
Stock Position:  0.0047681640758569285
Bond Position:  [-2.53477997]


portfolio before change:  [-2.07438011]
curr_Stock_Price:  96.82292017951013
curr_Factors:  [96.82292018 -0.15774729 -0.9880049 ]
mat_Sqrt:  [[30.78820193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00581595 -0.03846106  0.4380904 ]
Stock Position:  0.005815953494833157
Bond Position:  [-2.63749771]


portfolio before change:  [-2.10588086]
curr_Stock_Price:  91.63345826274568
curr_Factors:  [91.63345826  0.15884381 -0.90440632]
mat_Sqrt:  [[43.47708263  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00281773 0.03656482 0.07237986]
Stock Position:  0.002817730094893997
Bond Position:  [-2.36407921]


portfolio before change:  [-2.11135372]
curr_Stock_Price:  90.11076729868637
curr_Factors:  [ 9.01107673e+01 -4.90451089e-02 -9.89291249e-01]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.11135372]
Stock Price:  86.52879879925537
PL:  [-2.11135372]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-5.29247875e-04  2.80699811e-02 -8.55391598e-02]
 [-3.12280458e-01 -3.86873210e-02 -1.56835107e-01]
 [-1.15522533e-01  6.28379050e-02 -7.41501657e-02]
 [ 8.88316022e-02 -5.68131133e-02 -4.14824413e-01]
 [ 6.75273378e-02 -1.25262658e-01 -1.65856613e-01]
 [ 4.12663327e-02 -1.55590082e-02 -1.05373355e-01]
 [ 1.70562087e-02  1.27095765e-01 -7.32503364e-02]
 [ 1.68001826e-01  6.96621880e-02 -3.37344052e-02]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.08588869]
curr_Stock_Price:  101.24712916702012
curr_Factors:  [101.24712917  -1.56842045  -1.06558441]
mat_Sqrt:  [[ 7.26856943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00237531  0.00887651 -0.24401941]
Stock Position:  -0.0023753081162076303
Bond Position:  [11.32638182]


portfolio before change:  [11.08994156]
curr_Stock_Price:  101.92566901109183
curr_Factors:  [101.92566901  -1.19842864  -1.12883582]
mat_Sqrt:  [[ 9.94409938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03472343 -0.01223401 -0.4474069 ]
Stock Position:  -0.03472342536840778
Bond Position:  [14.62914992]


portfolio before change:  [11.07343607]
curr_Stock_Price:  102.61171558115966
curr_Factors:  [102.61171558  -1.23723199  -1.19451066]
mat_Sqrt:  [[ 9.01788175  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01430889  0.01987109 -0.21152978]
Stock Position:  -0.014308892919081113
Bond Position:  [12.54169612]


portfolio before change:  [11.08383207]
curr_Stock_Price:  102.32353238603007
curr_Factors:  [102.32353239  -1.43277586  -1.15345878]
mat_Sqrt:  [[ 7.70527409  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.48983721e-04 -1.79658839e-02 -1.18337859e+00]
Stock Position:  0.0003489837205934075
Bond Position:  [11.04812282]


portfolio before change:  [11.08972866]
curr_Stock_Price:  103.3870516871846
curr_Factors:  [103.38705169  -1.97909566  -1.13834916]
mat_Sqrt:  [[ 4.57695947  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00665021 -0.03961153 -0.47314275]
Stock Position:  0.006650207566555226
Bond Position:  [10.40218331]


portfolio before change:  [11.09843251]
curr_Stock_Price:  103.91357002742589
curr_Factors:  [103.91357003  -2.08102652  -1.13821807]
mat_Sqrt:  [[ 4.15501029  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00465832 -0.00492019 -0.30060085]
Stock Position:  0.00465831696201208
Bond Position:  [10.61437017]


portfolio before change:  [11.10367178]
curr_Stock_Price:  103.89870621962385
curr_Factors:  [103.89870622  -1.65087511  -1.14924368]
mat_Sqrt:  [[ 6.31733631  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00085252  0.04019121 -0.20896282]
Stock Position:  0.0008525183226386704
Bond Position:  [11.01509623]


portfolio before change:  [11.10912595]
curr_Stock_Price:  103.83447054452074
curr_Factors:  [103.83447054  -1.40556081  -1.14583405]
mat_Sqrt:  [[ 8.09626746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02012217  0.02202912 -0.09623487]
Stock Position:  0.020122172390617102
Bond Position:  [9.01975083]


portfolio before change:  [11.13329926]
curr_Stock_Price:  104.81161716343894
curr_Factors:  [104.81161716  -1.47793542  -1.11966644]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.13329926]
Stock Price:  105.97203626344188
PL:  [5.161263]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 1.44938395e-01 -1.10522086e-02 -5.13912900e-02]
 [-4.76909011e-01 -2.06841949e-01 -4.05554468e-01]
 [-1.26184469e-01  8.24235224e-02 -8.20620912e-02]
 [ 1.77956354e-01  1.75283474e-02 -5.67567865e-02]
 [ 6.88087939e-02 -1.16008338e-01 -1.70033239e-01]
 [ 4.98220738e-02  1.09836667e-02 -9.41293943e-02]
 [ 1.96241918e-01 -2.01831657e-01  2.17359860e-01]
 [ 1.33961884e-01  1.03905149e-01  1.34941830e-02]
 [-1.36453962e-01 -1.88684760e-01  8.70822357e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.07576455]
curr_Stock_Price:  102.77832752018332
curr_Factors:  [102.77832752  -1.05111451  -1.02539855]
mat_Sqrt:  [[12.8849691   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01041235 -0.00349502 -0.14660505]
Stock Position:  0.010412351299960357
Bond Position:  [21.0056005]


portfolio before change:  [22.09770426]
curr_Stock_Price:  103.87647356457697
curr_Factors:  [103.87647356  -0.90678208  -1.03556914]
mat_Sqrt:  [[14.89240306  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03794103 -0.06540917 -1.15693401]
Stock Position:  -0.03794102967730222
Bond Position:  [26.03888462]


portfolio before change:  [22.14004638]
curr_Stock_Price:  103.10371057680253
curr_Factors:  [103.10371058  -0.61036813  -1.03206   ]
mat_Sqrt:  [[19.9515583   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00705745  0.02606461 -0.2341003 ]
Stock Position:  -0.007057451586366611
Bond Position:  [22.86769582]


portfolio before change:  [22.15164241]
curr_Stock_Price:  103.08113577035704
curr_Factors:  [103.08113577  -0.32717209  -1.03486484]
mat_Sqrt:  [[26.40304842  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00631834  0.00554295 -0.16191131]
Stock Position:  0.006318342520300986
Bond Position:  [21.50034048]


portfolio before change:  [22.14340047]
curr_Stock_Price:  100.0748414760363
curr_Factors:  [100.07484148   0.12578822  -1.02037768]
mat_Sqrt:  [[40.90813172  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00076038 -0.03668506 -0.4850575 ]
Stock Position:  0.0007603764963577657
Bond Position:  [22.06730591]


portfolio before change:  [22.15401846]
curr_Stock_Price:  99.52456712610542
curr_Factors:  [99.52456713 -0.21136315 -1.01634669]
mat_Sqrt:  [[29.15698988  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00105949  0.00347334 -0.26852496]
Stock Position:  0.001059491699322934
Bond Position:  [22.04857301]


portfolio before change:  [22.15982179]
curr_Stock_Price:  94.5941716234419
curr_Factors:  [ 9.45941716e+01 -9.15500272e-02 -1.02753055e+00]
mat_Sqrt:  [[30.89255717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00761993 -0.06382477  0.62006718]
Stock Position:  0.007619927382810874
Bond Position:  [21.43902107]


portfolio before change:  [22.15335847]
curr_Stock_Price:  92.33883337156087
curr_Factors:  [92.33883337 -0.30924746 -1.01015971]
mat_Sqrt:  [[24.6815897   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0056479  0.03285769 0.03849515]
Stock Position:  0.005647901692447141
Bond Position:  [21.63183782]


portfolio before change:  [22.16018575]
curr_Stock_Price:  91.63213803538248
curr_Factors:  [91.63213804 -0.353598   -1.09018768]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.16018575]
Stock Price:  93.76856593468145
PL:  [22.16018575]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 4.41477157e-02  1.60545211e-02 -7.50514451e-02]
 [-3.01879784e-01 -2.80638808e-02 -1.41121859e-01]
 [-9.99408421e-02  3.42148636e-02 -6.25874271e-02]
 [ 5.23822767e-03 -5.80451344e-02 -3.57092910e-01]
 [ 6.94681231e-02 -1.11246847e-01 -1.72182179e-01]
 [ 8.45031082e-02  1.34817434e-01 -7.91899172e-03]
 [ 9.43742872e-02 -1.07975363e-01  8.03526634e-02]
 [ 1.21870751e-01  4.69547109e-02  1.99050026e-02]
 [-1.22643339e-01 -1.41478044e-01  1.18824444e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.67703182]
curr_Stock_Price:  101.6081481761242
curr_Factors:  [101.60814818  -1.41145393  -1.00338789]
mat_Sqrt:  [[ 9.08188631  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00321986  0.00507689 -0.21410088]
Stock Position:  0.0032198629877356853
Bond Position:  [13.3498675]


portfolio before change:  [13.68451469]
curr_Stock_Price:  101.85855306847368
curr_Factors:  [101.85855307  -1.91275757  -0.95970345]
mat_Sqrt:  [[ 5.76107504  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05752586 -0.00887458 -0.40258138]
Stock Position:  -0.057525855265875864
Bond Position:  [19.54401507]


portfolio before change:  [13.74226947]
curr_Stock_Price:  101.02448756200211
curr_Factors:  [101.02448756  -1.68291079  -0.95117143]
mat_Sqrt:  [[ 7.25202487  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01542094  0.01081969 -0.17854451]
Stock Position:  -0.015420937624444003
Bond Position:  [15.30016179]


portfolio before change:  [13.75993607]
curr_Stock_Price:  100.37507155988361
curr_Factors:  [100.37507156  -1.06196919  -1.04645589]
mat_Sqrt:  [[12.18845039  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00567355 -0.01835548 -1.01868668]
Stock Position:  -0.005673549463197106
Bond Position:  [14.329419]


portfolio before change:  [13.77739172]
curr_Stock_Price:  98.56154191683042
curr_Factors:  [98.56154192 -1.15416611 -1.04334333]
mat_Sqrt:  [[10.94816332  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00287256 -0.03517934 -0.49118783]
Stock Position:  0.002872555048424771
Bond Position:  [13.49426827]


portfolio before change:  [13.77781084]
curr_Stock_Price:  96.35803209134188
curr_Factors:  [96.35803209 -0.91049406 -0.96059209]
mat_Sqrt:  [[14.83493108  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00582191  0.04263302 -0.02259068]
Stock Position:  0.005821909212573228
Bond Position:  [13.21682313]


portfolio before change:  [13.78597276]
curr_Stock_Price:  96.62458634158683
curr_Factors:  [96.62458634 -1.23055634 -0.9806394 ]
mat_Sqrt:  [[10.58711271  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01019998 -0.03414481  0.22922378]
Stock Position:  0.010199975863351704
Bond Position:  [12.80040431]


portfolio before change:  [13.78223738]
curr_Stock_Price:  95.63074300308851
curr_Factors:  [95.630743   -1.04669229 -0.98095452]
mat_Sqrt:  [[12.58930365  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01009954 0.01484838 0.05678343]
Stock Position:  0.010099542551562613
Bond Position:  [12.81641062]


portfolio before change:  [13.78661037]
curr_Stock_Price:  95.42906799214681
curr_Factors:  [95.42906799 -0.91065908 -0.97942401]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.78661037]
Stock Price:  96.47608239725471
PL:  [13.78661037]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 2.49108518e-02 -6.45718911e-02  1.27777494e-01]
 [-8.04390719e-02  7.13734237e-02  1.02477647e-02]
 [-8.12356571e-02 -1.45931475e-04 -4.87068306e-02]
 [-2.08762794e-02 -7.05162182e-02 -4.02186372e-01]
 [ 6.88026828e-02 -1.16052471e-01 -1.70013321e-01]
 [ 5.29649055e-02  2.38564797e-02 -8.44852340e-02]
 [ 9.09322515e-02  4.04986153e-02 -3.16686402e-02]
 [ 1.62699896e-01  7.74426507e-02 -6.72796285e-02]
 [-8.35664762e-02 -5.51553724e-02  2.16936064e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.51384807]
curr_Stock_Price:  98.51633538558924
curr_Factors:  [98.51633539 -0.84562356 -0.93139266]
mat_Sqrt:  [[16.66325771  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00296017 -0.02041942  0.36451362]
Stock Position:  0.002960170533710981
Bond Position:  [-8.80547323]


portfolio before change:  [-8.51832766]
curr_Stock_Price:  98.49074491193527
curr_Factors:  [98.49074491 -0.76697195 -0.87941448]
mat_Sqrt:  [[18.9836133   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00403002  0.02257026  0.02923402]
Stock Position:  -0.00403002319016871
Bond Position:  [-8.12140768]


portfolio before change:  [-8.52389924]
curr_Stock_Price:  98.86539710708888
curr_Factors:  [98.86539711 -0.80170214 -0.87328044]
mat_Sqrt:  [[18.5186201   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.92378291e-03 -4.61475845e-05 -1.38947030e-01]
Stock Position:  -0.004923782913175831
Bond Position:  [-8.03710749]


portfolio before change:  [-8.53425863]
curr_Stock_Price:  100.15299087356739
curr_Factors:  [100.15299087  -1.20513481  -0.89940738]
mat_Sqrt:  [[12.20879674  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0085834  -0.02229919 -1.14732577]
Stock Position:  -0.008583397038103251
Bond Position:  [-7.67460575]


portfolio before change:  [-8.53250051]
curr_Stock_Price:  99.50098988845822
curr_Factors:  [99.50098989 -1.63966474 -0.85959244]
mat_Sqrt:  [[ 8.17360791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00380522 -0.03669901 -0.48500068]
Stock Position:  0.003805222524596456
Bond Position:  [-8.91112392]


portfolio before change:  [-8.53609712]
curr_Stock_Price:  99.72701324316738
curr_Factors:  [99.72701324 -1.1284916  -0.8619682 ]
mat_Sqrt:  [[13.62595987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00266663  0.00754408 -0.24101286]
Stock Position:  0.00266663055951247
Bond Position:  [-8.80203222]


portfolio before change:  [-8.53870637]
curr_Stock_Price:  100.39934611167672
curr_Factors:  [100.39934611  -0.37050711  -0.88080154]
mat_Sqrt:  [[28.72727559  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00297674  0.01280679 -0.09034182]
Stock Position:  0.0029767384957880426
Bond Position:  [-8.83756897]


portfolio before change:  [-8.54100286]
curr_Stock_Price:  101.11267835799963
curr_Factors:  [101.11267836  -0.50114359  -0.90507899]
mat_Sqrt:  [[24.77940679  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0060924   0.02448952 -0.19193005]
Stock Position:  0.0060924000845804195
Bond Position:  [-9.15702175]


portfolio before change:  [-8.54540274]
curr_Stock_Price:  101.14218552881663
curr_Factors:  [101.14218553  -1.02624404  -0.87398606]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.54540274]
Stock Price:  99.33174622217112
PL:  [-8.54540274]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-1.66050100e-02 -7.44795137e-03  7.00196584e-03]
 [-1.63555026e-01  8.00627866e-02 -3.88938536e-04]
 [-1.22176305e-01  7.50606606e-02 -7.90877446e-02]
 [-2.58472117e-02 -3.80319296e-02 -2.22058143e-01]
 [-8.74110728e-02 -1.31236119e-02 -7.05722614e-03]
 [ 7.96538341e-02  1.33172416e-01 -2.58701840e-03]
 [ 1.68951291e-01 -1.82454172e-01  1.78522685e-01]
 [ 7.98421968e-02  1.36242042e-01  4.62588209e-02]
 [-1.48646339e-01 -2.30349437e-01  5.90963344e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.9769881]
curr_Stock_Price:  99.00911931172953
curr_Factors:  [99.00911931 -0.83835957 -0.97123709]
mat_Sqrt:  [[16.20978862  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094807 -0.00235525  0.01997466]
Stock Position:  -0.0009480718907206139
Bond Position:  [-4.88312033]


portfolio before change:  [-4.98073202]
curr_Stock_Price:  100.38217773105747
curr_Factors:  [100.38217773  -0.65950124  -0.99213004]
mat_Sqrt:  [[19.24696519  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00839442  0.02531808 -0.00110953]
Stock Position:  -0.008394424960858857
Bond Position:  [-4.13808137]


portfolio before change:  [-5.00169327]
curr_Stock_Price:  102.63268171605002
curr_Factors:  [102.63268172  -0.63397009  -0.9544486 ]
mat_Sqrt:  [[20.96255453  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00650598  0.02373627 -0.22561532]
Stock Position:  -0.006505980230259649
Bond Position:  [-4.33396707]


portfolio before change:  [-4.98271212]
curr_Stock_Price:  99.38203040577011
curr_Factors:  [99.38203041 -0.63104136 -0.91685151]
mat_Sqrt:  [[21.13812855  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00341358 -0.01202675 -0.63347007]
Stock Position:  -0.0034135765800216633
Bond Position:  [-4.64346395]


portfolio before change:  [-4.97579084]
curr_Stock_Price:  96.67413852482967
curr_Factors:  [96.67413852 -0.16023506 -0.90245941]
mat_Sqrt:  [[33.40319172  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267012 -0.00415005 -0.0201323 ]
Stock Position:  -0.0026701182917005985
Bond Position:  [-4.71765945]


portfolio before change:  [-4.97867546]
curr_Stock_Price:  96.87083606083614
curr_Factors:  [96.87083606 -0.62672526 -0.86128115]
mat_Sqrt:  [[21.8756052   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00377426  0.04211282 -0.00738004]
Stock Position:  0.0037742616660164075
Bond Position:  [-5.34429135]


portfolio before change:  [-4.98978327]
curr_Stock_Price:  94.63596481404689
curr_Factors:  [94.63596481 -0.75074827 -0.91562535]
mat_Sqrt:  [[17.87966372  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01122399 -0.05769708  0.50927553]
Stock Position:  0.011223988246503978
Bond Position:  [-6.05197622]


portfolio before change:  [-5.04324764]
curr_Stock_Price:  90.14222973878475
curr_Factors:  [90.14222974 -0.98438207 -0.88887393]
mat_Sqrt:  [[13.84788836  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00670156 0.04308352 0.13196354]
Stock Position:  0.006701562795269532
Bond Position:  [-5.64734145]


portfolio before change:  [-5.05574451]
curr_Stock_Price:  88.69891023235753
curr_Factors:  [88.69891023 -0.89833606 -0.87418387]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.05574451]
Stock Price:  87.74522559208413
PL:  [-5.05574451]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 5.16251496e-02 -1.00845615e-01  2.04321080e-01]
 [-1.13981497e-01  7.41686712e-02  2.21688055e-03]
 [-1.00653478e-01  3.55239520e-02 -6.31162544e-02]
 [-4.36135860e-02 -8.58544262e-02 -4.58476098e-01]
 [ 7.06234116e-02 -8.50479694e-02 -1.81881111e-01]
 [ 7.32550567e-02  1.06963483e-01 -2.22224433e-02]
 [ 4.50187912e-03  1.01707717e-01 -2.90028976e-02]
 [ 9.21625595e-02  2.21396211e-02  8.88944798e-03]
 [-9.47188662e-02 -6.82856948e-02  2.37693613e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.02971113]
curr_Stock_Price:  98.16580500480791
curr_Factors:  [98.165805   -1.22564824 -1.01087802]
mat_Sqrt:  [[10.48695055  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00865153 -0.03189018  0.58287117]
Stock Position:  0.008651532435469608
Bond Position:  [-11.87899578]


portfolio before change:  [-11.04102117]
curr_Stock_Price:  97.54521472306257
curr_Factors:  [97.54521472 -1.16372994 -0.96181013]
mat_Sqrt:  [[11.64382437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00958568  0.02345419  0.00632414]
Stock Position:  -0.009585677984011606
Bond Position:  [-10.10598415]


portfolio before change:  [-11.05894246]
curr_Stock_Price:  98.8875331883832
curr_Factors:  [98.88753319 -1.52523317 -0.94512279]
mat_Sqrt:  [[ 8.36141118  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01346899  0.01123366 -0.18005311]
Stock Position:  -0.013468994962502756
Bond Position:  [-9.72702677]


portfolio before change:  [-11.0642452]
curr_Stock_Price:  98.92005281187471
curr_Factors:  [98.92005281 -1.22520062 -1.03139938]
mat_Sqrt:  [[10.35751121  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01346041 -0.02714955 -1.30790469]
Stock Position:  -0.0134604130878328
Bond Position:  [-9.73274042]


portfolio before change:  [-11.04598378]
curr_Stock_Price:  97.20175441188503
curr_Factors:  [97.20175441 -1.10492144 -1.00486664]
mat_Sqrt:  [[11.78704063  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00265556 -0.02689453 -0.51885618]
Stock Position:  0.0026555568230087084
Bond Position:  [-11.30410856]


portfolio before change:  [-11.04804469]
curr_Stock_Price:  98.5545998638485
curr_Factors:  [98.55459986 -1.30039101 -0.99610969]
mat_Sqrt:  [[ 9.91560729  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00720891  0.03382482 -0.06339445]
Stock Position:  0.007208908395895654
Bond Position:  [-11.75851577]


portfolio before change:  [-11.04603577]
curr_Stock_Price:  99.64902901102934
curr_Factors:  [99.64902901 -1.52009145 -0.98096096]
mat_Sqrt:  [[ 8.17108659  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00014781  0.0321628  -0.08273719]
Stock Position:  0.00014781013252992728
Bond Position:  [-11.06076491]


portfolio before change:  [-11.05158045]
curr_Stock_Price:  99.5617052331413
curr_Factors:  [99.56170523 -1.23423928 -1.03779423]
mat_Sqrt:  [[10.2650415   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00921075 0.00700116 0.02535912]
Stock Position:  0.00921075215244823
Bond Position:  [-11.96861864]


portfolio before change:  [-11.0593506]
curr_Stock_Price:  99.36798041474421
curr_Factors:  [99.36798041 -1.18089519 -0.99173556]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.0593506]
Stock Price:  98.61151302767732
PL:  [-11.0593506]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-1.13094286e-02  1.00854882e-01  4.47270849e-02]
 [-9.80649615e-02  3.07689342e-02 -6.11953884e-02]
 [ 1.73779554e-03 -6.80323102e-02 -4.22670793e-01]
 [ 6.87232785e-02 -1.16625907e-01 -1.69754521e-01]
 [ 4.56707378e-02 -6.01990772e-03 -1.06868273e-01]
 [ 7.57823952e-03  1.31639005e-01 -6.21602155e-02]
 [ 1.46238575e-01  5.13066306e-02 -5.98117950e-03]
 [-6.00725626e-02 -2.32756209e-02  3.56491982e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.95463745]
curr_Stock_Price:  100.2535455911886
curr_Factors:  [100.25354559  -1.95856827  -0.98883304]
mat_Sqrt:  [[ 5.26089478  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01173422  0.01250945 -0.27262553]
Stock Position:  -0.011734221194795088
Bond Position:  [5.13103473]


portfolio before change:  [3.95967607]
curr_Stock_Price:  100.04284078907396
curr_Factors:  [100.04284079  -1.32501759  -1.05212499]
mat_Sqrt:  [[ 9.2855175   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [4.57175633e-05 3.18931140e-02 1.27593924e-01]
Stock Position:  4.571756332722824e-05
Bond Position:  [3.95510235]


portfolio before change:  [3.96167116]
curr_Stock_Price:  100.41585321921666
curr_Factors:  [100.41585322  -1.25300155  -1.11096054]
mat_Sqrt:  [[ 9.44379584  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01162265  0.00972999 -0.17457341]
Stock Position:  -0.011622653565541879
Bond Position:  [5.12876984]


portfolio before change:  [3.96147785]
curr_Stock_Price:  100.65317799361455
curr_Factors:  [100.65317799  -1.264057    -1.05469718]
mat_Sqrt:  [[ 9.9038795   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00871336 -0.02151371 -1.20576212]
Stock Position:  -0.008713363838834615
Bond Position:  [4.83850561]


portfolio before change:  [3.96018065]
curr_Stock_Price:  101.07977018093757
curr_Factors:  [101.07977018  -0.49252342  -1.02499348]
mat_Sqrt:  [[22.16231018  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00140152 -0.03688035 -0.4842624 ]
Stock Position:  0.0014015242046876283
Bond Position:  [3.81851491]


portfolio before change:  [3.9633576]
curr_Stock_Price:  101.98394162236019
curr_Factors:  [101.98394162  -1.23202288  -1.02866973]
mat_Sqrt:  [[10.63470552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00222864 -0.00190366 -0.30486544]
Stock Position:  0.0022286380798648637
Bond Position:  [3.73607231]


portfolio before change:  [3.96602932]
curr_Stock_Price:  102.3443462751606
curr_Factors:  [102.34434628  -1.50585599  -1.05484974]
mat_Sqrt:  [[ 7.90612157  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00021645  0.04162791 -0.17732579]
Stock Position:  -0.00021644706879492119
Bond Position:  [3.98818145]


portfolio before change:  [3.96780401]
curr_Stock_Price:  103.3602954966153
curr_Factors:  [103.3602955   -1.56778175  -1.02258605]
mat_Sqrt:  [[ 7.75124203  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01887987  0.01622458 -0.01706264]
Stock Position:  0.01887986502521117
Bond Position:  [2.01637558]


portfolio before change:  [3.96717088]
curr_Stock_Price:  103.27334731609697
curr_Factors:  [103.27334732  -1.6676191   -1.04676556]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.96717088]
Stock Price:  103.92975949847711
PL:  [0.03741138]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 6.41233025e-02 -1.15273094e-01  2.33972471e-01]
 [-1.89633828e-01  7.18664757e-02 -2.02744085e-02]
 [-1.06764717e-01  4.67500921e-02 -6.76512345e-02]
 [ 3.84635023e-02 -2.20841988e-02 -2.07942322e-01]
 [ 1.09248784e-02 -6.98828713e-02 -1.35611177e-01]
 [ 4.92044412e-02  8.45388754e-03 -9.60246751e-02]
 [ 4.86785111e-02  9.80583214e-02  2.85299866e-02]
 [ 1.06221199e-01  3.02554926e-02  1.11570340e-02]
 [-1.08345682e-01 -9.80859368e-02  1.32660026e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.58577972]
curr_Stock_Price:  98.08832903353259
curr_Factors:  [98.08832903 -0.53518001 -1.00135009]
mat_Sqrt:  [[21.10137684  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0051611  -0.03645255  0.66745833]
Stock Position:  0.005161103725586511
Bond Position:  [-12.09202376]


portfolio before change:  [-11.5930428]
curr_Stock_Price:  97.85280691294155
curr_Factors:  [97.85280691 -0.38398557 -1.02415383]
mat_Sqrt:  [[23.93459682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00801838  0.02272618 -0.05783724]
Stock Position:  -0.008018381984209092
Bond Position:  [-10.80842161]


portfolio before change:  [-11.62486521]
curr_Stock_Price:  101.14734354301079
curr_Factors:  [101.14734354  -0.93373617  -1.03911091]
mat_Sqrt:  [[14.06558757  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00848645  0.01478368 -0.19299014]
Stock Position:  -0.008486448545423771
Bond Position:  [-10.76648349]


portfolio before change:  [-11.62696345]
curr_Stock_Price:  100.76009647905417
curr_Factors:  [100.76009648  -0.60666248  -1.01261889]
mat_Sqrt:  [[19.95462687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.28155510e-04 -6.98363684e-03 -5.93201566e-01]
Stock Position:  -0.0002281555104906162
Bond Position:  [-11.60397448]


portfolio before change:  [-11.63192479]
curr_Stock_Price:  97.06919894866058
curr_Factors:  [97.06919895 -0.77065589 -0.99427522]
mat_Sqrt:  [[16.61810902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111691 -0.0220989  -0.38686094]
Stock Position:  -0.001116914389266465
Bond Position:  [-11.5235068]


portfolio before change:  [-11.64057436]
curr_Stock_Price:  99.65344190861236
curr_Factors:  [99.65344191 -0.54561699 -1.00673935]
mat_Sqrt:  [[21.10146029  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00141326  0.00267335 -0.27393167]
Stock Position:  0.0014132559765406155
Bond Position:  [-11.78141018]


portfolio before change:  [-11.64527617]
curr_Stock_Price:  100.49572971119997
curr_Factors:  [100.49572971  -0.55224544  -1.06904805]
mat_Sqrt:  [[19.86226579  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00287148 0.03100876 0.08138811]
Stock Position:  0.0028714762851417635
Bond Position:  [-11.93384727]


portfolio before change:  [-11.66098806]
curr_Stock_Price:  97.10253651040064
curr_Factors:  [97.10253651 -0.46824942 -1.04730188]
mat_Sqrt:  [[21.33216865  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00512277 0.00956763 0.03182791]
Stock Position:  0.005122770906910532
Bond Position:  [-12.15842211]


portfolio before change:  [-11.6648471]
curr_Stock_Price:  97.53622610063995
curr_Factors:  [97.5362261  -0.68958846 -1.03355818]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.6648471]
Stock Price:  100.24405166171297
PL:  [-11.90889876]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 8.45081214e-02 -1.38066812e-01  2.80547522e-01]
 [-2.68909572e-01  1.18626985e-02 -8.01773982e-02]
 [-1.17564343e-01  6.65886422e-02 -7.56653363e-02]
 [ 1.32188140e-01 -4.90566693e-02 -3.83624179e-01]
 [ 6.75623035e-02 -1.25010146e-01 -1.65970576e-01]
 [-1.27515426e-01 -4.87416045e-02  8.87573344e-02]
 [ 1.13673485e-01  1.58138111e-02 -3.03687426e-01]
 [ 3.40383930e-01  1.99311885e-01 -2.01778970e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.70873273]
curr_Stock_Price:  97.7925420574935
curr_Factors:  [97.79254206 -1.19829286 -0.93825212]
mat_Sqrt:  [[11.54558768  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01197079 -0.04366056  0.80032399]
Stock Position:  0.011970787330289862
Bond Position:  [-14.87938645]


portfolio before change:  [-13.67396126]
curr_Stock_Price:  101.31887772305546
curr_Factors:  [101.31887772  -1.26562485  -0.97797887]
mat_Sqrt:  [[10.74745552  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02651506  0.00375131 -0.2287238 ]
Stock Position:  -0.026515059329471395
Bond Position:  [-10.98748521]


portfolio before change:  [-13.73196628]
curr_Stock_Price:  103.29925784158877
curr_Factors:  [103.29925784  -1.62319458  -0.99588519]
mat_Sqrt:  [[ 7.52740549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01744162  0.02105718 -0.21585214]
Stock Position:  -0.01744162105007988
Bond Position:  [-11.93025977]


portfolio before change:  [-13.73784041]
curr_Stock_Price:  103.29395499223892
curr_Factors:  [103.29395499  -1.5244401   -0.96188623]
mat_Sqrt:  [[ 8.59561786  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00612109 -0.01551308 -1.094373  ]
Stock Position:  0.00612108930068424
Bond Position:  [-14.37011193]


portfolio before change:  [-13.74372069]
curr_Stock_Price:  103.50740850051466
curr_Factors:  [103.5074085   -0.76153869  -0.95050174]
mat_Sqrt:  [[18.68278947  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00163016 -0.03953168 -0.47346786]
Stock Position:  0.0016301609271015983
Bond Position:  [-13.91245443]


portfolio before change:  [-13.74478915]
curr_Stock_Price:  107.12024728205306
curr_Factors:  [107.12024728  -1.11302453  -0.97571704]
mat_Sqrt:  [[13.26608049  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0083413  -0.01541345  0.25319997]
Stock Position:  -0.008341304248513244
Bond Position:  [-12.85126658]


portfolio before change:  [-13.75575545]
curr_Stock_Price:  107.66441353496947
curr_Factors:  [107.66441353  -1.22300813  -0.98280295]
mat_Sqrt:  [[11.86043453  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00439207  0.00500077 -0.8663357 ]
Stock Position:  0.004392070099673551
Bond Position:  [-14.2286251]


portfolio before change:  [-13.76083846]
curr_Stock_Price:  108.12731220911728
curr_Factors:  [108.12731221  -1.02828553  -1.01936357]
mat_Sqrt:  [[13.95252155  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0218127   0.06302795 -0.57561924]
Stock Position:  0.02181270104330423
Bond Position:  [-16.11938719]


portfolio before change:  [-13.79316286]
curr_Stock_Price:  107.01499246887659
curr_Factors:  [107.01499247  -0.76861018  -0.98255309]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.79316286]
Stock Price:  107.10534479922148
PL:  [-20.89850766]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-2.77018233e-01 -2.66983660e-03 -1.03561249e-01]
 [-1.12502394e-01  5.72900113e-02 -7.19090047e-02]
 [ 5.76578518e-02 -8.48924452e-02 -5.65274979e-01]
 [ 6.80310539e-02 -1.21624960e-01 -1.67498366e-01]
 [ 4.60595352e-02 -4.42742143e-03 -1.05675201e-01]
 [-1.78782318e-02  1.30134825e-01 -5.71390100e-02]
 [ 1.15276749e-01  3.56920830e-02 -1.03733567e-03]
 [-9.19589884e-02 -7.92666191e-02  4.11783226e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.65349294]
curr_Stock_Price:  100.76890004201114
curr_Factors:  [100.76890004  -1.30821764  -0.97440588]
mat_Sqrt:  [[10.28006158  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00600507  0.01250945 -0.27262553]
Stock Position:  -0.006005071332499866
Bond Position:  [8.25861737]


portfolio before change:  [7.6532339]
curr_Stock_Price:  101.49984582294454
curr_Factors:  [101.49984582  -1.43518186  -1.0181962 ]
mat_Sqrt:  [[ 8.729248    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03416406 -0.00084428 -0.29543142]
Stock Position:  -0.034164056253398634
Bond Position:  [11.12088034]


portfolio before change:  [7.61909038]
curr_Stock_Price:  102.66204249709082
curr_Factors:  [102.6620425   -1.62489651  -1.05706764]
mat_Sqrt:  [[ 7.02502174  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0178934   0.01811669 -0.20513637]
Stock Position:  -0.01789340172850981
Bond Position:  [9.45606355]


portfolio before change:  [7.62627683]
curr_Stock_Price:  102.52471603593675
curr_Factors:  [102.52471604  -1.88792217  -1.05395044]
mat_Sqrt:  [[ 5.40990372  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01107604 -0.02684535 -1.61257217]
Stock Position:  -0.011076044360818283
Bond Position:  [8.76184513]


portfolio before change:  [7.63057862]
curr_Stock_Price:  102.53195923874966
curr_Factors:  [102.53195924  -2.07419085  -1.07311455]
mat_Sqrt:  [[ 4.40556778  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00696851 -0.03846119 -0.47782622]
Stock Position:  0.006968511606252034
Bond Position:  [6.91608347]


portfolio before change:  [7.63191085]
curr_Stock_Price:  102.2267753753672
curr_Factors:  [102.22677538  -1.68118458  -1.0634348 ]
mat_Sqrt:  [[ 6.57039702  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00370972 -0.00140007 -0.30146193]
Stock Position:  0.0037097240327407226
Bond Position:  [7.25267773]


portfolio before change:  [7.63298852]
curr_Stock_Price:  101.53950659183909
curr_Factors:  [101.53950659  -1.53883396  -1.10560467]
mat_Sqrt:  [[ 7.21389711  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00362933  0.04115225 -0.16300169]
Stock Position:  -0.0036293304797169433
Bond Position:  [8.00150895]


portfolio before change:  [7.6368736]
curr_Stock_Price:  101.57165413191203
curr_Factors:  [101.57165413  -1.14252698  -1.16039041]
mat_Sqrt:  [[10.15379076  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01142298  0.01128683 -0.00295923]
Stock Position:  0.01142298204387228
Bond Position:  [6.47662242]


portfolio before change:  [7.64431119]
curr_Stock_Price:  101.93920007266394
curr_Factors:  [101.93920007  -0.71878818  -1.16766761]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.64431119]
Stock Price:  103.61490655841166
PL:  [4.02940463]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-2.69121717e-01  1.23600876e-02 -7.92259319e-02]
 [-1.05792502e-01  4.49641668e-02 -6.69297812e-02]
 [-7.03495745e-03 -8.48340135e-02 -5.37017227e-01]
 [ 6.87213110e-02 -1.16640115e-01 -1.69748108e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 5.26774201e-02  7.06058400e-02 -1.86145688e-01]
 [ 2.26307351e-01  1.12012713e-01 -8.56335077e-02]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.49737351]
curr_Stock_Price:  99.91117971269918
curr_Factors:  [99.91117971 -1.21062962 -0.97141852]
mat_Sqrt:  [[11.27100447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00547711  0.01250945 -0.27262553]
Stock Position:  -0.00547710749579817
Bond Position:  [2.04459778]


portfolio before change:  [1.49071011]
curr_Stock_Price:  101.31446707532533
curr_Factors:  [101.31446708  -1.27327991  -0.96713065]
mat_Sqrt:  [[10.78135926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02643215  0.0039086  -0.22600953]
Stock Position:  -0.02643215013195023
Bond Position:  [4.16866931]


portfolio before change:  [1.48724932]
curr_Stock_Price:  101.52427371788492
curr_Factors:  [101.52427372  -1.45407514  -1.0142011 ]
mat_Sqrt:  [[ 8.60223174  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01375149  0.01421892 -0.19093204]
Stock Position:  -0.013751491548767808
Bond Position:  [2.88335951]


portfolio before change:  [1.49213478]
curr_Stock_Price:  101.27387073204576
curr_Factors:  [101.27387073  -1.64048941  -0.978271  ]
mat_Sqrt:  [[ 7.38217285  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01609872 -0.02682687 -1.53196067]
Stock Position:  -0.016098721488979784
Bond Position:  [3.12251461]


portfolio before change:  [1.51497024]
curr_Stock_Price:  99.95241095819526
curr_Factors:  [99.95241096 -0.89532088 -0.96020864]
mat_Sqrt:  [[15.62957055  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00198726 -0.03688484 -0.4842441 ]
Stock Position:  0.0019872579772105114
Bond Position:  [1.31633901]


portfolio before change:  [1.51709794]
curr_Stock_Price:  100.69180765960911
curr_Factors:  [100.69180766  -0.56933657  -0.95534171]
mat_Sqrt:  [[21.91970838  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107907 -0.00193948 -0.30510753]
Stock Position:  0.0010790748323966503
Bond Position:  [1.40844395]


portfolio before change:  [1.51984703]
curr_Stock_Price:  102.58666667468532
curr_Factors:  [102.58666667  -0.78002431  -0.92155037]
mat_Sqrt:  [[18.7114061   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00088201  0.02232753 -0.53102184]
Stock Position:  0.0008820088391772531
Bond Position:  [1.42936469]


portfolio before change:  [1.52274973]
curr_Stock_Price:  105.06718274401796
curr_Factors:  [105.06718274  -1.31222999  -0.95493522]
mat_Sqrt:  [[10.88553418  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01944963  0.03542153 -0.24428856]
Stock Position:  0.01944963259463089
Bond Position:  [-0.52076837]


portfolio before change:  [1.55164845]
curr_Stock_Price:  106.56639687194163
curr_Factors:  [106.56639687  -1.06858618  -0.92574624]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.55164845]
Stock Price:  107.7949647892878
PL:  [-6.24331634]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-3.02309927e-02  1.03957266e-02 -3.04459076e-02]
 [-7.44110680e-02  7.27293481e-02  1.26363277e-02]
 [-7.72986724e-02 -2.93507178e-03 -5.05023793e-02]
 [ 2.23483571e-02 -5.82763064e-02 -3.41854256e-01]
 [ 5.54103763e-02 -2.84540534e-02 -1.16254024e-01]
 [ 1.14093501e-01  1.44855377e-01 -4.04548278e-02]
 [ 1.07952893e-01 -1.30987048e-01  9.72044675e-02]
 [ 1.21308657e-01  4.63549159e-02  1.95907970e-02]
 [-1.24226427e-01 -1.46618886e-01  1.16124741e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.94183611]
curr_Stock_Price:  99.15334505516759
curr_Factors:  [99.15334506 -1.00405438 -0.99235556]
mat_Sqrt:  [[13.46720745  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268633  0.00328742 -0.0868537 ]
Stock Position:  -0.0026863268612401523
Bond Position:  [-3.67547782]


portfolio before change:  [-3.94349507]
curr_Stock_Price:  99.08662117888119
curr_Factors:  [99.08662118 -0.36480658 -0.9611856 ]
mat_Sqrt:  [[26.31139867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00265869  0.02299904  0.03604793]
Stock Position:  -0.0026586889432402517
Bond Position:  [-3.68005456]


portfolio before change:  [-3.94615764]
curr_Stock_Price:  99.39582978294649
curr_Factors:  [99.39582978 -0.32836541 -0.97418123]
mat_Sqrt:  [[27.01962682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324517 -0.00092815 -0.14406923]
Stock Position:  -0.003245167343680133
Bond Position:  [-3.62360154]


portfolio before change:  [-3.94240788]
curr_Stock_Price:  97.68189246217518
curr_Factors:  [97.68189246 -0.70779515 -0.93618449]
mat_Sqrt:  [[18.87307993  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259295 -0.01842859 -0.97521504]
Stock Position:  -0.002592954551195895
Bond Position:  [-3.68912318]


portfolio before change:  [-3.938858]
curr_Stock_Price:  95.601289219737
curr_Factors:  [95.60128922 -1.244923   -0.94260333]
mat_Sqrt:  [[10.72588504  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00288512 -0.00899796 -0.33164037]
Stock Position:  0.0028851178624083496
Bond Position:  [-4.21467898]


portfolio before change:  [-3.94224898]
curr_Stock_Price:  95.15655361149535
curr_Factors:  [95.15655361 -1.55700719 -0.91917324]
mat_Sqrt:  [[ 7.99921201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01369833  0.04580729 -0.11540636]
Stock Position:  0.013698329770677415
Bond Position:  [-5.24573483]


portfolio before change:  [-3.93941098]
curr_Stock_Price:  95.55525334860398
curr_Factors:  [95.55525335 -1.74754326 -0.97538548]
mat_Sqrt:  [[ 6.27627037  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0198227  -0.04142174  0.27729729]
Stock Position:  0.019822696149236207
Bond Position:  [-5.83357373]


portfolio before change:  [-3.94121817]
curr_Stock_Price:  95.61126650397813
curr_Factors:  [95.6112665  -1.66104142 -1.01363497]
mat_Sqrt:  [[ 6.59040151  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01919526 0.01465871 0.05588709]
Stock Position:  0.01919526308528015
Bond Position:  [-5.77650158]


portfolio before change:  [-3.94653403]
curr_Stock_Price:  95.4848345448604
curr_Factors:  [95.48483454 -1.30294558 -1.05516154]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.94653403]
Stock Price:  94.67017340558517
PL:  [-3.94653403]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-2.77780297e-02  8.47279146e-03 -2.68271901e-02]
 [ 8.23310173e-03  8.51518370e-02  4.22462873e-02]
 [-1.10992726e-01  5.45168028e-02 -7.07887224e-02]
 [ 3.89692922e-02 -6.00697611e-02 -4.18485372e-01]
 [ 6.84915362e-02 -1.18299486e-01 -1.68999207e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 5.62213658e-02 -5.30305134e-02  3.26335399e-02]
 [ 8.85842108e-02  2.05633274e-02  8.70969522e-03]
 [-8.97739694e-02 -6.30720281e-02  2.56796297e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.94471668]
curr_Stock_Price:  99.15294371059346
curr_Factors:  [99.15294371 -0.72692692 -0.96686314]
mat_Sqrt:  [[18.22644366  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0018125   0.00267933 -0.07653051]
Stock Position:  -0.0018124951320337133
Bond Position:  [-3.76500245]


portfolio before change:  [-3.94729738]
curr_Stock_Price:  99.53789835322799
curr_Factors:  [99.53789835 -1.05755108 -0.99117282]
mat_Sqrt:  [[12.83036421  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00148516 0.02692738 0.1205169 ]
Stock Position:  0.0014851643865261904
Bond Position:  [-4.09512752]


portfolio before change:  [-3.94479887]
curr_Stock_Price:  102.5992352855772
curr_Factors:  [102.59923529  -1.72088264  -1.07442807]
mat_Sqrt:  [[ 6.26839148  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01978734  0.01723973 -0.20194052]
Stock Position:  -0.019787340396834805
Bond Position:  [-1.91463288]


portfolio before change:  [-3.92601362]
curr_Stock_Price:  101.60148607268593
curr_Factors:  [101.60148607  -1.34233131  -1.04623663]
mat_Sqrt:  [[ 9.32305362  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00514903 -0.01899573 -1.19382228]
Stock Position:  -0.005149028755670395
Bond Position:  [-3.40286465]


portfolio before change:  [-3.92879967]
curr_Stock_Price:  101.81204893319455
curr_Factors:  [101.81204893  -1.38276733  -1.05456977]
mat_Sqrt:  [[ 8.89768693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00347733 -0.03740958 -0.4821077 ]
Stock Position:  0.0034773349692111366
Bond Position:  [-4.28283427]


portfolio before change:  [-3.93462314]
curr_Stock_Price:  100.75333335876499
curr_Factors:  [100.75333336  -1.17903253  -1.03467547]
mat_Sqrt:  [[11.01179846  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00214797 -0.00193948 -0.30510753]
Stock Position:  0.002147969356777297
Bond Position:  [-4.15103821]


portfolio before change:  [-3.94194438]
curr_Stock_Price:  98.31139506085012
curr_Factors:  [98.31139506 -1.03170861 -1.08061442]
mat_Sqrt:  [[11.8914174   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00517293 -0.01676972  0.09309441]
Stock Position:  0.005172925580711216
Bond Position:  [-4.45050191]


portfolio before change:  [-3.94426312]
curr_Stock_Price:  98.29343001232259
curr_Factors:  [98.29343001 -1.01888935 -1.07531677]
mat_Sqrt:  [[12.1066038   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00750772 0.0065027  0.02484634]
Stock Position:  0.007507721747948624
Bond Position:  [-4.68222284]


portfolio before change:  [-3.93497187]
curr_Stock_Price:  99.8428945110463
curr_Factors:  [99.84289451 -1.33152106 -1.04977648]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.93497187]
Stock Price:  100.88951789900716
PL:  [-4.82448977]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-1.80498486e-01  6.64520891e-02 -3.93692140e-03]
 [-1.32001188e-01  9.31086399e-02 -8.63785165e-02]
 [ 1.92878060e-01  1.29032237e-02 -9.41450496e-02]
 [ 6.14217308e-02 -1.22893554e-01 -1.53507584e-01]
 [-6.49121833e-02 -2.15279856e-02  5.29495651e-02]
 [ 1.25493660e-01 -1.54819063e-02 -3.63826082e-01]
 [ 4.48591351e-01  2.94637190e-01 -3.33821760e-01]
 [-9.05419782e-02 -7.97260350e-02  2.60216568e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.64786461]
curr_Stock_Price:  100.48945968765261
curr_Factors:  [100.48945969  -0.96553107  -0.97785182]
mat_Sqrt:  [[14.39196348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00428937  0.01250945 -0.27262553]
Stock Position:  -0.004289373243537204
Bond Position:  [6.07890141]


portfolio before change:  [5.65028895]
curr_Stock_Price:  100.633038810469
curr_Factors:  [100.63303881  -0.94818057  -0.997974  ]
mat_Sqrt:  [[14.37263499  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01249502  0.021014   -0.01123094]
Stock Position:  -0.012495017152462684
Bond Position:  [6.9077005]


portfolio before change:  [5.60811334]
curr_Stock_Price:  104.28492039948699
curr_Factors:  [104.2849204   -0.92180007  -1.02189304]
mat_Sqrt:  [[14.93091144  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00986069  0.02944354 -0.24641386]
Stock Position:  -0.009860688992631478
Bond Position:  [6.63643451]


portfolio before change:  [5.62012064]
curr_Stock_Price:  103.4038204877091
curr_Factors:  [103.40382049  -0.59463568  -1.03593181]
mat_Sqrt:  [[20.24837246  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00859298  0.00408036 -0.26856962]
Stock Position:  0.008592984072290732
Bond Position:  [4.73157326]


portfolio before change:  [5.64234776]
curr_Stock_Price:  105.71509485129022
curr_Factors:  [105.71509485  -1.03063042  -1.0273176 ]
mat_Sqrt:  [[13.50148489  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00199341 -0.03886235 -0.43791441]
Stock Position:  0.0019934124759369335
Bond Position:  [5.43161398]


portfolio before change:  [5.64606808]
curr_Stock_Price:  106.21867058934802
curr_Factors:  [106.21867059  -0.43744798  -1.01191116]
mat_Sqrt:  [[24.93171676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00219238 -0.00680775  0.15105037]
Stock Position:  -0.002192378060162442
Bond Position:  [5.87893957]


portfolio before change:  [5.6445814]
curr_Stock_Price:  108.23788813104875
curr_Factors:  [108.23788813  -0.45456353  -1.04647935]
mat_Sqrt:  [[24.12596387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210679 -0.00489581 -1.03789454]
Stock Position:  0.0021067855088051897
Bond Position:  [5.41654739]


portfolio before change:  [5.64970625]
curr_Stock_Price:  109.38460858270035
curr_Factors:  [109.38460858  -0.11774761  -1.04816179]
mat_Sqrt:  [[34.08852437  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01138382  0.09317246 -0.95230056]
Stock Position:  0.011383824218908703
Bond Position:  [4.40449109]


portfolio before change:  [5.56826979]
curr_Stock_Price:  102.0374065053809
curr_Factors:  [ 1.02037407e+02  5.80447589e-02 -9.95839765e-01]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.56826979]
Stock Price:  102.15109661917187
PL:  [3.41717317]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.34151834e-02  3.94253120e-02 -9.51730907e-02]
 [-3.43453582e-01 -7.05281218e-02 -2.03931186e-01]
 [-1.17485365e-01  6.64435610e-02 -7.56067284e-02]
 [ 2.11636585e-01 -3.03769639e-02 -3.07540915e-01]
 [ 6.44433051e-02 -1.26801074e-01 -1.59174439e-01]
 [-5.11898005e-02 -2.29417894e-02  7.58006417e-03]
 [ 8.29118826e-02  5.03360343e-02 -2.31960766e-01]
 [ 3.25268753e-01  1.87423539e-01 -1.85333064e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.22847278]
curr_Stock_Price:  99.87371428947817
curr_Factors:  [99.87371429 -1.0603061  -0.95302665]
mat_Sqrt:  [[13.33742208  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0046354   0.01246738 -0.27150234]
Stock Position:  -0.004635404925275181
Bond Position:  [1.69142789]


portfolio before change:  [1.21813591]
curr_Stock_Price:  102.28618945472898
curr_Factors:  [102.28618945  -1.35600161  -0.95510167]
mat_Sqrt:  [[10.14185968  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03814901 -0.02230295 -0.58175891]
Stock Position:  -0.038149008275464594
Bond Position:  [5.12025259]


portfolio before change:  [1.20054378]
curr_Stock_Price:  102.81445711937687
curr_Factors:  [102.81445712  -1.28329473  -0.95602381]
mat_Sqrt:  [[10.95293476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01197879  0.0210113  -0.21568495]
Stock Position:  -0.011978794811721233
Bond Position:  [2.43213707]


portfolio before change:  [1.18207629]
curr_Stock_Price:  104.45768288397176
curr_Factors:  [104.45768288  -1.47859321  -0.96242574]
mat_Sqrt:  [[ 9.09534812  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01628038 -0.00960604 -0.87732863]
Stock Position:  0.01628038050588096
Bond Position:  [-0.51853453]


portfolio before change:  [1.19146862]
curr_Stock_Price:  105.05052294200496
curr_Factors:  [105.05052294  -1.81691485  -0.99085495]
mat_Sqrt:  [[ 6.33868672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00452428 -0.04009802 -0.45408037]
Stock Position:  0.004524276156967962
Bond Position:  [0.71619105]


portfolio before change:  [1.19414449]
curr_Stock_Price:  105.56280006806513
curr_Factors:  [105.56280007  -1.41643286  -1.02217482]
mat_Sqrt:  [[ 9.2137632   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00545216 -0.00725483  0.02162381]
Stock Position:  -0.005452156712370678
Bond Position:  [1.76968942]


portfolio before change:  [1.19396605]
curr_Stock_Price:  105.75786186310494
curr_Factors:  [105.75786186  -1.30029878  -0.97898918]
mat_Sqrt:  [[10.82506423  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00340532  0.01591765 -0.6617195 ]
Stock Position:  0.003405315615095107
Bond Position:  [0.83382715]


portfolio before change:  [1.20129755]
curr_Stock_Price:  107.78835967031061
curr_Factors:  [107.78835967  -1.10557772  -0.96419797]
mat_Sqrt:  [[13.6044097   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02148399  0.05926853 -0.52870364]
Stock Position:  0.021483993911812434
Bond Position:  [-1.11442691]


portfolio before change:  [1.20278425]
curr_Stock_Price:  107.88350238346275
curr_Factors:  [107.88350238  -1.0155713   -0.96745576]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.20278425]
Stock Price:  106.83777520413574
PL:  [-5.63499096]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-2.54160189e-02  3.87498361e-03 -1.66914251e-02]
 [-1.20677554e-01  7.26272144e-02 -4.54332820e-04]
 [-7.86554565e-02 -4.88567318e-03 -4.67921356e-02]
 [-1.27934454e-01 -6.44253041e-02 -3.18898417e-01]
 [ 6.87194929e-02 -1.16653245e-01 -1.69742182e-01]
 [ 7.96538341e-02  1.33172416e-01 -2.58701840e-03]
 [ 1.16193879e-01 -7.53634089e-02  1.10077364e-01]
 [ 1.47605087e-01  7.64521304e-02  9.62921677e-03]
 [-1.34433068e-01 -1.81791248e-01  9.16777451e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.33637499]
curr_Stock_Price:  99.09837470894793
curr_Factors:  [99.09837471 -0.98344009 -0.9841234 ]
mat_Sqrt:  [[13.85366133  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207332  0.00122538 -0.04761599]
Stock Position:  -0.00207332123246962
Bond Position:  [-4.13091222]


portfolio before change:  [-4.33591117]
curr_Stock_Price:  97.87821198238181
curr_Factors:  [97.87821198 -0.88784605 -0.94274181]
mat_Sqrt:  [[15.69176595  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00757691  0.02296674 -0.00129609]
Stock Position:  -0.007576908031583522
Bond Position:  [-3.59429696]


portfolio before change:  [-4.33147791]
curr_Stock_Price:  97.05586334568326
curr_Factors:  [97.05586335 -0.88039225 -0.92368911]
mat_Sqrt:  [[15.97788148  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00552846 -0.00154499 -0.13348494]
Stock Position:  -0.0055284556228418005
Bond Position:  [-3.79490888]


portfolio before change:  [-4.32238735]
curr_Stock_Price:  95.06824012577474
curr_Factors:  [95.06824013 -0.7881486  -0.96597055]
mat_Sqrt:  [[16.45247302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01183365 -0.02037307 -0.90972842]
Stock Position:  -0.011833648058718841
Bond Position:  [-3.19738326]


portfolio before change:  [-4.36967041]
curr_Stock_Price:  98.92875421271928
curr_Factors:  [98.92875421 -0.78160017 -0.95028248]
mat_Sqrt:  [[17.50553798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00177424 -0.036889   -0.4842272 ]
Stock Position:  0.001774240886745535
Bond Position:  [-4.54519385]


portfolio before change:  [-4.37378505]
curr_Stock_Price:  97.89085956981401
curr_Factors:  [97.89085957 -0.99606856 -0.99712503]
mat_Sqrt:  [[13.33856668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00618989  0.04211282 -0.00738004]
Stock Position:  0.006189889818994688
Bond Position:  [-4.97971868]


portfolio before change:  [-4.37702467]
curr_Stock_Price:  97.76983366465363
curr_Factors:  [97.76983366 -0.60214637 -0.92546249]
mat_Sqrt:  [[21.22133889  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00644245 -0.023832    0.31402008]
Stock Position:  0.006442451774397757
Bond Position:  [-5.00690211]


portfolio before change:  [-4.40449581]
curr_Stock_Price:  93.89443592691278
curr_Factors:  [93.89443593 -1.36775407 -0.92829989]
mat_Sqrt:  [[ 9.45096798  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01603483 0.02417629 0.02746948]
Stock Position:  0.01603482609923216
Bond Position:  [-5.91007676]


portfolio before change:  [-4.43202276]
curr_Stock_Price:  92.36207302564112
curr_Factors:  [92.36207303 -0.9214069  -0.91223782]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.43202276]
Stock Price:  93.22325588420973
PL:  [-4.43202276]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 4.14698731e-02 -8.55063607e-02  1.71469359e-01]
 [-2.56460136e-01  5.42129911e-02 -6.87488426e-02]
 [-1.00303061e-01  3.48802476e-02 -6.28562197e-02]
 [-5.35435097e-02 -1.21819289e-01 -6.41577866e-01]
 [ 7.12248220e-02 -9.85604551e-02 -1.77907755e-01]
 [ 7.96538341e-02  1.33172416e-01 -2.58701840e-03]
 [ 3.93861253e-02 -1.95115449e-02  1.19296941e-02]
 [ 9.14492706e-02  2.18254111e-02  8.85361702e-03]
 [-8.52958772e-02 -5.79146040e-02  3.22066012e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.70197532]
curr_Stock_Price:  98.35079589244314
curr_Factors:  [98.35079589 -0.56598216 -0.97852292]
mat_Sqrt:  [[20.98977813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00353806 -0.02703949  0.48915435]
Stock Position:  0.0035380623952674137
Bond Position:  [-10.04994657]


portfolio before change:  [-9.71514419]
curr_Stock_Price:  96.04935603174938
curr_Factors:  [96.04935603 -0.54215401 -0.96869348]
mat_Sqrt:  [[21.20028647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01269293  0.01714365 -0.19612131]
Stock Position:  -0.012692925699392616
Bond Position:  [-8.49599685]


portfolio before change:  [-9.74832468]
curr_Stock_Price:  98.32869113433598
curr_Factors:  [98.32869113 -1.56328499 -0.98612509]
mat_Sqrt:  [[ 7.68219856  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01460948  0.0110301  -0.1793113 ]
Stock Position:  -0.014609480367404368
Bond Position:  [-8.31179359]


portfolio before change:  [-9.74983501]
curr_Stock_Price:  98.14753482011389
curr_Factors:  [98.14753482 -1.61551016 -1.04612629]
mat_Sqrt:  [[ 6.8540201   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02737815 -0.03852264 -1.83024307]
Stock Position:  -0.027378151956911453
Bond Position:  [-7.06273689]


portfolio before change:  [-9.74645443]
curr_Stock_Price:  97.89504027021182
curr_Factors:  [97.89504027 -1.70241362 -1.07102294]
mat_Sqrt:  [[ 6.11325482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00529419 -0.03116755 -0.5075213 ]
Stock Position:  0.0052941901805081525
Bond Position:  [-10.26472939]


portfolio before change:  [-9.74968303]
curr_Stock_Price:  98.2548770763293
curr_Factors:  [98.25487708 -1.68866202 -1.04894921]
mat_Sqrt:  [[ 6.3595248   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01298277  0.04211282 -0.00738004]
Stock Position:  0.012982771627776018
Bond Position:  [-11.02530366]


portfolio before change:  [-9.75385144]
curr_Stock_Price:  98.35852424732303
curr_Factors:  [98.35852425 -1.3328427  -1.00162442]
mat_Sqrt:  [[ 9.52721172  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00433679 -0.00617009  0.0340321 ]
Stock Position:  0.004336785955542939
Bond Position:  [-10.1804113]


portfolio before change:  [-9.75890319]
curr_Stock_Price:  98.36768347758138
curr_Factors:  [98.36768348 -1.50663785 -1.04906271]
mat_Sqrt:  [[ 7.63705279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01228485 0.0069018  0.0252569 ]
Stock Position:  0.012284848609614372
Bond Position:  [-10.96733529]


portfolio before change:  [-9.74495588]
curr_Stock_Price:  99.94949767637188
curr_Factors:  [99.94949768 -1.48484759 -1.0606509 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.74495588]
Stock Price:  99.53286613622976
PL:  [-9.74495588]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-8.47713509e-03  3.02074926e-02 -8.74048903e-02]
 [ 7.81539030e-03  1.00624095e-01  4.99993904e-02]
 [-1.00228857e-01  3.47439369e-02 -6.28011548e-02]
 [-5.61782474e-02 -1.31361959e-01 -6.90160831e-01]
 [ 6.91713019e-02 -1.13390407e-01 -1.71214755e-01]
 [ 5.82259002e-02  4.54051362e-02 -6.83412336e-02]
 [ 3.76337075e-02  1.45039252e-02  1.09350123e-02]
 [ 8.69773338e-02  1.98554841e-02  8.62897626e-03]
 [-1.11068709e-01 -1.25398491e-01  6.38830849e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.86331601]
curr_Stock_Price:  101.21611854240624
curr_Factors:  [101.21611854  -1.11667399  -1.04454993]
mat_Sqrt:  [[11.65848332  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00219056  0.00955245 -0.24934182]
Stock Position:  -0.0021905619118625214
Bond Position:  [11.08503619]


portfolio before change:  [10.87151002]
curr_Stock_Price:  100.0063366452819
curr_Factors:  [100.00633665  -1.45506452  -1.06755735]
mat_Sqrt:  [[ 8.02540136  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00256929 0.03182013 0.14263434]
Stock Position:  0.002569289078162527
Bond Position:  [10.61456483]


portfolio before change:  [10.87677113]
curr_Stock_Price:  99.98785123446379
curr_Factors:  [99.98785123 -1.52660346 -1.10151936]
mat_Sqrt:  [[ 7.22051204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01553228  0.010987   -0.17915421]
Stock Position:  -0.01553227855071741
Bond Position:  [12.42981029]


portfolio before change:  [10.9065182]
curr_Stock_Price:  98.47290219359971
curr_Factors:  [98.47290219 -1.78739649 -1.0966724 ]
mat_Sqrt:  [[ 5.50530687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03641005 -0.0415403  -1.96883675]
Stock Position:  -0.0364100481844044
Bond Position:  [14.49192132]


portfolio before change:  [10.87772725]
curr_Stock_Price:  99.46270385584907
curr_Factors:  [99.46270386 -1.46155794 -1.09392488]
mat_Sqrt:  [[ 7.72374938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00405173 -0.03585719 -0.48842804]
Stock Position:  0.0040517250325991455
Bond Position:  [10.47473172]


portfolio before change:  [10.88234538]
curr_Stock_Price:  99.30954844852212
curr_Factors:  [99.30954845 -1.40576736 -1.10820301]
mat_Sqrt:  [[ 8.03873194  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00565365  0.01435836 -0.19495852]
Stock Position:  0.0056536478879739005
Bond Position:  [10.32088416]


portfolio before change:  [10.88622525]
curr_Stock_Price:  99.08281698024835
curr_Factors:  [99.08281698 -1.09518443 -1.08334975]
mat_Sqrt:  [[11.2169032   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00358747 0.00458654 0.03119455]
Stock Position:  0.0035874694277786045
Bond Position:  [10.53076868]


portfolio before change:  [10.89065562]
curr_Stock_Price:  98.8496911943085
curr_Factors:  [98.84969119 -1.33973872 -1.09562576]
mat_Sqrt:  [[ 8.65585479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0103111  0.00627886 0.02461607]
Stock Position:  0.010311099809995852
Bond Position:  [9.87140659]


portfolio before change:  [10.89099529]
curr_Stock_Price:  98.40383459153811
curr_Factors:  [98.40383459 -1.86331496 -1.10667339]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.89099529]
Stock Price:  98.29770650668499
PL:  [10.89099529]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 2.94643953e-02  2.00034656e-02 -7.84982880e-02]
 [-2.43917091e-01  7.41582352e-02 -2.45544107e-02]
 [-6.84826753e-03 -3.36579933e-03 -9.20834324e-02]
 [ 4.33377751e-02 -7.07453256e-04 -7.11177824e-02]
 [ 4.61635496e-02 -1.04583323e-01 -1.54366811e-01]
 [ 5.26137798e-02  2.24182938e-02 -8.55627060e-02]
 [ 2.01067381e-02  1.04673091e-01 -1.14691101e-01]
 [ 9.46773765e-02  2.32474198e-02  9.01577588e-03]
 [-9.72074437e-02 -7.75649915e-02  9.73170054e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.03678089]
curr_Stock_Price:  101.37961515537913
curr_Factors:  [101.37961516  -0.50680019  -0.96620552]
mat_Sqrt:  [[23.23980005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00060059  0.00632565 -0.22393377]
Stock Position:  0.0006005854874903731
Bond Position:  [11.97589376]


portfolio before change:  [12.04219133]
curr_Stock_Price:  100.41555298232487
curr_Factors:  [100.41555298  -0.24534178  -0.94688256]
mat_Sqrt:  [[30.48067164  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00810397  0.02345089 -0.0700469 ]
Stock Position:  -0.008103971082317356
Bond Position:  [12.85595607]


portfolio before change:  [12.07501019]
curr_Stock_Price:  97.15921448384847
curr_Factors:  [97.15921448 -0.39148611 -0.9570395 ]
mat_Sqrt:  [[25.22474379  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102009 -0.00106436 -0.2626884 ]
Stock Position:  -0.00102009456468598
Bond Position:  [12.17412177]


portfolio before change:  [12.07794468]
curr_Stock_Price:  100.25117468256994
curr_Factors:  [100.25117468  -0.2958603   -0.99922188]
mat_Sqrt:  [[27.45632604  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00104904 -0.00022372 -0.20287924]
Stock Position:  0.0010490351893336902
Bond Position:  [11.97277767]


portfolio before change:  [12.08227867]
curr_Stock_Price:  98.67458742986449
curr_Factors:  [98.67458743 -0.41708553 -1.03715979]
mat_Sqrt:  [[23.04807201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00051862 -0.03307215 -0.44036555]
Stock Position:  0.0005186215307117234
Bond Position:  [12.0311039]


portfolio before change:  [12.08867426]
curr_Stock_Price:  99.40447106252104
curr_Factors:  [99.40447106 -0.44187037 -1.04178518]
mat_Sqrt:  [[22.54563651  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00158466  0.00708929 -0.24408658]
Stock Position:  0.0015846615540409366
Bond Position:  [11.93115181]


portfolio before change:  [12.09960383]
curr_Stock_Price:  102.53605592375813
curr_Factors:  [102.53605592  -0.82181105  -1.09658992]
mat_Sqrt:  [[15.05655641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.99717742e-05  3.31005376e-02 -3.27181787e-01]
Stock Position:  -3.9971774173577676e-05
Bond Position:  [12.10370237]


portfolio before change:  [12.10575314]
curr_Stock_Price:  100.13562031859873
curr_Factors:  [100.13562032  -1.00433296  -1.08462631]
mat_Sqrt:  [[12.39838476  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00783311 0.00735148 0.0257195 ]
Stock Position:  0.007833113889197425
Bond Position:  [11.32137942]


portfolio before change:  [12.11023416]
curr_Stock_Price:  99.98483864808512
curr_Factors:  [99.98483865 -0.68443397 -1.04458331]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.11023416]
Stock Price:  100.39005748029038
PL:  [11.72017668]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 1.96095910e-01 -2.30451498e-01  4.94790177e-01]
 [-7.99034963e-02  7.74365023e-02  1.34830203e-02]
 [-8.23150192e-02  1.83682033e-03 -4.95077951e-02]
 [ 4.34876066e-02 -5.28511246e-02 -3.22239584e-01]
 [ 6.87213528e-02 -1.16639814e-01 -1.69748244e-01]
 [ 4.50477516e-02 -8.57161456e-03 -1.08779981e-01]
 [ 1.21956522e-01 -1.01408715e-02  1.20079728e-01]
 [ 2.74260505e-01  1.60170246e-01 -1.72158271e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.57876689]
curr_Stock_Price:  96.83535335620232
curr_Factors:  [96.83535336 -1.10828988 -0.98014011]
mat_Sqrt:  [[11.99610668  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0242699  -0.07287516  1.41149865]
Stock Position:  0.02426989919263692
Bond Position:  [-22.92895116]


portfolio before change:  [-20.56787671]
curr_Stock_Price:  97.75655708280497
curr_Factors:  [97.75655708 -1.23510395 -1.03782048]
mat_Sqrt:  [[10.06995107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00746298  0.02448757  0.0384633 ]
Stock Position:  -0.0074629840654660655
Bond Position:  [-19.83832108]


portfolio before change:  [-20.57532906]
curr_Stock_Price:  97.42568564055819
curr_Factors:  [97.42568564 -0.96600044 -1.04955947]
mat_Sqrt:  [[12.98156116  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00711573  0.00058085 -0.14123196]
Stock Position:  -0.007115733455029682
Bond Position:  [-19.88207385]


portfolio before change:  [-20.58521788]
curr_Stock_Price:  97.41799791328086
curr_Factors:  [97.41799791 -0.60214542 -0.99138904]
mat_Sqrt:  [[19.79593308  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00119489 -0.01671299 -0.91925984]
Stock Position:  -0.0011948859901750979
Bond Position:  [-20.46881448]


portfolio before change:  [-20.59843175]
curr_Stock_Price:  99.9093656252782
curr_Factors:  [99.90936563 -0.62698298 -0.90395684]
mat_Sqrt:  [[21.61361875  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00143706 -0.03688475 -0.48424449]
Stock Position:  0.0014370573888215785
Bond Position:  [-20.74200724]


portfolio before change:  [-20.60679044]
curr_Stock_Price:  101.31147284506103
curr_Factors:  [101.31147285  -0.62205437  -0.89696885]
mat_Sqrt:  [[22.17967739  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00101993 -0.00271058 -0.31031901]
Stock Position:  0.0010199342562491626
Bond Position:  [-20.71012148]


portfolio before change:  [-20.61946773]
curr_Stock_Price:  99.03716315874773
curr_Factors:  [ 9.90371632e+01 -8.54025314e-02 -9.18642150e-01]
mat_Sqrt:  [[36.286671    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00402919 -0.00320683  0.34255404]
Stock Position:  0.004029189048614904
Bond Position:  [-21.01850719]


portfolio before change:  [-20.60962496]
curr_Stock_Price:  104.08896213726271
curr_Factors:  [104.08896214  -0.33811973  -0.95450658]
mat_Sqrt:  [[28.5774981   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0085121   0.05065028 -0.49111963]
Stock Position:  0.008512096564799922
Bond Position:  [-21.49564026]


portfolio before change:  [-20.61403579]
curr_Stock_Price:  104.83374663897644
curr_Factors:  [104.83374664  -0.7070961   -0.9439087 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.61403579]
Stock Price:  106.37769960382796
PL:  [-26.9917354]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-1.54907978e-01  7.77656243e-02  2.27098769e-03]
 [-9.43298872e-02  2.39077283e-02 -5.84236938e-02]
 [ 5.00590602e-02 -3.45232611e-02 -2.80429491e-01]
 [ 6.75458224e-02 -1.25129168e-01 -1.65916860e-01]
 [-4.18801381e-02 -1.88696247e-02  1.91637830e-02]
 [ 7.24624218e-02  4.74550810e-02 -2.33989368e-01]
 [ 3.42672371e-01  2.10929923e-01 -2.36567864e-01]
 [-8.89520525e-02 -8.02415127e-02  9.01544642e-04]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.26778164]
curr_Stock_Price:  100.71515962556032
curr_Factors:  [100.71515963  -1.04003398  -1.00705777]
mat_Sqrt:  [[13.00331831  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00474744  0.01250945 -0.27262553]
Stock Position:  -0.004747442277365355
Bond Position:  [7.74592105]


portfolio before change:  [7.27299529]
curr_Stock_Price:  100.43296143574716
curr_Factors:  [100.43296144  -0.83745009  -0.95104987]
mat_Sqrt:  [[16.79347636  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00907713  0.02459165  0.0064785 ]
Stock Position:  -0.00907712680461716
Bond Position:  [8.18463802]


portfolio before change:  [7.28215894]
curr_Stock_Price:  99.87438089469082
curr_Factors:  [99.87438089 -1.18114525 -0.98808015]
mat_Sqrt:  [[11.41225537  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00925656  0.00756029 -0.16666654]
Stock Position:  -0.009256564577431643
Bond Position:  [8.2066526]


portfolio before change:  [7.27277276]
curr_Stock_Price:  101.33178211848886
curr_Factors:  [101.33178212  -0.91522988  -1.00103145]
mat_Sqrt:  [[14.91159013  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.41508762e-04 -1.09172137e-02 -7.99987281e-01]
Stock Position:  -0.0005415087622871499
Bond Position:  [7.32764481]


portfolio before change:  [7.27526739]
curr_Stock_Price:  103.49262493661092
curr_Factors:  [103.49262494  -1.0145169   -1.00693996]
mat_Sqrt:  [[13.70887582  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.002221   -0.03956932 -0.47331462]
Stock Position:  0.0022209964110320207
Bond Position:  [7.04541064]


portfolio before change:  [7.28397587]
curr_Stock_Price:  105.82711412933244
curr_Factors:  [105.82711413  -0.87685507  -1.08315953]
mat_Sqrt:  [[14.90642253  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0025798  -0.0059671   0.05466894]
Stock Position:  -0.0025797979939094617
Bond Position:  [7.55698844]


portfolio before change:  [7.28839196]
curr_Stock_Price:  105.58032832436008
curr_Factors:  [105.58032832  -0.74663618  -1.07941948]
mat_Sqrt:  [[17.00345238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00152468  0.01500661 -0.66750654]
Stock Position:  0.0015246801852860418
Bond Position:  [7.12741573]


portfolio before change:  [7.29278064]
curr_Stock_Price:  106.12082219527566
curr_Factors:  [106.1208222   -0.24002052  -1.05362679]
mat_Sqrt:  [[29.10561066  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01030143  0.0667019  -0.67486227]
Stock Position:  0.01030142775023141
Bond Position:  [6.19958466]


portfolio before change:  [7.26634997]
curr_Stock_Price:  103.25410869397928
curr_Factors:  [103.25410869  -0.15260033  -1.04068412]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.26634997]
Stock Price:  101.11214148122119
PL:  [6.15420849]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.52364363e-02  3.79895674e-02 -9.09245693e-02]
 [-6.06396310e-02  7.55543279e-02  1.79544421e-02]
 [-9.94405439e-02  3.32958327e-02 -6.22161698e-02]
 [-3.18194524e-02 -4.75410801e-02 -2.64049856e-01]
 [ 3.56971932e-03 -7.70887868e-02 -1.26895052e-01]
 [ 7.80685451e-02  1.26679186e-01 -7.45166989e-03]
 [ 1.71193430e-01 -1.87252210e-01  1.81756794e-01]
 [ 1.27296689e-01  5.27445846e-02  2.29380567e-02]
 [-1.21730447e-01 -1.38413934e-01  1.20727175e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.15978947]
curr_Stock_Price:  99.72481669025787
curr_Factors:  [99.72481669 -1.04356861 -0.94004082]
mat_Sqrt:  [[13.71932096  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00457861  0.01201336 -0.25938249]
Stock Position:  -0.004578612169255812
Bond Position:  [0.61639072]


portfolio before change:  [0.16531933]
curr_Stock_Price:  98.5843851776332
curr_Factors:  [98.58438518 -0.80344723 -1.00166623]
mat_Sqrt:  [[16.21277344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00339386  0.02389238  0.05121903]
Stock Position:  -0.0033938605107642185
Bond Position:  [0.49990098]


portfolio before change:  [0.15917637]
curr_Stock_Price:  100.4680734282773
curr_Factors:  [100.46807343  -1.11841013  -1.04436686]
mat_Sqrt:  [[11.55436173  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00963105  0.01052907 -0.17748541]
Stock Position:  -0.009631053123057433
Bond Position:  [1.12678972]


portfolio before change:  [0.1717881]
curr_Stock_Price:  99.21709972141917
curr_Factors:  [99.21709972 -0.73874897 -1.01522968]
mat_Sqrt:  [[17.17288561  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00506298 -0.01503381 -0.75326074]
Stock Position:  -0.005062976074489319
Bond Position:  [0.6741219]


portfolio before change:  [0.18140721]
curr_Stock_Price:  97.38379692029082
curr_Factors:  [97.38379692 -0.67746529 -1.00887663]
mat_Sqrt:  [[18.03506491  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00134865 -0.02437761 -0.36199626]
Stock Position:  -0.001348653231178287
Bond Position:  [0.31274418]


portfolio before change:  [0.1805055]
curr_Stock_Price:  98.16837279418317
curr_Factors:  [98.16837279 -0.7771231  -0.97057886]
mat_Sqrt:  [[17.09835279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00466819  0.04005948 -0.02125754]
Stock Position:  0.004668187800040875
Bond Position:  [-0.2777629]


portfolio before change:  [0.16299816]
curr_Stock_Price:  94.44777924910754
curr_Factors:  [94.44777925 -0.89218875 -0.98344703]
mat_Sqrt:  [[14.47483028  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01405609 -0.05921435  0.51850154]
Stock Position:  0.014056092229495646
Bond Position:  [-1.16456854]


portfolio before change:  [0.17189743]
curr_Stock_Price:  95.12234097250939
curr_Factors:  [95.12234097 -0.98481719 -1.02513534]
mat_Sqrt:  [[12.74592137  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01046145 0.0166793  0.06543589]
Stock Position:  0.010461445322596127
Bond Position:  [-0.82321974]


portfolio before change:  [0.1759362]
curr_Stock_Price:  95.54775901775773
curr_Factors:  [95.54775902 -0.77584747 -0.98278547]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.1759362]
Stock Price:  97.03314959343508
PL:  [0.1759362]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.81010910e-02  3.01557220e-02 -7.07380653e-02]
 [-3.53968855e-02  8.85663269e-02  3.72335064e-02]
 [-1.03214566e-01  4.02285836e-02 -6.50167661e-02]
 [-5.50558888e-02 -1.18394620e-01 -6.27073000e-01]
 [ 6.87214141e-02 -1.16639371e-01 -1.69748444e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 3.38390139e-02  6.31930490e-02  7.83198751e-03]
 [ 8.57624663e-02  1.93203244e-02  8.56794929e-03]
 [-1.00519278e-01 -7.64912452e-02  1.32741149e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.05935757]
curr_Stock_Price:  99.27629909922875
curr_Factors:  [99.2762991  -1.8432155  -0.98156094]
mat_Sqrt:  [[ 5.88926041  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01048719  0.00953608 -0.20179601]
Stock Position:  -0.0104871947282739
Bond Position:  [-2.01822769]


portfolio before change:  [-3.07071231]
curr_Stock_Price:  100.26277564035327
curr_Factors:  [100.26277564  -1.82083102  -1.00522743]
mat_Sqrt:  [[ 5.94015988  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429447  0.02800713  0.10621683]
Stock Position:  -0.004294472818477438
Bond Position:  [-2.64013655]


portfolio before change:  [-3.06825144]
curr_Stock_Price:  99.38227805772588
curr_Factors:  [99.38227806 -1.69832409 -1.06460849]
mat_Sqrt:  [[ 6.27166094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01840778  0.0127214  -0.18547474]
Stock Position:  -0.018407780813296346
Bond Position:  [-1.23884425]


portfolio before change:  [-3.07174249]
curr_Stock_Price:  99.53827053912534
curr_Factors:  [99.53827054 -1.76059807 -1.08628117]
mat_Sqrt:  [[ 5.77572022  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03222344 -0.03743967 -1.78886473]
Stock Position:  -0.032223438438707994
Bond Position:  [0.13572284]


portfolio before change:  [-3.09272216]
curr_Stock_Price:  100.19144579015519
curr_Factors:  [100.19144579  -1.4233377   -1.12766522]
mat_Sqrt:  [[ 7.81527297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00397427 -0.03688461 -0.48424506]
Stock Position:  0.0039742748079545955
Bond Position:  [-3.4909105]


portfolio before change:  [-3.08854676]
curr_Stock_Price:  101.68135246099567
curr_Factors:  [101.68135246  -1.15116359  -1.08486588]
mat_Sqrt:  [[10.86791054  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00217641 -0.00193948 -0.30510753]
Stock Position:  0.002176407834648582
Bond Position:  [-3.30984685]


portfolio before change:  [-3.09395505]
curr_Stock_Price:  99.95697417621307
curr_Factors:  [99.95697418 -0.87662023 -1.1495073 ]
mat_Sqrt:  [[13.17883717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00281279 0.0199834  0.02234248]
Stock Position:  0.0028127936211291404
Bond Position:  [-3.37511338]


portfolio before change:  [-3.09981037]
curr_Stock_Price:  98.47540430888122
curr_Factors:  [98.47540431 -0.58630524 -1.14226643]
mat_Sqrt:  [[17.48310785  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00503402 0.00610962 0.02444197]
Stock Position:  0.00503401574779107
Bond Position:  [-3.59553711]


portfolio before change:  [-3.10341191]
curr_Stock_Price:  98.11717842244377
curr_Factors:  [98.11717842 -0.28986107 -1.15521896]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.10341191]
Stock Price:  94.89777980945507
PL:  [-3.10341191]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-1.87633852e-02  3.29738853e-02 -8.98195409e-02]
 [-3.41621191e-01 -6.40750126e-02 -1.93001941e-01]
 [-1.39789030e-01  1.07414643e-01 -9.21576570e-02]
 [ 3.13802734e-01  8.87374695e-03 -1.73308252e-01]
 [ 5.99824409e-02 -1.21032255e-01 -1.50808248e-01]
 [-5.59626011e-02 -2.52990232e-02  1.61783163e-02]
 [ 7.63990139e-02  4.96139474e-02 -2.31285474e-01]
 [ 1.33909184e-01  5.42075516e-02 -3.40109277e-02]
 [-1.08618286e-01 -9.63571851e-02  1.41271719e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.52684885]
curr_Stock_Price:  101.16923921708589
curr_Factors:  [101.16923922  -1.18958137  -1.01100988]
mat_Sqrt:  [[11.2032453   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00323534  0.01042726 -0.25623015]
Stock Position:  -0.0032353428982557983
Bond Position:  [10.85416603]


portfolio before change:  [10.52908842]
curr_Stock_Price:  102.15487636753416
curr_Factors:  [102.15487637  -0.69884643  -1.03583429]
mat_Sqrt:  [[18.02589501  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02122901 -0.0202623  -0.55058082]
Stock Position:  -0.0212290128596998
Bond Position:  [12.6977356]


portfolio before change:  [10.46637997]
curr_Stock_Price:  105.40791988557959
curr_Factors:  [105.40791989  -0.98596705  -1.03498464]
mat_Sqrt:  [[13.96963557  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01115471  0.03396749 -0.26290014]
Stock Position:  -0.011154707507543243
Bond Position:  [11.64217448]


portfolio before change:  [10.45143132]
curr_Stock_Price:  107.27002067958655
curr_Factors:  [107.27002068  -0.74145659  -0.99183756]
mat_Sqrt:  [[18.95475949  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01470108  0.00280613 -0.4944002 ]
Stock Position:  0.014701081006633615
Bond Position:  [8.87444606]


portfolio before change:  [10.43786226]
curr_Stock_Price:  106.04511822798963
curr_Factors:  [106.04511823  -0.8506219   -0.94404464]
mat_Sqrt:  [[17.6228808   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147954 -0.03827376 -0.43021395]
Stock Position:  0.0014795422558674916
Bond Position:  [10.28096403]


portfolio before change:  [10.44186034]
curr_Stock_Price:  105.27211194884477
curr_Factors:  [105.27211195  -0.65984767  -0.86069901]
mat_Sqrt:  [[23.01167874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0023168  -0.00800025  0.04615223]
Stock Position:  -0.002316798990749312
Bond Position:  [10.68575466]


portfolio before change:  [10.45115339]
curr_Stock_Price:  103.56767566509365
curr_Factors:  [103.56767567  -0.93435227  -0.85889451]
mat_Sqrt:  [[17.23562549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017678   0.01568931 -0.65979308]
Stock Position:  0.0017677972263974474
Bond Position:  [10.26806674]


portfolio before change:  [10.45100734]
curr_Stock_Price:  100.58013498735006
curr_Factors:  [100.58013499  -0.60793745  -0.79468293]
mat_Sqrt:  [[24.73784832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00518907  0.01714193 -0.09702371]
Stock Position:  0.005189067521834784
Bond Position:  [9.92909022]


portfolio before change:  [10.43783913]
curr_Stock_Price:  97.08548048040214
curr_Factors:  [97.08548048 -0.51156221 -0.79949794]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.43783913]
Stock Price:  97.9121223070636
PL:  [10.43783913]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-3.44099198e-01 -5.17104356e-02 -1.70212348e-01]
 [-1.33589986e-01  9.60272089e-02 -8.75575195e-02]
 [ 6.22796005e-02  2.94068055e-03 -8.42936279e-02]
 [ 6.60771509e-02 -1.28913975e-01 -1.62238658e-01]
 [-6.10021487e-02 -2.44226183e-02  2.40360146e-02]
 [ 1.40437163e-01 -1.62985413e-02 -3.69844521e-01]
 [ 3.25827351e-01  1.87862886e-01 -1.85940840e-01]
 [-8.34168244e-02 -8.32599277e-02 -7.66968942e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.33479615]
curr_Stock_Price:  99.88852812097863
curr_Factors:  [99.88852812 -0.27776891 -0.99012114]
mat_Sqrt:  [[28.1111076   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00219602  0.01250945 -0.27262553]
Stock Position:  -0.00219601817009668
Bond Position:  [1.55415317]


portfolio before change:  [1.33085127]
curr_Stock_Price:  102.03884991203597
curr_Factors:  [102.03884991  -0.44011695  -1.04704818]
mat_Sqrt:  [[23.06205187  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01648504 -0.01635228 -0.48556845]
Stock Position:  -0.01648503819420075
Bond Position:  [3.01296561]


portfolio before change:  [1.29767124]
curr_Stock_Price:  104.14299380029037
curr_Factors:  [104.1429938   -0.65144867  -1.04063643]
mat_Sqrt:  [[19.17638924  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00776909  0.03036647 -0.24977723]
Stock Position:  -0.007769094398346991
Bond Position:  [2.10676799]


portfolio before change:  [1.32464803]
curr_Stock_Price:  100.80629395830033
curr_Factors:  [100.80629396  -0.33905066  -1.04458481]
mat_Sqrt:  [[25.26867101  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00178676  0.00092992 -0.24046626]
Stock Position:  0.0017867644812009417
Bond Position:  [1.14453092]


portfolio before change:  [1.33233293]
curr_Stock_Price:  104.78695113467528
curr_Factors:  [104.78695113  -0.99742494  -1.05325523]
mat_Sqrt:  [[13.48056592  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00219811 -0.04076618 -0.46282173]
Stock Position:  0.002198110908312204
Bond Position:  [1.10199959]


portfolio before change:  [1.33477167]
curr_Stock_Price:  105.64569060940157
curr_Factors:  [105.64569061  -0.98633228  -0.95024389]
mat_Sqrt:  [[15.23377174  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00372373 -0.00772311  0.06856806]
Stock Position:  -0.0037237269922636863
Bond Position:  [1.72816738]


portfolio before change:  [1.32294077]
curr_Stock_Price:  109.0549640234523
curr_Factors:  [109.05496402  -1.06291469  -0.97187622]
mat_Sqrt:  [[14.25433547  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00452649 -0.00515405 -1.05506347]
Stock Position:  0.004526492270866155
Bond Position:  [0.82930432]


portfolio before change:  [1.32630884]
curr_Stock_Price:  109.70741576736171
curr_Factors:  [109.70741577  -1.5617425   -0.98269991]
mat_Sqrt:  [[ 8.61387736  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03398271  0.05940746 -0.53043746]
Stock Position:  0.0339827145025966
Bond Position:  [-2.40184695]


portfolio before change:  [1.32523342]
curr_Stock_Price:  109.71111771566603
curr_Factors:  [109.71111772  -1.2331178   -1.03355321]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.32523342]
Stock Price:  110.53747101604911
PL:  [-9.21223759]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 9.81324433e-03  2.52884626e-02 -8.31113066e-02]
 [-7.09370394e-03  7.76134097e-02  3.40920866e-02]
 [-9.58859921e-02  2.67662407e-02 -5.95784359e-02]
 [ 3.44670538e-02 -6.76334917e-02 -4.60173539e-01]
 [ 6.85928170e-02 -1.17568063e-01 -1.69329310e-01]
 [ 4.32025729e-02  5.56095367e-03 -7.22976839e-02]
 [ 6.51088296e-02  4.57319065e-02 -2.34867258e-01]
 [ 4.11572491e-01  2.55302909e-01 -2.79234921e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.61035658]
curr_Stock_Price:  101.32020227376755
curr_Factors:  [101.32020227  -0.97962239  -0.96726784]
mat_Sqrt:  [[14.46013562  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044943  0.00799691 -0.23709342]
Stock Position:  -0.00044943110951963026
Bond Position:  [11.65589303]


portfolio before change:  [11.61712031]
curr_Stock_Price:  99.24129145843179
curr_Factors:  [99.24129146 -0.76749323 -1.00601864]
mat_Sqrt:  [[16.84480499  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00011097 0.02454352 0.09725523]
Stock Position:  0.00011097093229139936
Bond Position:  [11.60610741]


portfolio before change:  [11.62297299]
curr_Stock_Price:  99.67537981843554
curr_Factors:  [99.67537982 -1.2486952  -1.08038505]
mat_Sqrt:  [[ 9.70691432  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01105977  0.00846423 -0.16996069]
Stock Position:  -0.011059774977628754
Bond Position:  [12.72536026]


portfolio before change:  [11.60802075]
curr_Stock_Price:  101.60277034053746
curr_Factors:  [101.60277034  -1.44974367  -1.09972059]
mat_Sqrt:  [[ 7.93756492  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00771166 -0.02138759 -1.31274702]
Stock Position:  -0.007711655456393106
Bond Position:  [12.39154631]


portfolio before change:  [11.61349565]
curr_Stock_Price:  101.69645031898898
curr_Factors:  [101.69645032  -0.45425994  -1.15373714]
mat_Sqrt:  [[20.36861663  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00152161 -0.03717829 -0.48304939]
Stock Position:  0.0015216066275804453
Bond Position:  [11.45875366]


portfolio before change:  [11.62323391]
curr_Stock_Price:  104.330145494925
curr_Factors:  [104.33014549  -0.60304806  -1.21221417]
mat_Sqrt:  [[16.98444826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00168321  0.00175853 -0.20624517]
Stock Position:  0.0016832135320662925
Bond Position:  [11.44762399]


portfolio before change:  [11.63176103]
curr_Stock_Price:  105.99475055622001
curr_Factors:  [105.99475056  -0.38613247  -1.19502764]
mat_Sqrt:  [[21.80696608  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00084136  0.0144617  -0.67001091]
Stock Position:  0.0008413616048665636
Bond Position:  [11.54258112]


portfolio before change:  [11.64064249]
curr_Stock_Price:  109.68961548878289
curr_Factors:  [109.68961549  -0.67602669  -1.21565855]
mat_Sqrt:  [[16.54310589  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0218318   0.08073387 -0.79657951]
Stock Position:  0.02183180088719353
Bond Position:  [9.24592064]


portfolio before change:  [11.58959951]
curr_Stock_Price:  107.13979884699934
curr_Factors:  [107.13979885  -0.44803489  -1.20861171]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.58959951]
Stock Price:  108.41437539573329
PL:  [3.17522412]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 1.78388803e-01 -2.00483896e-02 -4.35389581e-02]
 [-4.87538217e-01 -2.17698815e-01 -4.21612979e-01]
 [-1.30972240e-01  9.12184962e-02 -8.56149625e-02]
 [ 2.19612606e-01  1.35641104e-02 -1.01326437e-01]
 [ 6.82186882e-02 -1.20269918e-01 -1.68109919e-01]
 [ 3.44244823e-02 -1.09033430e-02 -6.89874172e-02]
 [ 3.76740000e-02  9.64456807e-02 -1.34897002e-01]
 [ 1.86669843e-01  8.88541335e-02 -6.88800686e-02]
 [-7.67557565e-02 -5.52672022e-02  1.64831654e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [24.81133828]
curr_Stock_Price:  103.1594697687988
curr_Factors:  [103.15946977  -0.90319123  -1.04446461]
mat_Sqrt:  [[14.71136314  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01148662 -0.00633986 -0.12420453]
Stock Position:  0.011486617662675279
Bond Position:  [23.6263849]


portfolio before change:  [24.83209503]
curr_Stock_Price:  103.93781868154299
curr_Factors:  [103.93781868  -0.44722517  -1.02592745]
mat_Sqrt:  [[23.82273094  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02431378 -0.06884241 -1.20274447]
Stock Position:  -0.02431377689097102
Bond Position:  [27.35921596]


portfolio before change:  [24.85174516]
curr_Stock_Price:  103.692397706364
curr_Factors:  [103.69239771  -0.57737743  -1.03038178]
mat_Sqrt:  [[20.77332256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00703273  0.02884582 -0.24423566]
Stock Position:  -0.007032725204654089
Bond Position:  [25.5809853]


portfolio before change:  [24.86078473]
curr_Stock_Price:  104.22620547836576
curr_Factors:  [104.22620548  -0.27666767  -0.99917862]
mat_Sqrt:  [[29.09939247  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00684824  0.00428935 -0.28905612]
Stock Position:  0.0068482411631915
Bond Position:  [24.14701854]


portfolio before change:  [24.86023082]
curr_Stock_Price:  102.3818721020404
curr_Factors:  [102.3818721   -0.63670093  -0.97585668]
mat_Sqrt:  [[20.41259386  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00150878 -0.03803269 -0.47957081]
Stock Position:  0.0015087763488954762
Bond Position:  [24.70575947]


portfolio before change:  [24.8753242]
curr_Stock_Price:  104.19619775509538
curr_Factors:  [104.19619776  -0.5181801   -1.07639929]
mat_Sqrt:  [[21.1511915   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094846 -0.00344794 -0.1968019 ]
Stock Position:  0.0009484553926452054
Bond Position:  [24.77649875]


portfolio before change:  [24.88732499]
curr_Stock_Price:  103.78441578330559
curr_Factors:  [103.78441578  -1.25014215  -1.06411859]
mat_Sqrt:  [[10.25797123  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00123109  0.0304988  -0.3848236 ]
Stock Position:  0.0012310895816589882
Bond Position:  [24.75955708]


portfolio before change:  [24.89883728]
curr_Stock_Price:  103.07725113850952
curr_Factors:  [103.07725114  -0.96175018  -1.02170349]
mat_Sqrt:  [[14.18273022  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01233218  0.02809814 -0.19649566]
Stock Position:  0.012332178581282386
Bond Position:  [23.62767021]


portfolio before change:  [24.90331183]
curr_Stock_Price:  102.48187871903498
curr_Factors:  [102.48187872  -1.29546846  -1.06063642]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [24.90331183]
Stock Price:  102.12728265857201
PL:  [22.77602917]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-1.22084941e-02  3.12110074e-02 -8.82808099e-02]
 [-2.25150176e-01  4.48532719e-02 -2.56473371e-02]
 [-9.86472888e-02  3.18386498e-02 -6.16275173e-02]
 [-4.57718653e-02 -9.26373586e-02 -4.96005249e-01]
 [ 6.87211607e-02 -1.16641201e-01 -1.69747618e-01]
 [ 4.56465866e-02 -6.11882942e-03 -1.06942384e-01]
 [ 4.09579665e-02  8.85428544e-02 -1.50174212e-01]
 [ 2.80268910e-01  1.60427397e-01 -1.63995309e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.79364816]
curr_Stock_Price:  101.20641185351612
curr_Factors:  [101.20641185  -1.38678261  -1.01423725]
mat_Sqrt:  [[ 9.17187973  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00320794  0.00986979 -0.25184058]
Stock Position:  -0.0032079437461676216
Bond Position:  [11.11831263]


portfolio before change:  [10.80006728]
curr_Stock_Price:  100.93877031064446
curr_Factors:  [100.93877031  -1.23944897  -1.02304057]
mat_Sqrt:  [[10.50681994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.021817    0.01418385 -0.07316471]
Stock Position:  -0.0218170018354436
Bond Position:  [13.00224862]


portfolio before change:  [10.81567724]
curr_Stock_Price:  100.52133421083288
curr_Factors:  [100.52133421  -1.31886865  -1.05197147]
mat_Sqrt:  [[ 9.38891612  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01175907  0.01006827 -0.17580615]
Stock Position:  -0.01175906583029555
Bond Position:  [11.99771422]


portfolio before change:  [10.83080697]
curr_Stock_Price:  99.74496485570353
curr_Factors:  [99.74496486 -1.43837427 -0.96847876]
mat_Sqrt:  [[ 8.9868603   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01662543 -0.0292945  -1.41496491]
Stock Position:  -0.016625428009306973
Bond Position:  [12.4891097]


portfolio before change:  [10.83395925]
curr_Stock_Price:  99.9310555246499
curr_Factors:  [99.93105552 -1.56407788 -0.98712855]
mat_Sqrt:  [[ 7.79337548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00398542 -0.03688519 -0.48424271]
Stock Position:  0.003985424608014709
Bond Position:  [10.43569156]


portfolio before change:  [10.84515088]
curr_Stock_Price:  101.42963498309804
curr_Factors:  [101.42963498  -1.21695016  -0.98920673]
mat_Sqrt:  [[11.16974096  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00211814 -0.00193494 -0.30507685]
Stock Position:  0.0021181401222797104
Bond Position:  [10.6303087]


portfolio before change:  [10.8539289]
curr_Stock_Price:  103.06386848629388
curr_Factors:  [103.06386849  -1.04156558  -1.00309064]
mat_Sqrt:  [[13.33900778  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094384  0.02799971 -0.42840523]
Stock Position:  0.0009438445997884999
Bond Position:  [10.75665262]


portfolio before change:  [10.86114388]
curr_Stock_Price:  105.00837043592925
curr_Factors:  [105.00837044  -0.62501481  -0.96094768]
mat_Sqrt:  [[21.50052963  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01167114  0.0507316  -0.46783297]
Stock Position:  0.011671141587381598
Bond Position:  [9.63557632]


portfolio before change:  [10.87860804]
curr_Stock_Price:  106.09182680801963
curr_Factors:  [106.09182681  -0.74355951  -0.93334721]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.87860804]
Stock Price:  104.61372118758997
PL:  [6.26488685]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-3.62550321e-01 -9.00338820e-02 -2.32782370e-01]
 [-1.21833545e-01  7.44310219e-02 -7.88333919e-02]
 [ 2.31024419e-01  1.43392744e-02 -9.73043719e-02]
 [ 6.78317061e-02 -1.23064595e-01 -1.66848635e-01]
 [ 4.48302654e-02 -9.46242244e-03 -1.09447364e-01]
 [ 3.97507376e-02  1.23508125e-01 -2.09622893e-02]
 [ 2.22382768e-01  1.24930123e-01 -1.34012702e-01]
 [-8.68117886e-02 -8.09354182e-02 -1.38773072e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.96282818]
curr_Stock_Price:  100.81199912779833
curr_Factors:  [100.81199913  -1.0647832   -1.09190419]
mat_Sqrt:  [[11.66473271  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00529223  0.01250945 -0.27262553]
Stock Position:  -0.005292234687269969
Bond Position:  [8.49634894]


portfolio before change:  [7.95804343]
curr_Stock_Price:  102.51902482764642
curr_Factors:  [102.51902483  -0.94296737  -1.18590302]
mat_Sqrt:  [[12.19685342  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0338113  -0.02847121 -0.66406331]
Stock Position:  -0.03381130146610378
Bond Position:  [11.42434509]


portfolio before change:  [7.95261912]
curr_Stock_Price:  102.84843861087317
curr_Factors:  [102.84843861  -0.79678035  -1.17535665]
mat_Sqrt:  [[14.31230182  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00950256  0.02353716 -0.22488972]
Stock Position:  -0.00950256252787314
Bond Position:  [8.92994284]


portfolio before change:  [7.94578125]
curr_Stock_Price:  104.0380082142654
curr_Factors:  [104.03800821  -0.23783952  -1.20344502]
mat_Sqrt:  [[24.61784915  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00859265  0.00453448 -0.27758229]
Stock Position:  0.008592646924024725
Bond Position:  [7.05181938]


portfolio before change:  [7.9405189]
curr_Stock_Price:  103.01514026328019
curr_Factors:  [103.01514026  -0.37339574  -1.15680866]
mat_Sqrt:  [[22.30189306  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00137192 -0.03891644 -0.47597271]
Stock Position:  0.001371917478879483
Bond Position:  [7.79919063]


portfolio before change:  [7.94394806]
curr_Stock_Price:  102.6715269981878
curr_Factors:  [102.671527    -0.2730635   -1.16755796]
mat_Sqrt:  [[24.31062195  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00091504 -0.00299228 -0.31222287]
Stock Position:  0.0009150361145259015
Bond Position:  [7.84999991]


portfolio before change:  [7.94663991]
curr_Stock_Price:  101.32279508159019
curr_Factors:  [101.32279508  -0.15015404  -1.14873227]
mat_Sqrt:  [[27.64445326  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0013985   0.0390567  -0.05979958]
Stock Position:  0.0013985009541299283
Bond Position:  [7.80493988]


portfolio before change:  [7.95242712]
curr_Stock_Price:  102.66978842260909
curr_Factors:  [102.66978842  -0.26152351  -1.17080206]
mat_Sqrt:  [[24.51272395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00808777  0.03950637 -0.38230094]
Stock Position:  0.008087767889530301
Bond Position:  [7.1220577]


portfolio before change:  [7.96231646]
curr_Stock_Price:  103.4521319669598
curr_Factors:  [103.45213197  -0.69639285  -1.20770927]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.96231646]
Stock Price:  102.3401197555449
PL:  [5.6221967]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 7.80235448e-02 -1.31140731e-01  2.66518251e-01]
 [-1.63975910e-02  7.42925725e-02  2.97807606e-02]
 [-8.16396781e-02  5.96241409e-04 -4.90066433e-02]
 [ 4.88388325e-02 -7.05438613e-02 -4.81015701e-01]
 [ 6.77601721e-02 -1.23581193e-01 -1.66615486e-01]
 [ 1.37679288e-03 -1.75619947e-02 -4.99766750e-02]
 [ 4.66039662e-02  8.13644308e-02 -1.64860645e-01]
 [ 2.03589441e-01  1.03344383e-01 -9.11799981e-02]
 [-9.14366314e-02 -7.94359751e-02  3.55910727e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.77715535]
curr_Stock_Price:  97.92233694878959
curr_Factors:  [97.92233695 -0.60204933 -0.92522909]
mat_Sqrt:  [[21.26146484  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00606921 -0.04147034  0.76030239]
Stock Position:  0.006069210977705644
Bond Position:  [-13.37146667]


portfolio before change:  [-12.77673372]
curr_Stock_Price:  99.09366445889556
curr_Factors:  [99.09366446 -0.78853349 -0.92409478]
mat_Sqrt:  [[17.8756103   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046994  0.02349337  0.08495622]
Stock Position:  -0.00046993599867768736
Bond Position:  [-12.73016604]


portfolio before change:  [-12.78261693]
curr_Stock_Price:  98.06486915400842
curr_Factors:  [98.06486915 -0.89689365 -0.88011724]
mat_Sqrt:  [[16.58698413  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00552407  0.00018855 -0.13980231]
Stock Position:  -0.005524073675559359
Bond Position:  [-12.24089937]


portfolio before change:  [-12.81184061]
curr_Stock_Price:  102.24687356528666
curr_Factors:  [102.24687357  -1.63142675  -0.91383242]
mat_Sqrt:  [[ 8.02154505  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00637901 -0.02230793 -1.37220391]
Stock Position:  -0.006379010598319329
Bond Position:  [-12.15960672]


portfolio before change:  [-12.82331174]
curr_Stock_Price:  103.09180195860752
curr_Factors:  [103.09180196  -1.45047575  -0.97320884]
mat_Sqrt:  [[ 9.13337493  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00334587 -0.0390798  -0.4753076 ]
Stock Position:  0.003345868974465564
Bond Position:  [-13.1682434]


portfolio before change:  [-12.82553538]
curr_Stock_Price:  104.39553687427016
curr_Factors:  [104.39553687  -0.92860728  -0.98543165]
mat_Sqrt:  [[15.39661985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060261 -0.00555359 -0.14256954]
Stock Position:  -0.0006026064183402833
Bond Position:  [-12.76262596]


portfolio before change:  [-12.83069751]
curr_Stock_Price:  102.36970660367716
curr_Factors:  [102.3697066   -0.96069254  -0.91787557]
mat_Sqrt:  [[15.6429873   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00096227  0.02572969 -0.47030153]
Stock Position:  0.0009622681537122046
Bond Position:  [-12.92920462]


portfolio before change:  [-12.83657249]
curr_Stock_Price:  102.98413013701169
curr_Factors:  [102.98413014  -0.77285344  -0.94136362]
mat_Sqrt:  [[18.54792348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01011681  0.03268036 -0.26011116]
Stock Position:  0.010116805944803126
Bond Position:  [-13.87844295]


portfolio before change:  [-12.85355508]
curr_Stock_Price:  101.99156039153382
curr_Factors:  [101.99156039  -0.6662689   -0.91503549]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.85355508]
Stock Price:  99.98228224271992
PL:  [-12.85355508]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 1.37926695e-01 -1.91626255e-01  3.97758986e-01]
 [-8.15381775e-02  7.36401363e-02  1.10911066e-02]
 [-2.96003369e-02 -6.73825831e-03 -7.61503980e-02]
 [ 4.96866729e-02 -7.47219763e-02 -4.39055879e-01]
 [-4.70296091e-03 -3.04624257e-02 -8.12403191e-02]
 [ 9.21712607e-02  1.37418700e-01 -1.63504361e-02]
 [ 1.71447679e-01 -1.41437933e-01  1.81661272e-01]
 [ 7.76352055e-02  1.57401955e-02  8.15968904e-03]
 [-1.39381392e-01 -1.99084530e-01  7.89878886e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.15551398]
curr_Stock_Price:  97.31230862771638
curr_Factors:  [97.31230863 -0.67264951 -0.98351159]
mat_Sqrt:  [[18.57403034  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01153068 -0.06059754  1.13469567]
Stock Position:  0.011530676756098925
Bond Position:  [-18.27759075]


portfolio before change:  [-17.15036002]
curr_Stock_Price:  98.5520479373907
curr_Factors:  [98.55204794 -0.68795833 -0.96534751]
mat_Sqrt:  [[18.86444575  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00410152  0.02328706  0.03163984]
Stock Position:  -0.0041015164564044216
Bond Position:  [-16.74614718]


portfolio before change:  [-17.14700992]
curr_Stock_Price:  95.69328171462128
curr_Factors:  [95.69328171 -0.67727341 -0.95416291]
mat_Sqrt:  [[18.72223349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242057 -0.00213082 -0.21723589]
Stock Position:  -0.002420568726381392
Bond Position:  [-16.91537775]


portfolio before change:  [-17.15820744]
curr_Stock_Price:  96.82430435402007
curr_Factors:  [96.82430435 -0.86104559 -0.95387459]
mat_Sqrt:  [[15.76792576  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00265504 -0.02362916 -1.25250421]
Stock Position:  -0.002655044612174887
Bond Position:  [-16.90113459]


portfolio before change:  [-17.16513311]
curr_Stock_Price:  96.24916961829878
curr_Factors:  [96.24916962 -0.75576521 -0.88892156]
mat_Sqrt:  [[18.5831187   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118778 -0.00963306 -0.23175602]
Stock Position:  -0.0011877773811019962
Bond Position:  [-17.05081052]


portfolio before change:  [-17.17329685]
curr_Stock_Price:  95.94288557210422
curr_Factors:  [95.94288557 -0.63319333 -0.92204727]
mat_Sqrt:  [[20.25724428  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00456044  0.04345561 -0.04664324]
Stock Position:  0.00456043656386445
Bond Position:  [-17.61083829]


portfolio before change:  [-17.18097666]
curr_Stock_Price:  96.19018920971963
curr_Factors:  [ 9.61901892e+01 -9.05238201e-02 -9.20108310e-01]
mat_Sqrt:  [[35.01215333  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0058516  -0.0447266   0.51822904]
Stock Position:  0.005851602935778111
Bond Position:  [-17.74384345]


portfolio before change:  [-17.17425852]
curr_Stock_Price:  98.85480564696546
curr_Factors:  [ 9.88548056e+01 -5.50465984e-02 -9.16654980e-01]
mat_Sqrt:  [[37.41046903  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00213061 0.00497749 0.02327732]
Stock Position:  0.002130612291600148
Bond Position:  [-17.38487978]


portfolio before change:  [-17.2011807]
curr_Stock_Price:  90.29971966662413
curr_Factors:  [ 9.02997197e+01 -4.81356275e-02 -8.74061579e-01]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.2011807]
Stock Price:  89.07285906523177
PL:  [-17.2011807]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 9.91880136e-02 -1.56425620e-01  3.18796796e-01]
 [-2.78007144e-01  2.58311525e-02 -1.25277417e-01]
 [-1.93173487e-02 -3.06197082e-02 -6.14999165e-02]
 [-3.25042016e-01 -6.71269124e-02 -2.37504142e-01]
 [-3.39015552e-02  1.26690362e-01  1.39051785e-01]
 [ 1.67886766e-01  1.63103655e-01 -9.96027015e-02]
 [ 1.51508646e-01 -1.67762057e-01  1.53668949e-01]
 [ 1.04391736e-01  2.83033214e-02  1.01343795e-02]
 [-1.04074916e-01 -8.85251266e-02  1.24984906e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.44869117]
curr_Stock_Price:  97.68944506516154
curr_Factors:  [97.68944507 -0.49905448 -0.99981671]
mat_Sqrt:  [[21.82208061  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00734225 -0.04946612  0.90943852]
Stock Position:  0.007342253371801145
Bond Position:  [-15.16595182]


portfolio before change:  [-14.48707982]
curr_Stock_Price:  93.49403253517616
curr_Factors:  [93.49403254 -0.66426462 -0.9837297 ]
mat_Sqrt:  [[17.99156955  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01683635  0.00816853 -0.3573816 ]
Stock Position:  -0.016836348339158844
Bond Position:  [-12.91298172]


portfolio before change:  [-14.47476363]
curr_Stock_Price:  92.37892779132605
curr_Factors:  [92.37892779 -1.02987154 -1.06650281]
mat_Sqrt:  [[11.35348279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00287679 -0.0096828  -0.17544214]
Stock Position:  -0.002876788090812566
Bond Position:  [-14.20900904]


portfolio before change:  [-14.47797586]
curr_Stock_Price:  91.02531584150938
curr_Factors:  [91.02531584 -0.9824389  -0.97616032]
mat_Sqrt:  [[12.83965522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0292263  -0.02122739 -0.67753321]
Stock Position:  -0.02922629532511945
Bond Position:  [-11.8176431]


portfolio before change:  [-14.54634301]
curr_Stock_Price:  93.16232464923588
curr_Factors:  [93.16232465 -0.98698442 -1.00581709]
mat_Sqrt:  [[12.69923675  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.76908064e-04  4.00630102e-02  3.96676037e-01]
Stock Position:  -0.00017690806437883905
Bond Position:  [-14.52986184]


portfolio before change:  [-14.55345286]
curr_Stock_Price:  92.27545857680143
curr_Factors:  [92.27545858 -0.81732046 -0.99844923]
mat_Sqrt:  [[15.01438173  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01010809  0.0515779  -0.28413878]
Stock Position:  0.010108093077229579
Bond Position:  [-15.48618179]


portfolio before change:  [-14.53283164]
curr_Stock_Price:  95.08174919011475
curr_Factors:  [95.08174919 -0.92884784 -1.03185596]
mat_Sqrt:  [[13.38364226  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01334051 -0.05305102  0.43837474]
Stock Position:  0.013340508364111096
Bond Position:  [-15.80127051]


portfolio before change:  [-14.51218875]
curr_Stock_Price:  97.22151023171071
curr_Factors:  [97.22151023 -1.14657101 -0.99989167]
mat_Sqrt:  [[11.36489593  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00943178 0.0089503  0.02891056]
Stock Position:  0.009431779861908471
Bond Position:  [-15.42916064]


portfolio before change:  [-14.50690633]
curr_Stock_Price:  98.59971592714105
curr_Factors:  [98.59971593 -0.91542257 -1.03731512]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.50690633]
Stock Price:  98.80397125780806
PL:  [-14.50690633]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-2.76466434e-01 -2.10621881e-03 -1.02727596e-01]
 [-1.00485521e-01  3.52154205e-02 -6.29916182e-02]
 [-3.93288038e-02 -7.08514372e-02 -3.82167984e-01]
 [ 6.87217955e-02 -1.16636617e-01 -1.69749687e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 2.68527821e-02  1.10706355e-01 -1.05841023e-01]
 [ 1.68668375e-01  7.56981218e-02 -5.25915545e-02]
 [-8.67462776e-02 -8.09566579e-02 -1.45780281e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.63913374]
curr_Stock_Price:  100.34891514823208
curr_Factors:  [100.34891515  -1.58697578  -1.06142972]
mat_Sqrt:  [[ 7.10108624  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00869339  0.01250945 -0.27262553]
Stock Position:  -0.008693388728538674
Bond Position:  [5.51150587]


portfolio before change:  [4.63112858]
curr_Stock_Price:  101.58682183738195
curr_Factors:  [101.58682184  -1.99532627  -1.0685714 ]
mat_Sqrt:  [[ 4.74464282  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06270019 -0.00066604 -0.29305324]
Stock Position:  -0.06270018846303439
Bond Position:  [11.00064145]


portfolio before change:  [4.67410278]
curr_Stock_Price:  100.98917597802587
curr_Factors:  [100.98917598  -1.74214323  -1.04058225]
mat_Sqrt:  [[ 6.24816523  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01799478  0.01113609 -0.17969755]
Stock Position:  -0.017994782286165127
Bond Position:  [6.49138102]


portfolio before change:  [4.70423462]
curr_Stock_Price:  99.49511320793751
curr_Factors:  [99.49511321 -1.09942319 -0.96892966]
mat_Sqrt:  [[12.57556542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00947615 -0.02240519 -1.09021888]
Stock Position:  -0.009476145934525365
Bond Position:  [5.64706483]


portfolio before change:  [4.70001784]
curr_Stock_Price:  100.23813881220934
curr_Factors:  [100.23813881  -1.78335365  -0.92410196]
mat_Sqrt:  [[ 6.68651717  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0046452  -0.03688374 -0.48424861]
Stock Position:  0.004645204739948103
Bond Position:  [4.23439116]


portfolio before change:  [4.70261404]
curr_Stock_Price:  100.3411442753061
curr_Factors:  [100.34114428  -1.48570895  -0.98500086]
mat_Sqrt:  [[ 8.4813193   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00278884 -0.00193948 -0.30510753]
Stock Position:  0.002788835652808289
Bond Position:  [4.42277908]


portfolio before change:  [4.70947681]
curr_Stock_Price:  102.00880358733563
curr_Factors:  [102.00880359  -1.32917091  -0.95920332]
mat_Sqrt:  [[10.34687857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00078347  0.03500842 -0.30193498]
Stock Position:  0.000783472957711655
Bond Position:  [4.62955568]


portfolio before change:  [4.712094]
curr_Stock_Price:  102.39404842502717
curr_Factors:  [102.39404843  -0.96079577  -0.94856332]
mat_Sqrt:  [[15.17227125  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01053815  0.02393785 -0.15002907]
Stock Position:  0.010538151037768638
Bond Position:  [3.63305005]


portfolio before change:  [4.72381152]
curr_Stock_Price:  103.33354365510479
curr_Factors:  [103.33354366  -0.75512444  -0.98443659]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.72381152]
Stock Price:  103.02626037164943
PL:  [1.69755115]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-8.08025750e-03 -2.27793805e-02  4.05251283e-02]
 [-7.85613952e-03  7.82282838e-02  3.41900087e-02]
 [-8.90968589e-02  1.42948316e-02 -5.45404094e-02]
 [ 5.68102770e-04 -7.55622482e-02 -4.22927086e-01]
 [-5.53010848e-02 -2.85969868e-02 -4.42657215e-02]
 [ 6.93678741e-02  9.10418617e-02 -3.41507347e-02]
 [ 7.20137203e-02 -8.26254005e-02  5.21250909e-02]
 [ 1.23888960e-01  4.91082877e-02  2.10331645e-02]
 [-1.14623786e-01 -1.33011870e-01  7.14708111e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.1960947]
curr_Stock_Price:  98.839263523743
curr_Factors:  [98.83926352 -1.49571919 -0.97810466]
mat_Sqrt:  [[ 8.32839761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.75795496e-05 -7.20347262e-03  1.15606911e-01]
Stock Position:  -4.7579549572245926e-05
Bond Position:  [-6.19139197]


portfolio before change:  [-6.1991876]
curr_Stock_Price:  98.76414831971233
curr_Factors:  [98.76414832 -1.04863759 -1.02463883]
mat_Sqrt:  [[12.42186518  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [9.19920135e-05 2.47379554e-02 9.75345782e-02]
Stock Position:  9.199201345067468e-05
Bond Position:  [-6.20827311]


portfolio before change:  [-6.20223199]
curr_Stock_Price:  99.42196876501893
curr_Factors:  [99.42196877 -1.02530367 -1.01639891]
mat_Sqrt:  [[12.90571875  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00773772  0.00452042 -0.15558861]
Stock Position:  -0.007737715686009526
Bond Position:  [-5.43293307]


portfolio before change:  [-6.19189173]
curr_Stock_Price:  97.73446686684358
curr_Factors:  [97.73446687 -0.94143618 -1.01732559]
mat_Sqrt:  [[13.7837796   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00636346 -0.02389488 -1.20649326]
Stock Position:  -0.006363460435299235
Bond Position:  [-5.56996232]


portfolio before change:  [-6.18756417]
curr_Stock_Price:  96.61664108912099
curr_Factors:  [96.61664109 -0.38676291 -1.04789845]
mat_Sqrt:  [[23.01369877  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282767 -0.00904316 -0.12627778]
Stock Position:  -0.002827670554268145
Bond Position:  [-5.91436414]


portfolio before change:  [-6.1960928]
curr_Stock_Price:  98.58671269378922
curr_Factors:  [98.58671269 -0.87215831 -1.06891399]
mat_Sqrt:  [[14.15211653  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00457512  0.02878996 -0.09742254]
Stock Position:  0.004575116038049857
Bond Position:  [-6.64713845]


portfolio before change:  [-6.20437808]
curr_Stock_Price:  97.50239650010445
curr_Factors:  [97.5023965  -1.18478689 -1.06995442]
mat_Sqrt:  [[10.22806742  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00787249 -0.02612845  0.14869838]
Stock Position:  0.007872487334185172
Bond Position:  [-6.97196446]


portfolio before change:  [-6.22437903]
curr_Stock_Price:  95.40469863951778
curr_Factors:  [95.40469864 -1.09401418 -1.08309637]
mat_Sqrt:  [[10.8159001   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01196852 0.0155294  0.06000176]
Stock Position:  0.011968519103979445
Bond Position:  [-7.36623199]


portfolio before change:  [-6.19970553]
curr_Stock_Price:  97.77404219938934
curr_Factors:  [97.7740422  -1.94207005 -1.1212081 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.19970553]
Stock Price:  98.03510384614714
PL:  [-6.19970553]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-6.12368170e-02  7.43385792e-02  1.71676866e-02]
 [-1.09909014e-01  5.25260606e-02 -6.99845300e-02]
 [ 8.38593001e-02 -4.04072165e-02 -3.20007851e-01]
 [ 6.87225742e-02 -1.16630993e-01 -1.69752225e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [-1.78782318e-02  1.30134825e-01 -5.71390100e-02]
 [ 1.03043959e-01  2.69329721e-02  9.43605809e-03]
 [-9.51786677e-02 -7.82227510e-02  7.56167514e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.07417774]
curr_Stock_Price:  99.99154474103543
curr_Factors:  [99.99154474 -0.73164606 -1.04043206]
mat_Sqrt:  [[16.99650119  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00363207  0.01250945 -0.27262553]
Stock Position:  -0.0036320712348386513
Bond Position:  [2.43735415]


portfolio before change:  [2.07870247]
curr_Stock_Price:  99.08138904440162
curr_Factors:  [99.08138904 -0.4516092  -0.99635131]
mat_Sqrt:  [[23.28899929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00239654  0.02350792  0.04897463]
Stock Position:  -0.002396541952679611
Bond Position:  [2.31615517]


portfolio before change:  [2.07409446]
curr_Stock_Price:  101.48751101171544
curr_Factors:  [101.48751101  -0.55837943  -1.03549779]
mat_Sqrt:  [[20.61581555  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00595845  0.0166102  -0.19964638]
Stock Position:  -0.005958451142089025
Bond Position:  [2.67880284]


portfolio before change:  [2.07236556]
curr_Stock_Price:  102.00251674103258
curr_Factors:  [102.00251674  -1.13514084  -1.05734232]
mat_Sqrt:  [[11.38747802  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00153631 -0.01277788 -0.91289333]
Stock Position:  0.0015363069186503037
Bond Position:  [1.91565839]


portfolio before change:  [2.07145327]
curr_Stock_Price:  100.78507603833307
curr_Factors:  [100.78507604  -1.72186527  -1.05454259]
mat_Sqrt:  [[ 6.27505611  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00494986 -0.03688196 -0.48425585]
Stock Position:  0.004949859657237299
Bond Position:  [1.57258129]


portfolio before change:  [2.07345971]
curr_Stock_Price:  101.03153866565427
curr_Factors:  [101.03153867  -1.74768646  -1.0114109 ]
mat_Sqrt:  [[ 6.40023926  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00369564 -0.00193948 -0.30510753]
Stock Position:  0.0036956439738053404
Bond Position:  [1.70008311]


portfolio before change:  [2.07397469]
curr_Stock_Price:  100.94081688912186
curr_Factors:  [100.94081689  -1.80228757  -1.02362908]
mat_Sqrt:  [[ 5.98117908  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00437733  0.04115225 -0.16300169]
Stock Position:  -0.004377333683287949
Bond Position:  [2.51582633]


portfolio before change:  [2.07589815]
curr_Stock_Price:  100.78884406540902
curr_Factors:  [100.78884407  -1.16562528  -1.07181881]
mat_Sqrt:  [[10.75728913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00982269 0.00851695 0.02691845]
Stock Position:  0.009822687794952038
Bond Position:  [1.0858808]


portfolio before change:  [2.07831171]
curr_Stock_Price:  100.97926854739163
curr_Factors:  [100.97926855  -0.81327581  -1.08803073]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.07831171]
Stock Price:  101.78764218007254
PL:  [0.29066953]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 6.70738159e-03 -3.90817251e-02  7.37480295e-02]
 [-1.28498956e-01  9.31732443e-02  7.79333638e-03]
 [-1.03147621e-01  4.31937591e-02 -6.82457610e-02]
 [ 2.77027857e-01  9.74709297e-03 -1.50131072e-01]
 [ 5.60950530e-02 -1.16005059e-01 -1.43517591e-01]
 [ 3.27073754e-02 -1.37123641e-02 -7.31645093e-02]
 [ 1.12845532e-01  9.11992755e-03 -3.15530258e-01]
 [ 4.32717038e-01  2.71933458e-01 -3.02241020e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.92927168]
curr_Stock_Price:  98.73711137982568
curr_Factors:  [98.73711138 -0.80950748 -1.00917416]
mat_Sqrt:  [[16.01905957  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00129546 -0.01235873  0.2103826 ]
Stock Position:  0.0012954598979030916
Bond Position:  [-7.05718165]


portfolio before change:  [-6.93121294]
curr_Stock_Price:  99.96309361344792
curr_Factors:  [99.96309361 -0.5280109  -0.98199662]
mat_Sqrt:  [[22.08267871  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00563801  0.02946397  0.02223222]
Stock Position:  -0.005638012777874634
Bond Position:  [-6.36761974]


portfolio before change:  [-6.94283026]
curr_Stock_Price:  101.4587829707769
curr_Factors:  [ 1.01458783e+02  1.06979730e-02 -9.36693876e-01]
mat_Sqrt:  [[40.19154835  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288526  0.01365907 -0.19468616]
Stock Position:  -0.0028852576094331697
Bond Position:  [-6.65009554]


portfolio before change:  [-6.95872496]
curr_Stock_Price:  105.81500349872296
curr_Factors:  [105.8150035   -0.18825084  -0.89985505]
mat_Sqrt:  [[35.64419947  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00691933  0.0030823  -0.42828216]
Stock Position:  0.0069193347852762295
Bond Position:  [-7.69089439]


portfolio before change:  [-6.9551383]
curr_Stock_Price:  106.88924905119869
curr_Factors:  [106.88924905  -0.2680018   -0.89427774]
mat_Sqrt:  [[33.43200598  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071202 -0.03668402 -0.40941574]
Stock Position:  0.0007120245686051421
Bond Position:  [-7.03124607]


portfolio before change:  [-6.9608895]
curr_Stock_Price:  103.75074595442099
curr_Factors:  [103.75074595  -0.11159265  -0.92724754]
mat_Sqrt:  [[36.71374348  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00047445 -0.00433623 -0.20871798]
Stock Position:  0.00047444578307853587
Bond Position:  [-7.0101136]


portfolio before change:  [-6.9630722]
curr_Stock_Price:  106.53975058473894
curr_Factors:  [106.53975058  -0.88152586  -0.92280182]
mat_Sqrt:  [[17.53485255  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00277582  0.00288397 -0.90012   ]
Stock Position:  0.0027758239475205587
Bond Position:  [-7.25880779]


portfolio before change:  [-6.95791609]
curr_Stock_Price:  109.705089153846
curr_Factors:  [109.70508915  -0.57644709  -0.91219991]
mat_Sqrt:  [[24.75800215  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01526955  0.08599291 -0.8622095 ]
Stock Position:  0.01526955356846661
Bond Position:  [-8.63306382]


portfolio before change:  [-7.0208945]
curr_Stock_Price:  105.86340502846595
curr_Factors:  [105.86340503  -0.94341     -0.92704703]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.0208945]
Stock Price:  105.15317359382082
PL:  [-12.17406809]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 1.62002927e-02 -5.32602207e-02  1.04068853e-01]
 [-1.13550791e-01  7.62903154e-02  3.41755299e-03]
 [-8.40524638e-02  5.02844745e-03 -5.07971043e-02]
 [ 3.10661783e-02 -4.16720786e-02 -2.86933097e-01]
 [ 6.87208493e-02 -1.16643450e-01 -1.69746603e-01]
 [ 6.67789261e-02  8.04377165e-02 -4.20952358e-02]
 [ 6.13912500e-02  5.32594586e-02  4.34232054e-02]
 [ 1.18570376e-01  4.30626583e-02 -2.03460847e-02]
 [-9.87099289e-02 -7.70778633e-02  1.13387932e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.90844269]
curr_Stock_Price:  98.60068535819438
curr_Factors:  [98.60068536 -1.04586861 -1.04555708]
mat_Sqrt:  [[12.17826154  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00296168 -0.01684236  0.29687947]
Stock Position:  0.0029616776888666966
Bond Position:  [-8.20046614]


portfolio before change:  [-7.9150962]
curr_Stock_Price:  97.7389279320617
curr_Factors:  [97.73892793 -1.00193634 -1.04991882]
mat_Sqrt:  [[12.55909077  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00882893  0.02412512  0.00974933]
Stock Position:  -0.00882893356791096
Bond Position:  [-7.05216569]


portfolio before change:  [-7.93314483]
curr_Stock_Price:  99.38371010213856
curr_Factors:  [99.3837101  -0.76064567 -1.09828873]
mat_Sqrt:  [[15.48781861  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00608811  0.00159013 -0.14491   ]
Stock Position:  -0.006088110123447986
Bond Position:  [-7.32808586]


portfolio before change:  [-7.94379586]
curr_Stock_Price:  100.53120382107481
curr_Factors:  [100.53120382  -0.85073065  -1.1521615 ]
mat_Sqrt:  [[13.56612688  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0021067  -0.01317787 -0.81854026]
Stock Position:  -0.0021067002824597648
Bond Position:  [-7.73200674]


portfolio before change:  [-7.94623979]
curr_Stock_Price:  99.85572148633213
curr_Factors:  [99.85572149 -0.59908482 -1.15381091]
mat_Sqrt:  [[17.30214757  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00179514 -0.0368859  -0.48423981]
Stock Position:  0.0017951383216379207
Bond Position:  [-8.12549462]


portfolio before change:  [-7.952558]
curr_Stock_Price:  98.59985938414032
curr_Factors:  [98.59985938 -0.57637403 -1.12371221]
mat_Sqrt:  [[18.01101641  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00334591  0.02543664 -0.12008599]
Stock Position:  0.0033459058365175147
Bond Position:  [-8.28246385]


portfolio before change:  [-7.95181303]
curr_Stock_Price:  100.06052174883584
curr_Factors:  [100.06052175  -0.4304005   -1.11057296]
mat_Sqrt:  [[21.43021321  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00334248 0.01684212 0.12387432]
Stock Position:  0.0033424832184210294
Bond Position:  [-8.28626364]


portfolio before change:  [-7.95326499]
curr_Stock_Price:  100.86597434861386
curr_Factors:  [100.86597435  -0.75587572  -1.15306785]
mat_Sqrt:  [[14.95205999  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00772664  0.01361761 -0.05804172]
Stock Position:  0.007726635807285503
Bond Position:  [-8.73261963]


portfolio before change:  [-7.97103222]
curr_Stock_Price:  99.13173587035617
curr_Factors:  [99.13173587 -0.50580813 -1.15035251]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.97103222]
Stock Price:  101.6127247986483
PL:  [-9.58375701]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 5.49512488e-02 -1.04752249e-01  2.12374613e-01]
 [-1.23607857e-01  9.48942026e-02  1.00471944e-02]
 [-6.86157541e-02 -1.85550740e-02 -4.44096271e-02]
 [ 2.18622549e-02 -3.20531620e-02 -2.19072640e-01]
 [ 6.87229008e-02 -1.16628634e-01 -1.69753290e-01]
 [ 4.43663688e-02 -1.13625097e-02 -1.10870887e-01]
 [ 1.44878942e-01 -4.20074464e-02 -4.17645812e-01]
 [ 4.65505149e-01  3.75527839e-01 -3.75158655e-01]
 [-8.10922708e-02 -9.03396135e-02 -2.38575017e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.03018993]
curr_Stock_Price:  98.16573829428752
curr_Factors:  [98.16573829 -0.8270216  -1.02862455]
mat_Sqrt:  [[15.3483981   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00622849 -0.03312557  0.60584566]
Stock Position:  0.00622848997854574
Bond Position:  [-11.64161425]


portfolio before change:  [-11.02447529]
curr_Stock_Price:  100.01801727748705
curr_Factors:  [100.01801728  -0.58675584  -0.99151913]
mat_Sqrt:  [[20.63678922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00577158  0.03000818  0.02866185]
Stock Position:  -0.005771577286837454
Bond Position:  [-10.44721358]


portfolio before change:  [-11.02215624]
curr_Stock_Price:  98.7109277624135
curr_Factors:  [98.71092776 -0.41292741 -1.05669832]
mat_Sqrt:  [[22.70465411  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00344246 -0.00586763 -0.1266883 ]
Stock Position:  -0.0034424625374787597
Bond Position:  [-10.68234757]


portfolio before change:  [-11.03241663]
curr_Stock_Price:  100.13952095852474
curr_Factors:  [100.13952096  -0.62993871  -1.03767318]
mat_Sqrt:  [[18.8960431   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00125335 -0.0101361  -0.62495327]
Stock Position:  -0.0012533507447932168
Bond Position:  [-10.90690668]


portfolio before change:  [-11.03876372]
curr_Stock_Price:  100.85143405971976
curr_Factors:  [100.85143406  -0.66778876  -0.99338897]
mat_Sqrt:  [[19.15321823  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0016217  -0.03688121 -0.48425889]
Stock Position:  0.00162170226173462
Bond Position:  [-11.20231472]


portfolio before change:  [-11.04314315]
curr_Stock_Price:  101.60565965420918
curr_Factors:  [101.60565965   0.16733008  -0.96525235]
mat_Sqrt:  [[45.74932188  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00046868 -0.00359314 -0.31628378]
Stock Position:  0.0004686750339247607
Bond Position:  [-11.09076319]


portfolio before change:  [-11.04589496]
curr_Stock_Price:  107.56919302715443
curr_Factors:  [107.56919303  -0.15365633  -0.9087137 ]
mat_Sqrt:  [[37.17975038  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00157459 -0.01328392 -1.19142725]
Stock Position:  0.0015745861535839513
Bond Position:  [-11.21527192]


portfolio before change:  [-11.03946682]
curr_Stock_Price:  115.2138548887774
curr_Factors:  [115.21385489  -0.49663294  -0.95630728]
mat_Sqrt:  [[26.946402    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01479315  0.11875233 -1.07022322]
Stock Position:  0.014793154798310967
Bond Position:  [-12.74384321]


portfolio before change:  [-11.02355744]
curr_Stock_Price:  116.72015224349248
curr_Factors:  [116.72015224  -0.75574371  -0.95388523]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.02355744]
Stock Price:  116.28988292560773
PL:  [-27.31344037]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.35996821e-02  3.92798665e-02 -9.47427019e-02]
 [-2.93928434e-01  2.91285331e-02 -4.55387315e-02]
 [-7.72314469e-02 -7.50153085e-03 -4.57354177e-02]
 [ 2.11134550e-02 -4.98906410e-02 -2.97714725e-01]
 [-1.25382904e-01  1.20446937e-01  1.84107770e-01]
 [ 1.40640534e-01  1.53860921e-01 -6.96443656e-02]
 [ 2.49731855e-01 -2.62315203e-01  2.93785308e-01]
 [ 9.24477844e-02  1.28710115e-01  3.86272633e-02]
 [-1.40890783e-01 -2.03775776e-01  7.71440099e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.66311186]
curr_Stock_Price:  99.79494363510696
curr_Factors:  [99.79494364 -0.90376302 -1.01057571]
mat_Sqrt:  [[14.71369634  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00420865  0.01242138 -0.27027456]
Stock Position:  -0.004208646960411566
Bond Position:  [1.08311354]


portfolio before change:  [0.65805095]
curr_Stock_Price:  101.12615636365098
curr_Factors:  [101.12615636  -0.55774971  -1.01448588]
mat_Sqrt:  [[20.99182809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01440903  0.00921125 -0.12990933]
Stock Position:  -0.014409030595063219
Bond Position:  [2.11518083]


portfolio before change:  [0.71409892]
curr_Stock_Price:  97.30979166814708
curr_Factors:  [97.30979167 -0.864568   -1.08917702]
mat_Sqrt:  [[13.7929087   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00629025 -0.00237219 -0.13047042]
Stock Position:  -0.006290249618931759
Bond Position:  [1.3262018]


portfolio before change:  [0.71258129]
curr_Stock_Price:  97.65650162279744
curr_Factors:  [97.65650162 -0.57914321 -1.0859002 ]
mat_Sqrt:  [[18.47489586  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221628 -0.01577681 -0.84929724]
Stock Position:  -0.0022162766153394305
Bond Position:  [0.92901511]


portfolio before change:  [0.72080867]
curr_Stock_Price:  94.15388799562301
curr_Factors:  [94.153888   -0.30473855 -1.05914766]
mat_Sqrt:  [[24.07187967  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0035183   0.03808867  0.52520822]
Stock Position:  -0.0035183017548784676
Bond Position:  [1.05207046]


portfolio before change:  [0.72383719]
curr_Stock_Price:  93.44265102454098
curr_Factors:  [93.44265102 -0.65598034 -1.10798281]
mat_Sqrt:  [[16.01274135  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00814333  0.0486551  -0.19867599]
Stock Position:  0.008143334515020502
Bond Position:  [-0.03709758]


portfolio before change:  [0.71608465]
curr_Stock_Price:  92.49291853424103
curr_Factors:  [92.49291853 -0.4312038  -1.07770468]
mat_Sqrt:  [[20.45492352  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01480952 -0.08295135  0.83808771]
Stock Position:  0.014809519082212588
Bond Position:  [-0.653691]


portfolio before change:  [0.68841085]
curr_Stock_Price:  90.64634453946307
curr_Factors:  [ 9.06463445e+01  3.34110096e-02 -1.17648829e+00]
mat_Sqrt:  [[28.90135067  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00358654 0.04070171 0.11019283]
Stock Position:  0.0035865390374044065
Bond Position:  [0.36330419]


portfolio before change:  [0.68832672]
curr_Stock_Price:  90.57222909723347
curr_Factors:  [90.5722291  -0.36252904 -1.1239641 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.68832672]
Stock Price:  90.16775483909747
PL:  [0.68832672]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 1.36785270e-01 -8.85950033e-03 -5.33051991e-02]
 [-3.72479374e-01 -1.00175600e-01 -2.47783096e-01]
 [-1.01628329e-01  3.73147200e-02 -6.38396640e-02]
 [ 1.01106602e-02 -8.31391424e-02 -5.41124288e-01]
 [ 6.87217501e-02 -1.16636945e-01 -1.69749539e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 1.25240955e-02  1.48070628e-01 -3.39750694e-02]
 [ 1.33336986e-01  5.12094209e-02 -2.50058467e-02]
 [-9.50831259e-02 -7.82537270e-02  7.45948148e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.35268373]
curr_Stock_Price:  102.81691013886032
curr_Factors:  [102.81691014  -1.39020589  -1.03466792]
mat_Sqrt:  [[ 9.0981948   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01381325 -0.00280162 -0.1520649 ]
Stock Position:  0.013813250075554647
Bond Position:  [20.93244803]


portfolio before change:  [22.36076591]
curr_Stock_Price:  102.64413013542563
curr_Factors:  [102.64413014  -1.31605039  -0.98724509]
mat_Sqrt:  [[10.25712397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04149744 -0.03167831 -0.7068562 ]
Stock Position:  -0.04149744227620518
Bond Position:  [26.62023478]


portfolio before change:  [22.42377142]
curr_Stock_Price:  101.44665724102829
curr_Factors:  [101.44665724  -1.82723185  -0.96293273]
mat_Sqrt:  [[ 6.22995145  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01824991  0.01179995 -0.18211679]
Stock Position:  -0.01824991488530879
Bond Position:  [24.27516428]


portfolio before change:  [22.43240299]
curr_Stock_Price:  101.63893476527012
curr_Factors:  [101.63893477  -1.68842536  -1.00490857]
mat_Sqrt:  [[ 6.87638272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.014905   -0.02629091 -1.54367697]
Stock Position:  -0.014905004583898181
Bond Position:  [23.94733178]


portfolio before change:  [22.46466661]
curr_Stock_Price:  100.27785109434932
curr_Factors:  [100.27785109  -1.39406928  -1.01958638]
mat_Sqrt:  [[ 8.97362018  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00346128 -0.03688384 -0.48424819]
Stock Position:  0.0034612806127633693
Bond Position:  [22.11757683]


portfolio before change:  [22.47747333]
curr_Stock_Price:  100.78204857079618
curr_Factors:  [100.78204857  -1.34233853  -1.02591608]
mat_Sqrt:  [[ 9.43763709  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00250624 -0.00193948 -0.30510753]
Stock Position:  0.0025062423383756505
Bond Position:  [22.22488909]


portfolio before change:  [22.48992996]
curr_Stock_Price:  101.31727341338049
curr_Factors:  [101.31727341  -0.88576878  -1.09458393]
mat_Sqrt:  [[13.98386553  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00067307  0.04682404 -0.09692142]
Stock Position:  0.0006730707330485616
Bond Position:  [22.42173627]


portfolio before change:  [22.50125207]
curr_Stock_Price:  101.47838808965139
curr_Factors:  [101.47838809  -0.93903945  -1.08090922]
mat_Sqrt:  [[13.46235371  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0096235   0.01619384 -0.07133472]
Stock Position:  0.009623496274940836
Bond Position:  [21.52467518]


portfolio before change:  [22.5029735]
curr_Stock_Price:  100.53864662629813
curr_Factors:  [100.53864663  -0.41216387  -1.02537204]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.5029735]
Stock Price:  102.03882383701585
PL:  [20.46414966]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-3.49890292e-01 -2.30270809e-02 -1.18278928e-01]
 [-1.28168791e-01  8.60686561e-02 -8.35346017e-02]
 [ 2.13119277e-01  1.17286626e-02 -1.15775902e-01]
 [ 6.74662843e-02 -1.25703570e-01 -1.65657623e-01]
 [ 4.25401185e-02 -5.43708134e-03 -8.98744108e-02]
 [ 1.52315052e-01 -3.08934684e-02 -3.99825665e-01]
 [ 3.75732073e-01  2.27113806e-01 -2.40239139e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.11775865]
curr_Stock_Price:  100.69425720873022
curr_Factors:  [100.69425721  -0.53573966  -0.99152692]
mat_Sqrt:  [[21.86357894  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282353  0.01250945 -0.27262553]
Stock Position:  -0.0028235314645757674
Bond Position:  [7.40207205]


portfolio before change:  [7.11863484]
curr_Stock_Price:  101.69505056179584
curr_Factors:  [101.69505056  -0.2321276   -0.97845777]
mat_Sqrt:  [[30.30744105  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01236094 -0.0072818  -0.33741686]
Stock Position:  -0.012360939108898876
Bond Position:  [8.37568116]


portfolio before change:  [7.10157844]
curr_Stock_Price:  103.41379417335894
curr_Factors:  [103.41379417  -0.65381495  -1.01069005]
mat_Sqrt:  [[19.5746108   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00730528  0.0272173  -0.23830097]
Stock Position:  -0.007305276143336967
Bond Position:  [7.85704476]


portfolio before change:  [7.09767989]
curr_Stock_Price:  104.48535542717092
curr_Factors:  [104.48535543  -0.54505741  -0.997836  ]
mat_Sqrt:  [[22.33496772  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00849741  0.00370893 -0.33027642]
Stock Position:  0.008497413361851579
Bond Position:  [6.20982464]


portfolio before change:  [7.09416128]
curr_Stock_Price:  103.70578913636906
curr_Factors:  [103.70578914  -0.40497403  -0.95642772]
mat_Sqrt:  [[26.57992407  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00114394 -0.03975096 -0.47257509]
Stock Position:  0.0011439427509136338
Bond Position:  [6.9755278]


portfolio before change:  [7.0974537]
curr_Stock_Price:  103.53426389933489
curr_Factors:  [103.5342639   -0.34577195  -0.97818309]
mat_Sqrt:  [[27.54848567  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00087316 -0.00171936 -0.25638668]
Stock Position:  0.0008731585694686048
Bond Position:  [7.00705188]


portfolio before change:  [7.10640033]
curr_Stock_Price:  109.76705971235647
curr_Factors:  [109.76705971  -0.98084195  -0.976607  ]
mat_Sqrt:  [[15.50110838  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00450957 -0.00976937 -1.14059133]
Stock Position:  0.004509568729996098
Bond Position:  [6.61139823]


portfolio before change:  [7.10699646]
curr_Stock_Price:  109.16602854419995
curr_Factors:  [109.16602854  -0.95536181  -0.99666278]
mat_Sqrt:  [[15.50008233  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02145521  0.07181969 -0.68533539]
Stock Position:  0.02145520976246084
Bond Position:  [4.76481642]


portfolio before change:  [7.10733862]
curr_Stock_Price:  109.07090744489483
curr_Factors:  [109.07090744  -0.9147967   -0.97708005]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.10733862]
Stock Price:  108.24007034226624
PL:  [-1.13273172]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-1.74160050e-02  7.64232367e-02  3.05776342e-02]
 [-1.00133724e-01  3.45691817e-02 -6.27305596e-02]
 [ 4.98555051e-02 -6.61475139e-02 -4.56307747e-01]
 [ 6.86715549e-02 -1.16999441e-01 -1.69585939e-01]
 [ 5.23217049e-02  2.12219763e-02 -8.64589730e-02]
 [ 1.63289667e-01 -1.79324292e-01  1.70477681e-01]
 [ 1.42486466e-01  6.94213361e-02  1.50253506e-02]
 [-1.23722106e-01 -1.45614172e-01  1.14786836e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.98848249]
curr_Stock_Price:  100.11893307136965
curr_Factors:  [100.11893307  -0.95305327  -0.98954288]
mat_Sqrt:  [[14.35018251  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430186  0.01250945 -0.27262553]
Stock Position:  -0.0043018618775905485
Bond Position:  [3.41918031]


portfolio before change:  [2.99545639]
curr_Stock_Price:  98.89530504597913
curr_Factors:  [98.89530505 -0.90040406 -0.98606308]
mat_Sqrt:  [[14.99316784  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00061369  0.02416715  0.08722948]
Stock Position:  -0.0006136883247584403
Bond Position:  [3.05614728]


portfolio before change:  [2.99592431]
curr_Stock_Price:  100.62343591697102
curr_Factors:  [100.62343592  -1.23643472  -0.9991906 ]
mat_Sqrt:  [[10.75918566  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01041398  0.01093174 -0.17895283]
Stock Position:  -0.010413982735547719
Bond Position:  [4.04381503]


portfolio before change:  [2.98466811]
curr_Stock_Price:  101.89851096402307
curr_Factors:  [101.89851096  -1.48822156  -1.08036893]
mat_Sqrt:  [[ 7.80985845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00576142 -0.02091768 -1.30171899]
Stock Position:  -0.005761416223497363
Bond Position:  [3.57174785]


portfolio before change:  [2.98861736]
curr_Stock_Price:  101.5230955066262
curr_Factors:  [101.52309551  -1.08891403  -1.07660339]
mat_Sqrt:  [[11.64374232  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0026653  -0.03699847 -0.48378148]
Stock Position:  0.0026652992391020223
Bond Position:  [2.71802793]


portfolio before change:  [2.98419492]
curr_Stock_Price:  99.35381133663964
curr_Factors:  [99.35381134 -0.36528999 -1.09568397]
mat_Sqrt:  [[23.05109707  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00152797  0.00671098 -0.24664338]
Stock Position:  0.0015279658901232777
Bond Position:  [2.83238569]


portfolio before change:  [2.97869221]
curr_Stock_Price:  94.82539961699344
curr_Factors:  [94.82539962 -0.85870311 -1.09518218]
mat_Sqrt:  [[13.43888014  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01439541 -0.05670732  0.48632537]
Stock Position:  0.014395406636091464
Bond Position:  [1.61364202]


portfolio before change:  [2.97094372]
curr_Stock_Price:  94.2310775586763
curr_Factors:  [94.23107756 -0.84962364 -1.13766798]
mat_Sqrt:  [[12.9158911   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01140811 0.02195295 0.04286314]
Stock Position:  0.011408113722804385
Bond Position:  [1.89594487]


portfolio before change:  [2.97424825]
curr_Stock_Price:  94.43762499570475
curr_Factors:  [94.437625   -0.35002666 -1.05819283]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.97424825]
Stock Price:  94.02295740556558
PL:  [2.97424825]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-3.79650162e-02  2.33557324e-02 -5.85602958e-02]
 [-2.50577011e-01  5.65263735e-02 -2.60182147e-02]
 [-1.02768520e-01  3.94092123e-02 -6.46857679e-02]
 [ 1.77022757e-02 -3.60615182e-02 -2.38620406e-01]
 [ 6.90251249e-02 -1.14446056e-01 -1.70738323e-01]
 [ 4.69830561e-02 -6.44746357e-04 -1.02841265e-01]
 [ 7.26171394e-02  1.41025298e-02  5.65898470e-02]
 [ 8.78832838e-02  2.02545630e-02  8.67448525e-03]
 [-9.94810604e-02 -7.68278509e-02  1.21636131e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.97383452]
curr_Stock_Price:  99.28821486279634
curr_Factors:  [99.28821486 -0.59497556 -1.00888895]
mat_Sqrt:  [[19.96862671  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00246965  0.00738573 -0.16705622]
Stock Position:  -0.0024696512604614165
Bond Position:  [-2.72862725]


portfolio before change:  [-2.97877509]
curr_Stock_Price:  100.736157629574
curr_Factors:  [100.73615763  -0.51024787  -0.95465661]
mat_Sqrt:  [[23.28013256  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01092899  0.01787521 -0.07422272]
Stock Position:  -0.01092899498580201
Bond Position:  [-1.87783013]


portfolio before change:  [-2.98361024]
curr_Stock_Price:  101.09264112132901
curr_Factors:  [101.09264112  -0.20528104  -0.99304588]
mat_Sqrt:  [[30.49950388  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00376907  0.01246229 -0.18453049]
Stock Position:  -0.0037690745984581774
Bond Position:  [-2.60258454]


portfolio before change:  [-2.9727139]
curr_Stock_Price:  97.85631422934297
curr_Factors:  [97.85631423 -0.41144494 -0.95976237]
mat_Sqrt:  [[24.83596753  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00128592 -0.01140365 -0.6807176 ]
Stock Position:  -0.001285917895382089
Bond Position:  [-2.84687872]


portfolio before change:  [-2.97601963]
curr_Stock_Price:  99.31980631206751
curr_Factors:  [99.31980631 -0.28921051 -0.98047635]
mat_Sqrt:  [[27.9008779   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011189  -0.03619102 -0.48706891]
Stock Position:  0.0011189012161806062
Bond Position:  [-3.08714868]


portfolio before change:  [-2.97683103]
curr_Stock_Price:  99.9745179284974
curr_Factors:  [99.97451793 -0.63442805 -0.99040222]
mat_Sqrt:  [[19.6894915   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.31918204e-03 -2.03886700e-04 -2.93377503e-01]
Stock Position:  0.001319182037909587
Bond Position:  [-3.10871562]


portfolio before change:  [-2.97913251]
curr_Stock_Price:  99.40846105516496
curr_Factors:  [99.40846106 -0.72741139 -1.02631284]
mat_Sqrt:  [[17.21038538  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00491172 0.00445961 0.16143508]
Stock Position:  0.004911721462595703
Bond Position:  [-3.46739918]


portfolio before change:  [-2.98342734]
curr_Stock_Price:  98.88711651574936
curr_Factors:  [98.88711652 -1.14082839 -1.00769712]
mat_Sqrt:  [[11.53577934  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00781715 0.00640506 0.02474589]
Stock Position:  0.007817150766162873
Bond Position:  [-3.75644284]


portfolio before change:  [-2.98265523]
curr_Stock_Price:  99.22621731690924
curr_Factors:  [99.22621732 -0.83578199 -1.02710708]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.98265523]
Stock Price:  100.573007283916
PL:  [-3.55566252]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 1.20165362e-04  2.78953274e-02 -8.53867130e-02]
 [-1.13082003e-01  7.92960078e-02  1.64344258e-02]
 [-9.44541769e-02  2.41360443e-02 -5.85159257e-02]
 [ 2.14381361e-01  4.32352169e-04 -1.62460431e-01]
 [ 6.80073717e-02 -1.21795987e-01 -1.67421179e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 1.62544687e-02  1.51363135e-01 -2.91602167e-02]
 [ 1.08413729e-01  2.92984025e-02  9.70580011e-03]
 [-9.17208598e-02 -7.88454985e-02  4.35625678e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.34202473]
curr_Stock_Price:  101.28281611078718
curr_Factors:  [101.28281611  -1.29468434  -1.02911832]
mat_Sqrt:  [[ 9.91564794  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00167302  0.00882128 -0.24358452]
Stock Position:  -0.001673019280210288
Bond Position:  [11.51147283]


portfolio before change:  [11.34915531]
curr_Stock_Price:  100.46190118164337
curr_Factors:  [100.46190118  -1.2380353   -1.02020294]
mat_Sqrt:  [[10.50173331  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01025354  0.0250756   0.04688284]
Stock Position:  -0.010253538381232377
Bond Position:  [12.37924527]


portfolio before change:  [11.35794257]
curr_Stock_Price:  100.20871128557555
curr_Factors:  [100.20871129  -0.71408913  -0.98585958]
mat_Sqrt:  [[18.30741944  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00577774  0.00763249 -0.16692965]
Stock Position:  -0.0057777394870291545
Bond Position:  [11.9369224]


portfolio before change:  [11.34260626]
curr_Stock_Price:  103.89635839549314
curr_Factors:  [103.8963584  -0.8863661  -1.0482021]
mat_Sqrt:  [[15.01163616  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.20726632e-02  1.36721761e-04 -4.63454389e-01]
Stock Position:  0.01207266323216253
Bond Position:  [10.08830052]


portfolio before change:  [11.33317221]
curr_Stock_Price:  102.6969984683418
curr_Factors:  [102.69699847  -0.71523969  -1.10190738]
mat_Sqrt:  [[16.68709754  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00183902 -0.03851527 -0.47760602]
Stock Position:  0.0018390201031078157
Bond Position:  [11.14431036]


portfolio before change:  [11.33632662]
curr_Stock_Price:  101.38154998968004
curr_Factors:  [101.38154999  -1.22135254  -1.11495942]
mat_Sqrt:  [[ 9.80192854  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0024131  -0.00193948 -0.30510753]
Stock Position:  0.0024130971333265433
Bond Position:  [11.09168309]


portfolio before change:  [11.34162307]
curr_Stock_Price:  101.27762639328574
curr_Factors:  [101.27762639  -0.76811451  -1.10313829]
mat_Sqrt:  [[15.58973561  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00091152  0.04786523 -0.08318598]
Stock Position:  0.0009115192232912733
Bond Position:  [11.24930657]


portfolio before change:  [11.34731409]
curr_Stock_Price:  101.34889568639977
curr_Factors:  [101.34889569  -1.26617705  -1.1006607 ]
mat_Sqrt:  [[ 9.50417548  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01169501 0.00926497 0.02768795]
Stock Position:  0.011695007016609818
Bond Position:  [10.16203805]


portfolio before change:  [11.35435767]
curr_Stock_Price:  101.51659839672995
curr_Factors:  [101.5165984   -1.09408239  -1.0999052 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.35435767]
Stock Price:  102.88393017871665
PL:  [8.47042749]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-3.37228292e-02  3.69970907e-02 -9.33312025e-02]
 [-3.98780599e-01 -1.27040153e-01 -2.87518754e-01]
 [-1.30516444e-01  9.03812155e-02 -8.52767295e-02]
 [ 2.21702317e-01 -1.81851472e-02 -2.52650900e-01]
 [ 5.79011225e-02 -1.18340680e-01 -1.46904810e-01]
 [-7.06311345e-02 -2.58843591e-02  2.70164959e-02]
 [ 9.58142045e-02  3.56049974e-02 -2.62499270e-01]
 [ 2.55266974e-01  1.32365939e-01 -1.09168376e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.57337748]
curr_Stock_Price:  101.03639387777439
curr_Factors:  [101.03639388  -0.66017949  -1.01307897]
mat_Sqrt:  [[18.9579302   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273335  0.01169951 -0.26624794]
Stock Position:  -0.002733353263427059
Bond Position:  [9.84954564]


portfolio before change:  [9.5730119]
curr_Stock_Price:  102.97232639222285
curr_Factors:  [102.97232639  -1.27949057  -1.03175762]
mat_Sqrt:  [[10.20841201  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04513437 -0.04017362 -0.82021097]
Stock Position:  -0.04513437355383839
Bond Position:  [14.22060335]


portfolio before change:  [9.5053075]
curr_Stock_Price:  104.62996497440938
curr_Factors:  [104.62996497  -1.30822585  -1.07176501]
mat_Sqrt:  [[ 9.68365213  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0150346   0.02858105 -0.24327077]
Stock Position:  -0.015034601485876781
Bond Position:  [11.07837733]


portfolio before change:  [9.51475667]
curr_Stock_Price:  104.36999138065958
curr_Factors:  [104.36999138  -1.26980818  -1.02059916]
mat_Sqrt:  [[10.5648754   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01605893 -0.00575065 -0.72074269]
Stock Position:  0.016058933316519704
Bond Position:  [7.83868594]


portfolio before change:  [9.55106266]
curr_Stock_Price:  106.38666755265496
curr_Factors:  [106.38666755  -1.28363395  -1.03216175]
mat_Sqrt:  [[10.49904773  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00236772 -0.03742261 -0.41907853]
Stock Position:  0.0023677157419733663
Bond Position:  [9.29916928]


portfolio before change:  [9.55436491]
curr_Stock_Price:  105.81713127926302
curr_Factors:  [105.81713128  -1.42165516  -0.97877037]
mat_Sqrt:  [[ 9.59542958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00685584 -0.00818535  0.07707054]
Stock Position:  -0.006855841739183133
Bond Position:  [10.27983042]


portfolio before change:  [9.56019828]
curr_Stock_Price:  105.71617044359867
curr_Factors:  [105.71617044  -1.23153147  -0.90955899]
mat_Sqrt:  [[12.4244637   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00347307  0.01125929 -0.74883735]
Stock Position:  0.003473074054076849
Bond Position:  [9.1930382]


portfolio before change:  [9.56767694]
curr_Stock_Price:  106.54569089060676
curr_Factors:  [106.54569089  -1.4856885   -0.89072373]
mat_Sqrt:  [[ 9.89630728  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02388777  0.04185779 -0.31142699]
Stock Position:  0.02388777342387383
Bond Position:  [7.02253761]


portfolio before change:  [9.57190258]
curr_Stock_Price:  106.57555955726144
curr_Factors:  [106.57555956  -1.19038213  -0.88254054]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.57190258]
Stock Price:  105.93558622193105
PL:  [3.63631636]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-1.88605257e-02  9.12234172e-02  3.76994752e-02]
 [-1.00219647e-01  3.47270198e-02 -6.27943209e-02]
 [ 4.46596933e-02 -1.24831917e-02 -1.72491495e-01]
 [ 6.87203300e-02 -1.16647200e-01 -1.69744911e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 4.09457763e-02  8.50844756e-02 -1.56419120e-01]
 [ 2.24560193e-01  1.16400107e-01 -1.02686494e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.62280009]
curr_Stock_Price:  100.34663941158894
curr_Factors:  [100.34663941  -1.09357154  -0.96948591]
mat_Sqrt:  [[12.75053377  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00484156  0.01250945 -0.27262553]
Stock Position:  -0.004841562257915502
Bond Position:  [5.10863459]


portfolio before change:  [4.62786525]
curr_Stock_Price:  99.82816950505376
curr_Factors:  [99.82816951 -1.10479617 -0.95546813]
mat_Sqrt:  [[12.72013404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069259  0.02884738  0.10754611]
Stock Position:  -0.0006925850023098158
Bond Position:  [4.69700474]


portfolio before change:  [4.62971932]
curr_Stock_Price:  100.54290289926016
curr_Factors:  [100.5429029   -1.1120331   -0.96324006]
mat_Sqrt:  [[12.62035984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00888571  0.01098165 -0.17913472]
Stock Position:  -0.008885708345591622
Bond Position:  [5.52311423]


portfolio before change:  [4.62875812]
curr_Stock_Price:  100.96194082206068
curr_Factors:  [100.96194082  -0.51623958  -0.94850234]
mat_Sqrt:  [[23.3361043   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.91140681e-04 -3.94753183e-03 -4.92070222e-01]
Stock Position:  0.00039114068148000394
Bond Position:  [4.5892678]


portfolio before change:  [4.63043197]
curr_Stock_Price:  99.37335937397557
curr_Factors:  [99.37335937 -0.75852576 -0.9301195 ]
mat_Sqrt:  [[18.36118271  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00169158 -0.03688708 -0.48423498]
Stock Position:  0.001691583706459117
Bond Position:  [4.46233362]


portfolio before change:  [4.63511471]
curr_Stock_Price:  100.82230417904894
curr_Factors:  [100.82230418  -0.70626318  -0.94084996]
mat_Sqrt:  [[19.41889318  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00121804 -0.00193948 -0.30510753]
Stock Position:  0.0012180408757595802
Bond Position:  [4.51230902]


portfolio before change:  [4.63919007]
curr_Stock_Price:  102.31539306657362
curr_Factors:  [102.31539307  -0.87707917  -0.95362953]
mat_Sqrt:  [[16.40114958  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00068372  0.02690607 -0.44622021]
Stock Position:  0.000683716035325519
Bond Position:  [4.56923539]


portfolio before change:  [4.64265568]
curr_Stock_Price:  104.0418764647083
curr_Factors:  [104.04187646  -0.91816906  -0.96758693]
mat_Sqrt:  [[15.78464275  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01308898  0.03680895 -0.29293598]
Stock Position:  0.01308897774303637
Bond Position:  [3.28085388]


portfolio before change:  [4.65069892]
curr_Stock_Price:  104.53102107225986
curr_Factors:  [104.53102107  -0.62710202  -0.96432734]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.65069892]
Stock Price:  108.8876823684325
PL:  [-4.23698345]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-2.31549411e-01  5.38017781e-02 -1.87148851e-02]
 [-8.45550859e-02  5.95174739e-03 -5.11700861e-02]
 [-2.07994001e-03 -4.87444510e-02 -2.89521491e-01]
 [ 6.87201424e-02 -1.16648555e-01 -1.69744299e-01]
 [ 4.90976146e-02  8.01633356e-03 -9.63524854e-02]
 [ 1.86624791e-02  1.18763497e-01 -8.87934304e-02]
 [ 1.33411981e-01  4.03103496e-02  1.09615482e-02]
 [-6.40291437e-02 -2.10239945e-02  4.08399951e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.70583011]
curr_Stock_Price:  100.63686399436766
curr_Factors:  [100.63686399  -1.02327986  -1.00913878]
mat_Sqrt:  [[13.18526598  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00468193  0.01250945 -0.27262553]
Stock Position:  -0.0046819308144391775
Bond Position:  [7.17700494]


portfolio before change:  [6.70854644]
curr_Stock_Price:  100.82334047517544
curr_Factors:  [100.82334048  -0.9668458   -0.92976243]
mat_Sqrt:  [[15.1312426   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0154634   0.01701362 -0.05338836]
Stock Position:  -0.015463397234408024
Bond Position:  [8.2676178]


portfolio before change:  [6.73326447]
curr_Stock_Price:  99.49224904832776
curr_Factors:  [99.49224905 -0.58361036 -0.88446337]
mat_Sqrt:  [[22.91991125  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00413817  0.00188211 -0.14597401]
Stock Position:  -0.004138168838141557
Bond Position:  [7.1449802]


portfolio before change:  [6.73419274]
curr_Stock_Price:  100.13144907974515
curr_Factors:  [100.13144908  -0.88587044  -0.87335292]
mat_Sqrt:  [[17.24048587  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00362152 -0.01541435 -0.82592423]
Stock Position:  -0.0036215245734953984
Bond Position:  [7.09682124]


portfolio before change:  [6.74102405]
curr_Stock_Price:  99.22519813870896
curr_Factors:  [99.22519814 -1.20062141 -0.85430711]
mat_Sqrt:  [[12.7109456   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00244351 -0.03688751 -0.48423324]
Stock Position:  0.0024435144844164275
Bond Position:  [6.49856584]


portfolio before change:  [6.74616605]
curr_Stock_Price:  99.99945404018337
curr_Factors:  [99.99945404 -1.29171887 -0.84276163]
mat_Sqrt:  [[11.83053886  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0025051   0.00253499 -0.27486682]
Stock Position:  0.0025051037028290374
Bond Position:  [6.49565705]


portfolio before change:  [6.75290147]
curr_Stock_Price:  101.39132504972243
curr_Factors:  [101.39132505  -1.6732312   -0.83051634]
mat_Sqrt:  [[ 8.29157542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00043466  0.03755632 -0.25330294]
Stock Position:  0.00043466484803456767
Bond Position:  [6.70883023]


portfolio before change:  [6.75648827]
curr_Stock_Price:  101.92403188144536
curr_Factors:  [101.92403188  -1.92137062  -0.86646702]
mat_Sqrt:  [[ 6.27384945  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02178731 0.01274725 0.03127025]
Stock Position:  0.021787310602960137
Bond Position:  [4.53583773]


portfolio before change:  [6.76064453]
curr_Stock_Price:  102.01067719579437
curr_Factors:  [102.0106772   -1.3927839   -0.86370301]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.76064453]
Stock Price:  102.20939409523976
PL:  [4.55125043]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 1.94845246e-01 -2.44741992e-02 -3.96758827e-02]
 [-6.04545926e-01 -3.37212638e-01 -5.98387190e-01]
 [-1.36835815e-01  1.01989686e-01 -8.99661582e-02]
 [ 2.63639396e-01  1.06568772e-02 -1.28570846e-01]
 [ 6.40175305e-02 -1.26250460e-01 -1.58375914e-01]
 [-1.61680169e-01 -6.86883832e-02  1.05167349e-01]
 [ 1.06161749e-01  3.01812166e-02 -2.75444712e-01]
 [ 1.81866207e-01  7.46349773e-02 -2.93054574e-02]
 [-8.13020543e-02 -8.97006944e-02 -2.23966032e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [25.39882739]
curr_Stock_Price:  103.24132350025027
curr_Factors:  [103.2413235   -0.63701325  -0.98902265]
mat_Sqrt:  [[20.30837372  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00916442 -0.00773942 -0.11318425]
Stock Position:  0.009164422630866595
Bond Position:  [24.45268026]


portfolio before change:  [25.4314997]
curr_Stock_Price:  105.47200574611504
curr_Factors:  [105.47200575  -1.11858435  -1.04119253]
mat_Sqrt:  [[12.16628609  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06044556 -0.106636   -1.70703209]
Stock Position:  -0.06044556136863125
Bond Position:  [31.80681429]


portfolio before change:  [25.48312127]
curr_Stock_Price:  104.88115686734668
curr_Factors:  [104.88115687  -0.88473592  -1.03387624]
mat_Sqrt:  [[15.39766238  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00990843  0.03225197 -0.25664841]
Stock Position:  -0.009908433731698498
Bond Position:  [26.52232927]


portfolio before change:  [25.49693912]
curr_Stock_Price:  104.82530913434593
curr_Factors:  [104.82530913  -0.91890618  -0.96613034]
mat_Sqrt:  [[15.91494687  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01493377  0.00337    -0.36677684]
Stock Position:  0.014933769092877388
Bond Position:  [23.93150216]


portfolio before change:  [25.5148055]
curr_Stock_Price:  105.22022902295699
curr_Factors:  [105.22022902  -1.04760674  -0.96103945]
mat_Sqrt:  [[14.11741846  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00201378 -0.0399239  -0.4518024 ]
Stock Position:  0.002013782455199387
Bond Position:  [25.30291485]


portfolio before change:  [25.53242543]
curr_Stock_Price:  107.68589263963928
curr_Factors:  [107.68589264  -1.47809766  -0.98021852]
mat_Sqrt:  [[ 9.2156433   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01540712 -0.02172117  0.30001317]
Stock Position:  -0.015407117636098328
Bond Position:  [27.19155465]


portfolio before change:  [25.5511903]
curr_Stock_Price:  107.3506133428325
curr_Factors:  [107.35061334  -1.48823154  -0.96989969]
mat_Sqrt:  [[ 9.18864984  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00551943  0.00954414 -0.7857671 ]
Stock Position:  0.005519429808705721
Bond Position:  [24.95867612]


portfolio before change:  [25.5628506]
curr_Stock_Price:  107.201657155808
curr_Factors:  [107.20165716  -2.33034341  -0.91151789]
mat_Sqrt:  [[ 4.19062716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04243072  0.02360165 -0.08360031]
Stock Position:  0.0424307187495276
Bond Position:  [21.01420724]


portfolio before change:  [25.57425445]
curr_Stock_Price:  107.22272954738617
curr_Factors:  [107.22272955  -2.19174398  -0.90374224]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [25.57425445]
Stock Price:  107.48465380006887
PL:  [18.08960065]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-3.19689345e-01 -3.48400380e-02 -1.47695329e-01]
 [-1.29432958e-01  8.83908881e-02 -8.44727047e-02]
 [ 2.06326480e-01 -7.60768589e-03 -1.97965254e-01]
 [ 6.82304795e-02 -1.20184764e-01 -1.68148350e-01]
 [ 4.47752195e-02 -9.68788640e-03 -1.09616279e-01]
 [ 6.65790534e-02  5.23948269e-02 -2.23275626e-01]
 [ 2.62495912e-01  1.46128551e-01 -1.43604618e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.55627706]
curr_Stock_Price:  99.91938663233509
curr_Factors:  [99.91938663 -0.584617   -1.08027502]
mat_Sqrt:  [[18.90585579  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00326526  0.01250945 -0.27262553]
Stock Position:  -0.003265258328585266
Bond Position:  [1.88253967]


portfolio before change:  [1.550944]
curr_Stock_Price:  101.8410026564335
curr_Factors:  [101.84100266  -0.65625359  -1.0840587 ]
mat_Sqrt:  [[17.86959221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01962759 -0.01101739 -0.42133366]
Stock Position:  -0.0196275936114595
Bond Position:  [3.54983781]


portfolio before change:  [1.51303489]
curr_Stock_Price:  103.8628741378808
curr_Factors:  [103.86287414  -0.83655674  -1.08589531]
mat_Sqrt:  [[15.18972886  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.009506    0.02795165 -0.24097711]
Stock Position:  -0.009506004695020217
Bond Position:  [2.50035586]


portfolio before change:  [1.51522502]
curr_Stock_Price:  103.76402686429076
curr_Factors:  [103.76402686  -0.98056357  -1.11003621]
mat_Sqrt:  [[12.82657985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01292009 -0.00240576 -0.56473977]
Stock Position:  0.012920089655182211
Bond Position:  [0.17458449]


portfolio before change:  [1.49603148]
curr_Stock_Price:  102.27171091340473
curr_Factors:  [102.27171091  -0.97135266  -1.15115868]
mat_Sqrt:  [[12.24504987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00251564 -0.03800576 -0.47968044]
Stock Position:  0.0025156438217299464
Bond Position:  [1.23875228]


portfolio before change:  [1.49924758]
curr_Stock_Price:  103.30388153315151
curr_Factors:  [103.30388153  -0.82408866  -1.14001005]
mat_Sqrt:  [[14.49170243  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00152844 -0.00306358 -0.31270473]
Stock Position:  0.001528443619157862
Bond Position:  [1.34135342]


portfolio before change:  [1.50308757]
curr_Stock_Price:  105.37732828173394
curr_Factors:  [105.37732828  -0.69876095  -1.09953423]
mat_Sqrt:  [[17.44847644  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00128125  0.0165687  -0.63694321]
Stock Position:  0.0012812543188426952
Bond Position:  [1.36807242]


portfolio before change:  [1.50317427]
curr_Stock_Price:  104.91097846676338
curr_Factors:  [104.91097847  -0.75492312  -1.03227561]
mat_Sqrt:  [[17.56509058  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01349015  0.04620991 -0.409664  ]
Stock Position:  0.0134901533108573
Bond Position:  [0.08790908]


portfolio before change:  [1.49609468]
curr_Stock_Price:  104.38292269539761
curr_Factors:  [104.3829227   -1.30659103  -0.98358474]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.49609468]
Stock Price:  104.90341716877204
PL:  [-3.40732249]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-2.65107135e-01  1.66422423e-02 -7.28372798e-02]
 [-1.23502686e-01  7.74971783e-02 -8.00720152e-02]
 [ 2.29175319e-01  1.11675080e-02 -1.24522830e-01]
 [ 6.73216183e-02 -1.26748307e-01 -1.65186116e-01]
 [-1.08897235e-02 -1.19894100e-02  6.39704286e-03]
 [ 3.47676644e-02  7.90557184e-02 -1.65433709e-01]
 [ 3.44743475e-01  2.09924358e-01 -2.30154448e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.37807344]
curr_Stock_Price:  99.89455786299831
curr_Factors:  [99.89455786 -0.99999083 -1.07003798]
mat_Sqrt:  [[12.60490971  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0048975   0.01250945 -0.27262553]
Stock Position:  -0.0048974966499613125
Bond Position:  [1.8673067]


portfolio before change:  [1.37228977]
curr_Stock_Price:  101.266188304146
curr_Factors:  [101.2661883   -1.03855788  -1.10964298]
mat_Sqrt:  [[11.81714823  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0236559   0.00526274 -0.20778449]
Stock Position:  -0.023655900392066494
Bond Position:  [3.76783264]


portfolio before change:  [1.33322798]
curr_Stock_Price:  102.99709596972241
curr_Factors:  [102.99709597  -0.76388591  -1.11854604]
mat_Sqrt:  [[15.67816281  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00879225  0.02450676 -0.22842317]
Stock Position:  -0.00879225143189871
Bond Position:  [2.23880434]


portfolio before change:  [1.31993137]
curr_Stock_Price:  104.63675497047166
curr_Factors:  [104.63675497  -0.54232097  -1.13120716]
mat_Sqrt:  [[19.62818885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01039554  0.00353148 -0.35522897]
Stock Position:  0.010395536147196247
Bond Position:  [0.2321762]


portfolio before change:  [1.3124728]
curr_Stock_Price:  103.9081070981292
curr_Factors:  [103.9081071   -0.24211367  -1.14992724]
mat_Sqrt:  [[25.82817671  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00117432 -0.04008133 -0.47123001]
Stock Position:  0.001174318915270132
Bond Position:  [1.19045154]


portfolio before change:  [1.3152099]
curr_Stock_Price:  105.73191111357006
curr_Factors:  [105.73191111  -0.35907634  -1.17753006]
mat_Sqrt:  [[22.74397681  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043499 -0.00379138  0.01824898]
Stock Position:  -0.00043499419175958864
Bond Position:  [1.36120267]


portfolio before change:  [1.31649227]
curr_Stock_Price:  104.34891260635384
curr_Factors:  [104.34891261  -0.44008091  -1.21442758]
mat_Sqrt:  [[19.95005153  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.52373526e-04  2.49996132e-02 -4.71936325e-01]
Stock Position:  0.00015237352643487605
Bond Position:  [1.30059226]


portfolio before change:  [1.31754692]
curr_Stock_Price:  107.00152166381383
curr_Factors:  [107.00152166  -0.45735673  -1.20978297]
mat_Sqrt:  [[20.20041913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01500878  0.06638391 -0.65656658]
Stock Position:  0.015008778635464242
Bond Position:  [-0.28841524]


portfolio before change:  [1.2927763]
curr_Stock_Price:  105.36072394834021
curr_Factors:  [105.36072395  -0.40670517  -1.18730679]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.2927763]
Stock Price:  107.27517499886837
PL:  [-5.9823987]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 2.40737302e-02 -6.52276214e-02  1.29720123e-01]
 [-1.97932708e-01  7.28309441e-02 -2.21225476e-02]
 [-9.67178491e-02  2.82943339e-02 -6.01957338e-02]
 [-4.94651506e-02 -1.08692303e-01 -5.76726168e-01]
 [ 2.45209640e-02 -6.03338803e-04 -6.34266165e-02]
 [ 7.96538341e-02  1.33172416e-01 -2.58701840e-03]
 [ 8.60315987e-02 -9.69161267e-02  6.98818736e-02]
 [ 1.01302857e-01  2.61660014e-02  9.34859653e-03]
 [-1.05869388e-01 -9.40627183e-02  1.33348600e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.72103522]
curr_Stock_Price:  98.48746839709155
curr_Factors:  [98.4874684  -1.23002675 -1.0118789 ]
mat_Sqrt:  [[10.46486713  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00466977 -0.02062678  0.3700554 ]
Stock Position:  0.004669774491663298
Bond Position:  [-9.18094949]


portfolio before change:  [-8.73267786]
curr_Stock_Price:  96.97754275138173
curr_Factors:  [96.97754275 -0.945085   -1.00707305]
mat_Sqrt:  [[13.76764647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01456806  0.02303117 -0.06310947]
Stock Position:  -0.014568064882889614
Bond Position:  [-7.31990272]


portfolio before change:  [-8.7538414]
curr_Stock_Price:  98.17898383542897
curr_Factors:  [98.17898384 -1.44479863 -0.96950711]
mat_Sqrt:  [[ 8.78008813  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01233185  0.00894745 -0.17172167]
Stock Position:  -0.012331846055633236
Bond Position:  [-7.54311328]


portfolio before change:  [-8.74140901]
curr_Stock_Price:  96.86491584907174
curr_Factors:  [96.86491585 -1.38502213 -0.93157237]
mat_Sqrt:  [[ 9.55173573  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01779732 -0.03437152 -1.64523923]
Stock Position:  -0.017797321327159058
Bond Position:  [-7.01747298]


portfolio before change:  [-8.71790885]
curr_Stock_Price:  95.34728425140402
curr_Factors:  [95.34728425 -1.07956402 -0.8758385 ]
mat_Sqrt:  [[13.49235639  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00085667 -0.00019079 -0.18093848]
Stock Position:  0.0008566688928172955
Bond Position:  [-8.7995899]


portfolio before change:  [-8.72068911]
curr_Stock_Price:  97.23906380060328
curr_Factors:  [97.2390638  -0.69940552 -0.94915253]
mat_Sqrt:  [[18.70170081  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0044148   0.04211282 -0.00738004]
Stock Position:  0.004414799432721878
Bond Position:  [-9.14998008]


portfolio before change:  [-8.72647036]
curr_Stock_Price:  96.96609346517094
curr_Factors:  [96.96609347 -1.14600982 -0.92432592]
mat_Sqrt:  [[12.23163502  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00799515 -0.03064757  0.19935353]
Stock Position:  0.007995154583916277
Bond Position:  [-9.50172926]


portfolio before change:  [-8.7271412]
curr_Stock_Price:  97.47655439593645
curr_Factors:  [97.4765544  -1.34365967 -0.8875601 ]
mat_Sqrt:  [[10.46872367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00992353 0.00827442 0.02666894]
Stock Position:  0.009923533909450616
Bond Position:  [-9.69445309]


portfolio before change:  [-8.72206185]
curr_Stock_Price:  98.47698267079488
curr_Factors:  [98.47698267 -1.04213316 -0.9124446 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.72206185]
Stock Price:  99.00393637766841
PL:  [-8.72206185]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 4.37542601e-02 -8.71465921e-02  1.74474746e-01]
 [-8.81110300e-02  7.56105821e-02  1.02411383e-02]
 [-9.18333902e-02  3.15449516e-02 -6.80741844e-02]
 [ 1.42756142e-01  2.12529997e-02 -6.71337257e-03]
 [ 2.32583875e-02 -9.85241618e-02 -1.36693896e-01]
 [-1.07211660e-02 -1.59778850e-02 -2.90187336e-03]
 [ 9.66140770e-02 -1.13900523e-02 -3.47653287e-01]
 [ 5.03736672e-01  3.88192799e-01 -4.25035346e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.70242649]
curr_Stock_Price:  98.35073303119408
curr_Factors:  [98.35073303 -0.31314374 -0.9966776 ]
mat_Sqrt:  [[26.54174186  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00290556 -0.02755817  0.49772789]
Stock Position:  0.002905561119900783
Bond Position:  [-9.98819056]


portfolio before change:  [-9.70485214]
curr_Stock_Price:  99.23514044703721
curr_Factors:  [99.23514045 -0.29148785 -0.99398009]
mat_Sqrt:  [[27.44061581  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306365  0.02391017  0.02921512]
Stock Position:  -0.003063645150082534
Bond Position:  [-9.40083088]


portfolio before change:  [-9.71545897]
curr_Stock_Price:  101.16266226153749
curr_Factors:  [101.16266226   0.16308428  -0.96367305]
mat_Sqrt:  [[45.42855934  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00230944  0.00997539 -0.1941967 ]
Stock Position:  -0.0023094390247369004
Bond Position:  [-9.48182997]


portfolio before change:  [-9.72162811]
curr_Stock_Price:  101.78057972596928
curr_Factors:  [101.78057973   0.20380211  -0.94399259]
mat_Sqrt:  [[48.55168187  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00292337  0.00672079 -0.01915138]
Stock Position:  0.0029233700004012665
Bond Position:  [-10.01917041]


portfolio before change:  [-9.73157949]
curr_Stock_Price:  100.09056640568286
curr_Factors:  [100.09056641   0.62727156  -0.93660583]
mat_Sqrt:  [[ 7.34600091e+01  0.00000000e+00  0.00000000e+00]
 [-8.16496581e-02  3.16227766e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [-9.78494314e-05 -3.11560756e-02 -3.89949637e-01]
Stock Position:  -9.784943136985698e-05
Bond Position:  [-9.72178568]


portfolio before change:  [-9.73692118]
curr_Stock_Price:  104.99185516638259
curr_Factors:  [104.99185517   0.29174136  -0.94794271]
mat_Sqrt:  [[54.47170694  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00021527 -0.00505265 -0.00827824]
Stock Position:  -0.00021526873846959942
Bond Position:  [-9.71431972]


portfolio before change:  [-9.7415286]
curr_Stock_Price:  103.82606965366244
curr_Factors:  [103.82606965   0.70676247  -0.93737279]
mat_Sqrt:  [[ 8.24429688e+01  0.00000000e+00  0.00000000e+00]
 [-8.16496581e-02  3.16227766e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [ 3.07552692e-04 -3.60185080e-03 -9.91758061e-01]
Stock Position:  0.00030755269222740777
Bond Position:  [-9.77346059]


portfolio before change:  [-9.74418092]
curr_Stock_Price:  111.09515582044405
curr_Factors:  [111.09515582   0.70731928  -0.98520635]
mat_Sqrt:  [[ 8.41415095e+01  0.00000000e+00  0.00000000e+00]
 [-8.16496581e-02  3.16227766e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [ 0.00507478  0.12275734 -1.21250754]
Stock Position:  0.005074781668952127
Bond Position:  [-10.30796458]


portfolio before change:  [-9.73866658]
curr_Stock_Price:  113.19763299400736
curr_Factors:  [113.19763299   0.15499077  -0.99296972]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.73866658]
Stock Price:  103.64717981812385
PL:  [-13.3858464]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 8.48689105e-02  5.10292882e-03 -6.54923291e-02]
 [-3.89179893e-01 -1.17233816e-01 -2.73014093e-01]
 [-1.24619634e-01  7.95489731e-02 -8.09008707e-02]
 [ 2.32433787e-01 -1.82907045e-02 -2.55979617e-01]
 [ 5.82216887e-02 -1.18755239e-01 -1.47506020e-01]
 [-6.60979761e-02 -1.87167603e-02  5.37659217e-02]
 [ 5.84513864e-02  7.12896374e-02 -1.86665530e-01]
 [ 3.01517292e-01  1.74996358e-01 -1.80063660e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.37142963]
curr_Stock_Price:  102.12288154730223
curr_Factors:  [102.12288155  -1.31755771  -1.06491739]
mat_Sqrt:  [[ 9.42816707  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00759767  0.00161369 -0.18683139]
Stock Position:  0.0075976699695658595
Bond Position:  [16.59553368]


portfolio before change:  [17.38494397]
curr_Stock_Price:  102.80920924099595
curr_Factors:  [102.80920924  -0.96165567  -1.03340186]
mat_Sqrt:  [[13.98265179  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0320351  -0.03707259 -0.77883321]
Stock Position:  -0.03203509836491507
Bond Position:  [20.6784471]


portfolio before change:  [17.3706925]
curr_Stock_Price:  103.57690719349267
curr_Factors:  [103.57690719  -1.10163422  -1.07903126]
mat_Sqrt:  [[11.70070298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01188642  0.02515559 -0.23078767]
Stock Position:  -0.011886423351662536
Bond Position:  [18.60185146]


portfolio before change:  [17.36988509]
curr_Stock_Price:  104.42751301003757
curr_Factors:  [104.42751301  -1.27785487  -1.11406258]
mat_Sqrt:  [[ 9.55033016  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01881714 -0.00578403 -0.7302386 ]
Stock Position:  0.018817140309904112
Bond Position:  [15.40485792]


portfolio before change:  [17.41178148]
curr_Stock_Price:  106.24458192876745
curr_Factors:  [106.24458193  -1.61309425  -1.17464742]
mat_Sqrt:  [[ 6.54042501  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0038294  -0.0375537  -0.42079362]
Stock Position:  0.003829399663822145
Bond Position:  [17.00492852]


portfolio before change:  [17.42254296]
curr_Stock_Price:  106.83393990033102
curr_Factors:  [106.8339399   -1.39106563  -1.2349333 ]
mat_Sqrt:  [[ 7.73129778  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00719237 -0.00591876  0.15337921]
Stock Position:  -0.007192365313679256
Bond Position:  [18.19093168]


portfolio before change:  [17.43093779]
curr_Stock_Price:  106.93167053989056
curr_Factors:  [106.93167054  -1.18083368  -1.23375111]
mat_Sqrt:  [[ 9.56016756  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.002321    0.02254376 -0.5325048 ]
Stock Position:  0.002320998554743149
Bond Position:  [17.18274953]


portfolio before change:  [17.43849709]
curr_Stock_Price:  106.48607842499113
curr_Factors:  [106.48607842  -0.74981481  -1.25595431]
mat_Sqrt:  [[14.32842223  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01879344  0.05533871 -0.5136715 ]
Stock Position:  0.01879343963283981
Bond Position:  [15.4372574]


portfolio before change:  [17.42775778]
curr_Stock_Price:  105.50382800102341
curr_Factors:  [105.503828    -1.33165715  -1.19591714]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.42775778]
Stock Price:  104.37158543590441
PL:  [13.05617235]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.51783158e-02  3.80353854e-02 -9.10601496e-02]
 [-6.89842197e-02  9.18943350e-02  2.88723347e-02]
 [-1.13599418e-01  5.93052087e-02 -7.27230761e-02]
 [ 2.44479365e-01 -1.56153121e-02 -2.47321798e-01]
 [ 6.64456351e-02 -1.29390501e-01 -1.62929737e-01]
 [ 2.60807696e-02 -1.94886660e-02 -9.86265075e-02]
 [ 7.16804902e-02  5.54558483e-02 -2.19295835e-01]
 [ 2.21215958e-01  1.14823946e-01 -1.02515657e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.44017654]
curr_Stock_Price:  99.76388248367282
curr_Factors:  [99.76388248 -1.35962658 -0.97493191]
mat_Sqrt:  [[ 9.66245466  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00649771  0.01202784 -0.25976926]
Stock Position:  -0.006497709312056142
Bond Position:  [1.08841324]


portfolio before change:  [0.43746182]
curr_Stock_Price:  100.26545347317541
curr_Factors:  [100.26545347  -1.36918993  -0.95309308]
mat_Sqrt:  [[ 9.83097581  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00617619  0.02905954  0.08236473]
Stock Position:  -0.006176190311264105
Bond Position:  [1.05672034]


portfolio before change:  [0.42462927]
curr_Stock_Price:  102.42876658892392
curr_Factors:  [102.42876659  -1.38425648  -0.9431312 ]
mat_Sqrt:  [[ 9.99195146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01270149  0.01875395 -0.20745869]
Stock Position:  -0.012701492882045109
Bond Position:  [1.72562752]


portfolio before change:  [0.39393172]
curr_Stock_Price:  104.91355957022002
curr_Factors:  [104.91355957  -1.34365678  -0.93293837]
mat_Sqrt:  [[10.76759988  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01797911 -0.004938   -0.70554025]
Stock Position:  0.017979106862183045
Bond Position:  [-1.49232038]


portfolio before change:  [0.38921505]
curr_Stock_Price:  104.6927295671404
curr_Factors:  [104.69272957  -1.5253715   -0.95831522]
mat_Sqrt:  [[ 8.73504377  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00341691 -0.04091687 -0.46479319]
Stock Position:  0.003416914015965677
Bond Position:  [0.031489]


portfolio before change:  [0.3854108]
curr_Stock_Price:  103.5747610119314
curr_Factors:  [103.57476101  -1.37591183  -0.95896381]
mat_Sqrt:  [[10.02836967  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00054301 -0.00616286 -0.28135397]
Stock Position:  0.0005430117833739142
Bond Position:  [0.32916848]


portfolio before change:  [0.38561748]
curr_Stock_Price:  103.65221999058663
curr_Factors:  [103.65221999  -0.98015354  -0.88831107]
mat_Sqrt:  [[15.99980678  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00177182  0.01753668 -0.62558998]
Stock Position:  0.0017718200891815267
Bond Position:  [0.2019644]


portfolio before change:  [0.38563566]
curr_Stock_Price:  103.60546970225782
curr_Factors:  [103.6054697   -0.83944577  -0.88928515]
mat_Sqrt:  [[18.39095938  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01105189  0.03631052 -0.29244863]
Stock Position:  0.011051885573786842
Bond Position:  [-0.75940014]


portfolio before change:  [0.39854965]
curr_Stock_Price:  104.80832218042481
curr_Factors:  [104.80832218  -1.06856831  -0.86846961]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.39854965]
Stock Price:  105.80925534212331
PL:  [-5.41070569]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 1.00107966e-01  1.00452457e-03 -6.19150300e-02]
 [-2.72639025e-01  2.01740085e-03 -9.65635694e-02]
 [-1.17332326e-01  6.61624336e-02 -7.54931625e-02]
 [ 1.16540877e-01 -4.35796316e-02 -3.47799815e-01]
 [ 6.73794463e-02 -1.26330689e-01 -1.65374593e-01]
 [ 4.46564057e-02 -1.01745394e-02 -1.09980874e-01]
 [ 7.06610699e-02  6.14670011e-02 -2.08124948e-01]
 [ 1.79349628e-01  8.35717226e-02 -6.24782162e-02]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.31305677]
curr_Stock_Price:  102.25407665313668
curr_Factors:  [102.25407665  -1.15255966  -1.06888354]
mat_Sqrt:  [[11.08970796  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0078898   0.00031766 -0.17662635]
Stock Position:  0.007889797458760676
Bond Position:  [17.50629282]


portfolio before change:  [18.31522179]
curr_Stock_Price:  101.41878081682223
curr_Factors:  [101.41878082  -1.22931665  -1.03370092]
mat_Sqrt:  [[10.55121177  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02770278  0.00063796 -0.27546899]
Stock Position:  -0.02770277941176887
Bond Position:  [21.12480391]


portfolio before change:  [18.27771521]
curr_Stock_Price:  103.15404451191449
curr_Factors:  [103.15404451  -1.52232158  -1.03686243]
mat_Sqrt:  [[ 7.9808063   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01641864  0.0209224  -0.21536098]
Stock Position:  -0.01641864134037276
Bond Position:  [19.97136447]


portfolio before change:  [18.29267374]
curr_Stock_Price:  102.85131854151462
curr_Factors:  [102.85131854  -1.35583472  -0.96955624]
mat_Sqrt:  [[10.05322498  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00441861 -0.01378109 -0.99217606]
Stock Position:  0.004418613525315709
Bond Position:  [17.83821351]


portfolio before change:  [18.30556668]
curr_Stock_Price:  103.75015466015152
curr_Factors:  [103.75015466  -1.34755297  -0.99474428]
mat_Sqrt:  [[ 9.97107495  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00304487 -0.03994927 -0.47176768]
Stock Position:  0.0030448727541113013
Bond Position:  [17.98966066]


portfolio before change:  [18.31152316]
curr_Stock_Price:  102.75155689796382
curr_Factors:  [102.7515569   -1.09888932  -0.94879674]
mat_Sqrt:  [[13.25835531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0016551  -0.00321747 -0.31374482]
Stock Position:  0.0016551033545753773
Bond Position:  [18.14145871]


portfolio before change:  [18.32291037]
curr_Stock_Price:  104.14978661579138
curr_Factors:  [104.14978662  -1.19820355  -0.9157564 ]
mat_Sqrt:  [[12.57700534  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00236661  0.01943757 -0.59372255]
Stock Position:  0.002366605807672888
Bond Position:  [18.07642888]


portfolio before change:  [18.328215]
curr_Stock_Price:  102.571218235266
curr_Factors:  [102.57121824  -0.93242405  -0.90184524]
mat_Sqrt:  [[16.38371867  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01030011  0.0264277  -0.17823296]
Stock Position:  0.010300111459376225
Bond Position:  [17.27172002]


portfolio before change:  [18.35409381]
curr_Stock_Price:  104.2450630951739
curr_Factors:  [104.2450631   -1.10561323  -0.93233637]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.35409381]
Stock Price:  104.42192200289692
PL:  [13.9321718]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 1.42014047e-02 -5.01124601e-02  9.72913475e-02]
 [-4.06198791e-02  7.90935143e-02  2.53967615e-02]
 [-7.95303416e-02 -3.27853877e-03 -4.74413634e-02]
 [-4.12387627e-02 -7.72531322e-02 -4.14685799e-01]
 [ 6.94606801e-02 -1.11300597e-01 -1.72157920e-01]
 [ 4.94499997e-02  9.45967787e-03 -9.52711488e-02]
 [ 2.37860416e-02  7.10765513e-03 -7.42396907e-03]
 [ 9.59620957e-02  2.38133498e-02  9.08031174e-03]
 [-1.04082568e-01 -1.03685619e-01  1.60306344e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.69499723]
curr_Stock_Price:  98.63042430593565
curr_Factors:  [98.63042431 -0.9931093  -1.0717943 ]
mat_Sqrt:  [[12.50934766  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0026194  -0.01584695  0.27754513]
Stock Position:  0.0026194027543959253
Bond Position:  [-7.95335003]


portfolio before change:  [-7.70034658]
curr_Stock_Price:  98.10676240039797
curr_Factors:  [98.1067624  -1.26412881 -1.0590902 ]
mat_Sqrt:  [[ 9.61031778  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347477  0.02501157  0.07244989]
Stock Position:  -0.0034747655392872124
Bond Position:  [-7.35944858]


portfolio before change:  [-7.70614273]
curr_Stock_Price:  98.71558228076682
curr_Factors:  [98.71558228 -0.72199417 -1.11873614]
mat_Sqrt:  [[15.66630934  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00570006 -0.00103676 -0.135337  ]
Stock Position:  -0.005700061124373438
Bond Position:  [-7.14345787]


portfolio before change:  [-7.71175742]
curr_Stock_Price:  99.0738365848703
curr_Factors:  [99.07383658 -1.1238136  -1.09577178]
mat_Sqrt:  [[10.76478353  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01187955 -0.02442959 -1.18298316]
Stock Position:  -0.01187955279082572
Bond Position:  [-6.53480455]


portfolio before change:  [-7.71945557]
curr_Stock_Price:  99.44674022523664
curr_Factors:  [99.44674023 -1.7251241  -1.10002324]
mat_Sqrt:  [[ 5.89718367  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00533226 -0.03519634 -0.49111863]
Stock Position:  0.005332261058765047
Bond Position:  [-8.24973155]


portfolio before change:  [-7.72170316]
curr_Stock_Price:  99.79899245574335
curr_Factors:  [99.79899246 -1.57792787 -1.1523413 ]
mat_Sqrt:  [[ 6.50706765  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00464835  0.00299141 -0.27178207]
Stock Position:  0.004648346592481427
Bond Position:  [-8.18560347]


portfolio before change:  [-7.72980027]
curr_Stock_Price:  98.93776499364878
curr_Factors:  [98.93776499 -1.19292845 -1.14682263]
mat_Sqrt:  [[ 9.53281383  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00235546  0.00224764 -0.02117852]
Stock Position:  0.002355458686406017
Bond Position:  [-7.96284409]


portfolio before change:  [-7.73173584]
curr_Stock_Price:  99.80674632543682
curr_Factors:  [99.80674633 -1.5707416  -1.15444131]
mat_Sqrt:  [[ 6.54075672  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01504879 0.00753044 0.0259036 ]
Stock Position:  0.01504878852802887
Bond Position:  [-9.23370646]


portfolio before change:  [-7.74963532]
curr_Stock_Price:  98.92418581778307
curr_Factors:  [98.92418582 -1.60951943 -1.17313321]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.74963532]
Stock Price:  98.43588211276106
PL:  [-7.74963532]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 3.66339420e-02 -7.99148547e-02  1.59974360e-01]
 [-2.08068405e-01  7.09647700e-02 -2.59282972e-02]
 [-6.78907050e-02 -1.91076452e-02 -4.46989878e-02]
 [ 7.26118148e-03 -5.55873328e-02 -3.57105772e-01]
 [ 6.87202172e-02 -1.16648015e-01 -1.69744543e-01]
 [ 6.51939238e-02  7.39456611e-02 -4.69590074e-02]
 [ 8.11140969e-02  5.11179729e-02 -4.93680928e-03]
 [ 8.97158298e-02  2.10618154e-02  8.76654033e-03]
 [-9.95129127e-02 -7.68175239e-02  1.21976831e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.42672375]
curr_Stock_Price:  98.38914616649471
curr_Factors:  [98.38914617 -0.7432261  -0.96756421]
mat_Sqrt:  [[17.78117275  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00378069 -0.0252713   0.45636232]
Stock Position:  0.003780694319832848
Bond Position:  [-9.79870303]


portfolio before change:  [-9.43698579]
curr_Stock_Price:  96.97103004499729
curr_Factors:  [96.97103004 -0.89316533 -0.95716534]
mat_Sqrt:  [[15.24240902  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01387764  0.02244103 -0.07396621]
Stock Position:  -0.013877641897468937
Bond Position:  [-8.09125656]


portfolio before change:  [-9.43483762]
curr_Stock_Price:  96.52464216967917
curr_Factors:  [96.52464217 -0.73616155 -0.92371863]
mat_Sqrt:  [[18.3552963   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00422266 -0.00604237 -0.12751377]
Stock Position:  -0.004222661606446012
Bond Position:  [-9.02724672]


portfolio before change:  [-9.45698719]
curr_Stock_Price:  100.70087613188036
curr_Factors:  [100.70087613  -1.09922787  -0.94221717]
mat_Sqrt:  [[13.07509746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00512944 -0.01757826 -1.01872337]
Stock Position:  -0.005129444576735798
Bond Position:  [-8.94044763]


portfolio before change:  [-9.45429511]
curr_Stock_Price:  99.30434573184112
curr_Factors:  [99.30434573 -1.33332956 -0.88750494]
mat_Sqrt:  [[10.77635987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00288218 -0.03688734 -0.48423393]
Stock Position:  0.002882180911901659
Bond Position:  [-9.7405082]


portfolio before change:  [-9.46008383]
curr_Stock_Price:  98.9860959143918
curr_Factors:  [98.98609591 -0.88849834 -0.87039472]
mat_Sqrt:  [[17.04891096  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00337369  0.02338367 -0.13396098]
Stock Position:  0.003373689114873521
Bond Position:  [-9.79403215]


portfolio before change:  [-9.46134706]
curr_Stock_Price:  100.06355686610843
curr_Factors:  [100.06355687  -0.76653078  -0.8517957 ]
mat_Sqrt:  [[19.83561536  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00410505  0.01616492 -0.01408334]
Stock Position:  0.004105052140970633
Bond Position:  [-9.87211317]


portfolio before change:  [-9.4711889]
curr_Stock_Price:  98.86879635386907
curr_Factors:  [98.86879635 -0.68308247 -0.83723355]
mat_Sqrt:  [[21.6169487   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00425819 0.00666033 0.0250085 ]
Stock Position:  0.004258191445484043
Bond Position:  [-9.89219116]


portfolio before change:  [-9.47670224]
curr_Stock_Price:  98.73587491026748
curr_Factors:  [98.73587491 -0.42390536 -0.81993579]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.47670224]
Stock Price:  98.22248049111364
PL:  [-9.47670224]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-7.28554921e-03  7.73487179e-02  3.39033711e-02]
 [-1.12089595e-01  5.65317132e-02 -7.16026779e-02]
 [-4.33081594e-02 -8.47482118e-02 -4.52844218e-01]
 [ 4.72118201e-02 -8.84031867e-02 -1.60644497e-01]
 [ 6.50056743e-02  7.31746045e-02 -4.75366740e-02]
 [ 9.81125206e-02 -1.07432466e-01  8.52534817e-02]
 [ 9.00685596e-02  2.12171959e-02  8.78425916e-03]
 [-1.09138298e-01 -9.91754100e-02  1.36462735e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.23859887]
curr_Stock_Price:  100.71109364556605
curr_Factors:  [100.71109365  -0.62131229  -1.00584478]
mat_Sqrt:  [[19.78845894  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311962  0.01250945 -0.27262553]
Stock Position:  -0.0031196215565156738
Bond Position:  [7.55277937]


portfolio before change:  [7.24713597]
curr_Stock_Price:  99.18534170924006
curr_Factors:  [99.18534171 -0.75703002 -1.02371566]
mat_Sqrt:  [[16.71396432  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [9.76478533e-05 2.44598123e-02 9.67168808e-02]
Stock Position:  9.764785331116445e-05
Bond Position:  [7.23745074]


portfolio before change:  [7.25099565]
curr_Stock_Price:  101.64368759597346
curr_Factors:  [101.6436876   -0.79688505  -1.08700273]
mat_Sqrt:  [[15.44963927  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00810671  0.0178769  -0.20426251]
Stock Position:  -0.008106712742668689
Bond Position:  [8.07499183]


portfolio before change:  [7.27668148]
curr_Stock_Price:  98.97339128977545
curr_Factors:  [98.97339129 -1.21684071 -1.03642605]
mat_Sqrt:  [[10.39769645  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01326571 -0.02679974 -1.29183851]
Stock Position:  -0.013265706338401068
Bond Position:  [8.58963343]


portfolio before change:  [7.30064306]
curr_Stock_Price:  97.49094618022475
curr_Factors:  [97.49094618 -0.91607984 -0.98402622]
mat_Sqrt:  [[14.58003973  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0008325  -0.02795554 -0.45827403]
Stock Position:  0.0008324969801346039
Bond Position:  [7.21948214]


portfolio before change:  [7.30536436]
curr_Stock_Price:  98.82507875536542
curr_Factors:  [98.82507876 -0.72283066 -1.01933185]
mat_Sqrt:  [[17.30834735  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00330428  0.02313984 -0.1356089 ]
Stock Position:  0.0033042814742109644
Bond Position:  [6.97881848]


portfolio before change:  [7.30247967]
curr_Stock_Price:  96.8957732276974
curr_Factors:  [96.89577323 -0.90204947 -1.00036081]
mat_Sqrt:  [[14.45767791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.007798   -0.03397313  0.24320445]
Stock Position:  0.007797996405825883
Bond Position:  [6.54688678]


portfolio before change:  [7.31617051]
curr_Stock_Price:  98.23157461927624
curr_Factors:  [98.23157462 -0.74200187 -0.9928921 ]
mat_Sqrt:  [[17.32990682  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00533237 0.00670947 0.02505905]
Stock Position:  0.005332369390726513
Bond Position:  [6.79236347]


portfolio before change:  [7.31416839]
curr_Stock_Price:  97.21905108328143
curr_Factors:  [97.21905108 -0.59447074 -0.97552786]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.31416839]
Stock Price:  97.60986139446385
PL:  [7.31416839]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-3.19510625e-02  1.22828056e-02 -3.42881017e-02]
 [-2.33641336e-01  4.33277028e-02 -2.84792278e-02]
 [-9.79918249e-02  3.06345847e-02 -6.11411158e-02]
 [-2.84440680e-02 -9.30270450e-02 -5.03924809e-01]
 [ 7.11331392e-02 -9.92225630e-02 -1.77608935e-01]
 [ 7.96538341e-02  1.33172416e-01 -2.58701840e-03]
 [ 1.08683201e-01 -1.22615521e-01  9.84761032e-02]
 [ 1.49225317e-01  7.86776328e-02  7.92114395e-03]
 [-1.30159994e-01 -1.67263634e-01  1.01226794e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.87157941]
curr_Stock_Price:  99.16313378707112
curr_Factors:  [99.16313379 -1.11002397 -1.02065376]
mat_Sqrt:  [[11.77629463  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328057  0.00388416 -0.09781441]
Stock Position:  -0.003280569350947159
Bond Position:  [-3.54626787]


portfolio before change:  [-3.87926532]
curr_Stock_Price:  100.96536339571287
curr_Factors:  [100.9653634   -1.21989095  -1.01076786]
mat_Sqrt:  [[10.84949699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02196746  0.01370142 -0.08124331]
Stock Position:  -0.021967462426296748
Bond Position:  [-1.6613125]


portfolio before change:  [-3.85037728]
curr_Stock_Price:  99.61250309450146
curr_Factors:  [99.61250309 -1.35202525 -1.04400312]
mat_Sqrt:  [[ 9.07260401  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01208928  0.00968751 -0.17441858]
Stock Position:  -0.012089276821811917
Bond Position:  [-2.64613415]


portfolio before change:  [-3.81568035]
curr_Stock_Price:  96.63297575635336
curr_Factors:  [96.63297576 -1.15397149 -0.93779588]
mat_Sqrt:  [[11.93115055  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01120673 -0.02941773 -1.43755721]
Stock Position:  -0.011206734530358784
Bond Position:  [-2.73274024]


portfolio before change:  [-3.82914203]
curr_Stock_Price:  97.71223485670389
curr_Factors:  [97.71223486 -1.40544599 -0.97615963]
mat_Sqrt:  [[ 9.02881529  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00357931 -0.03137693 -0.50666885]
Stock Position:  0.0035793125268809554
Bond Position:  [-4.17888465]


portfolio before change:  [-3.83343051]
curr_Stock_Price:  97.0980074667371
curr_Factors:  [97.09800747 -1.26870625 -0.91452394]
mat_Sqrt:  [[10.9407097   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00754652  0.04211282 -0.00738004]
Stock Position:  0.0075465175858685915
Bond Position:  [-4.56618233]


portfolio before change:  [-3.84357978]
curr_Stock_Price:  96.05572427611081
curr_Factors:  [96.05572428 -1.20070367 -0.81809195]
mat_Sqrt:  [[12.75767262  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00984652 -0.03877443  0.28092491]
Stock Position:  0.009846516373119882
Bond Position:  [-4.78939404]


portfolio before change:  [-3.86779351]
curr_Stock_Price:  93.83987028066703
curr_Factors:  [93.83987028 -1.31844343 -0.77300779]
mat_Sqrt:  [[11.58995307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01319019 0.02488005 0.02259682]
Stock Position:  0.013190188103922631
Bond Position:  [-5.10555905]


portfolio before change:  [-3.87428877]
curr_Stock_Price:  93.54102388855219
curr_Factors:  [93.54102389 -1.33505635 -0.7437161 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.87428877]
Stock Price:  91.77079176364111
PL:  [-3.87428877]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 2.25791563e-02 -6.06946529e-02  1.19374111e-01]
 [-2.03371498e-02  7.62794623e-02  2.96812657e-02]
 [-7.56279450e-02 -9.80698135e-03 -4.52251247e-02]
 [ 8.40601157e-02 -2.06928200e-02 -2.24569773e-01]
 [ 6.87225685e-02 -1.16631034e-01 -1.69752206e-01]
 [ 4.57614004e-02 -5.64856027e-03 -1.06590063e-01]
 [ 2.06224168e-02  1.13975680e-01 -9.80399149e-02]
 [ 1.24936613e-01  3.65768762e-02  1.05358014e-02]
 [-7.57920517e-02 -5.14759806e-02  1.95132681e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.25491492]
curr_Stock_Price:  98.55241204583255
curr_Factors:  [98.55241205 -0.77895659 -1.0031667 ]
mat_Sqrt:  [[16.58444521  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00273625 -0.01919333  0.34054111]
Stock Position:  0.002736248632634291
Bond Position:  [-8.52457882]


portfolio before change:  [-8.25763086]
curr_Stock_Price:  99.11793657640344
curr_Factors:  [99.11793658 -0.71776557 -1.0020059 ]
mat_Sqrt:  [[17.75272359  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069336  0.02412168  0.08467239]
Stock Position:  -0.0006933561211319342
Bond Position:  [-8.18890683]


portfolio before change:  [-8.26082028]
curr_Stock_Price:  97.81115904197017
curr_Factors:  [97.81115904 -0.70122331 -1.02565609]
mat_Sqrt:  [[17.39459061  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00489306 -0.00310124 -0.12901469]
Stock Position:  -0.004893055662176815
Bond Position:  [-7.78222483]


portfolio before change:  [-8.283296]
curr_Stock_Price:  101.60912118101739
curr_Factors:  [101.60912118  -0.75173356  -1.10411309]
mat_Sqrt:  [[15.88359244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00237262 -0.00654364 -0.64063505]
Stock Position:  0.0023726192099383938
Bond Position:  [-8.52437575]


portfolio before change:  [-8.28971358]
curr_Stock_Price:  100.70112539412725
curr_Factors:  [100.70112539  -0.5927826   -1.03541714]
mat_Sqrt:  [[19.76588046  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00157143 -0.03688197 -0.4842558 ]
Stock Position:  0.0015714272974238974
Bond Position:  [-8.44795808]


portfolio before change:  [-8.29172063]
curr_Stock_Price:  102.11257172834758
curr_Factors:  [102.11257173  -1.30928813  -1.05599204]
mat_Sqrt:  [[ 9.59071723  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00248761 -0.00178623 -0.30407178]
Stock Position:  0.002487608491462712
Bond Position:  [-8.54573673]


portfolio before change:  [-8.29296107]
curr_Stock_Price:  103.33201615889317
curr_Factors:  [103.33201616  -1.24638143  -1.12054814]
mat_Sqrt:  [[ 9.68925651  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00036669  0.03604227 -0.27968059]
Stock Position:  0.00036668885131340036
Bond Position:  [-8.33085177]


portfolio before change:  [-8.29737]
curr_Stock_Price:  102.67078668582745
curr_Factors:  [102.67078669  -1.55696875  -1.06885383]
mat_Sqrt:  [[ 7.43133145  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01722863 0.01156662 0.03005571]
Stock Position:  0.017228626650270723
Bond Position:  [-10.06624665]


portfolio before change:  [-8.30909338]
curr_Stock_Price:  102.28253754492424
curr_Factors:  [102.28253754  -1.37273981  -1.08196388]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.30909338]
Stock Price:  102.17588883601051
PL:  [-10.48498222]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 2.22275124e-02 -6.18588371e-02  1.22342655e-01]
 [-3.34250926e-02  7.59485153e-02  2.58245001e-02]
 [-8.68595512e-02  1.01849727e-02 -5.28801657e-02]
 [-4.47539823e-02 -8.99847900e-02 -4.79504314e-01]
 [ 6.87201038e-02 -1.16648834e-01 -1.69744173e-01]
 [ 5.52104259e-02  3.30539700e-02 -7.75945822e-02]
 [ 8.13674640e-02  3.42623089e-02 -2.60533325e-01]
 [ 1.83166131e-01  8.08577965e-02 -4.78277350e-02]
 [-6.69548596e-02 -4.02296596e-02  2.40252154e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.42997254]
curr_Stock_Price:  98.52802160346552
curr_Factors:  [98.5280216  -1.04255331 -0.96293946]
mat_Sqrt:  [[13.26127609  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00343884 -0.01956148  0.34900954]
Stock Position:  0.003438840553956256
Bond Position:  [-8.76879469]


portfolio before change:  [-8.43527426]
curr_Stock_Price:  98.26158644410664
curr_Factors:  [98.26158644 -1.24309632 -0.94841646]
mat_Sqrt:  [[10.98049359  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00238539  0.02401703  0.07367011]
Stock Position:  -0.002385385149347303
Bond Position:  [-8.20088253]


portfolio before change:  [-8.44049713]
curr_Stock_Price:  98.73169995343886
curr_Factors:  [98.73169995 -1.01890285 -0.94661805]
mat_Sqrt:  [[13.83062269  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00704167  0.00322077 -0.15085239]
Stock Position:  -0.007041671018882141
Bond Position:  [-7.74526098]


portfolio before change:  [-8.44204174]
curr_Stock_Price:  98.40095621118374
curr_Factors:  [98.40095621 -1.21800883 -0.93547154]
mat_Sqrt:  [[11.42232935  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01269056 -0.02845569 -1.36789234]
Stock Position:  -0.012690562788730767
Bond Position:  [-7.19327822]


portfolio before change:  [-8.45573042]
curr_Stock_Price:  99.19612502243793
curr_Factors:  [99.19612502 -0.80509958 -0.87029157]
mat_Sqrt:  [[18.57297929  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00167229 -0.0368876  -0.48423288]
Stock Position:  0.0016722874182562525
Bond Position:  [-8.62161485]


portfolio before change:  [-8.45951973]
curr_Stock_Price:  99.50861331656559
curr_Factors:  [99.50861332 -0.69515436 -0.83314455]
mat_Sqrt:  [[21.58384882  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186366  0.01045258 -0.22135574]
Stock Position:  0.001863659642479489
Bond Position:  [-8.64496992]


portfolio before change:  [-8.45728319]
curr_Stock_Price:  103.02862761062893
curr_Factors:  [103.02862761  -0.49772089  -0.82806222]
mat_Sqrt:  [[27.36387677  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00106238  0.01083469 -0.74322906]
Stock Position:  0.001062384949122738
Bond Position:  [-8.56673925]


portfolio before change:  [-8.4611522]
curr_Stock_Price:  103.41966441272103
curr_Factors:  [103.41966441  -1.2898728   -0.80309423]
mat_Sqrt:  [[12.75378496  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01375992  0.02556948 -0.13643922]
Stock Position:  0.013759921083409486
Bond Position:  [-9.88419862]


portfolio before change:  [-8.46254373]
curr_Stock_Price:  103.67779082499791
curr_Factors:  [103.67779082  -1.591901    -0.77611942]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.46254373]
Stock Price:  103.22970953186581
PL:  [-11.69225326]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-5.83011946e-03  2.94956020e-02 -8.67835154e-02]
 [-3.22783687e-01 -4.94155112e-02 -1.72703291e-01]
 [-1.25688152e-01  8.15118060e-02 -8.16937887e-02]
 [ 2.68732774e-01  1.02338613e-02 -1.38887641e-01]
 [ 5.97967223e-02 -1.20792083e-01 -1.50459939e-01]
 [-9.86173366e-02 -2.80878019e-02  6.78033993e-02]
 [ 8.26895119e-02  4.32130680e-02 -2.44762969e-01]
 [ 2.20800185e-01  1.15867714e-01 -1.06572769e-01]
 [-8.42150757e-02 -8.17773114e-02 -4.16523446e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.15060006]
curr_Stock_Price:  101.25614527850053
curr_Factors:  [101.25614528  -1.32110341  -1.00716354]
mat_Sqrt:  [[ 9.86888075  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00230859  0.00932733 -0.24756921]
Stock Position:  -0.0023085857208756783
Bond Position:  [11.38435855]


portfolio before change:  [11.1545687]
curr_Stock_Price:  102.00334114264695
curr_Factors:  [102.00334114  -1.02658342  -1.02581606]
mat_Sqrt:  [[13.09991957  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0274286  -0.01562656 -0.49267442]
Stock Position:  -0.02742860361884633
Bond Position:  [13.95237791]


portfolio before change:  [11.13774625]
curr_Stock_Price:  102.87106235745124
curr_Factors:  [102.87106236  -0.22593344  -1.04355038]
mat_Sqrt:  [[28.90436317  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00485253  0.0257763  -0.23304964]
Stock Position:  -0.004852526953717498
Bond Position:  [11.63693085]


portfolio before change:  [11.13157355]
curr_Stock_Price:  105.34247929449059
curr_Factors:  [105.34247929  -0.90611611  -1.04301261]
mat_Sqrt:  [[15.00056748  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01604251  0.00323623 -0.39620778]
Stock Position:  0.01604250576919107
Bond Position:  [9.44161622]


portfolio before change:  [11.14695936]
curr_Stock_Price:  106.00720206260087
curr_Factors:  [106.00720206  -1.43821363  -0.9964473 ]
mat_Sqrt:  [[ 9.28914113  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00279524 -0.03819781 -0.42922033]
Stock Position:  0.002795239872848482
Bond Position:  [10.8506438]


portfolio before change:  [11.15376292]
curr_Stock_Price:  106.4997833745058
curr_Factors:  [106.49978337  -1.22411211  -0.97072654]
mat_Sqrt:  [[11.86157633  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00720834 -0.00888214  0.19342423]
Stock Position:  -0.007208337843452966
Bond Position:  [11.92144934]


portfolio before change:  [11.17291504]
curr_Stock_Price:  104.66997085363448
curr_Factors:  [104.66997085  -0.96746748  -0.91794408]
mat_Sqrt:  [[15.88540414  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213046  0.01366517 -0.69824062]
Stock Position:  0.0021304611712485294
Bond Position:  [10.94991973]


portfolio before change:  [11.17552492]
curr_Stock_Price:  103.32450991800006
curr_Factors:  [103.32450992  -0.74155143  -0.87686726]
mat_Sqrt:  [[20.480146    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00986506  0.03664059 -0.30402245]
Stock Position:  0.009865056680597903
Bond Position:  [10.15622277]


portfolio before change:  [11.18320757]
curr_Stock_Price:  103.58839735117243
curr_Factors:  [103.58839735  -1.08102739  -0.85542041]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.18320757]
Stock Price:  100.5141265185834
PL:  [10.66908105]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.59419988e-02  3.11842552e-02 -7.41433682e-02]
 [-2.84041524e-01  8.63520745e-03 -8.12561198e-02]
 [-1.21120632e-01  7.31214247e-02 -7.83043590e-02]
 [ 2.40998506e-01  1.06178119e-02 -1.27110748e-01]
 [ 6.77920163e-02 -1.23351224e-01 -1.66719275e-01]
 [ 4.40872404e-02 -1.25057994e-02 -1.11727426e-01]
 [ 9.31774370e-02  3.96180346e-02 -2.54446900e-01]
 [ 2.97815772e-01  1.69292228e-01 -1.66848647e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.6880015]
curr_Stock_Price:  99.32803942989207
curr_Factors:  [99.32803943 -1.10104457 -0.94418358]
mat_Sqrt:  [[12.84814897  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00469105  0.00986133 -0.21151039]
Stock Position:  -0.004691047454340642
Bond Position:  [-2.22204895]


portfolio before change:  [-2.69870222]
curr_Stock_Price:  101.37223425462224
curr_Factors:  [101.37223425  -1.14083593  -0.89070903]
mat_Sqrt:  [[13.29322181  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02259835  0.00273069 -0.23180109]
Stock Position:  -0.022598351527269606
Bond Position:  [-0.40785683]


portfolio before change:  [-2.72802071]
curr_Stock_Price:  102.66058113315682
curr_Factors:  [102.66058113  -0.8353634   -0.88364306]
mat_Sqrt:  [[18.40130819  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0073482   0.02312302 -0.22338054]
Stock Position:  -0.00734819795520644
Bond Position:  [-1.97365044]


portfolio before change:  [-2.74494806]
curr_Stock_Price:  104.82985862021009
curr_Factors:  [104.82985862  -0.84358992  -0.9157593 ]
mat_Sqrt:  [[18.04717973  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0119313   0.00335765 -0.36261158]
Stock Position:  0.011931298244229435
Bond Position:  [-3.99570437]


portfolio before change:  [-2.76720339]
curr_Stock_Price:  103.13205740118981
curr_Factors:  [103.1320574   -0.69648903  -0.90857538]
mat_Sqrt:  [[20.71681883  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147589 -0.03900708 -0.47560369]
Stock Position:  0.0014758864359691144
Bond Position:  [-2.91941459]


portfolio before change:  [-2.76856061]
curr_Stock_Price:  103.20174396231866
curr_Factors:  [103.20174396  -0.85159302  -0.94728949]
mat_Sqrt:  [[17.07820761  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00122718 -0.00395468 -0.31872725]
Stock Position:  0.00122718245033582
Bond Position:  [-2.89520798]


portfolio before change:  [-2.76642378]
curr_Stock_Price:  106.12290678185086
curr_Factors:  [106.12290678  -1.29874832  -0.95364999]
mat_Sqrt:  [[11.15847841  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0037874   0.01252832 -0.72586618]
Stock Position:  0.0037873993873558335
Bond Position:  [-3.16835361]


portfolio before change:  [-2.76806241]
curr_Stock_Price:  106.10863348168587
curr_Factors:  [106.10863348  -0.87491023  -0.92009888]
mat_Sqrt:  [[17.62739637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01521093  0.0535349  -0.47597275]
Stock Position:  0.015210927110856785
Bond Position:  [-4.3820731]


portfolio before change:  [-2.73820155]
curr_Stock_Price:  108.21583186837086
curr_Factors:  [108.21583187  -0.73275107  -1.02095774]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.73820155]
Stock Price:  108.05940798495202
PL:  [-10.79760954]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 1.99646928e-02  2.25583236e-02 -8.07283001e-02]
 [-3.61972588e-01 -8.94437751e-02 -2.31909537e-01]
 [-1.29645388e-01  8.87811141e-02 -8.46303428e-02]
 [ 2.28367564e-01  1.06194702e-02 -1.25342815e-01]
 [ 5.76309949e-02 -1.17991349e-01 -1.46398195e-01]
 [-1.73456159e-01 -8.80073651e-02  1.08250064e-01]
 [ 1.06658505e-01  2.34322431e-02 -2.87789803e-01]
 [ 3.24426142e-01  1.91806959e-01 -2.01016710e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.15677071]
curr_Stock_Price:  101.39633310779219
curr_Factors:  [101.39633311  -1.21198306  -0.98532802]
mat_Sqrt:  [[11.26528469  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00036116  0.00713357 -0.23029537]
Stock Position:  0.0003611582890541299
Bond Position:  [12.12015058]


portfolio before change:  [12.16322307]
curr_Stock_Price:  102.4783114601231
curr_Factors:  [102.47831146  -1.07057772  -0.98077746]
mat_Sqrt:  [[13.17466943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03124332 -0.02828461 -0.66157336]
Stock Position:  -0.031243315404568876
Bond Position:  [15.36498527]


portfolio before change:  [12.10966561]
curr_Stock_Price:  104.43847043225483
curr_Factors:  [104.43847043  -1.28781257  -0.97342045]
mat_Sqrt:  [[10.88477565  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0132872   0.02807505 -0.24142681]
Stock Position:  -0.013287197662221393
Bond Position:  [13.49736021]


portfolio before change:  [12.11280378]
curr_Stock_Price:  104.71032652265043
curr_Factors:  [104.71032652  -0.78675178  -0.92861719]
mat_Sqrt:  [[18.83710824  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01077959  0.00335817 -0.35756816]
Stock Position:  0.01077958784218154
Bond Position:  [10.98406961]


portfolio before change:  [12.13751711]
curr_Stock_Price:  106.49331930463208
curr_Factors:  [106.4933193   -1.1087367   -0.92129301]
mat_Sqrt:  [[13.98594001  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00176614 -0.03731214 -0.4176333 ]
Stock Position:  0.0017661354833763754
Bond Position:  [11.94943548]


portfolio before change:  [12.14578001]
curr_Stock_Price:  107.78805677014526
curr_Factors:  [107.78805677  -0.95864526  -0.91819914]
mat_Sqrt:  [[16.49937431  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00931139 -0.02783037  0.3088073 ]
Stock Position:  -0.009311386274222538
Bond Position:  [13.14943624]


portfolio before change:  [12.16451532]
curr_Stock_Price:  106.48224119086886
curr_Factors:  [106.48224119  -1.20708996  -0.91896538]
mat_Sqrt:  [[12.70407593  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00381914  0.00740993 -0.8209842 ]
Stock Position:  0.0038191424445362834
Bond Position:  [11.75784447]


portfolio before change:  [12.16976218]
curr_Stock_Price:  106.31635722713092
curr_Factors:  [106.31635723  -0.63134993  -0.92099744]
mat_Sqrt:  [[22.51252404  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01280826  0.06065469 -0.57344472]
Stock Position:  0.012808257829901571
Bond Position:  [10.80803486]


portfolio before change:  [12.18373403]
curr_Stock_Price:  106.98518229167068
curr_Factors:  [106.98518229  -0.31406533  -0.96866887]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.18373403]
Stock Price:  109.20960776751933
PL:  [2.97412626]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-5.75325501e-01 -3.07366359e-01 -5.54241230e-01]
 [-1.30374410e-01  9.01203029e-02 -8.51713296e-02]
 [ 3.66102307e-01  8.30859048e-03 -1.92218275e-01]
 [ 4.30327020e-02 -9.91127401e-02 -1.19019620e-01]
 [-4.27895148e-01 -3.44842039e-01  1.89981836e-01]
 [ 1.69633489e-01 -6.32226410e-02 -4.63503086e-01]
 [ 4.52524880e-01  3.40587742e-01 -3.49197836e-01]
 [-8.03913616e-02 -9.24743101e-02 -2.87385188e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.74412848]
curr_Stock_Price:  100.22421577983368
curr_Factors:  [100.22421578  -0.42791866  -1.02185493]
mat_Sqrt:  [[23.51494647  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262525  0.01250945 -0.27262553]
Stock Position:  -0.0026252453161792555
Bond Position:  [4.00724163]


portfolio before change:  [3.73343375]
curr_Stock_Price:  105.06142123413841
curr_Factors:  [105.06142123  -0.66962097  -1.08937458]
mat_Sqrt:  [[18.09344274  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03848884 -0.09719778 -1.58109596]
Stock Position:  -0.0384888433552299
Bond Position:  [7.77712634]


portfolio before change:  [3.80399067]
curr_Stock_Price:  103.32929901731194
curr_Factors:  [103.32929902  -0.3216721   -1.07061294]
mat_Sqrt:  [[25.67803416  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00566371  0.02849854 -0.2429701 ]
Stock Position:  -0.005663713873028094
Bond Position:  [4.38921825]


portfolio before change:  [3.77941343]
curr_Stock_Price:  108.05630236927246
curr_Factors:  [108.05630237  -0.45498108  -1.05568369]
mat_Sqrt:  [[23.85485204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01371128  0.00262741 -0.54834524]
Stock Position:  0.013711275289221914
Bond Position:  [2.29782372]


portfolio before change:  [3.7996174]
curr_Stock_Price:  109.44601801755394
curr_Factors:  [109.44601802  -0.29241339  -0.98892176]
mat_Sqrt:  [[30.38947381  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00053238 -0.0313422  -0.33952985]
Stock Position:  0.0005323831526776932
Bond Position:  [3.74135019]


portfolio before change:  [3.80364808]
curr_Stock_Price:  113.50236767970746
curr_Factors:  [113.50236768  -0.79943694  -0.99998278]
mat_Sqrt:  [[18.77270545  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02120201 -0.10904863  0.5419653 ]
Stock Position:  -0.021202008015032033
Bond Position:  [6.21012619]


portfolio before change:  [3.87256431]
curr_Stock_Price:  110.39839774727778
curr_Factors:  [110.39839775  -0.39886482  -0.99511702]
mat_Sqrt:  [[27.38824142  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00267958 -0.01999275 -1.32224529]
Stock Position:  0.002679577512895756
Bond Position:  [3.57674325]


portfolio before change:  [3.8828895]
curr_Stock_Price:  113.58411293916781
curr_Factors:  [113.58411294  -0.56176176  -0.98617794]
mat_Sqrt:  [[24.15771874  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01614553  0.1077033  -0.99616423]
Stock Position:  0.016145527340953224
Bond Position:  [2.0490141]


portfolio before change:  [3.98206183]
curr_Stock_Price:  119.66304509001758
curr_Factors:  [119.66304509  -0.49671187  -0.98024928]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.98206183]
Stock Price:  118.26959244672513
PL:  [-14.28753061]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [ 4.91750789e-02  8.48104646e-02  5.36107943e-02]
 [-1.03302763e-01  4.03905988e-02 -6.50822148e-02]
 [-5.61963890e-02 -1.12442710e-01 -6.24545782e-01]
 [ 6.87215561e-02 -1.16638346e-01 -1.69748907e-01]
 [ 5.27626736e-02  2.30281521e-02 -8.51058073e-02]
 [ 6.06991630e-02 -7.80343767e-03  4.01984623e-02]
 [ 1.08071898e-01  3.22303235e-02  1.21915591e-02]
 [-1.18792315e-01 -1.28346854e-01  1.27563895e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.27366934]
curr_Stock_Price:  100.5766518621746
curr_Factors:  [100.57665186  -1.0895886   -0.94052485]
mat_Sqrt:  [[13.20778845  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00467395  0.01250945 -0.27262553]
Stock Position:  -0.004673946989257336
Bond Position:  [6.74375928]


portfolio before change:  [6.28201172]
curr_Stock_Price:  99.51338294498483
curr_Factors:  [99.51338294 -1.29642931 -0.96944054]
mat_Sqrt:  [[10.32349419  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00603557 0.02681942 0.15293667]
Stock Position:  0.0060355662577767635
Bond Position:  [5.68139211]


portfolio before change:  [6.29100151]
curr_Stock_Price:  100.53207472142695
curr_Factors:  [100.53207472  -1.90100398  -0.93888249]
mat_Sqrt:  [[ 5.87432029  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01966946  0.01277263 -0.18566144]
Stock Position:  -0.01966946434536858
Bond Position:  [8.26841357]


portfolio before change:  [6.29935106]
curr_Stock_Price:  100.31781855135874
curr_Factors:  [100.31781855  -1.84674672  -0.92540155]
mat_Sqrt:  [[ 6.27262583  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02974584 -0.03555751 -1.78165528]
Stock Position:  -0.02974583951623413
Bond Position:  [9.28338879]


portfolio before change:  [6.3098914]
curr_Stock_Price:  100.11955584442833
curr_Factors:  [100.11955584  -1.84944697  -0.9356534 ]
mat_Sqrt:  [[ 6.17966869  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00502618 -0.03688428 -0.48424638]
Stock Position:  0.005026178270940874
Bond Position:  [5.80667267]


portfolio before change:  [6.31079752]
curr_Stock_Price:  99.72204833510573
curr_Factors:  [99.72204834 -1.39396935 -0.96841388]
mat_Sqrt:  [[ 9.39336482  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00383091  0.00728214 -0.24278318]
Stock Position:  0.003830907072003695
Bond Position:  [5.92877162]


portfolio before change:  [6.31007238]
curr_Stock_Price:  98.75875937130003
curr_Factors:  [98.75875937 -1.060816   -0.97400121]
mat_Sqrt:  [[12.90820162  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00532244 -0.00246766  0.11467502]
Stock Position:  0.005322442110724878
Bond Position:  [5.7844346]


portfolio before change:  [6.30314949]
curr_Stock_Price:  96.91452606435607
curr_Factors:  [96.91452606 -0.73893129 -1.02325435]
mat_Sqrt:  [[16.63724354  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00669538 0.01019212 0.03477912]
Stock Position:  0.006695380313269471
Bond Position:  [5.65426988]


portfolio before change:  [6.30333073]
curr_Stock_Price:  96.5192373200579
curr_Factors:  [96.51923732 -0.96207777 -1.03057106]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.30333073]
Stock Price:  97.9013609407738
PL:  [6.30333073]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-2.84168158e-01 -9.97290111e-03 -1.14363292e-01]
 [-9.70382659e-02  2.88829289e-02 -6.04335062e-02]
 [ 4.51599011e-02 -1.19756083e-02 -1.48545350e-01]
 [ 6.86109254e-02 -1.17437289e-01 -1.69388330e-01]
 [ 4.66787071e-02 -1.89133793e-03 -1.03775197e-01]
 [ 4.31236415e-02  7.13305979e-02 -1.81931770e-01]
 [ 1.93380070e-01  1.01716345e-01 -1.01131990e-01]
 [-9.25916790e-02 -7.90614914e-02  4.79457265e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.35453749]
curr_Stock_Price:  100.44859098287793
curr_Factors:  [100.44859098  -1.09752424  -1.03869366]
mat_Sqrt:  [[11.86304571  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00520377  0.01250945 -0.27262553]
Stock Position:  -0.005203765087545841
Bond Position:  [5.87724836]


portfolio before change:  [5.35157126]
curr_Stock_Price:  101.58345940476194
curr_Factors:  [101.5834594   -1.26872335  -1.09730794]
mat_Sqrt:  [[ 9.5338577   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03228179 -0.00315371 -0.32624664]
Stock Position:  -0.03228178733058593
Bond Position:  [8.6308669]


portfolio before change:  [5.39402834]
curr_Stock_Price:  100.4019708285318
curr_Factors:  [100.40197083  -0.74206606  -1.06969968]
mat_Sqrt:  [[16.40221024  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00662279  0.00913358 -0.17239997]
Stock Position:  -0.006622793396569614
Bond Position:  [6.05896985]


portfolio before change:  [5.39602662]
curr_Stock_Price:  100.5577911476133
curr_Factors:  [100.55779115  -0.44716377  -1.05285136]
mat_Sqrt:  [[22.43713655  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00064754 -0.00378702 -0.42375854]
Stock Position:  0.0006475425028355558
Bond Position:  [5.33091117]


portfolio before change:  [5.3994319]
curr_Stock_Price:  101.69928153758865
curr_Factors:  [101.69928154  -0.47850065  -1.04237504]
mat_Sqrt:  [[22.22337242  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00139504 -0.03713693 -0.48321776]
Stock Position:  0.0013950384738146127
Bond Position:  [5.25755749]


portfolio before change:  [5.39969251]
curr_Stock_Price:  100.00124491999587
curr_Factors:  [100.00124492  -0.52349978  -1.02757954]
mat_Sqrt:  [[21.20216539  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012002  -0.00059809 -0.29604175]
Stock Position:  0.001200200507910119
Bond Position:  [5.27967097]


portfolio before change:  [5.40622618]
curr_Stock_Price:  103.24501227554383
curr_Factors:  [103.24501228  -0.43598989  -1.06955804]
mat_Sqrt:  [[22.90962207  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.41722027e-04  2.25567156e-02 -5.19000701e-01]
Stock Position:  0.00034172202701304326
Bond Position:  [5.37094508]


portfolio before change:  [5.40844263]
curr_Stock_Price:  101.87051283507007
curr_Factors:  [101.87051284  -0.39583379  -1.02918987]
mat_Sqrt:  [[24.50014078  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00715763  0.03216553 -0.28850142]
Stock Position:  0.007157628020330679
Bond Position:  [4.67929139]


portfolio before change:  [5.40744104]
curr_Stock_Price:  101.40362427661127
curr_Factors:  [101.40362428  -0.27407411  -1.04499779]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.40744104]
Stock Price:  104.21323815253122
PL:  [1.19420289]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.26440368e-02  2.84473424e-02 -6.89109859e-02]
 [-1.61915597e-01  6.97447409e-02  1.75900573e-03]
 [-1.02795073e-01  3.94579903e-02 -6.47054726e-02]
 [ 8.24023261e-03 -6.28961139e-02 -3.99253578e-01]
 [ 6.87210042e-02 -1.16642331e-01 -1.69747108e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 9.91419777e-03  1.29851023e-01 -6.61008985e-02]
 [ 1.14697446e-01  3.46074941e-02  1.66206395e-03]
 [-6.58365055e-02 -3.39272398e-02  2.94245471e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.76515373]
curr_Stock_Price:  99.3172899580269
curr_Factors:  [99.31728996 -0.84945911 -1.032166  ]
mat_Sqrt:  [[15.13022748  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00369961  0.00899584 -0.19658386]
Stock Position:  -0.0036996089920873234
Bond Position:  [-2.39771859]


portfolio before change:  [-2.77106827]
curr_Stock_Price:  100.59185186103511
curr_Factors:  [100.59185186  -1.06470988  -0.9910476 ]
mat_Sqrt:  [[12.87533907  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01240789  0.02205522  0.00501795]
Stock Position:  -0.012407886046272597
Bond Position:  [-1.52293603]


portfolio before change:  [-2.77472042]
curr_Stock_Price:  100.82480836214935
curr_Factors:  [100.82480836  -1.10219857  -1.01545774]
mat_Sqrt:  [[12.1305629   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00947889  0.01247771 -0.1845867 ]
Stock Position:  -0.009478885904040583
Bond Position:  [-1.81901357]


portfolio before change:  [-2.77438625]
curr_Stock_Price:  100.69357971532733
curr_Factors:  [100.69357972  -1.19718989  -1.06615278]
mat_Sqrt:  [[10.47235968  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00715035 -0.0198895  -1.13895933]
Stock Position:  -0.007150349650499508
Bond Position:  [-2.05439195]


portfolio before change:  [-2.76966833]
curr_Stock_Price:  99.89007008254573
curr_Factors:  [99.89007008 -0.84342665 -1.081998  ]
mat_Sqrt:  [[14.5653532   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213245 -0.03688554 -0.48424125]
Stock Position:  0.0021324459797104267
Bond Position:  [-2.98267851]


portfolio before change:  [-2.76986698]
curr_Stock_Price:  100.49644764889813
curr_Factors:  [100.49644765  -1.0932357   -1.05631807]
mat_Sqrt:  [[11.71146883  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00201964 -0.00193948 -0.30510753]
Stock Position:  0.0020196446739852393
Bond Position:  [-2.97283409]


portfolio before change:  [-2.76731124]
curr_Stock_Price:  102.49805220014642
curr_Factors:  [102.4980522   -1.49373886  -1.06573745]
mat_Sqrt:  [[ 7.92773589  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.84889214e-05  4.10624988e-02 -1.88567464e-01]
Stock Position:  -2.8488921445771778e-05
Bond Position:  [-2.76439118]


portfolio before change:  [-2.76866454]
curr_Stock_Price:  101.4718012405676
curr_Factors:  [101.47180124  -1.16725525  -1.07662474]
mat_Sqrt:  [[10.76070366  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01077348 0.01094385 0.00474141]
Stock Position:  0.010773484542229032
Bond Position:  [-3.86186942]


portfolio before change:  [-2.75723998]
curr_Stock_Price:  102.71150991854601
curr_Factors:  [102.71150992  -1.55775849  -1.07430092]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.75723998]
Stock Price:  102.76461662045904
PL:  [-5.5218566]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [ 9.05896276e-04  7.72203942e-02  3.61465847e-02]
 [-1.08183161e-01  4.93557261e-02 -6.87038224e-02]
 [-3.82551902e-02 -6.64470292e-02 -3.59670532e-01]
 [ 6.87194984e-02 -1.16653206e-01 -1.69742200e-01]
 [ 5.02723819e-02  1.28280961e-02 -9.27475694e-02]
 [-1.78782318e-02  1.30134825e-01 -5.71390100e-02]
 [ 1.17506881e-01  3.33040149e-02  1.01625804e-02]
 [-8.73584258e-02 -7.17473197e-02  8.11393047e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.43195467]
curr_Stock_Price:  100.73803353909396
curr_Factors:  [100.73803354  -1.01944319  -1.05567896]
mat_Sqrt:  [[12.64676267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00488129  0.01250945 -0.27262553]
Stock Position:  -0.004881288965935524
Bond Position:  [7.92368612]


portfolio before change:  [7.44503014]
curr_Stock_Price:  98.87118251383723
curr_Factors:  [98.87118251 -1.0498924  -0.98308308]
mat_Sqrt:  [[12.94671819  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00079388 0.02441923 0.10311614]
Stock Position:  0.0007938775549624118
Bond Position:  [7.36653853]


portfolio before change:  [7.45067171]
curr_Stock_Price:  101.33676978941571
curr_Factors:  [101.33676979  -0.58715791  -0.98530827]
mat_Sqrt:  [[21.03069723  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0057503   0.01560765 -0.19599288]
Stock Position:  -0.005750304395018571
Bond Position:  [8.03338898]


portfolio before change:  [7.4691319]
curr_Stock_Price:  98.82516507972049
curr_Factors:  [98.82516508 -0.94938036 -0.96574757]
mat_Sqrt:  [[14.55921822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00778808 -0.0210124  -1.02603991]
Stock Position:  -0.007788075101897605
Bond Position:  [8.23878971]


portfolio before change:  [7.4723153]
curr_Stock_Price:  98.94548014030276
curr_Factors:  [98.94548014 -0.69500368 -0.9707138 ]
mat_Sqrt:  [[18.70613443  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00166037 -0.03688898 -0.48422725]
Stock Position:  0.0016603667725242517
Bond Position:  [7.30802951]


portfolio before change:  [7.47716383]
curr_Stock_Price:  99.66436063166712
curr_Factors:  [99.66436063 -0.87163937 -1.02635719]
mat_Sqrt:  [[14.93655524  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00212041  0.0040566  -0.264583  ]
Stock Position:  0.0021204074881759133
Bond Position:  [7.26583478]


portfolio before change:  [7.48264207]
curr_Stock_Price:  100.53419972791845
curr_Factors:  [100.53419973  -1.62243188  -1.0559117 ]
mat_Sqrt:  [[ 6.90436885  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00379204  0.04115225 -0.16300169]
Stock Position:  -0.0037920362035481652
Bond Position:  [7.8638714]


portfolio before change:  [7.48065877]
curr_Stock_Price:  102.09436962117198
curr_Factors:  [102.09436962  -1.42935797  -1.09188896]
mat_Sqrt:  [[ 8.20423637  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01468037 0.01053165 0.02899101]
Stock Position:  0.014680368737676803
Bond Position:  [5.98187578]


portfolio before change:  [7.47930054]
curr_Stock_Price:  101.79806131286841
curr_Factors:  [101.79806131  -1.12293159  -1.06701303]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.47930054]
Stock Price:  102.29200742600416
PL:  [5.18729312]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.71192559e-02  3.45883095e-02 -8.18895101e-02]
 [-2.83813340e-01  3.17498637e-02 -4.06226328e-02]
 [-1.00642256e-01  3.55033382e-02 -6.31079272e-02]
 [ 1.56178625e-01  2.09434481e-02 -2.17465088e-02]
 [ 6.79823233e-02 -1.21976879e-01 -1.67339539e-01]
 [-8.12139493e-03 -1.27325030e-02  5.06208813e-03]
 [ 8.33774707e-02  1.65934120e-02 -2.93068618e-01]
 [ 4.15257658e-01  2.67353362e-01 -3.13352114e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.39734433]
curr_Stock_Price:  99.36853613688795
curr_Factors:  [99.36853614 -0.87156078 -1.06236133]
mat_Sqrt:  [[14.36670561  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00438109  0.01093778 -0.23360798]
Stock Position:  -0.004381088990929829
Bond Position:  [-1.96200193]


portfolio before change:  [-2.40595313]
curr_Stock_Price:  101.10955335133525
curr_Factors:  [101.10955335  -0.57104922  -1.07809887]
mat_Sqrt:  [[19.43463005  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01498797  0.01004019 -0.11588506]
Stock Position:  -0.014987968446570894
Bond Position:  [-0.89052633]


portfolio before change:  [-2.40268211]
curr_Stock_Price:  100.86159503377307
curr_Factors:  [100.86159503  -0.35918499  -1.09274096]
mat_Sqrt:  [[23.61361107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00476875  0.01122714 -0.18002935]
Stock Position:  -0.004768750341242929
Bond Position:  [-1.92169834]


portfolio before change:  [-2.41028992]
curr_Stock_Price:  102.2554027062706
curr_Factors:  [102.25540271  -0.19840337  -1.04205531]
mat_Sqrt:  [[29.57753009  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00514852  0.0066229  -0.06203674]
Stock Position:  0.005148516263572426
Bond Position:  [-2.93675352]


portfolio before change:  [-2.40888409]
curr_Stock_Price:  102.81373340188722
curr_Factors:  [ 1.02813733e+02 -9.53749241e-02 -1.06273056e+00]
mat_Sqrt:  [[32.29180397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094993 -0.03857248 -0.47737313]
Stock Position:  0.000949926907408876
Bond Position:  [-2.50654962]


portfolio before change:  [-2.40762994]
curr_Stock_Price:  105.45365923136796
curr_Factors:  [ 1.05453659e+02  9.62962305e-02 -1.08625564e+00]
mat_Sqrt:  [[39.18571213  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018927 -0.00402637  0.01444073]
Stock Position:  -0.00018927440451360685
Bond Position:  [-2.38767026]


portfolio before change:  [-2.40895409]
curr_Stock_Price:  106.14059048536558
curr_Factors:  [ 1.06140590e+02  4.18781724e-02 -1.14910512e+00]
mat_Sqrt:  [[35.07671746  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.83744983e-04  5.24729760e-03 -8.36043193e-01]
Stock Position:  0.0006837449834331156
Bond Position:  [-2.48152719]


portfolio before change:  [-2.4091615]
curr_Stock_Price:  107.65236271010129
curr_Factors:  [ 1.07652363e+02  6.38302556e-02 -1.08871671e+00]
mat_Sqrt:  [[38.62967304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00927261  0.08454456 -0.89390636]
Stock Position:  0.009272611734118918
Bond Position:  [-3.40738006]


portfolio before change:  [-2.33722967]
curr_Stock_Price:  115.59359338647333
curr_Factors:  [ 1.15593593e+02  3.40101128e-04 -1.11252141e+00]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.33722967]
Stock Price:  116.49187870663371
PL:  [-18.82910837]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 1.01955066e-01  5.07763940e-04 -6.14814317e-02]
 [-3.33950675e-01 -6.08216781e-02 -1.89574278e-01]
 [-1.34240075e-01  9.72214008e-02 -8.80399325e-02]
 [ 2.12941516e-01  1.39994820e-02 -9.59285691e-02]
 [ 6.74069915e-02 -1.26131766e-01 -1.65464371e-01]
 [ 4.51573849e-02 -8.12256455e-03 -1.08443558e-01]
 [ 6.49266411e-02  3.90453883e-02  4.74982476e-02]
 [ 1.44138151e-01  6.78728272e-02 -6.36287592e-02]
 [-9.37033506e-02 -7.87010708e-02  5.98364210e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.66319491]
curr_Stock_Price:  102.02420455954791
curr_Factors:  [102.02420456  -0.53601386  -1.07556004]
mat_Sqrt:  [[20.36130299  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.39158198e-03  1.60569057e-04 -1.75389411e-01]
Stock Position:  0.004391581981829452
Bond Position:  [16.21514725]


portfolio before change:  [16.67172939]
curr_Stock_Price:  102.12095349336295
curr_Factors:  [102.12095349  -0.82641601  -1.06421063]
mat_Sqrt:  [[15.41793272  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02427159 -0.0192335  -0.54080265]
Stock Position:  -0.024271591916550303
Bond Position:  [19.1503675]


portfolio before change:  [16.63116484]
curr_Stock_Price:  104.18683079614638
curr_Factors:  [104.1868308   -0.59095485  -1.11842846]
mat_Sqrt:  [[18.85545809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00793939  0.03074411 -0.25115342]
Stock Position:  -0.007939393723809763
Bond Position:  [17.45834511]


portfolio before change:  [16.64167898]
curr_Stock_Price:  103.96228122022535
curr_Factors:  [103.96228122  -0.42394855  -1.14706301]
mat_Sqrt:  [[21.60698397  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0089657   0.00442702 -0.27365751]
Stock Position:  0.008965695716357672
Bond Position:  [15.7095848]


portfolio before change:  [16.64773545]
curr_Stock_Price:  103.76148453146743
curr_Factors:  [103.76148453  -0.19751506  -1.16254294]
mat_Sqrt:  [[26.62995852  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00114063 -0.03988637 -0.47202379]
Stock Position:  0.0011406330223722278
Bond Position:  [16.52938168]


portfolio before change:  [16.65390605]
curr_Stock_Price:  101.92376425234632
curr_Factors:  [ 1.01923764e+02  3.60388670e-02 -1.15942624e+00]
mat_Sqrt:  [[33.14320614  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00068828 -0.00256858 -0.30935929]
Stock Position:  0.0006882771815861191
Bond Position:  [16.58375425]


portfolio before change:  [16.66083267]
curr_Stock_Price:  99.93717258347331
curr_Factors:  [99.93717258 -0.38772607 -1.12571716]
mat_Sqrt:  [[22.00123266  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00343755 0.01234724 0.13549928]
Stock Position:  0.0034375495680352506
Bond Position:  [16.31729369]


portfolio before change:  [16.67133354]
curr_Stock_Price:  100.61794384925693
curr_Factors:  [100.61794385  -0.28620573  -1.17829221]
mat_Sqrt:  [[23.26226848  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00571322  0.02146327 -0.18151514]
Stock Position:  0.005713219829045671
Bond Position:  [16.09648111]


portfolio before change:  [16.67873278]
curr_Stock_Price:  100.50399459052609
curr_Factors:  [ 1.00503995e+02  7.12712567e-02 -1.20671736e+00]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.67873278]
Stock Price:  103.38280933697851
PL:  [13.29592344]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.66131046e-02  3.69043012e-02 -8.77131512e-02]
 [-5.52515409e-02  8.12113971e-02  2.23506819e-02]
 [-8.82769267e-02  1.27886437e-02 -5.39319605e-02]
 [-4.13260299e-02 -7.75692023e-02 -4.16294953e-01]
 [ 6.88722220e-02 -1.15550279e-01 -1.70239969e-01]
 [ 6.00629182e-02  5.29294302e-02 -6.27041209e-02]
 [ 5.83912611e-02 -6.63522818e-02  3.49598776e-02]
 [ 1.04132289e-01  2.80264725e-02  9.98935077e-03]
 [-1.19512741e-01 -1.30657976e-01  1.26433775e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.98757386]
curr_Stock_Price:  99.56495675616242
curr_Factors:  [99.56495676 -1.18996518 -1.05211856]
mat_Sqrt:  [[10.57747269  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00600943  0.01167016 -0.25022121]
Stock Position:  -0.006009432830662939
Bond Position:  [-0.38924494]


portfolio before change:  [-0.98686987]
curr_Stock_Price:  99.4154147617526
curr_Factors:  [99.41541476 -0.59294332 -1.00921413]
mat_Sqrt:  [[20.02836939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242618  0.0256813   0.06376027]
Stock Position:  -0.002426176433330441
Bond Position:  [-0.74567053]


portfolio before change:  [-0.98790566]
curr_Stock_Price:  99.68862979289258
curr_Factors:  [99.68862979 -0.80241141 -1.01898688]
mat_Sqrt:  [[16.12955549  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00613504  0.00404412 -0.15385287]
Stock Position:  -0.006135044501693767
Bond Position:  [-0.37631148]


portfolio before change:  [-0.98309177]
curr_Stock_Price:  98.87329787003398
curr_Factors:  [98.87329787 -1.1069218  -0.99800298]
mat_Sqrt:  [[12.04818987  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01064929 -0.02452954 -1.18757363]
Stock Position:  -0.010649293454014108
Bond Position:  [0.069839]


portfolio before change:  [-0.98842929]
curr_Stock_Price:  99.37778706490525
curr_Factors:  [99.37778706 -1.24413745 -1.02614086]
mat_Sqrt:  [[10.26407883  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00303375 -0.03654021 -0.48564725]
Stock Position:  0.0030337489537752044
Bond Position:  [-1.28991655]


portfolio before change:  [-0.98984249]
curr_Stock_Price:  99.12461061282713
curr_Factors:  [99.12461061 -0.90368639 -1.04346569]
mat_Sqrt:  [[14.14308304  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00343844  0.01673776 -0.1788774 ]
Stock Position:  0.0034384387755868988
Bond Position:  [-1.33067639]


portfolio before change:  [-0.99435349]
curr_Stock_Price:  98.00622577541044
curr_Factors:  [98.00622578 -1.13563236 -1.04723334]
mat_Sqrt:  [[11.04707074  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00577657 -0.02098243  0.0997308 ]
Stock Position:  0.005776572733531946
Bond Position:  [-1.56049358]


portfolio before change:  [-0.9996633]
curr_Stock_Price:  97.22213329890599
curr_Factors:  [97.2221333  -1.16402156 -1.06119911]
mat_Sqrt:  [[10.50422673  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01017638 0.00886275 0.02849684]
Stock Position:  0.010176379497444491
Bond Position:  [-1.98903262]


portfolio before change:  [-1.00847151]
curr_Stock_Price:  96.45433099128108
curr_Factors:  [96.45433099 -1.09416745 -1.0298494 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.00847151]
Stock Price:  96.9722060534139
PL:  [-1.00847151]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-2.76451682e-01  3.61345518e-02 -3.56402575e-02]
 [-1.23550301e-01  7.75846441e-02 -8.01073484e-02]
 [ 1.69491780e-01 -2.41578189e-02 -2.65687141e-01]
 [ 6.28831427e-02 -1.24783462e-01 -1.56248410e-01]
 [-4.61720048e-02 -2.01596295e-02  1.55816677e-02]
 [ 6.76009422e-02  5.80680752e-02 -2.13335839e-01]
 [ 3.14422759e-01  1.84254161e-01 -1.91169014e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.41067696]
curr_Stock_Price:  100.87439704138052
curr_Factors:  [100.87439704  -0.61335703  -1.00175758]
mat_Sqrt:  [[20.06067704  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00307729  0.01250945 -0.27262553]
Stock Position:  -0.0030772891132909578
Bond Position:  [8.72109665]


portfolio before change:  [8.4144496]
curr_Stock_Price:  101.06579939674415
curr_Factors:  [101.0657994   -0.67180137  -1.05929462]
mat_Sqrt:  [[17.897764    0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01580051  0.01142675 -0.10167173]
Stock Position:  -0.015800506087774027
Bond Position:  [10.01134038]


portfolio before change:  [8.38358514]
curr_Stock_Price:  103.33606728694205
curr_Factors:  [103.33606729  -1.03400989  -1.06115791]
mat_Sqrt:  [[12.7154611   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01084498  0.02453442 -0.22852397]
Stock Position:  -0.010844979713299254
Bond Position:  [9.50426269]


portfolio before change:  [8.38793677]
curr_Stock_Price:  103.37310665385661
curr_Factors:  [103.37310665  -1.15992397  -1.06894381]
mat_Sqrt:  [[11.12814019  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01030135 -0.00763937 -0.75793146]
Stock Position:  0.01030135004016875
Bond Position:  [7.32305421]


portfolio before change:  [8.41256761]
curr_Stock_Price:  105.40860662466949
curr_Factors:  [105.40860662  -1.09932042  -1.05816108]
mat_Sqrt:  [[12.18691449  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227844 -0.03946    -0.44573322]
Stock Position:  0.0022784417221659832
Bond Position:  [8.17240024]


portfolio before change:  [8.41757002]
curr_Stock_Price:  105.81027815409533
curr_Factors:  [105.81027815  -1.19325061  -1.08549403]
mat_Sqrt:  [[10.83631533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00401538 -0.00637503  0.04445016]
Stock Position:  -0.004015380532327115
Bond Position:  [8.84243855]


portfolio before change:  [8.42254746]
curr_Stock_Price:  105.67203030509542
curr_Factors:  [105.67203031  -0.98093856  -1.09079625]
mat_Sqrt:  [[13.31119533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00191968  0.01836274 -0.60858777]
Stock Position:  0.0019196816711413137
Bond Position:  [8.2196908]


portfolio before change:  [8.42839325]
curr_Stock_Price:  106.5757841548983
curr_Factors:  [106.57578415  -0.7145511   -1.12877311]
mat_Sqrt:  [[16.86991922  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01660695  0.05826628 -0.54535198]
Stock Position:  0.01660695379779605
Bond Position:  [6.65849413]


portfolio before change:  [8.47423995]
curr_Stock_Price:  109.13595371942219
curr_Factors:  [109.13595372  -0.57141562  -1.1378466 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.47423995]
Stock Price:  112.11545894533526
PL:  [-3.641219]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [ 6.10338566e-03  9.21643935e-02  4.52134217e-02]
 [-1.02050417e-01  3.80900817e-02 -6.41528838e-02]
 [ 1.58409717e-01  6.85511628e-03 -1.12523292e-01]
 [ 6.87230140e-02 -1.16627817e-01 -1.69753658e-01]
 [ 2.71090244e-02 -1.09137431e-02 -4.50883892e-02]
 [ 1.42711127e-01 -4.14311468e-02 -4.15945519e-01]
 [ 4.76934728e-01  4.00613803e-01 -3.95299248e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.37483954]
curr_Stock_Price:  99.89410728981512
curr_Factors:  [99.89410729 -0.74391995 -1.03879295]
mat_Sqrt:  [[16.80031772  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367448  0.01250945 -0.27262553]
Stock Position:  -0.003674484262845826
Bond Position:  [1.74189887]


portfolio before change:  [1.37612907]
curr_Stock_Price:  99.78025201637037
curr_Factors:  [99.78025202 -1.1796326  -1.02789912]
mat_Sqrt:  [[10.9730094   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00161416 0.02914494 0.12898131]
Stock Position:  0.001614161664627372
Bond Position:  [1.21506761]


portfolio before change:  [1.37828857]
curr_Stock_Price:  100.7416313720679
curr_Factors:  [100.74163137  -0.83986961  -0.9800432 ]
mat_Sqrt:  [[16.32416162  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00699344  0.01204514 -0.18301032]
Stock Position:  -0.0069934426322887915
Bond Position:  [2.08281939]


portfolio before change:  [1.36525867]
curr_Stock_Price:  102.75374049364754
curr_Factors:  [102.75374049  -0.57884086  -1.01380231]
mat_Sqrt:  [[20.89880723  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00648927  0.00216778 -0.32099763]
Stock Position:  0.0064892695980299335
Bond Position:  [0.69846195]


portfolio before change:  [1.35381351]
curr_Stock_Price:  100.93620492969313
curr_Factors:  [100.93620493  -0.19027132  -1.04713615]
mat_Sqrt:  [[29.28516898  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00106064 -0.03688095 -0.48425994]
Stock Position:  0.0010606350365067586
Bond Position:  [1.24675704]


portfolio before change:  [1.35810586]
curr_Stock_Price:  104.39527425412842
curr_Factors:  [104.39527425   0.22233562  -1.01616407]
mat_Sqrt:  [[47.19820964  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0003734  -0.00345123 -0.12862462]
Stock Position:  0.00037339560166393113
Bond Position:  [1.31912512]


portfolio before change:  [1.36047497]
curr_Stock_Price:  108.97321321428488
curr_Factors:  [108.97321321  -0.13130123  -1.04806247]
mat_Sqrt:  [[33.50646479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00169331 -0.01310168 -1.18657679]
Stock Position:  0.0016933107240686798
Bond Position:  [1.17594946]


portfolio before change:  [1.37304541]
curr_Stock_Price:  116.04948051221712
curr_Factors:  [116.04948051  -0.34405013  -1.02327664]
mat_Sqrt:  [[29.56791683  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.013751    0.12668521 -1.12767872]
Stock Position:  0.013750999527852574
Bond Position:  [-0.22275094]


portfolio before change:  [1.300867]
curr_Stock_Price:  110.80862466884085
curr_Factors:  [110.80862467  -0.58301577  -1.03682325]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.300867]
Stock Price:  110.16225883767015
PL:  [-8.86139184]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-1.59193497e-01  9.37280827e-02 -5.74672829e-04]
 [-3.35794410e-02 -1.24386066e-02 -6.95794753e-02]
 [-3.91469290e-02 -6.96767885e-02 -3.76113654e-01]
 [-9.54547908e-04 -3.26187337e-02 -8.33865080e-02]
 [ 1.28249278e-01  1.49657438e-01 -5.60196777e-02]
 [ 1.62325727e-01 -1.80976161e-01  1.69137478e-01]
 [ 1.22821052e-01  4.79687524e-02  2.04362132e-02]
 [-1.20128291e-01 -1.32964883e-01  1.24314588e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.63437642]
curr_Stock_Price:  100.20892423484887
curr_Factors:  [100.20892423  -0.76337725  -1.01815564]
mat_Sqrt:  [[16.87316279  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365862  0.01250945 -0.27262553]
Stock Position:  -0.00365862072567713
Bond Position:  [4.00100286]


portfolio before change:  [3.63716013]
curr_Stock_Price:  99.99498764588095
curr_Factors:  [99.99498765 -0.3587828  -0.99627661]
mat_Sqrt:  [[25.79190412  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00608295  0.02963942 -0.00163938]
Stock Position:  -0.006082945741268414
Bond Position:  [4.24542422]


portfolio before change:  [3.65116232]
curr_Stock_Price:  98.04215894475563
curr_Factors:  [98.04215894 -0.36566238 -1.05369264]
mat_Sqrt:  [[23.71345381  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202853 -0.00393343 -0.19849088]
Stock Position:  -0.002028530123968434
Bond Position:  [3.8500438]


portfolio before change:  [3.65218821]
curr_Stock_Price:  98.48563995934705
curr_Factors:  [98.48563996 -0.94170466 -1.08141791]
mat_Sqrt:  [[13.0239267   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00903874 -0.02203374 -1.07294756]
Stock Position:  -0.009038737451437844
Bond Position:  [4.54237406]


portfolio before change:  [3.67544907]
curr_Stock_Price:  96.16351216791891
curr_Factors:  [96.16351217 -0.80736001 -1.0766874 ]
mat_Sqrt:  [[14.61433047  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00128764 -0.01031495 -0.2378785 ]
Stock Position:  -0.001287637480606413
Bond Position:  [3.79927281]


portfolio before change:  [3.67979843]
curr_Stock_Price:  94.26139014088109
curr_Factors:  [94.26139014 -1.22621905 -1.04695075]
mat_Sqrt:  [[ 9.70752994  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01243143  0.04732584 -0.15980855]
Stock Position:  0.01243142677966706
Bond Position:  [2.50799486]


portfolio before change:  [3.68556246]
curr_Stock_Price:  94.62415809909301
curr_Factors:  [94.6241581  -1.04890702 -1.07923638]
mat_Sqrt:  [[11.26577554  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01705857 -0.05722969  0.48250215]
Stock Position:  0.01705856686477924
Bond Position:  [2.07140993]


portfolio before change:  [3.7014402]
curr_Stock_Price:  95.49420643370547
curr_Factors:  [95.49420643 -1.07882944 -1.11200918]
mat_Sqrt:  [[10.67844218  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01200841 0.01516905 0.05829883]
Stock Position:  0.012008411220054601
Bond Position:  [2.5547065]


portfolio before change:  [3.70808204]
curr_Stock_Price:  95.9409068678699
curr_Factors:  [95.94090687 -0.75007914 -1.16647465]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.70808204]
Stock Price:  95.47111500100503
PL:  [3.70808204]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-3.08972376e-01 -3.53083847e-02 -1.51837285e-01]
 [-8.96376262e-02  1.52882029e-02 -5.49416977e-02]
 [-5.26329167e-03 -5.99710837e-02 -3.58784389e-01]
 [ 6.87225367e-02 -1.16631264e-01 -1.69752103e-01]
 [ 4.50476925e-02 -8.57185677e-03 -1.08780163e-01]
 [ 7.99759711e-02  5.48515624e-02  2.18157967e-02]
 [ 1.01927566e-01  2.64411914e-02  9.37997785e-03]
 [-1.15598541e-01 -1.18112611e-01  1.32534445e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.48735668]
curr_Stock_Price:  100.46709642523378
curr_Factors:  [100.46709643  -1.49395554  -0.95164424]
mat_Sqrt:  [[ 8.70789859  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00708925  0.01250945 -0.27262553]
Stock Position:  -0.007089253791526305
Bond Position:  [6.19959342]


portfolio before change:  [5.48057735]
curr_Stock_Price:  101.86074106783639
curr_Factors:  [101.86074107  -1.34807294  -0.94752829]
mat_Sqrt:  [[10.25746124  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03323217 -0.01116549 -0.43314951]
Stock Position:  -0.033232169485960104
Bond Position:  [8.86563076]


portfolio before change:  [5.55654138]
curr_Stock_Price:  99.70830549334507
curr_Factors:  [99.70830549 -0.98283396 -0.97491595]
mat_Sqrt:  [[14.07639193  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00713662  0.00483455 -0.15673337]
Stock Position:  -0.007136616692137975
Bond Position:  [6.26812133]


portfolio before change:  [5.55533284]
curr_Stock_Price:  100.31691033354582
curr_Factors:  [100.31691033  -1.08405712  -0.932698  ]
mat_Sqrt:  [[13.35083809  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00599575 -0.01896452 -1.02351199]
Stock Position:  -0.005995750566084723
Bond Position:  [6.15680801]


portfolio before change:  [5.55642155]
curr_Stock_Price:  100.64889009978667
curr_Factors:  [100.6488901   -0.79290379  -0.98496533]
mat_Sqrt:  [[17.00944887  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00182608 -0.03688204 -0.4842555 ]
Stock Position:  0.0018260807742424567
Bond Position:  [5.37262854]


portfolio before change:  [5.56107452]
curr_Stock_Price:  101.72550851030088
curr_Factors:  [101.72550851  -0.55285312  -0.98695855]
mat_Sqrt:  [[21.81213419  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00103712 -0.00271066 -0.31031953]
Stock Position:  0.001037115861281324
Bond Position:  [5.45557339]


portfolio before change:  [5.5623684]
curr_Stock_Price:  100.34225595882398
curr_Factors:  [100.34225596  -0.23400758  -0.99753547]
mat_Sqrt:  [[29.28407507  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00293147 0.01734559 0.0622344 ]
Stock Position:  0.002931469169718628
Bond Position:  [5.26821817]


portfolio before change:  [5.5566182]
curr_Stock_Price:  97.48192799982196
curr_Factors:  [97.481928   -0.36102998 -1.02786302]
mat_Sqrt:  [[24.30723431  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00430016 0.00836144 0.02675847]
Stock Position:  0.0043001582836800735
Bond Position:  [5.13743048]


portfolio before change:  [5.55440551]
curr_Stock_Price:  96.36986424481073
curr_Factors:  [96.36986424 -0.65350821 -0.94657101]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.55440551]
Stock Price:  97.7771666637726
PL:  [5.55440551]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.68187387e-02  3.67421941e-02 -8.72334589e-02]
 [-1.07950142e-01  8.08620990e-02  1.79248675e-02]
 [-1.14750161e-01  6.14190841e-02 -7.35770101e-02]
 [ 5.02559836e-02 -3.38210983e-02 -2.77131509e-01]
 [ 6.74718298e-02 -1.25663522e-01 -1.65675697e-01]
 [ 4.52445013e-02 -7.76574186e-03 -1.08176231e-01]
 [ 1.90415593e-02  1.12681634e-01 -9.98974097e-02]
 [ 1.97044328e-01  1.00376490e-01 -9.12300973e-02]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.11762165]
curr_Stock_Price:  99.54683744689173
curr_Factors:  [99.54683745 -0.99627163 -0.99806545]
mat_Sqrt:  [[13.54870791  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00469982  0.0116189  -0.24885278]
Stock Position:  -0.004699821930520787
Bond Position:  [-0.64976924]


portfolio before change:  [-1.12213865]
curr_Stock_Price:  100.43879334778141
curr_Factors:  [100.43879335  -1.22320987  -1.02713959]
mat_Sqrt:  [[10.58247214  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0096578   0.02557084  0.05113466]
Stock Position:  -0.009657799470149712
Bond Position:  [-0.15212092]


portfolio before change:  [-1.13887658]
curr_Stock_Price:  102.16401556896182
curr_Factors:  [102.16401557  -1.03779991  -1.03609806]
mat_Sqrt:  [[12.8414928   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00998195  0.01942242 -0.20989473]
Stock Position:  -0.009981952517984323
Bond Position:  [-0.11908022]


portfolio before change:  [-1.13035421]
curr_Stock_Price:  101.30427217732662
curr_Factors:  [101.30427218  -0.89820874  -1.01364871]
mat_Sqrt:  [[14.97333779  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.79953490e-04 -1.06951704e-02 -7.90579056e-01]
Stock Position:  -0.0004799534896606543
Bond Position:  [-1.08173287]


portfolio before change:  [-1.13199987]
curr_Stock_Price:  103.60585350381201
curr_Factors:  [103.6058535   -0.92058483  -1.07903162]
mat_Sqrt:  [[14.02690658  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00216789 -0.03973829 -0.47262665]
Stock Position:  0.0021678907889053907
Bond Position:  [-1.35660604]


portfolio before change:  [-1.13489899]
curr_Stock_Price:  102.58151837344654
curr_Factors:  [102.58151837  -0.99650361  -1.08572427]
mat_Sqrt:  [[12.78701107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00179578 -0.00245574 -0.30859668]
Stock Position:  0.0017957761917487473
Bond Position:  [-1.31911243]


portfolio before change:  [-1.13531161]
curr_Stock_Price:  102.71911729100567
curr_Factors:  [102.71911729  -1.10950085  -1.08913987]
mat_Sqrt:  [[11.39708393  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.36834407e-04  3.56330613e-02 -2.84979504e-01]
Stock Position:  0.00013683440726259833
Bond Position:  [-1.14936712]


portfolio before change:  [-1.13587736]
curr_Stock_Price:  102.7854749602043
curr_Factors:  [102.78547496  -0.68617825  -1.06993266]
mat_Sqrt:  [[17.75262053  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01019645  0.03174183 -0.26025407]
Stock Position:  0.01019645362488682
Bond Position:  [-2.18392469]


portfolio before change:  [-1.09020432]
curr_Stock_Price:  107.37190022137025
curr_Factors:  [ 1.07371900e+02 -7.14817081e-02 -1.06607509e+00]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.09020432]
Stock Price:  104.60266188577744
PL:  [-5.69286621]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.36134626e-02  3.92690029e-02 -9.47105556e-02]
 [-1.04017486e-01  8.74917221e-02  1.76985847e-02]
 [-6.17321704e-02 -2.04612307e-02 -4.74317750e-02]
 [ 7.73006773e-02 -1.48219534e-02 -1.95192092e-01]
 [-6.21716391e-02 -4.87147191e-02 -5.93039331e-02]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 1.36318512e-02  1.16243447e-01 -9.18173170e-02]
 [ 1.23728433e-01  4.41473764e-02 -1.61805909e-02]
 [-9.44069240e-02 -7.84729618e-02  6.73620039e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.10272787]
curr_Stock_Price:  99.85619449190403
curr_Factors:  [99.85619449 -1.19346675 -0.992228  ]
mat_Sqrt:  [[11.22379797  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00551794  0.01241795 -0.27018285]
Stock Position:  -0.005517940778786581
Bond Position:  [1.65372844]


portfolio before change:  [1.10107946]
curr_Stock_Price:  100.3048190278492
curr_Factors:  [100.30481903  -1.0530149   -0.96956728]
mat_Sqrt:  [[13.27166825  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00739513  0.02766731  0.05048914]
Stock Position:  -0.007395132933021573
Bond Position:  [1.84284693]


portfolio before change:  [1.11967199]
curr_Stock_Price:  97.915290381855
curr_Factors:  [97.91529038 -0.52568179 -0.93182763]
mat_Sqrt:  [[22.79618725  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031559  -0.00647041 -0.13530965]
Stock Position:  -0.0031558982573416734
Bond Position:  [1.42868269]


portfolio before change:  [1.10884615]
curr_Stock_Price:  101.57204953006311
curr_Factors:  [101.57204953  -0.65992621  -0.99064778]
mat_Sqrt:  [[19.49570939  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00190168 -0.00468711 -0.55682871]
Stock Position:  0.0019016777752519694
Bond Position:  [0.91568884]


portfolio before change:  [1.10100758]
curr_Stock_Price:  97.20930512445784
curr_Factors:  [97.20930512 -0.20404146 -1.04435792]
mat_Sqrt:  [[27.89554671  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270777 -0.01540495 -0.16917761]
Stock Position:  -0.002707773148082078
Bond Position:  [1.36422832]


portfolio before change:  [1.09026721]
curr_Stock_Price:  101.4277738859977
curr_Factors:  [101.42777389  -0.84010876  -1.08222278]
mat_Sqrt:  [[14.83538818  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00159436 -0.00193948 -0.30510753]
Stock Position:  0.001594363784845595
Bond Position:  [0.92855444]


portfolio before change:  [1.09177706]
curr_Stock_Price:  102.08349545135661
curr_Factors:  [102.08349545  -1.01164907  -1.07329123]
mat_Sqrt:  [[12.6904629   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.66178903e-04  3.67594057e-02 -2.61929249e-01]
Stock Position:  -0.00016617890303514564
Bond Position:  [1.10874118]


portfolio before change:  [1.0924753]
curr_Stock_Price:  101.21858721544751
curr_Factors:  [101.21858722  -0.94231248  -1.0728114 ]
mat_Sqrt:  [[13.49283123  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00900963  0.01396063 -0.04615872]
Stock Position:  0.009009633496142817
Bond Position:  [0.18053292]


portfolio before change:  [1.08873381]
curr_Stock_Price:  100.79328970797772
curr_Factors:  [100.79328971  -0.39418123  -1.06450751]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.08873381]
Stock Price:  101.62655457767075
PL:  [-0.53782077]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.79607796e-02  3.55784785e-02 -8.39313817e-02]
 [-8.28420414e-02  9.38552925e-02  2.35589510e-02]
 [-9.63633633e-02  2.76431555e-02 -5.99326798e-02]
 [-1.57549650e-02 -1.47900164e-02 -1.28666394e-01]
 [ 1.57555678e-02 -8.50941453e-02 -1.34708263e-01]
 [ 7.54326828e-02  1.15882883e-01 -1.55401333e-02]
 [ 1.09711211e-01 -3.25400163e-02  1.03242268e-01]
 [ 1.08848246e-01  3.30587437e-02  1.26255311e-02]
 [-1.31845403e-01 -1.73210518e-01  9.67075314e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.94211101]
curr_Stock_Price:  99.43196292300775
curr_Factors:  [99.43196292 -0.92357473 -0.98225512]
mat_Sqrt:  [[14.78545273  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00434039  0.0112509  -0.23943287]
Stock Position:  -0.00434038577981528
Bond Position:  [-1.51053793]


portfolio before change:  [-1.94621028]
curr_Stock_Price:  100.20235699021974
curr_Factors:  [100.20235699  -1.01752324  -0.98239574]
mat_Sqrt:  [[13.5620131   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00557511  0.02967965  0.06720713]
Stock Position:  -0.005575113140924996
Bond Position:  [-1.3875708]


portfolio before change:  [-1.94841641]
curr_Stock_Price:  100.47359433954756
curr_Factors:  [100.47359434  -0.46894086  -1.02789768]
mat_Sqrt:  [[22.48967714  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00479702  0.00874153 -0.17097125]
Stock Position:  -0.004797015377635622
Bond Position:  [-1.46644304]


portfolio before change:  [-1.93904096]
curr_Stock_Price:  98.36627194878632
curr_Factors:  [98.36627195 -0.1733023  -1.00764641]
mat_Sqrt:  [[30.19720179  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00140413 -0.00467701 -0.36704941]
Stock Position:  -0.0014041287492887462
Bond Position:  [-1.80092205]


portfolio before change:  [-1.93901214]
curr_Stock_Price:  97.70429040505645
curr_Factors:  [97.70429041 -0.6360122  -0.99375203]
mat_Sqrt:  [[19.14767392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072796 -0.02690913 -0.38428518]
Stock Position:  -0.0007279611452140346
Bond Position:  [-1.86788721]


portfolio before change:  [-1.940305]
curr_Stock_Price:  98.19700970622019
curr_Factors:  [98.19700971 -0.43272895 -0.99400523]
mat_Sqrt:  [[23.57629097  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00319188  0.03664539 -0.04433167]
Stock Position:  0.0031918782144491134
Bond Position:  [-2.25373789]


portfolio before change:  [-1.93941523]
curr_Stock_Price:  98.82890090705875
curr_Factors:  [98.82890091 -0.24654279 -1.00975548]
mat_Sqrt:  [[28.13717924  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00461828 -0.01029006  0.29452145]
Stock Position:  0.004618276397120578
Bond Position:  [-2.39583441]


portfolio before change:  [-1.94945603]
curr_Stock_Price:  96.91420670474076
curr_Factors:  [96.9142067  -0.34990801 -0.92853947]
mat_Sqrt:  [[26.98763068  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00416039 0.01045409 0.03601713]
Stock Position:  0.004160387255726323
Bond Position:  [-2.35265666]


portfolio before change:  [-1.96879238]
curr_Stock_Price:  92.54929437643196
curr_Factors:  [92.54929438 -0.4670452  -0.86491533]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.96879238]
Stock Price:  93.41194569302547
PL:  [-1.96879238]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 5.33263951e-02  1.35859994e-02 -7.28967917e-02]
 [-2.97821455e-01  1.27717660e-02 -6.99418761e-02]
 [-7.03014093e-02 -1.67458780e-02 -4.42937898e-02]
 [ 2.04654247e-02 -7.27983284e-02 -4.18146132e-01]
 [ 7.08694541e-02 -1.01126823e-01 -1.76749511e-01]
 [ 8.35648513e-02  1.34499149e-01 -6.88734028e-03]
 [ 1.03466434e-01 -8.43000284e-02  9.31222505e-02]
 [ 1.46677920e-01  7.51786000e-02  1.06066512e-02]
 [-1.29104120e-01 -1.64038567e-01  1.02320018e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.05569036]
curr_Stock_Price:  101.52157786142864
curr_Factors:  [101.52157786  -0.5876446   -0.9578244 ]
mat_Sqrt:  [[21.64560346  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00179238  0.00429627 -0.20795426]
Stock Position:  0.0017923819417378789
Bond Position:  [12.87372492]


portfolio before change:  [13.06177948]
curr_Stock_Price:  101.32666684558872
curr_Factors:  [101.32666685  -0.71727387  -0.96336697]
mat_Sqrt:  [[18.87255563  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01651968  0.00403879 -0.1995247 ]
Stock Position:  -0.016519676567505998
Bond Position:  [14.73566325]


portfolio before change:  [13.12060033]
curr_Stock_Price:  98.21212782034644
curr_Factors:  [98.21212782 -0.57392078 -0.96640447]
mat_Sqrt:  [[21.04797715  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00379016 -0.00529551 -0.12635785]
Stock Position:  -0.0037901608049927494
Bond Position:  [13.49284009]


portfolio before change:  [13.13379418]
curr_Stock_Price:  96.51147702702782
curr_Factors:  [96.51147703 -0.8469012  -0.94143329]
mat_Sqrt:  [[16.14043227  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00413669 -0.02302085 -1.19285453]
Stock Position:  -0.004136688582480061
Bond Position:  [13.5330321]


portfolio before change:  [13.13527269]
curr_Stock_Price:  97.79020501039159
curr_Factors:  [97.79020501 -1.10470963 -0.94055063]
mat_Sqrt:  [[12.6488229   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00254407 -0.03197911 -0.50421716]
Stock Position:  0.002544072931555494
Bond Position:  [12.88648727]


portfolio before change:  [13.13832388]
curr_Stock_Price:  96.456255196446
curr_Factors:  [96.4562552  -1.03670096 -0.94267289]
mat_Sqrt:  [[13.32598301  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00642592  0.04253237 -0.01964766]
Stock Position:  0.006425922342280676
Bond Position:  [12.51850347]


portfolio before change:  [13.15047616]
curr_Stock_Price:  97.37308319321555
curr_Factors:  [97.37308319 -0.87191538 -0.89178884]
mat_Sqrt:  [[16.69059853  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00720755 -0.02665801  0.26565186]
Stock Position:  0.007207549558632162
Bond Position:  [12.44865484]


portfolio before change:  [13.13267338]
curr_Stock_Price:  94.03926406560443
curr_Factors:  [94.03926407 -0.69648345 -0.88720318]
mat_Sqrt:  [[19.29846904  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00781327 0.02377356 0.03025782]
Stock Position:  0.007813267284307845
Bond Position:  [12.39791947]


portfolio before change:  [13.12998983]
curr_Stock_Price:  92.9022165975353
curr_Factors:  [92.9022166  -0.13905524 -0.82910495]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.12998983]
Stock Price:  94.30228935650699
PL:  [13.12998983]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-1.16033887e-01  7.92399900e-02  1.54928771e-02]
 [-9.74196739e-02  2.95835626e-02 -6.07165385e-02]
 [-4.36594142e-02 -9.04023902e-02 -4.85190868e-01]
 [ 6.87217372e-02 -1.16637038e-01 -1.69749497e-01]
 [ 7.04281022e-02  9.53844802e-02 -3.08972959e-02]
 [ 3.15194329e-02 -1.18211258e-02  1.95224475e-03]
 [ 9.22095981e-02  2.21603420e-02  8.89181089e-03]
 [-1.06750115e-01 -9.75294374e-02  1.19322058e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.7597434]
curr_Stock_Price:  100.08706329188257
curr_Factors:  [100.08706329  -1.14122655  -0.9991083 ]
mat_Sqrt:  [[11.77178522  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524411  0.01250945 -0.27262553]
Stock Position:  -0.005244107150874565
Bond Position:  [3.28461068]


portfolio before change:  [2.75942607]
curr_Stock_Price:  100.46082465028182
curr_Factors:  [100.46082465  -1.20147738  -1.01943673]
mat_Sqrt:  [[10.90099137  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01016655  0.02505789  0.04419687]
Stock Position:  -0.010166547732315238
Bond Position:  [3.78076584]


portfolio before change:  [2.76900434]
curr_Stock_Price:  99.70467704229854
curr_Factors:  [99.70467704 -1.3244694  -1.01978516]
mat_Sqrt:  [[ 9.56354075  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01140263  0.00935514 -0.17320738]
Stock Position:  -0.011402632558624394
Bond Position:  [3.90590013]


portfolio before change:  [2.77033983]
curr_Stock_Price:  99.7588699689326
curr_Factors:  [99.75886997 -1.40904551 -0.9636842 ]
mat_Sqrt:  [[ 9.30011033  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01559474 -0.02858775 -1.38411449]
Stock Position:  -0.015594735963970242
Bond Position:  [4.32605307]


portfolio before change:  [2.76519382]
curr_Stock_Price:  100.22759096401107
curr_Factors:  [100.22759096  -1.16044441  -0.98658595]
mat_Sqrt:  [[11.70964846  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00265253 -0.03688387 -0.48424807]
Stock Position:  0.002652531452689296
Bond Position:  [2.49933698]


portfolio before change:  [2.762659]
curr_Stock_Price:  98.80072627631085
curr_Factors:  [98.80072628 -1.6757756  -1.01059876]
mat_Sqrt:  [[ 6.7310463   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00989208  0.03016322 -0.08814139]
Stock Position:  0.009892077960473459
Bond Position:  [1.78531451]


portfolio before change:  [2.75940482]
curr_Stock_Price:  98.38149592659266
curr_Factors:  [98.38149593 -1.4121861  -1.0207757 ]
mat_Sqrt:  [[ 8.63558048  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00366075 -0.00373817  0.00556921]
Stock Position:  0.0036607513705566065
Bond Position:  [2.39925462]


portfolio before change:  [2.75935655]
curr_Stock_Price:  98.04052949730975
curr_Factors:  [98.0405295  -1.50189883 -1.08463434]
mat_Sqrt:  [[ 7.38054725  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01281705 0.00700772 0.02536586]
Stock Position:  0.012817045372950434
Bond Position:  [1.50276664]


portfolio before change:  [2.767255]
curr_Stock_Price:  98.5981365657822
curr_Factors:  [98.59813657 -1.10266233 -1.08872028]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.767255]
Stock Price:  100.13507861823744
PL:  [2.63217638]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-4.39442667e-01 -1.68573137e-01 -3.48950648e-01]
 [-1.11246416e-01  5.49828231e-02 -7.09769788e-02]
 [ 3.46163091e-02 -2.57793962e-02 -2.31054050e-01]
 [ 6.76263959e-02 -1.24547289e-01 -1.66179471e-01]
 [ 4.49256575e-02 -9.07170314e-03 -1.09154642e-01]
 [ 7.15482033e-02  6.11222327e-02 -2.09017572e-01]
 [ 2.44983655e-01  1.24548388e-01 -9.88694473e-02]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.63456166]
curr_Stock_Price:  100.76626238226847
curr_Factors:  [100.76626238  -0.92399102  -0.94981278]
mat_Sqrt:  [[15.47150275  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00399008  0.01250945 -0.27262553]
Stock Position:  -0.003990078021521431
Bond Position:  [8.03662691]


portfolio before change:  [7.62800427]
curr_Stock_Price:  103.41701373616169
curr_Factors:  [103.41701374  -1.04636311  -0.95409741]
mat_Sqrt:  [[13.98952693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.036815   -0.05330751 -0.99545907]
Stock Position:  -0.03681500184407871
Bond Position:  [11.43530182]


portfolio before change:  [7.70374258]
curr_Stock_Price:  101.51509254323345
curr_Factors:  [101.51509254  -0.7619231   -0.95474562]
mat_Sqrt:  [[18.23857328  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00681604  0.0173871  -0.20247756]
Stock Position:  -0.006816041982139196
Bond Position:  [8.39567372]


portfolio before change:  [7.71159518]
curr_Stock_Price:  100.97904615319803
curr_Factors:  [100.97904615  -0.71356972  -0.92000312]
mat_Sqrt:  [[19.71421969  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00067023 -0.00815216 -0.65913289]
Stock Position:  -0.0006702280218968147
Bond Position:  [7.77927417]


portfolio before change:  [7.7138958]
curr_Stock_Price:  103.35136542765015
curr_Factors:  [103.35136543  -1.19492577  -0.9601835 ]
mat_Sqrt:  [[11.97744424  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00254556 -0.03938531 -0.47406378]
Stock Position:  0.0025455644423973294
Bond Position:  [7.45080824]


portfolio before change:  [7.71514293]
curr_Stock_Price:  102.37743464184764
curr_Factors:  [102.37743464  -1.26158975  -0.91014381]
mat_Sqrt:  [[11.66896512  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00192051 -0.00286872 -0.31138781]
Stock Position:  0.0019205069998195685
Bond Position:  [7.51852635]


portfolio before change:  [7.722057]
curr_Stock_Price:  104.01964207169
curr_Factors:  [104.01964207  -1.2167147   -0.89726703]
mat_Sqrt:  [[12.56101563  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00242503  0.01932855 -0.59626895]
Stock Position:  0.0024250299595387254
Bond Position:  [7.46980626]


portfolio before change:  [7.72979884]
curr_Stock_Price:  105.67158036778841
curr_Factors:  [105.67158037  -1.35790383  -0.90484861]
mat_Sqrt:  [[10.99657146  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02073536  0.03938566 -0.28204701]
Stock Position:  0.02073535733976122
Bond Position:  [5.53866086]


portfolio before change:  [7.73087467]
curr_Stock_Price:  105.58987492231358
curr_Factors:  [105.58987492  -1.27531861  -0.9448013 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.73087467]
Stock Price:  104.29643782899282
PL:  [3.43443684]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 5.32183867e-02  1.36150472e-02 -7.29221461e-02]
 [-3.30403670e-01 -5.28577803e-02 -1.76483096e-01]
 [-8.74604951e-02  1.12888864e-02 -5.33261094e-02]
 [ 1.46975827e-02 -3.36787781e-02 -2.22516678e-01]
 [ 6.87224728e-02 -1.16631725e-01 -1.69751895e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [-3.69835941e-04  1.14770299e-01 -3.48662537e-02]
 [ 1.06808387e-01  2.85912353e-02  9.62515824e-03]
 [-9.59606797e-02 -8.46364737e-02  2.58455009e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.62001556]
curr_Stock_Price:  101.60020421028204
curr_Factors:  [101.60020421  -1.10969108  -1.0022732 ]
mat_Sqrt:  [[12.2936304   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00314673  0.00430546 -0.20802659]
Stock Position:  0.0031467315789895788
Bond Position:  [13.30030699]


portfolio before change:  [13.62802198]
curr_Stock_Price:  102.03068384037114
curr_Factors:  [102.03068384  -0.78737664  -1.03038976]
mat_Sqrt:  [[16.56856447  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02219824 -0.0167151  -0.50345715]
Stock Position:  -0.022198236513191777
Bond Position:  [15.89292323]


portfolio before change:  [13.68713154]
curr_Stock_Price:  99.72594627626594
curr_Factors:  [99.72594628 -0.58267674 -1.00202858]
mat_Sqrt:  [[20.44463622  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00479608  0.00356986 -0.15212455]
Stock Position:  -0.004796082590324763
Bond Position:  [14.16542542]


portfolio before change:  [13.69259051]
curr_Stock_Price:  100.0648721138845
curr_Factors:  [100.06487211  -0.64727014  -0.99706691]
mat_Sqrt:  [[19.3265856   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00163469 -0.01065016 -0.63477815]
Stock Position:  -0.001634692597700381
Bond Position:  [13.85616581]


portfolio before change:  [13.69862388]
curr_Stock_Price:  100.61326035392119
curr_Factors:  [100.61326035  -1.23683509  -0.95734917]
mat_Sqrt:  [[11.2132913   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00276998 -0.03688219 -0.48425491]
Stock Position:  0.0027699801440251985
Bond Position:  [13.41992714]


portfolio before change:  [13.70584989]
curr_Stock_Price:  100.79895587161644
curr_Factors:  [100.79895587  -1.37090733  -0.94244993]
mat_Sqrt:  [[ 9.97189603  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00237197 -0.00193948 -0.30510753]
Stock Position:  0.0023719667329391483
Bond Position:  [13.46675812]


portfolio before change:  [13.70957873]
curr_Stock_Price:  99.5315567643252
curr_Factors:  [99.53155676 -1.72874339 -0.8939863 ]
mat_Sqrt:  [[ 7.22642943  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00062597  0.03629356 -0.09946372]
Stock Position:  -0.0006259694135810311
Bond Position:  [13.77188244]


portfolio before change:  [13.71616133]
curr_Stock_Price:  100.01888614235384
curr_Factors:  [100.01888614  -1.92549869  -0.91284136]
mat_Sqrt:  [[ 5.85337832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01870908 0.00904134 0.0274579 ]
Stock Position:  0.018709082281922227
Bond Position:  [11.84489976]


portfolio before change:  [13.70008904]
curr_Stock_Price:  98.84318861478357
curr_Factors:  [98.84318861 -1.64699637 -0.83879558]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.70008904]
Stock Price:  97.8441465723229
PL:  [13.70008904]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-3.14652062e-02  1.67807396e-02 -4.53878096e-02]
 [-1.83328456e-01  7.04357133e-02 -1.92252809e-02]
 [ 1.03093763e-01  6.07642881e-02 -1.93757971e-01]
 [-2.05340728e-01 -3.88926545e-02 -1.19188294e-01]
 [-6.82172680e-02  4.30948026e-01  5.91547428e-01]
 [ 2.69327447e-01  1.97515356e-01 -2.11140840e-01]
 [ 3.84067782e-01 -3.93905991e-01  4.85447547e-01]
 [ 8.79491511e-02  1.31398080e-01  4.13507840e-02]
 [-1.30420163e-01 -1.68279900e-01  1.00187950e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.21066403]
curr_Stock_Price:  99.25521786122732
curr_Factors:  [99.25521786 -0.17760068 -1.0093885 ]
mat_Sqrt:  [[30.28659821  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00133051  0.00530654 -0.12947879]
Stock Position:  -0.0013305118306414137
Bond Position:  [-3.07860378]


portfolio before change:  [-3.21075767]
curr_Stock_Price:  98.16838300564415
curr_Factors:  [98.16838301 -0.21961943 -0.98695489]
mat_Sqrt:  [[29.37399844  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00631287  0.02227373 -0.05484438]
Stock Position:  -0.006312867405197092
Bond Position:  [-2.59103368]


portfolio before change:  [-3.18450704]
curr_Stock_Price:  93.80484101854485
curr_Factors:  [93.80484102 -0.22499148 -0.97684229]
mat_Sqrt:  [[28.20171226  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0023088   0.01921536 -0.55273756]
Stock Position:  0.002308796331602882
Bond Position:  [-3.40108332]


portfolio before change:  [-3.19698322]
curr_Stock_Price:  89.13781571051327
curr_Factors:  [89.13781571 -0.59833302 -0.96700715]
mat_Sqrt:  [[18.63130985  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01238099 -0.01229894 -0.34001103]
Stock Position:  -0.012380994262242635
Bond Position:  [-2.09336844]


portfolio before change:  [-3.17220658]
curr_Stock_Price:  87.05207105389526
curr_Factors:  [87.05207105 -1.21633532 -0.98019759]
mat_Sqrt:  [[ 9.67914479  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00657691 0.13627773 1.68752016]
Stock Position:  0.0065769111439070915
Bond Position:  [-3.74474031]


portfolio before change:  [-3.17284847]
curr_Stock_Price:  87.23923308000515
curr_Factors:  [87.23923308 -0.31275721 -0.99621952]
mat_Sqrt:  [[23.5629938   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00981744  0.06245984 -0.60232605]
Stock Position:  0.009817442146269397
Bond Position:  [-4.02931459]


portfolio before change:  [-3.16178567]
curr_Stock_Price:  88.57134730753839
curr_Factors:  [ 8.85713473e+01  2.11661267e-02 -9.81185866e-01]
mat_Sqrt:  [[33.91266937  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01394726 -0.12456401  1.38484673]
Stock Position:  0.013947257693783938
Bond Position:  [-4.39711308]


portfolio before change:  [-3.1368652]
curr_Stock_Price:  90.51578563547865
curr_Factors:  [90.51578564 -0.26620348 -0.95096115]
mat_Sqrt:  [[26.79886755  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00372339 0.04155172 0.11796228]
Stock Position:  0.003723386003203808
Bond Position:  [-3.47389041]


portfolio before change:  [-3.12958174]
curr_Stock_Price:  92.93853654828504
curr_Factors:  [92.93853655 -0.34443727 -0.95402147]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.12958174]
Stock Price:  90.9729386149891
PL:  [-3.12958174]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-1.95960887e-02  9.17125610e-02  3.77410108e-02]
 [-8.90086679e-02  1.41328276e-02 -5.44749653e-02]
 [-4.32946483e-02 -8.46992765e-02 -4.52595082e-01]
 [ 6.87206089e-02 -1.16645186e-01 -1.69745820e-01]
 [ 6.26146328e-02  6.33810700e-02 -5.48738750e-02]
 [ 8.14493336e-02  1.55158938e-02  6.81738078e-02]
 [ 2.13846703e-01  1.12336702e-01 -1.05382663e-01]
 [-1.00064301e-01 -7.66387556e-02  1.27874607e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.89893007]
curr_Stock_Price:  100.24578398839577
curr_Factors:  [100.24578399  -1.24830522  -0.97063684]
mat_Sqrt:  [[10.89912973  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00566398  0.01250945 -0.27262553]
Stock Position:  -0.005663984610437746
Bond Position:  [4.46672065]


portfolio before change:  [3.90333155]
curr_Stock_Price:  99.86309145109117
curr_Factors:  [99.86309145 -1.1326252  -0.93869822]
mat_Sqrt:  [[12.58463643  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00075681  0.02900206  0.1076646 ]
Stock Position:  -0.0007568139993712897
Bond Position:  [3.97890934]


portfolio before change:  [3.90593466]
curr_Stock_Price:  99.05290678702545
curr_Factors:  [99.05290679 -1.06690575 -0.95394029]
mat_Sqrt:  [[13.12879725  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00759882  0.00446919 -0.15540191]
Stock Position:  -0.007598823687693922
Bond Position:  [4.65862024]


portfolio before change:  [3.91161536]
curr_Stock_Price:  98.61194376372183
curr_Factors:  [98.61194376 -1.17380378 -0.93140479]
mat_Sqrt:  [[12.01293302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01147656 -0.02678426 -1.29112779]
Stock Position:  -0.011476560988608336
Bond Position:  [5.04334134]


portfolio before change:  [3.90309357]
curr_Stock_Price:  99.5742607631556
curr_Factors:  [99.57426076 -1.23849236 -0.95133907]
mat_Sqrt:  [[11.1459062   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00278664 -0.03688645 -0.48423758]
Stock Position:  0.0027866395321429456
Bond Position:  [3.625616]


portfolio before change:  [3.90372606]
curr_Stock_Price:  99.15053542781573
curr_Factors:  [99.15053543 -1.17500292 -0.93660355]
mat_Sqrt:  [[12.00151365  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00442028  0.02004285 -0.15653989]
Stock Position:  0.004420279281136573
Bond Position:  [3.465453]


portfolio before change:  [3.90557992]
curr_Stock_Price:  99.17784155432133
curr_Factors:  [99.17784155 -0.87163222 -0.89372937]
mat_Sqrt:  [[16.97179805  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00564265 0.00490656 0.1944809 ]
Stock Position:  0.0056426474209040085
Bond Position:  [3.34595433]


portfolio before change:  [3.9284159]
curr_Stock_Price:  102.9283122565478
curr_Factors:  [102.92831226  -0.64788974  -0.90831144]
mat_Sqrt:  [[21.71127186  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00899238  0.03552398 -0.3006274 ]
Stock Position:  0.008992383298593837
Bond Position:  [3.00284506]


portfolio before change:  [3.89243211]
curr_Stock_Price:  98.75971884727863
curr_Factors:  [98.75971885 -0.63891187 -0.89402403]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.89243211]
Stock Price:  97.3345683346096
PL:  [3.89243211]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.53588318e-02  3.49477306e-02 -8.35054220e-02]
 [-1.98724212e-01  7.30996747e-02 -2.22089024e-02]
 [-8.08492002e-02 -8.55839825e-04 -4.84200517e-02]
 [-2.46661001e-02 -3.65745986e-02 -2.17386123e-01]
 [ 6.87239347e-02 -1.16621168e-01 -1.69756659e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 1.81785337e-02  1.22905555e-01 -8.11624193e-02]
 [ 1.41848100e-01  6.10211554e-02 -4.45223117e-02]
 [-9.18141974e-02 -7.71530454e-02  6.10096228e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.14391339]
curr_Stock_Price:  99.4038461844828
curr_Factors:  [99.40384618 -0.32485805 -0.99634784]
mat_Sqrt:  [[26.52227423  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00231888  0.01105144 -0.23821773]
Stock Position:  -0.0023188795070491946
Bond Position:  [-1.91340784]


portfolio before change:  [-2.13885251]
curr_Stock_Price:  96.80870356308453
curr_Factors:  [96.80870356 -1.05860623 -1.00539341]
mat_Sqrt:  [[12.28940206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01638568  0.02311615 -0.06335582]
Stock Position:  -0.016385675919032037
Bond Position:  [-0.55257646]


portfolio before change:  [-2.12967432]
curr_Stock_Price:  96.23170307936515
curr_Factors:  [96.23170308 -1.03776278 -0.99464031]
mat_Sqrt:  [[12.6083056   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00719803 -0.00027064 -0.13812893]
Stock Position:  -0.007198032982536105
Bond Position:  [-1.43699535]


portfolio before change:  [-2.14598398]
curr_Stock_Price:  98.39770842928311
curr_Factors:  [98.39770843 -0.47687105 -0.99758446]
mat_Sqrt:  [[22.52356302  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00310716 -0.0115659  -0.6201421 ]
Stock Position:  -0.0031071553190794455
Bond Position:  [-1.84024701]


portfolio before change:  [-2.15641152]
curr_Stock_Price:  101.45748245254639
curr_Factors:  [101.45748245  -0.86531467  -1.01721011]
mat_Sqrt:  [[15.44237012  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00201144 -0.03687885 -0.4842685 ]
Stock Position:  0.002011437094936309
Bond Position:  [-2.36048687]


portfolio before change:  [-2.15872742]
curr_Stock_Price:  100.89302979289668
curr_Factors:  [100.89302979  -0.8622084   -1.032536  ]
mat_Sqrt:  [[15.16994913  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0015592  -0.00193948 -0.30510753]
Stock Position:  0.0015592013823973992
Bond Position:  [-2.31603997]


portfolio before change:  [-2.15886354]
curr_Stock_Price:  101.548614533668
curr_Factors:  [101.54861453  -0.98245701  -1.02754835]
mat_Sqrt:  [[13.60629141  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00035166  0.03886615 -0.23153379]
Stock Position:  0.000351655856070126
Bond Position:  [-2.19457371]


portfolio before change:  [-2.16013793]
curr_Stock_Price:  101.04577907580776
curr_Factors:  [101.04577908  -0.64230041  -1.03609948]
mat_Sqrt:  [[18.8624616   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00712185  0.01929658 -0.12700976]
Stock Position:  0.007121847811120609
Bond Position:  [-2.87977059]


portfolio before change:  [-2.15908601]
curr_Stock_Price:  101.39571135696133
curr_Factors:  [101.39571136  -1.00982652  -1.0306999 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.15908601]
Stock Price:  99.01032837429781
PL:  [-2.15908601]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.74664374e-02  3.62315951e-02 -8.57225420e-02]
 [-1.27830720e-01  7.99490383e-02  1.13693864e-02]
 [-1.26813187e-01  8.35784560e-02 -8.25286453e-02]
 [ 2.09544804e-01  1.09235132e-02 -1.11379593e-01]
 [ 6.78803763e-02 -1.22713113e-01 -1.67007265e-01]
 [ 4.84678335e-02  5.43679547e-03 -9.82850451e-02]
 [ 1.07603251e-01 -3.05928239e-03 -3.35942011e-01]
 [ 3.73423832e-01  2.33501488e-01 -2.64713803e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.96991274]
curr_Stock_Price:  99.42808936150905
curr_Factors:  [99.42808936 -0.81401176 -1.049602  ]
mat_Sqrt:  [[15.42239856  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00415169  0.01145744 -0.24454255]
Stock Position:  -0.004151687691531614
Bond Position:  [-1.55711836]


portfolio before change:  [-1.9748468]
curr_Stock_Price:  100.4289624840733
curr_Factors:  [100.42896248  -0.84461958  -1.11628086]
mat_Sqrt:  [[14.13353296  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00873424  0.02528211  0.03243369]
Stock Position:  -0.008734240639668473
Bond Position:  [-1.09767608]


portfolio before change:  [-2.00251022]
curr_Stock_Price:  103.53334686860818
curr_Factors:  [103.53334687  -0.85509266  -1.07061591]
mat_Sqrt:  [[15.09230758  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00937572  0.02642983 -0.23543125]
Stock Position:  -0.009375722604454842
Bond Position:  [-1.03181028]


portfolio before change:  [-2.00351699]
curr_Stock_Price:  103.58568820941612
curr_Factors:  [103.58568821  -0.6605315   -1.08223373]
mat_Sqrt:  [[18.13119517  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01031877  0.00345432 -0.31773498]
Stock Position:  0.010318767261128108
Bond Position:  [-3.0723936]


portfolio before change:  [-2.01183428]
curr_Stock_Price:  102.92856434654338
curr_Factors:  [102.92856435  -0.71236951  -1.06258721]
mat_Sqrt:  [[17.44544316  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00175528 -0.03880529 -0.47642524]
Stock Position:  0.0017552848523636093
Bond Position:  [-2.19250323]


portfolio before change:  [-2.01211129]
curr_Stock_Price:  103.39544847028145
curr_Factors:  [103.39544847  -0.27808235  -1.05878328]
mat_Sqrt:  [[27.15864221  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00105108  0.00171927 -0.28037988]
Stock Position:  0.0010510783246123392
Bond Position:  [-2.12078801]


portfolio before change:  [-2.00935137]
curr_Stock_Price:  107.0303622240284
curr_Factors:  [107.03036222  -0.18491129  -1.06800382]
mat_Sqrt:  [[30.57545147  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00127391 -0.00096743 -0.95834905]
Stock Position:  0.0012739103792578773
Bond Position:  [-2.14569846]


portfolio before change:  [-2.01051312]
curr_Stock_Price:  106.96079301296004
curr_Factors:  [106.96079301  -0.20012786  -1.04945609]
mat_Sqrt:  [[30.65753298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01061463  0.07383965 -0.7551548 ]
Stock Position:  0.010614628901920508
Bond Position:  [-3.14586224]


portfolio before change:  [-2.03034417]
curr_Stock_Price:  105.24073904813491
curr_Factors:  [105.24073905  -0.17959904  -1.00582066]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.03034417]
Stock Price:  98.00606438459637
PL:  [-2.03034417]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 1.47064460e-01 -1.16239944e-02 -5.08922058e-02]
 [-4.23023656e-01 -1.51802458e-01 -3.24144950e-01]
 [-1.15314877e-01  6.24564490e-02 -7.39960704e-02]
 [ 1.20762915e-01 -1.77399380e-02 -2.21439297e-01]
 [ 6.83647789e-02 -1.19214892e-01 -1.68586069e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 5.92295991e-02  5.81383038e-02 -2.10663997e-01]
 [ 2.99740548e-01  1.73772147e-01 -1.78700368e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.50778019]
curr_Stock_Price:  102.97784751714838
curr_Factors:  [102.97784752  -1.4469099   -1.04390235]
mat_Sqrt:  [[ 8.53095776  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01598601 -0.00367583 -0.1451813 ]
Stock Position:  0.015986013013318815
Bond Position:  [21.86157498]


portfolio before change:  [23.52338132]
curr_Stock_Price:  103.26982783808653
curr_Factors:  [103.26982784  -1.21546424  -1.07030675]
mat_Sqrt:  [[10.50208972  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04695342 -0.04800415 -0.92469532]
Stock Position:  -0.04695341622311747
Bond Position:  [28.37225253]


portfolio before change:  [23.58792947]
curr_Stock_Price:  102.1973077661985
curr_Factors:  [102.19730777  -1.00141379  -1.05059523]
mat_Sqrt:  [[13.1299556   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00981014  0.01975046 -0.21109019]
Stock Position:  -0.009810135491966231
Bond Position:  [24.59049891]


portfolio before change:  [23.5981194]
curr_Stock_Price:  102.4122279128534
curr_Factors:  [102.41222791  -0.87144811  -1.01895858]
mat_Sqrt:  [[15.46530974  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00485627 -0.00560986 -0.63170468]
Stock Position:  0.004856272911199532
Bond Position:  [23.10077767]


portfolio before change:  [23.60833089]
curr_Stock_Price:  102.13592901382759
curr_Factors:  [102.13592901  -0.62782072  -0.96156304]
mat_Sqrt:  [[20.84097095  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00148142 -0.03769906 -0.48092913]
Stock Position:  0.0014814173664134225
Bond Position:  [23.45702495]


portfolio before change:  [23.61721444]
curr_Stock_Price:  100.21351542847177
curr_Factors:  [100.21351543  -0.6104584   -0.93327192]
mat_Sqrt:  [[21.40389127  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00110508 -0.00193948 -0.30510753]
Stock Position:  0.0011050796954713662
Bond Position:  [23.50647052]


portfolio before change:  [23.6314437]
curr_Stock_Price:  102.45143644306155
curr_Factors:  [102.45143644  -0.53861361  -0.89749537]
mat_Sqrt:  [[24.36822225  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00072755  0.01838495 -0.60096575]
Stock Position:  0.0007275506252785511
Bond Position:  [23.55690509]


portfolio before change:  [23.64544329]
curr_Stock_Price:  105.50028677221191
curr_Factors:  [105.50028677  -0.64324221  -0.87150479]
mat_Sqrt:  [[23.19569423  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0115431   0.05495158 -0.50978241]
Stock Position:  0.01154310206707004
Bond Position:  [22.42764271]


portfolio before change:  [23.67973488]
curr_Stock_Price:  107.49931372095392
curr_Factors:  [107.49931372  -0.42169971  -0.87742683]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.67973488]
Stock Price:  107.14696369426342
PL:  [16.53277119]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [ 3.00017063e-02  7.60847038e-02  4.37685608e-02]
 [-1.03066685e-01  3.99569321e-02 -6.49070282e-02]
 [-4.06237695e-02 -9.62683375e-02 -5.57613463e-01]
 [ 6.87220606e-02 -1.16634702e-01 -1.69750551e-01]
 [ 4.93342576e-02  8.98560630e-03 -9.56263177e-02]
 [ 6.13690235e-02  7.76502279e-02 -1.76060173e-01]
 [ 1.64190219e-01  6.55235925e-02 -2.58346332e-02]
 [-8.56337834e-02 -8.13173452e-02 -2.64775218e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.68996133]
curr_Stock_Price:  100.77398111203138
curr_Factors:  [100.77398111  -1.3608467   -0.95775798]
mat_Sqrt:  [[ 9.9172485   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00622476  0.01250945 -0.27262553]
Stock Position:  -0.006224761137986886
Bond Position:  [8.31725529]


portfolio before change:  [7.70658279]
curr_Stock_Price:  98.77200954561131
curr_Factors:  [98.77200955 -1.35906343 -0.88946162]
mat_Sqrt:  [[10.42585947  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00392298 0.0240601  0.12485952]
Stock Position:  0.003922978729890846
Bond Position:  [7.31910229]


portfolio before change:  [7.71182429]
curr_Stock_Price:  99.17502956562973
curr_Factors:  [99.17502957 -1.72085476 -0.85115374]
mat_Sqrt:  [[ 7.57518492  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01521865  0.01263549 -0.18516168]
Stock Position:  -0.015218650681822874
Bond Position:  [9.22113442]


portfolio before change:  [7.69316479]
curr_Stock_Price:  100.70415473405552
curr_Factors:  [100.70415473  -1.69799405  -0.80817021]
mat_Sqrt:  [[ 8.21550149  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01910191 -0.03044272 -1.590716  ]
Stock Position:  -0.019101911069421437
Bond Position:  [9.6168066]


portfolio before change:  [7.70667242]
curr_Stock_Price:  100.24880625696935
curr_Factors:  [100.24880626  -2.0105551   -0.76006103]
mat_Sqrt:  [[ 6.27792197  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00494756 -0.03688313 -0.48425107]
Stock Position:  0.00494755742372322
Bond Position:  [7.2106857]


portfolio before change:  [7.70924728]
curr_Stock_Price:  100.040343026661
curr_Factors:  [100.04034303  -1.24054851  -0.76198897]
mat_Sqrt:  [[13.50467683  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00222491  0.0028415  -0.27279527]
Stock Position:  0.0022249051174238884
Bond Position:  [7.48666701]


portfolio before change:  [7.71816635]
curr_Stock_Price:  102.36619158137492
curr_Factors:  [102.36619158  -1.4182867   -0.78692055]
mat_Sqrt:  [[11.28358757  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00243148  0.02455516 -0.50225067]
Stock Position:  0.002431479461245584
Bond Position:  [7.46926505]


portfolio before change:  [7.72361809]
curr_Stock_Price:  103.07200836004195
curr_Factors:  [103.07200836  -1.40473964  -0.7726938 ]
mat_Sqrt:  [[11.68136004  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01374913  0.02072038 -0.07369902]
Stock Position:  0.013749131802270912
Bond Position:  [6.30646746]


portfolio before change:  [7.72826829]
curr_Stock_Price:  103.18082805009236
curr_Factors:  [103.18082805  -1.04541155  -0.757826  ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.72826829]
Stock Price:  106.35706427444694
PL:  [1.37120401]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-3.22789907e-01 -4.46033529e-02 -1.64129568e-01]
 [-1.34187247e-01  9.71243562e-02 -8.80007298e-02]
 [ 2.86690074e-01  9.73661121e-03 -1.51674738e-01]
 [ 5.14079885e-02 -1.09943716e-01 -1.34727170e-01]
 [-1.86801815e-02 -1.64477383e-02  2.55025489e-04]
 [ 1.81197310e-01 -6.90247712e-02 -4.77501889e-01]
 [ 4.12796092e-01  3.11667589e-01 -3.07085308e-01]
 [-8.27528921e-02 -8.52820069e-02 -1.22932052e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.57426304]
curr_Stock_Price:  100.47920492258244
curr_Factors:  [100.47920492  -1.08912449  -0.99615458]
mat_Sqrt:  [[12.4867955   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00494382  0.01250945 -0.27262553]
Stock Position:  -0.004943822701605812
Bond Position:  [6.07101442]


portfolio before change:  [5.57007509]
curr_Stock_Price:  101.94046710660808
curr_Factors:  [101.94046711  -0.89435804  -0.99562766]
mat_Sqrt:  [[15.40055102  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02320984 -0.01410482 -0.46821597]
Stock Position:  -0.02320984279984166
Bond Position:  [7.9360973]


portfolio before change:  [5.51934899]
curr_Stock_Price:  104.29701653040897
curr_Factors:  [104.29701653  -0.72106955  -1.00420735]
mat_Sqrt:  [[18.57777277  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00805493  0.03071342 -0.25104159]
Stock Position:  -0.008054925755828928
Bond Position:  [6.35945371]


portfolio before change:  [5.50729031]
curr_Stock_Price:  106.18892706611663
curr_Factors:  [106.18892707  -1.00151518  -0.97787866]
mat_Sqrt:  [[14.67031395  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01744891  0.00307899 -0.43268581]
Stock Position:  0.017448910575869874
Bond Position:  [3.65440922]


portfolio before change:  [5.53635726]
curr_Stock_Price:  107.75001514456787
curr_Factors:  [107.75001514  -0.66231597  -0.9861555 ]
mat_Sqrt:  [[20.72503531  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00101656 -0.03476726 -0.38433911]
Stock Position:  0.0010165572831668326
Bond Position:  [5.42682319]


portfolio before change:  [5.53655654]
curr_Stock_Price:  105.27616710045734
curr_Factors:  [105.2761671   -0.25220657  -1.02129477]
mat_Sqrt:  [[29.46154107  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0006467  -0.00520123  0.00072752]
Stock Position:  -0.0006467008408345183
Bond Position:  [5.60463872]


portfolio before change:  [5.53510273]
curr_Stock_Price:  111.85854795673369
curr_Factors:  [111.85854796  -0.68491172  -1.03006618]
mat_Sqrt:  [[20.13092542  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00407062 -0.02182755 -1.36217998]
Stock Position:  0.004070624236153414
Bond Position:  [5.07976861]


portfolio before change:  [5.55150008]
curr_Stock_Price:  115.2626543394821
curr_Factors:  [115.26265434  -1.30301063  -1.01432079]
mat_Sqrt:  [[11.35754236  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03153497  0.09855795 -0.87602891]
Stock Position:  0.03153497269896754
Bond Position:  [1.91669543]


portfolio before change:  [5.49655982]
curr_Stock_Price:  113.49005568042338
curr_Factors:  [113.49005568  -0.8256973   -1.04635249]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.49655982]
Stock Price:  113.24460437821044
PL:  [-7.74804456]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-2.87323927e-01  1.61937723e-02 -6.68213771e-02]
 [-1.23897354e-01  7.82221702e-02 -8.03648873e-02]
 [ 9.28885018e-02 -8.17406983e-03 -1.68193483e-01]
 [ 6.87236984e-02 -1.16622875e-01 -1.69755889e-01]
 [ 4.66996808e-02 -1.80543120e-03 -1.03710836e-01]
 [ 2.13490020e-02  1.05820322e-02 -1.04733955e-02]
 [ 8.66952666e-02  1.97312311e-02  8.61480706e-03]
 [-1.04186679e-01 -9.89204541e-02  2.01631456e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.73662584]
curr_Stock_Price:  100.50182662070202
curr_Factors:  [100.50182662  -1.30392501  -0.97720686]
mat_Sqrt:  [[10.26812075  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00601205  0.01250945 -0.27262553]
Stock Position:  -0.006012054646424995
Bond Position:  [6.34084832]


portfolio before change:  [5.7350013]
curr_Stock_Price:  101.2995164670243
curr_Factors:  [101.29951647  -0.75961154  -1.00448604]
mat_Sqrt:  [[17.35679467  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01731574  0.00512092 -0.19062279]
Stock Position:  -0.017315735302539416
Bond Position:  [7.48907692]


portfolio before change:  [5.70334253]
curr_Stock_Price:  103.34414510363759
curr_Factors:  [103.3441451   -1.02774064  -1.0019116 ]
mat_Sqrt:  [[13.57747804  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01018467  0.02473602 -0.22925865]
Stock Position:  -0.01018466611069208
Bond Position:  [6.75586814]


portfolio before change:  [5.72315632]
curr_Stock_Price:  101.73044386344652
curr_Factors:  [101.73044386  -0.58768645  -1.0157486 ]
mat_Sqrt:  [[20.4685908   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00285047 -0.00258487 -0.47980919]
Stock Position:  0.002850469665615118
Bond Position:  [5.43317677]


portfolio before change:  [5.72478098]
curr_Stock_Price:  101.34713540604216
curr_Factors:  [101.34713541  -1.49941291  -1.00077313]
mat_Sqrt:  [[ 8.31753196  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00373443 -0.03687939 -0.4842663 ]
Stock Position:  0.0037344290501226027
Bond Position:  [5.34630729]


portfolio before change:  [5.72293782]
curr_Stock_Price:  100.13758461340117
curr_Factors:  [100.13758461  -1.60804508  -0.9972617 ]
mat_Sqrt:  [[ 7.3982117   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00344451 -0.00057093 -0.29585815]
Stock Position:  0.0034445052403491
Bond Position:  [5.37801338]


portfolio before change:  [5.72056728]
curr_Stock_Price:  98.66851614195511
curr_Factors:  [98.66851614 -1.44009968 -1.09873525]
mat_Sqrt:  [[ 7.79070204  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00250098  0.00334633 -0.02987768]
Stock Position:  0.002500975635104195
Bond Position:  [5.47379973]


portfolio before change:  [5.72363957]
curr_Stock_Price:  98.80234436023868
curr_Factors:  [98.80234436 -1.39490912 -1.12891148]
mat_Sqrt:  [[ 7.91928342  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01123375 0.00623956 0.02457565]
Stock Position:  0.011233745554154044
Bond Position:  [4.61371917]


portfolio before change:  [5.72518765]
curr_Stock_Price:  98.73474877239725
curr_Factors:  [98.73474877 -1.47025312 -1.19633596]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.72518765]
Stock Price:  98.85678618074765
PL:  [5.72518765]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 2.09228698e-01 -2.83424966e-02 -3.62994327e-02]
 [-4.69024200e-01 -1.98788259e-01 -3.93642166e-01]
 [-1.30383797e-01  9.01375472e-02 -8.51782958e-02]
 [ 2.00840500e-01 -2.12901599e-03 -1.70859881e-01]
 [ 6.65659605e-02 -1.29546106e-01 -1.63155403e-01]
 [ 9.92252475e-03 -1.62727634e-02 -5.94928591e-02]
 [ 5.28673932e-02  8.69363628e-02 -1.56697385e-01]
 [ 1.31506425e-01  3.97603095e-02  9.91386474e-03]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [29.38580391]
curr_Stock_Price:  103.7968213024835
curr_Factors:  [103.7968213   -1.53368664  -0.97690175]
mat_Sqrt:  [[ 8.43042307  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02385258 -0.00896268 -0.10355218]
Stock Position:  0.0238525759863897
Bond Position:  [26.90998234]


portfolio before change:  [29.39940418]
curr_Stock_Price:  103.80277113022623
curr_Factors:  [103.80277113  -1.11902607  -1.00489272]
mat_Sqrt:  [[12.41088468  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04467923 -0.06286237 -1.12295153]
Stock Position:  -0.04467922922875321
Bond Position:  [34.03723199]


portfolio before change:  [29.40853034]
curr_Stock_Price:  103.97951364158413
curr_Factors:  [103.97951364  -0.87317969  -0.9689448 ]
mat_Sqrt:  [[16.47871267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00882614  0.028504   -0.24298997]
Stock Position:  -0.008826138623464702
Bond Position:  [30.32626794]


portfolio before change:  [29.42539684]
curr_Stock_Price:  103.78695130256747
curr_Factors:  [103.7869513   -0.90778849  -0.97853007]
mat_Sqrt:  [[15.73711115  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01054253 -0.00067325 -0.48741568]
Stock Position:  0.010542525865131476
Bond Position:  [28.33122022]


portfolio before change:  [29.44919693]
curr_Stock_Price:  104.70048316249365
curr_Factors:  [104.70048316  -1.09201171  -0.99227492]
mat_Sqrt:  [[13.02430335  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00229702 -0.04096608 -0.46543695]
Stock Position:  0.0022970239921799693
Bond Position:  [29.20869741]


portfolio before change:  [29.46286131]
curr_Stock_Price:  104.28968065059249
curr_Factors:  [104.28968065  -0.98852568  -1.01156419]
mat_Sqrt:  [[14.11280503  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018718 -0.0051459  -0.16971657]
Stock Position:  -0.0001871750658493362
Bond Position:  [29.48238173]


portfolio before change:  [29.47765565]
curr_Stock_Price:  104.0253837912834
curr_Factors:  [104.02538379  -1.49713931  -0.97424416]
mat_Sqrt:  [[ 8.78680773  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00263194  0.02749169 -0.44701402]
Stock Position:  0.002631941116583696
Bond Position:  [29.20386697]


portfolio before change:  [29.48940823]
curr_Stock_Price:  102.94139014936799
curr_Factors:  [102.94139015  -1.62214582  -0.9634376 ]
mat_Sqrt:  [[ 7.75685046  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01734682 0.01257331 0.0282815 ]
Stock Position:  0.017346820272512244
Bond Position:  [27.70370244]


portfolio before change:  [29.52843016]
curr_Stock_Price:  104.3921815641012
curr_Factors:  [104.39218156  -1.14833088  -0.98618789]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [29.52843016]
Stock Price:  105.01614747167366
PL:  [24.51228269]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-3.94376827e-02  7.58912751e-02  2.41009286e-02]
 [-9.31038690e-03 -1.15935034e-02 -8.04637306e-02]
 [ 7.96424044e-02 -5.58906994e-02 -3.53999051e-01]
 [-1.46421700e-02 -8.18518777e-02 -1.09659606e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 4.57921068e-03  1.50569655e-01 -2.70445101e-02]
 [ 1.28978846e-01  5.03867443e-02 -2.88340010e-02]
 [-9.85295271e-02 -7.71363523e-02  1.11458313e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.72229798]
curr_Stock_Price:  100.22117417732197
curr_Factors:  [100.22117418  -0.77390812  -1.0055847 ]
mat_Sqrt:  [[16.90968714  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365072  0.01250945 -0.27262553]
Stock Position:  -0.0036507182292607084
Bond Position:  [4.08817724]


portfolio before change:  [3.72806312]
curr_Stock_Price:  99.2020483488931
curr_Factors:  [99.20204835 -0.55333054 -1.00200814]
mat_Sqrt:  [[20.94332515  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0015546   0.02399893  0.06875324]
Stock Position:  -0.0015546049514680693
Bond Position:  [3.88228311]


portfolio before change:  [3.73266645]
curr_Stock_Price:  97.48990486932176
curr_Factors:  [97.48990487 -0.30218692 -1.09239052]
mat_Sqrt:  [[24.17143092  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00107707 -0.00366619 -0.22954063]
Stock Position:  -0.001077069876088591
Bond Position:  [3.83766989]


portfolio before change:  [3.7352934]
curr_Stock_Price:  96.83290516531999
curr_Factors:  [96.83290517 -0.57259011 -1.10151252]
mat_Sqrt:  [[18.15387857  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.27178514e-04 -1.76741910e-02 -1.00986076e+00]
Stock Position:  0.0003271785140340566
Bond Position:  [3.70361175]


portfolio before change:  [3.73762571]
curr_Stock_Price:  98.30011259998864
curr_Factors:  [98.3001126  -0.10833562 -1.14456539]
mat_Sqrt:  [[28.08186963  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00139377 -0.02588384 -0.31282833]
Stock Position:  -0.0013937729339637737
Bond Position:  [3.87463374]


portfolio before change:  [3.73595459]
curr_Stock_Price:  100.8894252737363
curr_Factors:  [100.88942527  -0.27036565  -1.20067067]
mat_Sqrt:  [[23.17302297  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00102071 -0.00193948 -0.30510753]
Stock Position:  0.0010207129935602707
Bond Position:  [3.63297545]


portfolio before change:  [3.73822437]
curr_Stock_Price:  101.33307394648064
curr_Factors:  [101.33307395  -0.66023829  -1.22615905]
mat_Sqrt:  [[15.36382181  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00019178  0.04761431 -0.07715046]
Stock Position:  0.00019177942809367186
Bond Position:  [3.71879078]


portfolio before change:  [3.74006749]
curr_Stock_Price:  101.24573809566888
curr_Factors:  [101.2457381   -0.81171159  -1.21010184]
mat_Sqrt:  [[13.40646669  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00927866  0.01593369 -0.08225538]
Stock Position:  0.009278664787868353
Bond Position:  [2.80064222]


portfolio before change:  [3.72067136]
curr_Stock_Price:  99.00438109299066
curr_Factors:  [99.00438109 -0.33912221 -1.14826147]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.72067136]
Stock Price:  100.49501948929597
PL:  [3.22565187]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-3.15503189e-01 -3.36914837e-02 -1.46941453e-01]
 [-8.98584157e-02  1.56937857e-02 -5.51055394e-02]
 [ 4.23518034e-02  2.69372996e-03 -5.24702716e-02]
 [-5.49903663e-02  1.30109207e-03 -8.11093788e-03]
 [ 5.52603776e-02  3.32585684e-02 -7.74412995e-02]
 [ 1.21502462e-01 -1.11615054e-01  1.15629534e-01]
 [ 1.04687773e-01  2.86192144e-02  1.02998616e-02]
 [-9.79502392e-02 -7.73241661e-02  1.05262116e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.06076437]
curr_Stock_Price:  100.54698822113453
curr_Factors:  [100.54698822  -0.89164806  -0.96820399]
mat_Sqrt:  [[15.65473003  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00394338  0.01250945 -0.27262553]
Stock Position:  -0.003943377045614315
Bond Position:  [6.45725906]


portfolio before change:  [6.05895516]
curr_Stock_Price:  101.82473707751109
curr_Factors:  [101.82473708  -0.89014554  -0.99635369]
mat_Sqrt:  [[15.43679344  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02243778 -0.01065418 -0.41918306]
Stock Position:  -0.02243778143955811
Bond Position:  [8.34367636]


portfolio before change:  [6.1083417]
curr_Stock_Price:  99.809669199187
curr_Factors:  [99.8096692  -0.80465099 -1.00066154]
mat_Sqrt:  [[16.4110114   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00613622  0.00496281 -0.15720077]
Stock Position:  -0.006136219917044746
Bond Position:  [6.72079578]


portfolio before change:  [6.10995059]
curr_Stock_Price:  100.09524345177044
curr_Factors:  [100.09524345  -0.23840273  -1.05594095]
mat_Sqrt:  [[27.43387286  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011559   0.00085183 -0.14968308]
Stock Position:  0.001155903362391486
Bond Position:  [5.99425016]


portfolio before change:  [6.10821069]
curr_Stock_Price:  95.99648388139943
curr_Factors:  [95.99648388 -0.4811609  -1.0263667 ]
mat_Sqrt:  [[21.25907716  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266298  0.00041144 -0.02313825]
Stock Position:  -0.0026629759195032107
Bond Position:  [6.36384702]


portfolio before change:  [6.10249226]
curr_Stock_Price:  99.33904102479359
curr_Factors:  [99.33904102 -0.71618406 -1.03829361]
mat_Sqrt:  [[17.18541363  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00234568  0.01051728 -0.22091847]
Stock Position:  0.0023456794177951676
Bond Position:  [5.86947472]


portfolio before change:  [6.10042348]
curr_Stock_Price:  97.20564786296679
curr_Factors:  [97.20564786 -0.31480764 -1.09018537]
mat_Sqrt:  [[23.85123022  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00596294 -0.03529578  0.32985888]
Stock Position:  0.005962935768293783
Bond Position:  [5.52079244]


portfolio before change:  [6.10343371]
curr_Stock_Price:  97.24742948769237
curr_Factors:  [97.24742949 -0.33875425 -1.072006  ]
mat_Sqrt:  [[23.72426358  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00453246 0.00905019 0.02938264]
Stock Position:  0.004532455482456791
Bond Position:  [5.66266406]


portfolio before change:  [6.11331047]
curr_Stock_Price:  98.80171270288258
curr_Factors:  [ 9.88017127e+01  3.29323919e-02 -1.07056487e+00]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.11331047]
Stock Price:  103.2297166514527
PL:  [2.88359381]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.32464007e-02  3.95583681e-02 -9.55668178e-02]
 [-9.00129752e-02  9.66589277e-02  2.14122201e-02]
 [-1.14881096e-01  6.16596076e-02 -7.36741735e-02]
 [ 7.91946692e-02 -1.41084160e-02 -1.92299529e-01]
 [ 6.79508216e-02 -1.22204376e-01 -1.67236866e-01]
 [ 4.55509655e-02 -6.51048644e-03 -1.07235808e-01]
 [ 4.08108946e-02  7.80820947e-02 -1.69030045e-01]
 [ 2.38844454e-01  1.42306352e-01 -1.66493298e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.79457603]
curr_Stock_Price:  100.09191645514643
curr_Factors:  [100.09191646  -0.72551337  -1.05234597]
mat_Sqrt:  [[16.91548699  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364947  0.01250945 -0.27262553]
Stock Position:  -0.0036494664989274446
Bond Position:  [3.15985812]


portfolio before change:  [2.79596392]
curr_Stock_Price:  100.14464452020071
curr_Factors:  [100.14464452  -0.85911573  -1.02037303]
mat_Sqrt:  [[15.28889616  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00543836  0.03056624  0.0610831 ]
Stock Position:  -0.005438358690301059
Bond Position:  [3.34058642]


portfolio before change:  [2.7874952]
curr_Stock_Price:  102.0090725125817
curr_Factors:  [102.00907251  -0.88655777  -1.01915886]
mat_Sqrt:  [[15.17038427  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0084591   0.01949848 -0.21017191]
Stock Position:  -0.008459095523571995
Bond Position:  [3.65039969]


portfolio before change:  [2.79312053]
curr_Stock_Price:  101.55989049992337
curr_Factors:  [101.5598905   -0.64521965  -1.01392793]
mat_Sqrt:  [[19.32696166  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00204778 -0.00446147 -0.54857703]
Stock Position:  0.002047782526736828
Bond Position:  [2.58514796]


portfolio before change:  [2.79683596]
curr_Stock_Price:  102.74288968824624
curr_Factors:  [102.74288969  -1.30209424  -1.08254708]
mat_Sqrt:  [[ 9.46488209  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00323918 -0.03864442 -0.47708023]
Stock Position:  0.00323917778754314
Bond Position:  [2.46403347]


portfolio before change:  [2.7950978]
curr_Stock_Price:  101.82584216326491
curr_Factors:  [101.82584216  -0.75828859  -1.08046405]
mat_Sqrt:  [[16.19190267  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00145094 -0.0020588  -0.30591391]
Stock Position:  0.0014509380552526344
Bond Position:  [2.64735481]


portfolio before change:  [2.79877354]
curr_Stock_Price:  103.44667706118479
curr_Factors:  [103.44667706  -0.62165218  -1.08134928]
mat_Sqrt:  [[18.84136693  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.41785996e-04  2.46917264e-02 -4.82195670e-01]
Stock Position:  0.0004417859959945071
Bond Position:  [2.75307225]


portfolio before change:  [2.79953669]
curr_Stock_Price:  102.0574709906287
curr_Factors:  [102.05747099   0.14654251  -1.11794234]
mat_Sqrt:  [[38.63413696  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00539765  0.04500122 -0.47495904]
Stock Position:  0.005397648357812819
Bond Position:  [2.24866635]


portfolio before change:  [2.82095529]
curr_Stock_Price:  105.81725317387104
curr_Factors:  [105.81725317  -0.54180271  -1.11568374]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.82095529]
Stock Price:  104.8333475259922
PL:  [-2.01239224]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-1.77592764e-02 -4.94928474e-03  1.43893668e-03]
 [-1.12097637e-01  8.88719524e-02  1.02274243e-02]
 [-1.26293382e-01  8.26235929e-02 -8.21429129e-02]
 [ 1.25925381e-01 -1.87134921e-02 -2.27910938e-01]
 [ 6.86321866e-02 -1.17283747e-01 -1.69457626e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 8.16513232e-02  3.24434651e-02  6.90809838e-02]
 [ 9.51846661e-02  2.34708853e-02  9.04125878e-03]
 [-1.06371514e-01 -8.93478389e-02  1.44107681e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.73645047]
curr_Stock_Price:  99.04263295912543
curr_Factors:  [99.04263296 -0.64104535 -0.92775674]
mat_Sqrt:  [[20.63004081  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008528  -0.0015651   0.00410489]
Stock Position:  -0.0008528022213022063
Bond Position:  [-4.65198669]


portfolio before change:  [-4.73948831]
curr_Stock_Price:  99.87666825240126
curr_Factors:  [99.87666825 -0.62930775 -0.878475  ]
mat_Sqrt:  [[22.11272772  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00487119  0.02810378  0.02917599]
Stock Position:  -0.004871190468277028
Bond Position:  [-4.25297003]


portfolio before change:  [-4.75742301]
curr_Stock_Price:  103.12180610348402
curr_Factors:  [103.1218061   -0.65558664  -0.91789697]
mat_Sqrt:  [[21.37938764  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00659174  0.02612787 -0.23433087]
Stock Position:  -0.006591741750187695
Bond Position:  [-4.07767069]


portfolio before change:  [-4.75697956]
curr_Stock_Price:  102.7451543038248
curr_Factors:  [102.7451543   -0.96036214  -0.8847372 ]
mat_Sqrt:  [[16.23472306  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00486119 -0.00591773 -0.65016647]
Stock Position:  0.004861190119929077
Bond Position:  [-5.25644329]


portfolio before change:  [-4.76479101]
curr_Stock_Price:  101.67904321255827
curr_Factors:  [101.67904321  -0.76711731  -0.90509248]
mat_Sqrt:  [[19.09853119  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00162387 -0.03708838 -0.48341544]
Stock Position:  0.0016238704343544026
Bond Position:  [-4.9299046]


portfolio before change:  [-4.76901194]
curr_Stock_Price:  100.59806953056518
curr_Factors:  [100.59806953  -0.72626614  -0.89454565]
mat_Sqrt:  [[19.89207244  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00118907 -0.00193948 -0.30510753]
Stock Position:  0.0011890669370740637
Bond Position:  [-4.88862978]


portfolio before change:  [-4.77273112]
curr_Stock_Price:  99.52642502681644
curr_Factors:  [99.52642503 -0.74257169 -0.92557306]
mat_Sqrt:  [[18.77034898  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00514589 0.01025952 0.19706882]
Stock Position:  0.005145887628583616
Bond Position:  [-5.28488292]


portfolio before change:  [-4.78373262]
curr_Stock_Price:  97.90213958842149
curr_Factors:  [97.90213959 -0.85901874 -0.94733579]
mat_Sqrt:  [[16.08060493  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00607168 0.00742215 0.02579219]
Stock Position:  0.006071675871354428
Bond Position:  [-5.37816267]


portfolio before change:  [-4.79108645]
curr_Stock_Price:  97.1339690541256
curr_Factors:  [97.13396905 -0.36313218 -0.87438291]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.79108645]
Stock Price:  96.89453285853229
PL:  [-4.79108645]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.66447529e-02  3.68793520e-02 -8.76393238e-02]
 [-8.26692449e-02  9.76714165e-02  2.29971948e-02]
 [-1.08631093e-01  5.01785625e-02 -6.90362204e-02]
 [ 1.46959014e-01 -4.23216415e-03 -1.65568146e-01]
 [ 6.82316676e-02 -1.20176184e-01 -1.68152222e-01]
 [-2.84423986e-02 -2.30654537e-02 -2.97804876e-02]
 [ 7.99132990e-02  6.03974422e-02 -2.12870180e-01]
 [ 1.87846926e-01  8.43205839e-02 -5.22010350e-02]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.41161758]
curr_Stock_Price:  99.50587555626991
curr_Factors:  [99.50587556 -0.6945286  -1.00206855]
mat_Sqrt:  [[18.24004674  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00348584  0.01166228 -0.2500106 ]
Stock Position:  -0.003485837237672364
Bond Position:  [-1.0647563]


portfolio before change:  [-1.41422833]
curr_Stock_Price:  100.10207125993858
curr_Factors:  [100.10207126  -0.88697236  -0.98446507]
mat_Sqrt:  [[15.40593689  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00489766  0.03088641  0.0656046 ]
Stock Position:  -0.004897663647637174
Bond Position:  [-0.92396206]


portfolio before change:  [-1.42042022]
curr_Stock_Price:  101.27197364636368
curr_Factors:  [101.27197365  -0.79528171  -0.93219472]
mat_Sqrt:  [[17.99930724  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00674623  0.01586785 -0.19694112]
Stock Position:  -0.006746228962660782
Bond Position:  [-0.7372163]


portfolio before change:  [-1.43212473]
curr_Stock_Price:  102.95229115232549
curr_Factors:  [102.95229115  -0.77917722  -0.87034109]
mat_Sqrt:  [[19.78150431  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0057151  -0.00133833 -0.47231984]
Stock Position:  0.005715100415117835
Bond Position:  [-2.02050741]


portfolio before change:  [-1.43664286]
curr_Stock_Price:  102.33854304990794
curr_Factors:  [102.33854305  -1.25539299  -0.85283395]
mat_Sqrt:  [[12.42933533  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0024784  -0.03800305 -0.47969149]
Stock Position:  0.002478395056928148
Bond Position:  [-1.6902782]


portfolio before change:  [-1.43174721]
curr_Stock_Price:  104.65496483159545
curr_Factors:  [104.65496483  -1.25701646  -0.91791237]
mat_Sqrt:  [[11.89050349  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295335 -0.00729394 -0.08495544]
Stock Position:  -0.0029533537126548697
Bond Position:  [-1.12266408]


portfolio before change:  [-1.43201604]
curr_Stock_Price:  104.55587683564315
curr_Factors:  [104.55587684  -1.54881318  -0.86338739]
mat_Sqrt:  [[ 9.37007466  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00405768  0.01909935 -0.60725937]
Stock Position:  0.004057684922832752
Bond Position:  [-1.85627084]


portfolio before change:  [-1.43681179]
curr_Stock_Price:  103.60277469335904
curr_Factors:  [103.60277469  -1.28860994  -0.82749279]
mat_Sqrt:  [[12.48416923  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01436768  0.02666451 -0.14891502]
Stock Position:  0.014367682725355494
Bond Position:  [-2.92534359]


portfolio before change:  [-1.42032073]
curr_Stock_Price:  104.85239136030037
curr_Factors:  [104.85239136  -1.40980185  -0.85916209]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.42032073]
Stock Price:  104.24583880031805
PL:  [-5.66615954]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 1.04099033e-01 -6.88363491e-05 -6.09781451e-02]
 [-3.16054371e-01 -7.08154448e-03 -9.96407656e-02]
 [-1.03723964e-01  4.11643317e-02 -6.53947767e-02]
 [ 1.57413821e-01  2.06955666e-02 -2.42047815e-02]
 [ 6.79486682e-02 -1.22219927e-01 -1.67229848e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 1.30813629e-01 -1.52223381e-02 -2.78139115e-02]
 [ 1.54761628e-01  7.96354007e-02 -8.63957001e-02]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.68846794]
curr_Stock_Price:  102.30638197199819
curr_Factors:  [102.30638197  -1.24558302  -0.97026119]
mat_Sqrt:  [[11.15767772  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.21408772e-03 -2.17679649e-05 -1.73953675e-01]
Stock Position:  0.008214087716922993
Bond Position:  [17.84811435]


portfolio before change:  [18.69115876]
curr_Stock_Price:  101.54726352277015
curr_Factors:  [101.54726352  -0.59875119  -0.96664631]
mat_Sqrt:  [[21.22387741  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01585838 -0.00223938 -0.28424737]
Stock Position:  -0.01585837945668853
Bond Position:  [20.3015338]


portfolio before change:  [18.70827401]
curr_Stock_Price:  101.10825669182553
curr_Factors:  [101.10825669  -0.33202512  -0.99281771]
mat_Sqrt:  [[26.87909826  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00431598  0.0130173  -0.1865531 ]
Stock Position:  -0.004315984023210591
Bond Position:  [19.14465563]


portfolio before change:  [18.71249435]
curr_Stock_Price:  102.34885014114745
curr_Factors:  [102.34885014  -0.17391445  -0.99608387]
mat_Sqrt:  [[31.76575298  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00481674  0.00654451 -0.0690495 ]
Stock Position:  0.004816740775824796
Bond Position:  [18.21950647]


portfolio before change:  [18.72427994]
curr_Stock_Price:  102.9039067301905
curr_Factors:  [102.90390673  -0.17242455  -0.93972324]
mat_Sqrt:  [[33.84014488  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090595 -0.03864933 -0.47706021]
Stock Position:  0.0009059451040433532
Bond Position:  [18.63105465]


portfolio before change:  [18.7317161]
curr_Stock_Price:  100.82684854624132
curr_Factors:  [ 1.00826849e+02  1.84889714e-03 -9.21512357e-01]
mat_Sqrt:  [[40.19494392  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00058846 -0.00193948 -0.30510753]
Stock Position:  0.0005884572371816969
Bond Position:  [18.67238381]


portfolio before change:  [18.74076978]
curr_Stock_Price:  100.34279199607172
curr_Factors:  [100.342792     0.38497059  -0.88865327]
mat_Sqrt:  [[60.6372603   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0020572  -0.00481373 -0.07934535]
Stock Position:  0.002057202097208202
Bond Position:  [18.53434437]


portfolio before change:  [18.7491531]
curr_Stock_Price:  99.91203042121236
curr_Factors:  [99.91203042  0.27655744 -0.8873603 ]
mat_Sqrt:  [[54.2437213   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00256587  0.02518292 -0.24646288]
Stock Position:  0.002565870367003153
Bond Position:  [18.49279178]


portfolio before change:  [18.78841618]
curr_Stock_Price:  111.60957167001568
curr_Factors:  [111.60957167   0.13750488  -0.94256322]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.78841618]
Stock Price:  102.80244607043272
PL:  [15.98597011]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [-4.77520730e-02  3.60064206e-02 -8.50562267e-02]
 [-2.61911566e-01  1.30663375e-02 -8.01932528e-02]
 [-9.73789191e-02  2.95086974e-02 -6.06862955e-02]
 [ 7.69588246e-02 -3.73985281e-02 -3.01466780e-01]
 [ 6.87221422e-02 -1.16634113e-01 -1.69750817e-01]
 [ 4.56430818e-02 -6.13318492e-03 -1.06953139e-01]
 [ 2.54699387e-02  1.38493203e-01 -5.52152366e-02]
 [ 2.66290654e-01  1.59317621e-01 -1.81303251e-01]
 [-8.67164318e-02 -8.09663344e-02 -1.48972662e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.47463932]
curr_Stock_Price:  99.49709485806312
curr_Factors:  [99.49709486 -1.31047407 -1.04049627]
mat_Sqrt:  [[ 9.4797516   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00677069  0.01138623 -0.24264174]
Stock Position:  -0.006770685923646637
Bond Position:  [-0.80097574]


portfolio before change:  [-1.48722327]
curr_Stock_Price:  101.29652316847131
curr_Factors:  [101.29652317  -1.22862019  -1.07284674]
mat_Sqrt:  [[10.1409852   0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02740795  0.00413194 -0.22876903]
Stock Position:  -0.027407945873795858
Bond Position:  [1.28910635]


portfolio before change:  [-1.45990757]
curr_Stock_Price:  100.32341166235491
curr_Factors:  [100.32341166  -0.96986536  -1.07911334]
mat_Sqrt:  [[12.92832162  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00843145  0.00933147 -0.17312111]
Stock Position:  -0.008431453765327373
Bond Position:  [-0.61403536]


portfolio before change:  [-1.47197679]
curr_Stock_Price:  101.71844061797644
curr_Factors:  [101.71844062  -1.03094833  -1.1108076 ]
mat_Sqrt:  [[11.94667117  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00121009 -0.01182645 -0.86000081]
Stock Position:  0.0012100902162242818
Bond Position:  [-1.59506528]


portfolio before change:  [-1.47419375]
curr_Stock_Price:  100.54560727545187
curr_Factors:  [100.54560728  -0.56051741  -1.12641888]
mat_Sqrt:  [[18.60955461  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00166906 -0.03688295 -0.48425183]
Stock Position:  0.0016690577809018799
Bond Position:  [-1.64201018]


portfolio before change:  [-1.47374098]
curr_Stock_Price:  101.30890099620284
curr_Factors:  [101.308901    -0.70208529  -1.13858441]
mat_Sqrt:  [[16.07884735  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147106 -0.00193948 -0.30510753]
Stock Position:  0.001471063512212563
Bond Position:  [-1.62277281]


portfolio before change:  [-1.47402206]
curr_Stock_Price:  101.66953407245732
curr_Factors:  [101.66953407  -0.33128988  -1.14694075]
mat_Sqrt:  [[23.18480387  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00076667  0.0437954  -0.1575137 ]
Stock Position:  0.0007666683313650704
Bond Position:  [-1.55196887]


portfolio before change:  [-1.47341697]
curr_Stock_Price:  103.47118461030527
curr_Factors:  [ 1.03471185e+02 -5.07672882e-02 -1.15887785e+00]
mat_Sqrt:  [[30.86577676  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00756164  0.05038066 -0.51720771]
Stock Position:  0.0075616385041701265
Bond Position:  [-2.25582866]


portfolio before change:  [-1.46936514]
curr_Stock_Price:  104.1562245303408
curr_Factors:  [104.15622453  -0.25171809  -1.1321563 ]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.46936514]
Stock Price:  105.30128018308991
PL:  [-6.77064532]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 9.92682591e+01 -9.28292252e+00 -9.28028334e+00]
 [ 2.08139217e-02  2.23299312e-02 -8.05289474e-02]
 [-3.22637301e-01 -3.03079017e-02 -1.38712464e-01]
 [-9.58214697e-02  2.66477152e-02 -5.95305556e-02]
 [ 8.37202273e-02 -1.25837128e-02 -1.86594766e-01]
 [ 5.81901769e-02 -1.18714487e-01 -1.47446921e-01]
 [-8.65956170e-02 -4.97697242e-02  6.49762361e-02]
 [ 7.84402450e-02  6.31471031e-02 -4.85249352e-02]
 [ 2.73235721e-01  1.56909994e-01 -1.62969485e-01]
 [-8.38665242e-02 -8.18903170e-02 -4.53805316e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [99.26825908 -9.28292252 -9.28028334]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.17730387  -2.93551785 -26.47406523]
init_Out:  [2.49257202]
Stock Position:  7.177303865524689
Bond position:  [-715.23781453]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.91049578]
curr_Stock_Price:  101.36202009387063
curr_Factors:  [101.36202009  -0.85305329  -0.99248173]
mat_Sqrt:  [[16.00919815  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00030936  0.00706134 -0.22972667]
Stock Position:  0.00030935812264621304
Bond Position:  [11.87913862]


portfolio before change:  [11.91657301]
curr_Stock_Price:  101.80218445830099
curr_Factors:  [101.80218446  -0.68985437  -0.99287729]
mat_Sqrt:  [[18.92152001  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01858912 -0.0095842  -0.39570805]
Stock Position:  -0.01858912022959482
Bond Position:  [13.80898605]


portfolio before change:  [11.94871249]
curr_Stock_Price:  100.44476315674568
curr_Factors:  [100.44476316  -0.43184774  -0.96345007]
mat_Sqrt:  [[24.88611822  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00431104  0.00842675 -0.16982411]
Stock Position:  -0.004311040052644549
Bond Position:  [12.38173389]


portfolio before change:  [11.94933548]
curr_Stock_Price:  101.73666251338926
curr_Factors:  [101.73666251  -0.66083207  -0.94453975]
mat_Sqrt:  [[20.43023509  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00221764 -0.00397932 -0.53230293]
Stock Position:  0.002217635771957003
Bond Position:  [11.72372062]


portfolio before change:  [11.96556884]
curr_Stock_Price:  106.41282989646594
curr_Factors:  [106.4128299   -0.66219474  -0.96306257]
mat_Sqrt:  [[20.94853748  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00119471 -0.03754082 -0.42062502]
Stock Position:  0.0011947137272854424
Bond Position:  [11.83843597]


portfolio before change:  [11.97180041]
curr_Stock_Price:  106.67303662129318
curr_Factors:  [106.67303662   0.13921419  -0.98577177]
mat_Sqrt:  [[45.75087206  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00163095 -0.01573857  0.18535912]
Stock Position:  -0.001630951363312036
Bond Position:  [12.14577894]


portfolio before change:  [11.98739187]
curr_Stock_Price:  100.83776031310242
curr_Factors:  [100.83776031  -0.20740663  -0.95606894]
mat_Sqrt:  [[31.50156784  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00222737  0.01996887 -0.13842813]
Stock Position:  0.002227368034534471
Bond Position:  [11.76278907]


portfolio before change:  [12.00170265]
curr_Stock_Price:  104.62156013690814
curr_Factors:  [104.62156014  -0.52909985  -1.00256207]
mat_Sqrt:  [[22.61668109  0.          0.        ]
 [-0.08164966  3.16227766  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01078943  0.0496193  -0.46490658]
Stock Position:  0.010789430674447117
Bond Position:  [10.87289558]


portfolio before change:  [12.05499317]
curr_Stock_Price:  109.05670683766078
curr_Factors:  [109.05670684  -0.1806199   -1.00821119]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.05499317]
Stock Price:  108.94421429119767
PL:  [3.11077887]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  -0.44485243157531185
FINAL STD P&L:  9.62229538332297
