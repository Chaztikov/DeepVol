WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-18 21:49:46.513494: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-18 21:49:46.530197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:83:00.0
2019-12-18 21:49:46.530749: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 21:49:46.532556: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 21:49:46.534303: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 21:49:46.535272: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 21:49:46.537429: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 21:49:46.539139: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 21:49:46.543716: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 21:49:46.545654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 21:49:46.546027: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-18 21:49:46.552212: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2399935000 Hz
2019-12-18 21:49:46.552379: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x556cf8ed3a70 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-18 21:49:46.552396: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-18 21:49:46.553423: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:83:00.0
2019-12-18 21:49:46.553446: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 21:49:46.553458: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 21:49:46.553468: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 21:49:46.553479: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 21:49:46.553489: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 21:49:46.553499: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 21:49:46.553510: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 21:49:46.555415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 21:49:46.555443: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 21:49:46.645785: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-18 21:49:46.645818: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-18 21:49:46.645829: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-18 21:49:46.648801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:83:00.0, compute capability: 6.0)
2019-12-18 21:49:46.650857: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x556cf950cda0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-18 21:49:46.650874: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
INFO   Y0_true: -1.0000e+00
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:232: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:232: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:237: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:237: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:311: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:311: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:317: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:317: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:487: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:487: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:492: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:492: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:494: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:494: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:330: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:330: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:340: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:340: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:342: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:342: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:195: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:195: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-18 21:50:19.462454: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 9.0847e+01,   Y0: 2.6638e+00,  elapsed time  32
INFO   step:     1,    loss: 5.9104e+01,   Y0: 2.6588e+00,  elapsed time  48
INFO   step:     2,    loss: 5.9100e+01,   Y0: 2.6538e+00,  elapsed time  51
INFO   step:     3,    loss: 5.9086e+01,   Y0: 2.6501e+00,  elapsed time  53
INFO   step:     4,    loss: 5.9082e+01,   Y0: 2.6459e+00,  elapsed time  55
INFO   step:     5,    loss: 5.9078e+01,   Y0: 2.6414e+00,  elapsed time  57
INFO   step:     6,    loss: 5.9072e+01,   Y0: 2.6376e+00,  elapsed time  59
INFO   step:     7,    loss: 5.9066e+01,   Y0: 2.6349e+00,  elapsed time  62
INFO   step:     8,    loss: 5.9059e+01,   Y0: 2.6317e+00,  elapsed time  64
INFO   step:     9,    loss: 5.9054e+01,   Y0: 2.6284e+00,  elapsed time  66
INFO   step:    10,    loss: 5.9048e+01,   Y0: 2.6249e+00,  elapsed time  68
INFO   step:    11,    loss: 5.9041e+01,   Y0: 2.6214e+00,  elapsed time  70
INFO   step:    12,    loss: 5.9033e+01,   Y0: 2.6181e+00,  elapsed time  73
INFO   step:    13,    loss: 5.9026e+01,   Y0: 2.6150e+00,  elapsed time  75
INFO   step:    14,    loss: 5.9019e+01,   Y0: 2.6121e+00,  elapsed time  77
INFO   step:    15,    loss: 5.9012e+01,   Y0: 2.6091e+00,  elapsed time  79
INFO   step:    16,    loss: 5.9007e+01,   Y0: 2.6060e+00,  elapsed time  81
INFO   step:    17,    loss: 5.9002e+01,   Y0: 2.6037e+00,  elapsed time  84
INFO   step:    18,    loss: 5.8992e+01,   Y0: 2.6014e+00,  elapsed time  86
INFO   step:    19,    loss: 5.8985e+01,   Y0: 2.5991e+00,  elapsed time  88
INFO   step:    20,    loss: 5.8976e+01,   Y0: 2.5963e+00,  elapsed time  90
INFO   step:    21,    loss: 5.8969e+01,   Y0: 2.5936e+00,  elapsed time  92
INFO   step:    22,    loss: 5.8961e+01,   Y0: 2.5903e+00,  elapsed time  95
INFO   step:    23,    loss: 5.8953e+01,   Y0: 2.5865e+00,  elapsed time  97
INFO   step:    24,    loss: 5.8944e+01,   Y0: 2.5834e+00,  elapsed time  99
INFO   step:    25,    loss: 5.8934e+01,   Y0: 2.5799e+00,  elapsed time 101
INFO   step:    26,    loss: 5.8925e+01,   Y0: 2.5761e+00,  elapsed time 103
INFO   step:    27,    loss: 5.8918e+01,   Y0: 2.5725e+00,  elapsed time 106
INFO   step:    28,    loss: 5.8910e+01,   Y0: 2.5687e+00,  elapsed time 108
INFO   step:    29,    loss: 5.8903e+01,   Y0: 2.5650e+00,  elapsed time 110
INFO   step:    30,    loss: 5.8895e+01,   Y0: 2.5613e+00,  elapsed time 112
INFO   step:    31,    loss: 5.8888e+01,   Y0: 2.5579e+00,  elapsed time 114
INFO   step:    32,    loss: 5.8882e+01,   Y0: 2.5547e+00,  elapsed time 116
INFO   step:    33,    loss: 5.8875e+01,   Y0: 2.5514e+00,  elapsed time 119
INFO   step:    34,    loss: 5.8869e+01,   Y0: 2.5479e+00,  elapsed time 121
INFO   step:    35,    loss: 5.8863e+01,   Y0: 2.5445e+00,  elapsed time 123
INFO   step:    36,    loss: 5.8857e+01,   Y0: 2.5412e+00,  elapsed time 125
INFO   step:    37,    loss: 5.8851e+01,   Y0: 2.5382e+00,  elapsed time 127
INFO   step:    38,    loss: 5.8846e+01,   Y0: 2.5358e+00,  elapsed time 130
INFO   step:    39,    loss: 5.8842e+01,   Y0: 2.5339e+00,  elapsed time 132
INFO   step:    40,    loss: 5.8837e+01,   Y0: 2.5323e+00,  elapsed time 134
INFO   step:    41,    loss: 5.8831e+01,   Y0: 2.5306e+00,  elapsed time 136
INFO   step:    42,    loss: 5.8826e+01,   Y0: 2.5292e+00,  elapsed time 138
INFO   step:    43,    loss: 5.8822e+01,   Y0: 2.5280e+00,  elapsed time 141
INFO   step:    44,    loss: 5.8817e+01,   Y0: 2.5271e+00,  elapsed time 143
INFO   step:    45,    loss: 5.8811e+01,   Y0: 2.5266e+00,  elapsed time 145
INFO   step:    46,    loss: 5.8805e+01,   Y0: 2.5262e+00,  elapsed time 147
INFO   step:    47,    loss: 5.8801e+01,   Y0: 2.5263e+00,  elapsed time 149
INFO   step:    48,    loss: 5.8796e+01,   Y0: 2.5259e+00,  elapsed time 152
INFO   step:    49,    loss: 5.8791e+01,   Y0: 2.5251e+00,  elapsed time 154
INFO   step:    50,    loss: 5.8787e+01,   Y0: 2.5235e+00,  elapsed time 156
INFO   step:    51,    loss: 5.8782e+01,   Y0: 2.5217e+00,  elapsed time 158
INFO   step:    52,    loss: 5.8777e+01,   Y0: 2.5204e+00,  elapsed time 160
INFO   step:    53,    loss: 5.8773e+01,   Y0: 2.5189e+00,  elapsed time 163
INFO   step:    54,    loss: 5.8769e+01,   Y0: 2.5173e+00,  elapsed time 165
INFO   step:    55,    loss: 5.8765e+01,   Y0: 2.5157e+00,  elapsed time 167
INFO   step:    56,    loss: 5.8760e+01,   Y0: 2.5145e+00,  elapsed time 169
INFO   step:    57,    loss: 5.8755e+01,   Y0: 2.5131e+00,  elapsed time 171
INFO   step:    58,    loss: 5.8749e+01,   Y0: 2.5120e+00,  elapsed time 174
INFO   step:    59,    loss: 5.8743e+01,   Y0: 2.5108e+00,  elapsed time 176
INFO   step:    60,    loss: 5.8736e+01,   Y0: 2.5097e+00,  elapsed time 178
INFO   step:    61,    loss: 5.8730e+01,   Y0: 2.5083e+00,  elapsed time 180
INFO   step:    62,    loss: 5.8724e+01,   Y0: 2.5068e+00,  elapsed time 182
INFO   step:    63,    loss: 5.8718e+01,   Y0: 2.5058e+00,  elapsed time 184
INFO   step:    64,    loss: 5.8713e+01,   Y0: 2.5049e+00,  elapsed time 187
INFO   step:    65,    loss: 5.8709e+01,   Y0: 2.5046e+00,  elapsed time 189
INFO   step:    66,    loss: 5.8705e+01,   Y0: 2.5040e+00,  elapsed time 191
INFO   step:    67,    loss: 5.8701e+01,   Y0: 2.5036e+00,  elapsed time 193
INFO   step:    68,    loss: 5.8696e+01,   Y0: 2.5029e+00,  elapsed time 195
INFO   step:    69,    loss: 5.8689e+01,   Y0: 2.5023e+00,  elapsed time 198
INFO   step:    70,    loss: 5.8682e+01,   Y0: 2.5022e+00,  elapsed time 200
INFO   step:    71,    loss: 5.8676e+01,   Y0: 2.5023e+00,  elapsed time 202
INFO   step:    72,    loss: 5.8671e+01,   Y0: 2.5023e+00,  elapsed time 204
INFO   step:    73,    loss: 5.8665e+01,   Y0: 2.5021e+00,  elapsed time 206
INFO   step:    74,    loss: 5.8659e+01,   Y0: 2.5022e+00,  elapsed time 209
INFO   step:    75,    loss: 5.8654e+01,   Y0: 2.5020e+00,  elapsed time 211
INFO   step:    76,    loss: 5.8650e+01,   Y0: 2.5021e+00,  elapsed time 213
INFO   step:    77,    loss: 5.8645e+01,   Y0: 2.5018e+00,  elapsed time 215
INFO   step:    78,    loss: 5.8641e+01,   Y0: 2.5015e+00,  elapsed time 217
INFO   step:    79,    loss: 5.8634e+01,   Y0: 2.5013e+00,  elapsed time 220
INFO   step:    80,    loss: 5.8628e+01,   Y0: 2.5008e+00,  elapsed time 222
INFO   step:    81,    loss: 5.8622e+01,   Y0: 2.5011e+00,  elapsed time 224
INFO   step:    82,    loss: 5.8619e+01,   Y0: 2.5016e+00,  elapsed time 226
INFO   step:    83,    loss: 5.8615e+01,   Y0: 2.5021e+00,  elapsed time 228
INFO   step:    84,    loss: 5.8612e+01,   Y0: 2.5028e+00,  elapsed time 230
INFO   step:    85,    loss: 5.8611e+01,   Y0: 2.5030e+00,  elapsed time 233
INFO   step:    86,    loss: 5.8609e+01,   Y0: 2.5028e+00,  elapsed time 235
INFO   step:    87,    loss: 5.8606e+01,   Y0: 2.5020e+00,  elapsed time 237
INFO   step:    88,    loss: 5.8602e+01,   Y0: 2.5009e+00,  elapsed time 239
INFO   step:    89,    loss: 5.8598e+01,   Y0: 2.5003e+00,  elapsed time 241
INFO   step:    90,    loss: 5.8592e+01,   Y0: 2.4999e+00,  elapsed time 244
INFO   step:    91,    loss: 5.8586e+01,   Y0: 2.5005e+00,  elapsed time 246
INFO   step:    92,    loss: 5.8579e+01,   Y0: 2.5017e+00,  elapsed time 248
INFO   step:    93,    loss: 5.8571e+01,   Y0: 2.5019e+00,  elapsed time 250
INFO   step:    94,    loss: 5.8565e+01,   Y0: 2.5018e+00,  elapsed time 252
INFO   step:    95,    loss: 5.8558e+01,   Y0: 2.5019e+00,  elapsed time 254
INFO   step:    96,    loss: 5.8550e+01,   Y0: 2.5016e+00,  elapsed time 257
INFO   step:    97,    loss: 5.8544e+01,   Y0: 2.5015e+00,  elapsed time 259
INFO   step:    98,    loss: 5.8537e+01,   Y0: 2.5007e+00,  elapsed time 261
INFO   step:    99,    loss: 5.8530e+01,   Y0: 2.4998e+00,  elapsed time 263
INFO   step:   100,    loss: 5.8522e+01,   Y0: 2.4994e+00,  elapsed time 265
INFO   step:   101,    loss: 5.8515e+01,   Y0: 2.4994e+00,  elapsed time 267
INFO   step:   102,    loss: 5.8508e+01,   Y0: 2.4994e+00,  elapsed time 270
INFO   step:   103,    loss: 5.8502e+01,   Y0: 2.4995e+00,  elapsed time 272
INFO   step:   104,    loss: 5.8496e+01,   Y0: 2.4993e+00,  elapsed time 274
INFO   step:   105,    loss: 5.8489e+01,   Y0: 2.4993e+00,  elapsed time 276
INFO   step:   106,    loss: 5.8483e+01,   Y0: 2.4988e+00,  elapsed time 278
INFO   step:   107,    loss: 5.8477e+01,   Y0: 2.4982e+00,  elapsed time 280
INFO   step:   108,    loss: 5.8473e+01,   Y0: 2.4974e+00,  elapsed time 283
INFO   step:   109,    loss: 5.8469e+01,   Y0: 2.4966e+00,  elapsed time 285
INFO   step:   110,    loss: 5.8465e+01,   Y0: 2.4955e+00,  elapsed time 287
INFO   step:   111,    loss: 5.8459e+01,   Y0: 2.4945e+00,  elapsed time 289
INFO   step:   112,    loss: 5.8453e+01,   Y0: 2.4937e+00,  elapsed time 291
INFO   step:   113,    loss: 5.8448e+01,   Y0: 2.4930e+00,  elapsed time 293
INFO   step:   114,    loss: 5.8443e+01,   Y0: 2.4931e+00,  elapsed time 296
INFO   step:   115,    loss: 5.8437e+01,   Y0: 2.4940e+00,  elapsed time 298
INFO   step:   116,    loss: 5.8430e+01,   Y0: 2.4950e+00,  elapsed time 300
INFO   step:   117,    loss: 5.8424e+01,   Y0: 2.4955e+00,  elapsed time 302
INFO   step:   118,    loss: 5.8418e+01,   Y0: 2.4965e+00,  elapsed time 304
INFO   step:   119,    loss: 5.8412e+01,   Y0: 2.4973e+00,  elapsed time 306
INFO   step:   120,    loss: 5.8406e+01,   Y0: 2.4977e+00,  elapsed time 309
INFO   step:   121,    loss: 5.8400e+01,   Y0: 2.4991e+00,  elapsed time 311
INFO   step:   122,    loss: 5.8393e+01,   Y0: 2.5009e+00,  elapsed time 313
INFO   step:   123,    loss: 5.8386e+01,   Y0: 2.5023e+00,  elapsed time 315
INFO   step:   124,    loss: 5.8380e+01,   Y0: 2.5032e+00,  elapsed time 317
INFO   step:   125,    loss: 5.8372e+01,   Y0: 2.5040e+00,  elapsed time 319
INFO   step:   126,    loss: 5.8365e+01,   Y0: 2.5043e+00,  elapsed time 322
INFO   step:   127,    loss: 5.8358e+01,   Y0: 2.5041e+00,  elapsed time 324
INFO   step:   128,    loss: 5.8352e+01,   Y0: 2.5042e+00,  elapsed time 326
INFO   step:   129,    loss: 5.8345e+01,   Y0: 2.5042e+00,  elapsed time 328
INFO   step:   130,    loss: 5.8339e+01,   Y0: 2.5043e+00,  elapsed time 330
INFO   step:   131,    loss: 5.8334e+01,   Y0: 2.5040e+00,  elapsed time 332
INFO   step:   132,    loss: 5.8328e+01,   Y0: 2.5039e+00,  elapsed time 335
INFO   step:   133,    loss: 5.8322e+01,   Y0: 2.5041e+00,  elapsed time 337
INFO   step:   134,    loss: 5.8316e+01,   Y0: 2.5040e+00,  elapsed time 339
INFO   step:   135,    loss: 5.8311e+01,   Y0: 2.5036e+00,  elapsed time 341
INFO   step:   136,    loss: 5.8305e+01,   Y0: 2.5023e+00,  elapsed time 343
INFO   step:   137,    loss: 5.8299e+01,   Y0: 2.5009e+00,  elapsed time 346
INFO   step:   138,    loss: 5.8293e+01,   Y0: 2.4991e+00,  elapsed time 348
INFO   step:   139,    loss: 5.8287e+01,   Y0: 2.4967e+00,  elapsed time 350
INFO   step:   140,    loss: 5.8281e+01,   Y0: 2.4944e+00,  elapsed time 352
INFO   step:   141,    loss: 5.8274e+01,   Y0: 2.4922e+00,  elapsed time 354
INFO   step:   142,    loss: 5.8267e+01,   Y0: 2.4903e+00,  elapsed time 356
INFO   step:   143,    loss: 5.8260e+01,   Y0: 2.4892e+00,  elapsed time 358
INFO   step:   144,    loss: 5.8253e+01,   Y0: 2.4891e+00,  elapsed time 361
INFO   step:   145,    loss: 5.8246e+01,   Y0: 2.4892e+00,  elapsed time 363
INFO   step:   146,    loss: 5.8239e+01,   Y0: 2.4901e+00,  elapsed time 365
INFO   step:   147,    loss: 5.8231e+01,   Y0: 2.4905e+00,  elapsed time 367
INFO   step:   148,    loss: 5.8224e+01,   Y0: 2.4913e+00,  elapsed time 369
INFO   step:   149,    loss: 5.8217e+01,   Y0: 2.4916e+00,  elapsed time 372
Delta:  120 ,  120.05
Other1:  -30.05 ,  -30
Other2:  -30.05 ,  -30
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_10:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_11:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_12:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_13:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_14:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_15:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_16:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_17:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_18:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_19:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_20:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_21:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_22:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_23:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_24:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_25:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_26:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_27:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_28:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_29:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_30:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_31:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_32:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_33:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_34:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_35:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_36:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_37:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_38:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_39:0' shape=(?, 3) dtype=float64>]
num_iterations:  150
total time intervals:  40
# of dimensions:  3
Loss out:  63.32814358558187
Output_Z_Vals:  [[[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
  [ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
  [ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
  ...
  [ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
  [ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
  [ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]]

 [[-1.57132069e-01 -9.68096178e-02  1.76068682e-02]
  [ 1.19558540e-01 -1.60004558e-02 -1.71196756e-04]
  [-2.56493401e-01 -1.09979569e-01  2.13071987e-02]
  ...
  [ 9.86985499e-02 -6.49165019e-02  7.43991285e-03]
  [-2.52357458e-01 -1.07667702e-01  2.17125909e-02]
  [-3.42621011e-02 -7.47404506e-02  1.48654441e-02]]

 [[-1.24419109e-01  1.02565290e-01 -2.07034764e-01]
  [-9.38908082e-02  6.36902831e-02  6.92102466e-02]
  [-1.50300956e-01  6.75953374e-02 -1.66802033e-01]
  ...
  [-9.43043181e-04 -3.85787819e-03  8.05253502e-02]
  [-6.05258912e-02  7.02888434e-02 -5.43139598e-02]
  [-2.25905884e-01  7.16759644e-02 -4.02647562e-01]]

 ...

 [[ 1.17057657e-01  9.70563869e-02  2.44704081e-01]
  [ 3.04601649e-03  1.02242092e-01  1.13769496e-01]
  [ 9.30113610e-02 -7.10425493e-02  2.55854852e-02]
  ...
  [ 1.45534132e-01 -1.10622304e-01  5.95758487e-02]
  [ 1.28428419e-01 -7.30381460e-02  4.46959709e-02]
  [ 1.19708125e-01  1.07105271e-01  2.77206759e-01]]

 [[ 1.77398602e-01 -1.23656283e-01 -1.79437000e-01]
  [ 1.61873852e-01 -1.18471007e-01 -1.54356403e-01]
  [-7.04603492e-02  1.01547637e-02  3.61728206e-02]
  ...
  [-8.07278292e-02  2.09269351e-02  3.84275219e-02]
  [-5.69676318e-02 -5.36273346e-03  3.09839299e-02]
  [ 1.99111296e-01 -1.35820956e-01 -2.28505954e-01]]

 [[ 9.96983610e-02  2.60028154e-03  5.54900136e-02]
  [ 9.92084191e-02  2.90381292e-03  5.83903724e-02]
  [ 1.74566109e-01 -8.03720770e-03  9.77209320e-02]
  ...
  [ 2.15207019e-01 -1.63805402e-02  8.57582792e-02]
  [ 9.33912241e-02  6.50771211e-03  9.28270108e-02]
  [ 9.72983828e-02  4.08712865e-03  6.96974078e-02]]]
Z_Vals dimensionality:  (40, 200, 3)
X_test:  [[[100.         100.51633457 101.00252529 ...  95.09936906  95.51962722
    95.91777878]
  [ -1.          -1.10362897  -1.17216042 ...  -1.14976357  -1.12335666
    -1.34507817]
  [ -1.          -1.0203356   -1.01131006 ...  -0.88710754  -0.92010856
    -0.90749283]]

 [[100.          99.29283817  99.33819913 ...  96.01850782  95.651174
    92.97708054]
  [ -1.          -0.80125449  -0.68120004 ...  -0.5976638   -0.30400813
    -0.17064545]
  [ -1.          -0.96431518  -0.95162562 ...  -0.88491531  -0.8553773
    -0.86116625]]

 [[100.         100.54360169 100.06786623 ... 102.71651128 103.58680621
   104.70152367]
  [ -1.          -0.73039936  -0.72809276 ...  -0.84806246  -0.74710009
    -0.59882725]
  [ -1.          -0.99786845  -1.01618403 ...  -0.95378242  -0.95366223
    -0.96031322]]

 ...

 [[100.          99.60646766 102.30880068 ... 103.76212447 104.47199684
   103.37747329]
  [ -1.          -0.82578233  -0.87584922 ...  -0.89489893  -0.80237191
    -0.69322729]
  [ -1.          -0.97509489  -0.99070415 ...  -0.95770411  -0.9401348
    -0.95273604]]

 [[100.         100.77181755 101.22066329 ... 101.56298816 101.30285026
   101.98730692]
  [ -1.          -0.99629888  -0.77745924 ...  -1.30256624  -1.30577956
    -1.25683423]
  [ -1.          -1.000491    -1.03234935 ...  -1.04442782  -1.04479555
    -1.05784394]]

 [[100.         100.26929933  99.85400273 ...  93.04848359  92.8320079
    93.07190813]
  [ -1.          -1.34875689  -1.33584612 ...  -0.81598931  -0.91347017
    -0.90218914]
  [ -1.          -0.97531778  -0.96927084 ...  -1.06814728  -1.07967054
    -1.08966505]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.57132069e-01 -9.68096178e-02  1.76068682e-02]
 [-1.24419109e-01  1.02565290e-01 -2.07034764e-01]
 [-3.30435748e-02  4.21529476e-02  2.30893357e-02]
 [ 8.79437604e-02  4.77473519e-03  1.27108690e-01]
 [ 8.71567152e-03  8.54901388e-02 -6.29854804e-02]
 [-6.26732982e-02 -1.45325873e-01  1.92519982e-01]
 [-6.28694256e-02 -1.59390451e-01  5.08302261e-02]
 [ 2.05010323e-02  8.12693789e-01  1.26317881e-01]
 [-2.63612815e-02  1.13263727e-01 -8.43835600e-02]
 [ 1.80126729e-01  6.05195971e-02  6.14781949e-02]
 [-5.07702852e-02 -2.23895568e-01 -1.75035938e-02]
 [-2.24240516e-02 -1.74869388e-02  9.42326904e-02]
 [-3.68830591e-02  1.97364184e-01 -1.25853820e-01]
 [ 9.26427268e-03 -1.11138176e-01  5.23617442e-02]
 [-8.21030689e-02  1.96233963e-01 -3.99165879e-02]
 [ 1.13331201e-01 -1.47111981e-04 -1.82955965e-02]
 [ 4.37414531e-02  3.07789686e-02  1.72473321e-02]
 [-5.29863163e-02 -6.30639089e-02  5.64348162e-03]
 [ 4.81291796e-02 -7.55788750e-03 -1.00734473e-01]
 [ 1.83063743e-02 -1.59784496e-02  4.76103543e-02]
 [-1.77841221e-02  3.36103834e-01 -2.81986350e-01]
 [ 4.68197886e-02  5.00757861e-02  9.38863514e-02]
 [ 3.29805496e-04 -2.60278281e-02  6.52592285e-02]
 [ 1.27350068e-01 -4.55165494e-02 -2.46805058e-01]
 [-1.30801440e-02  2.18143757e-02 -8.14349904e-03]
 [-1.03599947e-01 -1.26409454e-02  2.29413364e-01]
 [-4.31672288e-02 -3.35865896e-02 -8.42211022e-03]
 [-8.51460468e-02  1.12160878e-01 -7.49640727e-02]
 [ 8.49015047e-02 -1.84927677e-02  1.31804152e-01]
 [ 5.83778414e-02  5.65277617e-02 -1.03641192e-01]
 [ 1.28425535e-02 -6.05029399e-03 -1.00753273e-02]
 [-3.06270763e-02  6.22221133e-02 -1.27414758e-01]
 [-1.71805049e-02  6.23167564e-02 -5.86674124e-02]
 [ 4.76764847e-02 -4.11512925e-02  1.86442826e-01]
 [-7.43359554e-02 -6.01241821e-03 -3.07753298e-02]
 [-1.67987557e-01 -1.83012273e-01 -1.54409980e-01]
 [ 1.17057657e-01  9.70563869e-02  2.44704081e-01]
 [ 1.77398602e-01 -1.23656283e-01 -1.79437000e-01]
 [ 9.96983610e-02  2.60028154e-03  5.54900136e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.48921399]
curr_Stock_Price:  100.5163345663679
curr_Factors:  [100.51633457  -1.10362897  -1.0203356 ]
mat_Sqrt:  [[12.01740098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01442069 -0.03124517  0.05022749]
Stock Position:  -0.014420694050779125
Bond Position:  [7.9387293]


portfolio before change:  [6.48319519]
curr_Stock_Price:  101.0025252933648
curr_Factors:  [101.00252529  -1.17216042  -1.01131006]
mat_Sqrt:  [[11.3779246   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01280935  0.03310281 -0.59061255]
Stock Position:  -0.012809352876534725
Bond Position:  [7.77697217]


portfolio before change:  [6.49652236]
curr_Stock_Price:  100.03799655100441
curr_Factors:  [100.03799655  -1.14867878  -1.03106486]
mat_Sqrt:  [[11.31134767  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174392  0.01360481  0.06586745]
Stock Position:  -0.0017439168188642404
Bond Position:  [6.6709803]


portfolio before change:  [6.49767596]
curr_Stock_Price:  99.85468752274295
curr_Factors:  [99.85468752 -1.40355099 -1.03035612]
mat_Sqrt:  [[ 8.7566104   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01311744 0.00154104 0.36260571]
Stock Position:  0.013117444584508937
Bond Position:  [5.18783763]


portfolio before change:  [6.48962159]
curr_Stock_Price:  99.19122840945714
curr_Factors:  [99.19122841 -1.57944942 -0.99182977]
mat_Sqrt:  [[ 7.5819498   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00175541  0.02759182 -0.17968004]
Stock Position:  0.0017554080452734616
Bond Position:  [6.31550051]


portfolio before change:  [6.48923005]
curr_Stock_Price:  98.51843640303167
curr_Factors:  [98.5184364  -1.6122894  -1.00066377]
mat_Sqrt:  [[ 7.22314556  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00734304 -0.04690372  0.54920592]
Stock Position:  -0.00734303919579354
Bond Position:  [7.21265479]


portfolio before change:  [6.48867227]
curr_Stock_Price:  98.71718499923911
curr_Factors:  [98.717185   -1.48003989 -1.00558214]
mat_Sqrt:  [[ 8.22054916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01034349 -0.05144305  0.14500449]
Stock Position:  -0.010343492522388911
Bond Position:  [7.50975274]


portfolio before change:  [6.49187661]
curr_Stock_Price:  98.49815276620971
curr_Factors:  [98.49815277 -1.52499014 -0.98809311]
mat_Sqrt:  [[ 7.98012875  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02658804 0.26229579 0.36034976]
Stock Position:  0.026588040565101643
Bond Position:  [3.87300373]


portfolio before change:  [6.48221604]
curr_Stock_Price:  98.11660077353773
curr_Factors:  [98.11660077 -1.60825783 -0.98487437]
mat_Sqrt:  [[ 7.33769217  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00278918  0.03655571 -0.24072281]
Stock Position:  -0.0027891797088687906
Bond Position:  [6.75588088]


portfolio before change:  [6.48390043]
curr_Stock_Price:  97.81549197864145
curr_Factors:  [97.81549198 -1.26781481 -0.95859867]
mat_Sqrt:  [[10.55573683  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01942351 0.01953262 0.17538018]
Stock Position:  0.01942350663519246
Bond Position:  [4.58398057]


portfolio before change:  [6.47879586]
curr_Stock_Price:  97.52318608379554
curr_Factors:  [97.52318608 -1.2429591  -0.99931554]
mat_Sqrt:  [[10.35858365  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00965824 -0.07226198 -0.04993288]
Stock Position:  -0.009658239600696877
Bond Position:  [7.42069815]


portfolio before change:  [6.48683038]
curr_Stock_Price:  96.7873499906027
curr_Factors:  [96.78734999 -1.02880696 -0.98416589]
mat_Sqrt:  [[12.9299129   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052269 -0.00564389  0.26881964]
Stock Position:  -0.0005226942167463249
Bond Position:  [6.53742057]


portfolio before change:  [6.48750811]
curr_Stock_Price:  97.05423470071875
curr_Factors:  [97.0542347  -1.33289026 -0.97962141]
mat_Sqrt:  [[ 9.60955845  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00231916  0.06369902 -0.35902592]
Stock Position:  -0.0023191561970551497
Bond Position:  [6.71259204]


portfolio before change:  [6.48968611]
curr_Stock_Price:  96.47692401476667
curr_Factors:  [96.47692401 -1.23900898 -0.96147211]
mat_Sqrt:  [[10.68480626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00025582 -0.03586969  0.14937348]
Stock Position:  -0.00025582272420355786
Bond Position:  [6.5143671]


portfolio before change:  [6.49035691]
curr_Stock_Price:  97.03806341851855
curr_Factors:  [97.03806342 -0.97096465 -0.99776572]
mat_Sqrt:  [[13.54981566  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00370447  0.06333424 -0.11387091]
Stock Position:  -0.003704472403271691
Bond Position:  [6.84983173]


portfolio before change:  [6.48860241]
curr_Stock_Price:  97.74282612468964
curr_Factors:  [97.74282612 -1.28512554 -1.02992325]
mat_Sqrt:  [[ 9.65321497  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.13502703e-02 -4.74801876e-05 -5.21922443e-02]
Stock Position:  0.011350270262963156
Bond Position:  [5.37919492]


portfolio before change:  [6.50028315]
curr_Stock_Price:  98.71269669585045
curr_Factors:  [98.7126967  -1.46795098 -0.99975531]
mat_Sqrt:  [[ 8.36877307  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00639816 0.00993387 0.04920184]
Stock Position:  0.006398163773228625
Bond Position:  [5.86870315]


portfolio before change:  [6.50243513]
curr_Stock_Price:  98.93437767057344
curr_Factors:  [98.93437767 -1.47170009 -1.01369189]
mat_Sqrt:  [[ 8.24053114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00785231 -0.02035379  0.01609928]
Stock Position:  -0.007852310835884474
Bond Position:  [7.27929862]


portfolio before change:  [6.50484363]
curr_Stock_Price:  98.74353892283983
curr_Factors:  [98.74353892 -1.55486199 -0.99476462]
mat_Sqrt:  [[ 7.71293943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00337408 -0.0024393  -0.28736741]
Stock Position:  0.003374082504933625
Bond Position:  [6.17167478]


portfolio before change:  [6.50496117]
curr_Stock_Price:  98.54971708037559
curr_Factors:  [98.54971708 -1.54600967 -1.02938428]
mat_Sqrt:  [[ 7.50198176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00330089 -0.00515702  0.13581909]
Stock Position:  0.0033008890924623928
Bond Position:  [6.17965948]


portfolio before change:  [6.50493014]
curr_Stock_Price:  98.30628967499284
curr_Factors:  [98.30628967 -1.45372801 -1.06024921]
mat_Sqrt:  [[ 7.95746742  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084668  0.10847705 -0.80442857]
Stock Position:  -0.0008466810625732372
Bond Position:  [6.58816422]


portfolio before change:  [6.50564385]
curr_Stock_Price:  98.43604492345064
curr_Factors:  [98.43604492 -1.34487782 -1.02420463]
mat_Sqrt:  [[ 9.21032005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00827397 0.01616189 0.26783163]
Stock Position:  0.00827397272366828
Bond Position:  [5.6911867]


portfolio before change:  [6.50633036]
curr_Stock_Price:  98.43303037838666
curr_Factors:  [98.43303038 -1.21352287 -0.99662773]
mat_Sqrt:  [[10.79654121  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00077227 -0.00840045  0.18616641]
Stock Position:  0.0007722733976275179
Bond Position:  [6.43031314]


portfolio before change:  [6.50625261]
curr_Stock_Price:  97.29149023818881
curr_Factors:  [97.29149024 -1.29824007 -0.98679427]
mat_Sqrt:  [[ 9.90141007  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00683541 -0.0146904  -0.70406613]
Stock Position:  0.006835407204474377
Bond Position:  [5.84122566]


portfolio before change:  [6.50949516]
curr_Stock_Price:  97.65903950961733
curr_Factors:  [97.65903951 -1.23195152 -1.00307681]
mat_Sqrt:  [[10.44845271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0009848   0.00704056 -0.02323114]
Stock Position:  -0.000984795380504647
Bond Position:  [6.60566933]


portfolio before change:  [6.5108936]
curr_Stock_Price:  97.07751941045552
curr_Factors:  [97.07751941 -1.23876334 -0.99745172]
mat_Sqrt:  [[10.37391799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00572122 -0.00407985  0.65445247]
Stock Position:  -0.005721219570921622
Bond Position:  [7.0662954]


portfolio before change:  [6.51498119]
curr_Stock_Price:  96.51745534827268
curr_Factors:  [96.51745535 -0.97902679 -1.01487414]
mat_Sqrt:  [[13.14212793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00393713 -0.01084003 -0.02402594]
Stock Position:  -0.003937126394125719
Bond Position:  [6.89498261]


portfolio before change:  [6.51834815]
curr_Stock_Price:  95.88119719174712
curr_Factors:  [95.88119719 -0.73968723 -0.98744042]
mat_Sqrt:  [[17.04713643  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00454934  0.03619977 -0.21385163]
Stock Position:  -0.004549343585094854
Bond Position:  [6.95454466]


portfolio before change:  [6.52124508]
curr_Stock_Price:  95.43551612122
curr_Factors:  [95.43551612 -1.00779873 -0.98765553]
mat_Sqrt:  [[12.97463805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00832633 -0.00596852  0.37600056]
Stock Position:  0.00832632816767992
Bond Position:  [5.72661765]


portfolio before change:  [6.51620391]
curr_Stock_Price:  94.74408995842552
curr_Factors:  [94.74408996 -1.01383378 -0.95953589]
mat_Sqrt:  [[13.16826539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00370291  0.01824426 -0.29565947]
Stock Position:  0.003702906280573855
Bond Position:  [6.16537542]


portfolio before change:  [6.51405849]
curr_Stock_Price:  93.95656358899046
curr_Factors:  [93.95656359 -1.11168154 -0.90085879]
mat_Sqrt:  [[12.55717557  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00076059 -0.00195272 -0.0287421 ]
Stock Position:  0.0007605949877090688
Bond Position:  [6.4425956]


portfolio before change:  [6.5150349]
curr_Stock_Price:  94.18143411286333
curr_Factors:  [94.18143411 -0.80474804 -0.91810414]
mat_Sqrt:  [[16.81667389  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261255  0.0200821  -0.36347884]
Stock Position:  -0.0026125540305404404
Bond Position:  [6.76108899]


portfolio before change:  [6.51683416]
curr_Stock_Price:  93.81624817839992
curr_Factors:  [93.81624818 -0.96909861 -0.91684927]
mat_Sqrt:  [[14.23053754  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00115495  0.02011265 -0.1673618 ]
Stock Position:  -0.0011549518527941539
Bond Position:  [6.62518741]


portfolio before change:  [6.51707127]
curr_Stock_Price:  94.32803097911189
curr_Factors:  [94.32803098 -1.06134739 -0.89012795]
mat_Sqrt:  [[13.40064794  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00577091 -0.01328152  0.53186949]
Stock Position:  0.005770914593558395
Bond Position:  [5.97271226]


portfolio before change:  [6.51475779]
curr_Stock_Price:  93.79776450339605
curr_Factors:  [93.7977645  -1.33439189 -0.86815078]
mat_Sqrt:  [[10.36669595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00789502 -0.0019405  -0.08779345]
Stock Position:  -0.007895015287559488
Bond Position:  [7.25529257]


portfolio before change:  [6.51408122]
curr_Stock_Price:  93.99833835440342
curr_Factors:  [93.99833835 -1.21849382 -0.87333014]
mat_Sqrt:  [[11.60519854  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02041013 -0.05906696 -0.44048869]
Stock Position:  -0.020410127856455847
Bond Position:  [8.43259932]


portfolio before change:  [6.50365929]
curr_Stock_Price:  94.5606118879713
curr_Factors:  [94.56061189 -1.26912101 -0.88469702]
mat_Sqrt:  [[10.97283854  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01702561 0.03132481 0.69807263]
Stock Position:  0.017025605475947763
Bond Position:  [4.89370762]


portfolio before change:  [6.51344371]
curr_Stock_Price:  95.09936905794915
curr_Factors:  [95.09936906 -1.14976357 -0.88710754]
mat_Sqrt:  [[12.40439974  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00931363 -0.03990989 -0.51188382]
Stock Position:  0.009313626352337002
Bond Position:  [5.62772372]


portfolio before change:  [6.51806134]
curr_Stock_Price:  95.51962721683623
curr_Factors:  [95.51962722 -1.12335666 -0.92010856]
mat_Sqrt:  [[12.37732941  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00901293 0.00083924 0.15829756]
Stock Position:  0.009012929135632824
Bond Position:  [5.65714971]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.52235704]
Stock Price:  95.91777878449757
PL:  [6.52235704]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.19558540e-01 -1.60004558e-02 -1.71196756e-04]
 [-9.38908082e-02  6.36902831e-02  6.92102466e-02]
 [-1.02965747e-02  6.01867926e-02  4.11047022e-02]
 [ 1.15361456e-01  1.07612093e-01  9.94923079e-02]
 [-3.46600147e-02  1.91769188e-01 -7.59489187e-03]
 [-1.52941707e-02 -1.50450193e-01  1.09947486e-01]
 [-6.40312541e-02 -3.39476043e-01 -2.21915438e-01]
 [-7.78510785e-03  8.12510451e-01  1.63311042e-01]
 [-5.24237448e-03  2.95659808e-02 -6.21805518e-02]
 [ 1.26294189e-01  3.80646371e-02  1.60075469e-02]
 [-4.64284354e-02 -2.31705119e-01 -2.36939855e-02]
 [ 5.37479880e-02 -1.24608023e-02  1.16863904e-01]
 [ 1.13403009e-03  1.09684299e-02  3.46299518e-02]
 [ 1.33040783e-02 -1.84347761e-01  1.37266417e-02]
 [-1.64151870e-02  4.86853450e-02 -5.34011212e-02]
 [ 1.34466055e-01  5.86055050e-03 -3.45422506e-02]
 [ 5.33773801e-02  4.07369298e-02 -5.85946453e-02]
 [-1.73349256e-02 -5.53071095e-02 -2.57812021e-02]
 [ 1.70948625e-02  8.05681210e-02 -1.71920428e-01]
 [-6.34549818e-02 -1.69294837e-02 -2.41389306e-02]
 [-3.78850354e-02  4.83279384e-01 -4.35117422e-01]
 [ 2.45099132e-01  1.52719747e-01  8.24652622e-02]
 [ 1.94602643e-03 -3.33004897e-02  6.96928487e-02]
 [ 2.62383474e-02  8.37740778e-03 -1.08126677e-01]
 [-1.23664593e-02  1.15736116e-02 -8.19039775e-03]
 [-1.03514515e-01 -1.85369849e-02  2.24318884e-01]
 [-2.32066153e-02 -3.27252097e-02 -7.43827848e-04]
 [-8.65213842e-02  8.25934622e-02 -1.81381383e-01]
 [-2.12691164e-02 -4.05539729e-02  4.99631269e-02]
 [-4.25915609e-02  1.43434979e-02 -4.00776972e-03]
 [ 9.10410220e-03 -3.68086487e-02 -4.79438822e-02]
 [-1.57876440e-02  8.96258132e-02 -1.22827309e-01]
 [-3.49623202e-02  3.57604783e-02 -6.38093526e-02]
 [ 4.32673325e-02 -3.05548231e-02  1.78227381e-01]
 [-7.38699380e-02 -9.45366527e-04 -3.14887294e-02]
 [-1.13153017e-01 -1.42902797e-01 -1.03047335e-01]
 [ 3.04601649e-03  1.02242092e-01  1.13769496e-01]
 [ 1.61873852e-01 -1.18471007e-01 -1.54356403e-01]
 [ 9.92084191e-02  2.90381292e-03  5.83903724e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.21549501]
curr_Stock_Price:  99.2928381733838
curr_Factors:  [99.29283817 -0.80125449 -0.96431518]
mat_Sqrt:  [[16.98794161  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00684353 -0.00516412 -0.00048838]
Stock Position:  0.00684353157912012
Bond Position:  [-3.89500869]


portfolio before change:  [-3.21567149]
curr_Stock_Price:  99.3381991288885
curr_Factors:  [99.33819913 -0.68120004 -0.95162562]
mat_Sqrt:  [[19.40837197  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00343989  0.02055595  0.19743757]
Stock Position:  -0.0034398867303013867
Bond Position:  [-2.87395934]


portfolio before change:  [-3.21296674]
curr_Stock_Price:  98.44746639632001
curr_Factors:  [98.4474664  -1.02559374 -0.93378651]
mat_Sqrt:  [[13.8757515   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00074803 0.0194252  0.11726027]
Stock Position:  0.0007480290425555466
Bond Position:  [-3.2866083]


portfolio before change:  [-3.21465706]
curr_Stock_Price:  96.73700856207186
curr_Factors:  [96.73700856 -0.68295719 -0.9456884 ]
mat_Sqrt:  [[18.97932933  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00830569 0.03473165 0.28382386]
Stock Position:  0.008305692032687132
Bond Position:  [-4.01812486]


portfolio before change:  [-3.22561843]
curr_Stock_Price:  95.47774372229863
curr_Factors:  [95.47774372 -0.71968642 -0.96066034]
mat_Sqrt:  [[17.78839739  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00016496  0.06189324 -0.02166611]
Stock Position:  0.00016496180330292503
Bond Position:  [-3.24136861]


portfolio before change:  [-3.22594556]
curr_Stock_Price:  95.95095399276155
curr_Factors:  [95.95095399 -0.83897576 -0.97323568]
mat_Sqrt:  [[15.66808322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00150381 -0.04855759  0.31364957]
Stock Position:  -0.0015038055857340994
Bond Position:  [-3.08165398]


portfolio before change:  [-3.2261445]
curr_Stock_Price:  95.82707655775143
curr_Factors:  [95.82707656 -0.90698451 -0.94941146]
mat_Sqrt:  [[14.97151377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01193098 -0.10956542 -0.63306297]
Stock Position:  -0.011930978584875128
Bond Position:  [-2.08283371]


portfolio before change:  [-3.2345445]
curr_Stock_Price:  96.50930302595118
curr_Factors:  [96.50930303 -1.24426507 -0.97439213]
mat_Sqrt:  [[10.49587371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01823608 0.26223662 0.46588094]
Stock Position:  0.018236082617120602
Bond Position:  [-4.99449613]


portfolio before change:  [-3.22930437]
curr_Stock_Price:  96.83088982634891
curr_Factors:  [96.83088983 -1.1888098  -0.96549493]
mat_Sqrt:  [[11.23081477  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105957  0.00954238 -0.17738381]
Stock Position:  -0.0010595665712302615
Bond Position:  [-3.1267056]


portfolio before change:  [-3.22987742]
curr_Stock_Price:  97.00283586327242
curr_Factors:  [97.00283586 -1.23523518 -0.96990098]
mat_Sqrt:  [[10.69315745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01284294 0.01228531 0.04566508]
Stock Position:  0.012842944475172799
Bond Position:  [-4.47567946]


portfolio before change:  [-3.2156559]
curr_Stock_Price:  98.15374176704337
curr_Factors:  [98.15374177 -1.47073458 -0.98647279]
mat_Sqrt:  [[ 8.40921114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01172067 -0.07478251 -0.06759235]
Stock Position:  -0.011720666493644172
Bond Position:  [-2.06522862]


portfolio before change:  [-3.21912266]
curr_Stock_Price:  98.4274969438358
curr_Factors:  [98.42749694 -1.48629659 -0.97744677]
mat_Sqrt:  [[ 8.37772872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00895937 -0.00402171  0.33338019]
Stock Position:  0.008959371258642781
Bond Position:  [-4.10097115]


portfolio before change:  [-3.21264941]
curr_Stock_Price:  99.20722838992067
curr_Factors:  [99.20722839 -1.37466994 -1.00516459]
mat_Sqrt:  [[ 9.18320568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00113705 0.00354005 0.09878961]
Stock Position:  0.001137049647802896
Bond Position:  [-3.32545295]


portfolio before change:  [-3.21290311]
curr_Stock_Price:  99.34970447042004
curr_Factors:  [99.34970447 -1.23406612 -0.97319206]
mat_Sqrt:  [[10.92865031  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196948 -0.05949798  0.03915829]
Stock Position:  -0.001969484905019339
Bond Position:  [-3.01723537]


portfolio before change:  [-3.21301111]
curr_Stock_Price:  99.21302650316247
curr_Factors:  [99.2130265  -1.00865379 -0.96063116]
mat_Sqrt:  [[13.84583358  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00125509  0.01571313 -0.15233853]
Stock Position:  -0.0012550917019667493
Bond Position:  [-3.08848966]


portfolio before change:  [-3.21292338]
curr_Stock_Price:  98.83551580096295
curr_Factors:  [98.8355158  -0.80997942 -0.95483419]
mat_Sqrt:  [[16.92248826  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00760003  0.00189148 -0.09853943]
Stock Position:  0.007600030543151756
Bond Position:  [-3.96407632]


portfolio before change:  [-3.22050993]
curr_Stock_Price:  97.9024924786291
curr_Factors:  [97.90249248 -0.75393247 -0.9408466 ]
mat_Sqrt:  [[17.97879367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00276616  0.01314779 -0.16715421]
Stock Position:  0.0027661582893547714
Bond Position:  [-3.49132372]


portfolio before change:  [-3.22358663]
curr_Stock_Price:  96.94800706570994
curr_Factors:  [96.94800707 -0.78020869 -0.96460155]
mat_Sqrt:  [[16.93469679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200104 -0.01785029 -0.07354659]
Stock Position:  -0.002001040131572481
Bond Position:  [-3.02958978]


portfolio before change:  [-3.22520869]
curr_Stock_Price:  97.56935231815979
curr_Factors:  [97.56935232 -0.87913879 -1.00866782]
mat_Sqrt:  [[14.77234463  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.05084812e-04  2.60032492e-02 -4.90441127e-01]
Stock Position:  -0.0001050848121654001
Bond Position:  [-3.21495563]


portfolio before change:  [-3.22547862]
curr_Stock_Price:  96.31359431266361
curr_Factors:  [96.31359431 -0.78360996 -0.98665269]
mat_Sqrt:  [[16.40107397  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00438008 -0.00546397 -0.06886165]
Stock Position:  -0.004380081258578141
Bond Position:  [-2.80361725]


portfolio before change:  [-3.23037887]
curr_Stock_Price:  97.35233570244738
curr_Factors:  [97.3523357  -0.56027761 -0.98635784]
mat_Sqrt:  [[20.73247431  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00135314  0.15597775 -1.24126889]
Stock Position:  -0.0013531436537173845
Bond Position:  [-3.09864717]


portfolio before change:  [-3.2298855]
curr_Stock_Price:  96.7014647561625
curr_Factors:  [96.70146476 -0.68681761 -0.95346896]
mat_Sqrt:  [[18.75277942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01563001 0.04929009 0.23525044]
Stock Position:  0.015630006869412686
Bond Position:  [-4.74133006]


portfolio before change:  [-3.2110217]
curr_Stock_Price:  97.94628241005502
curr_Factors:  [97.94628241 -0.56589118 -0.95344276]
mat_Sqrt:  [[21.43628945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00043732 -0.01074769  0.1988143 ]
Stock Position:  0.0004373231493276319
Bond Position:  [-3.25385587]


portfolio before change:  [-3.21169099]
curr_Stock_Price:  97.34594431401007
curr_Factors:  [97.34594431 -0.62252357 -0.95478752]
mat_Sqrt:  [[20.1048278   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.92323474e-04  2.70379673e-03 -3.08455312e-01]
Stock Position:  0.0002923234744464872
Bond Position:  [-3.2401475]


portfolio before change:  [-3.21196913]
curr_Stock_Price:  97.78008954598575
curr_Factors:  [97.78008955 -0.72919484 -0.93432038]
mat_Sqrt:  [[18.52656683  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063022  0.00373537 -0.02336493]
Stock Position:  -0.0006302227402834273
Bond Position:  [-3.15034589]


portfolio before change:  [-3.21284388]
curr_Stock_Price:  98.54320835428541
curr_Factors:  [98.54320835 -0.67512528 -0.93230685]
mat_Sqrt:  [[19.74821249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311468 -0.00598279  0.63991934]
Stock Position:  -0.0031146849969004315
Bond Position:  [-2.90591283]


portfolio before change:  [-3.21299596]
curr_Stock_Price:  98.47540719468044
curr_Factors:  [98.47540719 -0.76261352 -0.9193616 ]
mat_Sqrt:  [[18.31703913  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00163992 -0.01056202 -0.00212193]
Stock Position:  -0.0016399186461522961
Bond Position:  [-3.05150431]


portfolio before change:  [-3.21253095]
curr_Stock_Price:  97.95923671996091
curr_Factors:  [97.95923672 -0.87577227 -0.93152156]
mat_Sqrt:  [[16.07487692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00663684  0.02665693 -0.5174306 ]
Stock Position:  -0.006636839871131672
Bond Position:  [-2.56239118]


portfolio before change:  [-3.21390303]
curr_Stock_Price:  98.11771041585583
curr_Factors:  [98.11771042 -0.92318767 -0.91776823]
mat_Sqrt:  [[15.56791374  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124284 -0.01308874  0.14253089]
Stock Position:  -0.0012428435328602225
Bond Position:  [-3.09195807]


portfolio before change:  [-3.21510463]
curr_Stock_Price:  98.77352612019338
curr_Factors:  [98.77352612 -0.94306314 -0.91946834]
mat_Sqrt:  [[15.33745895  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263941  0.00462934 -0.01143305]
Stock Position:  -0.002639406523701604
Bond Position:  [-2.95440114]


portfolio before change:  [-3.21274117]
curr_Stock_Price:  97.73814927658421
curr_Factors:  [97.73814928 -0.84444397 -0.90409182]
mat_Sqrt:  [[17.00923054  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048185 -0.01187994 -0.13677055]
Stock Position:  -0.00048185223311708353
Bond Position:  [-3.16564582]


portfolio before change:  [-3.21259574]
curr_Stock_Price:  96.61507470324906
curr_Factors:  [96.6150747  -0.91486233 -0.91194319]
mat_Sqrt:  [[15.5479572   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00145131  0.02892661 -0.35039212]
Stock Position:  -0.0014513077574062258
Bond Position:  [-3.07237754]


portfolio before change:  [-3.21379558]
curr_Stock_Price:  97.17716452051985
curr_Factors:  [97.17716452 -0.98738489 -0.91256657]
mat_Sqrt:  [[14.53535985  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00279923  0.01154164 -0.18203032]
Stock Position:  -0.0027992270624081065
Bond Position:  [-2.94177463]


portfolio before change:  [-3.21174345]
curr_Stock_Price:  96.31268627989442
curr_Factors:  [96.31268628 -0.96769893 -0.90593431]
mat_Sqrt:  [[14.79022969  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00496347 -0.00986153  0.50843311]
Stock Position:  0.004963470388856429
Bond Position:  [-3.68978862]


portfolio before change:  [-3.21544033]
curr_Stock_Price:  95.6607985182623
curr_Factors:  [95.66079852 -0.76637203 -0.91437286]
mat_Sqrt:  [[17.81540799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00451803 -0.00030512 -0.08982858]
Stock Position:  -0.004518028449352969
Bond Position:  [-2.78324212]


portfolio before change:  [-3.21827241]
curr_Stock_Price:  96.21063028953033
curr_Factors:  [96.21063029 -0.56782847 -0.90632178]
mat_Sqrt:  [[22.02965725  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00741534 -0.04612168 -0.29396537]
Stock Position:  -0.007415339030049145
Bond Position:  [-2.50483797]


portfolio before change:  [-3.22599308]
curr_Stock_Price:  97.20957854602976
curr_Factors:  [97.20957855 -0.75653386 -0.9034078 ]
mat_Sqrt:  [[18.48440864  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00255021 0.03299849 0.32455271]
Stock Position:  0.0025502139849183144
Bond Position:  [-3.4738983]


portfolio before change:  [-3.22946483]
curr_Stock_Price:  96.0185078178773
curr_Factors:  [96.01850782 -0.5976638  -0.88491531]
mat_Sqrt:  [[21.80113112  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00487054 -0.03823635 -0.44033585]
Stock Position:  0.004870535840010352
Bond Position:  [-3.69712641]


portfolio before change:  [-3.23171611]
curr_Stock_Price:  95.65117399764485
curr_Factors:  [95.651174   -0.30400813 -0.8553773 ]
mat_Sqrt:  [[30.00375512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00372354 0.0009372  0.16657148]
Stock Position:  0.0037235353308192666
Bond Position:  [-3.58787664]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.2421217]
Stock Price:  92.9770805369802
PL:  [-3.2421217]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.56493401e-01 -1.09979569e-01  2.13071987e-02]
 [-1.50300956e-01  6.75953374e-02 -1.66802033e-01]
 [-3.34476159e-02  4.23718266e-02  2.28015460e-02]
 [ 7.93497039e-02  8.63152395e-02  6.35252152e-02]
 [ 4.58204860e-02  3.20464628e-02 -7.11054868e-02]
 [-7.20130405e-02 -1.51927013e-01  1.56602245e-01]
 [-6.38613418e-02 -1.48693695e-01  3.12710995e-02]
 [-2.35296242e-02  7.97587988e-01  1.57199560e-01]
 [ 4.92399622e-02 -1.10902180e-01  2.23145510e-02]
 [ 2.06229047e-01  7.14075563e-02  8.35259988e-02]
 [-9.09571876e-02 -2.43864599e-01 -2.03122455e-02]
 [-9.53290285e-02 -2.00093053e-02  8.51950094e-02]
 [-2.03062018e-02  9.76395374e-02 -1.08447913e-04]
 [ 9.01759464e-03 -1.06043034e-01  5.30777871e-02]
 [-9.26597534e-02  1.95243180e-01 -3.93926665e-02]
 [ 5.90905366e-03 -3.01335234e-02  2.61407125e-02]
 [ 5.17284419e-02  8.71720758e-02 -1.65195815e-01]
 [-2.05602685e-02 -5.62279217e-02 -2.37116545e-02]
 [ 3.14988988e-02  7.90824009e-02 -2.31252365e-01]
 [-6.66009222e-02  2.92442959e-02 -6.06828671e-02]
 [-5.31187996e-02  6.18558087e-01 -5.97273275e-01]
 [ 5.19593776e-01  2.84064508e-01  3.77657440e-02]
 [ 8.39505570e-03  3.44694001e-02  2.90620704e-02]
 [-5.54815375e-02 -1.28062951e-01 -2.60691880e-02]
 [ 3.90174373e-02 -4.30755336e-04 -1.21341357e-02]
 [-4.13388154e-02  7.09870419e-03  1.01569332e-01]
 [ 7.81098573e-02 -3.05587577e-02  2.79885362e-02]
 [ 1.52099951e-01 -6.60013563e-02  1.21873415e-01]
 [-4.81084478e-02 -4.23854491e-02  2.34374853e-02]
 [-8.21664493e-02 -9.65937545e-03  4.19322526e-02]
 [-1.95226698e-02 -4.85066710e-02 -2.45131085e-02]
 [ 2.62122815e-02 -3.36679053e-02 -8.47611794e-02]
 [-4.12732608e-02  2.01239915e-02 -5.61250896e-02]
 [ 8.18741050e-03 -7.57157813e-02 -5.08795718e-02]
 [ 9.06169348e-03  8.60539092e-02  3.29434829e-02]
 [ 3.28266314e-02  3.04447326e-02  1.27722315e-01]
 [ 9.30113610e-02 -7.10425493e-02  2.55854852e-02]
 [-7.04603492e-02  1.01547637e-02  3.61728206e-02]
 [ 1.74566109e-01 -8.03720770e-03  9.77209320e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.7054954]
curr_Stock_Price:  100.54360169294156
curr_Factors:  [100.54360169  -0.73039936  -0.99786845]
mat_Sqrt:  [[17.85571589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01537847 -0.03549575  0.06078351]
Stock Position:  -0.015378468982937144
Bond Position:  [8.25170206]


portfolio before change:  [6.71384301]
curr_Stock_Price:  100.06786623393674
curr_Factors:  [100.06786623  -0.72809276  -1.01618403]
mat_Sqrt:  [[17.48899506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00975193  0.0218163  -0.47583977]
Stock Position:  -0.009751928991455893
Bond Position:  [7.68969774]


portfolio before change:  [6.71664256]
curr_Stock_Price:  99.87936288955805
curr_Factors:  [99.87936289 -0.97994483 -1.03447173]
mat_Sqrt:  [[13.32372825  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0015119   0.01367545  0.06504646]
Stock Position:  -0.0015119009142764807
Bond Position:  [6.86765026]


portfolio before change:  [6.71860422]
curr_Stock_Price:  99.14971559899962
curr_Factors:  [99.1497156  -0.81592193 -1.05570517]
mat_Sqrt:  [[15.25647325  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00720584 0.02785812 0.18121976]
Stock Position:  0.007205843500948291
Bond Position:  [6.00414689]


portfolio before change:  [6.72556471]
curr_Stock_Price:  100.01150533846302
curr_Factors:  [100.01150534  -0.98866555  -1.0477054 ]
mat_Sqrt:  [[13.05164632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00289983  0.01034295 -0.20284416]
Stock Position:  0.0028998331106564446
Bond Position:  [6.43554803]


portfolio before change:  [6.72383137]
curr_Stock_Price:  99.13634194883973
curr_Factors:  [99.13634195 -0.98506935 -1.03927188]
mat_Sqrt:  [[13.09400984  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00542681 -0.04903423  0.44674262]
Stock Position:  -0.0054268107003053135
Bond Position:  [7.26182554]


portfolio before change:  [6.72801102]
curr_Stock_Price:  98.53343603457773
curr_Factors:  [98.53343603 -1.02449811 -1.02246905]
mat_Sqrt:  [[12.72322147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00690314 -0.04799068  0.08920774]
Stock Position:  -0.006903136045174748
Bond Position:  [7.40820073]


portfolio before change:  [6.72852094]
curr_Stock_Price:  98.59372210680053
curr_Factors:  [98.59372211 -0.72828569 -1.00617007]
mat_Sqrt:  [[17.40142035  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00984779 0.25742042 0.44844659]
Stock Position:  0.009847791986342155
Bond Position:  [5.75759047]


portfolio before change:  [6.71425202]
curr_Stock_Price:  97.07168943210833
curr_Factors:  [97.07168943 -0.57982622 -0.98825198]
mat_Sqrt:  [[20.23414604  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00153983 -0.03579352  0.0636572 ]
Stock Position:  0.0015398271858271283
Bond Position:  [6.56477839]


portfolio before change:  [6.71432956]
curr_Stock_Price:  96.58909539768764
curr_Factors:  [96.5890954  -0.58196476 -0.99421149]
mat_Sqrt:  [[19.97116723  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01190991 0.02304669 0.23827643]
Stock Position:  0.01190990610172781
Bond Position:  [5.5639625]


portfolio before change:  [6.69682729]
curr_Stock_Price:  95.06114031522199
curr_Factors:  [95.06114032 -0.46768734 -0.98872649]
mat_Sqrt:  [[22.15595771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00653919 -0.07870696 -0.05794518]
Stock Position:  -0.006539191945401274
Bond Position:  [7.31845034]


portfolio before change:  [6.68400327]
curr_Stock_Price:  97.16214653659293
curr_Factors:  [97.16214654 -0.37792494 -0.9910811 ]
mat_Sqrt:  [[24.71413018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331887 -0.00645798  0.24303765]
Stock Position:  -0.0033188727167854618
Bond Position:  [7.00647207]


portfolio before change:  [6.68400932]
curr_Stock_Price:  97.42422717234362
curr_Factors:  [97.42422717 -0.43516175 -0.99349464]
mat_Sqrt:  [[23.34583333  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.70373651e-05  3.15130252e-02 -3.09371709e-04]
Stock Position:  -1.7037365054727644e-05
Bond Position:  [6.68566918]


portfolio before change:  [6.68482523]
curr_Stock_Price:  98.58987071340405
curr_Factors:  [98.58987071 -0.46585171 -0.97595965]
mat_Sqrt:  [[23.31640449  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.69368677e-05 -3.42252421e-02  1.51416153e-01]
Stock Position:  -7.693686774501102e-05
Bond Position:  [6.69241042]


portfolio before change:  [6.68585088]
curr_Stock_Price:  96.1326890712858
curr_Factors:  [96.13268907 -0.21198114 -0.96923754]
mat_Sqrt:  [[29.50355409  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00206236  0.06301447 -0.11237631]
Stock Position:  -0.0020623583311195873
Bond Position:  [6.88411093]


portfolio before change:  [6.68548411]
curr_Stock_Price:  96.72780114631523
curr_Factors:  [96.72780115 -0.32207302 -1.00615183]
mat_Sqrt:  [[25.62775681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00019877 -0.00972555  0.07457218]
Stock Position:  0.0001987698182605437
Bond Position:  [6.66625754]


portfolio before change:  [6.68628117]
curr_Stock_Price:  96.54531218491223
curr_Factors:  [96.54531218 -0.27554244 -1.00059024]
mat_Sqrt:  [[26.94721026  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00132859  0.02813467 -0.47125768]
Stock Position:  0.0013285944074835647
Bond Position:  [6.55801161]


portfolio before change:  [6.68855542]
curr_Stock_Price:  97.6400334764915
curr_Factors:  [97.64003348 -0.33739619 -1.00540315]
mat_Sqrt:  [[25.4951502   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144647 -0.01814748 -0.06764275]
Stock Position:  -0.0014464659285896913
Bond Position:  [6.8297884]


portfolio before change:  [6.69061657]
curr_Stock_Price:  96.80532440037483
curr_Factors:  [ 9.68053244e+01 -5.24371224e-02 -1.01547888e+00]
mat_Sqrt:  [[33.27432204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.31433184e-05  2.55237351e-02 -6.59698628e-01]
Stock Position:  1.3143318352591368e-05
Bond Position:  [6.68934423]


portfolio before change:  [6.69146882]
curr_Stock_Price:  98.0249718146927
curr_Factors:  [ 9.80249718e+01 -8.86967777e-02 -1.01027428e+00]
mat_Sqrt:  [[32.6632698   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223549  0.00943856 -0.17311133]
Stock Position:  -0.0022354863460227045
Bond Position:  [6.91060231]


portfolio before change:  [6.68956302]
curr_Stock_Price:  99.26393381870668
curr_Factors:  [ 9.92639338e+01 -4.12625232e-02 -9.94355153e-01]
mat_Sqrt:  [[35.23939469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.38407756e-03  1.99638764e-01 -1.70385440e+00]
Stock Position:  -0.001384077563245589
Bond Position:  [6.826952]


portfolio before change:  [6.68799783]
curr_Stock_Price:  101.01138840079518
curr_Factors:  [ 1.01011388e+02 -7.53567326e-02 -1.00039480e+00]
mat_Sqrt:  [[34.44906075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01698993 0.09168143 0.10773516]
Stock Position:  0.016989929130169952
Bond Position:  [4.9718215]


portfolio before change:  [6.67853877]
curr_Stock_Price:  100.41806221871079
curr_Factors:  [100.41806222  -0.20965402  -1.0191005 ]
mat_Sqrt:  [[29.38803357  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00072694 0.01112495 0.082906  ]
Stock Position:  0.000726940874266894
Bond Position:  [6.60554078]


portfolio before change:  [6.68038438]
curr_Stock_Price:  101.82100833098569
curr_Factors:  [101.82100833  -0.25517843  -1.00551996]
mat_Sqrt:  [[28.8617752   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00301241 -0.04133214 -0.07436814]
Stock Position:  -0.0030124144497736148
Bond Position:  [6.98711145]


portfolio before change:  [6.68061245]
curr_Stock_Price:  102.03524416378279
curr_Factors:  [102.03524416  -0.23248428  -0.98279181]
mat_Sqrt:  [[30.26652134  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120439 -0.00013903 -0.03461531]
Stock Position:  0.0012043881489012594
Bond Position:  [6.55772241]


portfolio before change:  [6.682236]
curr_Stock_Price:  102.70262440589069
curr_Factors:  [102.70262441  -0.37141877  -0.95685288]
mat_Sqrt:  [[27.20949571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00070406  0.0022911   0.28974903]
Stock Position:  -0.0007040573488779867
Bond Position:  [6.75454454]


portfolio before change:  [6.6826]
curr_Stock_Price:  103.38491739311333
curr_Factors:  [103.38491739  -0.3698091   -0.96274659]
mat_Sqrt:  [[27.27316892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00284475 -0.0098628   0.0798435 ]
Stock Position:  0.0028447450781660818
Bond Position:  [6.38849627]


portfolio before change:  [6.68270665]
curr_Stock_Price:  103.14167583012346
curr_Factors:  [103.14167583  -0.3657998   -0.9726907 ]
mat_Sqrt:  [[27.04799913  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00604499 -0.02130185  0.34767093]
Stock Position:  0.006044986403232093
Bond Position:  [6.05921663]


portfolio before change:  [6.6741062]
curr_Stock_Price:  101.59363171628547
curr_Factors:  [101.59363172  -0.35093038  -0.93350445]
mat_Sqrt:  [[28.12182682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184825 -0.01367984  0.06686062]
Stock Position:  -0.001848250649239891
Bond Position:  [6.86187669]


portfolio before change:  [6.67451634]
curr_Stock_Price:  101.83582889361752
curr_Factors:  [101.83582889  -0.44312779  -0.944977  ]
mat_Sqrt:  [[25.41290742  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297403 -0.00311755  0.11962105]
Stock Position:  -0.002974031054971123
Bond Position:  [6.97737926]


portfolio before change:  [6.67326482]
curr_Stock_Price:  102.54992614485803
curr_Factors:  [102.54992614  -0.45876796  -0.93373491]
mat_Sqrt:  [[25.47880405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00135123 -0.01565546 -0.06992908]
Stock Position:  -0.001351231783538215
Bond Position:  [6.81183354]


portfolio before change:  [6.6747185]
curr_Stock_Price:  102.10429928691691
curr_Factors:  [102.10429929  -0.42713285  -0.91647998]
mat_Sqrt:  [[26.63915181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.65056582e-05 -1.08662697e-02 -2.41800052e-01]
Stock Position:  7.650565818545803e-05
Bond Position:  [6.66690695]


portfolio before change:  [6.67545141]
curr_Stock_Price:  100.79051492059224
curr_Factors:  [100.79051492  -0.39463044  -0.93356839]
mat_Sqrt:  [[26.70485606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182072  0.00649499 -0.16010926]
Stock Position:  -0.0018207158322217283
Bond Position:  [6.85896229]


portfolio before change:  [6.67333593]
curr_Stock_Price:  102.42333540348626
curr_Factors:  [102.4233354   -0.72686406  -0.91373173]
mat_Sqrt:  [[19.85624923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00088908 -0.02443716 -0.14514526]
Stock Position:  -0.0008890781705780019
Bond Position:  [6.76439828]


portfolio before change:  [6.67314493]
curr_Stock_Price:  103.5892597846825
curr_Factors:  [103.58925978  -0.54232529  -0.95500093]
mat_Sqrt:  [[23.17577241  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00143909 0.02777378 0.09397859]
Stock Position:  0.0014390862071757965
Bond Position:  [6.52407106]


portfolio before change:  [6.674566]
curr_Stock_Price:  104.01001712818478
curr_Factors:  [104.01001713  -0.85507397  -0.94641619]
mat_Sqrt:  [[17.16713934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00379285 0.009826   0.36435621]
Stock Position:  0.0037928476834991694
Bond Position:  [6.28007185]


portfolio before change:  [6.66989065]
curr_Stock_Price:  102.57035917777785
curr_Factors:  [102.57035918  -0.75613717  -0.94586697]
mat_Sqrt:  [[18.70039887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00447758 -0.02292888  0.07298827]
Stock Position:  0.004477577042315856
Bond Position:  [6.21062397]


portfolio before change:  [6.67132144]
curr_Stock_Price:  102.71651128023412
curr_Factors:  [102.71651128  -0.84806246  -0.95378242]
mat_Sqrt:  [[16.94762987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00359955  0.00327744  0.10319099]
Stock Position:  -0.00359954584454201
Bond Position:  [7.04105423]


portfolio before change:  [6.66906896]
curr_Stock_Price:  103.58680620510302
curr_Factors:  [103.58680621  -0.74710009  -0.95366223]
mat_Sqrt:  [[18.9091824   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01019995 -0.002594    0.27877062]
Stock Position:  0.010199950424503635
Bond Position:  [5.61248867]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.68114062]
Stock Price:  104.70152366535581
PL:  [1.97961696]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.84090122e-01 -1.00793793e-01  1.84804540e-02]
 [-1.22086859e-01  6.96659793e-02 -1.30036399e-01]
 [-2.15779725e-01 -3.92102993e-02 -1.50909605e-01]
 [-7.86974319e-01 -3.27676168e-01 -5.29864883e-01]
 [ 2.47735554e-01 -2.53150182e-01 -1.05507763e-01]
 [-1.29816961e-01 -1.95270731e-01 -1.09629406e-01]
 [-5.06257111e-02 -1.35363923e-01 -4.80989849e-02]
 [ 2.37419360e-03  7.67463107e-01  1.22300981e-01]
 [ 3.42559933e-01  1.95929662e-02  3.52779168e-01]
 [ 5.93329239e-01  2.67865640e-01  5.23413746e-01]
 [-1.12249117e-01 -1.86098165e-01  1.65548601e-02]
 [-2.78011116e-02 -1.86030802e-02  9.63233904e-02]
 [ 1.45406575e-02 -4.68001451e-02  4.62312245e-02]
 [ 3.78732604e-03 -2.43660636e-02  7.83761023e-02]
 [ 1.38280404e-01 -1.61863418e-01 -1.13988296e-01]
 [ 5.08188183e-02 -1.79541683e-02  4.34736143e-02]
 [ 4.52540751e-02  2.36217692e-02  2.25166608e-02]
 [-2.93157141e-02 -4.41021310e-02  6.82062662e-02]
 [ 7.99548807e-02 -4.71862086e-02 -8.55651112e-02]
 [ 3.89009387e-02 -7.81975110e-03  1.13132423e-01]
 [-2.23915210e-02  3.94396929e-01 -3.64779618e-01]
 [ 1.08728589e-01  8.74669023e-02  1.04672244e-01]
 [-1.91731938e-02  3.31540518e-02  2.89784245e-02]
 [ 6.38589503e-02 -1.48136995e-01 -2.44011002e-01]
 [ 5.99661747e-02  3.23391389e-02 -1.46038064e-02]
 [-2.99072694e-02  1.06763105e-02  7.98177745e-02]
 [ 6.65874166e-02 -3.22183808e-02  2.63362474e-02]
 [ 1.31255395e-01 -7.05355582e-02  3.32242832e-02]
 [-4.83872173e-02 -2.83619943e-02 -6.44001762e-03]
 [-5.87979363e-02 -1.18387677e-02  3.16563180e-02]
 [-2.59445377e-02 -4.22397899e-02 -9.47480860e-03]
 [ 2.61391930e-02 -2.51908755e-02 -7.12573589e-02]
 [ 1.20019420e-04  7.18315755e-03  1.60951560e-01]
 [ 8.74241883e-03 -7.46543315e-02 -4.35312746e-02]
 [-1.89905956e-02  7.77288336e-02  4.43309176e-02]
 [ 7.55842483e-02  2.84834066e-02  1.75966270e-01]
 [ 4.64766721e-02 -2.89619611e-02 -4.70841478e-03]
 [-5.49570004e-02 -1.14728430e-02  3.58177871e-02]
 [ 9.47144805e-02  5.68792133e-03  8.49935956e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.06247591]
curr_Stock_Price:  100.46253465337549
curr_Factors:  [100.46253465  -0.95512213  -1.01930194]
mat_Sqrt:  [[13.94834413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01440259 -0.03253106  0.05271959]
Stock Position:  -0.014402588606473185
Bond Position:  [7.50939647]


portfolio before change:  [6.06416256]
curr_Stock_Price:  100.41060516642344
curr_Factors:  [100.41060517  -0.76908448  -1.01453328]
mat_Sqrt:  [[16.87190933  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00796649  0.0224846  -0.37095765]
Stock Position:  -0.007966491360056923
Bond Position:  [6.86408278]


portfolio before change:  [6.04854361]
curr_Stock_Price:  102.47889502294238
curr_Factors:  [102.47889502  -0.86366343  -1.04943212]
mat_Sqrt:  [[15.12821173  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01682868 -0.01265507 -0.4305031 ]
Stock Position:  -0.01682867691879368
Bond Position:  [7.77312783]


portfolio before change:  [6.03728672]
curr_Stock_Price:  103.20554745166613
curr_Factors:  [103.20554745  -0.99755614  -1.04615371]
mat_Sqrt:  [[13.36999162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07195361 -0.10575703 -1.51155703]
Stock Position:  -0.07195360929922351
Bond Position:  [13.46329836]


portfolio before change:  [6.06228765]
curr_Stock_Price:  102.88147877774749
curr_Factors:  [102.88147878  -0.95737059  -1.05138691]
mat_Sqrt:  [[13.80209152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01264481 -0.08170387 -0.30098428]
Stock Position:  0.01264480877746989
Bond Position:  [4.76137102]


portfolio before change:  [6.07029616]
curr_Stock_Price:  103.46775150851438
curr_Factors:  [103.46775151  -1.20666749  -1.02863869]
mat_Sqrt:  [[11.06684613  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01735404 -0.06302336 -0.31274218]
Stock Position:  -0.017354035520260776
Bond Position:  [7.8658792]


portfolio before change:  [6.06556474]
curr_Stock_Price:  103.79705368089685
curr_Factors:  [103.79705368  -1.24575925  -1.02019298]
mat_Sqrt:  [[10.76699412  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00818008 -0.04368852 -0.13721302]
Stock Position:  -0.008180084380922287
Bond Position:  [6.91463339]


portfolio before change:  [6.07037326]
curr_Stock_Price:  103.31489005033418
curr_Factors:  [103.31489005  -1.37476101  -0.9970361 ]
mat_Sqrt:  [[ 9.64061007  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01908557 0.24769765 0.34889066]
Stock Position:  0.019085568880194997
Bond Position:  [4.09854981]


portfolio before change:  [6.06968847]
curr_Stock_Price:  103.25216506900492
curr_Factors:  [103.25216507  -1.40536324  -1.00175707]
mat_Sqrt:  [[ 9.30036723  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04500576 0.0063236  1.00638077]
Stock Position:  0.0450057579669482
Bond Position:  [1.42274652]


portfolio before change:  [6.06227441]
curr_Stock_Price:  103.08347750773353
curr_Factors:  [103.08347751  -1.37553683  -1.01954195]
mat_Sqrt:  [[ 9.39765638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08032305 0.08645326 1.49315373]
Stock Position:  0.0803230546890657
Bond Position:  [-2.21770539]


portfolio before change:  [6.04445507]
curr_Stock_Price:  102.86508303820375
curr_Factors:  [102.86508304  -1.32668713  -1.02567415]
mat_Sqrt:  [[ 9.78701966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01500528 -0.06006292  0.04722641]
Stock Position:  -0.015005282988530785
Bond Position:  [7.58797475]


portfolio before change:  [6.04822959]
curr_Stock_Price:  102.6767516549592
curr_Factors:  [102.67675165  -1.43603717  -1.03615754]
mat_Sqrt:  [[ 8.66585864  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137742 -0.00600412  0.27478382]
Stock Position:  -0.0013774191621799359
Bond Position:  [6.18965851]


portfolio before change:  [6.04941729]
curr_Stock_Price:  102.37623151561624
curr_Factors:  [102.37623152  -1.26325375  -1.00372342]
mat_Sqrt:  [[10.60873166  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00135968 -0.01510468  0.13188482]
Stock Position:  0.0013596844137109048
Bond Position:  [5.91021792]


portfolio before change:  [6.04904536]
curr_Stock_Price:  101.5593152883424
curr_Factors:  [101.55931529  -1.77392284  -0.99274851]
mat_Sqrt:  [[ 6.3851288   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00231978 -0.00786411  0.2235852 ]
Stock Position:  0.00231977764043835
Bond Position:  [5.81345033]


portfolio before change:  [6.04946903]
curr_Stock_Price:  101.4286726962224
curr_Factors:  [101.4286727   -1.94048083  -0.96937021]
mat_Sqrt:  [[ 5.5262241   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01483335 -0.05224119 -0.32517688]
Stock Position:  0.014833348696184396
Bond Position:  [4.54494216]


portfolio before change:  [6.0503106]
curr_Stock_Price:  101.44710523442666
curr_Factors:  [101.44710523  -1.94523909  -0.98468929]
mat_Sqrt:  [[ 5.4173629   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01034229 -0.00579468  0.12401812]
Stock Position:  0.010342292815609772
Bond Position:  [5.00111493]


portfolio before change:  [6.048647]
curr_Stock_Price:  101.22580304806941
curr_Factors:  [101.22580305  -1.76539972  -0.9998014 ]
mat_Sqrt:  [[ 6.3735242   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00857799 0.00762389 0.06423377]
Stock Position:  0.008577992480645892
Bond Position:  [5.18033283]


portfolio before change:  [6.04781522]
curr_Stock_Price:  101.05334246898893
curr_Factors:  [101.05334247  -1.73156432  -1.0261026 ]
mat_Sqrt:  [[ 6.41078422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380538 -0.0142339   0.19457349]
Stock Position:  -0.003805381254046219
Bond Position:  [6.43236172]


portfolio before change:  [6.0488626]
curr_Stock_Price:  100.98941036431275
curr_Factors:  [100.98941036  -1.64140918  -1.05681568]
mat_Sqrt:  [[ 6.79910378  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00777413 -0.01522928 -0.24409345]
Stock Position:  0.007774132105142158
Bond Position:  [5.26375758]


portfolio before change:  [6.05043719]
curr_Stock_Price:  101.10731164665064
curr_Factors:  [101.10731165  -1.51155901  -1.03848851]
mat_Sqrt:  [[ 7.89425215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00765086 -0.00252381  0.32273531]
Stock Position:  0.007650857439224809
Bond Position:  [5.27687957]


portfolio before change:  [6.048473]
curr_Stock_Price:  100.76436458115045
curr_Factors:  [100.76436458  -1.40647751  -1.04092116]
mat_Sqrt:  [[ 8.71796729  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00187497  0.12729106 -1.04061471]
Stock Position:  -0.0018749683327034324
Bond Position:  [6.237403]


portfolio before change:  [6.04876114]
curr_Stock_Price:  101.02655231029115
curr_Factors:  [101.02655231  -1.55219345  -1.01446121]
mat_Sqrt:  [[ 7.7580322   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01907041 0.02822982 0.29860078]
Stock Position:  0.019070406530745702
Bond Position:  [4.12214371]


portfolio before change:  [6.05201877]
curr_Stock_Price:  101.17035303537139
curr_Factors:  [101.17035304  -1.64006236  -1.02390712]
mat_Sqrt:  [[ 7.0486512   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00092081  0.01070042  0.08266738]
Stock Position:  -0.000920808107909181
Bond Position:  [6.14517725]


portfolio before change:  [6.05291798]
curr_Stock_Price:  101.02807677543407
curr_Factors:  [101.02807678  -1.31942451  -1.01776568]
mat_Sqrt:  [[ 9.75917893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00165874 -0.04781101 -0.69609547]
Stock Position:  -0.0016587383445103708
Bond Position:  [6.22049712]


portfolio before change:  [6.05298915]
curr_Stock_Price:  101.45396843779
curr_Factors:  [101.45396844  -1.07529617  -1.01055118]
mat_Sqrt:  [[12.60076892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00504623  0.01043741 -0.04166059]
Stock Position:  0.005046230485374383
Bond Position:  [5.54102904]


portfolio before change:  [6.05575072]
curr_Stock_Price:  101.86395725035977
curr_Factors:  [101.86395725  -1.02349703  -1.01992036]
mat_Sqrt:  [[13.20005224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008663   0.00344576  0.22769789]
Stock Position:  -0.0008663027610968312
Bond Position:  [6.14399574]


portfolio before change:  [6.05607085]
curr_Stock_Price:  102.38100262644902
curr_Factors:  [102.38100263  -1.06577841  -0.98928762]
mat_Sqrt:  [[13.11340711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00498625 -0.01039844  0.07512998]
Stock Position:  0.004986250370529111
Bond Position:  [5.54557353]


portfolio before change:  [6.0541606]
curr_Stock_Price:  101.85886899799722
curr_Factors:  [101.858869    -1.15996722  -0.98113238]
mat_Sqrt:  [[11.97101865  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01032822 -0.02276525  0.09477963]
Stock Position:  0.010328215711386588
Bond Position:  [5.00214023]


portfolio before change:  [6.05509445]
curr_Stock_Price:  101.88874313634732
curr_Factors:  [101.88874314  -1.04571204  -0.98060632]
mat_Sqrt:  [[13.43096833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00413158 -0.00915379 -0.01837158]
Stock Position:  -0.004131582093104387
Bond Position:  [6.47605616]


portfolio before change:  [6.05426225]
curr_Stock_Price:  102.28611153764695
curr_Factors:  [102.28611154  -1.17426615  -0.9893825 ]
mat_Sqrt:  [[11.75319655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00465854 -0.00382095  0.09030666]
Stock Position:  -0.004658536556956327
Bond Position:  [6.53076584]


portfolio before change:  [6.05361995]
curr_Stock_Price:  102.59923334088462
curr_Factors:  [102.59923334  -1.22850686  -1.01827825]
mat_Sqrt:  [[10.84870102  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00336453 -0.01363283 -0.02702899]
Stock Position:  -0.003364525931008157
Bond Position:  [6.39881774]


portfolio before change:  [6.05443809]
curr_Stock_Price:  102.59381401324035
curr_Factors:  [102.59381401  -0.99273496  -1.01178868]
mat_Sqrt:  [[13.82189599  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00046678 -0.00813032 -0.20327741]
Stock Position:  0.00046677963753229373
Bond Position:  [6.00654939]


portfolio before change:  [6.05520271]
curr_Stock_Price:  102.62328120220376
curr_Factors:  [102.6232812   -0.77690233  -1.03758198]
mat_Sqrt:  [[16.71958039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00205988 0.00231835 0.45915   ]
Stock Position:  0.0020598827299082223
Bond Position:  [5.84381079]


portfolio before change:  [6.05477463]
curr_Stock_Price:  102.06082284810807
curr_Factors:  [102.06082285  -0.49480282  -1.0272225 ]
mat_Sqrt:  [[22.2767518   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0006905  -0.02409458 -0.12418261]
Stock Position:  -0.0006905008927464806
Bond Position:  [6.12524772]


portfolio before change:  [6.05546808]
curr_Stock_Price:  102.1654655933701
curr_Factors:  [102.16546559  -0.39009127  -1.03729266]
mat_Sqrt:  [[24.51315175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0002417  0.02508687 0.12646377]
Stock Position:  0.00024169665593581368
Bond Position:  [6.03077503]


portfolio before change:  [6.05614164]
curr_Stock_Price:  101.83309214618194
curr_Factors:  [101.83309215  -0.50117561  -1.04318664]
mat_Sqrt:  [[21.73606524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00539736 0.00919298 0.50198279]
Stock Position:  0.005397359759409923
Bond Position:  [5.50651181]


portfolio before change:  [6.05710976]
curr_Stock_Price:  101.88492466371126
curr_Factors:  [101.88492466  -0.77684561  -1.02151782]
mat_Sqrt:  [[16.86904948  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00234772 -0.00934743 -0.0134318 ]
Stock Position:  0.002347715886486752
Bond Position:  [5.8179129]


portfolio before change:  [6.05421245]
curr_Stock_Price:  100.34104522981512
curr_Factors:  [100.34104523  -0.53294642  -1.01841193]
mat_Sqrt:  [[21.26827414  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00235034 -0.00370284  0.10217818]
Stock Position:  -0.002350336897751587
Bond Position:  [6.29004771]


portfolio before change:  [6.05490945]
curr_Stock_Price:  100.37904420707045
curr_Factors:  [100.37904421  -0.66922244  -1.02010027]
mat_Sqrt:  [[18.5344424   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00610888 0.00183577 0.24246307]
Stock Position:  0.006108884487162002
Bond Position:  [5.44170546]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.06152281]
Stock Price:  101.35026940619004
PL:  [4.7112534]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.60952136e-01 -1.06776391e-01  2.26767248e-02]
 [-1.36470085e-01  6.86103896e-02 -1.48779101e-01]
 [-2.20997419e-02  5.66843717e-02  3.37288638e-02]
 [ 8.44143052e-02  2.16352736e-03  1.24964406e-01]
 [ 1.70262474e-02  7.27214395e-02 -6.61720588e-02]
 [-7.30366520e-02 -1.52641456e-01  1.52716685e-01]
 [-5.91156775e-02 -1.81495654e-01  1.00832316e-01]
 [ 1.95642185e-02  7.53445167e-01  1.09351991e-01]
 [ 5.68725541e-02  3.33377947e-02  4.02594812e-02]
 [ 3.52336076e-01  1.32352618e-01  2.06937995e-01]
 [-2.03859599e-01 -2.85492868e-01 -1.34623377e-02]
 [ 7.34405176e-02 -1.08454757e-02  1.24457542e-01]
 [-2.13860139e-02  1.15290639e-01 -2.14271389e-01]
 [ 1.51493173e-02 -2.32693948e-01  3.52789738e-02]
 [ 1.21083052e-02 -1.84066269e-02 -6.37440854e-02]
 [ 1.86058877e-01  2.05260059e-02 -7.42023649e-02]
 [ 4.37414531e-02  3.07789686e-02  1.72473321e-02]
 [-4.46235877e-02 -5.34745859e-02  4.59537456e-02]
 [ 6.27051235e-02 -2.26162121e-02 -1.08639537e-01]
 [ 4.62945713e-02 -1.41182316e-02  1.43711851e-01]
 [-1.79139084e-02  3.50161925e-01 -3.08430990e-01]
 [ 5.90407384e-02  5.89789064e-02  1.14346656e-01]
 [-1.19412257e-03 -1.91704655e-02  6.10787863e-02]
 [ 1.01373703e-01 -9.57739409e-02 -2.52274660e-01]
 [ 2.85860435e-02  2.07756010e-02 -1.21613641e-02]
 [-7.65579064e-02 -1.42084534e-02  2.03594040e-01]
 [-1.11539130e-02 -3.24354498e-02  2.20446994e-03]
 [-4.51965615e-02  1.76813356e-02 -2.72179365e-01]
 [-3.24153427e-02 -4.17491715e-02  3.96721177e-02]
 [-8.31557965e-02 -4.01247924e-03  3.73188965e-02]
 [-2.76484878e-02 -4.21606842e-02 -7.42077280e-03]
 [ 2.76919889e-02 -2.34843801e-03 -4.79829196e-02]
 [-3.68162181e-02  2.03259444e-02 -1.60793822e-02]
 [ 2.21219642e-02 -5.56557511e-02  6.28908118e-02]
 [-5.68664401e-02  5.97721243e-02 -1.28116912e-02]
 [-1.62686465e-02 -7.81253824e-02  1.02426948e-02]
 [-2.88933279e-02  1.00805365e-01  7.34088586e-02]
 [ 1.61767631e-01 -1.19684490e-01 -1.57741953e-01]
 [ 9.92307262e-02  2.88999310e-03  5.82583187e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.97506652]
curr_Stock_Price:  100.82973207243913
curr_Factors:  [100.82973207  -1.00492131  -1.00693449]
mat_Sqrt:  [[13.48499346  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02062433 -0.03446193  0.06469038]
Stock Position:  -0.020624326569904226
Bond Position:  [11.05461184]


portfolio before change:  [8.98815802]
curr_Stock_Price:  100.26197563555485
curr_Factors:  [100.26197564  -0.92623736  -0.9953236 ]
mat_Sqrt:  [[14.67617683  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01041378  0.02214391 -0.42442536]
Stock Position:  -0.010413778498988386
Bond Position:  [10.03226403]


portfolio before change:  [9.00295623]
curr_Stock_Price:  98.96138166273799
curr_Factors:  [98.96138166 -1.26182663 -0.97390879]
mat_Sqrt:  [[10.58030511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034443  0.0182948   0.09621906]
Stock Position:  -0.000344434059409033
Bond Position:  [9.0370419]


portfolio before change:  [9.00375292]
curr_Stock_Price:  99.92822399213235
curr_Factors:  [99.92822399 -1.38456728 -0.97033093]
mat_Sqrt:  [[ 9.48350485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01163749 0.00069828 0.35648867]
Stock Position:  0.011637489279645134
Bond Position:  [7.84083928]


portfolio before change:  [9.00094624]
curr_Stock_Price:  99.60282332208035
curr_Factors:  [99.60282332 -1.04465732 -0.95898206]
mat_Sqrt:  [[13.43080745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00136724  0.02347074 -0.18877047]
Stock Position:  0.0013672397747695273
Bond Position:  [8.8647653]


portfolio before change:  [9.00173868]
curr_Stock_Price:  99.37190276934331
curr_Factors:  [99.37190277 -1.22292483 -0.94663846]
mat_Sqrt:  [[11.35100308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00643303 -0.04926482  0.43565819]
Stock Position:  -0.006433025821335181
Bond Position:  [9.6410007]


portfolio before change:  [8.99916775]
curr_Stock_Price:  99.95889458056345
curr_Factors:  [99.95889458 -1.43307537 -0.93596176]
mat_Sqrt:  [[ 9.3532317   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00808074 -0.05857747  0.28764653]
Stock Position:  -0.008080737754954988
Bond Position:  [9.80690936]


portfolio before change:  [9.00619276]
curr_Stock_Price:  99.24125279963094
curr_Factors:  [99.2412528  -1.30907718 -0.92385213]
mat_Sqrt:  [[10.64004246  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01839109 0.24317338 0.31195079]
Stock Position:  0.018391087399802383
Bond Position:  [7.18103821]


portfolio before change:  [9.00744146]
curr_Stock_Price:  99.2603390089738
curr_Factors:  [99.26033901 -1.19508362 -0.90893894]
mat_Sqrt:  [[12.1062703   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0059387  0.01075973 0.11484909]
Stock Position:  0.005938702288229591
Bond Position:  [8.41796386]


portfolio before change:  [9.01005558]
curr_Stock_Price:  99.52332582640074
curr_Factors:  [99.52332583 -1.06838391 -0.9141154 ]
mat_Sqrt:  [[13.70680924  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03075796 0.04271662 0.5903365 ]
Stock Position:  0.03075795943442983
Bond Position:  [5.94892116]


portfolio before change:  [9.02372619]
curr_Stock_Price:  99.94360567445264
curr_Factors:  [99.94360567 -1.34644599 -0.89554082]
mat_Sqrt:  [[10.61872842  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02494494 -0.09214243 -0.0384043 ]
Stock Position:  -0.024944942972540952
Bond Position:  [11.51681373]


portfolio before change:  [9.0490836]
curr_Stock_Price:  98.98478546446465
curr_Factors:  [98.98478546 -1.52519635 -0.87555448]
mat_Sqrt:  [[ 8.97295746  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01076919 -0.00350036  0.35504272]
Stock Position:  0.010769189962336338
Bond Position:  [7.98309764]


portfolio before change:  [9.05460569]
curr_Stock_Price:  99.40488664766919
curr_Factors:  [99.40488665 -1.75722516 -0.84720576]
mat_Sqrt:  [[ 7.35051486  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00565816  0.03720989 -0.61125663]
Stock Position:  -0.005658158059536372
Bond Position:  [9.61705425]


portfolio before change:  [9.05322809]
curr_Stock_Price:  99.86083232773505
curr_Factors:  [99.86083233 -1.69799308 -0.89434901]
mat_Sqrt:  [[ 7.47403824  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00336469 -0.07510165  0.10064109]
Stock Position:  -0.0033646931737220716
Bond Position:  [9.38922915]


portfolio before change:  [9.05517819]
curr_Stock_Price:  99.63009147854669
curr_Factors:  [99.63009148 -1.6058494  -0.90911965]
mat_Sqrt:  [[ 8.05662869  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057848 -0.00594071 -0.18184413]
Stock Position:  -0.0005784849783282175
Bond Position:  [9.1128127]


portfolio before change:  [9.05649953]
curr_Stock_Price:  99.31518797275652
curr_Factors:  [99.31518797 -1.54070926 -0.89279399]
mat_Sqrt:  [[ 8.71281789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02009708  0.00662474 -0.21167869]
Stock Position:  0.020097084375894764
Bond Position:  [7.06055381]


portfolio before change:  [9.06195975]
curr_Stock_Price:  99.54296211237411
curr_Factors:  [99.54296211 -1.61317634 -0.90647997]
mat_Sqrt:  [[ 8.01194075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00668312 0.00993387 0.04920184]
Stock Position:  0.0066831223990138616
Bond Position:  [8.39670195]


portfolio before change:  [9.06611667]
curr_Stock_Price:  100.00790549790061
curr_Factors:  [100.0079055   -1.65484704  -0.94114789]
mat_Sqrt:  [[ 7.45775406  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00618937 -0.01725885  0.13109325]
Stock Position:  -0.006189366455085177
Bond Position:  [9.68510225]


portfolio before change:  [9.06705266]
curr_Stock_Price:  100.05229308693823
curr_Factors:  [100.05229309  -1.566644    -0.92541969]
mat_Sqrt:  [[ 8.27823088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0043382  -0.00729935 -0.30991836]
Stock Position:  0.0043382041954300515
Bond Position:  [8.63300538]


portfolio before change:  [9.06686532]
curr_Stock_Price:  99.76034505656425
curr_Factors:  [99.76034506 -1.72531865 -0.91730245]
mat_Sqrt:  [[ 7.10038964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0102456  -0.00455664  0.40996991]
Stock Position:  0.010245600833906694
Bond Position:  [8.04476065]


portfolio before change:  [9.066664]
curr_Stock_Price:  99.64254083600787
curr_Factors:  [99.64254084 -1.52139656 -0.93700826]
mat_Sqrt:  [[ 8.52654615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00110193  0.11301428 -0.87986776]
Stock Position:  -0.0011019252807529301
Bond Position:  [9.17646264]


portfolio before change:  [9.06837443]
curr_Stock_Price:  99.13134343672279
curr_Factors:  [99.13134344 -1.37454833 -0.91704559]
mat_Sqrt:  [[10.02269233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00942069 0.01903536 0.32619918]
Stock Position:  0.009420689322778866
Bond Position:  [8.13448885]


portfolio before change:  [9.06880698]
curr_Stock_Price:  99.06931746922965
curr_Factors:  [99.06931747 -1.31185709 -0.92058296]
mat_Sqrt:  [[10.62680662  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00069262 -0.00618724  0.17424078]
Stock Position:  0.0006926236492721072
Bond Position:  [9.00018923]


portfolio before change:  [9.06974968]
curr_Stock_Price:  98.80598220258122
curr_Factors:  [98.8059822  -1.23398877 -0.92179259]
mat_Sqrt:  [[11.44298399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00265041 -0.03091091 -0.71966939]
Stock Position:  0.0026504083291313866
Bond Position:  [8.80787348]


portfolio before change:  [9.07106891]
curr_Stock_Price:  98.88829820751488
curr_Factors:  [98.88829821 -1.10912508 -0.94385564]
mat_Sqrt:  [[12.69248633  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00239074  0.0067053  -0.03469299]
Stock Position:  0.0023907386230238798
Bond Position:  [8.83465283]


portfolio before change:  [9.07309156]
curr_Stock_Price:  99.2723865753501
curr_Factors:  [99.27238658 -0.88976074 -0.96449618]
mat_Sqrt:  [[15.54300249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243838 -0.00458576  0.58079713]
Stock Position:  -0.0024383792941309558
Bond Position:  [9.31515529]


portfolio before change:  [9.0725644]
curr_Stock_Price:  99.96613834625902
curr_Factors:  [99.96613835 -0.54172884 -0.96310102]
mat_Sqrt:  [[22.19798784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078047 -0.0104685   0.00628874]
Stock Position:  -0.000780466503956486
Bond Position:  [9.15058462]


portfolio before change:  [9.07419978]
curr_Stock_Price:  99.33640375616272
curr_Factors:  [99.33640376 -0.62246951 -0.92829308]
mat_Sqrt:  [[21.06787829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00461108  0.00570663 -0.77645197]
Stock Position:  -0.0046110838912744425
Bond Position:  [9.53224827]


portfolio before change:  [9.07206592]
curr_Stock_Price:  100.05759281983921
curr_Factors:  [100.05759282  -0.57942197  -0.95182129]
mat_Sqrt:  [[21.63911778  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00151759 -0.01347449  0.11317351]
Stock Position:  -0.0015175905002304006
Bond Position:  [9.22391238]


portfolio before change:  [9.07182367]
curr_Stock_Price:  100.97701848429419
curr_Factors:  [100.97701848  -0.63410355  -0.96851195]
mat_Sqrt:  [[20.33365627  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00375521 -0.00129502  0.10646042]
Stock Position:  -0.003755210159146504
Bond Position:  [9.4510136]


portfolio before change:  [9.07366234]
curr_Stock_Price:  100.80200462496353
curr_Factors:  [100.80200462  -0.76341358  -0.95179305]
mat_Sqrt:  [[18.13695588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208245 -0.0136073  -0.0211694 ]
Stock Position:  -0.0020824476054431495
Bond Position:  [9.28357723]


portfolio before change:  [9.07413979]
curr_Stock_Price:  101.13001539428305
curr_Factors:  [101.13001539  -0.78235459  -0.97127638]
mat_Sqrt:  [[17.51006742  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099475 -0.00075796 -0.13688191]
Stock Position:  0.0009947502263722657
Bond Position:  [8.97354069]


portfolio before change:  [9.07430199]
curr_Stock_Price:  100.1653857430645
curr_Factors:  [100.16538574  -0.66659767  -1.02089831]
mat_Sqrt:  [[18.52880769  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00194019  0.00656017 -0.04587   ]
Stock Position:  -0.0019401891848782294
Bond Position:  [9.26864179]


portfolio before change:  [9.07674117]
curr_Stock_Price:  99.50538350663102
curr_Factors:  [99.50538351 -0.28726012 -1.0042163 ]
mat_Sqrt:  [[27.35051421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00086283 -0.01796282  0.17940998]
Stock Position:  0.0008628289238851683
Bond Position:  [8.99088505]


portfolio before change:  [9.07769999]
curr_Stock_Price:  99.31401992617396
curr_Factors:  [99.31401993 -0.54682555 -1.01123213]
mat_Sqrt:  [[20.91003254  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226115  0.01929137 -0.03654819]
Stock Position:  -0.0022611481730337663
Bond Position:  [9.3022637]


portfolio before change:  [9.08251386]
curr_Stock_Price:  97.69934462332917
curr_Factors:  [97.69934462 -0.48976344 -1.0261572 ]
mat_Sqrt:  [[21.45535381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00140409 -0.02521486  0.02921956]
Stock Position:  -0.0014040850754023207
Bond Position:  [9.21969205]


portfolio before change:  [9.08352628]
curr_Stock_Price:  97.79913842291552
curr_Factors:  [97.79913842 -0.44606315 -1.03531292]
mat_Sqrt:  [[22.23215576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00029993 0.03253479 0.20941504]
Stock Position:  0.0002999260036480494
Bond Position:  [9.05419377]


portfolio before change:  [9.08413989]
curr_Stock_Price:  96.0712668427808
curr_Factors:  [96.07126684 -0.52801586 -1.04454669]
mat_Sqrt:  [[19.93601161  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00527378 -0.038628   -0.44999388]
Stock Position:  0.005273782833064558
Bond Position:  [8.57748089]


portfolio before change:  [9.08659025]
curr_Stock_Price:  96.33258026006034
curr_Factors:  [96.33258026 -0.44301375 -1.04878212]
mat_Sqrt:  [[21.67177458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00515475 0.00093274 0.16619477]
Stock Position:  0.005154749678972276
Bond Position:  [8.59001991]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.08702254]
Stock Price:  96.20812651913133
PL:  [9.08702254]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 5.70919150e-03 -7.67140263e-02  1.10703724e-02]
 [-1.04337764e-01  7.09685912e-02 -1.06907651e-01]
 [ 1.02849640e-03  9.95323099e-03  4.72152058e-02]
 [ 1.27335979e-01  3.01998808e-02  1.51864062e-01]
 [-3.24361296e-02  1.45427933e-01 -4.94367950e-02]
 [-6.77942203e-02 -1.49115620e-01  1.71864993e-01]
 [-6.06783474e-02 -1.76004272e-01  1.03086247e-01]
 [-1.54343075e-02  7.58258272e-01  1.41119267e-01]
 [ 7.33943535e-02 -5.08117253e-02  4.86553452e-02]
 [ 3.01375405e-01  1.11095590e-01  1.63893124e-01]
 [-1.84296871e-01 -3.31403745e-01 -5.15940581e-02]
 [-5.23188132e-02 -1.91179715e-02  8.09734045e-02]
 [-9.90904269e-02  4.12541066e-01 -5.84472206e-01]
 [ 7.27523562e-03 -7.00545568e-02  5.81354070e-02]
 [-1.47510055e-01  1.90095278e-01 -3.66704813e-02]
 [-7.42932883e-02 -4.75265758e-02 -8.82258378e-03]
 [ 2.97832302e-02  1.57767345e-01 -2.68498493e-01]
 [ 5.02524873e-02 -3.59500223e-02 -6.89507047e-02]
 [ 4.56060444e-03  1.67347805e-01 -1.04728532e-01]
 [-9.14981125e-02 -1.53321728e-02 -2.48148524e-02]
 [-2.89466405e-02  4.03242574e-01 -3.38686677e-01]
 [ 1.25186485e-01  7.23351089e-02  1.28215064e-01]
 [ 8.00239100e-03 -5.63527072e-02  8.37758003e-02]
 [ 1.86518261e-01  8.30657393e-02 -2.68564586e-01]
 [-1.84781868e-01  6.26949133e-02  9.11522880e-03]
 [-1.49042513e-01 -3.36967673e-02  1.74363573e-01]
 [-6.55853048e-02 -3.45540188e-02 -1.70457088e-02]
 [-1.19824637e-01  1.47932360e-01 -6.90003335e-02]
 [ 1.71738394e-01  8.29248782e-03  1.97006730e-01]
 [ 9.30361138e-02  7.20903816e-02 -1.38839458e-01]
 [-1.40694132e-02  1.00537933e-02  4.83397708e-02]
 [-2.84117574e-02  1.31019526e-02 -9.26749594e-02]
 [-1.20338840e-03  8.68342090e-02 -1.19659397e-02]
 [ 4.62244749e-02 -3.97687475e-02  1.85425962e-01]
 [-7.98202711e-02  2.33042404e-02 -6.06707301e-02]
 [-2.10948137e-01 -2.15261305e-01 -1.94985802e-01]
 [ 1.15745296e-01  1.23679747e-01  3.17934808e-01]
 [ 2.21796514e-01 -1.48530492e-01 -2.79772732e-01]
 [ 9.56125414e-02  5.13154995e-03  7.96772538e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.56601964]
curr_Stock_Price:  99.89565541683777
curr_Factors:  [99.89565542 -1.01158087 -0.98545102]
mat_Sqrt:  [[13.55959351  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056715 -0.02475935  0.03158069]
Stock Position:  -0.000567145558922832
Bond Position:  [1.62267502]


portfolio before change:  [1.56594051]
curr_Stock_Price:  100.39283907814807
curr_Factors:  [100.39283908  -0.78547774  -0.97099115]
mat_Sqrt:  [[17.33316978  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00644278  0.02290501 -0.30497777]
Stock Position:  -0.006442779680241937
Bond Position:  [2.21274945]


portfolio before change:  [1.56541457]
curr_Stock_Price:  100.51740457360927
curr_Factors:  [100.51740457  -0.79818712  -0.95676338]
mat_Sqrt:  [[17.3810476   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00073056 0.00321239 0.13469184]
Stock Position:  0.0007305632541604268
Bond Position:  [1.49198025]


portfolio before change:  [1.56526606]
curr_Stock_Price:  100.05882170167102
curr_Factors:  [100.0588217   -0.8979139   -1.01494267]
mat_Sqrt:  [[14.77448433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01113404 0.00974697 0.4332259 ]
Stock Position:  0.011134035021306075
Bond Position:  [0.45120763]


portfolio before change:  [1.55632512]
curr_Stock_Price:  99.2507283984454
curr_Factors:  [99.2507284  -0.92421574 -0.9886999 ]
mat_Sqrt:  [[14.65429727  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00087633  0.04693666 -0.14102942]
Stock Position:  -0.0008763313903011917
Bond Position:  [1.64330165]


portfolio before change:  [1.55681497]
curr_Stock_Price:  98.92617370044638
curr_Factors:  [98.9261737  -0.84329444 -0.96551637]
mat_Sqrt:  [[16.20894164  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00389603 -0.04812686  0.49028299]
Stock Position:  -0.0038960300653531617
Bond Position:  [1.94223431]


portfolio before change:  [1.55346048]
curr_Stock_Price:  99.84949283612522
curr_Factors:  [99.84949284 -0.76559342 -0.92956376]
mat_Sqrt:  [[18.32940872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00412248 -0.05680513  0.29407637]
Stock Position:  -0.004122483055459405
Bond Position:  [1.96508832]


portfolio before change:  [1.55695926]
curr_Stock_Price:  99.06037447097485
curr_Factors:  [99.06037447 -0.67301986 -0.9146316 ]
mat_Sqrt:  [[20.24844602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00830436 0.2447268  0.40257399]
Stock Position:  0.00830435895252656
Bond Position:  [0.73432635]


portfolio before change:  [1.54699544]
curr_Stock_Price:  97.84949069947413
curr_Factors:  [97.8494907  -0.69531504 -0.9141457 ]
mat_Sqrt:  [[19.56945142  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00372796 -0.01639941  0.13880016]
Stock Position:  0.0037279626643895235
Bond Position:  [1.1822162]


portfolio before change:  [1.54729474]
curr_Stock_Price:  97.89013224716282
curr_Factors:  [97.89013225 -0.67029902 -0.88766413]
mat_Sqrt:  [[20.61218887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01734446 0.03585595 0.46754147]
Stock Position:  0.017344457848722575
Bond Position:  [-0.15055653]


portfolio before change:  [1.51501813]
curr_Stock_Price:  96.03029977111395
curr_Factors:  [96.03029977 -0.65526765 -0.87250185]
mat_Sqrt:  [[20.84041782  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01259456 -0.1069601  -0.14718349]
Stock Position:  -0.012594563712090293
Bond Position:  [2.72447786]


portfolio before change:  [1.5195229]
curr_Stock_Price:  95.69966635114501
curr_Factors:  [95.69966635 -0.64484238 -0.85395838]
mat_Sqrt:  [[21.37910534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185661 -0.0061703   0.23099458]
Stock Position:  -0.0018566083653306536
Bond Position:  [1.6971997]


portfolio before change:  [1.52201716]
curr_Stock_Price:  94.47049130148663
curr_Factors:  [94.4704913  -0.67741988 -0.85099862]
mat_Sqrt:  [[20.48860786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00654928  0.13314706 -1.66733652]
Stock Position:  -0.006549284598276044
Bond Position:  [2.14073129]


portfolio before change:  [1.51344439]
curr_Stock_Price:  95.82031454844768
curr_Factors:  [95.82031455 -0.60933971 -0.86493393]
mat_Sqrt:  [[21.93757824  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00022073 -0.02261001  0.16584413]
Stock Position:  0.0002207285280347131
Bond Position:  [1.49229411]


portfolio before change:  [1.51323306]
curr_Stock_Price:  94.01773173862331
curr_Factors:  [94.01773174 -0.50576652 -0.83952926]
mat_Sqrt:  [[24.48810816  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00474485  0.06135299 -0.10461068]
Stock Position:  -0.004744847941752565
Bond Position:  [1.9593329]


portfolio before change:  [1.50578851]
curr_Stock_Price:  95.63832709444675
curr_Factors:  [95.63832709 -0.39769255 -0.82008048]
mat_Sqrt:  [[28.29826861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303183 -0.01533914 -0.02516838]
Stock Position:  -0.0030318290321458777
Bond Position:  [1.79574757]


portfolio before change:  [1.51062936]
curr_Stock_Price:  94.11569173843672
curr_Factors:  [94.11569174 -0.19210657 -0.80275594]
mat_Sqrt:  [[34.80156256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.06322035e-04  5.09191917e-02 -7.65951466e-01]
Stock Position:  0.000206322034631389
Bond Position:  [1.49121122]


portfolio before change:  [1.51109225]
curr_Stock_Price:  95.45571345986589
curr_Factors:  [95.45571346 -0.70169855 -0.76798396]
mat_Sqrt:  [[21.95467064  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0013136  -0.01160282 -0.19669717]
Stock Position:  0.0013136027654876135
Bond Position:  [1.38570136]


portfolio before change:  [1.51070479]
curr_Stock_Price:  95.02888634733947
curr_Factors:  [95.02888635 -0.62194209 -0.7683902 ]
mat_Sqrt:  [[23.66148508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00073295  0.05401127 -0.29876135]
Stock Position:  0.0007329510380491632
Bond Position:  [1.44105327]


portfolio before change:  [1.5107067]
curr_Stock_Price:  94.78570950362756
curr_Factors:  [94.7857095  -0.74609776 -0.74578678]
mat_Sqrt:  [[21.32188736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00467562 -0.00494844 -0.07078987]
Stock Position:  -0.004675622190454555
Bond Position:  [1.95388887]


portfolio before change:  [1.51157489]
curr_Stock_Price:  94.65226526158212
curr_Factors:  [94.65226526 -0.75692539 -0.74308939]
mat_Sqrt:  [[21.11946293  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.46667806e-04  1.30145981e-01 -9.66178817e-01]
Stock Position:  -0.0007466678064123843
Bond Position:  [1.58224869]


portfolio before change:  [1.51142807]
curr_Stock_Price:  95.11380081122473
curr_Factors:  [95.11380081 -0.84495236 -0.75379498]
mat_Sqrt:  [[19.22721522  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00864002 0.02334606 0.36576189]
Stock Position:  0.008640024872896133
Bond Position:  [0.68964246]


portfolio before change:  [1.51353212]
curr_Stock_Price:  95.34734629496734
curr_Factors:  [95.34734629 -0.78046458 -0.75346803]
mat_Sqrt:  [[20.56506757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00066132 -0.01818776  0.23898904]
Stock Position:  0.0006613207755989703
Bond Position:  [1.45047693]


portfolio before change:  [1.51351542]
curr_Stock_Price:  95.04792061941437
curr_Factors:  [95.04792062 -0.93114713 -0.7474717 ]
mat_Sqrt:  [[17.7389425   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00838006  0.02680935 -0.76614001]
Stock Position:  0.00838006368019383
Bond Position:  [0.71700779]


portfolio before change:  [1.50444523]
curr_Stock_Price:  93.95487106126687
curr_Factors:  [93.95487106 -0.8573378  -0.75619003]
mat_Sqrt:  [[18.71427762  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00909058  0.0202347   0.02600321]
Stock Position:  -0.009090582457731474
Bond Position:  [2.35854973]


portfolio before change:  [1.49902944]
curr_Stock_Price:  94.58306248517759
curr_Factors:  [94.58306249 -1.10060817 -0.76652365]
mat_Sqrt:  [[14.61935872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0082308  -0.01087558  0.49741074]
Stock Position:  -0.008230800247831275
Bond Position:  [2.27752373]


portfolio before change:  [1.50040062]
curr_Stock_Price:  94.45106137146027
curr_Factors:  [94.45106137 -0.78449573 -0.77679175]
mat_Sqrt:  [[19.82203797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00384007 -0.01115226 -0.04862666]
Stock Position:  -0.003840072108294857
Bond Position:  [1.86309951]


portfolio before change:  [1.49782438]
curr_Stock_Price:  95.18259484070236
curr_Factors:  [95.18259484 -0.80443034 -0.77442244]
mat_Sqrt:  [[19.62774873  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00528398  0.04774496 -0.19683875]
Stock Position:  -0.005283983722624405
Bond Position:  [2.00076766]


portfolio before change:  [1.50548712]
curr_Stock_Price:  93.77974621210996
curr_Factors:  [93.77974621 -0.63869064 -0.77918883]
mat_Sqrt:  [[22.71599819  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00940504 0.00267639 0.56200536]
Stock Position:  0.009405042186429716
Bond Position:  [0.62348465]


portfolio before change:  [1.50134632]
curr_Stock_Price:  93.33118387810056
curr_Factors:  [93.33118388 -0.4687711  -0.80329208]
mat_Sqrt:  [[26.15632696  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00303602  0.02326707 -0.39607033]
Stock Position:  0.003036015559265045
Bond Position:  [1.21799139]


portfolio before change:  [1.4985732]
curr_Stock_Price:  92.36762776753648
curr_Factors:  [92.36762777 -0.66219175 -0.80928193]
mat_Sqrt:  [[21.20639715  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.01378695e-04  3.24484785e-03  1.37899911e-01]
Stock Position:  -0.0001013786946992175
Bond Position:  [1.50793731]


portfolio before change:  [1.49899852]
curr_Stock_Price:  90.03171235945076
curr_Factors:  [90.03171236 -0.55187887 -0.81234669]
mat_Sqrt:  [[23.01017269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00194064  0.00422864 -0.26437586]
Stock Position:  -0.001940642946817352
Bond Position:  [1.67371793]


portfolio before change:  [1.49686102]
curr_Stock_Price:  91.24096507645194
curr_Factors:  [91.24096508 -0.41647721 -0.81154097]
mat_Sqrt:  [[26.72196264  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00052687  0.02802562 -0.0341355 ]
Stock Position:  0.000526871220858535
Bond Position:  [1.44878878]


portfolio before change:  [1.49841252]
curr_Stock_Price:  93.84196332244112
curr_Factors:  [93.84196332 -0.7884076  -0.81156018]
mat_Sqrt:  [[18.94697621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00400891 -0.01283531  0.52896866]
Stock Position:  0.004008905085190325
Bond Position:  [1.122209]


portfolio before change:  [1.49402209]
curr_Stock_Price:  92.71180031558269
curr_Factors:  [92.71180032 -0.60231139 -0.80830015]
mat_Sqrt:  [[22.62112526  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00386575  0.00752141 -0.17307671]
Stock Position:  -0.003865752604958847
Bond Position:  [1.85242297]


portfolio before change:  [1.49801165]
curr_Stock_Price:  91.73967591428105
curr_Factors:  [91.73967591 -0.77284399 -0.75683817]
mat_Sqrt:  [[19.87122677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01482996 -0.06947529 -0.55624022]
Stock Position:  -0.014829958914618708
Bond Position:  [2.85850727]


portfolio before change:  [1.50407919]
curr_Stock_Price:  91.35463083692109
curr_Factors:  [91.35463084 -0.63141265 -0.75077251]
mat_Sqrt:  [[22.93269936  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00897799 0.03991747 0.90697951]
Stock Position:  0.008977987568463647
Bond Position:  [0.68389845]


portfolio before change:  [1.49641534]
curr_Stock_Price:  90.49148255490537
curr_Factors:  [90.49148255 -0.73540435 -0.75874355]
mat_Sqrt:  [[20.30988731  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00661596 -0.04793801 -0.79811373]
Stock Position:  0.0066159640689169505
Bond Position:  [0.89772695]


portfolio before change:  [1.49924492]
curr_Stock_Price:  90.9022092222161
curr_Factors:  [90.90220922 -0.5889412  -0.74874991]
mat_Sqrt:  [[23.85737017  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0047333  0.0016562  0.22729703]
Stock Position:  0.004733298982547101
Bond Position:  [1.06897759]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.48284198]
Stock Price:  87.40854206678202
PL:  [1.48284198]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-5.03968792e-02  4.62992367e-02 -7.52353031e-03]
 [-2.41898518e-01  3.95654844e-02 -2.00311348e-01]
 [-2.95506643e-02  5.44734171e-02  2.90727576e-02]
 [ 7.71868272e-02  8.78674855e-02  6.03738386e-02]
 [-1.54642129e-01  2.57511624e-01 -3.56197175e-02]
 [-3.63346709e-02 -1.28229280e-01  2.84838096e-01]
 [-6.47848691e-02 -2.17940838e-01 -8.91420380e-02]
 [-4.26528296e-02  8.88694135e-01  1.94423658e-01]
 [ 3.91493868e-03 -3.14647156e-02 -3.09209324e-02]
 [ 1.91323244e-01  6.51899563e-02  7.09355378e-02]
 [-3.87832149e-02 -1.46810973e-01  3.05762953e-02]
 [-5.55806858e-02 -1.86340921e-02  9.01224211e-02]
 [ 5.01052699e-04 -2.00965173e-02  1.22666279e-01]
 [ 9.38836992e-03 -1.13701408e-01  5.20015219e-02]
 [-9.08225500e-02  1.95415608e-01 -3.94838457e-02]
 [ 5.91806838e-02 -1.54932248e-02  6.44741394e-03]
 [ 4.00717591e-02  5.29753386e-02 -1.72512114e-02]
 [-2.86733877e-02 -5.79383114e-02 -1.63668889e-02]
 [ 1.77549204e-02  8.25672424e-02 -1.48050640e-01]
 [-2.51384311e-02 -1.91119592e-02 -2.32153891e-02]
 [-1.92915909e-02  3.40121745e-01 -2.79838218e-01]
 [ 3.28322431e-02  4.02445875e-02  7.21014623e-02]
 [ 2.20829951e-03 -3.44372527e-02  7.03861583e-02]
 [ 1.05215903e-01 -2.63273928e-02 -2.11549027e-01]
 [-5.68159219e-02  2.18922839e-02 -3.80460225e-03]
 [-1.14140511e-01 -1.50883383e-02  2.18789335e-01]
 [-4.52991590e-02 -3.36785909e-02 -9.24220335e-03]
 [-9.05024149e-02  1.10543412e-01 -9.89748184e-02]
 [-1.52018784e-03 -4.05310718e-02  6.59413093e-02]
 [ 1.09586065e-02  3.28792136e-02 -5.33102259e-02]
 [ 3.78678350e-02 -2.98891275e-02 -7.64857703e-02]
 [-3.86501397e-02  8.95793784e-03 -1.05288323e-01]
 [ 6.78406670e-02  3.40864687e-02  1.13118244e-01]
 [ 4.03921695e-02 -3.23553271e-02  1.79850773e-01]
 [-6.95091220e-02 -2.76441152e-03 -2.03368404e-02]
 [ 3.14884137e-02 -5.83704898e-02  5.68231041e-02]
 [-2.16314921e-02  1.01132024e-01  8.25853877e-02]
 [ 9.73461244e-02 -8.89062979e-02 -9.66167825e-02]
 [ 9.84558819e-02  3.37002868e-03  6.28452427e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.65883102]
curr_Stock_Price:  98.98480082884498
curr_Factors:  [98.98480083 -0.97356799 -0.97963343]
mat_Sqrt:  [[14.03795726  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302621  0.01494301 -0.02146254]
Stock Position:  -0.003026211044418418
Bond Position:  [-5.35928212]


portfolio before change:  [-5.65859181]
curr_Stock_Price:  98.68437237242826
curr_Factors:  [98.68437237 -1.1369618  -0.96898983]
mat_Sqrt:  [[12.01282673  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02286811  0.01276971 -0.57143252]
Stock Position:  -0.022868108875236288
Bond Position:  [-3.40186684]


portfolio before change:  [-5.66968296]
curr_Stock_Price:  99.1507812153863
curr_Factors:  [99.15078122 -1.21946043 -0.97353668]
mat_Sqrt:  [[11.063425    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00112957  0.01758122  0.08293649]
Stock Position:  -0.001129566367144018
Bond Position:  [-5.55768557]


portfolio before change:  [-5.67061468]
curr_Stock_Price:  99.36056745882715
curr_Factors:  [99.36056746 -0.97419508 -0.99564178]
mat_Sqrt:  [[13.85877315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00775296 0.02835911 0.17222976]
Stock Position:  0.007752956165560729
Bond Position:  [-6.44095281]


portfolio before change:  [-5.68156906]
curr_Stock_Price:  98.05149215885518
curr_Factors:  [98.05149216 -0.87908672 -0.97620319]
mat_Sqrt:  [[15.33599783  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00713019  0.08311152 -0.10161314]
Stock Position:  -0.007130193575632764
Bond Position:  [-4.98244294]


portfolio before change:  [-5.67621563]
curr_Stock_Price:  97.21332786297384
curr_Factors:  [97.21332786 -0.71053671 -0.99847292]
mat_Sqrt:  [[17.5999873   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.48126893e-04 -4.13858222e-02  8.12563804e-01]
Stock Position:  -0.000248126892736996
Bond Position:  [-5.65209439]


portfolio before change:  [-5.67687983]
curr_Stock_Price:  97.04263968809805
curr_Factors:  [97.04263969 -0.87662004 -1.02780207]
mat_Sqrt:  [[14.45049056  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00882101 -0.0703401  -0.25429742]
Stock Position:  -0.008821008409477298
Bond Position:  [-4.82086589]


portfolio before change:  [-5.67459849]
curr_Stock_Price:  96.71569435994259
curr_Factors:  [96.71569436 -0.82610759 -1.01929779]
mat_Sqrt:  [[15.27733429  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0116799  0.2868248  0.55463658]
Stock Position:  0.011679895247780252
Bond Position:  [-6.80422767]


portfolio before change:  [-5.66984603]
curr_Stock_Price:  97.19541112856538
curr_Factors:  [97.19541113 -1.01258367 -1.06775787]
mat_Sqrt:  [[12.13849688  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072657 -0.01015519 -0.08820881]
Stock Position:  -0.0007265708820933893
Bond Position:  [-5.59922667]


portfolio before change:  [-5.67055734]
curr_Stock_Price:  97.21105901973512
curr_Factors:  [97.21105902 -0.82441729 -1.09199388]
mat_Sqrt:  [[14.30305724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01531908 0.02103997 0.20235934]
Stock Position:  0.015319084652454023
Bond Position:  [-7.15974179]


portfolio before change:  [-5.67554605]
curr_Stock_Price:  96.94383126583568
curr_Factors:  [96.94383127 -0.76333444 -1.09271341]
mat_Sqrt:  [[15.15126323  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0041257  -0.04738304  0.08722566]
Stock Position:  -0.00412569686020881
Bond Position:  [-5.27558519]


portfolio before change:  [-5.68166438]
curr_Stock_Price:  98.2669619258829
curr_Factors:  [98.26696193 -0.77998263 -1.08568767]
mat_Sqrt:  [[15.21098072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00269464 -0.00601413  0.25709418]
Stock Position:  -0.0026946449071186215
Bond Position:  [-5.41686981]


portfolio before change:  [-5.68191192]
curr_Stock_Price:  98.10752953722641
curr_Factors:  [98.10752954 -0.88227113 -1.12707737]
mat_Sqrt:  [[13.15386479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00162979 -0.00648612  0.34993275]
Stock Position:  0.0016297884992855368
Bond Position:  [-5.84180644]


portfolio before change:  [-5.6836571]
curr_Stock_Price:  97.48480037514913
curr_Factors:  [97.48480038 -1.03505524 -1.11841199]
mat_Sqrt:  [[11.31613117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00028332 -0.03669697  0.14834587]
Stock Position:  -0.00028331826678905137
Bond Position:  [-5.65603788]


portfolio before change:  [-5.68406036]
curr_Stock_Price:  96.41253051116384
curr_Factors:  [96.41253051 -1.1689299  -1.10610836]
mat_Sqrt:  [[ 9.91053096  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00595257  0.06307012 -0.11263642]
Stock Position:  -0.0059525682834167875
Bond Position:  [-5.11015819]


portfolio before change:  [-5.68677452]
curr_Stock_Price:  96.76117916523205
curr_Factors:  [96.76117917 -1.16393628 -1.10445783]
mat_Sqrt:  [[10.01267464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00572616 -0.00500042  0.01839268]
Stock Position:  0.005726163827505355
Bond Position:  [-6.24084489]


portfolio before change:  [-5.68488679]
curr_Stock_Price:  97.22709048351746
curr_Factors:  [97.22709048 -1.09832518 -1.11524385]
mat_Sqrt:  [[10.62787586  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00445657  0.01709772 -0.0492129 ]
Stock Position:  0.004456574077924091
Bond Position:  [-6.11818652]


portfolio before change:  [-5.68621501]
curr_Stock_Price:  97.10067237518844
curr_Factors:  [97.10067238 -1.00310834 -1.14402177]
mat_Sqrt:  [[11.34319708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00386495 -0.01869951 -0.04669018]
Stock Position:  -0.0038649485599405544
Bond Position:  [-5.3109259]


portfolio before change:  [-5.68778135]
curr_Stock_Price:  97.33416489853157
curr_Factors:  [97.3341649  -1.20374324 -1.14264631]
mat_Sqrt:  [[ 9.31625303  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00047102  0.02664846 -0.42234727]
Stock Position:  0.0004710239035198841
Bond Position:  [-5.73362807]


portfolio before change:  [-5.6884581]
curr_Stock_Price:  97.41908123212544
curr_Factors:  [97.41908123 -1.23492744 -1.14491336]
mat_Sqrt:  [[ 9.01762773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00374583 -0.00616836 -0.06622704]
Stock Position:  -0.0037458260491109565
Bond Position:  [-5.32354317]


portfolio before change:  [-5.6895136]
curr_Stock_Price:  97.52320179737033
curr_Factors:  [97.5232018  -1.3483029  -1.13079363]
mat_Sqrt:  [[ 8.17428938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085466  0.10977382 -0.79830054]
Stock Position:  -0.0008546635951711752
Bond Position:  [-5.60616407]


portfolio before change:  [-5.69053516]
curr_Stock_Price:  97.89848220419617
curr_Factors:  [97.8984822  -1.34039946 -1.14401832]
mat_Sqrt:  [[ 8.16219613  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00683208 0.01298888 0.2056854 ]
Stock Position:  0.00683208092126199
Bond Position:  [-6.35938551]


portfolio before change:  [-5.69362606]
curr_Stock_Price:  97.56242997137218
curr_Factors:  [97.56242997 -1.35139151 -1.1557204 ]
mat_Sqrt:  [[ 7.95165891  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120055 -0.01111458  0.20079212]
Stock Position:  0.0012005468585430995
Bond Position:  [-5.81075433]


portfolio before change:  [-5.69470008]
curr_Stock_Price:  97.2728709491119
curr_Factors:  [97.27287095 -1.31690529 -1.12655915]
mat_Sqrt:  [[ 8.44906422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00670602 -0.00849713 -0.60349049]
Stock Position:  0.006706018611124806
Bond Position:  [-6.34701377]


portfolio before change:  [-5.69958473]
curr_Stock_Price:  96.66278915999149
curr_Factors:  [96.66278916 -1.38291984 -1.08820245]
mat_Sqrt:  [[ 8.16703749  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00650466  0.0070657  -0.01085347]
Stock Position:  -0.006504658433892491
Bond Position:  [-5.0708263]


portfolio before change:  [-5.69558499]
curr_Stock_Price:  95.95043243640303
curr_Factors:  [95.95043244 -1.5040218  -1.08644562]
mat_Sqrt:  [[ 7.19484146  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01008503 -0.00486974  0.62414507]
Stock Position:  -0.010085033742696535
Bond Position:  [-4.72792164]


portfolio before change:  [-5.69825385]
curr_Stock_Price:  96.15646431806323
curr_Factors:  [96.15646432 -1.38002572 -1.09685069]
mat_Sqrt:  [[ 8.0776443   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00669259 -0.01086972 -0.02636543]
Stock Position:  -0.006692586029859175
Bond Position:  [-5.05471844]


portfolio before change:  [-5.70104997]
curr_Stock_Price:  96.479842667741
curr_Factors:  [96.47984267 -1.35653588 -1.10688058]
mat_Sqrt:  [[ 8.21463761  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01072975  0.03567773 -0.28234761]
Stock Position:  -0.01072974729269938
Bond Position:  [-4.66584564]


portfolio before change:  [-5.70875696]
curr_Stock_Price:  97.14376577360125
curr_Factors:  [97.14376577 -1.26288974 -1.09553778]
mat_Sqrt:  [[ 9.18677068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00039912 -0.01308135  0.1881122 ]
Stock Position:  0.0003991234032320404
Bond Position:  [-5.74752931]


portfolio before change:  [-5.70958727]
curr_Stock_Price:  96.86359988293397
curr_Factors:  [96.86359988 -1.3436136  -1.10091303]
mat_Sqrt:  [[ 8.40458313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00080767  0.01061172 -0.15207924]
Stock Position:  0.0008076716551751558
Bond Position:  [-5.78782125]


portfolio before change:  [-5.7105533]
curr_Stock_Price:  96.56334611964886
curr_Factors:  [96.56334612 -1.59379869 -1.08450316]
mat_Sqrt:  [[ 6.63194006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00243581 -0.00964667 -0.21819261]
Stock Position:  0.0024358105989094555
Bond Position:  [-5.94576332]


portfolio before change:  [-5.71019118]
curr_Stock_Price:  97.01715107028856
curr_Factors:  [97.01715107 -1.51229135 -1.09795864]
mat_Sqrt:  [[ 7.13232874  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00817594  0.00289116 -0.30035828]
Stock Position:  -0.008175940748265505
Bond Position:  [-4.9169847]


portfolio before change:  [-5.70791994]
curr_Stock_Price:  96.66417539029717
curr_Factors:  [96.66417539 -1.43561823 -1.14144346]
mat_Sqrt:  [[ 7.34618532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01332511 0.01100136 0.32269486]
Stock Position:  0.013325106681012082
Bond Position:  [-6.99598038]


portfolio before change:  [-5.70110925]
curr_Stock_Price:  97.24092403305264
curr_Factors:  [97.24092403 -1.24563344 -1.16295718]
mat_Sqrt:  [[ 8.74604     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00806074 -0.01044264  0.5130642 ]
Stock Position:  0.008060739640108849
Bond Position:  [-6.48494302]


portfolio before change:  [-5.69656539]
curr_Stock_Price:  97.90519622262175
curr_Factors:  [97.90519622 -1.36140852 -1.1545268 ]
mat_Sqrt:  [[ 7.90949789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00938424 -0.00089221 -0.05801535]
Stock Position:  -0.009384242384351604
Bond Position:  [-4.7777993]


portfolio before change:  [-5.7019491]
curr_Stock_Price:  98.41524721835454
curr_Factors:  [98.41524722 -1.36095666 -1.14056822]
mat_Sqrt:  [[ 8.06610619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00386463 -0.01883899  0.1621005 ]
Stock Position:  0.003864634823378417
Bond Position:  [-6.08228809]


portfolio before change:  [-5.7043733]
curr_Stock_Price:  97.98471114068829
curr_Factors:  [97.98471114 -1.15277115 -1.12691783]
mat_Sqrt:  [[10.02540608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00158295 0.03264022 0.23559312]
Stock Position:  0.0015829451132929437
Bond Position:  [-5.85947772]


portfolio before change:  [-5.70511371]
curr_Stock_Price:  97.97969650605982
curr_Factors:  [97.97969651 -1.14532746 -1.11287594]
mat_Sqrt:  [[10.24261415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00580676 -0.02869438 -0.27562079]
Stock Position:  0.00580675824418835
Bond Position:  [-6.27405813]


portfolio before change:  [-5.71048344]
curr_Stock_Price:  97.19002784967651
curr_Factors:  [97.19002785 -1.11948458 -1.09851662]
mat_Sqrt:  [[10.57684212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01058653 0.00108767 0.17927998]
Stock Position:  0.01058652632967982
Bond Position:  [-6.73938822]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.71373597]
Stock Price:  96.96237440227472
PL:  [-5.71373597]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.56616748e-01 -9.73082563e-02  1.74078477e-02]
 [-1.29392506e-01  6.91298155e-02 -1.39556347e-01]
 [-4.02365567e-02  5.16796026e-02  2.00568758e-02]
 [ 8.49662792e-02  7.24496476e-02  8.00665000e-02]
 [ 8.12589083e-02 -2.94582162e-02 -8.11677147e-02]
 [-1.29607991e-01 -1.68538705e-01  7.10860017e-02]
 [-5.35708661e-02 -1.48436562e-01 -1.33187694e-02]
 [ 1.68595645e-02  6.47082736e-01  8.72240046e-02]
 [ 2.62442986e-01 -1.47470435e-02  2.70747113e-01]
 [ 4.37277506e-01  1.67783909e-01  2.78685340e-01]
 [-2.67709726e-01 -2.75016897e-01  1.34111966e-02]
 [-5.51169791e-02 -1.86180488e-02  9.01799046e-02]
 [ 1.10521531e-02 -5.91803304e-02  1.04719295e-01]
 [ 1.04934513e-03  1.33467891e-01 -8.69695274e-02]
 [ 3.07588129e-01 -1.39568081e-01 -1.68948291e-01]
 [-2.28126702e-01 -9.70269834e-02  1.22029435e-01]
 [ 5.17031354e-02  1.64897225e-02 -2.93186809e-02]
 [-6.08570625e-02 -6.30770184e-02  2.28401018e-02]
 [ 1.14352302e-01 -1.13944220e-01 -3.60762627e-02]
 [-4.27420391e-02  3.02362373e-02 -6.19717923e-02]
 [-4.05941702e-02  4.95106191e-01 -4.40202065e-01]
 [ 3.79923422e-01  2.11900286e-01  6.65879038e-02]
 [ 4.99288443e-03 -4.70107236e-02  7.80509952e-02]
 [ 6.02344099e-02  1.44114753e-01 -5.79694825e-02]
 [-1.72271627e-01  5.94421951e-02  7.93120742e-03]
 [-2.04512186e-01 -7.40009210e-02  6.38776949e-02]
 [-1.03784586e-01 -3.62024698e-02 -3.17398897e-02]
 [-7.70977887e-02  1.16463746e-01 -3.90660066e-02]
 [ 1.29178347e-01 -3.11595128e-02  1.72701015e-01]
 [ 4.64847426e-02  5.31677642e-02 -9.33893680e-02]
 [ 2.87827399e-02 -2.15849415e-02 -5.27311936e-02]
 [-4.61218160e-03  1.08000971e-01 -1.17924634e-01]
 [-3.75818997e-03  3.41712456e-02  6.84121406e-03]
 [ 4.17970251e-02 -3.14755689e-02  1.79057555e-01]
 [-7.39598148e-02 -7.88168320e-03 -2.91933890e-02]
 [-6.45236024e-02 -1.16462087e-01 -5.58214058e-02]
 [ 3.69056360e-02  1.03765199e-01  1.56556719e-01]
 [ 1.64538620e-01 -1.17295421e-01 -1.52778324e-01]
 [ 5.73690050e-02 -8.36400704e-03  3.52981632e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.22558028]
curr_Stock_Price:  100.35702517544556
curr_Factors:  [100.35702518  -0.98823093  -0.98626037]
mat_Sqrt:  [[13.93275835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01241149 -0.0314061   0.04965974]
Stock Position:  -0.01241149430094922
Bond Position:  [6.47116093]


portfolio before change:  [5.22541866]
curr_Stock_Price:  100.43522450315889
curr_Factors:  [100.4352245   -0.99771041  -1.00272121]
mat_Sqrt:  [[13.5865641   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01058165  0.02231155 -0.39811541]
Stock Position:  -0.010581649655092036
Bond Position:  [6.28818902]


portfolio before change:  [5.23718072]
curr_Stock_Price:  99.39795792957982
curr_Factors:  [99.39795793 -1.02720454 -0.9890278 ]
mat_Sqrt:  [[13.23545518  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019337   0.01667952  0.05721668]
Stock Position:  -0.0019337007282795387
Bond Position:  [5.42938663]


portfolio before change:  [5.23711419]
curr_Stock_Price:  99.78335808876545
curr_Factors:  [99.78335809 -0.78015248 -1.01370111]
mat_Sqrt:  [[16.5957698   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00699567 0.02338302 0.22840744]
Stock Position:  0.006995668706801654
Bond Position:  [4.53906288]


portfolio before change:  [5.24266836]
curr_Stock_Price:  100.49619227749083
curr_Factors:  [100.49619228  -0.82727156  -1.01054598]
mat_Sqrt:  [[15.99541798  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00366839 -0.0095076  -0.2315489 ]
Stock Position:  0.0036683933359969497
Bond Position:  [4.8740088]


portfolio before change:  [5.24399035]
curr_Stock_Price:  100.69047447406263
curr_Factors:  [100.69047447  -1.12514158  -1.02093661]
mat_Sqrt:  [[11.7749338   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0126965  -0.05439563  0.20278858]
Stock Position:  -0.012696499494942299
Bond Position:  [6.52240691]


portfolio before change:  [5.24356209]
curr_Stock_Price:  100.78842400266721
curr_Factors:  [100.788424    -1.04390918  -1.00876698]
mat_Sqrt:  [[12.94031138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00669142 -0.04790769 -0.03799474]
Stock Position:  -0.00669141818838486
Bond Position:  [5.91797958]


portfolio before change:  [5.24662729]
curr_Stock_Price:  100.44090384854469
curr_Factors:  [100.44090385  -1.14043571  -1.00048209]
mat_Sqrt:  [[11.80651785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0141235  0.20884506 0.24882581]
Stock Position:  0.01412349538384514
Bond Position:  [3.82805064]


portfolio before change:  [5.2481881]
curr_Stock_Price:  100.51753326086865
curr_Factors:  [100.51753326  -0.8873261   -0.97796467]
mat_Sqrt:  [[15.56525844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02021802 -0.00475959  0.77236615]
Stock Position:  0.02021802482178824
Bond Position:  [3.21592212]


portfolio before change:  [5.23672904]
curr_Stock_Price:  99.93087500717738
curr_Factors:  [99.93087501 -0.71397801 -0.93800612]
mat_Sqrt:  [[19.15367435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02758806 0.05415202 0.7950117 ]
Stock Position:  0.027588056987553556
Bond Position:  [2.47983037]


portfolio before change:  [5.22583257]
curr_Stock_Price:  99.52466783696585
curr_Factors:  [99.52466784 -0.73996831 -0.91852735]
mat_Sqrt:  [[18.95200771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01694331 -0.08876132  0.03825841]
Stock Position:  -0.016943311293124846
Bond Position:  [6.91211]


portfolio before change:  [5.20593412]
curr_Stock_Price:  100.75007894057754
curr_Factors:  [100.75007894  -0.70844972  -0.94230164]
mat_Sqrt:  [[19.33451077  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209519 -0.00600895  0.25725817]
Stock Position:  -0.002095190145235935
Bond Position:  [5.41702469]


portfolio before change:  [5.20557569]
curr_Stock_Price:  101.24435283635721
curr_Factors:  [101.24435284  -0.83034744  -0.96583192]
mat_Sqrt:  [[16.79964185  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012112  -0.01910037  0.298735  ]
Stock Position:  0.0012112017383358966
Bond Position:  [5.08294836]


portfolio before change:  [5.20758998]
curr_Stock_Price:  102.38278855163591
curr_Factors:  [102.38278855  -0.98385594  -0.975561  ]
mat_Sqrt:  [[14.42988899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00073048  0.04307658 -0.24809985]
Stock Position:  0.0007304826675101449
Bond Position:  [5.13280112]


portfolio before change:  [5.2082892]
curr_Stock_Price:  102.46161297689875
curr_Factors:  [102.46161298  -0.7274159   -0.99953963]
mat_Sqrt:  [[18.22023316  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01342532 -0.0450454  -0.48196245]
Stock Position:  0.013425321497849411
Bond Position:  [3.8327091]


portfolio before change:  [5.20494608]
curr_Stock_Price:  102.17690968872388
curr_Factors:  [102.17690969  -0.52134104  -0.99903891]
mat_Sqrt:  [[22.3388154   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00998366 -0.03131532  0.34811601]
Stock Position:  -0.009983658222740216
Bond Position:  [6.22504543]


portfolio before change:  [5.19606625]
curr_Stock_Price:  103.14429166780826
curr_Factors:  [103.14429167  -0.3379368   -1.00260011]
mat_Sqrt:  [[26.99338899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00181839  0.00532204 -0.08363804]
Stock Position:  0.0018183872794566695
Bond Position:  [5.00850998]


portfolio before change:  [5.19579904]
curr_Stock_Price:  102.65302520342674
curr_Factors:  [102.6530252   -0.2856136   -1.00059452]
mat_Sqrt:  [[28.36473063  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243508 -0.02035802  0.06515645]
Stock Position:  -0.002435080015681917
Bond Position:  [5.44576737]


portfolio before change:  [5.19585266]
curr_Stock_Price:  102.91057033563722
curr_Factors:  [102.91057034  -0.15370305  -0.99372892]
mat_Sqrt:  [[32.66905799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00256296 -0.03677534 -0.10291554]
Stock Position:  0.0025629603211682027
Bond Position:  [4.93209695]


portfolio before change:  [5.18555376]
curr_Stock_Price:  98.65164862671196
curr_Factors:  [98.65164863 -0.26332281 -0.98507419]
mat_Sqrt:  [[28.30951419  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00173864  0.0097587  -0.17678827]
Stock Position:  -0.0017386392387628148
Bond Position:  [5.35707339]


portfolio before change:  [5.19020176]
curr_Stock_Price:  96.36346582394162
curr_Factors:  [96.36346582 -0.39004423 -0.99497818]
mat_Sqrt:  [[24.12152832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.21828568e-03  1.59794836e-01 -1.25577396e+00]
Stock Position:  -0.0012182856779248835
Bond Position:  [5.30759999]


portfolio before change:  [5.19166357]
curr_Stock_Price:  95.70818948548296
curr_Factors:  [95.70818949 -0.44670688 -0.96546811]
mat_Sqrt:  [[23.31574507  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01873282 0.06839052 0.18995676]
Stock Position:  0.018732817004082494
Bond Position:  [3.39877957]


portfolio before change:  [5.21098933]
curr_Stock_Price:  96.71716152876377
curr_Factors:  [96.71716153 -0.33122151 -0.98662768]
mat_Sqrt:  [[25.8921975   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00043754 -0.01517265  0.22265776]
Stock Position:  0.0004375431373625422
Bond Position:  [5.1686714]


portfolio before change:  [5.21110008]
curr_Stock_Price:  95.493554939759
curr_Factors:  [95.49355494 -0.43178644 -1.01783657]
mat_Sqrt:  [[22.40839692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00347275  0.04651284 -0.1653708 ]
Stock Position:  0.003472749073471898
Bond Position:  [4.87947492]


portfolio before change:  [5.20746814]
curr_Stock_Price:  94.27207109797561
curr_Factors:  [94.2720711  -0.48706874 -0.99239253]
mat_Sqrt:  [[21.47144054  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00738279  0.01918489  0.02262553]
Stock Position:  -0.007382787779593897
Bond Position:  [5.90345884]


portfolio before change:  [5.22400123]
curr_Stock_Price:  92.13262023952959
curr_Factors:  [92.13262024 -0.31952966 -0.98267487]
mat_Sqrt:  [[25.05377547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00824541 -0.02388369  0.18222528]
Stock Position:  -0.00824540721100673
Bond Position:  [5.9836722]


portfolio before change:  [5.23320953]
curr_Stock_Price:  91.1065591915582
curr_Factors:  [91.10655919 -0.26956307 -0.95955757]
mat_Sqrt:  [[26.65319866  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00441423 -0.0116843  -0.09054507]
Stock Position:  -0.004414226717251691
Bond Position:  [5.63537454]


portfolio before change:  [5.22011404]
curr_Stock_Price:  94.23280422757044
curr_Factors:  [94.23280423 -0.4612916  -0.98686143]
mat_Sqrt:  [[22.14507953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00276807  0.03758851 -0.11144444]
Stock Position:  -0.002768065980581171
Bond Position:  [5.48095666]


portfolio before change:  [5.21836741]
curr_Stock_Price:  95.11132237614437
curr_Factors:  [95.11132238 -0.5508681  -0.99060915]
mat_Sqrt:  [[20.35997092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00776378 -0.01005669  0.49266792]
Stock Position:  0.007763782456813875
Bond Position:  [4.47994379]


portfolio before change:  [5.21918896]
curr_Stock_Price:  95.145007461569
curr_Factors:  [95.14500746 -0.65262699 -1.0019234 ]
mat_Sqrt:  [[18.1896315   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0021042   0.01715982 -0.26641387]
Stock Position:  0.0021041955749252004
Bond Position:  [5.01898525]


portfolio before change:  [5.22102651]
curr_Stock_Price:  95.72011394819134
curr_Factors:  [95.72011395 -0.83803936 -0.98646464]
mat_Sqrt:  [[15.43942725  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00088171 -0.00696651 -0.15042742]
Stock Position:  0.0008817051398254459
Bond Position:  [5.13662959]


portfolio before change:  [5.2226661]
curr_Stock_Price:  96.85141426111842
curr_Factors:  [96.85141426 -0.73093934 -0.99263382]
mat_Sqrt:  [[17.28095158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00038411  0.03485716 -0.33640616]
Stock Position:  -0.0003841131590975177
Bond Position:  [5.259868]


portfolio before change:  [5.22317814]
curr_Stock_Price:  97.23015451423471
curr_Factors:  [97.23015451 -1.0435995  -1.02849549]
mat_Sqrt:  [[12.24338646  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00037681 0.01102872 0.01951608]
Stock Position:  0.00037681105010138724
Bond Position:  [5.18654075]


portfolio before change:  [5.22368598]
curr_Stock_Price:  96.85722064973415
curr_Factors:  [96.85722065 -1.02205769 -1.01270108]
mat_Sqrt:  [[12.6604021   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00568087 -0.0101587   0.51080136]
Stock Position:  0.005680867893004738
Bond Position:  [4.6734529]


portfolio before change:  [5.22004247]
curr_Stock_Price:  96.11301739568438
curr_Factors:  [96.1130174  -1.04130642 -1.00575077]
mat_Sqrt:  [[12.40956539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00656975 -0.0025438  -0.08328061]
Stock Position:  -0.006569749195073499
Bond Position:  [5.85148089]


portfolio before change:  [5.2156178]
curr_Stock_Price:  96.89784989411571
curr_Factors:  [96.89784989 -1.28865055 -1.01048257]
mat_Sqrt:  [[ 9.7232917   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01025279 -0.03758798 -0.15924293]
Stock Position:  -0.010252785391508833
Bond Position:  [6.20909066]


portfolio before change:  [5.21813859]
curr_Stock_Price:  96.7276913998368
curr_Factors:  [96.7276914  -1.34033922 -1.01924333]
mat_Sqrt:  [[ 9.1368636   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00985498 0.03349007 0.44661274]
Stock Position:  0.009854981861718553
Bond Position:  [4.26488894]


portfolio before change:  [5.21765927]
curr_Stock_Price:  96.62495549141423
curr_Factors:  [96.62495549 -1.63668942 -0.98058894]
mat_Sqrt:  [[ 7.05374502  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01551092 -0.03785693 -0.43583403]
Stock Position:  0.015510916133180652
Bond Position:  [3.71891769]


portfolio before change:  [5.21991545]
curr_Stock_Price:  96.74044103260572
curr_Factors:  [96.74044103 -1.64478693 -0.97949012]
mat_Sqrt:  [[ 7.01292224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00896444 -0.00269947  0.10069583]
Stock Position:  0.008964439425358958
Bond Position:  [4.35269163]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.21502607]
Stock Price:  96.13432387151136
PL:  [5.21502607]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.36024505e-01 -1.07382688e-01  2.05080589e-02]
 [-1.07628987e-01  7.31126130e-02 -1.02467375e-01]
 [ 5.74300670e-03  4.96353299e-03  5.05479161e-02]
 [ 1.35651512e-01  3.12033289e-02  1.58055660e-01]
 [ 3.95945031e-02  3.76797017e-02 -7.11556292e-02]
 [-1.29907880e-01 -1.64297892e-01  9.50608951e-02]
 [-5.29820223e-02 -1.41634078e-01 -2.67525763e-02]
 [-6.95074413e-03  6.86021693e-01  1.22656140e-01]
 [ 5.07556449e-01  8.79935566e-02  4.86114907e-01]
 [ 6.32171942e-01  2.74689044e-01  5.25954916e-01]
 [-2.87850861e-01 -2.85560151e-01  1.12421525e-02]
 [-2.45449435e-02 -1.75603175e-02  9.39697736e-02]
 [ 1.17315700e-02 -5.85390651e-02  9.66452543e-02]
 [ 1.18990892e-02 -1.30584561e-01 -4.72610270e-02]
 [ 1.00126376e-01 -1.36841879e-01 -1.00181336e-01]
 [-1.18652411e-01 -6.59154897e-02  9.67468502e-02]
 [ 4.68339258e-02  2.52287467e-02 -8.39815678e-04]
 [-5.62219699e-02 -6.03727642e-02  2.92102564e-02]
 [ 8.06737158e-02 -4.82100941e-02 -8.46035495e-02]
 [ 4.50323759e-02 -1.30429938e-02  1.38491519e-01]
 [-2.17812474e-02  3.90124665e-01 -3.71153854e-01]
 [ 2.86787850e-01  1.72667658e-01  7.56765484e-02]
 [ 2.17817375e-02  1.53839447e-01 -4.24406431e-02]
 [ 9.35884328e-02 -1.83937695e-01 -2.80173879e-01]
 [ 5.04334831e-02  1.01207998e-02 -1.33573867e-02]
 [-2.56560412e-02  1.23994243e-02  6.16952550e-02]
 [ 7.64873021e-02 -3.07924608e-02  2.77558659e-02]
 [ 1.56598093e-01 -6.22355286e-02  1.49400280e-01]
 [-4.55448185e-02 -1.65328637e-02 -2.92762317e-02]
 [-6.20594694e-02 -1.39195117e-02  3.91388148e-02]
 [-2.61185861e-02 -4.21214957e-02 -8.96589586e-03]
 [ 2.62077963e-02 -3.31476917e-02 -8.39324844e-02]
 [ 8.64003351e-03  4.09709946e-03  1.58755821e-01]
 [ 6.10028682e-03 -7.97073915e-02 -7.85130400e-02]
 [ 5.03860917e-03  3.29114411e-02  1.39558962e-02]
 [ 4.93217529e-02  3.27037953e-02  1.49207567e-01]
 [ 2.56971483e-01 -1.69958266e-01  1.10716784e-01]
 [-4.64395482e-02  2.52154922e-03  2.15152909e-02]
 [ 1.04629295e-01  6.32039649e-03  1.18306835e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.96078517]
curr_Stock_Price:  100.57578669746607
curr_Factors:  [100.5757867   -0.89819572  -0.98113649]
mat_Sqrt:  [[15.35712191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01652378 -0.03465761  0.05850378]
Stock Position:  -0.016523780681090193
Bond Position:  [8.62267741]


portfolio before change:  [6.96830043]
curr_Stock_Price:  100.18620502484356
curr_Factors:  [100.18620502  -0.66880819  -0.9695823 ]
mat_Sqrt:  [[19.46542893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00583707  0.02359699 -0.2923109 ]
Stock Position:  -0.0058370664778212575
Bond Position:  [7.55309397]


portfolio before change:  [6.96712]
curr_Stock_Price:  100.55019342096033
curr_Factors:  [100.55019342  -0.70877086  -0.94867418]
mat_Sqrt:  [[19.16742074  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00089079 0.00160197 0.14419913]
Stock Position:  0.0008907945427489458
Bond Position:  [6.87755044]


portfolio before change:  [6.96773655]
curr_Stock_Price:  100.27717603787933
curr_Factors:  [100.27717604  -0.63192201  -0.95158402]
mat_Sqrt:  [[20.5823123   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00846765 0.01007083 0.4508888 ]
Stock Position:  0.008467651194178204
Bond Position:  [6.1186244]


portfolio before change:  [6.96741731]
curr_Stock_Price:  100.14914651296982
curr_Factors:  [100.14914651  -0.58508375  -0.9597458 ]
mat_Sqrt:  [[21.36664336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00153329  0.01216107 -0.2029872 ]
Stock Position:  0.001533289880476165
Bond Position:  [6.81385964]


portfolio before change:  [6.96854436]
curr_Stock_Price:  100.32867010977378
curr_Factors:  [100.32867011  -0.67593118  -0.96110973]
mat_Sqrt:  [[19.51943395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00737935 -0.05302692  0.27118227]
Stock Position:  -0.007379354523189094
Bond Position:  [7.70890519]


portfolio before change:  [6.96258953]
curr_Stock_Price:  101.26621900974668
curr_Factors:  [101.26621901  -0.46016732  -0.93045451]
mat_Sqrt:  [[25.20723475  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00346543 -0.0457122  -0.07631765]
Stock Position:  -0.0034654259024593727
Bond Position:  [7.31352011]


portfolio before change:  [6.96365457]
curr_Stock_Price:  101.22270414476918
curr_Factors:  [101.22270414  -0.41853688  -0.89801535]
mat_Sqrt:  [[27.13354673  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00582747 0.22141255 0.34990383]
Stock Position:  0.005827469921179217
Bond Position:  [6.37378231]


portfolio before change:  [6.97628643]
curr_Stock_Price:  103.25361800863413
curr_Factors:  [103.25361801  -0.67427828  -0.93288794]
mat_Sqrt:  [[20.69768896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03018433 0.0283998  1.38675052]
Stock Position:  0.030184328783698748
Bond Position:  [3.85964528]


portfolio before change:  [6.94717671]
curr_Stock_Price:  102.27323473496139
curr_Factors:  [102.27323473  -0.79489901  -0.92369068]
mat_Sqrt:  [[18.33952046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04338187 0.08865551 1.50040298]
Stock Position:  0.043381870744261045
Bond Position:  [2.51037246]


portfolio before change:  [6.89688352]
curr_Stock_Price:  101.10668735560108
curr_Factors:  [101.10668736  -0.70398048  -0.8980674 ]
mat_Sqrt:  [[20.37132736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01687891 -0.09216414  0.03207073]
Stock Position:  -0.0168789093645173
Bond Position:  [8.60345413]


portfolio before change:  [6.90004855]
curr_Stock_Price:  100.98289196957792
curr_Factors:  [100.98289197  -0.96469379  -0.90727522]
mat_Sqrt:  [[15.53323778  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057605 -0.00566757  0.26806961]
Stock Position:  -0.0005760504470517237
Bond Position:  [6.95821979]


portfolio before change:  [6.9009834]
curr_Stock_Price:  100.87002703165186
curr_Factors:  [100.87002703  -0.99671075  -0.91175866]
mat_Sqrt:  [[14.95975244  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00130416 -0.0188934   0.27570201]
Stock Position:  0.0013041635108797984
Bond Position:  [6.76943239]


portfolio before change:  [6.90056072]
curr_Stock_Price:  99.89705692486008
curr_Factors:  [99.89705692 -0.85844016 -0.8982156 ]
mat_Sqrt:  [[17.24434845  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00141516 -0.04214599 -0.13482255]
Stock Position:  -0.0014151586805900731
Bond Position:  [7.0419309]


portfolio before change:  [6.89990822]
curr_Stock_Price:  100.98017783099128
curr_Factors:  [100.98017783  -0.9820039   -0.87589542]
mat_Sqrt:  [[15.75290701  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00328474 -0.04416553 -0.28578947]
Stock Position:  0.003284740723120105
Bond Position:  [6.56821452]


portfolio before change:  [6.90349211]
curr_Stock_Price:  101.82128162475358
curr_Factors:  [101.82128162  -1.21254998  -0.92951784]
mat_Sqrt:  [[11.95502041  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00939848 -0.02127413  0.27599183]
Stock Position:  -0.009398477113493044
Bond Position:  [7.86045709]


portfolio before change:  [6.91416953]
curr_Stock_Price:  100.78975241922701
curr_Factors:  [100.78975242  -1.23868728  -0.90741477]
mat_Sqrt:  [[11.78626229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00439599  0.00814254 -0.00239576]
Stock Position:  0.004395990367786935
Bond Position:  [6.47109875]


portfolio before change:  [6.91308034]
curr_Stock_Price:  100.35796530879398
curr_Factors:  [100.35796531  -1.01723952  -0.89027879]
mat_Sqrt:  [[14.89797261  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00420077 -0.01948523  0.08332873]
Stock Position:  -0.004200772267126121
Bond Position:  [7.3346613]


portfolio before change:  [6.91091116]
curr_Stock_Price:  101.09260838828588
curr_Factors:  [101.09260839  -1.21193027  -0.9021289 ]
mat_Sqrt:  [[12.20661286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00438805 -0.01555974 -0.24135038]
Stock Position:  0.00438805137233133
Bond Position:  [6.4673116]


portfolio before change:  [6.91565341]
curr_Stock_Price:  101.98908414867265
curr_Factors:  [101.98908415  -1.43993297  -0.91974436]
mat_Sqrt:  [[ 9.63293987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00733311 -0.00420961  0.39507776]
Stock Position:  0.007333114272639435
Bond Position:  [6.1677558]


portfolio before change:  [6.92181121]
curr_Stock_Price:  102.72366760003203
curr_Factors:  [102.7236676   -1.39443191  -0.92265223]
mat_Sqrt:  [[10.12450175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176886  0.12591219 -1.05879864]
Stock Position:  -0.0017688620584677718
Bond Position:  [7.10351521]


portfolio before change:  [6.92208076]
curr_Stock_Price:  103.07329538079586
curr_Factors:  [103.07329538  -1.29503534  -0.93488678]
mat_Sqrt:  [[11.0841728   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0304471  0.05572825 0.21588413]
Stock Position:  0.03044709825790046
Bond Position:  [3.78379801]


portfolio before change:  [6.93999285]
curr_Stock_Price:  103.64606215874706
curr_Factors:  [103.64606216  -1.34811584  -0.95081325]
mat_Sqrt:  [[10.4025686   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0042798   0.04965147 -0.12107134]
Stock Position:  0.004279800963150834
Bond Position:  [6.49640833]


portfolio before change:  [6.94148054]
curr_Stock_Price:  103.80391700543721
curr_Factors:  [103.80391701  -1.45332651  -0.95500976]
mat_Sqrt:  [[ 9.3387036   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.22923432e-04 -5.93656358e-02 -7.99258091e-01]
Stock Position:  -0.0001229234318572204
Bond Position:  [6.95424047]


portfolio before change:  [6.94238544]
curr_Stock_Price:  103.51455062339441
curr_Factors:  [103.51455062  -1.4230849   -0.93849899]
mat_Sqrt:  [[ 9.75839847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00510051  0.00326647 -0.03810491]
Stock Position:  0.0051005108837949694
Bond Position:  [6.41440835]


portfolio before change:  [6.94088399]
curr_Stock_Price:  103.0629671604862
curr_Factors:  [103.06296716  -1.23250313  -0.91223115]
mat_Sqrt:  [[12.06858569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00087264  0.0040019   0.17599939]
Stock Position:  -0.0008726397961465387
Bond Position:  [7.03082083]


portfolio before change:  [6.94186667]
curr_Stock_Price:  102.94405048359238
curr_Factors:  [102.94405048  -1.07835846  -0.89312142]
mat_Sqrt:  [[14.33502377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00529245 -0.00993822  0.07917976]
Stock Position:  0.005292454404393459
Bond Position:  [6.39703997]


portfolio before change:  [6.9459831]
curr_Stock_Price:  103.57074582620528
curr_Factors:  [103.57074583  -1.07423044  -0.89268394]
mat_Sqrt:  [[14.48828707  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01203666 -0.02008643  0.42619741]
Stock Position:  0.012036655721815599
Bond Position:  [5.69933769]


portfolio before change:  [6.94329288]
curr_Stock_Price:  103.28805238717639
curr_Factors:  [103.28805239  -1.09209253  -0.88546746]
mat_Sqrt:  [[14.29574185  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00383999 -0.00533596 -0.08351694]
Stock Position:  -0.0038399938604826065
Bond Position:  [7.33991837]


portfolio before change:  [6.94267599]
curr_Stock_Price:  103.68764542525601
curr_Factors:  [103.68764543  -1.24323766  -0.88661727]
mat_Sqrt:  [[12.32374686  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00461804 -0.0044925   0.11165214]
Stock Position:  -0.004618043628771239
Bond Position:  [7.42151006]


portfolio before change:  [6.94274275]
curr_Stock_Price:  103.87408519437359
curr_Factors:  [103.87408519  -1.28934038  -0.89795696]
mat_Sqrt:  [[11.65671139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00313525 -0.01359465 -0.02557721]
Stock Position:  -0.0031352544475942083
Bond Position:  [7.26841444]


portfolio before change:  [6.94442635]
curr_Stock_Price:  103.62690071295232
curr_Factors:  [103.62690071  -1.28240868  -0.87418864]
mat_Sqrt:  [[11.99151882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.92544869e-04 -1.06983715e-02 -2.39436016e-01]
Stock Position:  0.00019254486870988043
Bond Position:  [6.92447352]


portfolio before change:  [6.94530434]
curr_Stock_Price:  103.69117242229954
curr_Factors:  [103.69117242  -1.07905728  -0.87452017]
mat_Sqrt:  [[14.69988295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00284916 0.00132233 0.45288617]
Stock Position:  0.002849155115552771
Bond Position:  [6.6498721]


portfolio before change:  [6.94521837]
curr_Stock_Price:  103.36923359056884
curr_Factors:  [103.36923359  -1.28649741  -0.85423932]
mat_Sqrt:  [[12.15293418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215556 -0.02572545 -0.22397585]
Stock Position:  -0.002155555452002562
Bond Position:  [7.16803648]


portfolio before change:  [6.94611533]
curr_Stock_Price:  103.36881626097919
curr_Factors:  [103.36881626  -1.33430091  -0.83042303]
mat_Sqrt:  [[11.86483982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00123098 0.01062212 0.03981229]
Stock Position:  0.0012309786371560401
Bond Position:  [6.81887052]


portfolio before change:  [6.94710545]
curr_Stock_Price:  103.48068878325259
curr_Factors:  [103.48068878  -1.50909975  -0.79645398]
mat_Sqrt:  [[10.31739468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00837947 0.0105551  0.42564766]
Stock Position:  0.00837946563693593
Bond Position:  [6.07999258]


portfolio before change:  [6.9458191]
curr_Stock_Price:  103.23647238265517
curr_Factors:  [103.23647238  -1.67758275  -0.74805213]
mat_Sqrt:  [[ 9.12837165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02682613 -0.05485379  0.31584417]
Stock Position:  0.026826127987351386
Bond Position:  [4.17638428]


portfolio before change:  [6.94490002]
curr_Stock_Price:  103.18275002630844
curr_Factors:  [103.18275003  -1.71746774  -0.73415314]
mat_Sqrt:  [[ 8.88958889  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0046721   0.00081383  0.06137714]
Stock Position:  -0.004672100050811295
Bond Position:  [7.42698015]


portfolio before change:  [6.94455072]
curr_Stock_Price:  103.45623048224778
curr_Factors:  [103.45623048  -1.40555896  -0.71905045]
mat_Sqrt:  [[12.36091179  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01052258 0.0020399  0.33749647]
Stock Position:  0.010522583140289435
Bond Position:  [5.85592393]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.9457508]
Stock Price:  103.50071084062921
PL:  [3.44503996]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.87813077e-01 -4.64043298e-02  2.78236673e-03]
 [-3.10092076e-01  4.14974902e-02 -5.30954860e-01]
 [-1.99244093e-03  6.26509255e-02  4.62939829e-02]
 [ 1.20582795e-01  6.41930441e-02  1.19164062e-01]
 [-1.18316474e-01  2.31352062e-01 -3.82082630e-02]
 [-6.17225931e-02 -1.45131452e-01  1.93481333e-01]
 [-6.51904929e-02 -1.59243899e-01 -2.70460055e-02]
 [-3.99555703e-02  8.26150848e-01  1.83814814e-01]
 [ 2.02442870e-01 -4.34806837e-02  1.84262069e-01]
 [ 3.61570814e-01  1.36204669e-01  2.14738287e-01]
 [-2.06200742e-01 -2.33684582e-01  2.24911054e-02]
 [-1.09028851e-01 -2.04832918e-02  8.34967079e-02]
 [-1.23646033e-02  5.54834083e-02  5.06567880e-02]
 [ 4.79520519e-03 -1.88294549e-02  6.53342973e-02]
 [-8.97846970e-02  1.95513015e-01 -3.95353537e-02]
 [-5.10578752e-02 -4.29773434e-02  9.95692763e-03]
 [ 6.38353189e-02  6.93966409e-02 -2.13484859e-01]
 [-2.09959573e-02 -5.63197726e-02 -2.33172275e-02]
 [ 9.02510637e-02  2.85347174e-02 -3.33882666e-01]
 [-1.32179843e-02  6.74007898e-03 -2.98395777e-02]
 [-8.62026705e-02  8.60182222e-01 -8.48124445e-01]
 [ 9.27601281e-01  4.79294724e-01 -2.86754030e-02]
 [ 8.02483924e-03 -5.76640759e-02  8.70565877e-02]
 [-5.69537260e-02 -5.55717576e-02 -2.10306828e-02]
 [-2.30500010e-02  2.01777289e-02 -6.37874542e-03]
 [-6.62073814e-02 -8.76605919e-03  1.87113312e-01]
 [-1.40063822e-02 -3.23281830e-02  2.79524111e-03]
 [-6.67023840e-02  5.70715911e-02 -2.04281489e-01]
 [-2.59869774e-02 -4.10598644e-02  4.56072535e-02]
 [-2.87396611e-02  2.47957651e-02 -2.19791567e-02]
 [-1.61467004e-02 -3.04032958e-02  1.16470772e-02]
 [ 3.96604989e-02  6.48319599e-02 -5.61755430e-02]
 [-3.45422830e-02  3.50256659e-02 -1.05922300e-01]
 [ 4.71351473e-02 -4.09098470e-02  1.86283302e-01]
 [-6.99670151e-02  2.00181932e-02 -2.97369722e-02]
 [-1.55034645e-01 -1.67430431e-01 -1.39794628e-01]
 [ 1.04355457e-01  9.98305555e-02  2.32914192e-01]
 [ 1.89272650e-01 -1.30308793e-01 -2.06271399e-01]
 [ 9.82467931e-02  3.49956447e-03  6.40830068e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.48351222]
curr_Stock_Price:  99.38512103409354
curr_Factors:  [99.38512103 -1.23909707 -1.00397062]
mat_Sqrt:  [[10.54798377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01696142 -0.01497693  0.00793732]
Stock Position:  0.016961419780410148
Bond Position:  [-4.16922498]


portfolio before change:  [-2.48728705]
curr_Stock_Price:  99.19329486898182
curr_Factors:  [99.19329487 -1.39222186 -0.98653926]
mat_Sqrt:  [[ 9.19177719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04460532  0.01339326 -1.51466643]
Stock Position:  -0.044605317849284565
Bond Position:  [1.9372614]


portfolio before change:  [-2.45066642]
curr_Stock_Price:  98.37773171704669
curr_Factors:  [98.37773172 -1.32796893 -0.99888935]
mat_Sqrt:  [[ 9.60185391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00210854 0.0202205  0.13206385]
Stock Position:  0.0021085350373001035
Bond Position:  [-2.65809932]


portfolio before change:  [-2.45201598]
curr_Stock_Price:  97.89527774598393
curr_Factors:  [97.89527775 -1.19957004 -0.99001323]
mat_Sqrt:  [[10.96068783  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0144161  0.02071822 0.3399419 ]
Stock Position:  0.014416103280713388
Bond Position:  [-3.86328441]


portfolio before change:  [-2.44442445]
curr_Stock_Price:  98.45537814779195
curr_Factors:  [98.45537815 -0.84418625 -0.98905166]
mat_Sqrt:  [[15.74252304  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00501134  0.07466856 -0.10899754]
Stock Position:  -0.005011341641056677
Bond Position:  [-1.95103092]


portfolio before change:  [-2.44568198]
curr_Stock_Price:  98.6576465564368
curr_Factors:  [98.65764656 -0.63068312 -0.98327331]
mat_Sqrt:  [[19.64257314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263984 -0.04684097  0.55194839]
Stock Position:  -0.0026398382055806526
Bond Position:  [-2.18524176]


portfolio before change:  [-2.44312894]
curr_Stock_Price:  97.58704393401271
curr_Factors:  [97.58704393 -0.62148034 -0.98043294]
mat_Sqrt:  [[19.66482412  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0052488  -0.05139575 -0.07715473]
Stock Position:  -0.0052488016061018935
Bond Position:  [-1.9309139]


portfolio before change:  [-2.44640646]
curr_Stock_Price:  98.16548985334852
curr_Factors:  [98.16548985 -0.59047934 -0.97766402]
mat_Sqrt:  [[20.46081039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00812298 0.26663904 0.5243725 ]
Stock Position:  0.00812298261637022
Bond Position:  [-3.24380303]


portfolio before change:  [-2.44314258]
curr_Stock_Price:  98.6172182850007
curr_Factors:  [98.61721829 -0.55431127 -0.99630192]
mat_Sqrt:  [[20.91847389  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01105146 -0.01403333  0.5256484 ]
Stock Position:  0.011051463456909522
Bond Position:  [-3.53300717]


portfolio before change:  [-2.44626417]
curr_Stock_Price:  98.3747223733474
curr_Factors:  [98.37472237 -0.42682385 -0.98276448]
mat_Sqrt:  [[24.02741684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01802968 0.04395987 0.61258856]
Stock Position:  0.018029684517914094
Bond Position:  [-4.21992938]


portfolio before change:  [-2.47383406]
curr_Stock_Price:  96.87484236734703
curr_Factors:  [96.87484237 -0.24576708 -0.99243471]
mat_Sqrt:  [[28.08450705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00887715 -0.07542137  0.06416086]
Stock Position:  -0.00887715171189909
Bond Position:  [-1.61386139]


portfolio before change:  [-2.47346672]
curr_Stock_Price:  96.81073550861852
curr_Factors:  [ 9.68107355e+01  5.32833552e-02 -9.91002967e-01]
mat_Sqrt:  [[37.90330381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253715 -0.00661095  0.23819287]
Stock Position:  -0.0025371480087579583
Bond Position:  [-2.22784355]


portfolio before change:  [-2.47564029]
curr_Stock_Price:  97.55766488984119
curr_Factors:  [ 9.75576649e+01  2.38602997e-02 -1.00588806e+00]
mat_Sqrt:  [[36.54030418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00025455 0.01790719 0.14450972]
Stock Position:  0.00025454559648293977
Bond Position:  [-2.50047316]


portfolio before change:  [-2.4762666]
curr_Stock_Price:  96.32513657387777
curr_Factors:  [96.32513657  0.09814111 -0.99676646]
mat_Sqrt:  [[39.21675034  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00036433 -0.00607718  0.18638056]
Stock Position:  0.0003643332567969981
Bond Position:  [-2.51136105]


portfolio before change:  [-2.47660465]
curr_Stock_Price:  96.25895216145379
curr_Factors:  [96.25895216  0.19669108 -0.9971733 ]
mat_Sqrt:  [[43.23108296  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00134038  0.06310155 -0.11278336]
Stock Position:  -0.001340375635929525
Bond Position:  [-2.3475815]


portfolio before change:  [-2.47717043]
curr_Stock_Price:  96.46211368122687
curr_Factors:  [96.46211368  0.22206154 -1.01024067]
mat_Sqrt:  [[43.85861665  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131783 -0.01387088  0.02840434]
Stock Position:  -0.001317828598727408
Bond Position:  [-2.3500499]


portfolio before change:  [-2.47844468]
curr_Stock_Price:  97.20612189957194
curr_Factors:  [97.2061219   0.2522081  -0.99937924]
mat_Sqrt:  [[46.04699693  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074757  0.02239767 -0.60901288]
Stock Position:  0.0007475717603140989
Bond Position:  [-2.55111323]


portfolio before change:  [-2.47786414]
curr_Stock_Price:  98.4092775557602
curr_Factors:  [98.40927756  0.20218272 -1.04539729]
mat_Sqrt:  [[42.34797091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00087966 -0.01817713 -0.06651756]
Stock Position:  -0.0008796594292375646
Bond Position:  [-2.3912975]


portfolio before change:  [-2.47888372]
curr_Stock_Price:  99.22850763068999
curr_Factors:  [99.22850763  0.48730786 -1.06884349]
mat_Sqrt:  [[55.47262854  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.03350487e-04  9.20954043e-03 -9.52474312e-01]
Stock Position:  0.0005033504872119732
Bond Position:  [-2.52883044]


portfolio before change:  [-2.47818839]
curr_Stock_Price:  101.23794117034451
curr_Factors:  [101.23794117   0.54333106  -1.07334647]
mat_Sqrt:  [[59.58823701  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030095  0.00217535 -0.08512401]
Stock Position:  -0.0003009511709444168
Bond Position:  [-2.44772072]


portfolio before change:  [-2.47867911]
curr_Stock_Price:  101.85177762047394
curr_Factors:  [101.85177762   0.50150832  -1.08341137]
mat_Sqrt:  [[56.91822286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.47125793e-03  2.77622618e-01 -2.41946297e+00]
Stock Position:  -0.0014712579341236145
Bond Position:  [-2.32882888]


portfolio before change:  [-2.4688096]
curr_Stock_Price:  94.94569473433415
curr_Factors:  [94.94569473  0.74804468 -1.06767614]
mat_Sqrt:  [[68.97013848  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01478297  0.15469171 -0.08180294]
Stock Position:  0.014782971116314226
Bond Position:  [-3.87238907]


portfolio before change:  [-2.49919284]
curr_Stock_Price:  92.92315399257592
curr_Factors:  [92.92315399  0.76545071 -1.03968588]
mat_Sqrt:  [[70.63584088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.98547372e-04 -1.86110005e-02  2.48348213e-01]
Stock Position:  0.0001985473722409819
Bond Position:  [-2.51764249]


portfolio before change:  [-2.4984613]
curr_Stock_Price:  98.19279735589205
curr_Factors:  [98.19279736  0.60248759 -1.01043606]
mat_Sqrt:  [[65.2995008   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111165 -0.01793571 -0.05999468]
Stock Position:  -0.0011116491358204436
Bond Position:  [-2.38930536]


portfolio before change:  [-2.49969492]
curr_Stock_Price:  99.03383692287598
curr_Factors:  [99.03383692  0.74179167 -1.01244534]
mat_Sqrt:  [[ 7.55509992e+01  0.00000000e+00  0.00000000e+00]
 [-6.32455532e-01  3.09838668e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [-0.00026781  0.00651233 -0.01819679]
Stock Position:  -0.00026780976435199254
Bond Position:  [-2.47317269]


portfolio before change:  [-2.501004]
curr_Stock_Price:  102.76752952943227
curr_Factors:  [102.76752953   0.51541499  -0.95940373]
mat_Sqrt:  [[65.92255902  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.52081976e-04 -2.82923344e-03  5.33782198e-01]
Stock Position:  -0.0004520819763986871
Bond Position:  [-2.45454466]


portfolio before change:  [-2.49991931]
curr_Stock_Price:  99.68947197929516
curr_Factors:  [ 9.96894720e+01  3.37395871e-02 -9.34915577e-01]
mat_Sqrt:  [[40.48307901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00049489 -0.01043388  0.00797404]
Stock Position:  -0.000494892415474909
Bond Position:  [-2.45058374]


portfolio before change:  [-2.49940128]
curr_Stock_Price:  98.02371373419523
curr_Factors:  [98.02371373 -0.18140566 -0.92656205]
mat_Sqrt:  [[32.37031214  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0029889   0.01841978 -0.58275823]
Stock Position:  -0.002988895445777583
Bond Position:  [-2.20641865]


portfolio before change:  [-2.50606956]
curr_Stock_Price:  100.16245083395741
curr_Factors:  [100.16245083  -0.34754772  -0.96569914]
mat_Sqrt:  [[26.93823127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093023 -0.01325201  0.1301048 ]
Stock Position:  -0.00093022979987054
Bond Position:  [-2.41289546]


portfolio before change:  [-2.50433994]
curr_Stock_Price:  97.97885052836226
curr_Factors:  [97.97885053 -0.20673396 -0.94253142]
mat_Sqrt:  [[31.04650583  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090718  0.0080028  -0.06270042]
Stock Position:  -0.0009071785231116542
Bond Position:  [-2.41545563]


portfolio before change:  [-2.50438999]
curr_Stock_Price:  97.70117789290802
curr_Factors:  [97.70117789 -0.31763771 -0.93451221]
mat_Sqrt:  [[27.93174065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071515 -0.00981262  0.03322587]
Stock Position:  -0.0007151468897093128
Bond Position:  [-2.4345193]


portfolio before change:  [-2.50623131]
curr_Stock_Price:  99.8503706044414
curr_Factors:  [99.8503706  -0.3614873  -0.93773181]
mat_Sqrt:  [[27.23365876  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00152119  0.02092443 -0.16025319]
Stock Position:  0.0015211868152399382
Bond Position:  [-2.65812238]


portfolio before change:  [-2.5101351]
curr_Stock_Price:  97.50253435211197
curr_Factors:  [97.50253435 -0.21910486 -0.90324855]
mat_Sqrt:  [[31.73832564  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154432  0.01130449 -0.30216684]
Stock Position:  -0.0015443158050927788
Bond Position:  [-2.35956039]


portfolio before change:  [-2.50615587]
curr_Stock_Price:  94.73484402443091
curr_Factors:  [94.73484402 -0.2814017  -0.89803225]
mat_Sqrt:  [[29.12648604  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0026371  -0.0132036   0.53141441]
Stock Position:  0.002637097361854481
Bond Position:  [-2.75598088]


portfolio before change:  [-2.50312008]
curr_Stock_Price:  96.01667487837152
curr_Factors:  [96.01667488 -0.49772166 -0.86969938]
mat_Sqrt:  [[24.46150915  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00294139  0.00646084 -0.0848313 ]
Stock Position:  -0.0029413905777377694
Bond Position:  [-2.22069754]


portfolio before change:  [-2.50042325]
curr_Stock_Price:  95.0054407550326
curr_Factors:  [95.00544076 -0.27056328 -0.89589646]
mat_Sqrt:  [[29.59112319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00735851 -0.05403794 -0.39879516]
Stock Position:  -0.007358514114822584
Bond Position:  [-1.80132437]


portfolio before change:  [-2.49592775]
curr_Stock_Price:  94.36391454183027
curr_Factors:  [ 9.43639145e+01 -8.25015275e-02 -8.71095835e-01]
mat_Sqrt:  [[36.36334918  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00473765 0.03222017 0.66443936]
Stock Position:  0.004737646497871977
Bond Position:  [-2.94299062]


portfolio before change:  [-2.50046682]
curr_Stock_Price:  93.48348311609529
curr_Factors:  [93.48348312 -0.2523781  -0.88088422]
mat_Sqrt:  [[30.09991812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00400561 -0.04205698 -0.58843489]
Stock Position:  0.004005609092442351
Bond Position:  [-2.87492511]


portfolio before change:  [-2.49646268]
curr_Stock_Price:  94.57283682083349
curr_Factors:  [94.57283682 -0.1973979  -0.87125704]
mat_Sqrt:  [[32.4829505   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00344926 0.00112948 0.18281098]
Stock Position:  0.0034492564870222827
Bond Position:  [-2.82266865]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.50285722]
Stock Price:  92.82124658388624
PL:  [-2.50285722]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-3.54882478e-02 -8.19407297e-02  1.26787891e-02]
 [-8.88267482e-02  3.07962732e-02  2.21039161e-01]
 [-3.85035509e-02  5.20887001e-02  2.17918585e-02]
 [ 1.00416018e-01  7.11964401e-02  9.42194692e-02]
 [-1.25034948e-01  2.41344290e-01 -2.67843181e-02]
 [-3.21673922e-02 -1.58597784e-01  7.10864380e-02]
 [-6.42835239e-02 -2.90489436e-01 -1.65891868e-01]
 [-8.24466878e-02  8.59279470e-01  2.49442016e-01]
 [ 2.04083255e-01 -4.57515719e-02  1.54098356e-01]
 [ 1.96218808e-01  6.72320237e-02  7.50706654e-02]
 [-2.40357552e-01 -2.79478281e-01  1.36988063e-03]
 [-1.09028851e-01 -2.04832918e-02  8.34967079e-02]
 [-8.59063572e-02  3.30260641e-01 -5.11282314e-01]
 [ 5.75628052e-03 -3.86804943e-02  6.25445428e-02]
 [-1.20671053e-01  1.92614217e-01 -3.80024837e-02]
 [-2.29773648e-01 -9.52040193e-02 -7.83718610e-02]
 [ 7.18982852e-03  1.83917386e-01 -3.16977818e-01]
 [ 1.41446769e-01 -8.86749882e-03 -1.27673068e-01]
 [ 3.42927677e-02  1.99490410e-01 -9.12993749e-02]
 [-9.75222854e-02 -7.36245128e-03 -3.10070102e-02]
 [-6.34475333e-02  6.84139189e-01 -6.56452570e-01]
 [ 6.81637771e-01  3.61602014e-01  1.13780212e-02]
 [ 2.53878339e-02  9.68722649e-02 -1.02323114e-02]
 [-5.67727088e-02 -1.24240858e-01 -2.61327473e-02]
 [ 2.90978529e-02 -1.53886391e-02 -1.09801920e-02]
 [-4.76494825e-02  1.90771916e-03  1.29338817e-01]
 [ 3.85021010e-03 -3.27976806e-02  4.14181053e-03]
 [-3.95937707e-02  8.55837616e-03 -2.85675642e-01]
 [-2.56346740e-02 -4.10220873e-02  4.59325257e-02]
 [-4.88695197e-02  1.44974971e-02 -3.74114566e-04]
 [ 3.43237169e-03 -3.46094911e-02 -3.68890286e-02]
 [-3.45044063e-04  8.55747706e-02 -9.72096012e-02]
 [-4.02122916e-02  2.40722603e-02 -1.23942653e-01]
 [ 3.18820097e-02 -4.31481958e-02  1.26019049e-01]
 [-6.65503001e-02  3.29063027e-02 -2.62206979e-02]
 [-6.44760363e-02 -1.10031694e-01 -4.67459930e-02]
 [ 8.84843490e-02  1.03296816e-01  2.18182995e-01]
 [ 1.21793626e-01 -1.00895555e-01 -1.16264315e-01]
 [ 9.93192138e-02  2.83517278e-03  5.77344895e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.00059364]
curr_Stock_Price:  99.95044322337466
curr_Factors:  [99.95044322 -0.73372587 -0.98462926]
mat_Sqrt:  [[17.92720457  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00276821 -0.02644626  0.03616906]
Stock Position:  -0.0027682108502433325
Bond Position:  [2.27727754]


portfolio before change:  [2.00417917]
curr_Stock_Price:  98.7580283226589
curr_Factors:  [98.75802832 -0.50936848 -0.99169157]
mat_Sqrt:  [[22.01254794  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00169999  0.00993945  0.6305632 ]
Stock Position:  -0.001699987456436154
Bond Position:  [2.17206658]


portfolio before change:  [2.00407988]
curr_Stock_Price:  98.97615673795525
curr_Factors:  [98.97615674 -0.66053777 -1.00281683]
mat_Sqrt:  [[18.75620027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012488   0.01681156  0.06216611]
Stock Position:  -0.0012488001141842341
Bond Position:  [2.12768132]


portfolio before change:  [2.00551134]
curr_Stock_Price:  98.04287335097837
curr_Factors:  [98.04287335 -0.54879809 -1.00277127]
mat_Sqrt:  [[20.77676939  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00645824 0.02297855 0.26878192]
Stock Position:  0.006458241715168122
Bond Position:  [1.37232677]


portfolio before change:  [1.99905467]
curr_Stock_Price:  97.01655325992769
curr_Factors:  [97.01655326 -0.31263084 -0.97577298]
mat_Sqrt:  [[26.74848394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303711  0.07789353 -0.0764082 ]
Stock Position:  -0.003037109584749287
Bond Position:  [2.29370457]


portfolio before change:  [1.99894143]
curr_Stock_Price:  97.14824657042126
curr_Factors:  [ 9.71482466e+01 -7.89590312e-02 -1.00439044e+00]
mat_Sqrt:  [[32.88079196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152157 -0.05118721  0.20278982]
Stock Position:  -0.0015215743890907765
Bond Position:  [2.14675972]


portfolio before change:  [2.00033301]
curr_Stock_Price:  96.41005173923736
curr_Factors:  [ 9.64100517e+01  4.95137496e-02 -1.01282538e+00]
mat_Sqrt:  [[36.79267735  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00427917 -0.09375506 -0.47324332]
Stock Position:  -0.004279165826122819
Bond Position:  [2.41288761]


portfolio before change:  [1.99033342]
curr_Stock_Price:  98.81734882207849
curr_Factors:  [ 9.88173488e+01 -2.78221359e-02 -9.86762979e-01]
mat_Sqrt:  [[35.82650812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00401575 0.27733126 0.71158864]
Stock Position:  0.0040157454725888095
Bond Position:  [1.5935081]


portfolio before change:  [1.98455837]
curr_Stock_Price:  97.32964158456822
curr_Factors:  [ 9.73296416e+01  3.80259134e-02 -9.81424614e-01]
mat_Sqrt:  [[37.8906691   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00596979 -0.01476626  0.43959972]
Stock Position:  0.005969792949434095
Bond Position:  [1.40352056]


portfolio before change:  [1.96912203]
curr_Stock_Price:  94.71451158278431
curr_Factors:  [94.71451158  0.10527661 -0.97445485]
mat_Sqrt:  [[39.71341288  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0056723  0.02169904 0.21415571]
Stock Position:  0.005672295729708077
Bond Position:  [1.43187331]


portfolio before change:  [1.97330559]
curr_Stock_Price:  95.42049758178912
curr_Factors:  [95.42049758  0.20943621 -0.95087686]
mat_Sqrt:  [[45.46090656  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00653586 -0.09020123  0.00390789]
Stock Position:  -0.0065358615485667125
Bond Position:  [2.59696075]


portfolio before change:  [1.95538406]
curr_Stock_Price:  98.21219879686261
curr_Factors:  [98.2121988   0.35230265 -0.94969514]
mat_Sqrt:  [[54.04072541  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00177952 -0.00661095  0.23819287]
Stock Position:  -0.0017795151906860294
Bond Position:  [2.13015416]


portfolio before change:  [1.96257044]
curr_Stock_Price:  94.32344493298689
curr_Factors:  [94.32344493  0.13899375 -0.93645684]
mat_Sqrt:  [[42.48991208  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00289145  0.10659116 -1.45854613]
Stock Position:  -0.0028914451809900136
Bond Position:  [2.23530151]


portfolio before change:  [1.96246922]
curr_Stock_Price:  94.45509045004782
curr_Factors:  [94.45509045 -0.29900092 -0.91836184]
mat_Sqrt:  [[27.95963122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0003801  -0.01248408  0.17842217]
Stock Position:  0.00038010190246516226
Bond Position:  [1.92656667]


portfolio before change:  [1.96294309]
curr_Stock_Price:  95.06814973951265
curr_Factors:  [95.06814974 -0.17519182 -0.92121966]
mat_Sqrt:  [[31.75920249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280583  0.06216597 -0.10841051]
Stock Position:  -0.0028058344631109564
Bond Position:  [2.22968858]


portfolio before change:  [1.96766797]
curr_Stock_Price:  93.48353795628879
curr_Factors:  [ 9.34835380e+01 -4.74551844e-02 -9.28120893e-01]
mat_Sqrt:  [[35.24096833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00752547 -0.03072697 -0.2235731 ]
Stock Position:  -0.007525465079097025
Bond Position:  [2.67117507]


portfolio before change:  [1.96983273]
curr_Stock_Price:  93.2402517482058
curr_Factors:  [93.24025175 -0.17770884 -0.91761681]
mat_Sqrt:  [[31.18240099  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.40458009e-04  5.93590812e-02 -9.04249486e-01]
Stock Position:  -0.0006404580091871375
Bond Position:  [2.0295492]


portfolio before change:  [1.97001072]
curr_Stock_Price:  93.3584749518327
curr_Factors:  [93.35847495 -0.10158284 -0.9216474 ]
mat_Sqrt:  [[33.55602458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00338465 -0.00286197 -0.36421573]
Stock Position:  0.0033846542880033754
Bond Position:  [1.65402456]


portfolio before change:  [1.97022544]
curr_Stock_Price:  93.36082453900552
curr_Factors:  [ 9.33608245e+01  7.29577113e-02 -9.41644313e-01]
mat_Sqrt:  [[39.16506765  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00143948  0.06438525 -0.2604517 ]
Stock Position:  0.0014394758774098591
Bond Position:  [1.83583479]


portfolio before change:  [1.97228545]
curr_Stock_Price:  94.6324757897973
curr_Factors:  [94.63247579  0.25492854 -0.94523367]
mat_Sqrt:  [[47.45090413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00222028 -0.00237622 -0.08845437]
Stock Position:  -0.002220282644976977
Bond Position:  [2.18239629]


portfolio before change:  [1.9657796]
curr_Stock_Price:  97.68553839991436
curr_Factors:  [97.6855384   0.48145611 -0.96658191]
mat_Sqrt:  [[60.13714623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.61070312e-04  2.20804974e-01 -1.87267646e+00]
Stock Position:  -0.0009610703117493028
Bond Position:  [2.05966227]


portfolio before change:  [1.96312807]
curr_Stock_Price:  100.71237602273965
curr_Factors:  [100.71237602   0.36753527  -0.96533223]
mat_Sqrt:  [[55.39402444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01367967 0.11670655 0.03245833]
Stock Position:  0.013679670506160953
Bond Position:  [0.58541595]


portfolio before change:  [1.97171911]
curr_Stock_Price:  101.33504095448684
curr_Factors:  [ 1.01335041e+02  6.60549428e-02 -9.64030073e-01]
mat_Sqrt:  [[41.28326178  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00104336  0.03126539 -0.02918994]
Stock Position:  0.0010433560351645632
Bond Position:  [1.86599058]


portfolio before change:  [1.97395842]
curr_Stock_Price:  103.25772740605949
curr_Factors:  [103.25772741  -0.10566798  -0.97774073]
mat_Sqrt:  [[34.94653631  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0025029  -0.04009856 -0.07454945]
Stock Position:  -0.002502897332278476
Bond Position:  [2.23240191]


portfolio before change:  [1.97592228]
curr_Stock_Price:  102.58458690883354
curr_Factors:  [ 1.02584587e+02 -5.73508289e-02 -9.93767137e-01]
mat_Sqrt:  [[35.85810888  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00066137 -0.00496666 -0.03132343]
Stock Position:  0.0006613661048335917
Bond Position:  [1.90807632]


portfolio before change:  [1.97624639]
curr_Stock_Price:  102.71398531415069
curr_Factors:  [ 1.02713985e+02 -8.06600886e-02 -9.87570325e-01]
mat_Sqrt:  [[35.29417267  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.000591    0.00061571  0.36896764]
Stock Position:  -0.000591001119227078
Bond Position:  [2.03695047]


portfolio before change:  [1.97769011]
curr_Stock_Price:  100.70200164521711
curr_Factors:  [100.70200165  -0.39259053  -0.97951562]
mat_Sqrt:  [[25.53524168  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.82896405e-05 -1.05854059e-02  1.18154326e-02]
Stock Position:  -7.828964046879538e-05
Bond Position:  [1.98557403]


portfolio before change:  [1.97803187]
curr_Stock_Price:  99.50706141728067
curr_Factors:  [99.50706142 -0.62763889 -0.98199487]
mat_Sqrt:  [[19.89751508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00483277  0.0027622  -0.81495309]
Stock Position:  -0.004832769083929931
Bond Position:  [2.45892652]


portfolio before change:  [1.97949616]
curr_Stock_Price:  99.26767386724879
curr_Factors:  [99.26767387 -0.66943345 -0.97028346]
mat_Sqrt:  [[19.26139952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00127884 -0.01323982  0.13103271]
Stock Position:  -0.001278844506913961
Bond Position:  [2.10644408]


portfolio before change:  [1.98026918]
curr_Stock_Price:  98.86911665965003
curr_Factors:  [98.86911666 -0.64506202 -0.96983877]
mat_Sqrt:  [[19.66609579  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00233837  0.00467905 -0.00106724]
Stock Position:  -0.002338369384514049
Bond Position:  [2.21146169]


portfolio before change:  [1.98433425]
curr_Stock_Price:  97.24891898390393
curr_Factors:  [97.24891898 -0.58536268 -1.00181667]
mat_Sqrt:  [[19.88756199  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056127 -0.01117017 -0.10523413]
Stock Position:  -0.0005612655055462087
Bond Position:  [2.03891671]


portfolio before change:  [1.98433979]
curr_Stock_Price:  97.69316501668152
curr_Factors:  [97.69316502 -0.88312255 -0.97978009]
mat_Sqrt:  [[15.16407221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.79370942e-04  2.76191385e-02 -2.77311934e-01]
Stock Position:  -0.0001793709421441728
Bond Position:  [2.0018631]


portfolio before change:  [1.98444134]
curr_Stock_Price:  98.52214920182459
curr_Factors:  [98.5221492  -0.68384096 -0.96480735]
mat_Sqrt:  [[18.94676253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00319834  0.00776929 -0.35357389]
Stock Position:  -0.0031983432559568995
Bond Position:  [2.29954899]


portfolio before change:  [1.9851171]
curr_Stock_Price:  98.4007424964249
curr_Factors:  [98.4007425  -0.82473311 -0.97469544]
mat_Sqrt:  [[16.27483101  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00299837 -0.01392602  0.35949727]
Stock Position:  0.0029983691889833406
Bond Position:  [1.69007535]


portfolio before change:  [1.97975464]
curr_Stock_Price:  96.54181926273854
curr_Factors:  [96.54181926 -0.50840439 -0.98508699]
mat_Sqrt:  [[21.68205344  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300643  0.01062046 -0.07480035]
Stock Position:  -0.0030064314187838097
Bond Position:  [2.270001]


portfolio before change:  [1.97865439]
curr_Stock_Price:  97.00217130116002
curr_Factors:  [97.0021713  -0.49313473 -0.98941367]
mat_Sqrt:  [[22.02514975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00438036 -0.03551258 -0.13335331]
Stock Position:  -0.004380362850165632
Bond Position:  [2.4035591]


portfolio before change:  [1.98717317]
curr_Stock_Price:  95.12599881438854
curr_Factors:  [95.12599881 -0.6424924  -0.99236163]
mat_Sqrt:  [[18.54774625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00830862 0.0333389  0.62241535]
Stock Position:  0.008308618122773911
Bond Position:  [1.19680757]


portfolio before change:  [2.00620237]
curr_Stock_Price:  97.39828897128318
curr_Factors:  [97.39828897 -0.86082345 -1.01710844]
mat_Sqrt:  [[14.89278329  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00520158 -0.0325639  -0.33166973]
Stock Position:  0.005201583302009048
Bond Position:  [1.49957706]


portfolio before change:  [2.00016803]
curr_Stock_Price:  96.202153166082
curr_Factors:  [96.20215317 -0.87211797 -1.00709008]
mat_Sqrt:  [[14.69112679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00760207 0.00091505 0.16470043]
Stock Position:  0.007602067969074067
Bond Position:  [1.26883272]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.00573144]
Stock Price:  96.91311774034152
PL:  [2.00573144]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.22466438e-01  1.14490645e-01 -1.49681275e-02]
 [-1.74078098e-01  6.58503251e-02 -1.97785896e-01]
 [ 7.22697349e-04  1.02768797e-02  4.69990349e-02]
 [ 1.20510735e-01  4.80239169e-02  1.30934897e-01]
 [-3.55055753e-02  1.53191714e-01 -4.75320293e-02]
 [-6.92660772e-02 -1.50178168e-01  1.66079016e-01]
 [-5.55579385e-02 -1.63855066e-01  2.90117437e-02]
 [ 1.12117438e-02  6.05824971e-01  8.71999453e-02]
 [ 4.87224238e-01  7.95675689e-02  4.69762509e-01]
 [ 6.72580773e-01  3.02325576e-01  5.94879773e-01]
 [-1.34084619e-01 -2.35410207e-01 -1.59251801e-02]
 [-2.43802505e-02 -1.73256826e-02  9.52531229e-02]
 [ 1.29830259e-02 -5.81129771e-02  8.31883847e-02]
 [ 1.07309520e-02 -8.26441482e-02 -1.06489044e-01]
 [ 1.09246142e-01 -8.02408081e-02 -1.03520453e-01]
 [-1.68854451e-01 -8.01114265e-02  1.08331921e-01]
 [ 5.16637248e-02  1.65604547e-02 -2.90881776e-02]
 [-3.72808996e-02 -5.97529279e-02 -8.57455217e-03]
 [ 3.64939902e-02  3.72957586e-02 -1.94031940e-01]
 [-8.84888355e-03  7.09796081e-03 -4.43397010e-02]
 [-3.52647808e-02  4.60213203e-01 -4.07618745e-01]
 [ 3.33174588e-01  1.94863556e-01  6.81227948e-02]
 [ 6.92851934e-03 -5.57206823e-02  8.33608324e-02]
 [ 3.35896897e-02  1.78111869e-02 -1.09033957e-01]
 [-1.65136571e-02  1.41978024e-02 -7.78104053e-03]
 [-1.20423843e-01 -6.80327008e-03  2.25390189e-01]
 [-6.44553110e-02 -3.45052551e-02 -1.66110322e-02]
 [-9.86133170e-02  1.30015740e-01 -6.38475324e-02]
 [ 1.43388515e-01  1.28751336e-02  1.71934918e-01]
 [ 6.64218457e-02  6.09246154e-02 -1.12534427e-01]
 [ 3.45248261e-02 -2.93594510e-02 -7.12342465e-02]
 [-1.78212529e-02  8.77873535e-02 -1.24682829e-01]
 [-2.68656150e-02  4.98257633e-02 -3.88644275e-02]
 [ 3.78733619e-02 -3.54853443e-02  1.64609207e-01]
 [-6.83741562e-02  5.46652356e-03 -2.05862085e-02]
 [-2.82631929e-02 -9.15086314e-02 -1.12223551e-02]
 [-3.44808636e-02  9.83680800e-02  6.16755196e-02]
 [ 6.10944842e-02 -7.08613343e-02 -6.56069229e-02]
 [ 9.64862028e-02  4.59029462e-03  7.45053516e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.94567877]
curr_Stock_Price:  98.9486372315137
curr_Factors:  [98.94863723 -0.75803782 -1.00068998]
mat_Sqrt:  [[17.04527613  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01185968  0.0369517  -0.0426999 ]
Stock Position:  -0.011859678150311062
Bond Position:  [-4.77217978]


portfolio before change:  [-5.95712885]
curr_Stock_Price:  99.86379848649914
curr_Factors:  [99.86379849 -0.81350978 -1.0166815 ]
mat_Sqrt:  [[16.01644442  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01255018  0.0212531  -0.56422811]
Stock Position:  -0.01255018457882175
Bond Position:  [-4.70381975]


portfolio before change:  [-5.96288264]
curr_Stock_Price:  100.27540803172207
curr_Factors:  [100.27540803  -0.61279568  -1.01459275]
mat_Sqrt:  [[19.69829444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00063021 0.00331685 0.13407516]
Stock Position:  0.000630211640810454
Bond Position:  [-6.02607737]


portfolio before change:  [-5.96369358]
curr_Stock_Price:  100.18395211213435
curr_Factors:  [100.18395211  -0.51925945  -1.00601002]
mat_Sqrt:  [[21.79626334  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00720493 0.01549965 0.37352082]
Stock Position:  0.007204929931581463
Bond Position:  [-6.68551194]


portfolio before change:  [-5.97051548]
curr_Stock_Price:  99.35311058760844
curr_Factors:  [99.35311059 -0.69416607 -0.9930687 ]
mat_Sqrt:  [[18.38335257  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00075818  0.04944241 -0.13559565]
Stock Position:  -0.0007581795852051995
Bond Position:  [-5.89518798]


portfolio before change:  [-5.97102015]
curr_Stock_Price:  99.0467586338109
curr_Factors:  [99.04675863 -0.74233135 -0.99008067]
mat_Sqrt:  [[17.51714349  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0037689  -0.0484698   0.47377721]
Stock Position:  -0.003768898179230982
Bond Position:  [-5.59772301]


portfolio before change:  [-5.97728449]
curr_Stock_Price:  100.52320422430734
curr_Factors:  [100.52320422  -1.06232126  -1.02631833]
mat_Sqrt:  [[12.45035327  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00667312 -0.052884    0.08276243]
Stock Position:  -0.0066731212049748675
Bond Position:  [-5.30648096]


portfolio before change:  [-5.98580003]
curr_Stock_Price:  101.69989454565872
curr_Factors:  [101.69989455  -1.09859418  -1.02763091]
mat_Sqrt:  [[12.13144901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01258505 0.19552917 0.24875717]
Stock Position:  0.012585047536337489
Bond Position:  [-7.26569804]


portfolio before change:  [-5.9670095]
curr_Stock_Price:  103.26514945531494
curr_Factors:  [103.26514946  -0.84923953  -1.0192939 ]
mat_Sqrt:  [[15.93896153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03760319 0.02568032 1.34010168]
Stock Position:  0.037603188228724695
Bond Position:  [-9.85010835]


portfolio before change:  [-5.97033214]
curr_Stock_Price:  103.2095343712718
curr_Factors:  [103.20953437  -0.97229724  -0.99772355]
mat_Sqrt:  [[14.39297803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05945413 0.09757516 1.69702641]
Stock Position:  0.05945413426645665
Bond Position:  [-12.10656566]


portfolio before change:  [-5.9585752]
curr_Stock_Price:  103.43273756887989
curr_Factors:  [103.43273757  -0.89229899  -0.9863208 ]
mat_Sqrt:  [[15.80461103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01173001 -0.07597832 -0.04543011]
Stock Position:  -0.011730009649085722
Bond Position:  [-4.74530819]


portfolio before change:  [-5.93824089]
curr_Stock_Price:  101.64863763195494
curr_Factors:  [101.64863763  -0.97248436  -0.96398575]
mat_Sqrt:  [[14.65896408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057803 -0.00559184  0.27173065]
Stock Position:  -0.0005780339140578733
Bond Position:  [-5.87948453]


portfolio before change:  [-5.93875756]
curr_Stock_Price:  101.27095180384323
curr_Factors:  [101.2709518   -1.06800052  -0.95678698]
mat_Sqrt:  [[13.36998287  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00135389 -0.01875588  0.23731331]
Stock Position:  0.0013538926839533473
Bond Position:  [-6.07586756]


portfolio before change:  [-5.94073725]
curr_Stock_Price:  100.36972818033944
curr_Factors:  [100.36972818  -0.6498177   -0.95613709]
mat_Sqrt:  [[20.14398753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138382 -0.02667328 -0.3037836 ]
Stock Position:  -0.0013838223006259712
Bond Position:  [-5.80184338]


portfolio before change:  [-5.94198758]
curr_Stock_Price:  100.74915198233732
curr_Factors:  [100.74915198  -0.57919962  -0.99392077]
mat_Sqrt:  [[20.89507294  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00343316 -0.02589761 -0.29531504]
Stock Position:  0.0034331553554017326
Bond Position:  [-6.28787507]


portfolio before change:  [-5.94003502]
curr_Stock_Price:  101.54684392576928
curr_Factors:  [101.54684393  -0.60091654  -1.0031478 ]
mat_Sqrt:  [[20.41879641  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00798744 -0.02585585  0.30904082]
Stock Position:  -0.007987442689989476
Bond Position:  [-5.12893542]


portfolio before change:  [-5.93257679]
curr_Stock_Price:  100.53282921039597
curr_Factors:  [100.53282921  -0.57405802  -1.00961397]
mat_Sqrt:  [[20.63136213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00238019  0.00534486 -0.08298047]
Stock Position:  0.0023801876834227253
Bond Position:  [-6.17186379]


portfolio before change:  [-5.93806853]
curr_Stock_Price:  98.5497048512095
curr_Factors:  [98.54970485 -0.79181728 -0.98903396]
mat_Sqrt:  [[16.60509863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308509 -0.01928517 -0.02446081]
Stock Position:  -0.0030850878537402237
Bond Position:  [-5.63403403]


portfolio before change:  [-5.93883165]
curr_Stock_Price:  98.56877345959299
curr_Factors:  [98.56877346 -0.94048338 -0.98784182]
mat_Sqrt:  [[14.33106148  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.14027767e-04  1.20371543e-02 -5.53519116e-01]
Stock Position:  0.00031402776717241076
Bond Position:  [-5.96978499]


portfolio before change:  [-5.93953271]
curr_Stock_Price:  98.71277085808656
curr_Factors:  [98.71277086 -0.89973574 -1.01946519]
mat_Sqrt:  [[14.48354829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113583  0.00229086 -0.12648883]
Stock Position:  -0.0011358281555627554
Bond Position:  [-5.82741196]


portfolio before change:  [-5.93839888]
curr_Stock_Price:  97.07317742291647
curr_Factors:  [97.07317742 -0.6542543  -1.02384065]
mat_Sqrt:  [[18.12641293  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00135322  0.14853317 -1.16282282]
Stock Position:  -0.0013532176488319431
Bond Position:  [-5.80703774]


portfolio before change:  [-5.93800197]
curr_Stock_Price:  96.24342298762318
curr_Factors:  [96.24342299 -0.54494056 -1.01970856]
mat_Sqrt:  [[20.13040813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01921752 0.06289194 0.19433537]
Stock Position:  0.019217516605733037
Bond Position:  [-7.78756155]


portfolio before change:  [-5.94755688]
curr_Stock_Price:  95.79688198524289
curr_Factors:  [95.79688199 -0.67454233 -1.005516  ]
mat_Sqrt:  [[17.85300448  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00070411 -0.01798377  0.23780525]
Stock Position:  0.0007041134931667299
Bond Position:  [-6.01500876]


portfolio before change:  [-5.94737531]
curr_Stock_Price:  97.12266032369885
curr_Factors:  [97.12266032 -0.72295358 -1.01721927]
mat_Sqrt:  [[17.04406198  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00087825  0.00574854 -0.31104353]
Stock Position:  0.0008782483770903973
Bond Position:  [-6.03267313]


portfolio before change:  [-5.94765158]
curr_Stock_Price:  97.66676023673855
curr_Factors:  [97.66676024 -0.98341543 -1.03390321]
mat_Sqrt:  [[12.99081591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00117035  0.00458232 -0.02219714]
Stock Position:  -0.0011703530502766909
Bond Position:  [-5.83334699]


portfolio before change:  [-5.94668434]
curr_Stock_Price:  96.21723780905845
curr_Factors:  [96.21723781 -0.8571869  -0.994857  ]
mat_Sqrt:  [[15.09803548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00502085 -0.00219575  0.64297547]
Stock Position:  -0.00502085022730258
Bond Position:  [-5.463592]


portfolio before change:  [-5.93908751]
curr_Stock_Price:  94.56814990032287
curr_Factors:  [94.5681499  -0.83786532 -0.98162644]
mat_Sqrt:  [[15.33026508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00488507 -0.01113652 -0.04738665]
Stock Position:  -0.004885067483701512
Bond Position:  [-5.47711572]


portfolio before change:  [-5.9408824]
curr_Stock_Price:  94.79541533628266
curr_Factors:  [94.79541534 -1.03334372 -0.98418921]
mat_Sqrt:  [[12.60619187  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00675119  0.0419624  -0.18213924]
Stock Position:  -0.006751189337758465
Bond Position:  [-5.3009006]


portfolio before change:  [-5.93836411]
curr_Stock_Price:  94.32424684947944
curr_Factors:  [94.32424685 -0.92432386 -1.02087555]
mat_Sqrt:  [[13.48447305  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0134312  0.00415543 0.49048246]
Stock Position:  0.013431204005197107
Bond Position:  [-7.20525231]


portfolio before change:  [-5.93845221]
curr_Stock_Price:  94.38474837075479
curr_Factors:  [94.38474837 -0.68785101 -1.00169844]
mat_Sqrt:  [[17.42367742  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00320753  0.01966334 -0.3210294 ]
Stock Position:  0.0032075339557283804
Bond Position:  [-6.2411945]


portfolio before change:  [-5.93199639]
curr_Stock_Price:  96.64069364023923
curr_Factors:  [96.64069364 -0.92205201 -1.01041415]
mat_Sqrt:  [[13.9926718   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0009999  -0.00947572 -0.20321148]
Stock Position:  0.0009998965021927274
Bond Position:  [-6.02862708]


portfolio before change:  [-5.93300095]
curr_Stock_Price:  96.38973202702071
curr_Factors:  [96.38973203 -0.88311815 -1.01369988]
mat_Sqrt:  [[14.46282631  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175294  0.02833325 -0.35568541]
Stock Position:  -0.0017529430188916897
Bond Position:  [-5.76403524]


portfolio before change:  [-5.93302979]
curr_Stock_Price:  95.99513442621637
curr_Factors:  [95.99513443 -0.83457266 -1.02334061]
mat_Sqrt:  [[14.97503133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164461  0.0160812  -0.11086939]
Stock Position:  -0.0016446136998042777
Bond Position:  [-5.77515488]


portfolio before change:  [-5.93644077]
curr_Stock_Price:  97.63018884577446
curr_Factors:  [97.63018885 -1.0547782  -1.02312549]
mat_Sqrt:  [[12.22255569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00525509 -0.01145285  0.46958425]
Stock Position:  0.0052550924308840535
Bond Position:  [-6.44949643]


portfolio before change:  [-5.93474086]
curr_Stock_Price:  98.1070877796663
curr_Factors:  [98.10708778 -1.11497323 -0.98550774]
mat_Sqrt:  [[12.00806675  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00595104  0.00176431 -0.05872672]
Stock Position:  -0.005951036956736344
Bond Position:  [-5.35090195]


portfolio before change:  [-5.93145148]
curr_Stock_Price:  97.44194623774004
curr_Factors:  [97.44194624 -1.15885746 -1.01541492]
mat_Sqrt:  [[11.07825743  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00444412 -0.02953428 -0.03201426]
Stock Position:  -0.0044441165965313405
Bond Position:  [-5.49840811]


portfolio before change:  [-5.93660885]
curr_Stock_Price:  98.4477776608854
curr_Factors:  [98.44777766 -1.28957323 -1.04994347]
mat_Sqrt:  [[ 9.48782633  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00019099  0.03174816  0.17594309]
Stock Position:  -0.00019099217410917634
Bond Position:  [-5.9178061]


portfolio before change:  [-5.93734434]
curr_Stock_Price:  98.42531612371761
curr_Factors:  [98.42531612 -1.15223362 -1.02007642]
mat_Sqrt:  [[11.21203788  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00296449 -0.0228704  -0.18715829]
Stock Position:  0.002964493894958379
Bond Position:  [-6.22912558]


portfolio before change:  [-5.93813119]
curr_Stock_Price:  98.42256256125208
curr_Factors:  [98.42256256 -1.19141502 -1.0335159 ]
mat_Sqrt:  [[10.63700704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01058865 0.00148151 0.21254303]
Stock Position:  0.010588649007390533
Bond Position:  [-6.98029316]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.94263305]
Stock Price:  98.07981114325126
PL:  [-5.94263305]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.01305296e-01  6.72327291e-02 -9.72620461e-03]
 [-1.41849248e-01  5.80802213e-02 -2.82724456e-02]
 [-3.04682146e-03  6.23380532e-02  4.56350971e-02]
 [ 1.03191458e-01  6.92045720e-02  9.82633688e-02]
 [-1.69673501e-01  2.65927514e-01 -3.27089811e-02]
 [-5.35467221e-02 -1.39461128e-01  2.24312493e-01]
 [-6.53632264e-02 -1.34247997e-01 -6.02610262e-04]
 [ 2.03967058e-02  7.86995871e-01  1.12736385e-01]
 [-2.33494129e-02  8.46151245e-02 -6.66035942e-02]
 [ 2.18322064e-01  7.64518697e-02  9.37405883e-02]
 [-1.55843036e-01 -3.54012450e-01 -7.54381242e-02]
 [ 6.55038587e-02 -1.19585267e-02  1.18848304e-01]
 [-2.80348195e-02  1.55741972e-01 -1.28980763e-01]
 [ 1.32467563e-02 -1.93396494e-01  4.08016189e-02]
 [-6.75380220e-02  1.84131144e-01 -3.62026762e-02]
 [ 1.04814132e-01 -2.56240412e-03 -1.38296739e-02]
 [ 5.06909697e-02  4.12261423e-02 -4.66207643e-02]
 [-2.08011111e-02 -5.62786956e-02 -2.34936208e-02]
 [ 2.61581760e-02  1.83745986e-02 -1.54991302e-01]
 [-1.92130389e-02  4.62067997e-03 -4.21572635e-02]
 [-3.35572675e-02  4.56687866e-01 -4.12044004e-01]
 [ 2.06675456e-01  1.34334148e-01  8.87222870e-02]
 [ 1.80152795e-03 -3.26502763e-02  6.92964602e-02]
 [ 1.28980134e-01 -9.04609028e-02 -2.77421730e-01]
 [ 2.35881058e-02  2.41332440e-02 -1.17907540e-02]
 [-9.86959784e-02 -1.89636023e-02  2.26412190e-01]
 [-4.10579411e-02 -3.34955654e-02 -7.61072703e-03]
 [-1.12016452e-01  1.21223663e-01 -1.30579172e-01]
 [-3.49650436e-03 -4.00950846e-02  6.48142435e-02]
 [ 3.60352645e-02  4.84654985e-02 -8.27677368e-02]
 [ 1.87361509e-03 -1.53677658e-02 -8.77732334e-03]
 [-2.17406526e-02  7.62212909e-02 -1.23124448e-01]
 [-1.04080655e-02  7.34184653e-02 -3.76586091e-02]
 [ 3.88128063e-02 -3.33443665e-02  1.80742523e-01]
 [-8.13031624e-02  1.21199918e-01 -1.23255803e-01]
 [-2.34364343e-01 -2.42247003e-01 -2.20926446e-01]
 [ 1.14928852e-01  1.27094514e-01  3.26325831e-01]
 [ 2.22378918e-01 -1.48856787e-01 -2.81088919e-01]
 [ 9.40533673e-02  6.09749766e-03  8.89072546e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.41561025]
curr_Stock_Price:  99.01546426589076
curr_Factors:  [99.01546427 -0.85441141 -0.98722436]
mat_Sqrt:  [[15.69967913  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00570501  0.02169927 -0.02774615]
Stock Position:  -0.005705009985764463
Bond Position:  [-4.85072604]


portfolio before change:  [-5.4172928]
curr_Stock_Price:  99.20410055151669
curr_Factors:  [99.20410055 -0.78946742 -0.96815473]
mat_Sqrt:  [[17.10818832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00793566  0.01874531 -0.08065342]
Stock Position:  -0.007935659742777854
Bond Position:  [-4.63004282]


portfolio before change:  [-5.40751669]
curr_Stock_Price:  97.89924315419506
curr_Factors:  [97.89924315 -0.63225841 -0.92126299]
mat_Sqrt:  [[20.70587398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00091728 0.02011952 0.13018423]
Stock Position:  0.0009172810363136074
Bond Position:  [-5.49731781]


portfolio before change:  [-5.40796929]
curr_Stock_Price:  98.1550086690671
curr_Factors:  [98.15500867 -0.82814857 -0.92102345]
mat_Sqrt:  [[17.07091144  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00804736 0.02233568 0.28031804]
Stock Position:  0.008047356369007198
Bond Position:  [-6.19785762]


portfolio before change:  [-5.4099707]
curr_Stock_Price:  98.00258269487593
curr_Factors:  [98.00258269 -0.78450549 -0.92439456]
mat_Sqrt:  [[17.74482239  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00687908  0.08582774 -0.09330962]
Stock Position:  -0.006879075161293305
Bond Position:  [-4.73580356]


portfolio before change:  [-5.41137882]
curr_Stock_Price:  98.12121915751608
curr_Factors:  [98.12121916 -0.80629428 -0.89289688]
mat_Sqrt:  [[17.93963452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00201936 -0.04501089  0.63990111]
Stock Position:  -0.0020193560651128846
Bond Position:  [-5.21323714]


portfolio before change:  [-5.41157468]
curr_Stock_Price:  97.8954897162592
curr_Factors:  [97.89548972 -0.99942951 -0.87263509]
mat_Sqrt:  [[15.05689281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00616923 -0.04332835 -0.00171908]
Stock Position:  -0.006169233753384934
Bond Position:  [-4.80763452]


portfolio before change:  [-5.41698558]
curr_Stock_Price:  98.67515001365436
curr_Factors:  [98.67515001 -1.26303244 -0.86025204]
mat_Sqrt:  [[11.80530096  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01728493 0.25400183 0.32160553]
Stock Position:  0.017284928548793373
Bond Position:  [-7.1225785]


portfolio before change:  [-5.42097367]
curr_Stock_Price:  98.49593542105845
curr_Factors:  [98.49593542 -1.30696785 -0.84378215]
mat_Sqrt:  [[11.46461446  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00171596  0.02730941 -0.19000152]
Stock Position:  -0.0017159604199485378
Bond Position:  [-5.25195855]


portfolio before change:  [-5.42045044]
curr_Stock_Price:  97.80840951892195
curr_Factors:  [97.80840952 -1.16845846 -0.83414545]
mat_Sqrt:  [[13.20250592  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01916776 0.02467473 0.26741581]
Stock Position:  0.019167759146679904
Bond Position:  [-7.29521848]


portfolio before change:  [-5.42333267]
curr_Stock_Price:  97.70561866516657
curr_Factors:  [97.70561867 -1.42535309 -0.83829748]
mat_Sqrt:  [[10.15847674  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02397055 -0.11425703 -0.21520397]
Stock Position:  -0.02397054932285205
Bond Position:  [-3.08127532]


portfolio before change:  [-5.42384092]
curr_Stock_Price:  97.71075274973656
curr_Factors:  [97.71075275 -1.50741185 -0.82433751]
mat_Sqrt:  [[ 9.49022439  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00920133 -0.0038596   0.33904113]
Stock Position:  0.00920132543254643
Bond Position:  [-6.32290935]


portfolio before change:  [-5.41619622]
curr_Stock_Price:  98.62748106751035
curr_Factors:  [98.62748107 -1.36180057 -0.82835812]
mat_Sqrt:  [[11.03631556  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00204527  0.05026551 -0.36794622]
Stock Position:  -0.0020452668801275707
Bond Position:  [-5.2144767]


portfolio before change:  [-5.41627202]
curr_Stock_Price:  98.34583022931373
curr_Factors:  [98.34583023 -1.39409683 -0.83189127]
mat_Sqrt:  [[10.61748362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168604 -0.06241845  0.11639566]
Stock Position:  -0.001686043768954347
Bond Position:  [-5.25045664]


portfolio before change:  [-5.41576587]
curr_Stock_Price:  97.65634805630843
curr_Factors:  [97.65634806 -1.02133223 -0.79998755]
mat_Sqrt:  [[15.80197433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236314  0.05942807 -0.10327616]
Stock Position:  -0.002363138254874332
Bond Position:  [-5.18499042]


portfolio before change:  [-5.41748346]
curr_Stock_Price:  98.10889494711628
curr_Factors:  [98.10889495 -0.92779377 -0.80142506]
mat_Sqrt:  [[17.40676989  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00582923 -0.00082701 -0.03945221]
Stock Position:  0.005829232733805458
Bond Position:  [-5.98938305]


portfolio before change:  [-5.41947799]
curr_Stock_Price:  97.89517768032874
curr_Factors:  [97.89517768 -0.92863043 -0.8012072 ]
mat_Sqrt:  [[17.35810702  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00285687  0.01330568 -0.13299606]
Stock Position:  0.00285686665128491
Bond Position:  [-5.69915146]


portfolio before change:  [-5.4218833]
curr_Stock_Price:  97.30261530729605
curr_Factors:  [97.30261531 -0.8425089  -0.80023834]
mat_Sqrt:  [[18.82298313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00197017 -0.01816387 -0.06702076]
Stock Position:  -0.0019701748003042754
Bond Position:  [-5.23018014]


portfolio before change:  [-5.42541284]
curr_Stock_Price:  98.76224454830584
curr_Factors:  [98.76224455 -0.71748043 -0.76801928]
mat_Sqrt:  [[22.35870385  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.73118048e-05  5.93037620e-03 -4.42147042e-01]
Stock Position:  -7.731180480453708e-05
Bond Position:  [-5.41777735]


portfolio before change:  [-5.42604357]
curr_Stock_Price:  98.16039595803879
curr_Factors:  [98.16039596 -0.61390535 -0.75987679]
mat_Sqrt:  [[24.84907902  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108154  0.00149132 -0.12026294]
Stock Position:  -0.0010815355317547078
Bond Position:  [-5.31987962]


portfolio before change:  [-5.42646739]
curr_Stock_Price:  97.93736759880647
curr_Factors:  [97.9373676  -0.76363359 -0.75425574]
mat_Sqrt:  [[21.46532493  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.13878441e-03  1.47395375e-01 -1.17544685e+00]
Stock Position:  -0.0011387844067175332
Bond Position:  [-5.31493784]


portfolio before change:  [-5.4266126]
curr_Stock_Price:  97.48144972072109
curr_Factors:  [97.48144972 -0.78366597 -0.76739955]
mat_Sqrt:  [[20.66820605  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01220264 0.04335616 0.25309999]
Stock Position:  0.012202639153662454
Bond Position:  [-6.61614356]


portfolio before change:  [-5.42113646]
curr_Stock_Price:  97.9979947929241
curr_Factors:  [97.99799479 -0.7568314  -0.7874712 ]
mat_Sqrt:  [[20.9187193   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00044371 -0.01053783  0.19768351]
Stock Position:  0.0004437125806434065
Bond Position:  [-5.4646194]


portfolio before change:  [-5.42175041]
curr_Stock_Price:  98.15389320769823
curr_Factors:  [98.15389321 -1.16700641 -0.7769876 ]
mat_Sqrt:  [[14.04887863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00383564 -0.02919613 -0.79140698]
Stock Position:  0.0038356375240536735
Bond Position:  [-5.79823316]


portfolio before change:  [-5.42105466]
curr_Stock_Price:  98.52425286213253
curr_Factors:  [98.52425286 -1.11343498 -0.76561438]
mat_Sqrt:  [[15.0481247   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00173493  0.00778897 -0.03363574]
Stock Position:  0.00173493418740332
Bond Position:  [-5.59198776]


portfolio before change:  [-5.42277201]
curr_Stock_Price:  97.93731448751294
curr_Factors:  [97.93731449 -1.11369416 -0.76767232]
mat_Sqrt:  [[14.92385804  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00377588 -0.00612048  0.64589096]
Stock Position:  -0.0037758810563394566
Bond Position:  [-5.05297236]


portfolio before change:  [-5.41842922]
curr_Stock_Price:  96.61988740978649
curr_Factors:  [96.61988741 -1.10879968 -0.77230056]
mat_Sqrt:  [[14.72702665  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00335769 -0.01081065 -0.02171129]
Stock Position:  -0.0033576857790123763
Bond Position:  [-5.09401]


portfolio before change:  [-5.42179103]
curr_Stock_Price:  97.43146507770282
curr_Factors:  [97.43146508 -1.15425762 -0.75062525]
mat_Sqrt:  [[14.50170655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00785605  0.03912477 -0.37250603]
Stock Position:  -0.007856050368812938
Bond Position:  [-4.65636454]


portfolio before change:  [-5.42096223]
curr_Stock_Price:  97.25187236339532
curr_Factors:  [97.25187236 -0.94542395 -0.75970875]
mat_Sqrt:  [[17.67535922  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.76515614e-05 -1.29406329e-02  1.84896996e-01]
Stock Position:  8.765156138344546e-05
Bond Position:  [-5.4294865]


portfolio before change:  [-5.4217898]
curr_Stock_Price:  95.55374106688238
curr_Factors:  [95.55374107 -0.89133777 -0.76051493]
mat_Sqrt:  [[18.31711967  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00158504  0.01564217 -0.23611331]
Stock Position:  0.0015850390203838067
Bond Position:  [-5.57324621]


portfolio before change:  [-5.42278528]
curr_Stock_Price:  95.36524212694499
curr_Factors:  [95.36524213 -0.97643413 -0.76796251]
mat_Sqrt:  [[16.66511384  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018332 -0.00495993 -0.02503926]
Stock Position:  -0.0001833159152417298
Bond Position:  [-5.40530331]


portfolio before change:  [-5.42314606]
curr_Stock_Price:  93.64734384915768
curr_Factors:  [93.64734385 -0.57711377 -0.79611047]
mat_Sqrt:  [[23.71983984  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132019  0.02460032 -0.35123978]
Stock Position:  -0.0013201910143764751
Bond Position:  [-5.29951368]


portfolio before change:  [-5.42282152]
curr_Stock_Price:  92.89970928936692
curr_Factors:  [92.89970929 -0.42487629 -0.80186276]
mat_Sqrt:  [[27.24258742  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00011411  0.02369571 -0.10742953]
Stock Position:  -0.00011410866963788682
Bond Position:  [-5.41222086]


portfolio before change:  [-5.4233206]
curr_Stock_Price:  91.3442410148864
curr_Factors:  [91.34424101 -0.44548505 -0.80582924]
mat_Sqrt:  [[26.13619025  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0026362  -0.01076185  0.51560811]
Stock Position:  0.0026362039890193132
Bond Position:  [-5.66412265]


portfolio before change:  [-5.42910211]
curr_Stock_Price:  89.41971094478286
curr_Factors:  [89.41971094 -0.4013195  -0.81370558]
mat_Sqrt:  [[26.53105838  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308027  0.03911711 -0.3516145 ]
Stock Position:  -0.0030802698108081564
Bond Position:  [-5.15366528]


portfolio before change:  [-5.43213155]
curr_Stock_Price:  90.19405429895748
curr_Factors:  [90.1940543  -0.30436093 -0.8127757 ]
mat_Sqrt:  [[29.51288285  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0111446  -0.07818488 -0.63024166]
Stock Position:  -0.011144598425970516
Bond Position:  [-4.42695503]


portfolio before change:  [-5.43915411]
curr_Stock_Price:  90.77452895297212
curr_Factors:  [90.77452895 -0.11728034 -0.82880466]
mat_Sqrt:  [[35.24394433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00588705 0.04101958 0.93091676]
Stock Position:  0.005887050839182927
Bond Position:  [-5.97354838]


portfolio before change:  [-5.44330579]
curr_Stock_Price:  90.19615147681623
curr_Factors:  [90.19615148 -0.16677414 -0.81282547]
mat_Sqrt:  [[33.86517316  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00397508 -0.04804332 -0.80186845]
Stock Position:  0.003975075452763015
Bond Position:  [-5.8018423]


portfolio before change:  [-5.44788238]
curr_Stock_Price:  89.22728402966636
curr_Factors:  [89.22728403 -0.36436673 -0.82819852]
mat_Sqrt:  [[27.07529294  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00419002 0.00196796 0.25362765]
Stock Position:  0.004190024145868714
Bond Position:  [-5.82174686]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.45131174]
Stock Price:  88.58251656717636
PL:  [-5.45131174]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.31496472e-01 -1.06808218e-01  2.03312769e-02]
 [-1.53954505e-01  8.58668439e-02 -2.93052483e-01]
 [ 5.46472942e-02 -1.54812026e-02  8.65771184e-02]
 [-1.38931678e-01 -1.38159834e-01 -7.98716826e-02]
 [ 1.63712825e-01 -1.71863179e-01 -1.04334392e-01]
 [-1.29745147e-01 -1.66599148e-01  8.20510403e-02]
 [-5.21954336e-02 -1.75530817e-01 -2.75748387e-02]
 [ 7.62219482e-03  7.67273544e-01  1.30694855e-01]
 [ 1.43457792e-01  1.70888395e-02  1.63823932e-01]
 [ 5.25709576e-01  2.27520935e-01  4.27122728e-01]
 [-1.01259558e-01 -2.01060254e-01 -8.85306765e-04]
 [-2.77637324e-02 -1.85869375e-02  9.63321463e-02]
 [ 1.45767848e-02 -4.79209516e-02  4.79663582e-02]
 [ 4.71980515e-03  3.04844914e-02 -6.00303982e-02]
 [ 2.16316618e-01 -1.62591008e-01 -1.38321830e-01]
 [-1.40445745e-01 -7.20781236e-02  1.01776075e-01]
 [ 4.85199586e-02  2.22027357e-02 -1.07010264e-02]
 [-3.89965631e-02 -5.01460857e-02  5.39656497e-02]
 [ 1.28384859e-01 -1.49102035e-01 -1.43363305e-02]
 [ 5.19698793e-02 -9.30697670e-03  2.45467283e-01]
 [-1.32250588e-02  3.10096607e-01 -2.93448883e-01]
 [ 1.12997729e-01  8.95096716e-02  1.03977045e-01]
 [ 1.22186871e-03  1.11358931e-01 -1.74968512e-02]
 [ 6.38836114e-02 -1.57982563e-01 -2.37172942e-01]
 [ 4.94907754e-02  7.33310119e-03 -1.32262381e-02]
 [-3.75924231e-03  1.83531283e-02  1.76066664e-02]
 [ 8.96356603e-02 -2.73456982e-02  4.20163372e-02]
 [ 1.53782129e-01 -6.45930435e-02  1.32167682e-01]
 [-4.50945605e-02 -1.46590376e-02 -3.28936653e-02]
 [-5.76935111e-02 -1.25868720e-02  3.72591046e-02]
 [-2.51113557e-02 -4.28060725e-02 -1.19110097e-02]
 [ 2.60841211e-02 -1.88034698e-02 -6.10822879e-02]
 [ 1.04744663e-01 -1.29386807e-03  1.95100242e-01]
 [ 5.56062575e-03 -8.07394897e-02 -8.56581399e-02]
 [ 9.20586372e-03  2.86121474e-02  1.05661300e-02]
 [ 4.21008686e-02  2.71137271e-02  1.36353666e-01]
 [ 3.61917173e-01 -2.25438557e-01  1.61974863e-01]
 [-7.23613528e-02  1.79522154e-02  3.12874009e-02]
 [ 1.04479189e-01  6.35121238e-03  1.18351019e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.88354014]
curr_Stock_Price:  100.56604822861009
curr_Factors:  [100.56604823  -0.8921151   -0.99752043]
mat_Sqrt:  [[15.19823303  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01639325 -0.0344722   0.05799947]
Stock Position:  -0.01639325459445262
Bond Position:  [8.53214498]


portfolio before change:  [6.88469213]
curr_Stock_Price:  100.56083889004843
curr_Factors:  [100.56083889  -1.31720492  -0.96688632]
mat_Sqrt:  [[10.24379003  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01915757  0.0277134  -0.83599716]
Stock Position:  -0.019157567291213047
Bond Position:  [8.81119316]


portfolio before change:  [6.87043612]
curr_Stock_Price:  101.36247905643141
curr_Factors:  [101.36247906  -1.62368416  -0.99018961]
mat_Sqrt:  [[ 7.42482578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00931465 -0.00499654  0.24698042]
Stock Position:  0.009314654545627781
Bond Position:  [5.92627964]


portfolio before change:  [6.86477323]
curr_Stock_Price:  100.67499084998913
curr_Factors:  [100.67499085  -1.65655925  -0.96257352]
mat_Sqrt:  [[ 7.33578666  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02500579 -0.04459089 -0.22785168]
Stock Position:  -0.0250057946593321
Bond Position:  [9.38223138]


portfolio before change:  [6.85848691]
curr_Stock_Price:  100.97328890205476
curr_Factors:  [100.9732889   -1.57239679  -1.00079248]
mat_Sqrt:  [[ 7.70343817  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01393329 -0.0554686  -0.29763698]
Stock Position:  0.013933289189739571
Bond Position:  [5.45159687]


portfolio before change:  [6.85557791]
curr_Stock_Price:  100.7155973883742
curr_Factors:  [100.71559739  -1.44082147  -1.02810698]
mat_Sqrt:  [[ 8.52814807  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01723744 -0.05376964  0.23406878]
Stock Position:  -0.017237441930146532
Bond Position:  [8.59165717]


portfolio before change:  [6.8436765]
curr_Stock_Price:  101.46834441527024
curr_Factors:  [101.46834442  -1.49518086  -1.02355059]
mat_Sqrt:  [[ 8.17446616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01145692 -0.05665233 -0.07866334]
Stock Position:  -0.01145691965129737
Bond Position:  [8.00619117]


portfolio before change:  [6.8464425]
curr_Stock_Price:  101.31427444837429
curr_Factors:  [101.31427445  -1.66039019  -1.01421179]
mat_Sqrt:  [[ 6.98402457  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02733656 0.24763647 0.37283604]
Stock Position:  0.02733656288982087
Bond Position:  [4.07685847]


portfolio before change:  [6.85314044]
curr_Stock_Price:  101.5406486697454
curr_Factors:  [101.54064867  -1.62388529  -0.99605558]
mat_Sqrt:  [[ 7.392887    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0244     0.0055154  0.46734408]
Stock Position:  0.024400001919196508
Bond Position:  [4.37554841]


portfolio before change:  [6.86745174]
curr_Stock_Price:  102.10476033339977
curr_Factors:  [102.10476033  -1.28508881  -0.99460496]
mat_Sqrt:  [[10.44690305  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06311326 0.07343207 1.21846225]
Stock Position:  0.06311326439583372
Bond Position:  [0.423287]


portfolio before change:  [6.94548003]
curr_Stock_Price:  103.34024346414719
curr_Factors:  [103.34024346  -1.14918185  -1.02024716]
mat_Sqrt:  [[11.80588186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01206869 -0.06489192 -0.00252553]
Stock Position:  -0.012068689567971195
Bond Position:  [8.19266134]


portfolio before change:  [6.95670809]
curr_Stock_Price:  102.4947568234692
curr_Factors:  [102.49475682  -1.0761953   -1.03818396]
mat_Sqrt:  [[12.37195699  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00096137 -0.00599891  0.2748088 ]
Stock Position:  -0.0009613724097559083
Bond Position:  [7.05524372]


portfolio before change:  [6.9577743]
curr_Stock_Price:  102.30310743449893
curr_Factors:  [102.30310743  -1.25724401  -1.01792866]
mat_Sqrt:  [[10.5146274   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138722 -0.01546642  0.13683467]
Stock Position:  0.0013872154297222793
Bond Position:  [6.81585785]


portfolio before change:  [6.9577274]
curr_Stock_Price:  101.65509835856943
curr_Factors:  [101.65509836  -1.17079793  -1.03423625]
mat_Sqrt:  [[11.20714494  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.16999275e-04  9.83882729e-03 -1.71250017e-01]
Stock Position:  -0.00011699927523404679
Bond Position:  [6.96962098]


portfolio before change:  [6.9585529]
curr_Stock_Price:  102.046226922785
curr_Factors:  [102.04622692  -1.21710955  -1.06731131]
mat_Sqrt:  [[10.39167555  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01490549 -0.05247602 -0.39459368]
Stock Position:  0.014905492550212285
Bond Position:  [5.43750362]


portfolio before change:  [6.96307133]
curr_Stock_Price:  102.30376264172376
curr_Factors:  [102.30376264  -1.38785935  -1.06491195]
mat_Sqrt:  [[ 8.80372695  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01526441 -0.02326311  0.29033881]
Stock Position:  -0.015264407530237412
Bond Position:  [8.52467765]


portfolio before change:  [6.9537122]
curr_Stock_Price:  102.98670935270054
curr_Factors:  [102.98670935  -1.47897501  -1.05089019]
mat_Sqrt:  [[ 8.20492626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00619966  0.0071659  -0.03052705]
Stock Position:  0.0061996578134259645
Bond Position:  [6.31522984]


portfolio before change:  [6.95350491]
curr_Stock_Price:  102.82593616696464
curr_Factors:  [102.82593617  -1.47194417  -1.03255498]
mat_Sqrt:  [[ 8.40257722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00454824 -0.01618458  0.15394898]
Stock Position:  -0.004548235243728352
Bond Position:  [7.42118146]


portfolio before change:  [6.95286323]
curr_Stock_Price:  103.17099039782676
curr_Factors:  [103.1709904   -1.27620239  -1.02672409]
mat_Sqrt:  [[10.31357752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0092134  -0.04812247 -0.04089756]
Stock Position:  0.009213402677773605
Bond Position:  [6.00230735]


portfolio before change:  [6.95538075]
curr_Stock_Price:  103.36279641280811
curr_Factors:  [103.36279641  -1.42092507  -1.02238205]
mat_Sqrt:  [[ 8.97944407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01115614 -0.00300381  0.70024983]
Stock Position:  0.011156136090011677
Bond Position:  [5.80225133]


portfolio before change:  [6.94753974]
curr_Stock_Price:  102.59493771318989
curr_Factors:  [102.59493771  -1.75508178  -1.00971031]
mat_Sqrt:  [[ 6.46237243  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152063  0.10008325 -0.83712798]
Stock Position:  -0.001520626731464183
Bond Position:  [7.10354835]


portfolio before change:  [6.94817413]
curr_Stock_Price:  102.76171775108534
curr_Factors:  [102.76171775  -1.69886068  -0.99022374]
mat_Sqrt:  [[ 6.98195152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02184103 0.02888912 0.29661757]
Stock Position:  0.021841033917970373
Bond Position:  [4.70375197]


portfolio before change:  [6.9543918]
curr_Stock_Price:  103.01947384192516
curr_Factors:  [103.01947384  -1.54063628  -1.00337534]
mat_Sqrt:  [[ 8.0922468   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00251863  0.03594094 -0.04991365]
Stock Position:  0.002518631222349422
Bond Position:  [6.69492374]


portfolio before change:  [6.95545745]
curr_Stock_Price:  103.11028930040548
curr_Factors:  [103.1102893   -1.31773707  -1.0124003 ]
mat_Sqrt:  [[10.03081457  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00167256 -0.05098865 -0.67658839]
Stock Position:  -0.00167256288949642
Bond Position:  [7.12791589]


portfolio before change:  [6.9549565]
curr_Stock_Price:  103.94254087395565
curr_Factors:  [103.94254087  -1.62083215  -1.02555452]
mat_Sqrt:  [[ 7.37024964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00655172  0.00236675 -0.03773078]
Stock Position:  0.006551724326844257
Bond Position:  [6.27395363]


portfolio before change:  [6.95282673]
curr_Stock_Price:  103.49776293739271
curr_Factors:  [103.49776294  -1.8157126   -1.01028669]
mat_Sqrt:  [[ 6.13218245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00058397 0.00592345 0.05022692]
Stock Position:  0.0005839715432124418
Bond Position:  [6.89238698]


portfolio before change:  [6.95357631]
curr_Stock_Price:  103.30593939319512
curr_Factors:  [103.30593939  -1.96096088  -1.01181594]
mat_Sqrt:  [[ 5.28524011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01752622 -0.00882579  0.11986091]
Stock Position:  0.017526222095250562
Bond Position:  [5.14301348]


portfolio before change:  [6.95224201]
curr_Stock_Price:  103.19312444847337
curr_Factors:  [103.19312445  -1.9399621   -1.00965463]
mat_Sqrt:  [[ 5.40316825  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03101435 -0.02084732  0.37703761]
Stock Position:  0.031014348637177325
Bond Position:  [3.75177447]


portfolio before change:  [6.94932713]
curr_Stock_Price:  103.08401738571048
curr_Factors:  [103.08401739  -2.13578745  -0.97909092]
mat_Sqrt:  [[ 4.57527126  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0119777  -0.00473118 -0.09383647]
Stock Position:  -0.011977697534257538
Bond Position:  [8.18403631]


portfolio before change:  [6.94768907]
curr_Stock_Price:  103.30619065358668
curr_Factors:  [103.30619065  -2.23553382  -0.96351431]
mat_Sqrt:  [[ 4.21499824  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01249284 -0.0040624   0.10628985]
Stock Position:  -0.01249284333720865
Bond Position:  [8.23827713]


portfolio before change:  [6.94805993]
curr_Stock_Price:  103.35893964399985
curr_Factors:  [103.35893964  -2.02722056  -0.95380488]
mat_Sqrt:  [[ 5.24451273  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00691779 -0.0138156  -0.0339788 ]
Stock Position:  -0.006917789148090304
Bond Position:  [7.66307529]


portfolio before change:  [6.94920441]
curr_Stock_Price:  103.33197517259288
curr_Factors:  [103.33197517  -1.78228951  -0.95465686]
mat_Sqrt:  [[ 6.69258698  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00146095 -0.00606879 -0.17425077]
Stock Position:  0.001460946138862703
Bond Position:  [6.79824196]


portfolio before change:  [6.950052]
curr_Stock_Price:  103.33043981593369
curr_Factors:  [103.33043982  -1.76050505  -0.9559404 ]
mat_Sqrt:  [[ 6.83110576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.11247240e-02 -4.17594124e-04  5.56566684e-01]
Stock Position:  0.02112472395401564
Bond Position:  [4.76722499]


portfolio before change:  [6.95668039]
curr_Stock_Price:  103.61600311924305
curr_Factors:  [103.61600312  -1.60715941  -0.95057144]
mat_Sqrt:  [[ 8.02820474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00353817 -0.02605856 -0.24435883]
Stock Position:  -0.003538169376938661
Bond Position:  [7.32329136]


portfolio before change:  [6.9557935]
curr_Stock_Price:  104.1254067698411
curr_Factors:  [104.12540677  -1.7827141   -0.93713281]
mat_Sqrt:  [[ 6.86028575  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00250764 0.00923453 0.03014223]
Stock Position:  0.0025076355059678334
Bond Position:  [6.69468494]


portfolio before change:  [6.95707275]
curr_Stock_Price:  104.30181301396917
curr_Factors:  [104.30181301  -1.67026442  -0.94518707]
mat_Sqrt:  [[ 7.62808824  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0098935  0.00875092 0.38897905]
Stock Position:  0.009893502544393936
Bond Position:  [5.9251625]


portfolio before change:  [6.95676875]
curr_Stock_Price:  104.19621936461213
curr_Factors:  [104.19621936  -1.71892515  -0.93479948]
mat_Sqrt:  [[ 7.33422104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04758006 -0.07275998  0.4620692 ]
Stock Position:  0.04758006315333071
Bond Position:  [1.99910606]


portfolio before change:  [6.95744255]
curr_Stock_Price:  104.20512838522512
curr_Factors:  [104.20512839  -1.62181126  -0.94430966]
mat_Sqrt:  [[ 8.0063936   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00778257  0.00579405  0.08925425]
Stock Position:  -0.007782574941408623
Bond Position:  [7.76842677]


portfolio before change:  [6.95444384]
curr_Stock_Price:  104.71521975464188
curr_Factors:  [104.71521975  -1.49678453  -0.92326548]
mat_Sqrt:  [[ 9.31098113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01395491 0.00204984 0.33762251]
Stock Position:  0.013954912294058904
Bond Position:  [5.49315213]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.9647307]
Stock Price:  105.40316211700426
PL:  [1.56156858]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-9.15078727e-01  3.78446454e-01 -4.49323727e-02]
 [-1.82665667e-01  5.36045346e-02 -1.12612704e-01]
 [ 1.63240855e-02 -6.23516725e-03  5.80277323e-02]
 [ 7.99280202e-02  1.67786053e-04  1.21711613e-01]
 [ 1.07432001e-01 -7.63993810e-02 -8.91323131e-02]
 [-1.29576722e-01 -1.68980885e-01  6.85861964e-02]
 [-5.22716780e-02 -1.72245191e-01 -2.74951364e-02]
 [ 9.01951045e-03  6.25014274e-01  9.32818578e-02]
 [ 3.52982259e-01  2.37618663e-02  3.57087634e-01]
 [ 5.62591179e-01  2.43599556e-01  4.60516260e-01]
 [-1.57956757e-01 -1.79502252e-01  4.12815105e-02]
 [-6.27195607e-02 -1.88810829e-02  8.92374490e-02]
 [ 9.60960159e-03 -5.89048511e-02  1.14774056e-01]
 [ 9.61817260e-03 -2.11353212e-02 -2.04564883e-01]
 [ 1.49020671e-01 -7.00605824e-02 -1.16372322e-01]
 [-1.72146056e-01 -8.10422138e-02  1.09091522e-01]
 [ 5.16931274e-02  1.65076843e-02 -2.92601465e-02]
 [-4.53594824e-02 -6.14560367e-02 -1.26105233e-03]
 [ 2.89446113e-02  6.14676190e-02 -2.07395693e-01]
 [-3.62770093e-02  2.59342669e-02 -5.86969985e-02]
 [-4.42774694e-02  5.51568915e-01 -5.25540828e-01]
 [ 4.63312301e-01  2.57134013e-01  4.69307854e-02]
 [-8.98438340e-04 -2.05009837e-02  6.18899078e-02]
 [-5.67727088e-02 -1.24240858e-01 -2.61327473e-02]
 [ 2.69937665e-02  2.30802625e-02 -1.10561811e-02]
 [-6.21704897e-02 -8.34222789e-03  1.81443405e-01]
 [ 3.30669908e-02 -3.33907617e-02  9.92862405e-03]
 [ 1.53979389e-01 -6.44278977e-02  1.33374840e-01]
 [-4.16357313e-02 -2.64526436e-04 -6.06823636e-02]
 [-6.49948793e-02  9.09990461e-03  3.89127742e-03]
 [ 1.59845656e-01  2.78174613e-02  5.26710647e-02]
 [ 2.69423306e-02 -1.18341212e-01 -2.19644878e-01]
 [ 3.92689828e-02 -5.13597986e-03  1.50533914e-01]
 [-1.59380269e-02 -1.21855521e-01 -3.70299793e-01]
 [ 1.08842742e-01  4.69971027e-01 -2.04659097e-01]
 [-2.53084834e-02  3.00126167e-02  5.38371279e-03]
 [ 5.93258393e-01 -3.22935526e-01  4.64985086e-01]
 [-1.61729246e-01  9.84540514e-02  6.57533702e-02]
 [ 5.24888277e-01 -7.99562257e-02 -5.39640678e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.08021594]
curr_Stock_Price:  98.04916868597563
curr_Factors:  [98.04916869 -0.60907529 -1.01890167]
mat_Sqrt:  [[19.24963521  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04400086  0.12214307 -0.12817955]
Stock Position:  -0.0440008571927538
Bond Position:  [-8.76596847]


portfolio before change:  [-13.1307535]
curr_Stock_Price:  99.1728228257254
curr_Factors:  [99.17282283 -0.77284222 -1.01177217]
mat_Sqrt:  [[16.64732637  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01169621  0.01730079 -0.3212527 ]
Stock Position:  -0.011696212062924715
Bond Position:  [-11.97080713]


portfolio before change:  [-13.15486073]
curr_Stock_Price:  101.10599432401706
curr_Factors:  [101.10599432  -1.01620184  -1.00791775]
mat_Sqrt:  [[13.35712337  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00201362 -0.00201239  0.16553697]
Stock Position:  0.0020136220778887008
Bond Position:  [-13.35844999]


portfolio before change:  [-13.15830946]
curr_Stock_Price:  100.22259978995565
curr_Factors:  [100.22259979  -1.18168598  -0.99305523]
mat_Sqrt:  [[11.38905158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [9.20239474e-03 5.41527159e-05 3.47209354e-01]
Stock Position:  0.009202394737144645
Bond Position:  [-14.08059739]


portfolio before change:  [-13.15630475]
curr_Stock_Price:  100.63172092832012
curr_Factors:  [100.63172093  -1.06968071  -0.99183664]
mat_Sqrt:  [[12.80646573  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00575045 -0.02465779 -0.25426968]
Stock Position:  0.005750453476703713
Bond Position:  [-13.73498278]


portfolio before change:  [-13.15688798]
curr_Stock_Price:  100.82888068922394
curr_Factors:  [100.82888069  -1.27528292  -0.98210184]
mat_Sqrt:  [[10.5490949   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01422584 -0.05453835  0.19565733]
Stock Position:  -0.014225836790082649
Bond Position:  [-11.72251278]


portfolio before change:  [-13.16793988]
curr_Stock_Price:  101.50276018209703
curr_Factors:  [101.50276018  -1.34159068  -1.00212477]
mat_Sqrt:  [[ 9.74126065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00955148 -0.0555919  -0.07843597]
Stock Position:  -0.009551484651130525
Bond Position:  [-12.19843782]


portfolio before change:  [-13.17559743]
curr_Stock_Price:  102.14482208236417
curr_Factors:  [102.14482208  -1.15538775  -1.04468494]
mat_Sqrt:  [[11.3171462   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01375268 0.20172249 0.26610718]
Stock Position:  0.013752680361180278
Bond Position:  [-14.58036251]


portfolio before change:  [-13.17662657]
curr_Stock_Price:  102.20252064107673
curr_Factors:  [102.20252064  -1.08171244  -1.0350189 ]
mat_Sqrt:  [[12.30769908  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03499621 0.00766911 1.01867163]
Stock Position:  0.03499621132300957
Bond Position:  [-16.75332758]


portfolio before change:  [-13.17753903]
curr_Stock_Price:  102.23629106432084
curr_Factors:  [102.23629106  -1.08265513  -1.02900566]
mat_Sqrt:  [[12.37435178  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05707921 0.07862142 1.31372471]
Stock Position:  0.05707920954002111
Bond Position:  [-19.01310571]


portfolio before change:  [-13.20206577]
curr_Stock_Price:  101.84823479179057
curr_Factors:  [101.84823479  -0.79614098  -1.03565771]
mat_Sqrt:  [[16.30847845  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01141559 -0.0579341   0.11776466]
Stock Position:  -0.011415592694247143
Bond Position:  [-12.0394078]


portfolio before change:  [-13.19742517]
curr_Stock_Price:  101.3098816879578
curr_Factors:  [101.30988169  -0.69068732  -1.04475489]
mat_Sqrt:  [[17.86318225  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270714 -0.00609384  0.2545696 ]
Stock Position:  -0.002707139574431186
Bond Position:  [-12.92316518]


portfolio before change:  [-13.19884037]
curr_Stock_Price:  101.2358947517557
curr_Factors:  [101.23589475  -0.70484312  -1.03799154]
mat_Sqrt:  [[17.71866715  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00118597 -0.01901146  0.32741844]
Stock Position:  0.0011859726889458832
Bond Position:  [-13.31890338]


portfolio before change:  [-13.20030715]
curr_Stock_Price:  101.40300288838239
curr_Factors:  [101.40300289  -0.60252643  -1.03155599]
mat_Sqrt:  [[19.7869036   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184226 -0.0068214  -0.58356667]
Stock Position:  -0.0018422634211927125
Bond Position:  [-13.01349611]


portfolio before change:  [-13.20092865]
curr_Stock_Price:  100.85731864312638
curr_Factors:  [100.85731864  -0.41207075  -1.01715086]
mat_Sqrt:  [[24.15485071  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00459391 -0.02261196 -0.33197784]
Stock Position:  0.004593910130753713
Bond Position:  [-13.6642581]


portfolio before change:  [-13.20060004]
curr_Stock_Price:  101.30067605834076
curr_Factors:  [101.30067606  -0.42064325  -1.0130594 ]
mat_Sqrt:  [[24.15256131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00689039 -0.02615626  0.31120775]
Stock Position:  -0.006890387853048291
Bond Position:  [-12.50259909]


portfolio before change:  [-13.19910939]
curr_Stock_Price:  100.8575123519714
curr_Factors:  [100.85751235  -0.40413095  -1.00228073]
mat_Sqrt:  [[24.7122005   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00198647  0.00532783 -0.08347105]
Stock Position:  0.0019864698785222886
Bond Position:  [-13.3994598]


portfolio before change:  [-13.20371187]
curr_Stock_Price:  99.3838229105764
curr_Factors:  [99.38382291 -0.75786044 -0.97853323]
mat_Sqrt:  [[17.50691044  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332221 -0.01983485 -0.00359743]
Stock Position:  -0.003322205522508147
Bond Position:  [-12.87353839]


portfolio before change:  [-13.20135585]
curr_Stock_Price:  98.19024365008067
curr_Factors:  [98.19024365 -0.74934977 -0.96069401]
mat_Sqrt:  [[17.75847875  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.74608282e-05  1.98385887e-02 -5.91642184e-01]
Stock Position:  -4.746082816106238e-05
Bond Position:  [-13.19669566]


portfolio before change:  [-13.20302745]
curr_Stock_Price:  98.65185346715619
curr_Factors:  [98.65185347 -0.36546903 -0.97137724]
mat_Sqrt:  [[25.91315492  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00165803  0.00837025 -0.1674462 ]
Stock Position:  -0.0016580255877759063
Bond Position:  [-13.03946015]


portfolio before change:  [-13.20592914]
curr_Stock_Price:  99.41882751771362
curr_Factors:  [99.41882752 -0.41743936 -1.00034433]
mat_Sqrt:  [[24.0842431   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00161784  0.1780181  -1.4992217 ]
Stock Position:  -0.0016178423519571672
Bond Position:  [-13.04508515]


portfolio before change:  [-13.20700438]
curr_Stock_Price:  99.07546684429128
curr_Factors:  [99.07546684 -0.22094631 -1.01730591]
mat_Sqrt:  [[28.72103091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01829249 0.08298965 0.13388047]
Stock Position:  0.018292493398486112
Bond Position:  [-15.0193417]


portfolio before change:  [-13.20584643]
curr_Stock_Price:  99.24140817463885
curr_Factors:  [99.24140817 -0.20115972 -0.99024456]
mat_Sqrt:  [[30.14897942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00025042 -0.00661666  0.17655468]
Stock Position:  0.00025042441108692845
Bond Position:  [-13.2306989]


portfolio before change:  [-13.20685114]
curr_Stock_Price:  101.83392955501168
curr_Factors:  [101.83392956   0.16436506  -0.98264676]
mat_Sqrt:  [[44.92801955  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00194684 -0.04009856 -0.07454945]
Stock Position:  -0.0019468383735912651
Bond Position:  [-13.00859694]


portfolio before change:  [-13.20635453]
curr_Stock_Price:  100.7435511332425
curr_Factors:  [100.74355113   0.28182496  -0.98588965]
mat_Sqrt:  [[49.82483223  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00059103  0.00744912 -0.03154021]
Stock Position:  0.0005910340395133061
Bond Position:  [-13.2658974]


portfolio before change:  [-13.20731586]
curr_Stock_Price:  101.92284838578482
curr_Factors:  [101.92284839   0.10467682  -0.99870094]
mat_Sqrt:  [[41.68711206  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064376 -0.00269244  0.51760753]
Stock Position:  -0.0006437567523684642
Bond Position:  [-13.14170234]


portfolio before change:  [-13.20868525]
curr_Stock_Price:  101.49811480683162
curr_Factors:  [101.49811481   0.12207587  -1.06193303]
mat_Sqrt:  [[39.65365252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071312 -0.01077682  0.0283236 ]
Stock Position:  0.0007131197312979514
Bond Position:  [-13.28106556]


portfolio before change:  [-13.20908497]
curr_Stock_Price:  103.26573389630643
curr_Factors:  [103.2657339    0.18861675  -1.06921551]
mat_Sqrt:  [[42.80722288  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00392581 -0.02079401  0.38048129]
Stock Position:  0.0039258123606510905
Bond Position:  [-13.61448686]


portfolio before change:  [-13.20444569]
curr_Stock_Price:  104.88099166573332
curr_Factors:  [104.88099167   0.13782566  -1.08594926]
mat_Sqrt:  [[40.63796367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.33068831e-03 -8.53755400e-05 -1.73109893e-01]
Stock Position:  -0.0013306883080558306
Bond Position:  [-13.06488178]


portfolio before change:  [-13.20814511]
curr_Stock_Price:  106.43373137305139
curr_Factors:  [ 1.06433731e+02 -9.89406403e-02 -1.07115765e+00]
mat_Sqrt:  [[33.03026491  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188745  0.00293698  0.01110073]
Stock Position:  -0.0018874527820993594
Bond Position:  [-13.00725647]


portfolio before change:  [-13.21338434]
curr_Stock_Price:  108.34807105075093
curr_Factors:  [108.34807105  -0.37493921  -1.05989111]
mat_Sqrt:  [[25.80371854  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00683139 0.00897805 0.15025589]
Stock Position:  0.006831391645284432
Bond Position:  [-13.95355245]


portfolio before change:  [-13.21780869]
curr_Stock_Price:  107.95575827710316
curr_Factors:  [107.95575828  -0.40423427  -1.03357234]
mat_Sqrt:  [[25.63387926  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164036 -0.03819446 -0.6265857 ]
Stock Position:  -0.0016403600386103413
Bond Position:  [-13.04072238]


portfolio before change:  [-13.22071793]
curr_Stock_Price:  108.73549191930243
curr_Factors:  [108.73549192  -0.64253336  -1.03993015]
mat_Sqrt:  [[20.21560327  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00341064 -0.00165763  0.42943135]
Stock Position:  0.0034106432967432577
Bond Position:  [-13.5915759]


portfolio before change:  [-13.21972161]
curr_Stock_Price:  109.52577511076522
curr_Factors:  [109.52577511  -0.43748524  -1.0655263 ]
mat_Sqrt:  [[24.36501702  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00477729 -0.0393287  -1.05636224]
Stock Position:  -0.004777292358941139
Bond Position:  [-12.69648496]


portfolio before change:  [-13.22544525]
curr_Stock_Price:  110.39163940082267
curr_Factors:  [110.3916394   -0.43605889  -1.06437563]
mat_Sqrt:  [[24.62100364  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00662034  0.1516825  -0.58383544]
Stock Position:  0.006620335858303788
Bond Position:  [-13.95627498]


portfolio before change:  [-13.22369921]
curr_Stock_Price:  110.91890678254092
curr_Factors:  [110.91890678  -0.36922956  -1.04097268]
mat_Sqrt:  [[27.0746301   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0006679   0.00968653  0.01535823]
Stock Position:  -0.000667903416632735
Bond Position:  [-13.14961609]


portfolio before change:  [-13.22533634]
curr_Stock_Price:  110.90891394719652
curr_Factors:  [110.90891395  -0.42249301  -1.02536475]
mat_Sqrt:  [[26.07172807  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02386701 -0.10422699  1.32647302]
Stock Position:  0.023867007836307613
Bond Position:  [-15.87240026]


portfolio before change:  [-13.22712807]
curr_Stock_Price:  110.91697717249698
curr_Factors:  [110.91697717  -0.48247638  -1.02067164]
mat_Sqrt:  [[24.67113521  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00519678  0.03177591  0.18757606]
Stock Position:  -0.0051967834274091644
Bond Position:  [-12.65071656]


portfolio before change:  [-13.22904376]
curr_Stock_Price:  110.98129614854832
curr_Factors:  [110.98129615  -0.67409189  -1.02218682]
mat_Sqrt:  [[20.35004189  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02493684 -0.02580576 -0.01539445]
Stock Position:  0.02493684026000515
Bond Position:  [-15.99656661]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.18787786]
Stock Price:  112.71229294674953
PL:  [-25.90017081]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.42223922e-01 -2.77117795e-02  8.09851479e-04]
 [-9.96881183e-02  8.35286411e-02 -5.61387348e-02]
 [-3.55312273e-02  5.27903538e-02  2.47675728e-02]
 [ 8.10449660e-02  8.50985897e-02  6.59952632e-02]
 [ 8.03316988e-02 -3.30291508e-02 -8.27251645e-02]
 [-9.05963486e-02 -1.57405788e-01  1.28338851e-01]
 [-5.71074979e-02 -1.65936912e-01  5.80615339e-02]
 [ 1.42958269e-02  6.11774352e-01  8.27806968e-02]
 [ 2.67409565e-01 -1.18757085e-02  2.83523357e-01]
 [ 4.98561069e-01  2.09658473e-01  3.83091145e-01]
 [-1.77651243e-01 -2.41846351e-01  8.26307452e-03]
 [ 5.14707450e-02 -1.16557284e-02  1.21457442e-01]
 [ 1.30989289e-02 -3.51450849e-02  3.33625524e-02]
 [ 1.36716134e-02 -1.73331492e-01 -3.62722108e-02]
 [ 4.41641284e-02 -6.28761408e-02 -7.78661003e-02]
 [ 1.77550748e-01  1.81075378e-02 -6.76620484e-02]
 [ 4.37414531e-02  3.07789686e-02  1.72473321e-02]
 [-5.09854847e-02 -6.26420980e-02  3.83213894e-03]
 [ 3.94536077e-02  9.60510558e-04 -1.30120443e-01]
 [ 7.89491948e-03  1.85936264e-02 -1.51058052e-02]
 [-3.27973848e-02  4.64177019e-01 -4.31604367e-01]
 [ 3.24391934e-01  1.90661086e-01  6.95529882e-02]
 [-6.84137133e-04 -2.14652950e-02  6.24777792e-02]
 [ 1.95384801e-02 -1.16308454e-01 -1.77877400e-01]
 [ 3.50414104e-02  1.66086596e-02 -1.25043156e-02]
 [-9.17778195e-02 -1.94954600e-02  2.29268642e-01]
 [-2.68972837e-02 -3.28844767e-02 -2.16352340e-03]
 [-7.16258346e-02  5.75704902e-02 -2.20091850e-01]
 [-2.09927141e-02 -4.05243346e-02  5.02183217e-02]
 [-7.47553440e-03  3.14080914e-02 -4.08666719e-02]
 [-6.86138146e-03 -2.24809731e-02 -6.82798037e-03]
 [-2.85486575e-02  5.72298031e-02 -1.21120755e-01]
 [-1.74107054e-02  6.25392117e-02 -6.04211776e-02]
 [ 4.79807652e-02 -4.22771150e-02  1.87325979e-01]
 [-7.39742348e-02  6.78020510e-04 -3.23275143e-02]
 [-1.31932467e-01 -1.58807788e-01 -1.21519233e-01]
 [ 5.61718682e-02  1.04631852e-01  1.80902786e-01]
 [ 1.76946673e-01 -1.23403087e-01 -1.78415678e-01]
 [ 9.96711946e-02  2.61711178e-03  5.56508331e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.09072673]
curr_Stock_Price:  99.30856801572035
curr_Factors:  [99.30856802 -1.08880951 -1.00171815]
mat_Sqrt:  [[12.27671278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01113756 -0.00894394  0.00231028]
Stock Position:  0.01113755704685208
Bond Position:  [-4.19678157]


portfolio before change:  [-3.08409539]
curr_Stock_Price:  99.95107628746582
curr_Factors:  [99.95107629 -0.64070724 -0.970163  ]
mat_Sqrt:  [[19.96160315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00471391  0.02695875 -0.16014818]
Stock Position:  -0.004713908817283491
Bond Position:  [-2.61293513]


portfolio before change:  [-3.07930019]
curr_Stock_Price:  98.86453982916132
curr_Factors:  [98.86453983 -0.64642408 -0.96812711]
mat_Sqrt:  [[19.6720615   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00100141  0.01703801  0.07065499]
Stock Position:  -0.0010014091191909243
Bond Position:  [-2.98029634]


portfolio before change:  [-3.07973184]
curr_Stock_Price:  98.92353834153235
curr_Factors:  [98.92353834 -0.67178183 -0.95618049]
mat_Sqrt:  [[19.42158145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00576096 0.02746545 0.18826612]
Stock Position:  0.005760955659375527
Bond Position:  [-3.64962595]


portfolio before change:  [-3.07102068]
curr_Stock_Price:  100.51483498817178
curr_Factors:  [100.51483499  -0.72434791  -0.94117648]
mat_Sqrt:  [[19.00649834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00298337 -0.01066011 -0.23599187]
Stock Position:  0.0029833716412332113
Bond Position:  [-3.37089379]


portfolio before change:  [-3.07312931]
curr_Stock_Price:  99.94928659398742
curr_Factors:  [99.94928659 -0.72129575 -0.92814973]
mat_Sqrt:  [[19.2058985   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00502604 -0.0508025   0.36611502]
Stock Position:  -0.005026039912050785
Bond Position:  [-2.5707802]


portfolio before change:  [-3.07578599]
curr_Stock_Price:  100.41392909161333
curr_Factors:  [100.41392909  -0.88582849  -0.94770757]
mat_Sqrt:  [[16.05089921  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00492978 -0.05355591  0.16563339]
Stock Position:  -0.004929784072291715
Bond Position:  [-2.580767]


portfolio before change:  [-3.07982554]
curr_Stock_Price:  101.16790539200217
curr_Factors:  [101.16790539  -1.04642754  -0.96356654]
mat_Sqrt:  [[13.5554338   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01151356 0.19744932 0.23615029]
Stock Position:  0.011513558676062168
Bond Position:  [-4.24462816]


portfolio before change:  [-3.08047267]
curr_Stock_Price:  101.1577856332131
curr_Factors:  [101.15778563  -1.01619383  -0.94418569]
mat_Sqrt:  [[14.24351921  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02266711 -0.00383287  0.80881322]
Stock Position:  0.02266710943951547
Bond Position:  [-5.37342727]


portfolio before change:  [-3.07313639]
curr_Stock_Price:  101.51107262128836
curr_Factors:  [101.51107262  -1.19880948  -0.93441511]
mat_Sqrt:  [[12.02446469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05152459 0.06766698 1.09285241]
Stock Position:  0.05152458709235179
Bond Position:  [-8.3034525]


portfolio before change:  [-3.0871711]
curr_Stock_Price:  101.25882986147529
curr_Factors:  [101.25882986  -1.60076151  -0.93838073]
mat_Sqrt:  [[ 7.99277231  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02819187 -0.07805557  0.02357225]
Stock Position:  -0.02819187392973107
Bond Position:  [-0.23249493]


portfolio before change:  [-3.09099512]
curr_Stock_Price:  101.39344176010792
curr_Factors:  [101.39344176  -1.45453782  -0.91373827]
mat_Sqrt:  [[ 9.49468645  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00778161 -0.00376187  0.34648428]
Stock Position:  0.007781607785462316
Bond Position:  [-3.87999912]


portfolio before change:  [-3.09540931]
curr_Stock_Price:  100.88851248802102
curr_Factors:  [100.88851249  -1.53224528  -0.93056494]
mat_Sqrt:  [[ 8.5952167   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00148165 -0.01134303  0.09517408]
Stock Position:  0.001481646299437668
Bond Position:  [-3.2448904]


portfolio before change:  [-3.09718297]
curr_Stock_Price:  99.96520198379106
curr_Factors:  [99.96520198 -1.32509312 -0.93392505]
mat_Sqrt:  [[10.44166415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00278821 -0.0559425  -0.10347452]
Stock Position:  -0.002788211043481685
Bond Position:  [-2.81845889]


portfolio before change:  [-3.09808046]
curr_Stock_Price:  100.16072533664769
curr_Factors:  [100.16072534  -1.32823328  -0.92564521]
mat_Sqrt:  [[10.51599737  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00146779 -0.02029319 -0.22213031]
Stock Position:  0.0014677864737776233
Bond Position:  [-3.24509502]


portfolio before change:  [-3.09976819]
curr_Stock_Price:  99.28725304901491
curr_Factors:  [99.28725305 -1.36856861 -0.91335416]
mat_Sqrt:  [[10.13600996  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01651887  0.00584418 -0.19302099]
Stock Position:  0.01651887443254841
Bond Position:  [-4.73988186]


portfolio before change:  [-3.10289401]
curr_Stock_Price:  99.13389517203679
curr_Factors:  [99.13389517 -1.40861063 -0.8778084 ]
mat_Sqrt:  [[10.07495238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00531464 0.00993387 0.04920184]
Stock Position:  0.005314643553619414
Bond Position:  [-3.62975533]


portfolio before change:  [-3.1022221]
curr_Stock_Price:  99.3456986791134
curr_Factors:  [99.34569868 -1.27938817 -0.86347554]
mat_Sqrt:  [[11.65507799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00540451 -0.02021765  0.01093203]
Stock Position:  -0.00540451272243571
Bond Position:  [-2.56530701]


portfolio before change:  [-3.10050844]
curr_Stock_Price:  98.96928339528198
curr_Factors:  [98.9692834  -1.01866619 -0.86704317]
mat_Sqrt:  [[15.0157579   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.71680726e-04  3.10003450e-04 -3.71197407e-01]
Stock Position:  0.0008716807264126744
Bond Position:  [-3.18677806]


portfolio before change:  [-3.10042977]
curr_Stock_Price:  99.51655332497208
curr_Factors:  [99.51655332 -0.80872077 -0.87937498]
mat_Sqrt:  [[18.39774753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00046782  0.00600107 -0.04309266]
Stock Position:  0.0004678218339669713
Bond Position:  [-3.14698579]


portfolio before change:  [-3.10083932]
curr_Stock_Price:  99.48202937048444
curr_Factors:  [99.48202937 -0.89174604 -0.8767628 ]
mat_Sqrt:  [[16.97035811  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154083  0.14981249 -1.23124712]
Stock Position:  -0.001540834900496874
Bond Position:  [-2.94755394]


portfolio before change:  [-3.10021181]
curr_Stock_Price:  98.8356424559028
curr_Factors:  [98.83564246 -0.76620625 -0.87704632]
mat_Sqrt:  [[19.10988463  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01975459 0.0615356  0.19841532]
Stock Position:  0.019754588624465157
Bond Position:  [-5.05266927]


portfolio before change:  [-3.09671148]
curr_Stock_Price:  99.04480650663409
curr_Factors:  [99.04480651 -0.65391178 -0.90662894]
mat_Sqrt:  [[20.80163564  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00036956 -0.00692789  0.17823171]
Stock Position:  0.0003695623406651374
Bond Position:  [-3.13331471]


portfolio before change:  [-3.09655555]
curr_Stock_Price:  100.52663010536374
curr_Factors:  [100.52663011  -0.85935056  -0.88923789]
mat_Sqrt:  [[17.49358468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00231582 -0.03753839 -0.50743471]
Stock Position:  -0.0023158178585466695
Bond Position:  [-2.86375418]


portfolio before change:  [-3.09553008]
curr_Stock_Price:  99.92923591903856
curr_Factors:  [99.92923592 -0.95773395 -0.89621446]
mat_Sqrt:  [[15.65067261  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0022925   0.00536042 -0.03567133]
Stock Position:  0.002292502503384646
Bond Position:  [-3.32461811]


portfolio before change:  [-3.09873729]
curr_Stock_Price:  98.71152705926254
curr_Factors:  [98.71152706 -0.94579652 -0.86991658]
mat_Sqrt:  [[16.06252031  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304797 -0.00629213  0.65403962]
Stock Position:  -0.0030479680120206938
Bond Position:  [-2.79786771]


portfolio before change:  [-3.09695502]
curr_Stock_Price:  98.01203857080863
curr_Factors:  [98.01203857 -1.00930724 -0.86540824]
mat_Sqrt:  [[15.03490999  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226482 -0.01061342 -0.00617193]
Stock Position:  -0.0022648241196298515
Bond Position:  [-2.87497499]


portfolio before change:  [-3.09881423]
curr_Stock_Price:  98.67426021057814
curr_Factors:  [98.67426021 -0.94443728 -0.88208636]
mat_Sqrt:  [[15.88381201  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00659794  0.0185808  -0.62786079]
Stock Position:  -0.0065979355716123365
Bond Position:  [-2.44776782]


portfolio before change:  [-3.0958045]
curr_Stock_Price:  98.17172134381221
curr_Factors:  [98.17172134 -0.86660274 -0.87257817]
mat_Sqrt:  [[17.24525934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00110256 -0.01307917  0.14325889]
Stock Position:  -0.0011025602397795819
Bond Position:  [-2.98756427]


portfolio before change:  [-3.09514218]
curr_Stock_Price:  97.23228043264385
curr_Factors:  [97.23228043 -0.73529706 -0.86600342]
mat_Sqrt:  [[19.605346    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047978  0.01013692 -0.11658124]
Stock Position:  -0.0004797803148479978
Bond Position:  [-3.04849205]


portfolio before change:  [-3.09500399]
curr_Stock_Price:  96.14995584828465
curr_Factors:  [96.14995585 -0.72125243 -0.80398104]
mat_Sqrt:  [[20.91937048  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00061398 -0.0072557  -0.01947833]
Stock Position:  -0.0006139786346364335
Bond Position:  [-3.03596997]


portfolio before change:  [-3.09363387]
curr_Stock_Price:  93.3002734982808
curr_Factors:  [93.3002735  -0.71789769 -0.80566396]
mat_Sqrt:  [[20.33332948  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00204543  0.01847084 -0.3455238 ]
Stock Position:  -0.0020454271166767553
Bond Position:  [-2.90279496]


portfolio before change:  [-3.0952613]
curr_Stock_Price:  93.91851133962102
curr_Factors:  [93.91851134 -0.71597262 -0.79293843]
mat_Sqrt:  [[20.77014172  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00081744  0.02018444 -0.1723648 ]
Stock Position:  -0.0008174409093324025
Bond Position:  [-3.01848847]


portfolio before change:  [-3.09600944]
curr_Stock_Price:  94.37213115934344
curr_Factors:  [94.37213116 -0.6730932  -0.78842752]
mat_Sqrt:  [[21.88332848  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00354556 -0.01364488  0.53438888]
Stock Position:  0.003545563957259766
Bond Position:  [-3.43061187]


portfolio before change:  [-3.09136196]
curr_Stock_Price:  95.80387302961329
curr_Factors:  [95.80387303 -0.63178872 -0.74316041]
mat_Sqrt:  [[24.22424473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332042  0.00021883 -0.0922214 ]
Stock Position:  -0.0033204197530529683
Bond Position:  [-2.77325289]


portfolio before change:  [-3.09083756]
curr_Stock_Price:  95.54153329927112
curr_Factors:  [95.5415333  -0.97428621 -0.73229401]
mat_Sqrt:  [[17.3393907   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01090892 -0.05125499 -0.34666055]
Stock Position:  -0.010908917360925348
Bond Position:  [-2.04858287]


portfolio before change:  [-3.09680019]
curr_Stock_Price:  96.06464115253942
curr_Factors:  [96.06464115 -0.92916512 -0.73343187]
mat_Sqrt:  [[18.2182587   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00628251 0.03376978 0.5160653 ]
Stock Position:  0.00628250943418611
Bond Position:  [-3.70032721]


portfolio before change:  [-3.10514012]
curr_Stock_Price:  94.81078559046571
curr_Factors:  [94.81078559 -0.77751681 -0.76555943]
mat_Sqrt:  [[20.26321024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.005692   -0.03982818 -0.50897027]
Stock Position:  0.005691999164110368
Bond Position:  [-3.64480303]


portfolio before change:  [-3.10061301]
curr_Stock_Price:  95.6861797786078
curr_Factors:  [95.68617978 -0.82594845 -0.75366286]
mat_Sqrt:  [[19.71663249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00565843 0.00084467 0.15875634]
Stock Position:  0.005658425144316019
Bond Position:  [-3.64204609]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.10166619]
Stock Price:  95.5805137133817
PL:  [-3.10166619]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-4.05892842e-01 -1.28933819e-01  2.71400019e-02]
 [-1.76333826e-02 -4.35943437e-03  1.97399722e-01]
 [-1.68271571e-01 -4.75988144e-02 -1.86125094e-01]
 [-3.82146287e-01 -1.56052610e-01 -2.32970648e-01]
 [ 1.93744830e-01 -2.00917361e-01 -1.04753786e-01]
 [-1.29401666e-01 -1.71456401e-01  5.45911835e-02]
 [-5.29053783e-02 -1.44936923e-01 -2.68326963e-02]
 [ 1.03281076e-02  6.57719637e-01  9.74976605e-02]
 [ 2.21237469e-01 -1.31799697e-02  2.42903992e-01]
 [ 5.35502890e-01  2.28298115e-01  4.24719526e-01]
 [-2.33831111e-01 -2.39333937e-01  2.44200915e-02]
 [-1.20308077e-02 -1.61233884e-02  1.01059478e-01]
 [ 1.48485125e-02 -5.63509855e-02  6.10169917e-02]
 [ 8.73255306e-03 -3.43905720e-02 -1.19034268e-01]
 [ 9.09270715e-02 -1.22356517e-01 -9.69095390e-02]
 [-1.51514664e-02 -3.66478968e-02  7.28620476e-02]
 [ 4.89698301e-02  2.13953279e-02 -1.33322193e-02]
 [-4.64889428e-02 -5.45779816e-02  4.32978044e-02]
 [ 6.63003110e-02 -2.77370810e-02 -1.03830374e-01]
 [ 1.79659372e-02  1.00143376e-02  2.65470578e-02]
 [-2.63022327e-02  4.26014000e-01 -4.00365925e-01]
 [ 2.36366799e-01  1.48541355e-01  8.38872610e-02]
 [-1.67678141e-02  2.66267236e-02  3.29880156e-02]
 [ 4.45548852e-02 -1.34538343e-01 -2.14951046e-01]
 [ 3.41414502e-02  1.71334334e-02 -1.25013854e-02]
 [-6.01575391e-02 -7.91691470e-03  1.78450170e-01]
 [-1.35799783e-02 -3.23225739e-02  2.86553053e-03]
 [-3.18808762e-02  6.43882393e-03 -2.66621541e-01]
 [-3.99291933e-02 -4.25548741e-02  3.27347829e-02]
 [-3.92422587e-02  1.81816413e-02 -9.56219104e-03]
 [-1.32046817e-02 -4.23602952e-02 -2.61378479e-02]
 [ 1.52178905e-02  9.04999625e-02 -7.71572340e-02]
 [-3.11434271e-02  2.99801838e-02 -5.73083775e-02]
 [ 2.87830191e-02 -4.70740861e-02  1.06462846e-01]
 [-6.86304535e-02  1.69252207e-03 -1.98363766e-02]
 [ 4.18359993e-02 -5.03979095e-02  7.21205194e-02]
 [-4.24030225e-02  9.45084304e-02  4.42180088e-02]
 [ 5.00468559e-02 -6.54382122e-02 -5.20040804e-02]
 [ 9.61821601e-02  5.76752616e-03  8.63406447e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.96617175]
curr_Stock_Price:  101.08075557771284
curr_Factors:  [101.08075558  -0.73907203  -0.97139333]
mat_Sqrt:  [[18.27354518  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02334913 -0.04161321  0.07742287]
Stock Position:  -0.023349131957753122
Bond Position:  [13.32631965]


portfolio before change:  [10.91864162]
curr_Stock_Price:  103.18772987325598
curr_Factors:  [103.18772987  -0.80601153  -0.97963153]
mat_Sqrt:  [[17.30346704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00125818 -0.001407    0.56312646]
Stock Position:  0.0012581756637954496
Bond Position:  [10.78881333]


portfolio before change:  [10.91901342]
curr_Stock_Price:  102.41129491431275
curr_Factors:  [102.41129491  -0.73470052  -0.93192436]
mat_Sqrt:  [[19.34380341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01116535 -0.01536245 -0.53096309]
Stock Position:  -0.011165346293750008
Bond Position:  [12.06247099]


portfolio before change:  [10.92329403]
curr_Stock_Price:  102.16296296447477
curr_Factors:  [102.16296296  -0.90981865  -0.91209152]
mat_Sqrt:  [[16.52144196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02793675 -0.05036576 -0.66460041]
Stock Position:  -0.02793674596528439
Bond Position:  [13.77739478]


portfolio before change:  [10.93347791]
curr_Stock_Price:  101.86007894028839
curr_Factors:  [101.86007894  -1.04753114  -0.92739927]
mat_Sqrt:  [[14.13522195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00929239 -0.0648458  -0.29883339]
Stock Position:  0.009292388099462201
Bond Position:  [9.98695452]


portfolio before change:  [10.9265842]
curr_Stock_Price:  100.98386121721697
curr_Factors:  [100.98386122  -1.1702537   -0.92822564]
mat_Sqrt:  [[12.3849419   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01237444 -0.05533732  0.15573345]
Stock Position:  -0.012374436640987512
Bond Position:  [12.17620259]


portfolio before change:  [10.92839162]
curr_Stock_Price:  100.960805926731
curr_Factors:  [100.96080593  -1.17670958  -0.95228247]
mat_Sqrt:  [[12.01000838  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00732453 -0.04677819 -0.07654621]
Stock Position:  -0.007324533204492721
Bond Position:  [11.66788239]


portfolio before change:  [10.92474703]
curr_Stock_Price:  101.65752788852782
curr_Factors:  [101.65752789  -1.25807067  -0.94226039]
mat_Sqrt:  [[11.26024677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01460769 0.2122781  0.27813369]
Stock Position:  0.014607689885809821
Bond Position:  [9.43976539]


portfolio before change:  [10.92232]
curr_Stock_Price:  101.41059830731129
curr_Factors:  [101.41059831  -1.26530888  -0.94616425]
mat_Sqrt:  [[11.10843224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02413749 -0.00425382  0.69293748]
Stock Position:  0.02413749149228699
Bond Position:  [8.47452255]


portfolio before change:  [10.93380402]
curr_Stock_Price:  101.84248365384153
curr_Factors:  [101.84248365  -1.09720002  -0.97759849]
mat_Sqrt:  [[12.78955514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05229264 0.0736829  1.21160659]
Stock Position:  0.05229263646731817
Bond Position:  [5.60819204]


portfolio before change:  [10.91571812]
curr_Stock_Price:  101.48321773274645
curr_Factors:  [101.48321773  -0.9557041   -0.95286264]
mat_Sqrt:  [[15.04922811  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01845279 -0.0772447   0.06966372]
Stock Position:  -0.018452787995732113
Bond Position:  [12.78836642]


portfolio before change:  [10.90034222]
curr_Stock_Price:  102.40310842959978
curr_Factors:  [102.40310843  -1.01580005  -0.94955532]
mat_Sqrt:  [[14.34729907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00036987 -0.0052038   0.28829456]
Stock Position:  0.0003698744273611541
Bond Position:  [10.86246593]


portfolio before change:  [10.90145247]
curr_Stock_Price:  101.73358773112182
curr_Factors:  [101.73358773  -1.23111301  -0.92264074]
mat_Sqrt:  [[11.80595145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00133839 -0.0181872   0.17406449]
Stock Position:  0.001338389124579318
Bond Position:  [10.76529335]


portfolio before change:  [10.90204936]
curr_Stock_Price:  101.17406625096777
curr_Factors:  [101.17406625  -0.83931419  -0.93914622]
mat_Sqrt:  [[17.08809548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132169 -0.01109951 -0.33957163]
Stock Position:  -0.0013216897812501436
Bond Position:  [11.03577009]


portfolio before change:  [10.90381744]
curr_Stock_Price:  100.88010733339848
curr_Factors:  [100.88010733  -0.91273317  -0.9349862 ]
mat_Sqrt:  [[15.8983191   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00290405 -0.0394904  -0.27645594]
Stock Position:  0.0029040538826181806
Bond Position:  [10.61085617]


portfolio before change:  [10.90340471]
curr_Stock_Price:  100.28123049030977
curr_Factors:  [100.28123049  -0.80164667  -0.93746891]
mat_Sqrt:  [[17.61697575  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044044 -0.01182806  0.20785514]
Stock Position:  -0.00044044358014434516
Bond Position:  [10.94757293]


portfolio before change:  [10.90431813]
curr_Stock_Price:  101.31453173238785
curr_Factors:  [101.31453173  -1.09601179  -0.93354386]
mat_Sqrt:  [[13.31211085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00380223  0.00690531 -0.03803311]
Stock Position:  0.003802229851335183
Bond Position:  [10.519097]


portfolio before change:  [10.9052703]
curr_Stock_Price:  101.21911361288203
curr_Factors:  [101.21911361  -1.07856634  -0.93476974]
mat_Sqrt:  [[13.51704558  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00360963 -0.01761497  0.12351658]
Stock Position:  -0.003609627495445359
Bond Position:  [11.2706336]


portfolio before change:  [10.90959677]
curr_Stock_Price:  100.41084309058975
curr_Factors:  [100.41084309  -0.90295677  -0.94407096]
mat_Sqrt:  [[15.83531351  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0024909  -0.0089521  -0.29619916]
Stock Position:  0.002490902167109313
Bond Position:  [10.65948319]


portfolio before change:  [10.91198415]
curr_Stock_Price:  100.83432835346974
curr_Factors:  [100.83432835  -0.9622002   -0.9495873 ]
mat_Sqrt:  [[14.90491993  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00170608 0.00323211 0.07573137]
Stock Position:  0.0017060810076681497
Bond Position:  [10.73995262]


portfolio before change:  [10.91337642]
curr_Stock_Price:  100.86345358594305
curr_Factors:  [100.86345359  -1.24679316  -0.96922116]
mat_Sqrt:  [[10.9984388   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191544  0.13749543 -1.14213254]
Stock Position:  -0.00191543925512579
Bond Position:  [11.10657424]


portfolio before change:  [10.91459201]
curr_Stock_Price:  100.95367901796496
curr_Factors:  [100.95367902  -1.20592622  -0.98328563]
mat_Sqrt:  [[11.30731584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02509978 0.04794152 0.23930701]
Stock Position:  0.025099775755265737
Bond Position:  [8.3806773]


portfolio before change:  [10.91397077]
curr_Stock_Price:  100.8871890866333
curr_Factors:  [100.88718909  -1.28039606  -0.98803482]
mat_Sqrt:  [[10.43924297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044055  0.00859374  0.09410563]
Stock Position:  -0.0004405498027115754
Bond Position:  [10.95841661]


portfolio before change:  [10.91530026]
curr_Stock_Price:  100.97890405025811
curr_Factors:  [100.97890405  -1.14847787  -0.98362233]
mat_Sqrt:  [[11.97488358  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223671 -0.04342206 -0.6131955 ]
Stock Position:  -0.0022367096361044538
Bond Position:  [11.14116074]


portfolio before change:  [10.91970156]
curr_Stock_Price:  99.6338157352056
curr_Factors:  [99.63381574 -1.03427014 -0.95800684]
mat_Sqrt:  [[13.58851085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00258211  0.00552979 -0.03566297]
Stock Position:  0.002582105093099175
Bond Position:  [10.66243658]


portfolio before change:  [10.92128759]
curr_Stock_Price:  99.73185164852043
curr_Factors:  [99.73185165 -1.12951541 -0.94513784]
mat_Sqrt:  [[12.52631782  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202355 -0.00255517  0.50906866]
Stock Position:  -0.0020235463061705566
Bond Position:  [11.12309961]


portfolio before change:  [10.92359888]
curr_Stock_Price:  99.27680066662593
curr_Factors:  [99.27680067 -1.04354269 -0.93391787]
mat_Sqrt:  [[13.74192468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00142577 -0.01043207  0.00817456]
Stock Position:  -0.0014257735072997326
Bond Position:  [11.06514511]


portfolio before change:  [10.92429939]
curr_Stock_Price:  99.75564481463874
curr_Factors:  [99.75564481 -0.94707498 -0.9168951 ]
mat_Sqrt:  [[15.46769368  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00549471  0.00207812 -0.76059704]
Stock Position:  -0.00549470740254994
Bond Position:  [11.47242747]


portfolio before change:  [10.9259923]
curr_Stock_Price:  99.70855072710023
curr_Factors:  [99.70855073 -0.897963   -0.92295441]
mat_Sqrt:  [[16.1405385   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259804 -0.01373453  0.09338322]
Stock Position:  -0.0025980366761895733
Bond Position:  [11.18503877]


portfolio before change:  [10.93052798]
curr_Stock_Price:  98.50092303007956
curr_Factors:  [98.50092303 -0.69691947 -0.91604161]
mat_Sqrt:  [[19.6308996   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190938  0.0058681  -0.02727827]
Stock Position:  -0.0019093786590519408
Bond Position:  [11.11860354]


portfolio before change:  [10.93085762]
curr_Stock_Price:  99.05621917072364
curr_Factors:  [99.05621917 -0.81462558 -0.90994021]
mat_Sqrt:  [[17.65681401  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00153973 -0.01367173 -0.074564  ]
Stock Position:  -0.0015397345518016422
Bond Position:  [11.0833779]


portfolio before change:  [10.93302933]
curr_Stock_Price:  98.54561030194603
curr_Factors:  [98.5456103  -0.79585628 -0.91978914]
mat_Sqrt:  [[17.72319209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00101232  0.02920874 -0.22010811]
Stock Position:  0.0010123155842915936
Bond Position:  [10.83327007]


portfolio before change:  [10.93357106]
curr_Stock_Price:  97.74298803719302
curr_Factors:  [97.74298804 -0.96114054 -0.94265094]
mat_Sqrt:  [[14.56396002  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252141  0.00967606 -0.16348485]
Stock Position:  -0.0025214139006911173
Bond Position:  [11.18002159]


portfolio before change:  [10.93187198]
curr_Stock_Price:  98.97113694084348
curr_Factors:  [98.97113694 -1.08448979 -0.94316359]
mat_Sqrt:  [[13.02896405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0031396  -0.0151931   0.30370886]
Stock Position:  0.003139597189678136
Bond Position:  [10.62114248]


portfolio before change:  [10.93155858]
curr_Stock_Price:  98.44841837794247
curr_Factors:  [98.44841838 -1.20486258 -0.93415886]
mat_Sqrt:  [[11.59427342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00623877  0.00054626 -0.05658766]
Stock Position:  -0.006238774058931281
Bond Position:  [11.54575602]


portfolio before change:  [10.93234193]
curr_Stock_Price:  98.55420194347774
curr_Factors:  [98.55420194 -1.32913511 -0.94917862]
mat_Sqrt:  [[10.09755116  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00458231 -0.01626586  0.20573977]
Stock Position:  0.004582309883972145
Bond Position:  [10.48073604]


portfolio before change:  [10.93457145]
curr_Stock_Price:  98.7548298377518
curr_Factors:  [98.75482984 -1.21071594 -0.9449536 ]
mat_Sqrt:  [[11.43833885  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00123144  0.03050246  0.12614167]
Stock Position:  -0.001231438138013085
Bond Position:  [11.05618191]


portfolio before change:  [10.93589413]
curr_Stock_Price:  98.80308732180838
curr_Factors:  [98.80308732 -1.43291885 -0.94630313]
mat_Sqrt:  [[ 9.1514      0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00284919 -0.02112009 -0.14835317]
Stock Position:  0.002849186826876017
Bond Position:  [10.65438567]


portfolio before change:  [10.9376827]
curr_Stock_Price:  98.96337469890302
curr_Factors:  [98.9633747  -1.56091334 -0.94201424]
mat_Sqrt:  [[ 8.09966132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01419611 0.00186146 0.24630583]
Stock Position:  0.014196107368169756
Bond Position:  [9.53278801]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.93681849]
Stock Price:  98.81855449200155
PL:  [10.93681849]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-6.98493597e-02 -8.63001108e-02  1.40203042e-02]
 [-7.64687326e-02  7.30139086e-02 -7.05916692e-02]
 [ 2.49264148e-03  8.40362323e-03  4.82502171e-02]
 [ 7.25051606e-02  9.12274078e-02  5.35525094e-02]
 [ 8.06716053e-02 -2.64542580e-02 -8.03033852e-02]
 [-1.29782807e-01 -1.66066589e-01  8.50617915e-02]
 [-5.50981211e-02 -1.57548170e-01  1.81251781e-02]
 [-1.67333491e-02  7.30518204e-01  1.42202453e-01]
 [ 3.81651084e-01  3.52418993e-02  3.71045386e-01]
 [ 3.56389905e-01  1.34043576e-01  2.10362136e-01]
 [-1.97618217e-01 -2.44811116e-01  1.21833857e-02]
 [-9.58100014e-02 -2.00259460e-02  8.51353854e-02]
 [-3.20123500e-02  1.61489992e-01 -5.98389245e-02]
 [ 8.34216051e-03 -9.20919220e-02  5.50383986e-02]
 [-7.77119272e-02  1.96646088e-01 -4.01345175e-02]
 [-3.20572968e-02 -3.85077555e-02  1.20745954e-02]
 [ 6.13686286e-02  2.61949391e-02 -8.16899164e-02]
 [-6.51811290e-02 -6.56347921e-02  1.66833835e-02]
 [ 5.46659047e-02  5.69773103e-02 -2.43502202e-01]
 [-6.38840907e-03  3.08084170e-02 -6.31910205e-02]
 [-3.95658268e-02  5.18181764e-01 -4.91804044e-01]
 [ 3.27216841e-01  1.92012794e-01  6.90929720e-02]
 [ 6.83844834e-03  9.25340025e-02 -5.97509376e-03]
 [ 2.87366679e-02 -1.54006383e-01 -1.72964056e-01]
 [ 3.80274039e-02 -1.20360939e-02 -1.18599435e-02]
 [-4.12046136e-03  1.82400762e-02  1.85841163e-02]
 [ 8.99719039e-02 -2.10922135e-02  9.15108557e-02]
 [ 1.66312865e-01 -5.41023589e-02  2.08850865e-01]
 [-4.18873318e-02 -1.31160522e-03 -5.86609711e-02]
 [-6.22922145e-02 -1.39480905e-02  3.90011852e-02]
 [-3.48577034e-02 -5.03471306e-02 -2.18555325e-02]
 [ 2.60573895e-02 -1.57030576e-02 -5.61433634e-02]
 [ 3.11296962e-02  7.29789163e-03  1.50957976e-01]
 [ 1.16942384e-02 -6.94123200e-02 -8.77784768e-03]
 [-4.41150639e-02  4.45692723e-02  2.24321884e-02]
 [ 1.22138155e-02 -6.16663620e-02  4.29217867e-02]
 [-4.87149274e-02  9.88022079e-02  4.57102305e-02]
 [ 1.39769511e-01 -1.09598971e-01 -1.30321769e-01]
 [ 9.81834414e-02  3.53881250e-03  6.44580369e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.02090891]
curr_Stock_Price:  100.07907686487289
curr_Factors:  [100.07907686  -0.87987933  -0.99751906]
mat_Sqrt:  [[15.310858    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00552571 -0.02785324  0.03999603]
Stock Position:  -0.00552571341233015
Bond Position:  [3.57391721]


portfolio before change:  [3.01675134]
curr_Stock_Price:  100.9123333040957
curr_Factors:  [100.9123333   -0.76959736  -1.01123544]
mat_Sqrt:  [[17.0035026   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00446816  0.02356514 -0.20137838]
Stock Position:  -0.004468155580120108
Bond Position:  [3.46764335]


portfolio before change:  [3.01937373]
curr_Stock_Price:  100.4224440817673
curr_Factors:  [100.42244408  -0.7503296   -1.02339722]
mat_Sqrt:  [[17.04162544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00082487 0.00271226 0.13764444]
Stock Position:  0.000824866046868037
Bond Position:  [2.93653866]


portfolio before change:  [3.01888531]
curr_Stock_Price:  99.38529708398637
curr_Factors:  [99.38529708 -0.77309786 -1.04328825]
mat_Sqrt:  [[16.16127701  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00631499 0.02944352 0.1527704 ]
Stock Position:  0.006314985960241921
Bond Position:  [2.39126855]


portfolio before change:  [3.02641496]
curr_Stock_Price:  100.53030680861612
curr_Factors:  [100.53030681  -0.77912205  -1.03125442]
mat_Sqrt:  [[16.44600804  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00358019 -0.00853808 -0.22908321]
Stock Position:  0.00358018751092605
Bond Position:  [2.66649761]


portfolio before change:  [3.02649389]
curr_Stock_Price:  100.45924827699142
curr_Factors:  [100.45924828  -0.89685307  -1.01519144]
mat_Sqrt:  [[14.84566119  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00985593 -0.05359776  0.24265761]
Stock Position:  -0.009855933001053679
Bond Position:  [4.01661351]


portfolio before change:  [3.02447203]
curr_Stock_Price:  100.71533376302978
curr_Factors:  [100.71533376  -0.71192039  -1.01306611]
mat_Sqrt:  [[17.94500065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00465632 -0.05084845  0.05170609]
Stock Position:  -0.004656323045470528
Bond Position:  [3.49343516]


portfolio before change:  [3.02402646]
curr_Stock_Price:  100.9048147245778
curr_Factors:  [100.90481472  -0.45561383  -0.99852601]
mat_Sqrt:  [[23.571487    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00684768 0.23577374 0.40566402]
Stock Position:  0.006847680380262539
Bond Position:  [2.33306254]


portfolio before change:  [3.02188551]
curr_Stock_Price:  100.54957070582434
curr_Factors:  [100.54957071  -0.43520054  -0.995397  ]
mat_Sqrt:  [[24.04803545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01931901 0.01137427 1.05848921]
Stock Position:  0.019319005470393565
Bond Position:  [1.0793678]


portfolio before change:  [2.97550425]
curr_Stock_Price:  98.14177656504941
curr_Factors:  [98.14177657 -0.37241354 -0.97193326]
mat_Sqrt:  [[25.58653732  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0166764  0.04326238 0.60010462]
Stock Position:  0.016676403718951766
Bond Position:  [1.33885236]


portfolio before change:  [2.95572289]
curr_Stock_Price:  96.94555158251954
curr_Factors:  [96.94555158 -0.43222436 -0.9760346 ]
mat_Sqrt:  [[23.70984919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01033761 -0.07901245  0.03475581]
Stock Position:  -0.010337609117076886
Bond Position:  [3.95790811]


portfolio before change:  [2.96280965]
curr_Stock_Price:  96.30788086572518
curr_Factors:  [96.30788087 -0.34469484 -0.93063652]
mat_Sqrt:  [[26.90248856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306736 -0.00646335  0.24286756]
Stock Position:  -0.0030673590869001468
Bond Position:  [3.2582205]


portfolio before change:  [2.96114494]
curr_Stock_Price:  96.98338431341739
curr_Factors:  [96.98338431 -0.36334113 -0.94839373]
mat_Sqrt:  [[26.12270369  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043115  0.05212067 -0.1707038 ]
Stock Position:  -0.0004311541771519961
Bond Position:  [3.00295973]


portfolio before change:  [2.96090581]
curr_Stock_Price:  98.4086692854367
curr_Factors:  [98.40866929 -0.36548573 -0.95873175]
mat_Sqrt:  [[26.177792    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.97443616e-05 -2.97225400e-02  1.57009231e-01]
Stock Position:  2.9744361595632172e-05
Bond Position:  [2.95797871]


portfolio before change:  [2.96124009]
curr_Stock_Price:  97.21528781168774
curr_Factors:  [97.21528781 -0.26902536 -0.97168687]
mat_Sqrt:  [[28.11254017  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162789  0.06346725 -0.11449261]
Stock Position:  -0.0016278904850204742
Bond Position:  [3.11949593]


portfolio before change:  [2.96306034]
curr_Stock_Price:  96.33666957541342
curr_Factors:  [96.33666958 -0.19872197 -0.96882178]
mat_Sqrt:  [[29.9732489   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124955 -0.01242832  0.03444546]
Stock Position:  -0.001249545656895406
Bond Position:  [3.08343741]


portfolio before change:  [2.96047783]
curr_Stock_Price:  98.71190416642234
curr_Factors:  [98.71190417 -0.3252599  -0.97346232]
mat_Sqrt:  [[26.93652929  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00185773  0.00845438 -0.23303859]
Stock Position:  0.001857728709724389
Bond Position:  [2.7770979]


portfolio before change:  [2.96373521]
curr_Stock_Price:  100.2784475551904
curr_Factors:  [100.27844756  -0.51998092  -1.01595152]
mat_Sqrt:  [[21.58542581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00348259 -0.02118354  0.04759305]
Stock Position:  -0.00348259487971536
Bond Position:  [3.31296441]


portfolio before change:  [2.96553537]
curr_Stock_Price:  99.88046355860956
curr_Factors:  [99.88046356 -0.2723883  -1.00840119]
mat_Sqrt:  [[27.74857875  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.97928664e-04  1.83893478e-02 -6.94644004e-01]
Stock Position:  0.0005979286641646669
Bond Position:  [2.90581398]


portfolio before change:  [2.96587203]
curr_Stock_Price:  99.83599034467994
curr_Factors:  [99.83599034 -0.55657426 -0.99343651]
mat_Sqrt:  [[21.1897584   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00061343  0.00994337 -0.18026639]
Stock Position:  -0.000613432210538635
Bond Position:  [3.02711464]


portfolio before change:  [2.96629534]
curr_Stock_Price:  99.76279143488293
curr_Factors:  [99.76279143 -0.63390188 -1.0165652 ]
mat_Sqrt:  [[19.1504881   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00178489  0.16724245 -1.40298004]
Stock Position:  -0.0017848890904577162
Bond Position:  [3.14436086]


portfolio before change:  [2.96373482]
curr_Stock_Price:  101.41756999279764
curr_Factors:  [101.41756999  -0.79403996  -0.99908188]
mat_Sqrt:  [[16.87991593  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02254246 0.06197186 0.19710302]
Stock Position:  0.022542460154520643
Bond Position:  [0.67753329]


portfolio before change:  [2.97941862]
curr_Stock_Price:  102.1095576143384
curr_Factors:  [102.10955761  -0.9906563   -1.02682155]
mat_Sqrt:  [[13.57959758  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00180471  0.02986522 -0.01704528]
Stock Position:  0.0018047082370671313
Bond Position:  [2.79514066]


portfolio before change:  [2.98296253]
curr_Stock_Price:  103.87965035911849
curr_Factors:  [103.87965036  -1.05719373  -1.01790585]
mat_Sqrt:  [[13.04145913  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291424 -0.04970535 -0.49341831]
Stock Position:  -0.0029142362783675557
Bond Position:  [3.28569238]


portfolio before change:  [2.98160835]
curr_Stock_Price:  104.48527053290763
curr_Factors:  [104.48527053  -1.24503169  -1.07385355]
mat_Sqrt:  [[10.27959506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0032248  -0.00388463 -0.03383312]
Stock Position:  0.0032248007383325495
Bond Position:  [2.64466417]


portfolio before change:  [2.9819529]
curr_Stock_Price:  104.4895951371965
curr_Factors:  [104.48959514  -1.07817685  -1.08042926]
mat_Sqrt:  [[12.06708373  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00028145 0.00588696 0.05301531]
Stock Position:  0.0002814470788195121
Bond Position:  [2.95254461]


portfolio before change:  [2.98246292]
curr_Stock_Price:  104.99033859993907
curr_Factors:  [104.9903386   -1.15574517  -1.08287986]
mat_Sqrt:  [[11.19249317  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00932286 -0.00680748  0.261055  ]
Stock Position:  0.009322860200777548
Bond Position:  [2.00365267]


portfolio before change:  [2.9803672]
curr_Stock_Price:  104.73867827694029
curr_Factors:  [104.73867828  -1.16682699  -1.02968913]
mat_Sqrt:  [[11.64587859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0169932  -0.01746146  0.59579339]
Stock Position:  0.016993202341673033
Bond Position:  [1.20052165]


portfolio before change:  [2.97854648]
curr_Stock_Price:  104.62270284622006
curr_Factors:  [104.62270285  -1.19735706  -1.00985482]
mat_Sqrt:  [[11.50922282  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00470311 -0.00042332 -0.16734342]
Stock Position:  -0.004703113627811221
Bond Position:  [3.47059894]


portfolio before change:  [2.98320739]
curr_Stock_Price:  103.72392487271794
curr_Factors:  [103.72392487  -1.17940189  -0.99750144]
mat_Sqrt:  [[11.76147639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00486149 -0.00450173  0.11125953]
Stock Position:  -0.004861487712975788
Bond Position:  [3.48745997]


portfolio before change:  [2.98663983]
curr_Stock_Price:  103.10755387797445
curr_Factors:  [103.10755388  -0.94906487  -0.98075724]
mat_Sqrt:  [[14.96853824  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331335 -0.01624947 -0.06234775]
Stock Position:  -0.003313350276205833
Bond Position:  [3.32827127]


portfolio before change:  [2.99120503]
curr_Stock_Price:  101.85530463526845
curr_Factors:  [101.85530464  -0.94660332  -0.97602131]
mat_Sqrt:  [[14.89355542  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00076488 -0.00506814 -0.16016139]
Stock Position:  0.0007648811787592162
Bond Position:  [2.91329782]


portfolio before change:  [2.99213445]
curr_Stock_Price:  102.59428728778836
curr_Factors:  [102.59428729  -1.09169345  -1.00845396]
mat_Sqrt:  [[12.56147817  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00504985 0.00235538 0.43064109]
Stock Position:  0.0050498467681171985
Bond Position:  [2.47404902]


portfolio before change:  [2.98698104]
curr_Stock_Price:  101.51253531882223
curr_Factors:  [101.51253532  -0.98891529  -0.9994166 ]
mat_Sqrt:  [[13.8994658   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030694 -0.02240273 -0.02504076]
Stock Position:  -0.0003069371754081608
Bond Position:  [3.01813901]


portfolio before change:  [2.98757862]
curr_Stock_Price:  100.79483368804163
curr_Factors:  [100.79483369  -0.69196565  -0.97312754]
mat_Sqrt:  [[19.06766393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00159634  0.01438467  0.06399279]
Stock Position:  -0.0015963386026518172
Bond Position:  [3.1484813]


portfolio before change:  [2.99227644]
curr_Stock_Price:  98.09851767223375
curr_Factors:  [98.09851767 -0.73237888 -0.9359251 ]
mat_Sqrt:  [[18.49810476  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00045343 -0.01990273  0.12244391]
Stock Position:  0.0004534299684103548
Bond Position:  [2.94779563]


portfolio before change:  [2.99281104]
curr_Stock_Price:  98.46484957581912
curr_Factors:  [98.46484958 -0.77405477 -0.93784377]
mat_Sqrt:  [[17.77514418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108109  0.03188828  0.13039856]
Stock Position:  -0.0010810854345533146
Bond Position:  [3.09925996]


portfolio before change:  [2.99470356]
curr_Stock_Price:  97.07265535306348
curr_Factors:  [97.07265535 -0.76696812 -0.97188697]
mat_Sqrt:  [[17.05774978  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00532285 -0.03537292 -0.37177173]
Stock Position:  0.005322853025924977
Bond Position:  [2.47800008]


portfolio before change:  [2.99723617]
curr_Stock_Price:  97.49025867883134
curr_Factors:  [97.49025868 -0.91618349 -0.97122368]
mat_Sqrt:  [[14.76626654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00758914 0.00114215 0.18388084]
Stock Position:  0.007589138377579546
Bond Position:  [2.2573691]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.00131917]
Stock Price:  97.99108191767459
PL:  [3.00131917]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.53000424e-01 -9.86051464e-02  2.46381346e-02]
 [-1.72793948e-01  8.60254917e-02 -3.14578145e-01]
 [-4.93406640e-03  1.62638308e-02  4.30002411e-02]
 [-2.40706200e-01 -1.45424141e-01 -1.53371351e-01]
 [ 2.01244379e-01 -2.08172729e-01 -1.04858517e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.29074562e-02 -1.44847382e-01 -2.68305242e-02]
 [ 1.33244362e-02  6.20072577e-01  8.54499267e-02]
 [ 2.63439815e-01 -1.35731277e-02  2.79070222e-01]
 [ 5.22984392e-01  2.21547761e-01  4.09212503e-01]
 [-1.86383950e-01 -1.82195922e-01  5.22876979e-02]
 [-7.14725595e-02 -1.91839192e-02  8.81523816e-02]
 [ 3.79983149e-03 -5.42123044e-02  1.43285707e-01]
 [ 9.63287291e-03 -8.99530668e-02 -2.44386581e-02]
 [-4.56620824e-02  1.15890019e-01 -4.15498379e-02]
 [ 1.07271658e-01 -1.86999858e-03 -1.34778909e-02]
 [ 5.40165772e-02  1.23376677e-02 -4.28494602e-02]
 [-5.43908644e-02 -6.33600126e-02  6.91501190e-03]
 [ 6.29152024e-02  5.27623116e-02 -2.67026563e-01]
 [-7.22340401e-03  2.87602387e-02 -6.15494806e-02]
 [-3.81152575e-02  5.13235690e-01 -4.91774042e-01]
 [ 2.44638724e-01  1.52499443e-01  8.25402365e-02]
 [-2.32079829e-03 -1.50468809e-02  5.85582489e-02]
 [-2.40744452e-02 -7.56085091e-02 -7.71684680e-02]
 [ 2.00419218e-03  1.86529743e-02 -9.43689065e-03]
 [-1.10225440e-01 -1.79428216e-02  2.21403472e-01]
 [-3.25014565e-02 -3.31263191e-02 -4.31928985e-03]
 [-1.06944961e-02 -1.61200726e-02 -2.74294642e-01]
 [-5.55860595e-02 -3.35926796e-02 -9.10678113e-04]
 [-7.97926664e-02  2.93689357e-03  2.88865408e-02]
 [ 2.37247046e-02 -1.83352262e-02  1.97893467e-02]
 [ 2.10554954e-02  1.22165324e-01 -8.87190388e-02]
 [-2.35057188e-02  5.44246010e-02 -7.87362183e-02]
 [ 8.20914554e-03 -9.34497026e-02  1.02567358e-01]
 [-8.17261651e-02  8.55026798e-02 -1.03471358e-01]
 [-1.91114994e-01 -1.92404862e-01 -1.73014503e-01]
 [ 1.15290466e-01  1.25582069e-01  3.22609336e-01]
 [ 2.12572608e-01 -1.45884500e-01 -2.66109640e-01]
 [ 9.29414135e-02  6.78638113e-03  9.54898002e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.6526307]
curr_Stock_Price:  100.91515424559245
curr_Factors:  [100.91515425  -1.09671965  -0.99567414]
mat_Sqrt:  [[12.452063    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02153048 -0.03182467  0.07028574]
Stock Position:  -0.021530478710292945
Bond Position:  [11.82538228]


portfolio before change:  [9.65965218]
curr_Stock_Price:  100.65769542916057
curr_Factors:  [100.65769543  -1.24498089  -1.02791419]
mat_Sqrt:  [[10.36910312  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02116355  0.02776461 -0.89740389]
Stock Position:  -0.02116355293846007
Bond Position:  [11.78992664]


portfolio before change:  [9.66022104]
curr_Stock_Price:  100.70045615338371
curr_Factors:  [100.70045615  -1.24198942  -1.01821755]
mat_Sqrt:  [[10.50596674  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00068182 0.00524913 0.12266772]
Stock Position:  0.0006818184165686946
Bond Position:  [9.59156161]


portfolio before change:  [9.66185698]
curr_Stock_Price:  101.34127436836015
curr_Factors:  [101.34127437  -1.32350898  -1.04965797]
mat_Sqrt:  [[ 9.44350142  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03194764 -0.04693544 -0.43752577]
Stock Position:  -0.03194763899386267
Bond Position:  [12.89947143]


portfolio before change:  [9.64798324]
curr_Stock_Price:  101.82601369199139
curr_Factors:  [101.82601369  -1.30671945  -1.00838721]
mat_Sqrt:  [[10.05589417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01365837 -0.06718746 -0.29913216]
Stock Position:  0.013658371996498069
Bond Position:  [8.25720566]


portfolio before change:  [9.6404638]
curr_Stock_Price:  101.1999026493938
curr_Factors:  [101.19990265  -1.08975119  -0.99830084]
mat_Sqrt:  [[12.54153285  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01222372 -0.05534923  0.15513819]
Stock Position:  -0.012223720814227729
Bond Position:  [10.87750315]


portfolio before change:  [9.64535156]
curr_Stock_Price:  100.91128401850715
curr_Factors:  [100.91128402  -0.98760212  -1.01252092]
mat_Sqrt:  [[13.65517694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00644086 -0.04674929 -0.07654002]
Stock Position:  -0.006440858464873891
Bond Position:  [10.29530686]


portfolio before change:  [9.64452549]
curr_Stock_Price:  101.23935560896463
curr_Factors:  [101.23935561  -1.12326826  -1.04337011]
mat_Sqrt:  [[11.5981917   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01356579 0.20012756 0.24376486]
Stock Position:  0.013565788381686823
Bond Position:  [8.27113382]


portfolio before change:  [9.6422505]
curr_Stock_Price:  100.99543653519618
curr_Factors:  [100.99543654  -1.10215006  -1.05760848]
mat_Sqrt:  [[11.65012367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02726445 -0.00438071  0.79610966]
Stock Position:  0.027264447302342967
Bond Position:  [6.88866574]


portfolio before change:  [9.6670305]
curr_Stock_Price:  101.87272818886993
curr_Factors:  [101.87272819  -1.07253454  -1.07428849]
mat_Sqrt:  [[11.90431856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05474801 0.07150423 1.16736937]
Stock Position:  0.05474801336231243
Bond Position:  [4.08970102]


portfolio before change:  [9.58039664]
curr_Stock_Price:  100.28097886470522
curr_Factors:  [100.28097886  -0.80959036  -1.02700716]
mat_Sqrt:  [[15.98064842  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01332245 -0.05880348  0.14916225]
Stock Position:  -0.013322447857461726
Bond Position:  [10.91638475]


portfolio before change:  [9.58285372]
curr_Stock_Price:  100.19897781640015
curr_Factors:  [100.19897782  -0.60336752  -1.02362716]
mat_Sqrt:  [[19.69103201  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291475 -0.00619158  0.25147421]
Stock Position:  -0.0029147497721734653
Bond Position:  [9.87490867]


portfolio before change:  [9.58444778]
curr_Stock_Price:  100.07559857018153
curr_Factors:  [100.07559857  -0.46834796  -1.02778595]
mat_Sqrt:  [[22.41638072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00098062 -0.01749695  0.40875424]
Stock Position:  0.0009806160906610012
Bond Position:  [9.48631204]


portfolio before change:  [9.58506118]
curr_Stock_Price:  99.49181867601142
curr_Factors:  [99.49181868 -0.54498452 -1.03570542]
mat_Sqrt:  [[20.4787033   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066983 -0.02903223 -0.06971669]
Stock Position:  -0.0006698295268156021
Bond Position:  [9.65170374]


portfolio before change:  [9.58675567]
curr_Stock_Price:  98.76334635262063
curr_Factors:  [98.76334635 -0.52351095 -1.02950987]
mat_Sqrt:  [[20.89909232  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00145879  0.03740334 -0.11853012]
Stock Position:  -0.0014587933319376088
Bond Position:  [9.73083099]


portfolio before change:  [9.58808024]
curr_Stock_Price:  98.68921948894663
curr_Factors:  [98.68921949 -0.41926648 -1.05511406]
mat_Sqrt:  [[22.59198451  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00460955 -0.00060354 -0.03844867]
Stock Position:  0.004609545620409517
Bond Position:  [9.13316778]


portfolio before change:  [9.59288925]
curr_Stock_Price:  99.48480606704516
curr_Factors:  [99.48480607 -0.25286525 -1.05056017]
mat_Sqrt:  [[27.02005877  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00176863  0.00398197 -0.12223758]
Stock Position:  0.00176862619323098
Bond Position:  [9.41693782]


portfolio before change:  [9.59421635]
curr_Stock_Price:  99.56956595036573
curr_Factors:  [99.56956595 -0.21073631 -1.0895828 ]
mat_Sqrt:  [[27.12721443  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242976 -0.02044936  0.0197266 ]
Stock Position:  -0.0024297611577156456
Bond Position:  [9.83614661]


portfolio before change:  [9.59595956]
curr_Stock_Price:  99.35818185843854
curr_Factors:  [99.35818186 -0.34746381 -1.10119929]
mat_Sqrt:  [[23.33765647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00082179  0.01702896 -0.76175246]
Stock Position:  0.000821791818379491
Bond Position:  [9.51430782]


portfolio before change:  [9.59806423]
curr_Stock_Price:  100.47197901491744
curr_Factors:  [100.47197901  -0.48621109  -1.09948898]
mat_Sqrt:  [[20.57710002  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00067631  0.00928233 -0.17558354]
Stock Position:  -0.0006763091000035705
Bond Position:  [9.66601434]


portfolio before change:  [9.59925322]
curr_Stock_Price:  100.50057708229079
curr_Factors:  [100.50057708  -0.74100466  -1.09236275]
mat_Sqrt:  [[16.06745915  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209955  0.16564611 -1.40289446]
Stock Position:  -0.0020995489462965937
Bond Position:  [9.8102591]


portfolio before change:  [9.59920564]
curr_Stock_Price:  101.10734506063338
curr_Factors:  [101.10734506  -0.74443846  -1.07878939]
mat_Sqrt:  [[16.32920022  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0179198  0.04921898 0.23546432]
Stock Position:  0.017919799719754888
Bond Position:  [7.78738226]


portfolio before change:  [9.5722076]
curr_Stock_Price:  99.5464169982476
curr_Factors:  [99.546417   -0.52362948 -1.06001966]
mat_Sqrt:  [[20.42939708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00032115 -0.00485636  0.16705038]
Stock Position:  0.0003211510589227355
Bond Position:  [9.54023816]


portfolio before change:  [9.57341492]
curr_Stock_Price:  99.592219686368
curr_Factors:  [99.59221969 -0.66831729 -1.07938659]
mat_Sqrt:  [[17.34631618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00318569 -0.02440254 -0.22014016]
Stock Position:  -0.003185685912765847
Bond Position:  [9.89068445]


portfolio before change:  [9.57824531]
curr_Stock_Price:  98.464054147983
curr_Factors:  [98.46405415 -0.6160645  -1.07681194]
mat_Sqrt:  [[18.11635474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00021447  0.00602022 -0.02692082]
Stock Position:  0.00021447015331263136
Bond Position:  [9.55712771]


portfolio before change:  [9.57939468]
curr_Stock_Price:  98.25260867655204
curr_Factors:  [98.25260868 -0.69747563 -1.07192447]
mat_Sqrt:  [[16.74570326  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0041022  -0.00579102  0.63160248]
Stock Position:  -0.004102199089266299
Bond Position:  [9.98244644]


portfolio before change:  [9.5827333]
curr_Stock_Price:  97.74294420961115
curr_Factors:  [97.74294421 -0.49954101 -1.09510842]
mat_Sqrt:  [[19.83983098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202346 -0.01069147 -0.01232173]
Stock Position:  -0.0020234552117904094
Bond Position:  [9.78051177]


portfolio before change:  [9.57946494]
curr_Stock_Price:  99.96241754487495
curr_Factors:  [99.96241754 -0.71115801 -1.08937673]
mat_Sqrt:  [[16.51484307  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00423711 -0.00520273 -0.78248626]
Stock Position:  -0.004237106653088557
Bond Position:  [10.00301636]


portfolio before change:  [9.57297359]
curr_Stock_Price:  101.7895617446213
curr_Factors:  [101.78956174  -0.70070137  -1.10951171]
mat_Sqrt:  [[16.65473367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00376043 -0.01084199 -0.00259791]
Stock Position:  -0.0037604340676054824
Bond Position:  [9.95574653]


portfolio before change:  [9.5808189]
curr_Stock_Price:  100.0342420410009
curr_Factors:  [100.03424204  -0.45714748  -1.106747  ]
mat_Sqrt:  [[20.93909681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00350047  0.00094788  0.08240526]
Stock Position:  -0.0035004726188746964
Bond Position:  [9.93098603]


portfolio before change:  [9.58367241]
curr_Stock_Price:  99.57371602009367
curr_Factors:  [99.57371602 -0.27488435 -1.09267655]
mat_Sqrt:  [[25.36416462  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094707 -0.00591767  0.0564535 ]
Stock Position:  0.0009470655194319423
Bond Position:  [9.48936958]


portfolio before change:  [9.58334819]
curr_Stock_Price:  97.97882821269484
curr_Factors:  [97.97882821 -0.32860126 -1.08565448]
mat_Sqrt:  [[23.81928805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00117059  0.03942869 -0.25309072]
Stock Position:  0.0011705929162954874
Bond Position:  [9.46865487]


portfolio before change:  [9.581888]
curr_Stock_Price:  95.72026950185243
curr_Factors:  [95.7202695  -0.23476595 -1.07149699]
mat_Sqrt:  [[25.92394713  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109815  0.01756546 -0.22461251]
Stock Position:  -0.0010981470817419804
Bond Position:  [9.68700293]


portfolio before change:  [9.58680294]
curr_Stock_Price:  92.34731792926523
curr_Factors:  [92.34731793 -0.27337133 -1.06317534]
mat_Sqrt:  [[24.26439359  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00041502 -0.03016076  0.29259612]
Stock Position:  0.00041502290482802243
Bond Position:  [9.54847669]


portfolio before change:  [9.58718379]
curr_Stock_Price:  90.38891065083868
curr_Factors:  [90.38891065 -0.27817802 -1.06284177]
mat_Sqrt:  [[23.64382063  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361168  0.02759587 -0.29517498]
Stock Position:  -0.0036116838993008175
Bond Position:  [9.91363997]


portfolio before change:  [9.57732462]
curr_Stock_Price:  93.46184055015813
curr_Factors:  [93.46184055 -0.42387129 -1.06407855]
mat_Sqrt:  [[21.10697154  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01258854 -0.0620984  -0.49356222]
Stock Position:  -0.01258853783911429
Bond Position:  [10.75387254]


portfolio before change:  [9.60976893]
curr_Stock_Price:  90.99134039458879
curr_Factors:  [90.99134039 -0.23231581 -0.9978829 ]
mat_Sqrt:  [[26.59080911  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00777626 0.04053144 0.92031464]
Stock Position:  0.007776264057835107
Bond Position:  [8.90219624]


portfolio before change:  [9.61039204]
curr_Stock_Price:  90.92836246688044
curr_Factors:  [ 9.09283625e+01  7.33555506e-02 -9.99632613e-01]
mat_Sqrt:  [[36.0099363   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00356776 -0.04708402 -0.75913673]
Stock Position:  0.0035677557101059395
Bond Position:  [9.28598185]


portfolio before change:  [9.60330906]
curr_Stock_Price:  88.61772337638338
curr_Factors:  [88.61772338  0.37119866 -0.98551068]
mat_Sqrt:  [[47.94333789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00237402 0.0021903  0.27240582]
Stock Position:  0.002374020178967536
Bond Position:  [9.3929288]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.61199532]
Stock Price:  91.78200335204218
PL:  [9.61199532]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.96509002e-01 -4.93573533e-02  3.15851872e-03]
 [-2.28013006e-01  6.18920245e-02 -2.68068178e-01]
 [-3.03000697e-02  5.42510417e-02  2.86044517e-02]
 [ 9.14600289e-02  7.76239433e-02  8.11703236e-02]
 [-1.60157052e-01  2.59995003e-01 -3.54557286e-02]
 [-6.71333481e-02 -1.48687940e-01  1.74184092e-01]
 [-6.23136115e-02 -1.56839249e-01  7.28160294e-02]
 [-1.42619950e-03  7.35206016e-01  1.18206111e-01]
 [ 3.04979608e-01  2.74152614e-03  3.03082489e-01]
 [ 4.23136176e-01  1.61885191e-01  2.66740606e-01]
 [-2.51221353e-01 -2.53937513e-01  2.28844157e-02]
 [-7.15340859e-02 -1.91860479e-02  8.81447545e-02]
 [ 7.03759665e-03 -5.89147707e-02  1.31053212e-01]
 [ 1.08640061e-02 -1.26324479e-01  7.62272540e-04]
 [-6.94373116e-03  3.63784967e-02 -6.30766696e-02]
 [-9.80785081e-03 -3.51368501e-02  7.16289071e-02]
 [ 6.26172633e-02  3.56942630e-02 -9.27531643e-02]
 [-3.17705621e-02 -5.85912508e-02 -1.35630327e-02]
 [ 5.03511391e-02  2.76832979e-02 -1.97286739e-01]
 [-2.79524419e-03  2.00897531e-02 -4.08057117e-02]
 [-4.47825957e-02  5.68900421e-01 -5.55864883e-01]
 [ 4.57835291e-01  2.54513282e-01  4.78226779e-02]
 [-1.15016488e-01  1.70043940e-01 -8.18740972e-02]
 [-6.11446233e-02 -1.28154644e-01 -1.89914979e-02]
 [-5.56591473e-02 -3.98322226e-02 -1.43045680e-03]
 [-5.76719459e-03  1.87943344e-02  5.00671449e-03]
 [ 8.62170362e-02  4.73848874e-03  3.01119601e-01]
 [ 1.69200954e-01 -5.16844617e-02  2.26524836e-01]
 [ 8.44662101e-03  8.17962931e-02 -1.95755615e-01]
 [-8.40054081e-02  7.92572796e-02 -1.04485512e-01]
 [ 3.44179563e-01  1.09385661e-01  1.39738137e-01]
 [ 2.72825549e-02 -1.57801456e-01 -2.82504636e-01]
 [-3.20598858e-02  7.03042439e-03  1.71328217e-01]
 [-2.22234018e-02 -1.33876259e-01 -4.53518008e-01]
 [ 9.83752718e-02  4.48909813e-01 -1.65160232e-01]
 [-2.59877440e-02 -1.54937382e-03  1.54174938e-02]
 [ 2.81841703e-01 -1.74213591e-01  1.80208786e-01]
 [-9.88338397e-02  3.83450436e-02  5.20401826e-02]
 [ 1.79735950e-01 -9.09854474e-03  9.61991892e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.29124145]
curr_Stock_Price:  99.40936107948143
curr_Factors:  [99.40936108 -1.14082476 -1.00396063]
mat_Sqrt:  [[11.64015667  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01607184 -0.01593002  0.00901037]
Stock Position:  0.016071837307036076
Bond Position:  [-3.88893253]


portfolio before change:  [-2.29384871]
curr_Stock_Price:  99.27738453895985
curr_Factors:  [99.27738454 -1.10074496 -0.98151826]
mat_Sqrt:  [[12.37470632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02182666  0.01997557 -0.76472389]
Stock Position:  -0.021826662367327512
Bond Position:  [-0.12695475]


portfolio before change:  [-2.28983343]
curr_Stock_Price:  99.0926955520965
curr_Factors:  [99.09269555 -1.09513717 -0.95144913]
mat_Sqrt:  [[12.80031043  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00104585  0.01750945  0.08160054]
Stock Position:  -0.0010458545558032102
Bond Position:  [-2.18619689]


portfolio before change:  [-2.28974661]
curr_Stock_Price:  98.74836930493389
curr_Factors:  [98.7483693  -0.95843951 -0.92806481]
mat_Sqrt:  [[14.97033493  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00827462 0.02505302 0.23155634]
Stock Position:  0.008274615998584893
Bond Position:  [-3.10685145]


portfolio before change:  [-2.29505844]
curr_Stock_Price:  98.15336268634468
curr_Factors:  [98.15336269 -0.75880215 -0.90273494]
mat_Sqrt:  [[18.63411609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00613515  0.08391303 -0.10114532]
Stock Position:  -0.006135153587601842
Bond Position:  [-1.69287249]


portfolio before change:  [-2.29985757]
curr_Stock_Price:  98.9011044419144
curr_Factors:  [98.90110444 -0.76978509 -0.9207769 ]
mat_Sqrt:  [[18.23893168  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00339543 -0.04798883  0.49689873]
Stock Position:  -0.0033954273778078704
Bond Position:  [-1.96404606]


portfolio before change:  [-2.30147409]
curr_Stock_Price:  99.30488008403135
curr_Factors:  [99.30488008 -0.77002844 -0.88640618]
mat_Sqrt:  [[18.94916934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00419358 -0.05061965  0.20772386]
Stock Position:  -0.0041935758715364
Bond Position:  [-1.88503154]


portfolio before change:  [-2.30082739]
curr_Stock_Price:  99.09447736944362
curr_Factors:  [99.09447737 -0.79868927 -0.88470578]
mat_Sqrt:  [[18.40603607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00938691 0.23728672 0.33720913]
Stock Position:  0.009386910941585874
Bond Position:  [-3.23101842]


portfolio before change:  [-2.2900605]
curr_Stock_Price:  100.28451696218741
curr_Factors:  [100.28451696  -0.57999794  -0.91113589]
mat_Sqrt:  [[22.57577632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01627433 0.00088482 0.86460998]
Stock Position:  0.016274331756069682
Bond Position:  [-3.922124]


portfolio before change:  [-2.30320416]
curr_Stock_Price:  99.50701227940674
curr_Factors:  [99.50701228 -0.64647077 -0.88725859]
mat_Sqrt:  [[21.4666111   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02378713 0.05224822 0.7609367 ]
Stock Position:  0.023787129153089698
Bond Position:  [-4.67019032]


portfolio before change:  [-2.29662111]
curr_Stock_Price:  99.8083039183409
curr_Factors:  [99.80830392 -0.70078999 -0.9430751 ]
mat_Sqrt:  [[19.28613212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01547147 -0.08195798  0.06528287]
Stock Position:  -0.015471472810629128
Bond Position:  [-0.75243965]


portfolio before change:  [-2.30700115]
curr_Stock_Price:  100.4731387867711
curr_Factors:  [100.47313879  -0.56733419  -0.95361616]
mat_Sqrt:  [[21.95379607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261722 -0.00619227  0.25145245]
Stock Position:  -0.002617221580659718
Bond Position:  [-2.04404068]


portfolio before change:  [-2.30752793]
curr_Stock_Price:  100.57678587801671
curr_Factors:  [100.57678588  -0.65178983  -0.91333044]
mat_Sqrt:  [[21.0268714   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.001035   -0.01901466  0.37385834]
Stock Position:  0.0010349991620575013
Bond Position:  [-2.41162482]


portfolio before change:  [-2.30906688]
curr_Stock_Price:  99.38115380714969
curr_Factors:  [99.38115381 -0.68884978 -0.910669  ]
mat_Sqrt:  [[20.07436659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00073558 -0.04077105  0.00217455]
Stock Position:  -0.0007355784738397358
Bond Position:  [-2.23596425]


portfolio before change:  [-2.30941983]
curr_Stock_Price:  99.48097908891208
curr_Factors:  [99.48097909 -0.51115674 -0.9060955 ]
mat_Sqrt:  [[24.11211033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051399  0.01174111 -0.17994018]
Stock Position:  -0.0005139937032061708
Bond Position:  [-2.25828723]


portfolio before change:  [-2.30973754]
curr_Stock_Price:  99.54986463695496
curr_Factors:  [99.54986464 -0.39599749 -0.9114349 ]
mat_Sqrt:  [[26.92960617  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.75965597e-05 -1.13403696e-02  2.04337334e-01]
Stock Position:  -8.759655967479561e-05
Bond Position:  [-2.30101731]


portfolio before change:  [-2.30991075]
curr_Stock_Price:  98.24351079350879
curr_Factors:  [98.24351079 -0.45236027 -0.90933355]
mat_Sqrt:  [[25.17258177  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00202483  0.01152027 -0.26459896]
Stock Position:  0.002024828613858944
Bond Position:  [-2.50883702]


portfolio before change:  [-2.30940081]
curr_Stock_Price:  98.65024516755963
curr_Factors:  [98.65024517 -0.44630136 -0.9452387 ]
mat_Sqrt:  [[24.53352761  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189532 -0.01891024 -0.03869156]
Stock Position:  -0.0018953244006645372
Bond Position:  [-2.12242659]


portfolio before change:  [-2.31194627]
curr_Stock_Price:  99.85328217990829
curr_Factors:  [99.85328218 -0.5196966  -0.94344747]
mat_Sqrt:  [[23.11675926  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0006805   0.00893475 -0.56280415]
Stock Position:  0.0006805011621626928
Bond Position:  [-2.37989655]


portfolio before change:  [-2.31161172]
curr_Stock_Price:  100.78209475278159
curr_Factors:  [100.78209475  -0.27599174  -0.96327353]
mat_Sqrt:  [[29.1861838   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024066  0.00648394 -0.11640734]
Stock Position:  -0.0002406574143573991
Bond Position:  [-2.28735776]


portfolio before change:  [-2.31214923]
curr_Stock_Price:  101.82746768426686
curr_Factors:  [101.82746768  -0.46543104  -0.9643525 ]
mat_Sqrt:  [[24.37349685  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172818  0.18361182 -1.58572779]
Stock Position:  -0.0017281774557162957
Bond Position:  [-2.1361733]


portfolio before change:  [-2.31705923]
curr_Stock_Price:  104.51409025764593
curr_Factors:  [104.51409026  -0.51057184  -0.96946889]
mat_Sqrt:  [[23.79037704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02183864 0.08214381 0.13642479]
Stock Position:  0.021838635008520672
Bond Position:  [-4.5995043]


portfolio before change:  [-2.29217126]
curr_Stock_Price:  105.6800488251496
curr_Factors:  [105.68004883  -0.50054063  -0.98353719]
mat_Sqrt:  [[23.95886259  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00404939  0.05488145 -0.23356401]
Stock Position:  -0.00404939480402021
Bond Position:  [-1.86423102]


portfolio before change:  [-2.29649898]
curr_Stock_Price:  106.69122998040486
curr_Factors:  [106.69122998  -0.25455654  -0.96139488]
mat_Sqrt:  [[31.62625233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288307 -0.04136173 -0.05417746]
Stock Position:  -0.0028830701369295412
Bond Position:  [-1.98890068]


portfolio before change:  [-2.30279594]
curr_Stock_Price:  108.78911113112282
curr_Factors:  [108.78911113  -0.13311551  -0.9582103 ]
mat_Sqrt:  [[36.52823188  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175431 -0.01285579 -0.0040807 ]
Stock Position:  -0.001754310382547924
Bond Position:  [-2.11194608]


portfolio before change:  [-2.3017402]
curr_Stock_Price:  108.03681711473513
curr_Factors:  [ 1.08036817e+02 -6.69237494e-02 -9.56428951e-01]
mat_Sqrt:  [[38.8271354   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.34069760e-05  6.06584535e-03  1.42827628e-02]
Stock Position:  -2.3406975963200053e-05
Bond Position:  [-2.29921138]


portfolio before change:  [-2.30208841]
curr_Stock_Price:  110.63390210033481
curr_Factors:  [ 1.10633902e+02 -2.41579522e-02 -9.51843211e-01]
mat_Sqrt:  [[41.68850404  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00356573 0.00152934 0.85901041]
Stock Position:  0.0035657325860886505
Bond Position:  [-2.69657932]


portfolio before change:  [-2.30291651]
curr_Stock_Price:  110.49619987383734
curr_Factors:  [110.49619987  -0.12331929  -0.93335156]
mat_Sqrt:  [[38.40970944  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00533433 -0.01668109  0.64621231]
Stock Position:  0.005334330795920205
Bond Position:  [-2.89233979]


portfolio before change:  [-2.291464]
curr_Stock_Price:  112.7109239840326
curr_Factors:  [112.71092398  -0.37724713  -0.94767262]
mat_Sqrt:  [[29.96130136  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.94478794e-04  2.63996401e-02 -5.58436282e-01]
Stock Position:  -0.0004944787937629572
Bond Position:  [-2.23573084]


portfolio before change:  [-2.2909242]
curr_Stock_Price:  111.05404394335288
curr_Factors:  [ 1.11054044e+02 -8.51338054e-02 -9.34417079e-01]
mat_Sqrt:  [[40.06351544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00222534  0.02558018 -0.29806808]
Stock Position:  -0.002225343895118122
Bond Position:  [-2.04379076]


portfolio before change:  [-2.29513814]
curr_Stock_Price:  112.83285133638864
curr_Factors:  [ 1.12832851e+02  4.95523715e-02 -9.31315092e-01]
mat_Sqrt:  [[46.71871396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00845554 0.03530407 0.39863401]
Stock Position:  0.008455535519630188
Bond Position:  [-3.24920033]


portfolio before change:  [-2.31088763]
curr_Stock_Price:  111.01826365046215
curr_Factors:  [ 1.11018264e+02 -1.50361808e-02 -9.11824923e-01]
mat_Sqrt:  [[43.9403759   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00142453 -0.0509302  -0.80590709]
Stock Position:  -0.0014245337779304965
Bond Position:  [-2.15273836]


portfolio before change:  [-2.3087521]
curr_Stock_Price:  109.33024596658674
curr_Factors:  [109.33024597  -0.18235807  -0.90618333]
mat_Sqrt:  [[36.81228742  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.18096965e-04 2.26905971e-03 4.88751714e-01]
Stock Position:  0.00011809696467249949
Bond Position:  [-2.32166367]


portfolio before change:  [-2.30879308]
curr_Stock_Price:  111.44079020912271
curr_Factors:  [111.44079021  -0.1846196   -0.9008943 ]
mat_Sqrt:  [[37.63669565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00377623 -0.04320838 -1.29376064]
Stock Position:  -0.0037762282813869753
Bond Position:  [-1.88796721]


portfolio before change:  [-2.30265833]
curr_Stock_Price:  109.75371989815392
curr_Factors:  [ 1.09753720e+02  8.93997110e-02 -8.84498744e-01]
mat_Sqrt:  [[49.55781229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0031538   0.14488502 -0.47115617]
Stock Position:  0.0031537996794776075
Bond Position:  [-2.64879957]


portfolio before change:  [-2.31442663]
curr_Stock_Price:  106.12724223900153
curr_Factors:  [106.12724224   0.19599763  -0.88277979]
mat_Sqrt:  [[53.40244939  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043363 -0.00050006  0.04398182]
Stock Position:  -0.0004336304065740753
Bond Position:  [-2.26840663]


portfolio before change:  [-2.31454114]
curr_Stock_Price:  105.73736720240058
curr_Factors:  [ 1.05737367e+02  1.03342691e-01 -8.55849540e-01]
mat_Sqrt:  [[49.82174341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00568156 -0.05622719  0.5140855 ]
Stock Position:  0.0056815648659951186
Bond Position:  [-2.91529485]


portfolio before change:  [-2.31809693]
curr_Stock_Price:  105.17566371529351
curr_Factors:  [ 1.05175664e+02 -1.01279860e-02 -8.55876938e-01]
mat_Sqrt:  [[44.23989644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.001817    0.01237581  0.14845616]
Stock Position:  -0.0018170031828454677
Bond Position:  [-2.12699241]


portfolio before change:  [-2.31399392]
curr_Stock_Price:  102.77121030920033
curr_Factors:  [102.77121031  -0.20790486  -0.82383608]
mat_Sqrt:  [[36.626218    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00539273 -0.00293654  0.27442951]
Stock Position:  0.005392729739514729
Bond Position:  [-2.86821128]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.31564]
Stock Price:  102.53245675136709
PL:  [-4.84809675]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-3.92457910e-01 -1.16381457e-01  3.00563360e-02]
 [-1.23030885e-01  6.95966969e-02 -1.31266554e-01]
 [ 7.54173265e-03  3.05981474e-03  5.18194442e-02]
 [-2.74389395e-01 -1.22524657e-01 -1.49101346e-01]
 [ 1.30306238e-01 -1.19427502e-01 -9.67972160e-02]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.25123977e-02 -1.61871772e-01 -2.72434995e-02]
 [ 1.34028570e-02  6.83057393e-01  9.32275218e-02]
 [ 3.15866401e-01  8.31817045e-03  3.25547887e-01]
 [ 5.36397277e-01  2.22784190e-01  4.06476194e-01]
 [-2.59851656e-01 -2.54216017e-01  2.54967741e-02]
 [-5.34603715e-02 -1.85607335e-02  9.03852664e-02]
 [ 6.20434015e-03 -5.00901228e-02  1.32560160e-01]
 [ 1.13250957e-02 -1.30201859e-01 -1.54243725e-02]
 [-7.69414585e-02  1.96718399e-01 -4.01727553e-02]
 [ 1.26300407e-01  3.53943392e-03 -2.82652039e-02]
 [ 5.02392454e-02  1.91170421e-02 -2.07567316e-02]
 [-3.20548919e-02 -5.86511926e-02 -1.33056304e-02]
 [ 1.55051999e-02  5.30242582e-02 -1.47344498e-01]
 [ 5.24333104e-03 -1.85203436e-03 -8.71009791e-03]
 [-3.38271616e-02  4.74379137e-01 -4.44619548e-01]
 [ 4.06180484e-01  2.29796631e-01  5.62342992e-02]
 [-1.48324116e-02  2.06409709e-02  3.66563346e-02]
 [ 4.84868022e-02 -1.40489240e-01 -2.18614289e-01]
 [ 6.03412867e-02  3.31571622e-02 -1.46381290e-02]
 [-4.03967193e-02  4.85133704e-03  1.13519685e-01]
 [ 4.36600885e-02 -3.36316682e-02  1.15625350e-02]
 [ 1.29059766e-01 -6.89901687e-02  2.97914157e-02]
 [-4.88960691e-02 -3.04796684e-02 -2.35183390e-03]
 [-6.39881320e-02 -1.37033155e-02  3.54609833e-02]
 [-3.15960001e-02 -5.19522423e-02 -2.65151679e-02]
 [ 2.62747977e-02 -4.09187193e-02 -9.63116507e-02]
 [-2.34381388e-02  6.32126602e-03  1.68680404e-01]
 [ 2.90326960e-03 -8.58216658e-02 -1.20841472e-01]
 [ 8.38084543e-03  6.83083964e-02  2.30917912e-02]
 [ 5.01132250e-02  2.98038814e-02  1.47983758e-01]
 [ 6.36719021e-02 -4.73731600e-02  7.77418203e-03]
 [-6.51306780e-02 -1.24127035e-03  3.87641212e-02]
 [ 1.46954656e-01 -2.55559640e-03  1.03310819e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.50379956]
curr_Stock_Price:  101.4006805208517
curr_Factors:  [101.40068052  -0.9555566   -0.96441257]
mat_Sqrt:  [[14.86650407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02758409 -0.03756195  0.08574236]
Stock Position:  -0.027584087692489885
Bond Position:  [16.30084483]


portfolio before change:  [13.54431465]
curr_Stock_Price:  100.00576937564401
curr_Factors:  [100.00576938  -0.89858581  -0.92238834]
mat_Sqrt:  [[16.18773289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0083779   0.02246224 -0.37446694]
Stock Position:  -0.008377899057056814
Bond Position:  [14.38215289]


portfolio before change:  [13.53922574]
curr_Stock_Price:  100.82778766097714
curr_Factors:  [100.82778766  -0.94950017  -0.92617472]
mat_Sqrt:  [[15.45201012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00121304 0.00098755 0.14782645]
Stock Position:  0.0012130405258390514
Bond Position:  [13.41691755]


portfolio before change:  [13.54201016]
curr_Stock_Price:  101.7405327440322
curr_Factors:  [101.74053274  -0.98754974  -0.93612007]
mat_Sqrt:  [[14.86123238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02219431 -0.03954466 -0.42534464]
Stock Position:  -0.02219431151387748
Bond Position:  [15.80007124]


portfolio before change:  [13.56087631]
curr_Stock_Price:  100.97948095167426
curr_Factors:  [100.97948095  -0.87156841  -0.92077412]
mat_Sqrt:  [[16.8201035   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00512301 -0.03854506 -0.27613551]
Stock Position:  0.005123009630047762
Bond Position:  [13.04355746]


portfolio before change:  [13.5628045]
curr_Stock_Price:  101.03757909476832
curr_Factors:  [101.03757909  -0.80167419  -0.92165726]
mat_Sqrt:  [[18.03223643  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00850167 -0.05534923  0.15513819]
Stock Position:  -0.008501674027918214
Bond Position:  [14.42179306]


portfolio before change:  [13.55872256]
curr_Stock_Price:  101.72976927667695
curr_Factors:  [101.72976928  -0.61737162  -0.93301698]
mat_Sqrt:  [[21.58354843  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00422152 -0.05224389 -0.07771812]
Stock Position:  -0.004221520442342111
Bond Position:  [13.98817686]


portfolio before change:  [13.5636006]
curr_Stock_Price:  100.9884702919884
curr_Factors:  [100.98847029  -0.74883411  -0.95439201]
mat_Sqrt:  [[18.38950696  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00934562 0.22045583 0.26595217]
Stock Position:  0.009345620419467505
Bond Position:  [12.61980069]


portfolio before change:  [13.57266065]
curr_Stock_Price:  101.78911045659893
curr_Factors:  [101.78911046  -1.013873    -0.94653504]
mat_Sqrt:  [[14.3320041   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02679434 0.00268468 0.92869751]
Stock Position:  0.026794335382455504
Bond Position:  [10.84528909]


portfolio before change:  [13.56263638]
curr_Stock_Price:  101.3643930848681
curr_Factors:  [101.36439308  -0.86052442  -0.94774629]
mat_Sqrt:  [[16.61741376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0400089  0.07190329 1.15956344]
Stock Position:  0.040008904178498186
Bond Position:  [9.50715809]


portfolio before change:  [13.53805926]
curr_Stock_Price:  100.72039669758739
curr_Factors:  [100.7203967   -0.81496733  -0.93545295]
mat_Sqrt:  [[17.49522609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01752128 -0.08204787  0.0727352 ]
Stock Position:  -0.01752128121916002
Bond Position:  [15.30280965]


portfolio before change:  [13.55935886]
curr_Stock_Price:  99.6139348282136
curr_Factors:  [99.61393483 -0.7135535  -0.91925382]
mat_Sqrt:  [[19.46260123  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199353 -0.00599045  0.25784401]
Stock Position:  -0.0019935284955067975
Bond Position:  [13.75794207]


portfolio before change:  [13.5603736]
curr_Stock_Price:  99.96763011289185
curr_Factors:  [99.96763011 -0.70228787 -0.93711635]
mat_Sqrt:  [[19.40328177  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00118735 -0.01616652  0.37815724]
Stock Position:  0.0011873489427253374
Bond Position:  [13.44167715]


portfolio before change:  [13.56154215]
curr_Stock_Price:  99.53661244632744
curr_Factors:  [99.53661245 -0.8093463  -0.95231038]
mat_Sqrt:  [[17.09641627  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00107629 -0.04202247 -0.04400144]
Stock Position:  -0.0010762918988188228
Bond Position:  [13.6686726]


portfolio before change:  [13.56550938]
curr_Stock_Price:  97.43816999735658
curr_Factors:  [97.43817    -0.70099114 -0.96591134]
mat_Sqrt:  [[18.39935383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244502  0.06349059 -0.11460169]
Stock Position:  -0.0024450159038839838
Bond Position:  [13.80374725]


portfolio before change:  [13.56487216]
curr_Stock_Price:  98.40454113634998
curr_Factors:  [98.40454114 -1.01541771 -0.95903733]
mat_Sqrt:  [[13.66218664  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0088751   0.00114235 -0.08063276]
Stock Position:  0.008875100534053503
Bond Position:  [12.69152197]


portfolio before change:  [13.5697945]
curr_Stock_Price:  98.78040151608465
curr_Factors:  [98.78040152 -0.77004862 -0.91439818]
mat_Sqrt:  [[18.32841188  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0027228   0.00617    -0.05921318]
Stock Position:  0.002722797015781372
Bond Position:  [13.30083552]


portfolio before change:  [13.56918753]
curr_Stock_Price:  97.94681872561321
curr_Factors:  [97.94681873 -0.92777601 -0.94065809]
mat_Sqrt:  [[15.11957959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309156 -0.01892959 -0.03795726]
Stock Position:  -0.0030915553298551416
Bond Position:  [13.87199554]


portfolio before change:  [13.5712657]
curr_Stock_Price:  97.83552960583754
curr_Factors:  [97.83552961 -0.97295658 -0.93172392]
mat_Sqrt:  [[14.56479473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.57321752e-04  1.71135057e-02 -4.20332840e-01]
Stock Position:  -0.00025732175238589976
Bond Position:  [13.59644091]


portfolio before change:  [13.57275185]
curr_Stock_Price:  98.66525395091816
curr_Factors:  [98.66525395 -1.09526848 -0.92466589]
mat_Sqrt:  [[13.08934421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00023587 -0.00059774 -0.02484748]
Stock Position:  0.00023586703587769828
Bond Position:  [13.54947997]


portfolio before change:  [13.57470498]
curr_Stock_Price:  99.76478247042411
curr_Factors:  [99.76478247 -0.86816908 -0.93109588]
mat_Sqrt:  [[16.50313359  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168165  0.15310521 -1.26837581]
Stock Position:  -0.001681650992012978
Bond Position:  [13.74247453]


portfolio before change:  [13.57499617]
curr_Stock_Price:  100.61319435014413
curr_Factors:  [100.61319435  -0.8612789   -0.89703455]
mat_Sqrt:  [[17.33920204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02679283 0.07416654 0.1604208 ]
Stock Position:  0.02679283061907591
Bond Position:  [10.87928389]


portfolio before change:  [13.57856777]
curr_Stock_Price:  100.6957390683662
curr_Factors:  [100.69573907  -1.03734532  -0.89912597]
mat_Sqrt:  [[14.52152733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.000216    0.00666184  0.10457032]
Stock Position:  -0.00021599987732266333
Bond Position:  [13.60031804]


portfolio before change:  [13.58009683]
curr_Stock_Price:  101.48779758780033
curr_Factors:  [101.48779759  -1.12092628  -0.93796633]
mat_Sqrt:  [[12.94935471  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019163  -0.04534271 -0.62364572]
Stock Position:  -0.0019163038849559545
Bond Position:  [13.77457829]


portfolio before change:  [13.58175218]
curr_Stock_Price:  101.52254133320969
curr_Factors:  [101.52254133  -1.08268043  -0.95188261]
mat_Sqrt:  [[13.27281305  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00483104  0.01070143 -0.04175851]
Stock Position:  0.004831038322637102
Bond Position:  [13.09129289]


portfolio before change:  [13.58157511]
curr_Stock_Price:  101.14713816476952
curr_Factors:  [101.14713816  -1.11808457  -0.97350042]
mat_Sqrt:  [[12.49078633  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012997   0.00156576  0.32384006]
Stock Position:  -0.001299704856383681
Bond Position:  [13.71303654]


portfolio before change:  [13.58276837]
curr_Stock_Price:  101.54797973635216
curr_Factors:  [101.54797974  -0.83565436  -0.9762238 ]
mat_Sqrt:  [[16.58756358  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00236052 -0.01085457  0.03298469]
Stock Position:  0.0023605181930678567
Bond Position:  [13.34306252]


portfolio before change:  [13.58496703]
curr_Stock_Price:  101.7727922864977
curr_Factors:  [101.77279229  -0.84718384  -0.96359452]
mat_Sqrt:  [[16.64257952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00727401 -0.02226648  0.08498662]
Stock Position:  0.007274013868429756
Bond Position:  [12.84467033]


portfolio before change:  [13.58614484]
curr_Stock_Price:  101.71397011762843
curr_Factors:  [101.71397012  -0.94761452  -0.96719488]
mat_Sqrt:  [[14.98957959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00370909 -0.00983727 -0.00670913]
Stock Position:  -0.003709094784313455
Bond Position:  [13.9634116]


portfolio before change:  [13.58533839]
curr_Stock_Price:  102.40200523027008
curr_Factors:  [102.40200523  -0.73829474  -0.9841336 ]
mat_Sqrt:  [[18.2922588   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0032553  -0.00442273  0.10116031]
Stock Position:  -0.0032553041842151194
Bond Position:  [13.91868807]


portfolio before change:  [13.59115874]
curr_Stock_Price:  101.14854198652635
curr_Factors:  [101.14854199  -0.54699766  -0.99719952]
mat_Sqrt:  [[21.5935135   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00220497 -0.01676751 -0.07564039]
Stock Position:  -0.0022049720242416455
Bond Position:  [13.81418844]


portfolio before change:  [13.58926952]
curr_Stock_Price:  102.78851794180945
curr_Factors:  [102.78851794  -0.51223393  -1.02355527]
mat_Sqrt:  [[22.12890005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.85052256e-05 -1.32064599e-02 -2.74750332e-01]
Stock Position:  -7.850522562253316e-05
Bond Position:  [13.59733896]


portfolio before change:  [13.59095563]
curr_Stock_Price:  102.96254880425572
curr_Factors:  [102.9625488   -0.55370748  -1.03897323]
mat_Sqrt:  [[20.94049019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00058661 0.00204018 0.48119824]
Stock Position:  0.0005866112711888883
Bond Position:  [13.53055664]


portfolio before change:  [13.5932084]
curr_Stock_Price:  103.91946885912863
curr_Factors:  [103.91946886  -0.66383965  -1.02867039]
mat_Sqrt:  [[19.1271009   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00205372 -0.02769882 -0.34472709]
Stock Position:  -0.0020537177621984502
Bond Position:  [13.80662966]


portfolio before change:  [13.59577316]
curr_Stock_Price:  103.51102770588592
curr_Factors:  [103.51102771  -0.92921777  -1.02499754]
mat_Sqrt:  [[14.66498745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0018437  0.02204644 0.06587445]
Stock Position:  0.0018436995371200933
Bond Position:  [13.40492992]


portfolio before change:  [13.59735655]
curr_Stock_Price:  103.460952270048
curr_Factors:  [103.46095227  -0.95505652  -1.03021459]
mat_Sqrt:  [[14.20967632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00608064 0.00961916 0.42215647]
Stock Position:  0.006080643427484929
Bond Position:  [12.96824739]


portfolio before change:  [13.59162833]
curr_Stock_Price:  102.2523039775625
curr_Factors:  [102.25230398  -0.67249701  -1.03092586]
mat_Sqrt:  [[18.61598201  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00298608 -0.01528962  0.02217758]
Stock Position:  0.0029860790855565263
Bond Position:  [13.28629486]


portfolio before change:  [13.59049292]
curr_Stock_Price:  101.31585877844121
curr_Factors:  [101.31585878  -0.52323964  -1.0226769 ]
mat_Sqrt:  [[21.59207628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266169 -0.00040062  0.11058325]
Stock Position:  -0.0026616874340238787
Bond Position:  [13.86016407]


portfolio before change:  [13.58802751]
curr_Stock_Price:  102.89306557182755
curr_Factors:  [102.89306557  -0.48670762  -1.04366303]
mat_Sqrt:  [[22.27176214  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00752169 -0.00082482  0.29471701]
Stock Position:  0.0075216872774258
Bond Position:  [12.81409805]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.61122555]
Stock Price:  105.76425254377372
PL:  [7.846973]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.79554894e-01 -1.07395129e-01  2.39553607e-02]
 [-1.19133847e-01  6.98827018e-02 -1.26188345e-01]
 [-1.22874481e-01 -1.54123600e-02 -6.54954691e-02]
 [-6.90161525e-02 -3.13079470e-02 -1.00648933e-02]
 [ 1.75220955e-01 -1.82996612e-01 -1.04495102e-01]
 [-1.30135636e-01 -1.61077139e-01  1.13269007e-01]
 [-5.24171948e-02 -1.65974385e-01 -2.73430200e-02]
 [ 1.09100788e-02  6.58999124e-01  1.04723972e-01]
 [ 2.80806514e-01 -6.26217830e-03  2.95968558e-01]
 [ 4.76035917e-01  1.89743835e-01  3.30118072e-01]
 [-1.94393485e-01 -1.90186858e-01  4.92689162e-02]
 [-1.55501328e-02 -1.72491150e-02  9.50848172e-02]
 [ 6.74777116e-03 -4.33090816e-02  1.18512516e-01]
 [ 1.06082900e-02 -9.58787462e-02 -6.46680056e-02]
 [-2.36602137e-02  6.67085777e-02 -5.06607757e-02]
 [ 1.25401119e-01  3.28299948e-03 -2.72795812e-02]
 [ 5.07595398e-02  1.81832426e-02 -2.37998116e-02]
 [-2.20492455e-02 -5.65418245e-02 -2.23636911e-02]
 [-2.64186085e-03  1.18484028e-01 -1.33762809e-01]
 [-5.82030526e-02 -1.72286288e-02 -2.40123436e-02]
 [-3.33236460e-02  4.47157439e-01 -3.95077708e-01]
 [ 3.38258530e-01  1.97296205e-01  6.72949108e-02]
 [ 1.04626255e-03 -2.92517374e-02  6.72246148e-02]
 [ 7.01237826e-02  4.14245660e-02 -1.41939564e-01]
 [-3.89912986e-02  1.31367078e-02 -5.55171403e-03]
 [-1.08142732e-01 -1.57008553e-02  2.24422746e-01]
 [-4.17719614e-02 -3.35263783e-02 -7.88539039e-03]
 [-1.01079669e-01  1.20467628e-01 -9.85587183e-02]
 [-1.45844143e-02 -4.05388231e-02  5.53794565e-02]
 [ 4.05856923e-03  3.27918381e-02 -4.90798097e-02]
 [ 3.94905682e-02 -3.87309391e-02 -9.10573236e-02]
 [-2.00249457e-02  3.81481053e-02 -9.61996025e-02]
 [ 2.78727795e-02  1.92955733e-02  5.27278819e-02]
 [ 3.65625714e-02 -3.71443958e-02  1.56353504e-01]
 [-6.82515875e-02  1.17009081e-02 -2.25487176e-02]
 [-2.93994855e-02 -9.32954546e-02 -1.25583197e-02]
 [ 2.32936981e-02  1.03152894e-01  1.39355787e-01]
 [ 1.71126724e-01 -1.21310032e-01 -1.68588511e-01]
 [ 9.92985707e-02  2.84796170e-03  5.78566926e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.63443063]
curr_Stock_Price:  100.91285971896784
curr_Factors:  [100.91285972  -0.99649968  -1.01789456]
mat_Sqrt:  [[13.46189533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02203159 -0.03466163  0.06833798]
Stock Position:  -0.022031590494945432
Bond Position:  [11.85770143]


portfolio before change:  [9.6442821]
curr_Stock_Price:  100.5329888077012
curr_Factors:  [100.53298881  -0.91872421  -1.01023577]
mat_Sqrt:  [[14.60736636  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00894256  0.02255455 -0.35998022]
Stock Position:  -0.008942555761550538
Bond Position:  [10.54330396]


portfolio before change:  [9.63522207]
curr_Stock_Price:  101.69350952309773
curr_Factors:  [101.69350952  -0.86710455  -0.99443815]
mat_Sqrt:  [[15.80649256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00881851 -0.00497432 -0.18684034]
Stock Position:  -0.008818510619464086
Bond Position:  [10.53200737]


portfolio before change:  [9.64098618]
curr_Stock_Price:  101.18916999194019
curr_Factors:  [101.18916999  -0.86767958  -1.00985168]
mat_Sqrt:  [[15.4786318   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00500441 -0.0101046  -0.02871234]
Stock Position:  -0.005004405375617685
Bond Position:  [10.14737781]


portfolio before change:  [9.64043661]
curr_Stock_Price:  101.55246518385815
curr_Factors:  [101.55246518  -0.91498225  -1.0199422 ]
mat_Sqrt:  [[14.66774862  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00794512 -0.0590619  -0.29809544]
Stock Position:  0.007945115368943271
Bond Position:  [8.83359055]


portfolio before change:  [9.63132427]
curr_Stock_Price:  100.26656716577602
curr_Factors:  [100.26656717  -0.99467251  -0.98307026]
mat_Sqrt:  [[13.8750122   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01008247 -0.05198742  0.32312495]
Stock Position:  -0.01008247258679203
Bond Position:  [10.64225918]


portfolio before change:  [9.62079374]
curr_Stock_Price:  101.44295405470693
curr_Factors:  [101.44295405  -1.25725549  -0.97220986]
mat_Sqrt:  [[10.91383507  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00841848 -0.053568   -0.07800203]
Stock Position:  -0.008418483897819167
Bond Position:  [10.47478962]


portfolio before change:  [9.62351112]
curr_Stock_Price:  101.27570944796203
curr_Factors:  [101.27570945  -1.37021179  -0.98977748]
mat_Sqrt:  [[ 9.56257773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01744346 0.21269105 0.29874834]
Stock Position:  0.01744345592305821
Bond Position:  [7.85691274]


portfolio before change:  [9.62911677]
curr_Stock_Price:  101.54076443514
curr_Factors:  [101.54076444  -1.15047398  -1.01463936]
mat_Sqrt:  [[11.65047553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02917843 -0.00202111  0.84431591]
Stock Position:  0.029178429671661524
Bond Position:  [6.66631672]


portfolio before change:  [9.60946803]
curr_Stock_Price:  100.83880467870084
curr_Factors:  [100.83880468  -0.8715474   -1.00838761]
mat_Sqrt:  [[15.38800391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03783157 0.06123956 0.94173497]
Stock Position:  0.037831565948459676
Bond Position:  [5.79457814]


portfolio before change:  [9.59751957]
curr_Stock_Price:  100.50382445482126
curr_Factors:  [100.50382445  -0.95765021  -1.01399277]
mat_Sqrt:  [[13.99293835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01594792 -0.06138254  0.1405505 ]
Stock Position:  -0.015947918437429532
Bond Position:  [11.20034636]


portfolio before change:  [9.61408702]
curr_Stock_Price:  99.55277084893466
curr_Factors:  [99.55277085 -1.09686198 -1.00566934]
mat_Sqrt:  [[12.16005675  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.77970243e-05 -5.56712792e-03  2.71250517e-01]
Stock Position:  2.7797024299732804e-05
Bond Position:  [9.61131975]


portfolio before change:  [9.61528556]
curr_Stock_Price:  99.44641133216328
curr_Factors:  [99.44641133 -0.91782904 -1.01736346]
mat_Sqrt:  [[14.35971075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00153893 -0.01397795  0.33808322]
Stock Position:  0.0015389312757220766
Bond Position:  [9.46224437]


portfolio before change:  [9.61722083]
curr_Stock_Price:  99.93533496430747
curr_Factors:  [99.93533496 -0.69859507 -1.01426298]
mat_Sqrt:  [[18.02329827  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012297  -0.03094473 -0.18447982]
Stock Position:  -0.0012296960370315724
Bond Position:  [9.74011092]


portfolio before change:  [9.61944625]
curr_Stock_Price:  99.1157606708099
curr_Factors:  [99.11576067 -0.83569947 -0.99923586]
mat_Sqrt:  [[15.82123668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00128842  0.0215301  -0.14452109]
Stock Position:  -0.0012884245530613463
Bond Position:  [9.74714943]


portfolio before change:  [9.62090121]
curr_Stock_Price:  98.93220778806156
curr_Factors:  [98.93220779 -0.73407028 -1.00355743]
mat_Sqrt:  [[17.40586347  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00692312  0.00105958 -0.07782105]
Stock Position:  0.006923117452213325
Bond Position:  [8.93598192]


portfolio before change:  [9.62324867]
curr_Stock_Price:  99.10993008775014
curr_Factors:  [99.10993009 -0.6238682  -0.99056851]
mat_Sqrt:  [[19.72314717  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00251547  0.00586862 -0.06789424]
Stock Position:  0.002515473926056835
Bond Position:  [9.37394023]


portfolio before change:  [9.61932383]
curr_Stock_Price:  97.08380719211775
curr_Factors:  [97.08380719 -0.84138347 -0.96709037]
mat_Sqrt:  [[15.91243302  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00239786 -0.0182488  -0.06379739]
Stock Position:  -0.0023978587312876785
Bond Position:  [9.85211708]


portfolio before change:  [9.62170042]
curr_Stock_Price:  96.60629698553038
curr_Factors:  [96.60629699 -0.76395306 -0.9673678 ]
mat_Sqrt:  [[17.10418317  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.36796492e-04  3.82405557e-02 -3.81588062e-01]
Stock Position:  -0.00033679649180275975
Bond Position:  [9.65423709]


portfolio before change:  [9.62302159]
curr_Stock_Price:  96.26690225585392
curr_Factors:  [96.26690226 -0.88401261 -0.94305656]
mat_Sqrt:  [[15.48784294  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430152 -0.00556052 -0.06850053]
Stock Position:  -0.004301524173644399
Bond Position:  [10.03711599]


portfolio before change:  [9.619966]
curr_Stock_Price:  97.26894269091575
curr_Factors:  [97.26894269 -0.74518429 -0.99924293]
mat_Sqrt:  [[16.99726626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00133509  0.14431944 -1.12704673]
Stock Position:  -0.0013350920683152987
Bond Position:  [9.749829]


portfolio before change:  [9.6195078]
curr_Stock_Price:  98.52503805151163
curr_Factors:  [98.52503805 -0.72594971 -0.99687841]
mat_Sqrt:  [[17.59267444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02229723 0.06367708 0.19197365]
Stock Position:  0.022297233238788496
Bond Position:  [7.42267205]


portfolio before change:  [9.61539471]
curr_Stock_Price:  98.29895682516985
curr_Factors:  [98.29895683 -0.61324545 -1.00465977]
mat_Sqrt:  [[19.49402864  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00045129 -0.00944096  0.19177311]
Stock Position:  0.00045128915398298604
Bond Position:  [9.57103346]


portfolio before change:  [9.61583489]
curr_Stock_Price:  96.62314692522506
curr_Factors:  [96.62314693 -0.85401496 -1.01619972]
mat_Sqrt:  [[14.88871655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0033318   0.01336972 -0.40491407]
Stock Position:  0.0033318012646305338
Bond Position:  [9.29390577]


portfolio before change:  [9.61878216]
curr_Stock_Price:  97.1590310578061
curr_Factors:  [97.15903106 -0.93058004 -1.01703258]
mat_Sqrt:  [[13.85625173  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270225  0.00423985 -0.01583749]
Stock Position:  -0.002702247257114662
Bond Position:  [9.88132989]


portfolio before change:  [9.61866123]
curr_Stock_Price:  97.66089839841833
curr_Factors:  [97.6608984  -0.95929476 -1.03386163]
mat_Sqrt:  [[13.30772724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00492477 -0.00506743  0.64021563]
Stock Position:  -0.004924774391311433
Bond Position:  [10.09961913]


portfolio before change:  [9.62511922]
curr_Stock_Price:  96.60593557568829
curr_Factors:  [96.60593558 -1.06978642 -0.99297601]
mat_Sqrt:  [[12.27884367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00409038 -0.01082059 -0.02249482]
Stock Position:  -0.004090377284981133
Bond Position:  [10.02027394]


portfolio before change:  [9.62665966]
curr_Stock_Price:  96.53556863649537
curr_Factors:  [96.53556864 -1.21476499 -0.99647029]
mat_Sqrt:  [[10.57694091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00913379  0.03888076 -0.28116059]
Stock Position:  -0.00913378756052289
Bond Position:  [10.50839503]


portfolio before change:  [9.6194099]
curr_Stock_Price:  97.47311943605715
curr_Factors:  [97.47311944 -1.1770819  -1.00815431]
mat_Sqrt:  [[10.96096616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0010542  -0.01308385  0.15798217]
Stock Position:  -0.001054202930881577
Bond Position:  [9.72216635]


portfolio before change:  [9.62114979]
curr_Stock_Price:  96.97554291725797
curr_Factors:  [96.97554292 -1.06761097 -1.01810342]
mat_Sqrt:  [[12.04614171  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.09158480e-05  1.05835202e-02 -1.40011036e-01]
Stock Position:  6.091584803866626e-05
Bond Position:  [9.61524245]


portfolio before change:  [9.62240078]
curr_Stock_Price:  97.78007770320863
curr_Factors:  [97.7800777  -1.2514849  -1.02460566]
mat_Sqrt:  [[10.04053399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00129452 -0.01250036 -0.2597612 ]
Stock Position:  0.0012945178042094
Bond Position:  [9.49582273]


portfolio before change:  [9.62324586]
curr_Stock_Price:  97.51590555005122
curr_Factors:  [97.51590555 -1.25874469 -1.00784259]
mat_Sqrt:  [[10.10902134  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00315309  0.01231225 -0.27443069]
Stock Position:  -0.0031530903852390875
Bond Position:  [9.93072232]


portfolio before change:  [9.62232766]
curr_Stock_Price:  98.2008277274426
curr_Factors:  [98.20082773 -1.33811158 -0.99069704]
mat_Sqrt:  [[ 9.56591268  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00445065 0.00622762 0.15041797]
Stock Position:  0.004450647541379492
Bond Position:  [9.18527038]


portfolio before change:  [9.62205118]
curr_Stock_Price:  97.88071550079613
curr_Factors:  [97.8807155  -1.17430058 -1.00290158]
mat_Sqrt:  [[11.09558619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00548831 -0.0119883   0.44603303]
Stock Position:  0.005488311087956217
Bond Position:  [9.08485136]


portfolio before change:  [9.62153203]
curr_Stock_Price:  97.57919632951076
curr_Factors:  [97.57919633 -0.898143   -0.97116375]
mat_Sqrt:  [[15.04969256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00468221  0.00377645 -0.06432521]
Stock Position:  -0.004682214410156756
Bond Position:  [10.07841875]


portfolio before change:  [9.62351497]
curr_Stock_Price:  97.42476901893838
curr_Factors:  [97.42476902 -1.25506484 -0.94416599]
mat_Sqrt:  [[10.80327844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00472142 -0.03011098 -0.03582539]
Stock Position:  -0.004721418317236786
Bond Position:  [10.08349806]


portfolio before change:  [9.62795422]
curr_Stock_Price:  96.75151100058332
curr_Factors:  [96.751511   -0.76158435 -0.94742618]
mat_Sqrt:  [[17.51636203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00415586 0.03329245 0.39754327]
Stock Position:  0.004155861538390311
Bond Position:  [9.22586833]


portfolio before change:  [9.62373391]
curr_Stock_Price:  95.45849034949248
curr_Factors:  [95.45849035 -0.74222961 -0.94510254]
mat_Sqrt:  [[17.66100927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0063389  -0.03915264 -0.4809361 ]
Stock Position:  0.0063389034234377925
Bond Position:  [9.01863176]


portfolio before change:  [9.62978284]
curr_Stock_Price:  96.23489217195224
curr_Factors:  [96.23489217 -0.55522326 -0.96310954]
mat_Sqrt:  [[21.0828349   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00529767 0.00091918 0.16504904]
Stock Position:  0.005297667837953963
Bond Position:  [9.11996235]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.6253292]
Stock Price:  95.17901003083064
PL:  [9.6253292]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.22280520e-01 -8.20916470e-02  1.95121276e-02]
 [-8.84237327e-02  9.82116718e-02 -5.25874624e-02]
 [-7.46999364e-02 -1.45106986e-02 -2.32361522e-02]
 [-4.89528270e-01 -2.25523254e-01 -3.02182909e-01]
 [ 2.75864667e-01 -2.80363428e-01 -1.05900584e-01]
 [-1.29438610e-01 -1.73743810e-01  3.88590221e-02]
 [-5.09240943e-02 -1.53323042e-01 -3.40853352e-02]
 [ 4.61853999e-03  6.62108721e-01  1.05312078e-01]
 [ 4.29935263e-01  5.57972537e-02  4.22904755e-01]
 [ 6.94474396e-01  3.18862445e-01  6.37268666e-01]
 [-9.65331241e-02 -2.27652855e-01 -2.51062712e-02]
 [-8.23801306e-02 -2.11862395e-02  7.97493930e-02]
 [ 1.45881280e-02 -4.82728621e-02  4.85111550e-02]
 [ 6.06182969e-04  1.69174393e-01 -9.73229337e-02]
 [ 3.68932675e-01 -1.54425408e-01 -1.83639573e-01]
 [-2.12846933e-01 -9.62216356e-02  1.18942122e-01]
 [ 5.07304214e-02  1.82355028e-02 -2.36295053e-02]
 [-4.54302814e-02 -5.39517617e-02  4.48051542e-02]
 [ 1.31331420e-01 -1.54683158e-01 -1.02600370e-02]
 [ 4.64003047e-02 -7.87200571e-03  2.66340166e-01]
 [-3.27740647e-02  4.79916252e-01 -4.62324534e-01]
 [ 3.98240084e-01  2.25997176e-01  5.75273373e-02]
 [-1.13105016e-01  1.64751955e-01 -7.86134272e-02]
 [-4.35779396e-02 -1.44055263e-01 -4.31409596e-02]
 [-1.43299670e-02 -3.79737784e-02 -5.96306478e-03]
 [-7.88120494e-03  1.76800473e-02  1.83586548e-02]
 [ 8.82780173e-02 -8.86953606e-03  1.90611161e-01]
 [ 1.69200954e-01 -5.16844617e-02  2.26524836e-01]
 [-2.81742295e-02  2.68467608e-02 -1.07679637e-01]
 [-6.53835055e-02  1.42134427e-02  1.34644681e-02]
 [ 1.35414803e-02 -3.92730916e-02 -2.24611145e-02]
 [ 2.68070455e-02 -1.02650427e-01 -1.94649620e-01]
 [ 8.39870430e-02 -4.58894892e-03  1.36055166e-01]
 [-1.51478421e-02 -1.20344298e-01 -3.59837765e-01]
 [ 8.33322765e-02  3.52447622e-01 -1.58604257e-01]
 [-5.06032821e-02 -1.84667439e-02 -1.93791057e-02]
 [ 5.92358503e-01 -3.25585366e-01  4.36400010e-01]
 [-1.46568715e-01  7.87636101e-02  5.99703372e-02]
 [ 3.90609938e-01 -5.23896965e-02  3.41284256e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.06573642]
curr_Stock_Price:  100.58901815826809
curr_Factors:  [100.58901816  -1.26200498  -1.02153939]
mat_Sqrt:  [[10.25226563  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01317314 -0.02649497  0.05566267]
Stock Position:  -0.013173138083408578
Bond Position:  [8.39080944]


portfolio before change:  [7.05065975]
curr_Stock_Price:  101.81314417372936
curr_Factors:  [101.81314417  -1.18839994  -1.01202583]
mat_Sqrt:  [[11.27641569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00701559  0.03169768 -0.15001739]
Stock Position:  -0.00701559184013317
Bond Position:  [7.76493922]


portfolio before change:  [7.05135787]
curr_Stock_Price:  101.85199518148667
curr_Factors:  [101.85199518  -1.02414389  -1.02034761]
mat_Sqrt:  [[13.18433306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00625022 -0.00468331 -0.06628627]
Stock Position:  -0.006250219838105412
Bond Position:  [7.68795523]


portfolio before change:  [7.05038434]
curr_Stock_Price:  102.16151715608368
curr_Factors:  [102.16151716  -1.15945466  -1.02907668]
mat_Sqrt:  [[11.45038921  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05215944 -0.07278732 -0.86204373]
Stock Position:  -0.05215943568454173
Bond Position:  [12.37907142]


portfolio before change:  [6.99785972]
curr_Stock_Price:  103.19818682442296
curr_Factors:  [103.19818682  -1.3491733   -1.02998049]
mat_Sqrt:  [[ 9.5591374   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02061053 -0.09048691 -0.30210489]
Stock Position:  0.02061052656070571
Bond Position:  [4.87089075]


portfolio before change:  [6.99167171]
curr_Stock_Price:  102.86840825651332
curr_Factors:  [102.86840826  -1.44707509  -1.02658075]
mat_Sqrt:  [[ 8.66935801  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01810651 -0.05607557  0.11085397]
Stock Position:  -0.018106514020627438
Bond Position:  [8.85425998]


portfolio before change:  [6.98409586]
curr_Stock_Price:  103.34794269689951
curr_Factors:  [103.3479427   -1.16355227  -1.05210543]
mat_Sqrt:  [[11.27337417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00791056 -0.0494848  -0.09723597]
Stock Position:  -0.007910557006873578
Bond Position:  [7.80163565]


portfolio before change:  [6.98241019]
curr_Stock_Price:  103.68432028281144
curr_Factors:  [103.68432028  -1.16357384  -1.07472123]
mat_Sqrt:  [[11.0569128   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01458523 0.21369467 0.30042605]
Stock Position:  0.014585233464353748
Bond Position:  [5.47015017]


portfolio before change:  [6.98326062]
curr_Stock_Price:  103.69574402987833
curr_Factors:  [103.69574403  -1.21014364  -1.01814502]
mat_Sqrt:  [[11.16933874  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04724093 0.01800849 1.20642955]
Stock Position:  0.04724092567168629
Bond Position:  [2.08457769]


portfolio before change:  [6.98794461]
curr_Stock_Price:  103.7893789739587
curr_Factors:  [103.78937897  -1.14275895  -1.01092312]
mat_Sqrt:  [[12.04538469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07385765 0.10291241 1.81795012]
Stock Position:  0.0738576529876506
Bond Position:  [-0.67769532]


portfolio before change:  [6.99491751]
curr_Stock_Price:  103.88493603317369
curr_Factors:  [103.88493603  -1.05889753  -0.99997825]
mat_Sqrt:  [[13.2554412   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01117483 -0.07347464 -0.0716212 ]
Stock Position:  -0.011174834728740247
Bond Position:  [8.15581451]


portfolio before change:  [6.99222284]
curr_Stock_Price:  104.21730900835904
curr_Factors:  [104.21730901  -0.87269152  -0.99067206]
mat_Sqrt:  [[16.16930433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435554 -0.00683783  0.22750282]
Stock Position:  -0.00435553537226659
Bond Position:  [7.44614502]


portfolio before change:  [6.99594177]
curr_Stock_Price:  103.57717963916639
curr_Factors:  [103.57717964  -1.05906675  -0.98010901]
mat_Sqrt:  [[13.4791126   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00108589 -0.01558     0.13838882]
Stock Position:  0.0010858852336628412
Bond Position:  [6.88346884]


portfolio before change:  [6.99649715]
curr_Stock_Price:  103.29619657120818
curr_Factors:  [103.29619657  -1.07516311  -0.97832252]
mat_Sqrt:  [[13.2515552   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115253  0.0546008  -0.27763524]
Stock Position:  0.001152528923797011
Bond Position:  [6.87744529]


portfolio before change:  [6.99729382]
curr_Stock_Price:  103.24147733995194
curr_Factors:  [103.24147734  -1.02838905  -1.00989314]
mat_Sqrt:  [[13.44743649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02230354 -0.04984059 -0.52387259]
Stock Position:  0.022303540877080162
Bond Position:  [4.69464331]


portfolio before change:  [6.99667975]
curr_Stock_Price:  103.18763233227352
curr_Factors:  [103.18763233  -0.92168738  -1.00225528]
mat_Sqrt:  [[15.06849812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01381751 -0.0310554   0.33930877]
Stock Position:  -0.013817510644085566
Bond Position:  [8.42247596]


portfolio before change:  [7.00519056]
curr_Stock_Price:  102.64788739295938
curr_Factors:  [102.64788739  -0.9878238   -0.99921902]
mat_Sqrt:  [[14.07305174  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00352655  0.00588548 -0.0674084 ]
Stock Position:  0.00352655388569833
Bond Position:  [6.64319725]


portfolio before change:  [7.00600533]
curr_Stock_Price:  102.64344290196094
curr_Factors:  [102.6434429   -0.88701286  -0.99379305]
mat_Sqrt:  [[15.64975644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302224 -0.01741286  0.12781663]
Stock Position:  -0.0030222403129063014
Bond Position:  [7.31621848]


portfolio before change:  [7.00461453]
curr_Stock_Price:  103.40625013979562
curr_Factors:  [103.40625014  -0.72823245  -1.0109352 ]
mat_Sqrt:  [[18.16501971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00537641 -0.04992377 -0.02926903]
Stock Position:  0.005376406545658031
Bond Position:  [6.44866049]


portfolio before change:  [7.00772222]
curr_Stock_Price:  103.83433545832087
curr_Factors:  [103.83433546  -0.9785263   -0.99786728]
mat_Sqrt:  [[14.38812372  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00689179 -0.00254068  0.75979436]
Stock Position:  0.00689178790168269
Bond Position:  [6.29211801]


portfolio before change:  [7.01285755]
curr_Stock_Price:  104.46534116048161
curr_Factors:  [104.46534116  -0.87152543  -0.98918131]
mat_Sqrt:  [[16.25090517  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00179579  0.1548923  -1.31888321]
Stock Position:  -0.0017957873771098467
Bond Position:  [7.20045509]


portfolio before change:  [7.01306022]
curr_Stock_Price:  104.85371742655651
curr_Factors:  [104.85371743  -0.57389721  -1.00709697]
mat_Sqrt:  [[21.57579379  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02114009 0.07294028 0.16410948]
Stock Position:  0.02114009281798319
Bond Position:  [4.7964429]


portfolio before change:  [7.02650555]
curr_Stock_Price:  105.46136580231422
curr_Factors:  [105.4613658   -0.41120327  -0.9962242 ]
mat_Sqrt:  [[25.81400592  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0037004   0.05317346 -0.22426223]
Stock Position:  -0.003700396712498187
Bond Position:  [7.41675444]


portfolio before change:  [7.02514196]
curr_Stock_Price:  106.08041859700644
curr_Factors:  [106.0804186   -0.51445335  -1.0094723 ]
mat_Sqrt:  [[23.11014779  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0035391  -0.04649364 -0.12306915]
Stock Position:  -0.0035391036541043146
Bond Position:  [7.40057156]


portfolio before change:  [7.0225116]
curr_Stock_Price:  107.08504858318534
curr_Factors:  [107.08504858  -0.52469625  -1.00503916]
mat_Sqrt:  [[23.19386867  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00100451 -0.01225598 -0.01701096]
Stock Position:  -0.0010045127838375174
Bond Position:  [7.1300799]


portfolio before change:  [7.02465897]
curr_Stock_Price:  105.8346455227689
curr_Factors:  [105.83464552  -0.69566794  -0.99426306]
mat_Sqrt:  [[19.52990582  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.68734354e-05  5.70621074e-03  5.23721322e-02]
Stock Position:  -2.6873435437047664e-05
Bond Position:  [7.02750311]


portfolio before change:  [7.02549137]
curr_Stock_Price:  107.54982424505913
curr_Factors:  [107.54982425  -0.81059365  -0.99813848]
mat_Sqrt:  [[17.62330356  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00711421 -0.00286263  0.54376059]
Stock Position:  0.0071142093539676605
Bond Position:  [6.2603594]


portfolio before change:  [7.02777768]
curr_Stock_Price:  107.76119330893471
curr_Factors:  [107.76119331  -0.80177601  -1.00579024]
mat_Sqrt:  [[17.67853802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01158976 -0.01668109  0.64621231]
Stock Position:  0.01158976469994834
Bond Position:  [5.77885081]


portfolio before change:  [7.02437441]
curr_Stock_Price:  107.40521761233397
curr_Factors:  [107.40521761  -0.90788912  -1.01925933]
mat_Sqrt:  [[15.63419199  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00285747  0.00866475 -0.30718003]
Stock Position:  -0.0028574659449817096
Bond Position:  [7.33128116]


portfolio before change:  [7.0225094]
curr_Stock_Price:  108.378625995586
curr_Factors:  [108.378626    -0.92648738  -1.02103247]
mat_Sqrt:  [[15.45775846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00386432  0.00458737  0.03841038]
Stock Position:  -0.0038643232620749466
Bond Position:  [7.44131944]


portfolio before change:  [7.02459116]
curr_Stock_Price:  108.08063316881662
curr_Factors:  [108.08063317  -1.19479897  -1.03407251]
mat_Sqrt:  [[11.63486358  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.07949555e-05 -1.26753358e-02 -6.40753077e-02]
Stock Position:  8.079495553432835e-05
Bond Position:  [7.01585879]


portfolio before change:  [7.02549765]
curr_Stock_Price:  108.44517067586567
curr_Factors:  [108.44517068  -1.24093103  -1.04374707]
mat_Sqrt:  [[11.04045887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306863 -0.03313028 -0.55528119]
Stock Position:  -0.0030686290183251155
Bond Position:  [7.35827565]


portfolio before change:  [7.02556798]
curr_Stock_Price:  108.72200692234298
curr_Factors:  [108.72200692  -0.94936172  -1.07397911]
mat_Sqrt:  [[14.37446545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00770968 -0.00148108  0.38812752]
Stock Position:  0.007709676066655205
Bond Position:  [6.18735653]


portfolio before change:  [7.03234336]
curr_Stock_Price:  109.50049705961992
curr_Factors:  [109.50049706  -0.96915513  -1.1171134 ]
mat_Sqrt:  [[13.59443552  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00832433 -0.03884096 -1.02651698]
Stock Position:  -0.008324332034419084
Bond Position:  [7.94386185]


portfolio before change:  [7.04075032]
curr_Stock_Price:  108.60986564237034
curr_Factors:  [108.60986564  -0.96022275  -1.13124386]
mat_Sqrt:  [[13.41395574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00916213  0.11375198 -0.4524538 ]
Stock Position:  0.009162128617538678
Bond Position:  [6.04565276]


portfolio before change:  [7.05118876]
curr_Stock_Price:  109.66668245720534
curr_Factors:  [109.66668246  -1.10875546  -1.15773177]
mat_Sqrt:  [[11.3697734   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00513014 -0.00596012 -0.05528319]
Stock Position:  -0.005130140393876042
Bond Position:  [7.61379424]


portfolio before change:  [7.05101662]
curr_Stock_Price:  109.8857645146079
curr_Factors:  [109.88576451  -1.05459242  -1.15357157]
mat_Sqrt:  [[12.0766922   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05092276 -0.10508222  1.24492776]
Stock Position:  0.05092275573955302
Bond Position:  [1.45533068]


portfolio before change:  [7.00297235]
curr_Stock_Price:  108.93871835570832
curr_Factors:  [108.93871836  -0.73156656  -1.13525301]
mat_Sqrt:  [[16.84351873  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00702049  0.02542085  0.17107868]
Stock Position:  -0.007020490722747767
Bond Position:  [7.76777561]


portfolio before change:  [7.00699196]
curr_Stock_Price:  108.50447868179629
curr_Factors:  [108.50447868  -0.72220897  -1.14609285]
mat_Sqrt:  [[16.75153056  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02309534 -0.0169087   0.0973589 ]
Stock Position:  0.02309534467581475
Bond Position:  [4.50104362]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.01809172]
Stock Price:  108.96072198547442
PL:  [-1.94263026]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-3.50412758e-01  1.60762252e-01 -2.05030331e-02]
 [-2.95151582e-01  9.35021384e-02 -4.93187785e-01]
 [-2.76439415e-02  5.50392098e-02  3.02642751e-02]
 [ 9.15354657e-02  7.75698040e-02  8.12802374e-02]
 [-1.01231404e-01  2.19618780e-01 -3.91999991e-02]
 [-5.22165249e-02 -1.38602826e-01  2.28966091e-01]
 [-6.53060016e-02 -1.42528870e-01 -9.36302200e-03]
 [-3.04102788e-02  8.24464409e-01  1.69608923e-01]
 [ 1.33293264e-01 -2.31666466e-02  1.12617921e-01]
 [ 1.91257641e-01  6.51625915e-02  7.08801248e-02]
 [-1.05817995e-01 -2.56931067e-01 -2.48235176e-02]
 [-3.26378479e-02 -1.78403158e-02  9.29665349e-02]
 [-6.04635631e-02  2.73826640e-01 -2.69817394e-01]
 [ 6.55479383e-03 -5.51738104e-02  6.02266642e-02]
 [-1.30017461e-01  1.91737022e-01 -3.75386275e-02]
 [-2.00211281e-01 -7.91814515e-02 -6.10963858e-02]
 [ 3.05092155e-02  1.46843545e-01 -2.12663924e-01]
 [ 1.48952007e-01 -6.34460841e-03 -1.32457130e-01]
 [ 1.96145440e-02  1.89676247e-01 -9.95053858e-02]
 [-9.44704237e-02 -1.51628727e-02 -2.48864939e-02]
 [-3.31394186e-02  4.31656908e-01 -3.66191167e-01]
 [ 3.28631032e-01  1.55884896e-01  1.10812024e-01]
 [ 8.26459323e-03 -5.66085518e-02  8.45798853e-02]
 [ 7.33203732e-02  1.28149335e-01 -1.16526154e-01]
 [-4.29911611e-02  3.03308312e-03 -5.13122481e-03]
 [-1.19530139e-01 -1.70847993e-02  2.17391070e-01]
 [-5.07761409e-02 -3.39149444e-02 -1.13490431e-02]
 [-8.35869179e-02  1.20040732e-01 -4.51166136e-02]
 [ 1.41194598e-01 -3.69878270e-02  1.85043856e-01]
 [ 6.39430356e-02  6.16462263e-02 -1.11709191e-01]
 [ 6.47025805e-02  7.10818159e-02  1.81645846e-01]
 [-1.10677149e-02  4.53944003e-02 -8.74818964e-02]
 [ 1.33139606e-02  1.09123954e-01 -1.50504129e-02]
 [-1.24258563e-02 -5.90425203e-02  6.75794373e-02]
 [-8.11706157e-02  1.32385551e-01 -1.29455205e-01]
 [-2.17410047e-01 -2.22708249e-01 -2.02144354e-01]
 [ 1.04041234e-01  9.98991820e-02  2.32622537e-01]
 [ 1.96125884e-01 -1.35243386e-01 -2.24877893e-01]
 [ 9.84566273e-02  3.36956689e-03  6.28408301e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.65156725]
curr_Stock_Price:  98.73357169979684
curr_Factors:  [98.7335717  -0.93658425 -1.02260704]
mat_Sqrt:  [[13.91870673  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0231187   0.05188579 -0.05848945]
Stock Position:  -0.02311870432662662
Bond Position:  [-5.368975]


portfolio before change:  [-7.66597416]
curr_Stock_Price:  99.3277117186016
curr_Factors:  [99.32771172 -1.14662627 -1.04674441]
mat_Sqrt:  [[11.0790276   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03400453  0.03017769 -1.40692747]
Stock Position:  -0.03400452513354573
Bond Position:  [-4.28838249]


portfolio before change:  [-7.64650326]
curr_Stock_Price:  98.7393492145454
curr_Factors:  [98.73934921 -0.94508478 -1.06316815]
mat_Sqrt:  [[13.25308838  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.000772    0.01776383  0.08633555]
Stock Position:  -0.0007720042501826624
Bond Position:  [-7.57027606]


portfolio before change:  [-7.64739104]
curr_Stock_Price:  98.66349985024333
curr_Factors:  [98.66349985 -0.83511404 -1.02321813]
mat_Sqrt:  [[15.38484447  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00805732 0.02503555 0.23186989]
Stock Position:  0.008057318673889766
Bond Position:  [-8.4423543]


portfolio before change:  [-7.64828306]
curr_Stock_Price:  98.68377239784073
curr_Factors:  [98.6837724  -0.70163395 -1.01086277]
mat_Sqrt:  [[17.80401138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361736  0.07088166 -0.11182669]
Stock Position:  -0.0036173631581587857
Bond Position:  [-7.29130802]


portfolio before change:  [-7.64697048]
curr_Stock_Price:  98.0689441097191
curr_Factors:  [98.06894411 -0.83810827 -1.02111421]
mat_Sqrt:  [[15.27852524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221037 -0.04473387  0.65317653]
Stock Position:  -0.0022103704484319193
Bond Position:  [-7.43020178]


portfolio before change:  [-7.64744586]
curr_Stock_Price:  97.86379926596335
curr_Factors:  [97.86379927 -0.72028116 -0.99510486]
mat_Sqrt:  [[17.60513617  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00547061 -0.04600099 -0.0267101 ]
Stock Position:  -0.005470608312148428
Bond Position:  [-7.11207135]


portfolio before change:  [-7.64802868]
curr_Stock_Price:  97.80781917756646
curr_Factors:  [97.80781918 -0.74283268 -0.96608586]
mat_Sqrt:  [[17.7092301   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00974091 0.26609474 0.48384705]
Stock Position:  0.009740914168765434
Bond Position:  [-8.60076625]


portfolio before change:  [-7.64211165]
curr_Stock_Price:  98.52563672887693
curr_Factors:  [98.52563673 -0.78567866 -0.98368064]
mat_Sqrt:  [[16.79292195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00902478 -0.007477    0.32126758]
Stock Position:  0.009024780151870797
Bond Position:  [-8.53128386]


portfolio before change:  [-7.65736505]
curr_Stock_Price:  96.9536392293813
curr_Factors:  [96.95363923 -0.85140964 -0.95941082]
mat_Sqrt:  [[15.85385142  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0138154  0.02103114 0.20220127]
Stock Position:  0.013815396558506323
Bond Position:  [-8.99681803]


portfolio before change:  [-7.6590345]
curr_Stock_Price:  96.91420698639234
curr_Factors:  [96.91420699 -0.99298202 -0.9606539 ]
mat_Sqrt:  [[13.73833642  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0118887  -0.08292415 -0.07081459]
Stock Position:  -0.011888696251544557
Bond Position:  [-6.50685093]


portfolio before change:  [-7.65491228]
curr_Stock_Price:  96.49905393908712
curr_Factors:  [96.49905394 -0.91709157 -0.94305926]
mat_Sqrt:  [[15.01999589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00115198 -0.00575794  0.26520765]
Stock Position:  -0.0011519825130990873
Bond Position:  [-7.54374706]


portfolio before change:  [-7.65486118]
curr_Stock_Price:  95.63608498743997
curr_Factors:  [95.63608499 -0.66079542 -0.96090595]
mat_Sqrt:  [[18.89408359  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00315682  0.08837717 -0.76971392]
Stock Position:  -0.003156817784193413
Bond Position:  [-7.35295549]


portfolio before change:  [-7.65486129]
curr_Stock_Price:  95.34494688606526
curr_Factors:  [95.34494689 -0.49740178 -0.95626744]
mat_Sqrt:  [[22.2831795   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00034045 -0.01780727  0.17180991]
Stock Position:  0.000340445279767921
Bond Position:  [-7.68732102]


portfolio before change:  [-7.65601885]
curr_Stock_Price:  94.76749882274872
curr_Factors:  [94.76749882 -0.31314118 -0.95725452]
mat_Sqrt:  [[26.60318133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00370414  0.06188286 -0.10708726]
Stock Position:  -0.0037041376452412486
Bond Position:  [-7.30498699]


portfolio before change:  [-7.65280869]
curr_Stock_Price:  93.65432759233218
curr_Factors:  [93.65432759 -0.43726246 -0.92534249]
mat_Sqrt:  [[23.97485773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00954522 -0.0255557  -0.17429098]
Stock Position:  -0.009545223469707003
Bond Position:  [-6.75885721]


portfolio before change:  [-7.66130547]
curr_Stock_Price:  94.4559715225932
curr_Factors:  [94.45597152 -0.45147121 -0.94685164]
mat_Sqrt:  [[23.33165355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00073178  0.04739355 -0.60667098]
Stock Position:  0.0007317821257602784
Bond Position:  [-7.73042666]


portfolio before change:  [-7.66348955]
curr_Stock_Price:  92.79193439746135
curr_Factors:  [92.7919344  -0.28680788 -0.96775011]
mat_Sqrt:  [[26.46443444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00455779 -0.00204771 -0.37786332]
Stock Position:  0.004557785714549647
Bond Position:  [-8.0864153]


portfolio before change:  [-7.65781226]
curr_Stock_Price:  94.25934798773615
curr_Factors:  [94.25934799 -0.38608477 -0.99067363]
mat_Sqrt:  [[23.79062504  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00159813  0.06121775 -0.28386117]
Stock Position:  0.0015981334640279218
Bond Position:  [-7.80845128]


portfolio before change:  [-7.65736299]
curr_Stock_Price:  95.15125147761698
curr_Factors:  [95.15125148 -0.48207158 -0.98443383]
mat_Sqrt:  [[21.95428498  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00467542 -0.0048938  -0.07099424]
Stock Position:  -0.004675418330202666
Bond Position:  [-7.21249109]


portfolio before change:  [-7.652253]
curr_Stock_Price:  93.86545915411489
curr_Factors:  [93.86545915 -0.5501822  -0.95771831]
mat_Sqrt:  [[20.77939694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.51725419e-04  1.39316668e-01 -1.04464147e+00]
Stock Position:  -0.0009517254192385546
Bond Position:  [-7.56291885]


portfolio before change:  [-7.65317062]
curr_Stock_Price:  93.83625204150185
curr_Factors:  [93.83625204 -0.55068254 -0.95094304]
mat_Sqrt:  [[20.90368978  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01832549 0.05031163 0.31611586]
Stock Position:  0.018325487834076237
Bond Position:  [-9.37276572]


portfolio before change:  [-7.6418182]
curr_Stock_Price:  94.51967661045413
curr_Factors:  [94.51967661 -0.54518586 -0.96848142]
mat_Sqrt:  [[20.80390584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00067171 -0.01827033  0.24128287]
Stock Position:  0.0006717112588694731
Bond Position:  [-7.70530813]


portfolio before change:  [-7.64195104]
curr_Stock_Price:  95.75590340829287
curr_Factors:  [95.75590341 -0.5730391  -0.95028538]
mat_Sqrt:  [[20.87344539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00362628  0.04136002 -0.33241668]
Stock Position:  0.0036262794081794647
Bond Position:  [-7.9891887]


portfolio before change:  [-7.63782]
curr_Stock_Price:  97.17050630677684
curr_Factors:  [97.17050631 -0.46891279 -0.96697953]
mat_Sqrt:  [[23.11715349  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00187823  0.00097892 -0.01463796]
Stock Position:  -0.0018782348144336456
Bond Position:  [-7.45531098]


portfolio before change:  [-7.64053514]
curr_Stock_Price:  98.11988945218164
curr_Factors:  [98.11988945 -0.38232656 -0.92295986]
mat_Sqrt:  [[26.59979931  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295652 -0.0055141   0.62015621]
Stock Position:  -0.0029565182813694984
Bond Position:  [-7.35044189]


portfolio before change:  [-7.63545725]
curr_Stock_Price:  96.09157447256362
curr_Factors:  [96.09157447 -0.26898428 -0.91268805]
mat_Sqrt:  [[29.4775605   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00203598 -0.010946   -0.03237566]
Stock Position:  -0.002035976268504611
Bond Position:  [-7.43981709]


portfolio before change:  [-7.63359879]
curr_Stock_Price:  94.72196211564928
curr_Factors:  [94.72196212 -0.29180171 -0.89251174]
mat_Sqrt:  [[28.98076784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0023565   0.03874298 -0.12870514]
Stock Position:  -0.0023564971286955975
Bond Position:  [-7.41038676]


portfolio before change:  [-7.63589546]
curr_Stock_Price:  95.30346744656337
curr_Factors:  [95.30346745 -0.16857461 -0.89089269]
mat_Sqrt:  [[33.03603386  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00518877 -0.01193777  0.52787862]
Stock Position:  0.00518877082051337
Bond Position:  [-8.13040331]


portfolio before change:  [-7.641531]
curr_Stock_Price:  94.41324331728912
curr_Factors:  [94.41324332 -0.09574948 -0.87410449]
mat_Sqrt:  [[35.79568607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00150085  0.01989623 -0.31867523]
Stock Position:  0.0015008505651147052
Bond Position:  [-7.78323116]


portfolio before change:  [-7.64491588]
curr_Stock_Price:  92.80620800169474
curr_Factors:  [ 9.28062080e+01 -1.14097687e-02 -9.09077895e-01]
mat_Sqrt:  [[36.96700915  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00314579 0.02294156 0.51818504]
Stock Position:  0.0031457886691556836
Bond Position:  [-7.9368646]


portfolio before change:  [-7.65481928]
curr_Stock_Price:  89.9734602356468
curr_Factors:  [89.97346024 -0.13962115 -0.92967917]
mat_Sqrt:  [[30.88326398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063655  0.01465098 -0.2495615 ]
Stock Position:  -0.0006365515343138561
Bond Position:  [-7.59754653]


portfolio before change:  [-7.65511628]
curr_Stock_Price:  88.94801194102895
curr_Factors:  [88.94801194 -0.30231933 -0.9751163 ]
mat_Sqrt:  [[24.79436542  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00131145  0.0352196  -0.04293464]
Stock Position:  0.0013114528705401305
Bond Position:  [-7.7717674]


portfolio before change:  [-7.65455794]
curr_Stock_Price:  90.1145603168144
curr_Factors:  [90.11456032 -0.3338847  -0.98720627]
mat_Sqrt:  [[24.04653201  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044427 -0.01905589  0.19278532]
Stock Position:  -0.00044427468225518885
Bond Position:  [-7.61452232]


portfolio before change:  [-7.6549915]
curr_Stock_Price:  88.94792289537388
curr_Factors:  [88.9479229  -0.29262682 -0.97140334]
mat_Sqrt:  [[25.12895844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00320636  0.04272725 -0.36929967]
Stock Position:  -0.0032063589726921333
Bond Position:  [-7.36979253]


portfolio before change:  [-7.6652183]
curr_Stock_Price:  91.85013062851768
curr_Factors:  [91.85013063 -0.19633225 -0.99870405]
mat_Sqrt:  [[27.80238857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01093909 -0.07187878 -0.57666157]
Stock Position:  -0.010939086080465794
Bond Position:  [-6.66046182]


portfolio before change:  [-7.69276715]
curr_Stock_Price:  94.29240408822832
curr_Factors:  [94.29240409  0.10650842 -1.02557123]
mat_Sqrt:  [[37.61255212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00457073 0.03224232 0.66360735]
Stock Position:  0.004570733323211613
Bond Position:  [-8.12375259]


portfolio before change:  [-7.70066302]
curr_Stock_Price:  92.78710155039337
curr_Factors:  [92.78710155 -0.09987909 -1.02823067]
mat_Sqrt:  [[30.03002978  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00408313 -0.04364962 -0.64151403]
Stock Position:  0.004083127353706099
Bond Position:  [-8.07952458]


portfolio before change:  [-7.69285071]
curr_Stock_Price:  94.9477776403762
curr_Factors:  [94.94777764 -0.14251596 -1.01002514]
mat_Sqrt:  [[29.98765905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00373393 0.00108752 0.1792674 ]
Stock Position:  0.0037339282745530284
Bond Position:  [-8.0473789]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.69163982]
Stock Price:  95.54148818767904
PL:  [-7.69163982]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 3.44899715e-02 -7.30626197e-02  9.94672278e-03]
 [-1.20691615e-01  8.95703175e-02 -1.79644058e-01]
 [ 7.42225073e-03 -6.82205442e-03  5.01283469e-02]
 [ 9.66209016e-02  5.90061314e-02  1.01364116e-01]
 [ 7.96117647e-03  9.58155829e-02 -6.06555866e-02]
 [-1.10183041e-01 -1.58448868e-01  1.25250624e-01]
 [-5.55607873e-02 -1.66184303e-01  2.99914959e-02]
 [ 1.67680372e-02  6.72426123e-01  8.62553716e-02]
 [ 2.38739308e-01 -2.41760826e-02  2.55862126e-01]
 [ 4.79269303e-01  1.94087848e-01  3.42515731e-01]
 [-2.03252232e-01 -1.94091409e-01  4.93708768e-02]
 [-7.27548215e-02 -1.92282829e-02  8.79934257e-02]
 [ 1.01284923e-02 -5.91192508e-02  1.11868953e-01]
 [ 1.55881971e-03  1.44668746e-01 -1.44569018e-01]
 [ 2.31244516e-01 -1.45127966e-01 -1.42179484e-01]
 [-2.18640763e-01 -9.65270099e-02  1.20112779e-01]
 [ 5.00279498e-02  1.94962653e-02 -1.95209132e-02]
 [-4.00237274e-02 -5.07536744e-02  5.25031464e-02]
 [ 1.23897961e-01 -1.37860354e-01 -2.12876548e-02]
 [ 5.26263621e-02 -1.11046028e-02  2.12400572e-01]
 [-1.81502182e-02  3.56162789e-01 -3.38177838e-01]
 [ 1.20066874e-01  9.28922335e-02  1.02825884e-01]
 [ 2.24144834e-03  1.17811232e-01 -2.13523748e-02]
 [ 6.67666149e-02 -1.59263284e-01 -2.41950693e-01]
 [ 6.10475965e-02  2.78852375e-02 -1.46197899e-02]
 [-1.81101260e-02  1.40939307e-02  5.25241719e-02]
 [ 7.38825539e-02 -3.11676331e-02  2.73823516e-02]
 [ 1.46312063e-01 -7.08469542e-02  8.64538132e-02]
 [-4.74139934e-02 -2.43117558e-02 -1.42590295e-02]
 [-6.63792314e-02 -6.45826231e-03  2.94849698e-02]
 [-3.97682844e-02 -5.55583048e-02 -3.06971206e-02]
 [ 2.60601545e-02 -1.60237480e-02 -5.66542200e-02]
 [-2.31340030e-02  1.01512460e-02  1.27526825e-01]
 [ 6.96255814e-03 -7.80583033e-02 -6.70965881e-02]
 [ 6.18796092e-03  4.92766511e-02  2.02777332e-02]
 [ 5.06471702e-02  2.84186648e-02  1.47586210e-01]
 [ 2.42551534e-01 -1.68834811e-01  1.24102506e-01]
 [-8.78348096e-02  2.65000086e-02  3.94502054e-02]
 [ 2.12548501e-01 -1.58347625e-02  8.65408141e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.08088527]
curr_Stock_Price:  99.83449334053755
curr_Factors:  [99.83449334 -0.96575385 -1.01663276]
mat_Sqrt:  [[13.75121441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00157124 -0.02358086  0.02837523]
Stock Position:  0.0015712425386726458
Bond Position:  [0.92402107]


portfolio before change:  [1.08270074]
curr_Stock_Price:  100.91641450648363
curr_Factors:  [100.91641451  -1.09750758  -1.03666577]
mat_Sqrt:  [[11.94268839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01164544  0.0289087  -0.51247449]
Stock Position:  -0.011645438231285433
Bond Position:  [2.25791661]


portfolio before change:  [1.08222133]
curr_Stock_Price:  100.98181872639483
curr_Factors:  [100.98181873  -0.72846305  -1.041045  ]
mat_Sqrt:  [[17.2089989   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094498 -0.00220181  0.14300222]
Stock Position:  0.0009449771458752558
Bond Position:  [0.98679582]


portfolio before change:  [1.08111571]
curr_Stock_Price:  99.6812763673951
curr_Factors:  [99.68127637 -1.01802944 -1.03516327]
mat_Sqrt:  [[12.79155444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01011264 0.01904415 0.28916361]
Stock Position:  0.010112636582082606
Bond Position:  [0.07307519]


portfolio before change:  [1.08015813]
curr_Stock_Price:  99.58568169656293
curr_Factors:  [99.5856817  -0.93430045 -1.02663816]
mat_Sqrt:  [[14.01432175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00108019  0.03092435 -0.17303351]
Stock Position:  0.0010801936004574287
Bond Position:  [0.97258631]


portfolio before change:  [1.08083612]
curr_Stock_Price:  100.10078710952668
curr_Factors:  [100.10078711  -1.13217577  -1.02606432]
mat_Sqrt:  [[11.56446991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0101137  -0.05113915  0.35730517]
Stock Position:  -0.010113702142985964
Bond Position:  [2.09322567]


portfolio before change:  [1.0772601]
curr_Stock_Price:  100.48024215484098
curr_Factors:  [100.48024215  -1.16299817  -1.04464498]
mat_Sqrt:  [[11.04875734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00754483 -0.05363575  0.08555739]
Stock Position:  -0.007544832867462462
Bond Position:  [1.83536673]


portfolio before change:  [1.07799677]
curr_Stock_Price:  100.41301188038335
curr_Factors:  [100.41301188  -1.1430358   -1.05559458]
mat_Sqrt:  [[11.14132777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0154051  0.2170246  0.24606257]
Stock Position:  0.015405098236140271
Bond Position:  [-0.46887554]


portfolio before change:  [1.0845228]
curr_Stock_Price:  100.84044400767729
curr_Factors:  [100.84044401  -1.13709306  -1.03799221]
mat_Sqrt:  [[11.45531985  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02496936 -0.0078028   0.72990343]
Stock Position:  0.024969361583062535
Bond Position:  [-1.43339871]


portfolio before change:  [1.08965876]
curr_Stock_Price:  101.05331109400178
curr_Factors:  [101.05331109  -0.97756328  -1.003523  ]
mat_Sqrt:  [[13.93720558  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04224685 0.06264158 0.97710204]
Stock Position:  0.04224685114825227
Bond Position:  [-3.17952543]


portfolio before change:  [1.08746116]
curr_Stock_Price:  101.01070114428035
curr_Factors:  [101.01070114  -0.9142558   -1.00677098]
mat_Sqrt:  [[14.7936745   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01573599 -0.06264273  0.14084137]
Stock Position:  -0.015735994917819
Bond Position:  [2.67696504]


portfolio before change:  [1.09855851]
curr_Stock_Price:  100.32674679399058
curr_Factors:  [100.32674679  -0.56541562  -0.97118912]
mat_Sqrt:  [[21.5813084   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00272079 -0.0062059   0.25102075]
Stock Position:  -0.0027207894149947607
Bond Position:  [1.37152646]


portfolio before change:  [1.09615227]
curr_Stock_Price:  101.27415117915277
curr_Factors:  [101.27415118  -0.73938377  -0.98108156]
mat_Sqrt:  [[18.12633549  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011528  -0.01908066  0.31913099]
Stock Position:  0.0011527967275623435
Bond Position:  [0.97940376]


portfolio before change:  [1.09773198]
curr_Stock_Price:  102.53827090552407
curr_Factors:  [102.53827091  -0.752781    -0.99014136]
mat_Sqrt:  [[17.94503982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.80007349e-05  4.66916371e-02 -4.12415168e-01]
Stock Position:  8.800073485290732e-05
Bond Position:  [1.08870853]


portfolio before change:  [1.09781208]
curr_Stock_Price:  101.90202065356974
curr_Factors:  [101.90202065  -0.83912752  -0.96348977]
mat_Sqrt:  [[16.80026204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01027354 -0.04683985 -0.40559849]
Stock Position:  0.0102735379070358
Bond Position:  [0.05091781]


portfolio before change:  [1.10684912]
curr_Stock_Price:  102.78104330138848
curr_Factors:  [102.7810433   -0.92722404  -0.97765222]
mat_Sqrt:  [[15.2980393   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01397737 -0.03115396  0.34264833]
Stock Position:  -0.013977368866295232
Bond Position:  [2.54345768]


portfolio before change:  [1.11882326]
curr_Stock_Price:  101.94711018816366
curr_Factors:  [101.94711019  -1.09590019  -0.9803608 ]
mat_Sqrt:  [[12.78398438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00391294  0.00629239 -0.05568773]
Stock Position:  0.003912936457211786
Bond Position:  [0.7199107]


portfolio before change:  [1.12252566]
curr_Stock_Price:  102.87030435811728
curr_Factors:  [102.87030436  -1.46736285  -0.98552007]
mat_Sqrt:  [[ 8.8514926   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00448135 -0.01638068  0.14977686]
Stock Position:  -0.004481347919376874
Bond Position:  [1.58352328]


portfolio before change:  [1.12255544]
curr_Stock_Price:  102.90783173358435
curr_Factors:  [102.90783173  -1.60347095  -0.96678227]
mat_Sqrt:  [[ 7.87411288  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01160918 -0.04449424 -0.06072775]
Stock Position:  0.011609182080339507
Bond Position:  [-0.07212032]


portfolio before change:  [1.1220189]
curr_Stock_Price:  102.86239178113954
curr_Factors:  [102.86239178  -1.57662567  -0.98774173]
mat_Sqrt:  [[ 7.91709774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01183713 -0.003584    0.60591971]
Stock Position:  0.011837131848979433
Bond Position:  [-0.09557679]


portfolio before change:  [1.1196765]
curr_Stock_Price:  102.66551556374598
curr_Factors:  [102.66551556  -1.55036137  -1.00482908]
mat_Sqrt:  [[ 7.97479417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0018156   0.11495105 -0.96472724]
Stock Position:  -0.0018156023889604547
Bond Position:  [1.30607626]


portfolio before change:  [1.11925827]
curr_Stock_Price:  102.98579484466704
curr_Factors:  [102.98579484  -1.57901038  -1.01121784]
mat_Sqrt:  [[ 7.72423539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02071631 0.02998084 0.29333363]
Stock Position:  0.02071631162928372
Bond Position:  [-1.01422755]


portfolio before change:  [1.12388678]
curr_Stock_Price:  103.21533834709552
curr_Factors:  [103.21533835  -1.62122264  -1.04765388]
mat_Sqrt:  [[ 7.15592692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00306474  0.03802341 -0.06091238]
Stock Position:  0.003064736453886051
Bond Position:  [0.80755897]


portfolio before change:  [1.12238753]
curr_Stock_Price:  102.69320518303392
curr_Factors:  [102.69320518  -1.34641357  -1.01637295]
mat_Sqrt:  [[ 9.66933393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00156483 -0.051402   -0.69021798]
Stock Position:  -0.0015648280894316178
Bond Position:  [1.28308475]


portfolio before change:  [1.12315061]
curr_Stock_Price:  102.3080598568232
curr_Factors:  [102.30805986  -1.36173488  -1.03407305]
mat_Sqrt:  [[ 9.32016678  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00684059  0.00899992 -0.04170619]
Stock Position:  0.006840585174428334
Bond Position:  [0.42330362]


portfolio before change:  [1.12387587]
curr_Stock_Price:  102.40634689469775
curr_Factors:  [102.40634689  -1.44690453  -1.01887406]
mat_Sqrt:  [[ 8.69866969  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051867  0.0045488   0.14983684]
Stock Position:  -0.000518672731912015
Bond Position:  [1.17699125]


portfolio before change:  [1.12388973]
curr_Stock_Price:  102.66329912099015
curr_Factors:  [102.66329912  -1.31140887  -0.98922379]
mat_Sqrt:  [[10.28639376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00710744 -0.01005931  0.07811423]
Stock Position:  0.007107436122222237
Bond Position:  [0.39421689]


portfolio before change:  [1.12224996]
curr_Stock_Price:  102.42565279462724
curr_Factors:  [102.42565279  -1.30167195  -0.99239593]
mat_Sqrt:  [[10.33017594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01447195 -0.02286576  0.24662866]
Stock Position:  0.014471950934440031
Bond Position:  [-0.36004907]


portfolio before change:  [1.12003928]
curr_Stock_Price:  102.2760069181567
curr_Factors:  [102.27600692  -0.92937844  -1.01326798]
mat_Sqrt:  [[14.65862187  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00377165 -0.00784659 -0.04067704]
Stock Position:  -0.003771652100887814
Bond Position:  [1.50578879]


portfolio before change:  [1.12399443]
curr_Stock_Price:  101.2772622175347
curr_Factors:  [101.27726222  -0.9406889   -1.03362037]
mat_Sqrt:  [[14.06307622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00438588 -0.0020844   0.08411241]
Stock Position:  -0.004385877133173955
Bond Position:  [1.56818406]


portfolio before change:  [1.12050646]
curr_Stock_Price:  102.11723347863654
curr_Factors:  [102.11723348  -0.77879137  -1.05471412]
mat_Sqrt:  [[16.32366691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00351484 -0.01793137 -0.08757034]
Stock Position:  -0.0035148413459632905
Bond Position:  [1.47943233]


portfolio before change:  [1.12120964]
curr_Stock_Price:  101.96978940104162
curr_Factors:  [101.9697894   -0.9833096   -1.04260774]
mat_Sqrt:  [[13.4470433   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00083474 -0.00517164 -0.16161872]
Stock Position:  0.000834743082654171
Bond Position:  [1.03609106]


portfolio before change:  [1.12128661]
curr_Stock_Price:  101.90683186871304
curr_Factors:  [101.90683187  -0.68868507  -1.00855877]
mat_Sqrt:  [[18.66808038  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.66198538e-04 3.27630056e-03 3.63798536e-01]
Stock Position:  0.0002661985376741281
Bond Position:  [1.09415916]


portfolio before change:  [1.12163596]
curr_Stock_Price:  102.70537841120405
curr_Factors:  [102.70537841  -0.68484442  -1.01116288]
mat_Sqrt:  [[18.83764363  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00120329 -0.02519321 -0.19140789]
Stock Position:  -0.0012032853178368169
Bond Position:  [1.24521983]


portfolio before change:  [1.12100712]
curr_Stock_Price:  103.35734300851558
curr_Factors:  [103.35734301  -1.17838379  -1.03184055]
mat_Sqrt:  [[11.33582417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00179834 0.01590397 0.05784673]
Stock Position:  0.0017983421278147279
Bond Position:  [0.93513525]


portfolio before change:  [1.12169999]
curr_Stock_Price:  103.67762482017143
curr_Factors:  [103.67762482  -1.22671699  -1.02859614]
mat_Sqrt:  [[10.86963577  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00796476 0.00917208 0.42102238]
Stock Position:  0.007964757663469331
Bond Position:  [0.29593284]


portfolio before change:  [1.12228905]
curr_Stock_Price:  103.74693736792257
curr_Factors:  [103.74693737  -1.10945381  -1.03466257]
mat_Sqrt:  [[12.15618705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01920179 -0.0544912   0.35402991]
Stock Position:  0.019201793269159585
Bond Position:  [-0.8698382]


portfolio before change:  [1.13485399]
curr_Stock_Price:  104.4069634742064
curr_Factors:  [104.40696347  -1.13181028  -1.02453191]
mat_Sqrt:  [[12.08486909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00615421  0.00855284  0.11254046]
Stock Position:  -0.006154206385703243
Bond Position:  [1.77739599]


portfolio before change:  [1.13094522]
curr_Stock_Price:  105.07820534690968
curr_Factors:  [105.07820535  -1.13578149  -1.06118839]
mat_Sqrt:  [[11.67833028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01943611 -0.00511065  0.24687685]
Stock Position:  0.019436110129586747
Bond Position:  [-0.91136635]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.14311225]
Stock Price:  105.71006835262081
PL:  [-4.5669561]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 7.23435072e-02 -6.82601561e-02  8.46885766e-03]
 [-4.54177996e-02  5.05445657e-02 -1.32656049e-02]
 [-4.93379812e-02 -1.17665126e-02 -4.99170540e-04]
 [-3.49281129e-01 -1.69100267e-01 -1.98119418e-01]
 [ 1.48874481e-01 -1.45190115e-01 -9.97976944e-02]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.25329670e-02 -1.60985372e-01 -2.72219973e-02]
 [ 1.40663579e-02  6.76260104e-01  9.12625259e-02]
 [ 2.98620155e-01  1.12624990e-03  3.10462785e-01]
 [ 4.24424296e-01  1.65902960e-01  2.79060944e-01]
 [-2.10888095e-01 -2.13313007e-01  3.83569148e-02]
 [ 3.71905621e-03 -1.54493747e-02  1.03724095e-01]
 [ 1.20312769e-02 -5.86842212e-02  9.38858008e-02]
 [-4.42739056e-04  1.75300407e-01 -9.37591261e-02]
 [ 3.01322647e-01 -1.48957757e-01 -1.63172395e-01]
 [-2.12711090e-01 -9.62144758e-02  1.18914675e-01]
 [ 5.07384524e-02  1.82210893e-02 -2.36764763e-02]
 [-5.22145029e-02 -5.79647675e-02  3.51456031e-02]
 [ 1.33070020e-01 -1.57152353e-01 -8.07835534e-03]
 [ 3.63532097e-02 -1.24403927e-02  1.69482368e-01]
 [-3.27847817e-02  4.79995666e-01 -4.62408014e-01]
 [ 3.44641312e-01  2.00350345e-01  6.62555197e-02]
 [ 1.30617548e-02  1.15725495e-01 -1.97516707e-02]
 [ 4.19142647e-02 -1.55876558e-01 -1.96219447e-01]
 [ 5.62836791e-02  2.14748932e-02 -1.40777635e-02]
 [-1.84986073e-02  1.44589306e-02  4.53719233e-02]
 [ 7.85383983e-02 -3.04970332e-02  2.80499879e-02]
 [ 1.57476128e-01 -6.15004408e-02  1.54773511e-01]
 [-4.46626517e-02 -1.28615752e-02 -3.63636783e-02]
 [-6.26179241e-02 -1.39880844e-02  3.88085827e-02]
 [-2.51140705e-02 -4.28042273e-02 -1.19030715e-02]
 [ 2.61405817e-02 -2.53519400e-02 -7.15139329e-02]
 [ 3.74064392e-02  5.03952051e-03  1.49337691e-01]
 [ 3.04978191e-03 -8.55414620e-02 -1.18901653e-01]
 [ 2.70923860e-02  1.23051245e-01 -3.45501675e-02]
 [ 8.04298947e-03  2.66456350e-02  9.51376186e-02]
 [ 4.13151787e-01 -2.50816467e-01  2.25900095e-01]
 [-9.29829614e-02  3.90087899e-02  3.89862777e-02]
 [ 2.53167157e-01 -2.41735264e-02  7.45847117e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.09283228]
curr_Stock_Price:  99.7099270842401
curr_Factors:  [99.70992708 -0.90544662 -0.99951621]
mat_Sqrt:  [[14.83964639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00405257 -0.02203087  0.02415929]
Stock Position:  0.004052566880203441
Bond Position:  [-0.31124887]


portfolio before change:  [0.10014208]
curr_Stock_Price:  101.52327343190642
curr_Factors:  [101.52327343  -0.97158398  -1.00913412]
mat_Sqrt:  [[14.00717877  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00269921  0.01631319 -0.03784308]
Stock Position:  -0.0026992061878097157
Bond Position:  [0.37417432]


portfolio before change:  [0.09949012]
curr_Stock_Price:  101.78213876747431
curr_Factors:  [101.78213877  -1.04706295  -1.02479911]
mat_Sqrt:  [[12.81956579  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00404395 -0.00379763 -0.00142399]
Stock Position:  -0.004043951578124016
Bond Position:  [0.51109216]


portfolio before change:  [0.09979295]
curr_Stock_Price:  101.72305234852382
curr_Factors:  [101.72305235  -1.19146993  -1.01249851]
mat_Sqrt:  [[11.22659494  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0377888  -0.05457688 -0.56517955]
Stock Position:  -0.03778879846706697
Bond Position:  [3.94378488]


portfolio before change:  [0.11966276]
curr_Stock_Price:  101.2102866396911
curr_Factors:  [101.21028664  -0.89365684  -0.98705159]
mat_Sqrt:  [[15.43275145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00640628 -0.04685991 -0.28469504]
Stock Position:  0.006406281745669536
Bond Position:  [-0.52871885]


portfolio before change:  [0.11711499]
curr_Stock_Price:  100.82290470625753
curr_Factors:  [100.82290471  -0.68977581  -1.00071407]
mat_Sqrt:  [[18.59468291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00824452 -0.05534923  0.15513819]
Stock Position:  -0.008244517904890343
Bond Position:  [0.94835123]


portfolio before change:  [0.11173445]
curr_Stock_Price:  101.48990403768272
curr_Factors:  [101.48990404  -0.71577502  -1.00666381]
mat_Sqrt:  [[18.12913832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00501682 -0.05195781 -0.07765678]
Stock Position:  -0.005016820641231066
Bond Position:  [0.62089109]


portfolio before change:  [0.11487713]
curr_Stock_Price:  100.87894620343486
curr_Factors:  [100.8789462   -0.89573888  -1.00245252]
mat_Sqrt:  [[15.11563809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01129534 0.21826201 0.26034658]
Stock Position:  0.011295339148424373
Bond Position:  [-1.02458478]


portfolio before change:  [0.12260587]
curr_Stock_Price:  101.57452699240775
curr_Factors:  [101.57452699  -1.0734161   -0.9990571 ]
mat_Sqrt:  [[12.78560068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.83305422e-02 3.63495591e-04 8.85663908e-01]
Stock Position:  0.028330542249288694
Bond Position:  [-2.75505556]


portfolio before change:  [0.09524935]
curr_Stock_Price:  100.62106426654134
curr_Factors:  [100.62106427  -1.08432402  -1.00154754]
mat_Sqrt:  [[12.49701804  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04123001 0.05354495 0.7960832 ]
Stock Position:  0.0412300095340977
Bond Position:  [-4.05335809]


portfolio before change:  [0.06862091]
curr_Stock_Price:  99.9875029209151
curr_Factors:  [99.98750292 -0.95423876 -0.98894049]
mat_Sqrt:  [[14.32299035  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01721713 -0.06884648  0.1094216 ]
Stock Position:  -0.01721713497030158
Bond Position:  [1.79011924]


portfolio before change:  [0.05598035]
curr_Stock_Price:  100.73468547202842
curr_Factors:  [100.73468547  -1.16605251  -1.01035183]
mat_Sqrt:  [[11.42822132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00190214 -0.00498626  0.29589597]
Stock Position:  0.00190213834921632
Bond Position:  [-0.13563096]


portfolio before change:  [0.0568146]
curr_Stock_Price:  101.18218553490735
curr_Factors:  [101.18218553  -0.96022661  -1.00053186]
mat_Sqrt:  [[14.24155692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00134934 -0.01894025  0.26783006]
Stock Position:  0.0013493446902356542
Bond Position:  [-0.07971505]


portfolio before change:  [0.05882706]
curr_Stock_Price:  102.68100517486403
curr_Factors:  [102.68100517  -0.95436071  -0.96147781]
mat_Sqrt:  [[15.1165267   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107179  0.05657796 -0.26746869]
Stock Position:  0.0010717941728741165
Bond Position:  [-0.05122585]


portfolio before change:  [0.05858707]
curr_Stock_Price:  102.46307224501422
curr_Factors:  [102.46307225  -0.86034563  -0.96281659]
mat_Sqrt:  [[16.549241    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01435772 -0.04807591 -0.46548542]
Stock Position:  0.014357718687277964
Bond Position:  [-1.41254889]


portfolio before change:  [0.0707127]
curr_Stock_Price:  103.3199078666536
curr_Factors:  [103.31990787  -1.05758694  -0.9727776 ]
mat_Sqrt:  [[13.56462809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01533971 -0.03105309  0.33923047]
Stock Position:  -0.015339707818028809
Bond Position:  [1.6556099]


portfolio before change:  [0.06458206]
curr_Stock_Price:  103.73305787914401
curr_Factors:  [103.73305788  -0.99038162  -0.95000085]
mat_Sqrt:  [[14.90114975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00333027  0.00588083 -0.0675424 ]
Stock Position:  0.0033302716221277457
Bond Position:  [-0.2808772]


portfolio before change:  [0.06458154]
curr_Stock_Price:  103.74344330456593
curr_Factors:  [103.7434433   -1.06660059  -0.93430574]
mat_Sqrt:  [[14.02742914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00405437 -0.01870805  0.10026062]
Stock Position:  -0.004054374092568551
Bond Position:  [0.48519627]


portfolio before change:  [0.06613645]
curr_Stock_Price:  103.37488869938345
curr_Factors:  [103.3748887   -1.01648027  -0.9273457 ]
mat_Sqrt:  [[14.79865204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00671294 -0.0507207  -0.0230453 ]
Stock Position:  0.006712938631665743
Bond Position:  [-0.62781283]


portfolio before change:  [0.06163654]
curr_Stock_Price:  102.71624552450402
curr_Factors:  [102.71624552  -0.77738729  -0.93397324]
mat_Sqrt:  [[18.55259646  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00368732 -0.00401512  0.48348602]
Stock Position:  0.0036873150835840447
Bond Position:  [-0.31711062]


portfolio before change:  [0.06395595]
curr_Stock_Price:  103.35602178655813
curr_Factors:  [103.35602179  -0.91182032  -0.94712536]
mat_Sqrt:  [[16.10667641  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00181258  0.15491793 -1.31912136]
Stock Position:  -0.0018125848330021947
Bond Position:  [0.25129751]


portfolio before change:  [0.06269685]
curr_Stock_Price:  104.06799982976382
curr_Factors:  [104.06799983  -1.06822394  -0.94145169]
mat_Sqrt:  [[13.9484571   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02860976 0.0646628  0.18900856]
Stock Position:  0.028609759728153376
Bond Position:  [-2.91466362]


portfolio before change:  [0.02193499]
curr_Stock_Price:  102.65598160909093
curr_Factors:  [102.65598161  -1.08228674  -0.94609242]
mat_Sqrt:  [[13.50424734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00241793  0.03735024 -0.05634602]
Stock Position:  0.002417930357805045
Bond Position:  [-0.22628003]


portfolio before change:  [0.02114457]
curr_Stock_Price:  102.34078330864287
curr_Factors:  [102.34078331  -1.06851588  -0.94906825]
mat_Sqrt:  [[13.60890194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00220128 -0.05030894 -0.55975947]
Stock Position:  -0.002201282036168535
Bond Position:  [0.2464255]


portfolio before change:  [0.02109621]
curr_Stock_Price:  102.37674613366387
curr_Factors:  [102.37674613  -1.15272524  -0.96226505]
mat_Sqrt:  [[12.35016362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00467958  0.00693099 -0.04015994]
Stock Position:  0.004679582688775336
Bond Position:  [-0.45798423]


portfolio before change:  [0.02697711]
curr_Stock_Price:  103.64569442875549
curr_Factors:  [103.64569443  -1.28865868  -0.93343974]
mat_Sqrt:  [[11.23326969  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055956  0.0046666   0.12943347]
Stock Position:  -0.0005595597381121756
Bond Position:  [0.08497307]


portfolio before change:  [0.02736731]
curr_Stock_Price:  102.96734319912719
curr_Factors:  [102.9673432   -1.21218818  -0.91924808]
mat_Sqrt:  [[12.21879843  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00638679 -0.00984288  0.08001881]
Stock Position:  0.006386789807528162
Bond Position:  [-0.63026347]


portfolio before change:  [0.03185736]
curr_Stock_Price:  103.68270103136655
curr_Factors:  [103.68270103  -1.08022681  -0.91581226]
mat_Sqrt:  [[14.08761731  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01252983 -0.01984918  0.44152575]
Stock Position:  0.012529827452449183
Bond Position:  [-1.26726899]


portfolio before change:  [0.03050735]
curr_Stock_Price:  103.58760039930472
curr_Factors:  [103.5876004   -1.19930565  -0.91796358]
mat_Sqrt:  [[12.4677886   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00438817 -0.00415106 -0.10373545]
Stock Position:  -0.004388165075266457
Bond Position:  [0.48506684]


portfolio before change:  [0.03134536]
curr_Stock_Price:  103.41044900667835
curr_Factors:  [103.41044901  -1.21975179  -0.89976249]
mat_Sqrt:  [[12.41855503  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00463431 -0.00451463  0.11071008]
Stock Position:  -0.004634312204490863
Bond Position:  [0.51058166]


portfolio before change:  [0.02689502]
curr_Stock_Price:  104.38452383530135
curr_Factors:  [104.38452384  -1.62590379  -0.90687236]
mat_Sqrt:  [[ 8.29211675  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00437538 -0.013815   -0.03395615]
Stock Position:  -0.0043753787164067465
Bond Position:  [0.48361684]


portfolio before change:  [0.02961344]
curr_Stock_Price:  103.77704097902206
curr_Factors:  [103.77704098  -1.65447594  -0.91051829]
mat_Sqrt:  [[ 7.98249111  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079774 -0.0081823  -0.20400934]
Stock Position:  0.000797735707376934
Bond Position:  [-0.05317321]


portfolio before change:  [0.02931204]
curr_Stock_Price:  103.40755011041745
curr_Factors:  [103.40755011  -1.28927593  -0.90041049]
mat_Sqrt:  [[11.57666641  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00595323 0.0016265  0.42601886]
Stock Position:  0.005953229802991243
Bond Position:  [-0.58629687]


portfolio before change:  [0.03486337]
curr_Stock_Price:  104.35235175865913
curr_Factors:  [104.35235176  -1.48445794  -0.90989034]
mat_Sqrt:  [[ 9.52028595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00406311 -0.02760839 -0.33919332]
Stock Position:  -0.004063112641851302
Bond Position:  [0.45885873]


portfolio before change:  [0.0329126]
curr_Stock_Price:  104.84658591728612
curr_Factors:  [104.84658592  -1.22398482  -0.91188593]
mat_Sqrt:  [[12.38675112  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00364564  0.03971462 -0.09856201]
Stock Position:  0.003645636567175522
Bond Position:  [-0.34931995]


portfolio before change:  [0.03506455]
curr_Stock_Price:  105.44884418482104
curr_Factors:  [105.44884418  -1.27987279  -0.88823094]
mat_Sqrt:  [[12.06275027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00272756 0.00859984 0.27140114]
Stock Position:  0.002727561400844001
Bond Position:  [-0.25255365]


portfolio before change:  [0.03528149]
curr_Stock_Price:  105.5399553525709
curr_Factors:  [105.53995535  -1.31838376  -0.88575047]
mat_Sqrt:  [[11.64591385  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03503939 -0.08095067  0.64443009]
Stock Position:  0.03503939311701053
Bond Position:  [-3.6627745]


portfolio before change:  [0.04312418]
curr_Stock_Price:  105.77684793125853
curr_Factors:  [105.77684793  -1.11009058  -0.88209798]
mat_Sqrt:  [[14.42760099  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00534131  0.01259003  0.111217  ]
Stock Position:  -0.005341309685872565
Bond Position:  [0.60811109]


portfolio before change:  [0.04596652]
curr_Stock_Price:  105.25893738721214
curr_Factors:  [105.25893739  -0.95684308  -0.85505457]
mat_Sqrt:  [[17.19340247  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01532316 -0.00780197  0.21276942]
Stock Position:  0.015323162329775325
Bond Position:  [-1.56693326]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.06135074]
Stock Price:  106.27570534748465
PL:  [-6.2143546]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 4.80526626e-02 -7.13419263e-02  9.41721272e-03]
 [-2.96948417e-01  1.40942246e-03 -5.25324709e-01]
 [-2.38653567e-02  5.61604507e-02  3.26255253e-02]
 [ 9.37800065e-02  6.99263688e-02  8.96772299e-02]
 [ 3.16635022e-02  4.52367355e-02 -7.10855533e-02]
 [-7.17494200e-02 -1.51732787e-01  1.57660651e-01]
 [-6.29560274e-02 -1.55991847e-01  5.23028408e-02]
 [ 1.98787869e-02  7.20029078e-01  1.00596283e-01]
 [ 1.41020522e-01 -2.35739605e-03  1.21253181e-01]
 [ 2.93175348e-01  1.07675132e-01  1.56966796e-01]
 [-2.23410885e-01 -2.35066983e-01  2.71192492e-02]
 [-3.81710112e-02 -1.80317522e-02  9.22806152e-02]
 [ 1.16341298e-02 -5.89494749e-02  9.84000175e-02]
 [ 4.90675931e-03  1.21855193e-02 -2.26075336e-02]
 [ 9.13804336e-02 -1.26188990e-01 -9.54455297e-02]
 [-3.16724237e-02 -4.13196286e-02  7.66745713e-02]
 [ 5.08913600e-02  1.79466580e-02 -2.45707973e-02]
 [-4.71336250e-02 -5.49593243e-02  4.23798892e-02]
 [ 8.74117759e-02 -5.78075690e-02 -7.55902711e-02]
 [ 3.96991945e-02 -9.08660595e-03  1.17861492e-01]
 [-2.66504738e-02  4.34539957e-01 -4.14624876e-01]
 [ 3.25181898e-01  1.91039081e-01  6.94243481e-02]
 [-1.41396452e-02  1.85296846e-02  3.79505404e-02]
 [ 1.40568276e-02 -1.25329656e-01 -1.61697464e-01]
 [ 3.57708904e-02  1.60266730e-02 -1.26318789e-02]
 [-5.29771741e-02 -5.13166186e-03  1.66789249e-01]
 [ 3.69866806e-02 -3.35018224e-02  1.01399383e-02]
 [ 3.01808378e-02 -3.74612517e-02 -2.09093493e-01]
 [-5.37993828e-02 -3.64588255e-02  6.52564935e-03]
 [-6.82579915e-02 -7.14764617e-03  3.12507429e-02]
 [-3.25021903e-02 -4.77706850e-02 -1.74061179e-02]
 [ 3.13897297e-02  1.58040215e-02 -4.79516627e-02]
 [-4.15230432e-02  1.91484171e-02 -1.49246486e-02]
 [ 2.28096247e-02 -5.47187516e-02  6.79370356e-02]
 [-5.91693356e-02  2.34956539e-02 -5.58577153e-03]
 [ 8.90065489e-02 -5.24063958e-03  1.57226991e-01]
 [-6.68396565e-02  7.73799634e-02 -2.63368525e-02]
 [-3.27893969e-02 -3.07586899e-02  1.34247073e-02]
 [ 9.44108380e-02  5.87603555e-03  8.67910992e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.03442143]
curr_Stock_Price:  99.95470797625175
curr_Factors:  [99.95470798 -1.3617145  -1.01033513]
mat_Sqrt:  [[ 9.32470696  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00379769 -0.02302551  0.02686469]
Stock Position:  0.0037976886041761106
Bond Position:  [1.65482458]


portfolio before change:  [2.03324886]
curr_Stock_Price:  99.59147572571312
curr_Factors:  [99.59147573 -1.53446513 -0.99211056]
mat_Sqrt:  [[ 7.96057221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.07365759e-02  4.54889144e-04 -1.49860517e+00]
Stock Position:  -0.050736575926813625
Bond Position:  [7.08617933]


portfolio before change:  [2.04711882]
curr_Stock_Price:  99.33556292689843
curr_Factors:  [99.33556293 -1.62221033 -0.96974209]
mat_Sqrt:  [[ 7.43762235  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00077202  0.01812571  0.09307154]
Stock Position:  -0.000772020266976166
Bond Position:  [2.12380789]


portfolio before change:  [2.0473762]
curr_Stock_Price:  99.34606926523703
curr_Factors:  [99.34606927 -1.23965968 -0.97465095]
mat_Sqrt:  [[10.85145061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01164443 0.02256864 0.25582418]
Stock Position:  0.011644429784044903
Bond Position:  [0.89054788]


portfolio before change:  [2.05011487]
curr_Stock_Price:  99.57169994094329
curr_Factors:  [99.57169994 -1.35222406 -0.9479155 ]
mat_Sqrt:  [[ 9.98155036  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00264359  0.01460009 -0.2027873 ]
Stock Position:  0.0026435907657924554
Bond Position:  [1.78688804]


portfolio before change:  [2.04952812]
curr_Stock_Price:  99.26525092998429
curr_Factors:  [99.26525093 -1.2602815  -0.94239191]
mat_Sqrt:  [[10.96953805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00643048 -0.04897155  0.44976195]
Stock Position:  -0.006430480439315526
Bond Position:  [2.68785137]


portfolio before change:  [2.05261197]
curr_Stock_Price:  98.83793493009591
curr_Factors:  [98.83793493 -1.17038721 -0.97493905]
mat_Sqrt:  [[11.56698857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00727255 -0.05034615  0.14920545]
Stock Position:  -0.007272546067201197
Bond Position:  [2.7714154]


portfolio before change:  [2.05323571]
curr_Stock_Price:  98.79980679184717
curr_Factors:  [98.79980679 -1.17324525 -0.97319731]
mat_Sqrt:  [[11.54962639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01622461 0.23238839 0.28697319]
Stock Position:  0.01622461463022548
Bond Position:  [0.45024691]


portfolio before change:  [2.05369598]
curr_Stock_Price:  98.82470652789372
curr_Factors:  [98.82470653 -0.85365056 -0.97809981]
mat_Sqrt:  [[15.82509965  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0104448  -0.00076085  0.34590157]
Stock Position:  0.010444801330714256
Bond Position:  [1.02149155]


portfolio before change:  [2.05015686]
curr_Stock_Price:  98.47364096962501
curr_Factors:  [98.47364097 -0.87663009 -0.96712531]
mat_Sqrt:  [[15.5807084   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02228366 0.034752   0.44778258]
Stock Position:  0.022283656602741144
Bond Position:  [-0.14419594]


portfolio before change:  [2.06253722]
curr_Stock_Price:  99.03002997422713
curr_Factors:  [99.03002997 -0.79209473 -0.97030541]
mat_Sqrt:  [[16.99676428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01564169 -0.07586754  0.07736367]
Stock Position:  -0.015641685349938837
Bond Position:  [3.61153379]


portfolio before change:  [2.06304745]
curr_Stock_Price:  99.02627339742006
curr_Factors:  [99.0262734  -0.85573135 -0.92754407]
mat_Sqrt:  [[16.64499851  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013827  -0.00581972  0.26325091]
Stock Position:  -0.0013826991655943525
Bond Position:  [2.19997099]


portfolio before change:  [2.06109391]
curr_Stock_Price:  100.63801505916996
curr_Factors:  [100.63801506  -1.01885362  -0.94924911]
mat_Sqrt:  [[14.06131401  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00140008 -0.01902586  0.28070786]
Stock Position:  0.0014000781214430307
Bond Position:  [1.92019282]


portfolio before change:  [2.06246039]
curr_Stock_Price:  101.44256917302472
curr_Factors:  [101.44256917  -1.22209732  -0.95135891]
mat_Sqrt:  [[11.54250815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00024079  0.00393286 -0.064493  ]
Stock Position:  0.0002407946801420825
Bond Position:  [2.03803355]


portfolio before change:  [2.06257316]
curr_Stock_Price:  100.85286577375098
curr_Factors:  [100.85286577  -1.11611064  -0.94434894]
mat_Sqrt:  [[12.84819195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00359113 -0.04072732 -0.27227953]
Stock Position:  0.0035911260408307923
Bond Position:  [1.70039781]


portfolio before change:  [2.06220941]
curr_Stock_Price:  100.6923829758541
curr_Factors:  [100.69238298  -0.9585253   -0.94154698]
mat_Sqrt:  [[15.0593323   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162395 -0.01333585  0.21873121]
Stock Position:  -0.001623951561587572
Bond Position:  [2.22572896]


portfolio before change:  [2.06088987]
curr_Stock_Price:  101.67625923248998
curr_Factors:  [101.67625923  -0.91138179  -0.97940415]
mat_Sqrt:  [[15.34834879  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00322766  0.00579226 -0.07009365]
Stock Position:  0.0032276575107671943
Bond Position:  [1.73271373]


portfolio before change:  [2.0599605]
curr_Stock_Price:  101.32120929350445
curr_Factors:  [101.32120929  -0.99491572  -0.97327936]
mat_Sqrt:  [[14.15546387  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00351111 -0.01773805  0.12089803]
Stock Position:  -0.0035111100468197165
Bond Position:  [2.41571041]


portfolio before change:  [2.05967954]
curr_Stock_Price:  101.48723643612404
curr_Factors:  [101.48723644  -1.15346342  -0.98147162]
mat_Sqrt:  [[12.00109628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00501471 -0.01865731 -0.215638  ]
Stock Position:  0.005014713185135092
Bond Position:  [1.55075016]


portfolio before change:  [2.06172908]
curr_Stock_Price:  101.8572852414612
curr_Factors:  [101.85728524  -1.37335237  -0.98277806]
mat_Sqrt:  [[ 9.65467484  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00641169 -0.00293269  0.33622603]
Stock Position:  0.006411689283436423
Bond Position:  [1.40865182]


portfolio before change:  [2.06241872]
curr_Stock_Price:  101.93737980745689
curr_Factors:  [101.93737981  -1.22781395  -0.96948091]
mat_Sqrt:  [[11.32557951  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199419  0.14024717 -1.18280936]
Stock Position:  -0.001994187133507459
Bond Position:  [2.26570093]


portfolio before change:  [2.06525738]
curr_Stock_Price:  100.65594136829095
curr_Factors:  [100.65594137  -0.82884272  -0.99411301]
mat_Sqrt:  [[16.26072109  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02326765 0.0616576  0.19804834]
Stock Position:  0.02326765037687288
Bond Position:  [-0.27676988]


portfolio before change:  [2.06461161]
curr_Stock_Price:  100.62967458230803
curr_Factors:  [100.62967458  -0.87355953  -0.96136262]
mat_Sqrt:  [[16.06310514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00016253  0.00598043  0.10826233]
Stock Position:  -0.00016252570828427057
Bond Position:  [2.08096652]


portfolio before change:  [2.0648122]
curr_Stock_Price:  100.99604327742462
curr_Factors:  [100.99604328  -0.95116652  -1.00571545]
mat_Sqrt:  [[14.27056996  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00312057 -0.04044997 -0.46127786]
Stock Position:  -0.003120571772381268
Bond Position:  [2.37997761]


portfolio before change:  [2.06894343]
curr_Stock_Price:  99.76751440309282
curr_Factors:  [99.7675144  -1.05262795 -0.98220234]
mat_Sqrt:  [[13.03987966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00279633  0.00517259 -0.03603523]
Stock Position:  0.0027963333062500286
Bond Position:  [1.78996021]


portfolio before change:  [2.07024244]
curr_Stock_Price:  100.15203535174581
curr_Factors:  [100.15203535  -1.12628799  -0.98974029]
mat_Sqrt:  [[12.06925252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00165536 -0.00165624  0.4758033 ]
Stock Position:  -0.0016553599610119563
Bond Position:  [2.23603011]


portfolio before change:  [2.06875609]
curr_Stock_Price:  101.2187954897293
curr_Factors:  [101.21879549  -1.15598457  -1.00781846]
mat_Sqrt:  [[11.62876109  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00277054 -0.01081267  0.02892642]
Stock Position:  0.0027705407075987584
Bond Position:  [1.7883253]


portfolio before change:  [2.06625324]
curr_Stock_Price:  100.23472517185752
curr_Factors:  [100.23472517  -1.00403662  -1.00634569]
mat_Sqrt:  [[13.42518443  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00150068 -0.01209057 -0.59648553]
Stock Position:  -0.0015006824492070142
Bond Position:  [2.21667373]


portfolio before change:  [2.06557671]
curr_Stock_Price:  100.87018877432033
curr_Factors:  [100.87018877  -1.08028018  -0.99366239]
mat_Sqrt:  [[12.6782999   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00472535 -0.01176704  0.01861586]
Stock Position:  -0.0047253549155008585
Bond Position:  [2.54222415]


portfolio before change:  [2.06348224]
curr_Stock_Price:  101.3806837686169
curr_Factors:  [101.38068377  -0.86673426  -0.9967315 ]
mat_Sqrt:  [[15.72759514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00402719 -0.00230689  0.08914967]
Stock Position:  -0.004027187048663068
Bond Position:  [2.47176121]


portfolio before change:  [2.06447163]
curr_Stock_Price:  101.21173097651061
curr_Factors:  [101.21173098  -0.79337652  -0.99338685]
mat_Sqrt:  [[16.95311     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270194 -0.01541792 -0.04965481]
Stock Position:  -0.002701943741784921
Bond Position:  [2.33794003]


portfolio before change:  [2.0658779]
curr_Stock_Price:  100.79943198656775
curr_Factors:  [100.79943199  -0.69861745  -0.98137758]
mat_Sqrt:  [[18.7864843   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00132157  0.00510073 -0.13679275]
Stock Position:  0.0013215681841882432
Bond Position:  [1.93266458]


portfolio before change:  [2.06541117]
curr_Stock_Price:  100.26345709127517
curr_Factors:  [100.26345709  -0.7765608   -0.93078253]
mat_Sqrt:  [[18.18247041  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223627  0.00618013 -0.04257587]
Stock Position:  -0.002236267630746805
Bond Position:  [2.2896271]


portfolio before change:  [2.06695132]
curr_Stock_Price:  99.7027331287321
curr_Factors:  [99.70273313 -0.8397449  -0.93595347]
mat_Sqrt:  [[16.88616623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00151057 -0.0176604   0.19380545]
Stock Position:  0.001510573525583745
Bond Position:  [1.91634301]


portfolio before change:  [2.06752701]
curr_Stock_Price:  99.92524930542447
curr_Factors:  [99.92524931 -0.71500327 -0.92865799]
mat_Sqrt:  [[19.31266592  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00287446  0.00758319 -0.01593465]
Stock Position:  -0.0028744605417311115
Bond Position:  [2.35475819]


portfolio before change:  [2.06639216]
curr_Stock_Price:  100.422460096033
curr_Factors:  [100.4224601   -0.63210766  -0.9479227 ]
mat_Sqrt:  [[20.68389813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0058031  -0.00169141  0.44852484]
Stock Position:  0.005803095345302406
Bond Position:  [1.48363105]


portfolio before change:  [2.06325441]
curr_Stock_Price:  99.84979866339656
curr_Factors:  [99.84979866 -0.53178431 -0.95058221]
mat_Sqrt:  [[22.67585087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00248813  0.02497428 -0.07513171]
Stock Position:  -0.002488132656651581
Bond Position:  [2.31169396]


portfolio before change:  [2.06460782]
curr_Stock_Price:  99.42199751983522
curr_Factors:  [99.42199752 -0.58963309 -0.94996795]
mat_Sqrt:  [[21.32270253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170371 -0.00992732  0.03829695]
Stock Position:  -0.0017037090508333407
Bond Position:  [2.23399398]


portfolio before change:  [2.06301316]
curr_Stock_Price:  100.5219064924053
curr_Factors:  [100.52190649  -0.41558307  -0.96862316]
mat_Sqrt:  [[25.1830071   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00450012 0.00189648 0.24759085]
Stock Position:  0.004500115383585238
Bond Position:  [1.61065298]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.06472792]
Stock Price:  100.85821264903647
PL:  [1.20651527]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.32521517e-01 -1.06938265e-01  2.03712964e-02]
 [-9.32642893e-02  7.17812772e-02 -9.24778668e-02]
 [-3.96664904e-03  1.52399449e-02  4.36841131e-02]
 [ 1.10977700e-01  2.18160066e-02  1.41102718e-01]
 [-2.20099990e-02  1.36232428e-01 -5.12429205e-02]
 [-1.21250835e-01 -1.59181985e-01  1.22694593e-01]
 [-6.02988137e-02 -1.85030883e-01  1.04203924e-01]
 [ 1.39478048e-02  6.12846937e-01  8.42687247e-02]
 [ 1.14829213e-01  2.07423480e-02  1.22147857e-01]
 [ 3.58859619e-01  1.35073759e-01  2.12448226e-01]
 [-1.88179969e-01 -2.32393360e-01  1.81340756e-02]
 [-2.18318994e-02 -1.74664516e-02  9.43060967e-02]
 [-2.70346273e-02  1.32038181e-01 -3.80653759e-02]
 [ 7.48254664e-03 -7.43365722e-02  5.75336365e-02]
 [-9.02001918e-02  1.95474019e-01 -3.95147329e-02]
 [-6.10653506e-04 -3.12140091e-02  1.74091221e-02]
 [ 4.48611102e-02  1.01312097e-01 -1.69544089e-01]
 [ 9.98743194e-02 -2.11103518e-02 -1.00886699e-01]
 [ 1.42070131e-02  1.92660910e-01 -1.04247016e-01]
 [-9.44704237e-02 -1.51628727e-02 -2.48864939e-02]
 [-2.95102262e-02  4.07061978e-01 -3.42383781e-01]
 [ 1.36356003e-01  5.60537197e-02  1.02370119e-01]
 [ 8.33732224e-03 -5.62455138e-02  8.37218547e-02]
 [ 2.05622559e-01  1.98750782e-01 -1.94800522e-01]
 [-2.03067901e-01  7.98608790e-02  1.10307821e-02]
 [-1.77471745e-01 -4.49590349e-02  1.31603058e-01]
 [-7.70030114e-02 -3.50467383e-02 -2.14377770e-02]
 [-1.06090785e-01  1.39120054e-01 -5.95593532e-02]
 [ 1.42360461e-01  9.05757584e-03  1.72111144e-01]
 [ 1.22364262e-01  8.33779533e-02 -1.66889020e-01]
 [-7.70157135e-03  2.83542477e-03  2.96319945e-02]
 [-2.33076259e-02  5.31049865e-02 -1.10666462e-01]
 [-1.45178872e-03  8.66540245e-02 -1.08690387e-02]
 [ 3.67146873e-02 -3.46582648e-02  1.81927176e-01]
 [-8.13652867e-02  1.15957247e-01 -1.20350163e-01]
 [-2.41481460e-01 -2.50449030e-01 -2.28810840e-01]
 [ 1.08618907e-01  1.53485767e-01  3.91176403e-01]
 [ 2.50591195e-01 -1.64662892e-01 -3.44846409e-01]
 [ 9.32904963e-02  6.57011550e-03  9.34232991e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.35110644]
curr_Stock_Price:  100.62499545466954
curr_Factors:  [100.62499545  -0.92997763  -1.0130501 ]
mat_Sqrt:  [[14.41649391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01735456 -0.03451418  0.05811364]
Stock Position:  -0.01735456120385629
Bond Position:  [9.09740908]


portfolio before change:  [7.35073074]
curr_Stock_Price:  100.71217413028035
curr_Factors:  [100.71217413  -0.87440239  -0.99483839]
mat_Sqrt:  [[15.53391829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00627588  0.02316731 -0.26381361]
Stock Position:  -0.006275877157797241
Bond Position:  [7.98278797]


portfolio before change:  [7.35337648]
curr_Stock_Price:  100.44960829325176
curr_Factors:  [100.44960829  -0.89612948  -0.99365006]
mat_Sqrt:  [[15.17844999  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00053109 0.00491867 0.12461862]
Stock Position:  0.0005310933555954273
Bond Position:  [7.30002836]


portfolio before change:  [7.35411951]
curr_Stock_Price:  100.13039009647001
curr_Factors:  [100.1303901   -1.13241336  -1.01838771]
mat_Sqrt:  [[11.6542646   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01237601 0.00704109 0.40252678]
Stock Position:  0.012376014287654042
Bond Position:  [6.11490437]


portfolio before change:  [7.34328906]
curr_Stock_Price:  99.19350913941314
curr_Factors:  [99.19350914 -1.13446314 -1.02576451]
mat_Sqrt:  [[11.43689961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00040759  0.04396883 -0.14618179]
Stock Position:  -0.00040759196595402673
Bond Position:  [7.38371954]


portfolio before change:  [7.34382316]
curr_Stock_Price:  100.1477050632945
curr_Factors:  [100.14770506  -1.07123393  -1.0119732 ]
mat_Sqrt:  [[12.47141236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0103195  -0.05137576  0.35001352]
Stock Position:  -0.01031950422459188
Bond Position:  [8.37729783]


portfolio before change:  [7.34859534]
curr_Stock_Price:  99.78674336865453
curr_Factors:  [99.78674337 -1.08232954 -1.00939732]
mat_Sqrt:  [[12.32104141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00623304 -0.05971846  0.29726479]
Stock Position:  -0.006233040292598564
Bond Position:  [7.97057013]


portfolio before change:  [7.3410307]
curr_Stock_Price:  101.16023425322463
curr_Factors:  [101.16023425  -1.14884667  -1.02679752]
mat_Sqrt:  [[11.48522646  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01360408 0.1977955  0.24039522]
Stock Position:  0.013604080316245415
Bond Position:  [5.96483875]


portfolio before change:  [7.33433433]
curr_Stock_Price:  100.61319112283475
curr_Factors:  [100.61319112  -1.46922601  -1.0030097 ]
mat_Sqrt:  [[ 8.4913472   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01695803 0.00669456 0.34845384]
Stock Position:  0.016958033954024936
Bond Position:  [5.62813242]


portfolio before change:  [7.32192495]
curr_Stock_Price:  99.83993274666202
curr_Factors:  [99.83993275 -1.10801236 -0.98336572]
mat_Sqrt:  [[12.33190928  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03485245 0.04359487 0.60605566]
Stock Position:  0.03485244966957352
Bond Position:  [3.84225872]


portfolio before change:  [7.30472394]
curr_Stock_Price:  99.33261344834706
curr_Factors:  [99.33261345 -1.0279559  -0.96873661]
mat_Sqrt:  [[13.48774438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01719453 -0.07500463  0.05173147]
Stock Position:  -0.017194532732411623
Bond Position:  [9.01270181]


portfolio before change:  [7.32007665]
curr_Stock_Price:  98.50525446403722
curr_Factors:  [98.50525446 -1.01496499 -0.95130907]
mat_Sqrt:  [[13.78851271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044581 -0.00563727  0.26902904]
Stock Position:  -0.0004458111338575029
Bond Position:  [7.36399139]


portfolio before change:  [7.32132418]
curr_Stock_Price:  97.77182215635092
curr_Factors:  [97.77182216 -0.85952632 -0.91786058]
mat_Sqrt:  [[16.53120017  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047501  0.04261514 -0.10858992]
Stock Position:  -0.00047501141197024704
Bond Position:  [7.36776691]


portfolio before change:  [7.32273832]
curr_Stock_Price:  96.73370859399903
curr_Factors:  [96.73370859 -0.62224826 -0.9010964 ]
mat_Sqrt:  [[21.08616779  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0001922  -0.02399203  0.16412745]
Stock Position:  0.00019219527139586226
Bond Position:  [7.30414656]


portfolio before change:  [7.3235377]
curr_Stock_Price:  96.14213815070698
curr_Factors:  [96.14213815 -0.68925356 -0.88284828]
mat_Sqrt:  [[19.95991194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00292412  0.06308897 -0.11272453]
Stock Position:  -0.0029241179056093635
Bond Position:  [7.60466865]


portfolio before change:  [7.32396982]
curr_Stock_Price:  96.31946348943882
curr_Factors:  [96.31946349 -0.71981919 -0.88402343]
mat_Sqrt:  [[19.37198202  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00017699 -0.01007428  0.04966338]
Stock Position:  -0.0001769857245576433
Bond Position:  [7.34101699]


portfolio before change:  [7.3249336]
curr_Stock_Price:  96.05903785874268
curr_Factors:  [96.05903786 -0.43654027 -0.86962541]
mat_Sqrt:  [[26.01822623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00118891  0.03269834 -0.48366209]
Stock Position:  0.0011889093775753277
Bond Position:  [7.21072811]


portfolio before change:  [7.3235876]
curr_Stock_Price:  94.16873987640629
curr_Factors:  [94.16873988 -0.4738254  -0.85460295]
mat_Sqrt:  [[24.94466398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00300552 -0.00681334 -0.28780167]
Stock Position:  0.003005523577877766
Bond Position:  [7.04056124]


portfolio before change:  [7.32511203]
curr_Stock_Price:  94.3831123817834
curr_Factors:  [94.38311238 -0.3366923  -0.84997323]
mat_Sqrt:  [[28.80925339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00111959  0.06218104 -0.29738772]
Stock Position:  0.0011195855443908822
Bond Position:  [7.21944206]


portfolio before change:  [7.32562554]
curr_Stock_Price:  94.03567988992123
curr_Factors:  [94.03567989 -0.48594996 -0.84538275]
mat_Sqrt:  [[24.83717622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00413273 -0.0048938  -0.07099424]
Stock Position:  -0.004132734958524638
Bond Position:  [7.71425008]


portfolio before change:  [7.32841061]
curr_Stock_Price:  93.59511635051304
curr_Factors:  [93.59511635 -0.67682534 -0.85608579]
mat_Sqrt:  [[20.20776788  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.07008700e-04  1.31378688e-01 -9.76725625e-01]
Stock Position:  -0.0008070086998234038
Bond Position:  [7.40394268]


portfolio before change:  [7.3290044]
curr_Stock_Price:  94.00621259545116
curr_Factors:  [94.0062126  -0.89650577 -0.88238034]
mat_Sqrt:  [[15.87070189  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01062928 0.01809126 0.29203346]
Stock Position:  0.01062927995673577
Bond Position:  [6.32978605]


portfolio before change:  [7.34149324]
curr_Stock_Price:  95.1067162513229
curr_Factors:  [95.10671625 -0.9468342  -0.89636184]
mat_Sqrt:  [[15.05640593  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00092624 -0.01815316  0.23883515]
Stock Position:  0.0009262440794819913
Bond Position:  [7.2534012]


portfolio before change:  [7.34125057]
curr_Stock_Price:  93.86578569094618
curr_Factors:  [93.86578569 -0.81077789 -0.92630011]
mat_Sqrt:  [[16.52357172  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.012493    0.06414654 -0.55571167]
Stock Position:  0.012492995200897713
Bond Position:  [6.16858575]


portfolio before change:  [7.33797521]
curr_Stock_Price:  93.5418864630473
curr_Factors:  [93.54188646 -0.65716941 -0.89569224]
mat_Sqrt:  [[19.79734165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00932018  0.02577499  0.03146775]
Stock Position:  -0.009320176519782983
Bond Position:  [8.20980211]


portfolio before change:  [7.33703611]
curr_Stock_Price:  93.75276160582887
curr_Factors:  [93.75276161 -0.38808422 -0.92234366]
mat_Sqrt:  [[25.28555396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00631924 -0.01451047  0.37542689]
Stock Position:  -0.0063192449112322744
Bond Position:  [7.92948277]


portfolio before change:  [7.34033657]
curr_Stock_Price:  93.3873366993833
curr_Factors:  [93.3873367  -0.80640803 -0.90486006]
mat_Sqrt:  [[16.86916945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524821 -0.01131129 -0.06115601]
Stock Position:  -0.005248205315882064
Bond Position:  [7.83045248]


portfolio before change:  [7.33985477]
curr_Stock_Price:  93.66565443473803
curr_Factors:  [93.66565443 -0.6572063  -0.87146763]
mat_Sqrt:  [[20.30886799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0044242   0.0449008  -0.16990626]
Stock Position:  -0.0044242015295429754
Bond Position:  [7.7542505]


portfolio before change:  [7.33844171]
curr_Stock_Price:  94.20414698123369
curr_Factors:  [94.20414698 -0.87023274 -0.85894192]
mat_Sqrt:  [[16.71471622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01072955 0.00292332 0.49098519]
Stock Position:  0.010729549288721161
Bond Position:  [6.32767367]


portfolio before change:  [7.31737637]
curr_Stock_Price:  92.16712339716811
curr_Factors:  [92.1671234  -0.62741762 -0.82095263]
mat_Sqrt:  [[21.65493204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00486345  0.02691012 -0.47608792]
Stock Position:  0.004863448050410572
Bond Position:  [6.86912636]


portfolio before change:  [7.32315065]
curr_Stock_Price:  93.17784216966882
curr_Factors:  [93.17784217 -0.80917456 -0.79726786]
mat_Sqrt:  [[18.691475    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.74693625e-05  9.15129410e-04  8.45318323e-02]
Stock Position:  -5.746936248750271e-05
Bond Position:  [7.32850552]


portfolio before change:  [7.32412439]
curr_Stock_Price:  92.17518788450651
curr_Factors:  [92.17518788 -0.54050601 -0.79383734]
mat_Sqrt:  [[24.27258758  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144432  0.01713956 -0.31570061]
Stock Position:  -0.0014443170776766395
Bond Position:  [7.45725459]


portfolio before change:  [7.32636015]
curr_Stock_Price:  91.27265151206194
curr_Factors:  [91.27265151 -0.36965735 -0.75929142]
mat_Sqrt:  [[29.5151127   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00047493  0.02796747 -0.03100634]
Stock Position:  0.00047493488739720204
Bond Position:  [7.28301159]


portfolio before change:  [7.32694292]
curr_Stock_Price:  90.58274558805431
curr_Factors:  [90.58274559 -0.25791005 -0.73813802]
mat_Sqrt:  [[33.45548247  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00199596 -0.01118591  0.51898759]
Stock Position:  0.0019959606919442404
Bond Position:  [7.14614332]


portfolio before change:  [7.32626437]
curr_Stock_Price:  89.79521635726094
curr_Factors:  [89.79521636 -0.32189983 -0.75968091]
mat_Sqrt:  [[30.44588846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270191  0.03742504 -0.34332552]
Stock Position:  -0.0027019079087783307
Bond Position:  [7.56888278]


portfolio before change:  [7.32821031]
curr_Stock_Price:  89.42519453813138
curr_Factors:  [89.42519454 -0.49179984 -0.76447919]
mat_Sqrt:  [[25.46037785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01332698 -0.08083208 -0.65273364]
Stock Position:  -0.013326980989758678
Bond Position:  [8.51997817]


portfolio before change:  [7.34207613]
curr_Stock_Price:  88.46467984929016
curr_Factors:  [88.46467985 -0.68993375 -0.78940358]
mat_Sqrt:  [[20.15124434  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0109074  0.04953732 1.1159174 ]
Stock Position:  0.010907396228274482
Bond Position:  [6.37715681]


portfolio before change:  [7.33629777]
curr_Stock_Price:  87.8618269860593
curr_Factors:  [87.86182699 -0.90182337 -0.79151894]
mat_Sqrt:  [[16.15812654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00907209 -0.05314472 -0.98375082]
Stock Position:  0.00907209410778862
Bond Position:  [6.53920701]


portfolio before change:  [7.33547484]
curr_Stock_Price:  87.68101026379249
curr_Factors:  [87.68101026 -0.99948004 -0.802047  ]
mat_Sqrt:  [[14.47145825  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00785695 0.0021205  0.26651067]
Stock Position:  0.007856952953304259
Bond Position:  [6.64656926]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.3422887]
Stock Price:  88.44250000464903
PL:  [7.3422887]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.17010527e-01 -9.22834301e-02  1.58615548e-02]
 [-1.53440461e-01  7.11178235e-02 -1.57160844e-01]
 [-1.65020981e-02  2.85070928e-02  3.48227431e-02]
 [-2.48849885e-01 -8.28078128e-02 -1.41880056e-01]
 [ 6.03576618e-02  2.84631822e-03 -7.66286056e-02]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.22682753e-02 -1.72391822e-01 -2.74986933e-02]
 [ 1.09786245e-02  6.56242864e-01  9.39213972e-02]
 [ 4.09663682e-01  4.73709211e-02  4.05910627e-01]
 [ 6.46899527e-01  2.88970720e-01  5.64659517e-01]
 [-1.61343251e-01 -2.39181454e-01 -7.24037564e-03]
 [-5.10809015e-02 -1.84784086e-02  9.06802379e-02]
 [ 1.47554732e-02 -5.34645492e-02  5.65484660e-02]
 [ 1.00982444e-03  1.32264879e-01 -5.26097673e-02]
 [ 3.67842626e-01 -1.75957335e-01 -1.75826286e-01]
 [-2.04842387e-01 -9.57997416e-02  1.17324785e-01]
 [ 5.37084377e-02  2.43257433e-03 -7.81530573e-03]
 [-6.00007401e-02 -6.25704861e-02  2.40593559e-02]
 [ 1.65671607e-01 -2.03453775e-01  3.28317228e-02]
 [ 5.06126916e-02 -6.03832862e-03  3.05413971e-01]
 [-2.92410399e-02  4.53736257e-01 -4.34804068e-01]
 [ 3.15779631e-01  1.86540128e-01  7.09554411e-02]
 [ 1.93910370e-02  1.60708548e-01 -4.99561767e-02]
 [ 4.00707819e-02 -1.56233343e-01 -1.92449825e-01]
 [ 4.39475692e-02  2.10374701e-03 -1.26306075e-02]
 [-3.70986899e-02  9.03286360e-03  8.90392746e-02]
 [ 6.38811658e-02 -3.26081729e-02  2.59481779e-02]
 [ 1.46695788e-01 -7.05257009e-02  8.88020611e-02]
 [-4.49095456e-02 -1.38890665e-02 -3.43800995e-02]
 [-8.24738820e-02 -7.93827463e-03  4.05297053e-02]
 [-2.96752063e-02 -5.35339001e-02 -3.04695456e-02]
 [ 2.64145723e-02 -5.71302064e-02 -1.22136381e-01]
 [-1.38202374e-02  6.51544248e-03  1.65552834e-01]
 [ 4.54317077e-03 -8.26853657e-02 -9.91292197e-02]
 [ 3.16284417e-03  6.63737074e-02  4.87259753e-02]
 [ 5.55827536e-02  3.37528719e-02  1.57506268e-01]
 [-3.95896914e-02  3.48506332e-02 -6.11561575e-02]
 [-4.91027865e-02 -1.21828143e-02  3.26272078e-02]
 [ 9.39198108e-02  6.18023928e-03  8.96978824e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.92699111]
curr_Stock_Price:  100.31938130748334
curr_Factors:  [100.31938131  -1.08455468  -1.00666258]
mat_Sqrt:  [[12.39312204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0107003  -0.02978435  0.0452486 ]
Stock Position:  -0.010700296228808158
Bond Position:  [6.0004382]


portfolio before change:  [4.93382342]
curr_Stock_Price:  99.7509656087379
curr_Factors:  [99.75096561 -0.81947264 -0.97262268]
mat_Sqrt:  [[16.61957829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01028931  0.02295318 -0.44833614]
Stock Position:  -0.01028930556751726
Bond Position:  [5.96019159]


portfolio before change:  [4.93156798]
curr_Stock_Price:  100.0425799945626
curr_Factors:  [100.04257999  -0.69499337  -0.96446545]
mat_Sqrt:  [[19.03229113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018784  0.00920062  0.09933959]
Stock Position:  -0.0001878360023576305
Bond Position:  [4.95035958]


portfolio before change:  [4.93182251]
curr_Stock_Price:  101.9820558901088
curr_Factors:  [101.98205589  -0.60727714  -0.96475713]
mat_Sqrt:  [[21.17375854  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01391884 -0.02672611 -0.40474431]
Stock Position:  -0.013918837509947221
Bond Position:  [6.35129418]


portfolio before change:  [4.9553496]
curr_Stock_Price:  100.34879263212088
curr_Factors:  [100.34879263  -0.64613616  -0.96405351]
mat_Sqrt:  [[20.05467652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00225867  0.00091865 -0.21860008]
Stock Position:  0.0022586709597374097
Bond Position:  [4.7286947]


portfolio before change:  [4.95818143]
curr_Stock_Price:  101.34083647210495
curr_Factors:  [101.34083647  -0.85906549  -0.97311546]
mat_Sqrt:  [[16.22102934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00945095 -0.05534923  0.15513819]
Stock Position:  -0.009450953630890158
Bond Position:  [5.91594897]


portfolio before change:  [4.95562322]
curr_Stock_Price:  101.68976896871737
curr_Factors:  [101.68976897  -0.94359074  -1.00570786]
mat_Sqrt:  [[14.47796877  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00642844 -0.05563922 -0.07844612]
Stock Position:  -0.00642844016099535
Bond Position:  [5.60932982]


portfolio before change:  [4.95766638]
curr_Stock_Price:  101.48101760981413
curr_Factors:  [101.48101761  -0.82655714  -1.01126051]
mat_Sqrt:  [[16.15216521  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01015995 0.21180147 0.2679316 ]
Stock Position:  0.010159954463286762
Bond Position:  [3.92662386]


portfolio before change:  [4.97206493]
curr_Stock_Price:  102.8498911524451
curr_Factors:  [102.84989115  -1.01514441  -1.00246409]
mat_Sqrt:  [[13.6762678   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03671977 0.0152889  1.15795004]
Stock Position:  0.036719768702481496
Bond Position:  [1.19544071]


portfolio before change:  [4.97794081]
curr_Stock_Price:  103.0058410455698
curr_Factors:  [103.00584105  -1.01339038  -1.00333857]
mat_Sqrt:  [[13.70905746  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05989807 0.0932649  1.61081643]
Stock Position:  0.05989806896732585
Bond Position:  [-1.19191016]


portfolio before change:  [4.98006038]
curr_Stock_Price:  103.0437147836501
curr_Factors:  [103.04371478  -0.97822815  -0.97051403]
mat_Sqrt:  [[14.67890069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01441824 -0.07719548 -0.02065478]
Stock Position:  -0.014418238871170413
Bond Position:  [6.46576927]


portfolio before change:  [4.98562193]
curr_Stock_Price:  102.71404320580551
curr_Factors:  [102.71404321  -0.76252821  -0.98419938]
mat_Sqrt:  [[17.90752943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202947 -0.00596388  0.25868548]
Stock Position:  -0.0020294683851495602
Bond Position:  [5.19407684]


portfolio before change:  [4.98612889]
curr_Stock_Price:  102.78418310144998
curr_Factors:  [102.7841831   -1.08068521  -0.94052981]
mat_Sqrt:  [[13.61832708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112973 -0.01725561  0.16131703]
Stock Position:  0.0011297257707738157
Bond Position:  [4.87001095]


portfolio before change:  [4.98734464]
curr_Stock_Price:  103.32145271494477
curr_Factors:  [103.32145271  -1.21305293  -0.94393889]
mat_Sqrt:  [[11.95145717  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144496  0.04268831 -0.15008102]
Stock Position:  0.0014449582000800835
Bond Position:  [4.83804946]


portfolio before change:  [4.98809364]
curr_Stock_Price:  103.4212475838994
curr_Factors:  [103.42124758  -1.35398083  -0.94610756]
mat_Sqrt:  [[10.36797826  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02855283 -0.05678999 -0.50158345]
Stock Position:  0.028552827570128017
Bond Position:  [2.03512459]


portfolio before change:  [5.00525023]
curr_Stock_Price:  104.01320941202462
curr_Factors:  [104.01320941  -1.1929689   -0.98605206]
mat_Sqrt:  [[11.76932945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01703144 -0.03091923  0.33469495]
Stock Position:  -0.017031438135458536
Bond Position:  [6.77674477]


portfolio before change:  [4.99337383]
curr_Stock_Price:  104.76027157503707
curr_Factors:  [104.76027158  -1.39985148  -0.97241473]
mat_Sqrt:  [[ 9.77089829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00538433  0.00078511 -0.02229489]
Stock Position:  0.005384325027998757
Bond Position:  [4.42931048]


portfolio before change:  [4.99439453]
curr_Stock_Price:  104.8470055279725
curr_Factors:  [104.84700553  -1.06648674  -0.96735941]
mat_Sqrt:  [[13.71727585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00494718 -0.02019454  0.06863465]
Stock Position:  -0.0049471770021618
Bond Position:  [5.51309123]


portfolio before change:  [4.99637481]
curr_Stock_Price:  104.58602899832455
curr_Factors:  [104.586029    -0.75249305  -0.98351119]
mat_Sqrt:  [[18.43047854  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0070993  -0.06566442  0.09365977]
Stock Position:  0.007099301656365263
Bond Position:  [4.25388704]


portfolio before change:  [4.99476248]
curr_Stock_Price:  104.28401338934626
curr_Factors:  [104.28401339  -1.03494393  -0.98885784]
mat_Sqrt:  [[13.78135105  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00810679 -0.00194886  0.87126105]
Stock Position:  0.008106787802981595
Bond Position:  [4.14935411]


portfolio before change:  [4.99397205]
curr_Stock_Price:  104.12252726602716
curr_Factors:  [104.12252727  -1.03460733  -0.99540276]
mat_Sqrt:  [[13.6748484   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185571  0.14644275 -1.24037498]
Stock Position:  -0.0018557078056198354
Bond Position:  [5.18719303]


portfolio before change:  [4.99507361]
curr_Stock_Price:  103.87834883818103
curr_Factors:  [103.87834884  -0.96518349  -0.98595255]
mat_Sqrt:  [[14.76241551  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02495125 0.06020557 0.20241612]
Stock Position:  0.024951248213599155
Bond Position:  [2.40317914]


portfolio before change:  [4.9918031]
curr_Stock_Price:  103.73523273411465
curr_Factors:  [103.73523273  -1.07043082  -0.96542665]
mat_Sqrt:  [[13.54455113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00310075  0.05186846 -0.14251107]
Stock Position:  0.003100750232696973
Bond Position:  [4.67014605]


portfolio before change:  [4.98960726]
curr_Stock_Price:  102.83878860861518
curr_Factors:  [102.83878861  -1.05576993  -0.95354911]
mat_Sqrt:  [[13.78861928  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00225576 -0.05042409 -0.54900578]
Stock Position:  -0.002255764060340975
Bond Position:  [5.2215873]


portfolio before change:  [4.98918429]
curr_Stock_Price:  103.31565732294003
curr_Factors:  [103.31565732  -1.04671169  -0.9529572 ]
mat_Sqrt:  [[13.98688428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00298843  0.00067898 -0.03603161]
Stock Position:  0.0029884270156652166
Bond Position:  [4.68043299]


portfolio before change:  [4.98796161]
curr_Stock_Price:  102.7107321690924
curr_Factors:  [102.71073217  -0.61884586  -0.94311139]
mat_Sqrt:  [[21.54102727  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007929   0.00291534  0.25400427]
Stock Position:  -0.0007928961928164649
Bond Position:  [5.06940056]


portfolio before change:  [4.98895971]
curr_Stock_Price:  102.25116441445822
curr_Factors:  [102.25116441  -1.0156719   -0.94118489]
mat_Sqrt:  [[14.44828019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00432728 -0.01052424  0.07402293]
Stock Position:  0.0043272762720700094
Bond Position:  [4.54649067]


portfolio before change:  [4.99054946]
curr_Stock_Price:  102.48720143186387
curr_Factors:  [102.48720143  -1.00121983  -0.94815167]
mat_Sqrt:  [[14.59043867  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01030993 -0.02276207  0.25332756]
Stock Position:  0.010309932254175608
Bond Position:  [3.93391335]


portfolio before change:  [5.00177871]
curr_Stock_Price:  103.52867094669438
curr_Factors:  [103.52867095  -0.73708567  -0.94614313]
mat_Sqrt:  [[19.2328506   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00284734 -0.00448268 -0.09807685]
Stock Position:  -0.002847339118572802
Bond Position:  [5.29655994]


portfolio before change:  [5.00802569]
curr_Stock_Price:  101.56723455608962
curr_Factors:  [101.56723456  -0.4991579   -0.93541969]
mat_Sqrt:  [[24.19493717  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00313376 -0.00256207  0.11561997]
Stock Position:  -0.003133762389172097
Bond Position:  [5.32631327]


portfolio before change:  [5.00396677]
curr_Stock_Price:  103.07492795666067
curr_Factors:  [103.07492796  -0.53878122  -0.96576469]
mat_Sqrt:  [[22.89481045  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00204511 -0.01727799 -0.08692113]
Stock Position:  -0.0020451070318316536
Bond Position:  [5.21476603]


portfolio before change:  [5.00194319]
curr_Stock_Price:  104.38315538139187
curr_Factors:  [104.38315538  -0.77540894  -0.97568953]
mat_Sqrt:  [[18.11915811  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056173 -0.01843869 -0.3484211 ]
Stock Position:  -0.0005617295571561965
Bond Position:  [5.06057829]


portfolio before change:  [5.00353992]
curr_Stock_Price:  102.66681615188901
curr_Factors:  [102.66681615  -0.81542576  -0.9550668 ]
mat_Sqrt:  [[17.47893404  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00121878 0.00210285 0.47227615]
Stock Position:  0.0012187844162050861
Bond Position:  [4.87841121]


portfolio before change:  [5.00509833]
curr_Stock_Price:  103.44510662713172
curr_Factors:  [103.44510663  -0.59177228  -0.94701884]
mat_Sqrt:  [[22.20350101  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146687 -0.02668659 -0.28278807]
Stock Position:  -0.001466866690790088
Bond Position:  [5.15683851]


portfolio before change:  [5.00611941]
curr_Stock_Price:  103.18847766573629
curr_Factors:  [103.18847767  -0.49003869  -0.95118016]
mat_Sqrt:  [[24.41843394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00109169 0.02142202 0.13900164]
Stock Position:  0.0010916944379167372
Bond Position:  [4.89346913]


portfolio before change:  [5.00632065]
curr_Stock_Price:  102.81247253207671
curr_Factors:  [102.81247253  -0.71492469  -0.95369859]
mat_Sqrt:  [[19.38080992  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00488232 0.01089369 0.44932154]
Stock Position:  0.004882322378233472
Bond Position:  [4.50435702]


portfolio before change:  [4.9985772]
curr_Stock_Price:  101.11112417028274
curr_Factors:  [101.11112417  -0.62870718  -0.93789247]
mat_Sqrt:  [[21.10733273  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213003  0.01124799 -0.17446149]
Stock Position:  -0.002130031521813465
Bond Position:  [5.21394708]


portfolio before change:  [5.0005957]
curr_Stock_Price:  100.46948311688644
curr_Factors:  [100.46948312  -0.58996643  -0.92190862]
mat_Sqrt:  [[22.15313419  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202814 -0.00393199  0.09307634]
Stock Position:  -0.002028137044993916
Bond Position:  [5.20436158]


portfolio before change:  [5.00087337]
curr_Stock_Price:  100.65335293522162
curr_Factors:  [100.65335294  -0.53089018  -0.92833357]
mat_Sqrt:  [[23.39351182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00485138 0.00199466 0.25588309]
Stock Position:  0.004851381499498716
Bond Position:  [4.51256556]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.00070612]
Stock Price:  100.50259927861237
PL:  [4.49810684]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.70394947e-01 -9.90562911e-02  1.79457715e-02]
 [-8.62514015e-02  7.22959553e-02 -8.33394112e-02]
 [ 1.32612318e-02 -2.99353373e-03  5.58625861e-02]
 [ 4.75434753e-02  3.71168115e-02  7.77722509e-02]
 [ 8.15203838e-02 -2.71222451e-02 -8.02614071e-02]
 [-5.79445588e-02 -1.42678054e-01  2.06786788e-01]
 [-6.14303317e-02 -1.73679672e-01  8.07939774e-02]
 [ 4.61835470e-03  7.10555040e-01  1.09728298e-01]
 [ 4.04621526e-01  4.51837925e-02  3.99210124e-01]
 [ 5.70963681e-01  2.41913449e-01  4.50875962e-01]
 [-8.75159291e-02 -1.14574826e-01  6.51398295e-02]
 [-6.06304283e-02 -1.88088031e-02  8.94964287e-02]
 [ 1.16862692e-02 -5.77862208e-02  9.56925247e-02]
 [ 1.51489876e-03  1.58808375e-01 -1.73525404e-01]
 [ 4.05654842e-01 -1.44101410e-01 -2.00033787e-01]
 [-2.03300712e-01 -9.57184848e-02  1.17013286e-01]
 [ 5.09026566e-02  1.79263835e-02 -2.46368682e-02]
 [-6.02027445e-02 -6.26899759e-02  2.37717368e-02]
 [ 5.58958948e-02 -2.48568686e-02 -1.91118081e-01]
 [ 1.54869519e-02 -1.13909708e-02  7.35023470e-02]
 [-5.18794849e-02  6.21488933e-01 -6.11146040e-01]
 [ 3.06798951e-01  1.82242903e-01  7.24178814e-02]
 [-8.48412421e-02  1.55138369e-01 -6.80074900e-02]
 [-6.22584952e-02 -1.12681941e-01 -2.43602421e-02]
 [-5.74750883e-02 -3.64085118e-02 -1.22008550e-03]
 [ 3.82388719e-02  3.11281254e-02 -8.98128192e-02]
 [ 9.10667372e-02  1.05966809e-02  3.40093080e-01]
 [ 1.69200954e-01 -5.16844617e-02  2.26524836e-01]
 [ 4.84388261e-04  7.45460767e-02 -1.86541393e-01]
 [-7.85302045e-02  6.07039697e-02 -7.01575630e-02]
 [ 2.84632562e-01  7.98837142e-02  1.03528534e-01]
 [ 2.72739184e-02 -1.56799768e-01 -2.80908958e-01]
 [ 8.88563720e-02 -8.55805975e-03  1.35189358e-01]
 [-2.07954122e-02 -1.31145238e-01 -4.34611460e-01]
 [ 1.23182559e-01  5.06429884e-01 -2.53000896e-01]
 [-2.78537063e-02  2.51345081e-02  2.89201907e-03]
 [ 6.49693230e-01 -3.47981965e-01  5.07633241e-01]
 [-1.65585684e-01  9.90588955e-02  6.18594079e-02]
 [ 4.40094074e-01 -6.25484897e-02  1.95627690e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.55814272]
curr_Stock_Price:  100.52502458008081
curr_Factors:  [100.52502458  -1.05077469  -1.03583438]
mat_Sqrt:  [[12.47588559  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01498503 -0.03197028  0.05119429]
Stock Position:  -0.014985033415753449
Bond Position:  [8.06451357]


portfolio before change:  [6.5526817]
curr_Stock_Price:  100.95673171006743
curr_Factors:  [100.95673171  -0.65324653  -1.05677071]
mat_Sqrt:  [[18.25930448  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00484715  0.02333342 -0.23774414]
Stock Position:  -0.004847152723422454
Bond Position:  [7.0420344]


portfolio before change:  [6.55519633]
curr_Stock_Price:  100.619561241497
curr_Factors:  [100.61956124  -0.69633574  -1.01222277]
mat_Sqrt:  [[18.22488892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00131979 -0.00096616  0.15936041]
Stock Position:  0.0013197930627673856
Bond Position:  [6.42239933]


portfolio before change:  [6.55655949]
curr_Stock_Price:  101.04410563577547
curr_Factors:  [101.04410564  -0.60722833  -1.01185788]
mat_Sqrt:  [[20.01477793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00354713 0.0119794  0.22186258]
Stock Position:  0.003547134382497151
Bond Position:  [6.19814247]


portfolio before change:  [6.55585391]
curr_Stock_Price:  100.6267554287882
curr_Factors:  [100.62675543  -0.63969771  -1.02993604]
mat_Sqrt:  [[18.94963043  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00314522 -0.00875367 -0.22896345]
Stock Position:  0.003145221632876569
Bond Position:  [6.23936046]


portfolio before change:  [6.54996054]
curr_Stock_Price:  98.50501668444561
curr_Factors:  [98.50501668 -0.47469355 -1.02197013]
mat_Sqrt:  [[22.05289303  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00203413 -0.04604914  0.58990515]
Stock Position:  -0.0020341285037005423
Bond Position:  [6.7503324]


portfolio before change:  [6.54855295]
curr_Stock_Price:  99.61184649632519
curr_Factors:  [99.6118465  -0.42429144 -1.05255872]
mat_Sqrt:  [[22.74694692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00353412 -0.05605487  0.23048273]
Stock Position:  -0.0035341246047703658
Bond Position:  [6.90059363]


portfolio before change:  [6.54389559]
curr_Stock_Price:  101.17375811811661
curr_Factors:  [101.17375812  -0.70071454  -1.05581694]
mat_Sqrt:  [[17.46690491  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00985051 0.22933065 0.31302429]
Stock Position:  0.009850513916928684
Bond Position:  [5.54728207]


portfolio before change:  [6.55664002]
curr_Stock_Price:  102.39714401894517
curr_Factors:  [102.39714402  -1.00713498  -1.10479076]
mat_Sqrt:  [[12.39053753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03997672 0.01458301 1.13883537]
Stock Position:  0.0399767204409807
Bond Position:  [2.46313802]


portfolio before change:  [6.54148762]
curr_Stock_Price:  102.01041108854179
curr_Factors:  [102.01041109  -0.78484132  -1.12351225]
mat_Sqrt:  [[15.13063216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04708189 0.07807723 1.28622362]
Stock Position:  0.04708188792109187
Bond Position:  [1.73864488]


portfolio before change:  [6.53826749]
curr_Stock_Price:  101.93740053060995
curr_Factors:  [101.93740053  -0.91312225  -1.11727496]
mat_Sqrt:  [[13.38268483  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00729351 -0.03697887  0.1858258 ]
Stock Position:  -0.007293514480253773
Bond Position:  [7.28174939]


portfolio before change:  [6.53828296]
curr_Stock_Price:  102.06008530810887
curr_Factors:  [102.06008531  -0.75316525  -1.13448879]
mat_Sqrt:  [[15.45461512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00298949 -0.00607052  0.2553084 ]
Stock Position:  -0.002989487395927152
Bond Position:  [6.8433903]


portfolio before change:  [6.53954144]
curr_Stock_Price:  101.92527972535055
curr_Factors:  [101.92527973  -0.77989355  -1.12089572]
mat_Sqrt:  [[15.23279586  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00127513 -0.01865042  0.27298414]
Stock Position:  0.0012751343396607748
Bond Position:  [6.40957301]


portfolio before change:  [6.54133443]
curr_Stock_Price:  102.70303537539543
curr_Factors:  [102.70303538  -0.83731849  -1.12195481]
mat_Sqrt:  [[14.47710416  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.02866030e-04  5.12551825e-02 -4.95019677e-01]
Stock Position:  -0.0001028660300403713
Bond Position:  [6.55189908]


portfolio before change:  [6.54206443]
curr_Stock_Price:  103.56854531118431
curr_Factors:  [103.56854531  -0.99975871  -1.14890474]
mat_Sqrt:  [[12.08022975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02776508 -0.04650853 -0.57064071]
Stock Position:  0.02776507948708302
Bond Position:  [3.66647554]


portfolio before change:  [6.55286108]
curr_Stock_Price:  103.94089454438573
curr_Factors:  [103.94089454  -0.899736    -1.13485812]
mat_Sqrt:  [[13.58856047  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01464128 -0.03089301  0.33380633]
Stock Position:  -0.014641280774037896
Bond Position:  [8.0746889]


portfolio before change:  [6.56780165]
curr_Stock_Price:  102.98939518561737
curr_Factors:  [102.98939519  -0.78892187  -1.13924208]
mat_Sqrt:  [[14.97619695  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00330744  0.00578572 -0.07028213]
Stock Position:  0.003307440786654224
Bond Position:  [6.22717032]


portfolio before change:  [6.56217316]
curr_Stock_Price:  101.05226804285957
curr_Factors:  [101.05226804  -0.38947478  -1.14241964]
mat_Sqrt:  [[21.84000686  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00312028 -0.0202331   0.06781415]
Stock Position:  -0.003120278174514898
Bond Position:  [6.87748434]


portfolio before change:  [6.5618445]
curr_Stock_Price:  101.4331291756922
curr_Factors:  [101.43312918  -0.43343583  -1.10571199]
mat_Sqrt:  [[21.76388466  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.42650958e-04 -8.02251983e-03 -5.45206688e-01]
Stock Position:  0.0005426509581270588
Bond Position:  [6.50680172]


portfolio before change:  [6.56291548]
curr_Stock_Price:  101.90779646037748
curr_Factors:  [101.90779646  -0.25135688  -1.08905366]
mat_Sqrt:  [[26.67316236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00105594 -0.00367642  0.20968174]
Stock Position:  0.0010559446663324023
Bond Position:  [6.45530649]


portfolio before change:  [6.56339335]
curr_Stock_Price:  101.59613213312147
curr_Factors:  [101.59613213  -0.1818146   -1.08492724]
mat_Sqrt:  [[28.6245183   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.73865810e-03  2.00584691e-01 -1.74342954e+00]
Stock Position:  -0.0017386581022299198
Bond Position:  [6.74003429]


portfolio before change:  [6.56253443]
curr_Stock_Price:  102.57474771220055
curr_Factors:  [102.57474771  -0.40136251  -1.10529116]
mat_Sqrt:  [[22.7357393   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0157805  0.05881864 0.20658806]
Stock Position:  0.015780501419894052
Bond Position:  [4.94385347]


portfolio before change:  [6.59809736]
curr_Stock_Price:  104.78918374942617
curr_Factors:  [104.78918375  -0.40716109  -1.11423444]
mat_Sqrt:  [[22.88667894  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0029299   0.05007069 -0.19400644]
Stock Position:  -0.0029299019754276375
Bond Position:  [6.90511939]


portfolio before change:  [6.59409115]
curr_Stock_Price:  106.45114993821527
curr_Factors:  [106.45114994  -0.37935956  -1.14786148]
mat_Sqrt:  [[23.11461623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00390368 -0.03636794 -0.06949299]
Stock Position:  -0.003903682098717703
Bond Position:  [7.0096426]


portfolio before change:  [6.58428125]
curr_Stock_Price:  109.18860712601608
curr_Factors:  [109.18860713  -0.38096386  -1.18072835]
mat_Sqrt:  [[22.90567075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00284454 -0.0117508  -0.00348056]
Stock Position:  -0.0028445354985834393
Bond Position:  [6.89487212]


portfolio before change:  [6.57974195]
curr_Stock_Price:  111.08741026596216
curr_Factors:  [111.08741027  -0.27648625  -1.16782577]
mat_Sqrt:  [[26.20644441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00100204  0.01004656 -0.25621097]
Stock Position:  0.001002040130853845
Bond Position:  [6.46842791]


portfolio before change:  [6.58131764]
curr_Stock_Price:  111.85293848580051
curr_Factors:  [111.85293849  -0.44287507  -1.17800039]
mat_Sqrt:  [[22.11618076  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00735439 0.00342006 0.97019089]
Stock Position:  0.007354388475934286
Bond Position:  [5.75870768]


portfolio before change:  [6.57877601]
curr_Stock_Price:  111.40945897813019
curr_Factors:  [111.40945898  -0.37296702  -1.19560824]
mat_Sqrt:  [[23.21124771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00882719 -0.01668109  0.64621231]
Stock Position:  0.008827190099692123
Bond Position:  [5.59534353]


portfolio before change:  [6.58274624]
curr_Stock_Price:  111.77999236596648
curr_Factors:  [ 1.11779992e+02  2.55559813e-02 -1.18621166e+00]
mat_Sqrt:  [[35.01851434  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063899  0.02405964 -0.53215067]
Stock Position:  -0.0006389922710179897
Bond Position:  [6.65417279]


portfolio before change:  [6.58439649]
curr_Stock_Price:  110.49918661577972
curr_Factors:  [110.49918662  -0.27364508  -1.16632731]
mat_Sqrt:  [[26.18104745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00307321  0.01959212 -0.20014   ]
Stock Position:  -0.0030732120735963544
Bond Position:  [6.92398392]


portfolio before change:  [6.57888506]
curr_Stock_Price:  112.57420596380754
curr_Factors:  [112.57420596  -0.47981104  -1.20916079]
mat_Sqrt:  [[20.7935072   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01548904 0.02578236 0.29533809]
Stock Position:  0.015489038349499766
Bond Position:  [4.83521887]


portfolio before change:  [6.55671269]
curr_Stock_Price:  111.10369392497054
curr_Factors:  [111.10369392  -0.49391001  -1.202909  ]
mat_Sqrt:  [[20.36148116  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304855 -0.05060691 -0.80135507]
Stock Position:  -0.0030485503724335663
Bond Position:  [6.89541789]


portfolio before change:  [6.55775739]
curr_Stock_Price:  111.0437551805959
curr_Factors:  [111.04375518  -0.55754974  -1.21010084]
mat_Sqrt:  [[18.95890487  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00605018 -0.0027621   0.38565761]
Stock Position:  0.0060501847695350885
Bond Position:  [5.88592216]


portfolio before change:  [6.55892379]
curr_Stock_Price:  111.11492836703066
curr_Factors:  [111.11492837  -0.84931726  -1.18466317]
mat_Sqrt:  [[14.53536473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00937575 -0.04232694 -1.23982552]
Stock Position:  -0.009375754734237922
Bond Position:  [7.60071011]


portfolio before change:  [6.55790294]
curr_Stock_Price:  111.32515094888036
curr_Factors:  [111.32515095  -0.90474143  -1.17811675]
mat_Sqrt:  [[13.86818035  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01261258  0.16344954 -0.72174114]
Stock Position:  0.012612580060641311
Bond Position:  [5.15380556]


portfolio before change:  [6.56673565]
curr_Stock_Price:  111.97437883313638
curr_Factors:  [111.97437883  -0.82515873  -1.15992502]
mat_Sqrt:  [[15.38182058  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00143889  0.00811213  0.00825013]
Stock Position:  -0.0014388943920148924
Bond Position:  [6.72785495]


portfolio before change:  [6.56817683]
curr_Stock_Price:  111.55728688443094
curr_Factors:  [111.55728688  -0.83602618  -1.15177835]
mat_Sqrt:  [[15.28288704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04464352 -0.1123107   1.44813634]
Stock Position:  0.0446435224698588
Bond Position:  [1.58786659]


portfolio before change:  [6.54339]
curr_Stock_Price:  110.99762372020886
curr_Factors:  [110.99762372  -1.06681434  -1.17127911]
mat_Sqrt:  [[11.83919152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01121178  0.03197112  0.17646767]
Stock Position:  -0.01121177681347039
Bond Position:  [7.78787058]


portfolio before change:  [6.54143586]
curr_Stock_Price:  111.25874900273759
curr_Factors:  [111.258749    -1.28243938  -1.15962432]
mat_Sqrt:  [[ 9.67741538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04456972 -0.02018744  0.05580713]
Stock Position:  0.04456971553998474
Bond Position:  [1.58266507]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.56324088]
Stock Price:  111.74354406137184
PL:  [-5.18030318]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-8.79424823e-01  3.63466723e-01 -4.33896712e-02]
 [-2.57762928e-01  4.18041342e-02 -2.51389256e-01]
 [-4.35548576e-02  5.08962766e-02  1.67347894e-02]
 [ 9.45421444e-02  7.54119813e-02  8.56610588e-02]
 [ 2.41568659e-02  6.97586022e-02 -6.49142992e-02]
 [-6.94062031e-02 -1.50270882e-01  1.65575826e-01]
 [-5.84400876e-02 -1.86266811e-01  9.04291471e-02]
 [ 1.22867045e-02  6.20595728e-01  8.72539769e-02]
 [ 2.77298763e-01 -7.77108442e-03  2.91649938e-01]
 [ 4.70478869e-01  1.97102962e-01  3.56654654e-01]
 [-1.18043928e-01 -1.37087590e-01  5.95649806e-02]
 [-1.97522675e-02 -1.66666327e-02  9.85791916e-02]
 [ 8.88020953e-03 -2.31398218e-02 -1.16465294e-01]
 [ 2.92373163e-04  4.40965422e-02  4.69951134e-02]
 [ 3.49708576e-01 -1.94462359e-01 -1.69689407e-01]
 [-2.21579845e-01 -9.50209075e-02  1.20499304e-01]
 [ 4.87556344e-02  2.17797560e-02 -1.20794390e-02]
 [-4.22899129e-02 -5.20941695e-02  4.92764925e-02]
 [ 1.49286539e-01 -1.80183376e-01  1.22709321e-02]
 [ 5.49280655e-02 -7.01162862e-03  2.91845051e-01]
 [-2.39271133e-02  4.10195456e-01 -3.90642023e-01]
 [ 9.75126284e-02  8.21001030e-02  1.06498684e-01]
 [-6.31488658e-03  1.75207217e-01 -6.41720267e-02]
 [ 2.57023820e-02 -1.52982519e-01 -1.68299842e-01]
 [ 3.87233487e-02 -9.89396460e-03 -1.19580858e-02]
 [-8.34827977e-03  1.68679159e-02  3.08499834e-02]
 [ 7.75603060e-02 -3.06379117e-02  2.79097319e-02]
 [ 1.47846988e-01 -6.95619206e-02  9.58469536e-02]
 [-4.59428525e-02 -1.81893506e-02 -2.60783730e-02]
 [-5.94670433e-02 -1.19686769e-02  3.15280985e-02]
 [-3.77678653e-02 -5.41353803e-02 -2.89948872e-02]
 [ 2.60206252e-02 -1.14390234e-02 -4.93508012e-02]
 [ 5.76151367e-02  9.82965206e-03  1.41993045e-01]
 [ 1.24903941e-02 -6.83649060e-02 -3.33706137e-03]
 [-3.06170981e-02  9.83239440e-03  4.71970888e-02]
 [ 8.83316001e-02  2.84471502e-02  1.91534738e-01]
 [ 3.94871660e-02 -1.04054245e-02 -1.14482369e-02]
 [-6.72888327e-02 -5.09471291e-04  3.72184566e-02]
 [ 9.39606318e-02  6.15494965e-03  8.94562303e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.31862977]
curr_Stock_Price:  98.01911127201873
curr_Factors:  [98.01911127 -0.71827967 -1.01534822]
mat_Sqrt:  [[17.31433166  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04701824  0.11730838 -0.12377865]
Stock Position:  -0.04701823809264631
Bond Position:  [-8.70994386]


portfolio before change:  [-13.3609833]
curr_Stock_Price:  98.89674357802008
curr_Factors:  [98.89674358 -0.93879997 -1.0383445 ]
mat_Sqrt:  [[13.69364473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02194772  0.01349223 -0.71714357]
Stock Position:  -0.021947722321848263
Bond Position:  [-11.19042504]


portfolio before change:  [-13.38020326]
curr_Stock_Price:  99.70872169940891
curr_Factors:  [99.7087217  -1.28208648 -1.04598814]
mat_Sqrt:  [[ 9.7199311   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306069  0.0164267   0.0477397 ]
Stock Position:  -0.003060692899500154
Bond Position:  [-13.07502549]


portfolio before change:  [-13.37849219]
curr_Stock_Price:  98.61564983645053
curr_Factors:  [98.61564984 -0.9174985  -1.02548271]
mat_Sqrt:  [[14.12927319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00901823 0.02433911 0.24436716]
Stock Position:  0.009018230400478344
Bond Position:  [-14.26783084]


portfolio before change:  [-13.36916548]
curr_Stock_Price:  99.84763223157712
curr_Factors:  [99.84763223 -0.86383813 -1.05511378]
mat_Sqrt:  [[14.65370844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.001716    0.02251449 -0.18518243]
Stock Position:  0.0017159960006617103
Bond Position:  [-13.54050361]


portfolio before change:  [-13.37222251]
curr_Stock_Price:  99.05254469985434
curr_Factors:  [99.0525447  -0.79383087 -1.04647639]
mat_Sqrt:  [[15.7264374   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00421469 -0.04849972  0.47234175]
Stock Position:  -0.004214692288031247
Bond Position:  [-12.95474652]


portfolio before change:  [-13.37856413]
curr_Stock_Price:  100.1729515243316
curr_Factors:  [100.17295152  -0.99130659  -1.05767716]
mat_Sqrt:  [[12.90886722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00604258 -0.06011735  0.25796919]
Stock Position:  -0.006042580458782182
Bond Position:  [-12.77326101]


portfolio before change:  [-13.38743111]
curr_Stock_Price:  101.37611729522119
curr_Factors:  [101.3761173   -1.16970536  -1.09545166]
mat_Sqrt:  [[10.52423312  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01489666 0.20029641 0.24891131]
Stock Position:  0.014896659804893958
Bond Position:  [-14.89759664]


portfolio before change:  [-13.39053883]
curr_Stock_Price:  101.29251471661767
curr_Factors:  [101.29251472  -1.16625666  -1.08717517]
mat_Sqrt:  [[10.63957648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03150927 -0.00250811  0.83199609]
Stock Position:  0.031509270325042985
Bond Position:  [-16.58219205]


portfolio before change:  [-13.38139828]
curr_Stock_Price:  101.64839250876427
curr_Factors:  [101.64839251  -1.27848461  -1.07447415]
mat_Sqrt:  [[ 9.66548187  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06037093 0.06361471 1.01743645]
Stock Position:  0.060370934079180844
Bond Position:  [-19.51800668]


portfolio before change:  [-13.37391839]
curr_Stock_Price:  101.81270657463381
curr_Factors:  [101.81270657  -1.35866629  -1.07873606]
mat_Sqrt:  [[ 8.89716388  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01504616 -0.04424483  0.16992231]
Stock Position:  -0.015046161470954866
Bond Position:  [-11.84202797]


portfolio before change:  [-13.38565742]
curr_Stock_Price:  102.49452045173888
curr_Factors:  [102.49452045  -1.60646872  -1.07306158]
mat_Sqrt:  [[ 7.03064918  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043125 -0.00537913  0.28121899]
Stock Position:  -0.00043124558583626586
Bond Position:  [-13.34145711]


portfolio before change:  [-13.3874934]
curr_Stock_Price:  102.88455528346515
curr_Factors:  [102.88455528  -1.89473851  -1.06368005]
mat_Sqrt:  [[ 5.33980417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367365 -0.00746835 -0.33224307]
Stock Position:  -0.00367364883447921
Bond Position:  [-13.00953168]


portfolio before change:  [-13.3903125]
curr_Stock_Price:  103.20924677325364
curr_Factors:  [103.20924677  -1.84909249  -1.07354626]
mat_Sqrt:  [[ 5.55178612  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00340186 0.0142321  0.13406398]
Stock Position:  0.0034018564655950824
Bond Position:  [-13.74141554]


portfolio before change:  [-13.39072817]
curr_Stock_Price:  103.59201178594621
curr_Factors:  [103.59201179  -1.83471292  -1.09715066]
mat_Sqrt:  [[ 5.52120784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04987612 -0.06276246 -0.48407665]
Stock Position:  0.0498761168813356
Bond Position:  [-18.55749546]


portfolio before change:  [-13.42277528]
curr_Stock_Price:  102.99598957457874
curr_Factors:  [102.99598957  -1.6492003   -1.10270942]
mat_Sqrt:  [[ 6.57175111  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03292564 -0.03066787  0.34375097]
Stock Position:  -0.03292563656882495
Bond Position:  [-10.03156676]


portfolio before change:  [-13.42231277]
curr_Stock_Price:  102.94385591783914
curr_Factors:  [102.94385592  -1.42149216  -1.10276963]
mat_Sqrt:  [[ 8.24759764  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00615157  0.00702939 -0.03445928]
Stock Position:  0.0061515735349311155
Bond Position:  [-14.05557947]


portfolio before change:  [-13.42150014]
curr_Stock_Price:  103.3615840239372
curr_Factors:  [103.36158402  -1.45475959  -1.10001956]
mat_Sqrt:  [[ 8.03216584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00533668 -0.01681332  0.14057212]
Stock Position:  -0.00533667626478832
Bond Position:  [-12.86989283]


portfolio before change:  [-13.42587185]
curr_Stock_Price:  103.87929914493778
curr_Factors:  [103.87929914  -1.4165841   -1.077359  ]
mat_Sqrt:  [[ 8.57873563  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01340659 -0.05815393  0.03500555]
Stock Position:  0.013406585805447927
Bond Position:  [-14.81853859]


portfolio before change:  [-13.42678161]
curr_Stock_Price:  103.94961381937894
curr_Factors:  [103.94961382  -1.43981984  -1.08368556]
mat_Sqrt:  [[ 8.33447809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01356647 -0.00226299  0.8325527 ]
Stock Position:  0.013566469703232732
Bond Position:  [-14.83701089]


portfolio before change:  [-13.42702528]
curr_Stock_Price:  104.06836737817386
curr_Factors:  [104.06836738  -1.26345693  -1.07734096]
mat_Sqrt:  [[10.01666469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199026  0.13239001 -1.11439296]
Stock Position:  -0.00199026184141023
Bond Position:  [-13.21990198]


portfolio before change:  [-13.42887036]
curr_Stock_Price:  104.16508107141826
curr_Factors:  [104.16508107  -1.34827483  -1.08589222]
mat_Sqrt:  [[ 9.13222992  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01489343 0.02649769 0.3038111 ]
Stock Position:  0.014893426455244932
Bond Position:  [-14.98024533]


portfolio before change:  [-13.42417218]
curr_Stock_Price:  104.60627096153608
curr_Factors:  [104.60627096  -1.18137683  -1.08782926]
mat_Sqrt:  [[10.81568521  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0015117   0.05654789 -0.18306493]
Stock Position:  0.0015117005079607231
Bond Position:  [-13.58230553]


portfolio before change:  [-13.42638525]
curr_Stock_Price:  104.26547576530416
curr_Factors:  [104.26547577  -1.11600806  -1.07783893]
mat_Sqrt:  [[11.62424853  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00343068 -0.0493749  -0.4801126 ]
Stock Position:  -0.0034306824418020277
Bond Position:  [-13.06868352]


portfolio before change:  [-13.42801958]
curr_Stock_Price:  104.26566291219075
curr_Factors:  [104.26566291  -1.21884273  -1.10098519]
mat_Sqrt:  [[10.24832396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00334326 -0.00319326 -0.03411309]
Stock Position:  0.003343260585133406
Bond Position:  [-13.77660686]


portfolio before change:  [-13.43197449]
curr_Stock_Price:  103.59783538240586
curr_Factors:  [103.59783538  -1.18927381  -1.08658123]
mat_Sqrt:  [[10.64043536  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00013083 0.0054441  0.08800642]
Stock Position:  0.0001308307028730156
Bond Position:  [-13.44552827]


portfolio before change:  [-13.43373327]
curr_Stock_Price:  103.00171955805013
curr_Factors:  [103.00171956  -1.02186185  -1.09997125]
mat_Sqrt:  [[12.34082145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00623973 -0.00988834  0.0796187 ]
Stock Position:  0.0062397320085574295
Bond Position:  [-14.0764364]


portfolio before change:  [-13.4374416]
curr_Stock_Price:  102.68942099718107
curr_Factors:  [102.689421    -1.00485543  -1.07574789]
mat_Sqrt:  [[12.82127343  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01194986 -0.02245101  0.27342468]
Stock Position:  0.011949858076761416
Bond Position:  [-14.66456561]


portfolio before change:  [-13.43870887]
curr_Stock_Price:  102.73677819035109
curr_Factors:  [102.73677819  -0.96752665  -1.10495709]
mat_Sqrt:  [[12.93176164  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00425147 -0.00587059 -0.07439434]
Stock Position:  -0.004251467453107065
Bond Position:  [-13.0019268]


portfolio before change:  [-13.43828074]
curr_Stock_Price:  102.2537745403327
curr_Factors:  [102.25377454  -1.04924751  -1.10316828]
mat_Sqrt:  [[11.88220512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0046687  -0.00386287  0.08994089]
Stock Position:  -0.004668703538217537
Bond Position:  [-12.96088818]


portfolio before change:  [-13.43876555]
curr_Stock_Price:  102.01057930892446
curr_Factors:  [102.01057931  -0.8957465   -1.13147297]
mat_Sqrt:  [[13.4349169   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00407422 -0.01747212 -0.08271434]
Stock Position:  -0.004074216496408075
Bond Position:  [-13.02315236]


portfolio before change:  [-13.43943583]
curr_Stock_Price:  101.7755135105865
curr_Factors:  [101.77551351  -1.03096444  -1.11307375]
mat_Sqrt:  [[11.92612464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00114136 -0.00369193 -0.1407841 ]
Stock Position:  0.0011413560255427522
Bond Position:  [-13.55559793]


portfolio before change:  [-13.44117438]
curr_Stock_Price:  101.7369709626419
curr_Factors:  [101.73697096  -1.18667035  -1.10723621]
mat_Sqrt:  [[10.26237405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00863405 0.00317251 0.40506663]
Stock Position:  0.008634046525620696
Bond Position:  [-14.31957612]


portfolio before change:  [-13.44708155]
curr_Stock_Price:  101.26012531998039
curr_Factors:  [101.26012532  -0.89495987  -1.10573329]
mat_Sqrt:  [[13.69457187  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00015668 -0.02206468 -0.00951971]
Stock Position:  -0.00015668315355803707
Bond Position:  [-13.43121579]


portfolio before change:  [-13.44878977]
curr_Stock_Price:  101.44660350363006
curr_Factors:  [101.4466035   -1.08153457  -1.0580135 ]
mat_Sqrt:  [[11.94107952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00158914  0.00317339  0.13464016]
Stock Position:  -0.0015891363548956874
Bond Position:  [-13.28757728]


portfolio before change:  [-13.45080655]
curr_Stock_Price:  101.67045306677373
curr_Factors:  [101.67045307  -0.96355461  -1.05324721]
mat_Sqrt:  [[13.53034449  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00984714 0.00918128 0.5463953 ]
Stock Position:  0.009847141377235516
Bond Position:  [-14.45196987]


portfolio before change:  [-13.45600372]
curr_Stock_Price:  101.32613318998573
curr_Factors:  [101.32613319  -1.05174941  -1.07367237]
mat_Sqrt:  [[12.09657769  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00289556 -0.00335834 -0.03265863]
Stock Position:  0.002895555000086289
Bond Position:  [-13.74939912]


portfolio before change:  [-13.45720138]
curr_Stock_Price:  101.50610760312136
curr_Factors:  [101.5061076   -0.86097059  -1.09903892]
mat_Sqrt:  [[14.297854    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00418214 -0.00016443  0.1061739 ]
Stock Position:  -0.004182141072805994
Bond Position:  [-13.03268852]


portfolio before change:  [-13.45738903]
curr_Stock_Price:  101.1614175582416
curr_Factors:  [101.16141756  -1.02151751  -1.08103998]
mat_Sqrt:  [[12.35622454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00918381 0.0019865  0.25519373]
Stock Position:  0.009183807060060396
Bond Position:  [-14.38643597]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.46821668]
Stock Price:  100.1782482777544
PL:  [-13.64646496]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.56779062e-02 -8.06960954e-02  1.22957770e-02]
 [-1.07479949e-01  7.07379852e-02 -1.11002215e-01]
 [-1.13875875e-02  2.30940464e-02  3.84382155e-02]
 [-5.21680453e-01 -2.20726226e-01 -3.33103973e-01]
 [ 2.00106102e-01 -2.07071514e-01 -1.04842621e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.13437799e-02 -2.12231421e-01 -2.84651167e-02]
 [ 6.74886536e-03  6.25326502e-01  9.73909954e-02]
 [ 5.55680144e-01  1.07944926e-01  5.25039976e-01]
 [ 7.62692068e-01  3.49769627e-01  7.02802567e-01]
 [-9.33436277e-02 -2.84531799e-01 -7.15014222e-02]
 [-1.10584695e-01 -2.51013315e-02  8.40816542e-02]
 [ 1.59451613e-02 -9.82715914e-02  1.26242889e-01]
 [ 1.91270528e-03  6.41697159e-02 -3.82515964e-02]
 [ 6.59706790e-01 -1.95262094e-01 -3.05230512e-01]
 [-1.55264465e-01 -9.31866477e-02  1.07307449e-01]
 [ 5.93964364e-02 -1.99365573e-02 -2.44140522e-03]
 [-5.99585929e-02 -6.39673720e-02  1.39552028e-02]
 [ 1.62549967e-01 -1.99020360e-01  2.89145347e-02]
 [ 4.83294014e-02 -4.10559386e-03  3.39239241e-01]
 [-5.67322585e-02  6.45487547e-01 -6.25718274e-01]
 [ 5.32418435e-01  2.90201065e-01  3.56773386e-02]
 [ 1.28903921e-02  1.54870771e-01 -4.92450083e-02]
 [ 9.61106096e-03 -1.52580446e-01 -1.37071216e-01]
 [ 3.66889048e-02 -1.24141018e-02 -1.17300309e-02]
 [-1.65431842e-02  1.52264025e-02  3.74593860e-02]
 [ 8.67430973e-02 -1.76361427e-02  1.22294206e-01]
 [ 1.68020665e-01 -5.26725952e-02  2.19301931e-01]
 [-4.17318455e-02 -6.64522174e-04 -5.99101692e-02]
 [-5.80426222e-02 -9.86734184e-03  4.03122911e-02]
 [-8.53082004e-03 -4.51810160e-02 -2.29903669e-02]
 [ 2.64454185e-02 -6.07078426e-02 -1.27835519e-01]
 [-4.40217258e-02  9.79532778e-03  1.74687578e-01]
 [-1.46707812e-03 -9.41799270e-02 -1.78704773e-01]
 [ 5.61372942e-02  2.47544024e-01 -9.40499994e-02]
 [-6.09600102e-03  3.23017661e-03  4.66801338e-02]
 [ 4.59806590e-01 -2.67454596e-01  2.97457963e-01]
 [-1.36622021e-01  8.68357167e-02  5.12284735e-02]
 [ 5.27735431e-01 -8.05407291e-02 -6.23446654e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.01178395]
curr_Stock_Price:  99.95185401336167
curr_Factors:  [99.95185401 -0.93486276 -0.96969296]
mat_Sqrt:  [[14.88170915  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266368 -0.02604455  0.03507643]
Stock Position:  -0.0026636767540744012
Bond Position:  [2.27802338]


portfolio before change:  [2.01102433]
curr_Stock_Price:  100.34394122320607
curr_Factors:  [100.34394122  -0.85701278  -0.95849655]
mat_Sqrt:  [[16.33147722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00708441  0.02283059 -0.31665842]
Stock Position:  -0.007084408179979197
Bond Position:  [2.72190176]


portfolio before change:  [2.01039558]
curr_Stock_Price:  100.48072133548824
curr_Factors:  [100.48072134  -1.04174056  -0.94442041]
mat_Sqrt:  [[13.78808639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [8.50468140e-05 7.45357141e-03 1.09653530e-01]
Stock Position:  8.504681398221912e-05
Bond Position:  [2.00185001]


portfolio before change:  [2.01081473]
curr_Stock_Price:  102.46678853763908
curr_Factors:  [102.46678854  -1.02316699  -0.93588285]
mat_Sqrt:  [[14.44703051  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04393502 -0.07123908 -0.95025292]
Stock Position:  -0.04393501960867029
Bond Position:  [6.5126951]


portfolio before change:  [2.02800371]
curr_Stock_Price:  102.09408271844565
curr_Factors:  [102.09408272  -0.83757544  -0.93763828]
mat_Sqrt:  [[17.29955958  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00788673 -0.06683204 -0.29908682]
Stock Position:  0.007886726552846661
Bond Position:  [1.2228156]


portfolio before change:  [2.02609146]
curr_Stock_Price:  101.83223636376796
curr_Factors:  [101.83223636  -0.80462559  -0.9156519 ]
mat_Sqrt:  [[18.229647    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00840961 -0.05534923  0.15513819]
Stock Position:  -0.008409608596589931
Bond Position:  [2.88246071]


portfolio before change:  [2.01594934]
curr_Stock_Price:  103.08109970632925
curr_Factors:  [103.08109971  -0.63209374  -0.93201229]
mat_Sqrt:  [[21.57229855  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00465763 -0.0684974  -0.08120305]
Stock Position:  -0.0046576286101337756
Bond Position:  [2.49606282]


portfolio before change:  [2.01242008]
curr_Stock_Price:  103.90583020279192
curr_Factors:  [103.9058302   -0.47595362  -0.93403132]
mat_Sqrt:  [[25.36829267  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00608133 0.20182326 0.2778294 ]
Stock Position:  0.006081329902248327
Bond Position:  [1.38053445]


portfolio before change:  [2.01098369]
curr_Stock_Price:  103.6412554932495
curr_Factors:  [103.64125549  -0.62907275  -0.95919349]
mat_Sqrt:  [[21.17178134  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03234908 0.03483908 1.49779291]
Stock Position:  0.032349079912666306
Bond Position:  [-1.34171557]


portfolio before change:  [2.02033653]
curr_Stock_Price:  103.93556260384098
curr_Factors:  [103.9355626   -0.85961995  -0.95787851]
mat_Sqrt:  [[16.88241682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05790329 0.11288766 2.0049001 ]
Stock Position:  0.05790328942851292
Bond Position:  [-3.99787443]


portfolio before change:  [2.06996007]
curr_Stock_Price:  104.80120088444279
curr_Factors:  [104.80120088  -0.92758268  -0.9533983 ]
mat_Sqrt:  [[15.97594655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01039179 -0.09183224 -0.20397366]
Stock Position:  -0.010391785176003528
Bond Position:  [3.15903163]


portfolio before change:  [2.06348163]
curr_Stock_Price:  105.46262178031512
curr_Factors:  [105.46262178  -1.04129564  -0.9427251 ]
mat_Sqrt:  [[14.50271473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00679496 -0.00810142  0.23986156]
Stock Position:  -0.006794961448860996
Bond Position:  [2.78009608]


portfolio before change:  [2.05627481]
curr_Stock_Price:  106.57437908435328
curr_Factors:  [106.57437908  -1.03389614  -0.92503764]
mat_Sqrt:  [[15.02791325  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144097 -0.03171702  0.36013582]
Stock Position:  0.0014409704306076977
Bond Position:  [1.90270428]


portfolio before change:  [2.05566921]
curr_Stock_Price:  105.9890403631343
curr_Factors:  [105.98904036  -0.87728847  -0.92724595]
mat_Sqrt:  [[17.44060789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00041301  0.02071069 -0.10912116]
Stock Position:  0.0004130142315281697
Bond Position:  [2.01189423]


portfolio before change:  [2.05615736]
curr_Stock_Price:  106.56202660423762
curr_Factors:  [106.5620266   -0.98060354  -0.91032872]
mat_Sqrt:  [[16.08351716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03466556 -0.06302057 -0.87073769]
Stock Position:  0.034665562230948375
Bond Position:  [-1.6378752]


portfolio before change:  [2.07696195]
curr_Stock_Price:  107.16808436380597
curr_Factors:  [107.16808436  -1.1209472   -0.91805332]
mat_Sqrt:  [[13.9488624   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01092434 -0.03007586  0.30611828]
Stock Position:  -0.010924336635943638
Bond Position:  [3.24770218]


portfolio before change:  [2.08187715]
curr_Stock_Price:  106.75531692581333
curr_Factors:  [106.75531693  -0.96952925  -0.91180245]
mat_Sqrt:  [[16.26812638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00337031 -0.0064345  -0.00696465]
Stock Position:  0.003370305383799628
Bond Position:  [1.72207913]


portfolio before change:  [2.08317887]
curr_Stock_Price:  107.07767463310793
curr_Factors:  [107.07767463  -0.54337652  -0.89714979]
mat_Sqrt:  [[25.35632458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00276725 -0.02064538  0.03981031]
Stock Position:  -0.002767249803082545
Bond Position:  [2.37948954]


portfolio before change:  [2.09066198]
curr_Stock_Price:  104.4809952376123
curr_Factors:  [104.48099524  -0.66362133  -0.91260249]
mat_Sqrt:  [[21.6019021   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00591741 -0.06423354  0.08248512]
Stock Position:  0.0059174076623282655
Bond Position:  [1.47240534]


portfolio before change:  [2.09304406]
curr_Stock_Price:  104.85244401318958
curr_Factors:  [104.85244401  -0.68695791  -0.92668365]
mat_Sqrt:  [[20.88252135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00559024 -0.00132507  0.96775513]
Stock Position:  0.005590238302155713
Bond Position:  [1.50689391]


portfolio before change:  [2.09589687]
curr_Stock_Price:  105.32906765296502
curr_Factors:  [105.32906765  -0.41761004  -0.95640343]
mat_Sqrt:  [[26.65764449  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019768   0.20833021 -1.78500007]
Stock Position:  -0.0019768015318423044
Bond Position:  [2.30411153]


portfolio before change:  [2.09786793]
curr_Stock_Price:  104.47767712995373
curr_Factors:  [104.47767713  -0.4463814   -0.92151511]
mat_Sqrt:  [[26.60440813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02251274 0.09366199 0.10177752]
Stock Position:  0.02251273857749356
Bond Position:  [-0.2542107]


portfolio before change:  [2.07762045]
curr_Stock_Price:  103.57970976921732
curr_Factors:  [103.57970977  -0.82319516  -0.90649379]
mat_Sqrt:  [[18.36878036  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00187553  0.04998433 -0.1404823 ]
Stock Position:  0.0018755279355535258
Bond Position:  [1.88335381]


portfolio before change:  [2.07845383]
curr_Stock_Price:  103.8985238624816
curr_Factors:  [103.89852386  -0.78418227  -0.92193413]
mat_Sqrt:  [[18.86481012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262467 -0.04924513 -0.39102603]
Stock Position:  -0.0026246665983819108
Bond Position:  [2.35115281]


portfolio before change:  [2.07757302]
curr_Stock_Price:  104.3460923769445
curr_Factors:  [104.34609238  -1.10062685  -0.92819587]
mat_Sqrt:  [[13.72049176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00231482 -0.00400663 -0.03346251]
Stock Position:  0.0023148225985890275
Bond Position:  [1.83603033]


portfolio before change:  [2.07855373]
curr_Stock_Price:  104.67060439245748
curr_Factors:  [104.67060439  -1.01174569  -0.92431344]
mat_Sqrt:  [[15.10097307  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00038334  0.0049143   0.1068612 ]
Stock Position:  -0.0003833357358817637
Bond Position:  [2.11867771]


portfolio before change:  [2.07848556]
curr_Stock_Price:  105.53935377481763
curr_Factors:  [105.53935377  -1.20604115  -0.92611735]
mat_Sqrt:  [[12.5149685   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00863816 -0.00569204  0.34887133]
Stock Position:  0.008638162770527605
Bond Position:  [1.16681944]


portfolio before change:  [2.0728638]
curr_Stock_Price:  104.87166317910382
curr_Factors:  [104.87166318  -1.07389077  -0.89780095]
mat_Sqrt:  [[14.60035186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01383759 -0.01700001  0.62560737]
Stock Position:  0.01383759361662602
Bond Position:  [0.62169234]


portfolio before change:  [2.07508586]
curr_Stock_Price:  105.02662808710058
curr_Factors:  [105.02662809  -0.86953079  -0.86626457]
mat_Sqrt:  [[18.51198864  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00292225 -0.00021447 -0.17090704]
Stock Position:  -0.002922246962265424
Bond Position:  [2.3819996]


portfolio before change:  [2.07307474]
curr_Stock_Price:  105.81673251670149
curr_Factors:  [105.81673252  -0.80746648  -0.88749579]
mat_Sqrt:  [[19.42860335  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266762 -0.00318467  0.11499975]
Stock Position:  -0.002667617019476747
Bond Position:  [2.35535326]


portfolio before change:  [2.07526433]
curr_Stock_Price:  105.10630629550006
curr_Factors:  [105.1063063   -0.68778943  -0.88413617]
mat_Sqrt:  [[21.82479442  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102847 -0.01458211 -0.06558512]
Stock Position:  -0.0010284745350532729
Bond Position:  [2.18336349]


portfolio before change:  [2.07626771]
curr_Stock_Price:  104.39608736438223
curr_Factors:  [104.39608736  -0.67913281  -0.8574231 ]
mat_Sqrt:  [[22.45776173  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00053615 -0.01959337 -0.36467915]
Stock Position:  -0.00053615467238855
Bond Position:  [2.13224016]


portfolio before change:  [2.07653475]
curr_Stock_Price:  104.39515979438316
curr_Factors:  [104.39515979  -0.50272399  -0.82746308]
mat_Sqrt:  [[27.60498132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.30549345e-04  3.16142845e-03  4.98335036e-01]
Stock Position:  -0.00023054934462564015
Bond Position:  [2.10060299]


portfolio before change:  [2.07657472]
curr_Stock_Price:  105.36076494647403
curr_Factors:  [105.36076495  -0.60548474  -0.84052629]
mat_Sqrt:  [[24.81328708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00230398 -0.03039644 -0.50979498]
Stock Position:  -0.002303984717878537
Bond Position:  [2.31932431]


portfolio before change:  [2.07335508]
curr_Stock_Price:  106.88402707062848
curr_Factors:  [106.88402707  -0.82786442  -0.81606994]
mat_Sqrt:  [[20.65195569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00423539  0.07989449 -0.26829847]
Stock Position:  0.004235392137948109
Bond Position:  [1.62065932]


portfolio before change:  [2.07148333]
curr_Stock_Price:  106.39426171544422
curr_Factors:  [106.39426172  -0.68351098  -0.81487596]
mat_Sqrt:  [[23.7780934   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00017209 0.00104254 0.13316543]
Stock Position:  0.00017208690237834268
Bond Position:  [2.05317427]


portfolio before change:  [2.07191417]
curr_Stock_Price:  107.40637973887863
curr_Factors:  [107.40637974  -0.82524171  -0.8144757 ]
mat_Sqrt:  [[20.84058263  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02235691 -0.0863206   0.84856477]
Stock Position:  0.02235690861787981
Bond Position:  [-0.32936045]


portfolio before change:  [2.13898345]
curr_Stock_Price:  110.40815667818742
curr_Factors:  [110.40815668  -0.98744808  -0.81238922]
mat_Sqrt:  [[18.2533152   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00594083  0.02802611  0.14614058]
Stock Position:  -0.005940826887487708
Bond Position:  [2.79489919]


portfolio before change:  [2.13557509]
curr_Stock_Price:  111.04068503333814
curr_Factors:  [111.04068503  -1.09173595  -0.80074808]
mat_Sqrt:  [[16.73349885  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03047913 -0.02599441 -0.0177852 ]
Stock Position:  0.030479131876946414
Bond Position:  [-1.24884859]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.11677178]
Stock Price:  110.42888301448889
PL:  [-8.31211124]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.06098600e-01 -6.39776603e-02  7.15100255e-03]
 [-1.88199710e-01  4.57099633e-02 -9.05300537e-02]
 [ 4.21018684e-03  6.44914665e-02  5.01700256e-02]
 [ 1.17650149e-01  7.28675339e-02  1.12567296e-01]
 [-1.74481312e-01  2.68851185e-01 -2.35277084e-02]
 [-3.85738367e-02 -1.29142363e-01  2.80405041e-01]
 [-6.52601878e-02 -1.49158491e-01 -1.63765597e-02]
 [-1.30602074e-02  8.13415226e-01  1.45647742e-01]
 [ 3.46484816e-02  4.70485645e-03  3.38766769e-03]
 [ 3.27911723e-01  1.22164582e-01  1.86307515e-01]
 [-1.30775198e-01 -2.32231113e-01  3.04957763e-04]
 [ 2.32696525e-02 -1.42140057e-02  1.09231185e-01]
 [ 1.25673106e-02 -5.22506523e-02  7.64064320e-02]
 [ 1.14492304e-02 -1.13343621e-01 -6.68586254e-02]
 [ 3.44964555e-02 -4.26266703e-02 -7.74372077e-02]
 [-2.01679037e-02 -3.80664254e-02  7.40196855e-02]
 [ 4.66888222e-02  2.54891717e-02  8.86136658e-06]
 [-5.57223866e-02 -6.35777865e-02  8.50546304e-03]
 [ 3.24950460e-02  9.85967681e-03 -1.50542595e-01]
 [-8.03438672e-04 -2.21611415e-03 -2.95014683e-02]
 [-2.81378699e-02  4.21564532e-01 -3.79607501e-01]
 [ 1.83244330e-01  1.23122433e-01  9.25378808e-02]
 [-1.82644110e-03 -1.63251623e-02  5.93442089e-02]
 [ 5.07293985e-02 -9.98979483e-02 -2.02522770e-01]
 [ 4.88930407e-02  1.64031324e-02 -1.38783286e-02]
 [-4.93561122e-02 -1.01073024e-03  1.46605450e-01]
 [-1.15971268e-02 -3.24148287e-02  2.32523798e-03]
 [-2.13417799e-02  2.42047306e-03 -2.44497735e-01]
 [-5.41494447e-02 -3.78830185e-02  9.26903139e-03]
 [-5.77688222e-02  6.02160161e-03  1.27957865e-02]
 [-2.60898324e-02 -4.21410385e-02 -9.04997074e-03]
 [ 3.11344807e-02  2.01551673e-02 -3.93885427e-02]
 [-2.08142015e-02  1.32469667e-02  9.13986936e-02]
 [ 1.62412610e-02 -6.33123027e-02  2.35621351e-02]
 [-4.27709373e-02  1.16693442e-02  3.76976239e-02]
 [ 9.03602237e-02  2.96542163e-02  1.94799441e-01]
 [ 1.02269272e-01 -5.98138156e-02  2.72827375e-02]
 [-5.68713207e-02 -4.87283214e-04  2.99448708e-02]
 [ 9.59040106e-02  7.30246280e-03  1.09886064e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.4233253]
curr_Stock_Price:  99.6448538363643
curr_Factors:  [99.64485384 -1.10374428 -0.98103286]
mat_Sqrt:  [[12.38932555  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00762745 -0.0206487   0.02039982]
Stock Position:  0.0076274456675845086
Bond Position:  [-1.18336101]


portfolio before change:  [-0.42951018]
curr_Stock_Price:  98.85337672239972
curr_Factors:  [98.85337672 -0.98430951 -0.95899908]
mat_Sqrt:  [[14.15869786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01393833  0.01475283 -0.25825704]
Stock Position:  -0.013938327827955482
Bond Position:  [0.94834059]


portfolio before change:  [-0.41789904]
curr_Stock_Price:  98.0288457571917
curr_Factors:  [98.02884576 -1.06658074 -0.94521166]
mat_Sqrt:  [[13.11123346  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00210624 0.02081453 0.14312112]
Stock Position:  0.0021062370680509073
Bond Position:  [-0.62437103]


portfolio before change:  [-0.41841478]
curr_Stock_Price:  97.8210440489605
curr_Factors:  [97.82104405 -1.12731558 -0.92268169]
mat_Sqrt:  [[12.59301704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01234826 0.0235179  0.32112316]
Stock Position:  0.012348262140861236
Bond Position:  [-1.62633467]


portfolio before change:  [-0.42194856]
curr_Stock_Price:  97.55133175573809
curr_Factors:  [97.55133176 -0.96261381 -0.93202939]
mat_Sqrt:  [[14.66898671  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00848081  0.08677135 -0.067118  ]
Stock Position:  -0.008480808461883503
Bond Position:  [0.4053656]


portfolio before change:  [-0.41869752]
curr_Stock_Price:  97.17396680878655
curr_Factors:  [97.17396681 -1.16467862 -0.91289914]
mat_Sqrt:  [[12.16940576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.32526526e-04 -4.16805185e-02  7.99917532e-01]
Stock Position:  -0.0006325265255376537
Bond Position:  [-0.35723241]


portfolio before change:  [-0.419032]
curr_Stock_Price:  97.63215872859871
curr_Factors:  [97.63215873 -1.01947151 -0.92892393]
mat_Sqrt:  [[13.91283082  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00711932 -0.0481407  -0.04671777]
Stock Position:  -0.007119319563882963
Bond Position:  [0.27604254]


portfolio before change:  [-0.4161949]
curr_Stock_Price:  97.23849884396166
curr_Factors:  [97.23849884 -1.00128078 -0.93342842]
mat_Sqrt:  [[14.04768358  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01300625 0.26252864 0.41549247]
Stock Position:  0.013006251190011878
Bond Position:  [-1.68090324]


portfolio before change:  [-0.40514835]
curr_Stock_Price:  98.10398068283823
curr_Factors:  [98.10398068 -0.98649998 -0.96476453]
mat_Sqrt:  [[13.94001438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00260404 0.00151849 0.00966407]
Stock Position:  0.0026040404414969724
Bond Position:  [-0.66061509]


portfolio before change:  [-0.40145607]
curr_Stock_Price:  99.55360055546507
curr_Factors:  [99.55360056 -1.18163686 -0.96198824]
mat_Sqrt:  [[11.67057948  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03349262 0.03942845 0.53148348]
Stock Position:  0.03349262364441456
Bond Position:  [-3.73576734]


portfolio before change:  [-0.40315622]
curr_Stock_Price:  99.51678181457949
curr_Factors:  [99.51678181 -1.39015784 -0.96637815]
mat_Sqrt:  [[ 9.42900247  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01889033 -0.07495227  0.00086996]
Stock Position:  -0.018890325607368752
Bond Position:  [1.47674819]


portfolio before change:  [-0.41397917]
curr_Stock_Price:  100.09949025345324
curr_Factors:  [100.09949025  -1.26996952  -0.96830609]
mat_Sqrt:  [[10.67483375  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00399678 -0.00458755  0.31160617]
Stock Position:  0.003996779165509785
Bond Position:  [-0.81405473]


portfolio before change:  [-0.41182299]
curr_Stock_Price:  100.66443119075048
curr_Factors:  [100.66443119  -1.22793091  -0.95853961]
mat_Sqrt:  [[11.30586934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0015477  -0.01686383  0.21796628]
Stock Position:  0.0015476995127340007
Bond Position:  [-0.56762128]


portfolio before change:  [-0.41216664]
curr_Stock_Price:  100.48824017417148
curr_Factors:  [100.48824017  -1.17429188  -0.96034186]
mat_Sqrt:  [[11.88654355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213135 -0.0365815  -0.19072905]
Stock Position:  -0.002131351224681487
Bond Position:  [-0.1979909]


portfolio before change:  [-0.41134952]
curr_Stock_Price:  100.0932482906337
curr_Factors:  [100.09324829  -0.9610549   -0.92552611]
mat_Sqrt:  [[15.1730561   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00065831 -0.0137577  -0.2209068 ]
Stock Position:  0.0006583063401092934
Bond Position:  [-0.47724154]


portfolio before change:  [-0.4111221]
curr_Stock_Price:  100.52934054090902
curr_Factors:  [100.52934054  -0.93281188  -0.93321992]
mat_Sqrt:  [[15.55555542  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00082472 -0.01228589  0.21115756]
Stock Position:  -0.0008247198443119661
Bond Position:  [-0.32821356]


portfolio before change:  [-0.40951531]
curr_Stock_Price:  98.5313039502734
curr_Factors:  [98.53130395 -1.06731884 -0.92891736]
mat_Sqrt:  [[13.38504587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.87698234e-03 8.22659479e-03 2.52790123e-05]
Stock Position:  0.0038769823353068437
Bond Position:  [-0.79151943]


portfolio before change:  [-0.40530682]
curr_Stock_Price:  99.6423319345806
curr_Factors:  [99.64233193 -1.28903249 -0.93758401]
mat_Sqrt:  [[10.75069702  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0062288  -0.02051964  0.02426372]
Stock Position:  -0.006228803349855154
Bond Position:  [0.21534567]


portfolio before change:  [-0.39923225]
curr_Stock_Price:  98.67141494019964
curr_Factors:  [98.67141494 -1.18713617 -0.95434024]
mat_Sqrt:  [[11.59204263  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.25936126e-04  3.18219701e-03 -4.29456122e-01]
Stock Position:  0.0003259361262723981
Bond Position:  [-0.43139283]


portfolio before change:  [-0.39933005]
curr_Stock_Price:  98.5367864542771
curr_Factors:  [98.53678645 -1.05429622 -0.96287928]
mat_Sqrt:  [[13.10841575  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0005552  -0.00071525 -0.08415948]
Stock Position:  -0.0005551977614399341
Bond Position:  [-0.34462265]


portfolio before change:  [-0.39953675]
curr_Stock_Price:  98.8314792121847
curr_Factors:  [98.83147921 -1.05106078 -0.97127951]
mat_Sqrt:  [[13.07988927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149645  0.13605937 -1.08291454]
Stock Position:  -0.0014964520408024295
Bond Position:  [-0.25164018]


portfolio before change:  [-0.40086656]
curr_Stock_Price:  99.6991005097453
curr_Factors:  [99.69910051 -1.21380893 -0.99969654]
mat_Sqrt:  [[10.89878361  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0208524  0.03973759 0.26398482]
Stock Position:  0.02085240107627561
Bond Position:  [-2.47983219]


portfolio before change:  [-0.40734188]
curr_Stock_Price:  99.40343569078809
curr_Factors:  [99.40343569 -1.01298579 -0.9867683 ]
mat_Sqrt:  [[13.45610072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00051685 -0.00526892  0.16929251]
Stock Position:  0.0005168499536006755
Bond Position:  [-0.45871854]


portfolio before change:  [-0.40725775]
curr_Stock_Price:  99.67715877572844
curr_Factors:  [99.67715878 -1.08440978 -0.98233102]
mat_Sqrt:  [[12.61890082  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00087186 -0.03224192 -0.57774109]
Stock Position:  -0.0008718645334225727
Bond Position:  [-0.32035277]


portfolio before change:  [-0.40799491]
curr_Stock_Price:  100.4767336468763
curr_Factors:  [100.47673365  -1.40084918  -0.97351952]
mat_Sqrt:  [[ 9.35169395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00528337  0.00529409 -0.03959101]
Stock Position:  0.0052833651801658665
Bond Position:  [-0.93885019]


portfolio before change:  [-0.40958026]
curr_Stock_Price:  100.19888464419303
curr_Factors:  [100.19888464  -1.37287119  -0.93658939]
mat_Sqrt:  [[ 9.9512331   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.97329459e-03 -3.26211784e-04  4.18224542e-01]
Stock Position:  -0.001973294592078679
Bond Position:  [-0.21185834]


portfolio before change:  [-0.40831782]
curr_Stock_Price:  99.54570382462084
curr_Factors:  [99.54570382 -1.30706334 -0.94164192]
mat_Sqrt:  [[10.50563323  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168854 -0.01046184  0.00663326]
Stock Position:  -0.001688535891918248
Bond Position:  [-0.24023133]


portfolio before change:  [-0.40885829]
curr_Stock_Price:  99.84799807777038
curr_Factors:  [99.84799808 -1.12496034 -0.92587033]
mat_Sqrt:  [[12.84324943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00550917  0.0007812  -0.69748398]
Stock Position:  -0.005509166079055836
Bond Position:  [0.14122092]


portfolio before change:  [-0.40850196]
curr_Stock_Price:  99.78652434867055
curr_Factors:  [99.78652435 -1.19280612 -0.92213117]
mat_Sqrt:  [[12.03833163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00498327 -0.01222669  0.02644197]
Stock Position:  -0.004983269460079774
Bond Position:  [0.08876117]


portfolio before change:  [-0.40702202]
curr_Stock_Price:  99.49176851449606
curr_Factors:  [99.49176851 -1.13524488 -0.91194479]
mat_Sqrt:  [[12.84410867  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00419864  0.00194346  0.03650282]
Stock Position:  -0.004198636149840485
Bond Position:  [0.01070771]


portfolio before change:  [-0.40914486]
curr_Stock_Price:  99.99768969568478
curr_Factors:  [99.9976897  -0.95351485 -0.92051604]
mat_Sqrt:  [[15.35001112  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0023804  -0.01360096 -0.02581705]
Stock Position:  -0.0023803991516504583
Bond Position:  [-0.17111045]


portfolio before change:  [-0.41109629]
curr_Stock_Price:  100.80849442426924
curr_Factors:  [100.80849442  -0.90992181  -0.93113911]
mat_Sqrt:  [[15.99316923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00170126  0.00650505 -0.11236455]
Stock Position:  0.0017012565830531623
Bond Position:  [-0.58259741]


portfolio before change:  [-0.41090135]
curr_Stock_Price:  100.96589159598072
curr_Factors:  [100.9658916   -0.91851885  -0.93297603]
mat_Sqrt:  [[15.8518762   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.44756957e-05 4.27544011e-03 2.60735032e-01]
Stock Position:  3.447569568567129e-05
Bond Position:  [-0.41438222]


portfolio before change:  [-0.41096095]
curr_Stock_Price:  100.73967030622848
curr_Factors:  [100.73967031  -0.92236012  -0.95926898]
mat_Sqrt:  [[15.34685499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00052957 -0.02043396  0.06721621]
Stock Position:  0.0005295737803615316
Bond Position:  [-0.46431004]


portfolio before change:  [-0.41096442]
curr_Stock_Price:  100.84271806291028
curr_Factors:  [100.84271806  -1.04663219  -0.97301854]
mat_Sqrt:  [[13.3820108   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244313  0.00376626  0.10754083]
Stock Position:  -0.002443126644115733
Bond Position:  [-0.16459289]


portfolio before change:  [-0.41265302]
curr_Stock_Price:  101.52545892199592
curr_Factors:  [101.52545892  -1.10782481  -0.97346168]
mat_Sqrt:  [[12.6672903   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01075026 0.00957086 0.55570858]
Stock Position:  0.010750257674545556
Bond Position:  [-1.50407786]


portfolio before change:  [-0.40807713]
curr_Stock_Price:  101.96860216849407
curr_Factors:  [101.96860217  -1.22246807  -0.94650265]
mat_Sqrt:  [[11.65452162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0082053  -0.01930483  0.07783006]
Stock Position:  0.00820530402557566
Bond Position:  [-1.24476052]


portfolio before change:  [-0.40690539]
curr_Stock_Price:  102.13036914345038
curr_Factors:  [102.13036914  -1.25073962  -0.94063614]
mat_Sqrt:  [[11.41438466  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00445563 -0.00015727  0.08542438]
Stock Position:  -0.004455633601464677
Bond Position:  [0.04815011]


portfolio before change:  [-0.40811615]
curr_Stock_Price:  102.40345566929412
curr_Factors:  [102.40345567  -1.15368939  -0.96447177]
mat_Sqrt:  [[12.31427672  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00973058 0.00235686 0.31347436]
Stock Position:  0.009730577056501533
Bond Position:  [-1.40456086]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.41541574]
Stock Price:  101.6713289483113
PL:  [-2.08674469]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.04161159e-01 -6.42234628e-02  7.22664348e-03]
 [-1.78885906e-01  7.72320125e-02 -2.34525600e-01]
 [-3.87985689e-02  4.52705688e-02  1.89901794e-02]
 [-6.65888674e-03 -3.37600785e-02  4.88639672e-02]
 [ 9.14944119e-02 -5.48647013e-02 -8.67600892e-02]
 [-7.14886978e-02 -1.51548741e-01  1.58662026e-01]
 [-6.37360804e-02 -1.46994741e-01  3.76762749e-02]
 [ 1.28006098e-03  7.64279730e-01  1.17463052e-01]
 [ 1.01524133e-03  4.88901926e-03 -3.35666242e-02]
 [ 2.01717481e-01  6.95256643e-02  7.97152216e-02]
 [-1.36535064e-01 -2.41786612e-01 -4.39527870e-03]
 [-1.63216277e-02 -1.72758072e-02  9.49891787e-02]
 [-3.35882374e-02  1.67968918e-01 -7.58873783e-02]
 [ 9.73214951e-03 -1.20802186e-01  5.10036182e-02]
 [-6.90304214e-02  1.77953312e-01 -3.41398539e-02]
 [ 1.14489172e-01  1.82045742e-04 -1.91857450e-02]
 [ 4.37414531e-02  3.07789686e-02  1.72473321e-02]
 [-5.72537707e-02 -6.39635641e-02  9.50678642e-03]
 [ 4.45170577e-02 -5.00083803e-03 -7.28387722e-02]
 [ 2.85550842e-02 -1.58589025e-02  9.66975792e-02]
 [-1.55779926e-02  3.21996292e-01 -2.69151996e-01]
 [ 5.72920700e-02  5.80098014e-02  1.13529246e-01]
 [-1.89481537e-03 -1.60174921e-02  5.91566445e-02]
 [ 1.20748317e-01 -1.35697260e-01 -2.98021339e-01]
 [ 3.12948576e-02  1.89486710e-02 -1.23679314e-02]
 [-8.12629138e-02 -1.59746343e-02  2.12625229e-01]
 [-1.16512535e-02 -3.24123104e-02  2.33998657e-03]
 [ 3.01896208e-02 -2.66197409e-02 -1.70021124e-01]
 [-4.99512597e-02 -2.88187581e-02 -6.67637289e-03]
 [-6.37958756e-02  1.64994508e-03  2.04527447e-02]
 [ 2.83303757e-02 -4.43407334e-02 -8.42914486e-02]
 [ 8.30318295e-03  5.06362676e-02 -6.19544933e-02]
 [-4.31075496e-03  2.61884383e-02 -7.48407651e-03]
 [ 4.03762868e-02 -3.23652732e-02  1.79859741e-01]
 [-6.93462628e-02  6.29968447e-03 -2.32270252e-02]
 [-3.02519868e-02 -9.27942210e-02 -1.24763908e-02]
 [-3.86281022e-02  1.00367466e-01  6.11073632e-02]
 [ 3.06319967e-02 -5.88430791e-02 -4.16311612e-02]
 [ 9.67831729e-02  4.40631419e-03  7.27473481e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.32904568]
curr_Stock_Price:  99.6567398989047
curr_Factors:  [99.6567399  -0.98081878 -1.02108131]
mat_Sqrt:  [[13.46147081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00687345 -0.02072803  0.0206156 ]
Stock Position:  0.006873448940769544
Bond Position:  [-1.01403119]


portfolio before change:  [-0.32655508]
curr_Stock_Price:  100.03753225305968
curr_Factors:  [100.03753225  -1.13535163  -1.00034435]
mat_Sqrt:  [[11.82066727  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01784953  0.02492652 -0.66903626]
Stock Position:  -0.01784952743615108
Bond Position:  [1.45906759]


portfolio before change:  [-0.32858199]
curr_Stock_Price:  100.1613057287969
curr_Factors:  [100.16130573  -1.30591851  -0.96731903]
mat_Sqrt:  [[10.31443539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00248985  0.01461101  0.0541737 ]
Stock Position:  -0.0024898501598174735
Bond Position:  [-0.07919534]


portfolio before change:  [-0.32966222]
curr_Stock_Price:  100.59118636644799
curr_Factors:  [100.59118637  -1.19330467  -0.95991166]
mat_Sqrt:  [[11.67965354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030616 -0.01089602  0.1393953 ]
Stock Position:  -0.00030615791423594334
Bond Position:  [-0.29886544]


portfolio before change:  [-0.329622]
curr_Stock_Price:  100.33778028339145
curr_Factors:  [100.33778028  -1.2073021   -0.93967942]
mat_Sqrt:  [[11.72309447  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00533864 -0.01770751 -0.24750239]
Stock Position:  0.005338639277408121
Bond Position:  [-0.86528922]


portfolio before change:  [-0.33605137]
curr_Stock_Price:  99.15373296097515
curr_Factors:  [99.15373296 -1.07971306 -0.94921922]
mat_Sqrt:  [[13.03631892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00537243 -0.04891215  0.4526186 ]
Stock Position:  -0.005372429518446716
Bond Position:  [0.19664507]


portfolio before change:  [-0.33306482]
curr_Stock_Price:  98.6024056349272
curr_Factors:  [98.60240563 -1.09707761 -0.96129137]
mat_Sqrt:  [[12.58778224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00683604 -0.04744235  0.10747993]
Stock Position:  -0.006836042864694988
Bond Position:  [0.34098545]


portfolio before change:  [-0.33259146]
curr_Stock_Price:  98.53939599619794
curr_Factors:  [98.539396   -0.98719507 -0.97644262]
mat_Sqrt:  [[13.82970393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01310694 0.24667022 0.33508939]
Stock Position:  0.013106936603530385
Bond Position:  [-1.62414108]


portfolio before change:  [-0.34151424]
curr_Stock_Price:  97.87411858278436
curr_Factors:  [97.87411858 -1.03264656 -0.96653354]
mat_Sqrt:  [[13.25668625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036499  0.00157792 -0.09575624]
Stock Position:  -0.00036498942344782923
Bond Position:  [-0.30579122]


portfolio before change:  [-0.34161752]
curr_Stock_Price:  98.0523620564206
curr_Factors:  [98.05236206 -1.22691233 -0.97184429]
mat_Sqrt:  [[10.87802854  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02134405 0.02243931 0.22740534]
Stock Position:  0.021344046739399672
Bond Position:  [-2.43445172]


portfolio before change:  [-0.33733043]
curr_Stock_Price:  98.26747671790432
curr_Factors:  [98.26747672 -1.05080908 -0.963657  ]
mat_Sqrt:  [[13.10805648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01424977 -0.07803629 -0.01253851]
Stock Position:  -0.0142497655998471
Bond Position:  [1.06295808]


portfolio before change:  [-0.32780772]
curr_Stock_Price:  97.60853047132431
curr_Factors:  [97.60853047 -1.06225465 -0.94425255]
mat_Sqrt:  [[13.12419791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.49318261e-05 -5.57574279e-03  2.70977687e-01]
Stock Position:  -3.4931826050793755e-05
Bond Position:  [-0.32439808]


portfolio before change:  [-0.32783861]
curr_Stock_Price:  97.33185327828855
curr_Factors:  [97.33185328 -0.94254043 -0.93203687]
mat_Sqrt:  [[14.93263384  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00099059  0.05421174 -0.21648557]
Stock Position:  -0.0009905936185312303
Bond Position:  [-0.2314223]


portfolio before change:  [-0.32782026]
curr_Stock_Price:  97.28412005417442
curr_Factors:  [97.28412005 -1.02820895 -0.90331687]
mat_Sqrt:  [[14.09908564  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00032026 -0.03898874  0.14549913]
Stock Position:  -0.0003202635697554444
Bond Position:  [-0.2966637]


portfolio before change:  [-0.3279684]
curr_Stock_Price:  97.63088591503636
curr_Factors:  [97.63088592 -1.30726083 -0.90549984]
mat_Sqrt:  [[10.68064504  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00371463  0.05743418 -0.0973915 ]
Stock Position:  -0.0037146278993358023
Bond Position:  [0.03469402]


portfolio before change:  [-0.32848137]
curr_Stock_Price:  97.77014951680219
curr_Factors:  [97.77014952 -1.34475176 -0.92550081]
mat_Sqrt:  [[10.09829639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.09533385e-02  5.87550106e-05 -5.47315902e-02]
Stock Position:  0.01095333846977898
Bond Position:  [-1.39939091]


portfolio before change:  [-0.31721721]
curr_Stock_Price:  98.81449750135249
curr_Factors:  [98.8144975  -1.48870359 -0.8875935 ]
mat_Sqrt:  [[ 9.17926595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00583323 0.00993387 0.04920184]
Stock Position:  0.005833231214985213
Bond Position:  [-0.89362502]


portfolio before change:  [-0.31462311]
curr_Stock_Price:  99.27835939101912
curr_Factors:  [99.27835939 -1.63251453 -0.92033997]
mat_Sqrt:  [[ 7.7297237   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00884504 -0.02064415  0.02712022]
Stock Position:  -0.008845039825453717
Bond Position:  [0.56349794]


portfolio before change:  [-0.3086002]
curr_Stock_Price:  98.60538771859726
curr_Factors:  [98.60538772 -1.81385722 -0.94004627]
mat_Sqrt:  [[ 6.27907334  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00455929 -0.00161401 -0.20778874]
Stock Position:  0.004559289600417422
Bond Position:  [-0.75817072]


portfolio before change:  [-0.3094002]
curr_Stock_Price:  98.45071141858004
curr_Factors:  [98.45071142 -1.76957024 -0.92235677]
mat_Sqrt:  [[ 6.67006108  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00675499 -0.00511844  0.27585128]
Stock Position:  0.0067549921149382165
Bond Position:  [-0.97443397]


portfolio before change:  [-0.30905608]
curr_Stock_Price:  98.51968679936289
curr_Factors:  [98.5196868  -1.55080708 -0.90728344]
mat_Sqrt:  [[ 8.43311215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.68140899e-04  1.03923856e-01 -7.67815727e-01]
Stock Position:  -0.0005681408989527815
Bond Position:  [-0.25308302]


portfolio before change:  [-0.30930409]
curr_Stock_Price:  98.90052453609317
curr_Factors:  [98.90052454 -1.34802294 -0.92615372]
mat_Sqrt:  [[10.17504223  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00907194 0.01872258 0.32386734]
Stock Position:  0.009071935958347734
Bond Position:  [-1.20652331]


portfolio before change:  [-0.30585139]
curr_Stock_Price:  99.29774100046546
curr_Factors:  [99.297741   -1.5526246  -0.91708002]
mat_Sqrt:  [[ 8.4015667   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00082258 -0.00516962  0.16875744]
Stock Position:  0.000822576013200055
Bond Position:  [-0.38753133]


portfolio before change:  [-0.3057267]
curr_Stock_Price:  99.5082123033019
curr_Factors:  [99.5082123  -1.45767398 -0.94012655]
mat_Sqrt:  [[ 9.04705826  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00356092 -0.0437961  -0.85017193]
Stock Position:  0.00356092312284569
Bond Position:  [-0.6600678]


portfolio before change:  [-0.30701712]
curr_Stock_Price:  99.16900174286492
curr_Factors:  [99.16900174 -1.12988791 -0.94800635]
mat_Sqrt:  [[12.41532038  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00262886  0.00611566 -0.03528227]
Stock Position:  0.0026288605082394967
Bond Position:  [-0.56771859]


portfolio before change:  [-0.30748015]
curr_Stock_Price:  99.01986609891635
curr_Factors:  [99.0198661  -0.97391652 -0.91682338]
mat_Sqrt:  [[14.94804602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00275098 -0.00515579  0.60656059]
Stock Position:  -0.0027509802509424926
Bond Position:  [-0.03507845]


portfolio before change:  [-0.30916601]
curr_Stock_Price:  99.63109647654005
curr_Factors:  [99.63109648 -1.07727789 -0.91901105]
mat_Sqrt:  [[13.53373397  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131447 -0.01046103  0.00667533]
Stock Position:  -0.0013144739619528447
Bond Position:  [-0.17820353]


portfolio before change:  [-0.30999322]
curr_Stock_Price:  100.24345189367006
curr_Factors:  [100.24345189  -1.40965828  -0.92424946]
mat_Sqrt:  [[ 9.71522269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102412 -0.00859148 -0.48502294]
Stock Position:  -0.001024117293597381
Bond Position:  [-0.20733216]


portfolio before change:  [-0.31014008]
curr_Stock_Price:  100.36154639534212
curr_Factors:  [100.3615464   -1.5195723   -0.93778158]
mat_Sqrt:  [[ 8.59710271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00665302 -0.00930121 -0.01904583]
Stock Position:  -0.006653017285759574
Bond Position:  [0.35756703]


portfolio before change:  [-0.30748168]
curr_Stock_Price:  99.96868691035374
curr_Factors:  [99.96868691 -1.29308728 -0.94507313]
mat_Sqrt:  [[10.66211276  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00556027  0.00053252  0.05834599]
Stock Position:  -0.005560265991735048
Bond Position:  [0.24837081]


portfolio before change:  [-0.30094874]
curr_Stock_Price:  98.79933869913636
curr_Factors:  [98.7993387  -1.21967753 -0.93936413]
mat_Sqrt:  [[11.40497037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.81801568e-04 -1.43109102e-02 -2.40460041e-01]
Stock Position:  0.0001818015683163679
Bond Position:  [-0.31891062]


portfolio before change:  [-0.30095124]
curr_Stock_Price:  99.00487330549123
curr_Factors:  [99.00487331 -1.07616335 -0.95638032]
mat_Sqrt:  [[12.9698237   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00046206  0.01634279 -0.17673892]
Stock Position:  0.00046206177943655116
Bond Position:  [-0.34669761]


portfolio before change:  [-0.30156956]
curr_Stock_Price:  97.76050709223378
curr_Factors:  [97.76050709 -1.13917112 -0.9625063 ]
mat_Sqrt:  [[11.95133826  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.12291148e-05  8.45228211e-03 -2.13499871e-02]
Stock Position:  -4.122911475206635e-05
Bond Position:  [-0.29753898]


portfolio before change:  [-0.30158677]
curr_Stock_Price:  97.27593988148772
curr_Factors:  [97.27593988 -0.9663868  -0.9547077 ]
mat_Sqrt:  [[14.24572963  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00494769 -0.01044585  0.51308978]
Stock Position:  0.004947691044481714
Bond Position:  [-0.78287807]


portfolio before change:  [-0.30050571]
curr_Stock_Price:  97.51421928002979
curr_Factors:  [97.51421928 -0.97578237 -0.95481638]
mat_Sqrt:  [[14.14554095  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00514661  0.00203321 -0.06626024]
Stock Position:  -0.005146607118228412
Bond Position:  [0.20136167]


portfolio before change:  [-0.30002236]
curr_Stock_Price:  97.42519423954502
curr_Factors:  [97.42519424 -1.13180548 -0.96074638]
mat_Sqrt:  [[12.01953192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430468 -0.02994921 -0.03559167]
Stock Position:  -0.004304681812311396
Bond Position:  [0.1193621]


portfolio before change:  [-0.30306823]
curr_Stock_Price:  98.13623285105781
curr_Factors:  [98.13623285 -0.69263945 -0.94911646]
mat_Sqrt:  [[19.00307364  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00029822  0.03239346  0.1743223 ]
Stock Position:  -0.000298224952371943
Bond Position:  [-0.27380156]


portfolio before change:  [-0.30323256]
curr_Stock_Price:  98.57247273882147
curr_Factors:  [98.57247274 -0.75600866 -0.97715571]
mat_Sqrt:  [[17.42015164  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0005811  -0.01899152 -0.11876211]
Stock Position:  0.0005810958778106019
Bond Position:  [-0.36051261]


portfolio before change:  [-0.30340961]
curr_Stock_Price:  98.34533207699624
curr_Factors:  [98.34533208 -0.93374233 -0.95664022]
mat_Sqrt:  [[14.85152466  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00757714 0.00142213 0.20752794]
Stock Position:  0.007577141123258412
Bond Position:  [-1.04858607]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.31052283]
Stock Price:  97.42385911164965
PL:  [-0.31052283]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.83219232e-01 -9.97216531e-02  2.66798454e-02]
 [-8.57099976e-02  9.78450327e-02 -4.97679782e-02]
 [ 1.70024066e-02 -6.63391108e-03  5.85340846e-02]
 [-6.43179173e-01 -3.05445924e-01 -4.08978493e-01]
 [ 2.41994344e-01 -2.47595902e-01 -1.05427587e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.14161676e-02 -2.09111992e-01 -2.83894461e-02]
 [ 8.21077201e-03  6.48235498e-01  9.75524916e-02]
 [ 3.16293603e-01  8.70898086e-03  3.31686562e-01]
 [ 5.38632555e-01  2.36139875e-01  4.48457292e-01]
 [-2.07813933e-01 -2.39603485e-01  1.28460055e-02]
 [ 2.10112924e-02 -1.37987072e-02  1.11673259e-01]
 [ 1.43926231e-02 -4.22075521e-02  3.91213781e-02]
 [ 7.03412230e-04  1.11277018e-01  4.22476883e-03]
 [ 2.29300929e-01 -1.73537556e-01 -1.42420099e-01]
 [-9.92818783e-02 -6.04379662e-02  9.22767331e-02]
 [ 4.85119102e-02  2.22171806e-02 -1.06539530e-02]
 [-4.36210098e-02 -5.28815405e-02  4.73812420e-02]
 [ 9.98246742e-02 -7.75460325e-02 -5.85831831e-02]
 [ 4.57385703e-02 -1.34733513e-02  1.60341884e-01]
 [-1.77415868e-02  3.52340763e-01 -3.34466758e-01]
 [ 1.59849699e-01  1.11928181e-01  9.63475316e-02]
 [-8.98611364e-03  8.87065212e-02 -4.17175550e-03]
 [ 9.12253419e-02 -1.72727331e-01 -2.81440790e-01]
 [ 5.76252673e-02  2.24168739e-02 -1.42168308e-02]
 [-2.55314789e-02  1.24051238e-02  6.19193581e-02]
 [ 8.23477335e-02 -2.95851229e-02  3.14907644e-02]
 [ 1.57135123e-01 -6.17859289e-02  1.52686694e-01]
 [-4.43830443e-02 -1.16979412e-02 -3.86100814e-02]
 [-5.99445398e-02 -1.36598190e-02  4.03894402e-02]
 [-3.57575432e-02 -5.31917210e-02 -2.86040018e-02]
 [ 2.63272002e-02 -4.69965187e-02 -1.05993522e-01]
 [ 8.07727693e-02  2.33313734e-03  1.38988739e-01]
 [ 4.21247637e-04 -9.05685164e-02 -1.53703385e-01]
 [ 2.26291312e-02  1.13001202e-01 -1.85194918e-02]
 [ 3.93839405e-02  2.92208724e-02  1.34672989e-01]
 [ 3.08600682e-01 -2.05133330e-01  1.68188849e-01]
 [-8.76481499e-02  2.86723191e-02  3.77049385e-02]
 [ 1.11280455e-01  4.95495364e-03  1.16349066e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.61954456]
curr_Stock_Price:  101.28920033050177
curr_Factors:  [101.28920033  -1.1991822   -1.00300852]
mat_Sqrt:  [[11.1986035   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02662196 -0.03218503  0.07611017]
Stock Position:  -0.026621964792476704
Bond Position:  [15.31606209]


portfolio before change:  [12.60839799]
curr_Stock_Price:  101.7798176712176
curr_Factors:  [101.77981767  -1.14839562  -1.02020068]
mat_Sqrt:  [[11.63730081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00652181  0.03157935 -0.14197419]
Stock Position:  -0.006521813883258329
Bond Position:  [13.27218702]


portfolio before change:  [12.61170901]
curr_Stock_Price:  101.52653044986225
curr_Factors:  [101.52653045  -1.17589596  -1.04437812]
mat_Sqrt:  [[11.0236842   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00250338 -0.00214109  0.16698145]
Stock Position:  0.0025033813220905073
Bond Position:  [12.35754939]


portfolio before change:  [12.61544643]
curr_Stock_Price:  102.40239765693057
curr_Factors:  [102.40239766  -1.3932961   -1.04929238]
mat_Sqrt:  [[ 8.90240662  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08862889 -0.09858225 -1.1667018 ]
Stock Position:  -0.08862889323809801
Bond Position:  [21.6912576]


portfolio before change:  [12.60592016]
curr_Stock_Price:  102.54047733574086
curr_Factors:  [102.54047734  -1.37660972  -1.04388819]
mat_Sqrt:  [[ 9.11352622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01864632 -0.07991123 -0.30075556]
Stock Position:  0.018646320021199512
Bond Position:  [10.6939176]


portfolio before change:  [12.60649992]
curr_Stock_Price:  102.49987654283542
curr_Factors:  [102.49987654  -1.42096464  -1.04411717]
mat_Sqrt:  [[ 8.71268296  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01759552 -0.05534923  0.15513819]
Stock Position:  -0.017595521023187097
Bond Position:  [14.41003866]


portfolio before change:  [12.60916651]
curr_Stock_Price:  102.45070390586422
curr_Factors:  [102.45070391  -1.30988214  -1.02834248]
mat_Sqrt:  [[ 9.88637089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01010441 -0.06749061 -0.08098719]
Stock Position:  -0.010104410081762905
Bond Position:  [13.64437044]


portfolio before change:  [12.61289351]
curr_Stock_Price:  102.25065792880449
curr_Factors:  [102.25065793  -1.17922623  -0.99037228]
mat_Sqrt:  [[11.67942466  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01373733 0.20921711 0.27829011]
Stock Position:  0.013737329761263836
Bond Position:  [11.2082425]


portfolio before change:  [12.62346143]
curr_Stock_Price:  102.91794916857526
curr_Factors:  [102.91794917  -1.37879558  -0.97430501]
mat_Sqrt:  [[ 9.7848129   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03942605 0.00281081 0.94620944]
Stock Position:  0.03942605304730133
Bond Position:  [8.5658129]


portfolio before change:  [12.60087917]
curr_Stock_Price:  102.31801460250063
curr_Factors:  [102.3180146   -1.3493554   -0.97354372]
mat_Sqrt:  [[10.02604929  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06766128 0.07621382 1.27932383]
Stock Position:  0.06766128377066359
Bond Position:  [5.67791095]


portfolio before change:  [12.5889795]
curr_Stock_Price:  102.13165312499682
curr_Factors:  [102.13165312  -1.38035313  -0.95031498]
mat_Sqrt:  [[ 9.93033871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02558831 -0.07733169  0.03664608]
Stock Position:  -0.02558831243981121
Bond Position:  [15.20235615]


portfolio before change:  [12.59412218]
curr_Stock_Price:  102.00494406294317
curr_Factors:  [102.00494406  -1.50958849  -0.93169135]
mat_Sqrt:  [[ 8.87946624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00461625 -0.00445351  0.31857273]
Stock Position:  0.004616251768996971
Bond Position:  [12.12324168]


portfolio before change:  [12.5973165]
curr_Stock_Price:  102.36862014907908
curr_Factors:  [102.36862015  -1.34639803  -0.9313046 ]
mat_Sqrt:  [[10.49477583  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00131138 -0.01362243  0.1116024 ]
Stock Position:  0.0013113820336996531
Bond Position:  [12.46307213]


portfolio before change:  [12.59885527]
curr_Stock_Price:  102.35396885403925
curr_Factors:  [102.35396885  -1.32482089  -0.90955775]
mat_Sqrt:  [[10.95787578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00221577 0.0359145  0.01205209]
Stock Position:  0.0022157684829598873
Bond Position:  [12.37206257]


portfolio before change:  [12.60022097]
curr_Stock_Price:  102.2723275271272
curr_Factors:  [102.27232753  -1.16824473  -0.89603958]
mat_Sqrt:  [[12.97928761  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01269764 -0.05600901 -0.4062849 ]
Stock Position:  0.012697641661117684
Bond Position:  [11.30160361]


portfolio before change:  [12.59219244]
curr_Stock_Price:  101.52877816049194
curr_Factors:  [101.52877816  -1.11319288  -0.91920655]
mat_Sqrt:  [[13.30237851  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0069749  -0.01950627  0.26323983]
Stock Position:  -0.006974904310576517
Bond Position:  [13.30034595]


portfolio before change:  [12.59547902]
curr_Stock_Price:  101.29595363815278
curr_Factors:  [101.29595364  -1.15288204  -0.91468393]
mat_Sqrt:  [[12.81325907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00397028  0.00717056 -0.03039276]
Stock Position:  0.0039702813990036764
Bond Position:  [12.19330557]


portfolio before change:  [12.59797489]
curr_Stock_Price:  101.54067696540962
curr_Factors:  [101.54067697  -1.17468386  -0.89409671]
mat_Sqrt:  [[12.82862367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00348781 -0.01706744  0.1351655 ]
Stock Position:  -0.003487806231425881
Bond Position:  [12.9521291]


portfolio before change:  [12.59774563]
curr_Stock_Price:  102.07063257290777
curr_Factors:  [102.07063257  -1.26068101  -0.89149199]
mat_Sqrt:  [[11.86380357  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00607203 -0.02502787 -0.16712152]
Stock Position:  0.006072033645747415
Bond Position:  [11.97796931]


portfolio before change:  [12.60070853]
curr_Stock_Price:  102.3119956686337
curr_Factors:  [102.31199567  -1.31127186  -0.88066155]
mat_Sqrt:  [[11.4283089   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00662548 -0.00434851  0.45741076]
Stock Position:  0.006625475797864784
Bond Position:  [11.92284288]


portfolio before change:  [12.6053066]
curr_Stock_Price:  102.78103646733862
curr_Factors:  [102.78103647  -1.55611681  -0.8981084 ]
mat_Sqrt:  [[ 8.83194848  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00159569  0.11371749 -0.95414056]
Stock Position:  -0.0015956921577037944
Bond Position:  [12.76931349]


portfolio before change:  [12.60653742]
curr_Stock_Price:  103.01005645261871
curr_Factors:  [103.01005645  -1.76553559  -0.91222595]
mat_Sqrt:  [[ 7.0785216   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02858843 0.03612467 0.27485269]
Stock Position:  0.02858842740815376
Bond Position:  [9.6616419]


portfolio before change:  [12.59691038]
curr_Stock_Price:  102.63106325201606
curr_Factors:  [102.63106325  -1.57057164  -0.9215482 ]
mat_Sqrt:  [[ 8.49111912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0009739   0.02862991 -0.01190086]
Stock Position:  0.0009738967304532174
Bond Position:  [12.49695832]


portfolio before change:  [12.59772076]
curr_Stock_Price:  101.85907117158543
curr_Factors:  [101.85907117  -1.3604938   -0.90078867]
mat_Sqrt:  [[10.61542074  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.39545819e-04 -5.57475063e-02 -8.02872236e-01]
Stock Position:  -0.00013954581914594265
Bond Position:  [12.61193476]


portfolio before change:  [12.59918275]
curr_Stock_Price:  102.68031671050421
curr_Factors:  [102.68031671  -1.32972479  -0.89855506]
mat_Sqrt:  [[11.06006189  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00536155  0.00723501 -0.04055666]
Stock Position:  0.005361551738021629
Bond Position:  [12.04865692]


portfolio before change:  [12.60257006]
curr_Stock_Price:  103.03117341198498
curr_Factors:  [103.03117341  -1.21618749  -0.92048611]
mat_Sqrt:  [[12.16250672  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008518   0.00400374  0.17663869]
Stock Position:  -0.0008518028267785791
Bond Position:  [12.6903323]


portfolio before change:  [12.60398855]
curr_Stock_Price:  103.22828594004932
curr_Factors:  [103.22828594  -1.18857446  -0.90408451]
mat_Sqrt:  [[12.73410635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00649725 -0.00954856  0.08983439]
Stock Position:  0.006497253808782768
Bond Position:  [11.93328817]


portfolio before change:  [12.60816966]
curr_Stock_Price:  103.64220772946118
curr_Factors:  [103.64220773  -1.09527871  -0.91653009]
mat_Sqrt:  [[13.86178618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01267442 -0.01994132  0.43557264]
Stock Position:  0.012674424640836481
Bond Position:  [11.29456431]


portfolio before change:  [12.60879047]
curr_Stock_Price:  103.57979081041125
curr_Factors:  [103.57979081  -1.47266883  -0.95576401]
mat_Sqrt:  [[ 9.13313861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00598394 -0.00377549 -0.11014382]
Stock Position:  -0.005983937041544296
Bond Position:  [13.22860541]


portfolio before change:  [12.6045338]
curr_Stock_Price:  104.56749230714412
curr_Factors:  [104.56749231  -1.54346704  -0.97664048]
mat_Sqrt:  [[ 8.41255474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00647703 -0.00440869  0.11521983]
Stock Position:  -0.006477031101132956
Bond Position:  [13.2818207]


portfolio before change:  [12.60151833]
curr_Stock_Price:  105.28939823612205
curr_Factors:  [105.28939824  -1.37198419  -1.01437346]
mat_Sqrt:  [[ 9.68283844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00541722 -0.01716755 -0.08159926]
Stock Position:  -0.005417215776652824
Bond Position:  [13.17189372]


portfolio before change:  [12.60560989]
curr_Stock_Price:  104.83806486454547
curr_Factors:  [104.83806486  -1.37793753  -1.03030881]
mat_Sqrt:  [[ 9.43258874  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051966 -0.01516806 -0.30237002]
Stock Position:  -0.0005196623395164235
Bond Position:  [12.66009028]


portfolio before change:  [12.60710253]
curr_Stock_Price:  105.0111831953292
curr_Factors:  [105.0111832   -1.32111853  -1.01006194]
mat_Sqrt:  [[10.2050876   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0107417  0.00075302 0.39649618]
Stock Position:  0.010741698722464773
Bond Position:  [11.47910404]


portfolio before change:  [12.6084801]
curr_Stock_Price:  105.00583804805608
curr_Factors:  [105.00583805  -1.28560624  -0.98210628]
mat_Sqrt:  [[10.87322585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.004547   -0.02923086 -0.43847297]
Stock Position:  -0.004546998845695814
Bond Position:  [13.08594152]


portfolio before change:  [12.61235244]
curr_Stock_Price:  104.51397524444046
curr_Factors:  [104.51397524  -1.10350132  -0.97016105]
mat_Sqrt:  [[13.13996603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0031899   0.03647098 -0.05283096]
Stock Position:  0.003189896337943859
Bond Position:  [12.27896369]


portfolio before change:  [12.6121303]
curr_Stock_Price:  103.96313942719377
curr_Factors:  [103.96313943  -1.07107566  -0.97833554]
mat_Sqrt:  [[13.39156743  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00543914 0.009431   0.38418455]
Stock Position:  0.005439141858151948
Bond Position:  [12.04666003]


portfolio before change:  [12.61533182]
curr_Stock_Price:  104.27487808558027
curr_Factors:  [104.27487809  -1.27719937  -0.979139  ]
mat_Sqrt:  [[10.92104972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02756689 -0.0662065   0.47979597]
Stock Position:  0.02756689412270808
Bond Position:  [9.74079729]


portfolio before change:  [12.63232007]
curr_Stock_Price:  104.84696222579696
curr_Factors:  [104.84696223  -1.35102177  -1.00792295]
mat_Sqrt:  [[ 9.91012611  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00747709  0.00925395  0.10756169]
Stock Position:  -0.007477094449002909
Bond Position:  [13.41627071]


portfolio before change:  [12.63195509]
curr_Stock_Price:  105.12007923279036
curr_Factors:  [105.12007923  -1.50183828  -1.01514576]
mat_Sqrt:  [[ 8.48346751  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01603608 0.0015992  0.3319115 ]
Stock Position:  0.016036076529087548
Bond Position:  [10.94624146]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.63874082]
Stock Price:  105.45790254583869
PL:  [7.18083827]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 3.18795005e-02 -7.33938092e-02  1.00486399e-02]
 [-1.76005484e-01  6.57088737e-02 -2.00297462e-01]
 [-3.30667099e-02  4.21654805e-02  2.30728570e-02]
 [ 1.31194804e-01  3.06655311e-02  1.54737274e-01]
 [ 1.78013533e-01 -1.85698265e-01 -1.04534100e-01]
 [-1.29460763e-01 -1.75004221e-01  3.01649529e-02]
 [-5.16590391e-02 -1.98645846e-01 -2.81355598e-02]
 [ 6.37109809e-03  6.44648807e-01  1.00183847e-01]
 [ 5.79384516e-01  1.17682872e-01  5.41786156e-01]
 [ 8.09650171e-01  3.77579735e-01  7.69003131e-01]
 [-6.62952513e-02 -2.39735939e-01 -4.65040703e-02]
 [-1.10941975e-01 -2.44540040e-02  8.18092853e-02]
 [ 1.62126617e-02 -9.86721131e-02  1.26534821e-01]
 [ 1.68932135e-03  4.39176799e-02 -5.02673415e-02]
 [ 6.40210657e-01 -1.95475234e-01 -2.90617022e-01]
 [-1.77166287e-01 -9.43410227e-02  1.11732764e-01]
 [ 5.84098315e-02 -1.60565469e-02 -3.37352857e-03]
 [-6.51811290e-02 -6.56347921e-02  1.66833835e-02]
 [ 2.25744532e-01 -2.88770537e-01  1.08214189e-01]
 [ 6.98077220e-02  8.39517943e-03  5.97694281e-01]
 [-2.13462154e-02  3.66143928e-01 -3.47592582e-01]
 [ 1.93956293e-01  1.28248071e-01  9.07935130e-02]
 [-1.58989216e-01  2.32581907e-01 -1.24445947e-01]
 [ 1.20565697e-01 -2.35050280e-01 -3.10151066e-01]
 [-6.92235435e-03 -2.37737541e-02 -6.73109701e-03]
 [ 2.92575430e-02  2.87322015e-02 -7.25061235e-02]
 [ 9.05335905e-02  1.55856990e-03  2.70326644e-01]
 [ 1.69200954e-01 -5.16844617e-02  2.26524836e-01]
 [-1.36170934e-02  5.13226433e-02 -1.48259972e-01]
 [-6.34893431e-02  1.06348819e-02  2.99422562e-02]
 [-4.85028980e-02 -6.82073180e-02 -5.55960398e-02]
 [ 2.67903834e-02 -1.00717913e-01 -1.91571145e-01]
 [ 1.34205545e-01 -1.62716272e-02  2.33681944e-01]
 [-1.04755999e-02 -1.11408665e-01 -2.97977388e-01]
 [ 7.44934998e-02  2.85431340e-01 -1.44046864e-01]
 [-2.80479934e-02 -1.88798399e-02  1.81318509e-02]
 [ 4.83891710e-01 -2.79965915e-01  2.97251079e-01]
 [-1.04652041e-01  4.79317653e-02  4.26322224e-02]
 [ 3.18104393e-01 -3.75047474e-02  5.54704348e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.12486675]
curr_Stock_Price:  99.84003819403272
curr_Factors:  [99.84003819 -1.00355187 -1.00528149]
mat_Sqrt:  [[13.39305011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00141485 -0.02368775  0.02866597]
Stock Position:  0.001414854856102254
Bond Position:  [0.98360759]


portfolio before change:  [1.12514332]
curr_Stock_Price:  99.94860897650784
curr_Factors:  [99.94860898 -0.80014164 -1.03859577]
mat_Sqrt:  [[15.89363535  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0128025   0.02120745 -0.57139291]
Stock Position:  -0.012802499882921781
Bond Position:  [2.40473538]


portfolio before change:  [1.12775383]
curr_Stock_Price:  99.76818341447445
curr_Factors:  [99.76818341 -0.83474836 -1.026903  ]
mat_Sqrt:  [[15.50554913  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00127374  0.01360885  0.06582044]
Stock Position:  -0.0012737368967748902
Bond Position:  [1.25483225]


portfolio before change:  [1.1274195]
curr_Stock_Price:  100.15382116414554
curr_Factors:  [100.15382116  -0.76110136  -1.01571545]
mat_Sqrt:  [[16.94360377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00997663 0.00989726 0.44142237]
Stock Position:  0.009976625720823504
Bond Position:  [0.12822231]


portfolio before change:  [1.14241681]
curr_Stock_Price:  101.65545940419173
curr_Factors:  [101.6554594   -0.82544719  -1.01962551]
mat_Sqrt:  [[16.06296877  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00739403 -0.05993386 -0.29820669]
Stock Position:  0.00739403164371991
Bond Position:  [0.39077312]


portfolio before change:  [1.15034368]
curr_Stock_Price:  102.72091683331638
curr_Factors:  [102.72091683  -1.05953782  -1.01295433]
mat_Sqrt:  [[12.92965645  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01229932 -0.05648237  0.08605221]
Stock Position:  -0.012299317888829538
Bond Position:  [2.41374089]


portfolio before change:  [1.15553784]
curr_Stock_Price:  102.32313691897164
curr_Factors:  [102.32313692  -0.97011358  -1.03227759]
mat_Sqrt:  [[13.8148575   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00709024 -0.06411267 -0.08026292]
Stock Position:  -0.0070902359896785755
Bond Position:  [1.88103303]


portfolio before change:  [1.14868056]
curr_Stock_Price:  103.32344527398182
curr_Factors:  [103.32344527  -0.94982257  -1.03448355]
mat_Sqrt:  [[14.20449111  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01115207 0.20805951 0.28579663]
Stock Position:  0.011152066311250498
Bond Position:  [-0.00358935]


portfolio before change:  [1.16622105]
curr_Stock_Price:  104.89633182501437
curr_Factors:  [104.89633183  -1.00286911  -1.03670476]
mat_Sqrt:  [[13.64534819  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05232538 0.03798198 1.5455651 ]
Stock Position:  0.052325382829781844
Bond Position:  [-4.32251967]


portfolio before change:  [1.15516905]
curr_Stock_Price:  104.69544173289025
curr_Factors:  [104.69544173  -0.8913489   -1.03609987]
mat_Sqrt:  [[15.23517371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06850565 0.12186334 2.19375188]
Stock Position:  0.0685056461146167
Bond Position:  [-6.01705983]


portfolio before change:  [1.1410266]
curr_Stock_Price:  104.49997947300514
curr_Factors:  [104.49997947  -1.11940581  -0.99712309]
mat_Sqrt:  [[12.58691744  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.009909   -0.07737444 -0.13266317]
Stock Position:  -0.009908998690151594
Bond Position:  [2.17651676]


portfolio before change:  [1.13588941]
curr_Stock_Price:  105.04587440730357
curr_Factors:  [105.04587441  -1.22741148  -0.98810115]
mat_Sqrt:  [[11.46024989  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00865901 -0.0078925   0.23337912]
Stock Position:  -0.008659006442150799
Bond Position:  [2.04548231]


portfolio before change:  [1.12932233]
curr_Stock_Price:  105.83381495504787
curr_Factors:  [105.83381496  -1.08942208  -0.99599807]
mat_Sqrt:  [[13.15037043  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00166536 -0.03184629  0.36096862]
Stock Position:  0.0016653609306224594
Bond Position:  [0.95307083]


portfolio before change:  [1.13080188]
curr_Stock_Price:  106.65070151178215
curr_Factors:  [106.65070151  -1.23253231  -1.00145297]
mat_Sqrt:  [[11.42237023  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.44238627e-05  1.41743702e-02 -1.43398734e-01]
Stock Position:  3.44238627386866e-05
Bond Position:  [1.12713055]


portfolio before change:  [1.13093361]
curr_Stock_Price:  106.3843254414963
curr_Factors:  [106.38432544  -1.22309095  -0.99118307]
mat_Sqrt:  [[11.62065633  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04655395 -0.06308936 -0.82904947]
Stock Position:  0.04655395321552522
Bond Position:  [-3.8216773]


portfolio before change:  [1.10332862]
curr_Stock_Price:  105.80161974753592
curr_Factors:  [105.80161975  -1.13966465  -0.98771567]
mat_Sqrt:  [[12.60615912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01377233 -0.03044843  0.31874247]
Stock Position:  -0.013772332318540236
Bond Position:  [2.56046369]


portfolio before change:  [1.09511214]
curr_Stock_Price:  106.42145384239582
curr_Factors:  [106.42145384  -1.25212669  -1.01340048]
mat_Sqrt:  [[11.04391964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00492974 -0.00518223 -0.00962374]
Stock Position:  0.004929742859375445
Bond Position:  [0.57048173]


portfolio before change:  [1.09724466]
curr_Stock_Price:  106.8395697675624
curr_Factors:  [106.83956977  -0.97486957  -1.02336972]
mat_Sqrt:  [[14.48464415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00518986 -0.02118354  0.04759305]
Stock Position:  -0.005189861252780318
Bond Position:  [1.6517272]


portfolio before change:  [1.09824809]
curr_Stock_Price:  106.68601040621336
curr_Factors:  [106.68601041  -0.74564912  -1.0292471 ]
mat_Sqrt:  [[18.08338967  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01044542 -0.09320029  0.30870496]
Stock Position:  0.010445421208511864
Bond Position:  [-0.01613223]


portfolio before change:  [1.1119594]
curr_Stock_Price:  107.99886647965347
curr_Factors:  [107.99886648  -0.84792629  -1.02884931]
mat_Sqrt:  [[16.53278091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01170555 0.00270953 1.70505542]
Stock Position:  0.011705545256364107
Bond Position:  [-0.15222622]


portfolio before change:  [1.1294107]
curr_Stock_Price:  109.49134963905085
curr_Factors:  [109.49134964  -1.3929543   -1.04053643]
mat_Sqrt:  [[ 9.60568215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182803  0.11817244 -0.99158488]
Stock Position:  -0.001828026109749539
Bond Position:  [1.32956375]


portfolio before change:  [1.13005338]
curr_Stock_Price:  109.2307031363591
curr_Factors:  [109.23070314  -1.44168121  -1.01715389]
mat_Sqrt:  [[ 9.34299706  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02554512 0.04139189 0.25900862]
Stock Position:  0.02554511879711764
Bond Position:  [-1.66025791]


portfolio before change:  [1.11253519]
curr_Stock_Price:  108.55305334033017
curr_Factors:  [108.55305334  -1.51452273  -1.01100683]
mat_Sqrt:  [[ 8.68597339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01576289  0.07506549 -0.35500965]
Stock Position:  -0.015762891372968827
Bond Position:  [2.82364518]


portfolio before change:  [1.10921531]
curr_Stock_Price:  108.78606008571312
curr_Factors:  [108.78606009  -1.72047738  -0.99237516]
mat_Sqrt:  [[ 7.21765904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00128531 -0.07586215 -0.88477466]
Stock Position:  0.0012853112794394522
Bond Position:  [0.96939136]


portfolio before change:  [1.10931934]
curr_Stock_Price:  108.77271791341286
curr_Factors:  [108.77271791  -1.6311175   -0.99728568]
mat_Sqrt:  [[ 7.85269956  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00167447 -0.00767295 -0.01920195]
Stock Position:  -0.0016744726969558136
Bond Position:  [1.29145628]


portfolio before change:  [1.10919652]
curr_Stock_Price:  108.9424789394442
curr_Factors:  [108.94247894  -1.49645982  -0.98036476]
mat_Sqrt:  [[ 9.15221067  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00222047  0.00927328 -0.20683979]
Stock Position:  0.002220472113268443
Bond Position:  [0.86729278]


portfolio before change:  [1.11015231]
curr_Stock_Price:  109.32409660115691
curr_Factors:  [109.3240966   -1.43526917  -1.00770536]
mat_Sqrt:  [[ 9.50047987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.53710054e-02 5.03026271e-04 7.71166671e-01]
Stock Position:  0.015371005390930309
Bond Position:  [-0.57026897]


portfolio before change:  [1.10954163]
curr_Stock_Price:  109.28900482227249
curr_Factors:  [109.28900482  -1.50026941  -1.00423825]
mat_Sqrt:  [[ 8.93064069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02294237 -0.01668109  0.64621231]
Stock Position:  0.02294237369470927
Bond Position:  [-1.39780756]


portfolio before change:  [1.11764758]
curr_Stock_Price:  109.64993915499318
curr_Factors:  [109.64993915  -1.49389475  -0.98222965]
mat_Sqrt:  [[ 9.2180961   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00362378  0.01656431 -0.42294443]
Stock Position:  -0.0036237789784209773
Bond Position:  [1.51499472]


portfolio before change:  [1.11963126]
curr_Stock_Price:  109.1547959823791
curr_Factors:  [109.15479598  -1.51755309  -0.97317161]
mat_Sqrt:  [[ 9.04346435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00610458  0.00343239  0.08541692]
Stock Position:  -0.006104581979330338
Bond Position:  [1.78597566]


portfolio before change:  [1.12235317]
curr_Stock_Price:  108.74548780114212
curr_Factors:  [108.7454878   -1.66042942  -0.99206942]
mat_Sqrt:  [[ 7.66382603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00962628 -0.02201382 -0.15860003]
Stock Position:  -0.0096262822627079
Bond Position:  [2.16916793]


portfolio before change:  [1.11958659]
curr_Stock_Price:  109.0610559571198
curr_Factors:  [109.06105596  -1.65546529  -0.97984291]
mat_Sqrt:  [[ 7.8193363   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00420405 -0.03250657 -0.54649915]
Stock Position:  -0.004204048715187652
Bond Position:  [1.57808458]


portfolio before change:  [1.12262119]
curr_Stock_Price:  108.38615158410353
curr_Factors:  [108.38615158  -1.55746741  -0.99807731]
mat_Sqrt:  [[ 8.41617632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02121917 -0.00525165  0.66662954]
Stock Position:  0.021219165678040205
Bond Position:  [-1.17724252]


portfolio before change:  [1.1254183]
curr_Stock_Price:  108.5249071767117
curr_Factors:  [108.52490718  -1.68424087  -0.96987388]
mat_Sqrt:  [[ 7.63593168  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01231561 -0.03595699 -0.85004655]
Stock Position:  -0.012315612817848709
Bond Position:  [2.46196904]


portfolio before change:  [1.12549415]
curr_Stock_Price:  108.54373856345961
curr_Factors:  [108.54373856  -1.57006305  -0.96465635]
mat_Sqrt:  [[ 8.60577771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01200978  0.09212257 -0.41092561]
Stock Position:  0.012009778625223847
Bond Position:  [-0.17809212]


portfolio before change:  [1.11560899]
curr_Stock_Price:  107.72249979436879
curr_Factors:  [107.72249979  -1.53152468  -0.9394447 ]
mat_Sqrt:  [[ 9.10286399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.003098   -0.00609344  0.05172512]
Stock Position:  -0.00309800037213593
Bond Position:  [1.44933333]


portfolio before change:  [1.11790737]
curr_Stock_Price:  107.0390897878735
curr_Factors:  [107.03908979  -1.41527078  -0.94238928]
mat_Sqrt:  [[10.13033142  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04811491 -0.09035861  0.84797459]
Stock Position:  0.04811491447253715
Bond Position:  [-4.03226928]


portfolio before change:  [1.09238175]
curr_Stock_Price:  106.51905231027119
curr_Factors:  [106.51905231  -1.11653386  -0.94488098]
mat_Sqrt:  [[13.55708147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00635577  0.01546991  0.12161786]
Stock Position:  -0.006355773877256869
Bond Position:  [1.76939276]


portfolio before change:  [1.09099187]
curr_Stock_Price:  106.77253252166103
curr_Factors:  [106.77253252  -0.96468724  -0.92072953]
mat_Sqrt:  [[16.20441814  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01985703 -0.01210461  0.15824171]
Stock Position:  0.019857030380289704
Bond Position:  [-1.02919355]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.07955971]
Stock Price:  106.20328773841764
PL:  [-5.12372803]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.42438165e-01 -1.08196387e-01  2.07584589e-02]
 [-4.65736939e-02  5.70359792e-02 -5.26170143e-02]
 [-5.82127974e-03  1.72028311e-02  4.23730656e-02]
 [-1.39679906e-01 -6.51492555e-02 -5.53347272e-02]
 [ 1.21445240e-01 -9.58280808e-02 -9.13918020e-02]
 [-1.30210753e-01 -1.60014895e-01  1.19274270e-01]
 [-5.27058395e-02 -1.53535718e-01 -2.70412846e-02]
 [ 1.42788309e-02  6.36907845e-01  8.59651640e-02]
 [ 1.85680360e-01 -6.70231389e-03  1.96025966e-01]
 [ 3.88415848e-01  1.47639159e-01  2.38177408e-01]
 [-1.69498885e-01 -2.10100090e-01  2.78131352e-02]
 [ 2.76690777e-02 -1.38127640e-02  1.11150341e-01]
 [ 1.18698012e-02 -6.00621621e-02  9.81015713e-02]
 [ 8.09804262e-03 -4.53765759e-02 -5.38390810e-02]
 [ 1.67833000e-01 -1.58386846e-01 -1.23343342e-01]
 [-1.59572869e-01 -7.74868172e-02  1.06190021e-01]
 [ 4.49968957e-02  2.85257604e-02  9.90454286e-03]
 [-2.98589174e-02 -4.45709205e-02  6.72206990e-02]
 [ 9.81209333e-02 -7.32774016e-02 -6.12227029e-02]
 [ 4.25151260e-02 -1.18423117e-02  1.87467866e-01]
 [-2.34271734e-02  4.05519400e-01 -3.86101705e-01]
 [ 1.33700838e-01  9.94160395e-02  1.00605689e-01]
 [-2.30879581e-03  7.09598776e-02  6.73398001e-03]
 [ 7.33815942e-03 -1.32330692e-01 -1.44399037e-01]
 [ 5.46295158e-02  2.68246327e-02 -1.40339753e-02]
 [-4.97784050e-02 -5.81667739e-03  1.63088472e-01]
 [-1.20420992e-02 -3.23941258e-02  2.44648522e-03]
 [-4.10102106e-02  9.66354495e-03 -2.86684777e-01]
 [-5.41844601e-02 -3.41077418e-02  1.25644039e-03]
 [-6.53800126e-02 -8.30857489e-03  3.05906400e-02]
 [-4.34546013e-02 -5.96901549e-02 -3.79311262e-02]
 [ 2.61842508e-02 -3.04168194e-02 -7.95822333e-02]
 [ 1.31181190e-02  5.74246473e-03  1.57025288e-01]
 [ 3.56006036e-03 -8.45655578e-02 -1.12145578e-01]
 [-2.15294581e-02  7.80792340e-02  4.47984940e-02]
 [ 8.22782091e-02  1.67115606e-02  1.72501303e-01]
 [-3.52145179e-02  2.77430810e-02 -5.46625859e-02]
 [-7.38006839e-02 -7.86075222e-04  4.66088400e-02]
 [ 9.39365875e-02  6.78328511e-03  9.79293563e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.35753382]
curr_Stock_Price:  100.62580577065403
curr_Factors:  [100.62580577  -0.89528363  -1.01090805]
mat_Sqrt:  [[14.95756317  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01740166 -0.03492023  0.05921811]
Stock Position:  -0.017401655230708125
Bond Position:  [9.1085894]


portfolio before change:  [7.34620356]
curr_Stock_Price:  101.34234126958722
curr_Factors:  [101.34234127  -0.90149656  -1.00205312]
mat_Sqrt:  [[15.10392465  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302383  0.01840828 -0.1501017 ]
Stock Position:  -0.0030238284098218515
Bond Position:  [7.65264541]


portfolio before change:  [7.35020749]
curr_Stock_Price:  100.33458364836221
curr_Factors:  [100.33458365  -0.83895769  -1.01366644]
mat_Sqrt:  [[15.73498068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0004029  0.00555219 0.12087856]
Stock Position:  0.000402898445568219
Bond Position:  [7.30978284]


portfolio before change:  [7.35151415]
curr_Stock_Price:  101.30971765280836
curr_Factors:  [101.30971765  -0.95820851  -1.01309377]
mat_Sqrt:  [[14.10994762  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0116424  -0.02102683 -0.15785457]
Stock Position:  -0.011642395889232113
Bond Position:  [8.53100199]


portfolio before change:  [7.35864593]
curr_Stock_Price:  100.7887478809558
curr_Factors:  [100.78874788  -1.11561209  -1.0442086 ]
mat_Sqrt:  [[11.62555899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00715915 -0.03092838 -0.26071537]
Stock Position:  0.0071591517981384545
Bond Position:  [6.63708398]


portfolio before change:  [7.35554283]
curr_Stock_Price:  100.23941157980255
curr_Factors:  [100.23941158  -1.1738547   -1.02308529]
mat_Sqrt:  [[11.14088254  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0124341  -0.05164459  0.34025629]
Stock Position:  -0.012434104515574527
Bond Position:  [8.60193015]


portfolio before change:  [7.34530941]
curr_Stock_Price:  101.14890474472489
curr_Factors:  [101.14890474  -1.0245698   -1.00316869]
mat_Sqrt:  [[13.3145211   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00672694 -0.04955344 -0.07714126]
Stock Position:  -0.00672693858991265
Bond Position:  [8.02573188]


portfolio before change:  [7.3471966]
curr_Stock_Price:  101.01750561266321
curr_Factors:  [101.01750561  -1.06749836  -1.01868584]
mat_Sqrt:  [[12.54233375  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01290307 0.20556112 0.24523468]
Stock Position:  0.012903074441803377
Bond Position:  [6.04376021]


portfolio before change:  [7.34217023]
curr_Stock_Price:  100.56940393475341
curr_Factors:  [100.56940393  -1.22350982  -1.01565459]
mat_Sqrt:  [[10.71541831  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02093487 -0.00216316  0.55920752]
Stock Position:  0.02093486992252264
Bond Position:  [5.23676284]


portfolio before change:  [7.33864863]
curr_Stock_Price:  100.36991698861522
curr_Factors:  [100.36991699  -1.16080384  -1.009802  ]
mat_Sqrt:  [[11.45305717  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04079001 0.04765033 0.67945385]
Stock Position:  0.04079001069624032
Bond Position:  [3.24455864]


portfolio before change:  [7.32994961]
curr_Stock_Price:  100.14670993994385
curr_Factors:  [100.14670994  -1.22475849  -0.98855098]
mat_Sqrt:  [[10.94986083  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01887769 -0.06780951  0.07934313]
Stock Position:  -0.018877687801915056
Bond Position:  [9.22048793]


portfolio before change:  [7.33130785]
curr_Stock_Price:  100.13581819549269
curr_Factors:  [100.1358182   -1.31307841  -1.02142177]
mat_Sqrt:  [[ 9.69904348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00490131 -0.00445805  0.31708099]
Stock Position:  0.0049013108887417944
Bond Position:  [6.84051108]


portfolio before change:  [7.33197529]
curr_Stock_Price:  100.09752548384482
curr_Factors:  [100.09752548  -1.11967701  -1.05600257]
mat_Sqrt:  [[11.36416959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00172776 -0.01938498  0.27985648]
Stock Position:  0.0017277604748475533
Bond Position:  [7.15903074]


portfolio before change:  [7.33451882]
curr_Stock_Price:  101.05170883464764
curr_Factors:  [101.05170883  -1.33811106  -1.07607713]
mat_Sqrt:  [[ 9.03805652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00134479 -0.01464523 -0.15358791]
Stock Position:  -0.0013447878452541371
Bond Position:  [7.47041193]


portfolio before change:  [7.33461588]
curr_Stock_Price:  101.67396251168488
curr_Factors:  [101.67396251  -1.24218369  -1.10591545]
mat_Sqrt:  [[ 9.71501     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01135615 -0.05111913 -0.35186422]
Stock Position:  0.011356145380666755
Bond Position:  [6.17999158]


portfolio before change:  [7.34438343]
curr_Stock_Price:  102.46604474871937
curr_Factors:  [102.46604475  -1.38172986  -1.12395499]
mat_Sqrt:  [[ 8.36324596  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01837969 -0.02500876  0.30293057]
Stock Position:  -0.018379688126952745
Bond Position:  [9.22767738]


portfolio before change:  [7.35746701]
curr_Stock_Price:  101.81695631124153
curr_Factors:  [101.81695631  -1.61479798  -1.08770825]
mat_Sqrt:  [[ 6.82553292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00774173 0.00920665 0.0282549 ]
Stock Position:  0.007741732276184651
Bond Position:  [6.56922739]


portfolio before change:  [7.35892115]
curr_Stock_Price:  101.89871310590581
curr_Factors:  [101.89871311  -1.57812741  -1.11251522]
mat_Sqrt:  [[ 6.9125367   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365069 -0.0143852   0.19176194]
Stock Position:  -0.003650693194970522
Bond Position:  [7.73092209]


portfolio before change:  [7.35957929]
curr_Stock_Price:  101.98315756936823
curr_Factors:  [101.98315757  -1.576864    -1.09864327]
mat_Sqrt:  [[ 7.02377208  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01006101 -0.02365018 -0.17465133]
Stock Position:  0.010061006195647886
Bond Position:  [6.33352611]


portfolio before change:  [7.36840462]
curr_Stock_Price:  102.78164507381683
curr_Factors:  [102.78164507  -1.23011497  -1.11622751]
mat_Sqrt:  [[ 9.8381168   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0079654  -0.00382209  0.53479364]
Stock Position:  0.007965400666779093
Bond Position:  [6.54970764]


portfolio before change:  [7.36929529]
curr_Stock_Price:  102.79067236757278
curr_Factors:  [102.79067237  -1.33610225  -1.11538848]
mat_Sqrt:  [[ 8.85696259  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00219754  0.13088082 -1.1014407 ]
Stock Position:  -0.00219754265578473
Bond Position:  [7.59518218]


portfolio before change:  [7.37240207]
curr_Stock_Price:  101.8089769632363
curr_Factors:  [101.80897696  -1.12581143  -1.08920723]
mat_Sqrt:  [[11.1126002   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0157056  0.03208639 0.28700003]
Stock Position:  0.015705604422415753
Bond Position:  [5.77343055]


portfolio before change:  [7.3720341]
curr_Stock_Price:  101.73959453059561
curr_Factors:  [101.73959453  -1.03961123  -1.07272202]
mat_Sqrt:  [[12.30595516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00110113 0.0229022  0.01921017]
Stock Position:  0.0011011251282945541
Bond Position:  [7.26000607]


portfolio before change:  [7.37248784]
curr_Stock_Price:  101.32746046324246
curr_Factors:  [101.32746046  -0.9706612   -1.0705371 ]
mat_Sqrt:  [[13.15970027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00373482 -0.04270955 -0.41193026]
Stock Position:  -0.0037348160683256674
Bond Position:  [7.75092727]


portfolio before change:  [7.37351346]
curr_Stock_Price:  101.3122806204322
curr_Factors:  [101.31228062  -0.89232003  -1.09159709]
mat_Sqrt:  [[13.9334234   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00410814  0.00865761 -0.04003503]
Stock Position:  0.004108135969790868
Bond Position:  [6.95730884]


portfolio before change:  [7.3709005]
curr_Stock_Price:  100.46452770718486
curr_Factors:  [100.46452771  -0.72749105  -1.10321462]
mat_Sqrt:  [[16.10450493  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109755 -0.00187732  0.46524601]
Stock Position:  -0.0010975459662350224
Bond Position:  [7.48116494]


portfolio before change:  [7.37265607]
curr_Stock_Price:  99.71707345859464
curr_Factors:  [99.71707346 -0.77509669 -1.10286602]
mat_Sqrt:  [[15.24686954  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00119075 -0.01045516  0.00697914]
Stock Position:  -0.00119074513447066
Bond Position:  [7.49139369]


portfolio before change:  [7.37385348]
curr_Stock_Price:  99.4979458551415
curr_Factors:  [99.49794586 -0.76130112 -1.06954214]
mat_Sqrt:  [[15.94736711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00611743  0.0031189  -0.81783187]
Stock Position:  -0.006117431934568863
Bond Position:  [7.98252539]


portfolio before change:  [7.36220077]
curr_Stock_Price:  101.56590197890974
curr_Factors:  [101.56590198  -0.83862496  -1.1005965 ]
mat_Sqrt:  [[14.60678885  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00416862 -0.01100823  0.00358427]
Stock Position:  -0.004168623544663709
Bond Position:  [7.78559078]


portfolio before change:  [7.36307083]
curr_Stock_Price:  101.59065923112729
curr_Factors:  [101.59065923  -0.90455449  -1.11405178]
mat_Sqrt:  [[13.49535192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0045076  -0.00268158  0.08726658]
Stock Position:  -0.004507604208622626
Bond Position:  [7.82100131]


portfolio before change:  [7.36198556]
curr_Stock_Price:  102.04832067536648
curr_Factors:  [102.04832068  -0.74505592  -1.1288766 ]
mat_Sqrt:  [[15.66633146  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00404571 -0.01926491 -0.10820695]
Stock Position:  -0.004045711789579752
Bond Position:  [7.77484365]


portfolio before change:  [7.36231525]
curr_Stock_Price:  102.20706352065079
curr_Factors:  [102.20706352  -0.55317365  -1.1512795 ]
mat_Sqrt:  [[18.58858411  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.00703194e-04 -9.81698626e-03 -2.27025960e-01]
Stock Position:  0.00020070319441728207
Bond Position:  [7.34180196]


portfolio before change:  [7.36354297]
curr_Stock_Price:  103.75133706129655
curr_Factors:  [103.75133706  -0.53918834  -1.17477989]
mat_Sqrt:  [[18.69075111  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00247946 0.00185337 0.44794944]
Stock Position:  0.0024794588006967207
Bond Position:  [7.1062958]


portfolio before change:  [7.36407922]
curr_Stock_Price:  103.60933456809208
curr_Factors:  [103.60933457  -0.65765018  -1.1752457 ]
mat_Sqrt:  [[16.57228212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00220811 -0.02729342 -0.31992012]
Stock Position:  -0.002208110621140976
Bond Position:  [7.5928601]


portfolio before change:  [7.3685304]
curr_Stock_Price:  102.02336044688735
curr_Factors:  [102.02336045  -0.45519797  -1.16521977]
mat_Sqrt:  [[20.18185778  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00017604 0.02519996 0.12779763]
Stock Position:  0.00017604192699445726
Bond Position:  [7.35057001]


portfolio before change:  [7.36937004]
curr_Stock_Price:  101.57327670927852
curr_Factors:  [101.57327671  -0.43726886  -1.11847588]
mat_Sqrt:  [[21.43522806  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0056403  0.00539363 0.4920982 ]
Stock Position:  0.005640300298019579
Bond Position:  [6.79646626]


portfolio before change:  [7.3688062]
curr_Stock_Price:  101.32267710048984
curr_Factors:  [101.3226771   -0.42528931  -1.10641723]
mat_Sqrt:  [[21.90256407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185866  0.00895404 -0.15593714]
Stock Position:  -0.0018586608706411402
Bond Position:  [7.55713069]


portfolio before change:  [7.37039987]
curr_Stock_Price:  100.97351620748609
curr_Factors:  [100.97351621  -0.1258045   -1.13212608]
mat_Sqrt:  [[28.70087724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224548 -0.0002537   0.13296205]
Stock Position:  -0.002245476704861596
Bond Position:  [7.59713355]


portfolio before change:  [7.36983696]
curr_Stock_Price:  101.64714090826035
curr_Factors:  [101.64714091  -0.23713874  -1.14947348]
mat_Sqrt:  [[25.40370926  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00453914 0.0021893  0.2793652 ]
Stock Position:  0.004539138939364186
Bond Position:  [6.90844647]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.3752958]
Stock Price:  102.65949809284268
PL:  [4.71579771]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.84833324e-01 -9.99678155e-02  2.67297358e-02]
 [-3.44002971e-02  4.12012873e-02 -2.00825291e-02]
 [-1.95924991e-01 -4.11736607e-02 -1.34834058e-01]
 [-7.52711276e-01 -3.16231104e-01 -5.03509736e-01]
 [ 2.33252363e-01 -2.39138553e-01 -1.05305506e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.22046681e-02 -1.75132871e-01 -2.75651853e-02]
 [ 1.05623824e-02  6.52894933e-01  9.89019463e-02]
 [ 2.57419818e-01 -1.60042880e-02  2.75796099e-01]
 [ 5.16033465e-01  2.32056192e-01  4.46611696e-01]
 [-1.23046111e-01 -1.90112466e-01  1.81122844e-02]
 [-8.11926510e-03 -1.58481913e-02  1.02315944e-01]
 [ 1.43889166e-02 -4.20925613e-02  3.89433594e-02]
 [ 2.61780710e-04  1.32288835e-01 -2.70305229e-02]
 [ 2.20157791e-01 -1.78387563e-01 -1.39826688e-01]
 [-1.42222395e-01 -7.25805177e-02  1.02186070e-01]
 [ 5.04347117e-02  1.87662286e-02 -2.18999681e-02]
 [-3.90711336e-02 -5.01901956e-02  5.38594743e-02]
 [ 8.10962127e-02 -4.88118850e-02 -8.40383895e-02]
 [ 1.74935914e-02  7.38311480e-03  3.19730800e-02]
 [-3.67811357e-02  4.91577496e-01 -4.58519734e-01]
 [ 3.50428013e-01  2.03119261e-01  6.53131963e-02]
 [-8.51276427e-03  2.36055511e-03  4.78723343e-02]
 [-3.91415978e-02 -8.94825267e-02 -5.53100912e-02]
 [ 3.61971382e-02  1.62194793e-02 -1.22804892e-02]
 [-4.90357707e-02 -4.01008932e-05  1.40213560e-01]
 [ 7.23906000e-02 -3.13825251e-02  2.71684092e-02]
 [ 1.53455601e-01 -6.48664107e-02  1.30169465e-01]
 [-4.32834100e-02 -4.29145434e-02  2.96379254e-02]
 [-6.34675084e-02 -1.40924051e-02  3.83061964e-02]
 [-3.14274790e-02 -5.38447989e-02 -3.05811973e-02]
 [ 2.62566315e-02 -3.88117505e-02 -9.29552713e-02]
 [-4.27311929e-02  1.46451187e-02  6.63102291e-02]
 [ 1.09048008e-02 -7.05187903e-02 -1.49013888e-02]
 [-3.49865964e-02  9.18619097e-02  2.67556982e-02]
 [ 8.54082564e-02 -2.26650742e-02  1.34863332e-01]
 [-6.20317185e-02  3.31695999e-02 -6.17070762e-02]
 [-7.00834634e-02  7.34122363e-03  4.25229686e-02]
 [ 1.36979635e-01 -1.19240848e-03  9.69494661e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.65514161]
curr_Stock_Price:  101.16761569212807
curr_Factors:  [101.16761569  -1.14277675  -1.00138436]
mat_Sqrt:  [[11.85343373  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02529081 -0.03226447  0.0762525 ]
Stock Position:  -0.025290813715892663
Bond Position:  [14.21375293]


portfolio before change:  [11.64453694]
curr_Stock_Price:  101.65718082552597
curr_Factors:  [101.65718083  -0.88976104  -1.02043886]
mat_Sqrt:  [[15.05042573  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199924  0.01329766 -0.05728987]
Stock Position:  -0.0019992423619830447
Bond Position:  [11.84777428]


portfolio before change:  [11.64450352]
curr_Stock_Price:  102.4147082168564
curr_Factors:  [102.41470822  -0.96304907  -1.01339062]
mat_Sqrt:  [[14.19075428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01633827 -0.01328874 -0.38464404]
Stock Position:  -0.01633827289029672
Bond Position:  [13.31778297]


portfolio before change:  [11.63524753]
curr_Stock_Price:  103.0831274263638
curr_Factors:  [103.08312743  -1.0249727   -1.0376621 ]
mat_Sqrt:  [[13.10378241  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0702118  -0.10206315 -1.43637313]
Stock Position:  -0.07021180187103616
Bond Position:  [18.87289965]


portfolio before change:  [11.68038324]
curr_Stock_Price:  102.47387869657695
curr_Factors:  [102.4738787   -1.20564668  -1.03907598]
mat_Sqrt:  [[10.85781681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01500698 -0.07718164 -0.3004073 ]
Stock Position:  0.015006977561792418
Bond Position:  [10.14256004]


portfolio before change:  [11.67553044]
curr_Stock_Price:  102.06602162255105
curr_Factors:  [102.06602162  -1.2335704   -1.02475255]
mat_Sqrt:  [[10.66851539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01436978 -0.05534923  0.15513819]
Stock Position:  -0.014369777856134218
Bond Position:  [13.1421965]


portfolio before change:  [11.68386672]
curr_Stock_Price:  101.60022414913911
curr_Factors:  [101.60022415  -1.31004742  -1.0001409 ]
mat_Sqrt:  [[10.08306638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00928093 -0.05652389 -0.0786358 ]
Stock Position:  -0.009280930235015736
Bond Position:  [12.62681132]


portfolio before change:  [11.68606078]
curr_Stock_Price:  101.53389406860903
curr_Factors:  [101.53389407  -1.30516109  -0.99556994]
mat_Sqrt:  [[10.17223194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01612451 0.21072093 0.28213972]
Stock Position:  0.01612451218671514
Bond Position:  [10.04887627]


portfolio before change:  [11.68272546]
curr_Stock_Price:  101.24914089621062
curr_Factors:  [101.2491409   -1.14208135  -1.00066676]
mat_Sqrt:  [[11.87976009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02613265 -0.00516536  0.7867695 ]
Stock Position:  0.026132648867188326
Bond Position:  [9.03681721]


portfolio before change:  [11.72394433]
curr_Stock_Price:  102.78320649328474
curr_Factors:  [102.78320649  -1.68198802  -1.03067151]
mat_Sqrt:  [[ 6.8207023   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.09596753 0.07489581 1.27405886]
Stock Position:  0.09596753215690457
Bond Position:  [1.86009366]


portfolio before change:  [11.71423711]
curr_Stock_Price:  102.67963246910391
curr_Factors:  [102.67963247  -1.58310656  -1.01377753]
mat_Sqrt:  [[ 7.6501839   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02067342 -0.06135853  0.05166931]
Stock Position:  -0.02067342467402458
Bond Position:  [13.83697676]


portfolio before change:  [11.7205471]
curr_Stock_Price:  102.4580794178927
curr_Factors:  [102.45807942  -1.64654585  -1.00847829]
mat_Sqrt:  [[ 7.20251012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00132327 -0.00511498  0.29187891]
Stock Position:  0.001323273526971739
Bond Position:  [11.58496704]


portfolio before change:  [11.7217509]
curr_Stock_Price:  102.27337570525017
curr_Factors:  [102.27337571  -1.35642533  -1.02197709]
mat_Sqrt:  [[ 9.48059395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144992 -0.01358532  0.11109456]
Stock Position:  0.0014499184872667588
Bond Position:  [11.57346284]


portfolio before change:  [11.7234105]
curr_Stock_Price:  102.42015827782578
curr_Factors:  [102.42015828  -1.33979556  -1.01740602]
mat_Sqrt:  [[ 9.69763434  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00224256  0.04269604 -0.07711056]
Stock Position:  0.0022425617417203493
Bond Position:  [11.49372697]


portfolio before change:  [11.72454551]
curr_Stock_Price:  102.28558222637302
curr_Factors:  [102.28558223  -1.37073772  -1.00536882]
mat_Sqrt:  [[ 9.50351935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01633106 -0.05757434 -0.39888662]
Stock Position:  0.01633106363107141
Bond Position:  [10.05411316]


portfolio before change:  [11.72591389]
curr_Stock_Price:  102.29241205115834
curr_Factors:  [102.29241205  -1.42490992  -1.01142692]
mat_Sqrt:  [[ 8.94861399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01521791 -0.02342526  0.29150842]
Stock Position:  -0.01521790823521184
Bond Position:  [13.28259043]


portfolio before change:  [11.72351656]
curr_Stock_Price:  102.55905572889378
curr_Factors:  [102.55905573  -1.16646127  -1.02952111]
mat_Sqrt:  [[11.40961481  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00436431  0.00605677 -0.06247451]
Stock Position:  0.00436430507148646
Bond Position:  [11.27591755]


portfolio before change:  [11.72176631]
curr_Stock_Price:  101.83503990539226
curr_Factors:  [101.83503991  -1.15854621  -1.0000903 ]
mat_Sqrt:  [[11.7601623   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325864 -0.01619882  0.15364609]
Stock Position:  -0.0032586408471257764
Bond Position:  [12.05361013]


portfolio before change:  [11.72518038]
curr_Stock_Price:  101.24974329148674
curr_Factors:  [101.24974329  -0.78747609  -1.02312605]
mat_Sqrt:  [[16.55996496  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00325956 -0.01575397 -0.23973813]
Stock Position:  0.0032595638978357637
Bond Position:  [11.39515037]


portfolio before change:  [11.72659587]
curr_Stock_Price:  101.24698592436562
curr_Factors:  [101.24698592  -0.88960405  -1.02397499]
mat_Sqrt:  [[14.93912932  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00170874 0.00238289 0.0912103 ]
Stock Position:  0.0017087435579853432
Bond Position:  [11.55359074]


portfolio before change:  [11.72454161]
curr_Stock_Price:  99.19954414876507
curr_Factors:  [99.19954415 -0.71558712 -1.00208549]
mat_Sqrt:  [[17.80467055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168682  0.15865595 -1.30802917]
Stock Position:  -0.0016868185385343697
Bond Position:  [11.89187324]


portfolio before change:  [11.72513716]
curr_Stock_Price:  99.72776954445546
curr_Factors:  [99.72776954 -0.74585487 -0.99301306]
mat_Sqrt:  [[17.52408522  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02312369 0.06555646 0.18632037]
Stock Position:  0.023123692535199587
Bond Position:  [9.41906288]


portfolio before change:  [11.73512799]
curr_Stock_Price:  100.10890965794994
curr_Factors:  [100.10890966  -0.62213911  -0.98341488]
mat_Sqrt:  [[20.09969615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [8.66172967e-05 7.61865885e-04 1.36566445e-01]
Stock Position:  8.6617296748036e-05
Bond Position:  [11.72645682]


portfolio before change:  [11.73656169]
curr_Stock_Price:  99.73721713475845
curr_Factors:  [99.73721713 -0.44920669 -0.97556471]
mat_Sqrt:  [[23.99312906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286321 -0.02888036 -0.15778429]
Stock Position:  -0.0028632058359517026
Bond Position:  [12.02212987]


portfolio before change:  [11.73553947]
curr_Stock_Price:  100.6191229410643
curr_Factors:  [100.61912294  -0.5203162   -0.9814517 ]
mat_Sqrt:  [[22.4115047   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00165099  0.00523481 -0.03503282]
Stock Position:  0.0016509904932094947
Bond Position:  [11.56941826]


portfolio before change:  [11.7389577]
curr_Stock_Price:  101.81353537540235
curr_Factors:  [101.81353538  -0.49027519  -0.98038105]
mat_Sqrt:  [[23.39416936  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.72994587e-04 -1.29425076e-05  3.99990258e-01]
Stock Position:  -0.0008729945867445643
Bond Position:  [11.82784037]


portfolio before change:  [11.73940314]
curr_Stock_Price:  102.99697172544926
curr_Factors:  [102.99697173  -0.48914348  -0.97358728]
mat_Sqrt:  [[23.85440332  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00299862 -0.01012867  0.07750391]
Stock Position:  0.0029986244570571266
Bond Position:  [11.43055391]


portfolio before change:  [11.74179475]
curr_Stock_Price:  103.31801699479115
curr_Factors:  [103.31801699  -0.1938266   -0.99304065]
mat_Sqrt:  [[31.53015925  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00528971 -0.02093554  0.37133725]
Stock Position:  0.005289714213382532
Bond Position:  [11.19527196]


portfolio before change:  [11.7329836]
curr_Stock_Price:  101.38773472103193
curr_Factors:  [101.38773472  -0.35178163  -0.96856651]
mat_Sqrt:  [[27.07481568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00169876 -0.01385061  0.08454875]
Stock Position:  -0.001698755360195773
Bond Position:  [11.90521656]


portfolio before change:  [11.73049994]
curr_Stock_Price:  103.7258620116136
curr_Factors:  [103.72586201  -0.64687524  -0.96191301]
mat_Sqrt:  [[20.75865426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0028193  -0.0045483   0.10927692]
Stock Position:  -0.0028193007225736553
Bond Position:  [12.02293434]


portfolio before change:  [11.73721151]
curr_Stock_Price:  101.8783778892139
curr_Factors:  [101.87837789  -0.53211601  -0.93911727]
mat_Sqrt:  [[23.39556439  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207992 -0.01737833 -0.08723964]
Stock Position:  -0.0020799183354690796
Bond Position:  [11.94911022]


portfolio before change:  [11.7368854]
curr_Stock_Price:  102.75333876377687
curr_Factors:  [102.75333876  -0.59511529  -0.91736637]
mat_Sqrt:  [[22.64297587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.82736330e-05 -1.25264386e-02 -2.65175515e-01]
Stock Position:  -2.8273633038148917e-05
Bond Position:  [11.73979061]


portfolio before change:  [11.73835465]
curr_Stock_Price:  102.69363543752239
curr_Factors:  [102.69363544  -0.2604211   -0.95459972]
mat_Sqrt:  [[30.46959547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00086008  0.00472669  0.18916463]
Stock Position:  -0.0008600787530327135
Bond Position:  [11.82667927]


portfolio before change:  [11.74101774]
curr_Stock_Price:  101.31624865640265
curr_Factors:  [101.31624866  -0.18782294  -0.94440441]
mat_Sqrt:  [[32.65570103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00020001 -0.02275984 -0.04250951]
Stock Position:  -0.00020001163922049947
Bond Position:  [11.76128217]


portfolio before change:  [11.7424747]
curr_Stock_Price:  101.38270049540976
curr_Factors:  [101.3827005   -0.18202785  -0.93722191]
mat_Sqrt:  [[33.10395328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00032546  0.0296483   0.07632656]
Stock Position:  -0.00032545594981211697
Bond Position:  [11.77547031]


portfolio before change:  [11.74441468]
curr_Stock_Price:  99.94485587931638
curr_Factors:  [99.94485588 -0.18825419 -0.92552721]
mat_Sqrt:  [[32.81340757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0033008  -0.00731512  0.38472755]
Stock Position:  0.0033008040881054783
Bond Position:  [11.41451629]


portfolio before change:  [11.75169446]
curr_Stock_Price:  101.71802284389243
curr_Factors:  [ 1.01718023e+02 -6.11677135e-02 -9.32391885e-01]
mat_Sqrt:  [[37.66174676  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180175  0.01070544 -0.17603311]
Stock Position:  -0.0018017461292628226
Bond Position:  [11.93496452]


portfolio before change:  [11.7523416]
curr_Stock_Price:  102.18691576863209
curr_Factors:  [102.18691577  -0.20375779  -0.90875917]
mat_Sqrt:  [[33.59195755  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00178331  0.00236937  0.12130619]
Stock Position:  -0.0017833130949277652
Bond Position:  [11.93457287]


portfolio before change:  [11.75484884]
curr_Stock_Price:  101.6175668168021
curr_Factors:  [ 1.01617567e+02  8.62182997e-02 -8.82887892e-01]
mat_Sqrt:  [[45.81203499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0034167  -0.00038485  0.27656984]
Stock Position:  0.0034166996278539004
Bond Position:  [11.40765214]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.7567173]
Stock Price:  101.74705214046121
PL:  [10.00966516]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-9.14085396e-02 -8.90353158e-02  1.48620105e-02]
 [-1.58884094e-01  7.01134569e-02 -1.66467649e-01]
 [-3.69905242e-02  4.42911067e-02  2.02780100e-02]
 [ 1.03337959e-01  5.35626314e-02  1.11680363e-01]
 [ 1.10484751e-02  8.31754219e-02 -6.34594484e-02]
 [-7.42644447e-02 -1.53508166e-01  1.48001010e-01]
 [-6.17958302e-02 -1.67472742e-01  7.65100295e-02]
 [-1.72072577e-02  8.00882093e-01  1.47880233e-01]
 [ 1.45006790e-01 -1.37221153e-02  1.25497356e-01]
 [ 2.19387370e-01  7.68962369e-02  9.46404192e-02]
 [-1.89996486e-01 -2.68544798e-01 -6.33824054e-03]
 [-2.76358666e-02 -1.76672572e-02  9.35866066e-02]
 [ 4.47082088e-03 -3.93428525e-02  1.34110283e-01]
 [ 1.02201345e-02 -1.30881530e-01  4.95871233e-02]
 [-5.42202205e-02  1.25993852e-01 -3.64988834e-02]
 [ 4.46632246e-02 -1.96756786e-02  3.79247552e-02]
 [ 5.05259574e-02  1.86024650e-02 -2.24336432e-02]
 [-6.24936049e-02 -6.40450667e-02  2.05099502e-02]
 [ 4.83589278e-02  9.07145007e-03 -1.72700825e-01]
 [-2.69833980e-02  1.59977168e-02 -5.10142352e-02]
 [-4.22012941e-02  5.33467241e-01 -5.04091859e-01]
 [ 5.25579340e-01  2.86928581e-01  3.67910370e-02]
 [ 1.59290904e-02  5.20219411e-02  1.87249875e-02]
 [-5.67727088e-02 -1.24240858e-01 -2.61327473e-02]
 [-7.78106462e-03 -4.85630807e-02 -6.71611143e-03]
 [-3.78651722e-02  9.85749164e-03  7.31663513e-02]
 [ 8.05545893e-02 -1.01284975e-02  1.88336023e-01]
 [ 1.69200954e-01 -5.16844617e-02  2.26524836e-01]
 [-2.37037906e-02  2.42145862e-02 -9.86747855e-02]
 [-9.19502696e-02  1.06957332e-01 -1.54310989e-01]
 [ 2.77197556e-01  8.24857514e-02  1.15126142e-01]
 [ 2.76607484e-02 -2.01665485e-01 -3.52379580e-01]
 [-5.67420057e-03  9.31540717e-04  1.63918066e-01]
 [-4.58079889e-02 -1.78981626e-01 -7.65777384e-01]
 [ 2.40624062e-01  9.86834882e-01 -5.11011536e-01]
 [ 6.36896956e-02  2.00584238e-01  9.25101526e-02]
 [ 9.29639674e-01 -4.53645968e-01  8.33183762e-01]
 [-2.84003764e-01  1.47584728e-01  8.08423989e-02]
 [ 7.64757022e-01 -1.29199825e-01 -7.60017778e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.63849931]
curr_Stock_Price:  100.15693799688891
curr_Factors:  [100.156938    -0.99919459  -0.99486163]
mat_Sqrt:  [[13.6355741   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00781405 -0.02873602  0.04239718]
Stock Position:  -0.007814053247435053
Bond Position:  [4.42113096]


portfolio before change:  [3.64247725]
curr_Stock_Price:  99.7185918614075
curr_Factors:  [99.71859186 -0.84370619 -0.97122237]
mat_Sqrt:  [[16.23912692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01099519  0.02262902 -0.47488587]
Stock Position:  -0.01099519156479928
Bond Position:  [4.73890227]


portfolio before change:  [3.64150064]
curr_Stock_Price:  99.86129183516611
curr_Factors:  [99.86129184 -0.91290909 -0.95623524]
mat_Sqrt:  [[15.40416321  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154571  0.01429489  0.05784752]
Stock Position:  -0.0015457125510484802
Bond Position:  [3.79585749]


portfolio before change:  [3.64238915]
curr_Stock_Price:  99.59345308355049
curr_Factors:  [99.59345308 -1.19951953 -0.96252225]
mat_Sqrt:  [[11.46219984  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01195827 0.01728726 0.31859299]
Stock Position:  0.011958266841130187
Bond Position:  [2.45142406]


portfolio before change:  [3.64039042]
curr_Stock_Price:  99.4006842754017
curr_Factors:  [99.40068428 -1.25054834 -0.97064688]
mat_Sqrt:  [[10.78292407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00139786  0.02684475 -0.18103214]
Stock Position:  0.0013978565772489572
Bond Position:  [3.50144252]


portfolio before change:  [3.64084971]
curr_Stock_Price:  99.41612493978383
curr_Factors:  [99.41612494 -1.0899655  -0.98181153]
mat_Sqrt:  [[12.52262856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00602019 -0.04954455  0.42220569]
Stock Position:  -0.006020188785758196
Bond Position:  [4.23935355]


portfolio before change:  [3.64182313]
curr_Stock_Price:  99.34246171208436
curr_Factors:  [99.34246171 -0.93360678 -0.97808411]
mat_Sqrt:  [[14.68581704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00547219 -0.0540516   0.21826182]
Stock Position:  -0.0054721855755493565
Bond Position:  [4.18544351]


portfolio before change:  [3.6496648]
curr_Stock_Price:  98.00506860460663
curr_Factors:  [98.0050686  -0.85788419 -0.96820281]
mat_Sqrt:  [[15.78298086  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01118027 0.25848358 0.42186114]
Stock Position:  0.011180273409022874
Bond Position:  [2.55394134]


portfolio before change:  [3.65765278]
curr_Stock_Price:  98.6909830204333
curr_Factors:  [98.69098302 -0.75993256 -0.9447401 ]
mat_Sqrt:  [[17.94516879  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00935198 -0.00442879  0.35800902]
Stock Position:  0.009351977534414174
Bond Position:  [2.73469692]


portfolio before change:  [3.64921868]
curr_Stock_Price:  97.75257622271687
curr_Factors:  [97.75257622 -1.03912248 -0.93532729]
mat_Sqrt:  [[13.57174128  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01874499 0.02481815 0.26998277]
Stock Position:  0.018744989182180562
Bond Position:  [1.81684769]


portfolio before change:  [3.65506551]
curr_Stock_Price:  98.05237467603722
curr_Factors:  [98.05237468 -0.85726428 -0.93450269]
mat_Sqrt:  [[16.34193985  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01505982 -0.08667246 -0.01808124]
Stock Position:  -0.015059824816366396
Bond Position:  [5.1317171]


portfolio before change:  [3.65116743]
curr_Stock_Price:  98.35381199144412
curr_Factors:  [98.35381199 -0.95120504 -0.92743409]
mat_Sqrt:  [[15.02825604  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00080774 -0.00570208  0.26697654]
Stock Position:  -0.0008077380522179299
Bond Position:  [3.73061154]


portfolio before change:  [3.65068558]
curr_Stock_Price:  99.52770299965029
curr_Factors:  [99.527703   -0.7082682  -0.94536966]
mat_Sqrt:  [[19.04487752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00125047 -0.01269785  0.38257931]
Stock Position:  0.0012504749129352833
Bond Position:  [3.52622869]


portfolio before change:  [3.64975645]
curr_Stock_Price:  98.43216979239914
curr_Factors:  [98.43216979 -0.74268626 -0.91001651]
mat_Sqrt:  [[18.85286529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033809 -0.04224183  0.14145826]
Stock Position:  -0.00033809273871990807
Bond Position:  [3.68303566]


portfolio before change:  [3.65018302]
curr_Stock_Price:  98.53228150576808
curr_Factors:  [98.53228151 -0.76300736 -0.90890416]
mat_Sqrt:  [[18.51299107  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.001942    0.04066434 -0.10412116]
Stock Position:  -0.0019419950299235111
Bond Position:  [3.84153222]


portfolio before change:  [3.64835866]
curr_Stock_Price:  99.71898679775465
curr_Factors:  [99.7189868  -0.84090599 -0.90365808]
mat_Sqrt:  [[17.42301485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00277726 -0.0063503   0.10818877]
Stock Position:  0.0027772634170964744
Bond Position:  [3.37141277]


portfolio before change:  [3.64952091]
curr_Stock_Price:  99.98572351009567
curr_Factors:  [99.98572351 -0.69037671 -0.92332526]
mat_Sqrt:  [[19.91205733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00249818  0.00600392 -0.06399694]
Stock Position:  0.002498180907856651
Bond Position:  [3.39973849]


portfolio before change:  [3.65212372]
curr_Stock_Price:  100.85748460498615
curr_Factors:  [100.8574846   -0.62769341  -0.90122093]
mat_Sqrt:  [[21.86296567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00326489 -0.02067046  0.05850918]
Stock Position:  -0.003264889785978959
Bond Position:  [3.98141229]


portfolio before change:  [3.65563899]
curr_Stock_Price:  99.93323999348843
curr_Factors:  [99.93323999 -0.5916851  -0.89089848]
mat_Sqrt:  [[22.68987478  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00065925  0.0029278  -0.49266738]
Stock Position:  0.0006592465482777973
Bond Position:  [3.58975834]


portfolio before change:  [3.65511792]
curr_Stock_Price:  98.46213908143704
curr_Factors:  [98.46213908 -0.49901261 -0.87955497]
mat_Sqrt:  [[24.80647046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013759   0.00516324 -0.14552941]
Stock Position:  -0.0013758956540553585
Bond Position:  [3.79059155]


portfolio before change:  [3.65472046]
curr_Stock_Price:  99.09541008097592
curr_Factors:  [99.09541008 -0.47805308 -0.85920994]
mat_Sqrt:  [[26.01881954  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.39149546e-03  1.72175812e-01 -1.43803376e+00]
Stock Position:  -0.001391495459312047
Bond Position:  [3.79261127]


portfolio before change:  [3.65483303]
curr_Stock_Price:  99.35522452887908
curr_Factors:  [99.35522453 -0.43087097 -0.88214651]
mat_Sqrt:  [[26.72726159  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02213689 0.0926058  0.10495459]
Stock Position:  0.022136885523109915
Bond Position:  [1.4554178]


portfolio before change:  [3.68319361]
curr_Stock_Price:  100.62815139318128
curr_Factors:  [ 1.00628151e+02 -9.02626251e-02 -8.81722068e-01]
mat_Sqrt:  [[38.07079146  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00079773 0.01679001 0.05341718]
Stock Position:  0.0007977308990638532
Bond Position:  [3.60291942]


portfolio before change:  [3.68444142]
curr_Stock_Price:  101.62776487019981
curr_Factors:  [ 1.01627765e+02 -8.38129888e-03 -8.44205618e-01]
mat_Sqrt:  [[43.32500092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00201887 -0.04009856 -0.07454945]
Stock Position:  -0.0020188711057733864
Bond Position:  [3.88961478]


portfolio before change:  [3.67727538]
curr_Stock_Price:  105.4181360555819
curr_Factors:  [105.41813606   0.22947319  -0.81149108]
mat_Sqrt:  [[58.90445963  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00032366 -0.01567367 -0.0191592 ]
Stock Position:  -0.0003236577091105523
Bond Position:  [3.71139478]


portfolio before change:  [3.67751277]
curr_Stock_Price:  106.11815990192083
curr_Factors:  [106.1181599    0.20973795  -0.80159093]
mat_Sqrt:  [[58.71529218  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035626  0.00318149  0.20872323]
Stock Position:  -0.00035626155319703454
Bond Position:  [3.71531859]


portfolio before change:  [3.6774487]
curr_Stock_Price:  107.60165389862665
curr_Factors:  [ 1.07601654e+02  9.85178681e-02 -8.13458369e-01]
mat_Sqrt:  [[52.64101232  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00222129 -0.00326896  0.53727025]
Stock Position:  0.002221291781680922
Bond Position:  [3.43843403]


portfolio before change:  [3.682531]
curr_Stock_Price:  109.69614047132431
curr_Factors:  [ 1.09696140e+02  6.43116961e-02 -8.13877102e-01]
mat_Sqrt:  [[51.83931191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00395241 -0.01668109  0.64621231]
Stock Position:  0.0039524077074145555
Bond Position:  [3.24896713]


portfolio before change:  [3.67460757]
curr_Stock_Price:  107.5886711456884
curr_Factors:  [107.58867115   0.28125856  -0.83179869]
mat_Sqrt:  [[62.03974506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00062706  0.00781522 -0.2814917 ]
Stock Position:  -0.0006270643934751656
Bond Position:  [3.74207259]


portfolio before change:  [3.67219198]
curr_Stock_Price:  112.18688434592096
curr_Factors:  [112.18688435   0.22862728  -0.83360853]
mat_Sqrt:  [[61.26353699  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00165867  0.03452033 -0.4402063 ]
Stock Position:  -0.0016586749553027412
Bond Position:  [3.85827355]


portfolio before change:  [3.67721827]
curr_Stock_Price:  109.44736180529014
curr_Factors:  [109.44736181   0.29335879  -0.86387846]
mat_Sqrt:  [[61.86311069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00513286 0.02662216 0.32842284]
Stock Position:  0.005132863699231771
Bond Position:  [3.11543988]


portfolio before change:  [3.70587857]
curr_Stock_Price:  114.95517369552933
curr_Factors:  [ 1.14955174e+02  6.66376257e-02 -8.15819473e-01]
mat_Sqrt:  [[54.34542377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00157204 -0.06508726 -1.00524086]
Stock Position:  -0.0015720408617661166
Bond Position:  [3.8865928]


portfolio before change:  [3.70390578]
curr_Stock_Price:  116.51915793848916
curr_Factors:  [ 1.16519158e+02  6.20872049e-02 -8.31350436e-01]
mat_Sqrt:  [[53.98965609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [5.18165636e-04 3.00653474e-04 4.67612616e-01]
Stock Position:  0.0005181656355023093
Bond Position:  [3.64352956]


portfolio before change:  [3.70543834]
curr_Stock_Price:  118.59781551552447
curr_Factors:  [ 1.18597816e+02 -2.35088697e-03 -8.22160983e-01]
mat_Sqrt:  [[51.99908891  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00458962 -0.05776607 -2.18454972]
Stock Position:  -0.004589621071504233
Bond Position:  [4.24975737]


portfolio before change:  [3.70165684]
curr_Stock_Price:  119.53749020434887
curr_Factors:  [119.5374902    0.13964885  -0.84828974]
mat_Sqrt:  [[58.84984275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0057392   0.31849959 -1.45777367]
Stock Position:  0.005739201332410485
Bond Position:  [3.01560712]


portfolio before change:  [3.70503733]
curr_Stock_Price:  120.0608232517212
curr_Factors:  [ 1.20060823e+02  8.05702685e-02 -8.57999436e-01]
mat_Sqrt:  [[55.178275    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00223851 0.06473828 0.26390572]
Stock Position:  0.002238513934993041
Bond Position:  [3.4362795]


portfolio before change:  [3.70463833]
curr_Stock_Price:  119.69068630819206
curr_Factors:  [ 1.19690686e+02 -2.65987686e-02 -8.60888052e-01]
mat_Sqrt:  [[49.27535119  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02043846 -0.14641361  2.37684136]
Stock Position:  0.02043846420687791
Bond Position:  [1.25834453]


portfolio before change:  [3.69470083]
curr_Stock_Price:  119.19677414465626
curr_Factors:  [ 1.19196774e+02  6.75322921e-02 -8.79840050e-01]
mat_Sqrt:  [[52.90341717  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00448697  0.04763277  0.23062086]
Stock Position:  -0.004486974271575577
Bond Position:  [4.22953369]


portfolio before change:  [3.71511506]
curr_Stock_Price:  114.76494468908665
curr_Factors:  [ 1.14764945e+02  1.12995057e-01 -8.84142312e-01]
mat_Sqrt:  [[53.07674168  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01361934 -0.04169906 -0.21681192]
Stock Position:  0.01361934431849301
Bond Position:  [2.15209176]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.7503585]
Stock Price:  117.33294026058189
PL:  [-13.58258176]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-7.00927116e-02 -8.63309848e-02  1.40298051e-02]
 [-1.67496269e-01  6.63333677e-02 -1.89209151e-01]
 [-2.22457655e-02  3.45860202e-02  3.07625165e-02]
 [-5.77049464e-02 -7.57830417e-02 -2.26025970e-04]
 [ 1.15523015e-01 -9.25206306e-02 -9.21603669e-02]
 [-1.29866502e-01 -1.64883036e-01  9.17528566e-02]
 [-5.42778188e-02 -1.48824121e-01 -2.89407098e-04]
 [ 1.28422069e-02  5.93955054e-01  8.29781738e-02]
 [ 2.35323910e-01 -2.60389097e-02  2.47557818e-01]
 [ 4.43036161e-01  1.73116262e-01  2.93006189e-01]
 [-2.26705752e-01 -2.66967534e-01  6.19375380e-03]
 [-2.84859179e-02 -1.76966673e-02  9.34812298e-02]
 [ 1.15242027e-02 -5.87468561e-02  9.91321789e-02]
 [-2.12090245e-04  1.57976949e-01 -6.61517426e-02]
 [ 3.04700355e-01 -1.57422293e-01 -1.62396130e-01]
 [-2.11365633e-01 -9.61435610e-02  1.18642822e-01]
 [ 5.06471730e-02  1.83849131e-02 -2.31426048e-02]
 [-3.96393611e-02 -5.05263139e-02  5.30504171e-02]
 [ 1.01032258e-01 -8.05715679e-02 -5.67123349e-02]
 [ 5.05122057e-02 -1.34228230e-02  1.66516823e-01]
 [-2.26811959e-02  4.01337856e-01 -3.76346981e-01]
 [ 2.28492005e-01  1.44773293e-01  8.51696158e-02]
 [-2.36728905e-02  4.36877518e-02  2.24881688e-02]
 [ 1.07943047e-01 -1.80881146e-01 -3.09176377e-01]
 [ 4.28896311e-02  1.10804849e-02 -1.32906605e-02]
 [-5.26856894e-02 -4.11921627e-04  1.45092797e-01]
 [-1.24594614e-02 -3.23747074e-02  2.56020917e-03]
 [-4.77818352e-02  2.37963663e-02 -2.59396953e-01]
 [-5.91006689e-02 -3.11699536e-02 -8.73759507e-03]
 [-5.26273027e-02  5.81752652e-03  9.89179667e-03]
 [ 4.87628659e-03 -4.33153346e-02 -5.16772207e-02]
 [ 1.58661398e-02  7.03835146e-02 -6.33162293e-02]
 [-1.68247302e-02  2.00521211e-02  1.06848402e-02]
 [ 1.84682982e-02 -6.03120003e-02  3.95372510e-02]
 [-5.88926151e-02 -1.94937518e-02  1.08473096e-02]
 [ 9.01051020e-02 -3.48203070e-03  1.60661570e-01]
 [ 8.92796690e-02 -6.75885948e-02  2.44321061e-02]
 [-8.22038061e-02  1.59479051e-02  4.25766254e-02]
 [ 1.53557919e-01 -3.72435358e-03  1.03904693e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.26192749]
curr_Stock_Price:  100.10946266612488
curr_Factors:  [100.10946267  -0.99809898  -1.00676939]
mat_Sqrt:  [[13.48254441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00629341 -0.02786321  0.04002313]
Stock Position:  -0.006293406166995237
Bond Position:  [3.891957]


portfolio before change:  [3.2632328]
curr_Stock_Price:  99.97936055398503
curr_Factors:  [99.97936055 -1.11555905 -0.98199481]
mat_Sqrt:  [[12.2731005   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01569108  0.021409   -0.53976104]
Stock Position:  -0.01569107850231258
Bond Position:  [4.83201679]


portfolio before change:  [3.25659632]
curr_Stock_Price:  100.44080259029926
curr_Factors:  [100.44080259  -1.30006514  -0.97113829]
mat_Sqrt:  [[10.36427807  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085935  0.01116259  0.0877569 ]
Stock Position:  -0.0008593508664833278
Bond Position:  [3.34291021]


portfolio before change:  [3.25689277]
curr_Stock_Price:  100.58211694687242
curr_Factors:  [100.58211695  -1.39601002  -0.98482026]
mat_Sqrt:  [[ 9.30120718  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00787212 -0.02445887 -0.00064479]
Stock Position:  -0.007872121427257668
Bond Position:  [4.0486874]


portfolio before change:  [3.25822782]
curr_Stock_Price:  100.47681647623527
curr_Factors:  [100.47681648  -1.46175387  -0.99034561]
mat_Sqrt:  [[ 8.65232045  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00899472 -0.02986091 -0.26290787]
Stock Position:  0.008994715841152072
Bond Position:  [2.35446741]


portfolio before change:  [3.25989038]
curr_Stock_Price:  100.62893159235536
curr_Factors:  [100.62893159  -1.33072223  -0.98097296]
mat_Sqrt:  [[ 9.9716356   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0145206  -0.05321577  0.26174536]
Stock Position:  -0.014520600543387463
Bond Position:  [4.7210829]


portfolio before change:  [3.25940217]
curr_Stock_Price:  100.70319742457146
curr_Factors:  [100.70319742  -1.06814326  -0.96129163]
mat_Sqrt:  [[13.23338306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00640165 -0.04803278 -0.0008256 ]
Stock Position:  -0.006401650278526882
Bond Position:  [3.90406882]


portfolio before change:  [3.25488652]
curr_Stock_Price:  101.48482239119099
curr_Factors:  [101.48482239  -1.05902191  -0.9768143 ]
mat_Sqrt:  [[13.25100028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01139692 0.19169817 0.23671363]
Stock Position:  0.011396922515597941
Bond Position:  [2.09827186]


portfolio before change:  [3.24389572]
curr_Stock_Price:  100.49744206301239
curr_Factors:  [100.49744206  -0.99696883  -0.98393713]
mat_Sqrt:  [[13.86304011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02023663 -0.00840402  0.70621355]
Stock Position:  0.020236633931204145
Bond Position:  [1.21016578]


portfolio before change:  [3.24464414]
curr_Stock_Price:  100.5269499430424
curr_Factors:  [100.52694994  -0.96739948  -0.95864194]
mat_Sqrt:  [[14.64918094  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0367381  0.05587303 0.8358651 ]
Stock Position:  0.03673809548331758
Bond Position:  [-0.44852454]


portfolio before change:  [3.18823733]
curr_Stock_Price:  98.99309948376046
curr_Factors:  [98.99309948 -0.91063604 -0.92980419]
mat_Sqrt:  [[15.71490955  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0178134  -0.0861634   0.01766906]
Stock Position:  -0.01781340043575497
Bond Position:  [4.95164105]


portfolio before change:  [3.15077945]
curr_Stock_Price:  101.13064069287067
curr_Factors:  [101.13064069  -0.92454386  -0.89813105]
mat_Sqrt:  [[16.34199612  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007965  -0.00571157  0.26667593]
Stock Position:  -0.0007965036063829737
Bond Position:  [3.23133037]


portfolio before change:  [3.15092466]
curr_Stock_Price:  101.4554684867594
curr_Factors:  [101.45546849  -0.85955621  -0.89719581]
mat_Sqrt:  [[17.51167759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112884 -0.01896047  0.28279651]
Stock Position:  0.0011288365776162428
Bond Position:  [3.03639802]


portfolio before change:  [3.1525258]
curr_Stock_Price:  102.53761369007658
curr_Factors:  [102.53761369  -1.04017871  -0.94091956]
mat_Sqrt:  [[14.14175016  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00131042  0.05098684 -0.18871251]
Stock Position:  0.001310421363914873
Bond Position:  [3.01815832]


portfolio before change:  [3.15299447]
curr_Stock_Price:  102.60734823832696
curr_Factors:  [102.60734824  -0.96171128  -0.91825009]
mat_Sqrt:  [[15.657471    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01529096 -0.05080783 -0.46327096]
Stock Position:  0.015290955514019263
Bond Position:  [1.58403008]


portfolio before change:  [3.16081347]
curr_Stock_Price:  103.1057460850484
curr_Factors:  [103.10574609  -0.83978671  -0.91989923]
mat_Sqrt:  [[17.74438598  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01165287 -0.0310302   0.33845495]
Stock Position:  -0.011652868164135247
Bond Position:  [4.36229114]


portfolio before change:  [3.16993287]
curr_Stock_Price:  102.369955025334
curr_Factors:  [102.36995503  -1.0992434   -0.90829778]
mat_Sqrt:  [[13.75018232  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00361275  0.00593371 -0.06601941]
Stock Position:  0.003612753061106624
Bond Position:  [2.8000955]


portfolio before change:  [3.16627531]
curr_Stock_Price:  101.26066444488137
curr_Factors:  [101.26066444  -1.34153687  -0.90500398]
mat_Sqrt:  [[10.70977831  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365312 -0.0163073   0.15133807]
Stock Position:  -0.0036531223717463997
Bond Position:  [3.53619291]


portfolio before change:  [3.1639625]
curr_Stock_Price:  102.0147746750532
curr_Factors:  [102.01477468  -1.68073282  -0.89639822]
mat_Sqrt:  [[ 7.752277    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00941779 -0.02600436 -0.16178451]
Stock Position:  0.009417787626552357
Bond Position:  [2.20320902]


portfolio before change:  [3.16339292]
curr_Stock_Price:  101.9250508992064
curr_Factors:  [101.9250509   -1.60035613  -0.88233259]
mat_Sqrt:  [[ 8.51261371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00960485 -0.0043322   0.47502615]
Stock Position:  0.009604851157519198
Bond Position:  [2.18441798]


portfolio before change:  [3.15622511]
curr_Stock_Price:  101.15035084818412
curr_Factors:  [101.15035085  -1.40901656  -0.86248394]
mat_Sqrt:  [[10.43439476  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168481  0.12953124 -1.07361318]
Stock Position:  -0.0016848083008489882
Bond Position:  [3.32664406]


portfolio before change:  [3.15534221]
curr_Stock_Price:  101.92121286819543
curr_Factors:  [101.92121287  -1.42360099  -0.8505402 ]
mat_Sqrt:  [[10.48618741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02626588 0.04672538 0.24296521]
Stock Position:  0.026265876613424777
Bond Position:  [0.47829221]


portfolio before change:  [3.14812975]
curr_Stock_Price:  101.64434226109042
curr_Factors:  [101.64434226  -1.45862716  -0.86767982]
mat_Sqrt:  [[ 9.92615212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102404  0.01410016  0.06415249]
Stock Position:  -0.0010240410527741174
Bond Position:  [3.25221773]


portfolio before change:  [3.14897057]
curr_Stock_Price:  101.22027824054855
curr_Factors:  [101.22027824  -1.4264651   -0.86805941]
mat_Sqrt:  [[10.203947    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.75236661e-04 -5.83791389e-02 -8.81994145e-01]
Stock Position:  0.0007752366613433956
Bond Position:  [3.07050089]


portfolio before change:  [3.14868585]
curr_Stock_Price:  100.35788912411496
curr_Factors:  [100.35788912  -1.28132538  -0.89860397]
mat_Sqrt:  [[11.3454109   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00374059  0.00357621 -0.03791456]
Stock Position:  0.0037405856193815927
Bond Position:  [2.77328857]


portfolio before change:  [3.14867683]
curr_Stock_Price:  100.2627985442356
curr_Factors:  [100.26279854  -1.41351369  -0.86269582]
mat_Sqrt:  [[10.29424723  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.24910368e-03 -1.32947134e-04  4.13909365e-01]
Stock Position:  -0.0022491036809218277
Bond Position:  [3.37417826]


portfolio before change:  [3.15098631]
curr_Stock_Price:  99.42349707823263
curr_Factors:  [99.42349708 -1.17893341 -0.87085089]
mat_Sqrt:  [[12.80203539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144862 -0.01044889  0.00730356]
Stock Position:  -0.001448622803890404
Bond Position:  [3.29501345]


portfolio before change:  [3.15106606]
curr_Stock_Price:  99.65278158397636
curr_Factors:  [99.65278158 -1.23313079 -0.88372071]
mat_Sqrt:  [[11.99920578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00799     0.00768024 -0.7399873 ]
Stock Position:  -0.007989995785006842
Bond Position:  [3.94729137]


portfolio before change:  [3.15258172]
curr_Stock_Price:  99.5248448077102
curr_Factors:  [99.52484481 -1.45457641 -0.87966687]
mat_Sqrt:  [[ 9.64234206  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00697411 -0.01006006 -0.02492593]
Stock Position:  -0.006974110929700236
Bond Position:  [3.84667903]


portfolio before change:  [3.1537986]
curr_Stock_Price:  99.41931009637858
curr_Factors:  [99.4193101  -1.38269554 -0.89569906]
mat_Sqrt:  [[10.18536371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00485212  0.0018776   0.02821854]
Stock Position:  -0.004852124272569829
Bond Position:  [3.63619344]


portfolio before change:  [3.15563319]
curr_Stock_Price:  99.13488990349123
curr_Factors:  [99.1348899  -1.01398403 -0.91898366]
mat_Sqrt:  [[14.34661126  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101167 -0.01397996 -0.14742073]
Stock Position:  -0.001011666609080154
Bond Position:  [3.25592465]


portfolio before change:  [3.15615003]
curr_Stock_Price:  99.02633483202155
curr_Factors:  [99.02633483 -0.92299954 -0.89724281]
mat_Sqrt:  [[16.04092825  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107904  0.02271618 -0.18062358]
Stock Position:  0.0010790362683240188
Bond Position:  [3.04929702]


portfolio before change:  [3.15698937]
curr_Stock_Price:  99.45093287459248
curr_Factors:  [99.45093287 -1.0187669  -0.95272497]
mat_Sqrt:  [[13.84843906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00076186  0.00647179  0.03048088]
Stock Position:  -0.0007618601777338222
Bond Position:  [3.23275708]


portfolio before change:  [3.15656377]
curr_Stock_Price:  100.54000200195794
curr_Factors:  [100.540002    -1.35414615  -0.9933748 ]
mat_Sqrt:  [[ 9.61221544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00148017 -0.01946561  0.11278877]
Stock Position:  0.0014801655619931671
Bond Position:  [3.00774793]


portfolio before change:  [3.15595364]
curr_Stock_Price:  99.87377730115755
curr_Factors:  [99.8737773  -1.30096125 -0.98566246]
mat_Sqrt:  [[10.14806914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00597725 -0.00629158  0.03094436]
Stock Position:  -0.005977251620124244
Bond Position:  [3.75292434]


portfolio before change:  [3.15294723]
curr_Stock_Price:  100.45524092533003
curr_Factors:  [100.45524093  -0.90411253  -1.00689293]
mat_Sqrt:  [[14.86050175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00822242 -0.00112382  0.45832274]
Stock Position:  0.008222416927510783
Bond Position:  [2.32696236]


portfolio before change:  [3.17025552]
curr_Stock_Price:  102.52487520164652
curr_Factors:  [102.5248752   -0.70451547  -1.03013355]
mat_Sqrt:  [[18.09175729  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0044479  -0.02181413  0.069698  ]
Stock Position:  0.00444790333810138
Bond Position:  [2.71423478]


portfolio before change:  [3.1726284]
curr_Stock_Price:  102.98207432812703
curr_Factors:  [102.98207433  -0.62449959  -1.04642344]
mat_Sqrt:  [[19.36818768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00362747  0.00514716  0.12145926]
Stock Position:  -0.003627470854956562
Bond Position:  [3.54619287]


portfolio before change:  [3.1715582]
curr_Stock_Price:  103.39930749475481
curr_Factors:  [103.39930749  -0.82253809  -1.02704113]
mat_Sqrt:  [[16.26505669  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01069822 -0.00120203  0.29641117]
Stock Position:  0.010698219428407083
Bond Position:  [2.06536972]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.16529319]
Stock Price:  102.78956183343394
PL:  [0.37573136]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-3.00823419e-01 -1.02406438e-01  2.72239784e-02]
 [-9.76861199e-02  7.14567576e-02 -9.82399299e-02]
 [-1.42304580e-01 -1.66933629e-02 -8.27375142e-02]
 [-5.13006594e-01 -2.21731402e-01 -3.24877348e-01]
 [ 1.35660378e-01 -1.24622313e-01 -9.68772577e-02]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.16047197e-02 -2.00986652e-01 -2.81923427e-02]
 [ 9.82949140e-03  6.38436556e-01  9.36104436e-02]
 [ 3.31111124e-01  1.46949826e-02  3.39412367e-01]
 [ 5.69771533e-01  2.45358651e-01  4.62592342e-01]
 [-1.60235057e-01 -2.03458598e-01  2.18573174e-02]
 [-4.82589396e-02 -1.83807743e-02  9.10300630e-02]
 [ 1.46125754e-02 -4.90313123e-02  4.96853205e-02]
 [-1.53145852e-04  1.79903806e-01 -1.05929125e-01]
 [ 4.04998389e-01 -1.69628874e-01 -1.89801792e-01]
 [-2.22458358e-01 -9.67282231e-02  1.20884133e-01]
 [ 5.60868512e-02 -2.05628237e-02  3.77802937e-02]
 [-4.00845509e-02 -5.07896527e-02  5.24165443e-02]
 [ 1.63769469e-01 -2.00752321e-01  3.04448258e-02]
 [ 6.42340932e-02 -4.25098827e-03  3.53916150e-01]
 [-1.93648977e-02  3.67523974e-01 -3.49209225e-01]
 [ 9.15728304e-02  7.92579297e-02  1.07465938e-01]
 [ 1.50766436e-02  1.37068029e-01 -3.25478908e-02]
 [ 9.10281001e-02 -1.78603462e-01 -2.77484460e-01]
 [ 5.74161770e-02  2.16434482e-02 -1.41853031e-02]
 [-1.05460774e-02  1.62848273e-02  3.50309124e-02]
 [ 8.08853866e-02 -3.01589871e-02  2.83865400e-02]
 [ 1.46868272e-01 -7.03812980e-02  8.98575950e-02]
 [-4.58172499e-02 -1.76666339e-02 -2.70874809e-02]
 [-5.86768123e-02 -1.18984365e-02  3.21454506e-02]
 [-2.52358733e-02 -4.27214425e-02 -1.15469235e-02]
 [ 2.59702534e-02 -5.59674957e-03 -4.00441197e-02]
 [ 3.01330584e-02  1.15887205e-02  1.50521488e-01]
 [ 1.40251264e-02 -6.62739830e-02  7.92209361e-03]
 [-3.28605825e-02 -1.64201723e-02  4.75911401e-02]
 [ 9.11444058e-02  3.20175904e-02  1.98875233e-01]
 [ 1.76913899e-02  9.19226712e-03 -2.63708327e-02]
 [-5.40570849e-02 -1.09964951e-02  3.30560872e-02]
 [ 9.46182055e-02  5.74756616e-03  8.55635249e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.91602126]
curr_Stock_Price:  101.20050542827374
curr_Factors:  [101.20050543  -1.1371494   -0.97160089]
mat_Sqrt:  [[12.28468618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02573692 -0.03305154  0.07766243]
Stock Position:  -0.025736919113695963
Bond Position:  [14.52061049]


portfolio before change:  [11.93236136]
curr_Stock_Price:  100.63614483294859
curr_Factors:  [100.63614483  -1.05499469  -0.96469993]
mat_Sqrt:  [[13.35401206  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00772451  0.02306257 -0.28025118]
Stock Position:  -0.0077245109200897374
Bond Position:  [12.70972636]


portfolio before change:  [11.92473856]
curr_Stock_Price:  101.8286621927962
curr_Factors:  [101.82866219  -0.90198627  -0.98851952]
mat_Sqrt:  [[15.3756614   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01057521 -0.00538776 -0.2360271 ]
Stock Position:  -0.0105752083199953
Bond Position:  [13.00159787]


portfolio before change:  [11.9205325]
curr_Stock_Price:  102.38007999951093
curr_Factors:  [102.38008     -1.02929427  -0.99719498]
mat_Sqrt:  [[13.49343013  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04628791 -0.0715635  -0.92678464]
Stock Position:  -0.04628790691344795
Bond Position:  [16.65949211]


portfolio before change:  [11.98671628]
curr_Stock_Price:  100.9952429471959
curr_Factors:  [100.99524295  -0.98740133  -0.97494011]
mat_Sqrt:  [[14.19276007  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00637275 -0.04022168 -0.27636385]
Stock Position:  0.006372753956361078
Bond Position:  [11.34309844]


portfolio before change:  [11.99126544]
curr_Stock_Price:  101.4865825511604
curr_Factors:  [101.48658255  -1.26139788  -0.99707118]
mat_Sqrt:  [[10.60639933  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01445393 -0.05534923  0.15513819]
Stock Position:  -0.014453934019007107
Bond Position:  [13.45814581]


portfolio before change:  [11.98244343]
curr_Stock_Price:  102.21333167171514
curr_Factors:  [102.21333167  -1.40402416  -1.01669899]
mat_Sqrt:  [[ 9.08240448  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01083256 -0.06486816 -0.08042491]
Stock Position:  -0.010832559407191893
Bond Position:  [13.08967542]


portfolio before change:  [11.98773473]
curr_Stock_Price:  101.87592411952133
curr_Factors:  [101.87592412  -1.2083435   -1.00231854]
mat_Sqrt:  [[11.16845856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01425962 0.20605451 0.26704454]
Stock Position:  0.014259618597210828
Bond Position:  [10.5350229]


portfolio before change:  [11.99266071]
curr_Stock_Price:  102.12901804465096
curr_Factors:  [102.12901804  -1.07884728  -0.9699239 ]
mat_Sqrt:  [[13.16373513  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03064426 0.00474279 0.96824901]
Stock Position:  0.03064426473712496
Bond Position:  [8.86299204]


portfolio before change:  [11.99250345]
curr_Stock_Price:  102.08773132767051
curr_Factors:  [102.08773133  -1.00416407  -0.9887506 ]
mat_Sqrt:  [[13.91431103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0513343  0.07918916 1.31964719]
Stock Position:  0.05133430053543568
Bond Position:  [6.75190117]


portfolio before change:  [12.01155255]
curr_Stock_Price:  102.44236870518726
curr_Factors:  [102.44236871  -0.88959019  -1.00874804]
mat_Sqrt:  [[15.34764659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01285567 -0.06566598  0.06235284]
Stock Position:  -0.012855668889660454
Bond Position:  [13.32851773]


portfolio before change:  [12.01342187]
curr_Stock_Price:  102.42656670319516
curr_Factors:  [102.4265667  -0.806237   -1.0200563]
mat_Sqrt:  [[16.49162732  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202706 -0.00593237  0.25968343]
Stock Position:  -0.002027056822499627
Bond Position:  [12.22104634]


portfolio before change:  [12.01445552]
curr_Stock_Price:  102.67030481912184
curr_Factors:  [102.67030482  -1.17036822  -1.02550336]
mat_Sqrt:  [[11.42325682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00129088 -0.01582479  0.14173839]
Stock Position:  0.0012908817905843493
Bond Position:  [11.8819203]


portfolio before change:  [12.01631938]
curr_Stock_Price:  102.96353202597459
curr_Factors:  [102.96353203  -1.0691068   -1.04354878]
mat_Sqrt:  [[12.44998329  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120055  0.0580637  -0.30218631]
Stock Position:  0.0012005536353431254
Bond Position:  [11.89270614]


portfolio before change:  [12.01875137]
curr_Stock_Price:  103.75092683052253
curr_Factors:  [103.75092683  -1.37459316  -1.05830378]
mat_Sqrt:  [[ 9.10748089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03641291 -0.05474748 -0.54145168]
Stock Position:  0.03641291326750798
Bond Position:  [8.24087787]


portfolio before change:  [12.0025889]
curr_Stock_Price:  103.27876902090456
curr_Factors:  [103.27876902  -1.52078477  -1.05045692]
mat_Sqrt:  [[ 7.8946881   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02755366 -0.0312189   0.34484878]
Stock Position:  -0.027553660274991666
Bond Position:  [14.84829702]


portfolio before change:  [12.00072004]
curr_Stock_Price:  103.4139603349909
curr_Factors:  [103.41396033  -1.86079196  -1.03088635]
mat_Sqrt:  [[ 5.73771849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01038764 -0.00663662  0.10777666]
Stock Position:  0.0103876397229841
Bond Position:  [10.92649308]


portfolio before change:  [12.00464193]
curr_Stock_Price:  103.66002132830401
curr_Factors:  [103.66002133  -1.86699326  -1.04920984]
mat_Sqrt:  [[ 5.6120351   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00708343 -0.01639229  0.14952981]
Stock Position:  -0.007083430951996855
Bond Position:  [12.73891053]


portfolio before change:  [12.00165234]
curr_Stock_Price:  104.30689071691037
curr_Factors:  [104.30689072  -1.7406305   -1.09093255]
mat_Sqrt:  [[ 6.1458335   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02099074 -0.06479253  0.08685061]
Stock Position:  0.020990740691930253
Bond Position:  [9.81217344]


portfolio before change:  [12.00868759]
curr_Stock_Price:  104.58361529188711
curr_Factors:  [104.58361529  -1.71831949  -1.10760828]
mat_Sqrt:  [[ 6.19696175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02188317 -0.001372    1.00962427]
Stock Position:  0.02188317453148798
Bond Position:  [9.72006608]


portfolio before change:  [12.00272056]
curr_Stock_Price:  104.25541249673869
curr_Factors:  [104.2554125   -1.44431843  -1.09967112]
mat_Sqrt:  [[ 8.18951132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019081   0.11861785 -0.99619672]
Stock Position:  -0.001908101073295006
Bond Position:  [12.20165042]


portfolio before change:  [12.00521587]
curr_Stock_Price:  103.74704518737138
curr_Factors:  [103.74704519  -1.29487297  -1.09961135]
mat_Sqrt:  [[ 9.46377509  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01370359 0.02558039 0.30657041]
Stock Position:  0.013703588594948196
Bond Position:  [10.58350905]


portfolio before change:  [12.00130504]
curr_Stock_Price:  103.36511241818363
curr_Factors:  [103.36511242  -1.41288057  -1.10751836]
mat_Sqrt:  [[ 8.31339917  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00437988  0.04423852 -0.09285007]
Stock Position:  0.004379884428713961
Bond Position:  [11.5485778]


portfolio before change:  [12.00264692]
curr_Stock_Price:  103.34187325776917
curr_Factors:  [103.34187326  -1.56913813  -1.06454009]
mat_Sqrt:  [[ 7.42137555  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.78985617e-04 -5.76440194e-02 -7.91585927e-01]
Stock Position:  -0.000278985616970353
Bond Position:  [12.03147782]


portfolio before change:  [12.00432008]
curr_Stock_Price:  102.73563194034902
curr_Factors:  [102.73563194  -1.41461307  -1.06076326]
mat_Sqrt:  [[ 8.64328458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.006819    0.00698539 -0.04046672]
Stock Position:  0.006819000799550902
Bond Position:  [11.30376573]


portfolio before change:  [12.00643118]
curr_Stock_Price:  102.8379978372474
curr_Factors:  [102.83799784  -1.65857729  -1.02392921]
mat_Sqrt:  [[ 7.03324652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.01369907e-05  5.25590540e-03  9.99334422e-02]
Stock Position:  -1.0136990742773092e-05
Bond Position:  [12.00747364]


portfolio before change:  [12.00793208]
curr_Stock_Price:  102.8501312381808
curr_Factors:  [102.85013124  -1.59722764  -1.01885582]
mat_Sqrt:  [[ 7.5171677   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01071196 -0.00973377  0.0809789 ]
Stock Position:  0.010711958356874749
Bond Position:  [10.90620576]


portfolio before change:  [12.0049514]
curr_Stock_Price:  102.444598912772
curr_Factors:  [102.44459891  -1.63211206  -0.99755294]
mat_Sqrt:  [[ 7.38652321  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0204215  -0.02271547  0.25633871]
Stock Position:  0.020421496013495005
Bond Position:  [9.91287943]


portfolio before change:  [12.01510755]
curr_Stock_Price:  102.88124523317052
curr_Factors:  [102.88124523  -1.32905432  -1.01381934]
mat_Sqrt:  [[ 9.88186941  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00556096 -0.00570188 -0.07727304]
Stock Position:  -0.005560956441688904
Bond Position:  [12.58722568]


portfolio before change:  [12.01951559]
curr_Stock_Price:  102.37152503269499
curr_Factors:  [102.37152503  -1.26894753  -0.97445013]
mat_Sqrt:  [[10.86135351  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00502183 -0.0038402   0.09170202]
Stock Position:  -0.00502183340017963
Bond Position:  [12.53360833]


portfolio before change:  [12.02640615]
curr_Stock_Price:  101.31140178264685
curr_Factors:  [101.31140178  -1.29785047  -1.00803818]
mat_Sqrt:  [[10.09772653  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00359619 -0.01378829 -0.03294016]
Stock Position:  -0.003596191385603762
Bond Position:  [12.39074134]


portfolio before change:  [12.02605701]
curr_Stock_Price:  101.83920307356368
curr_Factors:  [101.83920307  -1.30208921  -1.03445485]
mat_Sqrt:  [[ 9.84389104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0016918  -0.00180634 -0.11423473]
Stock Position:  0.0016917954399586982
Bond Position:  [11.85376592]


portfolio before change:  [12.02536575]
curr_Stock_Price:  100.55472252672325
curr_Factors:  [100.55472253  -1.20587628  -1.02377017]
mat_Sqrt:  [[10.81631491  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00584521 0.00374024 0.42939591]
Stock Position:  0.005845213150084491
Bond Position:  [11.43760196]


portfolio before change:  [12.03110425]
curr_Stock_Price:  101.29185735255822
curr_Factors:  [101.29185735  -1.42922458  -1.04416744]
mat_Sqrt:  [[ 8.53874466  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00024759 -0.02138984  0.02259953]
Stock Position:  0.00024758872479168053
Bond Position:  [12.00602553]


portfolio before change:  [12.03259948]
curr_Stock_Price:  101.2691599505963
curr_Factors:  [101.26915995  -1.34812497  -1.04088185]
mat_Sqrt:  [[ 9.28848167  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00285276 -0.00529959  0.13576428]
Stock Position:  -0.00285276284393352
Bond Position:  [12.32149637]


portfolio before change:  [12.03243194]
curr_Stock_Price:  101.86781332163702
curr_Factors:  [101.86781332  -1.26512444  -1.06900136]
mat_Sqrt:  [[ 9.87049726  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01400894 0.01033363 0.56733568]
Stock Position:  0.014008940222329675
Bond Position:  [10.60537184]


portfolio before change:  [12.02155683]
curr_Stock_Price:  100.99687913459381
curr_Factors:  [100.99687913  -1.1112653   -1.03135093]
mat_Sqrt:  [[11.85172449  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00119686  0.00296679 -0.07522865]
Stock Position:  0.0011968578869135762
Bond Position:  [11.90067792]


portfolio before change:  [12.02261422]
curr_Stock_Price:  100.63736583854075
curr_Factors:  [100.63736584  -0.87825765  -1.03833495]
mat_Sqrt:  [[14.80449752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00334724 -0.0035491   0.09429982]
Stock Position:  -0.0033472388674574216
Bond Position:  [12.35947153]


portfolio before change:  [12.02438717]
curr_Stock_Price:  100.56927578061129
curr_Factors:  [100.56927578  -0.74179748  -1.05663502]
mat_Sqrt:  [[16.65006804  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00680219 0.00185502 0.24408892]
Stock Position:  0.006802194658281971
Bond Position:  [11.34029538]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.03103525]
Stock Price:  101.33821215293742
PL:  [10.6928231]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.42113744e-01 -9.54682657e-02  1.68416262e-02]
 [-1.78189256e-01  6.55486059e-02 -2.03143123e-01]
 [ 9.52864247e-03  9.56928259e-04  5.32240005e-02]
 [ 2.73862108e-02 -4.88760495e-03  7.63185317e-02]
 [ 1.38736234e-01 -1.26558933e-01 -9.65549928e-02]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.18717863e-02 -1.89477858e-01 -2.79131640e-02]
 [ 7.12132009e-03  6.45652925e-01  9.90531974e-02]
 [ 4.14269482e-01  4.91216188e-02  4.05331189e-01]
 [ 7.38081832e-01  3.37180062e-01  6.74514980e-01]
 [ 1.53874944e-03 -1.88699552e-01 -3.42746188e-02]
 [-1.09417369e-01 -2.35132818e-02  7.98166739e-02]
 [ 1.62126617e-02 -9.86721131e-02  1.26534821e-01]
 [ 9.78421080e-04  1.70891353e-01 -1.21008116e-01]
 [ 5.56196604e-01 -1.44594129e-01 -2.53648841e-01]
 [-1.79862885e-01 -9.44831518e-02  1.12277617e-01]
 [ 5.14055117e-02  1.41371183e-02 -1.84049180e-02]
 [-6.11730085e-02 -6.32639069e-02  2.23902496e-02]
 [ 2.04577201e-01 -2.58708272e-01  8.16523784e-02]
 [ 6.93927494e-02  1.45170219e-03  4.66741546e-01]
 [-1.56145329e-02  3.32445924e-01 -3.15149435e-01]
 [-1.09289782e-01 -1.68541529e-02  1.40174999e-01]
 [-1.75121883e-02  2.04408234e-01 -8.22870491e-02]
 [ 7.02038637e-02 -1.76265897e-01 -2.42392131e-01]
 [ 3.67394753e-02 -2.38480830e-02 -1.15549113e-02]
 [ 4.01164164e-02  3.06323231e-02 -7.66276330e-02]
 [ 9.83050161e-02 -9.50826845e-03  1.75450486e-01]
 [ 1.69200954e-01 -5.16844617e-02  2.26524836e-01]
 [-3.55019846e-02  2.52621132e-02 -1.09961709e-01]
 [-4.98571625e-02 -9.92565256e-03  4.55117144e-02]
 [-4.19513020e-02 -6.25933725e-02 -4.74328055e-02]
 [ 2.64243162e-02 -5.82603230e-02 -1.23936645e-01]
 [ 2.36933888e-01 -3.87623190e-02  4.54078464e-01]
 [-5.00054388e-03 -1.00937657e-01 -2.25487776e-01]
 [ 5.49299260e-02  2.23099585e-01 -8.97303461e-02]
 [ 2.74896397e-06 -3.88360796e-03  5.92984174e-02]
 [ 4.65372090e-01 -2.76991407e-01  3.00698818e-01]
 [-1.24623671e-01  5.38752896e-02  5.02427949e-02]
 [ 2.45852951e-01 -2.26719644e-02  7.67376483e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.32751058]
curr_Stock_Price:  100.36987577641041
curr_Factors:  [100.36987578  -1.03492619  -1.00942783]
mat_Sqrt:  [[12.99426498  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01217178 -0.03081225  0.04804447]
Stock Position:  -0.012171780404217318
Bond Position:  [6.54919066]


portfolio before change:  [5.33550696]
curr_Stock_Price:  99.78017700780875
curr_Factors:  [99.78017701 -0.95008511 -0.99062223]
mat_Sqrt:  [[14.32866667  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01439601  0.02115572 -0.57951079]
Stock Position:  -0.014396009328812114
Bond Position:  [6.77194332]


portfolio before change:  [5.3207181]
curr_Stock_Price:  100.8662700841041
curr_Factors:  [100.86627008  -1.07191749  -1.01391604]
mat_Sqrt:  [[12.52794882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00164339 0.00030885 0.15183326]
Stock Position:  0.0016433877990628652
Bond Position:  [5.1549557]


portfolio before change:  [5.32093872]
curr_Stock_Price:  100.60839416026282
curr_Factors:  [100.60839416  -1.03215739  -1.00633592]
mat_Sqrt:  [[13.10170505  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00320317 -0.00157747  0.21771553]
Stock Position:  0.003203169933383405
Bond Position:  [4.99867294]


portfolio before change:  [5.32266053]
curr_Stock_Price:  100.95084894987289
curr_Factors:  [100.95084895  -1.15555535  -1.02625096]
mat_Sqrt:  [[11.39104417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00818128 -0.04084672 -0.27544452]
Stock Position:  0.008181277629368041
Bond Position:  [4.49675361]


portfolio before change:  [5.32307932]
curr_Stock_Price:  100.93332836070942
curr_Factors:  [100.93332836  -0.99085343  -1.01951767]
mat_Sqrt:  [[13.51890521  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01133999 -0.05534923  0.15513819]
Stock Position:  -0.011339986021826023
Bond Position:  [6.46766185]


portfolio before change:  [5.31024678]
curr_Stock_Price:  102.13624435647701
curr_Factors:  [102.13624436  -0.84701199  -1.03191648]
mat_Sqrt:  [[15.60168899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00616898 -0.06115372 -0.07962849]
Stock Position:  -0.00616898228153203
Bond Position:  [5.94032346]


portfolio before change:  [5.30522716]
curr_Stock_Price:  103.07030544837511
curr_Factors:  [103.07030545  -0.84552153  -1.03680397]
mat_Sqrt:  [[15.69097688  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01014174 0.20838359 0.2825712 ]
Stock Position:  0.010141740828614037
Bond Position:  [4.25991483]


portfolio before change:  [5.29532945]
curr_Stock_Price:  102.0418592460372
curr_Factors:  [102.04185925  -0.80034895  -1.04477103]
mat_Sqrt:  [[16.12326292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03144737 0.01585393 1.15629706]
Stock Position:  0.03144737361979891
Bond Position:  [2.08638097]


portfolio before change:  [5.35400099]
curr_Stock_Price:  103.89927127430872
curr_Factors:  [103.89927127  -0.87362573  -1.05494016]
mat_Sqrt:  [[15.10243505  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06254576 0.1088244  1.92420349]
Stock Position:  0.06254575601285275
Bond Position:  [-1.14445748]


portfolio before change:  [5.4093785]
curr_Stock_Price:  104.78695058410278
curr_Factors:  [104.78695058  -1.04276954  -1.07027444]
mat_Sqrt:  [[12.66554434  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347207 -0.06090252 -0.09777595]
Stock Position:  -0.003472070483432298
Bond Position:  [5.77320618]


portfolio before change:  [5.41030215]
curr_Stock_Price:  104.7287848336873
curr_Factors:  [104.72878483  -1.01923622  -1.09900247]
mat_Sqrt:  [[12.59292715  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00777615 -0.00758888  0.22769475]
Stock Position:  -0.007776149718836204
Bond Position:  [6.22468886]


portfolio before change:  [5.41176645]
curr_Stock_Price:  104.64054542873292
curr_Factors:  [104.64054543  -0.95850004  -1.11394321]
mat_Sqrt:  [[13.17192736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00166264 -0.03184629  0.36096862]
Stock Position:  0.0016626354326714826
Bond Position:  [5.23778737]


portfolio before change:  [5.41225456]
curr_Stock_Price:  104.54031281994527
curr_Factors:  [104.54031282  -0.80622432  -1.10217409]
mat_Sqrt:  [[15.50518308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071981  0.05515495 -0.34520247]
Stock Position:  0.0007198105394582884
Bond Position:  [5.33700534]


portfolio before change:  [5.41339169]
curr_Stock_Price:  105.19320291086116
curr_Factors:  [105.19320291  -0.91170952  -1.09899944]
mat_Sqrt:  [[14.08470891  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03371781 -0.04666755 -0.72358954]
Stock Position:  0.033717814208466056
Bond Position:  [1.86650681]


portfolio before change:  [5.42983628]
curr_Stock_Price:  105.67399513790022
curr_Factors:  [105.67399514  -1.05536226  -1.12707404]
mat_Sqrt:  [[11.91648257  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01478881 -0.03049431  0.32029679]
Stock Position:  -0.014788810651530388
Bond Position:  [6.99262898]


portfolio before change:  [5.44119415]
curr_Stock_Price:  104.96509866706656
curr_Factors:  [104.96509867  -1.05239544  -1.16600283]
mat_Sqrt:  [[11.41844039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00442568  0.00456274 -0.05250411]
Stock Position:  0.004425678897902724
Bond Position:  [4.97665232]


portfolio before change:  [5.44482581]
curr_Stock_Price:  105.64511726943459
curr_Factors:  [105.64511727  -1.21229586  -1.18596626]
mat_Sqrt:  [[ 9.60057898  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00724085 -0.02041834  0.06387315]
Stock Position:  -0.007240845473206422
Bond Position:  [6.20978578]


portfolio before change:  [5.44427827]
curr_Stock_Price:  105.82794333576803
curr_Factors:  [105.82794334  -1.4332828   -1.20271302]
mat_Sqrt:  [[ 7.58231665  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02221429 -0.08349774  0.23293151]
Stock Position:  0.02221429486122358
Bond Position:  [3.09338513]


portfolio before change:  [5.45013614]
curr_Stock_Price:  106.07423415240349
curr_Factors:  [106.07423415  -1.61275803  -1.22253366]
mat_Sqrt:  [[ 6.22670611  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.64927063e-02 4.68534868e-04 1.33148372e+00]
Stock Position:  0.026492706264082143
Bond Position:  [2.63994261]


portfolio before change:  [5.45701073]
curr_Stock_Price:  106.32126734201466
curr_Factors:  [106.32126734  -1.52687352  -1.25839346]
mat_Sqrt:  [[ 6.56136297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184168  0.10729646 -0.89903362]
Stock Position:  -0.0018416755587090492
Bond Position:  [5.65282001]


portfolio before change:  [5.45803744]
curr_Stock_Price:  106.14748071507401
curr_Factors:  [106.14748072  -1.56746072  -1.27816077]
mat_Sqrt:  [[ 6.16697207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01363992 -0.00543965  0.39988026]
Stock Position:  -0.013639922294119014
Bond Position:  [6.90588083]


portfolio before change:  [5.46268126]
curr_Stock_Price:  105.87031394459048
curr_Factors:  [105.87031394  -1.76228419  -1.26740373]
mat_Sqrt:  [[ 5.11678839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144929  0.06597247 -0.23474205]
Stock Position:  0.0014492868678878082
Bond Position:  [5.3092448]


portfolio before change:  [5.46304023]
curr_Stock_Price:  105.66005128872378
curr_Factors:  [105.66005129  -1.6950887   -1.26415457]
mat_Sqrt:  [[ 5.47933422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00278398 -0.05688957 -0.69147728]
Stock Position:  -0.002783978487498728
Bond Position:  [5.75719554]


portfolio before change:  [5.46271655]
curr_Stock_Price:  106.03482685912383
curr_Factors:  [106.03482686  -1.70258542  -1.26377582]
mat_Sqrt:  [[ 5.45976832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00540552 -0.00769694 -0.03296295]
Stock Position:  0.00540551679424603
Bond Position:  [4.88954352]


portfolio before change:  [5.46807886]
curr_Stock_Price:  106.91375788774802
curr_Factors:  [106.91375789  -1.73240319  -1.25237642]
mat_Sqrt:  [[ 5.40455924  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00568551  0.00988654 -0.21859731]
Stock Position:  0.005685507686672235
Bond Position:  [4.86021987]


portfolio before change:  [5.46909371]
curr_Stock_Price:  106.98539330866575
curr_Factors:  [106.98539331  -2.07385237  -1.2381912 ]
mat_Sqrt:  [[ 3.89872174  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03390286 -0.00306878  0.5005114 ]
Stock Position:  0.03390286310143169
Bond Position:  [1.84198257]


portfolio before change:  [5.47450107]
curr_Stock_Price:  107.13809719493604
curr_Factors:  [107.13809719  -2.19080503  -1.2150696 ]
mat_Sqrt:  [[ 3.55460518  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05764075 -0.01668109  0.64621231]
Stock Position:  0.057640746434445306
Bond Position:  [-0.70101882]


portfolio before change:  [5.45547092]
curr_Stock_Price:  106.80946646813632
curr_Factors:  [106.80946647  -2.15916311  -1.21321137]
mat_Sqrt:  [[ 3.66442736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0144064   0.00815331 -0.31369015]
Stock Position:  -0.014406402948876048
Bond Position:  [6.99421113]


portfolio before change:  [5.45190415]
curr_Stock_Price:  107.11773925257748
curr_Factors:  [107.11773925  -2.34447159  -1.21650625]
mat_Sqrt:  [[ 3.04332525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01399561 -0.00320349  0.12983225]
Stock Position:  -0.013995608302771148
Bond Position:  [6.95108207]


portfolio before change:  [5.4530379]
curr_Stock_Price:  107.09881772235687
curr_Factors:  [107.09881772  -2.17405058  -1.24158641]
mat_Sqrt:  [[ 3.51878213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01830471 -0.02020192 -0.13531259]
Stock Position:  -0.018304714268244628
Bond Position:  [7.41345116]


portfolio before change:  [5.45200428]
curr_Stock_Price:  107.20591362880992
curr_Factors:  [107.20591363  -2.1684829   -1.25108774]
mat_Sqrt:  [[ 3.50847255  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306871 -0.01880344 -0.35355675]
Stock Position:  -0.0030687098450770537
Bond Position:  [5.78098813]


portfolio before change:  [5.45322385]
curr_Stock_Price:  107.04399033665902
curr_Factors:  [107.04399034  -2.07636619  -1.25078253]
mat_Sqrt:  [[ 3.84237688  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08372681 -0.01251048  1.29535947]
Stock Position:  0.0837268055140575
Bond Position:  [-3.50922751]


portfolio before change:  [5.42321393]
curr_Stock_Price:  106.69080307773719
curr_Factors:  [106.69080308  -1.73889819  -1.23254927]
mat_Sqrt:  [[ 5.46567435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01310577 -0.03257749 -0.64325386]
Stock Position:  -0.013105767340046861
Bond Position:  [6.82147877]


portfolio before change:  [5.42870524]
curr_Stock_Price:  106.33686928282894
curr_Factors:  [106.33686928  -1.47602641  -1.23104418]
mat_Sqrt:  [[ 7.09607258  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01157736  0.07200508 -0.2559757 ]
Stock Position:  0.011577362950801235
Bond Position:  [4.19760471]


portfolio before change:  [5.43190205]
curr_Stock_Price:  106.56767146090498
curr_Factors:  [106.56767146  -1.30207915  -1.25675023]
mat_Sqrt:  [[ 8.24783562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00137178 -0.00125343  0.16916188]
Stock Position:  0.0013717840775168163
Bond Position:  [5.28571422]


portfolio before change:  [5.43253696]
curr_Stock_Price:  106.5488254260749
curr_Factors:  [106.54882543  -1.17423417  -1.2702779 ]
mat_Sqrt:  [[ 9.24507765  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05086072 -0.08939859  0.85781003]
Stock Position:  0.05086072422738826
Bond Position:  [0.01338653]


portfolio before change:  [5.4447362]
curr_Stock_Price:  106.78864831896756
curr_Factors:  [106.78864832  -1.33161613  -1.26128373]
mat_Sqrt:  [[ 7.98809073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0129406   0.01738817  0.14332871]
Stock Position:  -0.012940596155608523
Bond Position:  [6.82664497]


portfolio before change:  [5.44405345]
curr_Stock_Price:  106.90735441497078
curr_Factors:  [106.90735441  -1.28321436  -1.27732069]
mat_Sqrt:  [[ 8.26002461  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03110028 -0.00731735  0.21891115]
Stock Position:  0.031100278178160013
Bond Position:  [2.11920499]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.43915832]
Stock Price:  106.74143783590237
PL:  [-1.30227952]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-8.56612485e-02 -8.83061591e-02  1.46376267e-02]
 [-3.06816448e-02  3.46290245e-02  2.47079330e-03]
 [-2.03731457e-01 -3.18026831e-02 -1.39630727e-01]
 [-1.90603333e-01 -8.12939304e-02 -8.99288827e-02]
 [ 1.68552844e-01 -1.76545610e-01 -1.04401982e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.37943589e-02 -1.41981898e-01 -1.18198000e-02]
 [ 2.96348256e-03  6.46914707e-01  1.07034979e-01]
 [ 7.22730720e-01  1.77143935e-01  6.58595927e-01]
 [ 1.05617272e+00  5.06809636e-01  1.06242871e+00]
 [ 7.87355389e-02 -2.49207720e-01 -1.08507176e-01]
 [-1.14731556e-01 -3.74099987e-02  8.56407376e-02]
 [ 1.10842027e-02 -9.09933984e-02  1.20937973e-01]
 [ 1.47701088e-03  2.10713423e-02 -6.65787587e-02]
 [ 8.34558306e-01 -2.32464825e-01 -4.16367099e-01]
 [-1.57830284e-01 -9.33218838e-02  1.07825879e-01]
 [ 6.25795558e-02 -3.24547769e-02  5.65938464e-04]
 [-6.29377479e-02 -6.49185388e-02  1.55114722e-02]
 [ 2.10747587e-01 -2.67471577e-01  8.93952824e-02]
 [ 5.20159340e-02 -5.83709202e-04  4.09466289e-01]
 [-3.82118773e-02  5.17280299e-01 -4.98991030e-01]
 [ 2.31193264e-01  1.46065836e-01  8.47297348e-02]
 [-9.72819974e-02  1.81659713e-01 -8.48890984e-02]
 [ 1.88491534e-03 -1.47558247e-01 -1.28314144e-01]
 [ 3.25459196e-02 -2.40063162e-02 -1.11640269e-02]
 [ 9.13513498e-03  2.20032700e-02 -1.07865981e-02]
 [ 9.30549542e-02 -1.65785423e-02  1.24382492e-01]
 [ 1.69200954e-01 -5.16844617e-02  2.26524836e-01]
 [-3.98722315e-02  7.07458068e-03 -7.48505580e-02]
 [-5.66836138e-02 -1.32594092e-02  4.23177298e-02]
 [-4.17994839e-02 -5.99932050e-02 -4.05402020e-02]
 [ 2.63906061e-02 -5.43505334e-02 -1.17708391e-01]
 [ 1.63678262e-01 -1.90497898e-02  3.07523720e-01]
 [-4.07036192e-03 -9.91586900e-02 -2.13172189e-01]
 [ 5.75055483e-02  2.35829016e-01 -9.79576298e-02]
 [-1.63491796e-02 -1.49047654e-02  3.61065830e-02]
 [ 4.65249731e-01 -2.76410507e-01  2.96355410e-01]
 [-1.31803740e-01  6.37917886e-02  5.18277417e-02]
 [ 2.71171339e-01 -2.78696758e-02  6.92851803e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.4744385]
curr_Stock_Price:  100.13625444836016
curr_Factors:  [100.13625445  -0.9536456   -0.99914603]
mat_Sqrt:  [[14.20707644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00708793 -0.02850069  0.04175707]
Stock Position:  -0.00708793080011409
Bond Position:  [4.18419734]


portfolio before change:  [3.46451404]
curr_Stock_Price:  101.61024093203153
curr_Factors:  [101.61024093  -0.99454367  -0.97945876]
mat_Sqrt:  [[14.11364273  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00163733  0.01117647  0.00704849]
Stock Position:  -0.0016373289778559902
Bond Position:  [3.63088343]


portfolio before change:  [3.46392874]
curr_Stock_Price:  102.2449224107271
curr_Factors:  [102.24492241  -0.96486992  -0.96870154]
mat_Sqrt:  [[14.78775798  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01614343 -0.01026427 -0.3983276 ]
Stock Position:  -0.01614343134526461
Bond Position:  [5.11451263]


portfolio before change:  [3.47548882]
curr_Stock_Price:  101.56844163529105
curr_Factors:  [101.56844164  -0.83358631  -0.99788957]
mat_Sqrt:  [[16.26892747  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0138641  -0.0262375  -0.25654207]
Stock Position:  -0.013864100368522468
Bond Position:  [4.88364389]


portfolio before change:  [3.47727016]
curr_Stock_Price:  101.48398981850771
curr_Factors:  [101.48398982  -0.85024023  -0.96332611]
mat_Sqrt:  [[16.54914939  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00671966 -0.05697985 -0.2978298 ]
Stock Position:  0.006719660004873651
Bond Position:  [2.79533225]


portfolio before change:  [3.47471359]
curr_Stock_Price:  101.05152535340495
curr_Factors:  [101.05152535  -0.88385065  -0.94407633]
mat_Sqrt:  [[16.24367423  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00943778 -0.05534923  0.15513819]
Stock Position:  -0.009437778297190237
Bond Position:  [4.42841548]


portfolio before change:  [3.47570762]
curr_Stock_Price:  101.00485662245117
curr_Factors:  [101.00485662  -0.41992153  -0.96065114]
mat_Sqrt:  [[25.39610777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00335441 -0.04582446 -0.0337186 ]
Stock Position:  -0.0033544116203143583
Bond Position:  [3.81451949]


portfolio before change:  [3.46729771]
curr_Stock_Price:  103.65412971880708
curr_Factors:  [103.65412972  -0.28536068  -0.98381834]
mat_Sqrt:  [[29.13326533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00538432 0.20879082 0.305341  ]
Stock Position:  0.005384319816349893
Bond Position:  [2.90919073]


portfolio before change:  [3.4742255]
curr_Stock_Price:  104.87324705293615
curr_Factors:  [104.87324705  -0.40403987  -1.01889617]
mat_Sqrt:  [[25.27501635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03534421 0.05717296 1.87879086]
Stock Position:  0.03534420680868616
Bond Position:  [-0.23243623]


portfolio before change:  [3.54268142]
curr_Stock_Price:  106.81090476038659
curr_Factors:  [106.81090476  -0.51944433  -1.03607347]
mat_Sqrt:  [[22.54565201  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06105355 0.16357211 3.03081339]
Stock Position:  0.06105355294064998
Bond Position:  [-2.97850381]


portfolio before change:  [3.52018429]
curr_Stock_Price:  106.44852139835007
curr_Factors:  [106.4485214   -0.49729413  -1.04574679]
mat_Sqrt:  [[22.7512611   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.51295582e-04 -8.04314458e-02 -3.09540771e-01]
Stock Position:  0.00025129558200161445
Bond Position:  [3.49343425]


portfolio before change:  [3.52076766]
curr_Stock_Price:  107.0321191532579
curr_Factors:  [107.03211915  -0.62445133  -1.03788863]
mat_Sqrt:  [[20.30341329  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00516595 -0.01207403  0.24430919]
Stock Position:  -0.005165953918181772
Bond Position:  [4.07369065]


portfolio before change:  [3.51300122]
curr_Stock_Price:  108.63408390702581
curr_Factors:  [108.63408391  -0.81427616  -1.05562002]
mat_Sqrt:  [[16.74482101  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00102698 -0.02936799  0.34500237]
Stock Position:  0.0010269810155587532
Bond Position:  [3.40143608]


portfolio before change:  [3.51368541]
curr_Stock_Price:  108.8862580527827
curr_Factors:  [108.88625805  -0.69275435  -1.04493119]
mat_Sqrt:  [[19.15604433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00040782  0.00680075 -0.18993067]
Stock Position:  -0.000407816532791187
Bond Position:  [3.55809102]


portfolio before change:  [3.5142827]
curr_Stock_Price:  108.51230425402623
curr_Factors:  [108.51230425  -0.65703809  -1.0783259 ]
mat_Sqrt:  [[19.13462626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03669348 -0.0750277  -1.18777944]
Stock Position:  0.03669348092127603
Bond Position:  [-0.46741147]


portfolio before change:  [3.44805286]
curr_Stock_Price:  106.70894832092507
curr_Factors:  [106.70894832  -0.72873823  -1.06677287]
mat_Sqrt:  [[17.71822765  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0087407  -0.03011951  0.30759722]
Stock Position:  -0.008740697535204562
Bond Position:  [4.38076351]


portfolio before change:  [3.43685292]
curr_Stock_Price:  108.05295674438116
curr_Factors:  [108.05295674  -0.6210487   -1.0640473 ]
mat_Sqrt:  [[20.03589563  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00279849 -0.01047473  0.00161446]
Stock Position:  0.0027984910147143206
Bond Position:  [3.13446769]


portfolio before change:  [3.43556871]
curr_Stock_Price:  107.4540466310313
curr_Factors:  [107.45404663  -0.66082623  -1.08913393]
mat_Sqrt:  [[18.6734574   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00391052 -0.02095237  0.04424991]
Stock Position:  -0.003910519703308254
Bond Position:  [3.85576988]


portfolio before change:  [3.44089423]
curr_Stock_Price:  106.21546088286661
curr_Factors:  [106.21546088  -0.61294221  -1.0992048 ]
mat_Sqrt:  [[19.16954201  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00909766 -0.08632608  0.25501986]
Stock Position:  0.0090976568570104
Bond Position:  [2.47458241]


portfolio before change:  [3.43702756]
curr_Stock_Price:  105.75644020661184
curr_Factors:  [105.75644021  -0.75045632  -1.10233496]
mat_Sqrt:  [[16.58249208  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.16998678e-03 -1.88391335e-04  1.16809335e+00]
Stock Position:  0.008169986775441965
Bond Position:  [2.57299884]


portfolio before change:  [3.438048]
curr_Stock_Price:  105.84197238764314
curr_Factors:  [105.84197239  -0.73955368  -1.08746172]
mat_Sqrt:  [[17.02923804  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202467  0.1669515  -1.42348252]
Stock Position:  -0.002024670510262325
Bond Position:  [3.65234312]


portfolio before change:  [3.4381057]
curr_Stock_Price:  106.03897781175026
curr_Factors:  [106.03897781  -0.87526738  -1.0876556 ]
mat_Sqrt:  [[14.89288766  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01868706 0.04714255 0.24171035]
Stock Position:  0.01868705514291377
Bond Position:  [1.45654947]


portfolio before change:  [3.43620706]
curr_Stock_Price:  105.92763222482806
curr_Factors:  [105.92763222  -0.85639272  -1.09380989]
mat_Sqrt:  [[15.06770232  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00514536  0.05863042 -0.24216497]
Stock Position:  -0.005145361699416852
Bond Position:  [3.98124304]


portfolio before change:  [3.43699681]
curr_Stock_Price:  105.870869767059
curr_Factors:  [105.87086977  -0.97275072  -1.08641238]
mat_Sqrt:  [[13.50496014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00403017 -0.04762422 -0.36604454]
Stock Position:  -0.00403017113963023
Bond Position:  [3.86367453]


portfolio before change:  [3.44017154]
curr_Stock_Price:  105.20297061638918
curr_Factors:  [105.20297062  -1.20094512  -1.09035104]
mat_Sqrt:  [[10.63973292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00238416 -0.00774801 -0.03184786]
Stock Position:  0.0023841579051811107
Bond Position:  [3.18935105]


portfolio before change:  [3.44059259]
curr_Stock_Price:  105.21234731486464
curr_Factors:  [105.21234731  -1.35432498  -1.11405088]
mat_Sqrt:  [[ 8.91383713  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00128168  0.00710152 -0.03077116]
Stock Position:  0.0012816846881181067
Bond Position:  [3.30574354]


portfolio before change:  [3.44176355]
curr_Stock_Price:  105.8035323078398
curr_Factors:  [105.80353231  -1.4448206   -1.14611715]
mat_Sqrt:  [[ 7.92994541  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0145096  -0.0053507   0.35482863]
Stock Position:  0.014509600918188903
Bond Position:  [1.90659652]


portfolio before change:  [3.43949632]
curr_Stock_Price:  105.63084895850716
curr_Factors:  [105.63084896  -1.26545339  -1.18065273]
mat_Sqrt:  [[ 9.15082772  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02239033 -0.01668109  0.64621231]
Stock Position:  0.02239033476782315
Bond Position:  [1.07438625]


portfolio before change:  [3.4299161]
curr_Stock_Price:  105.19697721656215
curr_Factors:  [105.19697722  -1.34040566  -1.15556215]
mat_Sqrt:  [[ 8.66998239  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00619459  0.00228331 -0.21352781]
Stock Position:  -0.006194585232459678
Bond Position:  [4.08156774]


portfolio before change:  [3.42919461]
curr_Stock_Price:  105.39581505330959
curr_Factors:  [105.39581505  -1.41888606  -1.15870804]
mat_Sqrt:  [[ 8.0055002   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00633965 -0.00427946  0.1207207 ]
Stock Position:  -0.006339654949064026
Bond Position:  [4.09736771]


portfolio before change:  [3.43092351]
curr_Stock_Price:  105.20389581736033
curr_Factors:  [105.20389582  -1.32798491  -1.172063  ]
mat_Sqrt:  [[ 8.63524793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00721702 -0.01936272 -0.11564991]
Stock Position:  -0.007217022628875699
Bond Position:  [4.19018241]


portfolio before change:  [3.4274305]
curr_Stock_Price:  105.76047151886497
curr_Factors:  [105.76047152  -1.55801178  -1.1921511 ]
mat_Sqrt:  [[ 6.75993958  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00129155 -0.01754156 -0.33578928]
Stock Position:  -0.0012915462702333127
Bond Position:  [3.56402504]


portfolio before change:  [3.42767625]
curr_Stock_Price:  105.91515230088773
curr_Factors:  [105.9151523   -1.66305772  -1.17578414]
mat_Sqrt:  [[ 6.19533422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03592425 -0.00614829  0.87727958]
Stock Position:  0.03592425336925824
Bond Position:  [-0.37724652]


portfolio before change:  [3.44691978]
curr_Stock_Price:  106.45213447486347
curr_Factors:  [106.45213447  -1.78702043  -1.20263992]
mat_Sqrt:  [[ 5.3550235   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01266561 -0.03200333 -0.60812092]
Stock Position:  -0.012665609345658356
Bond Position:  [4.79520092]


portfolio before change:  [3.44572246]
curr_Stock_Price:  106.59399548332108
curr_Factors:  [106.59399548  -1.40833534  -1.21140546]
mat_Sqrt:  [[ 7.76235975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01103381  0.07611349 -0.27944585]
Stock Position:  0.011033813158457573
Bond Position:  [2.26958423]


portfolio before change:  [3.45052517]
curr_Stock_Price:  107.00355419557695
curr_Factors:  [107.0035542   -1.29472129  -1.21704528]
mat_Sqrt:  [[ 8.68064194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138485 -0.00481049  0.10300203]
Stock Position:  -0.0013848488173286448
Bond Position:  [3.59870891]


portfolio before change:  [3.4516456]
curr_Stock_Price:  106.51934116857159
curr_Factors:  [106.51934117  -1.22989752  -1.22736374]
mat_Sqrt:  [[ 9.12543267  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05143    -0.08921111  0.8454195 ]
Stock Position:  0.05142999620902161
Bond Position:  [-2.02664372]


portfolio before change:  [3.51321293]
curr_Stock_Price:  107.7213766483445
curr_Factors:  [107.72137665  -1.24038627  -1.2009883 ]
mat_Sqrt:  [[ 9.37618986  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01154019  0.02058871  0.14785012]
Stock Position:  -0.011540188931523745
Bond Position:  [4.75633797]


portfolio before change:  [3.5148005]
curr_Stock_Price:  107.63533033601584
curr_Factors:  [107.63533034  -1.3093471   -1.22674043]
mat_Sqrt:  [[ 8.52208824  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03281182 -0.0089949   0.19765133]
Stock Position:  0.03281182210292509
Bond Position:  [-0.01691081]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.53325067]
Stock Price:  108.19769723784178
PL:  [-4.66444657]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 3.64824136e-02 -7.28098394e-02  9.86893452e-03]
 [-2.36886276e-01  1.02114899e-01 -4.08331943e-01]
 [-3.41509193e-02  4.27528233e-02  2.23005984e-02]
 [ 1.21330240e-01  2.94751591e-02  1.47392296e-01]
 [-5.96369019e-02  1.79075844e-01 -4.39417576e-02]
 [-7.62226847e-02 -1.54121576e-01  1.44819123e-01]
 [-5.88845775e-02 -1.85910841e-01  9.83823631e-02]
 [ 1.24953943e-02  7.06255216e-01  9.67775210e-02]
 [ 2.78912470e-01 -7.48176554e-03  2.88157970e-01]
 [ 5.27599635e-01  2.24627052e-01  4.16835588e-01]
 [-2.17590321e-01 -2.35331456e-01  2.02369025e-02]
 [-6.15573898e-03 -1.58240372e-02  1.02317840e-01]
 [ 9.90994762e-03 -5.96091059e-02  1.14108976e-01]
 [ 1.04495442e-02 -1.06429012e-01 -2.78411908e-02]
 [-1.16163223e-02  4.59627869e-02 -5.86864312e-02]
 [-6.66027508e-02 -5.11970901e-02  8.47354057e-02]
 [ 4.58349160e-02  2.70217217e-02  5.00315853e-03]
 [-3.79842423e-02 -4.95472772e-02  5.54070183e-02]
 [ 1.05360860e-01 -9.14166466e-02 -5.00062504e-02]
 [ 4.72664459e-02 -1.19137057e-02  1.91326924e-01]
 [-1.90416149e-02  3.64500233e-01 -3.46273259e-01]
 [ 1.63062434e-01  1.13465464e-01  9.58243603e-02]
 [ 2.16194389e-02  1.58973578e-01 -4.55394484e-02]
 [ 8.55540982e-02 -1.75927021e-01 -2.68923842e-01]
 [ 6.38867332e-02  2.97520448e-02 -1.49120994e-02]
 [-1.62111909e-02  1.47400146e-02  4.65129464e-02]
 [ 6.72353544e-02 -3.21250558e-02  2.64291600e-02]
 [ 1.47996208e-01 -6.94369943e-02  9.67601205e-02]
 [-4.75591825e-02 -2.49159854e-02 -1.30925603e-02]
 [-6.26195738e-02 -1.26976293e-02  3.33820806e-02]
 [-2.59642819e-02 -4.22263705e-02 -9.41707702e-03]
 [ 2.92316416e-02  6.27335713e-03 -4.63444251e-02]
 [-4.17175679e-02  1.84542965e-02 -1.88127361e-02]
 [ 1.11339937e-02 -7.01916248e-02 -1.30599302e-02]
 [-3.63881088e-02  6.41665874e-02  3.35907524e-02]
 [ 8.97304600e-02 -3.90481389e-03  1.59658877e-01]
 [-4.09913578e-02  1.00261160e-01  5.81209994e-02]
 [ 1.15468554e-01 -1.04003132e-01 -1.20790387e-01]
 [ 9.75594056e-02  3.92541840e-03  6.81522045e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.33596811]
curr_Stock_Price:  99.86665225857362
curr_Factors:  [99.86665226 -1.20079794 -1.0064151 ]
mat_Sqrt:  [[10.98601155  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00215134 -0.02349927  0.02815332]
Stock Position:  0.002151340833039318
Bond Position:  [1.12112091]


portfolio before change:  [1.33577967]
curr_Stock_Price:  99.71391361713452
curr_Factors:  [99.71391362 -1.185664   -1.00339678]
mat_Sqrt:  [[11.17014331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02680293  0.03295744 -1.16485738]
Stock Position:  -0.026802929886668964
Bond Position:  [4.0084047]


portfolio before change:  [1.33352656]
curr_Stock_Price:  99.81667070915542
curr_Factors:  [99.81667071 -0.87086923 -0.99943961]
mat_Sqrt:  [[15.3793604   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00135714  0.01379841  0.0636174 ]
Stock Position:  -0.0013571400053086283
Bond Position:  [1.46899176]


portfolio before change:  [1.33344539]
curr_Stock_Price:  100.01178745000676
curr_Factors:  [100.01178745  -0.98632363  -1.03740767]
mat_Sqrt:  [[13.21769886  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01191078 0.00951307 0.42046919]
Stock Position:  0.011910784168508427
Bond Position:  [0.14222658]


portfolio before change:  [1.32126873]
curr_Stock_Price:  98.98797201352987
curr_Factors:  [98.98797201 -0.90147507 -1.02063592]
mat_Sqrt:  [[14.48172271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221333  0.05779648 -0.1253536 ]
Stock Position:  -0.0022133259060883948
Bond Position:  [1.54036137]


portfolio before change:  [1.32045431]
curr_Stock_Price:  99.44293331917993
curr_Factors:  [99.44293332 -0.89430414 -1.03578518]
mat_Sqrt:  [[14.4326733   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00541283 -0.04974252  0.41312865]
Stock Position:  -0.005412825366884759
Bond Position:  [1.85872154]


portfolio before change:  [1.31668205]
curr_Stock_Price:  100.18277130135723
curr_Factors:  [100.1827713   -0.83248161  -1.03125151]
mat_Sqrt:  [[15.53760343  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00493971 -0.06000247  0.2806575 ]
Stock Position:  -0.004939709879213756
Bond Position:  [1.81155588]


portfolio before change:  [1.31565834]
curr_Stock_Price:  100.4358574083661
curr_Factors:  [100.43585741  -0.84079951  -0.98785647]
mat_Sqrt:  [[16.1329427   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.010935   0.22794289 0.27607933]
Stock Position:  0.01093500228863104
Bond Position:  [0.21739201]


portfolio before change:  [1.31894795]
curr_Stock_Price:  100.73420560979423
curr_Factors:  [100.73420561  -0.90134649  -0.99610619]
mat_Sqrt:  [[15.10510456  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02225772 -0.00241473  0.82203448]
Stock Position:  0.02225772479996555
Bond Position:  [-0.92316628]


portfolio before change:  [1.34192425]
curr_Stock_Price:  101.7716747109376
curr_Factors:  [101.77167471  -1.13745033  -0.95358606]
mat_Sqrt:  [[12.57480784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0523696  0.07249807 1.18911591]
Stock Position:  0.05236959931356693
Bond Position:  [-3.98781758]


portfolio before change:  [1.34735943]
curr_Stock_Price:  101.88497877043142
curr_Factors:  [101.88497877  -1.21892982  -0.95649094]
mat_Sqrt:  [[11.57009508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02260105 -0.0759529   0.05773025]
Stock Position:  -0.022601051304773485
Bond Position:  [3.65006706]


portfolio before change:  [1.34782027]
curr_Stock_Price:  101.88477718363674
curr_Factors:  [101.88477718  -1.06464564  -0.98222585]
mat_Sqrt:  [[13.15722518  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00087402 -0.00510719  0.29188432]
Stock Position:  0.0008740243079900662
Bond Position:  [1.2587705]


portfolio before change:  [1.34701924]
curr_Stock_Price:  100.78825630846906
curr_Factors:  [100.78825631  -0.80639885  -0.99876643]
mat_Sqrt:  [[16.574354    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00126911 -0.01923876  0.32552115]
Stock Position:  0.0012691105230207096
Bond Position:  [1.21910781]


portfolio before change:  [1.34564124]
curr_Stock_Price:  99.58237185267336
curr_Factors:  [99.58237185 -0.67678314 -1.00446798]
mat_Sqrt:  [[18.53635687  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00091486 -0.03434982 -0.07942317]
Stock Position:  -0.000914864026986612
Bond Position:  [1.43674557]


portfolio before change:  [1.34600212]
curr_Stock_Price:  99.38422618878292
curr_Factors:  [99.38422619 -0.6293315  -0.99268663]
mat_Sqrt:  [[19.62835642  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072413  0.01483443 -0.16741605]
Stock Position:  -0.0007241322219755431
Bond Position:  [1.41796944]


portfolio before change:  [1.34506404]
curr_Stock_Price:  100.92446479498844
curr_Factors:  [100.92446479  -0.86954478  -0.96723103]
mat_Sqrt:  [[16.08032638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00371614 -0.01652379  0.24172653]
Stock Position:  -0.0037161416652382023
Bond Position:  [1.72011365]


portfolio before change:  [1.34703972]
curr_Stock_Price:  100.45067961721094
curr_Factors:  [100.45067962  -1.26696401  -0.98086474]
mat_Sqrt:  [[10.61043669  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00493589 0.00872122 0.01427262]
Stock Position:  0.004935891785430118
Bond Position:  [0.85122604]


portfolio before change:  [1.35206696]
curr_Stock_Price:  101.44762780444829
curr_Factors:  [101.4476278   -1.31410485  -0.95123116]
mat_Sqrt:  [[10.52977204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00349372 -0.01599131  0.1580608 ]
Stock Position:  -0.0034937249835299937
Bond Position:  [1.70649707]


portfolio before change:  [1.34939729]
curr_Stock_Price:  102.27282158779373
curr_Factors:  [102.27282159  -1.38628726  -0.99055759]
mat_Sqrt:  [[ 9.49532068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00805587 -0.0295046  -0.14265391]
Stock Position:  0.008055866083421235
Bond Position:  [0.52550113]


portfolio before change:  [1.35299364]
curr_Stock_Price:  102.71109430637709
curr_Factors:  [102.71109431  -1.36086621  -0.98612537]
mat_Sqrt:  [[ 9.82498427  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00853834 -0.00384513  0.54580246]
Stock Position:  0.008538335876980717
Bond Position:  [0.47601182]


portfolio before change:  [1.35903824]
curr_Stock_Price:  103.41206096173221
curr_Factors:  [103.41206096  -1.48403864  -0.993524  ]
mat_Sqrt:  [[ 8.681193    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176486  0.11764194 -0.98782122]
Stock Position:  -0.0017648552888227722
Bond Position:  [1.54154556]


portfolio before change:  [1.35826516]
curr_Stock_Price:  103.95929183965187
curr_Factors:  [103.95929184  -1.5983273   -0.97758901]
mat_Sqrt:  [[ 7.90964651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02601678 0.03662082 0.27336023]
Stock Position:  0.026016780992485673
Bond Position:  [-1.34642097]


portfolio before change:  [1.35508304]
curr_Stock_Price:  103.84345107142232
curr_Factors:  [103.84345107  -1.45376358  -0.98474321]
mat_Sqrt:  [[ 9.06460889  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00493944  0.0513085  -0.12991137]
Stock Position:  0.004939439097477413
Bond Position:  [0.84215464]


portfolio before change:  [1.35361679]
curr_Stock_Price:  103.52529252974574
curr_Factors:  [103.52529253  -1.4503354   -0.99786769]
mat_Sqrt:  [[ 8.94963599  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.86694690e-04 -5.67802019e-02 -7.67164867e-01]
Stock Position:  -0.0005866946896783075
Bond Position:  [1.41435453]


portfolio before change:  [1.35413563]
curr_Stock_Price:  102.94231225083419
curr_Factors:  [102.94231225  -1.76491048  -0.97682708]
mat_Sqrt:  [[ 6.63548128  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01008456  0.00960243 -0.04254007]
Stock Position:  0.010084562287947033
Bond Position:  [0.31600747]


portfolio before change:  [1.34916687]
curr_Stock_Price:  102.44568557051782
curr_Factors:  [102.44568557  -1.69815252  -0.98151856]
mat_Sqrt:  [[ 7.02631007  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052773  0.00475732  0.13268849]
Stock Position:  -0.0005277282924717074
Bond Position:  [1.40323036]


portfolio before change:  [1.34948914]
curr_Stock_Price:  102.16740140012872
curr_Factors:  [102.1674014   -1.57459555  -0.98976578]
mat_Sqrt:  [[ 7.86365353  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00840229 -0.01036832  0.07539504]
Stock Position:  0.008402288366492925
Bond Position:  [0.49104918]


portfolio before change:  [1.35320909]
curr_Stock_Price:  102.60282623259556
curr_Factors:  [102.60282623  -1.41054005  -0.99476876]
mat_Sqrt:  [[ 9.25863537  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01658706 -0.02241069  0.27602969]
Stock Position:  0.016587057532395453
Bond Position:  [-0.34866989]


portfolio before change:  [1.34647108]
curr_Stock_Price:  102.19923290807198
curr_Factors:  [102.19923291  -1.14490859  -0.99540758]
mat_Sqrt:  [[12.02043358  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460197 -0.0080416  -0.03734943]
Stock Position:  -0.004601967481744738
Bond Position:  [1.81678863]


portfolio before change:  [1.34662363]
curr_Stock_Price:  102.21543472577235
curr_Factors:  [102.21543473  -0.78253915  -1.00320845]
mat_Sqrt:  [[17.13863202  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00340735 -0.00409814  0.09522978]
Stock Position:  -0.0034073535017802815
Bond Position:  [1.69490775]


portfolio before change:  [1.34905479]
curr_Stock_Price:  101.56411319991555
curr_Factors:  [101.5641132   -1.12699811  -0.98744611]
mat_Sqrt:  [[12.25882433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297793 -0.0136285  -0.0268643 ]
Stock Position:  -0.0029779329171211325
Bond Position:  [1.65150591]


portfolio before change:  [1.3510059]
curr_Stock_Price:  100.97825362632382
curr_Factors:  [100.97825363  -0.77533835  -0.98742772]
mat_Sqrt:  [[17.32480198  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00121515  0.00202472 -0.13220775]
Stock Position:  0.0012151463026801711
Bond Position:  [1.22830254]


portfolio before change:  [1.35068816]
curr_Stock_Price:  100.59040898648749
curr_Factors:  [100.59040899  -0.58218348  -1.00467897]
mat_Sqrt:  [[20.57742207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0020309  0.0059561 -0.0536675]
Stock Position:  -0.0020309023120230374
Bond Position:  [1.55497745]


portfolio before change:  [1.34940749]
curr_Stock_Price:  101.3167118264084
curr_Factors:  [101.31671183  -0.3693352   -1.00254739]
mat_Sqrt:  [[25.69685933  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00022803 -0.02265425 -0.03725635]
Stock Position:  -0.00022803015381418513
Bond Position:  [1.37251075]


portfolio before change:  [1.34959138]
curr_Stock_Price:  101.26270777348337
curr_Factors:  [101.26270777  -0.52271126  -0.97162852]
mat_Sqrt:  [[22.7230183   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072321  0.02070968  0.09582507]
Stock Position:  -0.0007232082958432592
Bond Position:  [1.42282541]


portfolio before change:  [1.35023788]
curr_Stock_Price:  100.61471227447241
curr_Factors:  [100.61471227  -0.42244248  -0.97325193]
mat_Sqrt:  [[24.91834007  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00487687 -0.00126027  0.45546234]
Stock Position:  0.0048768748121905195
Bond Position:  [0.85955252]


portfolio before change:  [1.33798042]
curr_Stock_Price:  98.07929631018796
curr_Factors:  [98.07929631 -0.46538592 -0.94824829]
mat_Sqrt:  [[23.85853674  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036305  0.03235915  0.16580303]
Stock Position:  -0.00036304552079660635
Bond Position:  [1.37358767]


portfolio before change:  [1.33859434]
curr_Stock_Price:  96.86123807613235
curr_Factors:  [96.86123808 -0.19321641 -0.94363947]
mat_Sqrt:  [[31.07561827  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00223914 -0.03356687 -0.34458135]
Stock Position:  0.0022391435127852915
Bond Position:  [1.12170813]


portfolio before change:  [1.34181133]
curr_Stock_Price:  98.23532060503271
curr_Factors:  [98.23532061 -0.18355686 -0.93829111]
mat_Sqrt:  [[31.99302332  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00350927 0.00126692 0.19441927]
Stock Position:  0.0035092709945278642
Bond Position:  [0.99707697]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.3396039]
Stock Price:  97.57077417826358
PL:  [1.3396039]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.19551614e-01 -6.22708816e-02  6.62577446e-03]
 [-1.95052083e-01  6.74902673e-02 -2.13483825e-01]
 [-4.45877655e-02  5.06524459e-02  1.57007033e-02]
 [ 3.28465458e-02  3.22836273e-03  7.80120208e-02]
 [ 1.45971630e-01 -1.35639217e-01 -9.73872785e-02]
 [-1.29677213e-01 -1.67559822e-01  7.66199937e-02]
 [-5.15062757e-02 -2.05228936e-01 -2.82952515e-02]
 [ 5.56196191e-03  7.14070986e-01  1.10256570e-01]
 [ 3.72569594e-01  3.19759989e-02  3.75466006e-01]
 [ 5.39423209e-01  2.35534861e-01  4.46108248e-01]
 [-9.15796910e-02 -1.58485226e-01  3.07389525e-02]
 [-3.60791615e-02 -2.02808007e-02  9.26877018e-02]
 [ 1.47875350e-02 -5.44592287e-02  5.80883410e-02]
 [ 2.46111106e-04  1.87497321e-01 -1.24923485e-01]
 [ 3.96468671e-01 -1.44706753e-01 -1.96636591e-01]
 [-2.17855740e-01 -9.40845595e-02  1.19654468e-01]
 [ 5.11018243e-02  1.75689267e-02 -2.58017538e-02]
 [-4.96715177e-02 -5.64605397e-02  3.87663716e-02]
 [ 8.77822308e-02 -5.83352331e-02 -7.50947258e-02]
 [ 3.19334552e-02 -1.37599315e-02  1.39844497e-01]
 [-4.18952554e-02  5.47505000e-01 -5.33373971e-01]
 [ 3.27121685e-01  1.91967262e-01  6.91084675e-02]
 [ 2.00512755e-02  1.45388958e-01 -4.06404461e-02]
 [ 1.22599725e-03 -1.53379922e-01 -1.19495041e-01]
 [ 3.96481138e-02 -3.63382006e-03 -1.21421780e-02]
 [-1.18640200e-02  1.62440623e-02  3.23303538e-02]
 [ 8.63252298e-02 -2.77157702e-02  4.23922309e-02]
 [ 1.65891232e-01 -5.44553479e-02  2.06270641e-01]
 [-3.84048307e-02  1.20126073e-02 -8.41675154e-02]
 [-6.10970172e-02 -2.87383930e-04  3.51444371e-02]
 [ 4.11729085e-02 -2.62503589e-02 -7.36924251e-03]
 [ 2.67502673e-02 -9.60651248e-02 -1.84159302e-01]
 [ 7.46152911e-02 -3.69078378e-03  1.38910849e-01]
 [-1.34462469e-02 -1.17090008e-01 -3.37308685e-01]
 [ 9.74560978e-02  4.12734444e-01 -1.87727893e-01]
 [-4.79265337e-02 -1.33365567e-02 -1.67586525e-02]
 [ 5.40976450e-01 -3.04029194e-01  4.08859596e-01]
 [-1.44926359e-01  7.49529015e-02  6.13684800e-02]
 [ 3.41526999e-01 -4.23132666e-02  4.85759899e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.58800538]
curr_Stock_Price:  99.62409221599644
curr_Factors:  [99.62409222 -0.99159692 -1.02088988]
mat_Sqrt:  [[13.31534635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00812544 -0.02009784  0.01890149]
Stock Position:  0.008125444252279566
Bond Position:  [-1.39749539]


portfolio before change:  [-0.58925079]
curr_Stock_Price:  99.49231956372837
curr_Factors:  [99.49231956 -0.84126964 -1.00650983]
mat_Sqrt:  [[15.67866663  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01434133  0.02178239 -0.60900993]
Stock Position:  -0.01434132751199685
Bond Position:  [0.83760115]


portfolio before change:  [-0.58888034]
curr_Stock_Price:  99.47378984688363
curr_Factors:  [99.47378985 -0.88372342 -0.99553776]
mat_Sqrt:  [[15.18993454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00204369  0.01634801  0.04478974]
Stock Position:  -0.0020436879140203566
Bond Position:  [-0.38558696]


portfolio before change:  [-0.59137237]
curr_Stock_Price:  100.66958384264984
curr_Factors:  [100.66958384  -0.95855696  -1.02001163]
mat_Sqrt:  [[13.91928258  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00355117 0.00104195 0.22254658]
Stock Position:  0.0035511650372072167
Bond Position:  [-0.94886668]


portfolio before change:  [-0.58969455]
curr_Stock_Price:  101.17545650910358
curr_Factors:  [101.17545651  -0.94565316  -1.04730355]
mat_Sqrt:  [[13.7893904   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0071363  -0.04377737 -0.2778188 ]
Stock Position:  0.007136304993558929
Bond Position:  [-1.31171347]


portfolio before change:  [-0.59421911]
curr_Stock_Price:  100.56441481598155
curr_Factors:  [100.56441482  -1.08178483  -1.06445631]
mat_Sqrt:  [[11.7582759   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01260731 -0.0540797   0.21857552]
Stock Position:  -0.012607309856097579
Bond Position:  [0.67362763]


portfolio before change:  [-0.61503749]
curr_Stock_Price:  102.22238853773186
curr_Factors:  [102.22238854  -1.35411346  -1.07308544]
mat_Sqrt:  [[ 9.02457874  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01098934 -0.06623735 -0.08071848]
Stock Position:  -0.01098934407428448
Bond Position:  [0.50831951]


portfolio before change:  [-0.61729304]
curr_Stock_Price:  102.43342057827051
curr_Factors:  [102.43342058  -1.37601305  -1.08975138]
mat_Sqrt:  [[ 8.7010926   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01997762 0.23046542 0.31453131]
Stock Position:  0.019977619803461896
Bond Position:  [-2.66366898]


portfolio before change:  [-0.61107399]
curr_Stock_Price:  102.76138907913257
curr_Factors:  [102.76138908  -1.2352675   -1.0968232 ]
mat_Sqrt:  [[ 9.97736456  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04567723 0.01032021 1.07110001]
Stock Position:  0.04567722689714381
Bond Position:  [-5.30492928]


portfolio before change:  [-0.62779294]
curr_Stock_Price:  102.40988379657477
curr_Factors:  [102.4098838   -1.26837797  -1.07561183]
mat_Sqrt:  [[ 9.82562167  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06906057 0.07601855 1.27262266]
Stock Position:  0.06906056932275051
Bond Position:  [-7.70027782]


portfolio before change:  [-0.6088025]
curr_Stock_Price:  102.698804522707
curr_Factors:  [102.69880452  -1.37605326  -1.0585594 ]
mat_Sqrt:  [[ 8.99966911  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01307335 -0.05115089  0.08768968]
Stock Position:  -0.013073346191617827
Bond Position:  [0.73381452]


portfolio before change:  [-0.60894035]
curr_Stock_Price:  102.71636501272764
curr_Factors:  [102.71636501  -1.35414452  -1.06304932]
mat_Sqrt:  [[ 9.15937195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0023254  -0.0065456   0.26441221]
Stock Position:  -0.002325395756070836
Bond Position:  [-0.37008415]


portfolio before change:  [-0.61201409]
curr_Stock_Price:  104.0182858806208
curr_Factors:  [104.01828588  -1.20149589  -1.05482528]
mat_Sqrt:  [[10.8943635   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00142535 -0.01757664  0.16570987]
Stock Position:  0.0014253539828622387
Bond Position:  [-0.76027697]


portfolio before change:  [-0.61303351]
curr_Stock_Price:  103.36976055193406
curr_Factors:  [103.36976055  -1.04534758  -1.04770931]
mat_Sqrt:  [[12.74648529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00102138  0.0605145  -0.35637193]
Stock Position:  0.0010213750389383232
Bond Position:  [-0.7186128]


portfolio before change:  [-0.61302232]
curr_Stock_Price:  103.46867214155998
curr_Factors:  [103.46867214  -0.89227037  -1.04587496]
mat_Sqrt:  [[14.89645933  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02193758 -0.0467039  -0.56094946]
Stock Position:  0.021937578947009165
Bond Position:  [-2.88287448]


portfolio before change:  [-0.63926486]
curr_Stock_Price:  102.28886281660438
curr_Factors:  [102.28886282  -0.85205179  -1.01415018]
mat_Sqrt:  [[15.82512435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01343663 -0.03036566  0.34134089]
Stock Position:  -0.01343662769432556
Bond Position:  [0.73515251]


portfolio before change:  [-0.63548063]
curr_Stock_Price:  102.01406711718779
curr_Factors:  [102.01406712  -0.74173293  -1.02377208]
mat_Sqrt:  [[17.45464333  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00283141  0.00567035 -0.07360522]
Stock Position:  0.002831413085966006
Bond Position:  [-0.92432459]


portfolio before change:  [-0.63198534]
curr_Stock_Price:  103.28934451340176
curr_Factors:  [103.28934451  -0.91040469  -1.0149381 ]
mat_Sqrt:  [[15.06224719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00353754 -0.01822256  0.11058967]
Stock Position:  -0.0035375415067887958
Bond Position:  [-0.266595]


portfolio before change:  [-0.62602896]
curr_Stock_Price:  101.59616187362109
curr_Factors:  [101.59616187  -0.82163397  -1.01368089]
mat_Sqrt:  [[16.21101422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00373487 -0.01882762 -0.21422435]
Stock Position:  0.003734865301074492
Bond Position:  [-1.00547694]


portfolio before change:  [-0.62313369]
curr_Stock_Price:  102.40501654992943
curr_Factors:  [102.40501655  -0.72619228  -1.00492318]
mat_Sqrt:  [[18.13457318  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00318013 -0.004441    0.39893742]
Stock Position:  0.0031801332579152733
Bond Position:  [-0.94879529]


portfolio before change:  [-0.62092136]
curr_Stock_Price:  103.13798611776664
curr_Factors:  [103.13798612  -0.53949231  -1.01675762]
mat_Sqrt:  [[21.75443892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00179323  0.17670648 -1.52156748]
Stock Position:  -0.0017932326974736128
Bond Position:  [-0.43597095]


portfolio before change:  [-0.6223552]
curr_Stock_Price:  103.90717836069089
curr_Factors:  [103.90717836  -0.74313071  -1.02397015]
mat_Sqrt:  [[17.75020598  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0214315  0.06195717 0.19714722]
Stock Position:  0.02143150031495302
Bond Position:  [-2.84924192]


portfolio before change:  [-0.63837255]
curr_Stock_Price:  103.17642326309907
curr_Factors:  [103.17642326  -0.81727378  -1.02839006]
mat_Sqrt:  [[16.29366736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00254289  0.04692408 -0.11593588]
Stock Position:  0.00254288829133738
Bond Position:  [-0.90073867]


portfolio before change:  [-0.63858638]
curr_Stock_Price:  103.13661706381265
curr_Factors:  [103.13661706  -0.85149014  -1.03861547]
mat_Sqrt:  [[15.5793899   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00349657 -0.04950316 -0.34088609]
Stock Position:  -0.003496566392968184
Bond Position:  [-0.27796235]


portfolio before change:  [-0.63906108]
curr_Stock_Price:  103.26244101109971
curr_Factors:  [103.26244101  -0.87127585  -1.05027838]
mat_Sqrt:  [[15.11548157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00240997 -0.00117281 -0.03463825]
Stock Position:  0.0024099696395225873
Bond Position:  [-0.88792042]


portfolio before change:  [-0.63565243]
curr_Stock_Price:  104.72289208515699
curr_Factors:  [104.72289209  -0.76906637  -1.03274978]
mat_Sqrt:  [[17.27916773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00011278  0.00524275  0.0922295 ]
Stock Position:  -0.00011278372136164925
Bond Position:  [-0.62384139]


portfolio before change:  [-0.63563096]
curr_Stock_Price:  103.84108132431291
curr_Factors:  [103.84108132  -0.76170167  -1.04094403]
mat_Sqrt:  [[17.11946239  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00521751 -0.00894523  0.12093324]
Stock Position:  0.005217514882420398
Bond Position:  [-1.17742335]


portfolio before change:  [-0.63091897]
curr_Stock_Price:  104.77240206544697
curr_Factors:  [104.77240207  -0.70145781  -1.05667549]
mat_Sqrt:  [[18.05923338  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01090192 -0.01757539  0.58843272]
Stock Position:  0.010901924529673533
Bond Position:  [-1.77313979]


portfolio before change:  [-0.61835172]
curr_Stock_Price:  105.94548925502653
curr_Factors:  [105.94548926  -0.79890285  -1.08838423]
mat_Sqrt:  [[16.04885705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331073  0.00387705 -0.24010649]
Stock Position:  -0.0033107273301775882
Bond Position:  [-0.26759509]


portfolio before change:  [-0.62329187]
curr_Stock_Price:  107.42755180051329
curr_Factors:  [107.4275518   -0.93852953  -1.11126836]
mat_Sqrt:  [[13.83247095  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.90254577e-03 -9.27527647e-05  1.00257297e-01]
Stock Position:  -0.0039025457735749323
Bond Position:  [-0.20405093]


portfolio before change:  [-0.62236247]
curr_Stock_Price:  107.18286377820198
curr_Factors:  [107.18286378  -0.93159354  -1.11569378]
mat_Sqrt:  [[13.83565642  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00247985 -0.00847227 -0.0210224 ]
Stock Position:  0.0024798488083859257
Bond Position:  [-0.88815977]


portfolio before change:  [-0.62216039]
curr_Stock_Price:  107.3091261969244
curr_Factors:  [107.3091262   -0.85542106  -1.14221383]
mat_Sqrt:  [[14.55709941  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209178 -0.03100489 -0.52535523]
Stock Position:  -0.002091783772379834
Bond Position:  [-0.3976929]


portfolio before change:  [-0.62463271]
curr_Stock_Price:  108.46728086500487
curr_Factors:  [108.46728087  -0.74560965  -1.15002058]
mat_Sqrt:  [[16.29434865  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00627315 -0.0011912   0.39627399]
Stock Position:  0.006273154795164772
Bond Position:  [-1.30506476]


portfolio before change:  [-0.62166868]
curr_Stock_Price:  108.96578264554552
curr_Factors:  [108.96578265  -0.95966778  -1.13315133]
mat_Sqrt:  [[13.43972404  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00790195 -0.03779064 -0.96224779]
Stock Position:  -0.00790194735503099
Bond Position:  [0.2393732]


portfolio before change:  [-0.62639064]
curr_Stock_Price:  109.56713914902781
curr_Factors:  [109.56713915  -0.81707192  -1.15922364]
mat_Sqrt:  [[15.18399555  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00944319  0.13320947 -0.53553543]
Stock Position:  0.009443190842560685
Bond Position:  [-1.66105405]


portfolio before change:  [-0.62951637]
curr_Stock_Price:  109.25812445724334
curr_Factors:  [109.25812446  -0.74828167  -1.13112671]
mat_Sqrt:  [[16.681575    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324128 -0.00430436 -0.04780777]
Stock Position:  -0.0032412822238682467
Bond Position:  [-0.27537996]


portfolio before change:  [-0.62997566]
curr_Stock_Price:  109.38920283702194
curr_Factors:  [109.38920284  -0.52168211  -1.14221588]
mat_Sqrt:  [[20.71823442  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02714396 -0.098125    1.16636262]
Stock Position:  0.02714395707022976
Bond Position:  [-3.59923148]


portfolio before change:  [-0.65556552]
curr_Stock_Price:  108.46303233885472
curr_Factors:  [108.46303234  -0.58142419  -1.15498894]
mat_Sqrt:  [[19.10588252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.006129    0.02419094  0.17506719]
Stock Position:  -0.006128995790901752
Bond Position:  [0.00920395]


portfolio before change:  [-0.64787698]
curr_Stock_Price:  107.20876674491196
curr_Factors:  [107.20876674  -0.42903254  -1.18046644]
mat_Sqrt:  [[21.44044413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01598873 -0.01365655  0.13857378]
Stock Position:  0.015988725346051988
Bond Position:  [-2.36200851]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.6408482]
Stock Price:  107.6668427215654
PL:  [-8.30769092]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.21512255e-01 -9.09024068e-02  2.45848823e-02]
 [-9.10902527e-02  7.19408304e-02 -8.96448916e-02]
 [ 4.62103656e-03  6.15099294e-03  4.97547899e-02]
 [ 1.19025783e-01  3.27560749e-02  1.44006003e-01]
 [ 4.78698582e-02  2.50742337e-02 -7.28878465e-02]
 [-1.30174463e-01 -1.60528081e-01  1.16373038e-01]
 [-6.36957727e-02 -1.46564396e-01  3.95872495e-02]
 [-4.83155654e-02  7.70752920e-01  1.91731540e-01]
 [ 4.73654282e-01  7.32667722e-02  4.42949947e-01]
 [ 6.05998067e-01  2.47025215e-01  4.49803131e-01]
 [-1.89959234e-01 -2.31514150e-01  1.09714536e-02]
 [-1.09028851e-01 -2.04832918e-02  8.34967079e-02]
 [ 1.23796988e-02 -9.29331126e-02  1.22351788e-01]
 [ 4.12617129e-03  1.07571974e-01 -2.13428864e-01]
 [ 9.62471612e-02 -3.22239805e-02 -9.98126508e-02]
 [ 2.61567141e-02 -2.49350128e-02  5.17098705e-02]
 [ 5.23251479e-02  8.51131956e-02 -1.59898075e-01]
 [-3.34523419e-02 -5.89457999e-02 -1.20405260e-02]
 [ 4.81903461e-02  5.02467824e-02 -2.55749671e-01]
 [-9.64583716e-03  3.36318164e-02 -6.53610354e-02]
 [-4.60500710e-02  5.67113653e-01 -5.44028072e-01]
 [ 4.00808704e-01  2.27226252e-01  5.71090558e-02]
 [ 2.95202931e-03 -3.78272956e-02  7.24525177e-02]
 [-4.15832611e-02  1.46739853e-03 -1.25821978e-02]
 [-2.18038117e-02  1.61870693e-02 -6.99571281e-03]
 [-5.48700052e-02 -6.81520834e-03  1.70599682e-01]
 [-1.44558732e-02 -3.23475803e-02  2.62233467e-03]
 [-6.02594964e-02  4.87406508e-02 -2.11851608e-01]
 [ 4.43941115e-03 -3.81508572e-02  7.33184037e-02]
 [-5.65558267e-03  3.48220879e-02 -4.51101016e-02]
 [ 6.14095880e-02  3.37698748e-02  1.06287925e-01]
 [ 3.05997939e-02  1.20107396e-01 -7.31713379e-02]
 [-2.40504875e-02  5.40070452e-02 -7.40872349e-02]
 [ 7.23086178e-03 -1.97437827e-01  4.00432473e-02]
 [-5.52452077e-02  1.06138776e-01 -2.78433720e-02]
 [-1.65286912e-01 -1.70991062e-01 -1.47796774e-01]
 [ 7.02161944e-02  1.05263608e-01  1.98650112e-01]
 [ 1.68612332e-01 -1.30386796e-01 -1.92769740e-01]
 [ 9.72820965e-02  4.09721840e-03  6.97938192e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.99730346]
curr_Stock_Price:  100.95860798366571
curr_Factors:  [100.95860798  -1.21909622  -1.01014127]
mat_Sqrt:  [[10.8642015   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02163521 -0.02933863  0.07013383]
Stock Position:  -0.021635208336060467
Bond Position:  [12.18156398]


portfolio before change:  [9.9980933]
curr_Stock_Price:  100.99248581294263
curr_Factors:  [100.99248581  -1.03673477  -1.02007918]
mat_Sqrt:  [[12.91296914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00733403  0.0232188  -0.25573192]
Stock Position:  -0.007334028138818357
Bond Position:  [10.73877503]


portfolio before change:  [10.00116912]
curr_Stock_Price:  100.75613714575012
curr_Factors:  [100.75613715  -1.05074282  -1.00340467]
mat_Sqrt:  [[12.91714664  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0012412  0.00198522 0.14193657]
Stock Position:  0.0012411995588081093
Bond Position:  [9.87611064]


portfolio before change:  [10.00193886]
curr_Stock_Price:  100.38161791731991
curr_Factors:  [100.38161792  -0.89279274  -0.98321223]
mat_Sqrt:  [[15.3785568   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01008594 0.01057198 0.41080904]
Stock Position:  0.010085939347881016
Bond Position:  [8.98949595]


portfolio before change:  [10.00033195]
curr_Stock_Price:  100.11087815374438
curr_Factors:  [100.11087815  -0.82267781  -0.99275785]
mat_Sqrt:  [[16.29474549  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00233879  0.00809267 -0.20792874]
Stock Position:  0.0023387873941917987
Bond Position:  [9.76619389]


portfolio before change:  [10.00146452]
curr_Stock_Price:  100.0731313140337
curr_Factors:  [100.07313131  -0.61187986  -0.97681073]
mat_Sqrt:  [[20.43421364  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0068115  -0.05181022  0.33197989]
Stock Position:  -0.006811496416248206
Bond Position:  [10.68311229]


portfolio before change:  [10.01034265]
curr_Stock_Price:  98.96578856380899
curr_Factors:  [98.96578856 -0.15075359 -0.9974609 ]
mat_Sqrt:  [[31.39220855  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00272464 -0.04730346  0.1129314 ]
Stock Position:  -0.002724637586508154
Bond Position:  [10.27998856]


portfolio before change:  [10.00734627]
curr_Stock_Price:  100.53717443604607
curr_Factors:  [100.53717444  -0.13779261  -0.97726855]
mat_Sqrt:  [[32.96565923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00449409 0.24875944 0.54695672]
Stock Position:  0.00449409342137771
Bond Position:  [9.55552282]


portfolio before change:  [10.00724694]
curr_Stock_Price:  100.2492754250817
curr_Factors:  [ 1.00249275e+02  2.52488187e-02 -9.90088676e-01]
mat_Sqrt:  [[38.19940658  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.015158   0.02364675 1.2636129 ]
Stock Position:  0.015157999310948841
Bond Position:  [8.48766849]


portfolio before change:  [10.02172117]
curr_Stock_Price:  101.13416784951482
curr_Factors:  [101.13416785  -0.23449092  -0.99305406]
mat_Sqrt:  [[29.63342802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02524978 0.07972705 1.28316313]
Stock Position:  0.025249780657638228
Bond Position:  [7.46810561]


portfolio before change:  [10.05219035]
curr_Stock_Price:  102.30390537210387
curr_Factors:  [102.30390537  -0.23611261  -0.99078163]
mat_Sqrt:  [[29.99568732  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0078337  -0.07472087  0.0312985 ]
Stock Position:  -0.007833703601965569
Bond Position:  [10.85360882]


portfolio before change:  [10.05505062]
curr_Stock_Price:  102.11198024688656
curr_Factors:  [ 1.02111980e+02 -6.80980469e-02 -1.01333741e+00]
mat_Sqrt:  [[34.62703046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0027772  -0.00661095  0.23819287]
Stock Position:  -0.002777202968297827
Bond Position:  [10.33863632]


portfolio before change:  [10.05002768]
curr_Stock_Price:  104.38597726733484
curr_Factors:  [104.38597727  -0.2079373   -1.03822912]
mat_Sqrt:  [[30.02195455  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00061238 -0.02999403  0.3490356 ]
Stock Position:  0.0006123772099828732
Bond Position:  [9.98610409]


portfolio before change:  [10.05005771]
curr_Stock_Price:  102.39649144652563
curr_Factors:  [102.39649145  -0.50040863  -1.03856658]
mat_Sqrt:  [[21.97438003  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079555  0.03471871 -0.60885314]
Stock Position:  -0.0007955526338818033
Bond Position:  [10.13151951]


portfolio before change:  [10.05288771]
curr_Stock_Price:  100.43120963951583
curr_Factors:  [100.43120964  -0.36219239  -1.02697915]
mat_Sqrt:  [[25.03566643  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00276786 -0.01040024 -0.28473771]
Stock Position:  0.0027678630754921943
Bond Position:  [9.77490788]


portfolio before change:  [10.05106435]
curr_Stock_Price:  99.33097237706387
curr_Factors:  [99.33097238 -0.36250105 -1.02569451]
mat_Sqrt:  [[24.78557604  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00127583 -0.00804774  0.14751387]
Stock Position:  0.0012758270771607986
Bond Position:  [9.9243352]


portfolio before change:  [10.04883721]
curr_Stock_Price:  96.61292931283073
curr_Factors:  [96.61292931 -0.28599773 -1.02385935]
mat_Sqrt:  [[26.07183202  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00142145  0.02747017 -0.4561447 ]
Stock Position:  0.0014214477973020247
Bond Position:  [9.91150698]


portfolio before change:  [10.05300399]
curr_Stock_Price:  98.67263086468819
curr_Factors:  [98.67263086 -0.3846835  -1.05905689]
mat_Sqrt:  [[23.29100478  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00205841 -0.01902468 -0.03434827]
Stock Position:  -0.0020584069018424814
Bond Position:  [10.25611241]


portfolio before change:  [10.05530933]
curr_Stock_Price:  98.17552489969532
curr_Factors:  [98.1755249  -0.48109416 -1.04665721]
mat_Sqrt:  [[21.30635902  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.92975661e-04  1.62170793e-02 -7.29582625e-01]
Stock Position:  0.00029297566088277776
Bond Position:  [10.02654629]


portfolio before change:  [10.05700704]
curr_Stock_Price:  99.69208840142973
curr_Factors:  [99.6920884  -0.5773773  -1.06419319]
mat_Sqrt:  [[19.30792864  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083502  0.01085462 -0.18645684]
Stock Position:  -0.0008350215692040473
Bond Position:  [10.14025208]


portfolio before change:  [10.05830639]
curr_Stock_Price:  99.65407184154634
curr_Factors:  [99.65407184 -0.36000964 -1.04946594]
mat_Sqrt:  [[24.3426345   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00169816  0.18303514 -1.55196066]
Stock Position:  -0.0016981623960964148
Bond Position:  [10.22753519]


portfolio before change:  [10.05977469]
curr_Stock_Price:  99.54231734450994
curr_Factors:  [99.54231734 -0.20819142 -1.07112937]
mat_Sqrt:  [[27.69528159  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01656775 0.07333696 0.16291624]
Stock Position:  0.016567746523771208
Bond Position:  [8.41058281]


portfolio before change:  [10.02780595]
curr_Stock_Price:  97.54928011408042
curr_Factors:  [97.54928011 -0.38587348 -1.03942489]
mat_Sqrt:  [[23.45442826  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00042721 -0.01220871  0.20668687]
Stock Position:  0.0004272060292050898
Bond Position:  [9.98613231]


portfolio before change:  [10.02915913]
curr_Stock_Price:  97.79467798573836
curr_Factors:  [97.79467799 -0.1948875  -1.04274974]
mat_Sqrt:  [[28.36718222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154587  0.0004736  -0.03589351]
Stock Position:  -0.0015458729632366057
Bond Position:  [10.18033728]


portfolio before change:  [10.02988066]
curr_Stock_Price:  98.15116561347668
curr_Factors:  [ 9.81511656e+01 -8.83334089e-02 -1.06540909e+00]
mat_Sqrt:  [[30.96217508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064361  0.00522435 -0.01995682]
Stock Position:  -0.0006436122082731449
Bond Position:  [10.09305195]


portfolio before change:  [10.02904961]
curr_Stock_Price:  101.40275621029022
curr_Factors:  [101.40275621  -0.2019865   -1.07057829]
mat_Sqrt:  [[28.4041563   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00075474 -0.0021996   0.48667341]
Stock Position:  -0.000754736006075117
Bond Position:  [10.10558192]


portfolio before change:  [10.03169541]
curr_Stock_Price:  99.5709606257279
curr_Factors:  [99.57096063 -0.17980505 -1.03395453]
mat_Sqrt:  [[29.58037029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069382 -0.01044014  0.00748079]
Stock Position:  -0.0006938220646842709
Bond Position:  [10.10077994]


portfolio before change:  [10.03408643]
curr_Stock_Price:  97.94469462620748
curr_Factors:  [ 9.79446946e+01  3.48204848e-02 -1.04890428e+00]
mat_Sqrt:  [[35.52793133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263326  0.01573098 -0.60435367]
Stock Position:  -0.0026332628317953205
Bond Position:  [10.29200055]


portfolio before change:  [10.03242918]
curr_Stock_Price:  99.06263435714544
curr_Factors:  [ 9.90626344e+01 -1.85522486e-02 -1.03431011e+00]
mat_Sqrt:  [[34.56667119  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0003361  -0.01231314  0.209157  ]
Stock Position:  0.0003361028444157397
Bond Position:  [9.99913394]


portfolio before change:  [10.03300836]
curr_Stock_Price:  97.06685576075698
curr_Factors:  [97.06685576  0.13885901 -1.04476554]
mat_Sqrt:  [[39.23202756  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00019769  0.01123878 -0.12868656]
Stock Position:  -0.00019768579763997774
Bond Position:  [10.0521971]


portfolio before change:  [10.03461554]
curr_Stock_Price:  95.29344338606634
curr_Factors:  [95.29344339  0.12575405 -1.06504491]
mat_Sqrt:  [[37.25067824  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00241603 0.01089918 0.30320986]
Stock Position:  0.0024160302784198688
Bond Position:  [9.8043837]


portfolio before change:  [10.04189259]
curr_Stock_Price:  97.79814206505861
curr_Factors:  [97.79814207  0.13344573 -1.05841854]
mat_Sqrt:  [[38.78109018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00103609  0.0387645  -0.20873746]
Stock Position:  0.0010360868264482112
Bond Position:  [9.94056523]


portfolio before change:  [10.04156936]
curr_Stock_Price:  96.28679844235118
curr_Factors:  [96.28679844  0.32988884 -1.07799855]
mat_Sqrt:  [[45.5687201   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00061773  0.0174307  -0.21135026]
Stock Position:  -0.0006177338101661641
Bond Position:  [10.10104897]


portfolio before change:  [10.04440124]
curr_Stock_Price:  93.7465997877015
curr_Factors:  [93.74659979  0.63652357 -1.05647009]
mat_Sqrt:  [[61.59919982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00040418 -0.06372278  0.11423224]
Stock Position:  -0.0004041801259896022
Bond Position:  [10.08229175]


portfolio before change:  [10.04473447]
curr_Stock_Price:  96.04045789609488
curr_Factors:  [96.0404579   0.26763558 -1.03796538]
mat_Sqrt:  [[44.45332389  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00088325  0.03425614 -0.07942939]
Stock Position:  -0.0008832461070778881
Bond Position:  [10.12956183]


portfolio before change:  [10.04720516]
curr_Stock_Price:  94.67683772932789
curr_Factors:  [ 9.46768377e+01  3.41093043e-02 -1.03670191e+00]
mat_Sqrt:  [[34.73947952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00663105 -0.05518713 -0.42162306]
Stock Position:  -0.006631049441819157
Bond Position:  [10.67501195]


portfolio before change:  [10.04495961]
curr_Stock_Price:  95.21672290129686
curr_Factors:  [95.2167229   0.19323866 -1.03370659]
mat_Sqrt:  [[41.08683069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00321885 0.03397368 0.56669348]
Stock Position:  0.0032188494573521906
Bond Position:  [9.73847131]


portfolio before change:  [10.04264663]
curr_Stock_Price:  94.11994516527268
curr_Factors:  [94.11994517  0.20063194 -1.02860861]
mat_Sqrt:  [[41.12405835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00249606 -0.04208216 -0.54991841]
Stock Position:  0.002496063964116989
Bond Position:  [9.80771723]


portfolio before change:  [10.04311717]
curr_Stock_Price:  93.81726894154701
curr_Factors:  [93.81726894  0.19618036 -1.01171912]
mat_Sqrt:  [[41.50484566  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00270728 0.00132237 0.19910234]
Stock Position:  0.0027072752496206656
Bond Position:  [9.789128]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.04177241]
Stock Price:  92.86853571657846
PL:  [10.04177241]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.90777281e-01 -1.01671524e-01  2.66605923e-02]
 [-3.64294097e-02  4.64345521e-02 -4.43631532e-02]
 [-2.01504021e-01 -2.05963103e-02 -1.35270415e-01]
 [-1.85432461e-01 -6.58741991e-02 -9.14062258e-02]
 [ 1.16414831e-01 -9.24776649e-02 -9.18544693e-02]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.80659083e-02 -1.72196525e-01  7.80096068e-02]
 [ 1.14270272e-02  6.75162531e-01  9.55459848e-02]
 [ 3.75044987e-01  3.29107285e-02  3.74986924e-01]
 [ 5.77838824e-01  2.50478532e-01  4.75069711e-01]
 [-1.01900869e-01 -2.30339045e-01 -2.53258450e-02]
 [-5.73754157e-02 -1.90341325e-02  7.96871699e-02]
 [ 1.46596376e-02 -5.04913645e-02  5.19456442e-02]
 [-7.18199640e-04  2.00818972e-01 -1.35312379e-01]
 [ 3.20416948e-01 -1.31141412e-01 -1.76480111e-01]
 [-2.19844809e-01 -9.65904713e-02  1.20356059e-01]
 [ 5.13860003e-02  1.70589014e-02 -2.74638320e-02]
 [-5.39383940e-02 -5.89844844e-02  3.26910820e-02]
 [ 8.45492600e-02 -5.53669467e-02 -8.82129760e-02]
 [ 2.41958253e-02 -1.29958554e-02  1.45735126e-01]
 [-5.23770556e-02  6.25175972e-01 -6.15021863e-01]
 [ 4.83739634e-01  2.66908423e-01  4.36043382e-02]
 [-4.72888997e-02  1.44805843e-01 -5.52532310e-02]
 [-5.95661317e-02 -1.15971838e-01 -2.62702565e-02]
 [-1.83439862e-02 -4.50470169e-02 -5.54489706e-03]
 [-9.26657324e-03  1.74690580e-02  1.83546374e-02]
 [ 8.34383320e-02 -2.44626865e-02  7.12146327e-02]
 [ 1.56438807e-01 -6.23688827e-02  1.48425509e-01]
 [-3.54198241e-02  1.02995744e-02 -7.82489692e-02]
 [-7.24928704e-02 -1.35371159e-02  4.02678829e-02]
 [ 6.85207379e-02 -8.59806966e-03  1.93247906e-02]
 [ 2.62638857e-02 -3.96531141e-02 -9.42955547e-02]
 [-4.15166908e-02  1.92091876e-02 -3.56821438e-02]
 [ 2.60586044e-02 -5.05936020e-02  8.85390083e-02]
 [-5.67291863e-02  7.02118346e-02 -1.62090535e-02]
 [ 6.37737795e-02 -3.01085382e-02  1.06660787e-01]
 [-5.97613383e-02  9.07277252e-02  1.36802245e-02]
 [ 5.03436469e-02 -6.79528350e-02 -6.01067452e-02]
 [ 9.83925378e-02  3.40927195e-03  6.32202272e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.58002416]
curr_Stock_Price:  101.03207300684087
curr_Factors:  [101.03207301  -1.06939358  -0.98139324]
mat_Sqrt:  [[12.99612443  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02355232 -0.03281434  0.07605525]
Stock Position:  -0.023552315494378535
Bond Position:  [12.95956342]


portfolio before change:  [10.57133048]
curr_Stock_Price:  101.46998018239557
curr_Factors:  [101.46998018  -0.93354252  -0.99300173]
mat_Sqrt:  [[14.77916983  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243631  0.01498669 -0.12655573]
Stock Position:  -0.002436306477409905
Bond Position:  [10.81854245]


portfolio before change:  [10.57193613]
curr_Stock_Price:  101.7764909308835
curr_Factors:  [101.77649093  -0.72694321  -0.98563625]
mat_Sqrt:  [[18.3604645   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01270775 -0.00664743 -0.38588884]
Stock Position:  -0.012707749483187118
Bond Position:  [11.86528628]


portfolio before change:  [10.57439034]
curr_Stock_Price:  101.70008404243501
curr_Factors:  [101.70008404  -0.67630309  -0.99263719]
mat_Sqrt:  [[19.16504109  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01135073 -0.02126081 -0.26075652]
Stock Position:  -0.01135072929945416
Bond Position:  [11.72876046]


portfolio before change:  [10.58565217]
curr_Stock_Price:  100.83708711617378
curr_Factors:  [100.83708712  -0.88368517  -0.96571226]
mat_Sqrt:  [[15.86489475  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0049662  -0.02984704 -0.26203523]
Stock Position:  0.004966196956623581
Bond Position:  [10.08487534]


portfolio before change:  [10.58870255]
curr_Stock_Price:  101.19746222402439
curr_Factors:  [101.19746222  -0.792597    -0.95607276]
mat_Sqrt:  [[17.60889056  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00870607 -0.05534923  0.15513819]
Stock Position:  -0.008706067862375783
Bond Position:  [11.46973453]


portfolio before change:  [10.59744397]
curr_Stock_Price:  100.35809221493828
curr_Factors:  [100.35809221  -0.70104573  -0.95470724]
mat_Sqrt:  [[19.16319928  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00403334 -0.05557619  0.22253969]
Stock Position:  -0.0040333417862433935
Bond Position:  [11.00222246]


portfolio before change:  [10.59473283]
curr_Stock_Price:  101.37127311286032
curr_Factors:  [101.37127311  -0.67042939  -0.95713671]
mat_Sqrt:  [[19.9100306   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00847549 0.21790777 0.2725661 ]
Stock Position:  0.008475488942605167
Bond Position:  [9.73556173]


portfolio before change:  [10.60293294]
curr_Stock_Price:  102.19518924233375
curr_Factors:  [102.19518924  -0.91022861  -0.95689393]
mat_Sqrt:  [[15.79608406  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02901395 0.01062189 1.06973332]
Stock Position:  0.029013947035474184
Bond Position:  [7.63784714]


portfolio before change:  [10.60410833]
curr_Stock_Price:  102.20279221249848
curr_Factors:  [102.20279221  -1.03330274  -0.97627649]
mat_Sqrt:  [[13.69977994  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05298923 0.0808416  1.35524165]
Stock Position:  0.052989226245079596
Bond Position:  [5.18846145]


portfolio before change:  [10.6925995]
curr_Stock_Price:  103.86053626823436
curr_Factors:  [103.86053627  -0.97383158  -0.99874932]
mat_Sqrt:  [[14.44673015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01066596 -0.07434161 -0.07224759]
Stock Position:  -0.010665960030709114
Bond Position:  [11.80037183]


portfolio before change:  [10.69604171]
curr_Stock_Price:  103.67611104493471
curr_Factors:  [103.67611104  -0.9765724   -0.97874251]
mat_Sqrt:  [[14.67223325  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306665 -0.00614324  0.22732531]
Stock Position:  -0.003066654240015301
Bond Position:  [11.0139805]


portfolio before change:  [10.69869766]
curr_Stock_Price:  103.25900702893763
curr_Factors:  [103.25900703  -1.04024831  -0.99955278]
mat_Sqrt:  [[13.42930643  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00111372 -0.01629602  0.14818646]
Stock Position:  0.0011137203045074398
Bond Position:  [10.58369601]


portfolio before change:  [10.69966048]
curr_Stock_Price:  102.93556372416212
curr_Factors:  [102.93556372  -0.80026825  -0.97153696]
mat_Sqrt:  [[17.50169934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00072297  0.06481404 -0.38600855]
Stock Position:  0.0007229742403860771
Bond Position:  [10.62524072]


portfolio before change:  [10.70069987]
curr_Stock_Price:  102.53603442843335
curr_Factors:  [102.53603443  -0.54381122  -0.97481566]
mat_Sqrt:  [[22.45666427  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01147205 -0.04232571 -0.50344863]
Stock Position:  0.01147204966709575
Bond Position:  [9.52440139]


portfolio before change:  [10.70095235]
curr_Stock_Price:  102.45425796447971
curr_Factors:  [102.45425796  -0.2992859   -0.98961246]
mat_Sqrt:  [[28.23374998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00761478 -0.03117444  0.34334234]
Stock Position:  -0.007614775898768005
Bond Position:  [11.48111856]


portfolio before change:  [10.70470382]
curr_Stock_Price:  102.15008071543723
curr_Factors:  [102.15008072  -0.56983892  -0.99339371]
mat_Sqrt:  [[21.39613894  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00230238  0.00550574 -0.07834667]
Stock Position:  0.0023023828183141057
Bond Position:  [10.46951523]


portfolio before change:  [10.70582596]
curr_Stock_Price:  102.06902055952804
curr_Factors:  [102.06902056  -0.62680441  -0.98915281]
mat_Sqrt:  [[20.28115314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00292417 -0.01903716  0.09325856]
Stock Position:  -0.0029241686578520033
Bond Position:  [11.00429299]


portfolio before change:  [10.70824148]
curr_Stock_Price:  101.71339695383182
curr_Factors:  [101.71339695  -0.4516704   -0.98939151]
mat_Sqrt:  [[24.07315012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00229472 -0.01786961 -0.25164707]
Stock Position:  0.002294719666285893
Bond Position:  [10.47483775]


portfolio before change:  [10.71186296]
curr_Stock_Price:  102.72094535594334
curr_Factors:  [102.72094536  -0.2240495   -0.97765317]
mat_Sqrt:  [[30.88632012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00166064 -0.00419439  0.41574175]
Stock Position:  0.001660641840780128
Bond Position:  [10.54128026]


portfolio before change:  [10.71080783]
curr_Stock_Price:  101.29205320683073
curr_Factors:  [101.29205321  -0.16521195  -0.96215489]
mat_Sqrt:  [[32.80697437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.53334338e-03  2.01774677e-01 -1.75448619e+00]
Stock Position:  -0.0015333433759091638
Bond Position:  [10.86612332]


portfolio before change:  [10.71080125]
curr_Stock_Price:  102.18221841074848
curr_Factors:  [102.18221841  -0.28229145  -0.98262787]
mat_Sqrt:  [[28.84216438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01896955 0.08614432 0.12439104]
Stock Position:  0.018969546771499337
Bond Position:  [8.77245088]


portfolio before change:  [10.7452086]
curr_Stock_Price:  103.93822928376055
curr_Factors:  [103.93822928  -0.35874319  -1.02256389]
mat_Sqrt:  [[26.11447317  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111084  0.04673588 -0.15762209]
Stock Position:  -0.0011108418374873512
Bond Position:  [10.86066754]


portfolio before change:  [10.74486654]
curr_Stock_Price:  105.46835614726508
curr_Factors:  [ 1.05468356e+02 -1.87678123e-03 -1.01991055e+00]
mat_Sqrt:  [[37.96344159  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00233386 -0.03742975 -0.07494173]
Stock Position:  -0.0023338552568576854
Bond Position:  [10.99101442]


portfolio before change:  [10.74444783]
curr_Stock_Price:  106.23647441806426
curr_Factors:  [ 1.06236474e+02  2.80049610e-02 -1.03835279e+00]
mat_Sqrt:  [[38.67988383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00074124 -0.01453886 -0.01581805]
Stock Position:  -0.0007412384575589257
Bond Position:  [10.82319439]


portfolio before change:  [10.74513681]
curr_Stock_Price:  107.13227127223375
curr_Factors:  [ 1.07132271e+02  1.84740073e-02 -1.01758113e+00]
mat_Sqrt:  [[39.44696583  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.95371951e-05  5.63811423e-03  5.23606715e-02]
Stock Position:  -4.953719509821546e-05
Bond Position:  [10.75044384]


portfolio before change:  [10.74659543]
curr_Stock_Price:  104.81628470936741
curr_Factors:  [ 1.04816285e+02  8.88913097e-03 -9.92812929e-01]
mat_Sqrt:  [[39.18466024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00237291 -0.0078953   0.20315552]
Stock Position:  0.002372906451087182
Bond Position:  [10.49787619]


portfolio before change:  [10.74536297]
curr_Stock_Price:  103.74385277883164
curr_Factors:  [ 1.03743853e+02 -5.50913226e-02 -9.73833273e-01]
mat_Sqrt:  [[37.07712903  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00469306 -0.02012947  0.42341666]
Stock Position:  0.004693055977058239
Bond Position:  [10.25848726]


portfolio before change:  [10.75756833]
curr_Stock_Price:  106.07132949806473
curr_Factors:  [106.0713295   -0.12366873  -0.95013341]
mat_Sqrt:  [[36.24529748  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013599   0.00332417 -0.22322253]
Stock Position:  -0.0013598987910644763
Bond Position:  [10.90181461]


portfolio before change:  [10.76283524]
curr_Stock_Price:  103.20045559238669
curr_Factors:  [ 1.03200456e+02 -5.79817279e-02 -9.49380737e-01]
mat_Sqrt:  [[37.686834    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00177878 -0.00436909  0.11487306]
Stock Position:  -0.0017787770520182066
Bond Position:  [10.94640585]


portfolio before change:  [10.76571769]
curr_Stock_Price:  102.34927519139895
curr_Factors:  [ 1.02349275e+02 -2.79966660e-02 -9.58954268e-01]
mat_Sqrt:  [[38.14673979  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00185364 -0.00277502  0.05512825]
Stock Position:  0.001853639945095275
Bond Position:  [10.57599899]


portfolio before change:  [10.76645328]
curr_Stock_Price:  102.03287481109929
curr_Factors:  [102.03287481  -0.16126467  -0.92842819]
mat_Sqrt:  [[34.31567342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.14221375e-05 -1.27979875e-02 -2.68998971e-01]
Stock Position:  -3.142213745079504e-05
Bond Position:  [10.76965937]


portfolio before change:  [10.76782631]
curr_Stock_Price:  101.18200723011361
curr_Factors:  [101.18200723  -0.32200136  -0.9742108 ]
mat_Sqrt:  [[27.67996289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162136  0.00619974 -0.10179122]
Stock Position:  -0.001621361238215517
Bond Position:  [10.93187889]


portfolio before change:  [10.7724841]
curr_Stock_Price:  99.15209541152086
curr_Factors:  [99.15209541 -0.64899234 -0.9533717 ]
mat_Sqrt:  [[19.9711943   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00169265 -0.01632901  0.25257715]
Stock Position:  0.00169264679799641
Bond Position:  [10.60465462]


portfolio before change:  [10.7732473]
curr_Stock_Price:  98.81979504065234
curr_Factors:  [98.81979504 -0.3920855  -0.94929433]
mat_Sqrt:  [[25.83985607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176881  0.02266077 -0.04623992]
Stock Position:  -0.0017688146049159561
Bond Position:  [10.94804119]


portfolio before change:  [10.77415129]
curr_Stock_Price:  99.08245457568694
curr_Factors:  [99.08245458 -0.32693666 -0.95791544]
mat_Sqrt:  [[27.41527341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00289619 -0.00971749  0.30427354]
Stock Position:  0.00289619368811411
Bond Position:  [10.48718931]


portfolio before change:  [10.77484275]
curr_Stock_Price:  98.86854589674147
curr_Factors:  [98.8685459  -0.25606576 -0.99116076]
mat_Sqrt:  [[28.40498438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00135361  0.02928225  0.03902587]
Stock Position:  -0.0013536059109526624
Bond Position:  [10.9086718]


portfolio before change:  [10.77724558]
curr_Stock_Price:  98.10084973170562
curr_Factors:  [98.10084973 -0.53297689 -0.98001061]
mat_Sqrt:  [[21.60680961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112018 -0.02193168 -0.17146781]
Stock Position:  0.0011201836356238065
Bond Position:  [10.66735461]


portfolio before change:  [10.77766741]
curr_Stock_Price:  97.28698717703249
curr_Factors:  [97.28698718 -0.27249368 -0.98173976]
mat_Sqrt:  [[27.75543834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.004035   0.00110034 0.18034971]
Stock Position:  0.004035001213873584
Bond Position:  [10.38511429]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.77406403]
Stock Price:  96.07221792036923
PL:  [10.77406403]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.76415646e-01 -9.98201349e-02  1.81808297e-02]
 [-1.96450828e-01  6.61590768e-02 -2.05790489e-01]
 [-3.96483952e-02  5.18184454e-02  2.06457082e-02]
 [ 9.29178475e-02  7.09606456e-02  8.80679149e-02]
 [ 3.13034342e-02  4.54160960e-02 -7.11399195e-02]
 [-6.37545326e-02 -1.46143803e-01  1.88058647e-01]
 [-6.35362501e-02 -1.46585546e-01  4.49252434e-02]
 [ 2.10036027e-02  8.45323097e-01  1.28356910e-01]
 [-2.80271144e-02  9.87079170e-02 -6.76339595e-02]
 [ 2.28465782e-01  8.06830798e-02  1.02308667e-01]
 [-1.91036490e-01 -3.49851424e-01 -6.27507687e-02]
 [ 3.26606226e-02 -1.39220811e-02  1.10213382e-01]
 [-6.18425297e-03  5.10285940e-02 -7.11232157e-03]
 [ 1.38296059e-02 -1.92417899e-01  4.87848647e-03]
 [ 2.25222184e-02 -3.86437712e-02 -6.95219489e-02]
 [ 1.36441535e-01  6.41828256e-03 -3.46754834e-02]
 [ 4.64450254e-02  2.59267264e-02  1.43477134e-03]
 [-3.30077257e-02 -5.88520669e-02 -1.24430348e-02]
 [ 5.14403259e-02 -9.04581069e-03 -1.11817024e-01]
 [ 2.49039933e-02  4.10395314e-03  5.52422606e-02]
 [-2.80779706e-02  4.32558240e-01 -4.01353134e-01]
 [ 1.70113524e-01  1.16839387e-01  9.46761401e-02]
 [ 5.62028154e-04 -2.70727823e-02  6.58962621e-02]
 [ 1.42677262e-01 -1.21357896e-01 -3.11483292e-01]
 [ 3.99903617e-02  1.26969178e-02 -1.33404924e-02]
 [-6.38966776e-02 -7.28494741e-03  1.82907050e-01]
 [-7.72262779e-03 -3.25950949e-02  1.26950440e-03]
 [ 2.61090571e-02 -2.27216274e-02 -1.70103500e-01]
 [-5.46467609e-02 -3.75123625e-02  8.10263410e-03]
 [-4.97978142e-02 -5.92543837e-03  1.90211144e-02]
 [-2.56855209e-02 -4.24158339e-02 -1.02321665e-02]
 [ 2.59450598e-02 -2.67471642e-03 -3.53893512e-02]
 [ 1.57814744e-02  7.15100482e-03  1.55920191e-01]
 [ 8.54965020e-03 -7.50230002e-02 -4.60835267e-02]
 [ 2.89768557e-03  1.31821518e-02  2.13012433e-02]
 [ 5.66882603e-02  3.17900343e-02  1.57361597e-01]
 [ 1.78877427e-01 -1.17227053e-01  7.44796517e-02]
 [-4.77670985e-02 -1.47076733e-03  2.43431641e-02]
 [ 9.05357371e-02  8.27675839e-03  1.09730926e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.68188054]
curr_Stock_Price:  100.41455206462106
curr_Factors:  [100.41455206  -0.95482251  -1.00104578]
mat_Sqrt:  [[14.202796    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01359452 -0.03221681  0.05186485]
Stock Position:  -0.013594520344686426
Bond Position:  [7.04696821]


portfolio before change:  [5.69745899]
curr_Stock_Price:  99.33341623632421
curr_Factors:  [99.33341624 -0.98004297 -0.97005159]
mat_Sqrt:  [[14.13123317  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01591885  0.02135275 -0.58706298]
Stock Position:  -0.0159188492841087
Bond Position:  [7.27873267]


portfolio before change:  [5.69654447]
curr_Stock_Price:  99.44802357080837
curr_Factors:  [99.44802357 -1.07983327 -0.96348326]
mat_Sqrt:  [[12.88828299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00192863  0.01672433  0.05889646]
Stock Position:  -0.0019286286470576322
Bond Position:  [5.88834278]


portfolio before change:  [5.69747999]
curr_Stock_Price:  99.34462079395928
curr_Factors:  [99.34462079 -1.23415358 -0.96777804]
mat_Sqrt:  [[10.9864556   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01141218 0.02290245 0.25123325]
Stock Position:  0.011412180694033136
Bond Position:  [4.56374122]


portfolio before change:  [5.70130735]
curr_Stock_Price:  99.63000539267807
curr_Factors:  [99.63000539 -1.24193468 -0.93457645]
mat_Sqrt:  [[11.30168981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00230519  0.01465798 -0.20294239]
Stock Position:  0.002305193399432239
Bond Position:  [5.47164092]


portfolio before change:  [5.69953141]
curr_Stock_Price:  98.56287516918785
curr_Factors:  [98.56287517 -1.23518158 -0.91376229]
mat_Sqrt:  [[11.49314543  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00480275 -0.04716771  0.53647897]
Stock Position:  -0.004802749715502195
Bond Position:  [6.17290423]


portfolio before change:  [5.70016641]
curr_Stock_Price:  98.59133031766632
curr_Factors:  [98.59133032 -1.44614958 -0.8947142 ]
mat_Sqrt:  [[ 9.48887019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00888278 -0.04731028  0.12815921]
Stock Position:  -0.008882782745195186
Bond Position:  [6.57593177]


portfolio before change:  [5.70281403]
curr_Stock_Price:  98.38581070382838
curr_Factors:  [98.3858107  -1.47442635 -0.87754133]
mat_Sqrt:  [[ 9.36452789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02346677 0.27282686 0.36616654]
Stock Position:  0.023466767819748643
Bond Position:  [3.39401706]


portfolio before change:  [5.71990436]
curr_Stock_Price:  99.09600835793096
curr_Factors:  [99.09600836 -1.54433563 -0.86145338]
mat_Sqrt:  [[ 8.93789546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242609  0.03185784 -0.19294086]
Stock Position:  -0.0024260934265354656
Bond Position:  [5.96032053]


portfolio before change:  [5.72169945]
curr_Stock_Price:  98.66321232205296
curr_Factors:  [98.66321232 -1.47717385 -0.85175736]
mat_Sqrt:  [[ 9.60977621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02766129 0.02604035 0.29185815]
Stock Position:  0.02766129094882972
Bond Position:  [2.99254763]


portfolio before change:  [5.72039266]
curr_Stock_Price:  98.60244588371214
curr_Factors:  [98.60244588 -1.4860327  -0.83375899]
mat_Sqrt:  [[ 9.69203457  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02840049 -0.11291406 -0.17901048]
Stock Position:  -0.028400493036024727
Bond Position:  [8.52075074]


portfolio before change:  [5.70377665]
curr_Stock_Price:  99.22501166947016
curr_Factors:  [99.22501167 -1.29654811 -0.84438898]
mat_Sqrt:  [[11.66336842  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0044855  -0.00449333  0.3144081 ]
Stock Position:  0.004485496824917155
Bond Position:  [5.25870317]


portfolio before change:  [5.70710852]
curr_Stock_Price:  99.82126531100495
curr_Factors:  [99.82126531 -1.27144093 -0.83228377]
mat_Sqrt:  [[12.17831048  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00022828  0.01646941 -0.02028947]
Stock Position:  0.00022828442443783756
Bond Position:  [5.68432088]


portfolio before change:  [5.70779816]
curr_Stock_Price:  99.72951308639644
curr_Factors:  [99.72951309 -1.32529132 -0.80675382]
mat_Sqrt:  [[11.82737216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00206738 -0.06210261  0.01391696]
Stock Position:  -0.0020673836977399417
Bond Position:  [5.91397733]


portfolio before change:  [5.70842645]
curr_Stock_Price:  99.78320274826247
curr_Factors:  [99.78320275 -1.59361351 -0.80037137]
mat_Sqrt:  [[ 9.10674169  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.86434411e-05 -1.24722235e-02 -1.98326769e-01]
Stock Position:  4.8643441092379746e-05
Bond Position:  [5.70357266]


portfolio before change:  [5.70912889]
curr_Stock_Price:  99.56626553192861
curr_Factors:  [99.56626553 -1.38622035 -0.81739389]
mat_Sqrt:  [[10.99245546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01188757  0.00207149 -0.0989195 ]
Stock Position:  0.011887567623227732
Bond Position:  [4.52552818]


portfolio before change:  [5.70547197]
curr_Stock_Price:  99.21104958840337
curr_Factors:  [99.21104959 -1.08191057 -0.84458539]
mat_Sqrt:  [[14.45085289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00360049 0.00836781 0.004093  ]
Stock Position:  0.00360049113944458
Bond Position:  [5.34826346]


portfolio before change:  [5.7019336]
curr_Stock_Price:  98.04261358862604
curr_Factors:  [98.04261359 -1.06491109 -0.83370701]
mat_Sqrt:  [[14.68437668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00323887 -0.01899442 -0.03549651]
Stock Position:  -0.0032388693379591456
Bond Position:  [6.01948081]


portfolio before change:  [5.69837454]
curr_Stock_Price:  99.37380025873588
curr_Factors:  [99.37380026 -1.10510331 -0.81817992]
mat_Sqrt:  [[14.52113641  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00184347 -0.00291952 -0.31898284]
Stock Position:  0.0018434716409242993
Bond Position:  [5.51518176]


portfolio before change:  [5.69931624]
curr_Stock_Price:  99.51063976976499
curr_Factors:  [99.51063977 -1.16715947 -0.83323767]
mat_Sqrt:  [[13.46195331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00274982 0.00132455 0.15759079]
Stock Position:  0.002749822971375781
Bond Position:  [5.4256796]


portfolio before change:  [5.70125196]
curr_Stock_Price:  99.96793087375768
curr_Factors:  [99.96793087 -1.11318093 -0.81203322]
mat_Sqrt:  [[14.57977507  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148893  0.13960757 -1.14494878]
Stock Position:  -0.0014889293510316187
Bond Position:  [5.85009715]


portfolio before change:  [5.70269958]
curr_Stock_Price:  99.48684178747116
curr_Factors:  [99.48684179 -1.16197069 -0.82547945]
mat_Sqrt:  [[13.63411693  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01564377 0.03770975 0.27008467]
Stock Position:  0.01564376709709891
Bond Position:  [4.1463506]


portfolio before change:  [5.68659763]
curr_Stock_Price:  98.42442035172375
curr_Factors:  [98.42442035 -1.0457372  -0.84255316]
mat_Sqrt:  [[14.89459786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00056979 -0.0087377   0.18798369]
Stock Position:  0.0005697930128986196
Bond Position:  [5.63051608]


portfolio before change:  [5.68749568]
curr_Stock_Price:  98.7652279008149
curr_Factors:  [98.7652279  -1.40104351 -0.84465071]
mat_Sqrt:  [[10.45469732  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00519613 -0.03916809 -0.88857513]
Stock Position:  0.005196126019729397
Bond Position:  [5.17429911]


portfolio before change:  [5.692102]
curr_Stock_Price:  99.52723621676118
curr_Factors:  [99.52723622 -1.6421644  -0.85618643]
mat_Sqrt:  [[ 8.18317739  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00487085  0.00409791 -0.03805671]
Stock Position:  0.004870845478090908
Bond Position:  [5.20732021]


portfolio before change:  [5.6929554]
curr_Stock_Price:  99.56879929114345
curr_Factors:  [99.56879929 -1.45354869 -0.82753276]
mat_Sqrt:  [[10.17330771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00275702 -0.00235121  0.5217829 ]
Stock Position:  -0.002757015406912546
Bond Position:  [5.96746811]


portfolio before change:  [5.69203157]
curr_Stock_Price:  100.17445620524327
curr_Factors:  [100.17445621  -1.5357058   -0.83118983]
mat_Sqrt:  [[ 9.39349656  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00150284 -0.01052002  0.00362154]
Stock Position:  -0.0015028415744031253
Bond Position:  [5.84257791]


portfolio before change:  [5.69273783]
curr_Stock_Price:  100.19050268041272
curr_Factors:  [100.19050268  -1.33666066  -0.85732839]
mat_Sqrt:  [[11.16835511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0011865  -0.00733337 -0.48525794]
Stock Position:  -0.0011864958670114358
Bond Position:  [5.81161344]


portfolio before change:  [5.6932411]
curr_Stock_Price:  100.37864009517868
curr_Factors:  [100.3786401   -1.14397361  -0.86427638]
mat_Sqrt:  [[13.47315853  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00450154 -0.01210706  0.02311456]
Stock Position:  -0.004501542564928485
Bond Position:  [6.14509982]


portfolio before change:  [5.69106506]
curr_Stock_Price:  101.03268738993366
curr_Factors:  [101.03268739  -1.32898106  -0.89276567]
mat_Sqrt:  [[10.95391996  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430208 -0.00191243  0.05426195]
Stock Position:  -0.004302082790431367
Bond Position:  [6.12571605]


portfolio before change:  [5.68861488]
curr_Stock_Price:  101.78022049473013
curr_Factors:  [101.78022049  -1.22651531  -0.90404887]
mat_Sqrt:  [[12.088464    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0030138  -0.01368965 -0.02918952]
Stock Position:  -0.003013802991270815
Bond Position:  [5.99536041]


portfolio before change:  [5.69015599]
curr_Stock_Price:  101.5175460184002
curr_Factors:  [101.51754602  -1.3369127   -0.90282046]
mat_Sqrt:  [[10.81029036  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00168129 -0.00086326 -0.10095597]
Stock Position:  0.001681292905885873
Bond Position:  [5.51947526]


portfolio before change:  [5.69212164]
curr_Stock_Price:  102.2762901709684
curr_Factors:  [102.27629017  -1.21633875  -0.88874808]
mat_Sqrt:  [[12.46084147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0039378  0.00230798 0.4447969 ]
Stock Position:  0.00393779528604843
Bond Position:  [5.28937855]


portfolio before change:  [5.6943192]
curr_Stock_Price:  102.66644479645944
curr_Factors:  [102.6664448   -1.40483128  -0.87177415]
mat_Sqrt:  [[10.53686337  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00153472 -0.02421357 -0.13146347]
Stock Position:  -0.0015347182099581893
Bond Position:  [5.85188327]


portfolio before change:  [5.69450432]
curr_Stock_Price:  103.0224780642867
curr_Factors:  [103.02247806  -1.58609546  -0.86212262]
mat_Sqrt:  [[ 8.9060348   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00111571 0.00425452 0.06076652]
Stock Position:  0.001115713037053727
Bond Position:  [5.5795608]


portfolio before change:  [5.69556031]
curr_Stock_Price:  103.34379217298007
curr_Factors:  [103.34379217  -1.64872551  -0.8363539 ]
mat_Sqrt:  [[ 8.61049499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01106773 0.01026019 0.44890884]
Stock Position:  0.011067734847566877
Bond Position:  [4.55177862]


portfolio before change:  [5.68844802]
curr_Stock_Price:  102.64976603037437
curr_Factors:  [102.64976603  -1.4754163   -0.82816913]
mat_Sqrt:  [[10.25471335  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01659253 -0.03783487  0.21246972]
Stock Position:  0.016592531152226527
Bond Position:  [3.98522858]


portfolio before change:  [5.68607184]
curr_Stock_Price:  102.47653366566384
curr_Factors:  [102.47653367  -1.49152533  -0.80831248]
mat_Sqrt:  [[10.27584533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00419414 -0.00047469  0.06944427]
Stock Position:  -0.004194135727738219
Bond Position:  [6.11587233]


portfolio before change:  [5.68969026]
curr_Stock_Price:  101.79608652774276
curr_Factors:  [101.79608653  -1.47485943  -0.79545473]
mat_Sqrt:  [[10.51347219  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01090258 0.00267131 0.31303179]
Stock Position:  0.010902578405645404
Bond Position:  [4.57985044]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.69176359]
Stock Price:  101.93374358793335
PL:  [3.75802001]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.99483176e-01 -9.40637791e-02  2.18355756e-02]
 [-1.25561012e-01  7.58077184e-02 -1.51175850e-01]
 [ 2.12251219e-02 -6.17851467e-03  6.16419921e-02]
 [-4.20507943e-01 -2.06243579e-01 -2.47588351e-01]
 [ 1.67711392e-01 -1.75731555e-01 -1.04390231e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.24712689e-02 -1.63644149e-01 -2.72864935e-02]
 [ 7.23704436e-03  7.41843181e-01  1.12402265e-01]
 [ 1.78083813e-01  6.94148588e-03  2.00036325e-01]
 [ 5.65415989e-01  2.47830860e-01  4.72755079e-01]
 [-1.75471732e-01 -2.42852850e-01 -4.24490876e-03]
 [-4.49815863e-02 -1.82673845e-02  9.14363408e-02]
 [ 1.55621008e-02 -7.84892239e-02  9.52894558e-02]
 [ 1.11782287e-03  1.59336465e-01 -1.07552087e-01]
 [ 5.05306315e-01 -1.40406752e-01 -2.34563507e-01]
 [-1.76764059e-01 -9.43198226e-02  1.11651493e-01]
 [ 5.81204603e-02 -1.49185400e-02 -3.64692031e-03]
 [-6.51811290e-02 -6.56347921e-02  1.66833835e-02]
 [ 2.08433539e-01 -2.64185121e-01  8.64915020e-02]
 [ 6.54045961e-02  2.43573227e-03  4.80870311e-01]
 [-2.73173906e-02  4.39481864e-01 -4.19819819e-01]
 [ 3.06938532e-01  1.82309691e-01  7.23951518e-02]
 [ 9.23850584e-03  1.77264847e-01 -6.22806122e-02]
 [ 9.87788110e-02 -2.01094540e-01 -2.83583339e-01]
 [ 3.35574447e-02 -2.38012031e-02 -1.12609372e-02]
 [-6.68637751e-03  1.80623966e-02  1.49838710e-02]
 [ 8.60058593e-02 -2.29342816e-02  8.08153111e-02]
 [ 1.61899288e-01 -5.77973884e-02  1.81841510e-01]
 [-4.17960553e-02 -9.31742189e-04 -5.93942992e-02]
 [-5.88704586e-02 -1.35279323e-02  4.10245787e-02]
 [-4.36830522e-02 -6.16014371e-02 -4.18133402e-02]
 [ 2.64238552e-02 -5.82068634e-02 -1.23851485e-01]
 [ 3.84974966e-02 -1.05338180e-03  1.50061750e-01]
 [-8.79953106e-03 -1.08203195e-01 -2.75786277e-01]
 [ 5.48013355e-02  2.56398918e-01 -8.02534884e-02]
 [-8.93233833e-03 -9.56124009e-03  4.65040067e-02]
 [ 3.92858874e-01 -2.42644681e-01  2.29064459e-01]
 [-9.94524407e-02  3.72416236e-02  4.59313808e-02]
 [ 2.79770402e-01 -2.96350115e-02  6.67540458e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.09427573]
curr_Stock_Price:  100.71868862505515
curr_Factors:  [100.71868863  -1.15156962  -0.96253502]
mat_Sqrt:  [[12.16091027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01761601 -0.03035895  0.06229082]
Stock Position:  -0.01761600832466872
Bond Position:  [9.86853699]


portfolio before change:  [8.10269188]
curr_Stock_Price:  100.31096262281638
curr_Factors:  [100.31096262  -1.19510403  -0.93584407]
mat_Sqrt:  [[11.90938664  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01183482  0.02446684 -0.43126262]
Stock Position:  -0.011834821725683451
Bond Position:  [9.28985424]


portfolio before change:  [8.09137973]
curr_Stock_Price:  101.364925185197
curr_Factors:  [101.36492519  -1.39749005  -0.94086988]
mat_Sqrt:  [[ 9.78027095  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00332778 -0.00199411  0.17584745]
Stock Position:  0.0033277765958272345
Bond Position:  [7.7540599]


portfolio before change:  [8.09394785]
curr_Stock_Price:  101.84536663206707
curr_Factors:  [101.84536663  -1.33601142  -0.97274227]
mat_Sqrt:  [[10.12190583  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05069658 -0.06656483 -0.70630065]
Stock Position:  -0.05069657891473938
Bond Position:  [13.25715952]


portfolio before change:  [8.12643956]
curr_Stock_Price:  101.23715085239346
curr_Factors:  [101.23715085  -1.25692031  -0.96980972]
mat_Sqrt:  [[10.92152666  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01012054 -0.05671712 -0.29779627]
Stock Position:  0.010120542266016316
Bond Position:  [7.10186469]


portfolio before change:  [8.12850668]
curr_Stock_Price:  101.3536793770456
curr_Factors:  [101.35367938  -1.33139309  -0.9693262 ]
mat_Sqrt:  [[10.15429619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01509747 -0.05534923  0.15513819]
Stock Position:  -0.015097471386067065
Bond Position:  [9.65869095]


portfolio before change:  [8.13077926]
curr_Stock_Price:  101.28312622255186
curr_Factors:  [101.28312622  -1.46124694  -0.97179318]
mat_Sqrt:  [[ 8.88957906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01028674 -0.05281592 -0.07784077]
Stock Position:  -0.010286743909700463
Bond Position:  [9.17265285]


portfolio before change:  [8.12515509]
curr_Stock_Price:  101.9413349056301
curr_Factors:  [101.94133491  -1.42644048  -0.95008696]
mat_Sqrt:  [[ 9.46754902  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01918228 0.23942886 0.32065238]
Stock Position:  0.019182278908388077
Bond Position:  [6.16968797]


portfolio before change:  [8.12372988]
curr_Stock_Price:  101.82682975677804
curr_Factors:  [101.82682976  -1.51636643  -0.92773232]
mat_Sqrt:  [[ 8.83900987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02492734 0.00224035 0.57064795]
Stock Position:  0.024927337466033476
Bond Position:  [5.58545813]


portfolio before change:  [8.13734797]
curr_Stock_Price:  102.3451308737465
curr_Factors:  [102.34513087  -1.21937837  -0.95417309]
mat_Sqrt:  [[11.64409603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06119024 0.07998707 1.34863865]
Stock Position:  0.06119023551739419
Bond Position:  [1.87482531]


portfolio before change:  [8.17010823]
curr_Stock_Price:  102.87668437762237
curr_Factors:  [102.87668438  -0.98171322  -0.96222034]
mat_Sqrt:  [[14.72574717  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01534118 -0.07838042 -0.01210954]
Stock Position:  -0.015341180865939743
Bond Position:  [9.74835805]


portfolio before change:  [8.17555831]
curr_Stock_Price:  102.6008604022252
curr_Factors:  [102.6008604   -0.80807147  -0.96556594]
mat_Sqrt:  [[17.41285817  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172551 -0.00589577  0.26084243]
Stock Position:  -0.0017255085477687867
Bond Position:  [8.35259697]


portfolio before change:  [8.17448169]
curr_Stock_Price:  103.82992313457868
curr_Factors:  [103.82992313  -0.81610234  -0.99019267]
mat_Sqrt:  [[17.05526905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00111352 -0.02533229  0.27183429]
Stock Position:  0.0011135229640416014
Bond Position:  [8.05886469]


portfolio before change:  [8.17600525]
curr_Stock_Price:  104.29343497789927
curr_Factors:  [104.29343498  -0.88701778  -1.00582653]
mat_Sqrt:  [[15.71104709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074395  0.05142562 -0.30681617]
Stock Position:  0.0007439519824500653
Bond Position:  [8.09841594]


portfolio before change:  [8.17725828]
curr_Stock_Price:  104.61693506824616
curr_Factors:  [104.61693507  -0.77933276  -1.0002076 ]
mat_Sqrt:  [[17.65051703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02429197 -0.04531608 -0.6691444 ]
Stock Position:  0.024291970053442427
Bond Position:  [5.63590683]


portfolio before change:  [8.1947547]
curr_Stock_Price:  105.30818784357201
curr_Factors:  [105.30818784  -0.65442382  -1.01743196]
mat_Sqrt:  [[19.78720252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00875446 -0.03044159  0.31851063]
Stock Position:  -0.008754458669916974
Bond Position:  [9.11667088]


portfolio before change:  [8.18634945]
curr_Stock_Price:  106.39847964106104
curr_Factors:  [106.39847964  -0.93762595  -0.99139563]
mat_Sqrt:  [[15.45866534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00351459 -0.00481494 -0.01040365]
Stock Position:  0.0035145855369822093
Bond Position:  [7.81240289]


portfolio before change:  [8.18975616]
curr_Stock_Price:  107.08991402567433
curr_Factors:  [107.08991403  -0.87643026  -1.00790836]
mat_Sqrt:  [[16.2701181   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00462033 -0.02118354  0.04759305]
Stock Position:  -0.004620328688791666
Bond Position:  [8.68454676]


portfolio before change:  [8.19572779]
curr_Stock_Price:  106.03241558783107
curr_Factors:  [106.03241559  -0.94379692  -1.01351194]
mat_Sqrt:  [[14.97580648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01149601 -0.08526538  0.24673618]
Stock Position:  0.011496007345613042
Bond Position:  [6.97677836]


portfolio before change:  [8.20105435]
curr_Stock_Price:  106.41988973540015
curr_Factors:  [106.41988974  -1.09395926  -0.99419647]
mat_Sqrt:  [[13.1870694   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.24409013e-02 7.86129210e-04 1.37178915e+00]
Stock Position:  0.012440901315777717
Bond Position:  [6.877095]


portfolio before change:  [8.18651193]
curr_Stock_Price:  105.18186757786333
curr_Factors:  [105.18186758  -1.073371    -0.97569922]
mat_Sqrt:  [[13.55317315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00171944  0.14184216 -1.19762909]
Stock Position:  -0.0017194418092105926
Bond Position:  [8.36736603]


portfolio before change:  [8.18610068]
curr_Stock_Price:  106.02936725384029
curr_Factors:  [106.02936725  -1.11139343  -0.97510154]
mat_Sqrt:  [[13.16051595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02727324 0.0588402  0.20652322]
Stock Position:  0.027273242295101197
Bond Position:  [5.29433606]


portfolio before change:  [8.14440224]
curr_Stock_Price:  104.47618642323948
curr_Factors:  [104.47618642  -1.26206815  -0.97206489]
mat_Sqrt:  [[11.18782497  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00292368  0.05721198 -0.17766925]
Stock Position:  0.0029236750262195093
Bond Position:  [7.83894782]


portfolio before change:  [8.14966778]
curr_Stock_Price:  105.94201728797897
curr_Factors:  [105.94201729  -1.51185529  -0.96068494]
mat_Sqrt:  [[ 8.93835628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.74133473e-05 -6.49029836e-02 -8.08984332e-01]
Stock Position:  -1.7413347307303895e-05
Bond Position:  [8.15151259]


portfolio before change:  [8.15069411]
curr_Stock_Price:  105.52129022537686
curr_Factors:  [105.52129023  -1.31078077  -0.94590639]
mat_Sqrt:  [[11.04773655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00238967 -0.00768181 -0.03212432]
Stock Position:  0.0023896673449058147
Bond Position:  [7.89853333]


portfolio before change:  [8.15078984]
curr_Stock_Price:  105.14816076062174
curr_Factors:  [105.14816076  -1.31796726  -0.931974  ]
mat_Sqrt:  [[11.08318556  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [5.33814234e-06 5.82961344e-03 4.27448134e-02]
Stock Position:  5.338142336272483e-06
Bond Position:  [8.15022854]


portfolio before change:  [8.15180489]
curr_Stock_Price:  104.43806689179372
curr_Factors:  [104.43806689  -1.26445123  -0.91517279]
mat_Sqrt:  [[11.81027854  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00828268 -0.00740201  0.23054359]
Stock Position:  0.0082826814529932
Bond Position:  [7.28677765]


portfolio before change:  [8.15056882]
curr_Stock_Price:  104.17885417184362
curr_Factors:  [104.17885417  -1.25606286  -0.94886721]
mat_Sqrt:  [[11.48657662  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.016299   -0.01865403  0.51874321]
Stock Position:  0.016298997921919942
Bond Position:  [6.45255789]


portfolio before change:  [8.15971514]
curr_Stock_Price:  104.69052369780933
curr_Factors:  [104.6905237   -1.44872415  -0.96507165]
mat_Sqrt:  [[ 9.36718671  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00577655 -0.00030072 -0.1694354 ]
Stock Position:  -0.005776553685329045
Bond Position:  [8.76446557]


portfolio before change:  [8.15963164]
curr_Stock_Price:  104.89464556911888
curr_Factors:  [104.89464557  -1.22290549  -0.96231097]
mat_Sqrt:  [[11.79575844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00451499 -0.00436612  0.1170317 ]
Stock Position:  -0.0045149898114760275
Bond Position:  [8.6332299]


portfolio before change:  [8.16217752]
curr_Stock_Price:  104.56980394203359
curr_Factors:  [104.56980394  -0.8757958   -0.97454964]
mat_Sqrt:  [[16.43658097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00394197 -0.01988178 -0.11928182]
Stock Position:  -0.00394196976427617
Bond Position:  [8.57438853]


portfolio before change:  [8.1625334]
curr_Stock_Price:  104.75143612637581
curr_Factors:  [104.75143613  -0.93024305  -0.98141777]
mat_Sqrt:  [[15.48589251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069345 -0.01878618 -0.35331381]
Stock Position:  -0.0006934472420177187
Bond Position:  [8.23517299]


portfolio before change:  [8.16232237]
curr_Stock_Price:  106.54030954508639
curr_Factors:  [106.54030955  -0.94515503  -0.9634668 ]
mat_Sqrt:  [[15.79828802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.36209938e-03 -3.39977515e-04  4.28084404e-01]
Stock Position:  0.004362099384569424
Bond Position:  [7.69758295]


portfolio before change:  [8.16774226]
curr_Stock_Price:  107.56221157646179
curr_Factors:  [107.56221158  -0.73348138  -0.96885025]
mat_Sqrt:  [[19.60408114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00444709 -0.03492243 -0.78674148]
Stock Position:  -0.004447086966612362
Bond Position:  [8.64608077]


portfolio before change:  [8.17261846]
curr_Stock_Price:  106.70876226474232
curr_Factors:  [106.70876226  -0.62047324  -1.00221868]
mat_Sqrt:  [[21.06075513  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00430929  0.08275239 -0.22894086]
Stock Position:  0.004309288536091272
Bond Position:  [7.71277961]


portfolio before change:  [8.17181458]
curr_Stock_Price:  106.29847903948767
curr_Factors:  [106.29847904  -0.77362128  -0.97504932]
mat_Sqrt:  [[18.4964787   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.52266248e-05 -3.08587697e-03  1.32662987e-01]
Stock Position:  -7.522662483982639e-05
Bond Position:  [8.17981106]


portfolio before change:  [8.17288857]
curr_Stock_Price:  105.61458027092793
curr_Factors:  [105.61458027  -0.86364299  -0.93399748]
mat_Sqrt:  [[17.49921403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02229168 -0.07831323  0.65345714]
Stock Position:  0.02229167675964285
Bond Position:  [5.81856249]


portfolio before change:  [8.16376494]
curr_Stock_Price:  105.17266661715703
curr_Factors:  [105.17266662  -0.69941868  -0.98948567]
mat_Sqrt:  [[19.42768481  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00424522  0.01201968  0.13102944]
Stock Position:  -0.004245221345243644
Bond Position:  [8.61024619]


portfolio before change:  [8.16062444]
curr_Stock_Price:  106.16598329969675
curr_Factors:  [106.1659833   -0.97507342  -1.0031121 ]
mat_Sqrt:  [[14.6848776   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01956756 -0.00956466  0.19043071]
Stock Position:  0.019567564767522503
Bond Position:  [6.08321469]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.1477402]
Stock Price:  105.46867182154246
PL:  [2.67906838]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.52963355e-01 -9.81113748e-02  2.47918158e-02]
 [-8.22586822e-02  7.25889823e-02 -7.81365208e-02]
 [-7.25952298e-03 -3.00566457e-02  3.15934364e-02]
 [-7.87100603e-01 -3.67553476e-01 -5.14092589e-01]
 [ 2.50268493e-01 -2.55600650e-01 -1.05543135e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.20815976e-02 -1.80436389e-01 -2.76938373e-02]
 [ 1.43227587e-02  6.15695588e-01  8.53377277e-02]
 [ 2.13654385e-01 -1.51877005e-02  2.30312841e-01]
 [ 4.26272597e-01  1.70875340e-01  2.94181118e-01]
 [-1.30418215e-01 -1.72127020e-01  4.19074277e-02]
 [ 3.30770355e-02 -1.34106914e-02  1.13006614e-01]
 [ 1.08836091e-02 -4.76698608e-02  8.48517814e-02]
 [ 1.26640760e-02 -1.40724602e-01 -6.43675299e-02]
 [ 6.83248782e-02 -9.28851397e-02 -8.63420080e-02]
 [ 5.19679156e-02 -1.75995179e-02  3.23915925e-02]
 [ 4.61192459e-02  2.65114199e-02  3.34017932e-03]
 [-4.93647973e-02 -5.86806356e-02  2.45106585e-02]
 [ 5.69064760e-02 -1.80850912e-02 -1.36427992e-01]
 [ 1.01169869e-02  1.60807688e-02 -5.44146000e-03]
 [-2.95904802e-02  4.32874155e-01 -3.91982302e-01]
 [ 2.46818957e-01  1.53542678e-01  8.21852008e-02]
 [-1.74835847e-03 -1.66765180e-02  5.95584053e-02]
 [ 3.38389615e-02 -6.92440444e-02 -1.65313263e-01]
 [ 2.05840269e-02  1.81980066e-02 -1.12407088e-02]
 [-4.85420693e-02 -3.89399380e-03  1.53824649e-01]
 [-1.34024769e-02 -3.23308324e-02  2.81716449e-03]
 [-6.23756862e-02  3.71148708e-02 -2.62226030e-01]
 [-3.41550893e-02 -4.17618229e-02  3.77757774e-02]
 [-4.79507979e-02  9.35810349e-03  3.81362617e-03]
 [ 1.63818478e-02 -4.38078738e-02 -6.76510869e-02]
 [ 1.30317741e-02  1.01379375e-01 -8.73795404e-02]
 [-1.66097568e-02  2.39689937e-02 -4.45723413e-02]
 [ 3.25587004e-02 -4.22979198e-02  1.30214451e-01]
 [-5.98702763e-02  4.54208997e-02 -1.46721223e-02]
 [-4.04365018e-02 -9.73200970e-02 -2.28943526e-02]
 [ 1.37664120e-02  1.02724328e-01  1.27316487e-01]
 [ 1.62964878e-01 -1.18932126e-01 -1.56394435e-01]
 [ 9.94510995e-02  2.75346625e-03  5.69537523e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.67994756]
curr_Stock_Price:  100.91859814944411
curr_Factors:  [100.91859815  -1.10384672  -0.98907294]
mat_Sqrt:  [[12.44594139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02152747 -0.03166531  0.07072415]
Stock Position:  -0.021527471370275043
Bond Position:  [11.85246979]


portfolio before change:  [9.6805962]
curr_Stock_Price:  100.95729364542113
curr_Factors:  [100.95729365  -1.0159416   -0.99752246]
mat_Sqrt:  [[13.48035622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00618612  0.02342799 -0.22290174]
Stock Position:  -0.006186117591041358
Bond Position:  [10.30512989]


portfolio before change:  [9.67535539]
curr_Stock_Price:  102.01272683180181
curr_Factors:  [102.01272683  -1.26811941  -0.97817083]
mat_Sqrt:  [[10.79202389  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064361 -0.00970074  0.09012728]
Stock Position:  -0.000643607443786228
Bond Position:  [9.74101154]


portfolio before change:  [9.67607797]
curr_Stock_Price:  102.78201596553953
curr_Factors:  [102.78201597  -1.51323566  -0.99628172]
mat_Sqrt:  [[ 8.35694569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11572001 -0.11862737 -1.46656306]
Stock Position:  -0.1157200117303628
Bond Position:  [21.57001406]


portfolio before change:  [9.70520533]
curr_Stock_Price:  102.55361173874041
curr_Factors:  [102.55361174  -1.65370784  -1.00739828]
mat_Sqrt:  [[ 7.1655125   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0246389  -0.08249476 -0.30108519]
Stock Position:  0.024638897353563637
Bond Position:  [7.17839742]


portfolio before change:  [9.68806299]
curr_Stock_Price:  101.8214485294735
curr_Factors:  [101.82144853  -1.61417492  -0.9935884 ]
mat_Sqrt:  [[ 7.50415945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02042923 -0.05534923  0.15513819]
Stock Position:  -0.020429229564524778
Bond Position:  [11.76819674]


portfolio before change:  [9.69105674]
curr_Stock_Price:  101.7469164835533
curr_Factors:  [101.74691648  -1.23900717  -1.01335186]
mat_Sqrt:  [[10.69877761  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00883895 -0.05823559 -0.07900281]
Stock Position:  -0.008838953910351267
Bond Position:  [10.59039304]


portfolio before change:  [9.69851728]
curr_Stock_Price:  101.05264164065832
curr_Factors:  [101.05264164  -1.15419279  -1.02255381]
mat_Sqrt:  [[11.46036988  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01373608 0.1987149  0.24344478]
Stock Position:  0.01373608241090017
Bond Position:  [8.31044987]


portfolio before change:  [9.69729753]
curr_Stock_Price:  100.88821157019835
curr_Factors:  [100.88821157  -1.2489538   -1.04797361]
mat_Sqrt:  [[10.1460622   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02538587 -0.00490181  0.65701843]
Stock Position:  0.02538587046418602
Bond Position:  [7.13616246]


portfolio before change:  [9.70055025]
curr_Stock_Price:  100.98120222570155
curr_Factors:  [100.98120223  -1.23446502  -1.03379174]
mat_Sqrt:  [[10.45079052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.049872   0.05514978 0.83921684]
Stock Position:  0.049872002312207786
Bond Position:  [4.6644155]


portfolio before change:  [9.67194578]
curr_Stock_Price:  100.39595285291945
curr_Factors:  [100.39595285  -1.30652574  -1.03268247]
mat_Sqrt:  [[ 9.67856539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01622133 -0.05555376  0.11955023]
Stock Position:  -0.016221327403793073
Bond Position:  [11.30050141]


portfolio before change:  [9.67948594]
curr_Stock_Price:  100.01820886139365
curr_Factors:  [100.01820886  -1.35713272  -1.05162774]
mat_Sqrt:  [[ 8.99430681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00593786 -0.00432828  0.32237642]
Stock Position:  0.005937863724337719
Bond Position:  [9.08559145]


portfolio before change:  [9.68039025]
curr_Stock_Price:  99.97922825301778
curr_Factors:  [99.97922825 -1.22728465 -1.02948099]
mat_Sqrt:  [[10.46667932  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00176497 -0.01538538  0.24205851]
Stock Position:  0.0017649663571114031
Bond Position:  [9.50393028]


portfolio before change:  [9.68212152]
curr_Stock_Price:  100.28699481319698
curr_Factors:  [100.28699481  -1.32596641  -1.03436694]
mat_Sqrt:  [[ 9.46596441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308475 -0.04541867 -0.18362265]
Stock Position:  -0.003084754914413203
Bond Position:  [9.99148232]


portfolio before change:  [9.68256125]
curr_Stock_Price:  100.54934318598978
curr_Factors:  [100.54934319  -1.17268407  -1.03577499]
mat_Sqrt:  [[11.04733831  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00287312 -0.02997855 -0.24630972]
Stock Position:  0.0028731164926558664
Bond Position:  [9.39367127]


portfolio before change:  [9.68179668]
curr_Stock_Price:  99.87451767449367
curr_Factors:  [99.87451767 -0.85037628 -1.03913444]
mat_Sqrt:  [[15.09560828  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0036426  -0.00568022  0.0924042 ]
Stock Position:  0.0036426047990608763
Bond Position:  [9.31799328]


portfolio before change:  [9.68360409]
curr_Stock_Price:  100.0509278567443
curr_Factors:  [100.05092786  -1.16225952  -1.05175794]
mat_Sqrt:  [[10.93164593  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00477629 0.00855652 0.0095286 ]
Stock Position:  0.004776286979470444
Bond Position:  [9.20573215]


portfolio before change:  [9.68565536]
curr_Stock_Price:  100.23945932758946
curr_Factors:  [100.23945933  -0.93270014  -1.051718  ]
mat_Sqrt:  [[13.77897364  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00408882 -0.01893909  0.06992209]
Stock Position:  -0.004088817946115378
Bond Position:  [10.09551626]


portfolio before change:  [9.68625726]
curr_Stock_Price:  100.40090472078936
curr_Factors:  [100.40090472  -0.92108227  -1.04847813]
mat_Sqrt:  [[14.00775099  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0018109  -0.00583694 -0.38919109]
Stock Position:  0.0018108991976643612
Bond Position:  [9.50444134]


portfolio before change:  [9.6858505]
curr_Stock_Price:  99.5201881219985
curr_Factors:  [99.52018812 -1.02881073 -1.04753043]
mat_Sqrt:  [[12.47865219  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00098478  0.00519005 -0.01552297]
Stock Position:  0.0009847799708191892
Bond Position:  [9.58784501]


portfolio before change:  [9.68642727]
curr_Stock_Price:  98.88878860349327
curr_Factors:  [98.8887886  -0.99733494 -1.04023394]
mat_Sqrt:  [[12.88967997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016481   0.13970953 -1.1182164 ]
Stock Position:  -0.0016480987626498697
Bond Position:  [9.84940576]


portfolio before change:  [9.68930879]
curr_Stock_Price:  97.88747119684581
curr_Factors:  [97.8874712  -0.83788336 -1.0582545 ]
mat_Sqrt:  [[14.69754834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02006707 0.04955569 0.2344515 ]
Stock Position:  0.02006706846333681
Bond Position:  [7.7249942]


portfolio before change:  [9.71854804]
curr_Stock_Price:  99.29642457731029
curr_Factors:  [99.29642458 -1.17962611 -1.08507981]
mat_Sqrt:  [[10.3129836   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00067923 -0.00538232  0.16990355]
Stock Position:  0.0006792282815468254
Bond Position:  [9.6511031]


portfolio before change:  [9.71975501]
curr_Stock_Price:  99.29718040665543
curr_Factors:  [99.29718041 -1.08003782 -1.10938036]
mat_Sqrt:  [[11.11948527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126263 -0.02234842 -0.47159272]
Stock Position:  -0.0012626347362455204
Bond Position:  [9.84513108]


portfolio before change:  [9.72142304]
curr_Stock_Price:  98.9508322009409
curr_Factors:  [98.9508322  -0.89990822 -1.1277567 ]
mat_Sqrt:  [[13.02614073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00168923  0.00587338 -0.03206661]
Stock Position:  0.0016892324339490674
Bond Position:  [9.55427209]


portfolio before change:  [9.72419351]
curr_Stock_Price:  99.88386243943525
curr_Factors:  [99.88386244 -1.03644778 -1.1426763 ]
mat_Sqrt:  [[11.3009191   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00158727 -0.00125678  0.43881891]
Stock Position:  -0.001587269339696114
Bond Position:  [9.8827361]


portfolio before change:  [9.72639264]
curr_Stock_Price:  99.27671159157946
curr_Factors:  [99.27671159 -1.19937873 -1.13548802]
mat_Sqrt:  [[ 9.61230711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202105 -0.01043473  0.00803659]
Stock Position:  -0.0020210474913007247
Bond Position:  [9.92703559]


portfolio before change:  [9.72739891]
curr_Stock_Price:  99.39283126816353
curr_Factors:  [99.39283127 -1.52172331 -1.12018426]
mat_Sqrt:  [[ 7.07928153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01530188  0.01197877 -0.74805787]
Stock Position:  -0.015301878977315381
Bond Position:  [11.24829599]


portfolio before change:  [9.7402802]
curr_Stock_Price:  98.64291241271695
curr_Factors:  [98.64291241 -1.16209548 -1.08190778]
mat_Sqrt:  [[10.45942129  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00334328 -0.01347857  0.10776378]
Stock Position:  -0.0033432765001269325
Bond Position:  [10.07007074]


portfolio before change:  [9.73983967]
curr_Stock_Price:  99.15120851574416
curr_Factors:  [99.15120852 -1.19503521 -1.05435592]
mat_Sqrt:  [[10.45682538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00432848  0.00302031  0.01087921]
Stock Position:  -0.0043284771626147115
Bond Position:  [10.16901341]


portfolio before change:  [9.73910456]
curr_Stock_Price:  99.61472266469058
curr_Factors:  [99.61472266 -1.12702841 -1.06774244]
mat_Sqrt:  [[11.09549447  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057407 -0.01413893 -0.19298972]
Stock Position:  -0.0005740724109374622
Bond Position:  [9.79629063]


portfolio before change:  [9.74114226]
curr_Stock_Price:  98.19838179699029
curr_Factors:  [98.1983818  -0.73174106 -1.03695453]
mat_Sqrt:  [[16.74825625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094872  0.03272005 -0.24926951]
Stock Position:  0.0009487243395100116
Bond Position:  [9.64797906]


portfolio before change:  [9.74260008]
curr_Stock_Price:  98.4637320212716
curr_Factors:  [98.46373202 -0.82020017 -1.0503165 ]
mat_Sqrt:  [[15.16775218  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137235  0.00773596 -0.12715248]
Stock Position:  -0.0013723455693272506
Bond Position:  [9.87772634]


portfolio before change:  [9.7441686]
curr_Stock_Price:  98.22055085628685
curr_Factors:  [98.22055086 -0.75036835 -1.04741536]
mat_Sqrt:  [[16.271771    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00310382 -0.01365159  0.37146559]
Stock Position:  0.0031038162537918544
Bond Position:  [9.43931006]


portfolio before change:  [9.74802895]
curr_Stock_Price:  99.0841217419602
curr_Factors:  [99.08412174 -0.7388138  -1.04534861]
mat_Sqrt:  [[16.63995605  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00322078  0.01465953 -0.04185548]
Stock Position:  -0.00322078425134542
Bond Position:  [10.06715753]


portfolio before change:  [9.75504211]
curr_Stock_Price:  97.29738797504476
curr_Factors:  [97.29738798 -0.8904464  -1.02119658]
mat_Sqrt:  [[14.38418248  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00451713 -0.03140993 -0.06531122]
Stock Position:  -0.004517126618072981
Bond Position:  [10.19454673]


portfolio before change:  [9.75725119]
curr_Stock_Price:  97.09046804646341
curr_Factors:  [97.09046805 -0.99451296 -1.0425589 ]
mat_Sqrt:  [[12.66156899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00479587 0.03315413 0.3631985 ]
Stock Position:  0.004795874566773024
Bond Position:  [9.29161748]


portfolio before change:  [9.75441552]
curr_Stock_Price:  96.25700340664204
curr_Factors:  [96.25700341 -0.92431363 -1.02750949]
mat_Sqrt:  [[13.66993106  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00781014 -0.03838518 -0.44614979]
Stock Position:  0.007810140269888789
Bond Position:  [9.00263482]


portfolio before change:  [9.7539531]
curr_Stock_Price:  96.0537010382889
curr_Factors:  [96.05370104 -0.8294382  -1.00624907]
mat_Sqrt:  [[15.32093438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00728668 0.00088868 0.1624732 ]
Stock Position:  0.007286682504868848
Bond Position:  [9.05404028]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.75761419]
Stock Price:  96.40080798120864
PL:  [9.75761419]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.19666319e-01 -1.98430477e-02 -1.65935717e-04]
 [-3.83672438e-01  6.40431183e-02 -6.27370688e-01]
 [-3.39705935e-02  4.26551364e-02  2.24290405e-02]
 [ 1.01346937e-01  1.94125481e-02  1.33370629e-01]
 [ 1.52754904e-01 -1.43200610e-01 -9.78331274e-02]
 [-1.29615311e-01 -1.68435194e-01  7.16711871e-02]
 [-5.52619695e-02 -1.76361610e-01  2.86036584e-02]
 [ 6.97216593e-03  6.89671793e-01  1.04990556e-01]
 [ 4.42082076e-01  6.08201167e-02  4.32376649e-01]
 [ 5.88731662e-01  2.64415735e-01  5.14585740e-01]
 [ 5.85454608e-02 -7.53048877e-02  3.86284999e-02]
 [-1.08258185e-01 -2.34135131e-02  7.98137893e-02]
 [ 1.59557081e-02 -9.07004290e-02  1.14193764e-01]
 [ 2.00511825e-03  7.19587422e-02 -3.40816109e-02]
 [ 5.84794963e-01 -1.61040367e-01 -2.66615517e-01]
 [-1.81587245e-01 -9.45740373e-02  1.12626029e-01]
 [ 5.56512831e-02 -5.20803305e-03 -5.97974660e-03]
 [-6.27295741e-02 -6.41846473e-02  2.01739710e-02]
 [ 1.92180920e-01 -2.41102828e-01  6.60969147e-02]
 [ 5.16536524e-02 -1.21446343e-03  3.97215082e-01]
 [-3.71451827e-02  5.12306583e-01 -4.96373320e-01]
 [ 1.18712605e-01  9.22442204e-02  1.03046417e-01]
 [-7.56151048e-03  1.59714705e-01 -5.59186718e-02]
 [-1.57390199e-03 -1.53174249e-01 -1.14236521e-01]
 [ 4.28266121e-02  1.10229945e-03 -1.25110393e-02]
 [-1.84635472e-03  1.83460933e-02  2.26424327e-02]
 [ 8.49584007e-02 -2.95723346e-02  2.89706000e-02]
 [ 1.57807564e-01 -6.12229641e-02  1.56801767e-01]
 [-4.21060542e-02 -2.22185588e-03 -5.69037262e-02]
 [-6.07728826e-02 -1.37615314e-02  3.98996147e-02]
 [-4.04438466e-02 -6.15052401e-02 -4.37123321e-02]
 [ 2.63687468e-02 -5.18152185e-02 -1.13669661e-01]
 [ 5.93853008e-02  5.19105476e-03  1.42242108e-01]
 [ 3.36604567e-03 -8.49366096e-02 -1.14714328e-01]
 [ 5.41749276e-03  6.65171356e-02  3.74378056e-02]
 [ 5.22784181e-02  2.60875032e-02  1.47796306e-01]
 [ 1.93552919e-01 -1.40554059e-01  9.36645019e-02]
 [-9.09198398e-02  1.70442137e-02  4.49625817e-02]
 [ 1.08475437e-01  4.43745061e-03  1.02326443e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.79571959]
curr_Stock_Price:  99.34576028740784
curr_Factors:  [99.34576029 -1.16682524 -1.02915499]
mat_Sqrt:  [[11.05216201  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01045786 -0.00640432 -0.00047337]
Stock Position:  0.010457863561464182
Bond Position:  [-3.834664]


portfolio before change:  [-2.80461627]
curr_Stock_Price:  98.54088097931891
curr_Factors:  [98.54088098 -1.21686214 -1.04739009]
mat_Sqrt:  [[10.23915673  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04870139  0.02066983 -1.78971395]
Stock Position:  -0.04870139309379058
Bond Position:  [1.99446191]


portfolio before change:  [-2.8717426]
curr_Stock_Price:  99.9243249341085
curr_Factors:  [99.92432493 -1.08714021 -1.06621918]
mat_Sqrt:  [[11.60056447  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00178313  0.01376689  0.06398381]
Stock Position:  -0.0017831323290917397
Bond Position:  [-2.6935643]


portfolio before change:  [-2.8726539]
curr_Stock_Price:  100.24656226585134
curr_Factors:  [100.24656227  -1.05107908  -1.09030833]
mat_Sqrt:  [[11.77814114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01125251 0.00626537 0.38046928]
Stock Position:  0.011252511787973908
Bond Position:  [-4.00067953]


portfolio before change:  [-2.86311575]
curr_Stock_Price:  101.13865390542148
curr_Factors:  [101.13865391  -1.17851594  -1.11056058]
mat_Sqrt:  [[10.25141628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01010144 -0.0462178  -0.27909068]
Stock Position:  0.010101443087615831
Bond Position:  [-3.88476211]


portfolio before change:  [-2.86982149]
curr_Stock_Price:  100.522888419008
curr_Factors:  [100.52288842  -1.07231187  -1.13510156]
mat_Sqrt:  [[11.05598619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01351007 -0.05436223  0.20445795]
Stock Position:  -0.013510073068069915
Bond Position:  [-1.51174993]


portfolio before change:  [-2.87056445]
curr_Stock_Price:  100.56389316639255
curr_Factors:  [100.56389317  -0.92994552  -1.18402114]
mat_Sqrt:  [[12.14389559  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00703423 -0.05692046  0.08159828]
Stock Position:  -0.007034228387249009
Bond Position:  [-2.16317506]


portfolio before change:  [-2.88282973]
curr_Stock_Price:  102.2691064282409
curr_Factors:  [102.26910643  -1.12474745  -1.18379487]
mat_Sqrt:  [[10.16616772  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01664166 0.22259061 0.29950883]
Stock Position:  0.01664166313780188
Bond Position:  [-4.58475774]


portfolio before change:  [-2.87005951]
curr_Stock_Price:  103.0709099767894
curr_Factors:  [103.07090998  -1.18189068  -1.2214508 ]
mat_Sqrt:  [[ 9.31919004  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05824062 0.01962961 1.23345023]
Stock Position:  0.058240624147262846
Bond Position:  [-8.87297364]


portfolio before change:  [-2.86194422]
curr_Stock_Price:  103.22929570645391
curr_Factors:  [103.22929571  -1.27781355  -1.18651731]
mat_Sqrt:  [[ 8.78127693  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08515216 0.08533981 1.46796988]
Stock Position:  0.08515215696134276
Bond Position:  [-11.65214141]


portfolio before change:  [-2.76312447]
curr_Stock_Price:  104.40690956059797
curr_Factors:  [104.40690956  -1.40097965  -1.22511577]
mat_Sqrt:  [[ 7.55493077  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00675836 -0.02430455  0.11019636]
Stock Position:  0.006758357690067145
Bond Position:  [-3.46874371]


portfolio before change:  [-2.76169378]
curr_Stock_Price:  104.6827618895952
curr_Factors:  [104.68276189  -1.18751479  -1.23351524]
mat_Sqrt:  [[ 9.29897733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01040389 -0.00755668  0.22768653]
Stock Position:  -0.01040388883080593
Bond Position:  [-1.67258596]


portfolio before change:  [-2.762739]
curr_Stock_Price:  104.76312933141291
curr_Factors:  [104.76312933  -1.20955797  -1.2441155 ]
mat_Sqrt:  [[ 9.00723743  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00230384 -0.02927344  0.32576302]
Stock Position:  0.002303843461685959
Bond Position:  [-3.00409685]


portfolio before change:  [-2.76178676]
curr_Stock_Price:  105.33945785819363
curr_Factors:  [105.33945786  -1.45369948  -1.22787232]
mat_Sqrt:  [[ 7.21106225  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00135025  0.02322458 -0.09722535]
Stock Position:  0.001350252564363435
Bond Position:  [-2.90402164]


portfolio before change:  [-2.76180022]
curr_Stock_Price:  105.59834960840001
curr_Factors:  [105.59834961  -1.15531482  -1.19630309]
mat_Sqrt:  [[10.05454556  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04948012 -0.05197556 -0.76057986]
Stock Position:  0.04948011503248015
Bond Position:  [-7.98681871]


portfolio before change:  [-2.76779708]
curr_Stock_Price:  105.49733037857008
curr_Factors:  [105.49733038  -0.96406213  -1.16681017]
mat_Sqrt:  [[12.52608596  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01420255 -0.03052364  0.32129071]
Stock Position:  -0.01420255282200136
Bond Position:  [-1.26946567]


portfolio before change:  [-2.77039273]
curr_Stock_Price:  105.6689161417136
curr_Factors:  [105.66891614  -1.05312319  -1.1615402 ]
mat_Sqrt:  [[11.53801677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00462537 -0.00168089 -0.01705855]
Stock Position:  0.004625369175715903
Bond Position:  [-3.25915047]


portfolio before change:  [-2.77195981]
curr_Stock_Price:  105.41819800523939
curr_Factors:  [105.41819801  -1.0171108   -1.12531514]
mat_Sqrt:  [[12.37290908  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00579599 -0.02071551  0.05755072]
Stock Position:  -0.005795986646692096
Bond Position:  [-2.16095734]


portfolio before change:  [-2.77286959]
curr_Stock_Price:  105.52855711791999
curr_Factors:  [105.52855712  -0.82244103  -1.13422562]
mat_Sqrt:  [[14.91421743  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01049053 -0.0778156   0.1885561 ]
Stock Position:  0.010490526140043503
Bond Position:  [-3.87991967]


portfolio before change:  [-2.77277721]
curr_Stock_Price:  105.58359705687626
curr_Factors:  [105.58359706  -0.82670281  -1.14447107]
mat_Sqrt:  [[14.70708203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.00837704e-03 -3.91966386e-04  1.13314406e+00]
Stock Position:  0.009008377040432981
Bond Position:  [-3.72391406]


portfolio before change:  [-2.77939672]
curr_Stock_Price:  104.90045620717348
curr_Factors:  [104.90045621  -0.68060923  -1.16760307]
mat_Sqrt:  [[16.52376354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00205116  0.16534624 -1.41601492]
Stock Position:  -0.002051156134624541
Bond Position:  [-2.5642295]


portfolio before change:  [-2.77641088]
curr_Stock_Price:  103.28849547650164
curr_Factors:  [103.28849548  -0.85737201  -1.16747207]
mat_Sqrt:  [[13.63557135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01162959 0.02977169 0.29396275]
Stock Position:  0.011629592603343984
Bond Position:  [-3.97761401]


portfolio before change:  [-2.76801668]
curr_Stock_Price:  104.05304854016622
curr_Factors:  [104.05304854  -0.89654968  -1.15456936]
mat_Sqrt:  [[13.38027773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00101835  0.0515477  -0.15952041]
Stock Position:  0.0010183470345942378
Bond Position:  [-2.87397879]


portfolio before change:  [-2.76947207]
curr_Stock_Price:  102.97667506952531
curr_Factors:  [102.97667507  -0.98417041  -1.16089162]
mat_Sqrt:  [[12.05452936  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00465874 -0.04943678 -0.325885  ]
Stock Position:  -0.004658738247167505
Bond Position:  [-2.28973069]


portfolio before change:  [-2.7699049]
curr_Stock_Price:  103.00814258413193
curr_Factors:  [103.00814258  -0.95534497  -1.20226135]
mat_Sqrt:  [[11.90789615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00340092  0.00035577 -0.03569051]
Stock Position:  0.0034009208924287433
Bond Position:  [-3.12022744]


portfolio before change:  [-2.76783582]
curr_Stock_Price:  103.73122218742054
curr_Factors:  [103.73122219  -0.90888875  -1.21859876]
mat_Sqrt:  [[12.35814848  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00052762 0.00592118 0.06459256]
Stock Position:  0.0005276189315645498
Bond Position:  [-2.82256637]


portfolio before change:  [-2.76829044]
curr_Stock_Price:  103.53831558447146
curr_Factors:  [103.53831558  -0.71121914  -1.23310563]
mat_Sqrt:  [[14.81465617  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00572646 -0.00954443  0.08264506]
Stock Position:  0.005726462440841975
Bond Position:  [-3.36119872]


portfolio before change:  [-2.76642269]
curr_Stock_Price:  103.937851880622
curr_Factors:  [103.93785188  -0.82641451  -1.23737839]
mat_Sqrt:  [[13.19714141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01343605 -0.01975963  0.4473118 ]
Stock Position:  0.01343605407196782
Bond Position:  [-4.16293729]


portfolio before change:  [-2.76321538]
curr_Stock_Price:  104.21529239639872
curr_Factors:  [104.2152924   -0.79762421  -1.22591317]
mat_Sqrt:  [[13.77591105  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00393259 -0.0007171  -0.16233049]
Stock Position:  -0.003932590220822003
Bond Position:  [-2.35337934]


portfolio before change:  [-2.76561751]
curr_Stock_Price:  104.75130941571487
curr_Factors:  [104.75130942  -0.73537834  -1.21950157]
mat_Sqrt:  [[14.83084515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00373798 -0.00444152  0.11382249]
Stock Position:  -0.00373798445861316
Bond Position:  [-2.37405874]


portfolio before change:  [-2.76325751]
curr_Stock_Price:  104.04055815869222
curr_Factors:  [104.04055816  -0.9465736   -1.21326348]
mat_Sqrt:  [[12.00044496  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00515992 -0.01985073 -0.12469912]
Stock Position:  -0.005159916471050948
Bond Position:  [-2.22641692]


portfolio before change:  [-2.76601581]
curr_Stock_Price:  104.52118371181763
curr_Factors:  [104.52118371  -0.9918916   -1.19328396]
mat_Sqrt:  [[11.75424213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063047 -0.01672329 -0.3242679 ]
Stock Position:  -0.0006304713387190851
Bond Position:  [-2.7001182]


portfolio before change:  [-2.76616514]
curr_Stock_Price:  104.22265962997315
curr_Factors:  [104.22265963  -0.85874178  -1.18998584]
mat_Sqrt:  [[13.43417651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00666062 0.00167541 0.40577714]
Stock Position:  0.006660621812353822
Bond Position:  [-3.46035286]


portfolio before change:  [-2.76950544]
curr_Stock_Price:  103.78610456168063
curr_Factors:  [103.78610456  -0.90994767  -1.17865155]
mat_Sqrt:  [[12.85500047  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0029084  -0.02741317 -0.32724805]
Stock Position:  -0.0029084037342008645
Bond Position:  [-2.46765354]


portfolio before change:  [-2.76820928]
curr_Stock_Price:  103.23438060066663
curr_Factors:  [103.2343806   -0.81095188  -1.18803138]
mat_Sqrt:  [[13.98546657  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00190463 0.02146831 0.10679964]
Stock Position:  0.0019046347972951363
Bond Position:  [-2.96483307]


portfolio before change:  [-2.76783311]
curr_Stock_Price:  103.62647496033264
curr_Factors:  [103.62647496  -0.7859203   -1.22015364]
mat_Sqrt:  [[13.93939363  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00629671 0.00841971 0.42162172]
Stock Position:  0.006296708758724394
Bond Position:  [-3.42033884]


portfolio before change:  [-2.77007084]
curr_Stock_Price:  103.3389978222868
curr_Factors:  [103.33899782  -0.90540942  -1.22288556]
mat_Sqrt:  [[12.30148325  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01495605 -0.04536363  0.26719875]
Stock Position:  0.014956052405523852
Bond Position:  [-4.3156143]


portfolio before change:  [-2.77701574]
curr_Stock_Price:  102.91071543763537
curr_Factors:  [102.91071544  -0.82820603  -1.23007478]
mat_Sqrt:  [[13.13894818  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00595655  0.005501    0.12826573]
Stock Position:  -0.005956546487883975
Bond Position:  [-2.16402328]


portfolio before change:  [-2.77475701]
curr_Stock_Price:  102.48609936462898
curr_Factors:  [102.48609936  -0.58160139  -1.19301518]
mat_Sqrt:  [[17.37635904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00749688 0.00143218 0.29190886]
Stock Position:  0.007496882674696194
Bond Position:  [-3.54308327]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.76791541]
Stock Price:  103.4577720661321
PL:  [-6.22568747]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.07576186e-01 -1.03773461e-01  1.93973891e-02]
 [-9.72684536e-02  6.46608762e-02  5.60635348e-02]
 [-1.23459460e-01 -1.54509270e-02 -6.60145725e-02]
 [-3.49282192e-01 -1.33402879e-01 -2.12341425e-01]
 [ 2.22643511e-01 -2.28875119e-01 -1.05157354e-01]
 [-1.29428004e-01 -1.73140327e-01  4.30217256e-02]
 [-5.11790980e-02 -2.00926987e-01 -2.98756157e-02]
 [ 8.28988423e-03  6.10633397e-01  9.26982955e-02]
 [ 4.57581175e-01  6.72793062e-02  4.45821131e-01]
 [ 7.39438737e-01  3.42872956e-01  6.92206865e-01]
 [-1.01352181e-01 -2.97092504e-01 -7.80080503e-02]
 [-8.46200703e-02 -2.13790267e-02  7.97549670e-02]
 [ 1.53159859e-02 -7.08537980e-02  8.34689641e-02]
 [ 1.42953481e-03  1.31159388e-01 -7.57078050e-02]
 [ 3.74947305e-01 -1.54803614e-01 -1.85388576e-01]
 [-1.81900748e-01 -9.45905610e-02  1.12689373e-01]
 [ 5.09637701e-02  1.78166997e-02 -2.49943071e-02]
 [-6.51811290e-02 -6.56347921e-02  1.66833835e-02]
 [ 2.17167368e-01 -2.76589077e-01  9.74511399e-02]
 [ 4.36375947e-02 -3.52534070e-03  3.45009031e-01]
 [-5.49605964e-02  6.27665974e-01 -6.02803122e-01]
 [ 4.94174870e-01  2.71901648e-01  4.19050336e-02]
 [-2.16386461e-01  2.18391913e-01 -1.27511817e-01]
 [-6.84087567e-03 -1.40986379e-01 -1.19586283e-01]
 [-1.53977988e-02 -3.89417702e-02 -5.84889818e-03]
 [-1.05683836e-02  1.74786819e-02  1.48460250e-02]
 [ 8.60602730e-02 -6.01804453e-03  2.15561313e-01]
 [ 1.69200954e-01 -5.16844617e-02  2.26524836e-01]
 [-2.76701533e-02  2.35566367e-02 -1.00332626e-01]
 [-7.00077178e-02  2.94573382e-02 -1.77908739e-02]
 [ 1.44295256e-01  1.98784506e-02  4.26131849e-02]
 [ 2.73069064e-02 -1.60625807e-01 -2.87003799e-01]
 [ 1.05811103e-02 -2.82577123e-03  1.59352927e-01]
 [-2.88902115e-02 -1.46626488e-01 -5.41786411e-01]
 [ 1.69671930e-01  6.84848500e-01 -3.64047337e-01]
 [ 7.32543893e-03  9.25579530e-02  3.73313043e-02]
 [ 7.71877483e-01 -3.92161783e-01  6.29337194e-01]
 [-1.88797426e-01  1.23661918e-01  6.77540238e-02]
 [ 5.71617413e-01 -8.95494340e-02 -1.91511290e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.63366304]
curr_Stock_Price:  100.40847316606099
curr_Factors:  [100.40847317  -0.82570286  -0.96593124]
mat_Sqrt:  [[16.7368438   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01343141 -0.03349274  0.05533535]
Stock Position:  -0.013431408092499009
Bond Position:  [6.98229022]


portfolio before change:  [5.64807223]
curr_Stock_Price:  99.40066020068822
curr_Factors:  [99.4006602  -0.63041499 -0.96877059]
mat_Sqrt:  [[20.08499827  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361592  0.02086921  0.15993366]
Stock Position:  -0.0036159169825283975
Bond Position:  [6.00749676]


portfolio before change:  [5.64247088]
curr_Stock_Price:  101.15742827146974
curr_Factors:  [101.15742827  -0.59542431  -0.97992307]
mat_Sqrt:  [[20.93307878  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00669221 -0.00498677 -0.1883212 ]
Stock Position:  -0.006692208859018067
Bond Position:  [6.31943752]


portfolio before change:  [5.63659383]
curr_Stock_Price:  102.15366588612544
curr_Factors:  [102.15366589  -0.72667752  -0.99619541]
mat_Sqrt:  [[18.23978647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02301874 -0.04305559 -0.60575098]
Stock Position:  -0.023018742763674913
Bond Position:  [7.98804279]


portfolio before change:  [5.63111628]
curr_Stock_Price:  102.43500700862407
curr_Factors:  [102.43500701  -0.95189825  -0.98940179]
mat_Sqrt:  [[14.70119055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01050659 -0.07386913 -0.29998466]
Stock Position:  0.0105065924407306
Bond Position:  [4.55487341]


portfolio before change:  [5.63382126]
curr_Stock_Price:  102.63826859328991
curr_Factors:  [102.63826859  -0.95606559  -0.99004561]
mat_Sqrt:  [[14.65966219  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01064065 -0.0558808   0.12272901]
Stock Position:  -0.010640651196370867
Bond Position:  [6.72595928]


portfolio before change:  [5.63076638]
curr_Stock_Price:  103.00438171835674
curr_Factors:  [103.00438172  -1.06337744  -0.99082503]
mat_Sqrt:  [[13.20465032  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0074437  -0.06484891 -0.08522682]
Stock Position:  -0.007443701997303887
Bond Position:  [6.3975003]


portfolio before change:  [5.63237756]
curr_Stock_Price:  102.89537024248804
curr_Factors:  [102.89537024  -0.9422691   -0.97104416]
mat_Sqrt:  [[15.18638633  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00999954 0.19708108 0.26444243]
Stock Position:  0.009999539161679338
Bond Position:  [4.60347128]


portfolio before change:  [5.63545982]
curr_Stock_Price:  103.14606005768398
curr_Factors:  [103.14606006  -0.88032156  -0.97072595]
mat_Sqrt:  [[16.20141411  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03470792 0.0217143  1.27180359]
Stock Position:  0.03470791863129681
Bond Position:  [2.05547476]


portfolio before change:  [5.67001909]
curr_Stock_Price:  104.13437401976181
curr_Factors:  [104.13437402  -1.11031898  -0.96424318]
mat_Sqrt:  [[13.08046582  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0726827  0.11066177 1.97467351]
Stock Position:  0.07268269604109275
Bond Position:  [-1.89874797]


portfolio before change:  [5.72253536]
curr_Stock_Price:  104.86018133597653
curr_Factors:  [104.86018134  -0.94864581  -0.93831401]
mat_Sqrt:  [[15.88965133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01119718 -0.09588619 -0.22253525]
Stock Position:  -0.011197178426722758
Bond Position:  [6.89667352]


portfolio before change:  [5.73018945]
curr_Stock_Price:  104.25360466750166
curr_Factors:  [104.25360467  -0.95176513  -0.92200239]
mat_Sqrt:  [[16.00752484  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00454187 -0.00690005  0.22751872]
Stock Position:  -0.004541872155576483
Bond Position:  [6.20369599]


portfolio before change:  [5.73275044]
curr_Stock_Price:  103.86048915230505
curr_Factors:  [103.86048915  -0.88709452  -0.93494461]
mat_Sqrt:  [[16.79379416  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00106534 -0.02286796  0.23811372]
Stock Position:  0.0010653367375111607
Bond Position:  [5.62210404]


portfolio before change:  [5.73368488]
curr_Stock_Price:  104.07791558214991
curr_Factors:  [104.07791558  -1.0662435   -0.9182569 ]
mat_Sqrt:  [[14.30543315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00089117  0.04233151 -0.21597329]
Stock Position:  0.0008911678304996337
Bond Position:  [5.64093399]


portfolio before change:  [5.73370083]
curr_Stock_Price:  103.30454190315403
curr_Factors:  [103.3045419   -0.90537398  -0.89455406]
mat_Sqrt:  [[17.07735488  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01788953 -0.04996265 -0.52886201]
Stock Position:  0.017889530754287186
Bond Position:  [3.88563105]


portfolio before change:  [5.76654864]
curr_Stock_Price:  105.1135372106363
curr_Factors:  [105.11353721  -0.91591183  -0.87717302]
mat_Sqrt:  [[17.4957189   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01018571 -0.03052897  0.32147141]
Stock Position:  -0.010185711404356994
Bond Position:  [6.8372048]


portfolio before change:  [5.77683186]
curr_Stock_Price:  104.18787690462835
curr_Factors:  [104.1878769   -0.89260957  -0.84671984]
mat_Sqrt:  [[18.29936514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00270494  0.00575032 -0.0713018 ]
Stock Position:  0.002704937946327144
Bond Position:  [5.49501012]


portfolio before change:  [5.77934836]
curr_Stock_Price:  104.8642640481184
curr_Factors:  [104.86426405  -0.63444767  -0.85533421]
mat_Sqrt:  [[23.63869335  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031801  -0.02118354  0.04759305]
Stock Position:  -0.003180095121551684
Bond Position:  [6.1128267]


portfolio before change:  [5.77519032]
curr_Stock_Price:  106.41207705096981
curr_Factors:  [106.41207705  -0.49413026  -0.88441823]
mat_Sqrt:  [[26.80988315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00673636 -0.08926874  0.27800098]
Stock Position:  0.006736358689087891
Bond Position:  [5.0583604]


portfolio before change:  [5.7668326]
curr_Stock_Price:  105.07751970626438
curr_Factors:  [105.07751971  -0.35893245  -0.8963415 ]
mat_Sqrt:  [[29.94685822  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00378479 -0.0011378   0.98421473]
Stock Position:  0.003784793058503201
Bond Position:  [5.36913593]


portfolio before change:  [5.77502978]
curr_Stock_Price:  107.06600240673245
curr_Factors:  [107.06600241  -0.65227199  -0.8629806 ]
mat_Sqrt:  [[23.52804003  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00212026  0.20257832 -1.71962952]
Stock Position:  -0.0021202568535926914
Bond Position:  [6.0020372]


portfolio before change:  [5.77148222]
curr_Stock_Price:  109.09304824960829
curr_Factors:  [109.09304825  -0.92383993  -0.87930386]
mat_Sqrt:  [[17.97635679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03105359 0.08775588 0.1195434 ]
Stock Position:  0.031053588724155104
Bond Position:  [2.38375157]


portfolio before change:  [5.75902281]
curr_Stock_Price:  108.68222935438597
curr_Factors:  [108.68222935  -0.91669297  -0.91726835]
mat_Sqrt:  [[17.36517871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01139266  0.07048569 -0.36375572]
Stock Position:  -0.011392663582507182
Bond Position:  [6.99720288]


portfolio before change:  [5.76550129]
curr_Stock_Price:  108.1903537434475
curr_Factors:  [108.19035374  -0.75774999  -0.92369194]
mat_Sqrt:  [[20.13481255  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00298141 -0.04550316 -0.34114638]
Stock Position:  -0.0029814058323305976
Bond Position:  [6.08806064]


portfolio before change:  [5.76956642]
curr_Stock_Price:  107.08212521019142
curr_Factors:  [107.08212521  -0.44435301  -0.89609163]
mat_Sqrt:  [[28.02652613  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00087562 -0.0125684  -0.01668528]
Stock Position:  -0.000875622458919354
Bond Position:  [5.86332993]


portfolio before change:  [5.77026044]
curr_Stock_Price:  107.12659977750272
curr_Factors:  [107.12659978  -0.4980892   -0.88430094]
mat_Sqrt:  [[26.88641583  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00014766  0.00564122  0.04235158]
Stock Position:  -0.0001476630602296073
Bond Position:  [5.78607908]


portfolio before change:  [5.77085282]
curr_Stock_Price:  108.01322981879672
curr_Factors:  [108.01322982  -0.85811903  -0.88622699]
mat_Sqrt:  [[18.87631012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00682512 -0.00194232  0.61493642]
Stock Position:  0.006825121686696743
Bond Position:  [5.03364938]


portfolio before change:  [5.76970315]
curr_Stock_Price:  107.75258697309641
curr_Factors:  [107.75258697  -0.82954889  -0.90484338]
mat_Sqrt:  [[19.01913286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01077284 -0.01668109  0.64621231]
Stock Position:  0.010772841087402832
Bond Position:  [4.60890165]


portfolio before change:  [5.76518842]
curr_Stock_Price:  107.28002120845085
curr_Factors:  [107.28002121  -0.70384311  -0.90517859]
mat_Sqrt:  [[21.46493631  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0020192   0.00760287 -0.28622105]
Stock Position:  -0.0020191993958147817
Bond Position:  [5.98180817]


portfolio before change:  [5.76325005]
curr_Stock_Price:  108.6103226264322
curr_Factors:  [108.61032263  -0.59428935  -0.91875737]
mat_Sqrt:  [[23.92011511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282717  0.00950732 -0.05075241]
Stock Position:  -0.0028271733011266515
Bond Position:  [6.07031025]


portfolio before change:  [5.7596957]
curr_Stock_Price:  110.13593916141434
curr_Factors:  [110.13593916  -0.68232493  -0.92662277]
mat_Sqrt:  [[22.03798846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00712639 0.00641574 0.12156356]
Stock Position:  0.007126390309246481
Bond Position:  [4.97482401]


portfolio before change:  [5.76946295]
curr_Stock_Price:  111.41924665785007
curr_Factors:  [111.41924666  -0.65237215  -0.90588152]
mat_Sqrt:  [[23.45412561  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273151 -0.05184176 -0.81874195]
Stock Position:  -0.002731506831677576
Bond Position:  [6.07380538]


portfolio before change:  [5.77059147]
curr_Stock_Price:  111.28406540081478
curr_Factors:  [111.2840654   -0.48243253  -0.88932765]
mat_Sqrt:  [[28.22832494  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00150672 -0.00091201  0.45458955]
Stock Position:  0.00150671647621139
Bond Position:  [5.60291793]


portfolio before change:  [5.77489587]
curr_Stock_Price:  113.67602064936156
curr_Factors:  [113.67602065  -0.56745765  -0.87142271]
mat_Sqrt:  [[26.96317677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00628308 -0.0473235  -1.54556583]
Stock Position:  -0.006283084056877762
Bond Position:  [6.48913187]


portfolio before change:  [5.76950344]
curr_Stock_Price:  114.66337448741263
curr_Factors:  [114.66337449  -0.64484971  -0.85289847]
mat_Sqrt:  [[25.64253451  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00917051  0.2210339  -1.03852572]
Stock Position:  0.009170512878305228
Bond Position:  [4.71798149]


portfolio before change:  [5.7709726]
curr_Stock_Price:  114.75926673764963
curr_Factors:  [114.75926674  -0.81481178  -0.8713741 ]
mat_Sqrt:  [[21.25624472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00159195 0.02987295 0.10649582]
Stock Position:  0.0015919544111843242
Bond Position:  [5.58828108]


portfolio before change:  [5.7718916]
curr_Stock_Price:  114.89772043612766
curr_Factors:  [114.89772044  -0.77810813  -0.85737059]
mat_Sqrt:  [[22.38886236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03663834 -0.12656967  1.79532384]
Stock Position:  0.03663833818970248
Bond Position:  [1.56223006]


portfolio before change:  [5.74705419]
curr_Stock_Price:  114.21448270853286
curr_Factors:  [114.21448271  -0.49328925  -0.83777027]
mat_Sqrt:  [[30.17514545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00496186  0.03991171  0.19328337]
Stock Position:  -0.0049618587959765065
Bond Position:  [6.31377033]


portfolio before change:  [5.76233014]
curr_Stock_Price:  111.29487635400629
curr_Factors:  [111.29487635  -0.4241076   -0.85597078]
mat_Sqrt:  [[30.94170197  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01775691 -0.02890196 -0.05463284]
Stock Position:  0.017756909549226655
Bond Position:  [3.78607708]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.73840206]
Stock Price:  109.9206864996663
PL:  [-4.18228444]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-8.08089127e-02  6.06975950e-02 -8.83967748e-03]
 [-9.42656848e-02  7.55697900e-02  1.36102781e-02]
 [-2.36906254e-02  3.61152171e-02  2.97411381e-02]
 [-2.42409417e-02 -2.63423344e-02  2.23208829e-02]
 [ 5.12376498e-02  1.70619658e-02 -7.46058604e-02]
 [-1.29699515e-01 -1.67244448e-01  7.84029202e-02]
 [-5.20740743e-02 -1.80760594e-01 -2.77017018e-02]
 [ 6.99886398e-03  7.44314917e-01  1.13068862e-01]
 [ 2.65951306e-01 -1.23920992e-02  2.84734346e-01]
 [ 4.58177042e-01  1.86980348e-01  3.30155854e-01]
 [-2.27803198e-01 -2.36663228e-01  2.43264286e-02]
 [ 1.89156744e-02 -1.39461446e-02  1.11000105e-01]
 [ 1.47835077e-02 -5.65012909e-02  6.19562016e-02]
 [ 8.69042995e-03 -4.88838457e-02 -7.85116482e-02]
 [ 9.57217348e-02 -1.28680155e-01 -9.69028465e-02]
 [ 5.15794421e-02 -1.77119666e-02  3.34268844e-02]
 [ 4.56478758e-02  2.73574124e-02  6.09711270e-03]
 [-3.71840743e-02 -4.90739614e-02  5.65463184e-02]
 [ 8.10197147e-02 -4.87029237e-02 -8.41407183e-02]
 [ 3.82327292e-02 -7.25051739e-03  1.10368765e-01]
 [-2.51492268e-02  4.10932401e-01 -3.78688053e-01]
 [ 1.46772617e-01  1.05670841e-01  9.84770422e-02]
 [-7.76659829e-03  1.43690277e-03  4.84526109e-02]
 [ 5.97180742e-02 -1.45805160e-01 -2.37362440e-01]
 [ 6.22493613e-02  3.38952293e-02 -1.48542056e-02]
 [-2.67885413e-02  8.82379919e-03  8.86666312e-02]
 [ 4.78972076e-02 -3.35510741e-02  1.53908714e-02]
 [ 1.07561223e-01 -6.64140149e-02 -3.69072259e-02]
 [-4.88291621e-02 -3.02012233e-02 -2.88937392e-03]
 [-4.98456849e-02 -7.99180036e-03  2.15600805e-02]
 [-1.12346725e-02 -4.32463275e-02 -3.08060242e-02]
 [ 1.02264832e-02 -3.00773303e-03 -2.47548550e-02]
 [ 8.45987133e-02  8.44640267e-03  1.67268233e-01]
 [ 1.68723897e-02 -6.24528827e-02  2.81876148e-02]
 [-4.61085037e-02 -2.40477038e-02  4.24606641e-02]
 [ 8.74574275e-02 -1.02649868e-02  1.51261193e-01]
 [-3.50548099e-02  8.41517525e-02  3.57395075e-02]
 [-1.84182203e-02 -3.63546613e-02  3.84439299e-03]
 [ 9.49299729e-02  5.55441837e-03  8.37179236e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.23947558]
curr_Stock_Price:  99.03766999516382
curr_Factors:  [99.03767    -0.74492595 -0.96935707]
mat_Sqrt:  [[17.83597117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00393718  0.01959006 -0.02521714]
Stock Position:  -0.003937181719974228
Bond Position:  [-4.84954627]


portfolio before change:  [-5.2423326]
curr_Stock_Price:  99.60934603130404
curr_Factors:  [99.60934603 -0.68064652 -0.95324555]
mat_Sqrt:  [[19.44060509  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00391253  0.02439004  0.03882633]
Stock Position:  -0.003912526346828817
Bond Position:  [-4.85260841]


portfolio before change:  [-5.24474094]
curr_Stock_Price:  100.06984851900249
curr_Factors:  [100.06984852  -0.87969335  -0.94920449]
mat_Sqrt:  [[16.07026376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063768  0.01165614  0.08484319]
Stock Position:  -0.0006376841944937114
Bond Position:  [-5.18092798]


portfolio before change:  [-5.24593036]
curr_Stock_Price:  100.91942600315436
curr_Factors:  [100.919426    -0.99471174  -0.96718384]
mat_Sqrt:  [[14.18843014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176636 -0.00850195  0.06367527]
Stock Position:  -0.0017663558824480734
Bond Position:  [-5.06767074]


portfolio before change:  [-5.24471771]
curr_Stock_Price:  99.8742534101376
curr_Factors:  [99.87425341 -1.26439108 -0.99725575]
mat_Sqrt:  [[10.40477772  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00379552  0.00550673 -0.21282975]
Stock Position:  0.0037955209168115327
Bond Position:  [-5.62379253]


portfolio before change:  [-5.2423348]
curr_Stock_Price:  100.68729870756667
curr_Factors:  [100.68729871  -1.26051695  -1.01446737]
mat_Sqrt:  [[10.35050525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0142828  -0.05397791  0.22366171]
Stock Position:  -0.014282801841835162
Bond Position:  [-3.80423806]


portfolio before change:  [-5.25648273]
curr_Stock_Price:  101.64455953256926
curr_Factors:  [101.64455953  -1.40442013  -1.02714398]
mat_Sqrt:  [[ 8.93447958  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01059113 -0.05834023 -0.07902524]
Stock Position:  -0.01059113308855081
Bond Position:  [-4.17995167]


portfolio before change:  [-5.26030909]
curr_Stock_Price:  101.9565028610175
curr_Factors:  [101.95650286  -1.46002446  -0.99693678]
mat_Sqrt:  [[ 8.73715868  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0208319  0.24022661 0.32255399]
Stock Position:  0.020831897585804313
Bond Position:  [-7.38425651]


portfolio before change:  [-5.26769499]
curr_Stock_Price:  101.64626645470705
curr_Factors:  [101.64626645  -1.2011674   -0.97653121]
mat_Sqrt:  [[11.51672352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02791965 -0.00399953  0.81226783]
Stock Position:  0.027919653850580966
Bond Position:  [-8.10562356]


portfolio before change:  [-5.28379703]
curr_Stock_Price:  101.1058309091443
curr_Factors:  [101.10583091  -1.18532645  -0.96760279]
mat_Sqrt:  [[11.74277971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04800712 0.06034765 0.94184275]
Stock Position:  0.048007119375944825
Bond Position:  [-10.13759672]


portfolio before change:  [-5.26162231]
curr_Stock_Price:  101.59413350067967
curr_Factors:  [101.5941335   -1.2893823   -0.95155424]
mat_Sqrt:  [[10.80543502  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02509351 -0.07638273  0.06939653]
Stock Position:  -0.02509350760225541
Bond Position:  [-2.71226914]


portfolio before change:  [-5.27283672]
curr_Stock_Price:  102.02752665805568
curr_Factors:  [102.02752666  -1.44747338  -0.92856499]
mat_Sqrt:  [[ 9.48018928  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00408502 -0.0045011   0.3166524 ]
Stock Position:  0.004085016655922576
Bond Position:  [-5.68962086]


portfolio before change:  [-5.27450848]
curr_Stock_Price:  101.79239367853695
curr_Factors:  [101.79239368  -1.2055565   -0.94309126]
mat_Sqrt:  [[11.87324591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00133889 -0.01823571  0.1767438 ]
Stock Position:  0.0013388913858502437
Bond Position:  [-5.41079744]


portfolio before change:  [-5.27621126]
curr_Stock_Price:  101.02580079281016
curr_Factors:  [101.02580079  -1.09952493  -0.98663477]
mat_Sqrt:  [[12.54367096  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013803  -0.01577719 -0.22397188]
Stock Position:  -0.0013803029741841213
Bond Position:  [-5.13676505]


portfolio before change:  [-5.2767198]
curr_Stock_Price:  100.92901058655404
curr_Factors:  [100.92901059  -1.13567432  -1.00211418]
mat_Sqrt:  [[11.90107701  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00417397 -0.04153134 -0.27643685]
Stock Position:  0.004173974967395096
Bond Position:  [-5.69799496]


portfolio before change:  [-5.28026642]
curr_Stock_Price:  100.2499630910951
curr_Factors:  [100.24996309  -1.10945584  -1.01524351]
mat_Sqrt:  [[11.97675092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00457447 -0.00571651  0.0953576 ]
Stock Position:  0.004574465694391587
Bond Position:  [-5.73885643]


portfolio before change:  [-5.27903059]
curr_Stock_Price:  100.67694763886838
curr_Factors:  [100.67694764  -1.30037911  -1.04097412]
mat_Sqrt:  [[ 9.68485784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00541843 0.00882957 0.01739337]
Stock Position:  0.00541843287849156
Bond Position:  [-5.82454188]


portfolio before change:  [-5.27894843]
curr_Stock_Price:  100.82648873330105
curr_Factors:  [100.82648873  -1.38635546  -1.04125697]
mat_Sqrt:  [[ 8.89766311  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00400766 -0.01583855  0.16131091]
Stock Position:  -0.004007657443662082
Bond Position:  [-4.8748704]


portfolio before change:  [-5.28044665]
curr_Stock_Price:  101.04827100518449
curr_Factors:  [101.04827101  -1.61801137  -1.04235461]
mat_Sqrt:  [[ 7.06556054  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00762899 -0.0157188  -0.24003005]
Stock Position:  0.007628994122590723
Bond Position:  [-6.05134332]


portfolio before change:  [-5.28076489]
curr_Stock_Price:  101.10571300763769
curr_Factors:  [101.10571301  -1.4898358   -1.0321642 ]
mat_Sqrt:  [[ 8.11867226  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00730189 -0.00234009  0.31485137]
Stock Position:  0.007301890194941118
Bond Position:  [-6.01902771]


portfolio before change:  [-5.28780645]
curr_Stock_Price:  100.24441084466817
curr_Factors:  [100.24441084  -1.26161027  -1.04438368]
mat_Sqrt:  [[ 9.99032737  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185854  0.13262786 -1.08029161]
Stock Position:  -0.001858535378121025
Bond Position:  [-5.10149867]


portfolio before change:  [-5.28878157]
curr_Stock_Price:  100.42594726451759
curr_Factors:  [100.42594726  -1.29972204  -1.03723296]
mat_Sqrt:  [[ 9.70329587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01942063 0.03410512 0.28092759]
Stock Position:  0.019420631062721763
Bond Position:  [-7.23911684]


portfolio before change:  [-5.29657706]
curr_Stock_Price:  100.07114202201751
curr_Factors:  [100.07114202  -1.27654966  -1.03029351]
mat_Sqrt:  [[ 9.96459374  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00024256 0.00046376 0.13822181]
Stock Position:  0.0002425644339667577
Bond Position:  [-5.32085076]


portfolio before change:  [-5.29697774]
curr_Stock_Price:  101.16143739599077
curr_Factors:  [101.1614374   -1.34178888  -1.05704577]
mat_Sqrt:  [[ 9.18785937  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00201306 -0.04705841 -0.67712897]
Stock Position:  -0.002013056985053617
Bond Position:  [-5.093334]


portfolio before change:  [-5.29810665]
curr_Stock_Price:  101.40594173250398
curr_Factors:  [101.40594173  -1.15713095  -1.08253076]
mat_Sqrt:  [[10.79917749  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00612418  0.01093964 -0.04237491]
Stock Position:  0.006124178813095204
Bond Position:  [-5.91913477]


portfolio before change:  [-5.30170115]
curr_Stock_Price:  100.93982832720954
curr_Factors:  [100.93982833  -1.35888764  -1.09989095]
mat_Sqrt:  [[ 8.6343289   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079779  0.00284787  0.25294122]
Stock Position:  -0.0007977910775486401
Bond Position:  [-5.22117225]


portfolio before change:  [-5.3026859]
curr_Stock_Price:  101.35605704240136
curr_Factors:  [101.35605704  -1.33635924  -1.11298884]
mat_Sqrt:  [[ 8.75208144  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00504912 -0.01082856  0.04390587]
Stock Position:  0.005049115694664527
Bond Position:  [-5.81444436]


portfolio before change:  [-5.30280384]
curr_Stock_Price:  101.47665407109214
curr_Factors:  [101.47665407  -1.61277009  -1.11677306]
mat_Sqrt:  [[ 6.6212595   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01305958 -0.02143503 -0.10528604]
Stock Position:  0.013059579254083558
Bond Position:  [-6.62804625]


portfolio before change:  [-5.3054488]
curr_Stock_Price:  101.33756870788235
curr_Factors:  [101.33756871  -1.49575075  -1.12225442]
mat_Sqrt:  [[ 7.39239702  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00751904 -0.0097474  -0.00824258]
Stock Position:  -0.007519043127103861
Bond Position:  [-4.54348725]


portfolio before change:  [-5.30769297]
curr_Stock_Price:  101.56049632982311
curr_Factors:  [101.56049633  -1.41554063  -1.11785898]
mat_Sqrt:  [[ 8.06275276  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00583871 -0.00257934  0.06150491]
Stock Position:  -0.005838709523044117
Bond Position:  [-4.71471073]


portfolio before change:  [-5.30541652]
curr_Stock_Price:  101.06966519443925
curr_Factors:  [101.06966519  -1.44411079  -1.11294398]
mat_Sqrt:  [[ 7.83620971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00336266 -0.01395769 -0.08788101]
Stock Position:  -0.0033626646701096943
Bond Position:  [-4.96555313]


portfolio before change:  [-5.30368423]
curr_Stock_Price:  100.36991574746003
curr_Factors:  [100.36991575  -1.43239831  -1.08381172]
mat_Sqrt:  [[ 8.10638877  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00056245 -0.00097074 -0.07061871]
Stock Position:  0.0005624537296311475
Bond Position:  [-5.36013767]


portfolio before change:  [-5.30423643]
curr_Stock_Price:  100.57946288864508
curr_Factors:  [100.57946289  -1.58735428  -1.06305239]
mat_Sqrt:  [[ 7.10317182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01695951 0.00272606 0.47716971]
Stock Position:  0.01695950993941759
Bond Position:  [-7.01001483]


portfolio before change:  [-5.30122964]
curr_Stock_Price:  100.80842598280826
curr_Factors:  [100.80842598  -1.36487142  -1.00308013]
mat_Sqrt:  [[ 9.44296847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00104607 -0.02015658  0.08041142]
Stock Position:  0.0010460716070954292
Bond Position:  [-5.40668247]


portfolio before change:  [-5.30212156]
curr_Stock_Price:  100.60189765095849
curr_Factors:  [100.60189765  -1.42317918  -1.00683175]
mat_Sqrt:  [[ 8.85657567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00478175 -0.00776136  0.12112846]
Stock Position:  -0.004781754887280514
Bond Position:  [-4.82106794]


portfolio before change:  [-5.30002576]
curr_Stock_Price:  100.03757164428853
curr_Factors:  [100.03757164  -1.35200505  -0.99751951]
mat_Sqrt:  [[ 9.5450364   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01217786 -0.00331301  0.43150608]
Stock Position:  0.012177864249308766
Bond Position:  [-6.51826973]


portfolio before change:  [-5.31196962]
curr_Stock_Price:  99.12369835157764
curr_Factors:  [99.12369835 -1.38107908 -0.9568145 ]
mat_Sqrt:  [[ 9.56848581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00110593  0.02715986  0.10195487]
Stock Position:  -0.0011059334898187378
Bond Position:  [-5.2023454]


portfolio before change:  [-5.31325095]
curr_Stock_Price:  99.69425211268394
curr_Factors:  [99.69425211 -1.24458515 -0.96971099]
mat_Sqrt:  [[10.88964     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00230075 -0.01173342  0.01096698]
Stock Position:  -0.002300751086551501
Bond Position:  [-5.08387929]


portfolio before change:  [-5.31330091]
curr_Stock_Price:  99.4397435898444
curr_Factors:  [99.43974359 -0.94796376 -0.96579397]
mat_Sqrt:  [[14.66984655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00771328 0.00179268 0.23882393]
Stock Position:  0.007713278599115786
Bond Position:  [-6.08030736]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.30442433]
Stock Price:  100.68910444793562
PL:  [-5.99352878]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 9.01637742e-02 -6.59993057e-02  7.77312473e-03]
 [-6.68222777e-02  7.37218651e-02 -5.80214270e-02]
 [-1.13433034e-01 -2.89254922e-02 -6.01639488e-02]
 [-2.54999806e-01 -1.31303449e-01 -1.43419765e-01]
 [ 1.88796915e-01 -1.96130547e-01 -1.04684689e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.66689847e-02 -1.67287380e-01  5.06133321e-02]
 [ 1.28999825e-02  7.14709875e-01  1.14681407e-01]
 [ 1.67208244e-01  6.60406748e-03  1.87595442e-01]
 [ 4.28882785e-01  1.75676197e-01  3.08365655e-01]
 [-2.06513892e-01 -2.50574299e-01  1.14134499e-02]
 [ 3.95003488e-02 -1.28043396e-02  1.15921874e-01]
 [ 1.26711374e-02 -4.13267507e-02  5.48832368e-02]
 [ 1.33230520e-02 -1.67200139e-01 -3.24514420e-02]
 [ 4.81197639e-03  1.45656487e-04 -6.25634153e-02]
 [ 1.57635826e-01  1.24466457e-02 -5.23531731e-02]
 [ 4.76891138e-02  2.36938961e-02 -5.84161000e-03]
 [-4.11956957e-02 -6.05782365e-02 -5.03050722e-03]
 [ 4.15341152e-02  2.75221872e-04 -1.40240778e-01]
 [-1.24842987e-02  6.71233341e-03 -4.39573884e-02]
 [-3.92423518e-02  5.10103667e-01 -4.78251371e-01]
 [ 3.95102104e-01  2.24495664e-01  5.80383353e-02]
 [ 2.91267725e-03 -3.76502195e-02  7.23445670e-02]
 [ 7.47904248e-02 -2.59216221e-02 -1.80214288e-01]
 [-3.94939938e-02  1.50317631e-02 -5.51449585e-03]
 [-1.16016571e-01 -8.22972741e-03  2.26905432e-01]
 [-6.40204159e-02 -3.44864876e-02 -1.64437404e-02]
 [-1.04577052e-01  1.38788909e-01 -5.47314138e-02]
 [ 1.41931181e-01 -8.59817746e-03  1.76854373e-01]
 [ 8.43031960e-02  6.79108320e-02 -1.29732325e-01]
 [ 9.41270138e-03 -2.73573307e-03 -7.15257087e-04]
 [-4.00315277e-02  2.06098236e-02 -1.14805152e-01]
 [-1.09572260e-02  7.10926108e-02 -4.77570385e-02]
 [ 4.62801049e-02 -3.98696191e-02  1.85503310e-01]
 [-7.66093015e-02  4.63994249e-03 -3.83009585e-02]
 [-1.83724915e-01 -1.94191930e-01 -1.69016100e-01]
 [ 1.19926807e-01  1.06190638e-01  2.74959252e-01]
 [ 1.93689405e-01 -1.32783308e-01 -2.16252913e-01]
 [ 9.84828057e-02  3.35334875e-03  6.26858596e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.44371456]
curr_Stock_Price:  99.64228331199527
curr_Factors:  [99.64228331 -0.8528934  -0.98571662]
mat_Sqrt:  [[15.84694262  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00493965 -0.02130118  0.02217456]
Stock Position:  0.004939653448798943
Bond Position:  [-0.93591291]


portfolio before change:  [-0.43714089]
curr_Stock_Price:  100.99676401934603
curr_Factors:  [100.99676402  -0.93929991  -0.98270418]
mat_Sqrt:  [[14.77718418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430511  0.02379363 -0.16551898]
Stock Position:  -0.004305112424586267
Bond Position:  [-0.00233847]


portfolio before change:  [-0.44194903]
curr_Stock_Price:  102.11353895546812
curr_Factors:  [102.11353896  -1.06894867  -0.9933973 ]
mat_Sqrt:  [[12.98427937  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01013675 -0.00933566 -0.171631  ]
Stock Position:  -0.010136745855677387
Bond Position:  [0.59314996]


portfolio before change:  [-0.43567962]
curr_Stock_Price:  101.5023707628173
curr_Factors:  [101.50237076  -1.17287699  -0.99649468]
mat_Sqrt:  [[11.59658308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02682492 -0.04237801 -0.40913667]
Stock Position:  -0.026824922916665207
Bond Position:  [2.28711365]


portfolio before change:  [-0.44050116]
curr_Stock_Price:  101.6927700686672
curr_Factors:  [101.69277007  -1.13889492  -0.99027494]
mat_Sqrt:  [[12.09492986  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01053278 -0.06330086 -0.29863628]
Stock Position:  0.010532782197090683
Bond Position:  [-1.51160896]


portfolio before change:  [-0.4458828]
curr_Stock_Price:  101.19976880170665
curr_Factors:  [101.1997688  -1.2308773  -0.9881316]
mat_Sqrt:  [[11.00211553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01393407 -0.05534923  0.15513819]
Stock Position:  -0.013934065296439794
Bond Position:  [0.96424139]


portfolio before change:  [-0.43373835]
curr_Stock_Price:  100.33685388689811
curr_Factors:  [100.33685389  -1.22442407  -0.9740545 ]
mat_Sqrt:  [[11.13456794  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00722839 -0.05399177  0.14438575]
Stock Position:  -0.007228387792168064
Bond Position:  [0.29153534]


portfolio before change:  [-0.43521947]
curr_Stock_Price:  100.5467991082707
curr_Factors:  [100.54679911  -1.45198206  -0.9738739 ]
mat_Sqrt:  [[ 8.88858014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02049807 0.23067162 0.32715413]
Stock Position:  0.020498073488630777
Bond Position:  [-2.49623515]


portfolio before change:  [-0.41904636]
curr_Stock_Price:  101.3510287157945
curr_Factors:  [101.35102872  -1.45461318  -0.96553005]
mat_Sqrt:  [[ 9.01100662  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02295515 0.00213145 0.53515758]
Stock Position:  0.022955154923796427
Bond Position:  [-2.74557493]


portfolio before change:  [-0.42348489]
curr_Stock_Price:  101.1726240645631
curr_Factors:  [101.17262406  -1.39147367  -0.9809033 ]
mat_Sqrt:  [[ 9.43523646  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05592731 0.05669925 0.87968138]
Stock Position:  0.05592731215712348
Bond Position:  [-6.08179782]


portfolio before change:  [-0.47420125]
curr_Stock_Price:  100.27939163455248
curr_Factors:  [100.27939163  -1.26125267  -0.93744281]
mat_Sqrt:  [[11.12577765  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02294962 -0.08087251  0.0325594 ]
Stock Position:  -0.02294962236901306
Bond Position:  [1.82717292]


portfolio before change:  [-0.48238495]
curr_Stock_Price:  100.64593834846168
curr_Factors:  [100.64593835  -1.31965699  -0.93417473]
mat_Sqrt:  [[10.56743474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00572978 -0.00413258  0.33069284]
Stock Position:  0.005729784836534924
Bond Position:  [-1.05906452]


portfolio before change:  [-0.48133391]
curr_Stock_Price:  100.85247813807342
curr_Factors:  [100.85247814  -1.38199381  -0.91640437]
mat_Sqrt:  [[10.12756247  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00152439 -0.01333815  0.1565666 ]
Stock Position:  0.0015243888702112904
Bond Position:  [-0.63507231]


portfolio before change:  [-0.48270382]
curr_Stock_Price:  100.00589343927854
curr_Factors:  [100.00589344  -1.31277451  -0.91928906]
mat_Sqrt:  [[10.73130906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00255613 -0.05396361 -0.09257493]
Stock Position:  -0.002556133279102974
Bond Position:  [-0.22707543]


portfolio before change:  [-0.48155356]
curr_Stock_Price:  99.54478736203077
curr_Factors:  [99.54478736 -1.31745973 -0.89319642]
mat_Sqrt:  [[10.91296484  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.26566556e-04  4.70104289e-05 -1.78476010e-01]
Stock Position:  -0.0007265665556096722
Bond Position:  [-0.40922765]


portfolio before change:  [-0.48111949]
curr_Stock_Price:  98.87695713178813
curr_Factors:  [98.87695713 -1.30923774 -0.89979273]
mat_Sqrt:  [[10.8573878   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0137685   0.00401714 -0.14934903]
Stock Position:  0.013768499645361743
Bond Position:  [-1.84250684]


portfolio before change:  [-0.48761318]
curr_Stock_Price:  98.42205232271644
curr_Factors:  [98.42205232 -1.03059778 -0.90359145]
mat_Sqrt:  [[14.22606232  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00360839  0.00764717 -0.01666449]
Stock Position:  0.0036083910864781418
Bond Position:  [-0.84275844]


portfolio before change:  [-0.4861453]
curr_Stock_Price:  98.85804407794788
curr_Factors:  [98.85804408 -0.96729697 -0.88576749]
mat_Sqrt:  [[15.49659728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00352258 -0.01955154 -0.01435064]
Stock Position:  -0.003522581338981883
Bond Position:  [-0.1379098]


portfolio before change:  [-0.48710283]
curr_Stock_Price:  99.12497619188721
curr_Factors:  [99.12497619 -1.00123076 -0.88554234]
mat_Sqrt:  [[15.02339033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.62905465e-04  8.88274772e-05 -4.00067905e-01]
Stock Position:  0.0008629054652257711
Bond Position:  [-0.57263831]


portfolio before change:  [-0.48771429]
curr_Stock_Price:  98.49933405945133
curr_Factors:  [98.49933406 -0.75047994 -0.87987093]
mat_Sqrt:  [[19.29216241  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0010412   0.0021664  -0.12539819]
Stock Position:  -0.0010411955554388958
Bond Position:  [-0.38515722]


portfolio before change:  [-0.48835642]
curr_Stock_Price:  99.06982273060918
curr_Factors:  [99.06982273 -0.6010377  -0.8971985 ]
mat_Sqrt:  [[22.1444895   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014785   0.16463525 -1.36431804]
Stock Position:  -0.0014784955460793183
Bond Position:  [-0.34188213]


portfolio before change:  [-0.48823039]
curr_Stock_Price:  98.95566902343205
curr_Factors:  [98.95566902 -0.63445519 -0.86126934]
mat_Sqrt:  [[22.17459887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02041859 0.07245566 0.16556722]
Stock Position:  0.02041859327627766
Bond Position:  [-2.50876594]


portfolio before change:  [-0.51867297]
curr_Stock_Price:  97.4801035985253
curr_Factors:  [97.4801036  -0.8257007  -0.89449401]
mat_Sqrt:  [[17.45198821  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00057269 -0.01215156  0.20637891]
Stock Position:  0.000572692989488118
Bond Position:  [-0.57449914]


portfolio before change:  [-0.51877354]
curr_Stock_Price:  97.42990559821246
curr_Factors:  [97.4299056  -0.85203957 -0.8771767 ]
mat_Sqrt:  [[17.28634585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00189242 -0.00836617 -0.5141012 ]
Stock Position:  0.0018924247238057959
Bond Position:  [-0.7031523]


portfolio before change:  [-0.51946564]
curr_Stock_Price:  97.11063129399668
curr_Factors:  [97.11063129 -0.81893599 -0.88900188]
mat_Sqrt:  [[17.60024786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213357  0.00485148 -0.01573132]
Stock Position:  -0.0021335659640743816
Bond Position:  [-0.3122737]


portfolio before change:  [-0.51858824]
curr_Stock_Price:  96.68109845375233
curr_Factors:  [96.68109845 -0.80578422 -0.89053338]
mat_Sqrt:  [[17.72720251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00402656 -0.00265613  0.64729804]
Stock Position:  -0.004026556332909901
Bond Position:  [-0.12929635]


portfolio before change:  [-0.51022222]
curr_Stock_Price:  94.59937470927176
curr_Factors:  [94.59937471 -0.81747263 -0.86903545]
mat_Sqrt:  [[17.51649119  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00424837 -0.01113047 -0.04690941]
Stock Position:  -0.004248368257241587
Bond Position:  [-0.10832924]


portfolio before change:  [-0.50743256]
curr_Stock_Price:  93.93954292500034
curr_Factors:  [93.93954293 -0.6697075  -0.8710946 ]
mat_Sqrt:  [[20.12271574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00434429  0.04479393 -0.15613349]
Stock Position:  -0.004344288759831905
Bond Position:  [-0.09933206]


portfolio before change:  [-0.50977303]
curr_Stock_Price:  94.4754324383713
curr_Factors:  [94.47543244 -0.68413038 -0.8615122 ]
mat_Sqrt:  [[20.13978566  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00875264 -0.00277505  0.5045163 ]
Stock Position:  0.008752641956204139
Bond Position:  [-1.33668267]


portfolio before change:  [-0.51677178]
curr_Stock_Price:  93.69490834358696
curr_Factors:  [93.69490834 -0.72566373 -0.86441589]
mat_Sqrt:  [[19.10527025  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00375205  0.02191813 -0.37009021]
Stock Position:  0.0037520503829826645
Bond Position:  [-0.86831979]


portfolio before change:  [-0.51711637]
curr_Stock_Price:  93.63199786947828
curr_Factors:  [93.63199787 -0.6969074  -0.89124829]
mat_Sqrt:  [[19.12921014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00045523 -0.00088295 -0.00204043]
Stock Position:  0.00045523421493944314
Bond Position:  [-0.55974086]


portfolio before change:  [-0.51770633]
curr_Stock_Price:  92.4897374910662
curr_Factors:  [92.48973749 -0.94104508 -0.88726226]
mat_Sqrt:  [[14.86174326  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00398736  0.00665179 -0.32750714]
Stock Position:  -0.003987356500468627
Bond Position:  [-0.14891678]


portfolio before change:  [-0.51799155]
curr_Stock_Price:  92.55659748320771
curr_Factors:  [92.55659748 -1.02937623 -0.87028211]
mat_Sqrt:  [[13.84829304  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044727  0.02294504 -0.13623754]
Stock Position:  -0.00044726611903635254
Bond Position:  [-0.47659412]


portfolio before change:  [-0.51841815]
curr_Stock_Price:  93.37719082098782
curr_Factors:  [93.37719082 -1.33217768 -0.87474273]
mat_Sqrt:  [[10.27513293  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00739722 -0.01286786  0.52918931]
Stock Position:  0.007397223783779398
Bond Position:  [-1.20915012]


portfolio before change:  [-0.52132385]
curr_Stock_Price:  93.00481398990375
curr_Factors:  [93.00481399 -1.16877501 -0.87535045]
mat_Sqrt:  [[12.04350838  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00693156  0.00149753 -0.10926197]
Stock Position:  -0.006931562216465804
Bond Position:  [0.1233448]


portfolio before change:  [-0.52377025]
curr_Stock_Price:  93.3599737071396
curr_Factors:  [93.35997371 -1.37333669 -0.88264509]
mat_Sqrt:  [[ 9.78138342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02636278 -0.06267518 -0.48215589]
Stock Position:  -0.02636277845720804
Bond Position:  [1.93745806]


portfolio before change:  [-0.52489566]
curr_Stock_Price:  93.41185021642761
curr_Factors:  [93.41185022 -1.31459264 -0.8786805 ]
mat_Sqrt:  [[10.42018786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01897554 0.03427288 0.78438221]
Stock Position:  0.018975541064283247
Bond Position:  [-2.29743606]


portfolio before change:  [-0.52105745]
curr_Stock_Price:  93.62925683985542
curr_Factors:  [93.62925684 -1.3583932  -0.8673018 ]
mat_Sqrt:  [[10.11124234  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01210956 -0.04285563 -0.61690937]
Stock Position:  0.012109558916056704
Bond Position:  [-1.65486645]


portfolio before change:  [-0.51562892]
curr_Stock_Price:  94.09462429815353
curr_Factors:  [94.0946243  -1.58094758 -0.85598415]
mat_Sqrt:  [[ 8.22657029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01360992 0.00108229 0.17882531]
Stock Position:  0.01360992474953008
Bond Position:  [-1.79624968]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.51494368]
Stock Price:  94.16147180039692
PL:  [-0.51494368]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 7.53654889e-02 -1.09680475e-02 -8.65157229e-06]
 [-1.21014451e-01  6.97446837e-02 -1.28638949e-01]
 [-1.10230985e-02  2.27082819e-02  3.86958746e-02]
 [ 9.68249248e-02  7.37736833e-02  8.89871387e-02]
 [-1.72452338e-01  2.67582001e-01 -2.86602799e-02]
 [-2.36881272e-02 -1.53951163e-01  9.44242558e-02]
 [-6.47670942e-02 -2.20513008e-01 -9.18631598e-02]
 [-4.27953453e-02  8.68861634e-01  1.92778634e-01]
 [ 1.72788624e-02 -6.71986647e-02 -1.13442234e-02]
 [ 2.56011387e-01  9.21730720e-02  1.25575570e-01]
 [-1.37405815e-01 -1.85001339e-01  3.49035633e-02]
 [-6.76261833e-02 -1.90508423e-02  8.86291985e-02]
 [-2.12084224e-02  1.01427097e-01 -3.49929820e-03]
 [ 8.54487410e-03 -9.62789773e-02  5.44499732e-02]
 [-8.12931405e-02  1.96309978e-01 -3.99567842e-02]
 [ 5.11885713e-02 -1.77622550e-02  1.15870243e-02]
 [ 3.94226912e-02  1.14587342e-01 -1.52411599e-01]
 [ 6.87249961e-03 -4.83334695e-02 -4.10929542e-02]
 [ 3.48134721e-02  7.11032400e-02 -2.23385945e-01]
 [-6.72146705e-02 -1.16719642e-02 -2.82283294e-02]
 [-2.89611164e-02  4.08341507e-01 -3.48493452e-01]
 [ 1.30576804e-01  7.46285368e-02  1.27663063e-01]
 [ 6.33387892e-03 -5.30449228e-02  8.17296137e-02]
 [ 8.88182371e-02  1.10005695e-01 -1.39253523e-01]
 [-2.97744706e-02  9.62295607e-03 -6.45283280e-03]
 [-1.11721192e-01 -1.09655879e-02  2.26718677e-01]
 [-2.96837394e-02 -3.30047234e-02 -3.23539394e-03]
 [-8.71523401e-02  8.09683387e-02 -1.89624245e-01]
 [-1.96621517e-02 -4.03816597e-02  5.14467939e-02]
 [-2.09875068e-02  2.26846240e-02 -2.46942692e-02]
 [ 3.40148933e-02 -3.33032627e-02 -7.57011974e-02]
 [-2.73893998e-02  7.45117397e-02 -1.30452673e-01]
 [-9.46765710e-04  4.47241817e-02  3.15937394e-02]
 [ 4.23884632e-02 -3.11051945e-02  1.78723613e-01]
 [-7.07124106e-02  2.46948428e-03 -2.51274239e-02]
 [-5.45456849e-02 -1.07646736e-01 -4.14725729e-02]
 [ 5.40523611e-02  1.04536510e-01  1.78224439e-01]
 [ 1.58757598e-01 -1.17639255e-01 -1.49917494e-01]
 [ 9.93693657e-02  2.80410241e-03  5.74376002e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.05159673]
curr_Stock_Price:  99.56564612113178
curr_Factors:  [99.56564612 -0.62339025 -1.00081656]
mat_Sqrt:  [[19.62119541  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.72683101e-03 -3.53992211e-03 -2.46805276e-05]
Stock Position:  0.0037268310136194327
Bond Position:  [-1.42266107]


portfolio before change:  [-1.04812723]
curr_Stock_Price:  100.54431804072597
curr_Factors:  [100.54431804  -0.80574348  -1.0322121 ]
mat_Sqrt:  [[16.00086884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00831431  0.02251    -0.36697112]
Stock Position:  -0.00831431051689464
Bond Position:  [-0.21217055]


portfolio before change:  [-1.04472778]
curr_Stock_Price:  100.13226111230495
curr_Factors:  [100.13226111  -0.77328697  -1.04024024]
mat_Sqrt:  [[16.32935988  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [9.25310314e-05 7.32906647e-03 1.10388559e-01]
Stock Position:  9.253103139885057e-05
Bond Position:  [-1.05399312]


portfolio before change:  [-1.04502213]
curr_Stock_Price:  98.37505793030013
curr_Factors:  [98.37505793 -0.74652176 -1.03929835]
mat_Sqrt:  [[16.49351364  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00788482 0.02381035 0.25385554]
Stock Position:  0.007884817108461202
Bond Position:  [-1.82069147]


portfolio before change:  [-1.05002651]
curr_Stock_Price:  97.76923829383641
curr_Factors:  [97.76923829 -0.81675684 -1.03256577]
mat_Sqrt:  [[15.38337508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00804002  0.08636172 -0.0817598 ]
Stock Position:  -0.008040020152615577
Bond Position:  [-0.26395987]


portfolio before change:  [-1.04019122]
curr_Stock_Price:  96.54184240229954
curr_Factors:  [96.5418424  -0.51977129 -1.04166266]
mat_Sqrt:  [[20.25785377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176914 -0.04968752  0.26936612]
Stock Position:  -0.0017691413226580911
Bond Position:  [-0.86939506]


portfolio before change:  [-1.04120858]
curr_Stock_Price:  97.05547069584279
curr_Factors:  [97.0554707  -0.44232842 -1.04884577]
mat_Sqrt:  [[21.84798054  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00588295 -0.07117027 -0.26206003]
Stock Position:  -0.00588295161346808
Bond Position:  [-0.47023595]


portfolio before change:  [-1.04355918]
curr_Stock_Price:  97.44503916345502
curr_Factors:  [97.44503916 -0.73428651 -1.0514355 ]
mat_Sqrt:  [[16.33918991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0106438  0.28042389 0.54994378]
Stock Position:  0.010643799849645188
Bond Position:  [-2.08074467]


portfolio before change:  [-1.04635803]
curr_Stock_Price:  97.20652107802866
curr_Factors:  [97.20652108 -0.8800357  -1.06963043]
mat_Sqrt:  [[13.83458576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.00903344e-05 -2.16882758e-02 -3.23619117e-02]
Stock Position:  9.00903344060898e-05
Bond Position:  [-1.0551154]


portfolio before change:  [-1.04641925]
curr_Stock_Price:  97.9909921735485
curr_Factors:  [97.99099217 -0.81954801 -1.0419817 ]
mat_Sqrt:  [[15.2311983   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01972656 0.02974873 0.35823215]
Stock Position:  0.019726559710257347
Bond Position:  [-2.97944441]


portfolio before change:  [-1.04402428]
curr_Stock_Price:  98.13128130051372
curr_Factors:  [98.1312813  -0.75582341 -1.03808044]
mat_Sqrt:  [[16.32017922  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01029672 -0.05970893  0.09957015]
Stock Position:  -0.010296724856662156
Bond Position:  [-0.03359348]


portfolio before change:  [-1.03622368]
curr_Stock_Price:  97.3732923026756
curr_Factors:  [97.3732923  -0.65956859 -1.05811227]
mat_Sqrt:  [[17.47674444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305684 -0.00614863  0.25283443]
Stock Position:  -0.003056837102518825
Bond Position:  [-0.73856939]


portfolio before change:  [-1.03553957]
curr_Stock_Price:  97.11929308725973
curr_Factors:  [97.11929309 -0.64285624 -1.05251034]
mat_Sqrt:  [[17.82449206  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.83887159e-05  3.27354549e-02 -9.98252376e-03]
Stock Position:  -6.838871591391257e-05
Bond Position:  [-1.02889771]


portfolio before change:  [-1.03572674]
curr_Stock_Price:  97.9754132871851
curr_Factors:  [97.97541329 -0.63125011 -1.05627439]
mat_Sqrt:  [[18.12318497  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.62209297e-07 -3.10739063e-02  1.55330618e-01]
Stock Position:  3.6220929659749434e-07
Bond Position:  [-1.03576223]


portfolio before change:  [-1.03585649]
curr_Stock_Price:  97.2183244650431
curr_Factors:  [97.21832447 -0.64909267 -1.07616638]
mat_Sqrt:  [[17.317199    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00285137  0.06335877 -0.11398558]
Stock Position:  -0.0028513663409914236
Bond Position:  [-0.75865144]


portfolio before change:  [-1.03596078]
curr_Stock_Price:  97.22163704739211
curr_Factors:  [97.22163705 -0.6107141  -1.06870468]
mat_Sqrt:  [[18.13011763  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00275387 -0.00573274  0.03305456]
Stock Position:  0.0027538738934935613
Bond Position:  [-1.3036969]


portfolio before change:  [-1.04070787]
curr_Stock_Price:  95.55702982752621
curr_Factors:  [95.55702983 -0.58363047 -1.05045293]
mat_Sqrt:  [[18.64615278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00170018  0.03698291 -0.43478787]
Stock Position:  0.001700181672121312
Bond Position:  [-1.20317218]


portfolio before change:  [-1.03973829]
curr_Stock_Price:  96.21577172761891
curr_Factors:  [96.21577173 -0.69735542 -1.05342349]
mat_Sqrt:  [[16.70677588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00068126 -0.01559956 -0.11722676]
Stock Position:  -0.000681256083635813
Bond Position:  [-0.97419071]


portfolio before change:  [-1.04095516]
curr_Stock_Price:  97.82322094097769
curr_Factors:  [97.82322094 -0.65529966 -1.0584736 ]
mat_Sqrt:  [[17.62624023  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.11553632e-04  2.29484720e-02 -6.37257922e-01]
Stock Position:  0.00021155363229735508
Bond Position:  [-1.06165002]


portfolio before change:  [-1.04135568]
curr_Stock_Price:  96.55732695598923
curr_Factors:  [96.55732696 -0.65026236 -1.03564647]
mat_Sqrt:  [[17.88975248  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00421243 -0.00376711 -0.08052757]
Stock Position:  -0.004212427418616959
Bond Position:  [-0.63461495]


portfolio before change:  [-1.04216019]
curr_Stock_Price:  96.72947866460538
curr_Factors:  [96.72947866 -0.89533286 -1.01981893]
mat_Sqrt:  [[14.25013551  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00117505  0.13179165 -0.99415482]
Stock Position:  -0.0011750543232837596
Bond Position:  [-0.92849779]


portfolio before change:  [-1.0404166]
curr_Stock_Price:  95.14686995048959
curr_Factors:  [95.14686995 -0.91804567 -1.02591909]
mat_Sqrt:  [[13.61887829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01261994 0.02408626 0.36418719]
Stock Position:  0.012619938290680033
Bond Position:  [-2.24116423]


portfolio before change:  [-1.02990549]
curr_Stock_Price:  96.00196746240798
curr_Factors:  [96.00196746 -0.8238364  -1.01883437]
mat_Sqrt:  [[15.20611896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00080159 -0.01712018  0.23315184]
Stock Position:  0.0008015928951989202
Bond Position:  [-1.10685998]


portfolio before change:  [-1.03004612]
curr_Stock_Price:  95.99914499225359
curr_Factors:  [95.99914499 -0.84877856 -1.04718142]
mat_Sqrt:  [[14.41658538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00574672  0.03550419 -0.39725154]
Stock Position:  0.005746717902784377
Bond Position:  [-1.58172612]


portfolio before change:  [-1.02210505]
curr_Stock_Price:  97.41539595241179
curr_Factors:  [97.41539595 -0.85911527 -1.06530401]
mat_Sqrt:  [[14.21879935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00204851  0.0031058  -0.01840814]
Stock Position:  -0.0020485113546590563
Bond Position:  [-0.82254851]


portfolio before change:  [-1.02142655]
curr_Stock_Price:  97.033984198579
curr_Factors:  [97.0339842  -0.96937968 -1.06277907]
mat_Sqrt:  [[12.71652731  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00532227 -0.00353913  0.64676528]
Stock Position:  -0.005322268843454597
Bond Position:  [-0.5049856]


portfolio before change:  [-1.02534735]
curr_Stock_Price:  97.75880133855678
curr_Factors:  [97.75880134 -1.06312919 -1.06256196]
mat_Sqrt:  [[11.66755707  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00317815 -0.01065223 -0.00922968]
Stock Position:  -0.0031781479334744723
Bond Position:  [-0.71465542]


portfolio before change:  [-1.02649906]
curr_Stock_Price:  98.09307533974246
curr_Factors:  [98.09307534 -1.16299837 -1.06520503]
mat_Sqrt:  [[10.56676159  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01034675  0.02613242 -0.54094519]
Stock Position:  -0.010346749400453532
Bond Position:  [-0.01155459]


portfolio before change:  [-1.02600459]
curr_Stock_Price:  98.04514609875409
curr_Factors:  [98.0451461  -1.0115303  -1.08184222]
mat_Sqrt:  [[12.08609383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00143996 -0.01303312  0.14676338]
Stock Position:  -0.0014399599181340059
Bond Position:  [-0.88482351]


portfolio before change:  [-1.02599199]
curr_Stock_Price:  97.95957849463629
curr_Factors:  [97.95957849 -0.99782935 -1.09416834]
mat_Sqrt:  [[12.09215919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176955  0.00732143 -0.07044588]
Stock Position:  -0.0017695536082872854
Bond Position:  [-0.85264726]


portfolio before change:  [-1.02425198]
curr_Stock_Price:  96.91604432509871
curr_Factors:  [96.91604433 -0.76723736 -1.11004852]
mat_Sqrt:  [[14.82862147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079336 -0.01074858 -0.21595445]
Stock Position:  0.000793361075906128
Bond Position:  [-1.1011414]


portfolio before change:  [-1.02523846]
curr_Stock_Price:  95.8461385954874
curr_Factors:  [95.8461386  -0.9251472  -1.09507963]
mat_Sqrt:  [[12.7116303   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305298  0.02404856 -0.37214516]
Stock Position:  -0.00305297542832424
Bond Position:  [-0.73262255]


portfolio before change:  [-1.02702176]
curr_Stock_Price:  96.40025954181777
curr_Factors:  [96.40025954 -0.98532503 -1.09492806]
mat_Sqrt:  [[12.04025721  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00121522 0.01443467 0.09012814]
Stock Position:  0.0012152202766591794
Bond Position:  [-1.14416931]


portfolio before change:  [-1.0268487]
curr_Stock_Price:  96.66036675041312
curr_Factors:  [96.66036675 -1.02072145 -1.05412133]
mat_Sqrt:  [[12.13823847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00597459 -0.01003916  0.50984872]
Stock Position:  0.005974585764045862
Bond Position:  [-1.60435435]


portfolio before change:  [-1.02562465]
curr_Stock_Price:  96.89881165993017
curr_Factors:  [96.89881166 -1.01106684 -1.04555872]
mat_Sqrt:  [[12.39188338  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00607958  0.00079702 -0.07168155]
Stock Position:  -0.006079579738965296
Bond Position:  [-0.4365206]


portfolio before change:  [-1.02673096]
curr_Stock_Price:  97.0718076877909
curr_Factors:  [97.07180769 -1.02553104 -1.03916795]
mat_Sqrt:  [[12.31418681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00690135 -0.03474283 -0.11830971]
Stock Position:  -0.006901351877100571
Bond Position:  [-0.35680426]


portfolio before change:  [-1.0202759]
curr_Stock_Price:  96.13001168806615
curr_Factors:  [96.13001169 -0.91939449 -1.02830061]
mat_Sqrt:  [[13.70836817  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00815346 0.03373901 0.50842472]
Stock Position:  0.008153464850243906
Bond Position:  [-1.80406857]


portfolio before change:  [-1.01738611]
curr_Stock_Price:  96.51209608560254
curr_Factors:  [96.51209609 -0.85924209 -1.00009841]
mat_Sqrt:  [[15.0342036   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00692706 -0.03796791 -0.42767288]
Stock Position:  0.006927058345089002
Bond Position:  [-1.68593103]


portfolio before change:  [-1.02007616]
curr_Stock_Price:  96.15418191208192
curr_Factors:  [96.15418191 -0.77690492 -1.0326985 ]
mat_Sqrt:  [[15.74227145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0070934  0.00090502 0.16385349]
Stock Position:  0.007093395137513195
Bond Position:  [-1.70213576]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.02626038]
Stock Price:  95.31235098910177
PL:  [-1.02626038]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-4.21353998e-01  1.86861509e-01 -2.35719920e-02]
 [-2.81495676e-01  4.01636209e-02 -3.04852863e-01]
 [-3.44974573e-02  5.30343880e-02  2.58025220e-02]
 [ 8.31924241e-02  8.35574094e-02  6.91241743e-02]
 [-1.77812978e-01  2.70577278e-01 -2.78386865e-02]
 [-3.05442021e-02 -1.35292720e-01  2.30167464e-01]
 [-6.42632422e-02 -2.93424354e-01 -1.68996745e-01]
 [-2.76279744e-02  8.38539916e-01  1.66939232e-01]
 [ 7.58451057e-02 -7.32664669e-02  5.17343027e-02]
 [ 2.29649652e-01  8.11769028e-02  1.03308644e-01]
 [-1.51178502e-01 -2.32207441e-01  6.58286478e-03]
 [-8.14413927e-02 -1.95288209e-02  8.69165931e-02]
 [-3.12649367e-03  1.03199548e-03  9.97966558e-02]
 [ 1.14427590e-02 -1.37890641e-01 -1.93799613e-03]
 [ 1.07655247e-02  5.37195888e-03 -7.06974136e-02]
 [-1.00472653e-01 -6.07746887e-02  9.25515268e-02]
 [ 6.11349709e-02  3.01662448e-02 -7.97771077e-02]
 [ 2.30004378e-02 -4.38421676e-02 -5.18408117e-02]
 [ 2.71747180e-02  9.12304399e-02 -2.18031893e-01]
 [-8.61840018e-02  1.55502138e-02 -4.94127334e-02]
 [-4.78063018e-02  5.78109311e-01 -5.53788883e-01]
 [ 3.72471282e-01  2.13666891e-01  6.17236053e-02]
 [ 1.41510462e-02  4.53344759e-02  2.26981058e-02]
 [-6.11314418e-02 -1.11338247e-01 -2.63473105e-02]
 [ 2.47023515e-02  2.01006734e-02 -1.13702072e-02]
 [-6.44095114e-02 -8.68349982e-03  1.76989872e-01]
 [-1.56567270e-02 -3.23994019e-02  2.16040024e-03]
 [ 7.17648143e-02 -5.57624174e-02 -1.28118691e-01]
 [-4.69697168e-02 -2.24628226e-02 -1.78284073e-02]
 [-7.11182570e-02 -1.09249734e-02  3.64549541e-02]
 [-4.23181326e-02 -5.80152367e-02 -3.46124137e-02]
 [ 2.94798605e-02  5.41516905e-02 -4.24973988e-02]
 [-1.54288444e-02  1.17437083e-02  1.16541256e-01]
 [ 1.26707042e-02 -6.81192134e-02 -2.01386041e-03]
 [-3.10780915e-03  1.51377233e-02  4.36475953e-02]
 [ 7.55273185e-02  3.02959698e-02  1.78846324e-01]
 [ 7.99242760e-02 -4.68454831e-02  1.62714191e-02]
 [-8.03266632e-02  1.42155102e-02  3.88769795e-02]
 [ 1.32656744e-01  4.15503120e-04  1.08005926e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.72557753]
curr_Stock_Price:  98.47209615255773
curr_Factors:  [98.47209615 -0.95665361 -0.99144001]
mat_Sqrt:  [[14.03675996  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02764332  0.06030929 -0.06724433]
Stock Position:  -0.027643321232956767
Bond Position:  [-7.00348175]


portfolio before change:  [-9.73474308]
curr_Stock_Price:  98.77198980731012
curr_Factors:  [98.77198981 -1.11283898 -1.01393434]
mat_Sqrt:  [[11.77573117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02849293  0.01296275 -0.86966036]
Stock Position:  -0.028492934850564283
Bond Position:  [-6.92043921]


portfolio before change:  [-9.74236853]
curr_Stock_Price:  99.00925355288693
curr_Factors:  [99.00925355 -0.95709305 -1.02919097]
mat_Sqrt:  [[13.58449805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00135485  0.01711678  0.07360741]
Stock Position:  -0.0013548487684661198
Bond Position:  [-9.60822596]


portfolio before change:  [-9.74340079]
curr_Stock_Price:  98.88463585511894
curr_Factors:  [98.88463586 -0.70837229 -1.00914706]
mat_Sqrt:  [[17.75087     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00644241 0.02696804 0.19719203]
Stock Position:  0.006442412221200164
Bond Position:  [-10.38045638]


portfolio before change:  [-9.75209161]
curr_Stock_Price:  97.73705729694868
curr_Factors:  [97.7370573  -0.75908103 -1.01212697]
mat_Sqrt:  [[16.62774665  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00771386  0.08732844 -0.07941602]
Stock Position:  -0.0077138636516939935
Bond Position:  [-8.99816127]


portfolio before change:  [-9.74654836]
curr_Stock_Price:  96.87262876550294
curr_Factors:  [96.87262877 -0.72409235 -0.99452692]
mat_Sqrt:  [[17.37057589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.43500602e-04 -4.36655377e-02  6.56603709e-01]
Stock Position:  -0.000643500601505824
Bond Position:  [-9.68421077]


portfolio before change:  [-9.74739622]
curr_Stock_Price:  96.30892204404465
curr_Factors:  [96.30892204 -0.9072764  -0.98282733]
mat_Sqrt:  [[14.54805394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01090555 -0.0947023  -0.48210067]
Stock Position:  -0.010905551650735552
Bond Position:  [-8.6970943]


portfolio before change:  [-9.75896982]
curr_Stock_Price:  97.27048665593759
curr_Factors:  [97.27048666 -0.85276435 -0.9582988 ]
mat_Sqrt:  [[15.90180251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01116946 0.27063759 0.47623116]
Stock Position:  0.011169463145079833
Bond Position:  [-10.84542893]


portfolio before change:  [-9.75595819]
curr_Stock_Price:  97.66149798195174
curr_Factors:  [97.66149798 -0.67110946 -0.96417518]
mat_Sqrt:  [[19.03392207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00375382 -0.02364665  0.14758357]
Stock Position:  0.0037538175688743626
Bond Position:  [-10.12256164]


portfolio before change:  [-9.75978853]
curr_Stock_Price:  96.978209270391
curr_Factors:  [96.97820927 -0.63093517 -0.96884697]
mat_Sqrt:  [[19.5838288   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0136494  0.02619973 0.29471081]
Stock Position:  0.013649404764851518
Bond Position:  [-11.08348337]


portfolio before change:  [-9.75619732]
curr_Stock_Price:  97.3428208598783
curr_Factors:  [97.34282086 -0.7017621  -0.98566575]
mat_Sqrt:  [[18.00791047  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01095263 -0.07494463  0.01877908]
Stock Position:  -0.010952626980324766
Bond Position:  [-8.69003772]


portfolio before change:  [-9.75219595]
curr_Stock_Price:  96.87830266050821
curr_Factors:  [96.87830266 -0.50801371 -1.00128576]
mat_Sqrt:  [[21.41638127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00316047 -0.0063029   0.24794885]
Stock Position:  -0.0031604742380894686
Bond Position:  [-9.44601457]


portfolio before change:  [-9.75842238]
curr_Stock_Price:  98.47477371238512
curr_Factors:  [98.47477371 -0.6652716  -1.01508502]
mat_Sqrt:  [[18.3465912   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00095141 0.00033308 0.28469208]
Stock Position:  0.0009514066346483988
Bond Position:  [-9.85211194]


portfolio before change:  [-9.75879645]
curr_Stock_Price:  99.37609468430378
curr_Factors:  [99.37609468 -0.90464375 -1.02506048]
mat_Sqrt:  [[14.42852795  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118513 -0.04450401 -0.00552856]
Stock Position:  -0.0011851272797414414
Bond Position:  [-9.64102313]


portfolio before change:  [-9.76056039]
curr_Stock_Price:  99.84755341222647
curr_Factors:  [99.84755341 -0.49371246 -1.05351313]
mat_Sqrt:  [[21.25131908  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.20885574e-04  1.73379227e-03 -2.01680043e-01]
Stock Position:  -0.00012088557392014966
Bond Position:  [-9.74849026]


portfolio before change:  [-9.76189974]
curr_Stock_Price:  100.84608181229929
curr_Factors:  [100.84608181  -0.5124224   -1.07187697]
mat_Sqrt:  [[20.68266771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0045442  -0.01961495  0.26402374]
Stock Position:  -0.004544202618227331
Bond Position:  [-9.30363471]


portfolio before change:  [-9.75162824]
curr_Stock_Price:  98.32979358429655
curr_Factors:  [98.32979358 -0.41891034 -1.0535316 ]
mat_Sqrt:  [[22.55338428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00226166  0.00973611 -0.22758188]
Stock Position:  0.0022616648233051693
Bond Position:  [-9.97401728]


portfolio before change:  [-9.75682334]
curr_Stock_Price:  96.58406005444877
curr_Factors:  [ 9.65840601e+01 -7.23222801e-02 -1.07414507e+00]
mat_Sqrt:  [[30.69029153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.13040028e-04 -1.41499988e-02 -1.47887406e-01]
Stock Position:  0.00011304002823467602
Bond Position:  [-9.7677412]


portfolio before change:  [-9.75804778]
curr_Stock_Price:  96.55397376759643
curr_Factors:  [96.55397377 -0.16207772 -1.06356051]
mat_Sqrt:  [[28.3453767   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.55622722e-05  2.94444979e-02 -6.21984302e-01]
Stock Position:  4.5562272249542716e-05
Bond Position:  [-9.762447]


portfolio before change:  [-9.75924412]
curr_Stock_Price:  97.08173359705312
curr_Factors:  [97.0817336  -0.15620638 -1.0758581 ]
mat_Sqrt:  [[28.31774827  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328756  0.00501881 -0.14096077]
Stock Position:  -0.0032875551666088267
Bond Position:  [-9.44008256]


portfolio before change:  [-9.76804208]
curr_Stock_Price:  99.39891949289492
curr_Factors:  [99.39891949 -0.27385597 -1.08722918]
mat_Sqrt:  [[25.48413482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168112  0.18658398 -1.57980554]
Stock Position:  -0.0016811210458888975
Bond Position:  [-9.60094046]


portfolio before change:  [-9.77040104]
curr_Stock_Price:  100.08820096769763
curr_Factors:  [100.08820097  -0.19831202  -1.09596628]
mat_Sqrt:  [[27.43373645  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0156262  0.06896069 0.17608027]
Stock Position:  0.015626202880431907
Bond Position:  [-11.33439957]


portfolio before change:  [-9.76502406]
curr_Stock_Price:  100.52297487425204
curr_Factors:  [100.52297487  -0.13742085  -1.07884188]
mat_Sqrt:  [[29.78853472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00094124 0.01463164 0.06475138]
Stock Position:  0.0009412392738573753
Bond Position:  [-9.85964023]


portfolio before change:  [-9.76587061]
curr_Stock_Price:  100.93305558332027
curr_Factors:  [100.93305558  -0.26274053  -1.10682442]
mat_Sqrt:  [[25.65895226  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347779 -0.03593426 -0.07516154]
Stock Position:  -0.0034777876977017588
Bond Position:  [-9.41484687]


portfolio before change:  [-9.76228288]
curr_Stock_Price:  99.5630311752355
curr_Factors:  [99.56303118 -0.51252319 -1.10286914]
mat_Sqrt:  [[19.79439058  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00133798  0.00648746 -0.03243604]
Stock Position:  0.0013379775624161637
Bond Position:  [-9.89549598]


portfolio before change:  [-9.76228935]
curr_Stock_Price:  100.48274097182154
curr_Factors:  [100.48274097  -0.37083046  -1.09020002]
mat_Sqrt:  [[23.3117028   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00128923 -0.00280259  0.50490284]
Stock Position:  -0.0012892287281977169
Bond Position:  [-9.63274411]


portfolio before change:  [-9.7620655]
curr_Stock_Price:  99.37509066601477
curr_Factors:  [99.37509067 -0.38862567 -1.08060981]
mat_Sqrt:  [[22.86634083  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095464 -0.01045686  0.00616302]
Stock Position:  -0.0009546449765081448
Bond Position:  [-9.66719757]


portfolio before change:  [-9.76466476]
curr_Stock_Price:  100.83195198123168
curr_Factors:  [100.83195198  -0.70209515  -1.07756016]
mat_Sqrt:  [[17.00997564  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00201236 -0.01799724 -0.36548696]
Stock Position:  0.0020123626834531393
Bond Position:  [-9.96757522]


portfolio before change:  [-9.76287693]
curr_Stock_Price:  102.33955902679133
curr_Factors:  [102.33955903  -0.80067401  -1.09833789]
mat_Sqrt:  [[15.32191855  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0036023  -0.00724984 -0.05085948]
Stock Position:  -0.003602298855244572
Bond Position:  [-9.39421926]


portfolio before change:  [-9.76292433]
curr_Stock_Price:  102.02671604456629
curr_Factors:  [102.02671604  -0.67175576  -1.10125376]
mat_Sqrt:  [[17.32629324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380387 -0.00352602  0.10399584]
Stock Position:  -0.0038038702557909986
Bond Position:  [-9.37482794]


portfolio before change:  [-9.7609396]
curr_Stock_Price:  101.19686160755226
curr_Factors:  [101.19686161  -0.61669339  -1.05992193]
mat_Sqrt:  [[18.92440634  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00323528 -0.01872434 -0.09873958]
Stock Position:  -0.0032352757296308767
Bond Position:  [-9.43353985]


portfolio before change:  [-9.75822696]
curr_Stock_Price:  99.99390145809964
curr_Factors:  [99.99390146 -0.78068397 -1.05743056]
mat_Sqrt:  [[15.91074492  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00200234  0.01747738 -0.12123325]
Stock Position:  0.002002343886776512
Bond Position:  [-9.95844913]


portfolio before change:  [-9.75656857]
curr_Stock_Price:  101.44383666334691
curr_Factors:  [101.44383666  -0.71709518  -1.04478556]
mat_Sqrt:  [[17.42009755  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00061752 0.00379027 0.33245976]
Stock Position:  0.0006175174504345091
Bond Position:  [-9.81921191]


portfolio before change:  [-9.75792422]
curr_Stock_Price:  101.23628228424968
curr_Factors:  [101.23628228  -0.85060086  -1.06639412]
mat_Sqrt:  [[14.88661123  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00011051 -0.02198538 -0.00574498]
Stock Position:  -0.00011051202243777847
Bond Position:  [-9.74673639]


portfolio before change:  [-9.75930336]
curr_Stock_Price:  102.69059940347688
curr_Factors:  [102.6905994   -1.19436148  -1.09521109]
mat_Sqrt:  [[10.40355953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00085468 0.00488568 0.12451444]
Stock Position:  0.0008546780285819247
Bond Position:  [-9.84707075]


portfolio before change:  [-9.76066272]
curr_Stock_Price:  102.54036583885065
curr_Factors:  [102.54036584  -1.12524502  -1.09293183]
mat_Sqrt:  [[11.15714038  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01059575 0.00977798 0.51019878]
Stock Position:  0.010595753607228555
Bond Position:  [-10.84715517]


portfolio before change:  [-9.76847845]
curr_Stock_Price:  101.93071113844591
curr_Factors:  [101.93071114  -0.97606834  -1.09400877]
mat_Sqrt:  [[12.86121467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00572911 -0.01511931  0.04641783]
Stock Position:  0.005729114486528681
Bond Position:  [-10.35245116]


portfolio before change:  [-9.76304564]
curr_Stock_Price:  103.10488034694805
curr_Factors:  [103.10488035  -1.10818319  -1.1088668 ]
mat_Sqrt:  [[11.23121253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00618715  0.00458804  0.1109052 ]
Stock Position:  -0.006187150671901468
Bond Position:  [-9.12512021]


portfolio before change:  [-9.76506722]
curr_Stock_Price:  103.24725209332384
curr_Factors:  [103.24725209  -0.94400631  -1.0943939 ]
mat_Sqrt:  [[13.44660162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.15113231e-02 1.34103055e-04 3.08110844e-01]
Stock Position:  0.011511323061762323
Bond Position:  [-10.9535797]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.75171874]
Stock Price:  104.52579934185083
PL:  [-14.27751808]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.67956842e-01 -9.88633667e-02  2.57420287e-02]
 [-1.29439503e-01  6.91263663e-02 -1.39617589e-01]
 [ 1.63240855e-02 -6.23516725e-03  5.80277323e-02]
 [ 1.21330240e-01  2.94751591e-02  1.47392296e-01]
 [ 9.97438041e-02 -6.36321789e-02 -8.71517940e-02]
 [-1.29741482e-01 -1.66650983e-01  8.17579987e-02]
 [-5.28924981e-02 -1.45491974e-01 -2.68461606e-02]
 [ 1.28736870e-02  6.13338802e-01  8.67317710e-02]
 [ 1.81164908e-01 -2.45665398e-03  1.96753268e-01]
 [ 3.86816872e-01  1.56872796e-01  2.68778519e-01]
 [-2.12644975e-01 -2.66494732e-01  1.20663536e-03]
 [ 1.96896482e-02 -1.38916916e-02  1.11248721e-01]
 [ 1.33279811e-02 -5.75301954e-02  7.86069869e-02]
 [ 6.52401831e-04  1.33994852e-01 -3.54434729e-02]
 [ 3.34128167e-01 -1.75454038e-01 -1.67652755e-01]
 [-2.09026623e-01 -9.60202793e-02  1.18170219e-01]
 [ 5.02887216e-02  1.90282446e-02 -2.10461064e-02]
 [-5.76128705e-02 -6.11580124e-02  2.74592667e-02]
 [ 1.57122399e-01 -1.91312020e-01  2.21037551e-02]
 [ 5.19428519e-02 -6.11973352e-03  3.05340027e-01]
 [-2.92152859e-02  4.53545418e-01 -4.34603457e-01]
 [ 4.40739680e-01  2.46333089e-01  5.06065778e-02]
 [ 1.52571009e-02  1.56681544e-01 -4.93631731e-02]
 [ 2.32292051e-02 -1.53405131e-01 -1.62874472e-01]
 [ 4.55070561e-02  6.52488525e-03 -1.28445670e-02]
 [-3.43349001e-02  1.01410908e-02  7.74597857e-02]
 [ 7.61533274e-02 -3.08405645e-02  2.77079747e-02]
 [ 1.64886163e-01 -5.52967879e-02  2.00120013e-01]
 [-3.75779806e-02  5.91230722e-03 -7.06281010e-02]
 [-6.42817242e-02  6.80862036e-03  1.10111276e-02]
 [ 6.82311287e-02 -1.01733761e-02  1.59345677e-02]
 [ 2.67001465e-02 -9.02519590e-02 -1.74898989e-01]
 [-4.07228455e-02  9.03281254e-03  1.73761121e-01]
 [ 7.09789853e-04 -9.00166813e-02 -1.49883093e-01]
 [ 1.39606920e-02  1.03682719e-01  2.03520050e-02]
 [ 6.22371671e-02  3.85358621e-02  1.69075572e-01]
 [ 1.06128611e-02 -2.17536317e-02 -1.04288929e-02]
 [-1.05738354e-01  4.68087202e-02  4.93861560e-02]
 [ 3.15504277e-01 -3.69709595e-02  5.62357788e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.17206695]
curr_Stock_Price:  100.9806408436114
curr_Factors:  [100.98064084  -1.09467893  -0.99641678]
mat_Sqrt:  [[12.47632833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02267355 -0.03190801  0.07343484]
Stock Position:  -0.02267355147794265
Bond Position:  [12.46165671]


portfolio before change:  [10.19055091]
curr_Stock_Price:  100.23412514617208
curr_Factors:  [100.23412515  -0.97938409  -0.96763048]
mat_Sqrt:  [[14.30335512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01005558  0.02231044 -0.39829012]
Stock Position:  -0.010055575271471408
Bond Position:  [11.1984627]


portfolio before change:  [10.18354941]
curr_Stock_Price:  101.06962186068553
curr_Factors:  [101.06962186  -0.94887318  -0.97722045]
mat_Sqrt:  [[14.72749227  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00182626 -0.00201239  0.16553697]
Stock Position:  0.0018262578596788535
Bond Position:  [9.99897022]


portfolio before change:  [10.18344296]
curr_Stock_Price:  100.32689885935339
curr_Factors:  [100.32689886  -0.84605521  -0.96281462]
mat_Sqrt:  [[16.4374787   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0095777  0.00951307 0.42046919]
Stock Position:  0.009577695050154785
Bond Position:  [9.22254251]


portfolio before change:  [10.18826497]
curr_Stock_Price:  100.70998904540802
curr_Factors:  [100.70998905  -0.78747747  -0.9692898 ]
mat_Sqrt:  [[17.38273925  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00396745 -0.0205372  -0.24861981]
Stock Position:  0.003967450329058253
Bond Position:  [9.78870309]


portfolio before change:  [10.18884388]
curr_Stock_Price:  100.54747840753268
curr_Factors:  [100.54747841  -0.88902944  -0.96609318]
mat_Sqrt:  [[15.72901997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00935024 -0.05378637  0.23323281]
Stock Position:  -0.009350244935723657
Bond Position:  [11.12898743]


portfolio before change:  [10.18571739]
curr_Stock_Price:  101.03064225905113
curr_Factors:  [101.03064226  -1.02333388  -0.96049752]
mat_Sqrt:  [[13.89588085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00633791 -0.04695733 -0.07658462]
Stock Position:  -0.006337912179948861
Bond Position:  [10.82604073]


portfolio before change:  [10.18479727]
curr_Stock_Price:  101.38934998704076
curr_Factors:  [101.38934999  -1.13267455  -0.94661242]
mat_Sqrt:  [[12.67562786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01228933 0.19795425 0.2474216 ]
Stock Position:  0.012289331622874265
Bond Position:  [8.93878992]


portfolio before change:  [10.17940663]
curr_Stock_Price:  100.85978004671527
curr_Factors:  [100.85978005  -1.23899926  -0.93891133]
mat_Sqrt:  [[11.42519094  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01932795 -0.00079288  0.56128231]
Stock Position:  0.01932795162255781
Bond Position:  [8.22999368]


portfolio before change:  [10.18264643]
curr_Stock_Price:  100.97417356506479
curr_Factors:  [100.97417357  -1.60661572  -0.93251631]
mat_Sqrt:  [[ 7.97038458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05943284 0.05063048 0.7667503 ]
Stock Position:  0.0594328388498966
Bond Position:  [4.18146465]


portfolio before change:  [10.20641874]
curr_Stock_Price:  101.36536456315686
curr_Factors:  [101.36536456  -1.54545541  -0.90959401]
mat_Sqrt:  [[ 8.703124    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03065528 -0.08601081  0.00344219]
Stock Position:  -0.030655277494445174
Bond Position:  [13.31380212]


portfolio before change:  [10.18958136]
curr_Stock_Price:  101.96890516721888
curr_Factors:  [101.96890517  -1.26396201  -0.91233986]
mat_Sqrt:  [[11.56942736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00341958 -0.00448352  0.31736164]
Stock Position:  0.00341957880576414
Bond Position:  [9.84089066]


portfolio before change:  [10.18972375]
curr_Stock_Price:  101.65079493997862
curr_Factors:  [101.65079494  -1.05215406  -0.89323082]
mat_Sqrt:  [[14.5291719   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00121344 -0.01856779  0.22424385]
Stock Position:  0.0012134389571564028
Bond Position:  [10.06637672]


portfolio before change:  [10.19227115]
curr_Stock_Price:  102.71308468143688
curr_Factors:  [102.71308468  -1.16234713  -0.89520063]
mat_Sqrt:  [[13.12333259  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00158261  0.04324665 -0.10111036]
Stock Position:  0.0015826100323038934
Bond Position:  [10.02971639]


portfolio before change:  [10.19420297]
curr_Stock_Price:  103.14151047777567
curr_Factors:  [103.14151048  -1.2752714   -0.90313046]
mat_Sqrt:  [[11.67792225  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02261462 -0.05662755 -0.47826664]
Stock Position:  0.02261462100013928
Bond Position:  [7.8616968]


portfolio before change:  [10.20794271]
curr_Stock_Price:  103.70561287612746
curr_Factors:  [103.70561288  -1.23525082  -0.91422623]
mat_Sqrt:  [[12.0863799   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01692031 -0.03099041  0.33710674]
Stock Position:  -0.016920309231964012
Bond Position:  [11.96267375]


portfolio before change:  [10.20479971]
curr_Stock_Price:  103.97974663391466
curr_Factors:  [103.97974663  -1.31689651  -0.8870101 ]
mat_Sqrt:  [[11.47636301  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00434605  0.00614134 -0.06003868]
Stock Position:  0.004346048238963401
Bond Position:  [9.75289871]


portfolio before change:  [10.20882091]
curr_Stock_Price:  104.62447218079691
curr_Factors:  [104.62447218  -1.2050411   -0.89419727]
mat_Sqrt:  [[12.82170078  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00502988 -0.01973866  0.07833364]
Stock Position:  -0.005029878586424972
Bond Position:  [10.7350693]


portfolio before change:  [10.21240558]
curr_Stock_Price:  104.1785950755191
curr_Factors:  [104.17859508  -1.09617678  -0.87958656]
mat_Sqrt:  [[14.44492794  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00848622 -0.06174569  0.06305586]
Stock Position:  0.008486224874655019
Bond Position:  [9.3283226]


portfolio before change:  [10.21421269]
curr_Stock_Price:  104.2541291488859
curr_Factors:  [104.25412915  -1.00704414  -0.88093918]
mat_Sqrt:  [[15.78165426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00716154 -0.00197514  0.87105011]
Stock Position:  0.007161539392570836
Bond Position:  [9.46759264]


portfolio before change:  [10.21028771]
curr_Stock_Price:  103.54080461310308
curr_Factors:  [103.54080461  -1.05151984  -0.88187348]
mat_Sqrt:  [[14.97785033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00169242  0.14638115 -1.23980269]
Stock Position:  -0.0016924173895368603
Bond Position:  [10.38552197]


portfolio before change:  [10.21142963]
curr_Stock_Price:  103.63319062278578
curr_Factors:  [103.63319062  -1.06532514  -0.86037533]
mat_Sqrt:  [[15.10698437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03318678 0.07950366 0.14436648]
Stock Position:  0.0331867845586579
Bond Position:  [6.77217726]


portfolio before change:  [10.21155914]
curr_Stock_Price:  103.61158360196009
curr_Factors:  [103.6115836   -0.88247741  -0.86426888]
mat_Sqrt:  [[18.06367191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00205735  0.05056875 -0.14081939]
Stock Position:  0.002057354214620169
Bond Position:  [9.99839341]


portfolio before change:  [10.21334968]
curr_Stock_Price:  103.87437786844251
curr_Factors:  [103.87437787  -0.83968076  -0.87797263]
mat_Sqrt:  [[18.64408376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221685 -0.04951129 -0.46463553]
Stock Position:  -0.0022168479265140925
Bond Position:  [10.44362337]


portfolio before change:  [10.21743507]
curr_Stock_Price:  102.62040708796998
curr_Factors:  [102.62040709  -0.7575085   -0.88505365]
mat_Sqrt:  [[19.85537321  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00222696  0.0021059  -0.03664197]
Stock Position:  0.0022269567054469135
Bond Position:  [9.98890387]


portfolio before change:  [10.22128463]
curr_Stock_Price:  103.78830646199158
curr_Factors:  [103.78830646  -0.52575981  -0.89719363]
mat_Sqrt:  [[25.01310443  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00065779  0.00327302  0.22097121]
Stock Position:  -0.000657793042741789
Bond Position:  [10.28955585]


portfolio before change:  [10.22295162]
curr_Stock_Price:  103.20952455201353
curr_Factors:  [103.20952455  -0.55691891  -0.87397401]
mat_Sqrt:  [[24.67691577  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0030601  -0.00995375  0.07904314]
Stock Position:  0.003060102442600178
Bond Position:  [9.9071199]


portfolio before change:  [10.22829408]
curr_Stock_Price:  104.55065260324211
curr_Factors:  [104.5506526   -0.68195455  -0.86095572]
mat_Sqrt:  [[22.34854912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0087007  -0.01784696  0.57088669]
Stock Position:  0.008700702640009146
Bond Position:  [9.31862994]


portfolio before change:  [10.23951364]
curr_Stock_Price:  105.70626800263265
curr_Factors:  [105.706268    -0.49022321  -0.87419769]
mat_Sqrt:  [[27.01097565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188027  0.00190819 -0.20148231]
Stock Position:  -0.001880274055428436
Bond Position:  [10.4382704]


portfolio before change:  [10.23936086]
curr_Stock_Price:  106.48149960357756
curr_Factors:  [106.4814996   -0.34469262  -0.8794583 ]
mat_Sqrt:  [[31.30633077  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193713  0.00219747  0.03141168]
Stock Position:  -0.0019371252348729376
Bond Position:  [10.44562886]


portfolio before change:  [10.24248273]
curr_Stock_Price:  105.5439853723776
curr_Factors:  [105.54398537  -0.29942738  -0.88376274]
mat_Sqrt:  [[32.32812725  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00214696 -0.00328344  0.04545689]
Stock Position:  0.002146957862316911
Bond Position:  [10.01588424]


portfolio before change:  [10.24490331]
curr_Stock_Price:  106.08825446551967
curr_Factors:  [106.08825447  -0.48048366  -0.89510279]
mat_Sqrt:  [[26.80758555  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102298 -0.02912869 -0.49893813]
Stock Position:  -0.0010229777748769926
Bond Position:  [10.35342924]


portfolio before change:  [10.2464823]
curr_Stock_Price:  105.80992282177762
curr_Factors:  [105.80992282  -0.43996047  -0.90094835]
mat_Sqrt:  [[27.68070167  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.23197385e-04  2.91532771e-03  4.95692112e-01]
Stock Position:  -0.00012319738485643743
Bond Position:  [10.25951781]


portfolio before change:  [10.24791014]
curr_Stock_Price:  104.63034043334639
curr_Factors:  [104.63034043  -0.52126984  -0.87752287]
mat_Sqrt:  [[25.83269296  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00186816 -0.02905276 -0.42757474]
Stock Position:  -0.0018681577838891522
Bond Position:  [10.44337613]


portfolio before change:  [10.25047064]
curr_Stock_Price:  103.95856012267332
curr_Factors:  [103.95856012  -0.51875768  -0.88169574]
mat_Sqrt:  [[25.62424396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00153289 0.03346345 0.05805861]
Stock Position:  0.0015328910381983394
Bond Position:  [10.09111349]


portfolio before change:  [10.24871205]
curr_Stock_Price:  101.98839255528755
curr_Factors:  [101.98839256  -0.33729487  -0.8796086 ]
mat_Sqrt:  [[30.20343136  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0034637  0.0124374  0.48232555]
Stock Position:  0.00346370160417631
Bond Position:  [9.89545469]


portfolio before change:  [10.25156785]
curr_Stock_Price:  102.4557490473742
curr_Factors:  [102.45574905  -0.2073053   -0.8828696 ]
mat_Sqrt:  [[34.44128828  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00011741 -0.00702095 -0.02975073]
Stock Position:  0.00011740648971777601
Bond Position:  [10.23953888]


portfolio before change:  [10.25328085]
curr_Stock_Price:  106.14361566368491
curr_Factors:  [106.14361566  -0.4577444   -0.89451504]
mat_Sqrt:  [[27.45459657  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00313618  0.01510745  0.14088496]
Stock Position:  -0.0031361836485066736
Bond Position:  [10.58616672]


portfolio before change:  [10.25468988]
curr_Stock_Price:  106.11629623427847
curr_Factors:  [106.11629623  -0.50553751  -0.89330573]
mat_Sqrt:  [[26.19824412  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01219306 -0.01193233  0.16042502]
Stock Position:  0.012193057320008275
Bond Position:  [8.9608078]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.25274021]
Stock Price:  105.86452690784529
PL:  [4.38821331]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.74520684e-01 -3.98257396e-02  2.20706448e-03]
 [-2.29759101e-01  6.15242336e-02 -2.70097912e-01]
 [-7.43770033e-03  6.10351227e-02  4.28912223e-02]
 [ 9.13165083e-02  7.77269447e-02  8.09612098e-02]
 [-1.62709230e-01  2.62186969e-01 -2.84110040e-02]
 [-1.42824966e-02 -1.68515742e-01 -1.57008885e-02]
 [-6.64271271e-02 -3.65093982e-01 -3.74310354e-01]
 [-7.92562471e-02  9.88440717e-01  2.58115467e-01]
 [ 2.54350139e-02 -9.34813434e-02 -2.86449762e-02]
 [ 1.17863897e-02 -5.14241552e-03 -7.57396926e-02]
 [ 3.49909705e-02 -2.43737845e-01 -5.36356192e-02]
 [-2.62043467e-02 -1.95970086e-02  6.20769019e-02]
 [-8.14832320e-02  3.30613984e-01 -4.55888536e-01]
 [ 6.59671597e-03 -5.60397135e-02  6.01049750e-02]
 [-1.47799682e-01  1.90068096e-01 -3.66561072e-02]
 [-1.11190695e-01 -5.57341149e-02 -2.12723588e-02]
 [ 1.33870294e-02  1.75118562e-01 -2.24970541e-01]
 [ 1.25534542e-01 -1.26644670e-02 -1.17270421e-01]
 [ 1.87335291e-02  2.38580839e-01 -1.12884499e-01]
 [-9.44704237e-02 -1.51628727e-02 -2.48864939e-02]
 [-3.21692361e-02  4.25082010e-01 -3.59826801e-01]
 [ 4.46491659e-01  2.24064671e-01  7.81881722e-02]
 [ 3.49557996e-02 -4.80008140e-02  8.01181753e-02]
 [ 1.62587600e-01  1.94259579e-01 -1.06510760e-01]
 [-1.51563290e-01  4.43379955e-02  5.81312663e-03]
 [-1.60557953e-01 -2.49143640e-02  1.78880440e-01]
 [-7.96413080e-02 -3.51605913e-02 -2.24526549e-02]
 [-5.62230805e-02  9.76928204e-02 -3.46704379e-02]
 [ 1.75457940e-01  1.43314919e-03  2.02236145e-01]
 [ 6.88993555e-02  6.20501292e-02 -1.15062562e-01]
 [ 3.76776866e-02 -1.68739103e-03 -3.65085498e-02]
 [-3.18257210e-02  4.49366155e-02 -1.18139287e-01]
 [-1.03420958e-02  7.37514494e-02 -3.12294988e-03]
 [ 4.49018170e-02 -3.77494204e-02  1.83890654e-01]
 [-7.44510462e-02 -5.27099874e-03 -3.13207315e-02]
 [-1.58944626e-01 -1.74426095e-01 -1.45138165e-01]
 [ 1.18708583e-01  9.66958236e-02  2.46236433e-01]
 [ 1.82986873e-01 -1.26787147e-01 -1.92066046e-01]
 [ 9.88548272e-02  3.12287205e-03  6.04835663e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.24233619]
curr_Stock_Price:  99.415526685274
curr_Factors:  [99.41552669 -0.98751921 -0.99609947]
mat_Sqrt:  [[13.67664494  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01219903 -0.0128537   0.00629614]
Stock Position:  0.012199030130059295
Bond Position:  [-3.4551092]


portfolio before change:  [-2.24338755]
curr_Stock_Price:  99.36474857554637
curr_Factors:  [99.36474858 -0.97104532 -1.01978549]
mat_Sqrt:  [[13.57142669  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02006672  0.01985686 -0.77051416]
Stock Position:  -0.020066720378455815
Bond Position:  [-0.24946293]


portfolio before change:  [-2.21877881]
curr_Stock_Price:  98.13684858785159
curr_Factors:  [98.13684859 -0.87510547 -1.00660766]
mat_Sqrt:  [[14.94908046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00092154 0.019699   0.12235672]
Stock Position:  0.0009215400261185013
Bond Position:  [-2.30921585]


portfolio before change:  [-2.2187205]
curr_Stock_Price:  98.51337741065944
curr_Factors:  [98.51337741 -0.66304638 -1.00321447]
mat_Sqrt:  [[18.6143259   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00664588 0.02508626 0.2309598 ]
Stock Position:  0.006645880859405873
Bond Position:  [-2.87342867]


portfolio before change:  [-2.22552119]
curr_Stock_Price:  97.5441310558682
curr_Factors:  [97.54413106 -0.569986   -1.00388587]
mat_Sqrt:  [[20.21516434  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0056883   0.08462048 -0.08104869]
Stock Position:  -0.005688299586137992
Bond Position:  [-1.67066095]


portfolio before change:  [-2.21700879]
curr_Stock_Price:  96.01093945889826
curr_Factors:  [96.01093946 -0.43608869 -1.00401412]
mat_Sqrt:  [[22.74531826  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00228115 -0.05438822 -0.04479026]
Stock Position:  -0.0022811533484356173
Bond Position:  [-1.99799311]


portfolio before change:  [-2.21424164]
curr_Stock_Price:  94.68840380247843
curr_Factors:  [94.6884038  -0.35383049 -1.02326373]
mat_Sqrt:  [[23.89089241  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00909792 -0.11783358 -1.06780325]
Stock Position:  -0.009097919049935895
Bond Position:  [-1.35277421]


portfolio before change:  [-2.21843182]
curr_Stock_Price:  95.13038038756888
curr_Factors:  [95.13038039 -0.66176113 -0.99977429]
mat_Sqrt:  [[18.06024212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00970064 0.31901787 0.73633158]
Stock Position:  0.00970064339283262
Bond Position:  [-3.14125771]


portfolio before change:  [-2.22017759]
curr_Stock_Price:  94.99089561491253
curr_Factors:  [94.99089561 -1.07938091 -1.03000542]
mat_Sqrt:  [[11.52357251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.39172239e-05 -3.01709738e-02 -8.17161438e-02]
Stock Position:  4.391722388507919e-05
Bond Position:  [-2.22434933]


portfolio before change:  [-2.22044998]
curr_Stock_Price:  95.1201602427555
curr_Factors:  [95.12016024 -1.03662829 -1.05058536]
mat_Sqrt:  [[11.79796761  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00040037 -0.00165971 -0.21606426]
Stock Position:  -0.0004003741699735438
Bond Position:  [-2.18236632]


portfolio before change:  [-2.22067831]
curr_Stock_Price:  95.00906423615052
curr_Factors:  [95.00906424 -0.95061777 -0.99751257]
mat_Sqrt:  [[13.54262281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189846 -0.07866605 -0.15300749]
Stock Position:  -0.0018984604439451964
Bond Position:  [-2.04030736]


portfolio before change:  [-2.22014409]
curr_Stock_Price:  94.59331974219
curr_Factors:  [94.59331974 -0.84039846 -1.01591422]
mat_Sqrt:  [[14.77998907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118628 -0.00632491  0.17708812]
Stock Position:  -0.0011862779272554943
Bond Position:  [-2.10793012]


portfolio before change:  [-2.2200196]
curr_Stock_Price:  94.26624943430238
curr_Factors:  [94.26624943 -0.71377208 -1.03854107]
mat_Sqrt:  [[16.34316997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00655043  0.1067052  -1.3005231 ]
Stock Position:  -0.006550430110153919
Bond Position:  [-1.60253512]


portfolio before change:  [-2.21887897]
curr_Stock_Price:  94.06153555495827
curr_Factors:  [94.06153555 -0.67468655 -1.02781088]
mat_Sqrt:  [[17.14063181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00043327 -0.01808674  0.17146276]
Stock Position:  0.00043327072629273275
Bond Position:  [-2.25963308]


portfolio before change:  [-2.21909148]
curr_Stock_Price:  94.22300278371416
curr_Factors:  [94.22300278 -0.47615722 -1.05465879]
mat_Sqrt:  [[20.38599887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00571395  0.06134421 -0.10456967]
Stock Position:  -0.005713950644194167
Bond Position:  [-1.68070589]


portfolio before change:  [-2.22318223]
curr_Stock_Price:  94.90215577941107
curr_Factors:  [94.90215578 -0.44549756 -1.03549858]
mat_Sqrt:  [[21.58179836  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0058804  -0.01798811 -0.06068412]
Stock Position:  -0.0058803985345279456
Bond Position:  [-1.66511973]


portfolio before change:  [-2.21493506]
curr_Stock_Price:  93.4642737911701
curr_Factors:  [93.46427379 -0.6362754  -1.03091292]
mat_Sqrt:  [[17.64391461  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.81991175e-04  5.65192728e-02 -6.41778334e-01]
Stock Position:  0.00018199117524149425
Bond Position:  [-2.23194473]


portfolio before change:  [-2.21538292]
curr_Stock_Price:  92.5364671184025
curr_Factors:  [92.53646712 -0.82574353 -1.06545712]
mat_Sqrt:  [[13.9628769   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00709107 -0.00408744 -0.33453987]
Stock Position:  0.007091066899236964
Bond Position:  [-2.8715652]


portfolio before change:  [-2.20993618]
curr_Stock_Price:  93.3552032021702
curr_Factors:  [93.3552032  -0.61126509 -1.05019369]
mat_Sqrt:  [[17.7245879   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0025045   0.07700163 -0.32202805]
Stock Position:  0.0025044975600010486
Bond Position:  [-2.44374406]


portfolio before change:  [-2.20822487]
curr_Stock_Price:  94.16047459218933
curr_Factors:  [94.16047459 -0.65996621 -1.07248019]
mat_Sqrt:  [[16.65239596  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00616401 -0.0048938  -0.07099424]
Stock Position:  -0.006164005869734927
Bond Position:  [-1.62781915]


portfolio before change:  [-2.21479001]
curr_Stock_Price:  95.19254002151271
curr_Factors:  [95.19254002 -0.6660629  -1.08011747]
mat_Sqrt:  [[16.60528815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113512  0.13719463 -1.02648571]
Stock Position:  -0.0011351246819836474
Bond Position:  [-2.10673461]


portfolio before change:  [-2.21409354]
curr_Stock_Price:  94.34696532382654
curr_Factors:  [94.34696532 -0.37553364 -1.08542556]
mat_Sqrt:  [[21.88978107  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0232158  0.07231656 0.22304909]
Stock Position:  0.023215799229490613
Bond Position:  [-4.40443374]


portfolio before change:  [-2.22510796]
curr_Stock_Price:  93.89624490698503
curr_Factors:  [93.89624491 -0.47684198 -1.09243799]
mat_Sqrt:  [[19.54873192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0021235  -0.0154922   0.22855485]
Stock Position:  0.0021234998119229707
Bond Position:  [-2.42449662]


portfolio before change:  [-2.22488903]
curr_Stock_Price:  94.1420727765883
curr_Factors:  [94.14207278 -0.71627738 -1.09075606]
mat_Sqrt:  [[15.45251253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0116809   0.06269701 -0.30384555]
Stock Position:  0.011680899964547277
Bond Position:  [-3.32455316]


portfolio before change:  [-2.21830643]
curr_Stock_Price:  94.74118735228012
curr_Factors:  [94.74118735 -0.74215517 -1.11356773]
mat_Sqrt:  [[14.81182627  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00954145  0.01431003  0.01658323]
Stock Position:  -0.009541445641682399
Bond Position:  [-1.31433854]


portfolio before change:  [-2.21998556]
curr_Stock_Price:  94.8999503535048
curr_Factors:  [94.89995035 -0.53499091 -1.11322779]
mat_Sqrt:  [[18.25802087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00707249 -0.00804108  0.5102961 ]
Stock Position:  -0.007072494903230447
Bond Position:  [-1.54880614]


portfolio before change:  [-2.20899226]
curr_Stock_Price:  93.31820178742213
curr_Factors:  [93.31820179 -0.46816059 -1.10381476]
mat_Sqrt:  [[19.37608994  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00471723 -0.01134803 -0.06405117]
Stock Position:  -0.004717234636928148
Bond Position:  [-1.76878841]


portfolio before change:  [-2.21356783]
curr_Stock_Price:  94.24129592685112
curr_Factors:  [94.24129593 -0.38661194 -1.11008901]
mat_Sqrt:  [[21.09756286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00205515  0.03153022 -0.09890511]
Stock Position:  -0.0020551516244719337
Bond Position:  [-2.01988767]


portfolio before change:  [-2.21372951]
curr_Stock_Price:  94.19710380545067
curr_Factors:  [94.19710381 -0.57706529 -1.0862871 ]
mat_Sqrt:  [[17.85059857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.21582343e-02 4.62546912e-04 5.76923430e-01]
Stock Position:  0.012158234341329194
Bond Position:  [-3.35899997]


portfolio before change:  [-2.21302601]
curr_Stock_Price:  94.2895021654172
curr_Factors:  [94.28950217 -0.62255714 -1.09917832]
mat_Sqrt:  [[16.85478166  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0034458   0.02002659 -0.32824146]
Stock Position:  0.003445801858162497
Bond Position:  [-2.53792895]


portfolio before change:  [-2.21741408]
curr_Stock_Price:  93.10811748089114
curr_Factors:  [93.10811748 -0.79220725 -1.08232073]
mat_Sqrt:  [[14.28533361  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00209172 -0.0005446  -0.10414873]
Stock Position:  0.0020917238405355953
Bond Position:  [-2.41217055]


portfolio before change:  [-2.21708876]
curr_Stock_Price:  93.40780394425443
curr_Factors:  [93.40780394 -0.78541788 -1.10249109]
mat_Sqrt:  [[14.1408238   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330731  0.01450323 -0.3370185 ]
Stock Position:  -0.0033073146501320836
Bond Position:  [-1.90815976]


portfolio before change:  [-2.21652179]
curr_Stock_Price:  93.16425044793885
curr_Factors:  [93.16425045 -0.7142867  -1.13396653]
mat_Sqrt:  [[14.67449327  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00027768  0.02380318 -0.00890891]
Stock Position:  0.000277684975327935
Bond Position:  [-2.2423921]


portfolio before change:  [-2.21657402]
curr_Stock_Price:  93.98564748144403
curr_Factors:  [93.98564748 -0.85961301 -1.12414187]
mat_Sqrt:  [[12.92789281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00578074 -0.01218357  0.52458885]
Stock Position:  0.005780738776859379
Bond Position:  [-2.75988049]


portfolio before change:  [-2.21684024]
curr_Stock_Price:  93.99927663400777
curr_Factors:  [93.99927663 -1.02613295 -1.13195153]
mat_Sqrt:  [[10.86126297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00754243 -0.00170121 -0.08934933]
Stock Position:  -0.0075424287285583555
Bond Position:  [-1.50785739]


portfolio before change:  [-2.21794803]
curr_Stock_Price:  94.12116091008303
curr_Factors:  [94.12116091 -1.00521501 -1.12431996]
mat_Sqrt:  [[11.19030672  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.020033   -0.05629578 -0.41403878]
Stock Position:  -0.02003299931532753
Bond Position:  [-0.33241888]


portfolio before change:  [-2.22449191]
curr_Stock_Price:  94.44574127664714
curr_Factors:  [94.44574128 -1.09976967 -1.12697186]
mat_Sqrt:  [[10.18874797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01852135 0.03120844 0.702444  ]
Stock Position:  0.01852134698495196
Bond Position:  [-3.97375425]


portfolio before change:  [-2.21668247]
curr_Stock_Price:  94.89420695392319
curr_Factors:  [94.89420695 -1.23232046 -1.14349483]
mat_Sqrt:  [[ 8.81934295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01336848 -0.04092038 -0.54791097]
Stock Position:  0.013368483116105149
Bond Position:  [-3.48527407]


portfolio before change:  [-2.22134453]
curr_Stock_Price:  94.57806204216294
curr_Factors:  [94.57806204 -1.13519583 -1.15362806]
mat_Sqrt:  [[ 9.58885663  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01166338 0.0010079  0.17254278]
Stock Position:  0.011663375659739742
Bond Position:  [-3.324444]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.21676137]
Stock Price:  95.00664700149174
PL:  [-2.21676137]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.73546142e-02 -8.09088187e-02  1.23612385e-02]
 [-2.00285415e-01  5.99110875e-02 -1.86912097e-01]
 [-3.40376809e-02  5.31429239e-02  2.62628229e-02]
 [ 1.03069640e-01  6.92919979e-02  9.80858764e-02]
 [-6.78818145e-02  1.79186207e-01 -4.45419287e-02]
 [-7.51237363e-02 -1.53563896e-01  1.47809268e-01]
 [-6.14791098e-02 -1.69621374e-01  8.43899563e-02]
 [-1.78594237e-03  7.37056910e-01  1.19684224e-01]
 [ 2.48562627e-01 -2.20383179e-02  2.44507185e-01]
 [ 4.52277429e-01  1.77942640e-01  3.03947600e-01]
 [-2.27633717e-01 -2.38691327e-01  2.59413709e-02]
 [-3.60941175e-02 -1.79598958e-02  9.25380777e-02]
 [ 7.72601643e-03 -4.60668877e-02  1.13786224e-01]
 [ 1.17085693e-02 -1.47588421e-01  8.35462138e-03]
 [ 1.32057591e-02 -9.86248393e-03 -6.84958873e-02]
 [ 5.77777608e-02 -1.59474200e-02  2.76970921e-02]
 [ 4.80180785e-02  2.31034861e-02 -7.76564724e-03]
 [-3.76330878e-02 -5.98271754e-02 -8.25571796e-03]
 [ 1.20656095e-02  6.63897433e-02 -1.42899445e-01]
 [-2.30667131e-02 -1.68123582e-02 -2.50823204e-02]
 [-2.63032313e-02  3.91829572e-01 -3.33971791e-01]
 [ 1.90050662e-01  1.26379240e-01  9.14295176e-02]
 [ 7.92936272e-03 -5.63760797e-02  8.37875626e-02]
 [ 8.56118433e-02  5.71272201e-02 -1.56453957e-01]
 [-5.03934800e-02  1.35970500e-02 -4.42617589e-03]
 [-1.20976394e-01 -5.14232200e-03  2.27058628e-01]
 [-3.69319094e-02 -3.33175107e-02 -6.02355954e-03]
 [-3.56868097e-02  4.41552265e-03 -2.87024507e-01]
 [-2.89319910e-02 -4.13756552e-02  4.28882022e-02]
 [-9.82480639e-02 -2.87624257e-03  4.53477012e-02]
 [-3.30086505e-02 -5.45442033e-02 -3.14103465e-02]
 [ 3.96551973e-02  5.12834092e-02 -5.56709196e-02]
 [-4.13131535e-02  1.99740758e-02 -5.27749519e-02]
 [ 3.03758608e-02 -4.51325834e-02  1.15695021e-01]
 [-6.07179045e-02  6.90287542e-02 -2.54226450e-02]
 [-1.88087489e-01 -1.88915854e-01 -1.69660610e-01]
 [ 8.59953588e-02  1.03840413e-01  2.15872772e-01]
 [ 1.60186961e-01 -1.19882154e-01 -1.57254942e-01]
 [ 9.94150844e-02  2.77577853e-03  5.71669547e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.21083041]
curr_Stock_Price:  99.97694828687177
curr_Factors:  [99.97694829 -1.03736107 -0.97096429]
mat_Sqrt:  [[13.41823072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308139 -0.02611321  0.03526317]
Stock Position:  -0.0030813921203377667
Bond Position:  [2.51889859]


portfolio before change:  [2.21368721]
curr_Stock_Price:  99.15202129685825
curr_Factors:  [99.1520213  -1.04412792 -0.95578866]
mat_Sqrt:  [[13.41988641  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01685628  0.01933622 -0.53320819]
Stock Position:  -0.01685628183114684
Bond Position:  [3.88502163]


portfolio before change:  [2.21382739]
curr_Stock_Price:  99.17251666222533
curr_Factors:  [99.17251666 -1.06091591 -0.95451807]
mat_Sqrt:  [[13.21598327  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00134905  0.0171518   0.07492052]
Stock Position:  -0.0013490521557089892
Bond Position:  [2.34761629]


portfolio before change:  [2.21522028]
curr_Stock_Price:  98.35756540033539
curr_Factors:  [98.3575654  -1.03599155 -0.96415674]
mat_Sqrt:  [[13.30927525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01031127 0.0223639  0.2798117 ]
Stock Position:  0.010311268090412532
Bond Position:  [1.20102905]


portfolio before change:  [2.22077807]
curr_Stock_Price:  98.88200697580893
curr_Factors:  [98.88200698 -1.01848288 -0.97470532]
mat_Sqrt:  [[13.47369254  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00299826  0.0578321  -0.12706572]
Stock Position:  -0.0029982624475428828
Bond Position:  [2.51725228]


portfolio before change:  [2.21973109]
curr_Stock_Price:  99.33615705670158
curr_Factors:  [99.33615706 -0.78325065 -0.97381043]
mat_Sqrt:  [[17.14057645  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00445133 -0.04956253  0.4216587 ]
Stock Position:  -0.0044513319029367586
Bond Position:  [2.66190929]


portfolio before change:  [2.2192452]
curr_Stock_Price:  99.52006816215608
curr_Factors:  [99.52006816 -0.80293732 -0.96378382]
mat_Sqrt:  [[17.00722363  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00463785 -0.05474506  0.24074106]
Stock Position:  -0.004637846940457471
Bond Position:  [2.68080404]


portfolio before change:  [2.21956131]
curr_Stock_Price:  99.52416702427008
curr_Factors:  [99.52416702 -0.78171212 -0.94547177]
mat_Sqrt:  [[17.69384094  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00978282 0.23788409 0.34142578]
Stock Position:  0.00978281707444133
Bond Position:  [1.24593459]


portfolio before change:  [2.22128154]
curr_Stock_Price:  99.68408864032249
curr_Factors:  [99.68408864 -0.70151505 -0.9718556 ]
mat_Sqrt:  [[18.70209264  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01571877 -0.00711284  0.69751094]
Stock Position:  0.015718770070117863
Bond Position:  [0.65437027]


portfolio before change:  [2.23619642]
curr_Stock_Price:  100.62774237566386
curr_Factors:  [100.62774238  -0.94732386  -0.97320307]
mat_Sqrt:  [[14.74495594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03734449 0.05743074 0.8670779 ]
Stock Position:  0.037344490195780636
Bond Position:  [-1.52169532]


portfolio before change:  [2.17971128]
curr_Stock_Price:  99.1202934030178
curr_Factors:  [99.1202934  -0.81084716 -0.96503815]
mat_Sqrt:  [[16.78438317  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0161496  -0.07703729  0.07400351]
Stock Position:  -0.016149602720701258
Bond Position:  [3.78046464]


portfolio before change:  [2.16218077]
curr_Stock_Price:  100.23506379049904
curr_Factors:  [100.23506379  -0.90280498  -0.98816898]
mat_Sqrt:  [[15.12795118  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137963 -0.00579653  0.26398538]
Stock Position:  -0.0013796256737365479
Bond Position:  [2.30046764]


portfolio before change:  [2.16294446]
curr_Stock_Price:  99.88996186471893
curr_Factors:  [99.88996186 -0.90886252 -0.96856978]
mat_Sqrt:  [[15.28140752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00141016 -0.01486802  0.32460042]
Stock Position:  0.0014101559708122188
Bond Position:  [2.02208403]


portfolio before change:  [2.16239839]
curr_Stock_Price:  99.32346927626071
curr_Factors:  [99.32346928 -0.9085412  -0.96510067]
mat_Sqrt:  [[15.25244813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109572 -0.04763396  0.02383341]
Stock Position:  -0.001095719912397027
Bond Position:  [2.2712291]


portfolio before change:  [2.16218651]
curr_Stock_Price:  99.77596444694316
curr_Factors:  [99.77596445 -1.02190615 -0.97011029]
mat_Sqrt:  [[13.61144349  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00020491 -0.0031831  -0.1953997 ]
Stock Position:  -0.00020490673244707235
Bond Position:  [2.18263127]


portfolio before change:  [2.16245552]
curr_Stock_Price:  99.79468187242875
curr_Factors:  [99.79468187 -0.90638095 -0.96671283]
mat_Sqrt:  [[15.33321082  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00392456 -0.00514701  0.07901209]
Stock Position:  0.003924563047525577
Bond Position:  [1.770805]


portfolio before change:  [2.15991957]
curr_Stock_Price:  99.09210305268904
curr_Factors:  [99.09210305 -0.85683788 -0.94462672]
mat_Sqrt:  [[16.35584204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00312726  0.00745662 -0.02215323]
Stock Position:  0.003127255790514039
Bond Position:  [1.85003321]


portfolio before change:  [2.15898321]
curr_Stock_Price:  98.71873123739087
curr_Factors:  [98.71873124 -0.73878869 -0.96217518]
mat_Sqrt:  [[18.01691131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286012 -0.01930914 -0.02355127]
Stock Position:  -0.0028601156637603964
Bond Position:  [2.4413302]


portfolio before change:  [2.16257265]
curr_Stock_Price:  97.57043549866745
curr_Factors:  [97.5704355  -0.98219889 -0.96407147]
mat_Sqrt:  [[13.93361375  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.54913624e-04  2.14271975e-02 -4.07652341e-01]
Stock Position:  -0.0002549136243109409
Bond Position:  [2.18744468]


portfolio before change:  [2.16287501]
curr_Stock_Price:  97.45702176237634
curr_Factors:  [97.45702176 -1.05586624 -0.97716748]
mat_Sqrt:  [[12.76079724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247778 -0.00542617 -0.07155288]
Stock Position:  -0.002477778460455495
Bond Position:  [2.40435192]


portfolio before change:  [2.16398534]
curr_Stock_Price:  97.13021147900392
curr_Factors:  [97.13021148 -1.02661083 -0.96340496]
mat_Sqrt:  [[13.27704596  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109159  0.12646245 -0.95272856]
Stock Position:  -0.00109158778858658
Bond Position:  [2.27001149]


portfolio before change:  [2.16476286]
curr_Stock_Price:  96.67788311003754
curr_Factors:  [96.67788311 -0.78650268 -0.96923111]
mat_Sqrt:  [[16.70404432  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01403916 0.04078872 0.26082296]
Stock Position:  0.014039156270879496
Bond Position:  [0.80748695]


portfolio before change:  [2.14687582]
curr_Stock_Price:  95.39661102068594
curr_Factors:  [95.39661102 -0.54707835 -0.9409534 ]
mat_Sqrt:  [[21.54214616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00062783 -0.0181953   0.23902259]
Stock Position:  0.0006278254790903671
Bond Position:  [2.0869834]


portfolio before change:  [2.14768609]
curr_Stock_Price:  96.27165610156212
curr_Factors:  [96.2716561  -0.78471414 -0.94582444]
mat_Sqrt:  [[17.058274    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00383022  0.01843773 -0.44631959]
Stock Position:  0.0038302150591508237
Bond Position:  [1.77894494]


portfolio before change:  [2.15025731]
curr_Stock_Price:  96.88489536223953
curr_Factors:  [96.88489536 -0.8771009  -0.96332195]
mat_Sqrt:  [[15.3805047   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00315474  0.00438843 -0.01262665]
Stock Position:  -0.0031547393376448016
Bond Position:  [2.4559039]


portfolio before change:  [2.15225661]
curr_Stock_Price:  96.34846747195604
curr_Factors:  [96.34846747 -0.72074436 -0.96373899]
mat_Sqrt:  [[17.87652029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00423337 -0.00165968  0.64773506]
Stock Position:  -0.0042333695966064264
Bond Position:  [2.56013528]


portfolio before change:  [2.14827226]
curr_Stock_Price:  97.36524341384849
curr_Factors:  [97.36524341 -0.36046529 -0.96973583]
mat_Sqrt:  [[25.74571431  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0017464  -0.01075318 -0.01718354]
Stock Position:  -0.0017464021846643617
Bond Position:  [2.31831113]


portfolio before change:  [2.14435969]
curr_Stock_Price:  99.77154845487021
curr_Factors:  [99.77154845 -0.424619   -0.97198681]
mat_Sqrt:  [[24.68701121  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00378232  0.0014251  -0.81880103]
Stock Position:  -0.003782318002790722
Bond Position:  [2.52172741]


portfolio before change:  [2.14315504]
curr_Stock_Price:  100.17338666392467
curr_Factors:  [100.17338666  -0.43844711  -0.97148576]
mat_Sqrt:  [[24.45830147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00117029 -0.01335394  0.1223481 ]
Stock Position:  -0.0011702874654084768
Bond Position:  [2.2603867]


portfolio before change:  [2.14264289]
curr_Stock_Price:  100.85246291960868
curr_Factors:  [100.85246292  -0.29796337  -0.95811426]
mat_Sqrt:  [[28.71963557  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311907 -0.0009283   0.12936437]
Stock Position:  -0.003119072087980168
Bond Position:  [2.457209]


portfolio before change:  [2.14022517]
curr_Stock_Price:  101.72608630216202
curr_Factors:  [101.7260863   -0.54888996  -0.97560875]
mat_Sqrt:  [[22.14883846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00228247 -0.01760407 -0.08960498]
Stock Position:  -0.0022824695553500885
Bond Position:  [2.37241186]


portfolio before change:  [2.14418777]
curr_Stock_Price:  100.11991805975096
curr_Factors:  [100.11991806  -0.37003319  -0.96194033]
mat_Sqrt:  [[26.42723564  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00146665  0.01655165 -0.15881364]
Stock Position:  0.0014666536063331537
Bond Position:  [1.99734653]


portfolio before change:  [2.14552797]
curr_Stock_Price:  100.86345595291154
curr_Factors:  [100.86345595  -0.37633615  -0.94383426]
mat_Sqrt:  [[26.93959865  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00178208  0.00644661 -0.15055225]
Stock Position:  -0.00178208313119764
Bond Position:  [2.32527503]


portfolio before change:  [2.15030582]
curr_Stock_Price:  98.34551910376415
curr_Factors:  [98.3455191  -0.14851155 -0.92960121]
mat_Sqrt:  [[33.4607874   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00133826 -0.01456648  0.33004569]
Stock Position:  0.0013382637274509071
Bond Position:  [2.01869357]


portfolio before change:  [2.14834113]
curr_Stock_Price:  96.6888633272208
curr_Factors:  [96.68886333 -0.12584032 -0.93096716]
mat_Sqrt:  [[33.60553366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154191  0.02227893 -0.07252373]
Stock Position:  -0.001541914057062512
Bond Position:  [2.29742704]


portfolio before change:  [2.15284766]
curr_Stock_Price:  93.95243205024059
curr_Factors:  [ 9.39524321e+01 -3.98513288e-02 -9.39457620e-01]
mat_Sqrt:  [[35.28576637  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00740473 -0.06097233 -0.4839945 ]
Stock Position:  -0.007404730851548463
Bond Position:  [2.84854014]


portfolio before change:  [2.14565022]
curr_Stock_Price:  94.9725272723776
curr_Factors:  [94.97252727 -0.17957078 -0.95708887]
mat_Sqrt:  [[30.47565026  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00496319 0.03351435 0.61582493]
Stock Position:  0.004963193173160807
Bond Position:  [1.67428322]


portfolio before change:  [2.15058805]
curr_Stock_Price:  95.92524536196858
curr_Factors:  [95.92524536 -0.324749   -0.97806431]
mat_Sqrt:  [[26.06923516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00397467 -0.0386918  -0.44860458]
Stock Position:  0.003974669282217017
Bond Position:  [1.76931692]


portfolio before change:  [2.15077332]
curr_Stock_Price:  95.91621250593712
curr_Factors:  [95.91621251 -0.34549515 -0.96013955]
mat_Sqrt:  [[25.99333944  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00429536 0.00089588 0.16308141]
Stock Position:  0.0042953635820157645
Bond Position:  [1.73877832]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.15866101]
Stock Price:  97.70193442126431
PL:  [2.15866101]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-6.22733245e-03  3.00245960e-02 -5.61272641e-03]
 [-2.05453056e-01  5.27146690e-02 -1.67098503e-01]
 [-2.72127401e-02  5.51671626e-02  3.05337342e-02]
 [ 8.54803673e-02  8.19154062e-02  7.24577764e-02]
 [-9.34964345e-02  2.05295295e-01 -4.13999660e-02]
 [-7.22668771e-02 -1.52098065e-01  1.55673216e-01]
 [-6.21595716e-02 -1.66941575e-01  6.49615584e-02]
 [ 1.24767429e-02  7.58676140e-01  1.05923994e-01]
 [ 3.45176652e-03 -2.72640516e-02 -3.34759326e-02]
 [ 1.22037168e-01  3.62889224e-02  1.24117759e-02]
 [-5.68053843e-02 -1.96694437e-01  1.90472912e-03]
 [-1.87892785e-02 -1.73611830e-02  9.46832758e-02]
 [-2.62263950e-02  1.32868535e-01 -4.83602900e-02]
 [ 9.94339895e-03 -1.25165549e-01  5.03904154e-02]
 [-7.99234711e-02  1.92798658e-01 -3.88258380e-02]
 [ 1.34920792e-01  5.98981113e-03 -3.48918130e-02]
 [ 3.82140013e-02  3.71361379e-02  1.78550611e-02]
 [-3.10263687e-02 -5.84343616e-02 -1.42367472e-02]
 [-1.00904056e-03  9.77143511e-02 -9.06815706e-02]
 [-2.80292497e-02 -1.89473008e-02 -2.32850663e-02]
 [-1.82543976e-02  3.30781562e-01 -2.68545907e-01]
 [ 2.25792126e-02  1.97079182e-02  1.10249096e-02]
 [ 4.53028560e-03 -4.49291241e-02  7.67819932e-02]
 [ 1.56044409e-01 -1.45984932e-03 -2.56305348e-01]
 [-8.29812608e-02  1.91966798e-02 -1.21316145e-03]
 [-1.32884910e-01 -2.07384443e-02  2.02592117e-01]
 [-5.37027215e-02 -3.40412380e-02 -1.24748157e-02]
 [-1.12862521e-01  1.33576640e-01 -9.40983284e-02]
 [ 2.24790597e-02 -3.85996120e-02  8.50969020e-02]
 [-8.16973494e-03  2.25643366e-02 -3.22921979e-02]
 [ 2.54065945e-02 -3.98305594e-02 -7.41055621e-02]
 [-1.98455044e-02  1.47546085e-02 -8.09602945e-02]
 [ 3.12527857e-02  1.86952441e-02  7.17449361e-02]
 [ 3.11297252e-02 -4.40504569e-02  1.21816466e-01]
 [-7.02785406e-02 -6.25442827e-03 -2.09245372e-02]
 [ 7.73707826e-02 -2.93627533e-02  1.23292878e-01]
 [-2.20915194e-02  5.34530225e-02 -1.62019339e-03]
 [-3.04944603e-02 -2.84439129e-02  1.56396159e-02]
 [ 9.35801405e-02  6.39067363e-03  9.17086633e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.0135678]
curr_Stock_Price:  99.06615074037043
curr_Factors:  [99.06615074 -0.94047262 -0.97775954]
mat_Sqrt:  [[14.54948573  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.55205786e-05  9.69039669e-03 -1.60115462e-02]
Stock Position:  -8.55205786307115e-05
Bond Position:  [-5.00509561]


portfolio before change:  [-5.01419009]
curr_Stock_Price:  99.02654461758871
curr_Factors:  [99.02654462 -1.00013482 -0.97206254]
mat_Sqrt:  [[13.77961846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01660435  0.01701359 -0.47668552]
Stock Position:  -0.016604346380720718
Bond Position:  [-3.36991904]


portfolio before change:  [-5.01297012]
curr_Stock_Price:  98.92770057743694
curr_Factors:  [98.92770058 -1.0371759  -0.96774122]
mat_Sqrt:  [[13.32273758  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072951  0.01780513  0.08710424]
Stock Position:  -0.0007295135619068956
Bond Position:  [-4.94080102]


portfolio before change:  [-5.01367018]
curr_Stock_Price:  99.04068017239318
curr_Factors:  [99.04068017 -0.99775439 -0.97927483]
mat_Sqrt:  [[13.7151555   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0085301  0.02643808 0.20670187]
Stock Position:  0.00853010096828919
Bond Position:  [-5.85849718]


portfolio before change:  [-5.01795707]
curr_Stock_Price:  98.62397514710243
curr_Factors:  [98.62397515 -1.00397471 -0.98481266]
mat_Sqrt:  [[13.49780413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00444824  0.06625877 -0.11810258]
Stock Position:  -0.004448237654097043
Bond Position:  [-4.57925419]


portfolio before change:  [-5.02095087]
curr_Stock_Price:  99.168316927989
curr_Factors:  [99.16831693 -1.02084208 -1.0336736 ]
mat_Sqrt:  [[12.7089046   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0056289  -0.04908944  0.44409235]
Stock Position:  -0.005628896014919072
Bond Position:  [-4.46274273]


portfolio before change:  [-5.02122154]
curr_Stock_Price:  99.11729237944533
curr_Factors:  [99.11729238 -1.05189537 -1.03322752]
mat_Sqrt:  [[12.3194711   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00673537 -0.05388016  0.18531724]
Stock Position:  -0.006735366695593139
Bond Position:  [-4.35363023]


portfolio before change:  [-5.0184068]
curr_Stock_Price:  98.61858435301728
curr_Factors:  [98.61858435 -1.16658505 -1.0485076 ]
mat_Sqrt:  [[10.76356779  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01755575 0.24486167 0.30217167]
Stock Position:  0.01755575009520287
Bond Position:  [-6.74973002]


portfolio before change:  [-5.04553779]
curr_Stock_Price:  97.12122756755524
curr_Factors:  [97.12122757 -0.96806671 -1.01401769]
mat_Sqrt:  [[13.3815323   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066859 -0.00879943 -0.09549752]
Stock Position:  -0.0006685879192605433
Bond Position:  [-4.98060371]


portfolio before change:  [-5.046083]
curr_Stock_Price:  97.00545255338271
curr_Factors:  [97.00545255 -1.21654242 -1.01451195]
mat_Sqrt:  [[10.41985181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01266603 0.0117122  0.03540734]
Stock Position:  0.012666030106047992
Bond Position:  [-6.27475698]


portfolio before change:  [-5.04865001]
curr_Stock_Price:  96.86471191575005
curr_Factors:  [96.86471192 -0.91987487 -1.03500124]
mat_Sqrt:  [[13.71430109  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00704131 -0.06348286  0.00543366]
Stock Position:  -0.007041311574620427
Bond Position:  [-4.3665954]


portfolio before change:  [-5.04795856]
curr_Stock_Price:  96.68899000156534
curr_Factors:  [96.68899    -1.09214866 -1.04527401]
mat_Sqrt:  [[11.40528525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.63559602e-04 -5.60329770e-03  2.70105031e-01]
Stock Position:  -0.0002635596016351397
Bond Position:  [-5.02247525]


portfolio before change:  [-5.04873772]
curr_Stock_Price:  97.26307918142317
curr_Factors:  [97.26307918 -1.17067624 -1.03290541]
mat_Sqrt:  [[10.73852575  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083589  0.04288314 -0.13795845]
Stock Position:  -0.0008358895699690984
Bond Position:  [-4.96743652]


portfolio before change:  [-5.04949172]
curr_Stock_Price:  97.4222374845715
curr_Factors:  [97.42223748 -1.12046392 -1.03363058]
mat_Sqrt:  [[11.30177734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047072 -0.04039701  0.14374983]
Stock Position:  -0.00047072342775917014
Bond Position:  [-5.00363279]


portfolio before change:  [-5.05006007]
curr_Stock_Price:  97.30084086502656
curr_Factors:  [97.30084087 -1.38935563 -1.00234327]
mat_Sqrt:  [[ 8.90051133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00544844  0.0622255  -0.11075931]
Stock Position:  -0.005448439863586389
Bond Position:  [-4.51992229]


portfolio before change:  [-5.05523179]
curr_Stock_Price:  98.14634660824663
curr_Factors:  [98.14634661 -1.40824367 -1.00586885]
mat_Sqrt:  [[ 8.77886544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0146968   0.0019332  -0.09953663]
Stock Position:  0.01469679610320427
Bond Position:  [-6.49766863]


portfolio before change:  [-5.06292404]
curr_Stock_Price:  97.67821748831632
curr_Factors:  [97.67821749 -1.31243034 -1.01291102]
mat_Sqrt:  [[ 9.54805258  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00517792 0.01198564 0.05093552]
Stock Position:  0.005177917938077413
Bond Position:  [-5.56869384]


portfolio before change:  [-5.06594307]
curr_Stock_Price:  97.22960176418829
curr_Factors:  [97.22960176 -1.22496093 -1.02156834]
mat_Sqrt:  [[10.28355417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00445958 -0.01885961 -0.04061348]
Stock Position:  -0.004459576516109329
Bond Position:  [-4.63234022]


portfolio before change:  [-5.06325307]
curr_Stock_Price:  96.4965549620599
curr_Factors:  [96.49655496 -1.17728629 -1.00526184]
mat_Sqrt:  [[10.88035834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.92008914e-05  3.15371712e-02 -2.58689280e-01]
Stock Position:  3.9200891383301214e-05
Bond Position:  [-5.06703582]


portfolio before change:  [-5.06388148]
curr_Stock_Price:  96.62418445550158
curr_Factors:  [96.62418446 -1.47591056 -0.98173592]
mat_Sqrt:  [[ 8.27453386  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00442924 -0.00611522 -0.06642581]
Stock Position:  -0.00442923990159476
Bond Position:  [-4.63590979]


portfolio before change:  [-5.06057656]
curr_Stock_Price:  95.74718375942659
curr_Factors:  [95.74718376 -1.25251461 -0.95929007]
mat_Sqrt:  [[10.48458968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.29405350e-04  1.06759290e-01 -7.66086725e-01]
Stock Position:  -0.0005294053504348336
Bond Position:  [-5.00988749]


portfolio before change:  [-5.06126919]
curr_Stock_Price:  95.87251560629657
curr_Factors:  [95.87251561 -1.14442248 -0.94122827]
mat_Sqrt:  [[11.90988335  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00242257 0.0063607  0.031451  ]
Stock Position:  0.002422569893671087
Bond Position:  [-5.29352706]


portfolio before change:  [-5.06002955]
curr_Stock_Price:  96.65737313081074
curr_Factors:  [96.65737313 -1.28419683 -0.92821043]
mat_Sqrt:  [[10.57788212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00104295 -0.01450081  0.21903765]
Stock Position:  0.0010429521863209686
Bond Position:  [-5.16083857]


portfolio before change:  [-5.06108336]
curr_Stock_Price:  96.26554142561982
curr_Factors:  [96.26554143 -1.27647775 -0.93990808]
mat_Sqrt:  [[10.49317029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.85672636e-03 -4.71164341e-04 -7.31167816e-01]
Stock Position:  0.009856726355895152
Bond Position:  [-6.00994646]


portfolio before change:  [-5.06374856]
curr_Stock_Price:  96.07136807051512
curr_Factors:  [96.07136807 -1.0790409  -0.94022992]
mat_Sqrt:  [[12.75368837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00621862  0.0061957  -0.00346081]
Stock Position:  -0.006218623835581195
Bond Position:  [-4.46631686]


portfolio before change:  [-5.06018347]
curr_Stock_Price:  95.40829295864285
curr_Factors:  [95.40829296 -1.15096018 -0.91512599]
mat_Sqrt:  [[12.08638158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00792331 -0.0066933   0.57793892]
Stock Position:  -0.007923313056594695
Bond Position:  [-4.3042337]


portfolio before change:  [-5.06090646]
curr_Stock_Price:  95.43163275711471
curr_Factors:  [95.43163276 -1.15602478 -0.91252852]
mat_Sqrt:  [[12.05954917  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524048 -0.01098676 -0.03558718]
Stock Position:  -0.005240475439755319
Bond Position:  [-4.56079933]


portfolio before change:  [-5.06512753]
curr_Stock_Price:  96.12831225381008
curr_Factors:  [96.12831225 -1.26371975 -0.93301442]
mat_Sqrt:  [[10.6861629   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00980745  0.04311168 -0.26843634]
Stock Position:  -0.00980745337302588
Bond Position:  [-4.12235359]


portfolio before change:  [-5.06819297]
curr_Stock_Price:  96.38833005073947
curr_Factors:  [96.38833005 -1.2367614  -0.923214  ]
mat_Sqrt:  [[11.11626929  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00287599 -0.01245797  0.24275778]
Stock Position:  0.0028759899932241702
Bond Position:  [-5.34540484]


portfolio before change:  [-5.06494368]
curr_Stock_Price:  97.75047063402832
curr_Factors:  [97.75047063 -1.5959236  -0.9393529 ]
mat_Sqrt:  [[ 7.74572833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013111   0.00728261 -0.09212065]
Stock Position:  -0.001311100243305125
Bond Position:  [-4.93678302]


portfolio before change:  [-5.06598392]
curr_Stock_Price:  98.07317400464775
curr_Factors:  [98.073174   -1.46579226 -0.93890577]
mat_Sqrt:  [[ 8.8552973   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00024273 -0.01285526 -0.21140254]
Stock Position:  0.00024273392526188216
Bond Position:  [-5.0897896]


portfolio before change:  [-5.06663217]
curr_Stock_Price:  98.02376297053722
curr_Factors:  [98.02376297 -1.40980439 -0.92517617]
mat_Sqrt:  [[ 9.48991235  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00351528  0.00476203 -0.23095719]
Stock Position:  -0.003515278356431387
Bond Position:  [-4.72205136]


portfolio before change:  [-5.06785144]
curr_Stock_Price:  98.202688109332
curr_Factors:  [98.20268811 -1.53276688 -0.92107956]
mat_Sqrt:  [[ 8.44172907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00588906 0.00603386 0.20466833]
Stock Position:  0.005889055409601301
Bond Position:  [-5.64617251]


portfolio before change:  [-5.06504027]
curr_Stock_Price:  98.79989472428221
curr_Factors:  [98.79989472 -1.3337479  -0.87911692]
mat_Sqrt:  [[10.80740687  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00434921 -0.01421722  0.34750847]
Stock Position:  0.004349206602838611
Bond Position:  [-5.49474142]


portfolio before change:  [-5.0672769]
curr_Stock_Price:  98.44356712252242
curr_Factors:  [98.44356712 -1.29518143 -0.8577381 ]
mat_Sqrt:  [[11.43368625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00663184 -0.00201861 -0.05969188]
Stock Position:  -0.006631844010803893
Bond Position:  [-4.41441452]


portfolio before change:  [-5.0746012]
curr_Stock_Price:  99.46477162796353
curr_Factors:  [99.46477163 -1.38302841 -0.89524472]
mat_Sqrt:  [[10.191259    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00947323 -0.00947679  0.35172026]
Stock Position:  0.009473234758367848
Bond Position:  [-6.01685434]


portfolio before change:  [-5.0696581]
curr_Stock_Price:  100.06596638688504
curr_Factors:  [100.06596639  -1.21255953  -0.91449179]
mat_Sqrt:  [[11.92668484  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00096516  0.01725189 -0.00462196]
Stock Position:  -0.0009651623760821736
Bond Position:  [-4.97307819]


portfolio before change:  [-5.07004339]
curr_Stock_Price:  99.82104915170648
curr_Factors:  [99.82104915 -1.13140718 -0.91954527]
mat_Sqrt:  [[12.83821948  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257887 -0.00918023  0.04461547]
Stock Position:  -0.0025788721319815588
Bond Position:  [-4.81261766]


portfolio before change:  [-5.07259678]
curr_Stock_Price:  100.57788357433267
curr_Factors:  [100.57788357  -1.19629744  -0.90698618]
mat_Sqrt:  [[12.27603239  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00925418 0.00206258 0.26161929]
Stock Position:  0.0092541775881281
Bond Position:  [-6.00336238]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.08085569]
Stock Price:  99.76652647197768
PL:  [-5.08085569]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 3.13291302e-02 -7.34636345e-02  1.00701273e-02]
 [-1.90290735e-01  9.58695063e-02 -3.44693564e-01]
 [-2.14983114e-02  3.37949369e-02  3.12908955e-02]
 [ 9.53099852e-02  1.02245124e-02  1.31583962e-01]
 [ 7.32353338e-02 -2.33621617e-02 -8.16413298e-02]
 [-7.82623422e-02 -1.55520126e-01  1.37218116e-01]
 [-6.11579783e-02 -1.73504909e-01  9.01796454e-02]
 [-2.23637625e-02  7.73434600e-01  1.53147255e-01]
 [ 1.70550470e-01 -1.21651963e-02  1.55595445e-01]
 [ 4.93365800e-01  1.94130311e-01  3.35583367e-01]
 [-2.80096136e-01 -2.73747394e-01  1.83355520e-02]
 [-7.87570183e-02 -1.94359469e-02  8.72493621e-02]
 [ 8.70114132e-03 -5.77048339e-02  1.18415403e-01]
 [ 9.55101318e-03 -7.60672478e-02 -5.62697684e-02]
 [-3.25932167e-02  8.46257103e-02 -4.97202572e-02]
 [-9.05264366e-02 -5.79621366e-02  9.02562492e-02]
 [ 5.10793115e-02  1.76093317e-02 -2.56700814e-02]
 [-6.51811290e-02 -6.56347921e-02  1.66833835e-02]
 [ 7.56799617e-02 -4.10971522e-02 -9.12835280e-02]
 [-1.16874832e-03  2.63147749e-02 -5.25923554e-02]
 [-3.83570235e-02  5.02436381e-01 -4.69205405e-01]
 [ 4.46488698e-01  2.49083975e-01  4.96703906e-02]
 [-6.20168976e-03 -3.99267611e-03  5.17740233e-02]
 [-4.60667999e-02 -9.46494941e-02 -4.46413136e-02]
 [ 3.54540625e-02 -6.25049076e-03 -1.17125880e-02]
 [-6.09670620e-02 -4.20256164e-03  1.65365594e-01]
 [ 6.86893940e-02 -3.19156246e-02  2.66376656e-02]
 [-1.50347879e-02 -5.69075924e-03 -2.51569543e-01]
 [-3.77155068e-02 -4.23175028e-02  3.47786196e-02]
 [-6.11459145e-02  7.15399101e-03  1.37823896e-02]
 [-1.80139763e-02 -4.26994338e-02 -2.07749882e-02]
 [ 1.31525449e-02  5.31356623e-02 -5.63236557e-02]
 [-3.33117083e-02  2.13382295e-02 -2.46887054e-02]
 [ 2.21801398e-02 -5.55134371e-02  6.39943304e-02]
 [-6.77214976e-02 -1.72082438e-02 -1.09585359e-02]
 [ 8.90207505e-02 -3.26467239e-04  1.61932019e-01]
 [-5.19366775e-02  7.46888484e-02 -7.81980412e-03]
 [-4.09390452e-02 -1.82850278e-02  2.70801908e-02]
 [ 9.41924214e-02  6.01135015e-03  8.80840820e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.38853401]
curr_Stock_Price:  99.87327936945233
curr_Factors:  [99.87327937 -1.18488841 -1.00124151]
mat_Sqrt:  [[11.22083432  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00163883 -0.02371029  0.02872727]
Stock Position:  0.0016388250815087674
Bond Position:  [1.22485917]


portfolio before change:  [1.3891543]
curr_Stock_Price:  100.158345702837
curr_Factors:  [100.1583457   -1.24930962  -0.98203363]
mat_Sqrt:  [[10.75541278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02241492  0.03094175 -0.98331479]
Stock Position:  -0.02241492146614473
Bond Position:  [3.63419575]


portfolio before change:  [1.38502442]
curr_Stock_Price:  100.36286022446691
curr_Factors:  [100.36286022  -1.23659437  -1.00144672]
mat_Sqrt:  [[10.70543041  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00076715  0.01090727  0.08926422]
Stock Position:  -0.0007671547193909965
Bond Position:  [1.46201827]


portfolio before change:  [1.38546837]
curr_Stock_Price:  100.02240762488897
curr_Factors:  [100.02240762  -1.27400849  -0.9876143 ]
mat_Sqrt:  [[10.42046272  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01192428 0.00329995 0.37537242]
Stock Position:  0.01192428036222282
Bond Position:  [0.19277314]


portfolio before change:  [1.38671349]
curr_Stock_Price:  100.1248056671804
curr_Factors:  [100.12480567  -1.22615157  -0.95177777]
mat_Sqrt:  [[11.34172181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00456735 -0.00754011 -0.23289999]
Stock Position:  0.004567347596612522
Bond Position:  [0.9294087]


portfolio before change:  [1.38518328]
curr_Stock_Price:  99.76433476377711
curr_Factors:  [99.76433476 -1.08604085 -0.94510972]
mat_Sqrt:  [[13.08753418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00626537 -0.0501939   0.39144509]
Stock Position:  -0.006265368496125794
Bond Position:  [2.0102436]


portfolio before change:  [1.38675834]
curr_Stock_Price:  99.5530512272198
curr_Factors:  [99.55305123 -1.00541425 -0.96330062]
mat_Sqrt:  [[13.90120897  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00562301 -0.05599847  0.25725743]
Stock Position:  -0.005623012843523295
Bond Position:  [1.94654643]


portfolio before change:  [1.38927957]
curr_Stock_Price:  99.1479483034507
curr_Factors:  [99.1479483  -0.62194284 -0.9613207 ]
mat_Sqrt:  [[20.35546911  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00819308 0.24962494 0.43688649]
Stock Position:  0.008193079006369541
Bond Position:  [0.5769526]


portfolio before change:  [1.38795288]
curr_Stock_Price:  98.97721669921835
curr_Factors:  [98.9772167  -0.71903717 -0.9079036 ]
mat_Sqrt:  [[19.45198097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01027289 -0.0039263   0.4438705 ]
Stock Position:  0.010272889289195626
Bond Position:  [0.37117089]


portfolio before change:  [1.4036421]
curr_Stock_Price:  100.49994473679786
curr_Factors:  [100.49994474  -0.68569834  -0.91720259]
mat_Sqrt:  [[20.23181273  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02973007 0.06265529 0.95732594]
Stock Position:  0.029730067188392367
Bond Position:  [-1.58422801]


portfolio before change:  [1.40777821]
curr_Stock_Price:  100.64572827372876
curr_Factors:  [100.64572827  -0.64049843  -0.91394104]
mat_Sqrt:  [[21.26722678  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01562178 -0.08835159  0.05230623]
Stock Position:  -0.01562177632994498
Bond Position:  [2.98004327]


portfolio before change:  [1.37679011]
curr_Stock_Price:  102.65322277899845
curr_Factors:  [102.65322278  -0.46866702  -0.89275799]
mat_Sqrt:  [[26.30953786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00246734 -0.00627292  0.24889814]
Stock Position:  -0.0024673433343821278
Bond Position:  [1.63007085]


portfolio before change:  [1.37836009]
curr_Stock_Price:  102.09950584713933
curr_Factors:  [102.09950585  -0.50693566  -0.88634506]
mat_Sqrt:  [[25.34717207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00083219 -0.01862416  0.33780618]
Stock Position:  0.0008321888617120858
Bond Position:  [1.29339402]


portfolio before change:  [1.37666656]
curr_Stock_Price:  99.87018582755398
curr_Factors:  [99.87018583 -0.37668221 -0.88392374]
mat_Sqrt:  [[28.31141967  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00061679 -0.0245506  -0.16052199]
Stock Position:  -0.0006167888200600146
Bond Position:  [1.43826537]


portfolio before change:  [1.37740238]
curr_Stock_Price:  98.96869279963066
curr_Factors:  [98.9686928  -0.58964745 -0.85698049]
mat_Sqrt:  [[23.29352964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109336  0.02731283 -0.14183805]
Stock Position:  -0.0010933581683437148
Bond Position:  [1.48561061]


portfolio before change:  [1.37550167]
curr_Stock_Price:  100.87696571454005
curr_Factors:  [100.87696571  -0.80210191  -0.85856952]
mat_Sqrt:  [[19.16776915  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00437894 -0.0187072   0.25747596]
Stock Position:  -0.004378935692964157
Bond Position:  [1.81723542]


portfolio before change:  [1.37300364]
curr_Stock_Price:  101.49930847402956
curr_Factors:  [101.49930847  -0.85569811  -0.86582091]
mat_Sqrt:  [[18.14750268  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00272401  0.00568339 -0.0732296 ]
Stock Position:  0.0027240066419406696
Bond Position:  [1.09651885]


portfolio before change:  [1.37085344]
curr_Stock_Price:  100.6596342481273
curr_Factors:  [100.65963425  -0.63794213  -0.87671962]
mat_Sqrt:  [[22.13329685  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00339639 -0.02118354  0.04759305]
Stock Position:  -0.0033963893364914975
Bond Position:  [1.71273274]


portfolio before change:  [1.36997457]
curr_Stock_Price:  100.98143842862781
curr_Factors:  [100.98143843  -0.54140139  -0.87201102]
mat_Sqrt:  [[24.56995383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00198038 -0.01326405 -0.2604065 ]
Stock Position:  0.001980380950215973
Bond Position:  [1.16999285]


portfolio before change:  [1.36897343]
curr_Stock_Price:  100.40205584926731
curr_Factors:  [100.40205585  -0.48304748  -0.87021247]
mat_Sqrt:  [[25.94354237  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0002518   0.00849306 -0.15003135]
Stock Position:  -0.0002518020437052516
Bond Position:  [1.39425487]


portfolio before change:  [1.36951278]
curr_Stock_Price:  98.95226635390298
curr_Factors:  [98.95226635 -0.62903363 -0.85774541]
mat_Sqrt:  [[22.37308194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00141124  0.16216064 -1.33851242]
Stock Position:  -0.0014112395886564885
Bond Position:  [1.50915814]


portfolio before change:  [1.37109976]
curr_Stock_Price:  97.96141782286334
curr_Factors:  [97.96141782 -0.38217859 -0.8471054 ]
mat_Sqrt:  [[28.65390451  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01771038 0.08039151 0.1416958 ]
Stock Position:  0.017710384904252925
Bond Position:  [-0.36383465]


portfolio before change:  [1.40536467]
curr_Stock_Price:  99.89872121803774
curr_Factors:  [99.89872122 -0.29285804 -0.88175684]
mat_Sqrt:  [[30.86250472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.15079347e-04 -1.28863067e-03  1.47696877e-01]
Stock Position:  0.00011507934743637279
Bond Position:  [1.39386839]


portfolio before change:  [1.40551761]
curr_Stock_Price:  99.71360444413386
curr_Factors:  [99.71360444 -0.25874332 -0.85839539]
mat_Sqrt:  [[32.6277584   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00228331 -0.03054799 -0.12734924]
Stock Position:  -0.002283313982625056
Bond Position:  [1.63319508]


portfolio before change:  [1.39946572]
curr_Stock_Price:  102.45350463702322
curr_Factors:  [102.45350464  -0.21973875  -0.85608867]
mat_Sqrt:  [[34.93823064  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090982 -0.00201734 -0.03341275]
Stock Position:  0.0009098160896696096
Bond Position:  [1.30625187]


portfolio before change:  [1.39913524]
curr_Stock_Price:  101.91078961798837
curr_Factors:  [101.91078962  -0.28221192  -0.88498549]
mat_Sqrt:  [[31.71850972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00088497 -0.00135637  0.47174201]
Stock Position:  -0.0008849657815469693
Bond Position:  [1.4893228]


portfolio before change:  [1.39847225]
curr_Stock_Price:  102.8703359541306
curr_Factors:  [102.87033595  -0.32742154  -0.90745191]
mat_Sqrt:  [[29.92205615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00225961 -0.01030072  0.07598985]
Stock Position:  0.002259605247972137
Bond Position:  [1.1660259]


portfolio before change:  [1.3919167]
curr_Stock_Price:  99.90463235651306
curr_Factors:  [99.90463236 -0.4125965  -0.88701935]
mat_Sqrt:  [[27.23764979  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247994 -0.00183668 -0.71765788]
Stock Position:  -0.00247994330539773
Bond Position:  [1.63967452]


portfolio before change:  [1.39186329]
curr_Stock_Price:  100.00881914860507
curr_Factors:  [100.00881915  -0.72301743  -0.90332208]
mat_Sqrt:  [[19.666543    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.001996   -0.01365792  0.09921372]
Stock Position:  -0.0019959977163445035
Bond Position:  [1.59148067]


portfolio before change:  [1.39311482]
curr_Stock_Price:  99.481474717314
curr_Factors:  [99.48147472 -0.87430423 -0.90256668]
mat_Sqrt:  [[16.82894859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337943  0.00230894  0.03931732]
Stock Position:  -0.003379432372837889
Bond Position:  [1.72930573]


portfolio before change:  [1.39064931]
curr_Stock_Price:  100.27500528389139
curr_Factors:  [100.27500528  -1.11901658  -0.92709996]
mat_Sqrt:  [[12.95912172  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00238987 -0.01378118 -0.05926526]
Stock Position:  -0.0023898717179019623
Bond Position:  [1.63029371]


portfolio before change:  [1.39330372]
curr_Stock_Price:  99.24958876544191
curr_Factors:  [99.24958877 -1.04274607 -0.93950595]
mat_Sqrt:  [[13.67248957  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00091438  0.01714946 -0.16067571]
Stock Position:  0.0009143761557631802
Bond Position:  [1.30255227]


portfolio before change:  [1.39375927]
curr_Stock_Price:  99.5697176033831
curr_Factors:  [99.5697176  -0.92785562 -0.92196493]
mat_Sqrt:  [[15.65887012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217101  0.00688688 -0.07043   ]
Stock Position:  -0.002171013687681444
Bond Position:  [1.60992649]


portfolio before change:  [1.39338076]
curr_Stock_Price:  99.8367640558098
curr_Factors:  [99.83676406 -0.90804542 -0.91398474]
mat_Sqrt:  [[16.1433198   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00148119 -0.01791688  0.18255801]
Stock Position:  0.0014811882045324446
Bond Position:  [1.24550373]


portfolio before change:  [1.3928554]
curr_Stock_Price:  99.37695394686999
curr_Factors:  [99.37695395 -1.19662181 -0.90660637]
mat_Sqrt:  [[12.13012525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00605691 -0.00555394 -0.03126165]
Stock Position:  -0.006056905093144185
Bond Position:  [1.99477217]


portfolio before change:  [1.38782738]
curr_Stock_Price:  100.2482531068051
curr_Factors:  [100.24825311  -1.21196955  -0.89894284]
mat_Sqrt:  [[12.14281027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.00477849e-02 -1.05366848e-04  4.61946978e-01]
Stock Position:  0.010047784905786322
Bond Position:  [0.3805545]


portfolio before change:  [1.38342316]
curr_Stock_Price:  99.8051911669537
curr_Factors:  [99.80519117 -1.00812697 -0.91192931]
mat_Sqrt:  [[14.63131249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261679  0.02410572 -0.02230772]
Stock Position:  -0.002616791286713379
Bond Position:  [1.64459252]


portfolio before change:  [1.38228164]
curr_Stock_Price:  100.31998545612274
curr_Factors:  [100.31998546  -1.10653501  -0.94601007]
mat_Sqrt:  [[12.88185649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303867 -0.00590147  0.07725225]
Stock Position:  -0.0030386722675220883
Bond Position:  [1.6871212]


portfolio before change:  [1.38264405]
curr_Stock_Price:  100.27012623994045
curr_Factors:  [100.27012624  -0.89107315  -0.91883518]
mat_Sqrt:  [[16.41112538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00690992 0.00194015 0.25127937]
Stock Position:  0.006909920462321618
Bond Position:  [0.68978545]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.37872441]
Stock Price:  99.69039930900267
PL:  [1.37872441]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.25645843e-01 -4.44913917e-02  3.88972625e-03]
 [-8.53793061e-02  5.43142293e-02  1.34212763e-01]
 [-4.39211012e-02  4.80455699e-02  1.53415118e-02]
 [ 7.56790809e-02  8.89495596e-02  5.81770068e-02]
 [ 2.96029070e-04  1.14690098e-01 -5.58161895e-02]
 [-5.89362369e-02 -1.41868163e-01  2.11498895e-01]
 [-6.51897571e-02 -1.59350372e-01 -2.71586444e-02]
 [-9.80198154e-02  9.25051897e-01  2.78845936e-01]
 [ 3.76793028e-01  3.18282875e-02  3.53329593e-01]
 [ 5.97643107e-01  2.45686048e-01  4.49671323e-01]
 [-2.21657637e-01 -2.28706792e-01  2.79698568e-02]
 [-5.95275789e-02 -1.70514373e-02  8.19121396e-02]
 [ 1.60604261e-02 -9.84441746e-02  1.26368682e-01]
 [ 2.05241288e-03  8.19771340e-02 -3.28200336e-02]
 [ 6.60065123e-01 -1.66958365e-01 -3.19610277e-01]
 [-1.60030026e-01 -9.34378252e-02  1.08270342e-01]
 [ 5.84943815e-02 -1.63890559e-02 -3.29364751e-03]
 [-6.21164116e-02 -6.46563075e-02  1.50824175e-02]
 [ 2.90853418e-01 -3.81239470e-01  1.89916027e-01]
 [ 7.49224199e-02  1.19787581e-02  6.70644122e-01]
 [-5.48045319e-02  6.15947228e-01 -5.89267212e-01]
 [ 3.52641112e-01  2.04178222e-01  6.49528086e-02]
 [-3.22057485e-01  2.30265475e-01 -1.53976479e-01]
 [-7.06938479e-02 -1.15062440e-01 -1.28384422e-02]
 [-6.14853515e-02 -3.93751928e-02 -7.89191298e-04]
 [ 4.27427814e-02  3.32489349e-02 -1.13990679e-01]
 [ 8.53669739e-02  9.80851374e-03  3.38399236e-01]
 [ 1.69200954e-01 -5.16844617e-02  2.26524836e-01]
 [ 3.77452649e-02  1.31660975e-01 -2.78705580e-01]
 [-9.80837893e-02  1.32964421e-01 -1.81371243e-01]
 [ 4.30727751e-01  1.43321516e-01  1.69432126e-01]
 [ 2.79654536e-02 -2.37006112e-01 -4.08676832e-01]
 [ 1.16774185e-01 -2.88470193e-02  1.42535049e-01]
 [-4.87167553e-02 -1.84544622e-01 -8.04289383e-01]
 [ 2.45078660e-01  9.85192238e-01 -5.35865213e-01]
 [ 3.18446121e-02  1.39550770e-01  6.13348096e-02]
 [ 9.83658842e-01 -4.79191350e-01  8.75577373e-01]
 [-2.98948529e-01  1.65714582e-01  8.76569661e-02]
 [ 1.01739561e+00 -1.81064997e-01 -1.50365953e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.18168145]
curr_Stock_Price:  99.54924602228509
curr_Factors:  [99.54924602 -0.85210685 -1.00202803]
mat_Sqrt:  [[15.58825238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00752862 -0.01435953  0.01109631]
Stock Position:  0.007528622161895875
Bond Position:  [-1.93115011]


portfolio before change:  [-1.18448046]
curr_Stock_Price:  99.20952842254748
curr_Factors:  [99.20952842 -0.54263211 -0.98012049]
mat_Sqrt:  [[21.63865846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00216725  0.01752984  0.38287166]
Stock Position:  -0.002167250569555347
Bond Position:  [-0.96946856]


portfolio before change:  [-1.18447302]
curr_Stock_Price:  99.1501736208917
curr_Factors:  [99.15017362 -0.28053197 -0.99046397]
mat_Sqrt:  [[27.81678651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0011138   0.01550664  0.04376506]
Stock Position:  -0.001113797501275636
Bond Position:  [-1.0740398]


portfolio before change:  [-1.18391146]
curr_Stock_Price:  98.52544598810645
curr_Factors:  [ 9.85254460e+01  2.29467634e-02 -9.65449815e-01]
mat_Sqrt:  [[38.39056776  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00275357 0.02870835 0.16596281]
Stock Position:  0.0027535712974999173
Bond Position:  [-1.4552083]


portfolio before change:  [-1.17992999]
curr_Stock_Price:  100.03744122539413
curr_Factors:  [ 1.00037441e+02  1.05561536e-02 -9.90648747e-01]
mat_Sqrt:  [[37.54168572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.000328    0.03701607 -0.15922805]
Stock Position:  0.00032799846338950626
Bond Position:  [-1.21274211]


portfolio before change:  [-1.18052252]
curr_Stock_Price:  98.69312164756728
curr_Factors:  [98.69312165  0.21034089 -0.97802826]
mat_Sqrt:  [[45.80200587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00097644 -0.04578775  0.60334748]
Stock Position:  -0.0009764402766751189
Bond Position:  [-1.08415459]


portfolio before change:  [-1.17973774]
curr_Stock_Price:  97.75060789686648
curr_Factors:  [97.7506079   0.1614481  -0.97179992]
mat_Sqrt:  [[43.46985043  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00237546 -0.05143011 -0.07747605]
Stock Position:  -0.002375456773966008
Bond Position:  [-0.9475354]


portfolio before change:  [-1.17903161]
curr_Stock_Price:  97.40348344448017
curr_Factors:  [ 9.74034834e+01 -6.29371828e-02 -9.62524807e-01]
mat_Sqrt:  [[34.93188367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00422894 0.29855922 0.79546984]
Stock Position:  0.0042289388727333255
Bond Position:  [-1.59094499]


portfolio before change:  [-1.16928138]
curr_Stock_Price:  99.75610971621832
curr_Factors:  [99.75610972 -0.20115995 -0.96726375]
mat_Sqrt:  [[31.00984096  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01468608 0.01027254 1.00795098]
Stock Position:  0.014686081474144574
Bond Position:  [-2.63430774]


portfolio before change:  [-1.1477005]
curr_Stock_Price:  101.24801136795473
curr_Factors:  [101.24801137  -0.38119533  -0.96907025]
mat_Sqrt:  [[26.24059094  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02818467 0.07929483 1.28278712]
Stock Position:  0.02818466768529359
Bond Position:  [-4.00134206]


portfolio before change:  [-1.14269135]
curr_Stock_Price:  101.44348467390284
curr_Factors:  [101.44348467  -0.45052397  -0.97554139]
mat_Sqrt:  [[24.37203777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01077599 -0.0738148   0.07979022]
Stock Position:  -0.010775992358099992
Bond Position:  [-0.04953713]


portfolio before change:  [-1.16159442]
curr_Stock_Price:  103.19709332597738
curr_Factors:  [103.19709333  -0.68642073  -0.95887658]
mat_Sqrt:  [[19.91241451  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00232458 -0.00550333  0.23367253]
Stock Position:  -0.0023245771337528673
Bond Position:  [-0.92170481]


portfolio before change:  [-1.16468]
curr_Stock_Price:  104.47490179565271
curr_Factors:  [104.4749018   -0.64915677  -0.96609   ]
mat_Sqrt:  [[20.77395629  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00104749 -0.03177272  0.36049467]
Stock Position:  0.0010474890758875811
Bond Position:  [-1.27411632]


portfolio before change:  [-1.1636728]
curr_Stock_Price:  105.58849769671781
curr_Factors:  [105.5884977   -0.6981193   -0.98076452]
mat_Sqrt:  [[19.70092553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0006135   0.02645801 -0.09362642]
Stock Position:  0.0006135023437940409
Bond Position:  [-1.22845159]


portfolio before change:  [-1.16336241]
curr_Stock_Price:  106.34473428437205
curr_Factors:  [106.34473428  -0.51177184  -1.01536744]
mat_Sqrt:  [[23.09339749  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0242816  -0.05388558 -0.91175916]
Stock Position:  0.024281603219047685
Bond Position:  [-3.74558305]


portfolio before change:  [-1.15924613]
curr_Stock_Price:  106.53353985356479
curr_Factors:  [106.53353985  -0.76380897  -1.00240447]
mat_Sqrt:  [[18.21501816  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00861939 -0.03015693  0.30886515]
Stock Position:  -0.008619390340634005
Bond Position:  [-0.24099197]


portfolio before change:  [-1.15956876]
curr_Stock_Price:  106.56747480256122
curr_Factors:  [106.5674748   -0.84855813  -1.01231877]
mat_Sqrt:  [[16.575098    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00328666 -0.00528955 -0.00939586]
Stock Position:  0.0032866572819211016
Bond Position:  [-1.50981953]


portfolio before change:  [-1.15501992]
curr_Stock_Price:  108.00893406800904
curr_Factors:  [108.00893407  -1.05724559  -1.00573767]
mat_Sqrt:  [[13.72516049  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00526301 -0.02086773  0.04302594]
Stock Position:  -0.005263008733272206
Bond Position:  [-0.58656795]


portfolio before change:  [-1.15946604]
curr_Stock_Price:  108.83978984662055
curr_Factors:  [108.83978985  -1.19083912  -1.03229648]
mat_Sqrt:  [[11.78398472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02136796 -0.12304451  0.54177756]
Stock Position:  0.02136795741838282
Bond Position:  [-3.48515004]


portfolio before change:  [-1.158211]
curr_Stock_Price:  108.91891342177378
curr_Factors:  [108.91891342  -0.79567491  -1.01388988]
mat_Sqrt:  [[17.83279012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01201507 0.00386613 1.91316101]
Stock Position:  0.012015070581714502
Bond Position:  [-2.46687944]


portfolio before change:  [-1.15313099]
curr_Stock_Price:  109.36738297209666
curr_Factors:  [109.36738297  -0.78009944  -1.01663244]
mat_Sqrt:  [[18.13748548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00272135  0.19879611 -1.68101534]
Stock Position:  -0.002721352772852616
Bond Position:  [-0.85550376]


portfolio before change:  [-1.15178063]
curr_Stock_Price:  108.83187627822423
curr_Factors:  [108.83187628  -0.75006224  -1.03111849]
mat_Sqrt:  [[18.33154875  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02223365 0.06589824 0.18529228]
Stock Position:  0.02223365081212296
Bond Position:  [-3.57151057]


portfolio before change:  [-1.11722338]
curr_Stock_Price:  110.406234082564
curr_Factors:  [110.40623408  -0.67033538  -1.04883919]
mat_Sqrt:  [[19.78634468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01548973  0.07431786 -0.43925203]
Stock Position:  -0.015489726042845202
Bond Position:  [0.59293894]


portfolio before change:  [-1.10399446]
curr_Stock_Price:  109.5569747565404
curr_Factors:  [109.55697476  -0.2946931   -1.02487737]
mat_Sqrt:  [[29.27910887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330616 -0.03713624 -0.0366245 ]
Stock Position:  -0.0033061629875723985
Bond Position:  [-0.74178125]


portfolio before change:  [-1.10252643]
curr_Stock_Price:  109.0848988360904
curr_Factors:  [109.08489884  -0.13247266  -1.01173602]
mat_Sqrt:  [[34.7409042   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200582 -0.01270829 -0.00225134]
Stock Position:  -0.0020058163053504503
Bond Position:  [-0.88372216]


portfolio before change:  [-1.11128568]
curr_Stock_Price:  113.39674618396548
curr_Factors:  [113.39674618  -0.22405433  -1.0183089 ]
mat_Sqrt:  [[32.73777033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00080218  0.01073105 -0.32518368]
Stock Position:  0.0008021756426125511
Bond Position:  [-1.20224978]


portfolio before change:  [-1.11286036]
curr_Stock_Price:  111.62107945366918
curr_Factors:  [111.62107945  -0.38054396  -1.00368228]
mat_Sqrt:  [[27.96304101  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00559469 0.00316568 0.96535883]
Stock Position:  0.005594691332459374
Bond Position:  [-1.73734585]


portfolio before change:  [-1.09814762]
curr_Stock_Price:  114.28966676458062
curr_Factors:  [114.28966676  -0.36515912  -1.01777411]
mat_Sqrt:  [[28.66861394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00714684 -0.01668109  0.64621231]
Stock Position:  0.007146843455438756
Bond Position:  [-1.91495798]


portfolio before change:  [-1.07725183]
curr_Stock_Price:  117.24694094375728
curr_Factors:  [117.24694094  -0.44387922  -1.03027531]
mat_Sqrt:  [[26.84629399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.87932123e-04  4.24933968e-02 -7.95069444e-01]
Stock Position:  0.00028793212262686143
Bond Position:  [-1.11101099]


portfolio before change:  [-1.07795137]
curr_Stock_Price:  115.29977851413874
curr_Factors:  [115.29977851  -0.27672233  -1.03009889]
mat_Sqrt:  [[31.20924242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00345939  0.04291408 -0.51740167]
Stock Position:  -0.0034593851676072798
Bond Position:  [-0.67908502]


portfolio before change:  [-1.08638523]
curr_Stock_Price:  117.71320487391125
curr_Factors:  [117.71320487  -0.38322801  -1.05531669]
mat_Sqrt:  [[27.93014305  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01770733 0.04625682 0.4833427 ]
Stock Position:  0.017707332183361697
Bond Position:  [-3.17077205]


portfolio before change:  [-1.07608852]
curr_Stock_Price:  118.31708372168875
curr_Factors:  [118.31708372  -0.36562813  -1.07046406]
mat_Sqrt:  [[28.14236198  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0036896  -0.07649339 -1.16584125]
Stock Position:  -0.003689598812997826
Bond Position:  [-0.63954595]


portfolio before change:  [-1.08475989]
curr_Stock_Price:  120.64563735632525
curr_Factors:  [120.64563736  -0.37119668  -1.05414544]
mat_Sqrt:  [[29.0063713   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00482586 -0.00931034  0.40661282]
Stock Position:  0.004825858958177578
Bond Position:  [-1.66697872]


portfolio before change:  [-1.09046061]
curr_Stock_Price:  119.50753362906778
curr_Factors:  [119.50753363  -0.43649756  -1.07315447]
mat_Sqrt:  [[26.40959473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00948752 -0.05956152 -2.29441374]
Stock Position:  -0.009487523526360868
Bond Position:  [0.04336993]


portfolio before change:  [-1.0926152]
curr_Stock_Price:  119.73520228979916
curr_Factors:  [119.73520229  -0.42197335  -1.08904384]
mat_Sqrt:  [[26.42380932  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01274597  0.31796943 -1.5286743 ]
Stock Position:  0.012745972802583801
Bond Position:  [-2.61875683]


portfolio before change:  [-1.11768155]
curr_Stock_Price:  117.79427665197626
curr_Factors:  [117.79427665  -0.20851577  -1.07824342]
mat_Sqrt:  [[32.53057734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00223944 0.04503982 0.17497114]
Stock Position:  0.00223943794414893
Bond Position:  [-1.38147452]


portfolio before change:  [-1.1125868]
curr_Stock_Price:  120.14640470240306
curr_Factors:  [120.1464047   -0.45810222  -1.08441723]
mat_Sqrt:  [[25.69230667  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04143539 -0.15465834  2.49777853]
Stock Position:  0.04143539208386273
Bond Position:  [-6.09090018]


portfolio before change:  [-1.11487025]
curr_Stock_Price:  120.10967185155978
curr_Factors:  [120.10967185  -0.23501478  -1.12026285]
mat_Sqrt:  [[30.97336444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.007982    0.05348415  0.25006093]
Stock Position:  -0.007981996221619679
Bond Position:  [-0.1561553]


portfolio before change:  [-1.12118094]
curr_Stock_Price:  120.89784191464085
curr_Factors:  [120.89784191  -0.14530233  -1.1288154 ]
mat_Sqrt:  [[33.81241964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02808857 -0.05843848 -0.42895221]
Stock Position:  0.028088571071858356
Bond Position:  [-4.51702856]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.13907342]
Stock Price:  120.28094275824964
PL:  [-21.42001618]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 4.36010904e-02 -7.19066956e-02  9.59100952e-03]
 [-2.23568438e-01  3.50585871e-02 -3.88946938e-01]
 [-3.51861069e-02  4.33136097e-02  2.15632570e-02]
 [-8.97694915e-02 -7.67996468e-02 -4.25196331e-02]
 [ 1.09658794e-01 -7.56485163e-02 -8.81423054e-02]
 [-1.29899213e-01 -1.64420456e-01  9.43679960e-02]
 [-5.54590276e-02 -1.66051494e-01  2.80853493e-02]
 [ 1.41959593e-02  6.77205486e-01  1.06500833e-01]
 [ 1.69720827e-01 -5.85973078e-03  1.67759260e-01]
 [ 4.06500837e-01  1.54946156e-01  2.52689260e-01]
 [-1.63904168e-01 -1.65337486e-01  5.68399182e-02]
 [-1.53648321e-02 -1.72427039e-02  9.51077880e-02]
 [-3.85257334e-03  4.04624057e-03  9.71569992e-02]
 [ 9.07632466e-03 -1.07256104e-01  5.29073090e-02]
 [-8.12579477e-02  1.96313281e-01 -3.99585308e-02]
 [ 1.02459931e-01 -3.23587250e-03 -1.04625903e-02]
 [ 6.38145190e-02  3.22291717e-02 -9.43924094e-02]
 [-3.07991368e-02 -5.83864571e-02 -1.44424591e-02]
 [ 5.43371222e-02  5.11173650e-02 -2.66540453e-01]
 [-7.58946217e-02  1.07170651e-02 -4.57973156e-02]
 [-3.91943596e-02  4.96941878e-01 -4.53007449e-01]
 [ 2.34144505e-01  1.47477995e-01  8.42491459e-02]
 [-1.14620969e-03 -1.93860636e-02  6.12102209e-02]
 [-1.36472206e-02 -8.39967635e-02 -1.01547011e-01]
 [ 4.70589136e-02  1.85928794e-02 -1.33031465e-02]
 [-3.74361991e-02  1.16269178e-03  1.29861593e-01]
 [ 1.79860061e-02 -3.30570461e-02  7.43646649e-03]
 [-1.69244841e-02 -8.30165197e-03 -2.67660016e-01]
 [-5.79387981e-02 -2.85954480e-02 -1.32900143e-02]
 [-7.74178402e-02  5.34207953e-03  2.52398666e-02]
 [ 1.27803063e-02 -2.63288889e-02  7.53251749e-03]
 [ 2.68367568e-02 -1.43873801e-02 -5.99734340e-02]
 [-4.02970310e-02  2.37926394e-02 -1.38107662e-01]
 [ 1.87369477e-02 -5.87893443e-02  5.39216144e-02]
 [-4.98863182e-02  1.04004774e-01 -1.21079795e-02]
 [-7.08810305e-02 -1.12760800e-01 -5.54129118e-02]
 [ 5.84125548e-03  1.02367831e-01  1.17301743e-01]
 [ 6.94887265e-02 -7.85597674e-02 -8.27544627e-02]
 [ 9.77674526e-02  3.79652805e-03  6.69206077e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.147412]
curr_Stock_Price:  99.84288052781191
curr_Factors:  [99.84288053 -1.23293714 -0.9917291 ]
mat_Sqrt:  [[10.79336411  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00286111 -0.02320779  0.02736048]
Stock Position:  0.002861105576753376
Bond Position:  [0.86175097]


portfolio before change:  [1.14898621]
curr_Stock_Price:  100.35544037295645
curr_Factors:  [100.35544037  -1.44160404  -1.00185276]
mat_Sqrt:  [[ 8.71688101  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0339348   0.01131511 -1.10955735]
Stock Position:  -0.03393479789319218
Bond Position:  [4.5545278]


portfolio before change:  [1.15507568]
curr_Stock_Price:  100.19277206854281
curr_Factors:  [100.19277207  -1.34134263  -1.01404179]
mat_Sqrt:  [[ 9.50398925  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00230884  0.01397941  0.06151397]
Stock Position:  -0.002308838044836412
Bond Position:  [1.38640456]


portfolio before change:  [1.15353489]
curr_Stock_Price:  100.93517829710368
curr_Factors:  [100.9351783   -1.21663741  -1.03876438]
mat_Sqrt:  [[10.58117757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0107857  -0.02478698 -0.12129668]
Stock Position:  -0.010785702892762773
Bond Position:  [2.24219174]


portfolio before change:  [1.15703424]
curr_Stock_Price:  100.63672248206935
curr_Factors:  [100.63672248  -1.15084057  -1.05186571]
mat_Sqrt:  [[11.12073019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00685433 -0.02441545 -0.25144546]
Stock Position:  0.006854328015492018
Bond Position:  [0.46723713]


portfolio before change:  [1.15646816]
curr_Stock_Price:  100.54561443179232
curr_Factors:  [100.54561443  -1.38962576  -1.05036718]
mat_Sqrt:  [[ 8.76370322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01645407 -0.05306647  0.26920563]
Stock Position:  -0.01645407291154058
Bond Position:  [2.81085303]


portfolio before change:  [1.15848732]
curr_Stock_Price:  100.44425460083151
curr_Factors:  [100.4442546   -1.29653184  -1.04310284]
mat_Sqrt:  [[ 9.67909305  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00863937 -0.05359289  0.08011968]
Stock Position:  -0.008639368221700484
Bond Position:  [2.02626223]


portfolio before change:  [1.15867024]
curr_Stock_Price:  100.45240175480387
curr_Factors:  [100.45240175  -1.40470913  -1.05746598]
mat_Sqrt:  [[ 8.56349919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02033857 0.21856713 0.30381723]
Stock Position:  0.020338571640652916
Bond Position:  [-0.88438813]


portfolio before change:  [1.14741776]
curr_Stock_Price:  99.90457948944687
curr_Factors:  [99.90457949 -1.16731539 -1.08502601]
mat_Sqrt:  [[10.50523936  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01930165 -0.00189122  0.47857047]
Stock Position:  0.01930164775613418
Bond Position:  [-0.78090524]


portfolio before change:  [1.15728664]
curr_Stock_Price:  100.42093419948748
curr_Factors:  [100.4209342   -0.99518235  -1.07583683]
mat_Sqrt:  [[12.65878585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03868531 0.05000866 0.72085212]
Stock Position:  0.038685311075125746
Bond Position:  [-2.72752844]


portfolio before change:  [1.12947892]
curr_Stock_Price:  99.7109295224285
curr_Factors:  [99.71092952 -0.82199384 -1.05132481]
mat_Sqrt:  [[15.31689775  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01214679 -0.05336244  0.16214847]
Stock Position:  -0.012146790023912427
Bond Position:  [2.34064665]


portfolio before change:  [1.1508018]
curr_Stock_Price:  97.9795845743626
curr_Factors:  [97.97958457 -1.1477322  -1.09901734]
mat_Sqrt:  [[10.36059426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.10889291e-05 -5.56505877e-03  2.71316046e-01]
Stock Position:  5.108892907508557e-05
Bond Position:  [1.14579613]


portfolio before change:  [1.15094352]
curr_Stock_Price:  97.94995499637191
curr_Factors:  [97.949955   -0.87289676 -1.10942065]
mat_Sqrt:  [[13.49257151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00124553 0.00130592 0.27716188]
Stock Position:  0.0012455336234462858
Bond Position:  [1.02894356]


portfolio before change:  [1.15022725]
curr_Stock_Price:  97.27161089246928
curr_Factors:  [97.27161089 -1.04948744 -1.13250559]
mat_Sqrt:  [[10.97383884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018385 -0.03461676  0.15092983]
Stock Position:  -0.00018385332164787705
Bond Position:  [1.16811096]


portfolio before change:  [1.15033545]
curr_Stock_Price:  97.47734501241996
curr_Factors:  [97.47734501 -0.87816002 -1.14372959]
mat_Sqrt:  [[12.90649123  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00382305  0.06335984 -0.11399057]
Stock Position:  -0.003823050512970956
Bond Position:  [1.52299626]


portfolio before change:  [1.14770047]
curr_Stock_Price:  98.2163781103228
curr_Factors:  [98.21637811 -0.56650335 -1.14421139]
mat_Sqrt:  [[17.75129085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00561445 -0.00104437 -0.02984686]
Stock Position:  0.0056144505354714346
Bond Position:  [0.59626948]


portfolio before change:  [1.14812525]
curr_Stock_Price:  98.2787603479046
curr_Factors:  [98.27876035 -0.29298755 -1.11943983]
mat_Sqrt:  [[23.9359271   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213593  0.01040192 -0.26927527]
Stock Position:  0.0021359315205485966
Bond Position:  [0.93820855]


portfolio before change:  [1.1482375]
curr_Stock_Price:  98.2764028224617
curr_Factors:  [98.27640282 -0.42252036 -1.10263113]
mat_Sqrt:  [[21.38377499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213551 -0.01884415 -0.04120032]
Stock Position:  -0.00213551054726127
Bond Position:  [1.3581078]


portfolio before change:  [1.14897753]
curr_Stock_Price:  98.00937057825195
curr_Factors:  [98.00937058 -0.45538534 -1.12183027]
mat_Sqrt:  [[20.24377791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.11963163e-04  1.64980586e-02 -7.60365721e-01]
Stock Position:  0.0005119631630396194
Bond Position:  [1.09880034]


portfolio before change:  [1.14870231]
curr_Stock_Price:  97.20351005293347
curr_Factors:  [97.20351005 -0.3482888  -1.11828864]
mat_Sqrt:  [[22.42618803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0037035   0.00345892 -0.13064699]
Stock Position:  -0.003703498237817873
Bond Position:  [1.50869534]


portfolio before change:  [1.1465331]
curr_Stock_Price:  97.8401551218778
curr_Factors:  [97.84015512 -0.54127517 -1.13002421]
mat_Sqrt:  [[18.39420552  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164325  0.1603873  -1.29230416]
Stock Position:  -0.0016432501974835703
Bond Position:  [1.30730895]


portfolio before change:  [1.14682272]
curr_Stock_Price:  97.76335823595998
curr_Factors:  [97.76335824 -0.57867089 -1.1291207 ]
mat_Sqrt:  [[17.72113955  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01588191 0.04759832 0.24033936]
Stock Position:  0.01588191376215826
Bond Position:  [-0.40584651]


portfolio before change:  [1.16909104]
curr_Stock_Price:  99.16867107197008
curr_Factors:  [99.16867107 -0.68960818 -1.1322379 ]
mat_Sqrt:  [[16.03824316  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00046084 -0.00625683  0.17461572]
Stock Position:  0.00046084291195017335
Bond Position:  [1.12338986]


portfolio before change:  [1.16953548]
curr_Stock_Price:  99.82833437547858
curr_Factors:  [99.82833438 -0.79460487 -1.09834461]
mat_Sqrt:  [[15.03683077  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00342633 -0.02710984 -0.28968536]
Stock Position:  -0.0034263327081931983
Bond Position:  [1.51158056]


portfolio before change:  [1.16556374]
curr_Stock_Price:  101.04266334895226
curr_Factors:  [101.04266335  -0.75561605  -1.11920814]
mat_Sqrt:  [[15.49811884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0031061   0.00600083 -0.03795017]
Stock Position:  0.003106097993475907
Bond Position:  [0.85171533]


portfolio before change:  [1.16657058]
curr_Stock_Price:  101.33253305210783
curr_Factors:  [101.33253305  -0.72456533  -1.13634589]
mat_Sqrt:  [[15.76033434  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00067835  0.00037526  0.37045898]
Stock Position:  -0.0006783472114024882
Bond Position:  [1.23530922]


portfolio before change:  [1.16711787]
curr_Stock_Price:  100.75337471122445
curr_Factors:  [100.75337471  -0.54651086  -1.15945702]
mat_Sqrt:  [[18.29646396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0006972  -0.01066912  0.02121417]
Stock Position:  0.0006971963094216515
Bond Position:  [1.09687299]


portfolio before change:  [1.16677072]
curr_Stock_Price:  100.05878448662997
curr_Factors:  [100.05878449  -0.29907869  -1.1996206 ]
mat_Sqrt:  [[22.35519124  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00327686 -0.00267935 -0.76355952]
Stock Position:  -0.0032768641014970143
Bond Position:  [1.49464976]


portfolio before change:  [1.15847073]
curr_Stock_Price:  102.64871025856596
curr_Factors:  [102.64871026  -0.27004753  -1.1744522 ]
mat_Sqrt:  [[24.21113972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0027462  -0.00922914 -0.03791271]
Stock Position:  -0.0027462000185429322
Bond Position:  [1.44036462]


portfolio before change:  [1.16629443]
curr_Stock_Price:  99.86535791413355
curr_Factors:  [99.86535791 -0.2758532  -1.18175337]
mat_Sqrt:  [[23.24793452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306158  0.00172415  0.07200231]
Stock Position:  -0.003061576351388354
Bond Position:  [1.47203985]


portfolio before change:  [1.16641357]
curr_Stock_Price:  99.8865478114736
curr_Factors:  [99.88654781 -0.35016303 -1.16387037]
mat_Sqrt:  [[21.97711347  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040695 -0.00849761  0.02148818]
Stock Position:  0.0004069466667149288
Bond Position:  [1.12576507]


portfolio before change:  [1.16707094]
curr_Stock_Price:  101.1561068851238
curr_Factors:  [101.15610689  -0.44668768  -1.16743187]
mat_Sqrt:  [[20.13672748  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00057894 -0.00464351 -0.17108751]
Stock Position:  0.0005789381242380123
Bond Position:  [1.10850782]


portfolio before change:  [1.16642317]
curr_Stock_Price:  99.79784532991663
curr_Factors:  [ 9.97978453e+01  8.38359158e-03 -1.13419444e+00]
mat_Sqrt:  [[32.37335612  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196555  0.00767904 -0.39398272]
Stock Position:  -0.001965551146462948
Bond Position:  [1.36258093]


portfolio before change:  [1.16754957]
curr_Stock_Price:  99.3114289549983
curr_Factors:  [99.31142895  0.17758965 -1.13033241]
mat_Sqrt:  [[38.3026047   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00046324 -0.01897418  0.15382336]
Stock Position:  0.00046324072943563805
Bond Position:  [1.12154448]


portfolio before change:  [1.16767541]
curr_Stock_Price:  99.28041291834668
curr_Factors:  [99.28041292 -0.21689368 -1.11623186]
mat_Sqrt:  [[26.17547138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0011892  0.0335674 -0.0345407]
Stock Position:  -0.0011892035509763826
Bond Position:  [1.28574003]


portfolio before change:  [1.17066838]
curr_Stock_Price:  96.89877960704685
curr_Factors:  [96.89877961 -0.37735586 -1.14184607]
mat_Sqrt:  [[21.20983497  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0049604  -0.03639339 -0.15807761]
Stock Position:  -0.0049604037800827176
Bond Position:  [1.65132546]


portfolio before change:  [1.17068861]
curr_Stock_Price:  96.93631768521718
curr_Factors:  [96.93631769 -0.29450082 -1.12788299]
mat_Sqrt:  [[23.37507847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00216817 0.03303908 0.33462922]
Stock Position:  0.002168168950767769
Bond Position:  [0.96051429]


portfolio before change:  [1.17251401]
curr_Stock_Price:  97.72284741483521
curr_Factors:  [97.72284741 -0.37223009 -1.14131734]
mat_Sqrt:  [[21.51150598  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00169958 -0.02535506 -0.23607545]
Stock Position:  0.0016995833378376291
Bond Position:  [1.00642589]


portfolio before change:  [1.17312195]
curr_Stock_Price:  98.00652474957278
curr_Factors:  [98.00652475 -0.54187284 -1.14177577]
mat_Sqrt:  [[18.19934221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0061652  0.00122532 0.19090587]
Stock Position:  0.0061651968615276135
Bond Position:  [0.56889243]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.18033111]
Stock Price:  99.1643203358005
PL:  [1.18033111]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.68124261e-01 -3.86624047e-02  2.16669914e-03]
 [-7.88530641e-02  7.28389217e-02 -7.36986785e-02]
 [-1.96205989e-01 -2.02470174e-02 -1.30569003e-01]
 [-2.30438364e-01 -9.17914082e-02 -1.21688979e-01]
 [ 2.48529355e-01 -2.53918137e-01 -1.05518848e-01]
 [-1.29474463e-01 -1.75783695e-01  2.47882962e-02]
 [-5.11173126e-02 -1.98173896e-01 -3.03046609e-02]
 [ 9.10558091e-03  6.02355342e-01  9.02924095e-02]
 [ 3.32568410e-01  1.52729639e-02  3.39881174e-01]
 [ 6.11370985e-01  2.67236016e-01  5.12333849e-01]
 [-2.17330545e-01 -2.66672486e-01 -6.39430671e-03]
 [-5.20631291e-02 -1.94456151e-02  8.29027122e-02]
 [ 1.23904480e-02 -5.61599508e-02  8.55219761e-02]
 [ 4.77199076e-04  1.77183347e-01 -1.09778430e-01]
 [ 3.56180381e-01 -1.64486675e-01 -1.75373507e-01]
 [-2.09517248e-01 -9.60461386e-02  1.18269351e-01]
 [ 5.02941214e-02  1.90185532e-02 -2.10776887e-02]
 [-4.67159791e-02 -5.47122782e-02  4.29745443e-02]
 [ 1.50079369e-01 -1.81309369e-01  1.32658139e-02]
 [ 6.01496982e-02 -5.91800727e-03  3.18114687e-01]
 [-1.85431311e-02  3.59837796e-01 -3.41746165e-01]
 [ 2.24114496e-01  1.42678670e-01  8.58824622e-02]
 [ 2.48724162e-02  1.71706561e-01 -5.38673395e-02]
 [ 6.00910552e-02 -1.56997357e-01 -2.31189623e-01]
 [ 4.82309342e-02  8.51788671e-03 -1.31281861e-02]
 [-3.90910212e-02  8.37516769e-03  9.50061907e-02]
 [-8.25636870e-03 -3.25702619e-02  1.41493952e-03]
 [-7.01404672e-02  5.50371804e-02 -2.24092050e-01]
 [-2.50844051e-02 -4.09630825e-02  4.64405741e-02]
 [-4.10848200e-02  1.48777930e-02 -5.40675789e-03]
 [ 6.50801218e-03 -4.34512561e-02 -5.41019534e-02]
 [-3.18713580e-03  5.05615455e-03 -4.99155410e-02]
 [-8.13362682e-03  1.92315003e-02  3.11214975e-02]
 [ 3.12998220e-02 -4.38680509e-02  1.22534865e-01]
 [-6.81332131e-02  5.71752230e-03 -2.00973240e-02]
 [ 5.35017588e-02 -4.12218250e-02  8.94836281e-02]
 [-5.12631797e-02  9.82429722e-02  4.14297911e-02]
 [-4.17517133e-02 -1.51532327e-02  2.73002489e-02]
 [ 9.36180313e-02  6.36719930e-03  9.14843570e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.38274626]
curr_Stock_Price:  99.39782484556109
curr_Factors:  [99.39782485 -0.86039443 -0.97134357]
mat_Sqrt:  [[15.9170718   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01009448 -0.01247824  0.00618099]
Stock Position:  0.010094482707705
Bond Position:  [-3.38611588]


portfolio before change:  [-2.36981122]
curr_Stock_Price:  100.72115475534096
curr_Factors:  [100.72115476  -0.78915846  -0.9776903 ]
mat_Sqrt:  [[17.21028366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00459194  0.02350866 -0.21024182]
Stock Position:  -0.00459193832911085
Bond Position:  [-1.90730588]


portfolio before change:  [-2.37614443]
curr_Stock_Price:  102.04843384412194
curr_Factors:  [102.04843384  -0.90080451  -0.97942354]
mat_Sqrt:  [[15.5680306   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0145806  -0.0065347  -0.37247702]
Stock Position:  -0.014580596972534532
Bond Position:  [-0.88821734]


portfolio before change:  [-2.37189507]
curr_Stock_Price:  101.74937931405974
curr_Factors:  [101.74937931  -0.79689171  -0.96928126]
mat_Sqrt:  [[17.3977304   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01575004 -0.02962555 -0.34714479]
Stock Position:  -0.015750035194674356
Bond Position:  [-0.76933876]


portfolio before change:  [-2.39097873]
curr_Stock_Price:  102.9549317524565
curr_Factors:  [102.95493175  -0.91777708  -0.95162467]
mat_Sqrt:  [[15.87728676  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01103209 -0.08195173 -0.3010159 ]
Stock Position:  0.011032085669489058
Bond Position:  [-3.52678636]


portfolio before change:  [-2.39319055]
curr_Stock_Price:  102.79440534216873
curr_Factors:  [102.79440534  -0.99889919  -0.96442513]
mat_Sqrt:  [[14.4314032   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01110746 -0.05673394  0.07071411]
Stock Position:  -0.011107462477121337
Bond Position:  [-1.25140555]


portfolio before change:  [-2.39745216]
curr_Stock_Price:  103.16399201769559
curr_Factors:  [103.16399202  -0.97459637  -0.98060197]
mat_Sqrt:  [[14.60146021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0066949  -0.06396035 -0.08645076]
Stock Position:  -0.006694899095569643
Bond Position:  [-1.70677964]


portfolio before change:  [-2.39368333]
curr_Stock_Price:  102.56918347353184
curr_Factors:  [102.56918347  -0.99873988  -0.96741401]
mat_Sqrt:  [[14.35909634  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01048058 0.19440935 0.25757911]
Stock Position:  0.010480583707374222
Bond Position:  [-3.46866825]


portfolio before change:  [-2.40033649]
curr_Stock_Price:  101.97574878523282
curr_Factors:  [101.97574879  -1.00197232  -0.94554093]
mat_Sqrt:  [[14.54462884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02784973 0.00492933 0.96958639]
Stock Position:  0.027849727189061133
Bond Position:  [-5.24033327]


portfolio before change:  [-2.39008276]
curr_Stock_Price:  102.36745139492685
curr_Factors:  [102.36745139  -0.96379492  -0.93612999]
mat_Sqrt:  [[15.3121081   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05031966 0.08625005 1.46154586]
Stock Position:  0.05031965632267177
Bond Position:  [-7.54117773]


portfolio before change:  [-2.37819069]
curr_Stock_Price:  102.62251619350735
curr_Factors:  [102.62251619  -0.86083464  -0.93024113]
mat_Sqrt:  [[17.11545052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01595459 -0.08606817 -0.01824118]
Stock Position:  -0.015954594395860066
Bond Position:  [-0.74089007]


portfolio before change:  [-2.39030232]
curr_Stock_Price:  103.37584244349719
curr_Factors:  [103.37584244  -1.11635637  -0.94131498]
mat_Sqrt:  [[13.20637864  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296145 -0.00627605  0.23649836]
Stock Position:  -0.0029614479797310197
Bond Position:  [-2.08416014]


portfolio before change:  [-2.38971274]
curr_Stock_Price:  103.08877891721136
curr_Factors:  [103.08877892  -0.68504193  -0.95145422]
mat_Sqrt:  [[20.06735579  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00091611 -0.01812555  0.24397039]
Stock Position:  0.000916112041795594
Bond Position:  [-2.48415361]


portfolio before change:  [-2.38978854]
curr_Stock_Price:  103.34501326509616
curr_Factors:  [103.34501327  -0.95753402  -0.93811784]
mat_Sqrt:  [[15.52452721  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00091701  0.05718568 -0.3131673 ]
Stock Position:  0.0009170115141347614
Bond Position:  [-2.4845571]


portfolio before change:  [-2.39025555]
curr_Stock_Price:  103.17443644610952
curr_Factors:  [103.17443645  -1.09439704  -0.90429315]
mat_Sqrt:  [[13.98144268  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02051338 -0.05308785 -0.5002918 ]
Stock Position:  0.020513384671145937
Bond Position:  [-4.50671245]


portfolio before change:  [-2.38063452]
curr_Stock_Price:  103.67091213954282
curr_Factors:  [103.67091214  -1.22058504  -0.92807021]
mat_Sqrt:  [[12.09226901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01695141 -0.03099876  0.33738954]
Stock Position:  -0.016951405392962044
Bond Position:  [-0.62326686]


portfolio before change:  [-2.37498966]
curr_Stock_Price:  103.33331295758059
curr_Factors:  [103.33331296  -1.29592877  -0.93880546]
mat_Sqrt:  [[11.05878996  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00450988  0.00613821 -0.06012878]
Stock Position:  0.004509878776845442
Bond Position:  [-2.84101037]


portfolio before change:  [-2.37341305]
curr_Stock_Price:  103.76165071667212
curr_Factors:  [103.76165072  -1.52072604  -0.93366028]
mat_Sqrt:  [[ 8.91477603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00550905 -0.01765831  0.12259441]
Stock Position:  -0.005509048553134937
Bond Position:  [-1.80178508]


portfolio before change:  [-2.37420312]
curr_Stock_Price:  103.86417919974836
curr_Factors:  [103.8641792   -1.44676583  -0.94025939]
mat_Sqrt:  [[ 9.54539516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01212916 -0.05851735  0.03784367]
Stock Position:  0.012129159686575179
Bond Position:  [-3.63398834]


portfolio before change:  [-2.37066439]
curr_Stock_Price:  104.19338714100897
curr_Factors:  [104.19338714  -1.49712966  -0.95557606]
mat_Sqrt:  [[ 8.96692619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01381483 -0.00191003  0.90749265]
Stock Position:  0.013814831963853625
Bond Position:  [-3.81007852]


portfolio before change:  [-2.37366523]
curr_Stock_Price:  104.01064472305148
curr_Factors:  [104.01064472  -1.47713375  -0.92829106]
mat_Sqrt:  [[ 9.38458493  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0015824   0.11613715 -0.97490668]
Stock Position:  -0.001582402677924759
Bond Position:  [-2.20907851]


portfolio before change:  [-2.37390481]
curr_Stock_Price:  103.98753377516773
curr_Factors:  [103.98753378  -1.60901337  -0.92525025]
mat_Sqrt:  [[ 8.24830231  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03282728 0.04604934 0.24499876]
Stock Position:  0.03282728153940952
Bond Position:  [-5.78753286]


portfolio before change:  [-2.37164352]
curr_Stock_Price:  104.0784575923486
curr_Factors:  [104.07845759  -1.37565087  -0.94155289]
mat_Sqrt:  [[10.25680355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00477013  0.05541805 -0.15366853]
Stock Position:  0.0047701261275971615
Bond Position:  [-2.86811089]


portfolio before change:  [-2.37468178]
curr_Stock_Price:  103.51668511109652
curr_Factors:  [103.51668511  -1.18211898  -0.9209641 ]
mat_Sqrt:  [[12.6372618   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00151514 -0.05067068 -0.65951964]
Stock Position:  -0.0015151447100919854
Bond Position:  [-2.21783902]


portfolio before change:  [-2.37435253]
curr_Stock_Price:  103.11639600371927
curr_Factors:  [103.116396    -1.12417099  -0.90957664]
mat_Sqrt:  [[13.49218704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00350498  0.00274914 -0.03745106]
Stock Position:  0.003504981116982765
Bond Position:  [-2.73577355]


portfolio before change:  [-2.37913715]
curr_Stock_Price:  101.84887891852559
curr_Factors:  [101.84887892  -0.96555494  -0.92053472]
mat_Sqrt:  [[15.44677863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00116454  0.00270307  0.27102622]
Stock Position:  -0.0011645398847887998
Bond Position:  [-2.26053007]


portfolio before change:  [-2.37756986]
curr_Stock_Price:  100.26037875739198
curr_Factors:  [100.26037876  -1.11887337  -0.88038376]
mat_Sqrt:  [[13.57885036  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00107637 -0.01051201  0.00403643]
Stock Position:  -0.0010763740562519763
Bond Position:  [-2.26965219]


portfolio before change:  [-2.37618105]
curr_Stock_Price:  98.7065244689711
curr_Factors:  [98.70652447 -0.96082691 -0.92338597]
mat_Sqrt:  [[14.99831961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00697736  0.01776317 -0.63927224]
Stock Position:  -0.006977358183258985
Bond Position:  [-1.68747028]


portfolio before change:  [-2.37498879]
curr_Stock_Price:  98.5054154392946
curr_Factors:  [98.50541544 -0.87460527 -0.91624205]
mat_Sqrt:  [[16.43255129  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00145847 -0.01322078  0.13248203]
Stock Position:  -0.0014584659700318926
Bond Position:  [-2.231322]


portfolio before change:  [-2.37557795]
curr_Stock_Price:  98.71812137833601
curr_Factors:  [98.71812138 -0.95611087 -0.90773523]
mat_Sqrt:  [[15.30871748  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00255747  0.00480179 -0.01542398]
Stock Position:  -0.0025574678702261827
Bond Position:  [-2.12310953]


portfolio before change:  [-2.3773005]
curr_Stock_Price:  99.28788438905494
curr_Factors:  [99.28788439 -1.06542088 -0.93062536]
mat_Sqrt:  [[13.49038645  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00099367 -0.01402383 -0.15433781]
Stock Position:  -0.0009936671108722258
Bond Position:  [-2.2786414]


portfolio before change:  [-2.37758043]
curr_Stock_Price:  99.2829340694666
curr_Factors:  [99.28293407 -1.41136202 -0.91630106]
mat_Sqrt:  [[ 9.68240791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00127489  0.00163187 -0.14239514]
Stock Position:  -0.0012748915174790388
Bond Position:  [-2.25100546]


portfolio before change:  [-2.37775564]
curr_Stock_Price:  99.1996428299223
curr_Factors:  [99.19964283 -1.229955   -0.89076581]
mat_Sqrt:  [[11.89851508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00018024 0.00620694 0.08878097]
Stock Position:  0.00018024398976360255
Bond Position:  [-2.39563578]


portfolio before change:  [-2.37816042]
curr_Stock_Price:  98.61537213968167
curr_Factors:  [98.61537214 -0.99211574 -0.89290348]
mat_Sqrt:  [[14.97239134  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.003163   -0.01415835  0.34955786]
Stock Position:  0.0031629962773815985
Bond Position:  [-2.69008048]


portfolio before change:  [-2.37906151]
curr_Stock_Price:  98.43680655394768
curr_Factors:  [98.43680655 -1.09216204 -0.88684725]
mat_Sqrt:  [[13.60456634  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00522387  0.00184532 -0.05733207]
Stock Position:  -0.005223869402377532
Bond Position:  [-1.86484049]


portfolio before change:  [-2.38103877]
curr_Stock_Price:  98.77068695210568
curr_Factors:  [98.77068695 -1.08986312 -0.897044  ]
mat_Sqrt:  [[13.54332421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00467781 -0.01330429  0.25527188]
Stock Position:  0.004677814479935526
Bond Position:  [-2.84306972]


portfolio before change:  [-2.38249067]
curr_Stock_Price:  98.53628401147692
curr_Factors:  [98.53628401 -0.75844544 -0.90009951]
mat_Sqrt:  [[18.76286966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00121264  0.03170778  0.11818766]
Stock Position:  -0.0012126394650971708
Bond Position:  [-2.26300169]


portfolio before change:  [-2.38526442]
curr_Stock_Price:  100.59035715407092
curr_Factors:  [100.59035715  -0.98492491  -0.88513365]
mat_Sqrt:  [[15.50244628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253329 -0.00489068  0.07788001]
Stock Position:  -0.002533291409951575
Bond Position:  [-2.13043973]


portfolio before change:  [-2.38587203]
curr_Stock_Price:  100.72507966414257
curr_Factors:  [100.72507966  -1.00879085  -0.88152033]
mat_Sqrt:  [[15.2119855   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00746726 0.002055   0.26097941]
Stock Position:  0.007467263011955784
Bond Position:  [-3.13801269]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.38126933]
Stock Price:  101.39399604618072
PL:  [-3.77526538]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.02462816e-01 -9.94530474e-02  2.03623814e-02]
 [-8.83608690e-02  7.21411408e-02 -8.60882467e-02]
 [-6.72324575e-04  1.17533295e-02  4.60128871e-02]
 [-6.65290430e-02 -2.24748475e-02 -1.41226476e-03]
 [ 1.00805660e-02  9.77275319e-02 -5.96736497e-02]
 [-5.95809881e-02 -1.43778693e-01  2.00809370e-01]
 [-6.37427000e-02 -1.53208540e-01  2.94357727e-02]
 [-2.18154046e-03  7.88176916e-01  1.25663394e-01]
 [ 1.41352599e-01 -1.36987128e-03  1.24029603e-01]
 [ 3.20450242e-01  1.19052203e-01  1.80005038e-01]
 [-1.24378961e-01 -1.58340893e-01  4.94452355e-02]
 [-3.36635423e-02 -1.78758027e-02  9.28393845e-02]
 [ 4.13219169e-03 -3.79575171e-02  1.34939152e-01]
 [ 9.15494883e-03 -1.08880089e-01  5.26790832e-02]
 [-6.92250461e-02  1.75247868e-01 -3.32450755e-02]
 [ 9.61455194e-02 -5.02215897e-03 -8.74268617e-03]
 [ 5.08805765e-02  2.08135953e-02 -2.40698412e-02]
 [-2.69867186e-02 -5.75827316e-02 -1.78938219e-02]
 [ 2.25168260e-02  8.16676735e-02 -1.77540927e-01]
 [-2.82043262e-02 -1.14195054e-02 -2.92500047e-02]
 [-2.95328364e-02  4.26404109e-01 -3.79797727e-01]
 [ 1.65829945e-01  1.14789709e-01  9.53736907e-02]
 [ 3.75665693e-03 -4.14479543e-02  7.46597736e-02]
 [ 7.95227979e-03  2.47639714e-02 -7.80145661e-02]
 [-3.54510497e-02  3.86125533e-03 -5.87156947e-03]
 [-1.19423790e-01 -7.68565310e-03  2.25636494e-01]
 [-4.08566455e-02 -3.34868787e-02 -7.53329429e-03]
 [-8.88813659e-02  9.53884565e-02 -1.44184846e-01]
 [-2.53130711e-02 -4.09876021e-02  4.62294530e-02]
 [-2.92683904e-02  1.97561028e-02 -1.70128751e-02]
 [ 3.36823087e-02 -4.38986404e-02 -9.01034247e-02]
 [ 1.39314639e-02  7.62923122e-02 -6.99824589e-02]
 [-2.63887192e-02  2.33828429e-02 -4.22591818e-02]
 [ 7.98747670e-03 -7.60981533e-02 -5.35266905e-02]
 [-8.19520453e-03  7.19591199e-02  4.72478603e-02]
 [ 6.74409690e-02  3.10248089e-02  1.69689974e-01]
 [ 2.72230016e-01 -1.80343312e-01  1.51961629e-01]
 [-1.02866728e-01  3.31073814e-02  4.70338201e-02]
 [ 2.64756203e-01 -2.65526872e-02  7.11734759e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.87360743]
curr_Stock_Price:  100.69086843291242
curr_Factors:  [100.69086843  -1.07482619  -1.03123763]
mat_Sqrt:  [[12.25570197  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01783718 -0.03209833  0.05808821]
Stock Position:  -0.017837177421275916
Bond Position:  [9.66964832]


portfolio before change:  [7.8709775]
curr_Stock_Price:  100.9060769989604
curr_Factors:  [100.906077    -0.86129786  -1.02260992]
mat_Sqrt:  [[15.33721727  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00594683  0.02328345 -0.24558581]
Stock Position:  -0.005946829105570074
Bond Position:  [8.4710487]


portfolio before change:  [7.87553222]
curr_Stock_Price:  100.31823939622079
curr_Factors:  [100.3182394   -0.74974752  -1.05185158]
mat_Sqrt:  [[16.5559976   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00067161 0.00379337 0.13126196]
Stock Position:  0.0006716088809865451
Bond Position:  [7.8081576]


portfolio before change:  [7.87711742]
curr_Stock_Price:  101.22519157212271
curr_Factors:  [101.22519157  -0.72634901  -1.07721802]
mat_Sqrt:  [[16.6728329   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00428271 -0.00725373 -0.0040288 ]
Stock Position:  -0.004282714270921474
Bond Position:  [8.31063599]


portfolio before change:  [7.88444238]
curr_Stock_Price:  99.75741425751116
curr_Factors:  [99.75741426 -0.79125561 -1.10226415]
mat_Sqrt:  [[15.01758153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00118849  0.03154143 -0.17023231]
Stock Position:  0.0011884924465938704
Bond Position:  [7.76588145]


portfolio before change:  [7.88402755]
curr_Stock_Price:  98.59154034482162
curr_Factors:  [98.59154034 -0.55935722 -1.10763621]
mat_Sqrt:  [[18.61545271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257526 -0.04640437  0.57285324]
Stock Position:  -0.0025752610271627518
Bond Position:  [8.1379265]


portfolio before change:  [7.88525053]
curr_Stock_Price:  98.51167146986364
curr_Factors:  [98.51167147 -1.0494263  -1.0838405 ]
mat_Sqrt:  [[11.66867891  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00762792 -0.04944784  0.08397207]
Stock Position:  -0.007627916673260126
Bond Position:  [8.63668936]


portfolio before change:  [7.88603968]
curr_Stock_Price:  98.54975689886402
curr_Factors:  [98.5497569  -1.03101932 -1.07715202]
mat_Sqrt:  [[11.96984093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01540165 0.25438301 0.35848269]
Stock Position:  0.01540165261098245
Bond Position:  [6.36821055]


portfolio before change:  [7.89465865]
curr_Stock_Price:  99.05768258781089
curr_Factors:  [99.05768259 -1.04875937 -1.102441  ]
mat_Sqrt:  [[11.52480837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01443759 -0.00044212  0.35382193]
Stock Position:  0.01443758596434141
Bond Position:  [6.46450484]


portfolio before change:  [7.90468996]
curr_Stock_Price:  99.69651531951672
curr_Factors:  [99.69651532 -1.15564706 -1.08748607]
mat_Sqrt:  [[10.58034034  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03605697 0.03842393 0.51350427]
Stock Position:  0.036056973014946564
Bond Position:  [4.3099354]


portfolio before change:  [7.90909804]
curr_Stock_Price:  99.80382600214244
curr_Factors:  [99.803826   -1.12336218 -1.05569076]
mat_Sqrt:  [[11.29266701  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01298251 -0.0511043   0.14105349]
Stock Position:  -0.012982512754870737
Bond Position:  [9.20480248]


portfolio before change:  [7.91616057]
curr_Stock_Price:  99.34845519495656
curr_Factors:  [99.34845519 -0.95409254 -1.04429176]
mat_Sqrt:  [[13.46709259  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136345 -0.00576939  0.26484492]
Stock Position:  -0.0013634468679608299
Bond Position:  [8.05161691]


portfolio before change:  [7.9178401]
curr_Stock_Price:  98.85484316235609
curr_Factors:  [98.85484316 -0.80739262 -1.04965541]
mat_Sqrt:  [[15.4344885   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00155033 -0.01225074  0.38494384]
Stock Position:  0.0015503257473589067
Bond Position:  [7.76458289]


portfolio before change:  [7.91678089]
curr_Stock_Price:  97.5455469977022
curr_Factors:  [97.545547   -0.91869939 -1.05820142]
mat_Sqrt:  [[13.50984398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00017151 -0.0351409   0.15027876]
Stock Position:  -0.00017150704445009356
Bond Position:  [7.93351064]


portfolio before change:  [7.91772185]
curr_Stock_Price:  97.84169599321886
curr_Factors:  [97.84169599 -1.06309972 -1.06851098]
mat_Sqrt:  [[11.60852946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00346632  0.05656101 -0.09483895]
Stock Position:  -0.0034663173896128884
Bond Position:  [8.25687222]


portfolio before change:  [7.91855169]
curr_Stock_Price:  97.9000692610621
curr_Factors:  [97.90006926 -0.8016056  -1.05863179]
mat_Sqrt:  [[15.23674382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0061257  -0.00162089 -0.02494045]
Stock Position:  0.006125703975264142
Bond Position:  [7.31884484]


portfolio before change:  [7.92307642]
curr_Stock_Price:  98.48936024842794
curr_Factors:  [98.48936025 -0.73268461 -1.06187805]
mat_Sqrt:  [[16.36894377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00306775  0.00671756 -0.06866456]
Stock Position:  0.0030677543303413274
Bond Position:  [7.62093526]


portfolio before change:  [7.92146051]
curr_Stock_Price:  97.65207498550974
curr_Factors:  [97.65207499 -0.65126802 -1.06019554]
mat_Sqrt:  [[17.63608964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00240378 -0.01858475 -0.05104609]
Stock Position:  -0.0024037814724513456
Bond Position:  [8.15619476]


portfolio before change:  [7.92261588]
curr_Stock_Price:  97.59558790182594
curr_Factors:  [97.5955879  -1.00306568 -1.09257274]
mat_Sqrt:  [[12.00344719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.45494485e-04  2.63581283e-02 -5.06474846e-01]
Stock Position:  0.0002454944852472092
Bond Position:  [7.8986567]


portfolio before change:  [7.92360544]
curr_Stock_Price:  97.60441359975903
curr_Factors:  [97.6044136  -1.03633762 -1.08832852]
mat_Sqrt:  [[11.66107735  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00313058 -0.00368563 -0.08344212]
Stock Position:  -0.0031305816846935587
Bond Position:  [8.22916403]


portfolio before change:  [7.92254656]
curr_Stock_Price:  98.27125351425362
curr_Factors:  [98.27125351 -0.96590449 -1.09585254]
mat_Sqrt:  [[12.50307387  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00160115  0.13762133 -1.0834572 ]
Stock Position:  -0.0016011541520107924
Bond Position:  [8.07989398]


portfolio before change:  [7.9242529]
curr_Stock_Price:  97.83638186704599
curr_Factors:  [97.83638187 -0.98222699 -1.09572717]
mat_Sqrt:  [[12.2477513   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01704226 0.03704822 0.27207459]
Stock Position:  0.017042260600454044
Bond Position:  [6.25689979]


portfolio before change:  [7.91268717]
curr_Stock_Price:  97.11183607895714
curr_Factors:  [97.11183608 -0.66011177 -1.11180996]
mat_Sqrt:  [[16.50959174  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00063817 -0.01337727  0.21298355]
Stock Position:  0.0006381739371994822
Bond Position:  [7.85071292]


portfolio before change:  [7.91386429]
curr_Stock_Price:  97.41852544226383
curr_Factors:  [97.41852544 -0.71850728 -1.1244097 ]
mat_Sqrt:  [[15.42669441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.89117140e-04  7.99253741e-03 -2.22553842e-01]
Stock Position:  -0.00018911714043812972
Bond Position:  [7.9322878]


portfolio before change:  [7.91486798]
curr_Stock_Price:  97.35456043053962
curr_Factors:  [97.35456043 -0.72041093 -1.12147887]
mat_Sqrt:  [[15.43240895  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00232377  0.00124621 -0.01674995]
Stock Position:  -0.002323772226941544
Bond Position:  [8.14109781]


portfolio before change:  [7.9173274]
curr_Stock_Price:  96.73414017180096
curr_Factors:  [96.73414017 -0.76594946 -1.11860668]
mat_Sqrt:  [[14.69357396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00509983 -0.00248053  0.64367811]
Stock Position:  -0.005099832119028043
Bond Position:  [8.41065527]


portfolio before change:  [7.91808663]
curr_Stock_Price:  96.79142965261963
curr_Factors:  [96.79142965 -0.89073334 -1.12465778]
mat_Sqrt:  [[12.89922632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0038165  -0.01080784 -0.02149039]
Stock Position:  -0.0038164965867705904
Bond Position:  [8.28749079]


portfolio before change:  [7.91737747]
curr_Stock_Price:  97.2486972931419
curr_Factors:  [97.24869729 -0.95288567 -1.13612561]
mat_Sqrt:  [[12.04031151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00820925  0.03078649 -0.41131923]
Stock Position:  -0.008209246671246298
Bond Position:  [8.71571601]


portfolio before change:  [7.9086553]
curr_Stock_Price:  98.44389832479318
curr_Factors:  [98.44389832 -1.03320801 -1.1210298 ]
mat_Sqrt:  [[11.41866179  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00212311 -0.01322869  0.13187976]
Stock Position:  -0.0021231106779456875
Bond Position:  [8.11766259]


portfolio before change:  [7.91005724]
curr_Stock_Price:  98.26154074075757
curr_Factors:  [98.26154074 -0.93215386 -1.12126824]
mat_Sqrt:  [[12.60647543  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227728  0.00637625 -0.048533  ]
Stock Position:  -0.002277276589980903
Bond Position:  [8.13382594]


portfolio before change:  [7.91082245]
curr_Stock_Price:  98.37201324532936
curr_Factors:  [98.37201325 -0.85519138 -1.13730118]
mat_Sqrt:  [[13.41352841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00047186 -0.01416823 -0.25703999]
Stock Position:  0.00047185584175371125
Bond Position:  [7.86440504]


portfolio before change:  [7.91202552]
curr_Stock_Price:  98.83815047698486
curr_Factors:  [98.83815048 -0.88743624 -1.13796385]
mat_Sqrt:  [[13.04080872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00116706  0.02462324 -0.19964048]
Stock Position:  0.0011670639154685212
Bond Position:  [7.79667508]


portfolio before change:  [7.91370592]
curr_Stock_Price:  99.44288084135584
curr_Factors:  [99.44288084 -0.61003751 -1.12220231]
mat_Sqrt:  [[17.59022938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00171924  0.00754678 -0.12055368]
Stock Position:  -0.001719240557856121
Bond Position:  [8.08467215]


portfolio before change:  [7.9098366]
curr_Stock_Price:  102.28132580282335
curr_Factors:  [102.2813258   -0.61028572  -1.11555912]
mat_Sqrt:  [[18.20838628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101448 -0.02456057 -0.15269675]
Stock Position:  -0.0010144821988048638
Bond Position:  [8.01359918]


portfolio before change:  [7.91047428]
curr_Stock_Price:  102.64020501912047
curr_Factors:  [102.64020502  -0.50780838  -1.11066904]
mat_Sqrt:  [[20.34331379  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00079327 0.02322471 0.13478499]
Stock Position:  0.0007932738286818048
Bond Position:  [7.82905249]


portfolio before change:  [7.91140531]
curr_Stock_Price:  102.58011632722872
curr_Factors:  [102.58011633  -0.66185515  -1.12567525]
mat_Sqrt:  [[17.16914223  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00631433 0.01001321 0.48407826]
Stock Position:  0.0063143342374855395
Bond Position:  [7.26368017]


portfolio before change:  [7.92348495]
curr_Stock_Price:  104.34936525383188
curr_Factors:  [104.34936525  -0.79233912  -1.14418423]
mat_Sqrt:  [[15.04764056  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01770621 -0.05820555  0.43350423]
Stock Position:  0.017706206383898096
Bond Position:  [6.07585356]


portfolio before change:  [7.92767833]
curr_Stock_Price:  104.54329981684114
curr_Factors:  [104.54329982  -0.83683273  -1.15952927]
mat_Sqrt:  [[14.19996268  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00609213  0.01068536  0.1341744 ]
Stock Position:  -0.006092126865226766
Bond Position:  [8.56456937]


portfolio before change:  [7.92001734]
curr_Stock_Price:  105.9765643170262
curr_Factors:  [105.97656432  -0.82413719  -1.13919765]
mat_Sqrt:  [[14.87799295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01840735 -0.00856984  0.20303812]
Stock Position:  0.018407347262319955
Bond Position:  [5.96926992]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.92300767]
Stock Price:  106.09847875115476
PL:  [1.82452891]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.55619854e-02  3.71196666e-02 -6.44915176e-03]
 [-1.72228041e-01  6.59861014e-02 -1.95375097e-01]
 [ 1.13533048e-02 -9.74240323e-04  5.45138632e-02]
 [-1.18515533e-01 -4.46098646e-02 -3.95001522e-02]
 [ 1.91458151e-01 -1.98705135e-01 -1.04721853e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.16522030e-02 -1.98940438e-01 -2.81427060e-02]
 [ 9.88742240e-03  6.10596833e-01  9.00175847e-02]
 [ 4.13818407e-01  4.90940807e-02  4.09289414e-01]
 [ 7.55675463e-01  3.41462573e-01  6.79512486e-01]
 [-6.89727891e-02 -2.00011807e-01 -1.45918657e-02]
 [-7.88407802e-02 -1.94388449e-02  8.72389786e-02]
 [ 1.59008340e-02 -8.89980258e-02  1.11558254e-01]
 [-2.40746366e-04  1.99231786e-01 -1.63153603e-01]
 [ 4.20319610e-01 -1.45821512e-01 -2.04140136e-01]
 [-2.01627808e-01 -9.56303114e-02  1.16675271e-01]
 [ 5.15231567e-02  1.68127395e-02 -2.82660280e-02]
 [-5.69645146e-02 -6.07744966e-02  2.83824128e-02]
 [ 6.34692869e-02  4.84983834e-02 -2.65738330e-01]
 [ 1.52288293e-03  9.06261761e-03 -5.06993076e-03]
 [-4.96392767e-02  6.00513727e-01 -5.85199364e-01]
 [ 3.35191631e-01  1.95828704e-01  6.77943336e-02]
 [ 2.68647223e-02  9.43420360e-02 -6.42803664e-03]
 [-5.45248401e-02 -1.30894943e-01 -2.60220936e-02]
 [ 4.35955674e-02  3.23525915e-03 -1.26157994e-02]
 [-2.03281155e-02  1.31731138e-02  6.23470588e-02]
 [ 6.18882378e-02 -3.28952223e-02  2.56623970e-02]
 [ 1.45934953e-01 -6.95755504e-02  8.86006121e-02]
 [-2.32352385e-02 -4.07647982e-02  4.81478596e-02]
 [-9.91974196e-02 -3.40199806e-03  4.64035899e-02]
 [ 8.10660229e-02 -2.79035577e-03  2.52783176e-02]
 [ 2.64150591e-02 -5.71866671e-02 -1.22226323e-01]
 [-4.26426286e-02  1.49779412e-02  5.88727097e-02]
 [ 1.23365454e-02 -6.86187298e-02 -4.94031310e-03]
 [-3.94296814e-02  9.37701170e-02  1.55038513e-02]
 [ 3.80152901e-03 -6.06944536e-02  3.64645671e-02]
 [-3.69312855e-02  1.00443794e-01  6.32515714e-02]
 [ 1.86597209e-02 -6.72017826e-02 -5.80435321e-02]
 [ 9.73316874e-02  4.06649557e-03  6.95002509e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.08189132]
curr_Stock_Price:  99.18360947255519
curr_Factors:  [99.18360947 -1.00032265 -1.01952325]
mat_Sqrt:  [[13.15927564  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146675  0.01198032 -0.01839763]
Stock Position:  -0.001466751914950034
Bond Position:  [-3.93641357]


portfolio before change:  [-4.08339784]
curr_Stock_Price:  99.87523341773561
curr_Factors:  [99.87523342 -0.71849569 -1.02819188]
mat_Sqrt:  [[17.41329802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01140734  0.02129692 -0.55735077]
Stock Position:  -0.011407342771635418
Bond Position:  [-2.94408682]


portfolio before change:  [-4.09040857]
curr_Stock_Price:  100.4575509266873
curr_Factors:  [100.45755093  -0.60120527  -1.04221316]
mat_Sqrt:  [[19.42025956  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00114736 -0.00031443  0.15551288]
Stock Position:  0.0011473602875311044
Bond Position:  [-4.20566958]


portfolio before change:  [-4.08981057]
curr_Stock_Price:  101.43696540331844
curr_Factors:  [101.4369654   -0.69888078  -1.03467403]
mat_Sqrt:  [[17.91937917  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00757194 -0.01439777 -0.11268294]
Stock Position:  -0.007571937464352629
Bond Position:  [-3.32173622]


portfolio before change:  [-4.09434533]
curr_Stock_Price:  101.98101581945593
curr_Factors:  [101.98101582  -0.69551546  -1.02083765]
mat_Sqrt:  [[18.32806637  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00706683 -0.06413181 -0.2987423 ]
Stock Position:  0.007066832568160082
Bond Position:  [-4.8150281]


portfolio before change:  [-4.10028738]
curr_Stock_Price:  101.22535507189428
curr_Factors:  [101.22535507  -0.80571984  -1.0216303 ]
mat_Sqrt:  [[16.28100571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00941614 -0.05534923  0.15513819]
Stock Position:  -0.009416137975416225
Bond Position:  [-3.14713547]


portfolio before change:  [-4.11143855]
curr_Stock_Price:  102.36783565262438
curr_Factors:  [102.36783565  -1.11610309  -0.98560077]
mat_Sqrt:  [[12.5142589   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00783149 -0.06420775 -0.08028331]
Stock Position:  -0.007831494977189478
Bond Position:  [-3.30974536]


portfolio before change:  [-4.10912633]
curr_Stock_Price:  102.01975833619902
curr_Factors:  [102.01975834  -1.07327166  -1.00976357]
mat_Sqrt:  [[12.70672366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01203298 0.19706928 0.25679511]
Stock Position:  0.01203297920596925
Bond Position:  [-5.33672796]


portfolio before change:  [-4.0996157]
curr_Stock_Price:  102.86558009327162
curr_Factors:  [102.86558009  -1.01360858  -1.01230321]
mat_Sqrt:  [[13.56524887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03740333 0.01584505 1.16758877]
Stock Position:  0.03740333487694899
Bond Position:  [-7.94713144]


portfolio before change:  [-4.07138171]
curr_Stock_Price:  103.64699305069145
curr_Factors:  [103.64699305  -0.65326767  -1.02892655]
mat_Sqrt:  [[19.27476276  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05001779 0.11020657 1.93845998]
Stock Position:  0.05001779454863491
Bond Position:  [-9.25557571]


portfolio before change:  [-4.06009723]
curr_Stock_Price:  103.89573439195334
curr_Factors:  [103.89573439  -0.73779247  -1.04726382]
mat_Sqrt:  [[17.43241772  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00646947 -0.06455353 -0.04162653]
Stock Position:  -0.00646947440449025
Bond Position:  [-3.38794644]


portfolio before change:  [-4.05225014]
curr_Stock_Price:  102.6173287613545
curr_Factors:  [102.61732876  -0.5419219   -1.04046791]
mat_Sqrt:  [[21.08616211  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308264 -0.00627386  0.24886852]
Stock Position:  -0.003082644223250561
Bond Position:  [-3.73591742]


portfolio before change:  [-4.05658948]
curr_Stock_Price:  103.87349699403417
curr_Factors:  [103.87349699  -0.74138264  -1.0421773 ]
mat_Sqrt:  [[17.45478531  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011748  -0.02872399  0.31824465]
Stock Position:  0.001174802267365768
Bond Position:  [-4.1786203]


portfolio before change:  [-4.05821803]
curr_Stock_Price:  102.93189758255133
curr_Factors:  [102.93189758  -0.73767678  -1.01650004]
mat_Sqrt:  [[17.81232721  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.99929880e-04  6.43017825e-02 -4.65431817e-01]
Stock Position:  0.0003999298801016607
Bond Position:  [-4.09938357]


portfolio before change:  [-4.05840909]
curr_Stock_Price:  103.7355312498695
curr_Factors:  [103.73553125  -0.89657753  -1.02754817]
mat_Sqrt:  [[15.14573525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02303513 -0.04706369 -0.58235499]
Stock Position:  0.023035130484503633
Bond Position:  [-6.44797059]


portfolio before change:  [-4.06182453]
curr_Stock_Price:  103.62225238196332
curr_Factors:  [103.62225238  -0.61844791  -1.03109605]
mat_Sqrt:  [[19.90972166  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00991134 -0.03086455  0.33284207]
Stock Position:  -0.009911340156340443
Bond Position:  [-3.03478914]


portfolio before change:  [-4.03788822]
curr_Stock_Price:  101.16893313874185
curr_Factors:  [101.16893314  -0.47451657  -1.03467308]
mat_Sqrt:  [[22.36734483  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00219898  0.00542629 -0.08063511]
Stock Position:  0.002198976425431862
Bond Position:  [-4.26035632]


portfolio before change:  [-4.03750748]
curr_Stock_Price:  101.58427036752369
curr_Factors:  [101.58427037  -0.52524659  -1.05131478]
mat_Sqrt:  [[20.9959033   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302804 -0.01961488  0.08096712]
Stock Position:  -0.0030280440970406435
Bond Position:  [-3.72990583]


portfolio before change:  [-4.03333349]
curr_Stock_Price:  100.05184141457062
curr_Factors:  [100.05184141  -0.10313899  -1.08300428]
mat_Sqrt:  [[30.55551503  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.25921983e-04  1.56527859e-02 -7.58077488e-01]
Stock Position:  0.0006259219827578719
Bond Position:  [-4.09595813]


portfolio before change:  [-4.03314899]
curr_Stock_Price:  101.16463738277639
curr_Factors:  [101.16463738  -0.27031823  -1.11196326]
mat_Sqrt:  [[25.39285352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.20686885e-05  2.92494726e-03 -1.44631013e-02]
Stock Position:  9.206868847028663e-05
Bond Position:  [-4.04246308]


portfolio before change:  [-4.03373131]
curr_Stock_Price:  100.32849771748918
curr_Factors:  [100.32849772  -0.25462908  -1.13228427]
mat_Sqrt:  [[25.06660373  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185559  0.19381497 -1.6694109 ]
Stock Position:  -0.0018555862612799352
Bond Position:  [-3.84756313]


portfolio before change:  [-4.03286876]
curr_Stock_Price:  99.6044517518008
curr_Factors:  [99.60445175 -0.25293645 -1.1153233 ]
mat_Sqrt:  [[25.35426881  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01534272 0.06320344 0.19339836]
Stock Position:  0.01534272044858432
Bond Position:  [-5.56107202]


portfolio before change:  [-4.00697623]
curr_Stock_Price:  101.33737174150156
curr_Factors:  [101.33737174  -0.1991358   -1.14190239]
mat_Sqrt:  [[26.50721823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00169049  0.03044876 -0.0183374 ]
Stock Position:  0.0016904864155579803
Bond Position:  [-4.17828568]


portfolio before change:  [-4.00735485]
curr_Stock_Price:  101.42237306730871
curr_Factors:  [101.42237307  -0.48404133  -1.12192755]
mat_Sqrt:  [[20.35496433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0042523  -0.04224616 -0.07423379]
Stock Position:  -0.004252299074743934
Bond Position:  [-3.57607659]


portfolio before change:  [-4.01325683]
curr_Stock_Price:  102.70519499447865
curr_Factors:  [102.70519499  -0.81466176  -1.12816069]
mat_Sqrt:  [[14.71754386  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00283205  0.00104418 -0.03598936]
Stock Position:  0.0028320467764341543
Bond Position:  [-4.30412275]


portfolio before change:  [-4.01425143]
curr_Stock_Price:  102.54398733511356
curr_Factors:  [102.54398734  -0.76545845  -1.13359399]
mat_Sqrt:  [[15.35190265  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00032    0.0042516  0.1778588]
Stock Position:  -0.00032000103954697983
Bond Position:  [-3.98143725]


portfolio before change:  [-4.01468983]
curr_Stock_Price:  102.35864201073541
curr_Factors:  [102.35864201  -0.33253393  -1.12768839]
mat_Sqrt:  [[23.76610546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00254193 -0.01061689  0.07320768]
Stock Position:  0.002541932819511265
Bond Position:  [-4.27487862]


portfolio before change:  [-4.01475708]
curr_Stock_Price:  102.54241529060327
curr_Factors:  [102.54241529  -0.46150312  -1.13964643]
mat_Sqrt:  [[20.67917121  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0072449  -0.02245541  0.25275288]
Stock Position:  0.007244895162673834
Bond Position:  [-4.75766613]


portfolio before change:  [-4.03205725]
curr_Stock_Price:  100.23659629750995
curr_Factors:  [100.2365963   -0.39815959  -1.16442013]
mat_Sqrt:  [[21.0090572   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103423 -0.01315678  0.13735244]
Stock Position:  -0.0010342290569074135
Bond Position:  [-3.92838964]


portfolio before change:  [-4.0333706]
curr_Stock_Price:  101.03165527518479
curr_Factors:  [101.03165528  -0.28549815  -1.16836986]
mat_Sqrt:  [[23.60753343  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00383012 -0.00109799  0.13237653]
Stock Position:  -0.0038301229839605303
Bond Position:  [-3.64640693]


portfolio before change:  [-4.03435727]
curr_Stock_Price:  101.17025152263177
curr_Factors:  [ 1.01170252e+02 -2.46706921e-02 -1.18185829e+00]
mat_Sqrt:  [[30.27359172  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00282941 -0.00090058  0.072112  ]
Stock Position:  0.0028294085370946477
Bond Position:  [-4.32060924]


portfolio before change:  [-4.02840234]
curr_Stock_Price:  103.46579604967434
curr_Factors:  [103.46579605  -0.23176475  -1.19521921]
mat_Sqrt:  [[24.83507892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041101 -0.01845692 -0.34867768]
Stock Position:  -0.0004110099286075587
Bond Position:  [-3.98587687]


portfolio before change:  [-4.02842458]
curr_Stock_Price:  102.30760682733911
curr_Factors:  [102.30760683  -0.12415095  -1.19278963]
mat_Sqrt:  [[27.41371531  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00100563  0.00483411  0.16794745]
Stock Position:  -0.0010056253690164676
Bond Position:  [-3.92554146]


portfolio before change:  [-4.02748792]
curr_Stock_Price:  100.888209839673
curr_Factors:  [100.88820984  -0.20908567  -1.21884311]
mat_Sqrt:  [[24.19350702  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00011072 -0.0221466  -0.01409334]
Stock Position:  -0.00011071695114512164
Bond Position:  [-4.01631789]


portfolio before change:  [-4.02801307]
curr_Stock_Price:  101.09659557236529
curr_Factors:  [101.09659557  -0.13513121  -1.21061467]
mat_Sqrt:  [[26.32003867  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00065062  0.03026418  0.04422817]
Stock Position:  -0.0006506155345670268
Bond Position:  [-3.96223805]


portfolio before change:  [-4.02650681]
curr_Stock_Price:  98.02016884008754
curr_Factors:  [ 9.80201688e+01 -4.70638815e-02 -1.19642678e+00]
mat_Sqrt:  [[28.26664833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.04850219e-05 -1.95890507e-02  1.04023260e-01]
Stock Position:  -4.048502186411065e-05
Bond Position:  [-4.02253846]


portfolio before change:  [-4.02700246]
curr_Stock_Price:  97.84238723131314
curr_Factors:  [97.84238723 -0.13105665 -1.2129343 ]
mat_Sqrt:  [[25.51756259  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.37830914e-04  3.24180951e-02  1.80439127e-01]
Stock Position:  -0.00013783091441836297
Bond Position:  [-4.01351675]


portfolio before change:  [-4.02750326]
curr_Stock_Price:  97.83571512776464
curr_Factors:  [97.83571513  0.26890202 -1.18578383]
mat_Sqrt:  [[39.11116159  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00017657 -0.02168928 -0.16558204]
Stock Position:  -0.0001765703609190055
Bond Position:  [-4.01022837]


portfolio before change:  [-4.02823831]
curr_Stock_Price:  99.1595059428113
curr_Factors:  [99.15950594  0.30915546 -1.20841637]
mat_Sqrt:  [[40.34505407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00278469 0.00131246 0.19826487]
Stock Position:  0.002784689207801436
Bond Position:  [-4.30436672]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.02949448]
Stock Price:  98.90163714110423
PL:  [-4.02949448]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.50644712e-01 -2.94812169e-02  1.17393061e-03]
 [-1.53998003e-01  6.21811758e-02 -7.83638140e-02]
 [-4.63544845e-02  5.02353901e-02  1.39319689e-02]
 [ 1.30631307e-01  3.05975331e-02  1.54317705e-01]
 [ 2.17356977e-03  9.86917214e-02 -5.98342437e-02]
 [-6.24813547e-02 -1.45540921e-01  1.91278987e-01]
 [-6.41020137e-02 -1.40421278e-01  3.38506534e-02]
 [-2.73463949e-03  7.74138884e-01  1.23762080e-01]
 [-4.84615845e-03  2.62602162e-03 -3.95800448e-02]
 [ 2.31922725e-01  8.21250613e-02  1.05228638e-01]
 [-1.63201291e-01 -2.66650019e-01 -1.32495036e-02]
 [-4.72933248e-02 -1.83473660e-02  9.11497656e-02]
 [-9.16529100e-03  3.57714182e-02  6.23287420e-02]
 [ 8.32425101e-03 -9.17220009e-02  5.50903852e-02]
 [ 1.19731905e-02  8.14998419e-03 -7.45201845e-02]
 [ 8.70713199e-02 -7.59561035e-03 -3.92390910e-03]
 [ 5.15957188e-02  1.66825086e-02 -2.86904266e-02]
 [-5.80284962e-02 -6.14038635e-02  2.68674881e-02]
 [ 1.34212649e-01 -1.58775137e-01 -6.64452881e-03]
 [ 3.02734924e-02 -1.00454853e-02  2.07838271e-01]
 [-4.40443262e-02  5.55294499e-01 -5.34315084e-01]
 [ 2.86895010e-01  1.72718934e-01  7.56590980e-02]
 [ 7.19864220e-03 -5.66099440e-02  8.39052558e-02]
 [ 1.20092684e-01 -4.83431179e-03 -2.19083816e-01]
 [-7.41795042e-02  2.21921338e-02 -2.09922975e-03]
 [-1.16579514e-01 -6.65826663e-03  2.27714003e-01]
 [-5.34458678e-02 -3.40301538e-02 -1.23760114e-02]
 [-1.09344863e-01  1.22749110e-01 -1.15613440e-01]
 [ 5.43608599e-02 -3.88550642e-02  1.12887574e-01]
 [-2.21406749e-02  2.61632485e-02 -2.72092119e-02]
 [-6.61330285e-03 -2.76627577e-02 -1.40869104e-02]
 [-2.06061884e-02  9.42219200e-02 -1.32953294e-01]
 [-3.16624425e-02  4.05218550e-02 -1.04405611e-01]
 [ 3.86744271e-02 -3.44822406e-02  1.69538673e-01]
 [-6.43522385e-02  3.12132669e-02 -2.02791934e-02]
 [-4.71997608e-02 -9.92205371e-02 -2.56951989e-02]
 [ 1.27165432e-02  1.02677102e-01  1.25989804e-01]
 [ 6.20258380e-02 -7.31389986e-02 -6.99108519e-02]
 [ 9.91265987e-02  2.95450272e-03  5.88747329e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.66802096]
curr_Stock_Price:  99.36185956602954
curr_Factors:  [99.36185957 -0.97535672 -0.99449359]
mat_Sqrt:  [[13.85876684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01045306 -0.00951502  0.0033489 ]
Stock Position:  0.010453059245255211
Bond Position:  [-3.70665636]


portfolio before change:  [-2.66921421]
curr_Stock_Price:  99.29203430009211
curr_Factors:  [99.2920343  -0.82219322 -0.97141786]
mat_Sqrt:  [[16.51805893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00952299  0.02006889 -0.22355015]
Stock Position:  -0.009522987609987108
Bond Position:  [-1.7236574]


portfolio before change:  [-2.67164816]
curr_Stock_Price:  99.52499473510001
curr_Factors:  [99.52499474 -0.80539347 -0.96819084]
mat_Sqrt:  [[16.89173595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019688   0.0162134   0.03974403]
Stock Position:  -0.001968795703353395
Bond Position:  [-2.47570378]


portfolio before change:  [-2.67335828]
curr_Stock_Price:  100.23641466282794
curr_Factors:  [100.23641466  -0.71050751  -0.96096436]
mat_Sqrt:  [[18.84145837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00893651 0.00987531 0.44022546]
Stock Position:  0.008936514836053063
Bond Position:  [-3.56912249]


portfolio before change:  [-2.67975843]
curr_Stock_Price:  99.5701615068184
curr_Factors:  [99.57016151 -0.83166269 -0.96350883]
mat_Sqrt:  [[16.53850028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00061102  0.03185262 -0.17069044]
Stock Position:  0.0006110178690539154
Bond Position:  [-2.74059758]


portfolio before change:  [-2.68066902]
curr_Stock_Price:  98.64057275867629
curr_Factors:  [98.64057276 -0.79114627 -0.94811964]
mat_Sqrt:  [[17.32614726  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306734 -0.04697313  0.54566571]
Stock Position:  -0.003067335763237298
Bond Position:  [-2.37810527]


portfolio before change:  [-2.68101545]
curr_Stock_Price:  98.65659622739058
curr_Factors:  [98.65659623 -0.70870067 -0.92955946]
mat_Sqrt:  [[19.17073622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00447847 -0.04532077  0.09656649]
Stock Position:  -0.004478474393327465
Bond Position:  [-2.23918441]


portfolio before change:  [-2.67861776]
curr_Stock_Price:  98.05871135007477
curr_Factors:  [98.05871135 -0.98030124 -0.93406839]
mat_Sqrt:  [[14.4572609   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01248844 0.24985225 0.35305876]
Stock Position:  0.012488439439208765
Bond Position:  [-3.90321803]


portfolio before change:  [-2.68425359]
curr_Stock_Price:  97.64649829789829
curr_Factors:  [97.6464983  -1.0019362  -0.93995956]
mat_Sqrt:  [[14.00561104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008846   0.00084754 -0.11291085]
Stock Position:  -0.0008846002362965484
Bond Position:  [-2.59787547]


portfolio before change:  [-2.68518269]
curr_Stock_Price:  98.32968329258927
curr_Factors:  [98.32968329 -1.20651805 -0.93105976]
mat_Sqrt:  [[11.59701968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02329617 0.02650575 0.30018801]
Stock Position:  0.02329616977442672
Bond Position:  [-4.97588768]


portfolio before change:  [-2.68382238]
curr_Stock_Price:  98.41477609001974
curr_Factors:  [98.41477609 -1.07085026 -0.93187285]
mat_Sqrt:  [[13.28277182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01658807 -0.08606092 -0.03779715]
Stock Position:  -0.01658806949615648
Bond Position:  [-1.05131123]


portfolio before change:  [-2.67586657]
curr_Stock_Price:  97.92724323635608
curr_Factors:  [97.92724324 -0.7713513  -0.91894062]
mat_Sqrt:  [[18.06421428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00179541 -0.00592159  0.26002491]
Stock Position:  -0.0017954059168841503
Bond Position:  [-2.50004742]


portfolio before change:  [-2.67743555]
curr_Stock_Price:  98.62705776776487
curr_Factors:  [98.62705777 -0.43923505 -0.91244586]
mat_Sqrt:  [[25.5251625   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00042544 0.01154518 0.17780655]
Stock Position:  0.0004254358944996546
Bond Position:  [-2.71939504]


portfolio before change:  [-2.67774659]
curr_Stock_Price:  98.69498749918405
curr_Factors:  [98.6949875  -0.22530505 -0.90755394]
mat_Sqrt:  [[31.79074376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.66383760e-05 -2.96031485e-02  1.57157535e-01]
Stock Position:  2.66383760073702e-05
Bond Position:  [-2.68037567]


portfolio before change:  [-2.67805088]
curr_Stock_Price:  99.85028295356977
curr_Factors:  [99.85028295 -0.26102848 -0.90948682]
mat_Sqrt:  [[30.97426182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.08347841e-05  2.63039609e-03 -2.12585344e-01]
Stock Position:  -5.0834784058018524e-05
Bond Position:  [-2.67297502]


portfolio before change:  [-2.6783061]
curr_Stock_Price:  98.29773693449471
curr_Factors:  [98.29773693 -0.36512144 -0.90059706]
mat_Sqrt:  [[27.72355765  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00305588 -0.00245147 -0.01119382]
Stock Position:  0.0030558815329905582
Bond Position:  [-2.97869234]


portfolio before change:  [-2.66926738]
curr_Stock_Price:  101.37739956173215
curr_Factors:  [101.37739956  -0.49726824  -0.90382302]
mat_Sqrt:  [[24.97209302  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00196798  0.00538426 -0.0818458 ]
Stock Position:  0.001967981327840431
Bond Position:  [-2.86877621]


portfolio before change:  [-2.66627242]
curr_Stock_Price:  103.08146762879758
curr_Factors:  [103.08146763  -0.40038167  -0.9290098 ]
mat_Sqrt:  [[27.27929947  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00238563 -0.01981801  0.07664547]
Stock Position:  -0.0023856259354589904
Bond Position:  [-2.4203586]


portfolio before change:  [-2.66778943]
curr_Stock_Price:  103.59053239145256
curr_Factors:  [103.59053239  -0.26826336  -0.90277852]
mat_Sqrt:  [[32.11759685  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00312746 -0.05124446 -0.01895499]
Stock Position:  0.0031274600405438477
Bond Position:  [-2.99176468]


portfolio before change:  [-2.66856943]
curr_Stock_Price:  103.4607105522616
curr_Factors:  [103.46071055  -0.20647379  -0.89013522]
mat_Sqrt:  [[34.55605969  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00204444 -0.00324217  0.59290473]
Stock Position:  0.0020444395640434915
Bond Position:  [-2.8800886]


portfolio before change:  [-2.67616232]
curr_Stock_Price:  99.92289361764755
curr_Factors:  [99.92289362 -0.45041692 -0.86107915]
mat_Sqrt:  [[26.92089504  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.47699105e-03  1.79220529e-01 -1.52425221e+00]
Stock Position:  -0.0014769910527903391
Bond Position:  [-2.5285771]


portfolio before change:  [-2.67204836]
curr_Stock_Price:  96.92351552978668
curr_Factors:  [96.92351553 -0.58568652 -0.84293968]
mat_Sqrt:  [[23.22654879  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01453487 0.0557448  0.21583435]
Stock Position:  0.014534874159784066
Bond Position:  [-4.08081946]


portfolio before change:  [-2.6904851]
curr_Stock_Price:  95.69016417065208
curr_Factors:  [95.69016417 -0.78627122 -0.85129277]
mat_Sqrt:  [[18.60725441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00068631 -0.01827078  0.23935834]
Stock Position:  0.0006863062170337461
Bond Position:  [-2.75615785]


portfolio before change:  [-2.69034827]
curr_Stock_Price:  96.39154933189984
curr_Factors:  [96.39154933 -0.96240722 -0.85879836]
mat_Sqrt:  [[15.59909578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00476858 -0.00156027 -0.62498515]
Stock Position:  0.004768583285198728
Bond Position:  [-3.14999941]


portfolio before change:  [-2.69151837]
curr_Stock_Price:  96.22874938581744
curr_Factors:  [96.22874939 -1.04683809 -0.8412544 ]
mat_Sqrt:  [[14.56520806  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00481133  0.00716248 -0.00598852]
Stock Position:  -0.004811332393855231
Bond Position:  [-2.22852987]


portfolio before change:  [-2.69187399]
curr_Stock_Price:  96.24476094601151
curr_Factors:  [96.24476095 -0.90527481 -0.86383269]
mat_Sqrt:  [[16.40829578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00435491 -0.00214895  0.64960467]
Stock Position:  -0.004354913030510118
Bond Position:  [-2.27273643]


portfolio before change:  [-2.68945493]
curr_Stock_Price:  95.62404186598496
curr_Factors:  [95.62404187 -0.74371247 -0.84945276]
mat_Sqrt:  [[19.43856618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00323679 -0.01098318 -0.03530532]
Stock Position:  -0.0032367863989262056
Bond Position:  [-2.37994033]


portfolio before change:  [-2.6938138]
curr_Stock_Price:  96.87879457452719
curr_Factors:  [96.87879457 -0.71932651 -0.87171533]
mat_Sqrt:  [[19.73549561  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00546671  0.0396171  -0.32981296]
Stock Position:  -0.005466713493975139
Bond Position:  [-2.16420519]


portfolio before change:  [-2.69231272]
curr_Stock_Price:  96.5547194559909
curr_Factors:  [96.55471946 -0.66045011 -0.90240227]
mat_Sqrt:  [[20.23183815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00343383 -0.01254042  0.32203683]
Stock Position:  0.003433829505003017
Bond Position:  [-3.02386517]


portfolio before change:  [-2.68851768]
curr_Stock_Price:  97.7699935567061
curr_Factors:  [97.76999356 -0.62621815 -0.9071962 ]
mat_Sqrt:  [[21.09852972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105951  0.00844415 -0.07762031]
Stock Position:  -0.0010595136993669057
Bond Position:  [-2.58492904]


portfolio before change:  [-2.68760452]
curr_Stock_Price:  96.60313972765515
curr_Factors:  [96.60313973 -0.60419748 -0.89252953]
mat_Sqrt:  [[21.6257392   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069988 -0.00892812 -0.04018603]
Stock Position:  -0.000699879805817316
Bond Position:  [-2.61999394]


portfolio before change:  [-2.68724356]
curr_Stock_Price:  95.61942479072509
curr_Factors:  [95.61942479 -0.73148661 -0.87806697]
mat_Sqrt:  [[19.12167306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149109  0.03040999 -0.37927874]
Stock Position:  -0.0014910932151030426
Bond Position:  [-2.54466608]


portfolio before change:  [-2.68880729]
curr_Stock_Price:  96.45480271499237
curr_Factors:  [96.45480271 -0.8724305  -0.88041903]
mat_Sqrt:  [[16.71363747  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267462  0.01307837 -0.29784015]
Stock Position:  -0.0026746218295152957
Bond Position:  [-2.43082717]


portfolio before change:  [-2.69184986]
curr_Stock_Price:  97.47875977777245
curr_Factors:  [97.47875978 -0.7610753  -0.89923676]
mat_Sqrt:  [[18.52872899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00357513 -0.0111291   0.48364664]
Stock Position:  0.003575134914831778
Bond Position:  [-3.04034958]


portfolio before change:  [-2.6900693]
curr_Stock_Price:  98.08310741128678
curr_Factors:  [98.08310741 -0.67837152 -0.9243675 ]
mat_Sqrt:  [[19.7484722   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00314558  0.01007404 -0.05785089]
Stock Position:  -0.0031455765019900205
Bond Position:  [-2.38154139]


portfolio before change:  [-2.68777277]
curr_Stock_Price:  97.25837971890165
curr_Factors:  [97.25837972 -0.53600231 -0.92881871]
mat_Sqrt:  [[22.47829388  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00323415 -0.03202329 -0.07330125]
Stock Position:  -0.0032341457484749555
Bond Position:  [-2.37322499]


portfolio before change:  [-2.68702222]
curr_Stock_Price:  96.93457655667301
curr_Factors:  [96.93457656 -0.64104076 -0.94309523]
mat_Sqrt:  [[19.88369991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00298702 0.03313889 0.35941384]
Stock Position:  0.0029870185213801727
Bond Position:  [-2.97656759]


portfolio before change:  [-2.68453892]
curr_Stock_Price:  97.89050856151009
curr_Factors:  [97.89050856 -0.49200367 -0.96553894]
mat_Sqrt:  [[22.78966141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144039 -0.02360551 -0.1994362 ]
Stock Position:  0.0014403860128434393
Bond Position:  [-2.82553904]


portfolio before change:  [-2.68855023]
curr_Stock_Price:  95.35084420802859
curr_Factors:  [95.35084421 -0.56947978 -0.95929789]
mat_Sqrt:  [[20.67211145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00540571 0.00095356 0.16795323]
Stock Position:  0.005405709949737971
Bond Position:  [-3.20398924]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.69221852]
Stock Price:  94.74634208007564
PL:  [-2.69221852]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-3.17716256e-01 -1.04982735e-01  2.77461241e-02]
 [-5.59076580e-02  5.65471979e-02  2.80576103e-02]
 [-7.26348382e-02 -2.88127822e-02 -2.45337231e-02]
 [-1.13214081e-01 -8.90274891e-02 -6.75780808e-02]
 [ 1.92812020e-01 -2.00014923e-01 -1.04740760e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.08727757e-02 -1.76380465e-01 -3.27361038e-02]
 [ 6.03081894e-03  6.56714969e-01  1.02984502e-01]
 [ 5.86328563e-01  1.20646353e-01  5.49695826e-01]
 [ 8.50374236e-01  3.91679324e-01  7.94082842e-01]
 [-2.42758369e-02 -2.11660381e-01 -4.42937410e-02]
 [-8.99410620e-02 -1.81036624e-02  8.44556098e-02]
 [ 1.48292241e-02 -9.66007263e-02  1.25025032e-01]
 [ 8.56314604e-03  1.89734084e-02 -2.49670244e-01]
 [ 2.21681566e-01 -6.48395069e-02 -1.56388885e-01]
 [-1.67291500e-01 -9.38205542e-02  1.09737540e-01]
 [ 5.87952925e-02 -1.43747959e-02 -1.31702560e-02]
 [-6.52115215e-03 -4.69061849e-02 -1.39597777e-02]
 [ 2.92320109e-01 -3.83322494e-01  1.91756502e-01]
 [ 1.62238945e-02 -1.16629802e-02  1.62059524e-01]
 [-6.82118672e-02  7.36241104e-01 -7.26186360e-01]
 [ 5.67665861e-01  3.07066839e-01  2.99375436e-02]
 [ 3.03312738e-02  8.96522215e-02 -3.49193841e-03]
 [-5.17617207e-02 -3.58491048e-02 -1.81427034e-02]
 [-3.20303654e-02  1.68091759e-02 -5.95352645e-03]
 [-1.35677614e-01 -1.48906303e-02  2.11042416e-01]
 [ 8.33599460e-02 -2.33975899e-02  7.97808106e-02]
 [ 1.69200954e-01 -5.16844617e-02  2.26524836e-01]
 [-3.82449622e-02  7.00220788e-03 -7.34463319e-02]
 [-6.48805909e-02 -1.42659178e-02  3.74705957e-02]
 [ 4.33446270e-02 -2.00617294e-02  6.91442420e-03]
 [ 2.63061564e-02 -4.45557954e-02 -1.02105475e-01]
 [-4.40217258e-02  9.79532778e-03  1.74687578e-01]
 [ 5.72967444e-06 -9.13631918e-02 -1.59204833e-01]
 [ 2.88489654e-02  1.60039736e-01 -1.58036959e-02]
 [ 3.42862849e-03  1.52982908e-02  7.96374431e-02]
 [ 2.10063009e-01 -1.42475926e-01  1.18051643e-01]
 [-8.70026321e-02  2.18292575e-02  4.68417236e-02]
 [ 1.30270713e-01  6.01507158e-04  1.04582053e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.72369053]
curr_Stock_Price:  101.55447515800287
curr_Factors:  [101.55447516  -1.22506536  -0.98830747]
mat_Sqrt:  [[11.10307972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0300351  -0.03388303  0.07915197]
Stock Position:  -0.030035100297668794
Bond Position:  [17.77388938]


portfolio before change:  [14.72776465]
curr_Stock_Price:  101.49280573833163
curr_Factors:  [101.49280574  -1.13486486  -0.98139795]
mat_Sqrt:  [[12.22795966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00315979  0.01825053  0.08004055]
Stock Position:  -0.0031597891160053747
Bond Position:  [15.04846052]


portfolio before change:  [14.72788114]
curr_Stock_Price:  102.05128800912249
curr_Factors:  [102.05128801  -1.17599534  -0.96572836]
mat_Sqrt:  [[11.98614987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00696839 -0.00929929 -0.06998788]
Stock Position:  -0.006968388425001418
Bond Position:  [15.43901416]


portfolio before change:  [14.73650239]
curr_Stock_Price:  101.09105831555483
curr_Factors:  [101.09105832  -1.21368096  -0.9667293 ]
mat_Sqrt:  [[11.42280066  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01270976 -0.0287335  -0.19278145]
Stock Position:  -0.01270976033960621
Bond Position:  [16.02134552]


portfolio before change:  [14.72822085]
curr_Stock_Price:  101.90022642076406
curr_Factors:  [101.90022642  -0.91588796  -0.97229766]
mat_Sqrt:  [[15.42220778  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00846857 -0.06455454 -0.29879623]
Stock Position:  0.0084685687654778
Bond Position:  [13.86527178]


portfolio before change:  [14.73262604]
curr_Stock_Price:  102.2157360302136
curr_Factors:  [102.21573603  -0.69940965  -0.96877281]
mat_Sqrt:  [[19.27681699  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00795278 -0.05534923  0.15513819]
Stock Position:  -0.007952775409902883
Bond Position:  [15.54552483]


portfolio before change:  [14.72289989]
curr_Stock_Price:  103.68308011812147
curr_Factors:  [103.68308012  -0.65820955  -1.00113807]
mat_Sqrt:  [[19.72706055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00474265 -0.05692655 -0.09338699]
Stock Position:  -0.004742648621406636
Bond Position:  [15.21463231]


portfolio before change:  [14.72463953]
curr_Stock_Price:  103.71730271798094
curr_Factors:  [103.71730272  -0.59048501  -1.01891084]
mat_Sqrt:  [[20.74433299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00776616 0.21195384 0.29378612]
Stock Position:  0.007766160731758657
Bond Position:  [13.91915429]


portfolio before change:  [14.72458447]
curr_Stock_Price:  103.48616271746788
curr_Factors:  [103.48616272  -0.53502548  -1.03248487]
mat_Sqrt:  [[21.58346601  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03350535 0.03893844 1.56812919]
Stock Position:  0.033505350191404756
Bond Position:  [11.25724434]


portfolio before change:  [14.76154032]
curr_Stock_Price:  104.54714590238106
curr_Factors:  [104.5471459   -0.52334356  -1.05787271]
mat_Sqrt:  [[21.50793313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05079135 0.12641396 2.26529732]
Stock Position:  0.05079134838957813
Bond Position:  [9.45144981]


portfolio before change:  [14.7797253]
curr_Stock_Price:  104.88191689650392
curr_Factors:  [104.8819169   -0.26910751  -1.06845721]
mat_Sqrt:  [[27.52983714  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277961 -0.06831309 -0.12635771]
Stock Position:  -0.0027796115483417912
Bond Position:  [15.07125629]


portfolio before change:  [14.78497486]
curr_Stock_Price:  103.67112348953094
curr_Factors:  [103.67112349  -0.20192493  -1.07004239]
mat_Sqrt:  [[29.05690909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262922 -0.00584293  0.24092835]
Stock Position:  -0.002629220720738878
Bond Position:  [15.05754912]


portfolio before change:  [14.7849738]
curr_Stock_Price:  104.3874459640409
curr_Factors:  [104.38744596  -0.51924649  -1.07043563]
mat_Sqrt:  [[21.29404157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00096888 -0.03117775  0.35666162]
Stock Position:  0.0009688771960632223
Bond Position:  [14.68383518]


portfolio before change:  [14.78406388]
curr_Stock_Price:  101.55373522084716
curr_Factors:  [101.55373522  -0.26196932  -1.08135419]
mat_Sqrt:  [[26.50317574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014537   0.00612364 -0.71223971]
Stock Position:  -0.0014536993156204225
Bond Position:  [14.93169247]


portfolio before change:  [14.7861788]
curr_Stock_Price:  101.38289893133933
curr_Factors:  [ 1.01382899e+02  3.69155791e-02 -1.06046984e+00]
mat_Sqrt:  [[36.42845367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00484576 -0.02092686 -0.44613396]
Stock Position:  0.004845759056646095
Bond Position:  [14.2949017]


portfolio before change:  [14.80435751]
curr_Stock_Price:  104.7655971668594
curr_Factors:  [104.76559717   0.41747914  -1.05906403]
mat_Sqrt:  [[55.15462264  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297423 -0.03028045  0.31305066]
Stock Position:  -0.0029742286455435377
Bond Position:  [15.11595435]


portfolio before change:  [14.79681142]
curr_Stock_Price:  107.9380866806984
curr_Factors:  [107.93808668   0.38260172  -1.05468296]
mat_Sqrt:  [[55.11801145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00096471 -0.00463945 -0.03757107]
Stock Position:  0.000964706107816233
Bond Position:  [14.69268289]


portfolio before change:  [14.80020652]
curr_Stock_Price:  109.55350762636706
curr_Factors:  [ 1.09553508e+02 -8.26294254e-02 -1.01436762e+00]
mat_Sqrt:  [[36.57686869  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051796 -0.01513891 -0.03982336]
Stock Position:  -0.0005179602690628406
Bond Position:  [14.85695089]


portfolio before change:  [14.80225848]
curr_Stock_Price:  109.17756673145267
curr_Factors:  [ 1.09177567e+02 -6.62058917e-03 -1.02581596e+00]
mat_Sqrt:  [[38.8822973   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00651239 -0.1237168   0.54702793]
Stock Position:  0.006512394638973398
Bond Position:  [14.09125108]


portfolio before change:  [14.76502955]
curr_Stock_Price:  103.19045321186891
curr_Factors:  [103.19045321   0.27613512  -1.01526105]
mat_Sqrt:  [[49.27665396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00095225 -0.00376421  0.46231071]
Stock Position:  0.0009522452670760181
Bond Position:  [14.66676693]


portfolio before change:  [14.7648661]
curr_Stock_Price:  101.09339735872014
curr_Factors:  [101.09339736   0.18353905  -0.97986741]
mat_Sqrt:  [[45.59127966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.45114266e-03  2.37620795e-01 -2.07160755e+00]
Stock Position:  -0.0014511426629667883
Bond Position:  [14.91156704]


portfolio before change:  [14.76664009]
curr_Stock_Price:  101.15546567008016
curr_Factors:  [ 1.01155466e+02 -3.57375290e-02 -9.69267550e-01]
mat_Sqrt:  [[37.02722743  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01718888 0.0991054  0.08540348]
Stock Position:  0.0171888806387924
Bond Position:  [13.02789087]


portfolio before change:  [14.76787681]
curr_Stock_Price:  101.13266782580055
curr_Factors:  [ 1.01132668e+02  7.16665092e-04 -9.94912552e-01]
mat_Sqrt:  [[37.42119709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00128052  0.02893513 -0.00996153]
Stock Position:  0.001280522047672381
Bond Position:  [14.6383742]


portfolio before change:  [14.76581689]
curr_Stock_Price:  98.09497632332874
curr_Factors:  [98.09497632  0.26126079 -0.95788959]
mat_Sqrt:  [[48.87702026  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012845  -0.01157025 -0.05175608]
Stock Position:  -0.0012845044988158867
Bond Position:  [14.89182033]


portfolio before change:  [14.7678125]
curr_Stock_Price:  97.99064468555571
curr_Factors:  [97.99064469  0.20746815 -0.96394565]
mat_Sqrt:  [[45.98864445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0006483   0.00542514 -0.01698375]
Stock Position:  -0.0006483005888464196
Bond Position:  [14.83133989]


portfolio before change:  [14.76953606]
curr_Stock_Price:  98.19190309915898
curr_Factors:  [98.1919031   0.21364976 -0.99199964]
mat_Sqrt:  [[45.08609494  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00212124 -0.00480593  0.60204527]
Stock Position:  -0.0021212371244244874
Bond Position:  [14.97782437]


portfolio before change:  [14.7569682]
curr_Stock_Price:  104.999346335923
curr_Factors:  [ 1.04999346e+02 -3.16654685e-02 -9.78563085e-01]
mat_Sqrt:  [[38.23401527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00248128 -0.00755154  0.22759245]
Stock Position:  0.002481275431481409
Bond Position:  [14.4964359]


portfolio before change:  [14.76234841]
curr_Stock_Price:  106.4373318640731
curr_Factors:  [106.43733186  -0.30334031  -1.00043186]
mat_Sqrt:  [[28.89834167  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00709003 -0.01668109  0.64621231]
Stock Position:  0.007090029534661937
Bond Position:  [14.00770458]


portfolio before change:  [14.75893608]
curr_Stock_Price:  105.7090692350878
curr_Factors:  [105.70906924  -0.30239395  -0.97067705]
mat_Sqrt:  [[29.59542217  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175053  0.00225995 -0.20952194]
Stock Position:  -0.0017505346593657367
Bond Position:  [14.94398347]


portfolio before change:  [14.76419463]
curr_Stock_Price:  103.77226682050826
curr_Factors:  [ 1.03772267e+02  1.21568015e-02 -9.44478027e-01]
mat_Sqrt:  [[40.8488035   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00147236 -0.00460431  0.10689318]
Stock Position:  -0.001472355386043744
Bond Position:  [14.91698429]


portfolio before change:  [14.76717016]
curr_Stock_Price:  103.01783283110728
curr_Factors:  [103.01783283  -0.1367833   -0.93675115]
mat_Sqrt:  [[35.21132108  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115477 -0.0064749   0.01972493]
Stock Position:  0.0011547690712071408
Bond Position:  [14.64820836]


portfolio before change:  [14.76837737]
curr_Stock_Price:  102.47752143362314
curr_Factors:  [102.47752143  -0.22085393  -0.94693484]
mat_Sqrt:  [[31.87604242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.13908435e-04 -1.43803211e-02 -2.91278500e-01]
Stock Position:  -0.00011390843498654248
Bond Position:  [14.78005042]


portfolio before change:  [14.7700041]
curr_Stock_Price:  104.41674133505427
curr_Factors:  [104.41674134  -0.35415999  -0.94954501]
mat_Sqrt:  [[28.35164404  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.24477647e-04  3.16142845e-03  4.98335036e-01]
Stock Position:  -0.0002244776473354743
Bond Position:  [14.79344332]


portfolio before change:  [14.7717771]
curr_Stock_Price:  104.75662995727414
curr_Factors:  [104.75662996  -0.45610513  -0.95584809]
mat_Sqrt:  [[25.52572163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200352 -0.02948734 -0.45416707]
Stock Position:  -0.002003518446199376
Bond Position:  [14.98165894]


portfolio before change:  [14.77328198]
curr_Stock_Price:  104.9402752235821
curr_Factors:  [104.94027522  -0.56748983  -0.97209358]
mat_Sqrt:  [[22.50658586  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00258995  0.0516526  -0.04508355]
Stock Position:  0.0025899540818626905
Bond Position:  [14.50149149]


portfolio before change:  [14.77630428]
curr_Stock_Price:  105.40726981439624
curr_Factors:  [105.40726981  -0.53364813  -0.97835274]
mat_Sqrt:  [[23.23897282  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00098142 0.0049375  0.22718346]
Stock Position:  0.000981424789942422
Bond Position:  [14.67285497]


portfolio before change:  [14.77712036]
curr_Stock_Price:  104.36986341421623
curr_Factors:  [104.36986341  -0.33581348  -0.98518238]
mat_Sqrt:  [[27.8531235   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00736282 -0.04598391  0.33676848]
Stock Position:  0.007362815996307055
Bond Position:  [14.00866426]


portfolio before change:  [14.77249564]
curr_Stock_Price:  103.50390117519612
curr_Factors:  [103.50390118  -0.29908987  -0.98146726]
mat_Sqrt:  [[28.76191652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253756  0.00704536  0.1336264 ]
Stock Position:  -0.002537564796412103
Bond Position:  [15.03514349]


portfolio before change:  [14.77687112]
curr_Stock_Price:  102.52029269728956
curr_Factors:  [102.5202927   -0.61177219  -0.97276978]
mat_Sqrt:  [[21.02093372  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [7.21857643e-03 1.94135600e-04 2.98343487e-01]
Stock Position:  0.0072185764330451995
Bond Position:  [14.03682055]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.78096693]
Stock Price:  102.84460954080407
PL:  [11.93635739]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.76642570e-01 -4.50092109e-02  2.92518548e-03]
 [-1.60007168e-01  7.28981751e-02 -1.43100972e-01]
 [ 1.63240855e-02 -6.23516725e-03  5.80277323e-02]
 [-5.24145180e-01 -2.34022420e-01 -3.30030920e-01]
 [ 2.10132183e-01 -2.16771152e-01 -1.04982635e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.15383020e-02 -2.03848812e-01 -2.82617726e-02]
 [ 1.43731672e-02  6.26232275e-01  8.44666120e-02]
 [ 1.01343748e-01  2.32449594e-02  1.02161788e-01]
 [ 4.04677752e-01  1.58315665e-01  2.64477773e-01]
 [-2.10912719e-01 -2.42866844e-01  1.80671412e-02]
 [ 5.46886179e-02 -1.16012214e-02  1.21542871e-01]
 [ 1.47753647e-02 -5.69440699e-02  6.28683999e-02]
 [ 6.79737138e-04  1.10337483e-01 -1.03615840e-02]
 [ 1.43555007e-01 -1.66430381e-01 -1.16250957e-01]
 [-1.59025184e-01 -7.73319450e-02  1.06063632e-01]
 [ 4.84741113e-02  2.22850203e-02 -1.04328761e-02]
 [-5.26687002e-02 -5.82334345e-02  3.44989051e-02]
 [ 5.39785956e-02 -1.01864279e-02 -1.20312722e-01]
 [ 2.84247953e-02  1.10465573e-03  6.98039949e-02]
 [-2.21906728e-02  3.85485631e-01 -3.48799351e-01]
 [ 1.43335265e-01  1.04026080e-01  9.90367909e-02]
 [-1.83253887e-02  3.10156424e-02  3.02939015e-02]
 [ 5.52455492e-02 -1.43516571e-01 -2.30018281e-01]
 [ 6.14492000e-02  3.02807179e-02 -1.46946551e-02]
 [-2.70630059e-02  1.19153190e-02  6.62402656e-02]
 [ 8.00171873e-02 -3.02840373e-02  2.82620425e-02]
 [ 1.55366288e-01 -6.32667910e-02  1.41862118e-01]
 [-4.39120910e-02 -9.73798796e-03 -4.23937840e-02]
 [-7.50906471e-02 -1.13474809e-02  3.92337286e-02]
 [ 6.25869644e-02 -1.39195691e-02  1.00666683e-02]
 [ 2.66215055e-02 -8.11309386e-02 -1.60369298e-01]
 [-4.32541429e-02  1.26798851e-02  1.10226927e-01]
 [ 4.80678628e-03 -8.21812028e-02 -9.56389566e-02]
 [ 3.35648735e-03  5.13035319e-02  3.68208897e-02]
 [ 4.76794018e-02  3.28538331e-02  1.47349403e-01]
 [ 1.77011024e-01 -1.26822331e-01  9.17720742e-02]
 [-9.31480377e-02  2.80775163e-02  4.83236352e-02]
 [ 2.14994500e-01 -1.63369112e-02  8.58208343e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.28066093]
curr_Stock_Price:  99.4106949926987
curr_Factors:  [99.41069499 -0.94106923 -0.98180875]
mat_Sqrt:  [[14.53241567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01156396 -0.01452666  0.00834474]
Stock Position:  0.011563955258800118
Bond Position:  [-3.43024175]


portfolio before change:  [-2.2792163]
curr_Stock_Price:  99.5727012058662
curr_Factors:  [99.57270121 -0.78183422 -0.98918905]
mat_Sqrt:  [[16.94316949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01028953  0.02352778 -0.40822724]
Stock Position:  -0.010289530180136298
Bond Position:  [-1.25465999]


portfolio before change:  [-2.29353545]
curr_Stock_Price:  100.94908176828477
curr_Factors:  [100.94908177  -0.86041747  -1.00743312]
mat_Sqrt:  [[15.59211993  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00172499 -0.00201239  0.16553697]
Stock Position:  0.0017249866361524506
Bond Position:  [-2.46767127]


portfolio before change:  [-2.29147728]
curr_Stock_Price:  102.32106413738437
curr_Factors:  [102.32106414  -1.10384848  -1.02582944]
mat_Sqrt:  [[12.16347533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05255752 -0.07553041 -0.94148635]
Stock Position:  -0.0525575190298007
Bond Position:  [3.086264]


portfolio before change:  [-2.2854837]
curr_Stock_Price:  102.21436637472955
curr_Factors:  [102.21436637  -0.92726291  -0.98694234]
mat_Sqrt:  [[15.07242612  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00958402 -0.06996259 -0.29948624]
Stock Position:  0.00958402217511286
Bond Position:  [-3.26510846]


portfolio before change:  [-2.29224452]
curr_Stock_Price:  101.55152870224072
curr_Factors:  [101.5515287   -0.67655176  -0.99125973]
mat_Sqrt:  [[19.15866033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00800182 -0.05534923  0.15513819]
Stock Position:  -0.008001822336760406
Bond Position:  [-1.47964723]


portfolio before change:  [-2.29988946]
curr_Stock_Price:  102.48381296001902
curr_Factors:  [102.48381296  -1.08896805  -0.99836417]
mat_Sqrt:  [[12.70979106  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00778279 -0.06579192 -0.08062297]
Stock Position:  -0.007782793301144262
Bond Position:  [-1.50227912]


portfolio before change:  [-2.28902162]
curr_Stock_Price:  101.06328977113274
curr_Factors:  [101.06328977  -1.0735091   -1.00086452]
mat_Sqrt:  [[12.69709629  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01255751 0.2021156  0.24095973]
Stock Position:  0.012557514442173193
Bond Position:  [-3.55812534]


portfolio before change:  [-2.29968322]
curr_Stock_Price:  100.24968803216564
curr_Factors:  [100.24968803  -1.40658832  -0.99504663]
mat_Sqrt:  [[ 9.07958969  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01398106 0.00750228 0.29143914]
Stock Position:  0.013981060574236504
Bond Position:  [-3.70128019]


portfolio before change:  [-2.2952773]
curr_Stock_Price:  100.59791727372321
curr_Factors:  [100.59791727  -1.24130476  -0.96547079]
mat_Sqrt:  [[11.07129813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04434711 0.05109616 0.75448147]
Stock Position:  0.04434711224647189
Bond Position:  [-6.75650443]


portfolio before change:  [-2.31119919]
curr_Stock_Price:  100.25793408689607
curr_Factors:  [100.25793409  -1.19966876  -0.94783149]
mat_Sqrt:  [[11.7076908   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02193428 -0.07838494  0.05154052]
Stock Position:  -0.02193427985049642
Bond Position:  [-0.1121136]


portfolio before change:  [-2.32159448]
curr_Stock_Price:  100.73122432744083
curr_Factors:  [100.73122433  -1.39656566  -0.94035701]
mat_Sqrt:  [[ 9.73310692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00792454 -0.00374428  0.34672798]
Stock Position:  0.007924536719693264
Bond Position:  [-3.11984277]


portfolio before change:  [-2.31624493]
curr_Stock_Price:  101.45550111662402
curr_Factors:  [101.45550112  -1.26297765  -0.93069495]
mat_Sqrt:  [[11.31294541  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00141295 -0.01837862  0.17934605]
Stock Position:  0.001412953296282449
Bond Position:  [-2.45959681]


portfolio before change:  [-2.31562664]
curr_Stock_Price:  102.11069234810466
curr_Factors:  [102.11069235  -1.21763476  -0.912156  ]
mat_Sqrt:  [[12.13709772  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00173742  0.03561127 -0.02955872]
Stock Position:  0.0017374196487894378
Bond Position:  [-2.49303577]


portfolio before change:  [-2.31681814]
curr_Stock_Price:  101.60428210854278
curr_Factors:  [101.60428211  -1.1241027   -0.88411533]
mat_Sqrt:  [[13.63810415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00629508 -0.05371517 -0.33163162]
Stock Position:  0.0062950773216188805
Bond Position:  [-2.95642495]


portfolio before change:  [-2.3154595]
curr_Stock_Price:  101.87881686379481
curr_Factors:  [101.87881686  -1.02999425  -0.90022941]
mat_Sqrt:  [[14.78421978  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01035972 -0.02495878  0.30257002]
Stock Position:  -0.010359718377376205
Bond Position:  [-1.26002365]


portfolio before change:  [-2.30125801]
curr_Stock_Price:  100.49277551074202
curr_Factors:  [100.49277551  -0.98786927  -0.92610659]
mat_Sqrt:  [[14.82196175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00343365  0.00719246 -0.02976209]
Stock Position:  0.0034336494003982835
Bond Position:  [-2.64631497]


portfolio before change:  [-2.30116551]
curr_Stock_Price:  100.61606064088838
curr_Factors:  [100.61606064  -0.94590596  -0.94783691]
mat_Sqrt:  [[15.14346403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00379791 -0.01879476  0.09841577]
Stock Position:  -0.0037979084974240945
Bond Position:  [-1.91903491]


portfolio before change:  [-2.29778406]
curr_Stock_Price:  99.66255168552237
curr_Factors:  [99.66255169 -1.24608207 -0.93538084]
mat_Sqrt:  [[11.24953823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00243037 -0.00328766 -0.34321871]
Stock Position:  0.002430372480472007
Bond Position:  [-2.54000118]


portfolio before change:  [-2.29843932]
curr_Stock_Price:  99.52358447579832
curr_Factors:  [99.52358448 -1.32864544 -0.91582455]
mat_Sqrt:  [[10.54787744  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00406707 0.00035653 0.19913137]
Stock Position:  0.004067070678659617
Bond Position:  [-2.70320877]


portfolio before change:  [-2.29738014]
curr_Stock_Price:  99.86710071528053
curr_Factors:  [99.86710072 -1.35584854 -0.90747044]
mat_Sqrt:  [[10.38665     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00141548  0.12441495 -0.99502746]
Stock Position:  -0.0014154821141742515
Bond Position:  [-2.15602004]


portfolio before change:  [-2.29886273]
curr_Stock_Price:  100.72410450951548
curr_Factors:  [100.72410451  -1.4257053   -0.93441736]
mat_Sqrt:  [[ 9.50922597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01943221 0.03357427 0.2825244 ]
Stock Position:  0.019432212478757992
Bond Position:  [-4.25615493]


portfolio before change:  [-2.29348827]
curr_Stock_Price:  101.02805952542096
curr_Factors:  [101.02805953  -1.36101992  -0.91977299]
mat_Sqrt:  [[10.32538461  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056275  0.01001026  0.08642007]
Stock Position:  -0.0005627519659443259
Bond Position:  [-2.23663453]


portfolio before change:  [-2.29385303]
curr_Stock_Price:  101.17939418089412
curr_Factors:  [101.17939418  -1.14213947  -0.92061627]
mat_Sqrt:  [[12.8602271   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00163309 -0.04631977 -0.65617813]
Stock Position:  -0.0016330919255862126
Bond Position:  [-2.12861778]


portfolio before change:  [-2.29513341]
curr_Stock_Price:  101.80048049022649
curr_Factors:  [101.80048049  -1.08652231  -0.9096222 ]
mat_Sqrt:  [[13.83041729  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00467308  0.00977306 -0.04191976]
Stock Position:  0.004673083274473815
Bond Position:  [-2.77085554]


portfolio before change:  [-2.29122059]
curr_Stock_Price:  102.71191318404136
curr_Factors:  [102.71191318  -1.26505725  -0.92039446]
mat_Sqrt:  [[11.54758588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00096207  0.00384565  0.18896504]
Stock Position:  -0.0009620680965524596
Bond Position:  [-2.19240474]


portfolio before change:  [-2.29196004]
curr_Stock_Price:  103.19564467553995
curr_Factors:  [103.19564468  -0.94730539  -0.91825948]
mat_Sqrt:  [[15.97558754  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00498288 -0.00977413  0.08062374]
Stock Position:  0.004982880854994393
Bond Position:  [-2.80617164]


portfolio before change:  [-2.29086303]
curr_Stock_Price:  103.48620019825628
curr_Factors:  [103.4862002   -0.83722822  -0.93100407]
mat_Sqrt:  [[17.65830089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00970702 -0.02041927  0.40469314]
Stock Position:  0.009707020694372974
Bond Position:  [-3.29540572]


portfolio before change:  [-2.28662411]
curr_Stock_Price:  103.96532430495276
curr_Factors:  [103.9653243   -0.65973549  -0.95318852]
mat_Sqrt:  [[20.72070443  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0026328  -0.00314292 -0.12093767]
Stock Position:  -0.002632798732494831
Bond Position:  [-2.01290434]


portfolio before change:  [-2.28186696]
curr_Stock_Price:  102.06286993555085
curr_Factors:  [102.06286994  -0.54750688  -0.96929562]
mat_Sqrt:  [[22.39385285  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309899 -0.00366238  0.11192291]
Stock Position:  -0.003098992883695506
Bond Position:  [-1.96557486]


portfolio before change:  [-2.29389176]
curr_Stock_Price:  105.86380924962575
curr_Factors:  [105.86380925  -0.46666304  -0.98310895]
mat_Sqrt:  [[24.83816704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00248813 -0.00449252  0.0287174 ]
Stock Position:  0.0024881262068900925
Bond Position:  [-2.55729428]


portfolio before change:  [-2.29487961]
curr_Stock_Price:  105.59526618441248
curr_Factors:  [105.59526618  -0.53114291  -0.99153296]
mat_Sqrt:  [[23.03322331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098443 -0.0261849  -0.45748897]
Stock Position:  -0.0009844268717353478
Bond Position:  [-2.19092879]


portfolio before change:  [-2.29262634]
curr_Stock_Price:  103.0281299156344
curr_Factors:  [103.02812992  -0.43192482  -0.96846076]
mat_Sqrt:  [[25.3966296   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071529  0.00409242  0.31444674]
Stock Position:  -0.0007152876264343399
Bond Position:  [-2.21893159]


portfolio before change:  [-2.29314012]
curr_Stock_Price:  103.35862537347275
curr_Factors:  [103.35862537  -0.59477899  -0.95740802]
mat_Sqrt:  [[21.88973343  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014386  -0.02652387 -0.27283132]
Stock Position:  -0.0014386014278051796
Bond Position:  [-2.14444825]


portfolio before change:  [-2.29317013]
curr_Stock_Price:  103.19314138356742
curr_Factors:  [103.19314138  -0.84936151  -0.96463143]
mat_Sqrt:  [[16.82068621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00126896 0.01655814 0.10503975]
Stock Position:  0.0012689618791862753
Bond Position:  [-2.42411829]


portfolio before change:  [-2.29359638]
curr_Stock_Price:  103.09603473897256
curr_Factors:  [103.09603474  -0.50727733  -0.99597677]
mat_Sqrt:  [[22.92909949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00368367 0.01060353 0.42034683]
Stock Position:  0.0036836698868483
Bond Position:  [-2.67336814]


portfolio before change:  [-2.29118671]
curr_Stock_Price:  103.84090669388104
curr_Factors:  [103.84090669  -0.47582694  -1.01094138]
mat_Sqrt:  [[23.47865398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0072345  -0.04093173  0.26180018]
Stock Position:  0.007234504196870846
Bond Position:  [-3.04242419]


portfolio before change:  [-2.28963011]
curr_Stock_Price:  104.10864126503861
curr_Factors:  [104.10864127  -0.32288678  -0.98699239]
mat_Sqrt:  [[28.09399368  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00276047  0.00906198  0.13785388]
Stock Position:  -0.0027604732479350135
Bond Position:  [-2.00224099]


portfolio before change:  [-2.28983581]
curr_Stock_Price:  104.09248636946361
curr_Factors:  [104.09248637  -0.38803301  -0.99099452]
mat_Sqrt:  [[26.21291597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00874294 -0.00527272  0.24482295]
Stock Position:  0.008742935980858174
Bond Position:  [-3.19990976]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.30237836]
Stock Price:  102.70364767111664
PL:  [-5.00602603]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.66828196e-01 -9.86037788e-02  1.78065196e-02]
 [-1.36333238e-01  6.86204329e-02 -1.48600776e-01]
 [-4.44060632e-02  5.06953390e-02  1.58826128e-02]
 [-4.52194424e-02 -6.97476727e-02  1.38934312e-02]
 [ 1.84737835e-01 -1.92203628e-01 -1.04628004e-01]
 [-1.01451882e-01 -1.58972256e-01  1.21049672e-01]
 [-5.63544492e-02 -1.57637966e-01  4.10411113e-02]
 [ 1.52496493e-02  6.48456469e-01  8.87597567e-02]
 [ 2.23943615e-01 -1.97858244e-02  2.39708037e-01]
 [ 4.46289186e-01  1.83325208e-01  3.24321583e-01]
 [-2.54560343e-01 -2.71818756e-01  1.15449792e-02]
 [ 4.48279446e-02 -1.21885714e-02  1.18962378e-01]
 [ 1.27781659e-02 -5.83687633e-02  8.57398978e-02]
 [ 2.71489255e-03  6.84856620e-02 -3.57309226e-02]
 [ 2.13489429e-01 -1.72027052e-01 -1.37837639e-01]
 [-1.18610643e-01 -6.59036787e-02  9.67372115e-02]
 [ 4.92356447e-02  2.09182565e-02 -1.48869067e-02]
 [-4.69671606e-02 -5.48608572e-02  4.26169056e-02]
 [ 7.71291390e-02 -4.31613135e-02 -8.93450118e-02]
 [ 3.52714754e-02 -1.40914036e-02  1.37268524e-01]
 [-4.25756158e-02  5.52546525e-01 -5.38673633e-01]
 [ 5.46308472e-01  2.96847400e-01  3.34154440e-02]
 [-1.09832268e-02  1.40123205e-01 -4.58301820e-02]
 [-5.57616838e-02 -1.27233669e-01 -2.60829785e-02]
 [ 3.51231972e-02 -7.75425788e-03 -1.16582969e-02]
 [-4.87208427e-02  4.93537333e-03  1.15122636e-01]
 [ 6.53235784e-02 -3.24004165e-02  2.61550162e-02]
 [ 1.57156629e-01 -6.17679243e-02  1.52818302e-01]
 [-4.51897093e-02 -1.50550160e-02 -3.21292265e-02]
 [-6.24787692e-02 -1.39709976e-02  3.88908694e-02]
 [-4.02983905e-02 -5.52660056e-02 -2.93316311e-02]
 [ 2.64135482e-02 -5.70114260e-02 -1.21947165e-01]
 [-3.92917059e-02  8.70201372e-03  1.73359200e-01]
 [ 6.38550757e-03 -7.91619087e-02 -7.47367240e-02]
 [ 2.25877355e-02  1.29893222e-01 -5.48754635e-03]
 [ 6.70932402e-02  3.49571555e-02  1.71159483e-01]
 [-8.22651888e-02  6.41611316e-02 -7.42039528e-02]
 [-4.00128304e-02 -1.90400897e-02  3.07788372e-02]
 [ 9.47814666e-02  5.64642177e-03  8.45970514e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.02566134]
curr_Stock_Price:  100.45789335049271
curr_Factors:  [100.45789335  -1.05643966  -0.97167212]
mat_Sqrt:  [[13.21862589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01386838 -0.03182423  0.05079704]
Stock Position:  -0.013868375523067768
Bond Position:  [7.41884913]


portfolio before change:  [6.03298597]
curr_Stock_Price:  99.99661273024337
curr_Factors:  [99.99661273 -1.00828265 -0.93370832]
mat_Sqrt:  [[14.3413265   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0106447   0.02214715 -0.42391665]
Stock Position:  -0.01064470270209151
Bond Position:  [7.09742018]


portfolio before change:  [6.03382246]
curr_Stock_Price:  100.00137926065877
curr_Factors:  [100.00137926  -1.38501129  -0.9183919 ]
mat_Sqrt:  [[ 9.99196025  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308407  0.01636185  0.04530867]
Stock Position:  -0.0030840690869313406
Bond Position:  [6.34223363]


portfolio before change:  [6.03294882]
curr_Stock_Price:  100.54172840086204
curr_Factors:  [100.5417284   -1.39464355  -0.94509877]
mat_Sqrt:  [[ 9.6874432   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00584475 -0.02251096  0.03963409]
Stock Position:  -0.005844745668525145
Bond Position:  [6.62058965]


portfolio before change:  [6.02779337]
curr_Stock_Price:  101.56539519882001
curr_Factors:  [101.5653952   -1.25406254  -0.9524596 ]
mat_Sqrt:  [[11.18060681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01110381 -0.06203345 -0.29847457]
Stock Position:  0.011103809849475203
Bond Position:  [4.90003054]


portfolio before change:  [6.01452246]
curr_Stock_Price:  100.31506320439834
curr_Factors:  [100.3150632   -1.24560452  -0.90408269]
mat_Sqrt:  [[11.68877127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00934168 -0.05130807  0.34532102]
Stock Position:  -0.009341683109064374
Bond Position:  [6.951634]


portfolio before change:  [6.01452174]
curr_Stock_Price:  100.40816581957161
curr_Factors:  [100.40816582  -1.20012327  -0.89787982]
mat_Sqrt:  [[12.32020312  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00650595 -0.05087743  0.11707887]
Stock Position:  -0.00650595463045536
Bond Position:  [6.66777271]


portfolio before change:  [6.01263423]
curr_Stock_Price:  100.82640327438038
curr_Factors:  [100.82640327  -1.10364261  -0.89553833]
mat_Sqrt:  [[13.65655079  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01213581 0.20928843 0.25320688]
Stock Position:  0.012135808205662782
Bond Position:  [4.78902434]


portfolio before change:  [6.01161975]
curr_Stock_Price:  100.69347937780933
curr_Factors:  [100.69347938  -0.99218788  -0.89023249]
mat_Sqrt:  [[15.32768496  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01753918 -0.00638585  0.68382031]
Stock Position:  0.017539181485114116
Bond Position:  [4.24553854]


portfolio before change:  [6.01870891]
curr_Stock_Price:  101.06740988710898
curr_Factors:  [101.06740989  -1.33903374  -0.8875066 ]
mat_Sqrt:  [[10.90528334  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05042621 0.05916796 0.9251992 ]
Stock Position:  0.0504262141624084
Bond Position:  [0.92226206]


portfolio before change:  [6.02235397]
curr_Stock_Price:  101.13740843388935
curr_Factors:  [101.13740843  -1.33656381  -0.90523311]
mat_Sqrt:  [[10.74760735  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02862856 -0.08772913  0.03293461]
Stock Position:  -0.02862855841157394
Bond Position:  [8.91777217]


portfolio before change:  [6.01875445]
curr_Stock_Price:  101.3020799759772
curr_Factors:  [101.30207998  -1.31208691  -0.90485556]
mat_Sqrt:  [[11.03602005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00603687 -0.00393384  0.33936655]
Stock Position:  0.006036873463901972
Bond Position:  [5.40720661]


portfolio before change:  [6.01879989]
curr_Stock_Price:  101.19763837679191
curr_Factors:  [101.19763838  -1.05859405  -0.91504889]
mat_Sqrt:  [[14.06138627  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00130608 -0.01883844  0.24459206]
Stock Position:  0.0013060785772791164
Bond Position:  [5.88662782]


portfolio before change:  [6.0204158]
curr_Stock_Price:  101.87144109491709
curr_Factors:  [101.87144109  -1.11122596  -0.93034622]
mat_Sqrt:  [[13.22540315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071082  0.02210365 -0.10193038]
Stock Position:  0.0007108233764691906
Bond Position:  [5.9480032]


portfolio before change:  [6.02135294]
curr_Stock_Price:  102.14378934327598
curr_Factors:  [102.14378934  -1.19220084  -0.92993445]
mat_Sqrt:  [[12.23433365  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01228008 -0.05552149 -0.39321242]
Stock Position:  0.012280077339499948
Bond Position:  [4.76701931]


portfolio before change:  [6.01658379]
curr_Stock_Price:  101.70689725425667
curr_Factors:  [101.70689725  -1.12729283  -0.92337664]
mat_Sqrt:  [[13.08446497  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00858398 -0.02127032  0.27596434]
Stock Position:  -0.008583979129757962
Bond Position:  [6.88963367]


portfolio before change:  [6.01862931]
curr_Stock_Price:  101.56893523121236
curr_Factors:  [101.56893523  -1.12428184  -0.92777211]
mat_Sqrt:  [[13.04863831  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00386759  0.00675134 -0.0424682 ]
Stock Position:  0.003867590445864535
Bond Position:  [5.62580227]


portfolio before change:  [6.01825511]
curr_Stock_Price:  101.29034472822892
curr_Factors:  [101.29034473  -1.08508996  -0.90612322]
mat_Sqrt:  [[13.82913943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00357697 -0.01770627  0.12157417]
Stock Position:  -0.0035769721592939204
Bond Position:  [6.38056785]


portfolio before change:  [6.02009229]
curr_Stock_Price:  100.99971855208065
curr_Factors:  [100.99971855  -0.81753874  -0.90361062]
mat_Sqrt:  [[18.06485564  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00277231 -0.01393025 -0.25487645]
Stock Position:  0.0027723110341535888
Bond Position:  [5.74008965]


portfolio before change:  [6.02435955]
curr_Stock_Price:  102.28013199052644
curr_Factors:  [102.28013199  -0.82026436  -0.89097915]
mat_Sqrt:  [[18.47598782  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00326991 -0.00454798  0.39158889]
Stock Position:  0.0032699144597764657
Bond Position:  [5.68991227]


portfolio before change:  [6.0224272]
curr_Stock_Price:  101.47166066504232
curr_Factors:  [101.47166067  -0.56726724  -0.87640983]
mat_Sqrt:  [[23.95321321  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00165923  0.17833362 -1.53668594]
Stock Position:  -0.0016592272307707119
Bond Position:  [6.19079174]


portfolio before change:  [6.01998748]
curr_Stock_Price:  103.40847889567098
curr_Factors:  [103.4084789   -0.49166303  -0.89403396]
mat_Sqrt:  [[25.86756781  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02372558 0.09580709 0.09532496]
Stock Position:  0.023725581664554303
Bond Position:  [3.56656116]


portfolio before change:  [6.0180474]
curr_Stock_Price:  103.30791566574254
curr_Factors:  [103.30791567  -0.4033797   -0.90015264]
mat_Sqrt:  [[28.05541508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00029457  0.04522457 -0.13074075]
Stock Position:  0.00029456901311023675
Bond Position:  [5.98761609]


portfolio before change:  [6.01823586]
curr_Stock_Price:  101.40669745932789
curr_Factors:  [101.40669746  -0.18329475  -0.92957001]
mat_Sqrt:  [[33.32388404  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261246 -0.04106449 -0.07440748]
Stock Position:  -0.0026124599797230806
Bond Position:  [6.2831568]


portfolio before change:  [6.01545956]
curr_Stock_Price:  102.77006584585469
curr_Factors:  [102.77006585  -0.36715697  -0.8843779 ]
mat_Sqrt:  [[29.39895863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00105992 -0.00250268 -0.03325788]
Stock Position:  0.0010599227830189392
Bond Position:  [5.90653123]


portfolio before change:  [6.01621206]
curr_Stock_Price:  102.7834077164848
curr_Factors:  [102.78340772  -0.25876241  -0.88724875]
mat_Sqrt:  [[32.67508209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00074106  0.00159288  0.32841284]
Stock Position:  -0.0007410571771176992
Bond Position:  [6.09238045]


portfolio before change:  [6.01711005]
curr_Stock_Price:  102.5993621723468
curr_Factors:  [102.59936217  -0.48886437  -0.87397638]
mat_Sqrt:  [[26.2585321   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00243916 -0.01045719  0.07461298]
Stock Position:  0.002439159247607154
Bond Position:  [5.76685386]


portfolio before change:  [6.02041559]
curr_Stock_Price:  103.65900702836424
curr_Factors:  [103.65900703  -0.75127007  -0.85488932]
mat_Sqrt:  [[20.79988256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00844919 -0.01993551  0.43594808]
Stock Position:  0.008449192410430784
Bond Position:  [5.1445807]


portfolio before change:  [6.02058228]
curr_Stock_Price:  103.60262019630265
curr_Factors:  [103.6026202   -0.67738914  -0.84732679]
mat_Sqrt:  [[22.55251737  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243082 -0.00485899 -0.09165574]
Stock Position:  -0.0024308218721291676
Bond Position:  [6.2724218]


portfolio before change:  [6.02053378]
curr_Stock_Price:  103.94514035768522
curr_Factors:  [103.94514036  -0.8428546   -0.84883769]
mat_Sqrt:  [[19.14747742  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00299737 -0.00450912  0.11094483]
Stock Position:  -0.0029973672481898943
Bond Position:  [6.33209554]


portfolio before change:  [6.02202682]
curr_Stock_Price:  103.71110944464331
curr_Factors:  [103.71110944  -0.79505017  -0.84733318]
mat_Sqrt:  [[20.06999451  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0028683  -0.01783703 -0.08367498]
Stock Position:  -0.0028683022674175188
Bond Position:  [6.31950163]


portfolio before change:  [6.02118813]
curr_Stock_Price:  104.27892541709755
curr_Factors:  [104.27892542  -0.75903888  -0.83323251]
mat_Sqrt:  [[21.21689709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004768  -0.01840036 -0.34788132]
Stock Position:  -0.0004768002226431357
Bond Position:  [6.07090835]


portfolio before change:  [6.02245821]
curr_Stock_Price:  103.20685281481853
curr_Factors:  [103.20685281  -0.74725125  -0.85409384]
mat_Sqrt:  [[20.80909529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.02292593e-04  2.80856285e-03  4.94545543e-01]
Stock Position:  -0.00010229259341501754
Bond Position:  [6.03301551]


portfolio before change:  [6.02323312]
curr_Stock_Price:  103.0041173185758
curr_Factors:  [103.00411732  -0.71776401  -0.8643504 ]
mat_Sqrt:  [[21.17147063  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0011822  -0.0255494  -0.21320307]
Stock Position:  -0.0011822003174594875
Bond Position:  [6.14500462]


portfolio before change:  [6.02216037]
curr_Stock_Price:  104.56131675798625
curr_Factors:  [104.56131676  -0.64953888  -0.85852563]
mat_Sqrt:  [[23.14338874  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00207325  0.04192286 -0.01565444]
Stock Position:  0.0020732459787017724
Bond Position:  [5.80537904]


portfolio before change:  [6.01708685]
curr_Stock_Price:  101.7641377046225
curr_Factors:  [101.7641377   -0.43922392  -0.85040364]
mat_Sqrt:  [[28.02312897  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00389559 0.01128237 0.48827036]
Stock Position:  0.0038955900689457267
Bond Position:  [5.62065549]


portfolio before change:  [6.01375694]
curr_Stock_Price:  100.72898275469088
curr_Factors:  [100.72898275  -0.31412542  -0.85253433]
mat_Sqrt:  [[31.36754703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268797  0.02070792 -0.21168322]
Stock Position:  -0.0026879746439463083
Bond Position:  [6.28451389]


portfolio before change:  [6.01703484]
curr_Stock_Price:  99.80178466460562
curr_Factors:  [99.80178466 -0.41537652 -0.84383258]
mat_Sqrt:  [[28.33157674  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132773 -0.00614516  0.08780346]
Stock Position:  -0.0013277294416854295
Bond Position:  [6.1495446]


portfolio before change:  [6.01764508]
curr_Stock_Price:  99.92115717345112
curr_Factors:  [99.92115717 -0.39224949 -0.84522268]
mat_Sqrt:  [[28.98879203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00390504 0.00182237 0.24133184]
Stock Position:  0.0039050381378820365
Bond Position:  [5.62744915]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.01386991]
Stock Price:  98.77426833517279
PL:  [6.01386991]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.13058528e-01  7.09765613e-02 -1.02345649e-02]
 [-1.75017488e-01  6.57813830e-02 -1.99010010e-01]
 [-2.37372106e-02  3.61645214e-02  2.97082068e-02]
 [ 8.73963484e-02  8.05403515e-02  7.52494186e-02]
 [-7.49622855e-02  1.91412378e-01 -4.27001368e-02]
 [-6.83364117e-02 -1.49323515e-01  1.70769244e-01]
 [-6.24207702e-02 -1.67053337e-01  5.60323581e-02]
 [ 2.02039019e-02  7.59150676e-01  1.15550654e-01]
 [ 2.81262537e-02  4.58303408e-02  1.32406274e-02]
 [ 2.68726361e-01  9.74768200e-02  1.36315508e-01]
 [-8.50575045e-02 -1.84401981e-01  1.87146327e-02]
 [ 9.01116089e-02 -8.93714546e-03  1.33869658e-01]
 [ 1.26177193e-02 -3.51165997e-02  4.37848161e-02]
 [ 1.26771833e-02 -1.60843076e-01 -1.22127402e-02]
 [ 4.79964947e-02 -6.77018115e-02 -7.78190018e-02]
 [ 4.61821711e-02 -1.92483922e-02  3.83879924e-02]
 [ 4.69599450e-02  2.50025735e-02 -1.57687227e-03]
 [-4.27595645e-02 -5.23719780e-02  4.86077904e-02]
 [ 6.28714932e-02 -2.28531837e-02 -1.08416990e-01]
 [ 1.92843718e-02  8.89119082e-03  3.19999897e-02]
 [-3.29900881e-02  4.77430345e-01 -4.56070792e-01]
 [ 2.36207276e-01  1.48465024e-01  8.39132383e-02]
 [-1.35793664e-02  1.75020952e-02  3.85875376e-02]
 [ 5.91460095e-02 -1.20566230e-01 -2.24536040e-01]
 [ 3.09377603e-02  1.92496251e-02 -1.22926508e-02]
 [-9.14156936e-02 -1.69096572e-02  2.16540618e-01]
 [-2.13871887e-02 -3.26466942e-02 -4.39459632e-05]
 [-7.54364934e-02  6.21526143e-02 -2.16885124e-01]
 [-4.27053778e-02 -4.02681539e-02  2.58605989e-02]
 [-3.27564882e-02  1.23699696e-02 -8.10251885e-03]
 [ 1.17919137e-02 -4.38738630e-02 -6.19115051e-02]
 [-1.91622686e-02 -3.20575930e-02 -4.99819317e-02]
 [ 6.20656956e-02  1.37100337e-02  1.39877043e-01]
 [ 2.50197482e-02 -5.18182363e-02  8.29644296e-02]
 [-5.96406999e-02 -3.80359362e-02  1.60408625e-02]
 [ 8.09376253e-02 -1.52586164e-02  1.43089625e-01]
 [ 5.94332979e-02  1.33388185e-02  4.72217053e-02]
 [-1.37487861e-02 -3.66718769e-02  3.76674378e-03]
 [ 9.34451108e-02  6.47432792e-03  9.25080121e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.36732409]
curr_Stock_Price:  99.021551820708
curr_Factors:  [99.02155182 -0.92277553 -1.00250491]
mat_Sqrt:  [[14.44079353  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0069705   0.02290759 -0.02919636]
Stock Position:  -0.006970504722401088
Bond Position:  [-4.67709389]


portfolio before change:  [-5.37484533]
curr_Stock_Price:  100.01668340153768
curr_Factors:  [100.0166834   -0.97803535  -1.02433852]
mat_Sqrt:  [[13.50369215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01497462  0.02123085 -0.56772017]
Stock Position:  -0.014974620686844207
Bond Position:  [-3.87713343]


portfolio before change:  [-5.37744639]
curr_Stock_Price:  100.15801488342741
curr_Factors:  [100.15801488  -1.10928393  -1.03743899]
mat_Sqrt:  [[11.70511781  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00087919  0.01167205  0.08474924]
Stock Position:  -0.0008791877519078224
Bond Position:  [-5.28938869]


portfolio before change:  [-5.37719599]
curr_Stock_Price:  99.12113423566147
curr_Factors:  [99.12113424 -1.16042106 -1.02468868]
mat_Sqrt:  [[11.14769706  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0106925  0.02599429 0.21466565]
Stock Position:  0.0106925045930545
Bond Position:  [-6.43704917]


portfolio before change:  [-5.38400799]
curr_Stock_Price:  98.5593087576014
curr_Factors:  [98.55930876 -1.39097346 -1.04079077]
mat_Sqrt:  [[ 8.66155488  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00514994  0.06177808 -0.1218116 ]
Stock Position:  -0.005149944432837499
Bond Position:  [-4.87643303]


portfolio before change:  [-5.38720544]
curr_Stock_Price:  99.06180974559172
curr_Factors:  [99.06180975 -1.64617321 -1.06208193]
mat_Sqrt:  [[ 6.60276736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00968667 -0.04819396  0.48715712]
Stock Position:  -0.009686668791301822
Bond Position:  [-4.4276265]


portfolio before change:  [-5.38542814]
curr_Stock_Price:  98.82119190955103
curr_Factors:  [98.82119191 -1.49331643 -1.06252156]
mat_Sqrt:  [[ 7.67120792  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01109119 -0.05391623  0.15984472]
Stock Position:  -0.01109119104089735
Bond Position:  [-4.28938342]


portfolio before change:  [-5.38630411]
curr_Stock_Price:  98.85182528091961
curr_Factors:  [98.85182528 -1.44440451 -1.04224034]
mat_Sqrt:  [[ 8.22334587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02416918 0.24501483 0.32963385]
Stock Position:  0.0241691844753983
Bond Position:  [-7.77547211]


portfolio before change:  [-5.37074581]
curr_Stock_Price:  99.53576616242806
curr_Factors:  [99.53576616 -1.48479434 -1.01573169]
mat_Sqrt:  [[ 8.16609647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00492084 0.01479168 0.03777182]
Stock Position:  0.004920841277855551
Bond Position:  [-5.86054551]


portfolio before change:  [-5.36965473]
curr_Stock_Price:  99.90637115630135
curr_Factors:  [99.90637116 -1.65142495 -1.03211554]
mat_Sqrt:  [[ 6.82568684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04636149 0.03146051 0.3888702 ]
Stock Position:  0.046361491170112984
Bond Position:  [-10.00146308]


portfolio before change:  [-5.37968]
curr_Stock_Price:  99.71709759702999
curr_Factors:  [99.7170976  -1.50536755 -1.02738741]
mat_Sqrt:  [[ 7.92151279  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01500702 -0.05951548  0.05338764]
Stock Position:  -0.015007018992581136
Bond Position:  [-3.88322362]


portfolio before change:  [-5.39011383]
curr_Stock_Price:  100.38001384856747
curr_Factors:  [100.38001385  -1.76954516  -1.03770236]
mat_Sqrt:  [[ 6.06003516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.019078   -0.00288445  0.38189287]
Stock Position:  0.019078000064428335
Bond Position:  [-7.30516374]


portfolio before change:  [-5.39385529]
curr_Stock_Price:  100.23176661633583
curr_Factors:  [100.23176662  -1.56990326  -1.02320457]
mat_Sqrt:  [[ 7.49605845  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00191929 -0.01133383  0.12490589]
Stock Position:  0.0019192902078387095
Bond Position:  [-5.58622914]


portfolio before change:  [-5.39487201]
curr_Stock_Price:  100.06587356146431
curr_Factors:  [100.06587356  -1.56294549  -1.03054131]
mat_Sqrt:  [[ 7.48081624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302744 -0.05191188 -0.03483955]
Stock Position:  -0.003027435323090316
Bond Position:  [-5.09192905]


portfolio before change:  [-5.39600373]
curr_Stock_Price:  100.22944103287112
curr_Factors:  [100.22944103  -1.38854657  -1.02828028]
mat_Sqrt:  [[ 8.94088981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0020459  -0.02185067 -0.22199595]
Stock Position:  0.0020459018562979563
Bond Position:  [-5.60106333]


portfolio before change:  [-5.39589808]
curr_Stock_Price:  100.62331422179398
curr_Factors:  [100.62331422  -1.30138719  -1.02731231]
mat_Sqrt:  [[ 9.80296103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00510958 -0.00621239  0.10951026]
Stock Position:  0.0051095812303151395
Bond Position:  [-5.91004108]


portfolio before change:  [-5.39740339]
curr_Stock_Price:  100.47330088751883
curr_Factors:  [100.47330089  -1.1262577   -1.03070579]
mat_Sqrt:  [[11.62233337  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00445192  0.00806955 -0.00449838]
Stock Position:  0.004451919814261587
Bond Position:  [-5.84470247]


portfolio before change:  [-5.3979172]
curr_Stock_Price:  100.52200339093547
curr_Factors:  [100.52200339  -1.31605813  -1.00663722]
mat_Sqrt:  [[ 9.85206712  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00441815 -0.01690298  0.1386645 ]
Stock Position:  -0.004418151592421252
Bond Position:  [-4.95379575]


portfolio before change:  [-5.39686623]
curr_Stock_Price:  100.14396370976912
curr_Factors:  [100.14396371  -1.29358115  -0.98855759]
mat_Sqrt:  [[10.22126193  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00352951 -0.00737583 -0.30928349]
Stock Position:  0.0035295134325669902
Bond Position:  [-5.7503257]


portfolio before change:  [-5.39661746]
curr_Stock_Price:  100.4181095877299
curr_Factors:  [100.41810959  -1.09879227  -1.00889994]
mat_Sqrt:  [[12.2026161   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00226437 0.00286962 0.09128706]
Stock Position:  0.0022643709229028803
Bond Position:  [-5.62400131]


portfolio before change:  [-5.39633828]
curr_Stock_Price:  100.85188407243427
curr_Factors:  [100.85188407  -0.97004115  -0.99918002]
mat_Sqrt:  [[14.07544477  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00203404  0.15408998 -1.30104302]
Stock Position:  -0.0020340449756007482
Bond Position:  [-5.19120101]


portfolio before change:  [-5.39656154]
curr_Stock_Price:  100.64260547198121
curr_Factors:  [100.64260547  -1.18578329  -0.98833657]
mat_Sqrt:  [[11.44388832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02478539 0.04791688 0.23938111]
Stock Position:  0.02478539481544174
Bond Position:  [-7.89102825]


portfolio before change:  [-5.39877209]
curr_Stock_Price:  100.59321698368382
curr_Factors:  [100.59321698  -1.15029458  -1.0105332 ]
mat_Sqrt:  [[11.59132587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018377  0.00564878  0.1100795 ]
Stock Position:  -0.00018376828580737148
Bond Position:  [-5.38028625]


portfolio before change:  [-5.39935089]
curr_Stock_Price:  100.0828812230371
curr_Factors:  [100.08288122  -1.2188551   -1.0127272 ]
mat_Sqrt:  [[10.74474028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105146 -0.03891258 -0.64053882]
Stock Position:  -0.0010514629637835933
Bond Position:  [-5.29411745]


portfolio before change:  [-5.39904074]
curr_Stock_Price:  99.15849856105014
curr_Factors:  [99.15849856 -1.05053308 -1.02062298]
mat_Sqrt:  [[12.49793584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00258906  0.00621279 -0.03506751]
Stock Position:  0.0025890552791684117
Bond Position:  [-5.65576757]


portfolio before change:  [-5.40149218]
curr_Stock_Price:  98.48472808244857
curr_Factors:  [98.48472808 -1.04291545 -0.99779088]
mat_Sqrt:  [[12.79680037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00395929 -0.00545757  0.61773011]
Stock Position:  -0.003959286138973395
Bond Position:  [-5.01156297]


portfolio before change:  [-5.40227029]
curr_Stock_Price:  98.523022849807
curr_Factors:  [98.52302285 -1.0781665  -0.99793885]
mat_Sqrt:  [[12.3565329   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227087 -0.01053668 -0.00012537]
Stock Position:  -0.002270874674037266
Bond Position:  [-5.17853685]


portfolio before change:  [-5.40310316]
curr_Stock_Price:  98.6047136996344
curr_Factors:  [98.6047137  -1.12318074 -0.98157689]
mat_Sqrt:  [[12.01747009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00890546  0.02005967 -0.61871289]
Stock Position:  -0.008905462955240126
Bond Position:  [-4.52498253]


portfolio before change:  [-5.40537861]
curr_Stock_Price:  98.79670773343717
curr_Factors:  [98.79670773 -1.17675679 -0.9569865 ]
mat_Sqrt:  [[11.69686655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00390244 -0.01299649  0.07377309]
Stock Position:  -0.003902438956022796
Bond Position:  [-5.01983049]


portfolio before change:  [-5.40574187]
curr_Stock_Price:  98.72899041145587
curr_Factors:  [98.72899041 -1.56500616 -0.96090531]
mat_Sqrt:  [[ 7.89687534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00403772  0.00399239 -0.02311423]
Stock Position:  -0.004037723417025711
Bond Position:  [-5.00710151]


portfolio before change:  [-5.40862948]
curr_Stock_Price:  99.28912921413216
curr_Factors:  [99.28912921 -1.56191811 -0.93734072]
mat_Sqrt:  [[ 8.1561909   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00120172 -0.01416023 -0.17661629]
Stock Position:  -0.0012017171061799799
Bond Position:  [-5.28931203]


portfolio before change:  [-5.40929698]
curr_Stock_Price:  99.29437305812931
curr_Factors:  [99.29437306 -1.90177712 -0.93643483]
mat_Sqrt:  [[ 5.81172222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00617864 -0.01034654 -0.14258454]
Stock Position:  -0.006178636050325163
Bond Position:  [-4.79579319]


portfolio before change:  [-5.41058052]
curr_Stock_Price:  99.40508170157652
curr_Factors:  [99.4050817  -1.71477364 -0.94055585]
mat_Sqrt:  [[ 6.98575968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01337242 0.00442489 0.39903027]
Stock Position:  0.013372421977872594
Bond Position:  [-6.73986722]


portfolio before change:  [-5.40667485]
curr_Stock_Price:  99.76015666433588
curr_Factors:  [99.76015666 -1.65539054 -0.92738248]
mat_Sqrt:  [[ 7.53829366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00416241 -0.01672426  0.23667442]
Stock Position:  0.004162405943874146
Bond Position:  [-5.82191712]


portfolio before change:  [-5.40806142]
curr_Stock_Price:  99.60188539339991
curr_Factors:  [99.60188539 -1.58867807 -0.9680567 ]
mat_Sqrt:  [[ 7.72488024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0083018  -0.01227605  0.04576012]
Stock Position:  -0.008301801902188778
Bond Position:  [-4.5811863]


portfolio before change:  [-5.41192803]
curr_Stock_Price:  99.99865798403555
curr_Factors:  [99.99865798 -1.77480346 -0.99212209]
mat_Sqrt:  [[ 6.28541086  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01702848 -0.0049247   0.40819487]
Stock Position:  0.017028484409812177
Bond Position:  [-7.11475362]


portfolio before change:  [-5.41219302]
curr_Stock_Price:  100.03532663189738
curr_Factors:  [100.03532663  -1.83351637  -1.02256133]
mat_Sqrt:  [[ 5.75141369  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01248305 0.00430509 0.13471038]
Stock Position:  0.012483046234535517
Bond Position:  [-6.66093863]


portfolio before change:  [-5.41216499]
curr_Stock_Price:  100.10427635204051
curr_Factors:  [100.10427635  -1.85721982  -0.99836096]
mat_Sqrt:  [[ 5.75823855  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355413 -0.0118358   0.01074547]
Stock Position:  -0.003554128240661424
Bond Position:  [-5.05638155]


portfolio before change:  [-5.41146858]
curr_Stock_Price:  99.7304852543595
curr_Factors:  [99.73048525 -1.54434347 -0.99070626]
mat_Sqrt:  [[ 7.90441664  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01437801 0.00208958 0.26389961]
Stock Position:  0.014378011880130237
Bond Position:  [-6.84539468]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.40887569]
Stock Price:  99.97033844768042
PL:  [-5.40887569]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.21214564e-01 -1.71832769e-02 -9.94659372e-05]
 [-1.87432588e-01  6.48702347e-02 -2.15188059e-01]
 [-3.92949790e-02  5.19018737e-02  2.09995275e-02]
 [ 8.86590670e-02  7.54722526e-02  8.06260971e-02]
 [ 1.08428034e-02  8.88863253e-02 -6.25194455e-02]
 [-9.72225308e-02 -1.57463374e-01  1.28960493e-01]
 [-5.86122911e-02 -1.82870701e-01  9.22124375e-02]
 [ 1.62164111e-02  6.53232185e-01  9.25797365e-02]
 [ 1.48313069e-01  6.08812844e-03  1.53395686e-01]
 [ 3.43435973e-01  1.28640153e-01  1.99420359e-01]
 [-1.48447408e-01 -2.13427483e-01  1.90309529e-02]
 [ 7.39989790e-02 -1.02325068e-02  1.27801636e-01]
 [ 1.43937002e-02 -4.22409677e-02  3.91731091e-02]
 [ 6.22771064e-03 -4.84178975e-02  6.11761025e-02]
 [ 1.07726197e-01 -1.35755707e-01 -1.00992338e-01]
 [ 5.54812335e-02 -1.66035050e-02  3.06595742e-02]
 [ 4.78524169e-02  2.34008076e-02 -6.79673124e-03]
 [-3.33133840e-02 -4.67843689e-02  6.20575080e-02]
 [ 9.10574310e-02 -6.30003223e-02 -7.07135997e-02]
 [ 4.23763081e-02 -1.40905458e-02  1.45061701e-01]
 [-2.31614358e-02  4.03033893e-01 -3.83688349e-01]
 [ 1.65437124e-01  1.14601745e-01  9.54376588e-02]
 [-5.98960586e-04  8.02102658e-02  1.21436650e-03]
 [ 3.07886009e-03 -1.36082349e-01 -1.33861483e-01]
 [ 4.11965113e-02  1.26878143e-02 -1.27895318e-02]
 [-3.90896022e-02  4.58237704e-03  1.13918975e-01]
 [ 5.67782755e-02 -3.32495373e-02  2.26088033e-02]
 [ 1.40157489e-01 -7.13022132e-02  6.19742129e-02]
 [-4.84718040e-02 -2.87140160e-02 -5.76043732e-03]
 [-6.15806562e-02 -1.29073941e-02  3.40823781e-02]
 [-3.86327130e-02 -5.45284671e-02 -2.91280964e-02]
 [ 2.62242330e-02 -3.50540781e-02 -8.69693381e-02]
 [-2.31433002e-02  4.96941221e-03  1.68824085e-01]
 [ 5.22960649e-03 -8.13725619e-02 -9.00408270e-02]
 [ 2.38340481e-02  1.41388408e-01 -3.37346927e-03]
 [ 3.81031382e-02  3.01917738e-02  1.33863874e-01]
 [ 2.09636776e-01 -1.48528287e-01  1.05850046e-01]
 [-9.11574264e-02  2.80733539e-02  4.32143554e-02]
 [ 1.48283532e-01 -2.64155391e-03  1.05457209e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.79796286]
curr_Stock_Price:  99.47154991784491
curr_Factors:  [99.47154992 -0.91486131 -1.02077496]
mat_Sqrt:  [[14.356968    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00819719 -0.00554588 -0.00028375]
Stock Position:  0.008197186114465248
Bond Position:  [-2.61334967]


portfolio before change:  [-1.79395727]
curr_Stock_Price:  100.00005798020811
curr_Factors:  [100.00005798  -1.06877161  -1.03501814]
mat_Sqrt:  [[12.1993298   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01787935  0.02093678 -0.61387164]
Stock Position:  -0.01787934987393656
Bond Position:  [-0.00602125]


portfolio before change:  [-1.78370255]
curr_Stock_Price:  99.42646482955155
curr_Factors:  [99.42646483 -1.19077821 -1.0437224 ]
mat_Sqrt:  [[10.64316301  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00229387  0.01675126  0.05990581]
Stock Position:  -0.0022938709868040395
Bond Position:  [-1.55563107]


portfolio before change:  [-1.78371834]
curr_Stock_Price:  99.34856977999561
curr_Factors:  [99.34856978 -1.13525247 -1.04471159]
mat_Sqrt:  [[11.23091799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01073131 0.02435856 0.23000381]
Stock Position:  0.010731314160062282
Bond Position:  [-2.84985905]


portfolio before change:  [-1.78125186]
curr_Stock_Price:  99.61160631071088
curr_Factors:  [99.61160631 -0.97275345 -1.02407655]
mat_Sqrt:  [[13.52376742  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00119973  0.02868794 -0.17835058]
Stock Position:  0.0011997337507277134
Bond Position:  [-1.90075927]


portfolio before change:  [-1.7810433]
curr_Stock_Price:  99.98349854874435
curr_Factors:  [99.98349855 -1.05512406 -1.03359461]
mat_Sqrt:  [[12.38252853  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00832146 -0.05082109  0.36788839]
Stock Position:  -0.008321455257294549
Bond Position:  [-0.94903509]


portfolio before change:  [-1.78262473]
curr_Stock_Price:  100.15928446151672
curr_Factors:  [100.15928446  -1.00694308  -1.00946303]
mat_Sqrt:  [[13.33451318  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00578333 -0.05902126  0.26305642]
Stock Position:  -0.005783325616976966
Bond Position:  [-1.20337098]


portfolio before change:  [-1.78445635]
curr_Stock_Price:  100.44997976953746
curr_Factors:  [100.44997977  -1.19207927  -0.98413049]
mat_Sqrt:  [[11.39813946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01477913 0.21082978 0.26410422]
Stock Position:  0.014779134157695398
Bond Position:  [-3.26902008]


portfolio before change:  [-1.78623048]
curr_Stock_Price:  100.35758769179549
curr_Factors:  [100.35758769  -1.27640955  -0.99830751]
mat_Sqrt:  [[10.31936916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.017527   0.00196494 0.4375952 ]
Stock Position:  0.017526998365623297
Bond Position:  [-3.54519775]


portfolio before change:  [-1.79388425]
curr_Stock_Price:  99.94618843122882
curr_Factors:  [99.94618843 -1.24956319 -0.99126506]
mat_Sqrt:  [[10.63131267  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03860305 0.04151843 0.56889078]
Stock Position:  0.03860304533150201
Bond Position:  [-5.65211149]


portfolio before change:  [-1.78748275]
curr_Stock_Price:  100.13032047655689
curr_Factors:  [100.13032048  -1.33785759  -0.98315159]
mat_Sqrt:  [[ 9.83024004  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01913773 -0.06888342  0.05429001]
Stock Position:  -0.01913772533719406
Bond Position:  [0.12878382]


portfolio before change:  [-1.79073044]
curr_Stock_Price:  100.3008625703571
curr_Factors:  [100.30086257  -1.52659194  -0.98140216]
mat_Sqrt:  [[ 8.16764157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01199828 -0.00330253  0.36458249]
Stock Position:  0.011998283235104091
Bond Position:  [-2.9941686]


portfolio before change:  [-1.78651007]
curr_Stock_Price:  100.68380563123648
curr_Factors:  [100.68380563  -1.58383569  -1.01235241]
mat_Sqrt:  [[ 7.50670687  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00183402 -0.01363321  0.11174998]
Stock Position:  0.0018340234190075875
Bond Position:  [-1.97116653]


portfolio before change:  [-1.78609563]
curr_Stock_Price:  101.04413340503221
curr_Factors:  [101.04413341  -1.66837607  -0.99200909]
mat_Sqrt:  [[ 7.06513572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00125008 -0.01562681  0.17451839]
Stock Position:  0.0012500776606755013
Bond Position:  [-1.91240865]


portfolio before change:  [-1.78637503]
curr_Stock_Price:  101.01186869723942
curr_Factors:  [101.0118687   -1.72696266  -0.96407789]
mat_Sqrt:  [[ 6.8496494   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00867201 -0.04381497 -0.28810303]
Stock Position:  0.008672006546615107
Bond Position:  [-2.66235062]


portfolio before change:  [-1.7920563]
curr_Stock_Price:  100.3951200584813
curr_Factors:  [100.39512006  -1.2844688   -0.95498597]
mat_Sqrt:  [[10.69374329  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0054565  -0.00535876  0.08746323]
Stock Position:  0.005456500600421921
Bond Position:  [-2.33986233]


portfolio before change:  [-1.78568953]
curr_Stock_Price:  101.6155484717581
curr_Factors:  [101.61554847  -1.27338387  -0.98830979]
mat_Sqrt:  [[10.58568801  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00484066  0.00755258 -0.01938918]
Stock Position:  0.00484065936204874
Bond Position:  [-2.27757579]


portfolio before change:  [-1.78603135]
curr_Stock_Price:  101.6037504685435
curr_Factors:  [101.60375047  -1.38914587  -1.00203266]
mat_Sqrt:  [[ 9.29895395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324722 -0.01509959  0.1770328 ]
Stock Position:  -0.0032472219614865243
Bond Position:  [-1.45610142]


portfolio before change:  [-1.78624787]
curr_Stock_Price:  101.61437311303106
curr_Factors:  [101.61437311  -1.47345793  -1.02162832]
mat_Sqrt:  [[ 8.38210222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00760706 -0.02033327 -0.20172622]
Stock Position:  0.007607064344535648
Bond Position:  [-2.55923495]


portfolio before change:  [-1.78231814]
curr_Stock_Price:  102.1730188107185
curr_Factors:  [102.17301881  -1.32828361  -1.02605551]
mat_Sqrt:  [[ 9.70196575  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00712337 -0.0045477   0.41382065]
Stock Position:  0.007123369106103806
Bond Position:  [-2.51013427]


portfolio before change:  [-1.7795883]
curr_Stock_Price:  102.60029313467658
curr_Factors:  [102.60029313  -1.34787899  -1.00756376]
mat_Sqrt:  [[ 9.73179191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019742   0.13007863 -1.09455606]
Stock Position:  -0.0019742040621091987
Bond Position:  [-1.57703438]


portfolio before change:  [-1.78010604]
curr_Stock_Price:  102.76268880240572
curr_Factors:  [102.7626888   -1.39603502  -1.01141678]
mat_Sqrt:  [[ 9.25321018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02251232 0.03698755 0.27225708]
Stock Position:  0.02251232098805843
Bond Position:  [-4.09353268]


portfolio before change:  [-1.79805481]
curr_Stock_Price:  101.98813324284794
curr_Factors:  [101.98813324  -1.10475291  -1.02757289]
mat_Sqrt:  [[12.09183789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00132501 0.02588775 0.00346425]
Stock Position:  0.0013250072508740655
Bond Position:  [-1.93318982]


portfolio before change:  [-1.79904537]
curr_Stock_Price:  101.4229296717236
curr_Factors:  [101.42292967  -0.86808934  -1.01926642]
mat_Sqrt:  [[15.3627145   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00338633 -0.04392039 -0.38186955]
Stock Position:  -0.003386328232961177
Bond Position:  [-1.45559404]


portfolio before change:  [-1.79726372]
curr_Stock_Price:  100.84306535027207
curr_Factors:  [100.84306535  -0.73368264  -1.01448195]
mat_Sqrt:  [[17.55609031  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00234538  0.00409497 -0.03648497]
Stock Position:  0.0023453825758377373
Bond Position:  [-2.03377929]


portfolio before change:  [-1.79599943]
curr_Stock_Price:  101.49052005817052
curr_Factors:  [101.49052006  -0.8840887   -1.01826053]
mat_Sqrt:  [[15.14417792  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098392  0.00147896  0.32497913]
Stock Position:  -0.0009839170622364967
Bond Position:  [-1.69614118]


portfolio before change:  [-1.7967237]
curr_Stock_Price:  102.0111367311631
curr_Factors:  [102.01113673  -0.96379458  -0.98882761]
mat_Sqrt:  [[14.47553246  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00377231 -0.01073124  0.06449662]
Stock Position:  0.0037723133792485495
Bond Position:  [-2.18154168]


portfolio before change:  [-1.79669191]
curr_Stock_Price:  102.09185790139759
curr_Factors:  [102.0918579   -0.95248631  -0.99016706]
mat_Sqrt:  [[14.6321272   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00944862 -0.02301269  0.17679518]
Stock Position:  0.009448620602353979
Bond Position:  [-2.76131914]


portfolio before change:  [-1.79959318]
curr_Stock_Price:  101.82133306073315
curr_Factors:  [101.82133306  -0.94688366  -1.00882641]
mat_Sqrt:  [[14.40405233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0038537  -0.00926741 -0.01643292]
Stock Position:  -0.0038536983206355416
Bond Position:  [-1.40720448]


portfolio before change:  [-1.80211921]
curr_Stock_Price:  102.43116661857897
curr_Factors:  [102.43116662  -1.0080522   -1.0267362 ]
mat_Sqrt:  [[13.38858693  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00427665 -0.00416584  0.09722754]
Stock Position:  -0.004276652269305296
Bond Position:  [-1.36405673]


portfolio before change:  [-1.80616724]
curr_Stock_Price:  103.33783817075305
curr_Factors:  [103.33783817  -0.93452077  -1.03268901]
mat_Sqrt:  [[14.45143654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00385491 -0.01759899 -0.08309435]
Stock Position:  -0.003854913478742618
Bond Position:  [-1.40780882]


portfolio before change:  [-1.80412835]
curr_Stock_Price:  102.76327709956556
curr_Factors:  [102.7632771   -0.71605677  -1.0241811 ]
mat_Sqrt:  [[18.03276169  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.29953373e-05 -1.13136550e-02 -2.48099314e-01]
Stock Position:  7.299533726016001e-05
Bond Position:  [-1.81162959]


portfolio before change:  [-1.80428387]
curr_Stock_Price:  103.7352117566064
curr_Factors:  [103.73521176  -0.51869733  -1.02811964]
mat_Sqrt:  [[22.08778291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00055832 0.00160387 0.48160812]
Stock Position:  0.0005583244306268205
Bond Position:  [-1.86220177]


portfolio before change:  [-1.8047974]
curr_Stock_Price:  103.23239102288868
curr_Factors:  [103.23239102  -0.71088499  -1.02954207]
mat_Sqrt:  [[18.11165427  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164314 -0.02626288 -0.25686142]
Stock Position:  -0.0016431411820672715
Bond Position:  [-1.635172]


portfolio before change:  [-1.80720618]
curr_Stock_Price:  104.57394960980515
curr_Factors:  [104.57394961  -0.59010045  -1.02104147]
mat_Sqrt:  [[20.87918132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00249082  0.04563291 -0.00962357]
Stock Position:  0.0024908174674804114
Bond Position:  [-2.0676808]


portfolio before change:  [-1.80965911]
curr_Stock_Price:  103.69293198140252
curr_Factors:  [103.69293198  -0.5285152   -1.05011916]
mat_Sqrt:  [[21.38734935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00334735 0.00974435 0.38187637]
Stock Position:  0.0033473459407610444
Bond Position:  [-2.15675522]


portfolio before change:  [-1.80966054]
curr_Stock_Price:  103.77304914249459
curr_Factors:  [103.77304914  -0.81327888  -1.01401553]
mat_Sqrt:  [[16.69170479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01203742 -0.0479373   0.30196072]
Stock Position:  0.012037423336480585
Bond Position:  [-3.05882066]


portfolio before change:  [-1.8039221]
curr_Stock_Price:  104.28153092557952
curr_Factors:  [104.28153093  -0.7567729   -1.00933014]
mat_Sqrt:  [[17.83194001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429599  0.00906064  0.12327853]
Stock Position:  -0.004295992676480639
Bond Position:  [-1.35592941]


portfolio before change:  [-1.79912827]
curr_Stock_Price:  103.1261912724901
curr_Factors:  [103.12619127  -0.70411857  -1.01656595]
mat_Sqrt:  [[18.45377352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00917269 -0.00085256  0.30084006]
Stock Position:  0.009172687091021507
Bond Position:  [-2.74507256]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.78739193]
Stock Price:  104.44308988408346
PL:  [-6.23048182]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 7.91535162e-02 -6.73961729e-02  8.20298355e-03]
 [-2.35640238e-01  5.90596244e-02 -2.73881033e-01]
 [-4.28059124e-02  5.10730744e-02  1.74845890e-02]
 [-1.01193239e-01 -9.02281999e-02 -5.15346000e-02]
 [ 9.76834378e-02 -5.57665596e-02 -8.50590101e-02]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.17515999e-02 -1.94657094e-01 -2.80388012e-02]
 [ 8.75769363e-03  6.63403899e-01  9.97123255e-02]
 [ 5.33983184e-01  9.89439024e-02  5.07333428e-01]
 [ 6.51832830e-01  2.79071201e-01  5.30237275e-01]
 [-1.86629174e-01 -1.96085285e-01  4.01074176e-02]
 [-7.48799685e-02 -1.93018087e-02  8.77299814e-02]
 [ 8.97211078e-03 -5.81723139e-02  1.17521218e-01]
 [ 9.84816947e-03 -5.04034496e-02 -1.40759691e-01]
 [ 1.28379772e-01 -8.09349790e-02 -1.10339912e-01]
 [ 9.83545366e-02 -4.39901799e-03 -8.70047315e-03]
 [ 6.17874654e-02  5.02585995e-02 -1.12972618e-01]
 [-2.84202043e-02 -5.78849358e-02 -1.65960945e-02]
 [ 2.72389921e-02  6.85630349e-02 -2.27439127e-01]
 [ 1.81138407e-02 -1.55689364e-02  9.07181780e-02]
 [-5.03434921e-02  6.03033144e-01 -5.85443520e-01]
 [ 5.82469351e-01  3.14150259e-01  2.75268996e-02]
 [ 1.03260195e-02  2.42785153e-02  3.52641132e-02]
 [-5.20576754e-02 -3.71637870e-02 -1.83216106e-02]
 [-2.75029066e-02  1.83107325e-02 -6.48766190e-03]
 [-1.35326499e-01 -1.09391282e-02  2.14665632e-01]
 [ 2.49554948e-02 -3.32643511e-02  7.63581414e-03]
 [ 9.64220825e-02 -5.91719938e-02 -5.44043429e-02]
 [-4.86847359e-02 -2.58517274e-02 -1.19786191e-02]
 [-8.11847309e-02 -8.77596248e-03  4.05270178e-02]
 [-3.50383130e-02 -5.22398490e-02 -2.52845292e-02]
 [ 2.62175633e-02 -3.42805031e-02 -8.57370412e-02]
 [-1.35495845e-03  8.70158688e-03  1.61158048e-01]
 [ 1.22713796e-02 -6.86261798e-02 -4.54550533e-03]
 [-1.54168889e-02  9.02572208e-03  4.89274211e-02]
 [ 5.66697791e-02  3.31310450e-02  1.58344506e-01]
 [ 3.87875263e-01 -2.41129919e-01  2.05257864e-01]
 [-7.79244347e-02  2.25575411e-02  3.51732649e-02]
 [ 1.63865551e-01 -5.84044796e-03  1.00870642e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.05948002]
curr_Stock_Price:  99.70572228296216
curr_Factors:  [99.70572228 -0.96952839 -1.00144772]
mat_Sqrt:  [[13.89108073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00482833 -0.02175202  0.02340083]
Stock Position:  0.004828332530287082
Bond Position:  [-0.42193237]


portfolio before change:  [0.05701938]
curr_Stock_Price:  99.20702205013848
curr_Factors:  [99.20702205 -1.01073846 -0.99900547]
mat_Sqrt:  [[13.29602171  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02102061  0.01906141 -0.78130635]
Stock Position:  -0.021020609055462144
Bond Position:  [2.14241141]


portfolio before change:  [0.0490075]
curr_Stock_Price:  99.60090685729912
curr_Factors:  [99.60090686 -1.14540897 -1.00819127]
mat_Sqrt:  [[11.5602332   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249231  0.01648376  0.04987867]
Stock Position:  -0.002492305945482948
Bond Position:  [0.29724343]


portfolio before change:  [0.04583212]
curr_Stock_Price:  100.88988875234409
curr_Factors:  [100.88988875  -1.30822913  -1.01691626]
mat_Sqrt:  [[ 9.86392658  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01319256 -0.02912103 -0.14701387]
Stock Position:  -0.013192560649425119
Bond Position:  [1.3768281]


portfolio before change:  [0.04976512]
curr_Stock_Price:  100.60481259720653
curr_Factors:  [100.6048126   -0.97222118  -1.03616762]
mat_Sqrt:  [[13.5016418   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00510586 -0.01799858 -0.24264968]
Stock Position:  0.005105863401513283
Bond Position:  [-0.46390931]


portfolio before change:  [0.05252448]
curr_Stock_Price:  101.15660047189348
curr_Factors:  [101.15660047  -0.88454233  -1.06208143]
mat_Sqrt:  [[14.44063436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01061617 -0.05534923  0.15513819]
Stock Position:  -0.010616167708735198
Bond Position:  [1.12641992]


portfolio before change:  [0.04095602]
curr_Stock_Price:  102.25956662009523
curr_Factors:  [102.25956662  -0.76244648  -1.05670589]
mat_Sqrt:  [[16.58273312  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00586207 -0.06282531 -0.0799869 ]
Stock Position:  -0.005862074027433766
Bond Position:  [0.64040917]


portfolio before change:  [0.04120247]
curr_Stock_Price:  102.23118185713474
curr_Factors:  [102.23118186  -0.73433652  -1.09257671]
mat_Sqrt:  [[16.44996752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01000173 0.21411269 0.28445151]
Stock Position:  0.010001730433611003
Bond Position:  [-0.98128626]


portfolio before change:  [0.05117716]
curr_Stock_Price:  103.24074308636561
curr_Factors:  [103.24074309  -0.68960442  -1.05259989]
mat_Sqrt:  [[18.08095662  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03637745 0.03193401 1.44728106]
Stock Position:  0.03637744617932459
Bond Position:  [-3.70445742]


portfolio before change:  [0.01179044]
curr_Stock_Price:  102.17074942754441
curr_Factors:  [102.17074943  -0.48260853  -1.02806746]
mat_Sqrt:  [[22.55528569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03622354 0.09006984 1.51261935]
Stock Position:  0.036223537226436585
Bond Position:  [-3.68919551]


portfolio before change:  [-0.01328116]
curr_Stock_Price:  101.49134532519999
curr_Factors:  [101.49134533  -0.59039562  -1.01501799]
mat_Sqrt:  [[20.38012001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01071966 -0.06328625  0.1144153 ]
Stock Position:  -0.01071966324251752
Bond Position:  [1.07467188]


portfolio before change:  [-0.01880611]
curr_Stock_Price:  102.01928099121906
curr_Factors:  [102.01928099  -0.56981732  -1.02336416]
mat_Sqrt:  [[20.7382607   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00293719 -0.00622963  0.25026922]
Stock Position:  -0.002937185864569361
Bond Position:  [0.28084348]


portfolio before change:  [-0.01778009]
curr_Stock_Price:  101.68191328183718
curr_Factors:  [101.68191328  -0.58719887  -1.00097719]
mat_Sqrt:  [[20.77340127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00101508 -0.01877503  0.33525532]
Stock Position:  0.0010150795621423215
Bond Position:  [-0.12099533]


portfolio before change:  [-0.0188556]
curr_Stock_Price:  100.63728001677563
curr_Factors:  [100.63728002  -0.48030645  -0.98087239]
mat_Sqrt:  [[23.34409169  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124969 -0.01626764 -0.40154822]
Stock Position:  -0.0012496885155152833
Bond Position:  [0.10690965]


portfolio before change:  [-0.01908373]
curr_Stock_Price:  100.8305211593345
curr_Factors:  [100.83052116  -0.4836504   -0.9611059 ]
mat_Sqrt:  [[23.77619313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00375737 -0.02612165 -0.31476906]
Stock Position:  0.0037573697065349243
Bond Position:  [-0.39794128]


portfolio before change:  [-0.02794442]
curr_Stock_Price:  98.48554424239637
curr_Factors:  [98.48554424 -0.36492009 -0.94795654]
mat_Sqrt:  [[26.49704316  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00361099 -0.00141978 -0.02482003]
Stock Position:  0.003610992126114171
Bond Position:  [-0.38357495]


portfolio before change:  [-0.03034482]
curr_Stock_Price:  97.83407482337472
curr_Factors:  [97.83407482 -0.39357584 -0.94511509]
mat_Sqrt:  [[25.6509855   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00190971  0.01622089 -0.32227943]
Stock Position:  0.0019097129773479422
Bond Position:  [-0.21717983]


portfolio before change:  [-0.02956234]
curr_Stock_Price:  98.25802871937579
curr_Factors:  [98.25802872 -0.51596319 -0.93030944]
mat_Sqrt:  [[23.1344843   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188565 -0.01868228 -0.04734404]
Stock Position:  -0.0018856517578647004
Bond Position:  [0.15571808]


portfolio before change:  [-0.02762665]
curr_Stock_Price:  97.24181322878749
curr_Factors:  [ 9.72418132e+01 -2.67017957e-02 -8.87746357e-01]
mat_Sqrt:  [[38.96846164  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.33221948e-04  2.21286244e-02 -6.48820522e-01]
Stock Position:  -0.0001332219481908693
Bond Position:  [-0.0146719]


portfolio before change:  [-0.02827567]
curr_Stock_Price:  102.0997876339576
curr_Factors:  [ 1.02099788e+02 -5.78660153e-02 -9.10431624e-01]
mat_Sqrt:  [[38.77024247  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00086287 -0.00502485  0.25879371]
Stock Position:  0.0008628683554522462
Bond Position:  [-0.11637435]


portfolio before change:  [-0.03021911]
curr_Stock_Price:  99.86434232791193
curr_Factors:  [99.86434233 -0.18872001 -0.92808018]
mat_Sqrt:  [[32.6881458   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.43027461e-03  1.94628110e-01 -1.67010741e+00]
Stock Position:  -0.001430274612758262
Bond Position:  [0.11261432]


portfolio before change:  [-0.0330457]
curr_Stock_Price:  101.85044316323263
curr_Factors:  [101.85044316  -0.13394312  -0.93422028]
mat_Sqrt:  [[34.99979111  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01863479 0.10139156 0.07852658]
Stock Position:  0.01863479432936869
Bond Position:  [-1.93100777]


portfolio before change:  [-0.06535554]
curr_Stock_Price:  100.12955264249716
curr_Factors:  [ 1.00129553e+02 -2.88523955e-02 -9.43503517e-01]
mat_Sqrt:  [[37.86809592  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00059364 0.00783586 0.1005987 ]
Stock Position:  0.000593642407544267
Bond Position:  [-0.12479669]


portfolio before change:  [-0.0664864]
curr_Stock_Price:  98.25088074700099
curr_Factors:  [98.25088075  0.1358255  -0.89348026]
mat_Sqrt:  [[46.05652543  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137621 -0.01199456 -0.05226646]
Stock Position:  -0.0013762129077458652
Bond Position:  [0.06872773]


portfolio before change:  [-0.06600628]
curr_Stock_Price:  97.90825493815902
curr_Factors:  [ 9.79082549e+01  6.68275857e-02 -8.82729398e-01]
mat_Sqrt:  [[43.29897896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057945  0.00590976 -0.01850749]
Stock Position:  -0.0005794485918083697
Bond Position:  [-0.00927348]


portfolio before change:  [-0.06580226]
curr_Stock_Price:  97.55416003198025
curr_Factors:  [97.55416003  0.11852218 -0.8709866 ]
mat_Sqrt:  [[45.96789802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00203927 -0.00353059  0.6123813 ]
Stock Position:  -0.002039270975162522
Bond Position:  [0.13313711]


portfolio before change:  [-0.07364357]
curr_Stock_Price:  101.40747640374857
curr_Factors:  [101.4074764   -0.24521658  -0.88588744]
mat_Sqrt:  [[32.72184156  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00060278 -0.01073602  0.02178285]
Stock Position:  0.0006027806106428672
Bond Position:  [-0.13477003]


portfolio before change:  [-0.07386747]
curr_Stock_Price:  101.06398993913051
curr_Factors:  [101.06398994  -0.18849222  -0.8939574 ]
mat_Sqrt:  [[34.23690841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213917 -0.01909768 -0.15520045]
Stock Position:  0.0021391653989813286
Bond Position:  [-0.29006006]


portfolio before change:  [-0.07085925]
curr_Stock_Price:  102.48719652646518
curr_Factors:  [102.48719653  -0.40199872  -0.92399722]
mat_Sqrt:  [[27.21428276  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207269 -0.00834361 -0.03417167]
Stock Position:  -0.0020726918855462264
Bond Position:  [0.14156513]


portfolio before change:  [-0.06914176]
curr_Stock_Price:  101.66710423934856
curr_Factors:  [101.66710424  -0.49135238  -0.88240783]
mat_Sqrt:  [[25.73735865  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00290253 -0.00283243  0.1156123 ]
Stock Position:  -0.002902534596695008
Bond Position:  [0.22595053]


portfolio before change:  [-0.06767042]
curr_Stock_Price:  101.1699227145353
curr_Factors:  [101.16992271  -0.54186481  -0.90249861]
mat_Sqrt:  [[23.86559971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213122 -0.01686034 -0.07212972]
Stock Position:  -0.0021312228098139107
Bond Position:  [0.14794522]


portfolio before change:  [-0.07092432]
curr_Stock_Price:  102.70537346962938
curr_Factors:  [102.70537347  -0.73840904  -0.91433342]
mat_Sqrt:  [[19.67053793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.73938831e-05 -1.10639848e-02 -2.44583914e-01]
Stock Position:  8.739388310757312e-05
Bond Position:  [-0.07990014]


portfolio before change:  [-0.07103163]
curr_Stock_Price:  101.59172207802929
curr_Factors:  [101.59172208  -1.03908757  -0.93389111]
mat_Sqrt:  [[14.12552411  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00235867 0.00280843 0.45973905]
Stock Position:  0.0023586731354857528
Bond Position:  [-0.3106533]


portfolio before change:  [-0.07135481]
curr_Stock_Price:  101.47116849911568
curr_Factors:  [101.4711685   -0.98686807  -0.91697038]
mat_Sqrt:  [[15.11875844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00017625 -0.022149   -0.01296706]
Stock Position:  -0.00017625310033530473
Bond Position:  [-0.0534702]


portfolio before change:  [-0.07148655]
curr_Stock_Price:  102.18070145364162
curr_Factors:  [102.18070145  -1.03260215  -0.9152691 ]
mat_Sqrt:  [[14.56864439  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024623  0.00291304  0.13957631]
Stock Position:  -0.00024623108289545105
Bond Position:  [-0.04632649]


portfolio before change:  [-0.07167679]
curr_Stock_Price:  102.9297817226263
curr_Factors:  [102.92978172  -0.95660529  -0.93145354]
mat_Sqrt:  [[15.58000242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00614599 0.010693   0.4517128 ]
Stock Position:  0.006145991480568915
Bond Position:  [-0.70428235]


portfolio before change:  [-0.05891802]
curr_Stock_Price:  105.020057273624
curr_Factors:  [105.02005727  -1.2244553   -0.92225005]
mat_Sqrt:  [[12.27354341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03100595 -0.07782435  0.58554355]
Stock Position:  0.031005953002535298
Bond Position:  [-3.31516498]


portfolio before change:  [-0.08276508]
curr_Stock_Price:  104.26431062561407
curr_Factors:  [104.26431063  -1.17635679  -0.90716937]
mat_Sqrt:  [[12.97991245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00509558  0.00728042  0.10033953]
Stock Position:  -0.00509558007501033
Bond Position:  [0.44852206]


portfolio before change:  [-0.08083851]
curr_Stock_Price:  103.89722766316682
curr_Factors:  [103.89722766  -1.23457784  -0.93566303]
mat_Sqrt:  [[11.85988087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01545239 -0.001885    0.28775586]
Stock Position:  0.015452390317687872
Bond Position:  [-1.68629903]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.08933224]
Stock Price:  103.3611992341443
PL:  [-3.45053147]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.27523530e-01 -6.12594877e-02  6.31453759e-03]
 [-2.05975380e-01  6.35093731e-02 -2.39351069e-01]
 [ 1.63240855e-02 -6.23516725e-03  5.80277323e-02]
 [-6.12789233e-02 -4.87685865e-02 -1.70389163e-02]
 [ 8.88927264e-02 -4.16268548e-02 -8.29555818e-02]
 [-1.29534958e-01 -1.69571486e-01  6.52473088e-02]
 [-5.23353168e-02 -1.69502782e-01 -2.74286114e-02]
 [ 7.18019646e-03  7.13195895e-01  1.06134458e-01]
 [ 4.42385607e-01  6.07806968e-02  4.28142168e-01]
 [ 5.07588233e-01  2.05315247e-01  3.64547358e-01]
 [-1.09022195e-01 -1.47950193e-01  4.64998597e-02]
 [-2.97047248e-02 -1.94251776e-02  9.58774777e-02]
 [ 1.47269350e-02 -5.25791860e-02  5.51778249e-02]
 [ 8.33230029e-03 -2.51788523e-02 -1.20356117e-01]
 [ 7.57313560e-02 -9.81280411e-02 -9.09683093e-02]
 [ 5.68079628e-02 -1.62248908e-02  2.90986125e-02]
 [ 4.63610286e-02  2.60774799e-02  1.92604904e-03]
 [-5.44205447e-02 -6.18252021e-02  1.63700597e-02]
 [ 5.77755179e-02 -1.55946413e-02 -1.15233706e-01]
 [ 2.66360150e-02  2.62848021e-03  6.24057532e-02]
 [-2.63229158e-02  4.16328876e-01 -3.81420490e-01]
 [ 1.56961292e-01  1.10546088e-01  9.68178883e-02]
 [-1.54432813e-02  2.32777883e-02  3.50480653e-02]
 [ 1.13020497e-01 -1.68188473e-01 -3.10938656e-01]
 [ 6.36538285e-02  3.04104862e-02 -1.53840824e-02]
 [-1.92536080e-02  1.33463040e-02  6.21892611e-02]
 [ 3.11201041e-02 -3.33653344e-02  9.29016387e-03]
 [ 4.87429456e-02 -3.83011291e-02 -1.47810986e-01]
 [-5.01596150e-02 -2.68065919e-02 -1.10928111e-02]
 [-5.06296434e-02 -1.34952337e-03  1.53008348e-02]
 [ 6.70932867e-03 -4.37302050e-02 -5.50332878e-02]
 [ 5.98194135e-03  5.57551845e-04 -3.33652749e-02]
 [ 3.99910940e-02  1.25256210e-02  1.47185647e-01]
 [ 2.25063718e-02 -5.50538175e-02  6.65503503e-02]
 [-6.89900589e-02 -1.36261856e-02 -1.51548484e-02]
 [ 6.54314284e-02 -4.82509152e-02  9.70219604e-02]
 [-2.16475896e-02  8.58672900e-02  5.81352883e-02]
 [ 8.49099716e-02 -8.05930289e-02 -7.89366159e-02]
 [ 1.74231986e-02 -1.51643532e-02  2.75999596e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.81239769]
curr_Stock_Price:  99.59580252889738
curr_Factors:  [99.59580253 -1.13475323 -0.98311353]
mat_Sqrt:  [[11.98017575  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00970837 -0.01977141  0.01801362]
Stock Position:  0.00970836667289668
Bond Position:  [-1.77931026]


portfolio before change:  [-0.81253489]
curr_Stock_Price:  99.60458148492228
curr_Factors:  [99.60458148 -1.08360516 -0.99828738]
mat_Sqrt:  [[12.42009374  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.019474    0.02049756 -0.68280198]
Stock Position:  -0.019474000860859847
Bond Position:  [1.12716482]


portfolio before change:  [-0.84036279]
curr_Stock_Price:  101.04079395291876
curr_Factors:  [101.04079395  -1.08244677  -1.00626094]
mat_Sqrt:  [[12.51360719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00214936 -0.00201239  0.16553697]
Stock Position:  0.0021493561452099264
Bond Position:  [-1.05753544]


portfolio before change:  [-0.84054399]
curr_Stock_Price:  101.01799292880455
curr_Factors:  [101.01799293  -1.0458934   -1.01129864]
mat_Sqrt:  [[12.91134802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00578652 -0.01573999 -0.04860729]
Stock Position:  -0.005786523875899243
Bond Position:  [-0.25600097]


portfolio before change:  [-0.83725557]
curr_Stock_Price:  100.4441719581051
curr_Factors:  [100.44417196  -1.06918054  -1.03619187]
mat_Sqrt:  [[12.2341309   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00518733 -0.01343501 -0.23664918]
Stock Position:  0.005187327446096373
Bond Position:  [-1.35829238]


portfolio before change:  [-0.83621399]
curr_Stock_Price:  100.67769852342026
curr_Factors:  [100.67769852  -1.01314993  -1.03727593]
mat_Sqrt:  [[12.95521556  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01164242 -0.05472896  0.18613241]
Stock Position:  -0.011642418516087
Bond Position:  [0.33591792]


portfolio before change:  [-0.84611589]
curr_Stock_Price:  101.53180738833277
curr_Factors:  [101.53180739  -0.91733416  -1.04621118]
mat_Sqrt:  [[14.25099571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00649314 -0.05470679 -0.07824619]
Stock Position:  -0.006493144129130922
Bond Position:  [-0.18685523]


portfolio before change:  [-0.84249719]
curr_Stock_Price:  100.97089970557947
curr_Factors:  [100.97089971  -0.76143882  -1.05853452]
mat_Sqrt:  [[16.36032206  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01066148 0.23018299 0.30277207]
Stock Position:  0.0106614835482809
Bond Position:  [-1.91899678]


portfolio before change:  [-0.83049941]
curr_Stock_Price:  102.1187387321702
curr_Factors:  [102.11873873  -0.74344978  -1.07544637]
mat_Sqrt:  [[16.56413962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03273255 0.01961689 1.22137043]
Stock Position:  0.032732552438759756
Bond Position:  [-4.17310638]


portfolio before change:  [-0.86337648]
curr_Stock_Price:  101.13026120083703
curr_Factors:  [101.1302612   -0.76235858  -1.06697132]
mat_Sqrt:  [[16.23354037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03843345 0.06626521 1.03995214]
Stock Position:  0.03843344922990858
Bond Position:  [-4.75016124]


portfolio before change:  [-0.82123075]
curr_Stock_Price:  102.24230116576678
curr_Factors:  [102.24230117  -1.14475445  -1.07283616]
mat_Sqrt:  [[11.13123238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01165465 -0.04775072  0.13265116]
Stock Position:  -0.011654653589570473
Bond Position:  [0.37036785]


portfolio before change:  [-0.82361373]
curr_Stock_Price:  102.45073915240901
curr_Factors:  [102.45073915  -1.14126726  -1.07656918]
mat_Sqrt:  [[11.15118362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126435 -0.00626945  0.27351176]
Stock Position:  -0.0012643468967505804
Bond Position:  [-0.69408045]


portfolio before change:  [-0.82299197]
curr_Stock_Price:  101.89035097377219
curr_Factors:  [101.89035097  -1.25171043  -1.08420513]
mat_Sqrt:  [[ 9.85502696  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00154818 -0.01696986  0.15740698]
Stock Position:  0.0015481824669429797
Bond Position:  [-0.98073682]


portfolio before change:  [-0.82403946]
curr_Stock_Price:  101.29294338329514
curr_Factors:  [101.29294338  -1.05756911  -1.09151563]
mat_Sqrt:  [[11.80982738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180992 -0.00812644 -0.3433425 ]
Stock Position:  -0.001809924929201811
Bond Position:  [-0.64070684]


portfolio before change:  [-0.82305956]
curr_Stock_Price:  100.7072863248319
curr_Factors:  [100.70728632  -0.88273831  -1.05276006]
mat_Sqrt:  [[14.53732937  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00255427 -0.03167069 -0.25950727]
Stock Position:  0.0025542673022796634
Bond Position:  [-1.08029289]


portfolio before change:  [-0.82460814]
curr_Stock_Price:  100.15388411500416
curr_Factors:  [100.15388412  -1.03728856  -1.05892842]
mat_Sqrt:  [[12.31097156  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00482787 -0.00523656  0.08301024]
Stock Position:  0.004827872430922232
Bond Position:  [-1.30813832]


portfolio before change:  [-0.82321274]
curr_Stock_Price:  100.47678657010712
curr_Factors:  [100.47678657  -1.17525338  -1.09554807]
mat_Sqrt:  [[10.37215972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00502087 0.00841647 0.00549448]
Stock Position:  0.005020866092015503
Bond Position:  [-1.32769323]


portfolio before change:  [-0.82720552]
curr_Stock_Price:  99.71460580182489
curr_Factors:  [99.7146058  -1.19913684 -1.089996  ]
mat_Sqrt:  [[10.10650543  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00630278 -0.019954    0.04669922]
Stock Position:  -0.006302775696483066
Bond Position:  [-0.19872672]


portfolio before change:  [-0.82830493]
curr_Stock_Price:  99.88509707444261
curr_Factors:  [99.88509707 -1.34123658 -1.08554138]
mat_Sqrt:  [[ 8.82194647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00352193 -0.00503315 -0.32872969]
Stock Position:  0.0035219317527161982
Bond Position:  [-1.18009342]


portfolio before change:  [-0.82823065]
curr_Stock_Price:  99.94807276310827
curr_Factors:  [99.94807276 -1.42715988 -1.11261318]
mat_Sqrt:  [[ 7.88433375  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00506207 0.00084834 0.17802624]
Stock Position:  0.005062072906973736
Bond Position:  [-1.33417508]


portfolio before change:  [-0.82881465]
curr_Stock_Price:  99.86565342791185
curr_Factors:  [99.86565343 -1.19206897 -1.0761612 ]
mat_Sqrt:  [[10.33561446  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185739  0.13436957 -1.08808649]
Stock Position:  -0.0018573904340185312
Bond Position:  [-0.64332514]


portfolio before change:  [-0.83008673]
curr_Stock_Price:  100.50723237532729
curr_Factors:  [100.50723238  -1.14691904  -1.06265539]
mat_Sqrt:  [[11.03040181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01806727 0.0356786  0.27619449]
Stock Position:  0.018067273519401073
Bond Position:  [-2.64597839]


portfolio before change:  [-0.8255385]
curr_Stock_Price:  100.777278665896
curr_Factors:  [100.77727867  -1.42465185  -1.06302347]
mat_Sqrt:  [[ 8.37488719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004224   0.00751287  0.09998237]
Stock Position:  -0.00042240166034566366
Bond Position:  [-0.78297001]


portfolio before change:  [-0.82552293]
curr_Stock_Price:  100.50870301079956
curr_Factors:  [100.50870301  -1.66077297  -1.05954754]
mat_Sqrt:  [[ 6.6188644   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00229935 -0.0542826  -0.88702144]
Stock Position:  0.0022993493432361357
Bond Position:  [-1.05662755]


portfolio before change:  [-0.82518149]
curr_Stock_Price:  100.71464326996097
curr_Factors:  [100.71464327  -1.78090277  -1.0686506 ]
mat_Sqrt:  [[ 5.82837264  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01144763  0.00981494 -0.04388651]
Stock Position:  0.011447634605093605
Bond Position:  [-1.97812592]


portfolio before change:  [-0.82308217]
curr_Stock_Price:  100.91962832058806
curr_Factors:  [100.91962832  -1.77015724  -1.07099293]
mat_Sqrt:  [[ 5.88951864  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00065115  0.0043075   0.17740865]
Stock Position:  -0.0006511525971972086
Bond Position:  [-0.7573681]


portfolio before change:  [-0.82302719]
curr_Stock_Price:  100.68979057391584
curr_Factors:  [100.68979057  -1.88698707  -1.09921524]
mat_Sqrt:  [[ 5.08269739  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00515588 -0.01076862  0.02650225]
Stock Position:  0.0051558805207995335
Bond Position:  [-1.34217172]


portfolio before change:  [-0.82438362]
curr_Stock_Price:  100.45924886477397
curr_Factors:  [100.45924886  -1.82425344  -1.11137813]
mat_Sqrt:  [[ 5.33410222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00201589 -0.01236164 -0.4216636 ]
Stock Position:  0.0020158911009168765
Bond Position:  [-1.02689853]


portfolio before change:  [-0.82422832]
curr_Stock_Price:  100.59996773475108
curr_Factors:  [100.59996773  -1.76127601  -1.07972741]
mat_Sqrt:  [[ 5.87172532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0098601  -0.00865179 -0.0316447 ]
Stock Position:  -0.009860099902868727
Bond Position:  [0.16769742]


portfolio before change:  [-0.82217826]
curr_Stock_Price:  100.39417938007504
curr_Factors:  [100.39417938  -1.50001218  -1.0510722 ]
mat_Sqrt:  [[ 7.83044902  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00610206 -0.00043556  0.04364902]
Stock Position:  -0.006102056701582431
Bond Position:  [-0.20956728]


portfolio before change:  [-0.82018899]
curr_Stock_Price:  100.06388629701267
curr_Factors:  [100.0638863   -1.51040061  -1.03580359]
mat_Sqrt:  [[ 7.84286849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00171502 -0.01411386 -0.15699465]
Stock Position:  -0.001715021090130846
Bond Position:  [-0.64857731]


portfolio before change:  [-0.82013883]
curr_Stock_Price:  99.98736333945847
curr_Factors:  [99.98736334 -1.4046353  -1.02351327]
mat_Sqrt:  [[ 8.81888322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.10654885e-05  1.79949084e-04 -9.51818422e-02]
Stock Position:  -8.106548852300124e-05
Bond Position:  [-0.8120333]


portfolio before change:  [-0.82025644]
curr_Stock_Price:  100.18598296810606
curr_Factors:  [100.18598297  -1.28047333  -1.04189063]
mat_Sqrt:  [[ 9.82238854  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00739047 0.00404263 0.41987968]
Stock Position:  0.007390465140557379
Bond Position:  [-1.56067745]


portfolio before change:  [-0.82232883]
curr_Stock_Price:  99.93196697571416
curr_Factors:  [99.93196698 -1.47015415 -1.06153589]
mat_Sqrt:  [[ 7.94704046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00312734 -0.01776854  0.18984963]
Stock Position:  0.00312733927117363
Bond Position:  [-1.13485]


portfolio before change:  [-0.82527553]
curr_Stock_Price:  99.035090839459
curr_Factors:  [99.03509084 -1.35599307 -1.04973182]
mat_Sqrt:  [[ 8.93297382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00838074 -0.00439783 -0.04323256]
Stock Position:  -0.008380743571258372
Bond Position:  [0.00471217]


portfolio before change:  [-0.82633865]
curr_Stock_Price:  99.16201343408143
curr_Factors:  [99.16201343 -1.67423887 -1.03874847]
mat_Sqrt:  [[ 6.57824286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01146002 -0.01557292  0.27677665]
Stock Position:  0.011460017200719819
Bond Position:  [-1.96273703]


portfolio before change:  [-0.83027231]
curr_Stock_Price:  98.8401728521208
curr_Factors:  [98.84017285 -1.61873543 -1.0432987 ]
mat_Sqrt:  [[ 6.89964527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00112278 0.02771355 0.1658438 ]
Stock Position:  0.001122784326979328
Bond Position:  [-0.9412485]


portfolio before change:  [-0.83058795]
curr_Stock_Price:  98.66384466707112
curr_Factors:  [98.66384467 -1.85424003 -1.01350384]
mat_Sqrt:  [[ 5.60676941  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00933624 -0.02601129 -0.22518419]
Stock Position:  0.009336235434404877
Bond Position:  [-1.75173683]


portfolio before change:  [-0.83556141]
curr_Stock_Price:  98.15459409578854
curr_Factors:  [98.1545941  -1.85338901 -1.00664753]
mat_Sqrt:  [[ 5.62098653  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00355126 -0.00489427  0.078735  ]
Stock Position:  0.003551263830979833
Bond Position:  [-1.18413427]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.83418663]
Stock Price:  98.5834010686659
PL:  [-0.83418663]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.89231371e-01 -1.01446061e-01  1.86811769e-02]
 [-1.34339787e-01  6.87667329e-02 -1.46003121e-01]
 [-3.40621250e-02  4.27047212e-02  2.23638446e-02]
 [ 7.87731469e-02  8.67290210e-02  6.26851542e-02]
 [-6.77162461e-02  1.91431027e-01 -4.21502070e-02]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.27829341e-02 -1.50213454e-01 -2.69606936e-02]
 [ 8.50513706e-03  6.20337337e-01  9.35562317e-02]
 [ 4.84580767e-01  7.84448577e-02  4.66898686e-01]
 [ 6.69869211e-01  2.89100547e-01  5.53559194e-01]
 [-1.37187572e-01 -2.04659253e-01  1.06182296e-02]
 [-6.97413637e-02 -2.00984455e-02  7.97179420e-02]
 [ 1.49498530e-02 -9.67813409e-02  1.25156678e-01]
 [ 1.35312060e-03  1.39874521e-01 -9.08134932e-02]
 [ 6.29808958e-01 -1.63107503e-01 -2.99064962e-01]
 [-1.73923894e-01 -9.41701265e-02  1.11077630e-01]
 [ 5.52351726e-02 -5.17165915e-04 -1.60786987e-02]
 [-6.43761290e-02 -6.51586182e-02  1.78295633e-02]
 [ 1.41585101e-01 -1.69245640e-01  2.60678763e-03]
 [ 3.24592766e-02 -9.90832416e-03  2.12808724e-01]
 [-4.17710310e-02  5.46584487e-01 -5.32406326e-01]
 [ 3.27197321e-01  1.92003454e-01  6.90961506e-02]
 [ 1.74688852e-02  1.28374265e-01 -3.17422186e-02]
 [-5.29146064e-02 -1.35661516e-01 -2.59428281e-02]
 [ 2.96534776e-02 -1.72697626e-02 -1.10020712e-02]
 [-4.87454893e-02 -5.51574371e-03  1.61488387e-01]
 [ 5.30871451e-02 -3.34523565e-02  2.00801015e-02]
 [ 1.35297231e-01 -7.02348315e-02  4.74750975e-02]
 [-5.14561348e-02 -3.98903760e-02  1.55858757e-02]
 [-7.19683127e-02 -1.36674502e-02  3.97236280e-02]
 [ 3.08983958e-02 -2.56255664e-02  1.90860187e-04]
 [ 2.62511976e-02 -3.81815079e-02 -9.19513014e-02]
 [-2.96386014e-02  9.84015547e-03  1.23838826e-01]
 [ 5.57856615e-03 -8.07051788e-02 -8.54206093e-02]
 [ 3.79088604e-02  1.99494406e-01 -3.38915265e-02]
 [-4.17279733e-02 -2.93724959e-02 -8.20512192e-04]
 [ 4.79237546e-01 -2.79409206e-01  3.40894855e-01]
 [-1.35375940e-01  6.72508616e-02  5.78152503e-02]
 [ 3.46782356e-01 -4.33921594e-02  4.70290756e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.60650472]
curr_Stock_Price:  100.53112169513841
curr_Factors:  [100.5311217   -1.01752631  -0.99857204]
mat_Sqrt:  [[13.38813683  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01539614 -0.03274158  0.0532922 ]
Stock Position:  -0.015396144010190725
Bond Position:  [8.15429634]


portfolio before change:  [6.61177952]
curr_Stock_Price:  100.25472426639737
curr_Factors:  [100.25472427  -0.8602965   -0.99865267]
mat_Sqrt:  [[15.62332542  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00960779  0.02219437 -0.41650627]
Stock Position:  -0.009607787996993761
Bond Position:  [7.57500566]


portfolio before change:  [6.61918554]
curr_Stock_Price:  99.5824482450952
curr_Factors:  [99.58244825 -0.63029142 -1.01931756]
mat_Sqrt:  [[19.13227972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108613  0.01378289  0.06379782]
Stock Position:  -0.0010861256432185226
Bond Position:  [6.72734459]


portfolio before change:  [6.62064616]
curr_Stock_Price:  99.01194050567614
curr_Factors:  [99.01194051 -0.6507684  -1.00744504]
mat_Sqrt:  [[18.85969329  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00579395 0.02799167 0.1788233 ]
Stock Position:  0.005793953591557125
Bond Position:  [6.04697557]


portfolio before change:  [6.6218571]
curr_Stock_Price:  99.09047418525856
curr_Factors:  [99.09047419 -0.54375101 -1.02640876]
mat_Sqrt:  [[20.61200223  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180693  0.0617841  -0.12024281]
Stock Position:  -0.0018069290887082847
Bond Position:  [6.80090656]


portfolio before change:  [6.61891466]
curr_Stock_Price:  101.18939836715978
curr_Factors:  [101.18939837  -0.51073664  -0.99358506]
mat_Sqrt:  [[22.48104011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00681927 -0.05534923  0.15513819]
Stock Position:  -0.006819266164133527
Bond Position:  [7.3089521]


portfolio before change:  [6.61883341]
curr_Stock_Price:  101.33529672433382
curr_Factors:  [101.33529672  -0.54568818  -0.98321121]
mat_Sqrt:  [[21.96686973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00404921 -0.04848118 -0.07691135]
Stock Position:  -0.004049209403579936
Bond Position:  [7.02916125]


portfolio before change:  [6.61365344]
curr_Stock_Price:  102.83155726415214
curr_Factors:  [102.83155726  -0.78257645  -0.98248856]
mat_Sqrt:  [[17.60225946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00876183 0.20021301 0.26688989]
Stock Position:  0.0087618326482972
Bond Position:  [5.71266054]


portfolio before change:  [6.61621652]
curr_Stock_Price:  103.04258051615923
curr_Factors:  [103.04258052  -0.77309879  -1.00116563]
mat_Sqrt:  [[17.4768629   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03409643 0.02531797 1.33193199]
Stock Position:  0.034096425391879175
Bond Position:  [3.10283286]


portfolio before change:  [6.59178854]
curr_Stock_Price:  102.31476658096737
curr_Factors:  [102.31476658  -0.49156525  -0.99428983]
mat_Sqrt:  [[23.15472651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03635873 0.0933068  1.5791503 ]
Stock Position:  0.03635872832929254
Bond Position:  [2.87175374]


portfolio before change:  [6.6123398]
curr_Stock_Price:  102.87012886586429
curr_Factors:  [102.87012887  -0.67454067  -1.02263424]
mat_Sqrt:  [[18.84584371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00938117 -0.06605349  0.03029085]
Stock Position:  -0.009381168207977412
Bond Position:  [7.57738178]


portfolio before change:  [6.60277962]
curr_Stock_Price:  103.99018276799961
curr_Factors:  [103.99018277  -0.68285115  -1.04147801]
mat_Sqrt:  [[18.54068177  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00310515 -0.00648675  0.2274131 ]
Stock Position:  -0.0031051492931962834
Bond Position:  [6.92568466]


portfolio before change:  [6.60130056]
curr_Stock_Price:  104.7453239866954
curr_Factors:  [104.74532399  -0.57425325  -1.02498691]
mat_Sqrt:  [[21.16379125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00098007 -0.03123604  0.35703717]
Stock Position:  0.0009800675227463146
Bond Position:  [6.49864307]


portfolio before change:  [6.60245074]
curr_Stock_Price:  105.08999878115267
curr_Factors:  [105.08999878  -0.63994256  -1.04347393]
mat_Sqrt:  [[19.5192395   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00058238  0.04514431 -0.25906562]
Stock Position:  0.0005823823690818757
Bond Position:  [6.54124818]


portfolio before change:  [6.60381614]
curr_Stock_Price:  106.03043181269163
curr_Factors:  [106.03043181  -0.68064812  -1.03715967]
mat_Sqrt:  [[19.02812894  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02814089 -0.05264272 -0.85314909]
Stock Position:  0.028140885529521736
Bond Position:  [3.6200259]


portfolio before change:  [6.58276077]
curr_Stock_Price:  105.26613807440276
curr_Factors:  [105.26613807  -0.43468811  -1.03463305]
mat_Sqrt:  [[24.21980356  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00703857 -0.03039328  0.31687356]
Stock Position:  -0.007038565088610031
Bond Position:  [7.32368333]


portfolio before change:  [6.57500474]
curr_Stock_Price:  106.49814335601585
curr_Factors:  [106.49814336  -0.31025218  -1.0579449 ]
mat_Sqrt:  [[27.11075393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00191244 -0.00016691 -0.04586805]
Stock Position:  0.0019124350463674067
Bond Position:  [6.37133396]


portfolio before change:  [6.57158117]
curr_Stock_Price:  104.291511627399
curr_Factors:  [104.29151163  -0.26216778  -1.07587504]
mat_Sqrt:  [[27.36178018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270586 -0.02102985  0.05086278]
Stock Position:  -0.0027058594643774147
Bond Position:  [6.85377934]


portfolio before change:  [6.57356255]
curr_Stock_Price:  103.87589233786147
curr_Factors:  [103.87589234  -0.33667013  -1.08123729]
mat_Sqrt:  [[25.16085509  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0042753  -0.0546238   0.00743644]
Stock Position:  0.004275295382775921
Bond Position:  [6.12946243]


portfolio before change:  [6.5725123]
curr_Stock_Price:  103.45101515880147
curr_Factors:  [103.45101516  -0.49962776  -1.08396897]
mat_Sqrt:  [[21.23183031  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0034795  -0.0031979   0.60708406]
Stock Position:  0.00347949970544165
Bond Position:  [6.21255453]


portfolio before change:  [6.57240689]
curr_Stock_Price:  103.1975223725993
curr_Factors:  [103.19752237  -0.54576122  -1.07190374]
mat_Sqrt:  [[20.47039875  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189918  0.17640938 -1.51880705]
Stock Position:  -0.0018991777578267705
Bond Position:  [6.76839733]


portfolio before change:  [6.57323637]
curr_Stock_Price:  103.20627620372755
curr_Factors:  [103.2062762   -0.50459285  -1.07037196]
mat_Sqrt:  [[21.36523053  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01780903 0.06196885 0.19711209]
Stock Position:  0.01780903109713242
Bond Position:  [4.73523259]


portfolio before change:  [6.5628937]
curr_Stock_Price:  102.59228373786797
curr_Factors:  [102.59228374  -0.47654427  -1.10235173]
mat_Sqrt:  [[21.15479779  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00175817  0.04143262 -0.09055171]
Stock Position:  0.0017581741727097588
Bond Position:  [6.3825186]


portfolio before change:  [6.56314372]
curr_Stock_Price:  102.28068536031145
curr_Factors:  [102.28068536  -0.43643032  -1.10503564]
mat_Sqrt:  [[21.8949254   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00392337 -0.04378457 -0.07400767]
Stock Position:  -0.003923372809746591
Bond Position:  [6.96442898]


portfolio before change:  [6.55990456]
curr_Stock_Price:  103.32819351230428
curr_Factors:  [103.32819351  -0.48846795  -1.12146501]
mat_Sqrt:  [[20.65541072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115624 -0.00557379 -0.03138585]
Stock Position:  0.0011562352349416534
Bond Position:  [6.44043287]


portfolio before change:  [6.55798616]
curr_Stock_Price:  100.97269512210615
curr_Factors:  [100.97269512  -0.45887093  -1.13024869]
mat_Sqrt:  [[20.60905439  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008204  -0.0017802   0.46068142]
Stock Position:  -0.0008204018710882534
Bond Position:  [6.64082435]


portfolio before change:  [6.55812477]
curr_Stock_Price:  101.81563154195322
curr_Factors:  [101.81563154  -0.62032689  -1.1224719 ]
mat_Sqrt:  [[17.82077413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00282578 -0.0107967   0.05728294]
Stock Position:  0.0028257776336699405
Bond Position:  [6.27041643]


portfolio before change:  [6.55939768]
curr_Stock_Price:  101.98870439202668
curr_Factors:  [101.98870439  -0.61095898  -1.11591488]
mat_Sqrt:  [[18.13761957  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00720334 -0.02266819  0.13543324]
Stock Position:  0.007203338832748718
Bond Position:  [5.82473849]


portfolio before change:  [6.55644687]
curr_Stock_Price:  101.4779761583978
curr_Factors:  [101.47797616  -0.61838612  -1.12876871]
mat_Sqrt:  [[17.68447188  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00319022 -0.01287456  0.04446217]
Stock Position:  -0.003190215152603513
Bond Position:  [6.88018345]


portfolio before change:  [6.55323333]
curr_Stock_Price:  102.7548862724766
curr_Factors:  [102.75488627  -0.39602532  -1.14505915]
mat_Sqrt:  [[22.00482902  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302886 -0.00441115  0.11332045]
Stock Position:  -0.003028863240823836
Bond Position:  [6.86446383]


portfolio before change:  [6.55766102]
curr_Stock_Price:  101.57636726452331
curr_Factors:  [101.57636726  -0.26638529  -1.14232213]
mat_Sqrt:  [[24.83126344  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00103525 -0.00827062  0.00054447]
Stock Position:  0.0010352497043423295
Bond Position:  [6.45250411]


portfolio before change:  [6.55897296]
curr_Stock_Price:  102.06449120760776
curr_Factors:  [102.06449121  -0.19216249  -1.11478749]
mat_Sqrt:  [[27.62316964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.12967079e-05 -1.23230287e-02 -2.62311469e-01]
Stock Position:  -1.1296707915617527e-05
Bond Position:  [6.56012595]


portfolio before change:  [6.55978705]
curr_Stock_Price:  102.59351350119894
curr_Factors:  [102.5935135   -0.29004592  -1.16225967]
mat_Sqrt:  [[24.00996901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.79382146e-05  3.17589652e-03  3.53277702e-01]
Stock Position:  -9.793821456196583e-05
Bond Position:  [6.56983488]


portfolio before change:  [6.56058094]
curr_Stock_Price:  102.87322018453601
curr_Factors:  [102.87322018  -0.36043644  -1.14723271]
mat_Sqrt:  [[22.77875277  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124378 -0.02604748 -0.24368122]
Stock Position:  -0.0012437782980048685
Bond Position:  [6.68853242]


portfolio before change:  [6.55816412]
curr_Stock_Price:  105.48858527296159
curr_Factors:  [105.48858527  -0.54374059  -1.13647316]
mat_Sqrt:  [[19.65612509  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00364835  0.06438654 -0.09668309]
Stock Position:  0.0036483491205056137
Bond Position:  [6.17330493]


portfolio before change:  [6.56446745]
curr_Stock_Price:  107.00478201030741
curr_Factors:  [107.00478201  -0.60919326  -1.12251496]
mat_Sqrt:  [[18.93790191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252885 -0.00947993 -0.00234069]
Stock Position:  -0.0025288490487415994
Bond Position:  [6.83506639]


portfolio before change:  [6.56318713]
curr_Stock_Price:  107.84894225119565
curr_Factors:  [107.84894225  -0.5755699   -1.13185713]
mat_Sqrt:  [[19.55643781  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02514713 -0.09017893  0.97247813]
Stock Position:  0.02514712832488438
Bond Position:  [3.85109594]


portfolio before change:  [6.56261761]
curr_Stock_Price:  107.80715052740689
curr_Factors:  [107.80715053  -0.6342261   -1.11999889]
mat_Sqrt:  [[18.6550894   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00588831  0.02170512  0.16493082]
Stock Position:  -0.005888308761951076
Bond Position:  [7.1974194]


portfolio before change:  [6.56748906]
curr_Stock_Price:  107.13264081563666
curr_Factors:  [107.13264082  -0.4279885   -1.09730683]
mat_Sqrt:  [[23.30743394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01491047 -0.01400476  0.13416086]
Stock Position:  0.014910467587334145
Bond Position:  [4.97009129]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.58057605]
Stock Price:  107.96867717085735
PL:  [-1.38810112]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-3.72611610e-01 -1.23233966e-01  2.63092902e-02]
 [-1.22102305e-01  6.96648457e-02 -1.30056526e-01]
 [-4.23532450e-02  4.71962238e-02  1.64582614e-02]
 [ 8.19417655e-02  8.44549777e-02  6.73019270e-02]
 [-1.87040009e-03  1.12594891e-01 -5.63269946e-02]
 [-1.30076918e-01 -1.61907482e-01  1.08574773e-01]
 [-5.83617207e-02 -1.81187117e-01  8.69783967e-02]
 [-4.17033986e-02  7.84608436e-01  1.83691897e-01]
 [ 3.20506374e-01  7.95940155e-03  3.03342464e-01]
 [ 3.35531488e-01  1.25342985e-01  1.92743690e-01]
 [-1.39139322e-01 -2.11087186e-01  1.74159009e-02]
 [-8.66304323e-02 -1.97083513e-02  8.62733327e-02]
 [ 2.77962855e-03 -4.09307469e-02  1.37544864e-01]
 [ 9.03313871e-03 -1.06364097e-01  5.30326667e-02]
 [-3.75444361e-02  1.01405364e-01 -4.63178978e-02]
 [ 4.33965502e-02 -2.00350406e-02  3.86454587e-02]
 [ 5.04495128e-02  1.87396643e-02 -2.19865362e-02]
 [-3.93295238e-02 -6.01848143e-02 -6.71994310e-03]
 [ 4.74139040e-02  5.60691729e-02 -2.44324755e-01]
 [-1.68450478e-02  2.96883420e-02 -6.20827345e-02]
 [-3.59410121e-02  4.73720644e-01 -4.29386815e-01]
 [ 3.55781037e-01  2.05680665e-01  6.44414940e-02]
 [ 1.80561318e-03 -3.26686590e-02  6.93076668e-02]
 [-4.11459222e-02  2.30269691e-03 -1.24008963e-02]
 [ 1.59236260e-03  1.90836786e-02 -9.19904878e-03]
 [-1.25714069e-01 -1.61619941e-02  2.15031661e-01]
 [-3.36986357e-02 -3.31779821e-02 -4.77981076e-03]
 [-5.13046729e-02  3.17841585e-02 -2.42165480e-01]
 [-1.40721612e-02 -3.97822507e-02  5.66078809e-02]
 [-7.27253486e-02  8.17621180e-03  1.98036650e-02]
 [ 7.32607640e-02 -6.33069546e-03  2.13976568e-02]
 [ 2.89324655e-02 -4.96426791e-03 -6.12775527e-02]
 [-4.03086918e-02  2.37488182e-02 -1.37128397e-01]
 [ 2.58672302e-02 -5.01334558e-02  9.48716891e-02]
 [-5.49355864e-02  9.19123180e-02 -1.98669686e-02]
 [-9.16063306e-02 -1.22851677e-01 -7.59026455e-02]
 [ 3.32424819e-04  1.02120027e-01  1.10340425e-01]
 [ 3.54661841e-02 -6.96946470e-02 -6.59750913e-02]
 [ 9.79300377e-02  3.69580245e-03  6.59581360e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.9997482]
curr_Stock_Price:  101.08498864251656
curr_Factors:  [101.08498864  -0.83229114  -1.00668656]
mat_Sqrt:  [[16.07047815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02441721 -0.03977359  0.07505308]
Stock Position:  -0.024417212274584016
Bond Position:  [13.46796182]


portfolio before change:  [11.01815398]
curr_Stock_Price:  100.4001364096785
curr_Factors:  [100.40013641  -0.87412587  -0.99788072]
mat_Sqrt:  [[15.4430177   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00870489  0.02248423 -0.37101507]
Stock Position:  -0.008704885783966356
Bond Position:  [11.8921257]


portfolio before change:  [11.02536002]
curr_Stock_Price:  99.743099812318
curr_Factors:  [99.74309981 -0.95214543 -1.00676719]
mat_Sqrt:  [[14.06494128  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208745  0.01523252  0.04695084]
Stock Position:  -0.0020874475762897218
Bond Position:  [11.23356851]


portfolio before change:  [11.02823143]
curr_Stock_Price:  99.04026513759958
curr_Factors:  [99.04026514 -0.83306069 -0.98868856]
mat_Sqrt:  [[16.0190276   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00704906 0.02725773 0.19199366]
Stock Position:  0.007049055457575314
Bond Position:  [10.33009111]


portfolio before change:  [11.03293601]
curr_Stock_Price:  99.52447672699411
curr_Factors:  [99.52447673 -0.81823095 -1.01110832]
mat_Sqrt:  [[15.97562846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00060187  0.03633984 -0.16068524]
Stock Position:  0.0006018690349974908
Bond Position:  [10.97303531]


portfolio before change:  [11.03470573]
curr_Stock_Price:  100.18575956652914
curr_Factors:  [100.18575957  -0.83667077  -1.02940783]
mat_Sqrt:  [[15.50166532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00909344 -0.05225542  0.30973361]
Stock Position:  -0.009093436667625347
Bond Position:  [11.94573859]


portfolio before change:  [11.03467477]
curr_Stock_Price:  100.35338280296526
curr_Factors:  [100.3533828   -0.54840321  -1.03518114]
mat_Sqrt:  [[20.59634093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00376727 -0.05847789  0.24812516]
Stock Position:  -0.003767270873582899
Bond Position:  [11.41273314]


portfolio before change:  [11.03684515]
curr_Stock_Price:  100.1559711794288
curr_Factors:  [100.15597118  -0.31601229  -1.03101764]
mat_Sqrt:  [[26.04169092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00598848 0.25323128 0.52402185]
Stock Position:  0.005988477458906015
Bond Position:  [10.43706338]


portfolio before change:  [11.03501384]
curr_Stock_Price:  99.63229508908549
curr_Factors:  [99.63229509 -0.44876816 -1.02049884]
mat_Sqrt:  [[22.9248014   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01675263 0.00256889 0.86535161]
Stock Position:  0.0167526250053617
Bond Position:  [9.36591137]


portfolio before change:  [11.01525295]
curr_Stock_Price:  98.38283686148463
curr_Factors:  [98.38283686 -0.55187011 -1.01121936]
mat_Sqrt:  [[20.61001019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0194304  0.04045427 0.5498441 ]
Stock Position:  0.019430395972984495
Bond Position:  [9.10363547]


portfolio before change:  [10.99938393]
curr_Stock_Price:  97.50755632524586
curr_Factors:  [97.50755633 -0.7067683  -1.01054947]
mat_Sqrt:  [[17.50719794  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01020565 -0.0681281   0.04968272]
Stock Position:  -0.010205648460542035
Bond Position:  [11.99451177]


portfolio before change:  [10.9917649]
curr_Stock_Price:  98.40102572160382
curr_Factors:  [98.40102572 -0.47643317 -1.03593363]
mat_Sqrt:  [[21.68638044  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00336815 -0.00636084  0.2461138 ]
Stock Position:  -0.003368146777082267
Bond Position:  [11.323194]


portfolio before change:  [10.99182662]
curr_Stock_Price:  98.80295815364815
curr_Factors:  [98.80295815 -0.41148556 -1.05123666]
mat_Sqrt:  [[22.8832527   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00098329 -0.01321034  0.39237721]
Stock Position:  0.0009832912718106864
Bond Position:  [10.89467454]


portfolio before change:  [10.99293073]
curr_Stock_Price:  98.54076457877368
curr_Factors:  [98.54076458 -0.52512827 -1.03017269]
mat_Sqrt:  [[20.80450093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.90717816e-05 -3.43288648e-02  1.51287437e-01]
Stock Position:  -8.907178162008177e-05
Bond Position:  [11.00170793]


portfolio before change:  [10.99427083]
curr_Stock_Price:  98.9359447585795
curr_Factors:  [98.93594476 -0.44067635 -1.04011034]
mat_Sqrt:  [[22.50383941  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00116868  0.03272844 -0.13213207]
Stock Position:  -0.001168678539059983
Bond Position:  [11.10989514]


portfolio before change:  [10.9948705]
curr_Stock_Price:  99.61119625857859
curr_Factors:  [99.61119626 -0.62973192 -1.04091557]
mat_Sqrt:  [[18.73937787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00251851 -0.00646628  0.11024474]
Stock Position:  0.0025185140210762843
Bond Position:  [10.74399831]


portfolio before change:  [10.99650854]
curr_Stock_Price:  99.72831156556411
curr_Factors:  [99.72831157 -0.62291504 -1.06616918]
mat_Sqrt:  [[18.41868032  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00270306  0.0060482  -0.06272147]
Stock Position:  0.0027030572727025494
Bond Position:  [10.7269372]


portfolio before change:  [10.99516582]
curr_Stock_Price:  98.73548292738343
curr_Factors:  [98.73548293 -0.69098364 -1.06898463]
mat_Sqrt:  [[16.98747182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311915 -0.01942457 -0.01917013]
Stock Position:  -0.0031191457328851578
Bond Position:  [11.30313618]


portfolio before change:  [10.99740498]
curr_Stock_Price:  98.47061065811144
curr_Factors:  [98.47061066 -0.72218332 -1.07728478]
mat_Sqrt:  [[16.28574254  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.51795181e-04  1.80962477e-02 -6.96990518e-01]
Stock Position:  0.0005517951811505093
Bond Position:  [10.94306937]


portfolio before change:  [10.99927813]
curr_Stock_Price:  99.3861347508504
curr_Factors:  [99.38613475 -0.60391257 -1.10531718]
mat_Sqrt:  [[17.98940299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00130396  0.00958187 -0.17710476]
Stock Position:  -0.0013039635299309257
Bond Position:  [11.12887402]


portfolio before change:  [11.0024583]
curr_Stock_Price:  98.01418318946601
curr_Factors:  [98.01418319 -0.68408599 -1.07758987]
mat_Sqrt:  [[16.83460067  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00159739  0.15289268 -1.22492107]
Stock Position:  -0.001597389072647758
Bond Position:  [11.15902508]


portfolio before change:  [11.00507546]
curr_Stock_Price:  97.24905871317979
curr_Factors:  [97.24905871 -0.32968497 -1.10706927]
mat_Sqrt:  [[23.11590857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01777648 0.06638315 0.18383365]
Stock Position:  0.01777648022350052
Bond Position:  [9.2763295]


portfolio before change:  [11.02008724]
curr_Stock_Price:  98.02829961765225
curr_Factors:  [98.02829962 -0.34717265 -1.09913618]
mat_Sqrt:  [[23.07956001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040228 -0.01054376  0.19771548]
Stock Position:  0.0004022832037069979
Bond Position:  [10.9806521]


portfolio before change:  [11.02142987]
curr_Stock_Price:  97.95362677850753
curr_Factors:  [97.95362678 -0.35392247 -1.09811962]
mat_Sqrt:  [[22.93013709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0018843   0.00074319 -0.03537631]
Stock Position:  -0.001884297872236892
Bond Position:  [11.20600368]


portfolio before change:  [11.02118339]
curr_Stock_Price:  98.82786060738992
curr_Factors:  [98.82786061 -0.33990597 -1.12147185]
mat_Sqrt:  [[22.91981309  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00015751  0.00615923 -0.02624233]
Stock Position:  0.00015750801272903012
Bond Position:  [11.00561721]


portfolio before change:  [11.02245698]
curr_Stock_Price:  98.17903884231472
curr_Factors:  [98.17903884 -0.22999337 -1.13712185]
mat_Sqrt:  [[25.02005047  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00340207 -0.00521626  0.61342547]
Stock Position:  -0.003402070206462588
Bond Position:  [11.35646896]


portfolio before change:  [11.02504513]
curr_Stock_Price:  97.83557025022782
curr_Factors:  [ 9.78355703e+01 -3.83103137e-02 -1.12886186e+00]
mat_Sqrt:  [[30.45091481  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013611  -0.01070815 -0.01363547]
Stock Position:  -0.0013610999193825392
Bond Position:  [11.15820912]


portfolio before change:  [11.0252797]
curr_Stock_Price:  98.68803725017766
curr_Factors:  [ 9.86880373e+01 -5.86892305e-02 -1.11946118e+00]
mat_Sqrt:  [[30.38087591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00310223  0.01025829 -0.69083071]
Stock Position:  -0.003102233802907325
Bond Position:  [11.33143307]


portfolio before change:  [11.02251458]
curr_Stock_Price:  100.03598238895222
curr_Factors:  [100.03598239  -0.1999145   -1.16106409]
mat_Sqrt:  [[25.65019964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041472 -0.01283967  0.16148653]
Stock Position:  -0.0004147197269955137
Bond Position:  [11.06400147]


portfolio before change:  [11.02405864]
curr_Stock_Price:  99.64784208383989
curr_Factors:  [ 9.96478421e+01  6.95801464e-02 -1.12344718e+00]
mat_Sqrt:  [[34.73595622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00192924  0.00263886  0.05649434]
Stock Position:  -0.00192923953803227
Bond Position:  [11.21630319]


portfolio before change:  [11.02252846]
curr_Stock_Price:  101.16776933932319
curr_Factors:  [ 1.01167769e+02 -5.80369352e-02 -1.14740969e+00]
mat_Sqrt:  [[30.30563272  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00251888 -0.00204322  0.06104156]
Stock Position:  0.002518881400365852
Bond Position:  [10.76769884]


portfolio before change:  [11.02341273]
curr_Stock_Price:  100.9844431207314
curr_Factors:  [100.98444312  -0.38067117  -1.15561613]
mat_Sqrt:  [[21.7296825   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00070921 -0.00160221 -0.1748078 ]
Stock Position:  0.0007092101096393352
Bond Position:  [10.95179354]


portfolio before change:  [11.02408417]
curr_Stock_Price:  100.00079404949429
curr_Factors:  [100.00079405  -0.15992995  -1.14848033]
mat_Sqrt:  [[27.02514809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00234789  0.0076649  -0.39118915]
Stock Position:  -0.002347894678650496
Bond Position:  [11.2588755]


portfolio before change:  [11.02892953]
curr_Stock_Price:  98.53654327790457
curr_Factors:  [ 9.85365433e+01 -2.04762826e-02 -1.13530894e+00]
mat_Sqrt:  [[31.02031334  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112827 -0.0161805   0.27064252]
Stock Position:  0.0011282730591737956
Bond Position:  [10.9177534]


portfolio before change:  [11.02903398]
curr_Stock_Price:  97.41947839814837
curr_Factors:  [97.4194784  -0.13156064 -1.1541334 ]
mat_Sqrt:  [[26.93245704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149371  0.02966457 -0.05667493]
Stock Position:  -0.0014937141079263906
Bond Position:  [11.17455083]


portfolio before change:  [11.0315866]
curr_Stock_Price:  96.64575856981375
curr_Factors:  [ 9.66457586e+01  4.76048724e-02 -1.16948702e+00]
mat_Sqrt:  [[31.47426319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00419952 -0.03965021 -0.21652912]
Stock Position:  -0.004199522827941155
Bond Position:  [11.43745267]


portfolio before change:  [11.03166189]
curr_Stock_Price:  96.96829096583869
curr_Factors:  [ 9.69682910e+01 -9.57066944e-02 -1.16745184e+00]
mat_Sqrt:  [[27.41870626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00159383 0.0329591  0.31477052]
Stock Position:  0.0015938291388459434
Bond Position:  [10.877111]


portfolio before change:  [11.03448636]
curr_Stock_Price:  97.88730119102397
curr_Factors:  [ 9.78873012e+01 -7.16216795e-02 -1.19074985e+00]
mat_Sqrt:  [[27.70035697  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0002806  -0.02249385 -0.18820857]
Stock Position:  0.0002805998026356588
Bond Position:  [11.0070192]


portfolio before change:  [11.03585615]
curr_Stock_Price:  97.86530455219145
curr_Factors:  [ 9.78653046e+01 -5.18813046e-02 -1.21325085e+00]
mat_Sqrt:  [[27.61778455  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00406072 0.00119282 0.1881602 ]
Stock Position:  0.004060719938189388
Bond Position:  [10.63845255]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.04126994]
Stock Price:  98.87101399874494
PL:  [11.04126994]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-4.09894657e-02 -8.26386671e-02  1.28935658e-02]
 [-1.93415565e-01  4.59425821e-02 -3.35960547e-01]
 [-4.06127739e-02  5.15907919e-02  1.96802293e-02]
 [ 1.21330240e-01  2.94751591e-02  1.47392296e-01]
 [-1.08377518e-02  1.10535033e-01 -5.74804265e-02]
 [-5.97217208e-02 -1.43242328e-01  2.03856323e-01]
 [-6.30683919e-02 -1.56858139e-01  4.74058412e-02]
 [ 2.17526510e-02  7.77904874e-01  1.15581657e-01]
 [-1.50751671e-02  5.85811837e-02 -6.38142245e-02]
 [ 1.96445566e-01  6.73266104e-02  7.52622009e-02]
 [-8.22821272e-02 -1.97990570e-01  8.53077775e-03]
 [-3.45149389e-02 -1.79052594e-02  9.27338410e-02]
 [-1.10321359e-02  4.53061009e-02  5.05870810e-02]
 [ 8.96826674e-03 -1.05024165e-01  5.32209733e-02]
 [-8.44547197e-02  1.96013252e-01 -3.97998770e-02]
 [ 6.32152169e-02 -1.43504259e-02  4.81401228e-03]
 [ 4.62859312e-02  6.78778988e-02 -6.67204977e-02]
 [-2.34717258e-02 -5.68417086e-02 -2.10759270e-02]
 [ 2.84640502e-03  8.79371634e-02 -1.31079303e-01]
 [-1.29328783e-02  1.58370905e-03 -3.98815672e-02]
 [-2.97364014e-02  4.17089822e-01 -3.60365237e-01]
 [ 1.24785889e-01  9.51502660e-02  1.02057426e-01]
 [ 2.40917137e-03 -3.53845466e-02  7.09633488e-02]
 [ 6.89911652e-02 -2.88834111e-02 -1.75709136e-01]
 [-1.15419060e-02  1.76778009e-02 -8.28543214e-03]
 [-1.08089055e-01 -1.81319701e-02  2.22331577e-01]
 [-3.57013703e-02 -3.32644081e-02 -5.55020602e-03]
 [-7.29333229e-02  9.98819052e-02 -7.44891452e-02]
 [ 1.09779318e-01 -3.77884614e-02  1.58803992e-01]
 [ 7.18294757e-02  6.39807477e-02 -1.18605488e-01]
 [ 1.02432008e-02 -1.17785593e-02 -1.40090245e-02]
 [-2.28445410e-02  7.76565221e-02 -1.25688898e-01]
 [-2.24583469e-02  5.55525961e-02 -5.94520673e-02]
 [ 4.63938837e-02 -3.88356245e-02  1.84667512e-01]
 [-7.49517463e-02 -4.22286797e-05 -3.44188543e-02]
 [-1.50269637e-01 -1.64838398e-01 -1.35694482e-01]
 [ 8.25919765e-02  1.04583713e-01  2.12713831e-01]
 [ 1.89308161e-01 -1.30328688e-01 -2.06351652e-01]
 [ 9.78121830e-02  3.76881641e-03  6.66558124e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.63550845]
curr_Stock_Price:  100.03048848688594
curr_Factors:  [100.03048849  -1.13973845  -0.96115317]
mat_Sqrt:  [[12.23845938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00451251 -0.02667152  0.03678175]
Stock Position:  -0.004512506284310495
Bond Position:  [3.08689666]


portfolio before change:  [2.6339484]
curr_Stock_Price:  100.46172116481232
curr_Factors:  [100.46172116  -1.46455648  -0.95858462]
mat_Sqrt:  [[ 8.90520265  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02836715  0.0148279  -0.95840193]
Stock Position:  -0.0283671516680609
Bond Position:  [5.48376128]


portfolio before change:  [2.65488378]
curr_Stock_Price:  99.7478720051332
curr_Factors:  [99.74787201 -1.3862636  -0.97513155]
mat_Sqrt:  [[ 9.40508569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277133  0.01665086  0.05614222]
Stock Position:  -0.0027713344156159708
Bond Position:  [2.93131849]


portfolio before change:  [2.65585615]
curr_Stock_Price:  99.529230279679
curr_Factors:  [99.52923028 -1.61008184 -1.00196939]
mat_Sqrt:  [[ 7.30383926  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02155485 0.00951307 0.42046919]
Stock Position:  0.02155484981330463
Bond Position:  [0.51051854]


portfolio before change:  [2.64424886]
curr_Stock_Price:  98.98776929574498
curr_Factors:  [98.9877693  -1.67693513 -1.00195198]
mat_Sqrt:  [[ 6.79447094  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.18119218e-06  3.56750285e-02 -1.63975657e-01]
Stock Position:  -1.1811921840026648e-06
Bond Position:  [2.64436578]


portfolio before change:  [2.64458023]
curr_Stock_Price:  98.30119470710713
curr_Factors:  [98.30119471 -1.74054326 -0.97201982]
mat_Sqrt:  [[ 6.52390486  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00725776 -0.04623126  0.58154535]
Stock Position:  -0.007257760801844033
Bond Position:  [3.35802679]


portfolio before change:  [2.64280449]
curr_Stock_Price:  98.60370136055495
curr_Factors:  [98.60370136 -1.62350748 -0.98859913]
mat_Sqrt:  [[ 7.23551969  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0118043  -0.05062575  0.13523567]
Stock Position:  -0.011804300469644785
Bond Position:  [3.80675221]


portfolio before change:  [2.64619543]
curr_Stock_Price:  98.35675210798856
curr_Factors:  [98.35675211 -1.39384826 -1.01125973]
mat_Sqrt:  [[ 8.87726227  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02299525 0.25106772 0.3297223 ]
Stock Position:  0.022995245533022037
Bond Position:  [0.38445777]


portfolio before change:  [2.63295274]
curr_Stock_Price:  97.77877399592813
curr_Factors:  [97.778774   -1.29280786 -1.02545885]
mat_Sqrt:  [[ 9.62574043  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016771   0.018907   -0.18204422]
Stock Position:  -0.0016771028862902634
Bond Position:  [2.79693781]


portfolio before change:  [2.63282028]
curr_Stock_Price:  98.06623222710745
curr_Factors:  [98.06623223 -1.16302512 -1.07250138]
mat_Sqrt:  [[10.48679239  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02150814 0.02172957 0.21470211]
Stock Position:  0.021508138662846687
Bond Position:  [0.52359816]


portfolio before change:  [2.63640589]
curr_Stock_Price:  98.2298983052538
curr_Factors:  [98.22989831 -1.17182553 -1.02168795]
mat_Sqrt:  [[10.95501294  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0110411  -0.06390118  0.02433593]
Stock Position:  -0.011041104758423107
Bond Position:  [3.72097249]


portfolio before change:  [2.64319793]
curr_Stock_Price:  97.65686777476843
curr_Factors:  [97.65686777 -0.93303861 -1.01217217]
mat_Sqrt:  [[13.96074149  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137819 -0.0057789   0.26454384]
Stock Position:  -0.0013781946054207683
Bond Position:  [2.7777881]


portfolio before change:  [2.64285319]
curr_Stock_Price:  98.15896233818428
curr_Factors:  [98.15896234 -0.92289381 -1.01458339]
mat_Sqrt:  [[14.14146172  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00060404 0.01462248 0.14431086]
Stock Position:  0.0006040378315386384
Bond Position:  [2.58356147]


portfolio before change:  [2.64257115]
curr_Stock_Price:  97.15736511558873
curr_Factors:  [97.15736512 -0.96355458 -0.99034612]
mat_Sqrt:  [[13.76915971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.16638595e-04 -3.38964034e-02  1.51824623e-01]
Stock Position:  -0.00011663859477956569
Bond Position:  [2.65390345]


portfolio before change:  [2.64295732]
curr_Stock_Price:  96.69090302323191
curr_Factors:  [96.69090302 -0.83469895 -0.98371268]
mat_Sqrt:  [[15.69132     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00335012  0.06326301 -0.11353797]
Stock Position:  -0.0033501195528677385
Bond Position:  [2.96688341]


portfolio before change:  [2.64202555]
curr_Stock_Price:  97.07974165566505
curr_Factors:  [97.07974166 -1.00708908 -0.99835021]
mat_Sqrt:  [[13.06704514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00468879 -0.00463158  0.01373304]
Stock Position:  0.004688788014885523
Bond Position:  [2.18683922]


portfolio before change:  [2.64210421]
curr_Stock_Price:  97.03821435878173
curr_Factors:  [97.03821436 -0.88842344 -0.99290472]
mat_Sqrt:  [[14.78741831  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00314607  0.0219075  -0.19033501]
Stock Position:  0.003146065372173041
Bond Position:  [2.33681564]


portfolio before change:  [2.64200569]
curr_Stock_Price:  96.91404735846882
curr_Factors:  [96.91404736 -0.99078326 -1.00373397]
mat_Sqrt:  [[13.18799907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00298579 -0.01834558 -0.06012375]
Stock Position:  -0.002985790061383508
Bond Position:  [2.93137069]


portfolio before change:  [2.64180079]
curr_Stock_Price:  97.10540297452435
curr_Factors:  [97.10540297 -0.92751611 -0.96757451]
mat_Sqrt:  [[14.59539989  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00040834  0.0283816  -0.37393277]
Stock Position:  -0.000408344230326473
Bond Position:  [2.68145322]


portfolio before change:  [2.64161573]
curr_Stock_Price:  98.37948238702607
curr_Factors:  [98.37948239 -0.90213865 -0.97946463]
mat_Sqrt:  [[14.98768691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013845   0.00051114 -0.11377101]
Stock Position:  -0.0013844962196497244
Bond Position:  [2.77782175]


portfolio before change:  [2.6438715]
curr_Stock_Price:  97.00098649913679
curr_Factors:  [97.0009865  -0.87730621 -0.97933917]
mat_Sqrt:  [[15.1511398   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00119843  0.13461516 -1.02802171]
Stock Position:  -0.0011984275799434478
Bond Position:  [2.76012016]


portfolio before change:  [2.64394049]
curr_Stock_Price:  97.23132534857054
curr_Factors:  [97.23132535 -0.97618335 -0.98832066]
mat_Sqrt:  [[13.63430337  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01210482 0.03070962 0.29114143]
Stock Position:  0.012104816479434247
Bond Position:  [1.46697314]


portfolio before change:  [2.64952531]
curr_Stock_Price:  97.67754703035511
curr_Factors:  [97.67754703 -0.80653631 -0.97074615]
mat_Sqrt:  [[16.51698517  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00058556 -0.01142031  0.20243868]
Stock Position:  0.0005855586749559074
Bond Position:  [2.59232937]


portfolio before change:  [2.64988038]
curr_Stock_Price:  97.73051310843299
curr_Factors:  [97.73051311 -0.99781791 -1.00142255]
mat_Sqrt:  [[13.23643647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00205712 -0.00932208 -0.50124926]
Stock Position:  0.00205711608098853
Bond Position:  [2.44883737]


portfolio before change:  [2.65020224]
curr_Stock_Price:  97.7381612565804
curr_Factors:  [97.73816126 -1.05666654 -0.99330671]
mat_Sqrt:  [[12.58264927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00076492  0.00570549 -0.02363603]
Stock Position:  -0.0007649181454881232
Bond Position:  [2.72496393]


portfolio before change:  [2.65027002]
curr_Stock_Price:  98.094879044851
curr_Factors:  [98.09487904 -0.82702797 -1.00205569]
mat_Sqrt:  [[15.75017554  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00421627 -0.00585207  0.6342501 ]
Stock Position:  -0.00421626949396559
Bond Position:  [3.06386447]


portfolio before change:  [2.65388093]
curr_Stock_Price:  97.32929685404204
curr_Factors:  [97.32929685 -0.72696345 -1.01175962]
mat_Sqrt:  [[17.10510525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00255037 -0.01073604 -0.01583319]
Stock Position:  -0.0025503713412262487
Bond Position:  [2.90210678]


portfolio before change:  [2.65707992]
curr_Stock_Price:  96.21722155212369
curr_Factors:  [96.21722155 -0.51178553 -1.00766794]
mat_Sqrt:  [[21.05535424  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00321771  0.03223675 -0.2124968 ]
Stock Position:  -0.0032177111189393088
Bond Position:  [2.96667914]


portfolio before change:  [2.65895527]
curr_Stock_Price:  95.74965624351448
curr_Factors:  [95.74965624 -0.43661894 -0.99831019]
mat_Sqrt:  [[22.80107994  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00589803 -0.01219617  0.45302359]
Stock Position:  0.005898032482434025
Bond Position:  [2.09422068]


portfolio before change:  [2.64975313]
curr_Stock_Price:  94.1450653043668
curr_Factors:  [94.1450653  -0.35632045 -1.00492436]
mat_Sqrt:  [[24.13328567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00251434  0.0206497  -0.33834844]
Stock Position:  0.0025143384176619875
Bond Position:  [2.41304058]


portfolio before change:  [2.65072405]
curr_Stock_Price:  94.41124793094211
curr_Factors:  [94.41124793 -0.48527326 -1.01597566]
mat_Sqrt:  [[21.03970365  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00023666 -0.00380151 -0.03996385]
Stock Position:  0.00023666361451477936
Bond Position:  [2.62838035]


portfolio before change:  [2.65103791]
curr_Stock_Price:  94.34910312619515
curr_Factors:  [94.34910313 -0.62599914 -1.04220918]
mat_Sqrt:  [[17.79279225  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183496  0.02506353 -0.35855544]
Stock Position:  -0.0018349626213740537
Bond Position:  [2.82416499]


portfolio before change:  [2.64978663]
curr_Stock_Price:  95.22341506879803
curr_Factors:  [95.22341507 -0.67776346 -1.05676997]
mat_Sqrt:  [[16.80526858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138375  0.01792952 -0.1696002 ]
Stock Position:  -0.00138375194864623
Bond Position:  [2.78155221]


portfolio before change:  [2.65070264]
curr_Stock_Price:  94.81272193695126
curr_Factors:  [94.81272194 -0.668053   -1.08019315]
mat_Sqrt:  [[16.50490233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00461449 -0.01253414  0.52680501]
Stock Position:  0.004614489169133815
Bond Position:  [2.21319036]


portfolio before change:  [2.64990847]
curr_Stock_Price:  94.58066144683524
curr_Factors:  [94.58066145 -0.68781998 -1.07633421]
mat_Sqrt:  [[16.20465981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.05941417e-03 -1.36292478e-05 -9.81874110e-02]
Stock Position:  -0.005059414167407194
Bond Position:  [3.1284312]


portfolio before change:  [2.64919502]
curr_Stock_Price:  94.79897247172183
curr_Factors:  [94.79897247 -0.45397807 -1.09471951]
mat_Sqrt:  [[20.14711278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01050352 -0.05320136 -0.38709859]
Stock Position:  -0.010503522606885696
Bond Position:  [3.64491817]


portfolio before change:  [2.64442074]
curr_Stock_Price:  95.29689350435922
curr_Factors:  [95.2968935  -0.61172411 -1.09936141]
mat_Sqrt:  [[17.2172484   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00855886 0.03375425 0.60681335]
Stock Position:  0.008558862779099237
Bond Position:  [1.8287877]


portfolio before change:  [2.63228336]
curr_Stock_Price:  93.85207702030677
curr_Factors:  [93.85207702 -0.48094873 -1.10647278]
mat_Sqrt:  [[19.1882553   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00628424 -0.0420634  -0.58866383]
Stock Position:  0.006284238584948371
Bond Position:  [2.04249452]


portfolio before change:  [2.63142822]
curr_Stock_Price:  93.67536964863821
curr_Factors:  [93.67536965 -0.69867415 -1.09937309]
mat_Sqrt:  [[15.5147015   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00723105 0.00121638 0.19015048]
Stock Position:  0.007231047931194595
Bond Position:  [1.95405713]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.63249545]
Stock Price:  93.78917915732144
PL:  [2.63249545]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-4.88558911e-01  2.15321885e-01 -2.64799030e-02]
 [-1.14192903e-01  4.51581475e-02  1.02253696e-01]
 [-3.15460835e-02  5.38813050e-02  2.78258135e-02]
 [ 1.32227246e-01  1.23513422e-01  7.79190418e-02]
 [-1.26770878e-01  2.42500294e-01 -1.98974212e-02]
 [-2.73028810e-02 -1.44815150e-01  1.61155040e-01]
 [-6.56718822e-02 -3.52850417e-01 -3.20459185e-01]
 [-1.08942319e-01  1.02747841e+00  3.05452459e-01]
 [ 2.96597011e-02 -1.22509027e-01 -1.34614798e-02]
 [ 1.28849469e-01  3.91305113e-02  1.81659116e-02]
 [-1.15672589e-01 -2.49943508e-01 -1.68972662e-02]
 [-1.09028851e-01 -2.04832918e-02  8.34967079e-02]
 [-5.23867812e-02  2.13956002e-01 -2.34907622e-01]
 [ 4.45114761e-03 -1.17229354e-02  6.63330079e-02]
 [-1.02086448e-01  1.94358450e-01 -3.89248257e-02]
 [-2.78677293e-01 -1.26291906e-01 -1.24366236e-01]
 [ 6.03869208e-02  7.49175463e-02 -2.06494263e-01]
 [ 7.15372024e-02 -3.00054236e-02 -8.30556755e-02]
 [ 3.22844878e-02  1.25312037e-01 -1.79475061e-01]
 [-1.77905618e-01 -3.56775195e-02  7.21105163e-02]
 [-5.21782011e-02  5.60682171e-01 -4.91084968e-01]
 [ 6.75192434e-01  2.62110860e-01  1.22311026e-01]
 [ 4.08385743e-02 -5.51660030e-02  8.81471146e-02]
 [ 3.45082337e-01  2.62171092e-01 -7.54416921e-02]
 [-3.80581345e-01  2.21030114e-01  2.92309109e-02]
 [-2.63805867e-01 -1.29049060e-01 -7.44088104e-02]
 [-1.30942766e-01 -3.73744534e-02 -4.21868722e-02]
 [-1.65675208e-01  1.78857996e-01 -2.58469106e-01]
 [ 6.10286164e-01  2.46424794e-01  4.97024913e-01]
 [ 2.20838251e-01  1.46829094e-01 -2.95043820e-01]
 [ 2.00822253e-01  2.37698925e-01  4.40534684e-01]
 [-2.73998574e-02 -4.02001914e-02 -5.70530141e-02]
 [ 3.70217181e-02  1.46890493e-01 -9.76517360e-02]
 [-5.36038916e-02 -6.17993845e-02 -5.08199739e-02]
 [-7.96790166e-02  2.58261738e-01 -1.99219439e-01]
 [-3.04455457e-01 -3.23022580e-01 -2.98573891e-01]
 [ 9.79456584e-02  1.98126471e-01  5.00870902e-01]
 [ 2.97860712e-01 -1.91145935e-01 -4.51671737e-01]
 [ 9.00722186e-02  8.56391980e-03  1.12474864e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.74149483]
curr_Stock_Price:  98.59616186465297
curr_Factors:  [98.59616186 -0.74982437 -1.01316209]
mat_Sqrt:  [[16.91237965  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02660842  0.06949484 -0.07553979]
Stock Position:  -0.026608420095671083
Bond Position:  [-6.11800674]


portfolio before change:  [-8.75423695]
curr_Stock_Price:  99.04629434264281
curr_Factors:  [99.04629434 -0.53769321 -1.00850785]
mat_Sqrt:  [[21.10238999  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00398545  0.01457473  0.29170133]
Stock Position:  -0.003985453160805281
Bond Position:  [-8.35949258]


portfolio before change:  [-8.75326935]
curr_Stock_Price:  98.54130952894506
curr_Factors:  [98.54130953 -0.51048529 -1.01271499]
mat_Sqrt:  [[21.48329315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069206  0.01739012  0.0793793 ]
Stock Position:  -0.0006920581363977421
Bond Position:  [-8.68507304]


portfolio before change:  [-8.75289016]
curr_Stock_Price:  96.4245900519864
curr_Factors:  [96.42459005 -0.73391757 -1.00944603]
mat_Sqrt:  [[16.8676512   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01027674 0.03986379 0.22228134]
Stock Position:  0.010276740542051986
Bond Position:  [-9.74382066]


portfolio before change:  [-8.74868665]
curr_Stock_Price:  96.95214719083538
curr_Factors:  [96.95214719 -0.82776479 -0.97487127]
mat_Sqrt:  [[15.98389215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00508839  0.07826663 -0.0567618 ]
Stock Position:  -0.005088388766444512
Bond Position:  [-8.25535643]


portfolio before change:  [-8.74854528]
curr_Stock_Price:  96.72155303825521
curr_Factors:  [96.72155304 -0.59209398 -0.99620522]
mat_Sqrt:  [[19.757577    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00121308 -0.04673889  0.45973047]
Stock Position:  -0.0012130796711214652
Bond Position:  [-8.63121433]


portfolio before change:  [-8.74766]
curr_Stock_Price:  95.10232906561838
curr_Factors:  [95.10232907 -0.33100174 -0.98535716]
mat_Sqrt:  [[25.49786065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00796579 -0.11388198 -0.91418086]
Stock Position:  -0.007965791015178289
Bond Position:  [-7.99009472]


portfolio before change:  [-8.74789989]
curr_Stock_Price:  95.00705498089866
curr_Factors:  [95.00705498 -0.34033053 -0.9806847 ]
mat_Sqrt:  [[25.35398496  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00643453 0.33161723 0.87137085]
Stock Position:  0.006434533086156276
Bond Position:  [-9.35922593]


portfolio before change:  [-8.74717608]
curr_Stock_Price:  95.30137135012023
curr_Factors:  [95.30137135 -0.37132851 -0.98066131]
mat_Sqrt:  [[24.65684084  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.72539225e-05 -3.95396183e-02 -3.84018549e-02]
Stock Position:  7.725392253786278e-05
Bond Position:  [-8.75453849]


portfolio before change:  [-8.74828306]
curr_Stock_Price:  95.13832845928997
curr_Factors:  [95.13832846 -0.44720994 -0.98290681]
mat_Sqrt:  [[22.76479297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00617379 0.01262932 0.05182229]
Stock Position:  0.006173790068979155
Bond Position:  [-9.33564713]


portfolio before change:  [-8.75114272]
curr_Stock_Price:  94.86416448016665
curr_Factors:  [94.86416448 -0.32506988 -0.98427248]
mat_Sqrt:  [[25.61309296  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00664274 -0.08066892 -0.0482032 ]
Stock Position:  -0.006642744576217923
Bond Position:  [-8.12098431]


portfolio before change:  [-8.76075531]
curr_Stock_Price:  96.15841898710657
curr_Factors:  [ 9.61584190e+01 -8.16059482e-02 -9.84416516e-01]
mat_Sqrt:  [[33.11460968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00290404 -0.00661095  0.23819287]
Stock Position:  -0.0029040442488138104
Bond Position:  [-8.48150701]


portfolio before change:  [-8.75985415]
curr_Stock_Price:  95.48301190931814
curr_Factors:  [95.48301191  0.15008652 -1.00493839]
mat_Sqrt:  [[40.61333558  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00139519  0.069054   -0.67012606]
Stock Position:  -0.001395194755409508
Bond Position:  [-8.62663676]


portfolio before change:  [-8.7610718]
curr_Stock_Price:  95.58281595039014
curr_Factors:  [95.58281595  0.1407575  -0.99635656]
mat_Sqrt:  [[40.62542074  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00038396 -0.00378356  0.18922961]
Stock Position:  0.00038395619498063306
Bond Position:  [-8.79777141]


portfolio before change:  [-8.762093]
curr_Stock_Price:  95.78749535040879
curr_Factors:  [95.78749535  0.30491399 -0.97352305]
mat_Sqrt:  [[49.08350767  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00143345  0.06272892 -0.11104169]
Stock Position:  -0.0014334487495523353
Bond Position:  [-8.62478653]


portfolio before change:  [-8.75880671]
curr_Stock_Price:  92.74277065662088
curr_Factors:  [92.74277066  0.29425657 -0.97563124]
mat_Sqrt:  [[46.9205185   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00702982 -0.04076054 -0.35478225]
Stock Position:  -0.007029817284718979
Bond Position:  [-8.10684198]


portfolio before change:  [-8.78982145]
curr_Stock_Price:  97.01049573246978
curr_Factors:  [97.01049573  0.12531668 -0.95446176]
mat_Sqrt:  [[42.33753685  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079194  0.02417953 -0.58907065]
Stock Position:  0.0007919434737932266
Bond Position:  [-8.86664828]


portfolio before change:  [-8.79175408]
curr_Stock_Price:  95.96973460235402
curr_Factors:  [95.9697346   0.32275633 -0.93917965]
mat_Sqrt:  [[51.81136663  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00093529 -0.00968421 -0.23693472]
Stock Position:  0.0009352909482313212
Bond Position:  [-8.8815137]


portfolio before change:  [-8.79389826]
curr_Stock_Price:  94.86427569533429
curr_Factors:  [94.8642757   0.44435201 -0.94998499]
mat_Sqrt:  [[57.21489179  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.71031143e-04  4.04442859e-02 -5.11992394e-01]
Stock Position:  0.0003710311427076965
Bond Position:  [-8.82909586]


portfolio before change:  [-8.79649182]
curr_Stock_Price:  90.84883264154603
curr_Factors:  [90.84883264  0.47412055 -0.95043573]
mat_Sqrt:  [[56.42327549  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302125 -0.01151487  0.20571123]
Stock Position:  -0.003021248982209004
Bond Position:  [-8.52201488]


portfolio before change:  [-8.79444524]
curr_Stock_Price:  89.8188279497471
curr_Factors:  [89.81882795  0.43366772 -0.95266387]
mat_Sqrt:  [[53.45277054  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.10379107e-04  1.80959393e-01 -1.40092872e+00]
Stock Position:  -0.0007103791066945996
Bond Position:  [-8.73063982]


portfolio before change:  [-8.7951663]
curr_Stock_Price:  89.29750854149418
curr_Factors:  [ 8.92975085e+01  4.58955812e-02 -9.07393127e-01]
mat_Sqrt:  [[37.73077378  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01997474 0.08459592 0.34891931]
Stock Position:  0.0199747354075415
Bond Position:  [-10.57886041]


portfolio before change:  [-8.78861816]
curr_Stock_Price:  89.69153562953474
curr_Factors:  [ 8.96915356e+01 -3.35567776e-02 -9.14378013e-01]
mat_Sqrt:  [[34.75910703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00136859 -0.01780475  0.25145918]
Stock Position:  0.0013685856615522837
Bond Position:  [-8.91136871]


portfolio before change:  [-8.78918638]
curr_Stock_Price:  90.0903207642385
curr_Factors:  [ 9.00903208e+01 -1.45171597e-02 -9.08094974e-01]
mat_Sqrt:  [[35.80904793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01070116  0.08461536 -0.21521415]
Stock Position:  0.01070115901144714
Bond Position:  [-9.75325722]


portfolio before change:  [-8.79769886]
curr_Stock_Price:  89.4087820909958
curr_Factors:  [89.40878209  0.23629034 -0.90089507]
mat_Sqrt:  [[45.99874825  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00716317  0.07133716  0.08338765]
Stock Position:  -0.007163173771330704
Bond Position:  [-8.15724822]


portfolio before change:  [-8.79517319]
curr_Stock_Price:  88.91383448834576
curr_Factors:  [88.91383449  0.31387054 -0.8976232 ]
mat_Sqrt:  [[49.59624285  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00615644 -0.04165041 -0.21226762]
Stock Position:  -0.006156444794709275
Bond Position:  [-8.24778007]


portfolio before change:  [-8.79571412]
curr_Stock_Price:  88.83422616040646
curr_Factors:  [88.83422616  0.40547636 -0.91752303]
mat_Sqrt:  [[53.23549321  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00276476 -0.01206255 -0.1203474 ]
Stock Position:  -0.002764756088782781
Bond Position:  [-8.55010915]


portfolio before change:  [-8.78642194]
curr_Stock_Price:  85.08669485325326
curr_Factors:  [ 8.50866949e+01  3.27424027e-02 -9.21849592e-01]
mat_Sqrt:  [[34.97255064  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00520196  0.05772617 -0.73734042]
Stock Position:  -0.005201958532390829
Bond Position:  [-8.34380448]


portfolio before change:  [-8.78842318]
curr_Stock_Price:  85.27089470146824
curr_Factors:  [ 8.52708947e+01 -2.97921713e-02 -9.14643469e-01]
mat_Sqrt:  [[33.16176464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02297954 0.07953326 1.41787373]
Stock Position:  0.022979543118629008
Bond Position:  [-10.74790938]


portfolio before change:  [-8.78523387]
curr_Stock_Price:  85.46815199399865
curr_Factors:  [85.46815199 -0.18133463 -0.91522293]
mat_Sqrt:  [[28.54798233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00667592  0.04738889 -0.84167789]
Stock Position:  0.006675920014332261
Bond Position:  [-9.35581242]


portfolio before change:  [-8.79478217]
curr_Stock_Price:  84.2130824003033
curr_Factors:  [84.2130824  -0.48389037 -0.91436683]
mat_Sqrt:  [[20.80291433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01630859 0.076717   1.25672283]
Stock Position:  0.016308585553213545
Bond Position:  [-10.16817842]


portfolio before change:  [-8.79016324]
curr_Stock_Price:  84.57424378826994
curr_Factors:  [84.57424379 -0.49036199 -0.9333244 ]
mat_Sqrt:  [[20.36755887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00231994 -0.01297456 -0.16275637]
Stock Position:  -0.0023199434517883594
Bond Position:  [-8.59395577]


portfolio before change:  [-8.79141665]
curr_Stock_Price:  84.65144285328005
curr_Factors:  [84.65144285 -0.59939252 -0.93980482]
mat_Sqrt:  [[18.16224187  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00259178  0.0474087  -0.27857322]
Stock Position:  0.0025917801124449636
Bond Position:  [-9.01081457]


portfolio before change:  [-8.79493031]
curr_Stock_Price:  83.7303618119152
curr_Factors:  [83.73036181 -0.65958229 -0.97207335]
mat_Sqrt:  [[16.37811538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0046765  -0.01994567 -0.14497524]
Stock Position:  -0.004676497881257279
Bond Position:  [-8.40336545]


portfolio before change:  [-8.79710581]
curr_Stock_Price:  83.97092958548355
curr_Factors:  [83.97092959 -0.83371859 -0.96889375]
mat_Sqrt:  [[13.84408845  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00488491  0.08335362 -0.56831761]
Stock Position:  -0.004884905055491377
Bond Position:  [-8.38691579]


portfolio before change:  [-8.79853564]
curr_Stock_Price:  84.0490069566326
curr_Factors:  [84.04900696 -1.02099737 -0.98330661]
mat_Sqrt:  [[11.32594453  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03808409 -0.10425509 -0.8517482 ]
Stock Position:  -0.03808409122476814
Bond Position:  [-5.59760559]


portfolio before change:  [-8.80519411]
curr_Stock_Price:  84.20546939149469
curr_Factors:  [84.20546939 -0.89763999 -0.98992041]
mat_Sqrt:  [[12.75214483  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0188696  0.06394504 1.42884527]
Stock Position:  0.018869602172491725
Bond Position:  [-10.39411782]


portfolio before change:  [-8.8191145]
curr_Stock_Price:  83.53661387299562
curr_Factors:  [83.53661387 -0.86435372 -0.98483361]
mat_Sqrt:  [[13.14573918  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01267682 -0.06169209 -1.28849374]
Stock Position:  0.012676815032967066
Bond Position:  [-9.8780927]


portfolio before change:  [-8.81381136]
curr_Stock_Price:  84.05235667596945
curr_Factors:  [84.05235668 -0.71920619 -0.9656947 ]
mat_Sqrt:  [[15.58858635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00736303 0.00276399 0.32085948]
Stock Position:  0.007363025376464003
Bond Position:  [-9.43269099]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.80831311]
Stock Price:  84.95924080518728
PL:  [-8.80831311]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.02516657e-01 -6.44321001e-02  7.29084759e-03]
 [-1.68465383e-01  6.62622441e-02 -1.90471998e-01]
 [-3.12128165e-02 -9.36921757e-03  1.58440341e-02]
 [-4.60881909e-01 -1.93358323e-01 -2.89149876e-01]
 [ 2.45650701e-01 -2.51133210e-01 -1.05478648e-01]
 [-1.29490055e-01 -1.76670818e-01  1.86690978e-02]
 [-5.17556433e-02 -1.94482850e-01 -2.80345744e-02]
 [ 7.70831139e-03  6.38337008e-01  9.71512427e-02]
 [ 4.90401279e-01  8.07909699e-02  4.69790726e-01]
 [ 7.24135318e-01  3.25473303e-01  6.43728566e-01]
 [ 1.52219911e-02 -1.78833763e-01 -3.28467288e-02]
 [-1.11147886e-01 -2.37468160e-02  8.00288091e-02]
 [ 1.58375936e-02 -8.70360653e-02  1.08520920e-01]
 [ 2.02213085e-03  7.29569086e-02 -3.39062760e-02]
 [ 6.33199790e-01 -1.79227986e-01 -2.93490883e-01]
 [-1.76406439e-01 -9.43009735e-02  1.11579234e-01]
 [ 5.84525384e-02 -1.62244998e-02 -3.33318001e-03]
 [-5.75700495e-02 -6.32047721e-02  1.27074607e-02]
 [ 2.62420928e-01 -3.40859083e-01  1.54237538e-01]
 [ 8.43374263e-02  1.45573009e-02  7.29412097e-01]
 [-2.90038298e-02  4.22030912e-01 -4.01638611e-01]
 [ 1.31213903e-01  9.82260494e-02  1.01010669e-01]
 [-2.73356623e-01  2.58543190e-01 -1.60272237e-01]
 [ 5.39739655e-02 -1.98166256e-01 -2.07403055e-01]
 [-6.30221504e-02 -2.51376552e-02 -5.74875073e-04]
 [ 5.70711603e-02  3.69024046e-02 -1.38753887e-01]
 [ 7.32710338e-02  1.67660160e-02  3.89832596e-01]
 [ 1.69200954e-01 -5.16844617e-02  2.26524836e-01]
 [ 8.08384271e-03  8.68737746e-02 -2.06774703e-01]
 [-7.62826428e-02  5.66278901e-02 -4.27153536e-02]
 [ 1.26368133e-01  9.35803308e-03  2.75099726e-02]
 [ 2.71007181e-02 -1.36711465e-01 -2.48908500e-01]
 [ 1.05357744e-01 -1.13622565e-02  1.67729958e-01]
 [-1.35204258e-02 -1.17231875e-01 -3.38290812e-01]
 [ 6.96376020e-02  3.08237594e-01 -1.19560725e-01]
 [-5.61435185e-02 -2.90850186e-02 -2.48028242e-02]
 [ 5.04462872e-01 -2.88800556e-01  3.52865169e-01]
 [-1.25940150e-01  6.11037745e-02  5.48751416e-02]
 [ 3.30848597e-01 -4.01210552e-02  5.17191780e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.62274426]
curr_Stock_Price:  99.61971260005978
curr_Factors:  [99.6197126 -0.9318673 -0.9789684]
mat_Sqrt:  [[14.73940279  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00616394 -0.02079537  0.02079876]
Stock Position:  0.0061639368335079025
Bond Position:  [-1.23679388]


portfolio before change:  [-0.62165313]
curr_Stock_Price:  99.82181396158492
curr_Factors:  [99.82181396 -0.83781941 -0.99340389]
mat_Sqrt:  [[15.99319678  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01211888  0.02138605 -0.54336359]
Stock Position:  -0.012118877532688851
Bond Position:  [0.58807521]


portfolio before change:  [-0.63564886]
curr_Stock_Price:  100.98275002883373
curr_Factors:  [100.98275003  -0.72907302  -0.98337825]
mat_Sqrt:  [[18.21960924  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016406  -0.0030239   0.04519862]
Stock Position:  -0.0016406032495933842
Bond Position:  [-0.46997623]


portfolio before change:  [-0.63788512]
curr_Stock_Price:  102.31001390416796
curr_Factors:  [102.3100139   -0.92727635  -1.00040166]
mat_Sqrt:  [[14.88463615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0375806  -0.06240613 -0.82486411]
Stock Position:  -0.037580595007000187
Bond Position:  [3.20698607]


portfolio before change:  [-0.65697002]
curr_Stock_Price:  102.8285208319419
curr_Factors:  [102.82852083  -1.00302033  -1.01855576]
mat_Sqrt:  [[13.61928309  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01269212 -0.0810529  -0.30090122]
Stock Position:  0.012692122580763476
Bond Position:  [-1.96208222]


portfolio before change:  [-0.65804254]
curr_Stock_Price:  102.76334371138137
curr_Factors:  [102.76334371  -1.06812482  -1.02456401]
mat_Sqrt:  [[12.67637324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01275933 -0.05702026  0.05325774]
Stock Position:  -0.0127593293218673
Bond Position:  [0.65314881]


portfolio before change:  [-0.65278395]
curr_Stock_Price:  102.3576064248018
curr_Factors:  [102.35760642  -0.75314578  -1.01381051]
mat_Sqrt:  [[17.48802468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00555676 -0.06276907 -0.07997484]
Stock Position:  -0.005556763796936166
Bond Position:  [-0.08400691]


portfolio before change:  [-0.65546938]
curr_Stock_Price:  102.83898766224665
curr_Factors:  [102.83898766  -0.90036114  -1.03212818]
mat_Sqrt:  [[14.88978214  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01060051 0.20602238 0.27714545]
Stock Position:  0.010600505794022465
Bond Position:  [-1.74561466]


portfolio before change:  [-0.65689044]
curr_Stock_Price:  102.7255169861473
curr_Factors:  [102.72551699  -0.70381127  -1.04736994]
mat_Sqrt:  [[17.82994489  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03380764 0.02607517 1.34018218]
Stock Position:  0.0338076366067209
Bond Position:  [-4.12979739]


portfolio before change:  [-0.63193399]
curr_Stock_Price:  103.47897711354797
curr_Factors:  [103.47897711  -0.70844964  -1.06894727]
mat_Sqrt:  [[17.49598738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05269624 0.10504606 1.83637842]
Stock Position:  0.052696244035179196
Bond Position:  [-6.08488742]


portfolio before change:  [-0.55821615]
curr_Stock_Price:  104.89233203847104
curr_Factors:  [104.89233204  -0.81416796  -1.09240031]
mat_Sqrt:  [[15.58589213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00179567 -0.05771835 -0.09370257]
Stock Position:  -0.0017956693164137081
Bond Position:  [-0.36986421]


portfolio before change:  [-0.55813978]
curr_Stock_Price:  104.82405118505706
curr_Factors:  [104.82405119  -0.77476312  -1.10326479]
mat_Sqrt:  [[16.02668799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00621834 -0.00766425  0.22829992]
Stock Position:  -0.006218338567544925
Bond Position:  [0.09369166]


portfolio before change:  [-0.55435359]
curr_Stock_Price:  104.21706026162315
curr_Factors:  [104.21706026  -0.95790498  -1.09670368]
mat_Sqrt:  [[13.35468397  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00151431 -0.02809077  0.30957998]
Stock Position:  0.0015143129766615109
Bond Position:  [-0.71217084]


portfolio before change:  [-0.55214846]
curr_Stock_Price:  105.73204365876866
curr_Factors:  [105.73204366  -1.02256907  -1.11304144]
mat_Sqrt:  [[12.49461172  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079981  0.02354674 -0.09672517]
Stock Position:  0.0007998093959737529
Bond Position:  [-0.63671394]


portfolio before change:  [-0.55185816]
curr_Stock_Price:  106.19451366474954
curr_Factors:  [106.19451366  -1.07312181  -1.10810781]
mat_Sqrt:  [[11.98963865  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04476419 -0.05784558 -0.8372478 ]
Stock Position:  0.044764189363205246
Bond Position:  [-5.30556948]


portfolio before change:  [-0.57521733]
curr_Stock_Price:  105.68750288534889
curr_Factors:  [105.68750289  -0.87099382  -1.1200199 ]
mat_Sqrt:  [[14.4323605   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0119786  -0.03043551  0.3183045 ]
Stock Position:  -0.011978603801174001
Bond Position:  [0.6907714]


portfolio before change:  [-0.58705209]
curr_Stock_Price:  106.68270393102996
curr_Factors:  [106.68270393  -0.79092288  -1.15223619]
mat_Sqrt:  [[15.28237151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00356361 -0.00523643 -0.00950863]
Stock Position:  0.003563605535457917
Bond Position:  [-0.96722717]


portfolio before change:  [-0.58129271]
curr_Stock_Price:  108.33280179916116
curr_Factors:  [108.3328018   -0.95301903  -1.13733794]
mat_Sqrt:  [[13.39459176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00506755 -0.02039925  0.03625085]
Stock Position:  -0.005067550488616199
Bond Position:  [-0.03231077]


portfolio before change:  [-0.57922238]
curr_Stock_Price:  107.92345857844704
curr_Factors:  [107.92345858  -1.00514463  -1.13320948]
mat_Sqrt:  [[12.7186339   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01763766 -0.1100118   0.43999676]
Stock Position:  0.01763766191259853
Bond Position:  [-2.48273985]


portfolio before change:  [-0.55182514]
curr_Stock_Price:  109.49439269522004
curr_Factors:  [109.4943927   -1.16702438  -1.11095888]
mat_Sqrt:  [[11.22215652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02104761 0.00469835 2.08080968]
Stock Position:  0.02104760731955164
Bond Position:  [-2.85642012]


portfolio before change:  [-0.54492217]
curr_Stock_Price:  109.83932678370975
curr_Factors:  [109.83932678  -1.25682287  -1.09239625]
mat_Sqrt:  [[10.48346763  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236957  0.13620989 -1.14576316]
Stock Position:  -0.0023695660342739682
Bond Position:  [-0.28465064]


portfolio before change:  [-0.54679158]
curr_Stock_Price:  110.61323338172265
curr_Factors:  [110.61323338  -1.37282022  -1.09172871]
mat_Sqrt:  [[ 9.40734533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01827114 0.03170232 0.28815532]
Stock Position:  0.018271140488439756
Bond Position:  [-2.56782151]


portfolio before change:  [-0.54186351]
curr_Stock_Price:  110.9005207991107
curr_Factors:  [110.9005208   -1.48534818  -1.10152417]
mat_Sqrt:  [[ 8.34582357  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03035017  0.08344446 -0.45721208]
Stock Position:  -0.03035016813244153
Bond Position:  [2.82398594]


portfolio before change:  [-0.54546038]
curr_Stock_Price:  111.03066470273545
curr_Factors:  [111.0306647   -1.40536601  -1.08700554]
mat_Sqrt:  [[ 9.18374314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00313734 -0.06395788 -0.59166319]
Stock Position:  -0.003137339870067442
Bond Position:  [-0.19711945]


portfolio before change:  [-0.54584464]
curr_Stock_Price:  111.14528997670737
curr_Factors:  [111.14528998  -1.18803497  -1.06896133]
mat_Sqrt:  [[11.63295444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00586873 -0.00811314 -0.00163996]
Stock Position:  -0.005868732577698792
Bond Position:  [0.10643735]


portfolio before change:  [-0.55026951]
curr_Stock_Price:  111.9015309944584
curr_Factors:  [111.90153099  -1.48436636  -1.04985897]
mat_Sqrt:  [[ 8.87638127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00408734  0.0119102  -0.39582622]
Stock Position:  0.004087342837000289
Bond Position:  [-1.00764943]


portfolio before change:  [-0.54716265]
curr_Stock_Price:  112.6924659434528
curr_Factors:  [112.69246594  -1.40555029  -1.05266509]
mat_Sqrt:  [[ 9.64507282  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01620181 0.00541121 1.11208389]
Stock Position:  0.016201809031881023
Bond Position:  [-2.37298446]


portfolio before change:  [-0.54434133]
curr_Stock_Price:  112.8849111494938
curr_Factors:  [112.88491115  -1.32835832  -1.04541328]
mat_Sqrt:  [[10.51283838  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01948951 -0.01668109  0.64621231]
Stock Position:  0.019489512584392937
Bond Position:  [-2.74441323]


portfolio before change:  [-0.54364503]
curr_Stock_Price:  112.93824112176596
curr_Factors:  [112.93824112  -1.10468206  -1.05037735]
mat_Sqrt:  [[13.08912481  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00125225  0.02803839 -0.58987067]
Stock Position:  -0.0012522481114835128
Bond Position:  [-0.40221833]


portfolio before change:  [-0.54264907]
curr_Stock_Price:  112.10275382268709
curr_Factors:  [112.10275382  -1.32000904  -1.01910065]
mat_Sqrt:  [[10.80821186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00679509  0.01827657 -0.12185501]
Stock Position:  -0.006795088694198293
Bond Position:  [0.21909908]


portfolio before change:  [-0.53765467]
curr_Stock_Price:  111.37178229078921
curr_Factors:  [111.37178229  -1.10063927  -1.04521437]
mat_Sqrt:  [[13.02695084  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01027821 0.00302029 0.07847829]
Stock Position:  0.0102782135759547
Bond Position:  [-1.68235763]


portfolio before change:  [-0.54505867]
curr_Stock_Price:  110.67188525246918
curr_Factors:  [110.67188525  -1.16713484  -1.05243998]
mat_Sqrt:  [[12.02508651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429216 -0.04412344 -0.71006667]
Stock Position:  -0.0042921626901468776
Bond Position:  [-0.07003693]


portfolio before change:  [-0.54229882]
curr_Stock_Price:  110.02684793791721
curr_Factors:  [110.02684794  -1.07716938  -1.05285773]
mat_Sqrt:  [[13.0749384   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01049918 -0.00366715  0.47848688]
Stock Position:  0.010499182709538153
Bond Position:  [-1.6974908]


portfolio before change:  [-0.55410727]
curr_Stock_Price:  108.92235719183391
curr_Factors:  [108.92235719  -0.72654258  -1.07156548]
mat_Sqrt:  [[18.03884083  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00590413 -0.03783642 -0.96504952]
Stock Position:  -0.005904126873387688
Bond Position:  [0.08898415]


portfolio before change:  [-0.5468814]
curr_Stock_Price:  107.70037339952741
curr_Factors:  [107.7003734   -0.75007161  -1.0625889 ]
mat_Sqrt:  [[17.57878085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00615237  0.09948326 -0.34107347]
Stock Position:  0.0061523667367624985
Bond Position:  [-1.20949359]


portfolio before change:  [-0.54558949]
curr_Stock_Price:  107.93493406766501
curr_Factors:  [107.93493407  -0.76615471  -1.06205775]
mat_Sqrt:  [[17.34520536  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.003871   -0.00938715 -0.07075555]
Stock Position:  -0.003871002217033591
Bond Position:  [-0.12777312]


portfolio before change:  [-0.54666923]
curr_Stock_Price:  108.20973768136817
curr_Factors:  [108.20973768  -0.81674826  -1.05888606]
mat_Sqrt:  [[16.58397786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03120723 -0.09320998  1.00662611]
Stock Position:  0.031207229714254603
Bond Position:  [-3.92359537]


portfolio before change:  [-0.57463365]
curr_Stock_Price:  107.32936655640277
curr_Factors:  [107.32936656  -0.5974868   -1.04393948]
mat_Sqrt:  [[20.79008135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00491898  0.01972116  0.1565435 ]
Stock Position:  -0.004918982808447684
Bond Position:  [-0.04668234]


portfolio before change:  [-0.57157442]
curr_Stock_Price:  106.70625709799803
curr_Factors:  [106.7062571   -0.47249495  -1.03184075]
mat_Sqrt:  [[23.70637737  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01405597 -0.01294901  0.14754042]
Stock Position:  0.014055966818117382
Bond Position:  [-2.07143403]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.54288811]
Stock Price:  108.76554299512763
PL:  [-9.30843111]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.59695201e-02 -8.07330923e-02  1.23071621e-02]
 [-1.04177317e-01  7.09803665e-02 -1.06698573e-01]
 [ 1.63240855e-02 -6.23516725e-03  5.80277323e-02]
 [ 1.63420130e-02 -2.16100887e-02  7.30155212e-02]
 [ 1.77055973e-01 -1.84771882e-01 -1.04520728e-01]
 [-1.29555704e-01 -1.80406035e-01 -7.09568196e-03]
 [-5.09953460e-02 -1.58333961e-01 -3.34669950e-02]
 [ 5.41530238e-03  7.03591078e-01  1.09186292e-01]
 [ 3.48725283e-01  2.21068035e-02  3.56621358e-01]
 [ 5.78974956e-01  2.57362962e-01  4.96717694e-01]
 [-1.43757738e-01 -2.00338532e-01  1.79545874e-02]
 [-1.72228159e-02 -1.64886728e-02  9.93917019e-02]
 [ 1.15921577e-02 -5.84941550e-02  9.79712234e-02]
 [ 7.95143209e-03 -3.27560049e-02 -7.86380763e-02]
 [ 6.74949241e-02 -9.16198232e-02 -8.60600179e-02]
 [ 6.24274567e-02 -1.46283625e-02  2.50825050e-02]
 [ 4.49742394e-02  2.85664229e-02  1.00370544e-02]
 [-4.25476855e-02 -5.22466472e-02  4.89094692e-02]
 [ 6.13432536e-02 -2.43996929e-02 -1.30466193e-01]
 [ 1.75681763e-02  1.03531818e-02  2.49019528e-02]
 [-3.07493228e-02  4.58280196e-01 -4.33672129e-01]
 [-5.45217419e-02  9.35216963e-03  1.31256410e-01]
 [-1.39533351e-02  4.86733095e-02  1.97929730e-02]
 [ 2.02069104e-02 -1.35171252e-01 -1.67384463e-01]
 [ 6.06584536e-02  3.17895302e-02 -1.46812198e-02]
 [-2.53885311e-02  6.18696912e-03  1.00796199e-01]
 [ 4.08171546e-03 -3.27542967e-02  5.05034273e-03]
 [ 1.04236661e-01 -6.46040809e-02 -4.20143055e-02]
 [-5.45705560e-02 -3.75691590e-02  8.28136388e-03]
 [-7.63759782e-02 -5.47286222e-03  3.45883453e-02]
 [-5.22182122e-03 -4.34779641e-02 -2.15588049e-02]
 [ 2.60680444e-02 -1.69388423e-02 -5.81119557e-02]
 [ 3.59091792e-02  1.02057378e-02  1.48907769e-01]
 [ 7.76729204e-03 -7.65192550e-02 -5.64419303e-02]
 [-1.15571683e-02  5.68397640e-02  4.49078361e-02]
 [ 8.79040924e-02  2.40574169e-02  1.87873032e-01]
 [ 5.46805842e-02 -3.09587855e-02  3.57634934e-03]
 [-7.73203395e-02  5.47660188e-04  4.23040703e-02]
 [ 9.39897393e-02  6.13691683e-03  8.92839198e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.330032]
curr_Stock_Price:  99.99197632373063
curr_Factors:  [99.99197632 -0.90895251 -1.02810412]
mat_Sqrt:  [[14.41159831  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277116 -0.02605649  0.03510891]
Stock Position:  -0.0027711641539576387
Bond Position:  [2.60712618]


portfolio before change:  [2.32767857]
curr_Stock_Price:  100.95884238984577
curr_Factors:  [100.95884239  -1.00394353  -1.04630907]
mat_Sqrt:  [[12.99364432  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00857868  0.02290881 -0.30438133]
Stock Position:  -0.008578676016080122
Bond Position:  [3.19377177]


portfolio before change:  [2.32472182]
curr_Stock_Price:  101.35004432537988
curr_Factors:  [101.35004433  -1.16804393  -1.03592876]
mat_Sqrt:  [[11.18538063  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00240459 -0.00201239  0.16553697]
Stock Position:  0.0024045850033564166
Bond Position:  [2.08101702]


portfolio before change:  [2.32279708]
curr_Stock_Price:  100.44141295243809
curr_Factors:  [100.44141295  -1.19296106  -1.03390018]
mat_Sqrt:  [[10.83426039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00247687 -0.00697463  0.20829296]
Stock Position:  0.0024768744758249246
Bond Position:  [2.07401631]


portfolio before change:  [2.32561242]
curr_Stock_Price:  101.47338661358616
curr_Factors:  [101.47338661  -1.1073415   -1.03493837]
mat_Sqrt:  [[11.91164734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00990664 -0.05963487 -0.29816854]
Stock Position:  0.009906636983815447
Bond Position:  [1.32035242]


portfolio before change:  [2.34059376]
curr_Stock_Price:  102.96897841766159
curr_Factors:  [102.96897842  -1.29606145  -1.053112  ]
mat_Sqrt:  [[ 9.82818533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01707633 -0.0582258  -0.02024201]
Stock Position:  -0.01707632951904285
Bond Position:  [4.09892597]


portfolio before change:  [2.33739287]
curr_Stock_Price:  103.18643054301468
curr_Factors:  [103.18643054  -1.28113827  -1.04762984]
mat_Sqrt:  [[10.05197615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00896804 -0.05110207 -0.09547202]
Stock Position:  -0.008968042795550388
Bond Position:  [3.2627732]


portfolio before change:  [2.34176672]
curr_Stock_Price:  102.74419673115572
curr_Factors:  [102.74419673  -1.29050974  -1.02578279]
mat_Sqrt:  [[10.13454459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01690483 0.22708304 0.3114781 ]
Stock Position:  0.016904833449129547
Bond Position:  [0.60489318]


portfolio before change:  [2.34218029]
curr_Stock_Price:  102.76418817704304
curr_Factors:  [102.76418818  -1.2590162   -1.02784435]
mat_Sqrt:  [[10.439288    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04081053 0.00713494 1.01734147]
Stock Position:  0.04081052705122015
Bond Position:  [-1.8516804]


portfolio before change:  [2.34146733]
curr_Stock_Price:  102.75239009052474
curr_Factors:  [102.75239009  -1.27204407  -1.02631545]
mat_Sqrt:  [[10.31874961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07102615 0.08306354 1.41699732]
Stock Position:  0.07102614687845575
Bond Position:  [-4.95663902]


portfolio before change:  [2.32913277]
curr_Stock_Price:  102.58745176281062
curr_Factors:  [102.58745176  -1.2482595   -1.00670448]
mat_Sqrt:  [[10.75909716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01682174 -0.06465898  0.05121944]
Stock Position:  -0.01682173721280411
Bond Position:  [4.05483193]


portfolio before change:  [2.33281861]
curr_Stock_Price:  102.39847281846653
curr_Factors:  [102.39847282  -1.08592005  -1.00039478]
mat_Sqrt:  [[12.712134    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.36235688e-05 -5.32169626e-03  2.83536860e-01]
Stock Position:  -2.3623568829707154e-05
Bond Position:  [2.33523763]


portfolio before change:  [2.33313164]
curr_Stock_Price:  101.50526836917601
curr_Factors:  [101.50526837  -0.84876739  -1.01827594]
mat_Sqrt:  [[15.69068736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00125236 -0.01887891  0.27948463]
Stock Position:  0.0012523594481105276
Bond Position:  [2.20601055]


portfolio before change:  [2.33297779]
curr_Stock_Price:  101.1622209051539
curr_Factors:  [101.16222091  -1.11983894  -1.01093393]
mat_Sqrt:  [[12.01255685  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00123094 -0.01057196 -0.22433254]
Stock Position:  -0.001230944394433963
Bond Position:  [2.45750286]


portfolio before change:  [2.33405224]
curr_Stock_Price:  100.53892475710596
curr_Factors:  [100.53892476  -1.17028974  -1.037938  ]
mat_Sqrt:  [[11.04874918  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00282622 -0.02957017 -0.24550528]
Stock Position:  0.002826218419588605
Bond Position:  [2.04990728]


portfolio before change:  [2.3338258]
curr_Stock_Price:  100.36813581588366
curr_Factors:  [100.36813582  -1.2169118   -1.04903269]
mat_Sqrt:  [[10.41138882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00620104 -0.00472128  0.07155341]
Stock Position:  0.006201036256057104
Bond Position:  [1.71143935]


portfolio before change:  [2.33704468]
curr_Stock_Price:  100.85272118151131
curr_Factors:  [100.85272118  -1.40798862  -1.06895767]
mat_Sqrt:  [[ 8.47156241  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00623901 0.00921977 0.02863292]
Stock Position:  0.006239007466135442
Bond Position:  [1.7078238]


portfolio before change:  [2.33377916]
curr_Stock_Price:  100.29509917053913
curr_Factors:  [100.29509917  -1.39140598  -1.08584999]
mat_Sqrt:  [[ 8.42211395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00513278 -0.01686253  0.1395251 ]
Stock Position:  -0.00513278309407114
Bond Position:  [2.84857215]


portfolio before change:  [2.33237447]
curr_Stock_Price:  100.63814664058813
curr_Factors:  [100.63814664  -1.00157646  -1.12795263]
mat_Sqrt:  [[11.96519822  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00248482 -0.00787497 -0.37218373]
Stock Position:  0.002484821933336971
Bond Position:  [2.08230659]


portfolio before change:  [2.3325507]
curr_Stock_Price:  100.60431037892617
curr_Factors:  [100.60431038  -1.17336697  -1.15054014]
mat_Sqrt:  [[ 9.84819306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00251463 0.00334148 0.07103834]
Stock Position:  0.0025146339423868323
Bond Position:  [2.07956768]


portfolio before change:  [2.33326406]
curr_Stock_Price:  100.78461788648157
curr_Factors:  [100.78461789  -1.06752144  -1.18432809]
mat_Sqrt:  [[10.60299195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242632  0.1479093  -1.23714587]
Stock Position:  -0.0024263172441544747
Bond Position:  [2.57779952]


portfolio before change:  [2.33194415]
curr_Stock_Price:  101.46142801889316
curr_Factors:  [101.46142802  -1.27730173  -1.20981503]
mat_Sqrt:  [[ 8.43645292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306054  0.0030184   0.374438  ]
Stock Position:  -0.003060544045491599
Bond Position:  [2.64247132]


portfolio before change:  [2.33226615]
curr_Stock_Price:  101.46415101257111
curr_Factors:  [101.46415101  -1.20782552  -1.18292693]
mat_Sqrt:  [[ 9.29013511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.39891791e-06 1.57092431e-02 5.64638427e-02]
Stock Position:  2.398917911018891e-06
Bond Position:  [2.33202275]


portfolio before change:  [2.33255799]
curr_Stock_Price:  101.59732944208253
curr_Factors:  [101.59732944  -1.20785934  -1.18023714]
mat_Sqrt:  [[ 9.32706859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00445499 -0.04362633 -0.47750128]
Stock Position:  -0.00445499203589683
Bond Position:  [2.78517328]


portfolio before change:  [2.33421971]
curr_Stock_Price:  101.30248102416029
curr_Factors:  [101.30248102  -1.09334318  -1.18121178]
mat_Sqrt:  [[10.41821734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00615755  0.01026003 -0.04188143]
Stock Position:  0.006157547946883325
Bond Position:  [1.71044482]


portfolio before change:  [2.33214285]
curr_Stock_Price:  100.93046980795457
curr_Factors:  [100.93046981  -1.1686453   -1.19771461]
mat_Sqrt:  [[ 9.4694607   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037496  0.00199684  0.2875435 ]
Stock Position:  -0.0003749615302985827
Bond Position:  [2.36998789]


portfolio before change:  [2.33267736]
curr_Stock_Price:  100.29507876710876
curr_Factors:  [100.29507877  -0.6936096   -1.20351179]
mat_Sqrt:  [[15.04424071  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00010458 -0.0105714   0.01440722]
Stock Position:  -0.00010458025073054665
Bond Position:  [2.34316625]


portfolio before change:  [2.33283828]
curr_Stock_Price:  101.55721859888517
curr_Factors:  [101.5572186   -0.98106279  -1.21618847]
mat_Sqrt:  [[11.28383432  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00730898 -0.02085088 -0.11985512]
Stock Position:  0.0073089759427787514
Bond Position:  [1.59055901]


portfolio before change:  [2.33351467]
curr_Stock_Price:  101.62255719117802
curr_Factors:  [101.62255719  -0.64738016  -1.22538054]
mat_Sqrt:  [[15.61926086  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00387655 -0.01212539  0.02362443]
Stock Position:  -0.0038765536143491827
Bond Position:  [2.72745996]


portfolio before change:  [2.33518396]
curr_Stock_Price:  101.27989929584243
curr_Factors:  [101.2798993   -0.77252019  -1.25862485]
mat_Sqrt:  [[13.28642618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00530111 -0.00176636  0.09867092]
Stock Position:  -0.005301109881974167
Bond Position:  [2.87207983]


portfolio before change:  [2.33249996]
curr_Stock_Price:  101.85393559111083
curr_Factors:  [101.85393559  -0.59027669  -1.25351255]
mat_Sqrt:  [[16.11500047  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00114784 -0.01403245 -0.06150127]
Stock Position:  -0.0011478371429469714
Bond Position:  [2.44941169]


portfolio before change:  [2.33323123]
curr_Stock_Price:  101.4836099013917
curr_Factors:  [101.4836099   -0.62729214  -1.27519744]
mat_Sqrt:  [[15.14102162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00070988 -0.00546699 -0.16577723]
Stock Position:  0.0007098836944949169
Bond Position:  [2.26118967]


portfolio before change:  [2.33382046]
curr_Stock_Price:  101.91546080201671
curr_Factors:  [101.9154608   -0.69655913  -1.26293504]
mat_Sqrt:  [[14.36291424  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00476144 0.00329389 0.42479242]
Stock Position:  0.004761435359169713
Bond Position:  [1.84855658]


portfolio before change:  [2.33583198]
curr_Stock_Price:  102.28938909051031
curr_Factors:  [102.28938909  -0.70920514  -1.26086329]
mat_Sqrt:  [[14.26398055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013582  -0.02469648 -0.16101312]
Stock Position:  -0.0013581970479328704
Bond Position:  [2.47476113]


portfolio before change:  [2.33603244]
curr_Stock_Price:  102.3695729295981
curr_Factors:  [102.36957293  -0.80301105  -1.28824302]
mat_Sqrt:  [[12.64593045  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00072845 0.01834495 0.12810956]
Stock Position:  0.0007284536045365386
Bond Position:  [2.26146095]


portfolio before change:  [2.33605405]
curr_Stock_Price:  102.01115989800158
curr_Factors:  [102.0111599   -0.71945869  -1.29564688]
mat_Sqrt:  [[13.59873321  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00964533 0.0077645  0.53594947]
Stock Position:  0.00964532593416346
Bond Position:  [1.35212317]


portfolio before change:  [2.33458692]
curr_Stock_Price:  101.84152798368781
curr_Factors:  [101.84152798  -0.72661602  -1.26270986]
mat_Sqrt:  [[13.93065872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00352397 -0.00999191  0.01020233]
Stock Position:  0.0035239660118156447
Bond Position:  [1.97570084]


portfolio before change:  [2.33287848]
curr_Stock_Price:  101.286636135187
curr_Factors:  [101.28663614  -0.81482926  -1.2747881 ]
mat_Sqrt:  [[12.53264849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00547157  0.00017676  0.12068174]
Stock Position:  -0.005471570249215778
Bond Position:  [2.88707542]


portfolio before change:  [2.33037749]
curr_Stock_Price:  101.80968470457657
curr_Factors:  [101.8096847   -1.00476566  -1.31426827]
mat_Sqrt:  [[10.01487319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01132989 0.00198068 0.25470217]
Stock Position:  0.01132989243401189
Bond Position:  [1.17688471]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.33493658]
Stock Price:  102.19909470725234
PL:  [0.13584188]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 6.88407226e-02 -6.87045531e-02  8.60561220e-03]
 [-2.22378138e-01  6.23055693e-02 -2.60725412e-01]
 [-3.14870042e-02  5.38988359e-02  2.78627324e-02]
 [ 1.10301039e-01  6.41021924e-02  1.08622243e-01]
 [-1.02889065e-01  2.18817583e-01 -3.94806536e-02]
 [-6.34180730e-02 -1.46062328e-01  1.88470364e-01]
 [-6.51367960e-02 -1.35234687e-01  5.73985231e-03]
 [ 2.62676310e-03  7.95500492e-01  1.47902792e-01]
 [-1.12310400e-02  4.65428826e-02 -6.25679737e-02]
 [ 9.04239375e-02  2.31022173e-02 -1.42909225e-02]
 [-8.48205798e-02 -2.70021748e-01 -3.90253803e-02]
 [-2.83918885e-02 -1.76934141e-02  9.34928862e-02]
 [-3.66972952e-02  1.85502546e-01 -9.46131167e-02]
 [ 1.05626690e-02 -1.37956591e-01  4.85928338e-02]
 [-5.14790590e-02  1.18418976e-01 -3.57370085e-02]
 [ 8.21614756e-02 -8.98292464e-03 -3.18123169e-03]
 [ 4.56029464e-02  7.78941347e-02 -7.81697322e-02]
 [-3.34926453e-02 -5.89542966e-02 -1.20040396e-02]
 [ 3.97957777e-02  2.21827955e-02 -1.76648865e-01]
 [-1.45713310e-02 -1.52515494e-02 -2.64987532e-02]
 [-2.73672327e-02  4.06904897e-01 -3.56225015e-01]
 [ 1.64614628e-01  1.14208183e-01  9.55715966e-02]
 [ 1.50859005e-03 -3.13321160e-02  6.84928725e-02]
 [ 7.37979935e-02 -2.60079559e-02 -1.78832335e-01]
 [-2.71709556e-02  2.06254397e-02 -6.74760103e-03]
 [-8.03390759e-02 -1.56644432e-02  2.11162280e-01]
 [-1.99349838e-02 -3.25840258e-02  5.14676098e-04]
 [-9.94596484e-02  9.53727340e-02 -1.80719519e-01]
 [-6.02988601e-02 -2.64830258e-02 -1.95728769e-02]
 [-3.61329687e-02  9.20673338e-03 -3.15424724e-03]
 [ 1.94875355e-02 -4.40911279e-02 -7.23253195e-02]
 [-1.97290760e-02 -2.00295859e-02 -5.85249308e-02]
 [ 3.32065020e-02  1.53312515e-02  1.28291445e-01]
 [ 3.10369425e-02 -4.41570052e-02  1.21348924e-01]
 [-6.78456401e-02  6.73030324e-03 -1.97720739e-02]
 [ 5.50711402e-02 -4.06249404e-02  9.14225595e-02]
 [-1.66467865e-02  1.01356251e-01  8.88843867e-02]
 [ 7.50389829e-02 -7.81814012e-02 -7.71621549e-02]
 [ 9.54633256e-02  5.22399292e-03  8.05605818e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.24807495]
curr_Stock_Price:  99.72949890735508
curr_Factors:  [99.72949891 -0.98436274 -0.99312826]
mat_Sqrt:  [[13.80416707  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00409826 -0.0221743   0.02454942]
Stock Position:  0.004098260866374901
Bond Position:  [-0.16064255]


portfolio before change:  [0.24672844]
curr_Stock_Price:  99.40584182943779
curr_Factors:  [99.40584183 -1.07511188 -0.99719489]
mat_Sqrt:  [[12.51470202  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02100573  0.02010904 -0.74377703]
Stock Position:  -0.021005727360495226
Bond Position:  [2.33482045]


portfolio before change:  [0.25364195]
curr_Stock_Price:  99.09061169214199
curr_Factors:  [99.09061169 -1.10851017 -0.99076401]
mat_Sqrt:  [[12.14309291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00121859  0.01739577  0.07948462]
Stock Position:  -0.001218593490129452
Bond Position:  [0.37439312]


portfolio before change:  [0.25477912]
curr_Stock_Price:  98.19583020088879
curr_Factors:  [98.1958302  -1.16706443 -1.01400732]
mat_Sqrt:  [[11.08831675  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01312717 0.02068889 0.30986902]
Stock Position:  0.013127174267998731
Bond Position:  [-1.03425465]


portfolio before change:  [0.25879296]
curr_Stock_Price:  98.51144490677125
curr_Factors:  [98.51144491 -0.98962592 -1.01558334]
mat_Sqrt:  [[13.26280466  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00499759  0.07062307 -0.11262732]
Stock Position:  -0.004997590540848712
Bond Position:  [0.75111283]


portfolio before change:  [0.25830833]
curr_Stock_Price:  98.62720655422066
curr_Factors:  [98.62720655 -1.04360101 -1.00349162]
mat_Sqrt:  [[12.73373182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430051 -0.04714141  0.53765349]
Stock Position:  -0.004300512197000073
Bond Position:  [0.68245583]


portfolio before change:  [0.26098773]
curr_Stock_Price:  98.02400070691762
curr_Factors:  [98.02400071 -1.19668682 -1.0078981 ]
mat_Sqrt:  [[10.81168438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00846952 -0.04364681  0.0163742 ]
Stock Position:  -0.008469523819626396
Bond Position:  [1.09120434]


portfolio before change:  [0.26954623]
curr_Stock_Price:  97.02960211361278
curr_Factors:  [97.02960211 -1.32283063 -1.01162174]
mat_Sqrt:  [[ 9.39862817  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02076879 0.25674668 0.4219255 ]
Stock Position:  0.020768791834640234
Bond Position:  [-1.74564138]


portfolio before change:  [0.27787243]
curr_Stock_Price:  97.44100892288286
curr_Factors:  [97.44100892 -1.19775471 -0.98183573]
mat_Sqrt:  [[11.01939299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131606  0.01502165 -0.17848901]
Stock Position:  -0.0013160568841547832
Bond Position:  [0.40611034]


portfolio before change:  [0.27847454]
curr_Stock_Price:  97.02207012442436
curr_Factors:  [97.02207012 -1.4529738  -0.96658608]
mat_Sqrt:  [[ 8.63115734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01068484  0.00745621 -0.04076802]
Stock Position:  0.010684840030040613
Bond Position:  [-0.75819076]


portfolio before change:  [0.27517426]
curr_Stock_Price:  96.72206485580747
curr_Factors:  [96.72206486 -1.07539254 -0.94788323]
mat_Sqrt:  [[12.78874887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01156521 -0.08714914 -0.11132855]
Stock Position:  -0.011565209559785183
Bond Position:  [1.3937852]


portfolio before change:  [0.28609486]
curr_Stock_Price:  95.79286648099303
curr_Factors:  [95.79286648 -0.96275739 -0.95600364]
mat_Sqrt:  [[14.0613119   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00091879 -0.00571052  0.26670918]
Stock Position:  -0.0009187895215463605
Bond Position:  [0.37410835]


portfolio before change:  [0.28500229]
curr_Stock_Price:  97.03290765330144
curr_Factors:  [97.03290765 -0.92525804 -0.94688187]
mat_Sqrt:  [[14.92309867  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00121587  0.05987069 -0.26990489]
Stock Position:  -0.001215871346248532
Bond Position:  [0.40298182]


portfolio before change:  [0.28368708]
curr_Stock_Price:  98.1560416094792
curr_Factors:  [98.15604161 -0.93965662 -0.9439778 ]
mat_Sqrt:  [[14.92330454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051454 -0.0445253   0.13862183]
Stock Position:  -0.0005145396239756271
Bond Position:  [0.33419226]


portfolio before change:  [0.2835252]
curr_Stock_Price:  98.55184331339325
curr_Factors:  [98.55184331 -0.96723993 -0.95034226]
mat_Sqrt:  [[14.48336212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00238906  0.03821956 -0.10194774]
Stock Position:  -0.0023890635900662162
Bond Position:  [0.51897182]


portfolio before change:  [0.28586845]
curr_Stock_Price:  97.59817793114927
curr_Factors:  [97.59817793 -0.88415836 -0.97212336]
mat_Sqrt:  [[15.24996343  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00522483 -0.00289923 -0.00907517]
Stock Position:  0.005224830733325024
Bond Position:  [-0.22406551]


portfolio before change:  [0.28162721]
curr_Stock_Price:  96.79179269084577
curr_Factors:  [96.79179269 -0.90604424 -0.94358342]
mat_Sqrt:  [[15.22493505  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00299159  0.02514022 -0.22299649]
Stock Position:  0.0029915851966957822
Bond Position:  [-0.00793368]


portfolio before change:  [0.28499518]
curr_Stock_Price:  97.91793718663553
curr_Factors:  [97.91793719 -1.03542134 -0.94013168]
mat_Sqrt:  [[13.57970956  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00353299 -0.01902742 -0.03424418]
Stock Position:  -0.00353298829857642
Bond Position:  [0.6309381]


portfolio before change:  [0.28184308]
curr_Stock_Price:  98.83245141182665
curr_Factors:  [98.83245141 -0.99427886 -0.97023223]
mat_Sqrt:  [[13.85872384  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00059641  0.00715947 -0.50393004]
Stock Position:  0.0005964130186550425
Bond Position:  [0.22289812]


portfolio before change:  [0.28119665]
curr_Stock_Price:  97.70186800857857
curr_Factors:  [97.70186801 -1.07702707 -0.93975055]
mat_Sqrt:  [[13.00251845  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00177608 -0.00492242 -0.07559357]
Stock Position:  -0.0017760848340167194
Bond Position:  [0.45472345]


portfolio before change:  [0.28094986]
curr_Stock_Price:  97.87282693474694
curr_Factors:  [97.87282693 -1.02593864 -0.95751773]
mat_Sqrt:  [[13.4666005   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126403  0.13132799 -1.01621081]
Stock Position:  -0.001264034308820986
Bond Position:  [0.40466447]


portfolio before change:  [0.28133846]
curr_Stock_Price:  97.60541736925354
curr_Factors:  [97.60541737 -0.93787061 -0.95649869]
mat_Sqrt:  [[14.68114032  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0141294  0.03686053 0.27263916]
Stock Position:  0.014129402846030726
Bond Position:  [-1.09776781]


portfolio before change:  [0.28688788]
curr_Stock_Price:  98.00788706455337
curr_Factors:  [98.00788706 -0.98992109 -0.96291135]
mat_Sqrt:  [[13.90454154  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00065403 -0.0101124   0.1953911 ]
Stock Position:  0.000654030747286739
Bond Position:  [0.22278771]


portfolio before change:  [0.28660611]
curr_Stock_Price:  97.534481984028
curr_Factors:  [97.53448198 -0.93258744 -0.93774367]
mat_Sqrt:  [[15.02739497  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00212846 -0.00839403 -0.51015888]
Stock Position:  0.0021284556775401026
Bond Position:  [0.07900829]


portfolio before change:  [0.28620186]
curr_Stock_Price:  97.3399157906924
curr_Factors:  [97.33991579 -1.10395095 -0.94098101]
mat_Sqrt:  [[12.59471362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193241  0.00665683 -0.01924903]
Stock Position:  -0.001932410246499019
Bond Position:  [0.47430251]


portfolio before change:  [0.28380809]
curr_Stock_Price:  98.60934864571703
curr_Factors:  [98.60934865 -1.237564   -0.91796667]
mat_Sqrt:  [[11.42307466  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00353961 -0.00505568  0.60238721]
Stock Position:  -0.0035396115576208746
Bond Position:  [0.63284688]


portfolio before change:  [0.28441389]
curr_Stock_Price:  98.46054963343624
curr_Factors:  [98.46054963 -1.51276321 -0.93141613]
mat_Sqrt:  [[ 8.54611346  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309861 -0.01051645  0.00146823]
Stock Position:  -0.0030986146493033957
Bond Position:  [0.58950519]


portfolio before change:  [0.28485422]
curr_Stock_Price:  98.34222716221677
curr_Factors:  [98.34222716 -1.72387457 -0.92358026]
mat_Sqrt:  [[ 6.96570398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01677949  0.03078142 -0.51554248]
Stock Position:  -0.01677949395848709
Bond Position:  [1.93498703]


portfolio before change:  [0.28157687]
curr_Stock_Price:  98.55196147607778
curr_Factors:  [98.55196148 -1.81657794 -0.93085901]
mat_Sqrt:  [[ 6.31638458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01103479 -0.00854736 -0.05583597]
Stock Position:  -0.011034790719494258
Bond Position:  [1.36907714]


portfolio before change:  [0.27721293]
curr_Stock_Price:  98.96294240764678
curr_Factors:  [98.96294241 -1.74330365 -0.95153151]
mat_Sqrt:  [[ 6.68529473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00522004  0.00297146 -0.00899819]
Stock Position:  -0.005220040628512216
Bond Position:  [0.79380351]


portfolio before change:  [0.27716017]
curr_Stock_Price:  98.99205833162083
curr_Factors:  [98.99205833 -1.54430022 -0.95029691]
mat_Sqrt:  [[ 8.1697842   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052338 -0.01423035 -0.20632401]
Stock Position:  -0.0005233764049286529
Bond Position:  [0.32897028]


portfolio before change:  [0.27729648]
curr_Stock_Price:  98.81019738274883
curr_Factors:  [98.81019738 -1.63198074 -0.95461755]
mat_Sqrt:  [[ 7.43800392  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00480827 -0.00646452 -0.16695534]
Stock Position:  -0.004808272478797277
Bond Position:  [0.75240283]


portfolio before change:  [0.27688995]
curr_Stock_Price:  98.91430631040045
curr_Factors:  [98.91430631 -1.54747204 -0.92087363]
mat_Sqrt:  [[ 8.38050532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00746057 0.00494814 0.36597978]
Stock Position:  0.007460571857915176
Bond Position:  [-0.46106734]


portfolio before change:  [0.27629995]
curr_Stock_Price:  98.84294880883142
curr_Factors:  [98.84294881 -1.50523216 -0.94180944]
mat_Sqrt:  [[ 8.55478364  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00546988 -0.01425161  0.3461747 ]
Stock Position:  0.005469884329297846
Bond Position:  [-0.26435955]


portfolio before change:  [0.2739377]
curr_Stock_Price:  98.41712536394446
curr_Factors:  [98.41712536 -1.10023547 -0.92726384]
mat_Sqrt:  [[12.95802806  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00544124  0.0021722  -0.05640422]
Stock Position:  -0.005441243068029052
Bond Position:  [0.8094492]


portfolio before change:  [0.27184562]
curr_Stock_Price:  98.82020599909637
curr_Factors:  [98.820206   -1.04658091 -0.93464385]
mat_Sqrt:  [[13.62733007  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00480213 -0.01311164  0.26080312]
Stock Position:  0.004802126348989876
Bond Position:  [-0.20270149]


portfolio before change:  [0.26653538]
curr_Stock_Price:  97.71967161613136
curr_Factors:  [97.71967162 -0.87451515 -0.92273901]
mat_Sqrt:  [[16.19736741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00136972 0.03271259 0.25356241]
Stock Position:  0.0013697238900076542
Bond Position:  [0.13268641]


portfolio before change:  [0.26676722]
curr_Stock_Price:  97.87682365985216
curr_Factors:  [97.87682366 -0.73602323 -0.89944147]
mat_Sqrt:  [[19.07245375  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227184 -0.02523294 -0.22012215]
Stock Position:  0.0022718425701225026
Bond Position:  [0.04440649]


portfolio before change:  [0.26970605]
curr_Stock_Price:  99.16797038767122
curr_Factors:  [99.16797039 -0.81115672 -0.89899199]
mat_Sqrt:  [[17.9334265   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00629963 0.00168604 0.22981692]
Stock Position:  0.006299634292950816
Bond Position:  [-0.35501589]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.28212594]
Stock Price:  101.14653947379445
PL:  [-0.86441354]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.58542279e-01  1.28068183e-01 -1.65288372e-02]
 [-4.75341131e-02 -6.30097155e-02  4.50411335e-01]
 [-3.96451776e-02  5.18192050e-02  2.06489294e-02]
 [ 8.07291729e-02  8.53252270e-02  6.55351430e-02]
 [-1.15853048e-01  2.36384183e-01 -2.21306551e-02]
 [-3.77688955e-02 -1.28909450e-01  2.81604438e-01]
 [-6.39774233e-02 -3.36340050e-01 -2.14921101e-01]
 [-1.25075585e-01  1.04782178e+00  3.31310329e-01]
 [ 4.69389425e-02 -1.22420862e-01 -5.52535712e-02]
 [ 1.97650421e-02 -3.08423417e-03 -7.03864314e-02]
 [ 4.42776538e-02 -2.43345528e-01 -5.63162183e-02]
 [ 2.16477387e-03 -2.79877689e-02 -8.44512503e-02]
 [-1.02257159e-01  3.95410888e-01 -6.35050816e-01]
 [ 5.73490004e-03 -3.82388799e-02  6.26066049e-02]
 [-1.70295573e-01  1.87956774e-01 -3.55396507e-02]
 [-2.45953787e-01 -1.09822090e-01 -1.00133680e-01]
 [-9.76878518e-02  2.64275035e-01 -5.25065199e-01]
 [ 1.35519232e-01 -9.96271760e-03 -1.23744318e-01]
 [ 1.57861059e-02  2.29897564e-01 -1.12784547e-01]
 [-9.44704237e-02 -1.51628727e-02 -2.48864939e-02]
 [-3.24208494e-02  4.26787185e-01 -3.61477376e-01]
 [ 2.85708942e-01  1.59514583e-01  9.02555112e-02]
 [ 7.56755717e-03 -5.64918742e-02  8.38458366e-02]
 [ 1.82363855e-01  2.01360520e-01 -8.53860537e-02]
 [-2.40758152e-01  1.12699706e-01  1.49215748e-02]
 [-1.82185977e-01 -5.30815336e-02  1.16486746e-01]
 [-7.21295559e-02 -3.48364293e-02 -1.95630968e-02]
 [-8.04159831e-02  1.11488510e-01 -6.49005016e-02]
 [ 9.31927783e-02 -2.85127365e-02  1.41700972e-01]
 [ 3.38803352e-02  4.80204887e-02 -8.10612661e-02]
 [ 2.76368874e-02 -2.21067385e-02 -5.16049097e-02]
 [-1.34903713e-02  1.03171959e-01 -1.28071542e-01]
 [-2.58580557e-02  5.09994256e-02 -5.23020897e-02]
 [ 4.81283099e-02 -4.07099674e-02  1.86060785e-01]
 [-7.45483475e-02 -4.64417966e-03 -3.17818311e-02]
 [-1.29261137e-01 -1.53690189e-01 -1.17731048e-01]
 [ 7.92157628e-02  1.05321081e-01  2.09580107e-01]
 [ 8.15241550e-02 -8.33404321e-02 -8.84488646e-02]
 [ 9.85145170e-02  3.33370275e-03  6.24981346e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.35695781]
curr_Stock_Price:  98.89678627810443
curr_Factors:  [98.89678628 -0.76398009 -1.00247869]
mat_Sqrt:  [[16.90514429  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0139469   0.04133383 -0.04715217]
Stock Position:  -0.013946902854943084
Bond Position:  [-4.97765393]


portfolio before change:  [-6.34480951]
curr_Stock_Price:  97.98113205981949
curr_Factors:  [97.98113206 -0.43471872 -0.99770833]
mat_Sqrt:  [[23.39091926  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00134855 -0.0203363   1.28489817]
Stock Position:  0.001348553730438588
Bond Position:  [-6.47694233]


portfolio before change:  [-6.34446481]
curr_Stock_Price:  98.83714015180176
curr_Factors:  [98.83714015 -0.43273685 -0.99861721]
mat_Sqrt:  [[23.62060416  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105216  0.01672458  0.05890565]
Stock Position:  -0.0010521611322389212
Bond Position:  [-6.24047221]


portfolio before change:  [-6.34517188]
curr_Stock_Price:  98.76772926449529
curr_Factors:  [98.76772926 -0.46818967 -0.99900124]
mat_Sqrt:  [[22.77310004  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00489716 0.0275386  0.18695352]
Stock Position:  0.00489715571263481
Bond Position:  [-6.82885283]


portfolio before change:  [-6.35547815]
curr_Stock_Price:  96.83750461145799
curr_Factors:  [96.83750461 -0.56096163 -0.97093394]
mat_Sqrt:  [[20.9290635   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00344587  0.07629267 -0.0631326 ]
Stock Position:  -0.0034458651293511784
Bond Position:  [-6.02178917]


portfolio before change:  [-6.35785298]
curr_Stock_Price:  97.30823096677237
curr_Factors:  [97.30823097 -0.64495477 -0.97265014]
mat_Sqrt:  [[19.30335023  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.41917935e-04 -4.16053461e-02  8.03339078e-01]
Stock Position:  -0.00034191793480088737
Bond Position:  [-6.32458155]


portfolio before change:  [-6.358173]
curr_Stock_Price:  95.93186287567316
curr_Factors:  [95.93186288 -0.44772068 -0.98746646]
mat_Sqrt:  [[22.83857609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00772829 -0.10855328 -0.61311008]
Stock Position:  -0.007728289793367903
Bond Position:  [-5.61678376]


portfolio before change:  [-6.35294328]
curr_Stock_Price:  95.16431170571633
curr_Factors:  [95.16431171 -0.16138655 -1.00909044]
mat_Sqrt:  [[29.52177119  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00529909 0.33818303 0.94513615]
Stock Position:  0.005299091911925887
Bond Position:  [-6.85722772]


portfolio before change:  [-6.37210496]
curr_Stock_Price:  91.71004661899221
curr_Factors:  [91.71004662 -0.11699139 -0.99100646]
mat_Sqrt:  [[30.28444086  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00035237 -0.03951116 -0.15762306]
Stock Position:  0.00035236908774856606
Bond Position:  [-6.40442075]


portfolio before change:  [-6.37239612]
curr_Stock_Price:  93.15580770852594
curr_Factors:  [93.15580771 -0.22843523 -1.01429247]
mat_Sqrt:  [[26.8843878   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.77348481e-04 -9.95432299e-04 -2.00792897e-01]
Stock Position:  0.00017734848094682652
Bond Position:  [-6.38891716]


portfolio before change:  [-6.3734014]
curr_Stock_Price:  91.99080203211508
curr_Factors:  [91.99080203 -0.13213367 -1.01753978]
mat_Sqrt:  [[29.13718331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057969 -0.07853943 -0.1606545 ]
Stock Position:  -0.0005796903517560124
Bond Position:  [-6.32007522]


portfolio before change:  [-6.37341145]
curr_Stock_Price:  90.6452474476748
curr_Factors:  [90.64524745 -0.1550816  -1.00556335]
mat_Sqrt:  [[28.39771151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00073199 -0.00903301 -0.24091591]
Stock Position:  -0.0007319866179244307
Bond Position:  [-6.30706034]


portfolio before change:  [-6.37631118]
curr_Stock_Price:  93.52958476258412
curr_Factors:  [93.52958476 -0.4487282  -0.98202624]
mat_Sqrt:  [[22.36558433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0067592   0.12761832 -1.81162322]
Stock Position:  -0.006759199848691562
Bond Position:  [-5.74412602]


portfolio before change:  [-6.37347977]
curr_Stock_Price:  93.0044536102458
curr_Factors:  [93.00445361 -0.46566991 -0.98270059]
mat_Sqrt:  [[21.85165975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00049007 -0.01234155  0.17859922]
Stock Position:  0.0004900744927327004
Bond Position:  [-6.41905888]


portfolio before change:  [-6.37411547]
curr_Stock_Price:  93.34467176958924
curr_Factors:  [93.34467177 -0.31570786 -0.99474771]
mat_Sqrt:  [[25.17479295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00552869  0.06066279 -0.10138473]
Stock Position:  -0.005528687284835824
Bond Position:  [-5.85804197]


portfolio before change:  [-6.37116873]
curr_Stock_Price:  92.67922539696973
curr_Factors:  [92.6792254  -0.37836582 -1.01530645]
mat_Sqrt:  [[22.99949079  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01255727 -0.03544493 -0.28565352]
Stock Position:  -0.012557270566014123
Bond Position:  [-5.20737062]


portfolio before change:  [-6.34698159]
curr_Stock_Price:  90.70123940326117
curr_Factors:  [90.7012394  -0.27195477 -0.99320235]
mat_Sqrt:  [[25.59543199  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00589642  0.0852944  -1.49786486]
Stock Position:  -0.00589642015447724
Bond Position:  [-5.81216897]


portfolio before change:  [-6.35914409]
curr_Stock_Price:  92.64071004612609
curr_Factors:  [92.64071005 -0.59117574 -1.03018721]
mat_Sqrt:  [[18.30850553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00591126 -0.00321545 -0.35300809]
Stock Position:  0.005911263372714599
Bond Position:  [-6.90676772]


portfolio before change:  [-6.35403464]
curr_Stock_Price:  93.65112773314041
curr_Factors:  [93.65112773 -0.63215855 -1.02215496]
mat_Sqrt:  [[17.9082762   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00221639  0.07419912 -0.32174292]
Stock Position:  0.0022163886697285206
Bond Position:  [-6.56160194]


portfolio before change:  [-6.35146787]
curr_Stock_Price:  95.17929971070005
curr_Factors:  [95.17929971 -0.74885738 -1.01012851]
mat_Sqrt:  [[16.39172414  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00626203 -0.0048938  -0.07099424]
Stock Position:  -0.006262029883749217
Bond Position:  [-5.75545225]


portfolio before change:  [-6.35460156]
curr_Stock_Price:  95.56483250057514
curr_Factors:  [95.5648325  -0.67884717 -1.02413269]
mat_Sqrt:  [[17.40617514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109671  0.13774497 -1.03119434]
Stock Position:  -0.0010967108082080765
Bond Position:  [-6.24979458]


portfolio before change:  [-6.3552838]
curr_Stock_Price:  95.4745242799951
curr_Factors:  [95.47452428 -0.63956917 -1.03607956]
mat_Sqrt:  [[17.87156188  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0188396  0.05148311 0.25747385]
Stock Position:  0.018839598434865438
Bond Position:  [-8.15398549]


portfolio before change:  [-6.35565305]
curr_Stock_Price:  95.50902933743126
curr_Factors:  [95.50902934 -0.6123427  -1.07385462]
mat_Sqrt:  [[17.69042385  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074341 -0.01823267  0.23918883]
Stock Position:  0.0007434056693330995
Bond Position:  [-6.426655]


portfolio before change:  [-6.35793573]
curr_Stock_Price:  93.519125870922
curr_Factors:  [93.51912587 -0.55931313 -1.05703186]
mat_Sqrt:  [[18.57508159  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01109212  0.06498883 -0.24358264]
Stock Position:  0.011092120538134178
Bond Position:  [-7.39526115]


portfolio before change:  [-6.36843223]
curr_Stock_Price:  92.65616817618562
curr_Factors:  [92.65616818 -0.49798691 -1.05437935]
mat_Sqrt:  [[19.61960381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01094352  0.03637367  0.0425671 ]
Stock Position:  -0.010943522077729874
Bond Position:  [-5.35444741]


portfolio before change:  [-6.37679432]
curr_Stock_Price:  93.35911715370887
curr_Factors:  [93.35911715 -0.57156168 -1.04188182]
mat_Sqrt:  [[18.59718133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00910049 -0.01713199  0.33230426]
Stock Position:  -0.00910048887346755
Bond Position:  [-5.52718071]


portfolio before change:  [-6.38221246]
curr_Stock_Price:  93.87856205936517
curr_Factors:  [93.87856206 -0.78182825 -1.03570694]
mat_Sqrt:  [[15.24828243  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00545857 -0.01124341 -0.05580807]
Stock Position:  -0.005458569711839401
Bond Position:  [-5.86976978]


portfolio before change:  [-6.39038222]
curr_Stock_Price:  95.2408222267329
curr_Factors:  [95.24082223 -0.83122786 -1.05081907]
mat_Sqrt:  [[14.50308996  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00488904  0.03598276 -0.18514307]
Stock Position:  -0.00488904404954611
Bond Position:  [-5.92474564]


portfolio before change:  [-6.39274687]
curr_Stock_Price:  95.57299656114016
curr_Factors:  [95.57299656 -0.84928476 -1.06029539]
mat_Sqrt:  [[14.15842939  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00821399 -0.00920245  0.40423343]
Stock Position:  0.008213992313745365
Bond Position:  [-7.17778273]


portfolio before change:  [-6.39311197]
curr_Stock_Price:  95.63778606834371
curr_Factors:  [95.63778607 -0.70891945 -1.07196685]
mat_Sqrt:  [[16.11389087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00168401  0.01549855 -0.23124523]
Stock Position:  0.0016840076019174843
Bond Position:  [-6.55416673]


portfolio before change:  [-6.39399335]
curr_Stock_Price:  95.60093425280945
curr_Factors:  [95.60093425 -0.6758293  -1.07219967]
mat_Sqrt:  [[16.64572832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00075638 -0.00713492 -0.14721444]
Stock Position:  0.0007563838559016812
Bond Position:  [-6.46630436]


portfolio before change:  [-6.39466687]
curr_Stock_Price:  95.77918059837326
curr_Factors:  [95.7791806  -0.60621289 -1.03597009]
mat_Sqrt:  [[18.53873561  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00100185  0.03329861 -0.36535246]
Stock Position:  -0.0010018470456664254
Bond Position:  [-6.29871078]


portfolio before change:  [-6.39553077]
curr_Stock_Price:  95.85555727698163
curr_Factors:  [95.85555728 -0.73123304 -1.04692922]
mat_Sqrt:  [[16.19463783  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00161312  0.01645999 -0.1492033 ]
Stock Position:  -0.001613124118259915
Bond Position:  [-6.24090386]


portfolio before change:  [-6.39570295]
curr_Stock_Price:  95.47866085251407
curr_Factors:  [95.47866085 -0.66040397 -1.03852851]
mat_Sqrt:  [[17.46100833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00445552 -0.01313909  0.53077963]
Stock Position:  0.0044555228344200165
Bond Position:  [-6.82111031]


portfolio before change:  [-6.39761021]
curr_Stock_Price:  95.24197444114901
curr_Factors:  [95.24197444 -0.88754024 -1.04286292]
mat_Sqrt:  [[13.81862878  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00593284 -0.0014989  -0.09066472]
Stock Position:  -0.005932844504187554
Bond Position:  [-5.83255438]


portfolio before change:  [-6.39953118]
curr_Stock_Price:  95.44286591426489
curr_Factors:  [95.44286591 -0.70386836 -1.01798697]
mat_Sqrt:  [[17.05890701  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01082512 -0.0496033  -0.33585391]
Stock Position:  -0.010825122883190891
Bond Position:  [-5.36635043]


portfolio before change:  [-6.39890091]
curr_Stock_Price:  95.32267278352127
curr_Factors:  [95.32267278 -0.47265574 -0.98559015]
mat_Sqrt:  [[22.17624805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00647065 0.03399223 0.59787371]
Stock Position:  0.0064706481568946265
Bond Position:  [-7.01570039]


portfolio before change:  [-6.3855306]
curr_Stock_Price:  97.52451215662778
curr_Factors:  [97.52451216 -0.4060256  -0.97107881]
mat_Sqrt:  [[24.60622212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00188805 -0.02689801 -0.25231999]
Stock Position:  0.0018880513824380176
Bond Position:  [-6.56966189]


portfolio before change:  [-6.38709539]
curr_Stock_Price:  97.13070579341964
curr_Factors:  [97.13070579 -0.46819882 -0.94110956]
mat_Sqrt:  [[23.73021609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00471771 0.00107595 0.17828978]
Stock Position:  0.0047177145004209465
Bond Position:  [-6.84533033]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.37941562]
Stock Price:  98.93994721840163
PL:  [-6.37941562]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-4.05538796e-02 -8.25834045e-02  1.28765598e-02]
 [-5.50371882e-02  5.46292931e-02  2.22965001e-02]
 [-9.27759656e-02 -1.86161819e-02 -3.99046266e-02]
 [-4.03916916e-01 -1.86366070e-01 -2.40537480e-01]
 [ 1.92848600e-01 -2.00050312e-01 -1.04741271e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.27887235e-02 -1.49963969e-01 -2.69546416e-02]
 [ 1.23941678e-02  6.09002348e-01  8.56181865e-02]
 [ 3.53405560e-01  2.39400224e-02  3.57502180e-01]
 [ 5.64596084e-01  2.48283408e-01  4.74626745e-01]
 [-1.15492602e-01 -1.82602885e-01  2.06016781e-02]
 [-4.85218623e-02 -1.97199169e-02  8.50462511e-02]
 [ 1.39818449e-02 -3.88189205e-02  2.61135619e-02]
 [-9.72365668e-05  1.65550763e-01 -8.11931105e-02]
 [ 3.24554634e-01 -1.54197983e-01 -1.68986198e-01]
 [-2.18066840e-01 -9.64967603e-02  1.19996816e-01]
 [ 5.07821674e-02  1.81426317e-02 -2.39321551e-02]
 [-5.71764156e-02 -6.08998404e-02  2.80807027e-02]
 [ 1.85388562e-01 -2.31456186e-01  5.75735291e-02]
 [ 4.66710494e-02 -5.99940652e-03  3.01830908e-01]
 [-2.97567055e-02  4.57557381e-01 -4.38820841e-01]
 [ 2.48893080e-01  1.54535139e-01  8.18474445e-02]
 [ 2.58893249e-02  1.26442388e-01 -2.69257980e-02]
 [-1.48963930e-02 -1.52195619e-01 -8.92154157e-02]
 [ 4.35886612e-02  1.78478689e-03 -1.25923506e-02]
 [-1.09669290e-02  1.62164971e-02  3.51010931e-02]
 [ 8.49850580e-02 -2.94376718e-02  3.00169156e-02]
 [ 1.49165621e-01 -6.84579657e-02  1.03916472e-01]
 [-4.86032636e-02 -2.35290357e-02 -1.68290614e-02]
 [-6.37432917e-02 -1.41262686e-02  3.81431170e-02]
 [-2.36453950e-02 -5.22006383e-02 -3.09792851e-02]
 [ 2.62958045e-02 -4.33551522e-02 -1.00192863e-01]
 [ 2.37323935e-02  6.58155636e-03  1.53463481e-01]
 [ 3.98750259e-03 -8.37480774e-02 -1.06486253e-01]
 [ 1.22306226e-02  8.11554694e-02  1.24338637e-02]
 [ 2.16601772e-02  2.39716894e-02  1.09472434e-01]
 [ 3.80494906e-01 -2.39550239e-01  2.23604204e-01]
 [-1.05173161e-01  3.92660435e-02  4.49727957e-02]
 [ 1.95089148e-01 -1.22504632e-02  9.16799750e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.60103991]
curr_Stock_Price:  100.02614295374327
curr_Factors:  [100.02614295  -0.96812054  -1.00738124]
mat_Sqrt:  [[13.87279606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00394893 -0.02665368  0.03673324]
Stock Position:  -0.003948932097409714
Bond Position:  [2.99603636]


portfolio before change:  [2.59543417]
curr_Stock_Price:  101.54054565540729
curr_Factors:  [101.54054566  -1.04450085  -1.01359927]
mat_Sqrt:  [[12.9663568   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0030336   0.01763153  0.06360571]
Stock Position:  -0.0030336028126233972
Bond Position:  [2.90346785]


portfolio before change:  [2.59458373]
curr_Stock_Price:  101.94053184206281
curr_Factors:  [101.94053184  -1.00958647  -1.0236803 ]
mat_Sqrt:  [[13.34474739  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00784739 -0.00600835 -0.11383679]
Stock Position:  -0.007847392880163773
Bond Position:  [3.39455113]


portfolio before change:  [2.59479796]
curr_Stock_Price:  101.96730690438321
curr_Factors:  [101.9673069   -1.08862323  -1.024558  ]
mat_Sqrt:  [[12.32304406  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03984878 -0.06014939 -0.68618648]
Stock Position:  -0.039848777274297635
Bond Position:  [6.65807046]


portfolio before change:  [2.60500751]
curr_Stock_Price:  101.73198621159962
curr_Factors:  [101.73198621  -1.17182619  -1.04116688]
mat_Sqrt:  [[11.12671201  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01174051 -0.06456596 -0.29879769]
Stock Position:  0.011740510470884745
Bond Position:  [1.41062206]


portfolio before change:  [2.60632133]
curr_Stock_Price:  101.82887158725285
curr_Factors:  [101.82887159  -1.15331614  -1.04139398]
mat_Sqrt:  [[11.34280414  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01351555 -0.05534923  0.15513819]
Stock Position:  -0.013515546439723082
Bond Position:  [3.98259418]


portfolio before change:  [2.61847216]
curr_Stock_Price:  100.96668096893318
curr_Factors:  [100.96668097  -1.01143903  -1.0434843 ]
mat_Sqrt:  [[12.93410004  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00687346 -0.04840066 -0.07689409]
Stock Position:  -0.006873464982657393
Bond Position:  [3.31246311]


portfolio before change:  [2.61558861]
curr_Stock_Price:  101.44644398401748
curr_Factors:  [101.44644398  -1.11293035  -1.04278219]
mat_Sqrt:  [[11.74959152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01312241 0.19655466 0.24424485]
Stock Position:  0.013122412852292951
Bond Position:  [1.28436649]


portfolio before change:  [2.62616046]
curr_Stock_Price:  102.23984157126041
curr_Factors:  [102.23984157  -1.12668091  -1.06906267]
mat_Sqrt:  [[11.37681901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03790753 0.00772661 1.01985421]
Stock Position:  0.03790753140856267
Bond Position:  [-1.24949954]


portfolio before change:  [2.63755051]
curr_Stock_Price:  102.54443142982088
curr_Factors:  [102.54443143  -1.22347823  -1.04455926]
mat_Sqrt:  [[10.61490016  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06709055 0.08013313 1.35397799]
Stock Position:  0.06709055099312744
Bond Position:  [-4.24221189]


portfolio before change:  [2.65297328]
curr_Stock_Price:  102.78221563105001
curr_Factors:  [102.78221563  -1.16327515  -1.03274774]
mat_Sqrt:  [[11.433978    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01299294 -0.05893483  0.05877085]
Stock Position:  -0.01299293736138474
Bond Position:  [3.98841617]


portfolio before change:  [2.65016121]
curr_Stock_Price:  103.03701964674352
curr_Factors:  [103.03701965  -1.36906426  -1.06400912]
mat_Sqrt:  [[ 9.04321684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.003891   -0.00636458  0.24261328]
Stock Position:  -0.003891002591770659
Bond Position:  [3.05107852]


portfolio before change:  [2.65271637]
curr_Stock_Price:  102.47835920531523
curr_Factors:  [102.47835921  -1.388708    -1.0608445 ]
mat_Sqrt:  [[ 8.84718338  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00128723 -0.01252875  0.07449472]
Stock Position:  0.0012872316402163927
Bond Position:  [2.52080298]


portfolio before change:  [2.6533865]
curr_Stock_Price:  102.75415742879892
curr_Factors:  [102.75415743  -1.21796396  -1.08171247]
mat_Sqrt:  [[10.3053469   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00166149  0.05343128 -0.23162134]
Stock Position:  0.0016614867273937696
Bond Position:  [2.48266183]


portfolio before change:  [2.65370687]
curr_Stock_Price:  102.76018505338766
curr_Factors:  [102.76018505  -1.08619847  -1.07146468]
mat_Sqrt:  [[11.87855673  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02176905 -0.04976718 -0.48207059]
Stock Position:  0.021769053730213928
Bond Position:  [0.41671488]


portfolio before change:  [2.66074222]
curr_Stock_Price:  103.08097362717139
curr_Factors:  [103.08097363  -1.05274911  -1.08938525]
mat_Sqrt:  [[12.10211785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01762253 -0.0311442   0.34231752]
Stock Position:  -0.017622528072492295
Bond Position:  [4.47728958]


portfolio before change:  [2.64662259]
curr_Stock_Price:  103.91396031622087
curr_Factors:  [103.91396032  -0.87283918  -1.10061967]
mat_Sqrt:  [[14.44147679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00343458  0.00585551 -0.06827178]
Stock Position:  0.0034345785114962986
Bond Position:  [2.28972193]


portfolio before change:  [2.64831475]
curr_Stock_Price:  104.32330583844508
curr_Factors:  [104.32330584  -0.82971179  -1.10416179]
mat_Sqrt:  [[15.08379828  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00423472 -0.01965534  0.08010643]
Stock Position:  -0.004234715476014891
Bond Position:  [3.09009427]


portfolio before change:  [2.64473626]
curr_Stock_Price:  105.25956183637867
curr_Factors:  [105.25956184  -0.93523071  -1.11249644]
mat_Sqrt:  [[13.581413    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01103677 -0.07470216  0.16424125]
Stock Position:  0.011036768663626354
Bond Position:  [1.48301083]


portfolio before change:  [2.63475677]
curr_Stock_Price:  104.33856029756103
curr_Factors:  [104.3385603   -0.91164664  -1.07980884]
mat_Sqrt:  [[14.24186011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00751709 -0.0019363   0.86103957]
Stock Position:  0.00751709404454771
Bond Position:  [1.850434]


portfolio before change:  [2.62986063]
curr_Stock_Price:  103.65645439306554
curr_Factors:  [103.65645439  -1.03619583  -1.08107874]
mat_Sqrt:  [[12.47600915  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207856  0.14767601 -1.25183372]
Stock Position:  -0.0020785593465822987
Bond Position:  [2.84531672]


portfolio before change:  [2.63126569]
curr_Stock_Price:  103.15159766507546
curr_Factors:  [103.15159767  -0.81961255  -1.0675487 ]
mat_Sqrt:  [[15.62759836  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01901408 0.049876   0.23348798]
Stock Position:  0.019014084303394727
Bond Position:  [0.66993252]


portfolio before change:  [2.61751421]
curr_Stock_Price:  102.42396704914952
curr_Factors:  [102.42396705  -0.58324547  -1.069669  ]
mat_Sqrt:  [[19.61326793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0023557   0.04080911 -0.07681181]
Stock Position:  0.0023557045076266574
Bond Position:  [2.37623361]


portfolio before change:  [2.61941193]
curr_Stock_Price:  103.10345643947672
curr_Factors:  [103.10345644  -0.79133743  -1.09266888]
mat_Sqrt:  [[15.66966378  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00409544 -0.04912092 -0.25450675]
Stock Position:  -0.00409544295304003
Bond Position:  [3.04166626]


portfolio before change:  [2.61942726]
curr_Stock_Price:  103.19255642471549
curr_Factors:  [103.19255642  -1.02209679  -1.07179445]
mat_Sqrt:  [[12.71402205  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00325488  0.00057604 -0.03592247]
Stock Position:  0.0032548768890551345
Bond Position:  [2.2835482]


portfolio before change:  [2.62157483]
curr_Stock_Price:  103.76465255949304
curr_Factors:  [103.76465256  -1.05937533  -1.06795908]
mat_Sqrt:  [[12.36402407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.97742504e-05  5.23385195e-03  1.00133648e-01]
Stock Position:  -3.9774250424509155e-05
Bond Position:  [2.62570199]


portfolio before change:  [2.6219104]
curr_Stock_Price:  103.58000153906606
curr_Factors:  [103.58000154  -0.71794908  -1.05306745]
mat_Sqrt:  [[17.62516558  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00482851 -0.00950097  0.08562991]
Stock Position:  0.00482851042118274
Bond Position:  [2.12177329]


portfolio before change:  [2.61837935]
curr_Stock_Price:  102.79377716839295
curr_Factors:  [102.79377717  -0.51296492  -1.05433096]
mat_Sqrt:  [[21.44365801  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0072937  -0.02209471  0.29644477]
Stock Position:  0.0072936976778614875
Bond Position:  [1.86863262]


portfolio before change:  [2.61670431]
curr_Stock_Price:  102.53209447128302
curr_Factors:  [102.53209447  -0.47274465  -1.04894592]
mat_Sqrt:  [[22.38710876  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253902 -0.00759396 -0.04800863]
Stock Position:  -0.002539020391601189
Bond Position:  [2.87703539]


portfolio before change:  [2.61405203]
curr_Stock_Price:  103.71835272653189
curr_Factors:  [103.71835273  -0.59116172  -1.06156874]
mat_Sqrt:  [[19.86478591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296207 -0.00455923  0.1088117 ]
Stock Position:  -0.002962069325523958
Bond Position:  [2.92127298]


portfolio before change:  [2.61454792]
curr_Stock_Price:  103.6742242911452
curr_Factors:  [103.67422429  -0.66961951  -1.0699368 ]
mat_Sqrt:  [[18.20501703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0022315  -0.01684768 -0.08837528]
Stock Position:  -0.002231496172130527
Bond Position:  [2.84589655]


portfolio before change:  [2.61485221]
curr_Stock_Price:  103.69728776002017
curr_Factors:  [103.69728776  -0.89407225  -1.07641709]
mat_Sqrt:  [[14.45422299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.07953855e-04 -1.39928152e-02 -2.85822350e-01]
Stock Position:  -0.0002079538546860888
Bond Position:  [2.63641646]


portfolio before change:  [2.61530942]
curr_Stock_Price:  103.08352162816671
curr_Factors:  [103.08352163  -0.87973879  -1.06837163]
mat_Sqrt:  [[14.69385122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00383844 0.00212419 0.4377886 ]
Stock Position:  0.0038384388920466475
Bond Position:  [2.21962962]


portfolio before change:  [2.61764606]
curr_Stock_Price:  103.61998102953913
curr_Factors:  [103.61998103  -0.80622884  -1.07921969]
mat_Sqrt:  [[15.72546941  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221576 -0.02702958 -0.30377564]
Stock Position:  -0.0022157632703577977
Bond Position:  [2.84724341]


portfolio before change:  [2.61769239]
curr_Stock_Price:  103.75970558957445
curr_Factors:  [103.75970559  -0.98788907  -1.0598776 ]
mat_Sqrt:  [[13.38736082  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0023406  0.02619282 0.03547035]
Stock Position:  0.002340600636022014
Bond Position:  [2.37483236]


portfolio before change:  [2.62113375]
curr_Stock_Price:  105.10316024139384
curr_Factors:  [105.10316024  -1.12785572  -1.08730859]
mat_Sqrt:  [[11.47049441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00426305 0.00773683 0.31229438]
Stock Position:  0.004263054673091853
Bond Position:  [2.17307323]


portfolio before change:  [2.62159727]
curr_Stock_Price:  105.14816708722438
curr_Factors:  [105.14816709  -1.07538008  -1.11835291]
mat_Sqrt:  [[11.7239936   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03217674 -0.07731451  0.63788055]
Stock Position:  0.03217674354433329
Bond Position:  [-0.76172834]


portfolio before change:  [2.63127788]
curr_Stock_Price:  105.45198367112229
curr_Factors:  [105.45198367  -1.14553002  -1.12795048]
mat_Sqrt:  [[10.85662202  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00810362  0.01267306  0.12829487]
Stock Position:  -0.00810362375056028
Bond Position:  [3.48582108]


portfolio before change:  [2.63759606]
curr_Stock_Price:  104.72608230397582
curr_Factors:  [104.7260823   -1.00851227  -1.13453826]
mat_Sqrt:  [[12.28400076  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01720145 -0.00395382  0.26153745]
Stock Position:  0.017201450376216426
Bond Position:  [0.83615556]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.63220026]
Stock Price:  104.40632258827391
PL:  [-1.77412233]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-7.95187996e-02 -8.75268690e-02  1.43978153e-02]
 [-1.74091733e-01  6.58493245e-02 -1.97803664e-01]
 [-4.33939128e-03  1.56344443e-02  4.34206198e-02]
 [ 9.99700176e-02  2.49677064e-02  1.29915220e-01]
 [ 1.21658373e-01 -9.64224122e-02 -9.15312012e-02]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.23897557e-02 -1.67156829e-01 -2.73717036e-02]
 [ 9.62197978e-03  6.35683091e-01  9.36123064e-02]
 [ 2.87571957e-01 -3.47789135e-03  3.00883308e-01]
 [ 4.23633633e-01  1.68695718e-01  2.88470379e-01]
 [-9.74163330e-02 -9.56172158e-02  8.59677129e-02]
 [-2.94367725e-02 -1.76779162e-02  9.36482783e-02]
 [ 1.44557486e-02 -5.73081473e-02  6.67836107e-02]
 [ 4.74883101e-03  3.09800430e-02 -6.29943468e-02]
 [ 1.21502294e-01 -1.50299651e-01 -1.07737632e-01]
 [ 8.75362597e-03 -2.98881082e-02  6.73454949e-02]
 [ 4.46447648e-02  2.91577480e-02  1.19640737e-02]
 [-3.09635414e-02 -4.53344706e-02  6.54894673e-02]
 [ 1.03708640e-01 -8.72771002e-02 -5.25659504e-02]
 [ 5.13515707e-02 -1.32263657e-02  1.71127903e-01]
 [-1.18897833e-02  2.97607460e-01 -2.81322275e-01]
 [-1.09289782e-01 -1.68541529e-02  1.40174999e-01]
 [-2.91817495e-02  5.65838804e-02  1.45423214e-02]
 [ 1.61660424e-01 -2.24695060e-01 -3.85805854e-01]
 [ 7.20202732e-02  4.12228855e-02 -1.58457894e-02]
 [ 7.59807314e-03  2.10517213e-02  1.30475950e-03]
 [ 8.40515280e-02 -2.97029551e-02  2.88405567e-02]
 [ 1.54251857e-01 -6.41997888e-02  1.35042234e-01]
 [-4.44654345e-02 -1.17242446e-02 -3.86177893e-02]
 [-5.31098126e-02 -1.06676689e-02  3.23725550e-02]
 [-2.59114745e-02 -4.37934157e-02 -1.37268191e-02]
 [ 2.60000735e-02 -9.05537428e-03 -4.55536729e-02]
 [ 2.12627643e-01 -2.69345832e-02  4.20718450e-01]
 [ 8.34653743e-03 -7.54114521e-02 -4.87727350e-02]
 [-3.95888101e-02 -9.25825428e-02  8.35612058e-02]
 [ 8.49706663e-02  2.82132268e-02  1.88616156e-01]
 [ 2.32179869e-01 -1.24956597e-01  7.74150694e-02]
 [-5.46750431e-02 -1.47074351e-03  2.52230617e-02]
 [ 9.62722728e-03 -5.40123312e-03  6.90054204e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.34611282]
curr_Stock_Price:  100.12007611732953
curr_Factors:  [100.12007612  -0.88329868  -1.01702158]
mat_Sqrt:  [[14.97002648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00630902 -0.02824918  0.04107296]
Stock Position:  -0.006309020578257554
Bond Position:  [3.97777245]


portfolio before change:  [3.34773728]
curr_Stock_Price:  99.9414102775473
curr_Factors:  [99.94141028 -0.99185906 -1.00629049]
mat_Sqrt:  [[13.55065069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01483521  0.02125278 -0.56427879]
Stock Position:  -0.014835213763896387
Bond Position:  [4.83038947]


portfolio before change:  [3.33792677]
curr_Stock_Price:  100.64341212400294
curr_Factors:  [100.64341212  -1.14886943  -1.00895761]
mat_Sqrt:  [[11.63196194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00066327 0.005046   0.12386694]
Stock Position:  0.0006632735939388408
Bond Position:  [3.27117266]


portfolio before change:  [3.33816683]
curr_Stock_Price:  100.3888204717135
curr_Factors:  [100.38882047  -0.96838486  -1.02164967]
mat_Sqrt:  [[13.72221869  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00958922 0.00805829 0.37061196]
Stock Position:  0.009589219175111234
Bond Position:  [2.37551643]


portfolio before change:  [3.34302264]
curr_Stock_Price:  100.86423437337737
curr_Factors:  [100.86423437  -0.98916719  -1.03191876]
mat_Sqrt:  [[13.36566958  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00623182 -0.0311202  -0.26111304]
Stock Position:  0.006231824147068268
Bond Position:  [2.71445447]


portfolio before change:  [3.3529082]
curr_Stock_Price:  102.3960870585721
curr_Factors:  [102.39608706  -1.14021856  -1.03738155]
mat_Sqrt:  [[11.6028225   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01321266 -0.05534923  0.15513819]
Stock Position:  -0.013212664087812456
Bond Position:  [4.7058333]


portfolio before change:  [3.36702621]
curr_Stock_Price:  101.37208878855313
curr_Factors:  [101.37208879  -1.11936386  -1.0459736 ]
mat_Sqrt:  [[11.62851581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00791999 -0.05394963 -0.07808385]
Stock Position:  -0.007919989752988518
Bond Position:  [4.16989212]


portfolio before change:  [3.36346817]
curr_Stock_Price:  101.88715454981823
curr_Factors:  [101.88715455  -1.25320733  -1.08612583]
mat_Sqrt:  [[ 9.82109587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01613759 0.20516584 0.26704985]
Stock Position:  0.016137586018718255
Bond Position:  [1.71925545]


portfolio before change:  [3.35716432]
curr_Stock_Price:  101.48320496483399
curr_Factors:  [101.48320496  -1.17204049  -1.07747712]
mat_Sqrt:  [[10.70141213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0325452  -0.00112248  0.85833633]
Stock Position:  0.032545198665968125
Bond Position:  [0.05437325]


portfolio before change:  [3.34262756]
curr_Stock_Price:  101.03633239746632
curr_Factors:  [101.0363324   -1.17345526  -1.12073797]
mat_Sqrt:  [[10.1887783   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05073741 0.05444631 0.8229257 ]
Stock Position:  0.050737414859135646
Bond Position:  [-1.78369476]


portfolio before change:  [3.33648067]
curr_Stock_Price:  100.91957607600992
curr_Factors:  [100.91957608  -1.14346804  -1.12980043]
mat_Sqrt:  [[10.39219929  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00956352 -0.03086032  0.24524196]
Stock Position:  -0.009563522288169092
Bond Position:  [4.30162728]


portfolio before change:  [3.33308048]
curr_Stock_Price:  101.33134123620431
curr_Factors:  [101.33134124  -1.02297413  -1.12187869]
mat_Sqrt:  [[11.86440731  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00117405 -0.00570552  0.26715247]
Stock Position:  -0.0011740483054696205
Bond Position:  [3.45204837]


portfolio before change:  [3.3337284]
curr_Stock_Price:  101.14703252563207
curr_Factors:  [101.14703253  -1.26171276  -1.08535091]
mat_Sqrt:  [[ 9.67467418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00169411 -0.01849613  0.19051505]
Stock Position:  0.0016941055788117154
Bond Position:  [3.16237465]


portfolio before change:  [3.3350204]
curr_Stock_Price:  101.67632546284497
curr_Factors:  [101.67632546  -1.23224747  -1.08296907]
mat_Sqrt:  [[10.04000838  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.77894411e-04  9.99876589e-03 -1.79705337e-01]
Stock Position:  -0.0001778944111707651
Bond Position:  [3.35310805]


portfolio before change:  [3.33550376]
curr_Stock_Price:  101.31544618627899
curr_Factors:  [101.31544619  -1.18778239  -1.06964883]
mat_Sqrt:  [[10.5995088   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00649376 -0.048509   -0.30734547]
Stock Position:  0.006493758860661231
Bond Position:  [2.67758569]


portfolio before change:  [3.3365677]
curr_Stock_Price:  101.42774226907055
curr_Factors:  [101.42774227  -1.54948649  -1.0821868 ]
mat_Sqrt:  [[ 7.29853291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00224697 -0.00964635  0.19211795]
Stock Position:  0.002246969798943617
Bond Position:  [3.10866263]


portfolio before change:  [3.33731924]
curr_Stock_Price:  101.58925962761616
curr_Factors:  [101.58925963  -1.6121859   -1.06901366]
mat_Sqrt:  [[ 6.95692981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00762387 0.00941062 0.03413017]
Stock Position:  0.007623869003586756
Bond Position:  [2.56281603]


portfolio before change:  [3.34134817]
curr_Stock_Price:  102.07570015402267
curr_Factors:  [102.07570015  -1.60831421  -1.09190107]
mat_Sqrt:  [[ 6.85857307  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00391472 -0.01463164  0.18682322]
Stock Position:  -0.003914723895773375
Bond Position:  [3.74094635]


portfolio before change:  [3.34149569]
curr_Stock_Price:  102.15747398654362
curr_Factors:  [102.15747399  -1.70638228  -1.08568048]
mat_Sqrt:  [[ 6.26170635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01200364 -0.02816856 -0.14995602]
Stock Position:  0.01200364453957848
Bond Position:  [2.11523369]


portfolio before change:  [3.34255982]
curr_Stock_Price:  102.22409573019681
curr_Factors:  [102.22409573  -1.797275    -1.08852808]
mat_Sqrt:  [[ 5.70512188  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01465053 -0.00426879  0.48818027]
Stock Position:  0.014650534855013594
Bond Position:  [1.84492214]


portfolio before change:  [3.34384623]
curr_Stock_Price:  102.29616049884555
curr_Factors:  [102.2961605   -1.82704293  -1.10251397]
mat_Sqrt:  [[ 5.46473285  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00156743  0.09605239 -0.80253415]
Stock Position:  -0.001567429578628993
Bond Position:  [3.50418826]


portfolio before change:  [3.34358852]
curr_Stock_Price:  102.74004734133666
curr_Factors:  [102.74004734  -1.98985798  -1.11693334]
mat_Sqrt:  [[ 4.59703103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01829812 -0.00543965  0.39988026]
Stock Position:  -0.01829811877172472
Bond Position:  [5.22353811]


portfolio before change:  [3.35004067]
curr_Stock_Price:  102.42312079526249
curr_Factors:  [102.4231208   -2.26897619  -1.09439561]
mat_Sqrt:  [[ 3.54571801  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00413546  0.01826237  0.0414852 ]
Stock Position:  -0.004135459809877566
Bond Position:  [3.77360737]


portfolio before change:  [3.3500798]
curr_Stock_Price:  102.52772642652461
curr_Factors:  [102.52772643  -2.10135792  -1.11677935]
mat_Sqrt:  [[ 4.10413905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00902563 -0.07252002 -1.10059671]
Stock Position:  0.009025631459918602
Bond Position:  [2.42470233]


portfolio before change:  [3.35137117]
curr_Stock_Price:  102.6372212941084
curr_Factors:  [102.63722129  -2.04789317  -1.13594821]
mat_Sqrt:  [[ 4.2518716   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01815679  0.01330463 -0.04520363]
Stock Position:  0.018156792708773167
Bond Position:  [1.48780842]


portfolio before change:  [3.35163438]
curr_Stock_Price:  102.64147414982551
curr_Factors:  [102.64147415  -2.27577759  -1.12708302]
mat_Sqrt:  [[ 3.41569666  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00356049 0.00679441 0.00372212]
Stock Position:  0.0035604949398301074
Bond Position:  [2.98617993]


portfolio before change:  [3.35194501]
curr_Stock_Price:  102.62387599131308
curr_Factors:  [102.62387599  -2.24124476  -1.12651371]
mat_Sqrt:  [[ 3.53711756  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02371295 -0.00958659  0.08227408]
Stock Position:  0.023712949911593936
Bond Position:  [0.91843018]


portfolio before change:  [3.35883102]
curr_Stock_Price:  102.90942454467553
curr_Factors:  [102.90942454  -2.39033276  -1.13214333]
mat_Sqrt:  [[ 3.03852787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05552442 -0.02072039  0.38523791]
Stock Position:  0.05552442417511148
Bond Position:  [-2.35515552]


portfolio before change:  [3.36040067]
curr_Stock_Price:  102.94299637028504
curr_Factors:  [102.94299637  -2.66267408  -1.14669105]
mat_Sqrt:  [[ 2.28144787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02399417 -0.00378398 -0.1101658 ]
Stock Position:  -0.023994174853124543
Bond Position:  [5.83043292]


portfolio before change:  [3.35898939]
curr_Stock_Price:  103.03218982910728
curr_Factors:  [103.03218983  -2.42546743  -1.1355987 ]
mat_Sqrt:  [[ 2.92699216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01663118 -0.00344298  0.09234989]
Stock Position:  -0.016631175861740902
Bond Position:  [5.07253586]


portfolio before change:  [3.35905942]
curr_Stock_Price:  103.06610706188934
curr_Factors:  [103.06610706  -2.44276775  -1.11878343]
mat_Sqrt:  [[ 2.92653585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01286598 -0.01413426 -0.03915879]
Stock Position:  -0.012865977124306758
Bond Position:  [4.68510559]


portfolio before change:  [3.36052218]
curr_Stock_Price:  102.99793580942814
curr_Factors:  [102.99793581  -2.2684892   -1.11306468]
mat_Sqrt:  [[ 3.50137261  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00424206 -0.00292261 -0.12995195]
Stock Position:  0.004242064488409235
Bond Position:  [2.9235983]


portfolio before change:  [3.36067065]
curr_Stock_Price:  102.94678066301212
curr_Factors:  [102.94678066  -2.421108    -1.12001965]
mat_Sqrt:  [[ 2.98346243  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.09821087 -0.0086931   1.20019263]
Stock Position:  0.09821086904319704
Bond Position:  [-6.74982214]


portfolio before change:  [3.36629472]
curr_Stock_Price:  103.01263737553217
curr_Factors:  [103.01263738  -2.32748077  -1.08405148]
mat_Sqrt:  [[ 3.39844992  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.005003   -0.02433894 -0.13913504]
Stock Position:  -0.005003002551940166
Bond Position:  [3.8816672]


portfolio before change:  [3.36660725]
curr_Stock_Price:  103.0471568349218
curr_Factors:  [103.04715683  -2.26477197  -1.05225547]
mat_Sqrt:  [[ 3.73653712  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01108788 -0.02988089  0.23837686]
Stock Position:  -0.011087882014125115
Bond Position:  [4.50918197]


portfolio before change:  [3.37041649]
curr_Stock_Price:  102.75444465928463
curr_Factors:  [102.75444466  -2.02372283  -1.02643758]
mat_Sqrt:  [[ 4.86555939  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02656031 0.00910578 0.53806939]
Stock Position:  0.026560312662814476
Bond Position:  [0.64122632]


portfolio before change:  [3.37586154]
curr_Stock_Price:  102.95643368777522
curr_Factors:  [102.95643369  -2.10855302  -1.01809277]
mat_Sqrt:  [[ 4.51615121  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04926219 -0.04032957  0.22084364]
Stock Position:  0.04926218931750421
Bond Position:  [-1.69599778]


portfolio before change:  [3.36103284]
curr_Stock_Price:  102.65972158524274
curr_Factors:  [102.65972159  -2.02270742  -1.01910378]
mat_Sqrt:  [[ 4.90183023  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0101649  -0.00047468  0.07195437]
Stock Position:  -0.010164901485515037
Bond Position:  [4.4045588]


portfolio before change:  [3.35927409]
curr_Stock_Price:  102.88691054686221
curr_Factors:  [102.88691055  -1.99017056  -1.04328443]
mat_Sqrt:  [[ 4.9539015   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00456416 -0.00174324  0.19685326]
Stock Position:  0.004564155678236105
Bond Position:  [2.88968222]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.35844539]
Stock Price:  102.62619661881195
PL:  [0.73224877]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.04189010e-01 -9.06567692e-02  1.53609814e-02]
 [-2.76698935e-01  6.09675379e-02 -3.62109906e-01]
 [-2.12864682e-02  5.69256990e-02  3.42370812e-02]
 [ 9.79166211e-02  7.29901984e-02  9.05777731e-02]
 [-7.66527329e-02  1.99448797e-01 -4.12660637e-02]
 [-6.83367807e-02 -1.49434276e-01  1.70144242e-01]
 [-6.07362770e-02 -1.84377626e-01  9.03334726e-02]
 [ 1.71896955e-02  6.89709645e-01  1.06017665e-01]
 [ 1.32668114e-01  9.62708870e-03  1.31593003e-01]
 [ 3.67352249e-01  1.43426992e-01  2.35147112e-01]
 [-5.82553794e-02 -1.12059514e-01  6.08884628e-02]
 [ 4.62733230e-02 -1.20213937e-02  1.19787927e-01]
 [ 1.39448888e-02 -3.87053416e-02  2.50807249e-02]
 [ 5.76488317e-03  5.98285137e-03 -5.53971545e-02]
 [ 1.03093042e-01 -1.31869270e-01 -9.90448160e-02]
 [ 3.18697857e-02 -2.33172863e-02  4.95882489e-02]
 [ 4.50412819e-02  2.84460981e-02  9.64493825e-03]
 [-4.22616419e-02 -5.20774466e-02  4.93167456e-02]
 [ 6.01464135e-02 -1.89716683e-02 -1.12062238e-01]
 [ 2.27979058e-02  5.89808487e-03  4.65316641e-02]
 [-2.27235410e-02  3.91122739e-01 -3.56229283e-01]
 [-3.11109055e-04  3.52917746e-02  1.22428590e-01]
 [-8.71475008e-03  4.64911087e-03  4.64869111e-02]
 [ 7.44279488e-03 -9.29713495e-02 -1.46745160e-01]
 [ 5.01996179e-02  1.88511418e-02 -1.38096041e-02]
 [-3.40818050e-02  4.02666072e-04  1.32860623e-01]
 [ 1.34327379e-02 -3.29617172e-02  6.58666587e-03]
 [ 1.87909824e-02 -3.27795737e-02 -2.31961975e-01]
 [-5.13136322e-02 -3.99965850e-02  1.59200990e-02]
 [-6.80904695e-02 -5.72253380e-04  2.50852301e-02]
 [-4.93155058e-03 -4.29243696e-02 -3.81300846e-02]
 [ 2.68195682e-02  7.12563168e-03 -2.69647089e-02]
 [ 4.07064001e-02  1.20174025e-02  1.47045255e-01]
 [ 1.78354671e-02 -6.12067715e-02  3.45447746e-02]
 [-5.42458208e-02  1.10688723e-02  1.06670404e-02]
 [ 7.98314774e-02 -3.61773783e-02  1.18919591e-01]
 [-2.41147618e-02  5.02067042e-02 -1.88417808e-02]
 [-6.49645645e-02 -9.69178030e-03  3.66627911e-02]
 [ 9.48353778e-02  5.61302245e-03  8.42779082e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.49838225]
curr_Stock_Price:  100.26534554143471
curr_Factors:  [100.26534554  -1.05235859  -1.04170398]
mat_Sqrt:  [[12.35125342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00967988 -0.02925935  0.0438206 ]
Stock Position:  -0.009679883868360162
Bond Position:  [5.46893915]


portfolio before change:  [4.50969879]
curr_Stock_Price:  99.16689410765866
curr_Factors:  [99.16689411 -1.10793897 -1.03979637]
mat_Sqrt:  [[11.57756178  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02920903  0.01967719 -1.03299877]
Stock Position:  -0.02920903119666613
Bond Position:  [7.4062677]


portfolio before change:  [4.52014263]
curr_Stock_Price:  98.84103606798696
curr_Factors:  [98.84103607 -1.27733099 -1.06017367]
mat_Sqrt:  [[ 9.54491163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00028056  0.01837269  0.09766886]
Stock Position:  -0.00028056243664651055
Bond Position:  [4.54787372]


portfolio before change:  [4.52079261]
curr_Stock_Price:  98.55071522817528
curr_Factors:  [98.55071523 -0.98527303 -1.06460297]
mat_Sqrt:  [[12.6884901   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01034834 0.02355749 0.25839317]
Stock Position:  0.010348338731567541
Bond Position:  [3.50095642]


portfolio before change:  [4.52254176]
curr_Stock_Price:  98.6774507424938
curr_Factors:  [98.67745074 -1.09763194 -1.06398771]
mat_Sqrt:  [[11.36157225  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00390473  0.06437182 -0.11772059]
Stock Position:  -0.0039047252218914253
Bond Position:  [4.90785009]


portfolio before change:  [4.52218048]
curr_Stock_Price:  98.92709487090615
curr_Factors:  [98.92709487 -1.01327004 -1.06174459]
mat_Sqrt:  [[12.4207509   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00516147 -0.04822971  0.48537416]
Stock Position:  -0.005161473491414893
Bond Position:  [5.03279006]


portfolio before change:  [4.51966631]
curr_Stock_Price:  99.53608891887497
curr_Factors:  [99.53608892 -1.16832962 -1.0785535 ]
mat_Sqrt:  [[10.52377691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00759546 -0.05950762  0.25769625]
Stock Position:  -0.0075954631177612185
Bond Position:  [5.27568901]


portfolio before change:  [4.51850954]
curr_Stock_Price:  99.7752158792382
curr_Factors:  [99.77521588 -1.40067389 -1.09864632]
mat_Sqrt:  [[ 8.19561784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02191621 0.22260283 0.30243889]
Stock Position:  0.021916206441088965
Bond Position:  [2.33181531]


portfolio before change:  [4.52595512]
curr_Stock_Price:  100.10164508426354
curr_Factors:  [100.10164508  -1.37741053  -1.10973508]
mat_Sqrt:  [[ 8.32314772  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01940306 0.00310713 0.37539821]
Stock Position:  0.019403061160844337
Bond Position:  [2.58367678]


portfolio before change:  [4.54097591]
curr_Stock_Price:  100.85914428373202
curr_Factors:  [100.85914428  -1.43392124  -1.11758344]
mat_Sqrt:  [[ 7.86340916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05654397 0.04629086 0.67080926]
Stock Position:  0.05654396902625363
Bond Position:  [-1.16200043]


portfolio before change:  [4.53145209]
curr_Stock_Price:  100.69328116774199
curr_Factors:  [100.69328117  -1.47730058  -1.10391146]
mat_Sqrt:  [[ 7.62069093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00901501 -0.03616705  0.17369784]
Stock Position:  -0.009015012824242557
Bond Position:  [5.43920331]


portfolio before change:  [4.52979641]
curr_Stock_Price:  100.95236191889865
curr_Factors:  [100.95236192  -1.61008019  -1.12956904]
mat_Sqrt:  [[ 6.52081597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01046971 -0.00387989  0.34172161]
Stock Position:  0.010469713421285786
Bond Position:  [3.47285412]


portfolio before change:  [4.53324895]
curr_Stock_Price:  101.2406606218037
curr_Factors:  [101.24066062  -1.61563809  -1.12777728]
mat_Sqrt:  [[ 6.51485593  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00171359 -0.0124921   0.07154833]
Stock Position:  0.0017135874766623512
Bond Position:  [4.35976422]


portfolio before change:  [4.53422109]
curr_Stock_Price:  101.48992286523341
curr_Factors:  [101.48992287  -1.41117186  -1.1621465 ]
mat_Sqrt:  [[ 7.74185366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055823  0.00193096 -0.15803266]
Stock Position:  -0.0005582344234617092
Bond Position:  [4.59087626]


portfolio before change:  [4.53503371]
curr_Stock_Price:  101.06227598375683
curr_Factors:  [101.06227598  -1.20455673  -1.13306313]
mat_Sqrt:  [[ 9.75828885  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0057344  -0.04256062 -0.28254729]
Stock Position:  0.005734396874165651
Bond Position:  [3.95550251]


portfolio before change:  [4.53291805]
curr_Stock_Price:  100.60710468602629
curr_Factors:  [100.60710469  -1.10668367  -1.12636085]
mat_Sqrt:  [[10.78523808  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00345216 -0.00752562  0.14146147]
Stock Position:  0.003452155920511091
Bond Position:  [4.18560664]


portfolio before change:  [4.53267624]
curr_Stock_Price:  100.3854932916192
curr_Factors:  [100.38549329  -1.30526247  -1.12508312]
mat_Sqrt:  [[ 8.83456727  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0059784  0.00918094 0.02751432]
Stock Position:  0.005978400583042337
Bond Position:  [3.93253155]


portfolio before change:  [4.53212289]
curr_Stock_Price:  100.21070481679286
curr_Factors:  [100.21070482  -1.39749798  -1.14260644]
mat_Sqrt:  [[ 7.90243232  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00541924 -0.01680792  0.14068695]
Stock Position:  -0.005419238765738368
Bond Position:  [5.07518862]


portfolio before change:  [4.53391328]
curr_Stock_Price:  99.99739818878929
curr_Factors:  [99.99739819 -1.44680046 -1.12967049]
mat_Sqrt:  [[ 7.60399085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00439233 -0.00612308 -0.31968237]
Stock Position:  0.004392328988027666
Bond Position:  [4.09469181]


portfolio before change:  [4.53424383]
curr_Stock_Price:  99.95611671143185
curr_Factors:  [99.95611671 -1.34631139 -1.12386312]
mat_Sqrt:  [[ 8.45329871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00396296 0.0019036  0.13274189]
Stock Position:  0.003962959866575643
Bond Position:  [4.13812175]


portfolio before change:  [4.53567032]
curr_Stock_Price:  100.18553877686722
curr_Factors:  [100.18553878  -1.36237494  -1.12301232]
mat_Sqrt:  [[ 8.34478331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00186954  0.12623432 -1.01622299]
Stock Position:  -0.001869544543683219
Bond Position:  [4.72297165]


portfolio before change:  [4.5362802]
curr_Stock_Price:  100.17512383604726
curr_Factors:  [100.17512384  -1.40202779  -1.13640465]
mat_Sqrt:  [[ 7.91284552  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00402932 0.01139037 0.34925469]
Stock Position:  0.004029324919434438
Bond Position:  [4.13264208]


portfolio before change:  [4.53679053]
curr_Stock_Price:  100.17356544672715
curr_Factors:  [100.17356545  -1.47039276  -1.16551925]
mat_Sqrt:  [[ 7.17779571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00024009 0.00150049 0.13261422]
Stock Position:  0.00024009414196001858
Bond Position:  [4.51273945]


portfolio before change:  [4.53735487]
curr_Stock_Price:  100.17442405170891
curr_Factors:  [100.17442405  -1.08562048  -1.17960383]
mat_Sqrt:  [[10.39878107  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00398981 -0.03000637 -0.4186231 ]
Stock Position:  -0.003989807316366358
Bond Position:  [4.93703152]


portfolio before change:  [4.53589229]
curr_Stock_Price:  100.6956882337078
curr_Factors:  [100.69568823  -1.11566382  -1.18832732]
mat_Sqrt:  [[10.05542052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00509464  0.00608418 -0.03939496]
Stock Position:  0.005094637001156392
Bond Position:  [4.02288431]


portfolio before change:  [4.53554421]
curr_Stock_Price:  100.52865578745246
curr_Factors:  [100.52865579  -1.10585412  -1.18540329]
mat_Sqrt:  [[10.16738859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.76629001e-04  1.29959916e-04  3.79014377e-01]
Stock Position:  -0.0006766290007799529
Bond Position:  [4.60356482]


portfolio before change:  [4.53613081]
curr_Stock_Price:  100.51222190853612
curr_Factors:  [100.51222191  -0.86217882  -1.17146721]
mat_Sqrt:  [[13.1527822   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00061196 -0.01063835  0.01878992]
Stock Position:  0.0006119582165150394
Bond Position:  [4.47462153]


portfolio before change:  [4.53650238]
curr_Stock_Price:  100.20535141094474
curr_Factors:  [100.20535141  -1.1620292   -1.16236324]
mat_Sqrt:  [[ 9.80437934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00359525 -0.01057956 -0.66172295]
Stock Position:  -0.0035952464404148455
Bond Position:  [4.89676532]


portfolio before change:  [4.53710947]
curr_Stock_Price:  100.20675654777007
curr_Factors:  [100.20675655  -1.14350373  -1.15530418]
mat_Sqrt:  [[10.05859719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00559007 -0.01290884  0.04541561]
Stock Position:  -0.005590066215273411
Bond Position:  [5.09727187]


portfolio before change:  [4.53645811]
curr_Stock_Price:  100.43726358455343
curr_Factors:  [100.43726358  -1.13903971  -1.18199684]
mat_Sqrt:  [[ 9.86010424  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00639819 -0.00018469  0.07156118]
Stock Position:  -0.006398185819209366
Bond Position:  [5.17907439]


portfolio before change:  [4.53749475]
curr_Stock_Price:  100.37643254970456
curr_Factors:  [100.37643255  -1.06261158  -1.1751035 ]
mat_Sqrt:  [[10.71036938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200523 -0.01385378 -0.10877452]
Stock Position:  -0.002005226990672818
Bond Position:  [4.73877228]


portfolio before change:  [4.5368471]
curr_Stock_Price:  100.99483247944542
curr_Factors:  [100.99483248  -1.13267552  -1.18020265]
mat_Sqrt:  [[ 9.99606174  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227789  0.00229979 -0.07692281]
Stock Position:  0.002277890442852945
Bond Position:  [4.30679194]


portfolio before change:  [4.53693499]
curr_Stock_Price:  100.79706366501229
curr_Factors:  [100.79706367  -0.99452236  -1.1711389 ]
mat_Sqrt:  [[11.5588106   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00633066 0.0038786  0.41947918]
Stock Position:  0.006330662520554898
Bond Position:  [3.89882279]


portfolio before change:  [4.53460182]
curr_Stock_Price:  100.351526410725
curr_Factors:  [100.35152641  -1.0400974   -1.2083407 ]
mat_Sqrt:  [[10.59350619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00116988 -0.0197544   0.09854663]
Stock Position:  0.0011698779994728213
Bond Position:  [4.41720278]


portfolio before change:  [4.5348962]
curr_Stock_Price:  100.1311505441125
curr_Factors:  [100.13115054  -1.09771723  -1.21262781]
mat_Sqrt:  [[ 9.93571458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00501313  0.00357246  0.0304301 ]
Stock Position:  -0.005013126714956466
Bond Position:  [5.03686634]


portfolio before change:  [4.53858204]
curr_Stock_Price:  99.52151107310226
curr_Factors:  [99.52151107 -1.0272613  -1.23403778]
mat_Sqrt:  [[10.37163554  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00932555 -0.0116762   0.33924449]
Stock Position:  0.009325545664901165
Bond Position:  [3.61048965]


portfolio before change:  [4.54615323]
curr_Stock_Price:  100.28498871330832
curr_Factors:  [100.28498871  -0.94383341  -1.26760248]
mat_Sqrt:  [[10.98554291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00161234  0.01620414 -0.05375036]
Stock Position:  -0.0016123393913705889
Bond Position:  [4.70784667]


portfolio before change:  [4.54606852]
curr_Stock_Price:  100.70253213264428
curr_Factors:  [100.70253213  -1.20556635  -1.27710011]
mat_Sqrt:  [[ 8.41069809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00706946 -0.00312801  0.10458874]
Stock Position:  -0.007069464319974519
Bond Position:  [5.25798148]


portfolio before change:  [4.54575656]
curr_Stock_Price:  100.83963627576303
curr_Factors:  [100.83963628  -1.11538053  -1.31363569]
mat_Sqrt:  [[ 8.88634015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01273688 0.0018116  0.24042141]
Stock Position:  0.012736884392607596
Bond Position:  [3.26137377]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.54413287]
Stock Price:  100.6801480936382
PL:  [3.86398478]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 7.48910439e-02  5.21056926e-04 -2.10355224e-03]
 [-1.24278067e-01 -2.70528544e-02  2.33432784e-01]
 [-1.06292039e-02  6.00880897e-02  4.08968411e-02]
 [ 1.14354725e-01  6.28511430e-02  1.13119420e-01]
 [-1.20536052e-01  2.25568441e-01 -3.94993963e-02]
 [-3.82650256e-02 -1.28979739e-01  2.81278658e-01]
 [-6.45620758e-02 -2.50180791e-01 -1.23248981e-01]
 [-1.04788809e-02  8.08114166e-01  1.38727797e-01]
 [ 1.23546930e-03  1.34998297e-02 -3.35209997e-02]
 [ 2.82597891e-01  1.03262998e-01  1.48032351e-01]
 [-1.29431969e-01 -2.73076354e-01 -2.85562767e-02]
 [-3.09088311e-02 -1.77804952e-02  9.31808729e-02]
 [-1.37086579e-02  6.78047371e-02  1.44132976e-02]
 [ 1.09790176e-02 -1.46556284e-01  4.73842808e-02]
 [-4.59673836e-02  1.08688733e-01 -3.87639838e-02]
 [ 1.46530376e-01  9.28960417e-03 -4.37160085e-02]
 [ 4.53031729e-02  2.79760686e-02  8.11319900e-03]
 [-4.00025125e-02 -6.03266923e-02 -6.11068988e-03]
 [ 3.92368089e-02  2.29967884e-02 -1.77130038e-01]
 [-7.80916822e-03 -1.28409285e-02 -2.85524843e-02]
 [-2.33439657e-02  3.83957640e-01 -3.38218834e-01]
 [ 1.07374308e-01  8.67747273e-02  1.04943108e-01]
 [ 1.34659143e-03 -3.06031556e-02  6.80484775e-02]
 [ 7.88972698e-02 -8.00223073e-02 -2.18877124e-01]
 [ 1.18691426e-02  2.04178528e-02 -1.06125076e-02]
 [-7.65146017e-02 -1.28544311e-02  1.97054161e-01]
 [-1.55591258e-02 -3.23951901e-02  2.19794466e-03]
 [-7.44526023e-02  5.95563661e-02 -2.22914361e-01]
 [-3.20089347e-02 -4.17055928e-02  4.00473433e-02]
 [-7.75029116e-03  2.57769315e-02 -3.55075716e-02]
 [ 3.74405782e-02 -4.17582851e-02 -9.26240983e-02]
 [-2.22540564e-02 -1.11223889e-02 -6.79902753e-02]
 [ 8.79934709e-02  1.23140708e-02  1.67123558e-01]
 [ 2.95841370e-02 -4.60167935e-02  1.11973500e-01]
 [-6.74377381e-02 -5.54729450e-03 -1.43449006e-02]
 [ 4.78795278e-02 -5.04526581e-02  7.81221337e-02]
 [-2.79689864e-02  8.46503151e-02  4.36687921e-02]
 [ 2.19344873e-02 -5.31766722e-02 -3.42645561e-02]
 [ 9.65322192e-02  4.56178633e-03  7.42329440e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.31338476]
curr_Stock_Price:  99.28049697416989
curr_Factors:  [99.28049697 -0.86384641 -0.9866566 ]
mat_Sqrt:  [[15.60273372  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00477916  0.00016817 -0.00600085]
Stock Position:  0.004779163682950302
Bond Position:  [-3.7878625]


portfolio before change:  [-3.31983042]
curr_Stock_Price:  98.03087453655381
curr_Factors:  [98.03087454 -0.76950383 -0.96820538]
mat_Sqrt:  [[17.24587973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00476351 -0.00873127  0.66591876]
Stock Position:  -0.004763511131094696
Bond Position:  [-2.85285926]


portfolio before change:  [-3.32233225]
curr_Stock_Price:  98.48121386021916
curr_Factors:  [98.48121386 -1.10120671 -0.96735153]
mat_Sqrt:  [[12.4448585   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00080228 0.01939335 0.1166673 ]
Stock Position:  0.0008022798170052847
Bond Position:  [-3.40134174]


portfolio before change:  [-3.32301812]
curr_Stock_Price:  98.156283502892
curr_Factors:  [98.1562835  -1.24535133 -0.9550609 ]
mat_Sqrt:  [[10.87154368  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01382274 0.02028512 0.32269822]
Stock Position:  0.01382274403295188
Bond Position:  [-4.67980731]


portfolio before change:  [-3.32259848]
curr_Stock_Price:  98.22896470082758
curr_Factors:  [98.2289647  -1.26949007 -0.9652396 ]
mat_Sqrt:  [[10.5125677   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00785297  0.0728019  -0.11268078]
Stock Position:  -0.00785296894487808
Bond Position:  [-2.55120947]


portfolio before change:  [-3.31470061]
curr_Stock_Price:  97.1826344138573
curr_Factors:  [97.18263441 -1.12629653 -0.96779483]
mat_Sqrt:  [[11.9711631   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.99535631e-04 -4.16280317e-02  8.02409720e-01]
Stock Position:  -0.0005995356312470304
Bond Position:  [-3.25643615]


portfolio before change:  [-3.31482154]
curr_Stock_Price:  96.70535000224463
curr_Factors:  [96.70535    -0.87527774 -0.95800798]
mat_Sqrt:  [[15.46196297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00910545 -0.0807455  -0.35159504]
Stock Position:  -0.009105448584450311
Bond Position:  [-2.43427594]


portfolio before change:  [-3.32247333]
curr_Stock_Price:  97.51228320418325
curr_Factors:  [97.5122832  -1.00313715 -0.95937115]
mat_Sqrt:  [[13.7010168   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01334167 0.26081773 0.39575179]
Stock Position:  0.01334166859156369
Bond Position:  [-4.62344989]


portfolio before change:  [-3.31715003]
curr_Stock_Price:  97.95460139211716
curr_Factors:  [97.95460139 -1.04549484 -0.95202583]
mat_Sqrt:  [[13.28962234  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00021455  0.00435705 -0.09562608]
Stock Position:  -0.00021455349423558643
Bond Position:  [-3.29613353]


portfolio before change:  [-3.31763218]
curr_Stock_Price:  98.28133075179535
curr_Factors:  [98.28133075 -0.85630078 -0.9699699 ]
mat_Sqrt:  [[15.82456381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02109969 0.03332799 0.42229509]
Stock Position:  0.0210996867694945
Bond Position:  [-5.39133747]


portfolio before change:  [-3.3437643]
curr_Stock_Price:  97.07476485477225
curr_Factors:  [97.07476485 -0.96535769 -0.93726752]
mat_Sqrt:  [[14.48127211  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01318962 -0.08813501 -0.08146311]
Stock Position:  -0.013189619676648725
Bond Position:  [-2.06338507]


portfolio before change:  [-3.33231446]
curr_Stock_Price:  96.18711425173824
curr_Factors:  [96.18711425 -0.93028267 -0.93745827]
mat_Sqrt:  [[14.85823797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00104439 -0.00573863  0.26581909]
Stock Position:  -0.0010443898834878486
Bond Position:  [-3.23185761]


portfolio before change:  [-3.33498225]
curr_Stock_Price:  98.35467300574913
curr_Factors:  [98.35467301 -1.04530264 -0.96978593]
mat_Sqrt:  [[13.11152336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00023445 0.02188388 0.04111713]
Stock Position:  0.0002344524019544472
Bond Position:  [-3.35804174]


portfolio before change:  [-3.33545556]
curr_Stock_Price:  98.12633999955037
curr_Factors:  [98.12634    -1.06891118 -0.98006523]
mat_Sqrt:  [[12.64522176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00073264 -0.04730084  0.13517416]
Stock Position:  -0.000732639012658588
Bond Position:  [-3.26356438]


portfolio before change:  [-3.33626099]
curr_Stock_Price:  98.66884451415925
curr_Factors:  [98.66884451 -0.92161207 -0.96821727]
mat_Sqrt:  [[14.908625    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00212589  0.03507914 -0.11058286]
Stock Position:  -0.002125887125821212
Bond Position:  [-3.12650217]


portfolio before change:  [-3.33745897]
curr_Stock_Price:  99.0485152959873
curr_Factors:  [99.0485153  -0.93423689 -1.00538165]
mat_Sqrt:  [[14.23909347  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00979719  0.00299821 -0.1247096 ]
Stock Position:  0.009797190831309349
Bond Position:  [-4.30785617]


portfolio before change:  [-3.34035011]
curr_Stock_Price:  98.80838216217103
curr_Factors:  [98.80838216 -1.10302483 -1.03524789]
mat_Sqrt:  [[11.64538222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00452281 0.00902924 0.0231447 ]
Stock Position:  0.004522811089825577
Bond Position:  [-3.78724176]


portfolio before change:  [-3.3441432]
curr_Stock_Price:  98.07440293078282
curr_Factors:  [98.07440293 -1.20001047 -1.04068071]
mat_Sqrt:  [[10.43364021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00513378 -0.01947036 -0.0174321 ]
Stock Position:  -0.00513377740361919
Bond Position:  [-2.84065104]


portfolio before change:  [-3.34766752]
curr_Stock_Price:  98.69172976771424
curr_Factors:  [98.69172977 -1.1362639  -1.02490971]
mat_Sqrt:  [[11.36828591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00068388  0.00742218 -0.5053027 ]
Stock Position:  0.0006838754022297269
Bond Position:  [-3.41516037]


portfolio before change:  [-3.34854441]
curr_Stock_Price:  98.03375696749292
curr_Factors:  [98.03375697 -1.18740041 -1.03437087]
mat_Sqrt:  [[10.62851625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152971 -0.00414439 -0.08145229]
Stock Position:  -0.0015297114703566308
Bond Position:  [-3.19858105]


portfolio before change:  [-3.35014416]
curr_Stock_Price:  98.81815535332741
curr_Factors:  [98.81815535 -1.25205831 -1.03475206]
mat_Sqrt:  [[10.0389345   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00139532  0.1239218  -0.96484419]
Stock Position:  -0.001395324476314813
Bond Position:  [-3.21226077]


portfolio before change:  [-3.34981186]
curr_Stock_Price:  98.29221201070109
curr_Factors:  [98.29221201 -1.17668808 -1.0391403 ]
mat_Sqrt:  [[10.72005634  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01366677 0.02800642 0.29937348]
Stock Position:  0.01366677024953874
Bond Position:  [-4.69314894]


portfolio before change:  [-3.35408025]
curr_Stock_Price:  98.02282090906031
curr_Factors:  [98.02282091 -1.11790925 -1.02597303]
mat_Sqrt:  [[11.48817255  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00078255 -0.00987713  0.19412337]
Stock Position:  0.0007825514223739119
Bond Position:  [-3.43078814]


portfolio before change:  [-3.35387416]
curr_Stock_Price:  98.83422283503818
curr_Factors:  [98.83422284 -1.20567507 -1.01776488]
mat_Sqrt:  [[10.69743491  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00167187 -0.02582709 -0.62439551]
Stock Position:  0.001671866102231693
Bond Position:  [-3.51911175]


portfolio before change:  [-3.35528972]
curr_Stock_Price:  98.25065629011918
curr_Factors:  [98.25065629 -1.20645648 -1.01794991]
mat_Sqrt:  [[10.62399944  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0013056   0.00658983 -0.03027453]
Stock Position:  0.001305595919582876
Bond Position:  [-3.48356538]


portfolio before change:  [-3.35525453]
curr_Stock_Price:  98.61115562163106
curr_Factors:  [98.61115562 -1.2632776  -1.02200947]
mat_Sqrt:  [[10.03317726  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00387863 -0.00414875  0.56214067]
Stock Position:  -0.0038786306924510636
Bond Position:  [-2.97277827]


portfolio before change:  [-3.35701915]
curr_Stock_Price:  98.9703042350879
curr_Factors:  [98.97030424 -1.31780019 -1.01121957]
mat_Sqrt:  [[ 9.63883347  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00225371 -0.0104555   0.00627012]
Stock Position:  -0.00225370765008603
Bond Position:  [-3.13396902]


portfolio before change:  [-3.35683305]
curr_Stock_Price:  98.71389655118709
curr_Factors:  [98.71389655 -1.22909392 -1.01994827]
mat_Sqrt:  [[10.41433829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01035091  0.01922173 -0.63591263]
Stock Position:  -0.010350913362054598
Bond Position:  [-2.33505406]


portfolio before change:  [-3.35479739]
curr_Stock_Price:  98.48903108774516
curr_Factors:  [98.48903109 -1.13664232 -1.02952009]
mat_Sqrt:  [[11.2884804   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286553 -0.01346042  0.11424392]
Stock Position:  -0.002865525061900128
Bond Position:  [-3.0725746]


portfolio before change:  [-3.35253429]
curr_Stock_Price:  97.56522327909344
curr_Factors:  [97.56522328 -1.27188782 -1.01476595]
mat_Sqrt:  [[ 9.91320138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098218  0.00831947 -0.10129322]
Stock Position:  -0.0009821801644076895
Bond Position:  [-3.25670767]


portfolio before change:  [-3.35349906]
curr_Stock_Price:  98.13299911807346
curr_Factors:  [98.13299912 -1.52041516 -1.03414154]
mat_Sqrt:  [[ 7.62755231  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00131233 -0.01347743 -0.26423077]
Stock Position:  0.0013123330643497338
Bond Position:  [-3.48228224]


portfolio before change:  [-3.35347514]
curr_Stock_Price:  98.48294083997777
curr_Factors:  [98.48294084 -1.58193804 -1.06255048]
mat_Sqrt:  [[ 6.99639364  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00548895 -0.00358974 -0.19395733]
Stock Position:  -0.0054889509286997805
Bond Position:  [-2.81290711]


portfolio before change:  [-3.35495841]
curr_Stock_Price:  98.68910671673646
curr_Factors:  [98.68910672 -1.68395512 -1.09523352]
mat_Sqrt:  [[ 6.12749445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02033801 0.00397435 0.47675699]
Stock Position:  0.020338006768186218
Bond Position:  [-5.36209813]


portfolio before change:  [-3.35028257]
curr_Stock_Price:  98.95197142032426
curr_Factors:  [98.95197142 -1.5872652  -1.12078379]
mat_Sqrt:  [[ 6.59680606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00652551 -0.01485186  0.31942923]
Stock Position:  0.006525505370678207
Bond Position:  [-3.99599419]


portfolio before change:  [-3.35029297]
curr_Stock_Price:  99.02692697297142
curr_Factors:  [99.02692697 -1.31976388 -1.136648  ]
mat_Sqrt:  [[ 8.49077197  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0084207  -0.00179038 -0.04092201]
Stock Position:  -0.008420696684348328
Bond Position:  [-2.51641726]


portfolio before change:  [-3.34845528]
curr_Stock_Price:  98.7713349713634
curr_Factors:  [98.77133497 -1.27482379 -1.12750095]
mat_Sqrt:  [[ 8.93952708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00598774 -0.01628353  0.2228607 ]
Stock Position:  0.00598773686684128
Bond Position:  [-3.93987205]


portfolio before change:  [-3.34776198]
curr_Stock_Price:  98.9693769723165
curr_Factors:  [98.96937697 -1.34629446 -1.14253424]
mat_Sqrt:  [[ 8.21516446  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00021618  0.02732077  0.12457491]
Stock Position:  -0.0002161805029766477
Bond Position:  [-3.32636673]


portfolio before change:  [-3.34822852]
curr_Stock_Price:  99.20399063273831
curr_Factors:  [99.20399063 -1.37416925 -1.14319559]
mat_Sqrt:  [[ 8.00297548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00051051 -0.0171627  -0.09774724]
Stock Position:  0.0005105127885109033
Bond Position:  [-3.39887342]


portfolio before change:  [-3.34904331]
curr_Stock_Price:  98.440235956933
curr_Factors:  [98.44023596 -1.17201944 -1.1478444 ]
mat_Sqrt:  [[ 9.67539234  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01163944 0.00147231 0.21176593]
Stock Position:  0.011639437681709802
Bond Position:  [-4.4948323]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.34802938]
Stock Price:  98.57562235764745
PL:  [-3.34802938]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-3.49695995e-02 -8.18749290e-02  1.26585402e-02]
 [-1.84259344e-01  1.01776674e-01 -3.34297237e-01]
 [-3.78657940e-02  5.22392505e-02  2.24303429e-02]
 [ 9.90819689e-02  7.21538557e-02  9.22757199e-02]
 [-9.07088981e-02  2.04454383e-01 -4.13531970e-02]
 [-5.15380456e-02 -1.38404867e-01  2.29986301e-01]
 [-6.15387517e-02 -1.69633521e-01  8.23683241e-02]
 [-2.39654434e-02  7.65742920e-01  1.55324277e-01]
 [ 3.94351689e-01  4.06130787e-02  3.82418470e-01]
 [ 5.81918459e-01  2.42476516e-01  4.47199291e-01]
 [-1.53412028e-01 -2.16117225e-01  8.54018642e-03]
 [-4.79809067e-02 -1.97618186e-02  8.53736930e-02]
 [ 1.46228959e-02 -5.50207413e-02  6.08060017e-02]
 [ 1.29976694e-03  1.42827334e-01 -8.90583617e-02]
 [ 3.74168870e-01 -1.51516684e-01 -1.86552547e-01]
 [-2.19817813e-01 -9.65890484e-02  1.20350604e-01]
 [ 5.04712739e-02  1.87006085e-02 -2.21138118e-02]
 [-4.07973289e-02 -5.12112755e-02  5.14016724e-02]
 [ 9.80555474e-02 -7.31135808e-02 -6.13240019e-02]
 [ 3.26431256e-02 -4.65551100e-03  9.25213039e-02]
 [-2.93278770e-02  4.54379727e-01 -4.35480485e-01]
 [ 2.13784694e-01  1.37735894e-01  8.75645978e-02]
 [ 2.05165347e-03  6.85179606e-02  8.34398577e-03]
 [-1.77962794e-02 -1.22781051e-01 -1.02004188e-01]
 [ 3.32109718e-02  1.79164256e-02 -1.23061844e-02]
 [-5.38020484e-02 -6.44311193e-03  1.68898028e-01]
 [-1.13223409e-02 -3.24276135e-02  2.25036360e-03]
 [-5.92694102e-02  3.56853493e-02 -2.56354002e-01]
 [-4.09496419e-02 -4.26642958e-02  3.17926302e-02]
 [-5.38996247e-02  1.16485372e-02  5.27881097e-03]
 [-5.05319525e-03 -4.25681641e-02 -3.71148549e-02]
 [ 1.95376208e-02  1.25434106e-01 -9.30742128e-02]
 [-3.00992864e-02  4.32238873e-02 -9.64826450e-02]
 [ 4.76887069e-02 -4.13169361e-02  1.86574808e-01]
 [-6.84647361e-02  2.53002038e-02 -2.80491494e-02]
 [-1.61802185e-01 -1.76188172e-01 -1.47681415e-01]
 [ 1.22365127e-01  9.59924032e-02  2.49899383e-01]
 [ 1.75869580e-01 -1.22799639e-01 -1.75981533e-01]
 [ 9.86508181e-02  3.24926081e-03  6.16912594e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.42811481]
curr_Stock_Price:  100.1304143079696
curr_Factors:  [100.13041431  -1.22232955  -1.0000525 ]
mat_Sqrt:  [[10.84920089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00452553 -0.02642502  0.03611129]
Stock Position:  -0.004525525539102805
Bond Position:  [3.88125756]


portfolio before change:  [3.42768212]
curr_Stock_Price:  100.33323571261373
curr_Factors:  [100.33323571  -1.19589431  -1.01383625]
mat_Sqrt:  [[11.0095871   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02104733  0.03284828 -0.95365697]
Stock Position:  -0.02104732928029831
Bond Position:  [5.53942877]


portfolio before change:  [3.45068065]
curr_Stock_Price:  99.27343138234713
curr_Factors:  [99.27343138 -1.00367051 -0.98090809]
mat_Sqrt:  [[13.64399328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00165816  0.01686015  0.06398752]
Stock Position:  -0.0016581602350085537
Bond Position:  [3.6152919]


portfolio before change:  [3.45266809]
curr_Stock_Price:  98.34740212730392
curr_Factors:  [98.34740213 -0.8368942  -0.98267044]
mat_Sqrt:  [[15.94175055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00832067 0.02328756 0.26323694]
Stock Position:  0.008320668110640491
Bond Position:  [2.634352]


portfolio before change:  [3.45698443]
curr_Stock_Price:  98.82657358038892
curr_Factors:  [98.82657358 -0.68946957 -0.97417421]
mat_Sqrt:  [[18.72243904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306669  0.06598737 -0.11796916]
Stock Position:  -0.003066694878648975
Bond Position:  [3.76005538]


portfolio before change:  [3.45942897]
curr_Stock_Price:  98.1827204776943
curr_Factors:  [98.18272048 -0.31562742 -0.96801553]
mat_Sqrt:  [[27.19919242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00120754 -0.04466998  0.6560869 ]
Stock Position:  -0.0012075381942400296
Bond Position:  [3.57798835]


portfolio before change:  [3.45818883]
curr_Stock_Price:  99.58011833733497
curr_Factors:  [99.58011834 -0.54360393 -0.99013688]
mat_Sqrt:  [[21.48213628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00369385 -0.05474898  0.2349739 ]
Stock Position:  -0.003693845177742707
Bond Position:  [3.82602237]


portfolio before change:  [3.45810272]
curr_Stock_Price:  99.73291290166391
curr_Factors:  [99.7329129  -0.53864905 -0.98657362]
mat_Sqrt:  [[21.69914952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00756005 0.24714246 0.44309693]
Stock Position:  0.007560047943116202
Bond Position:  [2.70411711]


portfolio before change:  [3.46524548]
curr_Stock_Price:  100.63300397764714
curr_Factors:  [100.63300398  -0.39241849  -0.9798617 ]
mat_Sqrt:  [[25.51330514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01884125 0.01310781 1.09093345]
Stock Position:  0.018841253193983346
Bond Position:  [1.56919358]


portfolio before change:  [3.48189898]
curr_Stock_Price:  101.50647726828811
curr_Factors:  [101.50647727  -0.60651976  -0.98442816]
mat_Sqrt:  [[20.68015808  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03494644 0.07825896 1.2757351 ]
Stock Position:  0.03494644194334646
Bond Position:  [-0.06539124]


portfolio before change:  [3.52615539]
curr_Stock_Price:  102.77311805317815
curr_Factors:  [102.77311805  -0.95736398  -0.99583357]
mat_Sqrt:  [[14.57527023  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01343258 -0.06975153  0.02436277]
Stock Position:  -0.013432582070596452
Bond Position:  [4.90666373]


portfolio before change:  [3.52319385]
curr_Stock_Price:  103.03925569979982
curr_Factors:  [103.0392557   -1.09949132  -1.01228339]
mat_Sqrt:  [[12.47011931  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277367 -0.0063781   0.24354738]
Stock Position:  -0.0027736654390434767
Bond Position:  [3.80899027]


portfolio before change:  [3.52389151]
curr_Stock_Price:  102.95939301273735
curr_Factors:  [102.95939301  -0.97959398  -1.02469457]
mat_Sqrt:  [[13.8744097   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00113906 -0.01775787  0.1734626 ]
Stock Position:  0.001139061592868997
Bond Position:  [3.40661442]


portfolio before change:  [3.52556353]
curr_Stock_Price:  104.05341927046233
curr_Factors:  [104.05341927  -1.18878526  -1.04277487]
mat_Sqrt:  [[11.17125859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00109883  0.04609732 -0.25405872]
Stock Position:  0.0010988298467144518
Bond Position:  [3.41122653]


portfolio before change:  [3.52513791]
curr_Stock_Price:  103.278004891918
curr_Factors:  [103.27800489  -1.01731688  -1.04722162]
mat_Sqrt:  [[13.10358594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02328834 -0.0489018  -0.53218249]
Stock Position:  0.023288340943738554
Bond Position:  [1.11996452]


portfolio before change:  [3.52151767]
curr_Stock_Price:  103.11654019813955
curr_Factors:  [103.1165402   -1.22489     -1.04863533]
mat_Sqrt:  [[10.61570471  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02024995 -0.03117398  0.34332678]
Stock Position:  -0.020249951473458015
Bond Position:  [5.60962261]


portfolio before change:  [3.52145247]
curr_Stock_Price:  103.15438954462711
curr_Factors:  [103.15438954  -1.12445684  -1.04179508]
mat_Sqrt:  [[11.82214983  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00421028  0.0060356  -0.06308455]
Stock Position:  0.004210279634466902
Bond Position:  [3.08714364]


portfolio before change:  [3.51850103]
curr_Stock_Price:  102.36172020771686
curr_Factors:  [102.36172021  -1.03335632  -1.04621592]
mat_Sqrt:  [[12.7935429   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00318586 -0.01652837  0.14663466]
Stock Position:  -0.003185862166798983
Bond Position:  [3.84461136]


portfolio before change:  [3.51985502]
curr_Stock_Price:  102.08757722182854
curr_Factors:  [102.08757722  -1.09535784  -1.05810872]
mat_Sqrt:  [[11.85043388  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00595873 -0.02359731 -0.17494031]
Stock Position:  0.005958734628860328
Bond Position:  [2.91154223]


portfolio before change:  [3.51782835]
curr_Stock_Price:  101.68637996516733
curr_Factors:  [101.68637997  -1.25094193  -1.0544853 ]
mat_Sqrt:  [[10.13977835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00498814 -0.00150256  0.26393753]
Stock Position:  0.004988142122733482
Bond Position:  [3.01060224]


portfolio before change:  [3.51998546]
curr_Stock_Price:  102.04337830147927
curr_Factors:  [102.0433783   -1.11603103  -1.060491  ]
mat_Sqrt:  [[11.57532839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00220038  0.14665043 -1.24230461]
Stock Position:  -0.002200376911250977
Bond Position:  [3.74451935]


portfolio before change:  [3.52038955]
curr_Stock_Price:  102.07246603110838
curr_Factors:  [102.07246603  -0.80615128  -1.09280792]
mat_Sqrt:  [[15.28273575  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01699787 0.04445407 0.24979742]
Stock Position:  0.01699787054726293
Bond Position:  [1.78537499]


portfolio before change:  [3.51033211]
curr_Stock_Price:  101.4676476614843
curr_Factors:  [101.46764766  -0.8152763   -1.0858561 ]
mat_Sqrt:  [[15.15920004  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00117031 0.02211408 0.02380307]
Stock Position:  0.0011703145636848997
Bond Position:  [3.39158305]


portfolio before change:  [3.51002593]
curr_Stock_Price:  100.84375107108539
curr_Factors:  [100.84375107  -0.7997164   -1.0860116 ]
mat_Sqrt:  [[15.29986958  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00416215 -0.03962741 -0.29098956]
Stock Position:  -0.004162151442107847
Bond Position:  [3.9297529]


portfolio before change:  [3.51526715]
curr_Stock_Price:  99.70252221189227
curr_Factors:  [99.70252221 -0.84143737 -1.05074663]
mat_Sqrt:  [[15.02938038  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00228593  0.0057825  -0.03510612]
Stock Position:  0.0022859330609874603
Bond Position:  [3.28735386]


portfolio before change:  [3.51634571]
curr_Stock_Price:  99.99457678615846
curr_Factors:  [99.99457679 -1.01954681 -1.02659925]
mat_Sqrt:  [[12.92249889  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0015973  -0.00207951  0.48181906]
Stock Position:  -0.0015972976748636289
Bond Position:  [3.67606682]


portfolio before change:  [3.51730753]
curr_Stock_Price:  99.68011866374547
curr_Factors:  [99.68011866 -1.14835974 -1.01896461]
mat_Sqrt:  [[11.41173146  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00153195 -0.01046597  0.00641966]
Stock Position:  -0.0015319538748743255
Bond Position:  [3.67001288]


portfolio before change:  [3.5184343]
curr_Stock_Price:  99.24408255570681
curr_Factors:  [99.24408256 -1.13535646 -0.99527975]
mat_Sqrt:  [[11.7863972   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00885031  0.0115174  -0.73130661]
Stock Position:  -0.008850305020779626
Bond Position:  [4.3967747]


portfolio before change:  [3.51523094]
curr_Stock_Price:  99.66813482900733
curr_Factors:  [99.66813483 -0.97641719 -0.99584844]
mat_Sqrt:  [[13.86794952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311285 -0.01376984  0.09069552]
Stock Position:  -0.0031128474547368035
Bond Position:  [3.82548264]


portfolio before change:  [3.51743763]
curr_Stock_Price:  99.11286397479962
curr_Factors:  [99.11286397 -0.71628816 -0.97696314]
mat_Sqrt:  [[18.22889439  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00276727  0.00375955  0.01505898]
Stock Position:  -0.0027672739300440867
Bond Position:  [3.79171007]


portfolio before change:  [3.5186149]
curr_Stock_Price:  98.85872082366274
curr_Factors:  [98.85872082 -0.7895901  -0.95756787]
mat_Sqrt:  [[17.22796256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00123743 -0.01373882 -0.10587835]
Stock Position:  -0.0012374314910826838
Bond Position:  [3.6409458]


portfolio before change:  [3.5202574]
curr_Stock_Price:  97.89918950366908
curr_Factors:  [97.8991895  -0.41997178 -0.96574041]
mat_Sqrt:  [[24.48904992  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00106754  0.04048368 -0.26551482]
Stock Position:  0.0010675406563686503
Bond Position:  [3.41574604]


portfolio before change:  [3.51926348]
curr_Stock_Price:  96.56816700502486
curr_Factors:  [96.56816701 -0.45204932 -0.93043926]
mat_Sqrt:  [[24.23409624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00169062  0.01395045 -0.27523813]
Stock Position:  -0.0016906215286407282
Bond Position:  [3.6825237]


portfolio before change:  [3.52264988]
curr_Stock_Price:  94.83740827710507
curr_Factors:  [94.83740828 -0.49315419 -0.90035075]
mat_Sqrt:  [[23.53900886  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00328558 -0.01333498  0.53224599]
Stock Position:  0.0032855820865685306
Bond Position:  [3.21105379]


portfolio before change:  [3.52793762]
curr_Stock_Price:  96.32461162656863
curr_Factors:  [96.32461163 -0.50322736 -0.90100796]
mat_Sqrt:  [[23.65296627  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291828  0.00816561 -0.08001642]
Stock Position:  -0.002918275089772678
Bond Position:  [3.80903933]


portfolio before change:  [3.53386893]
curr_Stock_Price:  94.45530477939622
curr_Factors:  [94.45530478 -0.83659825 -0.86752471]
mat_Sqrt:  [[17.18443089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01326269 -0.05686449 -0.42129397]
Stock Position:  -0.013262690486031006
Bond Position:  [4.7866004]


portfolio before change:  [3.53757791]
curr_Stock_Price:  94.22076534022557
curr_Factors:  [94.22076534 -0.92339901 -0.88465659]
mat_Sqrt:  [[15.44962914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01249027 0.03098141 0.71289338]
Stock Position:  0.01249026691037686
Bond Position:  [2.36073541]


portfolio before change:  [3.54853973]
curr_Stock_Price:  95.07476660448259
curr_Factors:  [95.0747666  -0.86238335 -0.86981906]
mat_Sqrt:  [[16.81819256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00683077 -0.03963341 -0.50202633]
Stock Position:  0.006830765434739339
Bond Position:  [2.8991063]


portfolio before change:  [3.54310517]
curr_Stock_Price:  94.22611033707292
curr_Factors:  [94.22611034 -1.0992212  -0.86726026]
mat_Sqrt:  [[13.18679394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00848627 0.00104869 0.17598799]
Stock Position:  0.008486273978201201
Bond Position:  [2.74347658]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.54011987]
Stock Price:  93.83391805785944
PL:  [3.54011987]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 5.01353417e-02 -7.10776976e-02  9.33590145e-03]
 [-1.16440950e-01  7.00803344e-02 -1.22679246e-01]
 [-2.71163440e-02 -9.09914211e-03  1.94791965e-02]
 [-7.80744588e-01 -3.24781122e-01 -5.25397289e-01]
 [ 1.77157440e-01 -1.84870046e-01 -1.04522145e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.22996577e-02 -1.71039452e-01 -2.74658877e-02]
 [ 9.94673887e-03  6.54048617e-01  9.53744326e-02]
 [ 3.75414797e-01  3.30689772e-02  3.75419721e-01]
 [ 5.91632827e-01  2.54254578e-01  4.80338242e-01]
 [-1.48246597e-01 -1.70431732e-01  4.47217634e-02]
 [-7.79063634e-02 -1.94065159e-02  8.73548138e-02]
 [ 5.42933129e-03 -5.85242792e-02  1.40537480e-01]
 [ 1.06289593e-02 -4.95503858e-02 -1.87678564e-01]
 [ 4.94614363e-02 -5.87161245e-02 -8.27254833e-02]
 [-1.01231414e-02 -3.52260067e-02  7.17016664e-02]
 [ 5.10697265e-02  1.76265343e-02 -2.56140212e-02]
 [-4.73244975e-02 -6.18702968e-02  5.17865851e-04]
 [ 5.00532598e-02  2.60382013e-02 -1.94337030e-01]
 [ 1.64343922e-02  9.76375917e-03  2.14020558e-02]
 [-2.72290037e-02  4.26850210e-01 -3.95872095e-01]
 [ 2.24622022e-01  1.42921519e-01  8.57998152e-02]
 [-6.58590917e-03 -2.15599416e-03  5.06550913e-02]
 [ 6.11131819e-02 -1.19874943e-01 -2.26126690e-01]
 [ 4.05190189e-02  1.27576929e-02 -1.30472384e-02]
 [-5.90602175e-02 -8.03112161e-03  1.73875032e-01]
 [-1.39910843e-02 -3.23275228e-02  2.80112579e-03]
 [-6.43072790e-02  4.33047051e-02 -2.46367065e-01]
 [-3.46145679e-02 -4.16136892e-02  3.70222683e-02]
 [-5.62456122e-02  5.56979391e-03  1.22964176e-02]
 [ 3.08450004e-02 -4.42650085e-02 -8.73404966e-02]
 [ 9.19725190e-03  4.41295428e-02 -5.64571464e-02]
 [ 2.35583178e-02  1.83341279e-02  7.92002738e-02]
 [ 2.96982450e-02 -4.58929615e-02  1.12471170e-01]
 [-6.88261598e-02 -1.25995248e-02 -1.51322146e-02]
 [ 4.88222402e-02 -5.20378997e-02  7.80767506e-02]
 [-3.42483682e-02  9.71260040e-02  5.84417935e-02]
 [ 8.69985558e-02 -8.35456081e-02 -8.73076806e-02]
 [ 9.76601324e-02  3.86301564e-03  6.75559221e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.43537734]
curr_Stock_Price:  99.7531125772612
curr_Factors:  [99.75311258 -0.85906195 -0.99087488]
mat_Sqrt:  [[15.68588765  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00239275 -0.02294023  0.02663273]
Stock Position:  0.0023927463468747245
Bond Position:  [0.19669344]


portfolio before change:  [0.43706264]
curr_Stock_Price:  100.44717343482773
curr_Factors:  [100.44717343  -0.92595626  -0.98735769]
mat_Sqrt:  [[14.82504532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00857857  0.02261833 -0.34996974]
Stock Position:  -0.008578567874373043
Bond Position:  [1.29875553]


portfolio before change:  [0.4299737]
curr_Stock_Price:  101.2924531541108
curr_Factors:  [101.29245315  -0.92139484  -0.97672927]
mat_Sqrt:  [[15.17861897  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164689 -0.00293674  0.05556873]
Stock Position:  -0.0016468905609526923
Bond Position:  [0.59679129]


portfolio before change:  [0.42690394]
curr_Stock_Price:  103.2017237791287
curr_Factors:  [103.20172378  -1.02737381  -0.99853837]
mat_Sqrt:  [[13.60957207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07011878 -0.10482266 -1.49881222]
Stock Position:  -0.07011877559660233
Bond Position:  [7.66328246]


portfolio before change:  [0.53648166]
curr_Stock_Price:  101.65264164187899
curr_Factors:  [101.65264164  -0.80587176  -1.01334522]
mat_Sqrt:  [[16.48324722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00716397 -0.05966655 -0.29817259]
Stock Position:  0.007163971080629563
Bond Position:  [-0.19175493]


portfolio before change:  [0.53564306]
curr_Stock_Price:  101.53893054474128
curr_Factors:  [101.53893054  -0.85904112  -1.00787462]
mat_Sqrt:  [[15.69789364  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00976591 -0.05534923  0.15513819]
Stock Position:  -0.009765908704510598
Bond Position:  [1.52726299]


portfolio before change:  [0.53578919]
curr_Stock_Price:  101.54351775258775
curr_Factors:  [101.54351775  -1.04358736  -1.03267659]
mat_Sqrt:  [[12.73333694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00728948 -0.05520275 -0.07835253]
Stock Position:  -0.0072894788673853106
Bond Position:  [1.27598851]


portfolio before change:  [0.53403246]
curr_Stock_Price:  101.80639382245145
curr_Factors:  [101.80639382  -0.76519226  -1.06311857]
mat_Sqrt:  [[16.35873619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00995933 0.21109328 0.27207671]
Stock Position:  0.009959331599404134
Bond Position:  [-0.47989117]


portfolio before change:  [0.5387136]
curr_Stock_Price:  102.28244273096182
curr_Factors:  [102.28244273  -1.03018254  -1.04832076]
mat_Sqrt:  [[12.7973066   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03585108 0.01067297 1.07096797]
Stock Position:  0.03585107532415653
Bond Position:  [-3.12822196]


portfolio before change:  [0.53400625]
curr_Stock_Price:  102.16204737925048
curr_Factors:  [102.16204738  -0.84789534  -1.0365361 ]
mat_Sqrt:  [[15.51998911  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04778231 0.08206031 1.3702713 ]
Stock Position:  0.0477823117620606
Bond Position:  [-4.34753255]


portfolio before change:  [0.51694319]
curr_Stock_Price:  101.81632139943082
curr_Factors:  [101.8163214   -0.56707853  -1.05135721]
mat_Sqrt:  [[20.18086116  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00861742 -0.05500661  0.12757874]
Stock Position:  -0.008617423963065574
Bond Position:  [1.39433759]


portfolio before change:  [0.53412782]
curr_Stock_Price:  99.84237475989033
curr_Factors:  [99.84237476 -0.56810967 -1.06732012]
mat_Sqrt:  [[19.45614392  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00329132 -0.00626343  0.24919897]
Stock Position:  -0.0032913240904773474
Bond Position:  [0.86274144]


portfolio before change:  [0.53282381]
curr_Stock_Price:  100.27133889337644
curr_Factors:  [100.27133889  -0.58039368  -1.0520798 ]
mat_Sqrt:  [[19.59758654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00113127 -0.01888863  0.40091431]
Stock Position:  0.0011312722538847624
Bond Position:  [0.41938963]


portfolio before change:  [0.53379151]
curr_Stock_Price:  101.0804039141374
curr_Factors:  [101.08040391  -0.68405093  -1.0619003 ]
mat_Sqrt:  [[17.63640175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214302 -0.01599232 -0.5353947 ]
Stock Position:  -0.00214302201425141
Bond Position:  [0.75040904]


portfolio before change:  [0.53541734]
curr_Stock_Price:  100.36551877750419
curr_Factors:  [100.36551878  -0.78581276  -1.06079436]
mat_Sqrt:  [[15.83482433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00130029 -0.01895055 -0.23599278]
Stock Position:  0.0013002852822022342
Bond Position:  [0.40491353]


portfolio before change:  [0.53546202]
curr_Stock_Price:  100.36095793905972
curr_Factors:  [100.36095794  -0.77694929  -1.04465649]
mat_Sqrt:  [[16.23496892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.64926619e-04 -1.13691448e-02  2.04544896e-01]
Stock Position:  -0.00016492661860403388
Bond Position:  [0.55201422]


portfolio before change:  [0.53551416]
curr_Stock_Price:  100.46325398827567
curr_Factors:  [100.46325399  -0.65893555  -1.02127538]
mat_Sqrt:  [[18.71978706  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00264102  0.00568894 -0.07306967]
Stock Position:  0.002641017626894654
Bond Position:  [0.27018893]


portfolio before change:  [0.53286794]
curr_Stock_Price:  99.44849830616155
curr_Factors:  [99.44849831 -0.80046341 -1.0056394 ]
mat_Sqrt:  [[16.33870926  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366296 -0.01996855  0.00147733]
Stock Position:  -0.003662958257072465
Bond Position:  [0.89714364]


portfolio before change:  [0.53263611]
curr_Stock_Price:  99.54240794183575
curr_Factors:  [99.54240794 -0.81412622 -1.03358902]
mat_Sqrt:  [[15.68756761  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00100075  0.00840379 -0.55438945]
Stock Position:  0.0010007545815690758
Bond Position:  [0.43301859]


portfolio before change:  [0.53258438]
curr_Stock_Price:  99.43663024921462
curr_Factors:  [99.43663025 -1.18692323 -1.03768783]
mat_Sqrt:  [[10.75004021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00212056 0.00315124 0.06105411]
Stock Position:  0.0021205583471234266
Bond Position:  [0.3217232]


portfolio before change:  [0.53430821]
curr_Stock_Price:  100.23057940826288
curr_Factors:  [100.23057941  -1.1747869   -1.05027811]
mat_Sqrt:  [[10.83095585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193017  0.13776531 -1.1293129 ]
Stock Position:  -0.0019301733601859875
Bond Position:  [0.72777061]


portfolio before change:  [0.53580741]
curr_Stock_Price:  99.50099616573816
curr_Factors:  [99.50099617 -1.04840932 -1.0300644 ]
mat_Sqrt:  [[12.44966774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02179251 0.04612772 0.24476299]
Stock Position:  0.021792514855003806
Bond Position:  [-1.63256952]


portfolio before change:  [0.54554613]
curr_Stock_Price:  99.95724445060601
curr_Factors:  [99.95724445 -1.08232335 -1.05596292]
mat_Sqrt:  [[11.78062543  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0002813  -0.00069584  0.14450488]
Stock Position:  0.0002813031958648161
Bond Position:  [0.51742783]


portfolio before change:  [0.54564387]
curr_Stock_Price:  100.07476853269223
curr_Factors:  [100.07476853  -1.2752477   -1.05192246]
mat_Sqrt:  [[ 9.76444214  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00097436 -0.03868947 -0.64507651]
Stock Position:  -0.0009743624540511422
Bond Position:  [0.64315297]


portfolio before change:  [0.54572597]
curr_Stock_Price:  100.07302110833467
curr_Factors:  [100.07302111  -1.1537822   -1.06291576]
mat_Sqrt:  [[10.90479027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00371029  0.00411753 -0.03722014]
Stock Position:  0.0037102882901651367
Bond Position:  [0.17442621]


portfolio before change:  [0.54399354]
curr_Stock_Price:  99.60021714864774
curr_Factors:  [99.60021715 -1.01773218 -1.05789505]
mat_Sqrt:  [[12.49760608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00201698 -0.00259203  0.49601707]
Stock Position:  -0.0020169839697200325
Bond Position:  [0.74488558]


portfolio before change:  [0.54505591]
curr_Stock_Price:  99.11967108408457
curr_Factors:  [99.11967108 -1.33067636 -1.05525196]
mat_Sqrt:  [[ 9.11935975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00219513 -0.01043366  0.00799083]
Stock Position:  -0.002195125031745841
Bond Position:  [0.76263598]


portfolio before change:  [0.54530485]
curr_Stock_Price:  99.0496959189198
curr_Factors:  [99.04969592 -1.20384565 -1.05777946]
mat_Sqrt:  [[10.31910052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01024868  0.01397653 -0.70281666]
Stock Position:  -0.010248684882124524
Bond Position:  [1.56043397]


portfolio before change:  [0.55031966]
curr_Stock_Price:  98.5794163881081
curr_Factors:  [98.57941639 -1.17690203 -1.05693385]
mat_Sqrt:  [[10.55950709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0033668  -0.01343076  0.10561423]
Stock Position:  -0.0033668037202063844
Bond Position:  [0.88221721]


portfolio before change:  [0.54731934]
curr_Stock_Price:  99.5033204851313
curr_Factors:  [99.50332049 -1.21326846 -1.10001002]
mat_Sqrt:  [[ 9.84449616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00534295  0.00179764  0.03507826]
Stock Position:  -0.005342953690654206
Bond Position:  [1.07896097]


portfolio before change:  [0.5492695]
curr_Stock_Price:  99.16356752817974
curr_Factors:  [99.16356753 -1.11216729 -1.09269448]
mat_Sqrt:  [[10.93434678  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00036409 -0.01428647 -0.24915813]
Stock Position:  0.00036409482944229043
Bond Position:  [0.51316456]


portfolio before change:  [0.54936199]
curr_Stock_Price:  99.24140722566348
curr_Factors:  [99.24140723 -1.11199972 -1.09137823]
mat_Sqrt:  [[10.95917927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00060962  0.01424275 -0.16105652]
Stock Position:  0.0006096159372380572
Bond Position:  [0.48886285]


portfolio before change:  [0.54929439]
curr_Stock_Price:  99.03026047270433
curr_Factors:  [99.03026047 -1.13021024 -1.09024628]
mat_Sqrt:  [[10.75067929  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00404323 0.00591731 0.22593634]
Stock Position:  0.004043227685733736
Bond Position:  [0.1488925]


portfolio before change:  [0.54854772]
curr_Stock_Price:  98.84098622043656
curr_Factors:  [98.84098622 -1.35936646 -1.11320159]
mat_Sqrt:  [[ 8.33900837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00519108 -0.01481189  0.32084894]
Stock Position:  0.005191080650107029
Bond Position:  [0.03545619]


portfolio before change:  [0.54923035]
curr_Stock_Price:  98.97163256412016
curr_Factors:  [98.97163256 -1.44629232 -1.12314788]
mat_Sqrt:  [[ 7.57908944  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00982795 -0.00406648 -0.043168  ]
Stock Position:  -0.009827945423815557
Bond Position:  [1.52191815]


portfolio before change:  [0.55113569]
curr_Stock_Price:  98.79712062051263
curr_Factors:  [98.79712062 -1.42261804 -1.10850871]
mat_Sqrt:  [[ 7.86121926  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00688664 -0.01679516  0.22273124]
Stock Position:  0.006886641444394009
Bond Position:  [-0.12924465]


portfolio before change:  [0.54901585]
curr_Stock_Price:  98.49164732047106
curr_Factors:  [98.49164732 -1.23080448 -1.10544259]
mat_Sqrt:  [[ 9.52314048  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00026181  0.03134728  0.16671817]
Stock Position:  -0.00026180696600725076
Bond Position:  [0.57480165]


portfolio before change:  [0.54918392]
curr_Stock_Price:  98.1241606828098
curr_Factors:  [98.12416068 -1.17840226 -1.07390138]
mat_Sqrt:  [[10.31841313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00505148 -0.02696423 -0.24906451]
Stock Position:  0.0050514816158429565
Bond Position:  [0.05351152]


portfolio before change:  [0.54725871]
curr_Stock_Price:  97.7417179943662
curr_Factors:  [97.74171799 -1.20195938 -1.09732965]
mat_Sqrt:  [[ 9.80644123  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01144538 0.00124678 0.19271824]
Stock Position:  0.011445381601536492
Bond Position:  [-0.57143256]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.546321]
Stock Price:  97.6660302721522
PL:  [0.546321]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-5.56183397e-02 -8.44946268e-02  1.34647015e-02]
 [-2.41979420e-01  5.74477668e-02 -2.82763606e-01]
 [-4.70442966e-02  5.00725514e-02  1.32413699e-02]
 [ 8.82426061e-02  7.99330122e-02  7.64824416e-02]
 [-9.18437497e-02  2.04505500e-01 -4.14288255e-02]
 [-5.51505818e-02 -1.40429750e-01  2.19075428e-01]
 [-6.38014765e-02 -1.47987736e-01  3.41954936e-02]
 [ 5.13117785e-03  7.62216013e-01  1.14691759e-01]
 [ 6.36981802e-02  2.51869481e-02  3.53868060e-02]
 [ 2.33372992e-01  8.27300054e-02  1.06453632e-01]
 [-1.49662764e-01 -2.45826928e-01 -3.15873425e-03]
 [-2.53109569e-02 -1.75868200e-02  9.38748145e-02]
 [-3.56937578e-02  1.80244795e-01 -8.92133587e-02]
 [ 1.00664847e-02 -1.27707889e-01  5.00331291e-02]
 [-3.41387618e-02  8.95429675e-02 -4.75206336e-02]
 [ 6.52013633e-02 -1.38340582e-02  2.08347701e-02]
 [ 4.73273110e-02  6.01661603e-02 -6.00237662e-02]
 [-2.22534166e-02 -5.65848674e-02 -2.21788561e-02]
 [-2.95110416e-03  9.58509283e-02 -1.11474815e-01]
 [-3.55520227e-02 -1.85188106e-02 -2.34663873e-02]
 [-2.11592348e-02  3.50467557e-01 -2.87601546e-01]
 [ 2.02089639e-02  2.98301374e-02  4.33856871e-02]
 [ 3.65088013e-03 -4.09719805e-02  7.43696065e-02]
 [ 1.42588098e-01 -1.12404464e-02 -2.44193241e-01]
 [-9.93770597e-02  1.77663676e-02  4.15551934e-04]
 [-1.49105107e-01 -2.61152862e-02  1.86721671e-01]
 [-5.20518039e-02 -3.39699944e-02 -1.18397545e-02]
 [-9.50200705e-02  1.29719461e-01 -5.18099447e-02]
 [ 8.19246749e-02 -3.87088477e-02  1.35311533e-01]
 [ 3.41233731e-02  4.79923714e-02 -8.11815004e-02]
 [ 5.67877460e-03 -2.97616523e-02 -3.34751844e-02]
 [-6.99230062e-04  9.70551236e-02 -1.05085083e-01]
 [-3.94327335e-02  2.68388471e-02 -1.00083257e-01]
 [ 3.96414345e-02 -3.32313236e-02  1.75918778e-01]
 [-7.27206021e-02 -1.08440198e-03 -2.86727936e-02]
 [-2.28549763e-02 -8.68511176e-02 -7.53482575e-06]
 [ 6.59083137e-02  1.05069826e-01  1.93206394e-01]
 [ 1.70093926e-01 -1.19726706e-01 -1.63393009e-01]
 [ 9.91160493e-02  2.96103831e-03  5.89371829e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.68534055]
curr_Stock_Price:  100.03677094071197
curr_Factors:  [100.03677094  -0.91012482  -0.98364457]
mat_Sqrt:  [[15.05587733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00465714 -0.02727052  0.03841105]
Stock Position:  -0.004657135612475507
Bond Position:  [3.15122536]


portfolio before change:  [2.68943736]
curr_Stock_Price:  99.24167146137623
curr_Factors:  [99.24167146 -1.0763787  -1.00746743]
mat_Sqrt:  [[12.35068935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02331626  0.01854119 -0.80664586]
Stock Position:  -0.02331625502305279
Bond Position:  [5.00338148]


portfolio before change:  [2.67678945]
curr_Stock_Price:  99.81094692443844
curr_Factors:  [99.81094692 -1.17686154 -1.02530647]
mat_Sqrt:  [[11.0354173   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0030919   0.01616085  0.03777394]
Stock Position:  -0.0030918990724054913
Bond Position:  [2.98539483]


portfolio before change:  [2.67932692]
curr_Stock_Price:  99.11096655475507
curr_Factors:  [99.11096655 -1.19265068 -1.0091592 ]
mat_Sqrt:  [[10.96195027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01096254 0.02579827 0.21818312]
Stock Position:  0.010962536218374156
Bond Position:  [1.59281936]


portfolio before change:  [2.67320685]
curr_Stock_Price:  98.5345321070981
curr_Factors:  [98.53453211 -1.17598637 -1.00321563]
mat_Sqrt:  [[11.14738644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00525288  0.06600387 -0.11818491]
Stock Position:  -0.005252878170174443
Bond Position:  [3.19079674]


portfolio before change:  [2.67566526]
curr_Stock_Price:  98.14245453031438
curr_Factors:  [98.14245453 -1.0851964  -0.97040596]
mat_Sqrt:  [[12.56377509  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311189 -0.04532351  0.62496122]
Stock Position:  -0.003111891111787166
Bond Position:  [2.98107389]


portfolio before change:  [2.6747783]
curr_Stock_Price:  98.54723102968003
curr_Factors:  [98.54723103 -1.10833158 -0.99253593]
mat_Sqrt:  [[12.0572776   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00721798 -0.04776284  0.09755023]
Stock Position:  -0.007217982658453137
Bond Position:  [3.3860905]


portfolio before change:  [2.67711219]
curr_Stock_Price:  98.28253076739215
curr_Factors:  [98.28253077 -1.07042846 -0.97383251]
mat_Sqrt:  [[12.72521331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01446964 0.24600416 0.32718367]
Stock Position:  0.014469637775559008
Bond Position:  [1.25499957]


portfolio before change:  [2.68099611]
curr_Stock_Price:  98.54010742602371
curr_Factors:  [98.54010743 -1.01851986 -0.95413685]
mat_Sqrt:  [[13.70563331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00554974 0.00812905 0.10094871]
Stock Position:  0.005549743255407071
Bond Position:  [2.13412382]


portfolio before change:  [2.68073366]
curr_Stock_Price:  98.44474605905907
curr_Factors:  [98.44474606 -1.20729124 -0.96914229]
mat_Sqrt:  [[11.16810455  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02435417 0.02670099 0.30368258]
Stock Position:  0.02435417210267668
Bond Position:  [0.28319338]


portfolio before change:  [2.67041657]
curr_Stock_Price:  98.01966509696268
curr_Factors:  [98.0196651  -0.9423727  -0.96160904]
mat_Sqrt:  [[14.60240704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01372971 -0.0793403  -0.00901099]
Stock Position:  -0.013729705600492893
Bond Position:  [4.01619771]


portfolio before change:  [2.67868086]
curr_Stock_Price:  97.45430484056295
curr_Factors:  [97.45430484 -0.9788327  -0.93814968]
mat_Sqrt:  [[14.33065888  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00067957 -0.00567612  0.26779872]
Stock Position:  -0.0006795734461619217
Bond Position:  [2.74490821]


portfolio before change:  [2.67931093]
curr_Stock_Price:  97.03206488113376
curr_Factors:  [97.03206488 -0.88721886 -0.95260782]
mat_Sqrt:  [[15.41305389  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111023  0.05817376 -0.25450088]
Stock Position:  -0.0011102305686271374
Bond Position:  [2.7870389]


portfolio before change:  [2.67826542]
curr_Stock_Price:  98.28758212170325
curr_Factors:  [98.28758212 -0.77924601 -0.93889955]
mat_Sqrt:  [[17.63264705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003283  -0.04121754  0.14273059]
Stock Position:  -0.00032830064128409073
Bond Position:  [2.7105333]


portfolio before change:  [2.6783871]
curr_Stock_Price:  98.94905945173281
curr_Factors:  [98.94905945 -0.62633751 -0.95295297]
mat_Sqrt:  [[20.39550816  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00125327  0.02889987 -0.13556314]
Stock Position:  -0.001253265600679927
Bond Position:  [2.80239655]


portfolio before change:  [2.67834368]
curr_Stock_Price:  99.26322989051107
curr_Factors:  [99.26322989 -0.6227614  -0.95850764]
mat_Sqrt:  [[20.41982334  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00326302 -0.00446492  0.0594358 ]
Stock Position:  0.003263024196684646
Bond Position:  [2.35444536]


portfolio before change:  [2.67210837]
curr_Stock_Price:  97.26213117843032
curr_Factors:  [97.26213118 -0.88484403 -0.97964831]
mat_Sqrt:  [[15.07318545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00314176  0.01941854 -0.1712311 ]
Stock Position:  0.00314176304857062
Bond Position:  [2.3665338]


portfolio before change:  [2.67254343]
curr_Stock_Price:  97.30644688976757
curr_Factors:  [97.30644689 -0.70142743 -0.97278544]
mat_Sqrt:  [[18.2406455   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00210141 -0.01826269 -0.0632701 ]
Stock Position:  -0.002101405582618161
Bond Position:  [2.87702374]


portfolio before change:  [2.67395243]
curr_Stock_Price:  96.80709440898026
curr_Factors:  [96.80709441 -0.9343063  -0.95117693]
mat_Sqrt:  [[14.6910292   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041796  0.03093575 -0.31800662]
Stock Position:  -0.0004179636799773732
Bond Position:  [2.71441428]


portfolio before change:  [2.67426575]
curr_Stock_Price:  96.86929808881676
curr_Factors:  [96.86929809 -1.04514814 -0.93538221]
mat_Sqrt:  [[13.3675788   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330069 -0.00597692 -0.06694307]
Stock Position:  -0.0033006886281813697
Bond Position:  [2.99400114]


portfolio before change:  [2.67643798]
curr_Stock_Price:  96.32457702281464
curr_Factors:  [96.32457702 -1.17985922 -0.91392391]
mat_Sqrt:  [[11.86912356  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.01548349e-04  1.13112918e-01 -8.20447159e-01]
Stock Position:  -0.0007015483490332191
Bond Position:  [2.74401433]


portfolio before change:  [2.67621017]
curr_Stock_Price:  97.13825592821142
curr_Factors:  [97.13825593 -1.22809281 -0.92948262]
mat_Sqrt:  [[11.22967529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00313046 0.00962764 0.12376729]
Stock Position:  0.0031304628716175686
Bond Position:  [2.37212246]


portfolio before change:  [2.6760385]
curr_Stock_Price:  96.9886930425904
curr_Factors:  [96.98869304 -1.40259914 -0.95194467]
mat_Sqrt:  [[ 9.20779672  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00113688 -0.01322365  0.21215579]
Stock Position:  0.0011368780522803003
Bond Position:  [2.56577418]


portfolio before change:  [2.67573702]
curr_Stock_Price:  96.44138777765141
curr_Factors:  [96.44138778 -1.2348607  -0.94446967]
mat_Sqrt:  [[10.90918471  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00829099 -0.00362784 -0.69661535]
Stock Position:  0.008290987616174002
Bond Position:  [1.87614267]


portfolio before change:  [2.66990706]
curr_Stock_Price:  95.70993199845073
curr_Factors:  [95.709932   -1.03539774 -0.94196376]
mat_Sqrt:  [[13.24951006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00722032  0.00573407  0.00118545]
Stock Position:  -0.007220319126805303
Bond Position:  [3.36096332]


portfolio before change:  [2.67578762]
curr_Stock_Price:  94.95367616407505
curr_Factors:  [94.95367616 -0.94152709 -0.92901657]
mat_Sqrt:  [[14.62665428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0079527  -0.00842867  0.53266496]
Stock Position:  -0.007952704956553728
Bond Position:  [3.43092619]


portfolio before change:  [2.66990008]
curr_Stock_Price:  95.74792591282757
curr_Factors:  [95.74792591 -0.79209363 -0.93158853]
mat_Sqrt:  [[17.08219695  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00359454 -0.01096377 -0.03377552]
Stock Position:  -0.0035945423150329442
Bond Position:  [3.01407005]


portfolio before change:  [2.67442622]
curr_Stock_Price:  94.59357639022264
curr_Factors:  [94.59357639 -0.64647884 -0.90902465]
mat_Sqrt:  [[19.96710331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00396236  0.04186678 -0.14779935]
Stock Position:  -0.003962360278968744
Bond Position:  [3.04924005]


portfolio before change:  [2.67004979]
curr_Stock_Price:  95.79427775002296
curr_Factors:  [95.79427775 -0.72693362 -0.9019003 ]
mat_Sqrt:  [[18.790831    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00540921 -0.01249323  0.38600614]
Stock Position:  0.0054092134325882035
Bond Position:  [2.15187809]


portfolio before change:  [2.66940204]
curr_Stock_Price:  95.62479858224175
curr_Factors:  [95.62479858 -0.77257466 -0.9129166 ]
mat_Sqrt:  [[17.72437701  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.001543    0.01548947 -0.23158822]
Stock Position:  0.0015429975602301031
Bond Position:  [2.52185321]


portfolio before change:  [2.67162103]
curr_Stock_Price:  96.85859148313322
curr_Factors:  [96.85859148 -0.75006203 -0.90528328]
mat_Sqrt:  [[18.5025172   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039072 -0.00960553 -0.09549538]
Stock Position:  -0.0003907247083466212
Bond Position:  [2.70946607]


portfolio before change:  [2.67175107]
curr_Stock_Price:  97.39263423032477
curr_Factors:  [97.39263423 -0.8124968  -0.89102067]
mat_Sqrt:  [[17.72955664  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.31889293e-04  3.13244065e-02 -2.99778492e-01]
Stock Position:  -0.00013188929270423885
Bond Position:  [2.68459612]


portfolio before change:  [2.67200473]
curr_Stock_Price:  98.01387522967926
curr_Factors:  [98.01387523 -0.86873433 -0.90926595]
mat_Sqrt:  [[16.56196451  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328365  0.0086622  -0.28550967]
Stock Position:  -0.0032836494680922915
Bond Position:  [2.99384794]


portfolio before change:  [2.67431738]
curr_Stock_Price:  97.42355750720787
curr_Factors:  [97.42355751 -0.92984369 -0.89180954]
mat_Sqrt:  [[15.7590502   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00436368 -0.01072536  0.50184731]
Stock Position:  0.004363676005326194
Bond Position:  [2.24919254]


portfolio before change:  [2.67024638]
curr_Stock_Price:  96.42619468400203
curr_Factors:  [96.42619468 -0.87379721 -0.88103333]
mat_Sqrt:  [[16.67561309  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00472515 -0.00034999 -0.0817955 ]
Stock Position:  -0.004725149463929964
Bond Position:  [3.12587456]


portfolio before change:  [2.66521503]
curr_Stock_Price:  97.57369420745083
curr_Factors:  [97.57369421 -0.95121254 -0.84974389]
mat_Sqrt:  [[16.11340444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.51870575e-03 -2.80310777e-02 -2.14947606e-05]
Stock Position:  -0.0025187057548991774
Bond Position:  [2.91097446]


portfolio before change:  [2.66979301]
curr_Stock_Price:  95.90057861086643
curr_Factors:  [95.90057861 -1.03368948 -0.84114051]
mat_Sqrt:  [[14.70933052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00861995 0.03391114 0.55116406]
Stock Position:  0.008619949896440363
Bond Position:  [1.84313483]


portfolio before change:  [2.66756414]
curr_Stock_Price:  95.61527835830528
curr_Factors:  [95.61527836 -0.9444181  -0.83166224]
mat_Sqrt:  [[16.18770948  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00693751 -0.03864163 -0.46611477]
Stock Position:  0.0069375075320486845
Bond Position:  [2.00423243]


portfolio before change:  [2.66372966]
curr_Stock_Price:  95.02644589376595
curr_Factors:  [95.02644589 -0.83981271 -0.83388782]
mat_Sqrt:  [[17.82237508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00627026 0.00095567 0.16813138]
Stock Position:  0.006270262539832204
Bond Position:  [2.0678889]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.65864582]
Stock Price:  94.17443347334171
PL:  [2.65864582]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.57106826e-01 -9.73704322e-02  1.74269811e-02]
 [-1.01902640e-01  7.11473058e-02 -1.03734454e-01]
 [-1.54099653e-02  2.73512118e-02  3.55947770e-02]
 [ 3.93280878e-03 -1.55215061e-02  5.45249198e-02]
 [ 1.04895176e-01 -7.19091669e-02 -8.83812773e-02]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.21583210e-02 -1.77130122e-01 -2.76136344e-02]
 [ 9.87959053e-03  6.23560862e-01  9.16585889e-02]
 [ 3.16611932e-01  8.71545578e-03  3.28541898e-01]
 [ 5.98426267e-01  2.64381718e-01  5.09614108e-01]
 [-1.33748591e-01 -1.64348282e-01  4.32666316e-02]
 [-5.37206308e-02 -1.85697379e-02  9.03530033e-02]
 [ 6.63842084e-03 -5.93448889e-02  1.34330632e-01]
 [ 1.09408351e-02 -6.38748660e-02 -1.67855091e-01]
 [ 1.82411149e-01 -1.00053111e-01 -1.27182108e-01]
 [-3.17334860e-02 -4.13368956e-02  7.66886626e-02]
 [ 6.46729822e-02  2.68376693e-02 -1.00005511e-01]
 [-2.08357464e-02 -5.62859973e-02 -2.34622657e-02]
 [ 7.26724314e-02  4.38809909e-02 -2.91230631e-01]
 [-4.31662755e-03  2.23838648e-02 -4.95259639e-02]
 [-5.03997040e-02  6.06545201e-01 -5.91893010e-01]
 [ 3.73192824e-01  2.14012147e-01  6.16061071e-02]
 [-1.05771216e-03 -1.97842843e-02  6.14529875e-02]
 [ 3.86314655e-02 -2.36700998e-04 -1.25853707e-01]
 [ 3.00930462e-02  1.93617942e-02 -1.22108272e-02]
 [-1.09907038e-01 -1.79710119e-02  2.21541795e-01]
 [-3.40173175e-02 -3.31917345e-02 -4.90239862e-03]
 [-8.55812882e-02  8.13125884e-02 -1.82726253e-01]
 [-2.29364282e-02 -4.07327571e-02  4.84237430e-02]
 [-3.88320439e-02  1.79472819e-02 -9.59274313e-03]
 [-1.15585262e-02 -4.21909528e-02 -2.78450582e-02]
 [ 1.64609260e-02  9.48309512e-02 -7.80756752e-02]
 [-4.08760071e-02  2.16168613e-02 -8.94859645e-02]
 [ 1.66606856e-02 -6.27774124e-02  2.62470303e-02]
 [-2.53249819e-02  8.88673810e-02  3.91454760e-02]
 [ 8.55302526e-02  1.40569652e-02  1.73387109e-01]
 [ 5.00896362e-02 -3.88023380e-02  1.23341204e-04]
 [-7.57500104e-02  7.67506140e-03  4.07081982e-02]
 [ 1.58448097e-01 -4.72827749e-03  1.02465269e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.02565019]
curr_Stock_Price:  100.45789194484098
curr_Factors:  [100.45789194  -1.06153716  -1.00843144]
mat_Sqrt:  [[12.67675562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01368057 -0.03142617  0.04971433]
Stock Position:  -0.013680567782712915
Bond Position:  [7.39997119]


portfolio before change:  [6.02182969]
curr_Stock_Price:  100.80477519716766
curr_Factors:  [100.8047752   -1.06383535  -1.00412955]
mat_Sqrt:  [[12.7460424   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00851672  0.02296269 -0.29592552]
Stock Position:  -0.008516719162024063
Bond Position:  [6.88035565]


portfolio before change:  [6.02660449]
curr_Stock_Price:  100.34512525154189
curr_Factors:  [100.34512525  -1.08287849  -1.0120163 ]
mat_Sqrt:  [[12.35079839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00020737  0.00882757  0.10154199]
Stock Position:  -0.00020736871325576227
Bond Position:  [6.04741293]


portfolio before change:  [6.02728531]
curr_Stock_Price:  100.70754651610876
curr_Factors:  [100.70754652  -1.03975146  -1.00057526]
mat_Sqrt:  [[13.09059482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090862 -0.00500954  0.15554442]
Stock Position:  0.0009086177845897039
Bond Position:  [5.93578064]


portfolio before change:  [6.02790587]
curr_Stock_Price:  100.57386577299155
curr_Factors:  [100.57386577  -1.12144091  -0.99855029]
mat_Sqrt:  [[12.07215111  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00597872 -0.02320858 -0.25212718]
Stock Position:  0.005978721231295387
Bond Position:  [5.42660276]


portfolio before change:  [6.03703829]
curr_Stock_Price:  101.98788903048721
curr_Factors:  [101.98788903  -1.4759065   -1.04148221]
mat_Sqrt:  [[ 8.22736141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01863346 -0.05534923  0.15513819]
Stock Position:  -0.018633458342108035
Bond Position:  [7.93742537]


portfolio before change:  [6.04466218]
curr_Stock_Price:  101.6319887016733
curr_Factors:  [101.6319887   -1.16779932  -1.03959486]
mat_Sqrt:  [[11.17818545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00840489 -0.0571685  -0.07877401]
Stock Position:  -0.008404894129929986
Bond Position:  [6.89886828]


portfolio before change:  [6.04303893]
curr_Stock_Price:  101.92772831438043
curr_Factors:  [101.92772831  -1.16406567  -1.00407196]
mat_Sqrt:  [[11.65955935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0133687  0.2012534  0.26147644]
Stock Position:  0.013368699878696851
Bond Position:  [4.68039772]


portfolio before change:  [6.04868311]
curr_Stock_Price:  102.30615613299005
curr_Factors:  [102.30615613  -1.23822124  -1.0168448 ]
mat_Sqrt:  [[10.72850064  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03592807 0.0028129  0.93723859]
Stock Position:  0.035928068012654316
Bond Position:  [2.37302057]


portfolio before change:  [6.06240788]
curr_Stock_Price:  102.67990653970375
curr_Factors:  [102.67990654  -1.1133001   -1.02234465]
mat_Sqrt:  [[12.13351792  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06234115 0.08532883 1.4537872 ]
Stock Position:  0.06234115352057836
Bond Position:  [-0.33877593]


portfolio before change:  [6.02727727]
curr_Stock_Price:  102.11706386537038
curr_Factors:  [102.11706387  -0.98182267  -1.05401894]
mat_Sqrt:  [[13.33348086  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01188469 -0.05304318  0.12342766]
Stock Position:  -0.011884689460481879
Bond Position:  [7.24090686]


portfolio before change:  [6.04431128]
curr_Stock_Price:  100.7599534707983
curr_Factors:  [100.75995347  -0.77592497  -1.05209992]
mat_Sqrt:  [[16.1952194   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00241231 -0.00599336  0.25775197]
Stock Position:  -0.002412312683213735
Bond Position:  [6.28737579]


portfolio before change:  [6.04699749]
curr_Stock_Price:  99.97222763499632
curr_Factors:  [99.97222763 -0.7165057  -1.04302102]
mat_Sqrt:  [[17.2078506   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00127528 -0.01915348  0.3832079 ]
Stock Position:  0.0012752796451848212
Bond Position:  [5.91950494]


portfolio before change:  [6.0489377]
curr_Stock_Price:  100.91337529931896
curr_Factors:  [100.9133753   -0.74637488  -1.05158742]
mat_Sqrt:  [[16.71489391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217536 -0.02061552 -0.47884385]
Stock Position:  -0.0021753559685256593
Bond Position:  [6.26846021]


portfolio before change:  [6.04914758]
curr_Stock_Price:  101.17711222530235
curr_Factors:  [101.17711223  -0.51077279  -1.05165441]
mat_Sqrt:  [[21.20941893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00641352 -0.032292   -0.36281515]
Stock Position:  0.006413516328501199
Bond Position:  [5.40024652]


portfolio before change:  [6.04030542]
curr_Stock_Price:  99.69317813855747
curr_Factors:  [99.69317814 -0.20398912 -1.0642778 ]
mat_Sqrt:  [[28.04556002  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008742  -0.01334143  0.21877141]
Stock Position:  -0.0008741967272650047
Bond Position:  [6.12745687]


portfolio before change:  [6.0417347]
curr_Stock_Price:  98.93442555132715
curr_Factors:  [ 9.89344256e+01 -2.80209584e-02 -1.04821380e+00]
mat_Sqrt:  [[33.72443025  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147483  0.00866182 -0.28528789]
Stock Position:  0.0014748257781429274
Bond Position:  [5.89582366]


portfolio before change:  [6.04121093]
curr_Stock_Price:  98.07954677318257
curr_Factors:  [ 9.80795468e+01 -2.14464521e-02 -1.04078220e+00]
mat_Sqrt:  [[33.904583    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109467 -0.01816623 -0.06693131]
Stock Position:  -0.0010946688957307862
Bond Position:  [6.14857556]


portfolio before change:  [6.0409745]
curr_Stock_Price:  98.9976751205687
curr_Factors:  [ 9.89976751e+01 -7.78598367e-03 -1.02140531e+00]
mat_Sqrt:  [[35.37145269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.27127127e-04  1.41625289e-02 -8.30799928e-01]
Stock Position:  0.0006271271271211272
Bond Position:  [5.97889037]


portfolio before change:  [6.04278567]
curr_Stock_Price:  100.69392412832791
curr_Factors:  [100.69392413  -0.33026056  -1.01707359]
mat_Sqrt:  [[26.17360122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003766   0.00722436 -0.14128379]
Stock Position:  -0.00037660027185124
Bond Position:  [6.08070703]


portfolio before change:  [6.0437083]
curr_Stock_Price:  100.26246566876495
curr_Factors:  [100.26246567  -0.21386929  -1.01609129]
mat_Sqrt:  [[29.30712998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.61765544e-03  1.95761622e-01 -1.68850601e+00]
Stock Position:  -0.001617655439977672
Bond Position:  [6.20589842]


portfolio before change:  [6.04479387]
curr_Stock_Price:  100.0709594691182
curr_Factors:  [100.07095947  -0.54678121  -1.01795274]
mat_Sqrt:  [[20.92920544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02051932 0.06907212 0.17574508]
Stock Position:  0.02051932483704498
Bond Position:  [3.99140535]


portfolio before change:  [6.02681588]
curr_Stock_Price:  99.17049362050243
curr_Factors:  [99.17049362 -0.64806483 -1.03118802]
mat_Sqrt:  [[18.49661385  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040266 -0.00638535  0.17530827]
Stock Position:  0.0004026616083626002
Bond Position:  [5.98688373]


portfolio before change:  [6.02689864]
curr_Stock_Price:  97.5173757523298
curr_Factors:  [97.51737575 -0.83888755 -1.05094792]
mat_Sqrt:  [[14.73455042  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.75043236e-04 -7.63949185e-05 -3.59025596e-01]
Stock Position:  0.000875043236302351
Bond Position:  [5.94156672]


portfolio before change:  [6.02902679]
curr_Stock_Price:  99.10062520698834
curr_Factors:  [99.10062521 -1.03346714 -1.0508749 ]
mat_Sqrt:  [[12.32702124  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00255964  0.00624899 -0.03483409]
Stock Position:  0.002559639561767387
Bond Position:  [5.77536491]


portfolio before change:  [6.02708158]
curr_Stock_Price:  98.05861026612732
curr_Factors:  [98.05861027 -0.8116848  -1.04755752]
mat_Sqrt:  [[15.27661217  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00447438 -0.00580012  0.63199708]
Stock Position:  -0.00447437726895467
Bond Position:  [6.46583279]


portfolio before change:  [6.03048071]
curr_Stock_Price:  97.47956815219479
curr_Factors:  [97.47956815 -0.76015154 -1.04838046]
mat_Sqrt:  [[15.97637076  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261594 -0.01071259 -0.01398518]
Stock Position:  -0.002615941408805379
Bond Position:  [6.28548155]


portfolio before change:  [6.03032452]
curr_Stock_Price:  97.83963829446083
curr_Factors:  [97.83963829 -0.86709805 -1.07089537]
mat_Sqrt:  [[14.08818318  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00754407  0.02624353 -0.52126714]
Stock Position:  -0.007544071819296179
Bond Position:  [6.76843378]


portfolio before change:  [6.02434903]
curr_Stock_Price:  98.74387084957324
curr_Factors:  [98.74387085 -0.81767336 -1.06263332]
mat_Sqrt:  [[15.06271742  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014185  -0.01314644  0.13813946]
Stock Position:  -0.0014185031614160682
Bond Position:  [6.16441752]


portfolio before change:  [6.02544646]
curr_Stock_Price:  98.51346898351478
curr_Factors:  [98.51346898 -0.71952634 -1.02093157]
mat_Sqrt:  [[17.28320748  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214814  0.00579246 -0.02736543]
Stock Position:  -0.002148136038181599
Bond Position:  [6.23706679]


portfolio before change:  [6.02503384]
curr_Stock_Price:  99.06850847396412
curr_Factors:  [99.06850847 -0.7231802  -1.02070904]
mat_Sqrt:  [[17.32104736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149267 -0.01361707 -0.0794342 ]
Stock Position:  -0.001492667649395421
Bond Position:  [6.1729102]


portfolio before change:  [6.02657208]
curr_Stock_Price:  98.55494299247628
curr_Factors:  [98.55494299 -0.76152927 -1.02177879]
mat_Sqrt:  [[16.56523342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120017  0.03060656 -0.22272817]
Stock Position:  0.0012001691688283142
Bond Position:  [5.90828948]


portfolio before change:  [6.02923431]
curr_Stock_Price:  100.15775660636503
curr_Factors:  [100.15775661  -0.49879349  -0.99896057]
mat_Sqrt:  [[22.3984654   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244346  0.00697681 -0.25527855]
Stock Position:  -0.0024434589074302446
Bond Position:  [6.27396568]


portfolio before change:  [6.02937807]
curr_Stock_Price:  100.41990181155016
curr_Factors:  [100.41990181  -0.4540882   -1.00348219]
mat_Sqrt:  [[23.37787402  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0003937  -0.02026132  0.07487547]
Stock Position:  0.00039370357595407205
Bond Position:  [5.98984239]


portfolio before change:  [6.03069765]
curr_Stock_Price:  101.86974306634066
curr_Factors:  [101.86974307  -0.29121586  -1.02288784]
mat_Sqrt:  [[27.37393479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.94270114e-05 2.86818239e-02 1.11671147e-01]
Stock Position:  2.9427011394215708e-05
Bond Position:  [6.02769993]


portfolio before change:  [6.03143552]
curr_Stock_Price:  101.33826744028634
curr_Factors:  [101.33826744  -0.53011136  -1.05336032]
mat_Sqrt:  [[20.80082046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00595131 0.00453687 0.49462516]
Stock Position:  0.005951309192139
Bond Position:  [5.42834016]


portfolio before change:  [6.0372163]
curr_Stock_Price:  102.19558972820093
curr_Factors:  [102.19558973  -0.57361634  -1.07246782]
mat_Sqrt:  [[19.70365925  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00214145 -0.0125234   0.00035186]
Stock Position:  0.0021414458353011968
Bond Position:  [5.81836998]


portfolio before change:  [6.0378226]
curr_Stock_Price:  102.13906728464634
curr_Factors:  [102.13906728  -0.66651103  -1.08382065]
mat_Sqrt:  [[17.74322243  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00371262  0.00247712  0.11612916]
Stock Position:  -0.00371261867256561
Bond Position:  [6.41702601]


portfolio before change:  [6.03351752]
curr_Stock_Price:  103.51471545156218
curr_Factors:  [103.51471545  -0.70641136  -1.09449132]
mat_Sqrt:  [[17.09542864  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01043546 -0.00152604  0.29230489]
Stock Position:  0.010435455051310692
Bond Position:  [4.95329436]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.0312826]
Stock Price:  103.24121297402243
PL:  [2.79006962]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-8.39759685e-02 -8.80923483e-02  1.45718306e-02]
 [-9.31995224e-02  9.92632933e-02 -7.06704830e-02]
 [-2.85056672e-03 -1.71077774e-02  3.89414134e-02]
 [-9.90724301e-02 -7.50787197e-02 -5.49839490e-02]
 [ 1.36926003e-01 -1.25295845e-01 -9.67013070e-02]
 [-1.29750883e-01 -1.91511124e-01 -8.36963805e-02]
 [-5.06224737e-02 -1.34048475e-01 -4.97476397e-02]
 [ 4.61589174e-04  8.08204958e-01  1.30620812e-01]
 [ 2.95182772e-01 -8.22776127e-05  3.13553149e-01]
 [ 6.75498748e-01  3.09307483e-01  6.15948742e-01]
 [-1.17059644e-01 -2.11349492e-01 -2.55610744e-03]
 [-7.54702351e-02 -2.05915182e-02  7.97321980e-02]
 [ 1.55206027e-02 -7.72017935e-02  9.32963697e-02]
 [ 1.87824723e-03  9.63821177e-02 -4.51232518e-02]
 [ 4.75933879e-01 -1.39500820e-01 -2.25151789e-01]
 [-1.92132280e-01 -9.51298324e-02  1.14756678e-01]
 [ 5.09640642e-02  1.78161720e-02 -2.49960269e-02]
 [-6.05806707e-02 -6.29135270e-02  2.32336356e-02]
 [ 1.75681681e-01 -2.17670280e-01  4.53928557e-02]
 [ 4.58831018e-02 -2.73061642e-03  3.62403363e-01]
 [-4.63256224e-02  5.75147150e-01 -5.57810483e-01]
 [ 3.79780021e-01  2.17164098e-01  6.05334285e-02]
 [-1.02570169e-01  1.44990323e-01 -6.57956493e-02]
 [-5.67727088e-02 -1.24240858e-01 -2.61327473e-02]
 [ 1.83238456e-02 -3.44864672e-02 -9.68201188e-03]
 [-3.93840153e-02  3.90743223e-03  1.15933193e-01]
 [ 8.38449948e-02 -2.97327029e-02  2.88109404e-02]
 [ 1.69200954e-01 -5.16844617e-02  2.26524836e-01]
 [-6.10885096e-02 -3.12492243e-02 -9.44451171e-03]
 [-9.67927309e-02 -1.06527633e-02  5.16450462e-02]
 [ 1.45525029e-01  2.45653036e-02  5.38174188e-02]
 [ 2.63437306e-02 -4.89137694e-02 -1.09047683e-01]
 [-4.11526923e-02  2.05770853e-02 -6.62502900e-02]
 [ 1.62532372e-02 -6.33581146e-02  2.29832154e-02]
 [-3.95157806e-02  1.10634481e-01  9.11062728e-03]
 [ 8.77022744e-02 -2.38567169e-02  1.37400996e-01]
 [-6.48296879e-02  7.92380681e-02 -1.95813318e-02]
 [-3.47765635e-02 -3.09638141e-02  9.59339028e-03]
 [ 9.67606105e-02  4.42029216e-03  7.28809130e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.59682926]
curr_Stock_Price:  100.15168455119637
curr_Factors:  [100.15168455  -1.04159183  -1.00306958]
mat_Sqrt:  [[12.96203202  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0076364  -0.02843168  0.04156938]
Stock Position:  -0.007636401547477617
Bond Position:  [4.36162774]


portfolio before change:  [3.58499979]
curr_Stock_Price:  101.77217328032746
curr_Factors:  [101.77217328  -1.28405123  -0.98016396]
mat_Sqrt:  [[10.57530465  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00826104  0.03203709 -0.20160322]
Stock Position:  -0.008261042339018318
Bond Position:  [4.42574403]


portfolio before change:  [3.58543921]
curr_Stock_Price:  101.7859528454888
curr_Factors:  [101.78595285  -1.2312034   -0.9687135 ]
mat_Sqrt:  [[11.27914232  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0001424  -0.00552151  0.11108901]
Stock Position:  0.00014240493802927882
Bond Position:  [3.57094439]


portfolio before change:  [3.5857921]
curr_Stock_Price:  101.1293391872265
curr_Factors:  [101.12933919  -1.12909031  -0.95835714]
mat_Sqrt:  [[12.54036747  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01001736 -0.02423155 -0.1568539 ]
Stock Position:  -0.010017358860175064
Bond Position:  [4.59884099]


portfolio before change:  [3.58697691]
curr_Stock_Price:  101.0684534434698
curr_Factors:  [101.06845344  -0.90266438  -0.98604835]
mat_Sqrt:  [[15.28826161  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00599225 -0.04043906 -0.27586191]
Stock Position:  0.005992245964197811
Bond Position:  [2.98134988]


portfolio before change:  [3.60167646]
curr_Stock_Price:  103.45935365681679
curr_Factors:  [103.45935366  -1.28804819  -0.98313467]
mat_Sqrt:  [[10.67597571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01741549 -0.06180995 -0.23876248]
Stock Position:  -0.017415492976096934
Bond Position:  [5.40347211]


portfolio before change:  [3.59645189]
curr_Stock_Price:  103.79813518740839
curr_Factors:  [103.79813519  -1.55400273  -0.95606234]
mat_Sqrt:  [[ 8.43494285  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01044935 -0.04326396 -0.14191617]
Stock Position:  -0.010449353362184168
Bond Position:  [4.68107529]


portfolio before change:  [3.59842032]
curr_Stock_Price:  103.66575760126807
curr_Factors:  [103.6657576   -1.42937054  -0.97862223]
mat_Sqrt:  [[ 9.32947823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0205905  0.26084703 0.37262482]
Stock Position:  0.020590497359628944
Bond Position:  [1.46389082]


portfolio before change:  [3.59526515]
curr_Stock_Price:  103.50363559109525
curr_Factors:  [103.50363559  -1.62595216  -0.95714306]
mat_Sqrt:  [[ 7.81864697  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.59375833e-02 -2.65549853e-05  8.94479859e-01]
Stock Position:  0.04593758325761576
Bond Position:  [-1.15944173]


portfolio before change:  [3.59918904]
curr_Stock_Price:  103.59220859210629
curr_Factors:  [103.59220859  -1.20246338  -0.97063118]
mat_Sqrt:  [[11.79136601  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07330498 0.09982856 1.75713031]
Stock Position:  0.07330498294900006
Bond Position:  [-3.99463605]


portfolio before change:  [3.57384964]
curr_Stock_Price:  103.25334979663292
curr_Factors:  [103.2533498   -1.22374288  -1.0024618 ]
mat_Sqrt:  [[11.14488881  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01442122 -0.06821276 -0.00729186]
Stock Position:  -0.014421224332154006
Bond Position:  [5.06288936]


portfolio before change:  [3.56320337]
curr_Stock_Price:  104.0354729494913
curr_Factors:  [104.03547295  -1.25122589  -1.033494  ]
mat_Sqrt:  [[10.59107897  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.005986   -0.00664588  0.22745377]
Stock Position:  -0.005985999586965306
Bond Position:  [4.18595967]


portfolio before change:  [3.5608637]
curr_Stock_Price:  104.51374677107766
curr_Factors:  [104.51374677  -1.13161654  -1.03345494]
mat_Sqrt:  [[11.99208839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00156819 -0.02491677  0.26614857]
Stock Position:  0.0015681917663979907
Bond Position:  [3.3969661]


portfolio before change:  [3.56184081]
curr_Stock_Price:  104.86603986605432
curr_Factors:  [104.86603987  -1.04297731  -1.01056819]
mat_Sqrt:  [[13.45214023  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00091743  0.03110719 -0.12872408]
Stock Position:  0.0009174316665693448
Bond Position:  [3.46563338]


portfolio before change:  [3.5617477]
curr_Stock_Price:  104.29233122489214
curr_Factors:  [104.29233122  -0.79525918  -1.03375763]
mat_Sqrt:  [[16.74636163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02397533 -0.0450237  -0.64229538]
Stock Position:  0.02397532582122146
Bond Position:  [1.06130508]


portfolio before change:  [3.57097505]
curr_Stock_Price:  104.67166630191576
curr_Factors:  [104.6716663   -0.9892001   -1.02540891]
mat_Sqrt:  [[13.96032602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01347576 -0.03070302  0.32736886]
Stock Position:  -0.01347575738967546
Bond Position:  [4.98150504]


portfolio before change:  [3.56380425]
curr_Stock_Price:  105.25000365385254
curr_Factors:  [105.25000365  -0.77506822  -1.0188148 ]
mat_Sqrt:  [[17.50445617  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00282776  0.00575014 -0.07130671]
Stock Position:  0.002827764653876153
Bond Position:  [3.26618201]


portfolio before change:  [3.56112314]
curr_Stock_Price:  104.15747919459598
curr_Factors:  [104.15747919  -0.53266066  -1.03423674]
mat_Sqrt:  [[21.73679783  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00315963 -0.02030525  0.0662791 ]
Stock Position:  -0.0031596325794573973
Bond Position:  [3.89022251]


portfolio before change:  [3.55901532]
curr_Stock_Price:  104.97850222263129
curr_Factors:  [104.97850222  -0.61298115  -1.02545556]
mat_Sqrt:  [[20.39559356  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00688951 -0.07025278  0.12949318]
Stock Position:  0.006889512587189478
Bond Position:  [2.83576461]


portfolio before change:  [3.56126475]
curr_Stock_Price:  105.25354913559273
curr_Factors:  [105.25354914  -0.54233109  -1.03248951]
mat_Sqrt:  [[21.79218884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.47448422e-03 -8.81302661e-04  1.03383592e+00]
Stock Position:  0.005474484219169515
Bond Position:  [2.98505586]


portfolio before change:  [3.56034639]
curr_Stock_Price:  105.01763234880907
curr_Factors:  [105.01763235  -0.53828257  -1.04362633]
mat_Sqrt:  [[21.58976506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198181  0.18562794 -1.59127804]
Stock Position:  -0.0019818089686524662
Bond Position:  [3.76847127]


portfolio before change:  [3.55971559]
curr_Stock_Price:  105.57363094937801
curr_Factors:  [105.57363095  -0.46554065  -1.04963876]
mat_Sqrt:  [[23.20178511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01881169 0.07008941 0.17268502]
Stock Position:  0.018811690110624637
Bond Position:  [1.57369716]


portfolio before change:  [3.54168789]
curr_Stock_Price:  104.60484917435663
curr_Factors:  [ 1.04604849e+02 -9.51850113e-02 -1.04540912e+00]
mat_Sqrt:  [[33.43475006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258428  0.04679543 -0.18769667]
Stock Position:  -0.0025842760663777904
Bond Position:  [3.8120157]


portfolio before change:  [3.54442491]
curr_Stock_Price:  103.7301398599007
curr_Factors:  [ 1.03730140e+02 -7.73841450e-02 -1.06316145e+00]
mat_Sqrt:  [[33.15677675  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.002638   -0.04009856 -0.07454945]
Stock Position:  -0.0026380004660911845
Bond Position:  [3.81806507]


portfolio before change:  [3.54523827]
curr_Stock_Price:  103.60274545530505
curr_Factors:  [ 1.03602745e+02 -2.19590465e-02 -1.09672486e+00]
mat_Sqrt:  [[33.84800033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00027499 -0.01113046 -0.02762008]
Stock Position:  0.00027499386916513924
Bond Position:  [3.51674815]


portfolio before change:  [3.54548486]
curr_Stock_Price:  102.90081232764358
curr_Factors:  [ 1.02900812e+02 -1.56055710e-02 -1.08835171e+00]
mat_Sqrt:  [[34.11742517  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043736  0.00126112  0.33072513]
Stock Position:  -0.0004373615534998113
Bond Position:  [3.59048972]


portfolio before change:  [3.5455048]
curr_Stock_Price:  103.88146411775354
curr_Factors:  [ 1.03881464e+02  6.45439331e-02 -1.09215853e+00]
mat_Sqrt:  [[37.17497727  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00225035 -0.00959619  0.08218959]
Stock Position:  0.0022503535153019366
Bond Position:  [3.31173478]


portfolio before change:  [3.54990543]
curr_Stock_Price:  105.65302459746155
curr_Factors:  [105.6530246    0.17773428  -1.12928325]
mat_Sqrt:  [[40.7971167   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00502217 -0.01668109  0.64621231]
Stock Position:  0.005022170989927086
Bond Position:  [3.01929788]


portfolio before change:  [3.53842847]
curr_Stock_Price:  103.29261180321805
curr_Factors:  [103.2926118    0.31290529  -1.10161604]
mat_Sqrt:  [[46.93929167  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014784  -0.01008564 -0.02694256]
Stock Position:  -0.0014784007432997247
Bond Position:  [3.69113635]


portfolio before change:  [3.54016619]
curr_Stock_Price:  102.42931840957164
curr_Factors:  [102.42931841   0.11103446  -1.11619261]
mat_Sqrt:  [[37.48777323  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00235877 -0.00343816  0.14732894]
Stock Position:  -0.0023587748362809725
Bond Position:  [3.78177389]


portfolio before change:  [3.53496252]
curr_Stock_Price:  104.83583062642273
curr_Factors:  [104.83583063   0.13426529  -1.09144115]
mat_Sqrt:  [[40.25441751  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0040126  0.00792842 0.15352612]
Stock Position:  0.0040125989872194495
Bond Position:  [3.11429837]


portfolio before change:  [3.52541107]
curr_Stock_Price:  102.35844435059862
curr_Factors:  [ 1.02358444e+02  4.33768475e-02 -1.10524745e+00]
mat_Sqrt:  [[35.39640318  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.66684047e-04 -1.57868512e-02 -3.11082685e-01]
Stock Position:  -0.00016668404682216675
Bond Position:  [3.54247259]


portfolio before change:  [3.52606974]
curr_Stock_Price:  101.0636050483635
curr_Factors:  [ 1.01063605e+02 -9.40335982e-02 -1.11161437e+00]
mat_Sqrt:  [[30.26833459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166761  0.00664123 -0.18899364]
Stock Position:  -0.001667607313659413
Bond Position:  [3.69460414]


portfolio before change:  [3.52795846]
curr_Stock_Price:  100.20796592395483
curr_Factors:  [ 1.00207966e+02  1.54808607e-02 -1.09309231e+00]
mat_Sqrt:  [[34.11155689  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00023487 -0.02044874  0.06556472]
Stock Position:  0.00023486894690401562
Bond Position:  [3.50442272]


portfolio before change:  [3.52861682]
curr_Stock_Price:  101.14582272013142
curr_Factors:  [101.14582272   0.21481426  -1.11847961]
mat_Sqrt:  [[40.97236921  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036788  0.03570713  0.02599008]
Stock Position:  -0.0003678799388057812
Bond Position:  [3.56582633]


portfolio before change:  [3.52939432]
curr_Stock_Price:  100.24402648311823
curr_Factors:  [ 1.00244026e+02 -5.10146982e-02 -1.09435035e+00]
mat_Sqrt:  [[31.88840405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00347711 -0.00769972  0.3919668 ]
Stock Position:  0.00347710732577397
Bond Position:  [3.18083509]


portfolio before change:  [3.52728234]
curr_Stock_Price:  99.52227286933585
curr_Factors:  [99.52227287 -0.12552726 -1.08997667]
mat_Sqrt:  [[29.51437823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00178395  0.02557398 -0.05586009]
Stock Position:  -0.0017839544896693744
Bond Position:  [3.70482554]


portfolio before change:  [3.5285213]
curr_Stock_Price:  99.08738173426947
curr_Factors:  [ 9.90873817e+01 -3.35078829e-02 -1.11049571e+00]
mat_Sqrt:  [[31.56340925  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124    -0.00999353  0.02736727]
Stock Position:  -0.001240004928831297
Bond Position:  [3.65139014]


portfolio before change:  [3.52930636]
curr_Stock_Price:  98.82237352761548
curr_Factors:  [98.82237353 -0.11220786 -1.11669796]
mat_Sqrt:  [[28.9166691   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00389186 0.00142664 0.20790896]
Stock Position:  0.003891860867584107
Bond Position:  [3.14470343]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.52423261]
Stock Price:  97.41768277479673
PL:  [3.52423261]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.69491869e-01 -9.05374570e-02  2.05762752e-02]
 [-2.19147922e-01  1.06582548e-01 -3.78313405e-01]
 [-2.77923837e-02  3.93082489e-02  2.68296441e-02]
 [ 6.85360372e-02 -9.58374132e-03  1.15317731e-01]
 [ 6.85552165e-02 -1.32550817e-02 -7.96149426e-02]
 [-6.96891894e-02 -1.50278452e-01  1.65573531e-01]
 [-6.20764077e-02 -1.67017953e-01  6.76600873e-02]
 [ 1.28563773e-02  7.88489957e-01  1.31340405e-01]
 [-1.32491170e-02  5.34046882e-02 -6.36961471e-02]
 [ 2.05771527e-01  7.12167127e-02  8.31395460e-02]
 [-3.09257368e-02 -1.99559061e-01 -6.47378195e-03]
 [ 7.87302426e-02 -1.02963553e-02  1.27132915e-01]
 [ 4.93385528e-03  1.08213285e-03  2.73742493e-02]
 [ 1.39605381e-02 -2.07926326e-01  3.81686539e-02]
 [-3.53900909e-02  8.48456549e-02 -4.08179860e-02]
 [ 1.18817706e-01  1.41244781e-03 -2.25131484e-02]
 [ 4.58395929e-02  2.70133277e-02  4.97580415e-03]
 [-4.41512523e-02 -6.12013204e-02 -2.35485688e-03]
 [ 2.04438755e-02  6.67849938e-02 -1.64011090e-01]
 [-4.04423056e-02 -5.33906314e-03 -3.38133395e-02]
 [-3.28070776e-02  4.41135461e-01 -3.86792745e-01]
 [ 1.78739256e-01  1.20966770e-01  9.32715004e-02]
 [ 4.83607646e-03 -4.63051200e-02  7.76208392e-02]
 [ 8.27464754e-02  1.28658145e-01 -1.27382759e-01]
 [-1.03031203e-01  1.25692187e-02  8.38260973e-04]
 [-1.30947336e-01 -8.43199953e-03  2.17632460e-01]
 [-4.36427338e-02 -3.36071095e-02 -8.60502352e-03]
 [-1.02125137e-01  1.08203075e-01 -1.43050075e-01]
 [ 6.90046592e-04 -3.96813428e-02  6.86416960e-02]
 [-3.54118400e-02  1.69811315e-02 -1.07586038e-02]
 [ 1.36029354e-02 -3.95591432e-02 -5.72380166e-02]
 [ 1.00395635e-02  9.28492813e-02 -8.63817217e-02]
 [-1.57019419e-02  3.52711077e-02 -1.63206688e-02]
 [ 4.27433520e-02 -3.08829537e-02  1.78523234e-01]
 [-6.46896620e-02  3.87152368e-02 -2.38601072e-02]
 [ 4.40298733e-02 -3.72527161e-02  8.38849363e-02]
 [-2.67132019e-02  1.00903434e-01  7.61638080e-02]
 [ 1.22075684e-01 -1.04424683e-01 -1.22842440e-01]
 [ 9.88564923e-02  3.12184044e-03  6.04737089e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.6573569]
curr_Stock_Price:  100.66360519927622
curr_Factors:  [100.6636052   -1.17678292  -1.00602971]
mat_Sqrt:  [[11.34720758  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01619541 -0.02922084  0.05869839]
Stock Position:  -0.01619540611688083
Bond Position:  [9.28764487]


portfolio before change:  [7.6724279]
curr_Stock_Price:  99.80472133653882
curr_Factors:  [99.80472134 -1.18570416 -0.9901794 ]
mat_Sqrt:  [[11.32861619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0242408   0.03439937 -1.07922284]
Stock Position:  -0.024240802781288602
Bond Position:  [10.09177447]


portfolio before change:  [7.66096432]
curr_Stock_Price:  100.32966796771342
curr_Factors:  [100.32966797  -1.30006395  -0.97380577]
mat_Sqrt:  [[10.32524352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138418  0.01268668  0.07653751]
Stock Position:  -0.0013841845796757656
Bond Position:  [7.7998391]


portfolio before change:  [7.66230409]
curr_Stock_Price:  100.06617220503534
curr_Factors:  [100.06617221  -1.33929886  -0.97829286]
mat_Sqrt:  [[ 9.85757283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0091421  -0.00309314  0.32896939]
Stock Position:  0.009142098058906162
Bond Position:  [6.74748933]


portfolio before change:  [7.66238158]
curr_Stock_Price:  99.98238406411913
curr_Factors:  [99.98238406 -1.40119781 -0.99204436]
mat_Sqrt:  [[ 9.13169966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00543143 -0.00427806 -0.22711927]
Stock Position:  0.0054314316087364905
Bond Position:  [7.1193341]


portfolio before change:  [7.6590856]
curr_Stock_Price:  99.21169419341864
curr_Factors:  [99.21169419 -1.6170488  -0.98471248]
mat_Sqrt:  [[ 7.35584044  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00904956 -0.04850216  0.4723352 ]
Stock Position:  -0.00904955662378175
Bond Position:  [8.55690745]


portfolio before change:  [7.66233197]
curr_Stock_Price:  98.97116431608362
curr_Factors:  [98.97116432 -1.58541114 -0.98875396]
mat_Sqrt:  [[ 7.54332784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01091796 -0.05390481  0.1930154 ]
Stock Position:  -0.010917959414363802
Bond Position:  [8.74289513]


portfolio before change:  [7.67761376]
curr_Stock_Price:  97.6715761066552
curr_Factors:  [97.67157611 -1.37591188 -1.01128832]
mat_Sqrt:  [[ 8.97470794  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02235348 0.25448404 0.37467762]
Stock Position:  0.022353481023369082
Bond Position:  [5.49431403]


portfolio before change:  [7.67653306]
curr_Stock_Price:  97.59250434944686
curr_Factors:  [97.59250435 -1.22944696 -0.98650917]
mat_Sqrt:  [[10.64238448  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144233  0.01723629 -0.18170738]
Stock Position:  -0.0014423320534349676
Bond Position:  [7.81729386]


portfolio before change:  [7.67644634]
curr_Stock_Price:  98.33015985020928
curr_Factors:  [98.33015985 -1.28259806 -1.00635851]
mat_Sqrt:  [[ 9.96794284  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02380425 0.0229851  0.23717398]
Stock Position:  0.02380424627827606
Bond Position:  [5.335771]


portfolio before change:  [7.69328817]
curr_Stock_Price:  99.00965300948306
curr_Factors:  [99.00965301 -1.63943535 -1.01989941]
mat_Sqrt:  [[ 6.93015786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01053108 -0.06440741 -0.0184679 ]
Stock Position:  -0.010531075373229806
Bond Position:  [8.73596629]


portfolio before change:  [7.69471515]
curr_Stock_Price:  98.97785071586122
curr_Factors:  [98.97785072 -1.61579379 -1.02892537]
mat_Sqrt:  [[ 7.02993136  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01459181 -0.00332313  0.36267482]
Stock Position:  0.014591807550921194
Bond Position:  [6.2504494]


portfolio before change:  [7.70151936]
curr_Stock_Price:  99.39060680678055
curr_Factors:  [99.39060681 -1.55724928 -1.02819513]
mat_Sqrt:  [[ 7.4903326   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00143418 0.00034926 0.07809111]
Stock Position:  0.0014341806355172295
Bond Position:  [7.55897528]


portfolio before change:  [7.70206858]
curr_Stock_Price:  99.11469328355234
curr_Factors:  [99.11469328 -1.43784323 -1.04197753]
mat_Sqrt:  [[ 8.30167205  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0024924  -0.06710793  0.10888455]
Stock Position:  -0.002492401709779345
Bond Position:  [7.94910221]


portfolio before change:  [7.70378844]
curr_Stock_Price:  98.82334620497797
curr_Factors:  [98.8233462  -1.22850618 -1.04276278]
mat_Sqrt:  [[10.1967079   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258936  0.02738382 -0.11644235]
Stock Position:  -0.0025893632451361665
Bond Position:  [7.95967798]


portfolio before change:  [7.70649512]
curr_Stock_Price:  98.16231190445545
curr_Factors:  [98.1623119  -1.01499015 -1.05509324]
mat_Sqrt:  [[12.38565515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00924542  0.00045587 -0.06422375]
Stock Position:  0.00924541671919554
Bond Position:  [6.79894364]


portfolio before change:  [7.71294521]
curr_Stock_Price:  98.76803581277531
curr_Factors:  [98.76803581 -1.03798705 -1.03105807]
mat_Sqrt:  [[12.47502835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00419793 0.00871851 0.01419458]
Stock Position:  0.004197934118964559
Bond Position:  [7.2983235]


portfolio before change:  [7.71397795]
curr_Stock_Price:  98.79671438934515
curr_Factors:  [98.79671439 -0.98820597 -1.03754273]
mat_Sqrt:  [[13.03079814  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00438381 -0.01975264 -0.00671775]
Stock Position:  -0.00438381455802423
Bond Position:  [8.14708442]


portfolio before change:  [7.71963854]
curr_Stock_Price:  97.73778677401016
curr_Factors:  [97.73778677 -1.01507809 -1.02900305]
mat_Sqrt:  [[12.65695802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.72216015e-05  2.15547641e-02 -4.67877987e-01]
Stock Position:  4.722160149166419e-05
Bond Position:  [7.7150232]


portfolio before change:  [7.72059007]
curr_Stock_Price:  97.4645610453164
curr_Factors:  [97.46456105 -0.79547478 -1.02875704]
mat_Sqrt:  [[15.72508198  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308006 -0.00172318 -0.09646005]
Stock Position:  -0.0030800638354093386
Bond Position:  [8.02078714]


portfolio before change:  [7.72283329]
curr_Stock_Price:  97.06179077443566
curr_Factors:  [97.06179077 -0.75531412 -1.01889676]
mat_Sqrt:  [[16.46335356  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131895  0.14237586 -1.10341204]
Stock Position:  -0.0013189546743559318
Bond Position:  [7.85085339]


portfolio before change:  [7.72340807]
curr_Stock_Price:  97.37009296460496
curr_Factors:  [97.37009296 -0.88655261 -0.99317161]
mat_Sqrt:  [[14.86181081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01496927 0.03904186 0.26607763]
Stock Position:  0.014969270053449595
Bond Position:  [6.26584886]


portfolio before change:  [7.71378616]
curr_Stock_Price:  96.6749891584264
curr_Factors:  [96.67498916 -0.72186231 -0.97671266]
mat_Sqrt:  [[17.68611298  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00063487 -0.01494491  0.22143065]
Stock Position:  0.0006348693401458999
Bond Position:  [7.65241017]


portfolio before change:  [7.71417298]
curr_Stock_Price:  95.77750194879297
curr_Factors:  [95.77750195 -0.6791266  -0.98782178]
mat_Sqrt:  [[18.08493793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00458983  0.04152424 -0.36338756]
Stock Position:  0.004589831201166685
Bond Position:  [7.27457041]


portfolio before change:  [7.71506933]
curr_Stock_Price:  95.77466289617492
curr_Factors:  [95.7746629  -0.71460761 -0.99674904]
mat_Sqrt:  [[17.29887597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00579774  0.0040567   0.00239133]
Stock Position:  -0.005797741567509542
Bond Position:  [8.27034607]


portfolio before change:  [7.71478371]
curr_Stock_Price:  96.00224655911468
curr_Factors:  [96.00224656 -0.6441404  -0.99331794]
mat_Sqrt:  [[18.66991219  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00472656 -0.00272142  0.62084483]
Stock Position:  -0.004726560578584275
Bond Position:  [8.16854415]


portfolio before change:  [7.71324645]
curr_Stock_Price:  96.54352748661096
curr_Factors:  [96.54352749 -0.81519318 -1.0141531 ]
mat_Sqrt:  [[15.49701909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337221 -0.01084665 -0.02454774]
Stock Position:  -0.003372213008150651
Bond Position:  [8.03881179]


portfolio before change:  [7.71186146]
curr_Stock_Price:  97.25223223905736
curr_Factors:  [97.25223224 -0.8683305  -1.00733656]
mat_Sqrt:  [[14.90416751  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00732938  0.03492239 -0.40808205]
Stock Position:  -0.0073293762185901055
Bond Position:  [8.42465966]


portfolio before change:  [7.70969484]
curr_Stock_Price:  97.69152823851083
curr_Factors:  [97.69152824 -0.82915788 -1.01112228]
mat_Sqrt:  [[15.51077084  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00042561 -0.0128071   0.19581565]
Stock Position:  0.0004256109517071217
Bond Position:  [7.66811626]


portfolio before change:  [7.71100365]
curr_Stock_Price:  98.51442942130866
curr_Factors:  [98.51442942 -0.96266742 -1.04493813]
mat_Sqrt:  [[13.23146189  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258034  0.00548064 -0.0306913 ]
Stock Position:  -0.0025803401109539053
Bond Position:  [7.96520439]


portfolio before change:  [7.71397682]
curr_Stock_Price:  97.74807627810829
curr_Factors:  [97.74807628 -0.63746322 -1.06392809]
mat_Sqrt:  [[17.83213581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003452  -0.01276766 -0.16328413]
Stock Position:  -0.00034520273590668283
Bond Position:  [7.74771972]


portfolio before change:  [7.71478769]
curr_Stock_Price:  98.20477032310804
curr_Factors:  [98.20477032 -0.7970161  -1.05652077]
mat_Sqrt:  [[15.38692185  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00073827  0.02996698 -0.24642301]
Stock Position:  0.0007382729760148742
Bond Position:  [7.64228576]


portfolio before change:  [7.71507653]
curr_Stock_Price:  97.30198375614378
curr_Factors:  [97.30198376 -0.94002879 -1.02980272]
mat_Sqrt:  [[13.57171528  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00087194  0.0113837  -0.04655833]
Stock Position:  -0.0008719384035911425
Bond Position:  [7.79991787]


portfolio before change:  [7.71680499]
curr_Stock_Price:  96.43793109213345
curr_Factors:  [96.43793109 -0.69027858 -1.03099105]
mat_Sqrt:  [[17.24685786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00422571 -0.00996743  0.50927709]
Stock Position:  0.004225714539049377
Bond Position:  [7.30928582]


portfolio before change:  [7.71996252]
curr_Stock_Price:  96.96892279209781
curr_Factors:  [96.96892279 -0.53481252 -1.0337386 ]
mat_Sqrt:  [[20.20316797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305187  0.01249529 -0.06806624]
Stock Position:  -0.0030518664920860298
Bond Position:  [8.01589873]


portfolio before change:  [7.71599306]
curr_Stock_Price:  98.59793006544248
curr_Factors:  [98.59793007 -0.34351468 -1.01851645]
mat_Sqrt:  [[25.25487326  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00212033 -0.01202326  0.23930037]
Stock Position:  0.0021203288125118667
Bond Position:  [7.50693303]


portfolio before change:  [7.71498501]
curr_Stock_Price:  97.6799259280892
curr_Factors:  [97.67992593 -0.30820967 -1.00877154]
mat_Sqrt:  [[26.17264696  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00036032 0.03256644 0.21727414]
Stock Position:  0.0003603188284547315
Bond Position:  [7.6797891]


portfolio before change:  [7.71567222]
curr_Stock_Price:  96.92275278724584
curr_Factors:  [96.92275279 -0.31563058 -0.98744405]
mat_Sqrt:  [[26.33344142  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0028741  -0.03370292 -0.35043529]
Stock Position:  0.002874101247218538
Bond Position:  [7.43710642]


portfolio before change:  [7.71192638]
curr_Stock_Price:  95.29596774019825
curr_Factors:  [95.29596774 -0.28678673 -0.9889097 ]
mat_Sqrt:  [[26.61010608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00420283 0.00100757 0.17251466]
Stock Position:  0.004202834785524639
Bond Position:  [7.31141317]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.71147256]
Stock Price:  94.9705207650099
PL:  [7.71147256]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-7.79005633e-02 -8.73215640e-02  1.43346366e-02]
 [-2.22114938e-01  7.44568364e-02 -3.96412708e-01]
 [-2.10239581e-02  3.42721987e-02  3.16424779e-02]
 [-9.81134709e-02 -1.05391174e-01 -4.05009279e-02]
 [ 1.20608195e-01 -1.02154581e-01 -9.38883789e-02]
 [-1.29552925e-01 -1.69317409e-01  6.66836985e-02]
 [-5.22074027e-02 -1.75015027e-01 -2.75623267e-02]
 [ 2.98376909e-03  7.42649242e-01  1.18163988e-01]
 [ 3.97677198e-01  4.24222231e-02  3.96777002e-01]
 [ 6.39262390e-01  2.84098461e-01  5.52765565e-01]
 [-4.99985972e-02 -2.29806940e-01 -4.39999932e-02]
 [-8.67330686e-02 -2.15608883e-02  7.97602251e-02]
 [ 1.32454286e-02 -4.62537227e-02  1.24998917e-02]
 [ 1.71583927e-03  9.43408104e-02 -2.97440229e-02]
 [ 3.84547823e-01 -1.79977672e-01 -1.79492021e-01]
 [-2.20672157e-01 -9.66340782e-02  1.20523227e-01]
 [ 4.90232046e-02  2.12995338e-02 -1.36443944e-02]
 [-4.17747014e-02 -5.17894113e-02  5.00100641e-02]
 [ 1.11278407e-01 -1.06242742e-01 -4.08384933e-02]
 [ 4.39540863e-02 -1.12125122e-02  2.00879679e-01]
 [-2.62347871e-02  4.31459685e-01 -4.11386888e-01]
 [ 1.91232239e-01  1.26944621e-01  9.12371061e-02]
 [-4.50290311e-02  1.86427968e-01 -7.76324080e-02]
 [ 5.82363451e-02 -1.63410948e-01 -2.25931791e-01]
 [ 3.89187510e-02 -1.46160057e-02 -1.19019277e-02]
 [-8.02510801e-04  1.93585431e-02  8.25648762e-03]
 [ 9.01352014e-02 -2.00092276e-02  9.99768490e-02]
 [ 1.69200954e-01 -5.16844617e-02  2.26524836e-01]
 [-3.79919108e-02  1.48998578e-02 -8.99573068e-02]
 [-5.65528656e-02 -9.50235422e-03  4.11317521e-02]
 [-2.40551907e-02 -5.50975851e-02 -3.81366890e-02]
 [ 2.65958738e-02 -7.81580955e-02 -1.55633590e-01]
 [ 4.27134003e-02  2.09541887e-05  1.48516286e-01]
 [-4.66913965e-03 -1.00303848e-01 -2.21099992e-01]
 [ 7.01004932e-02  3.14381835e-01 -1.17353484e-01]
 [-4.24573366e-02 -2.85443434e-03 -1.14044793e-02]
 [ 4.76092120e-01 -2.76987572e-01  3.41369458e-01]
 [-1.36144911e-01  6.96878779e-02  5.92392660e-02]
 [ 4.66388759e-01 -6.79466291e-02  1.18229278e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.00603765]
curr_Stock_Price:  100.20327445413074
curr_Factors:  [100.20327445  -1.12687925  -1.00242677]
mat_Sqrt:  [[11.91615263  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00778766 -0.02818291  0.04089273]
Stock Position:  -0.007787661033038994
Bond Position:  [4.78638679]


portfolio before change:  [4.00773089]
curr_Stock_Price:  100.06268046723449
curr_Factors:  [100.06268047  -1.283055    -1.00995517]
mat_Sqrt:  [[10.10253738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02849125  0.02403084 -1.13085512]
Stock Position:  -0.02849124867386035
Bond Position:  [6.8586416]


portfolio before change:  [3.99306598]
curr_Stock_Price:  100.60748971338627
curr_Factors:  [100.60748971  -1.52232928  -0.99819611]
mat_Sqrt:  [[ 8.09058726  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093555  0.0110613   0.09026718]
Stock Position:  -0.000935553979826644
Bond Position:  [4.08718971]


portfolio before change:  [3.99353947]
curr_Stock_Price:  100.64750383424413
curr_Factors:  [100.64750383  -1.50859595  -0.97735771]
mat_Sqrt:  [[ 8.378515    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01526447 -0.03401486 -0.11553787]
Stock Position:  -0.01526446768777994
Bond Position:  [5.52987004]


portfolio before change:  [3.99612237]
curr_Stock_Price:  100.52358035078113
curr_Factors:  [100.52358035  -1.46882882  -0.97754038]
mat_Sqrt:  [[ 8.70609305  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00925686 -0.03297025 -0.26783741]
Stock Position:  0.009256861010025987
Bond Position:  [3.06558956]


portfolio before change:  [3.99988033]
curr_Stock_Price:  100.88814601752424
curr_Factors:  [100.88814602  -1.40160724  -0.99501192]
mat_Sqrt:  [[ 9.18336118  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01638866 -0.05464696  0.19023003]
Stock Position:  -0.016388655591112248
Bond Position:  [5.65330141]


portfolio before change:  [3.98867309]
curr_Stock_Price:  101.61510934360071
curr_Factors:  [101.61510934  -1.29243844  -0.99595179]
mat_Sqrt:  [[10.30678075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00907736 -0.05648586 -0.07862765]
Stock Position:  -0.00907735733022646
Bond Position:  [4.91106974]


portfolio before change:  [3.97297643]
curr_Stock_Price:  103.41195195883695
curr_Factors:  [103.41195196  -1.30037118  -0.97750616]
mat_Sqrt:  [[10.59988558  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01685835 0.23968901 0.33708897]
Stock Position:  0.01685834555532823
Bond Position:  [2.22962201]


portfolio before change:  [3.97680069]
curr_Stock_Price:  103.62226575337942
curr_Factors:  [103.62226575  -1.27788413  -0.98119145]
mat_Sqrt:  [[10.82303401  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04502696 0.01369171 1.13189435]
Stock Position:  0.0450269642120294
Bond Position:  [-0.68899536]


portfolio before change:  [3.94119011]
curr_Stock_Price:  102.8333062535452
curr_Factors:  [102.83330625  -0.99935826  -0.97573074]
mat_Sqrt:  [[14.26801459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0567764  0.09169238 1.5768863 ]
Stock Position:  0.05677640280507059
Bond Position:  [-1.89731511]


portfolio before change:  [4.03687804]
curr_Stock_Price:  104.52283052133126
curr_Factors:  [104.52283052  -1.41537463  -1.00130377]
mat_Sqrt:  [[ 9.32526254  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01135509 -0.07416987 -0.12551973]
Stock Position:  -0.011355090849902293
Bond Position:  [5.22374428]


portfolio before change:  [4.04082759]
curr_Stock_Price:  104.23251612454935
curr_Factors:  [104.23251612  -1.46790455  -0.9763327 ]
mat_Sqrt:  [[ 9.04658088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0082742  -0.00695875  0.22753372]
Stock Position:  -0.008274195491670074
Bond Position:  [4.90326781]


portfolio before change:  [4.04228356]
curr_Stock_Price:  104.13063026117214
curr_Factors:  [104.13063026  -1.32819875  -0.95599094]
mat_Sqrt:  [[10.60638822  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00059921 -0.01492832  0.03565871]
Stock Position:  0.0005992102670277869
Bond Position:  [3.97988742]


portfolio before change:  [4.04272254]
curr_Stock_Price:  104.03293680956831
curr_Factors:  [104.03293681  -1.33208773  -0.97494575]
mat_Sqrt:  [[10.35711861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00143878  0.03044837 -0.08485142]
Stock Position:  0.0014387788605801364
Bond Position:  [3.89304215]


portfolio before change:  [4.04261915]
curr_Stock_Price:  103.62283020425372
curr_Factors:  [103.6228302   -1.46366068  -0.97213166]
mat_Sqrt:  [[ 9.06993709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.034308   -0.05808754 -0.51204078]
Stock Position:  0.034307997505764735
Bond Position:  [0.48752735]


portfolio before change:  [4.03092484]
curr_Stock_Price:  103.28019119379617
curr_Factors:  [103.28019119  -1.4720299   -0.99184597]
mat_Sqrt:  [[ 8.78960459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02455125 -0.03118851  0.34381922]
Stock Position:  -0.024551252932797012
Bond Position:  [6.56658293]


portfolio before change:  [4.03247459]
curr_Stock_Price:  103.25050321041682
curr_Factors:  [103.25050321  -1.50076674  -0.99569839]
mat_Sqrt:  [[ 8.50532955  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00594754  0.00687439 -0.03892366]
Stock Position:  0.005947541849102125
Bond Position:  [3.4183879]


portfolio before change:  [4.03172264]
curr_Stock_Price:  103.05222341831903
curr_Factors:  [103.05222342  -1.40780903  -1.01101136]
mat_Sqrt:  [[ 9.17438624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00459299 -0.01671496  0.14266479]
Stock Position:  -0.004592994889718189
Bond Position:  [4.50504097]


portfolio before change:  [4.03447932]
curr_Stock_Price:  102.57464467894805
curr_Factors:  [102.57464468  -1.08182481  -1.01421316]
mat_Sqrt:  [[12.61079005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00644334 -0.0342897  -0.11650085]
Stock Position:  0.006443337433341037
Bond Position:  [3.37355627]


portfolio before change:  [4.03729593]
curr_Stock_Price:  102.94632940025302
curr_Factors:  [102.9463294   -1.1447365   -1.00624448]
mat_Sqrt:  [[11.97985871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00690073 -0.00361882  0.57305381]
Stock Position:  0.0069007270116074135
Bond Position:  [3.32689141]


portfolio before change:  [4.04430695]
curr_Stock_Price:  103.90204502487578
curr_Factors:  [103.90204502  -1.17198591  -1.02366042]
mat_Sqrt:  [[11.56290639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191452  0.13925301 -1.17357228]
Stock Position:  -0.001914522503805462
Bond Position:  [4.24322975]


portfolio before change:  [4.04213553]
curr_Stock_Price:  105.31328983456126
curr_Factors:  [105.31328983  -1.25206676  -1.03611905]
mat_Sqrt:  [[10.68406961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02206728 0.0409712  0.26027407]
Stock Position:  0.022067283946248913
Bond Position:  [1.71815726]


portfolio before change:  [4.04592686]
curr_Stock_Price:  105.4753646131598
curr_Factors:  [105.47536461  -1.18820271  -1.03396013]
mat_Sqrt:  [[11.43083548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199646  0.06016937 -0.22146365]
Stock Position:  -0.0019964621431383806
Bond Position:  [4.25650443]


portfolio before change:  [4.04765298]
curr_Stock_Price:  104.87729194337821
curr_Factors:  [104.87729194  -1.33962945  -1.04892205]
mat_Sqrt:  [[ 9.62380314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00220681 -0.05274066 -0.64452051]
Stock Position:  -0.002206810375642472
Bond Position:  [4.27909728]


portfolio before change:  [4.04757204]
curr_Stock_Price:  105.1563659512522
curr_Factors:  [105.15636595  -1.48592609  -1.04576627]
mat_Sqrt:  [[ 8.36248882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00400668 -0.0047173  -0.03395289]
Stock Position:  0.004006678069113574
Bond Position:  [3.62624434]


portfolio before change:  [4.04700579]
curr_Stock_Price:  104.90190078809765
curr_Factors:  [104.90190079  -1.25857255  -1.04172037]
mat_Sqrt:  [[10.51426289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00045979 0.00624794 0.02355346]
Stock Position:  0.0004597929297540189
Bond Position:  [3.99877264]


portfolio before change:  [4.04759818]
curr_Stock_Price:  105.10310583270899
curr_Factors:  [105.10310583  -1.33272565  -1.05969499]
mat_Sqrt:  [[ 9.60728047  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01108103 -0.00645795  0.28520612]
Stock Position:  0.011081025899438386
Bond Position:  [2.88294794]


portfolio before change:  [4.05552088]
curr_Stock_Price:  105.78556166814663
curr_Factors:  [105.78556167  -1.6765073   -1.06629205]
mat_Sqrt:  [[ 6.81151589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03007996 -0.01668109  0.64621231]
Stock Position:  0.030079955661645306
Bond Position:  [0.87349588]


portfolio before change:  [4.06570929]
curr_Stock_Price:  106.12064247021026
curr_Factors:  [106.12064247  -1.4005698   -1.0902534 ]
mat_Sqrt:  [[ 8.79121903  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00606434  0.00480891 -0.25662316]
Stock Position:  -0.006064340822089818
Bond Position:  [4.70926104]


portfolio before change:  [4.06577743]
curr_Stock_Price:  106.20648144708873
curr_Factors:  [106.20648145  -1.05917377  -1.06960186]
mat_Sqrt:  [[12.63675337  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00396435 -0.00306687  0.11733744]
Stock Position:  -0.003964352256796922
Bond Position:  [4.48681733]


portfolio before change:  [4.06579425]
curr_Stock_Price:  106.3437209134533
curr_Factors:  [106.34372091  -1.13948838  -1.06461471]
mat_Sqrt:  [[11.73497153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367164 -0.01778267 -0.10879336]
Stock Position:  -0.003671637131153885
Bond Position:  [4.45624981]


portfolio before change:  [4.06609673]
curr_Stock_Price:  106.41305988846773
curr_Factors:  [106.41305989  -1.05287224  -1.08609805]
mat_Sqrt:  [[12.53291056  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168569 -0.02522542 -0.44397931]
Stock Position:  -0.0016856941688170102
Bond Position:  [4.24547661]


portfolio before change:  [4.06682568]
curr_Stock_Price:  106.29546127225422
curr_Factors:  [106.29546127  -0.82080829  -1.05655964]
mat_Sqrt:  [[16.26238301  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [4.49094314e-03 6.76293531e-06 4.23675624e-01]
Stock Position:  0.0044909431419930795
Bond Position:  [3.58945881]


portfolio before change:  [4.06698642]
curr_Stock_Price:  106.23133718126336
curr_Factors:  [106.23133718  -0.67165348  -1.02756663]
mat_Sqrt:  [[19.42185597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361837 -0.03237293 -0.63073673]
Stock Position:  -0.0036183680879293555
Bond Position:  [4.4513705]


portfolio before change:  [4.06211312]
curr_Stock_Price:  107.73194653679352
curr_Factors:  [107.73194654  -0.65015647  -1.06309392]
mat_Sqrt:  [[19.42179292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00568015  0.1014663  -0.33477682]
Stock Position:  0.0056801520543557455
Bond Position:  [3.45017928]


portfolio before change:  [4.07129965]
curr_Stock_Price:  109.27331972116937
curr_Factors:  [109.27331972  -0.61283746  -1.04801412]
mat_Sqrt:  [[20.75943168  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218541 -0.00092126 -0.03253381]
Stock Position:  -0.002185412679005068
Bond Position:  [4.31010695]


portfolio before change:  [4.07460537]
curr_Stock_Price:  108.0072337435812
curr_Factors:  [108.00723374  -0.45790416  -1.06649078]
mat_Sqrt:  [[23.51887436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02080176 -0.08939735  0.97383204]
Stock Position:  0.020801761584920045
Bond Position:  [1.82786464]


portfolio before change:  [4.07594893]
curr_Stock_Price:  108.06083811689732
curr_Factors:  [108.06083812  -0.47480676  -1.06482236]
mat_Sqrt:  [[23.17479488  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0047391   0.02249167  0.16899314]
Stock Position:  -0.004739104212703398
Bond Position:  [4.5880605]


portfolio before change:  [4.06902025]
curr_Stock_Price:  109.6438851651451
curr_Factors:  [109.64388517  -0.48580635  -1.07083027]
mat_Sqrt:  [[23.11775861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01967892 -0.02192968  0.03372752]
Stock Position:  0.019678921481571018
Bond Position:  [1.91134684]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.08113932]
Stock Price:  110.24758398807978
PL:  [-6.16644467]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-8.61262606e-02 -8.83651550e-02  1.46557815e-02]
 [-1.33733737e-01  1.03810081e-01 -2.48635661e-01]
 [ 1.14183536e-03  9.83327640e-03  4.72953256e-02]
 [-1.63008211e-01 -1.38494239e-01 -1.12131411e-01]
 [ 1.75995951e-01 -1.83746374e-01 -1.04505925e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.26593335e-02 -1.55539818e-01 -2.70898998e-02]
 [ 1.13549122e-02  6.17235669e-01  8.99104841e-02]
 [ 2.28641334e-01 -2.19084208e-02  2.43946958e-01]
 [ 4.73632486e-01  1.96727559e-01  3.53861596e-01]
 [-1.42829218e-01 -1.57660928e-01  5.31551861e-02]
 [-3.27461284e-02 -2.02979067e-02  9.47709198e-02]
 [ 1.43246860e-02 -4.00998840e-02  3.58584726e-02]
 [-1.41009950e-05  1.42790369e-01 -4.18917981e-02]
 [ 3.01889381e-01 -1.65272923e-01 -1.61079456e-01]
 [-2.25116949e-01 -9.68683489e-02  1.21421307e-01]
 [ 5.01446152e-02  1.92868799e-02 -2.02032616e-02]
 [-4.22390181e-02 -5.20640642e-02  4.93489578e-02]
 [ 1.28706460e-01 -1.49907788e-01 -1.38380907e-02]
 [ 4.93999292e-02 -1.29480698e-02  1.74222012e-01]
 [-1.45036378e-02  3.22055460e-01 -3.05060589e-01]
 [-2.30420421e-02  2.44150998e-02  1.26130163e-01]
 [-2.43017378e-02  4.51598706e-02  2.15811345e-02]
 [ 1.01165886e-01 -1.82624742e-01 -2.94352277e-01]
 [ 7.05663631e-02  4.20050598e-02 -1.57234321e-02]
 [-1.76216627e-02  1.40140952e-02  5.51257588e-02]
 [ 5.50937472e-02 -3.33966973e-02  2.17867572e-02]
 [ 1.18373657e-01 -6.87521373e-02 -5.28100483e-03]
 [-4.78631549e-02 -2.61810186e-02 -1.06504055e-02]
 [-5.50374993e-02 -6.38286151e-03  2.25942707e-02]
 [-2.13368075e-02 -4.24625894e-02 -1.59336016e-02]
 [ 2.71214029e-02  1.77253969e-02 -2.59514520e-02]
 [ 4.91603622e-02  1.31213056e-02  1.44131529e-01]
 [ 1.50215297e-02 -6.49487680e-02  1.48854246e-02]
 [-4.11133008e-02 -2.10829389e-02  4.74280046e-02]
 [ 9.71347826e-02  2.14521586e-02  1.95674807e-01]
 [ 1.39634240e-01 -7.31577511e-02  5.21153756e-02]
 [-6.73917701e-02 -4.68063722e-04  3.33957793e-02]
 [ 9.31211744e-02  6.67501470e-03  9.44256512e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.19173974]
curr_Stock_Price:  100.22668636951823
curr_Factors:  [100.22668637  -1.11316923  -1.00783836]
mat_Sqrt:  [[12.01825687  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0084182  -0.02851973  0.04180887]
Stock Position:  -0.008418202786108844
Bond Position:  [5.03546831]


portfolio before change:  [4.18758728]
curr_Stock_Price:  100.79473310133105
curr_Factors:  [100.7947331   -1.22936816  -0.9888293 ]
mat_Sqrt:  [[10.96697678  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0148898   0.03350456 -0.70928833]
Stock Position:  -0.014889804047578241
Bond Position:  [5.6884011]


portfolio before change:  [4.185477]
curr_Stock_Price:  100.98421622209759
curr_Factors:  [100.98421622  -1.41267494  -1.0146549 ]
mat_Sqrt:  [[ 8.91410087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00143628 0.00317368 0.1349204 ]
Stock Position:  0.0014362819779546296
Bond Position:  [4.04043519]


portfolio before change:  [4.18588829]
curr_Stock_Price:  100.91890794024572
curr_Factors:  [100.91890794  -1.52149229  -1.04643693]
mat_Sqrt:  [[ 7.73989474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02767053 -0.04469882 -0.3198797 ]
Stock Position:  -0.027670525858335893
Bond Position:  [6.97836754]


portfolio before change:  [4.17897019]
curr_Stock_Price:  101.20045115517061
curr_Factors:  [101.20045116  -1.52882645  -1.07900864]
mat_Sqrt:  [[ 7.45785717  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01570916 -0.05930389 -0.29812631]
Stock Position:  0.015709163367561705
Bond Position:  [2.58919577]


portfolio before change:  [4.17887302]
curr_Stock_Price:  101.17366188389423
curr_Factors:  [101.17366188  -1.75243744  -1.03843175]
mat_Sqrt:  [[ 6.20881015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0246914  -0.05534923  0.15513819]
Stock Position:  -0.024691396987582496
Bond Position:  [6.67699207]


portfolio before change:  [4.18427586]
curr_Stock_Price:  100.98865172098272
curr_Factors:  [100.98865172  -1.26101011  -1.04708166]
mat_Sqrt:  [[10.04340676  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00895498 -0.05020026 -0.07727994]
Stock Position:  -0.008954976200718527
Bond Position:  [5.08862683]


portfolio before change:  [4.17949316]
curr_Stock_Price:  101.59376998790339
curr_Factors:  [101.59376999  -1.23359515  -1.04962446]
mat_Sqrt:  [[10.3580356   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01503186 0.19921196 0.25648958]
Stock Position:  0.015031857618611375
Bond Position:  [2.65235007]


portfolio before change:  [4.16702691]
curr_Stock_Price:  100.74239097151185
curr_Factors:  [100.74239097  -1.1386543   -1.03143787]
mat_Sqrt:  [[11.50146591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02381999 -0.00707091  0.69591277]
Stock Position:  0.023819986272170534
Bond Position:  [1.76734454]


portfolio before change:  [4.18401976]
curr_Stock_Price:  101.44650217540753
curr_Factors:  [101.44650218  -1.2091238   -1.02334069]
mat_Sqrt:  [[10.88153259  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05385464 0.06349355 1.00946864]
Stock Position:  0.0538546406146326
Bond Position:  [-1.27934515]


portfolio before change:  [4.19722424]
curr_Stock_Price:  101.69465911407039
curr_Factors:  [101.69465911  -1.20439373  -1.0542746 ]
mat_Sqrt:  [[10.62602793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01544899 -0.05088485  0.15163695]
Stock Position:  -0.015448986643256103
Bond Position:  [5.76830367]


portfolio before change:  [4.18324238]
curr_Stock_Price:  102.6463679193822
curr_Factors:  [102.64636792  -1.42634233  -1.07670782]
mat_Sqrt:  [[ 8.40006639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0020886  -0.00655112  0.27035505]
Stock Position:  -0.0020886011464587083
Bond Position:  [4.39762971]


portfolio before change:  [4.18363493]
curr_Stock_Price:  102.72163006049017
curr_Factors:  [102.72163006  -1.30069781  -1.06673032]
mat_Sqrt:  [[ 9.62722075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00139801 -0.01294218  0.10229424]
Stock Position:  0.001398005915483112
Bond Position:  [4.04002948]


portfolio before change:  [4.18371264]
curr_Stock_Price:  102.41596020962263
curr_Factors:  [102.41596021  -1.36716024  -1.08615484]
mat_Sqrt:  [[ 8.8085909   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00233655  0.04608539 -0.11950564]
Stock Position:  0.0023365523259485828
Bond Position:  [3.94441239]


portfolio before change:  [4.18492396]
curr_Stock_Price:  102.72335188263064
curr_Factors:  [102.72335188  -1.27088565  -1.07223318]
mat_Sqrt:  [[ 9.86428482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02385099 -0.05334161 -0.45951485]
Stock Position:  0.023850992209455187
Bond Position:  [1.73487009]


portfolio before change:  [4.18701114]
curr_Stock_Price:  102.80176851380499
curr_Factors:  [102.80176851  -1.22639653  -1.08361551]
mat_Sqrt:  [[10.20410932  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02157024 -0.03126413  0.34638119]
Stock Position:  -0.021570240991738446
Bond Position:  [6.40447006]


portfolio before change:  [4.17715821]
curr_Stock_Price:  103.29566852514513
curr_Factors:  [103.29566853  -1.32450868  -1.06266513]
mat_Sqrt:  [[ 9.49173704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00526327  0.00622481 -0.05763428]
Stock Position:  0.005263268389091794
Bond Position:  [3.63348538]


portfolio before change:  [4.17578142]
curr_Stock_Price:  102.94778537149077
curr_Factors:  [102.94778537  -1.27626706  -1.03978557]
mat_Sqrt:  [[10.15706263  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00421315 -0.0168036   0.14077884]
Stock Position:  -0.0042131508302612015
Bond Position:  [4.60951597]


portfolio before change:  [4.17546926]
curr_Stock_Price:  103.15864575358823
curr_Factors:  [103.15864575  -1.39595478  -1.04532049]
mat_Sqrt:  [[ 8.97993629  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01061054 -0.04838253 -0.03947622]
Stock Position:  0.010610539923308791
Bond Position:  [3.08090033]


portfolio before change:  [4.16772612]
curr_Stock_Price:  102.39258860051687
curr_Factors:  [102.3925886   -1.61764007  -1.04221285]
mat_Sqrt:  [[ 7.16323299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01149199 -0.00417897  0.49700691]
Stock Position:  0.011491994609059265
Bond Position:  [2.99103104]


portfolio before change:  [4.16811371]
curr_Stock_Price:  102.393779854123
curr_Factors:  [102.39377985  -1.71293809  -1.04863269]
mat_Sqrt:  [[ 6.47051165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170536  0.10394295 -0.87025295]
Stock Position:  -0.0017053634987132047
Bond Position:  [4.34273232]


portfolio before change:  [4.16901809]
curr_Stock_Price:  102.18179833755104
curr_Factors:  [102.18179834  -1.94683034  -1.04599596]
mat_Sqrt:  [[ 5.12395839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00150038 0.00787994 0.35981425]
Stock Position:  0.0015003792582466305
Bond Position:  [4.01570664]


portfolio before change:  [4.16891132]
curr_Stock_Price:  101.77605435801546
curr_Factors:  [101.77605436  -1.71815122  -1.03203742]
mat_Sqrt:  [[ 6.50509825  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164153  0.01457529  0.06156497]
Stock Position:  -0.0016415258797263998
Bond Position:  [4.33597934]


portfolio before change:  [4.16827807]
curr_Stock_Price:  102.492020161508
curr_Factors:  [102.49202016  -1.59954037  -1.03635113]
mat_Sqrt:  [[ 7.34407189  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.17881575e-04 -5.89418821e-02 -8.39705113e-01]
Stock Position:  0.0005178815748674058
Bond Position:  [4.11519934]


portfolio before change:  [4.16845772]
curr_Stock_Price:  101.8455785612674
curr_Factors:  [101.84557856  -1.56638034  -1.03761712]
mat_Sqrt:  [[ 7.53425734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01007811  0.01355707 -0.04485458]
Stock Position:  0.01007811047914414
Bond Position:  [3.14204673]


portfolio before change:  [4.16831174]
curr_Stock_Price:  101.7921197925856
curr_Factors:  [101.79211979  -1.56939444  -1.05485346]
mat_Sqrt:  [[ 7.37934433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047546  0.00452303  0.15725845]
Stock Position:  -0.00047545539350519203
Bond Position:  [4.21670935]


portfolio before change:  [4.16890748]
curr_Stock_Price:  101.64778757462435
curr_Factors:  [101.64778757  -1.58047458  -1.06505859]
mat_Sqrt:  [[ 7.21368997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00730886 -0.01077874  0.06215155]
Stock Position:  0.007308863889230898
Bond Position:  [3.42597764]


portfolio before change:  [4.169986]
curr_Stock_Price:  101.73675417880025
curr_Factors:  [101.73675418  -1.42889764  -1.0759253 ]
mat_Sqrt:  [[ 8.31088159  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01242488 -0.02218966 -0.01506524]
Stock Position:  0.012424879883744636
Bond Position:  [2.90591905]


portfolio before change:  [4.17115676]
curr_Stock_Price:  101.80174398139128
curr_Factors:  [101.80174398  -1.37514348  -1.11209801]
mat_Sqrt:  [[ 8.46369425  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0065434  -0.00844989 -0.03038264]
Stock Position:  -0.006543400110213599
Bond Position:  [4.8372863]


portfolio before change:  [4.17552701]
curr_Stock_Price:  101.22627000040139
curr_Factors:  [101.22627     -1.21669023  -1.11127785]
mat_Sqrt:  [[ 9.86891805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524154 -0.00206006  0.06445517]
Stock Position:  -0.0052415430935066325
Bond Position:  [4.70610887]


portfolio before change:  [4.17828321]
curr_Stock_Price:  100.8126707920677
curr_Factors:  [100.81267079  -1.0987991   -1.09639054]
mat_Sqrt:  [[11.22422527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296296 -0.01370474 -0.04545413]
Stock Position:  -0.002962955508442766
Bond Position:  [4.47698667]


portfolio before change:  [4.17882032]
curr_Stock_Price:  100.82028231828254
curr_Factors:  [100.82028232  -1.17058325  -1.12369727]
mat_Sqrt:  [[10.16610371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00250266  0.00572085 -0.07403227]
Stock Position:  0.002502656585672892
Bond Position:  [3.92650177]


portfolio before change:  [4.17775574]
curr_Stock_Price:  100.19877372018911
curr_Factors:  [100.19877372  -1.17230581  -1.13798944]
mat_Sqrt:  [[ 9.94291954  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0081726  0.00423488 0.41116713]
Stock Position:  0.00817259580353102
Bond Position:  [3.35887166]


portfolio before change:  [4.18533424]
curr_Stock_Price:  101.0747031013686
curr_Factors:  [101.0747031   -1.43593339  -1.11841595]
mat_Sqrt:  [[ 7.85783037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00061116 -0.02096212  0.04246397]
Stock Position:  0.0006111601241542746
Bond Position:  [4.12356141]


portfolio before change:  [4.18568387]
curr_Stock_Price:  100.80333699629107
curr_Factors:  [100.803337    -1.47482732  -1.14584761]
mat_Sqrt:  [[ 7.33382006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00487272 -0.00680449  0.1352989 ]
Stock Position:  -0.004872717962597385
Bond Position:  [4.6768701]


portfolio before change:  [4.1838501]
curr_Stock_Price:  101.29965405200252
curr_Factors:  [101.29965405  -1.65626166  -1.17067742]
mat_Sqrt:  [[ 5.99630783  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02359046 0.00692365 0.55820576]
Stock Position:  0.023590456469745287
Bond Position:  [1.79414502]


portfolio before change:  [4.19581912]
curr_Stock_Price:  101.79751362282215
curr_Factors:  [101.79751362  -1.48218123  -1.205624  ]
mat_Sqrt:  [[ 6.92529361  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01954271 -0.02361156  0.14867066]
Stock Position:  0.019542706929856133
Bond Position:  [2.20642014]


portfolio before change:  [4.20185007]
curr_Stock_Price:  102.0920038328751
curr_Factors:  [102.09200383  -1.63561241  -1.20433672]
mat_Sqrt:  [[ 5.96509672  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0101709  -0.00015107  0.09526886]
Stock Position:  -0.010170904369719716
Bond Position:  [5.24021808]


portfolio before change:  [4.20514847]
curr_Stock_Price:  101.83211238133538
curr_Factors:  [101.83211238  -1.40689613  -1.19210471]
mat_Sqrt:  [[ 7.57099618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01502553 0.00215435 0.2693701 ]
Stock Position:  0.01502553412569753
Bond Position:  [2.67506659]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.20217747]
Stock Price:  101.61212671678373
PL:  [2.59005076]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.28633368e-01 -9.37580155e-02  1.63153299e-02]
 [-6.72932308e-02  7.36873017e-02 -5.86351233e-02]
 [-2.00783976e-01 -2.05488386e-02 -1.34631455e-01]
 [-6.00737347e-01 -2.39851565e-01 -3.96815735e-01]
 [ 3.13380246e-01 -3.16657524e-01 -1.06424487e-01]
 [-1.30465220e-01 -2.32154542e-01 -3.64046607e-01]
 [-4.96121291e-02 -1.11917233e-01 -1.00762476e-01]
 [ 2.73077559e-03  6.57899561e-01  1.07945829e-01]
 [ 6.52762435e-01  1.48075310e-01  6.00353189e-01]
 [ 9.13840120e-01  4.34581384e-01  9.00710199e-01]
 [-5.75903191e-02 -2.91955893e-01 -9.22011967e-02]
 [-1.09028851e-01 -2.04832918e-02  8.34967079e-02]
 [ 1.62126617e-02 -9.86721131e-02  1.26534821e-01]
 [ 1.73816677e-03  4.96449906e-02 -4.58741797e-02]
 [ 7.04364510e-01 -2.21042794e-01 -3.25483040e-01]
 [-1.37030704e-01 -9.22256044e-02  1.03623275e-01]
 [ 6.38268307e-02 -3.73599216e-02  1.74433733e-03]
 [-4.25498454e-02 -5.84092110e-02  4.86111369e-03]
 [ 2.83276301e-01 -3.70478297e-01  1.80407886e-01]
 [ 7.43359750e-02  5.38387265e-03  5.46055265e-01]
 [-3.39118074e-02  4.83472518e-01 -4.61720500e-01]
 [ 5.02686847e-01  2.75974600e-01  4.05189181e-02]
 [-1.07764183e-01  2.08600719e-01 -1.01630724e-01]
 [ 5.17886374e-02 -1.63946022e-01 -2.14660953e-01]
 [ 3.04967145e-02 -2.15826595e-02 -1.10123478e-02]
 [-2.51078512e-02  1.32363827e-02  4.89938726e-02]
 [ 7.77764966e-02 -3.03345549e-02  3.01099607e-02]
 [ 1.56870506e-01 -6.20074656e-02  1.51067339e-01]
 [-4.74865055e-02 -2.46135273e-02 -1.36764577e-02]
 [-5.67261523e-02 -9.01771241e-03  2.60400957e-02]
 [-3.10510303e-02 -4.59448515e-02 -1.40175410e-02]
 [ 2.61491299e-02 -2.63433898e-02 -7.30933021e-02]
 [-4.33085302e-02  1.24754992e-02  1.14794301e-01]
 [ 2.59116383e-03 -8.64185660e-02 -1.24973746e-01]
 [ 2.74866487e-02  1.46348206e-01 -1.89689159e-02]
 [ 6.76209370e-03  3.19543540e-02  9.75851991e-02]
 [ 1.39020527e-01 -1.03935317e-01  7.25949392e-02]
 [-1.02399503e-01  4.94464935e-02  4.79793953e-02]
 [ 3.12586777e-01 -3.63720143e-02  5.70945452e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.26076006]
curr_Stock_Price:  100.23538793034048
curr_Factors:  [100.23538793  -0.86736297  -1.00206236]
mat_Sqrt:  [[15.45752536  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0093444  -0.03026027  0.04654309]
Stock Position:  -0.009344399368416132
Bond Position:  [5.19739955]


portfolio before change:  [4.25429127]
curr_Stock_Price:  100.99718199256877
curr_Factors:  [100.99718199  -0.73012189  -1.01310153]
mat_Sqrt:  [[17.6700159   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00363445  0.02378247 -0.16726969]
Stock Position:  -0.0036344459498158605
Bond Position:  [4.62136006]


portfolio before change:  [4.25190279]
curr_Stock_Price:  101.81331330660907
curr_Factors:  [101.81331331  -0.70832246  -1.00940318]
mat_Sqrt:  [[18.27282947  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01272162 -0.00663211 -0.38406607]
Stock Position:  -0.012721621523048534
Bond Position:  [5.54713322]


portfolio before change:  [4.23978973]
curr_Stock_Price:  102.81998452207901
curr_Factors:  [102.81998452  -0.84106589  -0.99728016]
mat_Sqrt:  [[16.35663602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04467279 -0.07741176 -1.13200484]
Stock Position:  -0.04467278693735543
Bond Position:  [8.83304499]


portfolio before change:  [4.18105393]
curr_Stock_Price:  104.15950254245033
curr_Factors:  [104.15950254  -0.89969361  -1.02230304]
mat_Sqrt:  [[15.24004874  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01489621 -0.10220078 -0.30359944]
Stock Position:  0.01489621166865296
Bond Position:  [2.62947193]


portfolio before change:  [4.18733661]
curr_Stock_Price:  104.55920011642961
curr_Factors:  [104.55920012  -0.8716815   -1.01869879]
mat_Sqrt:  [[15.78994162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01596993 -0.07492756 -1.03852364]
Stock Position:  -0.015969930479369104
Bond Position:  [5.85713977]


portfolio before change:  [4.17530675]
curr_Stock_Price:  105.35832994433488
curr_Factors:  [105.35832994  -0.70161875  -0.98720985]
mat_Sqrt:  [[19.46345501  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00477948 -0.03612113 -0.2874473 ]
Stock Position:  -0.004779479949194571
Bond Position:  [4.67886478]


portfolio before change:  [4.17578823]
curr_Stock_Price:  105.37996673699952
curr_Factors:  [105.37996674  -0.84098031  -0.97766717]
mat_Sqrt:  [[17.0973771   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00930308 0.21233617 0.3079394 ]
Stock Position:  0.009303082595867642
Bond Position:  [3.1954297]


portfolio before change:  [4.17619756]
curr_Stock_Price:  105.38102774353771
curr_Factors:  [105.38102774  -0.79195893  -0.9721951 ]
mat_Sqrt:  [[18.05510716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04461534 0.0477911  1.71264054]
Stock Position:  0.04461534100696513
Bond Position:  [-0.52541293]


portfolio before change:  [4.18767057]
curr_Stock_Price:  105.6396539397612
curr_Factors:  [105.63965394  -0.86185469  -0.9564191 ]
mat_Sqrt:  [[17.14591607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06919463 0.14026054 2.56947549]
Stock Position:  0.06919463313540948
Bond Position:  [-3.12202653]


portfolio before change:  [4.17569456]
curr_Stock_Price:  105.47221695547516
curr_Factors:  [105.47221696  -0.82485152  -0.96257635]
mat_Sqrt:  [[17.65501182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00770354 -0.09422836 -0.26302435]
Stock Position:  -0.00770353812063478
Bond Position:  [4.9882038]


portfolio before change:  [4.17045277]
curr_Stock_Price:  106.23360020801675
curr_Factors:  [106.23360021  -1.07541088  -0.95038065]
mat_Sqrt:  [[14.01108667  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00686359 -0.00661095  0.23819287]
Stock Position:  -0.006863585532206668
Bond Position:  [4.89959618]


portfolio before change:  [4.16733427]
curr_Stock_Price:  106.77719309989257
curr_Factors:  [106.7771931   -1.23197961  -0.91678425]
mat_Sqrt:  [[12.45323594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00175859 -0.03184629  0.36096862]
Stock Position:  0.001758588148356826
Bond Position:  [3.97955716]


portfolio before change:  [4.16660677]
curr_Stock_Price:  106.08062728936682
curr_Factors:  [106.08062729  -1.26176916  -0.91373495]
mat_Sqrt:  [[12.04555043  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0002082   0.01602285 -0.13086627]
Stock Position:  0.00020819972682824684
Bond Position:  [4.14452081]


portfolio before change:  [4.1673556]
curr_Stock_Price:  107.18884296885942
curr_Factors:  [107.18884297  -1.20801527  -0.9288887 ]
mat_Sqrt:  [[12.65039195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04686063 -0.07134125 -0.92851252]
Stock Position:  0.04686063430714699
Bond Position:  [-0.85558157]


portfolio before change:  [4.23264226]
curr_Stock_Price:  108.58433457245488
curr_Factors:  [108.58433457  -1.29799895  -0.91603319]
mat_Sqrt:  [[11.86383869  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01135418 -0.02976569  0.29560836]
Stock Position:  -0.011354180394877815
Bond Position:  [5.46552839]


portfolio before change:  [4.23801681]
curr_Stock_Price:  108.17115520112428
curr_Factors:  [108.1711552   -1.17998006  -0.89191324]
mat_Sqrt:  [[13.6238433   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00415131 -0.01205786  0.00497611]
Stock Position:  0.004151312428085141
Bond Position:  [3.78896455]


portfolio before change:  [4.24150639]
curr_Stock_Price:  108.89765576395402
curr_Factors:  [108.89765576  -1.06113483  -0.88104995]
mat_Sqrt:  [[15.61487087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00342496 -0.01885149  0.0138674 ]
Stock Position:  -0.0034249597980630614
Bond Position:  [4.61447649]


portfolio before change:  [4.24327597]
curr_Stock_Price:  108.54940916760583
curr_Factors:  [108.54940917  -1.13572694  -0.87452363]
mat_Sqrt:  [[14.5407475   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01681333 -0.11957136  0.51465348]
Stock Position:  0.016813326847862402
Bond Position:  [2.41819927]


portfolio before change:  [4.21966311]
curr_Stock_Price:  107.12701628766963
curr_Factors:  [107.12701629  -1.16642318  -0.84391174]
mat_Sqrt:  [[14.34900042  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01302516 0.00173764 1.55774368]
Stock Position:  0.013025159400427234
Bond Position:  [2.82431664]


portfolio before change:  [4.2098782]
curr_Stock_Price:  106.34867860999834
curr_Factors:  [106.34867861  -0.98382207  -0.85149488]
mat_Sqrt:  [[16.96930578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00173676  0.15604008 -1.31716007]
Stock Position:  -0.00173676493632553
Bond Position:  [4.39458085]


portfolio before change:  [4.20888112]
curr_Stock_Price:  107.2390894263193
curr_Factors:  [107.23908943  -1.07618776  -0.82878085]
mat_Sqrt:  [[15.96010565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0355443  0.08907042 0.1155892 ]
Stock Position:  0.035544302064477826
Bond Position:  [0.39714253]


portfolio before change:  [4.2008031]
curr_Stock_Price:  107.01042655949168
curr_Factors:  [107.01042656  -1.23510137  -0.83117658]
mat_Sqrt:  [[13.55354753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00633997  0.06732559 -0.28992417]
Stock Position:  -0.0063399655678584785
Bond Position:  [4.87924552]


portfolio before change:  [4.21051096]
curr_Stock_Price:  105.57541588632571
curr_Factors:  [105.57541589  -1.02447573  -0.82700071]
mat_Sqrt:  [[16.57588784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00153803 -0.05291335 -0.61236795]
Stock Position:  -0.0015380284839207896
Bond Position:  [4.37288896]


portfolio before change:  [4.21268323]
curr_Stock_Price:  104.518464141538
curr_Factors:  [104.51846414  -0.82394779  -0.81897366]
mat_Sqrt:  [[20.2153515   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00117946 -0.00696577 -0.03141516]
Stock Position:  0.0011794643565788561
Bond Position:  [4.08940743]


portfolio before change:  [4.21372399]
curr_Stock_Price:  104.9674358502602
curr_Factors:  [104.96743585  -0.98098558  -0.79706298]
mat_Sqrt:  [[17.73609109  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069943  0.00427202  0.13976588]
Stock Position:  -0.0006994299636222711
Bond Position:  [4.28714136]


portfolio before change:  [4.21552706]
curr_Stock_Price:  103.15574609367887
curr_Factors:  [103.15574609  -0.91758747  -0.78972926]
mat_Sqrt:  [[18.70747577  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00415506 -0.00979044  0.08589534]
Stock Position:  0.004155058246422926
Bond Position:  [3.78690893]


portfolio before change:  [4.2175979]
curr_Stock_Price:  103.54020400615842
curr_Factors:  [103.54020401  -1.00272473  -0.76547909]
mat_Sqrt:  [[17.66801892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00990772 -0.02001282  0.43095307]
Stock Position:  0.009907719561397214
Bond Position:  [3.1917506]


portfolio before change:  [4.21009843]
curr_Stock_Price:  102.74300148410371
curr_Factors:  [102.74300148  -0.8234533   -0.75593518]
mat_Sqrt:  [[21.17544492  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261163 -0.00794398 -0.03901513]
Stock Position:  -0.0026116294669622678
Bond Position:  [4.47842508]


portfolio before change:  [4.21389293]
curr_Stock_Price:  101.50444339741826
curr_Factors:  [101.5044434   -1.03722768  -0.76930466]
mat_Sqrt:  [[16.66932537  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00319458 -0.00291045  0.07428514]
Stock Position:  -0.003194578763115117
Bond Position:  [4.53815687]


portfolio before change:  [4.21324251]
curr_Stock_Price:  101.88562781462011
curr_Factors:  [101.88562781  -0.84367823  -0.76626269]
mat_Sqrt:  [[20.36687844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00212555 -0.01482864 -0.03998814]
Stock Position:  -0.002125549212821568
Bond Position:  [4.42980542]


portfolio before change:  [4.21297959]
curr_Stock_Price:  102.26984828028337
curr_Factors:  [102.26984828  -0.8300572   -0.74879075]
mat_Sqrt:  [[21.08932396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00027747 -0.00850229 -0.20851485]
Stock Position:  0.0002774721555588906
Bond Position:  [4.18460255]


portfolio before change:  [4.21365419]
curr_Stock_Price:  102.81582097689349
curr_Factors:  [102.81582098  -0.68933067  -0.7489533 ]
mat_Sqrt:  [[24.40176007  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071018  0.00402645  0.32747619]
Stock Position:  -0.0007101820125860366
Bond Position:  [4.28667214]


portfolio before change:  [4.21314523]
curr_Stock_Price:  104.28703053302748
curr_Factors:  [104.28703053  -0.82691746  -0.76196277]
mat_Sqrt:  [[21.29062376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190502 -0.02789147 -0.35651531]
Stock Position:  -0.0019050222083337586
Bond Position:  [4.41181434]


portfolio before change:  [4.21247018]
curr_Stock_Price:  104.93088946896974
curr_Factors:  [104.93088947  -0.65234183  -0.78459156]
mat_Sqrt:  [[24.93739663  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00214488  0.04723368 -0.05411304]
Stock Position:  0.0021448845741815926
Bond Position:  [3.98740553]


portfolio before change:  [4.21253439]
curr_Stock_Price:  104.728433256269
curr_Factors:  [104.72843326  -0.69674377  -0.761788  ]
mat_Sqrt:  [[24.35747746  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00136321 0.01031322 0.27838341]
Stock Position:  0.0013632053780256552
Bond Position:  [4.06976802]


portfolio before change:  [4.21185607]
curr_Stock_Price:  103.85763853026265
curr_Factors:  [103.85763853  -0.30476412  -0.74370999]
mat_Sqrt:  [[36.39920694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00364357 -0.03354498  0.20709316]
Stock Position:  0.0036435738752194405
Bond Position:  [3.83344309]


portfolio before change:  [4.22229126]
curr_Stock_Price:  106.59011549602829
curr_Factors:  [106.5901155   -0.38592631  -0.76479192]
mat_Sqrt:  [[33.72611813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244655  0.01595879  0.13687186]
Stock Position:  -0.0024465468189861965
Bond Position:  [4.48306897]


portfolio before change:  [4.22495109]
curr_Stock_Price:  105.73200451240031
curr_Factors:  [105.73200451  -0.4995829   -0.75101808]
mat_Sqrt:  [[30.27452651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0104648  -0.01173902  0.16287485]
Stock Position:  0.01046479605839941
Bond Position:  [3.11848722]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.18982114]
Stock Price:  102.33778768460988
PL:  [1.85203345]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 4.71420092e-02 -7.14574605e-02  9.45276615e-03]
 [-1.43936489e-01  6.80624278e-02 -1.58508531e-01]
 [-4.64553470e-02  4.94184329e-02  1.35364239e-02]
 [ 7.37006283e-02  8.61670595e-02  5.88656308e-02]
 [ 2.38755253e-02  6.21810002e-02 -6.76694143e-02]
 [-7.16739682e-02 -1.51265026e-01  1.60289575e-01]
 [-6.06229184e-02 -1.78342741e-01  1.01933110e-01]
 [ 7.13611414e-03  6.95299642e-01  1.03696575e-01]
 [ 3.19799831e-01  9.59953281e-03  3.21920961e-01]
 [ 6.85607001e-01  3.02152659e-01  5.87789068e-01]
 [-2.00850996e-01 -2.13222394e-01  3.17687256e-02]
 [-6.12637276e-02 -1.88307140e-02  8.94179217e-02]
 [ 5.37095338e-03 -5.77265530e-02  1.39508925e-01]
 [ 5.68444084e-03  6.00598016e-02 -1.92998424e-01]
 [ 4.93824502e-01 -1.25522944e-01 -2.36492150e-01]
 [-2.14371816e-01 -9.63020073e-02  1.19250228e-01]
 [ 5.13974343e-02  1.70383800e-02 -2.75307074e-02]
 [-5.59836264e-02 -6.01942812e-02  2.97790269e-02]
 [ 1.49696196e-01 -1.80765179e-01  1.27849899e-02]
 [ 5.20212547e-02 -6.18410976e-04  4.08819914e-01]
 [-5.63458667e-02  6.47470317e-01 -6.32119536e-01]
 [ 4.47625906e-01  2.49628126e-01  4.94852043e-02]
 [-4.48537810e-02  1.61902920e-01 -6.41612964e-02]
 [-9.12601533e-03 -1.47145916e-01 -1.07122299e-01]
 [ 9.06467731e-03 -3.30422583e-02 -8.51636367e-03]
 [ 7.64279598e-03  2.20259342e-02 -1.50048222e-02]
 [ 9.00555498e-02 -9.91075478e-03  1.80528689e-01]
 [ 1.69200954e-01 -5.16844617e-02  2.26524836e-01]
 [-2.48621082e-02  3.35481456e-02 -1.19308216e-01]
 [-6.27185494e-02  4.76854676e-03  2.96437037e-02]
 [ 6.37615032e-02 -1.58878008e-02  4.24136087e-03]
 [ 2.67872185e-02 -1.00350842e-01 -1.90986405e-01]
 [ 4.41110734e-02 -2.15622621e-03  1.48450884e-01]
 [-8.16045641e-03 -1.06980969e-01 -2.67324944e-01]
 [ 6.04686193e-02  2.74702747e-01 -9.64045953e-02]
 [ 2.83246284e-03 -1.20392202e-03  6.40204865e-02]
 [ 4.58870521e-01 -2.70807891e-01  3.08315482e-01]
 [-1.22057797e-01  5.60436348e-02  5.37834952e-02]
 [ 2.52641404e-01 -2.40655926e-02  7.47394670e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.63719712]
curr_Stock_Price:  99.77855649026802
curr_Factors:  [99.77855649 -0.90643289 -1.00198551]
mat_Sqrt:  [[14.79863421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00233031 -0.0230628   0.02696611]
Stock Position:  0.002330306530196983
Bond Position:  [0.40468249]


portfolio before change:  [0.63788028]
curr_Stock_Price:  100.05001265655936
curr_Factors:  [100.05001266  -0.90800826  -0.97402604]
mat_Sqrt:  [[15.23561672  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01065915  0.02196705 -0.45218072]
Stock Position:  -0.010659149873927447
Bond Position:  [1.70432836]


portfolio before change:  [0.64218171]
curr_Stock_Price:  99.6664573841793
curr_Factors:  [99.66645738 -0.86052992 -0.95050779]
mat_Sqrt:  [[16.29391098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00206241  0.01594973  0.03861565]
Stock Position:  -0.0020624109651551227
Bond Position:  [0.8477349]


portfolio before change:  [0.64233583]
curr_Stock_Price:  99.6431133025869
curr_Factors:  [99.6431133  -0.81102388 -0.95647108]
mat_Sqrt:  [[17.01507931  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0060714  0.0278103  0.16792726]
Stock Position:  0.006071397045786953
Bond Position:  [0.03736292]


portfolio before change:  [0.64302292]
curr_Stock_Price:  99.75551253620472
curr_Factors:  [99.75551254 -0.93081496 -0.96323713]
mat_Sqrt:  [[15.00930322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00151607  0.02006883 -0.193042  ]
Stock Position:  0.0015160735404775177
Bond Position:  [0.49178622]


portfolio before change:  [0.6422273]
curr_Stock_Price:  99.19017593460882
curr_Factors:  [99.19017593 -0.62318699 -0.96861716]
mat_Sqrt:  [[20.19095693  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00345857 -0.04882058  0.45726154]
Stock Position:  -0.0034585700947118705
Bond Position:  [0.98528348]


portfolio before change:  [0.64003794]
curr_Stock_Price:  99.85881447764146
curr_Factors:  [99.85881448 -0.71131447 -0.96625665]
mat_Sqrt:  [[18.65634331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00408547 -0.05755987  0.29078679]
Stock Position:  -0.004085472047742551
Bond Position:  [1.04800833]


portfolio before change:  [0.63571195]
curr_Stock_Price:  100.9497519049643
curr_Factors:  [100.9497519   -0.68722814  -0.96619231]
mat_Sqrt:  [[19.32119043  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00881056 0.22440699 0.29581746]
Stock Position:  0.008810561367620913
Bond Position:  [-0.25371203]


portfolio before change:  [0.63345446]
curr_Stock_Price:  100.69712632490996
curr_Factors:  [100.69712632  -0.71387889  -0.98422697]
mat_Sqrt:  [[18.43058289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02102327 0.00309824 0.9183509 ]
Stock Position:  0.021023272597647316
Bond Position:  [-1.48352867]


portfolio before change:  [0.67717539]
curr_Stock_Price:  102.78559170242876
curr_Factors:  [102.7855917   -0.66950999  -0.98369323]
mat_Sqrt:  [[19.67683322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04407547 0.09751935 1.6767986 ]
Stock Position:  0.04407546609265229
Bond Position:  [-3.85314747]


portfolio before change:  [0.62571366]
curr_Stock_Price:  101.6289378881117
curr_Factors:  [101.62893789  -0.77890456  -0.99078853]
mat_Sqrt:  [[17.31607449  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01373811 -0.06881723  0.09062733]
Stock Position:  -0.013738106269582481
Bond Position:  [2.02190281]


portfolio before change:  [0.64428412]
curr_Stock_Price:  100.29558716319333
curr_Factors:  [100.29558716  -0.65823589  -0.95067173]
mat_Sqrt:  [[20.06975738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00233462 -0.00607759  0.25508444]
Stock Position:  -0.0023346158753639475
Bond Position:  [0.8784358]


portfolio before change:  [0.64275369]
curr_Stock_Price:  100.99816441714212
curr_Factors:  [100.99816442  -0.45918388  -0.9632009 ]
mat_Sqrt:  [[24.35452274  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090598 -0.01863116  0.39798013]
Stock Position:  0.0009059799821732889
Bond Position:  [0.55125137]


portfolio before change:  [0.64374635]
curr_Stock_Price:  102.01777719488646
curr_Factors:  [102.01777719  -0.44439694  -0.94976341]
mat_Sqrt:  [[25.30461368  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084773  0.01938422 -0.55057078]
Stock Position:  -0.0008477324401465221
Bond Position:  [0.73023013]


portfolio before change:  [0.64183691]
curr_Stock_Price:  104.37786799052536
curr_Factors:  [104.37786799  -0.46289588  -0.96883161]
mat_Sqrt:  [[24.93544202  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01684063 -0.04051236 -0.67464628]
Stock Position:  0.016840627102222054
Bond Position:  [-1.11595185]


portfolio before change:  [0.61488846]
curr_Stock_Price:  102.78594719008042
curr_Factors:  [102.78594719  -0.61332029  -0.96671182]
mat_Sqrt:  [[21.17066565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00990463 -0.03108134  0.34018771]
Stock Position:  -0.009904626241772685
Bond Position:  [1.63294485]


portfolio before change:  [0.6138717]
curr_Stock_Price:  102.90921198499059
curr_Factors:  [102.90921198  -0.56121028  -0.97058955]
mat_Sqrt:  [[22.24344432  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00221439  0.00549911 -0.07853745]
Stock Position:  0.00221439163266221
Bond Position:  [0.3859904]


portfolio before change:  [0.61502092]
curr_Stock_Price:  103.406399226588
curr_Factors:  [103.40639923  -0.55526648  -0.93946646]
mat_Sqrt:  [[23.19493449  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268128 -0.01942762  0.08495127]
Stock Position:  -0.002681280011996916
Bond Position:  [0.89228243]


portfolio before change:  [0.61328503]
curr_Stock_Price:  104.09540986766463
curr_Factors:  [104.09540987  -0.4598604   -0.95620808]
mat_Sqrt:  [[25.26043648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0045687  -0.05834171  0.03647202]
Stock Position:  0.004568701098074213
Bond Position:  [0.13770422]


portfolio before change:  [0.62089773]
curr_Stock_Price:  105.75791354510606
curr_Factors:  [105.75791355  -0.63943359  -0.9852523 ]
mat_Sqrt:  [[20.83151032  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.49713033e-03 -1.99591284e-04  1.16624942e+00]
Stock Position:  0.006497130330498613
Bond Position:  [-0.06622522]


portfolio before change:  [0.60686507]
curr_Stock_Price:  103.59936385682792
curr_Factors:  [103.59936386  -0.26172898  -0.97446766]
mat_Sqrt:  [[30.09426279  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.76819090e-03  2.08970146e-01 -1.80326109e+00]
Stock Position:  -0.0017681909023521032
Bond Position:  [0.79004852]


portfolio before change:  [0.60639428]
curr_Stock_Price:  103.92147192734538
curr_Factors:  [103.92147193  -0.49716074  -0.97715487]
mat_Sqrt:  [[23.7912989   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02138102 0.08056713 0.14116751]
Stock Position:  0.021381016705583268
Bond Position:  [-1.61555244]


portfolio before change:  [0.61949618]
curr_Stock_Price:  104.54369951302004
curr_Factors:  [104.54369951  -0.6921325   -0.98663584]
mat_Sqrt:  [[19.50823779  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012765   0.05225394 -0.18303432]
Stock Position:  -0.0012765046158106942
Bond Position:  [0.7529467]


portfolio before change:  [0.61812246]
curr_Stock_Price:  105.69359338601626
curr_Factors:  [105.69359339  -0.7759915   -1.00281622]
mat_Sqrt:  [[17.84523559  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00341987 -0.04749114 -0.3055901 ]
Stock Position:  -0.0034198650398796627
Bond Position:  [0.97958029]


portfolio before change:  [0.61494197]
curr_Stock_Price:  106.65940546623847
curr_Factors:  [106.65940547  -1.0365833   -1.05083139]
mat_Sqrt:  [[13.22654691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.39690821e-05 -1.06643430e-02 -2.42948151e-02]
Stock Position:  4.396908209523077e-05
Bond Position:  [0.61025226]


portfolio before change:  [0.61501595]
curr_Stock_Price:  106.60697716947197
curr_Factors:  [106.60697717  -0.97602545  -1.05041795]
mat_Sqrt:  [[14.05116851  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00064592  0.00710884 -0.04280458]
Stock Position:  0.0006459231109184063
Bond Position:  [0.54615604]


portfolio before change:  [0.61553193]
curr_Stock_Price:  107.30009330870256
curr_Factors:  [107.30009331  -0.97914261  -1.05306944]
mat_Sqrt:  [[14.06117512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00888139 -0.00319868  0.5149981 ]
Stock Position:  0.00888139069864114
Bond Position:  [-0.33744212]


portfolio before change:  [0.62058182]
curr_Stock_Price:  107.87343587716796
curr_Factors:  [107.87343588  -0.86080582  -1.06907689]
mat_Sqrt:  [[15.65947141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0130841  -0.01668109  0.64621231]
Stock Position:  0.013084100390938165
Bond Position:  [-0.79084504]


portfolio before change:  [0.62174197]
curr_Stock_Price:  107.96966044996918
curr_Factors:  [107.96966045  -0.91912496  -1.06424559]
mat_Sqrt:  [[14.8571275   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00285168  0.01082762 -0.34035313]
Stock Position:  -0.002851682423219888
Bond Position:  [0.92963716]


portfolio before change:  [0.62199866]
curr_Stock_Price:  107.92040126366003
curr_Factors:  [107.92040126  -0.99358719  -1.06095804]
mat_Sqrt:  [[13.83011839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00402702  0.00153904  0.08456524]
Stock Position:  -0.004027021074217239
Bond Position:  [1.05659639]


portfolio before change:  [0.62309704]
curr_Stock_Price:  107.68044699760335
curr_Factors:  [107.680447    -0.84076158  -1.06147211]
mat_Sqrt:  [[16.06968103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00381988 -0.00512777  0.01209942]
Stock Position:  0.0038198756701853425
Bond Position:  [0.21177112]


portfolio before change:  [0.62298128]
curr_Stock_Price:  107.64321304775544
curr_Factors:  [107.64321305  -0.89471194  -1.06165009]
mat_Sqrt:  [[15.21771399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214761 -0.03238809 -0.54483105]
Stock Position:  -0.0021476121776087256
Bond Position:  [0.85415716]


portfolio before change:  [0.62367838]
curr_Stock_Price:  107.36833854040847
curr_Factors:  [107.36833854  -0.7437168   -1.06123065]
mat_Sqrt:  [[17.66027707  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00418869 -0.00069592  0.42348905]
Stock Position:  0.0041886854324315985
Bond Position:  [0.17394619]


portfolio before change:  [0.62321176]
curr_Stock_Price:  107.25174652747921
curr_Factors:  [107.25174653  -0.63952079  -1.06604726]
mat_Sqrt:  [[19.48433452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00434017 -0.03452796 -0.76260365]
Stock Position:  -0.004340170341929984
Bond Position:  [1.08870261]


portfolio before change:  [0.62411034]
curr_Stock_Price:  107.07606541917879
curr_Factors:  [107.07606542  -0.71910693  -1.05083787]
mat_Sqrt:  [[18.23959312  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00531062  0.08865993 -0.27501548]
Stock Position:  0.005310621592137189
Bond Position:  [0.05546988]


portfolio before change:  [0.61872814]
curr_Stock_Price:  106.061280147219
curr_Factors:  [106.06128015  -0.8805202   -1.06522489]
mat_Sqrt:  [[15.15411253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00103304 -0.00038856  0.18263263]
Stock Position:  0.0010330423735556218
Bond Position:  [0.50916234]


portfolio before change:  [0.61994182]
curr_Stock_Price:  107.17453051872617
curr_Factors:  [107.17453052  -0.76052601  -1.07564796]
mat_Sqrt:  [[17.08643143  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02730393 -0.08740287  0.87953825]
Stock Position:  0.02730392989884733
Bond Position:  [-2.30634405]


portfolio before change:  [0.60972561]
curr_Stock_Price:  106.81092353877311
curr_Factors:  [106.81092354  -0.62107439  -1.06782989]
mat_Sqrt:  [[19.73030776  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00505007  0.01808801  0.15342934]
Stock Position:  -0.00505006962390356
Bond Position:  [1.14912821]


portfolio before change:  [0.61755821]
curr_Stock_Price:  105.28837940536111
curr_Factors:  [105.28837941  -0.62283246  -1.05028418]
mat_Sqrt:  [[19.75855227  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01330994 -0.00776714  0.2132109 ]
Stock Position:  0.013309941039025715
Bond Position:  [-0.78382391]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.59442573]
Stock Price:  103.55775579177983
PL:  [-2.96333006]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 6.84756698e-02 -6.87508672e-02  8.61986447e-03]
 [-1.45827201e-01  6.79236678e-02 -1.60972308e-01]
 [-1.68671909e-02  2.88934962e-02  3.45646572e-02]
 [ 1.21330240e-01  2.94751591e-02  1.47392296e-01]
 [ 9.89122068e-02 -5.62289009e-02 -8.48208476e-02]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.20334195e-02 -1.82512544e-01 -2.77442004e-02]
 [ 6.55497858e-03  6.41645493e-01  9.94986949e-02]
 [ 4.74036589e-01  7.40802877e-02  4.58556751e-01]
 [ 7.23561735e-01  3.36758137e-01  6.80435162e-01]
 [-4.88777728e-02 -2.22325090e-01 -4.11233375e-02]
 [-1.10840914e-01 -2.36358036e-02  7.98202163e-02]
 [ 1.61409270e-02 -9.64466288e-02  1.23089523e-01]
 [ 1.97627034e-03  8.82638933e-02 -3.66393938e-02]
 [ 5.26176277e-01 -1.65850098e-01 -2.31686994e-01]
 [-1.95532827e-01 -9.53090644e-02  1.15443766e-01]
 [ 5.50493582e-02 -2.76164175e-03 -6.80012371e-03]
 [-6.51811290e-02 -6.56347921e-02  1.66833835e-02]
 [ 1.75584464e-01 -2.17532210e-01  4.52708630e-02]
 [ 4.45009391e-02 -6.35598367e-03  2.92753820e-01]
 [-3.65800408e-02  5.08118837e-01 -4.91971152e-01]
 [ 3.56826665e-01  2.06180995e-01  6.42712209e-02]
 [ 1.87492733e-02  1.20934614e-01 -2.27097309e-02]
 [ 1.30126130e-02 -1.54245731e-01 -1.41631603e-01]
 [ 4.59745807e-02  4.97367338e-03 -1.28634746e-02]
 [-2.75258344e-02  1.16146083e-02  7.01203166e-02]
 [ 8.39395949e-02 -2.86310179e-02  3.74949396e-02]
 [ 1.51745537e-01 -6.62980704e-02  1.19704540e-01]
 [-4.27575598e-02 -4.93320842e-03 -5.16694424e-02]
 [-5.63850382e-02 -1.32227470e-02  4.24942870e-02]
 [-2.08967937e-02 -5.32520121e-02 -3.54960976e-02]
 [ 2.66055952e-02 -7.92856131e-02 -1.57429714e-01]
 [ 6.76705024e-02 -1.56701618e-03  1.40769740e-01]
 [-8.84051944e-03 -1.08281585e-01 -2.76328962e-01]
 [ 5.05726071e-02  2.32678628e-01 -7.58345725e-02]
 [ 8.08295392e-03  2.81990808e-02  9.63498740e-02]
 [ 4.35113896e-01 -2.60092375e-01  2.89482908e-01]
 [-1.02996920e-01  3.83663215e-02  4.93531846e-02]
 [ 2.49214345e-01 -2.33620381e-02  7.57482220e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.27024029]
curr_Stock_Price:  99.73229334559652
curr_Factors:  [99.73229335 -0.96019088 -1.00166111]
mat_Sqrt:  [[14.02214053  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00400805 -0.02218925  0.02459007]
Stock Position:  0.004008052845850779
Bond Position:  [-0.12949202]


portfolio before change:  [0.27307178]
curr_Stock_Price:  100.44278399439632
curr_Factors:  [100.44278399  -0.96262366  -1.04415917]
mat_Sqrt:  [[13.5015625   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01220753  0.02192227 -0.45920919]
Stock Position:  -0.012207525976037702
Bond Position:  [1.49922968]


portfolio before change:  [0.27558341]
curr_Stock_Price:  100.25239195086503
curr_Factors:  [100.25239195  -1.06344478  -1.04721511]
mat_Sqrt:  [[12.14637821  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00032222  0.00932534  0.09860335]
Stock Position:  -0.00032222358927440977
Bond Position:  [0.3078871]


portfolio before change:  [0.27562774]
curr_Stock_Price:  100.23426377391266
curr_Factors:  [100.23426377  -0.97407509  -1.0462449 ]
mat_Sqrt:  [[13.29236881  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01184388 0.00951307 0.42046919]
Stock Position:  0.01184387528383638
Bond Position:  [-0.91153438]


portfolio before change:  [0.28159589]
curr_Stock_Price:  100.74778610457435
curr_Factors:  [100.7477861   -0.76996199  -1.04030215]
mat_Sqrt:  [[16.48343743  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.004254   -0.0181478  -0.24197027]
Stock Position:  0.004254000278717719
Bond Position:  [-0.14698522]


portfolio before change:  [0.28685878]
curr_Stock_Price:  101.98926873413805
curr_Factors:  [101.98926873  -0.68736654  -1.06064884]
mat_Sqrt:  [[17.75828592  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00863283 -0.05534923  0.15513819]
Stock Position:  -0.008632826213579217
Bond Position:  [1.16731441]


portfolio before change:  [0.28787753]
curr_Stock_Price:  101.88816401902517
curr_Factors:  [101.88816402  -0.83533482  -1.06078374]
mat_Sqrt:  [[15.2985373   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0062066  -0.05890567 -0.07914648]
Stock Position:  -0.006206599751141339
Bond Position:  [0.92025658]


portfolio before change:  [0.28020803]
curr_Stock_Price:  103.14239886107119
curr_Factors:  [103.14239886  -1.08104699  -1.04390394]
mat_Sqrt:  [[12.31920728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01281255 0.20709019 0.28384208]
Stock Position:  0.012812545391808627
Bond Position:  [-1.04130864]


portfolio before change:  [0.28872857]
curr_Stock_Price:  103.81757373151977
curr_Factors:  [103.81757373  -1.09916892  -1.04472258]
mat_Sqrt:  [[12.16719943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04789604 0.02390931 1.30813477]
Stock Position:  0.04789603992769742
Bond Position:  [-4.68372209]


portfolio before change:  [0.30961341]
curr_Stock_Price:  104.26584352250914
curr_Factors:  [104.26584352  -1.20021792  -1.03171259]
mat_Sqrt:  [[11.18991931  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08321735 0.10868822 1.94109212]
Stock Position:  0.08321735143569849
Bond Position:  [-8.36711393]


portfolio before change:  [0.33435318]
curr_Stock_Price:  104.5757034374511
curr_Factors:  [104.57570344  -0.84433802  -1.02900721]
mat_Sqrt:  [[16.06376339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00639041 -0.07175511 -0.11731344]
Stock Position:  -0.006390405245399575
Bond Position:  [1.0026343]


portfolio before change:  [0.33327302]
curr_Stock_Price:  104.76434558786877
curr_Factors:  [104.76434559  -0.97080492  -1.02342215]
mat_Sqrt:  [[14.26039951  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00696841 -0.00762842  0.22770486]
Stock Position:  -0.00696841061094541
Bond Position:  [1.063314]


portfolio before change:  [0.33345436]
curr_Stock_Price:  104.75739677505068
curr_Factors:  [104.75739678  -1.01773723  -1.03136231]
mat_Sqrt:  [[13.49808239  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0015987  -0.03112802  0.35114015]
Stock Position:  0.0015987000511729196
Bond Position:  [0.16597871]


portfolio before change:  [0.3334987]
curr_Stock_Price:  104.77214875710631
curr_Factors:  [104.77214876  -1.19839243  -1.0380996 ]
mat_Sqrt:  [[11.19308249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00111802  0.02848705 -0.10452199]
Stock Position:  0.001118018845306924
Bond Position:  [0.21636146]


portfolio before change:  [0.33382454]
curr_Stock_Price:  105.03940247390946
curr_Factors:  [105.03940247  -1.32783242  -1.0602969 ]
mat_Sqrt:  [[ 9.64274887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04615171 -0.05352789 -0.6609385 ]
Stock Position:  0.04615171087689746
Bond Position:  [-4.5139236]


portfolio before change:  [0.32466259]
curr_Stock_Price:  104.853110966044
curr_Factors:  [104.85311097  -1.32830209  -1.04678474]
mat_Sqrt:  [[ 9.75201176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01962906 -0.03076087  0.32932893]
Stock Position:  -0.019629062515252885
Bond Position:  [2.38283086]


portfolio before change:  [0.31466974]
curr_Stock_Price:  105.37737029700108
curr_Factors:  [105.3773703   -1.04934756  -1.02292211]
mat_Sqrt:  [[13.26697998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00400223 -0.00089132 -0.01939886]
Stock Position:  0.004002234950488999
Bond Position:  [-0.10707525]


portfolio before change:  [0.31397388]
curr_Stock_Price:  105.20684620657259
curr_Factors:  [105.20684621  -0.73546669  -1.01281342]
mat_Sqrt:  [[18.31367893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00410476 -0.02118354  0.04759305]
Stock Position:  -0.004104762002538915
Bond Position:  [0.74582294]


portfolio before change:  [0.31516208]
curr_Stock_Price:  104.9400905924911
curr_Factors:  [104.94009059  -0.70447379  -0.9759615 ]
mat_Sqrt:  [[19.54959032  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00718285 -0.07020822  0.12914517]
Stock Position:  0.007182849404034318
Bond Position:  [-0.43860679]


portfolio before change:  [0.31035926]
curr_Stock_Price:  104.27907204057932
curr_Factors:  [104.27907204  -0.72637795  -0.97629451]
mat_Sqrt:  [[18.99922577  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00541926 -0.00205138  0.83514516]
Stock Position:  0.0054192551746916765
Bond Position:  [-0.25475564]


portfolio before change:  [0.30790041]
curr_Stock_Price:  103.83122430544506
curr_Factors:  [103.83122431  -0.73573549  -0.99448961]
mat_Sqrt:  [[18.40351423  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180856  0.16399465 -1.40345676]
Stock Position:  -0.0018085626492241426
Bond Position:  [0.49568568]


portfolio before change:  [0.30947145]
curr_Stock_Price:  102.9968161545258
curr_Factors:  [102.99681615  -0.83500289  -0.97453198]
mat_Sqrt:  [[16.86369697  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02443311 0.06654463 0.1833479 ]
Stock Position:  0.02443310579880141
Bond Position:  [-2.20706065]


portfolio before change:  [0.29955899]
curr_Stock_Price:  102.60241012628524
curr_Factors:  [102.60241013  -0.93224012  -0.96745569]
mat_Sqrt:  [[15.3507696   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00252752  0.03903148 -0.06478454]
Stock Position:  0.0025275178133980485
Bond Position:  [0.04022957]


portfolio before change:  [0.30068169]
curr_Stock_Price:  103.04461267003502
curr_Factors:  [103.04461267  -0.86317934  -0.97284219]
mat_Sqrt:  [[16.43051852  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288385 -0.0497826  -0.40403554]
Stock Position:  -0.0028838465994694166
Bond Position:  [0.59784655]


portfolio before change:  [0.30014137]
curr_Stock_Price:  103.25788841693226
curr_Factors:  [103.25788842  -1.1111483   -0.95736704]
mat_Sqrt:  [[13.04903638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0033998   0.00160525 -0.03669591]
Stock Position:  0.00339979753571207
Bond Position:  [-0.05091454]


portfolio before change:  [0.29751671]
curr_Stock_Price:  102.48775532918685
curr_Factors:  [102.48775533  -1.13243031  -0.96595572]
mat_Sqrt:  [[12.5705566   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00086247  0.0037486   0.20003375]
Stock Position:  -0.0008624727681081244
Bond Position:  [0.38590961]


portfolio before change:  [0.29663504]
curr_Stock_Price:  103.56595363499714
curr_Factors:  [103.56595363  -0.9066598   -0.96505583]
mat_Sqrt:  [[15.93460258  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0053813  -0.00924062  0.10696263]
Stock Position:  0.00538130366797804
Bond Position:  [-0.26068481]


portfolio before change:  [0.29420458]
curr_Stock_Price:  103.12036026531736
curr_Factors:  [103.12036027  -0.71137644  -0.98002955]
mat_Sqrt:  [[19.00098576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00855993 -0.02139761  0.34148373]
Stock Position:  0.0085599288766899
Bond Position:  [-0.58849837]


portfolio before change:  [0.30464991]
curr_Stock_Price:  104.34921402538059
curr_Factors:  [104.34921403  -0.90981868  -0.98723448]
mat_Sqrt:  [[15.65342808  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00346963 -0.00159219 -0.14739854]
Stock Position:  -0.0034696251357899045
Bond Position:  [0.66670257]


portfolio before change:  [0.30117441]
curr_Stock_Price:  105.37492822991337
curr_Factors:  [105.37492823  -1.26915917  -0.98430592]
mat_Sqrt:  [[11.06801748  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00455457 -0.00426762  0.12122437]
Stock Position:  -0.004554565460776794
Bond Position:  [0.78111142]


portfolio before change:  [0.29619133]
curr_Stock_Price:  106.49045204932688
curr_Factors:  [106.49045205  -1.0954048   -0.99860355]
mat_Sqrt:  [[13.11880872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297378 -0.01718701 -0.10126049]
Stock Position:  -0.002973778076267909
Bond Position:  [0.6128703]


portfolio before change:  [0.29689752]
curr_Stock_Price:  106.27874105388834
curr_Factors:  [106.27874105  -0.95887243  -1.00787844]
mat_Sqrt:  [[14.86953364  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146028 -0.02558932 -0.44910315]
Stock Position:  -0.0014602824287447385
Bond Position:  [0.4520945]


portfolio before change:  [0.29587448]
curr_Stock_Price:  107.0180226728405
curr_Factors:  [107.01802267  -1.06512406  -1.0087682 ]
mat_Sqrt:  [[13.45169328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00714298 -0.00050575  0.40157688]
Stock Position:  0.007142977270658323
Bond Position:  [-0.46855283]


portfolio before change:  [0.30059379]
curr_Stock_Price:  107.68691472451717
curr_Factors:  [107.68691472  -0.99831733  -0.98787715]
mat_Sqrt:  [[14.77643376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00591136 -0.03494773 -0.78828961]
Stock Position:  -0.005911359936182972
Bond Position:  [0.9371699]


portfolio before change:  [0.30819885]
curr_Stock_Price:  106.42021568605776
curr_Factors:  [106.42021569  -0.79503689  -0.99810674]
mat_Sqrt:  [[17.71216903  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0046628   0.0750967  -0.21633493]
Stock Position:  0.004662797971006449
Bond Position:  [-0.18801711]


portfolio before change:  [0.3015069]
curr_Stock_Price:  104.99007748832675
curr_Factors:  [104.99007749  -0.53158891  -0.98731279]
mat_Sqrt:  [[22.98781164  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00145757 0.00910121 0.27485937]
Stock Position:  0.0014575725334998397
Bond Position:  [0.14847625]


portfolio before change:  [0.30431488]
curr_Stock_Price:  106.9038182896718
curr_Factors:  [106.90381829  -0.59555581  -1.00963355]
mat_Sqrt:  [[21.47179434  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02054384 -0.08394445  0.82581416]
Stock Position:  0.02054384493098965
Bond Position:  [-1.89190058]


portfolio before change:  [0.26795973]
curr_Stock_Price:  105.14569310159897
curr_Factors:  [105.1456931   -0.4956534   -1.00987955]
mat_Sqrt:  [[23.33172428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364702  0.01238268  0.1407909 ]
Stock Position:  -0.003647019384722663
Bond Position:  [0.65142811]


portfolio before change:  [0.26764121]
curr_Stock_Price:  105.25535734864772
curr_Factors:  [105.25535735  -0.72080616  -1.01575257]
mat_Sqrt:  [[18.53814749  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01402015 -0.00754007  0.21608859]
Stock Position:  0.014020151165733555
Bond Position:  [-1.20805481]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.28280568]
Stock Price:  106.34774773381977
PL:  [-6.06494206]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 5.06258242e-02 -7.10154703e-02  9.31675220e-03]
 [-1.40614465e-01  7.73191517e-02 -1.21200345e-01]
 [-2.76231572e-02  3.92165748e-02  2.69501805e-02]
 [-3.44095551e-01 -1.40185128e-01 -2.04959764e-01]
 [ 1.04943387e-01 -7.26765525e-02 -8.86352780e-02]
 [-1.29525013e-01 -1.69712121e-01  6.44522471e-02]
 [-6.03280464e-02 -1.85010263e-01  1.03247335e-01]
 [ 1.92028374e-02  7.03668766e-01  8.60998289e-02]
 [ 1.57380258e-01  3.63209054e-03  1.65149862e-01]
 [ 4.00896883e-01  1.60027589e-01  2.71898683e-01]
 [-1.74738626e-01 -1.82879312e-01  4.59373644e-02]
 [-8.21495077e-03 -1.61117182e-02  1.00868595e-01]
 [ 1.45991911e-02 -4.86160813e-02  4.90424965e-02]
 [ 3.82267093e-03  4.77310766e-02 -5.34224977e-02]
 [ 1.88547592e-01 -1.44478266e-01 -1.29111468e-01]
 [-1.28083113e-01 -6.85822669e-02  9.89231634e-02]
 [ 4.89344697e-02  2.14587910e-02 -1.31254047e-02]
 [-1.58061054e-02 -5.49142251e-02 -2.69160433e-02]
 [ 4.63537133e-02  5.10775196e-02 -2.60757285e-01]
 [-7.68765644e-02  1.93487886e-02 -5.26205431e-02]
 [-4.73978438e-02  5.58854376e-01 -5.19091327e-01]
 [ 5.72386295e-01  3.09325551e-01  2.91688542e-02]
 [ 6.73202222e-03 -5.48364857e-02  8.28218011e-02]
 [ 7.33991901e-02  1.51034165e-01 -6.30929247e-02]
 [-1.76209394e-01  6.23279714e-02  8.31839887e-03]
 [-1.74679466e-01 -4.15491619e-02  1.41015898e-01]
 [-9.47117504e-02 -3.58109409e-02 -2.82498271e-02]
 [-7.61081095e-02  1.10939722e-01 -7.21984737e-02]
 [ 2.64940819e-01  5.52079155e-02  2.61958453e-01]
 [ 9.99235330e-02  7.54302389e-02 -1.46062187e-01]
 [ 7.34867300e-02  5.87902633e-02  1.14655691e-01]
 [-6.64832199e-03  1.19255994e-01 -1.28163715e-01]
 [-1.70766753e-02  6.37819456e-02 -6.11329764e-02]
 [ 6.67262909e-03 -1.23377841e-01  8.30177385e-02]
 [-8.07406381e-02  4.02360463e-02 -7.35873587e-02]
 [-2.21831849e-01 -2.27804095e-01 -2.07042857e-01]
 [ 1.15816043e-01  1.23383850e-01  3.17207706e-01]
 [ 1.92773804e-01 -1.34412866e-01 -2.20285845e-01]
 [ 9.63527787e-02  4.67295427e-03  7.52951962e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.49067623]
curr_Stock_Price:  99.7600842445957
curr_Factors:  [99.76008424 -0.96284134 -0.97548599]
mat_Sqrt:  [[14.35991746  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00264846 -0.02292014  0.0265781 ]
Stock Position:  0.00264845715024116
Bond Position:  [0.22646593]


portfolio before change:  [0.4904513]
curr_Stock_Price:  99.66446284235788
curr_Factors:  [99.66446284 -0.82527721 -0.95906579]
mat_Sqrt:  [[16.73439476  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00893798  0.02495465 -0.34575085]
Stock Position:  -0.008937979426903223
Bond Position:  [1.38125021]


portfolio before change:  [0.48805163]
curr_Stock_Price:  99.95226075607489
curr_Factors:  [99.95226076 -0.83300048 -0.95130206]
mat_Sqrt:  [[16.78339731  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084112  0.0126571   0.07688136]
Stock Position:  -0.0008411243889730979
Bond Position:  [0.57212391]


portfolio before change:  [0.48636386]
curr_Stock_Price:  102.04385556135882
curr_Factors:  [102.04385556  -0.83871421  -0.98738728]
mat_Sqrt:  [[16.43315909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02522631 -0.04524456 -0.58469316]
Stock Position:  -0.025226309511020333
Bond Position:  [3.06055374]


portfolio before change:  [0.52089522]
curr_Stock_Price:  100.69015921803425
curr_Factors:  [100.69015922  -0.91789368  -0.97509489]
mat_Sqrt:  [[15.16605196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00474848 -0.02345626 -0.25285178]
Stock Position:  0.004748483493246007
Bond Position:  [0.04276966]


portfolio before change:  [0.52090202]
curr_Stock_Price:  100.69046557632258
curr_Factors:  [100.69046558  -0.89178598  -0.9884613 ]
mat_Sqrt:  [[15.36056991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00983109 -0.05477435  0.18386432]
Stock Position:  -0.009831086720657824
Bond Position:  [1.51079872]


portfolio before change:  [0.53000385]
curr_Stock_Price:  99.78385403423336
curr_Factors:  [99.78385403 -1.0478182  -1.01668495]
mat_Sqrt:  [[12.6607067   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00608322 -0.05971181  0.29453591]
Stock Position:  -0.0060832176266931185
Bond Position:  [1.13701075]


portfolio before change:  [0.52958313]
curr_Stock_Price:  99.87638035237919
curr_Factors:  [99.87638035 -1.11512684 -1.03225537]
mat_Sqrt:  [[11.66451131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01546689 0.22710812 0.24561885]
Stock Position:  0.01546688686068551
Bond Position:  [-1.01519354]


portfolio before change:  [0.53932566]
curr_Stock_Price:  100.51448122664365
curr_Factors:  [100.51448123  -1.32152704  -1.02956155]
mat_Sqrt:  [[ 9.57555235  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02003359 0.00117225 0.47112659]
Stock Position:  0.020033594143030183
Bond Position:  [-1.47434066]


portfolio before change:  [0.54804656]
curr_Stock_Price:  100.95899482575189
curr_Factors:  [100.95899483  -1.37017633  -1.04365251]
mat_Sqrt:  [[ 9.03300963  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05414181 0.05164868 0.77565126]
Stock Position:  0.05414180698298924
Bond Position:  [-4.91805585]


portfolio before change:  [0.57983662]
curr_Stock_Price:  101.55751305500992
curr_Factors:  [101.55751306  -1.32437703  -1.01841831]
mat_Sqrt:  [[ 9.7554873   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02077721 -0.05902404  0.13104651]
Stock Position:  -0.020777207517532915
Bond Position:  [2.68991815]


portfolio before change:  [0.58191393]
curr_Stock_Price:  101.47371731115732
curr_Factors:  [101.47371731  -1.07583751  -1.00045928]
mat_Sqrt:  [[12.72416612  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071407 -0.00520003  0.28775002]
Stock Position:  0.0007140722711748111
Bond Position:  [0.50945436]


portfolio before change:  [0.58259898]
curr_Stock_Price:  102.34389766702179
curr_Factors:  [102.34389767  -1.23768516  -1.02523556]
mat_Sqrt:  [[10.6484886   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00137918 -0.01569077  0.13990459]
Stock Position:  0.0013791847168397623
Bond Position:  [0.44144784]


portfolio before change:  [0.58187039]
curr_Stock_Price:  101.77560378696114
curr_Factors:  [101.77560379  -1.13930823  -1.00518695]
mat_Sqrt:  [[11.92068642  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00022322  0.01540514 -0.15239952]
Stock Position:  0.00022321822507859868
Bond Position:  [0.55915222]


portfolio before change:  [0.58190446]
curr_Stock_Price:  101.61509992636778
curr_Factors:  [101.61509993  -0.90308932  -0.99663908]
mat_Sqrt:  [[15.20255859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00872888 -0.04663016 -0.36831908]
Stock Position:  0.008728880768325347
Bond Position:  [-0.30508164]


portfolio before change:  [0.57989275]
curr_Stock_Price:  101.38900404219115
curr_Factors:  [101.38900404  -0.76200102  -0.9930181 ]
mat_Sqrt:  [[17.53055794  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00695299 -0.02213483  0.28220025]
Stock Position:  -0.006952990540237324
Bond Position:  [1.28484954]


portfolio before change:  [0.59423103]
curr_Stock_Price:  99.34993008577528
curr_Factors:  [99.34993009 -0.77057174 -0.99170627]
mat_Sqrt:  [[17.0537524   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00296917  0.0069258  -0.03744313]
Stock Position:  0.0029691714700227456
Bond Position:  [0.29924405]


portfolio before change:  [0.5881222]
curr_Stock_Price:  97.27991004133901
curr_Factors:  [97.27991004 -0.47314777 -0.99274622]
mat_Sqrt:  [[22.45915901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014475  -0.01772349 -0.07678398]
Stock Position:  -0.0014475002812458352
Bond Position:  [0.72893489]


portfolio before change:  [0.58751621]
curr_Stock_Price:  97.76150472392835
curr_Factors:  [97.76150472 -0.15766139 -0.99814615]
mat_Sqrt:  [[30.77563634  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.15448807e-04  1.64851986e-02 -7.43867952e-01]
Stock Position:  0.0001154488074165445
Bond Position:  [0.57622976]


portfolio before change:  [0.58754775]
curr_Stock_Price:  97.41075058201645
curr_Factors:  [97.41075058 -0.13512002 -1.01608731]
mat_Sqrt:  [[30.80660902  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00271592  0.00624479 -0.15011176]
Stock Position:  -0.002715915041553195
Bond Position:  [0.85210707]


portfolio before change:  [0.58714329]
curr_Stock_Price:  97.59889220368201
curr_Factors:  [97.5988922  -0.18191323 -1.02454787]
mat_Sqrt:  [[29.2069017   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.34493025e-03  1.80369474e-01 -1.48082307e+00]
Stock Position:  -0.001344930245746968
Bond Position:  [0.71840699]


portfolio before change:  [0.58976217]
curr_Stock_Price:  95.71844304904054
curr_Factors:  [95.71844305 -0.12408523 -1.03358529]
mat_Sqrt:  [[30.07638976  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0213284  0.09983439 0.08321062]
Stock Position:  0.02132839682478626
Bond Position:  [-1.45175876]


portfolio before change:  [0.59503659]
curr_Stock_Price:  95.97424756238696
curr_Factors:  [95.97424756 -0.31107619 -1.03867619]
mat_Sqrt:  [[24.8865504   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00050005 -0.0176984   0.23626755]
Stock Position:  0.0005000492477485969
Bond Position:  [0.54704474]


portfolio before change:  [0.59477752]
curr_Stock_Price:  95.31940831582759
curr_Factors:  [95.31940832 -0.47314742 -1.03307837]
mat_Sqrt:  [[21.136632    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00432189  0.04874607 -0.17998655]
Stock Position:  0.004321886320868239
Bond Position:  [0.18281788]


portfolio before change:  [0.58980541]
curr_Stock_Price:  94.16367066928936
curr_Factors:  [94.16367067 -0.72395423 -1.06792082]
mat_Sqrt:  [[15.69213137  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01031018  0.02011627  0.02373008]
Stock Position:  -0.010310184137294034
Bond Position:  [1.56065019]


portfolio before change:  [0.59189555]
curr_Stock_Price:  93.97986757370867
curr_Factors:  [93.97986757 -0.52240021 -1.1039541 ]
mat_Sqrt:  [[18.4806876   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00835336 -0.01340993  0.40227911]
Stock Position:  -0.00835336362239277
Bond Position:  [1.37694356]


portfolio before change:  [0.60937775]
curr_Stock_Price:  91.90763960762476
curr_Factors:  [91.90763961 -0.44254413 -1.08998983]
mat_Sqrt:  [[19.8509169   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00542988 -0.01155793 -0.08058889]
Stock Position:  -0.00542988016214351
Bond Position:  [1.10842522]


portfolio before change:  [0.60856331]
curr_Stock_Price:  92.08314996783314
curr_Factors:  [92.08314997 -0.60931025 -1.1229783 ]
mat_Sqrt:  [[16.28758914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00418724  0.03580564 -0.20596215]
Stock Position:  -0.0041872424818689
Bond Position:  [0.99413779]


portfolio before change:  [0.60737523]
curr_Stock_Price:  92.39656705145747
curr_Factors:  [92.39656705 -0.50990199 -1.12503134]
mat_Sqrt:  [[18.01413094  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01830131 0.01781828 0.74729455]
Stock Position:  0.018301306545384026
Bond Position:  [-1.08360266]


portfolio before change:  [0.61940023]
curr_Stock_Price:  93.06102546246443
curr_Factors:  [93.06102546 -0.2067935  -1.11529584]
mat_Sqrt:  [[24.80799864  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0034467   0.024345   -0.41667476]
Stock Position:  0.0034467047619114654
Bond Position:  [0.29864635]


portfolio before change:  [0.61551478]
curr_Stock_Price:  91.9228978591238
curr_Factors:  [91.92289786 -0.13321401 -1.09529949]
mat_Sqrt:  [[26.90835028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00404675 0.01897448 0.32708077]
Stock Position:  0.004046745193247953
Bond Position:  [0.24352623]


portfolio before change:  [0.62805911]
curr_Stock_Price:  95.0152321260512
curr_Factors:  [95.01523213 -0.28026646 -1.07993356]
mat_Sqrt:  [[24.38180602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.47250849e-04  3.84897066e-02 -3.65615404e-01]
Stock Position:  -0.0003472508492961598
Bond Position:  [0.66105323]


portfolio before change:  [0.62829253]
curr_Stock_Price:  94.58099413261043
curr_Factors:  [94.58099413 -0.22528287 -1.09416369]
mat_Sqrt:  [[25.27990966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00065411  0.02058553 -0.17439537]
Stock Position:  -0.0006541145491413519
Bond Position:  [0.69015934]


portfolio before change:  [0.6296772]
curr_Stock_Price:  92.596040238703
curr_Factors:  [92.59604024 -0.13339665 -1.09647081]
mat_Sqrt:  [[27.06872277  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.78469237e-05 -3.98200270e-02  2.36826500e-01]
Stock Position:  -5.784692371810453e-05
Bond Position:  [0.63503359]


portfolio before change:  [0.62978692]
curr_Stock_Price:  92.07153034669987
curr_Factors:  [92.07153035 -0.23899919 -1.09913521]
mat_Sqrt:  [[24.15355018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00362466  0.01298613 -0.20992425]
Stock Position:  -0.003624661614985572
Bond Position:  [0.96351506]


portfolio before change:  [0.63137441]
curr_Stock_Price:  91.66679007240471
curr_Factors:  [ 9.16667901e+01 -8.09796046e-02 -1.10286348e+00]
mat_Sqrt:  [[28.05921417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01106926 -0.07352346 -0.59063564]
Stock Position:  -0.011069255505577013
Bond Position:  [1.64605754]


portfolio before change:  [0.63869139]
curr_Stock_Price:  91.02436144573934
curr_Factors:  [91.02436145  0.15986855 -1.12253164]
mat_Sqrt:  [[34.75988865  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00591922 0.03982197 0.90490529]
Stock Position:  0.005919219701002771
Bond Position:  [0.0998982]


portfolio before change:  [0.65071437]
curr_Stock_Price:  93.05342770905132
curr_Factors:  [ 9.30534277e+01 -4.77967534e-02 -1.11123351e+00]
mat_Sqrt:  [[29.19926545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00412241 -0.04338157 -0.6284142 ]
Stock Position:  0.004122406206585386
Bond Position:  [0.26711034]


portfolio before change:  [0.64802569]
curr_Stock_Price:  92.39311798292678
curr_Factors:  [92.39311798 -0.14383689 -1.09552925]
mat_Sqrt:  [[26.75406332  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00421155 0.00150819 0.21479624]
Stock Position:  0.004211554996098793
Bond Position:  [0.258907]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.64504659]
Stock Price:  91.67806812627664
PL:  [0.64504659]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 7.45630819e-02 -6.79785595e-02  8.38220176e-03]
 [-1.00805863e-01  7.12277986e-02 -1.02305249e-01]
 [ 1.63240855e-02 -6.23516725e-03  5.80277323e-02]
 [ 7.88572833e-03  3.83415577e-03  5.13949318e-02]
 [ 3.80142716e-02  4.34203369e-02 -6.96531773e-02]
 [-7.45292222e-02 -1.53446253e-01  1.48388228e-01]
 [-6.14481583e-02 -1.74072580e-01  7.96874282e-02]
 [ 8.55468827e-04  7.43617034e-01  1.17459922e-01]
 [ 3.46623452e-01  2.08728638e-02  3.45092912e-01]
 [ 4.41472230e-01  1.69533639e-01  2.82228492e-01]
 [-1.78485902e-01 -1.78573411e-01  5.22676249e-02]
 [-7.98535045e-02 -1.94738831e-02  8.71134360e-02]
 [ 4.38964274e-03 -5.60620767e-02  1.42797481e-01]
 [ 1.09956617e-02 -1.14936323e-01 -3.67178531e-02]
 [-2.54330779e-02  7.50228368e-02 -5.16683034e-02]
 [ 3.16192060e-02 -2.33832156e-02  4.78518421e-02]
 [ 4.77830496e-02  2.35253048e-02 -6.39101810e-03]
 [-5.13767801e-02 -5.93815299e-02  2.46390594e-02]
 [ 4.73106867e-02  4.58029919e-03 -1.63149454e-01]
 [ 7.18695354e-03  9.03376369e-03 -1.02621283e-02]
 [-2.35973599e-02  3.94558105e-01 -3.57132665e-01]
 [ 3.65347263e-02  5.29223825e-02  1.16428506e-01]
 [-2.23544402e-03 -1.44847333e-02  5.82222314e-02]
 [ 7.21243095e-02 -1.10208039e-01 -2.31298527e-01]
 [ 3.70736133e-02  1.49093113e-02 -1.29220592e-02]
 [-5.23385694e-02 -4.77863223e-03  1.58210487e-01]
 [-1.74525960e-02 -3.24769008e-02  1.46958033e-03]
 [-7.19942747e-02  5.31891198e-02 -2.37538386e-01]
 [-6.27780835e-02 -3.14519861e-02 -1.09684349e-02]
 [-4.90710601e-02  3.04235812e-03  1.03126531e-02]
 [ 1.62222515e-02 -4.39984552e-02 -6.79055225e-02]
 [ 1.58986181e-02  2.05797559e-02 -3.13935654e-02]
 [ 4.04579209e-02  1.21228439e-02  1.47106568e-01]
 [ 1.56301962e-02 -6.41357571e-02  1.91764749e-02]
 [-4.21635661e-02 -4.96524157e-03  4.23900426e-02]
 [ 9.15788369e-02  4.07376461e-03  1.70220511e-01]
 [-5.54083228e-02  7.45339715e-02 -1.56287308e-02]
 [-3.14682600e-02 -3.17570538e-02  9.93760698e-03]
 [ 9.40888737e-02  6.07550058e-03  8.86970639e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.21811331]
curr_Stock_Price:  99.72572156975058
curr_Factors:  [99.72572157 -0.98194871 -1.00867749]
mat_Sqrt:  [[13.62351634  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00458017 -0.02193999  0.02391209]
Stock Position:  0.004580170401525315
Bond Position:  [-0.23864749]


portfolio before change:  [0.2222817]
curr_Stock_Price:  100.6423318209117
curr_Factors:  [100.64233182  -1.00428249  -0.97963137]
mat_Sqrt:  [[13.84133074  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00774127  0.02298867 -0.2918484 ]
Stock Position:  -0.007741273050628143
Bond Position:  [1.00138148]


portfolio before change:  [0.2190167]
curr_Stock_Price:  101.08026829763182
curr_Factors:  [101.0802683   -0.92321902  -0.98244223]
mat_Sqrt:  [[15.03308875  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00178913 -0.00201239  0.16553697]
Stock Position:  0.0017891332216623762
Bond Position:  [0.03817063]


portfolio before change:  [0.21881638]
curr_Stock_Price:  100.96563878665665
curr_Factors:  [100.96563879  -0.82422803  -0.97625625]
mat_Sqrt:  [[16.68142754  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00114854 0.00123747 0.14661543]
Stock Position:  0.0011485419080202396
Bond Position:  [0.10285312]


portfolio before change:  [0.21774631]
curr_Stock_Price:  100.02276711001151
curr_Factors:  [100.02276711  -0.80129414  -1.01308614]
mat_Sqrt:  [[16.29759511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00200395  0.01401385 -0.19870113]
Stock Position:  0.0020039469181908657
Bond Position:  [0.017306]


portfolio before change:  [0.21635784]
curr_Stock_Price:  99.3288174286967
curr_Factors:  [99.32881743 -0.8983599  -1.00123655]
mat_Sqrt:  [[14.86247063  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00508406 -0.04952457  0.42331031]
Stock Position:  -0.0050840596530969465
Bond Position:  [0.72135147]


portfolio before change:  [0.2159499]
curr_Stock_Price:  99.42679274465617
curr_Factors:  [99.42679274 -0.90201598 -1.03715457]
mat_Sqrt:  [[14.29987899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00564441 -0.05618168  0.22732605]
Stock Position:  -0.005644414663307687
Bond Position:  [0.77715595]


portfolio before change:  [0.21344583]
curr_Stock_Price:  99.88764110843768
curr_Factors:  [99.88764111 -0.83503291 -1.03887881]
mat_Sqrt:  [[15.33494543  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01151762 0.24000137 0.33508046]
Stock Position:  0.011517619488182647
Bond Position:  [-0.93702201]


portfolio before change:  [0.2244012]
curr_Stock_Price:  100.84899447653522
curr_Factors:  [100.84899448  -0.70620814  -1.03703947]
mat_Sqrt:  [[17.64366308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02387973 0.00673669 0.98445402]
Stock Position:  0.02387972956041136
Bond Position:  [-2.18384552]


portfolio before change:  [0.2107891]
curr_Stock_Price:  100.29039931589645
curr_Factors:  [100.29039932  -0.7489474   -1.0417516 ]
mat_Sqrt:  [[16.73280175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03189471 0.05471675 0.80511933]
Stock Position:  0.031894705806701416
Bond Position:  [-2.98794368]


portfolio before change:  [0.19177153]
curr_Stock_Price:  99.70584917835815
curr_Factors:  [99.70584918 -0.67728428 -1.03675892]
mat_Sqrt:  [[17.96061216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01137311 -0.05763432  0.14910499]
Stock Position:  -0.01137310692521879
Bond Position:  [1.32573681]


portfolio before change:  [0.17711327]
curr_Stock_Price:  101.00927366080228
curr_Factors:  [101.00927366  -0.5309735   -1.03168564]
mat_Sqrt:  [[21.16932468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311992 -0.00628517  0.24851039]
Stock Position:  -0.0031199218507828117
Bond Position:  [0.49225431]


portfolio before change:  [0.18058425]
curr_Stock_Price:  99.9164760524873
curr_Factors:  [99.91647605 -0.57779698 -1.02511909]
mat_Sqrt:  [[20.11404916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00109846 -0.01809396  0.40736147]
Stock Position:  0.0010984577415398527
Bond Position:  [0.07083022]


portfolio before change:  [0.18033937]
curr_Stock_Price:  99.68548974100548
curr_Factors:  [99.68548974 -0.79597365 -1.0218512 ]
mat_Sqrt:  [[16.18678679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00123314 -0.03709554 -0.10474581]
Stock Position:  -0.0012331426589244881
Bond Position:  [0.3032658]


portfolio before change:  [0.18105198]
curr_Stock_Price:  99.13835787359226
curr_Factors:  [99.13835787 -0.57064992 -1.02474616]
mat_Sqrt:  [[20.10805224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102774  0.02421352 -0.14739529]
Stock Position:  -0.001027740203292391
Bond Position:  [0.28294045]


portfolio before change:  [0.18064419]
curr_Stock_Price:  99.56955400402745
curr_Factors:  [99.569554   -0.5338854  -1.03885041]
mat_Sqrt:  [[20.65837115  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00177235 -0.0075469   0.13650799]
Stock Position:  0.0017723489981584341
Bond Position:  [0.00417219]


portfolio before change:  [0.180587]
curr_Stock_Price:  99.53699057243193
curr_Factors:  [99.53699057 -0.90697278 -1.05290262]
mat_Sqrt:  [[14.02237032  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00365705  0.00759276 -0.0182318 ]
Stock Position:  0.0036570544069661217
Bond Position:  [-0.18342519]


portfolio before change:  [0.18193912]
curr_Stock_Price:  99.912991396491
curr_Factors:  [99.9129914  -1.18417219 -1.08194608]
mat_Sqrt:  [[10.36237496  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00564239 -0.01916531  0.07028838]
Stock Position:  -0.005642389645824015
Bond Position:  [0.74568715]


portfolio before change:  [0.18258976]
curr_Stock_Price:  99.81420034780746
curr_Factors:  [99.81420035 -1.04918294 -1.07007283]
mat_Sqrt:  [[11.98978092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012463   0.00147829 -0.46541998]
Stock Position:  0.0012463024669224544
Bond Position:  [0.05819107]


portfolio before change:  [0.18185275]
curr_Stock_Price:  99.21700485123688
curr_Factors:  [99.21700485 -1.10711898 -1.07395286]
mat_Sqrt:  [[11.20362716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0006191   0.00291563 -0.029275  ]
Stock Position:  0.0006191043810168794
Bond Position:  [0.12042706]


portfolio before change:  [0.18223085]
curr_Stock_Price:  99.80341899504754
curr_Factors:  [99.803419   -1.30234024 -1.09509927]
mat_Sqrt:  [[ 9.0771742   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175803  0.12734308 -1.01880009]
Stock Position:  -0.00175802772870859
Bond Position:  [0.35768803]


portfolio before change:  [0.18223886]
curr_Stock_Price:  99.82429885389745
curr_Factors:  [99.82429885 -1.43187358 -1.09982157]
mat_Sqrt:  [[ 7.93843755  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00895684 0.01708063 0.33213812]
Stock Position:  0.008956842103194518
Bond Position:  [-0.71187163]


portfolio before change:  [0.17861485]
curr_Stock_Price:  99.42962650592476
curr_Factors:  [99.42962651 -1.40225204 -1.1190732 ]
mat_Sqrt:  [[ 7.98947367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00083766 -0.00467493  0.16609182]
Stock Position:  0.0008376566047138676
Bond Position:  [0.09532697]


portfolio before change:  [0.17890756]
curr_Stock_Price:  99.76483561450102
curr_Factors:  [99.76483561 -1.4055426  -1.13611914]
mat_Sqrt:  [[ 7.85502953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.07392070e-04 -3.55694915e-02 -6.59830316e-01]
Stock Position:  0.0003073920701210616
Bond Position:  [0.14824064]


portfolio before change:  [0.17879156]
curr_Stock_Price:  99.32720500078102
curr_Factors:  [99.327205   -1.30650126 -1.15596919]
mat_Sqrt:  [[ 8.46507649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00442752  0.00481196 -0.03686304]
Stock Position:  0.004427515742449327
Bond Position:  [-0.2609812]


portfolio before change:  [0.1775935]
curr_Stock_Price:  99.0639790192457
curr_Factors:  [99.06397902 -1.44783392 -1.1302703 ]
mat_Sqrt:  [[ 7.5207184   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00279487 -0.0015423   0.45133048]
Stock Position:  -0.0027948690489235117
Bond Position:  [0.45446435]


portfolio before change:  [0.17857768]
curr_Stock_Price:  98.73216810836895
curr_Factors:  [98.73216811 -1.48407769 -1.08537847]
mat_Sqrt:  [[ 7.56063098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031455  -0.01048187  0.0041923 ]
Stock Position:  -0.0031454965715171606
Bond Position:  [0.48913938]


portfolio before change:  [0.17780521]
curr_Stock_Price:  98.9971866689267
curr_Factors:  [98.99718667 -1.47845644 -1.09086094]
mat_Sqrt:  [[ 7.58197749  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01445855  0.01716671 -0.6776309 ]
Stock Position:  -0.014458551357184893
Bond Position:  [1.60916112]


portfolio before change:  [0.17764]
curr_Stock_Price:  99.02252616378442
curr_Factors:  [99.02252616 -1.61896757 -1.11250231]
mat_Sqrt:  [[ 6.44869304  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01107777 -0.01015108 -0.03128989]
Stock Position:  -0.011077766488394479
Bond Position:  [1.27458842]


portfolio before change:  [0.17009741]
curr_Stock_Price:  99.71778602150181
curr_Factors:  [99.71778602 -1.70450481 -1.08438539]
mat_Sqrt:  [[ 6.13158853  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0075584   0.00098192  0.02941913]
Stock Position:  -0.007558396928349668
Bond Position:  [0.92380401]


portfolio before change:  [0.16915617]
curr_Stock_Price:  99.85759276555305
curr_Factors:  [99.85759277 -1.36811802 -1.06178715]
mat_Sqrt:  [[ 8.79197989  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00075296 -0.01420044 -0.19371555]
Stock Position:  -0.0007529648997048745
Bond Position:  [0.24434544]


portfolio before change:  [0.16894537]
curr_Stock_Price:  100.1781195531442
curr_Factors:  [100.17811955  -1.23909302  -1.06731962]
mat_Sqrt:  [[ 9.97954157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00137193  0.00664209 -0.0895571 ]
Stock Position:  0.0013719326055498904
Bond Position:  [0.03150774]


portfolio before change:  [0.16935018]
curr_Stock_Price:  100.47031020742706
curr_Factors:  [100.47031021  -1.20366149  -1.07311711]
mat_Sqrt:  [[10.30968418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00707689 0.00391263 0.41965409]
Stock Position:  0.007076888806202787
Bond Position:  [-0.54166704]


portfolio before change:  [0.1722009]
curr_Stock_Price:  100.88269949827642
curr_Factors:  [100.8826995   -1.14849214  -1.05383261]
mat_Sqrt:  [[11.15216554  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00057862 -0.02069973  0.05470515]
Stock Position:  0.0005786249459010373
Bond Position:  [0.11382765]


portfolio before change:  [0.17219027]
curr_Stock_Price:  100.83974306671485
curr_Factors:  [100.83974307  -1.23918429  -1.03209801]
mat_Sqrt:  [[10.40462333  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331817 -0.00160252  0.12092699]
Stock Position:  -0.003318165341229745
Bond Position:  [0.50679321]


portfolio before change:  [0.1728413]
curr_Stock_Price:  100.66263318153825
curr_Factors:  [100.66263318  -1.07336436  -1.01002738]
mat_Sqrt:  [[12.53322251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01014556 0.0013148  0.48559174]
Stock Position:  0.010145555691720898
Bond Position:  [-0.84843705]


portfolio before change:  [0.16445342]
curr_Stock_Price:  99.84633216610564
curr_Factors:  [99.84633217 -0.81529905 -1.00417445]
mat_Sqrt:  [[16.18619686  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268033  0.02405574 -0.04458442]
Stock Position:  -0.002680329498036263
Bond Position:  [0.43207449]


portfolio before change:  [0.16523721]
curr_Stock_Price:  99.57405835775376
curr_Factors:  [99.57405836 -0.82845742 -1.03176134]
mat_Sqrt:  [[15.49756506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00231792 -0.01024955  0.02834923]
Stock Position:  -0.002317921288344418
Bond Position:  [0.39604204]


portfolio before change:  [0.16258188]
curr_Stock_Price:  100.74098408998191
curr_Factors:  [100.74098409  -0.99354699  -1.02237285]
mat_Sqrt:  [[13.41848009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00845358 0.00196086 0.25302803]
Stock Position:  0.008453583539483596
Bond Position:  [-0.68904045]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.16611605]
Stock Price:  101.16924098873953
PL:  [-1.00312494]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.94496558e-01 -4.84849884e-02  3.07143847e-03]
 [-2.56004803e-01  4.86155551e-02 -2.78196848e-01]
 [-1.30146892e-02  2.48161225e-02  3.72880094e-02]
 [ 6.92298084e-02 -9.07046636e-03  1.15739224e-01]
 [ 1.14260811e-01 -8.95800624e-02 -9.15383834e-02]
 [-7.72782571e-02 -1.55540565e-01  1.36962188e-01]
 [-5.66242774e-02 -1.66411658e-01  4.94502737e-02]
 [ 1.53593940e-02  7.58728678e-01  1.18984556e-01]
 [ 1.07296907e-01  2.22008337e-02  1.11116693e-01]
 [ 3.79677992e-01  1.51212668e-01  2.54092044e-01]
 [-2.10026878e-01 -2.61382841e-01  4.87881735e-03]
 [ 5.64296860e-02 -1.16352126e-02  1.21238889e-01]
 [ 1.20359642e-02 -3.94217413e-02  5.77376647e-02]
 [ 5.07252495e-03 -1.70282653e-02  4.47299655e-02]
 [ 1.26422827e-01 -1.56547513e-01 -1.10483324e-01]
 [-5.27396673e-02 -4.72769415e-02  8.15362367e-02]
 [ 4.64679544e-02  2.58855747e-02  1.30066537e-03]
 [-3.40890520e-02 -4.72431924e-02  6.09530917e-02]
 [ 1.00657515e-01 -7.96326694e-02 -5.72929054e-02]
 [ 5.38109576e-02 -1.26507347e-02  1.84638625e-01]
 [-1.65832778e-02  3.41506825e-01 -3.23947312e-01]
 [ 1.54832323e-01  1.09527384e-01  9.71645759e-02]
 [-1.92881845e-02  5.37359815e-02  1.65728220e-02]
 [ 9.90048811e-02 -1.80266648e-01 -2.91691820e-01]
 [ 5.74675268e-02  2.22113829e-02 -1.41989899e-02]
 [-4.47248246e-02  7.11552932e-03  1.01760871e-01]
 [-1.11400601e-02 -3.24360943e-02  2.20069525e-03]
 [ 5.41137117e-02 -4.47449885e-02 -1.52037527e-01]
 [-5.35669558e-02 -3.83171548e-02  1.06351913e-02]
 [-6.82471483e-02 -3.76094892e-03  2.81205281e-02]
 [-2.62033157e-02 -4.20639082e-02 -8.71814875e-03]
 [ 1.27358687e-02  2.72612124e-02 -4.03853625e-02]
 [-1.99475557e-02  1.61075657e-02  5.65243520e-02]
 [ 2.79770074e-02 -4.80839422e-02  1.01496948e-01]
 [-6.65446367e-02 -1.31466624e-02 -9.65417446e-03]
 [ 9.06592420e-02  1.08967668e-02  1.75249146e-01]
 [-3.47543725e-02  5.12299057e-02 -2.41538370e-02]
 [-3.72152206e-02 -1.72222490e-02  2.43161850e-02]
 [ 9.26027698e-02  6.99617945e-03  9.74945035e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.78166127]
curr_Stock_Price:  99.34753265463104
curr_Factors:  [99.34753265 -1.17960776 -0.98076879]
mat_Sqrt:  [[11.45295285  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01617282 -0.01564846  0.00876196]
Stock Position:  0.016172820957149593
Bond Position:  [-4.38839113]


portfolio before change:  [-2.78883061]
curr_Stock_Price:  98.93815706490635
curr_Factors:  [98.93815706 -1.09753338 -0.99419348]
mat_Sqrt:  [[12.2162633   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02479219  0.0156906  -0.79361817]
Stock Position:  -0.024792187291893454
Bond Position:  [-0.33593729]


portfolio before change:  [-2.83001711]
curr_Stock_Price:  100.5977326346032
curr_Factors:  [100.59773263  -1.31043829  -1.01021843]
mat_Sqrt:  [[ 9.87960961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.41851890e-05  8.00936910e-03  1.06372312e-01]
Stock Position:  -3.418518896207552e-05
Bond Position:  [-2.82657816]


portfolio before change:  [-2.83035511]
curr_Stock_Price:  100.14873657509018
curr_Factors:  [100.14873658  -1.2764079   -0.98409129]
mat_Sqrt:  [[10.44535365  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00871234 -0.00292748  0.33017179]
Stock Position:  0.008712340486412683
Bond Position:  [-3.702885]


portfolio before change:  [-2.82752804]
curr_Stock_Price:  100.52635696103532
curr_Factors:  [100.52635696  -1.3619719   -0.99281851]
mat_Sqrt:  [[ 9.54129807  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00810059 -0.02891184 -0.26113353]
Stock Position:  0.008100592064922266
Bond Position:  [-3.64185105]


portfolio before change:  [-2.83342517]
curr_Stock_Price:  99.85457024349806
curr_Factors:  [99.85457024 -1.39519819 -0.95716804]
mat_Sqrt:  [[ 9.50053961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00853326 -0.0502005   0.390715  ]
Stock Position:  -0.008533257648190103
Bond Position:  [-1.98134039]


portfolio before change:  [-2.83741306]
curr_Stock_Price:  100.29288022697204
curr_Factors:  [100.29288023  -1.36964962  -0.96013304]
mat_Sqrt:  [[ 9.76019177  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00824768 -0.05370913  0.14106787]
Stock Position:  -0.008247678109340597
Bond Position:  [-2.01022967]


portfolio before change:  [-2.83440112]
curr_Stock_Price:  99.89722535293551
curr_Factors:  [99.89722535 -1.44813257 -0.92477893]
mat_Sqrt:  [[ 9.31131576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02089091 0.24487863 0.33942982]
Stock Position:  0.020890909812653683
Bond Position:  [-4.92134505]


portfolio before change:  [-2.82538263]
curr_Stock_Price:  100.35836870282046
curr_Factors:  [100.3583687  -1.3239237  -0.9078145]
mat_Sqrt:  [[10.77263658  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01248629 0.00716529 0.316985  ]
Stock Position:  0.012486287099989129
Bond Position:  [-4.07848603]


portfolio before change:  [-2.82143947]
curr_Stock_Price:  100.71499992214633
curr_Factors:  [100.71499992  -1.5519245   -0.89601167]
mat_Sqrt:  [[ 8.70901401  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05309562 0.04880368 0.72485388]
Stock Position:  0.053095616730871875
Bond Position:  [-8.1689645]


portfolio before change:  [-2.79575191]
curr_Stock_Price:  101.21803091199888
curr_Factors:  [101.21803091  -1.5231444   -0.91544278]
mat_Sqrt:  [[ 8.8347228   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02969935 -0.08436095  0.01391791]
Stock Position:  -0.029699351998025474
Bond Position:  [0.21035802]


portfolio before change:  [-2.77100502]
curr_Stock_Price:  100.38566926059013
curr_Factors:  [100.38566926  -1.39791127  -0.89348395]
mat_Sqrt:  [[10.15152811  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00776262 -0.00375525  0.3458608 ]
Stock Position:  0.007762618782795541
Bond Position:  [-3.5502607]


portfolio before change:  [-2.76843351]
curr_Stock_Price:  100.77410948733328
curr_Factors:  [100.77410949  -1.35427664  -0.91193621]
mat_Sqrt:  [[10.45069643  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00150944 -0.01272331  0.16470949]
Stock Position:  0.0015094387765650372
Bond Position:  [-2.92054586]


portfolio before change:  [-2.76827297]
curr_Stock_Price:  101.12233740935153
curr_Factors:  [101.12233741  -1.48435345  -0.91571985]
mat_Sqrt:  [[ 9.17293907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00116943 -0.00549585  0.12760214]
Stock Position:  0.0011694300732346084
Bond Position:  [-2.88652848]


portfolio before change:  [-2.76840527]
curr_Stock_Price:  101.31776969629679
curr_Factors:  [101.3177697   -1.39613577  -0.9198563 ]
mat_Sqrt:  [[ 9.99684696  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00719381 -0.05052549 -0.31517817]
Stock Position:  0.007193806828758006
Bond Position:  [-3.49726573]


portfolio before change:  [-2.76694994]
curr_Stock_Price:  101.58084491665221
curr_Factors:  [101.58084492  -1.431751    -0.94147546]
mat_Sqrt:  [[ 9.46526257  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0048331  -0.01525857  0.23260019]
Stock Position:  -0.004833095496609538
Bond Position:  [-2.27600002]


portfolio before change:  [-2.76638308]
curr_Stock_Price:  101.4046896363682
curr_Factors:  [101.40468964  -1.41376929  -0.92301986]
mat_Sqrt:  [[ 9.79948842  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00530817 0.00835453 0.00371044]
Stock Position:  0.005308167137460756
Bond Position:  [-3.30465613]


portfolio before change:  [-2.76752444]
curr_Stock_Price:  101.26749644908347
curr_Factors:  [101.26749645  -1.52787782  -0.90696058]
mat_Sqrt:  [[ 8.87223822  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00352679 -0.01524767  0.1738822 ]
Stock Position:  -0.0035267910673955636
Bond Position:  [-2.41037513]


portfolio before change:  [-2.77053043]
curr_Stock_Price:  102.03439122735575
curr_Factors:  [102.03439123  -1.52790816  -0.88247906]
mat_Sqrt:  [[ 9.16070098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00793691 -0.02570133 -0.16344071]
Stock Position:  0.007936914315693072
Bond Position:  [-3.58036865]


portfolio before change:  [-2.76949247]
curr_Stock_Price:  102.22155904565241
curr_Factors:  [102.22155905  -1.67621088  -0.86412481]
mat_Sqrt:  [[ 8.05914055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01103317 -0.00408301  0.5267226 ]
Stock Position:  0.011033166387515673
Bond Position:  [-3.89731994]


portfolio before change:  [-2.7675798]
curr_Stock_Price:  102.43907261273736
curr_Factors:  [102.43907261  -1.61414037  -0.85269384]
mat_Sqrt:  [[ 8.69226892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149546  0.11022085 -0.92413151]
Stock Position:  -0.001495461939313511
Bond Position:  [-2.61438607]


portfolio before change:  [-2.76754199]
curr_Stock_Price:  102.1952461953784
curr_Factors:  [102.1952462   -1.62786147  -0.86675143]
mat_Sqrt:  [[ 8.43400927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02336056 0.03534981 0.27718349]
Stock Position:  0.023360555651113335
Bond Position:  [-5.15487972]


portfolio before change:  [-2.77713313]
curr_Stock_Price:  101.81226107890167
curr_Factors:  [101.81226108  -1.40909534  -0.87110173]
mat_Sqrt:  [[10.41173437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047412  0.01734321  0.04727765]
Stock Position:  -0.00047412466820730023
Bond Position:  [-2.72886143]


portfolio before change:  [-2.77764981]
curr_Stock_Price:  102.1825222013285
curr_Factors:  [102.1825222   -1.36293867  -0.85968017]
mat_Sqrt:  [[11.068927    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.40923275e-04 -5.81808104e-02 -8.32115572e-01]
Stock Position:  0.0002409232751515582
Bond Position:  [-2.80226796]


portfolio before change:  [-2.77787314]
curr_Stock_Price:  102.709558230816
curr_Factors:  [102.70955823  -1.31589647  -0.84910613]
mat_Sqrt:  [[11.78588452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00501473  0.00716869 -0.04050577]
Stock Position:  0.005014731782037265
Bond Position:  [-3.29293403]


portfolio before change:  [-2.78138605]
curr_Stock_Price:  102.09112629290979
curr_Factors:  [102.09112629  -0.98897855  -0.82246307]
mat_Sqrt:  [[16.6835664   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00134866  0.00229653  0.29029544]
Stock Position:  -0.0013486638195330575
Bond Position:  [-2.64369945]


portfolio before change:  [-2.77858946]
curr_Stock_Price:  99.77247651387874
curr_Factors:  [99.77247651 -0.93437003 -0.80406032]
mat_Sqrt:  [[17.53961464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098701 -0.0104687   0.00627797]
Stock Position:  -0.0009870134224352557
Bond Position:  [-2.68011268]


portfolio before change:  [-2.7795179]
curr_Stock_Price:  100.37369253923814
curr_Factors:  [100.37369254  -1.12936741  -0.83956498]
mat_Sqrt:  [[14.01275174  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099521 -0.01444138 -0.43372074]
Stock Position:  0.0009952113126857475
Bond Position:  [-2.87941094]


portfolio before change:  [-2.7799506]
curr_Stock_Price:  100.3005968023047
curr_Factors:  [100.3005968   -1.10152745  -0.83739342]
mat_Sqrt:  [[14.42915456  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00410402 -0.01236681  0.03033924]
Stock Position:  -0.004104018198761501
Bond Position:  [-2.36831512]


portfolio before change:  [-2.78224684]
curr_Stock_Price:  100.78796985863164
curr_Factors:  [100.78796986  -0.9734143   -0.8311799 ]
mat_Sqrt:  [[16.58377495  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00381546 -0.00121384  0.08022004]
Stock Position:  -0.0038154624130991824
Bond Position:  [-2.39769413]


portfolio before change:  [-2.78282412]
curr_Stock_Price:  100.86071243106728
curr_Factors:  [100.86071243  -1.00620994  -0.80421175]
mat_Sqrt:  [[16.49931376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0022164  -0.01357607 -0.02487045]
Stock Position:  -0.00221640489029815
Bond Position:  [-2.55927594]


portfolio before change:  [-2.78071117]
curr_Stock_Price:  99.76304390269907
curr_Factors:  [99.7630439  -1.21277783 -0.8121048 ]
mat_Sqrt:  [[13.16965324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00076364  0.00879852 -0.1152082 ]
Stock Position:  0.0007636429434804407
Bond Position:  [-2.85689451]


portfolio before change:  [-2.78088346]
curr_Stock_Price:  100.00510170010608
curr_Factors:  [100.0051017   -1.21429554  -0.81730406]
mat_Sqrt:  [[13.11322936  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039057  0.00519869  0.16124824]
Stock Position:  -0.00039056951249130423
Bond Position:  [-2.74182451]


portfolio before change:  [-2.78091387]
curr_Stock_Price:  99.20540165684608
curr_Factors:  [99.20540166 -1.18839439 -0.8388362 ]
mat_Sqrt:  [[13.06532634  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00297581 -0.01551903  0.28954254]
Stock Position:  0.0029758071467925707
Bond Position:  [-3.07613001]


portfolio before change:  [-2.78055125]
curr_Stock_Price:  99.45648042381589
curr_Factors:  [99.45648042 -1.14071162 -0.86872706]
mat_Sqrt:  [[13.33352425  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00533984 -0.00424307 -0.02754067]
Stock Position:  -0.005339836393041292
Bond Position:  [-2.24946991]


portfolio before change:  [-2.78762538]
curr_Stock_Price:  100.72860394087671
curr_Factors:  [100.72860394  -0.92106727  -0.8504858 ]
mat_Sqrt:  [[17.13077818  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00751023 0.00351692 0.49993703]
Stock Position:  0.0075102319337188115
Bond Position:  [-3.54412056]


portfolio before change:  [-2.79066891]
curr_Stock_Price:  100.38234514713615
curr_Factors:  [100.38234515  -1.0182305   -0.84355753]
mat_Sqrt:  [[15.59886755  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00187369  0.01653438 -0.06890417]
Stock Position:  -0.0018736932698288395
Bond Position:  [-2.60258318]


portfolio before change:  [-2.7915101]
curr_Stock_Price:  100.65765571812663
curr_Factors:  [100.65765572  -1.22459414  -0.86600201]
mat_Sqrt:  [[12.44263725  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00287457 -0.00555846  0.06936731]
Stock Position:  -0.0028745655956684954
Bond Position:  [-2.50216306]


portfolio before change:  [-2.79273712]
curr_Stock_Price:  100.97569825966946
curr_Factors:  [100.97569826  -1.38072339  -0.82790948]
mat_Sqrt:  [[11.09225382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0102713  0.00225801 0.27812468]
Stock Position:  0.010271297704347012
Bond Position:  [-3.82988858]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.79983354]
Stock Price:  100.33141240892874
PL:  [-3.13124595]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.28475106e-02 -7.58083905e-02  1.07916805e-02]
 [-1.36137821e-01  6.86347745e-02 -1.48346131e-01]
 [-3.52718867e-02  4.33600787e-02  2.15021579e-02]
 [ 7.81139838e-02  8.38275395e-03  1.16802196e-01]
 [ 9.06131151e-02 -4.39588196e-02 -8.32142520e-02]
 [-7.99913080e-02 -1.56029860e-01  1.34588549e-01]
 [-6.04759692e-02 -1.82741911e-01  1.01199117e-01]
 [ 1.98700412e-02  7.50017881e-01  1.09273893e-01]
 [ 9.76934159e-02  2.26836329e-02  9.40547564e-02]
 [ 3.47507459e-01  1.30338476e-01  2.02859414e-01]
 [-2.12500801e-01 -2.45801524e-01  1.65595670e-02]
 [-5.35278696e-03 -1.62113625e-02  1.00127441e-01]
 [ 6.28223730e-03 -2.41418309e-02  8.26947225e-02]
 [ 7.10638830e-03 -5.05520723e-02  1.65116658e-02]
 [ 1.02848789e-01 -1.35136932e-01 -1.00051488e-01]
 [-3.47194494e-02 -4.21812547e-02  7.73777302e-02]
 [ 4.60746266e-02  2.65915005e-02  3.60114735e-03]
 [-4.66732282e-02 -5.64442020e-02  3.22848760e-02]
 [ 7.17192014e-02 -3.54555733e-02 -9.65817050e-02]
 [ 3.80134890e-02 -7.06375132e-03  1.09462007e-01]
 [-2.06220092e-02  3.74442990e-01 -3.37709131e-01]
 [ 1.71725519e-01  1.17610721e-01  9.44136380e-02]
 [-1.05234018e-02  9.20106504e-03  4.36865774e-02]
 [ 1.21039898e-01 -1.88882255e-01 -3.29760728e-01]
 [ 6.44032951e-02  3.39096295e-02 -1.50253215e-02]
 [-5.18988356e-02  2.08106578e-03  1.32086637e-01]
 [ 1.01669882e-02 -3.29735840e-02  4.53755245e-03]
 [ 1.72675115e-02 -1.98476601e-02 -1.90441809e-01]
 [-4.92257592e-02 -4.15527029e-02  2.08169617e-02]
 [-7.34975710e-02 -8.34732994e-05  2.78863510e-02]
 [-2.64105321e-02 -4.19230710e-02 -8.11225391e-03]
 [ 1.61800040e-02  7.85694784e-02 -6.80872443e-02]
 [-4.05981484e-02  2.26610476e-02 -1.12820196e-01]
 [ 3.00643333e-02 -4.54452782e-02  1.14608714e-01]
 [-6.65239846e-02  1.27560593e-02 -1.87737350e-02]
 [-1.13104898e-03 -7.08230212e-02  2.76265792e-02]
 [-2.62655606e-02  1.00923570e-01  7.67294767e-02]
 [ 1.69148323e-01 -1.20604979e-01 -1.65266285e-01]
 [ 9.84781910e-02  3.35620767e-03  6.27131776e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.35751069]
curr_Stock_Price:  99.86936818406346
curr_Factors:  [99.86936818 -1.04406568 -0.96743148]
mat_Sqrt:  [[13.36134511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.17310657e-05 -2.44670528e-02  3.07856607e-02]
Stock Position:  -3.1731065724993995e-05
Bond Position:  [1.36067965]


portfolio before change:  [1.35767055]
curr_Stock_Price:  100.191966126772
curr_Factors:  [100.19196613  -1.00011269  -0.97111621]
mat_Sqrt:  [[13.95529649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01092122  0.02215178 -0.42319022]
Stock Position:  -0.010921217906233675
Bond Position:  [2.45188885]


portfolio before change:  [1.36041071]
curr_Stock_Price:  99.96912925418165
curr_Factors:  [99.96912925 -1.08914909 -1.01526354]
mat_Sqrt:  [[12.1879627   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180768  0.01399441  0.06133967]
Stock Position:  -0.0018076801345217426
Bond Position:  [1.54112292]


portfolio before change:  [1.35993712]
curr_Stock_Price:  100.33768785754968
curr_Factors:  [100.33768786  -1.08016863  -1.02467524]
mat_Sqrt:  [[12.22762214  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00847812 0.00270552 0.33320415]
Stock Position:  0.00847812056782958
Bond Position:  [0.50926211]


portfolio before change:  [1.36100509]
curr_Stock_Price:  100.45614599720595
curr_Factors:  [100.456146    -1.08776773  -1.04422912]
mat_Sqrt:  [[11.91412207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00542667 -0.01418765 -0.2373871 ]
Stock Position:  0.005426670993088769
Bond Position:  [0.81586263]


portfolio before change:  [1.35766699]
curr_Stock_Price:  99.82222355521976
curr_Factors:  [99.82222356 -1.00822923 -1.01110779]
mat_Sqrt:  [[13.25074556  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00636704 -0.05035842  0.38394367]
Stock Position:  -0.006367037755335062
Bond Position:  [1.99323885]


portfolio before change:  [1.35904527]
curr_Stock_Price:  99.64488715416755
curr_Factors:  [99.64488715 -1.32702474 -0.98715322]
mat_Sqrt:  [[ 9.84963872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00782981 -0.0589797   0.28869291]
Stock Position:  -0.007829812295967914
Bond Position:  [2.13924603]


portfolio before change:  [1.36311012]
curr_Stock_Price:  99.15989075997209
curr_Factors:  [99.15989076 -1.32325693 -0.95209181]
mat_Sqrt:  [[10.18977605  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01916355 0.24206723 0.311728  ]
Stock Position:  0.019163545811956496
Bond Position:  [-0.53714499]


portfolio before change:  [1.37827493]
curr_Stock_Price:  99.95473126900674
curr_Factors:  [99.95473127 -1.28861634 -0.94909015]
mat_Sqrt:  [[10.66546454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01139402 0.00732111 0.26831204]
Stock Position:  0.011394022208025451
Bond Position:  [0.23938851]


portfolio before change:  [1.37471985]
curr_Stock_Price:  99.64009175633056
curr_Factors:  [99.64009176 -1.11634328 -0.9503121 ]
mat_Sqrt:  [[12.61528576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03293791 0.04206656 0.57870144]
Stock Position:  0.03293791363900602
Bond Position:  [-1.90721689]


portfolio before change:  [1.39989425]
curr_Stock_Price:  100.41162875214573
curr_Factors:  [100.41162875  -1.24420773  -0.94268897]
mat_Sqrt:  [[11.27267132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02300206 -0.0793321   0.04723984]
Stock Position:  -0.023002056186060018
Bond Position:  [3.70956818]


portfolio before change:  [1.39516572]
curr_Stock_Price:  100.63735868440317
curr_Factors:  [100.63735868  -1.10999529  -0.97834024]
mat_Sqrt:  [[12.4682824   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094452 -0.00523219  0.28563572]
Stock Position:  0.0009445174853354529
Bond Position:  [1.30011198]


portfolio before change:  [1.39442319]
curr_Stock_Price:  99.67913951519627
curr_Factors:  [99.67913952 -1.15399965 -0.96091078]
mat_Sqrt:  [[12.02569954  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00151628 -0.00779174  0.23590503]
Stock Position:  0.0015162773866698926
Bond Position:  [1.24328197]


portfolio before change:  [1.39640611]
curr_Stock_Price:  100.88439427000576
curr_Factors:  [100.88439427  -1.39340797  -0.91274432]
mat_Sqrt:  [[10.05251614  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.57094428e-05 -1.63156112e-02  4.71031866e-02]
Stock Position:  1.5709442752260884e-05
Bond Position:  [1.39482128]


portfolio before change:  [1.39658136]
curr_Stock_Price:  100.94046995646578
curr_Factors:  [100.94046996  -1.53405853  -0.86429537]
mat_Sqrt:  [[ 9.17219877  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00597906 -0.04361526 -0.28541905]
Stock Position:  0.005979062939927959
Bond Position:  [0.79305194]


portfolio before change:  [1.39916906]
curr_Stock_Price:  101.35668357904294
curr_Factors:  [101.35668358  -1.44878184  -0.86734871]
mat_Sqrt:  [[ 9.99930183  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00275369 -0.01361394  0.22073713]
Stock Position:  -0.0027536921492217143
Bond Position:  [1.67827417]


portfolio before change:  [1.40200166]
curr_Stock_Price:  100.40421791812398
curr_Factors:  [100.40421792  -1.26944082  -0.86380521]
mat_Sqrt:  [[11.89309741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00439227 0.00858237 0.01027307]
Stock Position:  0.004392268326062741
Bond Position:  [0.96099939]


portfolio before change:  [1.40125006]
curr_Stock_Price:  100.20574940680359
curr_Factors:  [100.20574941  -1.31612376  -0.85636193]
mat_Sqrt:  [[11.41284958  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00452163 -0.01821729  0.09209976]
Stock Position:  -0.0045216341140613
Bond Position:  [1.8543438]


portfolio before change:  [1.39981103]
curr_Stock_Price:  100.57527100072099
curr_Factors:  [100.575271    -1.31033642  -0.84385538]
mat_Sqrt:  [[11.66641981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00383727 -0.01144324 -0.27552072]
Stock Position:  0.0038372701797862664
Bond Position:  [1.01387654]


portfolio before change:  [1.39878762]
curr_Stock_Price:  100.27553970599084
curr_Factors:  [100.27553971  -1.39954451  -0.84446497]
mat_Sqrt:  [[10.63246773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00554109 -0.00227982  0.31226464]
Stock Position:  0.005541088573262908
Bond Position:  [0.84315197]


portfolio before change:  [1.39698148]
curr_Stock_Price:  99.9305643314636
curr_Factors:  [99.93056433 -1.42110026 -0.82975148]
mat_Sqrt:  [[10.52363674  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124707  0.12085096 -0.96339015]
Stock Position:  -0.001247072850459875
Bond Position:  [1.52160218]


portfolio before change:  [1.39598217]
curr_Stock_Price:  100.88441793453406
curr_Factors:  [100.88441793  -1.36302721  -0.82644613]
mat_Sqrt:  [[11.29660403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01903269 0.0379587  0.26933583]
Stock Position:  0.0190326942210169
Bond Position:  [-0.52412011]


portfolio before change:  [1.3851446]
curr_Stock_Price:  100.3184418336196
curr_Factors:  [100.31844183  -1.52670702  -0.80137688]
mat_Sqrt:  [[ 9.77927791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.78387663e-05 2.96963097e-03 1.24625645e-01]
Stock Position:  2.7838766338668132e-05
Bond Position:  [1.38235186]


portfolio before change:  [1.38533575]
curr_Stock_Price:  100.97746066913771
curr_Factors:  [100.97746067  -1.45275081  -0.82071396]
mat_Sqrt:  [[10.39611903  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00145942 -0.06096149 -0.94071557]
Stock Position:  0.0014594237321714962
Bond Position:  [1.23796685]


portfolio before change:  [1.38690579]
curr_Stock_Price:  101.94721382042752
curr_Factors:  [101.94721382  -1.25135971  -0.8236533 ]
mat_Sqrt:  [[12.79996144  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00533268  0.01094429 -0.04286306]
Stock Position:  0.005332675306587412
Bond Position:  [0.8432544]


portfolio before change:  [1.38151077]
curr_Stock_Price:  100.91575639354184
curr_Factors:  [100.91575639  -1.1927209   -0.83405801]
mat_Sqrt:  [[13.29658399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184348  0.00067166  0.37680641]
Stock Position:  -0.0018434785988502953
Bond Position:  [1.56754681]


portfolio before change:  [1.38209565]
curr_Stock_Price:  100.70478754692591
curr_Factors:  [100.70478755  -1.34271237  -0.84739564]
mat_Sqrt:  [[11.26933509  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00038711 -0.01064218  0.01294437]
Stock Position:  0.00038711313111892455
Bond Position:  [1.3431115]


portfolio before change:  [1.38203246]
curr_Stock_Price:  100.10783511317722
curr_Factors:  [100.10783511  -1.14577943  -0.84206622]
mat_Sqrt:  [[13.71379572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00187094 -0.0064058  -0.54327747]
Stock Position:  -0.001870936917098943
Bond Position:  [1.5693279]


portfolio before change:  [1.38259042]
curr_Stock_Price:  99.9144646122662
curr_Factors:  [99.91446461 -0.99706149 -0.82846063]
mat_Sqrt:  [[16.09956648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332049 -0.01341108  0.059385  ]
Stock Position:  -0.003320488453591888
Bond Position:  [1.71435525]


portfolio before change:  [1.38163324]
curr_Stock_Price:  100.26727086799436
curr_Factors:  [100.26727087  -0.99355077  -0.87001175]
mat_Sqrt:  [[15.55336172  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.36062207e-03 -2.69408915e-05  7.95519973e-02]
Stock Position:  -0.0043606220672142435
Bond Position:  [1.81886091]


portfolio before change:  [1.37756819]
curr_Stock_Price:  101.25162968833364
curr_Factors:  [101.25162969  -0.98371452  -0.86530681]
mat_Sqrt:  [[15.93610792  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00229817 -0.01353061 -0.023142  ]
Stock Position:  -0.002298174071311488
Bond Position:  [1.61026206]


portfolio before change:  [1.38328429]
curr_Stock_Price:  98.85198348819286
curr_Factors:  [98.85198349 -0.87025241 -0.85024589]
mat_Sqrt:  [[17.69222571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00103547  0.02535819 -0.19423396]
Stock Position:  0.001035465033644463
Bond Position:  [1.28092652]


portfolio before change:  [1.38357105]
curr_Stock_Price:  98.97427515107361
curr_Factors:  [98.97427515 -0.84568243 -0.88559062]
mat_Sqrt:  [[17.5242725   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00336686  0.00731382 -0.32184462]
Stock Position:  -0.00336686202028268
Bond Position:  [1.71680378]


portfolio before change:  [1.38441028]
curr_Stock_Price:  98.7887555783987
curr_Factors:  [98.78875558 -0.97195714 -0.87954729]
mat_Sqrt:  [[15.50991289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00284865 -0.0146674   0.32694676]
Stock Position:  0.0028486465922578914
Bond Position:  [1.10299603]


portfolio before change:  [1.38426232]
curr_Stock_Price:  98.68841090037515
curr_Factors:  [98.6884109  -0.99879401 -0.88082192]
mat_Sqrt:  [[15.0646599   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00449744  0.004117   -0.05355624]
Stock Position:  -0.004497435586734302
Bond Position:  [1.82810709]


portfolio before change:  [1.38798938]
curr_Stock_Price:  97.91051627816599
curr_Factors:  [97.91051628 -0.75283058 -0.87961975]
mat_Sqrt:  [[19.13661733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051987 -0.02285803  0.07881094]
Stock Position:  -0.0005198664736594165
Bond Position:  [1.43888977]


portfolio before change:  [1.38822664]
curr_Stock_Price:  97.80012341380484
curr_Factors:  [97.80012341 -0.59126788 -0.90215549]
mat_Sqrt:  [[21.96614634  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00045514 0.03257294 0.21888784]
Stock Position:  0.0004551419948924239
Bond Position:  [1.3437137]


portfolio before change:  [1.38734876]
curr_Stock_Price:  95.50226794602662
curr_Factors:  [95.50226795 -0.64032978 -0.89086131]
mat_Sqrt:  [[20.65503067  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00536407 -0.03892509 -0.47145871]
Stock Position:  0.005364073141057918
Bond Position:  [0.87506761]


portfolio before change:  [1.39637144]
curr_Stock_Price:  97.16393245434006
curr_Factors:  [97.16393245 -0.53803898 -0.91378006]
mat_Sqrt:  [[22.75035018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00492144 0.00108321 0.17890324]
Stock Position:  0.0049214428297802825
Bond Position:  [0.9181847]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.39834001]
Stock Price:  97.54060808880547
PL:  [1.39834001]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-4.12381866e-01 -1.19420025e-01  3.06721714e-02]
 [-5.97348308e-02  6.44298494e-02 -1.70852374e-02]
 [ 1.63240855e-02 -6.23516725e-03  5.80277323e-02]
 [-3.37120835e-01 -1.61888583e-01 -1.90020492e-01]
 [ 1.87536561e-01 -1.94911230e-01 -1.04667088e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.27249353e-02 -1.52712815e-01 -2.70213227e-02]
 [ 1.14745544e-02  7.39613318e-01  1.23771987e-01]
 [ 1.16818443e-01  1.88430552e-02  1.21764494e-01]
 [ 3.74580048e-01  1.46514664e-01  2.41487048e-01]
 [-1.92194431e-01 -1.89680757e-01  4.83413330e-02]
 [ 2.26583969e-02 -1.37274832e-02  1.11955984e-01]
 [ 1.20474355e-02 -5.88462687e-02  9.40260595e-02]
 [ 1.28449903e-02 -1.31692651e-01 -9.84701450e-02]
 [ 1.47774372e-02 -1.33120791e-02 -6.79401002e-02]
 [ 9.51386286e-02 -5.32549749e-03 -1.73409774e-03]
 [ 4.71983260e-02  2.45747386e-02 -2.97110706e-03]
 [-5.50416189e-02 -6.34972032e-02  7.50413661e-03]
 [ 5.10427020e-02  3.26748404e-02 -2.04883278e-01]
 [-9.08685745e-03  3.02687512e-03 -4.11068143e-02]
 [-3.37861285e-02  4.59216788e-01 -4.15444519e-01]
 [ 2.04783698e-01  1.33428948e-01  8.90303466e-02]
 [ 7.72954073e-04 -2.80219055e-02  6.64748745e-02]
 [ 5.19780563e-02 -4.62691103e-03 -1.42490585e-01]
 [ 2.34451474e-02  1.84930207e-02 -1.16841961e-02]
 [-7.64564121e-02 -1.17543063e-02  1.91740754e-01]
 [-1.69619579e-02 -3.24557279e-02  1.65831491e-03]
 [-7.04580437e-02  5.49708924e-02 -2.25474284e-01]
 [-3.28603276e-02 -4.17968868e-02  3.92612753e-02]
 [-2.15131045e-02  2.47786118e-02 -2.63095370e-02]
 [ 1.04323899e-02 -4.30324878e-02 -5.81355658e-02]
 [ 2.57787348e-02  6.90158399e-02 -4.76611550e-02]
 [-4.44609637e-03  1.76160404e-02  5.56903199e-02]
 [ 2.29800496e-02 -5.44831534e-02  6.92239188e-02]
 [-6.49815817e-02 -1.43684685e-02 -5.49380999e-03]
 [ 6.58587506e-02 -3.99938578e-02  1.02589065e-01]
 [-1.81181299e-02  5.45196479e-02  3.55452883e-03]
 [-3.37808769e-02 -2.82736456e-02  1.58838172e-02]
 [ 9.40760731e-02  6.08343084e-03  8.87728406e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.13685381]
curr_Stock_Price:  101.98478099765008
curr_Factors:  [101.984781    -1.10595974  -1.01167128]
mat_Sqrt:  [[12.27043338  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03508413 -0.03854265  0.08749917]
Stock Position:  -0.03508412718223617
Bond Position:  [21.71490083]


portfolio before change:  [18.16185588]
curr_Stock_Price:  101.34952097628978
curr_Factors:  [101.34952098  -1.04031312  -1.0043223 ]
mat_Sqrt:  [[13.11740172  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00381712  0.02079464 -0.04873943]
Stock Position:  -0.0038171166345790093
Bond Position:  [18.54871883]


portfolio before change:  [18.16381915]
curr_Stock_Price:  101.44264565283882
curr_Factors:  [101.44264565  -1.16486673  -0.98591854]
mat_Sqrt:  [[11.80718564  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227795 -0.00201239  0.16553697]
Stock Position:  0.0022779516922622448
Bond Position:  [17.9327377]


portfolio before change:  [18.16671044]
curr_Stock_Price:  101.72779431234932
curr_Factors:  [101.72779431  -1.17245239  -0.98317893]
mat_Sqrt:  [[11.78313466  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03470672 -0.05224932 -0.54207557]
Stock Position:  -0.03470672159017074
Bond Position:  [21.69734867]


portfolio before change:  [18.17100297]
curr_Stock_Price:  101.6822644713244
curr_Factors:  [101.68226447  -1.13110395  -0.96599022]
mat_Sqrt:  [[12.48788193  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01012064 -0.06290733 -0.29858607]
Stock Position:  0.010120642880196453
Bond Position:  [17.14191308]


portfolio before change:  [18.1688112]
curr_Stock_Price:  101.25396800046879
curr_Factors:  [101.253968    -1.58398418  -0.98037092]
mat_Sqrt:  [[ 7.79339671  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01967104 -0.05534923  0.15513819]
Stock Position:  -0.019671037131666274
Bond Position:  [20.16058177]


portfolio before change:  [18.1795136]
curr_Stock_Price:  100.83801818372459
curr_Factors:  [100.83801818  -1.79809933  -0.96693124]
mat_Sqrt:  [[ 6.3501909   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01408037 -0.04928785 -0.07708431]
Stock Position:  -0.0140803660949849
Bond Position:  [19.59934981]


portfolio before change:  [18.18530745]
curr_Stock_Price:  100.6005398607513
curr_Factors:  [100.60053986  -1.55914554  -0.96927582]
mat_Sqrt:  [[ 8.02640127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02338686 0.23870917 0.35308703]
Stock Position:  0.023386862365571394
Bond Position:  [15.83257647]


portfolio before change:  [18.18333865]
curr_Stock_Price:  100.43172711922507
curr_Factors:  [100.43172712  -1.36816445  -0.9617478 ]
mat_Sqrt:  [[ 9.77243746  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01489084 0.00608157 0.34736021]
Stock Position:  0.01489084369914523
Bond Position:  [16.6878255]


portfolio before change:  [18.1886132]
curr_Stock_Price:  100.64584809355712
curr_Factors:  [100.64584809  -1.44706429  -0.97467628]
mat_Sqrt:  [[ 8.93402778  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05079238 0.0472874  0.68889533]
Stock Position:  0.050792383608109164
Bond Position:  [13.07657067]


portfolio before change:  [18.21871278]
curr_Stock_Price:  101.20626488758424
curr_Factors:  [101.20626489  -1.27442377  -1.0074348 ]
mat_Sqrt:  [[10.33258087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02139303 -0.0612192   0.13790437]
Stock Position:  -0.021393030707680078
Bond Position:  [20.38382151]


portfolio before change:  [18.21672631]
curr_Stock_Price:  101.4182314662902
curr_Factors:  [101.41823147  -1.24892323  -1.03451143]
mat_Sqrt:  [[10.33791508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00413132 -0.00443053  0.31937926]
Stock Position:  0.004131317127823243
Bond Position:  [17.79773543]


portfolio before change:  [18.21728377]
curr_Stock_Price:  101.01463411189216
curr_Factors:  [101.01463411  -0.98798403  -1.0316341 ]
mat_Sqrt:  [[13.40526129  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0014344  -0.01899255  0.26823018]
Stock Position:  0.001434398015469335
Bond Position:  [18.07238858]


portfolio before change:  [18.21865284]
curr_Stock_Price:  100.39407838109628
curr_Factors:  [100.39407838  -1.15140796  -1.02133163]
mat_Sqrt:  [[11.43139642  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00298623 -0.04250362 -0.28090791]
Stock Position:  -0.002986231292767575
Bond Position:  [18.51845278]


portfolio before change:  [18.22275683]
curr_Stock_Price:  99.7949821225216
curr_Factors:  [99.79498212 -1.12068319 -1.01773645]
mat_Sqrt:  [[11.75993314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.53750405e-04 -4.29645505e-03 -1.93814195e-01]
Stock Position:  -0.000153750405156039
Bond Position:  [18.23810035]


portfolio before change:  [18.2250314]
curr_Stock_Price:  99.829682353405
curr_Factors:  [99.82968235 -1.07250919 -1.05083057]
mat_Sqrt:  [[11.94276669  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00784555 -0.0017188  -0.0049469 ]
Stock Position:  0.007845551801249429
Bond Position:  [17.44181246]


portfolio before change:  [18.22067231]
curr_Stock_Price:  98.99615808300545
curr_Factors:  [98.99615808 -0.89527085 -1.08540208]
mat_Sqrt:  [[13.65912927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00377829  0.00793146 -0.00847574]
Stock Position:  0.0037782898021111854
Bond Position:  [17.84663613]


portfolio before change:  [18.22481536]
curr_Stock_Price:  99.50222864750663
curr_Factors:  [99.50222865 -1.13724983 -1.08246828]
mat_Sqrt:  [[10.80989508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0061491  -0.02049363  0.02140721]
Stock Position:  -0.006149102769056984
Bond Position:  [18.83666479]


portfolio before change:  [18.23040383]
curr_Stock_Price:  98.97633973035161
curr_Factors:  [98.97633973 -0.99248584 -1.07768381]
mat_Sqrt:  [[12.48728807  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00127256  0.01054576 -0.58447496]
Stock Position:  0.0012725582838250724
Bond Position:  [18.10445067]


portfolio before change:  [18.23218849]
curr_Stock_Price:  98.60029738552178
curr_Factors:  [98.60029739 -0.99778378 -1.0718616 ]
mat_Sqrt:  [[12.44636848  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013546   0.00097692 -0.1172663 ]
Stock Position:  -0.0013546033535112838
Bond Position:  [18.36575279]


portfolio before change:  [18.23495931]
curr_Stock_Price:  98.2496733951276
curr_Factors:  [98.2496734  -0.78734489 -1.07747492]
mat_Sqrt:  [[15.22124459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00163266  0.14821158 -1.18514758]
Stock Position:  -0.0016326622621352016
Bond Position:  [18.39536785]


portfolio before change:  [18.23748629]
curr_Stock_Price:  98.1103860480185
curr_Factors:  [98.11038605 -0.90631627 -1.08001567]
mat_Sqrt:  [[13.46052445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01858717 0.04306401 0.2539788 ]
Stock Position:  0.01858716664365845
Bond Position:  [16.41389219]


portfolio before change:  [18.24291953]
curr_Stock_Price:  98.29230629275553
curr_Factors:  [98.29230629 -0.96730465 -1.08361692]
mat_Sqrt:  [[12.64199479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00068202 -0.00904403  0.18963431]
Stock Position:  0.0006820231808228083
Bond Position:  [18.1758819]


portfolio before change:  [18.24463758]
curr_Stock_Price:  97.47989991901187
curr_Factors:  [97.47989992 -0.97526539 -1.10033029]
mat_Sqrt:  [[12.23193958  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017943  -0.00149333 -0.40648598]
Stock Position:  0.001794304412606366
Bond Position:  [18.06972897]


portfolio before change:  [18.24908986]
curr_Stock_Price:  98.70233623365004
curr_Factors:  [98.70233623 -1.15074024 -1.07336381]
mat_Sqrt:  [[10.67606766  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00232623  0.0059686  -0.03333176]
Stock Position:  0.002326230374675565
Bond Position:  [18.01948549]


portfolio before change:  [18.25166165]
curr_Stock_Price:  98.83956015691292
curr_Factors:  [98.83956016 -1.10987533 -1.07231791]
mat_Sqrt:  [[11.14849698  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00356253 -0.00379369  0.546983  ]
Stock Position:  -0.003562527980676969
Bond Position:  [18.60378035]


portfolio before change:  [18.25369999]
curr_Stock_Price:  98.92019984600873
curr_Factors:  [98.92019985 -1.15169019 -1.07219676]
mat_Sqrt:  [[10.70195585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217236 -0.01047504  0.00473071]
Stock Position:  -0.002172355579859274
Bond Position:  [18.46858984]


portfolio before change:  [18.25664168]
curr_Stock_Price:  98.62882107555214
curr_Factors:  [98.62882108 -1.03718787 -1.06014877]
mat_Sqrt:  [[12.10994341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00869219  0.01774178 -0.64321537]
Stock Position:  -0.008692187840215275
Bond Position:  [19.11394192]


portfolio before change:  [18.2568075]
curr_Stock_Price:  98.88463408597214
curr_Factors:  [98.88463409 -1.03508634 -1.0741323 ]
mat_Sqrt:  [[11.99794289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00278197 -0.01348989  0.11200149]
Stock Position:  -0.0027819691585079325
Bond Position:  [18.5319015]


portfolio before change:  [18.26201082]
curr_Stock_Price:  97.84699338407633
curr_Factors:  [97.84699338 -0.76748658 -1.05800213]
mat_Sqrt:  [[15.7669544   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138426  0.00799726 -0.07505379]
Stock Position:  -0.0013842624720883884
Bond Position:  [18.39745674]


portfolio before change:  [18.26320368]
curr_Stock_Price:  98.64667406112365
curr_Factors:  [98.64667406 -0.78536073 -1.05428675]
mat_Sqrt:  [[15.67233474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00065201 -0.01388868 -0.16584459]
Stock Position:  -0.0006520057633709927
Bond Position:  [18.32752188]


portfolio before change:  [18.26487711]
curr_Stock_Price:  99.5939879110528
curr_Factors:  [99.59398791 -0.78500982 -1.04173318]
mat_Sqrt:  [[16.02834628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00188028  0.02227477 -0.13596401]
Stock Position:  0.001880277668149142
Bond Position:  [18.07761275]


portfolio before change:  [18.26771464]
curr_Stock_Price:  99.90122615514747
curr_Factors:  [99.90122616 -0.89552197 -1.05616933]
mat_Sqrt:  [[14.18933551  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00074123 0.00568555 0.15886898]
Stock Position:  0.0007412258146461102
Bond Position:  [18.19366527]


portfolio before change:  [18.26985193]
curr_Stock_Price:  99.71631954491767
curr_Factors:  [99.71631954 -1.12238202 -1.05607964]
mat_Sqrt:  [[11.28943898  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00230206 -0.01758436  0.19747657]
Stock Position:  0.0023020626462247856
Bond Position:  [18.04029872]


portfolio before change:  [18.27163818]
curr_Stock_Price:  99.51261794337896
curr_Factors:  [99.51261794 -1.24366717 -1.0498999 ]
mat_Sqrt:  [[10.04140846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00687513 -0.0046374  -0.01567231]
Stock Position:  -0.006875126399720134
Bond Position:  [18.95580001]


portfolio before change:  [18.27664129]
curr_Stock_Price:  99.12957215131038
curr_Factors:  [99.12957215 -1.13464086 -1.05454142]
mat_Sqrt:  [[11.10333506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00708219 -0.01290796  0.29265805]
Stock Position:  0.007082191372936135
Bond Position:  [17.57458669]


portfolio before change:  [18.28480185]
curr_Stock_Price:  99.97162737461153
curr_Factors:  [99.97162737 -1.21665319 -1.05380608]
mat_Sqrt:  [[10.32354442  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060675  0.01759614  0.01014008]
Stock Position:  -0.0006067478289781574
Bond Position:  [18.34545941]


portfolio before change:  [18.28698673]
curr_Stock_Price:  100.1503475798514
curr_Factors:  [100.15034758  -1.50930049  -1.07406278]
mat_Sqrt:  [[ 7.56331256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0048008  -0.00912528  0.04531211]
Stock Position:  -0.004800798558055191
Bond Position:  [18.76778838]


portfolio before change:  [18.28679827]
curr_Stock_Price:  100.67829865371728
curr_Factors:  [100.67829865  -1.28039455  -1.10888443]
mat_Sqrt:  [[ 9.23177451  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01228784 0.00196342 0.2532442 ]
Stock Position:  0.012287835704684294
Bond Position:  [17.04967988]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.28607495]
Stock Price:  100.44598261135043
PL:  [17.84009234]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.35643453e-01 -9.46473824e-02  1.65890153e-02]
 [-1.25489286e-01  6.94162740e-02 -1.34470083e-01]
 [-1.00110738e-02  2.16371850e-02  3.94112798e-02]
 [ 8.21549386e-02  4.91973076e-04  1.23591752e-01]
 [ 6.91200878e-02 -1.55958352e-02 -8.02534830e-02]
 [-7.29984679e-02 -1.52614501e-01  1.52863341e-01]
 [-6.26814448e-02 -1.57231096e-01  5.99389410e-02]
 [ 1.83563049e-03  7.49355400e-01  1.14922991e-01]
 [ 1.58632132e-01 -4.67088150e-03  1.49433337e-01]
 [ 3.67938467e-01  1.38860783e-01  2.20116842e-01]
 [-2.36652396e-01 -2.76835086e-01  2.56129884e-03]
 [-3.10811976e-02 -1.77864588e-02  9.31595054e-02]
 [-1.95167057e-04 -4.72060185e-03  8.82025970e-02]
 [ 1.10484648e-02 -1.47990718e-01  4.71826935e-02]
 [ 2.83472529e-02 -3.99307670e-02 -7.25866545e-02]
 [ 7.62668644e-02 -1.06930815e-02  1.39427121e-02]
 [ 4.71351247e-02  2.46881693e-02 -2.60145746e-03]
 [-4.02309509e-02 -5.08762513e-02  5.22080962e-02]
 [ 7.67212953e-02 -4.25803941e-02 -8.98905707e-02]
 [ 4.09505436e-02 -9.56576651e-03  1.21609412e-01]
 [-2.09002988e-02  3.86321788e-01 -3.58941196e-01]
 [ 1.00428500e-01  8.34953377e-02  1.06023855e-01]
 [-2.32832358e-02  4.57263962e-02  2.12721381e-02]
 [ 1.28052042e-01 -1.93507280e-01 -3.40539792e-01]
 [ 7.24170108e-02  4.01321660e-02 -1.61854403e-02]
 [-1.53288559e-02  1.44336662e-02  5.39458461e-02]
 [ 2.96246272e-02 -3.33312311e-02  9.06117352e-03]
 [ 8.64052387e-02 -6.11014878e-02 -9.41871550e-02]
 [-4.90303223e-02 -3.10383859e-02 -1.27322610e-03]
 [-5.15192135e-02 -8.53703874e-03  2.24733862e-02]
 [-3.44256913e-02 -5.10685524e-02 -2.42797107e-02]
 [ 2.61774071e-02 -2.96230617e-02 -7.83177854e-02]
 [ 5.54769836e-02  7.77389353e-03  1.43043414e-01]
 [ 7.09815361e-03 -7.77989779e-02 -6.53013073e-02]
 [-1.22540028e-03  3.26504052e-02  4.51126376e-02]
 [ 4.84723244e-02  2.47190040e-02  1.42203781e-01]
 [ 2.94783818e-01 -1.96981733e-01  1.59902260e-01]
 [-9.10502210e-02  2.26858301e-02  4.09887331e-02]
 [ 1.30160341e-01  1.07902747e-03  1.10791771e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.24302383]
curr_Stock_Price:  100.35922432583087
curr_Factors:  [100.35922433  -1.05065087  -1.00786439]
mat_Sqrt:  [[12.81018734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01183254 -0.03054731  0.04732384]
Stock Position:  -0.011832539751290684
Bond Position:  [6.43052834]


portfolio before change:  [5.24238134]
curr_Stock_Price:  100.48145986674359
curr_Factors:  [100.48145987  -1.06463781  -0.99368712]
mat_Sqrt:  [[12.82823114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01081742  0.02240401 -0.38360572]
Stock Position:  -0.01081741808914279
Bond Position:  [6.3293313]


portfolio before change:  [5.24235725]
curr_Stock_Price:  100.55682986086693
curr_Factors:  [100.55682986  -1.13145652  -0.96955015]
mat_Sqrt:  [[12.30144058  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0001992  0.00698337 0.11242941]
Stock Position:  0.00019919552025695182
Bond Position:  [5.22232678]


portfolio before change:  [5.2429048]
curr_Stock_Price:  100.02832799950723
curr_Factors:  [100.028328    -1.31775117  -0.98122404]
mat_Sqrt:  [[10.03900713  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.07065790e-02 1.58783628e-04 3.52572866e-01]
Stock Position:  0.010706578987849866
Bond Position:  [4.17194361]


portfolio before change:  [5.24495428]
curr_Stock_Price:  100.1710396527212
curr_Factors:  [100.17103965  -1.07745396  -0.95110739]
mat_Sqrt:  [[13.17495632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0037613  -0.00503353 -0.22894085]
Stock Position:  0.003761297299337175
Bond Position:  [4.86818122]


portfolio before change:  [5.24227778]
curr_Stock_Price:  99.2976552554731
curr_Factors:  [99.29765526 -1.06797523 -0.94423907]
mat_Sqrt:  [[13.27533314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00549498 -0.04925612  0.43607656]
Stock Position:  -0.005494978767633683
Bond Position:  [5.78791629]


portfolio before change:  [5.24478612]
curr_Stock_Price:  98.97285011714163
curr_Factors:  [98.97285012 -1.14048822 -0.9460276 ]
mat_Sqrt:  [[12.28439494  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00671919 -0.05074612  0.17098911]
Stock Position:  -0.006719185042907652
Bond Position:  [5.90980301]


portfolio before change:  [5.247223]
curr_Stock_Price:  98.72012390778212
curr_Factors:  [98.72012391 -0.92599315 -0.92760422]
mat_Sqrt:  [[15.46673287  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0115251  0.24185342 0.3278433 ]
Stock Position:  0.011525104862988118
Bond Position:  [4.10946322]


portfolio before change:  [5.25536617]
curr_Stock_Price:  99.3821092974257
curr_Factors:  [99.3821093  -0.88412611 -0.91814271]
mat_Sqrt:  [[16.39052285  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01148113 -0.00150752  0.42629172]
Stock Position:  0.011481125189566751
Bond Position:  [4.11434773]


portfolio before change:  [5.25693283]
curr_Stock_Price:  99.47376710808562
curr_Factors:  [99.47376711 -0.93466099 -0.92301634]
mat_Sqrt:  [[15.52135204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02842629 0.04481713 0.62793208]
Stock Position:  0.028426290875104916
Bond Position:  [2.42926259]


portfolio before change:  [5.26161827]
curr_Stock_Price:  99.62791180484639
curr_Factors:  [99.6279118  -1.06797761 -0.9116689 ]
mat_Sqrt:  [[13.76041307  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02126668 -0.08934814  0.00730667]
Stock Position:  -0.021266679757713878
Bond Position:  [7.38037316]


portfolio before change:  [5.26277819]
curr_Stock_Price:  99.61675273791688
curr_Factors:  [99.61675274 -0.91504816 -0.92089227]
mat_Sqrt:  [[15.88523267  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098807 -0.00574055  0.26575814]
Stock Position:  -0.0009880710754981712
Bond Position:  [5.36120662]


portfolio before change:  [5.26376872]
curr_Stock_Price:  99.29254763251147
curr_Factors:  [99.29254763 -0.90634591 -0.93867698]
mat_Sqrt:  [[15.69037764  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107362 -0.00152357  0.25161746]
Stock Position:  0.0010736213133951474
Bond Position:  [5.15716612]


portfolio before change:  [5.26401899]
curr_Stock_Price:  98.92517668885597
curr_Factors:  [98.92517669 -0.78213699 -0.94597565]
mat_Sqrt:  [[17.5710231   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054231 -0.0477638   0.13459909]
Stock Position:  -0.000542306896919718
Bond Position:  [5.31766679]


portfolio before change:  [5.26412972]
curr_Stock_Price:  99.94677175422616
curr_Factors:  [99.94677175 -1.31279827 -0.92846573]
mat_Sqrt:  [[10.6267432   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00050624 -0.0128876  -0.20706952]
Stock Position:  0.0005062445124066284
Bond Position:  [5.21353221]


portfolio before change:  [5.26492119]
curr_Stock_Price:  100.22280347467351
curr_Factors:  [100.22280347  -1.29863069  -0.95785253]
mat_Sqrt:  [[10.4951424   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00733008 -0.00345118  0.03977468]
Stock Position:  0.007330076103783857
Bond Position:  [4.53028041]


portfolio before change:  [5.27138025]
curr_Stock_Price:  101.02671644323225
curr_Factors:  [101.02671644  -1.23296553  -0.96817884]
mat_Sqrt:  [[11.18127639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00461875  0.00796807 -0.00742123]
Stock Position:  0.004618753179591122
Bond Position:  [4.80476279]


portfolio before change:  [5.27008928]
curr_Stock_Price:  100.61716756189132
curr_Factors:  [100.61716756  -1.47027081  -0.94929343]
mat_Sqrt:  [[ 8.95094092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00446423 -0.01642024  0.14893517]
Stock Position:  -0.004464233375803758
Bond Position:  [5.7192678]


portfolio before change:  [5.26981191]
curr_Stock_Price:  100.83945133785981
curr_Factors:  [100.83945134  -1.4473834   -0.96172306]
mat_Sqrt:  [[ 9.06502136  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00548049 -0.01374276 -0.25643278]
Stock Position:  0.0054804915380361405
Bond Position:  [4.71716215]


portfolio before change:  [5.27023648]
curr_Stock_Price:  100.80932367880351
curr_Factors:  [100.80932368  -1.52600414  -0.96750685]
mat_Sqrt:  [[ 8.32880397  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00766273 -0.00308734  0.3469178 ]
Stock Position:  0.0076627277100011675
Bond Position:  [4.49776208]


portfolio before change:  [5.27321874]
curr_Stock_Price:  101.12513951031146
curr_Factors:  [101.12513951  -1.48854273  -1.01809615]
mat_Sqrt:  [[ 8.24593112  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185683  0.12468482 -1.02395932]
Stock Position:  -0.0018568259625946725
Bond Position:  [5.46099053]


portfolio before change:  [5.27308177]
curr_Stock_Price:  101.56656069163762
curr_Factors:  [101.56656069  -1.42977105  -1.05054896]
mat_Sqrt:  [[ 8.50278997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01636098 0.026948   0.30245655]
Stock Position:  0.016360976073188288
Bond Position:  [3.6113537]


portfolio before change:  [5.27632595]
curr_Stock_Price:  101.73725569478134
curr_Factors:  [101.73725569  -1.52037693  -1.07224719]
mat_Sqrt:  [[ 7.61233103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126206  0.01475813  0.06068349]
Stock Position:  -0.001262059837382003
Bond Position:  [5.40472446]


portfolio before change:  [5.27773989]
curr_Stock_Price:  101.15225367409282
curr_Factors:  [101.15225367  -1.79997729  -1.06100011]
mat_Sqrt:  [[ 5.787205    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00329004 -0.06245421 -0.97146524]
Stock Position:  0.003290040661644925
Bond Position:  [4.94494486]


portfolio before change:  [5.27805646]
curr_Stock_Price:  101.06058561754152
curr_Factors:  [101.06058562  -1.86809321  -1.09317059]
mat_Sqrt:  [[ 5.230236    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01478043  0.0129526  -0.04617256]
Stock Position:  0.014780425919817694
Bond Position:  [3.78433796]


portfolio before change:  [5.27687771]
curr_Stock_Price:  100.94882851506526
curr_Factors:  [100.94882852  -1.94053407  -1.07815856]
mat_Sqrt:  [[ 4.93287071  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027792  0.00465845  0.15389248]
Stock Position:  -0.00027792060422136545
Bond Position:  [5.30493347]


portfolio before change:  [5.27761079]
curr_Stock_Price:  100.6972296307028
curr_Factors:  [100.69722963  -1.74777179  -1.10246975]
mat_Sqrt:  [[ 5.82335613  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00423648 -0.01075761  0.02584901]
Stock Position:  0.004236478389531137
Bond Position:  [4.85100916]


portfolio before change:  [5.27986455]
curr_Stock_Price:  101.08607683052688
curr_Factors:  [101.08607683  -1.46894313  -1.12392442]
mat_Sqrt:  [[ 7.56176669  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0072347  -0.01972042 -0.26868974]
Stock Position:  0.0072346952071985285
Bond Position:  [4.54853759]


portfolio before change:  [5.2817974]
curr_Stock_Price:  101.2746471743108
curr_Factors:  [101.27464717  -1.18696484  -1.14531918]
mat_Sqrt:  [[ 9.83111236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00565815 -0.0100176  -0.00363216]
Stock Position:  -0.0056581493930883105
Bond Position:  [5.85482449]


portfolio before change:  [5.2808651]
curr_Stock_Price:  101.56877219299254
curr_Factors:  [101.56877219  -1.2377355   -1.16341924]
mat_Sqrt:  [[ 9.20347734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0052887  -0.00275532  0.06411032]
Stock Position:  -0.005288704112139976
Bond Position:  [5.81803228]


portfolio before change:  [5.27949544]
curr_Stock_Price:  101.96527031343159
curr_Factors:  [101.96527031  -1.00923669  -1.16108545]
mat_Sqrt:  [[11.63840188  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00427946 -0.0164823  -0.06926326]
Stock Position:  -0.00427946135612303
Bond Position:  [5.71585187]


portfolio before change:  [5.27589726]
curr_Stock_Price:  102.97303773160647
curr_Factors:  [102.97303773  -0.99763069  -1.1488154 ]
mat_Sqrt:  [[12.03743158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00034427 -0.0095608  -0.22341884]
Stock Position:  0.0003442656287267269
Bond Position:  [5.24044718]


portfolio before change:  [5.27650954]
curr_Stock_Price:  102.84865187957833
curr_Factors:  [102.84865188  -1.0025759   -1.15113764]
mat_Sqrt:  [[11.9358319   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00722718 0.00250901 0.40806305]
Stock Position:  0.007227182688498685
Bond Position:  [4.53320354]


portfolio before change:  [5.27627331]
curr_Stock_Price:  102.737556325199
curr_Factors:  [102.73755633  -1.11020863  -1.18785544]
mat_Sqrt:  [[10.32030871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214258 -0.02510951 -0.18628645]
Stock Position:  -0.002142578328737176
Bond Position:  [5.49639657]


portfolio before change:  [5.2768757]
curr_Stock_Price:  102.77709301607135
curr_Factors:  [102.77709302  -1.05286202  -1.2093983 ]
mat_Sqrt:  [[10.7006253   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00136888 0.01053787 0.1286938 ]
Stock Position:  0.0013688839614131663
Bond Position:  [5.13618578]


portfolio before change:  [5.27919703]
curr_Stock_Price:  104.0038391836773
curr_Factors:  [104.00383918  -1.05661025  -1.19795089]
mat_Sqrt:  [[10.91203896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00756461 0.00797802 0.40566781]
Stock Position:  0.0075646078197466405
Bond Position:  [4.49244878]


portfolio before change:  [5.27957986]
curr_Stock_Price:  103.9802079495728
curr_Factors:  [103.98020795  -1.25537415  -1.21403598]
mat_Sqrt:  [[ 8.80034073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0326368  -0.06357558  0.45615664]
Stock Position:  0.032636804734706946
Bond Position:  [1.88599812]


portfolio before change:  [5.28036828]
curr_Stock_Price:  103.99714140176825
curr_Factors:  [103.9971414   -1.34852902  -1.19278143]
mat_Sqrt:  [[ 8.19113904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00952892  0.00732182  0.11692945]
Stock Position:  -0.009528919590864469
Bond Position:  [6.27134868]


portfolio before change:  [5.28315202]
curr_Stock_Price:  103.78727774811574
curr_Factors:  [103.78727775  -1.2594949   -1.19021148]
mat_Sqrt:  [[ 8.95880652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01707771 0.00034825 0.31605808]
Stock Position:  0.01707770691735162
Bond Position:  [3.51070331]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.27647699]
Stock Price:  103.3707171230293
PL:  [1.90575986]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 6.81443233e-02 -6.87929050e-02  8.63280079e-03]
 [-1.96823708e-01  4.78368267e-02 -1.22481243e-01]
 [-2.99871534e-02  5.43438952e-02  2.87999942e-02]
 [ 1.12813290e-01  4.02742238e-02  1.31000017e-01]
 [-1.02023986e-01  2.14201091e-01 -4.03124429e-02]
 [-6.48097399e-02 -1.47086394e-01  1.82890101e-01]
 [-6.40164422e-02 -1.44613243e-01  3.13196851e-02]
 [ 6.37251350e-03  7.49572504e-01  1.08961235e-01]
 [ 2.39201665e-01 -2.44121628e-02  2.51993933e-01]
 [ 4.20062257e-01  1.60602979e-01  2.64144163e-01]
 [-2.23485731e-01 -2.29987749e-01  3.07182301e-02]
 [-7.20031007e-02 -1.92022748e-02  8.80866130e-02]
 [-5.96542013e-03  1.57048701e-02  8.48434539e-02]
 [ 1.26823297e-02 -1.42929068e-01 -5.96149845e-02]
 [ 6.15894104e-02 -8.21926608e-02 -8.52374592e-02]
 [ 6.73232571e-02 -1.32353017e-02  2.08053877e-02]
 [ 4.63858718e-02  2.60328926e-02  1.78074727e-03]
 [-3.72153218e-02 -5.97391029e-02 -8.63391947e-03]
 [ 1.05977908e-02  9.83531579e-02 -1.75100771e-01]
 [-7.09923790e-02 -1.65001605e-02 -2.43206040e-02]
 [-2.30310035e-02  3.63152478e-01 -2.99880288e-01]
 [ 1.44456314e-01  8.97540533e-02  1.15732692e-01]
 [ 2.76629867e-02 -5.01063288e-02  8.07235594e-02]
 [ 2.28489727e-01  8.06932753e-02 -3.09706732e-01]
 [-1.34950428e-01  3.74430642e-02  4.00596732e-03]
 [-1.30172408e-01 -2.07378788e-02  2.04116414e-01]
 [-4.15356876e-02 -3.35161821e-02 -7.79450258e-03]
 [-9.92329832e-02  1.17618556e-01 -1.01406515e-01]
 [ 2.97212137e-02 -4.00235013e-02  9.17251630e-02]
 [ 1.73266767e-02  3.69529388e-02 -6.08974841e-02]
 [ 3.04888800e-02 -3.27590215e-02 -7.08315738e-02]
 [-3.41045118e-02  3.44070132e-02 -1.14798074e-01]
 [ 2.39740047e-02  2.94775157e-02  5.70911773e-02]
 [ 3.58046752e-02 -3.81107912e-02  1.51503494e-01]
 [-6.92430917e-02 -2.77921128e-03 -1.96913457e-02]
 [ 2.79490316e-02 -5.49326679e-02  5.54835486e-02]
 [-4.02606233e-02  9.70350166e-02  5.12722970e-02]
 [ 3.20750437e-02 -5.82071566e-02 -4.03967942e-02]
 [ 9.49929573e-02  5.51539792e-03  8.33450683e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.25665884]
curr_Stock_Price:  99.73058109973063
curr_Factors:  [99.7305811  -0.96429453 -0.99721271]
mat_Sqrt:  [[14.02673462  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00398269 -0.02220281  0.02462698]
Stock Position:  0.003982694116935348
Bond Position:  [-0.14053756]


portfolio before change:  [0.25349551]
curr_Stock_Price:  98.94072322550265
curr_Factors:  [98.94072323 -0.946378   -0.97784304]
mat_Sqrt:  [[14.44430003  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01468125  0.01543927 -0.34940489]
Stock Position:  -0.014681253848062471
Bond Position:  [1.70606939]


portfolio before change:  [0.24969864]
curr_Stock_Price:  99.21387013304876
curr_Factors:  [99.21387013 -1.27855088 -0.97500316]
mat_Sqrt:  [[10.41996612  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124909  0.01753942  0.08215837]
Stock Position:  -0.0012490902466050424
Bond Position:  [0.37362572]


portfolio before change:  [0.24893297]
curr_Stock_Price:  99.86424954631833
curr_Factors:  [99.86424955 -1.0650809  -0.97728809]
mat_Sqrt:  [[12.95449422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0114072  0.01299845 0.37370659]
Stock Position:  0.011407199318093966
Bond Position:  [-0.89023843]


portfolio before change:  [0.23418944]
curr_Stock_Price:  98.58152994174777
curr_Factors:  [98.58152994 -0.92327483 -0.98401552]
mat_Sqrt:  [[14.63760011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00454508  0.0691331  -0.11500018]
Stock Position:  -0.00454508346236166
Bond Position:  [0.68225072]


portfolio before change:  [0.23349505]
curr_Stock_Price:  98.75307413384488
curr_Factors:  [98.75307413 -0.87710123 -0.98464292]
mat_Sqrt:  [[15.34636116  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0037469  -0.04747193  0.52173455]
Stock Position:  -0.003746903790524971
Bond Position:  [0.60351331]


portfolio before change:  [0.2340399]
curr_Stock_Price:  98.6277951086769
curr_Factors:  [98.62779511 -0.7194163  -0.99208413]
mat_Sqrt:  [[17.81164914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00489244 -0.04667372  0.08934634]
Stock Position:  -0.004892438212374615
Bond Position:  [0.71657029]


portfolio before change:  [0.23244445]
curr_Stock_Price:  98.97220887605641
curr_Factors:  [98.97220888 -0.98802434 -0.98637949]
mat_Sqrt:  [[13.74170349  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0132167  0.24192349 0.31083608]
Stock Position:  0.01321670048415294
Bond Position:  [-1.07564159]


portfolio before change:  [0.25329293]
curr_Stock_Price:  100.5598172482968
curr_Factors:  [100.55981725  -0.99397719  -0.97912563]
mat_Sqrt:  [[13.98031029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02043278 -0.00787899  0.71886855]
Stock Position:  0.020432779592955832
Bond Position:  [-1.80142365]


portfolio before change:  [0.24743396]
curr_Stock_Price:  100.28409453042573
curr_Factors:  [100.28409453  -0.92651163  -1.00205168]
mat_Sqrt:  [[14.57698322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03476463 0.05183439 0.75352977]
Stock Position:  0.034764628370625356
Bond Position:  [-3.23890532]


portfolio before change:  [0.21931767]
curr_Stock_Price:  99.48697972320376
curr_Factors:  [99.48697972 -0.79979507 -0.97348679]
mat_Sqrt:  [[16.89039153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01563975 -0.07422823  0.08763056]
Stock Position:  -0.01563974706101804
Bond Position:  [1.77526887]


portfolio before change:  [0.22268359]
curr_Stock_Price:  99.28595359362478
curr_Factors:  [99.28595359 -0.58463932 -0.99285252]
mat_Sqrt:  [[20.50179138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0028262  -0.00619751  0.25128659]
Stock Position:  -0.0028261990854116657
Bond Position:  [0.50328546]


portfolio before change:  [0.22466502]
curr_Stock_Price:  98.60712170125082
curr_Factors:  [98.6071217  -0.78399189 -0.98011399]
mat_Sqrt:  [[16.89533583  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00086171 0.00506873 0.24203476]
Stock Position:  0.0008617124105311279
Bond Position:  [0.13969404]


portfolio before change:  [0.22588388]
curr_Stock_Price:  100.00131705911328
curr_Factors:  [100.00131706  -1.09775031  -0.99911131]
mat_Sqrt:  [[12.2842965   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00233321 -0.04613016 -0.17006496]
Stock Position:  -0.0023332066100786903
Bond Position:  [0.45920761]


portfolio before change:  [0.22486302]
curr_Stock_Price:  100.46345664712646
curr_Factors:  [100.46345665  -1.06966024  -0.99110034]
mat_Sqrt:  [[12.79473133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00214251 -0.02652757 -0.24315875]
Stock Position:  0.0021425131607055946
Bond Position:  [0.00961874]


portfolio before change:  [0.2241586]
curr_Stock_Price:  100.13411478398743
curr_Factors:  [100.13411478  -1.15285623  -0.99367845]
mat_Sqrt:  [[11.70452769  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00588392 -0.00427168  0.05935198]
Stock Position:  0.005883919138677797
Bond Position:  [-0.36502243]


portfolio before change:  [0.22158334]
curr_Stock_Price:  99.7041926911116
curr_Factors:  [99.70419269 -1.10535756 -0.99459671]
mat_Sqrt:  [[12.20997773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.004264   0.00840208 0.00507998]
Stock Position:  0.0042639969022684925
Bond Position:  [-0.20355503]


portfolio before change:  [0.21629284]
curr_Stock_Price:  98.4694234755482
curr_Factors:  [98.46942348 -0.81675693 -1.00670444]
mat_Sqrt:  [[15.89945292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00321847 -0.01928071 -0.02463017]
Stock Position:  -0.003218469638898567
Bond Position:  [0.53321369]


portfolio before change:  [0.22042086]
curr_Stock_Price:  97.20753092413463
curr_Factors:  [97.20753092 -0.67482852 -0.97418242]
mat_Sqrt:  [[18.68717099  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.71215483e-04  3.17433452e-02 -4.99513761e-01]
Stock Position:  -0.00027121548275066686
Bond Position:  [0.24678505]


portfolio before change:  [0.22085611]
curr_Stock_Price:  95.71648632312076
curr_Factors:  [95.71648632 -0.97228638 -0.97913679]
mat_Sqrt:  [[13.59860725  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00583331 -0.0053254  -0.06937991]
Stock Position:  -0.005833309339804543
Bond Position:  [0.77919998]


portfolio before change:  [0.2195527]
curr_Stock_Price:  95.95662602831462
curr_Factors:  [95.95662603 -1.07971012 -0.97932245]
mat_Sqrt:  [[12.24189042  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.26312072e-04  1.17206958e-01 -8.55474992e-01]
Stock Position:  -0.0008263120724042014
Bond Position:  [0.29884282]


portfolio before change:  [0.21985094]
curr_Stock_Price:  95.64090963610985
curr_Factors:  [95.64090964 -0.87622177 -0.9846502 ]
mat_Sqrt:  [[14.8756951   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01253058 0.028968   0.33015316]
Stock Position:  0.012530582170272078
Bond Position:  [-0.97858533]


portfolio before change:  [0.2042732]
curr_Stock_Price:  94.40749475986775
curr_Factors:  [94.40749476 -1.10816775 -0.9750082 ]
mat_Sqrt:  [[11.7569495   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00288448 -0.01617175  0.23028185]
Stock Position:  0.0028844814466341875
Bond Position:  [-0.06804346]


portfolio before change:  [0.20654995]
curr_Stock_Price:  95.19975168822388
curr_Factors:  [95.19975169 -1.54683648 -0.98548012]
mat_Sqrt:  [[ 7.56597132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02402105  0.02604364 -0.8835071 ]
Stock Position:  0.024021046703784254
Bond Position:  [-2.08024773]


portfolio before change:  [0.19932328]
curr_Stock_Price:  94.90973029825153
curr_Factors:  [94.9097303  -1.36655225 -0.99625883]
mat_Sqrt:  [[ 8.9362421   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01415468  0.0120847   0.01142791]
Stock Position:  -0.014154683623865797
Bond Position:  [1.54274049]


portfolio before change:  [0.19166279]
curr_Stock_Price:  95.46455341877247
curr_Factors:  [95.46455342 -1.25848418 -0.99876673]
mat_Sqrt:  [[ 9.98919593  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00928407 -0.00669312  0.58228731]
Stock Position:  -0.009284072714638316
Bond Position:  [1.07796265]


portfolio before change:  [0.18207092]
curr_Stock_Price:  96.51222166110283
curr_Factors:  [96.51222166 -1.34364165 -1.00917655]
mat_Sqrt:  [[ 9.17838668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00544412 -0.0108173  -0.02223555]
Stock Position:  -0.0054441153537361404
Bond Position:  [0.70749459]


portfolio before change:  [0.18097145]
curr_Stock_Price:  96.73042271644633
curr_Factors:  [96.73042272 -1.19948234 -1.00300755]
mat_Sqrt:  [[10.6913828   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00897206  0.03796123 -0.28928456]
Stock Position:  -0.008972058709286832
Bond Position:  [1.04884248]


portfolio before change:  [0.18365575]
curr_Stock_Price:  96.44585232718181
curr_Factors:  [96.44585233 -1.13459893 -0.96993142]
mat_Sqrt:  [[11.7570303   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00342559 -0.01291753  0.26166636]
Stock Position:  0.0034255904906914663
Bond Position:  [-0.14672825]


portfolio before change:  [0.1838999]
curr_Stock_Price:  96.52247926063512
curr_Factors:  [96.52247926 -1.22532459 -0.98464346]
mat_Sqrt:  [[10.58891691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00117472  0.01192651 -0.17372357]
Stock Position:  0.0011747204165019358
Bond Position:  [0.07051297]


portfolio before change:  [0.18459079]
curr_Stock_Price:  97.10311422703204
curr_Factors:  [97.10311423 -1.3733     -0.98890173]
mat_Sqrt:  [[ 9.14833332  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00102134 -0.01057293 -0.20206276]
Stock Position:  0.0010213377610539592
Bond Position:  [0.08541572]


portfolio before change:  [0.18419705]
curr_Stock_Price:  96.70713760255437
curr_Factors:  [96.7071376  -1.33470049 -0.98086033]
mat_Sqrt:  [[ 9.54603979  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00529165  0.01110482 -0.32748695]
Stock Position:  -0.005291646537581814
Bond Position:  [0.69593704]


portfolio before change:  [0.18166886]
curr_Stock_Price:  97.20134834095677
curr_Factors:  [97.20134834 -1.3126752  -1.00698627]
mat_Sqrt:  [[ 9.55555927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00435817 0.00951383 0.16286524]
Stock Position:  0.00435817140120312
Bond Position:  [-0.24195128]


portfolio before change:  [0.18508589]
curr_Stock_Price:  97.99234094538701
curr_Factors:  [97.99234095 -1.1731767  -0.99428898]
mat_Sqrt:  [[11.21692332  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00525553 -0.0123002   0.4321973 ]
Stock Position:  0.005255528822802914
Bond Position:  [-0.32991568]


portfolio before change:  [0.1873506]
curr_Stock_Price:  98.4311079144639
curr_Factors:  [98.43110791 -1.32307216 -0.98422494]
mat_Sqrt:  [[ 9.79683915  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00753609 -0.00089699 -0.05617393]
Stock Position:  -0.00753609137137037
Bond Position:  [0.92913642]


portfolio before change:  [0.18877762]
curr_Stock_Price:  98.25716244079884
curr_Factors:  [98.25716244 -1.20776178 -1.00294105]
mat_Sqrt:  [[10.77130143  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00260521 -0.01772944  0.15827912]
Stock Position:  0.002605207905259163
Bond Position:  [-0.06720272]


portfolio before change:  [0.18958568]
curr_Stock_Price:  98.57055653452665
curr_Factors:  [98.57055653 -1.14336687 -1.01505894]
mat_Sqrt:  [[11.38557034  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00087721  0.03131792  0.14626559]
Stock Position:  -0.0008772085500258533
Bond Position:  [0.27605261]


portfolio before change:  [0.1893286]
curr_Stock_Price:  98.90295220322798
curr_Factors:  [98.9029522  -1.20323498 -1.01116267]
mat_Sqrt:  [[10.80210942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00110604 -0.01878628 -0.11524081]
Stock Position:  0.001106042904904376
Bond Position:  [0.0799377]


portfolio before change:  [0.18976375]
curr_Stock_Price:  99.28734217107915
curr_Factors:  [99.28734217 -1.23074899 -1.02879528]
mat_Sqrt:  [[10.36540502  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01091434 0.00178009 0.23776028]
Stock Position:  0.010914337045762858
Bond Position:  [-0.89389177]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.18587918]
Stock Price:  98.94166618983067
PL:  [0.18587918]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-3.38293553e-02 -8.17302666e-02  1.26140232e-02]
 [-1.06594859e-01  7.08029423e-02 -1.09848859e-01]
 [-2.69313121e-02 -9.08694318e-03  1.96433917e-02]
 [-5.01014729e-01 -2.14428049e-01 -3.16966909e-01]
 [ 1.88492362e-01 -1.95835910e-01 -1.04680436e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.65243892e-02 -1.69008088e-01  4.86654269e-02]
 [ 1.28646335e-02  7.25177459e-01  9.79628419e-02]
 [ 3.22538255e-01  1.10731447e-02  3.30644153e-01]
 [ 5.04723713e-01  2.11987047e-01  3.87515461e-01]
 [-2.17306654e-01 -2.30051646e-01  2.46563291e-02]
 [ 3.43745078e-03 -1.50789756e-02  1.05786245e-01]
 [ 1.37430850e-02 -5.64599175e-02  7.24024058e-02]
 [ 2.09648740e-03  1.13068590e-01 -1.02216241e-01]
 [ 2.87522242e-01 -1.55434572e-01 -1.58597736e-01]
 [-1.82914263e-01 -8.40872052e-02  1.11576489e-01]
 [ 4.89749986e-02  2.13860517e-02 -1.33624486e-02]
 [-4.34852652e-02 -5.28012448e-02  4.75745188e-02]
 [ 1.25788574e-01 -1.42597182e-01 -1.83586245e-02]
 [ 4.21854525e-02 -1.32932242e-02  1.59837968e-01]
 [-1.84755408e-02  3.59205609e-01 -3.41132329e-01]
 [ 9.51885301e-02  8.09880298e-02  1.06877147e-01]
 [ 1.65734286e-03  1.06591783e-01 -1.46104942e-02]
 [ 6.06204157e-02 -1.51252514e-01 -2.35308700e-01]
 [ 7.03097195e-02  4.21225604e-02 -1.57015102e-02]
 [-2.32574548e-02  1.23643276e-02  6.84526313e-02]
 [ 6.54593072e-02 -3.23808669e-02  2.61744793e-02]
 [ 1.40774200e-01 -7.23975365e-02  6.12248838e-02]
 [-4.77414355e-02 -2.56744625e-02 -1.16283153e-02]
 [-5.05693117e-02 -9.00601163e-03  2.63151075e-02]
 [-2.50872752e-02 -4.28224390e-02 -1.19814202e-02]
 [ 2.59600450e-02 -4.41275269e-03 -3.81580250e-02]
 [ 8.17691160e-02  7.09493254e-03  1.55506230e-01]
 [ 1.08072978e-02 -7.07052641e-02 -1.61923257e-02]
 [-5.71360049e-03 -1.39335825e-02  4.65617109e-02]
 [ 8.50450348e-02  3.09342900e-02  1.90744817e-01]
 [ 1.23486135e-01 -6.60066148e-02  3.98899352e-02]
 [-5.20394865e-02 -8.92508442e-03  2.87248423e-02]
 [ 9.09775286e-02  8.00305742e-03  1.07115609e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.93328635]
curr_Stock_Price:  100.0680300736587
curr_Factors:  [100.06803007  -1.17285061  -0.99485817]
mat_Sqrt:  [[11.4517376   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00418606 -0.02637833  0.0359843 ]
Stock Position:  -0.004186059018487559
Bond Position:  [3.35217703]


portfolio before change:  [2.93129784]
curr_Stock_Price:  100.64316649630813
curr_Factors:  [100.6431665   -1.06407602  -0.98377328]
mat_Sqrt:  [[12.98418336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00882343  0.02285155 -0.31336822]
Stock Position:  -0.008823433088725284
Bond Position:  [3.81931608]


portfolio before change:  [2.92254448]
curr_Stock_Price:  101.68933609581693
curr_Factors:  [101.6893361   -1.10453943  -0.99760455]
mat_Sqrt:  [[12.42584354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199395 -0.0029328   0.05603713]
Stock Position:  -0.001993948018210797
Bond Position:  [3.12530773]


portfolio before change:  [2.92157545]
curr_Stock_Price:  102.37125701121127
curr_Factors:  [102.37125701  -0.99230019  -1.00353554]
mat_Sqrt:  [[13.912257    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04380923 -0.06920636 -0.90421837]
Stock Position:  -0.04380923023984805
Bond Position:  [7.40638142]


portfolio before change:  [2.95418847]
curr_Stock_Price:  101.64795806278998
curr_Factors:  [101.64795806  -1.20002602  -1.00323964]
mat_Sqrt:  [[11.22619401  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01132616 -0.06320577 -0.29862415]
Stock Position:  0.011326164450954038
Bond Position:  [1.80290699]


portfolio before change:  [2.95427632]
curr_Stock_Price:  101.63581524307256
curr_Factors:  [101.63581524  -1.33171256  -1.0028491 ]
mat_Sqrt:  [[ 9.84372632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0155738  -0.05534923  0.15513819]
Stock Position:  -0.015573797075739531
Bond Position:  [4.53713188]


portfolio before change:  [2.97415577]
curr_Stock_Price:  100.39576585144859
curr_Factors:  [100.39576585  -1.08689232  -1.00971961]
mat_Sqrt:  [[12.33583092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00657347 -0.05454713  0.13882892]
Stock Position:  -0.006573471428297872
Bond Position:  [3.63410447]


portfolio before change:  [2.97789971]
curr_Stock_Price:  99.89532412801042
curr_Factors:  [99.89532413 -0.94922362 -1.01714835]
mat_Sqrt:  [[13.98172203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01293742 0.23405002 0.27946072]
Stock Position:  0.01293742240407395
Bond Position:  [1.6855117]


portfolio before change:  [3.00257238]
curr_Stock_Price:  101.78611602058322
curr_Factors:  [101.78611602  -1.05870075  -1.01573934]
mat_Sqrt:  [[12.78705878  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03067875 0.00357384 0.94323573]
Stock Position:  0.03067875206784927
Bond Position:  [-0.12009864]


portfolio before change:  [2.99631371]
curr_Stock_Price:  101.58259865343364
curr_Factors:  [101.58259865  -1.13231442  -0.98856395]
mat_Sqrt:  [[12.18241936  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05147554 0.06841853 1.10547375]
Stock Position:  0.051475542893999304
Bond Position:  [-2.23270571]


portfolio before change:  [3.0044544]
curr_Stock_Price:  101.74616748452809
curr_Factors:  [101.74616748  -1.28519952  -0.96064815]
mat_Sqrt:  [[10.76858921  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02407305 -0.07424885  0.07033764]
Stock Position:  -0.024073051047079103
Bond Position:  [5.45379508]


portfolio before change:  [3.001382]
curr_Stock_Price:  101.9021161621253
curr_Factors:  [101.90211616  -1.11368767  -0.98422011]
mat_Sqrt:  [[12.50470435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00175558 -0.00486672  0.30177871]
Stock Position:  0.0017555788551275738
Bond Position:  [2.8224848]


portfolio before change:  [3.00225485]
curr_Stock_Price:  102.19832361147408
curr_Factors:  [102.19832361  -0.99969318  -1.01839296]
mat_Sqrt:  [[13.58313763  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00125136 -0.01822236  0.20654391]
Stock Position:  0.0012513553379009822
Bond Position:  [2.87436843]


portfolio before change:  [3.00271467]
curr_Stock_Price:  102.2786384185437
curr_Factors:  [102.27863842  -0.97500228  -1.01990654]
mat_Sqrt:  [[13.91255994  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00030992  0.03649273 -0.29159449]
Stock Position:  0.00030991519466149533
Bond Position:  [2.97101697]


portfolio before change:  [3.00313743]
curr_Stock_Price:  102.44435554546048
curr_Factors:  [102.44435555  -1.07774532  -1.06013892]
mat_Sqrt:  [[12.07860291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01849723 -0.05016629 -0.45243519]
Stock Position:  0.018497227489859755
Bond Position:  [1.10820088]


portfolio before change:  [3.00377607]
curr_Stock_Price:  102.47139243660413
curr_Factors:  [102.47139244  -1.26330877  -1.05709493]
mat_Sqrt:  [[10.06616663  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01761376 -0.02713903  0.31829667]
Stock Position:  -0.017613759303573482
Bond Position:  [4.80868252]


portfolio before change:  [2.98764797]
curr_Stock_Price:  103.42117415693826
curr_Factors:  [103.42117416  -1.51727642  -1.06631636]
mat_Sqrt:  [[ 7.80853163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00648173  0.00690232 -0.03811935]
Stock Position:  0.0064817320541229245
Bond Position:  [2.31729963]


portfolio before change:  [2.98837814]
curr_Stock_Price:  103.48913325012487
curr_Factors:  [103.48913325  -1.47272316  -1.0656633 ]
mat_Sqrt:  [[ 8.17499544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00544981 -0.01704153  0.13571686]
Stock Position:  -0.0054498093034631885
Bond Position:  [3.55237418]


portfolio before change:  [2.99151883]
curr_Stock_Price:  102.99432444790627
curr_Factors:  [102.99432445  -1.60221266  -1.02658622]
mat_Sqrt:  [[ 7.43259467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01250352 -0.04602304 -0.05237205]
Stock Position:  0.012503521545604409
Bond Position:  [1.70372708]


portfolio before change:  [2.98425019]
curr_Stock_Price:  102.39596312813781
curr_Factors:  [102.39596313  -1.24055158  -1.01684934]
mat_Sqrt:  [[10.7128758   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0067301  -0.00429037  0.45597323]
Stock Position:  0.006730104453565188
Bond Position:  [2.29511466]


portfolio before change:  [2.98690203]
curr_Stock_Price:  102.74735980748042
curr_Factors:  [102.74735981  -1.53585705  -1.03801053]
mat_Sqrt:  [[ 7.83346997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188759  0.11593311 -0.97315558]
Stock Position:  -0.001887585976301842
Bond Position:  [3.18084651]


portfolio before change:  [2.98752157]
curr_Stock_Price:  102.62979770058868
curr_Factors:  [102.6297977   -1.45579335  -1.0557271 ]
mat_Sqrt:  [[ 8.32787114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01603487 0.02613877 0.30489075]
Stock Position:  0.016034872120428194
Bond Position:  [1.34186589]


portfolio before change:  [2.99110941]
curr_Stock_Price:  102.84308894390112
curr_Factors:  [102.84308894  -1.46536782  -1.06797766]
mat_Sqrt:  [[ 8.16501807  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0025025   0.03440235 -0.04167967]
Stock Position:  0.0025024984096007384
Bond Position:  [2.73374474]


portfolio before change:  [2.98933398]
curr_Stock_Price:  101.99706640839912
curr_Factors:  [101.99706641  -1.36190588  -1.06405094]
mat_Sqrt:  [[ 9.0158779   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202821 -0.04881654 -0.67127022]
Stock Position:  -0.002028206445692388
Bond Position:  [3.19620509]


portfolio before change:  [2.99035299]
curr_Stock_Price:  101.69164217619698
curr_Factors:  [101.69164218  -1.48863778  -1.05367883]
mat_Sqrt:  [[ 8.00149586  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00946109  0.013595   -0.04479204]
Stock Position:  0.009461092658421573
Bond Position:  [2.02823894]


portfolio before change:  [2.98952705]
curr_Stock_Price:  101.57754420085583
curr_Factors:  [101.5775442   -1.30912792  -1.06437009]
mat_Sqrt:  [[ 9.46238513  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071449  0.00399057  0.1952763 ]
Stock Position:  -0.0007144881619204617
Bond Position:  [3.062103]


portfolio before change:  [2.98951568]
curr_Stock_Price:  102.12920439401196
curr_Factors:  [102.12920439  -1.41730606  -1.06552711]
mat_Sqrt:  [[ 8.52843228  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00752687 -0.01045088  0.0746685 ]
Stock Position:  0.007526873817706115
Bond Position:  [2.22080205]


portfolio before change:  [2.98980418]
curr_Stock_Price:  102.13064987752209
curr_Factors:  [102.13064988  -1.42567343  -1.03839524]
mat_Sqrt:  [[ 8.69009788  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01593694 -0.0233662   0.17465755]
Stock Position:  0.015936942728195826
Bond Position:  [1.36215386]


portfolio before change:  [2.98690078]
curr_Stock_Price:  101.93778511595544
curr_Factors:  [101.93778512  -1.74032768  -1.02417894]
mat_Sqrt:  [[ 6.42281219  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00861863 -0.0082864  -0.03317235]
Stock Position:  -0.008618628655037208
Bond Position:  [3.8654647]


portfolio before change:  [2.98482896]
curr_Stock_Price:  102.23423970182026
curr_Factors:  [102.2342397   -1.97868637  -1.03518079]
mat_Sqrt:  [[ 5.01984721  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00937003 -0.00290668  0.07506968]
Stock Position:  -0.009370027688048897
Bond Position:  [3.94276662]


portfolio before change:  [2.98581401]
curr_Stock_Price:  102.18171335147323
curr_Factors:  [102.18171335  -1.89954545  -1.03079778]
mat_Sqrt:  [[ 5.45432844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00665051 -0.01382088 -0.03417966]
Stock Position:  -0.006650510056749572
Bond Position:  [3.66537453]


portfolio before change:  [2.98823152]
curr_Stock_Price:  101.88710338506266
curr_Factors:  [101.88710339  -1.46503075  -1.02480292]
mat_Sqrt:  [[ 8.4488615   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0020441  -0.00142421 -0.10885422]
Stock Position:  0.0020441004318852516
Bond Position:  [2.77996405]


portfolio before change:  [2.98839357]
curr_Stock_Price:  101.79636929573273
curr_Factors:  [101.7963693   -1.55022619  -1.02143075]
mat_Sqrt:  [[ 7.77814208  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01477987 0.00228988 0.44361599]
Stock Position:  0.014779871350716742
Bond Position:  [1.48385633]


portfolio before change:  [2.99161025]
curr_Stock_Price:  102.00145828799377
curr_Factors:  [102.00145829  -1.69111069  -1.02702254]
mat_Sqrt:  [[ 6.73187611  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102952 -0.02282003 -0.0461922 ]
Stock Position:  -0.0010295196025299068
Bond Position:  [3.09662275]


portfolio before change:  [2.99164209]
curr_Stock_Price:  102.34653779916849
curr_Factors:  [102.3465378   -1.56956297  -1.04350696]
mat_Sqrt:  [[ 7.50293707  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.26162371e-04 -4.49704441e-03  1.32827601e-01]
Stock Position:  0.00012616237065076342
Bond Position:  [2.97872981]


portfolio before change:  [2.99200547]
curr_Stock_Price:  102.27536396482779
curr_Factors:  [102.27536396  -1.46374905  -1.04042796]
mat_Sqrt:  [[ 8.36027917  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01558502 0.009984   0.54414187]
Stock Position:  0.015585017021193717
Bond Position:  [1.39804218]


portfolio before change:  [2.98489435]
curr_Stock_Price:  101.80787103950915
curr_Factors:  [101.80787104  -1.45384038  -1.02300124]
mat_Sqrt:  [[ 8.55268951  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01381496 -0.02130354  0.11379488]
Stock Position:  0.013814963123884853
Bond Position:  [1.57842237]


portfolio before change:  [2.97912213]
curr_Stock_Price:  101.3757644393604
curr_Factors:  [101.37576444  -1.43345015  -1.03184449]
mat_Sqrt:  [[ 8.61529754  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00557124 -0.00288056  0.08194398]
Stock Position:  -0.005571238553709429
Bond Position:  [3.5439107]


portfolio before change:  [2.97520309]
curr_Stock_Price:  102.15872502537033
curr_Factors:  [102.15872503  -1.58032946  -1.02527865]
mat_Sqrt:  [[ 7.54526053  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01517191 0.00258298 0.30557102]
Stock Position:  0.015171911888684542
Bond Position:  [1.42525991]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.98158048]
Stock Price:  102.56732402204743
PL:  [0.41425646]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 9.53799824e-02 -6.72118914e-03 -1.21723549e-03]
 [-1.34355546e-01  5.27154773e-02  1.56648220e-02]
 [-4.64690955e-02 -1.03750456e-02  2.30578825e-03]
 [-1.39382725e-01 -5.51185933e-02 -5.41416036e-02]
 [ 1.15461377e-01 -8.44186906e-02 -8.93327926e-02]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.42568945e-02 -1.51197152e-01  2.74837218e-04]
 [ 8.02915968e-03  7.03330745e-01  1.03673351e-01]
 [ 3.20202921e-01  9.37856234e-03  3.18398585e-01]
 [ 5.26302062e-01  2.12525826e-01  3.78432679e-01]
 [-1.88467907e-01 -2.12055017e-01  2.71531399e-02]
 [-8.78838545e-02 -1.97517172e-02  8.61179519e-02]
 [ 4.34461571e-03 -5.59208693e-02  1.42834745e-01]
 [ 9.66703873e-03 -4.23462131e-02 -1.51583469e-01]
 [ 1.79815729e-01 -1.15619380e-01 -1.25886621e-01]
 [-2.28799461e-01 -9.70624424e-02  1.22165368e-01]
 [ 5.14102526e-02  1.70153745e-02 -2.76056782e-02]
 [-5.79963851e-02 -6.13848691e-02  2.69132088e-02]
 [ 9.54413132e-02 -6.92445824e-02 -6.48494265e-02]
 [ 3.06131680e-02 -1.07079753e-02  1.95758982e-01]
 [-4.62275060e-02  5.75709542e-01 -5.59550355e-01]
 [ 4.81165730e-01  2.65676818e-01  4.40234804e-02]
 [-9.18263692e-02  1.59330077e-01 -7.16235798e-02]
 [-3.60831585e-02 -1.50639302e-01 -4.94243362e-02]
 [ 3.78302241e-02  1.51401342e-02 -1.23873821e-02]
 [-6.11854541e-02 -5.11417736e-03  1.69956242e-01]
 [-8.98526402e-03 -3.25363490e-02  1.61355081e-03]
 [-5.74832683e-02  3.97337365e-02 -2.35051719e-01]
 [ 1.29469946e-02 -3.85104420e-02  7.98038033e-02]
 [-8.97144965e-03  3.25922202e-02 -4.10591693e-02]
 [ 1.30175997e-02 -2.67116674e-04  6.24435161e-02]
 [ 1.42493946e-02  1.33078274e-01 -1.05851246e-01]
 [-4.07235319e-02  2.21898595e-02 -1.02290645e-01]
 [ 2.56600728e-02 -5.10995789e-02  8.60122055e-02]
 [-5.65020241e-02  3.45515427e-02 -3.30855390e-03]
 [ 9.00457302e-02 -1.70803054e-03  1.62256798e-01]
 [-4.16890535e-03  1.55489828e-02 -3.92536814e-02]
 [-5.34685526e-02 -8.86520184e-03  3.17928047e-02]
 [ 9.47538413e-02  5.66353635e-03  8.47605878e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.85506751]
curr_Stock_Price:  99.33827814983893
curr_Factors:  [99.33827815 -0.82698987 -0.98721273]
mat_Sqrt:  [[16.18894131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00579158 -0.00216925 -0.00347243]
Stock Position:  0.005791580586079914
Bond Position:  [-3.43039316]


portfolio before change:  [-2.85667078]
curr_Stock_Price:  99.13549297905864
curr_Factors:  [99.13549298 -0.69759515 -0.98533474]
mat_Sqrt:  [[18.42222167  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00653545  0.01701385  0.04468738]
Stock Position:  -0.006535448232064118
Bond Position:  [-2.2087759]


portfolio before change:  [-2.86983168]
curr_Stock_Price:  101.10701590011486
curr_Factors:  [101.1070159   -0.68645663  -1.0254112 ]
mat_Sqrt:  [[18.25267577  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263612 -0.00334853  0.00657777]
Stock Position:  -0.0026361190177175376
Bond Position:  [-2.60330156]


portfolio before change:  [-2.87113322]
curr_Stock_Price:  101.47729506149632
curr_Factors:  [101.47729506  -0.74042533  -1.01886837]
mat_Sqrt:  [[17.4709829   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00925451 -0.01778945 -0.15445092]
Stock Position:  -0.009254509032671306
Bond Position:  [-1.93201067]


portfolio before change:  [-2.8679983]
curr_Stock_Price:  101.11245291750978
curr_Factors:  [101.11245292  -0.46543549  -1.01224676]
mat_Sqrt:  [[23.07041469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00346741 -0.02724602 -0.25484159]
Stock Position:  0.003467406416403202
Bond Position:  [-3.21859627]


portfolio before change:  [-2.86811943]
curr_Stock_Price:  101.19355730916266
curr_Factors:  [101.19355731  -0.63072288  -1.04022519]
mat_Sqrt:  [[19.03133862  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00805536 -0.05534923  0.15513819]
Stock Position:  -0.008055355393318121
Bond Position:  [-2.05296936]


portfolio before change:  [-2.86565879]
curr_Stock_Price:  100.85623197973587
curr_Factors:  [100.85623198  -0.62175027  -1.01201708]
mat_Sqrt:  [[19.68641319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00432094 -0.04879867  0.00078403]
Stock Position:  -0.004320938624473944
Bond Position:  [-2.4298652]


portfolio before change:  [-2.86671089]
curr_Stock_Price:  101.02942405877705
curr_Factors:  [101.02942406  -0.7313417   -1.02143768]
mat_Sqrt:  [[17.50755361  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00986764 0.22699902 0.29575121]
Stock Position:  0.009867636835922336
Bond Position:  [-3.86363256]


portfolio before change:  [-2.87250043]
curr_Stock_Price:  100.49165032243295
curr_Factors:  [100.49165032  -0.67622923  -1.00505668]
mat_Sqrt:  [[18.70496004  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02069559 0.00302692 0.90830254]
Stock Position:  0.020695588224350196
Bond Position:  [-4.95223425]


portfolio before change:  [-2.86260923]
curr_Stock_Price:  100.9995013858416
curr_Factors:  [100.99950139  -0.65086267  -1.00274549]
mat_Sqrt:  [[19.32708383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03347277 0.06859242 1.0795631 ]
Stock Position:  0.03347276637466292
Bond Position:  [-6.24334194]


portfolio before change:  [-2.83279179]
curr_Stock_Price:  101.91361474252072
curr_Factors:  [101.91361474  -0.5735993   -0.99893513]
mat_Sqrt:  [[21.148968    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01069607 -0.06844046  0.07746035]
Stock Position:  -0.010696070133451318
Bond Position:  [-1.74271662]


portfolio before change:  [-2.81233049]
curr_Stock_Price:  99.98027400158472
curr_Factors:  [99.980274   -0.44276773 -0.99610187]
mat_Sqrt:  [[23.71489434  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00313461 -0.00637484  0.24567055]
Stock Position:  -0.0031346082544497543
Bond Position:  [-2.4989315]


portfolio before change:  [-2.81327765]
curr_Stock_Price:  100.18277725305612
curr_Factors:  [100.18277725  -0.53177274  -0.98848919]
mat_Sqrt:  [[21.90542589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00100824 -0.01804838  0.40746777]
Stock Position:  0.0010082358756677281
Bond Position:  [-2.91428552]


portfolio before change:  [-2.8131046]
curr_Stock_Price:  100.71574804453121
curr_Factors:  [100.71574804  -0.46486173  -1.00959998]
mat_Sqrt:  [[23.05402697  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00129776 -0.01366718 -0.43242544]
Stock Position:  -0.001297764244748374
Bond Position:  [-2.6823993]


portfolio before change:  [-2.81411383]
curr_Stock_Price:  101.23503904629374
curr_Factors:  [101.23503905  -0.56044726  -0.9884513 ]
mat_Sqrt:  [[21.51061152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00606763 -0.03731599 -0.35911949]
Stock Position:  0.006067634250399982
Bond Position:  [-3.42837102]


portfolio before change:  [-2.80926943]
curr_Stock_Price:  102.10407178208312
curr_Factors:  [102.10407178  -0.55717387  -0.99716207]
mat_Sqrt:  [[21.57761992  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01036608 -0.03132677  0.34850379]
Stock Position:  -0.010366080626069961
Bond Position:  [-1.75085039]


portfolio before change:  [-2.8101199]
curr_Stock_Price:  102.16500087505153
curr_Factors:  [102.16500088  -0.55865865  -0.98454448]
mat_Sqrt:  [[21.83220194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00225577  0.00549169 -0.07875132]
Stock Position:  0.002255774109072354
Bond Position:  [-3.04058106]


portfolio before change:  [-2.80832441]
curr_Stock_Price:  103.12945149617725
curr_Factors:  [103.1294515   -0.33581597  -0.97804984]
mat_Sqrt:  [[27.71903049  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00234615 -0.01981188  0.07677589]
Stock Position:  -0.0023461456665634364
Bond Position:  [-2.5663677]


portfolio before change:  [-2.80621923]
curr_Stock_Price:  102.09541486001372
curr_Factors:  [102.09541486  -0.4145762   -0.97845964]
mat_Sqrt:  [[25.35236384  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00268494 -0.02234859 -0.18499736]
Stock Position:  0.0026849365468612986
Bond Position:  [-3.08033894]


portfolio before change:  [-2.80345989]
curr_Stock_Price:  103.26654198301104
curr_Factors:  [103.26654198  -0.35605456  -0.96651777]
mat_Sqrt:  [[27.51526946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0024854  -0.00345598  0.55844589]
Stock Position:  0.002485403485653784
Bond Position:  [-3.06011892]


portfolio before change:  [-2.8013891]
curr_Stock_Price:  104.25363783163806
curr_Factors:  [104.25363783  -0.50432161  -0.98012591]
mat_Sqrt:  [[23.62674258  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00181697  0.18580946 -1.59624141]
Stock Position:  -0.0018169675999464383
Bond Position:  [-2.61196362]


portfolio before change:  [-2.80199751]
curr_Stock_Price:  104.40878228236167
curr_Factors:  [104.40878228  -0.53287532  -0.94489885]
mat_Sqrt:  [[23.8203348   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02285371 0.08574682 0.12558674]
Stock Position:  0.022853710630700935
Bond Position:  [-5.18812561]


portfolio before change:  [-2.78922442]
curr_Stock_Price:  104.9960675431534
curr_Factors:  [104.99606754  -0.3934149   -0.94750918]
mat_Sqrt:  [[27.46737174  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00269132  0.05142356 -0.20432214]
Stock Position:  -0.0026913152109593204
Bond Position:  [-2.5066469]


portfolio before change:  [-2.78434812]
curr_Stock_Price:  103.06777315354728
curr_Factors:  [103.06777315  -0.46092077  -0.96406198]
mat_Sqrt:  [[24.78909919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00310302 -0.04861863 -0.14099387]
Stock Position:  -0.0031030162567261795
Bond Position:  [-2.46452715]


portfolio before change:  [-2.77787083]
curr_Stock_Price:  100.88107120601394
curr_Factors:  [100.88107121  -0.51536847  -0.9291881 ]
mat_Sqrt:  [[23.79286503  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0016136   0.00488646 -0.03533775]
Stock Position:  0.001613598331700859
Bond Position:  [-2.94065236]


portfolio before change:  [-2.77673738]
curr_Stock_Price:  101.81132442700039
curr_Factors:  [101.81132443  -0.2806192   -0.90230462]
mat_Sqrt:  [[31.19311881  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008828  -0.00165059  0.48483785]
Stock Position:  -0.0008827975412169366
Bond Position:  [-2.6868586]


portfolio before change:  [-2.77580742]
curr_Stock_Price:  100.37742247753883
curr_Factors:  [100.37742248  -0.53490375  -0.90708749]
mat_Sqrt:  [[23.7348888   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064451 -0.01050106  0.00460301]
Stock Position:  -0.0006445091825034489
Bond Position:  [-2.71111325]


portfolio before change:  [-2.77503095]
curr_Stock_Price:  98.64684374605342
curr_Factors:  [98.64684375 -0.41502257 -0.91430422]
mat_Sqrt:  [[26.1074169   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00372892  0.01282401 -0.67053713]
Stock Position:  -0.0037289167614579823
Bond Position:  [-2.40718508]


portfolio before change:  [-2.77360062]
curr_Stock_Price:  98.18256795660739
curr_Factors:  [98.18256796 -0.28683145 -0.92733877]
mat_Sqrt:  [[29.15593401  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00073316 -0.01242919  0.22765804]
Stock Position:  0.0007331600714466688
Bond Position:  [-2.84558416]


portfolio before change:  [-2.77465991]
curr_Stock_Price:  97.22293501171643
curr_Factors:  [97.22293501 -0.20008134 -0.97437816]
mat_Sqrt:  [[30.04052027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035618  0.01051909 -0.11713038]
Stock Position:  -0.00035617753271172917
Bond Position:  [-2.74003128]


portfolio before change:  [-2.77473059]
curr_Stock_Price:  96.45971672772741
curr_Factors:  [96.45971673 -0.10142263 -0.96121423]
mat_Sqrt:  [[33.33102394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.71332563e-04 -8.62115357e-05  1.78133971e-01]
Stock Position:  0.000771332562943646
Bond Position:  [-2.84913311]


portfolio before change:  [-2.774676]
curr_Stock_Price:  96.99224573049125
curr_Factors:  [96.99224573 -0.27666099 -0.97425744]
mat_Sqrt:  [[27.76323343  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071343  0.04295083 -0.30196414]
Stock Position:  0.0007134287255191375
Bond Position:  [-2.84387305]


portfolio before change:  [-2.77288241]
curr_Stock_Price:  100.00459620909652
curr_Factors:  [100.00459621  -0.52236325  -0.95247532]
mat_Sqrt:  [[22.88261782  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249421  0.00716175 -0.29180674]
Stock Position:  -0.0024942092194968177
Bond Position:  [-2.52345002]


portfolio before change:  [-2.77123284]
curr_Stock_Price:  99.21676215019058
curr_Factors:  [99.21676215 -0.67930634 -0.95939013]
mat_Sqrt:  [[19.27117597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00170133 -0.01649232  0.24536888]
Stock Position:  0.0017013275668630611
Bond Position:  [-2.94003305]


portfolio before change:  [-2.77012146]
curr_Stock_Price:  100.08602898202021
curr_Factors:  [100.08602898  -0.61040327  -0.97184862]
mat_Sqrt:  [[20.56885867  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243692  0.01115146 -0.00943838]
Stock Position:  -0.002436915750600341
Bond Position:  [-2.52622024]


portfolio before change:  [-2.77144745]
curr_Stock_Price:  100.50056716250374
curr_Factors:  [100.50056716  -0.84608194  -0.97715395]
mat_Sqrt:  [[16.2310728   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00756682 -0.00055126  0.46287348]
Stock Position:  0.0075668202333796005
Bond Position:  [-3.53191717]


portfolio before change:  [-2.76682746]
curr_Stock_Price:  101.16947477071223
curr_Factors:  [101.16947477  -0.84783064  -0.99049397]
mat_Sqrt:  [[16.09441756  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055967  0.00501841 -0.11197983]
Stock Position:  -0.0005596727349320603
Bond Position:  [-2.71020567]


portfolio before change:  [-2.7670617]
curr_Stock_Price:  100.98264797589904
curr_Factors:  [100.98264798  -0.96180251  -0.99619265]
mat_Sqrt:  [[14.25280236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00342308 -0.00286123  0.09069602]
Stock Position:  -0.003423079478728934
Bond Position:  [-2.42139007]


portfolio before change:  [-2.76526155]
curr_Stock_Price:  100.36833570962811
curr_Factors:  [100.36833571  -0.55979861  -0.9903643 ]
mat_Sqrt:  [[21.29950551  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00531522 0.0018279  0.24179836]
Stock Position:  0.005315221439741471
Bond Position:  [-3.29874148]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.76332568]
Stock Price:  100.81013116373502
PL:  [-3.57345684]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.31191449e-01 -1.06769520e-01  2.03193683e-02]
 [-1.02936830e-01  7.10714062e-02 -1.05082102e-01]
 [ 9.53910442e-03  9.45855635e-04  5.32313961e-02]
 [ 1.21330240e-01  2.94751591e-02  1.47392296e-01]
 [ 3.91793139e-03  1.03573255e-01 -5.83931760e-02]
 [-5.77999867e-02 -1.42490562e-01  2.07824203e-01]
 [-5.37888445e-02 -1.46609748e-01 -1.00766866e-02]
 [ 1.10701479e-02  6.24555144e-01  8.97890756e-02]
 [ 3.57407096e-01  2.54997277e-02  3.58047685e-01]
 [ 5.21664223e-01  2.20720107e-01  4.07203524e-01]
 [-1.40860228e-01 -1.76207112e-01  3.62912089e-02]
 [-6.47940505e-03 -1.58305736e-02  1.02303434e-01]
 [ 1.45266862e-02 -4.63667024e-02  4.55602069e-02]
 [ 5.02030224e-04  1.48285263e-01 -8.77293238e-02]
 [ 2.94736373e-01 -1.51602936e-01 -1.60736928e-01]
 [-2.17838132e-01 -9.40362957e-02  1.19645002e-01]
 [ 5.10957487e-02  1.75798310e-02 -2.57662185e-02]
 [-4.85598794e-02 -5.58029830e-02  4.03491510e-02]
 [ 7.31686731e-02 -3.75201539e-02 -9.46427950e-02]
 [ 1.27818700e-02  1.44305357e-02  5.10620161e-03]
 [-3.42106831e-02  4.78954925e-01 -4.50974218e-01]
 [ 3.59499253e-01  2.07459819e-01  6.38360088e-02]
 [-1.48204628e-03 -1.78748681e-02  6.02889534e-02]
 [ 5.86149281e-04  1.81379411e-03 -8.48067525e-02]
 [-1.73563708e-04  1.87190465e-02 -9.32099628e-03]
 [-8.64294733e-02 -1.51177296e-02  2.07919086e-01]
 [-1.10483387e-02 -3.24403618e-02  2.17570277e-03]
 [ 4.95944297e-02 -5.10923436e-02 -1.90352983e-01]
 [-4.80836555e-02 -4.24039270e-02  2.34956327e-02]
 [-5.95319416e-02 -1.09860801e-02  2.97071427e-02]
 [-2.76661877e-02 -4.32169076e-02 -1.02681069e-02]
 [ 2.60238278e-02 -1.18104651e-02 -4.99425040e-02]
 [ 5.73103924e-03  9.15789430e-03  1.58798541e-01]
 [ 1.51952531e-02 -6.47211877e-02  1.60622261e-02]
 [-3.46639447e-02  6.08676891e-02  3.74682447e-02]
 [ 9.17645625e-02  1.59643082e-03  1.68157450e-01]
 [-3.68759771e-02  3.46015907e-02 -5.80475471e-02]
 [-3.94097077e-02 -2.70876417e-02  1.84587050e-02]
 [ 9.55489659e-02  5.17093659e-03  8.00536082e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.65991417]
curr_Stock_Price:  100.5378551552377
curr_Factors:  [100.53785516  -0.87051809  -0.99335615]
mat_Sqrt:  [[15.59047398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0159609  -0.03445971  0.0579655 ]
Stock Position:  -0.01596090102790958
Bond Position:  [8.26458892]


portfolio before change:  [6.65600188]
curr_Stock_Price:  100.84770143986526
curr_Factors:  [100.84770144  -1.04698818  -1.01675928]
mat_Sqrt:  [[12.80536221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00858072  0.0229382  -0.29976999]
Stock Position:  -0.008580720520139066
Bond Position:  [7.52134782]


portfolio before change:  [6.65805415]
curr_Stock_Price:  100.71810401768938
curr_Factors:  [100.71810402  -0.88382395  -1.00112395]
mat_Sqrt:  [[15.29273178  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00134691 0.00030527 0.15185436]
Stock Position:  0.0013469136788570387
Bond Position:  [6.52239556]


portfolio before change:  [6.65833843]
curr_Stock_Price:  100.3238178840174
curr_Factors:  [100.32381788  -0.72510041  -1.01040235]
mat_Sqrt:  [[17.6882463   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00890044 0.00951307 0.42046919]
Stock Position:  0.008900439067975026
Bond Position:  [5.7654124]


portfolio before change:  [6.6533974]
curr_Stock_Price:  99.68769809541368
curr_Factors:  [99.6876981  -0.62194077 -0.98676635]
mat_Sqrt:  [[19.95211513  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00065859  0.03342812 -0.16657948]
Stock Position:  0.0006585906442793776
Bond Position:  [6.58774402]


portfolio before change:  [6.65340306]
curr_Stock_Price:  98.4458574227076
curr_Factors:  [98.44585742 -0.59470068 -0.9699249 ]
mat_Sqrt:  [[20.59155721  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215932 -0.04598863  0.5928646 ]
Stock Position:  -0.002159322511689583
Bond Position:  [6.86597942]


portfolio before change:  [6.64908891]
curr_Stock_Price:  100.84125943322584
curr_Factors:  [100.84125943  -0.84441668  -0.9854405 ]
mat_Sqrt:  [[16.17861666  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00530159 -0.04731809 -0.02874598]
Stock Position:  -0.005301586089367583
Bond Position:  [7.18370753]


portfolio before change:  [6.64592088]
curr_Stock_Price:  101.60820998627212
curr_Factors:  [101.60820999  -0.95389778  -1.02064042]
mat_Sqrt:  [[14.10580106  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01112202 0.20157431 0.25614324]
Stock Position:  0.01112202352407506
Bond Position:  [5.51583198]


portfolio before change:  [6.64743224]
curr_Stock_Price:  101.68210278212273
curr_Factors:  [101.68210278  -0.88867306  -1.01535317]
mat_Sqrt:  [[15.14734208  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02876402 0.00823    1.02141038]
Stock Position:  0.028764015609354935
Bond Position:  [3.72264665]


portfolio before change:  [6.65134213]
curr_Stock_Price:  101.8018541839101
curr_Factors:  [101.80185418  -1.08066644  -1.04262936]
mat_Sqrt:  [[12.17923588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05335627 0.07123711 1.16163831]
Stock Position:  0.05335626991499177
Bond Position:  [1.21957492]


portfolio before change:  [6.6758811]
curr_Stock_Price:  102.25890467769737
curr_Factors:  [102.25890468  -0.94152108  -1.04097355]
mat_Sqrt:  [[14.08363167  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0120296  -0.0568706   0.10352872]
Stock Position:  -0.012029599012929323
Bond Position:  [7.90601472]


portfolio before change:  [6.68169918]
curr_Stock_Price:  101.8574143218468
curr_Factors:  [101.85741432  -1.07621422  -1.01190018]
mat_Sqrt:  [[12.62222982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00088509 -0.0051093   0.29184322]
Stock Position:  0.0008850887483901007
Bond Position:  [6.59154633]


portfolio before change:  [6.6834323]
curr_Stock_Price:  102.8845749315748
curr_Factors:  [102.88457493  -1.17424489  -1.01945992]
mat_Sqrt:  [[11.471927    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00125193 -0.01496479  0.12997059]
Stock Position:  0.0012519309983779238
Bond Position:  [6.55462791]


portfolio before change:  [6.68376484]
curr_Stock_Price:  102.495700378658
curr_Factors:  [102.49570038  -1.07601661  -1.03146345]
mat_Sqrt:  [[12.45772351  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00103253  0.04785886 -0.25026734]
Stock Position:  0.0010325289076479182
Bond Position:  [6.57793506]


portfolio before change:  [6.68452748]
curr_Stock_Price:  102.43793206276573
curr_Factors:  [102.43793206  -1.00973819  -1.05470284]
mat_Sqrt:  [[12.99826704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01777008 -0.04892964 -0.45853772]
Stock Position:  0.017770081566511466
Bond Position:  [4.86419707]


portfolio before change:  [6.68239747]
curr_Stock_Price:  102.28384873848044
curr_Factors:  [102.28384874  -0.80166145  -1.05761744]
mat_Sqrt:  [[15.934282    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01334298 -0.03035008  0.34131389]
Stock Position:  -0.01334297813996734
Bond Position:  [8.04716863]


portfolio before change:  [6.68268974]
curr_Stock_Price:  102.33733715149121
curr_Factors:  [102.33733715  -0.7231983   -1.05290782]
mat_Sqrt:  [[17.32531035  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00285275  0.00567387 -0.07350385]
Stock Position:  0.002852745970950975
Bond Position:  [6.39074731]


portfolio before change:  [6.68132309]
curr_Stock_Price:  101.57823022579139
curr_Factors:  [101.57823023  -0.8156442   -1.04949663]
mat_Sqrt:  [[15.73186717  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328724 -0.01801034  0.1151049 ]
Stock Position:  -0.003287237244715977
Bond Position:  [7.01523483]


portfolio before change:  [6.68474627]
curr_Stock_Price:  100.80365305934572
curr_Factors:  [100.80365306  -0.89656765  -1.03859128]
mat_Sqrt:  [[14.55618023  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00317329 -0.01210958 -0.26998955]
Stock Position:  0.00317329295248308
Bond Position:  [6.36486675]


portfolio before change:  [6.68430168]
curr_Stock_Price:  100.41281319907073
curr_Factors:  [100.4128132   -0.97500924  -1.03935642]
mat_Sqrt:  [[13.39557139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00125189 0.00465744 0.01456657]
Stock Position:  0.0012518905923460846
Bond Position:  [6.55859582]


portfolio before change:  [6.68463387]
curr_Stock_Price:  100.02325651643443
curr_Factors:  [100.02325652  -0.87283089  -1.0478175 ]
mat_Sqrt:  [[14.65460088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00194472  0.15458204 -1.28650392]
Stock Position:  -0.0019447233944325363
Bond Position:  [6.87915144]


portfolio before change:  [6.68396145]
curr_Stock_Price:  100.81122086469566
curr_Factors:  [100.81122086  -0.55564302  -1.02624637]
mat_Sqrt:  [[20.72540584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02001781 0.06695737 0.18210636]
Stock Position:  0.020017812188298765
Bond Position:  [4.66594136]


portfolio before change:  [6.65466822]
curr_Stock_Price:  99.31872481470123
curr_Factors:  [99.31872481 -0.77790039 -1.00929734]
mat_Sqrt:  [[16.6288044   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00043152 -0.00576909  0.1719876 ]
Stock Position:  0.00043152186217017616
Bond Position:  [6.61181002]


portfolio before change:  [6.65491925]
curr_Stock_Price:  97.98509070813755
curr_Factors:  [97.98509071 -0.63544661 -1.03613341]
mat_Sqrt:  [[18.41628465  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00088806  0.0005854  -0.24193006]
Stock Position:  -0.0008880573748202042
Bond Position:  [6.74193564]


portfolio before change:  [6.6555462]
curr_Stock_Price:  98.22814861054569
curr_Factors:  [98.22814861 -0.68909966 -1.0202292 ]
mat_Sqrt:  [[17.77803963  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.81438504e-05  6.04154628e-03 -2.65902079e-02]
Stock Position:  9.81438503799639e-05
Bond Position:  [6.64590571]


portfolio before change:  [6.65643947]
curr_Stock_Price:  98.86479445614744
curr_Factors:  [98.86479446 -0.90759622 -1.02726941]
mat_Sqrt:  [[14.28039431  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00329641 -0.00487923  0.59313528]
Stock Position:  -0.003296411858094435
Bond Position:  [6.98233855]


portfolio before change:  [6.65444764]
curr_Stock_Price:  99.73382446567282
curr_Factors:  [99.73382447 -1.1508696  -1.03130322]
mat_Sqrt:  [[11.24959425  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00153126 -0.01047008  0.00620667]
Stock Position:  -0.0015312629034278746
Bond Position:  [6.80716634]


portfolio before change:  [6.65423703]
curr_Stock_Price:  100.42708124646599
curr_Factors:  [100.42708125  -0.87724389  -1.04537232]
mat_Sqrt:  [[14.6848404   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.10835705e-05 -1.64899830e-02 -5.43024076e-01]
Stock Position:  2.1083570494259114e-05
Bond Position:  [6.65211967]


portfolio before change:  [6.65506801]
curr_Stock_Price:  100.39915039560327
curr_Factors:  [100.3991504   -0.93280864  -1.01086014]
mat_Sqrt:  [[14.37491927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361347 -0.01368581  0.0670265 ]
Stock Position:  -0.0036134668992697716
Bond Position:  [7.01785701]


portfolio before change:  [6.6504264]
curr_Stock_Price:  101.92646321952894
curr_Factors:  [101.92646322  -0.92347253  -1.00363344]
mat_Sqrt:  [[14.83732013  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00375476 -0.00354574  0.08474621]
Stock Position:  -0.0037547562609841862
Bond Position:  [7.03313543]


portfolio before change:  [6.65039697]
curr_Stock_Price:  102.16845801776134
curr_Factors:  [102.16845802  -1.04067502  -0.985403  ]
mat_Sqrt:  [[13.47107752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286419 -0.0139482  -0.02929205]
Stock Position:  -0.0028641933460107926
Bond Position:  [6.94302718]


portfolio before change:  [6.65159469]
curr_Stock_Price:  102.05331438465545
curr_Factors:  [102.05331438  -1.20543918  -0.96024166]
mat_Sqrt:  [[11.70264079  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00114663 -0.00381181 -0.14247206]
Stock Position:  0.001146626301844447
Bond Position:  [6.53457768]


portfolio before change:  [6.65179798]
curr_Stock_Price:  101.51819081028655
curr_Factors:  [101.51819081  -1.0197641   -0.97770343]
mat_Sqrt:  [[13.77383083  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00290515 0.0029557  0.45300804]
Stock Position:  0.002905146980199691
Bond Position:  [6.35687271]


portfolio before change:  [6.65075005]
curr_Stock_Price:  100.88394063351336
curr_Factors:  [100.88394063  -0.9088671   -0.99744371]
mat_Sqrt:  [[14.99414722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00035099 -0.02088867  0.04582106]
Stock Position:  0.0003509892282080921
Bond Position:  [6.61534087]


portfolio before change:  [6.65173963]
curr_Stock_Price:  101.3472376419844
curr_Factors:  [101.34723764  -0.57594653  -1.0080475 ]
mat_Sqrt:  [[20.79179817  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00070178  0.01964496  0.10688647]
Stock Position:  -0.0007017770238089339
Bond Position:  [6.72286279]


portfolio before change:  [6.65295542]
curr_Stock_Price:  100.8123336942931
curr_Factors:  [100.81233369  -0.68799509  -1.04522367]
mat_Sqrt:  [[17.8150205   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.007096   0.00051525 0.4797064 ]
Stock Position:  0.007096002400536501
Bond Position:  [5.93759086]


portfolio before change:  [6.65563748]
curr_Stock_Price:  101.08570074476316
curr_Factors:  [101.08570074  -0.60238226  -1.04573368]
mat_Sqrt:  [[19.45011016  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214199  0.01116762 -0.16559349]
Stock Position:  -0.0021419859592658893
Bond Position:  [6.87216163]


portfolio before change:  [6.65992053]
curr_Stock_Price:  99.48719367086916
curr_Factors:  [99.48719367 -0.50383808 -1.01385175]
mat_Sqrt:  [[21.809357    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188777 -0.0087425   0.05265755]
Stock Position:  -0.0018877714750748285
Bond Position:  [6.84772962]


portfolio before change:  [6.66131966]
curr_Stock_Price:  99.19949800186636
curr_Factors:  [99.199498   -0.70293092 -0.99734287]
mat_Sqrt:  [[18.11715289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00623417 0.00166891 0.22837066]
Stock Position:  0.0062341668086742155
Bond Position:  [6.04289344]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.66663499]
Stock Price:  99.93093835095704
PL:  [6.66663499]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.26389794e-01 -8.36820227e-02  1.93334719e-02]
 [-1.72036833e-01  9.53444225e-02 -3.19145361e-01]
 [-1.45640633e-02  2.64559342e-02  3.61927493e-02]
 [-1.78622123e-01 -1.45404039e-01 -1.29644028e-01]
 [ 1.70976632e-01 -1.78890481e-01 -1.04435830e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.12600642e-02 -1.90642507e-01 -3.02482887e-02]
 [ 3.82065694e-03  8.23442429e-01  1.27641171e-01]
 [ 1.57567014e-01  1.47453780e-02  1.79121880e-01]
 [ 4.22570003e-01  1.80757572e-01  3.27930371e-01]
 [-1.64232330e-01 -2.14905396e-01  1.96217400e-02]
 [-5.33431893e-03 -1.56522561e-02  1.03210524e-01]
 [ 8.72207016e-03 -2.26538045e-02 -1.20884922e-01]
 [ 2.03605284e-02 -2.67813147e-02  1.44808107e-01]
 [ 2.05000754e-01 -1.97141800e-01 -1.34383163e-01]
 [-8.14765796e-02 -5.54030533e-02  8.81678233e-02]
 [ 5.37144393e-02 -1.64097218e-02  5.19889550e-02]
 [-2.97307399e-02 -4.44823203e-02  6.74215863e-02]
 [ 1.10126314e-01 -1.03356235e-01 -4.26233727e-02]
 [ 6.31530695e-02 -1.04641695e-02  2.35959822e-01]
 [-5.65715148e-03  2.39312180e-01 -2.24719213e-01]
 [ 2.59524813e-03  3.66824567e-02  1.21955311e-01]
 [-2.47226573e-02  6.28386519e-02  1.09151436e-02]
 [ 1.76673220e-01 -2.35736955e-01 -4.08075220e-01]
 [ 8.00512887e-02  5.19184769e-02 -1.67577928e-02]
 [-1.52515791e-03  1.90633238e-02  1.13760807e-02]
 [ 8.70653445e-02 -2.92688631e-02  2.92727304e-02]
 [ 1.49329118e-01 -6.49201567e-02  1.14462390e-01]
 [-4.52544799e-02 -1.53245699e-02 -3.16088509e-02]
 [-5.59405597e-02 -1.17929007e-02  3.50542320e-02]
 [-2.51144732e-02 -4.28039536e-02 -1.19018942e-02]
 [ 2.60203416e-02 -1.14061344e-02 -4.92984094e-02]
 [ 9.41295202e-02  2.64318469e-03  1.76983960e-01]
 [ 1.14472180e-02 -6.96945883e-02 -1.00075738e-02]
 [-2.46806551e-02 -1.06271048e-01  9.11792864e-02]
 [ 9.74495238e-02  3.24277888e-02  2.06748032e-01]
 [ 9.78764101e-02 -4.49087568e-02  2.20373657e-02]
 [-4.68187691e-02 -8.73235228e-03  2.47922121e-02]
 [ 9.11569448e-02  7.89190454e-03  1.06053500e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.11925882]
curr_Stock_Price:  100.59576585840193
curr_Factors:  [100.59576586  -1.23955497  -1.04186772]
mat_Sqrt:  [[10.27472998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01357942 -0.02700826  0.05515301]
Stock Position:  -0.013579421249336737
Bond Position:  [8.4852911]


portfolio before change:  [7.12059065]
curr_Stock_Price:  100.57580168125357
curr_Factors:  [100.57580168  -1.20595795  -1.03003937]
mat_Sqrt:  [[10.75009265  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02025285  0.03077228 -0.91043288]
Stock Position:  -0.020252849520065914
Bond Position:  [9.15753722]


portfolio before change:  [7.12201106]
curr_Stock_Price:  100.56219138425715
curr_Factors:  [100.56219138  -1.32251295  -1.02047147]
mat_Sqrt:  [[ 9.65805169  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018388  0.00853862  0.10324784]
Stock Position:  -0.0001838832919850922
Bond Position:  [7.14050277]


portfolio before change:  [7.12282012]
curr_Stock_Price:  101.01661088936255
curr_Factors:  [101.01661089  -1.5087644   -1.03723746]
mat_Sqrt:  [[ 7.91914392  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02964539 -0.04692895 -0.36983833]
Stock Position:  -0.029645385463964533
Bond Position:  [10.11749649]


portfolio before change:  [7.11850567]
curr_Stock_Price:  101.20480929114196
curr_Factors:  [101.20480929  -1.40481442  -0.99903371]
mat_Sqrt:  [[ 9.14583105  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01237098 -0.05773665 -0.29792635]
Stock Position:  0.012370979774458293
Bond Position:  [5.86650302]


portfolio before change:  [7.12201488]
curr_Stock_Price:  101.42919318193698
curr_Factors:  [101.42919318  -1.26358751  -1.00338344]
mat_Sqrt:  [[10.5106602   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01458559 -0.05534923  0.15513819]
Stock Position:  -0.014585591509632371
Bond Position:  [8.60141966]


portfolio before change:  [7.10466471]
curr_Stock_Price:  102.69245438621846
curr_Factors:  [102.69245439  -1.46507126  -1.0136637 ]
mat_Sqrt:  [[ 8.61068334  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0111895  -0.0615296  -0.08628995]
Stock Position:  -0.011189496266341751
Bond Position:  [8.25374154]


portfolio before change:  [7.1100651]
curr_Stock_Price:  102.30203372934085
curr_Factors:  [102.30203373  -1.60041804  -0.99994782]
mat_Sqrt:  [[ 7.59555868  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02606257 0.2657649  0.36412473]
Stock Position:  0.026062570549464245
Bond Position:  [4.44381113]


portfolio before change:  [7.09952163]
curr_Stock_Price:  101.87617463005444
curr_Factors:  [101.87617463  -1.6713718   -0.99436395]
mat_Sqrt:  [[ 7.08530093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0278238  0.00475905 0.51098487]
Stock Position:  0.02782380095406418
Bond Position:  [4.26493923]


portfolio before change:  [7.09581144]
curr_Stock_Price:  101.7236670155766
curr_Factors:  [101.72366702  -1.74901307  -0.97422134]
mat_Sqrt:  [[ 6.67938276  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0788105  0.05833926 0.93549407]
Stock Position:  0.07881049983876569
Bond Position:  [-0.9210816]


portfolio before change:  [7.09421083]
curr_Stock_Price:  101.70481847393893
curr_Factors:  [101.70481847  -1.56834196  -0.97457076]
mat_Sqrt:  [[ 7.9977637   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02551894 -0.06936042  0.05597536]
Stock Position:  -0.025518938465828447
Bond Position:  [9.68960984]


portfolio before change:  [7.07631078]
curr_Stock_Price:  102.45372605393908
curr_Factors:  [102.45372605  -1.68523926  -0.99640386]
mat_Sqrt:  [[ 7.01301788  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00178788 -0.00505174  0.2944309 ]
Stock Position:  0.001787880466329504
Bond Position:  [6.89313577]


portfolio before change:  [7.07708198]
curr_Stock_Price:  102.40310963356225
curr_Factors:  [102.40310963  -2.00844672  -1.00347579]
mat_Sqrt:  [[ 5.03792641  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00408455 -0.00731148 -0.34485103]
Stock Position:  -0.004084547490938606
Bond Position:  [7.49535235]


portfolio before change:  [7.07685127]
curr_Stock_Price:  102.68898993487173
curr_Factors:  [102.68898993  -2.19542967  -1.00793894]
mat_Sqrt:  [[ 4.17175285  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01065563 -0.00864363  0.41309722]
Stock Position:  0.010655627994837257
Bond Position:  [5.98263559]


portfolio before change:  [7.07474135]
curr_Stock_Price:  102.42079440170562
curr_Factors:  [102.4207944   -2.04436893  -1.00977954]
mat_Sqrt:  [[ 4.83045807  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02842971 -0.06362724 -0.38335776]
Stock Position:  0.028429706223304468
Bond Position:  [4.16294826]


portfolio before change:  [7.07322878]
curr_Stock_Price:  102.34928564398753
curr_Factors:  [102.34928564  -2.0692741   -1.0132551 ]
mat_Sqrt:  [[ 4.69201501  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01593953 -0.01788126  0.25151826]
Stock Position:  -0.015939526808937638
Bond Position:  [8.70462797]


portfolio before change:  [7.07635435]
curr_Stock_Price:  102.22146367363376
curr_Factors:  [102.22146367  -1.93119984  -1.01241405]
mat_Sqrt:  [[ 5.38451795  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01132451 -0.00529621  0.14831002]
Stock Position:  0.011324508613175318
Bond Position:  [5.91874651]


portfolio before change:  [7.07620915]
curr_Stock_Price:  102.14330648203277
curr_Factors:  [102.14330648  -1.8269855   -1.02971628]
mat_Sqrt:  [[ 5.86894566  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00426794 -0.01435661  0.19233502]
Stock Position:  -0.004267935544335932
Bond Position:  [7.5121502]


portfolio before change:  [7.07636446]
curr_Stock_Price:  102.32694749947726
curr_Factors:  [102.3269475   -1.94885799  -1.04010354]
mat_Sqrt:  [[ 5.15110639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01559439 -0.03335808 -0.12159262]
Stock Position:  0.015594387950995204
Bond Position:  [5.48063834]


portfolio before change:  [7.07906093]
curr_Stock_Price:  102.45592622777852
curr_Factors:  [102.45592623  -2.14369988  -1.00176716]
mat_Sqrt:  [[ 4.41040127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02475561 -0.0033773   0.67312769]
Stock Position:  0.02475561063873593
Bond Position:  [4.54270191]


portfolio before change:  [7.07484542]
curr_Stock_Price:  102.26270217775561
curr_Factors:  [102.26270218  -2.07599362  -0.97774127]
mat_Sqrt:  [[ 4.82499707  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.55103906e-04  7.72376738e-02 -6.41061366e-01]
Stock Position:  -0.0005551039063769561
Bond Position:  [7.13161184]


portfolio before change:  [7.07569796]
curr_Stock_Price:  102.3329010779912
curr_Factors:  [102.33290108  -1.99231277  -0.95106566]
mat_Sqrt:  [[ 5.39165725  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00648725 0.01183921 0.34790456]
Stock Position:  0.006487253399373254
Bond Position:  [6.4118385]


portfolio before change:  [7.07684255]
curr_Stock_Price:  102.3857836154512
curr_Factors:  [102.38578362  -1.82321102  -0.94432571]
mat_Sqrt:  [[ 6.43152151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00150318  0.02028109  0.03113787]
Stock Position:  -0.0015031788008450957
Bond Position:  [7.23074669]


portfolio before change:  [7.07764825]
curr_Stock_Price:  102.45111286418943
curr_Factors:  [102.45111286  -1.97095872  -0.93270509]
mat_Sqrt:  [[ 5.61657432  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00805751 -0.07608377 -1.16412502]
Stock Position:  0.008057511070945739
Bond Position:  [6.25214727]


portfolio before change:  [7.08094418]
curr_Stock_Price:  102.7631652026533
curr_Factors:  [102.7631652   -2.37482465  -0.92223781]
mat_Sqrt:  [[ 3.80138137  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02294651  0.01675662 -0.04780532]
Stock Position:  0.02294650939069567
Bond Position:  [4.72288825]


portfolio before change:  [7.08455592]
curr_Stock_Price:  102.89483423511275
curr_Factors:  [102.89483424  -2.49171276  -0.94080254]
mat_Sqrt:  [[ 3.32407735  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00141039 0.00615266 0.03245279]
Stock Position:  0.0014103942316740239
Bond Position:  [6.93943364]


portfolio before change:  [7.08509436]
curr_Stock_Price:  102.66153322564783
curr_Factors:  [102.66153323  -2.48929595  -0.9328551 ]
mat_Sqrt:  [[ 3.35109261  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02598142 -0.00944648  0.08350695]
Stock Position:  0.02598141680390904
Bond Position:  [4.41780228]


portfolio before change:  [7.08262082]
curr_Stock_Price:  102.5450731311707
curr_Factors:  [102.54507313  -2.2535455   -0.95088624]
mat_Sqrt:  [[ 4.16147965  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03831375 -0.02095289  0.32652934]
Stock Position:  0.03831374844357188
Bond Position:  [3.15373469]


portfolio before change:  [7.10192317]
curr_Stock_Price:  103.0385802195695
curr_Factors:  [103.03858022  -2.16747987  -0.96239845]
mat_Sqrt:  [[ 4.50516792  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01217152 -0.00494598 -0.09017125]
Stock Position:  -0.012171516202210962
Bond Position:  [8.35605892]


portfolio before change:  [7.10200121]
curr_Stock_Price:  103.11798941552483
curr_Factors:  [103.11798942  -2.2442201   -0.97085488]
mat_Sqrt:  [[ 4.14042682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01236403 -0.00380614  0.09999997]
Stock Position:  -0.012364029732760245
Bond Position:  [8.3769551]


portfolio before change:  [7.10494475]
curr_Stock_Price:  102.96461297922149
curr_Factors:  [102.96461298  -2.05550209  -0.96829824]
mat_Sqrt:  [[ 5.0057389   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00724793 -0.01381492 -0.03395279]
Stock Position:  -0.007247932493262962
Bond Position:  [7.85122531]


portfolio before change:  [7.1073741]
curr_Stock_Price:  102.76484803848352
curr_Factors:  [102.76484804  -1.93540242  -0.9439379 ]
mat_Sqrt:  [[ 5.77248713  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00236104 -0.00368131 -0.14063464]
Stock Position:  0.0023610409531561387
Bond Position:  [6.86474208]


portfolio before change:  [7.10758131]
curr_Stock_Price:  102.48914935712612
curr_Factors:  [102.48914936  -1.73637612  -0.95308783]
mat_Sqrt:  [[ 6.96079007  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01879036 0.00085308 0.50488598]
Stock Position:  0.018790360895752315
Bond Position:  [5.1817732]


portfolio before change:  [7.09932313]
curr_Stock_Price:  102.0151861075485
curr_Factors:  [102.01518611  -1.89210728  -0.94144781]
mat_Sqrt:  [[ 5.99884289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00080381 -0.02249383 -0.02854882]
Stock Position:  -0.0008038079662764949
Bond Position:  [7.18132375]


portfolio before change:  [7.10023284]
curr_Stock_Price:  102.000267434264
curr_Factors:  [102.00026743  -1.93184363  -0.93214932]
mat_Sqrt:  [[ 5.81815081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00477149 -0.03429883  0.26010912]
Stock Position:  -0.004771489918272126
Bond Position:  [7.58692609]


portfolio before change:  [7.10186265]
curr_Stock_Price:  101.85746404464945
curr_Factors:  [101.85746404  -1.8688537   -0.95404365]
mat_Sqrt:  [[ 6.05374491  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02416208 0.01046602 0.58979459]
Stock Position:  0.02416208248081726
Bond Position:  [4.6407742]


portfolio before change:  [7.09362388]
curr_Stock_Price:  101.49247469795284
curr_Factors:  [101.4924747   -1.48557771  -0.9641639 ]
mat_Sqrt:  [[ 8.76041292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01063966 -0.01449424  0.06286647]
Stock Position:  0.010639659089497948
Bond Position:  [6.01377855]


portfolio before change:  [7.09708909]
curr_Stock_Price:  101.74750572904891
curr_Factors:  [101.74750573  -1.67708505  -0.95541314]
mat_Sqrt:  [[ 7.31550537  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00595182 -0.00281835  0.07072528]
Stock Position:  -0.005951819006391671
Bond Position:  [7.70267183]


portfolio before change:  [7.09755299]
curr_Stock_Price:  101.83134471604231
curr_Factors:  [101.83134472  -1.71150212  -0.9578519 ]
mat_Sqrt:  [[ 7.05660418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01621402 0.0025471  0.30254112]
Stock Position:  0.01621402452398424
Bond Position:  [5.44645707]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.0978065]
Stock Price:  101.80498828001731
PL:  [5.29281822]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-4.12462773e-02 -8.26712487e-02  1.29035922e-02]
 [-1.82045211e-01  7.53650391e-02 -2.34396078e-01]
 [-3.65813064e-02  5.25424697e-02  2.37162958e-02]
 [ 1.02199267e-01  6.99166438e-02  9.68177174e-02]
 [-2.84586640e-02  1.30864548e-01 -5.31277206e-02]
 [-6.72386997e-02 -1.48749097e-01  1.73854022e-01]
 [-6.18515875e-02 -1.66812173e-01  7.54870763e-02]
 [-1.84504587e-03  7.59245730e-01  1.21530081e-01]
 [ 8.53932247e-02  2.12630614e-02  6.77624600e-02]
 [ 4.19934121e-01  1.60549530e-01  2.64035931e-01]
 [-2.38583988e-01 -2.64113013e-01  1.19037582e-02]
 [ 3.74497523e-02 -1.33721988e-02  1.12926446e-01]
 [ 1.33320193e-02 -3.72802332e-02  4.06147302e-02]
 [ 1.06977022e-02 -1.25160388e-01  7.21676484e-03]
 [ 1.05980537e-01 -1.34475785e-01 -1.00317465e-01]
 [ 5.38442197e-02 -1.70707621e-02  3.26204894e-02]
 [ 4.60867603e-02  2.65697235e-02  3.53018009e-03]
 [-4.28897070e-02 -5.24489599e-02  4.84224901e-02]
 [ 8.48533081e-02 -5.43064359e-02 -7.97813290e-02]
 [ 3.75770594e-02 -1.15203519e-02  1.88113628e-01]
 [-4.12673699e-02  5.42852318e-01 -5.28483062e-01]
 [ 1.74065414e-01  1.18730353e-01  9.40326026e-02]
 [ 1.82458950e-02  1.43068859e-01 -4.00618723e-02]
 [-4.48510042e-02 -1.49995243e-01 -3.29573563e-02]
 [ 3.09004463e-02 -1.63674725e-02 -1.11317510e-02]
 [-2.00189857e-02  1.37292852e-02  5.37650318e-02]
 [ 8.78892523e-02 -2.52993013e-02  6.00775257e-02]
 [ 1.63450115e-01 -5.64990417e-02  1.91331964e-01]
 [-3.83675990e-02  1.17643371e-02 -8.36137351e-02]
 [-5.79729269e-02 -1.34177242e-02  4.15553178e-02]
 [ 3.25143014e-02 -2.99281553e-02 -1.10649555e-02]
 [ 2.65844985e-02 -7.68387556e-02 -1.53531896e-01]
 [ 9.62966722e-02 -2.87912351e-03  1.67057421e-01]
 [-8.30852330e-04 -9.29631493e-02 -1.70281159e-01]
 [ 3.99582116e-02  1.76718771e-01 -6.20276113e-02]
 [-9.33544214e-03 -1.01775245e-02  4.60541215e-02]
 [ 4.83060378e-01 -2.81255998e-01  3.12501098e-01]
 [-1.12461227e-01  4.81393803e-02  4.70911400e-02]
 [ 2.64977924e-01 -2.65982053e-02  7.11082122e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.73458813]
curr_Stock_Price:  100.04297970425813
curr_Factors:  [100.0429797   -1.10404129  -0.99273413]
mat_Sqrt:  [[12.29047376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00451468 -0.02668203  0.03681036]
Stock Position:  -0.0045146787359385725
Bond Position:  [3.18625005]


portfolio before change:  [2.73534907]
curr_Stock_Price:  99.96265672440262
curr_Factors:  [99.96265672 -1.14076754 -0.99424249]
mat_Sqrt:  [[11.81992479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01814794  0.02432396 -0.66866677]
Stock Position:  -0.018147939993030354
Bond Position:  [4.54946537]


portfolio before change:  [2.74685797]
curr_Stock_Price:  99.35982382177258
curr_Factors:  [99.35982382 -1.16393335 -0.97456036]
mat_Sqrt:  [[11.70778655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00179496  0.01695801  0.06765599]
Stock Position:  -0.0017949636331968401
Bond Position:  [2.92520524]


portfolio before change:  [2.74884483]
curr_Stock_Price:  98.45663783673301
curr_Factors:  [98.45663784 -1.11177084 -0.95179177]
mat_Sqrt:  [[12.50406287  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01089516 0.0225655  0.276194  ]
Stock Position:  0.010895160841141956
Bond Position:  [1.67614392]


portfolio before change:  [2.75590844]
curr_Stock_Price:  99.08573231173669
curr_Factors:  [99.08573231 -1.29766828 -0.96387906]
mat_Sqrt:  [[10.32365767  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012196   0.04223635 -0.1515586 ]
Stock Position:  -0.0012195968596138789
Bond Position:  [2.87675309]


portfolio before change:  [2.75649378]
curr_Stock_Price:  98.90065545465056
curr_Factors:  [98.90065545 -0.81604756 -0.95359879]
mat_Sqrt:  [[16.85200299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00368586 -0.04800856  0.49595713]
Stock Position:  -0.0036858632362169056
Bond Position:  [3.12102807]


portfolio before change:  [2.75514911]
curr_Stock_Price:  99.37132532879453
curr_Factors:  [99.37132533 -0.80005228 -0.98387251]
mat_Sqrt:  [[16.69215416  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00482222 -0.0538384   0.21534362]
Stock Position:  -0.004822220304931884
Bond Position:  [3.23433953]


portfolio before change:  [2.75856702]
curr_Stock_Price:  98.74638537603371
curr_Factors:  [98.74638538 -0.90736482 -0.95902019]
mat_Sqrt:  [[15.27427109  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01164982 0.24504551 0.34669149]
Stock Position:  0.011649823587327187
Bond Position:  [1.60818905]


portfolio before change:  [2.76330429]
curr_Stock_Price:  99.13576773239609
curr_Factors:  [99.13576773 -1.11757214 -0.96245908]
mat_Sqrt:  [[12.38466587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0083624  0.00686262 0.19330744]
Stock Position:  0.00836239622779074
Bond Position:  [1.93429172]


portfolio before change:  [2.7728927]
curr_Stock_Price:  100.2534628313487
curr_Factors:  [100.25346283  -0.96964958  -0.95233956]
mat_Sqrt:  [[14.6686487   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0345364  0.05181714 0.75322102]
Stock Position:  0.03453639636002681
Bond Position:  [-0.68950062]


portfolio before change:  [2.75079054]
curr_Stock_Price:  99.61599110587277
curr_Factors:  [99.61599111 -0.99817456 -0.92827078]
mat_Sqrt:  [[14.51057036  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01998998 -0.08524211  0.03395811]
Stock Position:  -0.019989978305247305
Bond Position:  [4.74211204]


portfolio before change:  [2.75513188]
curr_Stock_Price:  99.42847021225508
curr_Factors:  [99.42847021 -1.36168738 -0.95985392]
mat_Sqrt:  [[ 9.75614354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00592152 -0.00431586  0.32214772]
Stock Position:  0.005921517820319109
Bond Position:  [2.16636442]


portfolio before change:  [2.76158603]
curr_Stock_Price:  100.47268642195829
curr_Factors:  [100.47268642  -1.57128217  -1.00520018]
mat_Sqrt:  [[ 7.64004553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00183411 -0.01203214  0.11586252]
Stock Position:  0.0018341082628662482
Bond Position:  [2.57730825]


portfolio before change:  [2.7616281]
curr_Stock_Price:  100.31995750049342
curr_Factors:  [100.3199575   -1.55492944  -0.99478319]
mat_Sqrt:  [[ 7.83540074  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170731 -0.04039534  0.02058742]
Stock Position:  -0.001707307589800597
Bond Position:  [2.93290512]


portfolio before change:  [2.76080587]
curr_Stock_Price:  101.01629358656078
curr_Factors:  [101.01629359  -1.5831611   -1.00097825]
mat_Sqrt:  [[ 7.6227903   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00761579 -0.04340187 -0.28617781]
Stock Position:  0.007615789397866546
Bond Position:  [1.99148705]


portfolio before change:  [2.75913104]
curr_Stock_Price:  100.76368856232742
curr_Factors:  [100.76368856  -1.44631586  -1.01770074]
mat_Sqrt:  [[ 8.57423229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00664996 -0.00550956  0.09305718]
Stock Position:  0.0066499591539327055
Bond Position:  [2.08905662]


portfolio before change:  [2.76185448]
curr_Stock_Price:  101.13396035713573
curr_Factors:  [101.13396036  -1.34665246  -1.05381196]
mat_Sqrt:  [[ 9.17040602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00569559 0.00857534 0.01007062]
Stock Position:  0.005695590498990544
Bond Position:  [2.18583685]


portfolio before change:  [2.76107336]
curr_Stock_Price:  100.9488416723868
curr_Factors:  [100.94884167  -1.04750185  -1.10021028]
mat_Sqrt:  [[11.78587448  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00370881 -0.01692783  0.13813589]
Stock Position:  -0.0037088131872272598
Bond Position:  [3.13547376]


portfolio before change:  [2.75946393]
curr_Stock_Price:  101.48847435056929
curr_Factors:  [101.48847435  -0.8014465   -1.11405239]
mat_Sqrt:  [[14.94603955  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00384602 -0.01752733 -0.22759392]
Stock Position:  0.003846019378897002
Bond Position:  [2.36913729]


portfolio before change:  [2.76532884]
curr_Stock_Price:  102.93640179874899
curr_Factors:  [102.9364018   -0.93680556  -1.11202975]
mat_Sqrt:  [[13.26695068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00554943 -0.00371818  0.53663582]
Stock Position:  0.005549429761626044
Bond Position:  [2.19409051]


portfolio before change:  [2.76166677]
curr_Stock_Price:  102.22707633199755
curr_Factors:  [102.22707633  -0.6066313   -1.10005472]
mat_Sqrt:  [[18.55075617  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00206645  0.17520483 -1.50761507]
Stock Position:  -0.0020664525684732944
Bond Position:  [2.97291417]


portfolio before change:  [2.76018756]
curr_Stock_Price:  103.12273986322171
curr_Factors:  [103.12273986  -0.93303095  -1.10485214]
mat_Sqrt:  [[13.43733242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01618591 0.03832006 0.26824884]
Stock Position:  0.0161859112930148
Bond Position:  [1.09105204]


portfolio before change:  [2.76033985]
curr_Stock_Price:  103.12372237756907
curr_Factors:  [103.12372238  -0.76482091  -1.0952952 ]
mat_Sqrt:  [[16.05167719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0024466   0.04617528 -0.11428537]
Stock Position:  0.0024466046453678046
Bond Position:  [2.50803688]


portfolio before change:  [2.76000769]
curr_Stock_Price:  102.85980963976327
curr_Factors:  [102.85980964  -0.57098565  -1.10588246]
mat_Sqrt:  [[19.23052542  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00427425 -0.04841076 -0.09401816]
Stock Position:  -0.004274248636787508
Bond Position:  [3.19965609]


portfolio before change:  [2.75757948]
curr_Stock_Price:  103.52149025227173
curr_Factors:  [103.52149025  -0.60672063  -1.08435645]
mat_Sqrt:  [[19.08117296  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00132524 -0.00528258 -0.03175579]
Stock Position:  0.001325242996574012
Bond Position:  [2.62038835]


portfolio before change:  [2.75860237]
curr_Stock_Price:  104.04616192818162
curr_Factors:  [104.04616193  -0.45245192  -1.06732942]
mat_Sqrt:  [[22.76110896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027423  0.00443111  0.15337667]
Stock Position:  -0.0002742294295146896
Bond Position:  [2.78713489]


portfolio before change:  [2.75885662]
curr_Stock_Price:  104.38954622183319
curr_Factors:  [104.38954622  -0.66460965  -1.08673461]
mat_Sqrt:  [[18.11581438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00524339 -0.00816531  0.17138446]
Stock Position:  0.005243392632623367
Bond Position:  [2.21150124]


portfolio before change:  [2.75985964]
curr_Stock_Price:  104.52811510018154
curr_Factors:  [104.5281151   -0.64427556  -1.1009263 ]
mat_Sqrt:  [[18.25162687  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01046333 -0.01823499  0.54581684]
Stock Position:  0.01046332865654135
Bond Position:  [1.66614762]


portfolio before change:  [2.77479417]
curr_Stock_Price:  105.93552987213606
curr_Factors:  [105.93552987  -0.7379932   -1.08540986]
mat_Sqrt:  [[17.10597201  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00310031  0.00379692 -0.23852671]
Stock Position:  -0.0031003088247563808
Bond Position:  [3.10322703]


portfolio before change:  [2.77748637]
curr_Stock_Price:  105.19229044673943
curr_Factors:  [105.19229045  -0.81875307  -1.07796452]
mat_Sqrt:  [[15.78519414  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330876 -0.00433055  0.11854575]
Stock Position:  -0.0033087565624690396
Bond Position:  [3.12554205]


portfolio before change:  [2.77198102]
curr_Stock_Price:  106.97424925951434
curr_Factors:  [106.97424926  -0.93717015  -1.10261938]
mat_Sqrt:  [[13.91265156  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00173559 -0.00965927 -0.03156524]
Stock Position:  0.0017355870382572342
Bond Position:  [2.5863179]


portfolio before change:  [2.77092157]
curr_Stock_Price:  106.17753953887963
curr_Factors:  [106.17753954  -0.97541367  -1.08944791]
mat_Sqrt:  [[13.46711812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00151775 -0.0247996  -0.43798376]
Stock Position:  -0.0015177496482945935
Bond Position:  [2.93207249]


portfolio before change:  [2.77151038]
curr_Stock_Price:  106.03108376680527
curr_Factors:  [106.03108377  -1.27513883  -1.0652326 ]
mat_Sqrt:  [[10.20993091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01271404 -0.00092923  0.47656832]
Stock Position:  0.012714035774698715
Bond Position:  [1.42342739]


portfolio before change:  [2.76361053]
curr_Stock_Price:  105.39573967118339
curr_Factors:  [105.39573967  -1.40657605  -1.04949577]
mat_Sqrt:  [[ 9.03992064  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00603605 -0.03000373 -0.48576475]
Stock Position:  -0.0060360454306423485
Bond Position:  [3.39978401]


portfolio before change:  [2.76251146]
curr_Stock_Price:  105.6482344614893
curr_Factors:  [105.64823446  -1.21399914  -1.09407207]
mat_Sqrt:  [[10.50702236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00603115  0.05703574 -0.17694751]
Stock Position:  0.0060311517704615914
Bond Position:  [2.12533093]


portfolio before change:  [2.77062511]
curr_Stock_Price:  106.94947215666514
curr_Factors:  [106.94947216  -1.38592568  -1.07793696]
mat_Sqrt:  [[ 9.10199711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00022107 -0.00328478  0.13137959]
Stock Position:  -0.00022106823616473625
Bond Position:  [2.79426824]


portfolio before change:  [2.77092486]
curr_Stock_Price:  107.17362994630643
curr_Factors:  [107.17362995  -1.1852582   -1.08038689]
mat_Sqrt:  [[11.12066563  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0440116  -0.09077498  0.89147865]
Stock Position:  0.044011597293315066
Bond Position:  [-1.94595778]


portfolio before change:  [2.72872424]
curr_Stock_Price:  106.22030495167874
curr_Factors:  [106.22030495  -1.01198706  -1.08445551]
mat_Sqrt:  [[13.05371429  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00712612  0.01553692  0.13433791]
Stock Position:  -0.007126123332925041
Bond Position:  [3.48566324]


portfolio before change:  [2.73213182]
curr_Stock_Price:  105.80326984979287
curr_Factors:  [105.80326985  -0.79138884  -1.07649885]
mat_Sqrt:  [[16.34126881  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01677125 -0.00858453  0.20285194]
Stock Position:  0.016771249175075862
Bond Position:  [0.95767882]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.72878632]
Stock Price:  105.59665295216016
PL:  [-2.86786664]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-3.22945730e-01 -1.10672235e-01  2.63560741e-02]
 [-6.74311248e-02  7.36771816e-02 -5.88148123e-02]
 [-7.72173370e-03  1.92142153e-02  4.10296255e-02]
 [ 1.13895159e-02 -1.10494260e-02  6.28504891e-02]
 [ 1.46081676e-01 -1.42118401e-01 -9.96287010e-02]
 [-1.29702115e-01 -1.88736381e-01 -6.45567584e-02]
 [-5.14397281e-02 -2.08096691e-01 -2.83648170e-02]
 [ 8.13959827e-03  6.37465357e-01  9.72310147e-02]
 [ 6.04718596e-01  1.28271789e-01  5.64603230e-01]
 [ 7.76804122e-01  3.49419677e-01  6.94595989e-01]
 [-1.39560741e-01 -2.15345723e-01  2.18583247e-03]
 [-1.02926416e-01 -2.29546182e-02  7.98005215e-02]
 [ 1.41569284e-02 -9.55941145e-02  1.24291335e-01]
 [-3.43335845e-04  2.19225092e-01 -1.73185349e-01]
 [ 4.95298258e-01 -1.35281024e-01 -2.33219074e-01]
 [-1.76633684e-01 -9.43129509e-02  1.11625150e-01]
 [ 5.15138478e-02  1.68294466e-02 -2.82115826e-02]
 [-6.51811290e-02 -6.56347921e-02  1.66833835e-02]
 [ 1.29932929e-01 -1.52696994e-01 -1.20149317e-02]
 [ 3.48069319e-02 -1.16519625e-02  1.82607863e-01]
 [-3.99022082e-02  5.32736362e-01 -5.17849147e-01]
 [ 4.17296010e-01  2.35115373e-01  5.44242141e-02]
 [ 2.70581163e-02  1.33773313e-01 -3.07351504e-02]
 [ 2.46588759e-03 -1.46195772e-01 -1.26366750e-01]
 [ 5.24938004e-02  2.09850342e-02 -1.36918710e-02]
 [-4.56012616e-02  5.65356898e-03  1.10958572e-01]
 [-7.90683864e-03 -3.25806796e-02  1.42455812e-03]
 [-7.11706891e-02  6.14473815e-02 -2.04191321e-01]
 [ 3.51652220e-05 -3.95266689e-02  6.82792123e-02]
 [-3.74033559e-02  1.77255237e-02 -1.02474489e-02]
 [ 1.20927597e-02 -3.56685004e-02 -5.05243650e-02]
 [ 1.39471518e-02  1.39563923e-01 -1.10452687e-01]
 [-3.85871939e-02  2.77065888e-02 -1.18166171e-01]
 [ 4.05317633e-02 -3.22679097e-02  1.79771955e-01]
 [-7.27245860e-02  4.53127461e-03 -3.07157890e-02]
 [-1.63917727e-01 -1.77498410e-01 -1.49566587e-01]
 [ 1.14130845e-01  9.76956045e-02  2.41987482e-01]
 [ 2.03820928e-01 -1.38459557e-01 -2.39149344e-01]
 [ 9.75442755e-02  3.93479192e-03  6.82417720e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.60014267]
curr_Stock_Price:  101.03460939718134
curr_Factors:  [101.0346094   -0.97455302  -0.97567953]
mat_Sqrt:  [[14.37126274  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02366923 -0.03571931  0.07518654]
Stock Position:  -0.023669227991616512
Bond Position:  [12.99155388]


portfolio before change:  [10.60841047]
curr_Stock_Price:  100.75391777935596
curr_Factors:  [100.75391778  -0.89188362  -0.9450514 ]
mat_Sqrt:  [[16.0505974   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00401215  0.02377921 -0.16778229]
Stock Position:  -0.004012147007770543
Bond Position:  [11.01265]


portfolio before change:  [10.61111695]
curr_Stock_Price:  100.42247305980575
curr_Factors:  [100.42247306  -0.86286801  -0.9287039 ]
mat_Sqrt:  [[16.74021835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00027332 0.00620136 0.1170461 ]
Stock Position:  0.00027332312488629457
Bond Position:  [10.58366916]


portfolio before change:  [10.61252153]
curr_Stock_Price:  100.72081393043806
curr_Factors:  [100.72081393  -1.02402278  -0.93878416]
mat_Sqrt:  [[14.14760757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00155244 -0.00356619  0.17929495]
Stock Position:  0.0015524436567052225
Bond Position:  [10.45615814]


portfolio before change:  [10.61471582]
curr_Stock_Price:  101.29229093517344
curr_Factors:  [101.29229094  -0.68392039  -0.95200994]
mat_Sqrt:  [[19.72880937  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00490325 -0.04586852 -0.28421295]
Stock Position:  0.004903248545871043
Bond Position:  [10.11805454]


portfolio before change:  [10.6241448]
curr_Stock_Price:  102.95733924552596
curr_Factors:  [102.95733925  -0.50640372  -0.969576  ]
mat_Sqrt:  [[23.53138351  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00770908 -0.06091441 -0.18416246]
Stock Position:  -0.007709081826797955
Bond Position:  [11.41785135]


portfolio before change:  [10.62602787]
curr_Stock_Price:  102.89822018999791
curr_Factors:  [102.89822019  -0.49545771  -0.99190625]
mat_Sqrt:  [[23.25165681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00428818 -0.06716292 -0.08091693]
Stock Position:  -0.00428817749023795
Bond Position:  [11.06727371]


portfolio before change:  [10.62663199]
curr_Stock_Price:  103.0799699432286
curr_Factors:  [103.07996994  -0.51646852  -0.98991492]
mat_Sqrt:  [[22.85389719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00691825 0.20574106 0.27737302]
Stock Position:  0.006918245314226207
Bond Position:  [9.91349948]


portfolio before change:  [10.63257175]
curr_Stock_Price:  103.75940386802866
curr_Factors:  [103.75940387  -0.50425664  -0.99252149]
mat_Sqrt:  [[23.22656484  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0321249  0.04139954 1.61065586]
Stock Position:  0.03212490191780003
Bond Position:  [7.29931108]


portfolio before change:  [10.62685459]
curr_Stock_Price:  103.55303339753199
curr_Factors:  [103.5530334   -0.50393019  -0.99929123]
mat_Sqrt:  [[23.03149126  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04298084 0.11277472 1.98148902]
Stock Position:  0.042980843759277944
Bond Position:  [6.17605784]


portfolio before change:  [10.6060618]
curr_Stock_Price:  103.05130182570919
curr_Factors:  [103.05130183  -0.3791552   -1.02270623]
mat_Sqrt:  [[25.36487933  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00721753 -0.06950253  0.00623557]
Stock Position:  -0.0072175317247844435
Bond Position:  [11.34983784]


portfolio before change:  [10.5958367]
curr_Stock_Price:  104.66458390466313
curr_Factors:  [104.6645839   -0.5025471   -1.01536245]
mat_Sqrt:  [[22.93929204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00398106 -0.00740857  0.22764868]
Stock Position:  -0.0039810642187130246
Bond Position:  [11.01251313]


portfolio before change:  [10.59754739]
curr_Stock_Price:  104.58067791482242
curr_Factors:  [104.58067791  -0.45482245  -1.03477305]
mat_Sqrt:  [[23.57916097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00084883 -0.03085287  0.35456858]
Stock Position:  0.0008488310488565283
Bond Position:  [10.50877606]


portfolio before change:  [10.59825353]
curr_Stock_Price:  103.86494233817508
curr_Factors:  [103.86494234  -0.57570509  -1.02454136]
mat_Sqrt:  [[20.96480281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.31889930e-04  7.07545941e-02 -4.94049596e-01]
Stock Position:  0.0004318899302758463
Bond Position:  [10.55339531]


portfolio before change:  [10.5998338]
curr_Stock_Price:  104.46929676887834
curr_Factors:  [104.46929677  -0.68170083  -1.00033077]
mat_Sqrt:  [[19.43084234  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02161916 -0.04366176 -0.6653091 ]
Stock Position:  0.02161916004282306
Bond Position:  [8.34129535]


portfolio before change:  [10.61828214]
curr_Stock_Price:  105.27439814388242
curr_Factors:  [105.27439814  -0.6063438   -1.02889343]
mat_Sqrt:  [[20.51862537  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00843623 -0.03043937  0.31843548]
Stock Position:  -0.008436230155919698
Bond Position:  [11.5064012]


portfolio before change:  [10.62074167]
curr_Stock_Price:  105.15335620206362
curr_Factors:  [105.1533562   -0.42032001  -1.0108871 ]
mat_Sqrt:  [[25.13377889  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00195715  0.00543168 -0.08047979]
Stock Position:  0.001957146168869472
Bond Position:  [10.41494118]


portfolio before change:  [10.62131133]
curr_Stock_Price:  104.77919451996353
curr_Factors:  [104.77919452  -0.54858342  -0.98584053]
mat_Sqrt:  [[22.58828186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332798 -0.02118354  0.04759305]
Stock Position:  -0.0033279774826183058
Bond Position:  [10.97001413]


portfolio before change:  [10.6273117]
curr_Stock_Price:  103.38824894421745
curr_Factors:  [103.38824894  -0.55404222  -0.96486504]
mat_Sqrt:  [[22.63696195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0042546  -0.04928274 -0.03427526]
Stock Position:  0.004254601312443055
Bond Position:  [10.18743592]


portfolio before change:  [10.62672588]
curr_Stock_Price:  102.95123311439085
curr_Factors:  [102.95123311  -0.65515331  -0.96216757]
mat_Sqrt:  [[20.42857252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00341204 -0.00376065  0.5209294 ]
Stock Position:  0.003412042564695007
Bond Position:  [10.2754519]


portfolio before change:  [10.62899276]
curr_Stock_Price:  103.23914269213186
curr_Factors:  [103.23914269  -0.61626041  -0.95866545]
mat_Sqrt:  [[21.37286691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172477  0.17193992 -1.47727948]
Stock Position:  -0.0017247741444042445
Bond Position:  [10.80705696]


portfolio before change:  [10.63068983]
curr_Stock_Price:  103.03847449496114
curr_Factors:  [103.03847449  -0.78455148  -0.93574269]
mat_Sqrt:  [[18.44527592  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02582764 0.07588316 0.15525713]
Stock Position:  0.025827644587139476
Bond Position:  [7.96944873]


portfolio before change:  [10.62165199]
curr_Stock_Price:  102.64997288376817
curr_Factors:  [102.64997288  -0.68504512  -0.9117868 ]
mat_Sqrt:  [[20.79043365  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00231312  0.04317515 -0.08767883]
Stock Position:  0.00231311640452087
Bond Position:  [10.38421066]


portfolio before change:  [10.62086002]
curr_Stock_Price:  101.74639515941526
curr_Factors:  [101.74639516  -0.71316752  -0.90867098]
mat_Sqrt:  [[20.09849423  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264551 -0.04718448 -0.36048916]
Stock Position:  -0.002645506851742504
Bond Position:  [10.8900308]


portfolio before change:  [10.62205796]
curr_Stock_Price:  101.80816071365994
curr_Factors:  [101.80816071  -0.72239043  -0.88344216]
mat_Sqrt:  [[20.43517485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00264165  0.00677289 -0.0390591 ]
Stock Position:  0.0026416466471949293
Bond Position:  [10.35311677]


portfolio before change:  [10.62415965]
curr_Stock_Price:  102.11383210498144
curr_Factors:  [102.1138321   -0.6650061   -0.89654589]
mat_Sqrt:  [[21.42452299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101743  0.00182468  0.31653392]
Stock Position:  -0.001017427925484404
Bond Position:  [10.72805312]


portfolio before change:  [10.62712969]
curr_Stock_Price:  100.51278878015064
curr_Factors:  [100.51278878  -0.59178842  -0.85253641]
mat_Sqrt:  [[23.7114994   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060167 -0.01051537  0.00406387]
Stock Position:  -0.0006016724235196026
Bond Position:  [10.68760546]


portfolio before change:  [10.62985168]
curr_Stock_Price:  98.209289806043
curr_Factors:  [98.20928981 -0.47166833 -0.87095107]
mat_Sqrt:  [[25.64840572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00391089  0.01983206 -0.582501  ]
Stock Position:  -0.003910893126091855
Bond Position:  [11.01393771]


portfolio before change:  [10.63318855]
curr_Stock_Price:  97.70811438445385
curr_Factors:  [97.70811438 -0.71086141 -0.87017936]
mat_Sqrt:  [[20.10450331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00029368 -0.01275718  0.19478159]
Stock Position:  0.00029367816150070486
Bond Position:  [10.60449381]


portfolio before change:  [10.63474539]
curr_Stock_Price:  98.49537672882077
curr_Factors:  [98.49537673 -0.82923934 -0.88485737]
mat_Sqrt:  [[17.7416131   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202219  0.00572089 -0.02923312]
Stock Position:  -0.0020221893083026796
Bond Position:  [10.83392169]


portfolio before change:  [10.63771359]
curr_Stock_Price:  97.69729654531999
curr_Factors:  [97.69729655 -0.95261215 -0.8595096 ]
mat_Sqrt:  [[15.95467898  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034481 -0.01151196 -0.14413195]
Stock Position:  -0.0003448070205101392
Bond Position:  [10.6714003]


portfolio before change:  [10.63920007]
curr_Stock_Price:  97.25510065337947
curr_Factors:  [97.25510065 -0.44250542 -0.8802922 ]
mat_Sqrt:  [[25.90768929  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0007677   0.04504406 -0.31509077]
Stock Position:  0.000767704821775283
Bond Position:  [10.56453686]


portfolio before change:  [10.64116705]
curr_Stock_Price:  98.09700403724773
curr_Factors:  [98.09700404 -0.33218551 -0.88050754]
mat_Sqrt:  [[29.17358774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195561  0.00894226 -0.33709519]
Stock Position:  -0.0019556106429026356
Bond Position:  [10.8330066]


portfolio before change:  [10.64456707]
curr_Stock_Price:  97.0508796399599
curr_Factors:  [97.05087964 -0.43537608 -0.89594089]
mat_Sqrt:  [[25.63396952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00275575 -0.01041442  0.51283935]
Stock Position:  0.0027557534684404888
Bond Position:  [10.37711878]


portfolio before change:  [10.64245813]
curr_Stock_Price:  95.81485940916599
curr_Factors:  [95.81485941 -0.67919093 -0.89975238]
mat_Sqrt:  [[19.75634054  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00395162  0.00146246 -0.0876236 ]
Stock Position:  -0.003951616315997013
Bond Position:  [11.02108169]


portfolio before change:  [10.64953621]
curr_Stock_Price:  94.37232033015532
curr_Factors:  [94.37232033 -0.83706479 -0.87676784]
mat_Sqrt:  [[17.00343167  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01356665 -0.05728737 -0.42667184]
Stock Position:  -0.013566649044831633
Bond Position:  [11.92985236]


portfolio before change:  [10.64934888]
curr_Stock_Price:  94.49605435851454
curr_Factors:  [94.49605436 -0.95879175 -0.86510006]
mat_Sqrt:  [[15.25132332  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01202967 0.03153112 0.69032293]
Stock Position:  0.012029668531403073
Bond Position:  [9.51259267]


portfolio before change:  [10.62812562]
curr_Stock_Price:  92.63295968394297
curr_Factors:  [92.63295968 -1.29112765 -0.87463342]
mat_Sqrt:  [[10.62153923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01193253 -0.04468763 -0.68222651]
Stock Position:  0.011932529812986705
Bond Position:  [9.52278006]


portfolio before change:  [10.628799]
curr_Stock_Price:  92.58962989939886
curr_Factors:  [92.5896299  -1.38901105 -0.86392223]
mat_Sqrt:  [[ 9.73029165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01153894 0.00126995 0.19467478]
Stock Position:  0.011538940342586944
Bond Position:  [9.56041279]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.62058377]
Stock Price:  91.7740994072822
PL:  [10.62058377]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 2.65682281e-03 -7.71012792e-02  1.11895420e-02]
 [-1.47786829e-01  1.05261848e-01 -2.75857486e-01]
 [ 1.11981136e-02 -8.09990564e-04  5.44041578e-02]
 [ 5.49531721e-02  2.07506139e-03  9.84176746e-02]
 [ 5.49525075e-02  6.95620012e-03 -7.69465293e-02]
 [-7.98232917e-02 -1.56499979e-01  1.31911535e-01]
 [-6.11809980e-02 -1.74552491e-01  8.80536851e-02]
 [ 2.15674561e-02  7.19068373e-01  1.00453119e-01]
 [ 2.38692866e-03  4.91232220e-02 -2.81367907e-02]
 [ 2.72806725e-01  9.91788465e-02  1.39762062e-01]
 [-1.62642798e-01 -2.31176143e-01  1.10842779e-02]
 [-2.59298386e-02 -1.76082321e-02  9.37980947e-02]
 [-2.79935940e-02  1.37835269e-01 -4.44652274e-02]
 [ 1.03089351e-02 -1.32715709e-01  4.93293580e-02]
 [-4.58749606e-02  1.13711344e-01 -4.25675919e-02]
 [ 7.22327318e-02 -1.17991450e-02  2.24403233e-03]
 [ 5.15337546e-02  7.96058995e-02 -1.37095403e-01]
 [-3.17146808e-02 -5.85794700e-02 -1.36136217e-02]
 [ 9.20216681e-02 -6.43737505e-02 -6.94237718e-02]
 [ 1.11025317e-02  9.22296186e-03  1.43087356e-02]
 [-4.43354521e-02  5.65587051e-01 -5.52381862e-01]
 [ 4.64207239e-01  2.57562237e-01  4.67850512e-02]
 [-8.11551283e-03  1.31182095e-03  4.85168909e-02]
 [-2.03532558e-03 -1.31159968e-01 -1.27095697e-01]
 [ 4.60651293e-02  1.92466726e-02 -1.32062918e-02]
 [-6.57239160e-02 -8.79705658e-03  1.86497700e-01]
 [-1.21552702e-02 -3.23888603e-02  2.47732236e-03]
 [ 9.31717005e-02 -5.99012191e-02 -6.70935486e-02]
 [-3.64140428e-02 -4.21779481e-02  3.59802262e-02]
 [-5.19182752e-02  1.22404043e-02  3.54128221e-03]
 [-2.70630992e-02 -4.14795457e-02 -6.20416577e-03]
 [ 1.87672536e-02  1.31862506e-01 -9.83369914e-02]
 [-3.19077219e-02  3.97448996e-02 -9.67388740e-02]
 [ 4.99610371e-02 -4.46434420e-02  1.89098107e-01]
 [-6.42862670e-02  6.02056450e-02 -4.32052795e-02]
 [-2.35407459e-01 -2.43449128e-01 -2.22082017e-01]
 [ 1.20352769e-01  1.04409059e-01  2.70581423e-01]
 [ 2.23062969e-01 -1.49240031e-01 -2.82634818e-01]
 [ 9.33626616e-02  6.52540732e-03  9.29960954e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.29122733]
curr_Stock_Price:  99.98708412372282
curr_Factors:  [99.98708412 -1.24006497 -0.98834776]
mat_Sqrt:  [[10.76853313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00100268 -0.02488433  0.03192065]
Stock Position:  -0.001002676415264639
Bond Position:  [2.39148202]


portfolio before change:  [2.29088825]
curr_Stock_Price:  100.62341688668246
curr_Factors:  [100.62341689  -1.19732442  -0.99976506]
mat_Sqrt:  [[11.18189014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01633083  0.03397312 -0.78694462]
Stock Position:  -0.016330827385411417
Bond Position:  [3.9341519]


portfolio before change:  [2.28391556]
curr_Stock_Price:  101.08049673647604
curr_Factors:  [101.08049674  -1.2357011   -0.98610522]
mat_Sqrt:  [[10.95845031  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00202017 -0.00026142  0.15519992]
Stock Position:  0.0020201740751595977
Bond Position:  [2.07971536]


portfolio before change:  [2.28297997]
curr_Stock_Price:  100.48868547878654
curr_Factors:  [100.48868548  -1.05462652  -0.97196376]
mat_Sqrt:  [[13.24281132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00569865 0.00066972 0.28075823]
Stock Position:  0.005698651449346729
Bond Position:  [1.71032998]


portfolio before change:  [2.28021896]
curr_Stock_Price:  99.96666343402545
curr_Factors:  [99.96666343 -1.13874847 -0.94121441]
mat_Sqrt:  [[12.48932     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00325605  0.0022451  -0.21950703]
Stock Position:  0.0032560452756287646
Bond Position:  [1.95472298]


portfolio before change:  [2.28055255]
curr_Stock_Price:  99.99406997581468
curr_Factors:  [99.99406998 -1.27903833 -0.95339111]
mat_Sqrt:  [[10.72611519  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00790989 -0.05051015  0.37630689]
Stock Position:  -0.007909889591015127
Bond Position:  [3.0714946]


portfolio before change:  [2.28541758]
curr_Stock_Price:  99.4275548334831
curr_Factors:  [99.42755483 -1.27608657 -0.97287052]
mat_Sqrt:  [[10.49052211  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00751512 -0.05633657  0.25119265]
Stock Position:  -0.00751511622535947
Bond Position:  [3.03262721]


portfolio before change:  [2.28892225]
curr_Stock_Price:  99.01165094905132
curr_Factors:  [99.01165095 -1.24628871 -1.00423827]
mat_Sqrt:  [[10.43025332  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01810614 0.23207832 0.28656479]
Stock Position:  0.01810613551017373
Bond Position:  [0.49620388]


portfolio before change:  [2.28209208]
curr_Stock_Price:  98.63099550514971
curr_Factors:  [98.63099551 -1.29018667 -0.98509629]
mat_Sqrt:  [[10.13609295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00065812  0.01585445 -0.08026643]
Stock Position:  0.0006581200511719226
Bond Position:  [2.21718105]


portfolio before change:  [2.28280292]
curr_Stock_Price:  99.2899486901163
curr_Factors:  [99.28994869 -1.35936138 -0.9908996 ]
mat_Sqrt:  [[ 9.46672825  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03396953 0.03200984 0.39870226]
Stock Position:  0.03396953260344641
Bond Position:  [-1.09003023]


portfolio before change:  [2.28118317]
curr_Stock_Price:  99.24627769989202
curr_Factors:  [99.2462777  -1.12458468 -0.96957958]
mat_Sqrt:  [[12.22447587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01697978 -0.07461178  0.03162036]
Stock Position:  -0.016979775995120617
Bond Position:  [3.96636274]


portfolio before change:  [2.30485508]
curr_Stock_Price:  97.88135492430402
curr_Factors:  [97.88135492 -0.9849462  -0.96278804]
mat_Sqrt:  [[13.95756765  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00074351 -0.00568303  0.26757986]
Stock Position:  -0.0007435140783358894
Bond Position:  [2.37763125]


portfolio before change:  [2.30555911]
curr_Stock_Price:  97.33420982968748
curr_Factors:  [97.33420983 -0.84502218 -0.97437454]
mat_Sqrt:  [[15.78016533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056619  0.04448614 -0.12684692]
Stock Position:  -0.0005661863480723916
Bond Position:  [2.36066841]


portfolio before change:  [2.30536697]
curr_Stock_Price:  98.19479197644115
curr_Factors:  [98.19479198 -0.86339585 -0.93556345]
mat_Sqrt:  [[16.24839089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004131  -0.04283381  0.14072293]
Stock Position:  -0.00041310137229653255
Bond Position:  [2.34593137]


portfolio before change:  [2.3054346]
curr_Stock_Price:  98.74097531953701
curr_Factors:  [98.74097532 -0.52606974 -0.92869602]
mat_Sqrt:  [[23.05157855  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136012  0.03670018 -0.12143349]
Stock Position:  -0.0013601152294890019
Bond Position:  [2.4397337]


portfolio before change:  [2.30696865]
curr_Stock_Price:  97.83732441780181
curr_Factors:  [97.83732442 -0.50432652 -0.93356696]
mat_Sqrt:  [[23.22925944  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00302559 -0.00380816  0.0064016 ]
Stock Position:  0.0030255937672681015
Bond Position:  [2.01095265]


portfolio before change:  [2.30409902]
curr_Stock_Price:  96.80578440417561
curr_Factors:  [96.8057844  -0.46804949 -0.92950458]
mat_Sqrt:  [[23.93047329  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0016631   0.02569269 -0.39109502]
Stock Position:  0.0016630995285874636
Bond Position:  [2.14310136]


portfolio before change:  [2.30773654]
curr_Stock_Price:  98.83189237283212
curr_Factors:  [98.83189237 -0.33535736 -0.93708814]
mat_Sqrt:  [[27.68732841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016777  -0.01890644 -0.03883587]
Stock Position:  -0.0016777001108154595
Bond Position:  [2.47354682]


portfolio before change:  [2.30293571]
curr_Stock_Price:  101.87775335762996
curr_Factors:  [101.87775336  -0.51864611  -0.9410728 ]
mat_Sqrt:  [[23.66636139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00273428 -0.02077654 -0.1980467 ]
Stock Position:  0.002734275969777619
Bond Position:  [2.02437382]


portfolio before change:  [2.30129354]
curr_Stock_Price:  101.18461591040062
curr_Factors:  [101.18461591  -0.554063    -0.93068801]
mat_Sqrt:  [[22.92425956  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00069385 0.0029767  0.04081884]
Stock Position:  0.0006938465917086085
Bond Position:  [2.23108694]


portfolio before change:  [2.30159213]
curr_Stock_Price:  101.21298348382352
curr_Factors:  [101.21298348  -0.50362467  -0.88699442]
mat_Sqrt:  [[25.19405265  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00165277  0.18254244 -1.5757917 ]
Stock Position:  -0.001652769194426638
Bond Position:  [2.46887383]


portfolio before change:  [2.30426235]
curr_Stock_Price:  99.78411258960627
curr_Factors:  [99.78411259 -0.61290359 -0.86178506]
mat_Sqrt:  [[22.83559099  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02304875 0.08312785 0.13346473]
Stock Position:  0.023048751801641648
Bond Position:  [0.00436311]


portfolio before change:  [2.31090719]
curr_Stock_Price:  100.07238392370293
curr_Factors:  [100.07238392  -0.77818939  -0.86870302]
mat_Sqrt:  [[19.27870954  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.06632157e-04 4.23388390e-04 1.38405185e-01]
Stock Position:  0.00010663215749869419
Bond Position:  [2.30023626]


portfolio before change:  [2.31129877]
curr_Stock_Price:  101.04796920141997
curr_Factors:  [101.0479692   -0.63329284  -0.86005809]
mat_Sqrt:  [[22.69726451  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00241225 -0.0423317  -0.36256865]
Stock Position:  -0.002412252915143405
Bond Position:  [2.55505203]


portfolio before change:  [2.3111562]
curr_Stock_Price:  101.23947884437767
curr_Factors:  [101.23947884  -0.75178915  -0.86703467]
mat_Sqrt:  [[20.05873991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00235798  0.00621184 -0.03767387]
Stock Position:  0.0023579804672603463
Bond Position:  [2.07243549]


portfolio before change:  [2.30907246]
curr_Stock_Price:  100.245913771266
curr_Factors:  [100.24591377  -0.87801728  -0.88138291]
mat_Sqrt:  [[17.25714255  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170659 -0.00283924  0.53202603]
Stock Position:  -0.0017065933139743046
Bond Position:  [2.48015147]


portfolio before change:  [2.3102993]
curr_Stock_Price:  99.70870215228784
curr_Factors:  [99.70870215 -0.66058391 -0.88343949]
mat_Sqrt:  [[21.2898315   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085773 -0.01045346  0.00706711]
Stock Position:  -0.0008577304778326851
Bond Position:  [2.3958225]


portfolio before change:  [2.30944018]
curr_Stock_Price:  101.05950208748582
curr_Factors:  [101.05950209  -0.65337407  -0.90087791]
mat_Sqrt:  [[21.3586644   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00314856 -0.01933304 -0.19139922]
Stock Position:  0.0031485583965753772
Bond Position:  [1.99124843]


portfolio before change:  [2.30542064]
curr_Stock_Price:  99.70381358723806
curr_Factors:  [99.70381359 -0.79469209 -0.89836595]
mat_Sqrt:  [[18.34112654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00205435 -0.01361287  0.10264157]
Stock Position:  -0.0020543529520847784
Bond Position:  [2.51024746]


portfolio before change:  [2.30709363]
curr_Stock_Price:  99.04219769989095
curr_Factors:  [99.0421977  -0.758229   -0.88797755]
mat_Sqrt:  [[19.09333744  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00255046  0.00395057  0.01010229]
Stock Position:  -0.002550463067021797
Bond Position:  [2.5596971]


portfolio before change:  [2.30634489]
curr_Stock_Price:  99.46122762972452
curr_Factors:  [99.46122763 -0.64436398 -0.86463343]
mat_Sqrt:  [[21.99401746  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00167302 -0.01338747 -0.01769876]
Stock Position:  -0.0016730229529973177
Bond Position:  [2.47274581]


portfolio before change:  [2.30948811]
curr_Stock_Price:  97.76722506005152
curr_Factors:  [97.76722506 -0.46643971 -0.83198085]
mat_Sqrt:  [[26.68679412  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00095967  0.04255844 -0.28052806]
Stock Position:  0.0009596739348689495
Bond Position:  [2.21566345]


portfolio before change:  [2.30897379]
curr_Stock_Price:  96.94267876322368
curr_Factors:  [96.94267876 -0.23750505 -0.82445243]
mat_Sqrt:  [[33.52067409  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00129895  0.01282761 -0.27596908]
Stock Position:  -0.0012989466773092439
Bond Position:  [2.43489716]


portfolio before change:  [2.31029248]
curr_Stock_Price:  96.16180582997316
curr_Factors:  [ 9.61618058e+01 -3.18196634e-02 -8.40104962e-01]
mat_Sqrt:  [[40.20967446  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00197584 -0.01440861  0.53944426]
Stock Position:  0.0019758359937695038
Bond Position:  [2.12029252]


portfolio before change:  [2.30774512]
curr_Stock_Price:  94.738399970066
curr_Factors:  [94.73839997  0.1428863  -0.82258162]
mat_Sqrt:  [[48.01070903  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126672  0.01943129 -0.12325264]
Stock Position:  -0.0012667190959997692
Bond Position:  [2.42775206]


portfolio before change:  [2.31354742]
curr_Stock_Price:  90.39741374038807
curr_Factors:  [90.39741374  0.12226667 -0.79518023]
mat_Sqrt:  [[46.12255511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00716425 -0.07857287 -0.63353818]
Stock Position:  -0.007164251973367431
Bond Position:  [2.96117727]


portfolio before change:  [2.29554841]
curr_Stock_Price:  92.96141809681563
curr_Factors:  [ 9.29614181e+01 -4.41361258e-02 -8.17284837e-01]
mat_Sqrt:  [[39.28188947  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00501242 0.03369788 0.77189349]
Stock Position:  0.005012421331215301
Bond Position:  [1.82958662]


portfolio before change:  [2.28172258]
curr_Stock_Price:  90.15747404498657
curr_Factors:  [90.15747404 -0.2306517  -0.80659496]
mat_Sqrt:  [[31.95444198  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00422185 -0.04816701 -0.80627847]
Stock Position:  0.0042218507311628795
Bond Position:  [1.90109118]


portfolio before change:  [2.27420801]
curr_Stock_Price:  88.32126045672797
curr_Factors:  [88.32126046 -0.42464066 -0.83195959]
mat_Sqrt:  [[25.1379991   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00452213 0.00210607 0.26529197]
Stock Position:  0.004522134111409592
Bond Position:  [1.87480742]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.27203369]
Stock Price:  87.78861711329037
PL:  [2.27203369]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.30702623e-02 -7.57801301e-02  1.07829839e-02]
 [-1.36599627e-01  7.88846213e-02 -1.11318563e-01]
 [-4.55939649e-02  5.04149201e-02  1.46933561e-02]
 [ 1.20356560e-01  4.46831158e-02  1.33643381e-01]
 [ 2.09770729e-01 -2.16421467e-01 -1.04977587e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.74777848e-02 -1.69139488e-01  6.60809465e-02]
 [ 1.04995409e-02  6.14206455e-01  8.94454510e-02]
 [ 3.07959091e-01  4.98882501e-03  3.17766970e-01]
 [ 3.99357722e-01  1.51966576e-01  2.46655696e-01]
 [-2.45413497e-01 -2.58026215e-01  1.82731681e-02]
 [-2.18131042e-02 -1.74658013e-02  9.43084266e-02]
 [ 1.05838652e-02 -6.00684772e-02  1.10652902e-01]
 [ 1.12587090e-02 -1.11607108e-01 -6.05237233e-02]
 [ 2.94344472e-02 -3.33047040e-02 -7.59125896e-02]
 [ 7.96286314e-02 -9.73307806e-03  9.75363531e-03]
 [ 5.13769732e-02  1.70751027e-02 -2.74110349e-02]
 [-5.38768166e-02 -5.89480601e-02  3.27787576e-02]
 [ 6.58206819e-02 -2.70539128e-02 -1.04471958e-01]
 [ 2.09134064e-03  2.35375735e-02 -3.91089080e-02]
 [-3.90937695e-02  5.26745766e-01 -5.11551820e-01]
 [ 3.14378488e-01  1.85869685e-01  7.11836073e-02]
 [-7.84743162e-03  1.05357982e-03  4.86810186e-02]
 [ 1.05980173e-03 -1.09703047e-01 -1.43067038e-01]
 [ 4.09131063e-02  1.28614480e-02 -1.27819125e-02]
 [-3.80900861e-02  6.08606766e-03  1.06108801e-01]
 [ 5.00752762e-02 -3.35096452e-02  1.73588074e-02]
 [ 1.15693188e-01 -6.53972323e-02 -5.76976781e-03]
 [-4.81195685e-02 -2.72481279e-02 -8.59034401e-03]
 [-7.32339899e-02 -1.35465978e-02  4.01873058e-02]
 [-3.61048455e-02 -5.65710023e-02 -3.42231440e-02]
 [ 2.61157008e-02 -2.24661773e-02 -6.69169429e-02]
 [-2.99231895e-02  1.43484136e-02  6.69514726e-02]
 [ 1.74391249e-02 -6.17444609e-02  3.16616726e-02]
 [-5.34898479e-02  5.96876171e-02 -5.15364608e-03]
 [ 7.39403293e-02 -3.14936318e-02  1.15951889e-01]
 [-5.32441880e-02  8.92455302e-02  1.76818463e-02]
 [ 3.07834951e-02 -5.98031791e-02 -4.76862121e-02]
 [ 9.53710701e-02  5.28114750e-03  8.11067158e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.39739233]
curr_Stock_Price:  99.8743961602817
curr_Factors:  [99.87439616 -0.95545662 -0.99727125]
mat_Sqrt:  [[14.17082807  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.39176453e-05 -2.44579318e-02  3.07608518e-02]
Stock Position:  -1.3917645266911591e-05
Bond Position:  [1.39878235]


portfolio before change:  [1.39756911]
curr_Stock_Price:  99.73630982237489
curr_Factors:  [99.73630982 -0.70225691 -0.98868411]
mat_Sqrt:  [[18.38598671  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00778964  0.0254599  -0.31756087]
Stock Position:  -0.007789637851964594
Bond Position:  [2.17447885]


portfolio before change:  [1.4011538]
curr_Stock_Price:  99.31101891349383
curr_Factors:  [99.31101891 -0.61407964 -0.97603132]
mat_Sqrt:  [[20.24981321  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00159526  0.01627135  0.04191605]
Stock Position:  -0.0015952637857917578
Bond Position:  [1.55958108]


portfolio before change:  [1.40002673]
curr_Stock_Price:  100.1397440831625
curr_Factors:  [100.13974408  -0.64939587  -0.9670526 ]
mat_Sqrt:  [[19.88803265  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00788199 0.01442141 0.38124737]
Stock Position:  0.007881991456399529
Bond Position:  [0.61072612]


portfolio before change:  [1.41799433]
curr_Stock_Price:  102.40963380135003
curr_Factors:  [102.4096338   -0.57750752  -0.97202543]
mat_Sqrt:  [[21.74639169  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0066294  -0.06984973 -0.29947184]
Stock Position:  0.0066293950583862305
Bond Position:  [0.73908041]


portfolio before change:  [1.40918917]
curr_Stock_Price:  101.06749895366046
curr_Factors:  [101.06749895  -0.46598122  -0.96779396]
mat_Sqrt:  [[24.09521862  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00636243 -0.05534923  0.15513819]
Stock Position:  -0.006362432256286817
Bond Position:  [2.05222429]


portfolio before change:  [1.41352584]
curr_Stock_Price:  100.42621526642067
curr_Factors:  [100.42621527  -0.71206456  -0.96418673]
mat_Sqrt:  [[18.78712855  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00417917 -0.05458953  0.18851055]
Stock Position:  -0.004179165603561884
Bond Position:  [1.83322363]


portfolio before change:  [1.40749625]
curr_Stock_Price:  101.92382562462925
curr_Factors:  [101.92382562  -0.84540077  -1.00314299]
mat_Sqrt:  [[16.04956847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00960349 0.19823428 0.25516297]
Stock Position:  0.009603490903948247
Bond Position:  [0.42867172]


portfolio before change:  [1.40354903]
curr_Stock_Price:  101.50722635843027
curr_Factors:  [101.50722636  -0.96479766  -0.94977959]
mat_Sqrt:  [[14.96258473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02498508 0.00161014 0.90650072]
Stock Position:  0.02498507770712883
Bond Position:  [-1.13261691]


portfolio before change:  [1.35597813]
curr_Stock_Price:  99.60892099172173
curr_Factors:  [99.60892099 -0.80819473 -0.92146891]
mat_Sqrt:  [[17.66504962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02721341 0.049047   0.70364004]
Stock Position:  0.027213405176099378
Bond Position:  [-1.35471979]


portfolio before change:  [1.37167034]
curr_Stock_Price:  100.19177914604978
curr_Factors:  [100.19177915  -1.08369619  -0.93103956]
mat_Sqrt:  [[13.36113858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02203052 -0.0832776   0.05212826]
Stock Position:  -0.022030523872595246
Bond Position:  [3.57894772]


portfolio before change:  [1.36216495]
curr_Stock_Price:  100.64355176927141
curr_Factors:  [100.64355177  -1.01561341  -0.95898663]
mat_Sqrt:  [[13.97101802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004386  -0.00563706  0.26903569]
Stock Position:  -0.00043859859953734935
Bond Position:  [1.40630707]


portfolio before change:  [1.36234039]
curr_Stock_Price:  100.64435632086868
curr_Factors:  [100.64435632  -0.88054546  -0.96951506]
mat_Sqrt:  [[15.82407565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00132136 -0.01938702  0.31566193]
Stock Position:  0.0013213642383185385
Bond Position:  [1.22935254]


portfolio before change:  [1.36157848]
curr_Stock_Price:  99.95144467116434
curr_Factors:  [99.95144467 -0.79143295 -0.97205831]
mat_Sqrt:  [[17.13620122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00139339 -0.03602104 -0.17265734]
Stock Position:  -0.0013933864027371116
Bond Position:  [1.50084947]


portfolio before change:  [1.36163015]
curr_Stock_Price:  100.04901120768642
curr_Factors:  [100.04901121  -0.88559494  -0.97112682]
mat_Sqrt:  [[15.62603483  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00045697 -0.01074905 -0.21655749]
Stock Position:  0.00045696560569624846
Bond Position:  [1.3159112]


portfolio before change:  [1.36150314]
curr_Stock_Price:  99.41106663071324
curr_Factors:  [99.41106663 -0.82386557 -0.93835736]
mat_Sqrt:  [[17.06518657  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00466639 -0.00314134  0.02782441]
Stock Position:  0.004666390686041993
Bond Position:  [0.89761226]


portfolio before change:  [1.36786803]
curr_Stock_Price:  100.75100651185727
curr_Factors:  [100.75100651  -0.63637204  -0.98594802]
mat_Sqrt:  [[19.89228837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0024767   0.00551097 -0.07819605]
Stock Position:  0.002476696444336454
Bond Position:  [1.11833837]


portfolio before change:  [1.36793848]
curr_Stock_Price:  100.72300551376398
curr_Factors:  [100.72300551  -0.82378583  -1.00190129]
mat_Sqrt:  [[16.22717192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364935 -0.0190254   0.09350867]
Stock Position:  -0.0036493483511986662
Bond Position:  [1.73551181]


portfolio before change:  [1.36943356]
curr_Stock_Price:  100.3727717595972
curr_Factors:  [100.37277176  -1.02305867  -1.00935126]
mat_Sqrt:  [[13.15077955  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00296356 -0.00873161 -0.29802942]
Stock Position:  0.0029635563281775286
Bond Position:  [1.07197319]


portfolio before change:  [1.37000684]
curr_Stock_Price:  100.52100015227765
curr_Factors:  [100.52100015  -0.66472191  -0.99281198]
mat_Sqrt:  [[19.16015313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.67398758e-05  7.59671918e-03 -1.11566829e-01]
Stock Position:  -5.6739875785223415e-05
Bond Position:  [1.37571039]


portfolio before change:  [1.37010601]
curr_Stock_Price:  101.80420982370094
curr_Factors:  [101.80420982  -0.7090894   -1.00246561]
mat_Sqrt:  [[18.38428912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195778  0.17000647 -1.45931495]
Stock Position:  -0.0019577759015174234
Bond Position:  [1.56941584]


portfolio before change:  [1.3714293]
curr_Stock_Price:  101.2285059001797
curr_Factors:  [101.2285059   -0.6637404   -1.03891761]
mat_Sqrt:  [[18.4436914   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01989023 0.05998918 0.20306702]
Stock Position:  0.019890230415469116
Bond Position:  [-0.64202901]


portfolio before change:  [1.34817549]
curr_Stock_Price:  100.06343423808052
curr_Factors:  [100.06343424  -0.89956958  -1.04097785]
mat_Sqrt:  [[14.37164106  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00016036 0.00034004 0.1388734 ]
Stock Position:  0.00016035752442348052
Bond Position:  [1.33212957]


portfolio before change:  [1.34839123]
curr_Stock_Price:  100.37027806282833
curr_Factors:  [100.37027806  -0.88476324  -1.02967907]
mat_Sqrt:  [[14.79699063  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00341533 -0.03540651 -0.40813044]
Stock Position:  -0.0034153347196566562
Bond Position:  [1.69118932]


portfolio before change:  [1.347236]
curr_Stock_Price:  100.77042523139994
curr_Factors:  [100.77042523  -0.74925244  -1.0277142 ]
mat_Sqrt:  [[17.04536425  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0024012   0.00415101 -0.03646324]
Stock Position:  0.002401200750888669
Bond Position:  [1.10526598]


portfolio before change:  [1.34940241]
curr_Stock_Price:  101.61510478093071
curr_Factors:  [101.61510478  -0.90269508  -0.99960289]
mat_Sqrt:  [[15.16354549  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00100164  0.00196427  0.30269887]
Stock Position:  -0.001001639389943399
Bond Position:  [1.45118411]


portfolio before change:  [1.34935234]
curr_Stock_Price:  101.84620865157909
curr_Factors:  [101.84620865  -0.76713963  -0.97865274]
mat_Sqrt:  [[17.77284159  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00263202 -0.01081519  0.04951985]
Stock Position:  0.002632021446832087
Bond Position:  [1.08129093]


portfolio before change:  [1.34864181]
curr_Stock_Price:  101.52489591045139
curr_Factors:  [101.52489591  -0.66964626  -0.97401546]
mat_Sqrt:  [[19.62182239  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0051558  -0.02110687 -0.01645954]
Stock Position:  0.005155804724885416
Bond Position:  [0.82519927]


portfolio before change:  [1.35125725]
curr_Stock_Price:  102.01216857647522
curr_Factors:  [102.01216858  -0.74907887  -1.01150561]
mat_Sqrt:  [[17.54041479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00316042 -0.0087943  -0.02450586]
Stock Position:  -0.003160419331530244
Bond Position:  [1.67365848]


portfolio before change:  [1.35012803]
curr_Stock_Price:  102.43566977575502
curr_Factors:  [102.43566978  -0.49692892  -1.00735787]
mat_Sqrt:  [[22.75871607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0029789  -0.00437215  0.1146432 ]
Stock Position:  -0.002978901707964295
Bond Position:  [1.65527382]


portfolio before change:  [1.34985709]
curr_Stock_Price:  102.59608281853559
curr_Factors:  [102.59608282  -0.60552378  -1.02840051]
mat_Sqrt:  [[20.02287673  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00272878 -0.01825821 -0.0976291 ]
Stock Position:  -0.0027287848667342904
Bond Position:  [1.62981973]


portfolio before change:  [1.3524472]
curr_Stock_Price:  101.72156506468382
curr_Factors:  [101.72156506  -0.60397879  -1.0466635 ]
mat_Sqrt:  [[19.52307376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040314 -0.00725093 -0.19089541]
Stock Position:  0.0004031356873612681
Bond Position:  [1.31143961]


portfolio before change:  [1.35245027]
curr_Stock_Price:  101.32249551467824
curr_Factors:  [101.32249551  -0.59145305  -1.04956903]
mat_Sqrt:  [[19.63446374  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0006788   0.00463093  0.19099392]
Stock Position:  -0.0006788023279761242
Bond Position:  [1.42122821]


portfolio before change:  [1.35336344]
curr_Stock_Price:  100.23895345708853
curr_Factors:  [100.23895346  -0.45815959  -1.07696161]
mat_Sqrt:  [[21.59443578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00052321 -0.01992794  0.09032194]
Stock Position:  0.0005232135534132691
Bond Position:  [1.30091706]


portfolio before change:  [1.35339828]
curr_Stock_Price:  99.99472543775171
curr_Factors:  [99.99472544 -0.42326601 -1.06481204]
mat_Sqrt:  [[22.5794318   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00187596  0.0192641  -0.01470192]
Stock Position:  -0.0018759616280834078
Bond Position:  [1.54098455]


portfolio before change:  [1.35466266]
curr_Stock_Price:  99.42342000726764
curr_Factors:  [99.42342001 -0.44501754 -1.08576484]
mat_Sqrt:  [[21.51187952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0042386  -0.01016453  0.33077846]
Stock Position:  0.004238602151015857
Bond Position:  [0.93324634]


portfolio before change:  [1.35256265]
curr_Stock_Price:  98.90044693151185
curr_Factors:  [98.90044693 -0.42047305 -1.08945874]
mat_Sqrt:  [[21.84958599  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00143791  0.02880387  0.05044139]
Stock Position:  -0.0014379095643891246
Bond Position:  [1.49477255]


portfolio before change:  [1.35353114]
curr_Stock_Price:  98.35686040423941
curr_Factors:  [98.3568604  -0.47098451 -1.09583449]
mat_Sqrt:  [[20.52786632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00043075 -0.01930139 -0.13603549]
Stock Position:  0.0004307469122128795
Bond Position:  [1.31116423]


portfolio before change:  [1.35431446]
curr_Stock_Price:  99.79485888896436
curr_Factors:  [99.79485889 -0.60940558 -1.07636142]
mat_Sqrt:  [[18.49221197  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00611095 0.00170448 0.23137488]
Stock Position:  0.006110946547645063
Bond Position:  [0.74447341]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.35395755]
Stock Price:  99.72122505979164
PL:  [1.35395755]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 5.45940041e-02 -7.05120288e-02  9.16182784e-03]
 [-1.67274803e-01  8.30817429e-02 -2.89064415e-01]
 [-2.65572643e-03  1.80473772e-02  4.46804598e-02]
 [-1.08615255e-01 -1.02861548e-01 -5.60651452e-02]
 [ 1.23354582e-01 -9.98957794e-02 -9.21989362e-02]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.25516763e-02 -1.60179127e-01 -2.72024395e-02]
 [ 1.43045289e-02  6.77561782e-01  9.10270039e-02]
 [ 1.76302410e-01 -1.02829939e-02  1.70542194e-01]
 [ 3.78020571e-01  1.43066293e-01  2.28632878e-01]
 [-7.96947299e-02 -1.71562073e-01  2.61373644e-02]
 [ 2.77092980e-03 -1.61661110e-02  9.98336339e-02]
 [ 2.57009772e-03 -6.87683187e-05  5.13047768e-02]
 [ 1.20675290e-02 -1.69039519e-01  4.42246123e-02]
 [ 5.74897282e-02 -7.38515398e-02 -8.42373432e-02]
 [ 1.58820929e-02 -2.78622928e-02  6.20399052e-02]
 [ 4.72164534e-02  2.45422044e-02 -3.07713017e-03]
 [-5.77280873e-02 -6.12261655e-02  2.72952181e-02]
 [ 7.30052732e-02 -3.96550134e-02 -1.07582314e-01]
 [ 2.24898959e-03  2.34032757e-02 -3.84568855e-02]
 [-3.51442919e-02  4.87307451e-01 -4.61032238e-01]
 [ 2.93398848e-01  1.75830998e-01  7.45999938e-02]
 [-1.17829269e-02  1.23680157e-02  4.17382515e-02]
 [ 1.18272447e-02 -9.68893776e-02 -1.57196913e-01]
 [ 5.13421291e-02  2.46955986e-02 -1.36648473e-02]
 [-3.37343444e-02  9.76796708e-03  8.52941432e-02]
 [ 8.42138610e-02 -2.95006078e-02  3.02899622e-02]
 [ 1.53261097e-01 -6.50292495e-02  1.28979171e-01]
 [-4.81625326e-02 -2.74269301e-02 -8.24516511e-03]
 [-6.87835826e-02 -1.16866028e-02  3.57533152e-02]
 [-2.71221343e-02 -4.14394217e-02 -6.03154887e-03]
 [ 3.67788430e-02  7.40736180e-02 -5.60051401e-02]
 [-4.16576441e-02  1.86794887e-02 -2.38450634e-02]
 [ 1.38811287e-02 -6.64694042e-02  6.87386635e-03]
 [-5.85052609e-02  2.89457767e-02 -6.00874814e-03]
 [ 8.60202975e-02  9.95740766e-03  1.68433742e-01]
 [-6.16751524e-02  9.20825887e-02  1.46981924e-02]
 [-5.68535435e-03 -4.36463493e-02 -7.79985597e-03]
 [ 9.45048814e-02  5.81777326e-03  8.62343807e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.20208647]
curr_Stock_Price:  99.84977347241755
curr_Factors:  [99.84977347 -1.31608552 -0.97796908]
mat_Sqrt:  [[10.07051844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00417763 -0.02275766  0.02613614]
Stock Position:  0.004177634652786332
Bond Position:  [0.7849506]


portfolio before change:  [1.20608967]
curr_Stock_Price:  100.78453146540413
curr_Factors:  [100.78453147  -1.27765726  -1.0169071 ]
mat_Sqrt:  [[10.15961482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02060323  0.02681452 -0.82462032]
Stock Position:  -0.02060322599761678
Bond Position:  [3.28257615]


portfolio before change:  [1.20440495]
curr_Stock_Price:  100.88621817612066
curr_Factors:  [100.88621818  -1.51825771  -1.03439566]
mat_Sqrt:  [[ 7.85649019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00129174 0.00582477 0.12746092]
Stock Position:  0.0012917396222562225
Bond Position:  [1.07408622]


portfolio before change:  [1.20438463]
curr_Stock_Price:  100.76654354194137
curr_Factors:  [100.76654354  -1.42178716  -1.05742593]
mat_Sqrt:  [[ 8.44515835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01670259 -0.03319842 -0.15993825]
Stock Position:  -0.016702591513305595
Bond Position:  [2.88744704]


portfolio before change:  [1.20639711]
curr_Stock_Price:  100.66766478763758
curr_Factors:  [100.66766479  -1.34881175  -1.05118716]
mat_Sqrt:  [[ 9.13237451  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00921375 -0.03224122 -0.2630179 ]
Stock Position:  0.009213749661167666
Bond Position:  [0.27887045]


portfolio before change:  [1.2107944]
curr_Stock_Price:  101.1411344098539
curr_Factors:  [101.14113441  -1.29618205  -1.06388145]
mat_Sqrt:  [[ 9.54916207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0160542  -0.05534923  0.15513819]
Stock Position:  -0.01605420403218053
Bond Position:  [2.83453481]


portfolio before change:  [1.21102968]
curr_Stock_Price:  101.14855090942301
curr_Factors:  [101.14855091  -1.27114539  -1.02968956]
mat_Sqrt:  [[10.13257307  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00896128 -0.05169759 -0.07760099]
Stock Position:  -0.008961275467231548
Bond Position:  [2.1174497]


portfolio before change:  [1.21441896]
curr_Stock_Price:  100.79987396168971
curr_Factors:  [100.79987396  -1.00195997  -1.05424116]
mat_Sqrt:  [[12.89624233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01327457 0.21868212 0.25967471]
Stock Position:  0.01327456893008604
Bond Position:  [-0.12365591]


portfolio before change:  [1.19868935]
curr_Stock_Price:  99.61609524542361
curr_Factors:  [99.61609525 -1.01593144 -1.03948565]
mat_Sqrt:  [[12.75478704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01638719 -0.00331882  0.48650941]
Stock Position:  0.016387194962858582
Bond Position:  [-0.43373902]


portfolio before change:  [1.20813953]
curr_Stock_Price:  100.19608427921732
curr_Factors:  [100.19608428  -1.09214707  -1.048491  ]
mat_Sqrt:  [[11.78103495  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03852746 0.04617445 0.65222596]
Stock Position:  0.03852745949242233
Bond Position:  [-2.65216105]


portfolio before change:  [1.17865715]
curr_Stock_Price:  99.43945934612728
curr_Factors:  [99.43945935 -1.36258627 -1.04335286]
mat_Sqrt:  [[ 8.96752646  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01219728 -0.05537142  0.07456263]
Stock Position:  -0.01219727921031615
Bond Position:  [2.391548]


portfolio before change:  [1.18521311]
curr_Stock_Price:  98.9264763465187
curr_Factors:  [98.92647635 -1.22408829 -1.01208161]
mat_Sqrt:  [[10.57197904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00187756 -0.00521759  0.28479757]
Stock Position:  0.00187755682319007
Bond Position:  [0.99947303]


portfolio before change:  [1.18580964]
curr_Stock_Price:  99.177649090344
curr_Factors:  [99.17764909 -1.31640279 -1.01813554]
mat_Sqrt:  [[ 9.60586982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.35631696e-03 -2.21948794e-05  1.46358248e-01]
Stock Position:  0.0013563169609571238
Bond Position:  [1.05129331]


portfolio before change:  [1.18547706]
curr_Stock_Price:  98.8355432288725
curr_Factors:  [98.83554323 -1.09381939 -1.01949183]
mat_Sqrt:  [[11.94300878  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00112285 -0.05455727  0.12616051]
Stock Position:  -0.00112284997981961
Bond Position:  [1.29645454]


portfolio before change:  [1.18384164]
curr_Stock_Price:  100.43636413086828
curr_Factors:  [100.43636413  -0.97028417  -1.03536501]
mat_Sqrt:  [[13.51601323  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186593 -0.02383548 -0.24030569]
Stock Position:  0.001865932630766629
Bond Position:  [0.99643415]


portfolio before change:  [1.18408281]
curr_Stock_Price:  100.4988584641247
curr_Factors:  [100.49885846  -1.04253055  -1.02331149]
mat_Sqrt:  [[12.73436619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00179503 -0.00899252  0.17698258]
Stock Position:  0.0017950299632083471
Bond Position:  [1.00368435]


portfolio before change:  [1.1836598]
curr_Stock_Price:  100.19330262646466
curr_Factors:  [100.19330263  -1.06078093  -1.03314268]
mat_Sqrt:  [[12.34409405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00417997  0.00792096 -0.0087782 ]
Stock Position:  0.004179974096773499
Bond Position:  [0.76485439]


portfolio before change:  [1.18444903]
curr_Stock_Price:  100.35923987147343
curr_Factors:  [100.35923987  -0.82721068  -1.03896487]
mat_Sqrt:  [[15.5270023   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00416399 -0.01976066  0.07786566]
Stock Position:  -0.004163985528955854
Bond Position:  [1.60234345]


portfolio before change:  [1.18140764]
curr_Stock_Price:  101.1377474416654
curr_Factors:  [101.13774744  -0.71959536  -1.04484751]
mat_Sqrt:  [[17.32309455  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00247938 -0.0127986  -0.3069024 ]
Stock Position:  0.0024793826252804832
Bond Position:  [0.93064846]


portfolio before change:  [1.17950087]
curr_Stock_Price:  100.32177660954859
curr_Factors:  [100.32177661  -0.72661181  -1.02918692]
mat_Sqrt:  [[17.33251208  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.75300779e-05  7.55337474e-03 -1.09706790e-01]
Stock Position:  -4.7530077884562834e-05
Bond Position:  [1.18426917]


portfolio before change:  [1.1796579]
curr_Stock_Price:  100.1326694568971
curr_Factors:  [100.13266946  -0.83963168  -1.02789927]
mat_Sqrt:  [[15.47096521  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00192495  0.1572778  -1.31519665]
Stock Position:  -0.0019249533729343996
Bond Position:  [1.37240862]


portfolio before change:  [1.17882105]
curr_Stock_Price:  100.65653308639179
curr_Factors:  [100.65653309  -0.80569964  -1.025521  ]
mat_Sqrt:  [[16.12697636  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02136283 0.05674921 0.21281302]
Stock Position:  0.021362830378566566
Bond Position:  [-0.97148739]


portfolio before change:  [1.17380461]
curr_Stock_Price:  100.42739693423398
curr_Factors:  [100.42739693  -1.10177899  -1.0029054 ]
mat_Sqrt:  [[12.2405065   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.03350295e-05  3.99175991e-03  1.19067614e-01]
Stock Position:  -6.033502948384038e-05
Bond Position:  [1.1798639]


portfolio before change:  [1.17397348]
curr_Stock_Price:  100.0731948761824
curr_Factors:  [100.07319488  -0.85711804  -0.96207637]
mat_Sqrt:  [[16.22750196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00246729 -0.03127091 -0.44843904]
Stock Position:  -0.0024672868522494585
Bond Position:  [1.42088275]


portfolio before change:  [1.1708827]
curr_Stock_Price:  101.397886394619
curr_Factors:  [101.39788639  -0.76146433  -0.9878258 ]
mat_Sqrt:  [[17.63282305  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00303943  0.00797047 -0.03898201]
Stock Position:  0.0030394322902987307
Bond Position:  [0.86269069]


portfolio before change:  [1.17337922]
curr_Stock_Price:  102.18378195492443
curr_Factors:  [102.18378195  -0.84795653  -0.98229111]
mat_Sqrt:  [[16.38760633  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00087443  0.0031526   0.24332045]
Stock Position:  -0.0008744335270634609
Bond Position:  [1.26273215]


portfolio before change:  [1.17249853]
curr_Stock_Price:  103.37145341545495
curr_Factors:  [103.37145342  -1.03890441  -0.98865136]
mat_Sqrt:  [[13.60956809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00619968 -0.00952128  0.08640883]
Stock Position:  0.006199681482712843
Bond Position:  [0.53162845]


portfolio before change:  [1.17186043]
curr_Stock_Price:  103.2578084827341
curr_Factors:  [103.25780848  -0.92408404  -0.97220693]
mat_Sqrt:  [[15.5015169   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01072894 -0.0209881   0.36794168]
Stock Position:  0.01072893838644355
Bond Position:  [0.06401376]


portfolio before change:  [1.15983183]
curr_Stock_Price:  102.13592622576604
curr_Factors:  [102.13592623  -0.65085235  -0.94597043]
mat_Sqrt:  [[20.68650926  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0026802  -0.008852   -0.02352116]
Stock Position:  -0.002680204176949787
Bond Position:  [1.43357696]


portfolio before change:  [1.16021709]
curr_Stock_Price:  102.05904533883029
curr_Factors:  [102.05904534  -0.67651283  -0.92856689]
mat_Sqrt:  [[20.50096197  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311551 -0.00377183  0.10199426]
Stock Position:  -0.0031155116331680784
Bond Position:  [1.47818323]


portfolio before change:  [1.16668321]
curr_Stock_Price:  100.04289692801015
curr_Factors:  [100.04289693  -0.68058439  -0.89034115]
mat_Sqrt:  [[20.79418786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00177031 -0.01337452 -0.01720633]
Stock Position:  -0.0017703074445107382
Bond Position:  [1.34378989]


portfolio before change:  [1.1675014]
curr_Stock_Price:  99.67561030969728
curr_Factors:  [99.67561031 -0.45805772 -0.84400855]
mat_Sqrt:  [[27.10870115  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00149277  0.02390716 -0.15976708]
Stock Position:  0.0014927699929919707
Bond Position:  [1.01870864]


portfolio before change:  [1.16976813]
curr_Stock_Price:  101.10876968343128
curr_Factors:  [101.10876968  -0.48838164  -0.85499851]
mat_Sqrt:  [[26.38555526  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00161877  0.00602878 -0.06802333]
Stock Position:  -0.0016187668657765397
Bond Position:  [1.33343965]


portfolio before change:  [1.16992869]
curr_Stock_Price:  101.11255509703523
curr_Factors:  [101.1125551   -0.68465902  -0.83836836]
mat_Sqrt:  [[22.04766978  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.78422624e-05 -2.14529080e-02  1.96092274e-02]
Stock Position:  7.784226235388343e-05
Bond Position:  [1.16205786]


portfolio before change:  [1.16998691]
curr_Stock_Price:  99.99432166544402
curr_Factors:  [99.99432167 -0.58490768 -0.81268052]
mat_Sqrt:  [[24.7178386   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217751  0.00934221 -0.01714129]
Stock Position:  -0.002177506716622424
Bond Position:  [1.38772522]


portfolio before change:  [1.16845631]
curr_Stock_Price:  100.77690207270997
curr_Factors:  [100.77690207  -0.58166354  -0.81079442]
mat_Sqrt:  [[25.03941606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00488966 0.00321374 0.48049458]
Stock Position:  0.004889660288936114
Bond Position:  [0.6756915]


portfolio before change:  [1.15979177]
curr_Stock_Price:  98.98761379800445
curr_Factors:  [98.9876138  -0.58963759 -0.83176341]
mat_Sqrt:  [[23.89319577  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166904  0.02971953  0.04192985]
Stock Position:  -0.0016690365388132822
Bond Position:  [1.32500571]


portfolio before change:  [1.15989628]
curr_Stock_Price:  99.02423639310186
curr_Factors:  [99.02423639 -0.6501838  -0.84030653]
mat_Sqrt:  [[22.30641497  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072566 -0.0140868  -0.02225082]
Stock Position:  -0.0007256552449379402
Bond Position:  [1.23175374]


portfolio before change:  [1.15941716]
curr_Stock_Price:  99.89669283144873
curr_Factors:  [99.89669283 -0.62475757 -0.83995864]
mat_Sqrt:  [[23.09047902  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00490657 0.00187768 0.24600268]
Stock Position:  0.00490656554104155
Bond Position:  [0.66926748]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.16907763]
Stock Price:  101.84852846023014
PL:  [-0.67945083]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.96126263e-01 -1.02320813e-01  1.89503650e-02]
 [-9.54675047e-02  7.16195825e-02 -9.53488646e-02]
 [-1.30586874e-01 -1.59208287e-02 -7.23393577e-02]
 [-6.08902253e-02  9.77337275e-03 -9.17149041e-03]
 [ 1.58382816e-01 -1.62338844e-01 -1.02724739e-01]
 [-1.29546507e-01 -1.69408169e-01  6.61705992e-02]
 [-5.18102080e-02 -1.92131474e-01 -2.79775351e-02]
 [ 9.42256603e-03  6.00628879e-01  8.95446205e-02]
 [ 3.84012623e-01  3.65596505e-02  3.80371909e-01]
 [ 6.70242923e-01  2.95925352e-01  5.75397104e-01]
 [-2.12860765e-01 -3.10709767e-01 -4.40976119e-02]
 [-7.37915653e-02 -2.04470384e-02  7.97280207e-02]
 [ 1.51855943e-02 -9.71343106e-02  1.25413950e-01]
 [ 1.56428487e-03  3.27658034e-02 -5.67429444e-02]
 [ 6.95654272e-01 -2.06710107e-01 -3.26206743e-01]
 [-1.61599263e-01 -9.35205346e-02  1.08587410e-01]
 [ 5.19112374e-02  1.61162308e-02 -3.05358211e-02]
 [-6.51811290e-02 -6.56347921e-02  1.66833835e-02]
 [ 1.65039898e-01 -2.02556609e-01  3.20390222e-02]
 [ 4.01694280e-02  9.48803919e-04  4.25301595e-01]
 [-1.02604763e-01  9.61772926e-01 -9.37144491e-01]
 [ 7.53862743e-01  3.96161419e-01 -3.83306438e-04]
 [ 3.49187590e-02  8.76138434e-02 -2.59567739e-03]
 [-5.89597861e-02 -1.17766727e-01 -2.62404085e-02]
 [ 1.10578431e-02 -4.10362242e-02 -8.76081940e-03]
 [-8.44459547e-03  1.79763431e-02  1.19150981e-02]
 [ 8.46964800e-02 -5.28267762e-03  2.22790992e-01]
 [ 1.69200954e-01 -5.16844617e-02  2.26524836e-01]
 [-1.40567752e-02  4.35068567e-02 -1.32065651e-01]
 [-6.94005208e-02  2.74878772e-02 -1.32440031e-02]
 [ 1.22896359e-01  1.10036360e-02  3.40296465e-02]
 [ 2.69787298e-02 -1.22562899e-01 -2.26369981e-01]
 [-3.11178750e-03  3.39255199e-04  1.63198438e-01]
 [-1.85863525e-02 -1.26920426e-01 -4.05363561e-01]
 [ 7.21026070e-02  3.35609113e-01 -1.11863104e-01]
 [-4.25749401e-02 -3.07983004e-03 -1.15196094e-02]
 [ 3.75857841e-01 -2.28975284e-01  2.35075455e-01]
 [-1.10775593e-01  4.80124540e-02  5.25303576e-02]
 [ 3.03639218e-01 -3.45351346e-02  5.97282593e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.48184975]
curr_Stock_Price:  100.51540613830714
curr_Factors:  [100.51540614  -0.9957543   -0.97658164]
mat_Sqrt:  [[13.98485656  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01524107 -0.0330239   0.05406012]
Stock Position:  -0.015241070511136516
Bond Position:  [8.01381214]


portfolio before change:  [6.48248756]
curr_Stock_Price:  100.53928712089913
curr_Factors:  [100.53928712  -0.87242034  -0.96735985]
mat_Sqrt:  [[15.97090096  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00628087  0.02311512 -0.27200377]
Stock Position:  -0.006280874468020491
Bond Position:  [7.11396221]


portfolio before change:  [6.47676298]
curr_Stock_Price:  101.59230716413411
curr_Factors:  [101.59230716  -0.85982501  -0.95468083]
mat_Sqrt:  [[16.55125578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00897835 -0.00513843 -0.20636405]
Stock Position:  -0.008978346493040934
Bond Position:  [7.38889391]


portfolio before change:  [6.47735036]
curr_Stock_Price:  101.62976322806426
curr_Factors:  [101.62976323  -0.37964863  -0.94516266]
mat_Sqrt:  [[27.01859002  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224909  0.00315434 -0.02616371]
Stock Position:  -0.002249094662643487
Bond Position:  [6.70592531]


portfolio before change:  [6.47857057]
curr_Stock_Price:  101.45995274734454
curr_Factors:  [101.45995275  -0.6406463   -0.95364633]
mat_Sqrt:  [[20.60165748  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00506158 -0.05239464 -0.29304509]
Stock Position:  0.005061580037394047
Bond Position:  [5.9650229]


portfolio before change:  [6.47484492]
curr_Stock_Price:  100.57656819646712
curr_Factors:  [100.5765682   -0.5165842   -0.93050449]
mat_Sqrt:  [[23.66105922  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00636572 -0.05467625  0.1887663 ]
Stock Position:  -0.00636572464335982
Bond Position:  [7.11508766]


portfolio before change:  [6.46345809]
curr_Stock_Price:  102.50506365391308
curr_Factors:  [102.50506365  -0.69977214  -0.9329956 ]
mat_Sqrt:  [[20.02826361  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00483016 -0.06201017 -0.07981212]
Stock Position:  -0.004830162678014141
Bond Position:  [6.95857422]


portfolio before change:  [6.46350204]
curr_Stock_Price:  102.67605794265947
curr_Factors:  [102.67605794  -0.77582273  -0.94253202]
mat_Sqrt:  [[18.41608029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00816154 0.19385214 0.25544588]
Stock Position:  0.00816154357340727
Bond Position:  [5.62550692]


portfolio before change:  [6.45725278]
curr_Stock_Price:  101.82419858670475
curr_Factors:  [101.82419859  -0.73592058  -0.92986925]
mat_Sqrt:  [[19.24897761  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02437108 0.01179958 1.08509518]
Stock Position:  0.024371082467726235
Bond Position:  [3.97568684]


portfolio before change:  [6.47824316]
curr_Stock_Price:  102.66508794290773
curr_Factors:  [102.66508794  -0.79692396  -0.90536748]
mat_Sqrt:  [[18.7122928   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04532319 0.0955095  1.64144778]
Stock Position:  0.0453231938769684
Bond Position:  [1.82513347]


portfolio before change:  [6.51244513]
curr_Stock_Price:  103.41467801967099
curr_Factors:  [103.41467802  -0.84824186  -0.89088   ]
mat_Sqrt:  [[18.16733215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01570321 -0.10028115 -0.12579821]
Stock Position:  -0.015703214762445825
Bond Position:  [8.13638803]


portfolio before change:  [6.50320274]
curr_Stock_Price:  104.06801553361403
curr_Factors:  [104.06801553  -0.73352326  -0.86598279]
mat_Sqrt:  [[21.0213509   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00293468 -0.00659925  0.22744185]
Stock Position:  -0.002934677499135318
Bond Position:  [6.80860881]


portfolio before change:  [6.49571719]
curr_Stock_Price:  106.90876337071998
curr_Factors:  [106.90876337  -0.98418969  -0.90238987]
mat_Sqrt:  [[16.206238    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00129322 -0.03134996  0.35777109]
Stock Position:  0.0012932150945821049
Bond Position:  [6.35746117]


portfolio before change:  [6.49697437]
curr_Stock_Price:  107.26635401764962
curr_Factors:  [107.26635402  -1.03189474  -0.87230508]
mat_Sqrt:  [[15.97644115  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00020843  0.01057512 -0.16187183]
Stock Position:  -0.0002084336868721768
Bond Position:  [6.51933229]


portfolio before change:  [6.49784697]
curr_Stock_Price:  106.98984470224934
curr_Factors:  [106.9898447   -0.91214486  -0.87526282]
mat_Sqrt:  [[17.90940945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03276898 -0.0667154  -0.93057704]
Stock Position:  0.03276897977222589
Bond Position:  [2.99189891]


portfolio before change:  [6.47098578]
curr_Stock_Price:  106.15871713471086
curr_Factors:  [106.15871713  -0.62078527  -0.90142841]
mat_Sqrt:  [[23.16683258  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0068427  -0.03018362  0.30976966]
Stock Position:  -0.006842702776796782
Bond Position:  [7.19739833]


portfolio before change:  [6.48606117]
curr_Stock_Price:  104.08707017924512
curr_Factors:  [104.08707018  -0.2491136   -0.88754459]
mat_Sqrt:  [[33.40045648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00146608  0.00520149 -0.0871102 ]
Stock Position:  0.0014660832827073813
Bond Position:  [6.33346086]


portfolio before change:  [6.48407743]
curr_Stock_Price:  102.19394888769331
curr_Factors:  [102.19394889  -0.15167067  -0.91637098]
mat_Sqrt:  [[35.12210882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214034 -0.02118354  0.04759305]
Stock Position:  -0.0021403411107679387
Bond Position:  [6.70280734]


portfolio before change:  [6.47948819]
curr_Stock_Price:  104.72959216240143
curr_Factors:  [ 1.04729592e+02 -8.58863201e-03 -9.22436377e-01]
mat_Sqrt:  [[41.27911603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00315494 -0.06537486  0.09139841]
Stock Position:  0.0031549401642434476
Bond Position:  [6.1490726]


portfolio before change:  [6.48537898]
curr_Stock_Price:  106.35311088689097
curr_Factors:  [106.35311089   0.18459244  -0.92225407]
mat_Sqrt:  [[50.86134311  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.50047322e-03 3.06225148e-04 1.21326707e+00]
Stock Position:  0.0025004732215646672
Bond Position:  [6.21944587]


portfolio before change:  [6.48485516]
curr_Stock_Price:  105.83268970767475
curr_Factors:  [105.83268971   0.36856241  -0.92095505]
mat_Sqrt:  [[60.91423028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.60188358e-03  3.10410877e-01 -2.67341238e+00]
Stock Position:  -0.0016018835756356246
Bond Position:  [6.65438681]


portfolio before change:  [6.48895534]
curr_Stock_Price:  103.79238388583569
curr_Factors:  [103.79238389   0.42341634  -0.91996929]
mat_Sqrt:  [[63.1706409   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01321263  0.12786055 -0.00109347]
Stock Position:  0.013212634859563024
Bond Position:  [5.11758447]


portfolio before change:  [6.4519772]
curr_Stock_Price:  100.9452694464064
curr_Factors:  [100.94526945   0.25209295  -0.92783654]
mat_Sqrt:  [[51.35872806  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0010178   0.02827725 -0.00740475]
Stock Position:  0.0010178020649406806
Bond Position:  [6.34923489]


portfolio before change:  [6.45688287]
curr_Stock_Price:  104.985315202082
curr_Factors:  [ 1.04985315e+02 -9.72693186e-02 -9.59955599e-01]
mat_Sqrt:  [[36.47385009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242242 -0.03800905 -0.07485658]
Stock Position:  -0.0024224237189182747
Bond Position:  [6.71120179]


portfolio before change:  [6.45643967]
curr_Stock_Price:  105.51459823517597
curr_Factors:  [105.51459824  -0.44968306  -0.93588938]
mat_Sqrt:  [[26.39769968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.38311345e-05 -1.32443844e-02 -2.49921792e-02]
Stock Position:  3.383113448267217e-05
Bond Position:  [6.45286999]


portfolio before change:  [6.45730357]
curr_Stock_Price:  107.20644084818962
curr_Factors:  [107.20644085  -0.40397692  -0.92458467]
mat_Sqrt:  [[28.3944793   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.25171179e-05  5.80183978e-03  3.39904583e-02]
Stock Position:  -8.251711786839851e-05
Bond Position:  [6.46614994]


portfolio before change:  [6.45801047]
curr_Stock_Price:  108.43552946788697
curr_Factors:  [108.43552947  -0.32127436  -0.90035904]
mat_Sqrt:  [[31.96119134  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00403912 -0.00170498  0.63556069]
Stock Position:  0.004039122864183295
Bond Position:  [6.02002604]


portfolio before change:  [6.46485125]
curr_Stock_Price:  109.9428440545757
curr_Factors:  [109.94284405  -0.56172795  -0.88787801]
mat_Sqrt:  [[25.79948857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00794163 -0.01668109  0.64621231]
Stock Position:  0.007941634013809186
Bond Position:  [5.59172542]


portfolio before change:  [6.4598698]
curr_Stock_Price:  109.2275688692071
curr_Factors:  [109.22756887  -0.33921949  -0.88295565]
mat_Sqrt:  [[32.1772073   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00099865  0.01404178 -0.37674654]
Stock Position:  -0.000998649855499069
Bond Position:  [6.5689499]


portfolio before change:  [6.46131299]
curr_Stock_Price:  108.60470506757855
curr_Factors:  [108.60470507  -0.67432536  -0.8984739 ]
mat_Sqrt:  [[22.53152567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295111  0.00887167 -0.03778145]
Stock Position:  -0.002951109619607342
Bond Position:  [6.78181738]


portfolio before change:  [6.46034037]
curr_Stock_Price:  109.22156061736374
curr_Factors:  [109.22156062  -0.64424363  -0.91842192]
mat_Sqrt:  [[22.89029287  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00577051 0.00355141 0.09707711]
Stock Position:  0.005770513306132207
Bond Position:  [5.8300759]


portfolio before change:  [6.4546368]
curr_Stock_Price:  108.10686379634662
curr_Factors:  [108.1068638   -0.35253784  -0.93656372]
mat_Sqrt:  [[29.78540956  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148552 -0.03955701 -0.64577055]
Stock Position:  -0.0014855225029654522
Bond Position:  [6.61523198]


portfolio before change:  [6.45379058]
curr_Stock_Price:  109.23318260195849
curr_Factors:  [109.2331826   -0.47955485  -0.9126062 ]
mat_Sqrt:  [[27.14855556  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.11498397e-03 1.09494145e-04 4.65559719e-01]
Stock Position:  0.0011149839746338562
Bond Position:  [6.33199733]


portfolio before change:  [6.45590169]
curr_Stock_Price:  110.41666173924635
curr_Factors:  [110.41666174  -0.41902053  -0.93857793]
mat_Sqrt:  [[28.40776669  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.004479   -0.04096339 -1.15638941]
Stock Position:  -0.004478999277260019
Bond Position:  [6.95045784]


portfolio before change:  [6.46795637]
curr_Stock_Price:  107.91926910176691
curr_Factors:  [107.9192691   -0.27350182  -0.95218139]
mat_Sqrt:  [[31.68046468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00371758  0.10831738 -0.3191143 ]
Stock Position:  0.003717577094331413
Bond Position:  [6.06675817]


portfolio before change:  [6.468975]
curr_Stock_Price:  107.98927047953678
curr_Factors:  [ 1.07989270e+02 -8.83002294e-02 -9.69922769e-01]
mat_Sqrt:  [[37.48005319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00121545 -0.00099401 -0.03286224]
Stock Position:  -0.0012154475323647395
Bond Position:  [6.60023029]


portfolio before change:  [6.47199002]
curr_Stock_Price:  106.18751837400445
curr_Factors:  [106.18751837  -0.27758949  -0.94453462]
mat_Sqrt:  [[31.28323931  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01205448 -0.07390146  0.67060484]
Stock Position:  0.01205447523072363
Bond Position:  [5.19195521]


portfolio before change:  [6.47155956]
curr_Stock_Price:  106.09796718217227
curr_Factors:  [106.09796718  -0.35517767  -0.95821323]
mat_Sqrt:  [[28.53045149  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00316337  0.01549595  0.14985449]
Stock Position:  -0.0031633701221453307
Bond Position:  [6.8071867]


portfolio before change:  [6.47255785]
curr_Stock_Price:  106.0513913909946
curr_Factors:  [106.05139139  -0.50193689  -0.97768259]
mat_Sqrt:  [[24.15048155  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01278574 -0.01114617  0.1703881 ]
Stock Position:  0.012785738547065587
Bond Position:  [5.11661248]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.48877722]
Stock Price:  107.26991749005731
PL:  [-0.78114027]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.76309876e-02 -8.09438821e-02  1.23720286e-02]
 [-1.87631705e-01  6.48556215e-02 -2.15447527e-01]
 [-4.48893546e-02  5.05812521e-02  1.53987701e-02]
 [ 9.64975127e-02  6.72352141e-02  9.42663221e-02]
 [-4.85698168e-03  1.27519207e-01 -5.26004211e-02]
 [-6.67853240e-02 -1.48228588e-01  1.76726621e-01]
 [-6.09939437e-02 -1.84465494e-01  8.15538924e-02]
 [ 2.08856646e-02  7.28625649e-01  1.09486998e-01]
 [ 4.90704596e-02  3.51637262e-02  2.95194933e-02]
 [ 3.04526586e-01  1.12410030e-01  1.66554827e-01]
 [-3.74103113e-02 -1.05485775e-01  5.83786676e-02]
 [ 9.43755096e-02 -8.63715817e-03  1.35239308e-01]
 [ 1.25290155e-02 -3.31433111e-02  2.49875075e-02]
 [ 1.46756368e-02 -1.97016884e-01 -3.14363370e-02]
 [ 4.27356303e-02 -6.78719029e-02 -7.17322595e-02]
 [ 1.94206605e-01  2.28390080e-02 -7.93661093e-02]
 [ 4.87600480e-02  7.03272918e-03  3.47299723e-02]
 [-3.78278182e-02 -4.94547492e-02  5.56297391e-02]
 [ 7.02606754e-02 -3.33780959e-02 -9.85327267e-02]
 [ 5.21957237e-02 -1.30287877e-02  1.75765284e-01]
 [-2.58718979e-04  2.20128115e-01 -1.72445199e-01]
 [-2.50605285e-03  1.21994271e-02 -1.34677192e-02]
 [-1.18425036e-02  1.39420601e-02  4.07878940e-02]
 [ 1.30461558e-01 -1.58407181e-01 -3.22690523e-01]
 [ 4.21962908e-02  1.12471598e-02 -1.34783320e-02]
 [-5.93630476e-02 -7.76199888e-03  1.72573067e-01]
 [-1.45400039e-02 -3.23512109e-02  2.58997198e-03]
 [-9.28694189e-02  8.22414573e-02 -2.05429548e-01]
 [-6.38080538e-02 -3.06843363e-02 -1.33841102e-02]
 [-2.23641225e-02  1.49161484e-02 -1.67011517e-02]
 [ 3.42448235e-02 -4.45074671e-02 -9.22943655e-02]
 [-2.56865466e-02 -3.04342193e-02 -6.07486418e-02]
 [ 7.25760776e-02  1.38906869e-02  1.49594713e-01]
 [ 3.01494986e-02 -4.52645939e-02  1.15927402e-01]
 [-5.55217793e-02 -5.56890738e-02  3.24839915e-02]
 [ 7.80713235e-02 -2.81106993e-02  1.28348089e-01]
 [ 3.76062519e-02  1.53658946e-02  1.56383733e-02]
 [-4.64867096e-02 -1.67491070e-02  2.85278156e-02]
 [ 9.44378421e-02  5.85930584e-03  8.66312403e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.46954839]
curr_Stock_Price:  100.00956549559312
curr_Factors:  [100.0095655   -0.94425121  -1.03655785]
mat_Sqrt:  [[13.79707717  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00301717 -0.02612453  0.03529395]
Stock Position:  -0.003017172266853142
Bond Position:  [2.77129448]


portfolio before change:  [2.47010205]
curr_Stock_Price:  99.9408843747498
curr_Factors:  [99.94088437 -0.88657893 -1.04986417]
mat_Sqrt:  [[14.41307465  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01515091  0.02093206 -0.61461182]
Stock Position:  -0.015150906650540107
Bond Position:  [3.98429705]


portfolio before change:  [2.47908931]
curr_Stock_Price:  99.38057497097832
curr_Factors:  [99.38057497 -0.86420929 -1.06713444]
mat_Sqrt:  [[14.4055412   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218119  0.01632503  0.04392841]
Stock Position:  -0.00218119114952892
Bond Position:  [2.69585734]


portfolio before change:  [2.47957977]
curr_Stock_Price:  99.31021793494489
curr_Factors:  [99.31021793 -1.22176533 -1.10289857]
mat_Sqrt:  [[ 9.7141596   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01332734 0.02170007 0.26891558]
Stock Position:  0.013327336704105129
Bond Position:  [1.15603906]


portfolio before change:  [2.478981]
curr_Stock_Price:  99.25444628892501
curr_Factors:  [99.25444629 -1.21108187 -1.11141865]
mat_Sqrt:  [[ 9.72973051  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107256  0.04115665 -0.15005436]
Stock Position:  0.001072563261155352
Bond Position:  [2.37252433]


portfolio before change:  [2.47875023]
curr_Stock_Price:  98.76276644482067
curr_Factors:  [98.76276644 -1.35330988 -1.09311944]
mat_Sqrt:  [[ 8.5530792   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00712821 -0.04784057  0.50415186]
Stock Position:  -0.007128214981564766
Bond Position:  [3.18275246]


portfolio before change:  [2.47575653]
curr_Stock_Price:  99.2385612396164
curr_Factors:  [99.23856124 -1.62018911 -1.10611669]
mat_Sqrt:  [[ 6.49622258  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01262283 -0.05953598  0.23265055]
Stock Position:  -0.012622825874526615
Bond Position:  [3.72842761]


portfolio before change:  [2.48122437]
curr_Stock_Price:  98.8423141307122
curr_Factors:  [98.84231413 -1.41376049 -1.10763383]
mat_Sqrt:  [[ 7.9417327   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02417164 0.23516292 0.31233593]
Stock Position:  0.02417163853217775
Bond Position:  [0.09204368]


portfolio before change:  [2.49097212]
curr_Stock_Price:  99.24511049725993
curr_Factors:  [99.2451105  -1.44322424 -1.12204185]
mat_Sqrt:  [[ 7.63182163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00815976 0.01134904 0.0842109 ]
Stock Position:  0.008159764409557159
Bond Position:  [1.6811554]


portfolio before change:  [2.49934064]
curr_Stock_Price:  100.24493836909296
curr_Factors:  [100.24493837  -1.50469656  -1.11217772]
mat_Sqrt:  [[ 7.32096601  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04937464 0.03628018 0.47513456]
Stock Position:  0.04937463824083146
Bond Position:  [-2.45021693]


portfolio before change:  [2.52837853]
curr_Stock_Price:  100.83925527822511
curr_Factors:  [100.83925528  -1.67427909  -1.11600246]
mat_Sqrt:  [[ 6.19192585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00759473 -0.03404539  0.16653809]
Stock Position:  -0.007594730688723758
Bond Position:  [3.29422551]


portfolio before change:  [2.53419883]
curr_Stock_Price:  100.12711744025579
curr_Factors:  [100.12711744  -1.95765768  -1.12584879]
mat_Sqrt:  [[ 4.58566019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02621609 -0.00278763  0.3858001 ]
Stock Position:  0.02621608674247326
Bond Position:  [-0.09074237]


portfolio before change:  [2.52487103]
curr_Stock_Price:  99.77174586668933
curr_Factors:  [99.77174587 -1.73377208 -1.11346469]
mat_Sqrt:  [[ 5.78719819  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00187728 -0.01069696  0.0712824 ]
Stock Position:  0.0018772847763978725
Bond Position:  [2.33757105]


portfolio before change:  [2.52525068]
curr_Stock_Price:  99.81832010759528
curr_Factors:  [99.81832011 -1.62968882 -1.10376781]
mat_Sqrt:  [[ 6.4876158   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00492587 -0.06358693 -0.08967912]
Stock Position:  -0.004925874566813234
Bond Position:  [3.0169432]


portfolio before change:  [2.52432097]
curr_Stock_Price:  100.08362342592021
curr_Factors:  [100.08362343  -1.88092107  -1.08302189]
mat_Sqrt:  [[ 5.16581618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0027564  -0.02190556 -0.20463217]
Stock Position:  0.0027563988858044512
Bond Position:  [2.24845058]


portfolio before change:  [2.52460538]
curr_Stock_Price:  100.08483319774786
curr_Factors:  [100.0848332   -1.80207806  -1.08483818]
mat_Sqrt:  [[ 5.57951535  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03273905  0.00737126 -0.22640942]
Stock Position:  0.032739054753957095
Bond Position:  [-0.75207746]


portfolio before change:  [2.51607907]
curr_Stock_Price:  99.82727243029417
curr_Factors:  [99.82727243 -1.87556589 -1.08833109]
mat_Sqrt:  [[ 5.15282153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01111718 0.0022698  0.09907494]
Stock Position:  0.01111717597513855
Bond Position:  [1.40628171]


portfolio before change:  [2.51831486]
curr_Stock_Price:  100.01257152715732
curr_Factors:  [100.01257153  -1.85260794  -1.10273108]
mat_Sqrt:  [[ 5.20675527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00702306 -0.01596145  0.15869616]
Stock Position:  -0.00702305980212872
Bond Position:  [3.22070914]


portfolio before change:  [2.51626219]
curr_Stock_Price:  100.36217555038253
curr_Factors:  [100.36217555  -2.16358309  -1.12613637]
mat_Sqrt:  [[ 3.73992645  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01158699 -0.01077273 -0.28108644]
Stock Position:  0.01158699029015733
Bond Position:  [1.35336663]


portfolio before change:  [2.51586957]
curr_Stock_Price:  100.31368989131997
curr_Factors:  [100.31368989  -2.07801482  -1.11649773]
mat_Sqrt:  [[ 4.11150698  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02077442 -0.00420502  0.50140943]
Stock Position:  0.020774419783273917
Bond Position:  [0.43191086]


portfolio before change:  [2.51911401]
curr_Stock_Price:  100.46726591009953
curr_Factors:  [100.46726591  -2.30990216  -1.1009438 ]
mat_Sqrt:  [[ 3.31675203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00285656  0.07104604 -0.49193815]
Stock Position:  0.002856564280634142
Bond Position:  [2.23212281]


portfolio before change:  [2.5194879]
curr_Stock_Price:  100.50047350591875
curr_Factors:  [100.50047351  -2.09865139  -1.10462849]
mat_Sqrt:  [[ 4.08320639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00067715  0.00393735 -0.03841965]
Stock Position:  -0.0006771496757732825
Bond Position:  [2.58754177]


portfolio before change:  [2.51983239]
curr_Stock_Price:  100.46942537690903
curr_Factors:  [100.46942538  -1.86370417  -1.08394834]
mat_Sqrt:  [[ 5.27089903  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00012726  0.00449978  0.11635651]
Stock Position:  -0.00012726453677471951
Bond Position:  [2.53261859]


portfolio before change:  [2.52020429]
curr_Stock_Price:  100.03487775932823
curr_Factors:  [100.03487776  -1.72583023  -1.06792189]
mat_Sqrt:  [[ 6.12125281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00526982 -0.0511257  -0.92054624]
Stock Position:  0.005269820040706884
Bond Position:  [1.99303849]


portfolio before change:  [2.51823892]
curr_Stock_Price:  99.6146511345358
curr_Factors:  [99.61465113 -1.59033234 -1.06117141]
mat_Sqrt:  [[ 7.02732068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0059398   0.00363001 -0.03844993]
Stock Position:  0.005939796488927758
Bond Position:  [1.92654816]


portfolio before change:  [2.51346884]
curr_Stock_Price:  98.77103371331772
curr_Factors:  [98.77103371 -1.50125403 -1.069182  ]
mat_Sqrt:  [[ 7.55619944  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00340398 -0.00250517  0.49230293]
Stock Position:  -0.003403976998452936
Bond Position:  [2.84968316]


portfolio before change:  [2.51330312]
curr_Stock_Price:  98.92436929842312
curr_Factors:  [98.9243693  -1.67122803 -1.07908035]
mat_Sqrt:  [[ 6.3220735   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0032608  -0.01044131  0.00738847]
Stock Position:  -0.0032607959040532094
Bond Position:  [2.8358753]


portfolio before change:  [2.51436166]
curr_Stock_Price:  98.70845864770601
curr_Factors:  [98.70845865 -1.98687507 -1.08426108]
mat_Sqrt:  [[ 4.5769576   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02578461  0.02654332 -0.58603332]
Stock Position:  -0.025784613479691354
Bond Position:  [5.05952112]


portfolio before change:  [2.5224415]
curr_Stock_Price:  98.41962915469362
curr_Factors:  [98.41962915 -1.79486187 -1.08727753]
mat_Sqrt:  [[ 5.51295549  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01320589 -0.00990333 -0.03818114]
Stock Position:  -0.01320589073389868
Bond Position:  [3.82216037]


portfolio before change:  [2.52285893]
curr_Stock_Price:  98.4242004029263
curr_Factors:  [98.4242004  -1.73018923 -1.10546838]
mat_Sqrt:  [[ 5.77552464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00393531  0.00481417 -0.04764374]
Stock Position:  -0.003935310847164251
Bond Position:  [2.91018876]


portfolio before change:  [2.52173236]
curr_Stock_Price:  98.80291833027655
curr_Factors:  [98.80291833 -1.64452026 -1.07749242]
mat_Sqrt:  [[ 6.49553135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00097302 -0.01436472 -0.26329014]
Stock Position:  0.000973017597066402
Bond Position:  [2.42559538]


portfolio before change:  [2.52192425]
curr_Stock_Price:  98.6885057842018
curr_Factors:  [98.68850578 -1.71889356 -1.03641232]
mat_Sqrt:  [[ 6.27555922  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.007059   -0.0098226  -0.17329897]
Stock Position:  -0.007058999619740298
Bond Position:  [3.21856637]


portfolio before change:  [2.5204378]
curr_Stock_Price:  98.95607822945193
curr_Factors:  [98.95607823 -1.6323606  -1.04834617]
mat_Sqrt:  [[ 6.77994731  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01562658 0.0044832  0.42675208]
Stock Position:  0.015626580900013936
Bond Position:  [0.97409264]


portfolio before change:  [2.52205154]
curr_Stock_Price:  99.05155461866757
curr_Factors:  [99.05155462 -1.81458697 -1.01313934]
mat_Sqrt:  [[ 5.85862048  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00760819 -0.01460908  0.33070861]
Stock Position:  0.007608187634464867
Bond Position:  [1.76844873]


portfolio before change:  [2.52677348]
curr_Stock_Price:  99.64313701838543
curr_Factors:  [99.64313702 -1.93127244 -1.04152648]
mat_Sqrt:  [[ 5.09773461  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01182064 -0.01797357  0.09266779]
Stock Position:  -0.011820642188855437
Bond Position:  [3.70461935]


portfolio before change:  [2.5256333]
curr_Stock_Price:  99.77877137541623
curr_Factors:  [99.77877138 -1.74297911 -1.07684284]
mat_Sqrt:  [[ 5.94846675  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0165643  -0.00907269  0.36614137]
Stock Position:  0.016564301191814148
Bond Position:  [0.87286768]


portfolio before change:  [2.53582159]
curr_Stock_Price:  100.3872590825221
curr_Factors:  [100.38725908  -1.49196203  -1.0773953 ]
mat_Sqrt:  [[ 7.68813292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00571465 0.00495932 0.04461193]
Stock Position:  0.005714647766956675
Bond Position:  [1.96214376]


portfolio before change:  [2.53662995]
curr_Stock_Price:  100.48579061960558
curr_Factors:  [100.48579062  -1.30576327  -1.05486981]
mat_Sqrt:  [[ 9.48188606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00464912 -0.00540575  0.08138192]
Stock Position:  -0.004649116269878346
Bond Position:  [3.00380007]


portfolio before change:  [2.54115509]
curr_Stock_Price:  99.59322392611942
curr_Factors:  [99.59322393 -1.36699765 -1.05348546]
mat_Sqrt:  [[ 8.85171317  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01280175 0.00189108 0.24713482]
Stock Position:  0.01280174736524148
Bond Position:  [1.2661878]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.5444237]
Stock Price:  99.83618506069679
PL:  [2.5444237]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.73423327e-01 -5.46291126e-02  4.40397730e-03]
 [-1.70543812e-01 -3.58825146e-02  1.48134443e-01]
 [ 1.87431156e-02  6.88039052e-02  5.92517011e-02]
 [ 1.43677246e-01  1.33102924e-01  6.00891128e-02]
 [-6.59311264e-02  2.08861270e-01 -1.65740024e-02]
 [-8.04414281e-03 -1.65824192e-01 -3.54576036e-03]
 [-6.42442684e-02 -3.47986163e-01 -2.44155421e-01]
 [-3.31852685e-02  8.87952028e-01  1.80358415e-01]
 [-9.66872048e-03  3.14044754e-02 -5.31022376e-02]
 [ 1.54765931e-01  4.99409452e-02  4.00567292e-02]
 [-6.01511392e-02 -2.42230777e-01 -2.72158219e-02]
 [-2.79896808e-02 -1.76794985e-02  9.35427460e-02]
 [-1.91124341e-02  8.78140087e-02  8.92247701e-03]
 [ 8.20875106e-03 -8.93363460e-02  5.54256519e-02]
 [-8.05404366e-02  1.96380622e-01 -3.99941404e-02]
 [ 1.30474917e-02 -2.84554987e-02  2.69571708e-02]
 [ 3.78666621e-02  1.17405203e-01 -1.53095734e-01]
 [ 4.86955420e-03 -4.89499234e-02 -3.99653188e-02]
 [ 2.93670044e-02  7.97291372e-02 -2.17457886e-01]
 [-6.58450449e-02  2.42846338e-02 -5.67663766e-02]
 [-4.18547293e-02  4.95353586e-01 -4.32361335e-01]
 [ 2.92066153e-01  1.75193308e-01  7.48170139e-02]
 [ 5.40695015e-03 -4.88739341e-02  7.91868610e-02]
 [-1.52817206e-02  2.68776775e-02 -4.44386751e-02]
 [ 8.99121815e-03  1.95583949e-02 -1.01857334e-02]
 [-7.44107736e-02 -1.14444750e-02  1.90258081e-01]
 [-1.54854534e-02 -3.23920108e-02  2.22628435e-03]
 [-5.72865892e-02  3.85428367e-02 -2.38729983e-01]
 [-4.75317722e-03 -3.87829854e-02  6.52118467e-02]
 [-1.09903510e-02  3.16862253e-02 -3.90093227e-02]
 [-6.48198295e-03 -3.84961464e-02 -2.89919197e-02]
 [ 2.65932927e-02  1.14541343e-01 -7.55828110e-02]
 [-4.02970310e-02  2.37926394e-02 -1.38107662e-01]
 [ 1.96256654e-02 -5.88302735e-02  4.70076142e-02]
 [-4.29848320e-02  4.57535182e-02  2.46817158e-02]
 [ 8.01677955e-02  3.33174059e-02  1.86507961e-01]
 [ 9.20355937e-02 -6.33620680e-02  2.54518449e-02]
 [-8.07446427e-02  1.46431816e-02  4.02258524e-02]
 [ 1.18798975e-01  2.71281854e-03  1.04648295e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.06785207]
curr_Stock_Price:  99.43752432555482
curr_Factors:  [99.43752433 -0.92623911 -0.97657571]
mat_Sqrt:  [[14.83092808  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01100209 -0.01763147  0.01256332]
Stock Position:  0.011002087240505172
Bond Position:  [-3.16187239]


portfolio before change:  [-2.08655422]
curr_Stock_Price:  97.7735771539278
curr_Factors:  [97.77357715 -0.98989019 -0.95314455]
mat_Sqrt:  [[14.00787433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01053911 -0.01158103  0.42258633]
Stock Position:  -0.010539106761418476
Bond Position:  [-1.05610805]


portfolio before change:  [-2.08181644]
curr_Stock_Price:  97.31150784678401
curr_Factors:  [97.31150785 -0.74784606 -0.94333331]
mat_Sqrt:  [[17.93470898  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00250254 0.02220636 0.16902861]
Stock Position:  0.0025025416828445856
Bond Position:  [-2.32534255]


portfolio before change:  [-2.08487572]
curr_Stock_Price:  96.20519591300945
curr_Factors:  [96.20519591 -0.62895352 -0.95588799]
mat_Sqrt:  [[19.72016782  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00928554 0.04295878 0.17141751]
Stock Position:  0.009285539928122526
Bond Position:  [-2.97819291]


portfolio before change:  [-2.08594758]
curr_Stock_Price:  96.12985661390942
curr_Factors:  [96.12985661 -0.49613805 -0.96347787]
mat_Sqrt:  [[22.33341602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00119465  0.06740969 -0.04728102]
Stock Position:  -0.0011946516437560263
Bond Position:  [-1.97110589]


portfolio before change:  [-2.08552583]
curr_Stock_Price:  95.57056933798432
curr_Factors:  [95.57056934 -0.7085524  -0.99214151]
mat_Sqrt:  [[17.44705745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244263 -0.05351953 -0.01011507]
Stock Position:  -0.002442626197629364
Bond Position:  [-1.85208266]


portfolio before change:  [-2.08597443]
curr_Stock_Price:  95.65943662403757
curr_Factors:  [95.65943662 -1.03062473 -0.9948026 ]
mat_Sqrt:  [[12.62106227  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01466712 -0.11231205 -0.69650746]
Stock Position:  -0.014667122240680407
Bond Position:  [-0.68292578]


portfolio before change:  [-2.09503062]
curr_Stock_Price:  96.27106421122998
curr_Factors:  [96.27106421 -0.98151138 -0.99545288]
mat_Sqrt:  [[13.33248507  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01386708 0.28658528 0.51451236]
Stock Position:  0.01386708378752096
Bond Position:  [-3.43002953]


portfolio before change:  [-2.07656883]
curr_Stock_Price:  97.63332368440962
curr_Factors:  [97.63332368 -1.14579199 -0.9798877 ]
mat_Sqrt:  [[11.65271477  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00120983  0.01013575 -0.1514859 ]
Stock Position:  -0.0012098260286909856
Bond Position:  [-1.95844949]


portfolio before change:  [-2.07685271]
curr_Stock_Price:  97.66560703947476
curr_Factors:  [97.66560704 -1.33910525 -0.97235536]
mat_Sqrt:  [[ 9.68026097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01788553 0.01611837 0.1142707 ]
Stock Position:  0.017885533291781844
Bond Position:  [-3.82365418]


portfolio before change:  [-2.09222913]
curr_Stock_Price:  96.83261921090863
curr_Factors:  [96.83261921 -1.08742066 -0.98148436]
mat_Sqrt:  [[12.23228649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00941375 -0.07817965 -0.07763916]
Stock Position:  -0.00941375072234994
Bond Position:  [-1.18067099]


portfolio before change:  [-2.09444568]
curr_Stock_Price:  97.05239917390564
curr_Factors:  [97.05239917 -0.99030447 -1.00778096]
mat_Sqrt:  [[13.15978515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095018 -0.00570603  0.26685142]
Stock Position:  -0.0009501796635688295
Bond Position:  [-2.00222846]


portfolio before change:  [-2.09527365]
curr_Stock_Price:  97.66037183238711
curr_Factors:  [97.66037183 -0.95482385 -1.01879929]
mat_Sqrt:  [[13.57015274  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [4.67067933e-05 2.83418494e-02 2.54533434e-02]
Stock Position:  4.670679327376625e-05
Bond Position:  [-2.09983506]


portfolio before change:  [-2.09554847]
curr_Stock_Price:  97.3964555820453
curr_Factors:  [97.39645558 -0.69808379 -0.97305539]
mat_Sqrt:  [[18.31372253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.02620459e-05 -2.88331817e-02  1.58113957e-01]
Stock Position:  7.02620459404516e-05
Bond Position:  [-2.10239175]


portfolio before change:  [-2.09582997]
curr_Stock_Price:  97.13061240396256
curr_Factors:  [97.1306124  -0.72373216 -0.99954166]
mat_Sqrt:  [[17.33595672  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280447  0.06338157 -0.11409215]
Stock Position:  -0.0028044705256842703
Bond Position:  [-1.82343003]


portfolio before change:  [-2.0948452]
curr_Stock_Price:  96.69819127633492
curr_Factors:  [96.69819128 -0.46911785 -0.98206392]
mat_Sqrt:  [[22.65573297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0005624  -0.00918397  0.0769013 ]
Stock Position:  0.0005624027636879511
Bond Position:  [-2.14922853]


portfolio before change:  [-2.09580918]
curr_Stock_Price:  95.46187028810195
curr_Factors:  [95.46187029 -0.62659805 -1.00732162]
mat_Sqrt:  [[18.63063425  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00164146  0.03789237 -0.43673952]
Stock Position:  0.0016414558124186102
Bond Position:  [-2.25250562]


portfolio before change:  [-2.09453438]
curr_Stock_Price:  96.41004290192114
curr_Factors:  [96.4100429  -0.6617694  -1.00318985]
mat_Sqrt:  [[18.24062275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072806 -0.01579852 -0.11400993]
Stock Position:  -0.0007280559335000914
Bond Position:  [-2.02434247]


portfolio before change:  [-2.09544514]
curr_Stock_Price:  97.31341022970507
curr_Factors:  [97.31341023 -0.44290136 -1.03525675]
mat_Sqrt:  [[22.19303916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.64700178e-05  2.57324684e-02 -6.20346820e-01]
Stock Position:  5.647001776474404e-05
Bond Position:  [-2.10094043]


portfolio before change:  [-2.09567512]
curr_Stock_Price:  97.89166483359598
curr_Factors:  [97.89166483 -0.19089575 -1.04394065]
mat_Sqrt:  [[28.4749572   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254523  0.00783783 -0.16193867]
Stock Position:  -0.00254523131822222
Bond Position:  [-1.84651819]


portfolio before change:  [-2.08937828]
curr_Stock_Price:  95.32699932189941
curr_Factors:  [95.32699932 -0.2798861  -1.02124599]
mat_Sqrt:  [[25.95024344  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.11738797e-03  1.59874682e-01 -1.23340654e+00]
Stock Position:  -0.0011173879733268402
Bond Position:  [-1.98286104]


portfolio before change:  [-2.09104128]
curr_Stock_Price:  96.59346245602654
curr_Factors:  [96.59346246 -0.62303083 -1.01960479]
mat_Sqrt:  [[18.68788475  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01835945 0.0565434  0.21343212]
Stock Position:  0.01835945055817624
Bond Position:  [-3.86444418]


portfolio before change:  [-2.09360455]
curr_Stock_Price:  96.48015958576718
curr_Factors:  [96.48015959 -0.52115347 -1.01653937]
mat_Sqrt:  [[20.73129807  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00055928 -0.01577399  0.22589807]
Stock Position:  0.000559277590941779
Bond Position:  [-2.14756374]


portfolio before change:  [-2.09340044]
curr_Stock_Price:  97.32512126277224
curr_Factors:  [97.32512126 -0.42215287 -1.01278591]
mat_Sqrt:  [[23.17602532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00081405  0.00867473 -0.12677117]
Stock Position:  -0.000814045719868457
Bond Position:  [-2.01417334]


portfolio before change:  [-2.09460256]
curr_Stock_Price:  98.4925326096971
curr_Factors:  [98.49253261 -0.80325764 -1.05814127]
mat_Sqrt:  [[15.31115772  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071219  0.00631244 -0.02905706]
Stock Position:  0.0007121868159207636
Bond Position:  [-2.16474764]


portfolio before change:  [-2.09436502]
curr_Stock_Price:  99.2060381919435
curr_Factors:  [99.20603819 -0.93566139 -1.06621402]
mat_Sqrt:  [[13.40092143  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282895 -0.00369369  0.54275335]
Stock Position:  -0.0028289546671258596
Bond Position:  [-1.81371563]


portfolio before change:  [-2.09466883]
curr_Stock_Price:  99.23328497987171
curr_Factors:  [99.23328498 -0.75048691 -1.07350231]
mat_Sqrt:  [[16.01433527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00135148 -0.01045448  0.00635097]
Stock Position:  -0.0013514770455465251
Bond Position:  [-1.96055732]


portfolio before change:  [-2.09408361]
curr_Stock_Price:  98.61891795517158
curr_Factors:  [98.61891796 -0.52072361 -1.05231737]
mat_Sqrt:  [[20.45489311  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00479834  0.01243965 -0.68103019]
Stock Position:  -0.0047983442802483215
Bond Position:  [-1.62087609]


portfolio before change:  [-2.09508304]
curr_Stock_Price:  98.78497726069038
curr_Factors:  [98.78497726 -0.29192414 -1.02205824]
mat_Sqrt:  [[26.54823229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.41670137e-05 -1.25171547e-02  1.86031247e-01]
Stock Position:  2.4167013656141597e-05
Bond Position:  [-2.09747038]


portfolio before change:  [-2.09538099]
curr_Stock_Price:  97.30559043662501
curr_Factors:  [97.30559044 -0.23624235 -1.00227319]
mat_Sqrt:  [[28.20053359  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044273  0.01022669 -0.11128274]
Stock Position:  -0.00044272821954453076
Bond Position:  [-2.05230106]


portfolio before change:  [-2.09580835]
curr_Stock_Price:  97.69138869966172
curr_Factors:  [97.6913887  -0.47280776 -1.01079864]
mat_Sqrt:  [[22.15818626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00091424 -0.01242458 -0.08270588]
Stock Position:  -0.000914241197822325
Bond Position:  [-2.00649486]


portfolio before change:  [-2.09670967]
curr_Stock_Price:  98.40289556092966
curr_Factors:  [98.40289556 -0.29076117 -1.02954828]
mat_Sqrt:  [[26.27875407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00131459  0.03696806 -0.21561672]
Stock Position:  0.0013145855219544088
Bond Position:  [-2.22606869]


portfolio before change:  [-2.09536048]
curr_Stock_Price:  99.64089618102481
curr_Factors:  [99.64089618 -0.25951319 -1.04297235]
mat_Sqrt:  [[27.08790032  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00234907  0.00767904 -0.39398272]
Stock Position:  -0.002349074180262875
Bond Position:  [-1.86129663]


portfolio before change:  [-2.09617017]
curr_Stock_Price:  99.88652839104937
curr_Factors:  [99.88652839 -0.42500281 -1.04316066]
mat_Sqrt:  [[23.00867577  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074808 -0.01898739  0.13409964]
Stock Position:  0.0007480819576499042
Bond Position:  [-2.17089348]


portfolio before change:  [-2.09572031]
curr_Stock_Price:  100.8506390604322
curr_Factors:  [100.85063906  -0.71106219  -1.03403157]
mat_Sqrt:  [[17.61140753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162436  0.01476688  0.07041007]
Stock Position:  -0.0016243619391978713
Bond Position:  [-1.93190237]


portfolio before change:  [-2.09765648]
curr_Stock_Price:  101.89391944026546
curr_Factors:  [101.89391944  -0.7804374   -1.04355913]
mat_Sqrt:  [[16.44358999  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00760415 0.01075315 0.5320553 ]
Stock Position:  0.0076041460975421376
Bond Position:  [-2.87247273]


portfolio before change:  [-2.09478091]
curr_Stock_Price:  102.31929979614496
curr_Factors:  [102.3192998   -0.83426743  -1.07390431]
mat_Sqrt:  [[15.17920776  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00555347 -0.02045002  0.07260703]
Stock Position:  0.005553465181540357
Bond Position:  [-2.66300758]


portfolio before change:  [-2.09157481]
curr_Stock_Price:  102.95655881109496
curr_Factors:  [102.95655881  -0.85867454  -1.07547547]
mat_Sqrt:  [[14.88206995  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00467304  0.00472607  0.11475316]
Stock Position:  -0.004673042675622182
Bond Position:  [-1.61045442]


portfolio before change:  [-2.09005724]
curr_Stock_Price:  102.58872693494726
curr_Factors:  [102.58872693  -0.6943129   -1.07331878]
mat_Sqrt:  [[17.51567819  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0080336  0.00087556 0.29853246]
Stock Position:  0.00803360105081601
Bond Position:  [-2.91421414]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.09008117]
Stock Price:  102.63109402493515
PL:  [-4.7211752]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.02211151e-01 -9.04058389e-02  1.52837625e-02]
 [-9.13006818e-02  6.38980222e-02  7.49131290e-02]
 [-4.23144474e-02  5.11890908e-02  1.79766147e-02]
 [ 6.17059258e-02  9.89777653e-02  3.78176988e-02]
 [ 9.81630792e-03  8.93658732e-02 -6.18601693e-02]
 [-8.20384816e-02 -1.56866247e-01  1.30161051e-01]
 [-5.92695421e-02 -1.80108025e-01  1.03081713e-01]
 [ 1.48483770e-02  7.12998580e-01  9.25972412e-02]
 [ 1.46071472e-02  4.37090699e-02 -1.68762622e-02]
 [ 2.48921919e-01  8.92158693e-02  1.19587320e-01]
 [-2.17206339e-01 -2.75422595e-01 -2.51816461e-03]
 [-1.43037321e-02 -1.72059920e-02  9.52393275e-02]
 [-8.23205361e-03  5.02470349e-02  1.29234351e-02]
 [ 1.11538396e-02 -1.50167237e-01  4.68768177e-02]
 [-3.76504997e-02  9.55307880e-02 -4.55521397e-02]
 [ 5.16701894e-02 -1.76243567e-02  1.08539950e-02]
 [ 5.32053017e-02  5.72425530e-02 -8.20179712e-02]
 [-2.03878678e-02 -5.61915765e-02 -2.38677279e-02]
 [ 1.04215246e-02  9.37454843e-02 -1.80887939e-01]
 [-8.28223669e-02 -1.58263353e-02 -2.46057415e-02]
 [-4.10959496e-02  5.04255562e-01 -4.54658176e-01]
 [ 3.49919421e-01  1.97665645e-01  7.13345944e-02]
 [ 8.26229622e-03 -5.66186645e-02  8.46036139e-02]
 [ 8.34685863e-02  1.47183165e-01 -4.31300105e-02]
 [-1.56010193e-01  4.70152927e-02  6.28525795e-03]
 [-1.71227108e-01 -3.12458368e-02  1.57618263e-01]
 [-7.80214297e-02 -3.50906871e-02 -2.18295336e-02]
 [-9.28297135e-02  1.25070901e-01 -6.77997842e-02]
 [ 3.68164219e-01  1.06769519e-01  3.33773651e-01]
 [ 1.76530060e-01  1.15455713e-01 -2.33045083e-01]
 [ 1.02083855e-01  1.29162932e-01  2.45818475e-01]
 [-2.61984208e-02 -5.66836669e-03 -7.73619134e-02]
 [ 1.69645330e-02  1.14545447e-01 -2.82637278e-02]
 [ 6.84289511e-04 -4.78107153e-02  1.11504486e-01]
 [-8.14616291e-02  1.07826897e-01 -1.15844087e-01]
 [-2.45200176e-01 -2.54734615e-01 -2.32930460e-01]
 [ 1.10739252e-01  1.44617452e-01  3.69384513e-01]
 [ 2.48463955e-01 -1.63471093e-01 -3.40039016e-01]
 [ 9.39227890e-02  6.17839426e-03  8.96802525e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.52448942]
curr_Stock_Price:  100.14256449029514
curr_Factors:  [100.14256449  -0.86423048  -0.97250731]
mat_Sqrt:  [[15.95635251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00736668 -0.02917836  0.04360032]
Stock Position:  -0.007366682352677695
Bond Position:  [4.26220788]


portfolio before change:  [3.53110872]
curr_Stock_Price:  99.31634546838261
curr_Factors:  [99.31634547 -0.7138675  -0.94027043]
mat_Sqrt:  [[18.99493245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331488  0.020623    0.21370631]
Stock Position:  -0.003314882767663557
Bond Position:  [3.86033076]


portfolio before change:  [3.53129374]
curr_Stock_Price:  99.40610722071969
curr_Factors:  [99.40610722 -0.85258215 -0.94098189]
mat_Sqrt:  [[16.53781396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170494  0.01652121  0.05128228]
Stock Position:  -0.0017049446174839933
Bond Position:  [3.70077565]


portfolio before change:  [3.53138067]
curr_Stock_Price:  99.62646576392453
curr_Factors:  [99.62646576 -0.58916085 -0.93181971]
mat_Sqrt:  [[21.76813694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00411745 0.03194494 0.10788337]
Stock Position:  0.004117448508746985
Bond Position:  [3.12117382]


portfolio before change:  [3.53181796]
curr_Stock_Price:  99.63790912628399
curr_Factors:  [99.63790913 -0.81143287 -0.96343654]
mat_Sqrt:  [[16.88918199  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00091366  0.02884271 -0.17646984]
Stock Position:  0.0009136550376862055
Bond Position:  [3.44078328]


portfolio before change:  [3.53252754]
curr_Stock_Price:  99.94378047894608
curr_Factors:  [99.94378048 -0.86755271 -0.94196947]
mat_Sqrt:  [[16.36403031  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00534646 -0.05062836  0.37131325]
Stock Position:  -0.005346461432508459
Bond Position:  [4.06687311]


portfolio before change:  [3.53213939]
curr_Stock_Price:  100.11146948485037
curr_Factors:  [100.11146948  -0.96732577  -0.93645374]
mat_Sqrt:  [[14.91704838  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0050273  -0.05812962  0.29406344]
Stock Position:  -0.005027299648601981
Bond Position:  [4.03542974]


portfolio before change:  [3.53640461]
curr_Stock_Price:  99.36340257516362
curr_Factors:  [99.36340258 -0.95360868 -0.90140453]
mat_Sqrt:  [[15.54549149  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01153324 0.2301193  0.26415415]
Stock Position:  0.011533243287544268
Bond Position:  [2.39042231]


portfolio before change:  [3.52642288]
curr_Stock_Price:  98.4720182624042
curr_Factors:  [98.47201826 -1.1107875  -0.89751431]
mat_Sqrt:  [[13.21656037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00151964  0.01410704 -0.04814328]
Stock Position:  0.0015196367709373248
Bond Position:  [3.37678118]


portfolio before change:  [3.52687559]
curr_Stock_Price:  98.49214925214062
curr_Factors:  [98.49214925 -1.20018659 -0.90554844]
mat_Sqrt:  [[11.99202452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02431147 0.0287943  0.34114934]
Stock Position:  0.024311465569863775
Bond Position:  [1.1323871]


portfolio before change:  [3.54490432]
curr_Stock_Price:  99.22789964438178
curr_Factors:  [99.22789964 -1.05451962 -0.91611548]
mat_Sqrt:  [[13.82922528  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01980883 -0.08889226 -0.00718362]
Stock Position:  -0.0198088290278277
Bond Position:  [5.51049282]


portfolio before change:  [3.55544971]
curr_Stock_Price:  98.73031650915783
curr_Factors:  [98.73031651 -1.0646534  -0.9164253 ]
mat_Sqrt:  [[13.616923    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.19318868e-04 -5.55321004e-03  2.71691292e-01]
Stock Position:  0.0001193188678913368
Bond Position:  [3.54366932]


portfolio before change:  [3.55594744]
curr_Stock_Price:  99.18910114412316
curr_Factors:  [99.18910114 -1.14444972 -0.90018262]
mat_Sqrt:  [[12.83782379  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00036319 0.01621716 0.03686696]
Stock Position:  0.00036318963797565167
Bond Position:  [3.51992299]


portfolio before change:  [3.55624266]
curr_Stock_Price:  98.7904199272315
curr_Factors:  [98.79041993 -0.83813438 -0.92571213]
mat_Sqrt:  [[16.93113309  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058651 -0.04846627  0.13372651]
Stock Position:  -0.0005865070483934166
Bond Position:  [3.61418394]


portfolio before change:  [3.55664645]
curr_Stock_Price:  98.87228252611926
curr_Factors:  [98.87228253 -0.66416956 -0.93863962]
mat_Sqrt:  [[19.90597152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137892  0.03083243 -0.12994758]
Stock Position:  -0.001378915406139386
Bond Position:  [3.69298296]


portfolio before change:  [3.55924213]
curr_Stock_Price:  97.32466665561446
curr_Factors:  [97.32466666 -0.61609161 -0.92256888]
mat_Sqrt:  [[20.89253627  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00240699 -0.00568824  0.03096343]
Stock Position:  0.0024069933114972885
Bond Position:  [3.32498231]


portfolio before change:  [3.56005314]
curr_Stock_Price:  97.48892107291122
curr_Factors:  [97.48892107 -0.71326895 -0.92175438]
mat_Sqrt:  [[19.00525295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00253341  0.01847495 -0.23397444]
Stock Position:  0.002533406988999538
Bond Position:  [3.31307403]


portfolio before change:  [3.56040773]
curr_Stock_Price:  97.46540660609915
curr_Factors:  [97.46540661 -0.54274261 -0.92791964]
mat_Sqrt:  [[22.39494499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016401  -0.01813575 -0.06808798]
Stock Position:  -0.0016400980166213035
Bond Position:  [3.72026055]


portfolio before change:  [3.56140253]
curr_Stock_Price:  97.14241674078811
curr_Factors:  [97.14241674 -0.4841692  -0.91954734]
mat_Sqrt:  [[23.86616054  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.08652679e-04  3.02562250e-02 -5.16022940e-01]
Stock Position:  -0.00030865267884894583
Bond Position:  [3.59138579]


portfolio before change:  [3.56228346]
curr_Stock_Price:  95.74285724210675
curr_Factors:  [95.74285724 -0.56489305 -0.90788721]
mat_Sqrt:  [[21.95260403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00414873 -0.00510793 -0.07019333]
Stock Position:  -0.004148734695514024
Bond Position:  [3.95949517]


portfolio before change:  [3.55814028]
curr_Stock_Price:  96.8608217957721
curr_Factors:  [96.8608218  -0.39353133 -0.88610534]
mat_Sqrt:  [[26.94070804  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.14963295e-03  1.62747783e-01 -1.29701322e+00]
Stock Position:  -0.0011496329488481095
Bond Position:  [3.66949468]


portfolio before change:  [3.55985384]
curr_Stock_Price:  95.76930854092211
curr_Factors:  [95.76930854 -0.48229042 -0.90716936]
mat_Sqrt:  [[23.86665964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01696211 0.06379631 0.20349774]
Stock Position:  0.0169621082615115
Bond Position:  [1.93540446]


portfolio before change:  [3.54144242]
curr_Stock_Price:  94.66960087995619
curr_Factors:  [ 9.46696009e+01 -2.90482279e-02 -8.87934694e-01]
mat_Sqrt:  [[37.84163767  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00036929 -0.0182736   0.24135056]
Stock Position:  0.0003692942737532462
Bond Position:  [3.50648148]


portfolio before change:  [3.54190657]
curr_Stock_Price:  94.73951014636523
curr_Factors:  [94.73951015 -0.18068135 -0.91128938]
mat_Sqrt:  [[31.79027436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00329372  0.04750316 -0.12303791]
Stock Position:  0.003293722675224068
Bond Position:  [3.2298609]


portfolio before change:  [3.54207993]
curr_Stock_Price:  94.66955863933461
curr_Factors:  [94.66955864 -0.2719408  -0.91601126]
mat_Sqrt:  [[28.85953492  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00502885  0.01517412  0.01793009]
Stock Position:  -0.005028849703812137
Bond Position:  [4.01815891]


portfolio before change:  [3.54371103]
curr_Stock_Price:  94.44509460151781
curr_Factors:  [94.4450946  -0.17370812 -0.94548015]
mat_Sqrt:  [[30.84055009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00471559 -0.01008455  0.44964103]
Stock Position:  -0.004715591786085449
Bond Position:  [3.98907554]


portfolio before change:  [3.54831374]
curr_Stock_Price:  93.57478033562597
curr_Factors:  [93.57478034 -0.16372251 -0.93480578]
mat_Sqrt:  [[31.1942137   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00287362 -0.01132547 -0.06227358]
Stock Position:  -0.002873616944945103
Bond Position:  [3.81721182]


portfolio before change:  [3.55264214]
curr_Stock_Price:  92.2345820873503
curr_Factors:  [92.23458209 -0.25632671 -0.92196491]
mat_Sqrt:  [[28.39018573  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00285801  0.04036646 -0.19341391]
Stock Position:  -0.00285800510491543
Bond Position:  [3.81624905]


portfolio before change:  [3.55904413]
curr_Stock_Price:  90.1614807239766
curr_Factors:  [90.16148072 -0.28582846 -0.90054654]
mat_Sqrt:  [[27.52865034  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01664047 0.03445971 0.95216332]
Stock Position:  0.016640471350575267
Bond Position:  [2.0587146]


portfolio before change:  [3.53346288]
curr_Stock_Price:  88.60872335790648
curr_Factors:  [88.60872336 -0.39886786 -0.90372721]
mat_Sqrt:  [[24.08610809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00633258  0.03726317 -0.66481275]
Stock Position:  0.006332581001524158
Bond Position:  [2.97234096]


portfolio before change:  [3.52941235]
curr_Stock_Price:  87.91041592200406
curr_Factors:  [87.91041592 -0.30031481 -0.91139101]
mat_Sqrt:  [[26.16996757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00682563 0.04168716 0.70125169]
Stock Position:  0.006825633774551283
Bond Position:  [2.92936805]


portfolio before change:  [3.53358015]
curr_Stock_Price:  88.46737554032423
curr_Factors:  [88.46737554 -0.41819284 -0.9044077 ]
mat_Sqrt:  [[23.5713811   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183048 -0.00182946 -0.22069201]
Stock Position:  -0.0018304784743080336
Bond Position:  [3.69551778]


portfolio before change:  [3.53485564]
curr_Stock_Price:  88.0229444225563
curr_Factors:  [88.02294442 -0.56087595 -0.88826189]
mat_Sqrt:  [[20.66537675  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00167317  0.03696938 -0.08062855]
Stock Position:  0.0016731712973898768
Bond Position:  [3.38757817]


portfolio before change:  [3.53578843]
curr_Stock_Price:  88.32734421160444
curr_Factors:  [88.32734421 -0.51045789 -0.87500675]
mat_Sqrt:  [[22.10016553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00061926 -0.01543084  0.31809126]
Stock Position:  0.0006192589788898195
Bond Position:  [3.48109092]


portfolio before change:  [3.53717917]
curr_Stock_Price:  89.8704456166448
curr_Factors:  [89.87044562 -0.31538039 -0.88788362]
mat_Sqrt:  [[26.98025024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00307996  0.03480098 -0.33047094]
Stock Position:  -0.003079961469768315
Bond Position:  [3.81397668]


portfolio before change:  [3.5394199]
curr_Stock_Price:  89.29772691395493
curr_Factors:  [89.29772691 -0.40795709 -0.89002778]
mat_Sqrt:  [[24.38556023  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01413723 -0.08221524 -0.66448577]
Stock Position:  -0.014137234891719416
Bond Position:  [4.80184284]


portfolio before change:  [3.54055367]
curr_Stock_Price:  89.25998949095494
curr_Factors:  [89.25998949 -0.52176265 -0.90198877]
mat_Sqrt:  [[21.49460384  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01003319 0.04667508 1.0537512 ]
Stock Position:  0.010033190923980145
Bond Position:  [2.64499115]


portfolio before change:  [3.52919397]
curr_Stock_Price:  88.0948226949657
curr_Factors:  [88.09482269 -0.7416387  -0.89382511]
mat_Sqrt:  [[17.16633098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00848669 -0.05276007 -0.97003666]
Stock Position:  0.008486693202825432
Bond Position:  [2.78156024]


portfolio before change:  [3.53450552]
curr_Stock_Price:  88.67971821357722
curr_Factors:  [88.67971821 -0.82283198 -0.91771207]
mat_Sqrt:  [[15.55663381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00729527 0.00199407 0.2558328 ]
Stock Position:  0.007295270602801189
Bond Position:  [2.88756298]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.53183481]
Stock Price:  88.26415169296547
PL:  [3.53183481]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.66427328e-01 -5.45883835e-02  4.43688709e-03]
 [-2.26570040e-01  2.84213263e-02 -4.12001383e-01]
 [-2.21386301e-02  3.64500301e-02  3.09326599e-02]
 [-1.15174801e-01 -1.29436388e-01 -5.23676955e-02]
 [ 1.73027835e-01 -1.80874898e-01 -1.04464475e-01]
 [-1.30064298e-01 -1.62085949e-01  1.07565828e-01]
 [-5.27185750e-02 -1.52986904e-01 -2.70279716e-02]
 [ 6.43053612e-03  8.54995803e-01  1.61336855e-01]
 [ 7.24999615e-02  4.19701275e-02  8.85290686e-02]
 [ 3.58822066e-01  1.47878659e-01  2.53791632e-01]
 [-1.74761594e-01 -2.45237363e-01  5.39644473e-03]
 [ 4.85278940e-02 -1.18627731e-02  1.20512140e-01]
 [ 1.28236937e-02 -3.54437721e-02 -6.12169798e-03]
 [ 7.69673183e-03 -8.38036272e-02  5.88476999e-02]
 [ 1.24413463e-01 -1.52319285e-01 -1.08826403e-01]
 [ 2.67938735e-02 -2.47622265e-02  5.42520768e-02]
 [ 4.70002470e-02  2.49302414e-02 -1.81258916e-03]
 [-3.33565943e-02 -4.68099287e-02  6.19959840e-02]
 [ 9.86347437e-02 -7.45647257e-02 -6.04266824e-02]
 [ 4.32906018e-02 -1.15592130e-02  1.31287691e-01]
 [-2.29528032e-02  4.01082503e-01 -3.81793605e-01]
 [ 2.52045705e-01  1.56043659e-01  8.13340617e-02]
 [ 5.94410698e-03  1.24133426e-01 -2.50442216e-02]
 [ 9.48799568e-02 -1.83332526e-01 -2.82591873e-01]
 [ 4.68387858e-02  4.77948078e-03 -1.29404612e-02]
 [-1.29157502e-02  1.58841762e-02  3.56942608e-02]
 [ 8.54486110e-02 -2.93611121e-02  3.01614197e-02]
 [ 1.58062705e-01 -6.10093612e-02  1.58363129e-01]
 [-4.34586566e-02 -7.85094307e-03 -4.60367365e-02]
 [-6.27711040e-02 -1.40068934e-02  3.87180026e-02]
 [-2.55305603e-02 -4.25211548e-02 -1.06852669e-02]
 [ 2.62667017e-02 -3.99797196e-02 -9.48158340e-02]
 [ 1.85437267e-02  3.52890311e-03  1.55670839e-01]
 [ 5.87466699e-03 -8.01388879e-02 -8.15002412e-02]
 [ 6.15227144e-03  4.13868725e-02  1.44824928e-02]
 [ 4.95988257e-02  3.31117609e-02  1.49845789e-01]
 [ 2.61923709e-01 -1.81129129e-01  1.34270471e-01]
 [-6.87938439e-02  1.91248140e-02  3.02401279e-02]
 [ 8.82738123e-02  9.67807794e-03  1.23121072e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.24171179]
curr_Stock_Price:  99.54167785027089
curr_Factors:  [99.54167785 -1.453093   -0.98174818]
mat_Sqrt:  [[ 8.72101165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01790964 -0.01761833  0.0126572 ]
Stock Position:  0.017909642068355065
Bond Position:  [-3.02446761]


portfolio before change:  [-1.23145896]
curr_Stock_Price:  100.13526377022504
curr_Factors:  [100.13526377  -1.48998525  -0.97155948]
mat_Sqrt:  [[ 8.54184634  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03569111  0.00917294 -1.17532527]
Stock Position:  -0.035691111651858266
Bond Position:  [2.34247992]


portfolio before change:  [-1.2496355]
curr_Stock_Price:  100.6527417509535
curr_Factors:  [100.65274175  -1.68804382  -0.9588639 ]
mat_Sqrt:  [[ 7.1332623   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00117537  0.0117642   0.08824227]
Stock Position:  -0.0011753662932914419
Bond Position:  [-1.13133166]


portfolio before change:  [-1.24960381]
curr_Stock_Price:  100.5054558585646
curr_Factors:  [100.50545586  -1.69677567  -0.9669366 ]
mat_Sqrt:  [[ 7.00412841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02174223 -0.04177541 -0.14939046]
Stock Position:  -0.02174223472548802
Bond Position:  [0.9356094]


portfolio before change:  [-1.26145312]
curr_Stock_Price:  101.05582557724487
curr_Factors:  [101.05582558  -1.76702464  -0.95480532]
mat_Sqrt:  [[ 6.64485674  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01727399 -0.05837712 -0.29800807]
Stock Position:  0.017273988545815553
Bond Position:  [-3.00709029]


portfolio before change:  [-1.26748804]
curr_Stock_Price:  100.72822247900221
curr_Factors:  [100.72822248  -1.8017734   -0.94507992]
mat_Sqrt:  [[ 6.4596343   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02185777 -0.05231302  0.30685537]
Stock Position:  -0.02185776539657236
Bond Position:  [0.93420582]


portfolio before change:  [-1.27062394]
curr_Stock_Price:  100.8770338139307
curr_Factors:  [100.87703381  -1.83420127  -0.94554756]
mat_Sqrt:  [[ 6.25983272  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01429175 -0.04937631 -0.07710328]
Stock Position:  -0.014291748931189263
Bond Position:  [0.1710853]


portfolio before change:  [-1.26935298]
curr_Stock_Price:  100.7896005477079
curr_Factors:  [100.78960055  -1.93959461  -0.92976396]
mat_Sqrt:  [[ 5.71832891  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03740403 0.27594871 0.46024914]
Stock Position:  0.037404034399503884
Bond Position:  [-5.03929067]


portfolio before change:  [-1.25159146]
curr_Stock_Price:  101.28129810933198
curr_Factors:  [101.28129811  -1.77602384  -0.97771503]
mat_Sqrt:  [[ 6.45053391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01536896 0.0135458  0.25254879]
Stock Position:  0.015368960105371955
Bond Position:  [-2.80817969]


portfolio before change:  [-1.25298583]
curr_Stock_Price:  101.2134128725218
curr_Factors:  [101.21341287  -1.86800447  -0.97248459]
mat_Sqrt:  [[ 5.91056968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0745804  0.04772763 0.72399688]
Stock Position:  0.07458040346072063
Bond Position:  [-8.80152299]


portfolio before change:  [-1.26581523]
curr_Stock_Price:  101.05614448571428
curr_Factors:  [101.05614449  -1.58856181  -0.93500118]
mat_Sqrt:  [[ 8.10201878  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02761274 -0.07915002  0.01539455]
Stock Position:  -0.02761273738985428
Bond Position:  [1.52462155]


portfolio before change:  [-1.27858532]
curr_Stock_Price:  101.52551794065673
curr_Factors:  [101.52551794  -1.73441634  -0.9364721 ]
mat_Sqrt:  [[ 7.02462436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01006543 -0.00382869  0.34378759]
Stock Position:  0.010065428341372997
Bond Position:  [-2.30048315]


portfolio before change:  [-1.28125957]
curr_Stock_Price:  101.28840267750455
curr_Factors:  [101.28840268  -1.6619505   -0.92676379]
mat_Sqrt:  [[ 7.60843603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00057031 -0.01143943 -0.0174635 ]
Stock Position:  0.0005703113828430397
Bond Position:  [-1.3390255]


portfolio before change:  [-1.28162266]
curr_Stock_Price:  100.94525471996336
curr_Factors:  [100.94525472  -1.7314253   -0.93039147]
mat_Sqrt:  [[ 7.04812459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00036926 -0.0270475   0.16787611]
Stock Position:  0.0003692648252661367
Bond Position:  [-1.31889819]


portfolio before change:  [-1.28167572]
curr_Stock_Price:  101.24803682274126
curr_Factors:  [101.24803682  -1.69039438  -0.92037367]
mat_Sqrt:  [[ 7.43951211  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00955806 -0.04916084 -0.31045144]
Stock Position:  0.009558062667465957
Bond Position:  [-2.2494108]


portfolio before change:  [-1.28532824]
curr_Stock_Price:  100.89531650326742
curr_Factors:  [100.8953165   -1.46858667  -0.9130495 ]
mat_Sqrt:  [[ 9.3226539   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00351976 -0.00799197  0.15476607]
Stock Position:  0.003519755672101875
Bond Position:  [-1.6404551]


portfolio before change:  [-1.28374575]
curr_Stock_Price:  101.40318140336323
curr_Factors:  [101.4031814   -1.34376189  -0.94162314]
mat_Sqrt:  [[10.31624085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00501337  0.0080462  -0.00517081]
Stock Position:  0.00501336859944285
Bond Position:  [-1.79211727]


portfolio before change:  [-1.28098173]
curr_Stock_Price:  101.99919680014523
curr_Factors:  [101.9991968   -1.50284914  -0.96539959]
mat_Sqrt:  [[ 8.64271015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00350084 -0.01510784  0.17685729]
Stock Position:  -0.0035008409647101437
Bond Position:  [-0.92389877]


portfolio before change:  [-1.28099472]
curr_Stock_Price:  101.96991463509202
curr_Factors:  [101.96991464  -1.59284986  -0.98763493]
mat_Sqrt:  [[ 7.72292385  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00920373 -0.02406566 -0.17238051]
Stock Position:  0.009203734132187454
Bond Position:  [-2.2194987]


portfolio before change:  [-1.282548]
curr_Stock_Price:  101.83129427555325
curr_Factors:  [101.83129428  -1.49364671  -0.99915923]
mat_Sqrt:  [[ 8.41917227  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00804474 -0.00373072  0.37452724]
Stock Position:  0.008044742746306876
Bond Position:  [-2.10175456]


portfolio before change:  [-1.28179072]
curr_Stock_Price:  101.95808677492087
curr_Factors:  [101.95808677  -1.37877978  -0.96289248]
mat_Sqrt:  [[ 9.80497157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193937  0.12944882 -1.08915088]
Stock Position:  -0.0019393705697125345
Bond Position:  [-1.0840562]


portfolio before change:  [-1.2836401]
curr_Stock_Price:  102.84180923053208
curr_Factors:  [102.84180923  -1.19607384  -0.98310829]
mat_Sqrt:  [[11.6349075   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02582747 0.05036287 0.23202344]
Stock Position:  0.025827470451846118
Bond Position:  [-3.93978389]


portfolio before change:  [-1.27304182]
curr_Stock_Price:  103.27122745165686
curr_Factors:  [103.27122745  -1.54690521  -0.99074471]
mat_Sqrt:  [[ 8.16379298  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00320569  0.04006389 -0.07144419]
Stock Position:  0.0032056920311867606
Bond Position:  [-1.60409757]


portfolio before change:  [-1.27224359]
curr_Stock_Price:  103.58278183504912
curr_Factors:  [103.58278184  -1.51424168  -0.99818715]
mat_Sqrt:  [[ 8.39756921  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.69676948e-05 -5.91703185e-02 -8.06155956e-01]
Stock Position:  -2.696769481699932e-05
Bond Position:  [-1.2694502]


portfolio before change:  [-1.27240399]
curr_Stock_Price:  103.64613771176248
curr_Factors:  [103.64613771  -1.35646337  -1.01144834]
mat_Sqrt:  [[ 9.70917066  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0046526   0.00154257 -0.03691553]
Stock Position:  0.004652604653646637
Bond Position:  [-1.7546285]


portfolio before change:  [-1.27079383]
curr_Stock_Price:  104.03936043618508
curr_Factors:  [104.03936044  -1.09361     -1.01011302]
mat_Sqrt:  [[12.69294435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018808  0.0051266   0.10182579]
Stock Position:  -0.00018808448230908892
Bond Position:  [-1.25122564]


portfolio before change:  [-1.27082493]
curr_Stock_Price:  103.3731364783005
curr_Factors:  [103.37313648  -1.12762116  -1.01980743]
mat_Sqrt:  [[12.07233579  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00709158 -0.00947626  0.08604214]
Stock Position:  0.007091583151377332
Bond Position:  [-2.00390412]


portfolio before change:  [-1.26848478]
curr_Stock_Price:  103.73845129901763
curr_Factors:  [103.7384513   -1.477163    -0.99697757]
mat_Sqrt:  [[ 8.73844512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02036231 -0.01969069  0.45176593]
Stock Position:  0.02036231356057198
Bond Position:  [-3.38083965]


portfolio before change:  [-1.26339332]
curr_Stock_Price:  104.00924994979655
curr_Factors:  [104.00924995  -1.16798594  -0.97623594]
mat_Sqrt:  [[12.18563691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00446907 -0.00253388 -0.13133   ]
Stock Position:  -0.004469067441436103
Bond Position:  [-0.79856897]


portfolio before change:  [-1.26007941]
curr_Stock_Price:  103.24539129839714
curr_Factors:  [103.2453913   -1.30134397  -0.93787356]
mat_Sqrt:  [[10.99995368  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524793 -0.00452071  0.11045168]
Stock Position:  -0.005247928456118785
Bond Position:  [-0.71825498]


portfolio before change:  [-1.2608413]
curr_Stock_Price:  103.37346061240622
curr_Factors:  [103.37346061  -1.40702295  -0.90564424]
mat_Sqrt:  [[10.23364762  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355604 -0.01372364 -0.03048209]
Stock Position:  -0.0035560415032386463
Bond Position:  [-0.89324098]


portfolio before change:  [-1.26409079]
curr_Stock_Price:  104.25585588827583
curr_Factors:  [104.25585589  -1.36032728  -0.89350472]
mat_Sqrt:  [[10.94645905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.14039203e-04 -1.29033990e-02 -2.70483183e-01]
Stock Position:  -0.0001140392032510432
Bond Position:  [-1.25220154]


portfolio before change:  [-1.26421689]
curr_Stock_Price:  103.98892894924462
curr_Factors:  [103.98892895  -1.14727382  -0.87019537]
mat_Sqrt:  [[13.82965578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00369064 0.00113895 0.44408557]
Stock Position:  0.0036906368962959634
Bond Position:  [-1.64800227]


portfolio before change:  [-1.26667563]
curr_Stock_Price:  103.37853797922652
curr_Factors:  [103.37853798  -1.15633636  -0.85076439]
mat_Sqrt:  [[13.89177055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195222 -0.02586471 -0.2324975 ]
Stock Position:  -0.00195221926355959
Bond Position:  [-1.06485806]


portfolio before change:  [-1.26692818]
curr_Stock_Price:  103.4397133311626
curr_Factors:  [103.43971333  -1.24421501  -0.84286757]
mat_Sqrt:  [[12.83154233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00136823 0.01335756 0.04131452]
Stock Position:  0.0013682344194790308
Bond Position:  [-1.40845795]


portfolio before change:  [-1.2672122]
curr_Stock_Price:  103.36080860631475
curr_Factors:  [103.36080861  -1.33706207  -0.81850915]
mat_Sqrt:  [[11.97300629  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00726174 0.01068677 0.42746833]
Stock Position:  0.007261741706039756
Bond Position:  [-2.0177917]


portfolio before change:  [-1.26314318]
curr_Stock_Price:  103.95588118831957
curr_Factors:  [103.95588119  -1.24673413  -0.80786444]
mat_Sqrt:  [[13.32135009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01894393 -0.05845918  0.38303628]
Stock Position:  0.018943930141401326
Bond Position:  [-3.23247613]


portfolio before change:  [-1.25703073]
curr_Stock_Price:  104.29987194046622
curr_Factors:  [104.29987194  -1.40613992  -0.82050381]
mat_Sqrt:  [[11.25290591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00521796  0.00617251  0.08626667]
Stock Position:  -0.005217964836891721
Bond Position:  [-0.71279766]


portfolio before change:  [-1.25499447]
curr_Stock_Price:  103.89255547018264
curr_Factors:  [103.89255547  -1.65615472  -0.81887534]
mat_Sqrt:  [[ 8.74364524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01319602 0.00312359 0.35123015]
Stock Position:  0.013196020892596144
Bond Position:  [-2.6259628]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.26596953]
Stock Price:  103.08573672278264
PL:  [-4.35170626]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.95380410e-01 -1.04347775e-01  2.61766607e-02]
 [-1.33917168e-01  6.87977491e-02 -1.45452409e-01]
 [ 1.09566596e-02 -5.54442711e-04  5.42334727e-02]
 [-1.00638007e-01 -8.05925194e-02 -5.48393815e-02]
 [ 1.57275279e-01 -1.61377329e-01 -1.02747921e-01]
 [-8.16046464e-02 -1.56969267e-01  1.29517703e-01]
 [-6.29349853e-02 -1.55383827e-01  5.37951064e-02]
 [ 4.83453790e-03  7.62494956e-01  1.22693723e-01]
 [-9.88066945e-03  2.33518356e-02 -4.55491080e-02]
 [ 2.44547321e-01  8.73911101e-02  1.15892235e-01]
 [-1.79249442e-01 -3.06648301e-01 -3.58366540e-02]
 [-6.64129398e-03 -1.69408870e-02  9.61892033e-02]
 [ 3.72047139e-03 -1.60445407e-02  8.38221798e-02]
 [ 1.17202090e-02 -1.61865613e-01  4.52327931e-02]
 [-3.64651974e-02  8.58243749e-02 -4.34767480e-02]
 [ 1.67516378e-01  1.52552302e-02 -5.99484899e-02]
 [ 4.37414531e-02  3.07789686e-02  1.72473321e-02]
 [-4.91894108e-02 -6.22634537e-02  2.20616241e-03]
 [ 4.57211237e-02 -6.47578426e-03 -9.26746058e-02]
 [ 2.49089092e-02 -1.26119710e-02  6.80422949e-02]
 [-1.89843972e-02  3.51656524e-01 -3.04267068e-01]
 [ 4.09298172e-02  4.28107485e-02  6.34362989e-02]
 [-7.31779888e-03  2.37517625e-04  4.91895829e-02]
 [ 1.17173928e-01 -1.16761955e-01 -2.82134258e-01]
 [ 4.06730852e-02  1.24683765e-02 -1.32071849e-02]
 [-5.91783743e-02 -6.32467076e-03  1.75919415e-01]
 [-9.83553796e-03 -3.24967889e-02  1.84523567e-03]
 [ 1.27862902e-02 -9.76536106e-03 -1.69773308e-01]
 [-5.23252287e-02 -3.32905549e-02  9.57367819e-04]
 [-6.42589265e-02  1.52737860e-03  2.08442814e-02]
 [-1.22693672e-03 -4.33262672e-02 -4.38600988e-02]
 [ 2.07733322e-02  4.76662645e-02 -4.14605980e-02]
 [-1.45633736e-02  1.45859068e-02  8.18963734e-02]
 [ 3.13114983e-02 -4.38195255e-02  1.22970587e-01]
 [-6.47044467e-02 -1.36036767e-02 -5.11631770e-03]
 [ 5.22175902e-02 -4.68262357e-02  8.47121623e-02]
 [-2.91859575e-02  1.00792202e-01  7.30390727e-02]
 [ 8.79307235e-02 -8.25443245e-02 -8.21257638e-02]
 [ 9.90406056e-02  3.00777758e-03  5.93837945e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.55759481]
curr_Stock_Price:  101.02924528356519
curr_Factors:  [101.02924528  -1.03290565  -1.0100976 ]
mat_Sqrt:  [[13.09730893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02377107 -0.0336781   0.07467473]
Stock Position:  -0.023771068086910117
Bond Position:  [12.95916788]


portfolio before change:  [10.57809315]
curr_Stock_Price:  100.23507213972752
curr_Factors:  [100.23507214  -0.96723449  -0.97907439]
mat_Sqrt:  [[14.31358761  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01044911  0.02220438 -0.41493524]
Stock Position:  -0.010449108822211589
Bond Position:  [11.62546033]


portfolio before change:  [10.57169852]
curr_Stock_Price:  100.98613138898821
curr_Factors:  [100.98613139  -1.11119958  -0.97051726]
mat_Sqrt:  [[12.59457743  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00173994 -0.00017895  0.154713  ]
Stock Position:  0.0017399429066702011
Bond Position:  [10.39598842]


portfolio before change:  [10.57310338]
curr_Stock_Price:  101.04664067816944
curr_Factors:  [101.04664068  -1.19036393  -0.9883206 ]
mat_Sqrt:  [[11.43750273  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01121599 -0.02601112 -0.15644149]
Stock Position:  -0.01121599101332798
Bond Position:  [11.7064416]


portfolio before change:  [10.57412061]
curr_Stock_Price:  101.08642019175385
curr_Factors:  [101.08642019  -1.24376148  -0.98788532]
mat_Sqrt:  [[10.85177857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00952479 -0.05208431 -0.29311122]
Stock Position:  0.009524792425307191
Bond Position:  [9.61129345]


portfolio before change:  [10.5653679]
curr_Stock_Price:  100.0413366305311
curr_Factors:  [100.04133663  -1.17649531  -0.98876673]
mat_Sqrt:  [[11.47672907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0075987  -0.05066161  0.36947796]
Stock Position:  -0.007598695838723941
Bond Position:  [11.32555159]


portfolio before change:  [10.57544826]
curr_Stock_Price:  98.90106454504796
curr_Factors:  [98.90106455 -1.05219505 -0.96571585]
mat_Sqrt:  [[13.14720395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00636422 -0.05014991  0.15346246]
Stock Position:  -0.006364219827379597
Bond Position:  [11.20487638]


portfolio before change:  [10.58292361]
curr_Stock_Price:  97.9465638899783
curr_Factors:  [97.94656389 -1.12381433 -0.96743586]
mat_Sqrt:  [[12.09959361  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01533299 0.24609419 0.35001104]
Stock Position:  0.015332987722382868
Bond Position:  [9.08111015]


portfolio before change:  [10.58346329]
curr_Stock_Price:  97.90772440583062
curr_Factors:  [97.90772441 -1.08420383 -0.94469217]
mat_Sqrt:  [[12.87296602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111953  0.00753677 -0.12993893]
Stock Position:  -0.0011195297702457224
Bond Position:  [10.69307391]


portfolio before change:  [10.58424676]
curr_Stock_Price:  98.40190381948634
curr_Factors:  [98.40190382 -1.18008194 -0.91410875]
mat_Sqrt:  [[12.12015117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02360056 0.02820536 0.33060829]
Stock Position:  0.02360056039153335
Bond Position:  [8.26190669]


portfolio before change:  [10.58339729]
curr_Stock_Price:  98.32214836403742
curr_Factors:  [98.32214836 -1.15248018 -0.88243964]
mat_Sqrt:  [[12.8498161   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01939007 -0.09897031 -0.102232  ]
Stock Position:  -0.019390074415349474
Bond Position:  [12.48987107]


portfolio before change:  [10.57238381]
curr_Stock_Price:  98.97066661268684
curr_Factors:  [98.97066661 -1.11600236 -0.88250144]
mat_Sqrt:  [[13.41427861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071082 -0.00546765  0.27440102]
Stock Position:  0.0007108247207633165
Bond Position:  [10.50203301]


portfolio before change:  [10.57424255]
curr_Stock_Price:  99.73865499066105
curr_Factors:  [99.73865499 -1.02756218 -0.91665917]
mat_Sqrt:  [[14.27246231  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00123003 -0.00517835  0.23912135]
Stock Position:  0.0012300277037440115
Bond Position:  [10.45156124]


portfolio before change:  [10.5738736]
curr_Stock_Price:  98.37651450192664
curr_Factors:  [98.3765145  -1.09437211 -0.90540106]
mat_Sqrt:  [[13.31683383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090768 -0.0522419   0.12903657]
Stock Position:  -0.0009076756448634769
Bond Position:  [10.66316757]


portfolio before change:  [10.57481311]
curr_Stock_Price:  98.810014629945
curr_Factors:  [98.81001463 -1.05326962 -0.88922271]
mat_Sqrt:  [[14.16404385  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019642   0.0276997  -0.12402706]
Stock Position:  -0.0019642006613083567
Bond Position:  [10.7688958]


portfolio before change:  [10.57587413]
curr_Stock_Price:  98.95520204407491
curr_Factors:  [98.95520204 -1.46710721 -0.87773461]
mat_Sqrt:  [[ 9.48607964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01669746  0.0049236  -0.17101636]
Stock Position:  0.016697456767494744
Bond Position:  [8.92357392]


portfolio before change:  [10.56664153]
curr_Stock_Price:  98.3354600222682
curr_Factors:  [98.33546002 -1.37488118 -0.89715642]
mat_Sqrt:  [[10.13857138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00528129 0.00993387 0.04920184]
Stock Position:  0.0052812944421166555
Bond Position:  [10.04730301]


portfolio before change:  [10.56983463]
curr_Stock_Price:  98.70224673347319
curr_Factors:  [98.70224673 -1.5320791  -0.9060358 ]
mat_Sqrt:  [[ 8.61920467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00712926 -0.02009544  0.00629357]
Stock Position:  -0.007129260348635824
Bond Position:  [11.27350864]


portfolio before change:  [10.57077512]
curr_Stock_Price:  98.7680019823966
curr_Factors:  [98.76800198 -1.57049345 -0.90257047]
mat_Sqrt:  [[ 8.3287198   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00305955 -0.00209005 -0.26437485]
Stock Position:  0.003059550050694403
Bond Position:  [10.26858947]


portfolio before change:  [10.57193654]
curr_Stock_Price:  98.72805258052794
curr_Factors:  [98.72805258 -1.47247559 -0.89773435]
mat_Sqrt:  [[ 9.22723265  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00392572 -0.0040705   0.19410573]
Stock Position:  0.003925724873033198
Bond Position:  [10.18435737]


portfolio before change:  [10.57379881]
curr_Stock_Price:  98.87812375326276
curr_Factors:  [98.87812375 -1.43037991 -0.90239069]
mat_Sqrt:  [[ 9.59380346  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00097053  0.11349666 -0.86798925]
Stock Position:  -0.0009705290586209832
Bond Position:  [10.6697629]


portfolio before change:  [10.57449831]
curr_Stock_Price:  99.53167990495007
curr_Factors:  [99.5316799  -1.50740926 -0.91117205]
mat_Sqrt:  [[ 8.86308305  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00706497 0.01381711 0.1809661 ]
Stock Position:  0.00706496877091937
Bond Position:  [9.8713101]


portfolio before change:  [10.57925462]
curr_Stock_Price:  100.03024091367442
curr_Factors:  [100.03024091  -1.40273716  -0.94141979]
mat_Sqrt:  [[ 9.59570501  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.88823568e-04 7.66584838e-05 1.40324188e-01]
Stock Position:  0.00028882356795792246
Bond Position:  [10.55036353]


portfolio before change:  [10.5803014]
curr_Stock_Price:  99.08814116781897
curr_Factors:  [99.08814117 -1.36752202 -0.92319875]
mat_Sqrt:  [[10.02707563  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0035653  -0.03768476 -0.80485051]
Stock Position:  0.0035653046072494005
Bond Position:  [10.22702199]


portfolio before change:  [10.584698]
curr_Stock_Price:  99.96272043475217
curr_Factors:  [99.96272043 -1.385551   -0.88129285]
mat_Sqrt:  [[10.36001281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00391141  0.00402415 -0.03767642]
Stock Position:  0.003911411821200124
Bond Position:  [10.19370263]


portfolio before change:  [10.58502216]
curr_Stock_Price:  99.71980700429371
curr_Factors:  [99.719807   -1.37388397 -0.89263105]
mat_Sqrt:  [[10.33823648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00237565 -0.00204128  0.50184913]
Stock Position:  -0.0023756461818191924
Bond Position:  [10.82192114]


portfolio before change:  [10.58614096]
curr_Stock_Price:  99.81831483189282
curr_Factors:  [99.81831483 -1.44272592 -0.89431682]
mat_Sqrt:  [[ 9.64373943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166867 -0.01048829  0.00526394]
Stock Position:  -0.0016686742916373087
Bond Position:  [10.75270522]


portfolio before change:  [10.58700459]
curr_Stock_Price:  100.10629612769337
curr_Factors:  [100.10629613  -1.53261029  -0.84932768]
mat_Sqrt:  [[ 9.24695782  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258051 -0.00315176 -0.48431599]
Stock Position:  -0.002580512169039125
Bond Position:  [10.8453301]


portfolio before change:  [10.58802454]
curr_Stock_Price:  100.23642529280764
curr_Factors:  [100.23642529  -1.27578332  -0.84889946]
mat_Sqrt:  [[11.975332    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00492055 -0.01074448  0.0027311 ]
Stock Position:  -0.004920549415098536
Bond Position:  [11.08124282]


portfolio before change:  [10.5907776]
curr_Stock_Price:  99.95844334804987
curr_Factors:  [99.95844335 -1.26820612 -0.86688981]
mat_Sqrt:  [[11.81841132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00505079  0.00049296  0.05946293]
Stock Position:  -0.0050507914258799864
Bond Position:  [11.09564685]


portfolio before change:  [10.59454141]
curr_Stock_Price:  99.4878705815241
curr_Factors:  [99.48787058 -1.12123882 -0.85750466]
mat_Sqrt:  [[13.7534851   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013832  -0.01398349 -0.12512065]
Stock Position:  -0.0013831969875545658
Bond Position:  [10.73215273]


portfolio before change:  [10.59541102]
curr_Stock_Price:  99.82910764564713
curr_Factors:  [99.82910765 -1.05150703 -0.86283539]
mat_Sqrt:  [[14.71867921  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00149742  0.01538422 -0.11827555]
Stock Position:  0.0014974209433381667
Bond Position:  [10.44592482]


portfolio before change:  [10.59742335]
curr_Stock_Price:  100.30092876505812
curr_Factors:  [100.30092877  -1.15299161  -0.86273613]
mat_Sqrt:  [[13.36243233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00038399 0.00470758 0.23362756]
Stock Position:  0.0003839861851353934
Bond Position:  [10.55890918]


portfolio before change:  [10.59815842]
curr_Stock_Price:  98.77774748313358
curr_Factors:  [98.77774748 -1.30678851 -0.85829179]
mat_Sqrt:  [[11.33382982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00418818 -0.01414269  0.35080086]
Stock Position:  0.004188181915262716
Bond Position:  [10.18445924]


portfolio before change:  [10.60272939]
curr_Stock_Price:  99.56516170488058
curr_Factors:  [99.5651617  -1.15296344 -0.85287571]
mat_Sqrt:  [[13.39622788  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00511529 -0.00439057 -0.01459543]
Stock Position:  -0.005115294406713385
Bond Position:  [11.11203451]


portfolio before change:  [10.6083087]
curr_Stock_Price:  98.74600662874299
curr_Factors:  [98.74600663 -1.50026558 -0.82735973]
mat_Sqrt:  [[ 9.63040859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00622518 -0.0151131   0.24166022]
Stock Position:  0.006225179545603174
Bond Position:  [9.99359708]


portfolio before change:  [10.60606238]
curr_Stock_Price:  98.18448110378174
curr_Factors:  [98.1844811  -1.25196639 -0.83049061]
mat_Sqrt:  [[12.23610709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00051464 0.03253054 0.20836014]
Stock Position:  0.0005146410339100124
Bond Position:  [10.55553262]


portfolio before change:  [10.60731385]
curr_Stock_Price:  98.05224227335809
curr_Factors:  [98.05224227 -1.22219683 -0.82126925]
mat_Sqrt:  [[12.70549205  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00427513 -0.02664107 -0.23428194]
Stock Position:  0.004275126241676569
Bond Position:  [10.18812814]


portfolio before change:  [10.60185943]
curr_Stock_Price:  96.47848447100414
curr_Factors:  [96.47848447 -0.99639166 -0.79746855]
mat_Sqrt:  [[16.04600351  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00696599 0.00097076 0.16940544]
Stock Position:  0.006965985759844027
Bond Position:  [9.92979168]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.60864422]
Stock Price:  97.27427853117344
PL:  [10.60864422]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.70882124e-01 -5.57585994e-02  4.62174578e-03]
 [-2.08920798e-01  5.96727617e-02 -2.08014562e-01]
 [-4.02497123e-02  5.16764971e-02  2.00437051e-02]
 [-3.45818027e-02 -2.91974380e-02  9.78388281e-03]
 [ 1.76530217e-01 -1.84263244e-01 -1.04513386e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.24547737e-02 -1.64354983e-01 -2.73037368e-02]
 [ 1.11558613e-02  6.07883607e-01  8.75520585e-02]
 [ 4.11459628e-01  4.79762658e-02  4.03588968e-01]
 [ 4.76819719e-01  1.91174653e-01  3.34342599e-01]
 [-2.46853829e-01 -2.44890551e-01  2.78317394e-02]
 [-4.55230303e-02 -1.82861173e-02  9.13692206e-02]
 [ 1.27899321e-02 -5.75802343e-02  8.41430651e-02]
 [ 2.17053847e-03  1.03120050e-01 -8.41659619e-02]
 [ 1.52057189e-01 -1.45129740e-01 -1.17991565e-01]
 [-5.55863685e-02 -4.80819205e-02  8.21931669e-02]
 [ 5.08114260e-02  1.80901198e-02 -2.41032817e-02]
 [-4.40592104e-02 -5.31407451e-02  4.67573208e-02]
 [ 1.06813050e-01 -9.50550302e-02 -4.77564458e-02]
 [ 2.93947432e-02 -5.49783009e-03  8.78669294e-02]
 [-3.44957011e-02  4.84380311e-01 -4.59629081e-01]
 [ 3.58150884e-01  2.06814629e-01  6.40555811e-02]
 [-7.22297110e-03 -8.97856210e-04  4.98767332e-02]
 [ 4.67040997e-02 -1.00663367e-01 -1.98850100e-01]
 [ 4.44153439e-02  1.41606818e-02 -1.32538485e-02]
 [-5.90133117e-02 -7.38823749e-03  1.76526131e-01]
 [ 4.41482991e-02 -3.36223819e-02  1.20036446e-02]
 [ 4.67554879e-02 -4.08425619e-02 -1.63661231e-01]
 [-5.62356979e-02 -3.63281079e-02  4.37596771e-03]
 [-5.75183217e-02  1.36338724e-03  1.69415975e-02]
 [-8.97684495e-03 -4.31471474e-02 -3.34684962e-02]
 [ 4.97288572e-03  2.81172334e-02 -5.25078896e-02]
 [-9.04935023e-03  2.18295497e-02 -2.53915223e-03]
 [ 2.85698562e-02 -4.73142408e-02  1.05438427e-01]
 [-6.37326607e-02 -2.53629029e-02  1.50682132e-03]
 [ 8.92709882e-02  1.44814320e-02  1.78107816e-01]
 [ 3.75715922e-02  1.54128731e-02  2.15515897e-02]
 [-1.79756723e-02 -3.12341214e-02  1.04511497e-02]
 [ 7.89292245e-02  2.96326456e-03  8.78144617e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.73634111]
curr_Stock_Price:  99.4793187232717
curr_Factors:  [99.47931872 -1.10695102 -0.98757313]
mat_Sqrt:  [[12.24877118  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01309877 -0.01799601  0.01318455]
Stock Position:  0.013098771739750046
Bond Position:  [-3.03939799]


portfolio before change:  [-1.7406246]
curr_Stock_Price:  99.18131042364904
curr_Factors:  [99.18131042 -1.01230869 -0.97276432]
mat_Sqrt:  [[13.62459467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01755655  0.0192593  -0.59340764]
Stock Position:  -0.017556554658739794
Bond Position:  [0.0006575]


portfolio before change:  [-1.74318977]
curr_Stock_Price:  99.3274243878919
curr_Factors:  [99.32742439 -0.94224953 -0.98652326]
mat_Sqrt:  [[14.43490041  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00177416  0.01667852  0.05717911]
Stock Position:  -0.0017741644616710635
Bond Position:  [-1.56696659]


portfolio before change:  [-1.74634278]
curr_Stock_Price:  100.99419635353301
curr_Factors:  [100.99419635  -0.96799771  -0.98604702]
mat_Sqrt:  [[14.31085463  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00269338 -0.00942343  0.02791069]
Stock Position:  -0.0026933805880041514
Bond Position:  [-1.47432698]


portfolio before change:  [-1.74809156]
curr_Stock_Price:  101.5750539757478
curr_Factors:  [101.57505398  -0.94499332  -0.9791375 ]
mat_Sqrt:  [[14.83022244  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00792867 -0.05947071 -0.2981476 ]
Stock Position:  0.007928669599490843
Bond Position:  [-2.5534466]


portfolio before change:  [-1.74235773]
curr_Stock_Price:  102.33848907028285
curr_Factors:  [102.33848907  -0.87185929  -0.98434617]
mat_Sqrt:  [[15.9918686   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00958638 -0.05534923  0.15513819]
Stock Position:  -0.009586384177866659
Bond Position:  [-0.76130166]


portfolio before change:  [-1.73550453]
curr_Stock_Price:  101.61367205049412
curr_Factors:  [101.61367205  -0.83240794  -0.96777662]
mat_Sqrt:  [[16.79352731  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00545311 -0.05304534 -0.07788996]
Stock Position:  -0.0054531096667700995
Bond Position:  [-1.18139403]


portfolio before change:  [-1.73632327]
curr_Stock_Price:  101.7367314392487
curr_Factors:  [101.73673144  -0.89311273  -0.96835411]
mat_Sqrt:  [[15.81441024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00968174 0.19619359 0.24976165]
Stock Position:  0.009681744044646272
Bond Position:  [-2.72131226]


portfolio before change:  [-1.73331235]
curr_Stock_Price:  102.08285766576482
curr_Factors:  [102.08285767  -0.73077049  -0.95573465]
mat_Sqrt:  [[18.90222572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02664422 0.01548427 1.15132699]
Stock Position:  0.02664421654933785
Bond Position:  [-4.45323011]


portfolio before change:  [-1.76843989]
curr_Stock_Price:  100.78535815629829
curr_Factors:  [100.78535816  -0.94428682  -0.92220068]
mat_Sqrt:  [[15.5880654   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03747036 0.06170135 0.95378637]
Stock Position:  0.037470363642518816
Bond Position:  [-5.54490391]


portfolio before change:  [-1.77410669]
curr_Stock_Price:  100.6526227182424
curr_Factors:  [100.65262272  -1.05760808  -0.94453881]
mat_Sqrt:  [[13.59263789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02142048 -0.07903809  0.07939621]
Stock Position:  -0.021420475978582827
Bond Position:  [0.38192039]


portfolio before change:  [-1.77183184]
curr_Stock_Price:  100.54865145939787
curr_Factors:  [100.54865146  -0.78225713  -0.91725283]
mat_Sqrt:  [[18.37758562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166534 -0.00590182  0.26065095]
Stock Position:  -0.0016653441312661432
Bond Position:  [-1.60438373]


portfolio before change:  [-1.77411089]
curr_Stock_Price:  101.79673965556215
curr_Factors:  [101.79673966  -0.95595875  -0.93914366]
mat_Sqrt:  [[15.30034949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011903  -0.01858394  0.24003674]
Stock Position:  0.001190302694938053
Bond Position:  [-1.89527983]


portfolio before change:  [-1.7739019]
curr_Stock_Price:  102.17136208846144
curr_Factors:  [102.17136209  -0.94106913  -0.949984  ]
mat_Sqrt:  [[15.41896579  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00039169  0.03328185 -0.24010206]
Stock Position:  0.0003916945898821496
Bond Position:  [-1.81392187]


portfolio before change:  [-1.77443874]
curr_Stock_Price:  101.37971421097824
curr_Factors:  [101.37971421  -0.87791794  -0.94171546]
mat_Sqrt:  [[16.43214724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00598508 -0.04684042 -0.33659709]
Stock Position:  0.005985083747879437
Bond Position:  [-2.38120482]


portfolio before change:  [-1.77874149]
curr_Stock_Price:  100.71053720464242
curr_Factors:  [100.7105372   -0.8474255   -0.91951926]
mat_Sqrt:  [[17.20681746  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282582 -0.01551837  0.23447423]
Stock Position:  -0.0028258241009458374
Bond Position:  [-1.49415123]


portfolio before change:  [-1.78100194]
curr_Stock_Price:  101.44436548146872
curr_Factors:  [101.44436548  -0.91463095  -0.91970753]
mat_Sqrt:  [[16.20260522  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00306025  0.00583856 -0.06875995]
Stock Position:  0.0030602482590718324
Bond Position:  [-2.09144689]


portfolio before change:  [-1.77873282]
curr_Stock_Price:  102.27128181255414
curr_Factors:  [102.27128181  -0.99566951  -0.93628519]
mat_Sqrt:  [[14.81550415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306181 -0.0171511   0.13338562]
Stock Position:  -0.0030618074779881557
Bond Position:  [-1.46559785]


portfolio before change:  [-1.77934466]
curr_Stock_Price:  102.41127370977657
curr_Factors:  [102.41127371  -0.96737786  -0.92075534]
mat_Sqrt:  [[15.50036537  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00501032 -0.03067888 -0.13623585]
Stock Position:  0.005010319266543616
Bond Position:  [-2.29245784]


portfolio before change:  [-1.783069]
curr_Stock_Price:  101.72513591875297
curr_Factors:  [101.72513592  -0.94945339  -0.93173912]
mat_Sqrt:  [[15.50374993  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00298046 -0.00177442  0.25065989]
Stock Position:  0.0029804573310442304
Bond Position:  [-2.08625643]


portfolio before change:  [-1.78762314]
curr_Stock_Price:  100.28464101605685
curr_Factors:  [100.28464102  -0.87059692  -0.92114978]
mat_Sqrt:  [[16.71432029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176157  0.15633307 -1.31119383]
Stock Position:  -0.0017615659498162759
Bond Position:  [-1.61096513]


portfolio before change:  [-1.78886393]
curr_Stock_Price:  100.87469250510742
curr_Factors:  [100.87469251  -0.91999524  -0.94629881]
mat_Sqrt:  [[15.60490093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02649437 0.06674913 0.18273274]
Stock Position:  0.026494370971533395
Bond Position:  [-4.46147546]


portfolio before change:  [-1.8126003]
curr_Stock_Price:  99.99984067815913
curr_Factors:  [99.99984068 -0.88399777 -0.93854   ]
mat_Sqrt:  [[16.1614831   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00017169 -0.00028978  0.14228444]
Stock Position:  0.00017169218256371125
Bond Position:  [-1.82976949]


portfolio before change:  [-1.81287425]
curr_Stock_Price:  99.73649450863758
curr_Factors:  [99.73649451 -1.04611111 -0.96509749]
mat_Sqrt:  [[13.34741926  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108139 -0.03248896 -0.56726398]
Stock Position:  -0.0010813948633738091
Bond Position:  [-1.70501972]


portfolio before change:  [-1.81413272]
curr_Stock_Price:  100.70314372599853
curr_Factors:  [100.70314373  -1.02990779  -0.96695425]
mat_Sqrt:  [[13.67152192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00326229  0.00457034 -0.03780954]
Stock Position:  0.003262288626265786
Bond Position:  [-2.14265544]


portfolio before change:  [-1.81678681]
curr_Stock_Price:  99.97168366217177
curr_Factors:  [99.97168366 -1.04640784 -0.95449819]
mat_Sqrt:  [[13.51744331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0018116  -0.00238454  0.50357992]
Stock Position:  -0.001811598784141988
Bond Position:  [-1.63567823]


portfolio before change:  [-1.81973259]
curr_Stock_Price:  101.48488373017132
curr_Factors:  [101.48488373  -1.17861426  -0.95259986]
mat_Sqrt:  [[12.04555538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00329876 -0.01085158  0.03424306]
Stock Position:  0.0032987597123128945
Bond Position:  [-2.15450684]


portfolio before change:  [-1.82371307]
curr_Stock_Price:  100.35986848515789
curr_Factors:  [100.35986849  -1.28567913  -0.94438921]
mat_Sqrt:  [[10.79080162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.64407204e-04 -1.31818802e-02 -4.66879937e-01]
Stock Position:  0.00046440720350977355
Bond Position:  [-1.87032092]


portfolio before change:  [-1.82402931]
curr_Stock_Price:  100.18237692741585
curr_Factors:  [100.18237693  -1.24419003  -0.94680024]
mat_Sqrt:  [[11.20098834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00560289 -0.01172485  0.01248342]
Stock Position:  -0.005602889608605116
Bond Position:  [-1.26271851]


portfolio before change:  [-1.8228869]
curr_Stock_Price:  99.95030778769522
curr_Factors:  [99.95030779 -1.42141521 -0.88829343]
mat_Sqrt:  [[ 9.92408374  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00541932  0.00044003  0.04832966]
Stock Position:  -0.005419324717038458
Bond Position:  [-1.28122373]


portfolio before change:  [-1.82379845]
curr_Stock_Price:  100.0889571309933
curr_Factors:  [100.08895713  -1.18725444  -0.89485763]
mat_Sqrt:  [[12.47775299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00197279 -0.01392568 -0.0954763 ]
Stock Position:  -0.0019727869055989767
Bond Position:  [-1.62634426]


portfolio before change:  [-1.82238574]
curr_Stock_Price:  99.26980657949764
curr_Factors:  [99.26980658 -1.23465466 -0.86231648]
mat_Sqrt:  [[12.19310129  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.78641336e-07  9.07479806e-03 -1.49790394e-01]
Stock Position:  -4.786413360138947e-07
Bond Position:  [-1.82233823]


portfolio before change:  [-1.82261316]
curr_Stock_Price:  98.45404423200712
curr_Factors:  [98.45404423 -1.40435438 -0.82228447]
mat_Sqrt:  [[10.62225186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048123  0.00704546 -0.00724349]
Stock Position:  -0.00048122699489286136
Bond Position:  [-1.77523442]


portfolio before change:  [-1.82318764]
curr_Stock_Price:  99.1866811431425
curr_Factors:  [99.18668114 -1.31472091 -0.82735415]
mat_Sqrt:  [[11.64560293  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00347207 -0.01527061  0.30078648]
Stock Position:  0.0034720749293606756
Bond Position:  [-2.16757123]


portfolio before change:  [-1.82195884]
curr_Stock_Price:  99.61863269216245
curr_Factors:  [99.61863269 -1.26391466 -0.80997513]
mat_Sqrt:  [[12.52165359  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00547869 -0.00818584  0.00429854]
Stock Position:  -0.005478690374273974
Bond Position:  [-1.27617919]


portfolio before change:  [-1.82697282]
curr_Stock_Price:  100.50469225264065
curr_Factors:  [100.50469225  -1.72717895  -0.81560283]
mat_Sqrt:  [[ 7.90442421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01626723 0.00467386 0.50809202]
Stock Position:  0.016267232169378948
Bond Position:  [-3.46190598]


portfolio before change:  [-1.83002957]
curr_Stock_Price:  100.34338708585175
curr_Factors:  [100.34338709  -1.63317427  -0.8128666 ]
mat_Sqrt:  [[ 8.6933408   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00518983 0.00497448 0.06148069]
Stock Position:  0.0051898266246431886
Bond Position:  [-2.35079435]


portfolio before change:  [-1.83189574]
curr_Stock_Price:  100.0404278045208
curr_Factors:  [100.0404278   -1.65858903  -0.83059838]
mat_Sqrt:  [[ 8.30109118  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267651 -0.01008077  0.02981422]
Stock Position:  -0.0026765130296639975
Bond Position:  [-1.56413624]


portfolio before change:  [-1.83143826]
curr_Stock_Price:  99.79644926466354
curr_Factors:  [99.79644926 -1.72515471 -0.83464297]
mat_Sqrt:  [[ 7.71629968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0126303  0.00095639 0.25051022]
Stock Position:  0.012630296170390794
Bond Position:  [-3.09189697]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.83662735]
Stock Price:  99.41620676288585
PL:  [-1.83662735]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-5.54826863e-01  2.37876356e-01 -2.93464056e-02]
 [-1.21255041e-01 -1.25463524e-01  3.82449062e-01]
 [ 1.67938704e-02  6.82254946e-02  5.80336113e-02]
 [ 1.01799237e-01  7.02037359e-02  9.62348619e-02]
 [-1.55128697e-01  2.57931960e-01 -3.02617302e-02]
 [-6.71779942e-02 -1.47728261e-01  1.79606201e-01]
 [-6.01572713e-02 -1.85535615e-01  1.08313200e-01]
 [-4.88391925e-02  7.86336091e-01  1.94297439e-01]
 [ 6.14359057e-01  1.32066755e-01  5.66929707e-01]
 [ 6.83747640e-01  2.88870653e-01  5.45857227e-01]
 [-3.71076909e-02 -2.31139039e-01 -5.51991518e-02]
 [-1.00010833e-01 -2.27036796e-02  7.97932662e-02]
 [ 1.46288151e-02 -9.63006589e-02  1.24806320e-01]
 [ 2.17656139e-03  1.73104718e-01 -2.45264973e-01]
 [ 5.09108524e-01 -1.06387409e-01 -2.49126693e-01]
 [-1.99442145e-01 -9.55151121e-02  1.16233653e-01]
 [ 5.15183220e-02  1.68214167e-02 -2.82377508e-02]
 [-3.33401866e-02 -5.54688061e-02  5.01152159e-05]
 [ 2.40998342e-01 -3.10434301e-01  1.27355421e-01]
 [ 5.00946748e-02  3.70370413e-03  4.87942618e-01]
 [-7.26264491e-02  7.50515565e-01 -7.24766477e-01]
 [ 3.92544794e-01  2.23271999e-01  5.84547752e-02]
 [-1.78193165e-01  1.88154037e-01 -1.03729757e-01]
 [-4.51482295e-02 -1.41402713e-01 -4.34687414e-02]
 [-1.31629645e-02 -3.69953016e-02 -6.08808825e-03]
 [-6.12479649e-03  1.80138627e-02  1.72456863e-02]
 [ 8.66189267e-02 -1.68147084e-02  1.28964693e-01]
 [ 1.69200954e-01 -5.16844617e-02  2.26524836e-01]
 [-4.28110989e-02 -5.15602027e-03 -5.12393026e-02]
 [-6.45712346e-02 -1.42279318e-02  3.76535279e-02]
 [-2.10136125e-02 -5.17185273e-02 -3.14862868e-02]
 [ 2.65435333e-02 -7.20874923e-02 -1.45963182e-01]
 [ 9.14132218e-03  3.28220358e-03  1.58738368e-01]
 [ 2.74296532e-03 -8.61282467e-02 -1.22963897e-01]
 [ 2.78316361e-02  1.56529747e-01 -1.30745436e-02]
 [ 1.57336571e-02  2.61657082e-02  1.04005758e-01]
 [ 2.21133848e-01 -1.51156097e-01  1.19710704e-01]
 [-9.33420140e-02  2.55184531e-02  4.70945196e-02]
 [ 1.68271151e-01 -6.74489097e-03  9.95738531e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.87129992]
curr_Stock_Price:  98.32765213026492
curr_Factors:  [98.32765213 -0.92295246 -1.00073324]
mat_Sqrt:  [[14.36248484  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03566659  0.07677426 -0.08371713]
Stock Position:  -0.03566659049935592
Bond Position:  [-7.36428781]


portfolio before change:  [-10.83374859]
curr_Stock_Price:  97.24899791185572
curr_Factors:  [97.24899791 -0.65114397 -1.0230659 ]
mat_Sqrt:  [[18.22993122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00377391 -0.04049318  1.09102072]
Stock Position:  -0.0037739082488044274
Bond Position:  [-10.4667398]


portfolio before change:  [-10.83407807]
curr_Stock_Price:  96.98960010141455
curr_Factors:  [96.9896001  -0.47837887 -1.05802005]
mat_Sqrt:  [[20.86774851  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00203982 0.02201968 0.16555374]
Stock Position:  0.002039817686449602
Bond Position:  [-11.03191917]


portfolio before change:  [-10.83355757]
curr_Stock_Price:  97.92084768372803
curr_Factors:  [97.92084768 -0.45054908 -1.07584688]
mat_Sqrt:  [[21.27991165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00638035 0.02265816 0.27453127]
Stock Position:  0.006380354208130296
Bond Position:  [-11.45832727]


portfolio before change:  [-10.83610319]
curr_Stock_Price:  97.74636818539985
curr_Factors:  [97.74636819 -0.12923494 -1.05996976]
mat_Sqrt:  [[29.7601828   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365104  0.08324718 -0.08632829]
Stock Position:  -0.003651042951104073
Bond Position:  [-10.47922701]


portfolio before change:  [-10.84205911]
curr_Stock_Price:  99.01886281434206
curr_Factors:  [99.01886281 -0.34517367 -1.04743074]
mat_Sqrt:  [[24.59900392  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0024664  -0.04767909  0.5123665 ]
Stock Position:  -0.0024663981192930497
Bond Position:  [-10.59783918]


portfolio before change:  [-10.84615284]
curr_Stock_Price:  100.14152002196371
curr_Factors:  [100.14152002  -0.267229    -1.03616705]
mat_Sqrt:  [[27.19922093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00279126 -0.05988136  0.30898741]
Stock Position:  -0.0027912648947931184
Bond Position:  [-10.56663134]


portfolio before change:  [-10.84799071]
curr_Stock_Price:  100.32672276621157
curr_Factors:  [100.32672277  -0.20204066  -1.01966853]
mat_Sqrt:  [[29.56889302  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00511794 0.25378888 0.55427651]
Stock Position:  0.005117938931273373
Bond Position:  [-11.36145675]


portfolio before change:  [-10.83932925]
curr_Stock_Price:  102.2966039048402
curr_Factors:  [ 1.02296604e+02 -7.51108392e-02 -1.03962757e+00]
mat_Sqrt:  [[33.55339562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02256228 0.04262436 1.61729265]
Stock Position:  0.02256228016838939
Bond Position:  [-13.14737388]


portfolio before change:  [-10.84776568]
curr_Stock_Price:  101.99553028267812
curr_Factors:  [101.99553028  -0.13498551  -1.06602577]
mat_Sqrt:  [[30.68941187  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02783161 0.0932326  1.55717873]
Stock Position:  0.027831610419572373
Bond Position:  [-13.68646554]


portfolio before change:  [-10.76522373]
curr_Stock_Price:  105.02276668578511
curr_Factors:  [105.02276669  -0.17655859  -1.04915157]
mat_Sqrt:  [[30.82934489  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309952 -0.0745998  -0.15746782]
Stock Position:  -0.0030995218881943554
Bond Position:  [-10.43970336]


portfolio before change:  [-10.76528246]
curr_Stock_Price:  104.62066883282324
curr_Factors:  [104.62066883  -0.37662371  -1.0800179 ]
mat_Sqrt:  [[24.37844946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00362441 -0.00732758  0.22762798]
Stock Position:  -0.0036244089100331044
Bond Position:  [-10.38609438]


portfolio before change:  [-10.76760087]
curr_Stock_Price:  104.90211293522172
curr_Factors:  [104.90211294  -0.57630871  -1.07689754]
mat_Sqrt:  [[20.08195022  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0010182  -0.0310809   0.35603769]
Stock Position:  0.0010182033380397191
Bond Position:  [-10.87441255]


portfolio before change:  [-10.77050139]
curr_Stock_Price:  103.38853118378631
curr_Factors:  [103.38853118  -0.19161325  -1.05844472]
mat_Sqrt:  [[29.61959307  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.23810311e-04  5.58693074e-02 -6.99672698e-01]
Stock Position:  -0.00042381031051447107
Bond Position:  [-10.72668427]


portfolio before change:  [-10.77227242]
curr_Stock_Price:  104.4033986465253
curr_Factors:  [104.40339865  -0.22199484  -1.06965316]
mat_Sqrt:  [[28.69188207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01521474 -0.03433639 -0.71068911]
Stock Position:  0.015214739503946258
Bond Position:  [-12.36074294]


portfolio before change:  [-10.78636712]
curr_Stock_Price:  103.57857298815715
curr_Factors:  [103.57857299  -0.40022747  -1.08621202]
mat_Sqrt:  [[23.42704187  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00833281 -0.03082737  0.33158226]
Stock Position:  -0.008332805807592245
Bond Position:  [-9.92326699]


portfolio before change:  [-10.80765389]
curr_Stock_Price:  105.98427948992548
curr_Factors:  [105.98427949  -0.36481247  -1.07639115]
mat_Sqrt:  [[25.08041231  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00196121  0.00542909 -0.08055444]
Stock Position:  0.001961210682060048
Bond Position:  [-11.01551139]


portfolio before change:  [-10.80488952]
curr_Stock_Price:  108.09593244555707
curr_Factors:  [ 1.08095932e+02 -5.28065159e-02 -1.07620297e+00]
mat_Sqrt:  [[34.95318546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00127749 -0.01790248  0.00014296]
Stock Position:  -0.0012774938507448615
Bond Position:  [-10.66679763]


portfolio before change:  [-10.8053062]
curr_Stock_Price:  107.3783098471213
curr_Factors:  [107.37830985  -0.12033513  -1.06863236]
mat_Sqrt:  [[32.70051151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00622704 -0.10019224  0.36330957]
Stock Position:  0.006227043954840558
Bond Position:  [-11.47395565]


portfolio before change:  [-10.80931187]
curr_Stock_Price:  106.96537823802777
curr_Factors:  [106.96537824  -0.24987465  -1.07185504]
mat_Sqrt:  [[28.52484692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [5.27440377e-03 1.19536537e-03 1.39196447e+00]
Stock Position:  0.005274403767042061
Bond Position:  [-11.37349047]


portfolio before change:  [-10.80634543]
curr_Stock_Price:  107.79736214430906
curr_Factors:  [107.79736214  -0.28946696  -1.0620968 ]
mat_Sqrt:  [[27.90175048  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00241456  0.24222786 -2.06755702]
Stock Position:  -0.0024145595680742484
Bond Position:  [-10.54606228]


portfolio before change:  [-10.80654514]
curr_Stock_Price:  107.3340770836731
curr_Factors:  [107.33407708  -0.55886034  -1.02989671]
mat_Sqrt:  [[21.91539007  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02053589 0.07206073 0.1667552 ]
Stock Position:  0.020535889607724
Bond Position:  [-13.0107459]


portfolio before change:  [-10.81264058]
curr_Stock_Price:  107.11645836890395
curr_Factors:  [107.11645837  -0.55492883  -1.02475351]
mat_Sqrt:  [[22.07033277  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00729305  0.06072645 -0.29591213]
Stock Position:  -0.007293054124206944
Bond Position:  [-10.03143445]


portfolio before change:  [-10.81391479]
curr_Stock_Price:  107.11922891912545
curr_Factors:  [107.11922892  -0.52961556  -1.01153002]
mat_Sqrt:  [[22.93804573  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361343 -0.04563753 -0.12400422]
Stock Position:  -0.003613427143914443
Bond Position:  [-10.42684726]


portfolio before change:  [-10.81533049]
curr_Stock_Price:  107.15029552751726
curr_Factors:  [107.15029553  -0.60529275  -1.03045781]
mat_Sqrt:  [[20.87353147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105192 -0.01194018 -0.01736762]
Stock Position:  -0.001051921886153642
Bond Position:  [-10.70261675]


portfolio before change:  [-10.81517924]
curr_Stock_Price:  105.73463905507269
curr_Factors:  [105.73463906  -0.61404491  -1.04407004]
mat_Sqrt:  [[20.14220964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [5.32478225e-05 5.81394920e-03 4.91971426e-02]
Stock Position:  5.324782254703245e-05
Bond Position:  [-10.82080938]


portfolio before change:  [-10.81650734]
curr_Stock_Price:  106.19633490397514
curr_Factors:  [106.1963349   -0.36964221  -1.03164703]
mat_Sqrt:  [[26.15395319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00418719 -0.00542692  0.36790037]
Stock Position:  0.004187185229573709
Bond Position:  [-11.26117106]


portfolio before change:  [-10.82213606]
curr_Stock_Price:  105.18826217308495
curr_Factors:  [105.18826217  -0.4634446   -1.0570195 ]
mat_Sqrt:  [[22.99524861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00891011 -0.01668109  0.64621231]
Stock Position:  0.008910105709847163
Bond Position:  [-11.7593746]


portfolio before change:  [-10.8321502]
curr_Stock_Price:  104.22933663362097
curr_Factors:  [104.22933663  -0.63873368  -1.07137005]
mat_Sqrt:  [[18.84956616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288191 -0.0016641  -0.14617147]
Stock Position:  -0.0028819096145807415
Bond Position:  [-10.53177067]


portfolio before change:  [-10.83063491]
curr_Stock_Price:  103.24670813317368
curr_Factors:  [103.24670813  -0.60049246  -1.07746479]
mat_Sqrt:  [[19.28184738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00310082 -0.00459205  0.10741503]
Stock Position:  -0.0031008182769124105
Bond Position:  [-10.51048563]


portfolio before change:  [-10.83512863]
curr_Stock_Price:  104.27218850989017
curr_Factors:  [104.27218851  -0.77035989  -1.0843251 ]
mat_Sqrt:  [[16.3188305   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00232846 -0.01669208 -0.08982161]
Stock Position:  -0.002328458773244984
Bond Position:  [-10.59233514]


portfolio before change:  [-10.83881935]
curr_Stock_Price:  105.28856870403624
curr_Factors:  [105.2885687   -0.68431422  -1.06227724]
mat_Sqrt:  [[18.35888021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00097859 -0.02326614 -0.41639233]
Stock Position:  -0.0009785931413951073
Bond Position:  [-10.73578468]


portfolio before change:  [-10.83946994]
curr_Stock_Price:  104.58197041493939
curr_Factors:  [104.58197041  -0.68084144  -1.05080765]
mat_Sqrt:  [[18.51020264  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00228056 0.00105933 0.45283638]
Stock Position:  0.0022805602744312634
Bond Position:  [-11.07797543]


portfolio before change:  [-10.84250253]
curr_Stock_Price:  103.85944498160389
curr_Factors:  [103.85944498  -0.47406692  -1.05400125]
mat_Sqrt:  [[22.53276171  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00177243 -0.02779777 -0.35078177]
Stock Position:  -0.0017724320855063566
Bond Position:  [-10.65841872]


portfolio before change:  [-10.84553799]
curr_Stock_Price:  104.820312673153
curr_Factors:  [104.82031267  -0.62549676  -1.08369536]
mat_Sqrt:  [[18.97373137  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00301018  0.05051976 -0.03729803]
Stock Position:  0.003010177906631984
Bond Position:  [-11.16106578]


portfolio before change:  [-10.84656477]
curr_Stock_Price:  104.94271321285657
curr_Factors:  [104.94271321  -0.68010171  -1.07000561]
mat_Sqrt:  [[18.23435201  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00232006 0.00844495 0.29669948]
Stock Position:  0.002320060310452263
Bond Position:  [-11.09003819]


portfolio before change:  [-10.84969525]
curr_Stock_Price:  104.19094642442919
curr_Factors:  [104.19094642  -0.52904531  -1.06619765]
mat_Sqrt:  [[21.1360958   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01015869 -0.04878542  0.34150132]
Stock Position:  0.010158691851660063
Bond Position:  [-11.90813897]


portfolio before change:  [-10.85503476]
curr_Stock_Price:  103.81187212735877
curr_Factors:  [103.81187213  -0.51211168  -1.06837647]
mat_Sqrt:  [[21.37222515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367393  0.00823605  0.13434756]
Stock Position:  -0.0036739250361204883
Bond Position:  [-10.47363773]


portfolio before change:  [-10.85491097]
curr_Stock_Price:  103.42180397683471
curr_Factors:  [103.42180398  -0.49423201  -1.07269697]
mat_Sqrt:  [[21.58258713  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00867458 -0.0021769   0.28405649]
Stock Position:  0.008674575611714638
Bond Position:  [-11.75205123]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.86511041]
Stock Price:  102.41537493986898
PL:  [-13.28048535]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.40758268e-01 -9.09555932e-02  1.81655411e-02]
 [-1.55689385e-01  7.98840208e-02 -2.89895048e-01]
 [-3.29244390e-02  5.34722977e-02  2.69644746e-02]
 [ 1.21330240e-01  2.94751591e-02  1.47392296e-01]
 [ 7.81907515e-02 -3.27046560e-02 -8.33092127e-02]
 [-7.28487683e-02 -1.52508827e-01  1.53438303e-01]
 [-6.13108367e-02 -1.72964207e-01  8.57361871e-02]
 [ 1.77983602e-02  8.26250741e-01  1.33153569e-01]
 [-9.16015121e-03  5.77067167e-02 -3.12272492e-02]
 [ 3.40791575e-01  1.27537105e-01  1.97186720e-01]
 [-1.78016318e-01 -1.94838126e-01  4.09804679e-02]
 [ 3.28979395e-02 -1.29624206e-02  1.15491487e-01]
 [ 1.43983588e-02 -5.77189761e-02  6.81340551e-02]
 [ 7.95976720e-03 -6.04623871e-02 -6.25660057e-03]
 [ 1.08062751e-01 -1.37404858e-01 -1.01570458e-01]
 [ 5.12647329e-02 -1.78056543e-02  3.52088766e-02]
 [ 4.50257475e-02  2.47021356e-02  2.17212651e-02]
 [-2.74705057e-02 -4.29048528e-02  7.09857143e-02]
 [ 8.63373903e-02 -5.62772489e-02 -7.70274408e-02]
 [ 4.87366446e-02 -1.38384014e-02  1.56762720e-01]
 [-1.29260146e-02  3.18682945e-01 -2.89201519e-01]
 [-3.37239578e-03  3.38269592e-02  1.22927099e-01]
 [-2.32229717e-02  4.26345009e-02  2.31371210e-02]
 [ 7.01747551e-02 -1.53891880e-01 -2.52592749e-01]
 [ 6.53617238e-02  3.39613297e-02 -1.54116572e-02]
 [-2.14644017e-02  1.28656371e-02  6.46100261e-02]
 [ 6.22028779e-02 -3.28499035e-02  2.57075156e-02]
 [ 1.43820063e-01 -7.16040886e-02  7.49342980e-02]
 [-4.66415622e-02 -2.10971510e-02 -2.04648453e-02]
 [-6.37621444e-02 -1.39065450e-02  3.68883298e-02]
 [-3.49910934e-02 -5.17227707e-02 -2.54448347e-02]
 [ 2.61128416e-02 -2.21345574e-02 -6.63886759e-02]
 [ 7.40556408e-02  9.79130095e-03  1.41867105e-01]
 [ 1.32689071e-02 -6.73073901e-02  2.34067714e-03]
 [-2.82131521e-02 -1.75498974e-02  4.79103662e-02]
 [ 9.84050486e-02  2.72804528e-02  2.03261977e-01]
 [ 9.82332480e-02 -3.79351423e-02  2.40228462e-02]
 [-5.59587696e-02 -1.23912134e-02  3.15369929e-02]
 [ 9.33860037e-02  6.51094627e-03  9.28579145e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.31187659]
curr_Stock_Price:  100.49397720686156
curr_Factors:  [100.49397721  -1.18278861  -0.95847049]
mat_Sqrt:  [[11.80872537  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01317809 -0.02935579  0.05182123]
Stock Position:  -0.01317809245488949
Bond Position:  [7.63619551]


portfolio before change:  [6.31183607]
curr_Stock_Price:  100.56948906010416
curr_Factors:  [100.56948906  -1.35252317  -0.9564384 ]
mat_Sqrt:  [[ 9.99302501  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01986963  0.02578246 -0.82698988]
Stock Position:  -0.01986962967131704
Bond Position:  [8.31011458]


portfolio before change:  [6.33822205]
curr_Stock_Price:  99.29381596765104
curr_Factors:  [99.29381597 -1.22563135 -0.94566042]
mat_Sqrt:  [[11.32249572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00145775  0.01725811  0.07692214]
Stock Position:  -0.0014577485379881332
Bond Position:  [6.48296747]


portfolio before change:  [6.33833845]
curr_Stock_Price:  99.76990947383854
curr_Factors:  [99.76990947 -1.34077227 -0.95369158]
mat_Sqrt:  [[10.05834636  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01565199 0.00951307 0.42046919]
Stock Position:  0.015651992155231175
Bond Position:  [4.77674061]


portfolio before change:  [6.34301476]
curr_Stock_Price:  100.03052673201745
curr_Factors:  [100.03052673  -1.47080938  -0.95759475]
mat_Sqrt:  [[ 8.82043573  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00617991 -0.01055538 -0.23765799]
Stock Position:  0.006179912349434875
Bond Position:  [5.72483487]


portfolio before change:  [6.34041705]
curr_Stock_Price:  99.49437653727952
curr_Factors:  [99.49437654 -1.52559764 -0.94378308]
mat_Sqrt:  [[ 8.42093111  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00862839 -0.04922201  0.43771677]
Stock Position:  -0.008628385495709016
Bond Position:  [7.19889288]


portfolio before change:  [6.34307519]
curr_Stock_Price:  99.29060400769902
curr_Factors:  [99.29060401 -1.54440496 -0.95335094]
mat_Sqrt:  [[ 8.16857969  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00968543 -0.05582396  0.24458148]
Stock Position:  -0.009685426916619985
Bond Position:  [7.30474708]


portfolio before change:  [6.34755172]
curr_Stock_Price:  98.92269295023134
curr_Factors:  [98.92269295 -1.59634501 -0.94837404]
mat_Sqrt:  [[ 7.76494684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02751287 0.26667128 0.37985007]
Stock Position:  0.027512866403264537
Bond Position:  [3.62590488]


portfolio before change:  [6.35499694]
curr_Stock_Price:  99.17682691485726
curr_Factors:  [99.17682691 -1.452285   -0.95659351]
mat_Sqrt:  [[ 8.91759135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042108  0.01862476 -0.08908265]
Stock Position:  -0.0004210837209320257
Bond Position:  [6.39675869]


portfolio before change:  [6.35550256]
curr_Stock_Price:  99.87508459370247
curr_Factors:  [99.87508459 -1.26539004 -0.96100406]
mat_Sqrt:  [[10.77820626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03776839 0.04116242 0.56251883]
Stock Position:  0.03776839474856965
Bond Position:  [2.58338094]


portfolio before change:  [6.37888822]
curr_Stock_Price:  100.48571986056783
curr_Factors:  [100.48571986  -1.20058642  -1.00548147]
mat_Sqrt:  [[11.06677893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01892352 -0.06288373  0.11690587]
Stock Position:  -0.018923517127959096
Bond Position:  [8.28043146]


portfolio before change:  [6.36034165]
curr_Stock_Price:  101.52050046685902
curr_Factors:  [101.52050047  -1.47250679  -1.00687069]
mat_Sqrt:  [[ 8.50694831  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00632737 -0.0041836   0.32946507]
Stock Position:  0.0063273685972383845
Bond Position:  [5.71798402]


portfolio before change:  [6.35726492]
curr_Stock_Price:  100.9212754999339
curr_Factors:  [100.9212755   -1.29975788  -1.00917849]
mat_Sqrt:  [[10.02823278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00164778 -0.01862872  0.19436749]
Stock Position:  0.0016477806486044021
Bond Position:  [6.1909688]


portfolio before change:  [6.35794015]
curr_Stock_Price:  100.86138175869644
curr_Factors:  [100.86138176  -1.4716469   -1.02074285]
mat_Sqrt:  [[ 8.34245357  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00067836 -0.01951415 -0.01784834]
Stock Position:  -0.0006783602800192549
Bond Position:  [6.42636051]


portfolio before change:  [6.35860474]
curr_Stock_Price:  101.06592260361602
curr_Factors:  [101.0659226   -1.44864376  -1.00373162]
mat_Sqrt:  [[ 8.70064901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00681353 -0.04434723 -0.28975224]
Stock Position:  0.0068135284358944994
Bond Position:  [5.66998921]


portfolio before change:  [6.35923654]
curr_Stock_Price:  101.05462271194438
curr_Factors:  [101.05462271  -1.61432508  -1.01839962]
mat_Sqrt:  [[ 7.2640425   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00754637 -0.00574675  0.10044112]
Stock Position:  0.007546369779599681
Bond Position:  [5.59664099]


portfolio before change:  [6.35947959]
curr_Stock_Price:  100.99412002088702
curr_Factors:  [100.99412002  -1.76411137  -1.03657563]
mat_Sqrt:  [[ 6.13724103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00888052 0.00797258 0.06196472]
Stock Position:  0.008880518829369211
Bond Position:  [5.46259941]


portfolio before change:  [6.36058058]
curr_Stock_Price:  101.04120244228265
curr_Factors:  [101.04120244  -1.85853956  -1.02471461]
mat_Sqrt:  [[ 5.65349657  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00384515 -0.01384748  0.20250248]
Stock Position:  -0.0038451467313160136
Bond Position:  [6.74909883]


portfolio before change:  [6.3605684]
curr_Stock_Price:  101.26378503471766
curr_Factors:  [101.26378503  -1.88040625  -1.02435497]
mat_Sqrt:  [[ 5.54539371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01066231 -0.0181634  -0.21973785]
Stock Position:  0.010662305964815306
Bond Position:  [5.28086294]


portfolio before change:  [6.36085344]
curr_Stock_Price:  101.22860355443032
curr_Factors:  [101.22860355  -1.76474253  -1.04038875]
mat_Sqrt:  [[ 6.12421191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01272179 -0.00446632  0.44720041]
Stock Position:  0.012721791816257972
Bond Position:  [5.07304422]


portfolio before change:  [6.36184879]
curr_Stock_Price:  101.25699437662783
curr_Factors:  [101.25699438  -1.82376252  -1.04702868]
mat_Sqrt:  [[ 5.7366223   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00120422  0.10285448 -0.82501143]
Stock Position:  -0.0012042179468564895
Bond Position:  [6.48378428]


portfolio before change:  [6.36251013]
curr_Stock_Price:  101.38087884791983
curr_Factors:  [101.38087885  -1.75608462  -1.06551885]
mat_Sqrt:  [[ 6.03322105  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00474455 0.0109176  0.3506768 ]
Stock Position:  0.004744545608593145
Bond Position:  [5.88150393]


portfolio before change:  [6.36441019]
curr_Stock_Price:  101.62638698057879
curr_Factors:  [101.62638698  -1.48174032  -1.07386524]
mat_Sqrt:  [[ 7.89080103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124162  0.01376023  0.06600377]
Stock Position:  -0.001241622435258119
Bond Position:  [6.49059179]


portfolio before change:  [6.36563257]
curr_Stock_Price:  101.29536096735711
curr_Factors:  [101.29536097  -1.4125296   -1.05745293]
mat_Sqrt:  [[ 8.56820355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149373 -0.04966839 -0.7205768 ]
Stock Position:  -0.0014937287794939364
Bond Position:  [6.51694037]


portfolio before change:  [6.36684851]
curr_Stock_Price:  101.02672652721425
curr_Factors:  [101.02672653  -1.60290861  -1.07310036]
mat_Sqrt:  [[ 6.954411    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00994306  0.01096097 -0.04396517]
Stock Position:  0.009943064887506936
Bond Position:  [5.36233321]


portfolio before change:  [6.37468048]
curr_Stock_Price:  101.74699102107108
curr_Factors:  [101.74699102  -1.28388698  -1.0764277 ]
mat_Sqrt:  [[ 9.60395096  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058827  0.00415237  0.18431442]
Stock Position:  -0.000588273327684245
Bond Position:  [6.43453552]


portfolio before change:  [6.37533324]
curr_Stock_Price:  102.00469684459628
curr_Factors:  [102.00469684  -1.21888277  -1.11314338]
mat_Sqrt:  [[ 9.90453472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00613304 -0.01060226  0.07333639]
Stock Position:  0.006133043681261165
Bond Position:  [5.74973398]


portfolio before change:  [6.37847529]
curr_Stock_Price:  102.39981702534884
curr_Factors:  [102.39981703  -0.99218241  -1.12139991]
mat_Sqrt:  [[12.37035153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01168114 -0.02311012  0.21376669]
Stock Position:  0.011681142484156502
Bond Position:  [5.18232844]


portfolio before change:  [6.37887745]
curr_Stock_Price:  102.37878519144631
curr_Factors:  [102.37878519  -1.08568043  -1.12071786]
mat_Sqrt:  [[11.27154293  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00489067 -0.00680908 -0.05838051]
Stock Position:  -0.004890667543782088
Bond Position:  [6.87957805]


portfolio before change:  [6.37797594]
curr_Stock_Price:  102.73896227682098
curr_Factors:  [102.73896228  -1.03582688  -1.14998952]
mat_Sqrt:  [[11.54641529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00511596 -0.00448832  0.10523214]
Stock Position:  -0.005115960732257431
Bond Position:  [6.90358444]


portfolio before change:  [6.37662094]
curr_Stock_Price:  103.17250817460152
curr_Factors:  [103.17250817  -1.12303701  -1.15851012]
mat_Sqrt:  [[10.53660413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00481587 -0.01669345 -0.07258703]
Stock Position:  -0.004815865176438942
Bond Position:  [6.87348583]


portfolio before change:  [6.3800143]
curr_Stock_Price:  102.64630540246836
curr_Factors:  [102.6463054   -1.10092103  -1.14511539]
mat_Sqrt:  [[10.86180745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074049 -0.0071439  -0.18938841]
Stock Position:  0.0007404948271705803
Bond Position:  [6.30400524]


portfolio before change:  [6.38009567]
curr_Stock_Price:  101.69196977970837
curr_Factors:  [101.69196978  -1.22260694  -1.16216306]
mat_Sqrt:  [[ 9.36686387  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01121109 0.00316013 0.40470736]
Stock Position:  0.011211093149802454
Bond Position:  [5.24001753]


portfolio before change:  [6.3765592]
curr_Stock_Price:  101.31809789884329
curr_Factors:  [101.3180979   -1.38371594  -1.16014298]
mat_Sqrt:  [[ 7.95981798  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.58865236e-07 -2.17233667e-02  6.67730037e-03]
Stock Position:  9.588652359909498e-07
Bond Position:  [6.37646205]


portfolio before change:  [6.37735635]
curr_Stock_Price:  101.35740022082152
curr_Factors:  [101.35740022  -1.49820446  -1.13557641]
mat_Sqrt:  [[ 7.27811582  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302494 -0.00566421  0.13667494]
Stock Position:  -0.003024937757677788
Bond Position:  [6.68395618]


portfolio before change:  [6.37734897]
curr_Stock_Price:  101.6360574021967
curr_Factors:  [101.6360574   -1.41306795  -1.17150784]
mat_Sqrt:  [[ 7.6662117   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01897473 0.00880473 0.57984984]
Stock Position:  0.018974733629074352
Bond Position:  [4.44883186]


portfolio before change:  [6.37068251]
curr_Stock_Price:  101.25541426107677
curr_Factors:  [101.25541426  -1.51697509  -1.17268733]
mat_Sqrt:  [[ 6.87563332  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01387413 -0.01224351  0.06853049]
Stock Position:  0.013874127362361205
Bond Position:  [4.965852]


portfolio before change:  [6.3654746]
curr_Stock_Price:  100.83530272608206
curr_Factors:  [100.83530273  -1.44911278  -1.18053063]
mat_Sqrt:  [[ 7.27064569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00715901 -0.00399925  0.08996626]
Stock Position:  -0.007159013917424891
Bond Position:  [7.08735594]


portfolio before change:  [6.36116646]
curr_Stock_Price:  101.56083809383688
curr_Factors:  [101.56083809  -1.38360032  -1.18547372]
mat_Sqrt:  [[ 7.78021491  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01461008 0.0021014  0.26489778]
Stock Position:  0.014610083237630005
Bond Position:  [4.87735416]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.36125127]
Stock Price:  101.52491109062156
PL:  [4.83634018]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.04744649e-01 -1.01825824e-01  1.97906685e-02]
 [-9.56200324e-02  7.16083884e-02 -9.55476226e-02]
 [-1.02397466e-01 -1.40623352e-02 -4.73244023e-02]
 [-2.41684480e-01 -1.01080047e-01 -1.28135654e-01]
 [ 5.32201949e-02  1.65361204e-02 -7.41442334e-02]
 [-7.68066713e-02 -1.54263721e-01  1.44100389e-01]
 [-6.34065169e-02 -1.52630215e-01  4.14889774e-02]
 [-4.13514044e-02  8.22297744e-01  1.85675326e-01]
 [ 2.27934486e-01 -3.29213267e-02  2.04227039e-01]
 [ 3.38721660e-01  1.26673689e-01  1.95438328e-01]
 [-1.71164501e-01 -1.92960393e-01  3.97574923e-02]
 [-9.60183304e-02 -2.00331538e-02  8.51095599e-02]
 [-9.69738265e-03  4.04103097e-02  6.37145038e-02]
 [ 5.08711071e-03 -2.48587721e-02  6.44869706e-02]
 [ 1.64123640e-01 -4.12329234e-02 -1.27525051e-01]
 [-2.28799461e-01 -9.70624424e-02  1.22165368e-01]
 [ 5.21732764e-02  1.56459359e-02 -3.20684256e-02]
 [-6.51811290e-02 -6.56347921e-02  1.66833835e-02]
 [ 1.48837890e-01 -1.79546195e-01  1.17079447e-02]
 [ 5.32500217e-02  2.82244666e-03  4.74833800e-01]
 [-7.03259074e-02  7.34191082e-01 -7.08249967e-01]
 [ 4.08207457e-01  2.30766530e-01  5.59042210e-02]
 [-2.42529979e-01  1.95178778e-01 -1.19730541e-01]
 [-7.11532901e-02 -1.20972097e-01 -9.68824070e-03]
 [-4.39845806e-02 -3.70488561e-02 -2.70359117e-03]
 [ 3.05839425e-02  2.89254948e-02 -7.23553457e-02]
 [ 9.18013247e-02  5.13489014e-03  2.98200545e-01]
 [ 1.69200954e-01 -5.16844617e-02  2.26524836e-01]
 [-6.09188366e-03  6.19184501e-02 -1.64886976e-01]
 [-6.47009496e-02  9.54732391e-03  1.01612806e-02]
 [ 1.62129668e-01  2.96097373e-02  5.57541827e-02]
 [ 2.67144448e-02 -9.19103180e-02 -1.77540738e-01]
 [ 1.76488902e-02 -1.82491820e-03  1.56903206e-01]
 [-3.38184923e-03 -9.78419141e-02 -2.04056297e-01]
 [ 4.36624380e-02  2.17412565e-01 -5.07924893e-02]
 [ 1.68290573e-02  2.44978906e-02  1.04070078e-01]
 [ 4.01100243e-01 -2.48541184e-01  2.36533135e-01]
 [-1.03923261e-01  3.72339161e-02  4.55289850e-02]
 [ 1.80767192e-01 -9.31025241e-03  9.58956432e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.58770975]
curr_Stock_Price:  100.65482461333704
curr_Factors:  [100.65482461  -1.05274354  -1.01703908]
mat_Sqrt:  [[12.70396897  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01743471 -0.03286414  0.05645727]
Stock Position:  -0.017434709214214337
Bond Position:  [9.34259735]


portfolio before change:  [7.58803977]
curr_Stock_Price:  100.70288315841876
curr_Factors:  [100.70288316  -0.77948416  -1.01142663]
mat_Sqrt:  [[16.79806391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00598323  0.02311151 -0.27257077]
Stock Position:  -0.005983225724908025
Bond Position:  [8.19056785]


portfolio before change:  [7.58434239]
curr_Stock_Price:  101.49196597735757
curr_Factors:  [101.49196598  -0.7705831   -1.01656413]
mat_Sqrt:  [[16.9935254   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00676305 -0.0045386  -0.13500335]
Stock Position:  -0.006763045262786168
Bond Position:  [8.27073715]


portfolio before change:  [7.5838099]
curr_Stock_Price:  101.72357729291782
curr_Factors:  [101.72357729  -0.83380059  -0.99937861]
mat_Sqrt:  [[16.26604667  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01773467 -0.03262344 -0.36553535]
Stock Position:  -0.01773466809946668
Bond Position:  [9.38784378]


portfolio before change:  [7.61116213]
curr_Stock_Price:  100.24744712765391
curr_Factors:  [100.24744713  -0.69854274  -0.98869855]
mat_Sqrt:  [[18.54871135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00223525  0.00533701 -0.21151286]
Stock Position:  0.0022352489802896724
Bond Position:  [7.38708413]


portfolio before change:  [7.61027174]
curr_Stock_Price:  99.43597849351445
curr_Factors:  [99.43597849 -0.75071369 -0.98482163]
mat_Sqrt:  [[17.5311393   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00449949 -0.0497884   0.4110783 ]
Stock Position:  -0.004499493813638733
Bond Position:  [8.05768331]


portfolio before change:  [7.61403656]
curr_Stock_Price:  98.82312075929069
curr_Factors:  [98.82312076 -0.69869146 -1.02581833]
mat_Sqrt:  [[17.6162506   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00488714 -0.04926119  0.1183565 ]
Stock Position:  -0.004887142507983659
Bond Position:  [8.09699924]


portfolio before change:  [7.6165429]
curr_Stock_Price:  98.51738968554994
curr_Factors:  [98.51738969 -0.549459   -1.01510742]
mat_Sqrt:  [[20.60773855  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0079776  0.26539546 0.52968002]
Stock Position:  0.00797759717082022
Bond Position:  [6.83061085]


portfolio before change:  [7.61816481]
curr_Stock_Price:  98.61366256176017
curr_Factors:  [98.61366256 -0.48465369 -1.04522512]
mat_Sqrt:  [[21.35596313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01231048 -0.01062531  0.5826029 ]
Stock Position:  0.012310478165311988
Bond Position:  [6.40418347]


portfolio before change:  [7.61625142]
curr_Stock_Price:  98.39320294404676
curr_Factors:  [98.39320294 -0.51018611 -1.03896255]
mat_Sqrt:  [[20.90154469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01935132 0.04088376 0.55753115]
Stock Position:  0.019351320997143175
Bond Position:  [5.71221296]


portfolio before change:  [7.59891793]
curr_Stock_Price:  97.46057621378408
curr_Factors:  [97.46057621 -0.42982337 -1.03658197]
mat_Sqrt:  [[22.48936676  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00900145 -0.0622777   0.11341706]
Stock Position:  -0.00900145008594712
Bond Position:  [8.47620444]


portfolio before change:  [7.60128642]
curr_Stock_Price:  97.31516698696859
curr_Factors:  [97.31516699 -0.39192811 -1.03187888]
mat_Sqrt:  [[23.43306036  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00353068 -0.00646567  0.24279388]
Stock Position:  -0.003530681157654653
Bond Position:  [7.94487524]


portfolio before change:  [7.60136011]
curr_Stock_Price:  97.57559112569581
curr_Factors:  [97.57559113 -0.11929547 -1.04066336]
mat_Sqrt:  [[30.58985881  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00037781 0.01304237 0.18175974]
Stock Position:  0.00037780514054831376
Bond Position:  [7.56449555]


portfolio before change:  [7.60218885]
curr_Stock_Price:  97.26621195516775
curr_Factors:  [ 9.72662120e+01  4.81791026e-02 -1.05055848e+00]
mat_Sqrt:  [[35.69720141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00036911 -0.00802313  0.18396338]
Stock Position:  0.0003691096876071421
Bond Position:  [7.56628695]


portfolio before change:  [7.60445249]
curr_Stock_Price:  100.83642391062989
curr_Factors:  [100.83642391  -0.12627212  -1.03777777]
mat_Sqrt:  [[31.48306408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00411891 -0.01330787 -0.36379348]
Stock Position:  0.004118914925019086
Bond Position:  [7.18911584]


portfolio before change:  [7.60990681]
curr_Stock_Price:  101.94244958806117
curr_Factors:  [ 1.01942450e+02 -6.26238390e-02 -1.03079249e+00]
mat_Sqrt:  [[34.157839    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00654829 -0.03132677  0.34850379]
Stock Position:  -0.006548287432060078
Bond Position:  [8.27745528]


portfolio before change:  [7.60345331]
curr_Stock_Price:  103.08599344848267
curr_Factors:  [ 1.03085993e+02 -7.34136516e-03 -1.04301582e+00]
mat_Sqrt:  [[36.0607979   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00135385  0.0050497  -0.09148229]
Stock Position:  0.0013538538398267005
Bond Position:  [7.46388994]


portfolio before change:  [7.60238272]
curr_Stock_Price:  101.60604953323015
curr_Factors:  [ 1.01606050e+02  9.59141284e-02 -1.04867290e+00]
mat_Sqrt:  [[39.18697024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191832 -0.02118354  0.04759305]
Stock Position:  -0.0019183236915198362
Bond Position:  [7.79729602]


portfolio before change:  [7.59847133]
curr_Stock_Price:  104.15312543326097
curr_Factors:  [104.15312543  -0.19744125  -1.04783986]
mat_Sqrt:  [[29.9815163   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00382162 -0.05794829  0.03339951]
Stock Position:  0.0038216229435560248
Bond Position:  [7.20043736]


portfolio before change:  [7.60903876]
curr_Stock_Price:  106.68276107165443
curr_Factors:  [106.68276107  -0.4720915   -1.05060979]
mat_Sqrt:  [[23.26984454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [6.47839286e-03 9.10940743e-04 1.35456866e+00]
Stock Position:  0.0064783928638916105
Bond Position:  [6.91790592]


portfolio before change:  [7.61768697]
curr_Stock_Price:  107.88420470195405
curr_Factors:  [107.8842047   -0.34658138  -1.04865497]
mat_Sqrt:  [[26.73095151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243279  0.23695915 -2.02044002]
Stock Position:  -0.002432786559181668
Bond Position:  [7.88014622]


portfolio before change:  [7.61635487]
curr_Stock_Price:  108.83668629322953
curr_Factors:  [108.83668629  -0.45611428  -1.04787537]
mat_Sqrt:  [[24.18805273  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01929564 0.07447958 0.15947918]
Stock Position:  0.01929563673688391
Bond Position:  [5.5162817]


portfolio before change:  [7.60376527]
curr_Stock_Price:  108.14849048615973
curr_Factors:  [108.14849049  -0.38267794  -1.05487624]
mat_Sqrt:  [[25.68612621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00884248  0.06299368 -0.34155791]
Stock Position:  -0.008842484478588696
Bond Position:  [8.56006662]


portfolio before change:  [7.58780631]
curr_Stock_Price:  110.07431116793474
curr_Factors:  [110.07431117  -0.41624963  -1.08431376]
mat_Sqrt:  [[24.54706542  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00398517 -0.03904358 -0.02763785]
Stock Position:  -0.003985169637711958
Bond Position:  [8.02647111]


portfolio before change:  [7.59492001]
curr_Stock_Price:  108.54104194275124
curr_Factors:  [108.54104194  -0.41407536  -1.08531554]
mat_Sqrt:  [[24.23353619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214987 -0.01195747 -0.00771259]
Stock Position:  -0.002149872578964161
Bond Position:  [7.82826942]


portfolio before change:  [7.59312024]
curr_Stock_Price:  109.83338523187595
curr_Factors:  [109.83338523  -0.66152018  -1.10314123]
mat_Sqrt:  [[18.80839154  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115474  0.00933566 -0.20640966]
Stock Position:  0.001154743151792936
Bond Position:  [7.46629089]


portfolio before change:  [7.5947101]
curr_Stock_Price:  110.40192961548892
curr_Factors:  [110.40192962  -0.8829737   -1.07942164]
mat_Sqrt:  [[15.51383591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00990854 0.00165728 0.85068315]
Stock Position:  0.009908536616390908
Bond Position:  [6.50078854]


portfolio before change:  [7.59689038]
curr_Stock_Price:  110.53995435728253
curr_Factors:  [110.53995436  -0.62522095  -1.08142475]
mat_Sqrt:  [[20.06007127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01021383 -0.01668109  0.64621231]
Stock Position:  0.010213826921760906
Bond Position:  [6.46785441]


portfolio before change:  [7.59929421]
curr_Stock_Price:  110.69614466722867
curr_Factors:  [110.69614467  -0.35055379  -1.07095618]
mat_Sqrt:  [[26.71643837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101474  0.01998409 -0.47037665]
Stock Position:  -0.0010147402745380111
Bond Position:  [7.71162205]


portfolio before change:  [7.60388214]
curr_Stock_Price:  107.12487294519805
curr_Factors:  [107.12487295  -0.41684785  -1.08441682]
mat_Sqrt:  [[23.87257996  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254174  0.00308139  0.02898731]
Stock Position:  -0.002541742353183604
Bond Position:  [7.87616596]


portfolio before change:  [7.60394237]
curr_Stock_Price:  107.48853884651285
curr_Factors:  [107.48853885  -0.22331726  -1.07811028]
mat_Sqrt:  [[29.25225568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00613814 0.0095565  0.15905116]
Stock Position:  0.006138142197660194
Bond Position:  [6.94416244]


portfolio before change:  [7.59644473]
curr_Stock_Price:  106.12563106620573
curr_Factors:  [106.12563107  -0.39474004  -1.07759962]
mat_Sqrt:  [[24.34396398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00116197 -0.02966393 -0.50647431]
Stock Position:  -0.0011619727077131724
Bond Position:  [7.71975981]


portfolio before change:  [7.59617123]
curr_Stock_Price:  107.1915141419683
curr_Factors:  [107.19151414  -0.48572288  -1.08837029]
mat_Sqrt:  [[22.20958426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00221995 -0.00058899  0.44760117]
Stock Position:  0.002219947597763855
Bond Position:  [7.35821168]


portfolio before change:  [7.59380359]
curr_Stock_Price:  105.71063756329832
curr_Factors:  [105.71063756  -0.49702091  -1.08958609]
mat_Sqrt:  [[21.63037389  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300534 -0.03157834 -0.58211582]
Stock Position:  -0.0030053370288305064
Bond Position:  [7.91149969]


portfolio before change:  [7.59419045]
curr_Stock_Price:  105.91099675034857
curr_Factors:  [105.91099675  -0.59430576  -1.07554708]
mat_Sqrt:  [[19.94036852  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0038953   0.0701696  -0.14489683]
Stock Position:  0.0038952950410670872
Bond Position:  [7.18163587]


portfolio before change:  [7.5921408]
curr_Stock_Price:  105.15433919664162
curr_Factors:  [105.1543392   -0.93249252  -1.0860344 ]
mat_Sqrt:  [[13.96986138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00308327 0.00790666 0.29688296]
Stock Position:  0.0030832721073646508
Bond Position:  [7.26792136]


portfolio before change:  [7.59396689]
curr_Stock_Price:  105.45192499722698
curr_Factors:  [105.451925    -0.99323128  -1.09635057]
mat_Sqrt:  [[13.04850158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03055133 -0.08021632  0.6747632 ]
Stock Position:  0.03055133247571406
Bond Position:  [4.37227007]


portfolio before change:  [7.5849181]
curr_Stock_Price:  105.13785173635819
curr_Factors:  [105.13785174  -1.01032355  -1.12411029]
mat_Sqrt:  [[12.43902271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00699648  0.01201719  0.12988152]
Stock Position:  -0.006996478461033618
Bond Position:  [8.32051281]


portfolio before change:  [7.59268649]
curr_Stock_Price:  104.17618749687605
curr_Factors:  [104.1761875   -0.77833301  -1.14392244]
mat_Sqrt:  [[15.23854586  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01302233 -0.00300487  0.27356358]
Stock Position:  0.013022329226543096
Bond Position:  [6.23606988]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.59080524]
Stock Price:  103.97186075906498
PL:  [3.61894448]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 3.32229820e-02  1.52189672e-02 -3.90603716e-03]
 [-2.31389392e-01  3.11420891e-02 -1.34555107e-01]
 [-3.88782432e-02  5.20002493e-02  2.14167388e-02]
 [ 9.67652430e-02  5.95854308e-02  1.00994090e-01]
 [ 7.17265138e-03  9.74410929e-02 -6.00731308e-02]
 [-1.15419314e-01 -1.58056617e-01  1.28212258e-01]
 [-6.16972621e-02 -1.69195138e-01  7.76027463e-02]
 [-4.13485240e-02  7.94016247e-01  1.83491097e-01]
 [ 1.73322459e-01 -5.79724492e-02  1.35616037e-01]
 [ 3.72048749e-01  1.40575289e-01  2.23588668e-01]
 [-2.05926716e-01 -2.21699232e-01  3.08389713e-02]
 [-9.78215217e-02 -2.12396765e-02  6.65690454e-02]
 [-3.14342493e-02  1.57543553e-01 -4.63206169e-02]
 [ 5.80759423e-03 -3.97403807e-02  6.23955923e-02]
 [ 4.37724169e-02  1.66582556e-02 -8.29758980e-02]
 [-4.48164880e-02 -4.50364558e-02  7.97078130e-02]
 [ 5.25751052e-02  1.49247527e-02 -3.44186283e-02]
 [-6.11773771e-02 -6.47907301e-02  1.30588072e-02]
 [ 6.96606082e-02  4.66314697e-02 -2.83746252e-01]
 [-3.39624339e-02  1.66356297e-02 -5.13730531e-02]
 [-3.83960577e-02  4.97081792e-01 -4.58548905e-01]
 [ 4.05404140e-01  2.29425153e-01  5.63607213e-02]
 [ 5.81552680e-03 -5.07124450e-02  8.03076692e-02]
 [-2.38955168e-02  9.45604362e-02 -1.49089134e-02]
 [-6.58758457e-02 -7.58360145e-03 -2.82510921e-03]
 [-1.38762862e-01 -5.84899403e-03  2.17343511e-01]
 [-1.92021969e-02 -3.25524031e-02  7.96558453e-04]
 [-4.32515035e-02  1.65350019e-02 -2.69427071e-01]
 [ 1.72966845e-02 -3.81737441e-02  8.36800875e-02]
 [-3.66493204e-03  3.35235449e-02 -4.51096193e-02]
 [ 3.10174440e-02 -4.32600257e-02 -8.56315133e-02]
 [ 7.90584930e-03  1.06711545e-01 -9.84349109e-02]
 [-2.98032547e-02  2.39481236e-02 -5.99100885e-02]
 [ 2.23322728e-02 -5.53680677e-02  6.44461169e-02]
 [-5.48373184e-02  6.58380555e-02 -1.02715941e-02]
 [ 6.01498817e-02 -3.30115977e-02  1.01234319e-01]
 [-6.12413038e-02  7.49354236e-02 -2.52827700e-02]
 [-4.38288847e-02 -2.45294214e-02  2.22593192e-02]
 [ 9.51881573e-02  5.39446659e-03  8.21895231e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.89112648]
curr_Stock_Price:  99.20765966302578
curr_Factors:  [99.20765966 -0.9539904  -0.99775429]
mat_Sqrt:  [[14.09007335  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00252179  0.0049119  -0.01114284]
Stock Position:  0.0025217912843614842
Bond Position:  [-4.14130749]


portfolio before change:  [-3.89320008]
curr_Stock_Price:  98.59067448713955
curr_Factors:  [98.59067449 -0.97524461 -1.00192232]
mat_Sqrt:  [[13.65095873  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01849676  0.01005107 -0.38384827]
Stock Position:  -0.01849675844331135
Bond Position:  [-2.06959219]


portfolio before change:  [-3.90569839]
curr_Stock_Price:  99.25239020633549
curr_Factors:  [99.25239021 -1.00295174 -1.03554311]
mat_Sqrt:  [[12.92509991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0018485   0.01678301  0.06109599]
Stock Position:  -0.0018485012429490088
Bond Position:  [-3.72223022]


portfolio before change:  [-3.90689632]
curr_Stock_Price:  99.64872034246041
curr_Factors:  [99.64872034 -1.04400637 -1.03039325]
mat_Sqrt:  [[12.51905122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0103477  0.01923112 0.28810803]
Stock Position:  0.010347701126889233
Bond Position:  [-4.93803149]


portfolio before change:  [-3.90759678]
curr_Stock_Price:  99.64068228092285
curr_Factors:  [99.64068228 -0.79338429 -1.0053277 ]
mat_Sqrt:  [[16.49172185  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00089744  0.03144898 -0.17137192]
Stock Position:  0.0008974414456129205
Bond Position:  [-3.99701846]


portfolio before change:  [-3.90793307]
curr_Stock_Price:  99.82272843173237
curr_Factors:  [99.82272843 -0.50372801 -1.01276872]
mat_Sqrt:  [[21.9090361   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00554617 -0.05101255  0.36575389]
Stock Position:  -0.005546171322680447
Bond Position:  [-3.35429911]


portfolio before change:  [-3.90668918]
curr_Stock_Price:  99.52284578789028
curr_Factors:  [99.52284579 -0.48950526 -1.01606117]
mat_Sqrt:  [[22.08328083  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364047 -0.0546075   0.22137903]
Stock Position:  -0.003640468155408141
Bond Position:  [-3.54437943]


portfolio before change:  [-3.90725943]
curr_Stock_Price:  99.557779607135
curr_Factors:  [99.55777961 -0.38717394 -1.00547937]
mat_Sqrt:  [[24.73167615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00639602 0.25626764 0.52344903]
Stock Position:  0.006396021282835233
Bond Position:  [-4.54403311]


portfolio before change:  [-3.92037621]
curr_Stock_Price:  97.59581948074641
curr_Factors:  [97.59581948 -0.23462997 -0.99196973]
mat_Sqrt:  [[28.62369758  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00660891 -0.01871053  0.38687481]
Stock Position:  0.006608908197464065
Bond Position:  [-4.56537802]


portfolio before change:  [-3.91747908]
curr_Stock_Price:  98.12054162025912
curr_Factors:  [98.12054162 -0.24813183 -0.99755403]
mat_Sqrt:  [[28.23354712  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01581039 0.04537048 0.63783623]
Stock Position:  0.015810390511648568
Bond Position:  [-5.46880316]


portfolio before change:  [-3.92203488]
curr_Stock_Price:  97.87562889170353
curr_Factors:  [97.87562889 -0.22723253 -1.00087473]
mat_Sqrt:  [[28.66251936  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00854377 -0.07155312  0.087975  ]
Stock Position:  -0.008543767586536908
Bond Position:  [-3.08580826]


portfolio before change:  [-3.90036352]
curr_Stock_Price:  95.29396774347624
curr_Factors:  [ 9.52939677e+01 -2.91604759e-02 -1.02472531e+00]
mat_Sqrt:  [[33.21762899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266632 -0.00685508  0.18990296]
Stock Position:  -0.002666316220479633
Bond Position:  [-3.64627967]


portfolio before change:  [-3.90387646]
curr_Stock_Price:  96.44054100781179
curr_Factors:  [96.44054101 -0.27119412 -1.03310456]
mat_Sqrt:  [[26.17037325  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033362  0.05084696 -0.13213983]
Stock Position:  -0.0003336200951198755
Bond Position:  [-3.87170196]


portfolio before change:  [-3.90480862]
curr_Stock_Price:  97.78386778869543
curr_Factors:  [ 9.77838678e+01 -8.88195317e-02 -1.06094617e+00]
mat_Sqrt:  [[30.9692233   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00033685 -0.01282615  0.17799726]
Stock Position:  0.0003368528118405604
Bond Position:  [-3.93774739]


portfolio before change:  [-3.90457236]
curr_Stock_Price:  99.94653762884722
curr_Factors:  [99.94653763 -0.28403919 -1.07309434]
mat_Sqrt:  [[25.72599317  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00117529  0.00537643 -0.23670714]
Stock Position:  0.0011752854275719894
Bond Position:  [-4.02203807]


portfolio before change:  [-3.90495179]
curr_Stock_Price:  100.051496553955
curr_Factors:  [100.05149655  -0.32108394  -1.09581344]
mat_Sqrt:  [[24.25899896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155568 -0.01453545  0.2273842 ]
Stock Position:  -0.0015556794784945304
Bond Position:  [-3.74930373]


portfolio before change:  [-3.90583958]
curr_Stock_Price:  100.3208959111736
curr_Factors:  [100.32089591  -0.14538023  -1.10174659]
mat_Sqrt:  [[28.8251188   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00168589  0.00481694 -0.09818677]
Stock Position:  0.0016858884384675283
Bond Position:  [-4.07496942]


portfolio before change:  [-3.90727365]
curr_Stock_Price:  99.77242159764005
curr_Factors:  [99.7724216  -0.23190075 -1.1248751 ]
mat_Sqrt:  [[25.69036332  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00279237 -0.02091112  0.03725314]
Stock Position:  -0.0027923743509589206
Bond Position:  [-3.6286717]


portfolio before change:  [-3.90492556]
curr_Stock_Price:  98.76908008522655
curr_Factors:  [98.76908009 -0.39400512 -1.13647966]
mat_Sqrt:  [[21.37666305  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099453  0.01505024 -0.80944908]
Stock Position:  0.000994531091540613
Bond Position:  [-4.00315448]


portfolio before change:  [-3.90570719]
curr_Stock_Price:  98.48633422552612
curr_Factors:  [98.48633423 -0.63555169 -1.11498812]
mat_Sqrt:  [[17.10512267  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00240005  0.00536913 -0.14655302]
Stock Position:  -0.0024000518218827336
Bond Position:  [-3.66933488]


portfolio before change:  [-3.90623648]
curr_Stock_Price:  98.51575076942304
curr_Factors:  [98.51575077 -0.61334714 -1.1117934 ]
mat_Sqrt:  [[17.55038514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0017396   0.16043246 -1.30811239]
Stock Position:  -0.0017395951590712347
Bond Position:  [-3.73485896]


portfolio before change:  [-3.90428381]
curr_Stock_Price:  97.12487411843611
curr_Factors:  [97.12487412 -0.33297036 -1.07021102]
mat_Sqrt:  [[23.87462387  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01942397 0.07404665 0.16078145]
Stock Position:  0.019423968317688084
Bond Position:  [-5.79083428]


portfolio before change:  [-3.91909586]
curr_Stock_Price:  96.39957665271969
curr_Factors:  [96.39957665 -0.14620921 -1.07056745]
mat_Sqrt:  [[28.55194759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00041527 -0.01636737  0.22909543]
Stock Position:  0.00041526507499762373
Bond Position:  [-3.95912724]


portfolio before change:  [-3.91943968]
curr_Stock_Price:  96.76345977536103
curr_Factors:  [ 9.67634598e+01 -2.64161097e-02 -1.05811131e+00]
mat_Sqrt:  [[32.71200138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00023345  0.03051925 -0.04253098]
Stock Position:  -0.00023345309127622324
Bond Position:  [-3.89684995]


portfolio before change:  [-3.91993321]
curr_Stock_Price:  96.79086043926948
curr_Factors:  [96.79086044 -0.15095264 -1.06252206]
mat_Sqrt:  [[28.7626558   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236419 -0.0024476  -0.00805925]
Stock Position:  -0.0023641945777542754
Bond Position:  [-3.69110078]


portfolio before change:  [-3.92067776]
curr_Stock_Price:  96.91061867167517
curr_Factors:  [ 9.69106187e+01  2.32337779e-02 -1.07333347e+00]
mat_Sqrt:  [[33.90930308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281904 -0.00188775  0.62002054]
Stock Position:  -0.0028190412645979035
Bond Position:  [-3.64748272]


portfolio before change:  [-3.9271688]
curr_Stock_Price:  99.0514452017801
curr_Factors:  [99.0514452  -0.36893395 -1.0912008 ]
mat_Sqrt:  [[23.00023916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0011167  -0.01050624  0.00227236]
Stock Position:  -0.0011166984544209487
Bond Position:  [-3.8165582]


portfolio before change:  [-3.92778721]
curr_Stock_Price:  99.17798966806747
curr_Factors:  [99.17798967 -0.32967335 -1.09845587]
mat_Sqrt:  [[23.77862082  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00398984  0.00533665 -0.76860044]
Stock Position:  -0.003989839516563268
Bond Position:  [-3.53208295]


portfolio before change:  [-3.92546903]
curr_Stock_Price:  98.48630181592226
curr_Factors:  [98.48630182 -0.19000665 -1.10619192]
mat_Sqrt:  [[26.94287536  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00098674 -0.01232052  0.238716  ]
Stock Position:  0.0009867405605674955
Bond Position:  [-4.02264945]


portfolio before change:  [-3.9273716]
curr_Stock_Price:  97.06777652926813
curr_Factors:  [97.06777653 -0.59773939 -1.11564954]
mat_Sqrt:  [[17.4968442   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034463  0.01081968 -0.12868519]
Stock Position:  -0.0003446295523592883
Bond Position:  [-3.89391918]


portfolio before change:  [-3.92823033]
curr_Stock_Price:  98.14706534935003
curr_Factors:  [98.14706535 -0.80515279 -1.10692553]
mat_Sqrt:  [[14.50348114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00032458 -0.01396211 -0.24428287]
Stock Position:  0.0003245819867124923
Bond Position:  [-3.9600871]


portfolio before change:  [-3.92884561]
curr_Stock_Price:  97.77662316662511
curr_Factors:  [97.77662317 -0.71489602 -1.1060937 ]
mat_Sqrt:  [[15.82665903  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00060628  0.034441   -0.2808074 ]
Stock Position:  0.0006062751588840207
Bond Position:  [-3.98812515]


portfolio before change:  [-3.92852934]
curr_Stock_Price:  99.12059273540149
curr_Factors:  [99.12059274 -0.60395408 -1.10593885]
mat_Sqrt:  [[17.92944411  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207167  0.00772922 -0.17090681]
Stock Position:  -0.0020716738220994658
Bond Position:  [-3.7231838]


portfolio before change:  [-3.92983676]
curr_Stock_Price:  99.52702426884991
curr_Factors:  [99.52702427 -0.56398703 -1.1020108 ]
mat_Sqrt:  [[18.81080383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00128571 -0.01786997  0.18384683]
Stock Position:  0.0012857144257647692
Bond Position:  [-4.05780009]


portfolio before change:  [-3.93038746]
curr_Stock_Price:  99.49324069999747
curr_Factors:  [99.4932407  -0.49157633 -1.07838923]
mat_Sqrt:  [[20.69980226  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00210122  0.02124914 -0.029302  ]
Stock Position:  -0.002101221131236148
Bond Position:  [-3.72133016]


portfolio before change:  [-3.92972047]
curr_Stock_Price:  98.95442207813217
curr_Factors:  [98.95442208 -0.51656498 -1.07687157]
mat_Sqrt:  [[20.11011292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00368351 -0.01065445  0.28879333]
Stock Position:  0.0036835092210938222
Bond Position:  [-4.29422]


portfolio before change:  [-3.92676893]
curr_Stock_Price:  99.90144217325431
curr_Factors:  [99.90144217 -0.60433541 -1.0605167 ]
mat_Sqrt:  [[18.90321494  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270356  0.0241853  -0.07212471]
Stock Position:  -0.002703561192672587
Bond Position:  [-3.65667927]


portfolio before change:  [-3.92617578]
curr_Stock_Price:  99.51296965965771
curr_Factors:  [99.51296966 -0.41597053 -1.05029166]
mat_Sqrt:  [[22.96625113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00192858 -0.00791684  0.06349964]
Stock Position:  -0.0019285806411100197
Bond Position:  [-3.73425699]


portfolio before change:  [-3.92802055]
curr_Stock_Price:  100.22746289570904
curr_Factors:  [100.2274629   -0.42805581  -1.04546221]
mat_Sqrt:  [[22.96391835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00492364 0.00174106 0.23446383]
Stock Position:  0.0049236442425346395
Bond Position:  [-4.42150492]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.9242414]
Stock Price:  101.10727257111597
PL:  [-5.03151397]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.25788752e-01 -6.14795783e-02  6.38226619e-03]
 [-2.30616635e-01  3.34880722e-02 -1.43358274e-01]
 [-3.04173278e-02  5.42162471e-02  2.85311767e-02]
 [ 1.14362811e-01  3.93948703e-02  1.37153981e-01]
 [ 3.31887734e-02  4.98336379e-02 -6.89724852e-02]
 [-7.04003199e-02 -1.50780446e-01  1.62842240e-01]
 [-5.44273955e-02 -1.51760126e-01  3.60425543e-03]
 [ 9.36066570e-03  7.02026912e-01  1.12443978e-01]
 [ 1.44808178e-01  1.70329388e-02  1.65339070e-01]
 [ 4.82548853e-01  2.02928579e-01  3.69402255e-01]
 [-1.87384348e-01 -2.15573005e-01  2.38685754e-02]
 [ 6.97299892e-03 -1.47863731e-02  1.07163880e-01]
 [ 1.41669396e-02 -5.72869138e-02  6.96650828e-02]
 [ 5.58004992e-03  4.26594706e-02 -1.41268361e-01]
 [ 4.31301611e-01 -1.37780324e-01 -2.10842453e-01]
 [-2.16079789e-01 -9.63920291e-02  1.19595328e-01]
 [ 5.13613279e-02  1.71031821e-02 -2.73195294e-02]
 [-5.94788060e-02 -6.22617514e-02  2.48024993e-02]
 [ 1.55976196e-01 -1.89684159e-01  2.06654426e-02]
 [ 5.05212310e-02 -2.41407331e-03  3.73429566e-01]
 [-5.23603889e-02  6.16168642e-01 -5.97639285e-01]
 [ 5.03448379e-01  2.76338991e-01  4.03949080e-02]
 [ 1.11191202e-02  1.20575806e-01 -2.93674396e-02]
 [-5.44142762e-02 -1.31222231e-01 -2.60166509e-02]
 [ 3.34872959e-02  1.83446210e-02 -1.18360354e-02]
 [-6.18434117e-02 -8.12703607e-03  1.80843713e-01]
 [ 8.39122348e-02 -2.79263714e-02  4.31375454e-02]
 [ 1.45032435e-01 -6.85031025e-02  8.82082887e-02]
 [-5.10023956e-02 -4.02285535e-02  1.66500680e-02]
 [-6.46961140e-02 -1.42432658e-02  3.75796827e-02]
 [ 2.69716254e-02 -2.80914961e-02 -2.68355828e-03]
 [ 2.63999083e-02 -5.54294284e-02 -1.19427060e-01]
 [-4.19566338e-02  1.75558925e-02  1.26372576e-03]
 [ 2.18810659e-02 -5.59490025e-02  6.14986082e-02]
 [-5.01644186e-02  4.03545822e-02  9.61265095e-03]
 [ 8.90223585e-02  1.14978727e-02  1.74284965e-01]
 [ 8.25713049e-02 -6.68664300e-02  1.94433678e-02]
 [-9.09098733e-02  2.94327063e-02  4.49073675e-02]
 [ 2.08341242e-01 -1.49710378e-02  8.77792208e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.68406581]
curr_Stock_Price:  99.61198164212807
curr_Factors:  [99.61198164 -1.15177362 -0.99408316]
mat_Sqrt:  [[11.65139224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00983076 -0.01984245  0.01820683]
Stock Position:  0.009830761709198901
Bond Position:  [-1.66332747]


portfolio before change:  [-0.69369716]
curr_Stock_Price:  98.6534178273896
curr_Factors:  [98.65341783 -0.96023411 -1.00546675]
mat_Sqrt:  [[13.81717001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01831372  0.01080823 -0.40896125]
Stock Position:  -0.018313720970764502
Bond Position:  [1.11301401]


portfolio before change:  [-0.69846255]
curr_Stock_Price:  98.92122397202345
curr_Factors:  [98.92122397 -0.95773828 -0.99472093]
mat_Sqrt:  [[14.0393572   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00096348  0.01749822  0.08139151]
Stock Position:  -0.0009634757849305236
Bond Position:  [-0.60315434]


portfolio before change:  [-0.7000491]
curr_Stock_Price:  100.48966025885426
curr_Factors:  [100.48966026  -0.84773649  -0.99846702]
mat_Sqrt:  [[15.86081074  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00948254 0.01271464 0.39126213]
Stock Position:  0.009482535062904314
Bond Position:  [-1.65294582]


portfolio before change:  [-0.70668698]
curr_Stock_Price:  99.81143931523218
curr_Factors:  [99.81143932 -1.04941046 -1.0114173 ]
mat_Sqrt:  [[12.71083831  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00230371  0.01608374 -0.1967593 ]
Stock Position:  0.002303708997285933
Bond Position:  [-0.93662349]


portfolio before change:  [-0.7083933]
curr_Stock_Price:  99.1215788564646
curr_Factors:  [99.12157886 -1.27231137 -0.98581684]
mat_Sqrt:  [[10.36276361  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00655599 -0.04866418  0.46454358]
Stock Position:  -0.0065559940466832535
Bond Position:  [-0.05855282]


portfolio before change:  [-0.71807041]
curr_Stock_Price:  100.5965328458676
curr_Factors:  [100.59653285  -1.29939065  -0.96826607]
mat_Sqrt:  [[10.41722904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00812784 -0.04898037  0.01028194]
Stock Position:  -0.008127841444017028
Bond Position:  [0.09956225]


portfolio before change:  [-0.72477147]
curr_Stock_Price:  101.42252107230935
curr_Factors:  [101.42252107  -1.45024118  -0.98497458]
mat_Sqrt:  [[ 8.88246771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01977084 0.22657821 0.32077137]
Stock Position:  0.019770839104421165
Bond Position:  [-2.72997981]


portfolio before change:  [-0.72192878]
curr_Stock_Price:  101.58356413312893
curr_Factors:  [101.58356413  -1.61866376  -0.9835641 ]
mat_Sqrt:  [[ 7.52818435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02418043 0.00549736 0.47166635]
Stock Position:  0.024180426559440846
Bond Position:  [-3.17826269]


portfolio before change:  [-0.7219705]
curr_Stock_Price:  101.59826983945071
curr_Factors:  [101.59826984  -1.26725332  -0.99985436]
mat_Sqrt:  [[10.52674153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05693836 0.06549492 1.05380181]
Stock Position:  0.056938359640234214
Bond Position:  [-6.50680933]


portfolio before change:  [-0.69635558]
curr_Stock_Price:  102.06242648424244
curr_Factors:  [102.06242648  -1.35087015  -0.98069953]
mat_Sqrt:  [[ 9.91466501  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02284655 -0.06957589  0.0680904 ]
Stock Position:  -0.022846546088017994
Bond Position:  [1.63541835]


portfolio before change:  [-0.69918248]
curr_Stock_Price:  102.19510901992308
curr_Factors:  [102.19510902  -1.42707312  -0.95344483]
mat_Sqrt:  [[ 9.45331882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00273232 -0.00477228  0.30570872]
Stock Position:  0.002732318563013709
Bond Position:  [-0.97841207]


portfolio before change:  [-0.70139]
curr_Stock_Price:  101.43194543349803
curr_Factors:  [101.43194543  -1.18979261  -0.94342575]
mat_Sqrt:  [[12.01516646  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138938 -0.01848927  0.19873509]
Stock Position:  0.0013893792327719441
Bond Position:  [-0.84231743]


portfolio before change:  [-0.70096182]
curr_Stock_Price:  101.8159088060146
curr_Factors:  [101.81590881  -0.66060653  -0.93535155]
mat_Sqrt:  [[20.63953255  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00070488  0.01376828 -0.40299931]
Stock Position:  -0.0007048805691419602
Bond Position:  [-0.62919377]


portfolio before change:  [-0.70243184]
curr_Stock_Price:  103.78980431550144
curr_Factors:  [103.78980432  -0.64382987  -0.93597314]
mat_Sqrt:  [[21.38232675  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01684285 -0.04446841 -0.60147483]
Stock Position:  0.01684284827292291
Bond Position:  [-2.45054776]


portfolio before change:  [-0.72245308]
curr_Stock_Price:  102.61928361565647
curr_Factors:  [102.61928362  -0.32114472  -0.97956307]
mat_Sqrt:  [[27.9472295   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00756223 -0.03111039  0.34117218]
Stock Position:  -0.0075622320720532075
Bond Position:  [0.05357776]


portfolio before change:  [-0.72953776]
curr_Stock_Price:  103.55702023803542
curr_Factors:  [103.55702024  -0.57308379  -0.97030224]
mat_Sqrt:  [[22.12562312  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0022271   0.00552003 -0.07793501]
Stock Position:  0.0022270977180040273
Bond Position:  [-0.96016936]


portfolio before change:  [-0.72832446]
curr_Stock_Price:  104.15570351196465
curr_Factors:  [104.15570351  -0.71245026  -0.94994333]
mat_Sqrt:  [[19.75671314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00339759 -0.02009489  0.07075463]
Stock Position:  -0.003397586597420314
Bond Position:  [-0.37444644]


portfolio before change:  [-0.7285713]
curr_Stock_Price:  104.21457614763881
curr_Factors:  [104.21457615  -0.84091229  -0.93241682]
mat_Sqrt:  [[17.69218281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00686605 -0.0612203   0.05895276]
Stock Position:  0.006866049039864829
Bond Position:  [-1.44411369]


portfolio before change:  [-0.72137693]
curr_Stock_Price:  105.28868634298526
curr_Factors:  [105.28868634  -0.66079145  -0.93014835]
mat_Sqrt:  [[21.45089092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.88574394e-03 -7.79138812e-04  1.06529061e+00]
Stock Position:  0.0058857439445282565
Bond Position:  [-1.34107918]


portfolio before change:  [-0.72430831]
curr_Stock_Price:  104.81912143264705
curr_Factors:  [104.81912143  -0.46764956  -0.92780594]
mat_Sqrt:  [[25.96581109  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00187085  0.19886757 -1.70489853]
Stock Position:  -0.0018708485335195665
Bond Position:  [-0.52820761]


portfolio before change:  [-0.72284584]
curr_Stock_Price:  104.00210810868852
curr_Factors:  [104.00210811  -0.36397957  -0.96000057]
mat_Sqrt:  [[27.67227563  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02052962 0.08918803 0.11523543]
Stock Position:  0.020529624051679986
Bond Position:  [-2.85797002]


portfolio before change:  [-0.75723441]
curr_Stock_Price:  102.34444000408052
curr_Factors:  [102.34444     -0.1901325   -0.94970639]
mat_Sqrt:  [[32.73697256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090836  0.03891567 -0.08377713]
Stock Position:  0.0009083598049060232
Bond Position:  [-0.85019998]


portfolio before change:  [-0.75764909]
curr_Stock_Price:  102.00492938079708
curr_Factors:  [102.00492938  -0.22115941  -0.95997055]
mat_Sqrt:  [[31.30854847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00276316 -0.04235179 -0.07421826]
Stock Position:  -0.0027631599931676252
Bond Position:  [-0.47579315]


portfolio before change:  [-0.7544884]
curr_Stock_Price:  100.83953769912935
curr_Factors:  [100.8395377   -0.16790911  -0.97539969]
mat_Sqrt:  [[32.14386841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00108313  0.0059207  -0.03376491]
Stock Position:  0.0010831258674119867
Bond Position:  [-0.86371031]


portfolio before change:  [-0.75400018]
curr_Stock_Price:  101.38997572855257
curr_Factors:  [101.38997573  -0.21991107  -0.97691553]
mat_Sqrt:  [[30.63513718  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00086788 -0.00262299  0.51589678]
Stock Position:  -0.0008678847259951687
Bond Position:  [-0.66600537]


portfolio before change:  [-0.75626539]
curr_Stock_Price:  103.90408723038907
curr_Factors:  [103.90408723  -0.48627684  -0.98997288]
mat_Sqrt:  [[23.74135624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00366522 -0.0090132   0.12305941]
Stock Position:  0.0036652161641523057
Bond Position:  [-1.13709633]


portfolio before change:  [-0.76204974]
curr_Stock_Price:  102.36469568775262
curr_Factors:  [102.36469569  -0.3617758   -0.96963687]
mat_Sqrt:  [[27.03491603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00551342 -0.02210928  0.2516337 ]
Stock Position:  0.005513416011318455
Bond Position:  [-1.32642889]


portfolio before change:  [-0.76700278]
curr_Stock_Price:  101.49640816880061
curr_Factors:  [101.49640817  -0.57895643  -0.99022399]
mat_Sqrt:  [[21.13315182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264113 -0.01298371  0.04749801]
Stock Position:  -0.0026411268096124814
Bond Position:  [-0.4989379]


portfolio before change:  [-0.77180561]
curr_Stock_Price:  103.29126858908563
curr_Factors:  [103.29126859  -0.45879852  -0.98596854]
mat_Sqrt:  [[24.35618415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00246067 -0.00459699  0.10720437]
Stock Position:  -0.0024606723069823563
Bond Position:  [-0.51763965]


portfolio before change:  [-0.77276508]
curr_Stock_Price:  103.6548928020654
curr_Factors:  [103.6548928   -0.2922505   -0.98285312]
mat_Sqrt:  [[28.96138582  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071439 -0.00906649 -0.00765544]
Stock Position:  0.0007143889408420315
Bond Position:  [-0.84681499]


portfolio before change:  [-0.7727243]
curr_Stock_Price:  103.86015314574216
curr_Factors:  [103.86015315  -0.56784695  -0.94299234]
mat_Sqrt:  [[22.92449571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00040535 -0.01788977 -0.34069216]
Stock Position:  -0.0004053534236386882
Bond Position:  [-0.73062423]


portfolio before change:  [-0.77187884]
curr_Stock_Price:  101.5490848707471
curr_Factors:  [101.54908487  -0.44732864  -0.92564554]
mat_Sqrt:  [[25.72769652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148148  0.00566614  0.00360506]
Stock Position:  -0.0014814810693294688
Bond Position:  [-0.62143579]


portfolio before change:  [-0.76912741]
curr_Stock_Price:  99.63943786098763
curr_Factors:  [99.63943786 -0.34954405 -0.90389512]
mat_Sqrt:  [[28.44916711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00080895 -0.01805746  0.17543841]
Stock Position:  0.0008089472107976738
Bond Position:  [-0.84973046]


portfolio before change:  [-0.7685739]
curr_Stock_Price:  100.45499196089568
curr_Factors:  [100.45499196  -0.65923955  -0.89927497]
mat_Sqrt:  [[21.14059794  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189043  0.01302439  0.02742222]
Stock Position:  -0.001890433752195201
Bond Position:  [-0.57867039]


portfolio before change:  [-0.76963305]
curr_Stock_Price:  100.97699554931722
curr_Factors:  [100.97699555  -0.66965322  -0.9204509 ]
mat_Sqrt:  [[20.58965173  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00616548 0.00371092 0.49718649]
Stock Position:  0.006165481716370009
Bond Position:  [-1.39220487]


portfolio before change:  [-0.75973923]
curr_Stock_Price:  102.6099351915319
curr_Factors:  [102.60993519  -0.65612169  -0.92790225]
mat_Sqrt:  [[21.05021606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00346273 -0.02158105  0.05546652]
Stock Position:  0.0034627251640300272
Bond Position:  [-1.11504923]


portfolio before change:  [-0.75362146]
curr_Stock_Price:  104.41693826546816
curr_Factors:  [104.41693827  -0.5407429   -0.9465049 ]
mat_Sqrt:  [[23.59757851  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00320945  0.00949937  0.12810822]
Stock Position:  -0.0032094508894549693
Bond Position:  [-0.41850043]


portfolio before change:  [-0.75315609]
curr_Stock_Price:  104.25563611835257
curr_Factors:  [104.25563612  -0.6855584   -0.96932186]
mat_Sqrt:  [[19.92480947  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01120227 -0.00483188  0.25040968]
Stock Position:  0.011202272766690016
Bond Position:  [-1.92105616]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.75247573]
Stock Price:  104.33780732820297
PL:  [-5.09028306]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 3.73826356e-02 -7.26956285e-02  9.83378836e-03]
 [-1.09821167e-01  7.05661624e-02 -1.14053044e-01]
 [-2.40806990e-01 -5.57617503e-02 -1.86044353e-01]
 [-1.04950090e+00 -4.14473356e-01 -7.32157361e-01]
 [ 2.04989960e-01 -2.11796357e-01 -1.04910824e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.68657054e-02 -1.63326101e-01  5.26179885e-02]
 [ 6.45981309e-03  7.02824337e-01  1.05382726e-01]
 [ 2.69391042e-01 -1.15190856e-02  2.79705447e-01]
 [ 4.44732144e-01  1.73281652e-01  2.92689405e-01]
 [-2.45315904e-01 -2.42064166e-01  2.93209005e-02]
 [-6.80712376e-02 -1.90662402e-02  8.85740272e-02]
 [ 7.15974389e-03 -5.58526101e-02  1.29245020e-01]
 [ 1.06048274e-02 -8.38825833e-02 -9.60157258e-02]
 [ 6.46422899e-02 -6.29204047e-02 -9.12323034e-02]
 [-5.63700295e-02 -4.83035212e-02  8.23740115e-02]
 [ 5.17736547e-02  1.63631577e-02 -2.97311321e-02]
 [-5.04411853e-02 -6.25273500e-02  3.33938746e-03]
 [ 3.63126111e-02  5.01697366e-02 -2.11981541e-01]
 [ 1.02112885e-03  2.44492645e-02 -4.35352118e-02]
 [-4.10005603e-02  5.34251516e-01 -5.13541215e-01]
 [ 5.36355403e-01  2.92084891e-01  3.50362310e-02]
 [-7.37840239e-03 -8.62296922e-04  4.98503662e-02]
 [ 7.37396507e-03 -1.00307497e-01 -1.50385414e-01]
 [ 2.92699426e-02  2.07780734e-02 -1.18428618e-02]
 [-7.75213068e-02 -1.44146307e-02  2.06464572e-01]
 [-1.86850668e-02 -3.25300869e-02  9.95483752e-04]
 [-5.08961688e-02  3.09559266e-02 -2.43749694e-01]
 [ 1.73387782e-02 -3.82694301e-02  8.36110643e-02]
 [-8.34998289e-02  3.04744289e-03  3.10141412e-02]
 [-8.77854796e-04 -3.56920688e-02 -5.96112392e-03]
 [ 3.05235673e-02  2.37072130e-03 -6.19913595e-02]
 [-4.10945964e-02  2.07954082e-02 -7.11291097e-02]
 [ 1.45359063e-02 -6.56246191e-02  1.11699865e-02]
 [-3.36786823e-02  5.83190599e-02  3.79112297e-02]
 [ 7.93105870e-02  3.05751622e-02  1.82369213e-01]
 [ 6.75804154e-02 -4.40694004e-02  8.12912424e-03]
 [-7.36437049e-02  1.00664011e-02  3.84914681e-02]
 [ 1.51163521e-01 -3.37047533e-03  1.02739765e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.67353871]
curr_Stock_Price:  99.78313816460178
curr_Factors:  [99.78313816 -0.80891622 -0.99875346]
mat_Sqrt:  [[16.36802163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00149994 -0.02346241  0.02805306]
Stock Position:  0.001499937914107676
Bond Position:  [0.5238702]


portfolio before change:  [0.67445723]
curr_Stock_Price:  100.35184455738234
curr_Factors:  [100.35184456  -0.73574992  -0.98197403]
mat_Sqrt:  [[18.01056453  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00659046  0.02277513 -0.32536159]
Stock Position:  -0.0065904591556022055
Bond Position:  [1.33582196]


portfolio before change:  [0.65591323]
curr_Stock_Price:  103.19094626720054
curr_Factors:  [103.19094627  -0.79722273  -1.01760984]
mat_Sqrt:  [[16.80621152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01726537 -0.01799703 -0.53073276]
Stock Position:  -0.01726536966694367
Bond Position:  [2.43754306]


portfolio before change:  [0.63923897]
curr_Stock_Price:  104.17435863019386
curr_Factors:  [104.17435863  -0.85294089  -1.00976178]
mat_Sqrt:  [[16.17332616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07936252 -0.1337707  -2.08864116]
Stock Position:  -0.07936251985656259
Bond Position:  [8.90677857]


portfolio before change:  [0.79680073]
curr_Stock_Price:  102.20304592514304
curr_Factors:  [102.20304593  -0.7856548   -0.9709657 ]
mat_Sqrt:  [[17.64303297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00795455 -0.06835698 -0.29928138]
Stock Position:  0.00795454941769734
Bond Position:  [-0.01617845]


portfolio before change:  [0.7970399]
curr_Stock_Price:  102.23336826942533
curr_Factors:  [102.23336827  -0.66056717  -0.9720475 ]
mat_Sqrt:  [[19.97823551  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00767356 -0.05534923  0.15513819]
Stock Position:  -0.007673560365716591
Bond Position:  [1.58153383]


portfolio before change:  [0.8098993]
curr_Stock_Price:  100.5833270512336
curr_Factors:  [100.58332705  -0.50235133  -0.95905847]
mat_Sqrt:  [[23.32618881  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00340664 -0.05271327  0.15010448]
Stock Position:  -0.0034066389902004074
Bond Position:  [1.15255038]


portfolio before change:  [0.80942163]
curr_Stock_Price:  100.76583627942207
curr_Factors:  [100.76583628  -0.7158686   -0.97694964]
mat_Sqrt:  [[18.54093763  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00924626 0.22683558 0.30062758]
Stock Position:  0.009246263181983327
Bond Position:  [-0.12228581]


portfolio before change:  [0.80878372]
curr_Stock_Price:  100.69849839819945
curr_Factors:  [100.6984984   -0.9152269   -0.98249933]
mat_Sqrt:  [[15.09562032  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02147208 -0.00371777  0.79792178]
Stock Position:  0.021472079094226344
Bond Position:  [-1.3534224]


portfolio before change:  [0.80435539]
curr_Stock_Price:  100.5001409458834
curr_Factors:  [100.50014095  -0.93226404  -0.96613489]
mat_Sqrt:  [[15.05575329  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0358566  0.05592641 0.8349614 ]
Stock Position:  0.035856597646463255
Bond Position:  [-2.79923773]


portfolio before change:  [0.79334789]
curr_Stock_Price:  100.20291344991165
curr_Factors:  [100.20291345  -0.61933651  -0.95606391]
mat_Sqrt:  [[20.73445556  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01392571 -0.07812587  0.08364437]
Stock Position:  -0.013925706421237883
Bond Position:  [2.18874425]


portfolio before change:  [0.79953478]
curr_Stock_Price:  99.7782833809019
curr_Factors:  [99.77828338 -0.59167389 -0.93802514]
mat_Sqrt:  [[21.6120606   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249319 -0.0061536   0.25267705]
Stock Position:  -0.0024931921562592204
Bond Position:  [1.04830121]


portfolio before change:  [0.79832547]
curr_Stock_Price:  100.31588943386207
curr_Factors:  [100.31588943  -0.70650764  -0.92095996]
mat_Sqrt:  [[19.70468654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112364 -0.01802635  0.36870007]
Stock Position:  0.0011236365871881166
Bond Position:  [0.68560687]


portfolio before change:  [0.79837893]
curr_Stock_Price:  100.28719148965075
curr_Factors:  [100.28719149  -0.59017323  -0.91165363]
mat_Sqrt:  [[22.33625455  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00116925 -0.02707299 -0.27390614]
Stock Position:  -0.0011692542753356742
Bond Position:  [0.91564016]


portfolio before change:  [0.79828451]
curr_Stock_Price:  100.46583633795005
curr_Factors:  [100.46583634  -0.49486739  -0.88473086]
mat_Sqrt:  [[25.28520616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00131207 -0.02030747 -0.26026037]
Stock Position:  0.0013120715682849613
Bond Position:  [0.66646614]


portfolio before change:  [0.79756036]
curr_Stock_Price:  99.85042235770686
curr_Factors:  [99.85042236 -0.34430362 -0.8720613 ]
mat_Sqrt:  [[29.58620975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00167022 -0.01558989  0.23499013]
Stock Position:  -0.0016702179915161091
Bond Position:  [0.96433233]


portfolio before change:  [0.79794447]
curr_Stock_Price:  99.69262212339623
curr_Factors:  [99.69262212 -0.51926999 -0.89585379]
mat_Sqrt:  [[24.21489387  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0020254   0.00528119 -0.08481464]
Stock Position:  0.002025403399797966
Bond Position:  [0.59602669]


portfolio before change:  [0.79761247]
curr_Stock_Price:  99.49191881288647
curr_Factors:  [99.49191881 -0.44409018 -0.86855794]
mat_Sqrt:  [[26.77392065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00233522 -0.02018062  0.00952634]
Stock Position:  -0.0023352156132017896
Bond Position:  [1.02994755]


portfolio before change:  [0.79947894]
curr_Stock_Price:  98.74778366827316
curr_Factors:  [98.74778367 -0.47744012 -0.85719054]
mat_Sqrt:  [[25.99588635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.26285940e-04  1.61922129e-02 -6.04724331e-01]
Stock Position:  0.00012628594014738628
Bond Position:  [0.78700848]


portfolio before change:  [0.79978191]
curr_Stock_Price:  100.3678789804499
curr_Factors:  [100.36787898  -0.52263179  -0.85346592]
mat_Sqrt:  [[25.34913265  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.13407188e-04  7.89096617e-03 -1.24193841e-01]
Stock Position:  -0.00011340718753504121
Bond Position:  [0.81116435]


portfolio before change:  [0.79990152]
curr_Stock_Price:  100.20738314072298
curr_Factors:  [100.20738314  -0.59424354  -0.87857113]
mat_Sqrt:  [[22.97547185  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00160054  0.17242894 -1.46499014]
Stock Position:  -0.0016005367845852386
Bond Position:  [0.96028712]


portfolio before change:  [0.79814263]
curr_Stock_Price:  101.38131945916524
curr_Factors:  [101.38131946  -0.50813026  -0.88983941]
mat_Sqrt:  [[25.05113586  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0240759  0.09426999 0.09994861]
Stock Position:  0.024075903231224435
Bond Position:  [-1.6427042]


portfolio before change:  [0.76476637]
curr_Stock_Price:  100.00355545204883
curr_Factors:  [100.00355545  -0.66676771  -0.91577374]
mat_Sqrt:  [[20.54595914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.27579607e-04 -2.78305135e-04  1.42209219e-01]
Stock Position:  0.00012757960683600756
Bond Position:  [0.75200795]


portfolio before change:  [0.76487202]
curr_Stock_Price:  100.09485684571051
curr_Factors:  [100.09485685  -0.78192004  -0.9242981 ]
mat_Sqrt:  [[18.17233093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00241018 -0.03237411 -0.42900773]
Stock Position:  -0.002410175734965497
Bond Position:  [1.00611822]


portfolio before change:  [0.76579229]
curr_Stock_Price:  99.76521541020014
curr_Factors:  [99.76521541 -0.60065943 -0.91752528]
mat_Sqrt:  [[21.85948393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00142244  0.00670609 -0.03378439]
Stock Position:  0.0014224414041947605
Bond Position:  [0.62388212]


portfolio before change:  [0.76642178]
curr_Stock_Price:  100.15293188576452
curr_Factors:  [100.15293189  -0.40939279  -0.90988266]
mat_Sqrt:  [[26.77377561  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00143122 -0.0046523   0.58898596]
Stock Position:  -0.0014312242386196133
Bond Position:  [0.90976309]


portfolio before change:  [0.76817375]
curr_Stock_Price:  99.00829390609456
curr_Factors:  [99.00829391 -0.51219175 -0.91054957]
mat_Sqrt:  [[23.86617785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105262 -0.01049904  0.00283984]
Stock Position:  -0.0010526210285832047
Bond Position:  [0.87239196]


portfolio before change:  [0.76860816]
curr_Stock_Price:  98.69920072110943
curr_Factors:  [98.69920072 -0.21445734 -0.91331518]
mat_Sqrt:  [[31.95422241  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295211  0.00999098 -0.69535003]
Stock Position:  -0.002952114229075634
Bond Position:  [1.05997947]


portfolio before change:  [0.77005781]
curr_Stock_Price:  98.25302998287528
curr_Factors:  [98.25302998 -0.19309448 -0.94130471]
mat_Sqrt:  [[31.59967705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00084159 -0.01235141  0.23851909]
Stock Position:  0.0008415940590034911
Bond Position:  [0.68736865]


portfolio before change:  [0.77168378]
curr_Stock_Price:  100.08294452619259
curr_Factors:  [100.08294453  -0.26781023  -0.94868698]
mat_Sqrt:  [[29.65118453  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258158  0.00098356  0.08847471]
Stock Position:  -0.0025815844572759476
Bond Position:  [1.03005636]


portfolio before change:  [0.76972199]
curr_Stock_Price:  100.89273966602849
curr_Factors:  [100.89273967  -0.37882777  -0.94618293]
mat_Sqrt:  [[26.81730203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034978 -0.01151957 -0.01700543]
Stock Position:  -0.00034978452160178673
Bond Position:  [0.80501271]


portfolio before change:  [0.76979872]
curr_Stock_Price:  100.96107656355795
curr_Factors:  [100.96107656  -0.4413171   -0.94573524]
mat_Sqrt:  [[25.22114476  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00072771  0.00076515 -0.17684409]
Stock Position:  0.0007277050935915266
Bond Position:  [0.69632883]


portfolio before change:  [0.76958332]
curr_Stock_Price:  100.5454525796983
curr_Factors:  [100.54545258  -0.44669253  -0.9801909 ]
mat_Sqrt:  [[24.13653019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00212826  0.00671169 -0.20291155]
Stock Position:  -0.00212826449245562
Bond Position:  [0.98357064]


portfolio before change:  [0.7692479]
curr_Stock_Price:  100.76082805803269
curr_Factors:  [100.76082806  -0.34853807  -0.9597845 ]
mat_Sqrt:  [[27.23293534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0001256  -0.02118025  0.03186486]
Stock Position:  0.0001255979552782726
Bond Position:  [0.75659254]


portfolio before change:  [0.76942217]
curr_Stock_Price:  101.39534079230802
curr_Factors:  [101.39534079  -0.58383535  -0.97880472]
mat_Sqrt:  [[21.25064123  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066049  0.0188224   0.10815019]
Stock Position:  -0.000660486265141427
Bond Position:  [0.8363924]


portfolio before change:  [0.76929876]
curr_Stock_Price:  101.74049173098778
curr_Factors:  [101.74049173  -0.71291487  -0.99235825]
mat_Sqrt:  [[18.48856174  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00664074 0.00986809 0.5202486 ]
Stock Position:  0.006640736973626408
Bond Position:  [0.09366691]


portfolio before change:  [0.77133803]
curr_Stock_Price:  102.04581313570789
curr_Factors:  [102.04581314  -0.86385724  -0.9890286 ]
mat_Sqrt:  [[15.99915689  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00376546 -0.01422334  0.02319013]
Stock Position:  0.0037654569936239426
Bond Position:  [0.38708891]


portfolio before change:  [0.77326684]
curr_Stock_Price:  102.54520096962707
curr_Factors:  [102.54520097  -0.74503809  -1.00559736]
mat_Sqrt:  [[17.8083639   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00357876  0.00324892  0.10980544]
Stock Position:  -0.0035787606154162664
Bond Position:  [1.14025157]


portfolio before change:  [0.77263424]
curr_Stock_Price:  102.7617955149603
curr_Factors:  [102.76179551  -0.4027008   -0.9883972 ]
mat_Sqrt:  [[25.56733701  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00670571 -0.00108782  0.29308795]
Stock Position:  0.0067057117480607735
Bond Position:  [0.08354326]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.78140132]
Stock Price:  104.0676431030462
PL:  [-3.28624178]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.78318654e-01 -8.86174175e-02  2.18851155e-02]
 [-1.41098762e-01  6.82706894e-02 -1.54810706e-01]
 [ 7.01279410e-03  3.61962762e-03  5.14455350e-02]
 [ 5.72612492e-02  1.53937933e-03  1.00713593e-01]
 [ 2.56448919e-02  6.20228945e-02 -6.71480454e-02]
 [-1.29432333e-01 -1.71022729e-01  5.70428889e-02]
 [-5.39387428e-02 -1.49432673e-01 -6.22221479e-03]
 [ 1.65835110e-02  6.79139597e-01  9.84509038e-02]
 [ 2.45694445e-01 -2.24039207e-02  2.50382786e-01]
 [ 3.45137971e-01  1.29350101e-01  2.00857983e-01]
 [-2.28299143e-01 -2.33229388e-01  3.00026368e-02]
 [-7.82481100e-02 -1.94183397e-02  8.73124491e-02]
 [ 7.36032780e-03 -5.74838545e-02  1.26505672e-01]
 [ 8.20604831e-03 -2.28717895e-03 -1.73329517e-01]
 [ 1.38885986e-01 -7.82294550e-02 -1.14201374e-01]
 [-2.23922559e-01 -9.68053965e-02  1.21179978e-01]
 [ 6.73087158e-02  4.59329717e-02 -1.53238381e-01]
 [-3.11042028e-02 -5.84507704e-02 -1.41662844e-02]
 [ 1.75712542e-02  9.12313857e-02 -2.07485993e-01]
 [-6.43142392e-02  2.55900827e-02 -5.78336754e-02]
 [-4.82142448e-02  5.33818557e-01 -4.65081542e-01]
 [ 7.05607284e-01  3.47193578e-01  3.69698671e-02]
 [ 8.32947196e-03 -5.63229213e-02  8.39096763e-02]
 [-5.05612900e-02 -3.20998656e-02 -1.75358015e-02]
 [-1.46668046e-02  2.08310253e-02 -7.69190874e-03]
 [-8.01564906e-02 -1.50217644e-02  2.10422122e-01]
 [ 8.04972566e-02 -2.21540262e-02  9.25656081e-02]
 [ 9.81515185e-02 -5.87256018e-02 -4.75055443e-02]
 [-2.98231861e-02 -4.14712172e-02  4.20653859e-02]
 [-7.94979895e-02  5.15137521e-03  2.66668063e-02]
 [ 5.07409831e-02  2.59776601e-03  5.27719325e-02]
 [ 7.41579092e-03  1.44769116e-01 -1.23522310e-01]
 [-3.09730090e-02  4.13714818e-02 -9.22753776e-02]
 [ 4.08828408e-02 -3.20480556e-02  1.79573727e-01]
 [-6.46407262e-02  4.77756994e-02 -2.70806668e-02]
 [ 5.58778237e-02 -3.08395241e-02  9.96648420e-02]
 [-5.98657121e-02  9.78194851e-02  3.04719784e-02]
 [-2.67033307e-02 -3.16162395e-02  1.24886819e-02]
 [ 9.66018640e-02  4.51863959e-03  7.38206603e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.30758262]
curr_Stock_Price:  100.74558074571188
curr_Factors:  [100.74558075  -1.19391012  -1.02301605]
mat_Sqrt:  [[10.97557299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01748796 -0.02860115  0.06243214]
Stock Position:  -0.017487955164239663
Bond Position:  [10.06941682]


portfolio before change:  [8.31447406]
curr_Stock_Price:  100.42349115254089
curr_Factors:  [100.42349115  -1.10519897  -1.01045785]
mat_Sqrt:  [[12.10646169  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01311396  0.02203427 -0.44163185]
Stock Position:  -0.013113961237012719
Bond Position:  [9.63142384]


portfolio before change:  [8.3089801]
curr_Stock_Price:  100.93424201973434
curr_Factors:  [100.93424202  -1.20692476  -1.01105797]
mat_Sqrt:  [[10.98451446  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0016617  0.00116823 0.14675979]
Stock Position:  0.001661695965702367
Bond Position:  [8.14125808]


portfolio before change:  [8.30919398]
curr_Stock_Price:  100.45049570668004
curr_Factors:  [100.45049571  -1.07246485  -0.985764  ]
mat_Sqrt:  [[12.82551029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00609204 0.00049683 0.28730785]
Stock Position:  0.006092042190226755
Bond Position:  [7.69724532]


portfolio before change:  [8.30553364]
curr_Stock_Price:  99.69170917631624
curr_Factors:  [99.69170918 -1.10243636 -1.00984802]
mat_Sqrt:  [[12.05884162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00203989  0.0200178  -0.19155468]
Stock Position:  0.0020398911984230044
Bond Position:  [8.1021734]


portfolio before change:  [8.30883457]
curr_Stock_Price:  100.81338609150616
curr_Factors:  [100.81338609  -1.06345399  -1.00987386]
mat_Sqrt:  [[12.67895193  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01204345 -0.05519735  0.16272748]
Stock Position:  -0.012043453733623144
Bond Position:  [9.52297592]


portfolio before change:  [8.31160624]
curr_Stock_Price:  100.68209274744171
curr_Factors:  [100.68209275  -1.22489804  -0.98296784]
mat_Sqrt:  [[11.06848709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00774376 -0.04822919 -0.01775025]
Stock Position:  -0.007743756032745061
Bond Position:  [9.09126381]


portfolio before change:  [8.31649409]
curr_Stock_Price:  100.19765514980449
curr_Factors:  [100.19765515  -1.24995528  -0.97976423]
mat_Sqrt:  [[10.77711905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01626673 0.21919136 0.28085303]
Stock Position:  0.016266731994134708
Bond Position:  [6.68660569]


portfolio before change:  [8.31664541]
curr_Stock_Price:  100.1555720038396
curr_Factors:  [100.155572    -0.84804448  -0.97368942]
mat_Sqrt:  [[16.19966884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01803928 -0.00723083  0.71427239]
Stock Position:  0.01803928455515493
Bond Position:  [6.50991055]


portfolio before change:  [8.30951749]
curr_Stock_Price:  99.71532661894642
curr_Factors:  [99.71532662 -1.10500192 -1.00584558]
mat_Sqrt:  [[12.07904209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03415349 0.04174757 0.57299192]
Stock Position:  0.034153487600183025
Bond Position:  [4.90389132]


portfolio before change:  [8.30359442]
curr_Stock_Price:  99.52395249536951
curr_Factors:  [99.5239525  -0.70468162 -0.97036666]
mat_Sqrt:  [[18.64075035  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01447273 -0.07527446  0.08558917]
Stock Position:  -0.014472734438898436
Bond Position:  [9.74397816]


portfolio before change:  [8.29735523]
curr_Stock_Price:  100.03921554311466
curr_Factors:  [100.03921554  -0.52724318  -0.99243138]
mat_Sqrt:  [[21.88688736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00294191 -0.00626724  0.24907811]
Stock Position:  -0.0029419113809708657
Bond Position:  [8.59166174]


portfolio before change:  [8.29335987]
curr_Stock_Price:  101.76237500807295
curr_Factors:  [101.76237501  -0.46193447  -0.99870976]
mat_Sqrt:  [[23.61769477  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090819 -0.01855283  0.36088547]
Stock Position:  0.0009081897101660398
Bond Position:  [8.20094033]


portfolio before change:  [8.2941422]
curr_Stock_Price:  101.49496668384367
curr_Factors:  [101.49496668  -0.58779888  -0.94737273]
mat_Sqrt:  [[21.86391579  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126425 -0.00073818 -0.49446087]
Stock Position:  -0.0012642547586886542
Bond Position:  [8.42245769]


portfolio before change:  [8.29600032]
curr_Stock_Price:  100.85802993777845
curr_Factors:  [100.85802994  -0.40919975  -0.9405295 ]
mat_Sqrt:  [[26.15354191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00380852 -0.02524845 -0.32578473]
Stock Position:  0.0038085169579744225
Bond Position:  [7.9118808]


portfolio before change:  [8.30225102]
curr_Stock_Price:  102.23957878345539
curr_Factors:  [102.23957878  -0.23037058  -0.9560712 ]
mat_Sqrt:  [[31.21432413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00701432 -0.03124381  0.34569275]
Stock Position:  -0.007014315527187333
Bond Position:  [9.01939168]


portfolio before change:  [8.3330239]
curr_Stock_Price:  98.01316752148776
curr_Factors:  [ 9.80131675e+01 -5.18009337e-02 -9.30178799e-01]
mat_Sqrt:  [[36.71267634  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00123677  0.0148248  -0.43714645]
Stock Position:  0.0012367687489203347
Bond Position:  [8.21180427]


portfolio before change:  [8.33477343]
curr_Stock_Price:  98.59775046192686
curr_Factors:  [98.59775046  0.12681497 -0.92911935]
mat_Sqrt:  [[44.2008521   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103905 -0.01886491 -0.04041247]
Stock Position:  -0.001039054562099452
Bond Position:  [8.43722187]


portfolio before change:  [8.33807915]
curr_Stock_Price:  96.43135883974483
curr_Factors:  [ 9.64313588e+01  5.69313461e-02 -9.29364388e-01]
mat_Sqrt:  [[40.30189162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.52824543e-04  2.94448031e-02 -5.91899785e-01]
Stock Position:  -0.00015282454329649847
Bond Position:  [8.35281623]


portfolio before change:  [8.33889752]
curr_Stock_Price:  97.90883458243577
curr_Factors:  [97.90883458 -0.10782944 -0.95366697]
mat_Sqrt:  [[33.8703626   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209316  0.00825916 -0.16498338]
Stock Position:  -0.00209315547846571
Bond Position:  [8.54383593]


portfolio before change:  [8.34996088]
curr_Stock_Price:  93.13359503255872
curr_Factors:  [ 9.31335950e+01  8.92065435e-02 -9.33319795e-01]
mat_Sqrt:  [[40.04171223  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.53693770e-04  1.72289198e-01 -1.32674818e+00]
Stock Position:  -0.0008536937697604865
Bond Position:  [8.42946845]


portfolio before change:  [8.35054861]
curr_Stock_Price:  93.67948487474179
curr_Factors:  [93.67948487  0.13080888 -0.9328589 ]
mat_Sqrt:  [[42.00670322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01866427 0.11205625 0.10546474]
Stock Position:  0.01866426686987829
Bond Position:  [6.60208971]


portfolio before change:  [8.38010594]
curr_Stock_Price:  95.21889814586096
curr_Factors:  [ 9.52188981e+01 -1.59646258e-02 -8.90771150e-01]
mat_Sqrt:  [[38.45322841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00036305 -0.01817814  0.23937095]
Stock Position:  0.0003630539052406669
Bond Position:  [8.34553635]


portfolio before change:  [8.38227988]
curr_Stock_Price:  98.33324922209381
curr_Factors:  [ 9.83332492e+01 -3.40973827e-02 -8.73769654e-01]
mat_Sqrt:  [[39.66603086  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0015301  -0.01036019 -0.05002476]
Stock Position:  -0.0015301033858150048
Bond Position:  [8.53273992]


portfolio before change:  [8.38342713]
curr_Stock_Price:  98.28057867577978
curr_Factors:  [ 9.82805787e+01 -2.27104626e-02 -8.62981523e-01]
mat_Sqrt:  [[40.53372932  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00029567  0.00672318 -0.02194287]
Stock Position:  -0.00029567458760292037
Bond Position:  [8.4124862]


portfolio before change:  [8.38375471]
curr_Stock_Price:  100.729368970491
curr_Factors:  [ 1.00729369e+02 -4.73008683e-02 -8.80296830e-01]
mat_Sqrt:  [[39.83873609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101084 -0.00484825  0.60027574]
Stock Position:  -0.0010108392873907502
Bond Position:  [8.48557591]


portfolio before change:  [8.38039515]
curr_Stock_Price:  105.10228929166499
curr_Factors:  [105.10228929  -0.11868967  -0.84310945]
mat_Sqrt:  [[40.17058239  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00236168 -0.00715018  0.26406391]
Stock Position:  0.002361677500214397
Bond Position:  [8.13217744]


portfolio before change:  [8.37178433]
curr_Stock_Price:  101.02577774101567
curr_Factors:  [ 1.01025778e+02  1.64171772e-02 -8.37127771e-01]
mat_Sqrt:  [[44.46334384  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00171978 -0.01895361 -0.13552009]
Stock Position:  0.0017197801594169577
Bond Position:  [8.19804221]


portfolio before change:  [8.37332744]
curr_Stock_Price:  101.32714558140604
curr_Factors:  [101.32714558   0.13112116  -0.85667775]
mat_Sqrt:  [[49.04791872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060557 -0.01338478  0.12000084]
Stock Position:  -0.0006055690569107945
Bond Position:  [8.43468802]


portfolio before change:  [8.3752422]
curr_Stock_Price:  99.90639982181901
curr_Factors:  [ 9.99063998e+01 -9.02792619e-02 -8.57415619e-01]
mat_Sqrt:  [[38.72707101  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188507  0.0016626   0.07607298]
Stock Position:  -0.0018850671760199328
Bond Position:  [8.56357248]


portfolio before change:  [8.37852062]
curr_Stock_Price:  98.7351413800123
curr_Factors:  [ 9.87351414e+01 -7.57590691e-02 -8.64486487e-01]
mat_Sqrt:  [[38.55922494  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00160904 0.00083843 0.15054363]
Stock Position:  0.0016090384475000413
Bond Position:  [8.21965198]


portfolio before change:  [8.3742095]
curr_Stock_Price:  95.41723603985469
curr_Factors:  [ 9.54172360e+01 -4.49811394e-03 -8.32862870e-01]
mat_Sqrt:  [[41.30147647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.84560700e-04  4.67240314e-02 -3.52374769e-01]
Stock Position:  0.00028456070036995794
Bond Position:  [8.3470575]


portfolio before change:  [8.37566957]
curr_Stock_Price:  96.88134019710476
curr_Factors:  [ 9.68813402e+01 -9.57865199e-02 -8.14851660e-01]
mat_Sqrt:  [[38.97220708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106136  0.01335259 -0.26323597]
Stock Position:  -0.0010613646580758661
Bond Position:  [8.478496]


portfolio before change:  [8.3767337]
curr_Stock_Price:  96.8773339356797
curr_Factors:  [96.87733394 -0.13688921 -0.8243183 ]
mat_Sqrt:  [[37.04887804  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00191629 -0.01034347  0.51227386]
Stock Position:  0.0019162899433077484
Bond Position:  [8.19108864]


portfolio before change:  [8.37720034]
curr_Stock_Price:  96.58650400951396
curr_Factors:  [96.58650401 -0.26859036 -0.83998422]
mat_Sqrt:  [[31.87635262  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189534  0.01541954 -0.0772536 ]
Stock Position:  -0.0018953351125110985
Bond Position:  [8.56026413]


portfolio before change:  [8.37401445]
curr_Stock_Price:  98.83201296757495
curr_Factors:  [98.83201297 -0.33323496 -0.83864468]
mat_Sqrt:  [[30.61658723  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00228395 -0.00995341  0.28431605]
Stock Position:  0.0022839492973087826
Bond Position:  [8.14828714]


portfolio before change:  [8.37448535]
curr_Stock_Price:  98.59220853665707
curr_Factors:  [98.59220854 -0.47716418 -0.8230188 ]
mat_Sqrt:  [[26.8645951   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00125363  0.0315711   0.08692807]
Stock Position:  -0.0012536323972660126
Bond Position:  [8.49808373]


portfolio before change:  [8.37452301]
curr_Stock_Price:  99.40956294253499
curr_Factors:  [99.40956294 -0.68371872 -0.83623182]
mat_Sqrt:  [[21.74312839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014077  -0.0102041   0.03562673]
Stock Position:  -0.0014076965628957707
Bond Position:  [8.51446151]


portfolio before change:  [8.37692096]
curr_Stock_Price:  98.46221811776243
curr_Factors:  [98.46221812 -0.85156569 -0.86145057]
mat_Sqrt:  [[17.75481306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00634154 0.00145838 0.2105898 ]
Stock Position:  0.006341537153041107
Bond Position:  [7.75251914]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.37616056]
Stock Price:  98.18948883587571
PL:  [8.37616056]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.12093060e-01 -6.07165399e-02  6.54964585e-03]
 [-2.48614427e-01  8.00891706e-02 -3.61006359e-01]
 [-4.06728481e-02  5.15766106e-02  1.96200867e-02]
 [ 7.87205752e-02  8.67667505e-02  6.26085557e-02]
 [-9.64298979e-02  2.15379642e-01 -3.96616842e-02]
 [-6.51202278e-02 -1.47186655e-01  1.82368653e-01]
 [-6.29690662e-02 -1.61164205e-01  4.51902457e-02]
 [ 7.19246951e-03  7.74190432e-01  1.10840267e-01]
 [ 1.68430253e-01 -1.58588741e-02  1.49652223e-01]
 [ 2.77830520e-01  1.01274403e-01  1.44005503e-01]
 [-9.70132457e-02 -1.33522788e-01  5.79052317e-02]
 [-8.14302060e-02 -1.95284339e-02  8.69179799e-02]
 [-8.64838603e-03  3.11216487e-02  6.82250357e-02]
 [ 7.17248542e-03 -6.79322485e-02  5.84336644e-02]
 [-1.06078139e-01  1.93983815e-01 -3.87267206e-02]
 [-2.11565308e-02 -3.57941823e-02  1.06515558e-02]
 [ 4.45542495e-02  9.19877587e-02 -1.05211363e-01]
 [-2.20547311e-02 -5.65429809e-02 -2.23587250e-02]
 [-6.75935113e-04  1.30483003e-01 -1.40550226e-01]
 [-5.57818688e-02 -1.73665372e-02 -2.39539860e-02]
 [-3.33192376e-02  4.52822007e-01 -4.06107628e-01]
 [ 1.88327310e-01  1.25554622e-01  9.17101533e-02]
 [-7.39150868e-04 -2.12177445e-02  6.23268655e-02]
 [ 2.62432151e-02 -8.94579989e-02 -1.70464594e-01]
 [ 2.25232214e-02  1.95676744e-02 -1.13200506e-02]
 [-6.58268955e-02 -8.78790081e-03  1.77484539e-01]
 [-1.37286443e-02 -3.23161975e-02  2.90207902e-03]
 [-3.92844276e-02  9.02310721e-03 -2.82856418e-01]
 [-6.70944593e-04 -3.84269017e-02  6.88929473e-02]
 [-5.88070486e-02  1.28650431e-02  7.10820319e-03]
 [ 1.52763754e-02 -2.94576939e-02 -5.96823593e-04]
 [ 2.66043136e-02  8.48972833e-02 -5.65942802e-02]
 [-5.91835634e-03  1.30186341e-02  1.11645859e-01]
 [ 1.40358386e-02 -6.63237542e-02  7.30989051e-03]
 [-4.92346310e-02  6.47196545e-02  2.87943814e-03]
 [ 9.08927360e-02 -1.49716159e-02  1.50975263e-01]
 [-5.60834500e-02  7.53581377e-02 -1.87201430e-02]
 [-4.08553354e-02 -2.79017812e-02  1.15576910e-02]
 [ 9.60791986e-02  4.84244401e-03  7.69147357e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.51298543]
curr_Stock_Price:  99.63355016403177
curr_Factors:  [99.63355016 -0.86259456 -1.00888516]
mat_Sqrt:  [[15.33318196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00658939 -0.01959618  0.01868432]
Stock Position:  0.006589388268189879
Bond Position:  [-1.16950958]


portfolio before change:  [-0.51401359]
curr_Stock_Price:  99.499705020795
curr_Factors:  [99.49970502 -1.1307271  -1.02628673]
mat_Sqrt:  [[11.50913251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02658379  0.02584867 -1.02985066]
Stock Position:  -0.026583794055131175
Bond Position:  [2.13106608]


portfolio before change:  [-0.51290615]
curr_Stock_Price:  99.46806785373192
curr_Factors:  [99.46806785 -1.16838637 -1.04781648]
mat_Sqrt:  [[10.84423735  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00241049  0.01664628  0.05597065]
Stock Position:  -0.002410486069945235
Bond Position:  [-0.27313976]


portfolio before change:  [-0.51248883]
curr_Stock_Price:  99.28077273644269
curr_Factors:  [99.28077274 -0.92689833 -1.07889606]
mat_Sqrt:  [[13.35856207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00817541 0.02800385 0.17860478]
Stock Position:  0.008175407001431484
Bond Position:  [-1.32414955]


portfolio before change:  [-0.51847481]
curr_Stock_Price:  98.56882574508757
curr_Factors:  [98.56882575 -0.97491618 -1.03376464]
mat_Sqrt:  [[13.22454039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00457949  0.06951348 -0.11314375]
Stock Position:  -0.0045794876896304345
Bond Position:  [-0.06708009]


portfolio before change:  [-0.51910905]
curr_Stock_Price:  98.70549059405222
curr_Factors:  [98.70549059 -1.16087547 -1.08275932]
mat_Sqrt:  [[10.46991375  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00553383 -0.04750429  0.52024701]
Stock Position:  -0.005533830933804962
Bond Position:  [0.02711045]


portfolio before change:  [-0.51933699]
curr_Stock_Price:  98.74729351451333
curr_Factors:  [98.74729351 -1.16219205 -1.07669473]
mat_Sqrt:  [[10.5241984   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00823266 -0.05201552  0.12891519]
Stock Position:  -0.008232660405997563
Bond Position:  [0.29361594]


portfolio before change:  [-0.51940443]
curr_Stock_Price:  98.75994312746701
curr_Factors:  [98.75994313 -1.11284197 -1.08769262]
mat_Sqrt:  [[10.9370652   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01717541 0.24986889 0.31619643]
Stock Position:  0.017175412333202036
Bond Position:  [-2.21564717]


portfolio before change:  [-0.51819666]
curr_Stock_Price:  98.84638892818018
curr_Factors:  [98.84638893 -0.89888056 -1.10754455]
mat_Sqrt:  [[13.29172825  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01472651 -0.00511843  0.42691614]
Stock Position:  0.01472650522206905
Bond Position:  [-1.97385852]


portfolio before change:  [-0.52121906]
curr_Stock_Price:  98.65790869653574
curr_Factors:  [98.6579087  -0.90319389 -1.1051194 ]
mat_Sqrt:  [[13.24135795  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02476318 0.03268617 0.41080762]
Stock Position:  0.024763175532696476
Bond Position:  [-2.96430217]


portfolio before change:  [-0.52390319]
curr_Stock_Price:  98.56448116138385
curr_Factors:  [98.56448116 -0.829727   -1.09776246]
mat_Sqrt:  [[14.34241883  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00784028 -0.04309429  0.16518751]
Stock Position:  -0.007840282456190444
Bond Position:  [0.24887019]


portfolio before change:  [-0.51321255]
curr_Stock_Price:  97.20489685356573
curr_Factors:  [97.20489685 -0.5594154  -1.10478354]
mat_Sqrt:  [[18.40499595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367696 -0.00630277  0.2479528 ]
Stock Position:  -0.003676956665097449
Bond Position:  [-0.15579436]


portfolio before change:  [-0.51478642]
curr_Stock_Price:  97.62763659533962
curr_Factors:  [97.6276366  -0.82385546 -1.10883118]
mat_Sqrt:  [[14.13245579  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00082298 0.01004447 0.19462704]
Stock Position:  0.0008229759341120643
Bond Position:  [-0.59513162]


portfolio before change:  [-0.51591508]
curr_Stock_Price:  96.34659642171303
curr_Factors:  [96.34659642 -0.68294136 -1.06335023]
mat_Sqrt:  [[16.8047315   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00031144 -0.02192504  0.16669498]
Stock Position:  0.0003114358039277047
Bond Position:  [-0.54592086]


portfolio before change:  [-0.51616421]
curr_Stock_Price:  95.76580369510143
curr_Factors:  [95.7658037  -0.84147015 -1.07902507]
mat_Sqrt:  [[14.0329825   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00530083  0.06260801 -0.11047655]
Stock Position:  -0.005300827348530445
Bond Position:  [-0.00852622]


portfolio before change:  [-0.516508]
curr_Stock_Price:  95.83045858157777
curr_Factors:  [95.83045858 -0.78699501 -1.05529559]
mat_Sqrt:  [[15.18472478  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00173126 -0.01155252  0.03038592]
Stock Position:  -0.0017312627210331248
Bond Position:  [-0.3506003]


portfolio before change:  [-0.51742097]
curr_Stock_Price:  96.33249095645051
curr_Factors:  [96.33249096 -0.75044333 -1.05918317]
mat_Sqrt:  [[15.77109995  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0026539   0.02968892 -0.30013873]
Stock Position:  0.0026539044621559033
Bond Position:  [-0.7730782]


portfolio before change:  [-0.51554032]
curr_Stock_Price:  97.07754323147566
curr_Factors:  [97.07754323 -0.70757876 -1.07186518]
mat_Sqrt:  [[16.38008278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00232969 -0.01824917 -0.06378322]
Stock Position:  -0.0023296875171955663
Bond Position:  [-0.28937998]


portfolio before change:  [-0.51396321]
curr_Stock_Price:  96.3850561888304
curr_Factors:  [96.38505619 -0.81902104 -1.06457936]
mat_Sqrt:  [[14.65454858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.86351601e-04  4.21132080e-02 -4.00950674e-01]
Stock Position:  -0.0001863516009787991
Bond Position:  [-0.4960017]


portfolio before change:  [-0.51405994]
curr_Stock_Price:  96.57138684369075
curr_Factors:  [96.57138684 -0.93008152 -1.07645678]
mat_Sqrt:  [[12.98434238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00494568 -0.00560503 -0.06833405]
Stock Position:  -0.0049456786779701395
Bond Position:  [-0.03644889]


portfolio before change:  [-0.52091172]
curr_Stock_Price:  97.9558734539887
curr_Factors:  [97.95587345 -0.79004657 -1.09136702]
mat_Sqrt:  [[14.92598285  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00159344  0.14614767 -1.15851202]
Stock Position:  -0.0015934431404714773
Bond Position:  [-0.36482461]


portfolio before change:  [-0.52152345]
curr_Stock_Price:  98.31115365139026
curr_Factors:  [98.31115365 -0.87710475 -1.09982141]
mat_Sqrt:  [[13.61553382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01708903 0.04052258 0.26162354]
Stock Position:  0.017089032260503637
Bond Position:  [-2.20156592]


portfolio before change:  [-0.51112279]
curr_Stock_Price:  98.9358745585419
curr_Factors:  [98.93587456 -0.92306121 -1.11188583]
mat_Sqrt:  [[12.92967249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00059183 -0.006848    0.1778012 ]
Stock Position:  0.0005918334986719347
Bond Position:  [-0.56967635]


portfolio before change:  [-0.51063936]
curr_Stock_Price:  99.8730285802273
curr_Factors:  [99.87302858 -1.07703957 -1.09082622]
mat_Sqrt:  [[11.42762732  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00234635 -0.02887245 -0.48628804]
Stock Position:  -0.0023463542512554146
Bond Position:  [-0.27630186]


portfolio before change:  [-0.50908948]
curr_Stock_Price:  99.19775766807892
curr_Factors:  [99.19775767 -0.72765433 -1.09310322]
mat_Sqrt:  [[16.06042003  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00150723  0.00631544 -0.03229295]
Stock Position:  0.001507230851372204
Bond Position:  [-0.6586034]


portfolio before change:  [-0.50836148]
curr_Stock_Price:  99.7353805669447
curr_Factors:  [99.73538057 -0.784506   -1.0969542 ]
mat_Sqrt:  [[15.1964262   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00206574 -0.00283628  0.50631399]
Stock Position:  -0.00206573822292154
Bond Position:  [-0.3023343]


portfolio before change:  [-0.50814118]
curr_Stock_Price:  99.61043773509881
curr_Factors:  [99.61043774 -0.27966415 -1.12032679]
mat_Sqrt:  [[24.5638542   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00080333 -0.01043001  0.00827882]
Stock Position:  -0.0008033257305982552
Bond Position:  [-0.42812155]


portfolio before change:  [-0.50824677]
curr_Stock_Price:  99.6752639566698
curr_Factors:  [99.67526396 -0.25767137 -1.10382912]
mat_Sqrt:  [[25.54437292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00372608  0.0029122  -0.80691063]
Stock Position:  -0.003726081607086052
Bond Position:  [-0.13684861]


portfolio before change:  [-0.50526843]
curr_Stock_Price:  98.8713504818276
curr_Factors:  [98.87135048 -0.22606895 -1.11508393]
mat_Sqrt:  [[25.85920501  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00021454 -0.01240223  0.1965324 ]
Stock Position:  0.00021454298083045315
Bond Position:  [-0.52648059]


portfolio before change:  [-0.50527594]
curr_Stock_Price:  99.14312452526083
curr_Factors:  [99.14312453 -0.21399043 -1.13054062]
mat_Sqrt:  [[25.8428369   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0021178   0.00415217  0.02027773]
Stock Position:  -0.0021178025824362557
Bond Position:  [-0.29531038]


portfolio before change:  [-0.50838953]
curr_Stock_Price:  100.59588954746305
curr_Factors:  [100.59588955  -0.34219478  -1.1455947 ]
mat_Sqrt:  [[22.7217342   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040233 -0.00950743 -0.00170257]
Stock Position:  0.00040232504497044776
Bond Position:  [-0.54886177]


portfolio before change:  [-0.50903907]
curr_Stock_Price:  99.1519602283441
curr_Factors:  [99.15196023 -0.53552809 -1.1268738 ]
mat_Sqrt:  [[18.807425    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00172175  0.02740048 -0.16144773]
Stock Position:  0.0017217476564035422
Bond Position:  [-0.67975372]


portfolio before change:  [-0.50552403]
curr_Stock_Price:  101.24286573185927
curr_Factors:  [101.24286573  -0.57384874  -1.16901641]
mat_Sqrt:  [[17.71934695  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00110211 0.00420175 0.31849456]
Stock Position:  0.0011021104147364664
Bond Position:  [-0.61710485]


portfolio before change:  [-0.50615726]
curr_Stock_Price:  100.73829988651225
curr_Factors:  [100.73829989  -0.44670633  -1.17980998]
mat_Sqrt:  [[19.80649181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00010046 -0.0214059   0.02085308]
Stock Position:  0.0001004561609949424
Bond Position:  [-0.51627704]


portfolio before change:  [-0.50624493]
curr_Stock_Price:  100.50801761739567
curr_Factors:  [100.50801762  -0.36297765  -1.17820976]
mat_Sqrt:  [[21.52144939  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164654  0.02088818  0.00821424]
Stock Position:  -0.0016465444958002548
Bond Position:  [-0.34075401]


portfolio before change:  [-0.50641255]
curr_Stock_Price:  100.58394432844395
curr_Factors:  [100.58394433  -0.40719843  -1.20203652]
mat_Sqrt:  [[20.1208723   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00589708 -0.00483207  0.4306904 ]
Stock Position:  0.005897078531669548
Bond Position:  [-1.09956397]


portfolio before change:  [-0.51177756]
curr_Stock_Price:  99.69747784637887
curr_Factors:  [99.69747785 -0.41212283 -1.22762967]
mat_Sqrt:  [[19.34410798  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00230159  0.02432173 -0.05340336]
Stock Position:  -0.0023015932194076385
Bond Position:  [-0.28231452]


portfolio before change:  [-0.51160028]
curr_Stock_Price:  99.60511833859553
curr_Factors:  [99.60511834 -0.6612934  -1.208918  ]
mat_Sqrt:  [[15.34826062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00287926 -0.00900526  0.03297088]
Stock Position:  -0.002879255173572084
Bond Position:  [-0.22481173]


portfolio before change:  [-0.51035073]
curr_Stock_Price:  99.16137293269702
curr_Factors:  [99.16137293 -0.74822376 -1.20965291]
mat_Sqrt:  [[13.99740396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00805634 0.00156289 0.21941633]
Stock Position:  0.008056337688071147
Bond Position:  [-1.30922823]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.51927159]
Stock Price:  98.0743780612314
PL:  [-0.51927159]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-4.40170824e-02 -8.30227797e-02  1.30117690e-02]
 [-2.39055749e-01  8.73056236e-02 -3.62664595e-01]
 [-1.00872463e-02  2.17178037e-02  3.93574331e-02]
 [ 1.03521149e-01  1.62994030e-02  1.36572569e-01]
 [ 1.02591895e-01 -6.65402612e-02 -8.72452467e-02]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.28361671e-02 -1.47919468e-01 -2.69050464e-02]
 [ 1.26512724e-02  6.01313603e-01  8.42220265e-02]
 [ 2.39231588e-01 -1.12260584e-02  2.63304324e-01]
 [ 5.05071541e-01  2.24663442e-01  4.28250879e-01]
 [-1.46317597e-01 -1.90860222e-01  2.71077313e-02]
 [-7.79719531e-03 -1.58255320e-02  1.02419399e-01]
 [ 1.17310384e-02 -3.19014100e-02 -3.67912490e-02]
 [ 1.07106298e-03  8.10203089e-02  4.31073732e-02]
 [ 2.09986600e-01 -1.96499117e-01 -1.35488300e-01]
 [-1.39730052e-01 -7.18757427e-02  1.01610915e-01]
 [ 4.93133244e-02  2.07788407e-02 -1.53412371e-02]
 [-4.49570079e-02 -5.36718107e-02  4.54790132e-02]
 [ 1.32334339e-01 -1.56107524e-01 -9.00152415e-03]
 [ 5.44044539e-02 -8.41189531e-03  2.64954724e-01]
 [-1.80216685e-02  3.54960433e-01 -3.37010384e-01]
 [ 2.27000599e-01  1.44059660e-01  8.54124808e-02]
 [ 2.36294012e-02  1.73219835e-01 -5.50984683e-02]
 [ 8.36400770e-02 -1.78959007e-01 -2.64652854e-01]
 [ 4.62316950e-02  3.38825587e-03 -1.28623566e-02]
 [-9.48146323e-03  1.69379380e-02  2.67565618e-02]
 [ 8.82380527e-02 -2.49199354e-02  6.27502600e-02]
 [ 1.60175270e-01 -5.92407300e-02  1.71291196e-01]
 [-4.33985208e-02 -7.60067743e-03 -4.65198760e-02]
 [-6.10893326e-02 -1.38003884e-02  3.97124877e-02]
 [-2.71475480e-02 -4.35618518e-02 -1.17640896e-02]
 [ 2.63389769e-02 -4.83624168e-02 -1.08169383e-01]
 [ 4.27969068e-02  1.79905455e-03  1.48175720e-01]
 [-2.43092664e-03 -9.60232809e-02 -1.91466105e-01]
 [ 2.72131944e-02  1.31125275e-01 -2.90662717e-02]
 [ 1.13628401e-02  2.83466930e-02  1.00395964e-01]
 [ 4.25294601e-01 -2.55379563e-01  2.71515004e-01]
 [-1.05282481e-01  4.60265460e-02  4.63720775e-02]
 [ 3.60313435e-01 -4.61700079e-02  4.30462022e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.64424347]
curr_Stock_Price:  100.03158973107314
curr_Factors:  [100.03158973  -0.93217723  -1.0116077 ]
mat_Sqrt:  [[14.32062925  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00407161 -0.02679549  0.03711896]
Stock Position:  -0.004071610194628435
Bond Position:  [3.05153311]


portfolio before change:  [2.64643516]
curr_Stock_Price:  99.58699110929577
curr_Factors:  [99.58699111 -1.14700457 -1.01459225]
mat_Sqrt:  [[11.46655704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02574994  0.02817777 -1.03458114]
Stock Position:  -0.025749940663177276
Bond Position:  [5.21079428]


portfolio before change:  [2.62571552]
curr_Stock_Price:  100.4169360482906
curr_Factors:  [100.41693605  -1.06181177  -1.03060861]
mat_Sqrt:  [[12.39025768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00019206 0.00700939 0.1122758 ]
Stock Position:  0.000192060912352635
Bond Position:  [2.60642935]


portfolio before change:  [2.62597588]
curr_Stock_Price:  100.07608116592874
curr_Factors:  [100.07608117  -1.19223566  -1.03150422]
mat_Sqrt:  [[10.82860043  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01244168 0.00526061 0.38960352]
Stock Position:  0.012441682560862498
Bond Position:  [1.38086105]


portfolio before change:  [2.63157891]
curr_Stock_Price:  100.51255014737654
curr_Factors:  [100.51255015  -1.1968132   -1.02231431]
mat_Sqrt:  [[10.92610731  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00651655 -0.02147578 -0.2488864 ]
Stock Position:  0.006516553197781799
Bond Position:  [1.97658353]


portfolio before change:  [2.63714899]
curr_Stock_Price:  101.32939273256054
curr_Factors:  [101.32939273  -1.12306467  -1.02105574]
mat_Sqrt:  [[11.87287173  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01291214 -0.05534923  0.15513819]
Stock Position:  -0.012912141191519847
Bond Position:  [3.94552842]


portfolio before change:  [2.64456377]
curr_Stock_Price:  100.79334255308913
curr_Factors:  [100.79334255  -1.29867141  -1.03486136]
mat_Sqrt:  [[ 9.77217968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00905858 -0.0477408  -0.07675261]
Stock Position:  -0.009058580021916405
Bond Position:  [3.55760833]


portfolio before change:  [2.63913452]
curr_Stock_Price:  101.44178605055771
curr_Factors:  [101.44178605  -1.14480522  -1.03949737]
mat_Sqrt:  [[11.41790232  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01336372 0.19407313 0.240262  ]
Stock Position:  0.013363719757604954
Bond Position:  [1.28349492]


portfolio before change:  [2.65121005]
curr_Stock_Price:  102.33338486894081
curr_Factors:  [102.33338487  -1.56775564  -1.03738872]
mat_Sqrt:  [[ 7.56166656  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03844217 -0.00362319  0.75113395]
Stock Position:  0.03844216694253069
Bond Position:  [-1.28270702]


portfolio before change:  [2.66016863]
curr_Stock_Price:  102.57059668015557
curr_Factors:  [102.57059668  -1.63018852  -1.03211838]
mat_Sqrt:  [[ 7.15809878  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08917831 0.07250981 1.22168055]
Stock Position:  0.08917830535892222
Bond Position:  [-6.48690336]


portfolio before change:  [2.63624607]
curr_Stock_Price:  102.31143443216251
curr_Factors:  [102.31143443  -1.43520049  -1.01269293]
mat_Sqrt:  [[ 8.84743884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02031587 -0.06159987  0.07733081]
Stock Position:  -0.02031587189025361
Bond Position:  [4.71479206]


portfolio before change:  [2.63482221]
curr_Stock_Price:  102.41053150019172
curr_Factors:  [102.4105315   -1.63292154  -1.02026883]
mat_Sqrt:  [[ 7.21238137  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00136969 -0.00510767  0.29217404]
Stock Position:  0.0013696868302144054
Bond Position:  [2.49455186]


portfolio before change:  [2.63508938]
curr_Stock_Price:  102.37792046221028
curr_Factors:  [102.37792046  -1.66790501  -1.02363526]
mat_Sqrt:  [[ 6.93881354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033014 -0.01029614 -0.10495519]
Stock Position:  -0.00033014172319562453
Bond Position:  [2.66888861]


portfolio before change:  [2.6354387]
curr_Stock_Price:  102.33041517616695
curr_Factors:  [102.33041518  -1.66298012  -1.00933549]
mat_Sqrt:  [[ 7.07021816  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00373518 0.02614919 0.12297334]
Stock Position:  0.0037351775281165562
Bond Position:  [2.25321643]


portfolio before change:  [2.63637494]
curr_Stock_Price:  102.50565910192992
curr_Factors:  [102.5056591   -1.677448    -1.00487164]
mat_Sqrt:  [[ 7.01182756  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02028287 -0.06341982 -0.38651041]
Stock Position:  0.020282865002962277
Bond Position:  [0.55726649]


portfolio before change:  [2.63284967]
curr_Stock_Price:  102.32841949074043
curr_Factors:  [102.32841949  -1.51655729  -1.00115599]
mat_Sqrt:  [[ 8.25215322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01619703 -0.0231978   0.28986766]
Stock Position:  -0.016197031460862977
Bond Position:  [4.2902663]


portfolio before change:  [2.61921362]
curr_Stock_Price:  103.20341712227132
curr_Factors:  [103.20341712  -1.45669269  -0.99433005]
mat_Sqrt:  [[ 8.89668938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00566764  0.00670634 -0.04376428]
Stock Position:  0.005667644274333481
Bond Position:  [2.03429337]


portfolio before change:  [2.61919377]
curr_Stock_Price:  103.1550451121694
curr_Factors:  [103.15504511  -1.23106436  -0.99490931]
mat_Sqrt:  [[11.13685058  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00418694 -0.0173225   0.12973897]
Stock Position:  -0.004186942742954776
Bond Position:  [3.05109804]


portfolio before change:  [2.61906473]
curr_Stock_Price:  103.27696128738864
curr_Factors:  [103.27696129  -1.38551867  -0.99542601]
mat_Sqrt:  [[ 9.54931714  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01032865 -0.05038349 -0.02567884]
Stock Position:  0.0103286543127621
Bond Position:  [1.55235269]


portfolio before change:  [2.62240464]
curr_Stock_Price:  103.58153745605709
curr_Factors:  [103.58153746  -1.42450328  -0.97291251]
mat_Sqrt:  [[ 9.42101955  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01133328 -0.00271493  0.75584208]
Stock Position:  0.011333278633351363
Bond Position:  [1.44848622]


portfolio before change:  [2.62840944]
curr_Stock_Price:  104.09539747068523
curr_Factors:  [104.09539747  -1.49609431  -0.94340813]
mat_Sqrt:  [[ 9.07755899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00158166  0.11456299 -0.96139682]
Stock Position:  -0.00158166199550932
Bond Position:  [2.79305317]


portfolio before change:  [2.6293679]
curr_Stock_Price:  103.71016326103765
curr_Factors:  [103.71016326  -1.45606762  -0.9537019 ]
mat_Sqrt:  [[ 9.31690596  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02939188 0.04649506 0.24365803]
Stock Position:  0.029391882304226638
Bond Position:  [-0.41886901]


portfolio before change:  [2.64248626]
curr_Stock_Price:  104.15827063973708
curr_Factors:  [104.15827064  -1.40381028  -0.98404659]
mat_Sqrt:  [[ 9.5644653   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00499148  0.05590646 -0.15718059]
Stock Position:  0.004991478644170632
Bond Position:  [2.12258247]


portfolio before change:  [2.64314564]
curr_Stock_Price:  104.23721308533527
curr_Factors:  [104.23721309  -1.42650019  -0.98477603]
mat_Sqrt:  [[ 9.35015558  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.39219255e-04 -5.77587712e-02 -7.54980928e-01]
Stock Position:  -0.0007392192551863229
Bond Position:  [2.72019979]


portfolio before change:  [2.64377164]
curr_Stock_Price:  103.85037057405522
curr_Factors:  [103.85037057  -1.41234937  -0.9777697 ]
mat_Sqrt:  [[ 9.51464366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00465575  0.00109355 -0.03669272]
Stock Position:  0.00465575000604459
Bond Position:  [2.16027028]


portfolio before change:  [2.64453187]
curr_Stock_Price:  103.95565499393612
curr_Factors:  [103.95565499  -1.47886028  -0.97287735]
mat_Sqrt:  [[ 8.95513209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.27975988e-05  5.46669600e-03  7.63290233e-02]
Stock Position:  -6.2797598847979e-05
Bond Position:  [2.65106004]


portfolio before change:  [2.6448656]
curr_Stock_Price:  103.91869280613292
curr_Factors:  [103.91869281  -1.59716433  -0.97102025]
mat_Sqrt:  [[ 7.96792579  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0120433  -0.00804287  0.17900903]
Stock Position:  0.012043301841002755
Bond Position:  [1.39334141]


portfolio before change:  [2.64471491]
curr_Stock_Price:  103.89171771737325
curr_Factors:  [103.89171772  -1.89779744  -0.94951666]
mat_Sqrt:  [[ 6.02570861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03037775 -0.01911986  0.4886461 ]
Stock Position:  0.030377750924289713
Bond Position:  [-0.51128182]


portfolio before change:  [2.64827168]
curr_Stock_Price:  104.01090663010017
curr_Factors:  [104.01090663  -1.63064877  -0.93513511]
mat_Sqrt:  [[ 7.99416483  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0068107  -0.00245311 -0.13270826]
Stock Position:  -0.006810696752998118
Bond Position:  [3.35665843]


portfolio before change:  [2.6488335]
curr_Stock_Price:  103.99002602127874
curr_Factors:  [103.99002602  -1.46151772  -0.93376111]
mat_Sqrt:  [[ 9.47840598  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00588707 -0.00445406  0.11328867]
Stock Position:  -0.005887070842448288
Bond Position:  [3.26103015]


portfolio before change:  [2.64526641]
curr_Stock_Price:  104.66519109471591
curr_Factors:  [104.66519109  -1.38431817  -0.89381898]
mat_Sqrt:  [[10.72555754  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00358405 -0.01405953 -0.03355967]
Stock Position:  -0.0035840475760839335
Bond Position:  [3.02039144]


portfolio before change:  [2.64483657]
curr_Stock_Price:  104.89047134669826
curr_Factors:  [104.89047135  -1.386162    -0.90418485]
mat_Sqrt:  [[10.61820337  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052862 -0.0156089  -0.30857714]
Stock Position:  -0.0005286151374343542
Bond Position:  [2.70028326]


portfolio before change:  [2.64513436]
curr_Stock_Price:  104.96569406040383
curr_Factors:  [104.96569406  -1.23903996  -0.88943525]
mat_Sqrt:  [[12.4928736   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00587618 0.00058064 0.42270408]
Stock Position:  0.00587618042900959
Bond Position:  [2.02833701]


portfolio before change:  [2.65043444]
curr_Stock_Price:  105.82450307852164
curr_Factors:  [105.82450308  -1.060808    -0.90455715]
mat_Sqrt:  [[14.82651213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00412197 -0.03099138 -0.5461995 ]
Stock Position:  -0.004121970913209882
Bond Position:  [3.08663996]


portfolio before change:  [2.65477246]
curr_Stock_Price:  104.8656964020809
curr_Factors:  [104.8656964   -1.03629639  -0.88785822]
mat_Sqrt:  [[15.31030062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00313814  0.0423205  -0.08291798]
Stock Position:  0.00313814225293521
Bond Position:  [2.32568899]


portfolio before change:  [2.65558326]
curr_Stock_Price:  105.03141973024229
curr_Factors:  [105.03141973  -0.94060466  -0.90987439]
mat_Sqrt:  [[16.50693332  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00228039 0.00914886 0.28640174]
Stock Position:  0.00228039479494109
Bond Position:  [2.41607015]


portfolio before change:  [2.6594626]
curr_Stock_Price:  106.60014697746155
curr_Factors:  [106.60014698  -0.70305611  -0.94183344]
mat_Sqrt:  [[20.57744011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02082806 -0.0824234   0.77455673]
Stock Position:  0.020828063732760672
Bond Position:  [0.43918795]


portfolio before change:  [2.64973085]
curr_Stock_Price:  106.13026881099566
curr_Factors:  [106.13026881  -0.76496845  -0.94492979]
mat_Sqrt:  [[19.19728856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00450177  0.014855    0.13228663]
Stock Position:  -0.004501765469538557
Bond Position:  [3.12750443]


portfolio before change:  [2.64265515]
curr_Stock_Price:  107.78887746358292
curr_Factors:  [107.78887746  -0.96658644  -0.97974181]
mat_Sqrt:  [[15.39197424  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02336775 -0.01490131  0.12279883]
Stock Position:  0.023367748998279116
Bond Position:  [0.12387171]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.64368991]
Stock Price:  107.83249641684958
PL:  [-5.18880651]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.78157166e-01 -5.33369006e-02  4.11756408e-03]
 [-2.27638040e-01  1.03854326e-01 -3.94743388e-01]
 [-2.68693241e-02  5.52690664e-02  3.07483360e-02]
 [ 8.91473900e-02  7.92836700e-02  7.78007391e-02]
 [-1.01466418e-01  2.11582968e-01 -4.07791222e-02]
 [-5.01752118e-02 -1.37298677e-01  2.36034135e-01]
 [-6.52706919e-02 -1.31793162e-01  5.67719035e-03]
 [ 2.77640758e-03  7.38053889e-01  1.14251422e-01]
 [ 3.49186831e-01  2.20790083e-02  3.51053881e-01]
 [ 5.74994875e-01  2.51941117e-01  4.81216073e-01]
 [-1.79568723e-01 -1.74417403e-01  5.56196616e-02]
 [ 1.85815770e-02 -1.41581437e-02  1.09852958e-01]
 [ 1.29757663e-02 -5.84029103e-02  8.38051922e-02]
 [ 2.35679776e-03  7.04452282e-02 -1.71852802e-02]
 [ 1.97666847e-01 -1.65033657e-01 -1.32723413e-01]
 [-1.09188585e-01 -6.32393459e-02  9.45628931e-02]
 [ 4.84488397e-02  2.23303765e-02 -1.02850685e-02]
 [-5.53511120e-02 -6.35624498e-02  7.78431911e-03]
 [ 4.29173290e-02  4.89771368e-02 -2.18185018e-01]
 [-1.09144619e-02  1.54440466e-03 -3.98929088e-02]
 [-3.23786712e-02  4.55685800e-01 -4.17878081e-01]
 [ 3.32305921e-01  1.94447902e-01  6.82642512e-02]
 [-6.60467209e-03 -2.78653824e-03  5.10344387e-02]
 [-1.47564996e-03 -7.70017403e-02 -1.21371114e-01]
 [ 3.53552541e-02  1.65165483e-02 -1.24326858e-02]
 [-5.01923749e-02 -2.43068857e-03  1.52976646e-01]
 [ 2.54993547e-02 -3.32516783e-02  8.16897290e-03]
 [ 1.14440972e-01 -6.60862353e-02 -1.16872298e-02]
 [-4.62838797e-02 -1.96085940e-02 -2.33385143e-02]
 [-6.55806906e-02 -1.43518832e-02  3.70566044e-02]
 [-4.22095448e-02 -5.76602708e-02 -3.37663033e-02]
 [ 2.60962403e-02 -2.02090906e-02 -6.33214272e-02]
 [-1.88344716e-02  5.68714977e-03  1.67311648e-01]
 [ 4.42810009e-03 -8.29054376e-02 -1.00652753e-01]
 [ 3.29450814e-02  1.69209621e-01 -3.05562687e-02]
 [ 8.71574530e-03  2.77983108e-02  9.68087689e-02]
 [ 4.22153040e-01 -2.55058952e-01  2.71330455e-01]
 [-1.13553774e-01  5.11821577e-02  5.15199151e-02]
 [ 2.77823602e-01 -2.92353452e-02  6.73270865e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.83721211]
curr_Stock_Price:  99.46660166854505
curr_Factors:  [99.46660167 -1.06717604 -1.00866592]
mat_Sqrt:  [[12.47816059  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01347236 -0.01721441  0.01174626]
Stock Position:  0.013472363140247374
Bond Position:  [-3.17726229]


portfolio before change:  [-1.83441727]
curr_Stock_Price:  99.70353316920475
curr_Factors:  [99.70353317 -1.20731863 -0.98110682]
mat_Sqrt:  [[11.17607865  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02568124  0.03351884 -1.12609301]
Stock Position:  -0.025681236658046655
Bond Position:  [0.72609276]


portfolio before change:  [-1.81774629]
curr_Stock_Price:  99.05791732754689
curr_Factors:  [99.05791733 -1.22539963 -0.9867482 ]
mat_Sqrt:  [[10.84340295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085869  0.01783801  0.08771644]
Stock Position:  -0.000858687570679437
Bond Position:  [-1.73268649]


portfolio before change:  [-1.81789692]
curr_Stock_Price:  98.98108843850639
curr_Factors:  [98.98108844 -1.09448085 -0.98921075]
mat_Sqrt:  [[12.32016326  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00983851 0.02558869 0.22194385]
Stock Position:  0.00983851498197883
Bond Position:  [-2.79172384]


portfolio before change:  [-1.82230571]
curr_Stock_Price:  98.56844412837296
curr_Factors:  [98.56844413 -0.97578976 -0.97329117]
mat_Sqrt:  [[14.03662858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00474482  0.06828811 -0.11633148]
Stock Position:  -0.004744816672977779
Bond Position:  [-1.35461651]


portfolio before change:  [-1.81977687]
curr_Stock_Price:  97.9997850151587
curr_Factors:  [97.99978502 -0.66352939 -0.9815702 ]
mat_Sqrt:  [[18.91330606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00158729 -0.04431296  0.67333969]
Stock Position:  -0.0015872910183770124
Bond Position:  [-1.66422269]


portfolio before change:  [-1.82034548]
curr_Stock_Price:  98.22694571974183
curr_Factors:  [98.22694572 -0.58616695 -1.00241605]
mat_Sqrt:  [[20.05939403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00453723 -0.04253606  0.01619544]
Stock Position:  -0.004537226133951846
Bond Position:  [-1.37466761]


portfolio before change:  [-1.82879471]
curr_Stock_Price:  100.05127352981214
curr_Factors:  [100.05127353  -0.8352654   -1.04259634]
mat_Sqrt:  [[15.29951381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01155282 0.23820587 0.32592751]
Stock Position:  0.011552818140038827
Bond Position:  [-2.98466888]


portfolio before change:  [-1.8110292]
curr_Stock_Price:  101.62133300672176
curr_Factors:  [101.62133301  -0.93407731  -1.04485804]
mat_Sqrt:  [[14.04572574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0302834  0.00712597 1.00145901]
Stock Position:  0.0302833951485052
Bond Position:  [-4.88846819]


portfolio before change:  [-1.78561249]
curr_Stock_Price:  102.48080766903723
curr_Factors:  [102.48080767  -1.13895847  -1.03098759]
mat_Sqrt:  [[11.70164549  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06192718 0.08131365 1.37277551]
Stock Position:  0.061927184548423934
Bond Position:  [-8.13196038]


portfolio before change:  [-1.87618517]
curr_Stock_Price:  101.03465570035199
curr_Factors:  [101.0346557   -1.23906501  -1.02677056]
mat_Sqrt:  [[10.48166999  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0194452  -0.05629297  0.15866741]
Stock Position:  -0.019445203890926275
Bond Position:  [0.08845431]


portfolio before change:  [-1.8772973]
curr_Stock_Price:  101.09241743233005
curr_Factors:  [101.09241743  -1.23887516  -1.03329887]
mat_Sqrt:  [[10.42139696  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0036574  -0.00456952  0.31337991]
Stock Position:  0.0036573982724329743
Bond Position:  [-2.24703253]


portfolio before change:  [-1.87795597]
curr_Stock_Price:  100.98912802850798
curr_Factors:  [100.98912803  -1.1102937   -1.01011091]
mat_Sqrt:  [[12.11698582  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0014988  -0.01884946  0.23907289]
Stock Position:  0.0014988038776861546
Bond Position:  [-2.02931886]


portfolio before change:  [-1.87687388]
curr_Stock_Price:  101.88034834478928
curr_Factors:  [101.88034834  -1.33204792  -1.01666928]
mat_Sqrt:  [[ 9.72871552  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00135973  0.0227361  -0.04902482]
Stock Position:  0.0013597313134217526
Bond Position:  [-2.01540378]


portfolio before change:  [-1.87702866]
curr_Stock_Price:  101.95181018552697
curr_Factors:  [101.95181019  -1.19690302  -1.00744118]
mat_Sqrt:  [[11.2476144   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01217035 -0.05326438 -0.37862296]
Stock Position:  0.012170353146523509
Bond Position:  [-3.11781819]


portfolio before change:  [-1.88128127]
curr_Stock_Price:  101.6344105097211
curr_Factors:  [101.63441051  -1.02036011  -1.02311472]
mat_Sqrt:  [[13.16954983  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00780548 -0.02041041  0.26976161]
Stock Position:  -0.007805482621274159
Bond Position:  [-1.08797565]


portfolio before change:  [-1.8730155]
curr_Stock_Price:  100.5580166662035
curr_Factors:  [100.55801667  -0.97135622  -1.0167713 ]
mat_Sqrt:  [[13.77158386  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00369657  0.0072071  -0.02934044]
Stock Position:  0.0036965666718049707
Bond Position:  [-2.24473492]


portfolio before change:  [-1.87610271]
curr_Stock_Price:  99.79877281916725
curr_Factors:  [99.79877282 -1.04256886 -1.02226226]
mat_Sqrt:  [[12.65844738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00527211 -0.02051469  0.0222065 ]
Stock Position:  -0.005272113810537228
Bond Position:  [-1.34995222]


portfolio before change:  [-1.87020431]
curr_Stock_Price:  98.64797126714836
curr_Factors:  [98.64797127 -0.83301206 -1.02907827]
mat_Sqrt:  [[15.32472195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.46692788e-04  1.58073029e-02 -6.22421124e-01]
Stock Position:  0.0005466927880553292
Bond Position:  [-1.92413444]


portfolio before change:  [-1.87055397]
curr_Stock_Price:  98.44835813504203
curr_Factors:  [98.44835814 -0.94185428 -1.00390776]
mat_Sqrt:  [[14.06613429  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00133244  0.00049845 -0.11380336]
Stock Position:  -0.0013324426686493356
Bond Position:  [-1.73937717]


portfolio before change:  [-1.87151349]
curr_Stock_Price:  99.00529688520592
curr_Factors:  [99.00529689 -0.88724738 -1.01225259]
mat_Sqrt:  [[14.81549184  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166456  0.14707196 -1.19208985]
Stock Position:  -0.0016645551279050766
Bond Position:  [-1.70671372]


portfolio before change:  [-1.87276101]
curr_Stock_Price:  99.62658644268535
curr_Factors:  [99.62658644 -0.75572963 -1.00593871]
mat_Sqrt:  [[17.11167062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02255372 0.06275779 0.19473891]
Stock Position:  0.022553719236691746
Bond Position:  [-4.11971107]


portfolio before change:  [-1.86618713]
curr_Stock_Price:  99.9408971663569
curr_Factors:  [99.94089717 -0.72793532 -1.00124842]
mat_Sqrt:  [[17.73243149  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00018294 -0.00089935  0.14558705]
Stock Position:  0.00018293539395922593
Bond Position:  [-1.88446986]


portfolio before change:  [-1.8664777]
curr_Stock_Price:  99.64031666621513
curr_Factors:  [99.64031667 -0.76325462 -1.00824997]
mat_Sqrt:  [[16.9465161   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247652 -0.0248522  -0.346238  ]
Stock Position:  -0.0024765172383087817
Bond Position:  [-1.61971673]


portfolio before change:  [-1.86766878]
curr_Stock_Price:  100.03951083361136
curr_Factors:  [100.03951083  -0.81097768  -1.01757157]
mat_Sqrt:  [[16.07099292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00225181  0.00533069 -0.03546699]
Stock Position:  0.00225181289045877
Bond Position:  [-2.09293904]


portfolio before change:  [-1.8656175]
curr_Stock_Price:  101.06664635955424
curr_Factors:  [101.06664636  -0.77718183  -0.99575729]
mat_Sqrt:  [[17.16446139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113387 -0.0007845   0.43639979]
Stock Position:  -0.0011338724596766773
Bond Position:  [-1.75102081]


portfolio before change:  [-1.86578944]
curr_Stock_Price:  101.02523838375056
curr_Factors:  [101.02523838  -0.84130804  -1.02143455]
mat_Sqrt:  [[15.68379132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00129939 -0.01073193  0.02330381]
Stock Position:  0.0012993904652052175
Bond Position:  [-1.99706067]


portfolio before change:  [-1.86535602]
curr_Stock_Price:  101.55092182963672
curr_Factors:  [101.55092183  -0.95666646  -0.99641602]
mat_Sqrt:  [[14.40359579  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00684312 -0.02132924 -0.03334041]
Stock Position:  0.00684311972323714
Bond Position:  [-2.56028114]


portfolio before change:  [-1.85742804]
curr_Stock_Price:  102.75622543473703
curr_Factors:  [102.75622543  -0.87742754  -1.02491199]
mat_Sqrt:  [[15.3331923   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00359028 -0.00632865 -0.06657829]
Stock Position:  -0.003590277905390792
Bond Position:  [-1.48850463]


portfolio before change:  [-1.85739992]
curr_Stock_Price:  102.69656583927848
curr_Factors:  [102.69656584  -0.54226319  -1.01029327]
mat_Sqrt:  [[21.74148565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280322 -0.00463205  0.10571218]
Stock Position:  -0.002803217303809488
Bond Position:  [-1.56951913]


portfolio before change:  [-1.85529535]
curr_Stock_Price:  101.8758041837426
curr_Factors:  [101.87580418  -0.65079912  -1.01378671]
mat_Sqrt:  [[19.28193465  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00315694 -0.01860977 -0.09632586]
Stock Position:  -0.003156940277218875
Bond Position:  [-1.53367952]


portfolio before change:  [-1.85397994]
curr_Stock_Price:  101.39840323881417
curr_Factors:  [101.39840324  -0.51338815  -1.02649121]
mat_Sqrt:  [[21.74052402  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00041607 -0.00652246 -0.18063841]
Stock Position:  0.000416072985965931
Bond Position:  [-1.89616908]


portfolio before change:  [-1.8534715]
curr_Stock_Price:  103.19011374386167
curr_Factors:  [103.19011374  -0.64008202  -1.00481743]
mat_Sqrt:  [[19.91899116  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00082729 0.00183552 0.47729356]
Stock Position:  0.0008272888940937563
Bond Position:  [-1.93883953]


portfolio before change:  [-1.85351187]
curr_Stock_Price:  103.43427554270771
curr_Factors:  [103.43427554  -0.58105325  -1.00286306]
mat_Sqrt:  [[21.22161176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155693 -0.02675761 -0.28713429]
Stock Position:  -0.0015569297477318487
Bond Position:  [-1.69247197]


portfolio before change:  [-1.85648353]
curr_Stock_Price:  105.20704734547198
curr_Factors:  [105.20704735  -0.7295636   -1.00431079]
mat_Sqrt:  [[18.57944572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00329652  0.05461217 -0.08716853]
Stock Position:  0.003296523447338996
Bond Position:  [-2.20330103]


portfolio before change:  [-1.85723095]
curr_Stock_Price:  105.06386732448318
curr_Factors:  [105.06386732  -0.67728107  -0.97480207]
mat_Sqrt:  [[20.13551714  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00169606 0.00897187 0.27616847]
Stock Position:  0.0016960606814347356
Bond Position:  [-2.03542565]


portfolio before change:  [-1.85508977]
curr_Stock_Price:  106.47633534820136
curr_Factors:  [106.47633535  -0.68388405  -1.00734219]
mat_Sqrt:  [[19.62288548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02168256 -0.08231992  0.77403026]
Stock Position:  0.021682562799501943
Bond Position:  [-4.16376959]


portfolio before change:  [-1.85604458]
curr_Stock_Price:  106.45630508799118
curr_Factors:  [106.45630509  -0.53405183  -0.97820406]
mat_Sqrt:  [[23.4642674   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00394599  0.01651897  0.14697198]
Stock Position:  -0.003945991563712705
Bond Position:  [-1.4359689]


portfolio before change:  [-1.8496523]
curr_Stock_Price:  104.79087223623928
curr_Factors:  [ 1.04790872e+02  6.97008746e-02 -9.56496524e-01]
mat_Sqrt:  [[43.17108841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00661552 -0.00943567  0.19206544]
Stock Position:  0.006615516466537741
Bond Position:  [-2.54289804]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.82069217]
Stock Price:  109.21653020463218
PL:  [-11.03722237]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.90862875e-01  9.93108285e-02 -1.36003801e-02]
 [-2.26498421e-01  6.20031804e-02 -2.66094531e-01]
 [-1.81895997e-02  5.78446504e-02  3.61723247e-02]
 [ 1.15385006e-01  4.59767841e-02  1.28332430e-01]
 [-4.14286552e-02  1.55732326e-01 -4.72345890e-02]
 [-1.29852018e-01 -1.65087853e-01  9.05949516e-02]
 [-6.04136233e-02 -1.80649211e-01  1.05996299e-01]
 [ 1.35999293e-02  6.97333665e-01  9.40308338e-02]
 [ 1.21603445e-01  6.70724865e-03  1.04366733e-01]
 [ 2.43236905e-01  8.68445013e-02  1.14785368e-01]
 [-2.54479489e-01 -2.60230724e-01  1.95145744e-02]
 [-6.27934370e-02 -1.88836389e-02  8.92282909e-02]
 [-2.19809613e-02  1.04322836e-01 -8.88668024e-03]
 [ 1.22941777e-02 -1.73720955e-01  4.35667095e-02]
 [-4.35894504e-02  1.04091315e-01 -3.99324547e-02]
 [ 1.30650918e-01  4.77608340e-03 -3.16095023e-02]
 [ 5.22533699e-02  4.05453669e-02 -5.34128847e-02]
 [-2.33750755e-03 -5.10503482e-02 -3.54922139e-02]
 [ 9.98271948e-03  1.36280591e-01 -1.37109672e-01]
 [-8.17905028e-02 -1.20368266e-02 -2.76320902e-02]
 [-3.83452913e-02  4.69460082e-01 -4.05241544e-01]
 [ 1.99219665e-01  1.27856855e-01  9.32528697e-02]
 [ 1.82279932e-03 -3.27459931e-02  6.93548119e-02]
 [ 5.23582419e-02 -4.91621106e-02 -1.71550523e-01]
 [ 1.93981314e-02  2.14552029e-02 -1.12504836e-02]
 [-8.62224694e-02 -1.72062756e-02  2.18008545e-01]
 [-1.02091248e-02 -3.24794073e-02  1.94703158e-03]
 [-4.50298568e-02  1.48063649e-02 -2.82163417e-01]
 [-4.66645800e-02 -4.27773883e-02  2.56826169e-02]
 [-5.24124992e-02  9.93350186e-03  5.96627202e-03]
 [ 1.69275671e-02 -4.05566810e-02 -6.38771957e-02]
 [-7.70631784e-03  6.19927450e-02 -9.30929085e-02]
 [-3.89190456e-02  2.72835722e-02 -1.23650088e-01]
 [ 3.58353959e-02 -3.81190501e-02  1.51191043e-01]
 [-6.12679435e-02  4.71823633e-02 -1.87025154e-02]
 [-1.15558656e-01 -1.44493749e-01 -1.05232090e-01]
 [ 2.20706896e-03  1.02204354e-01  1.12709348e-01]
 [ 1.57545442e-01 -1.16836242e-01 -1.46825256e-01]
 [ 9.95312127e-02  2.70383414e-03  5.64794984e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.39514047]
curr_Stock_Price:  98.8919724967225
curr_Factors:  [98.8919725  -1.01434365 -1.01366401]
mat_Sqrt:  [[13.01393104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01332167  0.03205243 -0.0387981 ]
Stock Position:  -0.01332167064665054
Bond Position:  [-5.07773418]


portfolio before change:  [-6.40158048]
curr_Stock_Price:  99.32774776197932
curr_Factors:  [99.32774776 -1.11458512 -0.98580029]
mat_Sqrt:  [[12.15863422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02205498  0.02001144 -0.75909363]
Stock Position:  -0.022054976603765698
Bond Position:  [-4.21090932]


portfolio before change:  [-6.38452779]
curr_Stock_Price:  98.53069047596153
curr_Factors:  [98.53069048 -0.87277624 -0.95152578]
mat_Sqrt:  [[15.89597692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [6.30055658e-05 1.86692806e-02 1.03189574e-01]
Stock Position:  6.300556579020097e-05
Bond Position:  [-6.39073578]


portfolio before change:  [-6.38523054]
curr_Stock_Price:  100.05660401646713
curr_Factors:  [100.05660402  -0.7653529   -0.94566041]
mat_Sqrt:  [[18.07848863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00835057 0.01483894 0.3660967 ]
Stock Position:  0.008350572214514282
Bond Position:  [-7.22076044]


portfolio before change:  [-6.39191592]
curr_Stock_Price:  99.36410946331162
curr_Factors:  [99.36410946 -0.62343241 -0.96087883]
mat_Sqrt:  [[20.37848599  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094618  0.05026239 -0.13474713]
Stock Position:  -0.000946176642767137
Bond Position:  [-6.29789992]


portfolio before change:  [-6.39376792]
curr_Stock_Price:  100.48938680174959
curr_Factors:  [100.4893868   -0.90817609  -0.94992069]
mat_Sqrt:  [[15.67324844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00925512 -0.05328188  0.25844218]
Stock Position:  -0.009255121466910586
Bond Position:  [-5.46372644]


portfolio before change:  [-6.38914264]
curr_Stock_Price:  99.91583534414178
curr_Factors:  [99.91583534 -0.75352125 -0.96661933]
mat_Sqrt:  [[17.88902868  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00422897 -0.05830428  0.30237794]
Stock Position:  -0.004228965508718089
Bond Position:  [-5.96660202]


portfolio before change:  [-6.39219687]
curr_Stock_Price:  100.46167943738875
curr_Factors:  [100.46167944  -0.82013909  -0.95287547]
mat_Sqrt:  [[17.0604309   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01026566 0.22506347 0.2682438 ]
Stock Position:  0.010265656953325855
Bond Position:  [-7.42350201]


portfolio before change:  [-6.40796594]
curr_Stock_Price:  99.01597832829272
curr_Factors:  [99.01597833 -0.92368926 -0.92995215]
mat_Sqrt:  [[15.51240184  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00930071 0.00216476 0.29772924]
Stock Position:  0.009300708433906499
Bond Position:  [-7.32888468]


portfolio before change:  [-6.42048305]
curr_Stock_Price:  97.76866004455373
curr_Factors:  [97.76866004 -0.91392941 -0.92967011]
mat_Sqrt:  [[15.47157625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01838174 0.02802894 0.32745071]
Stock Position:  0.01838173596624502
Bond Position:  [-8.21764074]


portfolio before change:  [-6.38759084]
curr_Stock_Price:  99.61394173712607
curr_Factors:  [99.61394174 -0.74636172 -0.93606622]
mat_Sqrt:  [[18.5204254   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01639355 -0.08398911  0.05566965]
Stock Position:  -0.016393547167503963
Bond Position:  [-4.75456498]


portfolio before change:  [-6.36043148]
curr_Stock_Price:  97.92097618891965
curr_Factors:  [97.92097619 -0.64771444 -0.94959354]
mat_Sqrt:  [[19.82319677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244332 -0.00609467  0.25454348]
Stock Position:  -0.0024433190867667372
Bond Position:  [-6.12117929]


portfolio before change:  [-6.36053358]
curr_Stock_Price:  97.64958379617352
curr_Factors:  [97.6495838  -0.8574056  -0.98376316]
mat_Sqrt:  [[15.49034049  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0001614   0.03367005 -0.02535123]
Stock Position:  -0.00016139977814819844
Bond Position:  [-6.34477296]


portfolio before change:  [-6.36151779]
curr_Stock_Price:  98.83336847191688
curr_Factors:  [98.83336847 -1.12343279 -0.98888944]
mat_Sqrt:  [[11.95456315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00119397 -0.0560682   0.1242837 ]
Stock Position:  -0.0011939747285003726
Bond Position:  [-6.24351324]


portfolio before change:  [-6.36215667]
curr_Stock_Price:  98.7147673651375
curr_Factors:  [98.71476737 -0.92249379 -0.97291192]
mat_Sqrt:  [[14.83262048  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00205581  0.03359533 -0.11391618]
Stock Position:  -0.0020558119156129347
Bond Position:  [-6.15921767]


portfolio before change:  [-6.36261637]
curr_Stock_Price:  98.5638560591873
curr_Factors:  [98.56385606 -0.94464187 -0.99987457]
mat_Sqrt:  [[14.10018868  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00887744  0.00154147 -0.09017311]
Stock Position:  0.008877439337623928
Bond Position:  [-7.23761103]


portfolio before change:  [-6.36973433]
curr_Stock_Price:  97.86396949837354
curr_Factors:  [97.8639695  -0.77167922 -0.98339283]
mat_Sqrt:  [[16.92016987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.002933    0.01308596 -0.15237209]
Stock Position:  0.002932996490755706
Bond Position:  [-6.65676901]


portfolio before change:  [-6.37357402]
curr_Stock_Price:  96.83855396516194
curr_Factors:  [96.83855397 -0.51582286 -0.99127649]
mat_Sqrt:  [[21.4547453   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093233 -0.01647643 -0.10124941]
Stock Position:  -0.0009323314630135139
Bond Position:  [-6.28328839]


portfolio before change:  [-6.37333407]
curr_Stock_Price:  95.73872307584162
curr_Factors:  [95.73872308 -0.41859977 -0.99042184]
mat_Sqrt:  [[23.39684621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00041944  0.04398437 -0.39113573]
Stock Position:  0.00041943618812224025
Bond Position:  [-6.41349036]


portfolio before change:  [-6.37397285]
curr_Stock_Price:  96.12725052187959
curr_Factors:  [96.12725052 -0.47617558 -0.97783114]
mat_Sqrt:  [[22.45843183  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00400241 -0.00388487 -0.07882666]
Stock Position:  -0.004002411528763666
Bond Position:  [-5.98923203]


portfolio before change:  [-6.37188649]
curr_Stock_Price:  95.4189137943472
curr_Factors:  [95.41891379 -0.4268662  -0.94952329]
mat_Sqrt:  [[24.09218029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.04750740e-03  1.51517590e-01 -1.15604133e+00]
Stock Position:  -0.001047507403677773
Bond Position:  [-6.27193448]


portfolio before change:  [-6.37355358]
curr_Stock_Price:  96.26191101422147
curr_Factors:  [96.26191101 -0.76383094 -0.95646326]
mat_Sqrt:  [[17.23217912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01418007 0.04126562 0.26602448]
Stock Position:  0.01418006956706201
Bond Position:  [-7.73855418]


portfolio before change:  [-6.35050816]
curr_Stock_Price:  97.95533026027044
curr_Factors:  [97.95533026 -0.71846945 -0.95199835]
mat_Sqrt:  [[18.43117951  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00050434 -0.01056872  0.19784997]
Stock Position:  0.0005043379434560234
Bond Position:  [-6.39991075]


portfolio before change:  [-6.35107608]
curr_Stock_Price:  98.41557548459762
curr_Factors:  [98.41557548 -0.92554696 -0.96115871]
mat_Sqrt:  [[14.91687926  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00048974 -0.015867   -0.48938589]
Stock Position:  0.0004897448141171571
Bond Position:  [-6.39927459]


portfolio before change:  [-6.35176737]
curr_Stock_Price:  98.63745051200294
curr_Factors:  [98.63745051 -0.95461933 -0.97288686]
mat_Sqrt:  [[14.35279682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00149665  0.00692464 -0.0320945 ]
Stock Position:  0.0014966533222142036
Bond Position:  [-6.49939344]


portfolio before change:  [-6.35179347]
curr_Stock_Price:  99.16287782370374
curr_Factors:  [99.16287782 -0.76941051 -0.9320098 ]
mat_Sqrt:  [[18.08971274  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00250053 -0.0055533   0.6219177 ]
Stock Position:  -0.002500530463377608
Bond Position:  [-6.10383367]


portfolio before change:  [-6.35445478]
curr_Stock_Price:  99.9220297424805
curr_Factors:  [99.92202974 -1.05606567 -0.94367069]
mat_Sqrt:  [[13.52654187  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012155  -0.01048268  0.00555434]
Stock Position:  -0.001215500610040408
Bond Position:  [-6.23299949]


portfolio before change:  [-6.35488607]
curr_Stock_Price:  99.63582897683266
curr_Factors:  [99.63582898 -0.88619413 -0.91246664]
mat_Sqrt:  [[16.49176316  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00603961  0.00477873 -0.80493369]
Stock Position:  -0.00603961416922864
Bond Position:  [-5.75312411]


portfolio before change:  [-6.359424]
curr_Stock_Price:  100.2681110242122
curr_Factors:  [100.26811102  -0.84710148  -0.87814324]
mat_Sqrt:  [[17.86070391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280807 -0.01380634  0.07326536]
Stock Position:  -0.0028080660100321094
Bond Position:  [-6.07786452]


portfolio before change:  [-6.35712921]
curr_Stock_Price:  99.18032673812903
curr_Factors:  [99.18032674 -0.97601059 -0.86938039]
mat_Sqrt:  [[15.66687645  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00313828  0.00320602  0.01702011]
Stock Position:  -0.0031382753022227363
Bond Position:  [-6.04587404]


portfolio before change:  [-6.35518977]
curr_Stock_Price:  98.32150496726871
curr_Factors:  [98.32150497 -1.05672765 -0.85421032]
mat_Sqrt:  [[14.54583641  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003018  -0.01308961 -0.18222386]
Stock Position:  -0.00030179830270528156
Bond Position:  [-6.32551651]


portfolio before change:  [-6.35579927]
curr_Stock_Price:  97.72098336348841
curr_Factors:  [97.72098336 -1.06370289 -0.85784998]
mat_Sqrt:  [[14.30434648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098254  0.02000807 -0.26556816]
Stock Position:  -0.0009825413651007179
Bond Position:  [-6.25978436]


portfolio before change:  [-6.35651554]
curr_Stock_Price:  97.65355439421197
curr_Factors:  [97.65355439 -0.87843549 -0.81692641]
mat_Sqrt:  [[17.92262987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00326904  0.00880574 -0.35273928]
Stock Position:  -0.0032690391273061106
Bond Position:  [-6.03728225]


portfolio before change:  [-6.35787259]
curr_Stock_Price:  97.83780945129833
curr_Factors:  [97.83780945 -0.55029005 -0.82287323]
mat_Sqrt:  [[24.78274957  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0023773  -0.01230287  0.43130596]
Stock Position:  0.0023773035996319
Bond Position:  [-6.59046276]


portfolio before change:  [-6.35695731]
curr_Stock_Price:  98.5693686440009
curr_Factors:  [98.56936864 -0.52173907 -0.83909262]
mat_Sqrt:  [[25.27785861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0021938   0.01522804 -0.05335307]
Stock Position:  -0.002193798128721692
Bond Position:  [-6.14071601]


portfolio before change:  [-6.35259136]
curr_Stock_Price:  96.229324420862
curr_Factors:  [96.22932442 -0.53578848 -0.84342012]
mat_Sqrt:  [[24.22840097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00687349 -0.04663516 -0.30019786]
Stock Position:  -0.006873492389360734
Bond Position:  [-5.69115983]


portfolio before change:  [-6.35978962]
curr_Stock_Price:  97.17306912943288
curr_Factors:  [97.17306913 -0.65112399 -0.84555105]
mat_Sqrt:  [[21.75445515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00211801 0.03298631 0.3215284 ]
Stock Position:  0.002118009589379916
Bond Position:  [-6.56560312]


portfolio before change:  [-6.36224485]
curr_Stock_Price:  96.40136585460058
curr_Factors:  [96.40136585 -0.68641554 -0.86991065]
mat_Sqrt:  [[20.33196302  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00510161 -0.03770874 -0.41885159]
Stock Position:  0.00510161090207936
Bond Position:  [-6.85404711]


portfolio before change:  [-6.3653967]
curr_Stock_Price:  95.95150059927902
curr_Factors:  [95.9515006  -0.53835584 -0.85158503]
mat_Sqrt:  [[23.90056242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00466985 0.00087266 0.16112029]
Stock Position:  0.004669846587707382
Bond Position:  [-6.81347548]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.36194673]
Stock Price:  96.87266717181444
PL:  [-6.36194673]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.63403652e-01 -1.10020068e-01  2.18422229e-02]
 [-8.67896857e-02  7.22564505e-02 -8.40408465e-02]
 [-1.08573092e-01 -1.44694868e-02 -5.28045819e-02]
 [ 1.05812195e-01  5.15686049e-02  1.24589248e-01]
 [ 7.46067131e-02 -1.99700913e-02 -8.00019162e-02]
 [-1.29680079e-01 -1.67519288e-01  7.68491458e-02]
 [-6.05071395e-02 -1.78028410e-01  1.06232736e-01]
 [ 1.11310506e-02  6.30634515e-01  9.04504368e-02]
 [ 4.13204029e-01  4.87165837e-02  4.05463904e-01]
 [ 6.74974275e-01  3.01120771e-01  5.89791227e-01]
 [-2.09181169e-01 -2.36324377e-01  1.55769660e-02]
 [-4.69776835e-02 -1.83364454e-02  9.11888942e-02]
 [ 1.15005877e-02 -5.89625562e-02  9.97752952e-02]
 [ 5.83995415e-03  2.66862450e-02 -1.14135512e-01]
 [ 3.66105069e-01 -1.45077465e-01 -1.86294974e-01]
 [-2.10455461e-01 -9.60955888e-02  1.18458919e-01]
 [ 5.11277042e-02  1.75224788e-02 -2.59531187e-02]
 [-6.07232498e-02 -6.29978654e-02  2.30306278e-02]
 [ 1.23262687e-01 -1.36268709e-01 -2.22718531e-02]
 [ 1.80866078e-02 -1.23039966e-02  8.10880844e-02]
 [-5.68856082e-02  6.49644858e-01 -6.32779650e-01]
 [ 3.56827541e-01  2.06181414e-01  6.42710782e-02]
 [ 1.05606524e-02  1.48165881e-01 -4.60237373e-02]
 [ 4.07068647e-02 -1.52024157e-01 -1.99141242e-01]
 [ 2.41929452e-02 -3.55530237e-02 -1.02088204e-02]
 [-3.30872685e-03  1.89568232e-02  8.58686585e-03]
 [ 8.68526032e-02 -1.92837944e-02  1.09054556e-01]
 [ 1.69200954e-01 -5.16844617e-02  2.26524836e-01]
 [-2.71313758e-02  2.81913956e-02 -1.09722074e-01]
 [-6.58326618e-02  1.57130789e-02  1.05045569e-02]
 [ 4.81607217e-02 -2.25951310e-02 -2.62465600e-03]
 [ 2.68184905e-02 -1.03977859e-01 -1.96764206e-01]
 [ 2.77853093e-02 -3.02598615e-03  1.53855032e-01]
 [-9.86745506e-03 -1.10245592e-01 -2.89925565e-01]
 [ 8.76559342e-02  3.75551638e-01 -1.63993707e-01]
 [-4.09856683e-02 -3.38726428e-05 -9.96376192e-03]
 [ 5.22937090e-01 -2.95428894e-01  3.85858779e-01]
 [-1.45785112e-01  7.97747560e-02  6.16713671e-02]
 [ 3.60766049e-01 -4.62629269e-02  4.29129751e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.68660514]
curr_Stock_Price:  100.79336504144507
curr_Factors:  [100.79336504  -0.96810549  -1.01266133]
mat_Sqrt:  [[13.90579568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02023637 -0.03550882  0.06230978]
Stock Position:  -0.0202363738080199
Bond Position:  [10.72629735]


portfolio before change:  [8.68689615]
curr_Stock_Price:  100.84524479721397
curr_Factors:  [100.8452448   -0.98047946  -0.99113062]
mat_Sqrt:  [[14.04093566  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00635251  0.02332067 -0.23974514]
Stock Position:  -0.006352508667914709
Bond Position:  [9.32751644]


portfolio before change:  [8.68491094]
curr_Stock_Price:  101.34130420756475
curr_Factors:  [101.34130421  -0.70984578  -0.99440816]
mat_Sqrt:  [[18.43479911  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00663448 -0.00467001 -0.15063677]
Stock Position:  -0.0066344826142232145
Bond Position:  [9.35725806]


portfolio before change:  [8.68965]
curr_Stock_Price:  100.80330739441912
curr_Factors:  [100.80330739  -0.57636062  -0.96495299]
mat_Sqrt:  [[21.58195529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00656893 0.0166437  0.35541845]
Stock Position:  0.006568925930871882
Bond Position:  [8.02748054]


portfolio before change:  [8.68923235]
curr_Stock_Price:  100.5869625736687
curr_Factors:  [100.58696257  -0.52774024  -0.96814668]
mat_Sqrt:  [[22.53648911  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00240499 -0.00644532 -0.2282232 ]
Stock Position:  0.0024049891825077756
Bond Position:  [8.44732179]


portfolio before change:  [8.69010733]
curr_Stock_Price:  100.51170227375721
curr_Factors:  [100.51170227  -0.66330179  -0.95205675]
mat_Sqrt:  [[19.98367348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00741546 -0.05406662  0.21922922]
Stock Position:  -0.007415455658715961
Bond Position:  [9.4354474]


portfolio before change:  [8.69485589]
curr_Stock_Price:  100.03040277365574
curr_Factors:  [100.03040277  -0.41419202  -0.95382939]
mat_Sqrt:  [[25.46876413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295116 -0.05745842  0.30305243]
Stock Position:  -0.002951158905287255
Bond Position:  [8.9900615]


portfolio before change:  [8.69022363]
curr_Stock_Price:  101.98085130702411
curr_Factors:  [101.98085131  -0.52465184  -0.92580198]
mat_Sqrt:  [[23.91082391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00662135 0.20353641 0.25802992]
Stock Position:  0.006621348588473841
Bond Position:  [8.01497287]


portfolio before change:  [8.69245439]
curr_Stock_Price:  102.16643588821883
curr_Factors:  [102.16643589  -0.73263182  -0.94033251]
mat_Sqrt:  [[19.17560455  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02638317 0.01572321 1.15667566]
Stock Position:  0.026383169926050182
Bond Position:  [5.99697995]


portfolio before change:  [8.71466648]
curr_Stock_Price:  102.97992515330041
curr_Factors:  [102.97992515  -0.88387148  -0.95324525]
mat_Sqrt:  [[16.40223065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05223868 0.09718631 1.68251021]
Stock Position:  0.0522386828777423
Bond Position:  [3.33513083]


portfolio before change:  [8.66999783]
curr_Stock_Price:  102.11685651280443
curr_Factors:  [102.11685651  -0.98990306  -0.96182958]
mat_Sqrt:  [[14.50342991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01752972 -0.07627336  0.04443675]
Stock Position:  -0.017529718632624643
Bond Position:  [10.46007759]


portfolio before change:  [8.66994881]
curr_Stock_Price:  102.19424602557915
curr_Factors:  [102.19424603  -0.78655611  -0.95706564]
mat_Sqrt:  [[17.87232857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00179645 -0.00591806  0.26013653]
Stock Position:  -0.0017964497233794877
Bond Position:  [8.85353563]


portfolio before change:  [8.67277557]
curr_Stock_Price:  101.23680209128241
curr_Factors:  [101.23680209  -0.88878537  -0.95355943]
mat_Sqrt:  [[16.04051245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00123634 -0.01903008  0.28463115]
Stock Position:  0.0012363353879995351
Bond Position:  [8.54761293]


portfolio before change:  [8.67437443]
curr_Stock_Price:  101.66576920840448
curr_Factors:  [101.66576921  -0.83802027  -0.96507895]
mat_Sqrt:  [[16.75323621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071691  0.00861295 -0.32559685]
Stock Position:  -0.0007169094133240724
Bond Position:  [8.74725958]


portfolio before change:  [8.67441236]
curr_Stock_Price:  103.13813024519784
curr_Factors:  [103.13813025  -0.80906219  -0.97139598]
mat_Sqrt:  [[17.38505597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01716785 -0.04682355 -0.53144771]
Stock Position:  0.017167845396322417
Bond Position:  [6.90375289]


portfolio before change:  [8.67844346]
curr_Stock_Price:  103.32266602670303
curr_Factors:  [103.32266603  -0.93202999  -0.9680836 ]
mat_Sqrt:  [[15.4520731   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01332446 -0.03101472  0.33793032]
Stock Position:  -0.013324462315418638
Bond Position:  [10.05516243]


portfolio before change:  [8.68089225]
curr_Stock_Price:  103.23322029071247
curr_Factors:  [103.23322029  -0.72039757  -0.99162726]
mat_Sqrt:  [[18.63359017  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00265149  0.00565536 -0.07403702]
Stock Position:  0.0026514915565366204
Bond Position:  [8.40717024]


portfolio before change:  [8.68448333]
curr_Stock_Price:  104.19121419424329
curr_Factors:  [104.19121419  -0.57940904  -0.99952028]
mat_Sqrt:  [[21.48378541  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00320621 -0.02033247  0.06569997]
Stock Position:  -0.0032062100169742156
Bond Position:  [9.01854224]


portfolio before change:  [8.68880602]
curr_Stock_Price:  103.19461610809907
curr_Factors:  [103.19461611  -0.34142182  -0.97884266]
mat_Sqrt:  [[27.5596348   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00329833 -0.04398054 -0.0635354 ]
Stock Position:  0.0032983285567584095
Bond Position:  [8.34843627]


portfolio before change:  [8.68575354]
curr_Stock_Price:  101.95274377320644
curr_Factors:  [101.95274377  -0.24131751  -0.98234341]
mat_Sqrt:  [[29.98953503  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107128 -0.0039711   0.23132173]
Stock Position:  0.001071277059883417
Bond Position:  [8.5765339]


portfolio before change:  [8.6893556]
curr_Stock_Price:  104.31434798923202
curr_Factors:  [104.31434799  -0.30315934  -0.99850803]
mat_Sqrt:  [[28.3816141   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188302  0.20967198 -1.80514421]
Stock Position:  -0.0018830152473105794
Bond Position:  [8.88578111]


portfolio before change:  [8.69202758]
curr_Stock_Price:  103.4852599023914
curr_Factors:  [103.4852599   -0.75977052  -0.99345294]
mat_Sqrt:  [[17.92516738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02298631 0.06654477 0.1833475 ]
Stock Position:  0.02298630835342481
Bond Position:  [6.31328349]


portfolio before change:  [8.690132]
curr_Stock_Price:  103.36846029485694
curr_Factors:  [103.36846029  -0.69398766  -0.96095167]
mat_Sqrt:  [[19.7540901   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00159007  0.04782033 -0.13129291]
Stock Position:  0.0015900671689175472
Bond Position:  [8.5257692]


portfolio before change:  [8.69370357]
curr_Stock_Price:  104.94435900968088
curr_Factors:  [104.94435901  -1.11167229  -0.96241485]
mat_Sqrt:  [[13.18847253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0023486  -0.04906559 -0.56809453]
Stock Position:  -0.002348601943678305
Bond Position:  [8.9401761]


portfolio before change:  [8.69403888]
curr_Stock_Price:  105.2774451266835
curr_Factors:  [105.27744513  -0.7855741   -0.96690713]
mat_Sqrt:  [[18.24914026  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00081384 -0.01147469 -0.02912292]
Stock Position:  0.0008138382232722807
Bond Position:  [8.60836007]


portfolio before change:  [8.69562563]
curr_Stock_Price:  105.90489869481627
curr_Factors:  [105.90489869  -0.88408857  -1.00149534]
mat_Sqrt:  [[16.07005481  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00014397 0.00611829 0.02449594]
Stock Position:  0.0001439699587211512
Bond Position:  [8.68037851]


portfolio before change:  [8.69664725]
curr_Stock_Price:  105.46383743192904
curr_Factors:  [105.46383743  -0.79469353  -0.99554244]
mat_Sqrt:  [[17.60410571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00597457 -0.00622382  0.31110229]
Stock Position:  0.0059745712127119216
Bond Position:  [8.06654604]


portfolio before change:  [8.70110978]
curr_Stock_Price:  106.04197946361403
curr_Factors:  [106.04197946  -0.8283336   -0.99331165]
mat_Sqrt:  [[17.15328654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01194466 -0.01668109  0.64621231]
Stock Position:  0.011944655356975808
Bond Position:  [7.43447488]


portfolio before change:  [8.71999699]
curr_Stock_Price:  107.54540033742765
curr_Factors:  [107.54540034  -0.8697694   -1.01257859]
mat_Sqrt:  [[16.37187784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267372  0.00909873 -0.31300654]
Stock Position:  -0.002673716256855382
Bond Position:  [9.00754288]


portfolio before change:  [8.71880848]
curr_Stock_Price:  108.4110589565737
curr_Factors:  [108.41105896  -0.89979257  -1.00936725]
mat_Sqrt:  [[16.06704504  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00376429  0.00507137  0.02996658]
Stock Position:  -0.003764289523061334
Bond Position:  [9.1268991]


portfolio before change:  [8.72280084]
curr_Stock_Price:  107.65356633572797
curr_Factors:  [107.65356634  -0.88608927  -1.00369768]
mat_Sqrt:  [[16.26688428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00264419 -0.00729255 -0.00748741]
Stock Position:  0.0026441913233879255
Bond Position:  [8.43814421]


portfolio before change:  [8.72383085]
curr_Stock_Price:  107.6441803668983
curr_Factors:  [107.64418037  -0.77413489  -1.0095283 ]
mat_Sqrt:  [[18.08653919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191138 -0.03355871 -0.56131351]
Stock Position:  -0.0019113787449978633
Bond Position:  [8.92957965]


portfolio before change:  [8.72495435]
curr_Stock_Price:  107.64039659557203
curr_Factors:  [107.6403966   -0.65096036  -1.02828154]
mat_Sqrt:  [[20.07658298  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00291749 -0.00097663  0.43890558]
Stock Position:  0.002917486473209331
Bond Position:  [8.41091495]


portfolio before change:  [8.72676898]
curr_Stock_Price:  107.90199124003826
curr_Factors:  [107.90199124  -0.88682791  -1.04913687]
mat_Sqrt:  [[15.5686386   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00588054 -0.03558161 -0.82707694]
Stock Position:  -0.0058805431174349795
Bond Position:  [9.36129129]


portfolio before change:  [8.72183465]
curr_Stock_Price:  108.94008722133039
curr_Factors:  [108.94008722  -0.76191552  -1.05704762]
mat_Sqrt:  [[17.66941062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00740489  0.12120877 -0.4678284 ]
Stock Position:  0.00740488852611888
Bond Position:  [7.91514545]


portfolio before change:  [8.72650839]
curr_Stock_Price:  109.43763590237747
curr_Factors:  [109.4376359   -0.58684694  -1.05357149]
mat_Sqrt:  [[21.21983638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.02765121e-03 -1.09323484e-05 -2.84238394e-02]
Stock Position:  -0.0020276512099104537
Bond Position:  [8.94840975]


portfolio before change:  [8.72841715]
curr_Stock_Price:  109.04795574634859
curr_Factors:  [109.04795575  -0.53742142  -1.04353546]
mat_Sqrt:  [[22.43968113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02412672 -0.09534927  1.10074769]
Stock Position:  0.024126724881108785
Bond Position:  [6.09744712]


portfolio before change:  [8.72905475]
curr_Stock_Price:  109.04279008023816
curr_Factors:  [109.04279008  -0.4951919   -1.0654529 ]
mat_Sqrt:  [[22.89905343  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00510556  0.02574719  0.17593124]
Stock Position:  -0.005105562276439849
Bond Position:  [9.2857795]


portfolio before change:  [8.73879572]
curr_Stock_Price:  107.36223613528611
curr_Factors:  [107.36223614  -0.42426012  -1.0709729 ]
mat_Sqrt:  [[24.07022207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01495966 -0.0149313   0.12241877]
Stock Position:  0.014959656053434293
Bond Position:  [7.13269359]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.73246441]
Stock Price:  106.87940756567298
PL:  [1.85305684]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-7.05299012e-02 -8.63864509e-02  1.40468737e-02]
 [-1.18360291e-01  6.99394734e-02 -1.25180328e-01]
 [-1.88983370e-02  3.10432011e-02  3.31288301e-02]
 [ 1.21330240e-01  2.94751591e-02  1.47392296e-01]
 [ 2.98479024e-02  5.45947815e-02 -6.83883994e-02]
 [-1.02963483e-01 -1.57982478e-01  1.26851204e-01]
 [-6.10294467e-02 -1.77677414e-01  8.91186793e-02]
 [-1.22683952e-03  7.73696988e-01  1.22324147e-01]
 [ 6.41603661e-02  7.80462174e-03  3.53065957e-02]
 [ 2.46787812e-01  8.83256777e-02  1.17784708e-01]
 [-8.73187557e-02 -1.89584460e-01  1.62781012e-02]
 [-5.38840992e-02 -1.85753936e-02  9.03327389e-02]
 [-6.87511956e-02  2.93420826e-01 -3.45247036e-01]
 [ 7.26801395e-03 -6.99053931e-02  5.81563697e-02]
 [-9.68142899e-02  1.94853262e-01 -3.91864795e-02]
 [-3.67567711e-02 -3.92072931e-02  4.38020899e-03]
 [ 3.61301347e-02  1.25359563e-01 -1.73856200e-01]
 [ 5.99045877e-02 -3.29832360e-02 -7.51444346e-02]
 [ 1.38259564e-02  1.66067958e-01 -9.76024289e-02]
 [-9.44704237e-02 -1.51628727e-02 -2.48864939e-02]
 [-3.04565377e-02  4.13475103e-01 -3.48591554e-01]
 [ 3.45861196e-01  1.24104636e-01  1.53625955e-01]
 [ 4.51960247e-02 -5.61807912e-02  8.76324658e-02]
 [ 3.86942547e-01  2.78903181e-01 -2.19545432e-01]
 [-3.03278763e-01  1.53563215e-01  2.11977707e-02]
 [-2.16091377e-01 -8.91768653e-02  2.43533309e-02]
 [-1.01274877e-01 -3.60941659e-02 -3.07744760e-02]
 [-1.36053806e-01  1.64197086e-01 -1.24414613e-01]
 [ 2.45326666e-01  1.17548831e-01  2.27339458e-01]
 [ 1.21555061e-01  8.29960198e-02 -1.66050076e-01]
 [-1.97684306e-02  1.82286372e-02  6.73650491e-02]
 [-4.24690458e-02  5.89314659e-03 -1.09020889e-01]
 [-7.60258571e-03  7.63576862e-02 -3.60432178e-02]
 [ 4.04374871e-02 -3.23269479e-02  1.79825186e-01]
 [-7.93676990e-02  1.63043811e-02 -5.50639586e-02]
 [-2.10021752e-01 -2.14193705e-01 -1.93959546e-01]
 [ 1.12696118e-01  1.36432889e-01  3.49272788e-01]
 [ 2.30914700e-01 -1.53639012e-01 -3.00379102e-01]
 [ 9.44104776e-02  5.87625883e-03  8.67932326e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.31413929]
curr_Stock_Price:  100.11604513611339
curr_Factors:  [100.11604514  -1.04976854  -1.00083578]
mat_Sqrt:  [[12.88064299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00662204 -0.02788111  0.04007182]
Stock Position:  -0.006622041744986998
Bond Position:  [3.97711192]


portfolio before change:  [3.3119505]
curr_Stock_Price:  100.52165505775164
curr_Factors:  [100.52165506  -0.94702268  -1.00248993]
mat_Sqrt:  [[14.30859735  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00906003  0.02257287 -0.35710463]
Stock Position:  -0.00906002734123331
Bond Position:  [4.22267944]


portfolio before change:  [3.31545173]
curr_Stock_Price:  100.19347067031767
curr_Factors:  [100.19347067  -0.957178    -0.98602621]
mat_Sqrt:  [[14.35213656  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00040407  0.01001915  0.09450733]
Stock Position:  -0.0004040705708666927
Bond Position:  [3.35593696]


portfolio before change:  [3.31586005]
curr_Stock_Price:  100.22118113515572
curr_Factors:  [100.22118114  -0.86116837  -0.99344448]
mat_Sqrt:  [[15.68597032  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01003656 0.00951307 0.42046919]
Stock Position:  0.010036558475572582
Bond Position:  [2.3099843]


portfolio before change:  [3.3129739]
curr_Stock_Price:  99.90484613008283
curr_Factors:  [99.90484613 -0.81779988 -0.98401629]
mat_Sqrt:  [[16.48419463  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00163989  0.01762039 -0.19509307]
Stock Position:  0.0016398915775523517
Bond Position:  [3.14914078]


portfolio before change:  [3.31357843]
curr_Stock_Price:  100.03342776956805
curr_Factors:  [100.03342777  -1.0061175   -1.00509017]
mat_Sqrt:  [[13.3871694   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00816589 -0.05098863  0.36187118]
Stock Position:  -0.00816588813070005
Bond Position:  [4.13044021]


portfolio before change:  [3.31746077]
curr_Stock_Price:  99.62122392319525
curr_Factors:  [99.62122392 -0.80716298 -1.02852926]
mat_Sqrt:  [[15.88988908  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00497841 -0.05734514  0.25423079]
Stock Position:  -0.004978412525443779
Bond Position:  [3.81341632]


portfolio before change:  [3.32325891]
curr_Stock_Price:  98.5523224931509
curr_Factors:  [98.55232249 -0.98587788 -1.01062139]
mat_Sqrt:  [[13.38437978  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01357349 0.24970963 0.34895674]
Stock Position:  0.013573487285585184
Bond Position:  [1.98556022]


portfolio before change:  [3.32061483]
curr_Stock_Price:  98.33923823603959
curr_Factors:  [98.33923824 -0.99729526 -1.00044072]
mat_Sqrt:  [[13.33893414  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00546973 0.00251893 0.10071989]
Stock Position:  0.005469732867184041
Bond Position:  [2.78272546]


portfolio before change:  [3.31941682]
curr_Stock_Price:  98.0566156499104
curr_Factors:  [98.05661565 -0.92521289 -1.01601245]
mat_Sqrt:  [[14.07386706  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02052456 0.02850699 0.33600699]
Stock Position:  0.020524559261782014
Bond Position:  [1.306848]


portfolio before change:  [3.31685904]
curr_Stock_Price:  97.92403572032129
curr_Factors:  [97.92403572 -0.96716928 -1.03112432]
mat_Sqrt:  [[13.27521067  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0092424  -0.06118812  0.04643689]
Stock Position:  -0.009242397064476065
Bond Position:  [4.22191186]


portfolio before change:  [3.32553697]
curr_Stock_Price:  97.04221259639192
curr_Factors:  [97.0422126  -0.7647547  -1.02103392]
mat_Sqrt:  [[16.27056179  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00241151 -0.00599518  0.25769416]
Stock Position:  -0.0024115143018262576
Bond Position:  [3.55955566]


portfolio before change:  [3.33098824]
curr_Stock_Price:  94.96621720004627
curr_Factors:  [94.9662172  -0.70954027 -1.01704879]
mat_Sqrt:  [[16.89355436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00469588  0.09470116 -0.9848937 ]
Stock Position:  -0.0046958842921525365
Bond Position:  [3.7769386]


portfolio before change:  [3.32703123]
curr_Stock_Price:  95.90941690639016
curr_Factors:  [95.90941691 -0.70232596 -1.00061092]
mat_Sqrt:  [[17.46968863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00027875 -0.02256187  0.16590394]
Stock Position:  0.00027875451471488083
Bond Position:  [3.30029604]


portfolio before change:  [3.32747207]
curr_Stock_Price:  96.01088467677677
curr_Factors:  [96.01088468 -0.92530939 -0.98740113]
mat_Sqrt:  [[14.17884466  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00458704  0.06288862 -0.11178812]
Stock Position:  -0.0045870409448189485
Bond Position:  [3.76787793]


portfolio before change:  [3.32919077]
curr_Stock_Price:  95.73888229200216
curr_Factors:  [95.73888229 -0.71253602 -0.9789399 ]
mat_Sqrt:  [[17.63963907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00248678 -0.0126541   0.01249552]
Stock Position:  -0.002486775366198822
Bond Position:  [3.56727187]


portfolio before change:  [3.33098944]
curr_Stock_Price:  95.19491382050357
curr_Factors:  [95.19491382 -0.55382541 -0.9715845 ]
mat_Sqrt:  [[20.70792765  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012667   0.04045962 -0.49596335]
Stock Position:  0.0012667032901373695
Bond Position:  [3.21040573]


portfolio before change:  [3.33141625]
curr_Stock_Price:  95.21503054275911
curr_Factors:  [95.21503054 -0.46809126 -0.92937228]
mat_Sqrt:  [[23.53936853  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00160723 -0.01064529 -0.21436616]
Stock Position:  0.0016072274562380178
Bond Position:  [3.17838404]


portfolio before change:  [3.33142416]
curr_Stock_Price:  94.97274687778906
curr_Factors:  [94.97274688 -0.41737512 -0.93927316]
mat_Sqrt:  [[24.45761679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00113672  0.0535982  -0.27843256]
Stock Position:  0.0011367184356890468
Bond Position:  [3.22346689]


portfolio before change:  [3.33061347]
curr_Stock_Price:  93.90506318382263
curr_Factors:  [93.90506318 -0.49292293 -0.93747878]
mat_Sqrt:  [[22.46329413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00456948 -0.0048938  -0.07099424]
Stock Position:  -0.004569475244333143
Bond Position:  [3.75971033]


portfolio before change:  [3.3388479]
curr_Stock_Price:  92.20586662054872
curr_Factors:  [92.20586662 -0.56184018 -0.92019798]
mat_Sqrt:  [[20.94679375  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.21712331e-04  1.33448516e-01 -9.94434674e-01]
Stock Position:  -0.0008217123308582734
Bond Position:  [3.41461459]


portfolio before change:  [3.34018241]
curr_Stock_Price:  91.10127712916061
curr_Factors:  [91.10127713 -0.64208455 -0.92165027]
mat_Sqrt:  [[19.07229981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02110667 0.0400546  0.43825209]
Stock Position:  0.021106668819752396
Bond Position:  [1.41733792]


portfolio before change:  [3.33198786]
curr_Stock_Price:  90.7046383902195
curr_Factors:  [90.70463839 -0.68182687 -0.91100079]
mat_Sqrt:  [[18.44476945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00279841 -0.01813227  0.24999103]
Stock Position:  0.00279841236435632
Bond Position:  [3.07815888]


portfolio before change:  [3.33226214]
curr_Stock_Price:  90.66514781791311
curr_Factors:  [90.66514782 -0.81180532 -0.91247948]
mat_Sqrt:  [[16.16564368  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02468562  0.09001561 -0.62630201]
Stock Position:  0.024685617526144128
Bond Position:  [1.09413698]


portfolio before change:  [3.34466772]
curr_Stock_Price:  91.16214991159258
curr_Factors:  [91.16214991 -1.03541573 -0.89369061]
mat_Sqrt:  [[13.2438521   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02020604  0.04956231  0.06047134]
Stock Position:  -0.020206041620800235
Bond Position:  [5.18669392]


portfolio before change:  [3.34352657]
curr_Stock_Price:  91.25071412666566
curr_Factors:  [91.25071413 -0.89985273 -0.89557553]
mat_Sqrt:  [[15.15275795  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0151341  -0.02878171  0.06947327]
Stock Position:  -0.015134104736526436
Bond Position:  [4.72452443]


portfolio before change:  [3.34692561]
curr_Stock_Price:  91.06514364296604
curr_Factors:  [91.06514364 -0.88281302 -0.88608925]
mat_Sqrt:  [[15.52843479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0074009  -0.01164934 -0.08779101]
Stock Position:  -0.007400899262382893
Bond Position:  [4.02088957]


portfolio before change:  [3.34223493]
curr_Stock_Price:  91.76685954074892
curr_Factors:  [91.76685954 -1.2343883  -0.8771906 ]
mat_Sqrt:  [[11.10807507  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01151714  0.05299438 -0.35492026]
Stock Position:  -0.011517138847782969
Bond Position:  [4.39912659]


portfolio before change:  [3.34726642]
curr_Stock_Price:  91.3777381706019
curr_Factors:  [91.37773817 -1.28690055 -0.85257003]
mat_Sqrt:  [[10.7567267   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02935156 0.03793872 0.64853619]
Stock Position:  0.029351558481777732
Bond Position:  [0.66518739]


portfolio before change:  [3.35792709]
curr_Stock_Price:  91.73811142852416
curr_Factors:  [91.73811143 -1.23931175 -0.82831798]
mat_Sqrt:  [[11.6035162   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00901466  0.02678685 -0.47369465]
Stock Position:  0.00901465734859552
Bond Position:  [2.53093945]


portfolio before change:  [3.35424277]
curr_Stock_Price:  91.2943115864516
curr_Factors:  [91.29431159 -1.01381303 -0.84819777]
mat_Sqrt:  [[14.18347678  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.61927333e-04  5.88326735e-03  1.92173734e-01]
Stock Position:  -0.00016192733282580337
Bond Position:  [3.36902582]


portfolio before change:  [3.35459537]
curr_Stock_Price:  91.71768953696473
curr_Factors:  [91.71768954 -0.96096983 -0.85437635]
mat_Sqrt:  [[14.92994732  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00425453  0.001902   -0.31100625]
Stock Position:  -0.004254529958760506
Bond Position:  [3.74481103]


portfolio before change:  [3.35369059]
curr_Stock_Price:  92.04038325784279
curr_Factors:  [92.04038326 -0.88535662 -0.84313258]
mat_Sqrt:  [[16.34199591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.83411363e-05  2.46443372e-02 -1.02821268e-01]
Stock Position:  3.8341136263451685e-05
Bond Position:  [3.35016166]


portfolio before change:  [3.35412363]
curr_Stock_Price:  92.41182612857897
curr_Factors:  [92.41182613 -0.83071986 -0.85693126]
mat_Sqrt:  [[17.09188594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00412742 -0.01043348  0.5129912 ]
Stock Position:  0.004127422746994452
Bond Position:  [2.97270096]


portfolio before change:  [3.35612504]
curr_Stock_Price:  92.80669805452924
curr_Factors:  [92.80669805 -0.71467503 -0.83661597]
mat_Sqrt:  [[19.67261971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0044366   0.00526222 -0.15708215]
Stock Position:  -0.004436595933352911
Bond Position:  [3.76787086]


portfolio before change:  [3.3596749]
curr_Stock_Price:  92.1127322153716
curr_Factors:  [92.11273222 -0.48309858 -0.84961065]
mat_Sqrt:  [[24.29581106  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01207351 -0.06913072 -0.5533126 ]
Stock Position:  -0.012073508651978848
Bond Position:  [4.47179877]


portfolio before change:  [3.38421243]
curr_Stock_Price:  90.12668850915469
curr_Factors:  [90.12668851 -0.66085383 -0.85515792]
mat_Sqrt:  [[19.79055072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01070412 0.04403353 0.99637805]
Stock Position:  0.01070411720027914
Bond Position:  [2.41948579]


portfolio before change:  [3.37957103]
curr_Stock_Price:  89.66482430978459
curr_Factors:  [89.66482431 -0.67387523 -0.82860671]
mat_Sqrt:  [[19.95733216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00692671 -0.04958678 -0.85689797]
Stock Position:  0.006926709390251569
Bond Position:  [2.75848885]


portfolio before change:  [3.37684468]
curr_Stock_Price:  89.22144119035188
curr_Factors:  [89.22144119 -0.83593828 -0.8168844 ]
mat_Sqrt:  [[17.08667128  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00663245 0.00189655 0.24759693]
Stock Position:  0.006632453829070032
Bond Position:  [2.78508759]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.37552771]
Stock Price:  88.97038342721922
PL:  [3.37552771]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.59233036e-02 -7.54181658e-02  1.06715965e-02]
 [-2.24921941e-01  5.43948357e-02 -2.24873687e-01]
 [-3.06412617e-02  5.41497979e-02  2.83912397e-02]
 [ 8.48927115e-02  8.23371530e-02  7.16015443e-02]
 [-7.13374280e-02  1.80500138e-01 -4.45471561e-02]
 [-8.03527113e-02 -1.56174831e-01  1.33822070e-01]
 [-5.96329419e-02 -1.79507861e-01  1.09460845e-01]
 [-3.50523379e-02  7.80521593e-01  1.71689364e-01]
 [ 1.43222214e-01 -6.97897116e-02  1.18935973e-01]
 [ 4.16382054e-01  1.59067870e-01  2.61035611e-01]
 [-2.43373020e-01 -3.05350348e-01 -1.54860875e-02]
 [-4.80136004e-02 -2.46012217e-02 -8.66133445e-03]
 [-1.23634818e-01  4.47186804e-01 -8.33096921e-01]
 [ 4.31605985e-03 -8.93269388e-03  6.67251329e-02]
 [-7.87994315e-02  1.96544022e-01 -4.00805453e-02]
 [ 9.19508403e-03 -2.93350546e-02  2.60568359e-02]
 [ 5.70841807e-02  7.05492236e-02 -1.52587288e-01]
 [-1.98550537e-02 -5.60792499e-02 -2.43500818e-02]
 [ 4.47044506e-02  4.99807662e-02 -2.58056435e-01]
 [-2.93264569e-02  3.89763462e-02 -6.91841491e-02]
 [-4.58173054e-02  5.76567701e-01 -5.63924745e-01]
 [ 3.85859953e-01  2.20073325e-01  5.95433546e-02]
 [ 2.55849160e-02  1.20710358e-01 -2.36810630e-02]
 [-5.67727088e-02 -1.24240858e-01 -2.61327473e-02]
 [ 1.11470974e-02  2.33139217e-02 -1.01247206e-02]
 [-1.29577415e-01 -1.16174574e-02  2.17015634e-01]
 [ 1.25258458e-02 -3.29775824e-02  5.79211132e-03]
 [ 2.19241058e-02 -2.77321882e-02 -2.02490031e-01]
 [-2.58306554e-02 -4.10431021e-02  4.57515814e-02]
 [-7.13769799e-02  8.15534851e-03  1.90119711e-02]
 [ 3.78922117e-02 -1.03569056e-02  3.04370779e-02]
 [ 3.85902586e-02  8.49442244e-02 -6.36017192e-02]
 [-4.07073315e-02  2.22507402e-02 -1.03651136e-01]
 [ 1.54261716e-02 -6.44550233e-02  1.72364311e-02]
 [-6.03371632e-02  7.43430643e-02 -2.64599691e-02]
 [-1.27107515e-01 -1.48382817e-01 -1.14196718e-01]
 [ 4.34084168e-02  1.04057714e-01  1.64774057e-01]
 [ 4.11521638e-02 -7.21737240e-02 -6.19029775e-02]
 [ 9.74366499e-02  4.00146866e-03  6.88788938e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.13493456]
curr_Stock_Price:  99.84130746674471
curr_Factors:  [99.84130747 -0.90111278 -0.97736561]
mat_Sqrt:  [[15.25799473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00017741 -0.02434111  0.03044309]
Stock Position:  0.00017741292184946436
Bond Position:  [1.11722142]


portfolio before change:  [1.13493467]
curr_Stock_Price:  99.0547354350667
curr_Factors:  [99.05473544 -1.05466028 -0.97627131]
mat_Sqrt:  [[12.99729158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01998269  0.01755586 -0.64150204]
Stock Position:  -0.019982685553902646
Bond Position:  [3.1143143]


portfolio before change:  [1.13585756]
curr_Stock_Price:  99.02803358616964
curr_Factors:  [99.02803359 -1.061594   -0.98750404]
mat_Sqrt:  [[12.75986804  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108094  0.01747677  0.0809923 ]
Stock Position:  -0.0010809393073280566
Bond Position:  [1.24290085]


portfolio before change:  [1.13592521]
curr_Stock_Price:  99.10918757719867
curr_Factors:  [99.10918758 -1.05851769 -0.94733361]
mat_Sqrt:  [[13.33471577  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00872274 0.0265742  0.20425928]
Stock Position:  0.00872274434164726
Bond Position:  [0.2714211]


portfolio before change:  [1.13487935]
curr_Stock_Price:  98.98539780981272
curr_Factors:  [98.98539781 -0.80408354 -0.94469781]
mat_Sqrt:  [[17.22205793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253083  0.05825617 -0.12708064]
Stock Position:  -0.002530832374680149
Bond Position:  [1.3853948]


portfolio before change:  [1.13291454]
curr_Stock_Price:  99.83017722431964
curr_Factors:  [99.83017722 -0.90295274 -0.94012891]
mat_Sqrt:  [[15.80598815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00537236 -0.05040521  0.38175712]
Stock Position:  -0.005372359425049264
Bond Position:  [1.66923814]


portfolio before change:  [1.13111455]
curr_Stock_Price:  100.20406573832904
curr_Factors:  [100.20406574  -0.60113157  -0.9247235 ]
mat_Sqrt:  [[21.78787656  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00339323 -0.05793591  0.31226132]
Stock Position:  -0.003393227824644205
Bond Position:  [1.47112977]


portfolio before change:  [1.13562483]
curr_Stock_Price:  98.92906080252601
curr_Factors:  [98.9290608  -0.45902449 -0.89603395]
mat_Sqrt:  [[25.51699215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00624356 0.25191226 0.48978197]
Stock Position:  0.0062435615071564105
Bond Position:  [0.51795516]


portfolio before change:  [1.12898441]
curr_Stock_Price:  97.85512781121957
curr_Factors:  [97.85512781 -0.37537983 -0.88238254]
mat_Sqrt:  [[27.81918022  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00550894 -0.02252453  0.33929122]
Stock Position:  0.005508938493111127
Bond Position:  [0.58990653]


portfolio before change:  [1.13159747]
curr_Stock_Price:  98.31607235688453
curr_Factors:  [98.31607236 -0.17068448 -0.89865989]
mat_Sqrt:  [[33.74536757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01488013 0.05133893 0.74466194]
Stock Position:  0.014880125886944972
Bond Position:  [-0.33135806]


portfolio before change:  [1.09470553]
curr_Stock_Price:  95.8395797595738
curr_Factors:  [95.83957976 -0.20238241 -0.91141682]
mat_Sqrt:  [[31.46502237  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00981609 -0.0985514  -0.0441775 ]
Stock Position:  -0.009816089745812792
Bond Position:  [2.03547544]


portfolio before change:  [1.12154421]
curr_Stock_Price:  93.13134986768037
curr_Factors:  [93.13134987 -0.17318202 -0.93833826]
mat_Sqrt:  [[30.64564549  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00178829 -0.00794001 -0.02470838]
Stock Position:  -0.0017882896701013513
Bond Position:  [1.28809004]


portfolio before change:  [1.12297462]
curr_Stock_Price:  92.42151172693193
curr_Factors:  [ 9.24215117e+01  4.33881482e-02 -9.73919769e-01]
mat_Sqrt:  [[36.44586983  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00555367  0.14432892 -2.37659363]
Stock Position:  -0.005553671573911031
Bond Position:  [1.63625335]


portfolio before change:  [1.11416687]
curr_Stock_Price:  94.0442750782719
curr_Factors:  [ 9.40442751e+01  6.75104288e-02 -9.73726303e-01]
mat_Sqrt:  [[37.9986187   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00042404 -0.00288301  0.19034823]
Stock Position:  0.0004240388891136099
Bond Position:  [1.07428844]


portfolio before change:  [1.11557705]
curr_Stock_Price:  97.05315975881503
curr_Factors:  [97.05315976 -0.12639946 -0.97538556]
mat_Sqrt:  [[32.24857468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00145313  0.06343431 -0.11433864]
Stock Position:  -0.001453132688473147
Bond Position:  [1.25660817]


portfolio before change:  [1.11623759]
curr_Stock_Price:  96.70669863204546
curr_Factors:  [96.70669863 -0.41002525 -0.97720592]
mat_Sqrt:  [[24.15403654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00035298 -0.00946785  0.0743329 ]
Stock Position:  0.000352981185210646
Bond Position:  [1.08210195]


portfolio before change:  [1.11652383]
curr_Stock_Price:  97.13439638132154
curr_Factors:  [97.13439638 -0.25593507 -0.95406997]
mat_Sqrt:  [[28.96506692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00139265  0.02276966 -0.43528906]
Stock Position:  0.001392651048682614
Bond Position:  [0.98124951]


portfolio before change:  [1.11766265]
curr_Stock_Price:  97.8640485175461
curr_Factors:  [97.86404852 -0.18836013 -0.9750399 ]
mat_Sqrt:  [[30.57489414  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118635 -0.0180995  -0.06946401]
Stock Position:  -0.0011863531587855052
Bond Position:  [1.23376397]


portfolio before change:  [1.11784513]
curr_Stock_Price:  97.84023707936076
curr_Factors:  [97.84023708 -0.16561432 -0.97188821]
mat_Sqrt:  [[31.36941536  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.11260488e-05  1.61312229e-02 -7.36163180e-01]
Stock Position:  7.112604884099139e-05
Bond Position:  [1.11088614]


portfolio before change:  [1.11808736]
curr_Stock_Price:  99.29351637270702
curr_Factors:  [99.29351637 -0.24714134 -0.96470033]
mat_Sqrt:  [[29.55457664  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00120092  0.01257956 -0.19736312]
Stock Position:  -0.001200917179440446
Bond Position:  [1.23733065]


portfolio before change:  [1.11503056]
curr_Stock_Price:  101.96770762895731
curr_Factors:  [101.96770763  -0.41829057  -0.99843357]
mat_Sqrt:  [[24.72789681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174849  0.18608643 -1.60872033]
Stock Position:  -0.0017484937371909776
Bond Position:  [1.29332045]


portfolio before change:  [1.11361569]
curr_Stock_Price:  102.86936439568827
curr_Factors:  [102.8693644   -0.58824487  -1.0023008 ]
mat_Sqrt:  [[20.9662543   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02112616 0.07102836 0.16986062]
Stock Position:  0.0211261612133188
Bond Position:  [-1.05961909]


portfolio before change:  [1.09935543]
curr_Stock_Price:  102.20062955015848
curr_Factors:  [102.20062955  -0.44129823  -0.99175225]
mat_Sqrt:  [[24.38302906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186158  0.0389591  -0.06755548]
Stock Position:  0.001861579125705808
Bond Position:  [0.90910087]


portfolio before change:  [1.09883321]
curr_Stock_Price:  101.85905560011201
curr_Factors:  [101.8590556   -0.19922143  -0.98662271]
mat_Sqrt:  [[31.11673915  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281095 -0.04009856 -0.07454945]
Stock Position:  -0.002810949826418489
Bond Position:  [1.3851539]


portfolio before change:  [1.10695956]
curr_Stock_Price:  99.02969306832796
curr_Factors:  [99.02969307 -0.33523898 -0.96414804]
mat_Sqrt:  [[27.00528847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00051247  0.00752454 -0.02888301]
Stock Position:  0.0005124674674942644
Bond Position:  [1.05621006]


portfolio before change:  [1.10632856]
curr_Stock_Price:  97.54075858126511
curr_Factors:  [97.54075858 -0.14327002 -0.96503922]
mat_Sqrt:  [[32.19982724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00272209 -0.00374952  0.6190852 ]
Stock Position:  -0.002722085640366391
Bond Position:  [1.37184286]


portfolio before change:  [1.09741578]
curr_Stock_Price:  100.87800581716148
curr_Factors:  [100.87800582  -0.43471111  -0.99785802]
mat_Sqrt:  [[24.0790652   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00028974 -0.01064347  0.01652328]
Stock Position:  0.0002897386031994037
Bond Position:  [1.06818753]


portfolio before change:  [1.09737803]
curr_Stock_Price:  100.2868332032453
curr_Factors:  [100.2868332   -0.3292883   -1.01821143]
mat_Sqrt:  [[26.06346928  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00096188 -0.00895053 -0.5776477 ]
Stock Position:  -0.0009618753206259028
Bond Position:  [1.19384146]


portfolio before change:  [1.09752011]
curr_Stock_Price:  100.29426830071723
curr_Factors:  [100.2942683   -0.32466508  -1.01205307]
mat_Sqrt:  [[26.3479482   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094389 -0.0132466   0.13051653]
Stock Position:  -0.0009438890984350029
Bond Position:  [1.19218678]


portfolio before change:  [1.09831489]
curr_Stock_Price:  99.61014025952721
curr_Factors:  [99.61014026 -0.1412997  -1.01371594]
mat_Sqrt:  [[31.38243472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209772  0.00263213  0.05423586]
Stock Position:  -0.0020977172285188386
Bond Position:  [1.30726879]


portfolio before change:  [1.0985917]
curr_Stock_Price:  99.55608675464617
curr_Factors:  [99.55608675 -0.18059826 -0.99360844]
mat_Sqrt:  [[30.7692088   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00136471 -0.00334268  0.08682851]
Stock Position:  0.0013647104163637994
Bond Position:  [0.96272647]


portfolio before change:  [1.09841459]
curr_Stock_Price:  99.33812785372703
curr_Factors:  [99.33812785 -0.18563512 -0.97620456]
mat_Sqrt:  [[31.08389308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138164  0.02741563 -0.181438  ]
Stock Position:  0.0013816409397554613
Bond Position:  [0.96116497]


portfolio before change:  [1.10008531]
curr_Stock_Price:  100.46039164628996
curr_Factors:  [ 1.00460392e+02 -9.09382553e-02 -9.76079543e-01]
mat_Sqrt:  [[34.56168637  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00165857  0.0071814  -0.29568784]
Stock Position:  -0.0016585740949425715
Bond Position:  [1.26670631]


portfolio before change:  [1.10040475]
curr_Stock_Price:  100.36326303884697
curr_Factors:  [100.36326304   0.172649    -0.96578832]
mat_Sqrt:  [[45.40657461  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00012746 -0.02080277  0.04917074]
Stock Position:  0.0001274642900046088
Bond Position:  [1.08761202]


portfolio before change:  [1.10003221]
curr_Stock_Price:  96.37388590593977
curr_Factors:  [ 9.63738859e+01 -4.69077863e-02 -9.52664527e-01]
mat_Sqrt:  [[35.46913773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00142555  0.02399412 -0.07548293]
Stock Position:  -0.001425551074023392
Bond Position:  [1.23741811]


portfolio before change:  [1.10077035]
curr_Stock_Price:  95.96460317849599
curr_Factors:  [95.96460318 -0.14057711 -0.94445138]
mat_Sqrt:  [[32.42568679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00557294 -0.04789035 -0.32577145]
Stock Position:  -0.005572937886020977
Bond Position:  [1.63557512]


portfolio before change:  [1.10064686]
curr_Stock_Price:  96.02345017348078
curr_Factors:  [96.02345017 -0.21843016 -0.91950603]
mat_Sqrt:  [[30.77357134  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00319376 0.03358448 0.47005452]
Stock Position:  0.0031937623084757117
Bond Position:  [0.79397079]


portfolio before change:  [1.10654266]
curr_Stock_Price:  97.83840770482384
curr_Factors:  [97.8384077  -0.15611386 -0.90819009]
mat_Sqrt:  [[33.75110863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0004084  -0.02329397 -0.17659196]
Stock Position:  0.00040839759956611855
Bond Position:  [1.06658569]


portfolio before change:  [1.10690091]
curr_Stock_Price:  98.38914656105725
curr_Factors:  [ 9.83891466e+01  6.09171753e-02 -9.43836690e-01]
mat_Sqrt:  [[40.69116465  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00276014 0.00129147 0.19649231]
Stock Position:  0.0027601395187546412
Bond Position:  [0.83533314]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.11021084]
Stock Price:  99.55050461627778
PL:  [1.11021084]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-8.97184785e-03  3.19520296e-02 -5.73160014e-03]
 [-1.65217660e-01 -4.27925539e-02  1.66198844e-01]
 [-3.94816880e-02  5.18577987e-02  2.08126056e-02]
 [ 9.26594217e-02  7.67631672e-02  8.29178750e-02]
 [-8.64499187e-02  2.20229264e-01 -1.68796022e-02]
 [-1.66191601e-02 -1.54578234e-01  8.28353969e-02]
 [-6.43902344e-02 -2.75047588e-01 -1.49555795e-01]
 [-5.92254870e-02  9.52095080e-01  2.25310841e-01]
 [ 2.08255791e-02 -9.10676277e-02 -1.96276438e-02]
 [ 9.25687810e-02  2.39968876e-02 -1.24792409e-02]
 [ 2.11745411e-02 -1.69047133e-01 -7.15670680e-04]
 [-5.64956650e-02 -1.86657486e-02  9.00089956e-02]
 [-3.45921216e-02  1.73056954e-01 -6.98519977e-02]
 [ 7.30055430e-03 -7.05775149e-02  5.80619134e-02]
 [-1.38221861e-01  1.90967009e-01 -3.71314483e-02]
 [-7.08842791e-02 -4.65821357e-02 -1.09602204e-02]
 [ 2.81069025e-02  1.40017792e-01 -1.50630687e-01]
 [ 7.81748276e-02 -2.68816454e-02 -8.67983789e-02]
 [ 4.92600852e-03  1.71916202e-01 -1.05650102e-01]
 [-1.00215050e-01 -4.79865977e-04 -3.64073564e-02]
 [-1.84638164e-02  3.32200787e-01 -2.69919688e-01]
 [ 1.30932280e-01  5.37566631e-02  9.62379953e-02]
 [ 8.30543821e-03 -5.64287306e-02  8.41579493e-02]
 [ 2.04167055e-01  1.98579860e-01 -2.22717146e-01]
 [-2.00939787e-01  7.68254781e-02  1.07795749e-02]
 [-1.61470969e-01 -4.23599962e-02  1.51709796e-01]
 [-6.06802485e-02 -3.43423461e-02 -1.51588727e-02]
 [-8.65630163e-02  1.13352118e-01 -7.74267028e-02]
 [ 7.94635665e-02 -3.24932105e-02  1.31290108e-01]
 [ 4.01204814e-02  4.86713754e-02 -8.54145601e-02]
 [ 2.36339307e-02 -2.12838700e-02 -4.53076966e-02]
 [-1.12626106e-02  1.05418468e-01 -1.26187690e-01]
 [-2.54888639e-02  5.10695285e-02 -6.83614605e-02]
 [ 4.87028101e-02 -4.13422489e-02  1.86531450e-01]
 [-7.39659602e-02  2.46320668e-03 -3.29540108e-02]
 [-1.31798570e-01 -1.55937359e-01 -1.20266814e-01]
 [ 6.28190871e-02  1.04930864e-01  1.89302645e-01]
 [ 1.65869436e-01 -1.19897359e-01 -1.61072886e-01]
 [ 9.96411571e-02  2.63572081e-03  5.58286495e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.56607763]
curr_Stock_Price:  99.24863936633896
curr_Factors:  [99.24863937 -0.91409062 -1.01599017]
mat_Sqrt:  [[14.40459739  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00025128  0.01031247 -0.01635066]
Stock Position:  -0.000251282629423352
Bond Position:  [-3.54113817]


portfolio before change:  [-3.56616675]
curr_Stock_Price:  97.84166809631206
curr_Factors:  [97.8416681  -0.83022469 -0.99374573]
mat_Sqrt:  [[15.79005202  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00886808 -0.01381124  0.47411904]
Stock Position:  -0.008868080747601023
Bond Position:  [-2.69849893]


portfolio before change:  [-3.57779621]
curr_Stock_Price:  99.1150137670847
curr_Factors:  [99.11501377 -0.75894594 -0.99837716]
mat_Sqrt:  [[17.09793734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144157  0.01673703  0.05937257]
Stock Position:  -0.0014415717718226054
Bond Position:  [-3.43491481]


portfolio before change:  [-3.57708948]
curr_Stock_Price:  98.32689888744127
curr_Factors:  [98.32689889 -0.5199535  -0.98711189]
mat_Sqrt:  [[21.78523051  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0057495  0.02477521 0.23654162]
Stock Position:  0.005749499776023679
Bond Position:  [-4.14241996]


portfolio before change:  [-3.58851432]
curr_Stock_Price:  96.4298635124577
curr_Factors:  [96.42986351 -0.69575026 -0.99641296]
mat_Sqrt:  [[17.75474351  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253123  0.07107869 -0.04815281]
Stock Position:  -0.0025312301926988076
Bond Position:  [-3.34442814]


portfolio before change:  [-3.58801935]
curr_Stock_Price:  96.06914930600558
curr_Factors:  [96.06914931 -0.72858522 -1.02159484]
mat_Sqrt:  [[16.69130928  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00187305 -0.04988991  0.23630633]
Stock Position:  -0.0018730469162762625
Bond Position:  [-3.40807733]


portfolio before change:  [-3.58928564]
curr_Stock_Price:  96.51775441856002
curr_Factors:  [96.51775442 -0.86495031 -1.05102202]
mat_Sqrt:  [[14.20728181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01063272 -0.08877123 -0.42664106]
Stock Position:  -0.010632719131065324
Bond Position:  [-2.56303947]


portfolio before change:  [-3.58030603]
curr_Stock_Price:  95.64309436152438
curr_Factors:  [95.64309436 -0.83342188 -1.04132849]
mat_Sqrt:  [[14.67100544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01234486 0.30728737 0.64274911]
Stock Position:  0.012344858773473166
Bond Position:  [-4.76100652]


portfolio before change:  [-3.57646184]
curr_Stock_Price:  96.00270605714567
curr_Factors:  [96.00270606 -0.76476416 -1.05067554]
mat_Sqrt:  [[15.62600752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00011327 -0.02939195 -0.0559922 ]
Stock Position:  -0.0001132726054266404
Bond Position:  [-3.56558736]


portfolio before change:  [-3.57682964]
curr_Stock_Price:  95.31479895688223
curr_Factors:  [95.31479896 -0.64664069 -1.0650242 ]
mat_Sqrt:  [[17.21050919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00551522  0.00774496 -0.0355998 ]
Stock Position:  0.0055152238494665645
Bond Position:  [-4.10251209]


portfolio before change:  [-3.57683401]
curr_Stock_Price:  95.40699429554584
curr_Factors:  [95.4069943  -0.6978485  -1.08183708]
mat_Sqrt:  [[16.09431836  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083745 -0.05455973 -0.00204161]
Stock Position:  -0.0008374474660069359
Bond Position:  [-3.49693566]


portfolio before change:  [-3.57753076]
curr_Stock_Price:  95.71699432889099
curr_Factors:  [95.71699433 -0.7748062  -1.0837241 ]
mat_Sqrt:  [[14.92243165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281005 -0.00602434  0.25677061]
Stock Position:  -0.002810050443432389
Bond Position:  [-3.30856118]


portfolio before change:  [-3.57949681]
curr_Stock_Price:  96.26945850366944
curr_Factors:  [96.2694585  -0.80671459 -1.07838978]
mat_Sqrt:  [[14.61497585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00092545  0.05585389 -0.19926831]
Stock Position:  -0.0009254546964570278
Bond Position:  [-3.49040379]


portfolio before change:  [-3.57878088]
curr_Stock_Price:  95.02438748727378
curr_Factors:  [95.02438749 -0.83318055 -1.05981571]
mat_Sqrt:  [[14.31255766  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00033158 -0.02277879  0.16563448]
Stock Position:  0.00033158418992743137
Bond Position:  [-3.61028947]


portfolio before change:  [-3.57937757]
curr_Stock_Price:  94.58597234426735
curr_Factors:  [94.58597234 -0.8308275  -1.06500386]
mat_Sqrt:  [[14.20619055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00751928  0.06163434 -0.10592569]
Stock Position:  -0.007519278905922412
Bond Position:  [-2.86815926]


portfolio before change:  [-3.58256394]
curr_Stock_Price:  94.96205009205343
curr_Factors:  [94.96205009 -0.94524618 -1.04793812]
mat_Sqrt:  [[12.93960864  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00638582 -0.01503432 -0.03126646]
Stock Position:  -0.006385823992147944
Bond Position:  [-2.97615301]


portfolio before change:  [-3.58097903]
curr_Stock_Price:  94.6555971709921
curr_Factors:  [94.65559717 -0.83915369 -1.01031241]
mat_Sqrt:  [[14.89132623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00174199  0.04519055 -0.42970742]
Stock Position:  0.0017419908844695396
Bond Position:  [-3.74586822]


portfolio before change:  [-3.58283682]
curr_Stock_Price:  93.85793125600541
curr_Factors:  [93.85793126 -0.95517705 -1.00066964]
mat_Sqrt:  [[13.27570373  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00414065 -0.00867601 -0.24761162]
Stock Position:  0.004140646016322834
Bond Position:  [-3.97146929]


portfolio before change:  [-3.58026814]
curr_Stock_Price:  94.5981884192719
curr_Factors:  [94.59818842 -1.23132234 -0.97279346]
mat_Sqrt:  [[10.43872583  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017677   0.05548572 -0.30139033]
Stock Position:  0.0017676984583877172
Bond Position:  [-3.74748921]


portfolio before change:  [-3.58093975]
curr_Stock_Price:  94.48326951638582
curr_Factors:  [94.48326952 -1.05083147 -0.97733223]
mat_Sqrt:  [[12.43181715  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00866684 -0.00015488 -0.10386005]
Stock Position:  -0.008666844222997289
Bond Position:  [-2.76206797]


portfolio before change:  [-3.57910823]
curr_Stock_Price:  94.23210567841394
curr_Factors:  [94.23210568 -1.15313731 -0.98594704]
mat_Sqrt:  [[11.09701992  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.18223849e-04  1.07217343e-01 -7.70005739e-01]
Stock Position:  -0.0005182238491615441
Bond Position:  [-3.53027491]


portfolio before change:  [-3.57947286]
curr_Stock_Price:  94.08413035052574
curr_Factors:  [94.08413035 -0.94562238 -0.98171251]
mat_Sqrt:  [[13.69258577  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01179834 0.01734989 0.27454021]
Stock Position:  0.01179834213262126
Bond Position:  [-4.68950962]


portfolio before change:  [-3.57217869]
curr_Stock_Price:  94.75205435538773
curr_Factors:  [94.75205436 -0.89371501 -0.9710811 ]
mat_Sqrt:  [[14.67972686  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00095136 -0.01821229  0.2400792 ]
Stock Position:  0.00095135566279309
Bond Position:  [-3.66232159]


portfolio before change:  [-3.57315784]
curr_Stock_Price:  94.20406742869261
curr_Factors:  [94.20406743 -1.0004601  -0.96050171]
mat_Sqrt:  [[13.25667973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01502941  0.06409137 -0.63535003]
Stock Position:  0.015029408252918913
Bond Position:  [-4.98898923]


portfolio before change:  [-3.58330944]
curr_Stock_Price:  93.5701143011053
curr_Factors:  [93.5701143  -1.02802245 -0.95017807]
mat_Sqrt:  [[12.94242295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01414399  0.02479532  0.03075113]
Stock Position:  -0.014143988463660167
Bond Position:  [-2.25985482]


portfolio before change:  [-3.59088991]
curr_Stock_Price:  94.08609101216621
curr_Factors:  [94.08609101 -1.03459836 -0.97660947]
mat_Sqrt:  [[12.59125328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01105133 -0.01367163  0.43278582]
Stock Position:  -0.011051325159630445
Bond Position:  [-2.55111393]


portfolio before change:  [-3.5992085]
curr_Stock_Price:  94.80995757086681
curr_Factors:  [94.80995757 -1.11337098 -1.01567009]
mat_Sqrt:  [[11.27776814  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00627648 -0.01108394 -0.04324404]
Stock Position:  -0.006276476127489374
Bond Position:  [-3.00413607]


portfolio before change:  [-3.60536788]
curr_Stock_Price:  95.7314674694945
curr_Factors:  [95.73146747 -0.97724334 -1.04193339]
mat_Sqrt:  [[12.70976163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00623377  0.03658424 -0.22087683]
Stock Position:  -0.006233773215291056
Bond Position:  [-3.00859962]


portfolio before change:  [-3.6058268]
curr_Stock_Price:  95.74475278318072
curr_Factors:  [95.74475278 -0.90098924 -1.01937792]
mat_Sqrt:  [[14.0316946   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00710038 -0.01048714  0.37453413]
Stock Position:  0.0071003825007342125
Bond Position:  [-4.28565116]


portfolio before change:  [-3.60818218]
curr_Stock_Price:  95.48847910812177
curr_Factors:  [95.48847911 -1.01527775 -1.0021914 ]
mat_Sqrt:  [[12.69916769  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0025687   0.01570862 -0.24366397]
Stock Position:  0.0025686967067866003
Bond Position:  [-3.85346312]


portfolio before change:  [-3.60832354]
curr_Stock_Price:  95.62097618871059
curr_Factors:  [95.62097619 -0.7279275  -1.01114607]
mat_Sqrt:  [[16.79898795  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00059771 -0.00686934 -0.12925025]
Stock Position:  0.000597713630197409
Bond Position:  [-3.66547751]


portfolio before change:  [-3.60858832]
curr_Stock_Price:  95.94461412511531
curr_Factors:  [95.94461413 -0.60575283 -1.03780665]
mat_Sqrt:  [[18.54521148  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083591  0.03402366 -0.35997836]
Stock Position:  -0.0008359090533791488
Bond Position:  [-3.52838734]


portfolio before change:  [-3.60883134]
curr_Stock_Price:  95.70768490109569
curr_Factors:  [95.7076849  -0.71536589 -1.02483575]
mat_Sqrt:  [[16.79526428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172778  0.01648262 -0.19501622]
Stock Position:  -0.0017277825646504186
Bond Position:  [-3.44346927]


portfolio before change:  [-3.60890593]
curr_Stock_Price:  95.5017157169897
curr_Factors:  [95.50171572 -0.8395351  -1.01254894]
mat_Sqrt:  [[14.98515688  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0052278  -0.01334315  0.53212231]
Stock Position:  0.005227801898231173
Bond Position:  [-4.10816998]


portfolio before change:  [-3.61164074]
curr_Stock_Price:  95.07682187524861
curr_Factors:  [95.07682188 -0.66699591 -0.99882717]
mat_Sqrt:  [[17.97284741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00446172  0.000795   -0.09400862]
Stock Position:  -0.004461723162619033
Bond Position:  [-3.18743429]


portfolio before change:  [-3.61336023]
curr_Stock_Price:  95.3729036173979
curr_Factors:  [95.37290362 -0.7608911  -0.97717584]
mat_Sqrt:  [[16.77228075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01121961 -0.05032857 -0.34308774]
Stock Position:  -0.01121961370624508
Bond Position:  [-2.5433131]


portfolio before change:  [-3.62046217]
curr_Stock_Price:  95.97755964117417
curr_Factors:  [95.97755964 -1.02423828 -0.98915305]
mat_Sqrt:  [[12.81636762  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00958768 0.03386629 0.54002776]
Stock Position:  0.009587681488968103
Bond Position:  [-4.54066445]


portfolio before change:  [-3.62061958]
curr_Stock_Price:  96.02034552224346
curr_Factors:  [96.02034552 -0.89850157 -1.03062916]
mat_Sqrt:  [[13.94930059  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00777936 -0.03869671 -0.45949611]
Stock Position:  0.007779359545382983
Bond Position:  [-4.36759637]


portfolio before change:  [-3.62250936]
curr_Stock_Price:  95.84760684728356
curr_Factors:  [95.84760685 -0.77353773 -1.05346099]
mat_Sqrt:  [[15.42147135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00723505 0.00085068 0.1592636 ]
Stock Position:  0.0072350519721611295
Bond Position:  [-4.31597177]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.62389283]
Stock Price:  95.73096043484972
PL:  [-3.62389283]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.10554357e-01 -9.14643383e-02  1.56094951e-02]
 [-1.48783343e-01  6.77067156e-02 -1.64824440e-01]
 [-1.94245695e-02  3.16001499e-02  3.27568338e-02]
 [-5.14573533e-01 -2.51009494e-01 -3.14627410e-01]
 [ 2.16533016e-01 -2.22963578e-01 -1.05072022e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.12930301e-02 -1.95964922e-01 -2.97600394e-02]
 [ 7.26929575e-03  6.47570673e-01  9.90461259e-02]
 [ 3.63182918e-01  2.81530120e-02  3.69732945e-01]
 [ 5.18026891e-01  2.20511651e-01  4.08354908e-01]
 [-1.42799554e-01 -1.64420604e-01  4.74012525e-02]
 [-1.24660295e-02 -1.61540085e-02  1.00919676e-01]
 [ 1.35840608e-02 -3.75963920e-02  1.49964228e-02]
 [-6.46709164e-04  2.07427334e-01 -1.48040702e-01]
 [ 4.49495453e-01 -1.35167131e-01 -2.18048715e-01]
 [-1.83803891e-01 -9.46908696e-02  1.13073907e-01]
 [ 5.31177603e-02  7.53056916e-03 -1.71913918e-02]
 [-6.51811290e-02 -6.56347921e-02  1.66833835e-02]
 [ 2.53237622e-01 -3.27816770e-01  1.42713873e-01]
 [ 5.89431734e-02  6.02945341e-03  5.41339381e-01]
 [-7.25420472e-02  7.46784394e-01 -7.18077545e-01]
 [ 4.19560056e-01  2.36198711e-01  5.40555302e-02]
 [-4.11008091e-01  2.25451775e-01 -1.68139592e-01]
 [-7.78729389e-02 -9.54260575e-02 -1.24869897e-02]
 [-1.34379850e-01 -3.15585636e-02  7.24071004e-03]
 [ 5.81549968e-02  3.75304251e-02 -1.46555822e-01]
 [ 6.78595871e-02  2.72422478e-02  4.73130462e-01]
 [ 1.69200954e-01 -5.16844617e-02  2.26524836e-01]
 [ 3.70905789e-02  1.33965057e-01 -2.84082660e-01]
 [-1.05040695e-01  1.60828339e-01 -2.15948885e-01]
 [ 4.05003093e-01  1.29377044e-01  1.50713508e-01]
 [ 2.81707620e-02 -2.60818402e-01 -4.46609562e-01]
 [ 1.82333935e-01 -4.67531599e-02  2.79346586e-01]
 [-5.54035685e-02 -1.97333108e-01 -8.92822631e-01]
 [ 2.96628472e-01  1.16856405e+00 -6.69973152e-01]
 [ 7.89639439e-02  2.29858469e-01  1.07463165e-01]
 [ 1.07283956e+00 -4.86629074e-01  9.94107993e-01]
 [-3.18842933e-01  1.94379546e-01  8.77928945e-02]
 [ 1.14296685e+00 -2.06844010e-01 -1.87327849e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.09184274]
curr_Stock_Price:  100.21409211061061
curr_Factors:  [100.21409211  -0.96978192  -1.01098453]
mat_Sqrt:  [[13.82588233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0091161  -0.02951999  0.04452954]
Stock Position:  -0.00911610258589892
Bond Position:  [5.00540468]


portfolio before change:  [4.09214447]
curr_Stock_Price:  100.24963171239153
curr_Factors:  [100.24963171  -0.99786205  -1.0092678 ]
mat_Sqrt:  [[13.47092336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0125164   0.02185225 -0.47019825]
Stock Position:  -0.012516396291260572
Bond Position:  [5.34690859]


portfolio before change:  [4.09439922]
curr_Stock_Price:  100.12289054981466
curr_Factors:  [100.12289055  -0.90388262  -0.99605053]
mat_Sqrt:  [[14.97624372  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041985  0.0101989   0.09344613]
Stock Position:  -0.0004198486153118466
Bond Position:  [4.13643567]


portfolio before change:  [4.0940981]
curr_Stock_Price:  102.07168951597673
curr_Factors:  [102.07168952  -1.37160346  -0.99983355]
mat_Sqrt:  [[ 9.52803395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06612421 -0.08101297 -0.89754443]
Stock Position:  -0.0661242063759856
Bond Position:  [10.84350757]


portfolio before change:  [4.08962459]
curr_Stock_Price:  102.15984238924139
curr_Factors:  [102.15984239  -1.20523796  -1.03828321]
mat_Sqrt:  [[10.83755587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01380136 -0.07196119 -0.29974123]
Stock Position:  0.0138013617958153
Bond Position:  [2.67967964]


portfolio before change:  [4.09516117]
curr_Stock_Price:  102.53673271836881
curr_Factors:  [102.53673272  -1.27576409  -1.02784741]
mat_Sqrt:  [[10.24315423  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0149665  -0.05534923  0.15513819]
Stock Position:  -0.014966502772880547
Bond Position:  [5.62977746]


portfolio before change:  [4.09468198]
curr_Stock_Price:  102.61577282903549
curr_Factors:  [102.61577283  -1.31516302  -1.05002319]
mat_Sqrt:  [[ 9.63888506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01010168 -0.06324741 -0.08489711]
Stock Position:  -0.010101681286769488
Bond Position:  [5.13127381]


portfolio before change:  [4.09395305]
curr_Stock_Price:  102.75143104878228
curr_Factors:  [102.75143105  -1.06258148  -1.06856185]
mat_Sqrt:  [[12.19674911  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01309134 0.20900254 0.28255103]
Stock Position:  0.013091341808678776
Bond Position:  [2.74879895]


portfolio before change:  [4.09823365]
curr_Stock_Price:  103.05216219362899
curr_Factors:  [103.05216219  -1.29792015  -1.03703425]
mat_Sqrt:  [[ 9.97698444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04454262 0.00908635 1.05474518]
Stock Position:  0.0445426221845457
Bond Position:  [-0.49197988]


portfolio before change:  [4.0456221]
curr_Stock_Price:  101.87239232109796
curr_Factors:  [101.87239232  -1.16149729  -1.02803404]
mat_Sqrt:  [[11.40657155  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05666854 0.07116983 1.16492289]
Stock Position:  0.05666853856800864
Bond Position:  [-1.72733749]


portfolio before change:  [4.04622732]
curr_Stock_Price:  101.88688273807807
curr_Factors:  [101.88688274  -1.37091057  -1.04418868]
mat_Sqrt:  [[ 9.1044559   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01830818 -0.05306652  0.13522258]
Stock Position:  -0.01830818127073593
Bond Position:  [5.91159084]


portfolio before change:  [4.03928085]
curr_Stock_Price:  102.3066659725695
curr_Factors:  [102.30666597  -1.35170825  -1.042473  ]
mat_Sqrt:  [[ 9.33521286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00051811 -0.00521368  0.28789575]
Stock Position:  0.0005181124520343192
Bond Position:  [3.98627449]


portfolio before change:  [4.04016126]
curr_Stock_Price:  103.0441418341698
curr_Factors:  [103.04414183  -1.32829399  -1.06804243]
mat_Sqrt:  [[ 9.38226346  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00095615 -0.01213418  0.04278062]
Stock Position:  0.0009561510908447292
Bond Position:  [3.94163549]


portfolio before change:  [4.04071074]
curr_Stock_Price:  103.10349084246731
curr_Factors:  [103.10349084  -0.90764339  -1.06447137]
mat_Sqrt:  [[14.34811384  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079979  0.06694688 -0.42231892]
Stock Position:  0.0007997940690989575
Bond Position:  [3.95824918]


portfolio before change:  [4.04190138]
curr_Stock_Price:  103.97349017054749
curr_Factors:  [103.97349017  -0.74417006  -1.064355  ]
mat_Sqrt:  [[17.04080744  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02214658 -0.043625   -0.62203229]
Stock Position:  0.022146577941249072
Bond Position:  [1.73924437]


portfolio before change:  [4.06238646]
curr_Stock_Price:  104.88865025383684
curr_Factors:  [104.88865025  -0.67171497  -1.04626955]
mat_Sqrt:  [[18.81989954  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00956708 -0.03056135  0.32256838]
Stock Position:  -0.009567079197009136
Bond Position:  [5.06586448]


portfolio before change:  [4.05679193]
curr_Stock_Price:  105.5396120832882
curr_Factors:  [105.53961208  -0.78856012  -1.02304285]
mat_Sqrt:  [[17.24432971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00296595  0.00243048 -0.04904226]
Stock Position:  0.0029659461401545166
Bond Position:  [3.74376712]


portfolio before change:  [4.05803777]
curr_Stock_Price:  105.80186885654263
curr_Factors:  [105.80186886  -0.48299677  -1.04236685]
mat_Sqrt:  [[23.01634374  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00326608 -0.02118354  0.04759305]
Stock Position:  -0.003266083190980367
Bond Position:  [4.40359547]


portfolio before change:  [4.05226722]
curr_Stock_Price:  107.73722522037225
curr_Factors:  [107.73722522  -0.3759209   -1.05337146]
mat_Sqrt:  [[25.80073037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00835068 -0.10580241  0.40712295]
Stock Position:  0.008350680327997207
Bond Position:  [3.15258809]


portfolio before change:  [4.05059992]
curr_Stock_Price:  107.49037220682462
curr_Factors:  [107.49037221  -0.49374545  -1.04677103]
mat_Sqrt:  [[23.03200581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00741031 0.001946   1.54429057]
Stock Position:  0.007410312861499844
Bond Position:  [3.25406264]


portfolio before change:  [4.0627589]
curr_Stock_Price:  109.07629631176935
curr_Factors:  [109.07629631  -0.39824029  -1.07504429]
mat_Sqrt:  [[24.99718015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266759  0.24102363 -2.04847536]
Stock Position:  -0.0026675923358876674
Bond Position:  [4.35372999]


portfolio before change:  [4.06299508]
curr_Stock_Price:  109.19178218418975
curr_Factors:  [109.19178218  -0.32121088  -1.06933092]
mat_Sqrt:  [[27.18224502  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01761473 0.07623281 0.15420538]
Stock Position:  0.01761473177718954
Bond Position:  [2.13961113]


portfolio before change:  [4.10014239]
curr_Stock_Price:  111.28547534707087
curr_Factors:  [111.28547535  -0.14329209  -1.07735083]
mat_Sqrt:  [[32.83371335  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01216156  0.07276425 -0.47965546]
Stock Position:  -0.012161563518055444
Bond Position:  [5.45354777]


portfolio before change:  [4.10167331]
curr_Stock_Price:  111.21565047081293
curr_Factors:  [111.21565047  -0.26154252  -1.08055452]
mat_Sqrt:  [[29.06033187  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0034377  -0.03079863 -0.03562191]
Stock Position:  -0.003437696372912741
Bond Position:  [4.48399895]


portfolio before change:  [4.09417746]
curr_Stock_Price:  113.55919191510553
curr_Factors:  [113.55919192  -0.27306156  -1.07681894]
mat_Sqrt:  [[29.44263265  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00473272 -0.01018548  0.02065573]
Stock Position:  -0.00473271915543356
Bond Position:  [4.63162122]


portfolio before change:  [4.09150679]
curr_Stock_Price:  114.2458282569116
curr_Factors:  [114.24582826  -0.39283479  -1.0912651 ]
mat_Sqrt:  [[25.90025024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0013861   0.01211289 -0.41808297]
Stock Position:  0.0013860978365203003
Bond Position:  [3.9331509]


portfolio before change:  [4.09362313]
curr_Stock_Price:  115.41794214853297
curr_Factors:  [115.41794215  -0.60250414  -1.10772177]
mat_Sqrt:  [[20.87044221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00814538 0.0087924  1.34970951]
Stock Position:  0.008145382693692834
Bond Position:  [3.15349982]


portfolio before change:  [4.09275775]
curr_Stock_Price:  115.26330352761155
curr_Factors:  [115.26330353  -0.51279501  -1.1376098 ]
mat_Sqrt:  [[22.12734757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00925959 -0.01668109  0.64621231]
Stock Position:  0.009259586820902471
Bond Position:  [3.02546719]


portfolio before change:  [4.11210751]
curr_Stock_Price:  117.31215891345022
curr_Factors:  [117.31215891  -0.5204568   -1.13479323]
mat_Sqrt:  [[22.41181739  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.87703190e-04  4.32370362e-02 -8.10408757e-01]
Stock Position:  0.0002877031897192415
Bond Position:  [4.07835643]


portfolio before change:  [4.11282756]
curr_Stock_Price:  118.04284968989357
curr_Factors:  [118.04284969  -0.59830496  -1.14143261]
mat_Sqrt:  [[20.72436618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00561137  0.05190712 -0.61604206]
Stock Position:  -0.005611372055990847
Bond Position:  [4.77520991]


portfolio before change:  [4.10622583]
curr_Stock_Price:  119.32572094983611
curr_Factors:  [119.32572095  -0.8618661   -1.10448795]
mat_Sqrt:  [[16.70157222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02767262 0.04175626 0.42994369]
Stock Position:  0.02767262453417828
Bond Position:  [0.80416996]


portfolio before change:  [4.14115439]
curr_Stock_Price:  120.58429417510878
curr_Factors:  [120.58429418  -0.78034327  -1.1265167 ]
mat_Sqrt:  [[17.91232596  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00648896 -0.08417878 -1.27405277]
Stock Position:  -0.006488959993075773
Bond Position:  [4.92362105]


portfolio before change:  [4.14121885]
curr_Stock_Price:  120.66921106760901
curr_Factors:  [120.66921107  -0.83624738  -1.1123847 ]
mat_Sqrt:  [[17.19160066  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01336768 -0.01508952  0.79689806]
Stock Position:  0.01336768306957043
Bond Position:  [2.52815108]


portfolio before change:  [4.15339258]
curr_Stock_Price:  121.55625204160955
curr_Factors:  [121.55625204  -0.55781525  -1.1368833 ]
mat_Sqrt:  [[22.32436277  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01244966 -0.06368899 -2.54697445]
Stock Position:  -0.01244965779424334
Bond Position:  [5.66672632]


portfolio before change:  [4.13278013]
curr_Stock_Price:  123.26881568987793
curr_Factors:  [123.26881569  -0.6829078   -1.10243702]
mat_Sqrt:  [[20.67701397  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01926791  0.37715242 -1.91124692]
Stock Position:  0.019267913272489237
Bond Position:  [1.75764728]


portfolio before change:  [4.15304656]
curr_Stock_Price:  124.30923525106309
curr_Factors:  [124.30923525  -0.61544478  -1.0995513 ]
mat_Sqrt:  [[22.37124033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00660757 0.0741865  0.3065625 ]
Stock Position:  0.006607565422581836
Bond Position:  [3.33166516]


portfolio before change:  [4.1517871]
curr_Stock_Price:  124.05559502598359
curr_Factors:  [124.05559503  -0.72781847  -1.09556631]
mat_Sqrt:  [[20.03228119  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05872662 -0.15705886  2.8359134 ]
Stock Position:  0.0587266245085344
Bond Position:  [-3.13357924]


portfolio before change:  [4.09269465]
curr_Stock_Price:  123.0560359272551
curr_Factors:  [123.05603593  -0.77039262  -1.09463707]
mat_Sqrt:  [[19.06034774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01370619  0.06273573  0.25044869]
Stock Position:  -0.013706188828786523
Bond Position:  [5.77932391]


portfolio before change:  [4.07806294]
curr_Stock_Price:  124.17627214317021
curr_Factors:  [124.17627214  -0.82187793  -1.06341725]
mat_Sqrt:  [[18.84800209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05637239 -0.06675862 -0.53439421]
Stock Position:  0.056372386235093136
Bond Position:  [-2.92204983]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.12097596]
Stock Price:  124.94399379989105
PL:  [-20.82301784]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-3.87537875e-01 -1.15631111e-01  2.99042611e-02]
 [-1.40252239e-01  9.07403021e-02 -1.80096503e-01]
 [ 7.84002033e-02 -3.50997585e-02  1.04085424e-01]
 [-2.53435197e-01 -1.61259730e-01 -1.73324037e-01]
 [ 1.95827710e-01 -2.02932424e-01 -1.04782874e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.15099809e-02 -2.05069263e-01 -2.82913781e-02]
 [ 6.49375615e-03  6.50396326e-01  1.00700088e-01]
 [ 4.43300161e-01  6.12437494e-02  4.31156132e-01]
 [ 6.03088663e-01  2.63209455e-01  5.03492730e-01]
 [-6.27650417e-02 -1.88239869e-01 -7.21311008e-03]
 [-3.88448860e-02 -1.82772590e-02  9.22349433e-02]
 [ 1.32589546e-02 -5.62003859e-02  7.68129227e-02]
 [ 5.03411644e-04  1.43767177e-01 -5.07569765e-02]
 [ 3.66148464e-01 -1.52502470e-01 -1.83482885e-01]
 [-2.16007668e-01 -9.63882278e-02  1.19580756e-01]
 [ 5.02484410e-02  1.91005383e-02 -2.08105146e-02]
 [-4.79171511e-02 -5.54227960e-02  4.12642844e-02]
 [ 1.01962987e-01 -8.29034589e-02 -5.52704036e-02]
 [ 2.38085959e-02  1.18462845e-04  6.26769606e-02]
 [-2.60913692e-02  4.30396947e-01 -4.10269735e-01]
 [ 1.61398403e-01  1.12669231e-01  9.60953361e-02]
 [ 1.15897835e-02  1.15163216e-01 -1.94596463e-02]
 [ 2.01537501e-02 -1.54376833e-01 -1.55551630e-01]
 [ 4.79262480e-02  1.01475504e-02 -1.31255939e-02]
 [-2.56430377e-02  1.18493324e-02  7.10028423e-02]
 [ 2.77262781e-02 -3.32855686e-02  8.81304946e-03]
 [ 1.41878271e-01 -7.10630959e-02  6.91324368e-02]
 [-4.24742971e-02 -3.75436199e-03 -5.39452131e-02]
 [-6.13195215e-02 -1.38286533e-02  3.95763696e-02]
 [-3.80275931e-02 -5.45933907e-02 -2.99574954e-02]
 [ 2.63180223e-02 -4.59320353e-02 -1.04297811e-01]
 [ 8.60304859e-02  3.59737017e-03  1.57243223e-01]
 [ 4.67544596e-03 -8.24323902e-02 -9.73778994e-02]
 [ 1.11605535e-02  8.54572908e-02  2.13677606e-02]
 [ 3.59056171e-02  2.49698275e-02  1.27313289e-01]
 [ 3.25380957e-01 -2.11080708e-01  1.84878438e-01]
 [-1.07823402e-01  4.11011646e-02  4.71416607e-02]
 [ 2.42342035e-01 -2.19511944e-02  7.77710867e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.21644035]
curr_Stock_Price:  101.74266977719377
curr_Factors:  [101.74266978  -1.0913617   -0.9943795 ]
mat_Sqrt:  [[12.63796759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0320492  -0.03731978  0.08530853]
Stock Position:  -0.03204920344797823
Bond Position:  [19.47721187]


portfolio before change:  [16.22617723]
curr_Stock_Price:  101.51483029221116
curr_Factors:  [101.51483029  -1.30436535  -1.01700168]
mat_Sqrt:  [[ 9.96259788  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0159087   0.02928631 -0.51376519]
Stock Position:  -0.015908701584873952
Bond Position:  [17.84114637]


portfolio before change:  [16.22211991]
curr_Stock_Price:  101.91006072281712
curr_Factors:  [101.91006072  -1.44220981  -1.02316906]
mat_Sqrt:  [[ 8.65997464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01067923 -0.0113284   0.29692674]
Stock Position:  0.0106792279595735
Bond Position:  [15.13379914]


portfolio before change:  [16.21798454]
curr_Stock_Price:  101.34567482294419
curr_Factors:  [101.34567482  -1.40377546  -1.04090176]
mat_Sqrt:  [[ 8.79215612  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03659305 -0.05204635 -0.49444523]
Stock Position:  -0.036593051602950386
Bond Position:  [19.92653205]


portfolio before change:  [16.20576552]
curr_Stock_Price:  101.74766343759505
curr_Factors:  [101.74766344  -1.24025674  -1.04638576]
mat_Sqrt:  [[10.33827841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01286632 -0.06549616 -0.29891637]
Stock Position:  0.012866319027209933
Bond Position:  [14.89664763]


portfolio before change:  [16.20752961]
curr_Stock_Price:  101.74003790312143
curr_Factors:  [101.7400379   -1.09036571  -1.04435034]
mat_Sqrt:  [[12.03362557  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01273965 -0.05534923  0.15513819]
Stock Position:  -0.012739651504490806
Bond Position:  [17.50366224]


portfolio before change:  [16.20084936]
curr_Stock_Price:  102.4361593329366
curr_Factors:  [102.43615933  -1.04698951  -1.04232031]
mat_Sqrt:  [[12.67878271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00781972 -0.06618582 -0.08070743]
Stock Position:  -0.007819719332603635
Bond Position:  [17.00187138]


portfolio before change:  [16.1967545]
curr_Stock_Price:  103.23161364374477
curr_Factors:  [103.23161364  -0.90959682  -1.04729004]
mat_Sqrt:  [[14.58638092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01095616 0.20991451 0.28726932]
Stock Position:  0.010956156329516274
Bond Position:  [15.0657328]


portfolio before change:  [16.19117423]
curr_Stock_Price:  102.55038900309188
curr_Factors:  [102.550389    -0.84264268  -1.05086988]
mat_Sqrt:  [[15.43815003  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03522513 0.01976634 1.22996843]
Stock Position:  0.03522513153987801
Bond Position:  [12.57882329]


portfolio before change:  [16.19105078]
curr_Stock_Price:  102.50224457414782
curr_Factors:  [102.50224457  -0.94606456  -1.052786  ]
mat_Sqrt:  [[13.88812475  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05469357 0.08495049 1.43632461]
Stock Position:  0.05469356770295288
Bond Position:  [10.58483733]


portfolio before change:  [16.26212973]
curr_Stock_Price:  103.77763692609145
curr_Factors:  [103.77763693  -0.86182432  -1.0558804 ]
mat_Sqrt:  [[15.24948586  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00673214 -0.06075416 -0.020577  ]
Stock Position:  -0.006732142636395752
Bond Position:  [16.96077558]


portfolio before change:  [16.27325022]
curr_Stock_Price:  102.44072836382755
curr_Factors:  [102.44072836  -0.91285973  -1.06309721]
mat_Sqrt:  [[14.2012136   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00167228 -0.00589896  0.26312062]
Stock Position:  -0.001672275174039167
Bond Position:  [16.44455931]


portfolio before change:  [16.27511935]
curr_Stock_Price:  102.55229113964197
curr_Factors:  [102.55229114  -0.87347044  -1.07961059]
mat_Sqrt:  [[14.5456473   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012008  -0.0181386   0.21912589]
Stock Position:  0.0012008039729826856
Bond Position:  [16.15197415]


portfolio before change:  [16.27742084]
curr_Stock_Price:  102.78743878872277
curr_Factors:  [102.78743879  -1.34666947  -1.05825785]
mat_Sqrt:  [[ 9.2788335   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210038  0.04640066 -0.14479553]
Stock Position:  0.002100376014152379
Bond Position:  [16.06152857]


portfolio before change:  [16.28029051]
curr_Stock_Price:  103.1977699989113
curr_Factors:  [103.19777     -1.02066651  -1.03520132]
mat_Sqrt:  [[13.20742827  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02253018 -0.04921996 -0.5234256 ]
Stock Position:  0.022530180346999305
Bond Position:  [13.95522614]


portfolio before change:  [16.28018202]
curr_Stock_Price:  103.11552482447001
curr_Factors:  [103.11552482  -1.03837541  -1.00803023]
mat_Sqrt:  [[13.32236666  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01585856 -0.03110917  0.34113061]
Stock Position:  -0.01585855713016262
Bond Position:  [17.91544546]


portfolio before change:  [16.26526635]
curr_Stock_Price:  104.19729072777213
curr_Factors:  [104.19729073  -1.26556778  -1.01695536]
mat_Sqrt:  [[10.63088013  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00469382  0.00616467 -0.05936661]
Stock Position:  0.004693815838773378
Bond Position:  [15.77618345]


portfolio before change:  [16.26381672]
curr_Stock_Price:  103.46829519315351
curr_Factors:  [103.46829519  -1.16216157  -1.01207852]
mat_Sqrt:  [[11.76377798  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00431896 -0.01788763  0.11771552]
Stock Position:  -0.004318956482061126
Bond Position:  [16.71069179]


portfolio before change:  [16.27109433]
curr_Stock_Price:  102.266930745418
curr_Factors:  [102.26693075  -0.93383319  -1.03366277]
mat_Sqrt:  [[14.2975815   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0051588  -0.02675698 -0.15767108]
Stock Position:  0.005158800112796733
Bond Position:  [15.74351968]


portfolio before change:  [16.26916713]
curr_Stock_Price:  101.51185968463335
curr_Factors:  [101.51185968  -0.95022814  -1.01882306]
mat_Sqrt:  [[14.16996287  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.58480974e-03 3.82337188e-05 1.78799923e-01]
Stock Position:  0.0025848097387243894
Bond Position:  [16.00677829]


portfolio before change:  [16.27195372]
curr_Stock_Price:  101.8157949997196
curr_Factors:  [101.815795    -1.25981892  -1.02935445]
mat_Sqrt:  [[10.31905181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213032  0.13891002 -1.17038536]
Stock Position:  -0.0021303235670085676
Bond Position:  [16.48885431]


portfolio before change:  [16.2721866]
curr_Stock_Price:  102.67404937002298
curr_Factors:  [102.67404937  -1.30539833  -1.03346367]
mat_Sqrt:  [[ 9.90161031  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02060395 0.03636384 0.27413325]
Stock Position:  0.02060395079833093
Bond Position:  [14.15669553]


portfolio before change:  [16.27488093]
curr_Stock_Price:  102.71892621665164
curr_Factors:  [102.71892622  -1.17282275  -1.04594263]
mat_Sqrt:  [[11.16999326  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0027865   0.03716877 -0.05551295]
Stock Position:  0.0027865005909376394
Bond Position:  [15.98865459]


portfolio before change:  [16.27914282]
curr_Stock_Price:  103.53111854107026
curr_Factors:  [103.53111854  -1.00971734  -1.04267854]
mat_Sqrt:  [[13.29617436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0032423  -0.04982491 -0.4437455 ]
Stock Position:  -0.003242295972233123
Bond Position:  [16.61482134]


portfolio before change:  [16.28485448]
curr_Stock_Price:  102.41009707882037
curr_Factors:  [102.41009708  -0.82107533  -1.01873023]
mat_Sqrt:  [[16.26767085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00290874  0.00327511 -0.03744367]
Stock Position:  0.0029087358534282833
Bond Position:  [15.98697056]


portfolio before change:  [16.28630173]
curr_Stock_Price:  102.22058190243524
curr_Factors:  [102.2205819   -0.96632685  -1.05230786]
mat_Sqrt:  [[13.57864508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064299  0.00382436  0.20255135]
Stock Position:  -0.0006429881868291449
Bond Position:  [16.35202835]


portfolio before change:  [16.28910171]
curr_Stock_Price:  101.0450562808226
curr_Factors:  [101.04505628  -0.74108705  -1.07330984]
mat_Sqrt:  [[16.46389215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138065 -0.01074287  0.02514118]
Stock Position:  0.0013806483789335488
Bond Position:  [16.14959401]


portfolio before change:  [16.29279253]
curr_Stock_Price:  102.2560770646481
curr_Factors:  [102.25607706  -0.82974733  -1.07577144]
mat_Sqrt:  [[15.21012701  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00930197 -0.02293552  0.1972156 ]
Stock Position:  0.009301972102394356
Bond Position:  [15.34160935]


portfolio before change:  [16.31374146]
curr_Stock_Price:  104.30199969125252
curr_Factors:  [104.30199969  -0.95626529  -1.07386554]
mat_Sqrt:  [[13.69676545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00396095 -0.00121172 -0.15389068]
Stock Position:  -0.003960947841615492
Bond Position:  [16.72687624]


portfolio before change:  [16.31614027]
curr_Stock_Price:  104.22428591394504
curr_Factors:  [104.22428591  -1.27464558  -1.09037428]
mat_Sqrt:  [[ 9.7916043   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0057257  -0.00446318  0.11290037]
Stock Position:  -0.005725700226298438
Bond Position:  [16.91289729]


portfolio before change:  [16.32076431]
curr_Stock_Price:  103.78594842769023
curr_Factors:  [103.78594843  -1.07788117  -1.0784865 ]
mat_Sqrt:  [[12.01268193  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460234 -0.01761994 -0.0854604 ]
Stock Position:  -0.0046023419885410505
Bond Position:  [16.79842274]


portfolio before change:  [16.3212417]
curr_Stock_Price:  104.13849446398146
curr_Factors:  [104.13849446  -1.02789882  -1.1004912 ]
mat_Sqrt:  [[12.39547734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035073 -0.0148245  -0.29753262]
Stock Position:  -0.0003507341114730552
Bond Position:  [16.35776663]


portfolio before change:  [16.32347645]
curr_Stock_Price:  103.5970721963507
curr_Factors:  [103.5970722   -1.29980201  -1.10133413]
mat_Sqrt:  [[ 9.38744283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0126618  0.00116105 0.44857115]
Stock Position:  0.012661801175239545
Bond Position:  [15.01175092]


portfolio before change:  [16.324704]
curr_Stock_Price:  103.54581331511329
curr_Factors:  [103.54581332  -1.13487909  -1.10803581]
mat_Sqrt:  [[10.99124733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291397 -0.02660494 -0.27779204]
Stock Position:  -0.0029139709765002926
Bond Position:  [16.6264335]


portfolio before change:  [16.32647923]
curr_Stock_Price:  103.64986568001441
curr_Factors:  [103.64986568  -0.84543817  -1.14093166]
mat_Sqrt:  [[14.21998989  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00231829 0.02758122 0.06095627]
Stock Position:  0.002318294602520465
Bond Position:  [16.08618831]


portfolio before change:  [16.33030293]
curr_Stock_Price:  104.43182005239467
curr_Factors:  [104.43182005  -1.00780795  -1.1402852 ]
mat_Sqrt:  [[12.18787098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00549647 0.00805898 0.36318938]
Stock Position:  0.0054964708908141705
Bond Position:  [15.75629647]


portfolio before change:  [16.33309103]
curr_Stock_Price:  104.58072298427476
curr_Factors:  [104.58072298  -1.07225653  -1.12756256]
mat_Sqrt:  [[11.58997096  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02761288 -0.06812601  0.52740672]
Stock Position:  0.027612876862666346
Bond Position:  [13.44531641]


portfolio before change:  [16.35822774]
curr_Stock_Price:  105.43017952117691
curr_Factors:  [105.43017952  -0.90978562  -1.11384623]
mat_Sqrt:  [[13.93518705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0064449   0.01326534  0.13448204]
Stock Position:  -0.006444901706426359
Bond Position:  [17.03771489]


portfolio before change:  [16.35972576]
curr_Stock_Price:  105.52821533387397
curr_Factors:  [105.52821533  -0.9222317   -1.09643758]
mat_Sqrt:  [[14.01753543  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01810134 -0.00708472  0.22185926]
Stock Position:  0.018101343407584666
Bond Position:  [14.44952329]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.35144495]
Stock Price:  104.97095749674533
PL:  [11.38048745]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 5.44131561e-02 -2.66651515e-02  2.72469198e-03]
 [-1.24366863e-01  1.83528211e-02  1.59115477e-01]
 [-3.23026943e-02  5.36567915e-02  2.73530049e-02]
 [ 9.89351739e-02  3.12032651e-02  1.26497400e-01]
 [ 9.09814873e-02 -4.50839159e-02 -8.34895856e-02]
 [-1.30156482e-01 -1.60782354e-01  1.14935539e-01]
 [-6.03155633e-02 -1.86040139e-01  1.02338300e-01]
 [-8.13672234e-04  7.30631715e-01  1.19595996e-01]
 [ 3.18895461e-01  9.47232539e-03  3.25242379e-01]
 [ 4.36346583e-01  1.78428457e-01  3.13504778e-01]
 [-7.64097448e-02 -9.94418916e-02  7.31165214e-02]
 [-7.46032877e-03 -1.58018318e-02  1.02527607e-01]
 [ 1.47580176e-02 -5.35434878e-02  5.66706718e-02]
 [ 5.21182858e-03  3.05585659e-02 -8.83780182e-02]
 [ 2.04802467e-01 -1.51598105e-01 -1.34362823e-01]
 [-4.24137458e-02 -4.43570177e-02  7.91533348e-02]
 [ 4.93941822e-02  2.06337210e-02 -1.58141553e-02]
 [-3.34888548e-02 -4.68881635e-02  6.18076681e-02]
 [ 8.33448974e-02 -5.20148388e-02 -8.10303988e-02]
 [ 3.14931245e-02 -1.36908715e-02  1.12127734e-01]
 [-3.58487226e-02  5.02699711e-01 -4.86274555e-01]
 [ 1.22208434e-01  9.39169627e-02  1.02477146e-01]
 [ 1.23845750e-02  8.79079612e-02 -3.01132586e-03]
 [-1.50879825e-02 -1.52181545e-01 -8.88555896e-02]
 [ 2.95238068e-02 -2.16870233e-02 -1.09205985e-02]
 [-1.81316701e-02  1.37758694e-02  5.78310816e-02]
 [ 7.41032616e-02 -3.11358437e-02  2.74140005e-02]
 [ 1.42963746e-01 -7.18271593e-02  7.10800199e-02]
 [-4.84136317e-02 -2.84719222e-02 -6.22780110e-03]
 [-6.12041734e-02 -7.84577582e-03  2.76523443e-02]
 [ 3.64130334e-03 -4.33998457e-02 -5.02938742e-02]
 [ 1.46563891e-02  2.25565292e-02 -3.45108681e-02]
 [ 2.96462583e-02  1.43902557e-02  1.35941417e-01]
 [ 2.19656892e-02 -5.57716095e-02  6.27859222e-02]
 [-6.06998492e-02 -2.00890816e-02  6.77389851e-03]
 [ 7.54410562e-02 -4.01686775e-02  1.12050122e-01]
 [-3.89246721e-02  8.73790846e-02  3.44905871e-02]
 [-2.44737809e-03 -4.39615522e-02 -1.23653615e-02]
 [ 9.74605611e-02  3.98665504e-03  6.87373440e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.09423873]
curr_Stock_Price:  99.68634258518976
curr_Factors:  [99.68634259 -0.67206241 -1.02366029]
mat_Sqrt:  [[18.28911335  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00270797 -0.00860614  0.00777279]
Stock Position:  0.0027079678096672273
Bond Position:  [-0.36418613]


portfolio before change:  [-0.09706317]
curr_Stock_Price:  98.66014347346874
curr_Factors:  [98.66014347 -0.49385001 -1.03226633]
mat_Sqrt:  [[21.44656977  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00410981  0.00592335  0.45391217]
Stock Position:  -0.0041098086913719046
Bond Position:  [0.30841115]


portfolio before change:  [-0.09715524]
curr_Stock_Price:  98.69192708278521
curr_Factors:  [98.69192708 -0.69005868 -1.03598267]
mat_Sqrt:  [[17.5659401   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00089757  0.01731765  0.07803051]
Stock Position:  -0.0008975687479385707
Bond Position:  [-0.00857245]


portfolio before change:  [-0.09876277]
curr_Stock_Price:  100.48171756181976
curr_Factors:  [100.48171756  -0.89087982  -1.03338124]
mat_Sqrt:  [[14.66868191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00893916 0.01007081 0.36086187]
Stock Position:  0.008939159510586957
Bond Position:  [-0.99698487]


portfolio before change:  [-0.09866255]
curr_Stock_Price:  100.50687060348447
curr_Factors:  [100.5068706   -1.00350854  -1.03183264]
mat_Sqrt:  [[13.12980603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0049305  -0.01455077 -0.23817255]
Stock Position:  0.004930501719436552
Bond Position:  [-0.59421185]


portfolio before change:  [-0.10061507]
curr_Stock_Price:  100.12592958606757
curr_Factors:  [100.12592959  -0.91554126  -1.05659997]
mat_Sqrt:  [[13.93338084  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.010013   -0.05189228  0.3278791 ]
Stock Position:  -0.010012998663547676
Bond Position:  [0.90194573]


portfolio before change:  [-0.09786251]
curr_Stock_Price:  99.86229213944843
curr_Factors:  [99.86229214 -0.79604339 -1.04780401]
mat_Sqrt:  [[15.7989702   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00489912 -0.0600442   0.29194269]
Stock Position:  -0.004899124978635664
Bond Position:  [0.39137534]


portfolio before change:  [-0.10254952]
curr_Stock_Price:  100.82898091691024
curr_Factors:  [100.82898092  -0.71293069  -1.08173407]
mat_Sqrt:  [[16.75607797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.010309   0.23581037 0.34117409]
Stock Position:  0.010308995506923777
Bond Position:  [-1.14199503]


portfolio before change:  [-0.09723052]
curr_Stock_Price:  101.35878530616692
curr_Factors:  [101.35878531  -1.04119497  -1.10693477]
mat_Sqrt:  [[11.82879502  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03273527 0.00305718 0.92782598]
Stock Position:  0.032735271298285976
Bond Position:  [-3.41523786]


portfolio before change:  [-0.09794261]
curr_Stock_Price:  101.35007446703729
curr_Factors:  [101.35007447  -1.28548993  -1.1076456 ]
mat_Sqrt:  [[ 9.25760229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05798068 0.05758754 0.89434187]
Stock Position:  0.0579806754540178
Bond Position:  [-5.97428838]


portfolio before change:  [-0.06944239]
curr_Stock_Price:  101.8545020718859
curr_Factors:  [101.85450207  -1.34202304  -1.12755622]
mat_Sqrt:  [[ 8.61897423  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00948876 -0.03209473  0.20858108]
Stock Position:  -0.009488761229664196
Bond Position:  [0.89703066]


portfolio before change:  [-0.06993135]
curr_Stock_Price:  101.91785029349
curr_Factors:  [101.91785029  -1.27404282  -1.12745755]
mat_Sqrt:  [[ 9.23191713  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00110947 -0.00510002  0.29248273]
Stock Position:  0.0011094657676438385
Bond Position:  [-0.18300571]


portfolio before change:  [-0.06984451]
curr_Stock_Price:  102.01674113122955
curr_Factors:  [102.01674113  -1.20458991  -1.16139606]
mat_Sqrt:  [[ 9.57495617  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00160798 -0.01728109  0.16166565]
Stock Position:  0.0016079813957106954
Bond Position:  [-0.23388553]


portfolio before change:  [-0.07034363]
curr_Stock_Price:  101.72451882609398
curr_Factors:  [101.72451883  -1.24773346  -1.16353914]
mat_Sqrt:  [[ 9.12479803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072226  0.00986273 -0.25211789]
Stock Position:  -0.0007222645011575322
Bond Position:  [0.00312837]


portfolio before change:  [-0.0704217]
curr_Stock_Price:  101.83314626916827
curr_Factors:  [101.83314627  -1.22683701  -1.20045157]
mat_Sqrt:  [[ 8.9894087   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01628927 -0.04892808 -0.38329973]
Stock Position:  0.016289273550117563
Bond Position:  [-1.72920968]


portfolio before change:  [-0.07407824]
curr_Stock_Price:  101.62194147674231
curr_Factors:  [101.62194148  -1.25815979  -1.19084446]
mat_Sqrt:  [[ 8.77805821  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00402264 -0.01431617  0.22580243]
Stock Position:  -0.004022641050332107
Bond Position:  [0.33471035]


portfolio before change:  [-0.07690767]
curr_Stock_Price:  102.33571877941232
curr_Factors:  [102.33571878  -1.17982787  -1.17994549]
mat_Sqrt:  [[ 9.6647516   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00521255  0.0066595  -0.04511338]
Stock Position:  0.0052125469985295535
Bond Position:  [-0.61033741]


portfolio before change:  [-0.07864256]
curr_Stock_Price:  102.01752523216963
curr_Factors:  [102.01752523  -1.26908149  -1.17948704]
mat_Sqrt:  [[ 8.81606903  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00345317 -0.01513309  0.17632007]
Stock Position:  -0.0034531743761007684
Bond Position:  [0.27364174]


portfolio before change:  [-0.07627431]
curr_Stock_Price:  101.34161175603177
curr_Factors:  [101.34161176  -1.07923849  -1.18941747]
mat_Sqrt:  [[10.48390415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00535937 -0.01678772 -0.23115717]
Stock Position:  0.005359372922831927
Bond Position:  [-0.6194018]


portfolio before change:  [-0.07283648]
curr_Stock_Price:  101.99751962831873
curr_Factors:  [101.99751963  -1.00424794  -1.15673214]
mat_Sqrt:  [[11.75135343  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00438983 -0.00441871  0.31986922]
Stock Position:  0.004389831793581521
Bond Position:  [-0.52058844]


portfolio before change:  [-0.0720484]
curr_Stock_Price:  102.191870028849
curr_Factors:  [102.19187003  -0.84065157  -1.15986186]
mat_Sqrt:  [[13.82306674  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00235085  0.16224563 -1.38720595]
Stock Position:  -0.002350849658853958
Bond Position:  [0.16818933]


portfolio before change:  [-0.07209066]
curr_Stock_Price:  102.21879191749193
curr_Factors:  [102.21879192  -0.85499596  -1.15866636]
mat_Sqrt:  [[13.64609236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01189331 0.03031157 0.29233877]
Stock Position:  0.011893310508508292
Bond Position:  [-1.28781049]


portfolio before change:  [-0.07806726]
curr_Stock_Price:  101.729809877853
curr_Factors:  [101.72980988  -0.7174805   -1.14670519]
mat_Sqrt:  [[15.77039882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00188416  0.02837217 -0.00859047]
Stock Position:  0.0018841646560862856
Bond Position:  [-0.26974297]


portfolio before change:  [-0.07683432]
curr_Stock_Price:  102.40207462429812
curr_Factors:  [102.40207462  -0.85271978  -1.13896943]
mat_Sqrt:  [[13.97426965  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460056 -0.04911638 -0.25348026]
Stock Position:  -0.004600561117443801
Bond Position:  [0.39427268]


portfolio before change:  [-0.08436921]
curr_Stock_Price:  104.05060603665204
curr_Factors:  [104.05060604  -0.71603079  -1.14410074]
mat_Sqrt:  [[16.19570121  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00141197 -0.00699946 -0.03115343]
Stock Position:  0.0014119675056630946
Bond Position:  [-0.23128528]


portfolio before change:  [-0.08655005]
curr_Stock_Price:  102.52654056913896
curr_Factors:  [102.52654057  -0.87566545  -1.13740053]
mat_Sqrt:  [[13.69534121  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00025665  0.00444614  0.16497598]
Stock Position:  -0.0002566538776252041
Bond Position:  [-0.06023622]


portfolio before change:  [-0.08662768]
curr_Stock_Price:  102.79967354428874
curr_Factors:  [102.79967354  -1.03343485  -1.14210928]
mat_Sqrt:  [[11.67252793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00628343 -0.01004905  0.07820451]
Stock Position:  0.006283432686710418
Bond Position:  [-0.73256251]


portfolio before change:  [-0.08962396]
curr_Stock_Price:  102.33739337789056
curr_Factors:  [102.33739338  -1.04445618  -1.10394716]
mat_Sqrt:  [[11.93973356  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01196101 -0.02318212  0.20277151]
Stock Position:  0.011961007005115126
Bond Position:  [-1.31368224]


portfolio before change:  [-0.09797659]
curr_Stock_Price:  101.65280150422588
curr_Factors:  [101.6528015   -1.07877827  -1.098212  ]
mat_Sqrt:  [[11.52562517  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00481507 -0.00918927 -0.01776618]
Stock Position:  -0.004815069223895497
Bond Position:  [0.39148868]


portfolio before change:  [-0.0970553]
curr_Stock_Price:  101.47162948866332
curr_Factors:  [101.47162949  -1.01268847  -1.06268204]
mat_Sqrt:  [[12.73569564  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00448826 -0.00253221  0.07888444]
Stock Position:  -0.004488264806823392
Bond Position:  [0.35837625]


portfolio before change:  [-0.09038136]
curr_Stock_Price:  99.99463735357507
curr_Factors:  [99.99463735 -1.13637589 -1.04419658]
mat_Sqrt:  [[11.29707776  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137061 -0.01400724 -0.14347442]
Stock Position:  -0.0013706064060342242
Bond Position:  [0.04667193]


portfolio before change:  [-0.0904607]
curr_Stock_Price:  100.0567739650623
curr_Factors:  [100.05677397  -1.2309086   -1.06927573]
mat_Sqrt:  [[10.02972755  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.001218    0.00728009 -0.0984499 ]
Stock Position:  0.001218001169196725
Bond Position:  [-0.21232996]


portfolio before change:  [-0.09090607]
curr_Stock_Price:  99.71290866194457
curr_Factors:  [99.71290866 -1.12328223 -1.09705042]
mat_Sqrt:  [[10.82612818  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00557287 0.00464444 0.38780302]
Stock Position:  0.005572867929972745
Bond Position:  [-0.64659294]


portfolio before change:  [-0.09004907]
curr_Stock_Price:  99.88119228445566
curr_Factors:  [99.88119228 -1.18643913 -1.06306119]
mat_Sqrt:  [[10.53266178  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00222142 -0.01800021  0.17911076]
Stock Position:  0.0022214213517235313
Bond Position:  [-0.31192729]


portfolio before change:  [-0.09036233]
curr_Stock_Price:  99.75772906708276
curr_Factors:  [99.75772907 -1.3225785  -1.04280868]
mat_Sqrt:  [[ 9.3685408   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00676923 -0.00648372  0.01932405]
Stock Position:  -0.006769229162286599
Bond Position:  [0.5849206]


portfolio before change:  [-0.08757981]
curr_Stock_Price:  99.35747695193773
curr_Factors:  [99.35747695 -1.42111355 -1.02341687]
mat_Sqrt:  [[ 8.62093722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0104529  -0.01296438  0.31964781]
Stock Position:  0.010452899983689803
Bond Position:  [-1.12615358]


portfolio before change:  [-0.09124041]
curr_Stock_Price:  99.02074583497229
curr_Factors:  [99.02074583 -1.21607113 -1.01619747]
mat_Sqrt:  [[10.62341767  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132237  0.02820148  0.09839204]
Stock Position:  -0.0013223738267289394
Bond Position:  [0.03970204]


portfolio before change:  [-0.09152725]
curr_Stock_Price:  99.24141601672515
curr_Factors:  [99.24141602 -0.97055895 -0.99048321]
mat_Sqrt:  [[13.96442847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00099861 -0.01418853 -0.03527493]
Stock Position:  -0.000998613099211844
Bond Position:  [0.00757653]


portfolio before change:  [-0.09029667]
curr_Stock_Price:  98.01007668896574
curr_Factors:  [98.01007669 -0.81478495 -0.98714586]
mat_Sqrt:  [[16.16970588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00694541 0.00128669 0.19608851]
Stock Position:  0.006945412993787599
Bond Position:  [-0.77101713]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.08717115]
Stock Price:  98.47396716071631
PL:  [-0.08717115]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.76478068e-01 -5.50486442e-02  4.40327082e-03]
 [-2.15742164e-01  9.32298486e-02 -3.81399385e-01]
 [-2.11931531e-02  3.34719664e-02  3.15066134e-02]
 [ 1.21330240e-01  2.94751591e-02  1.47392296e-01]
 [ 1.15253951e-02  8.70915494e-02 -6.29198931e-02]
 [-1.29886142e-01 -1.64605307e-01  9.33229655e-02]
 [-5.42891219e-02 -1.55286387e-01  2.49073931e-03]
 [-1.81741365e-02  7.60421086e-01  1.47062956e-01]
 [ 1.74106666e-01 -5.73241300e-02  1.39694560e-01]
 [ 4.04577749e-01  1.54143986e-01  2.51064888e-01]
 [-1.88265485e-01 -1.82959344e-01  5.23625658e-02]
 [-3.30094715e-02 -1.78531732e-02  9.29204665e-02]
 [ 8.25874959e-03 -5.95541220e-02  1.24452518e-01]
 [ 8.77401146e-03 -2.55824578e-02 -1.44568810e-01]
 [ 1.65303879e-02 -1.50239771e-02 -7.11191643e-02]
 [ 2.83997840e-02 -2.43011310e-02  5.13395830e-02]
 [ 4.66209599e-02  2.56109676e-02  4.05771792e-04]
 [-5.46808633e-02 -6.34211495e-02  7.17754643e-03]
 [ 5.82160533e-02 -1.62221257e-02 -1.14644416e-01]
 [ 1.88930971e-02  6.14502580e-03  3.27366362e-02]
 [-2.34526470e-02  3.87946066e-01 -3.45247094e-01]
 [ 5.95693735e-02  5.98574976e-02  1.17335651e-01]
 [-5.66515084e-04 -2.19945700e-02  6.28004403e-02]
 [ 1.25468511e-01 -9.62779670e-02 -2.77532264e-01]
 [ 3.43905424e-02  1.65605078e-02 -1.28440421e-02]
 [-4.98218307e-02 -5.42741788e-03  1.62843943e-01]
 [-1.77712273e-02 -3.24906510e-02  1.34701192e-03]
 [-8.46812976e-02  7.45913576e-02 -2.04238526e-01]
 [-5.94048850e-02 -3.39660731e-02 -3.05699105e-03]
 [-3.69016993e-02  1.06801024e-02 -4.05086696e-03]
 [ 3.45117167e-02 -4.45150368e-02 -9.26556126e-02]
 [ 7.05273353e-03  7.12044240e-02 -7.69824756e-02]
 [-3.82638688e-02  2.84722005e-02 -1.21745546e-01]
 [ 3.61141610e-02 -3.77740772e-02  1.52862458e-01]
 [-6.27912866e-02  3.40474577e-02 -1.75473619e-02]
 [ 8.18704359e-02 -2.96864216e-02  1.24996778e-01]
 [-4.77947377e-02  9.17397209e-02  3.00691903e-02]
 [-2.35567472e-02 -3.43789156e-02  6.82696024e-03]
 [ 9.46115066e-02  5.75171630e-03  8.56031811e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.95850887]
curr_Stock_Price:  99.4513094904015
curr_Factors:  [99.45130949 -1.01686509 -0.99295738]
mat_Sqrt:  [[13.32771507  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01246576 -0.01776687  0.01256131]
Stock Position:  0.012465762013723026
Bond Position:  [-3.19824522]


portfolio before change:  [-1.95223425]
curr_Stock_Price:  99.98672948779836
curr_Factors:  [99.98672949 -1.22739151 -1.00175365]
mat_Sqrt:  [[10.76061072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0255157   0.0300898  -1.08802628]
Stock Position:  -0.02551570085422445
Bond Position:  [0.59899722]


portfolio before change:  [-1.95926798]
curr_Stock_Price:  100.2653268893715
curr_Factors:  [100.26532689  -1.15439519  -1.02681777]
mat_Sqrt:  [[11.32040645  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00070046  0.01080303  0.0898796 ]
Stock Position:  -0.0007004568278562765
Bond Position:  [-1.88903645]


portfolio before change:  [-1.9594125]
curr_Stock_Price:  100.13451618373962
curr_Factors:  [100.13451618  -1.05640838  -1.03752008]
mat_Sqrt:  [[12.33679154  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01276127 0.00951307 0.42046919]
Stock Position:  0.012761272484885108
Bond Position:  [-3.23725635]


portfolio before change:  [-1.96708622]
curr_Stock_Price:  99.56489891549045
curr_Factors:  [99.56489892 -1.05734025 -1.02214302]
mat_Sqrt:  [[12.445093    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00132256  0.02810868 -0.17949294]
Stock Position:  0.0013225625379432043
Bond Position:  [-2.09876703]


portfolio before change:  [-1.96615321]
curr_Stock_Price:  100.46872994195633
curr_Factors:  [100.46872994  -1.07740007  -1.00729967]
mat_Sqrt:  [[12.4927291   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01156165 -0.05312613  0.26622444]
Stock Position:  -0.01156165217071097
Bond Position:  [-0.8045687]


portfolio before change:  [-1.96921209]
curr_Stock_Price:  100.72460155295849
curr_Factors:  [100.72460155  -0.94911758  -1.03392943]
mat_Sqrt:  [[13.86465879  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0061652  -0.05011847  0.00710539]
Stock Position:  -0.0061652006134370356
Bond Position:  [-1.34822471]


portfolio before change:  [-1.96569532]
curr_Stock_Price:  100.12684252090484
curr_Factors:  [100.12684252  -0.59136078  -1.04261381]
mat_Sqrt:  [[19.53999151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00854992 0.24542485 0.41952968]
Stock Position:  0.008549915064887632
Bond Position:  [-2.82177132]


portfolio before change:  [-1.98639417]
curr_Stock_Price:  97.74715819524837
curr_Factors:  [97.7471582  -0.32225403 -1.01527991]
mat_Sqrt:  [[25.65786571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00744101 -0.01850128  0.3985097 ]
Stock Position:  0.007441010956577579
Bond Position:  [-2.71373184]


portfolio before change:  [-1.97319131]
curr_Stock_Price:  99.56708519121764
curr_Factors:  [99.56708519 -0.6441293  -1.01593758]
mat_Sqrt:  [[18.93031788  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02574128 0.04974976 0.71621824]
Stock Position:  0.025741282686948225
Bond Position:  [-4.53617579]


portfolio before change:  [-1.95302732]
curr_Stock_Price:  100.37244674767324
curr_Factors:  [100.37244675  -0.79834673  -1.02560255]
mat_Sqrt:  [[16.19882099  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01326784 -0.05904987  0.14937583]
Stock Position:  -0.013267844695541466
Bond Position:  [-0.62130129]


portfolio before change:  [-1.96065989]
curr_Stock_Price:  100.94186061382925
curr_Factors:  [100.94186061  -0.94386684  -1.01715798]
mat_Sqrt:  [[14.20394712  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124518 -0.00576209  0.26507623]
Stock Position:  -0.001245176729841336
Bond Position:  [-1.83496943]


portfolio before change:  [-1.96012697]
curr_Stock_Price:  100.32965736386896
curr_Factors:  [100.32965736  -0.77067801  -1.00369314]
mat_Sqrt:  [[17.01491285  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00126395 -0.01922101  0.35502839]
Stock Position:  0.0012639547029826416
Bond Position:  [-2.08693911]


portfolio before change:  [-1.95917305]
curr_Stock_Price:  101.29077371179643
curr_Factors:  [101.29077371  -0.81440096  -0.99985274]
mat_Sqrt:  [[16.5062917   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00157261 -0.0082567  -0.41241457]
Stock Position:  -0.0015726106811637238
Bond Position:  [-1.79988209]


portfolio before change:  [-1.9571444]
curr_Stock_Price:  99.85771387943709
curr_Factors:  [99.85771388 -0.92198796 -0.96401003]
mat_Sqrt:  [[15.14617947  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.95559691e-05 -4.84896775e-03 -2.02883180e-01]
Stock Position:  -6.955596907663425e-05
Bond Position:  [-1.9501987]


portfolio before change:  [-1.95740118]
curr_Stock_Price:  100.04448006290694
curr_Factors:  [100.04448006  -0.89650593  -0.95638539]
mat_Sqrt:  [[15.68529367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00216247 -0.00784316  0.14645754]
Stock Position:  0.002162470501602218
Bond Position:  [-2.17374442]


portfolio before change:  [-1.95919774]
curr_Stock_Price:  99.33934883508545
curr_Factors:  [99.33934884 -1.03875096 -0.973522  ]
mat_Sqrt:  [[13.28012815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00391047 0.0082659  0.00115755]
Stock Position:  0.003910474659593659
Bond Position:  [-2.34766175]


portfolio before change:  [-1.95812323]
curr_Stock_Price:  99.6891749061466
curr_Factors:  [99.68917491 -1.12938384 -0.97939729]
mat_Sqrt:  [[12.10085316  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00546751 -0.02046909  0.02047554]
Stock Position:  -0.005467510420028236
Bond Position:  [-1.41307163]


portfolio before change:  [-1.95963748]
curr_Stock_Price:  99.93382031835034
curr_Factors:  [99.93382032 -1.12095589 -0.97496012]
mat_Sqrt:  [[12.28761883  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0025638  -0.00523567 -0.32704861]
Stock Position:  0.0025638028609591738
Bond Position:  [-2.21584809]


portfolio before change:  [-1.96153841]
curr_Stock_Price:  99.300413515121
curr_Factors:  [99.30041352 -1.19267287 -0.95266575]
mat_Sqrt:  [[11.6209688   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00230874 0.0019833  0.09338851]
Stock Position:  0.0023087389340667366
Bond Position:  [-2.19079714]


portfolio before change:  [-1.96219544]
curr_Stock_Price:  99.1344482359439
curr_Factors:  [99.13444824 -1.2644333  -0.99667558]
mat_Sqrt:  [[10.33326301  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00142615  0.12520905 -0.98489386]
Stock Position:  -0.0014261473567179419
Bond Position:  [-1.82081511]


portfolio before change:  [-1.96174581]
curr_Stock_Price:  98.65956895476633
curr_Factors:  [98.65956895 -1.32744089 -1.00750812]
mat_Sqrt:  [[ 9.55176749  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01002315 0.01931892 0.33472595]
Stock Position:  0.010023147399064295
Bond Position:  [-2.95062521]


portfolio before change:  [-1.96128179]
curr_Stock_Price:  98.74266390742856
curr_Factors:  [98.74266391 -1.42842936 -1.0254806 ]
mat_Sqrt:  [[ 8.48760746  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00091462 -0.00709872  0.17915218]
Stock Position:  0.0009146215045644739
Bond Position:  [-2.05159395]


portfolio before change:  [-1.96168675]
curr_Stock_Price:  98.5803078826777
curr_Factors:  [98.58030788 -1.48715981 -1.03284628]
mat_Sqrt:  [[ 7.93168451  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00619853 -0.03107358 -0.7917223 ]
Stock Position:  0.006198534098411664
Bond Position:  [-2.57274015]


portfolio before change:  [-1.95979645]
curr_Stock_Price:  98.93715178270061
curr_Factors:  [98.93715178 -1.56730921 -1.04045343]
mat_Sqrt:  [[ 7.29159399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0048205   0.00534488 -0.03664048]
Stock Position:  0.004820504649320377
Bond Position:  [-2.43672345]


portfolio before change:  [-1.95863031]
curr_Stock_Price:  99.24225595246679
curr_Factors:  [99.24225595 -1.48087193 -1.0405555 ]
mat_Sqrt:  [[ 7.97360306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221848 -0.00175169  0.46454844]
Stock Position:  -0.00221848478269983
Bond Position:  [-1.73846287]


portfolio before change:  [-1.95782542]
curr_Stock_Price:  98.78148655250305
curr_Factors:  [98.78148655 -1.27660388 -1.02139206]
mat_Sqrt:  [[ 9.92358521  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243142 -0.01048631  0.00384265]
Stock Position:  -0.0024314192363371913
Bond Position:  [-1.71764621]


portfolio before change:  [-1.95730407]
curr_Stock_Price:  98.47875551104244
curr_Factors:  [98.47875551 -1.39770565 -1.02557734]
mat_Sqrt:  [[ 8.72818863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01273408  0.02407426 -0.58263566]
Stock Position:  -0.012734075718252602
Bond Position:  [-0.70326814]


portfolio before change:  [-1.96267498]
curr_Stock_Price:  98.89362596978214
curr_Factors:  [98.89362597 -1.4969072  -1.00608702]
mat_Sqrt:  [[ 8.0934134   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00827366 -0.0109625  -0.00872074]
Stock Position:  -0.008273664397354424
Bond Position:  [-1.14446231]


portfolio before change:  [-1.96282357]
curr_Stock_Price:  98.89429403709532
curr_Factors:  [98.89429404 -1.55038209 -0.99984336]
mat_Sqrt:  [[ 7.72009059  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460468  0.00344699 -0.011556  ]
Stock Position:  -0.004604675533083297
Bond Position:  [-1.50744744]


portfolio before change:  [-1.96278818]
curr_Stock_Price:  98.84568317281823
curr_Factors:  [98.84568317 -1.25579763 -1.01717906]
mat_Sqrt:  [[10.18161035  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00063957 -0.01436717 -0.26432067]
Stock Position:  0.0006395722169339245
Bond Position:  [-2.02600713]


portfolio before change:  [-1.963277]
curr_Stock_Price:  98.47738712562233
curr_Factors:  [98.47738713 -0.94824181 -0.98298439]
mat_Sqrt:  [[14.27629899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0004114   0.02298113 -0.21960957]
Stock Position:  0.0004114017019651557
Bond Position:  [-2.00379076]


portfolio before change:  [-1.96374147]
curr_Stock_Price:  97.95724741435
curr_Factors:  [97.95724741 -0.55259802 -0.96701881]
mat_Sqrt:  [[21.43262503  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267364  0.00918936 -0.34730616]
Stock Position:  -0.00267364406967299
Bond Position:  [-1.70183866]


portfolio before change:  [-1.96325848]
curr_Stock_Price:  97.69702650739131
curr_Factors:  [97.69702651 -0.55968569 -0.96868514]
mat_Sqrt:  [[21.18938393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00281303 -0.01219153  0.43607404]
Stock Position:  0.00281303498550723
Bond Position:  [-2.23808363]


portfolio before change:  [-1.96098065]
curr_Stock_Price:  98.60622514179025
curr_Factors:  [98.60622514 -0.74829272 -0.97518313]
mat_Sqrt:  [[17.59577026  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337713  0.01098877 -0.05005774]
Stock Position:  -0.003377130856378234
Bond Position:  [-1.62797452]


portfolio before change:  [-1.963995]
curr_Stock_Price:  99.43854318099498
curr_Factors:  [99.43854318 -0.95893623 -0.97835832]
mat_Sqrt:  [[14.32842373  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00707165 -0.00958125  0.35658101]
Stock Position:  0.0070716488318623245
Bond Position:  [-2.66718946]


portfolio before change:  [-1.96774429]
curr_Stock_Price:  98.95550694338748
curr_Factors:  [98.95550694 -1.05468602 -0.96286114]
mat_Sqrt:  [[13.15922676  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174255  0.02960887  0.08577903]
Stock Position:  -0.0017425490253443038
Bond Position:  [-1.79530946]


portfolio before change:  [-1.96925846]
curr_Stock_Price:  99.69565379453202
curr_Factors:  [99.69565379 -1.14374801 -0.99060525]
mat_Sqrt:  [[11.79609831  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247376 -0.01109575  0.01947542]
Stock Position:  -0.002473764268925341
Bond Position:  [-1.72263491]


portfolio before change:  [-1.96898853]
curr_Stock_Price:  99.49948745091177
curr_Factors:  [99.49948745 -1.20994414 -0.95245193]
mat_Sqrt:  [[11.44732894  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00989395 0.00185636 0.24420205]
Stock Position:  0.009893945343373673
Bond Position:  [-2.95343102]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.97232878]
Stock Price:  99.19919795733892
PL:  [-1.97232878]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.53721063e-01 -8.72504174e-02  2.03685297e-02]
 [-1.17142243e-01  7.00288663e-02 -1.23593096e-01]
 [-1.56699118e-02 -8.34449270e-03  2.96366284e-02]
 [-2.25053677e-01 -7.68607066e-02 -1.22778584e-01]
 [ 1.82537431e-01 -1.90074868e-01 -1.04597276e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.25169173e-02 -1.61677010e-01 -2.72387749e-02]
 [ 1.20685404e-04  7.25615146e-01  1.17423551e-01]
 [ 2.63054333e-01 -1.54476876e-02  2.61785894e-01]
 [ 3.94469932e-01  1.49927751e-01  2.42527133e-01]
 [-1.46437317e-01 -2.09969532e-01  2.03497962e-02]
 [-8.04901775e-02 -1.94959107e-02  8.70345107e-02]
 [-1.83581088e-02  8.65420228e-02  1.12175415e-02]
 [ 6.79918527e-03 -6.02217228e-02  5.95172587e-02]
 [-1.22462450e-01  1.92446088e-01 -3.79135778e-02]
 [-1.34067336e-01 -6.06497166e-02 -3.20494747e-02]
 [ 3.07348744e-02  1.33835461e-01 -1.50118607e-01]
 [ 1.61314912e-02 -4.54365662e-02 -4.68625900e-02]
 [ 8.05205746e-03  1.82182945e-01 -1.06031379e-01]
 [-7.77290061e-02 -1.61164484e-02 -2.44829765e-02]
 [-3.10820373e-02  4.17714095e-01 -3.52694812e-01]
 [ 2.31589242e-01  1.39648948e-01  9.21950915e-02]
 [ 5.62847347e-03 -4.98707435e-02  7.97945442e-02]
 [ 1.27509866e-01  1.50591121e-01 -1.71322339e-01]
 [-1.82838789e-01  6.51160649e-02  8.96229703e-03]
 [-1.69153122e-01 -4.45904710e-02  1.41255665e-01]
 [-6.98962361e-02 -3.47400526e-02 -1.87040019e-02]
 [-9.41728441e-02  1.29631928e-01 -5.27399639e-02]
 [ 1.58159136e-01  2.42386980e-02  1.81055476e-01]
 [ 7.33625747e-02  6.24377930e-02 -1.18104394e-01]
 [ 2.38740748e-02 -9.86420952e-03 -2.99309656e-02]
 [-4.40022272e-02  4.08286947e-02 -1.33665510e-01]
 [-2.20700431e-02  5.15112075e-02  2.72315670e-03]
 [ 4.35622979e-02 -3.08814379e-02  1.78470623e-01]
 [-7.18653272e-02  5.99979500e-03 -2.91799399e-02]
 [-8.07269692e-02 -1.22513933e-01 -6.61938359e-02]
 [ 1.33921140e-02  1.02707491e-01  1.26843500e-01]
 [ 1.07780543e-01 -9.50778296e-02 -1.05665244e-01]
 [ 9.76045183e-02  3.89746993e-03  6.78851460e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.37699654]
curr_Stock_Price:  100.62825948284839
curr_Factors:  [100.62825948  -1.21767428  -0.9832295 ]
mat_Sqrt:  [[11.13985647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01502472 -0.02815995  0.05810575]
Stock Position:  -0.015024724194770186
Bond Position:  [8.88890838]


portfolio before change:  [7.38210885]
curr_Stock_Price:  100.36195655890717
curr_Factors:  [100.36195656  -0.75476061  -0.99684522]
mat_Sqrt:  [[17.41230927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00735549  0.02260172 -0.3525767 ]
Stock Position:  -0.007355485898983117
Bond Position:  [8.1203198]


portfolio before change:  [7.37937115]
curr_Stock_Price:  100.87216156688821
curr_Factors:  [100.87216157  -0.70398974  -0.98567239]
mat_Sqrt:  [[18.61917302  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060817 -0.00269317  0.08454505]
Stock Position:  -0.0006081727015898929
Bond Position:  [7.44071884]


portfolio before change:  [7.37969733]
curr_Stock_Price:  101.86523998623136
curr_Factors:  [101.86523999  -0.61426003  -1.00690724]
mat_Sqrt:  [[20.13548105  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01320082 -0.02480669 -0.35025312]
Stock Position:  -0.0132008207871666
Bond Position:  [8.72440211]


portfolio before change:  [7.37962463]
curr_Stock_Price:  101.95336495740415
curr_Factors:  [101.95336496  -0.45273061  -1.0107166 ]
mat_Sqrt:  [[23.59578962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00518685 -0.0613464  -0.29838691]
Stock Position:  0.005186846196883891
Bond Position:  [6.8508082]


portfolio before change:  [7.37491961]
curr_Stock_Price:  100.88114747633131
curr_Factors:  [100.88114748  -0.64106462  -1.04225583]
mat_Sqrt:  [[18.7392943   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00818089 -0.05534923  0.15513819]
Stock Position:  -0.008180894844522103
Bond Position:  [8.20021766]


portfolio before change:  [7.37207867]
curr_Stock_Price:  101.35371558144382
curr_Factors:  [101.35371558  -0.8713156   -1.04161516]
mat_Sqrt:  [[14.96457551  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00608632 -0.05218103 -0.07770464]
Stock Position:  -0.006086319675151291
Bond Position:  [7.98894978]


portfolio before change:  [7.37686059]
curr_Stock_Price:  100.73211729193956
curr_Factors:  [100.73211729  -0.71121356  -1.04998369]
mat_Sqrt:  [[17.30970707  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00994848 0.23419128 0.33497671]
Stock Position:  0.009948477934660934
Bond Position:  [6.37472935]


portfolio before change:  [7.37061795]
curr_Stock_Price:  100.02451828213671
curr_Factors:  [100.02451828  -0.81756813  -1.04610443]
mat_Sqrt:  [[15.51399907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02019711 -0.00498572  0.74680229]
Stock Position:  0.020197107588772554
Bond Position:  [5.35041199]


portfolio before change:  [7.35154971]
curr_Stock_Price:  99.04729515053495
curr_Factors:  [99.04729515 -0.45735447 -1.03738734]
mat_Sqrt:  [[22.21695323  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02136114 0.04838897 0.6918624 ]
Stock Position:  0.02136114004866321
Bond Position:  [5.23578657]


portfolio before change:  [7.3058229]
curr_Stock_Price:  96.87600043632116
curr_Factors:  [96.87600044 -0.50597046 -1.01843691]
mat_Sqrt:  [[21.09475528  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00877674 -0.06776738  0.0580523 ]
Stock Position:  -0.008776744801757067
Bond Position:  [8.15607883]


portfolio before change:  [7.3003067]
curr_Stock_Price:  97.62066923344507
curr_Factors:  [97.62066923 -0.53508332 -1.04065075]
mat_Sqrt:  [[20.19338715  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330326 -0.00629228  0.24828523]
Stock Position:  -0.003303255568978281
Bond Position:  [7.62277272]


portfolio before change:  [7.30215097]
curr_Stock_Price:  97.35082661946369
curr_Factors:  [97.35082662 -0.51365482 -1.03052139]
mat_Sqrt:  [[20.78320101  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [7.68398800e-05 2.79313178e-02 3.20005235e-02]
Stock Position:  7.683987995198456e-05
Bond Position:  [7.29467054]


portfolio before change:  [7.30301253]
curr_Stock_Price:  96.69589939172275
curr_Factors:  [96.69589939 -0.50652938 -1.02190067]
mat_Sqrt:  [[20.97100875  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00031736 -0.01943648  0.16978617]
Stock Position:  0.0003173613260308681
Bond Position:  [7.272325]


portfolio before change:  [7.3034237]
curr_Stock_Price:  95.12692966290741
curr_Factors:  [95.12692966 -0.5357892  -1.03901155]
mat_Sqrt:  [[19.69591687  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00461612  0.06211171 -0.10815688]
Stock Position:  -0.004616115813925115
Bond Position:  [7.74254063]


portfolio before change:  [7.30746469]
curr_Stock_Price:  94.46119478836377
curr_Factors:  [94.46119479 -0.57153156 -1.01484131]
mat_Sqrt:  [[19.3330534   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00791336 -0.01957461 -0.09142823]
Stock Position:  -0.007913363497906783
Bond Position:  [8.05497046]


portfolio before change:  [7.30520062]
curr_Stock_Price:  94.8745462294144
curr_Factors:  [94.87454623 -0.78619977 -1.01678701]
mat_Sqrt:  [[15.63588635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00175309  0.04319521 -0.4282466 ]
Stock Position:  0.001753088412116558
Bond Position:  [7.13887716]


portfolio before change:  [7.30736467]
curr_Stock_Price:  95.59991513680411
curr_Factors:  [95.59991514 -0.95406123 -1.04495733]
mat_Sqrt:  [[12.95074571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00020918 -0.01466459 -0.13368593]
Stock Position:  -0.00020917677240294406
Bond Position:  [7.32736196]


portfolio before change:  [7.30841249]
curr_Stock_Price:  94.96963463394013
curr_Factors:  [94.96963463 -0.77048062 -1.04440429]
mat_Sqrt:  [[15.46643661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00152565  0.05879929 -0.30247801]
Stock Position:  0.0015256539856139926
Bond Position:  [7.16352169]


portfolio before change:  [7.31011851]
curr_Stock_Price:  95.50089680182117
curr_Factors:  [95.5008968  -1.02387327 -1.03689363]
mat_Sqrt:  [[12.16263725  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00707218 -0.00520156 -0.06984312]
Stock Position:  -0.007072177461794616
Bond Position:  [7.9855178]


portfolio before change:  [7.30889578]
curr_Stock_Price:  95.81494181208252
curr_Factors:  [95.81494181 -0.75112066 -1.02635747]
mat_Sqrt:  [[16.19885427  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109946  0.13481664 -1.00614013]
Stock Position:  -0.001099462423341136
Bond Position:  [7.41424071]


portfolio before change:  [7.30965196]
curr_Stock_Price:  95.97015773757
curr_Factors:  [95.97015774 -0.7258208  -1.01417779]
mat_Sqrt:  [[16.84474426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01655794 0.0450715  0.26300693]
Stock Position:  0.016557936634670655
Bond Position:  [5.72058417]


portfolio before change:  [7.31540047]
curr_Stock_Price:  96.27414444502334
curr_Factors:  [96.27414445 -0.90094202 -1.03296245]
mat_Sqrt:  [[13.91956381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00084318 -0.01609571  0.22763162]
Stock Position:  0.0008431761133285972
Bond Position:  [7.23422442]


portfolio before change:  [7.31549982]
curr_Stock_Price:  95.31943299578532
curr_Factors:  [95.319433   -0.87080473 -0.99232951]
mat_Sqrt:  [[14.79219194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.008334    0.04860308 -0.48873495]
Stock Position:  0.008333999742759203
Bond Position:  [6.52110769]


portfolio before change:  [7.30532482]
curr_Stock_Price:  94.00071531534626
curr_Factors:  [94.00071532 -0.89757207 -1.01155786]
mat_Sqrt:  [[13.93177858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01203849  0.02101612  0.02556694]
Stock Position:  -0.012038492090875895
Bond Position:  [8.43695168]


portfolio before change:  [7.30763651]
curr_Stock_Price:  93.89629983141934
curr_Factors:  [93.89629983 -0.8073492  -1.0124565 ]
mat_Sqrt:  [[15.2165748   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00981965 -0.01439151  0.40296309]
Stock Position:  -0.009819648890181259
Bond Position:  [8.2296652]


portfolio before change:  [7.3074748]
curr_Stock_Price:  94.01753385191863
curr_Factors:  [94.01753385 -0.94378269 -1.02838544]
mat_Sqrt:  [[13.08299323  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00617637 -0.0112123  -0.05335731]
Stock Position:  -0.006176373907901821
Bond Position:  [7.88816225]


portfolio before change:  [7.30781918]
curr_Stock_Price:  94.12142995029518
curr_Factors:  [94.12142995 -0.91936572 -0.9960754 ]
mat_Sqrt:  [[13.86190794  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00566137  0.04183852 -0.15045244]
Stock Position:  -0.00566136624656021
Bond Position:  [7.84067507]


portfolio before change:  [7.30986306]
curr_Stock_Price:  93.93353670319961
curr_Factors:  [93.9335367  -0.93379966 -0.9789406 ]
mat_Sqrt:  [[13.8716503   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01442255 0.00782301 0.51650088]
Stock Position:  0.014422554615655319
Bond Position:  [5.9551015]


portfolio before change:  [7.31395099]
curr_Stock_Price:  94.1653604588367
curr_Factors:  [94.16536046 -1.06231965 -0.95374702]
mat_Sqrt:  [[12.54077979  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00494385  0.02015171 -0.33691896]
Stock Position:  0.004943845482143114
Bond Position:  [6.84841199]


portfolio before change:  [7.31550996]
curr_Stock_Price:  94.30752985502318
curr_Factors:  [94.30752986 -1.04857694 -0.96692313]
mat_Sqrt:  [[12.56683206  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00125337 -0.00318366 -0.08538471]
Stock Position:  0.0012533722577073724
Bond Position:  [7.19730751]


portfolio before change:  [7.31687899]
curr_Stock_Price:  94.68197520220943
curr_Factors:  [94.6819752  -1.13994019 -0.94074895]
mat_Sqrt:  [[11.82049041  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00532571  0.0131774  -0.3813105 ]
Stock Position:  -0.00532570651581644
Bond Position:  [7.82112741]


portfolio before change:  [7.31293572]
curr_Stock_Price:  95.6059793560506
curr_Factors:  [95.60597936 -1.13205108 -0.95961781]
mat_Sqrt:  [[11.8055112   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093173  0.01662517  0.00776841]
Stock Position:  -0.0009317258439095893
Bond Position:  [7.40201428]


portfolio before change:  [7.31367775]
curr_Stock_Price:  95.80268667632237
curr_Factors:  [95.80268668 -1.10442637 -0.93529639]
mat_Sqrt:  [[12.46055399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00591377 -0.00996694  0.50912701]
Stock Position:  0.005913767083494592
Bond Position:  [6.74712298]


portfolio before change:  [7.31690966]
curr_Stock_Price:  96.2065678100591
curr_Factors:  [96.20656781 -0.70690636 -0.88470246]
mat_Sqrt:  [[19.5874452   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00391051  0.00193643 -0.08324225]
Stock Position:  -0.003910512762529725
Bond Position:  [7.69312667]


portfolio before change:  [7.31569468]
curr_Stock_Price:  96.76319005204151
curr_Factors:  [96.76319005 -0.66017898 -0.87212586]
mat_Sqrt:  [[20.90444499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00570437 -0.0395412  -0.18883259]
Stock Position:  -0.005704374415838878
Bond Position:  [7.86766814]


portfolio before change:  [7.31623818]
curr_Stock_Price:  96.8403266692658
curr_Factors:  [96.84032667 -0.49419715 -0.84682853]
mat_Sqrt:  [[25.331225    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00237845 0.0331487  0.3618492 ]
Stock Position:  0.0023784484842080994
Bond Position:  [7.08590845]


portfolio before change:  [7.31783066]
curr_Stock_Price:  97.13744584824268
curr_Factors:  [97.13744585 -0.42796174 -0.81084952]
mat_Sqrt:  [[28.14347911  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00237369 -0.03068624 -0.30143353]
Stock Position:  0.0023736949828460406
Bond Position:  [7.08725599]


portfolio before change:  [7.31040375]
curr_Stock_Price:  93.635363391524
curr_Factors:  [93.63536339 -0.32338082 -0.81151323]
mat_Sqrt:  [[30.09966593  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00372951 0.0012579  0.19365743]
Stock Position:  0.003729512604644095
Bond Position:  [6.96118948]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.31297647]
Stock Price:  94.09186318737103
PL:  [7.31297647]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.56363919e-01 -4.78384280e-02  3.75457200e-03]
 [-1.90274559e-01  4.87118801e-02 -1.09670202e-01]
 [-3.81045463e-02  5.21828900e-02  2.21913183e-02]
 [ 1.20871846e-01  3.19487113e-02  1.44901892e-01]
 [ 3.12877920e-02  4.76473295e-02 -7.03607853e-02]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.76775470e-02 -1.68391822e-01  6.94211638e-02]
 [-2.08477353e-03  7.11645964e-01  1.18169063e-01]
 [ 1.73024028e-01 -5.42054877e-02  1.58000813e-01]
 [ 3.58500634e-01  1.34924017e-01  2.12145003e-01]
 [-2.24392216e-01 -2.36731568e-01  2.62855469e-02]
 [-6.79781870e-02 -1.90630209e-02  8.85855623e-02]
 [ 3.29257266e-03 -5.26215392e-02  1.43705475e-01]
 [ 1.95615671e-03  1.73307089e-01 -2.35721060e-01]
 [ 3.64149039e-01 -1.17987529e-01 -1.96156763e-01]
 [-2.03097548e-01 -9.57077766e-02  1.16972236e-01]
 [ 5.11981031e-02  1.73961302e-02 -2.63648657e-02]
 [-5.85452954e-02 -6.17095608e-02  2.61316559e-02]
 [ 1.18530550e-01 -1.24412594e-01 -2.96031148e-02]
 [ 2.85952349e-02 -1.19314268e-02  1.01867542e-01]
 [-3.75502763e-02  5.13576509e-01 -4.96165469e-01]
 [ 3.46324224e-01  2.01155612e-01  6.59814693e-02]
 [-1.99057351e-02  3.56455822e-02  2.74538328e-02]
 [ 4.02968790e-02 -1.29300727e-01 -2.10128213e-01]
 [ 3.94291598e-02  1.38826387e-02 -1.26524773e-02]
 [-5.39676128e-02 -3.43154475e-03  1.59809298e-01]
 [-5.12350910e-03 -3.26217419e-02  2.25280606e-03]
 [ 1.13170343e-01 -6.45166331e-02 -1.19711933e-02]
 [-5.19115432e-02 -3.95509545e-02  1.45177684e-02]
 [-8.27666869e-02 -1.97891013e-03  3.52092314e-02]
 [ 1.09568778e-02 -4.34776803e-02 -5.98830744e-02]
 [ 1.63849018e-02  6.88348314e-02 -6.15515986e-02]
 [-8.43842643e-03  2.17748220e-02 -1.13968312e-03]
 [ 3.00276349e-02 -4.54859350e-02  1.14439738e-01]
 [-6.63138314e-02 -2.59557969e-03 -1.28716822e-02]
 [ 5.62069979e-02 -3.57910875e-02  9.55662047e-02]
 [-5.42277480e-02  7.25307231e-02 -1.67530936e-02]
 [-6.10058979e-03 -4.26415330e-02 -8.62999977e-03]
 [ 9.52092441e-02  5.38140280e-03  8.20646936e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.66422153]
curr_Stock_Price:  99.48841101432485
curr_Factors:  [99.48841101 -0.95286118 -1.00039957]
mat_Sqrt:  [[14.10854184  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01044511 -0.01543979  0.01071075]
Stock Position:  0.010445114826080655
Bond Position:  [-2.70338941]


portfolio before change:  [-1.66980506]
curr_Stock_Price:  98.98620671173127
curr_Factors:  [98.98620671 -0.89627714 -0.98518142]
mat_Sqrt:  [[15.08230137  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01344076  0.01572169 -0.31285856]
Stock Position:  -0.013440762055973976
Bond Position:  [-0.33935501]


portfolio before change:  [-1.6738345]
curr_Stock_Price:  99.28284292203014
curr_Factors:  [99.28284292 -0.99632928 -0.97748648]
mat_Sqrt:  [[13.79294211  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166194  0.01684196  0.06330565]
Stock Position:  -0.001661935096469995
Bond Position:  [-1.50883286]


portfolio before change:  [-1.67506117]
curr_Stock_Price:  99.90744797951461
curr_Factors:  [99.90744798 -1.11050898 -0.96551384]
mat_Sqrt:  [[12.53119844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01252644 0.0103114  0.41336477]
Stock Position:  0.012526441522487244
Bond Position:  [-2.92654597]


portfolio before change:  [-1.6769989]
curr_Stock_Price:  99.78196204903516
curr_Factors:  [99.78196205 -1.00678773 -0.9435632 ]
mat_Sqrt:  [[14.19140495  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.001878    0.01537811 -0.20071974]
Stock Position:  0.0018779978004304259
Bond Position:  [-1.8643892]


portfolio before change:  [-1.67506818]
curr_Stock_Price:  100.93413462545338
curr_Factors:  [100.93413463  -0.78596259  -0.95784004]
mat_Sqrt:  [[17.64876041  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0086864  -0.05534923  0.15513819]
Stock Position:  -0.00868640021011975
Bond Position:  [-0.7983139]


portfolio before change:  [-1.67114802]
curr_Stock_Price:  100.47134669972132
curr_Factors:  [100.4713467   -0.53063296  -0.9523178 ]
mat_Sqrt:  [[22.80367759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00341523 -0.05434823  0.19803926]
Stock Position:  -0.0034152319363395657
Bond Position:  [-1.32801507]


portfolio before change:  [-1.67128714]
curr_Stock_Price:  100.46347379636181
curr_Factors:  [100.4634738   -0.62983435  -0.93389506]
mat_Sqrt:  [[21.03241461  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00795441 0.22968275 0.33710345]
Stock Position:  0.007954412880635734
Bond Position:  [-2.47041509]


portfolio before change:  [-1.68716767]
curr_Stock_Price:  98.50585501337822
curr_Factors:  [98.50585501 -0.57426973 -0.93215062]
mat_Sqrt:  [[21.83896225  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00889287 -0.01749475  0.45073234]
Stock Position:  0.008892874921108268
Bond Position:  [-2.56316792]


portfolio before change:  [-1.68056938]
curr_Stock_Price:  99.283860414242
curr_Factors:  [99.28386041 -0.83660678 -0.97479052]
mat_Sqrt:  [[16.22552659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02646113 0.04354654 0.60519064]
Stock Position:  0.02646113200502
Bond Position:  [-4.30773272]


portfolio before change:  [-1.68619023]
curr_Stock_Price:  99.09179212100575
curr_Factors:  [99.09179212 -0.81051531 -0.96763515]
mat_Sqrt:  [[16.74159182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01596917 -0.07640479  0.07498535]
Stock Position:  -0.015969170272757623
Bond Position:  [-0.10377653]


portfolio before change:  [-1.69605639]
curr_Stock_Price:  99.70880550308797
curr_Factors:  [99.7088055  -0.60718824 -0.96712917]
mat_Sqrt:  [[20.65456959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260412 -0.00615256  0.25270995]
Stock Position:  -0.0026041190285933215
Bond Position:  [-1.4364028]


portfolio before change:  [-1.69704455]
curr_Stock_Price:  100.01931104366815
curr_Factors:  [100.01931104  -0.34504974  -0.98070744]
mat_Sqrt:  [[26.56530648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00082382 -0.01698353  0.40995172]
Stock Position:  0.0008238189644730188
Bond Position:  [-1.77944235]


portfolio before change:  [-1.69477655]
curr_Stock_Price:  103.04236213837251
curr_Factors:  [103.04236214  -0.23574918  -0.9697978 ]
mat_Sqrt:  [[30.86408484  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.49404232e-04  5.59346224e-02 -6.72446573e-01]
Stock Position:  -0.0003494042323500476
Bond Position:  [-1.65877311]


portfolio before change:  [-1.69493783]
curr_Stock_Price:  102.91048894243467
curr_Factors:  [102.91048894  -0.27731926  -0.95016799]
mat_Sqrt:  [[30.15565042  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0099492  -0.03808031 -0.55958065]
Stock Position:  0.009949200241125592
Bond Position:  [-2.71881489]


portfolio before change:  [-1.6913267]
curr_Stock_Price:  103.30760597505818
curr_Factors:  [103.30760598  -0.51229906  -0.94102057]
mat_Sqrt:  [[24.15258416  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00822922 -0.03088955  0.33368923]
Stock Position:  -0.008229221219978768
Bond Position:  [-0.84118556]


portfolio before change:  [-1.70492504]
curr_Stock_Price:  104.94727245784598
curr_Factors:  [104.94727246  -0.67939772  -0.92646596]
mat_Sqrt:  [[21.0646098   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00234362  0.00561458 -0.07521162]
Stock Position:  0.002343616526008901
Bond Position:  [-1.9508812]


portfolio before change:  [-1.70683001]
curr_Stock_Price:  104.23849680173696
curr_Factors:  [104.2384968   -0.87513411  -0.91533485]
mat_Sqrt:  [[17.39551731  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00378302 -0.01991668  0.07454634]
Stock Position:  -0.003783020857683509
Bond Position:  [-1.3124936]


portfolio before change:  [-1.7021294]
curr_Stock_Price:  102.95257195365453
curr_Factors:  [102.95257195  -0.55479144  -0.92879596]
mat_Sqrt:  [[23.35196208  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00372955 -0.04015399 -0.08444945]
Stock Position:  0.0037295463463113267
Bond Position:  [-2.08609579]


portfolio before change:  [-1.70610818]
curr_Stock_Price:  101.95566696493306
curr_Factors:  [101.95566696  -0.68236666  -0.90993956]
mat_Sqrt:  [[20.74347748  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00226352 -0.00385085  0.29059974]
Stock Position:  0.002263524407336707
Bond Position:  [-1.93688732]


portfolio before change:  [-1.70882277]
curr_Stock_Price:  100.86336353922782
curr_Factors:  [100.86336354  -0.77607199  -0.87987358]
mat_Sqrt:  [[19.2559709   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176549  0.16575611 -1.41542198]
Stock Position:  -0.0017654920104433276
Bond Position:  [-1.5307493]


portfolio before change:  [-1.70906342]
curr_Stock_Price:  100.8912880580654
curr_Factors:  [100.89128806  -1.01268384  -0.85591511]
mat_Sqrt:  [[15.57153603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0257427  0.06492269 0.18822677]
Stock Position:  0.025742698206335415
Bond Position:  [-4.3062774]


portfolio before change:  [-1.70173778]
curr_Stock_Price:  101.19677111099853
curr_Factors:  [101.19677111  -1.14132777  -0.8970952 ]
mat_Sqrt:  [[13.17925336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00053308  0.01150456  0.07831814]
Stock Position:  -0.0005330818639123104
Bond Position:  [-1.64779162]


portfolio before change:  [-1.70158899]
curr_Stock_Price:  100.53123902848338
curr_Factors:  [100.53123903  -1.0385824   -0.92045311]
mat_Sqrt:  [[14.17433606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00204516 -0.04173163 -0.5994373 ]
Stock Position:  -0.002045158447228261
Bond Position:  [-1.49598667]


portfolio before change:  [-1.70223119]
curr_Stock_Price:  100.75381159061209
curr_Factors:  [100.75381159  -0.72840511  -0.92413105]
mat_Sqrt:  [[19.30074844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00205589  0.0044806  -0.036094  ]
Stock Position:  0.0020558925788138143
Bond Position:  [-1.90937021]


portfolio before change:  [-1.70261024]
curr_Stock_Price:  100.68553940730382
curr_Factors:  [100.68553941  -0.97408381  -0.94025811]
mat_Sqrt:  [[14.84495788  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148516 -0.00110753  0.45589144]
Stock Position:  -0.0014851599984171014
Bond Position:  [-1.5530761]


portfolio before change:  [-1.70227348]
curr_Stock_Price:  100.32806598814977
curr_Factors:  [100.32806599  -0.94194433  -0.9478887 ]
mat_Sqrt:  [[15.15927342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00074691 -0.01052862  0.00642663]
Stock Position:  -0.0007469053338655327
Bond Position:  [-1.62733791]


portfolio before change:  [-1.70331027]
curr_Stock_Price:  101.44381386316716
curr_Factors:  [101.44381386  -0.61502488  -0.9379948 ]
mat_Sqrt:  [[21.46632452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00454467 -0.02082265 -0.03415048]
Stock Position:  0.004544668585505554
Bond Position:  [-2.16433878]


portfolio before change:  [-1.70350172]
curr_Stock_Price:  101.46122096793272
curr_Factors:  [101.46122097  -0.61139764  -0.95037626]
mat_Sqrt:  [[21.28287513  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267922 -0.01276502  0.04141515]
Stock Position:  -0.0026792160623520848
Bond Position:  [-1.43166518]


portfolio before change:  [-1.70148432]
curr_Stock_Price:  100.64143995306549
curr_Factors:  [100.64143995  -0.71379674  -0.92438846]
mat_Sqrt:  [[19.55789213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00388506 -0.00063869  0.10044214]
Stock Position:  -0.0038850595699200605
Bond Position:  [-1.31048633]


portfolio before change:  [-1.69465657]
curr_Stock_Price:  98.84183694659393
curr_Factors:  [98.84183695 -0.98635424 -0.91951126]
mat_Sqrt:  [[14.69717748  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069003 -0.01403236 -0.17082974]
Stock Position:  -0.0006900337128515891
Bond Position:  [-1.62645237]


portfolio before change:  [-1.69503933]
curr_Stock_Price:  99.10188365903916
curr_Factors:  [99.10188366 -0.93040939 -0.92948506]
mat_Sqrt:  [[15.42907931  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115831  0.02221635 -0.17558958]
Stock Position:  0.0011583053731475741
Bond Position:  [-1.80982958]


portfolio before change:  [-1.69565351]
curr_Stock_Price:  98.76696804042983
curr_Factors:  [98.76696804 -1.16977764 -0.93585424]
mat_Sqrt:  [[12.02672592  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035141  0.00702779 -0.0032512 ]
Stock Position:  -0.00035140871929806474
Bond Position:  [-1.66094594]


portfolio before change:  [-1.69586969]
curr_Stock_Price:  98.79130750542643
curr_Factors:  [98.79130751 -1.10154456 -0.96174965]
mat_Sqrt:  [[12.54993407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00351418 -0.01468052  0.32646472]
Stock Position:  0.003514183485450148
Bond Position:  [-2.04304048]


portfolio before change:  [-1.69420291]
curr_Stock_Price:  99.33828463186855
curr_Factors:  [99.33828463 -1.06033683 -0.95676251]
mat_Sqrt:  [[13.2160461   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00525657 -0.00083772 -0.03671933]
Stock Position:  -0.005256570117744066
Bond Position:  [-1.17202425]


portfolio before change:  [-1.69165891]
curr_Stock_Price:  98.82644679557065
curr_Factors:  [98.8264468  -0.74274537 -0.9524593 ]
mat_Sqrt:  [[18.14074615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00377099 -0.01155152  0.27262378]
Stock Position:  0.003770988361449324
Bond Position:  [-2.06433229]


portfolio before change:  [-1.68776405]
curr_Stock_Price:  99.9277291948141
curr_Factors:  [99.92772919 -0.88801616 -0.96647356]
mat_Sqrt:  [[15.64196713  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273893  0.02340919 -0.04779191]
Stock Position:  -0.0027389257820370715
Bond Position:  [-1.41406941]


portfolio before change:  [-1.68604456]
curr_Stock_Price:  99.23539456699743
curr_Factors:  [99.23539457 -0.89786514 -0.94837371]
mat_Sqrt:  [[15.66228989  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105772 -0.0137625  -0.02461899]
Stock Position:  -0.0010577219360980554
Bond Position:  [-1.58108111]


portfolio before change:  [-1.68628556]
curr_Stock_Price:  99.27637430293002
curr_Factors:  [99.2763743  -0.91566762 -0.92338557]
mat_Sqrt:  [[15.78175348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00716391 0.00173684 0.23410773]
Stock Position:  0.007163912675536681
Bond Position:  [-2.39749283]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.68349485]
Stock Price:  99.7077607929241
PL:  [-1.68349485]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.92234604e-01 -4.75044644e-02  2.97356169e-03]
 [-2.07639472e-01  6.43444652e-02 -2.38016963e-01]
 [ 1.62939189e-02  6.80771411e-02  5.77211899e-02]
 [ 1.17326805e-01  1.19192079e-01  7.99006844e-02]
 [-1.34103884e-01  2.31044680e-01 -3.94582617e-02]
 [-5.80727702e-02 -1.42323958e-01  2.08803365e-01]
 [-6.54066136e-02 -1.27969522e-01  6.03944599e-03]
 [-1.86556731e-02  8.05830674e-01  1.49866217e-01]
 [ 3.59233883e-03 -4.92916185e-03 -5.33455380e-02]
 [ 6.31401095e-02  1.17214193e-02 -3.73367109e-02]
 [-4.33876788e-02 -3.45733077e-01 -1.00028748e-01]
 [ 1.51200873e-02 -1.79619000e-02  7.04874872e-02]
 [-9.69086489e-02  4.19627176e-01 -5.51248508e-01]
 [ 9.67107831e-03 -1.19540758e-01  5.11808922e-02]
 [-9.72489370e-02  1.94812468e-01 -3.91649082e-02]
 [ 3.85166812e-03 -2.99751356e-02  1.45647009e-02]
 [ 4.18271279e-02  8.53096588e-02 -7.17836599e-02]
 [-3.43983678e-02 -5.91452390e-02 -1.11840935e-02]
 [ 1.27661263e-02  2.29937754e-02 -5.97124760e-02]
 [ 1.69689613e-02 -8.15643864e-03  3.69685759e-02]
 [-2.33580021e-02  3.81506024e-01 -3.33365040e-01]
 [ 8.15959976e-02  7.24657987e-02  1.11390968e-01]
 [ 1.14363049e-03 -2.96898731e-02  6.74917147e-02]
 [ 1.39252438e-01 -9.44697268e-02 -2.90631862e-01]
 [-4.67872110e-03  2.73159869e-02 -8.99852864e-03]
 [-1.02256092e-01 -1.78708818e-02  2.25543158e-01]
 [-3.24193698e-02 -3.31227767e-02 -4.28771345e-03]
 [-1.11701909e-01  1.30890845e-01 -9.60574083e-02]
 [ 1.35012066e-02 -3.52651637e-02  7.65534133e-02]
 [ 2.83545829e-02  4.34143956e-02 -7.34895700e-02]
 [ 9.37258297e-03 -1.65846902e-02 -2.03391732e-02]
 [-5.56485199e-02  1.99429502e-02 -1.37663430e-01]
 [-2.38931693e-02  5.43149868e-02  7.43026154e-04]
 [ 4.91879934e-02 -4.26154778e-02  1.87521383e-01]
 [-7.38733176e-02 -8.99275027e-03 -2.85829429e-02]
 [-1.49439885e-01 -1.68190999e-01 -1.36526794e-01]
 [ 1.08867950e-01  9.88450241e-02  2.37102584e-01]
 [ 1.84708020e-01 -1.27751430e-01 -1.95955701e-01]
 [ 9.83788636e-02  3.41774351e-03  6.33011762e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.78780768]
curr_Stock_Price:  99.34675776141009
curr_Factors:  [99.34675776 -1.13893712 -0.99074137]
mat_Sqrt:  [[11.80989626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01550774 -0.015332    0.00848274]
Stock Position:  0.015507737530385916
Bond Position:  [-4.32845112]


portfolio before change:  [-2.78824073]
curr_Stock_Price:  99.3537248546533
curr_Factors:  [99.35372485 -1.02494242 -0.96858225]
mat_Sqrt:  [[13.53341475  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01796222  0.02076709 -0.67899614]
Stock Position:  -0.017962223634594182
Bond Position:  [-1.0036269]


portfolio before change:  [-2.75884483]
curr_Stock_Price:  97.7102001133063
curr_Factors:  [97.71020011 -1.11882617 -0.94350622]
mat_Sqrt:  [[12.42454021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00337819 0.0219718  0.16466249]
Stock Position:  0.003378185026640799
Bond Position:  [-3.08892796]


portfolio before change:  [-2.76019808]
curr_Stock_Price:  97.42391948153386
curr_Factors:  [97.42391948 -1.25876755 -0.93064109]
mat_Sqrt:  [[10.90981803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01447929 0.03846908 0.22793441]
Stock Position:  0.014479292365181643
Bond Position:  [-4.17082749]


portfolio before change:  [-2.75001917]
curr_Stock_Price:  98.16292589667009
curr_Factors:  [98.1629259  -1.22535485 -0.90918677]
mat_Sqrt:  [[11.6125567   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0081805   0.07456935 -0.11256344]
Stock Position:  -0.008180495666827223
Bond Position:  [-1.94699778]


portfolio before change:  [-2.75104999]
curr_Stock_Price:  98.25918220843944
curr_Factors:  [98.25918221 -1.17559797 -0.89727067]
mat_Sqrt:  [[12.36339467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00359955 -0.04593486  0.59565788]
Stock Position:  -0.003599554929305937
Bond Position:  [-2.39736066]


portfolio before change:  [-2.75051235]
curr_Stock_Price:  98.02656222330167
curr_Factors:  [98.02656222 -1.03196756 -0.86860489]
mat_Sqrt:  [[14.65330683  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00616212 -0.04130199  0.01722886]
Stock Position:  -0.006162123491608914
Bond Position:  [-2.14646057]


portfolio before change:  [-2.74654871]
curr_Stock_Price:  97.33979170089185
curr_Factors:  [97.3397917  -0.85685503 -0.8559057 ]
mat_Sqrt:  [[17.55690172  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01004876 0.26008073 0.4275266 ]
Stock Position:  0.010048762628047238
Bond Position:  [-3.72469317]


portfolio before change:  [-2.75933157]
curr_Stock_Price:  96.11404371392645
curr_Factors:  [96.11404371 -1.17762984 -0.86521122]
mat_Sqrt:  [[12.4621292   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066625 -0.00159088 -0.15217997]
Stock Position:  -0.000666253281399113
Bond Position:  [-2.69529528]


portfolio before change:  [-2.75939845]
curr_Stock_Price:  95.70871423541273
curr_Factors:  [95.70871424 -1.18480229 -0.85545653]
mat_Sqrt:  [[12.44166018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00465464  0.00378307 -0.10651124]
Stock Position:  0.00465463685539785
Bond Position:  [-3.20488776]


portfolio before change:  [-2.76027955]
curr_Stock_Price:  95.60549167274775
curr_Factors:  [95.60549167 -1.23736322 -0.86871452]
mat_Sqrt:  [[11.63656773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01154794 -0.11158487 -0.28535418]
Stock Position:  -0.011547943821120607
Bond Position:  [-1.65623271]


portfolio before change:  [-2.75251976]
curr_Stock_Price:  94.91559908652415
curr_Factors:  [94.91559909 -1.15433024 -0.86777361]
mat_Sqrt:  [[12.56461111  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00205672 -0.00579718  0.20108118]
Stock Position:  0.002056715300076718
Bond Position:  [-2.94773412]


portfolio before change:  [-2.75341114]
curr_Stock_Price:  94.6613627957511
curr_Factors:  [94.6613628  -1.13868511 -0.86384683]
mat_Sqrt:  [[12.77862654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00968615  0.13543409 -1.57255856]
Stock Position:  -0.009686153706253635
Bond Position:  [-1.83650663]


portfolio before change:  [-2.76306952]
curr_Stock_Price:  95.63479372052433
curr_Factors:  [95.63479372 -1.38043142 -0.88736653]
mat_Sqrt:  [[ 9.90201981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043252 -0.03858161  0.14600484]
Stock Position:  -0.0004325199353447738
Bond Position:  [-2.72170556]


portfolio before change:  [-2.76352254]
curr_Stock_Price:  95.89556348837972
curr_Factors:  [95.89556349 -1.31072234 -0.88264643]
mat_Sqrt:  [[10.69622585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00612155  0.06287545 -0.11172658]
Stock Position:  -0.006121552851979935
Bond Position:  [-2.17649278]


portfolio before change:  [-2.76436909]
curr_Stock_Price:  95.98940744609351
curr_Factors:  [95.98940745 -1.11104446 -0.87833855]
mat_Sqrt:  [[13.12941108  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.37744074e-05 -9.67443343e-03  4.15490376e-02]
Stock Position:  5.3774407400088807e-05
Bond Position:  [-2.76953086]


portfolio before change:  [-2.76468514]
curr_Stock_Price:  96.55030736046211
curr_Factors:  [96.55030736 -1.05249934 -0.88183823]
mat_Sqrt:  [[13.95344778  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00319549  0.02753357 -0.2047788 ]
Stock Position:  0.003195490573330465
Bond Position:  [-3.07321074]


portfolio before change:  [-2.76146698]
curr_Stock_Price:  97.67762516488582
curr_Factors:  [97.67762516 -1.29057902 -0.90741309]
mat_Sqrt:  [[10.84474263  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00449566 -0.01908904 -0.03190511]
Stock Position:  -0.004495660649264561
Bond Position:  [-2.32234152]


portfolio before change:  [-2.76199324]
curr_Stock_Price:  97.73010868971048
curr_Factors:  [97.73010869 -1.33041775 -0.89299829]
mat_Sqrt:  [[10.57818264  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00049829  0.00742121 -0.17034307]
Stock Position:  0.0004982852960775594
Bond Position:  [-2.81069072]


portfolio before change:  [-2.76186202]
curr_Stock_Price:  98.69858103641886
curr_Factors:  [98.69858104 -1.30938297 -0.89798011]
mat_Sqrt:  [[10.85588681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210487 -0.00263248  0.10546106]
Stock Position:  0.002104868499565085
Bond Position:  [-2.96960956]


portfolio before change:  [-2.7627998]
curr_Stock_Price:  98.4294186329666
curr_Factors:  [98.42941863 -1.22151303 -0.8805209 ]
mat_Sqrt:  [[12.02882438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0011249   0.12313054 -0.95099767]
Stock Position:  -0.0011249033484150236
Bond Position:  [-2.65207622]


portfolio before change:  [-2.76288807]
curr_Stock_Price:  98.21317277692843
curr_Factors:  [98.21317278 -1.17915171 -0.88306028]
mat_Sqrt:  [[12.49000042  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00953768 0.02338824 0.31776743]
Stock Position:  0.009537678067600284
Bond Position:  [-3.6996137]


portfolio before change:  [-2.7639366]
curr_Stock_Price:  98.15172706062594
curr_Factors:  [98.15172706 -1.11445797 -0.87025292]
mat_Sqrt:  [[13.48804354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00065687 -0.00958237  0.19253508]
Stock Position:  0.0006568705884107834
Bond Position:  [-2.82840959]


portfolio before change:  [-2.76425845]
curr_Stock_Price:  98.20002751597407
curr_Factors:  [98.20002752 -1.35464107 -0.87959952]
mat_Sqrt:  [[10.51461192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00576758 -0.03048997 -0.82909181]
Stock Position:  0.0057675838380419255
Bond Position:  [-3.33063534]


portfolio before change:  [-2.76712148]
curr_Stock_Price:  97.77581628216296
curr_Factors:  [97.77581628 -1.24970734 -0.87138173]
mat_Sqrt:  [[11.7234159   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.01545887e-05  8.81619688e-03 -2.56702975e-02]
Stock Position:  -8.015458865679106e-05
Bond Position:  [-2.7592843]


portfolio before change:  [-2.76746931]
curr_Stock_Price:  97.81204926501326
curr_Factors:  [97.81204927 -1.08108319 -0.87709054]
mat_Sqrt:  [[13.80283544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00433716 -0.0057678   0.64341185]
Stock Position:  -0.004337164372880741
Bond Position:  [-2.34324238]


portfolio before change:  [-2.7664392]
curr_Stock_Price:  97.50700183148014
curr_Factors:  [97.50700183 -0.98328927 -0.88831823]
mat_Sqrt:  [[15.0039978   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266967 -0.01069033 -0.01223165]
Stock Position:  -0.002669672089351339
Bond Position:  [-2.50612748]


portfolio before change:  [-2.76429741]
curr_Stock_Price:  96.58738653273213
curr_Factors:  [96.58738653 -0.9747831  -0.85991482]
mat_Sqrt:  [[15.42130877  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00678228  0.04224484 -0.27402505]
Stock Position:  -0.006782275412085855
Bond Position:  [-2.10921515]


portfolio before change:  [-2.76297467]
curr_Stock_Price:  96.35348193839042
curr_Factors:  [96.35348194 -1.32793357 -0.84623094]
mat_Sqrt:  [[10.95569077  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00200162 -0.01138178  0.21838558]
Stock Position:  0.002001620505551435
Bond Position:  [-2.95583778]


portfolio before change:  [-2.76411473]
curr_Stock_Price:  95.96851670829133
curr_Factors:  [95.96851671 -1.07115768 -0.83779338]
mat_Sqrt:  [[14.22596933  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00156162  0.01401194 -0.20964529]
Stock Position:  0.0015616168619928166
Bond Position:  [-2.91398079]


portfolio before change:  [-2.76541664]
curr_Stock_Price:  95.36809036093874
curr_Factors:  [95.36809036 -1.14867065 -0.84531039]
mat_Sqrt:  [[12.9845866   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00014136 -0.00535269 -0.058022  ]
Stock Position:  0.00014136229126565989
Bond Position:  [-2.77889809]


portfolio before change:  [-2.76572577]
curr_Stock_Price:  95.63865667006179
curr_Factors:  [95.63865667 -1.50881056 -0.8471521 ]
mat_Sqrt:  [[ 9.06675511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00878794  0.00643656 -0.39271545]
Stock Position:  -0.008787941349530239
Bond Position:  [-1.92525887]


portfolio before change:  [-2.76116534]
curr_Stock_Price:  95.09232817430419
curr_Factors:  [95.09232817 -1.26004701 -0.89254959]
mat_Sqrt:  [[11.04802523  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00114541  0.01753009  0.00211965]
Stock Position:  -0.001145408270400079
Bond Position:  [-2.6522458]


portfolio before change:  [-2.76139035]
curr_Stock_Price:  94.99930796121527
curr_Factors:  [94.99930796 -1.06492701 -0.8780224 ]
mat_Sqrt:  [[13.61157034  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00578675 -0.01375409  0.53494631]
Stock Position:  0.005786752413465656
Bond Position:  [-3.31112782]


portfolio before change:  [-2.76064995]
curr_Stock_Price:  95.19878326446185
curr_Factors:  [95.19878326 -1.12696749 -0.89017242]
mat_Sqrt:  [[12.66480962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00643858 -0.0029024  -0.08153918]
Stock Position:  -0.006438582673802535
Bond Position:  [-2.14770472]


portfolio before change:  [-2.75869828]
curr_Stock_Price:  94.85396341683695
curr_Factors:  [94.85396342 -0.83233757 -0.88280387]
mat_Sqrt:  [[17.06785799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01239992 -0.05428341 -0.38947294]
Stock Position:  -0.012399924128914837
Bond Position:  [-1.58251633]


portfolio before change:  [-2.75478074]
curr_Stock_Price:  94.52207703848963
curr_Factors:  [94.52207704 -0.68712987 -0.86037523]
mat_Sqrt:  [[20.11223476  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00882264 0.03190209 0.67638768]
Stock Position:  0.008822638086487793
Bond Position:  [-3.58871482]


portfolio before change:  [-2.75765159]
curr_Stock_Price:  94.24752993701979
curr_Factors:  [94.24752994 -0.95420249 -0.84259403]
mat_Sqrt:  [[15.6289991   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00759048 -0.0412316  -0.55900707]
Stock Position:  0.007590478299038696
Bond Position:  [-3.47303542]


portfolio before change:  [-2.75982852]
curr_Stock_Price:  94.0179291663032
curr_Factors:  [94.01792917 -0.94793294 -0.83663285]
mat_Sqrt:  [[15.78278373  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0070962  0.00110307 0.18058064]
Stock Position:  0.007096201021357832
Bond Position:  [-3.42699865]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.75959106]
Stock Price:  94.11176372963571
PL:  [-2.75959106]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.34969726e-01 -9.45619068e-02  1.65627119e-02]
 [-2.24180248e-01  9.80097095e-02 -3.91750774e-01]
 [-4.12822840e-02  5.14327457e-02  1.90099555e-02]
 [ 8.24773532e-02  8.00440843e-02  7.15041212e-02]
 [ 1.80019070e-02  6.66330708e-02 -6.74905633e-02]
 [-7.89962471e-02 -1.55950184e-01  1.34896030e-01]
 [-5.77623169e-02 -1.65935807e-01  6.99866132e-02]
 [ 3.02455807e-03  7.23527950e-01  1.10728923e-01]
 [ 2.22698160e-01 -3.11900379e-02  2.12529115e-01]
 [ 4.11703911e-01  1.57116494e-01  2.57084132e-01]
 [-2.53019992e-01 -2.72024279e-01  4.82698867e-03]
 [-4.82211291e-02 -1.83794662e-02  9.10347502e-02]
 [ 1.27828078e-02 -5.78172314e-02  8.46592936e-02]
 [ 4.34878296e-03  4.42379102e-02 -7.49679074e-02]
 [ 1.09332981e-01 -1.42903534e-01 -1.03520614e-01]
 [-5.95562970e-02 -4.92045214e-02  8.31093030e-02]
 [ 4.83809488e-02  2.24522238e-02 -9.88799056e-03]
 [-3.38223507e-02 -4.70854332e-02  6.13328278e-02]
 [ 9.69836690e-02 -7.14414642e-02 -6.27862685e-02]
 [ 4.91661285e-02 -1.15766200e-02  1.99741669e-01]
 [-1.64277954e-02  3.40052561e-01 -3.22535264e-01]
 [ 1.27770161e-01  9.65782305e-02  1.01571458e-01]
 [-2.92990701e-03  1.03201088e-01 -1.27131815e-02]
 [ 9.99009104e-02 -1.83059250e-01 -2.91507980e-01]
 [ 5.78599155e-02  2.31793905e-02 -1.42505542e-02]
 [-1.74754301e-02  1.45244106e-02  4.68980967e-02]
 [ 7.47277905e-02 -3.10458903e-02  2.75035564e-02]
 [ 1.49119045e-01 -6.84969593e-02  1.03631442e-01]
 [-4.65295732e-02 -2.06310894e-02 -2.13645802e-02]
 [-6.18533406e-02 -1.34249435e-02  3.66323908e-02]
 [-2.52772063e-02 -4.26933500e-02 -1.14260671e-02]
 [ 2.60316969e-02 -1.27231584e-02 -5.13964149e-02]
 [ 5.15539034e-02  9.35034840e-03  1.44027024e-01]
 [ 1.33767315e-02 -6.71395046e-02  3.35692249e-03]
 [-3.74099263e-02 -1.64136252e-02  4.57576675e-02]
 [ 9.50390257e-02  2.42121367e-02  1.94948921e-01]
 [ 3.10093257e-02  8.87333079e-03 -4.94839636e-03]
 [-4.83258390e-02 -9.55117989e-03  2.69670417e-02]
 [ 9.21455617e-02  7.27943141e-03  1.00201085e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.24245679]
curr_Stock_Price:  100.35915283739183
curr_Factors:  [100.35915284  -1.06182475  -0.99768668]
mat_Sqrt:  [[12.79742345  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01179075 -0.03051972  0.04724881]
Stock Position:  -0.01179075191634743
Bond Position:  [6.42576666]


portfolio before change:  [5.24902415]
curr_Stock_Price:  99.87028727692315
curr_Factors:  [99.87028728 -1.20644353 -1.00230544]
mat_Sqrt:  [[10.96954996  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0259026   0.0316325  -1.11755592]
Stock Position:  -0.02590260248359371
Bond Position:  [7.8359245]


portfolio before change:  [5.25369931]
curr_Stock_Price:  99.72761389977616
curr_Factors:  [99.7276139  -1.32054827 -0.97119077]
mat_Sqrt:  [[10.08151519  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266857  0.01659985  0.05423011]
Stock Position:  -0.002668569883614767
Bond Position:  [5.51982942]


portfolio before change:  [5.2550717]
curr_Stock_Price:  99.47191070421992
curr_Factors:  [99.4719107  -1.03494036 -0.94840732]
mat_Sqrt:  [[13.68811056  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00828544 0.02583412 0.20398135]
Stock Position:  0.00828543871196328
Bond Position:  [4.43090328]


portfolio before change:  [5.2563603]
curr_Stock_Price:  99.56058444223913
curr_Factors:  [99.56058444 -1.10209771 -0.91652609]
mat_Sqrt:  [[13.22544399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00134792  0.02150573 -0.19253179]
Stock Position:  0.0013479223887673758
Bond Position:  [5.12216036]


portfolio before change:  [5.25739387]
curr_Stock_Price:  99.85233885076161
curr_Factors:  [99.85233885 -1.10129203 -0.90725789]
mat_Sqrt:  [[13.39849736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00621666 -0.05033271  0.38482083]
Stock Position:  -0.006216660416242313
Bond Position:  [5.87814195]


portfolio before change:  [5.25511786]
curr_Stock_Price:  100.33665422496772
curr_Factors:  [100.33665422  -0.90663724  -0.90009859]
mat_Sqrt:  [[16.47419552  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00469509 -0.05355555  0.19965233]
Stock Position:  -0.004695092030118276
Bond Position:  [5.72620768]


portfolio before change:  [5.26047863]
curr_Stock_Price:  99.34733265480511
curr_Factors:  [99.34733265 -0.80983591 -0.88362422]
mat_Sqrt:  [[18.26820271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00948733 0.23351764 0.3158788 ]
Stock Position:  0.009487333366254527
Bond Position:  [4.31793737]


portfolio before change:  [5.25862727]
curr_Stock_Price:  99.09529727550026
curr_Factors:  [99.09529728 -0.56619838 -0.90411414]
mat_Sqrt:  [[22.77741483  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01140225 -0.01006654  0.60628641]
Stock Position:  0.01140225287710911
Bond Position:  [4.12871763]


portfolio before change:  [5.26496352]
curr_Stock_Price:  99.60573422147944
curr_Factors:  [99.60573422 -0.71912868 -0.92995562]
mat_Sqrt:  [[19.14679683  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02591829 0.05070913 0.73338947]
Stock Position:  0.025918291396610515
Bond Position:  [2.68335308]


portfolio before change:  [5.32461644]
curr_Stock_Price:  101.8943680132771
curr_Factors:  [101.89436801  -0.75877513  -0.91851176]
mat_Sqrt:  [[19.04205162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0161517  -0.08779546  0.01377006]
Stock Position:  -0.016151695024687468
Bond Position:  [6.97038319]


portfolio before change:  [5.33451543]
curr_Stock_Price:  101.3354393986092
curr_Factors:  [101.3354394   -0.74577606  -0.89518323]
mat_Sqrt:  [[19.63820507  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170028 -0.00593195  0.2596968 ]
Stock Position:  -0.0017002791859406718
Bond Position:  [5.50681397]


portfolio before change:  [5.33472302]
curr_Stock_Price:  101.61822166172072
curr_Factors:  [101.61822166  -0.98609463  -0.93190471]
mat_Sqrt:  [[14.92777431  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00122335 -0.01866043  0.2415094 ]
Stock Position:  0.0012233518850606668
Bond Position:  [5.21040818]


portfolio before change:  [5.3355406]
curr_Stock_Price:  101.75410821422186
curr_Factors:  [101.75410821  -0.94257442  -0.93586241]
mat_Sqrt:  [[15.55095984  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.23719144e-04  1.42777241e-02 -2.13862573e-01]
Stock Position:  -0.0001237191437637605
Bond Position:  [5.34812953]


portfolio before change:  [5.3362888]
curr_Stock_Price:  101.11033399579851
curr_Factors:  [101.110334    -1.1181757   -0.93097405]
mat_Sqrt:  [[13.02750108  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00453133 -0.04612192 -0.2953155 ]
Stock Position:  0.00453132656956278
Bond Position:  [4.87812486]


portfolio before change:  [5.3370111]
curr_Stock_Price:  101.1351587240576
curr_Factors:  [101.13515872  -1.08519169  -0.92703339]
mat_Sqrt:  [[13.52084733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00389292 -0.01588069  0.23708771]
Stock Position:  -0.00389291522476117
Bond Position:  [5.7307217]


portfolio before change:  [5.33656046]
curr_Stock_Price:  101.4349397736037
curr_Factors:  [101.43493977  -1.18909623  -0.94135042]
mat_Sqrt:  [[12.04887093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00422825  0.00724642 -0.02820768]
Stock Position:  0.004228247814664131
Bond Position:  [4.9076684]


portfolio before change:  [5.3383702]
curr_Stock_Price:  101.71785570400408
curr_Factors:  [101.7178557   -1.42884231  -0.93889878]
mat_Sqrt:  [[ 9.53016256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324382 -0.01519676  0.17496549]
Stock Position:  -0.0032438180656356535
Bond Position:  [5.66832441]


portfolio before change:  [5.33844786]
curr_Stock_Price:  101.91235641229446
curr_Factors:  [101.91235641  -1.47635517  -0.95213516]
mat_Sqrt:  [[ 8.98559611  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00774401 -0.02305763 -0.17911175]
Stock Position:  0.007744010186646128
Bond Position:  [4.54923753]


portfolio before change:  [5.34576518]
curr_Stock_Price:  102.78382082236263
curr_Factors:  [102.78382082  -1.37896202  -0.93133601]
mat_Sqrt:  [[10.19941052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0085863  -0.00373634  0.56980738]
Stock Position:  0.00858629605088657
Bond Position:  [4.46323286]


portfolio before change:  [5.34504349]
curr_Stock_Price:  102.63478928736272
curr_Factors:  [102.63478929  -1.61773476  -0.93299351]
mat_Sqrt:  [[ 8.0080612   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00160489  0.10975149 -0.92010333]
Stock Position:  -0.0016048943323960403
Bond Position:  [5.50976148]


portfolio before change:  [5.34510936]
curr_Stock_Price:  103.02290775604362
curr_Factors:  [103.02290776  -1.75719385  -0.96724538]
mat_Sqrt:  [[ 6.75654822  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02489693 0.03117049 0.2897551 ]
Stock Position:  0.024896928385429094
Bond Position:  [2.7801554]


portfolio before change:  [5.34228521]
curr_Stock_Price:  102.89551501515494
curr_Factors:  [102.89551502  -1.56367521  -0.95130522]
mat_Sqrt:  [[ 8.32059383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186776  0.03330801 -0.03626717]
Stock Position:  0.0018677584543033967
Bond Position:  [5.15010124]


portfolio before change:  [5.34249042]
curr_Stock_Price:  102.66069256794806
curr_Factors:  [102.66069257  -1.51366631  -0.9733305 ]
mat_Sqrt:  [[ 8.53719499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.54950326e-04 -5.90821188e-02 -8.31591128e-01]
Stock Position:  0.0003549503262476078
Bond Position:  [5.30605098]


portfolio before change:  [5.34309768]
curr_Stock_Price:  102.50280349156738
curr_Factors:  [102.50280349  -1.28029941  -0.95687225]
mat_Sqrt:  [[10.94320252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00545384  0.00748112 -0.04065286]
Stock Position:  0.0054538428265304365
Bond Position:  [4.7840635]


portfolio before change:  [5.34661732]
curr_Stock_Price:  103.0384976934383
curr_Factors:  [103.03849769  -1.42780899  -0.97160042]
mat_Sqrt:  [[ 9.35296375  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052792  0.00468773  0.13378722]
Stock Position:  -0.0005279196443334297
Bond Position:  [5.40101336]


portfolio before change:  [5.34747244]
curr_Stock_Price:  102.6976214840614
curr_Factors:  [102.69762148  -1.32981502  -0.97542774]
mat_Sqrt:  [[10.24250479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00722526 -0.01002002  0.07845999]
Stock Position:  0.007225255558118479
Bond Position:  [4.60545588]


portfolio before change:  [5.34838412]
curr_Stock_Price:  102.74411990094956
curr_Factors:  [102.7441199   -1.22073186  -0.97101446]
mat_Sqrt:  [[11.47872474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0136157  -0.0221073   0.29563166]
Stock Position:  0.01361569727756623
Bond Position:  [3.94945129]


portfolio before change:  [5.34721937]
curr_Stock_Price:  102.62231489108251
curr_Factors:  [102.62231489  -1.25294646  -0.99558087]
mat_Sqrt:  [[10.83225306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00508684 -0.00665866 -0.0609472 ]
Stock Position:  -0.005086836788929164
Bond Position:  [5.86924234]


portfolio before change:  [5.34697696]
curr_Stock_Price:  102.8142052964329
curr_Factors:  [102.8142053   -1.33736282  -1.00414705]
mat_Sqrt:  [[ 9.88890737  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00577578 -0.00433288  0.10450201]
Stock Position:  -0.005775778669709984
Bond Position:  [5.94080905]


portfolio before change:  [5.34763828]
curr_Stock_Price:  102.82828647679727
curr_Factors:  [102.82828648  -1.42897289  -1.01091895]
mat_Sqrt:  [[ 8.96357042  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00405243 -0.01377922 -0.03259539]
Stock Position:  -0.004052434949251794
Bond Position:  [5.76434322]


portfolio before change:  [5.34888539]
curr_Stock_Price:  102.69835734986245
curr_Factors:  [102.69835735  -1.5801651   -1.01117422]
mat_Sqrt:  [[ 7.69412307  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00168224 -0.00410638 -0.14661967]
Stock Position:  0.001682237694316652
Bond Position:  [5.17612235]


portfolio before change:  [5.34777164]
curr_Stock_Price:  101.65165178330814
curr_Factors:  [101.65165178  -1.3443554   -1.00151026]
mat_Sqrt:  [[ 9.73459594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00851211 0.00301781 0.41086901]
Stock Position:  0.008512107628560833
Bond Position:  [4.48250184]


portfolio before change:  [5.34621255]
curr_Stock_Price:  101.40266091170241
curr_Factors:  [101.40266091  -1.36357684  -0.99868893]
mat_Sqrt:  [[ 9.5527929   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.73886969e-05 -2.16691819e-02  9.57636547e-03]
Stock Position:  3.738869693771287e-05
Bond Position:  [5.34242124]


portfolio before change:  [5.3468677]
curr_Stock_Price:  101.06298264498845
curr_Factors:  [101.06298264  -1.3127735   -0.98065726]
mat_Sqrt:  [[10.19923945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308063 -0.00529747  0.13053389]
Stock Position:  -0.0030806315436745797
Bond Position:  [5.65820551]


portfolio before change:  [5.34679892]
curr_Stock_Price:  101.31491207843989
curr_Factors:  [101.31491208  -1.17223894  -0.9763649 ]
mat_Sqrt:  [[11.8180707   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01182723 0.00781443 0.55613501]
Stock Position:  0.01182723413786356
Bond Position:  [4.14852373]


portfolio before change:  [5.34057069]
curr_Stock_Price:  100.74446403979326
curr_Factors:  [100.74446404  -1.34298186  -0.97997937]
mat_Sqrt:  [[ 9.87124534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00322254  0.00286386 -0.0141164 ]
Stock Position:  0.0032225416870802154
Bond Position:  [5.01591746]


portfolio before change:  [5.34336876]
curr_Stock_Price:  101.41816966053182
curr_Factors:  [101.41816966  -1.43754779  -0.96960758]
mat_Sqrt:  [[ 9.13485112  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0049011  -0.00308263  0.07692946]
Stock Position:  -0.004901102440224158
Bond Position:  [5.8404296]


portfolio before change:  [5.34298118]
curr_Stock_Price:  101.64621704586231
curr_Factors:  [101.64621705  -1.29324288  -0.93088381]
mat_Sqrt:  [[10.99424145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01037679 0.00234943 0.2858458 ]
Stock Position:  0.010376789589650541
Bond Position:  [4.28821977]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.33855402]
Stock Price:  101.16791727718028
PL:  [4.17063675]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.84748456e-01 -1.10930618e-01  2.32456979e-02]
 [-1.33044525e-01  6.88617926e-02 -1.44315273e-01]
 [-3.51343059e-02  4.32855478e-02  2.16001537e-02]
 [ 8.58282226e-02  8.16657586e-02  7.29646122e-02]
 [-2.73821479e-02  1.41308718e-01 -5.02204587e-02]
 [-1.30010025e-01 -1.62853432e-01  1.03226964e-01]
 [-6.07499308e-02 -1.75813523e-01  1.00924783e-01]
 [-4.09188064e-02  8.35013967e-01  1.86086589e-01]
 [ 5.28056309e-02 -1.09753794e-01  2.15517760e-02]
 [ 2.67629981e-01  9.70194911e-02  1.35389430e-01]
 [-1.61977878e-01 -2.66466833e-01 -1.39880537e-02]
 [-6.58194528e-02 -2.33995016e-02  1.82328022e-02]
 [-1.03202858e-01  3.96013924e-01 -6.46194771e-01]
 [ 5.34839597e-03 -3.02556269e-02  6.37285267e-02]
 [-1.53931180e-01  1.89492632e-01 -3.63518050e-02]
 [-7.98671376e-02 -4.89474179e-02 -7.50636564e-03]
 [ 4.34856047e-02  1.21979753e-01 -2.35397851e-01]
 [ 7.01008686e-02 -3.03302945e-02 -8.18332756e-02]
 [ 2.21571545e-02  1.91628780e-01 -9.81496541e-02]
 [-9.44704237e-02 -1.51628727e-02 -2.48864939e-02]
 [-3.91914984e-02  4.72671672e-01 -4.05892615e-01]
 [ 4.44772430e-01  2.34611410e-01  6.55094729e-02]
 [ 8.28500251e-03 -5.65186993e-02  8.43690537e-02]
 [ 1.63887067e-01  1.88215239e-01 -8.65964923e-02]
 [-2.17464112e-01  9.38210263e-02  1.25378044e-02]
 [-1.70057191e-01 -3.12002432e-02  1.59339472e-01]
 [-7.48228813e-02 -3.49526570e-02 -2.05991427e-02]
 [-6.47611488e-02  1.05513654e-01 -3.44299069e-02]
 [ 2.46937847e-01  4.01352453e-02  2.51119631e-01]
 [ 1.03922841e-01  7.60762910e-02 -1.49063335e-01]
 [ 1.81204356e-02 -6.36326106e-03 -1.72930590e-02]
 [-1.81753988e-02  9.86284319e-02 -1.32149118e-01]
 [-1.68251110e-02  6.38404711e-02 -5.90007447e-02]
 [ 4.55622970e-02 -5.65959823e-02  1.82130866e-01]
 [-7.23792571e-02  1.51552683e-02 -3.37806347e-02]
 [-1.33244722e-01 -1.55942917e-01 -1.21193668e-01]
 [ 5.97069839e-02  1.04790872e-01  1.85369989e-01]
 [ 1.68116480e-01 -1.21084284e-01 -1.65945975e-01]
 [ 9.91241086e-02  2.95604540e-03  5.88894738e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.14976984]
curr_Stock_Price:  100.85175734738503
curr_Factors:  [100.85175735  -0.9701705   -0.97208707]
mat_Sqrt:  [[14.4601143   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02092978 -0.0358027   0.06631351]
Stock Position:  -0.02092978377204362
Bond Position:  [11.26057531]


portfolio before change:  [9.16190137]
curr_Stock_Price:  100.33938376837311
curr_Factors:  [100.33938377  -0.99647525  -0.99269893]
mat_Sqrt:  [[13.72726629  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01081398  0.02222505 -0.41169131]
Stock Position:  -0.01081398141495086
Bond Position:  [10.2469696]


portfolio before change:  [9.168258]
curr_Stock_Price:  99.87002085382309
curr_Factors:  [99.87002085 -0.93390631 -0.98804907]
mat_Sqrt:  [[14.61303837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149795  0.01397035  0.06161923]
Stock Position:  -0.0014979477191726259
Bond Position:  [9.31785807]


portfolio before change:  [9.1711174]
curr_Stock_Price:  98.73874571145326
curr_Factors:  [98.73874571 -0.67567995 -0.97509373]
mat_Sqrt:  [[18.94810164  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00619545 0.02635751 0.20814773]
Stock Position:  0.0061954499229652
Bond Position:  [8.55938644]


portfolio before change:  [9.17629394]
curr_Stock_Price:  99.4015793256461
curr_Factors:  [99.40157933 -0.72157564 -0.98579653]
mat_Sqrt:  [[18.02565148  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048757  0.04560719 -0.14326499]
Stock Position:  -0.0004875737736332555
Bond Position:  [9.22475954]


portfolio before change:  [9.17702054]
curr_Stock_Price:  100.27644353570494
curr_Factors:  [100.27644354  -0.76244441  -0.97030015]
mat_Sqrt:  [[17.72872564  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00801982 -0.05256072  0.2944778 ]
Stock Position:  -0.008019822184270104
Bond Position:  [9.98121979]


portfolio before change:  [9.18124959]
curr_Stock_Price:  99.90470016424165
curr_Factors:  [99.90470016 -0.51171896 -0.95410008]
mat_Sqrt:  [[23.06687708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00329635 -0.05674357  0.28791032]
Stock Position:  -0.003296351323251758
Bond Position:  [9.51057058]


portfolio before change:  [9.18902229]
curr_Stock_Price:  97.90739960012833
curr_Factors:  [97.9073996  -0.61426652 -0.96925861]
mat_Sqrt:  [[20.09552196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00833581 0.2694996  0.53085324]
Stock Position:  0.008335810938811571
Bond Position:  [8.37288472]


portfolio before change:  [9.18162664]
curr_Stock_Price:  96.89462105490378
curr_Factors:  [96.89462105 -0.42307873 -0.92922759]
mat_Sqrt:  [[25.06112122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138866 -0.03542288  0.06148122]
Stock Position:  0.0013886636993419553
Bond Position:  [9.04707259]


portfolio before change:  [9.18278795]
curr_Stock_Price:  96.91648136731492
curr_Factors:  [96.91648137 -0.40206135 -0.95367603]
mat_Sqrt:  [[24.98091706  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01261244 0.03131291 0.38622836]
Stock Position:  0.012612437420032032
Bond Position:  [7.96043489]


portfolio before change:  [9.15714166]
curr_Stock_Price:  94.80416948230976
curr_Factors:  [94.80416948 -0.1594794  -0.96638076]
mat_Sqrt:  [[30.75194449  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00712883 -0.0860018  -0.03990402]
Stock Position:  -0.007128833509138261
Bond Position:  [9.8329848]


portfolio before change:  [9.16477961]
curr_Stock_Price:  93.90517927503957
curr_Factors:  [93.90517928 -0.20397227 -0.95469467]
mat_Sqrt:  [[29.47724482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226867 -0.00755216  0.05201311]
Stock Position:  -0.0022686686409404315
Bond Position:  [9.37781935]


portfolio before change:  [9.1667625]
curr_Stock_Price:  93.54788363864175
curr_Factors:  [93.54788364 -0.28700707 -0.96040518]
mat_Sqrt:  [[26.87136407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00574109  0.12781294 -1.84341382]
Stock Position:  -0.005741085921855027
Bond Position:  [9.70382894]


portfolio before change:  [9.16572525]
curr_Stock_Price:  93.93984871109137
curr_Factors:  [93.93984871 -0.25330063 -0.96552759]
mat_Sqrt:  [[27.76639422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0004387  -0.00976496  0.18179975]
Stock Position:  0.0004386966105439942
Bond Position:  [9.12451416]


portfolio before change:  [9.16683899]
curr_Stock_Price:  93.87854423531407
curr_Factors:  [ 9.38785442e+01 -8.81631051e-02 -9.38881387e-01]
mat_Sqrt:  [[33.61449499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364936  0.06115848 -0.10370158]
Stock Position:  -0.0036493613666714604
Bond Position:  [9.50943572]


portfolio before change:  [9.161817]
curr_Stock_Price:  95.58041670457966
curr_Factors:  [95.5804167  -0.26321434 -0.97608018]
mat_Sqrt:  [[27.67898424  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330181 -0.01579771 -0.02141357]
Stock Position:  -0.003301808950023597
Bond Position:  [9.47740527]


portfolio before change:  [9.16376057]
curr_Stock_Price:  95.35059488010822
curr_Factors:  [ 9.53505949e+01 -4.36292549e-02 -9.77018061e-01]
mat_Sqrt:  [[34.36069263  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.91787620e-04  3.93687961e-02 -6.71524546e-01]
Stock Position:  0.0005917876199098884
Bond Position:  [9.10733327]


portfolio before change:  [9.1650473]
curr_Stock_Price:  95.60107917023298
curr_Factors:  [ 9.56010792e+01  6.20395083e-02 -9.66672100e-01]
mat_Sqrt:  [[38.68885277  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00122013 -0.00978906 -0.23344756]
Stock Position:  0.001220133769466115
Bond Position:  [9.04840119]


portfolio before change:  [9.16434143]
curr_Stock_Price:  94.09551945414233
curr_Factors:  [94.09551945 -0.29742416 -0.97557409]
mat_Sqrt:  [[26.34588721  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00156527  0.06184792 -0.27999364]
Stock Position:  0.001565272817399677
Bond Position:  [9.01705627]


portfolio before change:  [9.16448262]
curr_Stock_Price:  93.46559108661944
curr_Factors:  [93.46559109 -0.49612924 -0.97944905]
mat_Sqrt:  [[21.37057686  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00480312 -0.0048938  -0.07099424]
Stock Position:  -0.0048031209977699215
Bond Position:  [9.61340917]


portfolio before change:  [9.16738941]
curr_Stock_Price:  93.11060582144879
curr_Factors:  [93.11060582 -0.26774239 -0.96741442]
mat_Sqrt:  [[27.07555487  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.44035332e-04  1.52554126e-01 -1.15789865e+00]
Stock Position:  -0.0009440353317756929
Bond Position:  [9.25528911]


portfolio before change:  [9.16671977]
curr_Stock_Price:  95.0455203461164
curr_Factors:  [95.04552035 -0.34406618 -0.9920835 ]
mat_Sqrt:  [[24.98326628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02025493 0.07572051 0.18688029]
Stock Position:  0.020254931547053042
Bond Position:  [7.24157926]


portfolio before change:  [9.16091342]
curr_Stock_Price:  94.71416407614532
curr_Factors:  [94.71416408 -0.42152268 -0.99309037]
mat_Sqrt:  [[23.01740129  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00060693 -0.01824133  0.24068143]
Stock Position:  0.0006069291718685542
Bond Position:  [9.10342864]


portfolio before change:  [9.16147716]
curr_Stock_Price:  93.76798054176254
curr_Factors:  [93.76798054 -0.46747858 -0.99287132]
mat_Sqrt:  [[21.76870836  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00848144  0.06074621 -0.24703569]
Stock Position:  0.00848143598725041
Bond Position:  [8.36619003]


portfolio before change:  [9.1577825]
curr_Stock_Price:  93.20905388091143
curr_Factors:  [93.20905388 -0.46979207 -0.98565213]
mat_Sqrt:  [[21.74536562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00900209  0.03028061  0.03576687]
Stock Position:  -0.009002088555948598
Bond Position:  [9.99685865]


portfolio before change:  [9.14764978]
curr_Stock_Price:  94.47347141202083
curr_Factors:  [94.47347141 -0.26186175 -0.99635684]
mat_Sqrt:  [[26.84556106  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00536032 -0.01006984  0.45455116]
Stock Position:  -0.005360323078704434
Bond Position:  [9.65405811]


portfolio before change:  [9.15253438]
curr_Stock_Price:  93.7873619631347
curr_Factors:  [93.78736196 -0.39355865 -1.00090562]
mat_Sqrt:  [[23.25606233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00370494 -0.01128092 -0.05876362]
Stock Position:  -0.0037049412614541
Bond Position:  [9.50001105]


portfolio before change:  [9.15162715]
curr_Stock_Price:  94.35277264789754
curr_Factors:  [94.35277265 -0.21999951 -1.00650499]
mat_Sqrt:  [[27.6751847   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00181575  0.03405439 -0.09821894]
Stock Position:  -0.0018157508343440753
Bond Position:  [9.32294827]


portfolio before change:  [9.15586118]
curr_Stock_Price:  92.6627880228696
curr_Factors:  [92.66278802 -0.46039633 -0.98062774]
mat_Sqrt:  [[21.93191525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01397005 0.01295359 0.71637441]
Stock Position:  0.01397005212453945
Bond Position:  [7.8613572]


portfolio before change:  [9.16060168]
curr_Stock_Price:  92.93177550732466
curr_Factors:  [92.93177551 -0.56077146 -0.93963652]
mat_Sqrt:  [[20.7274237   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00429501  0.02455352 -0.4252362 ]
Stock Position:  0.004295006671920622
Bond Position:  [8.76145908]


portfolio before change:  [9.16603411]
curr_Stock_Price:  93.94159553104124
curr_Factors:  [93.94159553 -0.70035547 -0.93807113]
mat_Sqrt:  [[18.25148904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00072825 -0.00205373 -0.04933228]
Stock Position:  0.0007282479525299968
Bond Position:  [9.09762134]


portfolio before change:  [9.16793242]
curr_Stock_Price:  94.98661390507624
curr_Factors:  [94.98661391 -0.55444353 -0.92767374]
mat_Sqrt:  [[21.57680096  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00115948  0.03183219 -0.37698465]
Stock Position:  -0.0011594758772315223
Bond Position:  [9.27806711]


portfolio before change:  [9.17003204]
curr_Stock_Price:  94.17608589839593
curr_Factors:  [94.1760859  -0.44961003 -0.92854605]
mat_Sqrt:  [[23.73641128  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066721  0.02060442 -0.1683127 ]
Stock Position:  -0.000667211476262729
Bond Position:  [9.2328674]


portfolio before change:  [9.17093515]
curr_Stock_Price:  94.5523759084056
curr_Factors:  [94.55237591 -0.17204471 -0.96577881]
mat_Sqrt:  [[30.30553582  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00234898 -0.01826627  0.51956866]
Stock Position:  0.0023489767092425345
Bond Position:  [8.94883382]


portfolio before change:  [9.17274629]
curr_Stock_Price:  94.84716733790171
curr_Factors:  [94.84716734 -0.47242256 -0.97914633]
mat_Sqrt:  [[22.21344953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00342951  0.00489134 -0.09636675]
Stock Position:  -0.0034295053564600696
Bond Position:  [9.49802515]


portfolio before change:  [9.17208324]
curr_Stock_Price:  95.38671267293907
curr_Factors:  [95.38671267 -0.64548527 -0.98569579]
mat_Sqrt:  [[18.66701805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01016847 -0.05033036 -0.3457318 ]
Stock Position:  -0.010168468801839333
Bond Position:  [10.14202005]


portfolio before change:  [9.16974997]
curr_Stock_Price:  95.74085640342517
curr_Factors:  [95.7408564  -0.39476274 -0.98208861]
mat_Sqrt:  [[24.162305    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00492237 0.03382111 0.52880898]
Stock Position:  0.0049223706749933465
Bond Position:  [8.69847799]


portfolio before change:  [9.16978935]
curr_Stock_Price:  95.52795173011958
curr_Factors:  [95.52795173 -0.51073391 -0.9601612 ]
mat_Sqrt:  [[21.94465889  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00499104 -0.03907978 -0.47339768]
Stock Position:  0.004991040140014005
Bond Position:  [8.69300551]


portfolio before change:  [9.16877026]
curr_Stock_Price:  95.10603906798727
curr_Factors:  [95.10603907 -0.82730921 -0.95769498]
mat_Sqrt:  [[15.95844709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00700245 0.00095406 0.16799528]
Stock Position:  0.007002452788868448
Bond Position:  [8.50279472]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.17606906]
Stock Price:  95.9965671899683
PL:  [9.17606906]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.41326116e-01 -1.02048922e-01  2.26202160e-02]
 [-1.59920948e-01  1.06508183e-01 -2.93404253e-01]
 [-4.69920839e-02  5.00848768e-02  1.32936421e-02]
 [ 9.86824849e-02  1.27195993e-02  1.33632889e-01]
 [ 1.32887860e-01 -1.24397521e-01 -9.77022867e-02]
 [-1.29899442e-01 -1.64417218e-01  9.43862979e-02]
 [-5.44128372e-02 -1.51268511e-01  3.14328126e-03]
 [ 1.15891031e-02  7.30729725e-01  1.21426834e-01]
 [-2.89583155e-03  5.89763308e-02 -1.66478631e-02]
 [ 2.77072612e-01  1.00958259e-01  1.43365322e-01]
 [-1.19609216e-01 -2.73381059e-01 -3.17238802e-02]
 [ 2.41585769e-02 -1.45757087e-02  1.07176381e-01]
 [-1.67291945e-02  9.30239748e-02 -2.59940477e-02]
 [ 1.37851353e-02 -2.04516727e-01  3.92388433e-02]
 [-5.32825813e-02  1.21965296e-01 -3.46185220e-02]
 [ 9.83567102e-02 -4.39408642e-03 -1.02725245e-02]
 [ 4.86252943e-02  3.34714957e-02 -2.64857055e-02]
 [-3.55154091e-02 -5.93807311e-02 -1.01728418e-02]
 [ 3.01331772e-02  3.69214526e-02 -1.78732843e-01]
 [ 1.32714575e-03  1.76063641e-03 -2.51185886e-02]
 [-2.83703033e-02  4.15376949e-01 -3.66056630e-01]
 [ 2.46944092e-01  1.53602554e-01  8.21648235e-02]
 [ 2.51787166e-03 -3.58736756e-02  7.12615356e-02]
 [-9.92666216e-03 -9.99089144e-03 -7.06479744e-02]
 [-6.00386222e-03  1.87663661e-02 -8.67457201e-03]
 [-1.05452943e-01 -1.83653628e-02  2.23476777e-01]
 [-2.29452206e-02 -3.27139295e-02 -6.43276698e-04]
 [-8.64792400e-02  8.29399688e-02 -1.79954986e-01]
 [ 8.41068951e-03 -3.98104890e-02  7.47395098e-02]
 [-6.60558403e-03  2.96005333e-02 -3.97226913e-02]
 [ 1.66259521e-02 -3.38810172e-02 -5.37553805e-02]
 [-7.64855237e-04  9.95092254e-02 -1.06753548e-01]
 [-4.02415688e-02  2.40010648e-02 -1.42765304e-01]
 [ 2.82044656e-02 -4.78383090e-02  1.02476015e-01]
 [-6.53187374e-02  3.04970799e-02 -2.23534370e-02]
 [ 5.17802343e-02 -3.29545335e-02  9.45975679e-02]
 [-7.11647229e-02  7.75764493e-02 -3.08697344e-02]
 [-4.54514019e-02 -1.76539932e-02  3.25836692e-02]
 [ 9.68809962e-02  4.34571015e-03  7.21682532e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.82730117]
curr_Stock_Price:  100.81110293386237
curr_Factors:  [100.81110293  -1.05648453  -1.00257372]
mat_Sqrt:  [[12.8608814   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02002502 -0.03293615  0.06452918]
Stock Position:  -0.02002502200741264
Bond Position:  [10.84604572]


portfolio before change:  [8.83424063]
curr_Stock_Price:  100.53227090848885
curr_Factors:  [100.53227091  -1.17968193  -1.00960919]
mat_Sqrt:  [[11.2592235   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01759188  0.03437537 -0.83700066]
Stock Position:  -0.017591883521188432
Bond Position:  [10.60279263]


portfolio before change:  [8.84728305]
curr_Stock_Price:  99.86622575177859
curr_Factors:  [99.86622575 -1.21362642 -1.00507285]
mat_Sqrt:  [[10.86049916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00313568  0.01616482  0.03792306]
Stock Position:  -0.0031356752073243557
Bond Position:  [9.1604311]


portfolio before change:  [8.8484986]
curr_Stock_Price:  99.84376514193387
curr_Factors:  [99.84376514 -1.40269884 -0.97136559]
mat_Sqrt:  [[ 9.29560944  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01382982 0.00410523 0.38121744]
Stock Position:  0.01382981528227273
Bond Position:  [7.46767777]


portfolio before change:  [8.8607723]
curr_Stock_Price:  100.66374545544548
curr_Factors:  [100.66374546  -1.45033794  -0.95625194]
mat_Sqrt:  [[ 9.07202805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00965076 -0.04014913 -0.27871743]
Stock Position:  0.009650755744436494
Bond Position:  [7.88929108]


portfolio before change:  [8.86114308]
curr_Stock_Price:  100.59997399934336
curr_Factors:  [100.599974    -1.30597019  -0.97455334]
mat_Sqrt:  [[10.28440297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01402069 -0.05306543  0.26925784]
Stock Position:  -0.014020691765803936
Bond Position:  [10.2716243]


portfolio before change:  [8.86206468]
curr_Stock_Price:  100.62582361728158
curr_Factors:  [100.62582362  -1.225204    -0.96831605]
mat_Sqrt:  [[11.22214283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00754301 -0.0488217   0.00896691]
Stock Position:  -0.007543013338943364
Bond Position:  [9.62108661]


portfolio before change:  [8.86314829]
curr_Stock_Price:  100.64161335122931
curr_Factors:  [100.64161335  -1.53544006  -0.97349645]
mat_Sqrt:  [[ 8.18766959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02266027 0.235842   0.34639696]
Stock Position:  0.022660273506838035
Bond Position:  [6.5825818]


portfolio before change:  [8.84185272]
curr_Stock_Price:  99.66552429469837
curr_Factors:  [99.66552429 -1.55568643 -0.94633249]
mat_Sqrt:  [[ 8.1645442   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00070358  0.01903453 -0.04749172]
Stock Position:  0.0007035825398036506
Bond Position:  [8.7717298]


portfolio before change:  [8.84261227]
curr_Stock_Price:  99.18657549055187
curr_Factors:  [99.18657549 -1.3531606  -0.92772815]
mat_Sqrt:  [[10.1362077   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03225516 0.03258414 0.40898136]
Stock Position:  0.03225515537922709
Bond Position:  [5.64333387]


portfolio before change:  [8.82886974]
curr_Stock_Price:  98.73864721358274
curr_Factors:  [98.73864721 -1.52326598 -0.9289557 ]
mat_Sqrt:  [[ 8.50160314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02139461 -0.08823336 -0.0904994 ]
Stock Position:  -0.02139461210860218
Bond Position:  [10.9413448]


portfolio before change:  [8.8241811]
curr_Stock_Price:  99.02172739124752
curr_Factors:  [99.02172739 -1.29177374 -0.92053867]
mat_Sqrt:  [[10.83765767  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00397324 -0.00470429  0.30574438]
Stock Position:  0.003973239531970027
Bond Position:  [8.43074406]


portfolio before change:  [8.82288003]
curr_Stock_Price:  98.42901783734294
curr_Factors:  [98.42901784 -1.20539311 -0.94388967]
mat_Sqrt:  [[11.47364748  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00026554  0.03002336 -0.07415378]
Stock Position:  -0.00026554484105192195
Bond Position:  [8.84901735]


portfolio before change:  [8.82381924]
curr_Stock_Price:  99.05787450719326
curr_Factors:  [99.05787451 -1.35271813 -0.952241  ]
mat_Sqrt:  [[ 9.8822987   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00201897 -0.06600749  0.1119375 ]
Stock Position:  -0.002018970695572903
Bond Position:  [9.02381419]


portfolio before change:  [8.82604076]
curr_Stock_Price:  98.5162757286345
curr_Factors:  [98.51627573 -0.97991684 -0.95737439]
mat_Sqrt:  [[14.19557843  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249747  0.03936413 -0.09875701]
Stock Position:  -0.002497467496063561
Bond Position:  [9.07208196]


portfolio before change:  [8.82863072]
curr_Stock_Price:  97.93333177396681
curr_Factors:  [97.93333177 -0.87251554 -0.96153308]
mat_Sqrt:  [[15.64636048  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00609489 -0.00141819 -0.02930465]
Stock Position:  0.006094893497601318
Bond Position:  [8.2317375]


portfolio before change:  [8.82995325]
curr_Stock_Price:  97.98148660727138
curr_Factors:  [97.98148661 -0.94899222 -0.94723422]
mat_Sqrt:  [[14.71036145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00340245  0.01080288 -0.07555635]
Stock Position:  0.0034024495567729087
Bond Position:  [8.49657619]


portfolio before change:  [8.83118919]
curr_Stock_Price:  98.03256608983138
curr_Factors:  [98.03256609 -1.0590849  -0.95962358]
mat_Sqrt:  [[13.02136217  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0038178  -0.01916505 -0.02902029]
Stock Position:  -0.003817801244371053
Bond Position:  [9.20545804]


portfolio before change:  [8.83105332]
curr_Stock_Price:  98.36957188929664
curr_Factors:  [98.36957189 -1.00493923 -0.97290398]
mat_Sqrt:  [[13.61113652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.71380868e-05  1.19163476e-02 -5.09875051e-01]
Stock Position:  8.713808681160103e-05
Bond Position:  [8.82248158]


portfolio before change:  [8.83218994]
curr_Stock_Price:  98.75678762740363
curr_Factors:  [98.75678763 -1.05943237 -0.99708644]
mat_Sqrt:  [[12.63083852  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027241  0.00056824 -0.07165634]
Stock Position:  -0.00027241075647762577
Bond Position:  [8.85909235]


portfolio before change:  [8.83351499]
curr_Stock_Price:  97.95800838883017
curr_Factors:  [97.95800839 -0.98980634 -0.96761855]
mat_Sqrt:  [[13.83378801  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132305  0.13406233 -1.04425768]
Stock Position:  -0.001323053048713339
Bond Position:  [8.96311863]


portfolio before change:  [8.83476505]
curr_Stock_Price:  97.860054153499
curr_Factors:  [97.86005415 -0.81282725 -0.98267846]
mat_Sqrt:  [[16.24902209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01815924 0.04957501 0.23439337]
Stock Position:  0.01815924087287614
Bond Position:  [7.05770076]


portfolio before change:  [8.83274825]
curr_Stock_Price:  97.70040694642289
curr_Factors:  [97.70040695 -0.53525933 -1.00164509]
mat_Sqrt:  [[21.01005863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00046365 -0.01157818  0.20328933]
Stock Position:  0.000463653553806682
Bond Position:  [8.78744911]


portfolio before change:  [8.83405852]
curr_Stock_Price:  98.15714690112029
curr_Factors:  [98.1571469  -0.52170694 -0.99108094]
mat_Sqrt:  [[21.62352527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00122029 -0.00322455 -0.20153901]
Stock Position:  -0.0012202913906384162
Bond Position:  [8.95383884]


portfolio before change:  [8.8350781]
curr_Stock_Price:  98.23886059479234
curr_Factors:  [98.23886059 -0.46902652 -0.99868012]
mat_Sqrt:  [[22.63947849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0001742   0.00605682 -0.02474614]
Stock Position:  -0.00017420380856976634
Bond Position:  [8.85219168]


portfolio before change:  [8.83617091]
curr_Stock_Price:  98.31796895848966
curr_Factors:  [98.31796896 -0.76493285 -0.96991559]
mat_Sqrt:  [[17.34593816  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366569 -0.0059274   0.63751704]
Stock Position:  -0.0036656853327741118
Bond Position:  [9.19657365]


portfolio before change:  [8.83658136]
curr_Stock_Price:  98.51962271240565
curr_Factors:  [98.51962271 -0.72976576 -0.9518992 ]
mat_Sqrt:  [[18.33094812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162317 -0.01055838 -0.00183509]
Stock Position:  -0.0016231692750471904
Bond Position:  [8.99649538]


portfolio before change:  [8.83871004]
curr_Stock_Price:  97.9010518896436
curr_Factors:  [97.90105189 -0.83543105 -0.94814867]
mat_Sqrt:  [[16.45085714  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0064606   0.02676876 -0.51336148]
Stock Position:  -0.006460596344038265
Bond Position:  [9.47120921]


portfolio before change:  [8.84392423]
curr_Stock_Price:  97.27723719581907
curr_Factors:  [97.2772372  -0.91428711 -0.944591  ]
mat_Sqrt:  [[15.16040224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00102507 -0.01284878  0.21321102]
Stock Position:  0.001025074782907842
Bond Position:  [8.74420778]


portfolio before change:  [8.8450659]
curr_Stock_Price:  97.32463131665567
curr_Factors:  [97.32463132 -0.94601163 -0.93122823]
mat_Sqrt:  [[14.89182253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058232  0.00955353 -0.11331778]
Stock Position:  -0.0005823169633191119
Bond Position:  [8.90173969]


portfolio before change:  [8.84620122]
curr_Stock_Price:  97.28593275962581
curr_Factors:  [97.28593276 -0.83050774 -0.95355558]
mat_Sqrt:  [[16.33959143  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.72817769e-05 -1.09350513e-02 -1.53349138e-01]
Stock Position:  -7.728177692231964e-05
Bond Position:  [8.85371965]


portfolio before change:  [8.84730371]
curr_Stock_Price:  97.3415346034695
curr_Factors:  [97.3415346  -0.79644567 -0.91883095]
mat_Sqrt:  [[17.51309945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.28109611e-04  3.21164644e-02 -3.04538157e-01]
Stock Position:  -0.00012810961059662003
Bond Position:  [8.8597741]


portfolio before change:  [8.84823168]
curr_Stock_Price:  98.7432354253492
curr_Factors:  [98.74323543 -0.53030259 -0.93673403]
mat_Sqrt:  [[22.7709655   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00283186  0.00774631 -0.40726967]
Stock Position:  -0.0028318613705634946
Bond Position:  [9.12785883]


portfolio before change:  [8.84882446]
curr_Stock_Price:  98.93684356608887
curr_Factors:  [98.93684357 -0.81405693 -0.93735513]
mat_Sqrt:  [[17.16838557  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00229243 -0.01543975  0.29233555]
Stock Position:  0.002292431071365136
Bond Position:  [8.62201857]


portfolio before change:  [8.84687249]
curr_Stock_Price:  97.61519330485599
curr_Factors:  [97.6151933  -0.62147128 -0.91567206]
mat_Sqrt:  [[20.98671914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303318  0.00984289 -0.06376813]
Stock Position:  -0.00303317649813512
Bond Position:  [9.1429566]


portfolio before change:  [8.84463493]
curr_Stock_Price:  98.72970096506957
curr_Factors:  [98.72970097 -0.37805858 -0.88988103]
mat_Sqrt:  [[27.7836081   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00231658 -0.01063603  0.26986053]
Stock Position:  0.00231658414309761
Bond Position:  [8.61591927]


portfolio before change:  [8.84833841]
curr_Stock_Price:  99.8634496859388
curr_Factors:  [99.86344969 -0.40656767 -0.90117969]
mat_Sqrt:  [[27.00592797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00228212  0.02503769 -0.08806276]
Stock Position:  -0.002282119492036905
Bond Position:  [9.07623874]


portfolio before change:  [8.84983932]
curr_Stock_Price:  99.70294008264862
curr_Factors:  [99.70294008 -0.38369263 -0.91764902]
mat_Sqrt:  [[27.13578996  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00156266 -0.0056978   0.09295214]
Stock Position:  -0.0015626556167776828
Bond Position:  [9.00564068]


portfolio before change:  [8.85280626]
curr_Stock_Price:  98.5247092037886
curr_Factors:  [98.5247092  -0.43670236 -0.95828554]
mat_Sqrt:  [[24.4179733   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00460724 0.00140257 0.20587594]
Stock Position:  0.004607235098445816
Bond Position:  [8.39887976]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.85320343]
Stock Price:  98.38302808888109
PL:  [8.85320343]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-8.91831724e-02 -8.87529843e-02  1.47751285e-02]
 [-9.72165061e-02  7.88143323e-02 -9.36043605e-02]
 [ 4.60513343e-03  6.16782434e-03  4.97435479e-02]
 [ 1.28515338e-01  3.03421959e-02  1.52742192e-01]
 [ 1.11325005e-01 -7.76522403e-02 -8.83032711e-02]
 [-1.29949299e-01 -1.63712181e-01  9.83721392e-02]
 [-6.03539963e-02 -1.84955818e-01  1.02444803e-01]
 [-2.38867126e-02  7.96941938e-01  1.58215071e-01]
 [ 2.37542544e-01 -2.68729081e-02  2.33122190e-01]
 [ 2.84126286e-01  1.03900531e-01  1.49323338e-01]
 [-1.44816906e-01 -1.57024273e-01  5.64807332e-02]
 [-6.41349940e-02 -1.89300541e-02  8.90619845e-02]
 [ 4.63238656e-03 -4.02288354e-02  1.34136529e-01]
 [ 9.71924933e-03 -1.20535732e-01  5.10410641e-02]
 [-2.97627319e-02  8.06807598e-02 -4.82052947e-02]
 [-2.82872229e-02 -4.03623748e-02  7.58933721e-02]
 [ 4.87624038e-02  2.17676066e-02 -1.21190315e-02]
 [-4.79078821e-02 -6.19932847e-02  1.04600095e-03]
 [ 5.36802624e-02  5.03661586e-02 -2.32996456e-01]
 [-2.61766697e-02  2.84944342e-02 -6.09395993e-02]
 [-4.82973210e-02  5.94944814e-01 -5.83242805e-01]
 [ 3.44508619e-01  2.00286851e-01  6.62771278e-02]
 [-2.46973510e-02  1.40970826e-01 -4.88848959e-02]
 [-5.59318936e-02 -1.26729818e-01 -2.60913573e-02]
 [ 3.29009013e-02 -1.13221841e-02 -1.13963668e-02]
 [-2.50270336e-02  1.19796696e-02  7.03889149e-02]
 [ 8.64837026e-02 -2.78050338e-02  4.15217493e-02]
 [ 7.82252669e-02 -5.56650709e-02 -1.06306810e-01]
 [-4.66931782e-02 -1.86843322e-02 -2.56082552e-02]
 [-7.38407123e-02 -9.86138903e-03  3.71113067e-02]
 [-3.62930151e-02 -5.53265048e-02 -3.18417259e-02]
 [ 2.60895768e-02 -1.94362402e-02 -6.20902846e-02]
 [-1.69828569e-02  1.04729705e-02  1.30668961e-01]
 [ 7.56198761e-03 -7.69118984e-02 -5.91601560e-02]
 [-1.19570287e-02  1.13087193e-01  4.57108354e-02]
 [ 7.01513359e-02  1.52333892e-02  1.56513393e-01]
 [-7.77806816e-02  5.72755287e-02 -8.60904475e-02]
 [-7.74346042e-02 -7.10452799e-04  5.01063340e-02]
 [ 1.24703839e-01  1.00301359e-03  9.61529393e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.66136849]
curr_Stock_Price:  100.1598211693081
curr_Factors:  [100.15982117  -1.02275094  -1.00043959]
mat_Sqrt:  [[13.24442339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00787379 -0.0286449   0.04214933]
Stock Position:  -0.007873792303477007
Bond Position:  [4.45000611]


portfolio before change:  [3.65410091]
curr_Stock_Price:  101.15348029449399
curr_Factors:  [101.15348029  -1.09914744  -1.02609079]
mat_Sqrt:  [[12.07818278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00829889  0.02543722 -0.26702719]
Stock Position:  -0.008298889813740865
Bond Position:  [4.49356249]


portfolio before change:  [3.65880194]
curr_Stock_Price:  100.6547027680685
curr_Factors:  [100.65470277  -0.97208059  -1.02888021]
mat_Sqrt:  [[13.60905085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00117701 0.00199066 0.1419045 ]
Stock Position:  0.0011770104089695395
Bond Position:  [3.5403303]


portfolio before change:  [3.6585737]
curr_Stock_Price:  100.08478015039901
curr_Factors:  [100.08478015  -0.84348272  -1.03887432]
mat_Sqrt:  [[15.23599297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01088786 0.0097929  0.43573096]
Stock Position:  0.010887855028400053
Bond Position:  [2.56886512]


portfolio before change:  [3.66727566]
curr_Stock_Price:  100.85452192244682
curr_Factors:  [100.85452192  -0.82162704  -1.03680069]
mat_Sqrt:  [[15.72499316  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00492525 -0.02506215 -0.25190465]
Stock Position:  0.004925247185387655
Bond Position:  [3.17054221]


portfolio before change:  [3.66463295]
curr_Stock_Price:  100.23748572350739
curr_Factors:  [100.23748572  -0.74217317  -1.03409301]
mat_Sqrt:  [[16.96709781  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00844498 -0.05283788  0.28062833]
Stock Position:  -0.008444978672252966
Bond Position:  [4.51113638]


portfolio before change:  [3.66850342]
curr_Stock_Price:  99.84594692994818
curr_Factors:  [99.84594693 -0.83617628 -1.03247616]
mat_Sqrt:  [[15.4093741   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00500971 -0.05969423  0.29224651]
Stock Position:  -0.005009709420385478
Bond Position:  [4.1687026]


portfolio before change:  [3.67349129]
curr_Stock_Price:  98.95432777268655
curr_Factors:  [98.95432777 -0.70401085 -1.04585417]
mat_Sqrt:  [[17.19800501  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00994789 0.2572119  0.45134356]
Stock Position:  0.00994789194210969
Bond Position:  [2.68910433]


portfolio before change:  [3.68032504]
curr_Stock_Price:  99.60749064524715
curr_Factors:  [99.60749065 -0.79647894 -1.04038779]
mat_Sqrt:  [[15.86904956  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01762191 -0.00867319  0.66503272]
Stock Position:  0.01762191243958858
Bond Position:  [1.92505056]


portfolio before change:  [3.65254924]
curr_Stock_Price:  98.01762614456455
curr_Factors:  [98.01762614 -0.66800609 -1.04245412]
mat_Sqrt:  [[17.71987899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01895134 0.03353375 0.42597792]
Stock Position:  0.018951336611833312
Bond Position:  [1.79498421]


portfolio before change:  [3.66188488]
curr_Stock_Price:  98.49839718656246
curr_Factors:  [98.49839719 -0.67249842 -1.07120537]
mat_Sqrt:  [[17.22456362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0095991  -0.05067937  0.16112381]
Stock Position:  -0.009599097754163484
Bond Position:  [4.60738062]


portfolio before change:  [3.6597214]
curr_Stock_Price:  98.78378197169137
curr_Factors:  [98.78378197 -0.69667419 -1.07412824]
mat_Sqrt:  [[16.81264048  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296321 -0.00610965  0.25406905]
Stock Position:  -0.0029632093578215468
Bond Position:  [3.95243843]


portfolio before change:  [3.66002281]
curr_Stock_Price:  98.84880371849322
curr_Factors:  [98.84880372 -0.82895751 -1.06516918]
mat_Sqrt:  [[14.87176962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00160043 -0.0129838   0.38265418]
Stock Position:  0.0016004291890760246
Bond Position:  [3.5018223]


portfolio before change:  [3.65976895]
curr_Stock_Price:  98.4166601797954
curr_Factors:  [98.41666018 -0.72700188 -1.03743263]
mat_Sqrt:  [[16.85716164  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00026495 -0.03890274  0.14560595]
Stock Position:  -0.0002649491380052019
Bond Position:  [3.68584436]


portfolio before change:  [3.66006944]
curr_Stock_Price:  99.02155186987565
curr_Factors:  [99.02155187 -0.73481523 -1.01183388]
mat_Sqrt:  [[17.26512211  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00133991  0.0260396  -0.13751629]
Stock Position:  -0.0013399097454636615
Bond Position:  [3.79274939]


portfolio before change:  [3.65819042]
curr_Stock_Price:  100.7777511131673
curr_Factors:  [100.77775111  -0.95404664  -1.02176898]
mat_Sqrt:  [[13.97265186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0015054  -0.0130269   0.21650267]
Stock Position:  -0.0015054041719790054
Bond Position:  [3.80990167]


portfolio before change:  [3.65870333]
curr_Stock_Price:  100.75340874099743
curr_Factors:  [100.75340874  -0.94859254  -1.05523654]
mat_Sqrt:  [[13.58337952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00373485  0.00702546 -0.03457222]
Stock Position:  0.00373485191206347
Bond Position:  [3.28240427]


portfolio before change:  [3.65482499]
curr_Stock_Price:  99.60512442280543
curr_Factors:  [99.60512442 -0.66211258 -1.06032236]
mat_Sqrt:  [[17.79252947  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0033918  -0.02000825  0.00298395]
Stock Position:  -0.003391799594537328
Bond Position:  [3.99266561]


portfolio before change:  [3.65588026]
curr_Stock_Price:  99.44115401489172
curr_Factors:  [99.44115401 -0.59264489 -1.06037144]
mat_Sqrt:  [[19.04014638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00086139  0.01625561 -0.66467404]
Stock Position:  0.0008613909066599822
Bond Position:  [3.57022255]


portfolio before change:  [3.65600985]
curr_Stock_Price:  99.07348545782224
curr_Factors:  [99.07348546 -0.50205592 -1.06466629]
mat_Sqrt:  [[20.67943331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00158609  0.00919654 -0.17384371]
Stock Position:  -0.0015860933336356966
Bond Position:  [3.81314965]


portfolio before change:  [3.65316504]
curr_Stock_Price:  101.16761990068446
curr_Factors:  [101.1676199   -0.35070324  -1.09750204]
mat_Sqrt:  [[23.77354635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193108  0.19201761 -1.66382938]
Stock Position:  -0.0019310816216164854
Bond Position:  [3.84852797]


portfolio before change:  [3.65191635]
curr_Stock_Price:  102.06338004602082
curr_Factors:  [102.06338005  -0.2072213   -1.11428408]
mat_Sqrt:  [[27.22371911  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01465343 0.0646423  0.1890702 ]
Stock Position:  0.01465342636222564
Bond Position:  [2.15633812]


portfolio before change:  [3.67395688]
curr_Stock_Price:  103.5491060882808
curr_Factors:  [103.54910609  -0.43765758  -1.1356761 ]
mat_Sqrt:  [[21.47119511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0002748   0.04549814 -0.139455  ]
Stock Position:  -0.0002748048774920239
Bond Position:  [3.70241268]


portfolio before change:  [3.67456695]
curr_Stock_Price:  103.01331071412815
curr_Factors:  [103.01331071  -0.39528803  -1.13128572]
mat_Sqrt:  [[22.38261321  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00389259 -0.04090187 -0.07443138]
Stock Position:  -0.0038925921933741134
Bond Position:  [4.07555576]


portfolio before change:  [3.67585446]
curr_Stock_Price:  102.81343507919483
curr_Factors:  [102.81343508  -0.39021936  -1.12598425]
mat_Sqrt:  [[22.57205024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00125215 -0.00365422 -0.03251066]
Stock Position:  0.0012521457380085912
Bond Position:  [3.54711706]


portfolio before change:  [3.67666888]
curr_Stock_Price:  103.10972993654926
curr_Factors:  [103.10972994  -0.30624968  -1.12660414]
mat_Sqrt:  [[24.60476042  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033382  0.00386642  0.20079998]
Stock Position:  -0.0003338222569661007
Bond Position:  [3.71108921]


portfolio before change:  [3.67679458]
curr_Stock_Price:  104.1229086363822
curr_Factors:  [104.12290864  -0.24289254  -1.11069918]
mat_Sqrt:  [[26.89607318  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00331958 -0.00897404  0.11844999]
Stock Position:  0.0033195780961798966
Bond Position:  [3.33115045]


portfolio before change:  [3.66657698]
curr_Stock_Price:  100.91948464801459
curr_Factors:  [100.91948465  -0.15677736  -1.11085247]
mat_Sqrt:  [[28.408636    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00158976 -0.01796582 -0.30326374]
Stock Position:  0.0015897593632492693
Bond Position:  [3.50613929]


portfolio before change:  [3.67003986]
curr_Stock_Price:  102.82202437705523
curr_Factors:  [102.82202438  -0.43755347  -1.128176  ]
mat_Sqrt:  [[21.48317588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259433 -0.00603034 -0.07305322]
Stock Position:  -0.0025943261416847404
Bond Position:  [3.93679372]


portfolio before change:  [3.6729563]
curr_Stock_Price:  101.88755757876667
curr_Factors:  [101.88755758  -0.65073487  -1.12190998]
mat_Sqrt:  [[17.30897212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00394468 -0.00318275  0.10586823]
Stock Position:  -0.003944679423663306
Bond Position:  [4.07487005]


portfolio before change:  [3.67692983]
curr_Stock_Price:  101.00937730773957
curr_Factors:  [101.00937731  -0.61002006  -1.13540088]
mat_Sqrt:  [[17.63335732  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306726 -0.01785655 -0.09083558]
Stock Position:  -0.003067263635611385
Bond Position:  [3.98675222]


portfolio before change:  [3.67551598]
curr_Stock_Price:  101.6328063747294
curr_Factors:  [101.63280637  -0.64381788  -1.15438582]
mat_Sqrt:  [[16.8299944   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00056138 -0.00627302 -0.1771263 ]
Stock Position:  0.0005613813281436764
Bond Position:  [3.61846122]


portfolio before change:  [3.67622746]
curr_Stock_Price:  102.09441722817866
curr_Factors:  [102.09441723  -0.43013898  -1.16385568]
mat_Sqrt:  [[20.73666484  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00057037 0.00338014 0.37276217]
Stock Position:  0.0005703722977213345
Bond Position:  [3.61799563]


portfolio before change:  [3.6767322]
curr_Stock_Price:  102.18640474531344
curr_Factors:  [102.18640475  -0.25899413  -1.19399273]
mat_Sqrt:  [[23.89840657  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084581 -0.02482321 -0.16876746]
Stock Position:  -0.0008458138882151299
Bond Position:  [3.76316288]


portfolio before change:  [3.67687742]
curr_Stock_Price:  102.57089626607788
curr_Factors:  [102.57089627  -0.10353674  -1.18223845]
mat_Sqrt:  [[28.35430964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00072149 0.03649873 0.13040029]
Stock Position:  0.0007214946641255291
Bond Position:  [3.60287306]


portfolio before change:  [3.67678014]
curr_Stock_Price:  101.81181791542667
curr_Factors:  [ 1.01811818e+02  7.23340212e-02 -1.17539430e+00]
mat_Sqrt:  [[33.78665531  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00311392 0.00491656 0.44648914]
Stock Position:  0.0031139217525432065
Bond Position:  [3.3597461]


portfolio before change:  [3.67436134]
curr_Stock_Price:  100.90017455892017
curr_Factors:  [ 1.00900175e+02 -2.38798807e-02 -1.15966468e+00]
mat_Sqrt:  [[30.89477573  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270798  0.0184856  -0.24559208]
Stock Position:  -0.00270798218341683
Bond Position:  [3.94759722]


portfolio before change:  [3.67509808]
curr_Stock_Price:  100.81034466940126
curr_Factors:  [ 1.00810345e+02  6.02791932e-02 -1.17744339e+00]
mat_Sqrt:  [[32.9857871   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00204184 -0.0002293   0.14293942]
Stock Position:  -0.002041840384088381
Bond Position:  [3.88093672]


portfolio before change:  [3.67293658]
curr_Stock_Price:  102.1065519198175
curr_Factors:  [ 1.02106552e+02 -8.97266686e-03 -1.17535532e+00]
mat_Sqrt:  [[31.23967468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00462667 0.00032372 0.27429757]
Stock Position:  0.004626671578310157
Bond Position:  [3.2005231]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.67351847]
Stock Price:  102.14584606945063
PL:  [1.5276724]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.47773165e-01 -1.04038933e-01  2.25001468e-02]
 [-1.15378109e-01  7.01583367e-02 -1.21294264e-01]
 [-1.95649411e-01 -2.02103229e-02 -1.30075102e-01]
 [-1.07147726e-01 -2.98025272e-02 -3.51422058e-02]
 [ 1.87451492e-01 -1.94828930e-01 -1.04665900e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.25626427e-02 -1.59706546e-01 -2.71909757e-02]
 [ 1.00657528e-02  6.08369930e-01  8.94392233e-02]
 [ 4.23781251e-01  5.32013976e-02  4.16720862e-01]
 [ 6.89073851e-01  3.00282824e-01  5.80016020e-01]
 [-1.49541755e-01 -2.66198253e-01 -3.52613702e-02]
 [-1.12173092e-01 -2.86925999e-02  8.30957127e-02]
 [ 1.24935307e-02 -9.31035503e-02  1.22476017e-01]
 [ 1.99523306e-03  7.07181043e-02 -3.50815579e-02]
 [ 6.21953928e-01 -1.72485702e-01 -2.88552550e-01]
 [-1.77271730e-01 -9.43465803e-02  1.11754069e-01]
 [ 5.10529270e-02  1.76566852e-02 -2.55157648e-02]
 [-6.17910190e-02 -6.36294727e-02  2.15103102e-02]
 [ 1.96882042e-01 -2.47779454e-01  7.19961136e-02]
 [ 6.52880098e-02  1.79610401e-03  4.68721264e-01]
 [-1.94132640e-02  3.67976355e-01 -3.49648475e-01]
 [ 2.63797234e-01  1.61666726e-01  7.94204081e-02]
 [-3.73206746e-02  1.82669055e-01 -7.41168586e-02]
 [ 3.95531337e-02 -1.60502755e-01 -1.94708593e-01]
 [ 3.83490743e-03 -3.04509905e-02 -7.93376697e-03]
 [ 2.63645578e-02  2.77113151e-02 -6.27312421e-02]
 [ 9.17198498e-02 -2.02600482e-03  2.41688436e-01]
 [ 1.69200954e-01 -5.16844617e-02  2.26524836e-01]
 [-2.07173014e-02  3.95046790e-02 -1.28721029e-01]
 [-6.53551930e-02  1.32782927e-02  1.10310031e-02]
 [ 7.80521665e-02 -9.76169737e-03  1.04847280e-02]
 [ 2.68654439e-02 -1.09423660e-01 -2.05439310e-01]
 [ 2.49739589e-02 -2.58114717e-03  1.54680736e-01]
 [-6.76406857e-03 -1.04310386e-01 -2.48836801e-01]
 [ 7.00385787e-02  3.03450522e-01 -1.25316740e-01]
 [-5.12527166e-02 -2.81326667e-02 -1.70374756e-02]
 [ 4.49371640e-01 -2.65632488e-01  2.92464176e-01]
 [-1.14315965e-01  5.58164847e-02  4.60872231e-02]
 [ 3.07971199e-01 -3.54244640e-02  5.84531407e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.81706852]
curr_Stock_Price:  100.80981287836497
curr_Factors:  [100.80981288  -1.03496887  -1.00323224]
mat_Sqrt:  [[13.13177135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02013568 -0.03357842  0.06418666]
Stock Position:  -0.02013568416289903
Bond Position:  [10.84694307]


portfolio before change:  [8.82245351]
curr_Stock_Price:  100.6097184459634
curr_Factors:  [100.60971845  -0.92048249  -1.01637483]
mat_Sqrt:  [[14.50352231  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00867487  0.02264351 -0.34601877]
Stock Position:  -0.008674871113183167
Bond Position:  [9.69522985]


portfolio before change:  [8.81270268]
curr_Stock_Price:  101.87346123960482
curr_Factors:  [101.87346124  -0.74088222  -1.0173779 ]
mat_Sqrt:  [[17.55732676  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0128907  -0.00652285 -0.37106806]
Stock Position:  -0.012890703562610382
Bond Position:  [10.12592327]


portfolio before change:  [8.81852243]
curr_Stock_Price:  101.52018923766714
curr_Factors:  [101.52018924  -0.58951565  -1.01357171]
mat_Sqrt:  [[20.43339008  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00589254 -0.00961872 -0.10025093]
Stock Position:  -0.005892537334832433
Bond Position:  [9.41673393]


portfolio before change:  [8.81706576]
curr_Stock_Price:  101.96716656514756
curr_Factors:  [101.96716657  -0.60381233  -0.99339969]
mat_Sqrt:  [[20.64429163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00611876 -0.06288077 -0.29858268]
Stock Position:  0.0061187551390918795
Bond Position:  [8.19315364]


portfolio before change:  [8.8166811]
curr_Stock_Price:  101.73691288397593
curr_Factors:  [101.73691288  -0.62466818  -1.01473391]
mat_Sqrt:  [[19.74673384  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00776352 -0.05534923  0.15513819]
Stock Position:  -0.007763521675290373
Bond Position:  [9.60651783]


portfolio before change:  [8.82050706]
curr_Stock_Price:  101.39878455232898
curr_Factors:  [101.39878455  -0.88581897  -0.99573467]
mat_Sqrt:  [[15.44843125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00587198 -0.05154507 -0.07756829]
Stock Position:  -0.005871983898335002
Bond Position:  [9.41591909]


portfolio before change:  [8.81741346]
curr_Stock_Price:  102.12607900055447
curr_Factors:  [102.126079    -0.91941086  -0.98919244]
mat_Sqrt:  [[15.14400621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01007035 0.19635055 0.25514521]
Stock Position:  0.010070350450611195
Bond Position:  [7.78896806]


portfolio before change:  [8.82455486]
curr_Stock_Price:  102.7385418864155
curr_Factors:  [102.73854189  -0.9011811   -0.97894681]
mat_Sqrt:  [[15.67487984  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0331552  0.01717068 1.18878863]
Stock Position:  0.033155197116537916
Bond Position:  [5.41823825]


portfolio before change:  [8.81825641]
curr_Stock_Price:  102.52814434860268
curr_Factors:  [102.52814435  -0.51636788  -0.97307099]
mat_Sqrt:  [[23.12001001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03757629 0.09691586 1.65462426]
Stock Position:  0.03757628566227176
Bond Position:  [4.96562957]


portfolio before change:  [8.86427222]
curr_Stock_Price:  103.7362219327878
curr_Factors:  [103.73622193  -0.72772479  -0.95808465]
mat_Sqrt:  [[19.22173962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01098116 -0.08591512 -0.10059087]
Stock Position:  -0.010981157125625649
Bond Position:  [10.00341597]


portfolio before change:  [8.84588803]
curr_Stock_Price:  105.52425666946604
curr_Factors:  [105.52425667  -0.50181091  -0.97543517]
mat_Sqrt:  [[24.08754186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00419587 -0.0092605   0.23704894]
Stock Position:  -0.004195866225794417
Bond Position:  [9.2886537]


portfolio before change:  [8.84379309]
curr_Stock_Price:  106.30028285439249
curr_Factors:  [106.30028285  -0.49651471  -0.97465419]
mat_Sqrt:  [[24.41259167  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00075736 -0.03004904  0.34938998]
Stock Position:  0.0007573616304206237
Bond Position:  [8.76328533]


portfolio before change:  [8.84464484]
curr_Stock_Price:  105.97847361903642
curr_Factors:  [105.97847362  -0.76671859  -0.98897505]
mat_Sqrt:  [[18.31173938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00050621  0.02282417 -0.10007792]
Stock Position:  0.0005062060156392913
Bond Position:  [8.7909979]


portfolio before change:  [8.84576995]
curr_Stock_Price:  106.03017180942791
curr_Factors:  [106.03017181  -0.90545804  -1.01293541]
mat_Sqrt:  [[15.56975482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03390194 -0.05566952 -0.82316011]
Stock Position:  0.0339019396643762
Bond Position:  [5.25114147]


portfolio before change:  [8.82639679]
curr_Stock_Price:  105.4393619825598
curr_Factors:  [105.43936198  -0.82252483  -0.99286715]
mat_Sqrt:  [[17.16279638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0101218  -0.03045023  0.31880325]
Stock Position:  -0.010121802837375389
Bond Position:  [9.89363322]


portfolio before change:  [8.84213633]
curr_Stock_Price:  104.00653787885496
curr_Factors:  [104.00653788  -0.75458934  -0.99266395]
mat_Sqrt:  [[18.12333747  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00272845  0.00569867 -0.07278937]
Stock Position:  0.0027284543586633017
Bond Position:  [8.55835924]


portfolio before change:  [8.84534423]
curr_Stock_Price:  104.79014591959786
curr_Factors:  [104.79014592  -0.89495695  -0.96124984]
mat_Sqrt:  [[16.37495362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429855 -0.02053632  0.06136293]
Stock Position:  -0.0042985500079866495
Bond Position:  [9.29578992]


portfolio before change:  [8.84309289]
curr_Stock_Price:  105.58422565516457
curr_Factors:  [105.58422566  -1.10269123  -0.98144749]
mat_Sqrt:  [[13.13618013  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01225626 -0.07997048  0.20538487]
Stock Position:  0.012256258369235393
Bond Position:  [7.54902534]


portfolio before change:  [8.85215622]
curr_Stock_Price:  106.24671557104347
curr_Factors:  [106.24671557  -1.12856024  -0.97955907]
mat_Sqrt:  [[12.90538394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.25011364e-02 5.79690078e-04 1.33713130e+00]
Stock Position:  0.012501136434326194
Bond Position:  [7.52395154]


portfolio before change:  [8.84625172]
curr_Stock_Price:  105.69916095320934
curr_Factors:  [105.69916095  -1.37910051  -0.98602002]
mat_Sqrt:  [[ 9.92916535  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00157839  0.11876386 -0.99744978]
Stock Position:  -0.001578390582194144
Bond Position:  [9.01308628]


portfolio before change:  [8.8467673]
curr_Stock_Price:  106.08634299805169
curr_Factors:  [106.086343    -1.29587887  -0.97174841]
mat_Sqrt:  [[10.98604728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0284915  0.05217771 0.22656432]
Stock Position:  0.028491497503054665
Bond Position:  [5.82420853]


portfolio before change:  [8.82312019]
curr_Stock_Price:  105.23081803102123
curr_Factors:  [105.23081803  -1.13077489  -0.9728431 ]
mat_Sqrt:  [[12.83965229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118092  0.05895618 -0.21143477]
Stock Position:  -0.001180915957654162
Bond Position:  [8.94738894]


portfolio before change:  [8.82259217]
curr_Stock_Price:  106.62508516395076
curr_Factors:  [106.62508516  -1.13001314  -0.97147458]
mat_Sqrt:  [[13.03751659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252763 -0.05180204 -0.55544942]
Stock Position:  -0.002527634677703652
Bond Position:  [9.09210143]


portfolio before change:  [8.82199356]
curr_Stock_Price:  107.31157416805758
curr_Factors:  [107.31157417  -1.19771909  -1.00296117]
mat_Sqrt:  [[11.88237548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033666 -0.00982801 -0.02263283]
Stock Position:  -0.00033666234406479385
Bond Position:  [8.85812132]


portfolio before change:  [8.82272214]
curr_Stock_Price:  108.43660686252045
curr_Factors:  [108.43660686  -1.37140803  -1.02055063]
mat_Sqrt:  [[ 9.91656983  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00193778  0.00894379 -0.17895477]
Stock Position:  0.0019377814570430865
Bond Position:  [8.61259569]


portfolio before change:  [8.82435156]
curr_Stock_Price:  108.7218708106001
curr_Factors:  [108.72187081  -1.28600161  -1.03849464]
mat_Sqrt:  [[10.63655581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.32223947e-02 -6.53890245e-04  6.89469835e-01]
Stock Position:  0.0132223946521932
Bond Position:  [7.38678807]


portfolio before change:  [8.82429212]
curr_Stock_Price:  108.64753878612635
curr_Factors:  [108.64753879  -1.22088565  -1.02089118]
mat_Sqrt:  [[11.54592115  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01774567 -0.01668109  0.64621231]
Stock Position:  0.017745669074128844
Bond Position:  [6.89626885]


portfolio before change:  [8.82356166]
curr_Stock_Price:  108.55779585556793
curr_Factors:  [108.55779586  -0.89623768  -1.04266524]
mat_Sqrt:  [[15.61730805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249265  0.01275008 -0.36720527]
Stock Position:  -0.002492651897480917
Bond Position:  [9.09415845]


portfolio before change:  [8.82619939]
curr_Stock_Price:  107.95566981157985
curr_Factors:  [107.95566981  -0.74533394  -1.02539189]
mat_Sqrt:  [[18.37506998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328669  0.00428555  0.03146838]
Stock Position:  -0.003286685648142976
Bond Position:  [9.18101574]


portfolio before change:  [8.82604796]
curr_Stock_Price:  108.35093803797488
curr_Factors:  [108.35093804  -0.85209385  -1.03492442]
mat_Sqrt:  [[16.4176524   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00476315 -0.00315057  0.02991001]
Stock Position:  0.004763150820419333
Bond Position:  [8.3099561]


portfolio before change:  [8.82680433]
curr_Stock_Price:  108.29164138745294
curr_Factors:  [108.29164139  -0.91520474  -1.01992987]
mat_Sqrt:  [[15.63783598  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.002392   -0.03531633 -0.58606117]
Stock Position:  -0.002391999179667025
Bond Position:  [9.08583785]


portfolio before change:  [8.8303034]
curr_Stock_Price:  107.30365188237303
curr_Factors:  [107.30365188  -0.728455    -0.98854673]
mat_Sqrt:  [[19.2721482   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00290685 -0.00083306  0.44126109]
Stock Position:  0.0029068455167218675
Bond Position:  [8.51838826]


portfolio before change:  [8.83030408]
curr_Stock_Price:  106.93755344604196
curr_Factors:  [106.93755345  -0.79860546  -1.01739319]
mat_Sqrt:  [[17.39610616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00453262 -0.03366603 -0.70986213]
Stock Position:  -0.004532619866474122
Bond Position:  [9.31501136]


portfolio before change:  [8.82782618]
curr_Stock_Price:  107.74113829242637
curr_Factors:  [107.74113829  -0.87629952  -1.03306971]
mat_Sqrt:  [[15.96441605  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00666482  0.09793823 -0.35749378]
Stock Position:  0.006664821588509897
Bond Position:  [8.10975072]


portfolio before change:  [8.83070929]
curr_Stock_Price:  108.02161513633507
curr_Factors:  [108.02161514  -1.13119398  -1.00549977]
mat_Sqrt:  [[12.75135567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00474248 -0.00907978 -0.04860318]
Stock Position:  -0.004742478744471182
Bond Position:  [9.34299951]


portfolio before change:  [8.83675302]
curr_Stock_Price:  106.99350674369738
curr_Factors:  [106.99350674  -0.81103188  -0.97460464]
mat_Sqrt:  [[17.941772    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02535138 -0.08573252  0.83431889]
Stock Position:  0.025351377534092473
Bond Position:  [6.12432024]


portfolio before change:  [8.84164504]
curr_Stock_Price:  107.15627601762593
curr_Factors:  [107.15627602  -1.04437886  -0.97645453]
mat_Sqrt:  [[14.20302406  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00658416  0.01801469  0.13147402]
Stock Position:  -0.006584158229080532
Bond Position:  [9.54717891]


portfolio before change:  [8.84621322]
curr_Stock_Price:  106.643725559929
curr_Factors:  [106.64372556  -0.96010698  -0.96057462]
mat_Sqrt:  [[15.62405967  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02001221 -0.0114332   0.16675054]
Stock Position:  0.02001220644077264
Bond Position:  [6.71203697]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.84944606]
Stock Price:  106.76334160279846
PL:  [2.08610446]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.96798242e-01 -1.00768847e-01  1.94959126e-02]
 [-1.32772531e-01  6.88817543e-02 -1.43960839e-01]
 [-4.08526422e-02  4.63833106e-02  1.75271079e-02]
 [ 1.08478873e-01  6.54099183e-02  1.05967292e-01]
 [-1.81187620e-01  2.72403492e-01 -2.94346168e-02]
 [-2.07418868e-02 -1.51991561e-01  1.04913442e-01]
 [-6.46900469e-02 -2.31662361e-01 -1.03658163e-01]
 [-4.13023563e-02  7.82754085e-01  1.81694410e-01]
 [ 2.01002856e-01 -4.46940353e-02  1.76512699e-01]
 [ 3.54945085e-01  1.33440904e-01  2.09141743e-01]
 [-2.64008833e-01 -2.79035762e-01  9.37781622e-03]
 [-6.75938606e-02 -1.90497240e-02  8.86332054e-02]
 [-4.24048132e-02  2.12194975e-01 -1.21936757e-01]
 [ 6.00442539e-03 -4.38059341e-02  6.18242421e-02]
 [-5.64519501e-02  1.38711881e-01 -3.97978786e-02]
 [-1.37877414e-01 -6.16769983e-02 -3.01597396e-02]
 [ 3.15843223e-02  1.43255745e-01 -2.12319416e-01]
 [ 6.06004261e-02 -3.26456854e-02 -7.55723377e-02]
 [ 1.03589843e-02  1.41393349e-01 -1.20917316e-01]
 [-9.44704237e-02 -1.51628727e-02 -2.48864939e-02]
 [-3.90838735e-02  4.86640565e-01 -4.33731221e-01]
 [ 3.60950326e-01  1.80606311e-01  9.49983521e-02]
 [ 8.33569302e-03 -5.62955329e-02  8.38454116e-02]
 [ 1.91072247e-01  1.86490864e-01 -2.18852039e-01]
 [-1.93359580e-01  7.11316239e-02  1.00235138e-02]
 [-1.67656804e-01 -4.36002381e-02  1.42396199e-01]
 [-5.00054020e-02 -3.38816840e-02 -1.10525617e-02]
 [-1.10634668e-01  1.30182821e-01 -9.52722042e-02]
 [-1.75793926e-02 -4.05512354e-02  5.29466969e-02]
 [ 2.49768404e-02  4.07650867e-02 -6.90145563e-02]
 [ 1.45798706e-02 -2.69328234e-02 -4.17382804e-02]
 [-2.78870741e-02  2.90992338e-02 -1.02130858e-01]
 [-2.49223886e-02  3.16506759e-02 -4.14038427e-02]
 [ 3.76499602e-02 -3.57095372e-02  1.63830690e-01]
 [-7.23819895e-02 -1.85999470e-02 -2.15157128e-02]
 [ 4.49662049e-02 -4.89129816e-02  7.61710937e-02]
 [-2.25832908e-02  7.43533120e-02  4.13084443e-02]
 [ 6.12254517e-02 -7.05110134e-02 -5.49835024e-02]
 [ 9.46282972e-02  5.74131406e-03  8.55037837e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.19466214]
curr_Stock_Price:  100.60527213932266
curr_Factors:  [100.60527214  -1.07595791  -0.97056338]
mat_Sqrt:  [[12.99654268  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01641883 -0.03252301  0.05561641]
Stock Position:  -0.016418828880025316
Bond Position:  [8.84648289]


portfolio before change:  [7.20216723]
curr_Stock_Price:  100.21552392842995
curr_Factors:  [100.21552393  -1.10552691  -0.95357969]
mat_Sqrt:  [[12.78428275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01158438  0.02223149 -0.4106802 ]
Stock Position:  -0.01158437963690939
Bond Position:  [8.3631019]


portfolio before change:  [7.20843079]
curr_Stock_Price:  99.76507990824292
curr_Factors:  [99.76507991 -0.9078177  -0.97834345]
mat_Sqrt:  [[15.12966022  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183791  0.01497015  0.04999996]
Stock Position:  -0.001837911906119038
Bond Position:  [7.39179022]


portfolio before change:  [7.21272496]
curr_Stock_Price:  97.93140515151073
curr_Factors:  [97.93140515 -0.80483634 -0.95980117]
mat_Sqrt:  [[16.77064048  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0085543  0.02111096 0.30229519]
Stock Position:  0.008554300545163837
Bond Position:  [6.37499029]


portfolio before change:  [7.21327935]
curr_Stock_Price:  97.90305268090148
curr_Factors:  [97.90305268 -0.66557581 -0.94084727]
mat_Sqrt:  [[19.63973179  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00670029  0.08791785 -0.08396877]
Stock Position:  -0.0067002853041570175
Bond Position:  [7.86925773]


portfolio before change:  [7.22479732]
curr_Stock_Price:  96.33084231404202
curr_Factors:  [96.33084231 -0.56005967 -0.91051978]
mat_Sqrt:  [[22.13608502  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137114 -0.04905507  0.29928885]
Stock Position:  -0.0013711398262209156
Bond Position:  [7.35688038]


portfolio before change:  [7.22495593]
curr_Stock_Price:  96.88589624500362
curr_Factors:  [96.88589625 -0.27723734 -0.8960846 ]
mat_Sqrt:  [[29.97045355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00444228 -0.07476871 -0.29570789]
Stock Position:  -0.004442277192362596
Bond Position:  [7.65534994]


portfolio before change:  [7.21452491]
curr_Stock_Price:  99.44944752424807
curr_Factors:  [99.44944752 -0.34584004 -0.93594325]
mat_Sqrt:  [[27.60139063  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00563612 0.25263279 0.51832358]
Stock Position:  0.0056361242978486305
Bond Position:  [6.65401546]


portfolio before change:  [7.20898541]
curr_Stock_Price:  98.31900684568582
curr_Factors:  [98.31900685 -0.36345987 -0.93346738]
mat_Sqrt:  [[26.87751624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00847959 -0.01442494  0.5035416 ]
Stock Position:  0.00847958666532567
Bond Position:  [6.37528087]


portfolio before change:  [7.20871916]
curr_Stock_Price:  98.19362201590899
curr_Factors:  [98.19362202 -0.44264522 -0.93086211]
mat_Sqrt:  [[24.86432216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01708772 0.04306787 0.59662318]
Stock Position:  0.01708771599904434
Bond Position:  [5.53081443]


portfolio before change:  [7.21227622]
curr_Stock_Price:  98.36132567446982
curr_Factors:  [98.36132567 -0.36800008 -0.92550798]
mat_Sqrt:  [[26.98118127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.011825  -0.0900584  0.0267523]
Stock Position:  -0.011825002302273428
Bond Position:  [8.37539913]


portfolio before change:  [7.23043963]
curr_Stock_Price:  96.91384892452848
curr_Factors:  [96.91384892 -0.6124244  -0.96192183]
mat_Sqrt:  [[20.07501886  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00265953 -0.00614827  0.25284586]
Stock Position:  -0.002659533838358082
Bond Position:  [7.48818529]


portfolio before change:  [7.23238019]
curr_Stock_Price:  96.53616104029841
curr_Factors:  [96.53616104 -0.39953039 -0.93108998]
mat_Sqrt:  [[25.51578543  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093985  0.06848563 -0.34785163]
Stock Position:  -0.0009398468872813131
Bond Position:  [7.3231094]


portfolio before change:  [7.23364549]
curr_Stock_Price:  96.16391028380532
curr_Factors:  [96.16391028 -0.22891342 -0.91848621]
mat_Sqrt:  [[30.52831169  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00031716 -0.0141383   0.17636735]
Stock Position:  0.00031716123774260056
Bond Position:  [7.20314602]


portfolio before change:  [7.23531649]
curr_Stock_Price:  98.59344383109922
curr_Factors:  [98.59344383 -0.23189384 -0.90762728]
mat_Sqrt:  [[31.54716236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00114943  0.04476907 -0.11353227]
Stock Position:  -0.0011494286978225767
Bond Position:  [7.34864263]


portfolio before change:  [7.24046912]
curr_Stock_Price:  94.90988642157531
curr_Factors:  [94.90988642 -0.15775933 -0.9033013 ]
mat_Sqrt:  [[32.84722425  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00476824 -0.01990617 -0.08603734]
Stock Position:  -0.004768241853658834
Bond Position:  [7.69302241]


portfolio before change:  [7.2429663]
curr_Stock_Price:  94.58786077605346
curr_Factors:  [94.58786078 -0.44590282 -0.90599894]
mat_Sqrt:  [[24.47439284  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071449  0.04623559 -0.6056882 ]
Stock Position:  0.0007144920643766942
Bond Position:  [7.17538403]


portfolio before change:  [7.24414844]
curr_Stock_Price:  94.98696693881634
curr_Factors:  [94.98696694 -0.64722624 -0.90307902]
mat_Sqrt:  [[20.15463778  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00191075 -0.01053635 -0.21558684]
Stock Position:  0.0019107520091013925
Bond Position:  [7.0626519]


portfolio before change:  [7.24618738]
curr_Stock_Price:  95.59199189366478
curr_Factors:  [95.59199189 -0.34366138 -0.9089801 ]
mat_Sqrt:  [[27.31531584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00053225  0.04563451 -0.34494345]
Stock Position:  0.0005322522030984911
Bond Position:  [7.19530833]


portfolio before change:  [7.24689174]
curr_Stock_Price:  95.225418500623
curr_Factors:  [95.2254185  -0.32771576 -0.90578419]
mat_Sqrt:  [[27.73643684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00370074 -0.0048938  -0.07099424]
Stock Position:  -0.003700744512752984
Bond Position:  [7.59929668]


portfolio before change:  [7.24255954]
curr_Stock_Price:  96.65274387497779
curr_Factors:  [96.65274387 -0.46578594 -0.90878512]
mat_Sqrt:  [[24.44812525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.15689030e-03  1.57062567e-01 -1.23731445e+00]
Stock Position:  -0.001156890298880663
Bond Position:  [7.35437617]


portfolio before change:  [7.24616007]
curr_Stock_Price:  94.33517610582956
curr_Factors:  [94.33517611 -0.47219515 -0.89824279]
mat_Sqrt:  [[23.96072922  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01741215 0.05829044 0.27100386]
Stock Position:  0.017412153378378308
Bond Position:  [5.60358151]


portfolio before change:  [7.2604988]
curr_Stock_Price:  95.11843566528977
curr_Factors:  [95.11843567 -0.56867412 -0.86819729]
mat_Sqrt:  [[22.60681475  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00061748 -0.01816931  0.23918762]
Stock Position:  0.0006174814371447493
Bond Position:  [7.20176493]


portfolio before change:  [7.26086434]
curr_Stock_Price:  94.25244992441681
curr_Factors:  [94.25244992 -0.82182441 -0.86359964]
mat_Sqrt:  [[17.47118178  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01055833  0.06018967 -0.62432395]
Stock Position:  0.010558332689537096
Bond Position:  [6.26571562]


portfolio before change:  [7.25652908]
curr_Stock_Price:  93.76766477167314
curr_Factors:  [93.76766477 -0.74200562 -0.85595692]
mat_Sqrt:  [[18.96997615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00931967  0.02295763  0.02859429]
Stock Position:  -0.0093196668182248
Bond Position:  [8.13041248]


portfolio before change:  [7.2561308]
curr_Stock_Price:  93.91945632916341
curr_Factors:  [93.91945633 -0.69977257 -0.8321941 ]
mat_Sqrt:  [[20.29695554  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00726662 -0.01407192  0.40621672]
Stock Position:  -0.007266615095219703
Bond Position:  [7.93860734]


portfolio before change:  [7.24242131]
curr_Stock_Price:  95.9426656737021
curr_Factors:  [95.94266567 -0.74919875 -0.83106379]
mat_Sqrt:  [[19.75661245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00299533 -0.01093527 -0.03152988]
Stock Position:  -0.002995329621227522
Bond Position:  [7.52980121]


portfolio before change:  [7.24158464]
curr_Stock_Price:  96.53623980131549
curr_Factors:  [96.5362398  -0.98781742 -0.87120779]
mat_Sqrt:  [[15.04270677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00688098  0.04201632 -0.27178508]
Stock Position:  -0.006880980255194703
Bond Position:  [7.9058486]


portfolio before change:  [7.23643996]
curr_Stock_Price:  97.42753342646812
curr_Factors:  [97.42753343 -1.12999757 -0.86738133]
mat_Sqrt:  [[13.21998833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113837 -0.01308785  0.15104219]
Stock Position:  -0.001138365577101353
Bond Position:  [7.34734811]


portfolio before change:  [7.23878291]
curr_Stock_Price:  96.17620142131224
curr_Factors:  [96.17620142 -1.18722959 -0.88100276]
mat_Sqrt:  [[12.15754039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00158013  0.01315688 -0.19687932]
Stock Position:  0.0015801256633505192
Bond Position:  [7.08681242]


portfolio before change:  [7.24035937]
curr_Stock_Price:  96.61322550404769
curr_Factors:  [96.6132255  -1.24201123 -0.86562009]
mat_Sqrt:  [[11.74096859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.79040745e-05 -8.69253138e-03 -1.19067696e-01]
Stock Position:  4.790407451824057e-05
Bond Position:  [7.2357312]


portfolio before change:  [7.24129113]
curr_Stock_Price:  97.18184454000018
curr_Factors:  [97.18184454 -1.34850789 -0.85531904]
mat_Sqrt:  [[10.72692548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00398946  0.00939174 -0.29135091]
Stock Position:  -0.003989455514624207
Bond Position:  [7.62899378]


portfolio before change:  [7.24235322]
curr_Stock_Price:  97.15467053427432
curr_Factors:  [97.15467053 -1.29848188 -0.81312453]
mat_Sqrt:  [[11.75992822  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00228856  0.01021521 -0.11811364]
Stock Position:  -0.0022885552489225872
Bond Position:  [7.46469705]


portfolio before change:  [7.24133509]
curr_Stock_Price:  98.00729507224041
curr_Factors:  [98.00729507 -1.51569902 -0.82705542]
mat_Sqrt:  [[ 9.41484287  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00677681 -0.0115252   0.46736336]
Stock Position:  0.006776807835761491
Bond Position:  [6.57715849]


portfolio before change:  [7.2430996]
curr_Stock_Price:  98.14634498123455
curr_Factors:  [98.14634498 -1.5321123  -0.80392259]
mat_Sqrt:  [[ 9.49176692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00848847 -0.00600311 -0.06137834]
Stock Position:  -0.008488468478484557
Bond Position:  [8.07621176]


portfolio before change:  [7.2406194]
curr_Stock_Price:  98.55746642301433
curr_Factors:  [98.55746642 -1.5181467  -0.77242635]
mat_Sqrt:  [[ 9.97484817  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00506577 -0.0157866   0.21729493]
Stock Position:  0.005065765703089208
Bond Position:  [6.74135037]


portfolio before change:  [7.24500043]
curr_Stock_Price:  99.25594087541718
curr_Factors:  [99.25594088 -1.60871289 -0.74475137]
mat_Sqrt:  [[ 9.43322016  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.08771588e-04 2.39974283e-02 1.17841494e-01]
Stock Position:  0.00010877158849868597
Bond Position:  [7.2342042]


portfolio before change:  [7.2458367]
curr_Stock_Price:  98.63025407493022
curr_Factors:  [98.63025407 -1.45904859 -0.72571286]
mat_Sqrt:  [[11.09635426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00320907 -0.02275733 -0.15685263]
Stock Position:  0.0032090712029692924
Bond Position:  [6.9293252]


portfolio before change:  [7.24827339]
curr_Stock_Price:  99.11963843509369
curr_Factors:  [99.11963844 -1.43944175 -0.70594939]
mat_Sqrt:  [[11.59920376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00976391 0.001853   0.2439185 ]
Stock Position:  0.009763913724828486
Bond Position:  [6.2804778]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.24933989]
Stock Price:  99.14845755253818
PL:  [7.24933989]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.27726032e-01 -9.36429021e-02  1.62799060e-02]
 [-1.26518401e-01  6.93407470e-02 -1.35811116e-01]
 [-4.10405662e-02  4.64851136e-02  1.73932537e-02]
 [ 9.92557459e-02  7.20291400e-02  9.25289183e-02]
 [-3.56662772e-02  1.47884653e-01 -4.89837198e-02]
 [-7.86806704e-02 -1.55288963e-01  1.38582391e-01]
 [-6.32750371e-02 -1.53455991e-01  4.48455647e-02]
 [-2.51238357e-02  7.97012881e-01  1.59664909e-01]
 [ 2.87707440e-01 -6.60203048e-03  2.67545394e-01]
 [ 5.47701807e-01  2.14628337e-01  3.74486019e-01]
 [-2.13374174e-01 -2.12675523e-01  3.96146708e-02]
 [-1.09028851e-01 -2.04832918e-02  8.34967079e-02]
 [-8.37485791e-03  3.31207404e-02  6.83780322e-02]
 [ 6.53626799e-03 -5.47911587e-02  6.02804399e-02]
 [-1.34624862e-01  1.91304601e-01 -3.73099651e-02]
 [-1.40906985e-01 -6.20798491e-02 -3.59699182e-02]
 [ 2.65292258e-02  1.46176097e-01 -1.58645611e-01]
 [ 6.65562824e-02 -3.06593691e-02 -7.93678657e-02]
 [ 1.20628547e-02  1.83480979e-01 -1.03428839e-01]
 [-9.44704237e-02 -1.51628727e-02 -2.48864939e-02]
 [-2.30764297e-02  3.63460330e-01 -3.00178283e-01]
 [ 4.17675533e-02  4.33195180e-02  8.14880053e-02]
 [ 5.78847480e-03 -5.05907165e-02  8.02334601e-02]
 [ 1.07359432e-01  8.67727763e-02 -1.69310667e-01]
 [-5.95717591e-02  1.47395647e-02 -3.51662476e-03]
 [-1.12207726e-01 -1.03890790e-02  2.26972180e-01]
 [-4.55747204e-02 -3.36904824e-02 -9.34820401e-03]
 [-9.76597897e-02  1.19826496e-01 -8.91631265e-02]
 [ 8.96115161e-02 -2.16360387e-02  1.36665656e-01]
 [ 3.72454647e-02  4.65811980e-02 -8.17576067e-02]
 [ 2.83562933e-02 -2.21175874e-02 -5.30583327e-02]
 [-3.16744109e-02  6.61013644e-02 -1.31459051e-01]
 [-4.25276595e-03  4.17778252e-02  1.86107041e-02]
 [ 4.06063058e-02 -3.22212292e-02  1.79729866e-01]
 [-7.26262477e-02 -9.59988795e-03 -2.53623371e-02]
 [-9.09880770e-02 -1.31087545e-01 -8.32217048e-02]
 [ 9.88934411e-03  1.02549926e-01  1.22417171e-01]
 [ 1.59041766e-01 -1.16850653e-01 -1.47860246e-01]
 [ 9.87919949e-02  3.16179819e-03  6.08555205e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.45917724]
curr_Stock_Price:  100.26040286913577
curr_Factors:  [100.26040287  -0.99014695  -1.00559851]
mat_Sqrt:  [[13.62662191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01053215 -0.03022312  0.04644204]
Stock Position:  -0.010532154498946301
Bond Position:  [5.51513529]


portfolio before change:  [4.45948995]
curr_Stock_Price:  100.29617144106822
curr_Factors:  [100.29617144  -0.80429503  -0.99757754]
mat_Sqrt:  [[16.54782958  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00846556  0.02237963 -0.38743131]
Stock Position:  -0.008465557811938368
Bond Position:  [5.30855299]


portfolio before change:  [4.46495165]
curr_Stock_Price:  99.72939402241856
curr_Factors:  [99.72939402 -0.89131817 -0.99267222]
mat_Sqrt:  [[15.15711504  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184741  0.01500301  0.04961811]
Stock Position:  -0.0018474128507618836
Bond Position:  [4.64919301]


portfolio before change:  [4.46767748]
curr_Stock_Price:  98.56850169757804
curr_Factors:  [98.5685017  -1.08790392 -0.99891469]
mat_Sqrt:  [[12.23050389  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01086186 0.0232473  0.26395925]
Stock Position:  0.010861859829936217
Bond Position:  [3.39704023]


portfolio before change:  [4.47433068]
curr_Stock_Price:  99.14193373879372
curr_Factors:  [99.14193374 -1.07553813 -0.9912147 ]
mat_Sqrt:  [[12.55099152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00123323  0.04772957 -0.13973692]
Stock Position:  -0.001233225972051223
Bond Position:  [4.59659508]


portfolio before change:  [4.47426579]
curr_Stock_Price:  99.66049193940562
curr_Factors:  [99.66049194 -0.90784444 -1.01116395]
mat_Sqrt:  [[14.62541746  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00561289 -0.0501193   0.39533699]
Stock Position:  -0.005612891767526376
Bond Position:  [5.03364934]


portfolio before change:  [4.47940157]
curr_Stock_Price:  98.85760138802297
curr_Factors:  [98.85760139 -0.75849424 -1.01231039]
mat_Sqrt:  [[16.82516736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00507841 -0.04952771  0.12793191]
Stock Position:  -0.005078406992092165
Bond Position:  [4.9814407]


portfolio before change:  [4.48047361]
curr_Stock_Price:  98.76912554674949
curr_Factors:  [98.76912555 -0.69277304 -1.01595103]
mat_Sqrt:  [[17.88676386  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00951302 0.2572348  0.45547954]
Stock Position:  0.00951302324887894
Bond Position:  [3.54088062]


portfolio before change:  [4.4851126]
curr_Stock_Price:  99.2102424616623
curr_Factors:  [99.21024246 -0.44634142 -1.02399001]
mat_Sqrt:  [[22.80340418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01495269 -0.0021308   0.76323254]
Stock Position:  0.014952692091364319
Bond Position:  [3.00165239]


portfolio before change:  [4.50522502]
curr_Stock_Price:  100.53021852308862
curr_Factors:  [100.53021852  -0.2394149   -1.01292709]
mat_Sqrt:  [[28.7350139   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02324531 0.069271   1.06830437]
Stock Position:  0.023245308792825454
Bond Position:  [2.16836905]


portfolio before change:  [4.47413252]
curr_Stock_Price:  99.18097567081615
curr_Factors:  [ 9.91809757e+01 -9.49332572e-02 -1.00501215e+00]
mat_Sqrt:  [[33.0162811   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00753265 -0.06864073  0.11300963]
Stock Position:  -0.007532649486948334
Bond Position:  [5.22122805]


portfolio before change:  [4.49378853]
curr_Stock_Price:  96.65818292118925
curr_Factors:  [ 9.66581829e+01  3.15096156e-02 -1.00391662e+00]
mat_Sqrt:  [[36.55338745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263084 -0.00661095  0.23819287]
Stock Position:  -0.002630844867899598
Bond Position:  [4.74808121]


portfolio before change:  [4.4916654]
curr_Stock_Price:  97.69080590017899
curr_Factors:  [97.6908059  -0.19626684 -1.04130986]
mat_Sqrt:  [[28.33876768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00043557 0.01068967 0.19506349]
Stock Position:  0.0004355691267955778
Bond Position:  [4.44911431]


portfolio before change:  [4.49183003]
curr_Stock_Price:  96.79187987218583
curr_Factors:  [96.79187987 -0.44106776 -1.05326856]
mat_Sqrt:  [[21.71985418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00035252 -0.01768377  0.17196332]
Stock Position:  0.0003525236751649675
Bond Position:  [4.45770861]


portfolio before change:  [4.49164309]
curr_Stock_Price:  94.68085006798232
curr_Factors:  [94.68085007 -0.59010668 -1.03318293]
mat_Sqrt:  [[18.67568006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00552541  0.06174329 -0.10643495]
Stock Position:  -0.005525412657257034
Bond Position:  [5.01479386]


portfolio before change:  [4.49481937]
curr_Stock_Price:  94.21945625469559
curr_Factors:  [94.21945625 -0.69805817 -1.03510158]
mat_Sqrt:  [[16.65094456  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0096644  -0.02003619 -0.10261216]
Stock Position:  -0.009664395298700446
Bond Position:  [5.40539344]


portfolio before change:  [4.49337949]
curr_Stock_Price:  94.43836339615362
curr_Factors:  [94.4383634  -0.8155823  -1.03629546]
mat_Sqrt:  [[14.82136349  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0016182   0.04717813 -0.45257177]
Stock Position:  0.001618197733091781
Bond Position:  [4.34055954]


portfolio before change:  [4.49425201]
curr_Stock_Price:  94.64224259753064
curr_Factors:  [94.6422426  -0.60060556 -1.03463518]
mat_Sqrt:  [[18.44628843  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00239057 -0.00989527 -0.22641443]
Stock Position:  0.0023905658464372795
Bond Position:  [4.26800349]


portfolio before change:  [4.49505176]
curr_Stock_Price:  94.75360399697769
curr_Factors:  [94.753604   -0.64785485 -1.03508427]
mat_Sqrt:  [[17.60777835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00161312  0.05921823 -0.29505369]
Stock Position:  0.0016131182871385998
Bond Position:  [4.34220299]


portfolio before change:  [4.4961703]
curr_Stock_Price:  95.1105109859203
curr_Factors:  [95.11051099 -0.69570177 -1.03710608]
mat_Sqrt:  [[16.81433248  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00610464 -0.0048938  -0.07099424]
Stock Position:  -0.006104641178107276
Bond Position:  [5.07678584]


portfolio before change:  [4.49239379]
curr_Stock_Price:  95.83309961504006
curr_Factors:  [95.83309962 -1.07001345 -1.02526232]
mat_Sqrt:  [[11.79095085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008616   0.11730632 -0.85632509]
Stock Position:  -0.0008615959847161465
Bond Position:  [4.57496321]


portfolio before change:  [4.49257168]
curr_Stock_Price:  96.29040957050006
curr_Factors:  [96.29040957 -1.0828586  -1.00227538]
mat_Sqrt:  [[11.96797994  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00561864 0.01398131 0.2324626 ]
Stock Position:  0.005618640963438055
Bond Position:  [3.95155044]


portfolio before change:  [4.49232848]
curr_Stock_Price:  96.15920766987925
curr_Factors:  [96.15920767 -1.08779927 -1.01164129]
mat_Sqrt:  [[11.78190251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00100487 -0.01632808  0.22888373]
Stock Position:  0.0010048695011295847
Bond Position:  [4.39570103]


portfolio before change:  [4.49271379]
curr_Stock_Price:  95.9958104551469
curr_Factors:  [95.99581046 -0.93449653 -1.00821927]
mat_Sqrt:  [[13.75756351  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00657903  0.02800579 -0.48299621]
Stock Position:  0.006579032363980043
Bond Position:  [3.86115424]


portfolio before change:  [4.49761838]
curr_Stock_Price:  96.66793302066867
curr_Factors:  [96.66793302 -1.00210444 -1.01550819]
mat_Sqrt:  [[12.85418073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00445621  0.00475717 -0.01003195]
Stock Position:  -0.004456206680408377
Bond Position:  [4.92839066]


portfolio before change:  [4.49700768]
curr_Stock_Price:  96.94323089191634
curr_Factors:  [96.94323089 -0.9424315  -0.99968848]
mat_Sqrt:  [[13.90162275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00489136 -0.00335306  0.64748845]
Stock Position:  -0.004891363198653126
Bond Position:  [4.97119223]


portfolio before change:  [4.50104678]
curr_Stock_Price:  96.24451686345328
curr_Factors:  [96.24451686 -1.06288101 -0.95505039]
mat_Sqrt:  [[12.79379905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00424893 -0.01087356 -0.02666782]
Stock Position:  -0.004248929910200286
Bond Position:  [4.90998299]


portfolio before change:  [4.50137718]
curr_Stock_Price:  96.31121361740013
curr_Factors:  [96.31121362 -0.9741884  -0.95890651]
mat_Sqrt:  [[13.93620104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00655851  0.03867384 -0.25435758]
Stock Position:  -0.006558505810479033
Bond Position:  [5.13303483]


portfolio before change:  [4.50797144]
curr_Stock_Price:  95.40359896411614
curr_Factors:  [95.40359896 -0.93727853 -0.96722938]
mat_Sqrt:  [[14.20520421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0079613  -0.006983    0.38986907]
Stock Position:  0.007961296201158059
Bond Position:  [3.74843513]


portfolio before change:  [4.51041454]
curr_Stock_Price:  95.65161247542136
curr_Factors:  [95.65161248 -1.11121802 -0.96249269]
mat_Sqrt:  [[12.02516876  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00250018  0.01503402 -0.23323169]
Stock Position:  0.0025001819915333465
Bond Position:  [4.2712681]


portfolio before change:  [4.51142101]
curr_Stock_Price:  95.84061170714105
curr_Factors:  [95.84061171 -1.03026837 -0.96096619]
mat_Sqrt:  [[13.08480924  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099436 -0.00713842 -0.15136065]
Stock Position:  0.0009943647379469487
Bond Position:  [4.41612049]


portfolio before change:  [4.51216746]
curr_Stock_Price:  96.03611430854666
curr_Factors:  [96.03611431 -1.08737069 -0.97400791]
mat_Sqrt:  [[12.22332137  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00368275  0.02133412 -0.37501608]
Stock Position:  -0.0036827545803805495
Bond Position:  [4.8658449]


portfolio before change:  [4.51120392]
curr_Stock_Price:  96.46291783974027
curr_Factors:  [96.46291784 -1.15325828 -0.99244171]
mat_Sqrt:  [[11.28482247  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00071547 0.01348374 0.05309116]
Stock Position:  0.0007154734606193079
Bond Position:  [4.44218726]


portfolio before change:  [4.51236883]
curr_Stock_Price:  97.31495313932253
curr_Factors:  [97.31495314 -1.30369756 -1.00777693]
mat_Sqrt:  [[ 9.64537148  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00733164 -0.01039936  0.51271928]
Stock Position:  0.00733163884356825
Bond Position:  [3.79889074]


portfolio before change:  [4.51092839]
curr_Stock_Price:  97.05371045448206
curr_Factors:  [97.05371045 -1.24054277 -1.01578834]
mat_Sqrt:  [[10.16482704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00784695 -0.00309835 -0.07235169]
Stock Position:  -0.00784694925506547
Bond Position:  [5.27250393]


portfolio before change:  [4.51546266]
curr_Stock_Price:  96.55986676326494
curr_Factors:  [96.55986676 -0.93538126 -0.99028566]
mat_Sqrt:  [[14.07635274  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00957164 -0.04230832 -0.23740836]
Stock Position:  -0.009571639183940276
Bond Position:  [5.43969886]


portfolio before change:  [4.50993487]
curr_Stock_Price:  97.20842752350369
curr_Factors:  [97.20842752 -1.06142259 -0.9944473 ]
mat_Sqrt:  [[12.44087622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00448606 0.03309785 0.34922212]
Stock Position:  0.00448606348338032
Bond Position:  [4.0738517]


portfolio before change:  [4.50872914]
curr_Stock_Price:  96.82613437555268
curr_Factors:  [96.82613438 -1.29549135 -1.03394501]
mat_Sqrt:  [[ 9.4260825   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01114014 -0.03771339 -0.42180413]
Stock Position:  0.0111401401757971
Bond Position:  [3.43007244]


portfolio before change:  [4.50869369]
curr_Stock_Price:  96.78446188338533
curr_Factors:  [96.78446188 -1.23635537 -1.00439337]
mat_Sqrt:  [[10.29581732  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01086456 0.00102047 0.17360386]
Stock Position:  0.01086455518272212
Bond Position:  [3.45717357]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.51317052]
Stock Price:  97.15674197726047
PL:  [4.51317052]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.44723263e-01 -9.57993343e-02  1.69435062e-02]
 [-1.26919571e-01  6.93113050e-02 -1.36333879e-01]
 [-4.41845403e-02  5.07476322e-02  1.61043885e-02]
 [ 1.30629319e-01  3.87993487e-02  1.47345925e-01]
 [ 2.04788236e-01 -2.11601201e-01 -1.04908007e-01]
 [-1.29472103e-01 -1.75649458e-01  2.57142401e-02]
 [-5.12724860e-02 -2.15303715e-01 -2.85396440e-02]
 [ 3.79353416e-03  6.63153640e-01  1.07974045e-01]
 [ 6.26735622e-01  1.37393780e-01  5.82250754e-01]
 [ 1.00834822e+00  4.84377991e-01  1.01402027e+00]
 [ 1.73956529e-01 -1.97359719e-01 -1.01692791e-01]
 [-1.14689732e-01 -3.72858573e-02  8.56250132e-02]
 [ 1.31264881e-02 -9.40512618e-02  1.23166783e-01]
 [ 1.88463119e-03  5.80071360e-02 -4.46790365e-02]
 [ 6.80388641e-01 -1.61234187e-01 -3.37521977e-01]
 [-1.52982871e-01 -9.30663921e-02  1.06846448e-01]
 [ 5.66909350e-02 -7.35819286e-03 -1.11572137e-02]
 [-6.51811290e-02 -6.56347921e-02  1.66833835e-02]
 [ 1.46498721e-01 -1.76224061e-01  8.77264035e-03]
 [ 3.15311564e-02 -7.03971481e-03  2.65706586e-01]
 [-5.10908513e-02  6.15645096e-01 -6.05002986e-01]
 [ 3.33231203e-01  1.94890646e-01  6.81135755e-02]
 [ 2.40907518e-02  1.09849614e-01 -1.58605259e-02]
 [-1.95001957e-02 -1.33973214e-01 -9.17368747e-02]
 [ 4.86076503e-02  1.12966971e-02 -1.32067743e-02]
 [-3.43719140e-02  2.96890270e-03  1.20047505e-01]
 [ 3.52799460e-02 -3.34265565e-02  1.05306784e-02]
 [ 1.00020040e-01 -6.31223263e-02 -5.23541460e-02]
 [-4.72218123e-02 -2.35119614e-02 -1.58030379e-02]
 [-5.65704806e-02 -1.05137279e-02  2.74688303e-02]
 [-4.18098592e-02 -5.86121897e-02 -3.67811226e-02]
 [ 2.63062133e-02 -4.45623940e-02 -1.02115987e-01]
 [ 3.66403912e-02  7.01893946e-03  1.49234840e-01]
 [ 2.88691437e-03 -8.58529451e-02 -1.21058015e-01]
 [ 6.55069520e-03  6.70711565e-02  3.18524721e-02]
 [ 7.10605918e-02  3.06173498e-02  1.73727682e-01]
 [ 2.86272473e-01 -1.90477163e-01  1.57283751e-01]
 [-9.58968444e-02  3.04152389e-02  4.34541885e-02]
 [ 1.75126135e-01 -8.15217762e-03  9.75560884e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.29697034]
curr_Stock_Price:  100.2399530487112
curr_Factors:  [100.23995305  -0.55575041  -1.03099582]
mat_Sqrt:  [[20.5081139   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00784176 -0.0309191   0.04833511]
Stock Position:  -0.007841756778621799
Bond Position:  [5.08302767]


portfolio before change:  [4.29707606]
curr_Stock_Price:  100.30750148181818
curr_Factors:  [100.30750148  -0.56214417  -1.03449537]
mat_Sqrt:  [[20.31990495  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00691935  0.02237013 -0.38892261]
Stock Position:  -0.006919348118015202
Bond Position:  [4.99113858]


portfolio before change:  [4.3052635]
curr_Stock_Price:  99.21440563517038
curr_Factors:  [99.21440564 -0.63259503 -1.01149709]
mat_Sqrt:  [[19.16702018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00159328  0.01637873  0.04594134]
Stock Position:  -0.0015932799378886784
Bond Position:  [4.46333982]


portfolio before change:  [4.30420173]
curr_Stock_Price:  100.23100161254797
curr_Factors:  [100.23100161  -0.53069177  -1.04132517]
mat_Sqrt:  [[20.81056103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00810291 0.01252244 0.42033691]
Stock Position:  0.008102908126911586
Bond Position:  [3.49203913]


portfolio before change:  [4.32126282]
curr_Stock_Price:  102.28267999010977
curr_Factors:  [102.28267999  -0.58654169  -1.04943829]
mat_Sqrt:  [[19.92071972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00703695 -0.06829399 -0.29927334]
Stock Position:  0.007036947799087466
Bond Position:  [3.60150494]


portfolio before change:  [4.32253361]
curr_Stock_Price:  102.39928961008589
curr_Factors:  [102.39928961  -0.61466346  -1.07290457]
mat_Sqrt:  [[18.94067538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00845152 -0.05669062  0.07335557]
Stock Position:  -0.008451520254267724
Bond Position:  [5.18796328]


portfolio before change:  [4.31862276]
curr_Stock_Price:  102.93876585855999
curr_Factors:  [102.93876586  -0.51120743  -1.05562316]
mat_Sqrt:  [[21.48389777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00470337 -0.06948898 -0.08141566]
Stock Position:  -0.004703373864177544
Bond Position:  [4.80278226]


portfolio before change:  [4.31999505]
curr_Stock_Price:  102.77464813347875
curr_Factors:  [102.77464813  -0.42449353  -1.06001721]
mat_Sqrt:  [[23.2900904   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00692137 0.21403192 0.3080199 ]
Stock Position:  0.0069213691740148365
Bond Position:  [3.60865377]


portfolio before change:  [4.32496921]
curr_Stock_Price:  103.42813965511465
curr_Factors:  [103.42813966  -0.4067646   -1.08153755]
mat_Sqrt:  [[23.34948474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03313274 0.04434365 1.66099933]
Stock Position:  0.0331327417380469
Bond Position:  [0.89811137]


portfolio before change:  [4.43448963]
curr_Stock_Price:  106.73025520350977
curr_Factors:  [106.7302552   -0.66806655  -1.12298219]
mat_Sqrt:  [[17.80102311  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07382764 0.15633232 2.89271758]
Stock Position:  0.07382763784512542
Bond Position:  [-3.445153]


portfolio before change:  [4.43579854]
curr_Stock_Price:  106.753817968399
curr_Factors:  [106.75381797  -0.52897729  -1.1151347 ]
mat_Sqrt:  [[20.62313351  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00547505 -0.06369758 -0.29010123]
Stock Position:  0.005475050188986326
Bond Position:  [3.85131603]


portfolio before change:  [4.43490563]
curr_Stock_Price:  106.50279765655337
curr_Factors:  [106.50279766  -0.53740337  -1.1484305 ]
mat_Sqrt:  [[19.73388861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0053118  -0.01203396  0.24426433]
Stock Position:  -0.005311803721888518
Bond Position:  [5.00062759]


portfolio before change:  [4.4421653]
curr_Stock_Price:  105.25377837065957
curr_Factors:  [105.25377837  -0.46550337  -1.13456675]
mat_Sqrt:  [[21.24888128  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00089744 -0.03035491  0.35136055]
Stock Position:  0.0008974434319307637
Bond Position:  [4.34770599]


portfolio before change:  [4.44453597]
curr_Stock_Price:  107.28976057393123
curr_Factors:  [107.28976057  -0.57951348  -1.11835822]
mat_Sqrt:  [[19.64183092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00023446  0.01872172 -0.12745685]
Stock Position:  0.00023445971632400048
Bond Position:  [4.41938085]


portfolio before change:  [4.44490212]
curr_Stock_Price:  106.49512977440226
curr_Factors:  [106.49512977  -0.35656277  -1.11339538]
mat_Sqrt:  [[24.48696914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0236281  -0.05203811 -0.96285625]
Stock Position:  0.02362809631263324
Bond Position:  [1.92862494]


portfolio before change:  [4.44756596]
curr_Stock_Price:  106.59766653128393
curr_Factors:  [106.59766653  -0.31714379  -1.09807814]
mat_Sqrt:  [[25.88955727  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00580041 -0.03003705  0.30480318]
Stock Position:  -0.005800409312332809
Bond Position:  [5.06587606]


portfolio before change:  [4.44750643]
curr_Stock_Price:  106.71710774927368
curr_Factors:  [106.71710775  -0.2787283   -1.0877727 ]
mat_Sqrt:  [[27.21261031  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00194437 -0.00237485 -0.03182843]
Stock Position:  0.0019443740546430147
Bond Position:  [4.24000845]


portfolio before change:  [4.44596176]
curr_Stock_Price:  105.65007731140815
curr_Factors:  [105.65007731  -0.26736079  -1.06683738]
mat_Sqrt:  [[27.8249834   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270165 -0.02118354  0.04759305]
Stock Position:  -0.002701647376626019
Bond Position:  [4.73139101]


portfolio before change:  [4.45073829]
curr_Stock_Price:  104.10099534123685
curr_Factors:  [104.10099534  -0.10650255  -1.07487734]
mat_Sqrt:  [[31.94391306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0035161  -0.05687607  0.0250259 ]
Stock Position:  0.00351609531307232
Bond Position:  [4.08470927]


portfolio before change:  [4.45178145]
curr_Stock_Price:  104.25245237851175
curr_Factors:  [104.25245238  -0.21122161  -1.09184747]
mat_Sqrt:  [[28.32504233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00297727 -0.00227206  0.75798693]
Stock Position:  0.002977270413354774
Bond Position:  [4.14139371]


portfolio before change:  [4.44453904]
curr_Stock_Price:  101.64599787416523
curr_Factors:  [101.64599787  -0.21281373  -1.0785492 ]
mat_Sqrt:  [[27.94206443  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175071  0.1986986  -1.72590512]
Stock Position:  -0.0017507131505335102
Bond Position:  [4.62249202]


portfolio before change:  [4.44499867]
curr_Stock_Price:  101.71352260090431
curr_Factors:  [101.7135226   -0.42855435  -1.07491385]
mat_Sqrt:  [[22.61677877  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01710751 0.06290069 0.19430907]
Stock Position:  0.01710750761552222
Bond Position:  [2.7049338]


portfolio before change:  [4.45020302]
curr_Stock_Price:  101.99797184125683
curr_Factors:  [101.99797184  -0.55495993  -1.07522199]
mat_Sqrt:  [[19.98078402  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00216589  0.03545381 -0.04524567]
Stock Position:  0.0021658906864919746
Bond Position:  [4.22928657]


portfolio before change:  [4.44927028]
curr_Stock_Price:  101.3232212007073
curr_Factors:  [101.3232212   -0.78954995  -1.09891263]
mat_Sqrt:  [[15.33063386  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00427726 -0.04323967 -0.26169977]
Stock Position:  -0.0042772578823942285
Bond Position:  [4.88265583]


portfolio before change:  [4.44585142]
curr_Stock_Price:  102.26523415337343
curr_Factors:  [102.26523415  -0.82895412  -1.12951246]
mat_Sqrt:  [[14.42702516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00334218  0.00364599 -0.03767525]
Stock Position:  0.0033421829453148238
Bond Position:  [4.1040623]


portfolio before change:  [4.44246428]
curr_Stock_Price:  101.09827990605741
curr_Factors:  [101.09827991  -0.95087336  -1.13201848]
mat_Sqrt:  [[12.59375763  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00073539  0.00095821  0.34246212]
Stock Position:  -0.0007353877428820576
Bond Position:  [4.51681072]


portfolio before change:  [4.44305667]
curr_Stock_Price:  101.06054643964137
curr_Factors:  [101.06054644  -0.88475338  -1.1623691 ]
mat_Sqrt:  [[13.04751025  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00234576 -0.01078837  0.03004109]
Stock Position:  0.0023457612863411427
Bond Position:  [4.20599275]


portfolio before change:  [4.44445169]
curr_Stock_Price:  101.43110333042135
curr_Factors:  [101.43110333  -0.87121166  -1.16935176]
mat_Sqrt:  [[13.18152682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00579967 -0.02037264 -0.14935181]
Stock Position:  0.005799669843368422
Bond Position:  [3.85618478]


portfolio before change:  [4.44873986]
curr_Stock_Price:  102.08736836658863
curr_Factors:  [102.08736837  -0.99213318  -1.1531303 ]
mat_Sqrt:  [[11.94801936  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00462394 -0.00758845 -0.04508167]
Stock Position:  -0.004623942370542504
Bond Position:  [4.92078597]


portfolio before change:  [4.45022203]
curr_Stock_Price:  101.89985872500694
curr_Factors:  [101.89985873  -1.0299018   -1.16317601]
mat_Sqrt:  [[11.36925458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00467133 -0.00339329  0.07836093]
Stock Position:  -0.004671329540910267
Bond Position:  [4.92622985]


portfolio before change:  [4.44695915]
curr_Stock_Price:  102.73017819397056
curr_Factors:  [102.73017819  -0.92723795  -1.19426549]
mat_Sqrt:  [[12.31234578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00497728 -0.018917   -0.10492631]
Stock Position:  -0.004977275544122493
Bond Position:  [4.95827556]


portfolio before change:  [4.44405784]
curr_Stock_Price:  103.43762178093611
curr_Factors:  [103.43762178  -0.6832687   -1.19183367]
mat_Sqrt:  [[15.86104933  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.29139053e-04 -1.43824508e-02 -2.91308487e-01]
Stock Position:  -0.00022913905291065383
Bond Position:  [4.46775943]


portfolio before change:  [4.44466653]
curr_Stock_Price:  103.2185746895139
curr_Factors:  [103.21857469  -0.77136666  -1.17606657]
mat_Sqrt:  [[14.72306915  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00465498 0.00226535 0.42572546]
Stock Position:  0.004654977823247992
Bond Position:  [3.96418636]


portfolio before change:  [4.44860981]
curr_Stock_Price:  103.9592276529202
curr_Factors:  [103.95922765  -0.96673415  -1.17852964]
mat_Sqrt:  [[12.16709265  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00323402 -0.02770892 -0.34534482]
Stock Position:  -0.0032340189809951046
Bond Position:  [4.78481593]


portfolio before change:  [4.45125587]
curr_Stock_Price:  103.32598551443733
curr_Factors:  [103.32598551  -0.87769962  -1.15728124]
mat_Sqrt:  [[13.50294801  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00198056 0.02164712 0.09086624]
Stock Position:  0.0019805598238002986
Bond Position:  [4.24661257]


portfolio before change:  [4.45018266]
curr_Stock_Price:  102.51607850951183
curr_Factors:  [102.51607851  -0.74618834  -1.1403292 ]
mat_Sqrt:  [[15.54131718  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00725629 0.00988171 0.49559672]
Stock Position:  0.007256292716325485
Bond Position:  [3.70629598]


portfolio before change:  [4.46286772]
curr_Stock_Price:  104.20037418356064
curr_Factors:  [104.20037418  -1.04564686  -1.13564469]
mat_Sqrt:  [[11.76376643  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02375913 -0.06147624  0.44868676]
Stock Position:  0.023759133381905665
Bond Position:  [1.98715713]


portfolio before change:  [4.47032895]
curr_Stock_Price:  104.50395526523903
curr_Factors:  [104.50395527  -0.95405612  -1.08722133]
mat_Sqrt:  [[13.57116697  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00595515  0.00981648  0.1239627 ]
Stock Position:  -0.005955148210863639
Bond Position:  [5.09266549]


portfolio before change:  [4.47320722]
curr_Stock_Price:  104.1275332609693
curr_Factors:  [104.12753326  -0.96417695  -1.07662148]
mat_Sqrt:  [[13.52876288  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01429367 -0.0026311   0.27830037]
Stock Position:  0.014293667047736765
Bond Position:  [2.98484293]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.48205825]
Stock Price:  104.72065599606366
PL:  [-0.23859775]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.87560491e-02 -7.98179220e-02  1.20255362e-02]
 [-7.40238004e-02  7.31933430e-02 -6.74056916e-02]
 [-1.58498738e-01 -1.77610241e-02 -9.71080235e-02]
 [-4.45826443e-01 -1.80369260e-01 -2.80740296e-01]
 [ 2.33644009e-01 -2.39517448e-01 -1.05310976e-01]
 [-1.29400788e-01 -1.71591825e-01  5.37029831e-02]
 [-5.16229874e-02 -2.00199437e-01 -2.81732466e-02]
 [ 7.68954544e-03  6.37325491e-01  9.70556630e-02]
 [ 4.70564620e-01  7.25376115e-02  4.52949458e-01]
 [ 6.72482047e-01  3.04885336e-01  6.03190260e-01]
 [-8.14839854e-02 -2.17219554e-01 -2.32387366e-02]
 [-8.57206298e-02 -2.14737497e-02  7.97577056e-02]
 [ 1.57749725e-02 -8.50933188e-02  1.05513332e-01]
 [ 1.93239095e-03  6.73384041e-02 -3.53113715e-02]
 [ 5.36143911e-01 -1.68018373e-01 -2.34084823e-01]
 [-1.85278700e-01 -9.47686021e-02  1.13371896e-01]
 [ 5.67259988e-02 -9.43455616e-03 -4.96437796e-03]
 [-6.15615167e-02 -6.34937174e-02  2.18370816e-02]
 [ 1.71923112e-01 -2.12332287e-01  4.06764190e-02]
 [ 4.93642111e-02 -9.01172612e-03  2.48164139e-01]
 [-3.22662045e-02  4.76152968e-01 -4.58368562e-01]
 [ 3.69477222e-01  2.12234244e-01  6.22111668e-02]
 [ 1.16732591e-02  1.65993223e-01 -5.55096289e-02]
 [ 2.37492345e-02 -1.52569408e-01 -1.64979872e-01]
 [ 2.31479640e-02 -3.47718873e-02 -1.01243207e-02]
 [-2.63543914e-02  1.24899322e-02  5.83742170e-02]
 [ 8.27112425e-02 -2.65175448e-02  5.55703203e-02]
 [ 1.37064505e-01 -6.87777060e-02  5.73996520e-02]
 [-5.58022920e-02 -3.66511307e-02  5.39247065e-03]
 [-8.82722723e-02 -1.00863205e-02  4.59982110e-02]
 [ 4.15173726e-02 -2.62636193e-03  4.58350285e-02]
 [ 3.59099029e-02  2.18390931e-02 -7.26039584e-02]
 [-4.23669195e-02  1.60140491e-02  3.57190048e-02]
 [ 7.62283976e-03 -7.67955191e-02 -5.83544751e-02]
 [-5.76743768e-02  6.65795998e-02 -1.71571304e-02]
 [ 8.99474598e-02  1.13453087e-03  1.64807883e-01]
 [-7.91963171e-02  6.56445607e-02 -6.80770633e-02]
 [-4.49108940e-02 -1.96678134e-02  3.16029103e-02]
 [ 9.37742821e-02  6.27039798e-03  9.05593834e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.16301256]
curr_Stock_Price:  99.9709197743629
curr_Factors:  [99.97091977 -1.10801365 -0.97505338]
mat_Sqrt:  [[12.45114149  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261776 -0.02576112  0.03430551]
Stock Position:  -0.002617760946398265
Bond Position:  [2.42471253]


portfolio before change:  [2.16057416]
curr_Stock_Price:  101.01819276090326
curr_Factors:  [101.01819276  -1.0180445   -0.99107414]
mat_Sqrt:  [[13.54722847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00537692  0.02362305 -0.19228968]
Stock Position:  -0.005376922752583047
Bond Position:  [2.70374118]


portfolio before change:  [2.15633946]
curr_Stock_Price:  101.86862088368463
curr_Factors:  [101.86862088  -0.87048325  -0.99559007]
mat_Sqrt:  [[15.76213642  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01154325 -0.00573235 -0.27702216]
Stock Position:  -0.011543250182370268
Bond Position:  [3.33223444]


portfolio before change:  [2.15123572]
curr_Stock_Price:  102.34684791136513
curr_Factors:  [102.34684791  -0.85763624  -0.97818259]
mat_Sqrt:  [[16.32256787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03307997 -0.05821393 -0.80087392]
Stock Position:  -0.03307996887669326
Bond Position:  [5.53686627]


portfolio before change:  [2.14389282]
curr_Stock_Price:  102.58974593604778
curr_Factors:  [102.58974594  -1.03266529  -1.00814403]
mat_Sqrt:  [[13.32882077  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01224836 -0.07730392 -0.3004229 ]
Stock Position:  0.012248360477930825
Bond Position:  [0.88733663]


portfolio before change:  [2.14378408]
curr_Stock_Price:  102.57181220939454
curr_Factors:  [102.57181221  -1.02590882  -1.02149818]
mat_Sqrt:  [[13.23885621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01159199 -0.05538102  0.15319966]
Stock Position:  -0.011591994388783916
Bond Position:  [3.33279595]


portfolio before change:  [2.146001]
curr_Stock_Price:  102.41650750567062
curr_Factors:  [102.41650751  -1.02054008  -0.9992016 ]
mat_Sqrt:  [[13.58961947  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.007229   -0.06461409 -0.08037043]
Stock Position:  -0.00722900052471713
Bond Position:  [2.88636998]


portfolio before change:  [2.14321587]
curr_Stock_Price:  102.85169156970414
curr_Factors:  [102.85169157  -0.90951747  -1.03015003]
mat_Sqrt:  [[14.7851095   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.010659   0.20569592 0.27687279]
Stock Position:  0.010658999232320571
Bond Position:  [1.04691977]


portfolio before change:  [2.13977191]
curr_Stock_Price:  102.51630997135364
curr_Factors:  [102.51630997  -0.68487054  -1.01331798]
mat_Sqrt:  [[18.76199714  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03079785 0.02341141 1.29213873]
Stock Position:  0.030797852425741838
Bond Position:  [-1.01751027]


portfolio before change:  [2.16782337]
curr_Stock_Price:  103.43126525652445
curr_Factors:  [103.43126526  -1.0726759   -1.01748169]
mat_Sqrt:  [[12.79110109  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06706555 0.09840132 1.72073392]
Stock Position:  0.0670655478145246
Bond Position:  [-4.76885109]


portfolio before change:  [2.20344514]
curr_Stock_Price:  103.9713028002446
curr_Factors:  [103.9713028   -0.91805008  -1.02005171]
mat_Sqrt:  [[14.96947508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00872224 -0.07010731 -0.06629365]
Stock Position:  -0.008722238272267114
Bond Position:  [3.11030762]


portfolio before change:  [2.2013287]
curr_Stock_Price:  104.25852913730846
curr_Factors:  [104.25852914  -1.07747459  -0.99564738]
mat_Sqrt:  [[13.1149357   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00562896 -0.00693062  0.22752653]
Stock Position:  -0.005628961428411813
Bond Position:  [2.78819594]


portfolio before change:  [2.19819836]
curr_Stock_Price:  104.87656315755484
curr_Factors:  [104.87656316  -1.15091103  -0.98239696]
mat_Sqrt:  [[12.42208677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00160546 -0.02746375  0.30100017]
Stock Position:  0.001605462153520652
Bond Position:  [2.029823]


portfolio before change:  [2.19904676]
curr_Stock_Price:  105.24696201111469
curr_Factors:  [105.24696201  -1.27273644  -0.96568226]
mat_Sqrt:  [[11.22216569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00075475  0.02173338 -0.10073351]
Stock Position:  0.0007547457264621918
Bond Position:  [2.11961207]


portfolio before change:  [2.19924629]
curr_Stock_Price:  105.16025655483278
curr_Factors:  [105.16025655  -1.2707615   -0.97284568]
mat_Sqrt:  [[11.15489331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04070545 -0.0542277  -0.66777884]
Stock Position:  0.040705448920883826
Bond Position:  [-2.08134916]


portfolio before change:  [2.21219586]
curr_Stock_Price:  105.48477713843243
curr_Factors:  [105.48477714  -1.36047824  -0.96278975]
mat_Sqrt:  [[10.33254547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01756405 -0.03058643  0.32341846]
Stock Position:  -0.017564047415784177
Bond Position:  [4.06493549]


portfolio before change:  [2.20916571]
curr_Stock_Price:  105.68622855971999
curr_Factors:  [105.68622856  -1.57518956  -0.92279005]
mat_Sqrt:  [[ 8.69279902  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00618752 -0.00304499 -0.01416199]
Stock Position:  0.006187515507475559
Bond Position:  [1.55523053]


portfolio before change:  [2.20876346]
curr_Stock_Price:  105.58979845171477
curr_Factors:  [105.58979845  -1.42412012  -0.93331375]
mat_Sqrt:  [[ 9.99542906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00700967 -0.02049251  0.06229512]
Stock Position:  -0.00700966826567463
Bond Position:  [2.94891292]


portfolio before change:  [2.21531132]
curr_Stock_Price:  104.7082703771543
curr_Factors:  [104.70827038  -1.05262494  -0.89894917]
mat_Sqrt:  [[14.87384046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.009203   -0.06852995  0.1160385 ]
Stock Position:  0.009203003443793743
Bond Position:  [1.25168074]


portfolio before change:  [2.20426041]
curr_Stock_Price:  103.49047545550259
curr_Factors:  [103.49047546  -1.13692084  -0.8988331 ]
mat_Sqrt:  [[13.51399275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00726514 -0.00290852  0.70794321]
Stock Position:  0.007265135827459844
Bond Position:  [1.45238805]


portfolio before change:  [2.20686818]
curr_Stock_Price:  103.824427511968
curr_Factors:  [103.82442751  -0.91471465  -0.9348876 ]
mat_Sqrt:  [[16.33155329  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175341  0.15367771 -1.30759792]
Stock Position:  -0.0017534142298233615
Bond Position:  [2.38891541]


portfolio before change:  [2.20588363]
curr_Stock_Price:  104.55624695130591
curr_Factors:  [104.55624695  -1.00532992  -0.93731391]
mat_Sqrt:  [[14.98547409  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02839404 0.06849831 0.17747114]
Stock Position:  0.0283940404135198
Bond Position:  [-0.76289067]


portfolio before change:  [2.19040107]
curr_Stock_Price:  104.01433058828263
curr_Factors:  [104.01433059  -1.04369636  -0.92072571]
mat_Sqrt:  [[14.58664828  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00234637  0.05357408 -0.15835352]
Stock Position:  0.002346366878776301
Bond Position:  [1.94634529]


portfolio before change:  [2.19121671]
curr_Stock_Price:  104.2582536047398
curr_Factors:  [104.2582536   -0.90262113  -0.91795481]
mat_Sqrt:  [[16.88279551  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243267 -0.04924156 -0.47064165]
Stock Position:  -0.0024326682632508393
Bond Position:  [2.44484246]


portfolio before change:  [2.18989631]
curr_Stock_Price:  104.92666637386911
curr_Factors:  [104.92666637  -0.61821252  -0.92915789]
mat_Sqrt:  [[22.32911151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00062625 -0.01122258 -0.02888187]
Stock Position:  0.0006262481135438384
Bond Position:  [2.12418618]


portfolio before change:  [2.1900932]
curr_Stock_Price:  104.81705501429806
curr_Factors:  [104.81705501  -0.40261855  -0.92747454]
mat_Sqrt:  [[27.71914694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042892  0.00403111  0.16652539]
Stock Position:  -0.00042892039808551226
Bond Position:  [2.23505138]


portfolio before change:  [2.19063305]
curr_Stock_Price:  104.20983283579075
curr_Factors:  [104.20983284  -0.29101572  -0.93245565]
mat_Sqrt:  [[30.65927155  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00289118 -0.0085585   0.15852666]
Stock Position:  0.002891184655919233
Bond Position:  [1.88934318]


portfolio before change:  [2.18404812]
curr_Stock_Price:  101.85055259462085
curr_Factors:  [101.85055259  -0.32627415  -0.91208854]
mat_Sqrt:  [[29.52224007  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00456408 -0.02219791  0.16374523]
Stock Position:  0.004564083515282365
Bond Position:  [1.71919369]


portfolio before change:  [2.18677247]
curr_Stock_Price:  102.40037630877312
curr_Factors:  [ 1.02400376e+02 -7.47904344e-02 -9.24518199e-01]
mat_Sqrt:  [[37.69704667  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164954 -0.0118291   0.01538322]
Stock Position:  -0.0016495440568284091
Bond Position:  [2.35568641]


portfolio before change:  [2.1878479]
curr_Stock_Price:  101.92694637337432
curr_Factors:  [101.92694637  -0.28123165  -0.91246372]
mat_Sqrt:  [[30.89396871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261999 -0.00325535  0.13122009]
Stock Position:  -0.002619986740098339
Bond Position:  [2.45489515]


portfolio before change:  [2.19622148]
curr_Stock_Price:  98.84803701870075
curr_Factors:  [98.84803702 -0.1284917  -0.88732654]
mat_Sqrt:  [[35.79346935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00140633 -0.00084765  0.13075458]
Stock Position:  0.0014063265081900671
Bond Position:  [2.05720887]


portfolio before change:  [2.19888859]
curr_Stock_Price:  100.56167857200244
curr_Factors:  [100.56167857  -0.12664816  -0.90142254]
mat_Sqrt:  [[35.97055028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071024  0.00704854 -0.20711888]
Stock Position:  0.0007102356783619298
Bond Position:  [2.1274661]


portfolio before change:  [2.20042205]
curr_Stock_Price:  102.34631491095531
curr_Factors:  [102.34631491  -0.16263406  -0.9257828 ]
mat_Sqrt:  [[34.46503904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00092288  0.00516851  0.10189638]
Stock Position:  -0.0009228759049548699
Bond Position:  [2.294875]


portfolio before change:  [2.20061782]
curr_Stock_Price:  102.44503552878085
curr_Factors:  [102.44503553  -0.43295165  -0.92792858]
mat_Sqrt:  [[26.27048832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00075996 -0.02478565 -0.16646907]
Stock Position:  -0.0007599606460630689
Bond Position:  [2.27847202]


portfolio before change:  [2.20377998]
curr_Stock_Price:  98.65887451834362
curr_Factors:  [98.65887452 -0.39445625 -0.92746761]
mat_Sqrt:  [[26.30461319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180904  0.02148847 -0.04894452]
Stock Position:  -0.0018090384815609704
Bond Position:  [2.38225768]


portfolio before change:  [2.20050376]
curr_Stock_Price:  100.63452325634266
curr_Factors:  [100.63452326  -0.61027983  -0.9251991 ]
mat_Sqrt:  [[21.67189899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [5.71340394e-03 3.66168265e-04 4.70151016e-01]
Stock Position:  0.005713403942581685
Bond Position:  [1.62553807]


portfolio before change:  [2.20054414]
curr_Stock_Price:  100.60602572053654
curr_Factors:  [100.60602572  -0.31322983  -0.92065689]
mat_Sqrt:  [[29.292322    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00272061  0.02118669 -0.19420491]
Stock Position:  -0.0027206054073476457
Bond Position:  [2.47425344]


portfolio before change:  [2.20393356]
curr_Stock_Price:  99.47388275946356
curr_Factors:  [99.47388276 -0.23527372 -0.91767921]
mat_Sqrt:  [[31.40421733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00135251 -0.00634776  0.09015431]
Stock Position:  -0.0013525142836460944
Bond Position:  [2.33847341]


portfolio before change:  [2.202711]
curr_Stock_Price:  100.5939333793716
curr_Factors:  [ 1.00593933e+02 -5.66733721e-02 -9.61625532e-01]
mat_Sqrt:  [[36.33542087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00312476 0.00202376 0.25834071]
Stock Position:  0.003124762993445466
Bond Position:  [1.8883788]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.19153968]
Stock Price:  96.94329386591978
PL:  [2.19153968]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 2.30962208e-02  2.05539551e-02 -4.34437994e-03]
 [-1.55879724e-01  7.41675363e-02 -1.48525147e-01]
 [ 2.81975677e-03 -7.12549127e-03  4.60441468e-02]
 [ 1.18924118e-01  3.29008179e-02  1.43856611e-01]
 [ 1.61987170e-01 -1.70193710e-01 -1.04310293e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.25794702e-02 -1.58981395e-01 -2.71733851e-02]
 [ 1.56134591e-02  6.57678384e-01  8.63376015e-02]
 [ 2.63490560e-01 -1.38979798e-02  2.75685778e-01]
 [ 4.09352074e-01  1.56135482e-01  2.55097610e-01]
 [-2.79833478e-01 -2.71477794e-01  1.98477555e-02]
 [-1.00960150e-01 -2.02041309e-02  8.44969461e-02]
 [ 1.60119474e-02 -9.83715885e-02  1.26315775e-01]
 [ 1.21924378e-03  1.50948506e-01 -1.00447036e-01]
 [ 5.32202129e-01 -1.32453238e-01 -2.46574478e-01]
 [-2.02392043e-01 -9.56705918e-02  1.16829687e-01]
 [ 5.15116724e-02  1.68333510e-02 -2.81988591e-02]
 [-5.78965305e-02 -6.13258031e-02  2.70553843e-02]
 [ 1.36905628e-01 -1.62599760e-01 -3.26524537e-03]
 [ 3.44775612e-02 -1.46400641e-02  1.26087747e-01]
 [-3.29371480e-02  4.81124712e-01 -4.63594870e-01]
 [ 2.83851448e-01  1.71262600e-01  7.61547206e-02]
 [-1.36738267e-02  1.72750164e-02  3.87213650e-02]
 [ 4.08821084e-02 -7.38018664e-02 -1.75535261e-01]
 [ 3.24853731e-02  1.82122726e-02 -1.24055379e-02]
 [-5.89329908e-02 -7.62637905e-03  1.76604608e-01]
 [-1.00014241e-02 -3.24890709e-02  1.89043675e-03]
 [-6.44051533e-02  4.27707945e-02 -2.48682965e-01]
 [-4.84209578e-02 -3.82112007e-02  1.61300604e-02]
 [-2.32449377e-02  1.93639071e-02 -2.02737663e-02]
 [ 1.97914064e-02 -4.40996700e-02 -7.27364325e-02]
 [ 1.34827073e-02  5.09060854e-02 -5.44044589e-02]
 [-1.51622792e-02  2.26263435e-02 -2.59843553e-02]
 [ 3.60078513e-02 -3.78834499e-02  1.52463154e-01]
 [-7.32026481e-02  3.83072361e-04 -3.03640830e-02]
 [-3.35513103e-02 -9.57284548e-02 -1.68987687e-02]
 [-2.16834791e-02  1.01129686e-01  8.25196937e-02]
 [ 1.52890935e-01 -1.14459209e-01 -1.36963449e-01]
 [ 9.62480561e-02  4.73783251e-03  7.59151327e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.08265353]
curr_Stock_Price:  99.18351337926984
curr_Factors:  [99.18351338 -0.81845708 -0.97641982]
mat_Sqrt:  [[16.47913281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00160233  0.00663376 -0.01239331]
Stock Position:  0.0016023286405959986
Bond Position:  [-4.24157811]


portfolio before change:  [-4.08252894]
curr_Stock_Price:  99.59218283756377
curr_Factors:  [99.59218284 -0.88161775 -0.95827291]
mat_Sqrt:  [[15.81870369  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01081365  0.02393747 -0.4237009 ]
Stock Position:  -0.010813648891564534
Bond Position:  [-3.00557404]


portfolio before change:  [-4.09777211]
curr_Stock_Price:  100.96706177221228
curr_Factors:  [100.96706177  -0.83685682  -0.96618829]
mat_Sqrt:  [[16.6389982   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00064691 -0.00229974  0.13135113]
Stock Position:  0.0006469135906780154
Bond Position:  [-4.16308908]


portfolio before change:  [-4.09863651]
curr_Stock_Price:  100.43533988664308
curr_Factors:  [100.43533989  -0.81798961  -0.94984149]
mat_Sqrt:  [[17.14459641  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00904102 0.01061869 0.41038287]
Stock Position:  0.009041016396673216
Bond Position:  [-5.00667407]


portfolio before change:  [-4.09152658]
curr_Stock_Price:  101.29097389317948
curr_Factors:  [101.29097389  -0.99195487  -0.93529705]
mat_Sqrt:  [[14.7426607   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00718692 -0.05492978 -0.29756823]
Stock Position:  0.007186916742320729
Bond Position:  [-4.81949638]


portfolio before change:  [-4.09257069]
curr_Stock_Price:  101.22952407347569
curr_Factors:  [101.22952407  -0.95055667  -0.95078761]
mat_Sqrt:  [[15.12042044  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01013888 -0.05534923  0.15513819]
Stock Position:  -0.01013888448253366
Bond Position:  [-3.06621624]


portfolio before change:  [-4.09455711]
curr_Stock_Price:  101.38763961655017
curr_Factors:  [101.38763962  -0.9989086   -0.96835049]
mat_Sqrt:  [[14.17800886  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00638864 -0.05131102 -0.0775181 ]
Stock Position:  -0.006388637254571403
Bond Position:  [-3.44682826]


portfolio before change:  [-4.09093049]
curr_Stock_Price:  100.75252794831313
curr_Factors:  [100.75252795  -0.90304151  -0.93402417]
mat_Sqrt:  [[16.0482789   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01043633 0.21226479 0.24629715]
Stock Position:  0.010436326988285444
Bond Position:  [-5.14241682]


portfolio before change:  [-4.09176332]
curr_Stock_Price:  100.73432346759525
curr_Factors:  [100.73432347  -0.92224915  -0.95705532]
mat_Sqrt:  [[15.38175568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02060413 -0.00448555  0.78645479]
Stock Position:  0.020604134965680195
Bond Position:  [-6.16730692]


portfolio before change:  [-4.10842354]
curr_Stock_Price:  99.96315489932378
curr_Factors:  [99.9631549  -0.92388195 -0.92249749]
mat_Sqrt:  [[15.77493401  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03127079 0.05039251 0.72772247]
Stock Position:  0.031270791834128245
Bond Position:  [-7.23435055]


portfolio before change:  [-4.08279875]
curr_Stock_Price:  100.81152304689907
curr_Factors:  [100.81152305  -0.63353175  -0.91573427]
mat_Sqrt:  [[21.41275213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01546729 -0.08761908  0.05662012]
Stock Position:  -0.015467289874561653
Bond Position:  [-2.5235177]


portfolio before change:  [-4.09582634]
curr_Stock_Price:  101.63339481711141
curr_Factors:  [101.63339482  -0.28333585  -0.91705632]
mat_Sqrt:  [[30.59938795  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00287053 -0.00652086  0.24104627]
Stock Position:  -0.002870529129234791
Bond Position:  [-3.80408472]


portfolio before change:  [-4.10508128]
curr_Stock_Price:  104.69185652083164
curr_Factors:  [104.69185652  -0.67489608  -0.96057822]
mat_Sqrt:  [[20.40024756  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0010645  -0.03174929  0.36034375]
Stock Position:  0.0010644983853687557
Bond Position:  [-4.21652559]


portfolio before change:  [-4.10554943]
curr_Stock_Price:  104.74723929943572
curr_Factors:  [104.7472393   -0.65384272  -0.97941008]
mat_Sqrt:  [[20.45643298  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00056353  0.04871842 -0.28654744]
Stock Position:  0.0005635299676329999
Bond Position:  [-4.16457763]


portfolio before change:  [-4.10601409]
curr_Stock_Price:  104.84650015725455
curr_Factors:  [104.84650016  -0.57329644  -0.94575209]
mat_Sqrt:  [[22.95300463  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01981586 -0.0427491  -0.70340835]
Stock Position:  0.019815855388528064
Bond Position:  [-6.18363718]


portfolio before change:  [-4.13514276]
curr_Stock_Price:  103.41554202644984
curr_Factors:  [103.41554203  -0.56564638  -0.94118207]
mat_Sqrt:  [[22.91809589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00864264 -0.03087755  0.33328258]
Stock Position:  -0.008642644742253182
Bond Position:  [-3.24135897]


portfolio before change:  [-4.13180673]
curr_Stock_Price:  102.98266233207127
curr_Factors:  [102.98266233  -0.49594649  -0.95100378]
mat_Sqrt:  [[24.23045645  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00203016  0.00543294 -0.0804435 ]
Stock Position:  0.002030159765278289
Bond Position:  [-4.34087798]


portfolio before change:  [-4.13005917]
curr_Stock_Price:  104.11075304233114
curr_Factors:  [104.11075304  -0.79139476  -0.96950889]
mat_Sqrt:  [[17.89554175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00362615 -0.01979282  0.07718148]
Stock Position:  -0.0036261517738524116
Bond Position:  [-3.75253777]


portfolio before change:  [-4.12846318]
curr_Stock_Price:  103.54125630953702
curr_Factors:  [103.54125631  -0.94359854  -0.98710345]
mat_Sqrt:  [[15.0182804   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00686154 -0.05247885 -0.00931484]
Stock Position:  0.006861542930387029
Bond Position:  [-4.83891596]


portfolio before change:  [-4.13875788]
curr_Stock_Price:  102.12906759501453
curr_Factors:  [102.1290676   -0.93422609  -1.0024064 ]
mat_Sqrt:  [[14.72585645  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00388614 -0.00472506  0.35969325]
Stock Position:  0.0038861389397361504
Bond Position:  [-4.53564562]


portfolio before change:  [-4.14036737]
curr_Stock_Price:  101.86080510036416
curr_Factors:  [101.8608051   -0.96723045  -1.00473774]
mat_Sqrt:  [[14.1772566   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207084  0.15528233 -1.32250712]
Stock Position:  -0.002070843805764449
Bond Position:  [-3.92942956]


portfolio before change:  [-4.14038761]
curr_Stock_Price:  101.63337570782952
curr_Factors:  [101.63337571  -0.96342739  -0.99909585]
mat_Sqrt:  [[14.27983988  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0234145  0.05527477 0.21724822]
Stock Position:  0.023414499072637655
Bond Position:  [-6.52008219]


portfolio before change:  [-4.1656636]
curr_Stock_Price:  100.58868418323208
curr_Factors:  [100.58868418  -0.90170155  -0.96454933]
mat_Sqrt:  [[15.56132839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00014418  0.00557549  0.11046128]
Stock Position:  -0.00014417876927631562
Bond Position:  [-4.15116085]


portfolio before change:  [-4.16597749]
curr_Stock_Price:  99.16659618011361
curr_Factors:  [99.16659618 -0.9355201  -0.95769627]
mat_Sqrt:  [[14.93316901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00067056 -0.02381945 -0.50075324]
Stock Position:  -0.0006705622640679901
Bond Position:  [-4.09948012]


portfolio before change:  [-4.16664594]
curr_Stock_Price:  99.39919806510677
curr_Factors:  [99.39919807 -1.06417613 -0.95457679]
mat_Sqrt:  [[13.20230093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00255036  0.00587799 -0.03538955]
Stock Position:  0.0025503636067981594
Bond Position:  [-4.42015003]


portfolio before change:  [-4.16649798]
curr_Stock_Price:  99.67386772155349
curr_Factors:  [99.67386772 -1.17038128 -0.95664773]
mat_Sqrt:  [[11.8802163   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00205724 -0.0024614   0.50380379]
Stock Position:  -0.002057239832530969
Bond Position:  [-3.96144493]


portfolio before change:  [-4.16741044]
curr_Stock_Price:  99.87668668218748
curr_Factors:  [99.87668668 -1.24247827 -0.9159135 ]
mat_Sqrt:  [[11.53682996  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014083  -0.0104858   0.00539289]
Stock Position:  -0.001408302295388178
Bond Position:  [-4.02675387]


portfolio before change:  [-4.16702271]
curr_Stock_Price:  99.24393722261424
curr_Factors:  [99.24393722 -1.25833525 -0.92473425]
mat_Sqrt:  [[11.1843036   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00951662  0.01380421 -0.70942328]
Stock Position:  -0.00951662283852917
Bond Position:  [-3.22255559]


portfolio before change:  [-4.15960691]
curr_Stock_Price:  98.422359595663
curr_Factors:  [98.4223596  -1.36111668 -0.91153067]
mat_Sqrt:  [[10.14134525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00521906 -0.01233261  0.04601457]
Stock Position:  -0.005219056281244237
Bond Position:  [-3.64593508]


portfolio before change:  [-4.1587667]
curr_Stock_Price:  98.17404108666082
curr_Factors:  [98.17404109 -1.27481852 -0.89944856]
mat_Sqrt:  [[11.161549    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209923  0.00624967 -0.05783541]
Stock Position:  -0.0020992303068180025
Bond Position:  [-3.95267677]


portfolio before change:  [-4.1612428]
curr_Stock_Price:  99.11818951791028
curr_Factors:  [99.11818952 -1.21997366 -0.91923856]
mat_Sqrt:  [[11.67092563  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034767 -0.01423311 -0.2074968 ]
Stock Position:  -0.0003476727757419956
Bond Position:  [-4.1267821]


portfolio before change:  [-4.16182889]
curr_Stock_Price:  99.32015714694754
curr_Factors:  [99.32015715 -1.05581663 -0.94097211]
mat_Sqrt:  [[13.48475516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094689  0.01642987 -0.15520078]
Stock Position:  0.0009468918539304621
Bond Position:  [-4.25587434]


portfolio before change:  [-4.16298025]
curr_Stock_Price:  98.66607752692542
curr_Factors:  [98.66607753 -1.04342121 -0.96071636]
mat_Sqrt:  [[13.29786671  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00119175  0.00730262 -0.07412613]
Stock Position:  -0.0011917498398243478
Bond Position:  [-4.04539497]


portfolio before change:  [-4.16249566]
curr_Stock_Price:  97.83511068291864
curr_Factors:  [97.83511068 -0.81614023 -0.95482275]
mat_Sqrt:  [[16.64850699  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00356767 -0.01222683  0.43493494]
Stock Position:  0.0035676673866488354
Bond Position:  [-4.51153879]


portfolio before change:  [-4.16996766]
curr_Stock_Price:  95.89882373516225
curr_Factors:  [95.89882374 -0.78956761 -0.92454856]
mat_Sqrt:  [[17.27356924  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00459213  0.00012364 -0.08662028]
Stock Position:  -0.004592131200851719
Bond Position:  [-3.72958768]


portfolio before change:  [-4.17719513]
curr_Stock_Price:  97.37117813614287
curr_Factors:  [97.37117814 -1.21345988 -0.93373004]
mat_Sqrt:  [[11.37411702  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00497104 -0.03089623 -0.04820748]
Stock Position:  -0.004971044863775774
Bond Position:  [-3.69315864]


portfolio before change:  [-4.18045341]
curr_Stock_Price:  97.93375604856156
curr_Factors:  [97.93375605 -1.0747369  -0.93536334]
mat_Sqrt:  [[13.12069893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00120449 0.03263947 0.23540572]
Stock Position:  0.0012044932686889535
Bond Position:  [-4.29841396]


portfolio before change:  [-4.18193917]
curr_Stock_Price:  97.14634748647627
curr_Factors:  [97.14634749 -1.19173953 -0.91581607]
mat_Sqrt:  [[11.80665058  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00860274 -0.03694155 -0.3907186 ]
Stock Position:  0.00860273618490451
Bond Position:  [-5.01766357]


portfolio before change:  [-4.17232932]
curr_Stock_Price:  98.33632957010235
curr_Factors:  [98.33632957 -1.4014101  -0.90645743]
mat_Sqrt:  [[ 9.7818244   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01152252 0.00152913 0.21656474]
Stock Position:  0.011522520657457057
Bond Position:  [-5.30541171]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.17536706]
Stock Price:  98.13025238912631
PL:  [-4.17536706]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.30349628e-01 -9.39757568e-02  1.63823355e-02]
 [-2.96661751e-02  3.31035880e-02  6.67183540e-03]
 [-1.10094977e-03  1.22069737e-02  4.57098899e-02]
 [-3.77359169e-01 -1.81386120e-01 -2.18559053e-01]
 [ 1.50471282e-01 -1.47297561e-01 -1.00017749e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.26812598e-02 -1.54594939e-01 -2.70669790e-02]
 [ 8.50956291e-03  6.19805785e-01  9.34820710e-02]
 [ 3.32910716e-01  1.54947829e-02  3.42324162e-01]
 [ 5.09539088e-01  2.12879181e-01  3.87979684e-01]
 [-2.10223800e-01 -2.07163409e-01  4.12890800e-02]
 [-1.63774265e-02 -1.68128091e-02  9.75470470e-02]
 [ 1.27319860e-02 -5.84174328e-02  8.62982159e-02]
 [ 4.73957865e-03  1.73247870e-02 -2.65562441e-02]
 [ 1.78764052e-01 -1.57165125e-01 -1.26633142e-01]
 [-7.86662628e-02 -5.46083629e-02  8.75192895e-02]
 [ 4.59543733e-02  2.68073254e-02  4.30448058e-03]
 [-5.40404436e-02 -6.32861377e-02  6.59777769e-03]
 [ 4.48385688e-02 -1.99379960e-03 -1.41385030e-01]
 [ 1.83016643e-02 -5.13155747e-03  3.92991698e-02]
 [-1.81756810e-02  3.44324266e-01 -2.95366009e-01]
 [ 9.09031249e-02  7.72699447e-02  1.09475626e-01]
 [ 8.97329123e-04 -2.85815677e-02  6.68160604e-02]
 [ 9.99979224e-02 -5.45175302e-02 -2.24294985e-01]
 [-1.37772398e-03  2.26042454e-02 -9.30752032e-03]
 [-1.05944945e-01 -1.47029543e-02  2.26416734e-01]
 [-3.43091073e-02 -3.32043264e-02 -5.01464191e-03]
 [-8.66830047e-02  8.28985629e-02 -1.80837715e-01]
 [-2.35984045e-02 -4.08037401e-02  4.78125582e-02]
 [-1.92572045e-03  2.92130267e-02 -4.21798450e-02]
 [ 3.36159916e-02 -3.41105983e-02 -7.68405687e-02]
 [-4.12248218e-03  9.64947269e-02 -1.09830530e-01]
 [-3.24691396e-02  2.82014912e-02 -6.30812582e-02]
 [ 3.27652974e-02 -4.20460360e-02  1.31412586e-01]
 [-5.79616841e-02  3.52868003e-02 -6.94639881e-03]
 [ 8.90424770e-02 -8.06104111e-03  1.54597201e-01]
 [-1.26662530e-02  1.33460921e-02 -4.24737447e-02]
 [-7.86617913e-02  1.53986488e-02  3.89414403e-02]
 [ 9.10283675e-02  7.97156145e-03  1.06814653e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.37672041]
curr_Stock_Price:  100.250007335612
curr_Factors:  [100.25000734  -0.98280594  -0.98611639]
mat_Sqrt:  [[13.99562544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01044529 -0.03033055  0.04673424]
Stock Position:  -0.010445286627924436
Bond Position:  [5.42386047]


portfolio before change:  [4.36305387]
curr_Stock_Price:  101.62331226076873
curr_Factors:  [101.62331226  -1.00079413  -0.9769674 ]
mat_Sqrt:  [[14.0624965   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00153224  0.01068414  0.01903289]
Stock Position:  -0.0015322351080882294
Bond Position:  [4.51876468]


portfolio before change:  [4.36507913]
curr_Stock_Price:  100.67021221660926
curr_Factors:  [100.67021222  -1.07615862  -0.99222256]
mat_Sqrt:  [[12.72373017  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00084262 0.00393978 0.13039759]
Stock Position:  0.0008426208644273344
Bond Position:  [4.28025231]


portfolio before change:  [4.36659259]
curr_Stock_Price:  101.83134715720315
curr_Factors:  [101.83134716  -1.17511031  -0.9980415 ]
mat_Sqrt:  [[11.5902726   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03960197 -0.05854212 -0.62348814]
Stock Position:  -0.03960197063733568
Bond Position:  [8.39931461]


portfolio before change:  [4.39123935]
curr_Stock_Price:  101.2354985844324
curr_Factors:  [101.23549858  -0.88758217  -0.99345637]
mat_Sqrt:  [[15.43150087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00647949 -0.04754008 -0.2853228 ]
Stock Position:  0.006479490017738877
Bond Position:  [3.73528494]


portfolio before change:  [4.39155952]
curr_Stock_Price:  101.21284719557885
curr_Factors:  [101.2128472   -0.97485061  -0.99049263]
mat_Sqrt:  [[14.1807081   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01081076 -0.05534923  0.15513819]
Stock Position:  -0.010810757479644129
Bond Position:  [5.48574706]


portfolio before change:  [4.39226857]
curr_Stock_Price:  101.21069216854397
curr_Factors:  [101.21069217  -1.01601245  -0.99044273]
mat_Sqrt:  [[13.60924344  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00659573 -0.0498953  -0.07721456]
Stock Position:  -0.006595726198514761
Bond Position:  [5.05982659]


portfolio before change:  [4.38339533]
curr_Stock_Price:  102.65189180738281
curr_Factors:  [102.65189181  -0.96098134  -1.00114854]
mat_Sqrt:  [[14.42861938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01068077 0.20004146 0.26667833]
Stock Position:  0.01068077496869113
Bond Position:  [3.28699358]


portfolio before change:  [4.38150697]
curr_Stock_Price:  102.43662085234203
curr_Factors:  [102.43662085  -1.19318859  -0.99859594]
mat_Sqrt:  [[11.44393323  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03547296 0.00500092 0.97655555]
Stock Position:  0.03547296142675912
Bond Position:  [0.74777667]


portfolio before change:  [4.34900417]
curr_Stock_Price:  101.51771580801214
curr_Factors:  [101.51771581  -1.05463009  -0.99721824]
mat_Sqrt:  [[13.04474014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04846313 0.06870646 1.10679805]
Stock Position:  0.048463126374537945
Bond Position:  [-0.57086172]


portfolio before change:  [4.33450815]
curr_Stock_Price:  101.22007383009027
curr_Factors:  [101.22007383  -1.04631705  -0.98958278]
mat_Sqrt:  [[13.21559092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0184693  -0.0668617   0.11778625]
Stock Position:  -0.018469303225316175
Bond Position:  [6.20397238]


portfolio before change:  [4.33466654]
curr_Stock_Price:  101.25348866906658
curr_Factors:  [101.25348867  -1.04388374  -1.00531954]
mat_Sqrt:  [[13.04524741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.84813306e-06 -5.42631079e-03  2.78274573e-01]
Stock Position:  7.848133058614293e-06
Bond Position:  [4.33387189]


portfolio before change:  [4.33520703]
curr_Stock_Price:  101.0910177279419
curr_Factors:  [101.09101773  -1.06320979  -1.00193451]
mat_Sqrt:  [[12.81834024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00143725 -0.01885415  0.24618479]
Stock Position:  0.0014372474650966962
Bond Position:  [4.18991423]


portfolio before change:  [4.33632523]
curr_Stock_Price:  101.5046011510585
curr_Factors:  [101.50460115  -1.28780596  -1.00869211]
mat_Sqrt:  [[10.21243463  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00027958  0.00559155 -0.07575757]
Stock Position:  0.00027958224036984193
Bond Position:  [4.30794634]


portfolio before change:  [4.33692418]
curr_Stock_Price:  101.72071850599556
curr_Factors:  [101.72071851  -1.08376308  -0.9920024 ]
mat_Sqrt:  [[12.76191736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00946832 -0.05072483 -0.36124911]
Stock Position:  0.009468324402778441
Bond Position:  [3.37379942]


portfolio before change:  [4.3332616]
curr_Stock_Price:  101.2893506128077
curr_Factors:  [101.28935061  -1.00835221  -0.98592446]
mat_Sqrt:  [[13.78670348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00521868 -0.01762477  0.24966817]
Stock Position:  -0.005218676683105354
Bond Position:  [4.86185797]


portfolio before change:  [4.33661078]
curr_Stock_Price:  100.7640422462819
curr_Factors:  [100.76404225  -1.31591661  -0.95909382]
mat_Sqrt:  [[10.35812392  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00504966 0.00865203 0.01227948]
Stock Position:  0.005049663867825378
Bond Position:  [3.82778624]


portfolio before change:  [4.330161]
curr_Stock_Price:  99.39201364660066
curr_Factors:  [99.39201365 -1.30478315 -0.96334143]
mat_Sqrt:  [[10.28768129  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00637772 -0.02042551  0.01882162]
Stock Position:  -0.006377715711780782
Bond Position:  [4.96405501]


portfolio before change:  [4.33298244]
curr_Stock_Price:  99.04692269597813
curr_Factors:  [99.0469227  -1.24908296 -0.99288526]
mat_Sqrt:  [[10.52365398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147967 -0.0006435  -0.40333214]
Stock Position:  0.0014796654948481915
Bond Position:  [4.18642613]


portfolio before change:  [4.3332983]
curr_Stock_Price:  98.90670125980117
curr_Factors:  [98.90670126 -1.3642473  -0.98642097]
mat_Sqrt:  [[ 9.4263478   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00268143 -0.0016562   0.11210959]
Stock Position:  0.002681430755509738
Bond Position:  [4.06808682]


portfolio before change:  [4.33356972]
curr_Stock_Price:  98.81827179482428
curr_Factors:  [98.81827179 -1.46413206 -0.9837393 ]
mat_Sqrt:  [[ 8.54555416  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095747  0.11113018 -0.84259701]
Stock Position:  -0.0009574708229921544
Bond Position:  [4.42818533]


portfolio before change:  [4.33406988]
curr_Stock_Price:  98.87404401510605
curr_Factors:  [98.87404402 -1.27746787 -0.9648848 ]
mat_Sqrt:  [[10.50124777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01228639 0.02493877 0.31230349]
Stock Position:  0.01228638803003894
Bond Position:  [3.11926501]


portfolio before change:  [4.3266011]
curr_Stock_Price:  98.234416409993
curr_Factors:  [98.23441641 -1.09770364 -0.96656519]
mat_Sqrt:  [[12.46703295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00069799 -0.00922466  0.19060762]
Stock Position:  0.0006979938453125526
Bond Position:  [4.25803408]


portfolio before change:  [4.32687973]
curr_Stock_Price:  97.87101483853384
curr_Factors:  [97.87101484 -1.16348719 -0.9614951 ]
mat_Sqrt:  [[11.68923281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00368592 -0.01759546 -0.63985116]
Stock Position:  0.0036859182096404537
Bond Position:  [3.96613518]


portfolio before change:  [4.3275372]
curr_Stock_Price:  97.91487716074121
curr_Factors:  [97.91487716 -1.20108843 -0.96518652]
mat_Sqrt:  [[11.22140994  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0001191   0.00729549 -0.02655176]
Stock Position:  0.00011909899553025462
Bond Position:  [4.31587564]


portfolio before change:  [4.32802022]
curr_Stock_Price:  97.44044251828322
curr_Factors:  [97.44044252 -1.05973519 -0.96697147]
mat_Sqrt:  [[12.83960683  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00488559 -0.00474536  0.64590392]
Stock Position:  -0.004885589684149565
Bond Position:  [4.80407424]


portfolio before change:  [4.32919406]
curr_Stock_Price:  97.32309816910445
curr_Factors:  [97.32309817 -1.01854817 -0.94502337]
mat_Sqrt:  [[13.65990371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308278 -0.01071665 -0.01430538]
Stock Position:  -0.0030827831921281606
Bond Position:  [4.62922007]


portfolio before change:  [4.32791872]
curr_Stock_Price:  97.92451352132078
curr_Factors:  [97.92451352 -0.87466817 -0.95713094]
mat_Sqrt:  [[15.68018478  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00680316  0.0267554  -0.51587967]
Stock Position:  -0.006803156464211097
Bond Position:  [4.9941145]


portfolio before change:  [4.32834211]
curr_Stock_Price:  97.95404542861061
curr_Factors:  [97.95404543 -1.08037849 -0.96884321]
mat_Sqrt:  [[12.61992275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175657 -0.01316935  0.13639592]
Stock Position:  -0.0017565666564895678
Bond Position:  [4.50040492]


portfolio before change:  [4.33009994]
curr_Stock_Price:  97.27360372398408
curr_Factors:  [97.27360372 -1.18055142 -0.97830032]
mat_Sqrt:  [[11.23097874  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00040714  0.00942846 -0.12032736]
Stock Position:  -0.00040713825973396787
Bond Position:  [4.36970374]


portfolio before change:  [4.33062732]
curr_Stock_Price:  97.31993945244604
curr_Factors:  [97.31993945 -1.04408891 -0.96611176]
mat_Sqrt:  [[13.03715325  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0008413  -0.01100915 -0.21920475]
Stock Position:  0.0008413017193420086
Bond Position:  [4.24875189]


portfolio before change:  [4.33106872]
curr_Stock_Price:  97.21328341396644
curr_Factors:  [97.21328341 -0.82688907 -0.97807701]
mat_Sqrt:  [[15.98964435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042807  0.03114354 -0.31331593]
Stock Position:  -0.00042806716193945026
Bond Position:  [4.37268253]


portfolio before change:  [4.33124975]
curr_Stock_Price:  98.0673168766612
curr_Factors:  [98.06731688 -0.82555254 -0.99709001]
mat_Sqrt:  [[15.84749753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249812  0.00910199 -0.17995327]
Stock Position:  -0.0024981194779039994
Bond Position:  [4.57623363]


portfolio before change:  [4.33160277]
curr_Stock_Price:  98.1550009787649
curr_Factors:  [98.15500098 -0.59591296 -1.00413716]
mat_Sqrt:  [[19.81615966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00257402 -0.0135703   0.37488353]
Stock Position:  0.0025740188282350443
Bond Position:  [4.07894995]


portfolio before change:  [4.3365413]
curr_Stock_Price:  99.87551214227848
curr_Factors:  [99.87551214 -0.62946479 -1.00227073]
mat_Sqrt:  [[19.53463449  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267099  0.01138877 -0.01981614]
Stock Position:  -0.0026709854198250734
Bond Position:  [4.60330734]


portfolio before change:  [4.33574456]
curr_Stock_Price:  100.38924982678739
curr_Factors:  [100.38924983  -0.6191846   -0.98820069]
mat_Sqrt:  [[20.11910438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00591249 -0.00260169  0.44102278]
Stock Position:  0.005912492078146569
Bond Position:  [3.74219392]


portfolio before change:  [4.34229407]
curr_Stock_Price:  101.41786852171079
curr_Factors:  [101.41786852  -0.60885701  -1.00411148]
mat_Sqrt:  [[20.21208727  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00092083  0.00430743 -0.12116577]
Stock Position:  -0.0009208306870860471
Bond Position:  [4.43568275]


portfolio before change:  [4.34128156]
curr_Stock_Price:  103.11959807228875
curr_Factors:  [103.11959807  -0.8640122   -1.01943976]
mat_Sqrt:  [[15.68080727  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430907  0.00496989  0.11108909]
Stock Position:  -0.004309068140181021
Bond Position:  [4.78563093]


portfolio before change:  [4.34641622]
curr_Stock_Price:  102.06683694423182
curr_Factors:  [102.06683694  -0.94935703  -0.98494319]
mat_Sqrt:  [[14.75124727  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00775928 0.00257281 0.30471247]
Stock Position:  0.007759276433036563
Bond Position:  [3.55445141]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.33460187]
Stock Price:  100.48696316595075
PL:  [3.84763871]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-8.19059125e-02 -8.78297211e-02  1.44910121e-02]
 [-1.45754767e-01  7.55526728e-02 -1.18671571e-01]
 [-4.38453800e-03  1.56822262e-02  4.33887054e-02]
 [ 7.92789585e-02  7.99103374e-02  6.89083207e-02]
 [ 2.92201559e-02  5.31886192e-02 -6.90873280e-02]
 [-1.29791956e-01 -1.65937204e-01  8.57932538e-02]
 [-6.22779693e-02 -1.60198884e-01  6.96797508e-02]
 [-4.40729180e-03  7.53676481e-01  1.24903347e-01]
 [ 2.52406018e-01 -1.88258042e-02  2.63591043e-01]
 [ 5.10706843e-01  2.11202794e-01  3.81983940e-01]
 [-2.10213812e-01 -2.65994226e-01 -7.50484488e-03]
 [ 4.30668940e-02 -1.22469825e-02  1.18757958e-01]
 [ 1.45187574e-02 -4.61207192e-02  4.51793974e-02]
 [ 1.08413743e-03  8.12885063e-02  4.25639200e-02]
 [ 2.91033376e-01 -1.89100023e-01 -1.55895710e-01]
 [-1.98684871e-01 -8.85467562e-02  1.15215856e-01]
 [ 4.64749580e-02  2.58730048e-02  1.25970254e-03]
 [-3.65802644e-02 -4.87167955e-02  5.74060386e-02]
 [ 9.50852426e-02 -6.87374069e-02 -6.53257304e-02]
 [ 3.84864565e-02 -7.46666242e-03  1.11418160e-01]
 [-2.44441365e-02  4.15031297e-01 -3.95337487e-01]
 [ 2.56693975e-01  1.58267841e-01  8.05771237e-02]
 [-4.36291215e-03  7.52102108e-02  4.10759057e-03]
 [ 4.87751028e-02 -1.56872737e-01 -2.08797498e-01]
 [ 4.26885189e-02 -3.08080986e-03 -1.24324686e-02]
 [-9.77402804e-03  1.68358073e-02  2.77263634e-02]
 [ 8.77652633e-02 -2.58002868e-02  5.62098458e-02]
 [ 1.63760973e-01 -5.62387931e-02  1.93234289e-01]
 [-4.32733555e-02 -7.07978074e-03 -4.75254704e-02]
 [-6.21981657e-02 -1.39365422e-02  3.90567993e-02]
 [-2.63712581e-02 -4.19497641e-02 -8.22708990e-03]
 [ 2.61357177e-02 -2.47877951e-02 -7.06152559e-02]
 [ 1.56253611e-02  5.04674847e-03  1.56341652e-01]
 [ 6.99470125e-03 -7.79968298e-02 -6.66710140e-02]
 [-1.78778872e-03  2.26421888e-02  4.23440936e-02]
 [ 5.99479292e-02  3.37192764e-02  1.62718755e-01]
 [ 2.72353629e-01 -1.83507548e-01  1.46853776e-01]
 [-7.69205207e-02  1.68932093e-02  3.82361754e-02]
 [ 1.19812833e-01  2.95582287e-03  1.10476598e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.86834772]
curr_Stock_Price:  100.05984310268646
curr_Factors:  [100.0598431   -0.61081061  -0.99835832]
mat_Sqrt:  [[20.01735237  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00483961 -0.02834692  0.04133882]
Stock Position:  -0.004839606757767915
Bond Position:  [3.35259802]


portfolio before change:  [2.87067105]
curr_Stock_Price:  99.66637589107609
curr_Factors:  [99.66637589 -0.70479985 -0.9965445 ]
mat_Sqrt:  [[18.18294419  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00850007  0.02438452 -0.33853696]
Stock Position:  -0.008500074205891736
Bond Position:  [3.71784264]


portfolio before change:  [2.86598971]
curr_Stock_Price:  100.27179437141524
curr_Factors:  [100.27179437  -0.62607622  -0.94040614]
mat_Sqrt:  [[20.93457473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00036654 0.00506142 0.1237759 ]
Stock Position:  0.0003665355288523013
Bond Position:  [2.82923653]


portfolio before change:  [2.86618064]
curr_Stock_Price:  99.82779756971068
curr_Factors:  [99.82779757 -0.68778177 -0.9501817 ]
mat_Sqrt:  [[19.40407719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00565121 0.02579095 0.19657626]
Stock Position:  0.00565120612429789
Bond Position:  [2.30203318]


portfolio before change:  [2.8671141]
curr_Stock_Price:  99.94205412551541
curr_Factors:  [99.94205413 -0.71694455 -0.94689768]
mat_Sqrt:  [[18.9300068   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00137215  0.01716655 -0.19708692]
Stock Position:  0.0013721519384591145
Bond Position:  [2.72997842]


portfolio before change:  [2.86815866]
curr_Stock_Price:  100.45460008233454
curr_Factors:  [100.45460008  -0.70960632  -0.94420269]
mat_Sqrt:  [[19.21895196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00760454 -0.053556    0.24474427]
Stock Position:  -0.007604539106610253
Bond Position:  [3.6320696]


portfolio before change:  [2.87762851]
curr_Stock_Price:  99.26901705971952
curr_Factors:  [99.26901706 -0.76554618 -0.94374344]
mat_Sqrt:  [[17.96712853  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0044946  -0.05170397  0.19877693]
Stock Position:  -0.004494603018803575
Bond Position:  [3.32380334]


portfolio before change:  [2.87898899]
curr_Stock_Price:  99.05877070072441
curr_Factors:  [99.0587707  -0.82962344 -0.95532502]
mat_Sqrt:  [[16.62262741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01052373 0.24324804 0.35631448]
Stock Position:  0.010523731314531182
Bond Position:  [1.8365211]


portfolio before change:  [2.89520578]
curr_Stock_Price:  100.57792927030947
curr_Factors:  [100.57792927  -0.92709154  -0.96121782]
mat_Sqrt:  [[15.22019978  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01986626 -0.006076    0.75195188]
Stock Position:  0.019866264437978242
Bond Position:  [0.89709804]


portfolio before change:  [2.90912645]
curr_Stock_Price:  101.27300317689067
curr_Factors:  [101.27300318  -0.97914409  -0.94180482]
mat_Sqrt:  [[14.83324511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04259288 0.06816541 1.08969386]
Stock Position:  0.04259287661236031
Bond Position:  [-1.40438208]


portfolio before change:  [2.96436754]
curr_Stock_Price:  102.57408098071413
curr_Factors:  [102.57408098  -1.32427349  -0.92237051]
mat_Sqrt:  [[10.84757199  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02452545 -0.08584927 -0.02140923]
Stock Position:  -0.024525449248972774
Bond Position:  [5.48004295]


portfolio before change:  [2.99210884]
curr_Stock_Price:  101.47088997596086
curr_Factors:  [101.47088998  -1.38559027  -0.936028  ]
mat_Sqrt:  [[ 9.95578407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00650962 -0.0039527   0.3387834 ]
Stock Position:  0.0065096184636349395
Bond Position:  [2.33157206]


portfolio before change:  [2.99523629]
curr_Stock_Price:  101.90655113723174
curr_Factors:  [101.90655114  -1.36713081  -0.94908018]
mat_Sqrt:  [[10.05274002  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00142514 -0.0148854   0.12888425]
Stock Position:  0.0014251448707417345
Bond Position:  [2.85000469]


portfolio before change:  [2.99620344]
curr_Stock_Price:  102.33518808413558
curr_Factors:  [102.33518808  -1.57831221  -0.95070132]
mat_Sqrt:  [[ 8.15996639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00323107 0.02623575 0.12142302]
Stock Position:  0.003231068218554746
Bond Position:  [2.66555146]


portfolio before change:  [2.9987787]
curr_Stock_Price:  103.02909242188181
curr_Factors:  [103.02909242  -1.58790892  -0.99408488]
mat_Sqrt:  [[ 7.79137691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02831482 -0.06103177 -0.44472707]
Stock Position:  0.02831481775513147
Bond Position:  [0.08152873]


portfolio before change:  [2.99329067]
curr_Stock_Price:  102.83491058795892
curr_Factors:  [102.83491059  -1.78923539  -0.97011581]
mat_Sqrt:  [[ 6.51282752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02967084 -0.02857834  0.32867877]
Stock Position:  -0.029670840081996237
Bond Position:  [6.04448886]


portfolio before change:  [3.00249622]
curr_Stock_Price:  102.55012114664817
curr_Factors:  [102.55012115  -1.65141739  -0.97188372]
mat_Sqrt:  [[ 7.44133711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00698979 0.00835048 0.00359358]
Stock Position:  0.006989792014629654
Bond Position:  [2.2856922]


portfolio before change:  [3.00248226]
curr_Stock_Price:  102.50724625953819
curr_Factors:  [102.50724626  -1.53153958  -0.98089086]
mat_Sqrt:  [[ 8.31036095  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00418834 -0.01572328  0.16376345]
Stock Position:  -0.004188335534383677
Bond Position:  [3.43181701]


portfolio before change:  [3.00582392]
curr_Stock_Price:  101.81182648066623
curr_Factors:  [101.81182648  -1.50006499  -0.97800506]
mat_Sqrt:  [[ 8.54252149  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00792737 -0.0221849  -0.18635613]
Stock Position:  0.007927368912494535
Bond Position:  [2.19872401]


portfolio before change:  [3.00332111]
curr_Stock_Price:  101.46143706194988
curr_Factors:  [101.46143706  -1.38534272  -0.96033126]
mat_Sqrt:  [[ 9.71824271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00614365 -0.00240985  0.317845  ]
Stock Position:  0.006143648482313305
Bond Position:  [2.37997771]


portfolio before change:  [3.00624011]
curr_Stock_Price:  101.88813581306934
curr_Factors:  [101.88813581  -1.32050737  -0.96392962]
mat_Sqrt:  [[10.37540928  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196852  0.13395078 -1.12778781]
Stock Position:  -0.001968515549488528
Bond Position:  [3.20680849]


portfolio before change:  [3.00729057]
curr_Stock_Price:  101.55815178506795
curr_Factors:  [101.55815179  -1.28277306  -0.95314249]
mat_Sqrt:  [[10.85597918  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02813638 0.05108073 0.22986411]
Stock Position:  0.028136384061383166
Bond Position:  [0.14981141]


portfolio before change:  [3.01848774]
curr_Stock_Price:  101.95544659301567
curr_Factors:  [101.95544659  -1.15484325  -0.95014017]
mat_Sqrt:  [[12.42303605  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00095208 0.02427399 0.01171781]
Stock Position:  0.00095208338935592
Bond Position:  [2.92141765]


portfolio before change:  [3.01965124]
curr_Stock_Price:  102.79393177246669
curr_Factors:  [102.79393177  -1.14879109  -0.97213324]
mat_Sqrt:  [[12.32712338  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209838 -0.05063046 -0.59564114]
Stock Position:  -0.002098382617561687
Bond Position:  [3.23535224]


portfolio before change:  [3.01724454]
curr_Stock_Price:  104.13360477590766
curr_Factors:  [104.13360478  -1.34490228  -0.99466643]
mat_Sqrt:  [[10.03527133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0039383  -0.00099433 -0.03546637]
Stock Position:  0.0039382975220972624
Bond Position:  [2.60713542]


portfolio before change:  [3.01636896]
curr_Stock_Price:  103.82852418795055
curr_Factors:  [103.82852419  -1.52154277  -0.9714904 ]
mat_Sqrt:  [[ 8.58234823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.89775732e-05  5.43373345e-03  7.90955972e-02]
Stock Position:  -7.89775732115424e-05
Bond Position:  [3.02456908]


portfolio before change:  [3.01675097]
curr_Stock_Price:  103.77883809392084
curr_Factors:  [103.77883809  -1.51613183  -0.96732907]
mat_Sqrt:  [[ 8.66074875  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0108504  -0.00832701  0.16035104]
Stock Position:  0.010850400035826642
Bond Position:  [1.89070907]


portfolio before change:  [3.02383757]
curr_Stock_Price:  104.41017347471526
curr_Factors:  [104.41017347  -1.1942898   -0.96829813]
mat_Sqrt:  [[12.00999462  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01596379 -0.01815099  0.55124364]
Stock Position:  0.01596379244599452
Bond Position:  [1.35705523]


portfolio before change:  [3.01814886]
curr_Stock_Price:  104.04319577363903
curr_Factors:  [104.04319577  -1.28162492  -0.98804344]
mat_Sqrt:  [[10.75249475  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00506111 -0.00228499 -0.13557694]
Stock Position:  -0.005061114372674804
Bond Position:  [3.54472337]


portfolio before change:  [3.02077232]
curr_Stock_Price:  103.61239179376209
curr_Factors:  [103.61239179  -1.28617691  -0.96491337]
mat_Sqrt:  [[10.90876574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00523162 -0.004498    0.11141818]
Stock Position:  -0.005231619789206266
Bond Position:  [3.56283296]


portfolio before change:  [3.024321]
curr_Stock_Price:  103.01921160235679
curr_Factors:  [103.0192116   -1.15693857  -0.92046226]
mat_Sqrt:  [[12.90370727  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00283745 -0.01353923 -0.0234696 ]
Stock Position:  -0.0028374454537888755
Bond Position:  [3.31663239]


portfolio before change:  [3.02476211]
curr_Stock_Price:  103.00987030256672
curr_Factors:  [103.0098703  -1.2559181  -0.9011544]
mat_Sqrt:  [[11.91445433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00055912 -0.00800023 -0.20144567]
Stock Position:  0.0005591235008464553
Bond Position:  [2.96716687]


portfolio before change:  [3.02532405]
curr_Stock_Price:  103.35151946368981
curr_Factors:  [103.35151946  -1.09686882  -0.90879672]
mat_Sqrt:  [[13.90808661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00349211 0.00162883 0.44599922]
Stock Position:  0.0034921144654052848
Bond Position:  [2.66440871]


portfolio before change:  [3.02429145]
curr_Stock_Price:  102.96044656994557
curr_Factors:  [102.96044657  -1.06560355  -0.8967755 ]
mat_Sqrt:  [[14.46838396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155757 -0.02517337 -0.19019385]
Stock Position:  -0.0015575684727854278
Bond Position:  [3.1846594]


portfolio before change:  [3.02484448]
curr_Stock_Price:  102.8609806696291
curr_Factors:  [102.86098067  -1.0326439   -0.91763021]
mat_Sqrt:  [[14.63043975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00078449 0.00730774 0.12079591]
Stock Position:  0.0007844932082532197
Bond Position:  [2.94415074]


portfolio before change:  [3.0251429]
curr_Stock_Price:  102.77223172585204
curr_Factors:  [102.77223173  -0.9932337   -0.91609971]
mat_Sqrt:  [[15.22869966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00656955 0.01088285 0.46419132]
Stock Position:  0.006569548068128915
Bond Position:  [2.34997579]


portfolio before change:  [3.03503373]
curr_Stock_Price:  104.23307288280212
curr_Factors:  [104.23307288  -1.01502316  -0.94909364]
mat_Sqrt:  [[14.62178695  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01811487 -0.05922681  0.41893295]
Stock Position:  0.018114865865840202
Bond Position:  [1.1468656]


portfolio before change:  [3.01888897]
curr_Stock_Price:  103.33391479975072
curr_Factors:  [103.3339148   -0.79621313  -0.94559804]
mat_Sqrt:  [[18.10439024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00362715  0.00545226  0.10907717]
Stock Position:  -0.00362714685727378
Bond Position:  [3.39369626]


portfolio before change:  [3.02099305]
curr_Stock_Price:  102.87078677794383
curr_Factors:  [102.87078678  -1.12711083  -0.95103741]
mat_Sqrt:  [[12.87548949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01110382 0.00095399 0.31515898]
Stock Position:  0.01110382088710116
Bond Position:  [1.87873425]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.03157636]
Stock Price:  103.80275913843508
PL:  [-0.77118278]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-8.65016113e-03 -7.85357919e-02  1.16309855e-02]
 [-2.12138067e-01  6.30570915e-02 -2.47381632e-01]
 [-4.30669276e-02  4.75828431e-02  1.59499209e-02]
 [ 1.01181891e-01  5.72588136e-02  1.06712787e-01]
 [-2.63304514e-02  1.35322020e-01 -5.17763686e-02]
 [-1.30058175e-01 -1.62172535e-01  1.07076329e-01]
 [-5.99532427e-02 -1.88183458e-01  1.11758774e-01]
 [-2.22431907e-02  7.96918635e-01  1.55225424e-01]
 [ 1.83237798e-01 -1.81092729e-02  1.67095379e-01]
 [ 3.90595531e-01  1.48311637e-01  2.39254550e-01]
 [-1.72595628e-01 -1.74965735e-01  5.18914054e-02]
 [-6.45257962e-02 -1.89435751e-02  8.90135386e-02]
 [ 7.40213438e-03 -5.80847296e-02  1.27294109e-01]
 [ 5.24563191e-03  5.62928206e-02 -1.57984564e-01]
 [ 6.66442703e-02 -4.10135644e-02 -9.02170711e-02]
 [-4.85179968e-02 -4.60831540e-02  8.05620063e-02]
 [ 5.19051106e-02  1.61272269e-02 -3.04999870e-02]
 [-3.43724334e-02 -5.91397715e-02 -1.12075718e-02]
 [ 2.05193024e-02  7.41353497e-02 -1.80886597e-01]
 [-5.70853593e-02  9.65140900e-04 -3.84613251e-02]
 [-3.90700019e-02  5.03432373e-01 -4.66433161e-01]
 [ 3.97011762e-01  2.25409428e-01  5.77273610e-02]
 [-3.17971733e-03 -1.29489622e-02  5.72668169e-02]
 [-5.75038285e-02 -1.10189889e-01 -3.05083471e-02]
 [ 2.47350601e-02  2.41289962e-02 -1.12633093e-02]
 [-6.90642496e-02 -1.20733647e-02  1.93331977e-01]
 [-1.12898091e-02 -3.24291271e-02  2.24149927e-03]
 [-4.51543068e-02  2.01380736e-02 -2.62985701e-01]
 [-1.15373903e-02 -3.95104498e-02  5.89481663e-02]
 [-3.48921886e-02  2.26893237e-02 -1.63360390e-02]
 [ 2.79044146e-02 -1.30366729e-02  2.94986902e-02]
 [ 2.95450620e-02  9.76383551e-02 -6.03638415e-02]
 [-4.02970310e-02  2.37926394e-02 -1.38107662e-01]
 [ 3.03006095e-02 -4.52137100e-02  1.15372588e-01]
 [-6.46376566e-02  3.95495801e-02 -2.40417654e-02]
 [-1.13609905e-01 -1.41492403e-01 -1.02766129e-01]
 [-1.42797171e-02  1.01462729e-01  9.18755699e-02]
 [ 7.56537422e-02 -7.84513751e-02 -7.88748275e-02]
 [ 9.54254480e-02  5.24745900e-03  8.07848092e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.89039923]
curr_Stock_Price:  99.93655074538754
curr_Factors:  [99.93655075 -0.91040007 -1.01498432]
mat_Sqrt:  [[14.57271734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00153074 -0.02534732  0.03317996]
Stock Position:  -0.0015307404260180616
Bond Position:  [2.04337615]


portfolio before change:  [1.89137914]
curr_Stock_Price:  99.46327066481619
curr_Factors:  [99.46327066 -0.88670266 -1.0125095 ]
mat_Sqrt:  [[14.88830905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01677579  0.02035159 -0.70571094]
Stock Position:  -0.016775790668255335
Bond Position:  [3.55995415]


portfolio before change:  [1.88914461]
curr_Stock_Price:  99.62299787070313
curr_Factors:  [99.62299787 -0.82654719 -1.00551664]
mat_Sqrt:  [[15.94793257  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188729  0.0153573   0.04550068]
Stock Position:  -0.0018872889189672497
Bond Position:  [2.07716199]


portfolio before change:  [1.88887009]
curr_Stock_Price:  99.90603938251155
curr_Factors:  [99.90603938 -0.8128088  -0.98092682]
mat_Sqrt:  [[16.61813427  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00810274 0.0184802  0.30442188]
Stock Position:  0.008102741935541839
Bond Position:  [1.07935724]


portfolio before change:  [1.88322302]
curr_Stock_Price:  99.19245389799484
curr_Factors:  [99.1924539  -1.11085205 -0.98916239]
mat_Sqrt:  [[12.14657821  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00076373  0.04367499 -0.14770357]
Stock Position:  -0.0007637349802893993
Bond Position:  [1.95897977]


portfolio before change:  [1.88251599]
curr_Stock_Price:  100.43884806905008
curr_Factors:  [100.43884807  -1.2777707   -0.99496421]
mat_Sqrt:  [[10.34821624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01365498 -0.05234096  0.30545896]
Stock Position:  -0.013654975661526568
Bond Position:  [3.25400602]


portfolio before change:  [1.89006922]
curr_Stock_Price:  99.91548941267993
curr_Factors:  [99.91548941 -1.08528861 -1.00117174]
mat_Sqrt:  [[12.40208207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00609199 -0.06073595  0.31881667]
Stock Position:  -0.006091990489689657
Bond Position:  [2.49875343]


portfolio before change:  [1.89866849]
curr_Stock_Price:  98.55519404021264
curr_Factors:  [98.55519404 -0.74768522 -1.00546118]
mat_Sqrt:  [[17.07252316  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01008125 0.25720438 0.44281493]
Stock Position:  0.01008125160557547
Bond Position:  [0.90510878]


portfolio before change:  [1.90244123]
curr_Stock_Price:  98.91820434338493
curr_Factors:  [98.91820434 -0.75495996 -0.99944889]
mat_Sqrt:  [[17.1137877   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01248405 -0.00584474  0.47667661]
Stock Position:  0.012484054585248112
Bond Position:  [0.66754097]


portfolio before change:  [1.91425658]
curr_Stock_Price:  99.85795498272732
curr_Factors:  [99.85795498 -0.87406333 -1.0208472 ]
mat_Sqrt:  [[15.0118246   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03128914 0.04786738 0.68252663]
Stock Position:  0.03128914441849271
Bond Position:  [-1.2102134]


portfolio before change:  [1.95920575]
curr_Stock_Price:  101.29936412082594
curr_Factors:  [101.29936412  -0.82503693  -1.03568546]
mat_Sqrt:  [[15.75815075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01254704 -0.05646995  0.14803174]
Stock Position:  -0.012547035082499472
Bond Position:  [3.23021243]


portfolio before change:  [1.96641466]
curr_Stock_Price:  100.75699657095154
curr_Factors:  [100.75699657  -0.66176399  -1.01759728]
mat_Sqrt:  [[18.79048012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267278 -0.00611401  0.25393085]
Stock Position:  -0.0026727802845571587
Bond Position:  [2.23571597]


portfolio before change:  [1.96528727]
curr_Stock_Price:  101.2833652724455
curr_Factors:  [101.28336527  -0.5475433   -0.99722805]
mat_Sqrt:  [[21.60988458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099628 -0.01874677  0.36313466]
Stock Position:  0.0009962774098375181
Bond Position:  [1.86438094]


portfolio before change:  [1.96620175]
curr_Stock_Price:  101.96732931542677
curr_Factors:  [101.96732932  -0.70025055  -1.01685565]
mat_Sqrt:  [[18.31181099  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084711  0.01816843 -0.45068599]
Stock Position:  -0.0008471094548558345
Bond Position:  [2.05257924]


portfolio before change:  [1.96782211]
curr_Stock_Price:  100.35741868688477
curr_Factors:  [100.35741869  -0.49420938  -1.00980186]
mat_Sqrt:  [[22.30312419  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00178706 -0.01323707 -0.25736419]
Stock Position:  0.0017870558695727453
Bond Position:  [1.7884778]


portfolio before change:  [1.967729]
curr_Stock_Price:  100.18020739132605
curr_Factors:  [100.18020739  -0.45195609  -1.02308413]
mat_Sqrt:  [[22.91817855  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180992 -0.01487327  0.22982098]
Stock Position:  -0.0018099182898176326
Bond Position:  [2.14904699]


portfolio before change:  [1.96844577]
curr_Stock_Price:  99.9326125147135
curr_Factors:  [99.93261251 -0.50128661 -1.00527444]
mat_Sqrt:  [[22.15216054  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00221068  0.00520504 -0.08700797]
Stock Position:  0.002210677517264659
Bond Position:  [1.74752699]


portfolio before change:  [1.96542086]
curr_Stock_Price:  98.46547707333664
curr_Factors:  [98.46547707 -0.66806819 -0.98924372]
mat_Sqrt:  [[18.77251987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259592 -0.01908728 -0.03197208]
Stock Position:  -0.00259592346213212
Bond Position:  [2.22102971]


portfolio before change:  [1.96754643]
curr_Stock_Price:  97.75362317500837
curr_Factors:  [97.75362318 -0.85229567 -0.99542583]
mat_Sqrt:  [[15.40556426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.25159534e-05  2.39270812e-02 -5.16019113e-01]
Stock Position:  -8.251595341427402e-05
Bond Position:  [1.97561266]


portfolio before change:  [1.96783569]
curr_Stock_Price:  97.24106586017963
curr_Factors:  [97.24106586 -0.53696896 -0.99666485]
mat_Sqrt:  [[20.97978393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308579  0.0003115  -0.10971946]
Stock Position:  -0.003085791353309202
Bond Position:  [2.26790133]


portfolio before change:  [1.9640346]
curr_Stock_Price:  98.56474310674973
curr_Factors:  [98.56474311 -0.58341957 -1.00585601]
mat_Sqrt:  [[20.11444162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00156691  0.1624821  -1.33060398]
Stock Position:  -0.001566912468952493
Bond Position:  [2.11847693]


portfolio before change:  [1.96420128]
curr_Stock_Price:  98.62738371198944
curr_Factors:  [98.62738371 -0.56702981 -0.99582298]
mat_Sqrt:  [[20.66613062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02200735 0.07275058 0.16468009]
Stock Position:  0.022007352272407642
Bond Position:  [-0.2063263]


portfolio before change:  [1.9859189]
curr_Stock_Price:  99.61539037639577
curr_Factors:  [99.61539038 -0.41175776 -0.98585986]
mat_Sqrt:  [[24.62344549  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00023825 -0.00417926  0.16336629]
Stock Position:  0.0002382536956361463
Bond Position:  [1.96218516]


portfolio before change:  [1.98628325]
curr_Stock_Price:  100.11511332279944
curr_Factors:  [100.11511332  -0.36195956  -0.9845245 ]
mat_Sqrt:  [[26.04528078  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331053 -0.03556363 -0.08703182]
Stock Position:  -0.0033105320087820126
Bond Position:  [2.31771753]


portfolio before change:  [1.98785006]
curr_Stock_Price:  99.72935076416537
curr_Factors:  [99.72935076 -0.23241739 -0.96632111]
mat_Sqrt:  [[30.07582002  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090974  0.0077876  -0.03213109]
Stock Position:  0.0009097426918368178
Bond Position:  [1.89712201]


portfolio before change:  [1.98888117]
curr_Stock_Price:  100.60208058616139
curr_Factors:  [100.60208059  -0.24253161  -0.98733678]
mat_Sqrt:  [[29.40911186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109031 -0.00389666  0.55152232]
Stock Position:  -0.0010903080113228358
Bond Position:  [2.09856843]


portfolio before change:  [1.98967791]
curr_Stock_Price:  100.11194549970851
curr_Factors:  [100.1119455   -0.1683406   -1.02503864]
mat_Sqrt:  [[30.35343734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057495 -0.01046646  0.00639437]
Stock Position:  -0.0005749540874271869
Bond Position:  [2.04723768]


portfolio before change:  [1.99038959]
curr_Stock_Price:  99.31925971889828
curr_Factors:  [99.31925972 -0.1200594  -1.01654944]
mat_Sqrt:  [[31.872089    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297205  0.00649954 -0.750225  ]
Stock Position:  -0.00297204777419368
Bond Position:  [2.28557117]


portfolio before change:  [1.98908853]
curr_Stock_Price:  99.85315747190472
curr_Factors:  [ 9.98531575e+01 -8.85514109e-02 -1.02763252e+00]
mat_Sqrt:  [[32.70463305  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00023146 -0.01275194  0.16816271]
Stock Position:  -0.0002314559849030393
Bond Position:  [2.01220014]


portfolio before change:  [1.98972095]
curr_Stock_Price:  98.2075660365626
curr_Factors:  [ 9.82075660e+01 -8.28651134e-02 -1.02657102e+00]
mat_Sqrt:  [[32.38343827  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103742  0.00732295 -0.04660217]
Stock Position:  -0.0010374231895773525
Bond Position:  [2.09160376]


portfolio before change:  [1.98893522]
curr_Stock_Price:  99.21698824318945
curr_Factors:  [99.21698824 -0.2314464  -1.01611338]
mat_Sqrt:  [[28.49559369  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00109718 -0.00420757  0.08415155]
Stock Position:  0.001097176991605204
Bond Position:  [1.88007663]


portfolio before change:  [1.98889556]
curr_Stock_Price:  98.966633874147
curr_Factors:  [98.96663387 -0.39510735 -1.01519343]
mat_Sqrt:  [[24.15477263  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00153815  0.03151264 -0.17220124]
Stock Position:  0.0015381511032095264
Bond Position:  [1.83666993]


portfolio before change:  [1.98959982]
curr_Stock_Price:  99.27522570718213
curr_Factors:  [99.27522571 -0.45015251 -0.99123473]
mat_Sqrt:  [[23.48845006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270905  0.00767904 -0.39398272]
Stock Position:  -0.0027090543258710257
Bond Position:  [2.2585418]


portfolio before change:  [1.99221636]
curr_Stock_Price:  98.41359516313425
curr_Factors:  [98.41359516 -0.32087602 -0.95503676]
mat_Sqrt:  [[27.47471634  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0016241  -0.01459266  0.32912588]
Stock Position:  0.0016241015905575841
Bond Position:  [1.83238269]


portfolio before change:  [1.99036407]
curr_Stock_Price:  97.13205127196878
curr_Factors:  [97.13205127 -0.48312027 -0.93648031]
mat_Sqrt:  [[23.48755774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261722  0.01276457 -0.06858446]
Stock Position:  -0.0026172213321382864
Bond Position:  [2.24458014]


portfolio before change:  [1.99289974]
curr_Stock_Price:  96.27041727121201
curr_Factors:  [96.27041727 -0.36909399 -0.94663926]
mat_Sqrt:  [[25.82719031  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00632934 -0.04566648 -0.29316316]
Stock Position:  -0.0063293361586017165
Bond Position:  [2.60222758]


portfolio before change:  [1.98563813]
curr_Stock_Price:  97.46910768330757
curr_Factors:  [97.46910768 -0.4732323  -0.91807   ]
mat_Sqrt:  [[24.2455522   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00103876 0.03274696 0.26209543]
Stock Position:  0.0010387595082294615
Bond Position:  [1.88439117]


portfolio before change:  [1.98627472]
curr_Stock_Price:  97.85517352241583
curr_Factors:  [97.85517352 -0.71508646 -0.93566935]
mat_Sqrt:  [[18.77887856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00231854 -0.02532007 -0.22500793]
Stock Position:  0.002318544497389745
Bond Position:  [1.75939315]


portfolio before change:  [1.98962667]
curr_Stock_Price:  99.20602736090237
curr_Factors:  [99.20602736 -0.80589069 -0.94093677]
mat_Sqrt:  [[17.29420227  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00653321 0.00169361 0.23045657]
Stock Position:  0.006533213241505135
Bond Position:  [1.34149254]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.99290054]
Stock Price:  99.68146994520899
PL:  [1.99290054]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.03426582e-02  3.00947654e-02 -5.79053056e-03]
 [-3.18453837e-01  4.04600468e-02 -3.32470908e-01]
 [-2.13969048e-02  5.68929285e-02  3.41680690e-02]
 [ 8.79898277e-02  8.01144253e-02  7.61141359e-02]
 [-1.49928881e-01  2.54986572e-01 -3.24811536e-02]
 [-5.85814562e-02 -1.42699450e-01  2.06757036e-01]
 [-6.53333128e-02 -1.38576729e-01 -5.18201530e-03]
 [ 1.25238736e-02  7.51504100e-01  1.12188730e-01]
 [ 5.25684704e-03  5.31787226e-02 -1.38939904e-02]
 [ 2.08320652e-01  7.22800193e-02  8.52927113e-02]
 [-6.45328432e-02 -1.50256574e-01  3.63431132e-02]
 [-2.04764481e-02 -1.74195556e-02  9.44741255e-02]
 [ 5.59407615e-03 -3.61878791e-02  1.16835813e-01]
 [ 1.16442734e-02 -1.60297161e-01  4.54532145e-02]
 [-4.80884701e-02  1.14013201e-01 -3.59725951e-02]
 [ 1.38308105e-01  6.95266776e-03 -3.74956874e-02]
 [ 4.55982105e-02  2.74465492e-02  6.38759315e-03]
 [-5.28796305e-02 -6.30414176e-02  5.54689951e-03]
 [ 4.31874138e-02  1.94569436e-02 -1.76852242e-01]
 [-5.27098808e-03 -3.47836836e-03 -3.60293054e-02]
 [-2.80344420e-02  4.20011181e-01 -3.77273579e-01]
 [ 1.78923102e-01  1.21054740e-01  9.32415623e-02]
 [-5.82388293e-03 -4.68446371e-03  5.22028785e-02]
 [ 2.29588436e-03 -1.09420224e-01 -1.45300148e-01]
 [ 3.19256932e-02  1.89335603e-02 -1.20880426e-02]
 [-5.43237270e-02 -3.89433942e-03  1.61586784e-01]
 [-1.02016530e-02 -3.24797550e-02  1.94499565e-03]
 [-4.38435156e-02  1.76560122e-02 -2.67422992e-01]
 [-3.92772028e-02 -4.24849618e-02  3.33367480e-02]
 [-6.41355580e-02 -1.41744350e-02  3.79111574e-02]
 [-1.25972948e-02 -4.81579339e-02 -2.79306319e-02]
 [ 2.65427055e-02 -7.19914772e-02 -1.45810231e-01]
 [ 2.32472976e-02  6.97691963e-04  1.54657583e-01]
 [-2.05330221e-03 -9.53010767e-02 -1.86466366e-01]
 [ 3.15280958e-02  1.77790067e-01 -1.65385133e-02]
 [ 4.60709768e-03  1.72402066e-02  8.23617598e-02]
 [ 4.33048032e-01 -2.59345305e-01  2.92471326e-01]
 [-1.18929037e-01  5.25807934e-02  5.53640834e-02]
 [ 4.96442119e-01 -7.41164019e-02  2.97672044e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.6400305]
curr_Stock_Price:  98.98717105692974
curr_Factors:  [98.98717106 -1.05126385 -0.97731914]
mat_Sqrt:  [[13.01896661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041336  0.00971304 -0.01651877]
Stock Position:  -0.0004133643803304575
Bond Position:  [-5.59911273]


portfolio before change:  [-5.64030931]
curr_Stock_Price:  97.96841545473879
curr_Factors:  [97.96841545 -1.20516572 -0.99206338]
mat_Sqrt:  [[10.88533024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03473117  0.01305842 -0.94844696]
Stock Position:  -0.034731174513096714
Bond Position:  [-2.23775118]


portfolio before change:  [-5.66584918]
curr_Stock_Price:  98.69571978772974
curr_Factors:  [98.69571979 -1.06555875 -1.03123837]
mat_Sqrt:  [[12.12469718  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00023169  0.01836211  0.09747199]
Stock Position:  -0.00023168880031620127
Bond Position:  [-5.64298249]


portfolio before change:  [-5.66660056]
curr_Stock_Price:  98.89407696668754
curr_Factors:  [98.89407697 -0.93666658 -1.01143064]
mat_Sqrt:  [[14.09686067  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00850401 0.02585682 0.21713244]
Stock Position:  0.00850401035981994
Bond Position:  [-6.50759681]


portfolio before change:  [-5.67605719]
curr_Stock_Price:  97.87771750760957
curr_Factors:  [97.87771751 -1.13950566 -1.00086472]
mat_Sqrt:  [[11.51152306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00907874  0.08229656 -0.09265969]
Stock Position:  -0.009078742392790941
Bond Position:  [-4.7874506]


portfolio before change:  [-5.68052661]
curr_Stock_Price:  98.30409332402859
curr_Factors:  [98.30409332 -1.21241786 -1.00854173]
mat_Sqrt:  [[10.6664796   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00426624 -0.04605605  0.58982027]
Stock Position:  -0.004266239449161683
Bond Position:  [-5.26113781]


portfolio before change:  [-5.67921388]
curr_Stock_Price:  97.84223196125654
curr_Factors:  [97.84223196 -1.08088659 -1.00318809]
mat_Sqrt:  [[12.17374544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00777722 -0.04472545 -0.01478285]
Stock Position:  -0.007777223863330228
Bond Position:  [-4.91827294]


portfolio before change:  [-5.68368171]
curr_Stock_Price:  98.33765290955535
curr_Factors:  [98.33765291 -1.19401587 -1.01809782]
mat_Sqrt:  [[10.76492654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01754071 0.24254691 0.32004322]
Stock Position:  0.01754070811037847
Bond Position:  [-7.40859377]


portfolio before change:  [-5.6664343]
curr_Stock_Price:  99.37373059530547
curr_Factors:  [99.3737306  -1.56007731 -1.0542559 ]
mat_Sqrt:  [[ 7.27580595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00182465  0.01716336 -0.03963569]
Stock Position:  0.0018246513875075133
Bond Position:  [-5.84775672]


portfolio before change:  [-5.66799731]
curr_Stock_Price:  98.9177583191412
curr_Factors:  [98.91775832 -1.49190806 -1.06150809]
mat_Sqrt:  [[ 7.69732319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03124269 0.02332828 0.24331636]
Stock Position:  0.03124268590531033
Bond Position:  [-8.75845376]


portfolio before change:  [-5.67110985]
curr_Stock_Price:  98.8531780043385
curr_Factors:  [98.853178   -1.1472952  -1.07230195]
mat_Sqrt:  [[10.74068161  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00817316 -0.0484951   0.10367679]
Stock Position:  -0.00817316200618123
Bond Position:  [-4.86316681]


portfolio before change:  [-5.66954211]
curr_Stock_Price:  98.58698076894761
curr_Factors:  [98.58698077 -1.09290232 -1.08296306]
mat_Sqrt:  [[11.19059662  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042426 -0.00562214  0.26950838]
Stock Position:  -0.0004242624485064556
Bond Position:  [-5.62771535]


portfolio before change:  [-5.67033402]
curr_Stock_Price:  98.79536243585892
curr_Factors:  [98.79536244 -1.01237735 -1.09187366]
mat_Sqrt:  [[12.04680714  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00183088 -0.01167959  0.33330005]
Stock Position:  0.0018308807023248734
Bond Position:  [-5.85121655]


portfolio before change:  [-5.67122959]
curr_Stock_Price:  98.7057238520883
curr_Factors:  [98.70572385 -1.08986271 -1.08330465]
mat_Sqrt:  [[11.2343447   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105019 -0.05173569  0.12966537]
Stock Position:  -0.001050185783384372
Bond Position:  [-5.56757024]


portfolio before change:  [-5.67184572]
curr_Stock_Price:  98.62967930352092
curr_Factors:  [98.6296793  -0.9987094  -1.06037885]
mat_Sqrt:  [[12.58221087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00255587  0.0367976  -0.1026198 ]
Stock Position:  -0.0025558702325836455
Bond Position:  [-5.41976106]


portfolio before change:  [-5.67275221]
curr_Stock_Price:  98.71927066948255
curr_Factors:  [98.71927067 -0.94542846 -1.04790254]
mat_Sqrt:  [[13.44959736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00981989  0.00224396 -0.10696476]
Stock Position:  0.009819887817139843
Bond Position:  [-6.64216438]


portfolio before change:  [-5.67622157]
curr_Stock_Price:  98.45052666435967
curr_Factors:  [98.45052666 -1.11360637 -1.01085246]
mat_Sqrt:  [[11.76460347  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00446293 0.00885834 0.01822203]
Stock Position:  0.0044629278050659785
Bond Position:  [-6.11559917]


portfolio before change:  [-5.6736506]
curr_Stock_Price:  99.19789936059723
curr_Factors:  [99.19789936 -1.29648689 -1.01148891]
mat_Sqrt:  [[ 9.8664591   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00654902 -0.02034653  0.01582376]
Stock Position:  -0.00654902120126999
Bond Position:  [-5.02400145]


portfolio before change:  [-5.67245848]
curr_Stock_Price:  98.91997021030411
curr_Factors:  [98.91997021 -1.04327029 -0.99877518]
mat_Sqrt:  [[12.83615328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00086157  0.0062797  -0.50451022]
Stock Position:  0.0008615690974383755
Bond Position:  [-5.75768487]


portfolio before change:  [-5.67360876]
curr_Stock_Price:  98.42026669738163
curr_Factors:  [98.4202667  -1.06777007 -1.01461898]
mat_Sqrt:  [[12.26632485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108716 -0.00112264 -0.10278158]
Stock Position:  -0.001087160039873788
Bond Position:  [-5.56661018]


portfolio before change:  [-5.67468307]
curr_Stock_Price:  98.76836277199769
curr_Factors:  [98.76836277 -1.05286463 -0.99813119]
mat_Sqrt:  [[12.70228016  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152025  0.13555803 -1.07625651]
Stock Position:  -0.001520251889778663
Bond Position:  [-5.52453028]


portfolio before change:  [-5.6748047]
curr_Stock_Price:  98.39410016831684
curr_Factors:  [98.39410017 -1.02792857 -0.97774635]
mat_Sqrt:  [[13.24083909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01681662 0.03907025 0.26599222]
Stock Position:  0.016816619423445426
Bond Position:  [-7.32946084]


portfolio before change:  [-5.65078054]
curr_Stock_Price:  99.8771805335931
curr_Factors:  [99.87718053 -0.90592028 -0.99897895]
mat_Sqrt:  [[14.86548392  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00026072 -0.0015119   0.14892028]
Stock Position:  0.00026072295254548575
Bond Position:  [-5.67682082]


portfolio before change:  [-5.65136997]
curr_Stock_Price:  100.338289406515
curr_Factors:  [100.33828941  -0.85272457  -0.99672004]
mat_Sqrt:  [[15.78567312  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00314834 -0.03531523 -0.41450088]
Stock Position:  -0.0031483417506026337
Bond Position:  [-5.33547074]


portfolio before change:  [-5.6506559]
curr_Stock_Price:  99.89963083607682
curr_Factors:  [99.89963084 -0.67396807 -0.97197843]
mat_Sqrt:  [[19.26364211  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00172984  0.00611078 -0.03448382]
Stock Position:  0.0017298405170765151
Bond Position:  [-5.82346633]


portfolio before change:  [-5.64893853]
curr_Stock_Price:  101.31325360875023
curr_Factors:  [101.31325361  -0.57894781  -0.97190436]
mat_Sqrt:  [[21.48521587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103024 -0.00125689  0.46096212]
Stock Position:  -0.0010302382636499182
Bond Position:  [-5.54456174]


portfolio before change:  [-5.64850932]
curr_Stock_Price:  100.2238649934658
curr_Factors:  [100.22386499  -0.37813402  -0.98432425]
mat_Sqrt:  [[25.6603774   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064046 -0.0104828   0.00554853]
Stock Position:  -0.0006404634813522389
Bond Position:  [-5.58431959]


portfolio before change:  [-5.64867175]
curr_Stock_Price:  99.38750736466801
curr_Factors:  [99.38750736 -0.18960617 -0.98506365]
mat_Sqrt:  [[30.70288439  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308854  0.00569845 -0.76288336]
Stock Position:  -0.003088536751515427
Bond Position:  [-5.34170978]


portfolio before change:  [-5.65730286]
curr_Stock_Price:  101.96586650525937
curr_Factors:  [ 1.01965867e+02  1.01749876e-02 -9.85018315e-01]
mat_Sqrt:  [[38.46677138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106961 -0.01371196  0.09510046]
Stock Position:  -0.0010696134009296984
Bond Position:  [-5.5482388]


portfolio before change:  [-5.65975132]
curr_Stock_Price:  103.6065466069037
curr_Factors:  [103.60654661  -0.46246537  -0.98700182]
mat_Sqrt:  [[24.31596993  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243833 -0.00457478  0.10814998]
Stock Position:  -0.0024383283903332015
Bond Position:  [-5.40712454]


portfolio before change:  [-5.66428531]
curr_Stock_Price:  105.1888004177212
curr_Factors:  [105.18880042  -0.82282906  -1.00851789]
mat_Sqrt:  [[16.85099793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166927 -0.01554291 -0.07967832]
Stock Position:  -0.0016692666110799444
Bond Position:  [-5.48869716]


portfolio before change:  [-5.665887]
curr_Stock_Price:  105.73728043519756
curr_Factors:  [105.73728044  -0.93811231  -1.01499281]
mat_Sqrt:  [[14.99703347  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00119463 -0.02323515 -0.415956  ]
Stock Position:  -0.0011946284002684743
Bond Position:  [-5.53957024]


portfolio before change:  [-5.66665955]
curr_Stock_Price:  105.80429667757174
curr_Factors:  [105.80429668  -0.76076389  -1.02256204]
mat_Sqrt:  [[17.78339581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.09047051e-03 2.25179113e-04 4.41195036e-01]
Stock Position:  0.0030904705078186453
Bond Position:  [-5.99364461]


portfolio before change:  [-5.66872396]
curr_Stock_Price:  105.37874419323491
curr_Factors:  [105.37874419  -0.54774869  -1.02282382]
mat_Sqrt:  [[21.91099234  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00271867 -0.03075829 -0.53193664]
Stock Position:  -0.002718673792268591
Bond Position:  [-5.38223353]


portfolio before change:  [-5.66862893]
curr_Stock_Price:  105.09630800071852
curr_Factors:  [105.096308    -0.4298697   -1.03435801]
mat_Sqrt:  [[24.30420652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00265153  0.0573815  -0.04717977]
Stock Position:  0.0026515340612911983
Bond Position:  [-5.94729537]


portfolio before change:  [-5.66860186]
curr_Stock_Price:  105.3869058601652
curr_Factors:  [105.38690586  -0.57088902  -1.0216594 ]
mat_Sqrt:  [[21.4363907   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00116336 0.00556425 0.23495518]
Stock Position:  0.0011633611402188232
Bond Position:  [-5.79120489]


portfolio before change:  [-5.6674954]
curr_Stock_Price:  106.9602835802968
curr_Factors:  [106.96028358  -0.50369791  -1.02581675]
mat_Sqrt:  [[23.17195981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01898026 -0.08370334  0.83433929]
Stock Position:  0.018980261316723795
Bond Position:  [-7.69762953]


portfolio before change:  [-5.67890394]
curr_Stock_Price:  106.40990784318019
curr_Factors:  [106.40990784  -0.3713588   -1.03625838]
mat_Sqrt:  [[26.04124209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00372082  0.01697038  0.15793832]
Stock Position:  -0.0037208240977801904
Bond Position:  [-5.28297139]


portfolio before change:  [-5.6932053]
curr_Stock_Price:  110.07601874554643
curr_Factors:  [110.07601875  -0.33062952  -1.06465176]
mat_Sqrt:  [[27.27280176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01767038 -0.02392097  0.00849175]
Stock Position:  0.01767038080551286
Bond Position:  [-7.63829047]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.6807301]
Stock Price:  110.83605026160362
PL:  [-16.51678036]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-4.32385554e-02  4.41829376e-02 -7.21393849e-03]
 [-1.96467310e-01  3.18999083e-02 -4.82679104e-02]
 [-4.53377783e-02  5.04753961e-02  1.49498349e-02]
 [ 8.16763000e-02  8.46454961e-02  6.69151358e-02]
 [ 1.54390971e-02  7.67732828e-02 -6.52084669e-02]
 [-7.50547440e-02 -1.54066045e-01  1.44965650e-01]
 [-6.08688599e-02 -1.76660955e-01  9.58313282e-02]
 [ 1.61490176e-02  7.24153050e-01  9.69266379e-02]
 [ 9.42673463e-02  1.89858922e-02  7.95419355e-02]
 [ 2.58839977e-01  9.33529509e-02  1.27964791e-01]
 [-1.55744047e-01 -2.49023755e-01 -3.26259069e-03]
 [ 9.14862137e-02 -8.92351188e-03  1.33852913e-01]
 [ 8.35351635e-03 -1.60782118e-02 -5.53418891e-03]
 [ 1.34141684e-02 -1.72534974e-01 -2.36361739e-02]
 [ 2.76612428e-02 -3.72700695e-02 -7.31558987e-02]
 [ 1.72752050e-01  1.67434899e-02 -6.39732235e-02]
 [ 4.55127263e-02  2.75999723e-02  6.88757064e-03]
 [-4.64356290e-02 -6.16829076e-02 -2.86822211e-04]
 [ 5.60739214e-02 -1.31709422e-02 -1.17509875e-01]
 [ 4.06798226e-02 -9.33514501e-03  1.20489733e-01]
 [-1.77800840e-02  3.60532308e-01 -3.29454092e-01]
 [ 7.54409012e-02  6.77553324e-02  1.14405316e-01]
 [-1.50827654e-02  2.25218419e-02  3.55150306e-02]
 [ 7.72179492e-02 -1.35777921e-01 -2.53028279e-01]
 [ 6.30201779e-02  3.43178580e-02 -1.50334883e-02]
 [-3.77288656e-02  8.19543212e-03  9.65959923e-02]
 [-3.50162349e-03 -3.26678775e-02  2.33699582e-03]
 [-6.73796054e-02  4.36168275e-02 -2.56230086e-01]
 [-5.76200059e-02 -3.09277747e-02 -8.11144505e-03]
 [-4.57827671e-02  1.06186140e-02  1.34710535e-03]
 [ 2.30467919e-02 -4.39769389e-02 -7.68398503e-02]
 [-4.16866529e-03  4.78865285e-02 -7.87903059e-02]
 [ 3.67691248e-02  1.85183362e-02  7.23601162e-02]
 [ 4.05418359e-02 -3.22616019e-02  1.79766268e-01]
 [-7.25994948e-02 -1.71987688e-02 -2.25464452e-02]
 [ 5.66916099e-03 -7.32278952e-02  2.85355725e-02]
 [-4.32341655e-02  9.97951763e-02  5.49322670e-02]
 [ 6.79470177e-02 -7.37875650e-02 -6.35220672e-02]
 [ 9.80536643e-02  3.61921265e-03  6.52262911e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.19022743]
curr_Stock_Price:  99.04387882892732
curr_Factors:  [99.04387883 -0.93502048 -0.98489532]
mat_Sqrt:  [[14.52174486  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00245785  0.01425998 -0.02057936]
Stock Position:  -0.002457851338866257
Bond Position:  [-4.9467923]


portfolio before change:  [-5.18969131]
curr_Stock_Price:  98.5741554042021
curr_Factors:  [98.5741554  -0.95144398 -0.97463825]
mat_Sqrt:  [[14.36402593  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01391034  0.01029565 -0.13769491]
Stock Position:  -0.01391033515256412
Bond Position:  [-3.81849177]


portfolio before change:  [-5.20118248]
curr_Stock_Price:  99.36592839815295
curr_Factors:  [99.3659284  -0.6823619  -0.97010733]
mat_Sqrt:  [[19.03615476  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168011  0.01629086  0.04264772]
Stock Position:  -0.001680113938768442
Bond Position:  [-5.0342364]


portfolio before change:  [-5.20112829]
curr_Stock_Price:  98.95910534177375
curr_Factors:  [98.95910534 -0.73322985 -0.9782059 ]
mat_Sqrt:  [[17.87263795  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00630089 0.02731922 0.19089026]
Stock Position:  0.006300887687499519
Bond Position:  [-5.8246585]


portfolio before change:  [-5.19757315]
curr_Stock_Price:  99.63889380956392
curr_Factors:  [99.63889381 -0.95982056 -0.96631987]
mat_Sqrt:  [[14.51833238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00122602  0.02477847 -0.18602161]
Stock Position:  0.001226019267210368
Bond Position:  [-5.31973235]


portfolio before change:  [-5.1983909]
curr_Stock_Price:  99.51430640767215
curr_Factors:  [99.51430641 -1.11697521 -0.96056017]
mat_Sqrt:  [[12.46302215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00617124 -0.0497246   0.41354665]
Stock Position:  -0.006171244303361932
Bond Position:  [-4.5842638]


portfolio before change:  [-5.19982467]
curr_Stock_Price:  99.65377613873716
curr_Factors:  [99.65377614 -1.00309502 -0.96658044]
mat_Sqrt:  [[13.90191326  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00556529 -0.05701708  0.2733801 ]
Stock Position:  -0.005565287094191072
Bond Position:  [-4.6452228]


portfolio before change:  [-5.19672698]
curr_Stock_Price:  98.99282585574935
curr_Factors:  [98.99282586 -1.06679513 -0.94555397]
mat_Sqrt:  [[13.2327958   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01388605 0.23371939 0.27650472]
Stock Position:  0.013886045685594138
Bond Position:  [-6.57134588]


portfolio before change:  [-5.19373262]
curr_Stock_Price:  99.2676219564756
curr_Factors:  [99.26762196 -1.09362985 -0.93432222]
mat_Sqrt:  [[13.06409175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00875524 0.00612767 0.226911  ]
Stock Position:  0.00875523971444008
Bond Position:  [-6.06284445]


portfolio before change:  [-5.19785907]
curr_Stock_Price:  98.88287584902585
curr_Factors:  [98.88287585 -1.29406167 -0.94288797]
mat_Sqrt:  [[10.55908299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02879192 0.03012954 0.36504793]
Stock Position:  0.028791919943772986
Bond Position:  [-8.04488691]


portfolio before change:  [-5.16772178]
curr_Stock_Price:  99.96453222908356
curr_Factors:  [99.96453223 -1.4270859  -0.93980019]
mat_Sqrt:  [[ 9.37390121  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02210838 -0.08037207 -0.00930726]
Stock Position:  -0.02210838127651136
Bond Position:  [-2.95766779]


portfolio before change:  [-5.17641896]
curr_Stock_Price:  100.34119715184201
curr_Factors:  [100.34119715  -1.59285039  -0.92982462]
mat_Sqrt:  [[ 8.05184565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01452926 -0.00288005  0.3818451 ]
Stock Position:  0.014529255291899657
Bond Position:  [-6.63430183]


portfolio before change:  [-5.17652009]
curr_Stock_Price:  100.39131714792144
curr_Factors:  [100.39131715  -1.62179599  -0.9361324 ]
mat_Sqrt:  [[ 7.7768186   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00050688 -0.00518922 -0.0157875 ]
Stock Position:  0.0005068786782833095
Bond Position:  [-5.22740631]


portfolio before change:  [-5.17739329]
curr_Stock_Price:  99.9578230446421
curr_Factors:  [99.95782304 -1.38060445 -0.93550805]
mat_Sqrt:  [[ 9.86147574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270032 -0.05568542 -0.06742743]
Stock Position:  -0.0027003158739475988
Bond Position:  [-4.90747559]


portfolio before change:  [-5.17799684]
curr_Stock_Price:  99.95414648330045
curr_Factors:  [99.95414648 -1.21345337 -0.92499631]
mat_Sqrt:  [[11.77833547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00043475 -0.01202886 -0.20869342]
Stock Position:  0.0004347504306608306
Bond Position:  [-5.22145194]


portfolio before change:  [-5.17898093]
curr_Stock_Price:  99.19192990085769
curr_Factors:  [99.1919299  -1.34986093 -0.91228711]
mat_Sqrt:  [[10.32851602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01579233  0.00540394 -0.1824978 ]
Stock Position:  0.01579232884262725
Bond Position:  [-6.74545251]


portfolio before change:  [-5.17353469]
curr_Stock_Price:  99.59019112224229
curr_Factors:  [99.59019112 -1.21285608 -0.92146121]
mat_Sqrt:  [[11.78404374  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00445963 0.00890785 0.01964832]
Stock Position:  0.0044596292809112315
Bond Position:  [-5.61767003]


portfolio before change:  [-5.17773443]
curr_Stock_Price:  98.80593700403294
curr_Factors:  [98.805937   -1.23619708 -0.95116892]
mat_Sqrt:  [[11.08720448  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00532913 -0.01990807 -0.00081822]
Stock Position:  -0.0053291293831971755
Bond Position:  [-4.65118481]


portfolio before change:  [-5.18341461]
curr_Stock_Price:  99.76270614461241
curr_Factors:  [99.76270614 -1.32384357 -0.94679931]
mat_Sqrt:  [[10.30007883  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00285423 -0.0042509  -0.33522296]
Stock Position:  0.0028542316821120895
Bond Position:  [-5.46816049]


portfolio before change:  [-5.18271295]
curr_Stock_Price:  100.24802999488222
curr_Factors:  [100.24802999  -1.54855267  -0.93021225]
mat_Sqrt:  [[ 8.40546835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00753904 -0.00301291  0.34372367]
Stock Position:  0.007539039506693616
Bond Position:  [-5.9384868]


portfolio before change:  [-5.17869538]
curr_Stock_Price:  100.87939948065434
curr_Factors:  [100.87939948  -1.59934055  -0.92709816]
mat_Sqrt:  [[ 8.06462348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00141808  0.1163613  -0.93984082]
Stock Position:  -0.0014180785559500361
Bond Position:  [-5.03564047]


portfolio before change:  [-5.17870222]
curr_Stock_Price:  100.4403131306944
curr_Factors:  [100.44031313  -1.53813347  -0.95804921]
mat_Sqrt:  [[ 8.27617554  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01360825 0.02186794 0.32636652]
Stock Position:  0.013608252666929955
Bond Position:  [-6.54551938]


portfolio before change:  [-5.17531524]
curr_Stock_Price:  100.74933296780291
curr_Factors:  [100.74933297  -1.66624365  -0.97617419]
mat_Sqrt:  [[ 7.17223799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045119  0.00726889  0.1013145 ]
Stock Position:  -0.0004511894852227844
Bond Position:  [-5.1298582]


portfolio before change:  [-5.1756765]
curr_Stock_Price:  100.1287227174732
curr_Factors:  [100.12872272  -1.2586013   -0.94350873]
mat_Sqrt:  [[11.07119358  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.93907196e-04 -4.38221356e-02 -7.21819252e-01]
Stock Position:  -0.00019390719561689944
Bond Position:  [-5.15626082]


portfolio before change:  [-5.17655963]
curr_Stock_Price:  101.35897874087398
curr_Factors:  [101.35897874  -1.33847308  -0.94113927]
mat_Sqrt:  [[10.37144248  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00645586  0.01107604 -0.04288636]
Stock Position:  0.00645586026577226
Bond Position:  [-5.83091903]


portfolio before change:  [-5.18110558]
curr_Stock_Price:  100.76772589328401
curr_Factors:  [100.76772589  -1.53883964  -0.91361939]
mat_Sqrt:  [[ 8.67425203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188355  0.00264506  0.27556148]
Stock Position:  -0.0018835521040403585
Bond Position:  [-4.99130432]


portfolio before change:  [-5.18071018]
curr_Stock_Price:  100.22654026479222
curr_Factors:  [100.22654026  -1.44020032  -0.92311326]
mat_Sqrt:  [[ 9.43210648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102765 -0.01054351  0.0066668 ]
Stock Position:  -0.0010276483648221193
Bond Position:  [-5.07771254]


portfolio before change:  [-5.18064631]
curr_Stock_Price:  99.54670431374264
curr_Factors:  [99.54670431 -1.66794281 -0.93227083]
mat_Sqrt:  [[ 7.39211047  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01498613  0.01407727 -0.73095311]
Stock Position:  -0.014986126827715236
Bond Position:  [-3.68882677]


portfolio before change:  [-5.18331765]
curr_Stock_Price:  99.69418792572988
curr_Factors:  [99.69418793 -1.45126681 -0.92041393]
mat_Sqrt:  [[ 9.30383461  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00704966 -0.0099819  -0.02313969]
Stock Position:  -0.007049658120130354
Bond Position:  [-4.48050771]


portfolio before change:  [-5.17923672]
curr_Stock_Price:  99.03585512753257
curr_Factors:  [99.03585513 -1.18868954 -0.90001539]
mat_Sqrt:  [[12.26533542  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00353356  0.00342714  0.00384292]
Stock Position:  -0.003533558059438064
Bond Position:  [-4.82928778]


portfolio before change:  [-5.17862785]
curr_Stock_Price:  98.69269650447657
curr_Factors:  [98.6926965  -1.29331046 -0.88483147]
mat_Sqrt:  [[11.1771221   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.44476540e-04 -1.41934960e-02 -2.19202705e-01]
Stock Position:  -0.00014447653962027394
Bond Position:  [-5.16436907]


portfolio before change:  [-5.17921114]
curr_Stock_Price:  98.2614960359495
curr_Factors:  [98.26149604 -1.14088549 -0.87843118]
mat_Sqrt:  [[13.04383463  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008032   0.01545531 -0.22476681]
Stock Position:  -0.0008032049408538577
Bond Position:  [-5.10028702]


portfolio before change:  [-5.17948136]
curr_Stock_Price:  97.80413132097797
curr_Factors:  [97.80413132 -1.68224045 -0.86526257]
mat_Sqrt:  [[ 7.65580204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00722584 0.00597677 0.20642327]
Stock Position:  0.0072258413774756985
Bond Position:  [-5.8861985]


portfolio before change:  [-5.18177437]
curr_Stock_Price:  97.58862827722794
curr_Factors:  [97.58862828 -1.60998842 -0.82886471]
mat_Sqrt:  [[ 8.51566865  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0082966  -0.01041239  0.51282312]
Stock Position:  0.008296600372879319
Bond Position:  [-5.99142822]


portfolio before change:  [-5.18435089]
curr_Stock_Price:  97.36835231042285
curr_Factors:  [97.36835231 -1.49263682 -0.8093794 ]
mat_Sqrt:  [[ 9.74237576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00828468 -0.00555088 -0.06431873]
Stock Position:  -0.008284678669371909
Bond Position:  [-4.37768538]


portfolio before change:  [-5.18951363]
curr_Stock_Price:  97.92546437251595
curr_Factors:  [97.92546437 -1.55311344 -0.77650686]
mat_Sqrt:  [[ 9.53134952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036234 -0.0236342   0.08140405]
Stock Position:  -0.00036234335708968974
Bond Position:  [-5.15403098]


portfolio before change:  [-5.19038081]
curr_Stock_Price:  98.54060693719617
curr_Factors:  [98.54060694 -1.30494266 -0.7844191 ]
mat_Sqrt:  [[12.1959868   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095528  0.03220875  0.15670647]
Stock Position:  -0.0009552780410929725
Bond Position:  [-5.09624713]


portfolio before change:  [-5.19088735]
curr_Stock_Price:  98.40396344121977
curr_Factors:  [98.40396344 -1.29141962 -0.78065383]
mat_Sqrt:  [[12.39146141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00322148 -0.02381483 -0.18121078]
Stock Position:  0.0032214768754820185
Bond Position:  [-5.50789344]


portfolio before change:  [-5.19442075]
curr_Stock_Price:  97.52086983301463
curr_Factors:  [97.52086983 -0.94467417 -0.74441625]
mat_Sqrt:  [[18.0108795   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00622439 0.0011681  0.18607245]
Stock Position:  0.0062243875380058235
Bond Position:  [-5.80142843]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.20260573]
Stock Price:  96.32239625290197
PL:  [-5.20260573]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.17397552e-01  7.45155738e-02 -1.04225793e-02]
 [-1.54730828e-01  3.08636008e-02  6.37883053e-02]
 [-2.21406509e-02  5.66722325e-02  3.37032996e-02]
 [ 1.22982458e-01  6.08728285e-02  1.23491483e-01]
 [-1.71532454e-01  2.67251443e-01 -2.22735385e-02]
 [-6.26177422e-02 -1.45419436e-01  1.91984042e-01]
 [-6.31029915e-02 -1.55949048e-01  4.74151674e-02]
 [ 1.92390300e-02  7.69934944e-01  1.18756085e-01]
 [ 1.66288681e-02  4.90809967e-02 -1.36704974e-03]
 [ 2.39092904e-01  8.51159304e-02  1.11285062e-01]
 [ 2.56518179e-02 -1.62583140e-01  3.00404155e-03]
 [ 7.51794244e-02 -1.03202148e-02  1.27238827e-01]
 [ 1.04251855e-02 -2.42499010e-02  3.28736539e-02]
 [ 1.68532352e-02 -2.59723375e-01  8.86163497e-03]
 [-7.01226810e-03  2.69026696e-02 -5.46894751e-02]
 [ 1.78182217e-01  1.82870352e-02 -6.81474672e-02]
 [ 4.53260868e-02  2.79349439e-02  7.97918107e-03]
 [-4.72032341e-02 -6.18447324e-02  4.08086721e-04]
 [ 3.94443680e-02  1.47975110e-02 -1.65808060e-01]
 [ 1.48239981e-02 -5.75841384e-03  2.76607126e-02]
 [-1.54538192e-02  3.24348426e-01 -2.74539627e-01]
 [ 2.14212238e-02  2.66874366e-02  1.75453161e-02]
 [-9.65135042e-04 -2.02008622e-02  6.17069453e-02]
 [ 9.17933384e-02 -8.89217007e-02 -2.37950286e-01]
 [ 3.02058893e-02  1.96068872e-02 -1.23458178e-02]
 [-6.58287670e-02 -1.06099817e-02  1.88042876e-01]
 [-2.08080949e-02 -3.26217040e-02  1.78815006e-04]
 [-9.59712702e-02  9.31876884e-02 -1.76258727e-01]
 [-4.64584471e-02 -3.90632969e-02  1.97143894e-02]
 [-4.55264192e-02  1.18806185e-02  2.89325257e-05]
 [ 2.89608703e-02 -4.43584906e-02 -8.51445382e-02]
 [-1.13018664e-02  4.64240953e-02 -8.84900197e-02]
 [-2.46345221e-02  3.00192819e-02 -4.35817572e-02]
 [ 3.77813699e-02 -3.56109153e-02  1.63931747e-01]
 [-6.92920960e-02  8.05026637e-03 -2.37305634e-02]
 [-2.80030302e-02 -8.69726670e-02 -3.74210509e-03]
 [ 3.20558972e-02  1.03547043e-01  1.50428273e-01]
 [ 1.76316072e-01 -1.23274961e-01 -1.77631882e-01]
 [ 9.87440053e-02  3.19152896e-03  6.11396095e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.31752597]
curr_Stock_Price:  99.15390243658926
curr_Factors:  [99.15390244 -0.79397675 -1.01532298]
mat_Sqrt:  [[16.23831363  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00642398  0.0240498  -0.02973272]
Stock Position:  -0.006423981397111048
Bond Position:  [-3.68056314]


portfolio before change:  [-4.31501803]
curr_Stock_Price:  98.69187859559723
curr_Factors:  [98.6918786  -0.66321647 -1.01235915]
mat_Sqrt:  [[18.47515843  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00732931  0.00996118  0.18197028]
Stock Position:  -0.007329305924471411
Bond Position:  [-3.59167506]


portfolio before change:  [-4.31468884]
curr_Stock_Price:  98.58570428378941
curr_Factors:  [98.58570428 -0.84702713 -0.98492599]
mat_Sqrt:  [[15.78362723  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00023397  0.01829088  0.09614613]
Stock Position:  -0.0002339653966903641
Bond Position:  [-4.29162319]


portfolio before change:  [-4.31498233]
curr_Stock_Price:  97.54713024613069
curr_Factors:  [97.54713025 -0.92545091 -0.98583152]
mat_Sqrt:  [[14.42630428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01113353 0.01964662 0.35228683]
Stock Position:  0.011133528178937556
Bond Position:  [-5.40102606]


portfolio before change:  [-4.31570762]
curr_Stock_Price:  97.5426286529221
curr_Factors:  [97.54262865 -1.06486503 -0.97114234]
mat_Sqrt:  [[12.73408336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00954341  0.08625503 -0.06354021]
Stock Position:  -0.009543407671148705
Bond Position:  [-3.38481855]


portfolio before change:  [-4.32550012]
curr_Stock_Price:  98.52439194890418
curr_Factors:  [98.52439195 -1.19465907 -0.96297552]
mat_Sqrt:  [[11.3892458   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00466342 -0.04693392  0.54767703]
Stock Position:  -0.0046634152015902755
Bond Position:  [-3.86603997]


portfolio before change:  [-4.32703103]
curr_Stock_Price:  98.7490395747901
curr_Factors:  [98.74903957 -1.20416582 -1.00127348]
mat_Sqrt:  [[10.88235179  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00783446 -0.05033234  0.13526227]
Stock Position:  -0.0078344625133772
Bond Position:  [-3.55338538]


portfolio before change:  [-4.32935903]
curr_Stock_Price:  98.9894897900782
curr_Factors:  [98.98948979 -1.46832785 -1.01220181]
mat_Sqrt:  [[ 8.28530962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02421664 0.24849543 0.33877805]
Stock Position:  0.024216635926608145
Bond Position:  [-6.72655146]


portfolio before change:  [-4.32060083]
curr_Stock_Price:  99.38587313364846
curr_Factors:  [99.38587313 -1.49015931 -1.02239154]
mat_Sqrt:  [[ 8.05633821  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00327301  0.01584082 -0.00389981]
Stock Position:  0.003273005188282379
Bond Position:  [-4.64589131]


portfolio before change:  [-4.32081557]
curr_Stock_Price:  99.49770609338543
curr_Factors:  [99.49770609 -1.60192723 -1.05581856]
mat_Sqrt:  [[ 6.97539395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04002399 0.02747105 0.31746531]
Stock Position:  0.040023988764935334
Bond Position:  [-8.30311064]


portfolio before change:  [-4.32544445]
curr_Stock_Price:  99.40798665135351
curr_Factors:  [99.40798665 -1.81943885 -1.06461456]
mat_Sqrt:  [[ 5.55767051  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124551 -0.05247348  0.00856969]
Stock Position:  -0.0012455091088137695
Bond Position:  [-4.2016309]


portfolio before change:  [-4.32613992]
curr_Stock_Price:  99.54466237418481
curr_Factors:  [99.54466237 -1.59859293 -1.078113  ]
mat_Sqrt:  [[ 6.84761546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01446421 -0.00333084  0.36297696]
Stock Position:  0.014464208260506255
Bond Position:  [-5.76597465]


portfolio before change:  [-4.32721991]
curr_Stock_Price:  99.51982898149164
curr_Factors:  [99.51982898 -1.67553977 -1.08517575]
mat_Sqrt:  [[ 6.29428065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00193596 -0.00782662  0.09377938]
Stock Position:  0.0019359641555193418
Bond Position:  [-4.51988673]


portfolio before change:  [-4.32762242]
curr_Stock_Price:  99.60377084462391
curr_Factors:  [99.60377084 -1.66729946 -1.06118963]
mat_Sqrt:  [[ 6.50590966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00528038 -0.08382536  0.02527978]
Stock Position:  -0.005280384281939409
Bond Position:  [-3.80167624]


portfolio before change:  [-4.32671436]
curr_Stock_Price:  99.34180109458669
curr_Factors:  [99.34180109 -1.33347849 -1.03593815]
mat_Sqrt:  [[ 9.29196268  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136508  0.0086828  -0.15601385]
Stock Position:  -0.0013650750053495926
Bond Position:  [-4.19110535]


portfolio before change:  [-4.32715878]
curr_Stock_Price:  99.28355957495063
curr_Factors:  [99.28355957 -1.32177572 -1.02671643]
mat_Sqrt:  [[ 9.4828779   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01771662  0.00590212 -0.19440576]
Stock Position:  0.01771661517943488
Bond Position:  [-6.0861274]


portfolio before change:  [-4.33647356]
curr_Stock_Price:  98.80073744578344
curr_Factors:  [98.80073745 -1.1122484  -0.9932712 ]
mat_Sqrt:  [[12.03218888  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00437635 0.00901596 0.02276238]
Stock Position:  0.004376346433307862
Bond Position:  [-4.76885982]


portfolio before change:  [-4.33633172]
curr_Stock_Price:  98.96936912112399
curr_Factors:  [98.96936912 -1.14091461 -0.97840694]
mat_Sqrt:  [[11.88751692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00502577 -0.0199603   0.00116416]
Stock Position:  -0.005025770920934158
Bond Position:  [-3.83893434]


portfolio before change:  [-4.33651274]
curr_Stock_Price:  98.90990115621601
curr_Factors:  [98.90990116 -1.02189682 -0.95051911]
mat_Sqrt:  [[13.7603795   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0006264   0.00477588 -0.47300424]
Stock Position:  0.0006263976027260398
Bond Position:  [-4.39846967]


portfolio before change:  [-4.33715456]
curr_Stock_Price:  98.76307644530677
curr_Factors:  [98.76307645 -1.28337037 -0.93671445]
mat_Sqrt:  [[10.72565989  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00179894 -0.00185852  0.07890831]
Stock Position:  0.0017989369756980626
Bond Position:  [-4.51482311]


portfolio before change:  [-4.33742994]
curr_Stock_Price:  98.92372953836637
curr_Factors:  [98.92372954 -1.58251614 -0.96753574]
mat_Sqrt:  [[ 7.72372893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.84467402e-04  1.04683004e-01 -7.83185138e-01]
Stock Position:  -0.0006844674021699583
Bond Position:  [-4.26971987]


portfolio before change:  [-4.33826111]
curr_Stock_Price:  99.35826331351187
curr_Factors:  [99.35826331 -1.56900899 -0.95050557]
mat_Sqrt:  [[ 7.99820847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00380713 0.00861333 0.0500519 ]
Stock Position:  0.003807127151172278
Bond Position:  [-4.71653065]


portfolio before change:  [-4.34054776]
curr_Stock_Price:  98.9125087553493
curr_Factors:  [98.91250876 -1.51180223 -0.93251907]
mat_Sqrt:  [[ 8.58412366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00087455 -0.0065198   0.17603274]
Stock Position:  0.0008745515531792214
Bond Position:  [-4.42705185]


portfolio before change:  [-4.34120367]
curr_Stock_Price:  98.79531303419786
curr_Factors:  [98.79531303 -1.19532347 -0.94177347]
mat_Sqrt:  [[11.65754055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00215061 -0.02869936 -0.67880593]
Stock Position:  0.002150614307903389
Bond Position:  [-4.55367428]


portfolio before change:  [-4.34145892]
curr_Stock_Price:  98.94131554228537
curr_Factors:  [98.94131554 -1.20825404 -0.93346959]
mat_Sqrt:  [[11.62087755  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00272682  0.0063281  -0.03521918]
Stock Position:  0.0027268206514802175
Bond Position:  [-4.61125414]


portfolio before change:  [-4.34203443]
curr_Stock_Price:  98.94165811421189
curr_Factors:  [98.94165811 -1.35054059 -0.95446677]
mat_Sqrt:  [[ 9.87022848  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00299997 -0.00342436  0.53643398]
Stock Position:  -0.0029999740362152815
Bond Position:  [-4.04521202]


portfolio before change:  [-4.34103558]
curr_Stock_Price:  98.44014360888607
curr_Factors:  [98.44014361 -1.38407107 -0.96824769]
mat_Sqrt:  [[ 9.3664103   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0029286  -0.01052861  0.00051011]
Stock Position:  -0.0029286002818553663
Bond Position:  [-4.05274375]


portfolio before change:  [-4.34041073]
curr_Stock_Price:  98.05379087426861
curr_Factors:  [98.05379087 -1.37321006 -0.97992471]
mat_Sqrt:  [[ 9.32203961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0121141   0.0300762  -0.50281709]
Stock Position:  -0.012114095164548455
Bond Position:  [-3.15257778]


portfolio before change:  [-4.34905092]
curr_Stock_Price:  98.73449275030792
curr_Factors:  [98.73449275 -1.26567469 -0.98116291]
mat_Sqrt:  [[10.43950073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00482859 -0.01260762  0.05623967]
Stock Position:  -0.004828585921691668
Bond Position:  [-3.87230294]


portfolio before change:  [-4.35064273]
curr_Stock_Price:  98.96390754868428
curr_Factors:  [98.96390755 -1.0578257  -0.97092425]
mat_Sqrt:  [[13.01373396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.31153168e-03  3.83445313e-03  8.25364424e-05]
Stock Position:  -0.0033115316777640345
Bond Position:  [-4.02292062]


portfolio before change:  [-4.35075743]
curr_Stock_Price:  98.84668067513263
curr_Factors:  [98.84668068 -1.17842095 -0.94770561]
mat_Sqrt:  [[11.7922603   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.14223158e-04 -1.43166413e-02 -2.42893668e-01]
Stock Position:  0.0002142231580396604
Bond Position:  [-4.37193268]


portfolio before change:  [-4.35151681]
curr_Stock_Price:  97.853076907998
curr_Factors:  [97.85307691 -1.17578844 -0.90563795]
mat_Sqrt:  [[12.20738073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162922  0.01498331 -0.2524374 ]
Stock Position:  -0.0016292223312276992
Bond Position:  [-4.19209239]


portfolio before change:  [-4.35148925]
curr_Stock_Price:  97.51450986190694
curr_Factors:  [97.51450986 -1.12334063 -0.8933962 ]
mat_Sqrt:  [[12.97811339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00211147  0.00968868 -0.12432662]
Stock Position:  -0.0021114741334920485
Bond Position:  [-4.14558989]


portfolio before change:  [-4.35228639]
curr_Stock_Price:  97.6466016862931
curr_Factors:  [97.64660169 -0.88207844 -0.91339189]
mat_Sqrt:  [[16.21415331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00394561 -0.01149337  0.46765165]
Stock Position:  0.003945611516241391
Bond Position:  [-4.73756195]


portfolio before change:  [-4.35390248]
curr_Stock_Price:  97.38710954319917
curr_Factors:  [97.38710954 -0.91519237 -0.94640812]
mat_Sqrt:  [[15.13626271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00478935  0.00259821 -0.06769669]
Stock Position:  -0.004789347581714464
Bond Position:  [-3.88748176]


portfolio before change:  [-4.35506105]
curr_Stock_Price:  97.52754799433453
curr_Factors:  [97.52754799 -0.59366498 -0.94976699]
mat_Sqrt:  [[20.83643027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223263 -0.02807031 -0.01067518]
Stock Position:  -0.002232633175457369
Bond Position:  [-4.13731781]


portfolio before change:  [-4.3532237]
curr_Stock_Price:  96.47294102055784
curr_Factors:  [96.47294102 -0.59930993 -0.96632924]
mat_Sqrt:  [[20.1584466   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00416195 0.03341966 0.42912999]
Stock Position:  0.004161947260487461
Bond Position:  [-4.75473899]


portfolio before change:  [-4.35994415]
curr_Stock_Price:  95.00101644543521
curr_Factors:  [95.00101645 -0.63697697 -0.96427231]
mat_Sqrt:  [[19.15642785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00599766 -0.03978682 -0.50673431]
Stock Position:  0.005997658917347277
Bond Position:  [-4.92972785]


portfolio before change:  [-4.36098511]
curr_Stock_Price:  94.93020481485154
curr_Factors:  [94.93020481 -0.52877341 -0.98694402]
mat_Sqrt:  [[20.85147117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00536535 0.00103006 0.17441429]
Stock Position:  0.0053653549472166655
Bond Position:  [-4.87031935]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.3685502]
Stock Price:  93.63369010784955
PL:  [-4.3685502]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.62314870e-01 -4.19305246e-02  2.76530760e-03]
 [-1.39373086e-01  6.22218899e-02 -4.09554759e-02]
 [-1.96655230e-02  5.74066913e-02  3.52500152e-02]
 [ 8.95511157e-02  7.89939255e-02  7.83889796e-02]
 [-7.71738738e-02  2.00704387e-01 -4.10613860e-02]
 [-7.28351992e-02 -1.50619201e-01  1.64100036e-01]
 [-5.22481717e-02 -1.73258155e-01 -2.75197087e-02]
 [-3.39326527e-02  7.55872522e-01  1.69697342e-01]
 [ 5.51329323e-01  1.05825345e-01  5.12959925e-01]
 [ 1.02915118e+00  4.77817568e-01  9.82415472e-01]
 [ 3.14932448e-01 -2.82936920e-01 -2.15629137e-01]
 [ 5.57765926e-02  4.56616604e-02 -1.43061785e-01]
 [ 3.05429531e-03 -7.89704171e-02  1.12174683e-01]
 [ 2.08992729e-03  7.89096103e-02 -3.52214153e-02]
 [ 8.62514252e-01 -2.30990543e-01 -4.37867108e-01]
 [-1.32931481e-01 -9.20095474e-02  1.02795017e-01]
 [ 5.95028426e-02 -2.03550199e-02 -2.34087490e-03]
 [-3.79324993e-02 -5.69350123e-02  2.44907590e-03]
 [ 2.84893545e-01 -3.72775141e-01  1.82437285e-01]
 [ 5.78552676e-02  8.00795818e-03  5.77333357e-01]
 [-5.99020943e-02  6.66265964e-01 -6.45146134e-01]
 [ 3.56848548e-01  2.06191466e-01  6.42676574e-02]
 [-2.18630074e-01  1.84875937e-01 -1.09571172e-01]
 [-6.68874264e-02 -1.06966457e-01 -2.11022368e-02]
 [-8.56685536e-02 -3.71706971e-02  1.87353455e-03]
 [ 2.20583467e-02  2.66044269e-02 -5.51391867e-02]
 [ 8.76640117e-02 -1.16042952e-02  1.69435335e-01]
 [ 1.69200954e-01 -5.16844617e-02  2.26524836e-01]
 [-3.31103156e-02  1.71449176e-02 -9.09529243e-02]
 [-6.43176385e-02  7.47359495e-03  1.06392204e-02]
 [ 1.64065932e-01  2.96181317e-02  5.44931115e-02]
 [ 2.73692547e-02 -1.67857156e-01 -2.98523262e-01]
 [ 3.59906943e-02 -8.69903531e-03  1.52216904e-01]
 [-2.37314487e-02 -1.36760389e-01 -4.73484513e-01]
 [ 1.04940138e-01  4.48470412e-01 -2.00284899e-01]
 [-4.12587718e-02 -5.57295733e-04 -1.02311217e-02]
 [ 5.09015174e-01 -2.90454266e-01  3.52519785e-01]
 [-1.26098326e-01  6.36162978e-02  5.22363079e-02]
 [ 3.14872628e-01 -3.68412857e-02  5.64217048e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.93819313]
curr_Stock_Price:  99.45387074522398
curr_Factors:  [99.45387075 -0.94768102 -0.99671578]
mat_Sqrt:  [[14.22921322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01084532 -0.01353302  0.00788865]
Stock Position:  0.010845315304855389
Bond Position:  [-3.01680171]


portfolio before change:  [-1.93903159]
curr_Stock_Price:  99.41133258552082
curr_Factors:  [99.41133259 -0.62271012 -1.01140398]
mat_Sqrt:  [[19.39765185  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00696126  0.02008203 -0.11683457]
Stock Position:  -0.006961259975680402
Bond Position:  [-1.24700346]


portfolio before change:  [-1.93202359]
curr_Stock_Price:  98.38222524270007
curr_Factors:  [98.38222524 -0.74041191 -1.01265153]
mat_Sqrt:  [[17.04397399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.41242166e-05  1.85279299e-02  1.00558482e-01]
Stock Position:  -4.412421659509223e-05
Bond Position:  [-1.92768255]


portfolio before change:  [-1.93227419]
curr_Stock_Price:  98.60022960262972
curr_Factors:  [98.6002296  -0.67267519 -1.02621178]
mat_Sqrt:  [[18.0326972   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00674756 0.02549518 0.22362194]
Stock Position:  0.006747563347911674
Bond Position:  [-2.59758548]


portfolio before change:  [-1.92960014]
curr_Stock_Price:  99.04465240810421
curr_Factors:  [99.04465241 -0.45815194 -1.02157432]
mat_Sqrt:  [[22.55246839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00197703  0.06477706 -0.11713671]
Stock Position:  -0.001977028935261277
Bond Position:  [-1.73378599]


portfolio before change:  [-1.93032909]
curr_Stock_Price:  99.30373864361478
curr_Factors:  [99.30373864 -0.31221395 -1.02789207]
mat_Sqrt:  [[25.99949741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00269557 -0.04861214  0.46813173]
Stock Position:  -0.002695568842135581
Bond Position:  [-1.66264903]


portfolio before change:  [-1.93762524]
curr_Stock_Price:  101.93335171827249
curr_Factors:  [101.93335172  -0.40481416  -1.02258795]
mat_Sqrt:  [[24.45701458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00381207 -0.05591883 -0.07850607]
Stock Position:  -0.0038120671385440583
Bond Position:  [-1.54904846]


portfolio before change:  [-1.93325416]
curr_Stock_Price:  100.73591076381685
curr_Factors:  [100.73591076  -0.29569637  -1.00897989]
mat_Sqrt:  [[27.32565724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00567227 0.24395681 0.48409928]
Stock Position:  0.005672269960985273
Bond Position:  [-2.50465544]


portfolio before change:  [-1.92870777]
curr_Stock_Price:  101.59261991258903
curr_Factors:  [ 1.01592620e+02 -8.31871244e-02 -1.00799887e+00]
mat_Sqrt:  [[34.11662837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01986241 0.03415498 1.46333189]
Stock Position:  0.019862406394117488
Bond Position:  [-3.94658168]


portfolio before change:  [-1.85082093]
curr_Stock_Price:  105.53877820345652
curr_Factors:  [ 1.05538778e+02  6.16808211e-02 -1.06654285e+00]
mat_Sqrt:  [[38.6372338   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0343508  0.15421496 2.80255789]
Stock Position:  0.03435080292531227
Bond Position:  [-5.4761627]


portfolio before change:  [-1.72256424]
curr_Stock_Price:  109.29243860963673
curr_Factors:  [ 1.09292439e+02  7.55693898e-02 -1.07843071e+00]
mat_Sqrt:  [[40.091562    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00531691 -0.0913175  -0.61512991]
Stock Position:  0.005316906269300804
Bond Position:  [-2.30366189]


portfolio before change:  [-1.72553891]
curr_Stock_Price:  108.787126632557
curr_Factors:  [ 1.08787127e+02  3.81278827e-02 -1.08067799e+00]
mat_Sqrt:  [[38.35338906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0009359   0.01473724 -0.40811545]
Stock Position:  0.0009358984011424412
Bond Position:  [-1.82735261]


portfolio before change:  [-1.72444636]
curr_Stock_Price:  110.19859166580919
curr_Factors:  [ 1.10198592e+02  2.30400974e-02 -1.08296649e+00]
mat_Sqrt:  [[38.18175281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.57507498e-04 -2.54875925e-02  3.20003146e-01]
Stock Position:  0.00025750749802082415
Bond Position:  [-1.75282332]


portfolio before change:  [-1.72550746]
curr_Stock_Price:  106.92884092439341
curr_Factors:  [ 1.06928841e+02 -8.40843582e-02 -1.06023136e+00]
mat_Sqrt:  [[34.05060704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00032328  0.02546797 -0.10047689]
Stock Position:  0.00032327596178447415
Bond Position:  [-1.76007499]


portfolio before change:  [-1.72513468]
curr_Stock_Price:  108.7625896049472
curr_Factors:  [108.7625896   -0.39733698  -1.05899286]
mat_Sqrt:  [[25.35149197  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02863675 -0.07455188 -1.24911298]
Stock Position:  0.02863674674982615
Bond Position:  [-4.83974141]


portfolio before change:  [-1.74364482]
curr_Stock_Price:  108.1373392107985
curr_Factors:  [108.13733921  -0.51998275  -1.07046386]
mat_Sqrt:  [[22.04212641  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00593091 -0.02969595  0.29324557]
Stock Position:  -0.005930911742903515
Bond Position:  [-1.10229181]


portfolio before change:  [-1.73749783]
curr_Stock_Price:  107.07767262297276
curr_Factors:  [107.07767262  -0.40384689  -1.06181726]
mat_Sqrt:  [[24.72686571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00221905 -0.00656955 -0.00667786]
Stock Position:  0.0022190464052178134
Bond Position:  [-1.97510815]


portfolio before change:  [-1.73502944]
curr_Stock_Price:  108.30130443972311
curr_Factors:  [108.30130444  -0.34114626  -1.06825453]
mat_Sqrt:  [[26.45688436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185413 -0.0183757   0.00698653]
Stock Position:  -0.001854125897926358
Bond Position:  [-1.53422518]


portfolio before change:  [-1.7362291]
curr_Stock_Price:  108.84489124640353
curr_Factors:  [108.84489125  -0.38561297  -1.0941836 ]
mat_Sqrt:  [[24.78224017  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00992812 -0.12031266  0.52044279]
Stock Position:  0.009928117539134949
Bond Position:  [-2.81685398]


portfolio before change:  [-1.74452445]
curr_Stock_Price:  108.04481785684995
curr_Factors:  [108.04481786  -0.31510004  -1.09726154]
mat_Sqrt:  [[26.31619554  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00673872 0.00258456 1.64697137]
Stock Position:  0.006738723419054876
Bond Position:  [-2.4726086]


portfolio before change:  [-1.75617353]
curr_Stock_Price:  106.3620102082983
curr_Factors:  [106.36201021  -0.38578534  -1.08473756]
mat_Sqrt:  [[24.44255259  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227435  0.21503642 -1.84042235]
Stock Position:  -0.0022743544052003374
Bond Position:  [-1.51426862]


portfolio before change:  [-1.75734692]
curr_Stock_Price:  106.79470316166076
curr_Factors:  [106.79470316  -0.4074742   -1.08818962]
mat_Sqrt:  [[23.93267089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01721729 0.06654801 0.18333774]
Stock Position:  0.017217292091497576
Bond Position:  [-3.59606252]


portfolio before change:  [-1.74588479]
curr_Stock_Price:  107.48654595571307
curr_Factors:  [107.48654596  -0.31472395  -1.0943796 ]
mat_Sqrt:  [[26.26565372  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00773857  0.05966845 -0.31257606]
Stock Position:  -0.007738568225711367
Bond Position:  [-0.91409283]


portfolio before change:  [-1.74894262]
curr_Stock_Price:  107.86692106320815
curr_Factors:  [107.86692106  -0.19233737  -1.09522572]
mat_Sqrt:  [[29.76505839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00312545 -0.03452328 -0.06019881]
Stock Position:  -0.0031254546153276926
Bond Position:  [-1.41180946]


portfolio before change:  [-1.75724254]
curr_Stock_Price:  110.4660405805811
curr_Factors:  [110.46604058  -0.15088726  -1.094212  ]
mat_Sqrt:  [[31.80453484  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00292014 -0.01199679  0.00534467]
Stock Position:  -0.0029201356713375046
Bond Position:  [-1.43466671]


portfolio before change:  [-1.75579919]
curr_Stock_Price:  109.91034786194008
curr_Factors:  [109.91034786  -0.25608188  -1.08240898]
mat_Sqrt:  [[28.82301355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00056322  0.00858654 -0.15729675]
Stock Position:  0.0005632205405625938
Bond Position:  [-1.81770295]


portfolio before change:  [-1.75740631]
curr_Stock_Price:  107.46034148915948
curr_Factors:  [ 1.07460341e+02 -2.58349123e-02 -1.09481982e+00]
mat_Sqrt:  [[35.03918943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00342134 -0.00374527  0.48335185]
Stock Position:  0.003421344494730099
Bond Position:  [-2.12506515]


portfolio before change:  [-1.7549779]
curr_Stock_Price:  108.24776662868965
curr_Factors:  [ 1.08247767e+02 -9.46948199e-02 -1.08156955e+00]
mat_Sqrt:  [[33.38672495  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00613687 -0.01668109  0.64621231]
Stock Position:  0.006136873150901529
Bond Position:  [-2.41928072]


portfolio before change:  [-1.76558398]
curr_Stock_Price:  106.56879287372581
curr_Factors:  [ 1.06568793e+02  1.79476084e-02 -1.07355229e+00]
mat_Sqrt:  [[37.08401592  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00129911  0.0055335  -0.25946338]
Stock Position:  -0.0012991125877538888
Bond Position:  [-1.62713912]


portfolio before change:  [-1.76597145]
curr_Stock_Price:  106.71047959096153
curr_Factors:  [106.71047959  -0.30357801  -1.05598413]
mat_Sqrt:  [[27.40038952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221239  0.00241209  0.03035073]
Stock Position:  -0.0022123910132923657
Bond Position:  [-1.52988615]


portfolio before change:  [-1.77052891]
curr_Stock_Price:  108.68400615057772
curr_Factors:  [108.68400615  -0.39001118  -1.03564886]
mat_Sqrt:  [[26.12217589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00693798 0.00955921 0.15545368]
Stock Position:  0.006937977458584929
Bond Position:  [-2.5245761]


portfolio before change:  [-1.74722299]
curr_Stock_Price:  112.0886750492908
curr_Factors:  [112.08867505  -0.59104848  -1.02762388]
mat_Sqrt:  [[22.2116726   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305381 -0.05417566 -0.85160377]
Stock Position:  -0.003053810972364176
Bond Position:  [-1.40492536]


portfolio before change:  [-1.74694702]
curr_Stock_Price:  111.94079697274204
curr_Factors:  [111.94079697  -0.40590901  -1.02093387]
mat_Sqrt:  [[26.87313938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00242942 -0.0028076   0.43423246]
Stock Position:  0.002429420537296408
Bond Position:  [-2.0188983]


portfolio before change:  [-1.74708703]
curr_Stock_Price:  111.98705174288723
curr_Factors:  [111.98705174  -0.59812127  -1.05169945]
mat_Sqrt:  [[21.51095933  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00689403 -0.04413923 -1.35071952]
Stock Position:  -0.006894028543929657
Bond Position:  [-0.9750451]


portfolio before change:  [-1.73444125]
curr_Stock_Price:  110.13506169859257
curr_Factors:  [110.1350617   -0.57557094  -1.03894479]
mat_Sqrt:  [[21.91544677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00710005  0.1447432  -0.57135707]
Stock Position:  0.007100051176933153
Bond Position:  [-2.51640582]


portfolio before change:  [-1.73800378]
curr_Stock_Price:  109.67760518648691
curr_Factors:  [109.67760519  -0.78425393  -1.04296393]
mat_Sqrt:  [[17.64279237  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00246338 -0.00017987 -0.02918654]
Stock Position:  -0.00246338262914945
Bond Position:  [-1.46782587]


portfolio before change:  [-1.7346065]
curr_Stock_Price:  108.22400736541061
curr_Factors:  [108.22400737  -0.90467861  -1.03755945]
mat_Sqrt:  [[15.51744943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0336192  -0.09374371  1.00564082]
Stock Position:  0.033619200617341354
Bond Position:  [-5.37301112]


portfolio before change:  [-1.75264753]
curr_Stock_Price:  107.7073574603282
curr_Factors:  [107.70735746  -0.82960658  -1.03139365]
mat_Sqrt:  [[16.7503251   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0061163   0.02053207  0.14901565]
Stock Position:  -0.006116299894831821
Bond Position:  [-1.09387703]


portfolio before change:  [-1.74884759]
curr_Stock_Price:  107.06371975529355
curr_Factors:  [107.06371976  -1.01633379  -1.05478441]
mat_Sqrt:  [[13.49482086  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02362903 -0.01189047  0.16095542]
Stock Position:  0.023629025361974327
Bond Position:  [-4.27865894]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.7644363]
Stock Price:  106.42662856694142
PL:  [-8.19106487]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.69416492e-01 -9.89321549e-02  1.79075710e-02]
 [-1.31159414e-01  6.90001415e-02 -1.41858796e-01]
 [ 1.63240855e-02 -6.23516725e-03  5.80277323e-02]
 [-1.76636630e-01 -8.36915920e-02 -7.63719336e-02]
 [ 1.03771921e-01 -6.26259143e-02 -8.54846578e-02]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.21545862e-02 -1.77291068e-01 -2.76175386e-02]
 [ 9.27713378e-03  7.10520198e-01  1.03385230e-01]
 [ 3.53774639e-01  2.32612330e-02  3.44710597e-01]
 [ 4.84019928e-01  1.94845975e-01  3.42579953e-01]
 [-9.12080542e-02 -8.88211734e-02  8.90342264e-02]
 [-9.19683351e-02 -1.98930321e-02  8.56116184e-02]
 [ 7.29908151e-03 -5.71426229e-02  1.26295053e-01]
 [ 9.79933991e-03 -2.19980324e-02 -2.12662362e-01]
 [ 1.57767271e-01 -8.79798108e-02 -1.16937618e-01]
 [-2.22615523e-01 -9.67365068e-02  1.20915888e-01]
 [ 5.10858923e-02  1.75975208e-02 -2.57085709e-02]
 [-4.60479641e-02 -5.43171336e-02  4.39256815e-02]
 [ 1.16151671e-01 -1.18452442e-01 -3.32885913e-02]
 [ 4.77594872e-02 -7.32065782e-03  2.78190201e-01]
 [-2.70942788e-02  4.37828587e-01 -4.18081891e-01]
 [ 2.88389553e-01  1.73434068e-01  7.54157222e-02]
 [-1.07362922e-01  1.92647943e-01 -9.28139302e-02]
 [ 3.26765383e-02 -1.57997913e-01 -1.83678412e-01]
 [ 8.17257229e-03 -3.39318127e-02 -8.42124350e-03]
 [ 4.11461592e-03  2.15070387e-02 -1.53259473e-02]
 [ 8.74336676e-02 -2.53927454e-03  2.41903242e-01]
 [ 1.69200954e-01 -5.16844617e-02  2.26524836e-01]
 [-6.32492562e-03  6.05732343e-02 -1.62220679e-01]
 [-7.57657653e-02  5.32369976e-02 -4.36997912e-02]
 [ 1.01593684e-01 -3.45760151e-04  1.90366168e-02]
 [ 2.70580113e-02 -1.31758203e-01 -2.41018005e-01]
 [ 6.86796499e-02 -5.34570437e-03  1.41111848e-01]
 [-9.13960608e-03 -1.08853586e-01 -2.80288862e-01]
 [ 8.56744832e-02  3.42156138e-01 -1.76746586e-01]
 [-4.92098211e-02 -1.57960724e-02 -1.80149508e-02]
 [ 5.21856798e-01 -2.64886830e-01  3.62494596e-01]
 [-1.28504897e-01  7.69640987e-02  4.50521997e-02]
 [ 2.05333030e-01 -2.48186923e-02  6.31459904e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.06586607]
curr_Stock_Price:  100.4629620583411
curr_Factors:  [100.46296206  -1.00909921  -1.02115907]
mat_Sqrt:  [[13.19094813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01409721 -0.03193022  0.05108532]
Stock Position:  -0.014097210029223508
Bond Position:  [7.48211354]


portfolio before change:  [6.06445307]
curr_Stock_Price:  100.62954262484807
curr_Factors:  [100.62954262  -0.96975289  -1.04689881]
mat_Sqrt:  [[13.39383042  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0109029   0.0222697  -0.40468366]
Stock Position:  -0.010902902317796476
Bond Position:  [7.16160714]


portfolio before change:  [6.05756152]
curr_Stock_Price:  101.34373851062566
curr_Factors:  [101.34373851  -0.93277049  -1.08328528]
mat_Sqrt:  [[13.49693096  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00199276 -0.00201239  0.16553697]
Stock Position:  0.0019927640286657284
Bond Position:  [5.85560736]


portfolio before change:  [6.05822884]
curr_Stock_Price:  101.31128716447783
curr_Factors:  [101.31128716  -1.00932465  -1.07929952]
mat_Sqrt:  [[12.54815519  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0166805  -0.02701135 -0.21786787]
Stock Position:  -0.01668049665798688
Bond Position:  [7.74815143]


portfolio before change:  [6.06878236]
curr_Stock_Price:  100.73666762588164
curr_Factors:  [100.73666763  -0.90070556  -1.07113519]
mat_Sqrt:  [[14.02258313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00524432 -0.02021243 -0.24386393]
Stock Position:  0.0052443245885974
Bond Position:  [5.54048658]


portfolio before change:  [6.07305225]
curr_Stock_Price:  101.41879216521114
curr_Factors:  [101.41879217  -0.8794018   -1.07632996]
mat_Sqrt:  [[14.34679604  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01068561 -0.05534923  0.15513819]
Stock Position:  -0.010685605048444761
Bond Position:  [7.15677341]


portfolio before change:  [6.07115017]
curr_Stock_Price:  101.68052156237451
curr_Factors:  [101.68052156  -0.95559289  -1.06481898]
mat_Sqrt:  [[13.48292243  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0069704  -0.05722045 -0.07878515]
Stock Position:  -0.006970401329765989
Bond Position:  [6.77990421]


portfolio before change:  [6.07450348]
curr_Stock_Price:  101.3210335126722
curr_Factors:  [101.32103351  -0.76826049  -1.10096503]
mat_Sqrt:  [[15.62806775  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01122435 0.22931941 0.29492928]
Stock Position:  0.011224348807258496
Bond Position:  [4.93724086]


portfolio before change:  [6.06533991]
curr_Stock_Price:  100.44964499885415
curr_Factors:  [100.449645    -0.62831245  -1.09895179]
mat_Sqrt:  [[17.85694165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02401792 0.00750753 0.98336338]
Stock Position:  0.02401791880495008
Bond Position:  [3.65274849]


portfolio before change:  [6.08239572]
curr_Stock_Price:  101.14076205878474
curr_Factors:  [101.14076206  -0.85797501  -1.11446265]
mat_Sqrt:  [[14.07043193  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0421964  0.06288627 0.97728525]
Stock Position:  0.042196397307424374
Bond Position:  [1.81461994]


portfolio before change:  [6.05756891]
curr_Stock_Price:  100.54702280024424
curr_Factors:  [100.5470228   -0.71715548  -1.14634272]
mat_Sqrt:  [[15.59775987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00584472 -0.02866691  0.25398987]
Stock Position:  -0.005844721660227126
Bond Position:  [6.64523827]


portfolio before change:  [6.06325409]
curr_Stock_Price:  99.7164477209843
curr_Factors:  [99.71644772 -0.4745425  -1.13190028]
mat_Sqrt:  [[20.0031119   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00392707 -0.00642045  0.24422612]
Stock Position:  -0.003927068206553511
Bond Position:  [6.45484739]


portfolio before change:  [6.05551172]
curr_Stock_Price:  101.89346118797363
curr_Factors:  [101.89346119  -0.42327594  -1.12787507]
mat_Sqrt:  [[21.60180237  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099134 -0.0184427   0.36028463]
Stock Position:  0.0009913414601955145
Bond Position:  [5.95450051]


portfolio before change:  [6.05560279]
curr_Stock_Price:  101.23446824037221
curr_Factors:  [101.23446824  -0.57725507  -1.1396327 ]
mat_Sqrt:  [[18.18417163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209526 -0.00709983 -0.60666652]
Stock Position:  -0.0020952569776864372
Bond Position:  [6.26771502]


portfolio before change:  [6.0568852]
curr_Stock_Price:  100.99636022303301
curr_Factors:  [100.99636022  -0.61587096  -1.12473553]
mat_Sqrt:  [[17.71617367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00654423 -0.02839536 -0.33359047]
Stock Position:  0.006544227801065836
Bond Position:  [5.39594201]


portfolio before change:  [6.06759338]
curr_Stock_Price:  102.52956511257351
curr_Factors:  [102.52956511  -0.70257204  -1.11475195]
mat_Sqrt:  [[16.65694432  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01306842 -0.03122157  0.34493937]
Stock Position:  -0.013068418979422005
Bond Position:  [7.40749269]


portfolio before change:  [6.06251204]
curr_Stock_Price:  102.98924848824305
curr_Factors:  [102.98924849  -0.69066937  -1.10034874]
mat_Sqrt:  [[17.17760478  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0028776   0.00567958 -0.0733394 ]
Stock Position:  0.0028775974154048364
Bond Position:  [5.76615044]


portfolio before change:  [6.06250889]
curr_Stock_Price:  102.73766189472217
curr_Factors:  [102.73766189  -0.83901527  -1.0439598 ]
mat_Sqrt:  [[15.63018057  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0030818  -0.01753078  0.12530774]
Stock Position:  -0.003081801269783441
Bond Position:  [6.37912594]


portfolio before change:  [6.06302219]
curr_Stock_Price:  102.82986141037333
curr_Factors:  [102.82986141  -0.80167637  -1.03171697]
mat_Sqrt:  [[16.43942576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0051813  -0.03823036 -0.09496309]
Stock Position:  0.0051813039961376645
Bond Position:  [5.53022942]


portfolio before change:  [6.06961104]
curr_Stock_Price:  103.96809510948965
curr_Factors:  [103.96809511  -1.00262491  -0.99744383]
mat_Sqrt:  [[14.06958456  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00732435 -0.00236273  0.79359921]
Stock Position:  0.007324345702137571
Bond Position:  [5.30811277]


portfolio before change:  [6.07272946]
curr_Stock_Price:  104.3032600855311
curr_Factors:  [104.30326009  -1.11657789  -0.96720075]
mat_Sqrt:  [[12.98148326  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00177665  0.14130857 -1.19267126]
Stock Position:  -0.0017766460779397213
Bond Position:  [6.25803944]


portfolio before change:  [6.07214726]
curr_Stock_Price:  105.07128662489326
curr_Factors:  [105.07128662  -1.14330344  -0.97782294]
mat_Sqrt:  [[12.59767998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02692447 0.0559756  0.21514006]
Stock Position:  0.02692446579504997
Bond Position:  [3.24315899]


portfolio before change:  [6.10935648]
curr_Stock_Price:  106.43821432862413
curr_Factors:  [106.43821433  -0.9821888   -0.98742861]
mat_Sqrt:  [[14.84921888  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00585784  0.06217686 -0.26477231]
Stock Position:  -0.005857842747830333
Bond Position:  [6.7328548]


portfolio before change:  [6.10653011]
curr_Stock_Price:  107.0643871507994
curr_Factors:  [107.06438715  -1.09470158  -0.97775361]
mat_Sqrt:  [[13.47687446  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00275048 -0.05099361 -0.52398338]
Stock Position:  -0.0027504782052945706
Bond Position:  [6.40100838]


portfolio before change:  [6.10849388]
curr_Stock_Price:  106.64133801212857
curr_Factors:  [106.64133801  -0.96348871  -0.96501481]
mat_Sqrt:  [[15.50197906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.04934679e-05 -1.09514454e-02 -2.40234637e-02]
Stock Position:  -3.0493467906837053e-05
Bond Position:  [6.11174574]


portfolio before change:  [6.10922672]
curr_Stock_Price:  107.66374486170967
curr_Factors:  [107.66374486  -0.77199206  -0.95362334]
mat_Sqrt:  [[19.17097653  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00028044  0.00694137 -0.04372066]
Stock Position:  0.0002804408994660692
Bond Position:  [6.0790334]


portfolio before change:  [6.11030395]
curr_Stock_Price:  108.79521962223161
curr_Factors:  [108.79521962  -0.7679459   -0.93691025]
mat_Sqrt:  [[19.77881167  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00689089 -0.00081955  0.69008262]
Stock Position:  0.006890890870906012
Bond Position:  [5.36060797]


portfolio before change:  [6.11792005]
curr_Stock_Price:  109.80321453877572
curr_Factors:  [109.80321454  -0.97657261  -0.93222087]
mat_Sqrt:  [[16.27933187  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0125859  -0.01668109  0.64621231]
Stock Position:  0.01258590325683096
Bond Position:  [4.73594742]


portfolio before change:  [6.12880398]
curr_Stock_Price:  110.62094626534994
curr_Factors:  [110.62094627  -1.04082435  -0.95327478]
mat_Sqrt:  [[15.05951971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00179777  0.01954993 -0.46277044]
Stock Position:  -0.001797774691111814
Bond Position:  [6.32767552]


portfolio before change:  [6.12846059]
curr_Stock_Price:  111.25194497361282
curr_Factors:  [111.25194497  -1.05720965  -0.96134226]
mat_Sqrt:  [[14.77956509  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00499467  0.01718217 -0.12466334]
Stock Position:  -0.004994665996621771
Bond Position:  [6.6841269]


portfolio before change:  [6.13272783]
curr_Stock_Price:  110.5648786678921
curr_Factors:  [110.56487867  -1.02251532  -0.93382604]
mat_Sqrt:  [[15.63107827  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00674355 -0.00011159  0.05430617]
Stock Position:  0.006743548823814176
Bond Position:  [5.38712817]


portfolio before change:  [6.12833086]
curr_Stock_Price:  109.81298891026479
curr_Factors:  [109.81298891  -0.91765068  -0.95071184]
mat_Sqrt:  [[16.95251661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00289247 -0.04252478 -0.68755728]
Stock Position:  -0.002892468094510708
Bond Position:  [6.44596142]


portfolio before change:  [6.13266318]
curr_Stock_Price:  108.59377772431432
curr_Factors:  [108.59377772  -1.132245    -0.91650781]
mat_Sqrt:  [[13.99725594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00688655 -0.00172532  0.40255282]
Stock Position:  0.0068865496434262555
Bond Position:  [5.38482674]


portfolio before change:  [6.12864409]
curr_Stock_Price:  107.91241537952958
curr_Factors:  [107.91241538  -1.14338186  -0.89848915]
mat_Sqrt:  [[14.00548331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00632416 -0.03513234 -0.79958611]
Stock Position:  -0.006324164161528645
Bond Position:  [6.81109992]


portfolio before change:  [6.12362927]
curr_Stock_Price:  108.84000940082205
curr_Factors:  [108.8400094   -1.25347672  -0.89865002]
mat_Sqrt:  [[12.65120243  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00944089  0.11043042 -0.50420881]
Stock Position:  0.009440886538695847
Bond Position:  [5.09608309]


portfolio before change:  [6.12573684]
curr_Stock_Price:  108.99576946590656
curr_Factors:  [108.99576947  -1.41641617  -0.89377486]
mat_Sqrt:  [[10.81698999  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00518735 -0.00509816 -0.05139164]
Stock Position:  -0.005187345773817666
Bond Position:  [6.69113558]


portfolio before change:  [6.12200709]
curr_Stock_Price:  109.87602442707059
curr_Factors:  [109.87602443  -1.69076748  -0.91534465]
mat_Sqrt:  [[ 8.11115725  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06679453 -0.08549186  1.03409618]
Stock Position:  0.06679452549727642
Bond Position:  [-1.21710982]


portfolio before change:  [6.11109266]
curr_Stock_Price:  109.71489915285075
curr_Factors:  [109.71489915  -1.58453137  -0.92424106]
mat_Sqrt:  [[ 8.92728883  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01160469  0.02484006  0.12852139]
Stock Position:  -0.011604690598905131
Bond Position:  [7.38430012]


portfolio before change:  [6.10876222]
curr_Stock_Price:  109.99526273543164
curr_Factors:  [109.99526274  -1.74991741  -0.91037097]
mat_Sqrt:  [[ 7.69175453  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02771235 -0.0080102   0.18013793]
Stock Position:  0.027712345282102917
Bond Position:  [3.06053552]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.11214297]
Stock Price:  110.10345137417356
PL:  [-3.9913084]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-7.49321676e-02 -8.69449647e-02  1.42187455e-02]
 [-2.23975691e-01  8.40735564e-02 -3.23310659e-01]
 [-4.74684383e-02  4.99724275e-02  1.28167443e-02]
 [-8.14439166e-02 -6.65102065e-02 -3.64821009e-02]
 [ 2.22187465e-01 -2.28433921e-01 -1.05150986e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.12489145e-02 -1.69142895e-01 -3.17391469e-02]
 [ 2.20141984e-03  8.09189482e-01  1.27983860e-01]
 [ 2.80894696e-01 -6.13574285e-03  2.98476336e-01]
 [ 5.32436158e-01  2.34984284e-01  4.47835412e-01]
 [-3.51210471e-02 -1.40747546e-01  2.14801540e-02]
 [-5.73754157e-02 -1.90341325e-02  7.96871699e-02]
 [ 1.18614621e-02 -3.93914215e-02 -2.80530821e-02]
 [ 2.69909337e-04  1.74594263e-01 -1.02321815e-01]
 [ 3.94044555e-01 -1.40219840e-01 -1.97614322e-01]
 [-2.05403432e-01 -9.58293125e-02  1.17438145e-01]
 [ 5.11272224e-02  1.75233434e-02 -2.59503013e-02]
 [-4.39321019e-02 -5.30655579e-02  4.69383011e-02]
 [ 5.17291872e-02  1.71923428e-02 -1.99375661e-01]
 [-2.25166771e-02  4.00036248e-02 -7.01420609e-02]
 [-5.12881096e-02  5.92580169e-01 -5.58907826e-01]
 [ 5.07785164e-01  2.78414127e-01  3.96886932e-02]
 [ 1.61349584e-03 -3.18041705e-02  6.87806502e-02]
 [-6.25587311e-02 -8.27024722e-02 -2.45864127e-02]
 [ 2.17118384e-02  2.42136851e-02 -1.07088133e-02]
 [-1.43217473e-01 -5.73069575e-03  2.15167695e-01]
 [-5.35051274e-02 -3.40327111e-02 -1.23988069e-02]
 [-6.70573499e-02  6.10431259e-02 -1.90936212e-01]
 [ 6.30844809e-02 -3.73934550e-02  1.21508411e-01]
 [-3.90709367e-02  2.11920997e-02 -1.24419002e-02]
 [ 5.97720166e-02  8.56406367e-03  6.11421826e-02]
 [ 3.29107191e-02  1.11795211e-01 -6.93189823e-02]
 [-4.12719568e-02  2.01288921e-02 -5.62346032e-02]
 [ 2.25186898e-02 -5.51359629e-02  6.55789984e-02]
 [-5.39520481e-02  6.91040659e-02 -9.40648465e-03]
 [ 1.73756967e-02 -5.44797198e-02  5.19679808e-02]
 [-1.17777015e-03  1.02052094e-01  1.08432044e-01]
 [-5.93675976e-03 -4.56674462e-02 -1.79033543e-02]
 [ 9.69482472e-02  4.30404648e-03  7.17701409e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.2025935]
curr_Stock_Price:  100.22805472972986
curr_Factors:  [100.22805473  -1.14607401  -1.02006132]
mat_Sqrt:  [[11.48811255  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0078148  -0.02806137  0.04056212]
Stock Position:  -0.007814803741188434
Bond Position:  [4.98585607]


portfolio before change:  [4.20699995]
curr_Stock_Price:  99.74395008086466
curr_Factors:  [99.74395008 -1.12166014 -1.0280135 ]
mat_Sqrt:  [[11.6223825   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02347279  0.02713462 -0.92231532]
Stock Position:  -0.0234727913779646
Bond Position:  [6.54826888]


portfolio before change:  [4.2072799]
curr_Stock_Price:  99.76689748084972
curr_Factors:  [99.76689748 -1.14472943 -1.0540232 ]
mat_Sqrt:  [[11.06828489  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00313072  0.01612853  0.0365626 ]
Stock Position:  -0.003130715612674727
Bond Position:  [4.51962168]


portfolio before change:  [4.20414617]
curr_Stock_Price:  100.9483247478286
curr_Factors:  [100.94832475  -1.14856324  -1.0977106 ]
mat_Sqrt:  [[10.67959503  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00959466 -0.02146608 -0.10407328]
Stock Position:  -0.009594664681920512
Bond Position:  [5.1727115]


portfolio before change:  [4.19308475]
curr_Stock_Price:  102.16859155777315
curr_Factors:  [102.16859156  -1.33729787  -1.10262159]
mat_Sqrt:  [[ 8.90581874  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0173027  -0.07372673 -0.29996649]
Stock Position:  0.017302702306283054
Bond Position:  [2.42529202]


portfolio before change:  [4.19663439]
curr_Stock_Price:  102.356218770841
curr_Factors:  [102.35621877  -1.26278216  -1.09253426]
mat_Sqrt:  [[ 9.70986759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0157885  -0.05534923  0.15513819]
Stock Position:  -0.015788495026262866
Bond Position:  [5.81268504]


portfolio before change:  [4.19482674]
curr_Stock_Price:  102.51673322068554
curr_Factors:  [102.51673322  -1.59050094  -1.10838172]
mat_Sqrt:  [[ 6.89739207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01337517 -0.05459063 -0.09054295]
Stock Position:  -0.013375169724867892
Bond Position:  [5.56600544]


portfolio before change:  [4.19392709]
curr_Stock_Price:  102.63601698829021
curr_Factors:  [102.63601699  -1.58682923  -1.11106622]
mat_Sqrt:  [[ 6.91223799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02799399 0.26116478 0.36510233]
Stock Position:  0.02799399086362487
Bond Position:  [1.32073537]


portfolio before change:  [4.17898703]
curr_Stock_Price:  102.09643106168973
curr_Factors:  [102.09643106  -1.43741454  -1.13138667]
mat_Sqrt:  [[ 7.82337905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04353214 -0.0019803   0.85146991]
Stock Position:  0.04353214477135012
Bond Position:  [-0.26548959]


portfolio before change:  [4.20301117]
curr_Stock_Price:  102.6490647951321
curr_Factors:  [102.6490648   -1.39034844  -1.12079482]
mat_Sqrt:  [[ 8.33257706  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08062525 0.07584085 1.27754978]
Stock Position:  0.08062525438759069
Bond Position:  [-4.07309579]


portfolio before change:  [4.25831726]
curr_Stock_Price:  103.34134484296013
curr_Factors:  [103.34134484  -1.38246321  -1.09074815]
mat_Sqrt:  [[ 8.71308724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00682495 -0.04542608  0.0612769 ]
Stock Position:  -0.00682495193314971
Bond Position:  [4.96361697]


portfolio before change:  [4.25789825]
curr_Stock_Price:  103.4936531065827
curr_Factors:  [103.49365311  -1.3933893   -1.09952623]
mat_Sqrt:  [[ 8.55567462  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00525904 -0.00614324  0.22732531]
Stock Position:  -0.0052590436550145935
Bond Position:  [4.80217589]


portfolio before change:  [4.25624762]
curr_Stock_Price:  103.92166611296562
curr_Factors:  [103.92166611  -1.46845295  -1.10538126]
mat_Sqrt:  [[ 7.9232636   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024051 -0.01271353 -0.08002763]
Stock Position:  -0.00024050563464525065
Bond Position:  [4.28124137]


portfolio before change:  [4.25696485]
curr_Stock_Price:  103.16474896717632
curr_Factors:  [103.16474897  -1.2231067   -1.10741899]
mat_Sqrt:  [[10.03221613  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00149742  0.05635006 -0.29189566]
Stock Position:  0.0014974219720477492
Bond Position:  [4.10248369]


portfolio before change:  [4.25784531]
curr_Stock_Price:  103.41024923299707
curr_Factors:  [103.41024923  -0.85723652  -1.08932578]
mat_Sqrt:  [[14.76326174  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02201983 -0.04525576 -0.56373865]
Stock Position:  0.022019825380752964
Bond Position:  [1.98076968]


portfolio before change:  [4.26376908]
curr_Stock_Price:  103.66802391894498
curr_Factors:  [103.66802392  -0.82719218  -1.08784114]
mat_Sqrt:  [[15.27412774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01315902 -0.03092878  0.33501834]
Stock Position:  -0.013159019700206987
Bond Position:  [5.62793865]


portfolio before change:  [4.2902384]
curr_Stock_Price:  101.70999150309488
curr_Factors:  [101.7099915   -0.70818204  -1.06342488]
mat_Sqrt:  [[17.2967501   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00285644  0.00565563 -0.07402899]
Stock Position:  0.0028564369933993883
Bond Position:  [3.99971022]


portfolio before change:  [4.28919443]
curr_Stock_Price:  101.16946892417866
curr_Factors:  [101.16946892  -1.0151988   -1.06838838]
mat_Sqrt:  [[12.59386568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00358768 -0.01712684  0.13390191]
Stock Position:  -0.0035876849971962174
Bond Position:  [4.65215862]


portfolio before change:  [4.29298879]
curr_Stock_Price:  100.27395902606771
curr_Factors:  [100.27395903  -0.64473734  -1.07444628]
mat_Sqrt:  [[17.97033624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00080918  0.0055488  -0.56876327]
Stock Position:  0.0008091764599875084
Bond Position:  [4.21184947]


portfolio before change:  [4.29295036]
curr_Stock_Price:  99.57577878217334
curr_Factors:  [99.57577878 -0.37508631 -1.05787937]
mat_Sqrt:  [[23.75880674  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00120665  0.01291111 -0.20009578]
Stock Position:  -0.0012066540188734537
Bond Position:  [4.41310387]


portfolio before change:  [4.29540054]
curr_Stock_Price:  98.00241318036707
curr_Factors:  [ 9.80024132e+01 -4.46987128e-02 -1.03340687e+00]
mat_Sqrt:  [[33.34428934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.33200534e-03  1.91254427e-01 -1.59440846e+00]
Stock Position:  -0.0013320053396592012
Bond Position:  [4.42594027]


portfolio before change:  [4.29422989]
curr_Stock_Price:  99.29664527832145
curr_Factors:  [ 9.92966453e+01 -8.92747998e-02 -1.00950052e+00]
mat_Sqrt:  [[33.09348593  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01730605 0.08985777 0.11322079]
Stock Position:  0.017306053253899112
Bond Position:  [2.57579686]


portfolio before change:  [4.27664358]
curr_Stock_Price:  98.26184538469761
curr_Factors:  [98.26184538  0.1022654  -1.00838603]
mat_Sqrt:  [[39.70651088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00023073 -0.01026475  0.19621205]
Stock Position:  0.00023072508649573048
Bond Position:  [4.25397211]


portfolio before change:  [4.27749762]
curr_Stock_Price:  99.65855917952352
curr_Factors:  [ 9.96585592e+01 -7.18108607e-02 -1.01833910e+00]
mat_Sqrt:  [[33.50182688  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252103 -0.02669211 -0.07013819]
Stock Position:  -0.002521026193080943
Bond Position:  [4.52873946]


portfolio before change:  [4.27681569]
curr_Stock_Price:  100.1536184377103
curr_Factors:  [100.15361844   0.16367154  -1.02717932]
mat_Sqrt:  [[42.23281011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00057937  0.00781493 -0.03054926]
Stock Position:  0.0005793720271760215
Bond Position:  [4.21878948]


portfolio before change:  [4.27551051]
curr_Stock_Price:  96.99060130736895
curr_Factors:  [96.99060131  0.22646668 -1.0330864 ]
mat_Sqrt:  [[43.29314722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00232061 -0.00184957  0.61381354]
Stock Position:  -0.002320605717311898
Bond Position:  [4.50058745]


portfolio before change:  [4.27813131]
curr_Stock_Price:  96.1036814374532
curr_Factors:  [96.10368144  0.298494   -1.05389974]
mat_Sqrt:  [[45.15142691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00139493 -0.01098401 -0.03537034]
Stock Position:  -0.0013949264860377575
Bond Position:  [4.41218888]


portfolio before change:  [4.27671449]
curr_Stock_Price:  97.51477930944235
curr_Factors:  [97.51477931  0.14744216 -1.06863532]
mat_Sqrt:  [[38.81515565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0024107   0.01970158 -0.54468787]
Stock Position:  -0.0024106992107493707
Bond Position:  [4.51179329]


portfolio before change:  [4.27705399]
curr_Stock_Price:  97.60790980740002
curr_Factors:  [ 9.76079098e+01 -1.72646394e-02 -1.04527964e+00]
mat_Sqrt:  [[33.73089733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00237925 -0.01206869  0.34662968]
Stock Position:  0.002379254060257269
Bond Position:  [4.04481997]


portfolio before change:  [4.279357]
curr_Stock_Price:  98.36334925758196
curr_Factors:  [ 9.83633493e+01 -2.71276287e-02 -1.04593963e+00]
mat_Sqrt:  [[33.63613763  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00110847  0.00683972 -0.03549328]
Stock Position:  -0.0011084747638630279
Bond Position:  [4.38839029]


portfolio before change:  [4.28037109]
curr_Stock_Price:  97.943398241984
curr_Factors:  [ 9.79433982e+01 -5.87474448e-02 -1.03981541e+00]
mat_Sqrt:  [[32.64941326  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00226653 0.00276404 0.17442163]
Stock Position:  0.0022665260163598935
Bond Position:  [4.05837983]


portfolio before change:  [4.28242396]
curr_Stock_Price:  98.62529563006153
curr_Factors:  [98.62529563 -0.10541627 -1.04805488]
mat_Sqrt:  [[31.12018455  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00133615  0.03608175 -0.19774776]
Stock Position:  0.0013361470557525844
Bond Position:  [4.15064606]


portfolio before change:  [4.28550986]
curr_Stock_Price:  100.54652280746971
curr_Factors:  [100.54652281  -0.4176287   -1.0546725 ]
mat_Sqrt:  [[23.06506969  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0021089   0.00649657 -0.16042167]
Stock Position:  -0.0021089034127531477
Bond Position:  [4.49755277]


portfolio before change:  [4.28827601]
curr_Stock_Price:  99.50146862829362
curr_Factors:  [99.50146863 -0.44760211 -1.03069973]
mat_Sqrt:  [[22.68878078  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00108646 -0.01779506  0.18707863]
Stock Position:  0.0010864561539228523
Bond Position:  [4.18017203]


portfolio before change:  [4.28890921]
curr_Stock_Price:  99.6033059760764
curr_Factors:  [99.60330598 -0.42222376 -1.05221386]
mat_Sqrt:  [[22.79993619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183186  0.02230324 -0.02683408]
Stock Position:  -0.0018318617219378968
Bond Position:  [4.47136869]


portfolio before change:  [4.29202356]
curr_Stock_Price:  98.20833577575691
curr_Factors:  [98.20833578 -0.31587496 -1.04674453]
mat_Sqrt:  [[25.14028682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00067076 -0.01758325  0.14825018]
Stock Position:  0.0006707556775702719
Bond Position:  [4.22614976]


portfolio before change:  [4.29177704]
curr_Stock_Price:  97.05319041592097
curr_Factors:  [97.05319042 -0.21986802 -1.02632157]
mat_Sqrt:  [[27.91235963  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00149708 0.03293717 0.30932644]
Stock Position:  0.0014970831987449159
Bond Position:  [4.14648034]


portfolio before change:  [4.29499733]
curr_Stock_Price:  98.85799602894765
curr_Factors:  [98.85799603 -0.43452755 -1.06346091]
mat_Sqrt:  [[22.10261621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085569 -0.0147391  -0.05107329]
Stock Position:  -0.0008556948589759359
Bond Position:  [4.3795896]


portfolio before change:  [4.29591551]
curr_Stock_Price:  98.42478272591576
curr_Factors:  [98.42478273 -0.62668321 -1.05581306]
mat_Sqrt:  [[18.29808404  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00614692 0.00138913 0.20474023]
Stock Position:  0.006146918192937866
Bond Position:  [3.69090642]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.29529572]
Stock Price:  98.24889399290892
PL:  [4.29529572]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-3.73841831e-01 -1.13542350e-01  2.94809261e-02]
 [-9.91664442e-02  8.53939866e-02 -1.07006124e-01]
 [ 1.63240855e-02 -6.23516725e-03  5.80277323e-02]
 [-2.38039233e-01 -1.23869580e-01 -1.31933864e-01]
 [ 1.75420226e-01 -1.83189394e-01 -1.04497885e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.99553920e-02 -1.85739361e-01  1.14840182e-01]
 [-3.16290966e-02  7.78533175e-01  1.67479599e-01]
 [ 1.68098270e-01 -1.12294996e-02  1.53007609e-01]
 [ 4.00822796e-01  1.52577697e-01  2.47893198e-01]
 [-1.85156894e-01 -2.16180507e-01  2.83288824e-02]
 [-2.66542674e-02 -1.76332958e-02  9.37082908e-02]
 [ 2.64957421e-03 -1.78411347e-02  9.79723279e-02]
 [ 1.16951268e-02 -1.57888775e-01  3.62102205e-02]
 [-5.98271597e-02  1.47100827e-01 -3.25995396e-02]
 [ 1.07263302e-01 -1.86791854e-03 -1.50933658e-02]
 [ 4.38841597e-02  4.72278397e-02 -2.54483379e-02]
 [-4.44051266e-02 -6.12548416e-02 -2.12502575e-03]
 [ 2.33803100e-02  3.94855824e-02 -1.48115754e-01]
 [-1.04685944e-02 -9.68340311e-03 -3.10000135e-02]
 [-2.30548063e-02  3.71958987e-01 -3.16825759e-01]
 [ 9.59909029e-02  8.08196628e-02  1.07375990e-01]
 [ 5.42173000e-03 -4.89404404e-02  7.92274051e-02]
 [ 7.43462845e-02  6.04702832e-02 -1.41449212e-01]
 [-1.02670713e-01  1.28841942e-02  7.95620291e-04]
 [-1.21058855e-01 -5.12395412e-03  2.27032449e-01]
 [-4.49812105e-02 -3.36648701e-02 -9.11989758e-03]
 [-9.60507390e-02  9.98359618e-02 -1.52074071e-01]
 [-1.90460975e-03 -3.91940154e-02  6.70704038e-02]
 [-1.70615888e-02  2.79111473e-02 -3.18760406e-02]
 [-5.21636141e-03 -3.65689318e-02 -2.37998214e-02]
 [ 1.99625484e-02  1.22124454e-01 -9.03224753e-02]
 [-2.93297930e-02  4.46880475e-02 -9.59657691e-02]
 [ 4.06476020e-02 -3.21953684e-02  1.79706549e-01]
 [-6.05915340e-02  4.84473332e-02 -1.75322978e-02]
 [ 8.18163966e-02 -2.83567242e-02  1.25770596e-01]
 [ 1.00628971e-01 -8.42417777e-02  4.54749085e-02]
 [-9.29093843e-02  2.82971936e-02  4.63767403e-02]
 [ 2.11448457e-01 -1.56089301e-02  8.68646122e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.42546597]
curr_Stock_Price:  101.64294970385608
curr_Factors:  [101.6429497   -1.06428643  -1.02058659]
mat_Sqrt:  [[12.63654682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03094206 -0.03664564  0.08410088]
Stock Position:  -0.03094206058033043
Bond Position:  [18.57050828]


portfolio before change:  [15.44173745]
curr_Stock_Price:  101.19210653672782
curr_Factors:  [101.19210654  -1.11139991  -1.02204557]
mat_Sqrt:  [[11.98403405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.008643    0.02756079 -0.30525869]
Stock Position:  -0.008642999747133461
Bond Position:  [16.3163408]


portfolio before change:  [15.44313493]
curr_Stock_Price:  101.26640850954077
curr_Factors:  [101.26640851  -1.23238369  -1.00272145]
mat_Sqrt:  [[10.83356969  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00248267 -0.00201239  0.16553697]
Stock Position:  0.0024826718505151185
Bond Position:  [15.19172367]


portfolio before change:  [15.44548785]
curr_Stock_Price:  101.44921223922283
curr_Factors:  [101.44921224  -1.16290167  -1.01215509]
mat_Sqrt:  [[11.52480352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02518524 -0.03997874 -0.37637059]
Stock Position:  -0.02518523565523675
Bond Position:  [18.00051017]


portfolio before change:  [15.44831883]
curr_Stock_Price:  101.42615222490679
curr_Factors:  [101.42615222  -1.1545649   -1.00717287]
mat_Sqrt:  [[11.67667417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00999397 -0.05912412 -0.29810338]
Stock Position:  0.009993967819874395
Bond Position:  [14.43466913]


portfolio before change:  [15.4525164]
curr_Stock_Price:  101.66560915152405
curr_Factors:  [101.66560915  -0.90861558  -1.00135097]
mat_Sqrt:  [[15.05518624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01018282 -0.05534923  0.15513819]
Stock Position:  -0.010182816324054248
Bond Position:  [16.48775863]


portfolio before change:  [15.47014938]
curr_Stock_Price:  100.13637827582427
curr_Factors:  [100.13637828  -0.57357494  -0.98324814]
mat_Sqrt:  [[21.10922091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00352583 -0.05994712  0.32760707]
Stock Position:  -0.0035258348344450645
Bond Position:  [15.82321371]


portfolio before change:  [15.47447363]
curr_Stock_Price:  99.47094042843918
curr_Factors:  [99.47094043 -0.48136942 -0.97348948]
mat_Sqrt:  [[23.21982989  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00695418 0.2512705  0.47777268]
Stock Position:  0.006954183258747068
Bond Position:  [14.78273448]


portfolio before change:  [15.4731899]
curr_Stock_Price:  99.02060985953311
curr_Factors:  [99.02060986 -0.80920692 -0.97371224]
mat_Sqrt:  [[16.64997719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01183417 -0.00362431  0.43648812]
Stock Position:  0.011834166719031734
Bond Position:  [14.3013635]


portfolio before change:  [15.48346184]
curr_Stock_Price:  99.73753011455878
curr_Factors:  [99.73753011 -0.80114417 -0.97586634]
mat_Sqrt:  [[16.86990945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02860529 0.04924424 0.70717029]
Stock Position:  0.028605285448338784
Bond Position:  [12.63044132]


portfolio before change:  [15.46883906]
curr_Stock_Price:  99.17114237530518
curr_Factors:  [99.17114238 -0.92850862 -0.99095357]
mat_Sqrt:  [[14.54700132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01536412 -0.06977196  0.08081442]
Stock Position:  -0.015364124983731367
Bond Position:  [16.99251688]


portfolio before change:  [15.47793221]
curr_Stock_Price:  98.71755651973508
curr_Factors:  [98.71755652 -0.97727671 -0.96307182]
mat_Sqrt:  [[14.18115929  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078453 -0.00569112  0.26732367]
Stock Position:  -0.0007845285306211825
Bond Position:  [15.55537895]


portfolio before change:  [15.47940347]
curr_Stock_Price:  99.32082410219839
curr_Factors:  [99.3208241  -0.94879209 -0.96463452]
mat_Sqrt:  [[14.65715547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00129672 -0.0057582   0.27948778]
Stock Position:  0.0012967240181379549
Bond Position:  [15.35061177]


portfolio before change:  [15.48097319]
curr_Stock_Price:  99.05151289853096
curr_Factors:  [99.0515129  -0.93088618 -0.97747121]
mat_Sqrt:  [[14.69169927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00089455 -0.05095838  0.10329768]
Stock Position:  -0.0008945462267745161
Bond Position:  [15.56957935]


portfolio before change:  [15.48363698]
curr_Stock_Price:  98.24946894429198
curr_Factors:  [98.24946894 -0.95207421 -0.9595892 ]
mat_Sqrt:  [[14.52463871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00250985  0.04747659 -0.09299741]
Stock Position:  -0.002509851226218859
Bond Position:  [15.73022853]


portfolio before change:  [15.48672361]
curr_Stock_Price:  97.80313483899023
curr_Factors:  [97.80313484 -1.15823425 -0.95865902]
mat_Sqrt:  [[11.77599766  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00881463 -0.00060287 -0.04305717]
Stock Position:  0.00881463273626872
Bond Position:  [14.6246249]


portfolio before change:  [15.48602507]
curr_Stock_Price:  97.51648275892647
curr_Factors:  [97.51648276 -1.05616832 -0.97861322]
mat_Sqrt:  [[12.74628529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00379168  0.01524272 -0.07259702]
Stock Position:  0.003791683674179444
Bond Position:  [15.11627342]


portfolio before change:  [15.49113072]
curr_Stock_Price:  98.36465297101833
curr_Factors:  [98.36465297 -1.34548347 -0.99175893]
mat_Sqrt:  [[ 9.50139966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00603516 -0.01976992 -0.00606211]
Stock Position:  -0.006035162174887615
Bond Position:  [16.08477735]


portfolio before change:  [15.49491405]
curr_Stock_Price:  98.0709388089664
curr_Factors:  [98.07093881 -1.16003389 -0.99984779]
mat_Sqrt:  [[11.31138123  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.06642057e-04  1.27439169e-02 -4.22533020e-01]
Stock Position:  0.00010664205687969116
Bond Position:  [15.48445556]


portfolio before change:  [15.4968509]
curr_Stock_Price:  98.08187098992138
curr_Factors:  [98.08187099 -1.12494234 -1.0377668 ]
mat_Sqrt:  [[11.28070122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166418 -0.0031253  -0.08843441]
Stock Position:  -0.0016641750951204863
Bond Position:  [15.6600763]


portfolio before change:  [15.49938548]
curr_Stock_Price:  97.73517897267762
curr_Factors:  [97.73517897 -1.19909366 -1.00906882]
mat_Sqrt:  [[10.74133183  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109863  0.12004925 -0.9038157 ]
Stock Position:  -0.0010986331462090211
Bond Position:  [15.60676059]


portfolio before change:  [15.50185087]
curr_Stock_Price:  97.2669391229644
curr_Factors:  [97.26693912 -1.04349662 -0.99752042]
mat_Sqrt:  [[12.63463835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01063791 0.02608443 0.30631381]
Stock Position:  0.010637912692273746
Bond Position:  [14.46713367]


portfolio before change:  [15.49386143]
curr_Stock_Price:  96.34589863372166
curr_Factors:  [96.34589863 -0.98690266 -1.00019801]
mat_Sqrt:  [[13.20828336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00087854 -0.01579546  0.22601373]
Stock Position:  0.000878541931652277
Bond Position:  [15.40921752]


portfolio before change:  [15.4958179]
curr_Stock_Price:  96.38026538079701
curr_Factors:  [96.38026538 -0.77547527 -0.98086589]
mat_Sqrt:  [[16.64251056  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00347403  0.0195167  -0.40351523]
Stock Position:  0.0034740269280798793
Bond Position:  [15.16099026]


portfolio before change:  [15.49558419]
curr_Stock_Price:  95.76744542377673
curr_Factors:  [95.76744542 -0.73082916 -0.98288042]
mat_Sqrt:  [[17.25692003  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00578773  0.00415836  0.00226968]
Stock Position:  -0.00578772645811459
Bond Position:  [16.04985996]


portfolio before change:  [15.49421099]
curr_Stock_Price:  96.35136206278129
curr_Factors:  [96.35136206 -0.72393515 -0.97947781]
mat_Sqrt:  [[17.54183449  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00431893 -0.00165375  0.64766038]
Stock Position:  -0.004318931011607757
Bond Position:  [15.91034588]


portfolio before change:  [15.49583142]
curr_Stock_Price:  96.43668125408125
curr_Factors:  [96.43668125 -0.76032327 -0.98653458]
mat_Sqrt:  [[16.81092198  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00319522 -0.01086529 -0.02601653]
Stock Position:  -0.0031952212192183937
Bond Position:  [15.80396795]


portfolio before change:  [15.49495566]
curr_Stock_Price:  97.3290697621559
curr_Factors:  [97.32906976 -0.7112607  -1.0070186 ]
mat_Sqrt:  [[17.45835638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00611248  0.03222192 -0.433825  ]
Stock Position:  -0.006112476805111919
Bond Position:  [16.08987735]


portfolio before change:  [15.49161622]
curr_Stock_Price:  98.20445991955384
curr_Factors:  [98.20445992 -0.58286433 -1.04382854]
mat_Sqrt:  [[19.30489625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0001961  -0.01264981  0.19133319]
Stock Position:  0.00019609710175851256
Bond Position:  [15.47235861]


portfolio before change:  [15.4934311]
curr_Stock_Price:  97.59613014579043
curr_Factors:  [97.59613015 -0.64324704 -1.04462249]
mat_Sqrt:  [[18.04679872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00099025  0.00900828 -0.09093347]
Stock Position:  -0.0009902542573063827
Bond Position:  [15.59007608]


portfolio before change:  [15.49538073]
curr_Stock_Price:  97.5953713273034
curr_Factors:  [97.59537133 -0.38732601 -1.04490737]
mat_Sqrt:  [[23.30333982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00075264 -0.01180257 -0.06789427]
Stock Position:  -0.0007526423974837607
Bond Position:  [15.56883514]


portfolio before change:  [15.49704596]
curr_Stock_Price:  97.96871954180727
curr_Factors:  [97.96871954 -0.39608595 -1.03338977]
mat_Sqrt:  [[23.45708367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112777  0.0394155  -0.25766488]
Stock Position:  0.00112776593896873
Bond Position:  [15.38656017]


portfolio before change:  [15.4973654]
curr_Stock_Price:  96.54644293364808
curr_Factors:  [96.54644293 -0.42245525 -1.01465735]
mat_Sqrt:  [[22.94067574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00173477  0.01442301 -0.27376363]
Stock Position:  -0.001734770785097077
Bond Position:  [15.66485135]


portfolio before change:  [15.49866864]
curr_Stock_Price:  96.9240073182786
curr_Factors:  [96.92400732 -0.39217728 -1.00314033]
mat_Sqrt:  [[24.01334295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00294662 -0.01039101  0.51265276]
Stock Position:  0.0029466199640799926
Bond Position:  [15.21307043]


portfolio before change:  [15.50522001]
curr_Stock_Price:  98.50195600201081
curr_Factors:  [98.501956   -0.60315034 -0.99596871]
mat_Sqrt:  [[19.90472934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00272704  0.01563631 -0.05001477]
Stock Position:  -0.002727041793238062
Bond Position:  [15.77383896]


portfolio before change:  [15.5041233]
curr_Stock_Price:  99.62719258372904
curr_Factors:  [99.62719258 -0.40941807 -0.979809  ]
mat_Sqrt:  [[24.83386088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00409525 -0.00915209  0.3587885 ]
Stock Position:  0.004095252060453763
Bond Position:  [15.09612483]


portfolio before change:  [15.52031432]
curr_Stock_Price:  103.11999017195522
curr_Factors:  [103.11999017  -0.4470301   -0.97154331]
mat_Sqrt:  [[24.96113094  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0037144  -0.02718892  0.12972726]
Stock Position:  0.0037144036896184637
Bond Position:  [15.13728505]


portfolio before change:  [15.52618122]
curr_Stock_Price:  104.19004606494757
curr_Factors:  [104.19004606  -0.5094863   -1.00477206]
mat_Sqrt:  [[22.91881598  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00338877  0.00913288  0.13229993]
Stock Position:  -0.0033887715441496065
Bond Position:  [15.87925748]


portfolio before change:  [15.52796402]
curr_Stock_Price:  104.24972108861657
curr_Factors:  [104.24972109  -0.54672814  -1.01100006]
mat_Sqrt:  [[21.95645085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0102928  -0.00503776  0.24780056]
Stock Position:  0.010292804762181368
Bond Position:  [14.454942]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.54983347]
Stock Price:  106.19889484955242
PL:  [9.35093862]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.25564488e-02 -7.58453174e-02  1.08030441e-02]
 [-1.71637041e-01  1.00286868e-01 -3.16993244e-01]
 [-3.07051131e-02  4.08861457e-02  2.47549708e-02]
 [ 8.39544965e-02  4.32941475e-03  1.23686692e-01]
 [ 8.08880038e-02 -2.94254649e-02 -8.12771446e-02]
 [-1.29786103e-01 -1.66019983e-01  8.53252752e-02]
 [-5.11875444e-02 -1.99919548e-01 -2.99100891e-02]
 [ 5.31224583e-03  6.59803378e-01  1.03860535e-01]
 [ 4.45060168e-01  6.20945130e-02  4.35862360e-01]
 [ 5.95824852e-01  2.65039102e-01  5.13040258e-01]
 [-5.98023882e-02 -1.32214127e-01  3.90124848e-02]
 [-5.73754157e-02 -1.90341325e-02  7.96871699e-02]
 [ 1.47228455e-02 -5.24523149e-02  5.49814144e-02]
 [-2.51468080e-04  1.74468563e-01 -9.49158671e-02]
 [ 3.31230850e-01 -1.56370710e-01 -1.70367359e-01]
 [-2.15037453e-01 -9.63370909e-02  1.19384722e-01]
 [ 5.10419130e-02  1.76764526e-02 -2.54513466e-02]
 [-4.97516387e-02 -5.65079329e-02  3.86522932e-02]
 [ 1.64840723e-01 -2.02273737e-01  3.17890884e-02]
 [ 4.57153373e-02 -3.10995954e-03  3.55090199e-01]
 [-4.25261126e-02  5.49066151e-01 -5.32241385e-01]
 [ 3.03755233e-01  1.80786494e-01  7.29135295e-02]
 [-1.12511124e-01  1.65895871e-01 -7.91280407e-02]
 [-6.10949053e-02 -1.21641805e-01 -2.18957796e-02]
 [-2.38123135e-02 -3.76641849e-02 -4.92077262e-03]
 [-2.36988886e-03  1.89272823e-02  1.14982273e-02]
 [ 8.89749289e-02 -1.65410290e-02  1.28779273e-01]
 [ 1.65907803e-01 -5.44414750e-02  2.06372047e-01]
 [-4.00848958e-02  6.18954142e-03 -7.31419839e-02]
 [-5.94044869e-02 -1.35935058e-02  4.07087907e-02]
 [ 2.37341526e-02 -3.26357938e-02 -1.21923097e-02]
 [ 2.65156093e-02 -6.88487733e-02 -1.40803937e-01]
 [ 6.20683447e-02  1.24541995e-03  1.42075312e-01]
 [-8.40360019e-03 -1.07445980e-01 -2.70544161e-01]
 [ 7.22163365e-02  3.16402222e-01 -1.27034218e-01]
 [-2.99438523e-02 -2.40675395e-02  1.68253469e-02]
 [ 4.58045147e-01 -2.72330370e-01  2.98135496e-01]
 [-1.16942540e-01  4.89624397e-02  4.85018333e-02]
 [ 1.97473713e-01 -1.27399999e-02  9.09780783e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.63983662]
curr_Stock_Price:  99.90496170464357
curr_Factors:  [99.9049617  -1.05101233 -1.01155667]
mat_Sqrt:  [[12.70061408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.67098318e-05 -2.44789709e-02  3.08180778e-02]
Stock Position:  -5.670983177546051e-05
Bond Position:  [1.64550222]


portfolio before change:  [1.64001225]
curr_Stock_Price:  100.4353038647282
curr_Factors:  [100.43530386  -1.21655706  -1.00424607]
mat_Sqrt:  [[10.89943174  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01980581  0.03236745 -0.90429349]
Stock Position:  -0.019805807322874555
Bond Position:  [3.62921453]


portfolio before change:  [1.64468369]
curr_Stock_Price:  100.22234822558116
curr_Factors:  [100.22234823  -1.28179416  -1.00795578]
mat_Sqrt:  [[10.15170082  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170476  0.01319595  0.07061904]
Stock Position:  -0.0017047563345116846
Bond Position:  [1.81553837]


portfolio before change:  [1.64489494]
curr_Stock_Price:  100.23156268110723
curr_Factors:  [100.23156268  -1.15134284  -1.01641044]
mat_Sqrt:  [[11.46994172  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00959775 0.00139731 0.3528437 ]
Stock Position:  0.009597753632750235
Bond Position:  [0.68289709]


portfolio before change:  [1.64624841]
curr_Stock_Price:  100.36368771757324
curr_Factors:  [100.36368772  -1.03881022  -1.01924469]
mat_Sqrt:  [[12.81665575  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00454806 -0.00949703 -0.23186107]
Stock Position:  0.0045480606981343884
Bond Position:  [1.18978826]


portfolio before change:  [1.64654367]
curr_Stock_Price:  100.39590645535382
curr_Factors:  [100.39590646  -0.80630862  -1.03201861]
mat_Sqrt:  [[15.97131351  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00915753 -0.05358272  0.24340926]
Stock Position:  -0.009157533650467287
Bond Position:  [2.56592256]


portfolio before change:  [1.62356396]
curr_Stock_Price:  102.94031134153727
curr_Factors:  [102.94031134  -0.91510291  -1.04675416]
mat_Sqrt:  [[14.47310721  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00677818 -0.06452376 -0.08532516]
Stock Position:  -0.006778179774360094
Bond Position:  [2.3213119]


portfolio before change:  [1.61883924]
curr_Stock_Price:  103.68017100870343
curr_Factors:  [103.68017101  -0.88416677  -1.05192109]
mat_Sqrt:  [[14.95765209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01077672 0.21295062 0.2962852 ]
Stock Position:  0.010776724076175637
Bond Position:  [0.50150664]


portfolio before change:  [1.61623968]
curr_Stock_Price:  103.43313375881965
curr_Factors:  [103.43313376  -1.09884029  -1.04720067]
mat_Sqrt:  [[12.09611585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04519676 0.02004092 1.24339399]
Stock Position:  0.045196755362063586
Bond Position:  [-3.05860236]


portfolio before change:  [1.59159896]
curr_Stock_Price:  102.89640558868352
curr_Factors:  [102.89640559  -1.17905607  -1.08012956]
mat_Sqrt:  [[10.74603751  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.07022585 0.085541   1.46356105]
Stock Position:  0.07022585164725094
Bond Position:  [-5.63438876]


portfolio before change:  [1.58300033]
curr_Stock_Price:  102.78399275553842
curr_Factors:  [102.78399276  -1.32986384  -1.09379772]
mat_Sqrt:  [[ 9.10631439  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00865631 -0.04267193  0.11129176]
Stock Position:  -0.00865631148020588
Bond Position:  [2.47273059]


portfolio before change:  [1.57752411]
curr_Stock_Price:  103.45232927553968
curr_Factors:  [103.45232928  -1.13834693  -1.1153967 ]
mat_Sqrt:  [[10.86305179  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00414199 -0.00614324  0.22732531]
Stock Position:  -0.0041419913287711226
Bond Position:  [2.00602276]


portfolio before change:  [1.58047441]
curr_Stock_Price:  102.8005809114576
curr_Factors:  [102.80058091  -1.07848305  -1.11743724]
mat_Sqrt:  [[11.43719437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00133242 -0.01692891  0.15684667]
Stock Position:  0.0013324155652318032
Bond Position:  [1.44350132]


portfolio before change:  [1.58065885]
curr_Stock_Price:  102.80357341895997
curr_Factors:  [102.80357342  -1.17177836  -1.09226012]
mat_Sqrt:  [[10.68436685  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00149631  0.05630949 -0.27076855]
Stock Position:  0.0014963130986529482
Bond Position:  [1.42683252]


portfolio before change:  [1.58090549]
curr_Stock_Price:  102.84919868515145
curr_Factors:  [102.84919869  -1.12746505  -1.07092472]
mat_Sqrt:  [[11.41438104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02317565 -0.05046843 -0.48601065]
Stock Position:  0.023175651889575627
Bond Position:  [-0.80269174]


portfolio before change:  [1.58849051]
curr_Stock_Price:  103.18081259897663
curr_Factors:  [103.1808126   -0.97277178  -1.07867061]
mat_Sqrt:  [[13.2638266   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01585763 -0.03109266  0.34057138]
Stock Position:  -0.01585763154175015
Bond Position:  [3.22469382]


portfolio before change:  [1.59827597]
curr_Stock_Price:  102.58915128247962
curr_Factors:  [102.58915128  -0.73986176  -1.07761952]
mat_Sqrt:  [[16.66400341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00296777  0.00570505 -0.07260561]
Stock Position:  0.0029677664032563876
Bond Position:  [1.29381533]


portfolio before change:  [1.59999806]
curr_Stock_Price:  103.11491661599487
curr_Factors:  [103.11491662  -0.69211256  -1.11288034]
mat_Sqrt:  [[16.95989036  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00314839 -0.01823786  0.11026423]
Stock Position:  -0.0031483933402118676
Bond Position:  [1.92464437]


portfolio before change:  [1.59551375]
curr_Stock_Price:  104.61565107946788
curr_Factors:  [104.61565108  -0.67434996  -1.13668551]
mat_Sqrt:  [[17.10306534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00760336 -0.06528357  0.09068542]
Stock Position:  0.0076033557453451615
Bond Position:  [0.80008374]


portfolio before change:  [1.59963038]
curr_Stock_Price:  105.14392003390559
curr_Factors:  [105.14392003  -0.64245521  -1.1107057 ]
mat_Sqrt:  [[18.21361102  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.45467847e-03 -1.00373512e-03  1.01297350e+00]
Stock Position:  0.006454678466747103
Bond Position:  [0.92096019]


portfolio before change:  [1.60093441]
curr_Stock_Price:  105.32811173357253
curr_Factors:  [105.32811173  -0.58931114  -1.13616452]
mat_Sqrt:  [[18.75770673  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208404  0.17721034 -1.51833653]
Stock Position:  -0.0020840379028674856
Bond Position:  [1.82044219]


portfolio before change:  [1.60149901]
curr_Stock_Price:  105.1663918864281
curr_Factors:  [105.16639189  -0.50680058  -1.10098223]
mat_Sqrt:  [[21.06811934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01687581 0.05834859 0.208002  ]
Stock Position:  0.016875807840846076
Bond Position:  [-0.17326881]


portfolio before change:  [1.60746541]
curr_Stock_Price:  105.5212232383882
curr_Factors:  [105.52122324  -0.48056527  -1.11673704]
mat_Sqrt:  [[21.3619178   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00443779  0.05354266 -0.22573028]
Stock Position:  -0.004437790474112817
Bond Position:  [2.07574649]


portfolio before change:  [1.60361241]
curr_Stock_Price:  106.44792149856742
curr_Factors:  [106.4479215   -0.37918777  -1.09992803]
mat_Sqrt:  [[24.25299384  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00372714 -0.03925972 -0.06246256]
Stock Position:  -0.0037271436496843008
Bond Position:  [2.0003591]


portfolio before change:  [1.59997096]
curr_Stock_Price:  107.49202125756455
curr_Factors:  [107.49202126  -0.49140901  -1.10799514]
mat_Sqrt:  [[21.71520004  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149687 -0.01215606 -0.01403759]
Stock Position:  -0.0014968746080382964
Bond Position:  [1.76087303]


portfolio before change:  [1.60248098]
curr_Stock_Price:  105.96223589883984
curr_Factors:  [105.9622359   -0.43883657  -1.10916466]
mat_Sqrt:  [[22.53526768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00017043 0.00610875 0.03280124]
Stock Position:  0.00017043029358500213
Bond Position:  [1.5844218]


portfolio before change:  [1.60272383]
curr_Stock_Price:  106.22505368685633
curr_Factors:  [106.22505369  -0.53593099  -1.10379431]
mat_Sqrt:  [[20.61120142  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00542838 -0.00533859  0.36737142]
Stock Position:  0.005428381499486544
Bond Position:  [1.02609372]


portfolio before change:  [1.59517946]
curr_Stock_Price:  104.81162277473287
curr_Factors:  [104.81162277  -0.66123652  -1.11272975]
mat_Sqrt:  [[17.78220788  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01107402 -0.01757091  0.58872201]
Stock Position:  0.0110740186198385
Bond Position:  [0.4344936]


portfolio before change:  [1.59955174]
curr_Stock_Price:  105.20154106428231
curr_Factors:  [105.20154106  -0.89250275  -1.15573743]
mat_Sqrt:  [[13.56696474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00396194  0.00199767 -0.20865372]
Stock Position:  -0.00396194041790658
Bond Position:  [2.01635398]


portfolio before change:  [1.60069612]
curr_Stock_Price:  104.9763174532424
curr_Factors:  [104.97631745  -0.74162082  -1.1579552 ]
mat_Sqrt:  [[15.70782132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00342948 -0.00438729  0.11613085]
Stock Position:  -0.0034294764045517756
Bond Position:  [1.96070993]


portfolio before change:  [1.59950742]
curr_Stock_Price:  105.394401111954
curr_Factors:  [105.39440111  -0.73786263  -1.13701125]
mat_Sqrt:  [[16.16479345  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090219 -0.01053316 -0.03478127]
Stock Position:  0.0009021862475367644
Bond Position:  [1.50442204]


portfolio before change:  [1.59944374]
curr_Stock_Price:  105.11536225912114
curr_Factors:  [105.11536226  -0.69117501  -1.14622517]
mat_Sqrt:  [[16.73760938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00097263 -0.02222085 -0.40167444]
Stock Position:  -0.0009726341793857245
Bond Position:  [1.70168253]


portfolio before change:  [1.59878024]
curr_Stock_Price:  106.01623766736367
curr_Factors:  [106.01623767  -0.83438398  -1.14448581]
mat_Sqrt:  [[14.65413405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [6.23193197e-03 4.01957562e-04 4.05301318e-01]
Stock Position:  0.006231931973617254
Bond Position:  [0.93809426]


portfolio before change:  [1.60713843]
curr_Stock_Price:  107.33860821623662
curr_Factors:  [107.33860822  -0.80889223  -1.15897773]
mat_Sqrt:  [[15.00102374  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00570365 -0.03467804 -0.77178719]
Stock Position:  -0.0057036450360421955
Bond Position:  [2.21935975]


portfolio before change:  [1.60460977]
curr_Stock_Price:  107.83059085107112
curr_Factors:  [107.83059085  -0.84692581  -1.1669232 ]
mat_Sqrt:  [[14.39257401  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00770334  0.10211838 -0.36239326]
Stock Position:  0.007703341895139849
Bond Position:  [0.77395387]


portfolio before change:  [1.59760717]
curr_Stock_Price:  106.90899660736055
curr_Factors:  [106.90899661  -0.86665811  -1.15888908]
mat_Sqrt:  [[14.10360987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00222795 -0.00776776  0.04799803]
Stock Position:  -0.002227951492292925
Bond Position:  [1.83579523]


portfolio before change:  [1.59827855]
curr_Stock_Price:  106.71065602335415
curr_Factors:  [106.71065602  -1.00791557  -1.1716348 ]
mat_Sqrt:  [[12.0681608   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03839132 -0.08789425  0.85049759]
Stock Position:  0.03839131779799556
Bond Position:  [-2.49848416]


portfolio before change:  [1.58151886]
curr_Stock_Price:  106.28224242473068
curr_Factors:  [106.28224242  -1.14598381  -1.17690148]
mat_Sqrt:  [[10.41464441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00931839  0.01580256  0.13836223]
Stock Position:  -0.009318391022911125
Bond Position:  [2.57189835]


portfolio before change:  [1.58664784]
curr_Stock_Price:  105.7663302420377
curr_Factors:  [105.76633024  -1.3055478   -1.18727022]
mat_Sqrt:  [[ 8.74440624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0244092  -0.00411182  0.25953513]
Stock Position:  0.024409203801517735
Bond Position:  [-0.99502407]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.589723]
Stock Price:  105.8974097514219
PL:  [-4.30768675]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.64892599e-02 -7.95303354e-02  1.19370370e-02]
 [-2.23712182e-01  9.35598629e-02 -3.92521851e-01]
 [-3.03356014e-02  4.06859722e-02  2.50181659e-02]
 [ 1.19803724e-01  3.50505096e-02  1.41361072e-01]
 [ 1.55007662e-01 -1.56057410e-01 -1.01617480e-01]
 [-1.29542151e-01 -1.69469764e-01  6.58223774e-02]
 [-5.57255361e-02 -1.64357583e-01  3.22642024e-02]
 [ 1.10038748e-02  6.28348247e-01  9.12360738e-02]
 [ 1.40413686e-01  1.36890986e-02  1.55045931e-01]
 [ 3.99747323e-01  1.60606346e-01  2.74342979e-01]
 [-1.71161673e-01 -2.54005076e-01 -1.83919867e-03]
 [ 6.14655074e-02 -1.10841911e-02  1.23941735e-01]
 [ 1.18638211e-02 -3.00697499e-02  3.42311772e-02]
 [ 8.60833558e-03 -8.46859838e-02  2.03331593e-02]
 [ 3.72724648e-02 -5.76154523e-02 -7.42100959e-02]
 [ 8.32076086e-02 -8.72174446e-03  9.18822097e-03]
 [ 4.37414531e-02  3.07789686e-02  1.72473321e-02]
 [-3.71421248e-02 -4.90491475e-02  5.66060472e-02]
 [ 6.48832321e-02 -2.57186396e-02 -1.05725953e-01]
 [ 4.81405816e-02 -1.39779128e-02  1.53488229e-01]
 [-6.94849670e-03  2.74166376e-01 -2.33229244e-01]
 [-1.74314240e-03  1.13818775e-02 -1.90896899e-02]
 [-1.48615765e-02  2.22660612e-02  3.56761854e-02]
 [ 2.32786572e-01 -2.68642744e-01 -4.97243676e-01]
 [ 8.26147539e-02  5.16748818e-02 -1.72304854e-02]
 [-2.38587835e-02  1.27317975e-02  6.07116058e-02]
 [ 6.21400231e-02 -3.23320743e-02  2.24948606e-02]
 [ 1.44452528e-01 -6.91076624e-02  8.43253102e-02]
 [-4.76152153e-02 -2.51491755e-02 -1.26423853e-02]
 [-5.51284261e-02 -1.05640022e-02  2.92099475e-02]
 [-2.50911815e-02 -4.28197841e-02 -1.19699984e-02]
 [ 2.59485821e-02 -3.08324368e-03 -3.60401309e-02]
 [ 3.68220199e-02  5.62482418e-03  1.49422387e-01]
 [ 7.04657697e-03 -7.78976178e-02 -6.59841807e-02]
 [ 1.11536120e-02  4.32682624e-02  9.66061194e-04]
 [ 4.61257990e-02  3.20808064e-02  1.44905892e-01]
 [ 2.26552886e-01 -1.62941344e-01  1.08564337e-01]
 [-5.24904296e-02  8.06843840e-04  2.65511942e-02]
 [ 9.11486296e-02  7.89705602e-03  1.06102725e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.96234819]
curr_Stock_Price:  100.0716939716614
curr_Factors:  [100.07169397  -1.23570421  -1.0015873 ]
mat_Sqrt:  [[10.68237684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0028352  -0.02566831  0.03405304]
Stock Position:  -0.0028352008735568687
Bond Position:  [3.24607155]


portfolio before change:  [2.96301475]
curr_Stock_Price:  99.97971603860904
curr_Factors:  [99.97971604 -1.2035081  -1.01975798]
mat_Sqrt:  [[10.82330034  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02630783  0.03019632 -1.11975558]
Stock Position:  -0.026307829745609346
Bond Position:  [5.5932641]


portfolio before change:  [2.95863212]
curr_Stock_Price:  100.17288430446939
curr_Factors:  [100.1728843   -1.22383607  -1.0117844 ]
mat_Sqrt:  [[10.71106236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00158003  0.01313134  0.07136986]
Stock Position:  -0.001580030045725223
Bond Position:  [3.11690828]


portfolio before change:  [2.95941102]
curr_Stock_Price:  99.9265172915499
curr_Factors:  [99.92651729 -1.02969262 -0.98940061]
mat_Sqrt:  [[13.26782411  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01174372 0.0113125  0.40326379]
Stock Position:  0.011743718201472172
Bond Position:  [1.78590216]


portfolio before change:  [2.97311773]
curr_Stock_Price:  101.07465907859986
curr_Factors:  [101.07465908  -1.23585255  -1.00556342]
mat_Sqrt:  [[10.74503162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00953092 -0.05036731 -0.28988638]
Stock Position:  0.009530916178662271
Bond Position:  [2.00978362]


portfolio before change:  [2.97030586]
curr_Stock_Price:  100.75327289134805
curr_Factors:  [100.75327289  -1.18297022  -1.03278361]
mat_Sqrt:  [[10.98928668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01371327 -0.05469613  0.18777292]
Stock Position:  -0.01371327275391833
Bond Position:  [4.35196297]


portfolio before change:  [2.97523228]
curr_Stock_Price:  100.43369986789735
curr_Factors:  [100.43369987  -1.260398    -1.0086734 ]
mat_Sqrt:  [[10.38566419  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00796184 -0.05304618  0.09204079]
Stock Position:  -0.00796183884470213
Bond Position:  [3.77486921]


portfolio before change:  [2.96599591]
curr_Stock_Price:  101.65304832520722
curr_Factors:  [101.65304833  -1.22878119  -1.01560709]
mat_Sqrt:  [[10.77444637  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01465397 0.20279852 0.26027112]
Stock Position:  0.01465396957133355
Bond Position:  [1.47637524]


portfolio before change:  [2.95616959]
curr_Stock_Price:  100.96989698088694
curr_Factors:  [100.96989698  -1.461769    -0.98632887]
mat_Sqrt:  [[ 8.72964364  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02003021 0.00441814 0.44230289]
Stock Position:  0.02003020822667477
Bond Position:  [0.93372153]


portfolio before change:  [2.95544175]
curr_Stock_Price:  100.92773234959422
curr_Factors:  [100.92773235  -1.44611392  -0.97465639]
mat_Sqrt:  [[ 8.96774657  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05447645 0.05183548 0.78262416]
Stock Position:  0.054476448235833745
Bond Position:  [-2.54274264]


portfolio before change:  [2.92323136]
curr_Stock_Price:  100.34229529486079
curr_Factors:  [100.34229529  -1.46440454  -0.93029107]
mat_Sqrt:  [[ 9.15126097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02441037 -0.08197979 -0.00524672]
Stock Position:  -0.024410370085076127
Bond Position:  [5.37262392]


portfolio before change:  [2.91291205]
curr_Stock_Price:  100.79255151845467
curr_Factors:  [100.79255152  -1.41780544  -0.91343791]
mat_Sqrt:  [[ 9.79450109  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00862754 -0.00357741  0.35357127]
Stock Position:  0.00862754073950434
Bond Position:  [2.04332021]


portfolio before change:  [2.91367449]
curr_Stock_Price:  100.85131785346785
curr_Factors:  [100.85131785  -1.49443421  -0.89814748]
mat_Sqrt:  [[ 9.21714778  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00137931 -0.00970497  0.09765202]
Stock Position:  0.0013793061779099048
Bond Position:  [2.77456965]


portfolio before change:  [2.91367476]
curr_Stock_Price:  100.60005064372669
curr_Factors:  [100.60005064  -1.41050161  -0.89066895]
mat_Sqrt:  [[10.0742453   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044943 -0.02733228  0.05800484]
Stock Position:  -0.00044942619319513475
Bond Position:  [2.95888706]


portfolio before change:  [2.91430761]
curr_Stock_Price:  100.01493668075031
curr_Factors:  [100.01493668  -1.54762164  -0.87991297]
mat_Sqrt:  [[ 8.82673274  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00117412 -0.01859531 -0.21170075]
Stock Position:  0.0011741249834120965
Bond Position:  [2.79687758]


portfolio before change:  [2.91531603]
curr_Stock_Price:  100.57602398793033
curr_Factors:  [100.57602399  -1.64556241  -0.87563514]
mat_Sqrt:  [[ 8.0826222   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01030641 -0.00281493  0.02621144]
Stock Position:  0.010306411164407442
Bond Position:  [1.87873817]


portfolio before change:  [2.9189247]
curr_Stock_Price:  100.90337449406002
curr_Factors:  [100.90337449  -1.68692333  -0.86479588]
mat_Sqrt:  [[ 7.8651701   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00680784 0.00993387 0.04920184]
Stock Position:  0.0068078350498713735
Bond Position:  [2.23199117]


portfolio before change:  [2.91798885]
curr_Stock_Price:  100.72492420459652
curr_Factors:  [100.7249242   -1.69045067  -0.85873667]
mat_Sqrt:  [[ 7.87116387  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00452278 -0.01583054  0.1614813 ]
Stock Position:  -0.0045227846401967396
Bond Position:  [3.37354599]


portfolio before change:  [2.9209552]
curr_Stock_Price:  100.16230038402577
curr_Factors:  [100.16230038  -1.5191327   -0.85581551]
mat_Sqrt:  [[ 9.31702772  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00408416 -0.00830066 -0.30160672]
Stock Position:  0.004084158387866324
Bond Position:  [2.5118765]


portfolio before change:  [2.92160652]
curr_Stock_Price:  100.24489154958982
curr_Factors:  [100.24489155  -1.68665203  -0.86546495]
mat_Sqrt:  [[ 7.8107354   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00980932 -0.00451135  0.43785919]
Stock Position:  0.009809320335924673
Bond Position:  [1.93827226]


portfolio before change:  [2.92482812]
curr_Stock_Price:  100.5486133611377
curr_Factors:  [100.54861336  -2.02618957  -0.861333  ]
mat_Sqrt:  [[ 5.60197247  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.51297265e-04  8.84868175e-02 -6.65338116e-01]
Stock Position:  0.00025129726485488454
Bond Position:  [2.89956053]


portfolio before change:  [2.92517435]
curr_Stock_Price:  100.48399443551752
curr_Factors:  [100.48399444  -1.90372293  -0.84917635]
mat_Sqrt:  [[ 6.40512963  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051779  0.00367349 -0.05445757]
Stock Position:  -0.0005177870251374305
Bond Position:  [2.97720366]


portfolio before change:  [2.92541596]
curr_Stock_Price:  100.7361512100496
curr_Factors:  [100.73615121  -2.00945721  -0.85382903]
mat_Sqrt:  [[ 5.75010715  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052767  0.00718634  0.10177423]
Stock Position:  -0.0005276710275560668
Bond Position:  [2.97857151]


portfolio before change:  [2.92549286]
curr_Stock_Price:  101.29606141912399
curr_Factors:  [101.29606142  -2.24701637  -0.86153692]
mat_Sqrt:  [[ 4.52444194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01689726 -0.08670407 -1.4184978 ]
Stock Position:  0.01689725754952643
Bond Position:  [1.21386722]


portfolio before change:  [2.92864587]
curr_Stock_Price:  101.4736802406507
curr_Factors:  [101.47368024  -2.15524387  -0.87275811]
mat_Sqrt:  [[ 4.91257124  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01824822  0.016678   -0.04915378]
Stock Position:  0.01824822125831641
Bond Position:  [1.0769317]


portfolio before change:  [2.93051992]
curr_Stock_Price:  101.56900034384707
curr_Factors:  [101.56900034  -2.11651944  -0.87381567]
mat_Sqrt:  [[ 5.1059333   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00173665  0.00410917  0.17319331]
Stock Position:  -0.001736648541635908
Bond Position:  [3.10690957]


portfolio before change:  [2.9303149]
curr_Stock_Price:  101.9106949873852
curr_Factors:  [101.91069499  -1.96269448  -0.89295202]
mat_Sqrt:  [[ 5.86176289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01025835 -0.01043513  0.06417158]
Stock Position:  0.010258349134479974
Bond Position:  [1.88487941]


portfolio before change:  [2.93398361]
curr_Stock_Price:  102.24535715641905
curr_Factors:  [102.24535716  -1.83000983  -0.89708492]
mat_Sqrt:  [[ 6.687771    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02206398 -0.0223044   0.24055664]
Stock Position:  0.022063975773403095
Bond Position:  [0.67804453]


portfolio before change:  [2.93198247]
curr_Stock_Price:  102.15081840973453
curr_Factors:  [102.15081841  -1.86259373  -0.92417354]
mat_Sqrt:  [[ 6.29454295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00879006 -0.00811686 -0.03606521]
Stock Position:  -0.008790056053648005
Bond Position:  [3.82989389]


portfolio before change:  [2.93199337]
curr_Stock_Price:  102.2040450970736
curr_Factors:  [102.2040451   -1.50096661  -0.90887144]
mat_Sqrt:  [[ 9.18097321  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00559008 -0.00340952  0.08332785]
Stock Position:  -0.005590076050799643
Bond Position:  [3.50332175]


portfolio before change:  [2.93639373]
curr_Stock_Price:  101.4952138564628
curr_Factors:  [101.49521386  -1.6085121   -0.89424108]
mat_Sqrt:  [[ 8.30832866  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00436611 -0.01382003 -0.03414707]
Stock Position:  -0.00436611266996221
Bond Position:  [3.37953327]


portfolio before change:  [2.937058]
curr_Stock_Price:  101.43983299988871
curr_Factors:  [101.439833    -1.23757404  -0.86072204]
mat_Sqrt:  [[12.44314376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144357 -0.00099511 -0.10281246]
Stock Position:  0.0014435706137958608
Bond Position:  [2.79062244]


portfolio before change:  [2.93960239]
curr_Stock_Price:  102.9607448896267
curr_Factors:  [102.96074489  -1.42727226  -0.8429203 ]
mat_Sqrt:  [[10.63505084  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00643823 0.0018154  0.42626048]
Stock Position:  0.006438229636056797
Bond Position:  [2.27671747]


portfolio before change:  [2.94182948]
curr_Stock_Price:  103.26245499762517
curr_Factors:  [103.262455    -1.63466448  -0.83265277]
mat_Sqrt:  [[ 8.75790399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254892 -0.02514135 -0.1882345 ]
Stock Position:  -0.002548917206013261
Bond Position:  [3.20503693]


portfolio before change:  [2.94137742]
curr_Stock_Price:  103.59699363689839
curr_Factors:  [103.59699364  -1.58534168  -0.822659  ]
mat_Sqrt:  [[ 9.32321601  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0021648  0.01396477 0.0027559 ]
Stock Position:  0.0021648007976591654
Bond Position:  [2.71711057]


portfolio before change:  [2.94170404]
curr_Stock_Price:  103.59096981836872
curr_Factors:  [103.59096982  -1.3633743   -0.83672612]
mat_Sqrt:  [[11.4770541   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00716674 0.01035404 0.41337618]
Stock Position:  0.007166739543248581
Bond Position:  [2.19929454]


portfolio before change:  [2.94142238]
curr_Stock_Price:  103.51330662497739
curr_Factors:  [103.51330662  -1.27596112  -0.8618461 ]
mat_Sqrt:  [[12.20557666  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01765203 -0.05258909  0.30970383]
Stock Position:  0.017652031704198122
Bond Position:  [1.11420221]


portfolio before change:  [2.92460681]
curr_Stock_Price:  102.55280197234309
curr_Factors:  [102.55280197  -1.4158365   -0.84917703]
mat_Sqrt:  [[10.6479169   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00440518  0.00026041  0.07574317]
Stock Position:  -0.004405180272029562
Bond Position:  [3.37637039]


portfolio before change:  [2.92842604]
curr_Stock_Price:  101.78162768744896
curr_Factors:  [101.78162769  -1.29627271  -0.83944052]
mat_Sqrt:  [[12.02654609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00951385 0.00254876 0.30268154]
Stock Position:  0.009513848494102793
Bond Position:  [1.96009105]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.93350857]
Stock Price:  102.29009773333435
PL:  [0.64341084]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.26147827e-01 -9.34426759e-02  1.62182902e-02]
 [-7.51929190e-02  7.31075410e-02 -6.89291636e-02]
 [-6.66740328e-02 -2.14240290e-02 -1.77181680e-02]
 [-4.81054895e-01 -2.17037145e-01 -2.97918292e-01]
 [ 2.13962007e-01 -2.20476280e-01 -1.05036118e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.18860533e-02 -1.88863046e-01 -2.78982500e-02]
 [ 9.79556753e-03  6.87175357e-01  9.97873706e-02]
 [ 4.37421271e-01  5.88010563e-02  4.26254778e-01]
 [ 5.63020817e-01  2.38866780e-01  4.45026961e-01]
 [-1.25491678e-01 -1.56494431e-01  4.62874521e-02]
 [-4.90838008e-02 -1.92685958e-02  8.54982745e-02]
 [ 1.00316290e-02 -5.85695713e-02  1.11518316e-01]
 [ 2.91097465e-03  1.24790377e-01 -1.79341808e-01]
 [ 4.05739072e-01 -1.24272893e-01 -2.07700338e-01]
 [-1.68808178e-01 -9.39004935e-02  1.10043988e-01]
 [ 5.16040089e-02  1.66676298e-02 -2.87389138e-02]
 [-6.51811290e-02 -6.56347921e-02  1.66833835e-02]
 [ 1.92344835e-01 -2.41335624e-01  6.63026035e-02]
 [ 4.51032326e-02 -3.65463098e-03  3.44183406e-01]
 [-3.46852816e-02  4.94078521e-01 -4.77211942e-01]
 [ 2.12324801e-01  1.37037341e-01  8.78023310e-02]
 [ 1.65407971e-02  1.31804108e-01 -3.41687006e-02]
 [-2.36569975e-02 -1.51552091e-01 -7.27620354e-02]
 [ 3.05699802e-02 -2.03011593e-02 -1.10392855e-02]
 [-1.47590782e-02  1.52296967e-02  4.19899708e-02]
 [ 8.85719144e-02 -2.11223125e-02  9.26771104e-02]
 [ 1.69200954e-01 -5.16844617e-02  2.26524836e-01]
 [-2.83928412e-02  2.90851445e-02 -1.12582468e-01]
 [-6.61991498e-02  1.67085317e-02  6.28336665e-03]
 [ 9.75894873e-02 -1.54413036e-03  1.86159608e-02]
 [ 2.69842616e-02 -1.23204490e-01 -2.27392028e-01]
 [ 8.66857140e-02 -4.49030335e-03  1.35709465e-01]
 [-1.20238696e-02 -1.14369721e-01 -3.18476443e-01]
 [ 8.73040737e-02  3.70688428e-01 -1.65817709e-01]
 [-5.04812610e-02 -1.82328814e-02 -1.92596509e-02]
 [ 5.75486077e-01 -3.18459961e-01  4.13669715e-01]
 [-1.34095985e-01  7.08426498e-02  5.09188460e-02]
 [ 2.66528444e-01 -2.69165176e-02  7.06518166e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.36021948]
curr_Stock_Price:  100.24792702241758
curr_Factors:  [100.24792702  -0.89051826  -1.0213698 ]
mat_Sqrt:  [[14.81675046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00957775 -0.03015849  0.04626627]
Stock Position:  -0.00957775387571417
Bond Position:  [5.32036945]


portfolio before change:  [4.35278647]
curr_Stock_Price:  101.09343750875009
curr_Factors:  [101.09343751  -0.79612483  -1.03879799]
mat_Sqrt:  [[16.13712307  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460677  0.02359536 -0.19663572]
Stock Position:  -0.004606769804151151
Bond Position:  [4.81850067]


portfolio before change:  [4.34931192]
curr_Stock_Price:  101.97841860555623
curr_Factors:  [101.97841861  -1.01780696  -1.0596442 ]
mat_Sqrt:  [[12.77269966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00584558 -0.00691458 -0.050545  ]
Stock Position:  -0.005845584902080624
Bond Position:  [4.94543542]


portfolio before change:  [4.34876048]
curr_Stock_Price:  102.17851159098764
curr_Factors:  [102.17851159  -1.04620255  -1.09636842]
mat_Sqrt:  [[11.99092873  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04888443 -0.07004844 -0.84987796]
Stock Position:  -0.04888443147513022
Bond Position:  [9.34369892]


portfolio before change:  [4.34851695]
curr_Stock_Price:  102.20738706923943
curr_Factors:  [102.20738707  -1.00094371  -1.09041635]
mat_Sqrt:  [[12.62455713  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01168493 -0.07115841 -0.29963881]
Stock Position:  0.011684930091552505
Bond Position:  [3.15423078]


portfolio before change:  [4.35036903]
curr_Stock_Price:  102.33214409114976
curr_Factors:  [102.33214409  -0.98923442  -1.10670485]
mat_Sqrt:  [[12.58221834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01218419 -0.05534923  0.15513819]
Stock Position:  -0.012184194556292305
Bond Position:  [5.59720378]


portfolio before change:  [4.35565566]
curr_Stock_Price:  101.95567815522777
curr_Factors:  [101.95567816  -0.91764826  -1.08869477]
mat_Sqrt:  [[13.71095508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00701135 -0.06095529 -0.07958594]
Stock Position:  -0.007011347275281859
Bond Position:  [5.07050233]


portfolio before change:  [4.35883812]
curr_Stock_Price:  101.59218050009174
curr_Factors:  [101.5921805   -0.74691723  -1.09233207]
mat_Sqrt:  [[16.14672532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01055531 0.22178489 0.28466559]
Stock Position:  0.010555308168540178
Bond Position:  [3.28650135]


portfolio before change:  [4.3692107]
curr_Stock_Price:  102.53594623737618
curr_Factors:  [102.53594624  -0.89844654  -1.08604561]
mat_Sqrt:  [[14.09360684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03806214 0.01897796 1.21598624]
Stock Position:  0.03806214297206505
Bond Position:  [0.46647285]


portfolio before change:  [4.34726057]
curr_Stock_Price:  101.95772239945902
curr_Factors:  [101.9577224   -0.85854775  -1.08106407]
mat_Sqrt:  [[14.65741612  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04793615 0.07709392 1.26953805]
Stock Position:  0.04793614624511131
Bond Position:  [-0.54019972]


portfolio before change:  [4.35440638]
curr_Stock_Price:  102.10820055287475
curr_Factors:  [102.10820055  -0.92281918  -1.06511163]
mat_Sqrt:  [[13.98663492  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01058064 -0.05050836  0.13204522]
Stock Position:  -0.010580642491407291
Bond Position:  [5.43477675]


portfolio before change:  [4.34785889]
curr_Stock_Price:  102.79122930387896
curr_Factors:  [102.7912293   -0.8312045   -1.05311953]
mat_Sqrt:  [[15.61724901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227727 -0.00621891  0.24390278]
Stock Position:  -0.002277272020881427
Bond Position:  [4.58194248]


portfolio before change:  [4.35107535]
curr_Stock_Price:  101.63032917590795
curr_Factors:  [101.63032918  -0.66532325  -1.04611178]
mat_Sqrt:  [[18.35509112  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00113537 -0.01890325  0.31813071]
Stock Position:  0.0011353659893238598
Bond Position:  [4.23568774]


portfolio before change:  [4.35255936]
curr_Stock_Price:  102.47103883671436
curr_Factors:  [102.47103884  -0.70284146  -1.06405806]
mat_Sqrt:  [[17.50839866  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.69733968e-04  4.02759209e-02 -5.11612258e-01]
Stock Position:  -0.0004697339678456221
Bond Position:  [4.40069349]


portfolio before change:  [4.35266575]
curr_Stock_Price:  103.41569647931166
curr_Factors:  [103.41569648  -0.54230337  -1.0731215 ]
mat_Sqrt:  [[20.5596801   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01643874 -0.0401089  -0.59251125]
Stock Position:  0.016438744095803464
Bond Position:  [2.65264158]


portfolio before change:  [4.39068255]
curr_Stock_Price:  105.70815865914986
curr_Factors:  [105.70815866  -0.47822148  -1.0826277 ]
mat_Sqrt:  [[22.1942423   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00745747 -0.03030625  0.31392487]
Stock Position:  -0.007457470240396722
Bond Position:  [5.17899799]


portfolio before change:  [4.38971417]
curr_Stock_Price:  105.92482543870298
curr_Factors:  [105.92482544  -0.29932842  -1.09456666]
mat_Sqrt:  [[26.28069326  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186981  0.00537945 -0.08198412]
Stock Position:  0.0018698124864592383
Bond Position:  [4.19165461]


portfolio before change:  [4.39046249]
curr_Stock_Price:  106.04479915447737
curr_Factors:  [106.04479915  -0.35286767  -1.07603205]
mat_Sqrt:  [[25.40540411  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295895 -0.02118354  0.04759305]
Stock Position:  -0.0029589489340886926
Bond Position:  [4.70424364]


portfolio before change:  [4.39231691]
curr_Stock_Price:  105.61682687259504
curr_Factors:  [105.61682687  -0.42158632  -1.07566155]
mat_Sqrt:  [[23.63124647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00662751 -0.07789074  0.18914287]
Stock Position:  0.006627512009655585
Bond Position:  [3.69234012]


portfolio before change:  [4.38872713]
curr_Stock_Price:  105.00553436066369
curr_Factors:  [105.00553436  -0.62153675  -1.07444821]
mat_Sqrt:  [[19.25995551  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00595086 -0.00117953  0.98185946]
Stock Position:  0.005950864097604889
Bond Position:  [3.76385347]


portfolio before change:  [4.38799338]
curr_Stock_Price:  104.80316599965771
curr_Factors:  [104.803166    -0.78423313  -1.09925856]
mat_Sqrt:  [[15.93618478  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196047  0.15946316 -1.36135284]
Stock Position:  -0.0019604695836545447
Bond Position:  [4.59345679]


portfolio before change:  [4.39152445]
curr_Stock_Price:  103.29492913064834
curr_Factors:  [103.29492913  -0.71255669  -1.12124701]
mat_Sqrt:  [[16.50700093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01564306 0.04422861 0.25047561]
Stock Position:  0.015643060077529792
Bond Position:  [2.77567566]


portfolio before change:  [4.38311036]
curr_Stock_Price:  102.73486788384547
curr_Factors:  [102.73486788  -0.5355219   -1.13386073]
mat_Sqrt:  [[19.35148084  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00188464  0.04253959 -0.09747379]
Stock Position:  0.0018846382544138115
Bond Position:  [4.18949229]


portfolio before change:  [4.38475387]
curr_Stock_Price:  103.3290405782083
curr_Factors:  [103.32904058  -0.7403342   -1.10876508]
mat_Sqrt:  [[16.26180623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00427043 -0.04891323 -0.20756983]
Stock Position:  -0.004270431333426617
Bond Position:  [4.82601345]


portfolio before change:  [4.38206228]
curr_Stock_Price:  104.10059757577258
curr_Factors:  [104.10059758  -0.77032178  -1.09692802]
mat_Sqrt:  [[16.08855112  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00150247 -0.00655217 -0.03149201]
Stock Position:  0.0015024745583165017
Bond Position:  [4.22565378]


portfolio before change:  [4.38283935]
curr_Stock_Price:  104.26620765944413
curr_Factors:  [104.26620766  -0.62024462  -1.07369401]
mat_Sqrt:  [[19.16352408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00016068  0.00491536  0.1197857 ]
Stock Position:  -0.00016067829932827582
Bond Position:  [4.39959266]


portfolio before change:  [4.38322865]
curr_Stock_Price:  105.26619757993743
curr_Factors:  [105.26619758  -0.60981045  -1.10071403]
mat_Sqrt:  [[19.02907131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00542212 -0.0068172   0.264382  ]
Stock Position:  0.005422123586504049
Bond Position:  [3.81246232]


portfolio before change:  [4.38726812]
curr_Stock_Price:  105.92329766663708
curr_Factors:  [105.92329767  -0.69969283  -1.08614831]
mat_Sqrt:  [[17.75867423  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01153747 -0.01668109  0.64621231]
Stock Position:  0.011537465763512155
Bond Position:  [3.1651817]


portfolio before change:  [4.40582607]
curr_Stock_Price:  107.49749730473577
curr_Factors:  [107.4974973   -0.85840431  -1.11320838]
mat_Sqrt:  [[14.96710618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303577  0.00938719 -0.32116645]
Stock Position:  -0.00303576793284927
Bond Position:  [4.73216352]


portfolio before change:  [4.40399509]
curr_Stock_Price:  108.29549319537301
curr_Factors:  [108.2954932   -0.73434145  -1.10817278]
mat_Sqrt:  [[17.15602299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00358509  0.00539266  0.0179247 ]
Stock Position:  -0.00358509359809962
Bond Position:  [4.79224457]


portfolio before change:  [4.40341883]
curr_Stock_Price:  108.62333193635938
curr_Factors:  [108.62333194  -0.83146204  -1.0994481 ]
mat_Sqrt:  [[15.75213775  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00641654 -0.00049837  0.05310615]
Stock Position:  0.0064165424206975505
Bond Position:  [3.70643261]


portfolio before change:  [4.40593888]
curr_Stock_Price:  108.94386528132587
curr_Factors:  [108.94386528  -0.73702648  -1.0891525 ]
mat_Sqrt:  [[17.54297833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254124 -0.03976408 -0.64868616]
Stock Position:  -0.0025412419798192484
Bond Position:  [4.6827916]


portfolio before change:  [4.40703526]
curr_Stock_Price:  108.74278324285817
curr_Factors:  [108.74278324  -0.9104874   -1.10534661]
mat_Sqrt:  [[14.48554552  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00783338 -0.00144924  0.38714133]
Stock Position:  0.007833375208855476
Bond Position:  [3.55521224]


portfolio before change:  [4.40628173]
curr_Stock_Price:  108.5898534253451
curr_Factors:  [108.58985343  -1.06035386  -1.12010515]
mat_Sqrt:  [[12.26953013  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0081811  -0.03691267 -0.90852465]
Stock Position:  -0.00818109755555249
Bond Position:  [5.29466592]


portfolio before change:  [4.40450081]
curr_Stock_Price:  108.88844401889247
curr_Factors:  [108.88844402  -0.87837943  -1.11822906]
mat_Sqrt:  [[14.78651201  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00873249  0.11963918 -0.47303177]
Stock Position:  0.00873249444830861
Bond Position:  [3.45363308]


portfolio before change:  [4.40719929]
curr_Stock_Price:  109.1480201129647
curr_Factors:  [109.14802011  -0.90664253  -1.11899498]
mat_Sqrt:  [[14.39768506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00403776 -0.00588464 -0.05494242]
Stock Position:  -0.004037759674510488
Bond Position:  [4.84791276]


portfolio before change:  [4.40669753]
curr_Stock_Price:  109.42237638434625
curr_Factors:  [109.42237638  -1.12946355  -1.1164746 ]
mat_Sqrt:  [[11.57997427  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05137496 -0.10278251  1.18008455]
Stock Position:  0.05137495753809719
Bond Position:  [-1.21487241]


portfolio before change:  [4.36241956]
curr_Stock_Price:  108.56347338709851
curr_Factors:  [108.56347339  -1.29546615  -1.11743542]
mat_Sqrt:  [[ 9.72240917  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01123605  0.02286437  0.14525729]
Stock Position:  -0.01123605499699117
Bond Position:  [5.58224471]


portfolio before change:  [4.35996295]
curr_Stock_Price:  108.84421550977439
curr_Factors:  [108.84421551  -1.48272122  -1.11298925]
mat_Sqrt:  [[ 8.11900152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03392731 -0.00868727  0.20154997]
Stock Position:  0.03392730913501934
Bond Position:  [0.6671716]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.36691753]
Stock Price:  109.04674220193525
PL:  [-4.67982467]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.11601791e-01 -9.15972258e-02  1.56503887e-02]
 [-4.66819409e-02  5.71388005e-02 -5.26301799e-02]
 [ 1.22736428e-02 -6.50220802e-03  5.44334162e-02]
 [-7.93363066e-02 -4.83774736e-02 -3.45338063e-02]
 [ 1.63540974e-01 -1.70928100e-01 -1.04061765e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-6.07227099e-02 -1.77054819e-01  1.00238629e-01]
 [-4.90327477e-02  8.37997004e-01  1.98197861e-01]
 [ 3.30791123e-02 -1.17248798e-01  9.48020286e-03]
 [ 3.53689111e-01  1.32917004e-01  2.08080861e-01]
 [-2.39939266e-01 -2.58728951e-01  1.58401690e-02]
 [-1.09028851e-01 -2.04832918e-02  8.34967079e-02]
 [-2.70328452e-02  1.35110219e-01 -3.39735383e-02]
 [ 6.11472992e-03 -4.60842774e-02  6.15040565e-02]
 [ 6.24139954e-02 -2.74788895e-02 -9.03529843e-02]
 [ 3.03679514e-03 -3.15046913e-02  6.86647619e-02]
 [ 5.10458554e-02  1.76693770e-02 -2.54744047e-02]
 [-6.48638238e-02 -6.54470997e-02  1.71351708e-02]
 [ 9.34652455e-02 -6.64299354e-02 -6.74927465e-02]
 [ 2.62647039e-02 -7.67627050e-03  8.67070443e-02]
 [-3.74816014e-02  5.14799473e-01 -4.98993851e-01]
 [ 4.67545772e-01  2.59159714e-01  4.62413945e-02]
 [ 8.06433285e-03  6.45740340e-02  1.09115642e-02]
 [-4.34902877e-02 -1.29057943e-01 -4.86497672e-02]
 [ 1.87393475e-02  2.54699809e-02 -1.07149447e-02]
 [-7.29341208e-02 -1.26899060e-02  1.99057365e-01]
 [ 1.86515193e-02 -3.31303150e-02  6.49611678e-03]
 [ 1.50233115e-01 -6.75642642e-02  1.10449113e-01]
 [-4.31662643e-02 -6.63410230e-03 -4.83858556e-02]
 [-6.33195106e-02 -1.40742324e-02  3.83937123e-02]
 [-3.21052317e-02 -4.68950659e-02 -1.54583149e-02]
 [ 2.61588735e-02 -2.74734793e-02 -7.48935231e-02]
 [-2.89761763e-02  9.66921170e-03  1.26756304e-01]
 [ 1.08602930e-02 -7.06039110e-02 -1.54906700e-02]
 [-3.31153161e-02  2.84322874e-02  4.10606800e-02]
 [ 7.70090847e-02  3.64606422e-02  1.85244662e-01]
 [ 3.79636146e-02 -2.45889983e-02 -1.12662514e-02]
 [-6.21754227e-02  1.27356680e-03  3.61551020e-02]
 [ 1.17266285e-01  2.95468452e-03  1.04110973e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.53850569]
curr_Stock_Price:  100.27040400078408
curr_Factors:  [100.270404    -1.07488281  -0.98831968]
mat_Sqrt:  [[12.73899904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00997758 -0.02956288  0.0446462 ]
Stock Position:  -0.009977579359205112
Bond Position:  [5.5389616]


portfolio before change:  [4.52883008]
curr_Stock_Price:  101.30953587611216
curr_Factors:  [101.30953588  -0.89625286  -0.99690571]
mat_Sqrt:  [[15.25674907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00299943  0.01844147 -0.15013925]
Stock Position:  -0.002999434700351042
Bond Position:  [4.83270142]


portfolio before change:  [4.5290991]
curr_Stock_Price:  101.4212574423777
curr_Factors:  [101.42125744  -1.096995    -0.97436272]
mat_Sqrt:  [[12.78055651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00172587 -0.00209858  0.15528339]
Stock Position:  0.0017258684865781738
Bond Position:  [4.35405935]


portfolio before change:  [4.52932246]
curr_Stock_Price:  101.23530141420986
curr_Factors:  [101.23530141  -0.9447933   -0.96146169]
mat_Sqrt:  [[15.04720915  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00639723 -0.01561376 -0.09851534]
Stock Position:  -0.006397232855898556
Bond Position:  [5.17694825]


portfolio before change:  [4.52929506]
curr_Stock_Price:  101.34074592080572
curr_Factors:  [101.34074592  -0.94290125  -0.97691885]
mat_Sqrt:  [[14.85993183  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00722809 -0.05516681 -0.29685925]
Stock Position:  0.007228088528181172
Bond Position:  [3.79679518]


portfolio before change:  [4.53224206]
curr_Stock_Price:  101.6827964929228
curr_Factors:  [101.68279649  -0.70950584  -0.95888758]
mat_Sqrt:  [[19.172265    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00799614 -0.05534923  0.15513819]
Stock Position:  -0.00799614423191722
Bond Position:  [5.34531237]


portfolio before change:  [4.54754866]
curr_Stock_Price:  99.85211569970734
curr_Factors:  [99.8521157  -0.64220093 -0.96520113]
mat_Sqrt:  [[20.01112143  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00381801 -0.0571442   0.28595291]
Stock Position:  -0.0038180143672225768
Bond Position:  [4.92878547]


portfolio before change:  [4.55502077]
curr_Stock_Price:  98.05642377091465
curr_Factors:  [98.05642377 -0.49191305 -0.95747584]
mat_Sqrt:  [[23.01518414  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00705967 0.27046237 0.56540333]
Stock Position:  0.00705967167246867
Bond Position:  [3.86277462]


portfolio before change:  [4.54682334]
curr_Stock_Price:  96.82686166604562
curr_Factors:  [96.82686167 -0.56096273 -0.94909413]
mat_Sqrt:  [[21.38880372  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00051807 -0.03784189  0.02704438]
Stock Position:  0.0005180719830281506
Bond Position:  [4.49666006]


portfolio before change:  [4.54804547]
curr_Stock_Price:  98.1008255778771
curr_Factors:  [98.10082558 -0.41284959 -0.93004077]
mat_Sqrt:  [[25.61313803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01652648 0.04289878 0.59359678]
Stock Position:  0.01652647980672098
Bond Position:  [2.92678415]


portfolio before change:  [4.54540858]
curr_Stock_Price:  97.91913199346796
curr_Factors:  [97.91913199 -0.35812875 -0.95349546]
mat_Sqrt:  [[26.37766812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0109759  -0.08350441  0.04518759]
Stock Position:  -0.010975903168371009
Bond Position:  [5.62015949]


portfolio before change:  [4.56477179]
curr_Stock_Price:  96.21898566054001
curr_Factors:  [ 9.62189857e+01 -6.21765692e-02 -9.59116348e-01]
mat_Sqrt:  [[34.65124922  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277526 -0.00661095  0.23819287]
Stock Position:  -0.0027752619008832857
Bond Position:  [4.83180467]


portfolio before change:  [4.56235452]
curr_Stock_Price:  97.30763194584812
curr_Factors:  [97.30763195 -0.21447889 -0.92969705]
mat_Sqrt:  [[30.99114392  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00020614  0.04360664 -0.09691705]
Stock Position:  -0.00020613652383662237
Bond Position:  [4.58241318]


portfolio before change:  [4.56294744]
curr_Stock_Price:  97.21024691565904
curr_Factors:  [97.21024692 -0.19549928 -0.94801798]
mat_Sqrt:  [[30.98052762  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00029897 -0.01487364  0.17545395]
Stock Position:  0.0002989709940494774
Bond Position:  [4.53388439]


portfolio before change:  [4.56442678]
curr_Stock_Price:  100.26262250268901
curr_Factors:  [100.2626225   -0.34640148  -0.9408505 ]
mat_Sqrt:  [[27.67531847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138613 -0.00886877 -0.25775191]
Stock Position:  0.0013861327352322243
Bond Position:  [4.42544947]


portfolio before change:  [4.56385456]
curr_Stock_Price:  99.45069708892355
curr_Factors:  [99.45069709 -0.42264935 -0.89925443]
mat_Sqrt:  [[26.5162627   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040059 -0.0101681   0.19588145]
Stock Position:  0.00040058672352541095
Bond Position:  [4.52401593]


portfolio before change:  [4.56432283]
curr_Stock_Price:  99.20788974585027
curr_Factors:  [99.20788975 -0.64486881 -0.88811936]
mat_Sqrt:  [[21.41795039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00230894  0.00570277 -0.07267139]
Stock Position:  0.002308935258123772
Bond Position:  [4.33525823]


portfolio before change:  [4.56730927]
curr_Stock_Price:  100.26660233626913
curr_Factors:  [100.26660234  -0.86579396  -0.87928475]
mat_Sqrt:  [[17.50968141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00426767 -0.02112296  0.04888187]
Stock Position:  -0.0042676650257415395
Bond Position:  [4.99521354]


portfolio before change:  [4.56125757]
curr_Stock_Price:  101.83095562058121
curr_Factors:  [101.83095562  -0.98265161  -0.89885126]
mat_Sqrt:  [[15.5150617   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00426221 -0.02144017 -0.19253802]
Stock Position:  0.004262206221084167
Bond Position:  [4.12723304]


portfolio before change:  [4.56165147]
curr_Stock_Price:  101.80232335022289
curr_Factors:  [101.80232335  -0.70588029  -0.90676505]
mat_Sqrt:  [[20.29526471  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.002089   -0.00247751  0.24735106]
Stock Position:  0.0020889992665075905
Bond Position:  [4.3489865]


portfolio before change:  [4.5624277]
curr_Stock_Price:  101.91365157011474
curr_Factors:  [101.91365157  -0.76814521  -0.92307383]
mat_Sqrt:  [[18.78214846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182382  0.16615082 -1.42349056]
Stock Position:  -0.0018238218304511024
Bond Position:  [4.74830004]


portfolio before change:  [4.56226279]
curr_Stock_Price:  102.32952707220734
curr_Factors:  [102.32952707  -0.61614844  -0.9259082 ]
mat_Sqrt:  [[21.8924456   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02420403 0.08364344 0.13191383]
Stock Position:  0.0242040346711448
Bond Position:  [2.08547537]


portfolio before change:  [4.53335507]
curr_Stock_Price:  101.12442155826211
curr_Factors:  [101.12442156  -0.48226824  -0.92564933]
mat_Sqrt:  [[24.74031458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00094877 0.02084118 0.03112766]
Stock Position:  0.0009487658691607375
Bond Position:  [4.43741167]


portfolio before change:  [4.53366104]
curr_Stock_Price:  100.86224646987354
curr_Factors:  [100.86224647  -0.38212468  -0.92250156]
mat_Sqrt:  [[27.36129563  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291524 -0.04165327 -0.13878424]
Stock Position:  -0.0029152392224009458
Bond Position:  [4.82769862]


portfolio before change:  [4.53827423]
curr_Stock_Price:  99.48682159292092
curr_Factors:  [99.48682159 -0.16907533 -0.91835944]
mat_Sqrt:  [[33.53502539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00064861  0.0082204  -0.03056675]
Stock Position:  0.000648611605659821
Bond Position:  [4.47374593]


portfolio before change:  [4.53930185]
curr_Stock_Price:  100.20892227318883
curr_Factors:  [100.20892227  -0.49028921  -0.91050808]
mat_Sqrt:  [[24.69152201  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00141312 -0.00409565  0.56785525]
Stock Position:  -0.0014131175334369255
Bond Position:  [4.68090883]


portfolio before change:  [4.53860719]
curr_Stock_Price:  101.11458664687324
curr_Factors:  [101.11458665  -0.5571837   -0.90481347]
mat_Sqrt:  [[23.43562334  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00056388 -0.01069276  0.01853161]
Stock Position:  0.0005638781679564679
Bond Position:  [4.48159088]


portfolio before change:  [4.54016402]
curr_Stock_Price:  102.88198433714967
curr_Factors:  [102.88198434  -0.89844341  -0.90939794]
mat_Sqrt:  [[16.87344706  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00942232 -0.02180627  0.31508058]
Stock Position:  0.009422315870679958
Bond Position:  [3.57077747]


portfolio before change:  [4.55391258]
curr_Stock_Price:  104.29375904626923
curr_Factors:  [104.29375905  -0.95686923  -0.91572584]
mat_Sqrt:  [[16.03247667  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00339294 -0.00214115 -0.13803138]
Stock Position:  -0.0033929359327610807
Bond Position:  [4.90777463]


portfolio before change:  [4.55823196]
curr_Stock_Price:  103.201528146806
curr_Factors:  [103.20152815  -1.06544074  -0.88444226]
mat_Sqrt:  [[14.68461959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00397391 -0.00454244  0.10952657]
Stock Position:  -0.003973907338694654
Bond Position:  [4.96834527]


portfolio before change:  [4.5610804]
curr_Stock_Price:  102.6410342234255
curr_Factors:  [102.64103422  -0.87518722  -0.87528301]
mat_Sqrt:  [[17.82795205  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00251476 -0.01513532 -0.04409827]
Stock Position:  -0.002514762331770176
Bond Position:  [4.8191982]


portfolio before change:  [4.5619481]
curr_Stock_Price:  102.5355510939726
curr_Factors:  [102.53555109  -0.90164342  -0.89971737]
mat_Sqrt:  [[16.92596427  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00031096 -0.00886703 -0.21365038]
Stock Position:  0.0003109599274105737
Bond Position:  [4.53006365]


portfolio before change:  [4.56230742]
curr_Stock_Price:  101.86996392609653
curr_Factors:  [101.86996393  -0.85350317  -0.89801176]
mat_Sqrt:  [[17.67554777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.38415572e-05  3.12072466e-03  3.61600453e-01]
Stock Position:  -6.384155716158258e-05
Bond Position:  [4.56881096]


portfolio before change:  [4.56288723]
curr_Stock_Price:  101.73418575837246
curr_Factors:  [101.73418576  -0.96450091  -0.89712719]
mat_Sqrt:  [[15.81146466  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042461 -0.02278731 -0.04419057]
Stock Position:  -0.00042460896935775366
Bond Position:  [4.60608447]


portfolio before change:  [4.56361567]
curr_Stock_Price:  101.37468723332942
curr_Factors:  [101.37468723  -0.83382264  -0.90452677]
mat_Sqrt:  [[17.8227195   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106213  0.00917648  0.11713469]
Stock Position:  -0.0010621344053187655
Bond Position:  [4.67128921]


portfolio before change:  [4.56370429]
curr_Stock_Price:  101.8410408747179
curr_Factors:  [101.84104087  -0.86300672  -0.91679261]
mat_Sqrt:  [[17.17773117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00711762 0.01176762 0.52845146]
Stock Position:  0.007117615779704139
Bond Position:  [3.83883889]


portfolio before change:  [4.56437516]
curr_Stock_Price:  101.86787478247221
curr_Factors:  [101.86787478  -0.77550532  -0.92695898]
mat_Sqrt:  [[18.56377915  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00165078 -0.00793607 -0.03213948]
Stock Position:  0.0016507787630087264
Bond Position:  [4.39621384]


portfolio before change:  [4.56475889]
curr_Stock_Price:  101.76741825400372
curr_Factors:  [101.76741825  -0.598138    -0.92430462]
mat_Sqrt:  [[22.20344315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00245617  0.00041104  0.10314044]
Stock Position:  -0.002456165349002841
Bond Position:  [4.8147165]


portfolio before change:  [4.56466701]
curr_Stock_Price:  102.04987348804212
curr_Factors:  [102.04987349  -0.58200086  -0.90648256]
mat_Sqrt:  [[23.03415761  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00603977 0.00095362 0.29699963]
Stock Position:  0.0060397681020531845
Bond Position:  [3.94830944]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.56141707]
Stock Price:  101.43006222053562
PL:  [3.13135485]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.52410828e-01 -8.49134755e-02  2.10059079e-02]
 [-1.33237596e-01  6.88476230e-02 -1.44566863e-01]
 [-1.09521828e-02  2.26332268e-02  3.87460053e-02]
 [ 1.28963762e-01  3.65421080e-02  1.47853235e-01]
 [ 2.67562727e-02  5.77093096e-02 -6.83017962e-02]
 [-1.29836220e-01 -1.65311266e-01  8.93319173e-02]
 [-5.48544512e-02 -1.49580839e-01  1.05136281e-02]
 [ 6.74379709e-03  6.92767243e-01  1.04185303e-01]
 [ 3.48980540e-01  2.10496342e-02  3.38684524e-01]
 [ 4.52467760e-01  1.74120162e-01  2.91516069e-01]
 [-2.28990802e-01 -2.39956887e-01  2.55314233e-02]
 [-3.93546055e-02 -1.80727022e-02  9.21338907e-02]
 [ 4.90196418e-03 -3.94359384e-02  1.29923779e-01]
 [ 1.11366516e-02 -1.44991013e-01  3.42485771e-02]
 [ 2.09415573e-03  1.87452139e-02 -6.43501823e-02]
 [ 9.99714417e-02 -3.94807022e-03 -6.78947986e-03]
 [ 5.24650391e-02  2.00061180e-02 -3.30238691e-02]
 [-4.87729143e-02 -6.21756489e-02  1.82911022e-03]
 [ 5.26417010e-02  4.34000551e-02 -2.21926659e-01]
 [-2.45894171e-02  3.30512418e-02 -6.45860184e-02]
 [-4.55066838e-02  5.53662273e-01 -5.21491946e-01]
 [ 4.43522171e-01  2.47664502e-01  5.01534686e-02]
 [ 2.41969836e-03  4.89650440e-02  2.01375842e-02]
 [-4.74790708e-02 -1.49802193e-01 -2.80215578e-02]
 [ 4.48601855e-02  1.85828203e-02 -1.29627620e-02]
 [-5.47545515e-02 -5.62120007e-03  1.69520628e-01]
 [-1.47272873e-03 -3.26872127e-02  3.13086712e-03]
 [-3.58268421e-02  2.47596281e-03 -2.94561038e-01]
 [-4.26729471e-03 -3.87308847e-02  6.56604488e-02]
 [-1.60304254e-02  2.98356256e-02 -3.42712310e-02]
 [ 4.91193241e-04 -1.07755329e-02  3.44782771e-02]
 [-3.75933892e-03  1.04090130e-01 -1.14150113e-01]
 [-5.92562875e-03  8.04606355e-02 -2.60571826e-02]
 [-4.54665828e-03 -9.34710295e-02  6.92037621e-02]
 [-8.19525361e-02  6.63992094e-02 -9.28836610e-02]
 [-2.40686940e-01 -2.49533396e-01 -2.27930664e-01]
 [ 1.12365365e-01  1.37816261e-01  3.52672113e-01]
 [ 2.38759629e-01 -1.59738132e-01 -3.22961016e-01]
 [ 9.32358006e-02  6.60400091e-03  9.37470872e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.51846517]
curr_Stock_Price:  100.6460947792959
curr_Factors:  [100.64609478  -1.2485403   -0.96264231]
mat_Sqrt:  [[11.02789247  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0150034  -0.02740571  0.05992401]
Stock Position:  -0.015003402154868464
Bond Position:  [9.02849901]


portfolio before change:  [7.52489881]
curr_Stock_Price:  100.29250807819714
curr_Factors:  [100.29250808  -1.10358163  -0.96930046]
mat_Sqrt:  [[12.61906688  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01178326  0.02222047 -0.41240902]
Stock Position:  -0.011783258067404968
Bond Position:  [8.70667131]


portfolio before change:  [7.5254361]
curr_Stock_Price:  100.33927823745967
curr_Factors:  [100.33927824  -0.89816254  -0.96425225]
mat_Sqrt:  [[15.5824057   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.01191084e-04 7.30484255e-03 1.10531568e-01]
Stock Position:  0.00010119108398026862
Bond Position:  [7.51528266]


portfolio before change:  [7.5263602]
curr_Stock_Price:  100.18737740153608
curr_Factors:  [100.1873774   -0.66993469  -0.9755557 ]
mat_Sqrt:  [[19.32794208  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00861982 0.01179391 0.42178412]
Stock Position:  0.008619815945581857
Bond Position:  [6.66276345]


portfolio before change:  [7.5247085]
curr_Stock_Price:  99.8991344372551
curr_Factors:  [99.89913444 -0.74636097 -0.95378231]
mat_Sqrt:  [[18.24731128  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00134782  0.0186256  -0.19484601]
Stock Position:  0.0013478199640190383
Bond Position:  [7.39006245]


portfolio before change:  [7.52616824]
curr_Stock_Price:  100.29676196679354
curr_Factors:  [100.29676197  -0.47999993  -0.96145518]
mat_Sqrt:  [[23.7285343   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00612534 -0.05335398  0.25483909]
Stock Position:  -0.006125344168419184
Bond Position:  [8.14052043]


portfolio before change:  [7.52377728]
curr_Stock_Price:  100.8532348252976
curr_Factors:  [100.85323483  -0.46371323  -0.96165175]
mat_Sqrt:  [[24.24720511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00343303 -0.04827701  0.02999245]
Stock Position:  -0.003433031826344656
Bond Position:  [7.87000965]


portfolio before change:  [7.52384542]
curr_Stock_Price:  101.11996073077604
curr_Factors:  [101.11996073  -0.66294165  -0.97249564]
mat_Sqrt:  [[19.70495743  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00859789 0.22358967 0.29721167]
Stock Position:  0.008597889898111614
Bond Position:  [6.65442713]


portfolio before change:  [7.51726859]
curr_Stock_Price:  100.25827433413782
curr_Factors:  [100.25827433  -0.47019022  -0.9819005 ]
mat_Sqrt:  [[23.46849488  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01799907 0.00679374 0.96617268]
Stock Position:  0.01799906511362667
Bond Position:  [5.71271338]


portfolio before change:  [7.51283053]
curr_Stock_Price:  99.97202667463799
curr_Factors:  [99.97202667 -0.60062735 -0.97127995]
mat_Sqrt:  [[20.75906696  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02637476 0.05619704 0.8316142 ]
Stock Position:  0.026374757541636432
Bond Position:  [4.87609257]


portfolio before change:  [7.49914982]
curr_Stock_Price:  99.43021078532857
curr_Factors:  [99.43021079 -0.88863217 -0.96054352]
mat_Sqrt:  [[15.64701727  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01743209 -0.07744575  0.07283404]
Stock Position:  -0.017432090193778824
Bond Position:  [9.23242622]


portfolio before change:  [7.49919442]
curr_Stock_Price:  99.4938590077241
curr_Factors:  [99.49385901 -0.86459882 -0.96792554]
mat_Sqrt:  [[15.9199264   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152243 -0.00583294  0.26283234]
Stock Position:  -0.0015224271814042786
Bond Position:  [7.65066658]


portfolio before change:  [7.50036146]
curr_Stock_Price:  99.35549914335661
curr_Factors:  [99.35549914 -0.78540463 -0.98475054]
mat_Sqrt:  [[16.92089344  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138129 -0.01272789  0.37063638]
Stock Position:  0.0013812933390413757
Bond Position:  [7.36312237]


portfolio before change:  [7.50083883]
curr_Stock_Price:  99.03472761466081
curr_Factors:  [99.03472761 -0.83115937 -0.99052409]
mat_Sqrt:  [[16.01918587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071593 -0.04679565  0.09770166]
Stock Position:  -0.0007159261207467198
Bond Position:  [7.57174038]


portfolio before change:  [7.5013547]
curr_Stock_Price:  99.63626096112206
curr_Factors:  [99.63626096 -0.72479229 -1.04765915]
mat_Sqrt:  [[16.92978898  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042617  0.00604999 -0.18357316]
Stock Position:  -0.0004261671230886035
Bond Position:  [7.5438164]


portfolio before change:  [7.50249153]
curr_Stock_Price:  99.18151787677728
curr_Factors:  [99.18151788 -0.67522758 -1.06697151]
mat_Sqrt:  [[17.37013925  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00562918 -0.00127423 -0.0193685 ]
Stock Position:  0.005629180460132597
Bond Position:  [6.94418087]


portfolio before change:  [7.50044436]
curr_Stock_Price:  98.66363627910803
curr_Factors:  [98.66363628 -0.63055709 -1.03238198]
mat_Sqrt:  [[18.70474772  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00266284  0.00645695 -0.09420791]
Stock Position:  0.0026628427438823723
Bond Position:  [7.23771861]


portfolio before change:  [7.50394215]
curr_Stock_Price:  99.63741483643607
curr_Factors:  [99.63741484 -0.75477004 -1.01434915]
mat_Sqrt:  [[16.98649392  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00359645 -0.0200671   0.00521794]
Stock Position:  -0.0035964514034541083
Bond Position:  [7.86228327]


portfolio before change:  [7.50468443]
curr_Stock_Price:  99.70430455873648
curr_Factors:  [99.70430456 -0.51047442 -1.01517721]
mat_Sqrt:  [[21.6836217   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074711  0.01400731 -0.63309498]
Stock Position:  0.0007471127702638977
Bond Position:  [7.43019407]


portfolio before change:  [7.50526649]
curr_Stock_Price:  99.2401429857845
curr_Factors:  [99.24014299 -0.41194769 -1.01516008]
mat_Sqrt:  [[23.81783882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00130265  0.01066724 -0.18424593]
Stock Position:  -0.0013026549835649516
Bond Position:  [7.63454215]


portfolio before change:  [7.50705024]
curr_Stock_Price:  98.60345945565304
curr_Factors:  [98.60345946 -0.31797395 -0.99053257]
mat_Sqrt:  [[26.64495478  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.46143777e-03  1.78693730e-01 -1.48767137e+00]
Stock Position:  -0.0014614377718905405
Bond Position:  [7.65115306]


portfolio before change:  [7.50674306]
curr_Stock_Price:  99.46810905730665
curr_Factors:  [99.46810906 -0.4647952  -0.97891024]
mat_Sqrt:  [[23.47959233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02147882 0.07993337 0.14307389]
Stock Position:  0.021478823092202608
Bond Position:  [5.37028515]


portfolio before change:  [7.53838066]
curr_Stock_Price:  100.90982045068377
curr_Factors:  [100.90982045  -0.54772954  -1.02619458]
mat_Sqrt:  [[20.91158129  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00079024 0.0158034  0.05744692]
Stock Position:  0.000790242164872731
Bond Position:  [7.45863746]


portfolio before change:  [7.54009152]
curr_Stock_Price:  101.89493342037285
curr_Factors:  [101.89493342  -0.48408458  -1.0484271 ]
mat_Sqrt:  [[22.00853966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380658 -0.04834845 -0.0799377 ]
Stock Position:  -0.003806576588574531
Bond Position:  [7.92796239]


portfolio before change:  [7.54332489]
curr_Stock_Price:  101.30587181742293
curr_Factors:  [101.30587182  -0.52822681  -1.01839515]
mat_Sqrt:  [[21.57472335  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213247  0.00599758 -0.03697915]
Stock Position:  0.002132466514607906
Bond Position:  [7.32729351]


portfolio before change:  [7.54346246]
curr_Stock_Price:  100.94084894628956
curr_Factors:  [100.94084895  -0.6600694   -1.0013591 ]
mat_Sqrt:  [[19.1653927   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111131 -0.00181423  0.48359517]
Stock Position:  -0.0011113114750753025
Bond Position:  [7.65563918]


portfolio before change:  [7.54505306]
curr_Stock_Price:  100.37072283342641
curr_Factors:  [100.37072283  -0.89143338  -0.99615789]
mat_Sqrt:  [[15.19975468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00049382 -0.01054975  0.00893149]
Stock Position:  -0.0004938166876637341
Bond Position:  [7.5946178]


portfolio before change:  [7.54633555]
curr_Stock_Price:  99.69617158249007
curr_Factors:  [99.69617158 -0.57365634 -1.00294347]
mat_Sqrt:  [[20.60487039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.63232510e-03  7.99113561e-04 -8.40300650e-01]
Stock Position:  -0.004632325102685651
Bond Position:  [8.00816063]


portfolio before change:  [7.55113057]
curr_Stock_Price:  98.87715899067152
curr_Factors:  [98.87715899 -0.24310146 -1.01168642]
mat_Sqrt:  [[28.19346959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.36157579e-05 -1.25003393e-02  1.87310984e-01]
Stock Position:  4.36157578760678e-05
Bond Position:  [7.54681796]


portfolio before change:  [7.55201361]
curr_Stock_Price:  97.49301406647065
curr_Factors:  [97.49301407 -0.1899577  -0.98512424]
mat_Sqrt:  [[30.10522633  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056255  0.00962941 -0.09776628]
Stock Position:  -0.0005625548008466485
Bond Position:  [7.60685877]


portfolio before change:  [7.55373802]
curr_Stock_Price:  96.11804284343224
curr_Factors:  [96.11804284 -0.1846303  -0.98257324]
mat_Sqrt:  [[29.91540318  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00017815 -0.00347779  0.09835693]
Stock Position:  0.00017815222477402117
Bond Position:  [7.53661438]


portfolio before change:  [7.55416895]
curr_Stock_Price:  93.24857310803571
curr_Factors:  [93.24857311 -0.13080258 -0.96151874]
mat_Sqrt:  [[31.27901545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.85837831e-04  3.35949450e-02 -3.25638499e-01]
Stock Position:  -0.0001858378307326973
Bond Position:  [7.57149807]


portfolio before change:  [7.55524308]
curr_Stock_Price:  92.56178137346949
curr_Factors:  [92.56178137 -0.0969294  -0.99798864]
mat_Sqrt:  [[30.96811998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00016725  0.02596856 -0.07433389]
Stock Position:  0.000167250371931108
Bond Position:  [7.53976209]


portfolio before change:  [7.55598839]
curr_Stock_Price:  91.38257512376418
curr_Factors:  [ 9.13825751e+01  2.14671901e-02 -9.71303639e-01]
mat_Sqrt:  [[35.34717124  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00026877 -0.03016765  0.19741907]
Stock Position:  -0.00026876814049736983
Bond Position:  [7.58054911]


portfolio before change:  [7.55686238]
curr_Stock_Price:  91.6565375197222
curr_Factors:  [ 9.16565375e+01  5.82573594e-02 -9.70538098e-01]
mat_Sqrt:  [[36.80992702  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00237324  0.02143025 -0.26497123]
Stock Position:  -0.0023732362235039453
Bond Position:  [7.774385]


portfolio before change:  [7.56133613]
curr_Stock_Price:  90.18096148393825
curr_Factors:  [90.18096148  0.20500823 -0.96353292]
mat_Sqrt:  [[42.23687443  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00800601 -0.08053656 -0.65022274]
Stock Position:  -0.008006011041664254
Bond Position:  [8.28332591]


portfolio before change:  [7.56641237]
curr_Stock_Price:  89.67624565923533
curr_Factors:  [ 8.96762457e+01  4.80081403e-03 -9.95551074e-01]
mat_Sqrt:  [[33.29661212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00638161 0.04448001 1.00607537]
Stock Position:  0.00638160675138341
Bond Position:  [6.99413384]


portfolio before change:  [7.55949301]
curr_Stock_Price:  88.4549733364654
curr_Factors:  [88.45497334  0.19712804 -1.00259217]
mat_Sqrt:  [[39.52879994  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00354752 -0.05155526 -0.92131788]
Stock Position:  0.00354751669512218
Bond Position:  [7.24569752]


portfolio before change:  [7.56199455]
curr_Stock_Price:  88.90479960461116
curr_Factors:  [88.9047996   0.27623649 -1.01313911]
mat_Sqrt:  [[42.54930428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00267266 0.00213143 0.26743435]
Stock Position:  0.0026726613418186287
Bond Position:  [7.32438213]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.56212322]
Stock Price:  88.61035988880472
PL:  [7.56212322]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.24955538e-02 -8.02923516e-02  1.21715327e-02]
 [-2.37022191e-01  3.28522490e-02 -4.16480656e-01]
 [-4.04917540e-02  4.61878086e-02  1.77841607e-02]
 [-1.11953126e-01 -1.26550407e-01 -4.98037183e-02]
 [ 1.61708960e-01 -1.68867355e-01 -1.03934822e-01]
 [-1.29426374e-01 -1.71107002e-01  5.65664663e-02]
 [-5.37384244e-02 -1.56115836e-01 -7.20810921e-03]
 [ 9.99007046e-03  7.88700078e-01  1.42920485e-01]
 [ 3.22554768e-02  5.39084385e-02  3.86168156e-02]
 [ 2.88920871e-01  1.09386937e-01  1.64624834e-01]
 [-2.70306038e-02 -1.78605671e-01  6.50284869e-03]
 [ 1.07174004e-01 -7.73671846e-03  1.39350439e-01]
 [ 1.72911251e-03  1.35575898e-02 -4.20307257e-02]
 [ 1.45342044e-02 -2.19988771e-01  3.70644885e-02]
 [ 4.08185926e-02 -5.96687175e-02 -7.54580026e-02]
 [ 1.11651747e-01 -6.30966077e-04 -1.46518292e-02]
 [ 4.42544708e-02  2.98582290e-02  1.42468117e-02]
 [-2.79683153e-02 -4.32640782e-02  7.01837618e-02]
 [ 9.96856402e-02 -7.71976903e-02 -5.87985815e-02]
 [ 5.48811276e-02 -1.24002563e-02  1.90517639e-01]
 [-9.13173182e-03  2.72969493e-01 -2.55694916e-01]
 [ 3.83996078e-02  5.38147220e-02  1.16124823e-01]
 [-2.66032684e-02  5.05477077e-02  1.82614614e-02]
 [ 1.18312546e-01 -1.92491578e-01 -3.21733137e-01]
 [ 7.26207222e-02  4.31234278e-02 -1.59312881e-02]
 [-1.15756754e-02  1.58916157e-02  3.90135560e-02]
 [ 5.50948824e-02 -3.32444883e-02  2.08624266e-02]
 [ 1.32982425e-01 -6.87352299e-02  4.21300359e-02]
 [-4.70301114e-02 -2.27141650e-02 -1.73431891e-02]
 [-4.94154746e-02 -8.63606564e-03  2.57188884e-02]
 [-2.51009701e-02 -4.28131311e-02 -1.19413768e-02]
 [ 2.59651983e-02 -5.01044213e-03 -3.91101380e-02]
 [ 6.17879385e-02  9.48391126e-03  1.40711986e-01]
 [ 1.14668398e-02 -6.97096783e-02 -1.03124789e-02]
 [-3.10065640e-02  2.71391763e-03  4.73220058e-02]
 [ 8.99315737e-02  3.35153812e-02  1.98542576e-01]
 [ 1.25131700e-01 -6.94111027e-02  4.18800781e-02]
 [-6.93552760e-02  5.27587076e-03  3.60409241e-02]
 [ 1.18554236e-01  3.20385883e-03  1.10706556e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.25932789]
curr_Stock_Price:  99.98306248305579
curr_Factors:  [99.98306248 -1.01363021 -1.00194035]
mat_Sqrt:  [[13.32217893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273234 -0.02591425  0.03472199]
Stock Position:  -0.0027323351504764015
Bond Position:  [2.53251512]


portfolio before change:  [2.2587974]
curr_Stock_Price:  100.29308190805232
curr_Factors:  [100.29308191  -1.4136679   -1.02683946]
mat_Sqrt:  [[ 8.73719637  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03609053  0.01060302 -1.18810338]
Stock Position:  -0.03609052584644615
Bond Position:  [5.87842746]


portfolio before change:  [2.2647542]
curr_Stock_Price:  100.14839132477097
curr_Factors:  [100.14839132  -1.37636425  -1.0041204 ]
mat_Sqrt:  [[ 9.26430048  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296121  0.01490705  0.05073326]
Stock Position:  -0.00296120905193396
Bond Position:  [2.56131453]


portfolio before change:  [2.2641176]
curr_Stock_Price:  100.47149734080972
curr_Factors:  [100.47149734  -1.68782593  -1.02501543]
mat_Sqrt:  [[ 6.66608491  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02219463 -0.04084397 -0.14207615]
Stock Position:  -0.022194625903897407
Bond Position:  [4.4940449]


portfolio before change:  [2.2545887]
curr_Stock_Price:  100.92614316332921
curr_Factors:  [100.92614316  -1.60054061  -1.01383776]
mat_Sqrt:  [[ 7.38913459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01434856 -0.0545017  -0.29649712]
Stock Position:  0.014348561107725592
Bond Position:  [0.80644377]


portfolio before change:  [2.25621456]
curr_Stock_Price:  101.03242894298725
curr_Factors:  [101.03242894  -1.60072471  -1.03070574]
mat_Sqrt:  [[ 7.27185267  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02101347 -0.05522455  0.16136838]
Stock Position:  -0.021013470696653505
Bond Position:  [4.37925655]


portfolio before change:  [2.26890661]
curr_Stock_Price:  100.45448500556205
curr_Factors:  [100.45448501  -1.87152409  -1.03055168]
mat_Sqrt:  [[ 5.51586766  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0157866  -0.05038617 -0.02056273]
Stock Position:  -0.015786597936414466
Bond Position:  [3.85474118]


portfolio before change:  [2.27130677]
curr_Stock_Price:  100.33297132926937
curr_Factors:  [100.33297133  -1.82000032  -1.03613586]
mat_Sqrt:  [[ 5.7681891   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03470003 0.25455186 0.40771236]
Stock Position:  0.034700027704171334
Bond Position:  [-1.21025011]


portfolio before change:  [2.28950506]
curr_Stock_Price:  100.86177739463858
curr_Factors:  [100.86177739  -1.87105194  -1.04547508]
mat_Sqrt:  [[ 5.45877291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00936879 0.01739887 0.11016303]
Stock Position:  0.00936879333307617
Bond Position:  [1.34455192]


portfolio before change:  [2.28690199]
curr_Stock_Price:  100.56599209307987
curr_Factors:  [100.56599209  -1.87650229  -1.02871334]
mat_Sqrt:  [[ 5.50467936  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0626473  0.03530448 0.46962883]
Stock Position:  0.06264729815185453
Bond Position:  [-4.0132857]


portfolio before change:  [2.26734795]
curr_Stock_Price:  100.26187119136915
curr_Factors:  [100.26187119  -1.92136104  -1.03691451]
mat_Sqrt:  [[ 5.20442863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01194386 -0.05764473  0.01855082]
Stock Position:  -0.011943855836257315
Bond Position:  [3.46486128]


portfolio before change:  [2.2696366]
curr_Stock_Price:  100.10651745069104
curr_Factors:  [100.10651745  -1.89539879  -1.03018019]
mat_Sqrt:  [[ 5.36907594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0249651  -0.00249702  0.39752802]
Stock Position:  0.024965104532847043
Bond Position:  [-0.22953307]


portfolio before change:  [2.26150711]
curr_Stock_Price:  99.78203228747483
curr_Factors:  [99.78203229 -1.67746106 -0.97446163]
mat_Sqrt:  [[ 7.03618025  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058028  0.00437569 -0.11990196]
Stock Position:  -0.0005802782007429515
Bond Position:  [2.31940844]


portfolio before change:  [2.26170168]
curr_Stock_Price:  99.94638518303555
curr_Factors:  [99.94638518 -1.67996015 -0.96142543]
mat_Sqrt:  [[ 7.12242535  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00320187 -0.07100107  0.10573467]
Stock Position:  -0.0032018669697602984
Bond Position:  [2.58171671]


portfolio before change:  [2.26152658]
curr_Stock_Price:  100.10186854659699
curr_Factors:  [100.10186855  -1.4524495   -0.96120962]
mat_Sqrt:  [[ 8.9578409   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147758 -0.019258   -0.21526068]
Stock Position:  0.0014775844415828143
Bond Position:  [2.11361761]


portfolio before change:  [2.26143245]
curr_Stock_Price:  99.85934767313663
curr_Factors:  [99.85934767 -1.2737666  -0.96734942]
mat_Sqrt:  [[10.61901917  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01022054 -0.00020364 -0.04179759]
Stock Position:  0.010220544614147724
Bond Position:  [1.24081553]


portfolio before change:  [2.27140396]
curr_Stock_Price:  100.8198047351789
curr_Factors:  [100.81980474  -1.51819602  -0.98373528]
mat_Sqrt:  [[ 8.2598259   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00644776 0.0096367  0.04064219]
Stock Position:  0.006447759944553926
Bond Position:  [1.62134206]


portfolio before change:  [2.27583755]
curr_Stock_Price:  101.47598808472539
curr_Factors:  [101.47598808  -1.63955008  -0.978611  ]
mat_Sqrt:  [[ 7.4013404   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303639 -0.01396342  0.20021474]
Stock Position:  -0.0030363902584775084
Bond Position:  [2.58395825]


portfolio before change:  [2.27463309]
curr_Stock_Price:  101.97904343451398
curr_Factors:  [101.97904343  -1.72271366  -0.99315001]
mat_Sqrt:  [[ 6.74568919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01066244 -0.02491545 -0.16773599]
Stock Position:  0.01066244165809828
Bond Position:  [1.18728749]


portfolio before change:  [2.27366026]
curr_Stock_Price:  101.87388476277457
curr_Factors:  [101.87388476  -1.85557802  -0.96534472]
mat_Sqrt:  [[ 6.06668839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01503937 -0.00400217  0.54349379]
Stock Position:  0.0150393724087656
Bond Position:  [0.74154097]


portfolio before change:  [2.27498808]
curr_Stock_Price:  101.9560102938091
curr_Factors:  [101.95601029  -1.94677624  -0.9765439 ]
mat_Sqrt:  [[ 5.48063685  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0010228   0.08810053 -0.72942642]
Stock Position:  -0.0010227960183570052
Bond Position:  [2.37926828]


portfolio before change:  [2.27533528]
curr_Stock_Price:  101.90734236745551
curr_Factors:  [101.90734237  -1.85419311  -0.97975389]
mat_Sqrt:  [[ 5.99015319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01220142 0.01736863 0.3312718 ]
Stock Position:  0.012201419534042385
Bond Position:  [1.03192105]


portfolio before change:  [2.27700802]
curr_Stock_Price:  102.0338632177407
curr_Factors:  [102.03386322  -1.71806153  -0.97342321]
mat_Sqrt:  [[ 6.91587854  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00181577  0.0163142   0.05209487]
Stock Position:  -0.0018157715543861222
Bond Position:  [2.4622782]


portfolio before change:  [2.27721828]
curr_Stock_Price:  102.08757946397866
curr_Factors:  [102.08757946  -1.65787862  -0.99400311]
mat_Sqrt:  [[ 7.1990519   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00185398 -0.06212639 -0.91781509]
Stock Position:  0.001853975486402354
Bond Position:  [2.08795041]


portfolio before change:  [2.27798238]
curr_Stock_Price:  102.35893439447511
curr_Factors:  [102.35893439  -1.89651582  -1.02621934]
mat_Sqrt:  [[ 5.5055157   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01419872  0.01391803 -0.04544753]
Stock Position:  0.01419872339480522
Bond Position:  [0.82461618]


portfolio before change:  [2.27500617]
curr_Stock_Price:  102.14206297270438
curr_Factors:  [102.14206297  -1.93158195  -1.01447334]
mat_Sqrt:  [[ 5.36721598  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.86024508e-05  5.12899692e-03  1.11294816e-01]
Stock Position:  -6.860245083763443e-05
Bond Position:  [2.28201336]


portfolio before change:  [2.27532575]
curr_Stock_Price:  101.6418022912193
curr_Factors:  [101.64180229  -1.81423468  -0.99210876]
mat_Sqrt:  [[ 6.14176069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00855901 -0.01072961  0.0595147 ]
Stock Position:  0.008559012205694428
Bond Position:  [1.40537233]


portfolio before change:  [2.27645028]
curr_Stock_Price:  101.75266107903072
curr_Factors:  [101.75266108  -2.00115235  -0.9897391 ]
mat_Sqrt:  [[ 5.11232112  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02494985 -0.0221842   0.12018527]
Stock Position:  0.024949853326707586
Bond Position:  [-0.26226369]


portfolio before change:  [2.28802927]
curr_Stock_Price:  102.21806585661766
curr_Factors:  [102.21806586  -2.0338701   -1.00509523]
mat_Sqrt:  [[ 4.89465165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.011279   -0.00733097 -0.04947529]
Stock Position:  -0.011279001759030209
Bond Position:  [3.44094702]


portfolio before change:  [2.28821907]
curr_Stock_Price:  102.23937518841566
curr_Factors:  [102.23937519  -2.10881153  -1.01488767]
mat_Sqrt:  [[ 4.49793171  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01021102 -0.00278728  0.07336883]
Stock Position:  -0.010211017178786879
Bond Position:  [3.33218709]


portfolio before change:  [2.28740675]
curr_Stock_Price:  102.359722844072
curr_Factors:  [102.35972284  -1.52747552  -1.00900509]
mat_Sqrt:  [[ 8.10120399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00447806 -0.01381788 -0.03406542]
Stock Position:  -0.0044780611956778005
Bond Position:  [2.74577985]


portfolio before change:  [2.2896481]
curr_Stock_Price:  101.93585461373911
curr_Factors:  [101.93585461  -1.50267097  -0.99770394]
mat_Sqrt:  [[ 8.36426806  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00202757 -0.00161711 -0.11157034]
Stock Position:  0.002027568035991931
Bond Position:  [2.08296622]


portfolio before change:  [2.2892431]
curr_Stock_Price:  101.60768224733818
curr_Factors:  [101.60768225  -1.44266327  -0.99616603]
mat_Sqrt:  [[ 8.86658613  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0104264  0.00306092 0.40141213]
Stock Position:  0.010426397070181611
Bond Position:  [1.22984106]


portfolio before change:  [2.28978257]
curr_Stock_Price:  101.64467784928362
curr_Factors:  [101.64467785  -1.21530476  -1.0163501 ]
mat_Sqrt:  [[10.91162053  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044609 -0.0224987  -0.02941863]
Stock Position:  -0.0004460945671052172
Bond Position:  [2.3351257]


portfolio before change:  [2.29017562]
curr_Stock_Price:  101.41794513918028
curr_Factors:  [101.41794514  -1.13140464  -1.01787676]
mat_Sqrt:  [[11.82207619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175883  0.00087591  0.13499651]
Stock Position:  -0.001758830133970779
Bond Position:  [2.46855256]


portfolio before change:  [2.28991545]
curr_Stock_Price:  101.74131966536112
curr_Factors:  [101.74131967  -1.16558814  -1.02652062]
mat_Sqrt:  [[11.36257143  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01208355 0.01081704 0.5663867 ]
Stock Position:  0.012083550509472837
Bond Position:  [1.06051907]


portfolio before change:  [2.29207489]
curr_Stock_Price:  101.90905787937145
curr_Factors:  [101.90905788  -1.38596593  -1.04872805]
mat_Sqrt:  [[ 8.92973622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01338359 -0.02240234  0.11947221]
Stock Position:  0.013383592773062844
Bond Position:  [0.92816556]


portfolio before change:  [2.29703237]
curr_Stock_Price:  102.27080298467682
curr_Factors:  [102.27080298  -1.01172132  -1.04840492]
mat_Sqrt:  [[13.03317442  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00467434  0.00170278  0.10281472]
Stock Position:  -0.0046743424582905806
Bond Position:  [2.77508113]


portfolio before change:  [2.29310629]
curr_Stock_Price:  103.18493858174553
curr_Factors:  [103.18493858  -1.19957398  -1.06605542]
mat_Sqrt:  [[10.70695464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0132443  0.00103404 0.31581499]
Stock Position:  0.013244298347718541
Bond Position:  [0.92649418]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.29829964]
Stock Price:  103.56831321971181
PL:  [-1.27001358]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.05182411e-01 -6.40938970e-02  7.18677212e-03]
 [-1.96341604e-01  6.42163991e-02 -2.26797349e-01]
 [-3.96365795e-02  4.57245397e-02  1.83932827e-02]
 [ 1.21330240e-01  2.94751591e-02  1.47392296e-01]
 [ 1.08955393e-01 -7.52655745e-02 -8.82370677e-02]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.22413947e-02 -1.73550199e-01 -2.75267931e-02]
 [ 1.23447462e-02  5.91769324e-01  8.40676646e-02]
 [ 2.05725813e-01 -7.49835865e-03  2.27025549e-01]
 [ 4.14840510e-01  1.67982269e-01  2.90577661e-01]
 [-1.71938473e-01 -1.69811731e-01  5.61312364e-02]
 [-5.00701823e-02 -1.84434397e-02  9.08055319e-02]
 [ 3.85238204e-03 -3.93920348e-02  1.40457888e-01]
 [ 1.10913582e-02 -1.48876682e-01  4.70581850e-02]
 [-4.77105558e-02  1.14571765e-01 -3.76715609e-02]
 [ 1.31814490e-01  5.10683295e-03 -3.25039556e-02]
 [ 4.74203162e-02  2.41763212e-02 -4.26947584e-03]
 [-4.34078402e-02 -5.27554463e-02  4.76847586e-02]
 [ 6.51544884e-02 -2.61050083e-02 -1.05363103e-01]
 [ 3.08436496e-02 -9.55915509e-04  7.98081681e-02]
 [-2.01974300e-02  3.75310846e-01 -3.56770057e-01]
 [ 7.84043098e-02  7.29568370e-02  1.09610339e-01]
 [-1.21746202e-02  6.35799063e-02  1.08673163e-02]
 [ 6.80162869e-02 -1.55833206e-01 -2.46888545e-01]
 [ 6.54233307e-02  3.53831485e-02 -1.51429661e-02]
 [-2.27102672e-02  1.24822859e-02  6.78705059e-02]
 [ 5.28460065e-02 -3.34569432e-02  1.98622271e-02]
 [ 1.07254347e-01 -6.49136983e-02 -3.27212849e-02]
 [-4.99766254e-02 -4.09930729e-02  1.90558926e-02]
 [-5.40894458e-02 -9.92333489e-03  2.69505056e-02]
 [-2.51107837e-02 -4.28064612e-02 -1.19126820e-02]
 [ 2.60003856e-02 -9.09157701e-03 -4.56113435e-02]
 [ 1.32365171e-01 -6.56552828e-03  2.56597140e-01]
 [ 6.95723772e-03 -7.80684786e-02 -6.71670303e-02]
 [ 1.92616823e-02  7.87339163e-02 -6.11293881e-03]
 [ 5.48874946e-02  2.44687022e-02  1.49713586e-01]
 [ 3.17691898e-01 -2.10657967e-01  1.73371285e-01]
 [-8.31130631e-02  1.90849359e-02  3.67970733e-02]
 [ 8.82738123e-02  9.67807794e-03  1.23121072e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.73650837]
curr_Stock_Price:  99.6053700807833
curr_Factors:  [99.60537008 -0.96769282 -0.96027564]
mat_Sqrt:  [[14.48694092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00645866 -0.02068622  0.02050186]
Stock Position:  0.0064586646023544955
Bond Position:  [-1.37982605]


portfolio before change:  [-0.73663145]
curr_Stock_Price:  99.613020182367
curr_Factors:  [99.61302018 -1.00620801 -0.99014175]
mat_Sqrt:  [[13.53045565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01696383  0.02072575 -0.64698971]
Stock Position:  -0.016963826457027688
Bond Position:  [0.95318654]


portfolio before change:  [-0.74114655]
curr_Stock_Price:  99.88620445185188
curr_Factors:  [99.88620445 -1.01705106 -0.97402792]
mat_Sqrt:  [[13.63926278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00194648  0.01475753  0.05247092]
Stock Position:  -0.0019464823179619246
Bond Position:  [-0.54671981]


portfolio before change:  [-0.74173492]
curr_Stock_Price:  100.1533708743858
curr_Factors:  [100.15337087  -0.92648729  -1.01744299]
mat_Sqrt:  [[14.33597981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01098168 0.00951307 0.42046919]
Stock Position:  0.010981681091616912
Bond Position:  [-1.8415873]


portfolio before change:  [-0.73455512]
curr_Stock_Price:  100.82813293247314
curr_Factors:  [100.82813293  -0.804214    -1.01640873]
mat_Sqrt:  [[16.32658374  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00462929 -0.02429186 -0.25171579]
Stock Position:  0.004629294011180581
Bond Position:  [-1.20131819]


portfolio before change:  [-0.72815456]
curr_Stock_Price:  102.24319385913047
curr_Factors:  [102.24319386  -0.82712604  -1.03603479]
mat_Sqrt:  [[15.86623709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00966229 -0.05534923  0.15513819]
Stock Position:  -0.009662290767896582
Bond Position:  [0.25974891]


portfolio before change:  [-0.72172607]
curr_Stock_Price:  101.5812378720984
curr_Factors:  [101.58123787  -1.07486169  -1.03916385]
mat_Sqrt:  [[12.26602589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00760524 -0.05601309 -0.07852628]
Stock Position:  -0.007605239439797241
Bond Position:  [0.05082356]


portfolio before change:  [-0.72143958]
curr_Stock_Price:  101.54440211194668
curr_Factors:  [101.54440211  -1.15431461  -1.02406064]
mat_Sqrt:  [[11.49739993  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01307247 0.19099273 0.23982165]
Stock Position:  0.013072468089639086
Bond Position:  [-2.04887553]


portfolio before change:  [-0.72320394]
curr_Stock_Price:  101.42902732168152
curr_Factors:  [101.42902732  -1.38604849  -1.00518579]
mat_Sqrt:  [[ 9.28244555  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02699037 -0.00242008  0.6476407 ]
Stock Position:  0.026990367185923046
Bond Position:  [-3.46081063]


portfolio before change:  [-0.73230063]
curr_Stock_Price:  101.10802154332654
curr_Factors:  [101.10802154  -1.37996404  -1.03217643]
mat_Sqrt:  [[ 9.06162976  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05610952 0.05421604 0.82893719]
Stock Position:  0.0561095164393772
Bond Position:  [-6.40542282]


portfolio before change:  [-0.72796653]
curr_Stock_Price:  101.1995359127528
curr_Factors:  [101.19953591  -1.27605613  -1.03255841]
mat_Sqrt:  [[10.05911949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01939965 -0.0548065   0.16012679]
Stock Position:  -0.019399650954010812
Bond Position:  [1.23526914]


portfolio before change:  [-0.72019631]
curr_Stock_Price:  100.80696189163942
curr_Factors:  [100.80696189  -0.78740391  -1.00979117]
mat_Sqrt:  [[16.71008352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00211246 -0.00595259  0.25904291]
Stock Position:  -0.0021124569497199073
Bond Position:  [-0.50724594]


portfolio before change:  [-0.716478]
curr_Stock_Price:  99.01676212306452
curr_Factors:  [99.01676212 -0.71623298 -1.01676745]
mat_Sqrt:  [[17.50153728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00139887 -0.01271372  0.40068726]
Stock Position:  0.0013988692859043565
Bond Position:  [-0.85498951]


portfolio before change:  [-0.71685634]
curr_Stock_Price:  98.82270333015644
curr_Factors:  [98.82270333 -0.90154148 -1.04981871]
mat_Sqrt:  [[14.04079722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069029 -0.04804974  0.1342439 ]
Stock Position:  -0.0006902923862373081
Bond Position:  [-0.64863978]


portfolio before change:  [-0.71682351]
curr_Stock_Price:  98.65767280703577
curr_Factors:  [98.65767281 -0.8630349  -1.02793458]
mat_Sqrt:  [[14.88995057  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215     0.03697788 -0.10746648]
Stock Position:  -0.0021499982298932192
Bond Position:  [-0.50470969]


portfolio before change:  [-0.71713295]
curr_Stock_Price:  98.77225270572886
curr_Factors:  [98.77225271 -0.77254245 -1.01917356]
mat_Sqrt:  [[16.46275768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00766713  0.00164822 -0.09272474]
Stock Position:  0.007667128307591379
Bond Position:  [-1.47443248]


portfolio before change:  [-0.70552283]
curr_Stock_Price:  100.31056510106339
curr_Factors:  [100.3105651   -1.04888057  -1.04459043]
mat_Sqrt:  [[12.36413606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00416396  0.00780287 -0.01217963]
Stock Position:  0.004163961297767224
Bond Position:  [-1.12321214]


portfolio before change:  [-0.70511945]
curr_Stock_Price:  100.44115774547288
curr_Factors:  [100.44115775  -1.26291332  -1.06433239]
mat_Sqrt:  [[ 9.7994509   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00453524 -0.01702675  0.13603134]
Stock Position:  -0.004535242883230796
Bond Position:  [-0.24959441]


portfolio before change:  [-0.7045659]
curr_Stock_Price:  100.31222176193423
curr_Factors:  [100.31222176  -1.20812736  -1.08750532]
mat_Sqrt:  [[10.10120641  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00379347 -0.00842536 -0.30057161]
Stock Position:  0.0037934748624275103
Bond Position:  [-1.08509779]


portfolio before change:  [-0.70347734]
curr_Stock_Price:  100.63493443472836
curr_Factors:  [100.63493443  -1.39789092  -1.06152796]
mat_Sqrt:  [[ 8.60273848  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00545632 -0.00030852  0.22767049]
Stock Position:  0.005456320492671016
Bond Position:  [-1.2525738]


portfolio before change:  [-0.69737952]
curr_Stock_Price:  101.78120289011603
curr_Factors:  [101.78120289  -1.50537674  -1.07623423]
mat_Sqrt:  [[ 7.69995485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213155  0.12113105 -1.01776567]
Stock Position:  -0.0021315459234960503
Bond Position:  [-0.48042821]


portfolio before change:  [-0.69772669]
curr_Stock_Price:  101.91590182755675
curr_Factors:  [101.91590183  -1.47758608  -1.06061452]
mat_Sqrt:  [[ 8.0522164   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01436507 0.02354672 0.31268779]
Stock Position:  0.014365073271496024
Bond Position:  [-2.16175609]


portfolio before change:  [-0.69826156]
curr_Stock_Price:  101.8974796038588
curr_Factors:  [101.8974796   -1.33820351  -1.06439015]
mat_Sqrt:  [[ 9.21998625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00032775 0.02052033 0.03100143]
Stock Position:  0.00032775054277661437
Bond Position:  [-0.73165852]


portfolio before change:  [-0.69835928]
curr_Stock_Price:  101.87839406335736
curr_Factors:  [101.87839406  -1.38723645  -1.04563039]
mat_Sqrt:  [[ 8.94337511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00158653 -0.05029495 -0.7043043 ]
Stock Position:  -0.0015865315113724181
Bond Position:  [-0.536726]


portfolio before change:  [-0.69822489]
curr_Stock_Price:  101.75139454800448
curr_Factors:  [101.75139455  -1.31136618  -1.08079046]
mat_Sqrt:  [[ 9.30336245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00747631  0.01141986 -0.04319867]
Stock Position:  0.007476312035388183
Bond Position:  [-1.45895006]


portfolio before change:  [-0.69998105]
curr_Stock_Price:  101.54089240948574
curr_Factors:  [101.54089241  -1.30929202  -1.07457507]
mat_Sqrt:  [[ 9.36139674  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00067387  0.00402864  0.19361566]
Stock Position:  -0.0006738654929376572
Bond Position:  [-0.63155614]


portfolio before change:  [-0.70012335]
curr_Stock_Price:  101.63490131532366
curr_Factors:  [101.63490132  -1.17387626  -1.10759551]
mat_Sqrt:  [[10.38035647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00482363 -0.01079818  0.05666141]
Stock Position:  0.00482362978896282
Bond Position:  [-1.19037248]


portfolio before change:  [-0.70089468]
curr_Stock_Price:  101.50584323502066
curr_Factors:  [101.50584324  -1.00422478  -1.08897237]
mat_Sqrt:  [[12.51489095  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00697766 -0.02095081 -0.09334472]
Stock Position:  0.00697766281909378
Bond Position:  [-1.40916823]


portfolio before change:  [-0.70559453]
curr_Stock_Price:  100.85753260162541
curr_Factors:  [100.8575326   -0.92186331  -1.12210366]
mat_Sqrt:  [[13.06245372  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00416878 -0.01323046  0.05436116]
Stock Position:  -0.004168782889314531
Bond Position:  [-0.28514137]


portfolio before change:  [-0.71055456]
curr_Stock_Price:  102.03878556009711
curr_Factors:  [102.03878556  -1.40894425  -1.12933109]
mat_Sqrt:  [[ 8.06132269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0062786  -0.00320274  0.07688229]
Stock Position:  -0.006278596093627549
Bond Position:  [-0.06989424]


portfolio before change:  [-0.71157632]
curr_Stock_Price:  102.20013127931328
curr_Factors:  [102.20013128  -1.40613644  -1.15284946]
mat_Sqrt:  [[ 7.90857061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00458746 -0.01381573 -0.03398357]
Stock Position:  -0.004587463884658022
Bond Position:  [-0.24273691]


portfolio before change:  [-0.71283366]
curr_Stock_Price:  102.46759787396424
curr_Factors:  [102.46759787  -1.51970005  -1.13287815]
mat_Sqrt:  [[ 7.22081935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00205437 -0.00293429 -0.13011647]
Stock Position:  0.002054365028017535
Bond Position:  [-0.92333951]


portfolio before change:  [-0.71237629]
curr_Stock_Price:  102.74641738432295
curr_Factors:  [102.74641738  -1.72713558  -1.12350298]
mat_Sqrt:  [[ 5.93950281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03087845 -0.00211902  0.73200022]
Stock Position:  0.030878453325085393
Bond Position:  [-3.88502674]


portfolio before change:  [-0.70290261]
curr_Stock_Price:  103.0689511025597
curr_Factors:  [103.0689511   -1.62682075  -1.12973283]
mat_Sqrt:  [[ 6.54593736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00346609 -0.02519649 -0.19160884]
Stock Position:  -0.003466094334118662
Bond Position:  [-0.3456559]


portfolio before change:  [-0.7057571]
curr_Stock_Price:  103.88003377475806
curr_Factors:  [103.88003377  -1.63912111  -1.14914316]
mat_Sqrt:  [[ 6.3915221   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0053329   0.02541126 -0.01743851]
Stock Position:  0.005332904552712898
Bond Position:  [-1.25973941]


portfolio before change:  [-0.70553518]
curr_Stock_Price:  103.95117667947251
curr_Factors:  [103.95117668  -1.44061976  -1.15579099]
mat_Sqrt:  [[ 7.74858764  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0116721  0.00789724 0.42709119]
Stock Position:  0.011672102011416736
Bond Position:  [-1.91886392]


portfolio before change:  [-0.70382815]
curr_Stock_Price:  104.11797676228507
curr_Factors:  [104.11797676  -1.39268261  -1.13017313]
mat_Sqrt:  [[ 8.35340226  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0371203  -0.06798957  0.49458002]
Stock Position:  0.03712029858808971
Bond Position:  [-4.56871853]


portfolio before change:  [-0.71022752]
curr_Stock_Price:  103.96096713606546
curr_Factors:  [103.96096714  -1.56055869  -1.13109816]
mat_Sqrt:  [[ 7.04528541  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0101779   0.00615964  0.10497181]
Stock Position:  -0.010177897916571123
Bond Position:  [0.34787659]


portfolio before change:  [-0.71194852]
curr_Stock_Price:  104.13433183909447
curr_Factors:  [104.13433184  -1.45498886  -1.12570958]
mat_Sqrt:  [[ 7.88516603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01463271 0.00312359 0.35123015]
Stock Position:  0.014632707131143318
Bond Position:  [-2.2357157]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.71647692]
Stock Price:  103.84396045847339
PL:  [-4.56043738]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.61547909e-01 -9.35248744e-02  1.89988653e-02]
 [-1.18258912e-01  6.99469136e-02 -1.25048222e-01]
 [-1.56204688e-02  2.75740024e-02  3.54459711e-02]
 [ 2.29809946e-03 -3.86491890e-02  6.26993282e-02]
 [ 5.70065593e-02  3.89400611e-03 -7.73530626e-02]
 [-7.39002616e-02 -1.53251086e-01  1.49399755e-01]
 [-6.17158385e-02 -1.68048412e-01  7.84576143e-02]
 [ 1.99759637e-02  8.48097943e-01  1.35111789e-01]
 [-2.78647821e-02  1.16080269e-01 -8.32167179e-02]
 [ 2.07095120e-01  7.17688180e-02  8.42575433e-02]
 [-1.22264960e-01 -2.67664552e-01 -2.73396133e-02]
 [ 2.35373843e-02 -1.50962117e-02  1.04346574e-01]
 [-3.34143330e-02  1.82289727e-01 -1.16282129e-01]
 [ 1.36841252e-02 -2.02430361e-01  3.95320495e-02]
 [-6.07348235e-02  1.51867365e-01 -3.02899896e-02]
 [ 1.21520479e-01  2.18072138e-03 -2.45908076e-02]
 [ 4.54758390e-02  4.67831971e-02 -3.16324077e-02]
 [-2.91404081e-02 -5.80367676e-02 -1.59440977e-02]
 [ 5.51572644e-03  3.04912839e-02 -9.00498518e-02]
 [-6.14919252e-03 -2.01935687e-02 -2.27576926e-02]
 [-2.04859617e-02  3.45904805e-01 -2.83184896e-01]
 [-9.33560226e-03  5.04180341e-03 -2.86787411e-02]
 [ 1.71503117e-03 -3.22610585e-02  6.90591821e-02]
 [ 1.08576202e-02 -7.71773952e-02 -1.45193976e-01]
 [ 2.93113733e-02  2.05022362e-02 -1.20441649e-02]
 [-9.46301860e-02 -1.93235742e-02  2.28178482e-01]
 [-3.64731441e-02 -3.32977132e-02 -5.84708552e-03]
 [-9.56300033e-02  1.19494053e-01 -8.32968402e-02]
 [ 1.06439053e-01 -6.69129994e-03  1.46490407e-01]
 [ 5.73961866e-02  5.67799476e-02 -1.03283406e-01]
 [ 1.65819770e-02  1.61122021e-03 -4.07457667e-03]
 [-4.59974138e-02  1.94569350e-02 -1.22962497e-01]
 [-1.25568435e-02  6.90163476e-02 -5.22920113e-02]
 [ 4.63994582e-02 -3.97389115e-02  1.85391069e-01]
 [-7.51427042e-02 -1.60651406e-03 -3.37932242e-02]
 [-1.90897270e-01 -1.96025101e-01 -1.74346907e-01]
 [ 1.19321514e-01  1.08722268e-01  2.81180165e-01]
 [ 2.02493816e-01 -1.37716034e-01 -2.36150177e-01]
 [ 9.79161804e-02  3.70438741e-03  6.60401685e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.92682398]
curr_Stock_Price:  100.57150512752332
curr_Factors:  [100.57150513  -1.14693209  -0.99327132]
mat_Sqrt:  [[11.83031805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01494131 -0.03018502  0.05419847]
Stock Position:  -0.014941311505974835
Bond Position:  [8.42949416]


portfolio before change:  [6.9289977]
curr_Stock_Price:  100.49654709129392
curr_Factors:  [100.49654709  -1.04736233  -0.983498  ]
mat_Sqrt:  [[13.18741592  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00982045  0.02257527 -0.35672777]
Stock Position:  -0.009820454633794301
Bond Position:  [7.91591948]


portfolio before change:  [6.92914408]
curr_Stock_Price:  100.5824060212
curr_Factors:  [100.58240602  -1.31335003  -0.98034414]
mat_Sqrt:  [[10.14806639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027164  0.00889947  0.10111749]
Stock Position:  -0.0002716350521223435
Bond Position:  [6.95646579]


portfolio before change:  [6.9300655]
curr_Stock_Price:  100.3916889493111
curr_Factors:  [100.39168895  -1.31081532  -0.98052601]
mat_Sqrt:  [[10.15268389  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00070989 -0.01247397  0.17886373]
Stock Position:  0.0007098924414104791
Bond Position:  [6.8587982]


portfolio before change:  [6.93058215]
curr_Stock_Price:  99.91168330430972
curr_Factors:  [99.9116833  -1.27558721 -0.95602232]
mat_Sqrt:  [[10.72606865  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00391679  0.00125679 -0.22066676]
Stock Position:  0.003916793146944214
Bond Position:  [6.53924875]


portfolio before change:  [6.9300304]
curr_Stock_Price:  99.56210901680038
curr_Factors:  [99.56210902 -1.47006923 -0.96663584]
mat_Sqrt:  [[ 8.70655854  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00857818 -0.04946158  0.42619592]
Stock Position:  -0.008578178238422402
Bond Position:  [7.78409191]


portfolio before change:  [6.93414382]
curr_Stock_Price:  99.19602249024685
curr_Factors:  [99.19602249 -1.43962744 -0.94528801]
mat_Sqrt:  [[ 9.13563288  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0087573  -0.05423739  0.22381774]
Stock Position:  -0.008757300629179291
Bond Position:  [7.80283321]


portfolio before change:  [6.94232295]
curr_Stock_Price:  98.37342753505672
curr_Factors:  [98.37342754 -1.60557337 -0.9576162 ]
mat_Sqrt:  [[ 7.5805151   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02911053 0.27372243 0.38543633]
Stock Position:  0.029110529672444433
Bond Position:  [4.07862037]


portfolio before change:  [6.94283775]
curr_Stock_Price:  98.37359739539494
curr_Factors:  [98.3735974  -1.61269873 -0.95887867]
mat_Sqrt:  [[ 7.5172099   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281441  0.03746475 -0.23739413]
Stock Position:  -0.002814413613819917
Bond Position:  [7.21970175]


portfolio before change:  [6.94399261]
curr_Stock_Price:  98.28394022547965
curr_Factors:  [98.28394023 -1.32301073 -0.93897167]
mat_Sqrt:  [[10.23566553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02334424 0.02316329 0.24036332]
Stock Position:  0.023344243406245517
Bond Position:  [4.64962838]


portfolio before change:  [6.94310552]
curr_Stock_Price:  98.22104141502172
curr_Factors:  [98.22104142 -1.34273872 -0.93874315]
mat_Sqrt:  [[10.03158478  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01819079 -0.08638836 -0.07799231]
Stock Position:  -0.018190788060362617
Bond Position:  [8.72982367]


portfolio before change:  [6.95332745]
curr_Stock_Price:  97.71910435643059
curr_Factors:  [97.71910436 -1.32999982 -0.9123636 ]
mat_Sqrt:  [[10.37847199  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00402328 -0.00487228  0.29767173]
Stock Position:  0.004023283796987717
Bond Position:  [6.56017576]


portfolio before change:  [6.95337973]
curr_Stock_Price:  97.52826825251977
curr_Factors:  [97.52826825 -1.32692108 -0.9380038 ]
mat_Sqrt:  [[10.12712415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196903  0.05883376 -0.33172055]
Stock Position:  -0.001969027743151661
Bond Position:  [7.1454156]


portfolio before change:  [6.95214844]
curr_Stock_Price:  98.6072382361655
curr_Factors:  [98.60723824 -1.48351312 -0.94746153]
mat_Sqrt:  [[ 8.67261198  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00225622 -0.06533412  0.11277393]
Stock Position:  -0.002256223785490671
Bond Position:  [7.17462844]


portfolio before change:  [6.95431579]
curr_Stock_Price:  98.04414758421774
curr_Factors:  [98.04414758 -1.30772647 -0.93905114]
mat_Sqrt:  [[10.36713027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0034646   0.04901498 -0.08640891]
Stock Position:  -0.00346459865667429
Bond Position:  [7.29399941]


portfolio before change:  [6.95549509]
curr_Stock_Price:  97.9669403027567
curr_Factors:  [97.9669403  -1.32443122 -0.92100651]
mat_Sqrt:  [[10.3728555   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01127424  0.00070382 -0.07015073]
Stock Position:  0.011274237774276883
Bond Position:  [5.85099251]


portfolio before change:  [6.95209326]
curr_Stock_Price:  97.60033025622275
curr_Factors:  [97.60033026 -1.04743312 -0.89363553]
mat_Sqrt:  [[14.01057256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00346656  0.01509921 -0.09023845]
Stock Position:  0.0034665593279998076
Bond Position:  [6.61375592]


portfolio before change:  [6.9526169]
curr_Stock_Price:  97.51288750169584
curr_Factors:  [97.5128875  -1.1190093  -0.87441889]
mat_Sqrt:  [[13.28394764  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00333046 -0.01873129 -0.04548407]
Stock Position:  -0.003330462463473947
Bond Position:  [7.27737991]


portfolio before change:  [6.95275651]
curr_Stock_Price:  97.74412390463641
curr_Factors:  [97.7441239  -1.20428583 -0.87417276]
mat_Sqrt:  [[12.23003104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054306  0.00984102 -0.25688716]
Stock Position:  -0.0005430579285059465
Bond Position:  [7.00583723]


portfolio before change:  [6.95374973]
curr_Stock_Price:  97.52787636412236
curr_Factors:  [97.52787636 -1.24324961 -0.85919042]
mat_Sqrt:  [[11.91380987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00125204 -0.00651745 -0.06492136]
Stock Position:  -0.0012520413024225102
Bond Position:  [7.07585866]


portfolio before change:  [6.95623311]
curr_Stock_Price:  96.25088300429209
curr_Factors:  [96.250883   -1.19897066 -0.85507219]
mat_Sqrt:  [[12.34085493  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.22591697e-04  1.11640296e-01 -8.07847685e-01]
Stock Position:  -0.0006225916968160282
Bond Position:  [7.01615811]


portfolio before change:  [6.95652198]
curr_Stock_Price:  97.19564863607467
curr_Factors:  [97.19564864 -1.39212889 -0.85835697]
mat_Sqrt:  [[10.23936997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138294  0.00162724 -0.08181247]
Stock Position:  -0.0013829436787132887
Bond Position:  [7.09093809]


portfolio before change:  [6.95633709]
curr_Stock_Price:  97.97031173101733
curr_Factors:  [97.97031173 -0.86634666 -0.90950127]
mat_Sqrt:  [[16.59027306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00055613 -0.01041221  0.19700662]
Stock Position:  0.0005561341063895233
Bond Position:  [6.90185246]


portfolio before change:  [6.95812252]
curr_Stock_Price:  99.6293377221327
curr_Factors:  [99.62933772 -0.78033351 -0.94276314]
mat_Sqrt:  [[17.78508231  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00194173 -0.0249089  -0.414198  ]
Stock Position:  -0.0019417253808671564
Bond Position:  [7.15157533]


portfolio before change:  [6.95956664]
curr_Stock_Price:  99.34602543791492
curr_Factors:  [99.34602544 -0.8765463  -0.92493415]
mat_Sqrt:  [[16.39749391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00189284  0.00661707 -0.03435865]
Stock Position:  0.0018928422891086071
Bond Position:  [6.77152028]


portfolio before change:  [6.95999831]
curr_Stock_Price:  99.12687666210235
curr_Factors:  [99.12687666 -0.61427481 -0.91337831]
mat_Sqrt:  [[21.51493827  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00241683 -0.00623666  0.6509297 ]
Stock Position:  -0.002416825732576749
Bond Position:  [7.1995707]


portfolio before change:  [6.96511429]
curr_Stock_Price:  97.38244952732667
curr_Factors:  [97.38244953 -0.39890653 -0.91305423]
mat_Sqrt:  [[26.22426798  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00169551 -0.01074679 -0.01668011]
Stock Position:  -0.001695511297875811
Bond Position:  [7.13022734]


portfolio before change:  [6.96803841]
curr_Stock_Price:  96.18352932111782
curr_Factors:  [96.18352932 -0.81265439 -0.93161329]
mat_Sqrt:  [[16.81027743  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524925  0.03856654 -0.2376227 ]
Stock Position:  -0.0052492457975365225
Bond Position:  [7.4729294]


portfolio before change:  [6.97537275]
curr_Stock_Price:  94.96427516290746
curr_Factors:  [94.96427516 -0.97340504 -0.94995321]
mat_Sqrt:  [[13.87574733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00972743 -0.00215961  0.41789636]
Stock Position:  0.009727434721021848
Bond Position:  [6.05161396]


portfolio before change:  [6.97402599]
curr_Stock_Price:  94.7480557398556
curr_Factors:  [94.74805574 -0.90617778 -0.93794006]
mat_Sqrt:  [[14.98580589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00319661  0.01832565 -0.29463881]
Stock Position:  0.003196605389302377
Bond Position:  [6.67115384]


portfolio before change:  [6.96918106]
curr_Stock_Price:  92.97152435397045
curr_Factors:  [92.97152435 -0.85065138 -0.96143131]
mat_Sqrt:  [[15.18351905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00105899  0.00052002 -0.01162363]
Stock Position:  0.0010589868129485152
Bond Position:  [6.87072545]


portfolio before change:  [6.97052072]
curr_Stock_Price:  93.42550884818833
curr_Factors:  [93.42550885 -1.12343711 -0.95084967]
mat_Sqrt:  [[11.73854226  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00571838  0.0062797  -0.35077778]
Stock Position:  -0.005718375977673202
Bond Position:  [7.50476291]


portfolio before change:  [6.97362142]
curr_Stock_Price:  93.04733453162338
curr_Factors:  [93.04733453 -0.88103486 -0.94256977]
mat_Sqrt:  [[15.02181846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060865  0.02227493 -0.14917455]
Stock Position:  -0.0006086481890227435
Bond Position:  [7.03025451]


portfolio before change:  [6.9740034]
curr_Stock_Price:  93.86367021608751
curr_Factors:  [93.86367022 -1.06075524 -0.92590206]
mat_Sqrt:  [[12.87369543  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00591365 -0.01282568  0.52886912]
Stock Position:  0.005913653988938801
Bond Position:  [6.41892613]


portfolio before change:  [6.97298286]
curr_Stock_Price:  93.55540923416831
curr_Factors:  [93.55540923 -1.00339986 -0.91920805]
mat_Sqrt:  [[13.68015114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00602103 -0.0005185  -0.09640266]
Stock Position:  -0.006021033298588909
Bond Position:  [7.5362831]


portfolio before change:  [6.97582873]
curr_Stock_Price:  93.23922251392042
curr_Factors:  [93.23922251 -1.03708371 -0.90969964]
mat_Sqrt:  [[13.30826308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02002509 -0.06326683 -0.4973632 ]
Stock Position:  -0.020025087994614766
Bond Position:  [8.84295236]


portfolio before change:  [6.98147172]
curr_Stock_Price:  93.01262881941369
curr_Factors:  [93.01262882 -1.00302986 -0.89359775]
mat_Sqrt:  [[13.95876559  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01424983 0.03508996 0.80212875]
Stock Position:  0.014249828438704504
Bond Position:  [5.65605772]


portfolio before change:  [6.97594811]
curr_Stock_Price:  92.57538412353229
curr_Factors:  [92.57538412 -0.84649752 -0.91949813]
mat_Sqrt:  [[15.83191159  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0079699  -0.04444766 -0.67367072]
Stock Position:  0.007969896381673421
Bond Position:  [6.23813189]


portfolio before change:  [6.98219826]
curr_Stock_Price:  93.26175882153919
curr_Factors:  [93.26175882 -1.1838313  -0.91068925]
mat_Sqrt:  [[11.48325164  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00976664 0.00119559 0.18839422]
Stock Position:  0.009766635081865812
Bond Position:  [6.0713447]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.97751918]
Stock Price:  92.70495976171347
PL:  [6.97751918]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.16426773e-01  7.29648309e-02 -1.03803950e-02]
 [-1.94184748e-01  2.58018540e-02 -1.43540302e-02]
 [-4.50063725e-02  5.05536286e-02  1.52816187e-02]
 [ 1.20321059e-01  3.09119565e-02  1.45909351e-01]
 [ 1.06692356e-02  8.88440210e-02 -6.22841420e-02]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.19689708e-02 -1.85289854e-01 -2.78115720e-02]
 [ 1.26522680e-02  6.67552953e-01  9.25379904e-02]
 [ 2.84979304e-01 -4.43793942e-03  3.01899074e-01]
 [ 4.94515961e-01  2.05103519e-01  3.70419812e-01]
 [-2.03362664e-01 -2.23743426e-01  2.37847625e-02]
 [ 6.46611568e-03 -1.48220350e-02  1.07001059e-01]
 [ 1.45999175e-02 -5.64881390e-02  6.37885447e-02]
 [ 1.08236788e-02 -9.57422243e-02 -7.73512260e-02]
 [ 3.87797201e-02 -4.96600381e-02 -7.84555488e-02]
 [ 7.21405912e-02 -1.18646363e-02  1.66217442e-02]
 [ 4.83354952e-02  2.25338018e-02 -9.62214311e-03]
 [-5.21982781e-02 -5.79551702e-02  3.51687043e-02]
 [ 8.70617923e-02 -5.73090637e-02 -7.60584325e-02]
 [ 1.20656380e-02  1.50406787e-02  2.14392790e-03]
 [-4.13277367e-02  5.36719189e-01 -5.16173784e-01]
 [ 4.68676184e-01  2.59700612e-01  4.60573150e-02]
 [ 2.56842096e-02  1.16991726e-01 -2.14464218e-02]
 [-5.67727088e-02 -1.24240858e-01 -2.61327473e-02]
 [ 3.60887900e-02 -5.18836772e-03 -1.17880770e-02]
 [-5.48244827e-02 -3.83444546e-03  1.60640950e-01]
 [ 1.72757293e-02 -3.30650795e-02  6.89297430e-03]
 [ 1.38456068e-01 -6.79146413e-02  6.50679984e-02]
 [-4.34632984e-02 -7.87026057e-03 -4.59994439e-02]
 [-9.67624571e-02 -9.28963181e-03  5.03695653e-02]
 [ 9.62884554e-02  3.36257445e-02  1.01088148e-01]
 [ 1.19179439e-02  1.30163925e-01 -1.07462287e-01]
 [-5.36045390e-03  8.20611387e-02 -2.15722802e-02]
 [ 2.14776404e-03 -1.77235993e-01  3.77866695e-02]
 [-6.20257937e-02  7.18704446e-02 -6.05282432e-02]
 [-2.31145082e-01 -2.38537008e-01 -2.17360125e-01]
 [ 1.16028354e-01  1.22495861e-01  3.15025674e-01]
 [ 2.39616317e-01 -1.62260806e-01 -3.30714881e-01]
 [ 9.15423151e-02  7.65315794e-03  1.03772185e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.21518385]
curr_Stock_Price:  99.16680495785201
curr_Factors:  [99.16680496 -0.90168758 -1.03333558]
mat_Sqrt:  [[14.32176168  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00723736  0.0235493  -0.02961238]
Stock Position:  -0.00723736230154928
Bond Position:  [-3.49747775]


portfolio before change:  [-4.21137836]
curr_Stock_Price:  98.58058304527458
curr_Factors:  [98.58058305 -0.73915525 -1.02947911]
mat_Sqrt:  [[16.81447228  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01140969  0.00832751 -0.04094805]
Stock Position:  -0.011409693242347342
Bond Position:  [-3.08660415]


portfolio before change:  [-4.21985055]
curr_Stock_Price:  99.28930848511088
curr_Factors:  [99.28930849 -0.71319079 -1.03930464]
mat_Sqrt:  [[17.21089247  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183418  0.01631611  0.0435942 ]
Stock Position:  -0.001834176176065112
Bond Position:  [-4.03773646]


portfolio before change:  [-4.22224855]
curr_Stock_Price:  100.32151488197812
curr_Factors:  [100.32151488  -0.89107062  -1.03492507]
mat_Sqrt:  [[14.61991266  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01069873 0.00997679 0.41623876]
Stock Position:  0.010698734054700199
Bond Position:  [-5.29556175]


portfolio before change:  [-4.23089381]
curr_Stock_Price:  99.57532625630859
curr_Factors:  [99.57532626 -0.98681772 -1.00459539]
mat_Sqrt:  [[13.59227069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00118382  0.02867428 -0.17767932]
Stock Position:  0.001183816050368952
Bond Position:  [-4.34877268]


portfolio before change:  [-4.22922557]
curr_Stock_Price:  101.4437446946586
curr_Factors:  [101.44374469  -1.0495747   -1.02632674]
mat_Sqrt:  [[12.72543769  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01204707 -0.05534923  0.15513819]
Stock Position:  -0.01204706666501988
Bond Position:  [-3.00712602]


portfolio before change:  [-4.23568971]
curr_Stock_Price:  101.94911419060318
curr_Factors:  [101.94911419  -1.08034009  -1.01542518]
mat_Sqrt:  [[12.53730424  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00761472 -0.05980204 -0.07933867]
Stock Position:  -0.0076147244654694145
Bond Position:  [-3.45937529]


portfolio before change:  [-4.23010897]
curr_Stock_Price:  101.15943514764328
curr_Factors:  [101.15943515  -0.84203936  -0.99574312]
mat_Sqrt:  [[16.101547    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01042168 0.21545179 0.26398513]
Stock Position:  0.010421680727064076
Bond Position:  [-5.2843603]


portfolio before change:  [-4.22186221]
curr_Stock_Price:  102.01412860833116
curr_Factors:  [102.01412861  -1.21996952  -0.96213523]
mat_Sqrt:  [[11.50758713  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0300409  -0.00143234  0.86123402]
Stock Position:  0.030040902585431878
Bond Position:  [-7.28645871]


portfolio before change:  [-4.24239281]
curr_Stock_Price:  101.36102776017596
curr_Factors:  [101.36102776  -1.08969081  -0.97482495]
mat_Sqrt:  [[12.8606584   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04758653 0.06619688 1.05670462]
Stock Position:  0.04758653485799156
Bond Position:  [-9.0658129]


portfolio before change:  [-4.21589813]
curr_Stock_Price:  101.94161185123615
curr_Factors:  [101.94161185  -1.30399264  -0.97018015]
mat_Sqrt:  [[10.48795466  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02328186 -0.07221288  0.06785131]
Stock Position:  -0.023281856452109843
Bond Position:  [-1.84250815]


portfolio before change:  [-4.22055158]
curr_Stock_Price:  102.13159351378658
curr_Factors:  [102.13159351  -1.19161246  -0.93940731]
mat_Sqrt:  [[12.12467141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00208518 -0.00478379  0.30524424]
Stock Position:  0.002085176517858601
Bond Position:  [-4.43351398]


portfolio before change:  [-4.22156844]
curr_Stock_Price:  101.90972558326497
curr_Factors:  [101.90972558  -1.16507983  -0.9157476 ]
mat_Sqrt:  [[12.72107348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00126484 -0.01823147  0.18197096]
Stock Position:  0.0012648387405969467
Bond Position:  [-4.35046781]


portfolio before change:  [-4.22372653]
curr_Stock_Price:  100.63347733701137
curr_Factors:  [100.63347734  -1.07030194  -0.93329261]
mat_Sqrt:  [[13.57039281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180605 -0.03090067 -0.22066152]
Stock Position:  -0.0018060548572401134
Bond Position:  [-4.04197695]


portfolio before change:  [-4.22334615]
curr_Stock_Price:  100.14309639592112
curr_Factors:  [100.1430964   -1.01490127  -0.92768679]
mat_Sqrt:  [[14.35376196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00087979 -0.01602771 -0.22381184]
Stock Position:  0.0008797857634376687
Bond Position:  [-4.31145062]


portfolio before change:  [-4.22408404]
curr_Stock_Price:  99.9169879242453
curr_Factors:  [99.91698792 -1.09785865 -0.9395132 ]
mat_Sqrt:  [[13.02626711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00561263 -0.00382929  0.04741721]
Stock Position:  0.005612631090646115
Bond Position:  [-4.78488124]


portfolio before change:  [-4.2205303]
curr_Stock_Price:  100.65672855931476
curr_Factors:  [100.65672856  -1.01735921  -0.94935635]
mat_Sqrt:  [[14.08345128  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00361922  0.00727275 -0.0274493 ]
Stock Position:  0.003619217723165732
Bond Position:  [-4.58482892]


portfolio before change:  [-4.22154834]
curr_Stock_Price:  100.5338006004288
curr_Factors:  [100.5338006   -0.97983543  -0.94360956]
mat_Sqrt:  [[14.6882668   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00387041 -0.01870495  0.10032652]
Stock Position:  -0.0038704053229064407
Bond Position:  [-3.83244179]


portfolio before change:  [-4.22587469]
curr_Stock_Price:  101.52782134827372
curr_Factors:  [101.52782135  -0.87262701  -0.94599036]
mat_Sqrt:  [[16.4728816   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00363253 -0.01849642 -0.21697354]
Stock Position:  0.003632531790738683
Bond Position:  [-4.59467773]


portfolio before change:  [-4.22911213]
curr_Stock_Price:  100.79470484888012
curr_Factors:  [100.79470485  -0.83754446  -0.9602679 ]
mat_Sqrt:  [[16.69774138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00093267 0.00485436 0.00611603]
Stock Position:  0.0009326669293735198
Bond Position:  [-4.32312002]


portfolio before change:  [-4.23016701]
curr_Stock_Price:  100.24311304153451
curr_Factors:  [100.24311304  -0.58552014  -0.93847268]
mat_Sqrt:  [[21.83699479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170051  0.17322537 -1.47250013]
Stock Position:  -0.0017005052177162903
Bond Position:  [-4.05970307]


portfolio before change:  [-4.23275171]
curr_Stock_Price:  101.46463454854383
curr_Factors:  [101.46463455  -0.47900653  -0.95212353]
mat_Sqrt:  [[24.25396839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02189698 0.08381801 0.1313887 ]
Stock Position:  0.021896984061653534
Bond Position:  [-6.45452119]


portfolio before change:  [-4.22062516]
curr_Stock_Price:  102.05528244911635
curr_Factors:  [102.05528245  -0.35970079  -0.95496427]
mat_Sqrt:  [[27.40840141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00164867  0.03775892 -0.06118067]
Stock Position:  0.0016486664953715509
Bond Position:  [-4.38888029]


portfolio before change:  [-4.2209776]
curr_Stock_Price:  102.17429512027593
curr_Factors:  [ 1.02174295e+02 -7.56478122e-02 -9.30031229e-01]
mat_Sqrt:  [[37.37496479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00234027 -0.04009856 -0.07454945]
Stock Position:  -0.00234027223849648
Bond Position:  [-3.98186193]


portfolio before change:  [-4.22182669]
curr_Stock_Price:  102.32441823423561
curr_Factors:  [102.32441823  -0.22765822  -0.95403225]
mat_Sqrt:  [[31.389011    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00103933 -0.00167454 -0.0336281 ]
Stock Position:  0.0010393283080541143
Bond Position:  [-4.32817535]


portfolio before change:  [-4.22248468]
curr_Stock_Price:  102.21190866428215
curr_Factors:  [ 1.02211909e+02 -6.25006019e-02 -9.97366562e-01]
mat_Sqrt:  [[35.41661393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064423 -0.00123756  0.45826392]
Stock Position:  -0.0006442312364821029
Bond Position:  [-4.15663657]


portfolio before change:  [-4.2223372]
curr_Stock_Price:  101.17641892789058
curr_Factors:  [101.17641893   0.17096825  -1.02236042]
mat_Sqrt:  [[43.18415102  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00027634 -0.01067171  0.01966374]
Stock Position:  0.0002763368130154493
Bond Position:  [-4.25029596]


portfolio before change:  [-4.22263529]
curr_Stock_Price:  102.02041663258665
curr_Factors:  [ 1.02020417e+02  4.21950366e-03 -1.03263988e+00]
mat_Sqrt:  [[36.4795772   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00377951 -0.02191936  0.18562089]
Stock Position:  0.0037795119859174017
Bond Position:  [-4.60822268]


portfolio before change:  [-4.21498869]
curr_Stock_Price:  104.19600492172748
curr_Factors:  [ 1.04196005e+02  4.12793152e-02 -1.01607283e+00]
mat_Sqrt:  [[39.31005263  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138538 -0.00254012 -0.13122361]
Stock Position:  -0.0013853811463845377
Bond Position:  [-4.07063751]


portfolio before change:  [-4.21232163]
curr_Stock_Price:  101.90355295572964
curr_Factors:  [101.90355296  -0.12745337  -1.02604756]
mat_Sqrt:  [[32.15364672  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00274859 -0.00299822  0.14369035]
Stock Position:  -0.0027485856124960547
Bond Position:  [-3.93223099]


portfolio before change:  [-4.20048518]
curr_Stock_Price:  97.41833158115837
curr_Factors:  [97.41833158  0.15442195 -1.03633248]
mat_Sqrt:  [[40.33033322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00306932 0.01085266 0.28837635]
Stock Position:  0.0030693228582258027
Bond Position:  [-4.49949349]


portfolio before change:  [-4.21177217]
curr_Stock_Price:  93.92422986133823
curr_Factors:  [93.92422986  0.3349691  -1.02803351]
mat_Sqrt:  [[46.96600196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00035242  0.04201023 -0.30655999]
Stock Position:  0.00035242293989823175
Bond Position:  [-4.24487323]


portfolio before change:  [-4.2126957]
curr_Stock_Price:  92.80941444951874
curr_Factors:  [92.80941445  0.2583368  -1.04619798]
mat_Sqrt:  [[42.21125539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00016552  0.02648512 -0.06153971]
Stock Position:  0.00016551942311120196
Bond Position:  [-4.22805746]


portfolio before change:  [-4.21319162]
curr_Stock_Price:  93.00652132803329
curr_Factors:  [93.00652133  0.50025452 -1.04419756]
mat_Sqrt:  [[53.98609822  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048748 -0.05720267  0.10779485]
Stock Position:  -0.0004874812384722416
Bond Position:  [-4.16785268]


portfolio before change:  [-4.21373267]
curr_Stock_Price:  93.0476293635092
curr_Factors:  [93.04762936  0.38630756 -1.05277081]
mat_Sqrt:  [[47.78196477  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124965  0.02319609 -0.17267023]
Stock Position:  -0.0012496467412020328
Bond Position:  [-4.097456]


portfolio before change:  [-4.21180615]
curr_Stock_Price:  91.09608690119693
curr_Factors:  [91.0960869   0.2792274  -1.04032175]
mat_Sqrt:  [[42.5559847   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00761831 -0.07698749 -0.62006793]
Stock Position:  -0.007618310253803726
Bond Position:  [-3.51780789]


portfolio before change:  [-4.21153914]
curr_Stock_Price:  91.00331605265639
curr_Factors:  [91.00331605  0.36722264 -1.02972227]
mat_Sqrt:  [[46.91776203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00437653 0.03953537 0.89868056]
Stock Position:  0.004376531503338717
Bond Position:  [-4.60981802]


portfolio before change:  [-4.22480151]
curr_Stock_Price:  88.10464943473
curr_Factors:  [88.10464943  0.31537161 -1.02650096]
mat_Sqrt:  [[43.26724823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00321232 -0.05236945 -0.9434375 ]
Stock Position:  0.0032123160487463366
Bond Position:  [-4.50782149]


portfolio before change:  [-4.22920272]
curr_Stock_Price:  86.9099677099475
curr_Factors:  [86.90996771  0.36624176 -1.03159272]
mat_Sqrt:  [[44.67981203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00255791 0.00247005 0.29603316]
Stock Position:  0.0025579095515175154
Bond Position:  [-4.45151056]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.23195483]
Stock Price:  86.05159797496576
PL:  [-4.23195483]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.55653193e-01 -5.76906881e-02  5.21630865e-03]
 [-1.74194388e-01  6.58417906e-02 -1.97937433e-01]
 [-3.75601180e-02  4.45996696e-02  1.98723008e-02]
 [ 6.56043581e-02  6.75190782e-03  1.06164796e-01]
 [ 1.00851422e-01 -6.47347198e-02 -8.71781528e-02]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.27591896e-02 -1.51236685e-01 -2.69855150e-02]
 [ 1.33707957e-02  6.74178043e-01  9.21662552e-02]
 [ 3.18945844e-01  9.56075091e-03  3.27113999e-01]
 [ 6.03319895e-01  2.52068325e-01  4.67421595e-01]
 [-2.86588705e-01 -2.97408145e-01 -1.06502819e-03]
 [-6.01869621e-02 -1.87934601e-02  8.95514031e-02]
 [ 4.27001195e-03 -5.56138117e-02  1.42982077e-01]
 [ 9.27239847e-03 -1.11306015e-01  5.23381571e-02]
 [-8.18757276e-02  1.96255300e-01 -3.99278707e-02]
 [ 5.48292668e-02 -1.67291625e-02  9.43962705e-03]
 [ 5.78481310e-02  5.96509348e-02 -1.16469892e-01]
 [ 1.08612242e-02 -4.73171672e-02 -4.40846408e-02]
 [ 1.41705573e-02  8.60930284e-02 -1.92151017e-01]
 [-4.62979913e-02  1.25292040e-02 -4.78573870e-02]
 [-4.68935199e-02  5.57159230e-01 -5.19128420e-01]
 [ 4.62171420e-01  2.56588105e-01  4.71165698e-02]
 [ 2.43548334e-03 -3.55029450e-02  7.10355278e-02]
 [-4.01721703e-02 -5.58849610e-02 -3.58258680e-02]
 [ 1.33317633e-02  2.52110390e-02 -1.03012562e-02]
 [-1.21364362e-01 -1.08557988e-02  2.21881060e-01]
 [-4.71192575e-02 -3.37571354e-02 -9.94234368e-03]
 [-8.58455290e-02  1.10940356e-01 -7.90572727e-02]
 [ 6.61083632e-02 -3.88322285e-02  1.22401997e-01]
 [ 3.50594247e-02  4.67168268e-02 -8.05679729e-02]
 [ 2.57908283e-02 -2.03205353e-02 -4.71602749e-02]
 [-4.16229647e-02  5.36834160e-02 -1.38344987e-01]
 [-2.52242655e-02  5.26492841e-02 -9.07721850e-03]
 [ 4.79663280e-02 -4.05443759e-02  1.85938244e-01]
 [-7.39417903e-02 -3.91815295e-03 -3.05851924e-02]
 [-1.23384522e-01 -1.50390383e-01 -1.12632492e-01]
 [ 6.86174835e-02  1.05191693e-01  1.96629877e-01]
 [ 1.63743641e-01 -1.18701405e-01 -1.56254620e-01]
 [ 9.87282271e-02  3.20130395e-03  6.12330133e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.38347957]
curr_Stock_Price:  99.52380483930861
curr_Factors:  [99.52380484 -1.15494647 -0.98103318]
mat_Sqrt:  [[11.75662849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01232853 -0.01861959  0.01488068]
Stock Position:  0.012328526438174777
Bond Position:  [-2.61046143]


portfolio before change:  [-1.37918501]
curr_Stock_Price:  99.89861750200006
curr_Factors:  [99.8986175  -1.10140213 -0.98312406]
mat_Sqrt:  [[12.42399457  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01619111  0.02125035 -0.5646604 ]
Stock Position:  -0.016191112832460518
Bond Position:  [0.23828477]


portfolio before change:  [-1.37946621]
curr_Stock_Price:  99.91782465579145
curr_Factors:  [99.91782466 -1.04940094 -0.99848127]
mat_Sqrt:  [[12.89018129  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0018929   0.01439448  0.05669014]
Stock Position:  -0.0018929006177120563
Bond Position:  [-1.1903317]


portfolio before change:  [-1.38062873]
curr_Stock_Price:  100.45335949697434
curr_Factors:  [100.4533595   -1.04329688  -0.98486159]
mat_Sqrt:  [[13.21741217  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00670732 0.00217917 0.30285861]
Stock Position:  0.006707317797436779
Bond Position:  [-2.05440133]


portfolio before change:  [-1.37927022]
curr_Stock_Price:  100.69418922602885
curr_Factors:  [100.69418923  -0.84349004  -0.98255179]
mat_Sqrt:  [[16.21677609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0043068  -0.02089304 -0.248695  ]
Stock Position:  0.004306795430676652
Bond Position:  [-1.8129395]


portfolio before change:  [-1.37528816]
curr_Stock_Price:  101.67140992066956
curr_Factors:  [101.67140992  -0.79381245  -0.98110263]
mat_Sqrt:  [[17.2330847   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00889592 -0.05534923  0.15513819]
Stock Position:  -0.008895923094932206
Bond Position:  [-0.47082712]


portfolio before change:  [-1.3715638]
curr_Stock_Price:  101.24613430307843
curr_Factors:  [101.2461343   -0.87406949  -0.96527163]
mat_Sqrt:  [[16.09024846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00553992 -0.04881143 -0.07698216]
Stock Position:  -0.005539917174734234
Bond Position:  [-0.8106686]


portfolio before change:  [-1.3705589]
curr_Stock_Price:  101.04644820870743
curr_Factors:  [101.04644821  -0.74393654  -0.93723817]
mat_Sqrt:  [[18.81031876  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00902697 0.21759003 0.26292467]
Stock Position:  0.009026969333943409
Bond Position:  [-2.28270209]


portfolio before change:  [-1.36597948]
curr_Stock_Price:  101.58536341580628
curr_Factors:  [101.58536342  -0.89847965  -0.90582878]
mat_Sqrt:  [[16.71975628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0231863  0.00308572 0.93316519]
Stock Position:  0.023186300270574375
Bond Position:  [-3.72136822]


portfolio before change:  [-1.36997218]
curr_Stock_Price:  101.4332262911959
curr_Factors:  [101.43322629  -0.53973723  -0.89664448]
mat_Sqrt:  [[24.11946036  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0311029  0.0813547  1.33342371]
Stock Position:  0.03110289983974676
Bond Position:  [-4.52483966]


portfolio before change:  [-1.36553904]
curr_Stock_Price:  101.59394384874975
curr_Factors:  [101.59394385  -0.48187506  -0.88948626]
mat_Sqrt:  [[25.78060856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01347968 -0.09598807 -0.00303823]
Stock Position:  -0.013479677404876511
Bond Position:  [0.00391455]


portfolio before change:  [-1.338475]
curr_Stock_Price:  99.58621385421927
curr_Factors:  [99.58621385 -0.62637932 -0.86552456]
mat_Sqrt:  [[22.40131943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.002042   -0.00606556  0.25546523]
Stock Position:  -0.0020420028223348437
Bond Position:  [-1.13511967]


portfolio before change:  [-1.34053053]
curr_Stock_Price:  100.52335112509697
curr_Factors:  [100.52335113  -0.47871452  -0.86748254]
mat_Sqrt:  [[26.15899181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00084499 -0.01794928  0.40788807]
Stock Position:  0.0008449860987602122
Bond Position:  [-1.42547137]


portfolio before change:  [-1.34275579]
curr_Stock_Price:  98.10074515005442
curr_Factors:  [98.10074515 -0.64253692 -0.90520561]
mat_Sqrt:  [[20.86874174  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.32464385e-04 -3.59238618e-02  1.49306194e-01]
Stock Position:  -0.00013246438502237168
Bond Position:  [-1.32976094]


portfolio before change:  [-1.34273904]
curr_Stock_Price:  96.71935953053898
curr_Factors:  [96.71935953 -0.49652987 -0.92907982]
mat_Sqrt:  [[23.2476462   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214927  0.06334113 -0.1139031 ]
Stock Position:  -0.002149272413084185
Bond Position:  [-1.13486279]


portfolio before change:  [-1.34431757]
curr_Stock_Price:  97.38780155578226
curr_Factors:  [97.38780156 -0.61875062 -0.91604375]
mat_Sqrt:  [[20.98707122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00254163 -0.00539931  0.02692863]
Stock Position:  0.002541626512449425
Bond Position:  [-1.59184099]


portfolio before change:  [-1.34421797]
curr_Stock_Price:  97.50528311993722
curr_Factors:  [97.50528312 -0.4643894  -0.91461201]
mat_Sqrt:  [[24.55474597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00188355  0.01925226 -0.33225618]
Stock Position:  0.001883546670414282
Bond Position:  [-1.52787372]


portfolio before change:  [-1.34584193]
curr_Stock_Price:  96.74450512146349
curr_Factors:  [96.74450512 -0.40256253 -0.91751292]
mat_Sqrt:  [[25.84192278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030168 -0.01527155 -0.12576121]
Stock Position:  -0.00030168388844496275
Bond Position:  [-1.31665567]


portfolio before change:  [-1.3461512]
curr_Stock_Price:  97.22408516623706
curr_Factors:  [97.22408517 -0.36809404 -0.89638211]
mat_Sqrt:  [[27.45483587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.72390589e-04  2.77864054e-02 -5.48153366e-01]
Stock Position:  -0.000272390589451438
Bond Position:  [-1.31966827]


portfolio before change:  [-1.34648737]
curr_Stock_Price:  97.85260461870023
curr_Factors:  [97.85260462 -0.38581924 -0.89161477]
mat_Sqrt:  [[27.27657553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196173  0.00404378 -0.1365238 ]
Stock Position:  -0.0019617318311181374
Bond Position:  [-1.1545268]


portfolio before change:  [-1.3464274]
curr_Stock_Price:  97.74846473666585
curr_Factors:  [97.74846474 -0.20577841 -0.89654613]
mat_Sqrt:  [[32.46209011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.20542186e-03  1.79822368e-01 -1.48092888e+00]
Stock Position:  -0.0012054218646361005
Bond Position:  [-1.22859927]


portfolio before change:  [-1.34681081]
curr_Stock_Price:  97.93912076254779
curr_Factors:  [97.93912076 -0.35634385 -0.88115748]
mat_Sqrt:  [[28.41294193  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0184481  0.08281345 0.13441046]
Stock Position:  0.018448102942854306
Bond Position:  [-3.15360179]


portfolio before change:  [-1.34903517]
curr_Stock_Price:  97.83991618111357
curr_Factors:  [97.83991618 -0.25795285 -0.90625257]
mat_Sqrt:  [[30.54274617  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00031721 -0.01145853  0.20264459]
Stock Position:  0.0003172125180911093
Bond Position:  [-1.38007122]


portfolio before change:  [-1.34886238]
curr_Stock_Price:  98.92849685225076
curr_Factors:  [98.92849685 -0.26705171 -0.89558656]
mat_Sqrt:  [[30.93100474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.001904   -0.01803679 -0.10220123]
Stock Position:  -0.00190399779706444
Bond Position:  [-1.16050274]


portfolio before change:  [-1.34940089]
curr_Stock_Price:  99.13513540737124
curr_Factors:  [99.13513541 -0.24746512 -0.88887693]
mat_Sqrt:  [[31.82149102  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0005146   0.00813683 -0.02938662]
Stock Position:  0.0005145959355009097
Bond Position:  [-1.40041543]


portfolio before change:  [-1.3505687]
curr_Stock_Price:  97.20596283503676
curr_Factors:  [97.20596284 -0.48584982 -0.8760432 ]
mat_Sqrt:  [[24.90177391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00314391 -0.00350369  0.6329649 ]
Stock Position:  -0.0031439130238975015
Bond Position:  [-1.0449616]


portfolio before change:  [-1.34769307]
curr_Stock_Price:  96.2497477413442
curr_Factors:  [96.24974774 -0.69407626 -0.90004118]
mat_Sqrt:  [[19.54713866  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286688 -0.01089507 -0.02836274]
Stock Position:  -0.002866883858633575
Bond Position:  [-1.07175622]


portfolio before change:  [-1.34789809]
curr_Stock_Price:  96.27452991585426
curr_Factors:  [96.27452992 -0.59751225 -0.94097459]
mat_Sqrt:  [[20.67069415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00383816  0.03580585 -0.22552839]
Stock Position:  -0.003838159535828707
Bond Position:  [-0.97838109]


portfolio before change:  [-1.34777966]
curr_Stock_Price:  96.21180701591233
curr_Factors:  [96.21180702 -0.71233989 -0.91676017]
mat_Sqrt:  [[18.8677106   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0044079  -0.01253305  0.34917883]
Stock Position:  0.00440789942846986
Bond Position:  [-1.77187163]


portfolio before change:  [-1.35035709]
curr_Stock_Price:  95.67732707104548
curr_Factors:  [95.67732707 -1.0086016  -0.92793289]
mat_Sqrt:  [[13.79694041  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00204028  0.01507779 -0.229838  ]
Stock Position:  0.0020402775963172907
Bond Position:  [-1.5455654]


portfolio before change:  [-1.35059725]
curr_Stock_Price:  95.65431184235297
curr_Factors:  [95.65431184 -0.99298475 -0.94168587]
mat_Sqrt:  [[13.81935518  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00086953 -0.00655842 -0.13453514]
Stock Position:  0.0008695315650442692
Bond Position:  [-1.4337717]


portfolio before change:  [-1.35090373]
curr_Stock_Price:  95.50797619962582
curr_Factors:  [95.5079762  -1.15238472 -0.9557616 ]
mat_Sqrt:  [[11.60067678  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00507767  0.01732625 -0.39465974]
Stock Position:  -0.00507767233233682
Bond Position:  [-0.86594552]


portfolio before change:  [-1.35164964]
curr_Stock_Price:  95.63355645503582
curr_Factors:  [95.63355646 -1.00260957 -0.99719782]
mat_Sqrt:  [[12.94508756  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126149  0.01699248 -0.02589478]
Stock Position:  -0.0012614943545699038
Bond Position:  [-1.23100844]


portfolio before change:  [-1.35106655]
curr_Stock_Price:  95.04935281168743
curr_Factors:  [95.04935281 -1.00550582 -1.02112246]
mat_Sqrt:  [[12.52551773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00619892 -0.01308564  0.53043005]
Stock Position:  0.006198923564278776
Bond Position:  [-1.94027022]


portfolio before change:  [-1.34748658]
curr_Stock_Price:  95.6659947621989
curr_Factors:  [95.66599476 -0.91101777 -1.03188621]
mat_Sqrt:  [[13.70771662  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00590797 -0.00126458 -0.08725104]
Stock Position:  -0.005907968365809134
Bond Position:  [-0.78229491]


portfolio before change:  [-1.34695878]
curr_Stock_Price:  95.56010399018072
curr_Factors:  [95.56010399 -0.77935354 -1.04365399]
mat_Sqrt:  [[15.43670132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01147096 -0.04853829 -0.32130915]
Stock Position:  -0.011470963764751301
Bond Position:  [-0.25079229]


portfolio before change:  [-1.34998815]
curr_Stock_Price:  95.82146142780917
curr_Factors:  [95.82146143 -0.96826399 -1.04445376]
mat_Sqrt:  [[12.80414486  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01017066 0.03395047 0.56093031]
Stock Position:  0.010170656058428993
Bond Position:  [-2.32455528]


portfolio before change:  [-1.34464386]
curr_Stock_Price:  96.37549435058436
curr_Factors:  [96.37549435 -1.15537232 -1.04495867]
mat_Sqrt:  [[10.67517514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01008119 -0.03831071 -0.44575094]
Stock Position:  0.010081190831887792
Bond Position:  [-2.31622361]


portfolio before change:  [-1.34005865]
curr_Stock_Price:  96.8590439204895
curr_Factors:  [96.85904392 -1.29502602 -1.03334188]
mat_Sqrt:  [[ 9.43936651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01185258 0.00103322 0.17468074]
Stock Position:  0.011852577921270499
Bond Position:  [-2.48808802]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.34955236]
Stock Price:  96.08430275707978
PL:  [-1.34955236]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.92119840e-01 -1.14373694e-01  2.27380132e-02]
 [-1.46716173e-01  6.78584258e-02 -1.62130723e-01]
 [ 2.29201266e-03  8.61596283e-03  4.81083916e-02]
 [ 8.35214169e-03 -1.34596239e-02  5.93272378e-02]
 [ 1.39567267e-01 -1.27908446e-01 -9.67583441e-02]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-6.33426771e-02 -1.53290950e-01  4.27835600e-02]
 [ 1.64629334e-02  6.89748579e-01  8.89416362e-02]
 [ 2.39680188e-01 -2.44150719e-02  2.50380908e-01]
 [ 4.50916902e-01  1.83758775e-01  3.23400008e-01]
 [-1.05329198e-01 -1.27140432e-01  6.24260829e-02]
 [-2.75694336e-02 -1.73658181e-02  9.52450558e-02]
 [ 1.11272472e-02 -5.92047143e-02  1.04005427e-01]
 [ 9.76384232e-03 -6.84348927e-02 -8.85180344e-02]
 [-3.53779691e-02  9.73693419e-02 -4.57215916e-02]
 [ 7.67787780e-02 -1.05438457e-02  1.21940842e-02]
 [ 4.95584154e-02  2.03389631e-02 -1.67747169e-02]
 [-5.07829405e-02 -5.71179690e-02  3.71838989e-02]
 [ 5.59778802e-02 -2.60198504e-02 -1.80686158e-01]
 [ 2.81826087e-02 -1.28716663e-02  1.52433179e-01]
 [-4.00849897e-02  5.34090787e-01 -5.19272922e-01]
 [ 2.66052074e-01  1.62745659e-01  7.90532232e-02]
 [-5.37724214e-02  1.58030903e-01 -6.37242240e-02]
 [-1.00277741e-02 -1.50217551e-01 -1.01375928e-01]
 [ 2.81532804e-02 -2.91081436e-02 -1.06769642e-02]
 [ 1.22611542e-04  1.93865569e-02  1.01622609e-02]
 [ 9.16889163e-02 -1.90295596e-02  1.06223041e-01]
 [ 1.68478690e-01 -5.22891385e-02  2.22104863e-01]
 [-4.07018346e-02  3.62204489e-03 -6.81854150e-02]
 [-5.55586568e-02 -1.31212755e-02  4.29829527e-02]
 [-4.02214417e-02 -5.76419064e-02 -3.58625523e-02]
 [ 2.62522794e-02 -3.83069844e-02 -9.21511842e-02]
 [ 1.07960281e-01 -3.74156502e-03  1.96964097e-01]
 [-3.27778819e-04 -9.20010246e-02 -1.63620477e-01]
 [ 4.27700242e-02  1.64641743e-01 -6.35711332e-02]
 [ 5.08828863e-03  1.96796177e-02  8.63713365e-02]
 [ 4.77709200e-01 -2.75625100e-01  3.01057341e-01]
 [-1.07201293e-01  4.56231291e-02  4.10679310e-02]
 [ 9.49633345e-02  8.30475956e-03  1.21152011e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.17898856]
curr_Stock_Price:  100.85544102345176
curr_Factors:  [100.85544102  -0.92306492  -1.00999931]
mat_Sqrt:  [[14.59419702  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02129784 -0.03691395  0.06486522]
Stock Position:  -0.02129784153244712
Bond Position:  [11.32699176]


portfolio before change:  [9.19044487]
curr_Stock_Price:  100.38401561644606
curr_Factors:  [100.38401562  -1.0262184   -1.02611147]
mat_Sqrt:  [[12.89285293  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0128722   0.02190121 -0.46251382]
Stock Position:  -0.012872203409351095
Bond Position:  [10.48260834]


portfolio before change:  [9.18728664]
curr_Stock_Price:  100.73116992629669
curr_Factors:  [100.73116993  -1.10993916  -1.02470637]
mat_Sqrt:  [[11.91513876  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00116413 0.00278079 0.13723985]
Stock Position:  0.0011641344091983476
Bond Position:  [9.07002201]


portfolio before change:  [9.18835157]
curr_Stock_Price:  100.67199387545855
curr_Factors:  [100.67199388  -1.04372794  -1.01807051]
mat_Sqrt:  [[12.80799     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138311 -0.00434407  0.1692441 ]
Stock Position:  0.0013831076667647937
Bond Position:  [9.04911136]


portfolio before change:  [9.19013451]
curr_Stock_Price:  101.14320233263452
curr_Factors:  [101.14320233  -0.84564957  -1.00364758]
mat_Sqrt:  [[15.91465217  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00588812 -0.04128227 -0.27602462]
Stock Position:  0.005888118054046201
Bond Position:  [8.5945914]


portfolio before change:  [9.1887014]
curr_Stock_Price:  100.7173436139831
curr_Factors:  [100.71734361  -0.66479995  -1.03186881]
mat_Sqrt:  [[18.46079415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00830431 -0.05534923  0.15513819]
Stock Position:  -0.008304312097393837
Bond Position:  [10.02508965]


portfolio before change:  [9.20565645]
curr_Stock_Price:  98.82653766180789
curr_Factors:  [98.82653766 -0.75308569 -1.0228156 ]
mat_Sqrt:  [[16.73437326  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00513314 -0.04947444  0.12204959]
Stock Position:  -0.005133141366769995
Bond Position:  [9.71294704]


portfolio before change:  [9.19878209]
curr_Stock_Price:  100.4022905362968
curr_Factors:  [100.40229054  -1.01237622  -1.02505733]
mat_Sqrt:  [[13.08872899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01340179 0.2226154  0.25372573]
Stock Position:  0.013401790810652955
Bond Position:  [7.85321159]


portfolio before change:  [9.20081775]
curr_Stock_Price:  100.48093290379758
curr_Factors:  [100.4809329   -1.02641966  -1.0328414 ]
mat_Sqrt:  [[12.81616073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02230038 -0.00787993  0.71426704]
Stock Position:  0.022300381281279858
Bond Position:  [6.96005463]


portfolio before change:  [9.21824099]
curr_Stock_Price:  101.22321542875315
curr_Factors:  [101.22321543  -1.18799646  -1.05493905]
mat_Sqrt:  [[10.74448526  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05160231 0.05930789 0.9225702 ]
Stock Position:  0.05160230965327368
Bond Position:  [3.99488929]


portfolio before change:  [9.24892233]
curr_Stock_Price:  101.80811076378276
curr_Factors:  [101.80811076  -0.9348066   -1.09956206]
mat_Sqrt:  [[13.31273524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00890418 -0.0410344   0.17808424]
Stock Position:  -0.008904177661575361
Bond Position:  [10.15543984]


portfolio before change:  [9.24996587]
curr_Stock_Price:  101.83348892238992
curr_Factors:  [101.83348892  -1.01057575  -1.11065659]
mat_Sqrt:  [[12.20818568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095611 -0.00560479  0.27170763]
Stock Position:  -0.0009561126491099172
Bond Position:  [9.34733016]


portfolio before change:  [9.25188933]
curr_Stock_Price:  101.04386803587076
curr_Factors:  [101.04386804  -0.860716    -1.11299701]
mat_Sqrt:  [[14.03903614  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144398 -0.01910824  0.29669853]
Stock Position:  0.0014439847721274034
Bond Position:  [9.10598352]


portfolio before change:  [9.25161421]
curr_Stock_Price:  100.06502625664952
curr_Factors:  [100.06502626  -0.61128988  -1.11634916]
mat_Sqrt:  [[17.78190199  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00125262 -0.02208727 -0.25251731]
Stock Position:  -0.001252624145091775
Bond Position:  [9.37695808]


portfolio before change:  [9.25415816]
curr_Stock_Price:  98.96992514508985
curr_Factors:  [98.96992515 -0.54485267 -1.11430842]
mat_Sqrt:  [[18.83383386  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131866  0.03142582 -0.13043097]
Stock Position:  -0.001318659619951811
Bond Position:  [9.3846658]


portfolio before change:  [9.25456517]
curr_Stock_Price:  99.55092424436978
curr_Factors:  [99.55092424 -0.75821294 -1.07743748]
mat_Sqrt:  [[15.87934014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00485635 -0.00340301  0.03478633]
Stock Position:  0.0048563498774302945
Bond Position:  [8.77111106]


portfolio before change:  [9.26214712]
curr_Stock_Price:  100.88638971058501
curr_Factors:  [100.88638971  -0.86185206  -1.1103611 ]
mat_Sqrt:  [[14.03819552  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00358208  0.00656437 -0.0478536 ]
Stock Position:  0.0035820817630067806
Bond Position:  [8.90076382]


portfolio before change:  [9.26757886]
curr_Stock_Price:  102.09213434776352
curr_Factors:  [102.09213435  -0.61408085  -1.08776152]
mat_Sqrt:  [[18.61622139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00294646 -0.01843475  0.10607531]
Stock Position:  -0.0029464607422939925
Bond Position:  [9.56838933]


portfolio before change:  [9.27061475]
curr_Stock_Price:  101.46773440308291
curr_Factors:  [101.4677344   -0.47506111  -1.09532449]
mat_Sqrt:  [[21.10173491  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00065323 -0.00839787 -0.51544731]
Stock Position:  0.0006532255784917218
Bond Position:  [9.20433343]


portfolio before change:  [9.27256429]
curr_Stock_Price:  102.69078105127684
curr_Factors:  [102.69078105  -0.5408993   -1.09691663]
mat_Sqrt:  [[19.9635162   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0028387  -0.00415431  0.43484943]
Stock Position:  0.0028387024891569886
Bond Position:  [8.98105572]


portfolio before change:  [9.27721796]
curr_Stock_Price:  103.93464781115641
curr_Factors:  [103.93464781  -0.58925853  -1.08850308]
mat_Sqrt:  [[19.41412139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190894  0.17237706 -1.48134111]
Stock Position:  -0.0019089355031279252
Bond Position:  [9.4756225]


portfolio before change:  [9.27802257]
curr_Stock_Price:  104.13367066541149
curr_Factors:  [104.13367067  -0.61701257  -1.10238017]
mat_Sqrt:  [[18.65814216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01690463 0.05252594 0.22551684]
Stock Position:  0.016904634009834812
Bond Position:  [7.51768098]


portfolio before change:  [9.285565]
curr_Stock_Price:  104.52425386892294
curr_Factors:  [104.52425387  -0.60892962  -1.08783625]
mat_Sqrt:  [[19.1567142   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180209  0.05100425 -0.18178747]
Stock Position:  -0.00180209146868082
Bond Position:  [9.47392727]


portfolio before change:  [9.28681075]
curr_Stock_Price:  104.4901635058672
curr_Factors:  [104.49016351  -0.84408602  -1.08767916]
mat_Sqrt:  [[15.13981092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00405448 -0.04848251 -0.28919731]
Stock Position:  -0.004054481149154898
Bond Position:  [9.71046415]


portfolio before change:  [9.28596021]
curr_Stock_Price:  104.9993344546668
curr_Factors:  [104.99933445  -0.93368904  -1.12519883]
mat_Sqrt:  [[13.39747337  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00149522 -0.00939461 -0.03045841]
Stock Position:  0.001495220682085415
Bond Position:  [9.12896303]


portfolio before change:  [9.28712086]
curr_Stock_Price:  105.01234522390048
curr_Factors:  [105.01234522  -0.87060706  -1.13117291]
mat_Sqrt:  [[14.18660116  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00043381 0.00625698 0.0289901 ]
Stock Position:  0.00043380642506699746
Bond Position:  [9.24156583]


portfolio before change:  [9.28842838]
curr_Stock_Price:  105.36331085221113
curr_Factors:  [105.36331085  -1.30179957  -1.12246769]
mat_Sqrt:  [[ 9.32918087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01173599 -0.00614176  0.30302477]
Stock Position:  0.011735994050340502
Bond Position:  [8.05188519]


portfolio before change:  [9.28550351]
curr_Stock_Price:  105.0283227744608
curr_Factors:  [105.02832277  -1.14951179  -1.1025372 ]
mat_Sqrt:  [[11.0472449   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01838849 -0.01687625  0.63360335]
Stock Position:  0.018388492434755006
Bond Position:  [7.35419099]


portfolio before change:  [9.28550484]
curr_Stock_Price:  104.97840046504312
curr_Factors:  [104.97840047  -1.18864858  -1.09682076]
mat_Sqrt:  [[10.67906501  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00504546  0.00116901 -0.19451401]
Stock Position:  -0.005045458314839636
Bond Position:  [9.81516898]


portfolio before change:  [9.28373861]
curr_Stock_Price:  105.57164860770469
curr_Factors:  [105.57164861  -1.33239277  -1.06850617]
mat_Sqrt:  [[ 9.56863837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0051693  -0.00423487  0.1226184 ]
Stock Position:  -0.005169300534044091
Bond Position:  [9.82947018]


portfolio before change:  [9.28710488]
curr_Stock_Price:  105.15814790568731
curr_Factors:  [105.15814791  -1.25384538  -1.0492043 ]
mat_Sqrt:  [[10.51093045  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0056425  -0.01860385 -0.10230588]
Stock Position:  -0.005642503262601952
Bond Position:  [9.88046007]


portfolio before change:  [9.2924934]
curr_Stock_Price:  104.42205863501574
curr_Factors:  [104.42205864  -1.47537535  -1.0375133 ]
mat_Sqrt:  [[ 8.46171852  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.45988273e-05 -1.23635261e-02 -2.62881679e-01]
Stock Position:  -4.459882734987286e-05
Bond Position:  [9.2971505]


portfolio before change:  [9.29364466]
curr_Stock_Price:  104.66768698852962
curr_Factors:  [104.66768699  -1.50349728  -1.05281948]
mat_Sqrt:  [[ 8.12116561  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01815031 -0.00120758  0.56188374]
Stock Position:  0.01815030896642385
Bond Position:  [7.3938938]


portfolio before change:  [9.3058117]
curr_Stock_Price:  105.28711146178065
curr_Factors:  [105.28711146  -1.55361521  -1.08421304]
mat_Sqrt:  [[ 7.52975694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00697317 -0.0296932  -0.46676368]
Stock Position:  -0.006973173206182883
Bond Position:  [10.03999696]


portfolio before change:  [9.30162539]
curr_Stock_Price:  106.06744262605204
curr_Factors:  [106.06744263  -1.66388492  -1.09960452]
mat_Sqrt:  [[ 6.68981151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00947724  0.05313789 -0.18135075]
Stock Position:  0.009477244002545663
Bond Position:  [8.29639836]


portfolio before change:  [9.30414872]
curr_Stock_Price:  106.22426182020095
curr_Factors:  [106.22426182  -1.43106741  -1.11217476]
mat_Sqrt:  [[ 8.35040774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00320174 0.00635157 0.24639338]
Stock Position:  0.0032017417377444846
Bond Position:  [8.96404607]


portfolio before change:  [9.30765077]
curr_Stock_Price:  106.96806785020111
curr_Factors:  [106.96806785  -1.46213122  -1.13473588]
mat_Sqrt:  [[ 7.96983072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06059107 -0.08895762  0.85883279]
Stock Position:  0.06059106546950977
Bond Position:  [2.82634157]


portfolio before change:  [9.29028955]
curr_Stock_Price:  106.67570572781163
curr_Factors:  [106.67570573  -1.80968281  -1.13435961]
mat_Sqrt:  [[ 5.61673779  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01593551  0.0147248   0.11715538]
Stock Position:  -0.015935505213431133
Bond Position:  [10.99022082]


portfolio before change:  [9.28677724]
curr_Stock_Price:  106.9823274263153
curr_Factors:  [106.98232743  -1.72296092  -1.13356807]
mat_Sqrt:  [[ 6.14804823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01974425 0.00268035 0.34561296]
Stock Position:  0.019744247697061745
Bond Position:  [7.17449167]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.27938677]
Stock Price:  106.5625927327913
PL:  [2.71679403]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.01932759e-01 -6.45061791e-02  7.31364396e-03]
 [-1.98388723e-01  5.50827345e-02 -1.59829773e-01]
 [-1.50647780e-02  5.87718965e-02  3.81250361e-02]
 [ 1.15784588e-01  6.01667779e-02  1.16611939e-01]
 [-1.16789820e-01  2.36458207e-01 -3.71010095e-02]
 [-1.29863574e-01 -1.64924438e-01  9.15187980e-02]
 [-5.29035297e-02 -1.45016587e-01 -2.68346287e-02]
 [-1.53122672e-02  7.42666817e-01  1.40916651e-01]
 [ 3.95712494e-01  4.07120055e-02  3.78654038e-01]
 [ 5.33144433e-01  2.09136946e-01  3.64064476e-01]
 [-2.13059230e-01 -2.07134392e-01  4.34128398e-02]
 [-8.02705536e-02 -2.10046723e-02  7.97441434e-02]
 [ 1.24347583e-02 -5.64431872e-02  8.56046095e-02]
 [ 2.65632859e-05  2.10544804e-01 -1.62855738e-01]
 [ 4.63070045e-01 -1.38684866e-01 -2.21229357e-01]
 [-1.87979472e-01 -9.49109512e-02  1.13917593e-01]
 [ 5.12236529e-02  1.50721436e-02 -1.92752741e-02]
 [-5.64230704e-02 -6.04542213e-02  2.91533352e-02]
 [ 1.74120113e-01 -2.15452511e-01  4.34333240e-02]
 [ 5.37721649e-02 -2.53750695e-03  3.74668225e-01]
 [-3.51854597e-02  4.97784881e-01 -4.81108075e-01]
 [ 2.72199892e-01  1.65687369e-01  7.80520945e-02]
 [-1.12346440e-02  1.65212210e-01 -5.96246887e-02]
 [ 3.59735432e-02 -1.52098778e-01 -1.91253224e-01]
 [ 2.56424607e-02 -2.97841483e-02 -1.03264247e-02]
 [ 1.22370817e-02  2.31964959e-02 -2.29298578e-02]
 [ 9.06699884e-02 -1.42275235e-02  1.45512472e-01]
 [ 1.69200954e-01 -5.16844617e-02  2.26524836e-01]
 [-3.26289056e-02  2.32022709e-02 -1.03395629e-01]
 [-5.70277942e-02 -5.20212010e-03  3.93790787e-02]
 [-2.86759053e-02 -5.75750778e-02 -4.14291077e-02]
 [ 2.64816801e-02 -6.49135666e-02 -1.34535193e-01]
 [ 3.56239423e-02  3.35782228e-03  1.50207679e-01]
 [-8.43353040e-04 -9.29870569e-02 -1.70446668e-01]
 [ 4.00632516e-02  2.02847359e-01 -4.27658018e-02]
 [ 4.90873266e-02  3.17577379e-02  1.48217217e-01]
 [ 2.84679138e-01 -1.86262668e-01  1.61817180e-01]
 [-1.06647352e-01  4.41809515e-02  4.65041244e-02]
 [ 2.78613758e-01 -2.93975594e-02  6.70945040e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.39272046]
curr_Stock_Price:  99.64871226352358
curr_Factors:  [99.64871226 -1.04833295 -0.98565141]
mat_Sqrt:  [[13.03537433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00692411 -0.02081928  0.02086379]
Stock Position:  0.006924111187119576
Bond Position:  [-1.08269922]


portfolio before change:  [-0.39646415]
curr_Stock_Price:  99.12758465973796
curr_Factors:  [99.12758466 -0.91808447 -0.98771285]
mat_Sqrt:  [[14.74067134  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0149091   0.01777788 -0.45594986]
Stock Position:  -0.014909098646835607
Bond Position:  [1.08143879]


portfolio before change:  [-0.3831463]
curr_Stock_Price:  98.2433821396717
curr_Factors:  [98.24338214 -0.74598869 -1.01594736]
mat_Sqrt:  [[16.86957737  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00027945 0.01896855 0.10876012]
Stock Position:  0.00027945131430650444
Bond Position:  [-0.41060054]


portfolio before change:  [-0.38340046]
curr_Stock_Price:  97.51753973999175
curr_Factors:  [97.51753974 -0.65550079 -1.01106501]
mat_Sqrt:  [[18.42054212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00824457 0.01941874 0.3326614 ]
Stock Position:  0.008244566910600598
Bond Position:  [-1.18739035]


portfolio before change:  [-0.37437622]
curr_Stock_Price:  98.6301117210773
curr_Factors:  [98.63011172 -0.50814959 -1.01010779]
mat_Sqrt:  [[21.60920188  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00352147  0.07631656 -0.10583885]
Stock Position:  -0.0035214721252794516
Bond Position:  [-0.02705303]


portfolio before change:  [-0.38011221]
curr_Stock_Price:  100.25801298330596
curr_Factors:  [100.25801298  -0.57904391  -1.01228912]
mat_Sqrt:  [[20.41794071  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00709413 -0.05322913  0.26107766]
Stock Position:  -0.007094125689984076
Bond Position:  [0.33113073]


portfolio before change:  [-0.3864399]
curr_Stock_Price:  101.15580886981765
curr_Factors:  [101.15580887  -0.53091567  -1.00357314]
mat_Sqrt:  [[21.8057389   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00403483 -0.0468039  -0.07655173]
Stock Position:  -0.004034832874743067
Bond Position:  [0.02170689]


portfolio before change:  [-0.3831179]
curr_Stock_Price:  100.33315132779838
curr_Factors:  [100.33315133  -0.55398433  -0.99616408]
mat_Sqrt:  [[21.29234776  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00775154 0.23969468 0.40199598]
Stock Position:  0.007751538485735399
Bond Position:  [-1.16085418]


portfolio before change:  [-0.38339765]
curr_Stock_Price:  100.31578245591966
curr_Factors:  [100.31578246  -0.31838796  -1.00083294]
mat_Sqrt:  [[26.81877306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01794695 0.01313974 1.08019457]
Stock Position:  0.017946951878399488
Bond Position:  [-2.18376017]


portfolio before change:  [-0.37898812]
curr_Stock_Price:  100.57669097260678
curr_Factors:  [100.57669097  -0.34609482  -1.02211   ]
mat_Sqrt:  [[25.6031583   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0253933  0.06749866 1.03857461]
Stock Position:  0.02539330012993274
Bond Position:  [-2.93296222]


portfolio before change:  [-0.40074179]
curr_Stock_Price:  99.73446020375371
curr_Factors:  [99.7344602  -0.17152671 -1.0073283 ]
mat_Sqrt:  [[30.68138874  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00803349 -0.06685234  0.12384475]
Stock Position:  -0.008033493972762729
Bond Position:  [0.4004744]


portfolio before change:  [-0.43670983]
curr_Stock_Price:  104.21795204423758
curr_Factors:  [104.21795204  -0.51399053  -1.01136138]
mat_Sqrt:  [[22.67204098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00301166 -0.00677923  0.22748784]
Stock Position:  -0.0030116569257287984
Bond Position:  [-0.12284111]


portfolio before change:  [-0.43237469]
curr_Stock_Price:  102.77340000875716
curr_Factors:  [102.77340001  -0.73802168  -1.02125022]
mat_Sqrt:  [[17.6945144   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00103915 -0.01821696  0.24420612]
Stock Position:  0.001039153055276089
Bond Position:  [-0.53917198]


portfolio before change:  [-0.43122468]
curr_Stock_Price:  103.94494508415218
curr_Factors:  [103.94494508  -0.7086852   -1.06799544]
mat_Sqrt:  [[17.58736492  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.000555    0.06795304 -0.46458209]
Stock Position:  0.0005550037380426912
Bond Position:  [-0.48891451]


portfolio before change:  [-0.4311727]
curr_Stock_Price:  104.1487082048958
curr_Factors:  [104.1487082   -0.83793818  -1.0867463 ]
mat_Sqrt:  [[15.19756595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02563587 -0.04476035 -0.63110578]
Stock Position:  0.02563587241977686
Bond Position:  [-3.1011157]


portfolio before change:  [-0.4118871]
curr_Stock_Price:  104.91611968149172
curr_Factors:  [104.91611968  -0.88543374  -1.1055863 ]
mat_Sqrt:  [[14.32693203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01284991 -0.03063238  0.32497518]
Stock Position:  -0.012849907956326337
Bond Position:  [0.93627538]


portfolio before change:  [-0.41131025]
curr_Stock_Price:  104.88033638510882
curr_Factors:  [104.88033639  -1.08876853  -1.07531773]
mat_Sqrt:  [[12.04601368  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00418111  0.00486451 -0.05498699]
Stock Position:  0.004181108692287593
Bond Position:  [-0.84982634]


portfolio before change:  [-0.41287083]
curr_Stock_Price:  104.53250027077868
curr_Factors:  [104.53250027  -1.06282367  -1.06129594]
mat_Sqrt:  [[12.49562297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00502675 -0.01951152  0.08316635]
Stock Position:  -0.0050267471369968885
Bond Position:  [0.11258762]


portfolio before change:  [-0.41425425]
curr_Stock_Price:  104.81051247471046
curr_Factors:  [104.81051247  -1.11979015  -1.06319756]
mat_Sqrt:  [[11.81259528  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01176768 -0.069537    0.12390318]
Stock Position:  0.011767680205714209
Bond Position:  [-1.64763084]


portfolio before change:  [-0.4098909]
curr_Stock_Price:  105.19880586131659
curr_Factors:  [105.19880586  -0.97367242  -1.063427  ]
mat_Sqrt:  [[13.71859941  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.45672556e-03 -8.18976847e-04  1.06882416e+00]
Stock Position:  0.009456725562770087
Bond Position:  [-1.40472714]


portfolio before change:  [-0.41874205]
curr_Stock_Price:  104.28141208681994
curr_Factors:  [104.28141209  -0.78076945  -1.05491556]
mat_Sqrt:  [[16.63332342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019107   0.16065938 -1.37246742]
Stock Position:  -0.0019107018051382212
Bond Position:  [-0.21949136]


portfolio before change:  [-0.41732219]
curr_Stock_Price:  103.52394292687549
curr_Factors:  [103.52394293  -0.79395782  -1.05606021]
mat_Sqrt:  [[16.27751791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.019779   0.05347537 0.2226609 ]
Stock Position:  0.019778998455414656
Bond Position:  [-2.46492209]


portfolio before change:  [-0.402557]
curr_Stock_Price:  104.2860302330458
curr_Factors:  [104.28603023  -0.9548843   -1.07005494]
mat_Sqrt:  [[13.76595025  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074955  0.05332201 -0.17009264]
Stock Position:  0.0007495536700751931
Bond Position:  [-0.48072497]


portfolio before change:  [-0.40148858]
curr_Stock_Price:  105.79161177374431
curr_Factors:  [105.79161177  -1.23495596  -1.08009436]
mat_Sqrt:  [[10.44810806  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00326498 -0.04908967 -0.54559221]
Stock Position:  -0.0032649825690401852
Bond Position:  [-0.05608081]


portfolio before change:  [-0.40323992]
curr_Stock_Price:  106.32586561286415
curr_Factors:  [106.32586561  -1.38160991  -1.08092715]
mat_Sqrt:  [[ 9.0609278   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00192639 -0.00961279 -0.02945842]
Stock Position:  0.0019263948111748225
Bond Position:  [-0.60806551]


portfolio before change:  [-0.40376774]
curr_Stock_Price:  106.09132775157225
curr_Factors:  [106.09132775  -1.40429676  -1.0584403 ]
mat_Sqrt:  [[ 9.03913277  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00135981  0.00748664 -0.0654125 ]
Stock Position:  0.0013598106443973223
Bond Position:  [-0.54803186]


portfolio before change:  [-0.40355748]
curr_Stock_Price:  106.29633877204678
curr_Factors:  [106.29633877  -1.26913453  -1.06058278]
mat_Sqrt:  [[10.34510574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01135497 -0.00459191  0.41510658]
Stock Position:  0.011354974929436589
Bond Position:  [-1.61054974]


portfolio before change:  [-0.39722401]
curr_Stock_Price:  106.87183977989669
curr_Factors:  [106.87183978  -1.40608122  -1.07165556]
mat_Sqrt:  [[ 8.97007086  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02284152 -0.01668109  0.64621231]
Stock Position:  0.02284152480066095
Bond Position:  [-2.83833979]


portfolio before change:  [-0.39665849]
curr_Stock_Price:  106.91213178791203
curr_Factors:  [106.91213179  -1.46181389  -1.07097047]
mat_Sqrt:  [[ 8.49283559  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00576937  0.0074885  -0.29495895]
Stock Position:  -0.005769369455664938
Bond Position:  [0.2201571]


portfolio before change:  [-0.39699057]
curr_Stock_Price:  106.97446071398383
curr_Factors:  [106.97446071  -1.36481517  -1.05411165]
mat_Sqrt:  [[ 9.52255604  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00525609 -0.00167898  0.11233755]
Stock Position:  -0.00525609421900215
Bond Position:  [0.16527728]


portfolio before change:  [-0.39469432]
curr_Stock_Price:  106.54151759980195
curr_Factors:  [106.5415176   -1.21561259  -1.08171883]
mat_Sqrt:  [[10.71027253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00456431 -0.01858228 -0.11818571]
Stock Position:  -0.004564314294808109
Bond Position:  [0.09159465]


portfolio before change:  [-0.38911525]
curr_Stock_Price:  105.32170176739156
curr_Factors:  [105.32170177  -0.96165753  -1.08242613]
mat_Sqrt:  [[13.63903408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00104338 -0.02095076 -0.38379146]
Stock Position:  -0.001043375026062935
Bond Position:  [-0.27922521]


portfolio before change:  [-0.3884404]
curr_Stock_Price:  104.64145590417078
curr_Factors:  [104.6414559   -0.89348264  -1.05211778]
mat_Sqrt:  [[14.95341019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0044786  0.00108373 0.4285007 ]
Stock Position:  0.004478601740463578
Bond Position:  [-0.85708781]


portfolio before change:  [-0.38641081]
curr_Stock_Price:  105.11855356829419
curr_Factors:  [105.11855357  -0.80409886  -1.04142306]
mat_Sqrt:  [[16.60272571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328961 -0.03001144 -0.4862369 ]
Stock Position:  -0.003289612671815633
Bond Position:  [-0.04061149]


portfolio before change:  [-0.38825486]
curr_Stock_Price:  105.67757889287107
curr_Factors:  [105.67757889  -0.59885741  -1.04498199]
mat_Sqrt:  [[20.420787    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00356205  0.0654687  -0.12199893]
Stock Position:  0.0035620450180275792
Bond Position:  [-0.76468316]


portfolio before change:  [-0.3972171]
curr_Stock_Price:  103.18837762025831
curr_Factors:  [103.18837762  -0.62466149  -1.02001125]
mat_Sqrt:  [[19.92317215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00430778 0.01024977 0.42282247]
Stock Position:  0.004307775881042727
Bond Position:  [-0.84172951]


portfolio before change:  [-0.39091689]
curr_Stock_Price:  104.67532467496201
curr_Factors:  [104.67532467  -0.70795969  -1.01636919]
mat_Sqrt:  [[18.66284283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01498642 -0.06011602  0.46161937]
Stock Position:  0.01498642120186721
Bond Position:  [-1.9596254]


portfolio before change:  [-0.37337809]
curr_Stock_Price:  105.86198345302029
curr_Factors:  [105.86198345  -0.85594511  -1.02188642]
mat_Sqrt:  [[16.1885577   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00544436  0.01425934  0.13266332]
Stock Position:  -0.005444360153075098
Bond Position:  [0.20297267]


portfolio before change:  [-0.37392332]
curr_Stock_Price:  105.96678886019383
curr_Factors:  [105.96678886  -0.7693452   -1.03341707]
mat_Sqrt:  [[17.46787479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01639058 -0.00948802  0.19140194]
Stock Position:  0.016390580896261532
Bond Position:  [-2.11078054]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.35840877]
Stock Price:  106.92944002571241
PL:  [-7.28784879]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 6.43179563e-02 -6.92783547e-02  8.78218854e-03]
 [-1.92731088e-01  6.44813761e-02 -2.22092504e-01]
 [-4.42881793e-02  5.07231669e-02  1.60006312e-02]
 [ 9.07110191e-02  6.95600239e-02  8.73887217e-02]
 [-8.96041842e-02  2.15121152e-01 -3.91972940e-02]
 [-5.78713215e-02 -1.42600428e-01  2.07214392e-01]
 [-6.42591885e-02 -2.94010954e-01 -1.69617315e-01]
 [-1.07512361e-02  8.33215938e-01  1.42503114e-01]
 [-4.56251891e-03  2.04040756e-02 -5.58104163e-02]
 [ 1.06982105e-01  3.00090617e-02 -3.04761219e-04]
 [ 1.16647001e-01 -1.29466429e-01  4.64636472e-04]
 [ 2.21596073e-02 -1.49472236e-02  1.05260635e-01]
 [-1.96690505e-03  2.78254679e-02  1.69179560e-02]
 [ 1.16844480e-02 -1.61126970e-01  4.53365979e-02]
 [-6.14218624e-02  1.49887574e-01 -2.60589694e-02]
 [ 1.52821462e-01  1.10781446e-02 -4.86523053e-02]
 [ 4.37414531e-02  3.07789686e-02  1.72473321e-02]
 [-5.18525319e-02 -6.28248870e-02  4.61707234e-03]
 [ 3.56696914e-02  4.50563971e-02 -1.70909488e-01]
 [-4.41523331e-03 -1.63487132e-02 -2.58427098e-02]
 [-1.96142480e-02  3.46032814e-01 -2.89187835e-01]
 [ 2.85158816e-02  3.67997659e-02  6.36477302e-02]
 [ 5.58842413e-03 -4.03651496e-02  7.40655344e-02]
 [ 9.35984388e-02 -5.36516543e-02 -2.17115486e-01]
 [-4.26654512e-03  2.11017258e-02 -9.00538677e-03]
 [-9.93470343e-02 -1.28619393e-02  2.23509961e-01]
 [-3.19177204e-02 -3.31011285e-02 -4.09474313e-03]
 [-7.62799287e-02  9.28696578e-02 -1.11485654e-01]
 [ 1.75704285e-02 -4.02823507e-02  8.16308411e-02]
 [ 4.53430290e-03  3.24776125e-02 -4.90761024e-02]
 [ 6.26023282e-02 -3.62438092e-02 -1.17914640e-01]
 [-3.17248022e-02  1.29816909e-02 -9.75377715e-02]
 [ 8.51011352e-02  2.69878701e-02  1.17531535e-01]
 [ 4.04506340e-02 -3.23187150e-02  1.79817763e-01]
 [-7.09499817e-02 -1.24338511e-02 -2.03026547e-02]
 [ 2.33366578e-03 -7.44653954e-02  1.76864368e-02]
 [-1.03173047e-02  1.01640970e-01  9.68827327e-02]
 [ 1.20283611e-01 -1.00696549e-01 -1.16930200e-01]
 [ 1.05200771e-01  4.34488264e-03  7.52163345e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.23968799]
curr_Stock_Price:  99.72844154285144
curr_Factors:  [99.72844154 -0.94599324 -0.98571194]
mat_Sqrt:  [[14.45074156  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0035963  -0.02235949  0.02505314]
Stock Position:  0.0035963018148450873
Bond Position:  [-0.11896559]


portfolio before change:  [0.23955662]
curr_Stock_Price:  99.69604684576535
curr_Factors:  [99.69604685 -0.89695774 -1.01332944]
mat_Sqrt:  [[14.75879009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0152386   0.02081127 -0.6335681 ]
Stock Position:  -0.015238601738544908
Bond Position:  [1.75878497]


portfolio before change:  [0.24545222]
curr_Stock_Price:  99.32358838541236
curr_Factors:  [99.32358839 -0.76010788 -1.01733192]
mat_Sqrt:  [[16.7926836   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182629  0.01637083  0.04564535]
Stock Position:  -0.0018262858877184963
Bond Position:  [0.42684549]


portfolio before change:  [0.24455135]
curr_Stock_Price:  99.8460876633504
curr_Factors:  [99.84608766 -0.69865274 -1.0488171 ]
mat_Sqrt:  [[17.39460379  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00705667 0.0224504  0.2492957 ]
Stock Position:  0.007056673963025044
Bond Position:  [-0.46002994]


portfolio before change:  [0.23697998]
curr_Stock_Price:  98.78129993139738
curr_Factors:  [98.78129993 -0.66805141 -1.05494109]
mat_Sqrt:  [[17.63553362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304464  0.06943005 -0.11181897]
Stock Position:  -0.0030446414782754894
Bond Position:  [0.53773363]


portfolio before change:  [0.23795311]
curr_Stock_Price:  98.48375784404773
curr_Factors:  [98.48375784 -0.57820194 -1.08373339]
mat_Sqrt:  [[18.689396    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00239077 -0.04602409  0.59112498]
Stock Position:  -0.0023907702112262222
Bond Position:  [0.47340515]


portfolio before change:  [0.24310006]
curr_Stock_Price:  96.35567181417417
curr_Factors:  [96.35567181 -0.82504672 -1.07913245]
mat_Sqrt:  [[14.35168125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01107166 -0.09489163 -0.48387099]
Stock Position:  -0.011071658426377256
Bond Position:  [1.30991714]


portfolio before change:  [0.23021085]
curr_Stock_Price:  97.53462404674836
curr_Factors:  [97.53462405 -1.11020118 -1.099104  ]
mat_Sqrt:  [[10.70704834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01759743 0.26891929 0.40652172]
Stock Position:  0.017597434465307284
Bond Position:  [-1.4861483]


portfolio before change:  [0.22266177]
curr_Stock_Price:  97.11619381590734
curr_Factors:  [97.11619382 -1.23356655 -1.10511092]
mat_Sqrt:  [[ 9.36735405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00125861  0.00658539 -0.15921158]
Stock Position:  -0.0012586059931755538
Bond Position:  [0.3448928]


portfolio before change:  [0.22244304]
curr_Stock_Price:  97.32424204982203
curr_Factors:  [97.32424205 -1.33431556 -1.11420475]
mat_Sqrt:  [[ 8.41089422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01344036  0.00968538 -0.0008694 ]
Stock Position:  0.013440362785529772
Bond Position:  [-1.08563009]


portfolio before change:  [0.22370452]
curr_Stock_Price:  97.42819762625487
curr_Factors:  [97.42819763 -1.47799073 -1.1220218 ]
mat_Sqrt:  [[ 7.23625022  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01248086 -0.04178511  0.00132548]
Stock Position:  0.01248085928513802
Bond Position:  [-0.9922831]


portfolio before change:  [0.22890065]
curr_Stock_Price:  97.85446356562156
curr_Factors:  [97.85446357 -1.40855667 -1.13046398]
mat_Sqrt:  [[ 7.724991    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00525499 -0.0048242   0.30027929]
Stock Position:  0.005254990620951286
Bond Position:  [-0.28532364]


portfolio before change:  [0.23083817]
curr_Stock_Price:  98.2299525798942
curr_Factors:  [98.22995258 -1.54255875 -1.14245908]
mat_Sqrt:  [[ 6.70124517  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0010694  0.00898063 0.04826222]
Stock Position:  0.0010693994823704623
Bond Position:  [0.12579111]


portfolio before change:  [0.23032003]
curr_Stock_Price:  97.73073628980357
curr_Factors:  [97.73073629 -1.4727994  -1.13187708]
mat_Sqrt:  [[ 7.22494504  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00165415 -0.05200351  0.12933269]
Stock Position:  -0.0016541527466247068
Bond Position:  [0.3919816]


portfolio before change:  [0.22966318]
curr_Stock_Price:  98.15745465359865
curr_Factors:  [98.15745465 -1.37485907 -1.16111262]
mat_Sqrt:  [[ 7.77257239  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00465039  0.04837601 -0.07433899]
Stock Position:  -0.004650385031028454
Bond Position:  [0.68613313]


portfolio before change:  [0.2288982]
curr_Stock_Price:  98.3403970183299
curr_Factors:  [98.34039702 -1.54022696 -1.15617406]
mat_Sqrt:  [[ 6.63284539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02188377  0.00357546 -0.13879148]
Stock Position:  0.021883770879994466
Bond Position:  [-1.92316052]


portfolio before change:  [0.22940765]
curr_Stock_Price:  98.37466288451844
curr_Factors:  [98.37466288 -1.54060146 -1.16004015]
mat_Sqrt:  [[ 6.6070791   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00810415 0.00993387 0.04920184]
Stock Position:  0.008104153113422632
Bond Position:  [-0.56783568]


portfolio before change:  [0.23259536]
curr_Stock_Price:  98.7767640156362
curr_Factors:  [98.77676402 -1.31481549 -1.15771521]
mat_Sqrt:  [[ 8.33390134  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00764758 -0.02027665  0.01317122]
Stock Position:  -0.007647577010011909
Bond Position:  [0.98799827]


portfolio before change:  [0.23741915]
curr_Stock_Price:  98.16215351470883
curr_Factors:  [98.16215351 -1.33526082 -1.16162309]
mat_Sqrt:  [[ 8.08278778  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00123473  0.01454189 -0.4875572 ]
Stock Position:  0.0012347270688312637
Bond Position:  [0.11621568]


portfolio before change:  [0.23732749]
curr_Stock_Price:  98.0761561237316
curr_Factors:  [98.07615612 -1.35781886 -1.14141021]
mat_Sqrt:  [[ 8.05678997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00161696 -0.00527652 -0.07372206]
Stock Position:  -0.001616961782991061
Bond Position:  [0.39591289]


portfolio before change:  [0.23762654]
curr_Stock_Price:  97.92181871477764
curr_Factors:  [97.92181871 -1.36007661 -1.16749643]
mat_Sqrt:  [[ 7.81931028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102449  0.11168161 -0.8249724 ]
Stock Position:  -0.0010244912987055284
Bond Position:  [0.33794659]


portfolio before change:  [0.23838029]
curr_Stock_Price:  97.22732535693092
curr_Factors:  [97.22732536 -1.26884685 -1.15505754]
mat_Sqrt:  [[ 8.61192099  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00569207 0.01187707 0.18156926]
Stock Position:  0.005692068113290134
Bond Position:  [-0.31504427]


portfolio before change:  [0.23849273]
curr_Stock_Price:  97.2539989852599
curr_Factors:  [97.25399899 -1.26395574 -1.15524951]
mat_Sqrt:  [[ 8.65485858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144052 -0.0130278   0.21128835]
Stock Position:  0.0014405187856571244
Bond Position:  [0.09839652]


portfolio before change:  [0.23975797]
curr_Stock_Price:  98.12378086641678
curr_Factors:  [98.12378087 -1.37878547 -1.1591476 ]
mat_Sqrt:  [[ 7.75468121  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00494261 -0.017316   -0.61937005]
Stock Position:  0.004942605198180801
Bond Position:  [-0.24522914]


portfolio before change:  [0.23857364]
curr_Stock_Price:  97.89036652162254
curr_Factors:  [97.89036652 -1.43736958 -1.16711629]
mat_Sqrt:  [[ 7.23812561  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024832  0.00681055 -0.02568986]
Stock Position:  -0.000248322610758504
Bond Position:  [0.26288203]


portfolio before change:  [0.23875879]
curr_Stock_Price:  97.27711607783569
curr_Factors:  [97.27711608 -1.36987309 -1.16948981]
mat_Sqrt:  [[ 7.67678524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00734014 -0.00415117  0.63761171]
Stock Position:  -0.007340141117669171
Bond Position:  [0.95278655]


portfolio before change:  [0.23743764]
curr_Stock_Price:  97.47333210982167
curr_Factors:  [97.47333211 -1.28482968 -1.18975875]
mat_Sqrt:  [[ 8.20702417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0048142  -0.01068334 -0.01168116]
Stock Position:  -0.004814204892052691
Bond Position:  [0.70669423]


portfolio before change:  [0.24010919]
curr_Stock_Price:  96.93675243670464
curr_Factors:  [96.93675244 -1.2663179  -1.20328701]
mat_Sqrt:  [[ 8.20262166  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00976272  0.02997355 -0.31803754]
Stock Position:  -0.00976272055017114
Bond Position:  [1.18647561]


portfolio before change:  [0.2412396]
curr_Stock_Price:  96.83615564526447
curr_Factors:  [96.83615565 -1.26425598 -1.20064337]
mat_Sqrt:  [[ 8.23275805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00315941 -0.01300107  0.23287007]
Stock Position:  0.003159409476783854
Bond Position:  [-0.06470546]


portfolio before change:  [0.2417407]
curr_Stock_Price:  96.99732183360251
curr_Factors:  [96.99732183 -1.08237533 -1.22603495]
mat_Sqrt:  [[ 9.64339375  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.18853421e-04  1.04821044e-02 -1.40000460e-01]
Stock Position:  0.00011885342125821337
Bond Position:  [0.23021224]


portfolio before change:  [0.24178231]
curr_Stock_Price:  97.10525991948649
curr_Factors:  [97.10525992 -1.29786126 -1.21938488]
mat_Sqrt:  [[ 7.83459671  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00397402 -0.01169764 -0.33637765]
Stock Position:  0.0039740228671854725
Bond Position:  [-0.14411621]


portfolio before change:  [0.24295025]
curr_Stock_Price:  97.40368621520157
curr_Factors:  [97.40368622 -1.45819815 -1.25013123]
mat_Sqrt:  [[ 6.4917664   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00754567  0.00418982 -0.27824811]
Stock Position:  -0.007545671976262037
Bond Position:  [0.97792651]


portfolio before change:  [0.24221547]
curr_Stock_Price:  97.51726458542987
curr_Factors:  [97.51726459 -1.28061314 -1.26461057]
mat_Sqrt:  [[ 7.65076565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01497903 0.0087103  0.33528476]
Stock Position:  0.014979028311292983
Bond Position:  [-1.21849839]


portfolio before change:  [0.23761865]
curr_Stock_Price:  97.22054984737683
curr_Factors:  [97.22054985 -1.41478353 -1.26849309]
mat_Sqrt:  [[ 6.64394217  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01062001 -0.01043082  0.51297002]
Stock Position:  0.010620012821228002
Bond Position:  [-0.79486483]


portfolio before change:  [0.24312145]
curr_Stock_Price:  97.74805985516116
curr_Factors:  [97.74805986 -1.61448784 -1.28647029]
mat_Sqrt:  [[ 5.37326224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01444789 -0.00401301 -0.05791782]
Stock Position:  -0.014447888367036366
Bond Position:  [1.65537451]


portfolio before change:  [0.24195819]
curr_Stock_Price:  97.84289711746354
curr_Factors:  [97.84289712 -1.48960699 -1.29563145]
mat_Sqrt:  [[ 6.03831292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00153293 -0.0240336   0.05045448]
Stock Position:  -0.0015329266206260948
Bond Position:  [0.39194417]


portfolio before change:  [0.24203244]
curr_Stock_Price:  97.82642331950845
curr_Factors:  [97.82642332 -1.32954319 -1.32504405]
mat_Sqrt:  [[ 6.87992312  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00439048 0.03280448 0.27637947]
Stock Position:  0.0043904816931588505
Bond Position:  [-0.18747268]


portfolio before change:  [0.24307064]
curr_Stock_Price:  98.0682286684362
curr_Factors:  [98.06822867 -1.50996357 -1.3491536 ]
mat_Sqrt:  [[ 5.62120628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01349546 -0.03249967 -0.33356931]
Stock Position:  0.013495455054019185
Bond Position:  [-1.08040473]


portfolio before change:  [0.23882746]
curr_Stock_Price:  97.76382083074301
curr_Factors:  [97.76382083 -1.51659593 -1.36204681]
mat_Sqrt:  [[ 5.49540257  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02209868 0.0014023  0.21457127]
Stock Position:  0.022098678809144647
Bond Position:  [-1.92162381]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.23699314]
Stock Price:  97.69168520287324
PL:  [0.23699314]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.26261462e-01 -1.06144055e-01  2.01268934e-02]
 [-1.24085035e-01  6.95193325e-02 -1.32640212e-01]
 [-3.19322352e-02  4.15509078e-02  2.38809186e-02]
 [ 1.19736007e-01  3.17449105e-02  1.45049644e-01]
 [ 1.68086240e-01 -1.74646976e-01 -1.03886796e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.23147054e-02 -1.70390994e-01 -2.74501575e-02]
 [ 8.77211301e-03  6.22643451e-01  9.33985835e-02]
 [ 4.03504793e-01  4.47898631e-02  4.00178763e-01]
 [ 6.62834598e-01  2.95114949e-01  5.76497014e-01]
 [-1.30471414e-01 -2.21326580e-01 -5.58805690e-03]
 [-5.73754157e-02 -1.90341325e-02  7.96871699e-02]
 [ 1.48358731e-02 -5.59588626e-02  6.04099416e-02]
 [ 1.78820022e-03  1.03824916e-01 -5.07880007e-02]
 [ 5.20648289e-01 -1.62577102e-01 -2.31076021e-01]
 [-1.89496543e-01 -9.49909111e-02  1.14224121e-01]
 [ 5.50942978e-02 -3.01758289e-03 -6.50597450e-03]
 [-5.64539899e-02 -6.04725108e-02  2.91093112e-02]
 [ 1.82885629e-01 -2.27901471e-01  5.44327257e-02]
 [ 6.60839634e-02 -2.99756769e-03  3.79498335e-01]
 [-1.33540351e-02  3.11302953e-01 -2.94620211e-01]
 [ 2.04592587e-01  1.33337502e-01  8.90614676e-02]
 [ 2.02327677e-02  1.77919756e-01 -5.67221980e-02]
 [ 1.70668918e-01 -2.44638776e-01 -3.93306813e-01]
 [ 4.67763618e-02  7.49879185e-04 -1.28713128e-02]
 [-1.20784753e-02  1.62701644e-02  3.13390235e-02]
 [ 8.70757845e-02 -2.56015548e-02  5.84859751e-02]
 [ 1.57933624e-01 -6.11174274e-02  1.57573203e-01]
 [-4.35541025e-02 -8.24815761e-03 -4.52699112e-02]
 [-6.39146713e-02 -1.41473123e-02  3.80417747e-02]
 [-3.42939132e-02 -5.01493626e-02 -2.19274097e-02]
 [ 2.63173645e-02 -4.58557450e-02 -1.04176281e-01]
 [ 4.53342385e-02  4.09307334e-03  1.46954931e-01]
 [ 4.05296181e-03 -8.36228871e-02 -1.05619575e-01]
 [-5.58900361e-04  2.68717267e-02  3.90395322e-02]
 [ 4.69790089e-02  3.06534014e-02  1.44859802e-01]
 [ 2.10575456e-01 -1.48078295e-01  1.08095675e-01]
 [-1.07255887e-01  4.55121851e-02  4.67623606e-02]
 [ 2.93043434e-01 -3.23598845e-02  6.28471285e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.23928527]
curr_Stock_Price:  100.61089788657374
curr_Factors:  [100.61089789  -0.93575686  -1.01842893]
mat_Sqrt:  [[14.25453065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01710471 -0.03425785  0.05741642]
Stock Position:  -0.01710471200171609
Bond Position:  [8.9602057]


portfolio before change:  [7.24543746]
curr_Stock_Price:  100.31670431809083
curr_Factors:  [100.31670432  -0.76595858  -1.00160788]
mat_Sqrt:  [[17.12887733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00799641  0.02243727 -0.3783856 ]
Stock Position:  -0.007996410290811379
Bond Position:  [8.04761099]


portfolio before change:  [7.25046073]
curr_Stock_Price:  99.81432202920385
curr_Factors:  [99.81432203 -0.81266063 -0.98999684]
mat_Sqrt:  [[16.45540846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00112887  0.0134105   0.06812561]
Stock Position:  -0.0011288701575399936
Bond Position:  [7.36313814]


portfolio before change:  [7.2507634]
curr_Stock_Price:  100.3615769825073
curr_Factors:  [100.36157698  -0.85792966  -1.01276734]
mat_Sqrt:  [[15.45731615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01008092 0.01024563 0.41378626]
Stock Position:  0.010080924973612
Bond Position:  [6.23902587]


portfolio before change:  [7.26190981]
curr_Stock_Price:  101.38990374530941
curr_Factors:  [101.38990375  -0.9877348   -1.0272265 ]
mat_Sqrt:  [[13.51786594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00822843 -0.05636707 -0.29636011]
Stock Position:  0.008228426880100365
Bond Position:  [6.4276304]


portfolio before change:  [7.25968805]
curr_Stock_Price:  101.0222438356519
curr_Factors:  [101.02224384  -0.8515344   -0.99505994]
mat_Sqrt:  [[15.93864052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0096184  -0.05534923  0.15513819]
Stock Position:  -0.009618398508036424
Bond Position:  [8.23136025]


portfolio before change:  [7.2543055]
curr_Stock_Price:  101.68883471804857
curr_Factors:  [101.68883472  -0.83940196  -1.00445305]
mat_Sqrt:  [[16.08782069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00576205 -0.05499346 -0.07830766]
Stock Position:  -0.00576205212183495
Bond Position:  [7.84024187]


portfolio before change:  [7.25026636]
curr_Stock_Price:  102.55991855638953
curr_Factors:  [102.55991856  -0.89573202  -1.00542596]
mat_Sqrt:  [[15.3219927   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01011184 0.20095731 0.26644016]
Stock Position:  0.010111842777962043
Bond Position:  [6.21319659]


portfolio before change:  [7.25232883]
curr_Stock_Price:  102.68707291323616
curr_Factors:  [102.68707291  -0.97805649  -0.99002175]
mat_Sqrt:  [[14.34796334  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03445323 0.01445587 1.14159862]
Stock Position:  0.03445322668241374
Bond Position:  [3.71442783]


portfolio before change:  [7.26366093]
curr_Stock_Price:  103.00250857675904
curr_Factors:  [103.00250858  -0.89316822  -1.01739661]
mat_Sqrt:  [[15.2440386   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05515282 0.09524794 1.64458551]
Stock Position:  0.0551528153032401
Bond Position:  [1.5827826]


portfolio before change:  [7.27677597]
curr_Stock_Price:  103.23671557314364
curr_Factors:  [103.23671557  -0.97411864  -0.99784934]
mat_Sqrt:  [[14.36876244  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01230379 -0.07143285 -0.01594117]
Stock Position:  -0.01230378547497656
Bond Position:  [8.54697837]


portfolio before change:  [7.27500529]
curr_Stock_Price:  103.46746757556674
curr_Factors:  [103.46746758  -0.95506915  -0.99069362]
mat_Sqrt:  [[14.78324546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304363 -0.00614324  0.22732531]
Stock Position:  -0.0030436257339367
Bond Position:  [7.58992153]


portfolio before change:  [7.27497843]
curr_Stock_Price:  103.78802518094113
curr_Factors:  [103.78802518  -1.07203112  -1.00683693]
mat_Sqrt:  [[12.98094544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00121289 -0.01806065  0.17233275]
Stock Position:  0.0012128889894423662
Bond Position:  [7.14909508]


portfolio before change:  [7.27656513]
curr_Stock_Price:  104.35939908570646
curr_Factors:  [104.35939909  -1.25471869  -0.99828062]
mat_Sqrt:  [[10.96645854  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115026  0.03350935 -0.14488403]
Stock Position:  0.0011502633441649304
Bond Position:  [7.15652434]


portfolio before change:  [7.27814211]
curr_Stock_Price:  104.9526119317937
curr_Factors:  [104.95261193  -1.21767385  -1.01819583]
mat_Sqrt:  [[11.21934194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03924421 -0.05247153 -0.65919557]
Stock Position:  0.03924420736337925
Bond Position:  [3.15936004]


portfolio before change:  [7.29001382]
curr_Stock_Price:  105.24505693881605
curr_Factors:  [105.24505694  -1.36216912  -1.00027982]
mat_Sqrt:  [[ 9.91295581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01872    -0.03065818  0.32584962]
Stock Position:  -0.018720004815523147
Bond Position:  [9.2602018]


portfolio before change:  [7.2915223]
curr_Stock_Price:  105.22631356196518
curr_Factors:  [105.22631356  -1.40864067  -0.9741882 ]
mat_Sqrt:  [[ 9.71124535  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00547307 -0.00097392 -0.01855973]
Stock Position:  0.005473068368704787
Bond Position:  [6.71561149]


portfolio before change:  [7.29128663]
curr_Stock_Price:  105.02986616640713
curr_Factors:  [105.02986617  -1.47353134  -0.95654447]
mat_Sqrt:  [[ 9.2457958   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00679833 -0.01951742  0.08304076]
Stock Position:  -0.0067983305686941786
Bond Position:  [8.00531438]


portfolio before change:  [7.29246092]
curr_Stock_Price:  105.00433675738091
curr_Factors:  [105.00433676  -1.46861398  -0.96358848]
mat_Sqrt:  [[ 9.22391155  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0159885  -0.07355488  0.15528142]
Stock Position:  0.015988495678779035
Bond Position:  [5.61359953]


portfolio before change:  [7.2917695]
curr_Stock_Price:  104.91720152067691
curr_Factors:  [104.91720152  -1.5735808   -0.96952068]
mat_Sqrt:  [[ 8.24881868  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.73281613e-02 -9.67460813e-04  1.08260312e+00]
Stock Position:  0.017328161315684508
Bond Position:  [5.4737473]


portfolio before change:  [7.28486543]
curr_Stock_Price:  104.47928250108164
curr_Factors:  [104.4792825   -1.67286203  -0.95373221]
mat_Sqrt:  [[ 7.55639751  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131659  0.1004726  -0.84046946]
Stock Position:  -0.0013165909416361973
Bond Position:  [7.4224219]


portfolio before change:  [7.285903]
curr_Stock_Price:  104.39594958221578
curr_Factors:  [104.39594958  -1.64867065  -0.93534526]
mat_Sqrt:  [[ 7.87879501  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03172942 0.04303449 0.25406758]
Stock Position:  0.03172941879925447
Bond Position:  [3.9734802]


portfolio before change:  [7.29138311]
curr_Stock_Price:  104.55300865605071
curr_Factors:  [104.55300866  -1.7871387   -0.9248703 ]
mat_Sqrt:  [[ 6.94266147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00647765  0.05742335 -0.16181264]
Stock Position:  0.006477647767796621
Bond Position:  [6.61412555]


portfolio before change:  [7.28968809]
curr_Stock_Price:  104.16369436472029
curr_Factors:  [104.16369436  -1.92721145  -0.91482371]
mat_Sqrt:  [[ 6.07346015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00665993 -0.07895683 -1.12199486]
Stock Position:  0.0066599301171728536
Bond Position:  [6.59596516]


portfolio before change:  [7.29270243]
curr_Stock_Price:  104.49249584431642
curr_Factors:  [104.49249584  -1.64080191  -0.94463399]
mat_Sqrt:  [[ 7.8748911   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00562574  0.00024202 -0.03671827]
Stock Position:  0.005625739332148816
Bond Position:  [6.70485489]


portfolio before change:  [7.28967691]
curr_Stock_Price:  103.80571012029856
curr_Factors:  [103.80571012  -1.53874359  -0.94111395]
mat_Sqrt:  [[ 8.69426345  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027148  0.00525117  0.08940151]
Stock Position:  -0.00027147676030029683
Bond Position:  [7.31785775]


portfolio before change:  [7.29058542]
curr_Stock_Price:  103.82886396797888
curr_Factors:  [103.82886397  -1.46155704  -0.94559353]
mat_Sqrt:  [[ 9.35203006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01002866 -0.00826287  0.16684421]
Stock Position:  0.01002865561110952
Bond Position:  [6.2493215]


portfolio before change:  [7.29081434]
curr_Stock_Price:  103.77379261288473
curr_Factors:  [103.77379261  -0.94201401  -0.95018859]
mat_Sqrt:  [[15.64280174  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01135491 -0.01972556  0.44951249]
Stock Position:  0.01135490812053969
Bond Position:  [6.11247246]


portfolio before change:  [7.29499359]
curr_Stock_Price:  104.07455660012913
curr_Factors:  [104.0745566   -1.10387177  -0.92600213]
mat_Sqrt:  [[13.67040991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00398514 -0.00266208 -0.12914246]
Stock Position:  -0.003985135261756997
Bond Position:  [7.70974478]


portfolio before change:  [7.30000692]
curr_Stock_Price:  103.05839260700166
curr_Factors:  [103.05839261  -0.93963619  -0.92458806]
mat_Sqrt:  [[15.97574281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00369543 -0.00456603  0.10852259]
Stock Position:  -0.0036954297090748354
Bond Position:  [7.68085197]


portfolio before change:  [7.29866325]
curr_Stock_Price:  103.68182110208352
curr_Factors:  [103.6818211   -1.05900359  -0.96304478]
mat_Sqrt:  [[13.72581583  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00357039 -0.01618564 -0.0625528 ]
Stock Position:  -0.0035703905188965465
Bond Position:  [7.66884784]


portfolio before change:  [7.29787335]
curr_Stock_Price:  104.17156229327243
curr_Factors:  [104.17156229  -1.08454802  -0.95172406]
mat_Sqrt:  [[13.5958839   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00031685 -0.01479988 -0.29718593]
Stock Position:  -0.00031684550229017143
Bond Position:  [7.33087964]


portfolio before change:  [7.29883479]
curr_Stock_Price:  104.02946296421909
curr_Factors:  [104.02946296  -1.2164944   -0.94880029]
mat_Sqrt:  [[11.93385674  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00638241 0.00132103 0.41922151]
Stock Position:  0.006382411390732882
Bond Position:  [6.63487596]


portfolio before change:  [7.29841963]
curr_Stock_Price:  103.83446184390844
curr_Factors:  [103.83446184  -1.11714149  -0.96096579]
mat_Sqrt:  [[12.99663712  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266038 -0.02698917 -0.30130325]
Stock Position:  -0.002660380037767521
Bond Position:  [7.57465876]


portfolio before change:  [7.30177715]
curr_Stock_Price:  102.92833853097878
curr_Factors:  [102.92833853  -1.06415319  -0.95554203]
mat_Sqrt:  [[13.6581687   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00094414 0.00867281 0.11136892]
Stock Position:  0.0009441367510375716
Bond Position:  [7.20459872]


portfolio before change:  [7.3032358]
curr_Stock_Price:  103.51937177290624
curr_Factors:  [103.51937177  -0.98772029  -0.9758224 ]
mat_Sqrt:  [[14.53000856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00569893 0.00989334 0.41324469]
Stock Position:  0.005698929295095525
Bond Position:  [6.71328622]


portfolio before change:  [7.306265]
curr_Stock_Price:  103.9036525523625
curr_Factors:  [103.90365255  -0.72381832  -0.9948021 ]
mat_Sqrt:  [[18.63131257  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01086419 -0.04779206  0.30836687]
Stock Position:  0.01086418559305006
Bond Position:  [6.17743643]


portfolio before change:  [7.32990909]
curr_Stock_Price:  106.00890546648782
curr_Factors:  [106.00890547  -0.83232686  -1.0047222 ]
mat_Sqrt:  [[16.88581717  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00523637  0.01468899  0.1334    ]
Stock Position:  -0.0052363722497735035
Bond Position:  [7.88501118]


portfolio before change:  [7.330239]
curr_Stock_Price:  106.13413985019538
curr_Factors:  [106.13413985  -0.73646874  -0.99032965]
mat_Sqrt:  [[18.87626615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01585412 -0.01044411  0.17928536]
Stock Position:  0.015854121492196133
Bond Position:  [5.64757545]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.34915041]
Stock Price:  107.28244792801182
PL:  [0.06670248]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.55869580e-02  3.66614791e-02 -6.45015855e-03]
 [-2.57190341e-01  7.09181460e-02 -3.51776023e-01]
 [-4.04851144e-02  4.61842117e-02  1.77888900e-02]
 [ 6.38441811e-02  9.74431896e-02  4.09332013e-02]
 [-6.62045101e-02  1.79219646e-01 -4.44089729e-02]
 [-6.41663541e-02 -1.46417183e-01  1.86574726e-01]
 [-6.22312325e-02 -1.59222454e-01  7.25115885e-02]
 [-4.17509258e-02  7.59071712e-01  1.80958350e-01]
 [ 5.47058011e-01  1.04246934e-01  5.14721129e-01]
 [ 7.73546436e-01  3.32946359e-01  6.43066261e-01]
 [-2.56178155e-01 -2.76632615e-01  2.38962659e-03]
 [-1.09028851e-01 -2.04832918e-02  8.34967079e-02]
 [ 6.02729154e-04 -3.45106942e-02  1.28981177e-01]
 [ 5.51585120e-03 -3.37144198e-02  6.32424473e-02]
 [-2.03938488e-01  1.63968744e-01 -5.64880691e-02]
 [-2.70959106e-01 -1.44789669e-01 -1.80106247e-01]
 [ 6.78206474e-03  1.86738949e-01 -3.36525012e-01]
 [ 1.21780658e-01 -1.46405718e-02 -1.14996864e-01]
 [ 2.24889768e-02  2.25842462e-01 -1.06814533e-01]
 [-1.71056819e-01  3.28612885e-02 -1.14446799e-02]
 [-3.21750715e-02  4.25121555e-01 -3.59865080e-01]
 [ 4.22784588e-01  1.62514732e-01  1.39273001e-01]
 [ 5.83689392e-02 -9.47012030e-02  1.13122648e-01]
 [ 2.89797684e-01  2.44746077e-01 -9.95238675e-02]
 [-2.81857765e-01  1.42214397e-01  1.90866788e-02]
 [-2.13117930e-01 -8.69574966e-02  3.70890451e-02]
 [-1.13737413e-01 -3.66319739e-02 -3.55684604e-02]
 [-1.18718530e-01  1.45808274e-01 -1.49976761e-01]
 [ 3.85199781e-01  1.38852836e-01  3.38855603e-01]
 [ 1.80113178e-01  1.17992818e-01 -2.38058802e-01]
 [ 8.15673514e-02  9.31664631e-02  1.72353660e-01]
 [-1.88855105e-02  5.44537816e-02 -1.04936273e-01]
 [-9.00584812e-04  8.71337205e-02 -1.51037742e-02]
 [-2.25767734e-02 -7.04972456e-02  3.19097612e-02]
 [-8.07108424e-02  1.71185862e-01 -1.50959463e-01]
 [-2.76628841e-01 -2.90954165e-01 -2.67747364e-01]
 [ 1.01780227e-01  1.82088443e-01  4.61461051e-01]
 [ 2.75958031e-01 -1.78874821e-01 -4.02173430e-01]
 [ 8.99908936e-02  8.61430270e-03  1.12956292e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.46653441]
curr_Stock_Price:  99.00904413239535
curr_Factors:  [99.00904413 -0.99279884 -0.9791795 ]
mat_Sqrt:  [[13.78020109  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00140928  0.01183244 -0.01840051]
Stock Position:  -0.0014092753755944197
Bond Position:  [-5.3270034]


portfolio before change:  [-5.46726448]
curr_Stock_Price:  99.05456142472612
curr_Factors:  [99.05456142 -1.19613121 -0.96058263]
mat_Sqrt:  [[11.46108033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02744246  0.02288873 -1.00351908]
Stock Position:  -0.027442457975285175
Bond Position:  [-2.74896384]


portfolio before change:  [-5.48779508]
curr_Stock_Price:  99.79017208117105
curr_Factors:  [99.79017208 -0.91187954 -0.96612723]
mat_Sqrt:  [[15.25737403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0017976   0.01490589  0.05074675]
Stock Position:  -0.0017976002689423843
Bond Position:  [-5.30841224]


portfolio before change:  [-5.48782662]
curr_Stock_Price:  99.43856215554719
curr_Factors:  [99.43856216 -0.47605862 -0.92972773]
mat_Sqrt:  [[24.37976877  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00377732 0.03144965 0.11677103]
Stock Position:  0.0037773181734341884
Bond Position:  [-5.86343771]


portfolio before change:  [-5.48919564]
curr_Stock_Price:  99.2701763732086
curr_Factors:  [99.27017637 -0.37207641 -0.93797143]
mat_Sqrt:  [[26.7838031   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014444   0.05784289 -0.12668644]
Stock Position:  -0.0014443951964824618
Bond Position:  [-5.34581028]


portfolio before change:  [-5.48928187]
curr_Stock_Price:  98.86720859039602
curr_Factors:  [98.86720859 -0.29277564 -0.93095299]
mat_Sqrt:  [[29.07995182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00192467 -0.04725594  0.53224576]
Stock Position:  -0.0019246672129434432
Bond Position:  [-5.29899539]


portfolio before change:  [-5.49112731]
curr_Stock_Price:  99.48187584316317
curr_Factors:  [99.48187584 -0.28004321 -0.94273113]
mat_Sqrt:  [[29.28868116  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00272908 -0.05138883  0.20685538]
Stock Position:  -0.0027290752141542634
Bond Position:  [-5.21963379]


portfolio before change:  [-5.49480496]
curr_Stock_Price:  100.59036744532692
curr_Factors:  [100.59036745  -0.19018291  -0.95853956]
mat_Sqrt:  [[31.89132516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00470761 0.24498934 0.5162238 ]
Stock Position:  0.004707609557152379
Bond Position:  [-5.96834514]


portfolio before change:  [-5.48630483]
curr_Stock_Price:  102.55446835577533
curr_Factors:  [102.55446836  -0.29854289  -0.92376617]
mat_Sqrt:  [[30.20734172  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02229274 0.03364555 1.46835611]
Stock Position:  0.02229273742539395
Bond Position:  [-7.77252467]


portfolio before change:  [-5.49146014]
curr_Stock_Price:  102.366798235889
curr_Factors:  [ 1.02366798e+02  8.15432990e-02 -9.51532452e-01]
mat_Sqrt:  [[42.88719391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02268216 0.10745798 1.83448905]
Stock Position:  0.022682159608795837
Bond Position:  [-7.8133602]


portfolio before change:  [-5.5073791]
curr_Stock_Price:  101.70803280080183
curr_Factors:  [101.7080328    0.21949377  -0.93470369]
mat_Sqrt:  [[49.74432366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00627524 -0.08928279  0.00681694]
Stock Position:  -0.00627524403020121
Bond Position:  [-4.86913637]


portfolio before change:  [-5.4950349]
curr_Stock_Price:  99.6439092803829
curr_Factors:  [99.64390928  0.41837218 -0.9353062 ]
mat_Sqrt:  [[59.42225984  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00161835 -0.00661095  0.23819287]
Stock Position:  -0.0016183546712011426
Bond Position:  [-5.33377571]


portfolio before change:  [-5.49535118]
curr_Stock_Price:  99.42734086376197
curr_Factors:  [99.42734086  0.18693111 -0.92088206]
mat_Sqrt:  [[47.72599374  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00041668 -0.01113828  0.3679474 ]
Stock Position:  0.0004166793426666851
Bond Position:  [-5.53678049]


portfolio before change:  [-5.49730093]
curr_Stock_Price:  96.40915681178082
curr_Factors:  [ 9.64091568e+01 -5.58935805e-02 -9.16581601e-01]
mat_Sqrt:  [[36.45672727  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00031663 -0.01088128  0.1804131 ]
Stock Position:  0.00031662838234371746
Bond Position:  [-5.52782681]


portfolio before change:  [-5.49980044]
curr_Stock_Price:  90.69745514894268
curr_Factors:  [ 9.06974551e+01  5.92388557e-02 -9.04699453e-01]
mat_Sqrt:  [[38.94181861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00467362  0.05292068 -0.16114474]
Stock Position:  -0.004673615497177916
Bond Position:  [-5.07591541]


portfolio before change:  [-5.50465776]
curr_Stock_Price:  91.6009926182737
curr_Factors:  [ 9.16009926e+01 -2.63981546e-02 -9.02205771e-01]
mat_Sqrt:  [[36.192003    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00931914 -0.04673066 -0.51379299]
Stock Position:  -0.009319136238939058
Bond Position:  [-4.65101563]


portfolio before change:  [-5.51970446]
curr_Stock_Price:  93.1532060347343
curr_Factors:  [ 9.31532060e+01 -5.99708195e-02 -9.23881683e-01]
mat_Sqrt:  [[34.82700222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.83173568e-04  6.02697365e-02 -9.60012188e-01]
Stock Position:  -0.0006831735677776147
Bond Position:  [-5.45606465]


portfolio before change:  [-5.52079892]
curr_Stock_Price:  93.75687559884753
curr_Factors:  [93.7568756  -0.20625138 -0.93809382]
mat_Sqrt:  [[29.85522319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00319269 -0.00472522 -0.32805404]
Stock Position:  0.0031926918446142896
Bond Position:  [-5.82013573]


portfolio before change:  [-5.52274138]
curr_Stock_Price:  93.37635164813744
curr_Factors:  [93.37635165 -0.29692209 -0.92784335]
mat_Sqrt:  [[27.43645695  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00170523  0.07289034 -0.30471213]
Stock Position:  0.001705229326516775
Bond Position:  [-5.68196947]


portfolio before change:  [-5.52858733]
curr_Stock_Price:  90.36463779339189
curr_Factors:  [90.36463779 -0.19331008 -0.94192394]
mat_Sqrt:  [[29.03839717  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00574016  0.01060594 -0.03264849]
Stock Position:  -0.005740164355912979
Bond Position:  [-5.00987946]


portfolio before change:  [-5.52756597]
curr_Stock_Price:  90.07760205471861
curr_Factors:  [90.07760205 -0.37371552 -0.94758148]
mat_Sqrt:  [[24.03171811  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.84573504e-04  1.37207392e-01 -1.02659491e+00]
Stock Position:  -0.0007845735039240407
Bond Position:  [-5.45689347]


portfolio before change:  [-5.52913374]
curr_Stock_Price:  91.20638364554704
curr_Factors:  [91.20638365 -0.40581022 -0.95575516]
mat_Sqrt:  [[23.37248574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02072466 0.0524514  0.39730711]
Stock Position:  0.020724657035235936
Bond Position:  [-7.41935476]


portfolio before change:  [-5.55835964]
curr_Stock_Price:  89.84093644841951
curr_Factors:  [89.84093645 -0.56763182 -0.952571  ]
mat_Sqrt:  [[19.64529587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00316255 -0.03056468  0.32270743]
Stock Position:  0.003162548500778227
Bond Position:  [-5.84248596]


portfolio before change:  [-5.55376958]
curr_Stock_Price:  91.52325721258282
curr_Factors:  [91.52325721 -0.46602975 -0.99323862]
mat_Sqrt:  [[21.27057695  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01501798  0.07899146 -0.28391389]
Stock Position:  0.015017977386449253
Bond Position:  [-6.92826378]


portfolio before change:  [-5.55221405]
curr_Stock_Price:  91.68450465069796
curr_Factors:  [91.68450465 -0.61113333 -1.00255526]
mat_Sqrt:  [[18.25912207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01363331  0.0458995   0.05444898]
Stock Position:  -0.013633312721057897
Bond Position:  [-4.30225053]


portfolio before change:  [-5.5496142]
curr_Stock_Price:  91.45435780036942
curr_Factors:  [91.4543578  -0.44031056 -1.00936583]
mat_Sqrt:  [[21.45941829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01040556 -0.02806541  0.10580472]
Stock Position:  -0.010405560974817813
Bond Position:  [-4.59798031]


portfolio before change:  [-5.53611637]
curr_Stock_Price:  90.10194455434512
curr_Factors:  [90.10194455 -0.44113987 -1.00262246]
mat_Sqrt:  [[21.26748561  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00604092 -0.01182292 -0.10146692]
Stock Position:  -0.006040924036669568
Bond Position:  [-4.99181737]


portfolio before change:  [-5.53169084]
curr_Stock_Price:  89.26605517458056
curr_Factors:  [89.26605517 -0.5055019  -0.98019329]
mat_Sqrt:  [[20.20491926  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00591784  0.04705942 -0.42784195]
Stock Position:  -0.005917837016256733
Bond Position:  [-5.00342888]


portfolio before change:  [-5.53413154]
curr_Stock_Price:  89.5727939907823
curr_Factors:  [89.57279399 -0.51625787 -0.97633355]
mat_Sqrt:  [[20.13501245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02397374 0.04481456 0.96666072]
Stock Position:  0.023973742694988885
Bond Position:  [-7.68152665]


portfolio before change:  [-5.56136366]
curr_Stock_Price:  88.47693384953008
curr_Factors:  [88.47693385 -0.22045568 -0.99134488]
mat_Sqrt:  [[26.33611856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00590842  0.03808202 -0.6791155 ]
Stock Position:  0.005908418573958932
Bond Position:  [-6.08412242]


portfolio before change:  [-5.55732072]
curr_Stock_Price:  89.2899265670414
curr_Factors:  [89.28992657 -0.28764853 -0.99719049]
mat_Sqrt:  [[24.7060872   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00549526 0.03006935 0.49167702]
Stock Position:  0.005495261895336743
Bond Position:  [-6.04799225]


portfolio before change:  [-5.54320604]
curr_Stock_Price:  91.99602685252574
curr_Factors:  [91.99602685 -0.41779616 -1.02199527]
mat_Sqrt:  [[21.80095903  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00133894  0.01757488 -0.29935398]
Stock Position:  -0.001338941365318792
Bond Position:  [-5.42002875]


portfolio before change:  [-5.54310943]
curr_Stock_Price:  91.4178428882754
curr_Factors:  [91.41784289 -0.36894068 -0.99959961]
mat_Sqrt:  [[23.26384364  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0005933   0.02812229 -0.04308686]
Stock Position:  0.0005933012025318051
Bond Position:  [-5.59734774]


portfolio before change:  [-5.54508348]
curr_Stock_Price:  89.26996105160825
curr_Factors:  [89.26996105 -0.26751326 -0.994104  ]
mat_Sqrt:  [[25.2808651   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012046  -0.02275289  0.09102967]
Stock Position:  -0.0012046031879321619
Bond Position:  [-5.4375486]


portfolio before change:  [-5.54375247]
curr_Stock_Price:  87.60073865452557
curr_Factors:  [87.60073865 -0.32790364 -0.97126525]
mat_Sqrt:  [[23.89383637  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0032051   0.05525    -0.43064533]
Stock Position:  -0.0032051004614729933
Bond Position:  [-5.2629833]


portfolio before change:  [-5.54162491]
curr_Stock_Price:  86.73166410679838
curr_Factors:  [86.73166411 -0.47055346 -0.97023533]
mat_Sqrt:  [[20.53293618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01902667 -0.09390505 -0.7638087 ]
Stock Position:  -0.019026665732003824
Bond Position:  [-3.89141053]


portfolio before change:  [-5.51929627]
curr_Stock_Price:  85.53255250578863
curr_Factors:  [85.53255251 -0.4001187  -0.96490703]
mat_Sqrt:  [[21.84279892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01067373 0.05876879 1.31641993]
Stock Position:  0.010673733641609869
Bond Position:  [-6.43224795]


portfolio before change:  [-5.52217774]
curr_Stock_Price:  85.3379266032752
curr_Factors:  [85.3379266  -0.34665505 -0.96649346]
mat_Sqrt:  [[22.95350103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00685525 -0.0577316  -1.14728885]
Stock Position:  0.006855252860666004
Bond Position:  [-6.1071908]


portfolio before change:  [-5.52868395]
curr_Stock_Price:  84.50020868736289
curr_Factors:  [84.50020869 -0.1507483  -1.00153856]
mat_Sqrt:  [[26.69475606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00430071 0.00278025 0.32223286]
Stock Position:  0.004300709360630161
Bond Position:  [-5.89209479]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.52761391]
Stock Price:  84.92027912322648
PL:  [-5.52761391]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 7.31067586e-02 -6.81633227e-02  8.43905905e-03]
 [-2.15700741e-01  6.20899548e-02 -2.36560613e-01]
 [-1.23253123e-02  5.95847938e-02  3.98369373e-02]
 [ 1.10611051e-01  6.38797039e-02  1.09073940e-01]
 [-1.42799363e-01  2.51330903e-01 -2.19022312e-02]
 [-3.65196212e-02 -1.27970938e-01  2.86722242e-01]
 [-6.46389331e-02 -2.39058926e-01 -1.11483058e-01]
 [-8.05880740e-02  9.67462718e-01  2.57828138e-01]
 [ 3.20477745e-02 -1.22496842e-01 -1.92373458e-02]
 [ 1.74089564e-01  5.80013377e-02  5.63787921e-02]
 [-1.05101210e-01 -2.35944628e-01 -1.05384159e-02]
 [-5.68189669e-02 -2.40069460e-02  4.63837864e-03]
 [-9.76753405e-02  3.61446452e-01 -6.15857382e-01]
 [ 2.96202915e-03  1.90348503e-02  7.06555356e-02]
 [-1.79453625e-01  1.87097258e-01 -3.50851424e-02]
 [-2.74814185e-01 -1.34873622e-01 -1.49505004e-01]
 [-4.70648454e-02  2.28249621e-01 -4.37689614e-01]
 [ 1.18457854e-01 -1.52504944e-02 -1.12794542e-01]
 [ 1.57758037e-02  2.79225576e-01 -1.25635543e-01]
 [-1.78865354e-01  1.17785008e-01 -1.00561530e-01]
 [-2.37264575e-02  3.67865550e-01 -3.04442445e-01]
 [ 3.16649430e-01  1.14776066e-01  1.53083836e-01]
 [ 3.80708863e-02 -4.74288700e-02  8.06751527e-02]
 [ 2.32532853e-01  2.15206748e-01 -1.43360832e-01]
 [-1.56970221e-01  4.58364914e-02  6.33996806e-03]
 [-1.94399187e-01 -6.72537433e-02  8.36165301e-02]
 [-7.04881271e-02 -3.47655951e-02 -1.89316856e-02]
 [-8.21860525e-02  1.12223650e-01 -6.67530527e-02]
 [ 1.12718826e-01 -2.93287942e-02  1.58333083e-01]
 [ 3.16485576e-02  4.73130496e-02 -7.90665278e-02]
 [ 2.75876793e-02 -1.57186549e-02 -4.29968525e-02]
 [-2.64148320e-02  5.56002233e-02 -1.16896277e-01]
 [-2.00171643e-02  5.85385957e-02 -7.21041890e-02]
 [ 4.79786048e-02 -4.06120809e-02  1.85991733e-01]
 [-7.46880518e-02 -3.74419846e-03 -3.24438738e-02]
 [-1.47608218e-01 -1.67260768e-01 -1.34977587e-01]
 [ 9.12400408e-02  1.02694971e-01  2.20740765e-01]
 [ 1.91485668e-01 -1.31548650e-01 -2.11272643e-01]
 [ 9.70648103e-02  4.23183270e-03  7.10801105e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.49744304]
curr_Stock_Price:  99.76093735235152
curr_Factors:  [99.76093735 -1.09196041 -1.02214897]
mat_Sqrt:  [[12.04521303  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00505725 -0.02199962  0.02407429]
Stock Position:  0.005057245079772842
Bond Position:  [-0.00707247]


portfolio before change:  [0.49513897]
curr_Stock_Price:  99.30551428906931
curr_Factors:  [99.30551429 -0.92730242 -1.00262672]
mat_Sqrt:  [[14.41503786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01743418  0.02003945 -0.67484158]
Stock Position:  -0.017434183507986544
Bond Position:  [2.22644953]


portfolio before change:  [0.51292548]
curr_Stock_Price:  98.30126973395075
curr_Factors:  [98.30126973 -0.88350683 -0.99964359]
mat_Sqrt:  [[14.95261976  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00053295 0.01923091 0.11364369]
Stock Position:  0.0005329543416601218
Bond Position:  [0.46053539]


portfolio before change:  [0.51279042]
curr_Stock_Price:  97.93983586835071
curr_Factors:  [97.93983587 -0.9019757  -0.98835067]
mat_Sqrt:  [[14.79112012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00986504 0.02061709 0.31115759]
Stock Position:  0.009865044998372147
Bond Position:  [-0.45339047]


portfolio before change:  [0.50543614]
curr_Stock_Price:  97.20009219106706
curr_Factors:  [97.20009219 -0.84825087 -0.99324496]
mat_Sqrt:  [[15.4139945   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00622599  0.0811167  -0.06248097]
Stock Position:  -0.006225993604823193
Bond Position:  [1.11060329]


portfolio before change:  [0.50567312]
curr_Stock_Price:  97.18432827750797
curr_Factors:  [97.18432828 -0.81817501 -0.97606904]
mat_Sqrt:  [[16.15719437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.54663469e-04 -4.13024428e-02  8.17938747e-01]
Stock Position:  -0.00025466346865910845
Bond Position:  [0.53042242]


portfolio before change:  [0.50582794]
curr_Stock_Price:  96.8367622041738
curr_Factors:  [96.8367622  -0.65956111 -0.98568627]
mat_Sqrt:  [[18.68608855  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00728847 -0.07715594 -0.31803013]
Stock Position:  -0.007288471075754904
Bond Position:  [1.21161988]


portfolio before change:  [0.51429118]
curr_Stock_Price:  95.6963605423702
curr_Factors:  [95.69636054 -0.5452797  -0.98556319]
mat_Sqrt:  [[20.70421664  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00818787 0.31224725 0.73551191]
Stock Position:  0.00818786711450651
Bond Position:  [-0.2692579]


portfolio before change:  [0.50773158]
curr_Stock_Price:  94.89933477864531
curr_Factors:  [94.89933478 -0.46874458 -0.97459044]
mat_Sqrt:  [[22.40942615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00013907 -0.03953569 -0.05487879]
Stock Position:  0.0001390666848833493
Bond Position:  [0.49453425]


portfolio before change:  [0.5078507]
curr_Stock_Price:  95.31134400396489
curr_Factors:  [95.311344   -0.23259336 -1.0076961 ]
mat_Sqrt:  [[27.57361604  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00716037 0.01871985 0.160833  ]
Stock Position:  0.007160370635189769
Bond Position:  [-0.17461385]


portfolio before change:  [0.5042266]
curr_Stock_Price:  94.8082595357003
curr_Factors:  [94.80825954 -0.29906934 -1.00217955]
mat_Sqrt:  [[25.80601597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00602241 -0.0761508  -0.03006317]
Stock Position:  -0.0060224077537137455
Bond Position:  [1.0752006]


portfolio before change:  [0.51280299]
curr_Stock_Price:  93.40649746948694
curr_Factors:  [93.40649747 -0.18512372 -0.99107756]
mat_Sqrt:  [[28.81106853  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00210935 -0.00774821  0.013232  ]
Stock Position:  -0.002109347629487103
Bond Position:  [0.70982977]


portfolio before change:  [0.51265052]
curr_Stock_Price:  93.5208492599257
curr_Factors:  [93.52084926  0.0953727  -0.98733677]
mat_Sqrt:  [[38.3295189   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00390317  0.11665634 -1.75686969]
Stock Position:  -0.003903173285891161
Bond Position:  [0.8776786]


portfolio before change:  [0.5214107]
curr_Stock_Price:  91.3045858850889
curr_Factors:  [91.30458589  0.2377283  -0.98937935]
mat_Sqrt:  [[43.05808255  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00049398 0.00614347 0.20156058]
Stock Position:  0.0004939839688932424
Bond Position:  [0.47630769]


portfolio before change:  [0.52231386]
curr_Stock_Price:  93.01237779415416
curr_Factors:  [ 9.30123778e+01 -6.98922273e-02 -9.98171280e-01]
mat_Sqrt:  [[31.9658796   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00464321  0.06038538 -0.10008815]
Stock Position:  -0.0046432096845227065
Bond Position:  [0.95418983]


portfolio before change:  [0.52670024]
curr_Stock_Price:  92.093379423972
curr_Factors:  [ 9.20933794e+01  3.70139365e-02 -9.85742098e-01]
mat_Sqrt:  [[35.66161481  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00933392 -0.04353027 -0.42649616]
Stock Position:  -0.009333921946378354
Bond Position:  [1.38629266]


portfolio before change:  [0.52929367]
curr_Stock_Price:  91.83409602816312
curr_Factors:  [91.83409603 -0.1382624  -0.98276913]
mat_Sqrt:  [[29.93271756  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300062  0.07366725 -1.24860664]
Stock Position:  -0.0030006164557787626
Bond Position:  [0.80485257]


portfolio before change:  [0.52489738]
curr_Stock_Price:  93.33275621127648
curr_Factors:  [93.33275621 -0.51929399 -0.98048661]
mat_Sqrt:  [[20.82992248  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00443212 -0.00492208 -0.32177143]
Stock Position:  0.004432122614628406
Bond Position:  [0.11123516]


portfolio before change:  [0.52183604]
curr_Stock_Price:  92.63890277636602
curr_Factors:  [92.63890278 -0.65126804 -0.95754834]
mat_Sqrt:  [[18.53929981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00254202  0.09011967 -0.35840324]
Stock Position:  0.002542018213213815
Bond Position:  [0.28634626]


portfolio before change:  [0.51860662]
curr_Stock_Price:  91.3544039372713
curr_Factors:  [91.35440394 -0.79303521 -0.93472584]
mat_Sqrt:  [[16.23201368  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0108027   0.03801495 -0.28687406]
Stock Position:  -0.01080270318948187
Bond Position:  [1.50548113]


portfolio before change:  [0.52080521]
curr_Stock_Price:  91.1683024941713
curr_Factors:  [91.16830249 -0.77047202 -0.95463519]
mat_Sqrt:  [[16.24199338  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.63728288e-04  1.18728096e-01 -8.68489554e-01]
Stock Position:  -0.0006637282883157996
Bond Position:  [0.5813162]


portfolio before change:  [0.52058315]
curr_Stock_Price:  91.6123547701024
curr_Factors:  [91.61235477 -0.60732442 -0.95517843]
mat_Sqrt:  [[19.20293813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01933694 0.03704382 0.43670557]
Stock Position:  0.019336942156752406
Bond Position:  [-1.25091965]


portfolio before change:  [0.54605179]
curr_Stock_Price:  92.93753910482894
curr_Factors:  [92.9375391  -0.67641128 -0.96693583]
mat_Sqrt:  [[17.96778683  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00249654 -0.0153076   0.23014376]
Stock Position:  0.0024965375938666165
Bond Position:  [0.31402973]


portfolio before change:  [0.54611996]
curr_Stock_Price:  92.94912144335477
curr_Factors:  [92.94912144 -0.63328017 -0.96245283]
mat_Sqrt:  [[18.84634993  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01311651  0.06945768 -0.40896855]
Stock Position:  0.013116510081832055
Bond Position:  [-0.67304813]


portfolio before change:  [0.56796879]
curr_Stock_Price:  94.62128636669351
curr_Factors:  [94.62128637 -0.71475106 -0.96982488]
mat_Sqrt:  [[17.55443327  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0083352   0.01479366  0.01808616]
Stock Position:  -0.008335201910304518
Bond Position:  [1.35665632]


portfolio before change:  [0.58529368]
curr_Stock_Price:  92.56311252476655
curr_Factors:  [92.56311252 -0.51939647 -0.9898489 ]
mat_Sqrt:  [[20.46355173  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00933656 -0.02170605  0.23853469]
Stock Position:  -0.009336558442855478
Bond Position:  [1.44951459]


portfolio before change:  [0.57170726]
curr_Stock_Price:  94.03770509343107
curr_Factors:  [94.03770509 -0.75471307 -0.99206105]
mat_Sqrt:  [[16.39410309  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00496819 -0.01122055 -0.05400683]
Stock Position:  -0.004968191197320196
Bond Position:  [1.03890456]


portfolio before change:  [0.5648128]
curr_Stock_Price:  95.45156717583086
curr_Factors:  [95.45156718 -0.72876063 -1.00943721]
mat_Sqrt:  [[16.78391743  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00434371  0.03622003 -0.19042788]
Stock Position:  -0.004343706176606545
Bond Position:  [0.97942636]


portfolio before change:  [0.56566077]
curr_Stock_Price:  95.28453611187823
curr_Factors:  [95.28453611 -0.6908951  -0.99789082]
mat_Sqrt:  [[17.60321587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00789922 -0.00946583  0.45168021]
Stock Position:  0.00789922235545
Bond Position:  [-0.18701297]


portfolio before change:  [0.5690099]
curr_Stock_Price:  95.71147815325597
curr_Factors:  [95.71147815 -0.66117203 -0.95886388]
mat_Sqrt:  [[18.94049687  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00132874  0.01527022 -0.2255548 ]
Stock Position:  0.0013287352583323054
Bond Position:  [0.44183468]


portfolio before change:  [0.56817376]
curr_Stock_Price:  95.04063964778103
curr_Factors:  [95.04063965 -0.82159344 -0.96402698]
mat_Sqrt:  [[15.93764904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00097897 -0.00507317 -0.12265805]
Stock Position:  0.0009789666303973371
Bond Position:  [0.47513215]


portfolio before change:  [0.56636033]
curr_Stock_Price:  93.12756704756055
curr_Factors:  [93.12756705 -0.65214599 -0.96308925]
mat_Sqrt:  [[18.51784755  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00210213  0.01794489 -0.33347254]
Stock Position:  -0.0021021253341419062
Bond Position:  [0.76212614]


portfolio before change:  [0.56333965]
curr_Stock_Price:  94.60985184072175
curr_Factors:  [94.60985184 -0.69194212 -0.98567266]
mat_Sqrt:  [[17.67492263  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00128918  0.01889325 -0.20569318]
Stock Position:  -0.0012891841146024726
Bond Position:  [0.68530917]


portfolio before change:  [0.56266821]
curr_Stock_Price:  95.19713008933405
curr_Factors:  [95.19713009 -0.83797411 -1.02253545]
mat_Sqrt:  [[14.81203807  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00524263 -0.01310749  0.53058264]
Stock Position:  0.005242634516958527
Bond Position:  [0.06358445]


portfolio before change:  [0.55898006]
curr_Stock_Price:  94.49212278505212
curr_Factors:  [94.49212279 -0.87873956 -1.05100125]
mat_Sqrt:  [[13.7189167   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00598261 -0.00120843 -0.09255334]
Stock Position:  -0.005982608756415025
Bond Position:  [1.12428946]


portfolio before change:  [0.55816545]
curr_Stock_Price:  94.65177766033996
curr_Factors:  [94.65177766 -0.95583284 -1.03012254]
mat_Sqrt:  [[12.99090215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01611146 -0.05398318 -0.38505348]
Stock Position:  -0.01611145717745189
Bond Position:  [2.08314352]


portfolio before change:  [0.55059432]
curr_Stock_Price:  95.13786320401887
curr_Factors:  [95.1378632  -0.8322893  -1.02573306]
mat_Sqrt:  [[14.8396799   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01059734 0.03314466 0.62971196]
Stock Position:  0.01059733665799446
Bond Position:  [-0.45761365]


portfolio before change:  [0.53451237]
curr_Stock_Price:  93.62571519697859
curr_Factors:  [93.6257152  -0.650852   -1.00983301]
mat_Sqrt:  [[17.78970777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00683022 -0.04245714 -0.60270204]
Stock Position:  0.006830216995904541
Bond Position:  [-0.10497158]


portfolio before change:  [0.52932813]
curr_Stock_Price:  92.86862040096106
curr_Factors:  [92.8686204  -0.53079647 -1.00891565]
mat_Sqrt:  [[19.91500948  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00564588 0.00136582 0.20277177]
Stock Position:  0.005645882138584227
Bond Position:  [0.00500284]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.52612023]
Stock Price:  92.30032617106447
PL:  [0.52612023]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.06543551e-01 -6.39212096e-02  7.13363092e-03]
 [-1.62224006e-01  6.67203009e-02 -1.82338894e-01]
 [-4.02453700e-02  4.60543364e-02  1.79596546e-02]
 [-7.65707804e-02 -8.49305684e-02 -2.14616878e-02]
 [ 7.27195322e-02 -1.79044491e-02 -7.98912394e-02]
 [-7.09580815e-02 -1.51174175e-01  1.60700003e-01]
 [-6.00489533e-02 -1.88538380e-01  1.08081736e-01]
 [ 1.93840863e-02  7.26030154e-01  1.06466212e-01]
 [ 4.02943993e-02  3.72070484e-02  1.74158263e-02]
 [ 2.85805892e-01  1.04601139e-01  1.50742048e-01]
 [-1.93205805e-01 -2.56073880e-01  3.38252808e-03]
 [-3.82577942e-02 -1.80347547e-02  9.22698571e-02]
 [ 7.50130541e-03 -4.81514169e-02  1.19965862e-01]
 [ 1.19819657e-02 -1.30948974e-01 -5.10448130e-02]
 [ 5.15929536e-02 -6.58759091e-02 -8.40373999e-02]
 [ 7.20313558e-03 -3.03265498e-02  6.77032999e-02]
 [ 4.91731949e-02  2.10303384e-02 -1.45216525e-02]
 [-5.33900681e-02 -5.86601384e-02  3.34718027e-02]
 [ 5.56810119e-02 -1.50789787e-02 -1.31294139e-01]
 [-8.68510450e-03  1.25120934e-02 -4.86358981e-02]
 [-3.16077965e-02  4.38231544e-01 -3.89069893e-01]
 [ 2.74542011e-01  1.66808066e-01  7.76706968e-02]
 [ 2.50527218e-03 -3.58169805e-02  7.12269727e-02]
 [ 2.97862456e-02  7.02271340e-03 -1.14147532e-01]
 [-8.02617873e-02  7.17386336e-03 -1.45213355e-03]
 [-1.17507980e-01 -8.15505387e-03  2.26207526e-01]
 [-3.06941554e-02 -3.30483268e-02 -3.62407235e-03]
 [-7.06555083e-02  5.77641177e-02 -2.15901352e-01]
 [-3.16666713e-02 -4.16688922e-02  4.03633458e-02]
 [-5.89373099e-02  9.34701812e-03  1.04313676e-02]
 [-2.65852538e-02 -4.18043192e-02 -7.60137247e-03]
 [ 3.08691346e-02  1.29598195e-02 -4.83970991e-02]
 [-4.10890795e-02  2.08161405e-02 -7.15924120e-02]
 [ 1.42435148e-02 -6.59897801e-02  9.38118036e-03]
 [-3.68724668e-02  3.57697939e-02  3.79029085e-02]
 [ 8.24511763e-02  2.48469060e-02  1.79740203e-01]
 [-3.60808991e-02  4.53151950e-02 -3.87837893e-02]
 [-5.54836718e-02 -3.89322060e-03  3.26531114e-02]
 [ 9.23199301e-02  7.17140580e-03  9.91688586e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.51225814]
curr_Stock_Price:  99.63364185555359
curr_Factors:  [99.63364186 -1.06571045 -0.97744055]
mat_Sqrt:  [[12.91447632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00735236 -0.02063048  0.02035026]
Stock Position:  0.007352356609815405
Bond Position:  [-1.24480021]


portfolio before change:  [-0.50834709]
curr_Stock_Price:  100.18675198022221
curr_Factors:  [100.18675198  -1.10453585  -1.01121956]
mat_Sqrt:  [[12.07673119  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01538699  0.02153388 -0.52016211]
Stock Position:  -0.015386990812187895
Bond Position:  [1.03322554]


portfolio before change:  [-0.50672703]
curr_Stock_Price:  100.08985875127793
curr_Factors:  [100.08985875  -1.36040117  -1.04252248]
mat_Sqrt:  [[ 9.05343925  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300202  0.01486397  0.0512339 ]
Stock Position:  -0.0030020159301001807
Bond Position:  [-0.20625568]


portfolio before change:  [-0.50843551]
curr_Stock_Price:  100.65038174262465
curr_Factors:  [100.65038174  -1.39706756  -1.03283617]
mat_Sqrt:  [[ 8.86179388  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01109121 -0.02741122 -0.06122422]
Stock Position:  -0.011091209073055141
Bond Position:  [0.60789891]


portfolio before change:  [-0.50059438]
curr_Stock_Price:  99.95026481773571
curr_Factors:  [99.95026482 -1.56024051 -1.03199054]
mat_Sqrt:  [[ 7.48156244  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00705161 -0.00577864 -0.22790747]
Stock Position:  0.007051611384056507
Bond Position:  [-1.2054048]


portfolio before change:  [-0.5056872]
curr_Stock_Price:  99.24941297200773
curr_Factors:  [99.24941297 -1.46364178 -1.02255201]
mat_Sqrt:  [[ 8.2601456   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00835501 -0.04879126  0.45843238]
Stock Position:  -0.008355013730276993
Bond Position:  [0.32354301]


portfolio before change:  [-0.50990069]
curr_Stock_Price:  99.75856059995853
curr_Factors:  [99.7585606  -1.36903049 -1.01115117]
mat_Sqrt:  [[ 9.23103527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00828424 -0.0608505   0.30832711]
Stock Position:  -0.008284238411020791
Bond Position:  [0.31652301]


portfolio before change:  [-0.50625757]
curr_Stock_Price:  99.32357231708238
curr_Factors:  [99.32357232 -1.32824815 -1.00279143]
mat_Sqrt:  [[ 9.65372011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01961075 0.23432522 0.30371847]
Stock Position:  0.0196107503810879
Bond Position:  [-2.45406736]


portfolio before change:  [-0.51333156]
curr_Stock_Price:  98.97849583216521
curr_Factors:  [98.97849583 -1.2563715  -0.986533  ]
mat_Sqrt:  [[10.50654209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0048964  0.01200852 0.0496825 ]
Stock Position:  0.004896401350605824
Bond Position:  [-0.99797]


portfolio before change:  [-0.51304982]
curr_Stock_Price:  99.06151502895204
curr_Factors:  [99.06151503 -1.22150812 -0.93875131]
mat_Sqrt:  [[11.4213178   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02958744 0.03375987 0.43002511]
Stock Position:  0.02958744407334372
Bond Position:  [-3.44402686]


portfolio before change:  [-0.50927033]
curr_Stock_Price:  99.20380567815674
curr_Factors:  [99.20380568 -1.07768393 -0.93979218]
mat_Sqrt:  [[13.19318311  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01855399 -0.08264749  0.00964941]
Stock Position:  -0.018553991786428827
Bond Position:  [1.33135626]


portfolio before change:  [-0.51036435]
curr_Stock_Price:  99.27173959941823
curr_Factors:  [99.2717396  -0.85767656 -0.93375523]
mat_Sqrt:  [[16.55071245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00139599 -0.00582069  0.26322022]
Stock Position:  -0.0013959892937578074
Bond Position:  [-0.37178206]


portfolio before change:  [-0.51169286]
curr_Stock_Price:  100.1901079250133
curr_Factors:  [100.19010793  -0.79836184  -0.91501486]
mat_Sqrt:  [[18.0598775   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00122705 -0.0155408   0.34222921]
Stock Position:  0.001227049722044715
Bond Position:  [-0.6346311]


portfolio before change:  [-0.51208441]
curr_Stock_Price:  99.93566148032595
curr_Factors:  [99.93566148 -0.87565807 -0.90123919]
mat_Sqrt:  [[16.90533644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148872 -0.0422636  -0.14561664]
Stock Position:  -0.0014887228461520038
Bond Position:  [-0.36330791]


portfolio before change:  [-0.51273056]
curr_Stock_Price:  100.33918509254305
curr_Factors:  [100.33918509  -0.87684156  -0.90977856]
mat_Sqrt:  [[16.80936522  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00124883 -0.02126136 -0.23973531]
Stock Position:  0.0012488292822929287
Bond Position:  [-0.63803707]


portfolio before change:  [-0.5129862]
curr_Stock_Price:  100.19835221257628
curr_Factors:  [100.19835221  -0.9097654   -0.91131958]
mat_Sqrt:  [[16.2171084   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00091463 -0.00978785  0.19313867]
Stock Position:  0.000914628699090314
Bond Position:  [-0.60463048]


portfolio before change:  [-0.51238264]
curr_Stock_Price:  100.94088542155964
curr_Factors:  [100.94088542  -1.00117026  -0.90015858]
mat_Sqrt:  [[15.07753989  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00334947  0.00678751 -0.04142623]
Stock Position:  0.0033494704864790335
Bond Position:  [-0.85048115]


portfolio before change:  [-0.51229894]
curr_Stock_Price:  100.99761560039238
curr_Factors:  [100.9976156   -0.92220313  -0.89685169]
mat_Sqrt:  [[16.37968896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00357343 -0.01893248  0.09548574]
Stock Position:  -0.0035734265625538717
Bond Position:  [-0.15139138]


portfolio before change:  [-0.50943199]
curr_Stock_Price:  100.1900226642136
curr_Factors:  [100.19002266  -0.68405597  -0.87589078]
mat_Sqrt:  [[21.0546589   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00122551 -0.00486672 -0.37454563]
Stock Position:  0.0012255113909835152
Bond Position:  [-0.632216]


portfolio before change:  [-0.51121404]
curr_Stock_Price:  98.80038516770182
curr_Factors:  [98.80038517 -0.70132405 -0.87374462]
mat_Sqrt:  [[20.45102167  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078523  0.00403826 -0.13874468]
Stock Position:  -0.0007852343760564938
Bond Position:  [-0.43363258]


portfolio before change:  [-0.51035482]
curr_Stock_Price:  97.63713174257619
curr_Factors:  [97.63713174 -0.831245   -0.85073041]
mat_Sqrt:  [[18.16110924  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118785  0.14143862 -1.10990811]
Stock Position:  -0.0011878523726193834
Bond Position:  [-0.39437632]


portfolio before change:  [-0.5104347]
curr_Stock_Price:  97.66287791236091
curr_Factors:  [97.66287791 -0.69425257 -0.8560152 ]
mat_Sqrt:  [[20.72319831  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01565618 0.05383707 0.22157288]
Stock Position:  0.01565617550516426
Bond Position:  [-2.03946186]


portfolio before change:  [-0.51041365]
curr_Stock_Price:  97.68050669813456
curr_Factors:  [97.6805067  -0.74024116 -0.87962324]
mat_Sqrt:  [[19.33346664  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00050344 -0.01155988  0.20319073]
Stock Position:  0.0005034434205419554
Bond Position:  [-0.55959026]


portfolio before change:  [-0.51075356]
curr_Stock_Price:  97.14428929863013
curr_Factors:  [97.1442893  -0.51881911 -0.88185046]
mat_Sqrt:  [[23.93945208  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00033081  0.00226657 -0.32563114]
Stock Position:  0.00033081306853943347
Bond Position:  [-0.54289016]


portfolio before change:  [-0.51111362]
curr_Stock_Price:  96.26103198632073
curr_Factors:  [96.26103199 -0.57047354 -0.91176647]
mat_Sqrt:  [[21.86360925  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0036176   0.00231535 -0.00414253]
Stock Position:  -0.0036176023437001384
Bond Position:  [-0.16287948]


portfolio before change:  [-0.51274672]
curr_Stock_Price:  96.70683608098994
curr_Factors:  [96.70683608 -0.74599604 -0.89531891]
mat_Sqrt:  [[18.73454485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00389645 -0.00263203  0.64530711]
Stock Position:  -0.003896449354234926
Bond Position:  [-0.13593343]


portfolio before change:  [-0.51700151]
curr_Stock_Price:  97.79443961956781
curr_Factors:  [97.79443962 -0.70028309 -0.90255931]
mat_Sqrt:  [[19.68831514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193922 -0.0106663  -0.01033847]
Stock Position:  -0.001939215076876095
Bond Position:  [-0.32735705]


portfolio before change:  [-0.51841463]
curr_Stock_Price:  98.50204675495407
curr_Factors:  [98.50204675 -0.7659447  -0.90459842]
mat_Sqrt:  [[18.53265306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00555426  0.01864329 -0.61590646]
Stock Position:  -0.005554257974533706
Bond Position:  [0.02869115]


portfolio before change:  [-0.52347094]
curr_Stock_Price:  99.41304126250196
curr_Factors:  [99.41304126 -0.74836547 -0.9021513 ]
mat_Sqrt:  [[19.08240157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00167344 -0.01344858  0.11514539]
Stock Position:  -0.0016734353248082623
Bond Position:  [-0.35710965]


portfolio before change:  [-0.52336363]
curr_Stock_Price:  99.32223760198062
curr_Factors:  [99.3222376  -0.74225415 -0.9237457 ]
mat_Sqrt:  [[18.77206081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00292456  0.00301674  0.02975779]
Stock Position:  -0.002924562433186303
Bond Position:  [-0.23288954]


portfolio before change:  [-0.52539787]
curr_Stock_Price:  100.00785399320382
curr_Factors:  [100.00785399  -0.82100169  -0.9184132 ]
mat_Sqrt:  [[17.56369215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208784 -0.01349229 -0.0216846 ]
Stock Position:  -0.002087838255682289
Bond Position:  [-0.31659765]


portfolio before change:  [-0.52723648]
curr_Stock_Price:  100.86952586864864
curr_Factors:  [100.86952587  -0.72197186  -0.94011653]
mat_Sqrt:  [[19.13921691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00123493  0.00418276 -0.13806345]
Stock Position:  0.0012349267128232207
Bond Position:  [-0.65180295]


portfolio before change:  [-0.52867114]
curr_Stock_Price:  99.77376617415598
curr_Factors:  [99.77376617 -0.74315091 -0.9249349 ]
mat_Sqrt:  [[18.8181057   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273427  0.00671838 -0.20423322]
Stock Position:  -0.0027342679070457643
Bond Position:  [-0.25586294]


portfolio before change:  [-0.53220806]
curr_Stock_Price:  101.05562164273368
curr_Factors:  [101.05562164  -0.81425148  -0.91884941]
mat_Sqrt:  [[17.86011809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00015052 -0.02129811  0.0267619 ]
Stock Position:  0.00015052155369602865
Bond Position:  [-0.54741911]


portfolio before change:  [-0.53225468]
curr_Stock_Price:  101.20058139703315
curr_Factors:  [101.2005814   -0.7686167   -0.89695154]
mat_Sqrt:  [[19.13532802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00114104  0.01154465  0.10812645]
Stock Position:  -0.001141035540246537
Bond Position:  [-0.41678122]


portfolio before change:  [-0.53247802]
curr_Stock_Price:  101.35065874400114
curr_Factors:  [101.35065874  -0.75298891  -0.88562647]
mat_Sqrt:  [[19.68724556  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00630928 0.0080193  0.51274877]
Stock Position:  0.006309280014930487
Bond Position:  [-1.17192771]


portfolio before change:  [-0.53710132]
curr_Stock_Price:  100.64110093808473
curr_Factors:  [100.64110094  -0.87873437  -0.89979469]
mat_Sqrt:  [[16.9969118   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00204435  0.01462542 -0.11063936]
Stock Position:  -0.002044352636926654
Bond Position:  [-0.33135542]


portfolio before change:  [-0.53862848]
curr_Stock_Price:  101.36785165181597
curr_Factors:  [101.36785165  -0.74057431  -0.91039986]
mat_Sqrt:  [[19.44873088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00255097 -0.00125653  0.09315024]
Stock Position:  -0.002550967669537252
Bond Position:  [-0.28004236]


portfolio before change:  [-0.53883981]
curr_Stock_Price:  101.43697414082206
curr_Factors:  [101.43697414  -0.91692468  -0.93477732]
mat_Sqrt:  [[15.92253921  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00716133 0.00231456 0.28290115]
Stock Position:  0.007161329243134339
Bond Position:  [-1.26526338]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.53159893]
Stock Price:  102.4701692744138
PL:  [-3.0017682]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-6.51755894e-02 -8.57071514e-02  1.38378324e-02]
 [-1.18243699e-01  7.39019213e-02 -1.35296685e-01]
 [-3.68359930e-03  2.16499017e-02  4.39956032e-02]
 [-2.47775899e-01 -1.87162025e-01 -2.02250271e-01]
 [ 9.07391234e-02 -5.24698929e-02 -8.61646391e-02]
 [-7.42202881e-02 -1.53476995e-01  1.48170606e-01]
 [-6.00128908e-02 -1.86595426e-01  1.11801697e-01]
 [ 1.24574272e-02  7.21032427e-01  1.15951283e-01]
 [ 9.79665431e-02  2.77823086e-02  1.05671015e-01]
 [ 3.97702284e-01  1.61203540e-01  2.77295859e-01]
 [-2.04910223e-01 -2.50920319e-01  1.07285858e-02]
 [ 3.13220137e-02 -1.36380028e-02  1.11870050e-01]
 [ 3.05943043e-03  8.90173248e-03  2.32802205e-02]
 [ 1.16636687e-02 -1.43583299e-01  3.91649445e-04]
 [ 2.88543643e-02 -4.24797802e-02 -7.13679799e-02]
 [ 1.74917577e-01  1.73581273e-02 -6.53023331e-02]
 [ 4.37414531e-02  3.07789686e-02  1.72473321e-02]
 [-5.01275403e-02 -6.24612281e-02  3.05544629e-03]
 [ 3.15559622e-02  7.13701439e-03 -1.21203650e-01]
 [-1.22612163e-02 -8.24829968e-03 -3.21001256e-02]
 [-2.81266688e-02  4.12357914e-01 -3.61801818e-01]
 [ 2.43466393e-01  1.51938487e-01  8.27311422e-02]
 [ 3.72293218e-03 -4.12961998e-02  7.45672598e-02]
 [ 1.23797721e-01  5.19891813e-02 -2.03177453e-01]
 [-7.26023509e-02  1.72642761e-02 -2.23812130e-03]
 [-1.11562527e-01 -1.27719950e-02  2.25225629e-01]
 [-3.48496741e-02 -3.32276540e-02 -5.22258263e-03]
 [-1.10635453e-01  1.33115205e-01 -8.90351507e-02]
 [ 7.29007353e-02 -6.39780198e-03  1.18187196e-01]
 [ 2.47913057e-02  3.67397491e-02 -6.51902335e-02]
 [ 2.11519893e-02 -3.51637596e-02 -6.19512265e-02]
 [-5.82074642e-02 -6.71359017e-02 -8.57486650e-02]
 [ 1.14913176e-01  1.77039516e-02  1.19995101e-01]
 [ 3.90857601e-02 -3.38458743e-02  1.73371590e-01]
 [-7.22273341e-02 -1.95962436e-02 -2.07828188e-02]
 [ 1.87850419e-02 -6.70615400e-02  3.87256802e-02]
 [-1.55559774e-02  9.59260248e-02  8.49414065e-02]
 [ 7.26522978e-02 -7.55165950e-02 -7.23300694e-02]
 [ 9.64749571e-02  4.59726163e-03  7.45719241e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.79517718]
curr_Stock_Price:  100.17669075822812
curr_Factors:  [100.17669076  -1.16404538  -0.9859112 ]
mat_Sqrt:  [[11.66950409  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00684227 -0.02766186  0.03947548]
Stock Position:  -0.0068422661401524995
Bond Position:  [4.48061276]


portfolio before change:  [3.79340082]
curr_Stock_Price:  100.51816666703657
curr_Factors:  [100.51816667  -1.1577705   -0.96729334]
mat_Sqrt:  [[12.00441662  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01089398  0.02385174 -0.38596378]
Stock Position:  -0.010893978186162155
Bond Position:  [4.88844353]


portfolio before change:  [3.7896213]
curr_Stock_Price:  100.92119785204777
curr_Factors:  [100.92119785  -1.54173115  -0.9657832 ]
mat_Sqrt:  [[ 8.22209998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00118172 0.00698748 0.12550721]
Stock Position:  0.0011817216162291666
Bond Position:  [3.67036054]


portfolio before change:  [3.79050969]
curr_Stock_Price:  101.28470317472954
curr_Factors:  [101.28470317  -1.58841509  -0.99056577]
mat_Sqrt:  [[ 7.68257312  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04259827 -0.06040628 -0.57696373]
Stock Position:  -0.04259827343144961
Bond Position:  [8.10506317]


portfolio before change:  [3.83529753]
curr_Stock_Price:  100.25708775605966
curr_Factors:  [100.25708776  -1.34142795  -0.96327163]
mat_Sqrt:  [[10.00453193  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00624122 -0.01693459 -0.24580373]
Stock Position:  0.006241218328801179
Bond Position:  [3.20957115]


portfolio before change:  [3.83129534]
curr_Stock_Price:  99.55155183446784
curr_Factors:  [99.55155183 -1.36495037 -0.95004476]
mat_Sqrt:  [[ 9.8323748   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00765872 -0.04953449  0.4226895 ]
Stock Position:  -0.0076587245509683564
Bond Position:  [4.59373326]


portfolio before change:  [3.82959644]
curr_Stock_Price:  99.8483578187721
curr_Factors:  [99.84835782 -1.26110601 -0.97291346]
mat_Sqrt:  [[10.69346868  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00703982 -0.06022341  0.31893912]
Stock Position:  -0.007039820202033629
Bond Position:  [4.53251093]


portfolio before change:  [3.82471746]
curr_Stock_Price:  100.62189735900704
curr_Factors:  [100.62189736  -1.45384927  -0.94891048]
mat_Sqrt:  [[ 9.10305573  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02013676 0.23271222 0.33077674]
Stock Position:  0.02013675594543788
Bond Position:  [1.79851887]


portfolio before change:  [3.82565339]
curr_Stock_Price:  100.65721102585792
curr_Factors:  [100.65721103  -1.48088186  -0.94683646]
mat_Sqrt:  [[ 8.88178432  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01409712 0.0089667  0.30144999]
Stock Position:  0.01409712104588128
Bond Position:  [2.4066765]


portfolio before change:  [3.8304882]
curr_Stock_Price:  100.97883380975007
curr_Factors:  [100.97883381  -1.53066784  -0.94029158]
mat_Sqrt:  [[ 8.53308962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05709662 0.05202822 0.7910479 ]
Stock Position:  0.05709662270289808
Bond Position:  [-1.93506217]


portfolio before change:  [3.81045814]
curr_Stock_Price:  100.63226056312068
curr_Factors:  [100.63226056  -1.36017215  -0.93354383]
mat_Sqrt:  [[10.15287493  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02501155 -0.08098418  0.03060567]
Stock Position:  -0.025011551569305342
Bond Position:  [6.32742712]


portfolio before change:  [3.82572747]
curr_Stock_Price:  100.05339384084374
curr_Factors:  [100.05339384  -1.30110151  -0.94068668]
mat_Sqrt:  [[10.63250471  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00483174 -0.00440165  0.31913411]
Stock Position:  0.004831744519601613
Bond Position:  [3.34229504]


portfolio before change:  [3.82541214]
curr_Stock_Price:  99.901658627861
curr_Factors:  [99.90165863 -1.42137508 -0.91945957]
mat_Sqrt:  [[ 9.61526208  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00100138 0.00287302 0.06641199]
Stock Position:  0.0010013813432821837
Bond Position:  [3.72537248]


portfolio before change:  [3.82614777]
curr_Stock_Price:  100.1712159294775
curr_Factors:  [100.17121593  -1.49797463  -0.96439754]
mat_Sqrt:  [[ 8.53784562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00205733 -0.04634131  0.00111727]
Stock Position:  -0.0020573345086766118
Bond Position:  [4.03223347]


portfolio before change:  [3.82713071]
curr_Stock_Price:  99.93844762170778
curr_Factors:  [99.93844762 -1.45166551 -0.96472232]
mat_Sqrt:  [[ 8.9188467   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0006296  -0.01371029 -0.20359298]
Stock Position:  0.0006295979448668252
Bond Position:  [3.76420967]


portfolio before change:  [3.82729674]
curr_Stock_Price:  99.45476178537795
curr_Factors:  [99.45476179 -1.39713708 -0.97171944]
mat_Sqrt:  [[ 9.30774055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01774126  0.00560231 -0.18628938]
Stock Position:  0.017741255925122077
Bond Position:  [2.06284436]


portfolio before change:  [3.83172529]
curr_Stock_Price:  99.68984520412417
curr_Factors:  [99.6898452  -1.436837   -0.97255762]
mat_Sqrt:  [[ 8.95909483  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00597658 0.00993387 0.04920184]
Stock Position:  0.0059765837615761075
Bond Position:  [3.23592058]


portfolio before change:  [3.82913149]
curr_Stock_Price:  99.1881689208417
curr_Factors:  [99.18816892 -1.17656986 -0.97929276]
mat_Sqrt:  [[11.4863127   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00541982 -0.02015927  0.00871634]
Stock Position:  -0.0054198154278372115
Bond Position:  [4.36671306]


portfolio before change:  [3.83355727]
curr_Stock_Price:  98.47229458356608
curr_Factors:  [98.47229458 -1.2974678  -0.95233527]
mat_Sqrt:  [[10.38094757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079686  0.00230346 -0.34576028]
Stock Position:  0.0007968644126673963
Bond Position:  [3.75508821]


portfolio before change:  [3.8336755]
curr_Stock_Price:  98.03157644668721
curr_Factors:  [98.03157645 -1.02569713 -0.96435949]
mat_Sqrt:  [[13.39970926  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152968 -0.00266213 -0.09157272]
Stock Position:  -0.0015296827521330473
Bond Position:  [3.98363271]


portfolio before change:  [3.83448436]
curr_Stock_Price:  97.8283467509359
curr_Factors:  [97.82834675 -0.9918977  -0.95934515]
mat_Sqrt:  [[13.90114946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00128097  0.13308794 -1.03211988]
Stock Position:  -0.001280969536762067
Bond Position:  [3.95979949]


portfolio before change:  [3.8346477]
curr_Stock_Price:  98.08726483438087
curr_Factors:  [98.08726483 -0.8431459  -0.94767428]
mat_Sqrt:  [[16.36324003  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01780626 0.04903794 0.23600892]
Stock Position:  0.01780626149538426
Bond Position:  [2.08808021]


portfolio before change:  [3.81620626]
curr_Stock_Price:  97.03693424138832
curr_Factors:  [97.03693424 -1.15617643 -0.92022541]
mat_Sqrt:  [[12.16654322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0008642  -0.01332829  0.21271964]
Stock Position:  0.0008642026471953974
Bond Position:  [3.73234669]


portfolio before change:  [3.81575]
curr_Stock_Price:  95.96908502780384
curr_Factors:  [95.96908503 -0.91150996 -0.8938116 ]
mat_Sqrt:  [[15.77938833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00588974  0.01677944 -0.57960872]
Stock Position:  0.00588974315737686
Bond Position:  [3.25051674]


portfolio before change:  [3.81826837]
curr_Stock_Price:  96.32768051932577
curr_Factors:  [96.32768052 -0.95861769 -0.91281579]
mat_Sqrt:  [[14.82510824  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00469036  0.00557202 -0.00638474]
Stock Position:  -0.004690363723907409
Bond Position:  [4.27008023]


portfolio before change:  [3.81439255]
curr_Stock_Price:  97.26782462595529
curr_Factors:  [97.26782463 -0.856582   -0.90533249]
mat_Sqrt:  [[16.70242239  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00408298 -0.00412214  0.64250603]
Stock Position:  -0.004082977219318444
Bond Position:  [4.21153486]


portfolio before change:  [3.81494047]
curr_Stock_Price:  97.26257231503558
curr_Factors:  [97.26257232 -1.03802997 -0.93790633]
mat_Sqrt:  [[13.48365148  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00316667 -0.01072418 -0.01489857]
Stock Position:  -0.003166671567769294
Bond Position:  [4.12293909]


portfolio before change:  [3.81973635]
curr_Stock_Price:  95.91084439103669
curr_Factors:  [95.91084439 -1.21925302 -0.93888132]
mat_Sqrt:  [[11.08158491  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00917176  0.04296275 -0.2539925 ]
Stock Position:  -0.009171761116797508
Bond Position:  [4.6994077]


portfolio before change:  [3.82585572]
curr_Stock_Price:  95.30769804285664
curr_Factors:  [95.30769804 -1.21521855 -0.9127282 ]
mat_Sqrt:  [[11.34938809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0084339  -0.00206488  0.33715517]
Stock Position:  0.008433904021495886
Bond Position:  [3.02203975]


portfolio before change:  [3.83554166]
curr_Stock_Price:  96.41135704270762
curr_Factors:  [96.41135704 -1.58001994 -0.93956031]
mat_Sqrt:  [[ 7.76047667  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00244623  0.0118577  -0.18596959]
Stock Position:  0.0024462253703217466
Bond Position:  [3.59969775]


portfolio before change:  [3.83843043]
curr_Stock_Price:  97.40831293706674
curr_Factors:  [97.40831294 -1.92122564 -0.97981407]
mat_Sqrt:  [[ 5.35414937  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00024812 -0.01134905 -0.17672961]
Stock Position:  0.0002481207839752754
Bond Position:  [3.8142614]


portfolio before change:  [3.83891501]
curr_Stock_Price:  97.43961857309685
curr_Factors:  [97.43961857 -2.07459233 -0.96299358]
mat_Sqrt:  [[ 4.67227907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01913732 -0.02166802 -0.24461707]
Stock Position:  -0.019137319140798643
Bond Position:  [5.70364808]


portfolio before change:  [3.83571343]
curr_Stock_Price:  97.64417035395753
curr_Factors:  [97.64417035 -2.12765543 -0.97419915]
mat_Sqrt:  [[ 4.39064163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03257403 0.00571393 0.34231262]
Stock Position:  0.0325740265795653
Bond Position:  [0.65504963]


portfolio before change:  [3.8436462]
curr_Stock_Price:  97.88518682666904
curr_Factors:  [97.88518683 -1.9816833  -1.0020045 ]
mat_Sqrt:  [[ 4.95356455  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01363994 -0.01092371  0.49458089]
Stock Position:  0.01363994086520885
Bond Position:  [2.50849804]


portfolio before change:  [3.84112313]
curr_Stock_Price:  97.67722051810188
curr_Factors:  [97.67722052 -1.67611202 -1.01032066]
mat_Sqrt:  [[ 6.65411652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01209322 -0.00632466 -0.0592876 ]
Stock Position:  -0.012093217103024958
Bond Position:  [5.02235496]


portfolio before change:  [3.83654978]
curr_Stock_Price:  98.1073111349968
curr_Factors:  [98.10731113 -1.74011014 -1.02420439]
mat_Sqrt:  [[ 6.18265235  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210282 -0.02164402  0.11047359]
Stock Position:  0.0021028205944988777
Bond Position:  [3.63024771]


portfolio before change:  [3.83736752]
curr_Stock_Price:  98.2803754564468
curr_Factors:  [98.28037546 -1.69182825 -1.03850407]
mat_Sqrt:  [[ 6.40764653  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00333405 0.03095999 0.24231419]
Stock Position:  0.003334052894183572
Bond Position:  [3.50969555]


portfolio before change:  [3.8387389]
curr_Stock_Price:  98.5601068551872
curr_Factors:  [98.56010686 -1.51456918 -1.03205353]
mat_Sqrt:  [[ 7.72177205  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00550045 -0.02437288 -0.20633756]
Stock Position:  0.005500450361347718
Bond Position:  [3.29661392]


portfolio before change:  [3.83707355]
curr_Stock_Price:  98.18241978540229
curr_Factors:  [98.18241979 -1.43808732 -1.03829664]
mat_Sqrt:  [[ 8.25189789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01364962 0.00148376 0.21273294]
Stock Position:  0.013649623510134993
Bond Position:  [2.49692048]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.83793688]
Stock Price:  98.22280182753721
PL:  [3.83793688]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-3.34880433e-01 -1.19780475e-01  2.44132433e-02]
 [-6.36500242e-02  7.32563838e-02 -5.46939345e-02]
 [ 1.38184795e-02 -6.40035881e-03  5.58042864e-02]
 [-2.18477543e-01 -1.03077455e-01 -1.06400946e-01]
 [ 1.03632384e-01 -6.86483061e-02 -8.76469093e-02]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.24468768e-02 -1.64695289e-01 -2.73119919e-02]
 [ 5.96933444e-03  8.01824628e-01  1.31591107e-01]
 [ 7.51267716e-02  4.27183146e-02  9.40591669e-02]
 [ 4.44839244e-01  1.89183183e-01  3.43953859e-01]
 [-1.70556578e-01 -2.03527776e-01  2.97367493e-02]
 [ 4.45271464e-02 -1.21442462e-02  1.19227020e-01]
 [ 1.45422403e-02 -4.68492492e-02  4.63072432e-02]
 [ 3.49389210e-03  2.79323654e-02  1.68257000e-02]
 [ 1.48811058e-01 -1.69311642e-01 -1.17972276e-01]
 [-1.89065979e-01 -8.58267635e-02  1.12996114e-01]
 [ 5.10239314e-02  1.77087252e-02 -2.53461761e-02]
 [-5.25698452e-02 -5.81749597e-02  3.46396575e-02]
 [ 5.23729430e-02 -1.53509867e-02 -1.82702992e-01]
 [ 7.21178485e-03  4.58400411e-03  1.75645433e-02]
 [-4.46123728e-02  5.67639056e-01 -5.54538934e-01]
 [ 3.37686157e-01  1.97022327e-01  6.73881176e-02]
 [-3.76429320e-04 -2.28499168e-02  6.33218839e-02]
 [-1.98209854e-02 -4.50413570e-02 -6.96337504e-02]
 [ 3.29463649e-02  1.82282216e-02 -1.21794309e-02]
 [-7.46594552e-02 -1.26314859e-02  1.95989872e-01]
 [-2.20230540e-02 -3.26741343e-02 -2.88545351e-04]
 [-9.05706740e-02  9.18783775e-02 -1.61720967e-01]
 [ 4.86129262e-02 -3.91140152e-02  1.07965476e-01]
 [ 4.62179008e-02  5.26980506e-02 -9.27956471e-02]
 [ 3.82665011e-02 -2.03834648e-02 -6.36352496e-02]
 [-2.30943172e-02  2.32734018e-02 -9.12563022e-02]
 [ 3.58018434e-02  2.20595145e-02  6.95180945e-02]
 [ 3.26336367e-02 -4.21663926e-02  1.31080095e-01]
 [-6.83181272e-02  1.35340438e-02 -2.33725982e-02]
 [-3.05172633e-02 -9.01924166e-02 -1.10075989e-02]
 [ 3.54090837e-02  1.03697880e-01  1.54665578e-01]
 [ 8.50067912e-02 -8.95669149e-02 -9.89943183e-02]
 [ 9.75898602e-02  3.90655104e-03  6.79719196e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.04027423]
curr_Stock_Price:  100.96402541294805
curr_Factors:  [100.96402541  -0.86812876  -1.00464802]
mat_Sqrt:  [[15.517796    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02283489 -0.03865898  0.06964419]
Stock Position:  -0.02283489147689445
Bond Position:  [12.34577679]


portfolio before change:  [10.04229526]
curr_Stock_Price:  100.94310494156674
curr_Factors:  [100.94310494  -0.8898196   -0.97249583]
mat_Sqrt:  [[15.6777359   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00381822  0.0236434  -0.15602657]
Stock Position:  -0.003818215874905482
Bond Position:  [10.42771783]


portfolio before change:  [10.0419935]
curr_Stock_Price:  101.36353837819526
curr_Factors:  [101.36353838  -1.03153134  -0.9963293 ]
mat_Sqrt:  [[13.34114411  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00179168 -0.00206571  0.1591941 ]
Stock Position:  0.001791676469221424
Bond Position:  [9.86038284]


portfolio before change:  [10.04337968]
curr_Stock_Price:  101.4492421581691
curr_Factors:  [101.44924216  -1.05723941  -1.01395331]
mat_Sqrt:  [[12.78619245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02043119 -0.03326811 -0.30353228]
Stock Position:  -0.02043119119735778
Bond Position:  [12.11610854]


portfolio before change:  [10.06103478]
curr_Stock_Price:  100.65924962400568
curr_Factors:  [100.65924962  -0.96415924  -1.0005744 ]
mat_Sqrt:  [[14.1117446   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00508291 -0.02215615 -0.25003224]
Stock Position:  0.005082912044171603
Bond Position:  [9.54939266]


portfolio before change:  [10.06515043]
curr_Stock_Price:  101.23409878869383
curr_Factors:  [101.23409879  -0.98212666  -0.98369956]
mat_Sqrt:  [[14.17683692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01081371 -0.05534923  0.15513819]
Stock Position:  -0.010813709503585152
Bond Position:  [11.15986657]


portfolio before change:  [10.06409849]
curr_Stock_Price:  101.46038710106691
curr_Factors:  [101.4603871   -1.23057271  -0.95516124]
mat_Sqrt:  [[11.40366155  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00803603 -0.05315518 -0.07791351]
Stock Position:  -0.008036032862436274
Bond Position:  [10.87943749]


portfolio before change:  [10.06349289]
curr_Stock_Price:  101.70498745308683
curr_Factors:  [101.70498745  -1.6369465   -0.96100396]
mat_Sqrt:  [[ 7.56949141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02595974 0.25878779 0.3753928 ]
Stock Position:  0.025959739293532055
Bond Position:  [7.42325793]


portfolio before change:  [10.05919555]
curr_Stock_Price:  101.50370272230656
curr_Factors:  [101.50370272  -1.82679717  -0.97501782]
mat_Sqrt:  [[ 6.16125377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0167249  0.01378728 0.26832462]
Stock Position:  0.01672490079967449
Bond Position:  [8.36155619]


portfolio before change:  [10.06282274]
curr_Stock_Price:  101.65807906114306
curr_Factors:  [101.65807906  -1.58598777  -0.96251042]
mat_Sqrt:  [[ 7.94956195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.06964728 0.06105861 0.98120462]
Stock Position:  0.06964728255094609
Bond Position:  [2.98261378]


portfolio before change:  [10.06090769]
curr_Stock_Price:  101.62522925799465
curr_Factors:  [101.62522926  -1.48460158  -0.98926488]
mat_Sqrt:  [[ 8.56278392  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02406128 -0.06568831  0.08483067]
Stock Position:  -0.024061277829153252
Bond Position:  [12.50614057]


portfolio before change:  [10.07064044]
curr_Stock_Price:  101.285705141365
curr_Factors:  [101.28570514  -1.45322528  -1.00076661]
mat_Sqrt:  [[ 8.7054859   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00762569 -0.00391954  0.3401215 ]
Stock Position:  0.00762568877571632
Bond Position:  [9.29826718]


portfolio before change:  [10.07360027]
curr_Stock_Price:  101.52141836086594
curr_Factors:  [101.52141836  -1.42267668  -0.98894059]
mat_Sqrt:  [[ 9.10344145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00158529 -0.01512053  0.13210168]
Stock Position:  0.0015852909984099834
Bond Position:  [9.91265928]


portfolio before change:  [10.07485339]
curr_Stock_Price:  101.53022093534213
curr_Factors:  [101.53022094  -1.40510538  -0.97146242]
mat_Sqrt:  [[ 9.42898733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0013395  0.00901513 0.04799904]
Stock Position:  0.0013394963311553656
Bond Position:  [9.93885403]


portfolio before change:  [10.07627611]
curr_Stock_Price:  101.66481335206319
curr_Factors:  [101.66481335  -1.3799417   -0.96299782]
mat_Sqrt:  [[ 9.76438653  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00923453 -0.0546451  -0.33654207]
Stock Position:  0.009234525290689627
Bond Position:  [9.13744982]


portfolio before change:  [10.08358151]
curr_Stock_Price:  102.33221592082086
curr_Factors:  [102.33221592  -1.09590699  -0.99644201]
mat_Sqrt:  [[12.62748198  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01453339 -0.02770047  0.32234646]
Stock Position:  -0.014533385085118996
Bond Position:  [11.57081501]


portfolio before change:  [10.09690965]
curr_Stock_Price:  101.51467059419029
curr_Factors:  [101.51467059  -0.81310277  -1.00444845]
mat_Sqrt:  [[16.48831763  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.003       0.00571547 -0.07230559]
Stock Position:  0.0029999994145479816
Bond Position:  [9.7923657]


portfolio before change:  [10.09827847]
curr_Stock_Price:  101.56290476322818
curr_Factors:  [101.56290476  -0.67618741  -1.05352073]
mat_Sqrt:  [[18.01077551  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00318554 -0.01877589  0.0988173 ]
Stock Position:  -0.00318553571325017
Bond Position:  [10.42181073]


portfolio before change:  [10.10111225]
curr_Stock_Price:  101.0823052099807
curr_Factors:  [101.08230521  -0.4887499   -1.03823111]
mat_Sqrt:  [[21.9541036   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00054411 -0.00495451 -0.52120078]
Stock Position:  0.0005441052897611905
Bond Position:  [10.04611283]


portfolio before change:  [10.10250757]
curr_Stock_Price:  101.33864674555468
curr_Factors:  [101.33864675  -0.29914864  -1.01256051]
mat_Sqrt:  [[27.29650544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00042983 0.00147948 0.05010675]
Stock Position:  0.0004298293125913142
Bond Position:  [10.05894925]


portfolio before change:  [10.10382902]
curr_Stock_Price:  101.48755522093222
curr_Factors:  [101.48755522  -0.48897693  -1.01524745]
mat_Sqrt:  [[22.5494754   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185984  0.18320472 -1.58194522]
Stock Position:  -0.0018598358002162986
Bond Position:  [10.29257921]


portfolio before change:  [10.10834678]
curr_Stock_Price:  99.75024847966928
curr_Factors:  [99.75024848 -0.69469375 -1.01488075]
mat_Sqrt:  [[18.04908605  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02169964 0.06358868 0.19223954]
Stock Position:  0.021699642411782568
Bond Position:  [7.94380206]


portfolio before change:  [10.08968654]
curr_Stock_Price:  98.8445524149914
curr_Factors:  [98.84455241 -0.78875757 -1.02449929]
mat_Sqrt:  [[16.1237215   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00048902 -0.00737478  0.18063971]
Stock Position:  0.0004890233535938403
Bond Position:  [10.04134924]


portfolio before change:  [10.09096677]
curr_Stock_Price:  98.89565484840152
curr_Factors:  [98.89565485 -0.55514246 -1.01735916]
mat_Sqrt:  [[20.52335864  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00210633 -0.01453704 -0.19864571]
Stock Position:  -0.0021063289143090622
Bond Position:  [10.29927355]


portfolio before change:  [10.09006729]
curr_Stock_Price:  99.93394288659705
curr_Factors:  [99.93394289 -0.69518163 -1.01583615]
mat_Sqrt:  [[18.05624518  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00189303  0.00588313 -0.03474453]
Stock Position:  0.0018930330610162326
Bond Position:  [9.90088903]


portfolio before change:  [10.09092702]
curr_Stock_Price:  99.73428817820647
curr_Factors:  [99.73428818 -0.63379675 -1.0177996 ]
mat_Sqrt:  [[19.123409    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00194691 -0.00407679  0.55910455]
Stock Position:  -0.0019469113172889984
Bond Position:  [10.28510084]


portfolio before change:  [10.09428328]
curr_Stock_Price:  98.67078956126176
curr_Factors:  [98.67078956 -0.61247933 -1.03377701]
mat_Sqrt:  [[19.02079025  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00151158 -0.01054553 -0.00082314]
Stock Position:  -0.0015115845583194574
Bond Position:  [10.24343252]


portfolio before change:  [10.09742058]
curr_Stock_Price:  97.44241119861402
curr_Factors:  [97.4424112  -0.61127068 -1.0063887 ]
mat_Sqrt:  [[19.32891509  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00542334  0.02965362 -0.4613449 ]
Stock Position:  -0.00542333764988299
Bond Position:  [10.62588368]


portfolio before change:  [10.10302001]
curr_Stock_Price:  96.65486816115315
curr_Factors:  [96.65486816 -0.7975725  -1.04105061]
mat_Sqrt:  [[15.37162784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00407681 -0.01262399  0.30799545]
Stock Position:  0.0040768077766437484
Bond Position:  [9.7089767]


portfolio before change:  [10.09818075]
curr_Stock_Price:  95.17013803888626
curr_Factors:  [95.17013804 -0.77819782 -1.0419805 ]
mat_Sqrt:  [[15.41726353  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00246691  0.01700822 -0.26472015]
Stock Position:  0.0024669107505839853
Bond Position:  [9.86340452]


portfolio before change:  [10.10019872]
curr_Stock_Price:  95.48833381070921
curr_Factors:  [95.48833381 -0.9594598  -1.03474585]
mat_Sqrt:  [[12.99803811  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00162457 -0.00657873 -0.18153365]
Stock Position:  0.0016245723165710315
Bond Position:  [9.94507101]


portfolio before change:  [10.10496296]
curr_Stock_Price:  97.65569360408885
curr_Factors:  [97.6556936  -1.36518713 -1.01832825]
mat_Sqrt:  [[ 9.00637428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00410501  0.00751146 -0.26032883]
Stock Position:  -0.0041050113445154765
Bond Position:  [10.50584069]


portfolio before change:  [10.10590725]
curr_Stock_Price:  97.74558971795466
curr_Factors:  [97.74558972 -1.33988967 -1.02669115]
mat_Sqrt:  [[ 9.16862434  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00594364 0.00711968 0.19831577]
Stock Position:  0.005943644599423134
Bond Position:  [9.5249422]


portfolio before change:  [10.11086481]
curr_Stock_Price:  98.37935331799551
curr_Factors:  [98.37935332 -1.09949195 -1.02647539]
mat_Sqrt:  [[11.73837777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00432624 -0.01360914  0.37393502]
Stock Position:  0.004326242618269973
Bond Position:  [9.68525185]


portfolio before change:  [10.10702919]
curr_Stock_Price:  97.2129029090407
curr_Factors:  [97.21290291 -0.85095652 -1.03672499]
mat_Sqrt:  [[14.72021833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00477754  0.00436809 -0.06667552]
Stock Position:  -0.004777538761860287
Bond Position:  [10.5714676]


portfolio before change:  [10.1072512]
curr_Stock_Price:  97.44304289638387
curr_Factors:  [97.4430429  -0.8338379  -1.05873427]
mat_Sqrt:  [[14.6830808   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00348528 -0.02910948 -0.03140162]
Stock Position:  -0.0034852787823238707
Bond Position:  [10.44686737]


portfolio before change:  [10.1123395]
curr_Stock_Price:  96.35780616044507
curr_Factors:  [96.35780616 -0.50643174 -1.06236037]
mat_Sqrt:  [[20.07100623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00439177 0.03346835 0.44121784]
Stock Position:  0.004391773018904676
Bond Position:  [9.68915788]


portfolio before change:  [10.1177913]
curr_Stock_Price:  97.32337947020764
curr_Factors:  [97.32337947 -0.20299448 -1.08034957]
mat_Sqrt:  [[26.96919221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00172482 -0.0289076  -0.28240324]
Stock Position:  0.001724815865746542
Bond Position:  [9.94992639]


portfolio before change:  [10.12059839]
curr_Stock_Price:  98.22972586987473
curr_Factors:  [ 9.82297259e+01 -9.28566150e-02 -1.08379501e+00]
mat_Sqrt:  [[30.28514263  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00370683 0.00126083 0.19390497]
Stock Position:  0.0037068338399007935
Bond Position:  [9.75647712]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.1365603]
Stock Price:  102.20677676563741
PL:  [7.92978353]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 8.15824879e-02 -6.70880102e-02  8.10815245e-03]
 [-1.63299844e-01  1.02398868e-01 -3.04568433e-01]
 [-4.36979865e-02  5.08624893e-02  1.65914973e-02]
 [ 1.11641083e-01  4.26083511e-02  1.28023408e-01]
 [-6.65212872e-02  1.75180925e-01 -4.52176026e-02]
 [-6.36774988e-02 -1.46255317e-01  1.87418339e-01]
 [-6.30876382e-02 -1.57101889e-01  4.64440045e-02]
 [ 1.32772993e-02  7.18518614e-01  9.72209528e-02]
 [ 2.69151680e-01 -1.36218356e-02  2.59677992e-01]
 [ 5.47324863e-01  2.23558724e-01  4.03495618e-01]
 [-1.67481995e-01 -1.83532231e-01  4.21447989e-02]
 [-6.26186185e-02 -1.88775905e-02  8.92499623e-02]
 [ 1.02865308e-02 -5.81284499e-02  1.09133805e-01]
 [ 1.66108355e-03  1.80604716e-01 -2.33829630e-01]
 [ 1.00577945e-01 -1.89178865e-02 -1.01706996e-01]
 [-8.70819705e-02 -5.69881239e-02  8.94613734e-02]
 [ 5.17949094e-02  1.63250108e-02 -2.98554457e-02]
 [-6.51811290e-02 -6.56347921e-02  1.66833835e-02]
 [ 6.09137145e-02 -3.46123974e-02 -1.99671169e-01]
 [-4.40213701e-02  2.53296922e-02 -5.80545584e-02]
 [-4.59650333e-02  5.55721316e-01 -5.22465043e-01]
 [ 4.84284141e-01  2.67168967e-01  4.35156691e-02]
 [ 7.38576874e-03 -5.65500549e-02  8.38751163e-02]
 [ 9.92701619e-02  1.53527532e-01 -1.25223996e-01]
 [-8.26115498e-02  7.51901536e-03 -1.22053406e-03]
 [-1.61646266e-01 -3.18029224e-02  1.65835422e-01]
 [-7.56913996e-02 -3.49901370e-02 -2.09332371e-02]
 [-1.04871355e-01  1.39731897e-01 -5.16872672e-02]
 [ 7.86111195e-02 -3.87732768e-02  1.32565413e-01]
 [ 7.74819872e-02  6.42720692e-02 -1.22273724e-01]
 [ 1.13051866e-02 -1.58680731e-02 -2.16935532e-02]
 [-2.30560235e-02  6.59089286e-02 -1.18485800e-01]
 [-3.03181897e-02  4.31684393e-02 -9.31242943e-02]
 [ 4.31645226e-02 -3.06192054e-02  1.78285430e-01]
 [-7.39116781e-02 -8.74563041e-03 -2.87647288e-02]
 [-1.51492261e-01 -1.68707147e-01 -1.38048788e-01]
 [ 9.22568695e-02  1.02472895e-01  2.21684562e-01]
 [ 1.78297944e-01 -1.24160145e-01 -1.81469442e-01]
 [ 9.74547766e-02  3.99023874e-03  6.87715876e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.377489]
curr_Stock_Price:  99.74581445319983
curr_Factors:  [99.74581445 -1.26932294 -0.98680425]
mat_Sqrt:  [[10.44891254  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00665555 -0.02165256  0.0231303 ]
Stock Position:  0.006655551434444529
Bond Position:  [-0.2863744]


portfolio before change:  [0.38158857]
curr_Stock_Price:  100.36715552791765
curr_Factors:  [100.36715553  -1.2475735   -0.9718175 ]
mat_Sqrt:  [[10.90742792  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01875488  0.03304909 -0.86884896]
Stock Position:  -0.018754882924902783
Bond Position:  [2.26396282]


portfolio before change:  [0.39260697]
curr_Stock_Price:  99.79475073335813
curr_Factors:  [99.79475073 -1.24486573 -0.9577817 ]
mat_Sqrt:  [[11.02833817  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00271383  0.0164158   0.04733092]
Stock Position:  -0.0027138267547450927
Bond Position:  [0.66343263]


portfolio before change:  [0.39304637]
curr_Stock_Price:  99.66339725767183
curr_Factors:  [99.66339726 -1.26347573 -0.9463312 ]
mat_Sqrt:  [[10.93525044  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0133944  0.01375179 0.36521515]
Stock Position:  0.013394402393528543
Bond Position:  [-0.94188528]


portfolio before change:  [0.38182871]
curr_Stock_Price:  98.83469931729155
curr_Factors:  [98.83469932 -1.14892058 -0.96545098]
mat_Sqrt:  [[11.93024995  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0033522   0.0565394  -0.12899323]
Stock Position:  -0.0033522042901180087
Bond Position:  [0.71314282]


portfolio before change:  [0.38252984]
curr_Stock_Price:  98.65213975895806
curr_Factors:  [98.65213976 -0.99399512 -0.98252064]
mat_Sqrt:  [[13.66836673  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00404402 -0.0472037   0.53465235]
Stock Position:  -0.004044018801572971
Bond Position:  [0.78148095]


portfolio before change:  [0.38185687]
curr_Stock_Price:  98.84270854091925
curr_Factors:  [98.84270854 -0.90781467 -1.03663848]
mat_Sqrt:  [[14.14097535  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00605868 -0.05070442  0.13249182]
Stock Position:  -0.0060586757387298094
Bond Position:  [0.98071279]


portfolio before change:  [0.37283989]
curr_Stock_Price:  100.35121949478828
curr_Factors:  [100.35121949  -0.9079934   -1.04311809]
mat_Sqrt:  [[14.2615162   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01260661 0.23190089 0.27734432]
Stock Position:  0.01260661478622067
Bond Position:  [-0.89224928]


portfolio before change:  [0.36342847]
curr_Stock_Price:  99.61352151195499
curr_Factors:  [99.61352151 -0.67552069 -1.04465203]
mat_Sqrt:  [[17.83432898  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01790803 -0.00439643  0.74078903]
Stock Position:  0.017908029119756988
Bond Position:  [-1.42045337]


portfolio before change:  [0.3924877]
curr_Stock_Price:  101.24612985848282
curr_Factors:  [101.24612986  -0.60422284  -1.04443402]
mat_Sqrt:  [[19.47044396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03468446 0.07215327 1.15106069]
Stock Position:  0.03468445794033612
Bond Position:  [-3.11917943]


portfolio before change:  [0.40806697]
curr_Stock_Price:  101.70654321489775
curr_Factors:  [101.70654321  -0.85519738  -1.02802232]
mat_Sqrt:  [[15.46952469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01269222 -0.05923477  0.12022738]
Stock Position:  -0.012692218292123282
Bond Position:  [1.69894862]


portfolio before change:  [0.40733761]
curr_Stock_Price:  101.78074169000293
curr_Factors:  [101.78074169  -0.67980553  -1.02269066]
mat_Sqrt:  [[18.54730915  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260167 -0.00609272  0.2546053 ]
Stock Position:  -0.0026016667908502376
Bond Position:  [0.67213718]


portfolio before change:  [0.40651684]
curr_Stock_Price:  102.12851658306042
curr_Factors:  [102.12851658  -0.60244858  -0.98753087]
mat_Sqrt:  [[20.82704817  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0009938  -0.01876088  0.31132837]
Stock Position:  0.0009938016722958773
Bond Position:  [0.30502135]


portfolio before change:  [0.40758455]
curr_Stock_Price:  103.164521145538
curr_Factors:  [103.16452115  -0.28748599  -1.01360071]
mat_Sqrt:  [[28.08507527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.27697413e-04  5.82899215e-02 -6.67050849e-01]
Stock Position:  -0.0003276974132559743
Bond Position:  [0.4413913]


portfolio before change:  [0.40855382]
curr_Stock_Price:  100.37506496136925
curr_Factors:  [100.37506496  -0.2549823   -1.01751221]
mat_Sqrt:  [[28.11826339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00270129 -0.00610572 -0.29014175]
Stock Position:  0.0027012868127256552
Bond Position:  [0.13741198]


portfolio before change:  [0.4075043]
curr_Stock_Price:  99.98017837743558
curr_Factors:  [99.98017838 -0.14007882 -0.97475295]
mat_Sqrt:  [[32.7905439   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00245355 -0.01839284  0.2552084 ]
Stock Position:  -0.0024535547936979482
Bond Position:  [0.65281115]


portfolio before change:  [0.40339174]
curr_Stock_Price:  101.68960386277399
curr_Factors:  [101.68960386  -0.31475088  -0.98474468]
mat_Sqrt:  [[27.72763354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00176838  0.00526887 -0.08516928]
Stock Position:  0.001768381022100064
Bond Position:  [0.22356577]


portfolio before change:  [0.40183697]
curr_Stock_Price:  100.79459540181416
curr_Factors:  [100.7945954   -0.17457271  -0.99033427]
mat_Sqrt:  [[31.44304316  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00239078 -0.02118354  0.04759305]
Stock Position:  -0.0023907766506268864
Bond Position:  [0.64281433]


portfolio before change:  [0.4000072]
curr_Stock_Price:  101.59355114989854
curr_Factors:  [ 1.01593551e+02 -5.63725211e-02 -9.97125713e-01]
mat_Sqrt:  [[35.4272687   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.69511461e-04 -1.11711032e-02 -5.69606267e-01]
Stock Position:  0.0003695114608199835
Bond Position:  [0.36246722]


portfolio before change:  [0.39888622]
curr_Stock_Price:  98.43725220176124
curr_Factors:  [98.4372522  -0.31137115 -0.97821322]
mat_Sqrt:  [[27.10816426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00187033  0.00817512 -0.1656135 ]
Stock Position:  -0.0018703334157931532
Bond Position:  [0.58299671]


portfolio before change:  [0.39895755]
curr_Stock_Price:  98.43808369964248
curr_Factors:  [98.4380837  -0.28900172 -0.98578143]
mat_Sqrt:  [[27.51261446  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.42395136e-03  1.79358284e-01 -1.49044734e+00]
Stock Position:  -0.0014239513632303723
Bond Position:  [0.53912859]


portfolio before change:  [0.39825681]
curr_Stock_Price:  98.97752070622361
curr_Factors:  [98.97752071 -0.27463563 -0.98818247]
mat_Sqrt:  [[27.99636471  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01956334 0.08622841 0.12413809]
Stock Position:  0.0195633391184259
Bond Position:  [-1.53807399]


portfolio before change:  [0.33371542]
curr_Stock_Price:  95.68824992440331
curr_Factors:  [95.68824992 -0.38157858 -0.96430369]
mat_Sqrt:  [[24.90860297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00052044 -0.01825145  0.23927236]
Stock Position:  0.0005204416150557402
Bond Position:  [0.28391527]


portfolio before change:  [0.33351676]
curr_Stock_Price:  95.23833553195009
curr_Factors:  [95.23833553 -0.57120455 -0.93525745]
mat_Sqrt:  [[21.11366689  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00497534  0.0495508  -0.35722921]
Stock Position:  0.004975336471804269
Bond Position:  [-0.14032601]


portfolio before change:  [0.33829628]
curr_Stock_Price:  96.2025046607429
curr_Factors:  [96.20250466 -0.57700119 -0.90612105]
mat_Sqrt:  [[21.83104733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00372524  0.00242675 -0.00348184]
Stock Position:  -0.0037252393999012133
Bond Position:  [0.69667364]


portfolio before change:  [0.34460279]
curr_Stock_Price:  94.53296808425479
curr_Factors:  [94.53296808 -0.57641284 -0.89575365]
mat_Sqrt:  [[21.68849968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00619162 -0.01026435  0.4730823 ]
Stock Position:  -0.006191622241076026
Bond Position:  [0.92991522]


portfolio before change:  [0.35076177]
curr_Stock_Price:  93.55701470510907
curr_Factors:  [93.55701471 -0.69489334 -0.89174145]
mat_Sqrt:  [[19.1429834   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00455032 -0.01129302 -0.0597167 ]
Stock Position:  -0.0045503205383181314
Bond Position:  [0.77647618]


portfolio before change:  [0.34812396]
curr_Stock_Price:  94.15804520245996
curr_Factors:  [94.1580452  -0.68576357 -0.86264535]
mat_Sqrt:  [[20.01667728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00434135  0.04509828 -0.14744939]
Stock Position:  -0.004341345907859716
Bond Position:  [0.7568966]


portfolio before change:  [0.34109914]
curr_Stock_Price:  95.79796023336107
curr_Factors:  [95.79796023 -0.72786433 -0.84897779]
mat_Sqrt:  [[19.79440391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00493859 -0.01251402  0.37817223]
Stock Position:  0.004938585655033128
Bond Position:  [-0.13200729]


portfolio before change:  [0.33215106]
curr_Stock_Price:  93.98943129886976
curr_Factors:  [93.9894313  -1.0669027  -0.85690838]
mat_Sqrt:  [[13.72709023  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00478196  0.02074372 -0.3488129 ]
Stock Position:  0.004781963829668964
Bond Position:  [-0.117303]


portfolio before change:  [0.33802897]
curr_Stock_Price:  95.22168109525585
curr_Factors:  [95.2216811  -0.78044412 -0.87273349]
mat_Sqrt:  [[18.22929736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00019957 -0.0051214  -0.06188567]
Stock Position:  0.00019956620613905036
Bond Position:  [0.31902594]


portfolio before change:  [0.33835971]
curr_Stock_Price:  96.67914125425953
curr_Factors:  [96.67914125 -1.09395863 -0.89256714]
mat_Sqrt:  [[13.26159014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254783  0.02127202 -0.33800701]
Stock Position:  -0.0025478266232679667
Bond Position:  [0.5846814]


portfolio before change:  [0.33995877]
curr_Stock_Price:  96.08021305147221
curr_Factors:  [96.08021305 -1.02711246 -0.83565168]
mat_Sqrt:  [[14.91577319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00271628  0.01393255 -0.26565769]
Stock Position:  -0.002716277957025567
Bond Position:  [0.60093933]


portfolio before change:  [0.33883601]
curr_Stock_Price:  96.5212147279482
curr_Factors:  [96.52121473 -1.10198012 -0.84124698]
mat_Sqrt:  [[13.82579062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00530218 -0.00988231  0.50859871]
Stock Position:  0.005302175219065133
Bond Position:  [-0.17293639]


portfolio before change:  [0.33865865]
curr_Stock_Price:  96.49184218687604
curr_Factors:  [96.49184219 -1.01646369 -0.82941951]
mat_Sqrt:  [[15.23469319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00535412 -0.00282264 -0.08205776]
Stock Position:  -0.005354124762808154
Bond Position:  [0.85528801]


portfolio before change:  [0.34706722]
curr_Stock_Price:  94.94132629782105
curr_Factors:  [94.9413263  -0.69384337 -0.82834617]
mat_Sqrt:  [[20.71938098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01033373 -0.05445    -0.39381477]
Stock Position:  -0.010333733123670091
Bond Position:  [1.32816555]


portfolio before change:  [0.34564384]
curr_Stock_Price:  95.09513494540943
curr_Factors:  [95.09513495 -0.83829099 -0.82192031]
mat_Sqrt:  [[18.07747165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00876368 0.03307298 0.63240435]
Stock Position:  0.008763683124106029
Bond Position:  [-0.48773979]


portfolio before change:  [0.3421092]
curr_Stock_Price:  94.69876481648816
curr_Factors:  [94.69876482 -0.7064841  -0.81461873]
mat_Sqrt:  [[20.68891659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00560259 -0.04007251 -0.51768181]
Stock Position:  0.005602592343843758
Bond Position:  [-0.18844937]


portfolio before change:  [0.33579316]
curr_Stock_Price:  93.57562604778495
curr_Factors:  [93.57562605 -0.19057    -0.81304803]
mat_Sqrt:  [[34.30022485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00327424 0.00128784 0.1961862 ]
Stock Position:  0.0032742415736393307
Bond Position:  [0.02940395]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.33647102]
Stock Price:  93.78153331073663
PL:  [0.33647102]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-4.01234151e-01  1.82777025e-01 -2.27021179e-02]
 [-2.51702612e-01  2.02041771e-03 -8.92476378e-02]
 [-9.21091535e-03  6.05089465e-02  4.17831343e-02]
 [ 9.86551154e-02  7.24601984e-02  9.16537815e-02]
 [-1.41338157e-01  2.50116219e-01 -3.62979714e-02]
 [-3.63746007e-02 -1.27830134e-01  2.87496124e-01]
 [-6.48421856e-02 -2.09646691e-01 -8.03675838e-02]
 [ 7.20666097e-04  7.98837934e-01  1.51553156e-01]
 [-1.80466198e-02  7.01761247e-02 -6.67795717e-02]
 [ 1.87547291e-01  6.36149073e-02  6.77461089e-02]
 [-4.65832538e-02 -1.67139959e-01  1.89910506e-02]
 [-2.35141914e-03 -1.64272029e-02  9.87359773e-02]
 [ 9.17655757e-03 -3.44486897e-02  7.73399699e-02]
 [ 1.34921118e-02 -1.90966792e-01  2.03734585e-02]
 [-2.50631544e-02  6.65281702e-02 -4.70003851e-02]
 [ 1.36342787e-01  6.39401873e-03 -3.59849205e-02]
 [ 4.58082200e-02  2.70696343e-02  5.15929713e-03]
 [-3.96282040e-02 -6.02477814e-02 -6.44954943e-03]
 [ 2.21081992e-02  8.91183118e-02 -1.75192826e-01]
 [-4.76380565e-02 -1.78304012e-02 -2.37576962e-02]
 [-3.05054644e-02  4.22381905e-01 -3.65565950e-01]
 [ 1.59359693e-01  1.11693715e-01  9.64273256e-02]
 [ 5.31500388e-03 -4.84601948e-02  7.89346338e-02]
 [ 5.21053322e-02 -2.90316267e-03 -1.41512743e-01]
 [-4.31073186e-02  9.35955035e-03 -5.12772958e-03]
 [-1.07882641e-01 -1.33116805e-02  2.26637884e-01]
 [-2.81014017e-02 -3.29364392e-02 -2.62671348e-03]
 [-5.56465747e-02  3.40101589e-02 -2.49534727e-01]
 [-1.47909419e-02 -3.98593248e-02  5.59442501e-02]
 [-8.45454292e-03  3.23012470e-02 -4.11016708e-02]
 [-4.09837691e-03 -3.79928438e-02 -3.15576837e-02]
 [ 1.55888319e-02  1.33173232e-01 -1.03914907e-01]
 [-3.69856477e-02  3.06869651e-02 -1.15399666e-01]
 [ 3.05736284e-02 -4.48586783e-02  1.17193822e-01]
 [-5.61583190e-02  8.07961014e-02 -1.87284965e-02]
 [ 4.63339992e-02 -3.62881601e-02  8.61244554e-02]
 [-3.86694175e-02  1.00365608e-01  6.10551545e-02]
 [ 6.66092594e-02 -7.95669981e-02 -8.10632389e-02]
 [ 9.67074816e-02  4.45320685e-03  7.31954254e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.0285321]
curr_Stock_Price:  98.68604681981306
curr_Factors:  [98.68604682 -0.69715825 -0.99532674]
mat_Sqrt:  [[18.1643081   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02029029  0.05899103 -0.06476282]
Stock Position:  -0.020290285524189593
Bond Position:  [-6.02616403]


portfolio before change:  [-8.01701089]
curr_Stock_Price:  98.08110098585357
curr_Factors:  [98.08110099 -1.02907609 -1.00834054]
mat_Sqrt:  [[12.78634842  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02107778  0.00065209 -0.25459867]
Stock Position:  -0.021077776500249234
Bond Position:  [-5.94967937]


portfolio before change:  [-8.02668255]
curr_Stock_Price:  98.50467020167504
curr_Factors:  [98.5046702  -1.24905345 -1.01701748]
mat_Sqrt:  [[10.21679592  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00114217 0.01952918 0.11919565]
Stock Position:  0.0011421749348469543
Bond Position:  [-8.13919211]


portfolio before change:  [-8.02747066]
curr_Stock_Price:  98.70546998155962
curr_Factors:  [98.70546998 -1.20355774 -1.03199588]
mat_Sqrt:  [[10.55486347  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01252074 0.02338643 0.26146273]
Stock Position:  0.012520743788624191
Bond Position:  [-9.26333656]


portfolio before change:  [-8.03621488]
curr_Stock_Price:  98.09957718100678
curr_Factors:  [98.09957718 -0.98315169 -1.01636626]
mat_Sqrt:  [[13.28273555  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00735486  0.08072466 -0.10354801]
Stock Position:  -0.007354862262057427
Bond Position:  [-7.314706]


portfolio before change:  [-8.03015248]
curr_Stock_Price:  97.15098102599451
curr_Factors:  [97.15098103 -0.92717171 -1.01271587]
mat_Sqrt:  [[13.96254926  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.70933111e-04 -4.12569982e-02  8.20146417e-01]
Stock Position:  -0.0002709331110062047
Bond Position:  [-8.00383106]


portfolio before change:  [-8.03113875]
curr_Stock_Price:  97.09832164564077
curr_Factors:  [97.09832165 -1.17209283 -1.01935106]
mat_Sqrt:  [[10.85124911  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01143104 -0.06766318 -0.22926635]
Stock Position:  -0.011431043598748945
Bond Position:  [-6.92120361]


portfolio before change:  [-8.02967565]
curr_Stock_Price:  96.89463910452007
curr_Factors:  [96.8946391  -1.31922499 -1.0123611 ]
mat_Sqrt:  [[ 9.41249537  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02068723 0.25782383 0.43233897]
Stock Position:  0.02068722770286372
Bond Position:  [-10.03415712]


portfolio before change:  [-8.00875032]
curr_Stock_Price:  97.96678292298989
curr_Factors:  [97.96678292 -1.37054834 -1.05683576]
mat_Sqrt:  [[ 8.64727616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200679  0.02264925 -0.19050353]
Stock Position:  -0.00200679393818378
Bond Position:  [-7.81215117]


portfolio before change:  [-8.0108187]
curr_Stock_Price:  98.5108350398892
curr_Factors:  [98.51083504 -1.4330553  -1.04336628]
mat_Sqrt:  [[ 8.27918857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02589158 0.02053162 0.19326079]
Stock Position:  0.025891576702248103
Bond Position:  [-10.56141954]


portfolio before change:  [-8.00388725]
curr_Stock_Price:  98.82953762076316
curr_Factors:  [98.82953762 -1.39217051 -1.05806989]
mat_Sqrt:  [[ 8.52630527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00901024 -0.05394419  0.05417618]
Stock Position:  -0.009010236051681782
Bond Position:  [-7.11340978]


portfolio before change:  [-8.0081532]
curr_Stock_Price:  99.20430276848032
curr_Factors:  [99.20430277 -1.20299791 -1.04718771]
mat_Sqrt:  [[10.45411591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138221 -0.00530186  0.28166626]
Stock Position:  0.001382210529032212
Bond Position:  [-8.14527443]


portfolio before change:  [-8.00859496]
curr_Stock_Price:  99.62136087637221
curr_Factors:  [99.62136088 -1.30631677 -1.03397201]
mat_Sqrt:  [[ 9.59351963  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186915 -0.01111827  0.22062941]
Stock Position:  0.0018691475263641578
Bond Position:  [-8.19480198]


portfolio before change:  [-8.01028929]
curr_Stock_Price:  99.2629534775496
curr_Factors:  [99.26295348 -1.33107702 -1.03614607]
mat_Sqrt:  [[ 9.30497616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00229233 -0.06163427  0.05811981]
Stock Position:  -0.0022923332758720315
Bond Position:  [-7.78274552]


portfolio before change:  [-8.01076168]
curr_Stock_Price:  99.0446082193135
curr_Factors:  [99.04460822 -1.11236777 -1.05390098]
mat_Sqrt:  [[11.35095163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185685  0.02147187 -0.13407902]
Stock Position:  -0.0018568541793677366
Bond Position:  [-7.82685028]


portfolio before change:  [-8.01108985]
curr_Stock_Price:  98.69442120552463
curr_Factors:  [98.69442121 -0.89203503 -1.10607891]
mat_Sqrt:  [[13.38205301  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00973711  0.00206366 -0.10265496]
Stock Position:  0.009737113552536402
Bond Position:  [-8.97208863]


portfolio before change:  [-8.01590526]
curr_Stock_Price:  98.3150651916009
curr_Factors:  [98.31506519 -1.07081871 -1.10133995]
mat_Sqrt:  [[11.20117431  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00467691 0.00873669 0.01471804]
Stock Position:  0.004676913477593521
Bond Position:  [-8.47571632]


portfolio before change:  [-8.01887691]
curr_Stock_Price:  97.90622242369037
curr_Factors:  [97.90622242 -1.18443868 -1.11809529]
mat_Sqrt:  [[ 9.79112275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00543786 -0.01944489 -0.01839877]
Stock Position:  -0.005437858458005622
Bond Position:  [-7.48647674]


portfolio before change:  [-8.01732266]
curr_Stock_Price:  97.44829917007594
curr_Factors:  [97.44829917 -1.05850658 -1.13877712]
mat_Sqrt:  [[10.82694868  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.19168207e-04  2.87628114e-02 -4.99776367e-01]
Stock Position:  0.0004191682066841491
Bond Position:  [-8.05816989]


portfolio before change:  [-8.01855126]
curr_Stock_Price:  96.92042303689358
curr_Factors:  [96.92042304 -1.02616163 -1.16397503]
mat_Sqrt:  [[10.84553635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00517514 -0.00575474 -0.06777409]
Stock Position:  -0.0051751420565510214
Bond Position:  [-7.51697431]


portfolio before change:  [-8.02033303]
curr_Stock_Price:  97.08314024845284
curr_Factors:  [97.08314025 -0.86015337 -1.19565594]
mat_Sqrt:  [[12.42559438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152169  0.13632317 -1.0428579 ]
Stock Position:  -0.0015216942957349008
Bond Position:  [-7.87260217]


portfolio before change:  [-8.0202875]
curr_Stock_Price:  96.40648441998694
curr_Factors:  [96.40648442 -0.75967254 -1.18746719]
mat_Sqrt:  [[13.75543108  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01467364 0.03604899 0.27508032]
Stock Position:  0.014673638483600785
Bond Position:  [-9.4349214]


portfolio before change:  [-8.02117501]
curr_Stock_Price:  96.42637933527277
curr_Factors:  [96.42637934 -0.69696287 -1.17379395]
mat_Sqrt:  [[14.85034339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00077679 -0.01564046  0.22517854]
Stock Position:  0.0007767882794969263
Bond Position:  [-8.09607789]


portfolio before change:  [-8.02136727]
curr_Stock_Price:  97.48176547020637
curr_Factors:  [97.48176547 -1.03206842 -1.14899369]
mat_Sqrt:  [[11.00779023  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0020555  -0.00093699 -0.40369647]
Stock Position:  0.002055504187784343
Bond Position:  [-8.22174145]


portfolio before change:  [-8.02314214]
curr_Stock_Price:  97.11831065591441
curr_Factors:  [97.11831066 -0.93397396 -1.11885796]
mat_Sqrt:  [[12.46716041  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00338838  0.00302078 -0.01462799]
Stock Position:  -0.0033883819875472395
Bond Position:  [-7.6940682]


portfolio before change:  [-8.02471593]
curr_Stock_Price:  97.29891937537501
curr_Factors:  [97.29891938 -1.05998804 -1.06608753]
mat_Sqrt:  [[11.60820663  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00554242 -0.00429633  0.6465348 ]
Stock Position:  -0.005542424765129405
Bond Position:  [-7.48544399]


portfolio before change:  [-8.02943359]
curr_Stock_Price:  97.9812791653378
curr_Factors:  [97.98127917 -0.8936356  -1.06268909]
mat_Sqrt:  [[13.85230628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00255269 -0.01063019 -0.00749328]
Stock Position:  -0.0025526940546604644
Bond Position:  [-7.77931737]


portfolio before change:  [-8.03265509]
curr_Stock_Price:  98.86231652147346
curr_Factors:  [98.86231652 -0.7130097  -1.07391145]
mat_Sqrt:  [[16.55696722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00601803  0.01097673 -0.71185312]
Stock Position:  -0.0060180310533224325
Bond Position:  [-7.4376986]


portfolio before change:  [-8.03089534]
curr_Stock_Price:  98.41540676401497
curr_Factors:  [98.41540676 -0.71085739 -1.03676127]
mat_Sqrt:  [[17.14280772  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00067128 -0.01286454  0.15959337]
Stock Position:  -0.0006712797871573909
Bond Position:  [-7.96483107]


portfolio before change:  [-8.03109005]
curr_Stock_Price:  97.2222198692432
curr_Factors:  [97.22221987 -0.37318752 -1.00618444]
mat_Sqrt:  [[24.47439133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041884  0.01042518 -0.11725163]
Stock Position:  -0.000418842772715656
Bond Position:  [-7.99036922]


portfolio before change:  [-8.03227829]
curr_Stock_Price:  97.67437614758754
curr_Factors:  [97.67437615 -0.53304229 -0.99158296]
mat_Sqrt:  [[21.26396815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00086039 -0.01226214 -0.09002529]
Stock Position:  -0.0008603906266491212
Bond Position:  [-7.94824017]


portfolio before change:  [-8.03315046]
curr_Stock_Price:  97.53325200280511
curr_Factors:  [97.533252   -0.44058089 -0.9677829 ]
mat_Sqrt:  [[23.85108183  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090399  0.04298148 -0.2964403 ]
Stock Position:  0.0009039909691440504
Bond Position:  [-8.12131964]


portfolio before change:  [-8.03379849]
curr_Stock_Price:  97.93944667303937
curr_Factors:  [97.93944667 -0.29915777 -0.97147575]
mat_Sqrt:  [[27.48707455  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00197466  0.00990418 -0.32920313]
Stock Position:  -0.001974657410374253
Bond Position:  [-7.84040163]


portfolio before change:  [-8.03567243]
curr_Stock_Price:  98.39209709060506
curr_Factors:  [98.39209709 -0.41884112 -0.99161626]
mat_Sqrt:  [[24.01078512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00188828 -0.01447808  0.33432135]
Stock Position:  0.0018882755191062313
Bond Position:  [-8.22146382]


portfolio before change:  [-8.0372545]
curr_Stock_Price:  98.09853846676447
curr_Factors:  [98.09853847 -0.2191553  -0.98641118]
mat_Sqrt:  [[29.38269763  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148008  0.02607683 -0.05342719]
Stock Position:  -0.0014800826918479513
Bond Position:  [-7.89206055]


portfolio before change:  [-8.03902103]
curr_Stock_Price:  98.62551457091314
curr_Factors:  [98.62551457 -0.40624859 -1.00673479]
mat_Sqrt:  [[24.00702801  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00235376 -0.01171195  0.2456891 ]
Stock Position:  0.0023537603392310602
Bond Position:  [-8.27116186]


portfolio before change:  [-8.0416879]
curr_Stock_Price:  97.9317711069382
curr_Factors:  [97.93177111 -0.26457722 -0.99933594]
mat_Sqrt:  [[27.67025088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0002067   0.03239286  0.17417336]
Stock Position:  -0.00020670367152626456
Bond Position:  [-8.02144504]


portfolio before change:  [-8.04262173]
curr_Stock_Price:  97.59840268820844
curr_Factors:  [97.59840269 -0.27295094 -0.99285943]
mat_Sqrt:  [[27.52379081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00122878 -0.02568014 -0.23125086]
Stock Position:  0.001228782393069727
Bond Position:  [-8.16254893]


portfolio before change:  [-8.04239481]
curr_Stock_Price:  98.61347445504643
curr_Factors:  [98.61347446 -0.47888269 -0.97758779]
mat_Sqrt:  [[22.98260059  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00489751 0.00143727 0.20880618]
Stock Position:  0.00489750678385968
Bond Position:  [-8.52535497]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.0381456]
Stock Price:  99.69871115222854
PL:  [-8.0381456]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.04760276e-01 -6.41474531e-02  7.20325297e-03]
 [-1.60505343e-01  6.82524147e-02 -1.74954674e-01]
 [-2.29034149e-03  1.34657907e-02  4.48691031e-02]
 [ 4.47323912e-02  4.39164544e-03  8.82728678e-02]
 [ 9.41804272e-02 -5.58282310e-02 -8.62229181e-02]
 [-8.00922193e-02 -1.55995309e-01  1.34797948e-01]
 [-6.02760650e-02 -1.82400787e-01  1.08362734e-01]
 [-2.17480901e-02  7.40282757e-01  1.49848847e-01]
 [ 4.26019605e-01  5.37316635e-02  4.07749551e-01]
 [ 4.32350036e-01  1.65728533e-01  2.74523262e-01]
 [-2.14068793e-01 -2.37815811e-01  2.21433074e-02]
 [-1.09028851e-01 -2.04832918e-02  8.34967079e-02]
 [-1.07794944e-01  4.14072446e-01 -6.81899445e-01]
 [ 5.81375442e-03 -3.98676195e-02  6.23777109e-02]
 [-1.53788983e-01  1.89505978e-01 -3.63588621e-02]
 [ 2.10296165e-03 -3.08941483e-02  2.33371682e-02]
 [ 4.04927785e-02  1.17901534e-01 -1.90452842e-01]
 [ 2.47106277e-02 -4.33367770e-02 -5.28776320e-02]
 [ 3.07227202e-02  6.00198991e-02 -2.23569281e-01]
 [-5.59713228e-02  6.05585474e-03 -4.25211016e-02]
 [-4.29546920e-02  5.25230431e-01 -4.83122323e-01]
 [ 3.83251591e-01  2.18825233e-01  5.99681079e-02]
 [ 8.34021307e-03 -5.62756332e-02  8.37987186e-02]
 [ 1.73272271e-01  1.82992236e-01 -1.62886491e-01]
 [-2.23261025e-01  9.39114802e-02  1.30663824e-02]
 [-1.87270620e-01 -6.30481903e-02  9.59922275e-02]
 [-8.51789263e-02 -3.53995616e-02 -2.45828198e-02]
 [-9.61468997e-02  1.28452123e-01 -6.63418338e-02]
 [ 3.69149418e-01  8.98636845e-02  3.39498031e-01]
 [ 1.00231442e-01  7.57286170e-02 -1.46522576e-01]
 [ 5.31138764e-02  5.89343975e-02  1.50935575e-01]
 [-6.19962944e-03  1.01740235e-01 -1.16284683e-01]
 [-2.78716644e-02  4.72220103e-02 -8.89153757e-02]
 [ 4.77649256e-02 -4.11710635e-02  1.86453120e-01]
 [-7.30636350e-02  1.55142281e-02 -4.66293783e-02]
 [-1.01013081e-01 -1.34582105e-01 -9.02999350e-02]
 [-6.08041525e-02  7.20914420e-02 -2.78163729e-02]
 [-4.79507508e-02 -1.36108566e-02  3.05960243e-02]
 [ 9.45314222e-02  5.80133060e-03  8.60772647e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.37028464]
curr_Stock_Price:  99.65154080252938
curr_Factors:  [99.6515408  -1.0684262  -0.99412999]
mat_Sqrt:  [[12.66855976  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00735179 -0.0207035   0.02054888]
Stock Position:  0.007351789900412483
Bond Position:  [-1.10290183]


portfolio before change:  [-0.36960163]
curr_Stock_Price:  99.76319749798576
curr_Factors:  [99.7631975  -0.84254012 -0.9729925 ]
mat_Sqrt:  [[16.23658008  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01122686  0.02202837 -0.49909699]
Stock Position:  -0.01122686238094907
Bond Position:  [0.75042606]


portfolio before change:  [-0.37797417]
curr_Stock_Price:  100.51731253867162
curr_Factors:  [100.51731254  -0.90577946  -0.97515351]
mat_Sqrt:  [[15.32364423  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00062761 0.00434607 0.12799906]
Stock Position:  0.0006276065080551839
Bond Position:  [-0.44105949]


portfolio before change:  [-0.37796423]
curr_Stock_Price:  100.62099721394434
curr_Factors:  [100.62099721  -0.98396735  -0.96220836]
mat_Sqrt:  [[14.37061139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.004429   0.0014174  0.25181792]
Stock Position:  0.0044290012428293436
Bond Position:  [-0.82361475]


portfolio before change:  [-0.37868047]
curr_Stock_Price:  100.48252830487098
curr_Factors:  [100.4825283   -1.05035133  -0.9705696 ]
mat_Sqrt:  [[13.31728668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00489472 -0.01801848 -0.24596999]
Stock Position:  0.004894717627367867
Bond Position:  [-0.87051407]


portfolio before change:  [-0.38216494]
curr_Stock_Price:  99.79287734330748
curr_Factors:  [99.79287734 -0.90349417 -0.97082757]
mat_Sqrt:  [[15.31411681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0055125  -0.05034727  0.38454103]
Stock Position:  -0.005512502838701974
Bond Position:  [0.16794358]


portfolio before change:  [-0.38325326]
curr_Stock_Price:  99.99411456234337
curr_Factors:  [99.99411456 -0.65480066 -0.97835065]
mat_Sqrt:  [[19.53016158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00386013 -0.0588696   0.30912872]
Stock Position:  -0.003860132910918802
Bond Position:  [0.00273731]


portfolio before change:  [-0.38494723]
curr_Stock_Price:  100.43304086350652
curr_Factors:  [100.43304086  -0.43718051  -0.95947448]
mat_Sqrt:  [[24.84946592  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00643673 0.23892523 0.42747705]
Stock Position:  0.006436728395239049
Bond Position:  [-1.03140744]


portfolio before change:  [-0.38391616]
curr_Stock_Price:  100.61325757537652
curr_Factors:  [100.61325758  -0.24083463  -0.96092347]
mat_Sqrt:  [[30.25089991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01719681 0.01734182 1.16319597]
Stock Position:  0.017196812841134803
Bond Position:  [-2.11414352]


portfolio before change:  [-0.41381833]
curr_Stock_Price:  98.88980517342421
curr_Factors:  [98.88980517 -0.24305339 -0.96882509]
mat_Sqrt:  [[29.43332884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01774234 0.05348865 0.78313845]
Stock Position:  0.01774233762688456
Bond Position:  [-2.16835465]


portfolio before change:  [-0.44180713]
curr_Stock_Price:  97.3275683329752
curr_Factors:  [97.32756833 -0.31888122 -0.98354581]
mat_Sqrt:  [[26.4605581   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00975387 -0.07675472  0.06316869]
Stock Position:  -0.009753866773111448
Bond Position:  [0.50751301]


portfolio before change:  [-0.42827464]
curr_Stock_Price:  95.94667510132807
curr_Factors:  [95.9466751  -0.17735141 -0.97225988]
mat_Sqrt:  [[30.39205668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00316419 -0.00661095  0.23819287]
Stock Position:  -0.003164191644301914
Bond Position:  [-0.12468097]


portfolio before change:  [-0.420271]
curr_Stock_Price:  93.41230709978251
curr_Factors:  [93.4123071  -0.34846415 -0.950591  ]
mat_Sqrt:  [[25.48188891  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0063757   0.13364131 -1.94526931]
Stock Position:  -0.006375700883381907
Bond Position:  [0.17529793]


portfolio before change:  [-0.419729]
curr_Stock_Price:  93.33073494029196
curr_Factors:  [93.33073494 -0.42444921 -0.93321218]
mat_Sqrt:  [[24.01042449  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0004335  -0.01286722  0.17794625]
Stock Position:  0.0004335036888327663
Bond Position:  [-0.46018822]


portfolio before change:  [-0.41954414]
curr_Stock_Price:  93.88988505385885
curr_Factors:  [93.88988505 -0.3551307  -0.94109124]
mat_Sqrt:  [[25.68483434  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00477044  0.06116279 -0.10372171]
Stock Position:  -0.004770439923074305
Bond Position:  [0.02835192]


portfolio before change:  [-0.43272628]
curr_Stock_Price:  96.65392492737298
curr_Factors:  [96.65392493 -0.37820659 -0.95481329]
mat_Sqrt:  [[25.48568523  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.19887968e-05 -9.97104348e-03  6.65744450e-02]
Stock Position:  2.1988796755232795e-05
Bond Position:  [-0.43485158]


portfolio before change:  [-0.43280658]
curr_Stock_Price:  95.47402739763989
curr_Factors:  [95.4740274  -0.38130442 -0.93428788]
mat_Sqrt:  [[25.6171473   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00100258  0.03805256 -0.54330895]
Stock Position:  0.0010025825450880393
Bond Position:  [-0.52852718]


portfolio before change:  [-0.4319989]
curr_Stock_Price:  96.34553025356887
curr_Factors:  [96.34553025 -0.39541224 -0.92444385]
mat_Sqrt:  [[25.74099628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.000197   -0.01398688 -0.15084517]
Stock Position:  0.00019699873413964595
Bond Position:  [-0.45097885]


portfolio before change:  [-0.43170936]
curr_Stock_Price:  98.10146037874138
curr_Factors:  [98.10146038 -0.49081191 -0.91446457]
mat_Sqrt:  [[24.06421244  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.10606464e-04  1.93713391e-02 -6.37780928e-01]
Stock Position:  -0.0001106064639910067
Bond Position:  [-0.4208587]


portfolio before change:  [-0.43168547]
curr_Stock_Price:  97.40982856998134
curr_Factors:  [97.40982857 -0.42985854 -0.9406232 ]
mat_Sqrt:  [[24.74059398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00256319  0.00195452 -0.12130087]
Stock Position:  -0.002563186648891164
Bond Position:  [-0.1820059]


portfolio before change:  [-0.43220716]
curr_Stock_Price:  97.60448264594568
curr_Factors:  [97.60448265 -0.36175165 -0.91950833]
mat_Sqrt:  [[27.1035156   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.26771047e-03  1.69517393e-01 -1.37821351e+00]
Stock Position:  -0.0012677104667616534
Bond Position:  [-0.30847293]


portfolio before change:  [-0.43229169]
curr_Stock_Price:  97.6407429191484
curr_Factors:  [97.64074292 -0.48232892 -0.90367234]
mat_Sqrt:  [[24.41734157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01802653 0.07062554 0.17107232]
Stock Position:  0.018026534203909497
Bond Position:  [-2.19241588]


portfolio before change:  [-0.47832595]
curr_Stock_Price:  95.10225201573533
curr_Factors:  [95.10225202 -0.71189436 -0.91327715]
mat_Sqrt:  [[18.72353223  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0007455  -0.01816288  0.23905442]
Stock Position:  0.0007454971202707216
Bond Position:  [-0.5492244]


portfolio before change:  [-0.47911887]
curr_Stock_Price:  94.13073459194466
curr_Factors:  [94.13073459 -0.63897873 -0.89746322]
mat_Sqrt:  [[20.25177943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00875856  0.05906049 -0.46466982]
Stock Position:  0.008758555739292007
Bond Position:  [-1.30356816]


portfolio before change:  [-0.48868036]
curr_Stock_Price:  93.05766593360426
curr_Factors:  [93.05766593 -0.82864409 -0.88683407]
mat_Sqrt:  [[16.73899793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01203323  0.0303098   0.03727475]
Stock Position:  -0.012033232904195123
Bond Position:  [0.63110421]


portfolio before change:  [-0.48580341]
curr_Stock_Price:  92.82513878441839
curr_Factors:  [92.82513878 -0.62218351 -0.91787334]
mat_Sqrt:  [[19.89882421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0090732  -0.02034872  0.27383911]
Stock Position:  -0.009073196731850251
Bond Position:  [0.35641733]


portfolio before change:  [-0.48592112]
curr_Stock_Price:  92.8430228455429
curr_Factors:  [92.84302285 -0.28283254 -0.89816901]
mat_Sqrt:  [[28.50012837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00341833 -0.01142516 -0.07012794]
Stock Position:  -0.003418327713860765
Bond Position:  [-0.16855324]


portfolio before change:  [-0.48488623]
curr_Stock_Price:  92.53411039571691
curr_Factors:  [92.5341104  -0.34133885 -0.90816748]
mat_Sqrt:  [[26.52455769  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00314685  0.04145774 -0.18925479]
Stock Position:  -0.0031468456913854776
Bond Position:  [-0.19369566]


portfolio before change:  [-0.47829051]
curr_Stock_Price:  90.43043715663033
curr_Factors:  [90.43043716 -0.10027084 -0.9248382 ]
mat_Sqrt:  [[32.44258359  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01408003 0.02900338 0.96849339]
Stock Position:  0.014080028808838551
Bond Position:  [-1.75155367]


portfolio before change:  [-0.44186085]
curr_Stock_Price:  93.0333163092188
curr_Factors:  [93.03331631 -0.16663085 -0.92455518]
mat_Sqrt:  [[31.24225919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00274566  0.02444131 -0.41798813]
Stock Position:  0.0027456620665162164
Bond Position:  [-0.6972989]


portfolio before change:  [-0.4429209]
curr_Stock_Price:  92.67898179091632
curr_Factors:  [ 9.26789818e+01 -8.68414540e-02 -9.37643568e-01]
mat_Sqrt:  [[33.27001999  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00288408 0.019021   0.43057718]
Stock Position:  0.0028840801754604303
Bond Position:  [-0.71021452]


portfolio before change:  [-0.4408571]
curr_Stock_Price:  93.42535002962381
curr_Factors:  [93.42535003 -0.19700901 -0.94878891]
mat_Sqrt:  [[29.70646784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.08636575e-04  3.28365195e-02 -3.31727832e-01]
Stock Position:  -0.0003086365746411748
Bond Position:  [-0.41202262]


portfolio before change:  [-0.44180957]
curr_Stock_Price:  96.3445341766323
curr_Factors:  [96.34453418 -0.28073948 -0.95907611]
mat_Sqrt:  [[27.88572974  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00130469  0.01524084 -0.25365082]
Stock Position:  -0.00130469194473113
Bond Position:  [-0.31610963]


portfolio before change:  [-0.44040377]
curr_Stock_Price:  95.23675226214115
curr_Factors:  [95.23675226 -0.27083957 -0.94479163]
mat_Sqrt:  [[28.23986738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00274153 -0.0132879   0.53189885]
Stock Position:  0.002741532039886366
Bond Position:  [-0.70149838]


portfolio before change:  [-0.44491919]
curr_Stock_Price:  93.62169899259119
curr_Factors:  [93.62169899 -0.26256451 -0.95714027]
mat_Sqrt:  [[27.64811091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00287235  0.0050072  -0.13302064]
Stock Position:  -0.0028723477241804395
Bond Position:  [-0.17600511]


portfolio before change:  [-0.45312116]
curr_Stock_Price:  96.46953207686806
curr_Factors:  [96.46953208 -0.53796786 -0.95484966]
mat_Sqrt:  [[21.68042362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00677648 -0.04343619 -0.25760058]
Stock Position:  -0.00677647900147371
Bond Position:  [0.2006026]


portfolio before change:  [-0.47730537]
curr_Stock_Price:  100.04207901112903
curr_Factors:  [100.04207901  -0.72814968  -0.96186881]
mat_Sqrt:  [[18.45937542  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280435  0.02326741 -0.07935237]
Stock Position:  -0.002804349587936225
Bond Position:  [-0.19675241]


portfolio before change:  [-0.47863444]
curr_Stock_Price:  100.50723985048982
curr_Factors:  [100.50723985  -0.88009294  -0.96618609]
mat_Sqrt:  [[15.86238744  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280435 -0.00439289  0.08728194]
Stock Position:  -0.002804348849944883
Bond Position:  [-0.19677708]


portfolio before change:  [-0.47607404]
curr_Stock_Price:  99.58545745735141
curr_Factors:  [99.58545746 -1.11991205 -0.93838276]
mat_Sqrt:  [[12.71422358  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00891018 0.00187237 0.24555448]
Stock Position:  0.0089101832466674
Bond Position:  [-1.36339871]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.48092579]
Stock Price:  99.06006752308157
PL:  [-0.48092579]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.74322743e-01 -4.51952400e-02  2.99984881e-03]
 [-1.32814838e-01  6.88786494e-02 -1.44015969e-01]
 [ 2.75249066e-03  8.12860656e-03  4.84339057e-02]
 [ 1.17173874e-01  3.53926867e-02  1.41284707e-01]
 [ 1.86629577e-01 -1.94033776e-01 -1.04654422e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.29699595e-02 -1.42153907e-01 -2.67651862e-02]
 [ 1.15001577e-02  6.18383586e-01  8.82937853e-02]
 [ 2.90664491e-01 -2.39099004e-03  2.99656338e-01]
 [ 4.53162394e-01  1.74409912e-01  2.92102804e-01]
 [-2.52830553e-01 -2.45198474e-01  2.95598798e-02]
 [-7.43365146e-02 -1.92830063e-02  8.77973508e-02]
 [ 4.17699247e-03 -3.63103444e-02  1.31398953e-01]
 [ 1.04398340e-02 -1.05803626e-01 -2.89301395e-02]
 [-3.88017749e-02  9.74631565e-02 -4.48069680e-02]
 [ 8.74209550e-02 -7.49311491e-03 -5.32496812e-03]
 [ 5.25968696e-02  4.53997957e-02 -6.19372663e-02]
 [-1.32551054e-02 -5.41705162e-02 -2.84984683e-02]
 [ 2.62737102e-03  1.43177913e-01 -9.98528076e-02]
 [-8.40908400e-02 -1.57540842e-02 -2.46363154e-02]
 [-2.80792687e-02  3.97364422e-01 -3.32996746e-01]
 [ 1.23708667e-01  8.25268524e-02  1.16033333e-01]
 [ 7.96105372e-03 -5.63659371e-02  8.37824583e-02]
 [ 1.78678538e-01  1.59012703e-01 -2.29845205e-01]
 [-1.52987493e-01  4.86716590e-02  5.83089247e-03]
 [-1.51637644e-01 -3.69826112e-02  1.65680194e-01]
 [-5.89211045e-02 -3.42664320e-02 -1.44821798e-02]
 [-1.40071238e-01  1.64275346e-01 -8.87470004e-02]
 [ 4.54792041e-02  3.76183768e-02  8.24036550e-02]
 [ 6.05481738e-02  5.17716015e-02 -1.00559669e-01]
 [ 8.53941028e-03 -1.41239103e-02 -1.57825880e-02]
 [-6.14828455e-02  1.19715151e-02 -1.41260769e-01]
 [ 4.51323793e-02  4.68818469e-02  9.85326301e-02]
 [ 4.70870307e-02 -3.79107405e-02  1.83882795e-01]
 [-7.21235657e-02 -2.02647241e-02 -2.02910723e-02]
 [-1.03009307e-01 -1.44497420e-01 -9.72101760e-02]
 [ 9.11620690e-02  1.02712000e-01  2.20668393e-01]
 [ 1.68394775e-01 -1.18611833e-01 -1.59089073e-01]
 [ 9.96454781e-02  2.63304383e-03  5.58030699e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.27797873]
curr_Stock_Price:  99.41103314303578
curr_Factors:  [99.41103314 -0.9180296  -0.97785849]
mat_Sqrt:  [[14.93003581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01109908 -0.0145867   0.00855773]
Stock Position:  0.011099078890058482
Bond Position:  [-3.38134963]


portfolio before change:  [-2.26915431]
curr_Stock_Price:  100.24417604745159
curr_Factors:  [100.24417605  -1.03148675  -0.96942545]
mat_Sqrt:  [[13.55420413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01093035  0.02223049 -0.41083747]
Stock Position:  -0.010930348786309432
Bond Position:  [-1.1734505]


portfolio before change:  [-2.27458657]
curr_Stock_Price:  100.72774385915774
curr_Factors:  [100.72774386  -0.97477755  -0.94179184]
mat_Sqrt:  [[14.81813665  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00096492 0.0026235  0.13816845]
Stock Position:  0.0009649165391104214
Bond Position:  [-2.37178043]


portfolio before change:  [-2.27513032]
curr_Stock_Price:  100.47149283606745
curr_Factors:  [100.47149284  -0.84149844  -0.93697888]
mat_Sqrt:  [[16.96914542  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00903039 0.01142294 0.40304594]
Stock Position:  0.009030389678607415
Bond Position:  [-3.18242705]


portfolio before change:  [-2.26408892]
curr_Stock_Price:  101.73824037284265
curr_Factors:  [101.73824037  -1.02535302  -0.92861854]
mat_Sqrt:  [[14.4173405   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0087159  -0.06262413 -0.29854994]
Stock Position:  0.008715900404178812
Bond Position:  [-3.15082929]


portfolio before change:  [-2.26357547]
curr_Stock_Price:  101.84234081212546
curr_Factors:  [101.84234081  -0.96412346  -0.93358565]
mat_Sqrt:  [[15.26735421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01004131 -0.05534923  0.15513819]
Stock Position:  -0.010041307360080463
Bond Position:  [-1.24094523]


portfolio before change:  [-2.2560564]
curr_Stock_Price:  101.07807825989026
curr_Factors:  [101.07807826  -0.87643209  -0.93136824]
mat_Sqrt:  [[16.57827238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.005275   -0.04587998 -0.07635363]
Stock Position:  -0.005275002298746564
Bond Position:  [-1.72286931]


portfolio before change:  [-2.25909097]
curr_Stock_Price:  101.61252217273409
curr_Factors:  [101.61252217  -0.85631896  -0.9476534 ]
mat_Sqrt:  [[16.72984764  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00930971 0.19958244 0.25187759]
Stock Position:  0.009309712522032628
Bond Position:  [-3.20507434]


portfolio before change:  [-2.26729076]
curr_Stock_Price:  100.77478071756474
curr_Factors:  [100.77478072  -0.78113414  -0.91606057]
mat_Sqrt:  [[18.46160979  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.90310341e-02 -7.71688718e-04  8.54836125e-01]
Stock Position:  0.01903103412710026
Bond Position:  [-4.18513905]


portfolio before change:  [-2.27969341]
curr_Stock_Price:  100.15056494650463
curr_Factors:  [100.15056495  -0.73399567  -0.9306033 ]
mat_Sqrt:  [[18.95515141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02893086 0.05629056 0.83328799]
Stock Position:  0.028930863784131212
Bond Position:  [-5.17713576]


portfolio before change:  [-2.26469673]
curr_Stock_Price:  100.6912973417119
curr_Factors:  [100.69129734  -0.67730562  -0.94834607]
mat_Sqrt:  [[19.81437497  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01498143 -0.07913747  0.08432611]
Stock Position:  -0.014981426233211751
Bond Position:  [-0.75619749]


portfolio before change:  [-2.26309587]
curr_Stock_Price:  100.57813056524469
curr_Factors:  [100.57813057  -0.53515876  -0.93987317]
mat_Sqrt:  [[23.00940189  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262289 -0.00622356  0.2504614 ]
Stock Position:  -0.002622887935468141
Bond Position:  [-1.9992907]


portfolio before change:  [-2.2602023]
curr_Stock_Price:  99.37964449393206
curr_Factors:  [99.37964449 -0.74884011 -0.95986141]
mat_Sqrt:  [[17.9977327   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00131055 -0.01171911  0.37484464]
Stock Position:  0.001310546935420402
Bond Position:  [-2.39044399]


portfolio before change:  [-2.26019893]
curr_Stock_Price:  99.61022785343839
curr_Factors:  [99.61022785 -0.64367126 -0.97032045]
mat_Sqrt:  [[19.83153084  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00086038 -0.03414797 -0.08252964]
Stock Position:  -0.000860376376734181
Bond Position:  [-2.17449664]


portfolio before change:  [-2.25981346]
curr_Stock_Price:  98.84626248595536
curr_Factors:  [98.84626249 -0.68394643 -0.93729887]
mat_Sqrt:  [[19.53720187  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014359   0.0314561  -0.12782181]
Stock Position:  -0.0014358952536575637
Bond Position:  [-2.11788058]


portfolio before change:  [-2.25864817]
curr_Stock_Price:  97.85033623513064
curr_Factors:  [97.85033624 -0.7774736  -0.91982981]
mat_Sqrt:  [[17.92391268  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00473136 -0.00241839 -0.01519065]
Stock Position:  0.004731359514973599
Bond Position:  [-2.72161329]


portfolio before change:  [-2.25938411]
curr_Stock_Price:  97.76669855735058
curr_Factors:  [97.76669856 -0.76514279 -0.9425507 ]
mat_Sqrt:  [[17.72348366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00277717  0.01465272 -0.17668978]
Stock Position:  0.002777172564057652
Bond Position:  [-2.5308991]


portfolio before change:  [-2.26170124]
curr_Stock_Price:  97.04627166805726
curr_Factors:  [97.04627167 -0.66138432 -0.93504959]
mat_Sqrt:  [[19.66330061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00153229 -0.01748346 -0.0812982 ]
Stock Position:  -0.0015322880807835393
Bond Position:  [-2.1129984]


portfolio before change:  [-2.26005953]
curr_Stock_Price:  95.80247471166776
curr_Factors:  [95.80247471 -0.75604225 -0.92460074]
mat_Sqrt:  [[17.84361123  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00064287  0.04621047 -0.28485227]
Stock Position:  0.0006428671289900263
Bond Position:  [-2.32164779]


portfolio before change:  [-2.26037045]
curr_Stock_Price:  95.77027510342279
curr_Factors:  [95.7702751  -0.51590779 -0.90796656]
mat_Sqrt:  [[23.05950394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00400423 -0.00508461 -0.07028055]
Stock Position:  -0.004004227325191573
Bond Position:  [-1.8768845]


portfolio before change:  [-2.26041186]
curr_Stock_Price:  95.72202219387513
curr_Factors:  [95.72202219 -0.85880378 -0.89691617]
mat_Sqrt:  [[16.53911919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.03329358e-04  1.28248816e-01 -9.49947027e-01]
Stock Position:  -0.000903329357646535
Bond Position:  [-2.17394335]


portfolio before change:  [-2.26078488]
curr_Stock_Price:  95.83411126270836
curr_Factors:  [95.83411126 -0.88123201 -0.88443355]
mat_Sqrt:  [[16.39461839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0100179  0.02663543 0.3310108 ]
Stock Position:  0.01001789683139684
Bond Position:  [-3.22084112]


portfolio before change:  [-2.2670055]
curr_Stock_Price:  95.25335139600318
curr_Factors:  [95.2533514  -1.05556507 -0.88203215]
mat_Sqrt:  [[13.72121222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00098806 -0.01819203  0.23900803]
Stock Position:  0.000988063405234579
Bond Position:  [-2.36112185]


portfolio before change:  [-2.26781564]
curr_Stock_Price:  94.73215160525744
curr_Factors:  [94.73215161 -0.95104744 -0.88891067]
mat_Sqrt:  [[15.0457468   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01091471  0.05132113 -0.65568439]
Stock Position:  0.010914706746985168
Bond Position:  [-3.30178929]


portfolio before change:  [-2.2707168]
curr_Stock_Price:  94.5041642408045
curr_Factors:  [94.50416424 -1.31407031 -0.88834754]
mat_Sqrt:  [[10.44607238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01358043  0.01570871  0.01663391]
Stock Position:  -0.013580434933777231
Bond Position:  [-0.98730915]


portfolio before change:  [-2.26958546]
curr_Stock_Price:  94.41176939507315
curr_Factors:  [94.4117694  -1.48554284 -0.89070491]
mat_Sqrt:  [[ 8.77071202  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01429386 -0.01193609  0.47263948]
Stock Position:  -0.014293863460414136
Bond Position:  [-0.92007652]


portfolio before change:  [-2.27481301]
curr_Stock_Price:  94.76944245268069
curr_Factors:  [94.76944245 -1.53556158 -0.87441832]
mat_Sqrt:  [[ 8.51191644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00809123 -0.01105944 -0.04131363]
Stock Position:  -0.008091229937965778
Bond Position:  [-1.50801166]


portfolio before change:  [-2.27714657]
curr_Stock_Price:  95.03455008524735
curr_Factors:  [95.03455009 -1.72276402 -0.87476489]
mat_Sqrt:  [[ 7.07602003  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01761641  0.05301964 -0.25317049]
Stock Position:  -0.017616411329246275
Bond Position:  [-0.60297884]


portfolio before change:  [-2.27605415]
curr_Stock_Price:  94.96826018948764
curr_Factors:  [94.96826019 -1.88643325 -0.91017922]
mat_Sqrt:  [[ 5.79462211  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01207647 0.01214128 0.23507469]
Stock Position:  0.012076473221963632
Bond Position:  [-3.42293581]


portfolio before change:  [-2.27637532]
curr_Stock_Price:  94.97709798400449
curr_Factors:  [94.97709798 -1.60217283 -0.91774633]
mat_Sqrt:  [[ 7.64243776  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00661953  0.01670921 -0.28686874]
Stock Position:  0.00661953069072225
Bond Position:  [-2.90507913]


portfolio before change:  [-2.27726663]
curr_Stock_Price:  94.89731142188911
curr_Factors:  [94.89731142 -1.76591781 -0.92717409]
mat_Sqrt:  [[ 6.42183223  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00037914 -0.00455847 -0.04502333]
Stock Position:  0.00037913975157040776
Bond Position:  [-2.31324597]


portfolio before change:  [-2.27744797]
curr_Stock_Price:  95.18171108482122
curr_Factors:  [95.18171108 -1.57275553 -0.9195526 ]
mat_Sqrt:  [[ 7.87331884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01116097  0.00386379 -0.40297765]
Stock Position:  -0.011160973628303436
Bond Position:  [-1.2151274]


portfolio before change:  [-2.27539738]
curr_Stock_Price:  94.98437259917547
curr_Factors:  [94.9843726  -1.77630272 -0.93222443]
mat_Sqrt:  [[ 6.32927209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01182047 0.01513105 0.28108617]
Stock Position:  0.01182047225837745
Bond Position:  [-3.39815752]


portfolio before change:  [-2.27706827]
curr_Stock_Price:  94.87895452468196
curr_Factors:  [94.87895452 -1.66772726 -0.91915223]
mat_Sqrt:  [[ 7.14006893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01076789 -0.01223564  0.52456643]
Stock Position:  0.01076788646845271
Bond Position:  [-3.29871408]


portfolio before change:  [-2.27061626]
curr_Stock_Price:  95.51644075613693
curr_Factors:  [95.51644076 -1.93365108 -0.95062882]
mat_Sqrt:  [[ 5.33889384  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01505967 -0.00654041 -0.05788478]
Stock Position:  -0.015059670654137686
Bond Position:  [-0.83217012]


portfolio before change:  [-2.27486633]
curr_Stock_Price:  95.7917485219931
curr_Factors:  [95.79174852 -1.66241053 -0.95889158]
mat_Sqrt:  [[ 6.96483868  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02187383 -0.04663634 -0.27731357]
Stock Position:  -0.021873825100468893
Bond Position:  [-0.17953438]


portfolio before change:  [-2.26722886]
curr_Stock_Price:  95.44156242919236
curr_Factors:  [95.44156243 -1.46133283 -0.9450077 ]
mat_Sqrt:  [[ 8.60353884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01826828 0.03315016 0.6295055 ]
Stock Position:  0.018268275207203317
Bond Position:  [-4.01078159]


portfolio before change:  [-2.2523478]
curr_Stock_Price:  96.28359286398712
curr_Factors:  [96.28359286 -1.60462513 -0.96173872]
mat_Sqrt:  [[ 7.39596126  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0151041  -0.0382818  -0.45383684]
Stock Position:  0.01510409688078177
Bond Position:  [-3.70662451]


portfolio before change:  [-2.26016336]
curr_Stock_Price:  95.79682360439932
curr_Factors:  [95.7968236  -1.32417443 -0.95174306]
mat_Sqrt:  [[ 9.83858638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01134042 0.00084981 0.15919063]
Stock Position:  0.011340419807477098
Bond Position:  [-3.34653956]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.26013852]
Stock Price:  95.83590369170406
PL:  [-2.26013852]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-3.32046515e-03 -7.78596154e-02  1.14229053e-02]
 [-2.05371847e-01  1.07876757e-01 -3.62080561e-01]
 [-9.08337858e-03  2.06553399e-02  4.00670721e-02]
 [-5.20409362e-03 -1.41698676e-02  4.16499464e-02]
 [ 1.32152967e-01 -1.11007505e-01 -9.32355871e-02]
 [-1.29699860e-01 -1.67239559e-01  7.84305563e-02]
 [-5.42428538e-02 -1.56961559e-01  2.31542706e-03]
 [ 1.45728862e-02  6.84255061e-01  9.14179354e-02]
 [ 2.43625713e-01 -2.32371603e-02  2.48981493e-01]
 [ 4.27590702e-01  1.63743290e-01  2.70503203e-01]
 [-1.62959427e-01 -1.54505351e-01  6.51793205e-02]
 [-8.49828309e-02 -1.96513476e-02  8.64775779e-02]
 [ 1.47442297e-02 -9.64734663e-02  1.24932275e-01]
 [ 8.15557213e-03  4.55001282e-02 -2.96105774e-01]
 [-3.74632797e-02  1.06779695e-01 -4.77957755e-02]
 [-4.80471165e-02 -4.21712185e-02  8.56331448e-03]
 [ 4.69275030e-02  1.15543197e-01 -2.36015044e-01]
 [ 3.12260842e-02 -4.14927883e-02 -5.71152256e-02]
 [ 5.27999923e-02  4.68584073e-02 -2.71003752e-01]
 [-6.45000363e-02  2.55189057e-02 -5.77733281e-02]
 [-5.03000419e-02  6.09785135e-01 -5.98842982e-01]
 [ 4.22313954e-01  2.37516442e-01  5.36070774e-02]
 [-5.71504763e-03  1.41985367e-01 -4.58554810e-02]
 [-4.76579911e-02 -1.49789050e-01 -2.76855257e-02]
 [ 2.52557893e-02 -2.37869379e-02 -1.04922841e-02]
 [-2.47452010e-02  1.26923770e-02  5.90976336e-02]
 [ 8.51167145e-02 -2.28064303e-02  8.27271498e-02]
 [ 1.62296977e-01 -5.74644452e-02  1.84275207e-01]
 [-4.26358164e-02 -4.42655211e-03 -5.26475457e-02]
 [-5.93456865e-02 -1.35862857e-02  4.07435613e-02]
 [-4.22357350e-02 -6.08594993e-02 -4.08694490e-02]
 [ 2.64432454e-02 -6.04557966e-02 -1.27434012e-01]
 [ 1.26520442e-02  2.05592054e-03  1.57825600e-01]
 [ 6.39599613e-04 -9.01509197e-02 -1.50812410e-01]
 [ 4.19219090e-02  2.03157052e-01 -5.23811031e-02]
 [ 2.50964388e-03  2.20147449e-02  8.50643756e-02]
 [ 4.26888193e-01 -2.55743801e-01  2.76747178e-01]
 [-9.83975698e-02  3.89570664e-02  4.53798686e-02]
 [ 3.30708477e-01 -4.00922895e-02  5.17604223e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.90080678]
curr_Stock_Price:  100.063935295972
curr_Factors:  [100.0639353   -1.25557657  -1.02776631]
mat_Sqrt:  [[10.20080313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00165495 -0.02512908  0.03258637]
Stock Position:  -0.0016549483012383557
Bond Position:  [3.06640742]


portfolio before change:  [2.90103126]
curr_Stock_Price:  100.15991704401486
curr_Factors:  [100.15991704  -1.14405788  -1.0339015 ]
mat_Sqrt:  [[11.34535823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02267544  0.03481707 -1.03291506]
Stock Position:  -0.022675439264362315
Bond Position:  [5.17220138]


portfolio before change:  [2.89271906]
curr_Stock_Price:  100.55500392675795
curr_Factors:  [100.55500393  -1.18436935  -1.02321416]
mat_Sqrt:  [[11.05763764  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00029948 0.00666648 0.1143002 ]
Stock Position:  0.0002994791439122297
Bond Position:  [2.86260493]


portfolio before change:  [2.8931575]
curr_Stock_Price:  100.82409046924032
curr_Factors:  [100.82409047  -0.97008442  -1.02980638]
mat_Sqrt:  [[13.64654695  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.96964487e-05 -4.57330511e-03  1.18815704e-01]
Stock Position:  2.9696448725035196e-05
Bond Position:  [2.89016338]


portfolio before change:  [2.89352368]
curr_Stock_Price:  100.98871143321865
curr_Factors:  [100.98871143  -1.01153107  -1.069823  ]
mat_Sqrt:  [[12.59946906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00717983 -0.03582752 -0.26597518]
Stock Position:  0.007179827979505842
Bond Position:  [2.1684421]


portfolio before change:  [2.88964354]
curr_Stock_Price:  100.41053419255844
curr_Factors:  [100.41053419  -0.76258171  -1.05937513]
mat_Sqrt:  [[16.23728731  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00910423 -0.05397634  0.22374055]
Stock Position:  -0.009104225314192162
Bond Position:  [3.80380366]


portfolio before change:  [2.8875557]
curr_Stock_Price:  100.692089168795
curr_Factors:  [100.69208917  -1.04066397  -1.04947829]
mat_Sqrt:  [[12.45254456  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00689095 -0.05065913  0.00660527]
Stock Position:  -0.0068909501177949585
Bond Position:  [3.58141986]


portfolio before change:  [2.88774597]
curr_Stock_Price:  100.72944761553308
curr_Factors:  [100.72944762  -0.97642745  -1.04553787]
mat_Sqrt:  [[13.33607625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01296532 0.22084237 0.26078992]
Stock Position:  0.01296531830551004
Bond Position:  [1.58175662]


portfolio before change:  [2.88150391]
curr_Stock_Price:  100.23275345161514
curr_Factors:  [100.23275345  -0.97106554  -1.06182606]
mat_Sqrt:  [[13.12611049  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02207094 -0.00749976  0.7102749 ]
Stock Position:  0.02207093887403615
Bond Position:  [0.66927293]


portfolio before change:  [2.88192691]
curr_Stock_Price:  100.24812857685491
curr_Factors:  [100.24812858  -0.7996633   -1.05475171]
mat_Sqrt:  [[15.69329252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.032895   0.05284792 0.77167035]
Stock Position:  0.03289500250632631
Bond Position:  [-0.41573553]


portfolio before change:  [2.90304178]
curr_Stock_Price:  100.89159527783828
curr_Factors:  [100.89159528  -0.69355652  -1.06107037]
mat_Sqrt:  [[17.45139756  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01038272 -0.04986639  0.18593846]
Stock Position:  -0.010382723004231834
Bond Position:  [3.95057127]


portfolio before change:  [2.88865115]
curr_Stock_Price:  102.32517705150761
curr_Factors:  [102.32517705  -0.51149584  -1.0887889 ]
mat_Sqrt:  [[20.65321526  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00345428 -0.00634245  0.24669646]
Stock Position:  -0.003454279777071506
Bond Position:  [3.24211094]


portfolio before change:  [2.88449935]
curr_Stock_Price:  103.64443499902806
curr_Factors:  [103.644435    -0.40731359  -1.11043396]
mat_Sqrt:  [[22.71938676  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090466 -0.03113668  0.35639701]
Stock Position:  0.0009046617318824994
Bond Position:  [2.7907362]


portfolio before change:  [2.88341787]
curr_Stock_Price:  102.06334661223369
curr_Factors:  [102.06334661  -0.26757388  -1.11191509]
mat_Sqrt:  [[25.69007398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00167376  0.0146851  -0.84470735]
Stock Position:  -0.0016737628331825575
Bond Position:  [3.0542477]


portfolio before change:  [2.88893036]
curr_Stock_Price:  98.99798678948918
curr_Factors:  [98.99798679 -0.1861346  -1.10074099]
mat_Sqrt:  [[27.33653052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093001  0.034463   -0.13634804]
Stock Position:  -0.0009300096656167776
Bond Position:  [2.98099944]


portfolio before change:  [2.89194066]
curr_Stock_Price:  96.1618300343686
curr_Factors:  [ 9.61618300e+01 -6.94866520e-02 -1.07363357e+00]
mat_Sqrt:  [[30.65857149  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00179093 -0.0136107   0.02442875]
Stock Position:  -0.001790928230863328
Bond Position:  [3.0641596]


portfolio before change:  [2.89337875]
curr_Stock_Price:  95.57272577064667
curr_Factors:  [ 9.55727258e+01  5.36149869e-02 -1.04345131e+00]
mat_Sqrt:  [[35.51841023  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.28865145e-04  3.72914064e-02 -6.73285226e-01]
Stock Position:  0.0006288651454738484
Bond Position:  [2.83327639]


portfolio before change:  [2.89428159]
curr_Stock_Price:  96.44518538624789
curr_Factors:  [ 9.64451854e+01 -4.89059776e-02 -1.03643388e+00]
mat_Sqrt:  [[32.57792676  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00034065 -0.01339174 -0.16293384]
Stock Position:  0.000340654203580768
Bond Position:  [2.86142713]


portfolio before change:  [2.89513513]
curr_Stock_Price:  97.90073499069393
curr_Factors:  [97.90073499 -0.22357612 -1.04964605]
mat_Sqrt:  [[27.40517567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.57123527e-04  1.51234859e-02 -7.73098271e-01]
Stock Position:  0.000257123527194601
Bond Position:  [2.86996255]


portfolio before change:  [2.89550947]
curr_Stock_Price:  97.96131339043423
curr_Factors:  [97.96131339 -0.17580557 -1.03197422]
mat_Sqrt:  [[29.27672547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.002428    0.00823619 -0.16481122]
Stock Position:  -0.0024280018200213195
Bond Position:  [3.13335972]


portfolio before change:  [2.88725395]
curr_Stock_Price:  101.52276730174823
curr_Factors:  [101.5227673   -0.24678667  -1.00824908]
mat_Sqrt:  [[28.94065428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.66086377e-03  1.96807306e-01 -1.70833234e+00]
Stock Position:  -0.001660863774529431
Bond Position:  [3.05586944]


portfolio before change:  [2.88664601]
curr_Stock_Price:  102.11881118764099
curr_Factors:  [102.11881119  -0.31608095  -1.02571421]
mat_Sqrt:  [[26.69141002  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01804848 0.0766581  0.15292607]
Stock Position:  0.018048476757087095
Bond Position:  [1.04355702]


portfolio before change:  [2.90882022]
curr_Stock_Price:  103.34017529420117
curr_Factors:  [103.34017529  -0.51164579  -1.02493796]
mat_Sqrt:  [[22.22999435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00062561  0.04582558 -0.13081292]
Stock Position:  0.0006256134376155459
Bond Position:  [2.84416922]


portfolio before change:  [2.90863436]
curr_Stock_Price:  102.4747692931799
curr_Factors:  [102.47476929  -0.41948006  -1.00127487]
mat_Sqrt:  [[24.75089597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00338916 -0.04834421 -0.0789791 ]
Stock Position:  -0.0033891636563752304
Bond Position:  [3.25593812]


portfolio before change:  [2.90551761]
curr_Stock_Price:  103.51448504574984
curr_Factors:  [103.51448505  -0.3060663   -0.9910976 ]
mat_Sqrt:  [[28.29111081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00064538 -0.0076772  -0.02993157]
Stock Position:  0.0006453819558586606
Bond Position:  [2.83871123]


portfolio before change:  [2.90636293]
curr_Stock_Price:  104.27443708146092
curr_Factors:  [104.27443708  -0.48523038  -0.97970852]
mat_Sqrt:  [[24.09699987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041877  0.00409645  0.1685891 ]
Stock Position:  -0.00041877107082682495
Bond Position:  [2.95003005]


portfolio before change:  [2.90649036]
curr_Stock_Price:  104.8507667000451
curr_Factors:  [104.8507667   -0.5682409   -0.97372563]
mat_Sqrt:  [[22.43386271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00433933 -0.00736074  0.23599753]
Stock Position:  0.004339332079194528
Bond Position:  [2.45150806]


portfolio before change:  [2.90462286]
curr_Stock_Price:  104.3497778507154
curr_Factors:  [104.34977785  -0.49011269  -0.97797351]
mat_Sqrt:  [[24.03863432  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00782832 -0.01854657  0.52568587]
Stock Position:  0.007828319709532752
Bond Position:  [2.08773943]


portfolio before change:  [2.90645783]
curr_Stock_Price:  104.55084191230056
curr_Factors:  [104.55084191  -0.47387329  -0.95789907]
mat_Sqrt:  [[24.97564425  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217356 -0.00142866 -0.15018879]
Stock Position:  -0.0021735582572532867
Bond Position:  [3.13370518]


portfolio before change:  [2.90617584]
curr_Stock_Price:  104.86080956993845
curr_Factors:  [104.86080957  -0.72304526  -0.93232381]
mat_Sqrt:  [[20.03067347  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268599 -0.00438495  0.11623004]
Stock Position:  -0.00268599210564495
Bond Position:  [3.18783115]


portfolio before change:  [2.90664085]
curr_Stock_Price:  104.83604868631288
curr_Factors:  [104.83604869  -0.88116748  -0.93187011]
mat_Sqrt:  [[17.10481659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00368324 -0.01964232 -0.11658916]
Stock Position:  -0.0036832356109787506
Bond Position:  [3.29277672]


portfolio before change:  [2.90745432]
curr_Stock_Price:  104.72694706093648
curr_Factors:  [104.72694706  -0.84797094  -0.92512592]
mat_Sqrt:  [[17.78329603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066971 -0.01951202 -0.36353377]
Stock Position:  -0.0006697071874690859
Bond Position:  [2.97759071]


portfolio before change:  [2.90780232]
curr_Stock_Price:  104.76311933258403
curr_Factors:  [104.76311933  -0.98573069  -0.89910942]
mat_Sqrt:  [[15.9086293   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00284674 0.00066355 0.45023251]
Stock Position:  0.002846739474512921
Bond Position:  [2.60956901]


portfolio before change:  [2.9081694]
curr_Stock_Price:  104.77747584724825
curr_Factors:  [104.77747585  -0.81963645  -0.89988008]
mat_Sqrt:  [[18.77117224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258624 -0.02909608 -0.43022583]
Stock Position:  -0.002586244129764193
Bond Position:  [3.17914954]


portfolio before change:  [2.90573794]
curr_Stock_Price:  105.87129515898383
curr_Factors:  [105.87129516  -0.66517939  -0.89773097]
mat_Sqrt:  [[22.18272423  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00327728  0.06556866 -0.14942871]
Stock Position:  0.003277276492906862
Bond Position:  [2.55876843]


portfolio before change:  [2.90452142]
curr_Stock_Price:  105.40249677355658
curr_Factors:  [105.40249677  -0.67382231  -0.91586043]
mat_Sqrt:  [[21.501089    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0011333  0.00710523 0.24266499]
Stock Position:  0.0011332950535687233
Bond Position:  [2.78506929]


portfolio before change:  [2.90639928]
curr_Stock_Price:  106.75228049393361
curr_Factors:  [106.75228049  -0.62653423  -0.93272842]
mat_Sqrt:  [[22.44905138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01920685 -0.08254096  0.78948267]
Stock Position:  0.019206846737813213
Bond Position:  [0.85602459]


portfolio before change:  [2.88106207]
curr_Stock_Price:  105.42753306766365
curr_Factors:  [105.42753307  -0.67010709  -0.93025905]
mat_Sqrt:  [[21.27765975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00381538  0.01257334  0.12945613]
Stock Position:  -0.003815380356747398
Bond Position:  [3.28330821]


portfolio before change:  [2.87633376]
curr_Stock_Price:  106.77438398721047
curr_Factors:  [106.77438399  -0.69345385  -0.94669733]
mat_Sqrt:  [[20.70896857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01608435 -0.01293973  0.14765808]
Stock Position:  0.016084346423351423
Bond Position:  [1.15893758]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.87259955]
Stock Price:  106.53321239598351
PL:  [-3.66061285]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 7.07821269e-02 -3.68119281e-02  3.88117437e-03]
 [-2.14913688e-01  6.28533877e-02 -2.50998529e-01]
 [-3.73446057e-02  4.44829213e-02  2.00258055e-02]
 [ 6.46445143e-02  9.88854747e-02  4.03855012e-02]
 [-1.25892557e-01  2.41538340e-01 -3.68002001e-02]
 [-7.57857880e-02 -1.52451754e-01  1.54179964e-01]
 [-6.16493926e-02 -1.73935020e-01  7.30967372e-02]
 [-7.33193645e-02  8.60665583e-01  2.37621670e-01]
 [ 3.14021389e-01  2.74768097e-03  2.71717511e-01]
 [ 3.21994647e-01  1.19696415e-01  1.81309547e-01]
 [-5.39260860e-02 -6.70816153e-02  9.02669938e-02]
 [-1.09028851e-01 -2.04832918e-02  8.34967079e-02]
 [ 2.70236934e-03 -4.45816109e-02  1.38842842e-01]
 [ 6.03908062e-03 -4.45217387e-02  6.17236469e-02]
 [-8.70838503e-02  1.95766499e-01 -3.96693950e-02]
 [-9.30065307e-02 -5.19796109e-02 -1.00066706e-02]
 [ 4.95268584e-02  9.34305644e-02 -1.45574751e-01]
 [ 2.22658620e-02 -4.36631863e-02 -5.08127837e-02]
 [ 4.24097225e-02  9.33556890e-02 -2.33260342e-01]
 [-9.44704237e-02 -1.51628727e-02 -2.48864939e-02]
 [-3.92326373e-02  4.79172297e-01 -4.18245525e-01]
 [ 2.00996145e-01  1.31616617e-01  8.96471228e-02]
 [ 3.79502484e-02 -4.67680081e-02  7.89522593e-02]
 [ 2.62385781e-02  1.41128205e-01 -4.81664119e-02]
 [-2.84408876e-02 -7.97548366e-05 -6.53943227e-03]
 [-1.20215439e-01 -1.20395814e-02  2.21437207e-01]
 [-2.85486441e-02 -3.29557395e-02 -2.79875495e-03]
 [-7.16504823e-02  6.60979327e-02 -1.89489471e-01]
 [ 7.61718939e-02 -3.80471857e-02  1.31376763e-01]
 [ 2.58770630e-02  4.56354579e-02 -7.40481173e-02]
 [ 5.80715965e-02 -8.40629480e-03 -2.59248849e-02]
 [ 1.48885765e-03  1.15337162e-01 -1.13523068e-01]
 [ 5.98531984e-03  2.61878915e-02  1.36819886e-02]
 [ 2.25866419e-02 -1.09837463e-01  3.72853018e-02]
 [-4.86656187e-02  1.23241227e-01 -1.62438256e-02]
 [-2.72879812e-02 -7.91322642e-02 -8.08354299e-04]
 [ 3.90133316e-03  1.02280567e-01  1.14850330e-01]
 [ 4.81241475e-02 -6.84684438e-02 -6.97583689e-02]
 [ 9.83276427e-02  3.44947615e-03  6.36043937e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.15376231]
curr_Stock_Price:  99.67883830179939
curr_Factors:  [99.6788383  -0.74510054 -1.02402996]
mat_Sqrt:  [[16.99336372  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00376972 -0.011881    0.01107191]
Stock Position:  0.0037697165823431934
Bond Position:  [-0.52952328]


portfolio before change:  [-0.15429609]
curr_Stock_Price:  99.55480116803241
curr_Factors:  [99.55480117 -0.78928211 -1.04927585]
mat_Sqrt:  [[15.83385376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01599855  0.02028584 -0.71602894]
Stock Position:  -0.015998547065456423
Bond Position:  [1.43843608]


portfolio before change:  [-0.15264653]
curr_Stock_Price:  99.46293386058493
curr_Factors:  [99.46293386 -0.65831945 -1.09026757]
mat_Sqrt:  [[17.30850553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00139682  0.0143568   0.05712805]
Stock Position:  -0.0013968171270774814
Bond Position:  [-0.013715]


portfolio before change:  [-0.15302981]
curr_Stock_Price:  99.73610475487577
curr_Factors:  [99.73610475 -0.45795193 -1.11383444]
mat_Sqrt:  [[20.71258265  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00449355 0.03191515 0.11520859]
Stock Position:  0.00449355276985827
Bond Position:  [-0.60119926]


portfolio before change:  [-0.15881226]
curr_Stock_Price:  98.46599744958822
curr_Factors:  [98.46599745 -0.39736922 -1.07897871]
mat_Sqrt:  [[22.49658112  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00373837  0.07795616 -0.10498073]
Stock Position:  -0.0037383706589174137
Bond Position:  [0.20929013]


portfolio before change:  [-0.16238696]
curr_Stock_Price:  99.42921296971726
curr_Factors:  [99.42921297 -0.48246983 -1.09972645]
mat_Sqrt:  [[20.43501157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00369136 -0.04920359  0.43983252]
Stock Position:  -0.0036913616835930908
Bond Position:  [0.20464223]


portfolio before change:  [-0.16284031]
curr_Stock_Price:  99.55895911860443
curr_Factors:  [99.55895912 -0.23453942 -1.11118429]
mat_Sqrt:  [[25.92029651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00317253 -0.05613729  0.20852465]
Stock Position:  -0.003172530100719607
Bond Position:  [0.15301348]


portfolio before change:  [-0.16238407]
curr_Stock_Price:  99.42117657992628
curr_Factors:  [99.42117658 -0.16133703 -1.13660865]
mat_Sqrt:  [[27.15115134  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00555658 0.27777862 0.67786848]
Stock Position:  0.005556581386808275
Bond Position:  [-0.71482593]


portfolio before change:  [-0.16711736]
curr_Stock_Price:  98.5854221579135
curr_Factors:  [98.58542216 -0.20137724 -1.17141268]
mat_Sqrt:  [[24.98144823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01481285 0.00088681 0.77513443]
Stock Position:  0.014812846643836893
Bond Position:  [-1.6274481]


portfolio before change:  [-0.1718282]
curr_Stock_Price:  98.28113264301133
curr_Factors:  [98.28113264 -0.44891659 -1.15170839]
mat_Sqrt:  [[19.83022112  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.019336   0.03863185 0.51722567]
Stock Position:  0.01933600381642058
Bond Position:  [-2.07219256]


portfolio before change:  [-0.18135464]
curr_Stock_Price:  97.80185055915092
curr_Factors:  [97.80185056 -0.46914297 -1.18892593]
mat_Sqrt:  [[18.6318894   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264028 -0.0216505   0.25750661]
Stock Position:  -0.0026402792226592822
Bond Position:  [0.07686955]


portfolio before change:  [-0.17780487]
curr_Stock_Price:  96.46102128671346
curr_Factors:  [96.46102129 -0.3357312  -1.17383265]
mat_Sqrt:  [[21.31849815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00451093 -0.00661095  0.23819287]
Stock Position:  -0.004510931825730602
Bond Position:  [0.25732422]


portfolio before change:  [-0.18446929]
curr_Stock_Price:  97.94554689830962
curr_Factors:  [97.9455469  -0.49687867 -1.21329505]
mat_Sqrt:  [[17.71192193  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012389  -0.01438865  0.39607998]
Stock Position:  0.0012389035227950006
Bond Position:  [-0.30581438]


portfolio before change:  [-0.1861364]
curr_Stock_Price:  96.63077284609267
curr_Factors:  [96.63077285 -0.41674764 -1.20501543]
mat_Sqrt:  [[19.08941845  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0005003  -0.01436933  0.17608038]
Stock Position:  0.0005002983956420052
Bond Position:  [-0.23448062]


portfolio before change:  [-0.18607848]
curr_Stock_Price:  96.80514208756075
curr_Factors:  [96.80514209 -0.23212396 -1.22346194]
mat_Sqrt:  [[22.58112141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244543  0.06318337 -0.11316574]
Stock Position:  -0.0024454349013392734
Bond Position:  [0.0506522]


portfolio before change:  [-0.18212252]
curr_Stock_Price:  95.19004175787694
curr_Factors:  [95.19004176 -0.28908987 -1.21464891]
mat_Sqrt:  [[21.16050667  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00499324 -0.01677635 -0.02854625]
Stock Position:  -0.004993237122307069
Bond Position:  [0.29318393]


portfolio before change:  [-0.18755793]
curr_Stock_Price:  96.2859351756991
curr_Factors:  [96.28593518 -0.35306838 -1.23244759]
mat_Sqrt:  [[19.72341054  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00197141  0.03015458 -0.41528425]
Stock Position:  0.001971412128624237
Bond Position:  [-0.37737719]


portfolio before change:  [-0.18873712]
curr_Stock_Price:  95.71171931852699
curr_Factors:  [95.71171932 -0.4686143  -1.26703969]
mat_Sqrt:  [[16.87252839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00017668 -0.01409223 -0.14495473]
Stock Position:  0.00017667982914678357
Bond Position:  [-0.20564745]


portfolio before change:  [-0.18858556]
curr_Stock_Price:  96.71506498558801
curr_Factors:  [96.71506499 -0.54669188 -1.29552033]
mat_Sqrt:  [[15.32609561  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090381  0.03013042 -0.66542683]
Stock Position:  0.0009038051984673987
Bond Position:  [-0.27599713]


portfolio before change:  [-0.19019493]
curr_Stock_Price:  94.97257246992218
curr_Factors:  [94.97257247 -0.31745658 -1.29266792]
mat_Sqrt:  [[18.98147751  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00540766 -0.0048938  -0.07099424]
Stock Position:  -0.0054076647280648866
Bond Position:  [0.3233849]


portfolio before change:  [-0.19548151]
curr_Stock_Price:  95.95765573769577
curr_Factors:  [95.95765574 -0.4344808  -1.25366419]
mat_Sqrt:  [[17.73893642  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00151058  0.15465219 -1.19313807]
Stock Position:  -0.0015105760283101305
Bond Position:  [-0.05053017]


portfolio before change:  [-0.19554806]
curr_Stock_Price:  95.99753338815235
curr_Factors:  [95.99753339 -0.549377   -1.23732591]
mat_Sqrt:  [[16.08069663  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01530788 0.04247908 0.25573829]
Stock Position:  0.015307882632831232
Bond Position:  [-1.66506703]


portfolio before change:  [-0.20300251]
curr_Stock_Price:  95.52416234662977
curr_Factors:  [95.52416235 -0.53060515 -1.26429339]
mat_Sqrt:  [[15.87079598  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00280514 -0.01509431  0.22522882]
Stock Position:  0.0028051416749534145
Bond Position:  [-0.47096132]


portfolio before change:  [-0.20040965]
curr_Stock_Price:  96.46947594557666
curr_Factors:  [96.46947595 -0.82020401 -1.2993489 ]
mat_Sqrt:  [[11.5845665   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00390298  0.04554893 -0.13740537]
Stock Position:  0.0039029794198854103
Bond Position:  [-0.57692803]


portfolio before change:  [-0.1960478]
curr_Stock_Price:  97.60552423768387
curr_Factors:  [97.60552424 -0.77597893 -1.31439833]
mat_Sqrt:  [[12.06799407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.46868066e-03 -2.57407628e-05 -1.86551800e-02]
Stock Position:  -0.0024686806561325094
Bond Position:  [0.04490907]


portfolio before change:  [-0.19569433]
curr_Stock_Price:  97.46461768916953
curr_Factors:  [97.46461769 -0.6736732  -1.32863822]
mat_Sqrt:  [[13.15994821  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00588698 -0.00388576  0.63169872]
Stock Position:  -0.005886978182010084
Bond Position:  [0.37807775]


portfolio before change:  [-0.19909917]
curr_Stock_Price:  98.05101468996894
curr_Factors:  [98.05101469 -0.73858195 -1.3336333 ]
mat_Sqrt:  [[12.34526583  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0029037  -0.01063642 -0.00798407]
Stock Position:  -0.0029037041605601975
Bond Position:  [0.08561197]


portfolio before change:  [-0.19782845]
curr_Stock_Price:  97.61707865897483
curr_Factors:  [97.61707866 -0.59816481 -1.31713698]
mat_Sqrt:  [[14.37873931  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00673478  0.02133302 -0.54056072]
Stock Position:  -0.006734782001431692
Bond Position:  [0.45960129]


portfolio before change:  [-0.19287074]
curr_Stock_Price:  96.88947454175039
curr_Factors:  [96.88947454 -0.47658348 -1.29830134]
mat_Sqrt:  [[16.42305388  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00579811 -0.01227968  0.37478134]
Stock Position:  0.0057981125081062405
Bond Position:  [-0.75464682]


portfolio before change:  [-0.19853216]
curr_Stock_Price:  95.92932067462272
curr_Factors:  [95.92932067 -0.40500286 -1.31089011]
mat_Sqrt:  [[17.24838834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00116401  0.01472878 -0.21123867]
Stock Position:  0.0011640132836542047
Bond Position:  [-0.31019516]


portfolio before change:  [-0.19860746]
curr_Stock_Price:  95.89794377460693
curr_Factors:  [95.89794377 -0.23637864 -1.30387065]
mat_Sqrt:  [[20.55358228  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00248442 -0.00271312 -0.07395648]
Stock Position:  0.0024844220852299473
Bond Position:  [-0.43685843]


portfolio before change:  [-0.19753604]
curr_Stock_Price:  96.35118047991801
curr_Factors:  [96.35118048 -0.37794764 -1.3317171 ]
mat_Sqrt:  [[17.43247598  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.06649108e-04  3.72249090e-02 -3.23849715e-01]
Stock Position:  0.0001066491079769442
Bond Position:  [-0.2078118]


portfolio before change:  [-0.19731253]
curr_Stock_Price:  98.6904890453227
curr_Factors:  [98.69048905 -0.40355953 -1.35371257]
mat_Sqrt:  [[17.02557257  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00082956 0.00845211 0.03903091]
Stock Position:  0.0008295594744739029
Bond Position:  [-0.27918216]


portfolio before change:  [-0.19705827]
curr_Stock_Price:  99.03906344351418
curr_Factors:  [ 9.90390634e+01 -6.70929241e-02 -1.36402571e+00]
mat_Sqrt:  [[23.67443357  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0003285  -0.03544989  0.10636459]
Stock Position:  0.0003284975759305063
Bond Position:  [-0.22959236]


portfolio before change:  [-0.19752272]
curr_Stock_Price:  97.71256982470162
curr_Factors:  [ 9.77125698e+01  1.97636865e-02 -1.35143229e+00]
mat_Sqrt:  [[25.79966745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103974  0.03977594 -0.04633911]
Stock Position:  -0.0010397368705437064
Bond Position:  [-0.09592736]


portfolio before change:  [-0.19738291]
curr_Stock_Price:  97.56657315608948
curr_Factors:  [97.56657316  0.13826202 -1.34364912]
mat_Sqrt:  [[29.22860471  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149189 -0.02553983 -0.00230601]
Stock Position:  -0.0014918875536979001
Bond Position:  [-0.05182456]


portfolio before change:  [-0.19643609]
curr_Stock_Price:  96.92758573697327
curr_Factors:  [96.92758574 -0.15249097 -1.3490633 ]
mat_Sqrt:  [[21.59387898  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00223318 0.03301091 0.32763602]
Stock Position:  0.0022331787647834086
Bond Position:  [-0.41289272]


portfolio before change:  [-0.19381432]
curr_Stock_Price:  98.12470587021117
curr_Factors:  [98.12470587 -0.38290657 -1.39526659]
mat_Sqrt:  [[16.57782596  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120092 -0.0220981  -0.19900121]
Stock Position:  0.0012009245073399278
Bond Position:  [-0.31165469]


portfolio before change:  [-0.19469983]
curr_Stock_Price:  97.41979216459337
curr_Factors:  [97.41979216 -0.37977917 -1.36495588]
mat_Sqrt:  [[17.01838693  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.006582   0.00111331 0.18144563]
Stock Position:  0.006581996109251159
Bond Position:  [-0.83591652]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.19922038]
Stock Price:  96.74886233942708
PL:  [-0.19922038]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.39389633e-01 -9.37199109e-02  2.51085773e-02]
 [-1.45544843e-01  9.84220718e-02 -2.77822408e-01]
 [-4.32523105e-02  5.09676966e-02  1.70376817e-02]
 [ 8.04477357e-02  8.55272079e-02  6.51250806e-02]
 [-7.58099629e-02  1.91243145e-01 -4.27969293e-02]
 [-6.07023980e-02 -1.44283440e-01  1.98121151e-01]
 [-6.29397737e-02 -1.58832600e-01  4.91839950e-02]
 [-4.34558372e-02  8.35816915e-01  1.90252469e-01]
 [ 1.29986267e-01 -7.51371818e-02  1.10165555e-01]
 [ 1.97115920e-01  6.76062328e-02  7.58284281e-02]
 [-1.56176269e-01 -1.63779271e-01  5.54220609e-02]
 [-6.31347355e-02 -1.88954471e-02  8.91859818e-02]
 [ 2.62283050e-03 -3.58724031e-02  1.35029926e-01]
 [ 9.04849574e-03 -4.18963783e-02 -1.17374298e-01]
 [ 1.14906912e-01 -8.37622002e-02 -1.05738874e-01]
 [-1.15628945e-01 -6.50605259e-02  9.60491283e-02]
 [ 5.17079200e-02  1.64811353e-02 -2.93466650e-02]
 [-3.97421771e-02 -6.02718090e-02 -6.34637014e-03]
 [ 3.69835300e-02  5.55691402e-02 -2.33022739e-01]
 [-1.51825263e-02  2.67478218e-02 -5.97862704e-02]
 [-4.18724853e-02  5.30656763e-01 -5.00804324e-01]
 [ 3.48377887e-01  2.02138283e-01  6.56470448e-02]
 [ 2.63496897e-04 -2.57294531e-02  6.50773306e-02]
 [-6.76592132e-03 -9.25798615e-03 -7.94424214e-02]
 [-5.93238875e-03  1.99576874e-02 -8.74430803e-03]
 [-8.17732468e-02 -1.60901335e-02  2.13390040e-01]
 [-2.42057311e-02 -3.27683255e-02 -1.12815939e-03]
 [-4.65772592e-02  2.28325188e-02 -2.58168722e-01]
 [-4.31126295e-02 -4.28962308e-02  2.97956023e-02]
 [-8.78510830e-02 -1.18745470e-03  3.75371004e-02]
 [-2.64932745e-02 -4.18668341e-02 -7.87031724e-03]
 [ 2.58658361e-02  6.70236579e-02 -4.62562964e-02]
 [-3.77323122e-02  2.35737853e-02 -5.78919781e-02]
 [ 1.08879318e-02 -7.05510522e-02 -1.51247338e-02]
 [-1.89573852e-02  3.26019340e-02  4.88414986e-02]
 [ 8.32699652e-02  2.08859782e-02  1.77199907e-01]
 [ 1.07408876e-01 -8.70971211e-02  3.68483163e-02]
 [-7.05956545e-02  9.21168890e-03  3.63746164e-02]
 [ 1.39258251e-01 -7.88718304e-04  1.08113801e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.07425441]
curr_Stock_Price:  100.96830937772103
curr_Factors:  [100.96830938  -1.1703957   -1.00682479]
mat_Sqrt:  [[11.44538061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02213949 -0.03024797  0.07162778]
Stock Position:  -0.022139487659313523
Bond Position:  [12.30964105]


portfolio before change:  [10.08237812]
curr_Stock_Price:  100.67088108320424
curr_Factors:  [100.67088108  -1.25248081  -0.98785683]
mat_Sqrt:  [[10.7136535   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01700305  0.03176559 -0.79255   ]
Stock Position:  -0.01700304972461118
Bond Position:  [11.79409012]


portfolio before change:  [10.10317649]
curr_Stock_Price:  99.53437787070837
curr_Factors:  [99.53437787 -1.00032589 -0.9774593 ]
mat_Sqrt:  [[13.77310661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213247  0.01644975  0.04860376]
Stock Position:  -0.002132472482821842
Bond Position:  [10.31543082]


portfolio before change:  [10.10519587]
curr_Stock_Price:  99.19211301683796
curr_Factors:  [99.19211302 -0.93057474 -1.00413228]
mat_Sqrt:  [[14.32994614  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00775994 0.02760379 0.18578373]
Stock Position:  0.007759938820300435
Bond Position:  [9.33547115]


portfolio before change:  [10.10333394]
curr_Stock_Price:  98.801782785415
curr_Factors:  [98.80178279 -0.97490642 -1.00284721]
mat_Sqrt:  [[13.67216504  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332855  0.06172346 -0.12208773]
Stock Position:  -0.0033285515317775694
Bond Position:  [10.43220077]


portfolio before change:  [10.10561429]
curr_Stock_Price:  98.50848970189529
curr_Factors:  [98.5084897  -0.96626046 -1.03920881]
mat_Sqrt:  [[13.25895879  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00374938 -0.04656728  0.5651845 ]
Stock Position:  -0.0037493759595904706
Bond Position:  [10.47495965]


portfolio before change:  [10.10537197]
curr_Stock_Price:  98.92236510668192
curr_Factors:  [98.92236511 -0.82157963 -1.04524585]
mat_Sqrt:  [[15.29475358  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00557849 -0.051263    0.14030825]
Stock Position:  -0.005578494680004064
Bond Position:  [10.65720985]


portfolio before change:  [10.1101133]
curr_Stock_Price:  98.31125025337474
curr_Factors:  [98.31125025 -0.57482793 -1.03423678]
mat_Sqrt:  [[19.66958947  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0084389  0.26975875 0.54273734]
Stock Position:  0.008438900005213664
Bond Position:  [9.28047449]


portfolio before change:  [10.10875937]
curr_Stock_Price:  98.01333612317187
curr_Factors:  [98.01333612 -0.67766936 -1.04514926]
mat_Sqrt:  [[17.50147098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00783571 -0.02425042  0.31427167]
Stock Position:  0.007835707319028384
Bond Position:  [9.34075555]


portfolio before change:  [10.09877319]
curr_Stock_Price:  96.5898727628975
curr_Factors:  [96.58987276 -0.58323559 -1.0461331 ]
mat_Sqrt:  [[18.93676382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01195528 0.02181982 0.2163174 ]
Stock Position:  0.011955284433552888
Bond Position:  [8.94401379]


portfolio before change:  [10.12945815]
curr_Stock_Price:  99.06299512477841
curr_Factors:  [99.06299512 -0.76245832 -1.05816171]
mat_Sqrt:  [[16.04080733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01111506 -0.05285953  0.15810371]
Stock Position:  -0.011115063464590777
Bond Position:  [11.23054962]


portfolio before change:  [10.13463699]
curr_Stock_Price:  98.7233712254027
curr_Factors:  [98.72337123 -0.68967734 -1.04204649]
mat_Sqrt:  [[17.47197001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00279229 -0.00609848  0.25442278]
Stock Position:  -0.002792286168698686
Bond Position:  [10.4103009]


portfolio before change:  [10.13608941]
curr_Stock_Price:  98.66927575847295
curr_Factors:  [98.66927576 -0.40286404 -1.04501106]
mat_Sqrt:  [[23.19411326  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00098574 -0.01157777  0.38520279]
Stock Position:  0.00098573611281035
Bond Position:  [10.03882754]


portfolio before change:  [10.13900561]
curr_Stock_Price:  100.35457646309717
curr_Factors:  [100.35457646  -0.36711367  -1.01798331]
mat_Sqrt:  [[25.11870289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093406 -0.013522   -0.3348362 ]
Stock Position:  -0.0009340647459368035
Bond Position:  [10.23274328]


portfolio before change:  [10.13987714]
curr_Stock_Price:  100.79099167302658
curr_Factors:  [100.79099167  -0.5534055   -0.96825983]
mat_Sqrt:  [[22.00750768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0034636  -0.02703413 -0.30164358]
Stock Position:  0.003463598323713101
Bond Position:  [9.79077763]


portfolio before change:  [10.1414718]
curr_Stock_Price:  100.89803130013118
curr_Factors:  [100.8980313   -0.58118678  -0.94263143]
mat_Sqrt:  [[21.98350071  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00497207 -0.02099819  0.27400143]
Stock Position:  -0.004972066309685646
Bond Position:  [10.64314351]


portfolio before change:  [10.14646461]
curr_Stock_Price:  100.16144940591728
curr_Factors:  [100.16144941  -0.57327968  -0.93805264]
mat_Sqrt:  [[22.09720348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00222117  0.00531926 -0.08371787]
Stock Position:  0.0022211749438116298
Bond Position:  [9.92398851]


portfolio before change:  [10.14483583]
curr_Stock_Price:  98.86962741893286
curr_Factors:  [98.86962742 -0.81073189 -0.93118157]
mat_Sqrt:  [[17.32046289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00307963 -0.01945264 -0.01810443]
Stock Position:  -0.0030796264706780202
Bond Position:  [10.44931735]


portfolio before change:  [10.14780536]
curr_Stock_Price:  98.3295326748846
curr_Factors:  [98.32953267 -0.51541454 -0.9402111 ]
mat_Sqrt:  [[22.93579484  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.31780899e-05  1.79348629e-02 -6.64749013e-01]
Stock Position:  3.317808993399852e-05
Bond Position:  [10.14454298]


portfolio before change:  [10.14910261]
curr_Stock_Price:  99.2065645389303
curr_Factors:  [99.20656454 -0.52406679 -0.95292877]
mat_Sqrt:  [[22.65110485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00096801  0.00863282 -0.17055359]
Stock Position:  -0.0009680089139692652
Bond Position:  [10.24513545]


portfolio before change:  [10.15048359]
curr_Stock_Price:  99.10299519400822
curr_Factors:  [99.10299519 -0.49451467 -0.91102167]
mat_Sqrt:  [[24.30357182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00147217  0.17126873 -1.42865534]
Stock Position:  -0.001472165566429952
Bond Position:  [10.2963796]


portfolio before change:  [10.15360755]
curr_Stock_Price:  97.85528872390952
curr_Factors:  [97.85528872 -0.58103062 -0.89617656]
mat_Sqrt:  [[22.33785016  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01804289 0.06523985 0.18727275]
Stock Position:  0.018042888417316053
Bond Position:  [8.38801549]


portfolio before change:  [10.17036795]
curr_Stock_Price:  98.72609349668495
curr_Factors:  [98.7260935  -0.37301227 -0.90055567]
mat_Sqrt:  [[27.62666279  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00030027 -0.00830415  0.18564751]
Stock Position:  0.0003002660449043282
Bond Position:  [10.14072385]


portfolio before change:  [10.17143604]
curr_Stock_Price:  98.06142801760548
curr_Factors:  [98.06142802 -0.42520552 -0.90054744]
mat_Sqrt:  [[26.0453991   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095494 -0.002988   -0.22662712]
Stock Position:  -0.0009549408746520112
Bond Position:  [10.26507891]


portfolio before change:  [10.17267195]
curr_Stock_Price:  98.11096525583092
curr_Factors:  [98.11096526 -0.49454712 -0.90958778]
mat_Sqrt:  [[24.0940336   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00015122  0.00644132 -0.02494508]
Stock Position:  -0.00015121865183738697
Bond Position:  [10.18750816]


portfolio before change:  [10.17370763]
curr_Stock_Price:  99.68379414880046
curr_Factors:  [99.68379415 -0.57408079 -0.9136792 ]
mat_Sqrt:  [[22.51638175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184308 -0.00519307  0.60874239]
Stock Position:  -0.001843083519916122
Bond Position:  [10.35743319]


portfolio before change:  [10.17713032]
curr_Stock_Price:  98.52924119316137
curr_Factors:  [98.52924119 -0.41326782 -0.89869283]
mat_Sqrt:  [[26.53309235  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00117306 -0.01057593 -0.00321832]
Stock Position:  -0.0011730567144278968
Bond Position:  [10.29271071]


portfolio before change:  [10.17786629]
curr_Stock_Price:  98.99870066374447
curr_Factors:  [98.99870066 -0.31986676 -0.90490986]
mat_Sqrt:  [[29.08812758  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0032527   0.00736916 -0.7364835 ]
Stock Position:  -0.003252703710605437
Bond Position:  [10.49987973]


portfolio before change:  [10.17364636]
curr_Stock_Price:  100.69959350154559
curr_Factors:  [100.6995935   -0.61504505  -0.93319512]
mat_Sqrt:  [[21.41093105  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00213848 -0.0138447   0.08499856]
Stock Position:  -0.0021384770225577996
Bond Position:  [10.38899012]


portfolio before change:  [10.17543712]
curr_Stock_Price:  100.46949477417199
curr_Factors:  [100.46949477  -0.56778709  -0.93969354]
mat_Sqrt:  [[22.2507011   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361477 -0.00038325  0.1070829 ]
Stock Position:  -0.003614773408841497
Bond Position:  [10.53861158]


portfolio before change:  [10.17923166]
curr_Stock_Price:  99.78421592391985
curr_Factors:  [99.78421592 -0.82555696 -0.91350365]
mat_Sqrt:  [[17.53062582  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209039 -0.01351246 -0.02245182]
Stock Position:  -0.002090389037760207
Bond Position:  [10.38781949]


portfolio before change:  [10.18069626]
curr_Stock_Price:  99.70478349078869
curr_Factors:  [99.70478349 -0.87760467 -0.93445478]
mat_Sqrt:  [[16.28353057  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0018488   0.02163179 -0.13195634]
Stock Position:  0.0018487978306529977
Bond Position:  [9.99636228]


portfolio before change:  [10.18116778]
curr_Stock_Price:  99.28390947347155
curr_Factors:  [99.28390947 -0.86601524 -0.94452758]
mat_Sqrt:  [[16.23940506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00275487  0.00760841 -0.1651497 ]
Stock Position:  -0.002754872100306399
Bond Position:  [10.45468225]


portfolio before change:  [10.17578178]
curr_Stock_Price:  101.71339217829086
curr_Factors:  [101.71339218  -1.01864424  -0.94936386]
mat_Sqrt:  [[14.21291244  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046441 -0.02277025 -0.04314666]
Stock Position:  -0.00046440620996323874
Bond Position:  [10.22301811]


portfolio before change:  [10.17688719]
curr_Stock_Price:  102.08494131729836
curr_Factors:  [102.08494132  -0.79221125  -0.96356922]
mat_Sqrt:  [[17.63745485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.32264781e-04  1.05222290e-02  1.39331201e-01]
Stock Position:  -0.00013226478086597783
Bond Position:  [10.19038943]


portfolio before change:  [10.17825068]
curr_Stock_Price:  101.40742846000019
curr_Factors:  [101.40742846  -0.64351931  -0.97798427]
mat_Sqrt:  [[20.03824643  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0061734  0.00674092 0.50550201]
Stock Position:  0.006173398334657089
Bond Position:  [9.55222223]


portfolio before change:  [10.18871194]
curr_Stock_Price:  102.90857254318838
curr_Factors:  [102.90857254  -0.62621915  -0.99137594]
mat_Sqrt:  [[20.41450873  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00475896 -0.02811047  0.10511799]
Stock Position:  0.004758962517244756
Bond Position:  [9.6989739]


portfolio before change:  [10.18851291]
curr_Stock_Price:  102.61197870696363
curr_Factors:  [102.61197871  -0.86987626  -0.97779778]
mat_Sqrt:  [[16.1719884   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00378991  0.00297306  0.10376666]
Stock Position:  -0.0037899105183332913
Bond Position:  [10.57740312]


portfolio before change:  [10.18777696]
curr_Stock_Price:  103.15505322149382
curr_Factors:  [103.15505322  -0.92774485  -0.99596722]
mat_Sqrt:  [[15.06721453  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.06964623e-02 -2.54557738e-04  3.08418581e-01]
Stock Position:  0.010696462259190553
Bond Position:  [9.08438283]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.17832787]
Stock Price:  102.16550122373359
PL:  [8.01282665]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.76983934e-01 -5.49844652e-02  4.38352098e-03]
 [-7.09118549e-02  7.34217297e-02 -6.33505325e-02]
 [-1.99022260e-02  3.21056874e-02  3.24191761e-02]
 [ 1.08605224e-01  5.29241757e-02  1.16685005e-01]
 [ 6.75027735e-02 -7.90497462e-03 -7.80776567e-02]
 [-1.29641651e-01 -1.68062707e-01  7.37769963e-02]
 [-5.27783551e-02 -1.50410780e-01 -2.69654803e-02]
 [ 5.97766404e-03  6.82802370e-01  1.03856301e-01]
 [ 3.85595324e-01  3.72630558e-02  3.82932723e-01]
 [ 6.26060016e-01  2.70048404e-01  5.14043562e-01]
 [-2.25569083e-01 -2.85681197e-01 -1.89733899e-02]
 [-7.38297538e-02 -1.92654734e-02  8.78601715e-02]
 [ 1.08790956e-02 -5.70772067e-02  1.02528187e-01]
 [-1.18099597e-06  2.09899650e-01 -1.61327050e-01]
 [ 3.85510222e-01 -1.27572979e-01 -1.99512835e-01]
 [-1.84171743e-01 -8.44427906e-02  1.11866677e-01]
 [ 5.15894980e-02  1.66936733e-02 -2.86540427e-02]
 [-5.99142136e-02 -6.25193040e-02  2.41825546e-02]
 [ 1.02433847e-01 -8.40831737e-02 -5.45409237e-02]
 [ 1.21867655e-02  2.42018933e-03  3.30947338e-02]
 [-5.44751431e-02  6.37047683e-01 -6.24227347e-01]
 [ 5.60904217e-01  3.03831415e-01  3.10386297e-02]
 [ 1.94965695e-02  1.36556860e-01 -3.56782703e-02]
 [-1.18336417e-02 -1.52420599e-01 -9.49676000e-02]
 [ 4.43354979e-02  5.87286912e-03 -1.27258072e-02]
 [-6.15162908e-02 -7.39898506e-03  1.79846093e-01]
 [ 5.64107864e-03 -3.28506110e-02  4.19910649e-03]
 [ 6.69943492e-02 -5.34626016e-02 -1.38244683e-01]
 [-5.58931593e-02 -3.65834062e-02  5.17935200e-03]
 [-6.62549407e-02  9.47045316e-03  1.47184938e-02]
 [-7.08559085e-03 -2.93043418e-02  1.12397995e-02]
 [ 2.17566844e-02  1.34994750e-01 -9.58843490e-02]
 [-3.76241869e-02  2.95489537e-02 -1.17771618e-01]
 [ 2.87003958e-02 -4.72251297e-02  1.05443751e-01]
 [-6.86616265e-02  1.49815985e-02 -2.47232966e-02]
 [-1.24595880e-01 -1.51333441e-01 -1.13790319e-01]
 [ 5.71399841e-02  1.04675401e-01  1.82126161e-01]
 [ 1.59238481e-01 -1.16743435e-01 -1.47685551e-01]
 [ 9.81184205e-02  3.57909457e-03  6.48429474e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.99988254]
curr_Stock_Price:  99.44609341072798
curr_Factors:  [99.44609341 -0.99977298 -0.98972216]
mat_Sqrt:  [[13.60069083  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01225343 -0.01774616  0.01250497]
Stock Position:  0.012253426044858216
Bond Position:  [-3.21843789]


portfolio before change:  [-1.98156601]
curr_Stock_Price:  100.9737364104435
curr_Factors:  [100.97373641  -0.77949027  -1.00950986]
mat_Sqrt:  [[16.87545706  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00408025  0.02369676 -0.18072144]
Stock Position:  -0.004080249802746561
Bond Position:  [-1.56956794]


portfolio before change:  [-1.9781364]
curr_Stock_Price:  100.08511192973758
curr_Factors:  [100.08511193  -0.84548317  -0.97746637]
mat_Sqrt:  [[16.16860497  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041631  0.01036207  0.09248289]
Stock Position:  -0.00041630947123932167
Bond Position:  [-1.93647002]


portfolio before change:  [-1.97834174]
curr_Stock_Price:  99.9968563417397
curr_Factors:  [99.99685634 -0.72967122 -0.99170534]
mat_Sqrt:  [[17.88142018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0080098  0.0170812  0.33286984]
Stock Position:  0.008009797390640406
Bond Position:  [-2.7792963]


portfolio before change:  [-1.97492291]
curr_Stock_Price:  100.46706283856376
curr_Factors:  [100.46706284  -0.59592467  -0.97509236]
mat_Sqrt:  [[20.88044145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00239227 -0.00255132 -0.22273382]
Stock Position:  0.0023922694593527184
Bond Position:  [-2.2152672]


portfolio before change:  [-1.97493726]
curr_Stock_Price:  100.57682193351626
curr_Factors:  [100.57682193  -0.74275338  -0.95229862]
mat_Sqrt:  [[18.46486668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00806329 -0.05424201  0.21046523]
Stock Position:  -0.008063293610371525
Bond Position:  [-1.16395682]


portfolio before change:  [-1.98138195]
curr_Stock_Price:  101.35803913778074
curr_Factors:  [101.35803914  -0.71808828  -0.93943515]
mat_Sqrt:  [[19.31990203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460588 -0.04854487 -0.07692501]
Stock Position:  -0.00460587908251331
Bond Position:  [-1.51453908]


portfolio before change:  [-1.98036653]
curr_Stock_Price:  101.09647215467211
curr_Factors:  [101.09647215  -0.61032782  -0.91532697]
mat_Sqrt:  [[21.98632017  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00757533 0.22037352 0.29627312]
Stock Position:  0.007575332822199157
Bond Position:  [-2.74620596]


portfolio before change:  [-1.97331408]
curr_Stock_Price:  102.0727662205699
curr_Factors:  [102.07276622  -0.79527544  -0.92187929]
mat_Sqrt:  [[18.32985629  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02571583 0.0120266  1.09240047]
Stock Position:  0.025715827839929293
Bond Position:  [-4.59819976]


portfolio before change:  [-1.97267802]
curr_Stock_Price:  102.11985271928079
curr_Factors:  [102.11985272  -0.74389267  -0.92655582]
mat_Sqrt:  [[19.21514301  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04091107 0.08715775 1.4664232 ]
Stock Position:  0.04091107296044234
Bond Position:  [-6.15051077]


portfolio before change:  [-1.94413872]
curr_Stock_Price:  102.83623990170135
curr_Factors:  [102.8362399   -0.71466901  -0.91490083]
mat_Sqrt:  [[20.15732964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01427552 -0.09220321 -0.0541258 ]
Stock Position:  -0.01427552384337102
Bond Position:  [-0.47609752]


portfolio before change:  [-1.94231524]
curr_Stock_Price:  102.70433645017016
curr_Factors:  [102.70433645  -0.51844396  -0.90409051]
mat_Sqrt:  [[24.76223883  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00241609 -0.0062179   0.25064061]
Stock Position:  -0.0024160949294005914
Bond Position:  [-1.69417181]


portfolio before change:  [-1.94341264]
curr_Stock_Price:  103.07088261649359
curr_Factors:  [103.07088262  -0.50454759  -0.89108135]
mat_Sqrt:  [[25.52830902  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00078958 -0.01842159  0.29248438]
Stock Position:  0.000789583753633023
Bond Position:  [-2.02479573]


portfolio before change:  [-1.94298784]
curr_Stock_Price:  103.92945251410293
curr_Factors:  [103.92945251  -0.48580348  -0.91538038]
mat_Sqrt:  [[25.59836453  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.87277065e-04  6.77448208e-02 -4.60221169e-01]
Stock Position:  0.0003872770645214068
Bond Position:  [-1.98323733]


portfolio before change:  [-1.94351306]
curr_Stock_Price:  103.21343246282439
curr_Factors:  [103.21343246  -0.41214457  -0.90753268]
mat_Sqrt:  [[27.58085191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01155672 -0.041174   -0.56915458]
Stock Position:  0.0115567173359933
Bond Position:  [-3.13632152]


portfolio before change:  [-1.96762174]
curr_Stock_Price:  101.16123869643333
curr_Factors:  [101.1612387   -0.38248277  -0.88830456]
mat_Sqrt:  [[28.38691605  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00629071 -0.02725379  0.31912449]
Stock Position:  -0.006290710324414057
Bond Position:  [-1.3312457]


portfolio before change:  [-1.97541477]
curr_Stock_Price:  102.37360000337014
curr_Factors:  [102.3736      -0.47628819  -0.91547142]
mat_Sqrt:  [[25.45390731  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00193087  0.00538786 -0.08174201]
Stock Position:  0.0019308665361968118
Bond Position:  [-2.17308453]


portfolio before change:  [-1.97501768]
curr_Stock_Price:  102.71994558086519
curr_Factors:  [102.71994558  -0.39718148  -0.92491598]
mat_Sqrt:  [[27.38262944  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247382 -0.02017802  0.0689861 ]
Stock Position:  -0.00247381903103977
Bond Position:  [-1.72090712]


portfolio before change:  [-1.97441729]
curr_Stock_Price:  102.39028776107249
curr_Factors:  [102.39028776  -0.36712507  -0.90809403]
mat_Sqrt:  [[28.60474932  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00259178 -0.02713773 -0.15559007]
Stock Position:  0.0025917836443301433
Bond Position:  [-2.23979077]


portfolio before change:  [-1.97718016]
curr_Stock_Price:  101.432309028709
curr_Factors:  [101.43230903  -0.34054224  -0.88421629]
mat_Sqrt:  [[29.80371752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00065214 0.00078111 0.09441006]
Stock Position:  0.0006521407547887872
Bond Position:  [-2.0433283]


portfolio before change:  [-1.97687088]
curr_Stock_Price:  102.29823336629791
curr_Factors:  [102.29823337  -0.21637422  -0.90389469]
mat_Sqrt:  [[33.36887209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.55408918e-03  2.05606255e-01 -1.78074687e+00]
Stock Position:  -0.0015540891777488146
Bond Position:  [-1.81789031]


portfolio before change:  [-1.97756877]
curr_Stock_Price:  102.60106894518199
curr_Factors:  [102.60106895  -0.26315453  -0.92571607]
mat_Sqrt:  [[31.24869924  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02013714 0.09806117 0.08854457]
Stock Position:  0.020137135125046675
Bond Position:  [-4.04366036]


portfolio before change:  [-1.97335078]
curr_Stock_Price:  102.8356344112478
curr_Factors:  [102.83563441  -0.60141394  -0.92046941]
mat_Sqrt:  [[22.44905625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00178575  0.04407354 -0.10178017]
Stock Position:  0.001785746584471493
Bond Position:  [-2.15698916]


portfolio before change:  [-1.97463786]
curr_Stock_Price:  102.26587790565522
curr_Factors:  [102.26587791  -0.61765642  -0.93093688]
mat_Sqrt:  [[21.73628028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286763 -0.04919354 -0.27091613]
Stock Position:  -0.002867627102860153
Bond Position:  [-1.68137746]


portfolio before change:  [-1.97499267]
curr_Stock_Price:  102.31631048470891
curr_Factors:  [102.31631048  -0.57456658  -0.91713433]
mat_Sqrt:  [[23.02011015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186518  0.00189546 -0.03630319]
Stock Position:  0.0018651799429385157
Bond Position:  [-2.165831]


portfolio before change:  [-1.97808879]
curr_Stock_Price:  100.80150905226725
curr_Factors:  [100.80150905  -0.66278748  -0.92940913]
mat_Sqrt:  [[20.5109054   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00128301 -0.00238801  0.51305084]
Stock Position:  -0.0012830088084443355
Bond Position:  [-1.84875957]


portfolio before change:  [-1.97820181]
curr_Stock_Price:  100.70946426574649
curr_Factors:  [100.70946427  -0.68876676  -0.93026853]
mat_Sqrt:  [[19.94950805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.03955054e-05 -1.06024891e-02  1.19788820e-02]
Stock Position:  -1.0395505350156794e-05
Bond Position:  [-1.97715488]


portfolio before change:  [-1.9784474]
curr_Stock_Price:  100.5585059884384
curr_Factors:  [100.55850599  -0.55257185  -0.87302137]
mat_Sqrt:  [[24.17082885  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115272 -0.01725498 -0.3943736 ]
Stock Position:  0.0011527227240544027
Bond Position:  [-2.09436347]


portfolio before change:  [-1.9770609]
curr_Stock_Price:  101.98843686343761
curr_Factors:  [101.98843686  -0.4064845   -0.90986443]
mat_Sqrt:  [[27.34436619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227848 -0.01180724  0.01477525]
Stock Position:  -0.002278476107881979
Bond Position:  [-1.74468268]


portfolio before change:  [-1.97145899]
curr_Stock_Price:  99.43409453648225
curr_Factors:  [99.43409454 -0.40403519 -0.92142027]
mat_Sqrt:  [[26.41784146  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00232106  0.00305658  0.04198777]
Stock Position:  -0.002321059906245722
Bond Position:  [-1.7406665]


portfolio before change:  [-1.97064078]
curr_Stock_Price:  98.9878291030036
curr_Factors:  [98.9878291  -0.35332698 -0.91089336]
mat_Sqrt:  [[27.96004602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003853  -0.00945794  0.03206402]
Stock Position:  -0.00038529979857614035
Bond Position:  [-1.93250079]


portfolio before change:  [-1.97038604]
curr_Stock_Price:  97.6996999186748
curr_Factors:  [97.69969992 -0.28280932 -0.89631862]
mat_Sqrt:  [[30.04723216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00098978  0.04356937 -0.27353136]
Stock Position:  0.000989777072611406
Bond Position:  [-2.06708696]


portfolio before change:  [-1.97054947]
curr_Stock_Price:  97.79564667386467
curr_Factors:  [97.79564667 -0.51654984 -0.89347505]
mat_Sqrt:  [[23.87555607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00233011  0.00953688 -0.33596965]
Stock Position:  -0.002330105430311981
Bond Position:  [-1.74267531]


portfolio before change:  [-1.97311009]
curr_Stock_Price:  98.80108283128662
curr_Factors:  [98.80108283 -0.56737511 -0.87908661]
mat_Sqrt:  [[23.25794616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00174496 -0.01524185  0.30080167]
Stock Position:  0.001744961560658038
Bond Position:  [-2.14551419]


portfolio before change:  [-1.97609142]
curr_Stock_Price:  97.24625467434709
curr_Factors:  [97.24625467 -0.69621109 -0.85907414]
mat_Sqrt:  [[20.53151957  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00344106  0.00483529 -0.07052868]
Stock Position:  -0.003441057638077691
Bond Position:  [-1.64146145]


portfolio before change:  [-1.97135307]
curr_Stock_Price:  95.809620615507
curr_Factors:  [95.80962062 -0.68677685 -0.85973216]
mat_Sqrt:  [[20.40651273  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0087577  -0.04884266 -0.32461211]
Stock Position:  -0.008757696275054629
Bond Position:  [-1.13228151]


portfolio before change:  [-1.97361965]
curr_Stock_Price:  96.05226882304588
curr_Factors:  [96.05226882 -0.92940476 -0.86565685]
mat_Sqrt:  [[15.95593569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00725016 0.03378384 0.51955524]
Stock Position:  0.007250161311172762
Bond Position:  [-2.6700141]


portfolio before change:  [-1.97144377]
curr_Stock_Price:  96.39842110086472
curr_Factors:  [96.3984211  -0.87536186 -0.85077981]
mat_Sqrt:  [[17.15600316  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00613559 -0.03767878 -0.42130577]
Stock Position:  0.006135586446055022
Bond Position:  [-2.56290461]


portfolio before change:  [-1.96460409]
curr_Stock_Price:  97.56539275744457
curr_Factors:  [97.56539276 -0.6833352  -0.90420318]
mat_Sqrt:  [[19.94511931  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00561967 0.00115515 0.18497888]
Stock Position:  0.005619671137087536
Bond Position:  [-2.51288952]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.9670863]
Stock Price:  97.17959188501706
PL:  [-1.9670863]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.03882691e-02 -7.61203935e-02  1.08876934e-02]
 [-2.46242599e-01  5.60256510e-02 -2.87182159e-01]
 [-4.23549340e-02  5.11795334e-02  1.79360818e-02]
 [-7.61251398e-02 -5.72122852e-02 -3.31218263e-02]
 [ 8.87959787e-02 -3.98690704e-02 -8.23693019e-02]
 [-1.29698950e-01 -1.67252439e-01  7.83577408e-02]
 [-5.16703901e-02 -1.98156695e-01 -2.81236940e-02]
 [ 7.42530276e-03  6.47818950e-01  9.98535462e-02]
 [ 5.58542996e-01  1.09100544e-01  5.26507686e-01]
 [ 6.75457010e-01  3.01892263e-01  5.92038931e-01]
 [-8.75713291e-02 -1.88401456e-01  3.23292373e-03]
 [-5.64939152e-02 -1.86656880e-02  9.00092125e-02]
 [ 8.32013941e-03 -5.71204897e-02  1.19800527e-01]
 [ 1.02549738e-02 -6.82188666e-02 -1.17187901e-01]
 [ 4.33424988e-02 -3.17100386e-02 -8.19341785e-02]
 [ 8.11476417e-02 -9.29886562e-03  7.70205756e-03]
 [ 5.48475837e-02  1.29273099e-02 -4.73898030e-02]
 [-2.75606106e-02 -5.77037182e-02 -1.73742804e-02]
 [ 1.79489205e-02  1.02955077e-01 -2.00327441e-01]
 [-9.80253847e-02 -6.07655212e-03 -3.20159771e-02]
 [-4.29044785e-02  5.10486662e-01 -4.54820795e-01]
 [ 3.71758638e-01  2.13325894e-01  6.18396543e-02]
 [ 3.13955728e-03 -3.86711329e-02  7.29669447e-02]
 [-4.39263683e-02 -8.73519605e-03 -1.39831816e-02]
 [-7.06555142e-02 -7.40498007e-03 -2.34353869e-03]
 [-1.42077555e-01 -3.12672877e-03  2.18020123e-01]
 [-4.00611227e-02 -3.34525488e-02 -7.22727924e-03]
 [-6.11298126e-02  4.95242962e-02 -2.12086722e-01]
 [ 7.39340876e-02 -3.72413961e-02  1.30436635e-01]
 [-2.57192738e-02  2.66191225e-02 -2.54774398e-02]
 [ 1.09594927e-01  1.01145456e-02  3.95479457e-02]
 [ 2.65966616e-02 -7.82494731e-02 -1.55779154e-01]
 [-9.38440943e-03  1.78913195e-03  1.64960040e-01]
 [ 3.07849096e-05 -9.13152738e-02 -1.58873102e-01]
 [ 3.79077074e-04  7.67783101e-02  4.71122224e-02]
 [ 2.13144438e-02  2.78364474e-02  1.11954221e-01]
 [ 1.92525634e-01 -1.34107794e-01  1.04248180e-01]
 [-8.19668635e-02  1.43914295e-02  4.36618130e-02]
 [ 2.26189918e-01 -1.86352627e-02  8.25254628e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.45889223]
curr_Stock_Price:  99.88214960297708
curr_Factors:  [99.8821496  -0.93246147 -1.00397662]
mat_Sqrt:  [[14.40467632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00020322 -0.02456775  0.03105956]
Stock Position:  -0.00020321873379319075
Bond Position:  [1.47919016]


portfolio before change:  [1.45921422]
curr_Stock_Price:  99.20764253277704
curr_Factors:  [99.20764253 -1.12189342 -1.00361399]
mat_Sqrt:  [[11.84265263  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02477715  0.0180822  -0.81925076]
Stock Position:  -0.02477715361879333
Bond Position:  [3.91729722]


portfolio before change:  [1.46047682]
curr_Stock_Price:  99.17644791659689
curr_Factors:  [99.17644792 -0.71199806 -1.02673245]
mat_Sqrt:  [[17.42960253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162062  0.01651812  0.05116665]
Stock Position:  -0.0016206203270884496
Bond Position:  [1.62120419]


portfolio before change:  [1.45762705]
curr_Stock_Price:  101.05994390769665
curr_Factors:  [101.05994391  -1.06074481  -1.03806496]
mat_Sqrt:  [[12.39017814  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00763222 -0.01846519 -0.09448735]
Stock Position:  -0.00763221577870298
Bond Position:  [2.22893835]


portfolio before change:  [1.46038534]
curr_Stock_Price:  100.73505085488412
curr_Factors:  [100.73505085  -0.59040376  -1.01965961]
mat_Sqrt:  [[20.134413    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0031709  -0.01286769 -0.23497669]
Stock Position:  0.0031708982724112105
Bond Position:  [1.14096474]


portfolio before change:  [1.45944942]
curr_Stock_Price:  100.3949086509413
curr_Factors:  [100.39490865  -0.66775178  -1.03794764]
mat_Sqrt:  [[18.23626273  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00810717 -0.05398049  0.22353282]
Stock Position:  -0.008107171194435391
Bond Position:  [2.27336813]


portfolio before change:  [1.44262373]
curr_Stock_Price:  102.50537077914683
curr_Factors:  [102.50537078  -0.57717198  -1.02941012]
mat_Sqrt:  [[20.55970511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00475978 -0.0639548  -0.08022907]
Stock Position:  -0.00475978038586203
Bond Position:  [1.93052678]


portfolio before change:  [1.43922775]
curr_Stock_Price:  103.26954635301678
curr_Factors:  [103.26954635  -0.52407106  -1.0073994 ]
mat_Sqrt:  [[22.32868255  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00716761 0.20908267 0.28485437]
Stock Position:  0.007167611057136834
Bond Position:  [0.69903181]


portfolio before change:  [1.43827171]
curr_Stock_Price:  103.12397172689917
curr_Factors:  [103.12397173  -0.51985402  -1.0171171 ]
mat_Sqrt:  [[22.17489415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03103897 0.03521205 1.50197988]
Stock Position:  0.031038974904830645
Bond Position:  [-1.76259066]


portfolio before change:  [1.4379907]
curr_Stock_Price:  103.1220170018365
curr_Factors:  [103.122017    -0.88087404  -1.01702211]
mat_Sqrt:  [[15.45630136  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.05550681 0.09743531 1.68892228]
Stock Position:  0.05550680789643787
Bond Position:  [-4.28598329]


portfolio before change:  [1.45164666]
curr_Stock_Price:  103.37769260641915
curr_Factors:  [103.37769261  -0.84157724  -1.04827362]
mat_Sqrt:  [[15.61978435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00802628 -0.06080631  0.00922263]
Stock Position:  -0.008026275820849929
Bond Position:  [2.28138453]


portfolio before change:  [1.45878131]
curr_Stock_Price:  102.52431330968886
curr_Factors:  [102.52431331  -0.76356036  -1.08262003]
mat_Sqrt:  [[16.18232478  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259116 -0.00602432  0.25677123]
Stock Position:  -0.00259115917169496
Bond Position:  [1.72443812]


portfolio before change:  [1.45964767]
curr_Stock_Price:  102.27315461452514
curr_Factors:  [102.27315461  -0.43332972  -1.07528624]
mat_Sqrt:  [[22.62445177  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00093327 -0.01843556  0.34175756]
Stock Position:  0.0009332667484608998
Bond Position:  [1.36419953]


portfolio before change:  [1.45805342]
curr_Stock_Price:  100.38218489501062
curr_Factors:  [100.3821849   -0.6608146   -1.07923478]
mat_Sqrt:  [[17.61825145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00156605 -0.02201754 -0.33430446]
Stock Position:  -0.001566047819675078
Bond Position:  [1.61525672]


portfolio before change:  [1.45852203]
curr_Stock_Price:  100.21189389635818
curr_Factors:  [100.2118939   -0.56964627  -1.05983987]
mat_Sqrt:  [[19.64456568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00102547 -0.01023437 -0.23373541]
Stock Position:  0.0010254729217920172
Bond Position:  [1.35575744]


portfolio before change:  [1.45744191]
curr_Stock_Price:  98.99333448378873
curr_Factors:  [98.99333448 -0.46185841 -1.04651754]
mat_Sqrt:  [[21.90415991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00368979 -0.0030012   0.02197183]
Stock Position:  0.003689787464531612
Bond Position:  [1.09217754]


portfolio before change:  [1.45905566]
curr_Stock_Price:  99.39368948521538
curr_Factors:  [99.39368949 -0.26862291 -1.03103656]
mat_Sqrt:  [[27.09716622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017645   0.00417227 -0.13518992]
Stock Position:  0.0017645002569908691
Bond Position:  [1.28367547]


portfolio before change:  [1.45786247]
curr_Stock_Price:  98.62652707182514
curr_Factors:  [98.62652707 -0.10224891 -1.02209596]
mat_Sqrt:  [[32.04032919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013385  -0.01862379 -0.04956399]
Stock Position:  -0.0013384957000659463
Bond Position:  [1.58987366]


portfolio before change:  [1.4612864]
curr_Stock_Price:  96.21697297204524
curr_Factors:  [96.21697297 -0.12921085 -1.03696176]
mat_Sqrt:  [[29.97708235  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.42867823e-05  3.32286081e-02 -5.71478429e-01]
Stock Position:  -6.428678226824111e-05
Bond Position:  [1.46747188]


portfolio before change:  [1.46150619]
curr_Stock_Price:  95.65157588409235
curr_Factors:  [95.65157588 -0.16974001 -1.02610936]
mat_Sqrt:  [[28.92952801  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0036572  -0.0019612  -0.09133267]
Stock Position:  -0.003657197227763377
Bond Position:  [1.81132287]


portfolio before change:  [1.45996044]
curr_Stock_Price:  96.13615014021373
curr_Factors:  [96.13615014 -0.28363618 -1.0565675 ]
mat_Sqrt:  [[25.16770792  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.25326196e-03  1.64758862e-01 -1.29747713e+00]
Stock Position:  -0.0012532619595632044
Bond Position:  [1.58044422]


portfolio before change:  [1.45846356]
curr_Stock_Price:  97.48817609487566
curr_Factors:  [97.48817609 -0.31027582 -1.08690297]
mat_Sqrt:  [[24.10820669  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01775024 0.06885064 0.17641132]
Stock Position:  0.01775024479547799
Bond Position:  [-0.27197543]


portfolio before change:  [1.45945831]
curr_Stock_Price:  97.54613310952209
curr_Factors:  [ 9.75461331e+01 -7.91950171e-02 -1.08058446e+00]
mat_Sqrt:  [[30.58610889  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00033153 -0.01248105  0.20815438]
Stock Position:  0.00033152829596196467
Bond Position:  [1.42711901]


portfolio before change:  [1.459819]
curr_Stock_Price:  98.09597180162514
curr_Factors:  [98.0959718  -0.2247215  -1.08202896]
mat_Sqrt:  [[26.55441017  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182884 -0.00281927 -0.03989012]
Stock Position:  -0.001828838880009653
Bond Position:  [1.63922073]


portfolio before change:  [1.46254464]
curr_Stock_Price:  96.71765068686138
curr_Factors:  [ 9.67176507e+01 -3.63317936e-02 -1.05798524e+00]
mat_Sqrt:  [[32.37799035  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224367 -0.00238995 -0.00668546]
Stock Position:  -0.002243666809218611
Bond Position:  [1.67954683]


portfolio before change:  [1.46307584]
curr_Stock_Price:  96.57447472102365
curr_Factors:  [ 9.65744747e+01  8.15122141e-02 -1.06416478e+00]
mat_Sqrt:  [[36.14945602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00271685 -0.00100915  0.62195073]
Stock Position:  -0.0027168493010001266
Bond Position:  [1.72545413]


portfolio before change:  [1.46145978]
curr_Stock_Price:  97.2486968549351
curr_Factors:  [ 9.72486969e+01  1.47199180e-02 -1.06453764e+00]
mat_Sqrt:  [[34.03719377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00142094 -0.01079676 -0.02061742]
Stock Position:  -0.001420941402277429
Bond Position:  [1.59964448]


portfolio before change:  [1.46061905]
curr_Stock_Price:  97.98109175430427
curr_Factors:  [ 9.79810918e+01 -3.72381965e-02 -1.03285932e+00]
mat_Sqrt:  [[33.60507179  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0028065   0.0159839  -0.60502438]
Stock Position:  -0.002806502823284655
Bond Position:  [1.73560326]


portfolio before change:  [1.46241904]
curr_Stock_Price:  97.41703618683064
curr_Factors:  [ 9.74170362e+01 -5.49890781e-03 -1.07833149e+00]
mat_Sqrt:  [[32.95591326  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00282066 -0.01201961  0.37209941]
Stock Position:  0.002820661812919237
Bond Position:  [1.18763853]


portfolio before change:  [1.46378923]
curr_Stock_Price:  97.85016886182035
curr_Factors:  [ 9.78501689e+01  4.24120321e-02 -1.12804965e+00]
mat_Sqrt:  [[33.04267144  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00077131  0.00859128 -0.07268004]
Stock Position:  -0.0007713125988874495
Bond Position:  [1.53926229]


portfolio before change:  [1.46130412]
curr_Stock_Price:  101.32155740530034
curr_Factors:  [101.32155741   0.13103789  -1.11664705]
mat_Sqrt:  [[37.81440216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00316631 0.00326446 0.11281928]
Stock Position:  0.0031663131893632664
Bond Position:  [1.14048834]


portfolio before change:  [1.47151101]
curr_Stock_Price:  104.50011896468662
curr_Factors:  [ 1.04500119e+02 -2.46840253e-02 -1.11498038e+00]
mat_Sqrt:  [[33.43234371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063335 -0.02525491 -0.44439457]
Stock Position:  -0.00063334572082339
Bond Position:  [1.53769571]


portfolio before change:  [1.47077036]
curr_Stock_Price:  105.9730522984924
curr_Factors:  [105.9730523   -0.27471986  -1.12771263]
mat_Sqrt:  [[26.06914279  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00094568 0.00057744 0.47058508]
Stock Position:  0.0009456821425056297
Bond Position:  [1.37055354]


portfolio before change:  [1.46964471]
curr_Stock_Price:  104.60157915477342
curr_Factors:  [104.60157915  -0.39632699  -1.11870254]
mat_Sqrt:  [[22.99160427  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221988 -0.02947188 -0.45322074]
Stock Position:  -0.0022198843909224213
Bond Position:  [1.70184812]


portfolio before change:  [1.47332155]
curr_Stock_Price:  103.04109650016656
curr_Factors:  [103.0410965   -0.48064209  -1.1023087 ]
mat_Sqrt:  [[21.16136493  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00121297 0.02478009 0.13439806]
Stock Position:  0.001212971195501137
Bond Position:  [1.34833567]


portfolio before change:  [1.47523717]
curr_Stock_Price:  104.48142338947709
curr_Factors:  [104.48142339  -0.42917764  -1.08453765]
mat_Sqrt:  [[22.99539552  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00216779 0.00898417 0.31937423]
Stock Position:  0.0021677859178015706
Bond Position:  [1.24874382]


portfolio before change:  [1.47437653]
curr_Stock_Price:  104.01239644379835
curr_Factors:  [104.01239644  -0.42789819  -1.07270888]
mat_Sqrt:  [[23.19421782  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0080378  -0.0432831   0.29739104]
Stock Position:  0.008037803530234476
Bond Position:  [0.63834532]


portfolio before change:  [1.46442822]
curr_Stock_Price:  102.7647792399572
curr_Factors:  [102.76477924  -0.53108133  -1.05864741]
mat_Sqrt:  [[20.9620558   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00334494  0.00464481  0.124555  ]
Stock Position:  -0.0033449388568477898
Bond Position:  [1.80817013]


portfolio before change:  [1.45700355]
curr_Stock_Price:  105.0520296507904
curr_Factors:  [105.05202965  -0.90163958  -1.04512347]
mat_Sqrt:  [[14.99463832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01595447 -0.00601451  0.23542217]
Stock Position:  0.01595446618614766
Bond Position:  [-0.21904551]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.45515208]
Stock Price:  104.93769919964596
PL:  [-3.48254712]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-3.26097801e-02 -8.12450121e-02  1.26712495e-02]
 [-9.64523781e-02  7.15473023e-02 -9.66322477e-02]
 [-6.90087515e-03  1.83454429e-02  4.16098944e-02]
 [-2.12472353e-01 -8.97113422e-02 -1.06307391e-01]
 [ 2.59525019e-02  5.87977381e-02 -6.81813217e-02]
 [-7.83001124e-02 -1.55420719e-01  1.37784491e-01]
 [-6.39836904e-02 -1.43589295e-01  3.37424720e-02]
 [-1.34331685e-02  7.48175197e-01  1.38263320e-01]
 [ 3.02857942e-01  1.57915125e-03  2.98597584e-01]
 [ 4.40852666e-01  1.69275202e-01  2.81705165e-01]
 [-2.21866775e-01 -2.70018072e-01  2.61052954e-03]
 [-1.02685609e-03 -1.63808632e-02  9.89030039e-02]
 [-3.64989809e-03  1.40764422e-02  6.87025827e-02]
 [ 1.29260048e-02 -1.76253067e-01  1.40731283e-02]
 [-1.34208841e-02  4.11993057e-02 -5.47622412e-02]
 [ 4.17630040e-02 -2.05004155e-02  4.02772912e-02]
 [ 5.05256307e-02  1.86030515e-02 -2.24317320e-02]
 [-6.04119098e-02 -6.46293560e-02  1.23658336e-02]
 [ 4.95589083e-02  5.65959081e-02 -2.36866033e-01]
 [-1.82949220e-02  1.93719601e-02 -5.38725671e-02]
 [-3.91639058e-02  5.02007631e-01 -4.63046378e-01]
 [ 2.27391517e-01  1.44246713e-01  8.53488226e-02]
 [ 1.98211473e-03 -3.34628796e-02  6.97918462e-02]
 [ 1.09699252e-01 -2.97601028e-02 -2.18397947e-01]
 [-5.53234123e-02  1.41750098e-02 -3.94204234e-03]
 [-1.07958839e-01 -1.19005017e-02  2.27828693e-01]
 [-4.27736717e-02 -3.35696060e-02 -8.27071998e-03]
 [-1.07193755e-01  1.27695456e-01 -9.37580076e-02]
 [ 5.68871315e-02 -3.94011859e-02  1.14340319e-01]
 [ 1.68150284e-03  3.11581767e-02 -4.61433979e-02]
 [ 3.07935572e-02 -3.00597157e-02 -6.74339233e-02]
 [-2.24615109e-02  3.98390675e-02 -1.00914753e-01]
 [ 3.05391662e-02  2.44350801e-02  6.24999694e-02]
 [ 3.95887052e-02 -3.32638777e-02  1.75953557e-01]
 [-7.29595887e-02 -1.48790292e-02 -2.42528882e-02]
 [-7.12964960e-03 -7.95437592e-02  1.32333338e-02]
 [-9.22864216e-03  1.01689942e-01  9.82584376e-02]
 [ 8.42173636e-02 -8.06833240e-02 -7.98722245e-02]
 [ 7.02088770e-02 -2.71683938e-03  6.17674306e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.75888838]
curr_Stock_Price:  100.17211574120175
curr_Factors:  [100.17211574  -1.27199291  -0.99637482]
mat_Sqrt:  [[10.36590583  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00449621 -0.02622171  0.03614755]
Stock Position:  -0.004496214953096173
Bond Position:  [4.20928375]


portfolio before change:  [3.75706387]
curr_Stock_Price:  100.69493519612705
curr_Factors:  [100.6949352   -1.03133023  -0.97641979]
mat_Sqrt:  [[13.52237176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00751146  0.02309179 -0.27566491]
Stock Position:  -0.007511464920320893
Bond Position:  [4.51343034]


portfolio before change:  [3.75961427]
curr_Stock_Price:  100.43051402806819
curr_Factors:  [100.43051403  -0.86447819  -0.93732408]
mat_Sqrt:  [[16.57115966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00032209 0.00592097 0.11870145]
Stock Position:  0.0003220931384628032
Bond Position:  [3.72726629]


portfolio before change:  [3.76047168]
curr_Stock_Price:  101.64592437014396
curr_Factors:  [101.64592437  -0.87098884  -0.94800207]
mat_Sqrt:  [[16.48588469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01531519 -0.02895421 -0.30326539]
Stock Position:  -0.01531519319951114
Bond Position:  [5.31719865]


portfolio before change:  [3.78913811]
curr_Stock_Price:  99.8175615721989
curr_Factors:  [99.81756157 -0.86658146 -0.95963567]
mat_Sqrt:  [[16.07277759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00149552  0.01897689 -0.19450233]
Stock Position:  0.0014955153692078665
Bond Position:  [3.63985941]


portfolio before change:  [3.78946161]
curr_Stock_Price:  99.72963070301392
curr_Factors:  [99.7296307  -1.03954647 -0.9658292 ]
mat_Sqrt:  [[13.42457734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00610076 -0.05016182  0.3930608 ]
Stock Position:  -0.006100757611597262
Bond Position:  [4.39788792]


portfolio before change:  [3.79666989]
curr_Stock_Price:  98.63820886503012
curr_Factors:  [98.63820887 -0.78737112 -0.96231352]
mat_Sqrt:  [[17.14615687  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00503938 -0.04634325  0.09625788]
Stock Position:  -0.005039384620252236
Bond Position:  [4.29374576]


portfolio before change:  [3.79095742]
curr_Stock_Price:  99.87828522086366
curr_Factors:  [99.87828522 -0.62687713 -0.97783092]
mat_Sqrt:  [[20.07036289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00834615 0.24147251 0.39442677]
Stock Position:  0.008346153826883328
Bond Position:  [2.95735788]


portfolio before change:  [3.79368155]
curr_Stock_Price:  100.16038403548744
curr_Factors:  [100.16038404  -0.60065139  -0.95586014]
mat_Sqrt:  [[21.12086053  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.72403611e-02 5.09668875e-04 8.51815794e-01]
Stock Position:  0.01724036106751441
Bond Position:  [2.06688036]


portfolio before change:  [3.79083359]
curr_Stock_Price:  99.98020590163033
curr_Factors:  [99.9802059  -0.75389373 -0.90585764]
mat_Sqrt:  [[19.01486133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0280259  0.05463334 0.80362642]
Stock Position:  0.02802590240381127
Bond Position:  [0.9887981]


portfolio before change:  [3.76469285]
curr_Stock_Price:  99.04306040173643
curr_Factors:  [99.0430604  -0.96058324 -0.92511059]
mat_Sqrt:  [[15.02718476  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01839673 -0.08714796  0.00744711]
Stock Position:  -0.01839673332512956
Bond Position:  [5.58676162]


portfolio before change:  [3.75960409]
curr_Stock_Price:  99.35763492685157
curr_Factors:  [99.35763493 -1.15634252 -0.9308472 ]
mat_Sqrt:  [[12.32384611  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00128352 -0.0052869   0.28214274]
Stock Position:  0.0012835201935347928
Bond Position:  [3.63207656]


portfolio before change:  [3.75988231]
curr_Stock_Price:  99.22065568214454
curr_Factors:  [99.22065568 -0.91790533 -0.91847986]
mat_Sqrt:  [[15.81503439  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00083764 0.00454315 0.19598935]
Stock Position:  0.0008376396334053829
Bond Position:  [3.67677116]


portfolio before change:  [3.76045638]
curr_Stock_Price:  99.35727890546246
curr_Factors:  [99.35727891 -1.10805664 -0.91592067]
mat_Sqrt:  [[13.12796808  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00153709 -0.05688543  0.04014672]
Stock Position:  -0.0015370875674191426
Bond Position:  [3.91317722]


portfolio before change:  [3.76110407]
curr_Stock_Price:  99.25415342942824
curr_Factors:  [99.25415343 -1.06638099 -0.93470768]
mat_Sqrt:  [[13.41797324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00120655  0.01329702 -0.15622143]
Stock Position:  -0.001206546357492427
Bond Position:  [3.88085881]


portfolio before change:  [3.76097053]
curr_Stock_Price:  99.76692106087475
curr_Factors:  [99.76692106 -0.80620516 -0.95185698]
mat_Sqrt:  [[17.19768077  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00266315 -0.00661648  0.1148999 ]
Stock Position:  0.002663146412311662
Bond Position:  [3.49527661]


portfolio before change:  [3.76272845]
curr_Stock_Price:  100.26294360740607
curr_Factors:  [100.26294361  -0.72761385  -0.91648751]
mat_Sqrt:  [[19.36940603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00256818  0.00600411 -0.06399149]
Stock Position:  0.0025681791411006094
Bond Position:  [3.50523525]


portfolio before change:  [3.76237838]
curr_Stock_Price:  99.9560124222689
curr_Factors:  [99.95601242 -0.64395006 -0.93491592]
mat_Sqrt:  [[20.61181045  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00344852 -0.02085903  0.03527628]
Stock Position:  -0.003448515926399629
Bond Position:  [4.10707828]


portfolio before change:  [3.76613248]
curr_Stock_Price:  99.01627739126452
curr_Factors:  [99.01627739 -0.44793106 -0.94876469]
mat_Sqrt:  [[24.49792709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.20918488e-04  1.82662508e-02 -6.75712861e-01]
Stock Position:  0.000520918488402974
Bond Position:  [3.71455307]


portfolio before change:  [3.76650389]
curr_Stock_Price:  98.83786065077611
curr_Factors:  [98.83786065 -0.5674686  -0.92167139]
mat_Sqrt:  [[22.29451626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113648  0.00625227 -0.15368344]
Stock Position:  -0.0011364825597930633
Bond Position:  [3.8788314]


portfolio before change:  [3.76765066]
curr_Stock_Price:  98.25546002356221
curr_Factors:  [98.25546002 -0.55648762 -0.90065968]
mat_Sqrt:  [[22.88366939  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013639   0.16202227 -1.32094243]
Stock Position:  -0.0013638972317232604
Bond Position:  [3.90166101]


portfolio before change:  [3.76931707]
curr_Stock_Price:  97.39126842217892
curr_Factors:  [97.39126842 -0.76579091 -0.90315949]
mat_Sqrt:  [[18.35287358  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01494357 0.04655543 0.24347643]
Stock Position:  0.014943573170454114
Bond Position:  [2.31394353]


portfolio before change:  [3.77605804]
curr_Stock_Price:  97.82300640947189
curr_Factors:  [97.82300641 -0.97834915 -0.91927945]
mat_Sqrt:  [[14.66598964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00064078 -0.0108001   0.19909671]
Stock Position:  0.0006407841691997457
Bond Position:  [3.71337461]


portfolio before change:  [3.77605473]
curr_Stock_Price:  97.09341618335652
curr_Factors:  [97.09341618 -1.07883675 -0.91222991]
mat_Sqrt:  [[13.25807643  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00445345 -0.00960503 -0.62302855]
Stock Position:  0.0044534516671364075
Bond Position:  [3.3436539]


portfolio before change:  [3.77498348]
curr_Stock_Price:  96.75901665786479
curr_Factors:  [96.75901666 -0.83175615 -0.91460839]
mat_Sqrt:  [[16.87543445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00315456  0.00457496 -0.01124555]
Stock Position:  -0.0031545627270039454
Bond Position:  [4.08021587]


portfolio before change:  [3.77457611]
curr_Stock_Price:  97.04984331072764
curr_Factors:  [97.04984331 -1.04182821 -0.9114558 ]
mat_Sqrt:  [[13.76240617  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00464183 -0.00384087  0.64993185]
Stock Position:  -0.0046418250297318425
Bond Position:  [4.2250645]


portfolio before change:  [3.7775973]
curr_Stock_Price:  96.51276450407624
curr_Factors:  [96.5127645  -1.04467594 -0.93413043]
mat_Sqrt:  [[13.34135895  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00384626 -0.01083454 -0.02359406]
Stock Position:  -0.0038462567958458655
Bond Position:  [4.14881018]


portfolio before change:  [3.77867993]
curr_Stock_Price:  96.36612932722676
curr_Factors:  [96.36612933 -1.08368348 -0.9218609 ]
mat_Sqrt:  [[12.96962907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00773085  0.04121353 -0.2674655 ]
Stock Position:  -0.007730853503128674
Bond Position:  [4.52367236]


portfolio before change:  [3.78176866]
curr_Stock_Price:  96.03974430863387
curr_Factors:  [96.03974431 -0.94839991 -0.91696563]
mat_Sqrt:  [[14.87075545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00485409 -0.01271668  0.3261811 ]
Stock Position:  0.004854092201099675
Bond Position:  [3.31558289]


portfolio before change:  [3.78734496]
curr_Stock_Price:  97.10314080981478
curr_Factors:  [97.10314081 -1.14352701 -0.95110421]
mat_Sqrt:  [[11.95491506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.15211410e-04  1.00562583e-02 -1.31634270e-01]
Stock Position:  -0.00011521141015559897
Bond Position:  [3.79853235]


portfolio before change:  [3.78785424]
curr_Stock_Price:  96.80426869941562
curr_Factors:  [96.8042687  -1.15818194 -0.97170092]
mat_Sqrt:  [[11.50530505  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094676 -0.00970173 -0.19237021]
Stock Position:  0.0009467590307632702
Bond Position:  [3.69620392]


portfolio before change:  [3.78880036]
curr_Stock_Price:  97.31555926571681
curr_Factors:  [97.31555927 -1.25751175 -0.97125024]
mat_Sqrt:  [[10.47715212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00333378  0.012858   -0.2878817 ]
Stock Position:  -0.0033337812250479808
Bond Position:  [4.11322915]


portfolio before change:  [3.78884459]
curr_Stock_Price:  97.45652637748903
curr_Factors:  [97.45652638 -1.42232712 -0.97106762]
mat_Sqrt:  [[ 8.89964739  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00542546 0.00788639 0.17829502]
Stock Position:  0.005425463140240756
Bond Position:  [3.2600978]


portfolio before change:  [3.78984055]
curr_Stock_Price:  97.56498063310046
curr_Factors:  [97.56498063 -1.33244963 -0.95177403]
mat_Sqrt:  [[ 9.93729608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00691487 -0.01073587  0.50194652]
Stock Position:  0.006914870336806185
Bond Position:  [3.11519136]


portfolio before change:  [3.78867715]
curr_Stock_Price:  97.34041797545927
curr_Factors:  [97.34041798 -1.3791671  -0.93489618]
mat_Sqrt:  [[ 9.6229514   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00841191 -0.00480219 -0.06918674]
Stock Position:  -0.008411905511169665
Bond Position:  [4.60749555]


portfolio before change:  [3.78589015]
curr_Stock_Price:  97.74020521541361
curr_Factors:  [97.74020522 -1.35728155 -0.9212325 ]
mat_Sqrt:  [[10.01214584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00206401 -0.02567264  0.03775102]
Stock Position:  -0.0020640139324861343
Bond Position:  [3.98762729]


portfolio before change:  [3.78631823]
curr_Stock_Price:  97.77431413861963
curr_Factors:  [97.77431414 -1.33050397 -0.94762543]
mat_Sqrt:  [[10.01949306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00315242 0.03282029 0.28030397]
Stock Position:  0.0031524199509762978
Bond Position:  [3.47809253]


portfolio before change:  [3.78853766]
curr_Stock_Price:  98.34043266722453
curr_Factors:  [98.34043267 -1.47358191 -0.93979066]
mat_Sqrt:  [[ 8.8027369   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0058441  -0.02604043 -0.22785322]
Stock Position:  0.005844102807335903
Bond Position:  [3.21382607]


portfolio before change:  [3.78836802]
curr_Stock_Price:  98.24265941820552
curr_Factors:  [98.24265942 -1.67756541 -0.93791672]
mat_Sqrt:  [[ 7.18473333  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01144963 -0.00087686  0.17620529]
Stock Position:  0.011449628639902641
Bond Position:  [2.66352605]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.79472547]
Stock Price:  98.76883250937642
PL:  [3.79472547]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-3.60196176e-01 -1.17875186e-01  2.70247095e-02]
 [-4.58322427e-02  3.81367170e-02  7.97519588e-02]
 [ 1.63240855e-02 -6.23516725e-03  5.80277323e-02]
 [-3.09289294e-02 -3.44493847e-02  1.64144387e-02]
 [ 1.77644992e-01 -1.85341723e-01 -1.04528953e-01]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.18563894e-02 -1.90141362e-01 -2.79292592e-02]
 [ 8.30268701e-03  6.67569703e-01  9.98263034e-02]
 [ 3.11834295e-01  6.53096830e-03  3.19154044e-01]
 [ 5.27579745e-01  2.15923329e-01  3.88756503e-01]
 [-1.87465262e-01 -1.99493979e-01  4.04626755e-02]
 [-7.88749299e-02 -1.94400264e-02  8.72347452e-02]
 [ 2.96915048e-03 -3.26452898e-02  1.35388594e-01]
 [ 1.03786084e-02 -1.34154813e-01  4.91271144e-02]
 [ 1.64167179e-02 -1.42669705e-02 -6.85650744e-02]
 [-1.41220038e-03 -3.27627608e-02  6.96914518e-02]
 [ 4.95200355e-02  2.04078455e-02 -1.65502417e-02]
 [-6.14182358e-02 -6.48415074e-02  1.32768555e-02]
 [ 6.91010527e-02 -3.45055199e-02 -1.15016097e-01]
 [ 3.35491056e-02 -1.49108814e-02  1.19981597e-01]
 [-3.16695759e-02  4.71731902e-01 -4.53721128e-01]
 [ 2.85676111e-01  1.72135695e-01  7.58575871e-02]
 [ 1.34663947e-02  1.11270170e-01 -1.70541874e-02]
 [ 2.55523911e-02 -1.55166866e-01 -1.65182688e-01]
 [ 4.53229925e-02  4.62639901e-03 -1.27976652e-02]
 [-2.42396871e-02  1.25596760e-02  6.26343248e-02]
 [ 8.57073414e-02 -2.63043236e-02  5.42602322e-02]
 [ 1.68761969e-01 -5.20519785e-02  2.23838419e-01]
 [-3.47987991e-02  1.37673303e-02 -8.51066735e-02]
 [-6.75261072e-02  1.93568056e-02 -7.22636150e-03]
 [ 4.88322858e-02 -1.92587220e-02  5.48629610e-03]
 [ 2.65260463e-02 -7.00592903e-02 -1.42732278e-01]
 [-4.40217258e-02  9.79532778e-03  1.74687578e-01]
 [-1.89215402e-03 -9.49928818e-02 -1.84332768e-01]
 [ 5.66691010e-02  2.67458374e-01 -8.17633845e-02]
 [ 2.60062965e-03  2.00902336e-02  8.33715021e-02]
 [ 3.74172986e-01 -2.32971184e-01  2.25700316e-01]
 [-9.56696973e-02  3.45032425e-02  4.45562734e-02]
 [ 2.18533621e-01 -1.70634713e-02  8.47790940e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.71779197]
curr_Stock_Price:  101.175514177189
curr_Factors:  [101.17551418  -0.87522936  -1.05501882]
mat_Sqrt:  [[14.68179953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02579663 -0.03804405  0.07709397]
Stock Position:  -0.02579663010437282
Bond Position:  [14.32777929]


portfolio before change:  [11.70017868]
curr_Stock_Price:  101.92772026122907
curr_Factors:  [101.92772026  -0.98626377  -1.05059594]
mat_Sqrt:  [[13.29521532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016373   0.01230857  0.22751014]
Stock Position:  -0.0016373046210475832
Bond Position:  [11.8670654]


portfolio before change:  [11.70297901]
curr_Stock_Price:  101.12343683234485
curr_Factors:  [101.12343683  -1.1649405   -1.04537328]
mat_Sqrt:  [[11.08982632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0024253  -0.00201239  0.16553697]
Stock Position:  0.0024253038529417435
Bond Position:  [11.45772395]


portfolio before change:  [11.70368554]
curr_Stock_Price:  100.82418414561359
curr_Factors:  [100.82418415  -1.06280101  -1.05630066]
mat_Sqrt:  [[12.11296768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00285729 -0.01111849  0.04682582]
Stock Position:  -0.0028572929634399415
Bond Position:  [11.99176977]


portfolio before change:  [11.70340492]
curr_Stock_Price:  101.44703867470878
curr_Factors:  [101.44703867  -1.17413669  -1.03459364]
mat_Sqrt:  [[11.14294479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01063232 -0.05981878 -0.29819201]
Stock Position:  0.010632322963364601
Bond Position:  [10.62478724]


portfolio before change:  [11.70741542]
curr_Stock_Price:  101.69931757632234
curr_Factors:  [101.69931758  -1.27794379  -1.05105777]
mat_Sqrt:  [[ 9.90479547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01547778 -0.05534923  0.15513819]
Stock Position:  -0.015477775047791194
Bond Position:  [13.28149458]


portfolio before change:  [11.70507451]
curr_Stock_Price:  101.95782969105987
curr_Factors:  [101.95782969  -1.1571919   -1.05252882]
mat_Sqrt:  [[11.18796412  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00861371 -0.06136786 -0.0796744 ]
Stock Position:  -0.008613709133361612
Bond Position:  [12.5833096]


portfolio before change:  [11.7060721]
curr_Stock_Price:  102.02463318729998
curr_Factors:  [102.02463319  -1.29898046  -1.06686814]
mat_Sqrt:  [[ 9.57701246  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01722319 0.2154572  0.28477666]
Stock Position:  0.017223193715250773
Bond Position:  [9.94888208]


portfolio before change:  [11.69398314]
curr_Stock_Price:  101.25052307013092
curr_Factors:  [101.25052307  -0.99999591  -1.07144421]
mat_Sqrt:  [[12.75799019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02965314 0.00210786 0.91045765]
Stock Position:  0.029653140051500087
Bond Position:  [8.6915872]


portfolio before change:  [11.69497192]
curr_Stock_Price:  101.24722723170512
curr_Factors:  [101.24722723  -0.75261367  -1.02611411]
mat_Sqrt:  [[17.09588082  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0380799  0.06968895 1.10901409]
Stock Position:  0.03807990388017413
Bond Position:  [7.83948724]


portfolio before change:  [11.59939037]
curr_Stock_Price:  98.71146574772847
curr_Factors:  [98.71146575 -0.6881681  -1.01737095]
mat_Sqrt:  [[17.93334922  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0122636  -0.0643864   0.11542875]
Stock Position:  -0.012263598269034344
Bond Position:  [12.80994813]


portfolio before change:  [11.58552052]
curr_Stock_Price:  99.97301931073936
curr_Factors:  [99.97301931 -0.55383397 -1.05656422]
mat_Sqrt:  [[19.97541266  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325582 -0.00627424  0.24885645]
Stock Position:  -0.0032558221470019707
Bond Position:  [11.91101489]


portfolio before change:  [11.59156797]
curr_Stock_Price:  98.57291811634869
curr_Factors:  [98.57291812 -0.66515694 -1.0572398 ]
mat_Sqrt:  [[17.60881838  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00135963 -0.01053622  0.38622597]
Stock Position:  0.0013596335125918247
Bond Position:  [11.45754493]


portfolio before change:  [11.59316638]
curr_Stock_Price:  98.69509701113412
curr_Factors:  [98.69509701 -0.79202826 -1.05758987]
mat_Sqrt:  [[15.52446445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044946 -0.04329828  0.14014598]
Stock Position:  -0.00044945820794748054
Bond Position:  [11.6375257]


portfolio before change:  [11.5941036]
curr_Stock_Price:  99.84661467104503
curr_Factors:  [99.84661467 -1.06846621 -1.07553514]
mat_Sqrt:  [[11.70052602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.19897749e-05 -4.60464493e-03 -1.95597073e-01]
Stock Position:  -4.198977485662575e-05
Bond Position:  [11.59829614]


portfolio before change:  [11.5955291]
curr_Stock_Price:  100.42710647602038
curr_Factors:  [100.42710648  -0.83627055  -1.08036198]
mat_Sqrt:  [[14.77297692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00041467 -0.01057414  0.19881031]
Stock Position:  0.00041466504234986
Bond Position:  [11.55388549]


portfolio before change:  [11.59647744]
curr_Stock_Price:  99.23098060327034
curr_Factors:  [99.2309806  -0.66713253 -1.06237386]
mat_Sqrt:  [[17.60079161  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00285825  0.0065866  -0.04721323]
Stock Position:  0.0028582501695204807
Bond Position:  [11.31285047]


portfolio before change:  [11.60021818]
curr_Stock_Price:  100.04495753295105
curr_Factors:  [100.04495753  -0.64981931  -1.00222193]
mat_Sqrt:  [[19.17444534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00375207 -0.02092751  0.03787517]
Stock Position:  -0.0037520681861755024
Bond Position:  [11.97559368]


portfolio before change:  [11.59820626]
curr_Stock_Price:  100.98016544981346
curr_Factors:  [100.98016545  -0.68097725  -1.00507845]
mat_Sqrt:  [[18.7064506   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00206239 -0.01113661 -0.32810891]
Stock Position:  0.0020623944799368333
Bond Position:  [11.38994532]


portfolio before change:  [11.60187336]
curr_Stock_Price:  102.0678664490754
curr_Factors:  [102.06786645  -0.89797557  -0.99175467]
mat_Sqrt:  [[15.42373744  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00356571 -0.00481247  0.3422741 ]
Stock Position:  0.003565710048234321
Bond Position:  [11.23792894]


portfolio before change:  [11.60640888]
curr_Stock_Price:  102.94586587255539
curr_Factors:  [102.94586587  -0.97812327  -0.99926372]
mat_Sqrt:  [[14.2508462   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196431  0.15225082 -1.29434009]
Stock Position:  -0.0019643143797397093
Bond Position:  [11.80862692]


portfolio before change:  [11.61002232]
curr_Stock_Price:  101.85781950777611
curr_Factors:  [101.85781951  -0.9473397   -1.00236232]
mat_Sqrt:  [[14.4960456   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02319926 0.05555656 0.21640058]
Stock Position:  0.023199259816736144
Bond Position:  [9.2469963]


portfolio before change:  [11.62580169]
curr_Stock_Price:  102.48815960711569
curr_Factors:  [102.48815961  -1.00639531  -0.99101085]
mat_Sqrt:  [[13.90628811  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00235132  0.03591229 -0.04865085]
Stock Position:  0.0023513213115965294
Bond Position:  [11.38481909]


portfolio before change:  [11.62776699]
curr_Stock_Price:  102.71871740363312
curr_Factors:  [102.7187174   -0.99951632  -1.00009587]
mat_Sqrt:  [[13.9068589   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286468 -0.05007989 -0.47122023]
Stock Position:  -0.0028646790773763217
Bond Position:  [11.92202315]


portfolio before change:  [11.62825106]
curr_Stock_Price:  103.06998898871551
curr_Factors:  [103.06998899  -1.00994038  -0.99777656]
mat_Sqrt:  [[13.84177676  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00315386  0.00149316 -0.03650818]
Stock Position:  0.0031538609912445258
Bond Position:  [11.30318264]


portfolio before change:  [11.63032946]
curr_Stock_Price:  103.28097364223122
curr_Factors:  [103.28097364  -0.78654951  -1.01086477]
mat_Sqrt:  [[17.11643129  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051943  0.00405362  0.17867829]
Stock Position:  -0.0005194293015514413
Bond Position:  [11.68397663]


portfolio before change:  [11.6312942]
curr_Stock_Price:  104.23558515817383
curr_Factors:  [104.23558516  -0.4760456   -1.02852718]
mat_Sqrt:  [[23.15199139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00394842 -0.00848968  0.15478934]
Stock Position:  0.003948421360077164
Bond Position:  [11.21972819]


portfolio before change:  [11.63621678]
curr_Stock_Price:  105.12708921901266
curr_Factors:  [105.12708922  -0.39416515  -1.02938205]
mat_Sqrt:  [[25.32071383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00804984 -0.0167997   0.6385487 ]
Stock Position:  0.008049841335310068
Bond Position:  [10.7899604]


portfolio before change:  [11.64689577]
curr_Stock_Price:  106.28613824732054
curr_Factors:  [106.28613825  -0.2986333   -1.01234422]
mat_Sqrt:  [[28.65011208  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172289  0.00444339 -0.24278565]
Stock Position:  -0.001722886159445689
Bond Position:  [11.83001469]


portfolio before change:  [11.64625055]
curr_Stock_Price:  107.51899030931885
curr_Factors:  [107.51899031  -0.33566153  -1.00399914]
mat_Sqrt:  [[28.16293674  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00230977  0.00624738 -0.0206148 ]
Stock Position:  -0.002309772991200994
Bond Position:  [11.89459501]


portfolio before change:  [11.65353442]
curr_Stock_Price:  105.00924413286553
curr_Factors:  [105.00924413  -0.38651534  -0.96674705]
mat_Sqrt:  [[27.13395781  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00169607 -0.00621573  0.01565088]
Stock Position:  0.001696066656730176
Bond Position:  [11.47543174]


portfolio before change:  [11.65371909]
curr_Stock_Price:  104.27233930888657
curr_Factors:  [104.27233931  -0.24740036  -0.94340851]
mat_Sqrt:  [[31.69621445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0005335  -0.02261154 -0.40717546]
Stock Position:  -0.000533497483588322
Bond Position:  [11.70934813]


portfolio before change:  [11.65491286]
curr_Stock_Price:  104.77842854643603
curr_Factors:  [104.77842855  -0.36173442  -0.94118951]
mat_Sqrt:  [[28.47208072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.23528109e-04  3.16142845e-03  4.98335036e-01]
Stock Position:  -0.00022352810864038306
Bond Position:  [11.67833378]


portfolio before change:  [11.65625802]
curr_Stock_Price:  105.29164744570119
curr_Factors:  [105.29164745  -0.321477    -0.92732533]
mat_Sqrt:  [[30.20271336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195046 -0.03065882 -0.52585008]
Stock Position:  -0.0019504626230721041
Bond Position:  [11.86162544]


portfolio before change:  [11.65467286]
curr_Stock_Price:  106.86458769396393
curr_Factors:  [106.86458769  -0.49301468  -0.94083458]
mat_Sqrt:  [[25.47539876  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00371236  0.08632182 -0.23324818]
Stock Position:  0.0037123631632548434
Bond Position:  [11.2579527]


portfolio before change:  [11.65053267]
curr_Stock_Price:  105.37025277485402
curr_Factors:  [105.37025277  -0.55622276  -0.94154665]
mat_Sqrt:  [[23.56378389  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00100662 0.0064841  0.23783569]
Stock Position:  0.0010066154113476634
Bond Position:  [11.54446535]


portfolio before change:  [11.65223376]
curr_Stock_Price:  105.62649387045066
curr_Factors:  [105.62649387  -0.72061534  -0.96679672]
mat_Sqrt:  [[19.54065509  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01907248 -0.07519113  0.64386018]
Stock Position:  0.019072483726760625
Bond Position:  [9.63767417]


portfolio before change:  [11.64056355]
curr_Stock_Price:  104.95143786535992
curr_Factors:  [104.95143787  -0.71067882  -0.96811443]
mat_Sqrt:  [[19.58383538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00406109  0.01113587  0.12710665]
Stock Position:  -0.004061091183632878
Bond Position:  [12.06678091]


portfolio before change:  [11.64334054]
curr_Stock_Price:  104.63907121414819
curr_Factors:  [104.63907121  -0.83279629  -0.96787094]
mat_Sqrt:  [[17.2851852   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01344249 -0.00550721  0.24185116]
Stock Position:  0.013442494919806687
Bond Position:  [10.23673036]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.64297475]
Stock Price:  104.51666373619989
PL:  [7.12631101]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 1.40273510e-01 -2.61130763e-02  7.25336854e-04]
 [-2.17911423e-01  6.26333830e-02 -2.54904861e-01]
 [-8.36355652e-03  1.98935015e-02  4.05759178e-02]
 [ 7.28307437e-02  9.09937444e-02  5.40268937e-02]
 [-3.69223984e-02  1.57352932e-01 -4.64959885e-02]
 [-7.00318749e-02 -1.50643680e-01  1.63561412e-01]
 [-6.52932715e-02 -1.33581833e-01  2.60978176e-03]
 [-5.09854346e-02  8.59121091e-01  2.03678748e-01]
 [ 2.09755430e-01 -4.27959630e-02  1.65023923e-01]
 [ 1.81775001e-01  6.12071341e-02  6.28704375e-02]
 [-1.26245236e-01 -1.93934824e-01  2.49575415e-02]
 [-8.92714995e-02 -2.18167189e-02  5.36550069e-02]
 [-6.56201974e-02  2.60330223e-01 -3.41335001e-01]
 [ 5.38688228e-03 -3.10505629e-02  6.36168109e-02]
 [-1.55849165e-01  1.89312623e-01 -3.62566166e-02]
 [-1.16073683e-02 -3.39101195e-02  1.81143106e-02]
 [ 5.83792187e-02  6.38599938e-02 -1.21676841e-01]
 [-2.42876303e-02 -5.70137158e-02 -2.03372927e-02]
 [ 6.17907719e-02  5.37588869e-02 -2.64276511e-01]
 [-3.85106297e-02  4.20181436e-02 -7.14025176e-02]
 [-4.32980969e-02  5.57884916e-01 -5.44271775e-01]
 [ 2.15813755e-01  1.38706793e-01  8.72341795e-02]
 [-2.74947121e-03 -1.33155694e-02  5.75013965e-02]
 [ 8.95320246e-04 -1.14922456e-01 -1.42873812e-01]
 [ 6.40903317e-02  3.43041122e-02 -1.50881552e-02]
 [-1.24027918e-02  1.49942967e-02  5.20155837e-02]
 [ 5.33088087e-02 -3.34481403e-02  2.02803798e-02]
 [ 7.42476875e-02 -5.83979387e-02 -1.27651591e-01]
 [-4.87561309e-02 -2.98972915e-02 -3.47611634e-03]
 [-6.37216986e-02 -8.02798198e-03  2.93344928e-02]
 [-3.86764673e-02 -5.49829564e-02 -3.03142847e-02]
 [ 2.60447491e-02 -1.42369875e-02 -5.38079291e-02]
 [-1.08471849e-02  1.26952704e-02  1.09950677e-01]
 [ 1.00855940e-02 -7.20855178e-02 -2.57476667e-02]
 [-2.76990733e-02  5.49824646e-02  4.37847186e-02]
 [ 7.05891910e-02  3.07162887e-02  1.73236214e-01]
 [ 8.61906764e-02 -6.94030369e-02  2.85561849e-02]
 [-8.83248767e-02  1.67888911e-02  4.56197159e-02]
 [ 1.56432119e-01 -4.31440934e-03  1.03058673e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.9398662]
curr_Stock_Price:  99.32758737226524
curr_Factors:  [99.32758737 -1.01889762 -0.99665095]
mat_Sqrt:  [[13.2351316   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01020702 -0.00842796  0.00206918]
Stock Position:  0.010207020457704215
Bond Position:  [-3.95370491]


portfolio before change:  [-2.93834976]
curr_Stock_Price:  99.52457697678261
curr_Factors:  [99.52457698 -0.88993559 -1.03589849]
mat_Sqrt:  [[14.50611871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0177276   0.02021484 -0.72717262]
Stock Position:  -0.017727600263368868
Bond Position:  [-1.17401785]


portfolio before change:  [-2.95077199]
curr_Stock_Price:  100.21702636498614
curr_Factors:  [100.21702636  -0.7949433   -1.03316581]
mat_Sqrt:  [[16.10659772  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00024709 0.0064206  0.1157518 ]
Stock Position:  0.00024708582634183456
Bond Position:  [-2.9755342]


portfolio before change:  [-2.95134553]
curr_Stock_Price:  99.40121677009672
curr_Factors:  [99.40121677 -0.81384504 -1.01893728]
mat_Sqrt:  [[15.90100052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00644192 0.0293681  0.15412369]
Stock Position:  0.006441919006979028
Bond Position:  [-3.59168012]


portfolio before change:  [-2.95278356]
curr_Stock_Price:  99.24768417991001
curr_Factors:  [99.24768418 -0.84441469 -1.01740424]
mat_Sqrt:  [[15.42207085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00092684  0.05078544 -0.13264011]
Stock Position:  -0.0009268417757815022
Bond Position:  [-2.86079666]


portfolio before change:  [-2.95296623]
curr_Stock_Price:  99.05891509789546
curr_Factors:  [99.0589151  -0.85478223 -1.00910821]
mat_Sqrt:  [[15.36088499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00438745 -0.04862004  0.46659518]
Stock Position:  -0.004387446027402642
Bond Position:  [-2.51835058]


portfolio before change:  [-2.94895426]
curr_Stock_Price:  98.07274110407936
curr_Factors:  [98.0727411  -0.90353881 -1.02346159]
mat_Sqrt:  [[14.27784533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0064455  -0.04311335  0.00744498]
Stock Position:  -0.006445498424116526
Bond Position:  [-2.31682656]


portfolio before change:  [-2.94839578]
curr_Stock_Price:  97.9411607061858
curr_Factors:  [97.94116071 -0.55348442 -1.03691809]
mat_Sqrt:  [[19.96467356  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00831257 0.27728014 0.58103877]
Stock Position:  0.00831256636530021
Bond Position:  [-3.76253817]


portfolio before change:  [-2.95163539]
curr_Stock_Price:  97.60801796261401
curr_Factors:  [97.60801796 -0.10342817 -1.02437102]
mat_Sqrt:  [[31.60010533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00742735 -0.01381234  0.47076732]
Stock Position:  0.007427352069209436
Bond Position:  [-3.67660451]


portfolio before change:  [-2.96735902]
curr_Stock_Price:  95.5529086503026
curr_Factors:  [95.55290865 -0.26057249 -1.03416427]
mat_Sqrt:  [[26.17862781  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00791112 0.01975452 0.17935186]
Stock Position:  0.007911118578816486
Bond Position:  [-3.72328941]


portfolio before change:  [-2.96859888]
curr_Stock_Price:  95.45501803369909
curr_Factors:  [95.45501803 -0.17101343 -1.0513673 ]
mat_Sqrt:  [[28.11418909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00571731 -0.0625922   0.07119692]
Stock Position:  -0.005717311583345328
Bond Position:  [-2.4228528]


portfolio before change:  [-2.96470503]
curr_Stock_Price:  94.72097864212117
curr_Factors:  [94.72097864 -0.14822357 -1.07628825]
mat_Sqrt:  [[27.83860355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0029733  -0.00704132  0.1530628 ]
Stock Position:  -0.002973300584832764
Bond Position:  [-2.68307109]


portfolio before change:  [-2.96511395]
curr_Stock_Price:  94.74570361183721
curr_Factors:  [94.74570361 -0.1734632  -1.04945479]
mat_Sqrt:  [[27.89028736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00294566  0.08402122 -0.97373375]
Stock Position:  -0.0029456573024017494
Bond Position:  [-2.68602557]


portfolio before change:  [-2.96795431]
curr_Stock_Price:  95.59596975220565
curr_Factors:  [95.59596975 -0.21177988 -1.08257656]
mat_Sqrt:  [[26.20038809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00045932 -0.01002153  0.18148105]
Stock Position:  0.00045932296028784145
Bond Position:  [-3.01186374]


portfolio before change:  [-2.96907719]
curr_Stock_Price:  93.97103419101721
curr_Factors:  [93.97103419 -0.36205582 -1.09606249]
mat_Sqrt:  [[21.86458671  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00569902  0.06110039 -0.10343004]
Stock Position:  -0.005699020986568791
Bond Position:  [-2.43353429]


portfolio before change:  [-2.98205358]
curr_Stock_Price:  96.19460620491463
curr_Factors:  [96.1946062  -0.52601569 -1.10737212]
mat_Sqrt:  [[18.78362498  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078961 -0.01094444  0.05167509]
Stock Position:  -0.0007896066014023179
Bond Position:  [-2.90609769]


portfolio before change:  [-2.98332036]
curr_Stock_Price:  97.33883193097765
curr_Factors:  [97.33883193 -0.35936608 -1.09612853]
mat_Sqrt:  [[22.70768463  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00205117  0.02061072 -0.34711016]
Stock Position:  0.002051173647393254
Bond Position:  [-3.1829792]


portfolio before change:  [-2.983058]
curr_Stock_Price:  97.6607208446313
curr_Factors:  [97.66072084 -0.44889717 -1.08389553]
mat_Sqrt:  [[21.08805446  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190045 -0.0184011  -0.05801664]
Stock Position:  -0.0019004521694350228
Bond Position:  [-2.79745848]


portfolio before change:  [-2.98694219]
curr_Stock_Price:  99.52053092822774
curr_Factors:  [99.52053093 -0.34690779 -1.10971284]
mat_Sqrt:  [[23.19051452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0008115   0.01735061 -0.75390733]
Stock Position:  0.0008114973801996025
Bond Position:  [-3.06770284]


portfolio before change:  [-2.9875145]
curr_Stock_Price:  99.28784169920205
curr_Factors:  [99.2878417  -0.26347438 -1.1216696 ]
mat_Sqrt:  [[24.85053158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00179106  0.0135613  -0.20369151]
Stock Position:  -0.0017910558469101717
Bond Position:  [-2.80968443]


portfolio before change:  [-2.99106322]
curr_Stock_Price:  101.07309548198253
curr_Factors:  [101.07309548  -0.56174257  -1.13922182]
mat_Sqrt:  [[18.44659092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00219658  0.18005658 -1.55265588]
Stock Position:  -0.0021965753085385273
Bond Position:  [-2.76904856]


portfolio before change:  [-2.98965839]
curr_Stock_Price:  100.27595236091575
curr_Factors:  [100.27595236  -0.50685645  -1.1565924 ]
mat_Sqrt:  [[19.00072353  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01378546 0.04476742 0.24885483]
Stock Position:  0.013785462549145241
Bond Position:  [-4.37200878]


portfolio before change:  [-2.9995146]
curr_Stock_Price:  99.6006266263776
curr_Factors:  [99.60062663 -0.72594342 -1.17309649]
mat_Sqrt:  [[14.91143756  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00042048 -0.00429758  0.16403548]
Stock Position:  0.0004204774320217277
Bond Position:  [-3.04139442]


portfolio before change:  [-2.99945035]
curr_Stock_Price:  100.65764168266051
curr_Factors:  [100.65764168  -1.06225832  -1.16905779]
mat_Sqrt:  [[10.8093226   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00478542 -0.03709106 -0.40757922]
Stock Position:  -0.0047854176078058665
Bond Position:  [-2.5177615]


portfolio before change:  [-3.00259165]
curr_Stock_Price:  101.24830156493483
curr_Factors:  [101.24830156  -1.26780621  -1.20496753]
mat_Sqrt:  [[ 8.54035171  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0079637   0.0110716  -0.04304231]
Stock Position:  0.007963696905983645
Bond Position:  [-3.80890243]


portfolio before change:  [-3.00130666]
curr_Stock_Price:  101.46944547599128
curr_Factors:  [101.46944548  -1.32671527  -1.20528295]
mat_Sqrt:  [[ 8.06682122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00015812 0.00483939 0.14838598]
Stock Position:  0.0001581221073025623
Bond Position:  [-3.01735123]


portfolio before change:  [-3.00167785]
curr_Stock_Price:  101.50744814781928
curr_Factors:  [101.50744815  -1.24844795  -1.19006546]
mat_Sqrt:  [[ 8.86063793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00571301 -0.01079534  0.05785428]
Stock Position:  0.00571301425866765
Bond Position:  [-3.58159135]


portfolio before change:  [-3.00539359]
curr_Stock_Price:  100.93541854447356
curr_Factors:  [100.93541854  -1.39449857  -1.18102188]
mat_Sqrt:  [[ 7.68261848  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00472111 -0.01884785 -0.36415446]
Stock Position:  0.004721109909438238
Bond Position:  [-3.48192079]


portfolio before change:  [-3.00369017]
curr_Stock_Price:  101.38842281365099
curr_Factors:  [101.38842281  -1.15461093  -1.1519443 ]
mat_Sqrt:  [[10.0986695   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00550255 -0.00964931 -0.00991639]
Stock Position:  -0.005502551522455638
Bond Position:  [-2.44579515]


portfolio before change:  [-3.0048856]
curr_Stock_Price:  101.55010916658013
curr_Factors:  [101.55010917  -0.95755657  -1.14647806]
mat_Sqrt:  [[12.3853922   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00479375 -0.00259102  0.08368314]
Stock Position:  -0.004793754151665379
Bond Position:  [-2.51807935]


portfolio before change:  [-3.0053286]
curr_Stock_Price:  101.57685510672225
curr_Factors:  [101.57685511  -0.82424296  -1.13152662]
mat_Sqrt:  [[14.36861226  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00390349 -0.01774567 -0.08647822]
Stock Position:  -0.0039034871823069514
Bond Position:  [-2.60882464]


portfolio before change:  [-3.0053029]
curr_Stock_Price:  101.48672486411948
curr_Factors:  [101.48672486  -0.75851396  -1.14723379]
mat_Sqrt:  [[15.09223311  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00080539 -0.00459497 -0.15349904]
Stock Position:  0.0008053903347559717
Bond Position:  [-3.08703933]


portfolio before change:  [-3.00575219]
curr_Stock_Price:  101.40802487295397
curr_Factors:  [101.40802487  -0.55260611  -1.15211075]
mat_Sqrt:  [[18.43839859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00076947 0.00409738 0.31365868]
Stock Position:  0.0007694710680579681
Bond Position:  [-3.08378273]


portfolio before change:  [-3.0059405]
curr_Stock_Price:  101.66428328275128
curr_Factors:  [101.66428328  -0.71666467  -1.15443388]
mat_Sqrt:  [[15.65166797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063153 -0.0232655  -0.07345093]
Stock Position:  -0.0006315314866843234
Bond Position:  [-2.9417363]


portfolio before change:  [-3.00631394]
curr_Stock_Price:  101.67330853214372
curr_Factors:  [101.67330853  -0.67083272  -1.12110995]
mat_Sqrt:  [[16.94244728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044494  0.01774551  0.12490561]
Stock Position:  -0.00044493610118345343
Bond Position:  [-2.96107581]


portfolio before change:  [-3.00705996]
curr_Stock_Price:  102.51806922708046
curr_Factors:  [102.51806923  -0.72965059  -1.13782479]
mat_Sqrt:  [[15.8404008   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00708447 0.00991364 0.4941947 ]
Stock Position:  0.007084468544930412
Bond Position:  [-3.733346]


portfolio before change:  [-3.00617043]
curr_Stock_Price:  102.70950574477088
curr_Factors:  [102.70950574  -0.49458559  -1.14133434]
mat_Sqrt:  [[20.00505012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00389166 -0.02239973  0.08146285]
Stock Position:  0.0038916597141485923
Bond Position:  [-3.40588088]


portfolio before change:  [-3.00598156]
curr_Stock_Price:  102.86744300500087
curr_Factors:  [102.86744301  -0.59341082  -1.14950857]
mat_Sqrt:  [[18.00270113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00419858  0.00541859  0.13014035]
Stock Position:  -0.004198579571341256
Bond Position:  [-2.57408441]


portfolio before change:  [-3.00870226]
curr_Stock_Price:  103.43880843921242
curr_Factors:  [103.43880844  -0.61321955  -1.12870688]
mat_Sqrt:  [[18.12067917  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00974512 -0.00139247  0.29399771]
Stock Position:  0.009745120785417572
Bond Position:  [-4.01672594]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.01472147]
Stock Price:  102.87267033680436
PL:  [-5.8873918]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.59411366e-01 -9.76628084e-02  1.75169542e-02]
 [-3.94831346e-02  3.26933866e-02  1.91784523e-01]
 [-2.39664381e-02  3.64071291e-02  2.95461647e-02]
 [ 1.15680224e-01  3.75192339e-02  1.39089860e-01]
 [ 1.46922672e-01 -1.39648638e-01 -9.84864036e-02]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.21755711e-02 -1.76386759e-01 -2.75956020e-02]
 [ 9.22312991e-03  6.32945823e-01  9.46887235e-02]
 [ 5.86894758e-01  1.20787073e-01  5.47605114e-01]
 [ 7.31841157e-01  3.22229967e-01  6.29397041e-01]
 [-8.36628744e-02 -2.20568399e-01 -2.59631946e-02]
 [-5.73754157e-02 -1.90341325e-02  7.96871699e-02]
 [ 1.51937334e-02 -6.70610579e-02  7.75973792e-02]
 [ 9.40859681e-04  1.73991428e-01 -1.22719198e-01]
 [ 5.30176821e-01 -1.49041336e-01 -2.39551149e-01]
 [-1.81393410e-01 -9.45638209e-02  1.12586864e-01]
 [ 5.11090115e-02  1.75560276e-02 -2.58437895e-02]
 [-6.51811290e-02 -6.56347921e-02  1.66833835e-02]
 [ 2.20680321e-01 -2.81578243e-01  1.01859367e-01]
 [ 5.69871182e-02  1.35932029e-03  4.51425897e-01]
 [-5.03703831e-02  5.99211967e-01 -5.77845127e-01]
 [ 3.71179980e-01  2.13049008e-01  6.19338846e-02]
 [-1.71803089e-01  1.89306765e-01 -1.03154436e-01]
 [-4.27726803e-02 -1.39839381e-01 -5.01748071e-02]
 [-2.88263522e-03 -3.92962364e-02 -7.22438200e-03]
 [-2.82383747e-03  1.93262861e-02  3.60441139e-03]
 [ 8.72927368e-02 -1.20525403e-02  1.66236295e-01]
 [ 1.69200954e-01 -5.16844617e-02  2.26524836e-01]
 [-2.93050286e-02  2.49507905e-02 -1.04538602e-01]
 [-6.15595323e-02 -5.38216614e-04  3.39424731e-02]
 [ 1.07078346e-01  3.53872675e-03  2.53648095e-02]
 [ 2.70311057e-02 -1.28637609e-01 -2.36046931e-01]
 [ 6.51461387e-02 -7.09117848e-03  1.42556249e-01]
 [-1.47611510e-02 -1.19604754e-01 -3.54717984e-01]
 [ 8.00574733e-02  3.45300830e-01 -1.46669829e-01]
 [-4.18104102e-02 -1.61455179e-03 -1.07711585e-02]
 [ 6.19952706e-01 -3.34085678e-01  4.69337726e-01]
 [-1.28751999e-01  7.09330957e-02  5.10656677e-02]
 [ 4.13342774e-01 -5.70566100e-02  2.74370147e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.68039849]
curr_Stock_Price:  100.28829277307925
curr_Factors:  [100.28829277  -0.71809418  -1.00245738]
mat_Sqrt:  [[17.94833609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00979317 -0.03152054  0.04997099]
Stock Position:  -0.009793167968794808
Bond Position:  [5.66253858]


portfolio before change:  [4.68949714]
curr_Stock_Price:  99.43149248801483
curr_Factors:  [99.43149249 -0.36217887 -0.97992404]
mat_Sqrt:  [[25.98101235  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.43956117e-04 1.05517452e-02 5.47107862e-01]
Stock Position:  0.00024395611672150465
Bond Position:  [4.66524022]


portfolio before change:  [4.6900774]
curr_Stock_Price:  99.41950446934146
curr_Factors:  [99.41950447 -0.21877497 -1.00141423]
mat_Sqrt:  [[29.34608405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035793  0.01175035  0.08428698]
Stock Position:  -0.0003579277699672982
Bond Position:  [4.72566241]


portfolio before change:  [4.6902404]
curr_Stock_Price:  100.61455997636534
curr_Factors:  [100.61455998  -0.4719778   -0.99618092]
mat_Sqrt:  [[23.1764867   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00654674 0.01210928 0.39678465]
Stock Position:  0.00654673879638141
Bond Position:  [4.03154316]


portfolio before change:  [4.69528996]
curr_Stock_Price:  101.30888821492167
curr_Factors:  [101.30888821  -0.71240466  -1.00083072]
mat_Sqrt:  [[18.26412519  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00538288 -0.0450714  -0.2809543 ]
Stock Position:  0.005382878113303054
Bond Position:  [4.14995657]


portfolio before change:  [4.70069665]
curr_Stock_Price:  102.21693611163691
curr_Factors:  [102.21693611  -0.60941494  -1.01882092]
mat_Sqrt:  [[20.06268275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00764126 -0.05534923  0.15513819]
Stock Position:  -0.007641261046147263
Bond Position:  [5.48176295]


portfolio before change:  [4.70337139]
curr_Stock_Price:  101.95657730995705
curr_Factors:  [101.95657731  -0.68269038  -0.99093127]
mat_Sqrt:  [[19.12364188  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00490562 -0.05692858 -0.07872257]
Stock Position:  -0.0049056187471119206
Bond Position:  [5.20353148]


portfolio before change:  [4.70113564]
curr_Stock_Price:  102.54492882721668
curr_Factors:  [102.54492883  -0.60097796  -1.00416726]
mat_Sqrt:  [[20.59721381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00765885 0.20428239 0.27012057]
Stock Position:  0.007658847030676329
Bond Position:  [3.91575972]


portfolio before change:  [4.70367182]
curr_Stock_Price:  102.81216000905407
curr_Factors:  [102.81216001  -0.32229652  -1.02478491]
mat_Sqrt:  [[26.73095362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02705963 0.03898386 1.56216497]
Stock Position:  0.027059631019647794
Bond Position:  [1.92161271]


portfolio before change:  [4.70780919]
curr_Stock_Price:  102.95618088005457
curr_Factors:  [102.95618088  -0.40979469  -1.03413965]
mat_Sqrt:  [[24.2973947   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03811484 0.10399927 1.79549457]
Stock Position:  0.03811483567419074
Bond Position:  [0.78365128]


portfolio before change:  [4.74949576]
curr_Stock_Price:  104.04732046625863
curr_Factors:  [104.04732047  -0.44857439  -1.03365105]
mat_Sqrt:  [[23.63244043  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00566958 -0.07118814 -0.07406577]
Stock Position:  -0.005669576342142078
Bond Position:  [5.33939999]


portfolio before change:  [4.7532701]
curr_Stock_Price:  103.49932919345875
curr_Factors:  [103.49932919  -0.64611398  -1.03661051]
mat_Sqrt:  [[19.23709884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00233895 -0.00614324  0.22732531]
Stock Position:  -0.0023389528057802035
Bond Position:  [4.99535015]


portfolio before change:  [4.75419609]
curr_Stock_Price:  103.37041531219758
curr_Factors:  [103.37041531  -0.79455941  -1.05972952]
mat_Sqrt:  [[16.18410961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0010717  -0.02164386  0.22136372]
Stock Position:  0.0010716963351375761
Bond Position:  [4.64341439]


portfolio before change:  [4.75569606]
curr_Stock_Price:  104.22841236300398
curr_Factors:  [104.22841236  -0.89320389  -1.05847231]
mat_Sqrt:  [[14.80416502  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00077051  0.05615549 -0.35008371]
Stock Position:  0.0007705101798214734
Bond Position:  [4.67538701]


portfolio before change:  [4.75684045]
curr_Stock_Price:  104.95511573862237
curr_Factors:  [104.95511574  -1.00614557  -1.05355636]
mat_Sqrt:  [[13.38093397  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03369389 -0.04810288 -0.68337275]
Stock Position:  0.03369388963465952
Bond Position:  [1.22049437]


portfolio before change:  [4.75582652]
curr_Stock_Price:  104.92049495788696
curr_Factors:  [104.92049496  -0.56467969  -1.03939941]
mat_Sqrt:  [[21.09685072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00842374 -0.03052034  0.32117898]
Stock Position:  -0.008423744105784064
Bond Position:  [5.63964992]


portfolio before change:  [4.75737309]
curr_Stock_Price:  104.82058958645344
curr_Factors:  [104.82058959  -0.68108359  -1.03071458]
mat_Sqrt:  [[18.92439917  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0026113   0.00566618 -0.07372514]
Stock Position:  0.0026112997665342593
Bond Position:  [4.48365511]


portfolio before change:  [4.760226]
curr_Stock_Price:  105.69847301576498
curr_Factors:  [105.69847302  -0.62729412  -1.02524234]
mat_Sqrt:  [[20.24795863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00371264 -0.02118354  0.04759305]
Stock Position:  -0.0037126356674789663
Bond Position:  [5.15264592]


portfolio before change:  [4.75786975]
curr_Stock_Price:  106.5066248820402
curr_Factors:  [106.50662488  -0.71627822  -0.98791415]
mat_Sqrt:  [[19.37560543  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00949624 -0.09087899  0.29057642]
Stock Position:  0.00949623790281286
Bond Position:  [3.7464575]


portfolio before change:  [4.75577401]
curr_Stock_Price:  106.23661487225439
curr_Factors:  [106.23661487  -0.72966712  -0.98271377]
mat_Sqrt:  [[19.16887624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [7.79448476e-03 4.38718738e-04 1.28779243e+00]
Stock Position:  0.007794484755923987
Bond Position:  [3.92771433]


portfolio before change:  [4.75745893]
curr_Stock_Price:  106.38979080606914
curr_Factors:  [106.38979081  -0.60499588  -1.00515666]
mat_Sqrt:  [[21.2627577   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00216383  0.19339483 -1.64843131]
Stock Position:  -0.002163825399409504
Bond Position:  [4.98766786]


portfolio before change:  [4.75687644]
curr_Stock_Price:  106.94713115065743
curr_Factors:  [106.94713115  -0.81955483  -0.98976284]
mat_Sqrt:  [[17.51428698  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02439783 0.06876127 0.17668013]
Stock Position:  0.024397831822260387
Bond Position:  [2.14759832]


portfolio before change:  [4.76040739]
curr_Stock_Price:  107.08085118818062
curr_Factors:  [107.08085119  -0.60357883  -1.00903779]
mat_Sqrt:  [[21.34820266  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0072239   0.0610985  -0.29427089]
Stock Position:  -0.00722390175557491
Bond Position:  [5.53394893]


portfolio before change:  [4.75596549]
curr_Stock_Price:  107.79150376595237
curr_Factors:  [107.79150377  -0.52956949  -0.98261151]
mat_Sqrt:  [[23.76034097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00343258 -0.04513297 -0.14313476]
Stock Position:  -0.0034325754897321075
Bond Position:  [5.12596796]


portfolio before change:  [4.76141561]
curr_Stock_Price:  106.39041667063782
curr_Factors:  [106.39041667  -0.49514834  -0.9672982 ]
mat_Sqrt:  [[24.64733941  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00050223 -0.01268281 -0.02060915]
Stock Position:  -0.0005022293271723678
Bond Position:  [4.814848]


portfolio before change:  [4.76183182]
curr_Stock_Price:  106.76013939948692
curr_Factors:  [106.7601394   -0.66995659  -0.97578571]
mat_Sqrt:  [[20.59075795  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [9.01798540e-05 6.23753200e-03 1.02823824e-02]
Stock Position:  9.017985403964649e-05
Bond Position:  [4.75220421]


portfolio before change:  [4.76244138]
curr_Stock_Price:  106.93200326232044
curr_Factors:  [106.93200326  -0.7437062   -0.98337605]
mat_Sqrt:  [[19.01277076  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00624661 -0.00388994  0.47422588]
Stock Position:  0.006246609998963496
Bond Position:  [4.09447886]


portfolio before change:  [4.75734175]
curr_Stock_Price:  106.0336799860475
curr_Factors:  [106.03367999  -0.51391497  -1.01551357]
mat_Sqrt:  [[22.97319835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00891866 -0.01668109  0.64621231]
Stock Position:  0.008918657857645514
Bond Position:  [3.81166363]


portfolio before change:  [4.76849948]
curr_Stock_Price:  107.23130938569375
curr_Factors:  [107.23130939  -0.88281487  -1.01980482]
mat_Sqrt:  [[15.99647815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00284755  0.00805283 -0.29821953]
Stock Position:  -0.002847553207071731
Bond Position:  [5.07384634]


portfolio before change:  [4.76937645]
curr_Stock_Price:  107.14607760788458
curr_Factors:  [107.14607761  -0.84781972  -0.98550001]
mat_Sqrt:  [[17.1307208   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00319548 -0.00017371  0.09682843]
Stock Position:  -0.003195482408539568
Bond Position:  [5.11175986]


portfolio before change:  [4.76520938]
curr_Stock_Price:  108.65010204636064
curr_Factors:  [108.65010205  -0.70988244  -1.01016207]
mat_Sqrt:  [[19.45468932  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00580725 0.00114212 0.07235874]
Stock Position:  0.005807250573123987
Bond Position:  [4.13425101]


portfolio before change:  [4.7707985]
curr_Stock_Price:  109.52354550556235
curr_Factors:  [109.52354551  -0.85365481  -1.05376994]
mat_Sqrt:  [[16.26010891  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291571 -0.04151761 -0.67337619]
Stock Position:  -0.0029157132097656748
Bond Position:  [5.09013775]


portfolio before change:  [4.77078752]
curr_Stock_Price:  109.74554345043532
curr_Factors:  [109.74554345  -0.80076945  -1.03007306]
mat_Sqrt:  [[17.58984843  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00527565 -0.00228867  0.4066733 ]
Stock Position:  0.005275646966059927
Bond Position:  [4.19180878]


portfolio before change:  [4.76932028]
curr_Stock_Price:  109.36810189120025
curr_Factors:  [109.36810189  -0.81130032  -1.03414738]
mat_Sqrt:  [[17.27519344  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00645908 -0.03860227 -1.01191167]
Stock Position:  -0.006459081039895091
Bond Position:  [5.47573772]


portfolio before change:  [4.77599171]
curr_Stock_Price:  108.44120332411406
curr_Factors:  [108.44120332  -0.76813706  -1.00611242]
mat_Sqrt:  [[18.3927881   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00655707  0.11144536 -0.4184082 ]
Stock Position:  0.006557073133051687
Bond Position:  [4.06493481]


portfolio before change:  [4.78423685]
curr_Stock_Price:  109.62114952309275
curr_Factors:  [109.62114952  -0.8523318   -1.02297433]
mat_Sqrt:  [[16.80580222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00263829 -0.00052109 -0.03072712]
Stock Position:  -0.0026382931424512607
Bond Position:  [5.07344958]


portfolio before change:  [4.78136436]
curr_Stock_Price:  110.9503090669568
curr_Factors:  [110.95030907  -0.88049316  -1.00606808]
mat_Sqrt:  [[16.81920182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03850129 -0.10782569  1.33888989]
Stock Position:  0.03850128688082629
Bond Position:  [0.50963468]


portfolio before change:  [4.69075422]
curr_Stock_Price:  108.59522299316168
curr_Factors:  [108.59522299  -0.93543592  -0.95704786]
mat_Sqrt:  [[16.36497914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00634581  0.02289356  0.14567614]
Stock Position:  -0.006345813509157007
Bond Position:  [5.37987925]


portfolio before change:  [4.68819834]
curr_Stock_Price:  109.10396862795392
curr_Factors:  [109.10396863  -1.15964051  -0.96829206]
mat_Sqrt:  [[12.99245359  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03134871 -0.01841494  0.07827017]
Stock Position:  0.03134871308135974
Bond Position:  [1.26792934]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.66537867]
Stock Price:  108.37098227102265
PL:  [-3.70560361]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.31422966e-01 -9.79687052e-02  2.31292688e-02]
 [-6.96491691e-02  7.23408634e-02 -5.35361374e-02]
 [ 5.04572741e-03  5.70151272e-03  5.00550060e-02]
 [ 1.07281040e-01  3.17192109e-02  1.33822106e-01]
 [ 9.81586689e-02 -5.74006671e-02 -8.54784075e-02]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.22229484e-02 -1.74345112e-01 -2.75460760e-02]
 [ 7.01406497e-03  7.20988363e-01  1.06580357e-01]
 [ 3.13101220e-01  5.34895337e-03  3.02011551e-01]
 [ 4.21116508e-01  1.61042735e-01  2.65034655e-01]
 [-2.10422772e-01 -2.18099082e-01  3.48363551e-02]
 [-6.85812055e-02 -1.90838841e-02  8.85108089e-02]
 [-6.84449204e-03  2.34078391e-02  7.51442607e-02]
 [ 8.41712425e-03 -9.36403004e-02  5.48207981e-02]
 [-7.42270208e-02  1.96973159e-01 -4.03074711e-02]
 [-1.18503435e-02 -3.40493890e-02  1.95376995e-02]
 [ 4.75540038e-02  9.27016542e-02 -1.47032157e-01]
 [ 2.01414189e-02 -4.46090815e-02 -4.98322063e-02]
 [ 8.23784143e-03  1.03443325e-01 -1.71063905e-01]
 [-6.19198517e-02 -2.63295037e-03 -3.55066688e-02]
 [-3.24353054e-02  4.41516716e-01 -3.89987294e-01]
 [ 1.28805405e-01  9.70735908e-02  1.01402876e-01]
 [ 2.22703250e-03 -3.45649592e-02  7.04637051e-02]
 [ 7.24243434e-02 -1.73456096e-02 -1.71835090e-01]
 [-4.11363129e-02  1.73637062e-02 -5.35398485e-03]
 [-1.12333663e-01 -9.49042274e-03  2.27690899e-01]
 [-5.95082704e-02 -3.42917706e-02 -1.47080459e-02]
 [-9.95035600e-02  1.33909955e-01 -5.56354552e-02]
 [ 6.05157573e-02 -7.19938409e-03  1.08021492e-01]
 [ 4.01263552e-02  4.63191279e-02 -8.32485158e-02]
 [ 1.63427648e-02 -1.99054951e-02 -3.41665691e-02]
 [-4.10174741e-02  4.44890092e-02 -1.31557806e-01]
 [-1.09459389e-02  4.37965709e-02  1.02060573e-02]
 [ 4.33186240e-02 -3.05227030e-02  1.78198420e-01]
 [-7.34491181e-02 -7.35934453e-03 -2.81536603e-02]
 [-1.08242597e-01 -1.44009490e-01 -1.00357731e-01]
 [ 4.40367832e-02  1.04085979e-01  1.65568102e-01]
 [ 1.65801231e-01 -1.18518129e-01 -1.57099410e-01]
 [ 9.98577171e-02  2.50155639e-03  5.45466570e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.02010506]
curr_Stock_Price:  100.83541019175692
curr_Factors:  [100.83541019  -1.09820395  -1.01119516]
mat_Sqrt:  [[12.23242827  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02016766 -0.03161926  0.06598137]
Stock Position:  -0.02016766388372622
Bond Position:  [11.05371972]


portfolio before change:  [9.01221603]
curr_Stock_Price:  101.29509810112428
curr_Factors:  [101.2950981   -0.96684958  -1.03792284]
mat_Sqrt:  [[13.64353249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00482358  0.02334791 -0.1527237 ]
Stock Position:  -0.004823580003030923
Bond Position:  [9.50082104]


portfolio before change:  [9.01707359]
curr_Stock_Price:  100.53427692382668
curr_Factors:  [100.53427692  -0.83110472  -1.03400139]
mat_Sqrt:  [[15.57072611  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00105499 0.00184016 0.142793  ]
Stock Position:  0.0010549912072881586
Bond Position:  [8.91101081]


portfolio before change:  [9.0180617]
curr_Stock_Price:  100.41500346138882
curr_Factors:  [100.41500346  -0.91834393  -1.03299042]
mat_Sqrt:  [[14.26740098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00988772 0.01023733 0.38175722]
Stock Position:  0.009887716746403907
Bond Position:  [8.02518659]


portfolio before change:  [9.02009828]
curr_Stock_Price:  100.51951388153941
curr_Factors:  [100.51951388  -1.11737824  -1.03692475]
mat_Sqrt:  [[11.65865575  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0059178  -0.01852599 -0.2438461 ]
Stock Position:  0.005917800594402865
Bond Position:  [8.42524384]


portfolio before change:  [9.02359037]
curr_Stock_Price:  100.93163846625954
curr_Factors:  [100.93163847  -1.07108066  -1.03543464]
mat_Sqrt:  [[12.2794624   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0124846  -0.05534923  0.15513819]
Stock Position:  -0.01248460161936546
Bond Position:  [10.28368167]


portfolio before change:  [9.01677457]
curr_Stock_Price:  101.58054522853058
curr_Factors:  [101.58054523  -1.03729268  -1.05669224]
mat_Sqrt:  [[12.51423901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0074662  -0.05626964 -0.07858129]
Stock Position:  -0.00746620025279639
Bond Position:  [9.77519527]


portfolio before change:  [9.02641776]
curr_Stock_Price:  100.45263438273403
curr_Factors:  [100.45263438  -0.81406047  -1.03187762]
mat_Sqrt:  [[15.85917547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01109395 0.23269799 0.30404409]
Stock Position:  0.01109394513576496
Bond Position:  [7.91200174]


portfolio before change:  [9.02138605]
curr_Stock_Price:  99.90992641134957
curr_Factors:  [99.90992641 -0.55791815 -1.02145692]
mat_Sqrt:  [[20.59182132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01825195 0.00172637 0.86155489]
Stock Position:  0.018251951315952277
Bond Position:  [7.19783493]


portfolio before change:  [9.01488619]
curr_Stock_Price:  99.50450967914486
curr_Factors:  [99.50450968 -0.50903071 -1.01623585]
mat_Sqrt:  [[21.64850525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02346994 0.05197632 0.7560701 ]
Stock Position:  0.023469943308862047
Bond Position:  [6.67952098]


portfolio before change:  [9.00358502]
curr_Stock_Price:  98.98741622844142
curr_Factors:  [98.98741623 -0.52998603 -0.99452275]
mat_Sqrt:  [[21.55233045  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01149904 -0.07039118  0.09937842]
Stock Position:  -0.011499040437145195
Bond Position:  [10.14184533]


portfolio before change:  [8.9989698]
curr_Stock_Price:  99.49902746917792
curr_Factors:  [99.49902747 -0.61221172 -0.98730507]
mat_Sqrt:  [[20.0982164   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270718 -0.0061593   0.2524967 ]
Stock Position:  -0.002707180216508124
Bond Position:  [9.26833159]


portfolio before change:  [9.00328703]
curr_Stock_Price:  98.3322721288517
curr_Factors:  [98.33227213 -0.41852065 -0.97724882]
mat_Sqrt:  [[24.35124089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00054504 0.00755485 0.21436566]
Stock Position:  0.0005450387987637609
Bond Position:  [8.94969212]


portfolio before change:  [9.00426813]
curr_Stock_Price:  98.07967227068643
curr_Factors:  [98.07967227 -0.51742483 -0.98770235]
mat_Sqrt:  [[21.77261432  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.26489357e-05 -3.02222770e-02  1.56388478e-01]
Stock Position:  2.264893568371763e-05
Bond Position:  [9.00204673]


portfolio before change:  [9.00538401]
curr_Stock_Price:  97.66254298114475
curr_Factors:  [97.66254298 -0.479205   -0.96539777]
mat_Sqrt:  [[23.0327089   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183425  0.06357281 -0.114986  ]
Stock Position:  -0.0018342510750538605
Bond Position:  [9.18452163]


portfolio before change:  [9.00857521]
curr_Stock_Price:  96.54870320963286
curr_Factors:  [96.54870321 -0.26290458 -0.98547859]
mat_Sqrt:  [[27.70642694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00053462 -0.01098939  0.05573562]
Stock Position:  -0.0005346243236501085
Bond Position:  [9.06019249]


portfolio before change:  [9.00981987]
curr_Stock_Price:  96.3390894037547
curr_Factors:  [96.3390894  -0.47015238 -0.99011277]
mat_Sqrt:  [[22.36749969  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00163022  0.02991933 -0.41944182]
Stock Position:  0.0016302151308660586
Bond Position:  [8.85276643]


portfolio before change:  [9.01082812]
curr_Stock_Price:  96.27872225778306
curr_Factors:  [96.27872226 -0.49270281 -0.96085301]
mat_Sqrt:  [[22.50396493  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.83786495e-05 -1.43975191e-02 -1.42157414e-01]
Stock Position:  3.837864951509834e-05
Bond Position:  [9.00713307]


portfolio before change:  [9.01198141]
curr_Stock_Price:  96.99082910076696
curr_Factors:  [96.9908291  -0.62640476 -0.97829364]
mat_Sqrt:  [[19.49032195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.85534108e-04  3.33861896e-02 -4.87997706e-01]
Stock Position:  -0.0002855341075681308
Bond Position:  [9.0396756]


portfolio before change:  [9.01311489]
curr_Stock_Price:  96.97877194958133
curr_Factors:  [96.97877195 -0.53170408 -0.98454322]
mat_Sqrt:  [[21.29015625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00327405 -0.00084978 -0.10129064]
Stock Position:  -0.0032740515411344125
Bond Position:  [9.33062838]


portfolio before change:  [9.01288365]
curr_Stock_Price:  97.40565498549329
curr_Factors:  [97.40565499 -0.79026222 -1.00303024]
mat_Sqrt:  [[16.20940783  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00135211  0.14249891 -1.1125252 ]
Stock Position:  -0.0013521102345017322
Bond Position:  [9.14458683]


portfolio before change:  [9.01380709]
curr_Stock_Price:  97.56814212316566
curr_Factors:  [97.56814212 -1.00864671 -0.96702203]
mat_Sqrt:  [[13.52963272  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0125147  0.03133037 0.28927418]
Stock Position:  0.012514696239372484
Bond Position:  [7.79277143]


portfolio before change:  [9.0166688]
curr_Stock_Price:  97.71896879387243
curr_Factors:  [97.71896879 -0.94585094 -0.95557461]
mat_Sqrt:  [[14.59487067  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00065467 -0.01115579  0.20101334]
Stock Position:  0.0006546706398897644
Bond Position:  [8.95269506]


portfolio before change:  [9.01755634]
curr_Stock_Price:  97.36517729799135
curr_Factors:  [97.3651773  -0.92849152 -0.95867521]
mat_Sqrt:  [[14.75086739  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00229193 -0.00559827 -0.49019768]
Stock Position:  0.0022919326661545165
Bond Position:  [8.79440191]


portfolio before change:  [9.01794741]
curr_Stock_Price:  97.05613817876748
curr_Factors:  [97.05613818 -1.00890177 -0.95716911]
mat_Sqrt:  [[13.58842967  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0028469   0.00560411 -0.01527343]
Stock Position:  -0.0028468954636689096
Bond Position:  [9.29425609]


portfolio before change:  [9.01984221]
curr_Stock_Price:  96.7986838168326
curr_Factors:  [96.79868382 -0.94779901 -0.95313247]
mat_Sqrt:  [[14.46456567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00468688 -0.00306302  0.64953876]
Stock Position:  -0.004686879559984857
Bond Position:  [9.47352599]


portfolio before change:  [9.02912457]
curr_Stock_Price:  95.07086245179865
curr_Factors:  [95.07086245 -0.73576104 -0.93646769]
mat_Sqrt:  [[17.85696819  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00389262 -0.01106762 -0.04195796]
Stock Position:  -0.003892615775341764
Bond Position:  [9.39919891]


portfolio before change:  [9.03490302]
curr_Stock_Price:  93.88824472174429
curr_Factors:  [93.88824472 -0.77405449 -0.93433905]
mat_Sqrt:  [[17.00847326  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00491084  0.04321925 -0.15871247]
Stock Position:  -0.004910837281483818
Bond Position:  [9.49597291]


portfolio before change:  [9.02808861]
curr_Stock_Price:  95.51759528724801
curr_Factors:  [95.51759529 -1.30230981 -0.95853088]
mat_Sqrt:  [[ 9.95893147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00814304 -0.00232359  0.30815525]
Stock Position:  0.008143040652409896
Bond Position:  [8.25028495]


portfolio before change:  [9.02995129]
curr_Stock_Price:  95.61968542106203
curr_Factors:  [95.61968542 -1.26407823 -0.95828137]
mat_Sqrt:  [[10.36069279  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00314537  0.01494943 -0.23748484]
Stock Position:  0.0031453664417740086
Bond Position:  [8.72919234]


portfolio before change:  [9.03115923]
curr_Stock_Price:  95.65679498344043
curr_Factors:  [95.65679498 -1.30418661 -0.90970071]
mat_Sqrt:  [[10.45289967  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00050755 -0.00642447 -0.09746771]
Stock Position:  0.0005075482438335805
Bond Position:  [8.98260879]


portfolio before change:  [9.03246513]
curr_Stock_Price:  96.01735246569024
curr_Factors:  [96.01735247 -1.29760476 -0.86133755]
mat_Sqrt:  [[11.08493108  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00530363  0.01435877 -0.3752978 ]
Stock Position:  -0.005303625011570435
Bond Position:  [9.54170516]


portfolio before change:  [9.03366507]
curr_Stock_Price:  96.0160023838663
curr_Factors:  [96.01600238 -1.34146424 -0.88388408]
mat_Sqrt:  [[10.37258784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [7.45246782e-06 1.41352825e-02 2.91150406e-02]
Stock Position:  7.452467822883758e-06
Bond Position:  [9.03294952]


portfolio before change:  [9.03479364]
curr_Stock_Price:  95.9319963415823
curr_Factors:  [95.93199634 -1.14812095 -0.88709963]
mat_Sqrt:  [[12.53367465  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00586123 -0.00985116  0.50835049]
Stock Position:  0.005861234285104862
Bond Position:  [8.47251373]


portfolio before change:  [9.03959728]
curr_Stock_Price:  96.57085756080046
curr_Factors:  [96.57085756 -1.03650905 -0.90888606]
mat_Sqrt:  [[13.80294408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00584645 -0.00237522 -0.08031456]
Stock Position:  -0.005846446915402021
Bond Position:  [9.60419368]


portfolio before change:  [9.0440971]
curr_Stock_Price:  96.00654540996052
curr_Factors:  [96.00654541 -1.13170184 -0.91570253]
mat_Sqrt:  [[12.39151554  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01276065 -0.04647886 -0.28629267]
Stock Position:  -0.012760654384786624
Bond Position:  [10.26920345]


portfolio before change:  [9.03945961]
curr_Stock_Price:  96.47056707801535
curr_Factors:  [96.47056708 -1.16531765 -0.90590137]
mat_Sqrt:  [[12.15838354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00814908 0.03359361 0.47231971]
Stock Position:  0.008149084266312279
Bond Position:  [8.25331283]


portfolio before change:  [9.03724124]
curr_Stock_Price:  96.0717362020748
curr_Factors:  [96.0717362  -1.07474827 -0.89430397]
mat_Sqrt:  [[13.41056628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00816826 -0.03825156 -0.44816089]
Stock Position:  0.008168263280749884
Bond Position:  [8.252502]


portfolio before change:  [9.03364454]
curr_Stock_Price:  95.50511328590999
curr_Factors:  [95.50511329 -1.34385999 -0.90973285]
mat_Sqrt:  [[10.03006364  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01111684 0.00080737 0.15560643]
Stock Position:  0.011116842215072293
Bond Position:  [7.97192926]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.03152999]
Stock Price:  95.22525813606327
PL:  [9.03152999]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-1.70658847e-01 -9.90897720e-02  1.79560746e-02]
 [-1.37471370e-01  6.49366948e-02 -4.85527676e-02]
 [ 1.60943828e-02 -5.99205680e-03  5.78653544e-02]
 [ 1.07665234e-01  4.48150149e-02  1.28951675e-01]
 [ 8.32989314e-02 -3.49277371e-02 -8.24249505e-02]
 [-1.29901947e-01 -1.64381792e-01  9.45865753e-02]
 [-5.33419648e-02 -1.43937713e-01 -1.92796568e-02]
 [-9.32905423e-03  7.32265738e-01  1.31244758e-01]
 [ 2.89144845e-01 -4.92559336e-03  2.79591554e-01]
 [ 4.31827756e-01  1.65510676e-01  2.74082108e-01]
 [-2.55593198e-01 -2.65169341e-01  1.64004710e-02]
 [-4.64068946e-02 -1.83166973e-02  9.12596521e-02]
 [-8.85310942e-03  3.15069240e-02  6.82261617e-02]
 [ 1.12459774e-02 -1.22297988e-01 -3.16818470e-02]
 [ 4.34903259e-02 -5.09988139e-02 -8.18484968e-02]
 [ 1.57940537e-02 -2.78860510e-02  6.16462274e-02]
 [ 5.02058490e-02  1.91769803e-02 -2.05614042e-02]
 [-3.89281262e-02 -5.01056039e-02  5.40630918e-02]
 [ 1.13944246e-01 -1.12921857e-01 -3.67084437e-02]
 [ 4.48569595e-02 -1.23232116e-02  1.80993046e-01]
 [-3.23017911e-02  4.76416667e-01 -4.58645764e-01]
 [ 3.10795372e-01  1.84155176e-01  7.17670926e-02]
 [ 1.81856656e-02  1.02186683e-01 -1.14308000e-02]
 [ 8.99926765e-03 -1.50895332e-01 -1.36002180e-01]
 [ 5.51149083e-02  2.16417885e-02 -1.39721395e-02]
 [-6.44788570e-02 -9.38744098e-03  1.85308410e-01]
 [-2.19694756e-02 -3.26718222e-02 -2.67935268e-04]
 [-4.05437449e-02  1.07470021e-02 -2.81025125e-01]
 [-2.05091284e-02 -4.04724802e-02  5.06648033e-02]
 [-8.52078569e-02  9.14927967e-04  3.40082931e-02]
 [-2.18058901e-03 -2.63965714e-02  1.52825059e-02]
 [ 3.31819633e-02  9.57876079e-02 -6.13563782e-02]
 [-4.02970310e-02  2.37926394e-02 -1.38107662e-01]
 [ 2.94355009e-02 -4.62978516e-02  1.10039984e-01]
 [-5.82852047e-02  5.93790842e-02 -1.59813346e-02]
 [ 4.12447402e-02 -4.11000967e-02  7.98617480e-02]
 [-5.62156463e-02  9.63847750e-02  3.12713757e-02]
 [ 3.72355339e-02 -6.18065452e-02 -4.64761875e-02]
 [ 9.86418661e-02  3.25480683e-03  6.17442537e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.15042194]
curr_Stock_Price:  100.34754977856525
curr_Factors:  [100.34754978  -0.87949846  -1.00051523]
mat_Sqrt:  [[15.31183357  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01222716 -0.03198109  0.05122368]
Stock Position:  -0.012227157067206935
Bond Position:  [6.37738719]


portfolio before change:  [5.16219169]
curr_Stock_Price:  99.45015931809289
curr_Factors:  [99.45015932 -0.65157383 -1.00198134]
mat_Sqrt:  [[19.03161307  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00704759  0.02095823 -0.13850753]
Stock Position:  -0.0070475904490008845
Bond Position:  [5.86307569]


portfolio before change:  [5.15277371]
curr_Stock_Price:  100.89049711710395
curr_Factors:  [100.89049712  -0.89073696  -0.98043193]
mat_Sqrt:  [[15.53144771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.001718   -0.00193393  0.16507375]
Stock Position:  0.001717996663916476
Bond Position:  [4.97944417]


portfolio before change:  [5.15294803]
curr_Stock_Price:  100.62964016617507
curr_Factors:  [100.62964017  -0.75687694  -0.99712585]
mat_Sqrt:  [[17.41695338  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00821815 0.01446398 0.36786324]
Stock Position:  0.008218154327088575
Bond Position:  [4.32595812]


portfolio before change:  [5.15227226]
curr_Stock_Price:  100.48160864296528
curr_Factors:  [100.48160864  -0.86995866  -0.98907057]
mat_Sqrt:  [[15.65742881  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00379018 -0.01127288 -0.23513544]
Stock Position:  0.00379017621813683
Bond Position:  [4.77142926]


portfolio before change:  [5.15268425]
curr_Stock_Price:  100.43293706893353
curr_Factors:  [100.43293707  -0.93290805  -0.97347227]
mat_Sqrt:  [[14.92607803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00965752 -0.053054    0.26982917]
Stock Position:  -0.009657515932537898
Bond Position:  [6.12261694]


portfolio before change:  [5.14932518]
curr_Stock_Price:  100.86000813869576
curr_Factors:  [100.86000814  -0.94906242  -0.98370592]
mat_Sqrt:  [[14.599177    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00593585 -0.0464557  -0.05499949]
Stock Position:  -0.005935853161106742
Bond Position:  [5.74801538]


portfolio before change:  [5.15240197]
curr_Stock_Price:  100.46272017951944
curr_Factors:  [100.46272018  -0.6002816   -0.99495309]
mat_Sqrt:  [[20.37995923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0081911  0.23633775 0.37440476]
Stock Position:  0.008191100175095592
Bond Position:  [4.32950177]


portfolio before change:  [5.14711565]
curr_Stock_Price:  99.75127155457702
curr_Factors:  [99.75127155 -0.56811694 -0.98218942]
mat_Sqrt:  [[21.16552     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01631006 -0.00158973  0.79759688]
Stock Position:  0.016310055191170923
Bond Position:  [3.5201669]


portfolio before change:  [5.14628749]
curr_Stock_Price:  99.67351514538736
curr_Factors:  [99.67351515 -0.5823002  -0.96861355]
mat_Sqrt:  [[21.13617967  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02467614 0.05341834 0.78187996]
Stock Position:  0.0246761366043662
Bond Position:  [2.68673021]


portfolio before change:  [5.13340609]
curr_Stock_Price:  99.13788588638151
curr_Factors:  [99.13788589 -0.63147319 -0.93443359]
mat_Sqrt:  [[20.70975576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01479365 -0.08558304  0.04678598]
Stock Position:  -0.014793652556226571
Bond Position:  [6.60001753]


portfolio before change:  [5.14708763]
curr_Stock_Price:  98.26883169699475
curr_Factors:  [98.2688317  -0.7947881  -0.95095034]
mat_Sqrt:  [[17.14949046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183781 -0.00591169  0.26033839]
Stock Position:  -0.0018378083247062333
Bond Position:  [5.3276869]


portfolio before change:  [5.14728158]
curr_Stock_Price:  98.52568599183844
curr_Factors:  [98.52568599 -0.80997987 -0.9680936 ]
mat_Sqrt:  [[16.64722968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0006911  0.01016882 0.19463025]
Stock Position:  0.000691095256046856
Bond Position:  [5.07919095]


portfolio before change:  [5.1487194]
curr_Stock_Price:  99.68743208976069
curr_Factors:  [99.68743209 -0.78499097 -0.95164962]
mat_Sqrt:  [[17.55605696  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00114975 -0.03947151 -0.09037949]
Stock Position:  -0.0011497470537056539
Bond Position:  [5.26333473]


portfolio before change:  [5.14871171]
curr_Stock_Price:  100.26638232519328
curr_Factors:  [100.26638233  -0.74241766  -0.9658143 ]
mat_Sqrt:  [[18.16685006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090126 -0.0164598  -0.23349098]
Stock Position:  0.0009012559775133238
Bond Position:  [5.05834603]


portfolio before change:  [5.1493239]
curr_Stock_Price:  100.24403483228679
curr_Factors:  [100.24403483  -0.9239674   -0.97919906]
mat_Sqrt:  [[14.94596098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00151782 -0.00900018  0.17585953]
Stock Position:  0.0015178228337662891
Bond Position:  [4.99717121]


portfolio before change:  [5.152374]
curr_Stock_Price:  101.84199360384203
curr_Factors:  [101.8419936   -1.0488814   -0.98684333]
mat_Sqrt:  [[13.29911901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00375388  0.00618934 -0.05865596]
Stock Position:  0.0037538768269635846
Bond Position:  [4.7700717]


portfolio before change:  [5.15491149]
curr_Stock_Price:  102.35910910882079
curr_Factors:  [102.35910911  -1.21452581  -1.01666671]
mat_Sqrt:  [[10.99339657  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00346756 -0.01617151  0.15422695]
Stock Position:  -0.0034675641107763614
Bond Position:  [5.50984826]


portfolio before change:  [5.15459862]
curr_Stock_Price:  102.64796867838432
curr_Factors:  [102.64796868  -1.19356384  -1.01706777]
mat_Sqrt:  [[11.25343873  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00741116 -0.03644537 -0.10471897]
Stock Position:  0.0074111647675807425
Bond Position:  [4.39385761]


portfolio before change:  [5.15499796]
curr_Stock_Price:  102.62773807441641
curr_Factors:  [102.62773807  -1.29599423  -1.01426564]
mat_Sqrt:  [[10.18431078  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00778517 -0.0039773   0.51632278]
Stock Position:  0.007785165538877667
Bond Position:  [4.35602403]


portfolio before change:  [5.15192097]
curr_Stock_Price:  102.16255555039508
curr_Factors:  [102.16255555  -0.98153487  -0.99200154]
mat_Sqrt:  [[14.19697354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00201975  0.15376282 -1.3083887 ]
Stock Position:  -0.0020197488241643926
Bond Position:  [5.35826367]


portfolio before change:  [5.15231148]
curr_Stock_Price:  102.30084563679657
curr_Factors:  [102.30084564  -1.06451751  -0.95946135]
mat_Sqrt:  [[13.51687733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02685793 0.05943583 0.20473154]
Stock Position:  0.026857925639360396
Bond Position:  [2.40472298]


portfolio before change:  [5.1432795]
curr_Stock_Price:  101.95336554844243
curr_Factors:  [101.95336555  -0.63693005  -0.95466665]
mat_Sqrt:  [[20.7577321   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00176855  0.03298061 -0.03260889]
Stock Position:  0.0017685521901084267
Bond Position:  [4.96296965]


portfolio before change:  [5.14400003]
curr_Stock_Price:  102.00997597493831
curr_Factors:  [102.00997597  -0.81455062  -0.95211419]
mat_Sqrt:  [[17.43371196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00284297 -0.04870126 -0.38797636]
Stock Position:  -0.0028429655080370723
Bond Position:  [5.43401087]


portfolio before change:  [5.14517828]
curr_Stock_Price:  101.83447094423288
curr_Factors:  [101.83447094  -0.84480676  -0.96558728]
mat_Sqrt:  [[16.6590667   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00340238  0.00698486 -0.03985862]
Stock Position:  0.003402379610068677
Bond Position:  [4.79869875]


portfolio before change:  [5.13954449]
curr_Stock_Price:  100.00232479754449
curr_Factors:  [100.0023248   -0.87273828  -0.92748031]
mat_Sqrt:  [[16.52666009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172867 -0.00302978  0.52863331]
Stock Position:  -0.0017286698812947088
Bond Position:  [5.3124155]


portfolio before change:  [5.14254827]
curr_Stock_Price:  98.64886777842872
curr_Factors:  [98.64886778 -0.63131368 -0.91973567]
mat_Sqrt:  [[20.91606249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137183 -0.01054479 -0.00076434]
Stock Position:  -0.0013718296877748388
Bond Position:  [5.27787771]


portfolio before change:  [5.1420767]
curr_Stock_Price:  99.47356125485977
curr_Factors:  [99.47356125 -0.55286152 -0.9042552 ]
mat_Sqrt:  [[23.16807316  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00413129  0.00346858 -0.80168646]
Stock Position:  -0.004131290292583324
Bond Position:  [5.55303086]


portfolio before change:  [5.14299546]
curr_Stock_Price:  99.41920048972285
curr_Factors:  [99.41920049 -0.44864312 -0.90363872]
mat_Sqrt:  [[25.71471571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071666 -0.01306244  0.14453258]
Stock Position:  -0.0007166569275338804
Bond Position:  [5.21424492]


portfolio before change:  [5.14307066]
curr_Stock_Price:  100.22379067321029
curr_Factors:  [100.22379067  -0.47101482  -0.87374604]
mat_Sqrt:  [[26.11852229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00298942  0.00029529  0.09701619]
Stock Position:  -0.002989418136165096
Bond Position:  [5.44268148]


portfolio before change:  [5.14752855]
curr_Stock_Price:  98.96016475990794
curr_Factors:  [98.96016476 -0.31064841 -0.8478188 ]
mat_Sqrt:  [[31.07023158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0001432  -0.00851946  0.04359674]
Stock Position:  -0.0001431993878764748
Bond Position:  [5.16169958]


portfolio before change:  [5.14815062]
curr_Stock_Price:  99.12201984566212
curr_Factors:  [99.12201985 -0.37588902 -0.87160877]
mat_Sqrt:  [[28.47008341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00141237  0.03091532 -0.17503267]
Stock Position:  0.0014123670813224237
Bond Position:  [5.00815394]


portfolio before change:  [5.14855111]
curr_Stock_Price:  98.96230810965956
curr_Factors:  [98.96230811 -0.5741241  -0.89154667]
mat_Sqrt:  [[22.85267736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00278442  0.00767904 -0.39398272]
Stock Position:  -0.0027844215463543927
Bond Position:  [5.42410389]


portfolio before change:  [5.15012197]
curr_Stock_Price:  98.64166443032711
curr_Factors:  [98.64166443 -0.47899622 -0.90349765]
mat_Sqrt:  [[24.75431599  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00171472 -0.01494257  0.31391345]
Stock Position:  0.001714723578480505
Bond Position:  [4.98097878]


portfolio before change:  [5.15136381]
curr_Stock_Price:  99.00275685205459
curr_Factors:  [99.00275685 -0.49974261 -0.9113582 ]
mat_Sqrt:  [[24.14426522  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00204714  0.01916452 -0.0455903 ]
Stock Position:  -0.002047139380755332
Bond Position:  [5.35403625]


portfolio before change:  [5.15296391]
curr_Stock_Price:  98.54807218591691
curr_Factors:  [98.54807219 -0.54640332 -0.91758438]
mat_Sqrt:  [[22.79535466  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00215645 -0.013265    0.22782334]
Stock Position:  0.002156445023824939
Bond Position:  [4.94045041]


portfolio before change:  [5.15361876]
curr_Stock_Price:  98.56534886035378
curr_Factors:  [98.56534886 -0.40344871 -0.93758033]
mat_Sqrt:  [[25.78236485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00116971  0.03110805  0.08920853]
Stock Position:  -0.0011697120820468759
Bond Position:  [5.26891184]


portfolio before change:  [5.15441213]
curr_Stock_Price:  98.45017595420339
curr_Factors:  [98.45017595 -0.73181547 -0.94449639]
mat_Sqrt:  [[18.41634774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00082168 -0.01994798 -0.13258363]
Stock Position:  0.0008216837462621734
Bond Position:  [5.07351722]


portfolio before change:  [5.1538429]
curr_Stock_Price:  96.98554273208312
curr_Factors:  [96.98554273 -0.44489678 -0.93504616]
mat_Sqrt:  [[24.4008748   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0045863  0.00105048 0.17613917]
Stock Position:  0.004586300476169618
Bond Position:  [4.70903805]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.14895287]
Stock Price:  95.79096452037456
PL:  [5.14895287]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-5.69050208e-01  2.45816604e-01 -2.99621417e-02]
 [-1.66238379e-01  3.90051378e-02 -3.23821996e-03]
 [-1.06112879e-02  6.00934060e-02  4.09080368e-02]
 [ 1.12450749e-01  6.25593960e-02  1.11754435e-01]
 [-1.50273879e-01  2.55416422e-01 -2.39913116e-02]
 [-4.00232329e-02 -1.30372019e-01  2.73672822e-01]
 [-6.51404262e-02 -1.66488931e-01 -3.47105911e-02]
 [-3.32908564e-03  7.78797780e-01  1.26121173e-01]
 [ 1.11021643e-01 -7.24818936e-04  8.67656768e-02]
 [ 2.35421421e-01  8.35844587e-02  1.08183876e-01]
 [-1.24797694e-01 -1.98993970e-01  2.15912696e-02]
 [ 1.23370289e-02 -1.55708000e-02  1.02477750e-01]
 [ 4.04794588e-03 -1.74454906e-02  8.45048256e-02]
 [ 1.33451352e-02 -1.90535593e-01  2.76493320e-02]
 [ 7.99815824e-03 -4.30932942e-03 -6.22964396e-02]
 [ 1.42254304e-01  8.07438968e-03 -4.05291847e-02]
 [ 4.58241294e-02  2.70410808e-02  5.06624646e-03]
 [-4.04899329e-02 -6.04294492e-02 -5.66943065e-03]
 [ 2.89168222e-02  2.88838371e-02 -1.54635961e-01]
 [-4.14889139e-03 -6.14152942e-03 -3.39413727e-02]
 [-2.29817546e-02  3.81221396e-01 -3.35295958e-01]
 [ 8.10815242e-02  7.20690721e-02  1.11646345e-01]
 [ 7.08346445e-04 -2.77311845e-02  6.62976427e-02]
 [ 8.95541858e-02 -9.63793358e-02 -2.40433572e-01]
 [ 4.14706225e-02  1.18789455e-02 -1.33091999e-02]
 [-4.25664683e-02 -1.98213421e-03  1.48739882e-01]
 [ 6.00251205e-03 -3.28377489e-02  4.63308969e-03]
 [ 3.31341356e-02 -3.38780771e-02 -1.86031802e-01]
 [-5.01742091e-02 -2.66656519e-02 -1.14021557e-02]
 [-3.88084009e-02 -3.54313382e-03  1.07606467e-02]
 [-2.50237448e-02 -4.28656182e-02 -1.21671813e-02]
 [ 1.42340560e-02 -1.83043030e-03 -2.57327131e-02]
 [ 1.47389050e-01 -8.05420575e-03  2.94029059e-01]
 [ 1.55455314e-02 -6.42097368e-02  1.89993259e-02]
 [-3.22697815e-02 -5.68203115e-02  6.52401653e-02]
 [ 9.40543790e-02  1.49794141e-02  1.85205260e-01]
 [ 1.12909415e-01 -4.36104021e-02  3.04484459e-02]
 [-4.96566404e-02 -1.29997294e-02  2.81736974e-02]
 [ 9.20656461e-02  7.32894115e-03  1.00674169e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.51243211]
curr_Stock_Price:  98.37289547158734
curr_Factors:  [98.37289547 -0.71525695 -0.98609069]
mat_Sqrt:  [[17.946905    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02925235  0.07933697 -0.08547365]
Stock Position:  -0.029252347443214772
Bond Position:  [-7.634794]


portfolio before change:  [-10.52714377]
curr_Stock_Price:  98.84319097609654
curr_Factors:  [98.84319098 -0.73542416 -1.00466171]
mat_Sqrt:  [[17.34750671  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00916198  0.01258885 -0.00923774]
Stock Position:  -0.00916197874439866
Bond Position:  [-9.62154456]


portfolio before change:  [-10.5223244]
curr_Stock_Price:  98.18589418770418
curr_Factors:  [98.18589419 -0.78515881 -0.98174025]
mat_Sqrt:  [[16.7762383   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00059641 0.01939506 0.11669924]
Stock Position:  0.0005964117263993313
Bond Position:  [-10.58088362]


portfolio before change:  [-10.52380511]
curr_Stock_Price:  97.92095383425112
curr_Factors:  [97.92095383 -0.96185311 -0.99644601]
mat_Sqrt:  [[13.81647114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0107142  0.02019096 0.3188043 ]
Stock Position:  0.010714198210401062
Bond Position:  [-11.57294961]


portfolio before change:  [-10.53146995]
curr_Stock_Price:  97.34059011068008
curr_Factors:  [97.34059011 -0.78323143 -1.01120018]
mat_Sqrt:  [[16.18013827  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00636796  0.0824353  -0.06844053]
Stock Position:  -0.006367957102545751
Bond Position:  [-9.91160924]


portfolio before change:  [-10.53307161]
curr_Stock_Price:  97.39753657734371
curr_Factors:  [97.39753658 -0.79565326 -1.0148135 ]
mat_Sqrt:  [[15.93207166  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.76125441e-04 -4.20773882e-02  7.80712386e-01]
Stock Position:  -0.0006761254408788812
Bond Position:  [-10.46721866]


portfolio before change:  [-10.53446862]
curr_Stock_Price:  97.52847052033478
curr_Factors:  [97.52847052 -0.8615074  -1.03002506]
mat_Sqrt:  [[14.71124075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00721966 -0.05373407 -0.09901965]
Stock Position:  -0.0072196566216398955
Bond Position:  [-9.83034655]


portfolio before change:  [-10.54362658]
curr_Stock_Price:  98.62673417879307
curr_Factors:  [98.62673418 -0.97033825 -1.03323571]
mat_Sqrt:  [[13.30005805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01363804 0.2513559  0.3597886 ]
Stock Position:  0.013638039896013145
Bond Position:  [-11.88870191]


portfolio before change:  [-10.54567539]
curr_Stock_Price:  98.58547947716644
curr_Factors:  [98.58547948 -0.94370143 -1.03342749]
mat_Sqrt:  [[13.65075815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.41959839e-03 -2.33934306e-04  2.47518325e-01]
Stock Position:  0.009419598394252287
Bond Position:  [-11.47431101]


portfolio before change:  [-10.55412246]
curr_Stock_Price:  97.84100111178172
curr_Factors:  [97.84100111 -0.91281841 -1.00586556]
mat_Sqrt:  [[14.36306169  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01911612 0.02697677 0.30861848]
Stock Position:  0.019116117027389773
Bond Position:  [-12.42446248]


portfolio before change:  [-10.52209044]
curr_Stock_Price:  99.59790435835188
curr_Factors:  [99.59790436 -1.25246451 -1.00535975]
mat_Sqrt:  [[10.41572693  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01545834 -0.06422503  0.06159388]
Stock Position:  -0.015458341994650274
Bond Position:  [-8.98247198]


portfolio before change:  [-10.50811907]
curr_Stock_Price:  98.62145732943932
curr_Factors:  [98.62145733 -1.26983499 -0.97966042]
mat_Sqrt:  [[10.39987147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00289204 -0.00502545  0.2923405 ]
Stock Position:  0.002892039187260663
Bond Position:  [-10.79333619]


portfolio before change:  [-10.50782439]
curr_Stock_Price:  99.18989009460206
curr_Factors:  [99.18989009 -1.13005427 -1.01384984]
mat_Sqrt:  [[11.62469813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00152575 -0.00563051  0.24106875]
Stock Position:  0.0015257493246937435
Bond Position:  [-10.6591633]


portfolio before change:  [-10.50914576]
curr_Stock_Price:  99.19717467336423
curr_Factors:  [99.19717467 -1.28710421 -1.0154971 ]
mat_Sqrt:  [[ 9.91955659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200653 -0.0614951   0.07887585]
Stock Position:  -0.0020065295638907084
Bond Position:  [-10.31010369]


portfolio before change:  [-10.51126738]
curr_Stock_Price:  99.61221152981794
curr_Factors:  [99.61221153 -1.38791129 -1.0094735 ]
mat_Sqrt:  [[ 9.06027946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00061783 -0.00139083 -0.1777144 ]
Stock Position:  -0.0006178272367869536
Bond Position:  [-10.44972425]


portfolio before change:  [-10.51203376]
curr_Stock_Price:  98.73831370001372
curr_Factors:  [98.7383137  -1.03587002 -1.00988068]
mat_Sqrt:  [[12.76519534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01062494  0.002606   -0.11561848]
Stock Position:  0.010624944844444931
Bond Position:  [-11.5611229]


portfolio before change:  [-10.51482317]
curr_Stock_Price:  98.61180246250734
curr_Factors:  [98.61180246 -1.06706526 -1.00940782]
mat_Sqrt:  [[12.36312034  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00423663 0.00872747 0.01445259]
Stock Position:  0.004236633532027146
Bond Position:  [-10.93260524]


portfolio before change:  [-10.51803087]
curr_Stock_Price:  98.17725083432506
curr_Factors:  [98.17725083 -1.21426089 -1.00176965]
mat_Sqrt:  [[10.70535394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00504255 -0.01950352 -0.01617331]
Stock Position:  -0.005042552593308557
Bond Position:  [-10.02296691]


portfolio before change:  [-10.51992934]
curr_Stock_Price:  98.3052663629824
curr_Factors:  [98.30526636 -1.21274818 -1.01396071]
mat_Sqrt:  [[10.60545734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.06236429e-04  9.32221834e-03 -4.41133354e-01]
Stock Position:  0.00030623642883965843
Bond Position:  [-10.55003399]


portfolio before change:  [-10.52122644]
curr_Stock_Price:  98.37625224322531
curr_Factors:  [98.37625224 -1.13956905 -1.04480818]
mat_Sqrt:  [[11.07203104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111369 -0.00198217 -0.09682529]
Stock Position:  -0.0011136872256972915
Bond Position:  [-10.41166606]


portfolio before change:  [-10.52300403]
curr_Stock_Price:  98.8037079237901
curr_Factors:  [98.80370792 -1.26484549 -1.0044609 ]
mat_Sqrt:  [[10.21470905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00133212  0.12303868 -0.95650604]
Stock Position:  -0.001332124476899166
Bond Position:  [-10.39138519]


portfolio before change:  [-10.52364265]
curr_Stock_Price:  98.3079712695809
curr_Factors:  [98.30797127 -1.2362061  -1.03532537]
mat_Sqrt:  [[10.14086848  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0116935  0.02326019 0.31849595]
Stock Position:  0.011693503060580939
Bond Position:  [-11.67320721]


portfolio before change:  [-10.52607192]
curr_Stock_Price:  98.2250165018932
curr_Factors:  [98.2250165  -1.34810631 -1.03301797]
mat_Sqrt:  [[ 9.08056717  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094495 -0.0089502   0.18912872]
Stock Position:  0.0009449510811427945
Bond Position:  [-10.61888976]


portfolio before change:  [-10.52656128]
curr_Stock_Price:  99.11192990915833
curr_Factors:  [99.11192991 -1.3484903  -1.05597403]
mat_Sqrt:  [[ 8.95118103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.002324   -0.0311063  -0.68589006]
Stock Position:  0.002323999348712727
Bond Position:  [-10.75689734]


portfolio before change:  [-10.52635796]
curr_Stock_Price:  99.7780315768606
curr_Factors:  [99.77803158 -1.42591501 -1.06039424]
mat_Sqrt:  [[ 8.30318172  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00495938  0.00383391 -0.03796744]
Stock Position:  0.004959384773963765
Bond Position:  [-11.02119561]


portfolio before change:  [-10.5275955]
curr_Stock_Price:  99.80629991757573
curr_Factors:  [99.80629992 -1.46058483 -1.06981537]
mat_Sqrt:  [[ 7.94729091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00158666 -0.00063973  0.42431348]
Stock Position:  -0.0015866624861224678
Bond Position:  [-10.36923659]


portfolio before change:  [-10.52955274]
curr_Stock_Price:  100.2229025658268
curr_Factors:  [100.22290257  -1.57091118  -1.06497923]
mat_Sqrt:  [[ 7.18148596  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.41517204e-05 -1.05983379e-02  1.32169153e-02]
Stock Position:  3.4151720436628356e-05
Bond Position:  [-10.53297553]


portfolio before change:  [-10.53086674]
curr_Stock_Price:  100.30209671557306
curr_Factors:  [100.30209672  -1.41150491  -1.0637153 ]
mat_Sqrt:  [[ 8.43986568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00139277 -0.0109341  -0.53069695]
Stock Position:  -0.0013927686662940668
Bond Position:  [-10.39116912]


portfolio before change:  [-10.53236787]
curr_Stock_Price:  100.44724314427754
curr_Factors:  [100.44724314  -1.67746003  -1.07654153]
mat_Sqrt:  [[ 6.39573324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00905991 -0.0086063  -0.03252718]
Stock Position:  -0.009059910030065415
Bond Position:  [-9.62232489]


portfolio before change:  [-10.53703027]
curr_Stock_Price:  100.82909386217094
curr_Factors:  [100.82909386  -1.91348314  -1.04919356]
mat_Sqrt:  [[ 5.21088777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00716483 -0.00114354  0.03069713]
Stock Position:  -0.0071648313882589345
Bond Position:  [-9.81460682]


portfolio before change:  [-10.53909068]
curr_Stock_Price:  100.94542617652202
curr_Factors:  [100.94542618  -2.05278549  -1.07390904]
mat_Sqrt:  [[ 4.42772324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00818869 -0.01383482 -0.03470958]
Stock Position:  -0.008188693383196917
Bond Position:  [-9.71247953]


portfolio before change:  [-10.54095385]
curr_Stock_Price:  101.02468686087698
curr_Factors:  [101.02468686  -1.90631803  -1.07739058]
mat_Sqrt:  [[ 5.11233528  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00168372 -0.00059077 -0.07340827]
Stock Position:  0.0016837222925104108
Bond Position:  [-10.71105137]


portfolio before change:  [-10.54206334]
curr_Stock_Price:  101.16097951641584
curr_Factors:  [101.16097952  -2.05870869  -1.08110783]
mat_Sqrt:  [[ 4.37933369  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0469851  -0.00259948  0.83878306]
Stock Position:  0.04698509805901137
Bond Position:  [-15.29512188]


portfolio before change:  [-10.53620486]
curr_Stock_Price:  101.32636153897417
curr_Factors:  [101.32636154  -2.09844159  -1.07252945]
mat_Sqrt:  [[ 4.25194096  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00148567 -0.0207236   0.05419979]
Stock Position:  0.0014856732426447032
Bond Position:  [-10.68674272]


portfolio before change:  [-10.53780408]
curr_Stock_Price:  101.14914201284792
curr_Factors:  [101.14914201  -1.81945482  -1.06166826]
mat_Sqrt:  [[ 5.67160984  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00538667 -0.01833868  0.18611203]
Stock Position:  -0.005386669200632718
Bond Position:  [-9.99294711]


portfolio before change:  [-10.53746531]
curr_Stock_Price:  100.85434815436675
curr_Factors:  [100.85434815  -1.85539694  -1.08601265]
mat_Sqrt:  [[ 5.32422834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02534018 0.00483459 0.52833906]
Stock Position:  0.025340180005012942
Bond Position:  [-13.09313265]


portfolio before change:  [-10.53106436]
curr_Stock_Price:  101.17153994314887
curr_Factors:  [101.17153994  -1.75465919  -1.06728097]
mat_Sqrt:  [[ 6.01873637  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01831327 -0.0140752   0.08686094]
Stock Position:  0.018313269560341194
Bond Position:  [-12.38384604]


portfolio before change:  [-10.53569251]
curr_Stock_Price:  101.00335195575059
curr_Factors:  [101.00335196  -1.50898898  -1.0731848 ]
mat_Sqrt:  [[ 7.63680957  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00609669 -0.00419564  0.08037172]
Stock Position:  -0.006096690869040637
Bond Position:  [-9.9199063]


portfolio before change:  [-10.5397954]
curr_Stock_Price:  101.47292169587534
curr_Factors:  [101.4729217   -1.65623177  -1.08517488]
mat_Sqrt:  [[ 6.54293162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01744045 0.00236541 0.28719538]
Stock Position:  0.017440452577731493
Bond Position:  [-12.30952908]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.53937372]
Stock Price:  101.58533061783447
PL:  [-12.12470434]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [ 9.86985499e-02 -6.49165019e-02  7.43991285e-03]
 [-9.43043181e-04 -3.85787819e-03  8.05253502e-02]
 [-2.05240138e-01 -4.77031383e-02 -1.42451247e-01]
 [-5.79959233e-02 -1.98416821e-02  2.55047057e-03]
 [ 7.80987192e-02 -2.64006266e-02 -8.11234795e-02]
 [-1.29399056e-01 -1.71493310e-01  5.43825203e-02]
 [-5.53937166e-02 -1.53564310e-01  2.19215395e-02]
 [ 1.45957130e-02  6.66269219e-01  8.91212265e-02]
 [ 2.92487327e-01 -1.79561750e-03  2.99516516e-01]
 [ 5.41900945e-01  2.21819324e-01  4.00602241e-01]
 [-2.37253209e-01 -2.28857442e-01  3.59940159e-02]
 [-8.28946061e-02 -1.95790992e-02  8.67364452e-02]
 [-6.23231665e-03  2.00921383e-02  7.86120869e-02]
 [ 1.00432374e-02 -8.50050547e-02 -6.09306840e-02]
 [ 2.61229300e-01 -1.15810339e-01 -1.59121995e-01]
 [-1.34280643e-01 -9.20806574e-02  1.03067619e-01]
 [ 6.58488581e-02 -4.53119269e-02  3.65470587e-03]
 [ 1.83412515e-02 -3.89682651e-02 -2.69475538e-02]
 [ 3.48719270e-01 -4.63421703e-01  2.62528948e-01]
 [ 9.11584768e-02  2.12279727e-02  8.62249803e-01]
 [-6.51260280e-02  6.81216925e-01 -6.52207768e-01]
 [ 5.87035963e-01  3.16335368e-01  2.67832590e-02]
 [-1.63475093e-01  1.83627150e-01 -9.84694411e-02]
 [-1.51122058e-02 -1.49167473e-01 -9.27006657e-02]
 [ 2.39940150e-02 -3.24994822e-02 -1.02384141e-02]
 [-2.09277257e-02  1.39878579e-02  4.70697228e-02]
 [ 8.35976137e-02 -2.60128682e-02  5.87017005e-02]
 [ 1.61204690e-01 -5.83789031e-02  1.77590844e-01]
 [-3.72944216e-02  1.05876693e-02 -8.02996626e-02]
 [-5.87225712e-02 -8.85796112e-03  3.95411652e-02]
 [ 6.25898992e-03 -4.03286196e-02 -2.03439004e-02]
 [ 2.66431785e-02 -8.36446430e-02 -1.64373604e-01]
 [ 2.55976207e-04  3.96818250e-04  1.62105141e-01]
 [ 4.15422116e-03 -8.34292292e-02 -1.04278903e-01]
 [ 5.78717167e-05  3.71584748e-02  4.35733446e-02]
 [ 5.50611579e-02  3.18478002e-02  1.55452572e-01]
 [ 1.45534132e-01 -1.10622304e-01  5.95758487e-02]
 [-8.07278292e-02  2.09269351e-02  3.84275219e-02]
 [ 2.15207019e-01 -1.63805402e-02  8.57582792e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.72780241]
curr_Stock_Price:  99.60646766267128
curr_Factors:  [99.60646766 -0.82578233 -0.97509489]
mat_Sqrt:  [[16.45040143  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00528657 -0.02095171  0.021224  ]
Stock Position:  0.005286569493975273
Bond Position:  [-1.25437892]


portfolio before change:  [-0.71367315]
curr_Stock_Price:  102.30880068302069
curr_Factors:  [102.30880068  -0.87584922  -0.99070415]
mat_Sqrt:  [[15.82264802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00092947 -0.00124512  0.22971641]
Stock Position:  0.0009294676204142797
Bond Position:  [-0.80876586]


portfolio before change:  [-0.71346501]
curr_Stock_Price:  102.64150046195967
curr_Factors:  [102.64150046  -0.99908225  -0.99092173]
mat_Sqrt:  [[14.03056765  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01739454 -0.01539612 -0.40637376]
Stock Position:  -0.017394537836066874
Bond Position:  [1.07193645]


portfolio before change:  [-0.68846669]
curr_Stock_Price:  101.21206767534545
curr_Factors:  [101.21206768  -0.80327115  -0.99246128]
mat_Sqrt:  [[16.80179238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366184 -0.00640388  0.00727578]
Stock Position:  -0.003661840101030386
Bond Position:  [-0.31784428]


portfolio before change:  [-0.68575044]
curr_Stock_Price:  100.45944463967591
curr_Factors:  [100.45944464  -0.80537989  -0.98194141]
mat_Sqrt:  [[16.81771523  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00333877 -0.00852077 -0.23142271]
Stock Position:  0.003338768210237903
Bond Position:  [-1.02116124]


portfolio before change:  [-0.68418732]
curr_Stock_Price:  100.9658517640735
curr_Factors:  [100.96585176  -0.77693999  -0.98086719]
mat_Sqrt:  [[17.40878881  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00880614 -0.05534923  0.15513819]
Stock Position:  -0.008806137969304906
Bond Position:  [0.20493191]


portfolio before change:  [-0.68172879]
curr_Stock_Price:  100.6895773434888
curr_Factors:  [100.68957734  -0.72950444  -0.9499114 ]
mat_Sqrt:  [[18.77688241  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0043812  -0.04956267  0.06253605]
Stock Position:  -0.004381195061186065
Bond Position:  [-0.24058811]


portfolio before change:  [-0.68254326]
curr_Stock_Price:  100.86861433607392
curr_Factors:  [100.86861434  -0.86313607  -0.95433009]
mat_Sqrt:  [[16.38477671  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01030158 0.21503747 0.25423805]
Stock Position:  0.01030158329628479
Bond Position:  [-1.72164969]


portfolio before change:  [-0.68432136]
curr_Stock_Price:  100.71690177604528
curr_Factors:  [100.71690178  -0.8162374   -0.97180685]
mat_Sqrt:  [[16.84863055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.09666507e-02 -5.79533057e-04  8.54437252e-01]
Stock Position:  0.02096665069963547
Bond Position:  [-2.79601746]


portfolio before change:  [-0.67494814]
curr_Stock_Price:  101.18062587752702
curr_Factors:  [101.18062588  -0.68149696  -0.98062424]
mat_Sqrt:  [[19.19761584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03484559 0.07159188 1.14280669]
Stock Position:  0.034845588152803315
Bond Position:  [-4.20064656]


portfolio before change:  [-0.69827058]
curr_Stock_Price:  100.5263873038243
curr_Factors:  [100.5263873   -0.54575035  -0.97106555]
mat_Sqrt:  [[22.056434    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01254152 -0.07386342  0.10268091]
Stock Position:  -0.012541523744545062
Bond Position:  [0.56248349]


portfolio before change:  [-0.71592658]
curr_Stock_Price:  101.93979730614275
curr_Factors:  [101.93979731  -0.46483256  -0.95696749]
mat_Sqrt:  [[24.59596409  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281291 -0.00631913  0.24743494]
Stock Position:  -0.0028129074334295274
Bond Position:  [-0.42917937]


portfolio before change:  [-0.70634366]
curr_Stock_Price:  98.51395531032176
curr_Factors:  [98.51395531 -0.38655883 -0.95198206]
mat_Sqrt:  [[25.83311845  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00053867 0.00648471 0.2242584 ]
Stock Position:  0.0005386728267326499
Bond Position:  [-0.75941045]


portfolio before change:  [-0.70568261]
curr_Stock_Price:  99.91737184986772
curr_Factors:  [99.91737185 -0.50963419 -0.92617278]
mat_Sqrt:  [[23.77266965  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083061 -0.02743526 -0.17381828]
Stock Position:  -0.0008306080374636869
Bond Position:  [-0.62269043]


portfolio before change:  [-0.70740292]
curr_Stock_Price:  101.89481169751602
curr_Factors:  [101.8948117   -0.33033848  -0.96588267]
mat_Sqrt:  [[27.8747114   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00735825 -0.03737763 -0.45393076]
Stock Position:  0.0073582456038054555
Bond Position:  [-1.45716997]


portfolio before change:  [-0.66477548]
curr_Stock_Price:  107.71272102202639
curr_Factors:  [107.71272102  -0.32830951  -0.96088358]
mat_Sqrt:  [[29.67409996  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0044496  -0.0297189   0.29402323]
Stock Position:  -0.0044496021525926785
Bond Position:  [-0.18549672]


portfolio before change:  [-0.67104298]
curr_Stock_Price:  109.1160635393231
curr_Factors:  [109.11606354  -0.40612178  -0.93701357]
mat_Sqrt:  [[28.48212719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00201339 -0.01462436  0.01042586]
Stock Position:  0.002013389415612837
Bond Position:  [-0.89073611]


portfolio before change:  [-0.66600088]
curr_Stock_Price:  111.67565342719737
curr_Factors:  [111.67565343  -0.55429087  -0.97429903]
mat_Sqrt:  [[24.2158848   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00020178 -0.01257695 -0.07687387]
Stock Position:  0.0002017783510500234
Bond Position:  [-0.68853461]


portfolio before change:  [-0.66622651]
curr_Stock_Price:  110.98402828351445
curr_Factors:  [110.98402828  -0.56629097  -0.96319997]
mat_Sqrt:  [[24.04423742  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01279775 -0.14956871  0.74892202]
Stock Position:  0.012797752845542895
Bond Position:  [-2.08657267]


portfolio before change:  [-0.66299367]
curr_Stock_Price:  111.2570191497697
curr_Factors:  [111.25701915  -0.78186211  -0.93463917]
mat_Sqrt:  [[19.99219063  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01358018 0.0068513  2.45975869]
Stock Position:  0.013580183770539211
Bond Position:  [-2.17388444]


portfolio before change:  [-0.67849297]
curr_Stock_Price:  110.13571273701285
curr_Factors:  [110.13571274  -0.69604061  -0.93848969]
mat_Sqrt:  [[21.48130579  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0027561   0.21986182 -1.86056722]
Stock Position:  -0.0027560968157232285
Bond Position:  [-0.37494829]


portfolio before change:  [-0.67403999]
curr_Stock_Price:  108.50301959353693
curr_Factors:  [108.50301959  -0.32696768  -0.92615331]
mat_Sqrt:  [[30.98976561  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02120296 0.1020968  0.07640518]
Stock Position:  0.02120295996609152
Bond Position:  [-2.97462517]


portfolio before change:  [-0.71149012]
curr_Stock_Price:  106.75428829774003
curr_Factors:  [106.7542883   -0.50688427  -0.93480905]
mat_Sqrt:  [[25.25026144  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00578578  0.05926541 -0.28090591]
Stock Position:  -0.005785775674232923
Bond Position:  [-0.09383375]


portfolio before change:  [-0.69945883]
curr_Stock_Price:  104.6728021461095
curr_Factors:  [104.67280215  -0.62664754  -0.94131535]
mat_Sqrt:  [[21.8210789   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295509 -0.04814359 -0.2644492 ]
Stock Position:  -0.0029550937064392454
Bond Position:  [-0.3901409]


portfolio before change:  [-0.6997286]
curr_Stock_Price:  104.74758703911067
curr_Factors:  [104.74758704  -0.60298251  -0.92180386]
mat_Sqrt:  [[22.8001509   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00066974 -0.01048916 -0.02920735]
Stock Position:  0.0006697402353039791
Bond Position:  [-0.76988227]


portfolio before change:  [-0.69974845]
curr_Stock_Price:  104.86165652428082
curr_Factors:  [104.86165652  -0.62658801  -0.939628  ]
mat_Sqrt:  [[21.89867013  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00038653  0.00451456  0.13427682]
Stock Position:  -0.00038652572082995153
Bond Position:  [-0.65921672]


portfolio before change:  [-0.69959295]
curr_Stock_Price:  104.24617105999756
curr_Factors:  [104.24617106  -0.44333913  -0.94520995]
mat_Sqrt:  [[26.00284741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00347155 -0.00839562  0.16745961]
Stock Position:  0.0034715503354118436
Bond Position:  [-1.06148878]


portfolio before change:  [-0.6998172]
curr_Stock_Price:  104.21979868536991
curr_Factors:  [104.21979869  -0.55720959  -0.98456917]
mat_Sqrt:  [[22.30304817  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00831899 -0.01884171  0.50661725]
Stock Position:  0.008318985124684656
Bond Position:  [-1.56682015]


portfolio before change:  [-0.685576]
curr_Stock_Price:  105.95523490655304
curr_Factors:  [105.95523491  -0.66191844  -0.99620967]
mat_Sqrt:  [[20.18396705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00255274  0.00341716 -0.22907259]
Stock Position:  -0.002552735171673824
Bond Position:  [-0.41510034]


portfolio before change:  [-0.68568168]
curr_Stock_Price:  105.97630898701658
curr_Factors:  [105.97630899  -0.71647992  -0.96941552]
mat_Sqrt:  [[19.63512643  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267171 -0.00285889  0.11279994]
Stock Position:  -0.0026717112597342786
Bond Position:  [-0.40254359]


portfolio before change:  [-0.68689772]
curr_Stock_Price:  106.41262858060118
curr_Factors:  [106.41262858  -0.88864963  -0.96176859]
mat_Sqrt:  [[16.72502389  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036626 -0.01301601 -0.05803549]
Stock Position:  -0.00036626174047871605
Bond Position:  [-0.64792285]


portfolio before change:  [-0.68687932]
curr_Stock_Price:  106.14123399525502
curr_Factors:  [106.141234    -0.7359299   -0.96268775]
mat_Sqrt:  [[19.41707724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00123517 -0.02699619 -0.46891214]
Stock Position:  -0.0012351670524273664
Bond Position:  [-0.55577716]


portfolio before change:  [-0.68641616]
curr_Stock_Price:  105.71000543655592
curr_Factors:  [105.71000544  -0.68585279  -0.96555711]
mat_Sqrt:  [[20.27299387  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.64882158e-03 1.28072539e-04 4.62440847e-01]
Stock Position:  0.0016488215804457255
Bond Position:  [-0.86071309]


portfolio before change:  [-0.68990958]
curr_Stock_Price:  103.65652153711612
curr_Factors:  [103.65652154  -0.83343096  -0.97737717]
mat_Sqrt:  [[16.95011506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00201542 -0.02692667 -0.29747869]
Stock Position:  -0.002015416464218267
Bond Position:  [-0.48099852]


portfolio before change:  [-0.68856646]
curr_Stock_Price:  102.96026469563043
curr_Factors:  [102.9602647   -0.89643745  -0.97882169]
mat_Sqrt:  [[15.78537679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00104763 0.01199285 0.12430262]
Stock Position:  0.0010476268999725469
Bond Position:  [-0.7964304]


portfolio before change:  [-0.68851196]
curr_Stock_Price:  103.10732190025084
curr_Factors:  [103.1073219   -0.97251233  -0.97030677]
mat_Sqrt:  [[14.77521775  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0063142  0.01027883 0.44346292]
Stock Position:  0.006314200432853316
Bond Position:  [-1.33955226]


portfolio before change:  [-0.68897305]
curr_Stock_Price:  103.0608178953922
curr_Factors:  [103.0608179   -0.85676135  -0.96025356]
mat_Sqrt:  [[16.7484275   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00806728 -0.0357032   0.16995331]
Stock Position:  0.008067283822623263
Bond Position:  [-1.52039392]


portfolio before change:  [-0.68350547]
curr_Stock_Price:  103.7621244689718
curr_Factors:  [103.76212447  -0.89489893  -0.95770411]
mat_Sqrt:  [[16.27284836  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00421636  0.00675414  0.10962302]
Stock Position:  -0.004216357817882631
Bond Position:  [-0.24600723]


portfolio before change:  [-0.6865293]
curr_Stock_Price:  104.47199684143601
curr_Factors:  [104.47199684  -0.80237191  -0.9401348 ]
mat_Sqrt:  [[18.29105869  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01253994 -0.0052868   0.2446445 ]
Stock Position:  0.01253993521971767
Bond Position:  [-1.99660137]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.70050415]
Stock Price:  103.3774732942597
PL:  [-4.07797744]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-2.52357458e-01 -1.07667702e-01  2.17125909e-02]
 [-6.05258912e-02  7.02888434e-02 -5.43139598e-02]
 [-1.37080304e-01 -3.52687931e-02 -8.21794383e-02]
 [-5.26039104e-01 -2.53492086e-01 -3.23983472e-01]
 [ 2.64968833e-01 -2.69822356e-01 -1.05748425e-01]
 [-1.29594400e-01 -1.82607731e-01 -2.22825444e-02]
 [-5.09470234e-02 -1.38013390e-01 -3.71125398e-02]
 [ 5.23252425e-03  7.46537353e-01  1.14885209e-01]
 [ 3.26859880e-01  1.30119853e-02  3.38129037e-01]
 [ 5.85353920e-01  2.62910500e-01  5.11421914e-01]
 [-7.42206242e-02 -1.44333088e-01  3.49758775e-02]
 [-2.28134580e-02 -1.70035440e-02  9.69253942e-02]
 [ 1.45282184e-02 -5.52927714e-02  6.22734773e-02]
 [ 1.73171499e-03  1.45519736e-01 -1.55602930e-01]
 [ 3.20511215e-01 -1.34307409e-01 -1.75381913e-01]
 [-2.07078442e-01 -9.59175968e-02  1.17776585e-01]
 [ 5.13797106e-02  1.70701898e-02 -2.74270451e-02]
 [-5.52926000e-02 -5.97855249e-02  3.07629283e-02]
 [ 9.01032680e-02 -7.86363781e-02 -9.72776731e-02]
 [ 2.02569435e-02 -1.00551445e-02  8.00962245e-02]
 [-4.17981463e-02  5.44687978e-01 -5.28544236e-01]
 [ 2.81206640e-01  1.69997068e-01  7.65854089e-02]
 [ 9.63244321e-03  6.06391006e-02  1.33324576e-02]
 [-4.99310080e-02 -1.48232763e-01 -2.41639696e-02]
 [ 3.28182879e-02 -1.20606472e-02 -1.13771028e-02]
 [-3.58239447e-02  3.48016525e-03  1.17512330e-01]
 [ 5.36649583e-02 -3.34413660e-02  2.06021693e-02]
 [ 1.27354498e-01 -6.88215214e-02  2.45240888e-02]
 [-3.74757235e-02 -4.22917910e-02  3.50000051e-02]
 [-7.35443643e-02  3.49462806e-03  2.46142599e-02]
 [-8.91762880e-03 -4.24540629e-02 -3.18733987e-02]
 [ 2.41918090e-02  6.33472977e-02 -4.63994275e-02]
 [ 3.26320126e-02  1.13556045e-02  1.49758902e-01]
 [ 1.82457196e-02 -6.06315684e-02  3.77291410e-02]
 [-3.99991948e-02 -2.06510664e-03  4.34030518e-02]
 [ 9.18701341e-02  3.10156175e-02  1.98995041e-01]
 [ 1.28428419e-01 -7.30381460e-02  4.46959709e-02]
 [-5.69676318e-02 -5.36273346e-03  3.09839299e-02]
 [ 9.33912241e-02  6.50771211e-03  9.28270108e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.51569154]
curr_Stock_Price:  100.77181754660766
curr_Factors:  [100.77181755  -0.99629888  -1.000491  ]
mat_Sqrt:  [[13.6818323   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01972711 -0.0347496   0.06193998]
Stock Position:  -0.019727107174131807
Bond Position:  [10.50362799]


portfolio before change:  [8.50815015]
curr_Stock_Price:  101.22066329088321
curr_Factors:  [101.22066329  -0.77745924  -1.03234935]
mat_Sqrt:  [[16.5683513   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00345629  0.02268563 -0.15494261]
Stock Position:  -0.003456290292674547
Bond Position:  [8.85799815]


portfolio before change:  [8.50560572]
curr_Stock_Price:  102.2772163454021
curr_Factors:  [102.27721635  -0.97719401  -1.05333972]
mat_Sqrt:  [[13.4254641   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01199618 -0.01138295 -0.23443506]
Stock Position:  -0.011996182985317126
Bond Position:  [9.73254192]


portfolio before change:  [8.50875415]
curr_Stock_Price:  102.11618234496918
curr_Factors:  [102.11618234  -1.30583403  -1.05648165]
mat_Sqrt:  [[ 9.6195312   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06693838 -0.08181422 -0.92423467]
Stock Position:  -0.06693837728422274
Bond Position:  [15.34424569]


portfolio before change:  [8.45743654]
curr_Stock_Price:  102.91147753780056
curr_Factors:  [102.91147754  -1.45522403  -1.09076491]
mat_Sqrt:  [[ 8.0677952   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02334042 -0.08708479 -0.30167082]
Stock Position:  0.02334042493761714
Bond Position:  [6.05543892]


portfolio before change:  [8.46470609]
curr_Stock_Price:  103.19050333339058
curr_Factors:  [103.19050333  -1.66757349  -1.08812488]
mat_Sqrt:  [[ 6.55926435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02613364 -0.05893639 -0.0635659 ]
Stock Position:  -0.026133639858487094
Bond Position:  [11.16144954]


portfolio before change:  [8.46844332]
curr_Stock_Price:  103.10088878235473
curr_Factors:  [103.10088878  -1.51533232  -1.09543187]
mat_Sqrt:  [[ 7.57568536  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01144378 -0.04454363 -0.10587175]
Stock Position:  -0.011443777043815757
Bond Position:  [9.6483069]


portfolio before change:  [8.47887176]
curr_Stock_Price:  102.29500714769432
curr_Factors:  [102.29500715  -1.46320226  -1.0814874 ]
mat_Sqrt:  [[ 8.02989298  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02254945 0.24094389 0.32773552]
Stock Position:  0.022549449787382003
Bond Position:  [6.17217563]


portfolio before change:  [8.48693602]
curr_Stock_Price:  102.61841599945699
curr_Factors:  [102.618416    -1.37218275  -1.09461936]
mat_Sqrt:  [[ 8.70776632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.04576791 0.0041996  0.96458803]
Stock Position:  0.04576790714898099
Bond Position:  [3.79030589]


portfolio before change:  [8.50709157]
curr_Stock_Price:  103.04844942861297
curr_Factors:  [103.04844943  -1.33434558  -1.07714351]
mat_Sqrt:  [[ 9.24155506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.08044251 0.084854   1.45894437]
Stock Position:  0.08044250752565499
Bond Position:  [0.2176159]


portfolio before change:  [8.48497686]
curr_Stock_Price:  102.77319797458257
curr_Factors:  [102.77319797  -1.25846189  -1.07966119]
mat_Sqrt:  [[ 9.91849817  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00973364 -0.0465833   0.09977644]
Stock Position:  -0.009733638073261379
Bond Position:  [9.48533397]


portfolio before change:  [8.49398182]
curr_Stock_Price:  101.96987831296707
curr_Factors:  [101.96987831  -1.00746301  -1.05596164]
mat_Sqrt:  [[12.95203358  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00050181 -0.00548787  0.27650117]
Stock Position:  -0.0005018114453803572
Bond Position:  [8.54515147]


portfolio before change:  [8.49467762]
curr_Stock_Price:  102.71201515225131
curr_Factors:  [102.71201515  -1.00354614  -1.09539488]
mat_Sqrt:  [[12.59107322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00126702 -0.01784567  0.1776489 ]
Stock Position:  0.0012670205877807362
Bond Position:  [8.36453938]


portfolio before change:  [8.49556346]
curr_Stock_Price:  102.58589785627333
curr_Factors:  [102.58589786  -0.88035378  -1.1022112 ]
mat_Sqrt:  [[14.12767308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.31112654e-05  4.69662928e-02 -4.43891848e-01]
Stock Position:  -2.3111265449561416e-05
Bond Position:  [8.49793435]


portfolio before change:  [8.49662623]
curr_Stock_Price:  102.56584899298976
curr_Factors:  [102.56584899  -0.72432382  -1.08139556]
mat_Sqrt:  [[16.85733104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01526316 -0.04334753 -0.50031578]
Stock Position:  0.015263160328975645
Bond Position:  [6.93114723]


portfolio before change:  [8.50866429]
curr_Stock_Price:  103.29778231215528
curr_Factors:  [103.29778231  -0.58792603  -1.10070909]
mat_Sqrt:  [[19.08649072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0106157  -0.03095727  0.33598381]
Stock Position:  -0.010615701822036175
Bond Position:  [9.60524275]


portfolio before change:  [8.5276199]
curr_Stock_Price:  101.62527106323476
curr_Factors:  [101.62527106  -0.52696817  -1.09333686]
mat_Sqrt:  [[20.10537525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00245037  0.00550938 -0.07824173]
Stock Position:  0.0024503708943869242
Bond Position:  [8.2786003]


portfolio before change:  [8.52992343]
curr_Stock_Price:  102.14300393792087
curr_Factors:  [102.14300394  -0.47000402  -1.07257605]
mat_Sqrt:  [[21.84110536  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280283 -0.0192957   0.08775807]
Stock Position:  -0.0028028257594464962
Bond Position:  [8.81621247]


portfolio before change:  [8.53051489]
curr_Stock_Price:  102.32519082630698
curr_Factors:  [102.32519083  -0.34023238  -1.07603323]
mat_Sqrt:  [[24.82596968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00218299 -0.02537978 -0.27750612]
Stock Position:  0.0021829947980155752
Bond Position:  [8.30713953]


portfolio before change:  [8.53055065]
curr_Stock_Price:  101.86586855086361
curr_Factors:  [101.86586855  -0.50668793  -1.07406642]
mat_Sqrt:  [[20.96601065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0016481  -0.00324528  0.22849223]
Stock Position:  0.0016480969931013984
Bond Position:  [8.36266581]


portfolio before change:  [8.52987223]
curr_Stock_Price:  100.8199285017385
curr_Factors:  [100.8199285   -0.60671861  -1.08557086]
mat_Sqrt:  [[18.56070234  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207443  0.17579729 -1.50778959]
Stock Position:  -0.0020744268199239654
Bond Position:  [8.7390158]


portfolio before change:  [8.53029818]
curr_Stock_Price:  101.14122212469775
curr_Factors:  [101.14122212  -0.57056947  -1.08716094]
mat_Sqrt:  [[19.27458457  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01720089 0.05486632 0.21847685]
Stock Position:  0.017200893566330564
Bond Position:  [6.79057878]


portfolio before change:  [8.52865335]
curr_Stock_Price:  100.99624675663033
curr_Factors:  [100.99624676  -0.43972068  -1.10468608]
mat_Sqrt:  [[21.55648281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0011473  0.01957119 0.03803379]
Stock Position:  0.0011473033199517475
Bond Position:  [8.41278002]


portfolio before change:  [8.53111438]
curr_Stock_Price:  102.22466151208233
curr_Factors:  [102.22466151  -0.55096407  -1.1247533 ]
mat_Sqrt:  [[19.1337843   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00444875 -0.04784192 -0.06893308]
Stock Position:  -0.0044487458646095875
Bond Position:  [8.98588592]


portfolio before change:  [8.52873129]
curr_Stock_Price:  103.01283696161917
curr_Factors:  [103.01283696  -0.47983081  -1.12270592]
mat_Sqrt:  [[20.74524131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00135135 -0.00389256 -0.03245571]
Stock Position:  0.0013513497768191448
Bond Position:  [8.38952492]


portfolio before change:  [8.52815997]
curr_Stock_Price:  101.81397765477317
curr_Factors:  [101.81397765  -0.58298651  -1.1205179 ]
mat_Sqrt:  [[18.53466922  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060031  0.00112322  0.33522997]
Stock Position:  -0.0006003050275427335
Bond Position:  [8.58927941]


portfolio before change:  [8.52923489]
curr_Stock_Price:  101.81199042078481
curr_Factors:  [101.81199042  -0.68723705  -1.12616628]
mat_Sqrt:  [[16.60534378  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00307396 -0.01079315  0.05877225]
Stock Position:  0.003073960344882646
Bond Position:  [8.21626887]


portfolio before change:  [8.53037965]
curr_Stock_Price:  101.85026662437585
curr_Factors:  [101.85026662  -0.75989001  -1.10175329]
mat_Sqrt:  [[15.82926533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00747428 -0.02221205  0.0699604 ]
Stock Position:  0.007474277556711922
Bond Position:  [7.76912248]


portfolio before change:  [8.52107959]
curr_Stock_Price:  100.4760526503087
curr_Factors:  [100.47605265  -0.68978872  -1.11292112]
mat_Sqrt:  [[16.56363408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00235239 -0.01364962  0.09984527]
Stock Position:  -0.002352391562686834
Bond Position:  [8.75743861]


portfolio before change:  [8.52352864]
curr_Stock_Price:  99.90034120589155
curr_Factors:  [99.90034121 -0.67557718 -1.08648025]
mat_Sqrt:  [[17.1520153   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00395328  0.00112789  0.07021763]
Stock Position:  -0.003953276650399632
Bond Position:  [8.91846232]


portfolio before change:  [8.52573304]
curr_Stock_Price:  99.62474140991573
curr_Factors:  [99.62474141 -0.85052926 -1.08880895]
mat_Sqrt:  [[14.32594653  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168154 -0.01370199 -0.09092593]
Stock Position:  -0.001681540435113845
Bond Position:  [8.69325607]


portfolio before change:  [8.52672469]
curr_Stock_Price:  99.68128104478707
curr_Factors:  [99.68128104 -0.87509906 -1.06285691]
mat_Sqrt:  [[14.35390374  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00192639  0.02044525 -0.13236465]
Stock Position:  0.0019263943096510566
Bond Position:  [8.33469924]


portfolio before change:  [8.52992337]
curr_Stock_Price:  100.80087283193191
curr_Factors:  [100.80087283  -1.12363013  -1.06817131]
mat_Sqrt:  [[11.2610016   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00581825 0.00366501 0.42722046]
Stock Position:  0.005818254529017037
Bond Position:  [7.94343823]


portfolio before change:  [8.5285946]
curr_Stock_Price:  100.4018250864606
curr_Factors:  [100.40182509  -1.05311327  -1.04473319]
mat_Sqrt:  [[12.32135496  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011014  -0.01956875  0.10763074]
Stock Position:  0.0011014033159472793
Bond Position:  [8.41801169]


portfolio before change:  [8.53025369]
curr_Stock_Price:  100.9527377124552
curr_Factors:  [100.95273771  -1.21260371  -1.04554602]
mat_Sqrt:  [[10.55397678  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00299045 -0.00066651  0.12381683]
Stock Position:  -0.002990448310101878
Bond Position:  [8.83214763]


portfolio before change:  [8.52817873]
curr_Stock_Price:  102.01580659630504
curr_Factors:  [102.0158066   -1.47083451  -1.06744886]
mat_Sqrt:  [[ 8.05944262  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01722462 0.01001025 0.56767746]
Stock Position:  0.01722462330347424
Bond Position:  [6.77099489]


portfolio before change:  [8.52852935]
curr_Stock_Price:  101.9870223359826
curr_Factors:  [101.98702234  -1.34650804  -1.07469096]
mat_Sqrt:  [[ 9.05798394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01353978 -0.02357296  0.12750516]
Stock Position:  0.013539778575631631
Bond Position:  [7.14764765]


portfolio before change:  [8.52368154]
curr_Stock_Price:  101.56298816176141
curr_Factors:  [101.56298816  -1.30256624  -1.04442782]
mat_Sqrt:  [[ 9.71513634  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00532548 -0.00173081  0.08838853]
Stock Position:  -0.005325476159796868
Bond Position:  [9.06455281]


portfolio before change:  [8.52620004]
curr_Stock_Price:  101.3028502601282
curr_Factors:  [101.30285026  -1.30577956  -1.04479555]
mat_Sqrt:  [[ 9.65561328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0117722  0.00210036 0.26480962]
Stock Position:  0.011772202987919804
Bond Position:  [7.33364232]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.53517436]
Stock Price:  101.98730691527494
PL:  [6.54786745]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 1.19290778e+02 -2.92516404e+01 -2.92595345e+01]
 [-3.42621011e-02 -7.47404506e-02  1.48654441e-02]
 [-2.25905884e-01  7.16759644e-02 -4.02647562e-01]
 [-4.01731363e-02  4.60152056e-02  1.80111051e-02]
 [ 6.06051363e-02 -1.54512845e-02  1.10499395e-01]
 [ 2.82091928e-02  4.86417002e-02 -7.10151267e-02]
 [-6.74190285e-02 -1.48675926e-01  1.74292706e-01]
 [-6.40252416e-02 -1.42576821e-01  3.36513907e-02]
 [ 2.18577305e-02  7.90957056e-01  1.15312465e-01]
 [-2.08175780e-02  9.29072183e-02 -7.99667039e-02]
 [ 1.99686650e-01  6.86785514e-02  7.79998425e-02]
 [-1.18765578e-01 -2.41915519e-01 -1.03631657e-02]
 [-1.08386322e-02 -1.70861065e-02  9.56688794e-02]
 [-1.70420780e-03  1.53580920e-02  4.80580208e-02]
 [ 1.18692605e-02 -1.52481818e-01  1.20280919e-02]
 [ 9.40714211e-02 -9.10765344e-02 -9.80908971e-02]
 [ 8.03055178e-02 -9.53912082e-03  8.66914185e-03]
 [ 5.00795830e-02  1.94035964e-02 -1.98229041e-02]
 [-5.31970630e-02 -6.22462892e-02  1.11082433e-02]
 [ 5.08277802e-02  5.95345597e-03 -1.86452424e-01]
 [-3.15376588e-02  1.00896732e-02 -4.62339692e-02]
 [-3.60732966e-02  4.68425050e-01 -4.18229323e-01]
 [ 3.62632760e-01  2.08959192e-01  6.33257391e-02]
 [ 5.45320964e-03 -4.90820923e-02  7.93137601e-02]
 [ 5.65415192e-02  1.41628908e-01 -7.52582938e-02]
 [-1.05488379e-01  1.12933259e-02  1.11953923e-03]
 [-1.38583424e-01 -8.86962567e-03  2.12847003e-01]
 [-7.29594646e-02 -3.48722431e-02 -1.98823391e-02]
 [-8.31818551e-02  1.20381156e-01 -4.87202922e-02]
 [ 2.19614344e-01  6.51595165e-02  2.20919222e-01]
 [ 1.30262512e-01  8.71058347e-02 -1.75077574e-01]
 [ 1.06995139e-02  1.09977292e-02  1.70418948e-02]
 [-3.19170789e-02  2.15124158e-02 -1.03284093e-01]
 [-4.98796559e-03  8.12400381e-02 -2.62756496e-02]
 [ 1.85190051e-02 -5.85133443e-02  1.32759345e-01]
 [-8.10912199e-02  4.66856307e-02 -7.85075005e-02]
 [-2.10983455e-01 -2.15302007e-01 -1.95024927e-01]
 [ 1.19708125e-01  1.07105271e-01  2.77206759e-01]
 [ 1.99111296e-01 -1.35820956e-01 -2.28505954e-01]
 [ 9.72983828e-02  4.08712865e-03  6.96974078e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29077802 -29.25164035 -29.25953445]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93194738  -9.44092633 -83.46930751]
init_Out:  [2.49251934]
Stock Position:  7.9319473761828405
Bond position:  [-790.70221828]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.52974349]
curr_Stock_Price:  100.26929932989913
curr_Factors:  [100.26929933  -1.34875689  -0.97531778]
mat_Sqrt:  [[ 9.81375418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00473662 -0.02412238  0.04240697]
Stock Position:  -0.004736621152043985
Bond Position:  [5.00468118]


portfolio before change:  [4.53233622]
curr_Stock_Price:  99.85400272547393
curr_Factors:  [99.85400273 -1.33584612 -0.96927084]
mat_Sqrt:  [[ 9.96015056  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02946393  0.02313332 -1.14864142]
Stock Position:  -0.029463929996303262
Bond Position:  [7.47442757]


portfolio before change:  [4.52520796]
curr_Stock_Price:  100.1276466304235
curr_Factors:  [100.12764663  -1.28751603  -0.96326307]
mat_Sqrt:  [[10.54515733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257026  0.01485134  0.05138067]
Stock Position:  -0.0025702623005193267
Bond Position:  [4.78256227]


portfolio before change:  [4.52580505]
curr_Stock_Price:  100.12794559690914
curr_Factors:  [100.1279456   -1.33377355  -0.94757549]
mat_Sqrt:  [[10.22770052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00782256 -0.00498688  0.31522402]
Stock Position:  0.007822555079274828
Bond Position:  [3.74254868]


portfolio before change:  [4.52095248]
curr_Stock_Price:  99.44780828331741
curr_Factors:  [99.44780828 -1.47100706 -0.92805644]
mat_Sqrt:  [[ 9.0301544   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00261814  0.01569904 -0.20258639]
Stock Position:  0.0026181430785219154
Bond Position:  [4.26058389]


portfolio before change:  [4.52009217]
curr_Stock_Price:  98.9157810396859
curr_Factors:  [98.91578104 -1.4031723  -0.92471152]
mat_Sqrt:  [[ 9.64447271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00644826 -0.04798495  0.49720858]
Stock Position:  -0.006448255602166554
Bond Position:  [5.15792641]


portfolio before change:  [4.52360999]
curr_Stock_Price:  98.47022725773397
curr_Factors:  [98.47022726 -1.24795726 -0.92571672]
mat_Sqrt:  [[11.20186478  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00770046 -0.04601647  0.09599805]
Stock Position:  -0.0077004636074241885
Bond Position:  [5.28187639]


portfolio before change:  [4.52367775]
curr_Stock_Price:  98.54717303431882
curr_Factors:  [98.54717303 -1.36209032 -0.93534225]
mat_Sqrt:  [[ 9.90562499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.020882   0.25528029 0.32895437]
Stock Position:  0.020881996041702974
Bond Position:  [2.46581607]


portfolio before change:  [4.50586134]
curr_Stock_Price:  97.67921677067235
curr_Factors:  [97.67921677 -1.30847441 -0.9191606 ]
mat_Sqrt:  [[10.52816241  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172643  0.02998568 -0.22812275]
Stock Position:  -0.0017264272611276256
Bond Position:  [4.6744974]


portfolio before change:  [4.50587566]
curr_Stock_Price:  98.00939310936498
curr_Factors:  [98.00939311 -1.25645062 -0.9362143 ]
mat_Sqrt:  [[10.93970031  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02099027 0.02216591 0.22251184]
Stock Position:  0.020990268954783314
Bond Position:  [2.44863214]


portfolio before change:  [4.51325666]
curr_Stock_Price:  98.34644921606748
curr_Factors:  [98.34644922 -1.21601543 -0.96580825]
mat_Sqrt:  [[11.09697735  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01534307 -0.0780779  -0.02956323]
Stock Position:  -0.015343074389517018
Bond Position:  [6.02219354]


portfolio before change:  [4.51601468]
curr_Stock_Price:  98.21575848271775
curr_Factors:  [98.21575848 -1.11261727 -0.9485484 ]
mat_Sqrt:  [[12.503405    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00041605 -0.00551452  0.27291668]
Stock Position:  0.00041604739630934115
Bond Position:  [4.47515227]


portfolio before change:  [4.51697941]
curr_Stock_Price:  99.18993471644323
curr_Factors:  [99.18993472 -1.15838377 -0.96242205]
mat_Sqrt:  [[11.89633921  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00094487 0.0049568  0.13709616]
Stock Position:  0.0009448748740761722
Bond Position:  [4.42325733]


portfolio before change:  [4.51762619]
curr_Stock_Price:  99.28924576616248
curr_Factors:  [99.28924577 -0.9549669  -0.97937206]
mat_Sqrt:  [[14.34925906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00117084 -0.0492133   0.0343128 ]
Stock Position:  -0.0011708434758831306
Bond Position:  [4.63387835]


portfolio before change:  [4.51649853]
curr_Stock_Price:  100.74710408199945
curr_Factors:  [100.74710408  -0.7095105   -1.00588463]
mat_Sqrt:  [[18.12366091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00305997 -0.02939483 -0.27982603]
Stock Position:  0.003059965705873388
Bond Position:  [4.20821585]


portfolio before change:  [4.51212345]
curr_Stock_Price:  99.14540503577567
curr_Factors:  [99.14540504 -0.57743292 -1.02181986]
mat_Sqrt:  [[20.03207486  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00399998 -0.00307874  0.02473065]
Stock Position:  0.003999981764203604
Bond Position:  [4.11554364]


portfolio before change:  [4.51867588]
curr_Stock_Price:  100.65490164781353
curr_Factors:  [100.65490165  -0.80633814  -0.98799833]
mat_Sqrt:  [[16.73264117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00298781  0.00626248 -0.05654923]
Stock Position:  0.0029878123682208512
Bond Position:  [4.21793792]


portfolio before change:  [4.51744023]
curr_Stock_Price:  100.06486294850546
curr_Factors:  [100.06486295  -0.87948036  -1.01968544]
mat_Sqrt:  [[14.9790536   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0042483  -0.0200899   0.03168873]
Stock Position:  -0.00424830397323246
Bond Position:  [4.94254619]


portfolio before change:  [4.51672637]
curr_Stock_Price:  100.37833358730461
curr_Factors:  [100.37833359  -0.60502016  -1.0156704 ]
mat_Sqrt:  [[19.85102862  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00070443  0.00192147 -0.53189687]
Stock Position:  0.0007044260936912109
Bond Position:  [4.44601725]


portfolio before change:  [4.51577969]
curr_Stock_Price:  98.24543521186428
curr_Factors:  [98.24543521 -0.66648097 -1.0265437 ]
mat_Sqrt:  [[18.0734519   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215319  0.00325643 -0.13189265]
Stock Position:  -0.002153190356795858
Bond Position:  [4.72732081]


portfolio before change:  [4.51844098]
curr_Stock_Price:  97.28391505212711
curr_Factors:  [97.28391505 -0.63293274 -1.01964601]
mat_Sqrt:  [[18.63524929  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138593  0.15118353 -1.19309185]
Stock Position:  -0.0013859292287626487
Bond Position:  [4.6532696]


portfolio before change:  [4.51957819]
curr_Stock_Price:  96.88308643783817
curr_Factors:  [96.88308644 -0.50875147 -1.02762229]
mat_Sqrt:  [[20.84535618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02006263 0.06744129 0.18065071]
Stock Position:  0.020062631007756945
Bond Position:  [2.57584858]


portfolio before change:  [4.5105033]
curr_Stock_Price:  96.41470859163292
curr_Factors:  [96.41470859 -0.65930378 -1.04098992]
mat_Sqrt:  [[17.60820641  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00066016 -0.01584118  0.22626008]
Stock Position:  0.000660159400643436
Bond Position:  [4.44685423]


portfolio before change:  [4.51059763]
curr_Stock_Price:  95.71553573324736
curr_Factors:  [95.71553573 -0.50287303 -1.01413253]
mat_Sqrt:  [[20.99690552  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00333808  0.04571053 -0.21469096]
Stock Position:  0.003338080658879536
Bond Position:  [4.19109145]


portfolio before change:  [4.51140274]
curr_Stock_Price:  95.79977299662441
curr_Factors:  [95.799773   -0.55033713 -1.02150017]
mat_Sqrt:  [[19.89409614  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00517513  0.00364491  0.00319373]
Stock Position:  -0.005175134034953287
Bond Position:  [5.0071794]


portfolio before change:  [4.51154617]
curr_Stock_Price:  95.89300813869703
curr_Factors:  [95.89300814 -0.47629392 -1.04980191]
mat_Sqrt:  [[20.84548233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00465073 -0.00286266  0.60719326]
Stock Position:  -0.004650730280525093
Bond Position:  [4.95751869]


portfolio before change:  [4.5214004]
curr_Stock_Price:  93.90740530312249
curr_Factors:  [93.9074053  -0.53690225 -1.04116614]
mat_Sqrt:  [[19.37998554  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0043414  -0.01125497 -0.05671878]
Stock Position:  -0.004341396267053425
Bond Position:  [4.92908966]


portfolio before change:  [4.52301577]
curr_Stock_Price:  93.67724938777924
curr_Factors:  [93.67724939 -0.63865268 -1.01494761]
mat_Sqrt:  [[17.92605189  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00382427  0.03885285 -0.13898543]
Stock Position:  -0.003824274469542831
Bond Position:  [4.88126329]


portfolio before change:  [4.52759516]
curr_Stock_Price:  92.63935612053245
curr_Factors:  [92.63935612 -0.93070517 -1.00716202]
mat_Sqrt:  [[13.341065    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02083866 0.02103014 0.63022105]
Stock Position:  0.020838660350073937
Bond Position:  [2.59711508]


portfolio before change:  [4.50779113]
curr_Stock_Price:  91.67342602981618
curr_Factors:  [91.67342603 -0.61330563 -0.99347395]
mat_Sqrt:  [[18.38348984  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00610903  0.02811329 -0.49944759]
Stock Position:  0.006109033555406259
Bond Position:  [3.94775509]


portfolio before change:  [4.50930012]
curr_Stock_Price:  91.83965389603459
curr_Factors:  [91.8396539  -0.82707886 -0.99887415]
mat_Sqrt:  [[14.79206891  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00111026 0.0035495  0.04861578]
Stock Position:  0.0011102624188200523
Bond Position:  [4.40733401]


portfolio before change:  [4.50948089]
curr_Stock_Price:  91.50623318629914
curr_Factors:  [91.50623319 -0.69807752 -0.99570057]
mat_Sqrt:  [[16.8210151   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288976  0.0069431  -0.29464077]
Stock Position:  -0.0028897573861933266
Bond Position:  [4.7739117]


portfolio before change:  [4.50812155]
curr_Stock_Price:  92.18314684669453
curr_Factors:  [92.18314685 -0.34356794 -0.99926752]
mat_Sqrt:  [[24.06941302  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0002589   0.02622011 -0.07495711]
Stock Position:  0.00025890092272673996
Bond Position:  [4.48425525]


portfolio before change:  [4.50877463]
curr_Stock_Price:  92.54049625860209
curr_Factors:  [92.54049626 -0.33404289 -1.00187879]
mat_Sqrt:  [[24.33035283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138405 -0.0188851   0.37872546]
Stock Position:  0.0013840492480508366
Bond Position:  [4.38069403]


portfolio before change:  [4.50821516]
curr_Stock_Price:  91.74059910072695
curr_Factors:  [91.7405991  -0.38706283 -1.0091691 ]
mat_Sqrt:  [[22.70835878  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00385703  0.01506772 -0.22396005]
Stock Position:  -0.003857030478576714
Bond Position:  [4.86206144]


portfolio before change:  [4.50664218]
curr_Stock_Price:  92.30600083924453
curr_Factors:  [92.30600084 -0.32435721 -1.01616404]
mat_Sqrt:  [[24.15733136  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0122009  -0.06948842 -0.55635183]
Stock Position:  -0.012200896073004763
Bond Position:  [5.6328581]


portfolio before change:  [4.49991326]
curr_Stock_Price:  92.91522403425738
curr_Factors:  [92.91522403 -0.45660521 -1.04391024]
mat_Sqrt:  [[20.72150526  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00956279 0.03456808 0.79079372]
Stock Position:  0.00956279419482227
Bond Position:  [3.6113841]


portfolio before change:  [4.50163905]
curr_Stock_Price:  93.04848358997722
curr_Factors:  [93.04848359 -0.81598931 -1.06814728]
mat_Sqrt:  [[14.1396668   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00882223 -0.04383603 -0.65186388]
Stock Position:  0.008822228910432384
Bond Position:  [3.68074403]


portfolio before change:  [4.50018937]
curr_Stock_Price:  92.8320079004683
curr_Factors:  [92.8320079  -0.91347017 -1.07967054]
mat_Sqrt:  [[12.64991865  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00888224 0.00131912 0.1988273 ]
Stock Position:  0.008882238005161431
Bond Position:  [3.67563338]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.50277971]
Stock Price:  93.07190812741463
PL:  [4.50277971]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  -0.14940051593527484
FINAL STD P&L:  6.409795436358953
