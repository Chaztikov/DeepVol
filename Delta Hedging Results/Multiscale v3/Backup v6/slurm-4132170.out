WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-18 21:49:20.350156: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-18 21:49:20.366589: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:82:00.0
2019-12-18 21:49:20.367227: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 21:49:20.375881: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 21:49:20.380357: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 21:49:20.395243: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 21:49:20.405957: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 21:49:20.413769: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 21:49:20.424748: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 21:49:20.426716: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 21:49:20.427131: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-18 21:49:20.433612: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2399935000 Hz
2019-12-18 21:49:20.433788: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x560634659a70 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-18 21:49:20.433805: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-18 21:49:20.434870: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:82:00.0
2019-12-18 21:49:20.434894: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 21:49:20.434907: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 21:49:20.434917: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 21:49:20.434927: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 21:49:20.434937: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 21:49:20.434947: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 21:49:20.434957: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 21:49:20.436782: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 21:49:20.436812: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 21:49:20.528074: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-18 21:49:20.528109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-18 21:49:20.528121: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-18 21:49:20.531066: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
2019-12-18 21:49:20.533074: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x560634c92da0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-18 21:49:20.533092: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
INFO   Y0_true: -1.0000e+00
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:232: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:232: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:237: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:237: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:311: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:311: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:317: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:317: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:487: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:487: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:492: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:492: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:494: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:494: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:330: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:330: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:340: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:340: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:342: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:342: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:195: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:195: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-18 21:49:38.018803: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 1.2581e+02,   Y0: 2.3903e+00,  elapsed time  17
INFO   step:     1,    loss: 1.0951e+02,   Y0: 2.3853e+00,  elapsed time  24
INFO   step:     2,    loss: 1.0950e+02,   Y0: 2.3887e+00,  elapsed time  26
INFO   step:     3,    loss: 1.0949e+02,   Y0: 2.3891e+00,  elapsed time  28
INFO   step:     4,    loss: 1.0949e+02,   Y0: 2.3912e+00,  elapsed time  29
INFO   step:     5,    loss: 1.0948e+02,   Y0: 2.3935e+00,  elapsed time  31
INFO   step:     6,    loss: 1.0947e+02,   Y0: 2.3961e+00,  elapsed time  32
INFO   step:     7,    loss: 1.0946e+02,   Y0: 2.3987e+00,  elapsed time  34
INFO   step:     8,    loss: 1.0945e+02,   Y0: 2.4015e+00,  elapsed time  36
INFO   step:     9,    loss: 1.0944e+02,   Y0: 2.4046e+00,  elapsed time  37
INFO   step:    10,    loss: 1.0943e+02,   Y0: 2.4073e+00,  elapsed time  39
INFO   step:    11,    loss: 1.0941e+02,   Y0: 2.4096e+00,  elapsed time  40
INFO   step:    12,    loss: 1.0940e+02,   Y0: 2.4122e+00,  elapsed time  42
INFO   step:    13,    loss: 1.0939e+02,   Y0: 2.4146e+00,  elapsed time  43
INFO   step:    14,    loss: 1.0938e+02,   Y0: 2.4174e+00,  elapsed time  45
INFO   step:    15,    loss: 1.0937e+02,   Y0: 2.4208e+00,  elapsed time  47
INFO   step:    16,    loss: 1.0935e+02,   Y0: 2.4239e+00,  elapsed time  48
INFO   step:    17,    loss: 1.0934e+02,   Y0: 2.4271e+00,  elapsed time  50
INFO   step:    18,    loss: 1.0934e+02,   Y0: 2.4303e+00,  elapsed time  51
INFO   step:    19,    loss: 1.0933e+02,   Y0: 2.4338e+00,  elapsed time  53
INFO   step:    20,    loss: 1.0932e+02,   Y0: 2.4371e+00,  elapsed time  54
INFO   step:    21,    loss: 1.0931e+02,   Y0: 2.4405e+00,  elapsed time  56
INFO   step:    22,    loss: 1.0930e+02,   Y0: 2.4428e+00,  elapsed time  58
INFO   step:    23,    loss: 1.0929e+02,   Y0: 2.4451e+00,  elapsed time  59
INFO   step:    24,    loss: 1.0928e+02,   Y0: 2.4474e+00,  elapsed time  61
INFO   step:    25,    loss: 1.0927e+02,   Y0: 2.4501e+00,  elapsed time  62
INFO   step:    26,    loss: 1.0925e+02,   Y0: 2.4527e+00,  elapsed time  64
INFO   step:    27,    loss: 1.0923e+02,   Y0: 2.4552e+00,  elapsed time  66
INFO   step:    28,    loss: 1.0922e+02,   Y0: 2.4579e+00,  elapsed time  67
INFO   step:    29,    loss: 1.0920e+02,   Y0: 2.4595e+00,  elapsed time  69
INFO   step:    30,    loss: 1.0919e+02,   Y0: 2.4610e+00,  elapsed time  70
INFO   step:    31,    loss: 1.0918e+02,   Y0: 2.4623e+00,  elapsed time  72
INFO   step:    32,    loss: 1.0917e+02,   Y0: 2.4638e+00,  elapsed time  74
INFO   step:    33,    loss: 1.0916e+02,   Y0: 2.4647e+00,  elapsed time  75
INFO   step:    34,    loss: 1.0914e+02,   Y0: 2.4657e+00,  elapsed time  77
INFO   step:    35,    loss: 1.0913e+02,   Y0: 2.4667e+00,  elapsed time  78
INFO   step:    36,    loss: 1.0912e+02,   Y0: 2.4670e+00,  elapsed time  80
INFO   step:    37,    loss: 1.0910e+02,   Y0: 2.4675e+00,  elapsed time  82
INFO   step:    38,    loss: 1.0909e+02,   Y0: 2.4682e+00,  elapsed time  83
INFO   step:    39,    loss: 1.0908e+02,   Y0: 2.4689e+00,  elapsed time  85
INFO   step:    40,    loss: 1.0907e+02,   Y0: 2.4694e+00,  elapsed time  86
INFO   step:    41,    loss: 1.0906e+02,   Y0: 2.4703e+00,  elapsed time  88
INFO   step:    42,    loss: 1.0905e+02,   Y0: 2.4717e+00,  elapsed time  90
INFO   step:    43,    loss: 1.0903e+02,   Y0: 2.4724e+00,  elapsed time  91
INFO   step:    44,    loss: 1.0902e+02,   Y0: 2.4731e+00,  elapsed time  93
INFO   step:    45,    loss: 1.0901e+02,   Y0: 2.4729e+00,  elapsed time  94
INFO   step:    46,    loss: 1.0899e+02,   Y0: 2.4730e+00,  elapsed time  96
INFO   step:    47,    loss: 1.0898e+02,   Y0: 2.4728e+00,  elapsed time  98
INFO   step:    48,    loss: 1.0896e+02,   Y0: 2.4722e+00,  elapsed time  99
INFO   step:    49,    loss: 1.0895e+02,   Y0: 2.4723e+00,  elapsed time 101
INFO   step:    50,    loss: 1.0893e+02,   Y0: 2.4729e+00,  elapsed time 102
INFO   step:    51,    loss: 1.0892e+02,   Y0: 2.4737e+00,  elapsed time 104
INFO   step:    52,    loss: 1.0891e+02,   Y0: 2.4742e+00,  elapsed time 106
INFO   step:    53,    loss: 1.0890e+02,   Y0: 2.4749e+00,  elapsed time 107
INFO   step:    54,    loss: 1.0889e+02,   Y0: 2.4764e+00,  elapsed time 109
INFO   step:    55,    loss: 1.0887e+02,   Y0: 2.4774e+00,  elapsed time 110
INFO   step:    56,    loss: 1.0886e+02,   Y0: 2.4783e+00,  elapsed time 112
INFO   step:    57,    loss: 1.0885e+02,   Y0: 2.4784e+00,  elapsed time 114
INFO   step:    58,    loss: 1.0885e+02,   Y0: 2.4783e+00,  elapsed time 115
INFO   step:    59,    loss: 1.0884e+02,   Y0: 2.4782e+00,  elapsed time 117
INFO   step:    60,    loss: 1.0883e+02,   Y0: 2.4777e+00,  elapsed time 118
INFO   step:    61,    loss: 1.0882e+02,   Y0: 2.4774e+00,  elapsed time 120
INFO   step:    62,    loss: 1.0882e+02,   Y0: 2.4771e+00,  elapsed time 121
INFO   step:    63,    loss: 1.0881e+02,   Y0: 2.4758e+00,  elapsed time 123
INFO   step:    64,    loss: 1.0880e+02,   Y0: 2.4747e+00,  elapsed time 125
INFO   step:    65,    loss: 1.0880e+02,   Y0: 2.4743e+00,  elapsed time 126
INFO   step:    66,    loss: 1.0879e+02,   Y0: 2.4743e+00,  elapsed time 128
INFO   step:    67,    loss: 1.0878e+02,   Y0: 2.4745e+00,  elapsed time 129
INFO   step:    68,    loss: 1.0877e+02,   Y0: 2.4749e+00,  elapsed time 131
INFO   step:    69,    loss: 1.0875e+02,   Y0: 2.4758e+00,  elapsed time 133
INFO   step:    70,    loss: 1.0873e+02,   Y0: 2.4767e+00,  elapsed time 134
INFO   step:    71,    loss: 1.0872e+02,   Y0: 2.4774e+00,  elapsed time 136
INFO   step:    72,    loss: 1.0870e+02,   Y0: 2.4778e+00,  elapsed time 137
INFO   step:    73,    loss: 1.0868e+02,   Y0: 2.4786e+00,  elapsed time 139
INFO   step:    74,    loss: 1.0867e+02,   Y0: 2.4791e+00,  elapsed time 141
INFO   step:    75,    loss: 1.0865e+02,   Y0: 2.4794e+00,  elapsed time 142
INFO   step:    76,    loss: 1.0864e+02,   Y0: 2.4792e+00,  elapsed time 144
INFO   step:    77,    loss: 1.0863e+02,   Y0: 2.4783e+00,  elapsed time 145
INFO   step:    78,    loss: 1.0861e+02,   Y0: 2.4780e+00,  elapsed time 147
INFO   step:    79,    loss: 1.0860e+02,   Y0: 2.4780e+00,  elapsed time 149
INFO   step:    80,    loss: 1.0859e+02,   Y0: 2.4779e+00,  elapsed time 150
INFO   step:    81,    loss: 1.0857e+02,   Y0: 2.4771e+00,  elapsed time 152
INFO   step:    82,    loss: 1.0856e+02,   Y0: 2.4772e+00,  elapsed time 153
INFO   step:    83,    loss: 1.0854e+02,   Y0: 2.4767e+00,  elapsed time 155
INFO   step:    84,    loss: 1.0853e+02,   Y0: 2.4767e+00,  elapsed time 157
INFO   step:    85,    loss: 1.0852e+02,   Y0: 2.4761e+00,  elapsed time 158
INFO   step:    86,    loss: 1.0851e+02,   Y0: 2.4756e+00,  elapsed time 160
INFO   step:    87,    loss: 1.0849e+02,   Y0: 2.4753e+00,  elapsed time 161
INFO   step:    88,    loss: 1.0848e+02,   Y0: 2.4748e+00,  elapsed time 163
INFO   step:    89,    loss: 1.0847e+02,   Y0: 2.4744e+00,  elapsed time 165
INFO   step:    90,    loss: 1.0846e+02,   Y0: 2.4744e+00,  elapsed time 166
INFO   step:    91,    loss: 1.0844e+02,   Y0: 2.4742e+00,  elapsed time 168
INFO   step:    92,    loss: 1.0843e+02,   Y0: 2.4741e+00,  elapsed time 169
INFO   step:    93,    loss: 1.0842e+02,   Y0: 2.4743e+00,  elapsed time 171
INFO   step:    94,    loss: 1.0841e+02,   Y0: 2.4744e+00,  elapsed time 173
INFO   step:    95,    loss: 1.0839e+02,   Y0: 2.4743e+00,  elapsed time 174
INFO   step:    96,    loss: 1.0838e+02,   Y0: 2.4735e+00,  elapsed time 176
INFO   step:    97,    loss: 1.0837e+02,   Y0: 2.4730e+00,  elapsed time 177
INFO   step:    98,    loss: 1.0836e+02,   Y0: 2.4726e+00,  elapsed time 179
INFO   step:    99,    loss: 1.0834e+02,   Y0: 2.4724e+00,  elapsed time 180
INFO   step:   100,    loss: 1.0833e+02,   Y0: 2.4719e+00,  elapsed time 182
INFO   step:   101,    loss: 1.0832e+02,   Y0: 2.4716e+00,  elapsed time 184
INFO   step:   102,    loss: 1.0830e+02,   Y0: 2.4712e+00,  elapsed time 185
INFO   step:   103,    loss: 1.0829e+02,   Y0: 2.4702e+00,  elapsed time 187
INFO   step:   104,    loss: 1.0828e+02,   Y0: 2.4688e+00,  elapsed time 188
INFO   step:   105,    loss: 1.0826e+02,   Y0: 2.4688e+00,  elapsed time 190
INFO   step:   106,    loss: 1.0825e+02,   Y0: 2.4700e+00,  elapsed time 192
INFO   step:   107,    loss: 1.0824e+02,   Y0: 2.4716e+00,  elapsed time 193
INFO   step:   108,    loss: 1.0823e+02,   Y0: 2.4733e+00,  elapsed time 195
INFO   step:   109,    loss: 1.0822e+02,   Y0: 2.4754e+00,  elapsed time 196
INFO   step:   110,    loss: 1.0821e+02,   Y0: 2.4776e+00,  elapsed time 198
INFO   step:   111,    loss: 1.0820e+02,   Y0: 2.4803e+00,  elapsed time 200
INFO   step:   112,    loss: 1.0819e+02,   Y0: 2.4831e+00,  elapsed time 201
INFO   step:   113,    loss: 1.0818e+02,   Y0: 2.4849e+00,  elapsed time 203
INFO   step:   114,    loss: 1.0817e+02,   Y0: 2.4867e+00,  elapsed time 204
INFO   step:   115,    loss: 1.0816e+02,   Y0: 2.4875e+00,  elapsed time 206
INFO   step:   116,    loss: 1.0816e+02,   Y0: 2.4880e+00,  elapsed time 208
INFO   step:   117,    loss: 1.0814e+02,   Y0: 2.4882e+00,  elapsed time 209
INFO   step:   118,    loss: 1.0813e+02,   Y0: 2.4888e+00,  elapsed time 211
INFO   step:   119,    loss: 1.0812e+02,   Y0: 2.4894e+00,  elapsed time 212
INFO   step:   120,    loss: 1.0810e+02,   Y0: 2.4898e+00,  elapsed time 214
INFO   step:   121,    loss: 1.0809e+02,   Y0: 2.4900e+00,  elapsed time 216
INFO   step:   122,    loss: 1.0808e+02,   Y0: 2.4905e+00,  elapsed time 217
INFO   step:   123,    loss: 1.0807e+02,   Y0: 2.4914e+00,  elapsed time 219
INFO   step:   124,    loss: 1.0805e+02,   Y0: 2.4911e+00,  elapsed time 220
INFO   step:   125,    loss: 1.0804e+02,   Y0: 2.4909e+00,  elapsed time 222
INFO   step:   126,    loss: 1.0802e+02,   Y0: 2.4913e+00,  elapsed time 224
INFO   step:   127,    loss: 1.0801e+02,   Y0: 2.4914e+00,  elapsed time 225
INFO   step:   128,    loss: 1.0800e+02,   Y0: 2.4925e+00,  elapsed time 227
INFO   step:   129,    loss: 1.0798e+02,   Y0: 2.4936e+00,  elapsed time 228
INFO   step:   130,    loss: 1.0797e+02,   Y0: 2.4947e+00,  elapsed time 230
INFO   step:   131,    loss: 1.0796e+02,   Y0: 2.4943e+00,  elapsed time 232
INFO   step:   132,    loss: 1.0795e+02,   Y0: 2.4943e+00,  elapsed time 233
INFO   step:   133,    loss: 1.0794e+02,   Y0: 2.4938e+00,  elapsed time 235
INFO   step:   134,    loss: 1.0793e+02,   Y0: 2.4938e+00,  elapsed time 236
INFO   step:   135,    loss: 1.0792e+02,   Y0: 2.4936e+00,  elapsed time 238
INFO   step:   136,    loss: 1.0790e+02,   Y0: 2.4932e+00,  elapsed time 240
INFO   step:   137,    loss: 1.0789e+02,   Y0: 2.4931e+00,  elapsed time 241
INFO   step:   138,    loss: 1.0787e+02,   Y0: 2.4930e+00,  elapsed time 243
INFO   step:   139,    loss: 1.0786e+02,   Y0: 2.4925e+00,  elapsed time 244
INFO   step:   140,    loss: 1.0784e+02,   Y0: 2.4924e+00,  elapsed time 246
INFO   step:   141,    loss: 1.0783e+02,   Y0: 2.4921e+00,  elapsed time 247
INFO   step:   142,    loss: 1.0782e+02,   Y0: 2.4926e+00,  elapsed time 249
INFO   step:   143,    loss: 1.0780e+02,   Y0: 2.4931e+00,  elapsed time 251
INFO   step:   144,    loss: 1.0779e+02,   Y0: 2.4922e+00,  elapsed time 252
INFO   step:   145,    loss: 1.0778e+02,   Y0: 2.4916e+00,  elapsed time 254
INFO   step:   146,    loss: 1.0777e+02,   Y0: 2.4910e+00,  elapsed time 255
INFO   step:   147,    loss: 1.0776e+02,   Y0: 2.4901e+00,  elapsed time 257
INFO   step:   148,    loss: 1.0775e+02,   Y0: 2.4889e+00,  elapsed time 259
INFO   step:   149,    loss: 1.0774e+02,   Y0: 2.4878e+00,  elapsed time 260
Delta:  120 ,  120.05
Other1:  -30.05 ,  -30
Other2:  -30.05 ,  -30
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_10:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_11:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_12:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_13:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_14:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_15:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_16:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_17:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_18:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_19:0' shape=(?, 3) dtype=float64>]
num_iterations:  150
total time intervals:  20
# of dimensions:  3
Loss out:  90.70749788048103
Output_Z_Vals:  [[[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
  [ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
  [ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
  ...
  [ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
  [ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
  [ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]]

 [[ 6.17866180e-03 -2.06280354e-02  4.02613774e-02]
  [-2.60489124e-02  1.25890198e-02  4.11028912e-02]
  [ 5.30018451e-03 -1.95631625e-02  4.00696540e-02]
  ...
  [ 9.71438641e-03 -2.93594388e-02  4.70187935e-02]
  [-9.65406383e-02  1.76862662e-01  3.06267827e-03]
  [-6.90677963e-02  1.43476304e-01  1.67635687e-02]]

 [[ 3.47697616e-02  1.74632876e-01 -2.36574356e-01]
  [ 2.61130428e-02  1.53783047e-01 -2.00316126e-01]
  [ 4.37978617e-02  1.53808629e-01 -3.15110725e-01]
  ...
  [ 3.37381771e-02  9.07062325e-02 -1.83184958e-01]
  [ 2.63930728e-02  2.95740507e-02 -1.21403664e-01]
  [ 5.72106466e-03  1.09266717e-01 -1.12216021e-01]]

 ...

 [[ 1.47286017e-01 -2.40676182e-02  1.54699867e-01]
  [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
  [-7.19589628e-02 -1.04715054e-01  5.79495514e-02]
  ...
  [-6.77415357e-02  1.56723668e-02  6.80703198e-02]
  [ 2.60351876e-02  2.36579424e-02  9.72986166e-02]
  [-8.17192170e-02  1.63749071e-02  5.49726312e-02]]

 [[-1.22780150e-01  1.18969386e-01  1.27545441e-01]
  [ 4.31258889e-02 -1.28078210e-01 -3.66544677e-02]
  [ 6.57744774e-02 -4.54730240e-01 -2.84726432e-05]
  ...
  [ 4.38907066e-02 -1.33275347e-01 -3.61111084e-02]
  [-7.99243138e-02  4.07901640e-02  9.50280012e-02]
  [ 4.93405133e-02 -3.06825099e-01 -2.22026816e-02]]

 [[ 1.70138742e-01 -2.16115064e-01 -3.92357806e-01]
  [ 4.02659026e-02 -1.17496114e-01 -1.38237211e-01]
  [-2.96570185e-01 -7.70026291e-02 -1.12983083e-01]
  ...
  [-6.85565488e-02  4.86119164e-03 -3.63608068e-02]
  [ 1.05359372e-01 -7.14996993e-02 -2.75627257e-01]
  [-1.99166520e-01  2.83189985e-03 -4.90346728e-02]]]
Z_Vals dimensionality:  (20, 200, 3)
X_test:  [[[ 1.00000000e+02  1.00925049e+02  1.01009610e+02 ...  9.37679271e+01
    9.31841794e+01  9.22407886e+01]
  [-1.00000000e+00 -8.65529561e-01 -9.92208289e-01 ... -3.00514074e-01
   -1.81751170e-01 -2.52458666e-01]
  [-1.00000000e+00 -1.02717052e+00 -1.04214448e+00 ... -1.12022830e+00
   -1.13687343e+00 -1.08394518e+00]]

 [[ 1.00000000e+02  1.00482951e+02  1.01456430e+02 ...  1.00641290e+02
    9.97754951e+01  9.74750374e+01]
  [-1.00000000e+00 -1.16651855e+00 -1.36245976e+00 ... -6.01754901e-01
   -2.27135091e-01  5.96455220e-02]
  [-1.00000000e+00 -9.98362565e-01 -9.96760367e-01 ... -1.10187449e+00
   -1.12543815e+00 -1.10784631e+00]]

 [[ 1.00000000e+02  1.00901804e+02  1.00026836e+02 ...  1.14949518e+02
    1.15247889e+02  1.13617199e+02]
  [-1.00000000e+00 -8.46890099e-01 -7.17846268e-01 ... -3.69791676e-01
   -8.02897386e-01 -7.87723061e-01]
  [-1.00000000e+00 -1.00022387e+00 -9.34360725e-01 ... -9.44261152e-01
   -1.01792437e+00 -1.03021504e+00]]

 ...

 [[ 1.00000000e+02  1.00958521e+02  9.96221662e+01 ...  1.00370229e+02
    1.00342756e+02  1.01406906e+02]
  [-1.00000000e+00 -9.90651279e-01 -9.35360166e-01 ... -1.20308932e+00
   -7.63382371e-01 -8.49880484e-01]
  [-1.00000000e+00 -9.64228218e-01 -9.54942554e-01 ... -1.01091907e+00
   -1.01498029e+00 -1.01710548e+00]]

 [[ 1.00000000e+02  9.94522890e+01  9.86138456e+01 ...  9.49957299e+01
    9.46987504e+01  9.33310238e+01]
  [-1.00000000e+00 -5.38413976e-01 -5.13584126e-01 ... -7.17966768e-01
   -1.12371159e+00 -1.06503995e+00]
  [-1.00000000e+00 -1.00563560e+00 -9.99505608e-01 ... -1.17678959e+00
   -1.15582599e+00 -1.14927219e+00]]

 [[ 1.00000000e+02  9.96220451e+01  1.01783726e+02 ...  1.10270940e+02
    1.09451447e+02  1.11175896e+02]
  [-1.00000000e+00 -7.56315423e-01 -5.68959155e-01 ... -1.56208610e+00
   -1.45372935e+00 -1.37083296e+00]
  [-1.00000000e+00 -9.92925711e-01 -9.90207919e-01 ... -9.25960217e-01
   -9.23227646e-01 -9.55143244e-01]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 6.17866180e-03 -2.06280354e-02  4.02613774e-02]
 [ 3.47697616e-02  1.74632876e-01 -2.36574356e-01]
 [-2.84964914e-02  7.29070921e-03 -1.74822278e-02]
 [-1.44334577e-01 -1.11165049e-01  4.45365295e-01]
 [ 4.99617523e-02 -1.13417106e-01  6.70037575e-02]
 [-1.13820293e+00  1.14696098e+00 -1.59659570e-01]
 [-1.48186793e-03  1.23835498e-02  2.62427967e-03]
 [-9.31262990e-02 -2.19262354e-02 -1.62116749e-02]
 [ 9.96858556e-02  2.98761846e-02  6.37305109e-02]
 [-5.16857650e-01  2.78653130e-01 -2.57302233e-01]
 [ 5.42234650e-02  5.35235275e-02 -5.57437477e-02]
 [ 1.16333631e-01 -3.63299835e-02 -3.38536525e-02]
 [-4.01086332e-03 -3.19415208e-02  1.21605521e-01]
 [-1.92004210e-02  4.14618327e-02 -6.81258414e-02]
 [ 4.00762020e-03  2.56372632e-02 -5.82768618e-02]
 [ 4.81208450e-02  4.18876256e-02 -3.33765262e-02]
 [ 1.47286017e-01 -2.40676182e-02  1.54699867e-01]
 [-1.22780150e-01  1.18969386e-01  1.27545441e-01]
 [ 1.70138742e-01 -2.16115064e-01 -3.92357806e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.62787988]
curr_Stock_Price:  100.92504935097824
curr_Factors:  [100.92504935  -0.86552956  -1.02717052]
mat_Sqrt:  [[15.2058173   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00066989 -0.00665767  0.1148545 ]
Stock Position:  0.0006698949989604742
Bond Position:  [9.5602707]


portfolio before change:  [9.6303269]
curr_Stock_Price:  101.00960975948331
curr_Factors:  [101.00960976  -0.99220829  -1.04214448]
mat_Sqrt:  [[13.20853072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00167513  0.05636252 -0.67488079]
Stock Position:  0.0016751302966429423
Bond Position:  [9.46112264]


portfolio before change:  [9.63042302]
curr_Stock_Price:  99.65481716329596
curr_Factors:  [99.65481716 -0.91859676 -1.08122687]
mat_Sqrt:  [[13.4891917   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226676  0.00235307 -0.04987193]
Stock Position:  -0.002266764910824807
Bond Position:  [9.85631706]


portfolio before change:  [9.63265695]
curr_Stock_Price:  99.7564827984209
curr_Factors:  [99.7564828  -1.22673801 -1.0817499 ]
mat_Sqrt:  [[ 9.91693738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00767538 -0.03587837  1.27050322]
Stock Position:  -0.0076753774433887985
Bond Position:  [10.39832561]


portfolio before change:  [9.63907524]
curr_Stock_Price:  99.25899882061182
curr_Factors:  [99.25899882 -1.14056425 -1.07928011]
mat_Sqrt:  [[10.78210933  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00375508 -0.03660521  0.19114307]
Stock Position:  0.003755078527301943
Bond Position:  [9.2663499]


portfolio before change:  [9.64266592]
curr_Stock_Price:  99.5982204750294
curr_Factors:  [99.59822048 -1.0889677  -1.06197485]
mat_Sqrt:  [[11.59068477  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08081238  0.37018006 -0.45546431]
Stock Position:  -0.0808123847070798
Bond Position:  [17.69143563]


portfolio before change:  [9.60235655]
curr_Stock_Price:  100.15175910384274
curr_Factors:  [100.1517591   -1.04851685  -1.06713029]
mat_Sqrt:  [[12.07382015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00013099 0.00399677 0.00748634]
Stock Position:  0.0001309935383446719
Bond Position:  [9.58923732]


portfolio before change:  [9.60478755]
curr_Stock_Price:  100.40664534283674
curr_Factors:  [100.40664534  -1.14350899  -1.04116936]
mat_Sqrt:  [[11.2971451   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00893245 -0.00707666 -0.0462474 ]
Stock Position:  -0.008932448547043611
Bond Position:  [10.50166475]


portfolio before change:  [9.60537963]
curr_Stock_Price:  100.63431670852508
curr_Factors:  [100.63431671  -0.84770481  -1.04784305]
mat_Sqrt:  [[15.11889763  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00785727 0.0096425  0.18180541]
Stock Position:  0.007857268779016624
Bond Position:  [8.81466876]


portfolio before change:  [9.622583]
curr_Stock_Price:  102.54330334683313
curr_Factors:  [102.54330335  -0.63157062  -1.04262917]
mat_Sqrt:  [[19.22257544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02666133  0.08993491 -0.73401165]
Stock Position:  -0.02666132942607077
Bond Position:  [12.35652379]


portfolio before change:  [9.59782162]
curr_Stock_Price:  103.58792110933783
curr_Factors:  [103.58792111  -0.59907737  -1.03519523]
mat_Sqrt:  [[20.20940591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00266066  0.01727464 -0.1590214 ]
Stock Position:  0.0026606553735016403
Bond Position:  [9.32220986]


portfolio before change:  [9.59064757]
curr_Stock_Price:  100.01553287622424
curr_Factors:  [100.01553288  -0.41594617  -1.02818415]
mat_Sqrt:  [[23.59878383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00432257 -0.01172545 -0.09657505]
Stock Position:  0.004322572587241903
Bond Position:  [9.15832317]


portfolio before change:  [9.58310831]
curr_Stock_Price:  97.74162768777266
curr_Factors:  [97.74162769 -0.44856754 -1.02187865]
mat_Sqrt:  [[22.46326619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00063623 -0.01030908  0.3469067 ]
Stock Position:  0.0006362264477664407
Bond Position:  [9.5209225]


portfolio before change:  [9.58434585]
curr_Stock_Price:  95.94511392689756
curr_Factors:  [95.94511393 -0.67610723 -1.01228823]
mat_Sqrt:  [[17.73217607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138974  0.01338175 -0.19434406]
Stock Position:  -0.0013897442070883777
Bond Position:  [9.71768502]


portfolio before change:  [9.58867496]
curr_Stock_Price:  94.5783989143805
curr_Factors:  [94.57839891 -0.90862543 -1.03223705]
mat_Sqrt:  [[13.57957227  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00019551  0.00827439 -0.16624767]
Stock Position:  -0.0001955076288021095
Bond Position:  [9.60716576]


portfolio before change:  [9.59108709]
curr_Stock_Price:  94.52707477633874
curr_Factors:  [94.52707478 -0.72259718 -1.01668961]
mat_Sqrt:  [[16.60326739  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00300291  0.01351917 -0.09521394]
Stock Position:  0.0030029129052675154
Bond Position:  [9.30723051]


portfolio before change:  [9.59385402]
curr_Stock_Price:  94.67354515205656
curr_Factors:  [94.67354515 -0.78760818 -1.07019538]
mat_Sqrt:  [[14.77048669  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01177695 -0.00776779  0.44131566]
Stock Position:  0.011776945256904495
Bond Position:  [8.47888886]


portfolio before change:  [9.5853086]
curr_Stock_Price:  93.76792708890137
curr_Factors:  [93.76792709 -0.30051407 -1.1202283 ]
mat_Sqrt:  [[22.6482026   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00319939  0.0383972   0.36385164]
Stock Position:  -0.0031993939246528933
Bond Position:  [9.88530913]


portfolio before change:  [9.58964787]
curr_Stock_Price:  93.18417935550718
curr_Factors:  [93.18417936 -0.18175117 -1.13687343]
mat_Sqrt:  [[24.92704489  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00184277 -0.06975084 -1.11928761]
Stock Position:  0.0018427670602009778
Bond Position:  [9.41793113]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.5902642]
Stock Price:  92.24078863748323
PL:  [9.5902642]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-2.60489124e-02  1.25890198e-02  4.11028912e-02]
 [ 2.61130428e-02  1.53783047e-01 -2.00316126e-01]
 [-7.62683533e-02  3.17337218e-02 -7.01789530e-03]
 [-1.23459468e-01 -8.32335985e-02  4.02680667e-01]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-6.27975146e-01  5.95008495e-01 -4.87388033e-02]
 [ 3.10852164e-03  4.62598723e-03  1.46876045e-02]
 [-9.31262990e-02 -2.19262354e-02 -1.62116749e-02]
 [ 4.51865320e-02  3.03540050e-02  6.02091281e-02]
 [ 3.94859201e-02  1.49375333e-01  3.21354569e-02]
 [ 1.23577660e-01  3.23254086e-02 -5.27506311e-02]
 [-7.69321940e-02  1.30096092e-01  1.08447521e-01]
 [-1.02488898e-01 -8.18186985e-02  7.41364496e-02]
 [ 4.64980171e-02  3.47008198e-01 -1.42525111e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 6.58334159e-02  5.49165355e-02  1.92505515e-01]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.31258889e-02 -1.28078210e-01 -3.66544677e-02]
 [ 4.02659026e-02 -1.17496114e-01 -1.38237211e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.12088111]
curr_Stock_Price:  100.48295128390596
curr_Factors:  [100.48295128  -1.16651855  -0.99836257]
mat_Sqrt:  [[11.53178299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00130848  0.00406309  0.11725511]
Stock Position:  -0.0013084790921934406
Bond Position:  [6.25236095]


portfolio before change:  [6.12117062]
curr_Stock_Price:  101.4564301750802
curr_Factors:  [101.45643018  -1.36245976  -0.99676037]
mat_Sqrt:  [[ 9.58701251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00173302  0.04963327 -0.57144615]
Stock Position:  0.0017330234951705504
Bond Position:  [5.94534424]


portfolio before change:  [6.12071557]
curr_Stock_Price:  100.33609201579574
curr_Factors:  [100.33609202  -1.43058817  -1.0205628 ]
mat_Sqrt:  [[ 8.64840141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00823542  0.01024201 -0.0200201 ]
Stock Position:  -0.0082354244421782
Bond Position:  [6.94702587]


portfolio before change:  [6.12571668]
curr_Stock_Price:  99.9397389543574
curr_Factors:  [99.93973895 -1.33475781 -1.04535819]
mat_Sqrt:  [[ 9.2484077   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00629866 -0.02686353  1.14873586]
Stock Position:  -0.006298663581021208
Bond Position:  [6.75520347]


portfolio before change:  [6.13079434]
curr_Stock_Price:  99.40174384148672
curr_Factors:  [99.40174384 -1.43520565 -1.05388479]
mat_Sqrt:  [[ 8.24889471  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00688545 -0.04522423  0.24245377]
Stock Position:  0.00688545363959558
Bond Position:  [5.44636824]


portfolio before change:  [6.13355441]
curr_Stock_Price:  99.6048252867916
curr_Factors:  [99.60482529 -1.90025219 -1.02891856]
mat_Sqrt:  [[ 5.32301493  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09702552  0.19203817 -0.13903824]
Stock Position:  -0.09702552392546875
Bond Position:  [15.79776477]


portfolio before change:  [6.0983845]
curr_Stock_Price:  100.0080165544036
curr_Factors:  [100.00801655  -1.71313838  -1.06840451]
mat_Sqrt:  [[ 6.19478281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0011382  0.00149303 0.04189965]
Stock Position:  0.0011381984269835709
Bond Position:  [5.98455553]


portfolio before change:  [6.09986164]
curr_Stock_Price:  99.99115842806121
curr_Factors:  [99.99115843 -1.93561696 -1.06642282]
mat_Sqrt:  [[ 4.96812241  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02031173 -0.00707666 -0.0462474 ]
Stock Position:  -0.020311731266242916
Bond Position:  [8.13085518]


portfolio before change:  [6.10380096]
curr_Stock_Price:  99.89730368943073
curr_Factors:  [99.89730369 -1.93669955 -1.0450478 ]
mat_Sqrt:  [[ 5.06520872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01257059 0.00979671 0.17175988]
Stock Position:  0.012570588424989634
Bond Position:  [4.84803307]


portfolio before change:  [6.09780287]
curr_Stock_Price:  99.32372305631158
curr_Factors:  [99.32372306 -1.60655954 -1.0671019 ]
mat_Sqrt:  [[ 6.85325006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01116794 0.04821068 0.09167351]
Stock Position:  0.011167935556029658
Bond Position:  [4.98856193]


portfolio before change:  [6.08816098]
curr_Stock_Price:  98.34868233165842
curr_Factors:  [98.34868233 -1.47246274 -1.07053914]
mat_Sqrt:  [[ 7.7331576   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01544109  0.01043298 -0.15048287]
Stock Position:  0.015441089524434782
Bond Position:  [4.56955017]


portfolio before change:  [6.08630185]
curr_Stock_Price:  98.15428820838703
curr_Factors:  [98.15428821 -1.27257317 -1.03658285]
mat_Sqrt:  [[ 9.75114387  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00289604  0.04198833  0.30937059]
Stock Position:  -0.002896037967576577
Bond Position:  [6.37056039]


portfolio before change:  [6.08738339]
curr_Stock_Price:  98.33083778575399
curr_Factors:  [98.33083779 -1.16830185 -1.05823306]
mat_Sqrt:  [[10.61006172  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00980739 -0.02640687  0.21149065]
Stock Position:  -0.00980739163799562
Bond Position:  [7.05175243]


portfolio before change:  [6.09003366]
curr_Stock_Price:  98.24038435006398
curr_Factors:  [98.24038435 -1.12757893 -1.05472182]
mat_Sqrt:  [[11.07972237  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00796391  0.11199641 -0.40658447]
Stock Position:  0.007963913676649533
Bond Position:  [5.30765572]


portfolio before change:  [6.09463984]
curr_Stock_Price:  98.65212851663232
curr_Factors:  [98.65212852 -1.16652856 -1.07298427]
mat_Sqrt:  [[10.50747572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.012657   -0.09296045 -0.18429859]
Stock Position:  -0.012656996044655715
Bond Position:  [7.34327944]


portfolio before change:  [6.07606074]
curr_Stock_Price:  100.26508259321453
curr_Factors:  [100.26508259  -1.13168708  -1.05300909]
mat_Sqrt:  [[11.2810162   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01031274 0.01772424 0.54916465]
Stock Position:  0.010312743855458112
Bond Position:  [5.04205262]


portfolio before change:  [6.08660574]
curr_Stock_Price:  101.16536005926956
curr_Factors:  [101.16536006  -0.89222049  -1.0981368 ]
mat_Sqrt:  [[13.82390183  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00497615  0.00525786  0.16709793]
Stock Position:  -0.004976150496163951
Bond Position:  [6.59001979]


portfolio before change:  [6.0908613]
curr_Stock_Price:  100.6412899417835
curr_Factors:  [100.64128994  -0.6017549   -1.10187449]
mat_Sqrt:  [[18.31889818  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00051859 -0.04133706 -0.10456499]
Stock Position:  0.0005185886107742507
Bond Position:  [6.03866987]


portfolio before change:  [6.09192216]
curr_Stock_Price:  99.77549514889641
curr_Factors:  [99.77549515 -0.22713509 -1.12543815]
mat_Sqrt:  [[25.79935206  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046263 -0.03792171 -0.39435228]
Stock Position:  -0.0004626257174971736
Bond Position:  [6.13808087]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.09452113]
Stock Price:  97.47503740772508
PL:  [6.09452113]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 5.30018451e-03 -1.95631625e-02  4.00696540e-02]
 [ 4.37978617e-02  1.53808629e-01 -3.15110725e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-2.91302166e-01 -3.02072694e-01  1.03030214e+00]
 [-3.26753705e-02  8.57880247e-03 -1.51638100e-02]
 [-1.13766827e+00  1.18878830e+00 -1.69851816e-01]
 [ 1.11148832e-02 -7.92168295e-03  3.35987655e-02]
 [-8.43159964e-02 -4.33608213e-02  2.63529020e-02]
 [ 1.06881662e-01  2.95244886e-02  6.29381206e-02]
 [-2.98340622e-01  2.27359184e-01 -1.44206370e-01]
 [ 1.46210235e-01  4.94213275e-02 -5.57417448e-02]
 [-8.80555932e-02  1.24244308e-01  1.34990064e-01]
 [ 2.29818905e-01  6.54468265e-02 -1.36503991e-01]
 [ 1.80898101e-02  1.16363134e+00 -7.04750214e-01]
 [ 1.65019518e-01 -1.19459199e-01  1.27652363e-02]
 [ 1.27097118e-02 -3.90327379e-02 -1.57228740e-01]
 [-7.19589628e-02 -1.04715054e-01  5.79495514e-02]
 [ 6.57744774e-02 -4.54730240e-01 -2.84726432e-05]
 [-2.96570185e-01 -7.70026291e-02 -1.12983083e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.44348386]
curr_Stock_Price:  100.90180408288873
curr_Factors:  [100.90180408  -0.8468901   -1.00022387]
mat_Sqrt:  [[15.91136821  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00059618 -0.00631398  0.11430757]
Stock Position:  0.0005961809463740155
Bond Position:  [9.38332813]


portfolio before change:  [9.44530834]
curr_Stock_Price:  100.02683639283119
curr_Factors:  [100.02683639  -0.71784627  -0.93436072]
mat_Sqrt:  [[19.16779489  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.67212313e-04  4.96415215e-02 -8.98923187e-01]
Stock Position:  0.0005672123130723951
Bond Position:  [9.38857189]


portfolio before change:  [9.44800487]
curr_Stock_Price:  100.64228604675147
curr_Factors:  [100.64228605  -0.85290122  -0.93780187]
mat_Sqrt:  [[16.79144315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00464658  0.01370813 -0.02999186]
Stock Position:  -0.004646577296107718
Bond Position:  [9.91564703]


portfolio before change:  [9.44726898]
curr_Stock_Price:  101.33421740225674
curr_Factors:  [101.3342174   -0.73720762  -0.9643286 ]
mat_Sqrt:  [[18.4836751   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00771778 -0.09749354  2.93916522]
Stock Position:  -0.007717780817875258
Bond Position:  [10.22934426]


portfolio before change:  [9.45149137]
curr_Stock_Price:  101.11851606212723
curr_Factors:  [101.11851606  -0.72270643  -0.96911545]
mat_Sqrt:  [[18.62437797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182661  0.0027688  -0.04325813]
Stock Position:  -0.001826612923464434
Bond Position:  [9.63619576]


portfolio before change:  [9.45297219]
curr_Stock_Price:  101.62685034636414
curr_Factors:  [101.62685035  -0.64189958  -0.916631  ]
mat_Sqrt:  [[21.3868702   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0434696   0.38367977 -0.48453995]
Stock Position:  -0.04346960186120984
Bond Position:  [13.87065092]


portfolio before change:  [9.46320814]
curr_Stock_Price:  101.47115870941502
curr_Factors:  [101.47115871  -0.89646656  -0.91941705]
mat_Sqrt:  [[16.50875765  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099076 -0.00255671  0.09584793]
Stock Position:  0.0009907587277114655
Bond Position:  [9.36267471]


portfolio before change:  [9.46496321]
curr_Stock_Price:  100.87979829181624
curr_Factors:  [100.87979829  -0.701487    -0.91946027]
mat_Sqrt:  [[19.94507841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00440147 -0.01399464  0.07517749]
Stock Position:  -0.004401472962649891
Bond Position:  [9.90898291]


portfolio before change:  [9.4682798]
curr_Stock_Price:  100.689172333577
curr_Factors:  [100.68917233  -0.79886448  -0.86959399]
mat_Sqrt:  [[18.98368271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0066244  0.00952899 0.17954494]
Stock Position:  0.006624400289071564
Bond Position:  [8.80127442]


portfolio before change:  [9.477341]
curr_Stock_Price:  101.72482892605913
curr_Factors:  [101.72482893  -0.98391696  -0.86874511]
mat_Sqrt:  [[15.95240071  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01763792  0.07337986 -0.41138063]
Stock Position:  -0.017637917330219872
Bond Position:  [11.27155512]


portfolio before change:  [9.43106658]
curr_Stock_Price:  104.50818768678957
curr_Factors:  [104.50818769  -1.28379495  -0.91405672]
mat_Sqrt:  [[11.60474134  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01248801  0.01595066 -0.15901568]
Stock Position:  0.012488006478933207
Bond Position:  [8.12596766]


portfolio before change:  [9.44265574]
curr_Stock_Price:  105.2735151209615
curr_Factors:  [105.27351512  -1.1582538   -0.92553523]
mat_Sqrt:  [[13.10210409  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268198  0.04009968  0.38508908]
Stock Position:  -0.00268198132621252
Bond Position:  [9.72499735]


portfolio before change:  [9.44310504]
curr_Stock_Price:  106.01261725190463
curr_Factors:  [106.01261725  -0.74854315  -0.93271029]
mat_Sqrt:  [[19.73324287  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01091125  0.02112287 -0.38940789]
Stock Position:  0.01091125383214136
Bond Position:  [8.28637446]


portfolio before change:  [9.46654807]
curr_Stock_Price:  107.97125372356636
curr_Factors:  [107.97125372  -0.72983281  -0.87716837]
mat_Sqrt:  [[21.64693416  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00516279  0.3755604  -2.0104562 ]
Stock Position:  0.00516278780207918
Bond Position:  [8.9091154]


portfolio before change:  [9.47616184]
curr_Stock_Price:  109.40191692295834
curr_Factors:  [109.40191692  -0.25767183  -0.91949925]
mat_Sqrt:  [[33.71211713  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00424894 -0.03855529  0.03641567]
Stock Position:  0.0042489382403158036
Bond Position:  [9.01131985]


portfolio before change:  [9.48382057]
curr_Stock_Price:  110.6741459427062
curr_Factors:  [110.67414594  -0.31196045  -0.93674319]
mat_Sqrt:  [[31.7498062   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00086149 -0.01259776 -0.44852983]
Stock Position:  -0.0008614854009485547
Bond Position:  [9.57916473]


portfolio before change:  [9.48147947]
curr_Stock_Price:  116.1718548532422
curr_Factors:  [116.17185485  -0.57395709  -0.96012167]
mat_Sqrt:  [[25.05295628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325331 -0.03379664  0.16531394]
Stock Position:  -0.0032533059270269528
Bond Position:  [9.85942205]


portfolio before change:  [9.48792127]
curr_Stock_Price:  114.94951792764428
curr_Factors:  [114.94951793  -0.36979168  -0.94426115]
mat_Sqrt:  [[30.89023857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.75770384e-04 -1.46763554e-01 -8.12245258e-05]
Stock Position:  -0.0008757703838136598
Bond Position:  [9.58859065]


portfolio before change:  [9.49005741]
curr_Stock_Price:  115.24788927400682
curr_Factors:  [115.24788927  -0.80289739  -1.01792437]
mat_Sqrt:  [[18.65778729  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01797377 -0.02485249 -0.32230929]
Stock Position:  -0.017973774210947296
Bond Position:  [11.56149695]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.5222578]
Stock Price:  113.61719912597702
PL:  [-4.09494132]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 6.11424954e-04 -1.69038843e-02  4.31185922e-02]
 [ 2.50042541e-02  1.51087076e-01 -1.95686899e-01]
 [-7.69479835e-02  3.26154192e-02 -7.30487616e-03]
 [-1.03285193e-01 -5.70068615e-02  3.37337784e-01]
 [ 3.83478076e-02 -9.62716188e-02  5.54558048e-02]
 [-9.34052800e-01  9.59171857e-01 -1.25919552e-01]
 [ 6.14412766e-03 -5.04057429e-04  2.26650324e-02]
 [-9.31262990e-02 -2.19262354e-02 -1.62116749e-02]
 [ 6.69543963e-02  3.17355767e-02  6.14579487e-02]
 [ 1.36446796e-01  1.27976361e-01  8.38656519e-02]
 [ 1.23053222e-01  3.23158471e-02 -5.27451982e-02]
 [-8.85756112e-02  1.23970738e-01  1.36230926e-01]
 [-7.26194948e-02 -6.66904363e-02  8.85343083e-02]
 [ 1.60290550e-02  2.09468935e-01 -1.35380268e-01]
 [-5.77412241e-02 -2.71721811e-01 -6.06258694e-02]
 [ 3.82360813e-02  1.69419057e-02 -6.48644648e-02]
 [ 1.01580109e-01 -3.85528358e-02  1.35969112e-01]
 [-8.98124449e-02  7.46552344e-02  9.36445773e-02]
 [ 6.13814307e-02 -1.10744567e-01 -2.32468654e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.31140242]
curr_Stock_Price:  100.75909202359792
curr_Factors:  [100.75909202  -0.90824487  -1.01321514]
mat_Sqrt:  [[14.75043282  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040422 -0.00545571  0.12300534]
Stock Position:  0.00040422405678672193
Bond Position:  [8.27067317]


portfolio before change:  [8.31382288]
curr_Stock_Price:  101.63122804465426
curr_Factors:  [101.63122804  -1.14455634  -1.02316453]
mat_Sqrt:  [[11.63048858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00136713  0.04876314 -0.55824025]
Stock Position:  0.0013671268621121932
Bond Position:  [8.1748801]


portfolio before change:  [8.31395565]
curr_Stock_Price:  100.23325379943599
curr_Factors:  [100.2332538   -1.34592563  -1.0055881 ]
mat_Sqrt:  [[ 9.54470235  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00752056  0.01052658 -0.02083878]
Stock Position:  -0.007520558299927326
Bond Position:  [9.06776568]


portfolio before change:  [8.31895502]
curr_Stock_Price:  99.8699638997107
curr_Factors:  [99.8699639  -1.41650201 -1.02735499]
mat_Sqrt:  [[ 8.67124151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00531214 -0.01839889  0.9623308 ]
Stock Position:  -0.005312143973055934
Bond Position:  [8.84947864]


portfolio before change:  [8.31664013]
curr_Stock_Price:  100.72226186680614
curr_Factors:  [100.72226187  -1.32186131  -1.04561815]
mat_Sqrt:  [[ 9.43935249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00317991 -0.03107153  0.15819998]
Stock Position:  0.003179912445346083
Bond Position:  [7.99635216]


portfolio before change:  [8.31842472]
curr_Stock_Price:  100.65472673772688
curr_Factors:  [100.65472674  -1.41921538  -1.05032539]
mat_Sqrt:  [[ 8.51777654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08969076  0.30957139 -0.35921343]
Stock Position:  -0.08969076405766893
Bond Position:  [17.34622406]


portfolio before change:  [8.36432951]
curr_Stock_Price:  100.19127107088266
curr_Factors:  [100.19127107  -1.72350144  -1.07131874]
mat_Sqrt:  [[ 6.12427812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00174187 -0.00016268  0.06465703]
Stock Position:  0.0017418734919664716
Bond Position:  [8.18980899]


portfolio before change:  [8.36619209]
curr_Stock_Price:  100.08499081235027
curr_Factors:  [100.08499081  -1.9810582   -1.05465434]
mat_Sqrt:  [[ 4.80812499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02098763 -0.00707666 -0.0462474 ]
Stock Position:  -0.02098763397032761
Bond Position:  [10.46673924]


portfolio before change:  [8.37182609]
curr_Stock_Price:  99.94123994891935
curr_Factors:  [99.94123995 -1.69544188 -1.04127502]
mat_Sqrt:  [[ 6.47446197  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01327947 0.01024261 0.17532242]
Stock Position:  0.013279473315714408
Bond Position:  [7.04465906]


portfolio before change:  [8.36094275]
curr_Stock_Price:  98.98903927946344
curr_Factors:  [98.98903928 -1.44536121 -1.01467058]
mat_Sqrt:  [[ 8.45685489  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02124772 0.04130419 0.23924536]
Stock Position:  0.021247717704140467
Bond Position:  [6.25765159]


portfolio before change:  [8.35433967]
curr_Stock_Price:  98.60463590674087
curr_Factors:  [98.60463591 -1.4674132  -1.01700661]
mat_Sqrt:  [[ 8.2210544   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01446081  0.01042989 -0.15046737]
Stock Position:  0.014460809064617953
Bond Position:  [6.92843685]


portfolio before change:  [8.34013681]
curr_Stock_Price:  97.5026794270522
curr_Factors:  [97.50267943 -1.40628328 -0.98831325]
mat_Sqrt:  [[ 8.89316788  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00398757  0.04001138  0.38862891]
Stock Position:  -0.0039875744465846024
Bond Position:  [8.728936]


portfolio before change:  [8.34047897]
curr_Stock_Price:  97.96419868423112
curr_Factors:  [97.96419868 -1.02405165 -1.00411708]
mat_Sqrt:  [[12.8897621   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00528797 -0.02152425  0.25256374]
Stock Position:  -0.00528796672837104
Bond Position:  [8.8585104]


portfolio before change:  [8.34531852]
curr_Stock_Price:  97.46785621723382
curr_Factors:  [97.46785622 -0.76838357 -1.00225704]
mat_Sqrt:  [[16.59135924  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00187762  0.06760581 -0.38620222]
Stock Position:  0.0018776243981412108
Bond Position:  [8.1623105]


portfolio before change:  [8.34587849]
curr_Stock_Price:  96.67916602596961
curr_Factors:  [96.67916603 -0.47435222 -1.02865045]
mat_Sqrt:  [[21.50736138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.005839   -0.08769784 -0.17294873]
Stock Position:  -0.0058389966113791695
Bond Position:  [8.91038781]


portfolio before change:  [8.35174575]
curr_Stock_Price:  96.05587696522355
curr_Factors:  [96.05587697 -0.53646299 -1.04738632]
mat_Sqrt:  [[19.70910614  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144369  0.00546798 -0.18504026]
Stock Position:  0.0014436945885760073
Bond Position:  [8.2130704]


portfolio before change:  [8.35220982]
curr_Stock_Price:  94.95491651263336
curr_Factors:  [94.95491651 -0.54715689 -1.03598704]
mat_Sqrt:  [[19.49695468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00622995 -0.01244287  0.38788203]
Stock Position:  0.006229953600826654
Bond Position:  [7.7606451]


portfolio before change:  [8.353929]
curr_Stock_Price:  94.91940687991142
curr_Factors:  [94.91940688 -0.62498551 -1.05782994]
mat_Sqrt:  [[17.64077058  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00314376  0.02409487  0.26714191]
Stock Position:  -0.0031437623084726667
Bond Position:  [8.65233306]


portfolio before change:  [8.35109612]
curr_Stock_Price:  96.50865962413766
curr_Factors:  [96.50865962 -0.29206338 -1.07636675]
mat_Sqrt:  [[24.56205102  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.53255300e-04 -3.57426553e-02 -6.63168364e-01]
Stock Position:  -0.0003532553001446091
Bond Position:  [8.38518832]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.35365199]
Stock Price:  95.20844828393189
PL:  [8.35365199]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.45806432e-03 -9.35529674e-03  4.01224710e-02]
 [ 4.17899066e-02  1.80437900e-01 -2.80387958e-01]
 [-7.79623076e-02  6.77832184e-03 -3.26859193e-02]
 [-3.22064380e-01 -3.35027640e-01  1.31156367e+00]
 [-2.65107208e-02 -1.13086513e-01 -2.46244170e-02]
 [-1.18491552e+00  1.31067836e+00 -1.97076256e-01]
 [ 9.70697307e-03 -3.61911514e-03  2.57319643e-02]
 [-5.05597710e-02 -1.25062048e-01  1.88528132e-01]
 [-5.80850344e-02 -6.42643269e-03  1.72070659e-02]
 [-7.19386430e-01  3.22209457e-01 -3.66651484e-01]
 [ 1.36501064e-01  4.37965697e-02 -5.47410087e-02]
 [-2.94179316e-02  1.19862974e-01  3.69700473e-02]
 [ 8.13221241e-02 -2.72852366e-02 -7.34816231e-02]
 [ 1.69243647e-02  6.50598653e-01 -4.34845117e-01]
 [ 5.67154166e-02 -1.17404348e-01 -4.82207101e-02]
 [ 2.35489919e-02 -2.29139365e-02 -2.13879614e-02]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 5.04128051e-02 -2.18073069e-01 -3.02760487e-02]
 [-1.33101158e-01  7.99566959e-02 -1.57005975e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.42643074]
curr_Stock_Price:  100.64753103053341
curr_Factors:  [100.64753103  -0.80545766  -0.95624584]
mat_Sqrt:  [[17.28641813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.05415640e-04 -3.01940904e-03  1.14458242e-01]
Stock Position:  0.00010541564018117046
Bond Position:  [7.41582092]


portfolio before change:  [7.42826212]
curr_Stock_Price:  100.43118874361205
curr_Factors:  [100.43118874  -0.63250198  -0.92597434]
mat_Sqrt:  [[21.13639612  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00101189  0.05823608 -0.7998688 ]
Stock Position:  0.0010118889891064765
Bond Position:  [7.32663691]


portfolio before change:  [7.43156163]
curr_Stock_Price:  101.88156693017697
curr_Factors:  [101.88156693  -0.63220041  -0.93405149]
mat_Sqrt:  [[21.27556279  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00391297  0.00218769 -0.09324383]
Stock Position:  -0.003912971639035317
Bond Position:  [7.83022132]


portfolio before change:  [7.42789278]
curr_Stock_Price:  103.3195171123151
curr_Factors:  [103.31951711  -0.78196531  -0.9270044 ]
mat_Sqrt:  [[18.70622923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00656091 -0.10812971  3.74152609]
Stock Position:  -0.006560905224656652
Bond Position:  [8.10576234]


portfolio before change:  [7.42390124]
curr_Stock_Price:  104.2368029302175
curr_Factors:  [104.23680293  -0.55060336  -0.96427787]
mat_Sqrt:  [[22.91482391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00238365 -0.03649852 -0.07024661]
Stock Position:  -0.0023836467992546634
Bond Position:  [7.67236497]


portfolio before change:  [7.42592643]
curr_Stock_Price:  104.19197459030497
curr_Factors:  [104.19197459  -0.73934041  -0.93664534]
mat_Sqrt:  [[19.49678063  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04911593  0.42301962 -0.5622037 ]
Stock Position:  -0.049115926242775464
Bond Position:  [12.54341177]


portfolio before change:  [7.48853174]
curr_Stock_Price:  102.98118474179115
curr_Factors:  [102.98118474  -0.31178752  -0.91709171]
mat_Sqrt:  [[30.13439074  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00047191 -0.00116806  0.07340613]
Stock Position:  0.000471910635935586
Bond Position:  [7.43993382]


portfolio before change:  [7.49022957]
curr_Stock_Price:  102.6370885511867
curr_Factors:  [102.63708855  -0.33411352  -0.91707518]
mat_Sqrt:  [[29.37108384  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00128033 -0.0403636   0.53781829]
Stock Position:  -0.0012803344592912126
Bond Position:  [7.62163937]


portfolio before change:  [7.4900935]
curr_Stock_Price:  104.23176560376683
curr_Factors:  [104.2317656   -1.17999788  -0.95090009]
mat_Sqrt:  [[12.37550315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00451573 -0.00207412  0.04908697]
Stock Position:  -0.004515731292458583
Bond Position:  [7.96077615]


portfolio before change:  [7.49431647]
curr_Stock_Price:  103.73737656596695
curr_Factors:  [103.73737657  -1.14152088  -0.9798301 ]
mat_Sqrt:  [[12.43495547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05858148  0.10399266 -1.04595463]
Stock Position:  -0.05858148204109792
Bond Position:  [13.57140573]


portfolio before change:  [7.51557304]
curr_Stock_Price:  103.43244592674678
curr_Factors:  [103.43244593  -1.051732    -0.9566556 ]
mat_Sqrt:  [[13.88114023  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00967262  0.01413528 -0.15616086]
Stock Position:  0.009672623284825141
Bond Position:  [6.51510995]


portfolio before change:  [7.51895028]
curr_Stock_Price:  103.61318944732876
curr_Factors:  [103.61318945  -0.925627    -0.9497477 ]
mat_Sqrt:  [[15.88364461  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00016341 0.03868561 0.10546525]
Stock Position:  0.0001634055008544522
Bond Position:  [7.50201932]


portfolio before change:  [7.52079868]
curr_Stock_Price:  103.44588717713276
curr_Factors:  [103.44588718  -0.68886996  -0.97257563]
mat_Sqrt:  [[19.64068247  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00309323 -0.00880627 -0.20962262]
Stock Position:  0.0030932313644593747
Bond Position:  [7.20081662]


portfolio before change:  [7.52115886]
curr_Stock_Price:  102.98027383965535
curr_Factors:  [102.98027384  -0.5902055   -1.02265142]
mat_Sqrt:  [[20.52575693  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00297016  0.20997981 -1.24049208]
Stock Position:  0.002970164317398462
Bond Position:  [7.21529053]


portfolio before change:  [7.52055673]
curr_Stock_Price:  102.17015756641958
curr_Factors:  [102.17015757  -0.89829813  -1.00701216]
mat_Sqrt:  [[15.20051547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00150701 -0.03789209 -0.13756026]
Stock Position:  0.0015070109372612396
Bond Position:  [7.36658519]


portfolio before change:  [7.52550533]
curr_Stock_Price:  104.23166861522863
curr_Factors:  [104.23166862  -1.15381768  -0.98146841]
mat_Sqrt:  [[12.32130541  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011773  -0.00739544 -0.0610139 ]
Stock Position:  0.00117730259524335
Bond Position:  [7.40279311]


portfolio before change:  [7.52647639]
curr_Stock_Price:  103.48430523030483
curr_Factors:  [103.48430523  -1.35639061  -0.94716772]
mat_Sqrt:  [[10.33836394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00665384  0.00525786  0.16709793]
Stock Position:  -0.006653839655556389
Bond Position:  [8.21504436]


portfolio before change:  [7.51531047]
curr_Stock_Price:  105.47111852957175
curr_Factors:  [105.47111853  -1.52864251  -1.06506707]
mat_Sqrt:  [[ 7.88315005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.56768934e-05 -7.03827805e-02 -8.63691398e-02]
Stock Position:  -3.567689344608941e-05
Bond Position:  [7.51907335]


portfolio before change:  [7.51719594]
curr_Stock_Price:  105.31786708704838
curr_Factors:  [105.31786709  -1.74965812  -1.13579494]
mat_Sqrt:  [[ 5.87984281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02040615  0.02580591 -0.04478943]
Stock Position:  -0.020406147047493068
Bond Position:  [9.66632782]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.52039659]
Stock Price:  105.27945867657468
PL:  [2.24093791]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-6.34792792e-02  1.33000325e-01  1.96514254e-02]
 [-1.02538821e-02 -6.23146420e-02  1.60963812e-01]
 [-7.86496431e-02  3.48230155e-02 -8.02341956e-03]
 [-1.56943385e-01 -1.30490652e-01  4.55349655e-01]
 [-3.87700349e-02  1.75762615e-02 -2.12238437e-02]
 [-1.08692570e+00  1.21544734e+00 -1.82616424e-01]
 [-4.18292208e-03 -4.83890249e-02 -4.08131002e-03]
 [-2.27502598e-02 -1.90606233e-01  3.18355265e-01]
 [-8.64290502e-02 -7.00194038e-02 -8.00080334e-02]
 [-9.64204629e-01  3.79565733e-01 -4.93486540e-01]
 [ 1.05024390e-01  5.24322571e-02 -5.59366638e-02]
 [ 2.40021611e-02  8.31151010e-02 -1.33688522e-02]
 [ 2.29364070e-01  2.60549593e-02 -1.64028779e-01]
 [ 2.00062239e-02  1.14223875e+00 -6.87988686e-01]
 [ 1.60941182e-01 -8.97203548e-02  8.37696757e-03]
 [ 1.71208396e-02 -3.17703077e-02 -9.90441252e-02]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.00656330e-02 -1.46180253e-01 -4.21833177e-02]
 [-1.39424134e-01  4.82669288e-02 -1.42624553e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.94979565]
curr_Stock_Price:  99.4655484210697
curr_Factors:  [99.46554842 -1.04990905 -1.01197417]
mat_Sqrt:  [[12.65342743  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0025542   0.04292567  0.05606005]
Stock Position:  -0.002554198952518535
Bond Position:  [-1.69574085]


portfolio before change:  [-1.94771952]
curr_Stock_Price:  98.48672131230343
curr_Factors:  [98.48672131 -1.13712678 -1.01734325]
mat_Sqrt:  [[11.42097643  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00086532 -0.02011196  0.45918495]
Stock Position:  0.0008653196536361755
Bond Position:  [-2.03294201]


portfolio before change:  [-1.9469053]
curr_Stock_Price:  100.01507870064728
curr_Factors:  [100.0150787   -1.16998315  -1.01671941]
mat_Sqrt:  [[11.23033275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00651621  0.01123908 -0.02288858]
Stock Position:  -0.006516209283186322
Bond Position:  [-1.29518612]


portfolio before change:  [-1.94303088]
curr_Stock_Price:  99.3707996590405
curr_Factors:  [99.37079966 -1.11043055 -0.93725319]
mat_Sqrt:  [[12.82215537  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00706838 -0.04211568  1.29898582]
Stock Position:  -0.007068376240691769
Bond Position:  [-1.24064068]


portfolio before change:  [-1.95379437]
curr_Stock_Price:  100.84968114881539
curr_Factors:  [100.84968115  -0.86482865  -0.97005403]
mat_Sqrt:  [[16.09885933  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0024545   0.00567271 -0.06054572]
Stock Position:  -0.0024544965383244805
Bond Position:  [-1.70625918]


portfolio before change:  [-1.96282246]
curr_Stock_Price:  104.35405624623337
curr_Factors:  [104.35405625  -1.03110549  -0.96008868]
mat_Sqrt:  [[14.24769772  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06149063  0.39228394 -0.52095383]
Stock Position:  -0.06149063472022916
Bond Position:  [4.45397469]


portfolio before change:  [-2.00052184]
curr_Stock_Price:  104.98525819217465
curr_Factors:  [104.98525819  -1.03899059  -0.9608807 ]
mat_Sqrt:  [[14.21003861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00104809 -0.01561749 -0.01164284]
Stock Position:  -0.0010480889424348216
Bond Position:  [-1.89048795]


portfolio before change:  [-2.00124707]
curr_Stock_Price:  105.22622253997338
curr_Factors:  [105.22622254  -0.85256011  -0.94715936]
mat_Sqrt:  [[17.39865777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.91187285e-04 -6.15178971e-02  9.08178957e-01]
Stock Position:  0.00019118728460938895
Bond Position:  [-2.02136499]


portfolio before change:  [-2.00131749]
curr_Stock_Price:  107.50140090305287
curr_Factors:  [107.5014009   -0.92064552  -0.93301628]
mat_Sqrt:  [[16.84143269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00695032 -0.02259867 -0.22824065]
Stock Position:  -0.006950315615509523
Bond Position:  [-1.25414883]


portfolio before change:  [-1.98658241]
curr_Stock_Price:  105.33622527206026
curr_Factors:  [105.33622527  -0.90305389  -0.91556477]
mat_Sqrt:  [[17.09077294  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05777729  0.12250431 -1.40777974]
Stock Position:  -0.05777729422980994
Bond Position:  [4.09945967]


portfolio before change:  [-1.9119633]
curr_Stock_Price:  104.06247026101913
curr_Factors:  [104.06247026  -0.69568846  -0.91998189]
mat_Sqrt:  [[20.68318479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00504318  0.01692244 -0.15957173]
Stock Position:  0.0050431815738774
Bond Position:  [-2.43676924]


portfolio before change:  [-1.92052125]
curr_Stock_Price:  102.48634742192655
curr_Factors:  [102.48634742  -0.69804159  -0.94875731]
mat_Sqrt:  [[19.74560027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00193659  0.02682528 -0.03813761]
Stock Position:  0.0019365860757327628
Bond Position:  [-2.11899488]


portfolio before change:  [-1.91451543]
curr_Stock_Price:  105.86117050556406
curr_Factors:  [105.86117051  -0.84669355  -0.91311858]
mat_Sqrt:  [[18.21629268  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01104507  0.0084092  -0.46792845]
Stock Position:  0.011045072968426821
Bond Position:  [-3.08375978]


portfolio before change:  [-1.89596027]
curr_Stock_Price:  107.61092724587093
curr_Factors:  [107.61092725  -0.83169243  -0.88133722]
mat_Sqrt:  [[19.40425852  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00580953  0.36865597 -1.96264022]
Stock Position:  0.0058095303813740775
Bond Position:  [-2.52112922]


portfolio before change:  [-1.89999697]
curr_Stock_Price:  107.02459105713278
curr_Factors:  [107.02459106  -0.83686128  -0.87660357]
mat_Sqrt:  [[19.29013419  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00748243 -0.02895712  0.02389716]
Stock Position:  0.0074824276219660054
Bond Position:  [-2.70080073]


portfolio before change:  [-1.90769863]
curr_Stock_Price:  106.08554090562825
curr_Factors:  [106.08554091  -0.76176783  -0.90673676]
mat_Sqrt:  [[20.000178    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047907 -0.01025382 -0.28254532]
Stock Position:  -0.00047907297154095867
Bond Position:  [-1.85687591]


portfolio before change:  [-1.90768325]
curr_Stock_Price:  105.08432333397091
curr_Factors:  [105.08432333  -0.82501097  -0.88231085]
mat_Sqrt:  [[19.05712949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00360966  0.00525786  0.16709793]
Stock Position:  -0.0036096630381441254
Bond Position:  [-1.52836425]


portfolio before change:  [-1.90670523]
curr_Stock_Price:  104.70751320865854
curr_Factors:  [104.70751321  -0.88462191  -0.85260299]
mat_Sqrt:  [[18.42937707  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.76904362e-05 -4.71794738e-02 -1.20337264e-01]
Stock Position:  8.769043618160869e-05
Bond Position:  [-1.91588708]


portfolio before change:  [-1.90735316]
curr_Stock_Price:  102.78147646311461
curr_Factors:  [102.78147646  -0.65365745  -0.86085615]
mat_Sqrt:  [[22.60320128  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00586125  0.01557808 -0.04068682]
Stock Position:  -0.005861249402883785
Bond Position:  [-1.30492529]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.90525901]
Stock Price:  102.36852385397577
PL:  [-4.27378287]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 1.60763486e-02 -2.24109302e-02  2.86672959e-02]
 [ 6.58277274e-03  1.06964804e-01 -1.18385497e-01]
 [ 9.54293791e-02 -1.61273719e-01 -4.30961008e-01]
 [-2.99014576e-01 -2.90313077e-01  1.52695224e+00]
 [-3.12389416e-02 -1.18274989e-01 -3.10111372e-02]
 [-1.04252783e+00  1.19608321e+00 -1.84653324e-01]
 [ 2.93803802e-03 -2.54367465e-02  1.12031205e-02]
 [-5.47008286e-02 -1.06226997e-01  1.49758639e-01]
 [-4.86642627e-02 -2.85220521e-02 -1.87142907e-02]
 [-1.08913038e+00  4.06768979e-01 -5.60554079e-01]
 [ 1.62883799e-01  5.90807276e-02 -5.74603094e-02]
 [-1.22598385e-01  1.06072080e-01  2.17415725e-01]
 [ 6.98821617e-02 -8.14496208e-02 -1.15586861e-01]
 [ 3.57810099e-02  8.54984042e-01 -4.91998992e-01]
 [ 1.33968929e-01 -6.13547361e-02 -1.72492084e-02]
 [ 2.25967537e-02 -2.35296591e-02 -3.00154471e-02]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.81436532e-02 -1.93782482e-01 -3.37120438e-02]
 [-1.34782394e-01  7.84462860e-02 -1.66350004e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.34879391]
curr_Stock_Price:  101.26805227445506
curr_Factors:  [101.26805227  -0.63565918  -1.02409579]
mat_Sqrt:  [[19.25972292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090102 -0.0072331   0.08177982]
Stock Position:  0.0009010214718838241
Bond Position:  [12.25754922]


portfolio before change:  [12.354749]
curr_Stock_Price:  104.47587478755239
curr_Factors:  [104.47587479  -1.06373698  -0.99801523]
mat_Sqrt:  [[13.29255325  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.19843263e-04  3.45227421e-02 -3.37720871e-01]
Stock Position:  0.00031984326279406466
Bond Position:  [12.3213331]


portfolio before change:  [12.35832343]
curr_Stock_Price:  106.01947529423623
curr_Factors:  [106.01947529  -0.91395921  -0.98624172]
mat_Sqrt:  [[15.8540007   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00160591 -0.05205087 -1.2294118 ]
Stock Position:  -0.0016059055851203436
Bond Position:  [12.5285807]


portfolio before change:  [12.36102181]
curr_Stock_Price:  106.28982663521484
curr_Factors:  [106.28982664  -1.14210813  -0.98411165]
mat_Sqrt:  [[12.67903443  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.67430687e-03 -9.36981427e-02  4.35596973e+00]
Stock Position:  -0.0036743068702027055
Bond Position:  [12.75156325]


portfolio before change:  [12.36960076]
curr_Stock_Price:  104.82270251807337
curr_Factors:  [104.82270252  -0.89508815  -0.95347994]
mat_Sqrt:  [[16.50564251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00373883 -0.03817309 -0.08846614]
Stock Position:  -0.00373883321752906
Bond Position:  [12.76151536]


portfolio before change:  [12.3695176]
curr_Stock_Price:  105.69835896609524
curr_Factors:  [105.69835897  -1.24780048  -0.95268859]
mat_Sqrt:  [[11.70598552  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07142248  0.3860342  -0.52676454]
Stock Position:  -0.07142248479607136
Bond Position:  [19.91875704]


portfolio before change:  [12.47550525]
curr_Stock_Price:  104.28413577997347
curr_Factors:  [104.28413578  -0.97924583  -0.97543515]
mat_Sqrt:  [[14.76763956  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.20829378e-06 -8.20967462e-03  3.19593843e-02]
Stock Position:  2.2082937804125135e-06
Bond Position:  [12.47527496]


portfolio before change:  [12.47862582]
curr_Stock_Price:  104.89883514142524
curr_Factors:  [104.89883514  -1.59929091  -0.98520011]
mat_Sqrt:  [[ 7.91298747  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00578984 -0.03428462  0.42721971]
Stock Position:  -0.005789844811107832
Bond Position:  [13.08597379]


portfolio before change:  [12.48061725]
curr_Stock_Price:  105.11999252586102
curr_Factors:  [105.11999253  -1.41573411  -0.98766809]
mat_Sqrt:  [[ 9.50388138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.006135   -0.00920545 -0.05338666]
Stock Position:  -0.006135003002342143
Bond Position:  [13.12552872]


portfolio before change:  [12.4800485]
curr_Stock_Price:  105.74762756734665
curr_Factors:  [105.74762757  -1.19111603  -1.00589859]
mat_Sqrt:  [[11.75220353  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09534566  0.13128412 -1.59910476]
Stock Position:  -0.09534566236705902
Bond Position:  [22.5626261]


portfolio before change:  [12.44407925]
curr_Stock_Price:  106.18404610430127
curr_Factors:  [106.1840461   -1.44468697  -1.01358324]
mat_Sqrt:  [[ 9.08753473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01796027  0.01906822 -0.16391827]
Stock Position:  0.017960268715672804
Bond Position:  [10.53698525]


portfolio before change:  [12.44995807]
curr_Stock_Price:  106.3646806375943
curr_Factors:  [106.36468064  -1.34017997  -1.03042176]
mat_Sqrt:  [[ 9.93706635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0056925   0.03423462  0.62022655]
Stock Position:  -0.005692496305748005
Bond Position:  [13.05543862]


portfolio before change:  [12.46251418]
curr_Stock_Price:  104.73238397573705
curr_Factors:  [104.73238398  -1.50276452  -1.03624922]
mat_Sqrt:  [[ 8.26801649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00358759 -0.02628775 -0.32973714]
Stock Position:  0.003587590591240494
Bond Position:  [12.08677726]


portfolio before change:  [12.46327457]
curr_Stock_Price:  104.10196590989985
curr_Factors:  [104.10196591  -1.51463513  -1.02416283]
mat_Sqrt:  [[ 8.22002208  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01336676  0.27594491 -1.40353618]
Stock Position:  0.01336675520025532
Bond Position:  [11.07176908]


portfolio before change:  [12.46186602]
curr_Stock_Price:  103.78948658717778
curr_Factors:  [103.78948659  -1.47837488  -0.99421326]
mat_Sqrt:  [[ 8.75632712  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01346729 -0.01980216 -0.04920719]
Stock Position:  0.013467286463719787
Bond Position:  [11.06410328]


portfolio before change:  [12.47223809]
curr_Stock_Price:  104.35424029037658
curr_Factors:  [104.35424029  -1.30485586  -0.98289595]
mat_Sqrt:  [[10.59136935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00110155 -0.00759416 -0.08562572]
Stock Position:  0.0011015482766673296
Bond Position:  [12.35728686]


portfolio before change:  [12.47603034]
curr_Stock_Price:  104.99201255622258
curr_Factors:  [104.99201256  -1.25446839  -1.01431291]
mat_Sqrt:  [[10.86018092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00633413  0.00525786  0.16709793]
Stock Position:  -0.006334131673263703
Bond Position:  [13.14106357]


portfolio before change:  [12.48016375]
curr_Stock_Price:  104.85817639647952
curr_Factors:  [104.8581764   -1.38758568  -1.01093604]
mat_Sqrt:  [[ 9.52659173  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00017913 -0.06254303 -0.09617108]
Stock Position:  0.0001791330724744523
Bond Position:  [12.46138018]


portfolio before change:  [12.48338193]
curr_Stock_Price:  105.43006051036473
curr_Factors:  [105.43006051  -1.60743589  -1.01788922]
mat_Sqrt:  [[ 7.63484542  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01600101  0.02531843 -0.04745503]
Stock Position:  -0.016001007437629833
Bond Position:  [14.17036911]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.47437481]
Stock Price:  106.2143959855924
PL:  [6.25997882]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-7.12554609e-02  1.46138099e-01  1.58048587e-02]
 [ 3.69937123e-02  1.43325517e-01 -2.33857422e-01]
 [-6.88986523e-02 -3.63674732e-02 -5.98300828e-02]
 [-2.96387577e-01 -3.04651663e-01  1.11465411e+00]
 [ 1.68334936e-02 -6.55230838e-02  3.39234767e-02]
 [-1.24997843e+00  1.35785415e+00 -2.02705273e-01]
 [ 9.72313448e-03 -3.66850435e-03  2.58222673e-02]
 [-5.44764477e-02 -1.15477051e-01  1.69485590e-01]
 [ 2.48017098e-03  2.97996430e-02  5.81082633e-02]
 [-1.51187344e-01  1.99953908e-01 -5.99347808e-02]
 [ 4.16202859e-02 -1.87652276e-02 -4.55928234e-02]
 [ 9.86505971e-02 -1.34542353e-02 -2.99304677e-02]
 [-1.08111445e-01 -8.85789394e-02  7.97514778e-03]
 [ 1.90040798e-02  5.97492721e-01 -4.01621803e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 6.06802915e-02  4.95153267e-02  1.41942365e-01]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.28674973e-02 -1.42244855e-01 -3.84749554e-02]
 [-1.04774056e-01  1.07998917e-01 -4.50663591e-04]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.82918319]
curr_Stock_Price:  99.6068146819453
curr_Factors:  [99.60681468 -0.71006621 -1.03804876]
mat_Sqrt:  [[17.34172794  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00220272  0.04716587  0.04508686]
Stock Position:  -0.002202721276558082
Bond Position:  [-0.60977714]


portfolio before change:  [-0.83083827]
curr_Stock_Price:  100.28897830570241
curr_Factors:  [100.28897831  -0.95074636  -1.00837067]
mat_Sqrt:  [[14.13902592  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00130942  0.04625811 -0.66713013]
Stock Position:  0.0013094229198367874
Bond Position:  [-0.96215895]


portfolio before change:  [-0.82949124]
curr_Stock_Price:  101.50141856995529
curr_Factors:  [101.50141857  -1.1772884   -1.01772546]
mat_Sqrt:  [[11.30289531  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00783294 -0.01173755 -0.17067857]
Stock Position:  -0.007832939590424139
Bond Position:  [-0.03443676]


portfolio before change:  [-0.83398327]
curr_Stock_Price:  102.07379872074172
curr_Factors:  [102.07379872  -0.778406    -1.01695666]
mat_Sqrt:  [[16.9511115   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00773085 -0.0983259   3.1797979 ]
Stock Position:  -0.007730851175591884
Bond Position:  [-0.04486592]


portfolio before change:  [-0.83954013]
curr_Stock_Price:  102.79113861629745
curr_Factors:  [102.79113862  -0.92297547  -1.01172669]
mat_Sqrt:  [[14.8499572   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00069921 -0.02114748  0.09677424]
Stock Position:  0.0006992108265745622
Bond Position:  [-0.91141281]


portfolio before change:  [-0.8399]
curr_Stock_Price:  102.60237847103816
curr_Factors:  [102.60237847  -0.79993244  -1.06846318]
mat_Sqrt:  [[15.83884545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06403148  0.43824554 -0.57826172]
Stock Position:  -0.06403147573580252
Bond Position:  [5.72988171]


portfolio before change:  [-0.86300123]
curr_Stock_Price:  102.98553191364697
curr_Factors:  [102.98553191  -0.4274381   -1.05417043]
mat_Sqrt:  [[23.40570948  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00060862 -0.001184    0.07366374]
Stock Position:  0.000608622969775731
Bond Position:  [-0.92568059]


portfolio before change:  [-0.86358071]
curr_Stock_Price:  102.41369099649349
curr_Factors:  [102.413691    -0.25920869  -1.03036318]
mat_Sqrt:  [[28.20356928  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154066 -0.03727006  0.48349521]
Stock Position:  -0.0015406560957644758
Bond Position:  [-0.70579644]


portfolio before change:  [-0.85838776]
curr_Stock_Price:  98.92853556477213
curr_Factors:  [ 9.89285356e+01 -5.14001422e-02 -1.00425241e+00]
mat_Sqrt:  [[34.42369628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00059332 0.00961779 0.1657667 ]
Stock Position:  0.0005933208633917652
Bond Position:  [-0.91708412]


portfolio before change:  [-0.85755031]
curr_Stock_Price:  100.72647061029123
curr_Factors:  [100.72647061   0.12460415  -1.0282533 ]
mat_Sqrt:  [[40.80315829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300482  0.06453485 -0.17097725]
Stock Position:  -0.0030048178647982594
Bond Position:  [-0.55488561]


portfolio before change:  [-0.85046471]
curr_Stock_Price:  98.32221953720307
curr_Factors:  [ 9.83222195e+01 -8.74064648e-02 -1.00468643e+00]
mat_Sqrt:  [[32.98843827  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00086343 -0.00605645 -0.13006363]
Stock Position:  0.0008634314115307448
Bond Position:  [-0.9353592]


portfolio before change:  [-0.84861173]
curr_Stock_Price:  100.73914767825623
curr_Factors:  [100.73914768  -0.46782648  -1.00285762]
mat_Sqrt:  [[23.14665733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00387938 -0.00434234 -0.08538329]
Stock Position:  0.0038793822529936545
Bond Position:  [-1.23941739]


portfolio before change:  [-0.84806194]
curr_Stock_Price:  100.96075089309014
curr_Factors:  [100.96075089  -0.61368129  -1.00608282]
mat_Sqrt:  [[19.98471479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00623299 -0.02858873  0.02275088]
Stock Position:  -0.006232994903864783
Bond Position:  [-0.21877409]


portfolio before change:  [-0.85335311]
curr_Stock_Price:  101.80087223514253
curr_Factors:  [101.80087224  -0.74937809  -0.9854404 ]
mat_Sqrt:  [[17.960954    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00328413  0.19283995 -1.14571521]
Stock Position:  0.003284127529208638
Bond Position:  [-1.18768016]


portfolio before change:  [-0.86222189]
curr_Stock_Price:  99.19079508204237
curr_Factors:  [99.19079508 -0.75502803 -1.00465661]
mat_Sqrt:  [[17.0706494   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00779075 -0.09296045 -0.18429859]
Stock Position:  -0.007790745125265671
Bond Position:  [-0.08945169]


portfolio before change:  [-0.86797582]
curr_Stock_Price:  99.92648310603899
curr_Factors:  [99.92648311 -0.88406603 -1.01783618]
mat_Sqrt:  [[14.91746299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00668756 0.015981   0.40492206]
Stock Position:  0.006687560025004398
Bond Position:  [-1.53624017]


portfolio before change:  [-0.8620181]
curr_Stock_Price:  100.87478481426835
curr_Factors:  [100.87478481  -0.89665141  -1.03189658]
mat_Sqrt:  [[14.66306884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00469137  0.00525786  0.16709793]
Stock Position:  -0.004691365543141506
Bond Position:  [-0.38877761]


portfolio before change:  [-0.8652211]
curr_Stock_Price:  101.53680817552733
curr_Factors:  [101.53680818  -1.10972684  -1.04510558]
mat_Sqrt:  [[11.77041234  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0005079  -0.04590933 -0.10975834]
Stock Position:  0.0005079023880393522
Bond Position:  [-0.91679189]


portfolio before change:  [-0.86537164]
curr_Stock_Price:  101.69173540456093
curr_Factors:  [101.6917354   -1.41983608  -1.09673498]
mat_Sqrt:  [[ 8.21018109  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01008758  0.0348565  -0.00128562]
Stock Position:  -0.01008758030693957
Bond Position:  [0.16045191]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.86043788]
Stock Price:  101.20662044087939
PL:  [-2.06705832]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.08275753e-01  1.91181756e-01 -4.18708211e-04]
 [ 4.36917794e-03 -1.10714217e-02  1.66562254e-02]
 [-6.60004721e-02  3.15819874e-02 -1.19233539e-02]
 [-2.54999110e-01 -2.58929177e-01  7.99673419e-01]
 [-5.91361947e-02  4.76425088e-02 -4.14742802e-02]
 [-1.32589178e+00  1.34372094e+00 -1.94362314e-01]
 [-1.42348000e-03 -2.80891602e-02  1.64242299e-03]
 [-6.53581993e-03  6.34741176e-03 -9.61034905e-03]
 [ 3.39797611e-02  2.94209470e-02  5.78524045e-02]
 [ 1.55407707e-01  1.27067657e-01  9.77045065e-02]
 [ 8.78841468e-04  1.36676975e-02 -4.91828446e-02]
 [ 1.13624761e-01 -3.28256403e-02 -3.32526586e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-1.02776545e-02  6.14985777e-02 -7.48388100e-02]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 3.40970878e-02  1.33486941e-02 -1.01554544e-01]
 [-8.94029296e-02  1.96394533e-02  5.13878368e-02]
 [ 1.28292689e-02 -5.05769973e-02 -1.90529852e-02]
 [-6.33956377e-02 -2.42916808e-02 -8.78875618e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.7866897]
curr_Stock_Price:  98.98186321048026
curr_Factors:  [98.98186321 -0.74352056 -1.02111034]
mat_Sqrt:  [[16.95064244  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00409049  0.06170365 -0.00119446]
Stock Position:  -0.004090488565096539
Bond Position:  [-5.38180552]


portfolio before change:  [-5.78671632]
curr_Stock_Price:  98.65940846396715
curr_Factors:  [98.65940846 -0.88460074 -1.01089455]
mat_Sqrt:  [[14.82297459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00037166 -0.00357329  0.04751557]
Stock Position:  0.00037166435009849036
Bond Position:  [-5.8233845]


portfolio before change:  [-5.78769851]
curr_Stock_Price:  99.9343172392571
curr_Factors:  [99.93431724 -0.79263076 -0.99413275]
mat_Sqrt:  [[16.73913894  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00370316  0.01019304 -0.03401401]
Stock Position:  -0.0037031576453296286
Bond Position:  [-5.41762598]


portfolio before change:  [-5.78945865]
curr_Stock_Price:  100.04383576466506
curr_Factors:  [100.04383576  -0.77851159  -0.98919311]
mat_Sqrt:  [[17.07992408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00846726 -0.08356903  2.28124568]
Stock Position:  -0.00846725974192159
Bond Position:  [-4.94236151]


portfolio before change:  [-5.79241414]
curr_Stock_Price:  100.24694152436
curr_Factors:  [100.24694152  -0.57632276  -0.97184081]
mat_Sqrt:  [[21.31632019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00271515  0.01537655 -0.11831458]
Stock Position:  -0.002715154859842746
Bond Position:  [-5.52022817]


portfolio before change:  [-5.7927784]
curr_Stock_Price:  99.87275514151573
curr_Factors:  [99.87275514 -0.47900093 -0.98534111]
mat_Sqrt:  [[23.09358537  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04725468  0.43368407 -0.55446158]
Stock Position:  -0.04725467760500851
Bond Position:  [-1.07332355]


portfolio before change:  [-5.73712121]
curr_Stock_Price:  98.68926262745896
curr_Factors:  [98.68926263 -0.51924634 -0.96779695]
mat_Sqrt:  [[22.30772111  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030581 -0.00906574  0.00468538]
Stock Position:  -0.00030580880929305854
Bond Position:  [-5.70694116]


portfolio before change:  [-5.73853883]
curr_Stock_Price:  98.65887596078647
curr_Factors:  [98.65887596 -0.22883356 -1.00741539]
mat_Sqrt:  [[28.65761631  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00025131  0.00204862 -0.02741565]
Stock Position:  -0.0002513071615984648
Bond Position:  [-5.71374514]


portfolio before change:  [-5.74014358]
curr_Stock_Price:  99.35975246539832
curr_Factors:  [99.35975247 -0.20063957 -1.04310723]
mat_Sqrt:  [[28.64561377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00180811 0.00949557 0.16503681]
Stock Position:  0.0018081078602965564
Bond Position:  [-5.91979673]


portfolio before change:  [-5.74269695]
curr_Stock_Price:  98.76618290592529
curr_Factors:  [98.76618291 -0.42366044 -1.02017746]
mat_Sqrt:  [[23.31081391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00863501 0.04101091 0.27872376]
Stock Position:  0.008635010903635549
Bond Position:  [-6.59554401]


portfolio before change:  [-5.76099478]
curr_Stock_Price:  96.83813238405666
curr_Factors:  [96.83813238 -0.52694504 -1.01402143]
mat_Sqrt:  [[20.74021097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030716  0.00441123 -0.14030497]
Stock Position:  -0.00030716455059565237
Bond Position:  [-5.73124954]


portfolio before change:  [-5.76223233]
curr_Stock_Price:  96.20186031849443
curr_Factors:  [96.20186032 -0.25788247 -1.0562302 ]
mat_Sqrt:  [[25.85065726  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00387366 -0.01059443 -0.09486058]
Stock Position:  0.003873657211689465
Bond Position:  [-6.13488536]


portfolio before change:  [-5.7678634]
curr_Stock_Price:  95.14416280417291
curr_Factors:  [95.1441628  -0.50408973 -1.05938466]
mat_Sqrt:  [[19.92387687  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00084628 -0.00995959  0.34984664]
Stock Position:  0.0008462772341484849
Bond Position:  [-5.84838174]


portfolio before change:  [-5.76827169]
curr_Stock_Price:  96.38960922972319
curr_Factors:  [96.38960923 -0.57690804 -1.0570407 ]
mat_Sqrt:  [[18.81114798  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069112  0.01984858 -0.21349429]
Stock Position:  -0.0006911177350888106
Bond Position:  [-5.70165512]


portfolio before change:  [-5.7717576]
curr_Stock_Price:  99.37075397433391
curr_Factors:  [99.37075397 -0.54807551 -1.07437874]
mat_Sqrt:  [[19.61713857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00677943 -0.09296045 -0.18429859]
Stock Position:  -0.006779433101606775
Bond Position:  [-5.09808022]


portfolio before change:  [-5.75993617]
curr_Stock_Price:  97.43901237903498
curr_Factors:  [97.43901238 -0.1635798  -1.01891131]
mat_Sqrt:  [[29.8664433   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0005388   0.00430827 -0.28970685]
Stock Position:  0.0005388034993120469
Bond Position:  [-5.81243665]


portfolio before change:  [-5.7602981]
curr_Stock_Price:  99.46453320723334
curr_Factors:  [ 9.94645332e+01 -5.87715597e-02 -1.03143143e+00]
mat_Sqrt:  [[33.43482893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224031  0.00633861  0.14659519]
Stock Position:  -0.0022403148797700773
Bond Position:  [-5.53746622]


portfolio before change:  [-5.76154476]
curr_Stock_Price:  99.40298713231005
curr_Factors:  [ 9.94029871e+01 -1.94718700e-02 -1.04607998e+00]
mat_Sqrt:  [[34.24807353  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.04078707e-05 -1.63236557e-02 -5.43528635e-02]
Stock Position:  -4.0407870690054216e-05
Bond Position:  [-5.75752809]


portfolio before change:  [-5.76311826]
curr_Stock_Price:  102.71767504189934
curr_Factors:  [102.71767504   0.20759588  -1.06120992]
mat_Sqrt:  [[43.74468688  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00197268 -0.00784011 -0.25071875]
Stock Position:  -0.001972676818377837
Bond Position:  [-5.56048948]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.76032465]
Stock Price:  100.5967487730259
PL:  [-6.35707342]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.18331278e-02  9.99640586e-04  3.66075796e-02]
 [ 6.61772685e-02  1.70747192e-01 -3.05098113e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-2.87953054e-01 -3.01294803e-01  9.45219412e-01]
 [ 3.35311757e-03 -4.46094982e-02  2.06599593e-02]
 [-1.11788378e+00  1.12189931e+00 -1.57148551e-01]
 [ 1.85939379e-03  6.73696001e-03  1.14049561e-02]
 [-9.31262990e-02 -2.19262354e-02 -1.62116749e-02]
 [ 8.84897578e-02  3.01414897e-02  6.26950364e-02]
 [-1.48809707e-01  1.92984554e-01 -6.59902419e-02]
 [ 1.19444615e-01  3.22500554e-02 -5.27078149e-02]
 [-1.06347020e-01  1.14621578e-01  1.78636881e-01]
 [-1.87718775e-01 -1.24985946e-01  3.30533481e-02]
 [ 4.09784828e-02  5.73724980e-01 -3.09351828e-01]
 [ 6.21581102e-03 -1.90593492e-01 -5.52485626e-02]
 [ 6.86874905e-02  5.15970500e-02  2.28849723e-01]
 [-5.83289010e-02  1.72643099e-02  6.98599714e-02]
 [ 1.51950903e-02 -5.98217498e-02 -1.80806615e-02]
 [-2.45809266e-02 -3.26635797e-02 -7.98672214e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.17104618]
curr_Stock_Price:  100.48927517549859
curr_Factors:  [100.48927518  -0.73432158  -1.00307919]
mat_Sqrt:  [[17.68382256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00023505  0.00032263  0.10443123]
Stock Position:  -0.00023505020310651803
Bond Position:  [6.1946662]


portfolio before change:  [6.17267989]
curr_Stock_Price:  100.12827325455174
curr_Factors:  [100.12827325  -0.50814184  -0.99235337]
mat_Sqrt:  [[22.33057661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00173542  0.05510842 -0.87035999]
Stock Position:  0.001735423241134102
Bond Position:  [5.99891496]


portfolio before change:  [6.17483701]
curr_Stock_Price:  100.50697035976813
curr_Factors:  [100.50697036  -0.83359211  -0.996573  ]
mat_Sqrt:  [[16.12001989  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00484011  0.01370813 -0.02999186]
Stock Position:  -0.004840114281160077
Bond Position:  [6.66130223]


portfolio before change:  [6.17631942]
curr_Stock_Price:  100.54480456060497
curr_Factors:  [100.54480456  -0.6822914   -0.95172283]
mat_Sqrt:  [[19.62078013  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00797687 -0.09724248  2.69644788]
Stock Position:  -0.00797687412339866
Bond Position:  [6.97835267]


portfolio before change:  [6.18863245]
curr_Stock_Price:  99.21994637138586
curr_Factors:  [99.21994637 -0.92975837 -0.94078167]
mat_Sqrt:  [[15.28388538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00010047 -0.01439765  0.05893711]
Stock Position:  -0.00010046932021371262
Bond Position:  [6.19860101]


portfolio before change:  [6.19012173]
curr_Stock_Price:  99.82277714479731
curr_Factors:  [99.82277714 -0.87655566 -0.95016937]
mat_Sqrt:  [[16.0654556   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05732516  0.36209144 -0.44830107]
Stock Position:  -0.05732516293711968
Bond Position:  [11.91247869]


portfolio before change:  [6.16789226]
curr_Stock_Price:  100.26251349165008
curr_Factors:  [100.26251349  -1.08592121  -0.99866929]
mat_Sqrt:  [[12.46844916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00044613 0.00217434 0.03253517]
Stock Position:  0.00044613382426523824
Bond Position:  [6.12316177]


portfolio before change:  [6.16948385]
curr_Stock_Price:  100.39835558358153
curr_Factors:  [100.39835558  -1.01092541  -0.95987869]
mat_Sqrt:  [[13.98998526  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0072131  -0.00707666 -0.0462474 ]
Stock Position:  -0.007213100333360842
Bond Position:  [6.89366726]


portfolio before change:  [6.17041741]
curr_Stock_Price:  100.50788886657692
curr_Factors:  [100.50788887  -1.06602713  -0.96604902]
mat_Sqrt:  [[13.17287872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00815615 0.00972812 0.17885149]
Stock Position:  0.008156146926377875
Bond Position:  [5.3506603]


portfolio before change:  [6.17275749]
curr_Stock_Price:  100.63077164572346
curr_Factors:  [100.63077165  -1.25247848  -0.96564573]
mat_Sqrt:  [[10.94993899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01122263  0.0622855  -0.18825179]
Stock Position:  -0.011222628915162021
Bond Position:  [7.3020993]


portfolio before change:  [6.17635021]
curr_Stock_Price:  100.47332442101435
curr_Factors:  [100.47332442  -1.58601535  -0.93017731]
mat_Sqrt:  [[ 8.11488159  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01420461  0.01040866 -0.15036072]
Stock Position:  0.014204605573182379
Bond Position:  [4.74916627]


portfolio before change:  [6.17579526]
curr_Stock_Price:  100.35066039794779
curr_Factors:  [100.3506604   -1.56735443  -0.9407024 ]
mat_Sqrt:  [[ 8.17118404  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.005689    0.03699396  0.5096013 ]
Stock Position:  -0.005689002608646906
Bond Position:  [6.74669043]


portfolio before change:  [6.1802507]
curr_Stock_Price:  99.864010421525
curr_Factors:  [99.86401042 -1.43860255 -0.92061784]
mat_Sqrt:  [[ 9.43653605  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02188138 -0.04033904  0.094292  ]
Stock Position:  -0.02188138070633689
Bond Position:  [8.36541313]


portfolio before change:  [6.18117764]
curr_Stock_Price:  99.9172368531367
curr_Factors:  [99.91723685 -1.4537224  -0.90153524]
mat_Sqrt:  [[ 9.47905445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01001613  0.18516894 -0.88249466]
Stock Position:  0.010016128396516565
Bond Position:  [5.18039377]


portfolio before change:  [6.18920191]
curr_Stock_Price:  100.58905416835904
curr_Factors:  [100.58905417  -1.39715822  -0.91388174]
mat_Sqrt:  [[ 9.97421723  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00440801 -0.06151379 -0.15760877]
Stock Position:  -0.004408013910545288
Bond Position:  [6.63259986]


portfolio before change:  [6.19348701]
curr_Stock_Price:  99.99315218811876
curr_Factors:  [99.99315219 -1.39248012 -0.93774841]
mat_Sqrt:  [[ 9.72668531  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01294721 0.01665288 0.65284456]
Stock Position:  0.012947211139397485
Bond Position:  [4.89885456]


portfolio before change:  [6.19031215]
curr_Stock_Price:  99.65333129498262
curr_Factors:  [99.65333129 -1.23508823 -0.9469999 ]
mat_Sqrt:  [[11.2414669   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00360671  0.00557203  0.19929105]
Stock Position:  -0.0036067118231665083
Bond Position:  [6.549733]


portfolio before change:  [6.19425173]
curr_Stock_Price:  99.01509313342518
curr_Factors:  [99.01509313 -0.90641673 -0.93909291]
mat_Sqrt:  [[15.63891952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.51868052e-05 -1.93073867e-02 -5.15790946e-02]
Stock Position:  -4.518680521507009e-05
Bond Position:  [6.1987259]


portfolio before change:  [6.19578348]
curr_Stock_Price:  99.41605556115512
curr_Factors:  [99.41605556 -0.80012209 -0.94554654]
mat_Sqrt:  [[17.35091064  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00274056 -0.01054213 -0.22783895]
Stock Position:  -0.0027405581856248897
Bond Position:  [6.46823897]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.19895923]
Stock Price:  98.84738222179072
PL:  [6.19895923]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.32913778e-02  3.34053587e-02  3.74537704e-02]
 [ 3.10129895e-02  1.57506856e-01 -1.83790668e-01]
 [-6.44042659e-02  2.88516772e-02 -1.11353097e-02]
 [-3.01743815e-01 -3.16197407e-01  1.05682003e+00]
 [-6.19934953e-02  5.18606975e-02 -4.43153452e-02]
 [-1.24626508e+00  1.25979916e+00 -1.80591929e-01]
 [-2.65595059e-04 -1.59151126e-02  2.44317305e-03]
 [-7.49156774e-02 -4.14609403e-02  2.94429864e-02]
 [ 1.03262888e-01  2.98221250e-02  6.33970718e-02]
 [-4.34022174e-01  2.58443857e-01 -2.15298935e-01]
 [ 8.68455761e-02  4.61564550e-02 -5.47661269e-02]
 [-9.31939465e-02  1.21541130e-01  1.47251151e-01]
 [-1.24799678e-01 -1.23456509e-01 -3.07548916e-02]
 [ 3.77142275e-02  7.40879488e-01 -4.25794588e-01]
 [ 1.01950831e-01 -6.04528663e-02 -4.16716716e-02]
 [ 5.16987244e-02  1.51947902e-02  1.30906510e-01]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.06084123e-02 -1.18756465e-01 -3.92433479e-02]
 [-1.43912224e-02 -4.91201356e-02 -7.54973238e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.70202829]
curr_Stock_Price:  100.17802669588266
curr_Factors:  [100.1780267   -1.41189283  -0.96056049]
mat_Sqrt:  [[ 9.3417682   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308585  0.01078153  0.10684518]
Stock Position:  -0.0030858524950744632
Bond Position:  [4.0111629]


portfolio before change:  [3.70108908]
curr_Stock_Price:  100.80738915737355
curr_Factors:  [100.80738916  -1.20171961  -0.97351279]
mat_Sqrt:  [[11.44988004  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00224001  0.05083512 -0.52430362]
Stock Position:  0.002240008518425585
Bond Position:  [3.47527967]


portfolio before change:  [3.69980737]
curr_Stock_Price:  99.84728393504645
curr_Factors:  [99.84728394 -0.97423183 -0.96102062]
mat_Sqrt:  [[14.41673106  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00421648  0.00931184 -0.03176594]
Stock Position:  -0.0042164848133840905
Bond Position:  [4.12081192]


portfolio before change:  [3.6947502]
curr_Stock_Price:  101.2910219940704
curr_Factors:  [101.29102199  -0.68837657  -0.96245459]
mat_Sqrt:  [[19.43676974  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00774639 -0.10205227  3.01481339]
Stock Position:  -0.007746392896256167
Bond Position:  [4.47939025]


portfolio before change:  [3.70452907]
curr_Stock_Price:  100.17322669058215
curr_Factors:  [100.17322669  -0.50778272  -0.97210026]
mat_Sqrt:  [[22.80587045  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00265078  0.01673797 -0.12641934]
Stock Position:  -0.002650778309186995
Bond Position:  [3.97006609]


portfolio before change:  [3.70642355]
curr_Stock_Price:  99.83300905965311
curr_Factors:  [99.83300906 -0.66713651 -0.98422093]
mat_Sqrt:  [[19.14691174  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05358425  0.40659843 -0.51517851]
Stock Position:  -0.053584245921711474
Bond Position:  [9.05590006]


portfolio before change:  [3.79317854]
curr_Stock_Price:  98.25622604657558
curr_Factors:  [98.25622605 -0.84250988 -0.97267056]
mat_Sqrt:  [[15.99695167  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018851 -0.00513658  0.00696969]
Stock Position:  -0.00018850736470885966
Bond Position:  [3.81170056]


portfolio before change:  [3.79375336]
curr_Stock_Price:  100.26265321675436
curr_Factors:  [100.26265322  -0.56980648  -0.97237405]
mat_Sqrt:  [[21.44759981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00360734 -0.01338146  0.08399264]
Stock Position:  -0.0036073422021090694
Bond Position:  [4.15543506]


portfolio before change:  [3.79341808]
curr_Stock_Price:  100.64361775945297
curr_Factors:  [100.64361776  -0.82471471  -0.98770169]
mat_Sqrt:  [[16.4309925   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00744271 0.00962505 0.1808542 ]
Stock Position:  0.007442713948416
Bond Position:  [3.04435642]


portfolio before change:  [3.8051677]
curr_Stock_Price:  102.1200197656641
curr_Factors:  [102.12001977  -0.92730743  -1.0084674 ]
mat_Sqrt:  [[14.73718598  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02885322  0.0834124  -0.61418793]
Stock Position:  -0.028853218959674198
Bond Position:  [6.75165899]


portfolio before change:  [3.78075049]
curr_Stock_Price:  103.02478301365075
curr_Factors:  [103.02478301  -0.77808912  -1.06486986]
mat_Sqrt:  [[16.31378714  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00521572  0.01489693 -0.15623252]
Stock Position:  0.005215719283682205
Bond Position:  [3.24340214]


portfolio before change:  [3.78133529]
curr_Stock_Price:  102.98142237436463
curr_Factors:  [102.98142237  -1.36764245  -1.05169047]
mat_Sqrt:  [[ 9.16338534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00418262  0.03922723  0.42006655]
Stock Position:  -0.00418261925473839
Bond Position:  [4.21206737]


portfolio before change:  [3.78510992]
curr_Stock_Price:  102.33075642987536
curr_Factors:  [102.33075643  -1.76501333  -1.02522864]
mat_Sqrt:  [[ 6.28375864  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02487014 -0.03984542 -0.08773515]
Stock Position:  -0.024870138658588194
Bond Position:  [6.33009002]


portfolio before change:  [3.77482891]
curr_Stock_Price:  102.80778354267665
curr_Factors:  [102.80778354  -1.60728933  -1.05242341]
mat_Sqrt:  [[ 7.1932877   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01418415  0.23911783 -1.21467344]
Stock Position:  0.014184148828105607
Bond Position:  [2.31658801]


portfolio before change:  [3.77177451]
curr_Stock_Price:  102.55160883464502
curr_Factors:  [102.55160883  -1.48724873  -1.05059425]
mat_Sqrt:  [[ 8.10534074  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01000633 -0.01951108 -0.11887768]
Stock Position:  0.010006334014308576
Bond Position:  [2.74560886]


portfolio before change:  [3.76799285]
curr_Stock_Price:  102.10507696488443
curr_Factors:  [102.10507696  -1.40162087  -1.03643097]
mat_Sqrt:  [[ 8.91692018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00914234 0.0049041  0.37343984]
Stock Position:  0.00914234128043928
Bond Position:  [2.83451339]


portfolio before change:  [3.76424307]
curr_Stock_Price:  101.61740135359659
curr_Factors:  [101.61740135  -1.03945008  -1.02567885]
mat_Sqrt:  [[12.88528367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00533863  0.00525786  0.16709793]
Stock Position:  -0.005338634190056498
Bond Position:  [4.30674121]


portfolio before change:  [3.7694024]
curr_Stock_Price:  100.8526904853088
curr_Factors:  [100.85269049  -0.58086714  -1.03466981]
mat_Sqrt:  [[20.04789174  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00041684 -0.03832848 -0.11195035]
Stock Position:  0.0004168436122035213
Bond Position:  [3.7273626]


portfolio before change:  [3.76976326]
curr_Stock_Price:  99.48263765856002
curr_Factors:  [99.48263766 -0.54818045 -0.98491948]
mat_Sqrt:  [[21.47486539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185466 -0.01585346 -0.21537285]
Stock Position:  -0.0018546637699399249
Bond Position:  [3.95427011]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.77005007]
Stock Price:  99.86108010867581
PL:  [3.77005007]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-8.89894592e-02  1.67715566e-01  8.03320999e-03]
 [-3.41712055e-02 -1.46080648e-01  3.93290314e-01]
 [ 1.12610603e-01 -3.69576386e-02  6.50681248e-02]
 [ 1.99528128e-02  3.67882332e-02 -6.02075856e-02]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-1.42284074e+00  1.33759102e+00 -1.84435771e-01]
 [-1.94040333e-01 -1.31496202e-01 -1.55539232e-01]
 [ 9.39894967e-02 -7.90598777e-02 -4.37360791e-03]
 [ 6.78554347e-03  2.97733391e-02  5.59737371e-02]
 [ 1.53820565e-01  1.26493059e-01  9.38139431e-02]
 [-9.02119487e-02 -9.69546462e-02 -9.94871829e-03]
 [ 1.17304466e-01 -3.75859092e-02 -3.40690434e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [ 4.37106588e-02  2.03075571e-01 -7.92635953e-02]
 [-5.82895087e-02 -2.95778160e-01 -5.82460796e-02]
 [ 3.89857781e-02  8.92127393e-03 -4.73324140e-02]
 [ 6.95678228e-02  1.98508279e-02  1.25383613e-01]
 [-3.19135481e-03 -8.12598654e-02  2.67392766e-02]
 [ 3.76137890e-02 -8.02653249e-02 -2.01088821e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.67004121]
curr_Stock_Price:  98.99656811112136
curr_Factors:  [98.99656811 -1.11054936 -1.01032349]
mat_Sqrt:  [[11.87235203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00447383  0.05412997  0.02291651]
Stock Position:  -0.004473830490878583
Bond Position:  [-5.22714735]


portfolio before change:  [-5.66769065]
curr_Stock_Price:  98.17903176942215
curr_Factors:  [98.17903177 -1.52805456 -1.02808505]
mat_Sqrt:  [[ 7.61906037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213809 -0.04714733  1.1219478 ]
Stock Position:  0.002138092578379057
Bond Position:  [-5.8776065]


portfolio before change:  [-5.66968813]
curr_Stock_Price:  97.93213193111926
curr_Factors:  [97.93213193 -1.14558106 -1.02130487]
mat_Sqrt:  [[11.21653222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01055127 -0.01192803  0.18562125]
Stock Position:  0.010551267546407948
Bond Position:  [-6.70299625]


portfolio before change:  [-5.69555991]
curr_Stock_Price:  95.63896424572376
curr_Factors:  [95.63896425 -0.81140518 -1.03273941]
mat_Sqrt:  [[15.1263117   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00100304  0.01187335 -0.17175548]
Stock Position:  0.0010030440855482462
Bond Position:  [-5.79149001]


portfolio before change:  [-5.69658497]
curr_Stock_Price:  96.06067794356639
curr_Factors:  [96.06067794 -0.59487067 -1.06407426]
mat_Sqrt:  [[18.28416011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00310637 -0.04522423  0.24245377]
Stock Position:  0.003106370857096091
Bond Position:  [-5.99498506]


portfolio before change:  [-5.69851564]
curr_Stock_Price:  95.92169154903245
curr_Factors:  [95.92169155 -0.56578563 -1.05161198]
mat_Sqrt:  [[19.03224291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0623917   0.43170565 -0.52614392]
Stock Position:  -0.06239169601994838
Bond Position:  [0.28620138]


portfolio before change:  [-5.64322172]
curr_Stock_Price:  95.03659995647665
curr_Factors:  [95.03659996 -0.27542883 -1.0883119 ]
mat_Sqrt:  [[24.30109347  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01039588 -0.04244022 -0.44371014]
Stock Position:  -0.010395877696916455
Bond Position:  [-4.65523285]


portfolio before change:  [-5.65013046]
curr_Stock_Price:  95.58920261956622
curr_Factors:  [95.58920262 -0.2084535  -1.10413716]
mat_Sqrt:  [[25.72515267  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00299157 -0.02551647 -0.01247669]
Stock Position:  0.0029915743843863373
Bond Position:  [-5.93609267]


portfolio before change:  [-5.64275445]
curr_Stock_Price:  98.55092586742025
curr_Factors:  [98.55092587 -0.14578528 -1.12910103]
mat_Sqrt:  [[27.54131152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0008819  0.0096093  0.15967749]
Stock Position:  0.0008818967138081234
Bond Position:  [-5.72966619]


portfolio before change:  [-5.64624282]
curr_Stock_Price:  96.21984376090182
curr_Factors:  [96.21984376 -0.10389554 -1.15486934]
mat_Sqrt:  [[27.3268774   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00727454 0.04082546 0.26762507]
Stock Position:  0.007274542968712458
Bond Position:  [-6.34619821]


portfolio before change:  [-5.65109771]
curr_Stock_Price:  95.7705861850512
curr_Factors:  [95.77058619 -0.14463999 -1.18691065]
mat_Sqrt:  [[25.28989633  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00442997 -0.03129198 -0.02838092]
Stock Position:  -0.004429970970417144
Bond Position:  [-5.2268368]


portfolio before change:  [-5.6590252]
curr_Stock_Price:  97.26509183836477
curr_Factors:  [97.26509184 -0.23731687 -1.23672446]
mat_Sqrt:  [[22.27352662  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00460987 -0.0121308  -0.0971895 ]
Stock Position:  0.004609865404917256
Bond Position:  [-6.10740419]


portfolio before change:  [-5.65883904]
curr_Stock_Price:  97.63673114398834
curr_Factors:  [97.63673114 -0.38444255 -1.25904851]
mat_Sqrt:  [[18.87357332  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00089337 -0.00995959  0.34984664]
Stock Position:  0.0008933720776648203
Bond Position:  [-5.74606497]


portfolio before change:  [-5.66000487]
curr_Stock_Price:  97.939921427131
curr_Factors:  [97.93992143 -0.66015216 -1.22074247]
mat_Sqrt:  [[14.93129896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00462007  0.06554236 -0.22611697]
Stock Position:  0.004620071748748993
Bond Position:  [-6.11249434]


portfolio before change:  [-5.66593532]
curr_Stock_Price:  96.98709378247177
curr_Factors:  [96.98709378 -0.87554606 -1.19573988]
mat_Sqrt:  [[12.22266444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01068134 -0.09546199 -0.16615985]
Stock Position:  -0.010681337503750016
Bond Position:  [-4.62998344]


portfolio before change:  [-5.66998406]
curr_Stock_Price:  97.25776189181904
curr_Factors:  [97.25776189 -1.02216634 -1.20851325]
mat_Sqrt:  [[10.45086975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00298015  0.00287933 -0.1350262 ]
Stock Position:  0.0029801478465912544
Bond Position:  [-5.95982657]


portfolio before change:  [-5.67018979]
curr_Stock_Price:  97.68875165671372
curr_Factors:  [97.68875166 -1.35723035 -1.21856398]
mat_Sqrt:  [[ 7.43346493  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0133469  0.00640683 0.35768455]
Stock Position:  0.013346895406956188
Bond Position:  [-6.97403134]


portfolio before change:  [-5.67293499]
curr_Stock_Price:  97.61371723452655
curr_Factors:  [97.61371723 -1.05982944 -1.22580817]
mat_Sqrt:  [[ 9.92821213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144239 -0.02622651  0.07627971]
Stock Position:  -0.0014423869282326244
Bond Position:  [-5.53213824]


portfolio before change:  [-5.67367056]
curr_Stock_Price:  97.16471693923793
curr_Factors:  [97.16471694 -1.05377071 -1.18487196]
mat_Sqrt:  [[10.35806022  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191323 -0.02590552 -0.57365043]
Stock Position:  -0.0019132332848087524
Bond Position:  [-5.48777179]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.67371951]
Stock Price:  96.47312795339049
PL:  [-5.67371951]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.82855453e-02  5.80435777e-02  3.30497518e-02]
 [ 4.42226606e-02  1.27737834e-01 -3.09640797e-01]
 [-7.79809335e-02  6.87706544e-03 -3.26177334e-02]
 [-2.64061065e-01 -2.68532641e-01  9.41831750e-01]
 [ 9.90101181e-03 -5.42760534e-02  2.71706475e-02]
 [-9.23764120e-01  8.86424566e-01 -1.09112179e-01]
 [-4.73205074e-04  1.46134210e-02 -3.24931135e-03]
 [ 1.73473883e-03  4.55889753e-02 -6.49962672e-02]
 [ 1.19553822e-01  2.28535477e-02  3.14883264e-02]
 [ 1.54252186e-01  1.14773073e-01  8.28260513e-02]
 [-1.52956131e-03  3.00444692e-02 -5.14545859e-02]
 [ 7.39997138e-02  1.84355077e-02 -2.44613853e-02]
 [-8.50195232e-02 -7.29708055e-02  8.25571598e-02]
 [ 8.99724713e-03  7.77794977e-01 -5.20497651e-01]
 [ 4.67263752e-02 -1.31881479e-01 -4.96108499e-02]
 [ 6.83338738e-02  6.07656810e-02  2.12774283e-01]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 3.09308845e-02 -8.85898888e-02 -4.97780095e-02]
 [-1.00362543e-01  1.72020098e-01 -9.43427124e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.97777746]
curr_Stock_Price:  99.8346031305801
curr_Factors:  [99.83460313 -0.98505477 -0.96629941]
mat_Sqrt:  [[14.18465382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209319  0.01873348  0.09428174]
Stock Position:  -0.002093191528570703
Bond Position:  [1.18675041]


portfolio before change:  [0.97858823]
curr_Stock_Price:  99.58902406339693
curr_Factors:  [99.58902406 -0.61550595 -0.9543599 ]
mat_Sqrt:  [[20.72179635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.42242233e-04  4.12272087e-02 -8.83319005e-01]
Stock Position:  0.00034224223308537173
Bond Position:  [0.94450466]


portfolio before change:  [0.9796253]
curr_Stock_Price:  101.92920875982529
curr_Factors:  [101.92920876  -0.61572869  -0.91429019]
mat_Sqrt:  [[22.07089257  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00377127  0.00221956 -0.09304931]
Stock Position:  -0.003771266841913161
Bond Position:  [1.36402754]


portfolio before change:  [0.98267396]
curr_Stock_Price:  101.21125045786764
curr_Factors:  [101.21125046  -0.84936934  -0.84398764]
mat_Sqrt:  [[18.6128639   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00680306 -0.08666854  2.68678383]
Stock Position:  -0.006803061624080437
Bond Position:  [1.67122033]


portfolio before change:  [0.99128283]
curr_Stock_Price:  100.00723190568684
curr_Factors:  [100.00723191  -1.07165581  -0.8226156 ]
mat_Sqrt:  [[15.04387738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00029036 -0.01751752  0.07751029]
Stock Position:  0.00029036025163220767
Bond Position:  [0.9622447]


portfolio before change:  [0.99129639]
curr_Stock_Price:  99.22532949325866
curr_Factors:  [99.22532949 -1.01726761 -0.85961644]
mat_Sqrt:  [[15.18805516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05037484  0.2860923  -0.31126668]
Stock Position:  -0.050374842947877016
Bond Position:  [5.98975678]


portfolio before change:  [1.02390384]
curr_Stock_Price:  98.60776281153875
curr_Factors:  [98.60776281 -1.29798738 -0.81533223]
mat_Sqrt:  [[11.91538443  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00015497  0.00471646 -0.00926938]
Stock Position:  0.00015496638918361357
Bond Position:  [1.00862295]


portfolio before change:  [1.02412179]
curr_Stock_Price:  98.38683349767649
curr_Factors:  [98.3868335  -1.12549643 -0.80388804]
mat_Sqrt:  [[14.28946461  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.55832154e-04  1.47137785e-02 -1.85416259e-01]
Stock Position:  -0.00015583215385069348
Bond Position:  [1.03945362]


portfolio before change:  [1.02453224]
curr_Stock_Price:  97.4206667694535
curr_Factors:  [97.42066677 -1.31921664 -0.77201155]
mat_Sqrt:  [[12.03489299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01085563 0.00737595 0.08982743]
Stock Position:  0.010855627145883336
Bond Position:  [-0.03303019]


portfolio before change:  [1.01613031]
curr_Stock_Price:  96.6474573217368
curr_Factors:  [96.64745732 -0.88688319 -0.77122157]
mat_Sqrt:  [[18.41130969  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01056888 0.03704285 0.23627967]
Stock Position:  0.010568880863464027
Bond Position:  [-0.00532515]


portfolio before change:  [1.01852153]
curr_Stock_Price:  96.87383366921011
curr_Factors:  [96.87383367 -0.6620446  -0.74674881]
mat_Sqrt:  [[23.6796503   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024915  0.00969681 -0.14678561]
Stock Position:  -0.0002491541473248092
Bond Position:  [1.04265804]


portfolio before change:  [1.01855654]
curr_Stock_Price:  97.77961941467953
curr_Factors:  [97.77961941 -0.67519781 -0.700506  ]
mat_Sqrt:  [[24.70516559  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00294553  0.00595003 -0.06978152]
Stock Position:  0.0029455251542258734
Bond Position:  [0.73054421]


portfolio before change:  [1.02060708]
curr_Stock_Price:  98.41375960579313
curr_Factors:  [98.41375961 -0.80366778 -0.69585638]
mat_Sqrt:  [[21.96952946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00378081 -0.02355123  0.2355126 ]
Stock Position:  -0.0037808145602408662
Bond Position:  [1.39269125]


portfolio before change:  [1.00433061]
curr_Stock_Price:  102.81087779369399
curr_Factors:  [102.81087779  -0.6838584   -0.71173715]
mat_Sqrt:  [[25.46476194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0024158   0.25103225 -1.48483492]
Stock Position:  0.0024158028221294395
Bond Position:  [0.7559598]


portfolio before change:  [1.00318239]
curr_Stock_Price:  102.25734479232267
curr_Factors:  [102.25734479  -0.77185551  -0.69138006]
mat_Sqrt:  [[23.6711513   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040891 -0.04256456 -0.14152595]
Stock Position:  0.0004089116150457506
Bond Position:  [0.96136818]


portfolio before change:  [1.00276559]
curr_Stock_Price:  100.6502257017181
curr_Factors:  [100.6502257   -0.67488512  -0.68003966]
mat_Sqrt:  [[25.96440643  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00478232 0.01961204 0.6069858 ]
Stock Position:  0.004782315569284983
Bond Position:  [0.52142445]


portfolio before change:  [1.00525426]
curr_Stock_Price:  101.14335322322096
curr_Factors:  [101.14335322  -0.72931412  -0.69333574]
mat_Sqrt:  [[24.38306877  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282121  0.00525786  0.16709793]
Stock Position:  -0.002821212398062713
Bond Position:  [1.29060114]


portfolio before change:  [1.00393923]
curr_Stock_Price:  101.72385653014636
curr_Factors:  [101.72385653  -1.09514086  -0.67654027]
mat_Sqrt:  [[17.29782423  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00015532 -0.02859226 -0.14200281]
Stock Position:  0.00015531754489890546
Bond Position:  [0.98813973]


portfolio before change:  [1.00446105]
curr_Stock_Price:  103.49287721792975
curr_Factors:  [103.49287722  -1.35287656  -0.67465548]
mat_Sqrt:  [[13.62587756  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00492995  0.05551925 -0.02691335]
Stock Position:  -0.00492994672240964
Bond Position:  [1.51467542]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.00339367]
Stock Price:  103.7862067786096
PL:  [-2.78281311]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.10691996e-01  1.94121668e-01 -1.47758882e-03]
 [ 1.16373839e-03 -2.15671687e-02 -9.91723356e-03]
 [ 1.75335387e-01  3.15677085e-02  1.81805471e-01]
 [-1.92824724e-01 -1.75442908e-01  5.23412240e-01]
 [-1.17002137e-01  1.33069106e-01 -9.90114204e-02]
 [-1.65888843e+00  1.53897805e+00 -2.18022518e-01]
 [-2.01534288e-01 -1.62887812e-01 -1.38199856e-01]
 [ 1.47608302e-01 -1.76370132e-01  4.04034933e-02]
 [-1.66651049e-02  2.77497721e-02  4.88453077e-02]
 [ 1.46355038e-01  1.57417720e-01  1.09621547e-01]
 [-3.17983263e-01 -3.16678407e-01  8.29547641e-02]
 [ 7.61040753e-02 -4.31373627e-02 -4.28615213e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-9.89351536e-02 -2.86751331e-02 -7.01542880e-02]
 [ 5.84627952e-02  2.39976970e-01  1.25694828e-01]
 [ 7.10167841e-02  2.35814821e-01 -4.15886440e-01]
 [ 2.50229185e-01 -2.43628641e-01  2.06758421e-01]
 [-1.40406955e-01  1.21756307e-01  1.54362418e-01]
 [ 9.69536221e-02 -1.43773756e-01 -2.88469980e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.01062724]
curr_Stock_Price:  98.95363327276807
curr_Factors:  [98.95363327 -0.73274041 -1.01542255]
mat_Sqrt:  [[17.22718109  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0041428   0.0626525  -0.00421515]
Stock Position:  -0.004142795456780269
Bond Position:  [-5.60068258]


portfolio before change:  [-6.00899643]
curr_Stock_Price:  98.22196276144109
curr_Factors:  [98.22196276 -0.56802925 -1.06059705]
mat_Sqrt:  [[19.27104186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0002731  -0.00696077 -0.02829111]
Stock Position:  -0.0002731034653837572
Bond Position:  [-5.98217167]


portfolio before change:  [-6.0100532]
curr_Stock_Price:  96.61467167500972
curr_Factors:  [96.61467168 -0.50773996 -1.09357143]
mat_Sqrt:  [[19.4806025   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01123631 0.01018843 0.5186404 ]
Stock Position:  0.011236305697471216
Bond Position:  [-7.09564519]


portfolio before change:  [-5.99857959]
curr_Stock_Price:  97.79368405276328
curr_Factors:  [97.79368405 -0.39048761 -1.09890861]
mat_Sqrt:  [[22.05333361  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00552278 -0.05662396  1.49314943]
Stock Position:  -0.005522783264436324
Bond Position:  [-5.45848627]


portfolio before change:  [-5.99957316]
curr_Stock_Price:  97.72646668988857
curr_Factors:  [97.72646669 -0.19729458 -1.08733144]
mat_Sqrt:  [[27.04619684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00406897  0.04294787 -0.28245202]
Stock Position:  -0.004068969170814797
Bond Position:  [-5.60192718]


portfolio before change:  [-5.98646978]
curr_Stock_Price:  94.16191998659941
curr_Factors:  [94.16191999 -0.20890376 -1.07701769]
mat_Sqrt:  [[26.02595748  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05337938  0.49670303 -0.62195756]
Stock Position:  -0.053379381468468455
Bond Position:  [-0.96016474]


portfolio before change:  [-6.00539738]
curr_Stock_Price:  94.5120088592112
curr_Factors:  [94.51200886 -0.63879167 -1.06442557]
mat_Sqrt:  [[17.21032807  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01528115 -0.05257182 -0.39424572]
Stock Position:  -0.015281146870237355
Bond Position:  [-4.56114549]


portfolio before change:  [-5.9962717]
curr_Stock_Price:  93.84019336927096
curr_Factors:  [93.84019337 -0.53374994 -1.0616281 ]
mat_Sqrt:  [[19.03377877  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00629692 -0.05692322  0.11525992]
Stock Position:  0.006296922420055471
Bond Position:  [-6.58717612]


portfolio before change:  [-5.99844418]
curr_Stock_Price:  93.75674339402914
curr_Factors:  [93.75674339 -0.41049135 -1.06413898]
mat_Sqrt:  [[21.45747923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.80112196e-05  8.95620042e-03  1.39342067e-01]
Stock Position:  -4.801121956922511e-05
Bond Position:  [-5.9939428]


portfolio before change:  [-5.99988889]
curr_Stock_Price:  92.63285765939047
curr_Factors:  [92.63285766 -0.12514233 -1.08818493]
mat_Sqrt:  [[27.53111035  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0072959  0.05080635 0.31271976]
Stock Position:  0.0072958989951774555
Bond Position:  [-6.67572886]


portfolio before change:  [-6.01389067]
curr_Stock_Price:  90.94250524357996
curr_Factors:  [90.94250524  0.1058575  -1.076838  ]
mat_Sqrt:  [[34.44097523  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01061793 -0.10220752  0.23664685]
Stock Position:  -0.01061793109517751
Bond Position:  [-5.04826942]


portfolio before change:  [-6.0032191]
curr_Stock_Price:  89.8185768156192
curr_Factors:  [89.81857682  0.28145521 -1.08423656]
mat_Sqrt:  [[40.24599415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00145479 -0.01392252 -0.12227199]
Stock Position:  0.0014547938970835245
Bond Position:  [-6.13388662]


portfolio before change:  [-6.00774428]
curr_Stock_Price:  87.76226472606649
curr_Factors:  [87.76226473  0.24741925 -1.08398672]
mat_Sqrt:  [[38.01816788  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0004435  -0.00995959  0.34984664]
Stock Position:  0.0004435017347648763
Bond Position:  [-6.04666699]


portfolio before change:  [-6.0082801]
curr_Stock_Price:  89.96300357864484
curr_Factors:  [89.96300358  0.20994051 -1.03244957]
mat_Sqrt:  [[39.52326386  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00301363 -0.00925486 -0.20013066]
Stock Position:  -0.0030136333143402556
Bond Position:  [-5.7371646]


portfolio before change:  [-5.99899516]
curr_Stock_Price:  86.4060321738216
curr_Factors:  [86.40603217  0.28164495 -0.97551505]
mat_Sqrt:  [[43.17179508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00308315 0.07745223 0.35857236]
Stock Position:  0.003083152743411719
Bond Position:  [-6.26539816]


portfolio before change:  [-6.00573361]
curr_Stock_Price:  84.72856204377581
curr_Factors:  [84.72856204  0.0873613  -0.94804891]
mat_Sqrt:  [[35.82926956  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.56196406e-04  7.61089061e-02 -1.18640825e+00]
Stock Position:  0.0009561964062201106
Bond Position:  [-6.08675075]


portfolio before change:  [-6.0025448]
curr_Stock_Price:  89.65504466041922
curr_Factors:  [89.65504466 -0.47868513 -0.95314458]
mat_Sqrt:  [[21.41603117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01133278 -0.07863081  0.58982422]
Stock Position:  0.011332775948539743
Bond Position:  [-7.01858533]


portfolio before change:  [-5.96778245]
curr_Stock_Price:  92.87731065680477
curr_Factors:  [92.87731066 -0.4851005  -0.93878738]
mat_Sqrt:  [[22.36263538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00375825  0.03929668  0.44035301]
Stock Position:  -0.0037582536734130784
Bond Position:  [-5.61872595]


portfolio before change:  [-5.97878227]
curr_Stock_Price:  95.43034832803461
curr_Factors:  [95.43034833 -0.45876141 -0.92519906]
mat_Sqrt:  [[23.91333311  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.64743762e-04 -4.64027801e-02 -8.22924557e-01]
Stock Position:  0.0003647437621979465
Bond Position:  [-6.01358989]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.97935298]
Stock Price:  97.98795035763132
PL:  [-5.97935298]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.95444135e-02  6.42540767e-02  3.19396411e-02]
 [ 2.18908662e-02  7.60375911e-02 -4.02100368e-02]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-1.58614249e-01 -1.22533626e-01  6.75372077e-01]
 [-1.29547232e-02 -2.05344847e-02  4.44478193e-03]
 [-1.00603969e+00  1.01453289e+00 -1.35417713e-01]
 [ 3.89859906e-03  3.29079010e-03  1.67638903e-02]
 [-9.30396241e-02 -2.12755414e-02 -1.76382642e-02]
 [ 9.82491754e-02  2.87390989e-02  5.27401359e-02]
 [ 8.99150300e-02  1.38387805e-01  5.92016056e-02]
 [ 1.20137711e-01  3.22626919e-02 -5.27149950e-02]
 [-6.45669920e-02  1.36601162e-01  7.89418013e-02]
 [-1.19428572e-01 -1.11912720e-01 -4.46581175e-02]
 [ 3.27095032e-02  6.79854856e-01 -4.07418084e-01]
 [ 3.93580959e-02 -1.42560336e-01 -5.06362674e-02]
 [ 5.46907424e-02  2.56823973e-02  1.40803086e-01]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.10125845e-02 -1.36184318e-01 -4.04655315e-02]
 [-1.01444811e-01  1.55161866e-01 -7.01098308e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.3192737]
curr_Stock_Price:  99.67109471530799
curr_Factors:  [99.67109472 -1.13531238 -1.00252333]
mat_Sqrt:  [[11.75219467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254497  0.02073791  0.09111491]
Stock Position:  -0.002544967465378609
Bond Position:  [-0.06561401]


portfolio before change:  [-0.32053684]
curr_Stock_Price:  100.16097675822611
curr_Factors:  [100.16097676  -1.41960525  -0.98875956]
mat_Sqrt:  [[ 9.01070983  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00324105  0.02454103 -0.11470804]
Stock Position:  0.0032410471146649142
Bond Position:  [-0.64516328]


portfolio before change:  [-0.31919678]
curr_Stock_Price:  100.62421410292586
curr_Factors:  [100.6242141   -1.30244866  -1.01426766]
mat_Sqrt:  [[ 9.921227    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00786422  0.01370813 -0.02999186]
Stock Position:  -0.007864222692761188
Bond Position:  [0.47213445]


portfolio before change:  [-0.32760105]
curr_Stock_Price:  101.70789632408508
curr_Factors:  [101.70789632  -1.34018669  -1.03289398]
mat_Sqrt:  [[ 9.47848287  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00482847 -0.03954756  1.92664855]
Stock Position:  -0.004828470314143268
Bond Position:  [0.16349251]


portfolio before change:  [-0.32457147]
curr_Stock_Price:  101.0889215620545
curr_Factors:  [101.08892156  -1.1536999   -1.02908211]
mat_Sqrt:  [[11.3954999   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00142504 -0.00662748  0.01267973]
Stock Position:  -0.0014250379659607865
Bond Position:  [-0.18051592]


portfolio before change:  [-0.32313238]
curr_Stock_Price:  100.04738960436666
curr_Factors:  [100.0473896   -1.21603769  -1.01497352]
mat_Sqrt:  [[10.74706573  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07691319  0.32743908 -0.38630904]
Stock Position:  -0.07691318555665787
Bond Position:  [7.37183106]


portfolio before change:  [-0.32992372]
curr_Stock_Price:  100.15965288941493
curr_Factors:  [100.15965289  -1.40814414  -0.97833404]
mat_Sqrt:  [[ 9.20997615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00086778 0.0010621  0.04782271]
Stock Position:  0.000867781134656205
Bond Position:  [-0.41684037]


portfolio before change:  [-0.32972354]
curr_Stock_Price:  100.51042999281722
curr_Factors:  [100.51042999  -1.62140495  -0.95436652]
mat_Sqrt:  [[ 7.64835068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01320322 -0.00686665 -0.05031706]
Stock Position:  -0.01320322192976776
Bond Position:  [0.99733797]


portfolio before change:  [-0.3163686]
curr_Stock_Price:  99.51782572747065
curr_Factors:  [99.51782573 -1.62450317 -0.96137133]
mat_Sqrt:  [[ 7.49669523  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01532423 0.0092755  0.15045293]
Stock Position:  0.015324226344963398
Bond Position:  [-1.84140229]


portfolio before change:  [-0.31894665]
curr_Stock_Price:  99.37963647784476
curr_Factors:  [99.37963648 -1.47720658 -0.93720248]
mat_Sqrt:  [[ 8.88654356  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01465674 0.04466447 0.1688857 ]
Stock Position:  0.014656744621174191
Bond Position:  [-1.77552861]


portfolio before change:  [-0.31097242]
curr_Stock_Price:  99.95399128735323
curr_Factors:  [99.95399129 -1.33890261 -0.92505296]
mat_Sqrt:  [[10.38907135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01116201  0.01041274 -0.15038121]
Stock Position:  0.011162008484216971
Bond Position:  [-1.42665972]


portfolio before change:  [-0.29851271]
curr_Stock_Price:  101.10220921264298
curr_Factors:  [101.10220921  -1.18364244  -0.95288496]
mat_Sqrt:  [[11.93654357  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172323  0.04408784  0.22519899]
Stock Position:  -0.001723234937353284
Bond Position:  [-0.12428985]


portfolio before change:  [-0.2996407]
curr_Stock_Price:  101.73875231342465
curr_Factors:  [101.73875231  -1.38336692  -0.97200082]
mat_Sqrt:  [[ 9.65079737  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01568663 -0.03611968 -0.12739718]
Stock Position:  -0.015686627215318272
Bond Position:  [1.29629718]


portfolio before change:  [-0.29842621]
curr_Stock_Price:  101.68199220885391
curr_Factors:  [101.68199221  -1.47787531  -0.96739843]
mat_Sqrt:  [[ 8.81607257  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01001811  0.21942221 -1.16225039]
Stock Position:  0.010018114730652616
Bond Position:  [-1.31708808]


portfolio before change:  [-0.30212053]
curr_Stock_Price:  101.34609971965045
curr_Factors:  [101.34609972  -1.33748881  -0.94677936]
mat_Sqrt:  [[10.32195533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.55627611e-06 -4.60111505e-02 -1.44451176e-01]
Stock Position:  -7.556276112527744e-06
Bond Position:  [-0.30135474]


portfolio before change:  [-0.30220048]
curr_Stock_Price:  101.95411204762932
curr_Factors:  [101.95411205  -1.22184793  -0.92350253]
mat_Sqrt:  [[11.93138551  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00743203 0.00828896 0.40167201]
Stock Position:  0.007432032876697343
Bond Position:  [-1.05992679]


portfolio before change:  [-0.30634178]
curr_Stock_Price:  101.43254721032034
curr_Factors:  [101.43254721  -1.27238254  -0.90555663]
mat_Sqrt:  [[11.48974441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00598706  0.00525786  0.16709793]
Stock Position:  -0.005987062329211579
Bond Position:  [0.3009412]


portfolio before change:  [-0.30655449]
curr_Stock_Price:  101.48064315152666
curr_Factors:  [101.48064315  -1.50947185  -0.91494735]
mat_Sqrt:  [[ 8.98403281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00055143 -0.0439533  -0.1154369 ]
Stock Position:  0.0005514321967633658
Bond Position:  [-0.36251418]


portfolio before change:  [-0.30683791]
curr_Stock_Price:  101.13104028576552
curr_Factors:  [101.13104029  -1.38707824  -0.90620116]
mat_Sqrt:  [[10.20765272  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00697552  0.05007828 -0.02000038]
Stock Position:  -0.006975515348539935
Bond Position:  [0.39860321]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.30258675]
Stock Price:  100.53588752065204
PL:  [-0.83847427]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-3.10754704e-03 -1.51074390e-02  4.59581027e-02]
 [ 2.04227199e-02  1.42270978e-01 -1.75199748e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-2.72267066e-01 -2.82688956e-01  8.70741410e-01]
 [-5.13661608e-02  3.61717276e-02 -3.37483966e-02]
 [-1.07712443e+00  1.16942408e+00 -1.67990488e-01]
 [ 1.83225665e-03 -2.90009010e-02  8.82967105e-03]
 [-2.89448992e-02 -1.74514101e-01  2.86240321e-01]
 [ 3.28243481e-02 -2.32979223e-02 -1.51866973e-02]
 [-4.08849786e-01  2.53707013e-01 -2.00938733e-01]
 [ 1.33967443e-01  4.23287811e-02 -5.44798652e-02]
 [-2.52493126e-02  1.20812676e-01  2.85016926e-02]
 [ 2.25482107e-01  1.46222262e-01 -9.51580555e-02]
 [ 1.22039762e-02  1.09802759e+00 -6.85862342e-01]
 [ 1.60087514e-01 -8.34954862e-02  7.45842491e-03]
 [ 1.43986094e-02 -3.62521564e-02 -1.34951477e-01]
 [-8.35177855e-02  1.61718636e-02  5.56039086e-02]
 [ 3.63557287e-02 -1.16571478e-01 -4.68233314e-02]
 [-1.49933959e-01  4.02740404e-02 -2.03795517e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.35505681]
curr_Stock_Price:  100.89065682289657
curr_Factors:  [100.89065682  -1.18438047  -0.9859093 ]
mat_Sqrt:  [[11.51611723  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00027699 -0.0048759   0.13110567]
Stock Position:  0.0002769873073191953
Bond Position:  [9.32711138]


portfolio before change:  [9.3575354]
curr_Stock_Price:  101.41963112577359
curr_Factors:  [101.41963113  -0.76636104  -0.98660217]
mat_Sqrt:  [[17.57194253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00077972  0.04591776 -0.49979611]
Stock Position:  0.0007797181706424235
Bond Position:  [9.27845667]


portfolio before change:  [9.35960384]
curr_Stock_Price:  101.0971211936633
curr_Factors:  [101.09712119  -0.68282294  -0.97068206]
mat_Sqrt:  [[19.34776008  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00403265  0.01370813 -0.02999186]
Stock Position:  -0.0040326496801721436
Bond Position:  [9.76729311]


portfolio before change:  [9.365529]
curr_Stock_Price:  100.2334131684558
curr_Factors:  [100.23341317  -0.72470514  -0.90136666]
mat_Sqrt:  [[19.71598623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00772121 -0.09123747  2.48398287]
Stock Position:  -0.00772121465894155
Bond Position:  [10.1394527]


portfolio before change:  [9.36710334]
curr_Stock_Price:  100.35785379131217
curr_Factors:  [100.35785379  -0.87068664  -0.88768485]
mat_Sqrt:  [[17.29419425  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00294154  0.01167437 -0.09627478]
Stock Position:  -0.002941536312876531
Bond Position:  [9.66230961]


portfolio before change:  [9.36204429]
curr_Stock_Price:  102.89902170526258
curr_Factors:  [102.89902171  -0.78013946  -0.91458833]
mat_Sqrt:  [[18.89732435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04618155  0.37743    -0.4792301 ]
Stock Position:  -0.0461815462151032
Bond Position:  [14.11408021]


portfolio before change:  [9.30031526]
curr_Stock_Price:  104.31209671687085
curr_Factors:  [104.31209672  -1.00845752  -0.9074321 ]
mat_Sqrt:  [[15.35586863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00014881 -0.00936     0.02518859]
Stock Position:  -0.00014881466314031094
Bond Position:  [9.31583843]


portfolio before change:  [9.30253118]
curr_Stock_Price:  105.07366734021828
curr_Factors:  [105.07366734  -0.98113469  -0.91335563]
mat_Sqrt:  [[15.80255105  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.88473999e-04 -5.63241840e-02  8.16563961e-01]
Stock Position:  -0.00038847399945971
Bond Position:  [9.34334956]


portfolio before change:  [9.30489595]
curr_Stock_Price:  104.99992691382185
curr_Factors:  [104.99992691  -0.75812154  -0.91062533]
mat_Sqrt:  [[19.790713    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00126164 -0.00751937 -0.04332342]
Stock Position:  0.0012616376180676068
Bond Position:  [9.17242409]


portfolio before change:  [9.30365836]
curr_Stock_Price:  102.20119796156446
curr_Factors:  [102.20119796  -0.67849338  -0.93838927]
mat_Sqrt:  [[20.28863233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01962077  0.08188359 -0.57322228]
Stock Position:  -0.01962076593579277
Bond Position:  [11.30892415]


portfolio before change:  [9.28608689]
curr_Stock_Price:  103.24086484315814
curr_Factors:  [103.24086484  -1.11502457  -0.90929765]
mat_Sqrt:  [[13.63639785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00964236  0.01366156 -0.15541589]
Stock Position:  0.009642364089314903
Bond Position:  [8.29060088]


portfolio before change:  [9.29517712]
curr_Stock_Price:  103.96862486519362
curr_Factors:  [103.96862487  -0.90941706  -0.8772472 ]
mat_Sqrt:  [[17.41661984  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00030025 0.03899212 0.0813074 ]
Stock Position:  0.0003002508708580585
Bond Position:  [9.26396045]


portfolio before change:  [9.29793007]
curr_Stock_Price:  105.422973732523
curr_Factors:  [105.42297373  -0.44569425  -0.86971012]
mat_Sqrt:  [[28.29191884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00833827  0.04719303 -0.27145945]
Stock Position:  0.008338265991668101
Bond Position:  [8.41888527]


portfolio before change:  [9.31787494]
curr_Stock_Price:  107.56249376430642
curr_Factors:  [107.56249376  -0.45117144  -0.87156763]
mat_Sqrt:  [[28.65514324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00336194  0.35438688 -1.95657436]
Stock Position:  0.0033619394330748633
Bond Position:  [8.95625635]


portfolio before change:  [9.31893191]
curr_Stock_Price:  107.21079899126434
curr_Factors:  [107.21079899  -0.31553018  -0.91514679]
mat_Sqrt:  [[31.31571371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00461642 -0.02694805  0.02127681]
Stock Position:  0.004616420862449334
Bond Position:  [8.82400174]


portfolio before change:  [9.32529961]
curr_Stock_Price:  108.11223729282733
curr_Factors:  [ 1.08112237e+02 -6.73348347e-02 -8.85363975e-01]
mat_Sqrt:  [[41.6987483   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00049278 -0.01170033 -0.384979  ]
Stock Position:  -0.0004927770468683321
Bond Position:  [9.37857483]


portfolio before change:  [9.32880685]
curr_Stock_Price:  105.75355473963825
curr_Factors:  [ 1.05753555e+02  5.46372647e-03 -8.80335070e-01]
mat_Sqrt:  [[44.09031255  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00156194  0.00521945  0.15862247]
Stock Position:  -0.0015619444138468155
Bond Position:  [9.49398802]


portfolio before change:  [9.33443813]
curr_Stock_Price:  103.66801683453299
curr_Factors:  [103.66801683  -0.57874684  -0.8503673 ]
mat_Sqrt:  [[24.83066833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.20935238e-04 -3.76232829e-02 -1.33573931e-01]
Stock Position:  0.00012093523832277854
Bond Position:  [9.32190102]


portfolio before change:  [9.33680171]
curr_Stock_Price:  103.93934209862502
curr_Factors:  [103.9393421   -0.53076261  -0.86995799]
mat_Sqrt:  [[25.61266318  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00569535  0.01299839 -0.05813719]
Stock Position:  -0.0056953473746161245
Bond Position:  [9.92877237]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.34967022]
Stock Price:  102.11574761775171
PL:  [7.2339226]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 3.92393722e-02 -1.14149630e-01  2.56508883e-02]
 [ 2.07933943e-02  1.41451154e-01 -1.77753976e-01]
 [-1.38903368e-02 -9.65366922e-02 -1.77424238e-01]
 [-1.03077778e-01 -4.74562958e-02  5.37444059e-01]
 [ 3.81017227e-02 -9.59083275e-02  5.52111182e-02]
 [-7.48777366e-01  7.46941917e-01 -8.35523782e-02]
 [ 6.18457086e-03 -5.72404720e-04  2.27713152e-02]
 [-9.25635554e-02 -2.19123453e-02 -1.55584595e-02]
 [ 3.25446084e-03  2.33567684e-02  5.73555642e-02]
 [-1.89582492e-01  2.00903302e-01 -8.89701840e-02]
 [ 1.19928693e-01  3.22588811e-02 -5.27128297e-02]
 [-8.50480715e-02  1.25826502e-01  1.27813546e-01]
 [-1.87718775e-01 -1.24985946e-01  3.30533481e-02]
 [ 4.56937611e-02  4.80296496e-01 -2.28185265e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 5.57638364e-02  2.85706668e-02  1.14569202e-01]
 [-5.01753423e-02  1.58170537e-02  7.64181640e-02]
 [ 4.42269382e-02 -1.45361801e-01 -3.68798984e-02]
 [-1.01195227e-01  1.59049577e-01 -7.56982251e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.4538586]
curr_Stock_Price:  102.66797509942853
curr_Factors:  [102.6679751   -1.15998404  -1.00567015]
mat_Sqrt:  [[11.7734389   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00179851 -0.03684163  0.07317484]
Stock Position:  0.001798509540851104
Bond Position:  [23.26920927]


portfolio before change:  [23.45806445]
curr_Stock_Price:  101.77157680722812
curr_Factors:  [101.77157681  -1.13538412  -1.01645236]
mat_Sqrt:  [[11.83302537  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.001131    0.04565316 -0.50708262]
Stock Position:  0.001130996623882541
Bond Position:  [23.34296114]


portfolio before change:  [23.46454059]
curr_Stock_Price:  102.33715961590741
curr_Factors:  [102.33715962  -1.64439203  -1.02867853]
mat_Sqrt:  [[ 7.06534813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00988095 -0.03115708 -0.50614197]
Stock Position:  -0.00988095367150854
Bond Position:  [24.47572933]


portfolio before change:  [23.47431316]
curr_Stock_Price:  101.96747166098399
curr_Factors:  [101.96747166  -1.60299285  -1.03303526]
mat_Sqrt:  [[ 7.3054873   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.18787226e-04 -1.53164536e-02  1.53317830e+00]
Stock Position:  -0.00041878722611666966
Bond Position:  [23.51701583]


portfolio before change:  [23.48057319]
curr_Stock_Price:  101.0599868121659
curr_Factors:  [101.05998681  -1.3646253   -1.02515415]
mat_Sqrt:  [[ 9.2621371   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0032168  -0.03095428  0.15750195]
Stock Position:  0.003216799681847269
Bond Position:  [23.15548346]


portfolio before change:  [23.48441536]
curr_Stock_Price:  100.45459474059376
curr_Factors:  [100.45459474  -1.57931893  -0.97697534]
mat_Sqrt:  [[ 7.79444707  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07869237  0.24107447 -0.23835168]
Stock Position:  -0.07869237388530177
Bond Position:  [31.38942589]


portfolio before change:  [23.50941233]
curr_Stock_Price:  100.23667493025893
curr_Factors:  [100.23667493  -1.47928873  -0.96100676]
mat_Sqrt:  [[ 8.73413272  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012269  -0.00018474  0.06496022]
Stock Position:  0.0012268996619587739
Bond Position:  [23.38643198]


portfolio before change:  [23.51523845]
curr_Stock_Price:  100.21937961608864
curr_Factors:  [100.21937962  -1.56566549  -0.98092788]
mat_Sqrt:  [[ 7.8519995   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01276264 -0.00707218 -0.04438395]
Stock Position:  -0.012762641087376757
Bond Position:  [24.79430242]


portfolio before change:  [23.51635786]
curr_Stock_Price:  100.61741104885363
curr_Factors:  [100.61741105  -1.75805874  -0.96126604]
mat_Sqrt:  [[ 6.63262425  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00297466 0.00753836 0.16361946]
Stock Position:  0.0029746591945424635
Bond Position:  [23.21705536]


portfolio before change:  [23.5226232]
curr_Stock_Price:  100.772167754747
curr_Factors:  [100.77216775  -1.52845075  -0.97809166]
mat_Sqrt:  [[ 8.2179418   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02028905  0.06484126 -0.25380717]
Stock Position:  -0.02028905094451341
Bond Position:  [25.56719485]


portfolio before change:  [23.54620334]
curr_Stock_Price:  99.92503399502574
curr_Factors:  [99.925034   -1.15512547 -1.00834124]
mat_Sqrt:  [[11.48398585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01007956  0.01041151 -0.15037503]
Stock Position:  0.010079562091475517
Bond Position:  [22.53900275]


portfolio before change:  [23.54782956]
curr_Stock_Price:  99.52727551646747
curr_Factors:  [99.52727552 -1.33841392 -1.0285831 ]
mat_Sqrt:  [[ 9.3318634   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00356563  0.04061033  0.36461647]
Stock Position:  -0.003565634446708257
Bond Position:  [23.90270744]


portfolio before change:  [23.55302937]
curr_Stock_Price:  99.74508274357098
curr_Factors:  [99.74508274 -1.38914752 -0.97964759]
mat_Sqrt:  [[ 9.33548421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02211824 -0.04033904  0.094292  ]
Stock Position:  -0.02211823543635895
Bond Position:  [25.75921459]


portfolio before change:  [23.57414391]
curr_Stock_Price:  99.08165103789796
curr_Factors:  [99.08165104 -1.41220576 -0.96308393]
mat_Sqrt:  [[ 9.21335978  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01054509  0.15501503 -0.65094905]
Stock Position:  0.010545094627777089
Bond Position:  [22.52931853]


portfolio before change:  [23.57859463]
curr_Stock_Price:  98.96953122363556
curr_Factors:  [98.96953122 -1.38824988 -0.99373943]
mat_Sqrt:  [[ 9.14148387  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0145483  -0.09296045 -0.18429859]
Stock Position:  -0.014548303152923665
Bond Position:  [25.01843338]


portfolio before change:  [23.59199919]
curr_Stock_Price:  98.47812239501742
curr_Factors:  [98.4781224  -1.31436989 -0.95665284]
mat_Sqrt:  [[10.16358958  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00836143 0.00922114 0.32683404]
Stock Position:  0.00836142970189576
Bond Position:  [22.76858129]


portfolio before change:  [23.62203971]
curr_Stock_Price:  101.39002426180726
curr_Factors:  [101.39002426  -1.6662575   -0.96173501]
mat_Sqrt:  [[ 7.32272256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00428091  0.00510493  0.21799975]
Stock Position:  -0.004280908779987163
Bond Position:  [24.05608115]


portfolio before change:  [23.62981004]
curr_Stock_Price:  100.97993293060516
curr_Factors:  [100.97993293  -1.55427399  -0.9876197 ]
mat_Sqrt:  [[ 7.94885686  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00088403 -0.04691532 -0.10520808]
Stock Position:  0.0008840273694582778
Bond Position:  [23.54054102]


portfolio before change:  [23.63531395]
curr_Stock_Price:  100.54786602225289
curr_Factors:  [100.54786602  -1.4713065   -0.99859579]
mat_Sqrt:  [[ 8.50565811  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00826209  0.05133303 -0.0215946 ]
Stock Position:  -0.008262094523346876
Bond Position:  [24.46604993]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.63999665]
Stock Price:  100.72149985816593
PL:  [22.91849679]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-5.10361088e-02  7.16132042e-02  3.06242159e-02]
 [ 1.51650833e-03 -2.12355218e-02  5.80414926e-02]
 [ 8.65893676e-02 -4.94444615e-02 -2.61419992e-02]
 [-1.29941250e-01 -8.75672566e-02  3.44917705e-01]
 [ 5.14301592e-02 -1.15584892e-01  6.84638207e-02]
 [-1.03962588e+00  9.86466249e-01 -1.23936348e-01]
 [-4.22683767e-02  3.34156224e-02 -8.93994393e-02]
 [ 8.38201090e-02 -6.86998995e-02 -3.78148463e-03]
 [ 4.13772271e-02  2.54742472e-02  4.06579436e-02]
 [ 1.53248366e-01  1.18058100e-01  8.40659532e-02]
 [-2.74785052e-02  1.59794215e-02 -4.33455050e-02]
 [-4.18727425e-02  1.48540123e-01  2.47890127e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-2.77887888e-02 -6.68217210e-02  3.50553876e-02]
 [-9.46316250e-03 -7.80716693e-02 -5.92158655e-02]
 [ 4.68406581e-02  3.34661538e-02 -3.02528816e-02]
 [ 1.63720507e-01 -3.39661005e-02  1.62870671e-01]
 [-8.64768349e-02  5.67756502e-02  9.77359140e-02]
 [ 9.38532430e-02 -9.24792395e-02 -2.69591182e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.49847792]
curr_Stock_Price:  99.64850393507362
curr_Factors:  [99.64850394 -1.13088672 -0.99514935]
mat_Sqrt:  [[11.88899248  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253739  0.02311306  0.08736236]
Stock Position:  -0.0025373876582978237
Bond Position:  [-0.24563103]


portfolio before change:  [-0.49617321]
curr_Stock_Price:  98.71600033138752
curr_Factors:  [98.71600033 -1.01311322 -1.01102666]
mat_Sqrt:  [[13.04111633  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00069239 -0.00685374  0.16557622]
Stock Position:  0.0006923867116538339
Bond Position:  [-0.56452286]


portfolio before change:  [-0.49618844]
curr_Stock_Price:  98.89786694674032
curr_Factors:  [98.89786695 -0.74904939 -1.00448821]
mat_Sqrt:  [[17.12518312  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0041553  -0.01595813 -0.07457585]
Stock Position:  0.004155304231406042
Bond Position:  [-0.90713916]


portfolio before change:  [-0.49886096]
curr_Stock_Price:  98.30929100841134
curr_Factors:  [98.30929101 -0.89365151 -0.95680439]
mat_Sqrt:  [[15.45082872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00501007 -0.02826221  0.98395421]
Stock Position:  -0.005010074911405891
Bond Position:  [-0.00632405]


portfolio before change:  [-0.5041022]
curr_Stock_Price:  99.35511535032113
curr_Factors:  [99.35511535 -1.14982756 -0.96568588]
mat_Sqrt:  [[11.97938216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0034903  -0.03730486  0.19530822]
Stock Position:  0.0034902977573815944
Bond Position:  [-0.85088114]


portfolio before change:  [-0.50837541]
curr_Stock_Price:  98.19175935860443
curr_Factors:  [98.19175936 -1.00073902 -0.94483852]
mat_Sqrt:  [[14.03206063  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06154212  0.31838061 -0.3535559 ]
Stock Position:  -0.0615421160954371
Bond Position:  [5.53455325]


portfolio before change:  [-0.36422823]
curr_Stock_Price:  95.87199249635917
curr_Factors:  [95.8719925  -1.02121362 -0.97354436]
mat_Sqrt:  [[13.04305637  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00411683  0.01078485 -0.25503172]
Stock Position:  -0.004116828445959139
Bond Position:  [0.03046031]


portfolio before change:  [-0.36433888]
curr_Stock_Price:  95.90071942523076
curr_Factors:  [95.90071943 -0.86038534 -0.98978505]
mat_Sqrt:  [[15.07658827  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00457828 -0.0221728  -0.01078752]
Stock Position:  0.004578284373024472
Bond Position:  [-0.80339965]


portfolio before change:  [-0.36837784]
curr_Stock_Price:  95.06239564651214
curr_Factors:  [95.06239565 -0.82620875 -0.98327115]
mat_Sqrt:  [[15.56544775  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00352553 0.00822178 0.1159858 ]
Stock Position:  0.0035255268571268493
Bond Position:  [-0.70352287]


portfolio before change:  [-0.36706367]
curr_Stock_Price:  95.48504960380848
curr_Factors:  [95.4850496  -0.89915237 -1.00994998]
mat_Sqrt:  [[14.15216103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01374396 0.03810309 0.23981677]
Stock Position:  0.013743962158024575
Bond Position:  [-1.67940658]


portfolio before change:  [-0.37355805]
curr_Stock_Price:  95.04307548300399
curr_Factors:  [95.04307548 -1.01981664 -1.0095278 ]
mat_Sqrt:  [[12.49071759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264713  0.00515734 -0.12365266]
Stock Position:  -0.0026471324306845717
Bond Position:  [-0.12196644]


portfolio before change:  [-0.37400725]
curr_Stock_Price:  95.20125052165982
curr_Factors:  [95.20125052 -0.98508745 -1.03326157]
mat_Sqrt:  [[12.64983354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051321  0.04794112  0.07071615]
Stock Position:  -0.000513214720121552
Bond Position:  [-0.32514857]


portfolio before change:  [-0.37306183]
curr_Stock_Price:  93.20068614038273
curr_Factors:  [93.20068614 -0.95921516 -1.02798652]
mat_Sqrt:  [[12.77580821  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00131977 -0.00995959  0.34984664]
Stock Position:  0.0013197696087629842
Bond Position:  [-0.49606526]


portfolio before change:  [-0.37164209]
curr_Stock_Price:  94.37041524819732
curr_Factors:  [94.37041525 -0.87422551 -1.07415743]
mat_Sqrt:  [[13.44819219  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254853 -0.02156662  0.10000326]
Stock Position:  -0.0025485257802242123
Bond Position:  [-0.13113665]


portfolio before change:  [-0.37464238]
curr_Stock_Price:  95.53481530347068
curr_Factors:  [95.5348153  -1.06718478 -1.06983502]
mat_Sqrt:  [[11.27368154  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332517 -0.02519752 -0.16892638]
Stock Position:  -0.003325166056530905
Bond Position:  [-0.05697326]


portfolio before change:  [-0.37279308]
curr_Stock_Price:  94.97437958725395
curr_Factors:  [94.97437959 -0.93954252 -1.07053518]
mat_Sqrt:  [[12.72450248  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00373269  0.01080115 -0.08630305]
Stock Position:  0.003732685392286082
Bond Position:  [-0.72730256]


portfolio before change:  [-0.37542035]
curr_Stock_Price:  94.31924381424528
curr_Factors:  [94.31924381 -0.80741356 -1.09002973]
mat_Sqrt:  [[14.14331319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01343625 -0.01096251  0.46462469]
Stock Position:  0.013436246519091026
Bond Position:  [-1.64271696]


portfolio before change:  [-0.37093869]
curr_Stock_Price:  94.68336279990342
curr_Factors:  [94.6833628  -1.04713201 -1.07628466]
mat_Sqrt:  [[11.32623406  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00485045  0.01832426  0.27881336]
Stock Position:  -0.004850446634280201
Bond Position:  [0.08831791]


portfolio before change:  [-0.37359047]
curr_Stock_Price:  95.23462513109185
curr_Factors:  [95.23462513 -0.97363465 -1.08541962]
mat_Sqrt:  [[12.14951576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00164171 -0.02984755 -0.7690686 ]
Stock Position:  0.0016417055695046613
Bond Position:  [-0.52993769]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.37229515]
Stock Price:  96.10434801700637
PL:  [-0.37229515]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-3.52280707e-02  5.46189092e-02  2.87282109e-02]
 [ 8.25502626e-02  1.49826800e-01 -3.25679864e-01]
 [ 8.85336013e-02 -3.95112892e-02 -3.51168101e-02]
 [-4.29819088e-01 -4.92795105e-01  1.34537069e+00]
 [-6.34421833e-02  5.39993732e-02 -4.57558016e-02]
 [-1.49582197e+00  1.46930268e+00 -2.08841949e-01]
 [-9.80299485e-02 -2.88615841e-01 -1.68314111e-02]
 [ 4.32692180e-02 -3.58785451e-01  6.53503610e-01]
 [ 7.31538831e-03 -3.43134798e-02 -2.99156302e-02]
 [-9.74471238e-01  3.82664220e-01 -4.98017647e-01]
 [ 1.56904522e-01  5.56167875e-02 -5.68440181e-02]
 [-4.16446234e-02 -6.90720591e-02 -1.71826954e-02]
 [ 2.11001144e-01  1.03739881e-01 -1.15220434e-01]
 [ 8.28265692e-03  9.10725986e-01 -5.96358781e-01]
 [ 1.60055981e-01 -8.32655486e-02  7.42449528e-03]
 [ 3.22744414e-02  1.60529736e-03 -4.81844457e-02]
 [-8.63810083e-02  1.58486294e-02  5.66088677e-02]
 [ 3.79252593e-02 -1.38671104e-01 -4.39341224e-02]
 [-1.70277400e-01  2.48025328e-02 -3.22201655e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.93586892]
curr_Stock_Price:  100.08144337909579
curr_Factors:  [100.08144338  -0.64135052  -0.95403269]
mat_Sqrt:  [[20.29959783  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008973   0.01762818  0.08195359]
Stock Position:  -0.0008973040355266094
Bond Position:  [3.02567241]


portfolio before change:  [2.93688058]
curr_Stock_Price:  99.79710016003007
curr_Factors:  [99.79710016 -0.51665689 -0.92134187]
mat_Sqrt:  [[23.69206929  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0019692   0.04835639 -0.929074  ]
Stock Position:  0.0019691993028863497
Bond Position:  [2.7403602]


portfolio before change:  [2.93634509]
curr_Stock_Price:  99.17722198343165
curr_Factors:  [99.17722198 -0.17579503 -0.86613745]
mat_Sqrt:  [[34.98697655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00209507 -0.01275221 -0.10017848]
Stock Position:  0.002095071124573149
Bond Position:  [2.72856176]


portfolio before change:  [2.93948255]
curr_Stock_Price:  100.34913344469956
curr_Factors:  [ 1.00349133e+02 -5.44748990e-02 -8.47898352e-01]
mat_Sqrt:  [[40.70220178  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00628437 -0.15904894  3.83796811]
Stock Position:  -0.0062843731753767194
Bond Position:  [3.57011396]


portfolio before change:  [2.94022031]
curr_Stock_Price:  100.3737798511272
curr_Factors:  [ 1.00373780e+02  2.55908279e-02 -8.35132714e-01]
mat_Sqrt:  [[44.67254602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138249  0.01742822 -0.13052857]
Stock Position:  -0.0013824927566425489
Bond Position:  [3.07898633]


portfolio before change:  [2.94322139]
curr_Stock_Price:  98.75985620444908
curr_Factors:  [98.7598562   0.3029153  -0.83132956]
mat_Sqrt:  [[58.22279493  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02127228  0.4742154  -0.59576795]
Stock Position:  -0.021272278283728314
Bond Position:  [5.04406853]


portfolio before change:  [2.74550953]
curr_Stock_Price:  108.11348662791586
curr_Factors:  [108.11348663   0.16363686  -0.83967031]
mat_Sqrt:  [[54.98981722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00291652 -0.09315036 -0.04801533]
Stock Position:  -0.002916523747531921
Bond Position:  [3.06082508]


portfolio before change:  [2.7475521]
curr_Stock_Price:  107.67554400439069
curr_Factors:  [107.675544    -0.25357119  -0.84023788]
mat_Sqrt:  [[36.06465913  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00286786 -0.11579751  1.8642639 ]
Stock Position:  0.0028678576958968607
Bond Position:  [2.43875397]


portfolio before change:  [2.74275938]
curr_Stock_Price:  105.79173817636595
curr_Factors:  [105.79173818  -0.45086108  -0.85457504]
mat_Sqrt:  [[28.67530508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0002021  -0.01107463 -0.08534097]
Stock Position:  -0.00020210155915021785
Bond Position:  [2.76414006]


portfolio before change:  [2.74348747]
curr_Stock_Price:  105.6088363525035
curr_Factors:  [105.60883635  -0.74828413  -0.84492398]
mat_Sqrt:  [[21.46736625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04648999  0.12350435 -1.42070572]
Stock Position:  -0.04648999071683123
Bond Position:  [7.65324129]


portfolio before change:  [2.76447104]
curr_Stock_Price:  105.19864004169354
curr_Factors:  [105.19864004  -0.84868394  -0.86288176]
mat_Sqrt:  [[18.99706834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00824622  0.01795024 -0.16216016]
Stock Position:  0.008246220526372038
Bond Position:  [1.89697986]


portfolio before change:  [2.7676429]
curr_Stock_Price:  105.5257669029086
curr_Factors:  [105.5257669   -0.53321323  -0.85331661]
mat_Sqrt:  [[26.37523015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224648 -0.02229291 -0.04901745]
Stock Position:  -0.002246475237471024
Bond Position:  [3.00470393]


portfolio before change:  [2.76969847]
curr_Stock_Price:  104.94517052164423
curr_Factors:  [104.94517052  -0.51232526  -0.84319108]
mat_Sqrt:  [[27.05634899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00771197  0.0334819  -0.32869183]
Stock Position:  0.0077119675742020975
Bond Position:  [1.96036472]


portfolio before change:  [2.77561179]
curr_Stock_Price:  105.64838451457135
curr_Factors:  [105.64838451  -0.29904157  -0.87785281]
mat_Sqrt:  [[32.56447842  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0022249   0.29393555 -1.70124561]
Stock Position:  0.0022248964974210467
Bond Position:  [2.54055507]


portfolio before change:  [2.77997911]
curr_Stock_Price:  107.32581281369772
curr_Factors:  [107.32581281  -0.20278664  -0.90656152]
mat_Sqrt:  [[35.39324646  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00408482 -0.02687384  0.02118002]
Stock Position:  0.0040848185815209066
Bond Position:  [2.34157263]


portfolio before change:  [2.76648183]
curr_Stock_Price:  103.8782306677567
curr_Factors:  [103.87823067  -0.35099975  -0.86361551]
mat_Sqrt:  [[30.83357184  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00073837  0.00051811 -0.13745681]
Stock Position:  0.0007383676690028264
Bond Position:  [2.6897815]


portfolio before change:  [2.76849318]
curr_Stock_Price:  105.69144489565295
curr_Factors:  [105.6914449   -0.44714807  -0.87605779]
mat_Sqrt:  [[28.14354703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254377  0.00511512  0.16148934]
Stock Position:  -0.0025437690409073135
Bond Position:  [3.0373478]


portfolio before change:  [2.77116609]
curr_Stock_Price:  104.9392220173207
curr_Factors:  [104.93922202  -0.74574868  -0.81642256]
mat_Sqrt:  [[22.00368866  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.95915657e-05 -4.47559063e-02 -1.25331822e-01]
Stock Position:  2.9591565747619537e-05
Bond Position:  [2.76806077]


portfolio before change:  [2.77188715]
curr_Stock_Price:  105.91775630415592
curr_Factors:  [105.9177563   -0.37445895  -0.807006  ]
mat_Sqrt:  [[32.49863064  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00528612  0.00800498 -0.09191516]
Stock Position:  -0.005286115571038692
Bond Position:  [3.33178065]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.75700746]
Stock Price:  108.89020995457102
PL:  [-6.13320249]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-3.37354589e-02  2.18687691e-02  3.94761437e-02]
 [ 3.82587741e-02  1.33792462e-01 -2.40418910e-01]
 [ 7.61475593e-02 -7.18560719e-02 -2.12810349e-02]
 [ 2.75342524e-02  2.48718320e-02 -2.74284986e-02]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-8.95797460e-01  7.85754956e-01 -7.75292507e-02]
 [-3.75871466e-02  3.08997634e-02 -7.90442858e-02]
 [ 1.01143992e-01 -1.22069948e-01  3.79342088e-02]
 [ 5.86771682e-02  2.35458183e-02  3.64971503e-02]
 [ 1.46815575e-01  1.43638979e-01  9.66057505e-02]
 [-1.49089867e-01 -6.41664359e-02 -2.90802980e-03]
 [ 8.64290960e-02 -2.47416599e-02 -3.54763854e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-3.94684854e-02 -4.56362245e-02  4.41271986e-03]
 [ 3.23602748e-02  2.23365407e-01 -2.44570226e-02]
 [ 5.28468308e-02  4.70537599e-02 -1.27311566e-02]
 [ 1.82296189e-01 -3.47324398e-02  1.67611019e-01]
 [-1.09360663e-01  1.11996710e-01  1.07533293e-01]
 [ 7.31412403e-02  8.59006883e-02 -2.16646361e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.48240018]
curr_Stock_Price:  100.27640166749276
curr_Factors:  [100.27640167  -1.0891787   -0.98790849]
mat_Sqrt:  [[12.56409568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168842  0.00705811  0.11261445]
Stock Position:  -0.0016884208411395265
Bond Position:  [4.65170895]


portfolio before change:  [4.48388336]
curr_Stock_Price:  100.08681096589122
curr_Factors:  [100.08681097  -0.88754334  -1.0168885 ]
mat_Sqrt:  [[14.90364898  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00110669  0.04318133 -0.68584823]
Stock Position:  0.0011066914928134501
Bond Position:  [4.37311814]


portfolio before change:  [4.48377235]
curr_Stock_Price:  98.99850101720017
curr_Factors:  [98.99850102 -1.29884035 -1.00392925]
mat_Sqrt:  [[ 9.89802373  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00577247 -0.02319145 -0.06070887]
Stock Position:  0.005772468174940118
Bond Position:  [3.91230666]


portfolio before change:  [4.47614189]
curr_Stock_Price:  97.50716919808714
curr_Factors:  [97.5071692  -1.1123645  -0.98943833]
mat_Sqrt:  [[11.91887257  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00226635  0.00802735 -0.07824587]
Stock Position:  0.0022663532001350726
Bond Position:  [4.2551562]


portfolio before change:  [4.47622891]
curr_Stock_Price:  97.0761253313339
curr_Factors:  [97.07612533 -1.34895134 -0.98640328]
mat_Sqrt:  [[ 9.39465448  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00604571 -0.04522423  0.24245377]
Stock Position:  0.006045712720810391
Bond Position:  [3.88933455]


portfolio before change:  [4.4748831]
curr_Stock_Price:  96.6926684396085
curr_Factors:  [96.69266844 -1.2693263  -0.95520408]
mat_Sqrt:  [[10.45423539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07185906  0.25360132 -0.22116937]
Stock Position:  -0.07185905667340078
Bond Position:  [11.42312704]


portfolio before change:  [4.55096306]
curr_Stock_Price:  95.67367611481976
curr_Factors:  [95.67367611 -1.22158133 -0.93846091]
mat_Sqrt:  [[11.03311228  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429748  0.00997286 -0.22549135]
Stock Position:  -0.004297482423830147
Bond Position:  [4.962119]


portfolio before change:  [4.55532556]
curr_Stock_Price:  94.94724816759494
curr_Factors:  [94.94724817 -1.21970001 -0.91773466]
mat_Sqrt:  [[11.19969766  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00749751 -0.03939791  0.10821574]
Stock Position:  0.007497510950707209
Bond Position:  [3.84345753]


portfolio before change:  [4.5410597]
curr_Stock_Price:  92.91632878327103
curr_Factors:  [92.91632878 -1.10366617 -0.88898156]
mat_Sqrt:  [[12.66765213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00559957 0.00759938 0.10411621]
Stock Position:  0.005599568662900963
Bond Position:  [4.02076834]


portfolio before change:  [4.53884142]
curr_Stock_Price:  92.34064200760031
curr_Factors:  [92.34064201 -0.90544435 -0.91158587]
mat_Sqrt:  [[15.00606042  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01305175 0.04635928 0.27558932]
Stock Position:  0.01305174839689776
Bond Position:  [3.3336346]


portfolio before change:  [4.53995633]
curr_Stock_Price:  92.36220161722294
curr_Factors:  [92.36220162 -0.9929006  -0.91529022]
mat_Sqrt:  [[13.7017972   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01188029 -0.02070963 -0.0082958 ]
Stock Position:  -0.011880294460199451
Bond Position:  [5.63724648]


portfolio before change:  [4.54125138]
curr_Stock_Price:  92.37183389946826
curr_Factors:  [92.3718339  -0.45273948 -0.90553746]
mat_Sqrt:  [[23.74911244  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00312168 -0.00798534 -0.10120425]
Stock Position:  0.0031216804063190296
Bond Position:  [4.25289604]


portfolio before change:  [4.54050207]
curr_Stock_Price:  91.79116343877996
curr_Factors:  [91.79116344 -0.33882481 -0.93617975]
mat_Sqrt:  [[25.64917671  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00065737 -0.00995959  0.34984664]
Stock Position:  0.0006573748389161248
Bond Position:  [4.48016087]


portfolio before change:  [4.54306602]
curr_Stock_Price:  93.98743515890105
curr_Factors:  [93.98743516 -1.20972068 -0.91850175]
mat_Sqrt:  [[11.18908415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00427946 -0.01472903  0.01258826]
Stock Position:  -0.004279456424061152
Bond Position:  [4.94528116]


portfolio before change:  [4.5435081]
curr_Stock_Price:  94.17306539242148
curr_Factors:  [94.17306539 -1.24710964 -0.92192487]
mat_Sqrt:  [[10.76284252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00677909  0.07209088 -0.06976908]
Stock Position:  0.006779090067216068
Bond Position:  [3.90510041]


portfolio before change:  [4.54445448]
curr_Stock_Price:  94.16863714835779
curr_Factors:  [94.16863715 -0.95824687 -0.91879254]
mat_Sqrt:  [[14.4118067   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00415305  0.01518654 -0.03631845]
Stock Position:  0.004153046463616019
Bond Position:  [4.15336775]


portfolio before change:  [4.54561126]
curr_Stock_Price:  94.19712393426943
curr_Factors:  [94.19712393 -1.06857222 -0.94154281]
mat_Sqrt:  [[12.61989607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01659442 -0.01120985  0.47814758]
Stock Position:  0.016594424702843155
Bond Position:  [2.98246418]


portfolio before change:  [4.5444676]
curr_Stock_Price:  94.08326825753414
curr_Factors:  [94.08326826 -1.09392529 -0.91175886]
mat_Sqrt:  [[12.66061597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00509843  0.03614678  0.30676255]
Stock Position:  -0.0050984319442455425
Bond Position:  [5.02414474]


portfolio before change:  [4.54524732]
curr_Stock_Price:  94.17672205427297
curr_Factors:  [94.17672205 -1.20117402 -0.86755959]
mat_Sqrt:  [[11.89882228  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00390399  0.02772433 -0.61803177]
Stock Position:  0.003903990703696073
Bond Position:  [4.17758227]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.5460462]
Stock Price:  94.11379876589385
PL:  [4.5460462]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 2.61561688e-02 -3.08174654e-02  2.57343296e-02]
 [ 3.23294150e-03  1.02621614e-01 -1.02176236e-01]
 [-3.98189070e-03 -1.02659626e-01 -1.98718538e-01]
 [-3.42460838e-01 -3.52000254e-01  1.54659380e+00]
 [-4.31581877e-02 -1.31354479e-01 -4.71112503e-02]
 [-1.31038737e+00  1.48930173e+00 -2.36060401e-01]
 [-2.37469909e-02 -9.97532582e-02 -1.06326499e-02]
 [-3.83583809e-02 -1.50710033e-01  2.38829690e-01]
 [-1.07620276e-02 -5.24034916e-03  1.62127654e-02]
 [-1.35068423e+00  4.55991846e-01 -6.77943322e-01]
 [ 1.91190010e-01  7.54792018e-02 -6.03778652e-02]
 [-1.86227406e-01  4.31848021e-02  2.65015725e-01]
 [ 3.93024675e-01  1.91737185e-01 -1.34722709e-01]
 [ 3.17457709e-02  1.27799541e+00 -7.33374419e-01]
 [ 1.71735581e-01 -1.68432114e-01  1.99916879e-02]
 [ 1.27097118e-02 -3.90327379e-02 -1.57228740e-01]
 [-7.02223896e-02  1.76728038e-02  5.09373736e-02]
 [ 4.71065530e-02 -2.16607064e-01 -3.20001467e-02]
 [-1.21138408e-01 -9.96422145e-05 -8.21001307e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.56339632]
curr_Stock_Price:  101.54722871723618
curr_Factors:  [101.54722872  -0.58384523  -0.99982894]
mat_Sqrt:  [[20.83949181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120534 -0.00994629  0.07341288]
Stock Position:  0.0012053354432430747
Bond Position:  [14.44099785]


portfolio before change:  [14.56765605]
curr_Stock_Price:  102.08569069430249
curr_Factors:  [102.08569069  -0.75313104  -1.03483325]
mat_Sqrt:  [[17.07897676  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.94616688e-04  3.31209836e-02 -2.91480362e-01]
Stock Position:  0.00019461668773678147
Bond Position:  [14.54778847]


portfolio before change:  [14.57156967]
curr_Stock_Price:  103.5049795256956
curr_Factors:  [103.50497953  -0.79433956  -1.04341278]
mat_Sqrt:  [[16.47538385  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00397566 -0.03313325 -0.56688868]
Stock Position:  -0.0039756555293889405
Bond Position:  [14.98306981]


portfolio before change:  [14.56865551]
curr_Stock_Price:  105.18027394180793
curr_Factors:  [105.18027394  -0.8536935   -1.03945816]
mat_Sqrt:  [[15.8397739   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00622581 -0.11360759  4.41200162]
Stock Position:  -0.006225811865967975
Bond Position:  [15.22348811]


portfolio before change:  [14.57355665]
curr_Stock_Price:  105.00442630358219
curr_Factors:  [105.0044263   -0.63605696  -1.01325917]
mat_Sqrt:  [[20.17988625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00394389 -0.04239448 -0.13439528]
Stock Position:  -0.003943894982859564
Bond Position:  [14.98768308]


portfolio before change:  [14.57291794]
curr_Stock_Price:  106.11655141923542
curr_Factors:  [106.11655142  -0.84885646  -1.00502609]
mat_Sqrt:  [[16.62080924  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06344881  0.48067007 -0.67341462]
Stock Position:  -0.06344880924238903
Bond Position:  [21.30588676]


portfolio before change:  [14.59554925]
curr_Stock_Price:  105.84382485177144
curr_Factors:  [105.84382485  -0.95224006  -1.08807588]
mat_Sqrt:  [[13.75838851  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00336372 -0.03219523 -0.03033199]
Stock Position:  -0.0033637238798452577
Bond Position:  [14.95157865]


portfolio before change:  [14.60305561]
curr_Stock_Price:  104.72363730350536
curr_Factors:  [104.7236373   -0.93949169  -1.10135709]
mat_Sqrt:  [[13.6055265   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149726 -0.04864145  0.68131463]
Stock Position:  -0.0014972615054110973
Bond Position:  [14.75985428]


portfolio before change:  [14.60768495]
curr_Stock_Price:  104.09654791325511
curr_Factors:  [104.09654791  -0.84828979  -1.12205236]
mat_Sqrt:  [[14.51201119  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058726 -0.00169132  0.04625051]
Stock Position:  -0.0005872578550165335
Bond Position:  [14.66881647]


portfolio before change:  [14.60941808]
curr_Stock_Price:  107.3907291787864
curr_Factors:  [107.39072918  -0.65442106  -1.10732465]
mat_Sqrt:  [[18.44379768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07568885  0.14717074 -1.93398359]
Stock Position:  -0.07568885256568801
Bond Position:  [22.73769915]


portfolio before change:  [14.53104896]
curr_Stock_Price:  108.50125274616632
curr_Factors:  [108.50125275  -0.98018752  -1.15621567]
mat_Sqrt:  [[12.81169638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01516369  0.02436081 -0.17224124]
Stock Position:  0.015163687270190965
Bond Position:  [12.8857699]


portfolio before change:  [14.54568857]
curr_Stock_Price:  109.25422020133705
curr_Factors:  [109.2542202   -1.21159019  -1.15765926]
mat_Sqrt:  [[10.22083215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01206519  0.01393783  0.7560161 ]
Stock Position:  -0.012065185576436785
Bond Position:  [15.86386101]


portfolio before change:  [14.52655696]
curr_Stock_Price:  111.16865986297343
curr_Factors:  [111.16865986  -1.00221671  -1.19172013]
mat_Sqrt:  [[12.39275052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03265318  0.06188291 -0.38432639]
Stock Position:  0.03265317940995576
Bond Position:  [10.89654677]


portfolio before change:  [14.52062506]
curr_Stock_Price:  110.9035590262797
curr_Factors:  [110.90355903  -0.78285983  -1.22725923]
mat_Sqrt:  [[14.85805185  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00961876  0.41247124 -2.09211309]
Stock Position:  0.009618761991975089
Bond Position:  [13.45387012]


portfolio before change:  [14.53186028]
curr_Stock_Price:  111.72189095685899
curr_Factors:  [111.72189096  -0.636834    -1.23677796]
mat_Sqrt:  [[17.15690467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00824364 -0.05436123  0.05703072]
Stock Position:  0.008243637689208917
Bond Position:  [13.61086549]


portfolio before change:  [14.51578769]
curr_Stock_Price:  109.35937418417579
curr_Factors:  [109.35937418  -0.268426    -1.25128866]
mat_Sqrt:  [[23.92502087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00114324 -0.01259776 -0.44852983]
Stock Position:  -0.0011432380632718946
Bond Position:  [14.64081149]


portfolio before change:  [14.52044677]
curr_Stock_Price:  108.4860483844204
curr_Factors:  [108.48604838  -0.50847926  -1.26564914]
mat_Sqrt:  [[18.40262258  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305486  0.00570387  0.14531015]
Stock Position:  -0.0030548578353364673
Bond Position:  [14.85185623]


portfolio before change:  [14.52761876]
curr_Stock_Price:  107.35389690192882
curr_Factors:  [107.3538969   -0.19956486  -1.2732635 ]
mat_Sqrt:  [[24.61368203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00014789 -0.06990963 -0.09128751]
Stock Position:  -0.00014789259592518675
Bond Position:  [14.54349561]


portfolio before change:  [14.53149117]
curr_Stock_Price:  105.75760869953582
curr_Factors:  [105.7576087   -0.24798687  -1.24906184]
mat_Sqrt:  [[23.66745874  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.82729933e-03 -3.21593864e-05 -2.34208821e-01]
Stock Position:  -0.005827299328388507
Bond Position:  [15.14777241]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.51569952]
Stock Price:  109.11749559203714
PL:  [5.39820393]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.09532238e-01  1.92710558e-01 -9.69343261e-04]
 [ 3.33484130e-02  8.95042935e-02 -1.92283177e-01]
 [ 9.12684285e-02 -3.91851264e-02 -2.86235514e-02]
 [-1.65139901e-01 -1.34896921e-01  6.47488467e-01]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-1.10129310e+00  1.13511704e+00 -1.61595720e-01]
 [ 1.07456443e-02 -6.79329049e-03  3.15356164e-02]
 [-6.08705942e-02 -9.46584967e-02  1.27323146e-01]
 [ 5.11589398e-02 -1.63303679e-02 -5.31204911e-03]
 [-6.05662237e-01  3.00109850e-01 -3.02569605e-01]
 [ 4.11151955e-02  4.57816807e-02 -5.50795461e-02]
 [ 6.69212431e-02 -2.04349375e-02 -2.42154476e-02]
 [-6.36461107e-02 -6.21455947e-02  9.28597217e-02]
 [ 3.46090955e-04  1.14887856e-01 -1.04868675e-01]
 [-5.22711334e-02 -2.68685427e-01 -5.14854004e-02]
 [ 3.61245118e-02  5.34426916e-03 -6.31924896e-02]
 [ 7.61250463e-02  2.38358610e-02  1.20323230e-01]
 [-1.79972288e-02 -3.52776962e-02  2.73209057e-02]
 [ 1.21908380e-02 -6.59415775e-02 -1.45996351e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.38134206]
curr_Stock_Price:  98.90690034972272
curr_Factors:  [98.90690035 -0.82115404 -0.99617208]
mat_Sqrt:  [[16.06837232  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00438086  0.06219707 -0.00276527]
Stock Position:  -0.004380856092499676
Bond Position:  [-5.94804516]


portfolio before change:  [-6.3855506]
curr_Stock_Price:  99.52808964205185
curr_Factors:  [99.52808964 -0.85372402 -0.97634215]
mat_Sqrt:  [[15.96459956  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00077476  0.02888739 -0.54853038]
Stock Position:  0.0007747617575834562
Bond Position:  [-6.46266116]


portfolio before change:  [-6.38767722]
curr_Stock_Price:  98.868844663424
curr_Factors:  [98.86884466 -0.49194777 -0.96854644]
mat_Sqrt:  [[22.94958743  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00337379 -0.01264695 -0.08165502]
Stock Position:  0.003373787886747614
Bond Position:  [-6.72123973]


portfolio before change:  [-6.38150832]
curr_Stock_Price:  101.19543543855067
curr_Factors:  [101.19543544  -1.27015565  -0.9540786 ]
mat_Sqrt:  [[10.94430683  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00552868 -0.04353779  1.84710437]
Stock Position:  -0.005528681779718856
Bond Position:  [-5.82203096]


portfolio before change:  [-6.37542392]
curr_Stock_Price:  99.83162204445685
curr_Factors:  [99.83162204 -1.41132364 -0.92235662]
mat_Sqrt:  [[ 9.67751091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00586901 -0.04522423  0.24245377]
Stock Position:  0.005869007294303832
Bond Position:  [-6.96133644]


portfolio before change:  [-6.37166705]
curr_Stock_Price:  100.76830803048561
curr_Factors:  [100.76830803  -0.95417921  -0.98089714]
mat_Sqrt:  [[14.55227806  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06202286  0.36635745 -0.46098761]
Stock Position:  -0.0620228590687221
Bond Position:  [-0.12172849]


portfolio before change:  [-6.42754475]
curr_Stock_Price:  101.66873835757933
curr_Factors:  [101.66873836  -1.14993601  -0.99282373]
mat_Sqrt:  [[11.9288534   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0013242  -0.00219253  0.08996234]
Stock Position:  0.0013241968810850106
Bond Position:  [-6.56217418]


portfolio before change:  [-6.42678891]
curr_Stock_Price:  103.47858159959843
curr_Factors:  [103.4785816   -1.02108338  -1.01398521]
mat_Sqrt:  [[13.52170347  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00400859 -0.0305509   0.36321749]
Stock Position:  -0.004008588911827861
Bond Position:  [-6.01198582]


portfolio before change:  [-6.43270699]
curr_Stock_Price:  104.57994101368641
curr_Factors:  [104.57994101  -0.61674302  -1.07207948]
mat_Sqrt:  [[19.31977658  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00241934 -0.0052706  -0.0151538 ]
Stock Position:  0.002419344744292555
Bond Position:  [-6.68572193]


portfolio before change:  [-6.43798989]
curr_Stock_Price:  103.0872806183032
curr_Factors:  [103.08728062  -0.43262068  -1.04286226]
mat_Sqrt:  [[23.57278977  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02571458  0.09686004 -0.86314687]
Stock Position:  -0.025714577623215554
Bond Position:  [-3.78714401]


portfolio before change:  [-6.40455738]
curr_Stock_Price:  101.7503183652965
curr_Factors:  [101.75031837  -0.49926412  -1.03499092]
mat_Sqrt:  [[21.93902278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00178756  0.01477597 -0.15712661]
Stock Position:  0.001787558046007861
Bond Position:  [-6.58644198]


portfolio before change:  [-6.40621328]
curr_Stock_Price:  101.74523737872363
curr_Factors:  [101.74523738  -0.42096754  -1.0167106 ]
mat_Sqrt:  [[24.1623074   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00239245 -0.00659535 -0.06907993]
Stock Position:  0.0023924462373101267
Bond Position:  [-6.64963329]


portfolio before change:  [-6.41237807]
curr_Stock_Price:  99.86340988710883
curr_Factors:  [99.86340989 -0.291227   -1.04024673]
mat_Sqrt:  [[26.3727063   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217561 -0.0200574   0.26490294]
Stock Position:  -0.0021756059139449754
Bond Position:  [-6.19511464]


portfolio before change:  [-6.40755269]
curr_Stock_Price:  96.93349089208903
curr_Factors:  [96.93349089 -0.578092   -1.04161834]
mat_Sqrt:  [[19.18856925  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.24618345e-04  3.70798960e-02 -2.99161139e-01]
Stock Position:  0.00012461834469295582
Bond Position:  [-6.41963238]


portfolio before change:  [-6.40929999]
curr_Stock_Price:  95.79244125911761
curr_Factors:  [95.79244126 -0.60086464 -1.01343782]
mat_Sqrt:  [[19.06551725  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00616955 -0.08671785 -0.14687352]
Stock Position:  -0.00616955356775562
Bond Position:  [-5.81830339]


portfolio before change:  [-6.4163637]
curr_Stock_Price:  96.70157571587436
curr_Factors:  [96.70157572 -0.71701539 -1.05290461]
mat_Sqrt:  [[16.47278614  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147615  0.00172486 -0.18027058]
Stock Position:  0.0014761493937455678
Bond Position:  [-6.55910968]


portfolio before change:  [-6.41833456]
curr_Stock_Price:  96.47743165470861
curr_Factors:  [96.47743165 -0.92567152 -1.05653235]
mat_Sqrt:  [[13.29124091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00794143 0.00769299 0.34324868]
Stock Position:  0.007941425351769471
Bond Position:  [-7.18450288]


portfolio before change:  [-6.41254609]
curr_Stock_Price:  97.43252695881905
curr_Factors:  [97.43252696 -0.93091928 -1.07743474]
mat_Sqrt:  [[13.07636091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00150052 -0.01138583  0.07793894]
Stock Position:  -0.001500524651631849
Bond Position:  [-6.26634618]


portfolio before change:  [-6.41519362]
curr_Stock_Price:  98.1527714608591
curr_Factors:  [98.15277146 -0.60903156 -1.06588294]
mat_Sqrt:  [[18.38638894  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168988 -0.02128255 -0.41648695]
Stock Position:  -0.0016898810617199727
Bond Position:  [-6.24932711]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.41129654]
Stock Price:  94.92200939482412
PL:  [-6.41129654]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.20438258e-02 -3.70834851e-03  4.32447364e-02]
 [ 3.11344914e-02  1.11092839e-01 -1.52594106e-01]
 [-7.50675494e-02  3.01758954e-02 -6.51084342e-03]
 [-1.15102438e-01 -7.25884553e-02  3.69624792e-01]
 [ 1.81704388e-02 -6.64840807e-02  3.53930865e-02]
 [-1.12422068e+00  1.24614776e+00 -1.86117669e-01]
 [ 7.84848923e-03 -9.60938021e-03  2.17429141e-02]
 [-5.60216650e-02 -1.04279885e-01  1.46089699e-01]
 [-4.00216157e-02 -1.66853019e-02 -3.10707630e-04]
 [-8.67217412e-01  3.56224779e-01 -4.43942643e-01]
 [ 1.51259613e-01  5.23465548e-02 -5.62621904e-02]
 [-8.50421084e-02  1.25829639e-01  1.27799317e-01]
 [-1.42310318e-01 -1.31078600e-01  6.89850739e-03]
 [ 3.44818944e-02  6.93913600e-01 -4.12386833e-01]
 [ 1.22747613e-01 -6.05010089e-02 -2.76896446e-02]
 [ 5.62914950e-02  5.45509086e-02  9.70864190e-02]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.37680395e-02 -1.35155313e-01 -3.64772207e-02]
 [ 4.60798879e-03 -8.73616699e-02 -1.32618813e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.74976981]
curr_Stock_Price:  100.43616838024502
curr_Factors:  [100.43616838  -0.89727146  -1.04572456]
mat_Sqrt:  [[14.38989697  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027613 -0.00119686  0.1233652 ]
Stock Position:  -0.0002761308459763495
Bond Position:  [5.77750334]


portfolio before change:  [5.75128862]
curr_Stock_Price:  100.16728500362922
curr_Factors:  [100.167285    -1.11973837  -1.0344549 ]
mat_Sqrt:  [[11.61907758  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00195051  0.03585506 -0.43530851]
Stock Position:  0.001950506012359798
Bond Position:  [5.55591173]


portfolio before change:  [5.75241923]
curr_Stock_Price:  100.03473639190813
curr_Factors:  [100.03473639  -1.2712553   -1.04057682]
mat_Sqrt:  [[ 9.91139757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00708648  0.00973923 -0.01857362]
Stock Position:  -0.007086482038896184
Bond Position:  [6.46131359]


portfolio before change:  [5.75535048]
curr_Stock_Price:  99.84907040128161
curr_Factors:  [99.8490704  -1.36302064 -1.04070174]
mat_Sqrt:  [[ 9.02444836  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00603584 -0.02342782  1.05443665]
Stock Position:  -0.0060358425852266185
Bond Position:  [6.35802375]


portfolio before change:  [5.74637575]
curr_Stock_Price:  101.5993536040748
curr_Factors:  [101.5993536   -1.36330725  -1.0839055 ]
mat_Sqrt:  [[ 8.7918436   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00134488 -0.02145764  0.10096662]
Stock Position:  0.0013448847228829557
Bond Position:  [5.60973633]


portfolio before change:  [5.74975505]
curr_Stock_Price:  103.06913947288058
curr_Factors:  [103.06913947  -1.19157066  -1.10148031]
mat_Sqrt:  [[10.40565125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08724518  0.40219246 -0.53094191]
Stock Position:  -0.08724518312823415
Bond Position:  [14.742041]


portfolio before change:  [5.68438548]
curr_Stock_Price:  103.86065078883574
curr_Factors:  [103.86065079  -1.09779763  -1.14266685]
mat_Sqrt:  [[11.05171503  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00093427 -0.00310141  0.06202648]
Stock Position:  0.0009342655361001721
Bond Position:  [5.58735205]


portfolio before change:  [5.68636977]
curr_Stock_Price:  104.4892565530919
curr_Factors:  [104.48925655  -1.30090322  -1.15458296]
mat_Sqrt:  [[ 8.96742061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00529553 -0.03365619  0.41675325]
Stock Position:  -0.005295533081503514
Bond Position:  [6.23969609]


portfolio before change:  [5.68755318]
curr_Stock_Price:  104.56039388396391
curr_Factors:  [104.56039388  -1.18340857  -1.13527076]
mat_Sqrt:  [[10.28910438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00422689 -0.00538516 -0.00088636]
Stock Position:  -0.004226889923843652
Bond Position:  [6.12951846]


portfolio before change:  [5.69067194]
curr_Stock_Price:  104.1851331177909
curr_Factors:  [104.18513312  -1.16115611  -1.12913139]
mat_Sqrt:  [[10.5474269   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08391836  0.11497105 -1.26644479]
Stock Position:  -0.08391835798033571
Bond Position:  [14.43371724]


portfolio before change:  [5.64758705]
curr_Stock_Price:  104.74155217544886
curr_Factors:  [104.74155218  -0.95203854  -1.16262034]
mat_Sqrt:  [[12.63962887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01190386  0.01689478 -0.16050037]
Stock Position:  0.011903857211111335
Bond Position:  [4.40075856]


portfolio before change:  [5.64061032]
curr_Stock_Price:  104.06302817882282
curr_Factors:  [104.06302818  -1.12250798  -1.17240543]
mat_Sqrt:  [[10.48644371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031727   0.04061134  0.36457588]
Stock Position:  -0.003172697585475181
Bond Position:  [5.97077084]


portfolio before change:  [5.64614682]
curr_Stock_Price:  102.78852233710512
curr_Factors:  [102.78852234  -1.03971541  -1.2269178 ]
mat_Sqrt:  [[10.65511953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01573502 -0.04230544  0.01967952]
Stock Position:  -0.015735015758582185
Bond Position:  [7.26352584]


portfolio before change:  [5.63199753]
curr_Stock_Price:  103.80316382333923
curr_Factors:  [103.80316382  -1.12159078  -1.2362445 ]
mat_Sqrt:  [[ 9.82235762  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00936112  0.22395965 -1.17642485]
Stock Position:  0.009361123723676092
Bond Position:  [4.66028327]


portfolio before change:  [5.63385585]
curr_Stock_Price:  103.87720449751366
curr_Factors:  [103.8772045   -0.8952622   -1.23893449]
mat_Sqrt:  [[12.2927884   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00852091 -0.01952662 -0.07899085]
Stock Position:  0.008520912243935015
Bond Position:  [4.74872731]


portfolio before change:  [5.61862571]
curr_Stock_Price:  101.95047827358658
curr_Factors:  [101.95047827  -0.79867446  -1.21350798]
mat_Sqrt:  [[13.63042939  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0064007  0.01760623 0.27696053]
Stock Position:  0.006400703336769971
Bond Position:  [4.96607095]


portfolio before change:  [5.62238069]
curr_Stock_Price:  102.34313858235075
curr_Factors:  [102.34313858  -0.91111217  -1.24098538]
mat_Sqrt:  [[11.89637497  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00578242  0.00525786  0.16709793]
Stock Position:  -0.005782418266791292
Bond Position:  [6.21417152]


portfolio before change:  [5.62987935]
curr_Stock_Price:  101.31503472004624
curr_Factors:  [ 1.01315035e+02 -8.14156599e-02 -1.24106053e+00]
mat_Sqrt:  [[26.99788754  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0003235  -0.04362119 -0.10405936]
Stock Position:  0.00032349550195782603
Bond Position:  [5.5971044]


portfolio before change:  [5.63129167]
curr_Stock_Price:  101.35481348606844
curr_Factors:  [ 1.01354813e+02 -1.87479799e-02 -1.19713588e+00]
mat_Sqrt:  [[30.04641966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013411  -0.02819586 -0.37832456]
Stock Position:  -0.0013411028595530327
Bond Position:  [5.7672189]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.63302923]
Stock Price:  101.13442045699064
PL:  [4.49860877]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 3.81153204e-02 -1.30046010e-01  4.85123583e-02]
 [ 2.12584127e-02  1.41862040e-01 -1.80116435e-01]
 [-3.34208312e-02 -8.44678037e-02 -1.35451137e-01]
 [-2.47082743e-01 -2.40118482e-01  9.74029176e-01]
 [ 6.00090333e-05 -3.97479329e-02  1.73855627e-02]
 [-1.10610930e+00  1.20762705e+00 -1.75891016e-01]
 [ 9.70697307e-03 -3.61911514e-03  2.57319643e-02]
 [-7.39633743e-02 -6.52494236e-02  6.93043587e-02]
 [ 1.08469109e-01  2.92768787e-02  6.46339792e-02]
 [-4.31929361e-01  2.59440849e-01 -2.12524457e-01]
 [ 1.69951413e-02  3.91201712e-02 -5.30903037e-02]
 [-3.07343654e-02  1.53540913e-01 -7.67755912e-04]
 [ 3.94025710e-03 -5.33122133e-02 -3.39120980e-02]
 [ 1.83952084e-02  7.66042695e-01 -4.92516591e-01]
 [ 1.58819542e-01 -7.42495532e-02  6.09409349e-03]
 [ 1.68918682e-02 -3.21472836e-02 -1.02064354e-01]
 [-8.25668807e-02  1.62792129e-02  5.52701516e-02]
 [ 4.35337513e-02 -1.73597422e-01 -3.78710472e-02]
 [-1.57972707e-01  3.41604456e-02 -2.50583921e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.7893954]
curr_Stock_Price:  101.82784184346878
curr_Factors:  [101.82784184  -1.31990086  -0.93982082]
mat_Sqrt:  [[10.62874245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00202021 -0.04197217  0.13839225]
Stock Position:  0.0020202139088836635
Bond Position:  [16.58368138]


portfolio before change:  [16.79354604]
curr_Stock_Price:  101.82992250251127
curr_Factors:  [101.8299225   -1.4365023   -0.96443648]
mat_Sqrt:  [[ 9.22913396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00145732  0.04578578 -0.51382206]
Stock Position:  0.0014573162495408745
Bond Position:  [16.64514764]


portfolio before change:  [16.79850597]
curr_Stock_Price:  102.37759080540545
curr_Factors:  [102.37759081  -1.29794963  -0.95844306]
mat_Sqrt:  [[10.72175833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00730399 -0.02726187 -0.38640439]
Stock Position:  -0.007303988269314864
Bond Position:  [17.5462707]


portfolio before change:  [16.80494775]
curr_Stock_Price:  102.09628429005039
curr_Factors:  [102.09628429  -0.99629596  -0.95057188]
mat_Sqrt:  [[14.57122216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00667575 -0.07749791  2.77863412]
Stock Position:  -0.006675750927724433
Bond Position:  [17.48651711]


portfolio before change:  [16.80827646]
curr_Stock_Price:  102.25259041135713
curr_Factors:  [102.25259041  -0.7681546   -0.95547522]
mat_Sqrt:  [[18.24363597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024692 -0.01282859  0.04959617]
Stock Position:  -0.0002469184695709143
Bond Position:  [16.83352452]


portfolio before change:  [16.81228581]
curr_Stock_Price:  103.06080175088178
curr_Factors:  [103.06080175  -0.83204086  -0.95150653]
mat_Sqrt:  [[17.31843834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0517083   0.38975996 -0.50176811]
Stock Position:  -0.0517083032549985
Bond Position:  [22.141385]


portfolio before change:  [16.82563165]
curr_Stock_Price:  102.90976607241727
curr_Factors:  [102.90976607  -0.73824337  -0.9360442 ]
mat_Sqrt:  [[19.28957854  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00073722 -0.00116806  0.07340613]
Stock Position:  0.0007372239612299008
Bond Position:  [16.7497641]


portfolio before change:  [16.82902522]
curr_Stock_Price:  101.83221778947801
curr_Factors:  [101.83221779  -0.59348597  -0.95604481]
mat_Sqrt:  [[21.6238259   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00338218 -0.02105916  0.19770604]
Stock Position:  -0.0033821796614997473
Bond Position:  [17.17344007]


portfolio before change:  [16.83488167]
curr_Stock_Price:  101.37022051692642
curr_Factors:  [101.37022052  -0.38161346  -0.9706036 ]
mat_Sqrt:  [[26.22104437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00486779 0.00944907 0.18438275]
Stock Position:  0.004867791732810604
Bond Position:  [16.34143255]


portfolio before change:  [16.84325247]
curr_Stock_Price:  102.25048292072208
curr_Factors:  [102.25048292  -0.57991624  -0.97558129]
mat_Sqrt:  [[21.58347526  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01956833  0.08373417 -0.60627312]
Stock Position:  -0.01956833122220453
Bond Position:  [18.84412379]


portfolio before change:  [16.87862654]
curr_Stock_Price:  100.68354067075514
curr_Factors:  [100.68354067  -0.65653683  -0.97972438]
mat_Sqrt:  [[19.60375503  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00072147  0.01262598 -0.15145186]
Stock Position:  0.0007214689180214087
Bond Position:  [16.80598649]


portfolio before change:  [16.88380949]
curr_Stock_Price:  102.04316416423663
curr_Factors:  [102.04316416  -0.85663111  -0.99717244]
mat_Sqrt:  [[15.98406602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.81733520e-05  4.95551166e-02 -2.19019391e-03]
Stock Position:  2.8173351951332037e-05
Bond Position:  [16.88093459]


portfolio before change:  [16.88803462]
curr_Stock_Price:  102.1983434123671
curr_Factors:  [102.19834341  -0.57921267  -1.00686923]
mat_Sqrt:  [[20.92267626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066265 -0.01720644 -0.09674178]
Stock Position:  -0.0006626461500091836
Bond Position:  [16.95575596]


portfolio before change:  [16.89097161]
curr_Stock_Price:  104.16391559469864
curr_Factors:  [104.16391559  -0.64942711  -1.0100849 ]
mat_Sqrt:  [[19.81528796  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00374602  0.24723922 -1.40501275]
Stock Position:  0.003746021285783059
Bond Position:  [16.50077136]


portfolio before change:  [16.90169101]
curr_Stock_Price:  105.92410115608814
curr_Factors:  [105.92410116  -0.9380199   -1.01930998]
mat_Sqrt:  [[14.96019395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0096862  -0.02396394  0.01738475]
Stock Position:  0.009686195782156359
Bond Position:  [15.87568943]


portfolio before change:  [16.90781448]
curr_Stock_Price:  106.14648435013598
curr_Factors:  [106.14648435  -0.86672745  -1.03803565]
mat_Sqrt:  [[15.80074295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066478 -0.01037549 -0.29116119]
Stock Position:  -0.0006647768118275153
Bond Position:  [16.9783782]


portfolio before change:  [16.91182711]
curr_Stock_Price:  106.49621909737314
curr_Factors:  [106.4962191   -0.75255114  -1.02745698]
mat_Sqrt:  [[17.95917914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00378424  0.00525409  0.15767036]
Stock Position:  -0.003784244665362714
Bond Position:  [17.31483485]


portfolio before change:  [16.91978208]
curr_Stock_Price:  105.53810978015449
curr_Factors:  [105.53810978  -0.65129848  -1.02957424]
mat_Sqrt:  [[19.6523986   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.87219293e-05 -5.60283269e-02 -1.08035556e-01]
Stock Position:  1.8721929292819256e-05
Bond Position:  [16.9178062]


portfolio before change:  [16.92399313]
curr_Stock_Price:  104.52700898469425
curr_Factors:  [104.52700898  -0.9208261   -1.02447537]
mat_Sqrt:  [[14.94152161  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01044838  0.01102524 -0.07148462]
Stock Position:  -0.010448384217837938
Bond Position:  [18.01613148]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.91832066]
Stock Price:  105.5010411900823
PL:  [11.41727947]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.66802624e-02  1.27851471e-03  4.30856318e-02]
 [ 2.95272632e-02  1.54090548e-01 -1.62459690e-01]
 [-6.54612806e-02 -5.01425361e-02 -6.69393841e-02]
 [-2.47477847e-01 -2.39089811e-01  9.74038262e-01]
 [-4.10828280e-02  2.09906022e-02 -2.35234952e-02]
 [-1.27041212e+00  1.32356021e+00 -1.95803043e-01]
 [ 1.09635828e-02 -7.45930966e-03  3.27533637e-02]
 [-9.26682520e-02 -1.84875404e-02 -2.37507107e-02]
 [ 5.48681314e-02  2.65172861e-02  6.08626941e-02]
 [-2.94627987e-01  2.28136726e-01 -1.40410815e-01]
 [ 1.18722167e-01  3.22368838e-02 -5.27003307e-02]
 [-6.75885144e-02  1.35011603e-01  8.61517276e-02]
 [-1.33196441e-01 -9.73714622e-02  5.93345847e-02]
 [ 2.41344433e-02  4.70441708e-01 -3.23175314e-01]
 [-4.86412985e-02 -2.70097972e-01 -6.28828336e-02]
 [ 5.96563253e-02  6.47515380e-02  1.10342857e-01]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.23916004e-02 -1.39311401e-01 -3.88439347e-02]
 [-5.49835191e-02 -1.65518601e-02 -6.54204551e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.95446002]
curr_Stock_Price:  100.58803362046989
curr_Factors:  [100.58803362  -1.13386942  -1.03907529]
mat_Sqrt:  [[11.45113197  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066583  0.00041264  0.12291131]
Stock Position:  -0.000665826653108641
Bond Position:  [7.02143421]


portfolio before change:  [6.95603002]
curr_Stock_Price:  100.8667522383093
curr_Factors:  [100.86675224  -1.24663811  -1.02989925]
mat_Sqrt:  [[10.35286195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00268708  0.04973251 -0.46345228]
Stock Position:  0.0026870752646686604
Bond Position:  [6.68499346]


portfolio before change:  [6.95994601]
curr_Stock_Price:  101.70205812089435
curr_Factors:  [101.70205812  -1.0437955   -1.06527895]
mat_Sqrt:  [[12.3415682   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00724061 -0.01618343 -0.19095943]
Stock Position:  -0.0072406136718997345
Bond Position:  [7.69633132]


portfolio before change:  [6.95893872]
curr_Stock_Price:  102.10694198672937
curr_Factors:  [102.10694199  -0.99179749  -1.03342801]
mat_Sqrt:  [[13.47444883  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00723274 -0.0771659   2.77866004]
Stock Position:  -0.007232735363701984
Bond Position:  [7.69745121]


portfolio before change:  [6.97061859]
curr_Stock_Price:  100.75817610392599
curr_Factors:  [100.7581761   -0.79662166  -1.08189801]
mat_Sqrt:  [[15.39747718  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270173  0.00677469 -0.06710598]
Stock Position:  -0.002701731728584139
Bond Position:  [7.24284015]


portfolio before change:  [6.9727912]
curr_Stock_Price:  100.62431116613985
curr_Factors:  [100.62431117  -0.93517912  -1.11376964]
mat_Sqrt:  [[12.96748576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08021676  0.42717722 -0.55857158]
Stock Position:  -0.08021675675252213
Bond Position:  [15.04454709]


portfolio before change:  [6.89041501]
curr_Stock_Price:  101.69812414603491
curr_Factors:  [101.69812415  -1.07580759  -1.13737951]
mat_Sqrt:  [[11.1208504   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00145013 -0.00240748  0.09343623]
Stock Position:  0.0014501328053932632
Bond Position:  [6.74293922]


portfolio before change:  [6.89121607]
curr_Stock_Price:  101.08791304312155
curr_Factors:  [101.08791304  -1.15437127  -1.13514436]
mat_Sqrt:  [[10.24177487  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0098899  -0.00596683 -0.06775417]
Stock Position:  -0.009889897028542552
Bond Position:  [7.89096512]


portfolio before change:  [6.8976586]
curr_Stock_Price:  100.63598215918059
curr_Factors:  [100.63598216  -1.21051268  -1.13481104]
mat_Sqrt:  [[ 9.64255532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00753996 0.00855842 0.17362433]
Stock Position:  0.00753996142782669
Bond Position:  [6.13886718]


portfolio before change:  [6.90205439]
curr_Stock_Price:  101.0154101830086
curr_Factors:  [101.01541018  -0.83553842  -1.15677084]
mat_Sqrt:  [[13.77649417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02008646  0.07363081 -0.40055297]
Stock Position:  -0.020086460824897293
Bond Position:  [8.93109647]


portfolio before change:  [6.91305807]
curr_Stock_Price:  100.5787661853043
curr_Factors:  [100.57876619  -1.23713     -1.14905246]
mat_Sqrt:  [[ 9.25125026  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01238158  0.01040441 -0.15033937]
Stock Position:  0.012381578681152675
Bond Position:  [5.66773416]


portfolio before change:  [6.91222264]
curr_Stock_Price:  100.39683895253832
curr_Factors:  [100.39683895  -1.10905746  -1.15790497]
mat_Sqrt:  [[10.40377056  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215727  0.04357481  0.2457669 ]
Stock Position:  -0.002157269663696655
Bond Position:  [7.12880569]


portfolio before change:  [6.91546052]
curr_Stock_Price:  99.72216184807502
curr_Factors:  [99.72216185 -0.77378928 -1.17984379]
mat_Sqrt:  [[14.13642597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00997145 -0.0314265   0.16926505]
Stock Position:  -0.009971451537051897
Bond Position:  [7.90983523]


portfolio before change:  [6.90447091]
curr_Stock_Price:  101.02260634525109
curr_Factors:  [101.02260635  -0.72982262  -1.15400615]
mat_Sqrt:  [[15.35614224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00352921  0.15183441 -0.92192922]
Stock Position:  0.0035292112544736995
Bond Position:  [6.54794079]


portfolio before change:  [6.90311379]
curr_Stock_Price:  100.17417144289588
curr_Factors:  [100.17417144  -0.59248755  -1.16749876]
mat_Sqrt:  [[17.23468767  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00676605 -0.08717375 -0.17938722]
Stock Position:  -0.006766047816754724
Bond Position:  [7.58089703]


portfolio before change:  [6.89920187]
curr_Stock_Price:  101.03248324173781
curr_Factors:  [101.03248324  -0.30849451  -1.1798169 ]
mat_Sqrt:  [[22.80844051  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00418254 0.02089847 0.31477746]
Stock Position:  0.004182544569775562
Bond Position:  [6.47662901]


portfolio before change:  [6.90534713]
curr_Stock_Price:  102.11457457049796
curr_Factors:  [102.11457457  -0.29872428  -1.17808995]
mat_Sqrt:  [[23.31929735  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00294991  0.00525786  0.16709793]
Stock Position:  -0.0029499094632626103
Bond Position:  [7.20657588]


portfolio before change:  [6.90784982]
curr_Stock_Price:  101.87700000566802
curr_Factors:  [101.87700001  -0.51444258  -1.14719791]
mat_Sqrt:  [[19.33903732  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00031159 -0.04496256 -0.11081093]
Stock Position:  0.00031158711394617026
Bond Position:  [6.87610626]


portfolio before change:  [6.90930234]
curr_Stock_Price:  101.02099766132729
curr_Factors:  [101.02099766  -0.51853921  -1.10504879]
mat_Sqrt:  [[19.92032167  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00360015 -0.00534209 -0.18662635]
Stock Position:  -0.0036001450717715617
Bond Position:  [7.27299259]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.91360908]
Stock Price:  100.32984070794907
PL:  [6.58376838]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 4.50438790e-02 -9.95133710e-02  4.41238982e-02]
 [ 2.87305237e-02  1.60005469e-01 -2.11327167e-01]
 [-2.07483684e-02 -9.22987647e-02 -1.62685602e-01]
 [-2.88772626e-01 -2.92932859e-01  1.12789414e+00]
 [ 1.30617786e-02 -6.77912254e-02  2.90878674e-02]
 [-1.24209917e+00  1.35748643e+00 -2.02721664e-01]
 [ 8.90234882e-03 -6.21258000e-03  2.40049186e-02]
 [-2.09383286e-04 -2.46017163e-01  4.28478851e-01]
 [ 1.76394576e-02 -1.20462898e-02  3.57336370e-03]
 [-7.68752631e-01  3.35966085e-01 -3.89737029e-01]
 [ 5.56272578e-02  5.80469837e-02 -5.65014917e-02]
 [-1.85339570e-01 -1.64829510e-01 -1.96836922e-02]
 [ 3.51545041e-01  1.89863159e-01 -1.34294559e-01]
 [ 2.03098502e-02  1.30818304e+00 -7.78179375e-01]
 [ 1.69494228e-01 -1.52088376e-01  1.75800033e-02]
 [ 1.31328971e-02 -3.83360106e-02 -1.51646750e-01]
 [-7.66450761e-02  1.69477357e-02  5.31916646e-02]
 [ 3.98385233e-02 -2.18937301e-01 -3.52529471e-02]
 [-2.07458416e-01 -3.47421759e-03 -5.38608540e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.88365841]
curr_Stock_Price:  101.96578644929598
curr_Factors:  [101.96578645  -1.12728822  -0.99287106]
mat_Sqrt:  [[12.23717     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00275697 -0.0321178   0.1258732 ]
Stock Position:  0.0027569732363099276
Bond Position:  [17.60254147]


portfolio before change:  [17.88642879]
curr_Stock_Price:  101.37426395650408
curr_Factors:  [101.37426396  -1.17483791  -0.98417329]
mat_Sqrt:  [[11.70256498  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00155987  0.05164154 -0.60285759]
Stock Position:  0.001559873918350685
Bond Position:  [17.72829772]


portfolio before change:  [17.89305025]
curr_Stock_Price:  102.77747706277374
curr_Factors:  [102.77747706  -1.17240575  -0.98345906]
mat_Sqrt:  [[11.90194015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00611638 -0.0297893  -0.46409674]
Stock Position:  -0.006116383831394961
Bond Position:  [18.52167675]


portfolio before change:  [17.89971771]
curr_Stock_Price:  102.44452585198427
curr_Factors:  [102.44452585  -0.8442371   -1.01473216]
mat_Sqrt:  [[15.96425533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00741261 -0.09454367  3.21756802]
Stock Position:  -0.007412614436964547
Bond Position:  [18.65909948]


portfolio before change:  [17.90094569]
curr_Stock_Price:  102.90824547676326
curr_Factors:  [102.90824548  -0.71783364  -1.0296847 ]
mat_Sqrt:  [[17.92720562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00028791 -0.02187952  0.08297959]
Stock Position:  0.0002879137331427762
Bond Position:  [17.87131699]


portfolio before change:  [17.90538696]
curr_Stock_Price:  102.81406593944695
curr_Factors:  [102.81406594  -0.81747281  -1.06557908]
mat_Sqrt:  [[15.64060289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06434431  0.43812686 -0.57830848]
Stock Position:  -0.0643443096788462
Bond Position:  [24.52088706]


portfolio before change:  [17.84489299]
curr_Stock_Price:  103.84951041704775
curr_Factors:  [103.84951042  -0.7777045   -1.04085012]
mat_Sqrt:  [[16.85063296  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074384 -0.0020051   0.06847935]
Stock Position:  0.0007438411816758829
Bond Position:  [17.76764545]


portfolio before change:  [17.85144901]
curr_Stock_Price:  106.69091565180946
curr_Factors:  [106.69091565  -0.85235526  -1.07837999]
mat_Sqrt:  [[15.47461233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0023933 -0.0794017  1.2223309]
Stock Position:  0.002393304088677939
Bond Position:  [17.59610521]


portfolio before change:  [17.85040303]
curr_Stock_Price:  104.41558480244638
curr_Factors:  [104.4155848   -0.76372685  -1.06586825]
mat_Sqrt:  [[16.75645984  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094948 -0.00388792  0.01019381]
Stock Position:  0.0009494803190968283
Bond Position:  [17.75126249]


portfolio before change:  [17.85436913]
curr_Stock_Price:  103.91819044909055
curr_Factors:  [103.91819045  -0.71736673  -1.05389825]
mat_Sqrt:  [[17.67831923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04410649  0.10843259 -1.11181126]
Stock Position:  -0.0441064882115421
Bond Position:  [22.43783557]


portfolio before change:  [17.86691741]
curr_Stock_Price:  103.76088676506195
curr_Factors:  [103.76088677  -0.48013706  -1.01607218]
mat_Sqrt:  [[23.24011439  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00240716  0.01873458 -0.16118303]
Stock Position:  0.0024071624193639693
Bond Position:  [17.6171481]


portfolio before change:  [17.88081158]
curr_Stock_Price:  107.7030104167084
curr_Factors:  [107.70301042  -0.44243517  -1.01181468]
mat_Sqrt:  [[25.15678604  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00886453 -0.0531985  -0.05615209]
Stock Position:  -0.008864533397812747
Bond Position:  [18.83554851]


portfolio before change:  [17.87303627]
curr_Stock_Price:  109.11140767800889
curr_Factors:  [109.11140768  -0.76649329  -1.03014536]
mat_Sqrt:  [[18.09672176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02005269  0.06127807 -0.383105  ]
Stock Position:  0.020052689049927103
Bond Position:  [15.68505914]


portfolio before change:  [17.90496966]
curr_Stock_Price:  110.50830972430161
curr_Factors:  [110.50830972  -0.55446408  -1.01113003]
mat_Sqrt:  [[23.09223943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00556448  0.42221426 -2.21992915]
Stock Position:  0.005564483949511059
Bond Position:  [17.29004795]


portfolio before change:  [17.91060129]
curr_Stock_Price:  110.74347503228795
curr_Factors:  [110.74347503  -0.76210194  -0.98739437]
mat_Sqrt:  [[19.25402604  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00737705 -0.04908631  0.05015086]
Stock Position:  0.007377045260474854
Bond Position:  [17.09364166]


portfolio before change:  [17.89633733]
curr_Stock_Price:  108.2305570715987
curr_Factors:  [108.23055707  -0.4901591   -0.99382789]
mat_Sqrt:  [[24.53932047  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00104515 -0.01237289 -0.43260597]
Stock Position:  -0.0010451459501003974
Bond Position:  [18.00945405]


portfolio before change:  [17.90058248]
curr_Stock_Price:  108.47719769311247
curr_Factors:  [108.47719769  -0.66861171  -0.9987298 ]
mat_Sqrt:  [[20.47487427  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304412  0.00546986  0.15174101]
Stock Position:  -0.003044117884617079
Bond Position:  [18.23079985]


portfolio before change:  [17.90331958]
curr_Stock_Price:  109.0754549880025
curr_Factors:  [109.07545499  -0.3091571   -1.04182551]
mat_Sqrt:  [[28.24897798  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042649 -0.07066171 -0.10056685]
Stock Position:  -0.0004264877748842533
Bond Position:  [17.94983893]


portfolio before change:  [17.90801877]
curr_Stock_Price:  108.58033078687288
curr_Factors:  [108.58033079  -0.57131518  -1.02161011]
mat_Sqrt:  [[22.0776323   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00992687 -0.0011213  -0.15365002]
Stock Position:  -0.009926874635144611
Bond Position:  [18.9858821]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.92195403]
Stock Price:  107.65474193359489
PL:  [10.2672121]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-7.68463170e-02  1.52940655e-01  1.33547531e-02]
 [ 2.46468788e-02  5.92725873e-02 -1.27014393e-01]
 [-4.53009458e-02  1.98376702e-02 -1.59957305e-02]
 [-2.61170213e-01 -2.62085234e-01  9.06085521e-01]
 [ 1.51847250e-02 -6.20763176e-02  3.24243380e-02]
 [-1.29475427e+00  1.43372840e+00 -2.19171922e-01]
 [ 9.73132822e-03 -3.69354438e-03  2.58680505e-02]
 [-8.08503159e-02 -4.98157848e-02  3.88626370e-02]
 [-4.98160406e-04  2.09405422e-02  5.77322189e-02]
 [-7.92353684e-01  3.39039470e-01 -4.04755224e-01]
 [ 1.47053432e-01  4.99098122e-02 -5.58286542e-02]
 [-8.87808845e-02  1.23862748e-01  1.36720747e-01]
 [ 1.59184513e-02 -9.77703404e-02 -6.46037040e-02]
 [ 3.41225634e-02  8.76368147e-01 -5.10424045e-01]
 [ 1.60399746e-01 -8.57722495e-02  7.79438449e-03]
 [ 1.50419880e-02 -3.51929052e-02 -1.26465045e-01]
 [-8.18488538e-02  1.63602722e-02  5.50181322e-02]
 [ 4.73346807e-02 -1.65054505e-01 -3.68785501e-02]
 [-1.58394691e-01  3.38395201e-02 -2.53040020e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.36773826]
curr_Stock_Price:  99.28680023022844
curr_Factors:  [99.28680023 -1.00927083 -0.9896383 ]
mat_Sqrt:  [[13.45167337  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031893   0.04936138  0.03809739]
Stock Position:  -0.003189299043925999
Bond Position:  [-3.05108296]


portfolio before change:  [-3.3684845]
curr_Stock_Price:  99.28158845525552
curr_Factors:  [99.28158846 -0.85089498 -1.03706903]
mat_Sqrt:  [[15.02921733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071987  0.01913015 -0.36233671]
Stock Position:  0.0007198738547054246
Bond Position:  [-3.43995472]


portfolio before change:  [-3.36891638]
curr_Stock_Price:  99.87644674174342
curr_Factors:  [99.87644674 -0.6656205  -1.04528982]
mat_Sqrt:  [[18.04779608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0024666   0.00640258 -0.04563137]
Stock Position:  -0.0024666010734576524
Bond Position:  [-3.12256102]


portfolio before change:  [-3.37242072]
curr_Stock_Price:  100.98063987428023
curr_Factors:  [100.98063987  -0.83248193  -1.04215354]
mat_Sqrt:  [[15.49152887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00837323 -0.08458765  2.58480979]
Stock Position:  -0.008373234569306357
Bond Position:  [-2.52688613]


portfolio before change:  [-3.38748731]
curr_Stock_Price:  102.70456006769246
curr_Factors:  [102.70456007  -0.98987015  -1.04722521]
mat_Sqrt:  [[13.39338804  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00068183 -0.02003505  0.09249761]
Stock Position:  0.000681831960058077
Bond Position:  [-3.45751456]


portfolio before change:  [-3.38765047]
curr_Stock_Price:  103.73315015986563
curr_Factors:  [103.73315016  -0.83097051  -1.07901778]
mat_Sqrt:  [[15.36102487  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06814871  0.46273385 -0.62523649]
Stock Position:  -0.06814870609022193
Bond Position:  [3.68162949]


portfolio before change:  [-3.32390461]
curr_Stock_Price:  102.8112642749527
curr_Factors:  [102.81126427  -0.75350463  -1.09460943]
mat_Sqrt:  [[16.19626831  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00088031 -0.00119209  0.07379435]
Stock Position:  0.0008803065028676065
Bond Position:  [-3.41441004]


portfolio before change:  [-3.32605818]
curr_Stock_Price:  101.33466547866787
curr_Factors:  [101.33466548  -0.54587621  -1.07093376]
mat_Sqrt:  [[20.11807347  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00412992 -0.01607798  0.11086429]
Stock Position:  -0.004129924169139594
Bond Position:  [-2.9075537]


portfolio before change:  [-3.32893581]
curr_Stock_Price:  101.8554129576059
curr_Factors:  [101.85541296  -1.06565232  -1.06499505]
mat_Sqrt:  [[12.09638823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0012864  0.00675853 0.16469395]
Stock Position:  0.0012864046201040505
Bond Position:  [-3.45996308]


portfolio before change:  [-3.32720515]
curr_Stock_Price:  103.87325190597468
curr_Factors:  [103.87325191  -1.15275374  -1.08660082]
mat_Sqrt:  [[11.06533074  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07281914  0.10942452 -1.15465399]
Stock Position:  -0.07281913887143106
Bond Position:  [4.2367556]


portfolio before change:  [-3.37328146]
curr_Stock_Price:  104.52054913707268
curr_Factors:  [104.52054914  -1.19282375  -1.09666979]
mat_Sqrt:  [[10.58978808  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01377225  0.01610832 -0.15926361]
Stock Position:  0.013772254228158346
Bond Position:  [-4.81276503]


portfolio before change:  [-3.36476052]
curr_Stock_Price:  105.22662650027954
curr_Factors:  [105.2266265   -1.07090082  -1.12256235]
mat_Sqrt:  [[11.73590791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303253  0.03997653  0.39002623]
Stock Position:  -0.003032530728793823
Bond Position:  [-3.04565754]


portfolio before change:  [-3.36343899]
curr_Stock_Price:  104.53972685499234
curr_Factors:  [104.53972685  -1.32387725  -1.15766674]
mat_Sqrt:  [[ 8.74098745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00197072 -0.03155524 -0.18429639]
Stock Position:  -0.0019707169019534568
Bond Position:  [-3.15742078]


portfolio before change:  [-3.36628018]
curr_Stock_Price:  105.58083852497614
curr_Factors:  [105.58083852  -1.14311358  -1.17732854]
mat_Sqrt:  [[10.37122125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01049255  0.2828466  -1.45609773]
Stock Position:  0.010492553164466043
Bond Position:  [-4.47409274]


portfolio before change:  [-3.35555725]
curr_Stock_Price:  106.70940924081151
curr_Factors:  [106.70940924  -0.77137418  -1.1771544 ]
mat_Sqrt:  [[15.20433768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00950272 -0.02768287  0.02223521]
Stock Position:  0.009502721112138096
Bond Position:  [-4.36958701]


portfolio before change:  [-3.35310861]
curr_Stock_Price:  107.08205807921932
curr_Factors:  [107.08205808  -0.83287306  -1.1570267 ]
mat_Sqrt:  [[14.63909485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012266  -0.01135846 -0.36076957]
Stock Position:  -0.0012265992580082622
Bond Position:  [-3.22176183]


portfolio before change:  [-3.3520172]
curr_Stock_Price:  105.53554754154771
curr_Factors:  [105.53554754  -0.54359079  -1.14673787]
mat_Sqrt:  [[19.46697002  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00345605  0.00528026  0.15695142]
Stock Position:  -0.0034560487806269387
Bond Position:  [-2.9872812]


portfolio before change:  [-3.34762558]
curr_Stock_Price:  104.04872291404415
curr_Factors:  [104.04872291  -0.68109869  -1.13645647]
mat_Sqrt:  [[16.89983943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00036185 -0.05327111 -0.10520424]
Stock Position:  0.00036185363766074114
Bond Position:  [-3.38527598]


portfolio before change:  [-3.34809756]
curr_Stock_Price:  105.08350200186656
curr_Factors:  [105.083502    -0.47334949  -1.13243605]
mat_Sqrt:  [[21.09360147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00742654  0.01092166 -0.07218527]
Stock Position:  -0.007426535785069871
Bond Position:  [-2.56769117]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.35162488]
Stock Price:  105.47201689315044
PL:  [-8.82364178]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.04346823e-01  1.86401314e-01  1.30308409e-03]
 [ 4.00078899e-02  1.79027606e-01 -2.69115905e-01]
 [ 6.12604246e-02 -4.86222356e-02 -3.21284364e-02]
 [-1.06124311e-01 -6.71844205e-02  2.81605795e-01]
 [ 4.85993440e-02 -1.40828354e-01  6.15740570e-02]
 [-1.38004661e+00  1.13579807e+00 -1.29075246e-01]
 [-5.69027143e-01 -6.37899140e-01 -2.07818391e-01]
 [ 1.85602802e-01 -2.45912691e-01  7.32489999e-02]
 [-9.73587747e-03  2.77381551e-02  4.82257438e-02]
 [ 1.47335312e-01  1.47169257e-01  1.01269648e-01]
 [-6.93395170e-02 -6.05324103e-02 -2.10581407e-02]
 [ 1.02469072e-01 -3.49189222e-02 -3.58131966e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-1.12243486e-01 -2.07241433e-02 -9.10605999e-02]
 [ 6.38409139e-02  2.61981129e-01  4.49848137e-02]
 [ 6.33849243e-02  1.31370502e-01 -1.86706945e-01]
 [ 3.17087516e-01 -3.77172039e-01  2.35919921e-01]
 [-2.47409158e-01  1.63413898e-01  3.71794809e-01]
 [ 3.26702172e-01 -2.68078527e-01 -5.95900540e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.51611048]
curr_Stock_Price:  98.88991121971374
curr_Factors:  [98.88991122 -0.94759599 -0.98805739]
mat_Sqrt:  [[14.27277448  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00462642  0.06016077  0.00371734]
Stock Position:  -0.004626418202771336
Bond Position:  [-6.0586044]


portfolio before change:  [-6.52541665]
curr_Stock_Price:  100.57400603790556
curr_Factors:  [100.57400604  -0.81758662  -0.96895907]
mat_Sqrt:  [[16.84995768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00128301  0.05778091 -0.76771277]
Stock Position:  0.001283011702080031
Bond Position:  [-6.65445428]


portfolio before change:  [-6.52874226]
curr_Stock_Price:  99.27878172223302
curr_Factors:  [99.27878172 -0.82313234 -0.98170525]
mat_Sqrt:  [[16.33147575  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00274178 -0.01569276 -0.09165349]
Stock Position:  0.002741776881824098
Bond Position:  [-6.80094253]


portfolio before change:  [-6.53584863]
curr_Stock_Price:  97.3070968403869
curr_Factors:  [97.30709684 -0.59000103 -0.99660346]
mat_Sqrt:  [[19.91090224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00313174 -0.02168368  0.80334295]
Stock Position:  -0.0031317380801342957
Bond Position:  [-6.23110829]


portfolio before change:  [-6.52871851]
curr_Stock_Price:  94.53289122204491
curr_Factors:  [94.53289122 -0.27106161 -0.96842178]
mat_Sqrt:  [[27.37046305  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00118455 -0.04545216  0.17565365]
Stock Position:  0.0011845480408722634
Bond Position:  [-6.64069726]


portfolio before change:  [-6.53412415]
curr_Stock_Price:  91.37113160772944
curr_Factors:  [91.37113161 -0.29745934 -0.89926192]
mat_Sqrt:  [[27.61083647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04253946  0.36657725 -0.36821575]
Stock Position:  -0.04253946353103045
Bond Position:  [-2.64724523]


portfolio before change:  [-6.52243377]
curr_Stock_Price:  91.08075941579244
curr_Factors:  [91.08075942 -0.27036126 -0.86658749]
mat_Sqrt:  [[29.21837622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02538329 -0.20588106 -0.59284802]
Stock Position:  -0.02538328981589775
Bond Position:  [-4.21050445]


portfolio before change:  [-6.56784132]
curr_Stock_Price:  92.82816091133674
curr_Factors:  [92.82816091 -0.19395819 -0.82804576]
mat_Sqrt:  [[33.4063535   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00450088 -0.07936798  0.20895901]
Stock Position:  0.004500879556897272
Bond Position:  [-6.9856497]


portfolio before change:  [-6.56201122]
curr_Stock_Price:  94.51155043005741
curr_Factors:  [94.51155043 -0.43172986 -0.80585963]
mat_Sqrt:  [[27.41615835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00021047 0.00895245 0.13757462]
Stock Position:  0.0002104667032824631
Bond Position:  [-6.58190276]


portfolio before change:  [-6.56401786]
curr_Stock_Price:  92.7965296123675
curr_Factors:  [92.79652961 -0.09621998 -0.87256694]
mat_Sqrt:  [[35.22028956  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00562311 0.04749867 0.28889412]
Stock Position:  0.005623113644333743
Bond Position:  [-7.08582329]


portfolio before change:  [-6.55083526]
curr_Stock_Price:  95.45595898887821
curr_Factors:  [95.45595899 -0.2887259  -0.85107665]
mat_Sqrt:  [[30.53466019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281628 -0.01953675 -0.06007301]
Stock Position:  -0.0028162788744171595
Bond Position:  [-6.28200466]


portfolio before change:  [-6.54887599]
curr_Stock_Price:  94.20254184011101
curr_Factors:  [94.20254184 -0.40950018 -0.86085876]
mat_Sqrt:  [[26.44555851  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00332876 -0.01127003 -0.10216508]
Stock Position:  0.0033287607959067446
Bond Position:  [-6.86245371]


portfolio before change:  [-6.55890503]
curr_Stock_Price:  91.70515044895913
curr_Factors:  [91.70515045 -0.32989548 -0.83599954]
mat_Sqrt:  [[28.57932422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00058998 -0.00995959  0.34984664]
Stock Position:  0.0005899762807737807
Bond Position:  [-6.6130089]


portfolio before change:  [-6.56187752]
curr_Stock_Price:  89.46942342685557
curr_Factors:  [89.46942343 -0.2691512  -0.82669249]
mat_Sqrt:  [[29.90582397  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00451623 -0.00668869 -0.25977055]
Stock Position:  -0.0045162257024978945
Bond Position:  [-6.15781341]


portfolio before change:  [-6.56953974]
curr_Stock_Price:  90.82510726497202
curr_Factors:  [90.82510726 -0.59812782 -0.80485282]
mat_Sqrt:  [[22.33053712  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00566489 0.08455405 0.12832915]
Stock Position:  0.005664891710900187
Bond Position:  [-7.08405413]


portfolio before change:  [-6.57661129]
curr_Stock_Price:  89.88946458773336
curr_Factors:  [89.88946459 -0.1362472  -0.80898637]
mat_Sqrt:  [[34.93003904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00149125  0.04239965 -0.53262294]
Stock Position:  0.0014912499851456411
Bond Position:  [-6.71065895]


portfolio before change:  [-6.58338281]
curr_Stock_Price:  86.47377442352186
curr_Factors:  [86.47377442 -0.44229499 -0.7884494 ]
mat_Sqrt:  [[25.25683445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01141293 -0.12173175  0.67301387]
Stock Position:  0.011412932537181335
Bond Position:  [-7.57030216]


portfolio before change:  [-6.58506781]
curr_Stock_Price:  86.49198297219296
curr_Factors:  [86.49198297 -0.26200342 -0.7774321 ]
mat_Sqrt:  [[30.58825787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00451677  0.05274161  1.0606271 ]
Stock Position:  -0.004516770407247349
Bond Position:  [-6.19440338]


portfolio before change:  [-6.59300114]
curr_Stock_Price:  87.90550124524063
curr_Factors:  [87.90550125 -0.47000523 -0.79121473]
mat_Sqrt:  [[24.90434849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00603682 -0.08652197 -1.69993838]
Stock Position:  0.0060368245812491735
Bond Position:  [-7.12367123]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.61835721]
Stock Price:  84.00031475536872
PL:  [-6.61835721]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.00840719e-01  1.82135336e-01  2.83957970e-03]
 [-3.71201470e-02 -1.66464708e-01  3.49823193e-01]
 [ 1.52452931e-01  5.84434597e-03  1.44245440e-01]
 [ 2.54043866e-02  3.63403023e-02 -6.21791633e-02]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-1.38745392e+00  1.24901656e+00 -1.61682386e-01]
 [-3.25361716e-01 -3.05906666e-01 -1.74498160e-01]
 [ 1.53599542e-01 -1.87568612e-01  4.60241333e-02]
 [-2.12812150e-02  2.79295496e-02  4.94948046e-02]
 [ 1.47828446e-01  1.48413182e-01  1.03559085e-01]
 [-1.73639879e-01 -1.53059222e-01  1.86859319e-02]
 [ 1.13306482e-01 -3.24138974e-02 -3.31820448e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-1.03495290e-01 -2.81221154e-02 -7.65973050e-02]
 [ 7.06224576e-02  2.60069875e-01  7.95015182e-02]
 [ 6.03935390e-02  1.95047645e-01 -3.43488541e-01]
 [ 3.17414927e-01 -4.06807313e-01  2.39830436e-01]
 [-2.59034561e-01  1.65955345e-01  3.92925656e-01]
 [ 4.08263610e-01 -4.44868299e-01 -7.47485944e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.12384164]
curr_Stock_Price:  98.93936127830973
curr_Factors:  [98.93936128 -0.95602651 -0.98997552]
mat_Sqrt:  [[14.13289576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00446355  0.05878393  0.00810053]
Stock Position:  -0.004463548996517126
Bond Position:  [-5.68222096]


portfolio before change:  [-6.11777361]
curr_Stock_Price:  97.26159980645816
curr_Factors:  [97.26159981 -1.04542254 -0.99806866]
mat_Sqrt:  [[12.60272489  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.44190812e-05 -5.37262534e-02  9.97948196e-01]
Stock Position:  2.4419081238444063e-05
Bond Position:  [-6.12014864]


portfolio before change:  [-6.11931133]
curr_Stock_Price:  96.9545731362952
curr_Factors:  [96.95457314 -0.78094846 -1.06243523]
mat_Sqrt:  [[15.34606148  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01193074 0.00188625 0.41149209]
Stock Position:  0.01193074067097978
Bond Position:  [-7.2760512]


portfolio before change:  [-6.13420683]
curr_Stock_Price:  95.8585593971892
curr_Factors:  [95.8585594  -0.68636063 -1.05045728]
mat_Sqrt:  [[16.87875709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00119263  0.01172878 -0.17737985]
Stock Position:  0.0011926263939460492
Bond Position:  [-6.24853028]


portfolio before change:  [-6.1363574]
curr_Stock_Price:  95.36532628592447
curr_Factors:  [95.36532629 -0.58951744 -1.02845917]
mat_Sqrt:  [[18.91089934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00300342 -0.04522423  0.24245377]
Stock Position:  0.0030034204661328772
Bond Position:  [-6.42277957]


portfolio before change:  [-6.14076195]
curr_Stock_Price:  94.43350405281613
curr_Factors:  [94.43350405 -0.52595778 -1.00676757]
mat_Sqrt:  [[20.39256921  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05715331  0.40311836 -0.46123484]
Stock Position:  -0.05715330658176655
Bond Position:  [-0.74357494]


portfolio before change:  [-6.0999721]
curr_Stock_Price:  93.71655920878995
curr_Factors:  [93.71655921 -0.23841048 -0.98465777]
mat_Sqrt:  [[27.58319334  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01535079 -0.09873095 -0.49779468]
Stock Position:  -0.01535079476972272
Bond Position:  [-4.66134843]


portfolio before change:  [-6.10137291]
curr_Stock_Price:  93.73188956454057
curr_Factors:  [93.73188956 -0.29943392 -0.97693201]
mat_Sqrt:  [[26.15584129  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00476784 -0.06053751  0.13129404]
Stock Position:  0.004767841143720009
Bond Position:  [-6.54827167]


portfolio before change:  [-6.10329046]
curr_Stock_Price:  93.67310580341731
curr_Factors:  [93.6731058  -0.37869698 -0.98733729]
mat_Sqrt:  [[23.89757191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00022919  0.00901422  0.1411949 ]
Stock Position:  -0.00022918792399642478
Bond Position:  [-6.08182171]


portfolio before change:  [-6.10470467]
curr_Stock_Price:  93.20872112877267
curr_Factors:  [93.20872113 -0.24008855 -1.03559826]
mat_Sqrt:  [[26.0275211   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00765582 0.04790015 0.29542524]
Stock Position:  0.00765582204226894
Bond Position:  [-6.81829405]


portfolio before change:  [-6.10437897]
curr_Stock_Price:  93.47394255011923
curr_Factors:  [93.47394255 -0.27960895 -1.03521407]
mat_Sqrt:  [[25.09979521  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00801077 -0.04939965  0.05330576]
Stock Position:  -0.008010771002319542
Bond Position:  [-5.35558062]


portfolio before change:  [-6.12745993]
curr_Stock_Price:  96.18802524977471
curr_Factors:  [ 9.61880252e+01 -3.62668142e-02 -1.03195897e+00]
mat_Sqrt:  [[33.05190106  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00302303 -0.01046154 -0.09465914]
Stock Position:  0.00302302632025294
Bond Position:  [-6.41823886]


portfolio before change:  [-6.13039685]
curr_Stock_Price:  95.74735156066058
curr_Factors:  [95.74735156 -0.09639284 -1.03670398]
mat_Sqrt:  [[30.83394361  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00054684 -0.00995959  0.34984664]
Stock Position:  0.0005468364222694053
Bond Position:  [-6.18275499]


portfolio before change:  [-6.13517697]
curr_Stock_Price:  89.83290711459023
curr_Factors:  [89.83290711 -0.18554237 -1.03624587]
mat_Sqrt:  [[26.47399993  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00471674 -0.00907637 -0.21851079]
Stock Position:  -0.004716742929266368
Bond Position:  [-5.71145824]


portfolio before change:  [-6.13170549]
curr_Stock_Price:  88.79415597969191
curr_Factors:  [88.79415598 -0.10431326 -1.02956528]
mat_Sqrt:  [[28.57243087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00489763 0.08393719 0.2267957 ]
Stock Position:  0.004897629420545411
Bond Position:  [-6.56658636]


portfolio before change:  [-6.14233846]
curr_Stock_Price:  86.95834500906811
curr_Factors:  [86.95834501 -0.10455474 -0.99541463]
mat_Sqrt:  [[28.94680516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0010396   0.06295136 -0.9798772 ]
Stock Position:  0.0010396023967540217
Bond Position:  [-6.23274057]


portfolio before change:  [-6.14531956]
curr_Stock_Price:  85.58982571159544
curr_Factors:  [ 8.55898257e+01 -7.02475405e-02 -1.03625433e+00]
mat_Sqrt:  [[28.30573826  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01000966 -0.1312965   0.68416948]
Stock Position:  0.010009663470854599
Bond Position:  [-7.00204491]


portfolio before change:  [-6.14503805]
curr_Stock_Price:  85.79285382369508
curr_Factors:  [85.79285382 -0.20364377 -1.04716177]
mat_Sqrt:  [[24.56027185  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00590195  0.05356186  1.12090753]
Stock Position:  -0.005901948287922356
Bond Position:  [-5.63869306]


portfolio before change:  [-6.14718033]
curr_Stock_Price:  85.91695429892417
curr_Factors:  [85.9169543  -0.22128373 -1.04038778]
mat_Sqrt:  [[24.32998804  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00677663 -0.14358063 -2.13236934]
Stock Position:  0.006776629700711836
Bond Position:  [-6.72940772]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.14141486]
Stock Price:  87.01603014456859
PL:  [-6.14141486]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-9.49352676e-02  1.74950003e-01  5.42755197e-03]
 [ 3.21204451e-02  1.69673106e-01 -2.24646618e-01]
 [-8.11922672e-02  2.39017035e-02 -2.08616263e-02]
 [-3.44420445e-01 -3.67426083e-01  1.29811634e+00]
 [ 1.42966908e-03 -4.17699409e-02  1.87474401e-02]
 [-1.28074871e+00  1.42054556e+00 -2.17259898e-01]
 [ 9.70697307e-03 -3.61911514e-03  2.57319643e-02]
 [-6.99293467e-02 -7.33875960e-02  8.52034821e-02]
 [-8.74160313e-03 -3.52571561e-03  1.88518410e-02]
 [-2.89781239e-01  2.27274941e-01 -1.37588754e-01]
 [ 1.48650347e-01  5.16368463e-02 -5.61257520e-02]
 [-3.05124853e-02  1.03204286e-01  1.19098889e-02]
 [ 1.61961874e-01  1.33631939e-02 -9.53452541e-02]
 [ 2.30528744e-02  8.66790458e-01 -5.34066175e-01]
 [ 1.57749374e-01 -6.64459841e-02  4.94259754e-03]
 [ 1.44583817e-02 -3.61537479e-02 -1.34163055e-01]
 [-8.59027769e-02  1.59026178e-02  5.64410138e-02]
 [ 4.27492519e-02 -1.54934345e-01 -4.00520881e-02]
 [-1.27277232e-01  4.98236905e-02 -1.54169533e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.36325158]
curr_Stock_Price:  99.2873658280913
curr_Factors:  [99.28736583 -0.63855101 -1.01890917]
mat_Sqrt:  [[18.9264072   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00307062  0.05646487  0.0154833 ]
Stock Position:  -0.0030706225889393602
Bond Position:  [-3.05837755]


portfolio before change:  [-3.3689583]
curr_Stock_Price:  100.89682012918001
curr_Factors:  [100.89682013  -0.64205384  -1.00962026]
mat_Sqrt:  [[19.34481263  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00108034  0.05476176 -0.64085427]
Stock Position:  0.0010803425344425497
Bond Position:  [-3.47796142]


portfolio before change:  [-3.36918056]
curr_Stock_Price:  101.4960161014099
curr_Factors:  [101.4960161   -0.76969453  -0.99478326]
mat_Sqrt:  [[17.38385247  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00463486  0.00771424 -0.05951241]
Stock Position:  -0.004634859517421566
Bond Position:  [-2.89876078]


portfolio before change:  [-3.37459816]
curr_Stock_Price:  102.50852204426147
curr_Factors:  [102.50852204  -0.6113113   -0.97709858]
mat_Sqrt:  [[20.93737959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00737648 -0.11858626  3.7031646 ]
Stock Position:  -0.00737647662431078
Bond Position:  [-2.61844645]


portfolio before change:  [-3.3739654]
curr_Stock_Price:  102.33398668633502
curr_Factors:  [102.33398669  -0.67114017  -0.96795667]
mat_Sqrt:  [[19.86868749  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00016457 -0.01348119  0.05348123]
Stock Position:  -0.00016456946177953422
Bond Position:  [-3.35712435]


portfolio before change:  [-3.37517695]
curr_Stock_Price:  104.59544475980957
curr_Factors:  [104.59544476  -0.61776825  -0.95338379]
mat_Sqrt:  [[21.73552385  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04762384  0.45847911 -0.61978202]
Stock Position:  -0.047623837263182825
Bond Position:  [1.60605949]


portfolio before change:  [-3.32780962]
curr_Stock_Price:  103.6092626959215
curr_Factors:  [103.6092627   -0.74432843  -0.97530232]
mat_Sqrt:  [[18.55976336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00076621 -0.00116806  0.07340613]
Stock Position:  0.000766213405959223
Bond Position:  [-3.40719642]


portfolio before change:  [-3.32942598]
curr_Stock_Price:  102.611556408876
curr_Factors:  [102.61155641  -0.85228569  -0.99385963]
mat_Sqrt:  [[16.19666325  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0041686  -0.02368574  0.24306182]
Stock Position:  -0.004168601766926402
Bond Position:  [-2.90167926]


portfolio before change:  [-3.3362844]
curr_Stock_Price:  104.08277130300331
curr_Factors:  [104.0827713   -0.83440542  -0.98966065]
mat_Sqrt:  [[16.79565793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003342  -0.00113792  0.05377906]
Stock Position:  -0.0003342036913783448
Bond Position:  [-3.30149955]


portfolio before change:  [-3.33622134]
curr_Stock_Price:  101.42409635610105
curr_Factors:  [101.42409636  -0.66869872  -0.9932446 ]
mat_Sqrt:  [[19.24723434  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01410458  0.07335267 -0.39250242]
Stock Position:  -0.014104578258689271
Bond Position:  [-1.90567723]


portfolio before change:  [-3.38030509]
curr_Stock_Price:  104.51580689615115
curr_Factors:  [104.5158069   -0.81667125  -1.02071352]
mat_Sqrt:  [[16.64239828  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00887697  0.01666572 -0.16011115]
Stock Position:  0.008876968931770972
Bond Position:  [-4.30808866]


portfolio before change:  [-3.38016432]
curr_Stock_Price:  104.65300746788063
curr_Factors:  [104.65300747  -0.70209997  -1.03122177]
mat_Sqrt:  [[18.49181964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037935  0.03330904  0.0339756 ]
Stock Position:  -0.0003793516732888072
Bond Position:  [-3.34046403]


portfolio before change:  [-3.38136167]
curr_Stock_Price:  105.60762024059449
curr_Factors:  [105.60762024  -0.83492045  -1.04999659]
mat_Sqrt:  [[16.03563599  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00905654  0.00431295 -0.27199347]
Stock Position:  0.00905653859438602
Bond Position:  [-4.33780116]


portfolio before change:  [-3.38561932]
curr_Stock_Price:  105.25725948840885
curr_Factors:  [105.25725949  -0.80581402  -1.0403879 ]
mat_Sqrt:  [[16.61333223  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00547572  0.27975542 -1.52354214]
Stock Position:  0.005475718722303979
Bond Position:  [-3.96197846]


portfolio before change:  [-3.38342344]
curr_Stock_Price:  105.83919176516048
curr_Factors:  [105.83919177  -0.58511465  -1.04225494]
mat_Sqrt:  [[20.79164652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00698334 -0.02144535  0.01409986]
Stock Position:  0.00698333572165037
Bond Position:  [-4.12253404]


portfolio before change:  [-3.36925425]
curr_Stock_Price:  108.01579530417456
curr_Factors:  [108.0157953   -0.20605414  -1.03296552]
mat_Sqrt:  [[31.28872487  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064903 -0.01166857 -0.38272985]
Stock Position:  -0.0006490322043578571
Bond Position:  [-3.29914852]


portfolio before change:  [-3.36775597]
curr_Stock_Price:  104.4363672201308
curr_Factors:  [104.43636722  -0.30952111  -1.04717022]
mat_Sqrt:  [[26.89355399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264508  0.00513255  0.1610105 ]
Stock Position:  -0.0026450834632648942
Bond Position:  [-3.09151306]


portfolio before change:  [-3.36974808]
curr_Stock_Price:  104.89727375090582
curr_Factors:  [104.89727375  -0.48234984  -1.02934742]
mat_Sqrt:  [[23.13355728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00012743 -0.05000484 -0.11425746]
Stock Position:  0.00012742583479401993
Bond Position:  [-3.38311471]


portfolio before change:  [-3.37090036]
curr_Stock_Price:  102.49280260765643
curr_Factors:  [102.49280261  -0.35243572  -0.99975666]
mat_Sqrt:  [[26.5120727   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00453582  0.01608053 -0.04398028]
Stock Position:  -0.004535819887574436
Bond Position:  [-2.90601147]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.37610744]
Stock Price:  103.48060297103076
PL:  [-6.85671041]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.09670612e-02  3.05992772e-02  3.79456787e-02]
 [ 1.63368219e-02  3.04848359e-02 -7.13040492e-02]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-1.89936860e-01 -1.67763747e-01  7.19057271e-01]
 [ 3.21235598e-02 -8.70828578e-02  4.92669240e-02]
 [-8.69024916e-01  9.03062772e-01 -1.17965441e-01]
 [ 1.13511137e-02 -8.64360245e-03  3.49187209e-02]
 [-9.24980324e-02 -1.72096513e-02 -2.65523699e-02]
 [-1.38772445e-04  2.09680081e-02  5.77550621e-02]
 [-4.58670683e-01  2.62423053e-01 -2.30109271e-01]
 [ 1.29323911e-01  3.96386708e-02 -5.40012508e-02]
 [-7.33685544e-02  1.31970847e-01  9.99440004e-02]
 [-3.80729823e-03 -8.75553521e-02 -1.03201112e-01]
 [ 1.76582225e-02  7.47630046e-01 -4.83710922e-01]
 [ 9.27345243e-02 -6.52018087e-02 -4.32080576e-02]
 [ 4.59832408e-02  2.67907463e-02  4.53470498e-02]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.12061504e-02 -1.82210998e-01 -3.81516205e-02]
 [-1.79949092e-01  1.74470580e-02 -3.78494382e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.157482]
curr_Stock_Price:  99.98331863537499
curr_Factors:  [99.98331864 -0.92933747 -0.9927188 ]
mat_Sqrt:  [[14.62814028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184407  0.00987587  0.10824846]
Stock Position:  -0.0018440745129703724
Bond Position:  [2.34185869]


portfolio before change:  [2.15986574]
curr_Stock_Price:  99.0081919580499
curr_Factors:  [99.00819196 -0.87541474 -0.97155653]
mat_Sqrt:  [[15.61498953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00051263  0.00983894 -0.20341061]
Stock Position:  0.0005126250547680094
Bond Position:  [2.10911166]


portfolio before change:  [2.16138021]
curr_Stock_Price:  100.93382083842963
curr_Factors:  [100.93382084  -0.86835499  -0.97902383]
mat_Sqrt:  [[15.91220205  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00490333  0.01370813 -0.02999186]
Stock Position:  -0.004903327537032707
Bond Position:  [2.65629179]


portfolio before change:  [2.16080489]
curr_Stock_Price:  101.18660322329846
curr_Factors:  [101.18660322  -1.16183664  -0.96428737]
mat_Sqrt:  [[12.07144022  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0064122  -0.05414552  2.05127025]
Stock Position:  -0.006412204305995689
Bond Position:  [2.80963406]


portfolio before change:  [2.16585776]
curr_Stock_Price:  100.50815059740376
curr_Factors:  [100.5081506   -1.2553289   -0.96964882]
mat_Sqrt:  [[10.86189841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00224679 -0.02810587  0.14054482]
Stock Position:  0.0022467909114736676
Bond Position:  [1.94003696]


portfolio before change:  [2.16805899]
curr_Stock_Price:  101.2719771113205
curr_Factors:  [101.27197711  -1.40113901  -0.98994285]
mat_Sqrt:  [[ 9.26948555  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07646245  0.29146226 -0.33652257]
Stock Position:  -0.0764624520821906
Bond Position:  [9.91156269]


portfolio before change:  [2.19525499]
curr_Stock_Price:  100.94870992160216
curr_Factors:  [100.94870992  -1.5605286   -1.00343749]
mat_Sqrt:  [[ 7.77292455  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00215035 -0.00278971  0.09961339]
Stock Position:  0.002150348904957346
Bond Position:  [1.97818005]


portfolio before change:  [2.19679735]
curr_Stock_Price:  101.43595433648298
curr_Factors:  [101.43595434  -1.51294493  -1.00017146]
mat_Sqrt:  [[ 8.21787136  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01234272 -0.00555439 -0.07574652]
Stock Position:  -0.01234272393358331
Bond Position:  [3.44879333]


portfolio before change:  [2.19747481]
curr_Stock_Price:  101.45093044344101
curr_Factors:  [101.45093044  -1.29390359  -1.00943508]
mat_Sqrt:  [[10.13745086  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00157145 0.0067674  0.16475912]
Stock Position:  0.0015714509668312217
Bond Position:  [2.03804964]


portfolio before change:  [2.19905335]
curr_Stock_Price:  102.13117222465908
curr_Factors:  [102.13117222  -1.2846095   -1.03265391]
mat_Sqrt:  [[10.06430071  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04491864  0.08469668 -0.6564377 ]
Stock Position:  -0.04491863598734152
Bond Position:  [6.7866463]


portfolio before change:  [2.15621659]
curr_Stock_Price:  103.12260113025089
curr_Factors:  [103.12260113  -1.55819391  -0.98957082]
mat_Sqrt:  [[ 8.07000299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01566197  0.01279333 -0.15405054]
Stock Position:  0.015661972109351375
Bond Position:  [0.54111329]


portfolio before change:  [2.13755101]
curr_Stock_Price:  101.92218566144447
curr_Factors:  [101.92218566  -1.2536906   -0.95663895]
mat_Sqrt:  [[11.1772458   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00232876  0.04259341  0.28511241]
Stock Position:  -0.0023287610233349906
Bond Position:  [2.37490342]


portfolio before change:  [2.13497927]
curr_Stock_Price:  103.28151077804687
curr_Factors:  [103.28151078  -1.12540967  -0.9741498 ]
mat_Sqrt:  [[12.65305769  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337826 -0.02825837 -0.29440405]
Stock Position:  -0.0033782584011935544
Bond Position:  [2.4838909]


portfolio before change:  [2.1347591]
curr_Stock_Price:  103.53052092876922
curr_Factors:  [103.53052093  -0.73296873  -0.9456554 ]
mat_Sqrt:  [[19.32196102  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00370203  0.24129656 -1.37989262]
Stock Position:  0.003702030454675193
Bond Position:  [1.75148596]


portfolio before change:  [2.13329779]
curr_Stock_Price:  103.0174952925847
curr_Factors:  [103.01749529  -0.8636414   -0.92954076]
mat_Sqrt:  [[17.1451729   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0041181  -0.02104379 -0.12326056]
Stock Position:  0.004118095124921795
Bond Position:  [1.70906194]


portfolio before change:  [2.13274101]
curr_Stock_Price:  102.77852763955994
curr_Factors:  [102.77852764  -0.63620762  -0.93853299]
mat_Sqrt:  [[21.28145091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00285264 0.00864668 0.12936251]
Stock Position:  0.002852639466947108
Bond Position:  [1.83955093]


portfolio before change:  [2.13619783]
curr_Stock_Price:  103.82908977838423
curr_Factors:  [103.82908978  -0.65639008  -0.93118177]
mat_Sqrt:  [[21.22488534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.003241    0.00525786  0.16709793]
Stock Position:  -0.003240998234833651
Bond Position:  [2.47270773]


portfolio before change:  [2.12856038]
curr_Stock_Price:  106.3763638742545
curr_Factors:  [106.37636387  -0.82531444  -0.93056968]
mat_Sqrt:  [[18.37698895  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00020543 -0.05880835 -0.10883595]
Stock Position:  -0.00020542978206162545
Bond Position:  [2.15041325]


portfolio before change:  [2.1290502]
curr_Stock_Price:  106.60930515560318
curr_Factors:  [106.60930516  -0.58509885  -0.93678626]
mat_Sqrt:  [[23.27280929  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00791111  0.00563101 -0.10797391]
Stock Position:  -0.007911108101570198
Bond Position:  [2.97244793]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.14166341]
Stock Price:  105.1088821833579
PL:  [-2.96721878]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 9.72248525e-04 -1.52023631e-03  2.18945389e-02]
 [-4.21767187e-03  8.47877610e-02 -7.09047637e-02]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-4.33218000e-01 -4.97303030e-01  1.35149117e+00]
 [-1.11918069e-01  1.25563575e-01 -9.39562409e-02]
 [-1.35617277e+00  1.37807445e+00 -2.00192520e-01]
 [-2.01349851e-02 -7.55060408e-03 -3.99315300e-02]
 [ 4.41617474e-02  1.27374365e-02 -4.85799065e-02]
 [ 6.76184745e-02  2.61462892e-02  6.20618073e-02]
 [ 1.08251555e-02  1.61652848e-01  2.36088046e-02]
 [ 4.10233538e-02  2.25556102e-02 -5.44395098e-02]
 [ 8.29506466e-02  6.85608708e-03 -2.64472528e-02]
 [-1.53771285e-01 -1.07792214e-01  4.94169546e-02]
 [ 2.83541945e-02  4.97857843e-01 -3.22149025e-01]
 [-1.99087911e-02 -2.28455912e-01 -5.88842316e-02]
 [ 4.92305692e-02  2.20031231e-02  5.00935664e-02]
 [ 6.69005035e-03  2.22402333e-02  9.08169437e-02]
 [-3.44089498e-02  1.88321271e-03  3.57186012e-02]
 [ 1.87885159e-03  8.11552012e-02 -1.30585701e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.69378687]
curr_Stock_Price:  100.93335769410376
curr_Factors:  [100.93335769  -0.45754318  -1.03018058]
mat_Sqrt:  [[22.7994569   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00022506 -0.00049065  0.06245903]
Stock Position:  0.000225055168655089
Bond Position:  [9.67107129]


portfolio before change:  [9.69669212]
curr_Stock_Price:  103.09810792540708
curr_Factors:  [103.09810793  -0.74691526  -1.03914904]
mat_Sqrt:  [[17.28115739  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.00766347e-05  2.73651322e-02 -2.02271555e-01]
Stock Position:  -8.007663472616185e-05
Bond Position:  [9.70494787]


portfolio before change:  [9.69923669]
curr_Stock_Price:  101.62414798676852
curr_Factors:  [101.62414799  -0.25591554  -1.03761555]
mat_Sqrt:  [[27.87555367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00279897  0.01370813 -0.02999186]
Stock Position:  -0.0027989664144063733
Bond Position:  [9.98367927]


portfolio before change:  [9.70689761]
curr_Stock_Price:  99.77893791846422
curr_Factors:  [99.77893792  0.16023335 -1.02444685]
mat_Sqrt:  [[42.04513217  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00615666 -0.16050386  3.85542811]
Stock Position:  -0.006156659856213285
Bond Position:  [10.32120259]


portfolio before change:  [9.71946596]
curr_Stock_Price:  98.15667354149286
curr_Factors:  [98.15667354 -0.28482612 -0.98032312]
mat_Sqrt:  [[27.69953614  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00380751  0.04052547 -0.268031  ]
Stock Position:  -0.0038075095740428837
Bond Position:  [10.09319843]


portfolio before change:  [9.7151196]
curr_Stock_Price:  99.96099555923628
curr_Factors:  [99.96099556 -0.41229384 -0.98881038]
mat_Sqrt:  [[24.62287381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0453131   0.44477162 -0.57109354]
Stock Position:  -0.04531309548259826
Bond Position:  [14.24466174]


portfolio before change:  [9.79483948]
curr_Stock_Price:  98.28028353574548
curr_Factors:  [98.28028354 -0.3166463  -0.99196932]
mat_Sqrt:  [[26.55472805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00112324 -0.00243695 -0.11391354]
Stock Position:  -0.0011232363247777263
Bond Position:  [9.90523146]


portfolio before change:  [9.79830916]
curr_Stock_Price:  97.39617549013327
curr_Factors:  [97.39617549 -0.40883295 -1.0172462 ]
mat_Sqrt:  [[23.3993395   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00157464  0.00411099 -0.13858495]
Stock Position:  0.0015746356359593186
Bond Position:  [9.64494567]


portfolio before change:  [9.80714156]
curr_Stock_Price:  101.47386017937774
curr_Factors:  [101.47386018  -0.66945029  -1.04683233]
mat_Sqrt:  [[18.23820566  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00469475 0.00843868 0.17704506]
Stock Position:  0.0046947533336709965
Bond Position:  [9.33074682]


portfolio before change:  [9.80129203]
curr_Stock_Price:  99.73095501526105
curr_Factors:  [99.73095502 -0.31716144 -1.05156561]
mat_Sqrt:  [[25.37461003  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00191694 0.05217323 0.06734935]
Stock Position:  0.0019169371238064953
Bond Position:  [9.61011406]


portfolio before change:  [9.8027441]
curr_Stock_Price:  99.23497849260008
curr_Factors:  [99.23497849 -0.41354172 -1.03662678]
mat_Sqrt:  [[23.27365554  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00148301  0.00727979 -0.15530077]
Stock Position:  0.0014830106928676527
Bond Position:  [9.65557757]


portfolio before change:  [9.80491826]
curr_Stock_Price:  99.07311696578101
curr_Factors:  [99.07311697 -0.49627166 -1.02832875]
mat_Sqrt:  [[21.56901362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00366042  0.00221279 -0.07544665]
Stock Position:  0.003660418507008134
Bond Position:  [9.44226919]


portfolio before change:  [9.81147382]
curr_Stock_Price:  100.21907869127216
curr_Factors:  [100.21907869  -0.62543029  -1.01635519]
mat_Sqrt:  [[19.40582134  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00853801 -0.03478979  0.14097282]
Stock Position:  -0.008538009389161464
Bond Position:  [10.66714525]


portfolio before change:  [9.81316636]
curr_Stock_Price:  100.33322517360735
curr_Factors:  [100.33322517  -0.91911596  -1.0192127 ]
mat_Sqrt:  [[14.44239863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00444667  0.16068293 -0.9190015 ]
Stock Position:  0.004446671795688101
Bond Position:  [9.36701743]


portfolio before change:  [9.81678446]
curr_Stock_Price:  100.6201939004504
curr_Factors:  [100.6201939   -0.82204964  -1.00090821]
mat_Sqrt:  [[16.25491171  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00483311 -0.07373383 -0.16798032]
Stock Position:  -0.004833114671629472
Bond Position:  [10.30309339]


portfolio before change:  [9.83166183]
curr_Stock_Price:  98.0749862912056
curr_Factors:  [98.07498629 -1.07912224 -0.99100049]
mat_Sqrt:  [[12.37415008  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00516781 0.00710148 0.142903  ]
Stock Position:  0.005167809013475914
Bond Position:  [9.32482904]


portfolio before change:  [9.83070558]
curr_Stock_Price:  97.4387881268916
curr_Factors:  [97.43878813 -0.87449935 -0.99938069]
mat_Sqrt:  [[14.95946681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00198989 0.007178   0.25907546]
Stock Position:  0.001989893781772414
Bond Position:  [9.63681274]


portfolio before change:  [9.83206042]
curr_Stock_Price:  96.90877554794432
curr_Factors:  [96.90877555 -1.09980109 -0.95331149]
mat_Sqrt:  [[12.43677106  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214955  0.0006078   0.10189523]
Stock Position:  -0.0021495540564964648
Bond Position:  [10.04037107]


portfolio before change:  [9.83457483]
curr_Stock_Price:  96.9069141606829
curr_Factors:  [96.90691416 -1.17753376 -0.94167657]
mat_Sqrt:  [[11.64108368  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00070536  0.02619273 -0.37252466]
Stock Position:  -0.0007053558893685461
Bond Position:  [9.90292869]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.83676689]
Stock Price:  97.30952040616434
PL:  [9.83676689]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 4.33106626e-02 -1.11384851e-01  5.47554668e-02]
 [ 3.07558202e-02  1.64884675e-01 -2.19809288e-01]
 [-7.46221290e-02 -1.09293777e-02 -4.49137041e-02]
 [-2.37015846e-01 -2.27700258e-01  9.13528549e-01]
 [-3.71858123e-02  1.52374981e-02 -1.96486229e-02]
 [-1.30130628e+00  1.39476613e+00 -2.05187466e-01]
 [ 1.31919076e-03  1.14032688e-02  1.85334178e-03]
 [ 9.02533160e-03  8.56820252e-03 -8.14367788e-03]
 [ 4.09591968e-03  2.74455290e-02  4.66182059e-02]
 [ 1.54090705e-01  1.13054933e-01  8.07468219e-02]
 [-1.52956131e-03  3.00444692e-02 -5.14545859e-02]
 [-6.90371329e-02  1.34249516e-01  8.96084064e-02]
 [-1.76438668e-02 -3.88463676e-02  1.15034045e-01]
 [-1.82499396e-02  1.02724472e-01 -1.25614346e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 4.22425573e-02  1.94660959e-02 -2.48000797e-02]
 [-6.50152049e-02  2.26786924e-02  5.64723100e-02]
 [ 2.20753321e-02 -7.86454903e-02 -1.97793232e-02]
 [-7.05399949e-02  8.42299934e-02 -4.29653032e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.36689015]
curr_Stock_Price:  101.64851847825285
curr_Factors:  [101.64851848  -1.30302058  -0.99808169]
mat_Sqrt:  [[10.17993574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.003119   -0.03594931  0.15620211]
Stock Position:  0.003119001812911106
Bond Position:  [15.04984823]


portfolio before change:  [15.3694351]
curr_Stock_Price:  101.25801511168561
curr_Factors:  [101.25801511  -1.12335366  -1.0242941 ]
mat_Sqrt:  [[11.82273184  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00165312  0.0532163  -0.62705471]
Stock Position:  0.0016531188344442941
Bond Position:  [15.20204357]


portfolio before change:  [15.37365447]
curr_Stock_Price:  101.51110611039314
curr_Factors:  [101.51110611  -0.98308228  -1.01228465]
mat_Sqrt:  [[13.80183118  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00623258 -0.00352744 -0.1281263 ]
Stock Position:  -0.006232582413281253
Bond Position:  [16.00633081]


portfolio before change:  [15.37598874]
curr_Stock_Price:  101.77870211832943
curr_Factors:  [101.77870212  -1.01062531  -0.97276784]
mat_Sqrt:  [[14.00490638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0069277  -0.07348994  2.60604267]
Stock Position:  -0.006927695860379818
Bond Position:  [16.08108064]


portfolio before change:  [15.38571344]
curr_Stock_Price:  100.9553518225333
curr_Factors:  [100.95535182  -0.73798089  -0.96667999]
mat_Sqrt:  [[18.35711927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207474  0.00491788 -0.05605205]
Stock Position:  -0.002074738896404104
Bond Position:  [15.59516943]


portfolio before change:  [15.38640555]
curr_Stock_Price:  102.50116970797217
curr_Factors:  [102.50116971  -0.36263023  -0.95109701]
mat_Sqrt:  [[27.55397933  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03841494  0.45015883 -0.58534273]
Stock Position:  -0.0384149431863312
Bond Position:  [19.32398216]


portfolio before change:  [15.4726263]
curr_Stock_Price:  100.3824849418886
curr_Factors:  [100.38248494  -0.25871818  -0.94894338]
mat_Sqrt:  [[30.00386415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00013416 0.00368039 0.00528707]
Stock Position:  0.00013415555540210973
Bond Position:  [15.45915943]


portfolio before change:  [15.47621433]
curr_Stock_Price:  98.31586290614314
curr_Factors:  [98.31586291 -0.13610604 -0.97065035]
mat_Sqrt:  [[32.50614011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00028032  0.00276538 -0.02323165]
Stock Position:  0.00028031588163379825
Bond Position:  [15.44865483]


portfolio before change:  [15.47922806]
curr_Stock_Price:  95.28744263610727
curr_Factors:  [95.28744264 -0.49808021 -0.95314143]
mat_Sqrt:  [[22.3243139   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00086068 0.00885801 0.13298877]
Stock Position:  0.000860681155143985
Bond Position:  [15.39721595]


portfolio before change:  [15.483615]
curr_Stock_Price:  95.91155427258919
curr_Factors:  [95.91155427 -0.79459179 -0.8881733 ]
mat_Sqrt:  [[17.82605892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01086333 0.03648832 0.23034821]
Stock Position:  0.010863327870927099
Bond Position:  [14.44169634]


portfolio before change:  [15.483063]
curr_Stock_Price:  95.52834988739251
curr_Factors:  [95.52834989 -1.02556207 -0.89687743]
mat_Sqrt:  [[13.97099734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004223   0.00969681 -0.14678561]
Stock Position:  -0.0004222950541454418
Bond Position:  [15.52340415]


portfolio before change:  [15.48666114]
curr_Stock_Price:  96.19896837429674
curr_Factors:  [96.19896837 -1.29250222 -0.89235193]
mat_Sqrt:  [[10.82182018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215697  0.04332884  0.25562784]
Stock Position:  -0.0021569685655271568
Bond Position:  [15.69415929]


portfolio before change:  [15.49029563]
curr_Stock_Price:  96.33320217529258
curr_Factors:  [96.33320218 -1.21737651 -0.89229454]
mat_Sqrt:  [[11.68308407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.79072774e-04 -1.25376112e-02  3.28160111e-01]
Stock Position:  -0.00017907277405537338
Bond Position:  [15.50754629]


portfolio before change:  [15.49414739]
curr_Stock_Price:  96.47626530430783
curr_Factors:  [96.4762653  -0.6956577  -0.92220474]
mat_Sqrt:  [[19.13338256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00119803  0.03315418 -0.35834276]
Stock Position:  -0.0011980273393635988
Bond Position:  [15.60972859]


portfolio before change:  [15.49503297]
curr_Stock_Price:  98.99485242011218
curr_Factors:  [98.99485242 -1.14023567 -0.96282101]
mat_Sqrt:  [[12.0855579   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0110043  -0.09296045 -0.18429859]
Stock Position:  -0.01100429783260951
Bond Position:  [16.58440181]


portfolio before change:  [15.51057551]
curr_Stock_Price:  97.95926414097218
curr_Factors:  [97.95926414 -0.57481102 -0.98075889]
mat_Sqrt:  [[20.67616963  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0019904   0.00628266 -0.07074772]
Stock Position:  0.0019903958608800706
Bond Position:  [15.3155978]


portfolio before change:  [15.51381532]
curr_Stock_Price:  97.66305725179593
curr_Factors:  [97.66305725 -0.46881791 -1.00102192]
mat_Sqrt:  [[22.45882276  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217547  0.00731952  0.16109978]
Stock Position:  -0.0021754735217965537
Bond Position:  [15.72627872]


portfolio before change:  [15.5143585]
curr_Stock_Price:  99.22082564999536
curr_Factors:  [99.22082565 -0.77171201 -1.02330175]
mat_Sqrt:  [[16.48307622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00012039 -0.02538272 -0.0564249 ]
Stock Position:  0.00012039325403961974
Bond Position:  [15.50241298]


portfolio before change:  [15.51827619]
curr_Stock_Price:  99.5663605148516
curr_Factors:  [99.56636051 -1.20703497 -1.04094162]
mat_Sqrt:  [[10.51547276  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00590719  0.02718511 -0.12256805]
Stock Position:  -0.005907188078556127
Bond Position:  [16.1064334]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.5172785]
Stock Price:  100.41698461069453
PL:  [15.10029389]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.32913778e-02  3.34053587e-02  3.74537704e-02]
 [ 2.80423782e-02  7.04279032e-02 -1.01806884e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-1.91624970e-01 -1.75183120e-01  5.75529899e-01]
 [-1.02731522e-01  1.12001618e-01 -8.48218933e-02]
 [-1.38881926e+00  1.34049614e+00 -1.89132596e-01]
 [-4.38976746e-02  2.40030729e-02 -9.28239167e-02]
 [ 4.08249961e-02  1.89237230e-02 -5.16142609e-02]
 [ 3.04192432e-02  2.75726596e-02  4.64047946e-02]
 [ 1.55439877e-01  1.27409950e-01  9.81187366e-02]
 [ 3.77832889e-02  2.77415993e-02 -5.43380597e-02]
 [ 6.28775077e-02  3.28238073e-02 -2.19937957e-02]
 [-1.07271624e-01 -8.42410546e-02  7.18310466e-02]
 [ 3.00310715e-02  4.89491748e-01 -3.10725663e-01]
 [ 8.51894979e-02 -7.61368253e-02 -4.42580724e-02]
 [ 5.92506582e-02  4.41305728e-02  1.50691621e-01]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.33528690e-02 -1.47214358e-01 -4.05101053e-02]
 [-1.46134116e-01  4.31638818e-02 -1.81679059e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.35062716]
curr_Stock_Price:  99.88160518006356
curr_Factors:  [99.88160518 -1.13568379 -1.01210596]
mat_Sqrt:  [[11.66036852  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247225  0.01078153  0.10684518]
Stock Position:  -0.0024722476522881453
Bond Position:  [1.59755922]


portfolio before change:  [1.35141642]
curr_Stock_Price:  99.72392842548737
curr_Factors:  [99.72392843 -1.15954366 -1.00151084]
mat_Sqrt:  [[11.488553    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00188337  0.02273051 -0.2904267 ]
Stock Position:  0.0018833677817892153
Bond Position:  [1.16359958]


portfolio before change:  [1.35338011]
curr_Stock_Price:  100.612104632252
curr_Factors:  [100.61210463  -0.98548784  -1.04551438]
mat_Sqrt:  [[13.20070655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0059105   0.01370813 -0.02999186]
Stock Position:  -0.005910497155462852
Bond Position:  [1.94804767]


portfolio before change:  [1.35950164]
curr_Stock_Price:  99.65880919195175
curr_Factors:  [99.65880919 -1.01543892 -1.04714742]
mat_Sqrt:  [[12.66910194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00867501 -0.05654011  1.6418266 ]
Stock Position:  -0.008675005238754571
Bond Position:  [2.22404233]


portfolio before change:  [1.36883669]
curr_Stock_Price:  98.64682495534265
curr_Factors:  [98.64682496 -0.29346245 -1.05118403]
mat_Sqrt:  [[25.71050268  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00377991  0.03614837 -0.24197325]
Stock Position:  -0.003779913818827548
Bond Position:  [1.74171318]


portfolio before change:  [1.37505097]
curr_Stock_Price:  97.11800701664855
curr_Factors:  [97.11800702 -0.68009525 -1.07582071]
mat_Sqrt:  [[16.77703269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06877248  0.43264327 -0.53954265]
Stock Position:  -0.06877248096916086
Bond Position:  [8.05409726]


portfolio before change:  [1.4007229]
curr_Stock_Price:  96.77400087143293
curr_Factors:  [96.77400087 -0.53771861 -1.06665152]
mat_Sqrt:  [[19.45313499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297873  0.00774696 -0.2648008 ]
Stock Position:  -0.0029787317340172754
Bond Position:  [1.68898669]


portfolio before change:  [1.3989265]
curr_Stock_Price:  97.51884719580148
curr_Factors:  [97.5188472  -0.44067033 -1.01078881]
mat_Sqrt:  [[22.8416706   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00149517  0.00610761 -0.14724112]
Stock Position:  0.0014951650702548507
Bond Position:  [1.25311973]


portfolio before change:  [1.39951924]
curr_Stock_Price:  97.70572530513257
curr_Factors:  [97.70572531 -0.52216873 -1.02410777]
mat_Sqrt:  [[20.81520366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00218685 0.00889904 0.13237996]
Stock Position:  0.0021868547893871904
Bond Position:  [1.185851]


portfolio before change:  [1.40255269]
curr_Stock_Price:  98.95727498962584
curr_Factors:  [98.95727499 -0.50349271 -1.01109117]
mat_Sqrt:  [[21.7606723   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00925871 0.04112138 0.27990544]
Stock Position:  0.009258708777697463
Bond Position:  [0.4863361]


portfolio before change:  [1.40964275]
curr_Stock_Price:  99.70991367474662
curr_Factors:  [99.70991367 -0.45485695 -1.01248398]
mat_Sqrt:  [[22.98689291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00140751  0.00895356 -0.15501136]
Stock Position:  0.0014075111974054726
Bond Position:  [1.26929993]


portfolio before change:  [1.40935441]
curr_Stock_Price:  99.27957061536416
curr_Factors:  [99.27957062 -0.5663495  -1.0034614 ]
mat_Sqrt:  [[20.65854239  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00315067  0.01059384 -0.06274218]
Stock Position:  0.0031506663614785293
Bond Position:  [1.0965576]


portfolio before change:  [1.40942138]
curr_Stock_Price:  99.2138058111234
curr_Factors:  [99.21380581 -0.60575549 -0.9903906 ]
mat_Sqrt:  [[20.10826813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00546068 -0.02718868  0.20491398]
Stock Position:  -0.0054606794265047555
Bond Position:  [1.95119617]


portfolio before change:  [1.40513397]
curr_Stock_Price:  100.08828885639561
curr_Factors:  [100.08828886  -0.89131223  -0.98632074]
mat_Sqrt:  [[15.30867585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00434535  0.15798278 -0.88641383]
Stock Position:  0.004345349416666581
Bond Position:  [0.97021538]


portfolio before change:  [1.41629379]
curr_Stock_Price:  102.60068457003456
curr_Factors:  [102.60068457  -1.06503781  -0.99543929]
mat_Sqrt:  [[13.07062705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00463742 -0.02457305 -0.12625596]
Stock Position:  0.004637420384239917
Bond Position:  [0.94049128]


portfolio before change:  [1.41217913]
curr_Stock_Price:  101.66270469950216
curr_Factors:  [101.6627047   -1.07797547  -0.98457022]
mat_Sqrt:  [[12.92437206  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00766138 0.01424308 0.42988125]
Stock Position:  0.00766138359964288
Bond Position:  [0.63330215]


portfolio before change:  [1.41731324]
curr_Stock_Price:  102.31216433916195
curr_Factors:  [102.31216434  -1.03908614  -0.97636179]
mat_Sqrt:  [[13.6341905   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00504539  0.00525786  0.16709793]
Stock Position:  -0.00504539055210097
Bond Position:  [1.93351806]


portfolio before change:  [1.40971324]
curr_Stock_Price:  103.91430665048428
curr_Factors:  [103.91430665  -0.66346676  -1.02473378]
mat_Sqrt:  [[19.20875265  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00026206 -0.04751323 -0.11556405]
Stock Position:  0.0002620562311157712
Bond Position:  [1.38248185]


portfolio before change:  [1.40994527]
curr_Stock_Price:  103.48068863283758
curr_Factors:  [103.48068863  -0.81113891  -1.02459283]
mat_Sqrt:  [[16.50483341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00854488  0.01393108 -0.05182798]
Stock Position:  -0.008544880760355037
Bond Position:  [2.29417542]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.41023838]
Stock Price:  103.51351599847241
PL:  [-2.10327761]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-6.16348064e-02  1.23900805e-01  2.12779412e-02]
 [ 3.57297337e-02  9.07184714e-02 -2.40334459e-01]
 [ 1.09722803e-01 -1.79817932e-02 -1.14289304e-02]
 [-3.60481029e-01 -3.99821850e-01  1.10659757e+00]
 [-8.61758169e-02  8.75606855e-02 -6.83602596e-02]
 [-1.47407436e+00  1.52991456e+00 -2.25473117e-01]
 [ 2.22175979e-03  1.12694176e-02  4.48060076e-03]
 [-5.34864654e-02 -4.74425800e-02  5.29594589e-02]
 [ 6.70179516e-02  2.84786834e-02  5.70946924e-02]
 [ 1.55481771e-01  1.27855692e-01  9.86581576e-02]
 [-2.00006884e-01 -1.57277864e-01  2.49358903e-02]
 [ 5.45576204e-02 -1.30833992e-02 -3.74168052e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-1.22207069e-01 -1.64918566e-02 -1.06141663e-01]
 [ 6.13597227e-02  2.44763920e-01  1.14689698e-01]
 [ 5.83300878e-02  1.65643157e-01 -2.81444035e-01]
 [ 2.79684111e-01 -2.86784868e-01  2.17567609e-01]
 [-2.11607003e-01  1.48218802e-01  2.97465101e-01]
 [ 3.49617410e-01 -2.55179035e-01 -6.17792424e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.41499696]
curr_Stock_Price:  99.53296602794443
curr_Factors:  [99.53296603 -1.03269427 -0.96888112]
mat_Sqrt:  [[13.44911784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00237936  0.03998881  0.06070004]
Stock Position:  -0.002379361919145731
Bond Position:  [-1.17817202]


portfolio before change:  [-1.41452564]
curr_Stock_Price:  99.21107004044707
curr_Factors:  [99.21107004 -0.56482003 -0.98449733]
mat_Sqrt:  [[21.07172801  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.46277767e-04  2.92792607e-02 -6.85607316e-01]
Stock Position:  0.00024627776739601716
Bond Position:  [-1.43895912]


portfolio before change:  [-1.41512048]
curr_Stock_Price:  98.25664751975233
curr_Factors:  [98.25664752 -0.32855811 -0.96656428]
mat_Sqrt:  [[26.90899219  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00385445 -0.0058036  -0.03260356]
Stock Position:  0.0038544499669462017
Bond Position:  [-1.79384581]


portfolio before change:  [-1.40889016]
curr_Stock_Price:  99.98940734921352
curr_Factors:  [99.98940735 -0.30732326 -0.94345624]
mat_Sqrt:  [[28.62512303  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00755319 -0.12904195  3.15681484]
Stock Position:  -0.007553191651000961
Bond Position:  [-0.653651]


portfolio before change:  [-1.40488023]
curr_Stock_Price:  99.43687837962374
curr_Factors:  [99.43687838 -0.24859204 -0.93909537]
mat_Sqrt:  [[30.32085137  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00271287  0.02826009 -0.19501279]
Stock Position:  -0.002712870603713562
Bond Position:  [-1.13512085]


portfolio before change:  [-1.41005285]
curr_Stock_Price:  101.23895529673689
curr_Factors:  [ 1.01238955e+02  7.61594646e-02 -9.38406932e-01]
mat_Sqrt:  [[42.74431266  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02825654  0.4937778  -0.64321204]
Stock Position:  -0.028256539647701716
Bond Position:  [1.4506097]


portfolio before change:  [-1.38606664]
curr_Stock_Price:  100.40291820972723
curr_Factors:  [ 1.00402918e+02 -5.71384404e-02 -9.33980445e-01]
mat_Sqrt:  [[37.26566478  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00014589 0.00363719 0.01278191]
Stock Position:  0.00014589083177802802
Bond Position:  [-1.4007145]


portfolio before change:  [-1.38650176]
curr_Stock_Price:  99.82096442692992
curr_Factors:  [99.82096443 -0.35938369 -0.8938317 ]
mat_Sqrt:  [[28.50737519  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183673 -0.01531203  0.1510786 ]
Stock Position:  -0.0018367295079075557
Bond Position:  [-1.20315765]


portfolio before change:  [-1.38701018]
curr_Stock_Price:  99.93398550518472
curr_Factors:  [99.93398551 -0.35707557 -0.88722832]
mat_Sqrt:  [[28.79512028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00293402 0.00919146 0.16287527]
Stock Position:  0.0029340229515993034
Bond Position:  [-1.68021878]


portfolio before change:  [-1.39073625]
curr_Stock_Price:  98.80721589096328
curr_Factors:  [ 9.88072159e+01 -5.17227579e-02 -9.34681414e-01]
mat_Sqrt:  [[36.84671485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00547454 0.04126525 0.28144426]
Stock Position:  0.005474537354059835
Bond Position:  [-1.93166005]


portfolio before change:  [-1.42594262]
curr_Stock_Price:  92.46450795648343
curr_Factors:  [92.46450796 -0.4575578  -0.96075541]
mat_Sqrt:  [[22.38769932  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01014044 -0.05076121  0.07113515]
Stock Position:  -0.010140437974689935
Bond Position:  [-0.48831201]


portfolio before change:  [-1.38329824]
curr_Stock_Price:  88.24708915665815
curr_Factors:  [88.24708916 -0.45050461 -0.94356639]
mat_Sqrt:  [[21.89087127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00202136 -0.00422265 -0.10673973]
Stock Position:  0.0020213589830098285
Bond Position:  [-1.56167729]


portfolio before change:  [-1.38228522]
curr_Stock_Price:  88.94141642024233
curr_Factors:  [88.94141642 -0.2404773  -0.95611401]
mat_Sqrt:  [[26.88010979  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00062727 -0.00995959  0.34984664]
Stock Position:  0.0006272713743730908
Bond Position:  [-1.43807563]


portfolio before change:  [-1.38267294]
curr_Stock_Price:  88.8965380158758
curr_Factors:  [88.89653802 -0.48042937 -0.96199596]
mat_Sqrt:  [[21.01103694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00700772 -0.00532272 -0.30279262]
Stock Position:  -0.007007723194065083
Bond Position:  [-0.75971061]


portfolio before change:  [-1.37930842]
curr_Stock_Price:  88.38931595618962
curr_Factors:  [88.38931596 -0.30657529 -0.96183752]
mat_Sqrt:  [[24.86194433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00541924 0.07899722 0.32717778]
Stock Position:  0.005419241685722086
Bond Position:  [-1.85831148]


portfolio before change:  [-1.37968615]
curr_Stock_Price:  88.40535236061366
curr_Factors:  [88.40535236 -0.12690288 -0.96321591]
mat_Sqrt:  [[29.719807    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00116731  0.0534611  -0.80288149]
Stock Position:  0.0011673135186910527
Bond Position:  [-1.48288291]


portfolio before change:  [-1.3802402]
curr_Stock_Price:  88.24834185899836
curr_Factors:  [88.24834186 -0.45617195 -0.98739275]
mat_Sqrt:  [[20.83408212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01274619 -0.09255942  0.62065983]
Stock Position:  0.012746191365316118
Bond Position:  [-2.50507045]


portfolio before change:  [-1.37732846]
curr_Stock_Price:  88.52592138844794
curr_Factors:  [88.52592139 -0.53421674 -0.97708076]
mat_Sqrt:  [[19.53090156  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00617648  0.04783741  0.84858514]
Stock Position:  -0.0061764766236032335
Bond Position:  [-0.83055018]


portfolio before change:  [-1.36803097]
curr_Stock_Price:  86.9869929089199
curr_Factors:  [86.98699291 -0.7631482  -0.9871343 ]
mat_Sqrt:  [[15.11180307  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01134364 -0.08235868 -1.76238983]
Stock Position:  0.011343640182735494
Bond Position:  [-2.35478012]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.37270528]
Stock Price:  86.6268312547371
PL:  [-1.37270528]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.74227110e-02  1.02269261e-02  3.20864958e-02]
 [ 4.08713022e-02  1.73236145e-01 -2.82667893e-01]
 [-7.88109038e-02  1.12770888e-02 -2.95793636e-02]
 [-3.06051486e-01 -3.17300746e-01  1.10842790e+00]
 [-1.78448965e-02 -1.33151973e-02 -4.17604782e-04]
 [-1.47300533e+00  1.58860520e+00 -2.40708016e-01]
 [ 4.76215461e-03  6.72440577e-03  1.22331025e-02]
 [ 3.07710766e-02  3.29565970e-02 -5.47567000e-02]
 [ 1.20247212e-01  2.53483013e-02  4.63407003e-02]
 [ 1.55322657e-01  1.26162735e-01  9.66094037e-02]
 [ 2.26180266e-02  3.04847250e-02 -5.17047422e-02]
 [-4.13649929e-02  1.48807240e-01  2.35774257e-02]
 [-1.06509909e-01 -8.38552611e-02  7.21982137e-02]
 [ 4.34168056e-02  2.32740558e-01 -8.87737372e-02]
 [-1.43537966e-02 -2.20405051e-01 -5.81111626e-02]
 [ 6.51029658e-02  5.79953051e-02  1.80258062e-01]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.23382223e-02 -1.30336799e-01 -3.79965099e-02]
 [-7.07626380e-02 -2.49930085e-05 -5.00074974e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.32408351]
curr_Stock_Price:  100.3825056601884
curr_Factors:  [100.38250566  -0.63368344  -1.02449551]
mat_Sqrt:  [[19.12141674  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045946  0.00330073  0.09153384]
Stock Position:  -0.0004594596770464888
Bond Position:  [5.37020522]


portfolio before change:  [5.32537822]
curr_Stock_Price:  100.48698080547375
curr_Factors:  [100.48698081  -0.81672764  -1.01597662]
mat_Sqrt:  [[16.07594284  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115288  0.05591173 -0.80637282]
Stock Position:  0.001152880447450734
Bond Position:  [5.20952875]


portfolio before change:  [5.32776917]
curr_Stock_Price:  101.43104781512989
curr_Factors:  [101.43104782  -0.83414224  -1.05735119]
mat_Sqrt:  [[15.30050455  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00539504  0.00363966 -0.08438169]
Stock Position:  -0.00539504038525243
Bond Position:  [5.87499376]


portfolio before change:  [5.3275805]
curr_Stock_Price:  101.738291661069
curr_Factors:  [101.73829166  -0.70277542  -1.10948464]
mat_Sqrt:  [[16.61230496  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00870218 -0.10240838  3.16203626]
Stock Position:  -0.00870218390486858
Bond Position:  [6.21292583]


portfolio before change:  [5.32913577]
curr_Stock_Price:  101.73808003624353
curr_Factors:  [101.73808004  -0.33707069  -1.1186626 ]
mat_Sqrt:  [[23.72829896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00087019 -0.00429746 -0.00119131]
Stock Position:  -0.0008701885051260673
Bond Position:  [5.41766708]


portfolio before change:  [5.32991363]
curr_Stock_Price:  102.4008397994691
curr_Factors:  [102.4008398   -0.37033359  -1.09676846]
mat_Sqrt:  [[23.61289267  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05072936  0.51272012 -0.68667297]
Stock Position:  -0.050729361518226775
Bond Position:  [10.52464285]


portfolio before change:  [5.47847161]
curr_Stock_Price:  99.52427120174413
curr_Factors:  [99.5242712  -0.32111471 -1.09280693]
mat_Sqrt:  [[24.20308008  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00035664 0.00217029 0.03489764]
Stock Position:  0.00035664220231353713
Bond Position:  [5.44297705]


portfolio before change:  [5.47916369]
curr_Stock_Price:  97.64890509726074
curr_Factors:  [97.6489051  -0.55721703 -1.11155159]
mat_Sqrt:  [[18.40476906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00143013  0.0106367  -0.15620562]
Stock Position:  0.0014301265664136494
Bond Position:  [5.3395134]


portfolio before change:  [5.4829971]
curr_Stock_Price:  99.39585790223721
curr_Factors:  [99.3958579  -0.88164643 -1.14612817]
mat_Sqrt:  [[13.08328996  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01030938 0.00818113 0.13219712]
Stock Position:  0.010309384615776393
Bond Position:  [4.45828697]


portfolio before change:  [5.47735049]
curr_Stock_Price:  98.7400171644744
curr_Factors:  [98.74001716 -0.87978319 -1.12167266]
mat_Sqrt:  [[13.34356782  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01504814 0.04071885 0.27559974]
Stock Position:  0.015048136432764259
Bond Position:  [3.99149725]


portfolio before change:  [5.46141706]
curr_Stock_Price:  97.61486539599335
curr_Factors:  [97.6148654  -1.07554251 -1.15059644]
mat_Sqrt:  [[10.53697865  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00173546  0.0098389  -0.14749924]
Stock Position:  0.0017354603539194394
Bond Position:  [5.29201033]


portfolio before change:  [5.4627179]
curr_Stock_Price:  97.60199971840419
curr_Factors:  [97.60199972 -0.89467709 -1.16278194]
mat_Sqrt:  [[12.47141153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004953   0.04802733  0.06725983]
Stock Position:  -0.0004953024307634508
Bond Position:  [5.5110604]


portfolio before change:  [5.46358527]
curr_Stock_Price:  98.63281397804889
curr_Factors:  [98.63281398 -1.1110146  -1.18107804]
mat_Sqrt:  [[ 9.96731624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01092465 -0.02706417  0.20596141]
Stock Position:  -0.010924645232034524
Bond Position:  [6.54111377]


portfolio before change:  [5.47368843]
curr_Stock_Price:  97.85771552310744
curr_Factors:  [97.85771552 -0.82374415 -1.16550529]
mat_Sqrt:  [[13.38674594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00543851  0.07511669 -0.25324676]
Stock Position:  0.005438506880007143
Bond Position:  [4.94148857]


portfolio before change:  [5.48902082]
curr_Stock_Price:  100.44976329189129
curr_Factors:  [100.44976329  -1.010127    -1.16111365]
mat_Sqrt:  [[11.45489431  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00621618 -0.07113542 -0.16577497]
Stock Position:  -0.006216179636249069
Bond Position:  [6.1134346]


portfolio before change:  [5.49024324]
curr_Stock_Price:  100.4990116854352
curr_Factors:  [100.49901169  -1.0511206   -1.15597566]
mat_Sqrt:  [[11.05686646  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01028648 0.0187179  0.51422608]
Stock Position:  0.010286479547650874
Bond Position:  [4.45646221]


portfolio before change:  [5.49344456]
curr_Stock_Price:  100.7019064346672
curr_Factors:  [100.70190643  -1.06434551  -1.09510204]
mat_Sqrt:  [[11.61987721  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00592001  0.00525786  0.16709793]
Stock Position:  -0.005920012292672618
Bond Position:  [6.08960109]


portfolio before change:  [5.49300749]
curr_Stock_Price:  101.03292961709705
curr_Factors:  [101.03292962  -0.73006258  -1.07176607]
mat_Sqrt:  [[16.67011927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00047854 -0.04206602 -0.10839347]
Stock Position:  0.0004785406382833426
Bond Position:  [5.44465913]


portfolio before change:  [5.49441024]
curr_Stock_Price:  101.11945833628418
curr_Factors:  [101.11945834  -0.51020732  -1.04676062]
mat_Sqrt:  [[21.31337119  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.79928058e-03 -8.06645879e-06 -1.42657471e-01]
Stock Position:  -0.003799280583651421
Bond Position:  [5.87859143]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.50610068]
Stock Price:  98.42931384855457
PL:  [5.50610068]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-3.86990681e-02  2.78611935e-02  3.84256669e-02]
 [ 3.25558641e-02  1.22243113e-01 -1.75207597e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-2.66324091e-01 -2.71738313e-01  8.71523543e-01]
 [-3.11661565e-02  6.35077318e-03 -1.36631716e-02]
 [-1.18384336e+00  1.24200808e+00 -1.80250378e-01]
 [-1.35732166e-03  1.61968597e-02 -5.76624436e-03]
 [ 1.74633844e-02  3.48706453e-02 -4.12515975e-02]
 [-1.99516144e-02  2.91250616e-02  5.10242286e-02]
 [ 1.49432793e-01  1.40938957e-01  9.93216877e-02]
 [-2.04171539e-01 -2.21744896e-01  3.89560982e-02]
 [ 3.28177871e-02  7.17107207e-02 -1.53247004e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-3.49343256e-02 -6.64622769e-02  3.02365624e-02]
 [ 5.49094912e-02  2.09360379e-01  1.58467818e-02]
 [ 5.79445101e-02  1.81651265e-01 -3.37652733e-01]
 [ 2.43469029e-01 -3.02454962e-01  2.13212987e-01]
 [-2.30992741e-01  1.55636160e-01  3.36694603e-01]
 [ 2.82768867e-01 -3.24503114e-01 -5.59837035e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.5493082]
curr_Stock_Price:  100.28483620345612
curr_Factors:  [100.2848362   -1.18449445  -1.01233323]
mat_Sqrt:  [[11.14718298  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00225782  0.00899216  0.10961773]
Stock Position:  -0.0022578188071159387
Bond Position:  [4.77573319]


portfolio before change:  [4.55060648]
curr_Stock_Price:  100.23868618621253
curr_Factors:  [100.23868619  -1.08512613  -1.01584151]
mat_Sqrt:  [[12.26299956  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00177318  0.0394538  -0.49981851]
Stock Position:  0.0017731823287840528
Bond Position:  [4.37286501]


portfolio before change:  [4.55199109]
curr_Stock_Price:  100.40294421688601
curr_Factors:  [100.40294422  -0.77780688  -1.00887195]
mat_Sqrt:  [[16.81905893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00463895  0.01370813 -0.02999186]
Stock Position:  -0.00463894792277361
Bond Position:  [5.01775512]


portfolio before change:  [4.55300607]
curr_Stock_Price:  100.45459759253241
curr_Factors:  [100.45459759  -0.76483383  -1.01516107]
mat_Sqrt:  [[16.94056358  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00849402 -0.08770316  2.48621408]
Stock Position:  -0.008494017488912497
Bond Position:  [5.40626918]


portfolio before change:  [4.55247491]
curr_Stock_Price:  100.67627106130053
curr_Factors:  [100.67627106  -1.0151433   -0.99587038]
mat_Sqrt:  [[13.47581297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242351  0.0020497  -0.03897723]
Stock Position:  -0.002423511935136589
Bond Position:  [4.79646505]


portfolio before change:  [4.55166561]
curr_Stock_Price:  101.50505324014517
curr_Factors:  [101.50505324  -0.73161226  -0.98498423]
mat_Sqrt:  [[18.23808677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05302711  0.40085638 -0.51420416]
Stock Position:  -0.05302710678943536
Bond Position:  [9.93418491]


portfolio before change:  [4.62183253]
curr_Stock_Price:  100.22866713112248
curr_Factors:  [100.22866713  -0.63208786  -0.95888301]
mat_Sqrt:  [[20.41935809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.77983859e-05  5.22751399e-03 -1.64494902e-02]
Stock Position:  3.7798385927590835e-05
Bond Position:  [4.61804405]


portfolio before change:  [4.62291129]
curr_Stock_Price:  98.22075921626846
curr_Factors:  [98.22075922 -0.34782888 -0.96568447]
mat_Sqrt:  [[26.4089835   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00061195  0.01125445 -0.11767933]
Stock Position:  0.0006119462347480019
Bond Position:  [4.56280547]


portfolio before change:  [4.62284516]
curr_Stock_Price:  96.24840494621509
curr_Factors:  [96.24840495 -0.23574393 -0.99912991]
mat_Sqrt:  [[27.99591362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.28276187e-04  9.40007323e-03  1.45557922e-01]
Stock Position:  -0.00012827618681718214
Bond Position:  [4.63519154]


portfolio before change:  [4.62430057]
curr_Stock_Price:  93.93726972989896
curr_Factors:  [93.93726973 -0.21946104 -1.01611514]
mat_Sqrt:  [[27.3044867   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00726898 0.04548785 0.28333713]
Stock Position:  0.007268980862188834
Bond Position:  [3.94147235]


portfolio before change:  [4.62308874]
curr_Stock_Price:  93.63498303693831
curr_Factors:  [93.63498304  0.16252649 -1.03966573]
mat_Sqrt:  [[38.94945678  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00619991 -0.07156786  0.1111309 ]
Stock Position:  -0.006199910506514736
Bond Position:  [5.20361726]


portfolio before change:  [4.59201003]
curr_Stock_Price:  98.85760349683059
curr_Factors:  [ 9.88576035e+01  7.50458728e-02 -1.01728266e+00]
mat_Sqrt:  [[38.53025136  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115046  0.02314454 -0.0437171 ]
Stock Position:  0.0011504605791138915
Bond Position:  [4.47827825]


portfolio before change:  [4.59030751]
curr_Stock_Price:  96.40447140886683
curr_Factors:  [96.40447141 -0.20527482 -1.00689402]
mat_Sqrt:  [[28.68527002  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0005878  -0.00995959  0.34984664]
Stock Position:  0.000587797270091984
Bond Position:  [4.53364122]


portfolio before change:  [4.58983431]
curr_Stock_Price:  93.67095335673437
curr_Factors:  [ 9.36709534e+01 -6.04939804e-02 -9.99831756e-01]
mat_Sqrt:  [[32.44227668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00130474 -0.02145061  0.0862565 ]
Stock Position:  -0.0013047440841596908
Bond Position:  [4.71205093]


portfolio before change:  [4.59605266]
curr_Stock_Price:  89.80797589695524
curr_Factors:  [89.8079759   0.13197383 -0.96386431]
mat_Sqrt:  [[39.08674127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00258092 0.06757077 0.04520646]
Stock Position:  0.0025809189264657845
Bond Position:  [4.36426556]


portfolio before change:  [4.59156124]
curr_Stock_Price:  87.64493714190323
curr_Factors:  [87.64493714  0.19157796 -1.02210662]
mat_Sqrt:  [[38.19731371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.83316213e-04  5.86276937e-02 -9.63229263e-01]
Stock Position:  0.0006833162130038987
Bond Position:  [4.53167203]


portfolio before change:  [4.59352024]
curr_Stock_Price:  88.85367147711874
curr_Factors:  [ 8.88536715e+01 -1.08185545e-02 -1.05974425e+00]
mat_Sqrt:  [[30.46041814  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00739493 -0.09761692  0.60823731]
Stock Position:  0.00739492761893289
Bond Position:  [3.93645378]


portfolio before change:  [4.58519998]
curr_Stock_Price:  87.59544366827615
curr_Factors:  [ 8.75954437e+01  9.67190275e-03 -1.04956070e+00]
mat_Sqrt:  [[30.96446272  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00421438  0.05023135  0.96049598]
Stock Position:  -0.004214384270370506
Bond Position:  [4.95436084]


portfolio before change:  [4.57732585]
curr_Stock_Price:  89.75777035195865
curr_Factors:  [ 8.97577704e+01 -7.82370067e-02 -1.03167401e+00]
mat_Sqrt:  [[29.58310984  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00345649 -0.10473293 -1.59705923]
Stock Position:  0.0034564888732991073
Bond Position:  [4.26707911]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.5851845]
Stock Price:  91.72269702272881
PL:  [4.5851845]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-6.20014916e-02  1.25709810e-01  2.09545863e-02]
 [ 3.66502754e-02  1.29398859e-01 -2.24347721e-01]
 [ 5.79423142e-02 -5.19479677e-02 -2.83298683e-02]
 [-2.15655446e-01 -2.07115647e-01  6.70661540e-01]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-1.21384285e+00  1.16871181e+00 -1.58673250e-01]
 [ 4.95329622e-03  8.94396358e-03  1.23568836e-02]
 [-3.16838565e-02  3.37230147e-03 -1.94130817e-02]
 [ 6.54785115e-02  2.72452423e-02  4.95771167e-02]
 [-9.65204405e-02  1.84171656e-01 -3.49937700e-02]
 [ 2.08481840e-02  3.21065780e-02 -5.31878713e-02]
 [ 7.19507371e-04  1.13234827e-01 -8.20332725e-03]
 [-1.03031382e-01 -1.02997518e-01 -6.75971057e-02]
 [ 2.89544537e-02  4.33343064e-01 -2.74812041e-01]
 [ 1.03338557e-02 -1.84625205e-01 -5.46754688e-02]
 [ 4.83470072e-02  2.23380909e-02  8.00090314e-02]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.20628679e-02 -1.42788684e-01 -3.97211354e-02]
 [-1.02164536e-01  1.43950859e-01 -5.39945582e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.40463201]
curr_Stock_Price:  99.66033430549261
curr_Factors:  [99.66033431 -0.86608992 -0.97782282]
mat_Sqrt:  [[15.7659887   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00203373  0.04057267  0.0597776 ]
Stock Position:  -0.0020337289170772725
Bond Position:  [-0.20194991]


portfolio before change:  [-0.40556583]
curr_Stock_Price:  100.09467247470306
curr_Factors:  [100.09467247  -0.94588934  -0.97498688]
mat_Sqrt:  [[14.66172331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00117782  0.0417633  -0.6400016 ]
Stock Position:  0.0011778233523241487
Bond Position:  [-0.52345967]


portfolio before change:  [-0.40668928]
curr_Stock_Price:  99.2519549879613
curr_Factors:  [99.25195499 -0.97918915 -0.97879073]
mat_Sqrt:  [[14.00874441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00296641 -0.01676613 -0.08081723]
Stock Position:  0.00296640929074079
Bond Position:  [-0.70111121]


portfolio before change:  [-0.40493728]
curr_Stock_Price:  99.9016649844855
curr_Factors:  [99.90166498 -0.93567088 -0.99216127]
mat_Sqrt:  [[14.53201576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00832882 -0.06684629  1.9132107 ]
Stock Position:  -0.008328819546937719
Bond Position:  [0.42712566]


portfolio before change:  [-0.38145704]
curr_Stock_Price:  97.0953320262031
curr_Factors:  [97.09533203 -0.82337912 -0.98516027]
mat_Sqrt:  [[15.91327893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00356918 -0.04522423  0.24245377]
Stock Position:  0.003569181584429995
Bond Position:  [-0.72800791]


portfolio before change:  [-0.378853]
curr_Stock_Price:  97.87592102201431
curr_Factors:  [97.87592102 -0.8105918  -0.99617109]
mat_Sqrt:  [[16.06973467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06270605  0.37720012 -0.45265062]
Stock Position:  -0.06270605052702086
Bond Position:  [5.75855945]


portfolio before change:  [-0.43600781]
curr_Stock_Price:  98.81035445596757
curr_Factors:  [98.81035446 -0.76841521 -0.98580004]
mat_Sqrt:  [[17.09843864  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00054399 0.00288665 0.03525075]
Stock Position:  0.0005439861283393114
Bond Position:  [-0.48975928]


portfolio before change:  [-0.4358463]
curr_Stock_Price:  99.33236349590875
curr_Factors:  [99.3323635  -0.56390168 -0.96533158]
mat_Sqrt:  [[21.52549781  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162404  0.00108841 -0.05538012]
Stock Position:  -0.001624035243039551
Bond Position:  [-0.27452704]


portfolio before change:  [-0.43512436]
curr_Stock_Price:  98.84556097572631
curr_Factors:  [98.84556098 -0.5705423  -0.93958626]
mat_Sqrt:  [[21.83316367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00371727 0.00879336 0.14142971]
Stock Position:  0.003717272083707168
Bond Position:  [-0.8025602]


portfolio before change:  [-0.42887939]
curr_Stock_Price:  100.57952968375494
curr_Factors:  [100.57952968  -0.58024789  -0.91947013]
mat_Sqrt:  [[22.44865559  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00294314  0.05944115 -0.09982749]
Stock Position:  -0.0029431442693038843
Bond Position:  [-0.13285932]


portfolio before change:  [-0.42588574]
curr_Stock_Price:  99.55108092324032
curr_Factors:  [99.55108092 -0.54045908 -0.92344368]
mat_Sqrt:  [[23.02931863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071843  0.01036235 -0.15173019]
Stock Position:  0.0007184312882473743
Bond Position:  [-0.49740635]


portfolio before change:  [-0.42501822]
curr_Stock_Price:  100.93169986987324
curr_Factors:  [100.93169987  -0.78881904  -0.93841405]
mat_Sqrt:  [[17.94319551  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00123495  0.03654638 -0.02340181]
Stock Position:  0.0012349512892914616
Bond Position:  [-0.54966396]


portfolio before change:  [-0.42418559]
curr_Stock_Price:  101.7172116947218
curr_Factors:  [101.71721169  -0.84728799  -0.9599394 ]
mat_Sqrt:  [[16.69266062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00825835 -0.03324231 -0.19283573]
Stock Position:  -0.0082583517931858
Bond Position:  [0.41583093]


portfolio before change:  [-0.40521481]
curr_Stock_Price:  99.43263816018379
curr_Factors:  [99.43263816 -0.6834286  -0.94671856]
mat_Sqrt:  [[19.47892777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00314773  0.13986087 -0.78396226]
Stock Position:  0.0031477329745732644
Bond Position:  [-0.7182022]


portfolio before change:  [-0.39916417]
curr_Stock_Price:  101.41190673714625
curr_Factors:  [101.41190674  -0.72638935  -0.92232927]
mat_Sqrt:  [[19.50111975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00197492 -0.05958753 -0.15597389]
Stock Position:  -0.001974921963266846
Bond Position:  [-0.19888357]


portfolio before change:  [-0.40139464]
curr_Stock_Price:  102.51612355657697
curr_Factors:  [102.51612356  -0.91243199  -0.94194522]
mat_Sqrt:  [[16.04894127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00431421 0.00720959 0.2282435 ]
Stock Position:  0.004314211439804933
Bond Position:  [-0.84367087]


portfolio before change:  [-0.40656902]
curr_Stock_Price:  101.36563702790667
curr_Factors:  [101.36563703  -1.34963996  -0.91453358]
mat_Sqrt:  [[10.53349953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00653058  0.00525786  0.16709793]
Stock Position:  -0.006530575686811447
Bond Position:  [0.25540694]


portfolio before change:  [-0.40814058]
curr_Stock_Price:  101.61606103513094
curr_Factors:  [101.61606104  -1.54608924  -0.94327465]
mat_Sqrt:  [[ 8.43034517  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00057035 -0.04608485 -0.11331334]
Stock Position:  0.0005703452189204153
Bond Position:  [-0.46609681]


portfolio before change:  [-0.40841936]
curr_Stock_Price:  101.33159937340652
curr_Factors:  [101.33159937  -1.32929281  -0.89693936]
mat_Sqrt:  [[10.9371597   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00675521  0.04645994 -0.01540314]
Stock Position:  -0.00675521357976502
Bond Position:  [0.27609724]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.40470917]
Stock Price:  100.79258583980953
PL:  [-1.19729501]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-9.28058813e-02  1.72359117e-01  6.36072238e-03]
 [ 6.45940563e-03 -3.85792874e-03  4.81427264e-03]
 [ 1.04918146e-01 -4.41276133e-02  4.20984532e-02]
 [-1.39326289e-01 -1.06227972e-01  4.14501719e-01]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-1.08983885e+00  9.67890569e-01 -1.11509085e-01]
 [-1.42149152e-01 -8.07616926e-02 -1.22254063e-01]
 [ 1.24676647e-01 -1.33776116e-01  1.93999617e-02]
 [ 2.06250645e-02  2.70336391e-02  4.46115844e-02]
 [ 1.53486541e-01  1.18287450e-01  8.47949601e-02]
 [-9.30736462e-02 -2.20756525e-02 -2.24192138e-02]
 [-4.30415112e-02  1.47925259e-01  2.75779167e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-3.42695908e-02 -5.06551220e-02  1.34140545e-02]
 [-2.80619869e-02 -1.81315800e-01 -5.18284680e-02]
 [ 4.46355991e-02  3.57687958e-02 -4.81914238e-02]
 [ 1.20860988e-01 -5.08683284e-02  1.45921069e-01]
 [-7.16821834e-02  5.58064261e-02  7.19011085e-02]
 [ 7.63128766e-02 -1.23529798e-01 -2.58760062e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.12594439]
curr_Stock_Price:  99.06515785739546
curr_Factors:  [99.06515786 -0.96217736 -0.99043639]
mat_Sqrt:  [[14.05761222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00400672  0.05562867  0.01814537]
Stock Position:  -0.0040067150799936255
Bond Position:  [-4.72901852]


portfolio before change:  [-5.12585226]
curr_Stock_Price:  98.74705933783359
curr_Factors:  [98.74705934 -0.92932765 -0.95688695]
mat_Sqrt:  [[14.97447415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0004444  -0.00124514  0.01373378]
Stock Position:  0.0004443974754637547
Bond Position:  [-5.1697352]


portfolio before change:  [-5.12741006]
curr_Stock_Price:  98.15027235706543
curr_Factors:  [98.15027236 -1.18159717 -0.94557871]
mat_Sqrt:  [[11.69689954  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00893433 -0.01424213  0.12009517]
Stock Position:  0.008934328738284614
Bond Position:  [-6.00431686]


portfolio before change:  [-5.11736906]
curr_Stock_Price:  99.44217396308207
curr_Factors:  [99.44217396 -1.21825806 -0.98561614]
mat_Sqrt:  [[10.97590163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00696072 -0.03428493  1.18245803]
Stock Position:  -0.006960719636153583
Bond Position:  [-4.42517996]


portfolio before change:  [-5.10302825]
curr_Stock_Price:  97.22297213452984
curr_Factors:  [97.22297213 -1.07502008 -0.99673944]
mat_Sqrt:  [[12.24658969  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00463781 -0.04522423  0.24245377]
Stock Position:  0.004637812123616808
Bond Position:  [-5.55393013]


portfolio before change:  [-5.11064732]
curr_Stock_Price:  95.87957635682383
curr_Factors:  [95.87957636 -0.89896138 -0.94025587]
mat_Sqrt:  [[15.23927143  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06004426  0.31238534 -0.31810438]
Stock Position:  -0.060044255826227244
Bond Position:  [0.64637049]


portfolio before change:  [-5.06701194]
curr_Stock_Price:  95.15554760744945
curr_Factors:  [95.15554761 -0.70323854 -0.95492042]
mat_Sqrt:  [[18.12611885  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01012845 -0.02606572 -0.34875681]
Stock Position:  -0.01012845449708994
Bond Position:  [-4.10323331]


portfolio before change:  [-5.06479842]
curr_Stock_Price:  94.83571057722311
curr_Factors:  [94.83571058 -0.61706444 -0.89011349]
mat_Sqrt:  [[21.00936098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00482307 -0.04317606  0.05534269]
Stock Position:  0.004823074477549685
Bond Position:  [-5.52219812]


portfolio before change:  [-5.05987943]
curr_Stock_Price:  96.14187154252467
curr_Factors:  [96.14187154 -0.58765252 -0.92950367]
mat_Sqrt:  [[21.08725303  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00167161 0.00872507 0.12726443]
Stock Position:  0.0016716062776058285
Bond Position:  [-5.22059079]


portfolio before change:  [-5.06205392]
curr_Stock_Price:  95.6219081516117
curr_Factors:  [95.62190815 -0.48857516 -0.93155179]
mat_Sqrt:  [[23.11022158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00843525 0.03817711 0.24189642]
Stock Position:  0.008435252932219778
Bond Position:  [-5.8686489]


portfolio before change:  [-5.08016116]
curr_Stock_Price:  93.64924704923985
curr_Factors:  [93.64924705 -0.94379962 -0.93025963]
mat_Sqrt:  [[14.37509426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00710647 -0.00712489 -0.06395578]
Stock Position:  -0.007106466290434506
Bond Position:  [-4.41464594]


portfolio before change:  [-5.080516]
curr_Stock_Price:  93.5438564972974
curr_Factors:  [93.5438565  -1.04109597 -0.97010137]
mat_Sqrt:  [[12.51881903  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0005765   0.04774267  0.07867212]
Stock Position:  -0.000576498106292865
Bond Position:  [-5.02658815]


portfolio before change:  [-5.08145006]
curr_Stock_Price:  92.98400468245015
curr_Factors:  [92.98400468 -1.19578172 -0.95194874]
mat_Sqrt:  [[10.8557732   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00155319 -0.00995959  0.34984664]
Stock Position:  0.0015531941479839967
Bond Position:  [-5.22587227]


portfolio before change:  [-5.08097577]
curr_Stock_Price:  94.13061907837101
curr_Factors:  [94.13061908 -0.84480075 -0.98323059]
mat_Sqrt:  [[15.12958423  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00276752 -0.01634887  0.03826656]
Stock Position:  -0.002767517681983302
Bond Position:  [-4.82046762]


portfolio before change:  [-5.08635948]
curr_Stock_Price:  95.64043320719625
curr_Factors:  [95.64043321 -0.93620996 -1.0035831 ]
mat_Sqrt:  [[13.74675256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00550329 -0.05851942 -0.14785219]
Stock Position:  -0.0055032896738831
Bond Position:  [-4.56002247]


portfolio before change:  [-5.08363109]
curr_Stock_Price:  94.93748433609929
curr_Factors:  [94.93748434 -0.53292156 -1.00201882]
mat_Sqrt:  [[20.45604085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00205806  0.01154433 -0.13747672]
Stock Position:  0.0020580639747350355
Bond Position:  [-5.27901851]


portfolio before change:  [-5.08554877]
curr_Stock_Price:  94.64703775027577
curr_Factors:  [94.64703775 -0.55791206 -1.01861979]
mat_Sqrt:  [[19.56266169  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00716996 -0.01641768  0.41627219]
Stock Position:  0.007169962333298439
Bond Position:  [-5.76416447]


portfolio before change:  [-5.07920606]
curr_Stock_Price:  95.7326692057538
curr_Factors:  [95.73266921 -0.56622328 -1.02600174]
mat_Sqrt:  [[19.47895383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00234171  0.01801145  0.20511385]
Stock Position:  -0.0023417064637065105
Bond Position:  [-4.85502825]


portfolio before change:  [-5.08114512]
curr_Stock_Price:  96.04233931619152
curr_Factors:  [96.04233932 -0.67590519 -1.02380783]
mat_Sqrt:  [[17.5503889   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.81012072e-05 -3.98690709e-02 -7.38170432e-01]
Stock Position:  -9.81012071947754e-05
Bond Position:  [-5.07172325]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.08253471]
Stock Price:  97.28081584667531
PL:  [-5.08253471]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.32913778e-02  3.34053587e-02  3.74537704e-02]
 [ 3.60072022e-02  1.41928662e-01 -2.25932991e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-2.76216317e-01 -2.75128126e-01  1.11180883e+00]
 [ 6.90847151e-03 -7.64142279e-02  2.05170937e-02]
 [-1.01122733e+00  1.12555588e+00 -1.65551225e-01]
 [ 1.00307843e-02 -4.60868111e-03  2.75412835e-02]
 [-8.84247696e-02 -2.56824327e-02 -9.95146342e-03]
 [ 2.24759446e-02  2.26963156e-02  5.91924851e-02]
 [-5.28520791e-01  2.78565993e-01 -2.66548973e-01]
 [ 1.20915096e-01  3.47672400e-02 -5.31345439e-02]
 [-9.49673046e-02  1.20608204e-01  1.51482720e-01]
 [-1.59197049e-01 -1.30375877e-01  8.63572005e-03]
 [ 3.30569657e-02  5.40735937e-01 -3.35463124e-01]
 [ 4.38448102e-02 -1.36057735e-01 -5.00118672e-02]
 [ 5.83273190e-02  4.23558156e-02  1.44557186e-01]
 [-8.08439901e-02  1.61600291e-02  6.04715503e-02]
 [ 4.57972096e-02 -1.59624165e-01 -3.61335821e-02]
 [-1.11570095e-01  4.79143858e-02 -1.58646052e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.98612836]
curr_Stock_Price:  100.33990247484384
curr_Factors:  [100.33990247  -1.35584342  -1.00623631]
mat_Sqrt:  [[ 9.45443286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304908  0.01078153  0.10684518]
Stock Position:  -0.0030490796350802346
Bond Position:  [5.29207271]


portfolio before change:  [4.98755765]
curr_Stock_Price:  100.30510222807966
curr_Factors:  [100.30510223  -0.99017957  -0.96678676]
mat_Sqrt:  [[14.17174558  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00133081  0.04580728 -0.64452393]
Stock Position:  0.0013308092726156174
Bond Position:  [4.85407069]


portfolio before change:  [4.98881435]
curr_Stock_Price:  100.3374386606235
curr_Factors:  [100.33743866  -0.71335964  -1.00368098]
mat_Sqrt:  [[18.02028851  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00432972  0.01370813 -0.02999186]
Stock Position:  -0.004329716389145807
Bond Position:  [5.423247]


portfolio before change:  [4.98010186]
curr_Stock_Price:  102.66287259754799
curr_Factors:  [102.6628726   -0.91747413  -1.02203392]
mat_Sqrt:  [[14.7603198   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00714277 -0.08879722  3.17168113]
Stock Position:  -0.007142770868230244
Bond Position:  [5.71339924]


portfolio before change:  [4.97712616]
curr_Stock_Price:  103.27947248448305
curr_Factors:  [103.27947248  -1.0026465   -1.04263101]
mat_Sqrt:  [[13.35861009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033697 -0.02466259  0.05852956]
Stock Position:  -0.00033697242493147385
Bond Position:  [5.01192849]


portfolio before change:  [4.97835913]
curr_Stock_Price:  103.33933179392004
curr_Factors:  [103.33933179  -1.28258712  -1.03275872]
mat_Sqrt:  [[10.20290227  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07990542  0.3632716  -0.47227157]
Stock Position:  -0.0799054209645579
Bond Position:  [13.23573194]


portfolio before change:  [5.0744639]
curr_Stock_Price:  102.17801606836775
curr_Factors:  [102.17801607  -1.32124809  -1.05885926]
mat_Sqrt:  [[ 9.45561932  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00155589 -0.00148745  0.07856762]
Stock Position:  0.0015558877440936048
Bond Position:  [4.91548637]


portfolio before change:  [5.07557245]
curr_Stock_Price:  102.10058698736093
curr_Factors:  [102.10058699  -1.09836245  -1.04151101]
mat_Sqrt:  [[12.01414867  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00796548 -0.00828897 -0.02838876]
Stock Position:  -0.007965483933922313
Bond Position:  [5.88885304]


portfolio before change:  [5.08106091]
curr_Stock_Price:  101.59640386818617
curr_Factors:  [101.59640387  -1.01410605  -1.02134803]
mat_Sqrt:  [[13.27063973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00295324 0.0073252  0.16885968]
Stock Position:  0.002953243162428099
Bond Position:  [4.78102203]


portfolio before change:  [5.08466532]
curr_Stock_Price:  102.41211980937936
curr_Factors:  [102.41211981  -1.20459205  -1.07691338]
mat_Sqrt:  [[10.45938477  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05029625  0.08990679 -0.76039003]
Stock Position:  -0.050296249647946246
Bond Position:  [10.23561087]


portfolio before change:  [5.10007283]
curr_Stock_Price:  102.15666757455561
curr_Factors:  [102.15666757  -1.31020633  -1.10255428]
mat_Sqrt:  [[ 9.14993693  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0128051   0.01122108 -0.15157806]
Stock Position:  0.012805103062581404
Bond Position:  [3.79194618]


portfolio before change:  [5.108142]
curr_Stock_Price:  102.71277893117166
curr_Factors:  [102.71277893  -1.35640054  -1.11653717]
mat_Sqrt:  [[ 8.66246065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00455148  0.03892613  0.43213804]
Stock Position:  -0.004551475491915477
Bond Position:  [5.5756367]


portfolio before change:  [5.11274407]
curr_Stock_Price:  102.00795572260985
curr_Factors:  [102.00795572  -1.52972097  -1.11726394]
mat_Sqrt:  [[ 7.22874838  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02546045 -0.04207863  0.02463531]
Stock Position:  -0.025460445502213085
Bond Position:  [7.70991207]


portfolio before change:  [5.13264285]
curr_Stock_Price:  101.30211328800955
curr_Factors:  [101.30211329  -1.18664931  -1.15690327]
mat_Sqrt:  [[ 9.72358803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00770889  0.17452177 -0.95698292]
Stock Position:  0.007708893367002874
Bond Position:  [4.35171566]


portfolio before change:  [5.13754489]
curr_Stock_Price:  101.79686229853299
curr_Factors:  [101.7968623   -0.91858067  -1.15567677]
mat_Sqrt:  [[12.7907448   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00045842 -0.04391245 -0.14266994]
Stock Position:  0.0004584183151819292
Bond Position:  [5.09087934]


portfolio before change:  [5.13876204]
curr_Stock_Price:  101.6753034748532
curr_Factors:  [101.67530347  -1.20496146  -1.15097882]
mat_Sqrt:  [[ 9.63925812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01000915 0.01367028 0.41238141]
Stock Position:  0.01000914950833797
Bond Position:  [4.12107873]


portfolio before change:  [5.13838972]
curr_Stock_Price:  101.53515958424252
curr_Factors:  [101.53515958  -1.21405082  -1.17384552]
mat_Sqrt:  [[ 9.32322689  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00699346  0.00521563  0.1725085 ]
Stock Position:  -0.006993462157628873
Bond Position:  [5.84847201]


portfolio before change:  [5.13787947]
curr_Stock_Price:  101.817216147533
curr_Factors:  [101.81721615  -1.13075237  -1.14672404]
mat_Sqrt:  [[10.44060786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00055919 -0.05151848 -0.10307905]
Stock Position:  0.0005591941416662776
Bond Position:  [5.08094388]


portfolio before change:  [5.13878085]
curr_Stock_Price:  101.15730900581777
curr_Factors:  [101.15730901  -1.10127807  -1.18401551]
mat_Sqrt:  [[10.29216822  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01020465  0.0154643  -0.0452573 ]
Stock Position:  -0.0102046486878716
Bond Position:  [6.17105565]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.14051553]
Stock Price:  101.13852042920774
PL:  [4.0019951]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-2.46099197e-02  1.06023025e-02  4.15096373e-02]
 [ 2.14578398e-02  7.88187075e-02 -3.59848286e-02]
 [-8.44860211e-02  4.23946627e-02 -1.04878906e-02]
 [-1.66568591e-01 -1.34324733e-01  6.62250375e-01]
 [ 1.04707998e-02 -5.51172226e-02  2.77371979e-02]
 [-9.56690590e-01  1.04270002e+00 -1.49035091e-01]
 [ 9.80195990e-03 -3.90939452e-03  2.62627102e-02]
 [-9.21683959e-02 -1.47349720e-02 -3.19778862e-02]
 [-9.94778015e-02  1.33761202e-02  5.14409347e-02]
 [-6.82512084e-01  3.09868985e-01 -3.51754249e-01]
 [ 1.23204938e-01  3.60938012e-02 -5.33705607e-02]
 [-1.85303910e-01  7.30840381e-02  3.67043015e-01]
 [-1.28470474e-01 -1.35873316e-01 -5.90193729e-03]
 [ 4.70351528e-02  7.49465066e-01 -4.06103397e-01]
 [ 1.26356773e-01 -6.07755968e-02 -2.43316426e-02]
 [ 3.40159165e-02 -2.31541118e-02  4.44933282e-02]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.53023522e-02 -1.64304438e-01 -3.78804777e-02]
 [-1.32395724e-01  5.36121458e-02 -1.01716679e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.0106597]
curr_Stock_Price:  100.7211798994274
curr_Factors:  [100.7211799   -1.38572884  -1.02478549]
mat_Sqrt:  [[ 9.04165086  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154536  0.00342188  0.11841544]
Stock Position:  -0.0015453609883866524
Bond Position:  [8.16631028]


portfolio before change:  [8.01345461]
curr_Stock_Price:  100.23386453494413
curr_Factors:  [100.23386453  -1.43805692  -1.00919528]
mat_Sqrt:  [[ 8.67333953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00348208  0.02543863 -0.1026547 ]
Stock Position:  0.003482080755058423
Bond Position:  [7.6644322]


portfolio before change:  [8.01631253]
curr_Stock_Price:  100.50426823919831
curr_Factors:  [100.50426824  -1.34526324  -1.01552895]
mat_Sqrt:  [[ 9.4821208   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00822317  0.01368282 -0.02991903]
Stock Position:  -0.008223168652262053
Bond Position:  [8.84277608]


portfolio before change:  [8.01170104]
curr_Stock_Price:  101.333931466045
curr_Factors:  [101.33393147  -1.27162767  -1.05674918]
mat_Sqrt:  [[ 9.87537682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00595483 -0.04335312  1.88921598]
Stock Position:  -0.005954833128903596
Bond Position:  [8.61512769]


portfolio before change:  [8.00556548]
curr_Stock_Price:  102.72601170975656
curr_Factors:  [102.72601171  -1.2935531   -1.09820863]
mat_Sqrt:  [[ 9.39618378  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00051956 -0.01778901  0.07912651]
Stock Position:  0.0005195594104766499
Bond Position:  [7.95219322]


portfolio before change:  [8.00741258]
curr_Stock_Price:  102.45425073564341
curr_Factors:  [102.45425074  -1.45613831  -1.08344263]
mat_Sqrt:  [[ 8.08358467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09578325  0.33652999 -0.42515563]
Stock Position:  -0.09578324853011916
Bond Position:  [17.82081354]


portfolio before change:  [8.02657412]
curr_Stock_Price:  102.30071893356545
curr_Factors:  [102.30071893  -1.50085535  -1.11859893]
mat_Sqrt:  [[ 7.4518507   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00192768 -0.00126175  0.0749202 ]
Stock Position:  0.001927683729654988
Bond Position:  [7.82937069]


portfolio before change:  [8.02878649]
curr_Stock_Price:  102.43289157180381
curr_Factors:  [102.43289157  -1.89033155  -1.13793038]
mat_Sqrt:  [[ 4.95771991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02051419 -0.00475569 -0.09122401]
Stock Position:  -0.020514192017499364
Bond Position:  [10.1301145]


portfolio before change:  [8.03088736]
curr_Stock_Price:  102.45394910595088
curr_Factors:  [102.45394911  -1.6018328   -1.13475861]
mat_Sqrt:  [[ 6.63807501  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01299278  0.00431712  0.14674667]
Stock Position:  -0.012992784111932243
Bond Position:  [9.3620494]


portfolio before change:  [8.02640372]
curr_Stock_Price:  102.9791976711856
curr_Factors:  [102.97919767  -1.94422491  -1.13170295]
mat_Sqrt:  [[ 4.75215949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.1454206   0.10000978 -1.00345696]
Stock Position:  -0.1454205987989217
Bond Position:  [23.00170031]


portfolio before change:  [8.07227088]
curr_Stock_Price:  102.70333571040915
curr_Factors:  [102.70333571  -1.77473817  -1.14263877]
mat_Sqrt:  [[ 5.55371828  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02154923  0.01164922 -0.15225135]
Stock Position:  0.02154922665216287
Bond Position:  [5.85909342]


portfolio before change:  [8.07801376]
curr_Stock_Price:  102.9018545075814
curr_Factors:  [102.90185451  -2.13182136  -1.16760503]
mat_Sqrt:  [[ 3.79752399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02513831  0.02358777  1.04707156]
Stock Position:  -0.025138314306130168
Bond Position:  [10.66479292]


portfolio before change:  [8.07380853]
curr_Stock_Price:  103.17521270747498
curr_Factors:  [103.17521271  -1.95863765  -1.18490176]
mat_Sqrt:  [[ 4.44993383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03537361 -0.04385292 -0.01683658]
Stock Position:  -0.03537361068052575
Bond Position:  [11.72348834]


portfolio before change:  [8.08095054]
curr_Stock_Price:  103.05617551638355
curr_Factors:  [103.05617552  -1.89866516  -1.16353875]
mat_Sqrt:  [[ 4.82142884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02429229  0.24188881 -1.15849995]
Stock Position:  0.02429229261679238
Bond Position:  [5.57747977]


portfolio before change:  [8.08250714]
curr_Stock_Price:  103.06284638052699
curr_Factors:  [103.06284638  -1.82505793  -1.09796887]
mat_Sqrt:  [[ 5.54176015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01966601 -0.01961524 -0.0694114 ]
Stock Position:  0.019666013520950782
Bond Position:  [6.05567181]


portfolio before change:  [8.09085677]
curr_Stock_Price:  103.41042711926539
curr_Factors:  [103.41042712  -1.6973985   -1.09514125]
mat_Sqrt:  [[ 6.33548299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00605664 -0.00747296  0.12692708]
Stock Position:  0.006056644122647839
Bond Position:  [7.46453662]


portfolio before change:  [8.08945302]
curr_Stock_Price:  102.87050386607812
curr_Factors:  [102.87050387  -1.34841068  -1.11476396]
mat_Sqrt:  [[ 8.76087961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00785193  0.00525786  0.16709793]
Stock Position:  -0.00785193028548876
Bond Position:  [8.89718504]


portfolio before change:  [8.09299775]
curr_Stock_Price:  102.70237263962127
curr_Factors:  [102.70237264  -1.01138832  -1.1435746 ]
mat_Sqrt:  [[11.90397402  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00033867 -0.05302903 -0.10806246]
Stock Position:  0.00033867086706781117
Bond Position:  [8.05821544]


portfolio before change:  [8.09484431]
curr_Stock_Price:  102.20561015179393
curr_Factors:  [102.20561015  -0.87942403  -1.14413867]
mat_Sqrt:  [[13.50991507  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00914354  0.01730325 -0.02901694]
Stock Position:  -0.009143541826995236
Bond Position:  [9.02936558]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.10913149]
Stock Price:  100.88997668290642
PL:  [7.2191548]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-6.23776867e-02  1.27565730e-01  2.06228452e-02]
 [ 3.24173857e-02  1.02195526e-01 -1.63606960e-01]
 [ 8.94364008e-02 -5.55561309e-02 -1.03445413e-02]
 [-7.38312304e-02 -1.77622212e-02  2.77113175e-01]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-7.47664167e-01  7.55854184e-01 -8.72372363e-02]
 [ 1.12462378e-02 -8.32310224e-03  3.43327193e-02]
 [-9.28762332e-02 -2.00489171e-02 -2.03275299e-02]
 [ 6.59984380e-02  2.80977258e-02  6.13593138e-02]
 [ 8.45848366e-02  1.42335611e-01  5.95074662e-02]
 [ 2.31046619e-02  3.23857369e-02 -5.33645902e-02]
 [ 3.07755059e-02  3.50382063e-02 -1.59558118e-02]
 [ 3.74191112e-02 -6.00217884e-02 -8.14343035e-02]
 [ 1.73600311e-02  6.43068845e-01 -4.29242957e-01]
 [ 1.02506547e-01 -6.03756082e-02 -4.15728677e-02]
 [ 3.93109475e-02  3.44473923e-03  2.31895377e-02]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 3.74057289e-02 -1.36242072e-01 -4.44177556e-02]
 [-1.58604980e-01  1.05627859e-02 -5.45596802e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.82763949]
curr_Stock_Price:  99.48094762921694
curr_Factors:  [99.48094763 -1.07001896 -0.98542121]
mat_Sqrt:  [[12.73718891  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252244  0.04117166  0.05883124]
Stock Position:  -0.0025224420117385808
Bond Position:  [-1.57670456]


portfolio before change:  [-1.82921409]
curr_Stock_Price:  99.94889928291404
curr_Factors:  [99.94889928 -1.06246232 -0.9892312 ]
mat_Sqrt:  [[12.84514002  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00154781  0.03298346 -0.46672512]
Stock Position:  0.0015478094570766314
Bond Position:  [-1.98391594]


portfolio before change:  [-1.83179063]
curr_Stock_Price:  98.60474253914809
curr_Factors:  [98.60474254 -1.13333629 -0.92754111]
mat_Sqrt:  [[12.55654405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00605139 -0.01793066 -0.0295101 ]
Stock Position:  0.006051385004024986
Bond Position:  [-2.42848589]


portfolio before change:  [-1.82433737]
curr_Stock_Price:  99.93674461025066
curr_Factors:  [99.93674461 -1.54572235 -0.90254998]
mat_Sqrt:  [[ 8.63881229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00241832 -0.00573273  0.79052676]
Stock Position:  -0.0024183230128006204
Bond Position:  [-1.58265804]


portfolio before change:  [-1.82595948]
curr_Stock_Price:  100.44387023276784
curr_Factors:  [100.44387023  -1.60198983  -0.94307627]
mat_Sqrt:  [[ 7.88161607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00720631 -0.04522423  0.24245377]
Stock Position:  0.007206311698477693
Bond Position:  [-2.54978932]


portfolio before change:  [-1.82370466]
curr_Stock_Price:  100.8452324251031
curr_Factors:  [100.84523243  -1.53090283  -0.95356757]
mat_Sqrt:  [[ 8.4074363   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07269556  0.24395089 -0.24886355]
Stock Position:  -0.07269556167238958
Bond Position:  [5.50729615]


portfolio before change:  [-1.84497383]
curr_Stock_Price:  101.15675292926136
curr_Factors:  [101.15675293  -1.36665037  -1.00577703]
mat_Sqrt:  [[ 9.43328059  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.001755   -0.00268627  0.09794169]
Stock Position:  0.0017550022523407974
Bond Position:  [-2.02250416]


portfolio before change:  [-1.84613834]
curr_Stock_Price:  100.78135527894376
curr_Factors:  [100.78135528  -1.36357515  -0.98841233]
mat_Sqrt:  [[ 9.59234979  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01054153 -0.00647076 -0.05798878]
Stock Position:  -0.01054152977543889
Bond Position:  [-0.78374868]


portfolio before change:  [-1.84409178]
curr_Stock_Price:  100.56862301075698
curr_Factors:  [100.56862301  -1.22147819  -0.97925301]
mat_Sqrt:  [[11.13517607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0075669  0.0090685  0.17504104]
Stock Position:  0.007566901434385925
Bond Position:  [-2.60508464]


portfolio before change:  [-1.85289641]
curr_Stock_Price:  99.49113061732558
curr_Factors:  [99.49113062 -0.86659747 -0.94872682]
mat_Sqrt:  [[16.19567462  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00776663 0.04593862 0.16975824]
Stock Position:  0.007766634309633751
Bond Position:  [-2.62560764]


portfolio before change:  [-1.85226087]
curr_Stock_Price:  99.6574864980888
curr_Factors:  [99.6574865  -0.52256677 -0.88930146]
mat_Sqrt:  [[24.28529314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00077505  0.01045245 -0.15223432]
Stock Position:  0.000775052262790016
Bond Position:  [-1.92950063]


portfolio before change:  [-1.85022942]
curr_Stock_Price:  102.90099397152785
curr_Factors:  [102.90099397  -0.6066123   -0.9282697 ]
mat_Sqrt:  [[22.17322125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00156363  0.01130853 -0.04551749]
Stock Position:  0.0015636286195463284
Bond Position:  [-2.01112835]


portfolio before change:  [-1.85072154]
curr_Stock_Price:  102.907847344395
curr_Factors:  [102.90784734  -0.74350854  -0.95793512]
mat_Sqrt:  [[18.77244754  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00045516 -0.01937195 -0.2323094 ]
Stock Position:  0.00045516213818374277
Bond Position:  [-1.8975613]


portfolio before change:  [-1.85152072]
curr_Stock_Price:  102.19440873031954
curr_Factors:  [102.19440873  -0.74363119  -0.94044801]
mat_Sqrt:  [[18.96884247  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00321617  0.20754958 -1.22451068]
Stock Position:  0.003216171880568853
Bond Position:  [-2.18019551]


portfolio before change:  [-1.84796737]
curr_Stock_Price:  103.46874008676114
curr_Factors:  [103.46874009  -0.74237022  -0.89968002]
mat_Sqrt:  [[20.02976266  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00407875 -0.01948614 -0.11859582]
Stock Position:  0.00407875037311124
Bond Position:  [-2.26999053]


portfolio before change:  [-1.84953461]
curr_Stock_Price:  103.22364894799232
curr_Factors:  [103.22364895  -0.77974272  -0.88547285]
mat_Sqrt:  [[19.52474075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00229184 0.00111178 0.0661533 ]
Stock Position:  0.0022918433116559072
Bond Position:  [-2.08610704]


portfolio before change:  [-1.84947248]
curr_Stock_Price:  103.47834144682717
curr_Factors:  [103.47834145  -0.22710155  -0.88171117]
mat_Sqrt:  [[34.14272785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00201477  0.00525786  0.16709793]
Stock Position:  -0.0020147721126820774
Bond Position:  [-1.64098721]


portfolio before change:  [-1.85356105]
curr_Stock_Price:  105.30399344325659
curr_Factors:  [105.30399344  -0.33113716  -0.89431322]
mat_Sqrt:  [[30.9199303   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.70988760e-05 -4.39719396e-02 -1.26711493e-01]
Stock Position:  1.7098875976233713e-05
Bond Position:  [-1.85536163]


portfolio before change:  [-1.85400728]
curr_Stock_Price:  106.33729801297275
curr_Factors:  [ 1.06337298e+02  4.60786426e-02 -9.25615087e-01]
mat_Sqrt:  [[44.12734482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00379778  0.00340912 -0.15564358]
Stock Position:  -0.0037977768535785252
Bond Position:  [-1.45016195]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.86113075]
Stock Price:  108.11751806757368
PL:  [-9.97864882]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-2.00219746e-02  5.31286901e-03  4.23784063e-02]
 [ 1.94874029e-02  4.09810588e-02 -5.94094967e-02]
 [ 1.18497835e-01 -3.21323366e-02  7.94745438e-02]
 [-3.36945501e-02  5.48150202e-03  1.43825669e-01]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-8.99869748e-01  8.15097675e-01 -8.42828187e-02]
 [-2.56817997e-03  1.83654875e-02 -9.21335676e-03]
 [-5.50845410e-02  1.39279376e-02 -5.21293802e-02]
 [ 1.62679520e-01  2.20866149e-02  3.22655333e-02]
 [ 1.06027037e-01  1.32744050e-01  6.54248519e-02]
 [ 1.23743468e-01  3.23284316e-02 -5.27523488e-02]
 [-8.34385693e-02  1.26673226e-01  1.23972968e-01]
 [-1.80214050e-01 -1.21184951e-01  3.66708280e-02]
 [ 5.66942029e-02  5.37930859e-01 -2.30334095e-01]
 [ 3.83757195e-02 -1.34577496e-01 -5.21824107e-02]
 [ 7.35034370e-02  5.07823168e-02  2.89097256e-01]
 [-4.25249985e-02  1.58800670e-02  8.00537768e-02]
 [ 4.90165726e-02 -1.54572540e-01 -3.10780638e-02]
 [-9.82301814e-02  2.05235421e-01 -1.42088109e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.89348153]
curr_Stock_Price:  100.45428491726783
curr_Factors:  [100.45428492  -1.03929565  -0.98372492]
mat_Sqrt:  [[13.28561897  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007743   0.00171472  0.1208938 ]
Stock Position:  -0.0007742984230190042
Bond Position:  [5.97126313]


portfolio before change:  [5.89583662]
curr_Stock_Price:  99.34091042725035
curr_Factors:  [99.34091043 -1.09948586 -0.92744304]
mat_Sqrt:  [[13.08712041  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120162  0.01322658 -0.16947876]
Stock Position:  0.0012016175651541506
Bond Position:  [5.77646684]


portfolio before change:  [5.89538279]
curr_Stock_Price:  97.76126878436456
curr_Factors:  [97.76126878 -1.15571156 -0.94018004]
mat_Sqrt:  [[12.02078064  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01066166 -0.01037067  0.22671875]
Stock Position:  0.010661663853161585
Bond Position:  [4.85308501]


portfolio before change:  [5.90633885]
curr_Stock_Price:  98.67506914414147
curr_Factors:  [98.67506914 -1.38949944 -0.99010909]
mat_Sqrt:  [[ 9.13601043  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.52161522e-04  1.76914717e-03  4.10294601e-01]
Stock Position:  -0.00035216152195982565
Bond Position:  [5.94108841]


portfolio before change:  [5.90815115]
curr_Stock_Price:  97.74697024384905
curr_Factors:  [97.74697024 -1.24950314 -1.00141518]
mat_Sqrt:  [[10.29299832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00551806 -0.04522423  0.24245377]
Stock Position:  0.005518059980743453
Bond Position:  [5.3687775]


portfolio before change:  [5.90685192]
curr_Stock_Price:  97.26825279799858
curr_Factors:  [97.2682528  -1.43436876 -1.03340058]
mat_Sqrt:  [[ 8.24579453  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09103947  0.26307164 -0.24043542]
Stock Position:  -0.09103947318814136
Bond Position:  [14.76210241]


portfolio before change:  [5.85861435]
curr_Stock_Price:  97.83864883309406
curr_Factors:  [97.83864883 -1.88557931 -1.06231699]
mat_Sqrt:  [[ 5.13163015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00013641  0.00592744 -0.02628314]
Stock Position:  -0.00013641066745610517
Bond Position:  [5.87196058]


portfolio before change:  [5.86004269]
curr_Stock_Price:  98.13062118531492
curr_Factors:  [98.13062119 -1.79300912 -1.06587987]
mat_Sqrt:  [[ 5.62606617  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01117697  0.00449522 -0.14871061]
Stock Position:  -0.011176970893884065
Bond Position:  [6.95684579]


portfolio before change:  [5.86045825]
curr_Stock_Price:  98.2490672526898
curr_Factors:  [98.24906725 -1.65034569 -1.07889621]
mat_Sqrt:  [[ 6.41259387  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02709888 0.00712842 0.09204459]
Stock Position:  0.027098879113092042
Bond Position:  [3.19801866]


portfolio before change:  [5.8781834]
curr_Stock_Price:  98.87365193617867
curr_Factors:  [98.87365194 -1.94034843 -1.09600308]
mat_Sqrt:  [[ 4.74689767  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03085765 0.04284296 0.18663889]
Stock Position:  0.03085764751801205
Bond Position:  [2.8271751]


portfolio before change:  [5.868651]
curr_Stock_Price:  98.54182873097477
curr_Factors:  [98.54182873 -1.85678658 -1.07717008]
mat_Sqrt:  [[ 5.24106358  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02281492  0.01043396 -0.15048777]
Stock Position:  0.0228149214216565
Bond Position:  [3.62042692]


portfolio before change:  [5.86733685]
curr_Stock_Price:  98.4445515209305
curr_Factors:  [98.44455152 -1.29727469 -1.09595405]
mat_Sqrt:  [[ 8.99136546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00358962  0.04088361  0.35366037]
Stock Position:  -0.0035896248690082642
Bond Position:  [6.22071586]


portfolio before change:  [5.86629524]
curr_Stock_Price:  99.1680196848706
curr_Factors:  [99.16801968 -1.55720755 -1.09020699]
mat_Sqrt:  [[ 7.02447895  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02811104 -0.03911227  0.10461167]
Stock Position:  -0.028111042054037166
Bond Position:  [8.65401162]


portfolio before change:  [5.85592242]
curr_Stock_Price:  99.61398684768687
curr_Factors:  [99.61398685 -1.92217459 -1.05508056]
mat_Sqrt:  [[ 5.07358382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02354985  0.17361644 -0.65707906]
Stock Position:  0.023549848347742913
Bond Position:  [3.51002813]


portfolio before change:  [5.87691547]
curr_Stock_Price:  100.4681511731322
curr_Factors:  [100.46815117  -2.03290717  -1.04478632]
mat_Sqrt:  [[ 4.62810402  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.47768986e-05 -4.34347000e-02 -1.48861893e-01]
Stock Position:  5.477689862967797e-05
Bond Position:  [5.87141214]


portfolio before change:  [5.87837698]
curr_Stock_Price:  100.34898136339906
curr_Factors:  [100.34898136  -1.89944797  -1.06599066]
mat_Sqrt:  [[ 5.17177157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0276271  0.01638992 0.824714  ]
Stock Position:  0.027627102722215174
Bond Position:  [3.10602537]


portfolio before change:  [5.88875073]
curr_Stock_Price:  100.69636297331903
curr_Factors:  [100.69636297  -1.50045173  -1.08012828]
mat_Sqrt:  [[ 7.62574232  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300857  0.00512527  0.22837114]
Stock Position:  -0.0030085706669758273
Bond Position:  [6.19170286]


portfolio before change:  [5.89270599]
curr_Stock_Price:  99.89626907264679
curr_Factors:  [99.89626907 -1.58986469 -1.0866224 ]
mat_Sqrt:  [[ 6.87330626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00161797 -0.04988807 -0.08865707]
Stock Position:  0.0016179697691945214
Bond Position:  [5.73107685]


portfolio before change:  [5.89396255]
curr_Stock_Price:  99.78724824568621
curr_Factors:  [99.78724825 -1.72635812 -1.04632255]
mat_Sqrt:  [[ 6.23612961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00949901  0.06623945 -0.04053378]
Stock Position:  -0.009499006840356409
Bond Position:  [6.8418423]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.89005722]
Stock Price:  100.37846817530144
PL:  [5.51158904]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 1.75082379e-02 -3.52136919e-02  4.38814347e-02]
 [ 3.94856198e-02  1.85263126e-01 -2.57363926e-01]
 [ 5.55638205e-02 -3.73901039e-02 -3.58396299e-02]
 [-2.78984112e-01 -2.91420344e-01  8.36703957e-01]
 [-2.72577767e-02  5.80892416e-04 -9.77699969e-03]
 [-1.26976584e+00  1.30601793e+00 -1.88447489e-01]
 [ 5.12518702e-03  1.21790878e-03  1.99873049e-02]
 [-9.31262990e-02 -2.19262354e-02 -1.62116749e-02]
 [ 2.68164202e-02  2.41203870e-02  5.91527994e-02]
 [-1.86959916e-01  1.99606775e-01 -8.83866626e-02]
 [ 1.19405492e-01  3.22493421e-02 -5.27074096e-02]
 [-1.16176093e-01  1.09450712e-01  2.02090917e-01]
 [-1.88358871e-01 -1.33976950e-01  4.03525198e-02]
 [ 3.19626217e-02  6.21329188e-01 -3.77980321e-01]
 [ 1.76023932e-02 -1.74090904e-01 -5.36639320e-02]
 [ 5.58481910e-02  2.57105164e-02  1.53121898e-01]
 [-5.48387531e-02  1.57786427e-02  7.42020079e-02]
 [ 4.30478228e-02 -1.47799409e-01 -3.89496394e-02]
 [-1.11438602e-01  8.54263062e-02 -9.96760830e-04]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.70572639]
curr_Stock_Price:  101.18698611879731
curr_Factors:  [101.18698612  -0.9653912   -1.01799471]
mat_Sqrt:  [[13.9235862   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138452 -0.01136517  0.12518152]
Stock Position:  0.001384523584867652
Bond Position:  [11.56563062]


portfolio before change:  [11.7079356]
curr_Stock_Price:  100.69399211706963
curr_Factors:  [100.69399212  -0.81351203  -1.0055829 ]
mat_Sqrt:  [[16.32979251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00151674  0.05979342 -0.73418765]
Stock Position:  0.0015167434325673028
Bond Position:  [11.55520865]


portfolio before change:  [11.70886314]
curr_Stock_Price:  99.40067988925632
curr_Factors:  [99.40067989 -0.5567375  -0.96575758]
mat_Sqrt:  [[21.68593459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00187291 -0.0120676  -0.10224049]
Stock Position:  0.0018729127660222923
Bond Position:  [11.52269434]


portfolio before change:  [11.71216018]
curr_Stock_Price:  99.6227970594258
curr_Factors:  [99.62279706 -0.59604563 -0.94632173]
mat_Sqrt:  [[21.30674448  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00786974 -0.09405551  2.3868835 ]
Stock Position:  -0.007869740991329026
Bond Position:  [12.49616579]


portfolio before change:  [11.70199683]
curr_Stock_Price:  101.31126172827717
curr_Factors:  [101.31126173  -0.730658    -0.95098563]
mat_Sqrt:  [[18.8507734   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154556  0.00018748 -0.02789106]
Stock Position:  -0.00154555590955018
Bond Position:  [11.85857905]


portfolio before change:  [11.70575868]
curr_Stock_Price:  100.79569543071354
curr_Factors:  [100.79569543  -0.44650799  -0.94345134]
mat_Sqrt:  [[25.10673946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04148857  0.42151547 -0.53758823]
Stock Position:  -0.04148857062877785
Bond Position:  [15.88762801]


portfolio before change:  [11.72967431]
curr_Stock_Price:  100.31500332097262
curr_Factors:  [100.31500332  -1.24983691  -0.95704678]
mat_Sqrt:  [[11.03896823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00085639 0.00039308 0.05701822]
Stock Position:  0.0008563919156467856
Bond Position:  [11.64376536]


portfolio before change:  [11.73243015]
curr_Stock_Price:  100.13346181035838
curr_Factors:  [100.13346181  -1.34328152  -1.00277054]
mat_Sqrt:  [[ 9.5874203   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01052537 -0.00707666 -0.0462474 ]
Stock Position:  -0.010525372227709657
Bond Position:  [12.78637211]


portfolio before change:  [11.72933035]
curr_Stock_Price:  100.73171073553952
curr_Factors:  [100.73171074  -1.45149379  -1.00927027]
mat_Sqrt:  [[ 8.59943572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00509504 0.00778482 0.16874647]
Stock Position:  0.0050950422417308724
Bond Position:  [11.21609803]


portfolio before change:  [11.7318658]
curr_Stock_Price:  100.67892991665637
curr_Factors:  [100.67892992  -1.6995037   -0.99802382]
mat_Sqrt:  [[ 6.78292905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02421626  0.06442281 -0.25214255]
Stock Position:  -0.024216264705127978
Bond Position:  [14.16993342]


portfolio before change:  [11.74092546]
curr_Stock_Price:  100.45111895414404
curr_Factors:  [100.45111895  -1.52857572  -0.981626  ]
mat_Sqrt:  [[ 8.16183902  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01411808  0.01040843 -0.15035957]
Stock Position:  0.014118081254926697
Bond Position:  [10.3227484]


portfolio before change:  [11.74977403]
curr_Stock_Price:  100.89505727321047
curr_Factors:  [100.89505727  -1.63316959  -0.97416048]
mat_Sqrt:  [[ 7.43910739  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00706845  0.03532507  0.57650913]
Stock Position:  -0.007068445418649093
Bond Position:  [12.46294523]


portfolio before change:  [11.75114587]
curr_Stock_Price:  101.14182748494812
curr_Factors:  [101.14182748  -1.60323458  -0.95587024]
mat_Sqrt:  [[ 7.82574503  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0265112  -0.04324087  0.11511451]
Stock Position:  -0.026511198222730938
Bond Position:  [14.43253691]


portfolio before change:  [11.76198923]
curr_Stock_Price:  100.86893250382413
curr_Factors:  [100.8689325   -1.37567707  -0.9417773 ]
mat_Sqrt:  [[ 9.938018    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00821452  0.20053313 -1.07827265]
Stock Position:  0.00821451532361224
Bond Position:  [10.93339984]


portfolio before change:  [11.76525076]
curr_Stock_Price:  100.93318881319793
curr_Factors:  [100.93318881  -1.28439079  -0.95970688]
mat_Sqrt:  [[10.70125617  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00269948 -0.0561876  -0.15308826]
Stock Position:  -0.002699483838554312
Bond Position:  [12.03771827]


portfolio before change:  [11.76580578]
curr_Stock_Price:  101.8425422422348
curr_Factors:  [101.84254224  -1.30330984  -0.93138477]
mat_Sqrt:  [[10.89967867  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00847293 0.00829803 0.43681415]
Stock Position:  0.008472929106932519
Bond Position:  [10.90290114]


portfolio before change:  [11.76041358]
curr_Stock_Price:  100.88440045221238
curr_Factors:  [100.88440045  -1.54862207  -0.93091602]
mat_Sqrt:  [[ 8.45228833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00431499  0.00509254  0.21167767]
Stock Position:  -0.004314988832795924
Bond Position:  [12.19572864]


portfolio before change:  [11.76003909]
curr_Stock_Price:  101.67786772006329
curr_Factors:  [101.67786772  -1.56683027  -0.96541867]
mat_Sqrt:  [[ 8.0813643   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00060978 -0.04770205 -0.11111248]
Stock Position:  0.0006097773555490602
Bond Position:  [11.69803822]


portfolio before change:  [11.76262385]
curr_Stock_Price:  101.12011155720101
curr_Factors:  [101.12011156  -1.13592     -0.99785834]
mat_Sqrt:  [[11.9715224   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00786905  0.02757122 -0.00284348]
Stock Position:  -0.007869048780729263
Bond Position:  [12.55834294]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.76745904]
Stock Price:  100.9046846580999
PL:  [10.86277438]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 5.85757230e-03 -2.40086340e-02  4.52673079e-02]
 [ 3.36698726e-02  1.72063854e-01 -2.31920692e-01]
 [-6.78287811e-02 -4.06549182e-02 -6.20428305e-02]
 [-3.24038374e-01 -3.46851216e-01  1.07576816e+00]
 [-4.97020319e-02  3.37149999e-02 -3.20937236e-02]
 [-1.45491683e+00  1.48445203e+00 -2.19090905e-01]
 [ 4.26319768e-04  1.30023864e-02 -6.88513589e-04]
 [-2.17707617e-02  4.59282638e-02 -8.49643085e-02]
 [ 3.46425554e-02  2.65897369e-02  4.27796883e-02]
 [ 1.54257633e-01  1.14831025e-01  8.28961826e-02]
 [-1.24305889e-01 -8.86100138e-02 -4.17452660e-03]
 [ 7.61840880e-02  1.56096807e-02 -2.49460139e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-2.14257748e-02  2.98788110e-02 -5.69561854e-02]
 [-4.97836225e-02 -1.29175560e-01 -6.76532498e-02]
 [ 5.11125849e-02  8.98148700e-02 -1.69469853e-01]
 [ 2.16941635e-01 -3.56348650e-01  2.15537453e-01]
 [-2.72486393e-01  1.72388121e-01  4.21762080e-01]
 [ 3.53111463e-01 -3.94827238e-01 -6.57643881e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.25806515]
curr_Stock_Price:  100.87842989434006
curr_Factors:  [100.87842989  -0.97435075  -1.02975829]
mat_Sqrt:  [[13.59642774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074998 -0.00774875  0.12913503]
Stock Position:  0.0007499750044843116
Bond Position:  [9.18240885]


portfolio before change:  [9.26046497]
curr_Stock_Price:  101.0170019178531
curr_Factors:  [101.01700192  -1.10573818  -1.05564297]
mat_Sqrt:  [[11.63371899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00184392  0.05553337 -0.66160518]
Stock Position:  0.0018439199625489367
Bond Position:  [9.0741977]


portfolio before change:  [9.26428102]
curr_Stock_Price:  101.85609604832713
curr_Factors:  [101.85609605  -0.83024897  -1.06709845]
mat_Sqrt:  [[15.27493995  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00581291 -0.01312132 -0.17699093]
Stock Position:  -0.005812911318068714
Bond Position:  [9.85636148]


portfolio before change:  [9.27275263]
curr_Stock_Price:  100.82267110011018
curr_Factors:  [100.8226711   -0.54794061  -1.02159132]
mat_Sqrt:  [[20.98549138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00835095 -0.11194575  3.06886714]
Stock Position:  -0.00835095169025017
Bond Position:  [10.11471789]


portfolio before change:  [9.27676008]
curr_Stock_Price:  100.64563101051348
curr_Factors:  [100.64563101  -0.3405992   -1.04184929]
mat_Sqrt:  [[25.25836172  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195464  0.01088147 -0.09155446]
Stock Position:  -0.0019546434109645535
Bond Position:  [9.4734864]


portfolio before change:  [9.28076661]
curr_Stock_Price:  99.80769574277132
curr_Factors:  [99.80769574 -0.36685938 -1.05298066]
mat_Sqrt:  [[24.12877847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04959331  0.47910483 -0.62500537]
Stock Position:  -0.04959331332011045
Bond Position:  [14.23056094]


portfolio before change:  [9.29531279]
curr_Stock_Price:  99.58613175455798
curr_Factors:  [99.58613175 -0.66166159 -1.04051131]
mat_Sqrt:  [[18.15325734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00016195  0.0041965  -0.00196414]
Stock Position:  0.00016194771446227543
Bond Position:  [9.27918504]


portfolio before change:  [9.29749233]
curr_Stock_Price:  98.718273658172
curr_Factors:  [98.71827366 -0.9306965  -1.00204421]
mat_Sqrt:  [[14.28956229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208117  0.01482328 -0.24237952]
Stock Position:  -0.0020811666814856567
Bond Position:  [9.50294151]


portfolio before change:  [9.30417521]
curr_Stock_Price:  96.6488345804215
curr_Factors:  [96.64883458 -0.67395491 -0.99897151]
mat_Sqrt:  [[18.14069437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00269022 0.0085818  0.12203854]
Stock Position:  0.002690223925042386
Bond Position:  [9.0441682]


portfolio before change:  [9.30476296]
curr_Stock_Price:  96.02674166801015
curr_Factors:  [96.02674167 -0.6737791  -0.97252107]
mat_Sqrt:  [[18.51028535  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01051408 0.03706155 0.23647974]
Stock Position:  0.010514075097695865
Bond Position:  [8.29513059]


portfolio before change:  [9.28591203]
curr_Stock_Price:  94.03655457439979
curr_Factors:  [94.03655457 -0.51099808 -0.99790727]
mat_Sqrt:  [[20.79636545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.006888   -0.02859876 -0.01190876]
Stock Position:  -0.006888004272411421
Bond Position:  [9.93363622]


portfolio before change:  [9.27771577]
curr_Stock_Price:  95.58707258332656
curr_Factors:  [95.58707258 -0.50001449 -0.97929581]
mat_Sqrt:  [[21.77423266  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00341129  0.005038   -0.07116403]
Stock Position:  0.003411294355031166
Bond Position:  [8.95164013]


portfolio before change:  [9.27556901]
curr_Stock_Price:  94.30165128270109
curr_Factors:  [94.30165128 -0.55930511 -0.92908764]
mat_Sqrt:  [[21.28719995  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079208 -0.00995959  0.34984664]
Stock Position:  0.0007920780302942899
Bond Position:  [9.20087475]


portfolio before change:  [9.27883695]
curr_Stock_Price:  95.52304075940602
curr_Factors:  [95.52304076 -0.16642441 -0.98022282]
mat_Sqrt:  [[30.34768553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00088814  0.00964334 -0.16248014]
Stock Position:  -0.0008881376035288609
Bond Position:  [9.36367456]


portfolio before change:  [9.28221352]
curr_Stock_Price:  94.35727841464363
curr_Factors:  [94.35727841  0.20801851 -0.95176321]
mat_Sqrt:  [[44.85090235  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200578 -0.04169123 -0.19299589]
Stock Position:  -0.002005782052567756
Bond Position:  [9.47147366]


portfolio before change:  [9.28899626]
curr_Stock_Price:  92.15635703137033
curr_Factors:  [92.15635703  0.54443612 -0.95124389]
mat_Sqrt:  [[61.35513681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00056805  0.02898762 -0.48345032]
Stock Position:  0.0005680547913640785
Bond Position:  [9.2366464]


portfolio before change:  [9.28953891]
curr_Stock_Price:  89.04609585293416
curr_Factors:  [89.04609585  0.41371541 -0.95839828]
mat_Sqrt:  [[51.6490242   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0036438  -0.11501103  0.61486836]
Stock Position:  0.003643799138098463
Bond Position:  [8.96507282]


portfolio before change:  [9.27832911]
curr_Stock_Price:  85.35452506494369
curr_Factors:  [85.35452506  0.60232819 -0.9858853 ]
mat_Sqrt:  [[58.16340365  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259968  0.05563803  1.20316982]
Stock Position:  -0.0025996757656112828
Bond Position:  [9.5002232]


portfolio before change:  [9.27475975]
curr_Stock_Price:  87.64124101632959
curr_Factors:  [87.64124102  0.67320521 -1.00731558]
mat_Sqrt:  [[62.74891621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00220365 -0.12742994 -1.87607494]
Stock Position:  0.002203650737341794
Bond Position:  [9.08162906]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.27684198]
Stock Price:  87.55571868641579
PL:  [9.27684198]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.32913778e-02  3.34053587e-02  3.74537704e-02]
 [ 3.81883502e-02  1.06343403e-01 -2.30461260e-01]
 [ 8.77263464e-02 -4.06829945e-02 -3.55268462e-02]
 [-3.17535909e-01 -3.42407639e-01  9.53505726e-01]
 [-1.47041336e-02 -1.79518571e-02  2.70531194e-03]
 [-1.52577763e+00  1.64184154e+00 -2.48310088e-01]
 [ 1.10690518e-02 -8.82696906e-03  3.56074980e-02]
 [-6.92553658e-02 -2.52344778e-02  4.02489722e-03]
 [-3.44692065e-02  1.83443383e-02  5.55729718e-02]
 [-6.73760581e-01  3.09805035e-01 -3.44962887e-01]
 [ 1.39793729e-01  4.57040899e-02 -5.50803877e-02]
 [-9.41566189e-02  1.21034689e-01  1.49548270e-01]
 [ 1.67721297e-01 -5.78724233e-02 -1.34713562e-01]
 [ 3.52967872e-02  8.94562678e-01 -5.15859514e-01]
 [ 1.49211577e-01 -6.25144097e-02 -3.06728029e-03]
 [ 2.36794894e-02 -2.29701410e-02 -2.07863953e-02]
 [-8.56687224e-02  1.60215313e-02  5.77733207e-02]
 [ 4.98528412e-02 -2.09916115e-01 -3.13331939e-02]
 [-1.64546735e-01  2.91607940e-02 -2.88847124e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.21871043]
curr_Stock_Price:  99.99103719342361
curr_Factors:  [99.99103719 -1.13866088 -0.9727355 ]
mat_Sqrt:  [[12.10579403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00238128  0.01078153  0.10684518]
Stock Position:  -0.0023812827678251617
Bond Position:  [2.45681737]


portfolio before change:  [2.22013802]
curr_Stock_Price:  99.64949382820231
curr_Factors:  [99.64949383 -0.81694822 -0.99304461]
mat_Sqrt:  [[16.30816885  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00078813  0.03432219 -0.65744183]
Stock Position:  0.000788126413504262
Bond Position:  [2.14160163]


portfolio before change:  [2.22019037]
curr_Stock_Price:  99.03649289324379
curr_Factors:  [99.03649289 -0.41154846 -1.00418687]
mat_Sqrt:  [[24.0408165   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00300198 -0.01313038 -0.1013482 ]
Stock Position:  0.003001981142482259
Bond Position:  [1.92288469]


portfolio before change:  [2.22023339]
curr_Stock_Price:  98.89066841361978
curr_Factors:  [98.89066841 -0.12247739 -0.9952203 ]
mat_Sqrt:  [[32.34039917  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00596146 -0.11051159  2.72008643]
Stock Position:  -0.005961461183578398
Bond Position:  [2.80976627]


portfolio before change:  [2.20333697]
curr_Stock_Price:  101.84278786178109
curr_Factors:  [101.84278786  -0.41930658  -1.03836597]
mat_Sqrt:  [[23.70670175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00075153 -0.00579394  0.0077175 ]
Stock Position:  -0.0007515310122849468
Bond Position:  [2.27987499]


portfolio before change:  [2.203457]
curr_Stock_Price:  102.44158409919034
curr_Factors:  [102.4415841   -0.15647337  -1.0609575 ]
mat_Sqrt:  [[30.32164608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04093855  0.52990208 -0.70835956]
Stock Position:  -0.04093854963199982
Bond Position:  [6.39726687]


portfolio before change:  [2.25486984]
curr_Stock_Price:  101.22480127924008
curr_Factors:  [101.22480128  -0.50039699  -1.01647839]
mat_Sqrt:  [[22.20835164  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074457 -0.00284889  0.10157828]
Stock Position:  0.0007445669368849773
Bond Position:  [2.1795012]


portfolio before change:  [2.25451461]
curr_Stock_Price:  100.0158134635275
curr_Factors:  [100.01581346  -0.56396274  -1.03264584]
mat_Sqrt:  [[20.26144313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00363176 -0.00814439  0.01148191]
Stock Position:  -0.0036317626948454773
Bond Position:  [2.61774831]


portfolio before change:  [2.24720473]
curr_Stock_Price:  102.20879729799027
curr_Factors:  [102.2087973   -1.1907366   -1.04217356]
mat_Sqrt:  [[10.95841432  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176859  0.00592061  0.15853422]
Stock Position:  -0.001768586055421196
Bond Position:  [2.42796979]


portfolio before change:  [2.24587079]
curr_Stock_Price:  103.30629124275252
curr_Factors:  [103.30629124  -1.50547446  -1.01671724]
mat_Sqrt:  [[ 8.29378615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08210209  0.09998915 -0.9840831 ]
Stock Position:  -0.08210208640523249
Bond Position:  [10.72753284]


portfolio before change:  [2.19041455]
curr_Stock_Price:  104.0144152284235
curr_Factors:  [104.01441523  -1.43486123  -1.03858527]
mat_Sqrt:  [[ 8.7677743   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01572575  0.01475093 -0.15712901]
Stock Position:  0.015725746947014275
Bond Position:  [0.55471018]


portfolio before change:  [2.20492898]
curr_Stock_Price:  104.92856798482761
curr_Factors:  [104.92856798  -1.18147186  -1.0592146 ]
mat_Sqrt:  [[11.16287294  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00348693  0.03906378  0.42661959]
Stock Position:  -0.003486925273727844
Bond Position:  [2.57080706]


portfolio before change:  [2.20268833]
curr_Stock_Price:  105.7554960220786
curr_Factors:  [105.75549602  -1.17055305  -1.06139077]
mat_Sqrt:  [[11.34963937  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.011314   -0.01867824 -0.3843003 ]
Stock Position:  0.011314002418955848
Bond Position:  [1.00617039]


portfolio before change:  [2.19679214]
curr_Stock_Price:  105.21212024257933
curr_Factors:  [105.21212024  -1.32429495  -1.10769347]
mat_Sqrt:  [[ 9.24414229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01218061  0.28871886 -1.47160361]
Stock Position:  0.012180605121409782
Bond Position:  [0.91524485]


portfolio before change:  [2.18992402]
curr_Stock_Price:  104.62947564139095
curr_Factors:  [104.62947564  -1.21059703  -1.07048876]
mat_Sqrt:  [[10.6903291   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01270539 -0.02017644 -0.0087501 ]
Stock Position:  0.012705387180821866
Bond Position:  [0.86056602]


portfolio before change:  [2.18473527]
curr_Stock_Price:  104.20415095132256
curr_Factors:  [104.20415095  -1.22775265  -1.04386546]
mat_Sqrt:  [[10.7481523   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00137212 -0.00741358 -0.0592978 ]
Stock Position:  0.0013721171234490355
Bond Position:  [2.04175497]


portfolio before change:  [2.18664248]
curr_Stock_Price:  105.22206655549853
curr_Factors:  [105.22206656  -1.28298792  -1.07748252]
mat_Sqrt:  [[ 9.93041816  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00711001  0.00517093  0.1648112 ]
Stock Position:  -0.007110013915831235
Bond Position:  [2.93477283]


portfolio before change:  [2.1865305]
curr_Stock_Price:  105.34101961062055
curr_Factors:  [105.34101961  -1.34364598  -1.08419183]
mat_Sqrt:  [[ 9.29396336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.54222858e-05 -6.77501347e-02 -8.93848806e-02]
Stock Position:  6.542228581064227e-05
Bond Position:  [2.17963885]


portfolio before change:  [2.18708817]
curr_Stock_Price:  105.53492759295543
curr_Factors:  [105.53492759  -1.36254996  -1.1113321 ]
mat_Sqrt:  [[ 8.8920703   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01849855  0.00941161 -0.08240004]
Stock Position:  -0.01849854692592466
Bond Position:  [4.13933098]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.18089364]
Stock Price:  105.92574168482942
PL:  [-3.74484805]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-5.32553552e-03 -1.20741559e-02  4.50099289e-02]
 [-1.57762907e-03  9.02587395e-02 -8.24815968e-02]
 [ 3.07090980e-02 -1.24096957e-01 -2.73273147e-01]
 [-2.15380464e-01 -1.83637687e-01  1.15069457e+00]
 [-2.77617550e-02 -1.14459326e-01 -2.63142716e-02]
 [-1.21191319e+00  1.37305166e+00 -2.14108975e-01]
 [-1.60087143e-03 -4.00665593e-02  1.46080411e-03]
 [-3.24733094e-02 -1.64616769e-01  2.66381398e-01]
 [-1.76408466e-02 -2.24931386e-02 -1.09735633e-02]
 [-9.40255203e-01  3.72729420e-01 -4.82471475e-01]
 [ 1.35462542e-01  5.20795664e-02 -5.61020145e-02]
 [-7.31167003e-02  1.32103342e-01  9.93430289e-02]
 [ 1.83705648e-01 -5.65515498e-02 -1.39949562e-01]
 [ 3.42036601e-02  8.94933850e-01 -5.17947357e-01]
 [ 1.58131910e-01 -6.92354018e-02  5.35420448e-03]
 [ 1.91509185e-02 -2.84280091e-02 -7.22665384e-02]
 [-8.50511755e-02  1.61256894e-02  5.80832925e-02]
 [ 5.04161854e-02 -2.29147639e-01 -2.92029948e-02]
 [-1.53414246e-01  3.76272278e-02 -2.24052035e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.00265538]
curr_Stock_Price:  100.59410920707631
curr_Factors:  [100.59410921  -0.94637807  -1.03628509]
mat_Sqrt:  [[13.85201265  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.00884328e-04 -3.89691706e-03  1.28400799e-01]
Stock Position:  0.0001008843275970739
Bond Position:  [6.99250701]


portfolio before change:  [7.00460012]
curr_Stock_Price:  102.54086940616473
curr_Factors:  [102.54086941  -1.04349325  -1.0480864 ]
mat_Sqrt:  [[12.6629676   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.79716411e-07  2.91308829e-02 -2.35297037e-01]
Stock Position:  7.797164108876151e-07
Bond Position:  [7.00452017]


portfolio before change:  [7.00635254]
curr_Stock_Price:  103.90938752674111
curr_Factors:  [103.90938753  -1.13004218  -1.06173635]
mat_Sqrt:  [[11.60853626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00434195 -0.04005212 -0.77957222]
Stock Position:  -0.004341954372581219
Bond Position:  [7.45752236]


portfolio before change:  [7.00374603]
curr_Stock_Price:  104.93913673777693
curr_Factors:  [104.93913674  -1.38051598  -1.05184259]
mat_Sqrt:  [[ 9.21674529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.95088433e-03 -5.92688087e-02  3.28261133e+00]
Stock Position:  -0.0019508843327911355
Bond Position:  [7.20847014]


portfolio before change:  [7.0061266]
curr_Stock_Price:  104.64274370120981
curr_Factors:  [104.6427437   -0.9266581   -1.06879633]
mat_Sqrt:  [[14.22637564  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00397129 -0.03694159 -0.07506729]
Stock Position:  -0.0039712887301820935
Bond Position:  [7.42169315]


portfolio before change:  [7.00696666]
curr_Stock_Price:  104.89847898223758
curr_Factors:  [104.89847898  -1.15795651  -1.08875954]
mat_Sqrt:  [[11.09258605  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08792765  0.44315052 -0.61079331]
Stock Position:  -0.08792764788943631
Bond Position:  [16.23044318]


portfolio before change:  [7.02797498]
curr_Stock_Price:  104.70570447050187
curr_Factors:  [104.70570447  -1.22497939  -1.07073313]
mat_Sqrt:  [[10.54277801  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00089931 -0.01293143  0.00416727]
Stock Position:  -0.0008993111874984907
Bond Position:  [7.12213799]


portfolio before change:  [7.02926631]
curr_Stock_Price:  105.24993272030665
curr_Factors:  [105.24993272  -1.05927058  -1.07436337]
mat_Sqrt:  [[12.46224751  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093889 -0.05312983  0.75991198]
Stock Position:  -0.0009388909639649943
Bond Position:  [7.12808452]


portfolio before change:  [7.03142779]
curr_Stock_Price:  104.84601228266482
curr_Factors:  [104.84601228  -1.13034958  -1.05026037]
mat_Sqrt:  [[11.84472679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00206608 -0.00725963 -0.03130452]
Stock Position:  -0.0020660846736401135
Bond Position:  [7.24804853]


portfolio before change:  [7.0334801]
curr_Stock_Price:  104.72981643553776
curr_Factors:  [104.72981644  -1.19121735  -1.07499675]
mat_Sqrt:  [[10.86090624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08863498  0.1202979  -1.37635683]
Stock Position:  -0.08863497995754421
Bond Position:  [16.31620528]


portfolio before change:  [7.0652226]
curr_Stock_Price:  104.41771681053899
curr_Factors:  [104.41771681  -0.79522778  -1.08021167]
mat_Sqrt:  [[16.00594024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00841197  0.01680861 -0.16004343]
Stock Position:  0.008411968403446617
Bond Position:  [6.18686407]


portfolio before change:  [7.07242378]
curr_Stock_Price:  105.08988572255909
curr_Factors:  [105.08988572  -0.9517295   -1.09523234]
mat_Sqrt:  [[13.56990127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190664  0.04263617  0.28339801]
Stock Position:  -0.0019066393466936522
Bond Position:  [7.27279229]


portfolio before change:  [7.07239439]
curr_Stock_Price:  106.05903159640962
curr_Factors:  [106.0590316   -1.2871927   -1.06700541]
mat_Sqrt:  [[10.0723871   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01425631 -0.01825193 -0.39923715]
Stock Position:  0.014256305387204671
Bond Position:  [5.56038445]


portfolio before change:  [7.05500502]
curr_Stock_Price:  104.74174499520754
curr_Factors:  [104.741745    -1.40370827  -1.03131829]
mat_Sqrt:  [[ 9.17489714  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0121152   0.28883866 -1.47755964]
Stock Position:  0.012115199113310689
Bond Position:  [5.78603792]


portfolio before change:  [7.06058137]
curr_Stock_Price:  105.08261055960796
curr_Factors:  [105.08261056  -1.43496299  -1.01333923]
mat_Sqrt:  [[ 9.08336382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0159734  -0.02234563  0.01527406]
Stock Position:  0.01597340129470463
Bond Position:  [5.38205466]


portfolio before change:  [7.06237631]
curr_Stock_Price:  105.11073603501053
curr_Factors:  [105.11073604  -1.45909322  -1.00959599]
mat_Sqrt:  [[ 8.9024384   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.57627595e-04 -9.17510048e-03 -2.06156319e-01]
Stock Position:  -0.00015762759463863548
Bond Position:  [7.07894466]


portfolio before change:  [7.06409383]
curr_Stock_Price:  105.4433593239558
curr_Factors:  [105.44335932  -1.34565578  -1.04173267]
mat_Sqrt:  [[ 9.68700677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0072162   0.00520454  0.16569547]
Stock Position:  -0.007216195067469146
Bond Position:  [7.82499368]


portfolio before change:  [7.06207617]
curr_Stock_Price:  105.99408688100814
curr_Factors:  [105.99408688  -1.5899875   -1.06085862]
mat_Sqrt:  [[ 7.48227725  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00030999 -0.07395708 -0.08330802]
Stock Position:  -0.0003099880966415338
Bond Position:  [7.09493307]


portfolio before change:  [7.06388087]
curr_Stock_Price:  105.8949076863953
curr_Factors:  [105.89490769  -1.48219069  -1.03135341]
mat_Sqrt:  [[ 8.57544654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01752761  0.01214414 -0.06391581]
Stock Position:  -0.01752760772476731
Bond Position:  [8.91996527]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.05306903]
Stock Price:  106.63899731219777
PL:  [0.41407172]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-7.59334790e-02  1.51829978e-01  1.37547901e-02]
 [ 4.14852257e-02  1.76813797e-01 -2.82556333e-01]
 [-6.44901469e-02  3.07250722e-02 -1.22204918e-02]
 [-3.52498882e-01 -3.82031147e-01  1.20542225e+00]
 [ 5.13638843e-03 -4.72421134e-02  2.24330974e-02]
 [-1.36395083e+00  1.48479472e+00 -2.23539443e-01]
 [ 1.08275464e-02 -7.04358283e-03  3.19932501e-02]
 [-5.17983969e-02 -2.61529276e-02  1.61579935e-02]
 [ 4.95901247e-02  2.91668424e-02  5.86244113e-02]
 [-1.88114297e-01  2.05364414e-01 -8.27488208e-02]
 [ 4.53555499e-02  2.43363417e-02 -5.48127242e-02]
 [ 1.21422677e-01 -4.29134549e-02 -3.49827161e-02]
 [-8.76638315e-02 -7.43100954e-02  8.12825318e-02]
 [ 1.50557469e-02  4.45152532e-01 -3.34280773e-01]
 [-1.44674578e-02 -2.20569781e-01 -5.81269804e-02]
 [ 3.20025732e-02  1.57548906e-02 -1.18720184e-01]
 [-7.33691981e-03 -9.44265371e-02  9.23625838e-02]
 [-1.24343457e-01  1.18794337e-01  1.27237429e-01]
 [ 1.61967158e-01 -2.08331249e-01 -3.80000284e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.4969916]
curr_Stock_Price:  99.39656799447499
curr_Factors:  [99.39656799 -0.88979052 -1.00011564]
mat_Sqrt:  [[15.01742857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280565  0.04900291  0.03923859]
Stock Position:  -0.0028056487462713516
Bond Position:  [-2.21811974]


portfolio before change:  [-2.5006107]
curr_Stock_Price:  100.48882993940366
curr_Factors:  [100.48882994  -0.76596454  -1.01820592]
mat_Sqrt:  [[16.87572363  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00117925  0.05706641 -0.80605457]
Stock Position:  0.0011792454866059428
Bond Position:  [-2.6191117]


portfolio before change:  [-2.50173704]
curr_Stock_Price:  100.08901436788987
curr_Factors:  [100.08901437  -0.47943324  -1.04060282]
mat_Sqrt:  [[21.88986791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277356  0.00991647 -0.03486166]
Stock Position:  -0.00277356243128881
Bond Position:  [-2.22413391]


portfolio before change:  [-2.50569054]
curr_Stock_Price:  101.31393668153504
curr_Factors:  [101.31393668  -0.46717735  -1.05255922]
mat_Sqrt:  [[22.16440014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00832077 -0.12330002  3.43873416]
Stock Position:  -0.008320770008642883
Bond Position:  [-1.66268058]


portfolio before change:  [-2.51563785]
curr_Stock_Price:  102.45945385446544
curr_Factors:  [102.45945385  -0.64295065  -1.01450444]
mat_Sqrt:  [[19.53117797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.70019864e-06 -1.52473265e-02  6.39953827e-02]
Stock Position:  3.700198638638392e-06
Bond Position:  [-2.51601697]


portfolio before change:  [-2.51626485]
curr_Stock_Price:  103.02261644242242
curr_Factors:  [103.02261644  -0.48306312  -1.0323868 ]
mat_Sqrt:  [[22.63502811  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04888433  0.47921543 -0.63769581]
Stock Position:  -0.048884329571406655
Bond Position:  [2.51992669]


portfolio before change:  [-2.46765246]
curr_Stock_Price:  102.04106810358981
curr_Factors:  [102.0410681   -0.52580908  -1.0254952 ]
mat_Sqrt:  [[21.62978036  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00073604 -0.00227331  0.09126784]
Stock Position:  0.0007360396468446258
Bond Position:  [-2.54275873]


portfolio before change:  [-2.470001]
curr_Stock_Price:  99.71405599026993
curr_Factors:  [99.71405599 -0.38677532 -1.02993769]
mat_Sqrt:  [[24.18163934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00222642 -0.00844082  0.04609426]
Stock Position:  -0.002226424915273048
Bond Position:  [-2.24799514]


portfolio before change:  [-2.4706759]
curr_Stock_Price:  99.76473630509034
curr_Factors:  [99.76473631 -0.24027894 -1.05526549]
mat_Sqrt:  [[27.31047543  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00247196 0.00941356 0.16723913]
Stock Position:  0.0024719613364173167
Bond Position:  [-2.71729048]


portfolio before change:  [-2.46883497]
curr_Stock_Price:  100.78430670199543
curr_Factors:  [100.7843067   -0.51524355  -1.04063366]
mat_Sqrt:  [[21.26591272  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00766887  0.06628108 -0.23605935]
Stock Position:  -0.0076688687886449355
Bond Position:  [-1.69593335]


portfolio before change:  [-2.46029592]
curr_Stock_Price:  99.61554319174851
curr_Factors:  [99.61554319 -0.41101738 -1.06572734]
mat_Sqrt:  [[22.75018982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00172019  0.00785452 -0.15636545]
Stock Position:  0.0017201871563532448
Bond Position:  [-2.63165329]


portfolio before change:  [-2.46262367]
curr_Stock_Price:  98.64486076868417
curr_Factors:  [98.64486077 -0.1530477  -1.07119719]
mat_Sqrt:  [[28.99957712  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00363875 -0.01385026 -0.09979595]
Stock Position:  0.0036387491986368584
Bond Position:  [-2.82156757]


portfolio before change:  [-2.46133994]
curr_Stock_Price:  99.19153264494777
curr_Factors:  [99.19153264 -0.49853477 -1.08523158]
mat_Sqrt:  [[20.35418018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.004237   -0.02398348  0.23187644]
Stock Position:  -0.004236996437021925
Bond Position:  [-2.04106577]


portfolio before change:  [-2.46910608]
curr_Stock_Price:  100.9040212817914
curr_Factors:  [100.90402128  -0.3590698   -1.09389295]
mat_Sqrt:  [[23.59906349  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00159698  0.14367236 -0.95361   ]
Stock Position:  0.001596984977227757
Bond Position:  [-2.63024829]


portfolio before change:  [-2.46825794]
curr_Stock_Price:  101.84691436011695
curr_Factors:  [101.84691436   0.23372937  -1.10464075]
mat_Sqrt:  [[42.63005286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00167385 -0.07118859 -0.1658201 ]
Stock Position:  -0.00167384723147536
Bond Position:  [-2.29778177]


portfolio before change:  [-2.46136709]
curr_Stock_Price:  97.3869075010978
curr_Factors:  [97.3869075   0.12985916 -1.04090655]
mat_Sqrt:  [[39.15955271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.80515737e-04  5.08486908e-03 -3.38675639e-01]
Stock Position:  0.00028051573708329566
Bond Position:  [-2.48868565]


portfolio before change:  [-2.46265966]
curr_Stock_Price:  94.99729771924909
curr_Factors:  [94.99729772  0.12728059 -1.04491763]
mat_Sqrt:  [[37.94779516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.04444619e-04 -3.04760338e-02  2.63484743e-01]
Stock Position:  -0.0002044446185662053
Bond Position:  [-2.44323797]


portfolio before change:  [-2.46302892]
curr_Stock_Price:  93.81540643457572
curr_Factors:  [93.81540643 -0.22989824 -1.04703101]
mat_Sqrt:  [[26.16440354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00283295  0.03834071  0.36297297]
Stock Position:  -0.002832949474894959
Bond Position:  [-2.19725461]


portfolio before change:  [-2.4625362]
curr_Stock_Price:  93.44755806364896
curr_Factors:  [ 9.34475581e+01 -5.75719012e-02 -1.05009724e+00]
mat_Sqrt:  [[30.86834623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00135655 -0.06723862 -1.08403504]
Stock Position:  0.0013565510142117927
Bond Position:  [-2.58930258]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.46364436]
Stock Price:  93.10790817930416
PL:  [-2.46364436]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.07517328e-02  6.85656047e-02  2.73225512e-02]
 [ 2.03047332e-02  4.48396763e-02 -1.46016384e-01]
 [ 1.13373919e-01 -1.15805503e-02 -1.11178943e-02]
 [ 1.12838612e-02  3.83830645e-02 -5.70526604e-02]
 [-1.14506329e-01  1.29384583e-01 -9.65297940e-02]
 [-1.77434546e+00  1.76321410e+00 -2.62607793e-01]
 [-1.48949562e-01 -3.82303946e-02 -1.75076949e-01]
 [-4.15378497e-02 -3.48183564e-02  3.77229286e-02]
 [ 8.79355029e-02  2.79935754e-02  6.25209798e-02]
 [-7.11625682e-02  1.80657894e-01 -1.90981191e-02]
 [ 1.12643129e-01  3.11128104e-02 -6.00402351e-02]
 [-1.14804843e-01 -2.57403294e-02 -1.75906517e-02]
 [ 2.33332382e-02  6.88646191e-02  5.64566589e-02]
 [ 1.00535783e-02  6.25772126e-01 -4.42228692e-01]
 [ 1.03271550e-01 -6.02692543e-02 -4.14368537e-02]
 [ 3.37006716e-02  1.76947298e-02 -7.55655343e-02]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [-1.89480446e-02 -3.13900822e-02  2.68334598e-02]
 [ 7.20533394e-02 -1.33346544e-01 -2.17543195e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.25913947]
curr_Stock_Price:  99.99613374511837
curr_Factors:  [99.99613375 -0.66850066 -1.00395068]
mat_Sqrt:  [[18.77789139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00112785  0.02212945  0.07794363]
Stock Position:  -0.0011278500061185854
Bond Position:  [2.37192011]


portfolio before change:  [2.26106928]
curr_Stock_Price:  98.81091196764612
curr_Factors:  [98.81091197 -0.57924425 -1.00015582]
mat_Sqrt:  [[20.36480122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.70822053e-05  1.44719433e-02 -4.16544100e-01]
Stock Position:  -1.7082205258043587e-05
Bond Position:  [2.26275719]


portfolio before change:  [2.26164575]
curr_Stock_Price:  98.18397056232946
curr_Factors:  [98.18397056 -0.19975103 -0.97848816]
mat_Sqrt:  [[30.22301689  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00359794 -0.00373761 -0.03171626]
Stock Position:  0.003597940561486014
Bond Position:  [1.90838566]


portfolio before change:  [2.24866952]
curr_Stock_Price:  94.44477933901211
curr_Factors:  [ 9.44447793e+01  6.43842771e-02 -1.01182110e+00]
mat_Sqrt:  [[36.61941235  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00020407  0.01238808 -0.16275536]
Stock Position:  0.0002040706116890494
Bond Position:  [2.22939611]


portfolio before change:  [2.25004219]
curr_Stock_Price:  98.43973565686171
curr_Factors:  [ 9.84397357e+01  8.17100742e-02 -1.07969376e+00]
mat_Sqrt:  [[36.28704719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297075  0.04175869 -0.27537263]
Stock Position:  -0.002970753525638851
Bond Position:  [2.54248238]


portfolio before change:  [2.25281068]
curr_Stock_Price:  97.72180770588405
curr_Factors:  [97.72180771  0.15899911 -1.09756584]
mat_Sqrt:  [[38.22760955  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03840249  0.5690749  -0.74914694]
Stock Position:  -0.03840249239185097
Bond Position:  [6.00557165]


portfolio before change:  [2.31337763]
curr_Stock_Price:  96.18374682664827
curr_Factors:  [96.18374683  0.25416821 -1.11067036]
mat_Sqrt:  [[40.84393123  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00471284 -0.01233881 -0.4994458 ]
Stock Position:  -0.004712835798279803
Bond Position:  [2.76667583]


portfolio before change:  [2.29865691]
curr_Stock_Price:  99.45406463453398
curr_Factors:  [99.45406463 -0.11103863 -1.09436336]
mat_Sqrt:  [[29.79360822  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137429 -0.01123758  0.10761302]
Stock Position:  -0.0013742865956343085
Bond Position:  [2.4353353]


portfolio before change:  [2.29666169]
curr_Stock_Price:  101.34896466121614
curr_Factors:  [101.34896466  -0.18919205  -1.08820979]
mat_Sqrt:  [[28.25210096  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00376651 0.00903489 0.17835495]
Stock Position:  0.0037665060481724476
Bond Position:  [1.9149302]


portfolio before change:  [2.29228501]
curr_Stock_Price:  100.05984766961743
curr_Factors:  [100.05984767  -0.23075732  -1.09803305]
mat_Sqrt:  [[26.49558507  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144116  0.05830708 -0.05448162]
Stock Position:  -0.0014411577293764462
Bond Position:  [2.43648703]


portfolio before change:  [2.28896992]
curr_Stock_Price:  102.78286153290678
curr_Factors:  [ 1.02782862e+02 -9.24622253e-02 -1.12568185e+00]
mat_Sqrt:  [[30.40097094  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00351102  0.01004162 -0.17127808]
Stock Position:  0.003511017556089279
Bond Position:  [1.92809749]


portfolio before change:  [2.29257387]
curr_Stock_Price:  103.67202605404586
curr_Factors:  [103.67202605   0.12725149  -1.14188248]
mat_Sqrt:  [[37.58486061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328988 -0.00830766 -0.05018123]
Stock Position:  -0.003289881618055575
Bond Position:  [2.63364257]


portfolio before change:  [2.29409297]
curr_Stock_Price:  103.410434106954
curr_Factors:  [103.41043411  -0.38615822  -1.11708534]
mat_Sqrt:  [[22.9992662   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00212678 0.02222596 0.16105513]
Stock Position:  0.0021267781567187003
Bond Position:  [2.07416192]


portfolio before change:  [2.29567032]
curr_Stock_Price:  103.90825066940789
curr_Factors:  [ 1.03908251e+02 -5.00922862e-02 -1.12507512e+00]
mat_Sqrt:  [[32.08346866  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00148111  0.20196709 -1.26155537]
Stock Position:  0.0014811124503560345
Bond Position:  [2.14177052]


portfolio before change:  [2.29651434]
curr_Stock_Price:  104.11654510837465
curr_Factors:  [ 1.04116545e+02 -6.76713934e-02 -1.13865400e+00]
mat_Sqrt:  [[31.16156698  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00264784 -0.01945182 -0.11820781]
Stock Position:  0.0026478410836166984
Bond Position:  [2.02083028]


portfolio before change:  [2.2964008]
curr_Stock_Price:  103.88283930482253
curr_Factors:  [103.8828393   -0.17130181  -1.15171973]
mat_Sqrt:  [[27.66705016  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079112  0.00571095 -0.21556744]
Stock Position:  0.0007911158951374167
Bond Position:  [2.21421743]


portfolio before change:  [2.2940871]
curr_Stock_Price:  100.25843542602841
curr_Factors:  [100.25843543  -0.27719992  -1.14570933]
mat_Sqrt:  [[24.16346935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00284685  0.00525786  0.16709793]
Stock Position:  -0.0028468517879363135
Bond Position:  [2.579508]


portfolio before change:  [2.30179931]
curr_Stock_Price:  97.77595503106124
curr_Factors:  [97.77595503 -0.16485484 -1.18704995]
mat_Sqrt:  [[25.2992285   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00078572 -0.01013111  0.07654839]
Stock Position:  -0.0007857220346794663
Bond Position:  [2.37862403]


portfolio before change:  [2.30300241]
curr_Stock_Price:  97.00166723090541
curr_Factors:  [ 9.70016672e+01 -4.10045429e-02 -1.22541735e+00]
mat_Sqrt:  [[27.33878178  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.56653427e-05 -4.30374120e-02 -6.20590182e-01]
Stock Position:  1.5665342709499325e-05
Bond Position:  [2.30148285]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.30358806]
Stock Price:  97.65300114148368
PL:  [2.30358806]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-9.65832806e-02  1.76955188e-01  4.70533591e-03]
 [ 3.05738710e-02  1.45811199e-01 -1.68859016e-01]
 [-7.14767231e-02  2.55839764e-02 -5.34661003e-03]
 [-4.98105604e-03  8.70560208e-02  2.05870586e-02]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-6.62775054e-01  6.54794160e-01 -6.30069630e-02]
 [ 5.87045653e-03 -4.15649038e-05  2.19458377e-02]
 [-7.43834522e-02 -3.69680604e-03 -3.52023985e-02]
 [ 9.47025659e-02  3.01927123e-02  6.32123014e-02]
 [-1.42544756e-01  1.91054951e-01 -6.32693660e-02]
 [ 1.19597272e-01  3.22528386e-02 -5.27093963e-02]
 [-9.16162422e-02  1.22371127e-01  1.43486449e-01]
 [-1.63407434e-01 -1.24401019e-01  8.40292023e-03]
 [ 3.30301425e-02  6.15706094e-01 -3.73814712e-01]
 [ 1.68050168e-02 -1.75246543e-01 -5.37749001e-02]
 [ 6.73984885e-02  6.13642961e-02  2.01509538e-01]
 [-7.10962248e-02  1.57648409e-02  6.61993800e-02]
 [ 4.79358297e-02 -1.67976632e-01 -3.39788760e-02]
 [-1.32733757e-01  5.33550660e-02 -1.03684155e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.13422599]
curr_Stock_Price:  99.06411386479267
curr_Factors:  [99.06411386 -0.89987488 -0.96786121]
mat_Sqrt:  [[15.30272883  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00388832  0.05711204  0.01342301]
Stock Position:  -0.003888324901018371
Bond Position:  [-4.74903253]


portfolio before change:  [-5.14172121]
curr_Stock_Price:  100.68635785096677
curr_Factors:  [100.68635785  -1.19549816  -1.0202368 ]
mat_Sqrt:  [[10.98219538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00235556  0.04706036 -0.48170777]
Stock Position:  0.0023555631637286515
Bond Position:  [-5.37889428]


portfolio before change:  [-5.14385499]
curr_Stock_Price:  100.35145406245137
curr_Factors:  [100.35145406  -1.55087669  -1.01758654]
mat_Sqrt:  [[ 7.69226545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.008755    0.00825719 -0.01525239]
Stock Position:  -0.00875500052292972
Bond Position:  [-4.26527795]


portfolio before change:  [-5.14425547]
curr_Stock_Price:  100.27538641643316
curr_Factors:  [100.27538642  -2.03027586  -1.02645529]
mat_Sqrt:  [[ 4.71707598  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00360212 0.02809721 0.05872915]
Stock Position:  0.0036021246294661705
Bond Position:  [-5.50545991]


portfolio before change:  [-5.14609972]
curr_Stock_Price:  100.14554097768193
curr_Factors:  [100.14554098  -1.72985251  -1.03626051]
mat_Sqrt:  [[ 6.29975987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0090158  -0.04522423  0.24245377]
Stock Position:  0.00901580112073695
Bond Position:  [-6.048992]


portfolio before change:  [-5.14651606]
curr_Stock_Price:  100.26711582281885
curr_Factors:  [100.26711582  -1.88156286  -1.04730903]
mat_Sqrt:  [[ 5.36001032  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10111492  0.21133391 -0.17974133]
Stock Position:  -0.10111491691734988
Bond Position:  [4.99198502]


portfolio before change:  [-5.14427139]
curr_Stock_Price:  100.25726050839845
curr_Factors:  [100.25726051  -1.58430072  -1.0648118 ]
mat_Sqrt:  [[ 7.08958618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.45870961e-03 -1.34150150e-05  6.26053664e-02]
Stock Position:  0.0014587096107670377
Bond Position:  [-5.29051762]


portfolio before change:  [-5.14650759]
curr_Stock_Price:  99.63109107037938
curr_Factors:  [99.63109107 -1.30634267 -1.05753023]
mat_Sqrt:  [[ 9.37082717  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00878511 -0.00119314 -0.10042264]
Stock Position:  -0.008785106965969916
Bond Position:  [-4.2712378]


portfolio before change:  [-5.15550529]
curr_Stock_Price:  100.53372809645353
curr_Factors:  [100.5337281   -0.95086135  -1.06625788]
mat_Sqrt:  [[13.37482279  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00850619 0.00974466 0.1803271 ]
Stock Position:  0.008506190048070744
Bond Position:  [-6.01066429]


portfolio before change:  [-5.15981605]
curr_Stock_Price:  100.2036271806042
curr_Factors:  [100.20362718  -1.47180997  -1.10879232]
mat_Sqrt:  [[ 7.5882583   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01534748  0.06166272 -0.18048989]
Stock Position:  -0.015347478747065007
Bond Position:  [-3.62194301]


portfolio before change:  [-5.15954669]
curr_Stock_Price:  100.1270704502346
curr_Factors:  [100.12707045  -1.20981794  -1.11669739]
mat_Sqrt:  [[ 9.77594483  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01180669  0.01040956 -0.15036524]
Stock Position:  0.0118066945379145
Bond Position:  [-6.34171643]


portfolio before change:  [-5.14624345]
curr_Stock_Price:  101.38812368548419
curr_Factors:  [101.38812369  -1.36168606  -1.06867528]
mat_Sqrt:  [[ 8.92266451  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00418578  0.03949511  0.4093269 ]
Stock Position:  -0.004185777893623369
Bond Position:  [-4.72185528]


portfolio before change:  [-5.14758096]
curr_Stock_Price:  101.42560601466862
curr_Factors:  [101.42560601  -1.35670272  -1.06492634]
mat_Sqrt:  [[ 9.00424846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02077746 -0.04015026  0.02397119]
Stock Position:  -0.020777463809108276
Bond Position:  [-3.0402141]


portfolio before change:  [-5.15481146]
curr_Stock_Price:  101.73701807199261
curr_Factors:  [101.73701807  -1.30951762  -1.08365548]
mat_Sqrt:  [[ 9.29259764  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00886792  0.19871829 -1.06638932]
Stock Position:  0.00886792018182136
Bond Position:  [-6.05700721]


portfolio before change:  [-5.16250494]
curr_Stock_Price:  101.04023219616644
curr_Factors:  [101.0402322   -1.08632767  -1.14404534]
mat_Sqrt:  [[10.8606456   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00275709 -0.05656058 -0.15340482]
Stock Position:  -0.0027570911045488116
Bond Position:  [-4.88392781]


portfolio before change:  [-5.16352093]
curr_Stock_Price:  100.96582721307628
curr_Factors:  [100.96582721  -1.30150997  -1.17498105]
mat_Sqrt:  [[ 8.48492535  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01426735 0.01980524 0.57485062]
Stock Position:  0.014267348288675012
Bond Position:  [-6.60403555]


portfolio before change:  [-5.1631266]
curr_Stock_Price:  101.10919989278712
curr_Factors:  [101.10919989  -1.23565349  -1.18688724]
mat_Sqrt:  [[ 8.96797939  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00606216  0.00508808  0.1888484 ]
Stock Position:  -0.006062162483206149
Bond Position:  [-4.5501862]


portfolio before change:  [-5.16776415]
curr_Stock_Price:  101.68652878336161
curr_Factors:  [101.68652878  -1.12734954  -1.20957643]
mat_Sqrt:  [[ 9.82538028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00068311 -0.05421422 -0.09693228]
Stock Position:  0.0006831118958361288
Bond Position:  [-5.23722743]


portfolio before change:  [-5.16876365]
curr_Stock_Price:  102.14029296052342
curr_Factors:  [102.14029296  -1.09527411  -1.23419134]
mat_Sqrt:  [[ 9.94312977  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01246681  0.01722027 -0.0295782 ]
Stock Position:  -0.012466813463464626
Bond Position:  [-3.89539967]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.16600447]
Stock Price:  101.8408461087063
PL:  [-7.00685058]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 5.15916118e-03 -1.69234003e-02  3.67146488e-02]
 [ 3.00712288e-02  1.65274081e-01 -2.15749763e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-2.54410799e-01 -2.57810004e-01  7.40162977e-01]
 [-7.24197430e-02  6.72528060e-02 -5.46823495e-02]
 [-1.38949932e+00  1.39539224e+00 -2.02734761e-01]
 [ 1.04598191e-02 -5.91980975e-03  2.99385470e-02]
 [-3.34664674e-03 -2.41502041e-01  4.19999262e-01]
 [ 9.14378436e-03  1.51103614e-02  4.77776137e-02]
 [-3.12656908e-01  2.33777777e-01 -1.48140621e-01]
 [ 6.61073586e-02  6.31814398e-02 -5.74268771e-02]
 [-3.64076103e-02  4.96522742e-02 -8.26242609e-03]
 [ 1.75056262e-01  1.18715251e-01 -3.99301190e-02]
 [ 1.32274997e-02  6.91883268e-01 -4.68235827e-01]
 [ 1.06753938e-01 -5.97851176e-02 -4.08177007e-02]
 [ 3.99706068e-02  2.60133896e-02 -1.73155347e-02]
 [-8.01405624e-02  1.65531242e-02  5.44185411e-02]
 [ 4.30072465e-02 -2.49624343e-01 -3.07676055e-02]
 [-2.12203010e-01 -2.32080715e-02 -7.69447873e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.62919561]
curr_Stock_Price:  100.92521521339842
curr_Factors:  [100.92521521  -0.7805766   -1.01451459]
mat_Sqrt:  [[16.76492007  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00054871 -0.005462    0.10473667]
Stock Position:  0.0005487072302818034
Bond Position:  [9.57381721]


portfolio before change:  [9.63158054]
curr_Stock_Price:  100.90913583909195
curr_Factors:  [100.90913584  -0.56004319  -1.02229105]
mat_Sqrt:  [[20.73630898  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0009533   0.05334198 -0.61547402]
Stock Position:  0.00095330000344411
Bond Position:  [9.53538386]


portfolio before change:  [9.63375901]
curr_Stock_Price:  100.69338745107801
curr_Factors:  [100.69338745  -0.4303401   -1.02963447]
mat_Sqrt:  [[23.38525178  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00333641  0.01370813 -0.02999186]
Stock Position:  -0.003336407887967036
Bond Position:  [9.96971322]


portfolio before change:  [9.64195173]
curr_Stock_Price:  98.98497024900088
curr_Factors:  [98.98497025 -0.50758768 -1.02971606]
mat_Sqrt:  [[21.27780009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00732928 -0.08320782  2.11147895]
Stock Position:  -0.007329277959531837
Bond Position:  [10.36744009]


portfolio before change:  [9.64375045]
curr_Stock_Price:  99.09322963994113
curr_Factors:  [99.09322964 -0.61215916 -1.02152258]
mat_Sqrt:  [[19.34394359  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361115  0.02170575 -0.15599352]
Stock Position:  -0.003611146246365811
Bond Position:  [10.00159059]


portfolio before change:  [9.64585065]
curr_Stock_Price:  99.20413718430646
curr_Factors:  [99.20413718 -0.45987405 -1.01988942]
mat_Sqrt:  [[22.58794245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05073721  0.45036091 -0.57834584]
Stock Position:  -0.05073720779955394
Bond Position:  [14.67919158]


portfolio before change:  [9.49378777]
curr_Stock_Price:  102.27354415926595
curr_Factors:  [102.27354416  -0.62542237  -1.03811963]
mat_Sqrt:  [[19.37743091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00079281 -0.00191061  0.08540634]
Stock Position:  0.0007928101205378767
Bond Position:  [9.41270427]


portfolio before change:  [9.49875166]
curr_Stock_Price:  105.56615936851964
curr_Factors:  [105.56615937  -0.36923787  -1.06499964]
mat_Sqrt:  [[25.15609846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00131534 -0.07794445  1.19814099]
Stock Position:  0.0013153449071592862
Bond Position:  [9.35989575]


portfolio before change:  [9.49790507]
curr_Stock_Price:  103.14332547200601
curr_Factors:  [103.14332547  -0.52799462  -1.09248927]
mat_Sqrt:  [[20.40205524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00107738 0.00487685 0.13629623]
Stock Position:  0.0010773786398972933
Bond Position:  [9.38678065]


portfolio before change:  [9.49840708]
curr_Stock_Price:  101.43085723712316
curr_Factors:  [101.43085724  -0.41015583  -1.05827211]
mat_Sqrt:  [[23.35823074  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01263693  0.07545145 -0.42260396]
Stock Position:  -0.012636928728352316
Bond Position:  [10.78018159]


portfolio before change:  [9.45868714]
curr_Stock_Price:  104.7873153892545
curr_Factors:  [104.78731539  -0.46227846  -1.06421332]
mat_Sqrt:  [[22.76993332  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00295486  0.02039172 -0.1638229 ]
Stock Position:  0.0029548616956848444
Bond Position:  [9.14905511]


portfolio before change:  [9.45837336]
curr_Stock_Price:  103.90695977254838
curr_Factors:  [103.90695977  -0.48493168  -1.06088958]
mat_Sqrt:  [[22.14639264  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00126246  0.0160252  -0.0235704 ]
Stock Position:  -0.0012624603644938173
Bond Position:  [9.58955178]


portfolio before change:  [9.45830441]
curr_Stock_Price:  105.86078852037613
curr_Factors:  [105.86078852  -0.55920412  -1.0527773 ]
mat_Sqrt:  [[21.11837476  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0090508   0.03831518 -0.11390952]
Stock Position:  0.009050801129322116
Bond Position:  [8.50017947]


portfolio before change:  [9.44516701]
curr_Stock_Price:  104.17445054813372
curr_Factors:  [104.17445055  -0.26936101  -1.0836537 ]
mat_Sqrt:  [[26.92491849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0021868   0.22330436 -1.33574648]
Stock Position:  0.0021867974262562533
Bond Position:  [9.21735859]


portfolio before change:  [9.44702268]
curr_Stock_Price:  103.96914420913079
curr_Factors:  [103.96914421  -0.3186988   -1.12084147]
mat_Sqrt:  [[24.64450343  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00349849 -0.01929556 -0.11644154]
Stock Position:  0.0034984869495899803
Bond Position:  [9.08328798]


portfolio before change:  [9.44687915]
curr_Stock_Price:  103.27895076293048
curr_Factors:  [103.27895076  -0.40457019  -1.10540903]
mat_Sqrt:  [[22.8158249   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0018297   0.00839579 -0.0493964 ]
Stock Position:  0.0018296971171765824
Bond Position:  [9.25790995]


portfolio before change:  [9.45464365]
curr_Stock_Price:  106.25743943827902
curr_Factors:  [106.25743944  -0.4036132   -1.08392765]
mat_Sqrt:  [[24.0064843   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273482  0.0053425   0.15524095]
Stock Position:  -0.0027348249365345316
Bond Position:  [9.74523915]


portfolio before change:  [9.44792342]
curr_Stock_Price:  109.60567782988214
curr_Factors:  [109.60567783  -0.67261355  -1.05114198]
mat_Sqrt:  [[19.55309608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072764 -0.08056591 -0.08777141]
Stock Position:  -0.0007276351709049404
Bond Position:  [9.52767637]


portfolio before change:  [9.45017515]
curr_Stock_Price:  109.78500590269006
curr_Factors:  [109.7850059   -0.47147397  -1.05710383]
mat_Sqrt:  [[23.80620269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00977252 -0.00749037 -0.21950206]
Stock Position:  -0.009772521456589646
Bond Position:  [10.52305148]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.42573473]
Stock Price:  112.5551723077419
PL:  [-3.12943758]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-6.88472883e-02  1.43208006e-01  1.68602029e-02]
 [ 1.22313995e-02  1.60466927e-02 -2.67132522e-02]
 [ 9.80977536e-02 -5.27748987e-02  3.39157137e-02]
 [-1.83629041e-02 -1.40835933e-02  9.58661886e-02]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-9.50980792e-01  8.40441279e-01 -8.84171539e-02]
 [ 3.31073553e-03  9.38525780e-03  7.58331344e-03]
 [-9.88695798e-03  3.85830267e-02 -6.35860991e-02]
 [ 1.23475611e-01  2.37782196e-02  3.75272867e-02]
 [ 1.54978732e-01  1.22503423e-01  9.21810380e-02]
 [-1.20651535e-02 -2.55858116e-02 -3.86784721e-02]
 [ 1.15916408e-01 -3.57902417e-02 -3.37610869e-02]
 [-8.57729288e-02 -7.38010452e-02  5.63710907e-02]
 [ 2.28007134e-02  3.39414711e-01 -2.34063766e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 4.86306081e-02  2.87375137e-02  3.44764929e-02]
 [-8.94619184e-02  1.77475130e-02  5.42746661e-02]
 [ 2.26535781e-02 -6.67311247e-02 -2.74998382e-02]
 [-3.88257192e-03 -4.80113426e-02 -1.30742859e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.64809647]
curr_Stock_Price:  99.50358111830899
curr_Factors:  [99.50358112 -0.90423396 -0.99157546]
mat_Sqrt:  [[14.94511079  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242042  0.04622019  0.04809747]
Stock Position:  -0.0024204238100284
Bond Position:  [-1.40725564]


portfolio before change:  [-1.64719744]
curr_Stock_Price:  98.98677386751815
curr_Factors:  [98.98677387 -0.96378801 -0.98588621]
mat_Sqrt:  [[14.08784006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071367  0.00517905 -0.07620547]
Stock Position:  0.0007136720104031042
Bond Position:  [-1.71784153]


portfolio before change:  [-1.64809232]
curr_Stock_Price:  98.33470157028529
curr_Factors:  [98.33470157 -1.28731533 -0.94866755]
mat_Sqrt:  [[10.51070324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00896687 -0.01703303  0.09675209]
Stock Position:  0.008966872760314812
Bond Position:  [-2.52984708]


portfolio before change:  [-1.65394365]
curr_Stock_Price:  97.75269322047042
curr_Factors:  [97.75269322 -1.0615631  -0.98458598]
mat_Sqrt:  [[12.63273766  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.32125100e-04 -4.54546020e-03  2.73479552e-01]
Stock Position:  -0.0001321251000492632
Bond Position:  [-1.64102807]


portfolio before change:  [-1.65421984]
curr_Stock_Price:  96.73756950343089
curr_Factors:  [96.7375695  -1.46247658 -0.9193284 ]
mat_Sqrt:  [[ 8.93697234  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00635533 -0.04522423  0.24245377]
Stock Position:  0.006355327054254183
Bond Position:  [-2.26901873]


portfolio before change:  [-1.65576665]
curr_Stock_Price:  96.5834491297048
curr_Factors:  [96.58344913 -1.14168613 -0.94062736]
mat_Sqrt:  [[12.03830809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06624473  0.27125126 -0.25222953]
Stock Position:  -0.0662447334401728
Bond Position:  [4.74237819]


portfolio before change:  [-1.75099186]
curr_Stock_Price:  98.03882446578355
curr_Factors:  [98.03882447 -1.17472095 -0.96256391]
mat_Sqrt:  [[11.56610359  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00058571 0.00302908 0.02163308]
Stock Position:  0.0005857141582114034
Bond Position:  [-1.80841459]


portfolio before change:  [-1.75144639]
curr_Stock_Price:  98.03478134918015
curr_Factors:  [98.03478135 -1.14830261 -1.01317729]
mat_Sqrt:  [[11.28915382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132788  0.01245262 -0.18139344]
Stock Position:  -0.0013278841803298657
Bond Position:  [-1.62126755]


portfolio before change:  [-1.75218016]
curr_Stock_Price:  98.28209669738655
curr_Factors:  [98.2820967  -1.15526956 -0.96776549]
mat_Sqrt:  [[11.76121004  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01156255 0.00767439 0.1070549 ]
Stock Position:  0.011562547057428587
Bond Position:  [-2.88857153]


portfolio before change:  [-1.75760473]
curr_Stock_Price:  97.87540960906557
curr_Factors:  [97.87540961 -0.59763172 -0.95362329]
mat_Sqrt:  [[20.74780225  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00958179 0.03953781 0.26296684]
Stock Position:  0.009581786625483224
Bond Position:  [-2.69542602]


portfolio before change:  [-1.76712784]
curr_Stock_Price:  96.95186973095073
curr_Factors:  [96.95186973 -0.26252252 -0.95275223]
mat_Sqrt:  [[28.75868813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00087567 -0.00825779 -0.11033891]
Stock Position:  -0.000875667394295499
Bond Position:  [-1.68223024]


portfolio before change:  [-1.76751796]
curr_Stock_Price:  96.91705592415822
curr_Factors:  [96.91705592 -0.40727085 -0.91210472]
mat_Sqrt:  [[25.90613863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00392646 -0.01155125 -0.09631098]
Stock Position:  0.003926455594675887
Bond Position:  [-2.14805848]


portfolio before change:  [-1.75662337]
curr_Stock_Price:  99.8285039078076
curr_Factors:  [99.82850391 -0.35476975 -0.92113714]
mat_Sqrt:  [[27.86988919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00320528 -0.02381918  0.16081103]
Stock Position:  -0.0032052801779348153
Bond Position:  [-1.43664505]


portfolio before change:  [-1.75337013]
curr_Stock_Price:  98.70147325623628
curr_Factors:  [98.70147326 -0.25578885 -0.92698593]
mat_Sqrt:  [[30.24482487  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00146489  0.10954563 -0.66771877]
Stock Position:  0.0014648914323098497
Bond Position:  [-1.89795707]


portfolio before change:  [-1.75415058]
curr_Stock_Price:  98.49264634430394
curr_Factors:  [98.49264634 -0.63809524 -0.94209597]
mat_Sqrt:  [[20.28315368  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00655682 -0.09296045 -0.18429859]
Stock Position:  -0.006556824478753248
Bond Position:  [-1.10835159]


portfolio before change:  [-1.75483028]
curr_Stock_Price:  98.55404403334893
curr_Factors:  [98.55404403 -0.64823702 -0.92069948]
mat_Sqrt:  [[20.52551132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00299793 0.00927499 0.09835184]
Stock Position:  0.00299793326441487
Bond Position:  [-2.05028873]


portfolio before change:  [-1.75149682]
curr_Stock_Price:  99.83695915459205
curr_Factors:  [99.83695915 -0.92407823 -0.90951414]
mat_Sqrt:  [[15.95777346  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00468489  0.00572799  0.15483052]
Stock Position:  -0.004684892467077488
Bond Position:  [-1.28377141]


portfolio before change:  [-1.74940643]
curr_Stock_Price:  99.32224684542928
curr_Factors:  [99.32224685 -0.96744132 -0.90628122]
mat_Sqrt:  [[15.25103008  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00022417 -0.02153738 -0.07844938]
Stock Position:  0.00022416605961010852
Bond Position:  [-1.77167111]


portfolio before change:  [-1.75001033]
curr_Stock_Price:  98.60435885298809
curr_Factors:  [98.60435885 -0.74037823 -0.892694  ]
mat_Sqrt:  [[19.26024729  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209606 -0.01549559 -0.37297299]
Stock Position:  -0.00209605930486901
Bond Position:  [-1.54332975]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.75006332]
Stock Price:  98.44554118463776
PL:  [-1.75006332]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.38602283e-01  2.28080920e-01 -1.37088380e-02]
 [ 1.85313909e-02  3.80626372e-02 -8.40704675e-02]
 [-1.44440665e-02 -1.25763281e-02 -1.30629778e-02]
 [-1.62271517e-01 -1.35200523e-01  5.52519707e-01]
 [ 3.73625637e-02 -9.48171184e-02  5.44761592e-02]
 [-9.72819495e-01  9.80061412e-01 -1.30186997e-01]
 [ 1.19574595e-03  7.85849654e-03  9.66092123e-03]
 [-8.86883080e-02 -1.66413099e-02 -2.29295488e-02]
 [ 2.97629547e-03  2.12060741e-02  5.79530601e-02]
 [-2.83007782e-01  2.24190244e-01 -1.35781747e-01]
 [ 1.18014560e-01  3.22239828e-02 -5.26930003e-02]
 [-2.04090839e-02  1.40567938e-01 -3.51570586e-03]
 [-5.26662816e-02 -7.16976550e-02 -2.05672454e-02]
 [ 1.58276623e-02  7.24572886e-01 -4.77284285e-01]
 [ 9.87239452e-02 -6.09014818e-02 -4.22453973e-02]
 [ 4.55982269e-02  2.80987650e-02  3.84731767e-02]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.55043806e-02 -2.03120736e-01 -3.40716625e-02]
 [-1.74220289e-01  2.18039027e-02 -3.45150692e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.81993427]
curr_Stock_Price:  98.34736407344037
curr_Factors:  [98.34736407 -0.94511242 -0.95214832]
mat_Sqrt:  [[14.75002827  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00643007  0.0736128  -0.0391075 ]
Stock Position:  -0.006430073457479885
Bond Position:  [-10.18755349]


portfolio before change:  [-10.82729842]
curr_Stock_Price:  99.09649215434159
curr_Factors:  [99.09649215 -0.90687122 -0.93993945]
mat_Sqrt:  [[15.63142604  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00058472  0.01228466 -0.23982964]
Stock Position:  0.0005847247615159814
Bond Position:  [-10.8852426]


portfolio before change:  [-10.82975529]
curr_Stock_Price:  99.54933439833319
curr_Factors:  [99.5493344  -1.21379872 -0.92873535]
mat_Sqrt:  [[11.68281868  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168433 -0.00405899 -0.03726504]
Stock Position:  -0.0016843253685312385
Bond Position:  [-10.66208182]


portfolio before change:  [-10.83366718]
curr_Stock_Price:  100.28912053409252
curr_Factors:  [100.28912053  -1.20263276  -0.94530066]
mat_Sqrt:  [[11.70626061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00658507 -0.04363578  1.57618493]
Stock Position:  -0.006585074274124827
Bond Position:  [-10.17325587]


portfolio before change:  [-10.83480058]
curr_Stock_Price:  100.07496507644753
curr_Factors:  [100.07496508  -1.21762799  -0.97007196]
mat_Sqrt:  [[11.22585508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00259472 -0.03060209  0.15540532]
Stock Position:  0.002594724380841309
Bond Position:  [-11.09446754]


portfolio before change:  [-10.83712319]
curr_Stock_Price:  100.24891677719481
curr_Factors:  [100.24891678  -1.15141771  -0.95889221]
mat_Sqrt:  [[12.15020856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06578814  0.31631346 -0.37138726]
Stock Position:  -0.06578813876223781
Bond Position:  [-4.24193354]


portfolio before change:  [-10.82496685]
curr_Stock_Price:  100.04801502305429
curr_Factors:  [100.04801502  -1.34128998  -0.98968711]
mat_Sqrt:  [[ 9.7247397   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0004907  0.00253632 0.02755992]
Stock Position:  0.0004906951006954551
Bond Position:  [-10.87405993]


portfolio before change:  [-10.8276406]
curr_Stock_Price:  100.13994555172911
curr_Factors:  [100.13994555  -0.94907053  -1.01453872]
mat_Sqrt:  [[14.05473593  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00688492 -0.00537096 -0.06541162]
Stock Position:  -0.0068849159638555745
Bond Position:  [-10.13818549]


portfolio before change:  [-10.84260499]
curr_Stock_Price:  101.94527230514221
curr_Factors:  [101.94527231  -1.00325962  -1.02595521]
mat_Sqrt:  [[13.39955222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.001428   0.00684423 0.16532395]
Stock Position:  0.0014280019029684315
Bond Position:  [-10.98818303]


portfolio before change:  [-10.84644101]
curr_Stock_Price:  101.182922578866
curr_Factors:  [101.18292258  -1.05506489  -1.04873388]
mat_Sqrt:  [[12.34351993  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02146563  0.07235709 -0.38734753]
Stock Position:  -0.021465633341259602
Bond Position:  [-8.6744855]


portfolio before change:  [-10.84151792]
curr_Stock_Price:  100.85253478439363
curr_Factors:  [100.85253478  -1.12971088  -1.02246067]
mat_Sqrt:  [[11.7222395   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00971114  0.01040025 -0.15031846]
Stock Position:  0.00971114258226174
Bond Position:  [-11.82091127]


portfolio before change:  [-10.84634822]
curr_Stock_Price:  100.65948814435374
curr_Factors:  [100.65948814  -0.79260332  -1.03681846]
mat_Sqrt:  [[16.15648683  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00046833  0.04536811 -0.01002933]
Stock Position:  0.0004683311404480836
Bond Position:  [-10.89349019]


portfolio before change:  [-10.84867792]
curr_Stock_Price:  101.50081219341796
curr_Factors:  [101.50081219  -0.58203127  -0.99505721]
mat_Sqrt:  [[20.96759849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00341001 -0.02314032 -0.05867263]
Stock Position:  -0.00341001262302668
Bond Position:  [-10.50255887]


portfolio before change:  [-10.85909972]
curr_Stock_Price:  103.78697230672678
curr_Factors:  [103.78697231  -0.54375238  -1.00138428]
mat_Sqrt:  [[22.13596801  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00299536  0.23385489 -1.36155922]
Stock Position:  0.0029953619582477
Bond Position:  [-11.16997927]


portfolio before change:  [-10.86313595]
curr_Stock_Price:  103.37186887937172
curr_Factors:  [103.37186888  -0.66840129  -0.99342769]
mat_Sqrt:  [[19.61910603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00395885 -0.01965587 -0.12051436]
Stock Position:  0.003958854016462481
Bond Position:  [-11.27237009]


portfolio before change:  [-10.86813994]
curr_Stock_Price:  102.81980307786534
curr_Factors:  [102.81980308  -0.59107713  -0.9563416 ]
mat_Sqrt:  [[21.87969948  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00270512 0.00906884 0.10975326]
Stock Position:  0.0027051179399924944
Bond Position:  [-11.14627963]


portfolio before change:  [-10.8654233]
curr_Stock_Price:  104.85430186403782
curr_Factors:  [104.85430186  -1.02883344  -0.95545672]
mat_Sqrt:  [[14.41517724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00477204  0.00525786  0.16709793]
Stock Position:  -0.00477204093864866
Bond Position:  [-10.36505428]


portfolio before change:  [-10.87413438]
curr_Stock_Price:  106.13666486275972
curr_Factors:  [106.13666486  -1.19260121  -0.98811311]
mat_Sqrt:  [[11.98928385  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024291 -0.06555694 -0.09719697]
Stock Position:  -0.00024290983998722596
Bond Position:  [-10.84835274]


portfolio before change:  [-10.8767847]
curr_Stock_Price:  105.8809907020174
curr_Factors:  [105.8809907   -1.09412078  -0.97565791]
mat_Sqrt:  [[13.3636327   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01323105  0.00703718 -0.09846189]
Stock Position:  -0.013231053956504327
Bond Position:  [-9.4758676]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.89531589]
Stock Price:  107.102505852661
PL:  [-17.99782175]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-9.38627596e-02  1.73645051e-01  5.89756194e-03]
 [ 3.43145688e-02  1.73513229e-01 -2.34681437e-01]
 [-8.35376702e-02  3.63356764e-02 -1.22755339e-02]
 [-1.79301628e-01 -1.52263735e-01  6.76695950e-01]
 [ 2.28326726e-03 -4.30300947e-02  1.95961880e-02]
 [-8.96851033e-01  8.98873343e-01 -1.11805162e-01]
 [-3.73662822e-03  2.04581597e-02 -1.25397348e-02]
 [-6.43239974e-02  5.57948397e-03 -4.42307275e-02]
 [ 1.25775733e-01  2.39357439e-02  3.87938596e-02]
 [ 1.55222387e-01  1.25095885e-01  9.53183405e-02]
 [-1.52956131e-03  3.00444692e-02 -5.14545859e-02]
 [-8.13051763e-02  1.27795559e-01  1.18882287e-01]
 [-7.22266472e-02 -6.64914667e-02  8.87236715e-02]
 [ 4.37537863e-02  3.45074940e-01 -1.35985128e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 6.55073772e-02  4.06160483e-02  2.07752224e-01]
 [-5.63495282e-03  1.65954560e-02  9.61813014e-02]
 [ 3.94607333e-02 -1.11992943e-01 -3.38308387e-02]
 [-9.46686920e-02  2.14570506e-01 -1.89466895e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.19858821]
curr_Stock_Price:  99.18206191134684
curr_Factors:  [99.18206191 -0.79202176 -1.00780753]
mat_Sqrt:  [[16.39748363  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00348918  0.0560437   0.0168241 ]
Stock Position:  -0.0034891803168534204
Bond Position:  [-3.85252411]


portfolio before change:  [-4.2060685]
curr_Stock_Price:  101.04984915357603
curr_Factors:  [101.04984915  -0.98493416  -1.02782226]
mat_Sqrt:  [[13.50226608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00161667  0.05600115 -0.66948082]
Stock Position:  0.0016166664592241946
Bond Position:  [-4.36943241]


portfolio before change:  [-4.20771574]
curr_Stock_Price:  100.7067104679389
curr_Factors:  [100.70671047  -1.30057478  -1.05428893]
mat_Sqrt:  [[ 9.55771539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00822649  0.01172729 -0.03501868]
Stock Position:  -0.008226486247114674
Bond Position:  [-3.37925337]


portfolio before change:  [-4.21176204]
curr_Stock_Price:  101.09586556613907
curr_Factors:  [101.09586557  -1.19541635  -1.05973445]
mat_Sqrt:  [[10.600683    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00681582 -0.04914291  1.93042519]
Stock Position:  -0.006815820316441135
Bond Position:  [-3.52271078]


portfolio before change:  [-4.21508875]
curr_Stock_Price:  101.45472577964914
curr_Factors:  [101.45472578  -1.27023425  -1.04094683]
mat_Sqrt:  [[10.05863601  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024856 -0.0138879   0.05590247]
Stock Position:  -0.0002485584428900014
Bond Position:  [-4.18987132]


portfolio before change:  [-4.21578954]
curr_Stock_Price:  100.0594202215148
curr_Factors:  [100.05942022  -1.44172392  -1.03171561]
mat_Sqrt:  [[ 8.43445147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08728385  0.29011012 -0.31894901]
Stock Position:  -0.08728385197545276
Bond Position:  [4.51778209]


portfolio before change:  [-4.19242809]
curr_Stock_Price:  99.80471264954919
curr_Factors:  [99.80471265 -0.82859708 -1.01742567]
mat_Sqrt:  [[15.75554953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00013457  0.00660284 -0.03577237]
Stock Position:  -0.00013457394840266497
Bond Position:  [-4.17899698]


portfolio before change:  [-4.19343801]
curr_Stock_Price:  99.54492970994569
curr_Factors:  [99.54492971 -1.15219968 -1.04102575]
mat_Sqrt:  [[11.10486905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00650288  0.00180077 -0.12617795]
Stock Position:  -0.006502881672007113
Bond Position:  [-3.54610911]


portfolio before change:  [-4.18741506]
curr_Stock_Price:  98.48238639931107
curr_Factors:  [98.4823864  -1.12635391 -1.04144488]
mat_Sqrt:  [[11.26926301  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0122972  0.00772523 0.11066808]
Stock Position:  0.012297198071035976
Bond Position:  [-5.39847247]


portfolio before change:  [-4.18696878]
curr_Stock_Price:  98.62844135671094
curr_Factors:  [98.62844136 -0.81261821 -1.01846809]
mat_Sqrt:  [[15.80416266  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01266845 0.04037452 0.27191669]
Stock Position:  0.012668450525368505
Bond Position:  [-5.43643831]


portfolio before change:  [-4.20803164]
curr_Stock_Price:  97.07311463541396
curr_Factors:  [97.07311464 -0.95842083 -1.01261298]
mat_Sqrt:  [[13.52352348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043627  0.00969681 -0.14678561]
Stock Position:  -0.00043626818775522176
Bond Position:  [-4.16568172]


portfolio before change:  [-4.20947303]
curr_Stock_Price:  97.98961429845788
curr_Factors:  [97.9896143  -1.32581398 -1.01147877]
mat_Sqrt:  [[ 9.46469672  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00327029  0.04124584  0.33913808]
Stock Position:  -0.0032702866903558535
Bond Position:  [-3.88901889]


portfolio before change:  [-4.21011065]
curr_Stock_Price:  97.8872527021502
curr_Factors:  [97.8872527  -1.05173518 -0.98979576]
mat_Sqrt:  [[12.70868213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00532616 -0.02146003  0.25310394]
Stock Position:  -0.005326163378406252
Bond Position:  [-3.68874715]


portfolio before change:  [-4.21101439]
curr_Stock_Price:  97.88376770344897
curr_Factors:  [97.8837677  -1.23428496 -0.99647366]
mat_Sqrt:  [[10.51730624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00821827  0.11137246 -0.38792772]
Stock Position:  0.008218270283165383
Bond Position:  [-5.01544965]


portfolio before change:  [-4.20657137]
curr_Stock_Price:  98.57698427013169
curr_Factors:  [98.57698427 -1.43362062 -0.9980601 ]
mat_Sqrt:  [[ 8.66383176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01535038 -0.09296045 -0.18429859]
Stock Position:  -0.01535037639662334
Bond Position:  [-2.69337756]


portfolio before change:  [-4.21750245]
curr_Stock_Price:  99.24521879437816
curr_Factors:  [99.24521879 -1.65053266 -0.97897625]
mat_Sqrt:  [[ 7.15695655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0162367  0.01310877 0.59265927]
Stock Position:  0.016236697513518267
Bond Position:  [-5.82891705]


portfolio before change:  [-4.21398931]
curr_Stock_Price:  99.55134909069902
curr_Factors:  [99.55134909 -1.62791075 -0.96334242]
mat_Sqrt:  [[ 7.4589929   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00233081 0.00535616 0.27437848]
Stock Position:  0.0023308114946621237
Bond Position:  [-4.44602474]


portfolio before change:  [-4.2152368]
curr_Stock_Price:  99.49307009640332
curr_Factors:  [99.4930701  -1.45216302 -0.93615504]
mat_Sqrt:  [[ 9.13186488  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00106162 -0.03614557 -0.09650997]
Stock Position:  0.0010616208990791884
Bond Position:  [-4.32086072]


portfolio before change:  [-4.21750823]
curr_Stock_Price:  98.37112561258665
curr_Factors:  [98.37112561 -1.57087167 -0.95047999]
mat_Sqrt:  [[ 7.90421102  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00692506  0.06925233 -0.05404963]
Stock Position:  -0.006925061529801925
Bond Position:  [-3.53628213]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.22061927]
Stock Price:  98.69269100005812
PL:  [-4.22061927]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-3.98998566e-02  2.93108713e-02  3.81715373e-02]
 [ 3.39622676e-02  1.46610889e-01 -2.01662905e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-2.22979373e-01 -2.14298297e-01  7.18128020e-01]
 [-3.38128747e-02  1.02580824e-02 -1.62948507e-02]
 [-1.05454719e+00  1.03967064e+00 -1.36168606e-01]
 [-4.70696407e-03  2.21960156e-02 -1.53021197e-02]
 [-6.43139120e-02  6.01586325e-03 -4.52192532e-02]
 [ 7.42448986e-02  3.04207772e-02  6.13944275e-02]
 [-3.72308534e-01  2.43393374e-01 -1.83999362e-01]
 [ 1.23717523e-01  3.63907542e-02 -5.34233935e-02]
 [-1.08562605e-01  1.13456006e-01  1.83923688e-01]
 [-9.95542823e-02 -1.18297667e-01 -5.97246278e-02]
 [ 3.49817610e-02  7.11757170e-01 -4.17896750e-01]
 [ 6.57659259e-02 -1.04287433e-01 -4.69611826e-02]
 [ 6.50600236e-02  4.87294305e-02  2.03127224e-01]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.06863893e-02 -1.19841451e-01 -3.92450181e-02]
 [-1.10946206e-01  3.93187645e-02 -2.21368651e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.85086637]
curr_Stock_Price:  100.19678947027867
curr_Factors:  [100.19678947  -1.12971095  -1.03571048]
mat_Sqrt:  [[11.49273068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227318  0.00946004  0.10889277]
Stock Position:  -0.0022731819199368615
Bond Position:  [4.0786319]


portfolio before change:  [3.85114223]
curr_Stock_Price:  100.5240477667391
curr_Factors:  [100.52404777  -1.06552581  -1.05239756]
mat_Sqrt:  [[12.09114792  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00187946  0.04731846 -0.57528814]
Stock Position:  0.0018794594157170012
Bond Position:  [3.66221137]


portfolio before change:  [3.85112897]
curr_Stock_Price:  100.0297926289315
curr_Factors:  [100.02979263  -0.95679707  -1.08974702]
mat_Sqrt:  [[12.92190553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00603802  0.01370813 -0.02999186]
Stock Position:  -0.006038021118447472
Bond Position:  [4.45511097]


portfolio before change:  [3.85125965]
curr_Stock_Price:  100.19263370881639
curr_Factors:  [100.19263371  -0.92661567  -1.06336532]
mat_Sqrt:  [[13.69613508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00877149 -0.06916448  2.04861935]
Stock Position:  -0.008771493595032643
Bond Position:  [4.73009869]


portfolio before change:  [3.85508742]
curr_Stock_Price:  99.89107769041718
curr_Factors:  [99.89107769 -0.90317866 -1.05088146]
mat_Sqrt:  [[14.15432524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247593  0.00331078 -0.04648467]
Stock Position:  -0.002475930450828444
Bond Position:  [4.10241078]


portfolio before change:  [3.85813566]
curr_Stock_Price:  99.07420667614346
curr_Factors:  [99.07420668 -1.21126294 -1.05214958]
mat_Sqrt:  [[10.30322152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08445132  0.33555226 -0.38845113]
Stock Position:  -0.08445131528445758
Bond Position:  [12.22508273]


portfolio before change:  [3.84329925]
curr_Stock_Price:  99.28608102840202
curr_Factors:  [99.28608103 -1.19961434 -1.05354886]
mat_Sqrt:  [[10.43162646  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00031632  0.00716373 -0.04365269]
Stock Position:  -0.00031632204868497224
Bond Position:  [3.87470562]


portfolio before change:  [3.84418784]
curr_Stock_Price:  99.53962687566273
curr_Factors:  [99.53962688 -1.13085836 -1.04976104]
mat_Sqrt:  [[11.24514438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00643089  0.00194161 -0.12899794]
Stock Position:  -0.006430888571011444
Bond Position:  [4.48431609]


portfolio before change:  [3.84040358]
curr_Stock_Price:  100.30242639966171
curr_Factors:  [100.3024264   -1.29664364  -1.04242372]
mat_Sqrt:  [[ 9.67091107  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00961508 0.00981826 0.17514121]
Stock Position:  0.00961508156836479
Bond Position:  [2.87598757]


portfolio before change:  [3.85368727]
curr_Stock_Price:  101.60918560689315
curr_Factors:  [101.60918561  -1.23617092  -1.05854314]
mat_Sqrt:  [[10.24121108  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03517014  0.07855487 -0.52489896]
Stock Position:  -0.0351701355296188
Bond Position:  [7.4272961]


portfolio before change:  [3.82360825]
curr_Stock_Price:  102.51723078948311
curr_Factors:  [102.51723079  -1.44713006  -1.09095336]
mat_Sqrt:  [[ 8.10067565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0148433   0.01174507 -0.15240207]
Stock Position:  0.014843298909445532
Bond Position:  [2.30191435]


portfolio before change:  [3.82284684]
curr_Stock_Price:  102.42715877727763
curr_Factors:  [102.42715878  -1.50132582  -1.07468099]
mat_Sqrt:  [[ 7.79237033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00614193  0.03661777  0.52468309]
Stock Position:  -0.0061419346162234
Bond Position:  [4.45194775]


portfolio before change:  [3.82151827]
curr_Stock_Price:  102.82470349542241
curr_Factors:  [102.8247035   -1.56826164  -1.04675139]
mat_Sqrt:  [[ 7.52335815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0180628  -0.03818041 -0.17037774]
Stock Position:  -0.018062802334077064
Bond Position:  [5.67882056]


portfolio before change:  [3.8250521]
curr_Stock_Price:  102.70767043901193
curr_Factors:  [102.70767044  -1.45906663  -1.06002714]
mat_Sqrt:  [[ 8.27131108  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01148134  0.22971864 -1.19214311]
Stock Position:  0.011481344029014347
Bond Position:  [2.64583]


portfolio before change:  [3.81700177]
curr_Stock_Price:  101.94888601568985
curr_Factors:  [101.94888602  -1.25115107  -1.05750127]
mat_Sqrt:  [[10.13322099  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00344337 -0.03365862 -0.13396718]
Stock Position:  0.0034433702277608296
Bond Position:  [3.46595401]


portfolio before change:  [3.81507674]
curr_Stock_Price:  101.1381603565512
curr_Factors:  [101.13816036  -1.37521162  -1.03304726]
mat_Sqrt:  [[ 9.09958335  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01279949 0.01572736 0.57946543]
Stock Position:  0.012799492385006264
Bond Position:  [2.52055963]


portfolio before change:  [3.81503357]
curr_Stock_Price:  101.08554989283662
curr_Factors:  [101.08554989  -1.03126119  -0.98065347]
mat_Sqrt:  [[13.51841094  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0050886   0.00525786  0.16709793]
Stock Position:  -0.005088602222267396
Bond Position:  [4.32941772]


portfolio before change:  [3.8178741]
curr_Stock_Price:  100.74006445394471
curr_Factors:  [100.74006445  -0.83648627  -0.9882678 ]
mat_Sqrt:  [[16.24507043  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00050557 -0.03867866 -0.11195511]
Stock Position:  0.0005055687440118157
Bond Position:  [3.76694307]


portfolio before change:  [3.81933443]
curr_Stock_Price:  101.76559962788966
curr_Factors:  [101.76559963  -0.52751673  -1.01259879]
mat_Sqrt:  [[21.81410133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00492521  0.01269008 -0.06315031]
Stock Position:  -0.004925207038521526
Bond Position:  [4.32055108]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.83473007]
Stock Price:  98.85904783046355
PL:  [3.83473007]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 4.43927817e-02 -1.04637384e-01  5.44739548e-02]
 [ 1.93033821e-02  1.37856399e-01 -1.71516668e-01]
 [-4.07245510e-02 -7.99544628e-02 -1.19754670e-01]
 [-8.95418970e-02 -3.08757923e-02  4.95718350e-01]
 [ 6.06357606e-02 -1.29174980e-01  7.76171146e-02]
 [-5.33439680e-01  5.57561550e-01 -5.23893628e-02]
 [ 1.09668551e-02 -7.46930969e-03  3.27716477e-02]
 [-9.25492651e-02 -1.75942700e-02 -2.57091272e-02]
 [-5.94509906e-03  2.05242653e-02  5.73860038e-02]
 [-2.45324817e-01  2.14533139e-01 -1.17200784e-01]
 [ 1.17753940e-01  3.29359061e-02 -5.28087197e-02]
 [-8.27229992e-02  1.27049673e-01  1.22265482e-01]
 [-5.34146412e-02 -1.06003151e-01 -1.00841809e-01]
 [ 3.98867635e-02  8.47403568e-01 -4.75446974e-01]
 [ 1.30730046e-01 -6.11083192e-02 -2.02627003e-02]
 [ 4.30903862e-02 -1.60910390e-02  1.04776255e-01]
 [-7.05091915e-02  1.57410418e-02  6.65443234e-02]
 [ 4.58627626e-02 -1.62813329e-01 -3.74013888e-02]
 [-1.02363145e-01  1.40857173e-01 -4.95475363e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.53599315]
curr_Stock_Price:  101.66983588233592
curr_Factors:  [101.66983588  -1.24416251  -1.00197887]
mat_Sqrt:  [[10.75735047  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00317487 -0.03377157  0.15539903]
Stock Position:  0.0031748723583022516
Bond Position:  [15.2132044]


portfolio before change:  [15.54037241]
curr_Stock_Price:  101.85109864741675
curr_Factors:  [101.85109865  -1.19217355  -0.98737062]
mat_Sqrt:  [[11.51865336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107934  0.04449296 -0.48928931]
Stock Position:  0.0010793369902219148
Bond Position:  [15.43044075]


portfolio before change:  [15.54429347]
curr_Stock_Price:  101.90943430051283
curr_Factors:  [101.9094343   -1.54039457  -0.97438468]
mat_Sqrt:  [[ 8.24251292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00988655 -0.02580519 -0.34162674]
Stock Position:  -0.009886548897303461
Bond Position:  [16.55182607]


portfolio before change:  [15.54825765]
curr_Stock_Price:  101.92706384281679
curr_Factors:  [101.92706384  -1.66099412  -0.96358278]
mat_Sqrt:  [[ 7.38669638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.23421186e-04 -9.96511913e-03  1.41414647e+00]
Stock Position:  0.0007234211857279436
Bond Position:  [15.47452145]


portfolio before change:  [15.55203172]
curr_Stock_Price:  101.79568904992469
curr_Factors:  [101.79568905  -1.58066108  -0.93194574]
mat_Sqrt:  [[ 8.25121892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00607323 -0.04169105  0.22142002]
Stock Position:  0.006073230632062851
Bond Position:  [14.93380302]


portfolio before change:  [15.55707632]
curr_Stock_Price:  102.01150227660574
curr_Factors:  [102.01150228  -1.80325023  -0.90733804]
mat_Sqrt:  [[ 6.78352793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06343629  0.17995222 -0.14945227]
Stock Position:  -0.06343628910837762
Bond Position:  [22.02830747]


portfolio before change:  [15.62085262]
curr_Stock_Price:  101.09296596089301
curr_Factors:  [101.09296596  -1.60458704  -0.88404926]
mat_Sqrt:  [[ 8.3930522   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00192203 -0.00241071  0.09348839]
Stock Position:  0.0019220270342731876
Bond Position:  [15.42654921]


portfolio before change:  [15.62524565]
curr_Stock_Price:  101.37179290290732
curr_Factors:  [101.3717929   -1.60880638  -0.91540847]
mat_Sqrt:  [[ 8.12202914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01248315 -0.00567853 -0.07334098]
Stock Position:  -0.012483153195807435
Bond Position:  [16.89068527]


portfolio before change:  [15.62782526]
curr_Stock_Price:  101.50345777469445
curr_Factors:  [101.50345777  -1.35617191  -0.90952888]
mat_Sqrt:  [[10.53172436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00094555 0.00662418 0.1637063 ]
Stock Position:  0.0009455496254108246
Bond Position:  [15.5318487]


portfolio before change:  [15.63148581]
curr_Stock_Price:  101.26772077588387
curr_Factors:  [101.26772078  -1.23256608  -0.92028541]
mat_Sqrt:  [[11.76249669  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01916744  0.06924027 -0.33434122]
Stock Position:  -0.019167438589767976
Bond Position:  [17.57252863]


portfolio before change:  [15.62451924]
curr_Stock_Price:  101.86040552231213
curr_Factors:  [101.86040552  -1.30801833  -0.9362597 ]
mat_Sqrt:  [[10.79761494  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01052986  0.01063002 -0.15064858]
Stock Position:  0.010529864203898008
Bond Position:  [14.551943]


portfolio before change:  [15.63968697]
curr_Stock_Price:  102.95531874614196
curr_Factors:  [102.95531875  -1.31390022  -0.95847011]
mat_Sqrt:  [[10.61135618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00299978  0.04100511  0.34878939]
Stock Position:  -0.002999782098268613
Bond Position:  [15.94853049]


portfolio before change:  [15.64332679]
curr_Stock_Price:  103.07126349370208
curr_Factors:  [103.07126349  -1.8257457   -0.95206326]
mat_Sqrt:  [[ 6.40841305  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01492362 -0.03421237 -0.28767361]
Stock Position:  -0.014923615439756168
Bond Position:  [17.18152269]


portfolio before change:  [15.64528054]
curr_Stock_Price:  103.22820747011218
curr_Factors:  [103.22820747  -1.85830916  -0.955811  ]
mat_Sqrt:  [[ 6.18929997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01871166  0.27349833 -1.35631788]
Stock Position:  0.018711661385209955
Bond Position:  [13.71370927]


portfolio before change:  [15.64880666]
curr_Stock_Price:  103.2334055520191
curr_Factors:  [103.23340555  -1.88016736  -0.9731568 ]
mat_Sqrt:  [[ 5.95164908  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01917456 -0.01972263 -0.05780384]
Stock Position:  0.019174560690642235
Bond Position:  [13.66935146]


portfolio before change:  [15.64139103]
curr_Stock_Price:  102.66841794063482
curr_Factors:  [102.66841794  -1.61995608  -0.97035541]
mat_Sqrt:  [[ 7.69979006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00794738 -0.00519336  0.29889749]
Stock Position:  0.00794738294634685
Bond Position:  [14.8254458]


portfolio before change:  [15.64275529]
curr_Stock_Price:  102.37365816700095
curr_Factors:  [102.37365817  -1.68470485  -0.95127115]
mat_Sqrt:  [[ 7.33497081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00732283  0.0050804   0.18983243]
Stock Position:  -0.007322832364823953
Bond Position:  [16.39242043]


portfolio before change:  [15.64888963]
curr_Stock_Price:  102.0956618303813
curr_Factors:  [102.09566183  -1.72474536  -0.97443542]
mat_Sqrt:  [[ 6.86701459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00072726 -0.05254778 -0.10669575]
Stock Position:  0.0007272599087232866
Bond Position:  [15.57463954]


portfolio before change:  [15.65295791]
curr_Stock_Price:  102.33510504703685
curr_Factors:  [102.33510505  -1.50064323  -0.98834033]
mat_Sqrt:  [[ 8.49322866  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00878608  0.04546146 -0.01413453]
Stock Position:  -0.00878607926140059
Bond Position:  [16.55208225]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.66138364]
Stock Price:  101.84715225069247
PL:  [13.81423139]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.59192719e-02  4.63698077e-02  3.51364083e-02]
 [ 3.98160870e-02  1.77981053e-01 -2.69028962e-01]
 [ 1.74885640e-02 -2.64271824e-02 -2.19224279e-02]
 [-1.54933141e-01 -1.27156154e-01  4.45969621e-01]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-1.28001329e+00  1.26818778e+00 -1.81137024e-01]
 [ 3.41607304e-04  1.31541051e-02 -9.29675898e-04]
 [ 4.22718644e-02  1.62754219e-02 -5.03633739e-02]
 [ 1.03877974e-01  2.66411970e-02  5.16004373e-02]
 [ 1.55068114e-01  1.23454438e-01  9.33319220e-02]
 [ 6.75867019e-02 -1.67141244e-03 -5.25496291e-02]
 [ 8.61029036e-02  2.77815353e-03 -2.71466174e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-2.83015243e-02 -6.55763638e-02  3.46715523e-02]
 [-5.23621348e-02 -2.65845025e-01 -5.21215649e-02]
 [ 4.77354318e-02  3.26198568e-02 -2.32127147e-02]
 [ 1.61480381e-01  1.54034125e-03  1.58335898e-01]
 [-6.07023294e-02  2.54205054e-02  6.93845607e-02]
 [ 1.24180768e-02  1.49937515e-01 -1.41930028e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.52218955]
curr_Stock_Price:  99.77717096393307
curr_Factors:  [99.77717096 -1.11106087 -0.96449426]
mat_Sqrt:  [[12.52071254  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00233868  0.01496579  0.10023439]
Stock Position:  -0.0023386756240808635
Bond Position:  [0.75553598]


portfolio before change:  [0.52047955]
curr_Stock_Price:  100.58912592571451
curr_Factors:  [100.58912593  -0.83744595  -0.99369852]
mat_Sqrt:  [[16.11740414  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00131727  0.05744314 -0.76746475]
Stock Position:  0.001317272321774902
Bond Position:  [0.38797628]


portfolio before change:  [0.51906218]
curr_Stock_Price:  99.43948939638028
curr_Factors:  [99.4394894  -1.01139572 -0.97238294]
mat_Sqrt:  [[13.6777531   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00055705 -0.00852934 -0.06253858]
Stock Position:  0.0005570535619194081
Bond Position:  [0.46366905]


portfolio before change:  [0.51912045]
curr_Stock_Price:  99.33597756841286
curr_Factors:  [99.33597757 -1.11979853 -0.98635438]
mat_Sqrt:  [[12.08971273  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0074324  -0.04103947  1.2722272 ]
Stock Position:  -0.007432402763407128
Bond Position:  [1.25742544]


portfolio before change:  [0.52548577]
curr_Stock_Price:  98.52184907910956
curr_Factors:  [98.52184908 -1.0887119  -0.99939329]
mat_Sqrt:  [[12.20899716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00465209 -0.04522423  0.24245377]
Stock Position:  0.004652092336022079
Bond Position:  [0.06715303]


portfolio before change:  [0.52656348]
curr_Stock_Price:  98.74990176788077
curr_Factors:  [98.74990177 -0.72577477 -1.01362686]
mat_Sqrt:  [[17.34299663  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06101137  0.40930585 -0.51673351]
Stock Position:  -0.06101136994229867
Bond Position:  [6.55143027]


portfolio before change:  [0.44816729]
curr_Stock_Price:  100.06169429143566
curr_Factors:  [100.06169429  -0.39002917  -1.049584  ]
mat_Sqrt:  [[23.7165656   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00011962  0.00424547 -0.00265211]
Stock Position:  0.00011961717021922518
Bond Position:  [0.43619819]


portfolio before change:  [0.44796293]
curr_Stock_Price:  97.44147276437062
curr_Factors:  [97.44147276 -0.47272166 -1.03467354]
mat_Sqrt:  [[21.58193712  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00163626  0.00525287 -0.14367269]
Stock Position:  0.0016362613873263227
Bond Position:  [0.28852321]


portfolio before change:  [0.45195737]
curr_Stock_Price:  99.8385849396866
curr_Factors:  [99.83858494 -0.66339418 -1.04467317]
mat_Sqrt:  [[18.09231705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0066243  0.00859841 0.14720168]
Stock Position:  0.0066243025045766004
Bond Position:  [-0.20940362]


portfolio before change:  [0.43641227]
curr_Stock_Price:  97.49981189235889
curr_Factors:  [97.49981189 -0.16306377 -1.04002612]
mat_Sqrt:  [[29.27577995  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00680834 0.03984475 0.26624999]
Stock Position:  0.006808339353355574
Bond Position:  [-0.22739953]


portfolio before change:  [0.44560666]
curr_Stock_Price:  98.85862298125619
curr_Factors:  [98.85862298 -0.11372117 -1.04639432]
mat_Sqrt:  [[30.98723317  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00182394 -0.00053945 -0.14990946]
Stock Position:  0.0018239407769728604
Bond Position:  [0.26529439]


portfolio before change:  [0.44293136]
curr_Stock_Price:  97.35548735280132
curr_Factors:  [97.35548735  0.11261148 -1.03048403]
mat_Sqrt:  [[38.88064413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00208661  0.00089665 -0.07744174]
Stock Position:  0.0020866092506764814
Bond Position:  [0.2397885]


portfolio before change:  [0.43775263]
curr_Stock_Price:  94.84486722653976
curr_Factors:  [94.84486723 -0.18277223 -1.01436772]
mat_Sqrt:  [[28.64854415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00058855 -0.00995959  0.34984664]
Stock Position:  0.0005885507940063259
Bond Position:  [0.38193161]


portfolio before change:  [0.43744199]
curr_Stock_Price:  94.15479764872862
curr_Factors:  [94.15479765 -0.27234127 -1.03960927]
mat_Sqrt:  [[25.3553479   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.001365   -0.02116468  0.09890829]
Stock Position:  -0.0013649957680227263
Bond Position:  [0.56596289]


portfolio before change:  [0.43534155]
curr_Stock_Price:  95.79725218904004
curr_Factors:  [95.79725219 -0.61362957 -1.04964403]
mat_Sqrt:  [[18.15526139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00645911 -0.08580111 -0.14868832]
Stock Position:  -0.0064591079548771265
Bond Position:  [1.05410635]


portfolio before change:  [0.44080527]
curr_Stock_Price:  94.99216391103559
curr_Factors:  [94.99216391 -1.07279874 -1.0735624 ]
mat_Sqrt:  [[11.10541983  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0044713   0.01052801 -0.06621941]
Stock Position:  0.004471299366366216
Bond Position:  [0.01606686]


portfolio before change:  [0.44056952]
curr_Stock_Price:  94.93854111946462
curr_Factors:  [94.93854112 -1.0062506  -1.05625435]
mat_Sqrt:  [[12.07002135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01608241 0.00049714 0.45168824]
Stock Position:  0.016082405859864597
Bond Position:  [-1.08627063]


portfolio before change:  [0.45279354]
curr_Stock_Price:  95.7155157185994
curr_Factors:  [95.71551572 -1.10497889 -1.03799612]
mat_Sqrt:  [[11.22794103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00368281  0.00820443  0.19793484]
Stock Position:  -0.0036828057948722136
Bond Position:  [0.80529519]


portfolio before change:  [0.45369185]
curr_Stock_Price:  95.52626880111738
curr_Factors:  [95.5262688  -1.50903546 -1.02486367]
mat_Sqrt:  [[ 7.57991621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00185393  0.04839212 -0.40488687]
Stock Position:  0.001853925263314689
Bond Position:  [0.27659328]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.45351428]
Stock Price:  95.39318618546154
PL:  [0.45351428]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 4.54920033e-02 -1.06400620e-01  5.86775684e-02]
 [-1.57522510e-04  9.31246500e-02 -8.87539242e-02]
 [-7.47260804e-02 -1.03782873e-02 -4.45331570e-02]
 [-2.16232922e-01 -2.00687514e-01  8.68639859e-01]
 [ 3.60425562e-02 -9.28684117e-02  5.31636521e-02]
 [-6.59720779e-01  6.84217545e-01 -7.82905945e-02]
 [ 9.70697307e-03 -3.61911514e-03  2.57319643e-02]
 [-9.28184440e-02 -1.96150767e-02 -2.12786866e-02]
 [ 7.78115967e-03  2.15732811e-02  5.82584640e-02]
 [ 1.03125409e-01  1.37820559e-01  6.89182130e-02]
 [ 1.21358689e-01  3.22849526e-02 -5.27276437e-02]
 [-4.20978324e-02  1.48421708e-01  2.53261199e-02]
 [-1.83490506e-01 -1.22844412e-01  3.50914876e-02]
 [ 2.53317117e-02  5.21169740e-01 -3.38764531e-01]
 [-3.16259073e-02 -2.45437544e-01 -6.05148614e-02]
 [ 5.87054783e-02  2.94491667e-02  1.46346476e-01]
 [ 3.45988769e-02  2.23734187e-02  1.03465246e-01]
 [-2.98154986e-03 -3.27947939e-02 -8.46241433e-04]
 [-6.15635742e-03  9.29566277e-03 -1.22319645e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.44783367]
curr_Stock_Price:  101.40659904477754
curr_Factors:  [101.40659904  -1.21095451  -0.95367278]
mat_Sqrt:  [[11.64073853  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00307116 -0.03434065  0.16739077]
Stock Position:  0.0030711604799396252
Bond Position:  [13.13639773]


portfolio before change:  [13.45480648]
curr_Stock_Price:  102.6075438945318
curr_Factors:  [102.60754389  -1.17637371  -0.95910183]
mat_Sqrt:  [[12.12701879  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.05794526e-05  3.00558515e-02 -2.53190241e-01]
Stock Position:  6.05794526125792e-05
Bond Position:  [13.44859057]


portfolio before change:  [13.45809291]
curr_Stock_Price:  101.35080587361978
curr_Factors:  [101.35080587  -1.19638073  -0.956253  ]
mat_Sqrt:  [[11.774711    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00729825 -0.00334958 -0.1270407 ]
Stock Position:  -0.007298254028627162
Bond Position:  [14.19777684]


portfolio before change:  [13.45744129]
curr_Stock_Price:  101.9264925822856
curr_Factors:  [101.92649258  -1.11669258  -0.9011644 ]
mat_Sqrt:  [[13.5501133   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00589572 -0.06477162  2.47798773]
Stock Position:  -0.005895723421249677
Bond Position:  [14.0583717]


portfolio before change:  [13.46297872]
curr_Stock_Price:  101.5834646673827
curr_Factors:  [101.58346467  -1.40974524  -0.88914782]
mat_Sqrt:  [[10.19592074  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0027401  -0.02997315  0.1516611 ]
Stock Position:  0.002740101339020348
Bond Position:  [13.18462974]


portfolio before change:  [13.46703423]
curr_Stock_Price:  101.86043955434825
curr_Factors:  [101.86043955  -1.47279572  -0.85633257]
mat_Sqrt:  [[ 9.91923041  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05404013  0.22083026 -0.22334127]
Stock Position:  -0.054040125664784694
Bond Position:  [18.97158519]


portfolio before change:  [13.43301551]
curr_Stock_Price:  102.57772536776754
curr_Factors:  [102.57772537  -1.29083879  -0.88444436]
mat_Sqrt:  [[11.65036682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00122063 -0.00116806  0.07340613]
Stock Position:  0.001220625900670839
Bond Position:  [13.30780648]


portfolio before change:  [13.43434095]
curr_Stock_Price:  100.93764268682781
curr_Factors:  [100.93764269  -1.03246028  -0.91331858]
mat_Sqrt:  [[14.42155652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0070149  -0.00633074 -0.06070217]
Stock Position:  -0.007014904972587091
Bond Position:  [14.14240892]


portfolio before change:  [13.42894309]
curr_Stock_Price:  102.21120280404313
curr_Factors:  [102.2112028   -0.85479313  -0.94219665]
mat_Sqrt:  [[16.94633361  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00142076 0.00696275 0.16619518]
Stock Position:  0.0014207643358679074
Bond Position:  [13.28372506]


portfolio before change:  [13.42830066]
curr_Stock_Price:  99.42131611793602
curr_Factors:  [99.42131612 -0.92985402 -0.93353761]
mat_Sqrt:  [[15.4247739   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00942158 0.04448139 0.19660448]
Stock Position:  0.00942158277276328
Bond Position:  [12.4915945]


portfolio before change:  [13.43068254]
curr_Stock_Price:  99.34262372384102
curr_Factors:  [99.34262372 -1.32780503 -0.93929658]
mat_Sqrt:  [[10.29309329  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0113849   0.01041992 -0.15041729]
Stock Position:  0.011384900391005365
Bond Position:  [12.29967667]


portfolio before change:  [13.43004992]
curr_Stock_Price:  99.01693522653093
curr_Factors:  [99.01693523 -1.03311896 -0.8888891 ]
mat_Sqrt:  [[14.4874512   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045776  0.0479029   0.07224837]
Stock Position:  -0.00045775515617691934
Bond Position:  [13.47537543]


portfolio before change:  [13.43310513]
curr_Stock_Price:  99.70300497067181
curr_Factors:  [99.70300497 -1.02386551 -0.88027641]
mat_Sqrt:  [[14.85080242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01356176 -0.03964786  0.10010625]
Stock Position:  -0.013561758565825404
Bond Position:  [14.78525321]


portfolio before change:  [13.43325168]
curr_Stock_Price:  99.96478710206233
curr_Factors:  [99.9647871  -0.80639997 -0.86630536]
mat_Sqrt:  [[18.76723745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00333374  0.16820681 -0.96640091]
Stock Position:  0.00333373620938027
Bond Position:  [13.09999545]


portfolio before change:  [13.43785068]
curr_Stock_Price:  100.36181597452027
curr_Factors:  [100.36181597  -0.89835931  -0.85205186]
mat_Sqrt:  [[17.43309916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00539653 -0.07921463 -0.17263206]
Stock Position:  -0.0053965264395209695
Bond Position:  [13.97945587]


portfolio before change:  [13.45137658]
curr_Stock_Price:  98.5031017248745
curr_Factors:  [98.50310172 -1.38474109 -0.8307061 ]
mat_Sqrt:  [[10.74715261  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00880137 0.00950468 0.41748576]
Stock Position:  0.008801365077038291
Bond Position:  [12.58441482]


portfolio before change:  [13.44530295]
curr_Stock_Price:  97.4555223475302
curr_Factors:  [97.45552235 -1.05629146 -0.86802392]
mat_Sqrt:  [[14.22613423  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00423766 0.00722099 0.29515755]
Stock Position:  0.004237664691013013
Bond Position:  [13.03231912]


portfolio before change:  [13.45196758]
curr_Stock_Price:  98.25930049812123
curr_Factors:  [98.2593005  -1.07043753 -0.8994937 ]
mat_Sqrt:  [[13.70387545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071867 -0.01058447 -0.00241409]
Stock Position:  -0.0007186651309406696
Bond Position:  [13.52258311]


portfolio before change:  [13.45536931]
curr_Stock_Price:  98.23054563315164
curr_Factors:  [98.23054563 -0.89924422 -0.90863218]
mat_Sqrt:  [[16.1100102   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00181423  0.00300016 -0.3489439 ]
Stock Position:  -0.0018142310768729912
Bond Position:  [13.63358222]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.45457015]
Stock Price:  100.54997376722622
PL:  [12.90459639]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.80867001e-02  6.10006429e-02  3.25167863e-02]
 [-4.49752136e-03 -4.28104101e-02  1.56885916e-01]
 [ 9.80211422e-02 -4.10110742e-02 -8.90438899e-03]
 [-1.82735858e-01 -1.61862387e-01  4.92382089e-01]
 [-4.16380191e-02  2.18102222e-02 -2.40755316e-02]
 [-9.49538195e-01  8.85169188e-01 -1.03768154e-01]
 [-7.18807593e-04 -1.20711261e-02  3.76437685e-04]
 [ 3.51345678e-02  2.23840374e-02 -4.85570607e-02]
 [ 9.96106306e-02  2.46441879e-02  3.91704552e-02]
 [ 1.55191029e-01  1.24762232e-01  9.49145663e-02]
 [ 1.23181821e-01  3.23181917e-02 -5.27465304e-02]
 [-9.62949211e-02  1.19909773e-01  1.54650665e-01]
 [-1.76160217e-01 -1.19131765e-01  3.86248847e-02]
 [ 5.02632246e-02  5.56595145e-01 -2.38590838e-01]
 [-3.46493232e-02 -1.53997961e-01 -7.52929374e-02]
 [ 6.28885690e-02  2.75432091e-02  1.95704040e-01]
 [ 9.74391211e-02  1.54611265e-02  1.40329627e-01]
 [ 1.54000390e-02 -7.20284942e-02 -1.15924288e-02]
 [-9.35245143e-02  2.78534537e-01 -2.47451990e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.52140492]
curr_Stock_Price:  99.90313370677272
curr_Factors:  [99.90313371 -0.87194453 -0.98758628]
mat_Sqrt:  [[15.55948229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00186366  0.01968787  0.09276134]
Stock Position:  -0.0018636567905234694
Bond Position:  [1.70759007]


portfolio before change:  [1.52366947]
curr_Stock_Price:  98.91711229866279
curr_Factors:  [98.9171123  -1.37859989 -0.9637241 ]
mat_Sqrt:  [[ 9.50633352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00197637 -0.013817    0.44755185]
Stock Position:  0.00197637119192053
Bond Position:  [1.32817254]


portfolio before change:  [1.52302957]
curr_Stock_Price:  98.42530541830928
curr_Factors:  [98.42530542 -0.85231656 -0.94430954]
mat_Sqrt:  [[16.32457823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00538037 -0.01323627 -0.02540174]
Stock Position:  0.005380365099398221
Bond Position:  [0.99346549]


portfolio before change:  [1.52231759]
curr_Stock_Price:  98.24680931617193
curr_Factors:  [98.24680932 -0.6007006  -0.93900921]
mat_Sqrt:  [[21.06837213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00547118 -0.05224086  1.40462905]
Stock Position:  -0.005471177650754794
Bond Position:  [2.05984334]


portfolio before change:  [1.52300193]
curr_Stock_Price:  98.21586207576127
curr_Factors:  [98.21586208 -0.56863482 -0.94281477]
mat_Sqrt:  [[21.6654352   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00194321  0.00703922 -0.06868079]
Stock Position:  -0.0019432069102924944
Bond Position:  [1.71385567]


portfolio before change:  [1.52358408]
curr_Stock_Price:  98.13680146377823
curr_Factors:  [98.13680146 -1.09272626 -0.91560228]
mat_Sqrt:  [[13.17121678  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05998196  0.28568713 -0.29602166]
Stock Position:  -0.059981958431554905
Bond Position:  [7.41002163]


portfolio before change:  [1.52967441]
curr_Stock_Price:  98.06615371712746
curr_Factors:  [98.06615372 -0.95411169 -0.87006934]
mat_Sqrt:  [[15.82294748  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0001963  -0.00389594  0.00107387]
Stock Position:  -0.00019629565717524188
Bond Position:  [1.54892437]


portfolio before change:  [1.53012421]
curr_Stock_Price:  97.74764047785712
curr_Factors:  [97.74764048 -0.86037636 -0.86023182]
mat_Sqrt:  [[17.49265144  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00170312  0.00722442 -0.13851978]
Stock Position:  0.0017031164136350075
Bond Position:  [1.3636486]


portfolio before change:  [1.53103291]
curr_Stock_Price:  98.08099422841521
curr_Factors:  [98.08099423 -1.01319506 -0.85452952]
mat_Sqrt:  [[15.15103774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00743426 0.00795388 0.11174241]
Stock Position:  0.007434259090207546
Bond Position:  [0.80187338]


portfolio before change:  [1.53946867]
curr_Stock_Price:  99.18874059004278
curr_Factors:  [99.18874059 -1.06131912 -0.8441917 ]
mat_Sqrt:  [[14.75399191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01355785 0.04026684 0.27076484]
Stock Position:  0.013557847173221548
Bond Position:  [0.19468289]


portfolio before change:  [1.52972089]
curr_Stock_Price:  98.46617310004022
curr_Factors:  [98.4661731  -1.36058782 -0.8252354 ]
mat_Sqrt:  [[11.06613841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0107546   0.01043065 -0.15047117]
Stock Position:  0.010754601020457919
Bond Position:  [0.47075648]


portfolio before change:  [1.52823005]
curr_Stock_Price:  98.31660528634418
curr_Factors:  [98.31660529 -1.55680621 -0.81929233]
mat_Sqrt:  [[ 9.13482831  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00440627  0.03870071  0.4411753 ]
Stock Position:  -0.0044062685151043685
Bond Position:  [1.96143941]


portfolio before change:  [1.52729413]
curr_Stock_Price:  98.64031312477937
curr_Factors:  [98.64031312 -1.67111319 -0.83484667]
mat_Sqrt:  [[ 8.04877715  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02392831 -0.03844961  0.11018605]
Stock Position:  -0.023928307606774366
Bond Position:  [3.88758988]


portfolio before change:  [1.52479004]
curr_Stock_Price:  98.78558491718609
curr_Factors:  [98.78558492 -1.79221707 -0.82808536]
mat_Sqrt:  [[ 7.18969863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01601953  0.17964031 -0.68063325]
Stock Position:  0.016019528454334433
Bond Position:  [-0.05770845]


portfolio before change:  [1.52702721]
curr_Stock_Price:  98.92613818467412
curr_Factors:  [98.92613818 -1.76815306 -0.85136613]
mat_Sqrt:  [[ 7.2055697   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01130419 -0.04970263 -0.21478979]
Stock Position:  -0.011304190417644968
Bond Position:  [2.64530711]


portfolio before change:  [1.53444314]
curr_Stock_Price:  98.32861444812491
curr_Factors:  [98.32861445 -1.83531922 -0.83443355]
mat_Sqrt:  [[ 6.81115912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01592368 0.00888953 0.55828915]
Stock Position:  0.015923680689754676
Bond Position:  [-0.03131032]


portfolio before change:  [1.5355822]
curr_Stock_Price:  98.40063874083104
curr_Factors:  [98.40063874 -1.88133059 -0.86284551]
mat_Sqrt:  [[ 6.32728478  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02042579 0.00499006 0.40032137]
Stock Position:  0.020425787676778533
Bond Position:  [-0.47432835]


portfolio before change:  [1.53352726]
curr_Stock_Price:  98.30583971685665
curr_Factors:  [98.30583972 -2.14486839 -0.81357826]
mat_Sqrt:  [[ 5.10202127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00032713 -0.0232471  -0.03306997]
Stock Position:  -0.00032712730628693107
Bond Position:  [1.56568579]


portfolio before change:  [1.53386001]
curr_Stock_Price:  98.4853409071634
curr_Factors:  [98.48534091 -1.7811684  -0.82479752]
mat_Sqrt:  [[ 7.27134873  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00573759  0.08989664 -0.07059117]
Stock Position:  -0.005737585167278711
Bond Position:  [2.09892804]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.53438036]
Stock Price:  98.486117125918
PL:  [1.53438036]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 1.90831676e-03 -1.34714015e-02  3.66630753e-02]
 [ 3.98745400e-02  1.77305939e-01 -2.70738419e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-3.23651327e-01 -3.43845217e-01  1.13914434e+00]
 [-5.39942126e-02  4.00514799e-02 -3.63615155e-02]
 [-1.17386063e+00  1.29933493e+00 -1.95228360e-01]
 [-5.51257324e-03 -5.26747565e-02 -6.93527360e-03]
 [-4.39774658e-02 -1.38411924e-01  2.14622424e-01]
 [ 3.56614193e-02 -1.73949201e-02 -6.08810919e-03]
 [-1.11581341e+00  4.14542463e-01 -5.72648135e-01]
 [ 1.51202239e-01  5.23133167e-02 -5.62562768e-02]
 [-1.04904647e-01  1.15380379e-01  1.75195107e-01]
 [ 1.59479269e-01 -2.89296643e-02 -1.06221267e-01]
 [ 2.79452510e-02  8.17669774e-01 -4.94607630e-01]
 [ 1.41226322e-01 -6.19068847e-02 -1.04968494e-02]
 [ 1.97068056e-02 -2.75128029e-02 -6.49341556e-02]
 [-8.61125903e-02  1.59466666e-02  5.75505255e-02]
 [ 4.43618294e-02 -1.75304863e-01 -3.73095651e-02]
 [-1.74280084e-01  2.17584277e-02 -3.45498720e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.95108457]
curr_Stock_Price:  100.83973141402858
curr_Factors:  [100.83973141  -0.75781423  -0.98376667]
mat_Sqrt:  [[17.6714711   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00037588 -0.00434788  0.10458955]
Stock Position:  0.00037587687647325176
Bond Position:  [8.91318125]


portfolio before change:  [8.95318653]
curr_Stock_Price:  100.50289319082091
curr_Factors:  [100.50289319  -0.54380275  -1.01141409]
mat_Sqrt:  [[21.22054199  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00098031  0.05722525 -0.77234135]
Stock Position:  0.0009803102514977875
Bond Position:  [8.85466252]


portfolio before change:  [8.95532011]
curr_Stock_Price:  100.42091522834677
curr_Factors:  [100.42091523  -0.61773889  -1.00281678]
mat_Sqrt:  [[19.86212858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00392822  0.01370813 -0.02999186]
Stock Position:  -0.003928216363877073
Bond Position:  [9.34979519]


portfolio before change:  [8.9534586]
curr_Stock_Price:  101.4899118299308
curr_Factors:  [101.48991183  -0.6097906   -0.99814753]
mat_Sqrt:  [[20.32844787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00793526 -0.11097557  3.24966173]
Stock Position:  -0.007935262666950884
Bond Position:  [9.75880771]


portfolio before change:  [8.96363805]
curr_Stock_Price:  100.51458957026898
curr_Factors:  [100.51458957  -0.31646137  -1.01136435]
mat_Sqrt:  [[26.641687    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00199841  0.01292656 -0.10372928]
Stock Position:  -0.001998409551227321
Bond Position:  [9.16450736]


portfolio before change:  [8.95967761]
curr_Stock_Price:  103.64300305470645
curr_Factors:  [103.64300305  -0.93826443  -1.0241073 ]
mat_Sqrt:  [[14.56440603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06512355  0.41935854 -0.55693217]
Stock Position:  -0.06512354984640162
Bond Position:  [15.70927789]


portfolio before change:  [8.86295706]
curr_Stock_Price:  105.1885017976727
curr_Factors:  [105.1885018   -1.07229471  -1.04176506]
mat_Sqrt:  [[12.70117145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00139203 -0.0170007  -0.01978441]
Stock Position:  -0.0013920306295824342
Bond Position:  [9.00938267]


portfolio before change:  [8.8669837]
curr_Stock_Price:  103.9140925575917
curr_Factors:  [103.91409256  -0.72677499  -1.04317991]
mat_Sqrt:  [[17.70079629  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00160564 -0.04467226  0.61225804]
Stock Position:  -0.0016056375144020397
Bond Position:  [9.03383207]


portfolio before change:  [8.86806685]
curr_Stock_Price:  104.6462541973706
curr_Factors:  [104.6462542   -0.72382521  -1.05018383]
mat_Sqrt:  [[17.75339229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00173871 -0.00561419 -0.01736768]
Stock Position:  0.0017387080468795684
Bond Position:  [8.68611757]


portfolio before change:  [8.87215603]
curr_Stock_Price:  105.74901051889937
curr_Factors:  [105.74901052  -0.91154134  -1.08777156]
mat_Sqrt:  [[14.32140912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08016576  0.133793   -1.63360573]
Stock Position:  -0.08016575621951869
Bond Position:  [17.34960542]


portfolio before change:  [8.95674668]
curr_Stock_Price:  104.74792583745317
curr_Factors:  [104.74792584  -0.96808438  -1.13055534]
mat_Sqrt:  [[12.84451715  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01170907  0.01688405 -0.1604835 ]
Stock Position:  0.011709072761297245
Bond Position:  [7.7302456]


portfolio before change:  [8.96467359]
curr_Stock_Price:  105.25984534675982
curr_Factors:  [105.25984535  -1.23558559  -1.10104962]
mat_Sqrt:  [[10.17360678  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00448132  0.03723886  0.49978288]
Stock Position:  -0.004481318736776198
Bond Position:  [9.4363765]


portfolio before change:  [8.9631656]
curr_Stock_Price:  106.12284421489484
curr_Factors:  [106.12284421  -1.01495913  -1.12169153]
mat_Sqrt:  [[12.52775611  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01052796 -0.00933701 -0.30301971]
Stock Position:  0.01052795882376011
Bond Position:  [7.84590867]


portfolio before change:  [8.94894489]
curr_Stock_Price:  104.58575286786703
curr_Factors:  [104.58575287  -1.01831415  -1.07632992]
mat_Sqrt:  [[12.87597615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00729188  0.26390178 -1.4109779 ]
Stock Position:  0.007291877050504441
Bond Position:  [8.18631844]


portfolio before change:  [8.94932089]
curr_Stock_Price:  104.35661585482588
curr_Factors:  [104.35661585  -1.20222719  -1.02392245]
mat_Sqrt:  [[11.26459242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01122517 -0.01998036 -0.02994459]
Stock Position:  0.011225170610370023
Bond Position:  [7.77790007]


portfolio before change:  [8.95805081]
curr_Stock_Price:  104.96107946268168
curr_Factors:  [104.96107946  -1.42884983  -1.05719399]
mat_Sqrt:  [[ 8.73681569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.57041137e-05 -8.87971896e-03 -1.85239072e-01]
Stock Position:  9.570411371632035e-05
Bond Position:  [8.94800561]


portfolio before change:  [8.96033486]
curr_Stock_Price:  105.44975990967622
curr_Factors:  [105.44975991  -1.37342754  -1.08352803]
mat_Sqrt:  [[ 9.03656442  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00786915  0.00514676  0.16417563]
Stock Position:  -0.007869145345535313
Bond Position:  [9.79013435]


portfolio before change:  [8.96411688]
curr_Stock_Price:  105.28021412336439
curr_Factors:  [105.28021412  -0.82334859  -1.01542928]
mat_Sqrt:  [[16.74077942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.74699067e-05 -5.65794013e-02 -1.06433804e-01]
Stock Position:  5.746990665043004e-05
Bond Position:  [8.95806644]


portfolio before change:  [8.96639079]
curr_Stock_Price:  105.87375097218447
curr_Factors:  [105.87375097  -1.13399023  -0.99718624]
mat_Sqrt:  [[12.56695676  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01407589  0.0070225  -0.09856117]
Stock Position:  -0.014075892063688072
Bond Position:  [10.45665828]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.97585533]
Stock Price:  105.38709988539406
PL:  [3.58875544]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-9.22505533e-02  1.71683433e-01  6.60408625e-03]
 [ 1.42275548e-02  2.28778076e-02 -3.34629124e-02]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-1.45532141e-01 -1.14194736e-01  4.24054073e-01]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-1.08971832e+00  1.10022053e+00 -1.51075528e-01]
 [ 1.12449203e-02 -8.31907592e-03  3.43253576e-02]
 [-9.27704540e-02 -1.92548015e-02 -2.20685582e-02]
 [ 4.51023815e-02  2.44255189e-02  6.06306530e-02]
 [-3.50726249e-01  2.39093943e-01 -1.71957878e-01]
 [ 6.61772875e-02  3.12788921e-02 -5.21559933e-02]
 [-6.82412533e-02  1.34668211e-01  8.77092864e-02]
 [-1.85535894e-01 -1.23880360e-01  3.41055554e-02]
 [ 2.70564246e-02  4.66790390e-01 -3.12995141e-01]
 [-4.41157614e-02 -2.63539106e-01 -6.22530305e-02]
 [ 5.54998585e-02  4.05566107e-02  9.57745167e-02]
 [-8.20021726e-02  1.62069834e-02  5.97909972e-02]
 [ 4.69821847e-02 -1.56289349e-01 -3.41210779e-02]
 [-1.03728316e-01  1.19592210e-01 -1.89801955e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.01446805]
curr_Stock_Price:  99.0792107488215
curr_Factors:  [99.07921075 -0.93971235 -1.02483556]
mat_Sqrt:  [[13.89281395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00402062  0.05541059  0.01883962]
Stock Position:  -0.004020622887462107
Bond Position:  [-4.61610791]


portfolio before change:  [-5.01569267]
curr_Stock_Price:  99.09673359595779
curr_Factors:  [99.0967336  -0.98869366 -1.01761253]
mat_Sqrt:  [[13.3269765   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090545  0.00738378 -0.09546037]
Stock Position:  0.0009054476347773243
Bond Position:  [-5.10541958]


portfolio before change:  [-5.01556758]
curr_Stock_Price:  100.64470959240221
curr_Factors:  [100.64470959  -1.20391858  -0.99893098]
mat_Sqrt:  [[11.12001943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00701642  0.01370813 -0.02999186]
Stock Position:  -0.007016421057683552
Bond Position:  [-4.30940192]


portfolio before change:  [-5.00821862]
curr_Stock_Price:  99.44374990766785
curr_Factors:  [99.44374991 -1.19284678 -1.04929657]
mat_Sqrt:  [[10.56396636  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00778897 -0.03685619  1.20970824]
Stock Position:  -0.007788965379516634
Bond Position:  [-4.2336547]


portfolio before change:  [-5.00617303]
curr_Stock_Price:  99.04521986094119
curr_Factors:  [99.04521986 -1.3324078  -1.0644468 ]
mat_Sqrt:  [[ 9.01348609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00630138 -0.04522423  0.24245377]
Stock Position:  0.006301377906617903
Bond Position:  [-5.63029439]


portfolio before change:  [-5.00286941]
curr_Stock_Price:  99.79289280638773
curr_Factors:  [99.79289281 -1.15786218 -1.05489761]
mat_Sqrt:  [[10.91717425  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08207022  0.35509465 -0.43097643]
Stock Position:  -0.08207022170541009
Bond Position:  [3.18715543]


portfolio before change:  [-5.10587636]
curr_Stock_Price:  101.05771014679019
curr_Factors:  [101.05771015  -1.60691476  -1.0584566 ]
mat_Sqrt:  [[ 7.03093984  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00235437 -0.00268497  0.09792069]
Stock Position:  0.0023543695045340697
Bond Position:  [-5.34380355]


portfolio before change:  [-5.10753432]
curr_Stock_Price:  100.92101184304637
curr_Factors:  [100.92101184  -1.3262989   -1.07973709]
mat_Sqrt:  [[ 9.10025252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01112118 -0.00621446 -0.06295545]
Stock Position:  -0.011121180347233629
Bond Position:  [-3.98517354]


portfolio before change:  [-5.11007895]
curr_Stock_Price:  101.06022467579106
curr_Factors:  [101.06022468  -1.06906049  -1.08351434]
mat_Sqrt:  [[11.74164349  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0053199  0.0078833  0.17296238]
Stock Position:  0.005319902608543252
Bond Position:  [-5.6477095]


portfolio before change:  [-5.10981085]
curr_Stock_Price:  101.37605782965726
curr_Factors:  [101.37605783  -1.1564042   -1.11108915]
mat_Sqrt:  [[10.49966765  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03209836  0.07716724 -0.49054796]
Stock Position:  -0.032098364331401195
Bond Position:  [-1.85580521]


portfolio before change:  [-5.083313]
curr_Stock_Price:  100.53608181464651
curr_Factors:  [100.53608181  -0.98093627  -1.12921659]
mat_Sqrt:  [[12.18692705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00508051  0.01009522 -0.14878653]
Stock Position:  0.0050805069097476
Bond Position:  [-5.59408726]


portfolio before change:  [-5.0821779]
curr_Stock_Price:  101.03481168455288
curr_Factors:  [101.03481168  -1.12150778  -1.13578341]
mat_Sqrt:  [[10.57162934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00216132  0.04346398  0.25021018]
Stock Position:  -0.0021613164773324842
Bond Position:  [-4.8638097]


portfolio before change:  [-5.08120353]
curr_Stock_Price:  100.02131945383822
curr_Factors:  [100.02131945  -1.19454618  -1.12021128]
mat_Sqrt:  [[ 9.88112036  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02063138 -0.03998221  0.09729366]
Stock Position:  -0.020631375003220456
Bond Position:  [-3.01762618]


portfolio before change:  [-5.0934356]
curr_Stock_Price:  100.5776360223715
curr_Factors:  [100.57763602  -0.8781359   -1.12828206]
mat_Sqrt:  [[13.52462335  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00432173  0.15065595 -0.89288802]
Stock Position:  0.004321728356304543
Bond Position:  [-5.52810482]


portfolio before change:  [-5.0967625]
curr_Stock_Price:  100.1276554322184
curr_Factors:  [100.12765543  -0.75400914  -1.09940759]
mat_Sqrt:  [[15.69008834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00705017 -0.08505688 -0.17759057]
Stock Position:  -0.007050170799899528
Bond Position:  [-4.39084542]


portfolio before change:  [-5.09232589]
curr_Stock_Price:  99.34264620190932
curr_Factors:  [99.3426462  -0.90169534 -1.07822956]
mat_Sqrt:  [[13.7171935   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00607474 0.01308959 0.27321804]
Stock Position:  0.006074736303695693
Bond Position:  [-5.69580627]


portfolio before change:  [-5.08880228]
curr_Stock_Price:  100.1571254429477
curr_Factors:  [100.15712544  -0.98972464  -1.09315812]
mat_Sqrt:  [[12.47663193  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00532909  0.00523078  0.17056707]
Stock Position:  -0.0053290944285925
Bond Position:  [-4.5550555]


portfolio before change:  [-5.0938187]
curr_Stock_Price:  100.88473822092088
curr_Factors:  [100.88473822  -1.46022006  -1.08720171]
mat_Sqrt:  [[ 7.89758399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00102751 -0.05044217 -0.09733794]
Stock Position:  0.0010275065337497214
Bond Position:  [-5.19747843]


portfolio before change:  [-5.09590185]
curr_Stock_Price:  100.1221020468218
curr_Factors:  [100.12210205  -1.33943853  -1.10431023]
mat_Sqrt:  [[ 8.69407449  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00916763  0.03859822 -0.00541452]
Stock Position:  -0.009167633732277322
Bond Position:  [-4.17801909]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.09675711]
Stock Price:  100.10144522748305
PL:  [-5.19820234]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-8.37972142e-03 -3.65834245e-03  3.79965840e-02]
 [ 3.93751770e-02  1.00192937e-01 -2.58677703e-01]
 [ 1.07399662e-01 -1.91551916e-02 -1.56890152e-02]
 [-1.69148344e-01 -1.41121611e-01  4.32135004e-01]
 [-8.29630817e-02  8.28177741e-02 -6.51657796e-02]
 [-1.18717714e+00  1.18318068e+00 -1.65754315e-01]
 [-2.95871701e-03  1.90649331e-02 -1.03251508e-02]
 [-8.61279947e-02 -3.32269571e-02  5.33571904e-03]
 [-3.34509652e-02  1.72140161e-02  5.36935987e-02]
 [-7.51011414e-01  3.32010510e-01 -3.80317422e-01]
 [ 1.38330316e-01  4.48562992e-02 -5.49295519e-02]
 [-2.15684218e-02  1.42067722e-01 -3.25849341e-03]
 [-1.71702559e-01 -1.17383243e-01  1.14663052e-02]
 [ 3.36635604e-02  3.59956640e-01 -1.99453162e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 6.31919940e-02  4.80209697e-02  1.72041140e-01]
 [-6.54461249e-02  1.97409599e-02  6.18534330e-02]
 [ 4.19022706e-02 -1.18815911e-01 -3.48569027e-02]
 [-9.80427939e-02  2.08154314e-01 -1.46283874e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.79598779]
curr_Stock_Price:  100.56805634933829
curr_Factors:  [100.56805635  -0.77744595  -1.01431252]
mat_Sqrt:  [[16.76135952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.17628909e-05 -1.18072495e-03  1.08393678e-01]
Stock Position:  -8.176289094719523e-05
Bond Position:  [6.80421053]


portfolio before change:  [6.79779288]
curr_Stock_Price:  99.29829666624465
curr_Factors:  [99.29829667 -0.54114617 -1.03005715]
mat_Sqrt:  [[20.63368832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.40443719e-04  3.23371314e-02 -7.37935485e-01]
Stock Position:  0.0003404437187181342
Bond Position:  [6.7639874]


portfolio before change:  [6.79916599]
curr_Stock_Price:  98.36394270293076
curr_Factors:  [98.3639427  -0.28400721 -0.9838059 ]
mat_Sqrt:  [[27.68418172  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00362254 -0.00618231 -0.04475639]
Stock Position:  0.0036225422409575324
Bond Position:  [6.44283845]


portfolio before change:  [6.79444923]
curr_Stock_Price:  96.61719347488494
curr_Factors:  [ 9.66171935e+01 -2.09524408e-02 -1.00151882e+00]
mat_Sqrt:  [[34.75367965  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00315781 -0.0455468   1.23276088]
Stock Position:  -0.003157809052245998
Bond Position:  [7.09954788]


portfolio before change:  [6.78741261]
curr_Stock_Price:  99.40764893365304
curr_Factors:  [99.40764893 -0.53136983 -1.03774456]
mat_Sqrt:  [[20.69960607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00383388  0.02672932 -0.18589983]
Stock Position:  -0.003833883751514489
Bond Position:  [7.16852998]


portfolio before change:  [6.79019685]
curr_Stock_Price:  99.14893480900146
curr_Factors:  [99.14893481 -0.94293128 -1.03438484]
mat_Sqrt:  [[13.72620794  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07135954  0.38186992 -0.47285093]
Stock Position:  -0.07135953748962656
Bond Position:  [13.86541898]


portfolio before change:  [6.74661928]
curr_Stock_Price:  99.80819289305153
curr_Factors:  [99.80819289 -0.77139776 -1.03941439]
mat_Sqrt:  [[16.32076342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-7.19768056e-05  6.15318071e-03 -2.94547813e-02]
Stock Position:  -7.197680560775506e-05
Bond Position:  [6.75380316]


portfolio before change:  [6.74817248]
curr_Stock_Price:  101.690223552286
curr_Factors:  [101.69022355  -0.83709402  -1.01372138]
mat_Sqrt:  [[15.97645008  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00574729 -0.01072395  0.01522132]
Stock Position:  -0.005747288625172016
Bond Position:  [7.33261555]


portfolio before change:  [6.74176097]
curr_Stock_Price:  103.1247953593519
curr_Factors:  [103.12479536  -0.75710139  -1.0175474 ]
mat_Sqrt:  [[17.48408561  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108539  0.0055558   0.15317289]
Stock Position:  -0.0010853875538440324
Bond Position:  [6.85369134]


portfolio before change:  [6.74264865]
curr_Stock_Price:  103.88577518844144
curr_Factors:  [103.88577519  -0.6902407   -1.0297583 ]
mat_Sqrt:  [[18.6024442   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04090172  0.10715593 -1.08493974]
Stock Position:  -0.040901723078267026
Bond Position:  [10.99175586]


portfolio before change:  [6.75981291]
curr_Stock_Price:  103.53332104020194
curr_Factors:  [103.53332104  -0.95396734  -1.01185298]
mat_Sqrt:  [[14.49890574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00939892  0.01447731 -0.15669872]
Stock Position:  0.009398924573249588
Bond Position:  [5.78671104]


portfolio before change:  [6.74631862]
curr_Stock_Price:  101.94365541207036
curr_Factors:  [101.94365541  -0.82887717  -1.00130947]
mat_Sqrt:  [[16.35009353  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00041381  0.04585216 -0.00929557]
Stock Position:  0.0004138137392344793
Bond Position:  [6.70413294]


portfolio before change:  [6.74727806]
curr_Stock_Price:  100.21145518798521
curr_Factors:  [100.21145519  -0.82637275  -0.95316328]
mat_Sqrt:  [[16.90731674  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01143427 -0.03788528  0.03271018]
Stock Position:  -0.011434266380638792
Bond Position:  [7.89312253]


portfolio before change:  [6.76907244]
curr_Stock_Price:  98.4779940416628
curr_Factors:  [98.47799404 -0.70185064 -0.95495061]
mat_Sqrt:  [[18.78449633  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00353622  0.11617551 -0.56898435]
Stock Position:  0.003536224470855201
Bond Position:  [6.42083215]


portfolio before change:  [6.77465737]
curr_Stock_Price:  99.60335302482913
curr_Factors:  [99.60335302 -0.78765313 -0.91537471]
mat_Sqrt:  [[18.14088062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00733113 -0.09296045 -0.18429859]
Stock Position:  -0.007331125832483043
Bond Position:  [7.50486209]


portfolio before change:  [6.77516413]
curr_Stock_Price:  99.79018590040427
curr_Factors:  [99.7901859  -1.07281832 -0.93577503]
mat_Sqrt:  [[13.38957591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00807434 0.0154987  0.49078549]
Stock Position:  0.008074339687922557
Bond Position:  [5.96942427]


portfolio before change:  [6.76796105]
curr_Stock_Price:  98.71324143557658
curr_Factors:  [98.71324144 -0.92768979 -0.95688856]
mat_Sqrt:  [[14.99385945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325405  0.00637137  0.17645063]
Stock Position:  -0.0032540480537984634
Bond Position:  [7.08917869]


portfolio before change:  [6.76706432]
curr_Stock_Price:  99.53352871152826
curr_Factors:  [99.53352871 -1.48897284 -0.9426729 ]
mat_Sqrt:  [[ 8.74820755  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120413 -0.03834767 -0.09943704]
Stock Position:  0.0012041253989996455
Bond Position:  [6.64721347]


portfolio before change:  [6.76862829]
curr_Stock_Price:  99.45211077664094
curr_Factors:  [99.45211078 -1.62117186 -0.96597854]
mat_Sqrt:  [[ 7.48219221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00782384  0.06718152 -0.04173072]
Stock Position:  -0.007823840635676859
Bond Position:  [7.54672576]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.76533115]
Stock Price:  100.11470888285093
PL:  [6.65062226]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-3.13174291e-03 -1.48299602e-02  4.56186928e-02]
 [ 6.85770977e-02  1.68541556e-01 -2.82212624e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-4.23618818e-01 -4.79809823e-01  1.38812029e+00]
 [-7.51523793e-02  7.12869549e-02 -5.73994587e-02]
 [-1.46551239e+00  1.50399017e+00 -2.21083815e-01]
 [-4.01458812e-02  1.92491016e-02 -8.44769343e-02]
 [ 2.10121951e-02  2.31601288e-02 -3.56208368e-02]
 [-3.87255386e-02  3.02650953e-02  5.42284406e-02]
 [ 1.48943670e-01  1.40906323e-01  9.82692087e-02]
 [-2.14949765e-01 -1.76577715e-01  3.19588061e-02]
 [-2.40293678e-02  1.45251337e-01 -2.71250418e-03]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-7.64116017e-02 -4.41662014e-02 -3.40964599e-02]
 [-4.76694182e-02 -1.93436118e-01 -5.45881439e-02]
 [ 3.92681554e-02  1.49245234e-02 -5.21035939e-02]
 [-7.78697865e-02  2.04498325e-02  5.46099069e-02]
 [-4.70552668e-02  3.31089813e-02  4.07349217e-02]
 [ 7.59280019e-02 -8.21238389e-02 -2.45497749e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.35565546]
curr_Stock_Price:  100.63860898183256
curr_Factors:  [100.63860898  -0.92420694  -0.94927801]
mat_Sqrt:  [[15.45683072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00020399 -0.00478635  0.13013743]
Stock Position:  0.00020398624108471683
Bond Position:  [7.33512657]


portfolio before change:  [7.35740263]
curr_Stock_Price:  100.21286262760243
curr_Factors:  [100.21286263  -0.49380706  -0.94393298]
mat_Sqrt:  [[23.7969283   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00190672  0.05439655 -0.80507406]
Stock Position:  0.0019067203822731875
Bond Position:  [7.16632472]


portfolio before change:  [7.36136049]
curr_Stock_Price:  101.34887257649854
curr_Factors:  [101.34887258  -0.32357082  -0.93983667]
mat_Sqrt:  [[28.65022379  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00272329  0.01370813 -0.02999186]
Stock Position:  -0.002723285481259391
Bond Position:  [7.6373624]


portfolio before change:  [7.3641713]
curr_Stock_Price:  101.01793533912637
curr_Factors:  [101.01793534  -0.13829922  -0.9538182 ]
mat_Sqrt:  [[33.89205643  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00702851 -0.15485795  3.9599208 ]
Stock Position:  -0.007028511858588119
Bond Position:  [8.07417706]


portfolio before change:  [7.37383145]
curr_Stock_Price:  99.93074202991355
curr_Factors:  [ 9.99307420e+01  6.77113518e-02 -9.83818244e-01]
mat_Sqrt:  [[39.97964598  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00180886  0.02300777 -0.16374468]
Stock Position:  -0.0018088605914221767
Bond Position:  [7.55459223]


portfolio before change:  [7.37474764]
curr_Stock_Price:  100.4684837828786
curr_Factors:  [ 1.00468484e+02 -8.55834991e-02 -9.74404532e-01]
mat_Sqrt:  [[34.80830659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03457911  0.48541074 -0.63069059]
Stock Position:  -0.03457910887076454
Bond Position:  [10.84885827]


portfolio before change:  [7.46628936]
curr_Stock_Price:  97.89961570815491
curr_Factors:  [ 9.78996157e+01 -7.10223227e-02 -1.01262280e+00]
mat_Sqrt:  [[33.12530531  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00161389  0.00621262 -0.24098918]
Stock Position:  -0.0016138857090238921
Bond Position:  [7.62428815]


portfolio before change:  [7.4678983]
curr_Stock_Price:  98.08387349769387
curr_Factors:  [98.0838735  -0.19886598 -0.96982568]
mat_Sqrt:  [[30.48184627  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00060589  0.0074749  -0.10161633]
Stock Position:  0.0006058905877215494
Bond Position:  [7.4084702]


portfolio before change:  [7.46888974]
curr_Stock_Price:  96.66298510468906
curr_Factors:  [ 9.66629851e+01 -5.25310928e-02 -9.83209185e-01]
mat_Sqrt:  [[34.31183267  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00062598  0.00976802  0.15469865]
Stock Position:  -0.000625975534890839
Bond Position:  [7.52939841]


portfolio before change:  [7.47268861]
curr_Stock_Price:  93.60171120927225
curr_Factors:  [93.60171121 -0.23074493 -0.94267599]
mat_Sqrt:  [[28.95166609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00683087 0.04547732 0.2803347 ]
Stock Position:  0.0068308735794521515
Bond Position:  [6.83330715]


portfolio before change:  [7.46513782]
curr_Stock_Price:  92.24619900706847
curr_Factors:  [92.24619901 -0.38796784 -0.94754284]
mat_Sqrt:  [[24.26294756  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01007586 -0.05699021  0.09116958]
Stock Position:  -0.01007585643927763
Bond Position:  [8.39459728]


portfolio before change:  [7.47378569]
curr_Stock_Price:  91.59623334255473
curr_Factors:  [91.59623334 -0.74719514 -0.94216205]
mat_Sqrt:  [[16.91216121  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00029956  0.04687967 -0.00773802]
Stock Position:  0.0002995625239924563
Bond Position:  [7.44634689]


portfolio before change:  [7.47580125]
curr_Stock_Price:  92.10945461496449
curr_Factors:  [92.10945461 -0.7422469  -0.95903048]
mat_Sqrt:  [[16.80539915  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00100332 -0.00995959  0.34984664]
Stock Position:  0.0010033158542331142
Bond Position:  [7.38338638]


portfolio before change:  [7.47702296]
curr_Stock_Price:  91.48714470157968
curr_Factors:  [91.4871447  -0.462368   -0.95782925]
mat_Sqrt:  [[22.10936382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00417863 -0.01425458 -0.09726771]
Stock Position:  -0.004178632243511873
Bond Position:  [7.85931409]


portfolio before change:  [7.46643559]
curr_Stock_Price:  94.49110439301494
curr_Factors:  [94.49110439 -0.20398969 -0.94446241]
mat_Sqrt:  [[29.96570622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328032 -0.06243124 -0.15572478]
Stock Position:  -0.003280321773583275
Bond Position:  [7.77639681]


portfolio before change:  [7.45797452]
curr_Stock_Price:  97.66317383168389
curr_Factors:  [97.66317383 -0.50405875 -0.96842637]
mat_Sqrt:  [[22.39951788  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00141427  0.00481687 -0.14863705]
Stock Position:  0.001414271929340897
Bond Position:  [7.31985224]


portfolio before change:  [7.46102336]
curr_Stock_Price:  98.52485262778988
curr_Factors:  [98.52485263 -0.77830924 -0.95098147]
mat_Sqrt:  [[17.47931396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00357842  0.00660016  0.15578686]
Stock Position:  -0.0035784174108536623
Bond Position:  [7.81358641]


portfolio before change:  [7.46940942]
curr_Stock_Price:  96.72729324814075
curr_Factors:  [96.72729325 -0.81434337 -0.90917374]
mat_Sqrt:  [[17.25977245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185298  0.01068588  0.11620539]
Stock Position:  -0.0018529759459932392
Bond Position:  [7.64864277]


portfolio before change:  [7.47296695]
curr_Stock_Price:  95.8394604920233
curr_Factors:  [95.83946049 -0.81585131 -0.94944721]
mat_Sqrt:  [[16.40155231  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.51931012e-04 -2.65053550e-02 -7.00336743e-01]
Stock Position:  0.0005519310115835539
Bond Position:  [7.42007018]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.47410512]
Stock Price:  94.54024158238333
PL:  [7.47410512]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.32913778e-02  3.34053587e-02  3.74537704e-02]
 [ 2.01776459e-02  6.66490430e-02 -1.61940422e-02]
 [-8.18076071e-02  3.89199039e-02 -9.35690252e-03]
 [-1.97203966e-01 -1.78801323e-01  6.86570282e-01]
 [-3.45411588e-02  1.13332370e-02 -1.70189967e-02]
 [-1.20981214e+00  1.21138649e+00 -1.71084457e-01]
 [ 2.09070997e-03  1.15004338e-02  4.10737976e-03]
 [-2.78228670e-02  4.40921769e-02 -8.81210758e-02]
 [ 1.25812154e-01  2.38196661e-02  3.81128049e-02]
 [ 1.38180345e-01  1.28721396e-01  8.60720147e-02]
 [ 1.24079578e-01  3.23345595e-02 -5.27558307e-02]
 [-1.17976293e-01  1.08503665e-01  2.06386536e-01]
 [-8.05194674e-02 -7.06916162e-02  8.47263082e-02]
 [ 1.20893559e-02  5.97234254e-02 -1.36527122e-02]
 [-4.06592675e-02 -2.39216039e-01 -5.15105230e-02]
 [ 4.10543178e-02  6.29120234e-03 -3.16115466e-02]
 [ 1.17963369e-01  1.55367537e-02  1.46499316e-01]
 [-1.89719699e-02 -6.64198953e-02  4.65441275e-02]
 [ 1.23846815e-02  9.79402947e-02 -1.42898315e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.6487494]
curr_Stock_Price:  99.91918696320015
curr_Factors:  [99.91918696 -1.22263349 -1.02891328]
mat_Sqrt:  [[10.51512774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00274151  0.01078153  0.10684518]
Stock Position:  -0.002741509129802288
Bond Position:  [1.92267877]


portfolio before change:  [1.64865866]
curr_Stock_Price:  100.12763858995046
curr_Factors:  [100.12763859  -1.4686727   -1.00021388]
mat_Sqrt:  [[ 8.47871729  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0035945   0.02151089 -0.04619709]
Stock Position:  0.0035944977059850715
Bond Position:  [1.28875009]


portfolio before change:  [1.64912262]
curr_Stock_Price:  100.16706964787194
curr_Factors:  [100.16706965  -1.18967585  -1.00099759]
mat_Sqrt:  [[11.20282583  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00676375  0.01256134 -0.02669264]
Stock Position:  -0.006763747457664573
Bond Position:  [2.32662739]


portfolio before change:  [1.64650325]
curr_Stock_Price:  100.64034346464808
curr_Factors:  [100.64034346  -1.0795123   -1.02066161]
mat_Sqrt:  [[12.32191394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00759266 -0.05770788  1.95859391]
Stock Position:  -0.007592656565075444
Bond Position:  [2.41063081]


portfolio before change:  [1.64833202]
curr_Stock_Price:  100.47886665739135
curr_Factors:  [100.47886666  -0.98288417  -1.06184818]
mat_Sqrt:  [[13.00345479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00274556  0.00365779 -0.04855046]
Stock Position:  -0.0027455595641493855
Bond Position:  [1.92420273]


portfolio before change:  [1.65235957]
curr_Stock_Price:  99.18716753744675
curr_Factors:  [99.18716754 -0.9686143  -1.06403451]
mat_Sqrt:  [[12.99233845  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07677304  0.39097331 -0.48805633]
Stock Position:  -0.07677304472536946
Bond Position:  [9.26726042]


portfolio before change:  [1.66166639]
curr_Stock_Price:  99.09612366085292
curr_Factors:  [99.09612366 -0.81976146 -1.11610622]
mat_Sqrt:  [[14.29947244  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00036901 0.00371175 0.01171721]
Stock Position:  0.00036900952782415673
Bond Position:  [1.62509897]


portfolio before change:  [1.66194388]
curr_Stock_Price:  98.74698723797997
curr_Factors:  [98.74698724 -0.82387349 -1.12672286]
mat_Sqrt:  [[14.04076029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262167  0.01423069 -0.2513849 ]
Stock Position:  -0.002621669169078975
Bond Position:  [1.92082581]


portfolio before change:  [1.66342882]
curr_Stock_Price:  98.36376912880752
curr_Factors:  [98.36376913 -1.14523687 -1.13221715]
mat_Sqrt:  [[10.086708    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01372639 0.00768776 0.10872522]
Stock Position:  0.013726387874000004
Bond Position:  [0.31324957]


portfolio before change:  [1.66961303]
curr_Stock_Price:  98.80859802894076
curr_Factors:  [98.80859803 -1.20341573 -1.11442957]
mat_Sqrt:  [[ 9.73122056  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01870525 0.04154465 0.2455395 ]
Stock Position:  0.018705245139480277
Bond Position:  [-0.17862602]


portfolio before change:  [1.65468303]
curr_Stock_Price:  98.01281388229921
curr_Factors:  [98.01281388 -1.35038106 -1.1280089 ]
mat_Sqrt:  [[ 8.2211349   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01458571  0.01043593 -0.1504977 ]
Stock Position:  0.014585711676189396
Bond Position:  [0.22509639]


portfolio before change:  [1.6517598]
curr_Stock_Price:  97.80853770268548
curr_Factors:  [97.8085377  -1.62104774 -1.0734851 ]
mat_Sqrt:  [[ 6.60930847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00812484  0.03501941  0.58876334]
Stock Position:  -0.00812484399970511
Bond Position:  [2.44643891]


portfolio before change:  [1.65277767]
curr_Stock_Price:  97.75854454217657
curr_Factors:  [97.75854454 -1.24674578 -1.11381315]
mat_Sqrt:  [[ 9.2252259   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00841764 -0.02281562  0.24170057]
Stock Position:  -0.008417641875085079
Bond Position:  [2.47567409]


portfolio before change:  [1.66615967]
curr_Stock_Price:  96.2423244202173
curr_Factors:  [96.24232442 -1.23350269 -1.15527871]
mat_Sqrt:  [[ 8.82940667  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00243431  0.01927565 -0.03894739]
Stock Position:  0.00243430863602054
Bond Position:  [1.43187615]


portfolio before change:  [1.66610121]
curr_Stock_Price:  96.0712396253119
curr_Factors:  [96.07123963 -0.97309688 -1.15114766]
mat_Sqrt:  [[11.4827448   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00870903 -0.07720664 -0.14694518]
Stock Position:  -0.008709030828650339
Bond Position:  [2.50278859]


portfolio before change:  [1.66303285]
curr_Stock_Price:  96.49541182936342
curr_Factors:  [96.49541183 -1.3270082  -1.1336479 ]
mat_Sqrt:  [[ 8.23867359  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00435578  0.00203048 -0.09017894]
Stock Position:  0.004355776909344908
Bond Position:  [1.24272037]


portfolio before change:  [1.66595887]
curr_Stock_Price:  97.09583304137712
curr_Factors:  [97.09583304 -1.52890172 -1.17675646]
mat_Sqrt:  [[ 6.48855777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02327772 0.00501447 0.41792177]
Stock Position:  0.02327772182035763
Bond Position:  [-0.59421092]


portfolio before change:  [1.65616341]
curr_Stock_Price:  96.68140686910475
curr_Factors:  [96.68140687 -1.56159131 -1.18938831]
mat_Sqrt:  [[ 6.17458382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00372966 -0.02143693  0.13277744]
Stock Position:  -0.0037296593149619933
Bond Position:  [2.01675211]


portfolio before change:  [1.65830577]
curr_Stock_Price:  96.24219473399204
curr_Factors:  [96.24219473 -1.53864078 -1.18872733]
mat_Sqrt:  [[ 6.2933893   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00050969  0.03161009 -0.40764912]
Stock Position:  0.000509687848509943
Bond Position:  [1.60925229]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.65862753]
Stock Price:  96.08404888601508
PL:  [1.65862753]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 1.30099905e-02 -2.32172439e-02  3.40886294e-02]
 [ 4.51648259e-02  1.42995441e-01 -3.16699066e-01]
 [ 1.04877144e-01 -3.67002204e-02  1.47181962e-02]
 [-1.30428583e-02  2.25651779e-03  5.40913146e-02]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-1.28582248e+00  1.20509437e+00 -1.60707557e-01]
 [-1.42771061e-02 -1.56353103e-02 -2.68873733e-02]
 [ 6.33414314e-02 -2.20095737e-02 -3.26792849e-02]
 [-2.66614766e-02  2.90671138e-02  5.15289507e-02]
 [ 1.49442448e-01  1.40559157e-01  9.89565844e-02]
 [-3.32417745e-02 -4.59558214e-02 -3.12321926e-02]
 [ 1.21646279e-01 -4.32027187e-02 -3.50323247e-02]
 [-2.49229230e-02 -4.25330656e-02  1.11525344e-01]
 [-1.27532716e-02  1.10612841e-01 -1.32063283e-01]
 [ 3.29018831e-03  9.42578422e-02 -4.20936715e-02]
 [ 5.25097958e-02  7.02829186e-02 -9.44619087e-02]
 [ 1.70782202e-01 -1.22840073e-01  1.75254478e-01]
 [-1.58161945e-01  1.28109263e-01  1.89738723e-01]
 [ 2.45354846e-01 -2.87348771e-01 -5.07170271e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.37416235]
curr_Stock_Price:  101.1451886075963
curr_Factors:  [101.14518861  -0.7322472   -0.99436551]
mat_Sqrt:  [[17.99230703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00084642 -0.00749333  0.09724537]
Stock Position:  0.0008464230138470493
Bond Position:  [11.28855074]


portfolio before change:  [11.37587463]
curr_Stock_Price:  99.83354044014558
curr_Factors:  [99.83354044 -0.64124806 -1.01538925]
mat_Sqrt:  [[19.04618644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.09693733e-04  4.61515801e-02 -9.03454284e-01]
Stock Position:  0.0005096937329232571
Bond Position:  [11.3249901]


portfolio before change:  [11.37786505]
curr_Stock_Price:  98.18316666654398
curr_Factors:  [98.18316667 -0.91080945 -1.01279959]
mat_Sqrt:  [[14.34247965  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00699949 -0.01184495  0.04198692]
Stock Position:  0.006999492752424789
Bond Position:  [10.69063269]


portfolio before change:  [11.37354978]
curr_Stock_Price:  97.18477148803777
curr_Factors:  [97.18477149 -0.84660249 -0.97859898]
mat_Sqrt:  [[15.66474361  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.83677218e-05  7.28287984e-04  1.54307464e-01]
Stock Position:  -9.836772182002135e-05
Bond Position:  [11.38310963]


portfolio before change:  [11.37640963]
curr_Stock_Price:  97.04529778124514
curr_Factors:  [97.04529778 -0.85878875 -0.98206849]
mat_Sqrt:  [[15.3992779   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00368831 -0.04522423  0.24245377]
Stock Position:  0.0036883146393467897
Bond Position:  [11.01847604]


portfolio before change:  [11.37724951]
curr_Stock_Price:  96.52606706630966
curr_Factors:  [96.52606707 -0.70916974 -1.00808084]
mat_Sqrt:  [[17.33213891  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06188722  0.38894253 -0.45845393]
Stock Position:  -0.06188722103225023
Bond Position:  [17.35097956]


portfolio before change:  [11.30505707]
curr_Stock_Price:  97.76268311831068
curr_Factors:  [97.76268312 -0.69442555 -1.01674561]
mat_Sqrt:  [[17.66122899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00129985 -0.00504627 -0.07670219]
Stock Position:  -0.0012998536279624387
Bond Position:  [11.43213425]


portfolio before change:  [11.30916279]
curr_Stock_Price:  96.8030866198383
curr_Factors:  [96.80308662 -0.51944858 -0.97578065]
mat_Sqrt:  [[21.70298161  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00240419 -0.00710356 -0.0932249 ]
Stock Position:  0.002404191082227651
Bond Position:  [11.07642968]


portfolio before change:  [11.30868481]
curr_Stock_Price:  95.4523482764759
curr_Factors:  [95.45234828 -0.22740115 -0.96900058]
mat_Sqrt:  [[28.8533306   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035385  0.00938137  0.14699775]
Stock Position:  -0.0003538542564421783
Bond Position:  [11.34246103]


portfolio before change:  [11.31206827]
curr_Stock_Price:  93.90512746848931
curr_Factors:  [ 9.39051275e+01 -4.20679273e-04 -9.38550970e-01]
mat_Sqrt:  [[36.71969801  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00540128 0.04536527 0.28229559]
Stock Position:  0.005401280641014208
Bond Position:  [10.80486033]


portfolio before change:  [11.3294304]
curr_Stock_Price:  96.6194044171435
curr_Factors:  [96.61940442 -0.19464008 -0.95230389]
mat_Sqrt:  [[30.68689296  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0015967  -0.01483218 -0.08909675]
Stock Position:  -0.0015966983664799912
Bond Position:  [11.48370244]


portfolio before change:  [11.32898176]
curr_Stock_Price:  98.69864943285539
curr_Factors:  [98.69864943 -0.26574442 -0.97897302]
mat_Sqrt:  [[28.42741005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00371742 -0.01394362 -0.09993747]
Stock Position:  0.0037174198293025086
Bond Position:  [10.96207744]


portfolio before change:  [11.33068218]
curr_Stock_Price:  98.41876728923575
curr_Factors:  [98.41876729 -0.28015131 -0.97582486]
mat_Sqrt:  [[28.02943869  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00038673 -0.01372749  0.31815076]
Stock Position:  -0.0003867338678459915
Bond Position:  [11.36874405]


portfolio before change:  [11.33413833]
curr_Stock_Price:  96.83212913298748
curr_Factors:  [ 9.68321291e+01 -7.34998303e-03 -9.57911670e-01]
mat_Sqrt:  [[36.8817629   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046451  0.03570014 -0.37673979]
Stock Position:  -0.00046450666649841733
Bond Position:  [11.3791175]


portfolio before change:  [11.33919886]
curr_Stock_Price:  92.06277303886785
curr_Factors:  [92.06277304 -0.17002336 -0.92606752]
mat_Sqrt:  [[30.76506451  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00045305  0.03042159 -0.12008153]
Stock Position:  0.0004530513843303207
Bond Position:  [11.29748969]


portfolio before change:  [11.34247469]
curr_Stock_Price:  93.05848438744704
curr_Factors:  [93.05848439 -0.17730899 -0.93207867]
mat_Sqrt:  [[30.6870425   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00155031  0.02268371 -0.26947353]
Stock Position:  0.0015503051529339106
Bond Position:  [11.19820565]


portfolio before change:  [11.34550621]
curr_Stock_Price:  93.20788207248616
curr_Factors:  [93.20788207 -0.50060165 -0.95661772]
mat_Sqrt:  [[21.70652529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00836068 -0.03964646  0.49995224]
Stock Position:  0.008360677049112038
Bond Position:  [10.56622521]


portfolio before change:  [11.33592924]
curr_Stock_Price:  91.74641460111302
curr_Factors:  [91.7464146  -0.59290344 -0.96742824]
mat_Sqrt:  [[19.27283769  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00484005  0.04134709  0.54127176]
Stock Position:  -0.00484004993643237
Bond Position:  [11.77998646]


portfolio before change:  [11.34301374]
curr_Stock_Price:  90.89122845536515
curr_Factors:  [90.89122846 -0.36947613 -1.01124509]
mat_Sqrt:  [[22.84979807  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00364005 -0.09274142 -1.44681561]
Stock Position:  0.003640046432660819
Bond Position:  [11.01216545]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.34195923]
Stock Price:  89.84511430190443
PL:  [11.34195923]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.32913778e-02  3.34053587e-02  3.74537704e-02]
 [ 2.37066073e-02  5.55315624e-02 -8.25067680e-02]
 [ 6.59136038e-02 -5.99592365e-02 -2.77910557e-02]
 [-1.52732917e-01 -1.20488668e-01  4.10539458e-01]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-1.13931827e+00  1.03602293e+00 -1.27125782e-01]
 [-3.65911960e-02  2.64971228e-02 -7.67736633e-02]
 [ 3.07313249e-02 -2.58356417e-03 -1.08445552e-02]
 [ 3.62561874e-02  2.65268349e-02  4.25525669e-02]
 [ 1.55381791e-01  1.26791922e-01  9.73708219e-02]
 [-1.52956131e-03  3.00444692e-02 -5.14545859e-02]
 [-3.70189456e-02  1.51093603e-01  1.32069316e-02]
 [-2.63747350e-02 -4.32683797e-02  1.10825531e-01]
 [-2.70127318e-02  2.07677735e-02 -5.33737410e-02]
 [ 1.25105290e-02  8.90126851e-02 -4.74877118e-02]
 [ 5.81577258e-02  7.20390766e-02 -5.87034107e-02]
 [ 2.19110720e-01 -1.94183284e-01  1.94838008e-01]
 [-1.70407048e-01  1.32899623e-01  2.14650300e-01]
 [ 1.50446744e-01  5.89971860e-03 -3.11690816e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.16036139]
curr_Stock_Price:  100.10974327145097
curr_Factors:  [100.10974327  -1.11009346  -1.0010343 ]
mat_Sqrt:  [[12.12342164  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00237782  0.01078153  0.10684518]
Stock Position:  -0.002377820351091166
Bond Position:  [3.39840438]


portfolio before change:  [3.1626266]
curr_Stock_Price:  99.51445318317268
curr_Factors:  [99.51445318 -1.11196627 -0.97165348]
mat_Sqrt:  [[12.38744108  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00146926  0.01792273 -0.23536884]
Stock Position:  0.0014692555432932366
Bond Position:  [3.01641443]


portfolio before change:  [3.16289915]
curr_Stock_Price:  99.18663621801484
curr_Factors:  [99.18663622 -1.05785367 -0.99570666]
mat_Sqrt:  [[12.72340186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00377271 -0.01935176 -0.07928015]
Stock Position:  0.003772705672975434
Bond Position:  [2.78869716]


portfolio before change:  [3.16207566]
curr_Stock_Price:  98.78354305492233
curr_Factors:  [98.78354305 -0.96205078 -0.97302895]
mat_Sqrt:  [[14.26560359  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00655609 -0.03888755  1.1711548 ]
Stock Position:  -0.006556087676331912
Bond Position:  [3.80970922]


portfolio before change:  [3.17212635]
curr_Stock_Price:  97.39580318159845
curr_Factors:  [97.39580318 -1.16411331 -0.95960557]
mat_Sqrt:  [[11.64718184  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00487649 -0.04522423  0.24245377]
Stock Position:  0.004876491404111538
Bond Position:  [2.69717655]


portfolio before change:  [3.16775293]
curr_Stock_Price:  96.36067419490391
curr_Factors:  [96.36067419 -0.81053846 -0.93854206]
mat_Sqrt:  [[16.7603782   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05690745  0.33437496 -0.36265447]
Stock Position:  -0.05690745213572694
Bond Position:  [8.65139338]


portfolio before change:  [3.16859389]
curr_Stock_Price:  96.38390766116994
curr_Factors:  [96.38390766 -0.89492363 -0.94180029]
mat_Sqrt:  [[15.35767487  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305084  0.00855191 -0.21901389]
Stock Position:  -0.003050842804900111
Bond Position:  [3.46264604]


portfolio before change:  [3.16729306]
curr_Stock_Price:  97.09407256921018
curr_Factors:  [97.09407257 -1.12132614 -0.95490343]
mat_Sqrt:  [[12.17580467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00229885 -0.00083384 -0.0309365 ]
Stock Position:  0.002298847776315251
Bond Position:  [2.94408856]


portfolio before change:  [3.16712515]
curr_Stock_Price:  96.70082447759428
curr_Factors:  [96.70082448 -0.68620933 -0.94174409]
mat_Sqrt:  [[18.98536671  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00265241 0.0085615  0.12139063]
Stock Position:  0.002652409197032218
Bond Position:  [2.910635]


portfolio before change:  [3.17406642]
curr_Stock_Price:  99.04341646050437
curr_Factors:  [99.04341646 -0.63436147 -0.95855461]
mat_Sqrt:  [[20.13867757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00998769 0.04092192 0.27777185]
Stock Position:  0.009987687575420115
Bond Position:  [2.18485172]


portfolio before change:  [3.16705004]
curr_Stock_Price:  98.28621838810169
curr_Factors:  [98.28621839 -0.75524915 -0.96087772]
mat_Sqrt:  [[17.66803286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033393  0.00969681 -0.14678561]
Stock Position:  -0.0003339298227035966
Bond Position:  [3.19987074]


portfolio before change:  [3.16792499]
curr_Stock_Price:  98.0619596270711
curr_Factors:  [98.06195963 -0.9649607  -0.94701786]
mat_Sqrt:  [[14.49235044  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024021  0.04876525  0.0376757 ]
Stock Position:  -0.00024021220892273
Bond Position:  [3.19148067]


portfolio before change:  [3.16878057]
curr_Stock_Price:  97.82213472930012
curr_Factors:  [97.82213473 -0.60847271 -0.95596977]
mat_Sqrt:  [[20.4648422   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00061494 -0.01396481  0.31615439]
Stock Position:  -0.0006149419137902687
Bond Position:  [3.2289355]


portfolio before change:  [3.17117878]
curr_Stock_Price:  95.23511027690164
curr_Factors:  [95.23511028 -0.61995976 -0.95880272]
mat_Sqrt:  [[19.64035137  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00171425  0.00670277 -0.15226043]
Stock Position:  -0.001714246165031989
Bond Position:  [3.3344352]


portfolio before change:  [3.17418802]
curr_Stock_Price:  93.96602038928813
curr_Factors:  [93.96602039 -0.81790946 -0.9371216 ]
mat_Sqrt:  [[16.24690094  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00129174  0.02872872 -0.13546922]
Stock Position:  0.0012917404233464575
Bond Position:  [3.05280832]


portfolio before change:  [3.17347094]
curr_Stock_Price:  92.81998397137728
curr_Factors:  [92.81998397 -0.72062839 -0.91166544]
mat_Sqrt:  [[18.14451167  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00335528  0.02325051 -0.16746449]
Stock Position:  0.003355276700137222
Bond Position:  [2.86203421]


portfolio before change:  [3.16892939]
curr_Stock_Price:  91.25315364617093
curr_Factors:  [91.25315365 -0.55038401 -0.88567418]
mat_Sqrt:  [[21.70579692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01010073 -0.06267239  0.5558186 ]
Stock Position:  0.010100728645972648
Bond Position:  [2.24720604]


portfolio before change:  [3.16592303]
curr_Stock_Price:  90.89988875901219
curr_Factors:  [90.89988876 -0.82393655 -0.90323214]
mat_Sqrt:  [[16.16082482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00615462  0.04289317  0.61233756]
Stock Position:  -0.006154618833059052
Bond Position:  [3.72537719]


portfolio before change:  [3.15757497]
curr_Stock_Price:  92.40762100672923
curr_Factors:  [92.40762101 -1.07662922 -0.88824508]
mat_Sqrt:  [[12.95310011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00679586  0.00190413 -0.88916714]
Stock Position:  0.006795855532411088
Bond Position:  [2.52958613]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.16133294]
Stock Price:  92.86753356376705
PL:  [3.16133294]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 4.28577956e-02 -1.34708170e-01  6.41111580e-02]
 [ 2.14843004e-02  1.41918795e-01 -1.44352368e-01]
 [-3.71826506e-02 -8.21431837e-02 -1.27366589e-01]
 [-2.67697062e-01 -2.65656751e-01  1.03571300e+00]
 [ 6.81505036e-03 -4.97202961e-02  2.41022209e-02]
 [-1.19618955e+00  1.20584660e+00 -1.72386371e-01]
 [-3.08070540e-04  1.43176677e-02 -2.77920077e-03]
 [ 3.04266399e-02  3.75737069e-02 -6.02688775e-02]
 [ 5.38653008e-02  2.57044022e-02  3.98868930e-02]
 [ 1.54336050e-01  1.15665370e-01  8.39058772e-02]
 [ 3.52828063e-02  3.07156277e-02 -5.18359427e-02]
 [-4.94522878e-02  1.44552686e-01  4.28752469e-02]
 [-9.24238827e-02 -7.67209672e-02  7.89880587e-02]
 [ 3.36408360e-02  3.82623361e-01 -2.32779375e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 3.57621271e-02  1.13414777e-02 -8.66264861e-02]
 [-8.85156339e-02  1.70343898e-02  5.57329859e-02]
 [ 3.49837473e-02 -1.00335634e-01 -3.06168853e-02]
 [-9.21527952e-02  1.12445621e-01 -1.51800570e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.28550854]
curr_Stock_Price:  101.1340127617142
curr_Factors:  [101.13401276  -1.54066752  -0.95910962]
mat_Sqrt:  [[ 8.30343557  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00342596 -0.04347687  0.18289129]
Stock Position:  0.0034259603306934098
Bond Position:  [10.93902743]


portfolio before change:  [11.28962561]
curr_Stock_Price:  101.53739305487586
curr_Factors:  [101.53739305  -1.5263611   -1.00779606]
mat_Sqrt:  [[ 8.0548144   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00260559  0.04580409 -0.41179713]
Stock Position:  0.0026055907036871937
Bond Position:  [11.02506072]


portfolio before change:  [11.29446241]
curr_Stock_Price:  102.33575171165906
curr_Factors:  [102.33575171  -1.14770444  -1.04005873]
mat_Sqrt:  [[11.47873189  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00696494 -0.0265116  -0.36334143]
Stock Position:  -0.006964937825746418
Bond Position:  [12.00722456]


portfolio before change:  [11.29885912]
curr_Stock_Price:  102.13553032470644
curr_Factors:  [102.13553032  -0.90645834  -1.04592131]
mat_Sqrt:  [[14.49669961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00762311 -0.08574035  2.95460089]
Stock Position:  -0.007623113718208844
Bond Position:  [12.07744988]


portfolio before change:  [11.29983597]
curr_Stock_Price:  102.40351736193139
curr_Factors:  [102.40351736  -0.90935583  -1.05022358]
mat_Sqrt:  [[14.43046586  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00010989 -0.01604716  0.06875693]
Stock Position:  0.00010989130101341317
Bond Position:  [11.28858271]


portfolio before change:  [11.3023518]
curr_Stock_Price:  99.61291886200006
curr_Factors:  [99.61291886 -0.89093085 -1.01728994]
mat_Sqrt:  [[14.77698742  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06667363  0.38918532 -0.49177033]
Stock Position:  -0.06667362800170264
Bond Position:  [17.9439065]


portfolio before change:  [11.3141347]
curr_Stock_Price:  99.50348486356887
curr_Factors:  [99.50348486 -0.7620118  -1.01539749]
mat_Sqrt:  [[16.82361186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00012169  0.00462101 -0.00792829]
Stock Position:  0.00012168666159485208
Bond Position:  [11.30202646]


portfolio before change:  [11.31675772]
curr_Stock_Price:  97.83654813807323
curr_Factors:  [97.83654814 -0.59305763 -1.03404907]
mat_Sqrt:  [[19.2246153   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00134172  0.01212686 -0.17193033]
Stock Position:  0.0013417177504808215
Bond Position:  [11.18548868]


portfolio before change:  [11.31814389]
curr_Stock_Price:  96.78524865590771
curr_Factors:  [96.78524866 -0.82637998 -1.07101916]
mat_Sqrt:  [[14.5137352   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00463382 0.00829606 0.1137862 ]
Stock Position:  0.0046338221641498084
Bond Position:  [10.86965826]


portfolio before change:  [11.31850612]
curr_Stock_Price:  96.2769161014176
curr_Factors:  [96.2769161  -0.93559476 -1.03573104]
mat_Sqrt:  [[13.4086871   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01454828 0.03733084 0.23936011]
Stock Position:  0.014548281934055376
Bond Position:  [9.9178424]


portfolio before change:  [11.34313468]
curr_Stock_Price:  97.79934949266651
curr_Factors:  [97.79934949 -1.07376962 -1.07883949]
mat_Sqrt:  [[11.36239046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0027258   0.00991343 -0.14787352]
Stock Position:  0.002725803178402058
Bond Position:  [11.07655291]


portfolio before change:  [11.34482521]
curr_Stock_Price:  97.40351918704535
curr_Factors:  [97.40351919 -0.99731491 -1.10678583]
mat_Sqrt:  [[11.8788749   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094232  0.04665418  0.12231115]
Stock Position:  -0.0009423216660978973
Bond Position:  [11.43661066]


portfolio before change:  [11.34644455]
curr_Stock_Price:  98.71960240226008
curr_Factors:  [98.7196024  -0.88668357 -1.07889665]
mat_Sqrt:  [[13.82810768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0066503  -0.02476159  0.22533095]
Stock Position:  -0.006650303621687698
Bond Position:  [12.00295988]


portfolio before change:  [11.34541358]
curr_Stock_Price:  99.32590268845172
curr_Factors:  [99.32590269 -0.71652503 -1.05690955]
mat_Sqrt:  [[16.86046968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00380936  0.12349116 -0.66405476]
Stock Position:  0.003809360758159504
Bond Position:  [10.96704539]


portfolio before change:  [11.34346434]
curr_Stock_Price:  98.09437068904879
curr_Factors:  [98.09437069 -0.40701424 -1.08923342]
mat_Sqrt:  [[21.97009753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00605337 -0.09296045 -0.18429859]
Stock Position:  -0.006053367691120275
Bond Position:  [11.93726563]


portfolio before change:  [11.35036533]
curr_Stock_Price:  97.44740840424811
curr_Factors:  [97.4474084  -0.44991321 -1.04709537]
mat_Sqrt:  [[21.8085971   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00093517  0.00366045 -0.24712125]
Stock Position:  0.0009351651110602607
Bond Position:  [11.25923591]


portfolio before change:  [11.35544676]
curr_Stock_Price:  99.87080189820794
curr_Factors:  [99.8708019  -0.70002812 -1.05827612]
mat_Sqrt:  [[17.21142029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00427984  0.00549783  0.1589907 ]
Stock Position:  -0.004279835963563605
Bond Position:  [11.78287741]


portfolio before change:  [11.35910337]
curr_Stock_Price:  99.70478599794255
curr_Factors:  [99.704786   -0.69920818 -1.06076736]
mat_Sqrt:  [[17.15411591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00048112 -0.03238319 -0.08734145]
Stock Position:  0.00048111929911085264
Bond Position:  [11.31113347]


portfolio before change:  [11.36199978]
curr_Stock_Price:  99.84668841987414
curr_Factors:  [99.84668842 -1.28720608 -1.07603695]
mat_Sqrt:  [[ 9.39702229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00769377  0.03629167 -0.04330448]
Stock Position:  -0.007693771791468531
Bond Position:  [12.13019741]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.36734268]
Stock Price:  99.54644937828489
PL:  [11.36734268]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.32913778e-02  3.34053587e-02  3.74537704e-02]
 [ 1.32498512e-02  1.87548129e-02  3.12215932e-02]
 [ 4.85213615e-02 -3.85543820e-02 -3.13375541e-02]
 [-2.89064197e-01 -2.99414751e-01  9.83201554e-01]
 [-1.42697284e-02 -1.85931628e-02  3.13724879e-03]
 [-1.64675575e+00  1.75532519e+00 -2.68224976e-01]
 [ 7.96179557e-04  1.26565312e-02  3.76755579e-04]
 [-3.16621489e-02  1.37956986e-02 -3.99251199e-02]
 [ 9.42208280e-02  2.83919905e-02  6.31519567e-02]
 [ 7.29745136e-02  1.47337570e-01  5.60856446e-02]
 [ 1.04901526e-01  9.79544632e-03 -5.88789296e-02]
 [ 1.15630961e-01 -3.54209713e-02 -3.36977571e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-4.66674522e-02 -6.08181122e-02  1.22579906e-02]
 [-3.18777648e-02 -2.78428275e-02 -5.87027041e-02]
 [ 4.92683833e-02  7.19946782e-02 -1.24255615e-01]
 [-8.64887580e-02  1.66952757e-02  5.70291976e-02]
 [ 1.66726452e-02 -5.14986728e-02 -2.53882697e-02]
 [ 1.09632984e-02 -7.11897924e-02 -1.20627530e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.1146252]
curr_Stock_Price:  99.97791603655955
curr_Factors:  [99.97791604 -1.1392833  -0.9762912 ]
mat_Sqrt:  [[12.05373796  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00239157  0.01078153  0.10684518]
Stock Position:  -0.0023915667316382486
Bond Position:  [2.35372906]


portfolio before change:  [2.11644828]
curr_Stock_Price:  99.46169339496589
curr_Factors:  [99.46169339 -1.34495058 -0.99519633]
mat_Sqrt:  [[ 9.57950254  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00244806 0.00605309 0.08906652]
Stock Position:  0.002448064742560616
Bond Position:  [1.87295962]


portfolio before change:  [2.11660376]
curr_Stock_Price:  99.33390874117066
curr_Factors:  [99.33390874 -0.77798062 -1.04584259]
mat_Sqrt:  [[16.03323539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213648 -0.01244337 -0.08939732]
Stock Position:  0.002136482686197996
Bond Position:  [1.90437858]


portfolio before change:  [2.12049512]
curr_Stock_Price:  100.9324293905825
curr_Factors:  [100.93242939  -0.7077148   -1.04317525]
mat_Sqrt:  [[17.5238222   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00853049 -0.0966357   2.80480036]
Stock Position:  -0.008530490570344699
Bond Position:  [2.98149826]


portfolio before change:  [2.11455037]
curr_Stock_Price:  101.71670093538201
curr_Factors:  [101.71670094  -0.72978895  -1.10295396]
mat_Sqrt:  [[16.27204501  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00107083 -0.00600092  0.0089497 ]
Stock Position:  -0.001070833665622929
Bond Position:  [2.22347204]


portfolio before change:  [2.1149308]
curr_Stock_Price:  101.88059990420902
curr_Factors:  [ 1.01880600e+02 -4.99908350e-02 -1.12899022e+00]
mat_Sqrt:  [[31.33765745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04286226  0.56652877 -0.7651712 ]
Stock Position:  -0.042862255721868615
Bond Position:  [6.48176313]


portfolio before change:  [2.17935652]
curr_Stock_Price:  100.41532300020151
curr_Factors:  [100.415323    -0.14902188  -1.10433756]
mat_Sqrt:  [[28.67298444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00012055 0.00408488 0.00107478]
Stock Position:  0.00012055208580297079
Bond Position:  [2.16725124]


portfolio before change:  [2.1797473]
curr_Stock_Price:  99.16194519908498
curr_Factors:  [99.1619452  -0.44964683 -1.11123165]
mat_Sqrt:  [[20.81920437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.001777    0.00445254 -0.11389525]
Stock Position:  -0.0017770032903296565
Bond Position:  [2.3559584]


portfolio before change:  [2.17669317]
curr_Stock_Price:  101.21213585594765
curr_Factors:  [101.21213586  -0.28814794  -1.124631  ]
mat_Sqrt:  [[24.64169013  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00458196 0.00916348 0.18015495]
Stock Position:  0.004581956729489068
Bond Position:  [1.71294354]


portfolio before change:  [2.16822831]
curr_Stock_Price:  99.27122919151786
curr_Factors:  [99.27122919 -0.36150892 -1.11910242]
mat_Sqrt:  [[22.58406248  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00506986 0.047553   0.15999673]
Stock Position:  0.005069863033793156
Bond Position:  [1.66493677]


portfolio before change:  [2.17326336]
curr_Stock_Price:  100.18225390699065
curr_Factors:  [ 1.00182254e+02 -4.49895387e-02 -1.09774689e+00]
mat_Sqrt:  [[31.95263473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00296947  0.00316147 -0.1679652 ]
Stock Position:  0.0029694703725399465
Bond Position:  [1.87577513]


portfolio before change:  [2.16394661]
curr_Stock_Price:  96.88679761547392
curr_Factors:  [ 9.68867976e+01 -1.73714908e-02 -1.08574037e+00]
mat_Sqrt:  [[32.15060935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00315771 -0.01143207 -0.09613032]
Stock Position:  0.0031577056186768864
Bond Position:  [1.85800662]


portfolio before change:  [2.15984488]
curr_Stock_Price:  95.44072049933489
curr_Factors:  [95.4407205   0.2717311  -1.07410799]
mat_Sqrt:  [[42.78247002  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00039411 -0.00995959  0.34984664]
Stock Position:  0.00039411290186476067
Bond Position:  [2.12223046]


portfolio before change:  [2.15938305]
curr_Stock_Price:  92.92253284336377
curr_Factors:  [92.92253284  0.20118591 -1.04532767]
mat_Sqrt:  [[39.94982967  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00141627 -0.01962896  0.03496864]
Stock Position:  -0.001416270005450052
Bond Position:  [2.29098645]


portfolio before change:  [2.16239251]
curr_Stock_Price:  91.20207042074172
curr_Factors:  [91.20207042  0.60806012 -1.0081766 ]
mat_Sqrt:  [[61.12745549  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008105  -0.00898623 -0.16746248]
Stock Position:  -0.0008104999149973983
Bond Position:  [2.23631178]


portfolio before change:  [2.16144832]
curr_Stock_Price:  93.05689917610923
curr_Factors:  [93.05689918  0.19184919 -0.97094169]
mat_Sqrt:  [[42.69657169  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090407  0.02323618 -0.35446668]
Stock Position:  0.0009040694074236636
Bond Position:  [2.07731842]


portfolio before change:  [2.16841824]
curr_Stock_Price:  100.1918881716793
curr_Factors:  [100.19188817  -0.25273516  -0.99218022]
mat_Sqrt:  [[28.85178477  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0024761   0.00538838  0.16268843]
Stock Position:  -0.0024760968326037578
Bond Position:  [2.41650306]


portfolio before change:  [2.17069644]
curr_Stock_Price:  99.51582487639813
curr_Factors:  [99.51582488 -0.22822692 -0.98227279]
mat_Sqrt:  [[29.6605228   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.29786418e-05 -1.66211252e-02 -7.24256667e-02]
Stock Position:  3.297864179101474e-05
Bond Position:  [2.16741454]


portfolio before change:  [2.17120459]
curr_Stock_Price:  98.491824567422
curr_Factors:  [98.49182457 -0.24888962 -0.98499662]
mat_Sqrt:  [[28.6767676   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098307 -0.02297641 -0.34411677]
Stock Position:  -0.0009830692535543672
Bond Position:  [2.26802887]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.17259975]
Stock Price:  97.64948158081043
PL:  [2.17259975]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.94139343e-02  6.36103708e-02  3.20547018e-02]
 [ 3.97454786e-02  1.65809514e-01 -2.74433714e-01]
 [ 1.07884283e-01 -2.36229247e-02 -8.19837194e-03]
 [-2.07694435e-01 -1.95304111e-01  5.77078392e-01]
 [-5.29307971e-02  3.84815761e-02 -3.53041425e-02]
 [-1.31109802e+00  1.32857762e+00 -1.93060369e-01]
 [-3.02126533e-02  4.38638005e-03 -6.23377689e-02]
 [ 8.15748405e-02 -5.58296347e-02 -1.60686987e-02]
 [-5.81243194e-02  3.08482089e-02  5.67206590e-02]
 [ 1.45886780e-01  1.61393457e-01  1.12678191e-01]
 [-5.30109517e-01 -5.20968857e-01  1.69863925e-01]
 [ 8.84406567e-02 -3.92918298e-02 -3.95635034e-02]
 [-6.55369495e-02  1.21313975e-01  1.35502831e-01]
 [ 4.45097988e-03  4.08301716e-01 -3.43520066e-01]
 [ 1.06763315e-01 -5.97838140e-02 -4.08160335e-02]
 [ 3.43239008e-02  2.12429395e-02 -8.00784271e-02]
 [-7.74031680e-02  1.68621534e-02  5.34577463e-02]
 [ 4.34587318e-02 -2.33467240e-01 -3.21146976e-02]
 [-1.84711602e-01  1.38250935e-02 -4.06213906e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.86185569]
curr_Stock_Price:  99.81998983964621
curr_Factors:  [99.81998984 -0.94677742 -1.0275584 ]
mat_Sqrt:  [[13.86035548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215625  0.02053016  0.09144314]
Stock Position:  -0.002156249394565695
Bond Position:  [1.07709248]


portfolio before change:  [0.86073766]
curr_Stock_Price:  100.46339049326922
curr_Factors:  [100.46339049  -0.87968575  -1.02414105]
mat_Sqrt:  [[14.96877826  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00117395  0.05351479 -0.782883  ]
Stock Position:  0.0011739539658246253
Bond Position:  [0.74279827]


portfolio before change:  [0.85828636]
curr_Stock_Price:  98.21711073134179
curr_Factors:  [98.21711073 -0.50173146 -1.02321186]
mat_Sqrt:  [[21.37532282  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00474326 -0.00762427 -0.02338767]
Stock Position:  0.004743263461730108
Bond Position:  [0.39241672]


portfolio before change:  [0.85866686]
curr_Stock_Price:  98.27664604942197
curr_Factors:  [98.27664605 -0.49039916 -1.05035105]
mat_Sqrt:  [[21.0528556   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00616378 -0.06303413  1.64624403]
Stock Position:  -0.006163775997177955
Bond Position:  [1.4644221]


portfolio before change:  [0.84571715]
curr_Stock_Price:  100.43698849238343
curr_Factors:  [100.43698849  -0.58953639  -1.03956886]
mat_Sqrt:  [[19.69619165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00265443  0.01241988 -0.10071289]
Stock Position:  -0.00265443224333195
Bond Position:  [1.11232033]


portfolio before change:  [0.8481335]
curr_Stock_Price:  99.63145272841135
curr_Factors:  [99.63145273 -0.68168166 -1.04021704]
mat_Sqrt:  [[17.80677866  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0606124   0.42879658 -0.5507475 ]
Stock Position:  -0.06061239650079963
Bond Position:  [6.88703462]


portfolio before change:  [0.9643862]
curr_Stock_Price:  97.74189328591999
curr_Factors:  [97.74189329 -0.36035472 -1.03574148]
mat_Sqrt:  [[24.19713093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00173748  0.0014157  -0.1778323 ]
Stock Position:  -0.0017374758644637769
Bond Position:  [1.13421038]


portfolio before change:  [0.96754002]
curr_Stock_Price:  96.08993773437454
curr_Factors:  [96.08993773 -0.38697674 -1.04690318]
mat_Sqrt:  [[22.90613304  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00292056 -0.01801894 -0.04583952]
Stock Position:  0.002920556450075583
Bond Position:  [0.68690394]


portfolio before change:  [0.96698409]
curr_Stock_Price:  95.84078012605723
curr_Factors:  [ 9.58407801e+01  6.59115000e-02 -1.09612301e+00]
mat_Sqrt:  [[34.20858934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00117659  0.00995622  0.16180825]
Stock Position:  -0.001176587513036435
Bond Position:  [1.07974916]


portfolio before change:  [0.97121685]
curr_Stock_Price:  92.47274492622518
curr_Factors:  [92.47274493  0.26116306 -1.03885834]
mat_Sqrt:  [[42.48787207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00475033 0.05208951 0.32143952]
Stock Position:  0.004750330180103861
Bond Position:  [0.53194078]


portfolio before change:  [0.94279254]
curr_Stock_Price:  86.46109613943156
curr_Factors:  [86.46109614  0.31263327 -1.0583676 ]
mat_Sqrt:  [[41.01591741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01467183 -0.16814198  0.4845745 ]
Stock Position:  -0.014671828620810302
Bond Position:  [2.21133492]


portfolio before change:  [0.86304445]
curr_Stock_Price:  91.93423715908695
curr_Factors:  [91.93423716  0.26720224 -1.07249782]
mat_Sqrt:  [[41.09054029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00176061 -0.01268138 -0.11286366]
Stock Position:  0.0017606091027413987
Bond Position:  [0.7011842]


portfolio before change:  [0.88025432]
curr_Stock_Price:  101.60961010528185
curr_Factors:  [ 1.01609610e+02  4.32414682e-02 -1.11239695e+00]
mat_Sqrt:  [[34.88240807  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.75961381e-04  3.91539172e-02  3.86551861e-01]
Stock Position:  -0.00037596138081349745
Bond Position:  [0.91845561]


portfolio before change:  [0.88053796]
curr_Stock_Price:  101.46597949603539
curr_Factors:  [101.4659795    0.24814129  -1.11356483]
mat_Sqrt:  [[42.70431736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.13880375e-04  1.31778812e-01 -9.79967130e-01]
Stock Position:  0.00041388037465812385
Bond Position:  [0.83854318]


portfolio before change:  [0.88192755]
curr_Stock_Price:  104.31687302373709
curr_Factors:  [ 1.04316873e+02  6.09604481e-04 -1.12959291e+00]
mat_Sqrt:  [[33.73209712  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00255627 -0.01929514 -0.11643678]
Stock Position:  0.002556273239427373
Bond Position:  [0.61526512]


portfolio before change:  [0.88174662]
curr_Stock_Price:  104.18591380013396
curr_Factors:  [104.1859138    0.178967    -1.11115508]
mat_Sqrt:  [[41.01709194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00054402  0.00685613 -0.22844146]
Stock Position:  0.0005440209457420503
Bond Position:  [0.8250673]


portfolio before change:  [0.88297805]
curr_Stock_Price:  106.07027763330603
curr_Factors:  [ 1.06070278e+02  6.55625791e-02 -1.11443307e+00]
mat_Sqrt:  [[37.15994286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016967   0.00544224  0.15250007]
Stock Position:  -0.0016966974037779868
Bond Position:  [1.06294721]


portfolio before change:  [0.87829277]
curr_Stock_Price:  108.9883274944158
curr_Factors:  [108.98832749  -0.3097843   -1.15826238]
mat_Sqrt:  [[25.10819049  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042826 -0.07535123 -0.09161429]
Stock Position:  -0.00042826479768482415
Bond Position:  [0.92496863]


portfolio before change:  [0.87939439]
curr_Stock_Price:  106.95605011310117
curr_Factors:  [106.95605011  -0.81332393  -1.1848915 ]
mat_Sqrt:  [[14.50078187  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01311525  0.00446203 -0.11588152]
Stock Position:  -0.013115249589836488
Bond Position:  [2.28214969]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.87318544]
Stock Price:  107.47297208452996
PL:  [-6.59978664]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.58940640e-02  4.62454473e-02  3.51586374e-02]
 [ 5.97322346e-03 -7.03843963e-03  1.26246507e-01]
 [-2.86296035e-02 -3.16482279e-03 -1.10954074e-02]
 [-1.61569434e-01 -1.34968096e-01  4.97152034e-01]
 [ 2.18356292e-02 -7.18949447e-02  3.90374508e-02]
 [-9.48831030e-01  9.76789616e-01 -1.32154849e-01]
 [ 1.03578821e-02 -5.60829052e-03  2.93689662e-02]
 [-9.20244001e-02 -1.36539528e-02 -3.43479254e-02]
 [-1.23897161e-01  5.98426280e-03  4.10956921e-02]
 [-7.09630172e-01  3.19279508e-01 -3.62329124e-01]
 [ 1.46584987e-01  4.96384305e-02 -5.57803709e-02]
 [-5.87911878e-02  1.37089329e-01  6.81929456e-02]
 [-3.27934599e-02 -9.71006784e-02 -5.75696239e-02]
 [ 1.44949269e-02  6.94315453e-01 -4.65687302e-01]
 [ 1.05662621e-01 -5.99368372e-02 -4.10117320e-02]
 [ 5.26617516e-02  4.98893504e-02  6.80924140e-02]
 [-8.59902739e-02  1.59672970e-02  5.76119210e-02]
 [ 4.15827874e-02 -1.26372782e-01 -3.86534199e-02]
 [-1.46319058e-01  4.30232304e-02 -1.82755488e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.65832593]
curr_Stock_Price:  99.50229157550325
curr_Factors:  [99.50229158 -1.42233186 -1.0083933 ]
mat_Sqrt:  [[ 8.75351655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00334466  0.01492565  0.10029781]
Stock Position:  -0.0033446586453830646
Bond Position:  [-1.32552473]


portfolio before change:  [-1.65875183]
curr_Stock_Price:  99.53053678753794
curr_Factors:  [99.53053679 -1.57614601 -1.05856154]
mat_Sqrt:  [[ 7.14031543  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00424442 -0.00227165  0.36014614]
Stock Position:  0.004244415895270157
Bond Position:  [-2.08120082]


portfolio before change:  [-1.65902723]
curr_Stock_Price:  99.58825209014935
curr_Factors:  [99.58825209 -1.21541221 -1.02729116]
mat_Sqrt:  [[10.57339393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.002983   -0.00102144 -0.03165211]
Stock Position:  -0.002983002526343109
Bond Position:  [-1.36195522]


portfolio before change:  [-1.65987067]
curr_Stock_Price:  99.75684574288668
curr_Factors:  [99.75684574 -1.15447552 -1.03457808]
mat_Sqrt:  [[11.17503288  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00784239 -0.04356077  1.41823637]
Stock Position:  -0.007842388325474018
Bond Position:  [-0.87753875]


portfolio before change:  [-1.66925285]
curr_Stock_Price:  100.92521004613901
curr_Factors:  [100.92521005  -1.27397329  -1.00112224]
mat_Sqrt:  [[10.37380845  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00145835 -0.02320399  0.11136298]
Stock Position:  0.0014583478558571124
Bond Position:  [-1.81643691]


portfolio before change:  [-1.66965586]
curr_Stock_Price:  100.96028930438008
curr_Factors:  [100.9602893   -1.20254508  -0.96260213]
mat_Sqrt:  [[11.58348117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06702827  0.31525749 -0.377001  ]
Stock Position:  -0.06702826803739989
Bond Position:  [5.09753747]


portfolio before change:  [-1.72468337]
curr_Stock_Price:  101.80026404417907
curr_Factors:  [101.80026404  -1.43601566  -1.0089225 ]
mat_Sqrt:  [[ 8.82928944  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00172245 -0.00181007  0.08378149]
Stock Position:  0.0017224500110481424
Bond Position:  [-1.90002923]


portfolio before change:  [-1.72346888]
curr_Stock_Price:  102.7811637885468
curr_Factors:  [102.78116379  -1.60974465  -1.00531048]
mat_Sqrt:  [[ 7.51985584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01354052 -0.00440679 -0.09798507]
Stock Position:  -0.013540517881596851
Bond Position:  [-0.3317587]


portfolio before change:  [-1.73578899]
curr_Stock_Price:  103.68490730044351
curr_Factors:  [103.6849073   -1.42221932  -1.00325154]
mat_Sqrt:  [[ 9.16952703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01246378  0.00193141  0.11723457]
Stock Position:  -0.01246378408829793
Bond Position:  [-0.44348269]


portfolio before change:  [-1.73340875]
curr_Stock_Price:  103.48503810299447
curr_Factors:  [103.4850381   -1.28531718  -1.04461485]
mat_Sqrt:  [[10.06933852  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07134705  0.10304702 -1.03362414]
Stock Position:  -0.07134705384028961
Bond Position:  [5.64994384]


portfolio before change:  [-1.80292056]
curr_Stock_Price:  104.47911528797613
curr_Factors:  [104.47911529  -1.19587993  -1.06602188]
mat_Sqrt:  [[10.88173169  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01335553  0.01602073 -0.15912587]
Stock Position:  0.013355527655646906
Bond Position:  [-3.19829428]


portfolio before change:  [-1.81007027]
curr_Stock_Price:  104.00365434630694
curr_Factors:  [104.00365435  -0.93696171  -1.07249519]
mat_Sqrt:  [[13.94288207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00121124  0.04424539  0.19453549]
Stock Position:  -0.0012112358703471736
Bond Position:  [-1.68409731]


portfolio before change:  [-1.80965271]
curr_Stock_Price:  103.31127415059697
curr_Factors:  [103.31127415  -0.93017779  -1.09241426]
mat_Sqrt:  [[13.66932757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00470875 -0.03133911 -0.16423011]
Stock Position:  -0.00470874685101201
Bond Position:  [-1.32318607]


portfolio before change:  [-1.81304528]
curr_Stock_Price:  103.96149705512823
curr_Factors:  [103.96149706  -0.37378704  -1.06252655]
mat_Sqrt:  [[24.72233327  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00247402  0.22408935 -1.32847625]
Stock Position:  0.0024740161866697277
Bond Position:  [-2.07024771]


portfolio before change:  [-1.81326209]
curr_Stock_Price:  104.0830863293029
curr_Factors:  [104.08308633  -0.1993648   -1.08153556]
mat_Sqrt:  [[28.91293651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00294182 -0.01934453 -0.11699506]
Stock Position:  0.0029418174281572937
Bond Position:  [-2.11945553]


portfolio before change:  [-1.81900884]
curr_Stock_Price:  102.30975566897298
curr_Factors:  [102.30975567  -0.54928555  -1.05060352]
mat_Sqrt:  [[20.65827488  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00371496 0.01610172 0.1942487 ]
Stock Position:  0.0037149606567923876
Bond Position:  [-2.19908556]


portfolio before change:  [-1.81331018]
curr_Stock_Price:  103.99173824016465
curr_Factors:  [103.99173824  -0.58661718  -1.07675177]
mat_Sqrt:  [[19.70638129  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00360142  0.00515342  0.16435077]
Stock Position:  -0.0036014211791680953
Bond Position:  [-1.43879213]


portfolio before change:  [-1.80323292]
curr_Stock_Price:  101.09371335179233
curr_Factors:  [101.09371335  -0.5872994   -1.0749751 ]
mat_Sqrt:  [[19.17818508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00041177 -0.04078664 -0.11026745]
Stock Position:  0.0004117675847396774
Bond Position:  [-1.84486003]


portfolio before change:  [-1.80265211]
curr_Stock_Price:  103.6244489632475
curr_Factors:  [103.62444896  -0.75376291  -1.08100338]
mat_Sqrt:  [[16.54372709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00853903  0.01388569 -0.05213505]
Stock Position:  -0.008539034614376507
Bond Position:  [-0.91779936]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.81291661]
Stock Price:  104.79964269254768
PL:  [-6.6125593]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-9.07292924e-02  1.69832471e-01  7.27075515e-03]
 [-1.62908236e-02 -8.49199062e-02  1.55279479e-01]
 [ 8.92665472e-02 -4.89922759e-02 -1.99717950e-02]
 [-7.85782220e-02 -5.03149921e-02  2.23672622e-01]
 [-6.78129255e-02  6.04518325e-02 -5.01017087e-02]
 [-1.40204564e+00  1.37570993e+00 -1.96879723e-01]
 [-3.90413661e-02  2.50423284e-02 -8.21451920e-02]
 [ 8.35265423e-02 -5.85179991e-02 -1.60591507e-02]
 [ 3.22530114e-02  2.75298037e-02  4.64185801e-02]
 [ 1.54464449e-01  1.17031521e-01  8.55591429e-02]
 [-1.52956131e-03  3.00444692e-02 -5.14545859e-02]
 [ 6.97643339e-02  2.39146289e-02 -2.35217175e-02]
 [-1.24995735e-01 -9.32179666e-02  6.32875464e-02]
 [ 2.21972340e-02  6.21736238e-01 -4.05553082e-01]
 [ 1.60111299e-01 -8.36689233e-02  7.48401733e-03]
 [ 1.62743417e-02 -3.31639722e-02 -1.10209786e-01]
 [-8.60239890e-02  1.58889340e-02  5.64835579e-02]
 [ 4.10804357e-02 -1.43871815e-01 -4.19210012e-02]
 [-1.30737148e-01  3.46340386e-02 -3.23858743e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.27489657]
curr_Stock_Price:  99.17244235300362
curr_Factors:  [99.17244235 -0.85500763 -1.02935345]
mat_Sqrt:  [[15.06688206  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0036224   0.05481319  0.02074144]
Stock Position:  -0.003622398282174812
Bond Position:  [-3.91565448]


portfolio before change:  [-4.27123598]
curr_Stock_Price:  97.8916277003661
curr_Factors:  [97.8916277  -0.84702873 -0.98624111]
mat_Sqrt:  [[15.65188231  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.23227085e-04 -2.74077819e-02  4.42969133e-01]
Stock Position:  -0.00012322708500143583
Bond Position:  [-4.25917308]


portfolio before change:  [-4.27240762]
curr_Stock_Price:  98.75757939548092
curr_Factors:  [98.7575794  -0.83939921 -0.96928069]
mat_Sqrt:  [[16.18343615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00464607 -0.01581219 -0.05697397]
Stock Position:  0.0046460661660219366
Bond Position:  [-4.73124187]


portfolio before change:  [-4.27957841]
curr_Stock_Price:  97.4687839851222
curr_Factors:  [97.46878399 -0.7494498  -0.99590903]
mat_Sqrt:  [[17.01632761  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00253825 -0.01623909  0.63807573]
Stock Position:  -0.002538252961892045
Bond Position:  [-4.03217798]


portfolio before change:  [-4.28148662]
curr_Stock_Price:  97.82337619934096
curr_Factors:  [97.8233762  -0.39180092 -1.00780565]
mat_Sqrt:  [[24.13244008  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00272249  0.01951075 -0.14292623]
Stock Position:  -0.002722485382536943
Bond Position:  [-4.01516391]


portfolio before change:  [-4.28359155]
curr_Stock_Price:  98.22778917677249
curr_Factors:  [98.22778918 -0.36233498 -0.97815329]
mat_Sqrt:  [[25.70796564  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04517736  0.44400847 -0.56164305]
Stock Position:  -0.045177356568126194
Bond Position:  [0.15408031]


portfolio before change:  [-4.23914872]
curr_Stock_Price:  97.24490083196252
curr_Factors:  [97.24490083 -0.41934271 -0.95817806]
mat_Sqrt:  [[24.52546034  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00206714  0.00808238 -0.23433737]
Stock Position:  -0.002067135074466931
Bond Position:  [-4.03813038]


portfolio before change:  [-4.23798024]
curr_Stock_Price:  96.1911983481385
curr_Factors:  [96.19119835 -0.65295141 -0.92294902]
mat_Sqrt:  [[19.89438311  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00343331 -0.0188866  -0.04581229]
Stock Position:  0.0034333080319078574
Bond Position:  [-4.56823425]


portfolio before change:  [-4.23369315]
curr_Stock_Price:  97.77255567829022
curr_Factors:  [97.77255568 -0.53056251 -0.91547333]
mat_Sqrt:  [[23.02563327  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0020563  0.00888521 0.13241929]
Stock Position:  0.0020563022744292153
Bond Position:  [-4.43474308]


portfolio before change:  [-4.23679373]
curr_Stock_Price:  96.80394527030394
curr_Factors:  [96.80394527 -0.89941653 -0.93060408]
mat_Sqrt:  [[15.52834619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01261036 0.03777176 0.24407642]
Stock Position:  0.012610363843072053
Bond Position:  [-5.4575267]


portfolio before change:  [-4.21566801]
curr_Stock_Price:  98.58742047272331
curr_Factors:  [98.58742047 -0.66118914 -0.9388335 ]
mat_Sqrt:  [[19.9040063   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00029642  0.00969681 -0.14678561]
Stock Position:  -0.00029641686155406846
Bond Position:  [-4.18644504]


portfolio before change:  [-4.21641707]
curr_Stock_Price:  97.5831399897105
curr_Factors:  [97.58313999 -0.5474615  -0.96583306]
mat_Sqrt:  [[21.48618498  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00325067  0.00771841 -0.06710091]
Stock Position:  0.003250671847169572
Bond Position:  [-4.53362784]


portfolio before change:  [-4.2116132]
curr_Stock_Price:  99.40965898806894
curr_Factors:  [99.40965899 -0.55552543 -0.97376912]
mat_Sqrt:  [[21.54092766  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00608633 -0.03008597  0.18054175]
Stock Position:  -0.006086332899350728
Bond Position:  [-3.60657293]


portfolio before change:  [-4.22667512]
curr_Stock_Price:  101.73620974341728
curr_Factors:  [101.73620974  -0.93891543  -0.96844942]
mat_Sqrt:  [[15.10488846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00439099  0.20066451 -1.15693006]
Stock Position:  0.004390991439496329
Bond Position:  [-4.67339795]


portfolio before change:  [-4.20867466]
curr_Stock_Price:  106.10172881671137
curr_Factors:  [106.10172882  -1.29192572  -1.00000217]
mat_Sqrt:  [[10.72385231  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01348024 -0.02700403  0.02134982]
Stock Position:  0.013480241622268033
Bond Position:  [-5.6389516]


portfolio before change:  [-4.21071035]
curr_Stock_Price:  106.05530692622472
curr_Factors:  [106.05530693  -1.15283411  -1.0119995 ]
mat_Sqrt:  [[12.1718646   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106736 -0.01070363 -0.31439784]
Stock Position:  -0.0010673552984837287
Bond Position:  [-4.09751166]


portfolio before change:  [-4.21135958]
curr_Stock_Price:  105.70371337909182
curr_Factors:  [105.70371338  -1.02584842  -1.05266982]
mat_Sqrt:  [[13.22516936  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00538753  0.00512813  0.16113187]
Stock Position:  -0.005387531456502834
Bond Position:  [-3.6418775]


portfolio before change:  [-4.19817662]
curr_Stock_Price:  103.08775781659848
curr_Factors:  [103.08775782  -0.69459404  -1.05934563]
mat_Sqrt:  [[17.84352987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00017685 -0.04643443 -0.11958895]
Stock Position:  0.00017685042722831126
Bond Position:  [-4.21640774]


portfolio before change:  [-4.19908509]
curr_Stock_Price:  103.91200217856915
curr_Factors:  [103.91200218  -0.25146834  -1.0945589 ]
mat_Sqrt:  [[27.04540613  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00481702  0.01117809 -0.09238788]
Stock Position:  -0.004817019289558434
Bond Position:  [-3.69853897]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.19545839]
Stock Price:  102.96713290913334
PL:  [-7.1625913]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-8.30373440e-02  1.60463079e-01  1.02174678e-02]
 [ 2.31068740e-02  1.48115875e-01 -1.86804778e-01]
 [ 9.19786036e-02 -4.56054034e-02 -1.78242880e-02]
 [-2.41043186e-01 -2.41563534e-01  7.19107949e-01]
 [-7.30755356e-02  6.82209425e-02 -5.53344159e-02]
 [-1.16827960e+00  1.21409023e+00 -1.74422225e-01]
 [ 3.07028283e-03  8.26709089e-03  6.83840992e-03]
 [ 1.95309425e-02 -2.26605449e-02  6.88846016e-03]
 [ 9.97074078e-02 -1.77678333e-02 -7.97573593e-03]
 [-7.60790779e-01  2.85374996e-01 -3.04932423e-01]
 [-1.79728634e-01 -2.59189225e-01  4.04969174e-02]
 [ 9.56830276e-02 -3.70342534e-02 -3.76273536e-02]
 [ 3.05409931e-02  1.38570621e-01  2.53590118e-02]
 [ 5.69120045e-03  1.11130138e+00 -7.11092371e-01]
 [ 1.71855057e-01 -1.69303319e-01  2.01202431e-02]
 [ 1.27097118e-02 -3.90327379e-02 -1.57228740e-01]
 [-7.63246696e-02  1.69839069e-02  5.30792055e-02]
 [ 3.65027739e-02 -1.41773621e-01 -4.43147175e-02]
 [-2.36791641e-01 -2.57825994e-02 -7.09338464e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.34644833]
curr_Stock_Price:  99.54160738198276
curr_Factors:  [99.54160738 -0.61414847 -0.98443068]
mat_Sqrt:  [[20.12567917  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00239482  0.05178924  0.02914759]
Stock Position:  -0.0023948172264920886
Bond Position:  [-1.10806438]


portfolio before change:  [-1.3511628]
curr_Stock_Price:  101.39453297441504
curr_Factors:  [101.39453297  -0.83891413  -0.99444237]
mat_Sqrt:  [[16.21055656  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00093825  0.04780419 -0.53290204]
Stock Position:  0.0009382487671114244
Bond Position:  [-1.4462961]


portfolio before change:  [-1.35407649]
curr_Stock_Price:  98.67449365202842
curr_Factors:  [98.67449365 -0.80343907 -0.96740798]
mat_Sqrt:  [[16.79329057  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00470611 -0.01471908 -0.05084773]
Stock Position:  0.004706109966829134
Bond Position:  [-1.81844951]


portfolio before change:  [-1.35031797]
curr_Stock_Price:  99.56975388121023
curr_Factors:  [99.56975388 -0.76452222 -0.94744685]
mat_Sqrt:  [[17.9733369   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00798766 -0.0779643   2.05141482]
Stock Position:  -0.007987656444404944
Bond Position:  [-0.55498898]


portfolio before change:  [-1.3519845]
curr_Stock_Price:  99.76101961920347
curr_Factors:  [99.76101962 -0.59075294 -0.94712866]
mat_Sqrt:  [[21.43223131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328688  0.02201821 -0.15785369]
Stock Position:  -0.0032868758890414605
Bond Position:  [-1.02408241]


portfolio before change:  [-1.35705006]
curr_Stock_Price:  101.22426450108954
curr_Factors:  [101.2242645   -0.69685724  -0.95448728]
mat_Sqrt:  [[19.41399073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04924584  0.39184594 -0.49757806]
Stock Position:  -0.04924583877073334
Bond Position:  [3.62782375]


portfolio before change:  [-1.32278139]
curr_Stock_Price:  100.54681439813457
curr_Factors:  [100.5468144   -0.40136782  -0.91429251]
mat_Sqrt:  [[26.97641877  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00022811 0.00266819 0.01950808]
Stock Position:  0.00022811331330036688
Bond Position:  [-1.34571746]


portfolio before change:  [-1.32370038]
curr_Stock_Price:  97.99319050579959
curr_Factors:  [97.99319051  0.17708416 -0.92195569]
mat_Sqrt:  [[46.52670542  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00035058 -0.00731366  0.01965086]
Stock Position:  0.0003505831561505396
Bond Position:  [-1.35805514]


portfolio before change:  [-1.32156272]
curr_Stock_Price:  105.05917302212156
curr_Factors:  [105.05917302   0.61454933  -0.93836172]
mat_Sqrt:  [[ 7.59983286e+01  0.00000000e+00  0.00000000e+00]
 [-6.32455532e-01  3.09838668e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [ 0.00124282 -0.00573454 -0.02275255]
Stock Position:  0.0012428236974090774
Bond Position:  [-1.45213275]


portfolio before change:  [-1.31772016]
curr_Stock_Price:  108.44310904740098
curr_Factors:  [108.44310905   0.44730646  -0.90514369]
mat_Sqrt:  [[68.60658107  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01114737  0.09210438 -0.86988733]
Stock Position:  -0.011147369684234538
Bond Position:  [-0.10886473]


portfolio before change:  [-1.17120966]
curr_Stock_Price:  95.29761169283915
curr_Factors:  [95.29761169  0.80728332 -0.90692014]
mat_Sqrt:  [[ 8.62601677e+01  0.00000000e+00  0.00000000e+00]
 [-6.32455532e-01  3.09838668e+00  0.00000000e+00]
 [-7.15541753e-02  0.00000000e+00  3.50542437e-01]]
grads:  [-0.00260107 -0.08365296  0.11552643]
Stock Position:  -0.0026010732434312636
Bond Position:  [-0.92333359]


portfolio before change:  [-1.16627465]
curr_Stock_Price:  93.31155885051034
curr_Factors:  [93.31155885  0.37734986 -0.83631044]
mat_Sqrt:  [[58.96732117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00136419 -0.01195275 -0.10734037]
Stock Position:  0.0013641927314995026
Bond Position:  [-1.2935696]


portfolio before change:  [-1.15525775]
curr_Stock_Price:  101.62441495762623
curr_Factors:  [ 1.01624415e+02  7.11510997e-02 -8.72869061e-01]
mat_Sqrt:  [[45.58441355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00140405 0.04472348 0.0723422 ]
Stock Position:  0.0014040542422485774
Bond Position:  [-1.29794394]


portfolio before change:  [-1.14641204]
curr_Stock_Price:  108.15566635367563
curr_Factors:  [ 1.08155666e+02 -1.06896826e-01 -8.68201217e-01]
mat_Sqrt:  [[40.79149085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0021422   0.35867098 -2.02854861]
Stock Position:  0.0021421997777472833
Bond Position:  [-1.37810309]


portfolio before change:  [-1.13874668]
curr_Stock_Price:  111.89478143885034
curr_Factors:  [111.89478144  -0.71876221  -0.82266203]
mat_Sqrt:  [[23.95398596  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00590312 -0.05464241  0.05739745]
Stock Position:  0.005903117293116761
Bond Position:  [-1.7992747]


portfolio before change:  [-1.15580615]
curr_Stock_Price:  109.08108303931077
curr_Factors:  [109.08108304  -0.47592287  -0.81442144]
mat_Sqrt:  [[30.0164983   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00091123 -0.01259776 -0.44852983]
Stock Position:  -0.0009112320246764687
Bond Position:  [-1.05640797]


portfolio before change:  [-1.15621224]
curr_Stock_Price:  109.23687023009516
curr_Factors:  [109.23687023  -0.36563353  -0.81736412]
mat_Sqrt:  [[33.46569869  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185333  0.00548153  0.1514202 ]
Stock Position:  -0.0018533333853903025
Bond Position:  [-0.9537599]


portfolio before change:  [-1.14968607]
curr_Stock_Price:  105.58688555748577
curr_Factors:  [105.58688556  -0.57409591  -0.81766307]
mat_Sqrt:  [[26.25286658  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.64642731e-05 -4.57572393e-02 -1.26417554e-01]
Stock Position:  -5.646427313384529e-05
Bond Position:  [-1.14372419]


portfolio before change:  [-1.15025823]
curr_Stock_Price:  110.65532318996748
curr_Factors:  [110.65532319  -0.8561382   -0.80639418]
mat_Sqrt:  [[20.98667671  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01222365 -0.0083213  -0.20235452]
Stock Position:  -0.012223650592485367
Bond Position:  [0.20235378]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.14612767]
Stock Price:  110.3215475457786
PL:  [-11.46767522]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.62995201e-01  2.57760486e-01 -2.43986545e-02]
 [ 4.78821095e-03 -8.90200157e-03 -4.28436486e-02]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-1.82403215e-01 -1.61921780e-01  5.03902589e-01]
 [-3.83787489e-02  1.69986120e-02 -2.08347811e-02]
 [-1.30305025e+00  1.28471061e+00 -1.83584010e-01]
 [-1.03721836e-03  1.56235598e-02 -4.85496346e-03]
 [-4.30869932e-02 -9.35788373e-04 -1.92670801e-02]
 [ 7.34672314e-03  2.83249558e-02  4.75452915e-02]
 [-2.10991433e-01  2.09904143e-01 -9.55328050e-02]
 [ 2.84084835e-02  4.47118449e-02 -5.40980936e-02]
 [-3.54259155e-02  1.23513010e-01  4.32058181e-02]
 [ 1.23402856e-01 -5.33173583e-02 -1.17605752e-01]
 [ 1.91345716e-02  7.85801902e-01 -5.01029803e-01]
 [ 2.57596228e-02 -1.62268620e-01 -5.25287191e-02]
 [ 6.34908494e-02  5.98479445e-02  1.59758685e-01]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 3.74883354e-02 -1.26608396e-01 -4.44468554e-02]
 [-1.53530697e-01  3.75386646e-02 -2.24729824e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.94130668]
curr_Stock_Price:  98.07994035780663
curr_Factors:  [98.07994036 -0.74208889 -1.04746488]
mat_Sqrt:  [[16.38275238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00704158  0.08319184 -0.06960257]
Stock Position:  -0.007041577242854479
Bond Position:  [-12.25066921]


portfolio before change:  [-12.9408891]
curr_Stock_Price:  97.58564310007432
curr_Factors:  [97.5856431  -0.18382495 -1.0611524 ]
mat_Sqrt:  [[28.09953515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0002055  -0.00287311 -0.122221  ]
Stock Position:  -0.00020549541613207426
Bond Position:  [-12.9208357]


portfolio before change:  [-12.94468636]
curr_Stock_Price:  100.34311379353267
curr_Factors:  [100.34311379  -0.72163553  -1.07018451]
mat_Sqrt:  [[16.72283938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00466564  0.01370813 -0.02999186]
Stock Position:  -0.004665639410993626
Bond Position:  [-12.47652157]


portfolio before change:  [-12.94193969]
curr_Stock_Price:  99.08579504894463
curr_Factors:  [99.08579505 -0.92978264 -1.04391009]
mat_Sqrt:  [[13.76726061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00817858 -0.05226003  1.43749383]
Stock Position:  -0.008178582347238329
Bond Position:  [-12.13155835]


portfolio before change:  [-12.94443285]
curr_Stock_Price:  99.01975660070744
curr_Factors:  [99.0197566  -0.73587321 -1.01734018]
mat_Sqrt:  [[17.15184933  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00228324  0.00548628 -0.05943583]
Stock Position:  -0.0022832408855430284
Bond Position:  [-12.7183469]


portfolio before change:  [-12.94631947]
curr_Stock_Price:  98.45329567699538
curr_Factors:  [98.45329568 -0.70692039 -1.02092804]
mat_Sqrt:  [[17.4918289   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.061645    0.41463857 -0.52371408]
Stock Position:  -0.06164499576205227
Bond Position:  [-6.87716648]


portfolio before change:  [-13.02621733]
curr_Stock_Price:  99.72149846195005
curr_Factors:  [99.72149846 -0.68666401 -0.97106415]
mat_Sqrt:  [[19.00406924  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.10875570e-05  5.04248224e-03 -1.38498594e-02]
Stock Position:  6.108755696493714e-05
Bond Position:  [-13.03230908]


portfolio before change:  [-13.02948794]
curr_Stock_Price:  99.52307863993794
curr_Factors:  [99.52307864 -0.66037787 -0.93285196]
mat_Sqrt:  [[20.22985995  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00233372 -0.00030202 -0.05496362]
Stock Position:  -0.0023337228529089465
Bond Position:  [-12.79722865]


portfolio before change:  [-13.02777406]
curr_Stock_Price:  97.41760706410977
curr_Factors:  [97.41760706 -0.39845293 -0.94915005]
mat_Sqrt:  [[25.31517402  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00090198 0.00914184 0.13563348]
Stock Position:  0.0009019757284906229
Bond Position:  [-13.11564238]


portfolio before change:  [-13.02771128]
curr_Stock_Price:  101.12292002840998
curr_Factors:  [101.12292003  -0.57828453  -0.94957873]
mat_Sqrt:  [[21.94355666  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00855128  0.06774627 -0.2725285 ]
Stock Position:  -0.008551279267759181
Bond Position:  [-12.16298095]


portfolio before change:  [-13.03742577]
curr_Stock_Price:  101.90331413816405
curr_Factors:  [101.90331414  -0.63434636  -0.95111625]
mat_Sqrt:  [[20.87520003  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00126909  0.01443069 -0.1543268 ]
Stock Position:  0.0012690907626915738
Bond Position:  [-13.16675032]


portfolio before change:  [-13.03803994]
curr_Stock_Price:  104.01343203633577
curr_Factors:  [104.01343204  -0.9094146   -0.96725372]
mat_Sqrt:  [[15.92438728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.75749432e-05  3.98636525e-02  1.23254173e-01]
Stock Position:  -8.757494322199339e-05
Bond Position:  [-13.02893097]


portfolio before change:  [-13.04133914]
curr_Stock_Price:  104.48798194318232
curr_Factors:  [104.48798194  -0.89508427  -0.9979359 ]
mat_Sqrt:  [[15.73758651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00562433 -0.0172081  -0.33549648]
Stock Position:  0.005624326359417749
Bond Position:  [-13.62901365]


portfolio before change:  [-13.04561889]
curr_Stock_Price:  104.3329271738812
curr_Factors:  [104.33292717  -0.68523957  -1.0080434 ]
mat_Sqrt:  [[19.18836373  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00402658  0.25361647 -1.42929857]
Stock Position:  0.004026577456975961
Bond Position:  [-13.46572351]


portfolio before change:  [-13.05970709]
curr_Stock_Price:  101.67028355939816
curr_Factors:  [101.67028356  -0.7569704   -0.99572564]
mat_Sqrt:  [[17.62007748  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102643 -0.05237197 -0.14984981]
Stock Position:  -0.0010264257086783184
Bond Position:  [-12.95535009]


portfolio before change:  [-13.06188328]
curr_Stock_Price:  100.63460459743263
curr_Factors:  [100.6346046   -0.66428799  -1.0126407 ]
mat_Sqrt:  [[18.81336449  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0057575  0.01931584 0.45574706]
Stock Position:  0.005757495690285915
Bond Position:  [-13.64128658]


portfolio before change:  [-13.05514926]
curr_Stock_Price:  102.39661559143522
curr_Factors:  [102.39661559  -0.68218754  -1.00875883]
mat_Sqrt:  [[18.87630234  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364424  0.00525786  0.16709793]
Stock Position:  -0.0036442421140273004
Bond Position:  [-12.6819912]


portfolio before change:  [-13.05915272]
curr_Stock_Price:  102.62507545978977
curr_Factors:  [102.62507546  -0.62578301  -1.00473604]
mat_Sqrt:  [[20.09685334  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00012797 -0.04086268 -0.12679451]
Stock Position:  0.00012797169043418064
Bond Position:  [-13.07228582]


portfolio before change:  [-13.06221351]
curr_Stock_Price:  104.24799750493021
curr_Factors:  [104.2479975   -0.69598816  -0.9689529 ]
mat_Sqrt:  [[19.72390963  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00762807  0.01211555 -0.06410916]
Stock Position:  -0.007628073260990431
Bond Position:  [-12.26700215]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.06690026]
Stock Price:  104.4603210330886
PL:  [-17.52722129]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.45034140e-01  2.35906745e-01 -1.65274992e-02]
 [ 2.28347086e-02  1.62071727e-02 -9.54629138e-02]
 [ 8.83398985e-02 -5.71172917e-02 -9.73443452e-03]
 [-1.17065274e-01 -7.08417139e-02  3.12719780e-01]
 [ 6.33218804e-02 -1.33140457e-01  8.02879715e-02]
 [-1.34968704e+00  1.23937790e+00 -1.66836429e-01]
 [-2.40822876e-02  6.07657854e-03 -4.88640754e-02]
 [-8.78847323e-03  1.63920412e-02 -2.58117228e-02]
 [ 3.29943643e-02  2.79360803e-02  4.89288906e-02]
 [ 1.54996124e-01  1.22688475e-01  9.24049816e-02]
 [ 2.28781824e-02  1.00497698e-02 -5.15599032e-02]
 [ 5.86724080e-02 -6.69520361e-03 -2.23007231e-02]
 [-8.84589444e-03 -3.43903685e-02  1.19274905e-01]
 [ 3.05502268e-02  3.78028270e-01 -2.23746428e-01]
 [-5.17592009e-02 -2.74616752e-01 -6.33167411e-02]
 [ 6.73552285e-02  5.69179799e-02  2.06900748e-01]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.21885843e-02 -1.43418249e-01 -4.14345584e-02]
 [-1.06678592e-01  1.11758742e-01 -2.55086027e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.20021637]
curr_Stock_Price:  98.29942508231251
curr_Factors:  [98.29942508 -0.8669405  -0.9718448 ]
mat_Sqrt:  [[15.63063666  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00641391  0.07613857 -0.04714835]
Stock Position:  -0.006413912695224073
Bond Position:  [-10.56973244]


portfolio before change:  [-11.20406956]
curr_Stock_Price:  98.48814339360018
curr_Factors:  [98.48814339 -0.53527171 -0.94919939]
mat_Sqrt:  [[22.31959662  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00029824  0.00523084 -0.27232912]
Stock Position:  0.00029824455670023525
Bond Position:  [-11.23344311]


portfolio before change:  [-11.20683532]
curr_Stock_Price:  98.63217176852865
curr_Factors:  [98.63217177 -1.15355244 -0.96325812]
mat_Sqrt:  [[11.87680018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00628905 -0.01843453 -0.02776963]
Stock Position:  0.006289054791854841
Bond Position:  [-11.82713845]


portfolio before change:  [-11.21069372]
curr_Stock_Price:  98.48886773336017
curr_Factors:  [98.48886773 -1.02000572 -0.92510394]
mat_Sqrt:  [[14.08110559  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0048073  -0.02286406  0.89210249]
Stock Position:  -0.004807301566181713
Bond Position:  [-10.73722803]


portfolio before change:  [-11.20974143]
curr_Stock_Price:  97.73232542968398
curr_Factors:  [97.73232543 -0.84724831 -0.90118804]
mat_Sqrt:  [[17.00990838  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0030884  -0.0429709   0.22903923]
Stock Position:  0.0030884006429489834
Bond Position:  [-11.51157801]


portfolio before change:  [-11.2186923]
curr_Stock_Price:  95.7660610192178
curr_Factors:  [95.76606102 -0.3345473  -0.88799119]
mat_Sqrt:  [[28.20135045  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04009579  0.4000075  -0.47593789]
Stock Position:  -0.04009579017056289
Bond Position:  [-7.37887641]


portfolio before change:  [-11.3205203]
curr_Stock_Price:  98.2596658372927
curr_Factors:  [98.25966584 -0.24853841 -0.89789011]
mat_Sqrt:  [[31.2239401   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.001051    0.00196121 -0.13939561]
Stock Position:  -0.001050996406862249
Bond Position:  [-11.21724975]


portfolio before change:  [-11.32393071]
curr_Stock_Price:  98.83601189046578
curr_Factors:  [98.83601189 -0.47864822 -0.94187194]
mat_Sqrt:  [[23.87762598  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00044859  0.00529051 -0.07363366]
Stock Position:  -0.0004485897253911849
Bond Position:  [-11.27959389]


portfolio before change:  [-11.32643612]
curr_Stock_Price:  98.13417841140564
curr_Factors:  [98.13417841 -0.4598817  -0.9208288 ]
mat_Sqrt:  [[24.67091958  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00197335 0.00901633 0.13958051]
Stock Position:  0.001973350065906918
Bond Position:  [-11.52008921]


portfolio before change:  [-11.32967749]
curr_Stock_Price:  97.95124603891504
curr_Factors:  [97.95124604 -0.60433802 -0.94503911]
mat_Sqrt:  [[20.80290702  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00956125 0.03959754 0.26360569]
Stock Position:  0.009561254694282276
Bond Position:  [-12.2662143]


portfolio before change:  [-11.33624272]
curr_Stock_Price:  97.58536464143626
curr_Factors:  [97.58536464 -0.3839844  -0.90869462]
mat_Sqrt:  [[26.79053092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00053769  0.00324355 -0.14708605]
Stock Position:  0.0005376885563633433
Bond Position:  [-11.38871325]


portfolio before change:  [-11.33712763]
curr_Stock_Price:  101.23545980834626
curr_Factors:  [101.23545981  -0.34235427  -0.9441348 ]
mat_Sqrt:  [[27.96517587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0018864  -0.00216087 -0.06361776]
Stock Position:  0.001886404701436026
Bond Position:  [-11.52809868]


portfolio before change:  [-11.34567604]
curr_Stock_Price:  98.23185114034715
curr_Factors:  [98.23185114 -0.13312814 -0.94685183]
mat_Sqrt:  [[33.35976537  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.54231077e-04 -1.10994437e-02  3.40258105e-01]
Stock Position:  0.00025423107729722027
Bond Position:  [-11.37064963]


portfolio before change:  [-11.34840663]
curr_Stock_Price:  98.67408956730462
curr_Factors:  [98.67408957 -0.63123972 -0.92861608]
mat_Sqrt:  [[20.73797568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00299175  0.1220081  -0.63828628]
Stock Position:  0.002991751791202998
Bond Position:  [-11.64361501]


portfolio before change:  [-11.3471687]
curr_Stock_Price:  100.06096912625453
curr_Factors:  [100.06096913  -0.76330284  -0.89026102]
mat_Sqrt:  [[19.14833625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00630549 -0.08863218 -0.18062504]
Stock Position:  -0.006305487059683407
Bond Position:  [-10.71623555]


portfolio before change:  [-11.35185597]
curr_Stock_Price:  100.37940299764273
curr_Factors:  [100.379403    -0.9732782   -0.87831306]
mat_Sqrt:  [[15.75827735  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00769164 0.0183702  0.59023024]
Stock Position:  0.007691640275102796
Bond Position:  [-12.12393823]


portfolio before change:  [-11.33030199]
curr_Stock_Price:  103.57577481894627
curr_Factors:  [103.57577482  -1.33804706  -0.89792277]
mat_Sqrt:  [[11.07105042  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00621349  0.00525786  0.16709793]
Stock Position:  -0.006213485920836615
Bond Position:  [-10.68673537]


portfolio before change:  [-11.3305621]
curr_Stock_Price:  103.1876013610195
curr_Factors:  [103.18760136  -1.12398369  -0.91957658]
mat_Sqrt:  [[13.36966636  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00033327 -0.04628804 -0.11820126]
Stock Position:  0.00033326658390002396
Bond Position:  [-11.36495108]


portfolio before change:  [-11.33374705]
curr_Stock_Price:  102.15732761589751
curr_Factors:  [102.15732762  -1.23257105  -0.89529644]
mat_Sqrt:  [[12.16601679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00693626  0.03606998 -0.00727689]
Stock Position:  -0.006936257587462477
Bond Position:  [-10.62515751]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.34177522]
Stock Price:  102.93174385881055
PL:  [-14.27351908]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-2.00846155e-02  5.38849353e-03  4.23651493e-02]
 [-1.17978063e-02 -6.73870138e-02  1.49508397e-01]
 [ 8.10674195e-02 -6.60319093e-02 -1.69371994e-02]
 [-1.55378712e-03 -7.39162970e-03  7.50788315e-02]
 [ 4.19369292e-02 -1.01570184e-01  5.90245325e-02]
 [-1.05558361e+00  1.02374482e+00 -1.33261591e-01]
 [ 3.83211734e-03  3.40314137e-03  1.65891795e-02]
 [-9.25167652e-02 -1.73502841e-02 -2.62440449e-02]
 [-5.07100980e-03  2.05910667e-02  5.74415622e-02]
 [-3.18701216e-01  2.31263978e-01 -1.55738134e-01]
 [ 1.16808253e-01  3.22019896e-02 -5.26805036e-02]
 [-9.25818064e-02  1.21863164e-01  1.45790468e-01]
 [-1.32497102e-01 -1.11935927e-01 -3.16230809e-02]
 [ 3.59274026e-02  6.99788830e-01 -4.06699632e-01]
 [ 6.99696620e-02 -9.81949533e-02 -4.63761634e-02]
 [ 5.44785244e-02  2.13926359e-02  1.47573522e-01]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 3.87834817e-02 -1.29422256e-01 -4.44182072e-02]
 [-1.11708569e-01  1.11527152e-01 -6.16277035e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.03478929]
curr_Stock_Price:  100.59816006165488
curr_Factors:  [100.59816006  -1.17349193  -0.97879495]
mat_Sqrt:  [[11.69132469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00088416  0.00173913  0.12085598]
Stock Position:  -0.0008841550665319553
Bond Position:  [7.12373367]


portfolio before change:  [7.03861135]
curr_Stock_Price:  98.28985502052416
curr_Factors:  [98.28985502 -1.03608523 -0.96067214]
mat_Sqrt:  [[13.34528912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.72052706e-04 -2.17490652e-02  4.26505843e-01]
Stock Position:  0.0003720527059486344
Bond Position:  [7.00204234]


portfolio before change:  [7.04056696]
curr_Stock_Price:  98.84053390334073
curr_Factors:  [98.8405339  -1.24761858 -0.99947495]
mat_Sqrt:  [[10.44803839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00613813 -0.02131171 -0.04831712]
Stock Position:  0.006138130308877181
Bond Position:  [6.43387088]


portfolio before change:  [7.03793099]
curr_Stock_Price:  98.14901367508281
curr_Factors:  [98.14901368 -1.28045943 -0.99732672]
mat_Sqrt:  [[10.06134362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012188  -0.00238564  0.21417901]
Stock Position:  0.0012188039247885837
Bond Position:  [6.91830659]


portfolio before change:  [7.03980923]
curr_Stock_Price:  98.27081387969022
curr_Factors:  [98.27081388 -0.90302255 -1.0023063 ]
mat_Sqrt:  [[14.62011366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227442 -0.03278164  0.16838056]
Stock Position:  0.0022744238057314865
Bond Position:  [6.81629975]


portfolio before change:  [7.04264892]
curr_Stock_Price:  98.77001849970394
curr_Factors:  [98.7700185  -1.02426954 -0.96769829]
mat_Sqrt:  [[13.47486739  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06484772  0.33041222 -0.38015823]
Stock Position:  -0.06484772381053718
Bond Position:  [13.4476598]


portfolio before change:  [6.94272334]
curr_Stock_Price:  100.36279486068912
curr_Factors:  [100.36279486  -1.14102582  -1.01245777]
mat_Sqrt:  [[11.65002103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00067923 0.00109836 0.04732431]
Stock Position:  0.0006792290532881588
Bond Position:  [6.87455401]


portfolio before change:  [6.94512814]
curr_Stock_Price:  101.37268859806407
curr_Factors:  [101.3726886   -1.32975299  -1.00459411]
mat_Sqrt:  [[ 9.8203485   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01032707 -0.00559978 -0.07486696]
Stock Position:  -0.01032706938745832
Bond Position:  [7.99201093]


portfolio before change:  [6.94334079]
curr_Stock_Price:  101.7392596458462
curr_Factors:  [101.73925965  -1.1775665   -1.03577383]
mat_Sqrt:  [[11.12364406  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00097606 0.00664574 0.16386479]
Stock Position:  0.000976059087087692
Bond Position:  [6.84403726]


portfolio before change:  [6.94480442]
curr_Stock_Price:  101.48559355371053
curr_Factors:  [101.48559355  -1.217576    -0.9930847 ]
mat_Sqrt:  [[11.12568223  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02725986  0.07464013 -0.44427755]
Stock Position:  -0.02725986254198248
Bond Position:  [9.71128775]


portfolio before change:  [6.9472977]
curr_Stock_Price:  101.48320325747466
curr_Factors:  [101.48320326  -1.1773837   -0.96303163]
mat_Sqrt:  [[11.93503235  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00943676  0.01039315 -0.15028281]
Stock Position:  0.009436764831480053
Bond Position:  [5.98962458]


portfolio before change:  [6.9448782]
curr_Stock_Price:  101.06811431965836
curr_Factors:  [101.06811432  -1.44505565  -0.92990406]
mat_Sqrt:  [[ 9.40117776  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00403643  0.03933117  0.41589963]
Stock Position:  -0.004036434425399104
Bond Position:  [7.35283301]


portfolio before change:  [6.94619946]
curr_Stock_Price:  101.19624025661275
curr_Factors:  [101.19624026  -1.346494    -0.8799794 ]
mat_Sqrt:  [[10.91991517  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01481705 -0.03612716 -0.09021185]
Stock Position:  -0.014817053017557702
Bond Position:  [8.44562952]


portfolio before change:  [6.95097188]
curr_Stock_Price:  101.01666700339139
curr_Factors:  [101.016667    -1.66605792  -0.85667923]
mat_Sqrt:  [[ 8.10554481  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01181339  0.22585587 -1.16020085]
Stock Position:  0.011813392812857964
Bond Position:  [5.75762231]


portfolio before change:  [6.96002746]
curr_Stock_Price:  101.66135798844269
curr_Factors:  [101.66135799  -1.68272935  -0.86519709]
mat_Sqrt:  [[ 7.954365    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00508642 -0.03169228 -0.13229829]
Stock Position:  0.005086415614441975
Bond Position:  [6.44293554]


portfolio before change:  [6.9631944]
curr_Stock_Price:  101.9672724262711
curr_Factors:  [101.96727243  -1.25076316  -0.83800096]
mat_Sqrt:  [[12.62763657  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00704555 0.00690444 0.42098618]
Stock Position:  0.007045546215358944
Bond Position:  [6.24477927]


portfolio before change:  [6.9671591]
curr_Stock_Price:  102.30838261882158
curr_Factors:  [102.30838262  -1.08666571  -0.82109766]
mat_Sqrt:  [[15.18378745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00453048  0.00525786  0.16709793]
Stock Position:  -0.004530478061539046
Bond Position:  [7.43066498]


portfolio before change:  [6.96586956]
curr_Stock_Price:  103.00310654285667
curr_Factors:  [103.00310654  -1.05748743  -0.85415818]
mat_Sqrt:  [[15.22766052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00021661 -0.04177085 -0.12671278]
Stock Position:  0.0002166088275447508
Bond Position:  [6.94355818]


portfolio before change:  [6.96761021]
curr_Stock_Price:  103.02406978493921
curr_Factors:  [103.02406978  -1.23859011  -0.82731712]
mat_Sqrt:  [[13.05348851  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00691012  0.03599523 -0.01758067]
Stock Position:  -0.006910118628166558
Bond Position:  [7.67951875]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.96474736]
Stock Price:  103.71623947273943
PL:  [3.24850788]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.06437262e-02 -2.12757825e-03  3.91365956e-02]
 [ 1.56940709e-04 -2.51956341e-02  7.94533793e-03]
 [ 2.40055966e-01  2.45542910e-01  4.17742023e-01]
 [-4.85921147e-02  4.24202569e-02 -3.54181117e-02]
 [-2.97062120e-01 -1.53377595e-01 -3.54537380e-01]
 [-1.47953200e+00  1.19996731e+00 -1.35359804e-01]
 [-5.61847660e-01 -6.26761069e-01 -2.09158702e-01]
 [ 3.27421699e-01 -5.05646180e-01  1.96148160e-01]
 [-6.82464152e-02  2.89011532e-02  5.49228542e-02]
 [ 1.53012344e-01  1.21608525e-01  8.71752105e-02]
 [ 3.38902413e-02  4.85635834e-03 -5.12220056e-02]
 [ 1.03541783e-01 -1.97817430e-02 -3.10156336e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-4.68765198e-02 -6.04594490e-02  1.18519896e-02]
 [ 2.40652896e-02  1.66636470e-01 -3.85038369e-02]
 [ 4.37374798e-02  2.00690912e-02 -3.32462266e-02]
 [ 6.16108126e-02  2.07539667e-02  1.19521697e-01]
 [-1.01371038e-02 -4.20087429e-02  1.70854812e-02]
 [ 6.49440626e-03  4.49081922e-02 -1.36887182e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.25964331]
curr_Stock_Price:  100.50044387608261
curr_Factors:  [100.50044388  -0.79267601  -1.00504292]
mat_Sqrt:  [[16.65054932  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018554 -0.00068667  0.11164581]
Stock Position:  -0.0001855369533844292
Bond Position:  [6.27828985]


portfolio before change:  [6.26162697]
curr_Stock_Price:  98.2696365025713
curr_Factors:  [98.2696365  -0.68391184 -0.96570401]
mat_Sqrt:  [[18.87992612  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00017819 -0.00813186  0.02266584]
Stock Position:  -0.00017819250045293807
Bond Position:  [6.27913788]


portfolio before change:  [6.26381532]
curr_Stock_Price:  94.79943424499344
curr_Factors:  [94.79943424 -0.32412391 -0.99497659]
mat_Sqrt:  [[25.34706508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0148123  0.07924863 1.19170172]
Stock Position:  0.014812304109516295
Bond Position:  [4.85961727]


portfolio before change:  [6.20372759]
curr_Stock_Price:  90.66079492423088
curr_Factors:  [90.66079492 -0.11894854 -0.97604365]
mat_Sqrt:  [[30.32986348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.001555    0.01369108 -0.10103801]
Stock Position:  -0.001554995718214712
Bond Position:  [6.34470474]


portfolio before change:  [6.20842721]
curr_Stock_Price:  88.65870322160434
curr_Factors:  [ 8.86587032e+01 -6.47233091e-02 -9.63263558e-01]
mat_Sqrt:  [[31.71555757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01263543 -0.04950241 -1.01139646]
Stock Position:  -0.012635433857368476
Bond Position:  [7.32866839]


portfolio before change:  [6.19524696]
curr_Stock_Price:  89.84684135423214
curr_Factors:  [89.84684135 -0.23683482 -0.95179907]
mat_Sqrt:  [[27.37068571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04611576  0.38728778 -0.38614384]
Stock Position:  -0.0461157572528863
Bond Position:  [10.33860209]


portfolio before change:  [6.13492489]
curr_Stock_Price:  91.21095315099562
curr_Factors:  [91.21095315 -0.2228809  -0.89148657]
mat_Sqrt:  [[29.92838978  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02447439 -0.20228627 -0.59667156]
Stock Position:  -0.024474389496363925
Bond Position:  [8.36725728]


portfolio before change:  [6.21680672]
curr_Stock_Price:  87.95082039296273
curr_Factors:  [87.95082039 -0.11823942 -0.88141649]
mat_Sqrt:  [[32.36643379  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00816419 -0.1631966   0.5595561 ]
Stock Position:  0.008164188919515711
Bond Position:  [5.49875961]


portfolio before change:  [6.24203937]
curr_Stock_Price:  90.87306906349701
curr_Factors:  [90.87306906 -0.15011762 -0.93054946]
mat_Sqrt:  [[30.83950842  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00165813  0.00932781  0.15667962]
Stock Position:  -0.001658129911390661
Bond Position:  [6.39271873]


portfolio before change:  [6.23605692]
curr_Stock_Price:  95.44498817819195
curr_Factors:  [95.44498818 -0.31565782 -0.92246896]
mat_Sqrt:  [[27.67206067  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00706959 0.03924898 0.24868661]
Stock Position:  0.007069590786622049
Bond Position:  [5.56129991]


portfolio before change:  [6.25455389]
curr_Stock_Price:  97.86471475153193
curr_Factors:  [97.86471475 -0.29847773 -0.93503693]
mat_Sqrt:  [[28.50476878  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00085691  0.00156738 -0.14612212]
Stock Position:  0.0008569055032673691
Bond Position:  [6.17069308]


portfolio before change:  [6.25435846]
curr_Stock_Price:  95.83614007836763
curr_Factors:  [95.83614008 -0.46626765 -0.90542475]
mat_Sqrt:  [[24.31145048  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00383247 -0.00638453 -0.08847897]
Stock Position:  0.0038324661783132336
Bond Position:  [5.8870697]


portfolio before change:  [6.25115814]
curr_Stock_Price:  94.61700967867776
curr_Factors:  [94.61700968 -0.76983517 -0.90099832]
mat_Sqrt:  [[17.79653511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094744 -0.00995959  0.34984664]
Stock Position:  0.0009474385495798477
Bond Position:  [6.16151434]


portfolio before change:  [6.25142489]
curr_Stock_Price:  93.27252276179742
curr_Factors:  [93.27252276 -0.89225637 -0.93681875]
mat_Sqrt:  [[14.97602279  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00379263 -0.0195132   0.03381043]
Stock Position:  -0.0037926275003154998
Bond Position:  [6.60517283]


portfolio before change:  [6.25105027]
curr_Stock_Price:  93.8067495354968
curr_Factors:  [93.80674954 -0.90156524 -0.96143708]
mat_Sqrt:  [[14.5593659   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00344934  0.05378169 -0.10984073]
Stock Position:  0.0034493434768071885
Bond Position:  [5.92747857]


portfolio before change:  [6.25931014]
curr_Stock_Price:  95.77170839184879
curr_Factors:  [95.77170839 -0.94300337 -0.963545  ]
mat_Sqrt:  [[14.23094697  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0028844   0.00647727 -0.09484223]
Stock Position:  0.002884397533260405
Bond Position:  [5.98306646]


portfolio before change:  [6.26649203]
curr_Stock_Price:  97.74298176105471
curr_Factors:  [97.74298176 -1.33391324 -0.98337129]
mat_Sqrt:  [[ 9.63167231  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00936955 0.00669831 0.34096213]
Stock Position:  0.009369552824917119
Bond Position:  [5.350684]


portfolio before change:  [6.26728221]
curr_Stock_Price:  97.68453086081712
curr_Factors:  [97.68453086 -1.16975765 -1.01031892]
mat_Sqrt:  [[11.04156345  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137884 -0.01355826  0.04874012]
Stock Position:  -0.0013788394481059091
Bond Position:  [6.40197349]


portfolio before change:  [6.26948958]
curr_Stock_Price:  97.24453648413682
curr_Factors:  [97.24453648 -1.09261605 -0.96178247]
mat_Sqrt:  [[12.46382296  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098531  0.01449406 -0.39050103]
Stock Position:  -0.0009853097532475502
Bond Position:  [6.36530557]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.27145718]
Stock Price:  96.86285797714498
PL:  [6.27145718]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-2.15247963e-02  7.51004519e-03  4.15448368e-02]
 [ 3.04276604e-02  7.94399364e-02 -1.76946239e-01]
 [ 1.18700988e-01 -1.41681592e-02  1.19101138e-02]
 [ 1.89520934e-02  3.68704577e-02 -5.98456725e-02]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-1.48996902e+00  1.43882679e+00 -2.05402677e-01]
 [-4.29707817e-02  2.81547094e-02 -9.08547574e-02]
 [ 9.67649657e-02 -8.36895080e-02 -2.82913903e-03]
 [-5.76715541e-02  2.95391729e-02  5.48797509e-02]
 [ 1.47716191e-01  1.43838807e-01  9.86854038e-02]
 [-2.26594601e-01 -1.87638256e-01  3.63705954e-02]
 [ 8.37694057e-02 -4.07479422e-02 -4.08122990e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-1.62079794e-01  1.38544536e-02 -1.70943678e-01]
 [ 6.80971448e-02  2.55896990e-01  8.90949224e-02]
 [ 6.33357859e-02  2.04923069e-01 -3.67383219e-01]
 [ 3.95490348e-01 -5.47747665e-01  2.71933345e-01]
 [-3.23977184e-01  1.91400111e-01  5.25094415e-01]
 [ 6.08373627e-01 -6.38441113e-01 -1.04246575e+00]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.90063634]
curr_Stock_Price:  100.20306355538973
curr_Factors:  [100.20306356  -0.82163022  -1.00842843]
mat_Sqrt:  [[16.0729882   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007162   0.00242386  0.11851586]
Stock Position:  -0.0007162022571095096
Bond Position:  [3.972402]


portfolio before change:  [3.90220417]
curr_Stock_Price:  99.40075957418533
curr_Factors:  [99.40075957 -0.81564115 -0.99317025]
mat_Sqrt:  [[16.28669237  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00064619  0.02563913 -0.50477837]
Stock Position:  0.0006461882858321891
Bond Position:  [3.83797257]


portfolio before change:  [3.90214905]
curr_Stock_Price:  97.83041282332212
curr_Factors:  [97.83041282 -0.51758685 -1.02526522]
mat_Sqrt:  [[20.91326036  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00565383 -0.00457275  0.03397624]
Stock Position:  0.0056538322984666205
Bond Position:  [3.3490323]


portfolio before change:  [3.88735633]
curr_Stock_Price:  95.06590200887227
curr_Factors:  [95.06590201 -0.34781896 -1.01710201]
mat_Sqrt:  [[24.27991304  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00058741  0.01189989 -0.17072305]
Stock Position:  0.0005874113841696598
Bond Position:  [3.83151354]


portfolio before change:  [3.88827916]
curr_Stock_Price:  95.006037508673
curr_Factors:  [95.00603751 -0.29320877 -1.00739033]
mat_Sqrt:  [[25.87665842  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00219493 -0.04522423  0.24245377]
Stock Position:  0.002194927227383371
Bond Position:  [3.67974782]


portfolio before change:  [3.8941823]
curr_Stock_Price:  97.27631079549052
curr_Factors:  [97.2763108  -0.16982662 -0.96665572]
mat_Sqrt:  [[31.22044452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03965983  0.46437935 -0.58595666]
Stock Position:  -0.03965982542671802
Bond Position:  [7.7521438]


portfolio before change:  [3.88675164]
curr_Stock_Price:  97.51254321751527
curr_Factors:  [97.51254322 -0.20274614 -0.97162855]
mat_Sqrt:  [[30.13256037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0018508   0.00908689 -0.25918333]
Stock Position:  -0.0018508010834327286
Bond Position:  [4.06722796]


portfolio before change:  [3.89112392]
curr_Stock_Price:  95.69963121641305
curr_Factors:  [95.69963122 -0.20487034 -0.94032504]
mat_Sqrt:  [[30.44796208  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00259802 -0.02701067 -0.00807075]
Stock Position:  0.0025980202084622717
Bond Position:  [3.64249434]


portfolio before change:  [3.88570221]
curr_Stock_Price:  93.26222128341863
curr_Factors:  [93.26222128 -0.0974054  -0.9134025 ]
mat_Sqrt:  [[33.9404395   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00119149  0.00953373  0.15655665]
Stock Position:  -0.0011914876184844856
Bond Position:  [3.99682299]


portfolio before change:  [3.88710902]
curr_Stock_Price:  92.92023061120709
curr_Factors:  [92.92023061 -0.39105375 -0.90348804]
mat_Sqrt:  [[25.46231722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00774561 0.04642378 0.28152199]
Stock Position:  0.007745612317969634
Bond Position:  [3.16738494]


portfolio before change:  [3.88062668]
curr_Stock_Price:  91.9810812379603
curr_Factors:  [91.98108124 -0.36164271 -0.88565886]
mat_Sqrt:  [[26.42422877  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00974378 -0.06055999  0.10375519]
Stock Position:  -0.009743784192213912
Bond Position:  [4.77687048]


portfolio before change:  [3.891021]
curr_Stock_Price:  91.03689445856453
curr_Factors:  [91.03689446 -0.26846782 -0.87526658]
mat_Sqrt:  [[29.00680498  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00231397 -0.01315134 -0.11642613]
Stock Position:  0.0023139739544041486
Bond Position:  [3.680364]


portfolio before change:  [3.88496727]
curr_Stock_Price:  88.0230596195527
curr_Factors:  [88.02305962 -0.19353747 -0.90031661]
mat_Sqrt:  [[29.48096321  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00057193 -0.00995959  0.34984664]
Stock Position:  0.0005719325820274826
Bond Position:  [3.83462401]


portfolio before change:  [3.88504795]
curr_Stock_Price:  86.48774322567799
curr_Factors:  [ 8.64877432e+01 -7.36280118e-02 -9.21821965e-01]
mat_Sqrt:  [[31.96216088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00607423  0.00447151 -0.48765473]
Stock Position:  -0.006074229406737854
Bond Position:  [4.41039434]


portfolio before change:  [3.8772461]
curr_Stock_Price:  87.95370487333756
curr_Factors:  [87.95370487  0.09489465 -0.92532365]
mat_Sqrt:  [[38.33570044  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0036133  0.0825904  0.25416301]
Stock Position:  0.0036132983759634405
Bond Position:  [3.55944312]


portfolio before change:  [3.872594]
curr_Stock_Price:  86.41990769946415
curr_Factors:  [86.4199077   0.14832473 -0.92372525]
mat_Sqrt:  [[39.79803493  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.58171775e-04  6.61386363e-02 -1.04804206e+00]
Stock Position:  0.0007581717746107855
Bond Position:  [3.80707287]


portfolio before change:  [3.87016612]
curr_Stock_Price:  81.96212408618786
curr_Factors:  [ 8.19621241e+01 -6.18827582e-02 -8.99303043e-01]
mat_Sqrt:  [[31.34552262  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.010821   -0.1767848   0.77575014]
Stock Position:  0.010821002737743122
Bond Position:  [2.98325375]


portfolio before change:  [3.87094505]
curr_Stock_Price:  81.96517602827964
curr_Factors:  [ 8.19651760e+01  3.35942579e-02 -9.43143947e-01]
mat_Sqrt:  [[33.00782933  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00538428  0.06177412  1.49794821]
Stock Position:  -0.005384278653366675
Bond Position:  [4.3122684]


portfolio before change:  [3.88350675]
curr_Stock_Price:  79.83239436552282
curr_Factors:  [79.83239437  0.17828375 -0.90831361]
mat_Sqrt:  [[38.47080005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0068951  -0.20605598 -2.97386461]
Stock Position:  0.006895098375895993
Bond Position:  [3.33305453]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.88815415]
Stock Price:  80.38554627322948
PL:  [3.88815415]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-8.32963512e-02  1.60788597e-01  1.05281259e-02]
 [ 1.90545025e-02  4.02842275e-02 -1.19912859e-01]
 [ 8.54741688e-02 -4.92934447e-02 -2.91876929e-02]
 [-1.40463626e-01 -1.02497450e-01  3.72972011e-01]
 [ 4.42736422e-02 -1.05019837e-01  6.13479679e-02]
 [-1.07445915e+00  1.02658098e+00 -1.32106382e-01]
 [-2.72857774e-02  1.29831761e-02 -5.60409065e-02]
 [ 2.58539145e-02  1.27830386e-02 -2.31691257e-02]
 [ 4.59180526e-02  2.62447504e-02  4.13227620e-02]
 [ 1.54899827e-01  1.21663885e-01  9.11650597e-02]
 [ 7.49925532e-04  2.77480347e-02 -5.15628172e-02]
 [ 2.64615190e-02  7.99335400e-02 -1.39144891e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-3.97262642e-02 -3.70027488e-03 -3.72453972e-02]
 [ 6.08716319e-03  9.54101495e-02 -4.40643894e-02]
 [ 6.57968851e-02  1.61237858e-01 -2.32710900e-01]
 [ 2.11482036e-01 -1.66044106e-01  1.89833348e-01]
 [-1.36879714e-01  1.20898340e-01  1.47842044e-01]
 [ 2.40657591e-01 -1.99068517e-01 -4.73892024e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.88242978]
curr_Stock_Price:  99.47404067365052
curr_Factors:  [99.47404067 -0.66525393 -0.97110866]
mat_Sqrt:  [[19.36629376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249539  0.0518943   0.03003381]
Stock Position:  -0.002495390812033956
Bond Position:  [-1.63420318]


portfolio before change:  [-1.88138922]
curr_Stock_Price:  98.89330468680807
curr_Factors:  [98.89330469 -0.71348628 -0.94347799]
mat_Sqrt:  [[18.86064126  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.48477248e-04  1.30016785e-02 -3.42078011e-01]
Stock Position:  0.00014847724778827159
Bond Position:  [-1.89607263]


portfolio before change:  [-1.88185016]
curr_Stock_Price:  98.98181310314817
curr_Factors:  [98.9818131  -0.69454988 -0.96138417]
mat_Sqrt:  [[18.89697921  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00367542 -0.01590939 -0.08326436]
Stock Position:  0.0036754167344535526
Bond Position:  [-2.24564957]


portfolio before change:  [-1.8850984]
curr_Stock_Price:  98.25080540889938
curr_Factors:  [98.25080541 -0.81936746 -0.96298707]
mat_Sqrt:  [[16.5298678   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00515753 -0.03308091  1.06398533]
Stock Position:  -0.005157526869079754
Bond Position:  [-1.37836723]


portfolio before change:  [-1.88090732]
curr_Stock_Price:  97.37136952457428
curr_Factors:  [97.37136952 -0.70692121 -0.98457255]
mat_Sqrt:  [[17.94010045  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00197096 -0.03389501  0.17500868]
Stock Position:  0.0019709565931665153
Bond Position:  [-2.07282206]


portfolio before change:  [-1.87969384]
curr_Stock_Price:  98.25000360931259
curr_Factors:  [98.25000361 -0.96015295 -0.95381154]
mat_Sqrt:  [[14.49133382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06154542  0.33132759 -0.37686274]
Stock Position:  -0.06154542447879041
Bond Position:  [4.16714434]


portfolio before change:  [-1.79801307]
curr_Stock_Price:  96.93977048152006
curr_Factors:  [96.93977048 -0.82394254 -0.92735714]
mat_Sqrt:  [[16.82372647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214429  0.0041903  -0.15986911]
Stock Position:  -0.002144287111773376
Bond Position:  [-1.59014637]


portfolio before change:  [-1.79945984]
curr_Stock_Price:  97.4290614415719
curr_Factors:  [97.42906144 -1.06850937 -0.92551169]
mat_Sqrt:  [[13.26466157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00178926  0.00412571 -0.06609507]
Stock Position:  0.001789255099334276
Bond Position:  [-1.97378528]


portfolio before change:  [-1.80049538]
curr_Stock_Price:  97.12612160477366
curr_Factors:  [97.1261216  -0.74412036 -0.8901505 ]
mat_Sqrt:  [[18.94877905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00315114 0.00847046 0.11788234]
Stock Position:  0.003151137769450578
Bond Position:  [-2.10655317]


portfolio before change:  [-1.79882805]
curr_Stock_Price:  97.82238750388787
curr_Factors:  [97.8223875  -0.53592984 -0.85362692]
mat_Sqrt:  [[24.37594319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00813685 0.03926685 0.26006854]
Stock Position:  0.008136848362021262
Bond Position:  [-2.59479399]


portfolio before change:  [-1.79975979]
curr_Stock_Price:  97.78761254197552
curr_Factors:  [97.78761254 -0.61093813 -0.85544212]
mat_Sqrt:  [[22.56539776  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018219  0.00895564 -0.14709437]
Stock Position:  -0.00018219251632577903
Bond Position:  [-1.78194362]


portfolio before change:  [-1.79983484]
curr_Stock_Price:  95.75406855343805
curr_Factors:  [95.75406855 -0.71310969 -0.83354784]
mat_Sqrt:  [[20.39165175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00195853  0.02579844 -0.03969416]
Stock Position:  0.0019585270379179676
Bond Position:  [-1.98737177]


portfolio before change:  [-1.80443785]
curr_Stock_Price:  93.65753913074884
curr_Factors:  [93.65753913 -0.31291699 -0.82604045]
mat_Sqrt:  [[29.98470719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00056232 -0.00995959  0.34984664]
Stock Position:  0.0005623240974269902
Bond Position:  [-1.85710374]


portfolio before change:  [-1.80464167]
curr_Stock_Price:  94.12081880642248
curr_Factors:  [94.12081881 -0.35276935 -0.83047275]
mat_Sqrt:  [[28.82771225  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166799 -0.00119426 -0.10625075]
Stock Position:  -0.0016679875281038826
Bond Position:  [-1.64764932]


portfolio before change:  [-1.8027878]
curr_Stock_Price:  92.76239042745779
curr_Factors:  [92.76239043 -0.4055362  -0.84564384]
mat_Sqrt:  [[26.54552654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00062414  0.03079349 -0.12570344]
Stock Position:  0.0006241380277903262
Bond Position:  [-1.86068433]


portfolio before change:  [-1.80596693]
curr_Stock_Price:  88.41414636636318
curr_Factors:  [88.41414637 -0.43115097 -0.85341484]
mat_Sqrt:  [[24.47044778  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00209263  0.05203929 -0.66385942]
Stock Position:  0.0020926266686074517
Bond Position:  [-1.99098473]


portfolio before change:  [-1.79917396]
curr_Stock_Price:  91.89817900252828
curr_Factors:  [91.898179   -0.67437537 -0.84690435]
mat_Sqrt:  [[20.07351916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01077728 -0.0535905   0.5415417 ]
Stock Position:  0.010777282906079691
Bond Position:  [-2.78958663]


portfolio before change:  [-1.78820034]
curr_Stock_Price:  92.98111425240424
curr_Factors:  [92.98111425 -0.74027107 -0.82999168]
mat_Sqrt:  [[19.33919085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0042413   0.03901977  0.4217522 ]
Stock Position:  -0.004241300144372886
Bond Position:  [-1.39383953]


portfolio before change:  [-1.7784551]
curr_Stock_Price:  90.60124382834252
curr_Factors:  [90.60124383 -0.58743123 -0.83355441]
mat_Sqrt:  [[21.87801595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00472118 -0.06424909 -1.35188204]
Stock Position:  0.004721182020037087
Bond Position:  [-2.20620006]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.76891]
Stock Price:  92.73984412733992
PL:  [-1.76891]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-7.88670838e-02  1.55399380e-01  1.24691834e-02]
 [ 2.55524191e-02  6.58947763e-02 -7.16646394e-02]
 [ 9.29655324e-03 -1.88814145e-02 -2.20610213e-02]
 [-2.17982448e-01 -2.03411282e-01  8.03932639e-01]
 [-5.02638911e-02  3.45444640e-02 -3.26523903e-02]
 [-1.11322563e+00  1.20299275e+00 -1.76683908e-01]
 [ 1.10869973e-02 -7.83646390e-03  3.34429513e-02]
 [-5.20536686e-02 -1.20539361e-01  1.79408425e-01]
 [ 6.33412959e-02  2.58194101e-02  6.17899438e-02]
 [-2.33731121e-01  2.12974428e-01 -1.09878932e-01]
 [ 1.16479976e-01  3.21960045e-02 -5.26771028e-02]
 [-5.43297552e-02  1.41986754e-01  5.45138103e-02]
 [-1.16724701e-01 -1.05955740e-01 -5.17651093e-02]
 [ 2.85131707e-02  7.78912839e-01 -4.70526566e-01]
 [ 1.24076682e-01 -6.06021256e-02 -2.64530644e-02]
 [ 5.20845852e-02  2.73911627e-02  1.09331199e-01]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 3.66329205e-02 -1.22789589e-01 -4.56791913e-02]
 [-1.52055606e-01  3.86604944e-02 -2.16144265e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.94555677]
curr_Stock_Price:  99.21395947259114
curr_Factors:  [99.21395947 -1.05791926 -0.98851383]
mat_Sqrt:  [[12.81793838  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347958  0.05015493  0.03557111]
Stock Position:  -0.0034795811528071287
Bond Position:  [-3.60033375]


portfolio before change:  [-3.94853882]
curr_Stock_Price:  99.81226597267364
curr_Factors:  [99.81226597 -1.26615805 -0.98679699]
mat_Sqrt:  [[10.48909393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00232381  0.02126745 -0.20443927]
Stock Position:  0.0023238089901011735
Bond Position:  [-4.18048346]


portfolio before change:  [-3.9503609]
curr_Stock_Price:  99.4779759911153
curr_Factors:  [99.47797599 -0.95261994 -1.03164401]
mat_Sqrt:  [[13.67640817  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.86739913e-05 -6.09395032e-03 -6.29339532e-02]
Stock Position:  6.867399126255417e-05
Bond Position:  [-3.95719245]


portfolio before change:  [-3.95122955]
curr_Stock_Price:  101.2366270938949
curr_Factors:  [101.23662709  -1.04151562  -1.0452096 ]
mat_Sqrt:  [[12.56274133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00759401 -0.06565071  2.29339605]
Stock Position:  -0.007594006467571456
Bond Position:  [-3.18243795]


portfolio before change:  [-3.94581613]
curr_Stock_Price:  100.418991458989
curr_Factors:  [100.41899146  -0.90007809  -1.0134178 ]
mat_Sqrt:  [[14.81818954  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00336598  0.01114918 -0.09314818]
Stock Position:  -0.003365976191917317
Bond Position:  [-3.60780819]


portfolio before change:  [-3.95344024]
curr_Stock_Price:  102.4160492680481
curr_Factors:  [102.41604927  -1.02194582  -1.04003456]
mat_Sqrt:  [[13.02750705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.069371    0.38826424 -0.50403001]
Stock Position:  -0.06937100202264078
Bond Position:  [3.15126372]


portfolio before change:  [-3.89590554]
curr_Stock_Price:  101.59803035569995
curr_Factors:  [101.59803036  -0.84955391  -0.99201412]
mat_Sqrt:  [[16.11025648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00101264 -0.00252921  0.09540343]
Stock Position:  0.0010126405940261687
Bond Position:  [-3.99878783]


portfolio before change:  [-3.89567765]
curr_Stock_Price:  102.81041014714242
curr_Factors:  [102.81041015  -0.44434389  -0.97029952]
mat_Sqrt:  [[24.98418943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016025  -0.03890391  0.5118023 ]
Stock Position:  -0.0016024962987446034
Bond Position:  [-3.73092435]


portfolio before change:  [-3.89522735]
curr_Stock_Price:  101.94728637779197
curr_Factors:  [101.94728638  -0.48772741  -0.97780148]
mat_Sqrt:  [[23.545318    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00344971 0.00833318 0.17626951]
Stock Position:  0.00344970836289097
Bond Position:  [-4.24691575]


portfolio before change:  [-3.89883772]
curr_Stock_Price:  101.20852653898723
curr_Factors:  [101.20852654  -1.01353988  -0.93419195]
mat_Sqrt:  [[14.43204639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01473712  0.0687372  -0.31345401]
Stock Position:  -0.01473712289040834
Bond Position:  [-2.40731522]


portfolio before change:  [-3.90687989]
curr_Stock_Price:  101.71339275009282
curr_Factors:  [101.71339275  -1.27215744  -0.94633749]
mat_Sqrt:  [[11.06363997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0101503   0.01039122 -0.15027311]
Stock Position:  0.010150302206015729
Bond Position:  [-4.93930157]


portfolio before change:  [-3.92313315]
curr_Stock_Price:  100.23380380317613
curr_Factors:  [100.2338038   -1.10150198  -0.94854342]
mat_Sqrt:  [[12.90300329  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00110201  0.04582603  0.15551273]
Stock Position:  -0.001102010524199571
Bond Position:  [-3.81267444]


portfolio before change:  [-3.92546208]
curr_Stock_Price:  101.48210224132012
curr_Factors:  [101.48210224  -1.03064273  -0.94402384]
mat_Sqrt:  [[14.08648589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01057179 -0.03419707 -0.14767145]
Stock Position:  -0.010571787469257092
Bond Position:  [-2.85261486]


portfolio before change:  [-3.94513554]
curr_Stock_Price:  103.27557611036947
curr_Factors:  [103.27557611  -1.26363004  -0.96457554]
mat_Sqrt:  [[11.12500553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00822132  0.25139304 -1.34228132]
Stock Position:  0.00822132221141207
Bond Position:  [-4.79419733]


portfolio before change:  [-3.94220732]
curr_Stock_Price:  103.77755404452967
curr_Factors:  [103.77755404  -1.15275735  -0.97824007]
mat_Sqrt:  [[12.32034905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00862854 -0.01955925 -0.07546323]
Stock Position:  0.008628539250442654
Bond Position:  [-4.83765602]


portfolio before change:  [-3.95709857]
curr_Stock_Price:  102.19192191551691
curr_Factors:  [102.19192192  -1.05921695  -0.98683782]
mat_Sqrt:  [[13.20767182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00605655 0.00884046 0.31189148]
Stock Position:  0.006056549672397057
Bond Position:  [-4.57602903]


portfolio before change:  [-3.95579431]
curr_Stock_Price:  102.59618096843055
curr_Factors:  [102.59618097  -0.75347383  -0.98495616]
mat_Sqrt:  [[18.03601721  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00381402  0.00525786  0.16709793]
Stock Position:  -0.003814024745156646
Bond Position:  [-3.56448994]


portfolio before change:  [-3.95727558]
curr_Stock_Price:  102.75088321236453
curr_Factors:  [102.75088321  -0.72946521  -0.93093971]
mat_Sqrt:  [[19.52903895  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.14924998e-04 -3.96301693e-02 -1.30310018e-01]
Stock Position:  0.00011492499796790848
Bond Position:  [-3.96908423]


portfolio before change:  [-3.95808566]
curr_Stock_Price:  104.33730922818923
curr_Factors:  [104.33730923  -0.40821967  -0.92707446]
mat_Sqrt:  [[27.44914103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00541278  0.01247762 -0.06165994]
Stock Position:  -0.00541277747865021
Bond Position:  [-3.39333102]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.9615295]
Stock Price:  104.8168050671656
PL:  [-8.77833457]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-3.55962105e-03 -1.25620504e-02  4.31699769e-02]
 [ 3.21343533e-02  1.68032753e-01 -2.03283425e-01]
 [-6.09683679e-02 -6.74447760e-02 -7.62485638e-02]
 [-1.06965202e-01 -5.29610686e-02  5.28428709e-01]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-6.42868948e-01  6.78074569e-01 -7.12995969e-02]
 [ 1.05522606e-02 -6.20231058e-03  3.04550706e-02]
 [-9.25415187e-02 -1.75361157e-02 -2.58366255e-02]
 [-2.80437622e-02  1.88353966e-02  5.59813820e-02]
 [-3.33961988e-01  2.32469735e-01 -1.66337286e-01]
 [ 1.19777093e-01  3.22561171e-02 -5.27112592e-02]
 [-1.32008187e-01  1.01121784e-01  2.39869300e-01]
 [-1.87718775e-01 -1.24985946e-01  3.30533481e-02]
 [ 3.92850458e-02  4.27806997e-01 -2.53231416e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 6.56248451e-02  5.69908951e-02  1.87428935e-01]
 [-6.28798341e-02  1.71926289e-02  6.78543678e-02]
 [ 3.56229239e-03 -7.82848847e-02  1.30271185e-02]
 [-1.29897382e-02 -5.61639969e-03 -1.17689230e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.47997276]
curr_Stock_Price:  100.65428062540222
curr_Factors:  [100.65428063  -0.91451285  -1.04479397]
mat_Sqrt:  [[14.18783429  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00018947 -0.00405438  0.12315193]
Stock Position:  0.00018947189015864588
Bond Position:  [7.4609016]


portfolio before change:  [7.48189609]
curr_Stock_Price:  100.95975076477977
curr_Factors:  [100.95975076  -1.16825969  -1.03657264]
mat_Sqrt:  [[11.13273201  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00224014  0.05423234 -0.57991103]
Stock Position:  0.002240136560903714
Bond Position:  [7.25573246]


portfolio before change:  [7.48532848]
curr_Stock_Price:  101.6821288640299
curr_Factors:  [101.68212886  -1.20882838  -1.05916428]
mat_Sqrt:  [[10.52611069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00857863 -0.02176771 -0.21751593]
Stock Position:  -0.008578633711174987
Bond Position:  [8.35762222]


portfolio before change:  [7.48672575]
curr_Stock_Price:  101.7628400403326
curr_Factors:  [101.76284004  -1.56667366  -1.06410754]
mat_Sqrt:  [[ 7.32918128  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.35223506e-03 -1.70931114e-02  1.50746002e+00]
Stock Position:  -0.0013522350612901778
Bond Position:  [7.62433303]


portfolio before change:  [7.48893888]
curr_Stock_Price:  101.53595099597642
curr_Factors:  [101.535951    -1.70981813  -1.07265608]
mat_Sqrt:  [[ 6.28357272  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00903903 -0.04522423  0.24245377]
Stock Position:  0.00903902677742353
Bond Position:  [6.5711527]


portfolio before change:  [7.49037079]
curr_Stock_Price:  101.51259772540702
curr_Factors:  [101.51259773  -2.06076922  -1.11234962]
mat_Sqrt:  [[ 4.25061664  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.12210264  0.21884763 -0.2033979 ]
Stock Position:  -0.12210264266490535
Bond Position:  [19.88532723]


portfolio before change:  [7.49535371]
curr_Stock_Price:  101.51250790492524
curr_Factors:  [101.5125079  -1.8624861  -1.1407704]
mat_Sqrt:  [[ 5.03757858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00307744 -0.00200179  0.08687984]
Stock Position:  0.003077437755995229
Bond Position:  [7.18295528]


portfolio before change:  [7.49663888]
curr_Stock_Price:  101.34653011845458
curr_Factors:  [101.34653012  -1.56006884  -1.1237831 ]
mat_Sqrt:  [[ 6.92192351  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01464838 -0.00565976 -0.0737047 ]
Stock Position:  -0.014648376596513751
Bond Position:  [8.98120102]


portfolio before change:  [7.49779788]
curr_Stock_Price:  101.42070791325516
curr_Factors:  [101.42070791  -1.51113134  -1.12641148]
mat_Sqrt:  [[ 7.25531624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176034  0.0060791   0.1596993 ]
Stock Position:  -0.001760343831870958
Bond Position:  [7.6763332]


portfolio before change:  [7.50038132]
curr_Stock_Price:  101.04344208875335
curr_Factors:  [101.04344209  -1.82723064  -1.16186453]
mat_Sqrt:  [[ 5.08581542  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06301109  0.07502928 -0.47451398]
Stock Position:  -0.06301108718902297
Bond Position:  [13.86723846]


portfolio before change:  [7.53555116]
curr_Stock_Price:  100.54031486254503
curr_Factors:  [100.54031486  -1.91143535  -1.13832759]
mat_Sqrt:  [[ 4.76261009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02427276  0.01041062 -0.15037055]
Stock Position:  0.024272762753317672
Bond Position:  [5.09515995]


portfolio before change:  [7.53138717]
curr_Stock_Price:  100.31628020482225
curr_Factors:  [100.3162802   -1.682956    -1.15731086]
mat_Sqrt:  [[ 5.85948161  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01065003  0.03263692  0.68428035]
Stock Position:  -0.01065003324229468
Bond Position:  [8.59975889]


portfolio before change:  [7.53710814]
curr_Stock_Price:  99.98099795473165
curr_Factors:  [99.98099795 -1.28225125 -1.13224049]
mat_Sqrt:  [[ 8.93957821  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02309778 -0.04033904  0.094292  ]
Stock Position:  -0.023097783030049984
Bond Position:  [9.84644754]


portfolio before change:  [7.53757919]
curr_Stock_Price:  100.06719127034424
curr_Factors:  [100.06719127  -1.00142785  -1.15713861]
mat_Sqrt:  [[11.55681625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00648277  0.13807411 -0.72239874]
Stock Position:  0.0064827661403389775
Bond Position:  [6.88886699]


portfolio before change:  [7.53631041]
curr_Stock_Price:  99.60578172875856
curr_Factors:  [99.60578173 -0.84550807 -1.15711488]
mat_Sqrt:  [[13.4448651   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00989174 -0.09296045 -0.18429859]
Stock Position:  -0.0098917376715503
Bond Position:  [8.52158467]


portfolio before change:  [7.5303659]
curr_Stock_Price:  100.42213716139447
curr_Factors:  [100.42213716  -1.13272568  -1.14906116]
mat_Sqrt:  [[10.25326125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01126635 0.01839373 0.53468258]
Stock Position:  0.011266350392606074
Bond Position:  [6.39897491]


portfolio before change:  [7.52152724]
curr_Stock_Price:  99.49560849237274
curr_Factors:  [99.49560849 -0.99779607 -1.16137364]
mat_Sqrt:  [[11.48387406  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00396379  0.0055489   0.19356962]
Stock Position:  -0.003963792041895983
Bond Position:  [7.91590715]


portfolio before change:  [7.52922784]
curr_Stock_Price:  98.05219908899115
curr_Factors:  [98.05219909 -1.02940563 -1.14881964]
mat_Sqrt:  [[11.10365921  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00087884 -0.02526634  0.03716274]
Stock Position:  -0.0008788448190938582
Bond Position:  [7.61540051]


portfolio before change:  [7.53067108]
curr_Stock_Price:  98.57658372813195
curr_Factors:  [98.57658373 -1.11448453 -1.13136738]
mat_Sqrt:  [[10.43308318  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365754 -0.00181269 -0.33573462]
Stock Position:  -0.003657537649640969
Bond Position:  [7.89121865]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.53848431]
Stock Price:  96.97983165593021
PL:  [7.53848431]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.32913778e-02  3.34053587e-02  3.74537704e-02]
 [ 4.12457565e-02  1.78270137e-01 -2.78977722e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-2.82333384e-01 -2.88390016e-01  1.03704436e+00]
 [-5.14343641e-02  3.62724151e-02 -3.38162124e-02]
 [-1.29853546e+00  1.37383925e+00 -2.02655399e-01]
 [-1.11101293e-03 -2.72352594e-02  2.31577789e-03]
 [-6.35610882e-02 -9.10490556e-02  1.20613761e-01]
 [ 1.90281464e-02 -4.27873987e-03  1.59901004e-02]
 [-8.73498969e-01  3.61194743e-01 -4.43221333e-01]
 [ 4.77016684e-02  4.82269988e-02 -5.48206638e-02]
 [ 2.59212988e-02  8.06323985e-02 -1.37946350e-02]
 [-1.74516511e-02 -5.15465770e-02 -1.00436700e-02]
 [ 2.72472380e-02  7.73398351e-01 -4.71857961e-01]
 [ 1.27471966e-01 -6.08604417e-02 -2.32940545e-02]
 [ 3.01257907e-02 -8.19049487e-03 -3.76176256e-02]
 [-8.62868805e-02  1.59172701e-02  5.74630422e-02]
 [ 3.79922439e-02 -1.21934960e-01 -4.32563784e-02]
 [-9.53945789e-02  1.48067894e-02 -5.30407010e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.6205512]
curr_Stock_Price:  100.04169390545947
curr_Factors:  [100.04169391  -1.03501512  -1.02005033]
mat_Sqrt:  [[12.81378557  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224971  0.01078153  0.10684518]
Stock Position:  -0.002249711340675576
Bond Position:  [2.84561613]


portfolio before change:  [2.62019467]
curr_Stock_Price:  100.51643005342902
curr_Factors:  [100.51643005  -0.76857002  -1.01378476]
mat_Sqrt:  [[16.91103574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012234   0.05753644 -0.79584579]
Stock Position:  0.0012233967909799845
Bond Position:  [2.4972232]


portfolio before change:  [2.62204264]
curr_Stock_Price:  101.51657747270617
curr_Factors:  [101.51657747  -0.53045854  -1.02442619]
mat_Sqrt:  [[21.44169474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00363883  0.01370813 -0.02999186]
Stock Position:  -0.003638832631991809
Bond Position:  [2.99144447]


portfolio before change:  [2.62218707]
curr_Stock_Price:  101.68243272881075
curr_Factors:  [101.68243273  -0.8062462   -0.9763803 ]
mat_Sqrt:  [[17.10255811  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00757284 -0.09307748  2.9583989 ]
Stock Position:  -0.0075728411556183995
Bond Position:  [3.39221198]


portfolio before change:  [2.63145981]
curr_Stock_Price:  100.56996045873278
curr_Factors:  [100.56996046  -0.4600472   -0.94704183]
mat_Sqrt:  [[24.62505905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00206834  0.01170687 -0.09646824]
Stock Position:  -0.0020683399655216234
Bond Position:  [2.83947267]


portfolio before change:  [2.62939597]
curr_Stock_Price:  101.91103261480144
curr_Factors:  [101.91103261  -0.46861143  -0.9957721 ]
mat_Sqrt:  [[23.56391866  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04496148  0.44340471 -0.57811944]
Stock Position:  -0.044961475692810615
Bond Position:  [7.21146639]


portfolio before change:  [2.76737862]
curr_Stock_Price:  98.88222720247427
curr_Factors:  [98.8822272  -0.41550493 -0.97548926]
mat_Sqrt:  [[24.60464691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00025189 -0.00879014  0.00660627]
Stock Position:  -0.00025189066183050235
Bond Position:  [2.79228613]


portfolio before change:  [2.7671823]
curr_Stock_Price:  102.43328798702066
curr_Factors:  [102.43328799  -0.57721551  -0.9854843 ]
mat_Sqrt:  [[21.46689391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267976 -0.02938596  0.34407749]
Stock Position:  -0.0026797643927785214
Bond Position:  [3.04167938]


portfolio before change:  [2.76348017]
curr_Stock_Price:  104.09860257905471
curr_Factors:  [104.09860258  -0.68597931  -0.97519014]
mat_Sqrt:  [[19.7700686   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00108339 -0.00138096  0.04561531]
Stock Position:  0.001083391173889109
Bond Position:  [2.65070066]


portfolio before change:  [2.7647837]
curr_Stock_Price:  104.69006008817676
curr_Factors:  [104.69006009  -0.48352636  -1.00329906]
mat_Sqrt:  [[23.66929783  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0376117   0.1165751  -1.26438709]
Stock Position:  -0.03761170200576917
Bond Position:  [6.70235505]


portfolio before change:  [2.83766274]
curr_Stock_Price:  102.79694624312891
curr_Factors:  [102.79694624  -0.64910162  -0.97020575]
mat_Sqrt:  [[20.35747726  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227709  0.0155652  -0.15638809]
Stock Position:  0.002277086772805153
Bond Position:  [2.60358517]


portfolio before change:  [2.83649683]
curr_Stock_Price:  101.99904905656481
curr_Factors:  [101.99904906  -0.71806062  -0.96581454]
mat_Sqrt:  [[18.93644423  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00208933  0.02602399 -0.03935225]
Stock Position:  0.0020893310122003894
Bond Position:  [2.62338706]


portfolio before change:  [2.83573198]
curr_Stock_Price:  101.3190334462991
curr_Factors:  [101.31903345  -0.45602765  -0.97385626]
mat_Sqrt:  [[24.24936344  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00123812 -0.01663659 -0.02865179]
Stock Position:  -0.0012381235378478093
Bond Position:  [2.96117746]


portfolio before change:  [2.8335717]
curr_Stock_Price:  103.66183240341152
curr_Factors:  [103.6618324   -1.10799735  -1.01479429]
mat_Sqrt:  [[12.40801137  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00715658  0.24961324 -1.34607942]
Stock Position:  0.007156578911071762
Bond Position:  [2.09170761]


portfolio before change:  [2.83555129]
curr_Stock_Price:  103.86536519456673
curr_Factors:  [103.86536519  -1.17137071  -1.02077686]
mat_Sqrt:  [[11.59933679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00950865 -0.01964262 -0.06645145]
Stock Position:  0.00950864718666844
Bond Position:  [1.84793217]


portfolio before change:  [2.83611841]
curr_Stock_Price:  103.87641680447459
curr_Factors:  [103.8764168   -0.70887208  -1.041499  ]
mat_Sqrt:  [[18.04431744  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115135 -0.00264347 -0.10731262]
Stock Position:  0.0011513456966879328
Bond Position:  [2.71652075]


portfolio before change:  [2.83644931]
curr_Stock_Price:  103.57388829219757
curr_Factors:  [103.57388829  -0.3137678   -1.0725717 ]
mat_Sqrt:  [[25.89230328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00275403  0.00513728  0.16392606]
Stock Position:  -0.0027540302694923045
Bond Position:  [3.12169494]


portfolio before change:  [2.84075911]
curr_Stock_Price:  102.29239243345674
curr_Factors:  [102.29239243  -0.27819606  -1.06612637]
mat_Sqrt:  [[26.6692942   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00016021 -0.03935434 -0.12339841]
Stock Position:  0.00016021058236413927
Bond Position:  [2.82437079]


portfolio before change:  [2.84149793]
curr_Stock_Price:  102.49608302547004
curr_Factors:  [102.49608303  -0.19913116  -1.07797244]
mat_Sqrt:  [[28.58039474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361083  0.00477887 -0.15131036]
Stock Position:  -0.0036108333840822655
Bond Position:  [3.21159421]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.84183938]
Stock Price:  102.62390521906624
PL:  [0.21793416]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 1.14469647e-02 -2.47869536e-02  3.84122449e-02]
 [ 6.85956786e-03  1.07533160e-01 -1.19602339e-01]
 [-3.46270022e-03 -1.02980461e-01 -1.99834333e-01]
 [-3.03701348e-01 -3.14060553e-01  1.13573688e+00]
 [-2.07601681e-03 -3.65945509e-02  1.52616740e-02]
 [-1.09074869e+00  1.20723229e+00 -1.78872426e-01]
 [ 7.51923319e-03 -1.06706383e-02  2.10361989e-02]
 [-4.62842436e-02 -1.32465263e-01  2.02761407e-01]
 [ 3.15509098e-02 -2.44386925e-02 -1.64212955e-02]
 [-1.08865446e+00  4.07256408e-01 -5.59626864e-01]
 [ 1.76796112e-01  6.71404674e-02 -5.88942685e-02]
 [-1.79871231e-01  4.27904903e-02  2.21760312e-01]
 [ 3.43247783e-01  8.41621919e-02 -1.88392025e-01]
 [ 3.09609830e-02  1.05998032e+00 -6.15915774e-01]
 [ 1.64061347e-01 -1.12472305e-01  1.17342491e-02]
 [ 1.27097118e-02 -3.90327379e-02 -1.57228740e-01]
 [-7.48836670e-02  1.71465842e-02  5.25734297e-02]
 [ 4.30467863e-02 -1.99754311e-01 -3.55734809e-02]
 [-1.43278119e-01 -4.41009599e-02 -1.29219699e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.81172012]
curr_Stock_Price:  101.07428620978378
curr_Factors:  [101.07428621  -0.83665093  -1.02537238]
mat_Sqrt:  [[15.70269652  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0009061  -0.00799995  0.10957944]
Stock Position:  0.0009061001507860092
Bond Position:  [10.7201367]


portfolio before change:  [10.81732814]
curr_Stock_Price:  104.30533311688416
curr_Factors:  [104.30533312  -1.10633128  -1.03685192]
mat_Sqrt:  [[12.23302546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00035935  0.03470618 -0.34119218]
Stock Position:  0.00035935158261095085
Bond Position:  [10.77984586]


portfolio before change:  [10.81963455]
curr_Stock_Price:  103.22311703054538
curr_Factors:  [103.22311703  -1.05199141  -1.0457001 ]
mat_Sqrt:  [[12.66954805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00515208 -0.0332368  -0.57007173]
Stock Position:  -0.005152078901500457
Bond Position:  [11.35144819]


portfolio before change:  [10.82838818]
curr_Stock_Price:  102.07495564208787
curr_Factors:  [102.07495564  -0.7461255   -1.03472529]
mat_Sqrt:  [[17.19909248  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00790608 -0.10136261  3.2399412 ]
Stock Position:  -0.007906078170449573
Bond Position:  [11.63540076]


portfolio before change:  [10.83123659]
curr_Stock_Price:  102.08264706386326
curr_Factors:  [102.08264706  -0.91833303  -1.06792092]
mat_Sqrt:  [[14.00660223  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045911 -0.01181084  0.04353731]
Stock Position:  -0.00045911006567688053
Bond Position:  [10.87810376]


portfolio before change:  [10.83344712]
curr_Stock_Price:  103.19203980950019
curr_Factors:  [103.19203981  -1.14013223  -1.04989636]
mat_Sqrt:  [[11.54858746  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07627215  0.38963255 -0.51027324]
Stock Position:  -0.07627215089856791
Bond Position:  [18.70412595]


portfolio before change:  [10.7862931]
curr_Stock_Price:  103.87158837230758
curr_Factors:  [103.87158837  -0.96807028  -1.03892538]
mat_Sqrt:  [[13.95949266  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00069022 -0.00344393  0.06001042]
Stock Position:  0.000690218090863167
Bond Position:  [10.71459905]


portfolio before change:  [10.78895351]
curr_Stock_Price:  103.8446665031138
curr_Factors:  [103.8446665   -0.76659378  -1.03262418]
mat_Sqrt:  [[17.17883728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185898 -0.04275298  0.57842186]
Stock Position:  -0.0018589793166660334
Bond Position:  [10.98199859]


portfolio before change:  [10.78937317]
curr_Stock_Price:  105.09598912768581
curr_Factors:  [105.09598913  -0.52425988  -1.05127765]
mat_Sqrt:  [[21.74397238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00106744 -0.00788755 -0.04684539]
Stock Position:  0.0010674406364558776
Bond Position:  [10.67718944]


portfolio before change:  [10.79259483]
curr_Stock_Price:  105.61314829936633
curr_Factors:  [105.6131483   -1.09832599  -1.06515381]
mat_Sqrt:  [[12.13753931  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09225568  0.13144144 -1.59645967]
Stock Position:  -0.09225568037315604
Bond Position:  [20.53600769]


portfolio before change:  [10.66437355]
curr_Stock_Price:  107.05865199075555
curr_Factors:  [107.05865199  -0.8470373   -1.06825311]
mat_Sqrt:  [[15.76963769  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01131791  0.02166949 -0.16800895]
Stock Position:  0.01131791125062586
Bond Position:  [9.45269323]


portfolio before change:  [10.6929193]
curr_Stock_Price:  109.37200077341089
curr_Factors:  [109.37200077  -1.12109614  -1.05468495]
mat_Sqrt:  [[12.41584943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01013785  0.01381057  0.63262044]
Stock Position:  -0.010137850481208308
Bond Position:  [11.80171629]


portfolio before change:  [10.69793901]
curr_Stock_Price:  109.16792215731017
curr_Factors:  [109.16792216  -1.07909307  -1.05531894]
mat_Sqrt:  [[12.91610859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02492794  0.02716323 -0.53743001]
Stock Position:  0.024927938253877277
Bond Position:  [7.97660779]


portfolio before change:  [10.64847429]
curr_Stock_Price:  107.1036067588772
curr_Factors:  [107.10360676  -1.13174077  -1.05388649]
mat_Sqrt:  [[12.03921693  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01010076  0.34210718 -1.75703627]
Stock Position:  0.01010076309809107
Bond Position:  [9.56664613]


portfolio before change:  [10.6594757]
curr_Stock_Price:  107.95596355080939
curr_Factors:  [107.95596355  -1.105489    -1.11117605]
mat_Sqrt:  [[11.76416862  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01219791 -0.03630028  0.03347455]
Stock Position:  0.01219791060146601
Bond Position:  [9.34263851]


portfolio before change:  [10.66796237]
curr_Stock_Price:  108.46020714439521
curr_Factors:  [108.46020714  -1.31134895  -1.13262087]
mat_Sqrt:  [[ 9.41602975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00290483 -0.01259776 -0.44852983]
Stock Position:  -0.002904833062065829
Bond Position:  [10.98302117]


portfolio before change:  [10.67171692]
curr_Stock_Price:  108.11304605229334
curr_Factors:  [108.11304605  -0.634314    -1.12897027]
mat_Sqrt:  [[18.53930602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00327154  0.00553404  0.14997736]
Stock Position:  -0.0032715425641538054
Bond Position:  [11.02541335]


portfolio before change:  [10.67668791]
curr_Stock_Price:  107.43621191966706
curr_Factors:  [107.43621192  -0.18342006  -1.14573308]
mat_Sqrt:  [[28.43850813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00017544 -0.06447043 -0.10148124]
Stock Position:  -0.00017544162348620242
Bond Position:  [10.69553669]


portfolio before change:  [10.67912452]
curr_Stock_Price:  108.79053666585517
curr_Factors:  [ 1.08790537e+02 -8.85743804e-02 -1.18166855e+00]
mat_Sqrt:  [[30.54440176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00584909 -0.01423352 -0.36862783]
Stock Position:  -0.00584909311113421
Bond Position:  [11.3154505]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.6875558]
Stock Price:  107.83277046364755
PL:  [2.85478534]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-8.19989141e-03 -8.22789483e-03  4.38951549e-02]
 [ 4.02950185e-02  1.38411797e-01 -2.64569700e-01]
 [-6.87792261e-02 -3.68460666e-02 -6.00770846e-02]
 [-3.47839863e-01 -3.71512108e-01  1.28389402e+00]
 [-7.73419427e-03 -2.82414709e-02  9.63564709e-03]
 [-1.41192796e+00  1.53601280e+00 -2.32277260e-01]
 [ 9.73453846e-03 -3.70335487e-03  2.58859879e-02]
 [-2.00463795e-02 -2.02117709e-01  3.41984465e-01]
 [ 9.46449497e-03  2.24652823e-02  5.58323221e-02]
 [-4.92391497e-01  2.77877051e-01 -2.38994749e-01]
 [ 1.08099454e-01  6.25207126e-02 -6.05559091e-02]
 [-2.62936992e-02  7.40340433e-02 -6.31976886e-03]
 [ 2.43929620e-02 -7.24388535e-02 -5.69974802e-02]
 [ 2.71499060e-02  7.86046387e-01 -4.78831161e-01]
 [ 1.16419765e-01 -6.00195808e-02 -3.35771447e-02]
 [ 1.86307564e-02 -2.92843980e-02 -7.91276929e-02]
 [-8.07962029e-02  1.64791078e-02  5.46486636e-02]
 [ 4.34213086e-02 -2.05127903e-01 -3.48743653e-02]
 [-1.66760003e-01  2.74775686e-02 -3.01729141e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.48706017]
curr_Stock_Price:  100.52911242248959
curr_Factors:  [100.52911242  -0.9164721   -1.03792118]
mat_Sqrt:  [[14.23998829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.45606171e-05 -2.65554164e-03  1.25220659e-01]
Stock Position:  -6.456061706229523e-05
Bond Position:  [6.49355039]


portfolio before change:  [6.48871559]
curr_Stock_Price:  100.0360933993149
curr_Factors:  [100.0360934   -0.81857598  -1.00941184]
mat_Sqrt:  [[16.07946896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090445  0.04467222 -0.75474371]
Stock Position:  0.0009044542797192361
Bond Position:  [6.39823752]


portfolio before change:  [6.49224707]
curr_Stock_Price:  102.17187574545335
curr_Factors:  [102.17187575  -0.55519342  -1.04106655]
mat_Sqrt:  [[20.70544015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00427731 -0.01189202 -0.1713832 ]
Stock Position:  -0.004277309769884828
Bond Position:  [6.92926783]


portfolio before change:  [6.4935277]
curr_Stock_Price:  102.27752617175844
curr_Factors:  [102.27752617  -0.57241993  -1.05821794]
mat_Sqrt:  [[20.02641366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00806938 -0.11990502  3.66259228]
Stock Position:  -0.008069377108720903
Bond Position:  [7.31884363]


portfolio before change:  [6.49829352]
curr_Stock_Price:  101.91369655655559
curr_Factors:  [101.91369656  -0.84964998  -1.05949205]
mat_Sqrt:  [[15.10437321  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00076349 -0.0091149   0.02748782]
Stock Position:  -0.000763493591392632
Bond Position:  [6.57610398]


portfolio before change:  [6.49916848]
curr_Stock_Price:  102.92126636907209
curr_Factors:  [102.92126637  -0.44051312  -1.05957001]
mat_Sqrt:  [[22.96292966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04989799  0.495746   -0.66262237]
Stock Position:  -0.0498979909004114
Bond Position:  [11.63473289]


portfolio before change:  [6.49037685]
curr_Stock_Price:  103.15575827167362
curr_Factors:  [103.15575827  -0.17484306  -1.07007245]
mat_Sqrt:  [[29.70527216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00048014 -0.00119525  0.07384552]
Stock Position:  0.00048013529035197025
Bond Position:  [6.44084813]


portfolio before change:  [6.49240035]
curr_Stock_Price:  104.01610307219323
curr_Factors:  [ 1.04016103e+02 -2.34935060e-02 -1.07090664e+00]
mat_Sqrt:  [[34.81838593  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.44233103e-04 -6.52332101e-02  9.75586487e-01]
Stock Position:  0.0002442331029285334
Bond Position:  [6.46699617]


portfolio before change:  [6.49342472]
curr_Stock_Price:  101.5898115896112
curr_Factors:  [101.58981159   0.41662018  -1.07279555]
mat_Sqrt:  [[52.70803331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00048279 0.00725064 0.15927407]
Stock Position:  0.0004827902871401369
Bond Position:  [6.44437814]


portfolio before change:  [6.49557815]
curr_Stock_Price:  102.71273730766747
curr_Factors:  [102.71273731   0.16357138  -1.08669539]
mat_Sqrt:  [[40.80530613  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01187235  0.08968443 -0.6817855 ]
Stock Position:  -0.011872345203905258
Bond Position:  [7.71501923]


portfolio before change:  [6.45910893]
curr_Stock_Price:  105.94699410805524
curr_Factors:  [105.94699411  -0.20194883  -1.05258474]
mat_Sqrt:  [[30.21702001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00359071  0.02017847 -0.17274915]
Stock Position:  0.0035907087392287487
Bond Position:  [6.07868414]


portfolio before change:  [6.45407405]
curr_Stock_Price:  104.12152015095222
curr_Factors:  [104.12152015  -0.56252912  -1.05102728]
mat_Sqrt:  [[20.73871569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060137  0.02389438 -0.01802854]
Stock Position:  -0.0006013670757281861
Bond Position:  [6.5166893]


portfolio before change:  [6.45614242]
curr_Stock_Price:  103.39152163969867
curr_Factors:  [103.39152164  -0.82432413  -1.06183559]
mat_Sqrt:  [[15.67964288  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.29347269e-04 -2.33795394e-02 -1.62597946e-01]
Stock Position:  -0.00012934726854313384
Bond Position:  [6.46951583]


portfolio before change:  [6.45770997]
curr_Stock_Price:  103.77836034028942
curr_Factors:  [103.77836034  -1.10858965  -1.00907597]
mat_Sqrt:  [[12.48579815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00719697  0.25369538 -1.36597202]
Stock Position:  0.007196972919623821
Bond Position:  [5.71081992]


portfolio before change:  [6.45940118]
curr_Stock_Price:  103.8149488483805
curr_Factors:  [103.81494885  -0.8158145   -1.05773394]
mat_Sqrt:  [[15.94366445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00610364 -0.01937124 -0.09578625]
Stock Position:  0.006103641560610423
Bond Position:  [5.82575194]


portfolio before change:  [6.47128144]
curr_Stock_Price:  105.52272371808508
curr_Factors:  [105.52272372  -0.77261925  -1.08206113]
mat_Sqrt:  [[16.51461818  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.11858908e-04 -9.45149880e-03 -2.25729283e-01]
Stock Position:  -0.00021185890806370012
Bond Position:  [6.49363737]


portfolio before change:  [6.47267739]
curr_Stock_Price:  106.59735370046599
curr_Factors:  [106.5973537   -0.68261476  -1.07923161]
mat_Sqrt:  [[18.3056968   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00362058  0.00531861  0.15589743]
Stock Position:  -0.0036205836948367577
Bond Position:  [6.85862203]


portfolio before change:  [6.47198919]
curr_Stock_Price:  107.2610757882434
curr_Factors:  [107.26107579  -0.59586376  -1.06677043]
mat_Sqrt:  [[20.34085914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027378 -0.06620475 -0.09948686]
Stock Position:  -0.00027378142298911906
Bond Position:  [6.50135528]


portfolio before change:  [6.47404911]
curr_Stock_Price:  105.6745129643516
curr_Factors:  [105.67451296  -0.55045823  -1.05536691]
mat_Sqrt:  [[21.21139616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00788775  0.00886835 -0.08607493]
Stock Position:  -0.007887749897871782
Bond Position:  [7.30758324]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.48000832]
Stock Price:  105.15065173370711
PL:  [1.32935658]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-8.85601202e-02  1.67193177e-01  8.22136113e-03]
 [ 1.96689351e-02  4.68500605e-02  2.82845183e-04]
 [-6.31648737e-02  1.51167029e-02 -3.50810581e-03]
 [-1.16225493e-01 -7.23452667e-02  4.29129208e-01]
 [-4.49836062e-03 -3.30184821e-02  1.28530943e-02]
 [-9.72912985e-01  1.00930322e+00 -1.38820379e-01]
 [ 1.11698000e-02 -8.99722924e-03  3.58722595e-02]
 [-8.63930971e-02 -4.00006974e-02  1.99446366e-02]
 [ 8.15373116e-02  2.72100227e-02  6.29465080e-02]
 [ 5.18838757e-02  1.51586633e-01  4.43725303e-02]
 [ 4.76580359e-02  3.66485288e-02 -5.53209170e-02]
 [ 1.19257283e-01 -4.01121813e-02 -3.45022984e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [ 6.10173979e-03  1.51445570e-01 -1.40045192e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 4.62672385e-02  5.24353002e-02 -7.97261995e-02]
 [ 7.54299381e-02 -6.28475465e-02  1.26819896e-01]
 [-1.17729760e-01  1.17670196e-01  1.15998256e-01]
 [ 1.35047003e-01 -1.69959048e-01 -3.43129297e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.77780169]
curr_Stock_Price:  99.10904530145277
curr_Factors:  [99.1090453  -0.97985108 -1.01752017]
mat_Sqrt:  [[13.44825643  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00392272  0.05396137  0.02345325]
Stock Position:  -0.0039227224606304305
Bond Position:  [-4.38902441]


portfolio before change:  [-4.78188297]
curr_Stock_Price:  99.8697128745495
curr_Factors:  [99.86971287 -1.45855924 -0.99076789]
mat_Sqrt:  [[ 8.62391645  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00339636 0.01512079 0.00080688]
Stock Position:  0.0033963570221540577
Bond Position:  [-5.12107617]


portfolio before change:  [-4.78301718]
curr_Stock_Price:  99.91276576449005
curr_Factors:  [99.91276576 -1.45495278 -0.97955084]
mat_Sqrt:  [[ 8.7564786   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00694289  0.00487889 -0.01000765]
Stock Position:  -0.006942891254948725
Bond Position:  [-4.08933371]


portfolio before change:  [-4.78759183]
curr_Stock_Price:  100.42439528539592
curr_Factors:  [100.42439529  -1.41107379  -0.99800607]
mat_Sqrt:  [[ 9.02794975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00480699 -0.02334933  1.22418618]
Stock Position:  -0.00480699136029489
Bond Position:  [-4.30485263]


portfolio before change:  [-4.79306176]
curr_Stock_Price:  101.33839349772468
curr_Factors:  [101.3383935   -1.21835519  -0.98983404]
mat_Sqrt:  [[11.13703577  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00077351 -0.01065667  0.0366663 ]
Stock Position:  -0.0007735095188088895
Bond Position:  [-4.71467554]


portfolio before change:  [-4.79405614]
curr_Stock_Price:  101.0999570519475
curr_Factors:  [101.09995705  -1.21570827  -0.98757297]
mat_Sqrt:  [[11.16549774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07122176  0.32575121 -0.3960159 ]
Stock Position:  -0.0712217617372859
Bond Position:  [2.40646091]


portfolio before change:  [-4.77950262]
curr_Stock_Price:  100.90406425677195
curr_Factors:  [100.90406426  -0.9751348   -0.99577877]
mat_Sqrt:  [[14.05891393  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011847  -0.00290384  0.10233357]
Stock Position:  0.0011847033595575448
Bond Position:  [-4.899044]


portfolio before change:  [-4.78112052]
curr_Stock_Price:  100.57234352995195
curr_Factors:  [100.57234353  -0.64708873  -1.008807  ]
mat_Sqrt:  [[19.20136905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00471253 -0.01291017  0.0568965 ]
Stock Position:  -0.004712529774243333
Bond Position:  [-4.30717036]


portfolio before change:  [-4.78632039]
curr_Stock_Price:  101.44723330484983
curr_Factors:  [101.4472333   -0.57122303  -1.01859056]
mat_Sqrt:  [[20.69154582  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00483001 0.008782   0.17956887]
Stock Position:  0.004830013050476524
Bond Position:  [-5.27631186]


portfolio before change:  [-4.79678481]
curr_Stock_Price:  99.55382786504975
curr_Factors:  [99.55382787 -0.47356683 -1.0269878 ]
mat_Sqrt:  [[22.20114491  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0041387  0.04892438 0.12658248]
Stock Position:  0.004138699727389081
Bond Position:  [-5.20880821]


portfolio before change:  [-4.79206038]
curr_Stock_Price:  101.0100338591011
curr_Factors:  [101.01003386  -0.42728525  -0.99379676]
mat_Sqrt:  [[24.3891375   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00179779  0.01182826 -0.15781518]
Stock Position:  0.0017977901297857807
Bond Position:  [-4.97365522]


portfolio before change:  [-4.79877931]
curr_Stock_Price:  97.964424615786
curr_Factors:  [97.96442462 -0.18908927 -1.03888023]
mat_Sqrt:  [[28.69247516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00362557 -0.01294615 -0.09842545]
Stock Position:  0.0036255730996377004
Bond Position:  [-5.15395649]


portfolio before change:  [-4.80524523]
curr_Stock_Price:  96.53643805230777
curr_Factors:  [96.53643805 -0.11245895 -1.04167226]
mat_Sqrt:  [[30.4409677   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0005539  -0.00995959  0.34984664]
Stock Position:  0.0005538957753657991
Bond Position:  [-4.85871636]


portfolio before change:  [-4.80587]
curr_Stock_Price:  97.60173678162943
curr_Factors:  [ 9.76017368e+01  5.85115629e-02 -1.04211366e+00]
mat_Sqrt:  [[36.49930407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.30931311e-04  4.88788474e-02 -3.99509952e-01]
Stock Position:  0.0002309313111527837
Bond Position:  [-4.8284093]


portfolio before change:  [-4.80665634]
curr_Stock_Price:  99.4244096379926
curr_Factors:  [ 9.94244096e+01  4.71951759e-02 -1.01287740e+00]
mat_Sqrt:  [[37.85319649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00351339 -0.09296045 -0.18429859]
Stock Position:  -0.0035133909659982973
Bond Position:  [-4.45733952]


portfolio before change:  [-4.78903125]
curr_Stock_Price:  94.09065456980599
curr_Factors:  [ 9.40906546e+01 -7.86722627e-02 -9.39206653e-01]
mat_Sqrt:  [[34.00065577  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00119693  0.01692342 -0.22743666]
Stock Position:  0.0011969330009652163
Bond Position:  [-4.90165146]


portfolio before change:  [-4.78916127]
curr_Stock_Price:  95.0059446903117
curr_Factors:  [95.00594469 -0.43014075 -0.9405478 ]
mat_Sqrt:  [[24.12505461  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0036679  -0.02028396  0.36178186]
Stock Position:  0.0036678979860452674
Bond Position:  [-5.13763338]


portfolio before change:  [-4.79419318]
curr_Stock_Price:  93.98428594126628
curr_Factors:  [93.98428594 -0.66428099 -0.9192679 ]
mat_Sqrt:  [[19.28984327  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00363053  0.03797789  0.33091074]
Stock Position:  -0.0036305316944450577
Bond Position:  [-4.45298025]


portfolio before change:  [-4.79609087]
curr_Stock_Price:  94.20031502023386
curr_Factors:  [94.20031502 -0.68770263 -0.96515923]
mat_Sqrt:  [[18.03946152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00168039 -0.05485405 -0.97885237]
Stock Position:  0.0016803873449092433
Bond Position:  [-4.95438388]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.79329243]
Stock Price:  96.60285073289032
PL:  [-4.79329243]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 2.63154308e-02 -4.20948678e-02  4.06940104e-02]
 [ 3.37356456e-02  1.72131595e-01 -2.32249212e-01]
 [-5.57568671e-02 -7.06652281e-02 -8.74486309e-02]
 [-2.45342768e-01 -2.31140342e-01  1.07962011e+00]
 [ 1.64689693e-02 -6.39722275e-02  3.37012849e-02]
 [-9.17014637e-01  1.00992285e+00 -1.43874354e-01]
 [ 1.09728043e-02 -7.48749051e-03  3.28048895e-02]
 [-8.75273852e-02 -2.76792096e-02 -6.01538342e-03]
 [ 5.88521954e-02  2.61724201e-02  6.13035170e-02]
 [-1.13477691e-01  1.85686021e-01 -4.65727973e-02]
 [-1.52956131e-03  3.00444692e-02 -5.14545859e-02]
 [-2.63971363e-02  1.48314413e-01 -2.18718745e-03]
 [-1.17405010e-01 -8.93734144e-02  6.69464808e-02]
 [ 3.88277915e-03  1.82117046e-01 -1.32098653e-01]
 [-7.19102948e-03 -2.64540747e-02 -7.43695197e-02]
 [ 4.61796717e-02  1.76556952e-02 -1.39329176e-02]
 [ 1.63515533e-01  1.84747851e-02  1.57379117e-01]
 [-8.66036826e-02  8.56894653e-02  8.17279939e-02]
 [ 1.22107546e-01 -9.22227957e-02 -3.01787980e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.67792776]
curr_Stock_Price:  101.43560508625222
curr_Factors:  [101.43560509  -0.90587358  -0.99523269]
mat_Sqrt:  [[15.15480881  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00171757 -0.01358606  0.11608868]
Stock Position:  0.0017175724435502862
Bond Position:  [13.50370476]


portfolio before change:  [13.68069205]
curr_Stock_Price:  101.07925529089074
curr_Factors:  [101.07925529  -0.99730014  -1.00819264]
mat_Sqrt:  [[13.60465666  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00157771  0.05555523 -0.66254236]
Stock Position:  0.001577708939722582
Bond Position:  [13.52121841]


portfolio before change:  [13.68580711]
curr_Stock_Price:  102.17852500138045
curr_Factors:  [102.178525    -0.88185704  -1.05525427]
mat_Sqrt:  [[14.72593486  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00597801 -0.0228071  -0.2494666 ]
Stock Position:  -0.005978005760235967
Bond Position:  [14.29663092]


portfolio before change:  [13.68282797]
curr_Stock_Price:  103.27483515368733
curr_Factors:  [103.27483515  -1.10449801  -1.03345259]
mat_Sqrt:  [[12.17571196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00592553 -0.07460022  3.07985566]
Stock Position:  -0.00592553122223853
Bond Position:  [14.29478623]


portfolio before change:  [13.68841032]
curr_Stock_Price:  102.93592704471958
curr_Factors:  [102.93592704  -1.09112738  -0.97539791]
mat_Sqrt:  [[13.03426207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00078945 -0.02064695  0.09614039]
Stock Position:  0.0007894531291160877
Bond Position:  [13.60714723]


portfolio before change:  [13.69184282]
curr_Stock_Price:  102.97429903577074
curr_Factors:  [102.97429904  -1.29511268  -0.9714218 ]
mat_Sqrt:  [[10.67543127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06933989  0.3259512  -0.41043349]
Stock Position:  -0.06933988987046912
Bond Position:  [20.83206938]


portfolio before change:  [13.79621006]
curr_Stock_Price:  101.54426257706938
curr_Factors:  [101.54426258  -1.02312487  -0.96293962]
mat_Sqrt:  [[13.93537127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115825 -0.00241658  0.09358322]
Stock Position:  0.0011582538017400966
Bond Position:  [13.67859604]


portfolio before change:  [13.80039374]
curr_Stock_Price:  102.20352863701213
curr_Factors:  [102.20352864  -1.16143575  -0.99238718]
mat_Sqrt:  [[11.85966653  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0079602  -0.00893343 -0.01716021]
Stock Position:  -0.007960195585622486
Bond Position:  [14.61395381]


portfolio before change:  [13.81547632]
curr_Stock_Price:  100.76780542223418
curr_Factors:  [100.76780542  -1.14962098  -0.9893214 ]
mat_Sqrt:  [[11.86836595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00646324 0.00844711 0.17488187]
Stock Position:  0.0064632441098984705
Bond Position:  [13.1641894]


portfolio before change:  [13.81715588]
curr_Stock_Price:  100.51841122343329
curr_Factors:  [100.51841122  -1.10235423  -0.94456   ]
mat_Sqrt:  [[12.98022024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00655469  0.05992991 -0.13285923]
Stock Position:  -0.006554690254539279
Bond Position:  [14.47602293]


portfolio before change:  [13.82823191]
curr_Stock_Price:  99.38081835113087
curr_Factors:  [99.38081835 -0.81687762 -0.98611039]
mat_Sqrt:  [[16.37852632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036022  0.00969681 -0.14678561]
Stock Position:  -0.0003602206306633898
Bond Position:  [13.86403093]


portfolio before change:  [13.831978]
curr_Stock_Price:  98.60450175089282
curr_Factors:  [98.60450175 -0.81119618 -0.98676839]
mat_Sqrt:  [[16.33242429  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00021007  0.04786827 -0.00623944]
Stock Position:  0.00021007039208937936
Bond Position:  [13.81126411]


portfolio before change:  [13.83547413]
curr_Stock_Price:  98.8086566347327
curr_Factors:  [98.80865663 -1.05248864 -0.97186702]
mat_Sqrt:  [[13.0505407   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00934696 -0.02884515  0.19097968]
Stock Position:  -0.009346960526743435
Bond Position:  [14.75903474]


portfolio before change:  [13.85623179]
curr_Stock_Price:  96.98266899251719
curr_Factors:  [96.98266899 -0.98104401 -0.93861053]
mat_Sqrt:  [[14.22324719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099082  0.05877802 -0.37684069]
Stock Position:  0.0009908244338377081
Bond Position:  [13.76013899]


portfolio before change:  [13.85906841]
curr_Stock_Price:  96.37323518794423
curr_Factors:  [96.37323519 -1.34947    -0.9607152 ]
mat_Sqrt:  [[ 9.56435648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00290365 -0.00853802 -0.21215554]
Stock Position:  -0.0029036516518290132
Bond Position:  [14.13890271]


portfolio before change:  [13.86418681]
curr_Stock_Price:  95.82797775162183
curr_Factors:  [95.82797775 -1.30069443 -0.96343466]
mat_Sqrt:  [[ 9.95849138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00471352  0.00569835 -0.03974674]
Stock Position:  0.004713523230113798
Bond Position:  [13.41249941]


portfolio before change:  [13.8655055]
curr_Stock_Price:  95.39627064309848
curr_Factors:  [95.39627064 -1.20814991 -0.93687184]
mat_Sqrt:  [[11.16761126  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01785624 0.00596271 0.44895881]
Stock Position:  0.017856241236091964
Bond Position:  [12.16208667]


portfolio before change:  [13.8643804]
curr_Stock_Price:  95.16296315335953
curr_Factors:  [95.16296315 -0.81283267 -0.92373888]
mat_Sqrt:  [[16.76040534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00312819  0.02765616  0.23314722]
Stock Position:  -0.0031281902676734844
Bond Position:  [14.16206826]


portfolio before change:  [13.87078624]
curr_Stock_Price:  94.24713810760451
curr_Factors:  [94.24713811 -0.81313321 -0.92096717]
mat_Sqrt:  [[16.64017727  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00250481 -0.02976478 -0.8609171 ]
Stock Position:  0.002504807064249169
Bond Position:  [13.63471534]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.87806912]
Stock Price:  95.7936738292935
PL:  [13.87806912]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 1.84933832e-02 -3.81887913e-02  4.64944299e-02]
 [ 3.58650043e-02  1.77453731e-01 -2.41054722e-01]
 [-6.99052891e-02 -3.23334359e-02 -5.77481188e-02]
 [-4.14970589e-01 -4.52876275e-01  1.68539355e+00]
 [-6.42882057e-03 -8.69205953e-02  3.07342848e-03]
 [-1.15715134e+00  1.22201751e+00 -1.77182969e-01]
 [ 1.05591281e-02 -6.22329754e-03  3.04934431e-02]
 [-5.93285982e-02 -1.01106367e-01  1.40548026e-01]
 [ 7.55876996e-02  2.67553294e-02  6.25683423e-02]
 [-4.95101585e-01  2.74558883e-01 -2.44891267e-01]
 [ 1.27733793e-01  1.16582036e-02 -6.06408441e-02]
 [-1.25891643e-01 -1.11560129e-01 -2.21654877e-02]
 [ 2.96933274e-01  3.59590264e-01  1.76385034e-03]
 [ 6.38525257e-03  5.20349261e-01 -3.95615562e-01]
 [ 1.34344378e-01 -6.13833006e-02 -1.68998864e-02]
 [ 1.97915588e-02 -2.73732663e-02 -6.38162259e-02]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 3.90760941e-02 -1.45370638e-01 -4.27352072e-02]
 [-1.32828028e-01  5.32833717e-02 -1.04232844e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.72648426]
curr_Stock_Price:  101.18960288962762
curr_Factors:  [101.18960289  -1.00990342  -0.98718072]
mat_Sqrt:  [[13.73451315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00146993 -0.01232538  0.13263567]
Stock Position:  0.0014699293923757797
Bond Position:  [11.57774268]


portfolio before change:  [11.72893421]
curr_Stock_Price:  100.88697253813007
curr_Factors:  [100.88697254  -0.95168128  -0.96722526]
mat_Sqrt:  [[14.80691458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00154539  0.05727295 -0.68766202]
Stock Position:  0.0015453932859476167
Bond Position:  [11.57302416]


portfolio before change:  [11.73378516]
curr_Stock_Price:  102.15353244438023
curr_Factors:  [102.15353244  -0.61612177  -0.98130677]
mat_Sqrt:  [[20.6775457   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00427    -0.01043557 -0.16473931]
Stock Position:  -0.004269999482531779
Bond Position:  [12.16998069]


portfolio before change:  [11.72725003]
curr_Stock_Price:  104.39662450756562
curr_Factors:  [104.39662451  -0.47341228  -0.98934966]
mat_Sqrt:  [[24.17781315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0067576  -0.14616519  4.80795867]
Stock Position:  -0.006757602613191719
Bond Position:  [12.43272094]


portfolio before change:  [11.7363158]
curr_Stock_Price:  103.51506876433929
curr_Factors:  [103.51506876  -0.28725974  -0.98850584]
mat_Sqrt:  [[28.90317986  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00081458 -0.0280535   0.00876764]
Stock Position:  -0.000814583444780776
Bond Position:  [11.82063747]


portfolio before change:  [11.74064476]
curr_Stock_Price:  101.82901524358473
curr_Factors:  [101.82901524  -0.74795833  -0.97422004]
mat_Sqrt:  [[18.19445213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0518771   0.39440445 -0.50545369]
Stock Position:  -0.05187709844432371
Bond Position:  [17.02323861]


portfolio before change:  [11.74085516]
curr_Stock_Price:  101.9070062727491
curr_Factors:  [101.90700627  -0.94834157  -0.95877703]
mat_Sqrt:  [[15.1339731   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00102506 -0.00200856  0.08698931]
Stock Position:  0.0010250613434967183
Bond Position:  [11.63639423]


portfolio before change:  [11.74466801]
curr_Stock_Price:  102.78831033136929
curr_Factors:  [102.78831033  -0.66990794  -0.94045407]
mat_Sqrt:  [[20.53867358  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249664 -0.03263194  0.4009444 ]
Stock Position:  -0.0024966365519360303
Bond Position:  [12.00129306]


portfolio before change:  [11.75093705]
curr_Stock_Price:  101.47921353701058
curr_Factors:  [101.47921354  -0.64455813  -0.92096048]
mat_Sqrt:  [[21.20708605  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00442403 0.00863525 0.17849007]
Stock Position:  0.004424031548041542
Bond Position:  [11.30198981]


portfolio before change:  [11.7592241]
curr_Stock_Price:  102.71365387815787
curr_Factors:  [102.71365388  -0.44178987  -0.94430315]
mat_Sqrt:  [[25.68358395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01904118  0.0886135  -0.69860662]
Stock Position:  -0.019041178590623698
Bond Position:  [13.71501313]


portfolio before change:  [11.79083602]
curr_Stock_Price:  101.23355952908977
curr_Factors:  [ 1.01233560e+02  8.77111756e-02 -9.34513160e-01]
mat_Sqrt:  [[43.40733054  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00271234  0.00376267 -0.17299145]
Stock Position:  0.0027123357187748953
Bond Position:  [11.51625663]


portfolio before change:  [11.80520863]
curr_Stock_Price:  105.470933445067
curr_Factors:  [ 1.05470933e+02  2.81815131e-02 -9.27277147e-01]
mat_Sqrt:  [[42.92007946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00356915 -0.03600588 -0.06323197]
Stock Position:  -0.0035691516012542833
Bond Position:  [12.18165038]


portfolio before change:  [11.80066687]
curr_Stock_Price:  107.59680441872108
curr_Factors:  [ 1.07596804e+02 -8.55560492e-02 -9.76898019e-01]
mat_Sqrt:  [[37.18616861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00996861 0.11605726 0.00503177]
Stock Position:  0.009968608958143287
Bond Position:  [10.7280764]


portfolio before change:  [11.74278832]
curr_Stock_Price:  101.52164363775572
curr_Factors:  [101.52164364  -0.14235792  -0.95810271]
mat_Sqrt:  [[33.77805683  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.42813627e-04  1.67942002e-01 -1.12858108e+00]
Stock Position:  0.0009428136267092325
Bond Position:  [11.64707233]


portfolio before change:  [11.74917404]
curr_Stock_Price:  105.20592732613312
curr_Factors:  [105.20592733  -0.23445699  -0.93301991]
mat_Sqrt:  [[32.73493135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00361586 -0.01981138 -0.04821067]
Stock Position:  0.003615858788179922
Bond Position:  [11.36876427]


portfolio before change:  [11.75244203]
curr_Stock_Price:  105.32358561764292
curr_Factors:  [105.32358562  -0.42070563  -0.91131435]
mat_Sqrt:  [[27.79948212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.23598401e-05 -8.83468370e-03 -1.82049929e-01]
Stock Position:  4.235984010864282e-05
Bond Position:  [11.74798054]


portfolio before change:  [11.75530393]
curr_Stock_Price:  103.54225535823574
curr_Factors:  [103.54225536  -0.45503056  -0.87384459]
mat_Sqrt:  [[27.41539296  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00250917  0.00525786  0.16709793]
Stock Position:  -0.0025091676059374544
Bond Position:  [12.0151088]


portfolio before change:  [11.75415599]
curr_Stock_Price:  105.19702516069788
curr_Factors:  [105.19702516  -0.54798892  -0.90058842]
mat_Sqrt:  [[24.71122717  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.74834300e-05 -4.69181716e-02 -1.21911651e-01]
Stock Position:  2.7483430020991225e-05
Bond Position:  [11.75126481]


portfolio before change:  [11.75701749]
curr_Stock_Price:  102.40683715648306
curr_Factors:  [102.40683716  -0.44980609  -0.92543848]
mat_Sqrt:  [[25.88617164  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00479326  0.01719713 -0.02973473]
Stock Position:  -0.004793263795135053
Bond Position:  [12.24788047]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.74288776]
Stock Price:  105.99355448200423
PL:  [5.74933328]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 2.02782216e-02 -3.72855242e-02  4.27545405e-02]
 [ 3.34210873e-02  1.72369868e-01 -2.30349217e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-3.21063753e-01 -3.37910368e-01  1.20351729e+00]
 [-1.97868828e-02 -1.04482728e-02 -2.34855648e-03]
 [-1.16060121e+00  1.17216015e+00 -1.66112369e-01]
 [ 1.15216134e-02 -9.16464894e-03  3.58714006e-02]
 [-7.66421502e-02 -5.86061064e-02  5.88594679e-02]
 [ 3.93374879e-02  2.39849426e-02  6.02642283e-02]
 [-3.44032999e-01  2.40379583e-01 -1.65247121e-01]
 [ 3.89867706e-02  4.98944047e-02 -5.50321487e-02]
 [ 7.29420934e-02 -2.81236620e-02 -2.55484799e-02]
 [-5.95592499e-02 -6.59275113e-02 -1.19720546e-02]
 [ 2.98523449e-02  3.91669400e-01 -2.43653014e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 5.83552198e-02  5.17673701e-02  1.12932087e-01]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 3.54069728e-02 -8.25732106e-02 -4.22034188e-02]
 [-1.05648026e-02 -6.38741081e-02 -9.20807299e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.32526612]
curr_Stock_Price:  101.2650863222598
curr_Factors:  [101.26508632  -0.93797632  -0.99788672]
mat_Sqrt:  [[14.61251929  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00146413 -0.01203385  0.1219668 ]
Stock Position:  0.0014641267171133956
Bond Position:  [12.1770012]


portfolio before change:  [12.32777516]
curr_Stock_Price:  100.89927627566018
curr_Factors:  [100.89927628  -0.73428668  -0.97335443]
mat_Sqrt:  [[18.29232644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00118006  0.05563214 -0.6571222 ]
Stock Position:  0.0011800632450802613
Bond Position:  [12.20870763]


portfolio before change:  [12.33099402]
curr_Stock_Price:  101.04019876692487
curr_Factors:  [101.04019877  -0.55499704  -0.98118185]
mat_Sqrt:  [[21.74403691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00358824  0.01370813 -0.02999186]
Stock Position:  -0.003588236112886585
Bond Position:  [12.69355011]


portfolio before change:  [12.32989812]
curr_Stock_Price:  102.2301092142236
curr_Factors:  [102.23010921  -0.68839965  -0.95713006]
mat_Sqrt:  [[19.72124621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00732066 -0.1090601   3.43329982]
Stock Position:  -0.007320657084932626
Bond Position:  [13.0782897]


portfolio before change:  [12.33849087]
curr_Stock_Price:  101.50302071253527
curr_Factors:  [101.50302071  -0.88018117  -0.98814275]
mat_Sqrt:  [[15.67025988  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014294  -0.00337217 -0.00669978]
Stock Position:  -0.001429397142402029
Bond Position:  [12.483579]


portfolio before change:  [12.34385183]
curr_Stock_Price:  99.93615454042643
curr_Factors:  [99.93615454 -0.82987089 -0.97163848]
mat_Sqrt:  [[16.49442018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05791307  0.37831306 -0.47387235]
Stock Position:  -0.05791307347280405
Bond Position:  [18.13146169]


portfolio before change:  [12.2720564]
curr_Stock_Price:  101.25414468730074
curr_Factors:  [101.25414469  -0.79357514  -0.9487213 ]
mat_Sqrt:  [[17.73140225  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00095723 -0.00295788  0.10233112]
Stock Position:  0.0009572342917857518
Bond Position:  [12.17513246]


portfolio before change:  [12.27433064]
curr_Stock_Price:  100.44982496110356
curr_Factors:  [100.44982496  -0.49179833  -0.950513  ]
mat_Sqrt:  [[23.74440724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00322562 -0.01891504  0.16790968]
Stock Position:  -0.0032256199224166065
Bond Position:  [12.5983436]


portfolio before change:  [12.2709606]
curr_Stock_Price:  102.47114887385817
curr_Factors:  [102.47114887  -0.42338661  -0.98854219]
mat_Sqrt:  [[24.96943508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00226416 0.00774111 0.17191707]
Stock Position:  0.0022641592676782766
Bond Position:  [12.0389496]


portfolio before change:  [12.27241114]
curr_Stock_Price:  101.78233926994965
curr_Factors:  [101.78233927  -0.44874131  -0.98221425]
mat_Sqrt:  [[24.33415819  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01350762  0.07758218 -0.47140404]
Stock Position:  -0.013507623585932431
Bond Position:  [13.64724866]


portfolio before change:  [12.27095667]
curr_Stock_Price:  102.14263241028864
curr_Factors:  [102.14263241  -0.52090561  -0.9994581 ]
mat_Sqrt:  [[22.33168417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00169884  0.01610335 -0.1569914 ]
Stock Position:  0.0016988433425413863
Bond Position:  [12.09743234]


portfolio before change:  [12.27288501]
curr_Stock_Price:  101.49725160259368
curr_Factors:  [101.4972516   -0.40891445  -0.97186543]
mat_Sqrt:  [[25.51462556  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00242944 -0.00907687 -0.0728827 ]
Stock Position:  0.0024294424082985863
Bond Position:  [12.02630328]


portfolio before change:  [12.27436853]
curr_Stock_Price:  100.87018411956645
curr_Factors:  [100.87018412  -0.50123384  -0.93749746]
mat_Sqrt:  [[23.92928657  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00315348 -0.02127801 -0.03415294]
Stock Position:  -0.0031534760556775326
Bond Position:  [12.59246024]


portfolio before change:  [12.28312671]
curr_Stock_Price:  99.09130064227199
curr_Factors:  [99.09130064 -0.62117966 -0.96833717]
mat_Sqrt:  [[20.21702001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00297106  0.12641076 -0.69507423]
Stock Position:  0.002971064141715748
Bond Position:  [11.9887201]


portfolio before change:  [12.28772683]
curr_Stock_Price:  99.63069361335378
curr_Factors:  [99.63069361 -0.79372187 -0.93094544]
mat_Sqrt:  [[17.75741154  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00748944 -0.09296045 -0.18429859]
Stock Position:  -0.0074894405771325345
Bond Position:  [13.03390499]


portfolio before change:  [12.28745377]
curr_Stock_Price:  100.10228393797206
curr_Factors:  [100.10228394  -0.49282999  -0.9394618 ]
mat_Sqrt:  [[23.90053177  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00384821 0.01670785 0.32216381]
Stock Position:  0.0038482137827582697
Bond Position:  [11.90223878]


portfolio before change:  [12.29179187]
curr_Stock_Price:  100.45625852406246
curr_Factors:  [100.45625852  -0.56139235  -0.95186788]
mat_Sqrt:  [[22.11955723  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00310991  0.00525786  0.16709793]
Stock Position:  -0.003109909263754466
Bond Position:  [12.60420172]


portfolio before change:  [12.29600932]
curr_Stock_Price:  100.11348217328532
curr_Factors:  [100.11348217  -0.39968748  -0.97041859]
mat_Sqrt:  [[25.43683439  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00039066 -0.02665039 -0.12039461]
Stock Position:  0.0003906559200025071
Bond Position:  [12.2568994]


portfolio before change:  [12.29921237]
curr_Stock_Price:  100.4678697366361
curr_Factors:  [ 1.00467870e+02 -4.94912893e-02 -9.31749645e-01]
mat_Sqrt:  [[37.65994407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00112584 -0.02061528 -0.26268069]
Stock Position:  -0.0011258367907959962
Bond Position:  [12.4123228]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.30382125]
Stock Price:  99.13071948920887
PL:  [12.30382125]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.06938387e-02  1.30805135e-03  3.45814235e-02]
 [ 3.61467546e-02  9.96060461e-02 -2.43244093e-01]
 [ 7.30570783e-02 -4.73152763e-02 -3.92812127e-02]
 [-2.76988291e-01 -2.80148956e-01  1.03100825e+00]
 [-7.07260100e-02  6.47523742e-02 -5.29982406e-02]
 [-1.19535958e+00  1.27224238e+00 -1.86039741e-01]
 [ 5.13966523e-03 -1.83404617e-02  1.59286936e-02]
 [-4.34801710e-02 -1.38038293e-01  2.13633365e-01]
 [-7.19869274e-03 -6.19022205e-03  1.44725421e-02]
 [-5.42370667e-01  2.83524294e-01 -2.71776951e-01]
 [ 1.41763393e-01  4.68451641e-02 -5.52834033e-02]
 [-7.07887719e-02  1.32922244e-01  9.38098668e-02]
 [ 2.61211882e-01  1.22027778e-01 -1.21339192e-01]
 [ 1.75209872e-02  9.93800605e-01 -6.16466021e-01]
 [ 1.41829408e-01 -6.19527680e-02 -9.93573177e-03]
 [ 1.79127106e-02 -3.04665803e-02 -8.85990164e-02]
 [-7.04660698e-02 -4.86438929e-02  5.44963524e-02]
 [ 6.68146992e-02 -4.64523821e-01  1.41684788e-03]
 [-2.32922121e-01 -3.78082235e-02 -8.75458547e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.51589478]
curr_Stock_Price:  100.53274736126252
curr_Factors:  [100.53274736  -0.68524346  -0.98622569]
mat_Sqrt:  [[18.89721139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00017822  0.00042217  0.09865118]
Stock Position:  -0.0001782236662583529
Bond Position:  [6.5338121]


portfolio before change:  [6.51773024]
curr_Stock_Price:  99.40045522788321
curr_Factors:  [99.40045523 -0.65239769 -1.00157909]
mat_Sqrt:  [[19.01408302  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.59037086e-04  3.21477131e-02 -6.93907693e-01]
Stock Position:  0.00035903708562110654
Bond Position:  [6.48204179]


portfolio before change:  [6.51931296]
curr_Stock_Price:  99.29461843007412
curr_Factors:  [99.29461843 -0.5542133  -1.00254054]
mat_Sqrt:  [[20.93322356  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00264559 -0.01527094 -0.11205837]
Stock Position:  0.0026455860395894902
Bond Position:  [6.2566205]


portfolio before change:  [6.52748609]
curr_Stock_Price:  101.79265879330467
curr_Factors:  [101.79265879  -0.8375009   -1.01169589]
mat_Sqrt:  [[16.01845031  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00772358 -0.09041769  2.94117956]
Stock Position:  -0.007723579781582095
Bond Position:  [7.31368981]


portfolio before change:  [6.54444086]
curr_Stock_Price:  99.83422479510119
curr_Factors:  [99.8342248  -0.60783005 -0.95480391]
mat_Sqrt:  [[20.92358723  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00326554  0.02089874 -0.15118923]
Stock Position:  -0.003265535053926468
Bond Position:  [6.87045302]


portfolio before change:  [6.53865281]
curr_Stock_Price:  102.13273797469762
curr_Factors:  [102.13273797  -0.67521216  -0.98385448]
mat_Sqrt:  [[19.43754835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05009065  0.41061446 -0.5307196 ]
Stock Position:  -0.05009064824784912
Bond Position:  [11.65454786]


portfolio before change:  [6.44073661]
curr_Stock_Price:  104.14569271511088
curr_Factors:  [104.14569272  -0.82825079  -0.97321972]
mat_Sqrt:  [[17.18987067  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00027035 -0.00591936  0.04544013]
Stock Position:  0.000270354862799291
Bond Position:  [6.41258031]


portfolio before change:  [6.44240392]
curr_Stock_Price:  104.38229819722639
curr_Factors:  [104.3822982   -1.01600781  -0.96116592]
mat_Sqrt:  [[14.45277409  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00194076 -0.04455167  0.60943653]
Stock Position:  -0.001940761773396526
Bond Position:  [6.64498509]


portfolio before change:  [6.44436981]
curr_Stock_Price:  104.2254346835739
curr_Factors:  [104.22543468  -0.85767011  -0.95107561]
mat_Sqrt:  [[17.07833122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00032252 -0.00199789  0.04128613]
Stock Position:  -0.0003225181178067144
Bond Position:  [6.4779844]


portfolio before change:  [6.44640406]
curr_Stock_Price:  102.94007151200091
curr_Factors:  [102.94007151  -0.78021592  -0.9314856 ]
mat_Sqrt:  [[18.58668501  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02905159  0.09150707 -0.77530399]
Stock Position:  -0.029051589888840795
Bond Position:  [9.4369768]


portfolio before change:  [6.42319304]
curr_Stock_Price:  103.82024923914932
curr_Factors:  [103.82024924  -0.90496669  -0.95044732]
mat_Sqrt:  [[16.23626014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0086252   0.01511921 -0.15770816]
Stock Position:  0.008625197137491715
Bond Position:  [5.52772292]


portfolio before change:  [6.44764034]
curr_Stock_Price:  106.49441426510275
curr_Factors:  [106.49441427  -0.91503308  -0.96653839]
mat_Sqrt:  [[16.22447757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00151051  0.04290047  0.26761344]
Stock Position:  -0.001510512344973559
Bond Position:  [6.60850147]


portfolio before change:  [6.44885187]
curr_Stock_Price:  106.78623630574272
curr_Factors:  [106.78623631  -0.6787594   -0.95524425]
mat_Sqrt:  [[20.8389825   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01254152  0.0393843  -0.34614694]
Stock Position:  0.012541516326361205
Bond Position:  [5.10959054]


portfolio before change:  [6.44773535]
curr_Stock_Price:  106.5953441855052
curr_Factors:  [106.59534419  -0.60825597  -0.96177776]
mat_Sqrt:  [[22.17589996  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00426337  0.32074777 -1.75860597]
Stock Position:  0.004263370903001007
Bond Position:  [5.99327986]


portfolio before change:  [6.4446958]
curr_Stock_Price:  105.53091449541702
curr_Factors:  [105.5309145   -0.19179992  -0.95011672]
mat_Sqrt:  [[33.68616773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0037747  -0.01999517 -0.02834388]
Stock Position:  0.0037747015404848545
Bond Position:  [6.04634809]


portfolio before change:  [6.45030348]
curr_Stock_Price:  106.61600878963874
curr_Factors:  [ 1.06616009e+02 -6.20468342e-02 -9.56345926e-01]
mat_Sqrt:  [[38.50703365  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.65981431e-04 -9.83304652e-03 -2.52748333e-01]
Stock Position:  -0.000165981431112908
Bond Position:  [6.46799976]


portfolio before change:  [6.45092888]
curr_Stock_Price:  112.59139440014098
curr_Factors:  [112.5913944    0.1313638   -0.95549186]
mat_Sqrt:  [[49.38453065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014027  -0.01569975  0.15546292]
Stock Position:  -0.0014026951472509788
Bond Position:  [6.60886028]


portfolio before change:  [6.44843558]
curr_Stock_Price:  115.5469331318349
curr_Factors:  [ 1.15546933e+02  5.49187510e-02 -9.22165610e-01]
mat_Sqrt:  [[48.5420259   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057098 -0.14992442  0.00404187]
Stock Position:  -0.0005709818525136995
Bond Position:  [6.51441079]


portfolio before change:  [6.45254529]
curr_Stock_Price:  111.20195820966629
curr_Factors:  [111.20195821  -0.27983537  -0.91078822]
mat_Sqrt:  [[33.80891091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00764621 -0.01220255 -0.24974396]
Stock Position:  -0.007646206510733497
Bond Position:  [7.30281843]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.457585]
Stock Price:  110.78164868704194
PL:  [-4.32406369]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-7.92623734e-02  1.55880340e-01  1.22959540e-02]
 [ 9.49473052e-03  6.84495876e-03 -3.03740895e-02]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-8.93463006e-02 -3.68814933e-02  3.51462334e-01]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-9.11748908e-01  9.42014455e-01 -1.26662805e-01]
 [ 1.05577877e-02 -6.21920128e-03  3.04859535e-02]
 [-8.18417705e-02 -4.12499598e-02  2.08924193e-02]
 [-5.61988291e-02  7.65404011e-03  3.96616611e-02]
 [-8.68922907e-01  3.58337102e-01 -4.42879764e-01]
 [ 9.74797424e-02  5.23646790e-02 -5.58700675e-02]
 [ 1.51769007e-02  9.45319449e-02 -1.14108665e-02]
 [ 1.67401727e-01  4.71751609e-02 -1.06010139e-01]
 [ 1.44996533e-02  8.79322242e-01 -5.62169150e-01]
 [ 1.01989859e-01 -6.04474404e-02 -4.16647325e-02]
 [ 6.08228354e-02  6.55724922e-02  1.22319658e-01]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.13042788e-02 -1.41841647e-01 -4.20102907e-02]
 [-1.54221705e-01  3.70131422e-02 -2.28751739e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.96002361]
curr_Stock_Price:  99.21213575906602
curr_Factors:  [99.21213576 -1.05846553 -0.97569495]
mat_Sqrt:  [[12.97597887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00346282  0.05031016  0.03507693]
Stock Position:  -0.003462823999592694
Bond Position:  [-3.61646944]


portfolio before change:  [-3.9593168]
curr_Stock_Price:  98.74689762372772
curr_Factors:  [98.74689762 -0.84278761 -0.96114678]
mat_Sqrt:  [[16.25865853  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00028858  0.0022092  -0.08664882]
Stock Position:  0.0002885765035649823
Bond Position:  [-3.98781284]


portfolio before change:  [-3.95981597]
curr_Stock_Price:  100.47229818204453
curr_Factors:  [100.47229818  -1.0606018   -0.98890867]
mat_Sqrt:  [[12.94062489  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00602929  0.01370813 -0.02999186]
Stock Position:  -0.0060292867738071364
Bond Position:  [-3.35403967]


portfolio before change:  [-3.96040442]
curr_Stock_Price:  100.43080678092899
curr_Factors:  [100.43080678  -1.52857771  -0.9787486 ]
mat_Sqrt:  [[ 8.18368624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00307108 -0.01190345  1.00262421]
Stock Position:  -0.0030710800349885007
Bond Position:  [-3.65197338]


portfolio before change:  [-3.96177822]
curr_Stock_Price:  100.5808160124229
curr_Factors:  [100.58081601  -1.50831989  -0.9398566 ]
mat_Sqrt:  [[ 8.69532089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00653195 -0.04522423  0.24245377]
Stock Position:  0.006531947793523731
Bond Position:  [-4.61876686]


portfolio before change:  [-3.95877481]
curr_Stock_Price:  101.21741733425566
curr_Factors:  [101.21741733  -1.19653588  -0.93022638]
mat_Sqrt:  [[12.0674119   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0617627   0.30403386 -0.36133373]
Stock Position:  -0.061762700686188596
Bond Position:  [2.29268624]


portfolio before change:  [-3.99743669]
curr_Stock_Price:  101.85267335415033
curr_Factors:  [101.85267335  -1.05952612  -0.97440345]
mat_Sqrt:  [[13.32441162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00116412 -0.00200724  0.08696794]
Stock Position:  0.0011641202763926313
Bond Position:  [-4.11600545]


portfolio before change:  [-3.99751675]
curr_Stock_Price:  102.66794552258224
curr_Factors:  [102.66794552  -1.26687996  -0.9490384 ]
mat_Sqrt:  [[11.19628018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00768088 -0.01331337  0.05960026]
Stock Position:  -0.007680875670672359
Bond Position:  [-3.20893702]


portfolio before change:  [-4.00579734]
curr_Stock_Price:  103.64156556933943
curr_Factors:  [103.64156557  -0.9963614   -0.92248625]
mat_Sqrt:  [[15.2120946   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00305944  0.00247033  0.11314368]
Stock Position:  -0.003059444033590064
Bond Position:  [-3.68871177]


portfolio before change:  [-4.01023646]
curr_Stock_Price:  104.79106652484876
curr_Factors:  [104.79106652  -0.79285503  -0.92766449]
mat_Sqrt:  [[18.75478658  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04725088  0.1156528  -1.26341269]
Stock Position:  -0.04725087653618448
Bond Position:  [0.94123328]


portfolio before change:  [-3.9705886]
curr_Stock_Price:  103.9569545270882
curr_Factors:  [103.95695453  -0.6777587   -0.9027281 ]
mat_Sqrt:  [[21.40212279  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00452124  0.01690063 -0.15938175]
Stock Position:  0.004521243470547383
Bond Position:  [-4.44060331]


portfolio before change:  [-3.9775364]
curr_Stock_Price:  102.66582630540472
curr_Factors:  [102.66582631  -0.79085413  -0.89181082]
mat_Sqrt:  [[19.0833145   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0016844   0.03051005 -0.03255203]
Stock Position:  0.0016843992056597434
Bond Position:  [-4.15046663]


portfolio before change:  [-3.97537668]
curr_Stock_Price:  104.5641105266944
curr_Factors:  [104.56411053  -0.62190608  -0.90224368]
mat_Sqrt:  [[22.77470794  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00682301  0.01522572 -0.30241742]
Stock Position:  0.006823011200758405
Bond Position:  [-4.68881877]


portfolio before change:  [-3.97470566]
curr_Stock_Price:  104.8342789283099
curr_Factors:  [104.83427893  -0.64045165  -0.87771023]
mat_Sqrt:  [[22.97068685  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00344954  0.28380003 -1.60371211]
Stock Position:  0.0034495379952751495
Bond Position:  [-4.33633549]


portfolio before change:  [-3.98069743]
curr_Stock_Price:  103.41161212763896
curr_Factors:  [103.41161213  -0.77184622  -0.91303138]
mat_Sqrt:  [[19.17945502  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0042309  -0.01950933 -0.11885788]
Stock Position:  0.004230897024239418
Bond Position:  [-4.41822131]


portfolio before change:  [-3.98902468]
curr_Stock_Price:  101.70451420208798
curr_Factors:  [101.7045142   -0.57874549  -0.95542122]
mat_Sqrt:  [[21.93108365  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00452217 0.02116343 0.34894394]
Stock Position:  0.004522173254142211
Bond Position:  [-4.44895011]


portfolio before change:  [-3.9854203]
curr_Stock_Price:  102.74754123448297
curr_Factors:  [102.74754123  -0.25170855  -0.99619665]
mat_Sqrt:  [[29.49939388  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00233191  0.00525786  0.16709793]
Stock Position:  -0.0023319060792976994
Bond Position:  [-3.74582269]


portfolio before change:  [-3.98768598]
curr_Stock_Price:  103.31750757442461
curr_Factors:  [103.31750757  -0.77220489  -1.00270951]
mat_Sqrt:  [[17.51210656  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0002156  -0.04577919 -0.11984367]
Stock Position:  0.00021560280518844078
Bond Position:  [-4.00996153]


portfolio before change:  [-3.98832768]
curr_Stock_Price:  104.99153576853523
curr_Factors:  [104.99153577  -1.24057854  -0.97546764]
mat_Sqrt:  [[11.44821199  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01321917  0.01194594 -0.0652565 ]
Stock Position:  -0.013219165098054536
Bond Position:  [-2.60042723]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.00841968]
Stock Price:  106.46226536533342
PL:  [-10.47068505]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-3.43067551e-03 -1.13139960e-02  4.13071677e-02]
 [ 3.68274354e-02  1.69374590e-01 -2.55890208e-01]
 [-6.60611377e-02 -4.77386444e-02 -6.56987371e-02]
 [-3.57000634e-01 -3.81179237e-01  1.37266450e+00]
 [-1.45673071e-02 -9.99805031e-02 -8.49165919e-03]
 [-1.35513798e+00  1.46283230e+00 -2.19666853e-01]
 [ 1.15069380e-02 -9.11980087e-03  3.57894005e-02]
 [-5.56938811e-02 -1.11942707e-01  1.62377795e-01]
 [ 3.44642535e-02  2.84705153e-02  5.23031466e-02]
 [-3.94192622e-01  2.54059375e-01 -1.89042287e-01]
 [ 1.01543634e-01  1.44243857e-02 -5.87534637e-02]
 [ 3.39296054e-03  4.95977117e-02 -1.04560674e-02]
 [ 1.94439896e-01  2.35123577e-01  2.16217063e-02]
 [ 2.58348597e-02  1.06506923e+00 -6.32977533e-01]
 [ 1.62867163e-01 -1.03764429e-01  1.04493135e-02]
 [ 1.37069004e-02 -3.73909781e-02 -1.44075407e-01]
 [-7.56463831e-02  1.70604798e-02  5.28411345e-02]
 [ 4.35859521e-02 -2.39542335e-01 -3.14660641e-02]
 [-2.18873785e-01 -1.21557866e-02 -6.05050097e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.60169129]
curr_Stock_Price:  100.66962466514462
curr_Factors:  [100.66962467  -0.86123184  -1.0162034 ]
mat_Sqrt:  [[15.40063704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00017478 -0.00365158  0.11783785]
Stock Position:  0.00017477556306681773
Bond Position:  [7.5840967]


portfolio before change:  [7.60356764]
curr_Stock_Price:  100.55567917621228
curr_Factors:  [100.55567918  -0.41773339  -1.05606907]
mat_Sqrt:  [[23.03256616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00083219  0.05466541 -0.72998354]
Stock Position:  0.0008321916303909697
Bond Position:  [7.51988604]


portfolio before change:  [7.60690838]
curr_Stock_Price:  102.31072648583766
curr_Factors:  [102.31072649  -0.46249684  -1.08217598]
mat_Sqrt:  [[21.83123413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00408664 -0.01540758 -0.18742021]
Stock Position:  -0.004086642363281496
Bond Position:  [8.02501573]


portfolio before change:  [7.60642533]
curr_Stock_Price:  102.91992073524433
curr_Factors:  [102.91992074  -0.5904751   -1.04286261]
mat_Sqrt:  [[20.09786343  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00769308 -0.12302507  3.91582975]
Stock Position:  -0.007693083989438218
Bond Position:  [8.39819692]


portfolio before change:  [7.60201296]
curr_Stock_Price:  103.76641876585555
curr_Factors:  [103.76641877  -0.62546237  -1.0474876 ]
mat_Sqrt:  [[19.4761849   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188482 -0.03226857 -0.02422434]
Stock Position:  -0.0018848195741562595
Bond Position:  [7.79759393]


portfolio before change:  [7.60646621]
curr_Stock_Price:  102.4381173180666
curr_Factors:  [102.43811732  -0.56810439  -1.0719646 ]
mat_Sqrt:  [[19.86957935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05543036  0.47212709 -0.62664839]
Stock Position:  -0.055430357958523094
Bond Position:  [13.28464772]


portfolio before change:  [7.65455561]
curr_Stock_Price:  101.63047640707278
curr_Factors:  [101.63047641  -0.41329116  -1.06488026]
mat_Sqrt:  [[23.17726945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00073136 -0.0029434   0.1020972 ]
Stock Position:  0.0007313565240315237
Bond Position:  [7.5802275]


portfolio before change:  [7.65708197]
curr_Stock_Price:  102.4933446313171
curr_Factors:  [102.49334463  -0.34927806  -1.0216322 ]
mat_Sqrt:  [[26.02057591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174473 -0.03612935  0.46321865]
Stock Position:  -0.001744729329405206
Bond Position:  [7.83590511]


portfolio before change:  [7.66581973]
curr_Stock_Price:  98.60819074615429
curr_Factors:  [98.60819075 -0.36571863 -1.00593862]
mat_Sqrt:  [[25.01553622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00203682 0.00918882 0.14920632]
Stock Position:  0.0020368185487928936
Bond Position:  [7.46497274]


portfolio before change:  [7.67450934]
curr_Stock_Price:  101.95808657549705
curr_Factors:  [ 1.01958087e+02  1.00931792e-02 -1.05497444e+00]
mat_Sqrt:  [[35.86208306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01062183  0.08199731 -0.53928502]
Stock Position:  -0.010621833197638852
Bond Position:  [8.75749113]


portfolio before change:  [7.69109954]
curr_Stock_Price:  100.60233581885416
curr_Factors:  [ 1.00602336e+02 -8.79888104e-02 -1.07601293e+00]
mat_Sqrt:  [[31.41148964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00294462  0.00465545 -0.16760728]
Stock Position:  0.002944623141011114
Bond Position:  [7.39486358]


portfolio before change:  [7.69727559]
curr_Stock_Price:  102.07182794340181
curr_Factors:  [102.07182794  -0.29307178  -1.04640827]
mat_Sqrt:  [[26.74096655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00042567  0.01600759 -0.02982825]
Stock Position:  0.00042566581130893
Bond Position:  [7.6538271]


portfolio before change:  [7.70103402]
curr_Stock_Price:  106.40558104470334
curr_Factors:  [106.40558104  -0.28549668  -1.07774279]
mat_Sqrt:  [[27.22181191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00906802 0.07588581 0.06168071]
Stock Position:  0.009068015311804024
Bond Position:  [6.73614658]


portfolio before change:  [7.71304581]
curr_Stock_Price:  107.54447969602118
curr_Factors:  [107.5444797   -0.85322836  -1.05649094]
mat_Sqrt:  [[15.92969901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00715865  0.34374962 -1.80570871]
Stock Position:  0.007158654307668276
Bond Position:  [6.94317206]


portfolio before change:  [7.71468788]
curr_Stock_Price:  107.53135635851868
curr_Factors:  [107.53135636  -1.06576505  -1.01869525]
mat_Sqrt:  [[13.37412932  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01075354 -0.03348983  0.02980898]
Stock Position:  0.010753544512374544
Bond Position:  [6.55834465]


portfolio before change:  [7.71438056]
curr_Stock_Price:  107.3502900605716
curr_Factors:  [107.35029006  -1.029892    -1.03313278]
mat_Sqrt:  [[13.64089743  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00171065 -0.01206789 -0.41100703]
Stock Position:  -0.0017106477415824984
Bond Position:  [7.8980191]


portfolio before change:  [7.71364084]
curr_Stock_Price:  108.93710146643416
curr_Factors:  [108.93710147  -0.8984431   -1.04312509]
mat_Sqrt:  [[15.63016147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00392688  0.00550625  0.15074105]
Stock Position:  -0.003926880468227869
Bond Position:  [8.14142382]


portfolio before change:  [7.71626745]
curr_Stock_Price:  108.78659942729678
curr_Factors:  [108.78659943  -0.85770898  -1.04180802]
mat_Sqrt:  [[16.27892232  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072077 -0.07731196 -0.08976392]
Stock Position:  -0.000720772880441053
Bond Position:  [7.79467789]


portfolio before change:  [7.71778725]
curr_Stock_Price:  109.38195524859555
curr_Factors:  [109.38195525  -0.94329161  -0.98422012]
mat_Sqrt:  [[15.91614817  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01468355 -0.00392326 -0.17260395]
Stock Position:  -0.01468355318531324
Bond Position:  [9.32390301]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.72845326]
Stock Price:  108.81433107580716
PL:  [-1.08587782]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-6.21952928e-02  1.26665909e-01  2.07836861e-02]
 [ 5.84373293e-03 -6.68400688e-03  6.36940970e-02]
 [-7.21787381e-02  2.64680376e-02 -5.50188926e-03]
 [-1.64810372e-01 -1.36525814e-01  5.85992159e-01]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-5.52844801e-01  5.23748437e-01 -3.84565576e-02]
 [ 1.15035407e-02 -9.10941869e-03  3.57704178e-02]
 [-9.29290433e-02 -2.04453779e-02 -1.94583244e-02]
 [ 8.65937767e-02  3.00765197e-02  5.91881038e-02]
 [-1.47906815e-01  1.94770213e-01 -6.32527718e-02]
 [ 1.95903066e-02  4.03916057e-02 -5.33194550e-02]
 [ 8.41595513e-02  5.29218131e-03 -2.67154623e-02]
 [ 8.91921659e-02  2.37805480e-02 -4.66502749e-02]
 [ 1.99128593e-02  8.30380372e-01 -5.22616890e-01]
 [ 1.46891768e-01 -6.23379167e-02 -5.22565575e-03]
 [ 1.70426783e-02 -3.18989916e-02 -1.00075106e-01]
 [-7.47141373e-02  1.71657227e-02  5.25139267e-02]
 [ 5.19349488e-02 -3.29903100e-01 -1.87283309e-02]
 [-2.42971887e-01 -7.88367107e-02 -1.35469706e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.7515711]
curr_Stock_Price:  99.3644752818808
curr_Factors:  [99.36447528 -1.19772939 -1.02125215]
mat_Sqrt:  [[10.80288375  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297118  0.04088125  0.05929007]
Stock Position:  -0.0029711761333257977
Bond Position:  [-2.45634174]


portfolio before change:  [-2.75139808]
curr_Stock_Price:  99.09953587532489
curr_Factors:  [99.09953588 -1.25171551 -0.96093939]
mat_Sqrt:  [[10.84245944  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00161226 -0.00215725  0.18170153]
Stock Position:  0.0016122604780474082
Bond Position:  [-2.91117234]


portfolio before change:  [-2.75057876]
curr_Stock_Price:  100.05918596825785
curr_Factors:  [100.05918597  -1.3377058   -0.9693045 ]
mat_Sqrt:  [[ 9.9617381   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00681598  0.00854252 -0.01569536]
Stock Position:  -0.0068159833531874535
Bond Position:  [-2.06857701]


portfolio before change:  [-2.7545992]
curr_Stock_Price:  100.57316023170465
curr_Factors:  [100.57316023  -1.21482298  -0.98996484]
mat_Sqrt:  [[11.09059663  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00658787 -0.04406352  1.67167252]
Stock Position:  -0.006587872660603136
Bond Position:  [-2.09203603]


portfolio before change:  [-2.75372923]
curr_Stock_Price:  100.3617044031495
curr_Factors:  [100.3617044   -1.65449511  -0.93429939]
mat_Sqrt:  [[ 7.53822093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00753459 -0.04522423  0.24245377]
Stock Position:  0.007534587091683128
Bond Position:  [-3.50991324]


portfolio before change:  [-2.7557326]
curr_Stock_Price:  100.21228998690016
curr_Factors:  [100.21228999  -1.80245441  -0.9240629 ]
mat_Sqrt:  [[ 6.55857614  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06918956  0.16903908 -0.10970585]
Stock Position:  -0.0691895620629902
Bond Position:  [4.17791186]


portfolio before change:  [-2.7923712]
curr_Stock_Price:  100.75692720426127
curr_Factors:  [100.7569272   -1.64398911  -0.98358639]
mat_Sqrt:  [[ 7.28003344  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00232769 -0.00294005  0.10204305]
Stock Position:  0.0023276945718743
Bond Position:  [-3.02690255]


portfolio before change:  [-2.79341908]
curr_Stock_Price:  100.63188415723224
curr_Factors:  [100.63188416  -1.76641967  -0.97756771]
mat_Sqrt:  [[ 6.47197794  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01561723 -0.00659872 -0.05550918]
Stock Position:  -0.015617227587501914
Bond Position:  [-1.22182805]


portfolio before change:  [-2.78682209]
curr_Stock_Price:  100.1899051858737
curr_Factors:  [100.18990519  -1.26332394  -0.95419416]
mat_Sqrt:  [[10.90857673  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00960848 0.00970715 0.16884719]
Stock Position:  0.009608480027297337
Bond Position:  [-3.74949479]


portfolio before change:  [-2.78286229]
curr_Stock_Price:  100.6995895537427
curr_Factors:  [100.69958955  -0.81397299  -0.96652805]
mat_Sqrt:  [[16.97328578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00713244  0.06286182 -0.18044255]
Stock Position:  -0.00713243923233701
Bond Position:  [-2.06462859]


portfolio before change:  [-2.78459346]
curr_Stock_Price:  100.86993121609764
curr_Factors:  [100.86993122  -0.63757445  -0.95679677]
mat_Sqrt:  [[20.48024286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0008277   0.01303633 -0.15210556]
Stock Position:  0.0008276962607898352
Bond Position:  [-2.86808313]


portfolio before change:  [-2.7851605]
curr_Stock_Price:  101.05124189711479
curr_Factors:  [101.0512419   -0.51522341  -0.97020972]
mat_Sqrt:  [[22.87843132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00348741  0.00170804 -0.07621178]
Stock Position:  0.003487413154059842
Bond Position:  [-3.13756793]


portfolio before change:  [-2.77689824]
curr_Stock_Price:  103.64535664307792
curr_Factors:  [103.64535664  -0.56421742  -0.98001176]
mat_Sqrt:  [[22.12583355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00382015  0.00767514 -0.13308025]
Stock Position:  0.0038201454566534235
Bond Position:  [-3.17283858]


portfolio before change:  [-2.77355067]
curr_Stock_Price:  104.72931582825512
curr_Factors:  [104.72931583  -0.73069525  -0.99684565]
mat_Sqrt:  [[18.61258889  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0044451   0.26800411 -1.49088052]
Stock Position:  0.004445099890792665
Bond Position:  [-3.23908294]


portfolio before change:  [-2.77227447]
curr_Stock_Price:  105.19861213315764
curr_Factors:  [105.19861213  -0.65520449  -0.98054359]
mat_Sqrt:  [[20.49338249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0064948  -0.02011948 -0.01490734]
Stock Position:  0.00649479956565292
Bond Position:  [-3.45551837]


portfolio before change:  [-2.76559323]
curr_Stock_Price:  106.36034693696627
curr_Factors:  [106.36034694  -0.61451614  -1.00051699]
mat_Sqrt:  [[21.15337993  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046784 -0.01029536 -0.28548642]
Stock Position:  -0.00046784114946950685
Bond Position:  [-2.71583348]


portfolio before change:  [-2.76718834]
curr_Stock_Price:  108.3184241348769
curr_Factors:  [108.31842413  -0.29965649  -1.01363974]
mat_Sqrt:  [[29.13030484  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207656  0.00554021  0.14980762]
Stock Position:  -0.002076560431757371
Bond Position:  [-2.54225859]


portfolio before change:  [-2.77525001]
curr_Stock_Price:  111.89454352444726
curr_Factors:  [111.89454352  -0.32269257  -1.04553013]
mat_Sqrt:  [[28.48376152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00067509 -0.10647577 -0.05342672]
Stock Position:  -0.0006750914554245808
Bond Position:  [-2.69971096]


portfolio before change:  [-2.77714679]
curr_Stock_Price:  113.70432855590484
curr_Factors:  [113.70432856  -0.33649897  -0.99502668]
mat_Sqrt:  [[30.02636455  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00954884 -0.02544444 -0.38645736]
Stock Position:  -0.009548841661053124
Bond Position:  [-1.69140216]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.78852305]
Stock Price:  114.85141507646247
PL:  [-17.63993812]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-6.72552804e-02  1.41270964e-01  1.75578756e-02]
 [ 1.26517727e-02  1.75189013e-02 -3.07910384e-02]
 [ 1.39415417e-01 -1.90455936e-02  1.59299953e-01]
 [-1.34268317e-02 -2.04804748e-03  6.36621780e-02]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-1.21664618e+00  1.12686642e+00 -1.45204561e-01]
 [-4.05235162e-03  2.02088404e-02 -1.16732785e-02]
 [-9.27711779e-02 -1.92602356e-02 -2.20566444e-02]
 [-3.24652157e-02  1.84974913e-02  5.57003482e-02]
 [-8.72054811e-01  3.59389710e-01 -4.44139966e-01]
 [ 1.46329634e-01  4.94904986e-02 -5.57540514e-02]
 [-6.29891187e-02  1.37431247e-01  7.51766959e-02]
 [ 6.22472749e-03 -9.17519501e-02 -6.99153060e-02]
 [ 1.99166573e-02  7.10692857e-01 -4.60130044e-01]
 [ 1.26692329e-01 -6.08011262e-02 -2.40194373e-02]
 [ 3.21717624e-02  2.53336311e-03 -5.12382660e-02]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.14777500e-02 -1.37200150e-01 -3.99145314e-02]
 [-1.33960699e-01  5.24219574e-02 -1.10825397e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.7791213]
curr_Stock_Price:  99.48706391178895
curr_Factors:  [99.48706391 -0.96957375 -0.96212473]
mat_Sqrt:  [[14.41586224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0024164   0.04559501  0.05008773]
Stock Position:  -0.0024163992925804647
Bond Position:  [-1.53872083]


portfolio before change:  [-1.77831411]
curr_Stock_Price:  98.99380270760699
curr_Factors:  [98.99380271 -0.97167131 -0.95838711]
mat_Sqrt:  [[14.36793259  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.000692    0.0056542  -0.08783826]
Stock Position:  0.0006919999801588962
Bond Position:  [-1.84681782]


portfolio before change:  [-1.78002132]
curr_Stock_Price:  97.19403452382134
curr_Factors:  [97.19403452 -1.29731667 -0.96588117]
mat_Sqrt:  [[10.1098631   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01662186 -0.00614694  0.45443842]
Stock Position:  0.016621858887809305
Bond Position:  [-3.39556684]


portfolio before change:  [-1.77934038]
curr_Stock_Price:  97.28607776798326
curr_Factors:  [97.28607777 -0.88382602 -0.95141069]
mat_Sqrt:  [[15.5244964   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.47457325e-05 -6.61004482e-04  1.81610474e-01]
Stock Position:  -5.474573245193477e-05
Bond Position:  [-1.77401439]


portfolio before change:  [-1.77977013]
curr_Stock_Price:  97.03381851658496
curr_Factors:  [97.03381852 -0.8609192  -0.96399236]
mat_Sqrt:  [[15.64494733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0036304  -0.04522423  0.24245377]
Stock Position:  0.0036303977840478675
Bond Position:  [-2.13204149]


portfolio before change:  [-1.78230443]
curr_Stock_Price:  96.48257715527782
curr_Factors:  [96.48257716 -0.76991457 -0.98110683]
mat_Sqrt:  [[16.74904168  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06067603  0.36369457 -0.4142282 ]
Stock Position:  -0.06067602648402006
Bond Position:  [4.07187497]


portfolio before change:  [-2.00173176]
curr_Stock_Price:  100.11573240871574
curr_Factors:  [100.11573241  -0.96118039  -1.03278403]
mat_Sqrt:  [[13.6312155   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00016947  0.00652238 -0.03330061]
Stock Position:  -0.00016946671776819824
Bond Position:  [-1.98476548]


portfolio before change:  [-2.00237262]
curr_Stock_Price:  100.96903583400048
curr_Factors:  [100.96903583  -1.11559704  -1.03277797]
mat_Sqrt:  [[11.78042058  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00859095 -0.00621621 -0.06292147]
Stock Position:  -0.008590945460394838
Bond Position:  [-1.13495314]


portfolio before change:  [-2.01901526]
curr_Stock_Price:  102.87323356633453
curr_Factors:  [102.87323357  -0.81431539  -1.07753742]
mat_Sqrt:  [[15.51247725  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0011165   0.00597004  0.15889759]
Stock Position:  -0.0011164976997346343
Bond Position:  [-1.90415753]


portfolio before change:  [-2.02108226]
curr_Stock_Price:  104.29813768854478
curr_Factors:  [104.29813769  -0.78583324  -1.12743959]
mat_Sqrt:  [[15.39404401  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05777263  0.11599253 -1.2670077 ]
Stock Position:  -0.0577726284089026
Bond Position:  [4.0044953]


portfolio before change:  [-2.02009328]
curr_Stock_Price:  104.29835004897693
curr_Factors:  [104.29835005  -0.97743488  -1.12416973]
mat_Sqrt:  [[12.75152584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01137519  0.01597299 -0.15905079]
Stock Position:  0.011375194932526013
Bond Position:  [-3.20650734]


portfolio before change:  [-2.01720394]
curr_Stock_Price:  104.62283348317122
curr_Factors:  [104.62283348  -0.87922773  -1.11295683]
mat_Sqrt:  [[14.27025439  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137283  0.04435574  0.21445819]
Stock Position:  -0.0013728349514802484
Bond Position:  [-1.87357406]


portfolio before change:  [-2.01671421]
curr_Stock_Price:  103.9248716956497
curr_Factors:  [103.9248717   -0.9849508   -1.10645808]
mat_Sqrt:  [[12.83607246  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208595 -0.02961281 -0.19944891]
Stock Position:  -0.002085954489587043
Bond Position:  [-1.79993165]


portfolio before change:  [-2.01761363]
curr_Stock_Price:  104.14030620727534
curr_Factors:  [104.14030621  -0.56449932  -1.11310327]
mat_Sqrt:  [[19.45563027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00365255  0.22937513 -1.31262294]
Stock Position:  0.0036525456313538716
Bond Position:  [-2.39799085]


portfolio before change:  [-2.01636425]
curr_Stock_Price:  104.64651592593373
curr_Factors:  [104.64651593  -0.39426913  -1.10953252]
mat_Sqrt:  [[23.26119466  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00470218 -0.01962348 -0.06852077]
Stock Position:  0.004702183419979788
Bond Position:  [-2.50843136]


portfolio before change:  [-2.02095765]
curr_Stock_Price:  103.80303169103335
curr_Factors:  [103.80303169  -0.53971864  -1.12564574]
mat_Sqrt:  [[19.6314094   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00113236  0.00081764 -0.14616851]
Stock Position:  0.0011323647344590741
Bond Position:  [-2.13850055]


portfolio before change:  [-2.02382276]
curr_Stock_Price:  101.7450251441554
curr_Factors:  [101.74502514  -0.38729441  -1.10439747]
mat_Sqrt:  [[22.89178365  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.003005    0.00525786  0.16709793]
Stock Position:  -0.0030050002648177804
Bond Position:  [-1.71807893]


portfolio before change:  [-2.02494793]
curr_Stock_Price:  101.97650494738738
curr_Factors:  [101.97650495  -0.62592283  -1.10329984]
mat_Sqrt:  [[18.09290315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00029428 -0.04428116 -0.11386505]
Stock Position:  0.00029427930518859807
Bond Position:  [-2.05495751]


portfolio before change:  [-2.02531266]
curr_Stock_Price:  102.48307018589787
curr_Factors:  [102.48307019  -0.73183435  -1.11577289]
mat_Sqrt:  [[16.15275114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00777096  0.01691911 -0.0316154 ]
Stock Position:  -0.007770956466202167
Bond Position:  [-1.22892119]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.03301871]
Stock Price:  103.43517621815671
PL:  [-5.46819492]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-6.31678199e-02  1.31463772e-01  1.99260803e-02]
 [ 1.51125180e-02  2.65290212e-02 -8.56387682e-02]
 [ 1.32964792e-01 -4.51473503e-03  6.03568795e-02]
 [-1.06484587e-01 -7.08244356e-02  2.92251259e-01]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-1.42631284e+00  1.36900795e+00 -1.94058439e-01]
 [-1.77415999e-02 -7.66903624e-03 -3.46576125e-02]
 [-7.91597979e-03  5.02742306e-02 -8.24924108e-02]
 [ 7.88642511e-02  3.08047060e-02  6.02129785e-02]
 [ 7.06976981e-02  1.44924906e-01  5.15580109e-02]
 [ 7.45571686e-02  3.14316730e-02 -5.22428045e-02]
 [-4.12027831e-02  1.48892575e-01  2.31903622e-02]
 [-1.45296053e-01 -1.04848395e-01 -2.41250223e-02]
 [ 2.73973263e-02  4.69568141e-01 -3.05216842e-01]
 [-2.62479081e-02 -2.37643203e-01 -5.97664242e-02]
 [ 6.43005503e-02  4.85039600e-02  1.95480352e-01]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.05928352e-02 -1.38592884e-01 -4.22957777e-02]
 [-1.01721508e-01  1.50851807e-01 -6.39143328e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.23019109]
curr_Stock_Price:  99.43020130743174
curr_Factors:  [99.43020131 -1.11120477 -0.98833728]
mat_Sqrt:  [[12.18144453  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264874  0.04242975  0.05684356]
Stock Position:  -0.0026487413341651847
Bond Position:  [-1.96682621]


portfolio before change:  [-2.22904582]
curr_Stock_Price:  98.81215398630792
curr_Factors:  [98.81215399 -0.72565425 -0.99791824]
mat_Sqrt:  [[17.63081321  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.72810603e-04  8.56220477e-03 -2.44303568e-01]
Stock Position:  0.00017281060268217914
Bond Position:  [-2.2461216]


portfolio before change:  [-2.2298499]
curr_Stock_Price:  97.40898092849073
curr_Factors:  [97.40898093 -0.60116872 -0.95555533]
mat_Sqrt:  [[20.53630649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00702967 -0.00145712  0.17218138]
Stock Position:  0.007029673140520597
Bond Position:  [-2.9146032]


portfolio before change:  [-2.22940538]
curr_Stock_Price:  97.57588235161892
curr_Factors:  [97.57588235 -0.692574   -0.92907362]
mat_Sqrt:  [[19.27835059  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00317901 -0.02285849  0.8337115 ]
Stock Position:  -0.003179007767503308
Bond Position:  [-1.91921089]


portfolio before change:  [-2.22925542]
curr_Stock_Price:  97.37776322192832
curr_Factors:  [97.37776322 -0.98419616 -0.96095041]
mat_Sqrt:  [[13.92173524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00407976 -0.04522423  0.24245377]
Stock Position:  0.004079763127630006
Bond Position:  [-2.62653363]


portfolio before change:  [-2.23107823]
curr_Stock_Price:  97.09193986962657
curr_Factors:  [97.09193987 -0.36255429 -0.97795706]
mat_Sqrt:  [[25.41010707  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04669312  0.44184542 -0.55359471]
Stock Position:  -0.046693123797227606
Bond Position:  [2.30244774]


portfolio before change:  [-2.25609702]
curr_Stock_Price:  97.64008220624335
curr_Factors:  [97.64008221 -0.68221849 -0.98467597]
mat_Sqrt:  [[18.43762896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00143085 -0.00247517 -0.09886852]
Stock Position:  -0.0014308505140292619
Bond Position:  [-2.11638866]


portfolio before change:  [-2.25770279]
curr_Stock_Price:  98.3925050079874
curr_Factors:  [98.39250501 -1.01920081 -0.95361767]
mat_Sqrt:  [[13.68288999  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00105917  0.01622594 -0.23532789]
Stock Position:  -0.0010591686612921002
Bond Position:  [-2.15348853]


portfolio before change:  [-2.26005457]
curr_Stock_Price:  100.10455231460257
curr_Factors:  [100.10455231  -1.44089742  -0.95563986]
mat_Sqrt:  [[ 9.1127806   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01069302 0.00994218 0.17177087]
Stock Position:  0.010693021413983591
Bond Position:  [-3.3304747]


portfolio before change:  [-2.26655063]
curr_Stock_Price:  99.574923147726
curr_Factors:  [99.57492315 -0.98983282 -0.93205978]
mat_Sqrt:  [[14.57077424  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00760458 0.04677431 0.14708065]
Stock Position:  0.00760457912323841
Bond Position:  [-3.02377601]


portfolio before change:  [-2.25750847]
curr_Stock_Price:  100.86338419820453
curr_Factors:  [100.8633842   -0.94391442  -0.94385277]
mat_Sqrt:  [[15.27167462  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00460389  0.01014453 -0.14903418]
Stock Position:  0.004603890270428384
Bond Position:  [-2.72187242]


portfolio before change:  [-2.26070013]
curr_Stock_Price:  100.31795153309095
curr_Factors:  [100.31795153  -1.0072153   -0.90419819]
mat_Sqrt:  [[14.83413834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00040963  0.04805487  0.06615565]
Stock Position:  -0.0004096294987630073
Bond Position:  [-2.21960694]


portfolio before change:  [-2.26128819]
curr_Stock_Price:  100.39871311563687
curr_Factors:  [100.39871312  -0.77113141  -0.8983293 ]
mat_Sqrt:  [[18.90995823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00907578 -0.03383967 -0.06882197]
Stock Position:  -0.009075781087876286
Bond Position:  [-1.35009144]


portfolio before change:  [-2.25578738]
curr_Stock_Price:  99.75542220986743
curr_Factors:  [99.75542221 -0.71048774 -0.92554197]
mat_Sqrt:  [[19.42754093  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00313706  0.15155247 -0.8706987 ]
Stock Position:  0.00313706170217644
Bond Position:  [-2.5687263]


portfolio before change:  [-2.25426891]
curr_Stock_Price:  100.44419757824045
curr_Factors:  [100.44419758  -0.91347789  -0.88309478]
mat_Sqrt:  [[16.6603168   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00521937 -0.07669901 -0.17049697]
Stock Position:  -0.005219372177159782
Bond Position:  [-1.73001326]


portfolio before change:  [-2.25903359]
curr_Stock_Price:  101.27420486366503
curr_Factors:  [101.27420486  -1.17409411  -0.84559636]
mat_Sqrt:  [[13.43873571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00849065 0.01565459 0.55765103]
Stock Position:  0.00849065283005971
Bond Position:  [-3.1189177]


portfolio before change:  [-2.25052793]
curr_Stock_Price:  102.36781706714174
curr_Factors:  [102.36781707  -1.34688255  -0.85948441]
mat_Sqrt:  [[11.27068851  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00610343  0.00525786  0.16709793]
Stock Position:  -0.006103426235761431
Bond Position:  [-1.62573351]


portfolio before change:  [-2.2505573]
curr_Stock_Price:  102.30602854999417
curr_Factors:  [102.30602855  -1.43609536  -0.86918467]
mat_Sqrt:  [[10.20306909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00035961 -0.04473066 -0.12065808]
Stock Position:  0.00035960667978140955
Bond Position:  [-2.28734723]


portfolio before change:  [-2.25144954]
curr_Stock_Price:  101.41524834053332
curr_Factors:  [101.41524834  -1.35596446  -0.88081338]
mat_Sqrt:  [[10.8313599   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00666894  0.04868721 -0.01823298]
Stock Position:  -0.00666893711211977
Bond Position:  [-1.57511762]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.2491204]
Stock Price:  101.0069419820211
PL:  [-3.25606238]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.59302641e-01  2.53267642e-01 -2.27804476e-02]
 [-1.63478424e-02 -8.31291600e-02  1.78422844e-01]
 [ 1.04931410e-01 -3.99526156e-02  2.72015774e-02]
 [-9.52709223e-02 -4.20437563e-02  2.70213380e-01]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-1.08185163e+00  1.05099297e+00 -1.37901598e-01]
 [-1.70936240e-03 -2.04609652e-02 -7.61586272e-04]
 [ 3.06424045e-03  4.73094697e-02 -6.97348396e-02]
 [ 4.57134793e-02  2.55842663e-02  4.04316363e-02]
 [ 1.52314954e-01  1.18858810e-01  8.29327824e-02]
 [-5.62902211e-02  3.62671961e-04 -3.43418038e-02]
 [-3.09951146e-02  1.54262612e-01 -1.16707299e-03]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-6.30541503e-04  1.45318049e-01 -1.31245381e-01]
 [-2.24449583e-02 -1.30974701e-01 -5.30518770e-02]
 [ 5.50434458e-02  6.01603570e-02 -4.12050636e-02]
 [ 1.39768847e-01 -1.22838251e-01  1.61804815e-01]
 [-1.30936877e-01  1.18874992e-01  1.36130564e-01]
 [ 1.56320963e-01  1.37914313e-02 -3.18652109e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.16673109]
curr_Stock_Price:  98.05152298400024
curr_Factors:  [98.05152298 -0.86335188 -1.01755492]
mat_Sqrt:  [[14.94813109  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00750961  0.08174178 -0.06498628]
Stock Position:  -0.007509610308272108
Bond Position:  [-12.43040236]


portfolio before change:  [-13.17038178]
curr_Stock_Price:  98.12378998715197
curr_Factors:  [98.12378999 -0.98853748 -1.02040252]
mat_Sqrt:  [[13.1614202   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.35833162e-04 -2.68298210e-02  5.08990710e-01]
Stock Position:  0.0002358331623787499
Bond Position:  [-13.19352262]


portfolio before change:  [-13.17367023]
curr_Stock_Price:  98.16764049841005
curr_Factors:  [98.1676405  -1.0298038  -0.98964737]
mat_Sqrt:  [[13.02962319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00785354 -0.01289465  0.07759853]
Stock Position:  0.007853536049731174
Bond Position:  [-13.94463333]


portfolio before change:  [-13.17283484]
curr_Stock_Price:  98.71796400039644
curr_Factors:  [98.717964   -1.19527126 -0.98588707]
mat_Sqrt:  [[11.1463112   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0043688  -0.01356956  0.77084356]
Stock Position:  -0.0043687989759042594
Bond Position:  [-12.7415559]


portfolio before change:  [-13.17637024]
curr_Stock_Price:  98.7979903087711
curr_Factors:  [98.79799031 -1.18398321 -0.98643563]
mat_Sqrt:  [[11.27579527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00503711 -0.04522423  0.24245377]
Stock Position:  0.005037106541166136
Bond Position:  [-13.67402625]


portfolio before change:  [-13.1804748]
curr_Stock_Price:  98.66187616224717
curr_Factors:  [98.66187616 -1.03609881 -0.99402689]
mat_Sqrt:  [[12.95618027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0691151   0.33920652 -0.39339487]
Stock Position:  -0.06911509504270649
Bond Position:  [-6.36144985]


portfolio before change:  [-13.14239811]
curr_Stock_Price:  98.08794588866475
curr_Factors:  [98.08794589 -0.88412957 -0.98239476]
mat_Sqrt:  [[15.17030888  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039824 -0.00660375 -0.00217259]
Stock Position:  -0.00039823827162796153
Bond Position:  [-13.10333574]


portfolio before change:  [-13.14571878]
curr_Stock_Price:  98.19948676646872
curr_Factors:  [98.19948677 -0.93690575 -0.96746831]
mat_Sqrt:  [[14.62345766  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.03485717e-04  1.52690657e-02 -1.98934087e-01]
Stock Position:  -0.0001034857171116163
Bond Position:  [-13.13555653]


portfolio before change:  [-13.1487481]
curr_Stock_Price:  95.73562994878476
curr_Factors:  [95.73562995 -0.8232628  -0.96410418]
mat_Sqrt:  [[16.02617876  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00369326 0.00825729 0.1153402 ]
Stock Position:  0.003693264620550207
Bond Position:  [-13.50232512]


portfolio before change:  [-13.15520353]
curr_Stock_Price:  94.90183640341444
curr_Factors:  [94.9018364  -1.08048507 -0.94798174]
mat_Sqrt:  [[12.48310641  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01550139 0.03836152 0.23658414]
Stock Position:  0.015501389167749723
Bond Position:  [-14.62631383]


portfolio before change:  [-13.17014194]
curr_Stock_Price:  94.17407094796445
curr_Factors:  [94.17407095 -1.02600236 -0.93058489]
mat_Sqrt:  [[13.31055909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00475008  0.00011705 -0.09796761]
Stock Position:  -0.004750077132332954
Bond Position:  [-12.72280784]


portfolio before change:  [-13.1709026]
curr_Stock_Price:  93.66451420951825
curr_Factors:  [93.66451421 -0.83690527 -0.92841469]
mat_Sqrt:  [[16.02899768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.59324615e-05  4.97880439e-02 -3.32933439e-03]
Stock Position:  1.5932461543339987e-05
Bond Position:  [-13.17239491]


portfolio before change:  [-13.17419113]
curr_Stock_Price:  93.97735589612711
curr_Factors:  [93.9773559  -0.70102367 -0.90436591]
mat_Sqrt:  [[18.87171587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00089346 -0.00995959  0.34984664]
Stock Position:  0.0008934600079763029
Bond Position:  [-13.25815614]


portfolio before change:  [-13.1747854]
curr_Stock_Price:  97.02246442033149
curr_Factors:  [97.02246442 -0.73475833 -0.96984032]
mat_Sqrt:  [[17.64308461  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.27076972e-04  4.69011985e-02 -3.74406540e-01]
Stock Position:  0.00012707697160764696
Bond Position:  [-13.18711472]


portfolio before change:  [-13.17835362]
curr_Stock_Price:  94.8896839961658
curr_Factors:  [94.889684   -0.75815936 -0.94914908]
mat_Sqrt:  [[17.2085534   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00348717 -0.0422719  -0.15134224]
Stock Position:  -0.0034871743587491927
Bond Position:  [-12.84745675]


portfolio before change:  [-13.17664872]
curr_Stock_Price:  93.47961209333837
curr_Factors:  [93.47961209 -0.7614108  -0.90899925]
mat_Sqrt:  [[17.59004824  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00334921  0.01941667 -0.11754658]
Stock Position:  0.003349205076755265
Bond Position:  [-13.48973111]


portfolio before change:  [-13.17935941]
curr_Stock_Price:  93.67731801453043
curr_Factors:  [93.67731801 -0.39869212 -0.88183591]
mat_Sqrt:  [[26.03203922  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00567466 -0.03964588  0.4615841 ]
Stock Position:  0.005674655837749315
Bond Position:  [-13.71094595]


portfolio before change:  [-13.18415651]
curr_Stock_Price:  93.43608200366072
curr_Factors:  [93.436082   -0.5375752  -0.83334231]
mat_Sqrt:  [[23.72098448  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0033255   0.03836674  0.38834261]
Stock Position:  -0.0033254979637693358
Bond Position:  [-12.87343501]


portfolio before change:  [-13.18289163]
curr_Stock_Price:  92.08781870030256
curr_Factors:  [92.0878187  -0.99993064 -0.79591352]
mat_Sqrt:  [[15.28540597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00615565  0.00445117 -0.90902577]
Stock Position:  0.006155645308014576
Bond Position:  [-13.74975157]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.18307197]
Stock Price:  92.61701104639853
PL:  [-13.18307197]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 4.69661302e-02 -9.66574613e-02  5.64502944e-02]
 [ 2.49346398e-02  1.51490373e-01 -1.95061373e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-2.33846819e-01 -2.25938987e-01  8.47600165e-01]
 [-5.96190350e-02  4.83553184e-02 -4.19543769e-02]
 [-1.09288178e+00  1.12180461e+00 -1.58861689e-01]
 [ 2.96298746e-03  6.94287682e-03  9.81830061e-03]
 [ 2.05129090e-02  1.21825828e-02 -1.46178950e-02]
 [ 8.57804585e-02  2.52774623e-02  4.08998428e-02]
 [ 1.54910500e-01  1.21777447e-01  9.13024879e-02]
 [ 4.79432812e-02  3.09464519e-02 -5.19670986e-02]
 [-6.44824930e-02  1.36645615e-01  7.87401706e-02]
 [-1.61651616e-01 -1.20396958e-01  3.68724940e-03]
 [ 3.94196363e-02  4.97702297e-01 -2.89003075e-01]
 [-3.36574066e-03 -2.04480048e-01 -5.65819935e-02]
 [ 3.56913447e-02 -2.26483172e-02  5.72871722e-02]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.91550226e-02 -1.78946224e-01 -3.46634049e-02]
 [-1.03105970e-01  1.29286360e-01 -3.29150614e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.46062009]
curr_Stock_Price:  101.53427257515138
curr_Factors:  [101.53427258  -1.16466452  -0.98621151]
mat_Sqrt:  [[11.81677777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00327999 -0.03119606  0.16103698]
Stock Position:  0.003279986928448859
Bond Position:  [14.127589]


portfolio before change:  [14.46408007]
curr_Stock_Price:  101.5122145216751
curr_Factors:  [101.51221452  -1.01742321  -1.01754305]
mat_Sqrt:  [[13.26611283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120915  0.04889331 -0.5564558 ]
Stock Position:  0.0012091519921775553
Bond Position:  [14.34133638]


portfolio before change:  [14.46714279]
curr_Stock_Price:  101.07962568071625
curr_Factors:  [101.07962568  -0.94672027  -1.00284168]
mat_Sqrt:  [[14.3873109   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00542302  0.01370813 -0.02999186]
Stock Position:  -0.005423024428354099
Bond Position:  [15.01530007]


portfolio before change:  [14.47030367]
curr_Stock_Price:  101.18904992084492
curr_Factors:  [101.18904992  -0.9717649   -0.97937585]
mat_Sqrt:  [[14.38016463  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00743738 -0.07292149  2.41796735]
Stock Position:  -0.007437380933842305
Bond Position:  [15.22288519]


portfolio before change:  [14.48144379]
curr_Stock_Price:  100.20296146751485
curr_Factors:  [100.20296147  -0.65583556  -0.96065771]
mat_Sqrt:  [[19.89969637  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00293032  0.01560661 -0.11968416]
Stock Position:  -0.002930318492854365
Bond Position:  [14.77507038]


portfolio before change:  [14.48375977]
curr_Stock_Price:  100.6733012822535
curr_Factors:  [100.67330128  -0.93654943  -0.96585648]
mat_Sqrt:  [[15.02138306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05966973  0.36206088 -0.45318818]
Stock Position:  -0.0596697303522598
Bond Position:  [20.49090851]


portfolio before change:  [14.48921222]
curr_Stock_Price:  100.6677862619166
curr_Factors:  [100.66778626  -0.66697421  -1.00569734]
mat_Sqrt:  [[18.89985587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0003378  0.0022408  0.02800888]
Stock Position:  0.0003377987918663558
Bond Position:  [14.45520676]


portfolio before change:  [14.49169417]
curr_Stock_Price:  97.31578261018959
curr_Factors:  [97.31578261 -1.10425249 -0.99046951]
mat_Sqrt:  [[11.98000706  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00167077  0.00393191 -0.04170079]
Stock Position:  0.0016707672088761875
Bond Position:  [14.32910215]


portfolio before change:  [14.4964403]
curr_Stock_Price:  98.01211311770108
curr_Factors:  [98.01211312 -0.90509531 -1.0106225 ]
mat_Sqrt:  [[14.43092199  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00688028 0.00815827 0.11667587]
Stock Position:  0.006880284186964126
Bond Position:  [13.82208911]


portfolio before change:  [14.49832215]
curr_Stock_Price:  97.78332825538452
curr_Factors:  [97.78332826 -0.75060576 -0.97500946]
mat_Sqrt:  [[17.41163877  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01139498 0.0393035  0.26046058]
Stock Position:  0.011394979095648234
Bond Position:  [13.38408317]


portfolio before change:  [14.50712218]
curr_Stock_Price:  98.26192462659877
curr_Factors:  [98.26192463 -1.05116821 -0.99884191]
mat_Sqrt:  [[12.64961137  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00345089  0.00998792 -0.14824767]
Stock Position:  0.0034508933412333476
Bond Position:  [14.16803076]


portfolio before change:  [14.51890523]
curr_Stock_Price:  100.64988447540469
curr_Factors:  [100.64988448  -1.1513811   -1.01998421]
mat_Sqrt:  [[11.47628459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00178778  0.04410218  0.22462379]
Stock Position:  -0.0017877783937596612
Bond Position:  [14.69884492]


portfolio before change:  [14.52150551]
curr_Stock_Price:  101.2511272787883
curr_Factors:  [101.25112728  -1.13896835  -1.04067144]
mat_Sqrt:  [[11.44970602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0161991  -0.03885795  0.0105187 ]
Stock Position:  -0.016199095907319383
Bond Position:  [16.16168223]


portfolio before change:  [14.54203915]
curr_Stock_Price:  100.2330015288071
curr_Factors:  [100.23300153  -1.18051794  -1.06744396]
mat_Sqrt:  [[10.58603408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00774796  0.16063273 -0.82444533]
Stock Position:  0.007747961711926727
Bond Position:  [13.76543769]


portfolio before change:  [14.54917437]
curr_Stock_Price:  100.70969793025112
curr_Factors:  [100.70969793  -1.02704445  -1.07536275]
mat_Sqrt:  [[12.30289862  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.004605   -0.06599565 -0.16141268]
Stock Position:  -0.004604996625493162
Bond Position:  [15.01294219]


portfolio before change:  [14.54128331]
curr_Stock_Price:  103.23842159924436
curr_Factors:  [103.2384216   -1.61255133  -1.10243838]
mat_Sqrt:  [[ 6.83496517  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00625636 -0.00730971  0.16342436]
Stock Position:  0.006256355418968513
Bond Position:  [13.89538705]


portfolio before change:  [14.54351777]
curr_Stock_Price:  103.04025242825638
curr_Factors:  [103.04025243  -1.3867712   -1.11509426]
mat_Sqrt:  [[ 8.44229554  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00814824  0.00525786  0.16709793]
Stock Position:  -0.008148235935059854
Bond Position:  [15.38311406]


portfolio before change:  [14.55179587]
curr_Stock_Price:  102.49635058630888
curr_Factors:  [102.49635059  -1.57052551  -1.09790131]
mat_Sqrt:  [[ 7.10927578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00078097 -0.05775465 -0.09888505]
Stock Position:  0.0007809711984140635
Bond Position:  [14.47174917]


portfolio before change:  [14.55520678]
curr_Stock_Price:  102.23067394977484
curr_Factors:  [102.23067395  -1.54423196  -1.07417189]
mat_Sqrt:  [[ 7.45457488  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01038119  0.04172699 -0.00938975]
Stock Position:  -0.010381192660714677
Bond Position:  [15.6164831]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.56304085]
Stock Price:  101.85215604022709
PL:  [12.71088481]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 8.88923210e-03 -2.92719027e-02  4.80676451e-02]
 [ 3.75427349e-02  1.76276686e-01 -2.55357475e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-3.44824377e-01 -3.64872668e-01  1.34055419e+00]
 [-2.41468198e-02 -4.01176514e-03 -6.68371972e-03]
 [-1.02328142e+00  1.07571770e+00 -1.53403679e-01]
 [ 6.08574295e-03 -4.05389758e-04  2.25116001e-02]
 [-8.69547950e-02 -2.28707815e-02 -1.08212586e-02]
 [ 3.92659773e-02  2.91170148e-02  5.68255002e-02]
 [ 1.16066962e-01  1.37944859e-01  7.92098794e-02]
 [ 8.73079584e-02  1.49071012e-02 -5.76997483e-02]
 [ 2.24709669e-02  7.77162814e-02 -1.32326552e-02]
 [-6.89549866e-02 -5.03197641e-02  1.00477178e-01]
 [ 1.11651859e-02  3.06399989e-01 -2.73724912e-01]
 [-1.48475235e-02 -2.21120610e-01 -5.81798728e-02]
 [ 4.30142383e-02  4.42358107e-02 -2.31668151e-02]
 [-8.41775922e-02  1.60973769e-02  5.58354933e-02]
 [ 4.16131414e-02 -1.48085688e-01 -4.08428511e-02]
 [-1.10126749e-01 -3.17210365e-02 -1.26096393e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.68347939]
curr_Stock_Price:  100.93205831686328
curr_Factors:  [100.93205832  -1.02737115  -0.99851281]
mat_Sqrt:  [[13.31063901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00095607 -0.00944747  0.13712361]
Stock Position:  0.0009560695733615968
Bond Position:  [9.58698132]


portfolio before change:  [9.68556803]
curr_Stock_Price:  100.60948291764639
curr_Factors:  [100.60948292  -0.53288738  -1.03531852]
mat_Sqrt:  [[20.96890487  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00102058  0.05689306 -0.7284638 ]
Stock Position:  0.0010205795956804854
Bond Position:  [9.58288805]


portfolio before change:  [9.68862442]
curr_Stock_Price:  101.25653797346341
curr_Factors:  [101.25653797  -0.68848551  -1.07748746]
mat_Sqrt:  [[17.31692431  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00450558  0.01370813 -0.02999186]
Stock Position:  -0.004505577151710536
Bond Position:  [10.14484357]


portfolio before change:  [9.68350237]
curr_Stock_Price:  102.95633877510922
curr_Factors:  [102.95633878  -0.64643848  -1.03935673]
mat_Sqrt:  [[19.07750307  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00763539 -0.11776215  3.82422796]
Stock Position:  -0.0076353923454054035
Bond Position:  [10.46961441]


portfolio before change:  [9.69883045]
curr_Stock_Price:  101.29167692696882
curr_Factors:  [101.29167693  -1.02249098  -0.998881  ]
mat_Sqrt:  [[13.41847202  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196222 -0.00129479 -0.01906679]
Stock Position:  -0.001962222414185198
Bond Position:  [9.89758725]


portfolio before change:  [9.70097756]
curr_Stock_Price:  101.45862472358695
curr_Factors:  [101.45862472  -1.15361352  -0.99872709]
mat_Sqrt:  [[11.7906927   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07081983  0.34718639 -0.437618  ]
Stock Position:  -0.07081983057845333
Bond Position:  [16.88626018]


portfolio before change:  [9.74963083]
curr_Stock_Price:  100.83124154907446
curr_Factors:  [100.83124155  -0.65584773  -1.02932394]
mat_Sqrt:  [[18.69538247  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00056689 -0.00013084  0.06421933]
Stock Position:  0.0005668861955775896
Bond Position:  [9.69247099]


portfolio before change:  [9.75171999]
curr_Stock_Price:  100.24159679046258
curr_Factors:  [100.24159679  -0.75075918  -1.01739464]
mat_Sqrt:  [[17.10600233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00548534 -0.00738151 -0.03087004]
Stock Position:  -0.005485335034466077
Bond Position:  [10.30157873]


portfolio before change:  [9.75937473]
curr_Stock_Price:  99.31566832419723
curr_Factors:  [99.31566832 -0.25171177 -1.05540127]
mat_Sqrt:  [[26.87483386  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00211383 0.00939748 0.16210734]
Stock Position:  0.002113833335341834
Bond Position:  [9.54943796]


portfolio before change:  [9.76153681]
curr_Stock_Price:  99.20895276523575
curr_Factors:  [99.20895277 -0.25852277 -1.05840227]
mat_Sqrt:  [[26.58383205  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0060335  0.04452151 0.22596374]
Stock Position:  0.0060334976042234305
Bond Position:  [9.16295983]


portfolio before change:  [9.76928232]
curr_Stock_Price:  100.1129869607033
curr_Factors:  [100.11298696  -0.15906175  -1.08857503]
mat_Sqrt:  [[28.7507152   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0027329   0.00481125 -0.16460132]
Stock Position:  0.0027329040441802254
Bond Position:  [9.49568314]


portfolio before change:  [9.77654668]
curr_Stock_Price:  101.90234394597532
curr_Factors:  [101.90234395  -0.43769536  -1.15107939]
mat_Sqrt:  [[20.8059747   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00171266  0.02508282 -0.03774908]
Stock Position:  0.0017126634309557619
Bond Position:  [9.60202226]


portfolio before change:  [9.77704413]
curr_Stock_Price:  100.79100053410764
curr_Factors:  [100.79100053  -0.3908905   -1.19713849]
mat_Sqrt:  [[20.59441816  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0028511  -0.01624063  0.28663342]
Stock Position:  -0.002851095224774522
Bond Position:  [10.06440887]


portfolio before change:  [9.78137536]
curr_Stock_Price:  100.15447016047007
curr_Factors:  [ 1.00154470e+02  1.85729443e-02 -1.19780442e+00]
mat_Sqrt:  [[30.79900008  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.79075880e-04  9.88901713e-02 -7.80860984e-01]
Stock Position:  0.0005790758803094916
Bond Position:  [9.72337832]


portfolio before change:  [9.78443098]
curr_Stock_Price:  101.2328775344176
curr_Factors:  [101.23287753  -0.24509108  -1.25780676]
mat_Sqrt:  [[22.5227462   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00319053 -0.07136637 -0.16597098]
Stock Position:  -0.003190529931240134
Bond Position:  [10.10741751]


portfolio before change:  [9.7810394]
curr_Stock_Price:  103.08797951882899
curr_Factors:  [103.08797952  -0.2635336   -1.28049325]
mat_Sqrt:  [[22.01129968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00214957  0.01427705 -0.06608848]
Stock Position:  0.0021495745221198396
Bond Position:  [9.5594441]


portfolio before change:  [9.78483353]
curr_Stock_Price:  103.74112064470418
curr_Factors:  [103.74112064  -0.33403056  -1.24111135]
mat_Sqrt:  [[21.47214809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00323649  0.00519541  0.15928312]
Stock Position:  -0.0032364883232748067
Bond Position:  [10.12059046]


portfolio before change:  [9.7892726]
curr_Stock_Price:  103.15140627062509
curr_Factors:  [ 1.03151406e+02 -9.79395122e-02 -1.24945068e+00]
mat_Sqrt:  [[26.81087738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.13695078e-04 -4.77944504e-02 -1.16513286e-01]
Stock Position:  0.0001136950781446255
Bond Position:  [9.77754479]


portfolio before change:  [9.79216761]
curr_Stock_Price:  107.11214147008396
curr_Factors:  [ 1.07112141e+02 -1.97656412e-02 -1.24880101e+00]
mat_Sqrt:  [[30.12362323  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00472523 -0.01023792 -0.35971791]
Stock Position:  -0.004725231614372363
Bond Position:  [10.29829728]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.80482917]
Stock Price:  104.97750174344598
PL:  [4.82732743]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-6.61760074e-02  1.39957781e-01  1.80308502e-02]
 [ 3.33964665e-02  9.22194899e-02 -1.67037443e-01]
 [ 3.24844659e-02 -3.45682477e-02 -2.50944585e-02]
 [-1.93934375e-01 -1.76846238e-01  5.31456090e-01]
 [-4.61855373e-02  2.85236532e-02 -2.85972102e-02]
 [-1.48672758e+00  1.48447195e+00 -2.16274536e-01]
 [ 1.07106970e-02 -6.68649158e-03  3.13403456e-02]
 [-3.13191862e-02 -1.71897004e-01  2.81536327e-01]
 [ 4.15540492e-02 -5.78177463e-03  1.22330461e-02]
 [-4.27644371e-01  2.57306703e-01 -2.11588970e-01]
 [ 1.11870407e-01  3.79010217e-02 -5.35859015e-02]
 [-5.20443114e-02  1.43189077e-01  4.90603075e-02]
 [-4.32448372e-02 -5.31821163e-02  3.45325064e-02]
 [ 6.14664987e-03  1.97049227e-01 -1.81213745e-01]
 [ 1.28610097e-01 -6.09470316e-02 -2.22351250e-02]
 [ 3.48259618e-02  1.25273232e-02 -4.39141352e-02]
 [-8.43965314e-02  1.60726605e-02  5.59123385e-02]
 [ 3.68402097e-02 -1.81557635e-01 -4.03042302e-02]
 [-1.22379431e-01 -6.74045509e-03 -9.00021696e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.13608974]
curr_Stock_Price:  99.316002225045
curr_Factors:  [99.31600223 -1.19175257 -0.97354828]
mat_Sqrt:  [[11.39307661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297784  0.04517118  0.051437  ]
Stock Position:  -0.002977835945457823
Bond Position:  [-2.84034298]


portfolio before change:  [-3.13810996]
curr_Stock_Price:  99.75593161766042
curr_Factors:  [99.75593162 -1.00945811 -0.99690991]
mat_Sqrt:  [[13.41479895  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00135107  0.02976371 -0.47651133]
Stock Position:  0.0013510687541718569
Bond Position:  [-3.27288708]


portfolio before change:  [-3.13944701]
curr_Stock_Price:  99.37198894610528
curr_Factors:  [99.37198895 -0.96303192 -1.0026299 ]
mat_Sqrt:  [[13.91835475  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00145893 -0.01115685 -0.07158751]
Stock Position:  0.0014589272484708143
Bond Position:  [-3.28442352]


portfolio before change:  [-3.14164996]
curr_Stock_Price:  98.42489564352023
curr_Factors:  [98.42489564 -0.61947091 -1.02367339]
mat_Sqrt:  [[19.03252722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00638643 -0.05707688  1.51609629]
Stock Position:  -0.006386432038322403
Bond Position:  [-2.51306606]


portfolio before change:  [-3.13634753]
curr_Stock_Price:  97.49624301516246
curr_Factors:  [97.49624302 -0.39861482 -1.00305341]
mat_Sqrt:  [[24.00220296  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00192485  0.00920597 -0.08157988]
Stock Position:  -0.0019248463207329602
Bond Position:  [-2.94868225]


portfolio before change:  [-3.13969929]
curr_Stock_Price:  98.854530017162
curr_Factors:  [98.85453002 -0.20130179 -1.00380116]
mat_Sqrt:  [[29.6228621   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04144967  0.47911126 -0.61697105]
Stock Position:  -0.041449670330861575
Bond Position:  [0.95778839]


portfolio before change:  [-3.2787041]
curr_Stock_Price:  102.21388819805951
curr_Factors:  [102.2138882   -0.45314066  -1.06022753]
mat_Sqrt:  [[22.5041419   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00069957 -0.00215806  0.08940528]
Stock Position:  0.0006995665045099833
Bond Position:  [-3.35020951]


portfolio before change:  [-3.27826323]
curr_Stock_Price:  104.04148258423362
curr_Factors:  [104.04148258  -0.39507139  -1.07538453]
mat_Sqrt:  [[23.91088432  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.73852881e-04 -5.54795194e-02  8.03144778e-01]
Stock Position:  -0.0003738528809471958
Bond Position:  [-3.23936702]


portfolio before change:  [-3.27909447]
curr_Stock_Price:  104.09845211696333
curr_Factors:  [104.09845212  -0.56251717  -1.06954117]
mat_Sqrt:  [[20.35402667  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210626 -0.00186606  0.03489748]
Stock Position:  0.002106261832501111
Bond Position:  [-3.49835307]


portfolio before change:  [-3.28419259]
curr_Stock_Price:  102.09327900757827
curr_Factors:  [102.09327901  -0.86405561  -1.00978264]
mat_Sqrt:  [[15.67471088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02668708  0.08304538 -0.60360444]
Stock Position:  -0.026687080948406543
Bond Position:  [-0.55962099]


portfolio before change:  [-3.28819523]
curr_Stock_Price:  102.23802005680267
curr_Factors:  [102.23802006  -0.93777935  -1.01187157]
mat_Sqrt:  [[14.55089792  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00746818  0.0122325  -0.15286566]
Stock Position:  0.007468181355470264
Bond Position:  [-4.0517273]


portfolio before change:  [-3.29843878]
curr_Stock_Price:  101.00204410649452
curr_Factors:  [101.00204411  -1.04967929  -0.99768138]
mat_Sqrt:  [[13.03685159  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00098195  0.04621408  0.1399554 ]
Stock Position:  -0.0009819525778731952
Bond Position:  [-3.19925956]


portfolio before change:  [-3.29904455]
curr_Stock_Price:  100.80432543131374
curr_Factors:  [100.80432543  -0.39852398  -1.00058702]
mat_Sqrt:  [[24.88014927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189113 -0.01716445  0.09851163]
Stock Position:  -0.0018911330636921138
Bond Position:  [-3.10841015]


portfolio before change:  [-3.29430405]
curr_Stock_Price:  97.88666163914337
curr_Factors:  [ 9.78866616e+01 -7.79737961e-02 -9.68428312e-01]
mat_Sqrt:  [[34.37770306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.72823759e-04  6.35973645e-02 -5.16952373e-01]
Stock Position:  0.0002728237594110807
Bond Position:  [-3.32100986]


portfolio before change:  [-3.29326589]
curr_Stock_Price:  104.73549720423279
curr_Factors:  [104.7354972   -0.451873    -0.95491378]
mat_Sqrt:  [[25.65276369  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0043516  -0.01967057 -0.06343062]
Stock Position:  0.0043516016939900235
Bond Position:  [-3.74903305]


portfolio before change:  [-3.29869236]
curr_Stock_Price:  103.70390093705916
curr_Factors:  [103.70390094  -0.29349893  -0.94421078]
mat_Sqrt:  [[30.079083    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094481  0.00404318 -0.1252748 ]
Stock Position:  0.0009448145623824535
Bond Position:  [-3.39667331]


portfolio before change:  [-3.29826385]
curr_Stock_Price:  105.05631698019657
curr_Factors:  [105.05631698  -0.13428003  -0.97982423]
mat_Sqrt:  [[34.48044299  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202151  0.00518743  0.15950234]
Stock Position:  -0.0020215127472964934
Bond Position:  [-3.08589117]


portfolio before change:  [-3.30506933]
curr_Stock_Price:  108.04116788377029
curr_Factors:  [ 1.08041168e+02 -6.49577508e-02 -9.78890292e-01]
mat_Sqrt:  [[38.04099125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00022205 -0.05859747 -0.11497675]
Stock Position:  -0.00022205398774658363
Bond Position:  [-3.28107836]


portfolio before change:  [-3.30547036]
curr_Stock_Price:  106.15270061904042
curr_Factors:  [106.15270062   0.22686259  -1.01619598]
mat_Sqrt:  [[48.20897624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00294814 -0.00217547 -0.25675114]
Stock Position:  -0.0029481426069270502
Bond Position:  [-2.99251706]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.31141659]
Stock Price:  107.91584453814846
PL:  [-11.22726112]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.21167876e-01  2.06867973e-01 -6.06848027e-03]
 [-3.02455687e-02 -1.36336057e-01  2.98053540e-01]
 [ 2.02396242e-01  7.34439945e-02  3.29420388e-01]
 [ 2.48448598e-02  3.63862760e-02 -6.19768088e-02]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-1.46489226e+00  1.37512789e+00 -1.92641895e-01]
 [-2.45254949e-02  4.73476830e-04 -4.97424908e-02]
 [ 1.04919944e-01 -9.80637798e-02  3.17287963e-03]
 [ 2.48553591e-02  2.70239339e-02  4.42297446e-02]
 [ 1.54138361e-01  1.16739449e-01  8.45832975e-02]
 [-1.52956131e-03  3.00444692e-02 -5.14545859e-02]
 [-1.56322854e-02  1.34388408e-01 -4.57549365e-03]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-5.40076436e-02 -5.77259789e-02  1.15630361e-03]
 [-4.90716366e-02 -1.84898853e-01 -5.84420492e-02]
 [ 3.88419740e-02  1.29394567e-02 -5.42524610e-02]
 [-1.93518726e-03  2.34615674e-02  8.44674483e-02]
 [-6.35256375e-02  3.72498042e-02  6.77768078e-02]
 [ 6.63152764e-02 -1.15147156e-01 -2.40696910e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.44017794]
curr_Stock_Price:  98.39523678429023
curr_Factors:  [98.39523678 -1.2063169  -1.00278292]
mat_Sqrt:  [[10.80374228  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00742149  0.06676635 -0.01731169]
Stock Position:  -0.007421488658499995
Bond Position:  [-9.70993881]


portfolio before change:  [-10.43724654]
curr_Stock_Price:  97.67311931182171
curr_Factors:  [97.67311931 -1.08081612 -1.01214692]
mat_Sqrt:  [[12.04516523  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.29542241e-04 -4.40022732e-02  8.50263787e-01]
Stock Position:  0.0002295422410716591
Bond Position:  [-10.45966665]


portfolio before change:  [-10.44023194]
curr_Stock_Price:  96.06055798128294
curr_Factors:  [96.06055798 -1.00691459 -0.98588063]
mat_Sqrt:  [[13.09438595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02173684 0.02370395 0.93974467]
Stock Position:  0.02173684132488189
Bond Position:  [-12.52828504]


portfolio before change:  [-10.44914453]
curr_Stock_Price:  95.79464408475698
curr_Factors:  [95.79464408 -0.74261879 -0.97400846]
mat_Sqrt:  [[17.21153033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00114     0.01174362 -0.17680258]
Stock Position:  0.001140004046756614
Bond Position:  [-10.55835081]


portfolio before change:  [-10.45106484]
curr_Stock_Price:  96.42587501430404
curr_Factors:  [96.42587501 -0.83392811 -0.99601617]
mat_Sqrt:  [[15.46888068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00367172 -0.04522423  0.24245377]
Stock Position:  0.0036717189367267704
Bond Position:  [-10.80511355]


portfolio before change:  [-10.45594461]
curr_Stock_Price:  95.83265062601257
curr_Factors:  [95.83265063 -0.37172208 -0.99621811]
mat_Sqrt:  [[24.40195513  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05014018  0.44382062 -0.54955371]
Stock Position:  -0.0501401756446164
Bond Position:  [-5.65087868]


portfolio before change:  [-10.5294669]
curr_Stock_Price:  97.27080655526281
curr_Factors:  [97.27080656 -0.71506328 -1.01321953]
mat_Sqrt:  [[17.27423521  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200197  0.00015281 -0.14190148]
Stock Position:  -0.002001969396823704
Bond Position:  [-10.33473372]


portfolio before change:  [-10.52822589]
curr_Stock_Price:  95.36018285964079
curr_Factors:  [95.36018286 -0.56159579 -1.0042315 ]
mat_Sqrt:  [[19.92218302  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00429423 -0.03164995  0.00905134]
Stock Position:  0.004294229222850629
Bond Position:  [-10.93772438]


portfolio before change:  [-10.5259334]
curr_Stock_Price:  96.53088598930707
curr_Factors:  [96.53088599 -0.59764513 -1.01611471]
mat_Sqrt:  [[19.22291729  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00204963 0.00872194 0.12617515]
Stock Position:  0.002049634543743186
Bond Position:  [-10.72378644]


portfolio before change:  [-10.5296801]
curr_Stock_Price:  96.01107709236952
curr_Factors:  [96.01107709 -0.69675522 -1.04075127]
mat_Sqrt:  [[16.89397551  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01155638 0.0376775  0.2412926 ]
Stock Position:  0.011556379617307613
Bond Position:  [-11.63922055]


portfolio before change:  [-10.51879711]
curr_Stock_Price:  97.2046304438548
curr_Factors:  [97.20463044 -0.70191269 -1.08105367]
mat_Sqrt:  [[16.34385511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00036098  0.00969681 -0.14678561]
Stock Position:  -0.0003609847883427779
Bond Position:  [-10.48370772]


portfolio before change:  [-10.52112732]
curr_Stock_Price:  96.39836046515616
curr_Factors:  [96.39836047 -0.72299616 -1.0514619 ]
mat_Sqrt:  [[16.34678321  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0006647   0.04337367 -0.01305261]
Stock Position:  0.0006646974335854106
Bond Position:  [-10.58520306]


portfolio before change:  [-10.52442786]
curr_Stock_Price:  95.41459178447231
curr_Factors:  [95.41459178 -0.41202429 -1.02908617]
mat_Sqrt:  [[22.58127587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074669 -0.00995959  0.34984664]
Stock Position:  0.0007466860380063754
Bond Position:  [-10.5956726]


portfolio before change:  [-10.52915298]
curr_Stock_Price:  92.63447534145024
curr_Factors:  [92.63447534 -0.19902612 -1.03754175]
mat_Sqrt:  [[26.89911797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243706 -0.01863098  0.00329861]
Stock Position:  -0.0024370643045954995
Bond Position:  [-10.30339681]


portfolio before change:  [-10.53673258]
curr_Stock_Price:  94.68752964001852
curr_Factors:  [94.68752964 -0.22709993 -1.06378407]
mat_Sqrt:  [[26.04167943  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00379174 -0.05967585 -0.1667189 ]
Stock Position:  -0.0037917443286301193
Bond Position:  [-10.17770167]


portfolio before change:  [-10.55006959]
curr_Stock_Price:  97.53378397385886
curr_Factors:  [97.53378397 -0.66921841 -1.06743456]
mat_Sqrt:  [[17.17656335  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00177038  0.00417619 -0.15476717]
Stock Position:  0.0017703769768799994
Bond Position:  [-10.72274115]


portfolio before change:  [-10.55383771]
curr_Stock_Price:  96.919730313877
curr_Factors:  [96.91973031 -0.61578167 -1.08532226]
mat_Sqrt:  [[17.68610291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00113624 0.00757219 0.24096212]
Stock Position:  0.0011362441425061044
Bond Position:  [-10.66396219]


portfolio before change:  [-10.5575676]
curr_Stock_Price:  95.98369664958967
curr_Factors:  [95.98369665 -0.50023682 -1.08530597]
mat_Sqrt:  [[19.66097213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214065  0.01202232  0.19334837]
Stock Position:  -0.002140645425055445
Bond Position:  [-10.35210054]


portfolio before change:  [-10.5609484]
curr_Stock_Price:  96.3538869267828
curr_Factors:  [96.35388693 -0.39031417 -1.0772182 ]
mat_Sqrt:  [[22.20895002  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.84619007e-04 -3.71635848e-02 -6.86641286e-01]
Stock Position:  -0.00028461900679319557
Bond Position:  [-10.53352425]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.5636869]
Stock Price:  96.72206089178687
PL:  [-10.5636869]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-3.55904302e-02  2.41082233e-02  3.90835656e-02]
 [ 2.65170035e-02  8.99957620e-02 -9.26971989e-02]
 [ 9.53475447e-02 -4.81264366e-02  2.13512221e-03]
 [-5.28073550e-02 -3.04863400e-02  1.61750811e-01]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-1.14564279e+00  1.09502182e+00 -1.40836610e-01]
 [-8.72981056e-03 -2.29177743e-02 -1.74592492e-02]
 [ 7.01758062e-02 -6.05394570e-02  5.61044435e-03]
 [ 5.75786177e-02  2.51506725e-02  3.88014092e-02]
 [ 1.54299954e-01  1.17363659e-01  8.55532029e-02]
 [-5.79626812e-02 -2.90441963e-02 -2.89444449e-02]
 [ 6.93951102e-02  2.43922770e-02 -2.34398009e-02]
 [-5.05491103e-02  6.81724329e-02  1.85890204e-01]
 [ 1.00608554e-02  7.08557570e-01 -4.86133069e-01]
 [-3.60467540e-02 -2.51844683e-01 -6.11300951e-02]
 [ 4.59270977e-02  5.34466172e-02 -2.84472061e-02]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 3.89696555e-02 -1.28423543e-01 -4.25462348e-02]
 [ 9.70000055e-03 -8.47814265e-02 -1.16477507e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.3592665]
curr_Stock_Price:  100.26087923229672
curr_Factors:  [100.26087923  -1.11656695  -1.0210687 ]
mat_Sqrt:  [[11.82410135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191909  0.0077809   0.11149453]
Stock Position:  -0.00191908540479698
Bond Position:  [4.55167569]


portfolio before change:  [4.36066912]
curr_Stock_Price:  100.12302219068863
curr_Factors:  [100.12302219  -1.26173962  -1.0336458 ]
mat_Sqrt:  [[10.08464765  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00257476  0.02904601 -0.26443931]
Stock Position:  0.002574762736934147
Bond Position:  [4.10287609]


portfolio before change:  [4.3573716]
curr_Stock_Price:  98.44388835253743
curr_Factors:  [98.44388835 -1.03166872 -1.05269673]
mat_Sqrt:  [[12.24504399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00701995 -0.01553274  0.00609091]
Stock Position:  0.00701995085351164
Bond Position:  [3.66630034]


portfolio before change:  [4.3532142]
curr_Stock_Price:  97.72107872868241
curr_Factors:  [97.72107873 -0.94846824 -1.10569543]
mat_Sqrt:  [[12.52784301  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207642 -0.00983942  0.46143004]
Stock Position:  -0.002076423451793542
Bond Position:  [4.55612454]


portfolio before change:  [4.35623828]
curr_Stock_Price:  96.81331198293952
curr_Factors:  [96.81331198 -0.83550538 -1.11748047]
mat_Sqrt:  [[13.73295826  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00413584 -0.04522423  0.24245377]
Stock Position:  0.004135844661222517
Bond Position:  [3.95583346]


portfolio before change:  [4.36036054]
curr_Stock_Price:  97.57087837920274
curr_Factors:  [97.57087838 -1.15439111 -1.09973641]
mat_Sqrt:  [[10.2415354   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09284453  0.35341677 -0.40176765]
Stock Position:  -0.09284453088367638
Bond Position:  [13.41928297]


portfolio before change:  [4.42364503]
curr_Stock_Price:  96.92539882872347
curr_Factors:  [96.92539883 -1.32212514 -1.07522276]
mat_Sqrt:  [[ 8.81622433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00192506 -0.00739668 -0.04980638]
Stock Position:  -0.0019250571818198823
Bond Position:  [4.61023196]


portfolio before change:  [4.4266734]
curr_Stock_Price:  95.95105469642594
curr_Factors:  [95.9510547  -0.96341419 -1.04096366]
mat_Sqrt:  [[12.92883858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00456062 -0.01953903  0.01600504]
Stock Position:  0.004560616028909186
Bond Position:  [3.98907748]


portfolio before change:  [4.42804429]
curr_Stock_Price:  96.03295256914299
curr_Factors:  [96.03295257 -0.90270159 -1.07289187]
mat_Sqrt:  [[13.31775253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00530366 0.00811734 0.11068962]
Stock Position:  0.005303656272595112
Bond Position:  [3.91871852]


portfolio before change:  [4.42960018]
curr_Stock_Price:  96.14157353542515
curr_Factors:  [96.14157354 -0.57723859 -1.05171282]
mat_Sqrt:  [[18.8567402   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01037932 0.03787896 0.24405947]
Stock Position:  0.010379322365731282
Bond Position:  [3.4317158]


portfolio before change:  [4.42245778]
curr_Stock_Price:  95.37076788178705
curr_Factors:  [95.37076788 -0.56726415 -1.05830456]
mat_Sqrt:  [[18.76894052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00371889 -0.00937397 -0.08257044]
Stock Position:  -0.0037188866851137056
Bond Position:  [4.77713086]


portfolio before change:  [4.41772825]
curr_Stock_Price:  96.96370755021938
curr_Factors:  [96.96370755 -0.48203403 -1.08066433]
mat_Sqrt:  [[20.32066609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00342457  0.00787257 -0.06686723]
Stock Position:  0.0034245695129073955
Bond Position:  [4.08566929]


portfolio before change:  [4.42651407]
curr_Stock_Price:  99.23093387713008
curr_Factors:  [99.23093388  0.22209212 -1.05663793]
mat_Sqrt:  [[43.07332914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.04413055e-05 2.20025581e-02 5.30293011e-01]
Stock Position:  3.044130548703526e-05
Bond Position:  [4.42349335]


portfolio before change:  [4.42778515]
curr_Stock_Price:  104.6535878495187
curr_Factors:  [ 1.04653588e+02 -8.11694519e-02 -1.09152754e+00]
mat_Sqrt:  [[32.39353099  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00171216  0.22868597 -1.38680233]
Stock Position:  0.0017121648908262153
Bond Position:  [4.24860096]


portfolio before change:  [4.42347557]
curr_Stock_Price:  101.51611939184046
curr_Factors:  [101.51611939   0.33894618  -1.07663904]
mat_Sqrt:  [[48.54662788  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00205848 -0.08128252 -0.17438715]
Stock Position:  -0.0020584841294646215
Bond Position:  [4.63244489]


portfolio before change:  [4.42704041]
curr_Stock_Price:  100.34701442376516
curr_Factors:  [100.34701442   0.52851709  -1.05072147]
mat_Sqrt:  [[59.52699754  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00085726  0.01724982 -0.08115196]
Stock Position:  0.0008572594501132317
Bond Position:  [4.34101699]


portfolio before change:  [4.42988969]
curr_Stock_Price:  102.4046010643282
curr_Factors:  [102.40460106  -0.24415087  -1.06921995]
mat_Sqrt:  [[27.53783366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249801  0.00525786  0.16709793]
Stock Position:  -0.0024980111643167348
Bond Position:  [4.68569753]


portfolio before change:  [4.43089105]
curr_Stock_Price:  102.47274116707021
curr_Factors:  [102.47274117  -0.23815075  -1.11189391]
mat_Sqrt:  [[26.56387376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00015324 -0.04144852 -0.12137257]
Stock Position:  0.00015323803307715154
Bond Position:  [4.41518832]


portfolio before change:  [4.43167907]
curr_Stock_Price:  100.41114607395382
curr_Factors:  [100.41114607  -0.20454026  -1.1028697 ]
mat_Sqrt:  [[27.16320402  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00115531 -0.02736309 -0.33227791]
Stock Position:  -0.001155305802924974
Bond Position:  [4.54768465]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.43380942]
Stock Price:  99.55138229440766
PL:  [4.43380942]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 2.30849938e-03 -1.75014704e-02  4.15236740e-02]
 [ 1.37059663e-02  1.24249962e-01 -1.48145274e-01]
 [ 2.45252833e-02 -1.20275663e-01 -2.59983474e-01]
 [-2.36552302e-01 -2.17052623e-01  1.11895615e+00]
 [ 1.36244923e-02 -5.97729700e-02  3.08729707e-02]
 [-9.25475871e-01  1.01256240e+00 -1.44805458e-01]
 [ 9.70697307e-03 -3.61911514e-03  2.57319643e-02]
 [-7.52057219e-02 -5.63371656e-02  5.06873900e-02]
 [-1.17013380e-01  5.23645652e-03  3.94772796e-02]
 [-8.34453929e-01  3.44943778e-01 -4.31065635e-01]
 [ 1.31973679e-01  4.11737453e-02 -5.42743655e-02]
 [-1.40727595e-01  9.65346889e-02  2.60675462e-01]
 [-6.71196064e-02 -1.18851481e-01 -6.93593134e-02]
 [ 3.79805808e-02  7.96801540e-01 -4.55785980e-01]
 [ 1.16862375e-01 -6.00532550e-02 -3.31653346e-02]
 [ 5.02064716e-02  2.22463720e-02  1.00087929e-01]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 5.27521395e-02 -1.91179469e-01 -3.17584056e-02]
 [-1.18302741e-01  9.71124879e-02 -8.21104767e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.74529565]
curr_Stock_Price:  100.81378932255478
curr_Factors:  [100.81378932  -0.87115535  -0.99935208]
mat_Sqrt:  [[15.52990802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00046439 -0.00564858  0.11845548]
Stock Position:  0.00046439496927765486
Bond Position:  [8.69847823]


portfolio before change:  [8.74812466]
curr_Stock_Price:  102.2223244824192
curr_Factors:  [102.22232448  -1.33703345  -1.02213164]
mat_Sqrt:  [[ 9.65991653  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00091392  0.0401015  -0.42261723]
Stock Position:  0.0009139163955485532
Bond Position:  [8.654702]


portfolio before change:  [8.75143324]
curr_Stock_Price:  103.47477467285019
curr_Factors:  [103.47477467  -1.40300084  -1.05003359]
mat_Sqrt:  [[ 8.90215547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00596426 -0.0388188  -0.74166049]
Stock Position:  -0.005964262040427269
Bond Position:  [9.36858391]


portfolio before change:  [8.75096298]
curr_Stock_Price:  103.94636726519164
curr_Factors:  [103.94636727  -1.20332519  -1.00313375]
mat_Sqrt:  [[11.44343407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00458359 -0.07005343  3.19207044]
Stock Position:  -0.004583590455018545
Bond Position:  [9.22741055]


portfolio before change:  [8.75860696]
curr_Stock_Price:  102.78203099610306
curr_Factors:  [102.782031    -1.11131641  -0.98404949]
mat_Sqrt:  [[12.64478209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00061095 -0.01929164  0.08807199]
Stock Position:  0.0006109480204257325
Bond Position:  [8.69581248]


portfolio before change:  [8.76075035]
curr_Stock_Price:  102.73156347794144
curr_Factors:  [102.73156348  -1.34465841  -1.00078491]
mat_Sqrt:  [[ 9.84216874  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07603464  0.32680311 -0.41308967]
Stock Position:  -0.07603463682648914
Bond Position:  [16.57190747]


portfolio before change:  [8.7608916]
curr_Stock_Price:  102.78420063913127
curr_Factors:  [102.78420064  -1.28477243  -0.98459714]
mat_Sqrt:  [[10.62555645  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00133835 -0.00116806  0.07340613]
Stock Position:  0.0013383524487483793
Bond Position:  [8.62333011]


portfolio before change:  [8.76394556]
curr_Stock_Price:  103.45506872717552
curr_Factors:  [103.45506873  -1.44638171  -0.99556112]
mat_Sqrt:  [[ 8.99972993  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00848459 -0.01818274  0.14459701]
Stock Position:  -0.008484585441832896
Bond Position:  [9.64171893]


portfolio before change:  [8.76414959]
curr_Stock_Price:  103.7151514228118
curr_Factors:  [103.71515142  -1.38842983  -1.00632783]
mat_Sqrt:  [[ 9.45828005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01140654  0.00169006  0.11261769]
Stock Position:  -0.011406537602431904
Bond Position:  [9.94718037]


portfolio before change:  [8.76141169]
curr_Stock_Price:  104.17322294254856
curr_Factors:  [104.17322294  -1.81503025  -1.00632412]
mat_Sqrt:  [[ 6.20093911  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.13740394  0.11133013 -1.22971027]
Stock Position:  -0.13740394236008205
Bond Position:  [23.07522321]


portfolio before change:  [8.82498603]
curr_Stock_Price:  103.75253041810912
curr_Factors:  [103.75253042  -2.09154479  -0.9941281 ]
mat_Sqrt:  [[ 4.74141523  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02727024  0.01328877 -0.15482966]
Stock Position:  0.027270238832354292
Bond Position:  [5.99562975]


portfolio before change:  [8.83379599]
curr_Stock_Price:  104.02062009207596
curr_Factors:  [104.02062009  -1.7245345   -1.04227274]
mat_Sqrt:  [[ 6.53898471  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01037048  0.03115644  0.74363454]
Stock Position:  -0.010370475133892302
Bond Position:  [9.91253925]


portfolio before change:  [8.84033256]
curr_Stock_Price:  103.62930529514838
curr_Factors:  [103.6293053   -1.97135107  -1.07272955]
mat_Sqrt:  [[ 4.93690957  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02137734 -0.03835915 -0.19786282]
Stock Position:  -0.021377335866187848
Bond Position:  [11.05565102]


portfolio before change:  [8.83947254]
curr_Stock_Price:  103.79884336902609
curr_Factors:  [103.79884337  -1.51603273  -1.09979201]
mat_Sqrt:  [[ 7.58847069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0141781   0.25716659 -1.30023053]
Stock Position:  0.014178099243151285
Bond Position:  [7.36780224]


portfolio before change:  [8.83266174]
curr_Stock_Price:  103.18853722992269
curr_Factors:  [103.18853723  -1.37486977  -1.11114349]
mat_Sqrt:  [[ 8.58953423  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01138993 -0.0193821  -0.09461147]
Stock Position:  0.011389931970077679
Bond Position:  [7.65735133]


portfolio before change:  [8.82427667]
curr_Stock_Price:  102.28426011289578
curr_Factors:  [102.28426011  -1.16889168  -1.09968566]
mat_Sqrt:  [[10.58225414  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00710414 0.00717999 0.285523  ]
Stock Position:  0.007104143896544286
Bond Position:  [8.09763456]


portfolio before change:  [8.83325248]
curr_Stock_Price:  103.2627238887845
curr_Factors:  [103.26272389  -1.56319556  -1.09845493]
mat_Sqrt:  [[ 7.21113219  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00953939  0.00525786  0.16709793]
Stock Position:  -0.009539391894008247
Bond Position:  [9.81831607]


portfolio before change:  [8.83242645]
curr_Stock_Price:  103.60665649152703
curr_Factors:  [103.60665649  -1.43131808  -1.13077395]
mat_Sqrt:  [[ 7.99254751  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090649 -0.06170291 -0.09059789]
Stock Position:  0.0009064864818868837
Bond Position:  [8.73850842]


portfolio before change:  [8.83454835]
curr_Stock_Price:  103.53715838070686
curr_Factors:  [103.53715838  -1.49908871  -1.03502757]
mat_Sqrt:  [[ 8.21378864  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01219362  0.03134292 -0.02342383]
Stock Position:  -0.01219361913613149
Bond Position:  [10.09704103]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.83059833]
Stock Price:  104.06814102593417
PL:  [4.7624573]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.07160682e-01  1.89825017e-01  6.99543304e-05]
 [ 1.34224316e-02  1.98793923e-02 -1.15350953e-02]
 [ 9.30496134e-02 -4.16486143e-02 -2.06457013e-02]
 [-1.35130499e-01 -9.47657276e-02  3.57380984e-01]
 [-8.30481305e-03 -2.73990752e-02  9.06827064e-03]
 [-1.34333704e+00  1.29601510e+00 -1.82696212e-01]
 [-4.81743073e-02  3.83344999e-02 -1.02494165e-01]
 [ 2.98477979e-02  2.69107208e-02 -4.63692184e-02]
 [ 4.89349111e-02  2.63157261e-02  4.16704469e-02]
 [ 1.54833326e-01  1.20956318e-01  9.03087882e-02]
 [ 1.21219144e-01  3.22824084e-02 -5.27261981e-02]
 [-8.74852254e-02  1.24544367e-01  1.33629058e-01]
 [-7.90471313e-02 -6.99459071e-02  8.54360140e-02]
 [ 2.60485970e-02  2.20064909e-01 -9.57351384e-02]
 [-3.35910376e-03  2.65506644e-02 -8.46705434e-02]
 [ 4.87011180e-02  6.96865297e-03  4.48442932e-02]
 [ 1.46271758e-01  1.59896867e-02  1.54658737e-01]
 [-2.42190763e-02 -2.88186889e-02  3.47880077e-02]
 [-9.24545638e-02  2.62731583e-01 -2.48633423e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.05406]
curr_Stock_Price:  98.56997310510445
curr_Factors:  [98.56997311 -1.27292889 -0.9991542 ]
mat_Sqrt:  [[10.16228773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00673062  0.06126576  0.00019956]
Stock Position:  -0.006730623576582669
Bond Position:  [-8.39062261]


portfolio before change:  [-9.06028546]
curr_Stock_Price:  99.18322170154532
curr_Factors:  [99.1832217  -1.09198944 -1.00628023]
mat_Sqrt:  [[12.16665722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00124321  0.00641605 -0.03290642]
Stock Position:  0.0012432095219974575
Bond Position:  [-9.18359099]


portfolio before change:  [-9.06318668]
curr_Stock_Price:  98.69655531230691
curr_Factors:  [98.69655531 -0.67499048 -0.990013  ]
mat_Sqrt:  [[18.67240126  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00430228 -0.01344203 -0.05889644]
Stock Position:  0.004302276841174134
Bond Position:  [-9.48780658]


portfolio before change:  [-9.06953356]
curr_Stock_Price:  97.77271099149392
curr_Factors:  [97.77271099 -0.65893161 -0.96053357]
mat_Sqrt:  [[19.35944339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00421109 -0.03058551  1.01950847]
Stock Position:  -0.004211091328140758
Bond Position:  [-8.65780374]


portfolio before change:  [-9.07327331]
curr_Stock_Price:  98.14672975954593
curr_Factors:  [98.14672976 -0.67498305 -0.92197228]
mat_Sqrt:  [[19.87590665  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060609 -0.00884301  0.02586925]
Stock Position:  -0.0006060892250228062
Bond Position:  [-9.01378763]


portfolio before change:  [-9.07519472]
curr_Stock_Price:  97.59843599169642
curr_Factors:  [97.59843599 -0.5100945  -0.96960321]
mat_Sqrt:  [[22.2237994   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05022012  0.41828707 -0.52118144]
Stock Position:  -0.050220115653286046
Bond Position:  [-4.17378998]


portfolio before change:  [-9.01942488]
curr_Stock_Price:  96.46714781600369
curr_Factors:  [96.46714782 -0.60201134 -0.98238672]
mat_Sqrt:  [[19.78263343  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0030972   0.01237241 -0.29238732]
Stock Position:  -0.0030972036291229917
Bond Position:  [-8.72064647]


portfolio before change:  [-9.02542076]
curr_Stock_Price:  97.69904919815635
curr_Factors:  [97.6990492  -0.80019517 -0.9607969 ]
mat_Sqrt:  [[16.79195254  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00154097  0.0086854  -0.13227847]
Stock Position:  0.0015409672359452985
Bond Position:  [-9.17597179]


portfolio before change:  [-9.02814702]
curr_Stock_Price:  97.418719377715
curr_Factors:  [97.41871938 -0.73565439 -0.97362948]
mat_Sqrt:  [[17.63233641  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00356235 0.00849336 0.11887419]
Stock Position:  0.0035623486908263023
Bond Position:  [-9.37518646]


portfolio before change:  [-9.02859403]
curr_Stock_Price:  97.95125395338673
curr_Factors:  [97.95125395 -1.13247221 -0.97073567]
mat_Sqrt:  [[11.95634457  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0165567  0.03903848 0.25762584]
Stock Position:  0.016556702070372128
Bond Position:  [-10.65034376]


portfolio before change:  [-9.00648473]
curr_Stock_Price:  99.44745907765339
curr_Factors:  [99.44745908 -1.3786368  -1.00169138]
mat_Sqrt:  [[ 9.20089975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01272116  0.0104191  -0.15041317]
Stock Position:  0.012721155100469032
Bond Position:  [-10.27157128]


portfolio before change:  [-9.01770148]
curr_Stock_Price:  98.7676046559952
curr_Factors:  [98.76760466 -1.37532854 -1.01051013]
mat_Sqrt:  [[ 9.08778308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00382775  0.04019652  0.38120651]
Stock Position:  -0.003827753744767275
Bond Position:  [-8.63964341]


portfolio before change:  [-9.01807418]
curr_Stock_Price:  98.30062528502984
curr_Factors:  [98.30062529 -0.92193319 -0.9948639 ]
mat_Sqrt:  [[14.45778905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524874 -0.02257494  0.24372517]
Stock Position:  -0.005248743513926583
Bond Position:  [-8.50211941]


portfolio before change:  [-9.01429704]
curr_Stock_Price:  97.17598898874041
curr_Factors:  [97.17598899 -1.21770893 -1.0345352 ]
mat_Sqrt:  [[10.2193146   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00503236  0.07102564 -0.2731057 ]
Stock Position:  0.00503236344289772
Bond Position:  [-9.50332194]


portfolio before change:  [-9.01921951]
curr_Stock_Price:  96.66999669831517
curr_Factors:  [96.6699967  -1.48486944 -0.97852953]
mat_Sqrt:  [[ 8.23097198  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184945  0.00856919 -0.24154149]
Stock Position:  -0.0018494503956383215
Bond Position:  [-8.84043314]


portfolio before change:  [-9.02138232]
curr_Stock_Price:  96.64427455368202
curr_Factors:  [96.64427455 -1.82151084 -0.98924457]
mat_Sqrt:  [[ 5.81407415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0101955  0.00224912 0.12792829]
Stock Position:  0.010195499724615939
Bond Position:  [-10.006719]


portfolio before change:  [-9.02547668]
curr_Stock_Price:  96.48809174970977
curr_Factors:  [96.48809175 -1.58363619 -1.01108339]
mat_Sqrt:  [[ 7.20445812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02513794 0.00516065 0.44119833]
Stock Position:  0.025137938083557507
Bond Position:  [-11.45098835]


portfolio before change:  [-9.01762562]
curr_Stock_Price:  96.91430642042808
curr_Factors:  [96.91430642 -1.47949918 -1.00100096]
mat_Sqrt:  [[ 8.11185862  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00283543 -0.00930119  0.0992405 ]
Stock Position:  -0.002835428389903854
Bond Position:  [-8.74283205]


portfolio before change:  [-9.0213325]
curr_Stock_Price:  97.45069538858502
curr_Factors:  [97.45069539 -1.86628914 -1.02646939]
mat_Sqrt:  [[ 5.40102114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00812808  0.08479625 -0.0709282 ]
Stock Position:  -0.00812807641166584
Bond Position:  [-8.2292458]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.02744929]
Stock Price:  97.95010332874008
PL:  [-9.02744929]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 1.26266719e-03 -1.45466800e-02  3.90238322e-02]
 [ 4.38689112e-02  1.57618445e-01 -3.14461082e-01]
 [-3.68759621e-02 -8.23327022e-02 -1.28025695e-01]
 [-2.34902128e-01 -2.15345724e-01  1.11359583e+00]
 [-1.19093787e-02 -9.70638464e-02 -4.90141971e-03]
 [-1.04901285e+00  1.20163846e+00 -1.85340470e-01]
 [-4.58344090e-02 -1.55909973e-01 -1.24757998e-02]
 [-3.72242625e-02 -1.52813658e-01  2.42904745e-01]
 [ 1.66093664e-02 -2.25383959e-02 -1.31468275e-02]
 [-7.73655057e-01  3.40701145e-01 -3.88200984e-01]
 [ 1.24735847e-01  1.85657001e-02 -6.06044684e-02]
 [-8.33210066e-02 -1.48010599e-02 -1.36168335e-02]
 [ 1.52862075e-01  3.03137257e-01  9.15773538e-02]
 [ 8.39495412e-03  4.95046478e-01 -3.77378846e-01]
 [ 3.40482657e-02 -1.50255879e-01 -5.13752178e-02]
 [ 2.70229858e-02 -8.86635136e-03 -7.77915827e-02]
 [-6.94441296e-02  1.77606630e-02  5.06642130e-02]
 [ 4.54927523e-02 -2.70160831e-01 -2.75912700e-02]
 [-1.94798575e-01 -4.05531784e-02 -1.05355492e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.70481245]
curr_Stock_Price:  100.80868594369412
curr_Factors:  [100.80868594  -0.82862554  -1.0294569 ]
mat_Sqrt:  [[15.72327479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00039808 -0.00469492  0.11132413]
Stock Position:  0.000398075149260395
Bond Position:  [8.66468302]


portfolio before change:  [8.70669683]
curr_Stock_Price:  100.10011838714506
curr_Factors:  [100.10011839  -0.71566928  -0.98522676]
mat_Sqrt:  [[18.27026421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.48788754e-04  5.08711343e-02 -8.97069937e-01]
Stock Position:  0.0006487887544164707
Bond Position:  [8.641753]


portfolio before change:  [8.7104923]
curr_Stock_Price:  102.61983180820009
curr_Factors:  [102.61983181  -0.97062967  -0.98895619]
mat_Sqrt:  [[14.46085497  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0055194  -0.02657277 -0.36522167]
Stock Position:  -0.0055193963487502745
Bond Position:  [9.27689183]


portfolio before change:  [8.70555659]
curr_Stock_Price:  103.93432845397612
curr_Factors:  [103.93432845  -1.21046803  -0.97909938]
mat_Sqrt:  [[11.63702509  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00442962 -0.06950253  3.17677895]
Stock Position:  -0.004429619438246701
Bond Position:  [9.16594611]


portfolio before change:  [8.70458351]
curr_Stock_Price:  104.67137757731973
curr_Factors:  [104.67137758  -1.54798032  -1.04869229]
mat_Sqrt:  [[ 7.80022905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00419513 -0.03132722 -0.01398239]
Stock Position:  -0.004195127002903087
Bond Position:  [9.14369324]


portfolio before change:  [8.70457605]
curr_Stock_Price:  105.21812326668514
curr_Factors:  [105.21812327  -1.3607931   -1.01941681]
mat_Sqrt:  [[ 9.73595415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08643856  0.38782715 -0.52872477]
Stock Position:  -0.08643856388629435
Bond Position:  [17.79947952]


portfolio before change:  [8.62047147]
curr_Stock_Price:  106.24260823296589
curr_Factors:  [106.24260823  -1.15543888  -1.08006703]
mat_Sqrt:  [[11.36137362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00705953 -0.05031973 -0.03558998]
Stock Position:  -0.007059534659996987
Bond Position:  [9.37049485]


portfolio before change:  [8.63171439]
curr_Stock_Price:  104.98190178386511
curr_Factors:  [104.98190178  -1.06814599  -1.06355866]
mat_Sqrt:  [[12.4545165   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00151226 -0.0493204   0.69293963]
Stock Position:  -0.0015122623451531677
Bond Position:  [8.79047457]


portfolio before change:  [8.63410059]
curr_Stock_Price:  104.85738284733542
curr_Factors:  [104.85738285  -0.91498256  -1.04318518]
mat_Sqrt:  [[14.7971328   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0006302  -0.00727424 -0.03750424]
Stock Position:  0.0006301998352975116
Bond Position:  [8.56801948]


portfolio before change:  [8.63592208]
curr_Stock_Price:  104.34836557321424
curr_Factors:  [104.34836557  -0.1425003   -1.05394699]
mat_Sqrt:  [[31.54098105  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02483597  0.10996082 -1.10742935]
Stock Position:  -0.024835971962444452
Bond Position:  [11.22751516]


portfolio before change:  [8.70012592]
curr_Stock_Price:  101.8762812530592
curr_Factors:  [ 1.01876281e+02  2.50727238e-02 -1.05794556e+00]
mat_Sqrt:  [[36.26620482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00320284  0.00599205 -0.17288768]
Stock Position:  0.003202836352302214
Bond Position:  [8.37383287]


portfolio before change:  [8.70850458]
curr_Stock_Price:  103.8385856892654
curr_Factors:  [103.83858569  -0.11924614  -1.04090022]
mat_Sqrt:  [[32.54719771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273823 -0.00477702 -0.03884504]
Stock Position:  -0.002738232201198036
Bond Position:  [8.99283874]


portfolio before change:  [8.70638203]
curr_Stock_Price:  105.43488742923472
curr_Factors:  [ 1.05434887e+02  3.38153931e-02 -1.05902764e+00]
mat_Sqrt:  [[37.82163672  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00617194 0.09783713 0.2612447 ]
Stock Position:  0.006171939606597945
Bond Position:  [8.05564427]


portfolio before change:  [8.68662606]
curr_Stock_Price:  101.9076120431616
curr_Factors:  [ 1.01907612e+02 -8.02060200e-02 -1.06545827e+00]
mat_Sqrt:  [[32.40790431  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.00018065e-03  1.59775564e-01 -1.07655681e+00]
Stock Position:  0.001000180649479249
Bond Position:  [8.58470004]


portfolio before change:  [8.68942678]
curr_Stock_Price:  102.56176712156748
curr_Factors:  [ 1.02561767e+02 -6.55546846e-02 -1.08877926e+00]
mat_Sqrt:  [[32.33438703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00021987 -0.04849488 -0.1465592 ]
Stock Position:  -0.0002198745769410744
Bond Position:  [8.7119775]


portfolio before change:  [8.69109909]
curr_Stock_Price:  104.8628846328679
curr_Factors:  [ 1.04862885e+02 -6.29901392e-02 -1.11159555e+00]
mat_Sqrt:  [[32.39706865  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00028811 -0.0028616  -0.22191773]
Stock Position:  0.00028811276616455236
Bond Position:  [8.66088675]


portfolio before change:  [8.69459277]
curr_Stock_Price:  109.47284314845821
curr_Factors:  [109.47284315  -0.5133702   -1.15857613]
mat_Sqrt:  [[20.56787059  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00269726  0.00573223  0.1445309 ]
Stock Position:  -0.0026972631920355655
Bond Position:  [8.98986984]


portfolio before change:  [8.69508792]
curr_Stock_Price:  110.12261106078837
curr_Factors:  [110.12261106  -0.6540863   -1.17002699]
mat_Sqrt:  [[17.76945736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00086022 -0.08719403 -0.07871021]
Stock Position:  -0.0008602199023283199
Bond Position:  [8.78981758]


portfolio before change:  [8.69723706]
curr_Stock_Price:  110.17909397364478
curr_Factors:  [110.17909397  -0.46065403  -1.16048289]
mat_Sqrt:  [[21.77952352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01031161 -0.01308848 -0.30054989]
Stock Position:  -0.010311614826095255
Bond Position:  [9.83336144]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.70417216]
Stock Price:  109.74497710434521
PL:  [-1.04080495]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.27176073e-02 -3.50548624e-03  4.39242710e-02]
 [ 2.34028871e-02  1.41605307e-01 -9.43189355e-02]
 [-7.91072849e-02  1.28483307e-02 -2.84943662e-02]
 [-1.28549747e-01 -8.11099613e-02  6.13923044e-01]
 [ 2.15584444e-02 -7.14857411e-02  3.87618410e-02]
 [-1.02187312e+00  1.12243422e+00 -1.64841658e-01]
 [ 9.70697307e-03 -3.61911514e-03  2.57319643e-02]
 [-9.21554590e-02 -1.46378509e-02 -3.21908156e-02]
 [-8.93455539e-02  1.41504673e-02  5.20849545e-02]
 [-3.41698772e-01  2.35720154e-01 -1.68711520e-01]
 [ 1.17675213e-01  3.22177959e-02 -5.26894848e-02]
 [ 1.47937008e-02  9.50276734e-02 -1.13258492e-02]
 [-7.34764818e-02 -9.12272841e-02 -9.06310822e-02]
 [ 2.70313479e-02  9.39027654e-01 -5.59752390e-01]
 [ 1.23232495e-01 -6.05378991e-02 -2.72385053e-02]
 [ 1.57541007e-02 -3.40204910e-02 -1.17071981e-01]
 [-8.50317169e-02  1.61289714e-02  5.80930595e-02]
 [ 3.78934585e-02 -1.47913888e-01 -4.30551257e-02]
 [-1.78900377e-01  1.82446221e-02 -3.72390485e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.37354062]
curr_Stock_Price:  100.76692526848402
curr_Factors:  [100.76692527  -1.21268998  -0.96943209]
mat_Sqrt:  [[11.36670094  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.000393   -0.00113139  0.12530372]
Stock Position:  -0.0003930038633748507
Bond Position:  [8.41314241]


portfolio before change:  [8.37554606]
curr_Stock_Price:  101.01655686335741
curr_Factors:  [101.01655686  -1.46150632  -1.00194385]
mat_Sqrt:  [[ 8.60061971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00384335  0.04570292 -0.26906567]
Stock Position:  0.003843348313032933
Bond Position:  [7.98730425]


portfolio before change:  [8.3772736]
curr_Stock_Price:  100.94642468635357
curr_Factors:  [100.94642469  -1.33873889  -0.99310212]
mat_Sqrt:  [[ 9.8035927   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00839499  0.00414678 -0.0812865 ]
Stock Position:  -0.008394985504177322
Bond Position:  [9.22471737]


portfolio before change:  [8.37082814]
curr_Stock_Price:  101.98894319282863
curr_Factors:  [101.98894319  -1.49449532  -1.04210963]
mat_Sqrt:  [[ 8.07085531  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.002452   -0.02617813  1.75135156]
Stock Position:  -0.0024519993312624496
Bond Position:  [8.62090496]


portfolio before change:  [8.37212785]
curr_Stock_Price:  102.33795547344955
curr_Factors:  [102.33795547  -1.5330786   -1.08365387]
mat_Sqrt:  [[ 7.47488068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00199049 -0.02307192  0.11057674]
Stock Position:  0.001990494151778073
Bond Position:  [8.16842475]


portfolio before change:  [8.37494374]
curr_Stock_Price:  102.72656341032797
curr_Factors:  [102.72656341  -1.32704942  -1.07292298]
mat_Sqrt:  [[ 9.31940084  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0886758   0.36226409 -0.47024737]
Stock Position:  -0.08867580365889617
Bond Position:  [17.48430431]


portfolio before change:  [8.38936245]
curr_Stock_Price:  102.61326207957644
curr_Factors:  [102.61326208  -1.32490577  -1.06724216]
mat_Sqrt:  [[ 9.38224672  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00151571 -0.00116806  0.07340613]
Stock Position:  0.0015157072633003167
Bond Position:  [8.23383078]


portfolio before change:  [8.3911297]
curr_Stock_Price:  102.42096571229563
curr_Factors:  [102.42096571  -1.45503437  -1.07340574]
mat_Sqrt:  [[ 8.17149042  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01244746 -0.00472435 -0.09183144]
Stock Position:  -0.012447462491824685
Bond Position:  [9.66601083]


portfolio before change:  [8.39023748]
curr_Stock_Price:  102.68680474922786
curr_Factors:  [102.68680475  -1.42595461  -1.04463499]
mat_Sqrt:  [[ 8.68062922  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.008735    0.00456704  0.14858388]
Stock Position:  -0.008735001012423835
Bond Position:  [9.28720682]


portfolio before change:  [8.40229989]
curr_Stock_Price:  101.57171445252543
curr_Factors:  [101.57171445  -1.37365337  -0.99751076]
mat_Sqrt:  [[ 9.48395064  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03458693  0.07607835 -0.48128701]
Stock Position:  -0.03458692528760205
Bond Position:  [11.91535319]


portfolio before change:  [8.42022898]
curr_Stock_Price:  101.13947358293821
curr_Factors:  [101.13947358  -1.29545307  -0.94719783]
mat_Sqrt:  [[10.73865222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01056897  0.01039825 -0.15030843]
Stock Position:  0.010568965717446005
Bond Position:  [7.35128935]


portfolio before change:  [8.4236765]
curr_Stock_Price:  101.29175613244877
curr_Factors:  [101.29175613  -0.77306466  -0.90246234]
mat_Sqrt:  [[18.96277833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00168115  0.03067005 -0.0323095 ]
Stock Position:  0.0016811494392974125
Bond Position:  [8.25338992]


portfolio before change:  [8.42652995]
curr_Stock_Price:  101.76158186859054
curr_Factors:  [101.76158187  -0.74994769  -0.91750723]
mat_Sqrt:  [[19.20513558  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00575878 -0.02944348 -0.25854525]
Stock Position:  -0.005758780766958304
Bond Position:  [9.01255259]


portfolio before change:  [8.41077108]
curr_Stock_Price:  104.88937807050357
curr_Factors:  [104.88937807  -1.22770981  -0.90893832]
mat_Sqrt:  [[12.38217724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00843556  0.30306987 -1.59681776]
Stock Position:  0.00843555903121602
Bond Position:  [7.52597054]


portfolio before change:  [8.40442508]
curr_Stock_Price:  103.91401553906327
curr_Factors:  [103.91401554  -1.02071157  -0.93266854]
mat_Sqrt:  [[14.73438194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00714758 -0.01953852 -0.07770387]
Stock Position:  0.007147582538853858
Bond Position:  [7.66169108]


portfolio before change:  [8.42347013]
curr_Stock_Price:  106.31054372702393
curr_Factors:  [106.31054373  -1.08942078  -0.93514103]
mat_Sqrt:  [[14.03848745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00107473 -0.01098007 -0.33397378]
Stock Position:  -0.0010747255381662647
Bond Position:  [8.53772478]


portfolio before change:  [8.42716099]
curr_Stock_Price:  104.86257877198743
curr_Factors:  [104.86257877  -0.58470383  -0.91545543]
mat_Sqrt:  [[23.39427788  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00298711  0.0052056   0.16572333]
Stock Position:  -0.0029871068755387056
Bond Position:  [8.74039672]


portfolio before change:  [8.42702863]
curr_Stock_Price:  105.6384906521932
curr_Factors:  [105.63849065  -0.51176161  -0.87720931]
mat_Sqrt:  [[26.33903016  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.13047893e-05 -4.77390019e-02 -1.22824289e-01]
Stock Position:  -4.130478928088095e-05
Bond Position:  [8.43139201]


portfolio before change:  [8.42910009]
curr_Stock_Price:  106.5258625314759
curr_Factors:  [106.52586253  -0.79012322  -0.90344261]
mat_Sqrt:  [[19.58613608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00933199  0.00588843 -0.10623264]
Stock Position:  -0.009331988572055116
Bond Position:  [9.42319822]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.41573012]
Stock Price:  108.21104067324376
PL:  [0.20468945]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 1.99248841e-02 -4.11698876e-02  4.84843802e-02]
 [ 3.88594612e-02  1.70202991e-01 -2.72035661e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-2.24248175e-01 -2.19470535e-01  6.66963854e-01]
 [-7.36475877e-02  6.90654542e-02 -5.59032175e-02]
 [-1.35493795e+00  1.32399353e+00 -1.88121097e-01]
 [-5.22144041e-02  4.54840270e-02 -1.11518011e-01]
 [ 3.57666796e-02  2.86538058e-02 -5.68823423e-02]
 [-3.15686308e-02  2.93075234e-02  5.22872400e-02]
 [ 1.54550709e-01  1.17949315e-01  8.66698235e-02]
 [-1.06099776e-01 -1.34635877e-01 -3.03812598e-04]
 [ 7.78461160e-02 -4.25943375e-02 -4.23958103e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-5.66930565e-02 -4.81853014e-02 -5.69593960e-03]
 [-2.38465046e-02 -3.14882054e-02 -5.28398422e-02]
 [ 5.80530564e-02  9.89626842e-02 -1.51350982e-01]
 [ 3.24088290e-01 -5.12028094e-01  2.54687466e-01]
 [-3.39626400e-01  1.98552366e-01  5.58225204e-01]
 [ 5.07102772e-01 -5.39977265e-01 -8.94477688e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.89032363]
curr_Stock_Price:  101.21025675237172
curr_Factors:  [101.21025675  -1.05212095  -0.97831706]
mat_Sqrt:  [[13.28668085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00161199 -0.01328752  0.13831244]
Stock Position:  0.0016119863867730094
Bond Position:  [11.72717408]


portfolio before change:  [11.8921881]
curr_Stock_Price:  100.5479090536531
curr_Factors:  [100.54790905  -0.92496916  -0.96495124]
mat_Sqrt:  [[15.19116367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011897   0.05493278 -0.77604202]
Stock Position:  0.0011897017946674122
Bond Position:  [11.77256607]


portfolio before change:  [11.8957542]
curr_Stock_Price:  101.07122667695825
curr_Factors:  [101.07122668  -0.8747076   -0.9983496 ]
mat_Sqrt:  [[15.5299169   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00502403  0.01370813 -0.02999186]
Stock Position:  -0.0050240280730875515
Bond Position:  [12.40353888]


portfolio before change:  [11.90638701]
curr_Stock_Price:  99.5721219084606
curr_Factors:  [99.57212191 -0.85324472 -0.9773382 ]
mat_Sqrt:  [[15.96341128  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00832554 -0.07083381  1.90266223]
Stock Position:  -0.008325537777395989
Bond Position:  [12.73537848]


portfolio before change:  [11.91846262]
curr_Stock_Price:  98.50415952245721
curr_Factors:  [98.50415952 -0.50096175 -0.99241167]
mat_Sqrt:  [[22.12537995  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00320722  0.02229078 -0.15947632]
Stock Position:  -0.0032072153148468164
Bond Position:  [12.23438667]


portfolio before change:  [11.92260694]
curr_Stock_Price:  98.16575269871468
curr_Factors:  [98.1657527  -0.45370778 -0.969738  ]
mat_Sqrt:  [[23.64641762  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04749468  0.42731708 -0.53665713]
Stock Position:  -0.04749467654999668
Bond Position:  [16.58495761]


portfolio before change:  [11.97964704]
curr_Stock_Price:  97.05208384071284
curr_Factors:  [97.05208384 -0.23183723 -0.93706577]
mat_Sqrt:  [[30.15482006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00217854  0.01467991 -0.31812984]
Stock Position:  -0.002178541753598081
Bond Position:  [12.19107906]


portfolio before change:  [11.98101069]
curr_Stock_Price:  97.82530707420017
curr_Factors:  [97.82530707 -0.53289054 -0.90621855]
mat_Sqrt:  [[23.19818913  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012934   0.00924798 -0.16226949]
Stock Position:  0.001293400683768339
Bond Position:  [11.85448337]


portfolio before change:  [11.98090449]
curr_Stock_Price:  95.45156730810373
curr_Factors:  [95.45156731 -0.18696091 -0.93364115]
mat_Sqrt:  [[31.12517275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047914  0.00945896  0.14916094]
Stock Position:  -0.00047913531588852676
Bond Position:  [12.0266387]


portfolio before change:  [11.98342053]
curr_Stock_Price:  96.47632260514735
curr_Factors:  [ 9.64763226e+01 -7.22768187e-02 -8.81524726e-01]
mat_Sqrt:  [[37.16978025  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00528167 0.03806798 0.24724488]
Stock Position:  0.005281667379410326
Bond Position:  [11.47386468]


portfolio before change:  [11.98223004]
curr_Stock_Price:  95.7077558764215
curr_Factors:  [95.70775588  0.18573293 -0.84403686]
mat_Sqrt:  [[49.55065124  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00269712 -0.04345354 -0.00086669]
Stock Position:  -0.0026971234723520603
Bond Position:  [12.24036567]


portfolio before change:  [12.00017012]
curr_Stock_Price:  90.19091220003348
curr_Factors:  [90.1909122   0.15709405 -0.80866849]
mat_Sqrt:  [[47.00971248  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00128692 -0.01374726 -0.12094345]
Stock Position:  0.0012869165012439592
Bond Position:  [11.88410195]


portfolio before change:  [12.00754797]
curr_Stock_Price:  93.61495562530814
curr_Factors:  [93.61495563 -0.10634534 -0.78814733]
mat_Sqrt:  [[38.27119314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00044057 -0.00995959  0.34984664]
Stock Position:  0.00044056957799264764
Bond Position:  [11.96630407]


portfolio before change:  [12.01001551]
curr_Stock_Price:  92.42465173791295
curr_Factors:  [92.42465174  0.26109223 -0.79734691]
mat_Sqrt:  [[54.06240684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012521  -0.01555174 -0.01624893]
Stock Position:  -0.001252099614372846
Bond Position:  [12.12574038]


portfolio before change:  [12.01384753]
curr_Stock_Price:  91.78556187112592
curr_Factors:  [91.78556187  0.17482368 -0.79659633]
mat_Sqrt:  [[49.28808471  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083306 -0.01016277 -0.15073736]
Stock Position:  -0.0008330592569386285
Bond Position:  [12.09031034]


portfolio before change:  [12.01705289]
curr_Stock_Price:  91.56660449154607
curr_Factors:  [91.56660449  0.32003757 -0.7831758 ]
mat_Sqrt:  [[57.62338061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00082188  0.03194007 -0.43176222]
Stock Position:  0.0008218771520699478
Bond Position:  [11.94179639]


portfolio before change:  [12.01428177]
curr_Stock_Price:  84.56197290533949
curr_Factors:  [84.56197291  0.21921495 -0.77007599]
mat_Sqrt:  [[48.74602383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00557089 -0.16525636  0.72655245]
Stock Position:  0.005570892408026431
Bond Position:  [11.54319611]


portfolio before change:  [11.99840818]
curr_Stock_Price:  81.19451541937022
curr_Factors:  [81.19451542  0.40246336 -0.82478184]
mat_Sqrt:  [[53.22505408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347862  0.0640825   1.59246113]
Stock Position:  -0.0034786216451226405
Bond Position:  [12.28085318]


portfolio before change:  [11.9954366]
curr_Stock_Price:  82.93146105338577
curr_Factors:  [ 8.29314611e+01  3.63833895e-02 -8.02219818e-01]
mat_Sqrt:  [[38.55855781  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00555767 -0.17427691 -2.55169587]
Stock Position:  0.005557673644412801
Bond Position:  [11.53453061]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.96383336]
Stock Price:  76.72612473496042
PL:  [11.96383336]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-7.12613806e-02  1.46145302e-01  1.58022645e-02]
 [ 5.85146545e-02  1.11572088e-01 -2.80135551e-01]
 [-3.61270519e-02  1.46326660e-02 -1.78005810e-02]
 [-2.42275189e-01 -2.41550804e-01  6.98921050e-01]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-1.29181467e+00  1.16248180e+00 -1.49104265e-01]
 [-2.60705131e-01 -2.20796253e-01 -1.53700293e-01]
 [ 2.26621855e-01 -3.20270893e-01  1.07342037e-01]
 [ 3.72565936e-03  2.48828593e-02  4.31237623e-02]
 [ 1.40870180e-01  1.68967008e-01  1.09904865e-01]
 [-2.01238068e-01 -1.00463982e-01  1.47621136e-02]
 [-6.95024458e-02  1.34004724e-01  9.07187313e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-5.76986295e-02 -5.20228826e-02 -5.80273482e-03]
 [ 3.09491985e-02  1.99990102e-01 -3.15293555e-02]
 [ 6.00729772e-02  6.35159227e-02 -1.54830546e-02]
 [ 1.87456959e-01 -7.81489613e-02  1.74166230e-01]
 [-1.00659229e-01  1.13130079e-01  9.13822146e-02]
 [ 1.43228302e-01 -1.57153686e-01 -3.48110171e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.12603995]
curr_Stock_Price:  99.5693924278103
curr_Factors:  [99.56939243 -0.78395218 -0.97768189]
mat_Sqrt:  [[17.10243306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223383  0.04716819  0.04507946]
Stock Position:  -0.0022338325772431884
Bond Position:  [-0.90361859]


portfolio before change:  [-1.12587082]
curr_Stock_Price:  99.39253926953205
curr_Factors:  [99.39253927 -0.53451116 -0.97207849]
mat_Sqrt:  [[22.03181189  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00109418  0.03600974 -0.79914875]
Stock Position:  0.00109418063013375
Bond Position:  [-1.23462421]


portfolio before change:  [-1.1256914]
curr_Stock_Price:  99.83864110045134
curr_Factors:  [99.8386411  -0.6525934  -1.02497776]
mat_Sqrt:  [[18.65257366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00197151  0.00472267 -0.0507801 ]
Stock Position:  -0.001971508088459441
Bond Position:  [-0.92885871]


portfolio before change:  [-1.12419886]
curr_Stock_Price:  98.96378685674024
curr_Factors:  [98.96378686 -0.56098375 -0.99400383]
mat_Sqrt:  [[20.90036066  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00712499 -0.07796019  1.99382721]
Stock Position:  -0.007124990866636046
Bond Position:  [-0.41908278]


portfolio before change:  [-1.10532117]
curr_Stock_Price:  96.2995768827197
curr_Factors:  [96.29957688 -0.68018385 -0.95659764]
mat_Sqrt:  [[18.74041524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00303074 -0.04522423  0.24245377]
Stock Position:  0.0030307429892237102
Bond Position:  [-1.39718044]


portfolio before change:  [-1.10883557]
curr_Stock_Price:  95.25525680327428
curr_Factors:  [95.2552568  -0.46676849 -0.90312402]
mat_Sqrt:  [[24.20762579  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04481893  0.37518939 -0.42535296]
Stock Position:  -0.04481892824351194
Bond Position:  [3.16040294]


portfolio before change:  [-1.06646663]
curr_Stock_Price:  94.32755174003125
curr_Factors:  [94.32755174 -0.37931038 -0.86594005]
mat_Sqrt:  [[27.15395993  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0124162  -0.07126168 -0.43846416]
Stock Position:  -0.012416197084959155
Bond Position:  [0.10472284]


portfolio before change:  [-1.03025773]
curr_Stock_Price:  91.41339758533154
curr_Factors:  [91.41339759 -0.57630518 -0.8619902 ]
mat_Sqrt:  [[21.69532211  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00844228 -0.10336699  0.30621695]
Stock Position:  0.008442277722621194
Bond Position:  [-1.80199502]


portfolio before change:  [-1.04232301]
curr_Stock_Price:  90.03761696117097
curr_Factors:  [90.03761696 -0.81120267 -0.86521987]
mat_Sqrt:  [[16.84080833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00104552 0.00803091 0.12302009]
Stock Position:  0.0010455230251049208
Bond Position:  [-1.13645941]


portfolio before change:  [-1.04316319]
curr_Stock_Price:  89.50579793319662
curr_Factors:  [89.50579793 -0.78300977 -0.84114115]
mat_Sqrt:  [[17.63970764  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01121304 0.05453387 0.31352799]
Stock Position:  0.011213035199963505
Bond Position:  [-2.04679485]


portfolio before change:  [-1.0262154]
curr_Stock_Price:  91.06287445571267
curr_Factors:  [91.06287446 -1.06459869 -0.86886527]
mat_Sqrt:  [[13.17190619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01660594 -0.03242461  0.0421122 ]
Stock Position:  -0.01660594038102142
Bond Position:  [0.48596927]


portfolio before change:  [-1.03507365]
curr_Stock_Price:  91.60363056134166
curr_Factors:  [91.60363056 -1.32886471 -0.89804566]
mat_Sqrt:  [[ 9.88047454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00239168  0.04324984  0.25879529]
Stock Position:  -0.0023916829515332073
Bond Position:  [-0.81598681]


portfolio before change:  [-1.03732481]
curr_Stock_Price:  92.45957012886097
curr_Factors:  [92.45957013 -1.15560087 -0.88445658]
mat_Sqrt:  [[12.02170803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00140256 -0.00995959  0.34984664]
Stock Position:  0.0014025563893574524
Bond Position:  [-1.16700457]


portfolio before change:  [-1.03727905]
curr_Stock_Price:  92.70024101728744
curr_Factors:  [92.70024102 -0.89972042 -0.8435751 ]
mat_Sqrt:  [[16.21725091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0042857  -0.01679031 -0.01655359]
Stock Position:  -0.004285697655765578
Bond Position:  [-0.63999384]


portfolio before change:  [-1.041474]
curr_Stock_Price:  93.64172869787727
curr_Factors:  [93.6417287  -0.91677629 -0.86997211]
mat_Sqrt:  [[15.68535859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00416542  0.06454653 -0.08994448]
Stock Position:  0.004165419869977562
Bond Position:  [-1.43153111]


portfolio before change:  [-1.04370096]
curr_Stock_Price:  93.1930258491818
curr_Factors:  [93.19302585 -1.13881589 -0.8496066 ]
mat_Sqrt:  [[12.75917218  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00547666  0.02049968 -0.04416885]
Stock Position:  0.005476659794019709
Bond Position:  [-1.55408746]


portfolio before change:  [-1.04191885]
curr_Stock_Price:  93.58937656841661
curr_Factors:  [93.58937657 -0.91632004 -0.89283682]
mat_Sqrt:  [[15.32920777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01350731 -0.02522247  0.49684778]
Stock Position:  0.013507312617248612
Bond Position:  [-2.30605982]


portfolio before change:  [-1.02624759]
curr_Stock_Price:  94.79226942161574
curr_Factors:  [94.79226942 -0.65760842 -0.89623552]
mat_Sqrt:  [[20.04227752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00293945  0.03651258  0.26068802]
Stock Position:  -0.002939452973286552
Bond Position:  [-0.74761017]


portfolio before change:  [-1.02364965]
curr_Stock_Price:  93.84485973116331
curr_Factors:  [93.84485973 -0.67567284 -0.91981821]
mat_Sqrt:  [[19.03257418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210648 -0.05072113 -0.99306142]
Stock Position:  0.002106480660235497
Bond Position:  [-1.22133203]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.02213778]
Stock Price:  94.70755000855115
PL:  [-1.02213778]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.32913778e-02  3.34053587e-02  3.74537704e-02]
 [-7.31571120e-03 -5.15860781e-02  9.78179389e-02]
 [ 2.09725994e-01  1.05349149e-01  3.55193906e-01]
 [ 1.98843602e-02  3.67938576e-02 -6.01828296e-02]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-1.38141906e+00  1.24051291e+00 -1.58978813e-01]
 [-4.67703930e-01 -5.16311394e-01 -1.86580000e-01]
 [ 1.89117075e-01 -2.52243800e-01  7.60949816e-02]
 [ 9.46491021e-03  2.63602073e-02  4.46569366e-02]
 [ 1.52726526e-01  1.23202936e-01  8.81967288e-02]
 [-1.09849569e-01 -9.15995488e-02 -6.84058878e-03]
 [ 1.14025921e-01 -3.33446025e-02 -3.33416604e-02]
 [-5.01861779e-02 -3.77195111e-02  6.27158872e-02]
 [ 1.11641853e-02  4.91074235e-01 -3.68024355e-01]
 [ 1.14217985e-01 -5.98520676e-02 -3.56257048e-02]
 [ 2.11184103e-02 -2.44958784e-02 -5.77932733e-02]
 [-8.10088653e-02  1.64551000e-02  5.47233057e-02]
 [ 3.68703399e-02 -1.20157835e-01 -4.46544789e-02]
 [-9.80985491e-02  9.92021122e-03 -5.76489389e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.99361538]
curr_Stock_Price:  99.83659968391349
curr_Factors:  [99.83659968 -1.0744386  -1.0307104 ]
mat_Sqrt:  [[12.16284545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00237011  0.01078153  0.10684518]
Stock Position:  -0.0023701130483269072
Bond Position:  [1.2302394]


portfolio before change:  [0.99758709]
curr_Stock_Price:  98.29063298829652
curr_Factors:  [98.29063299 -0.90222447 -0.98120625]
mat_Sqrt:  [[14.94681177  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.41925109e-04 -1.66493351e-02  2.79047353e-01]
Stock Position:  0.00014192510877650348
Bond Position:  [0.98363718]


portfolio before change:  [0.99748202]
curr_Stock_Price:  95.81741022280619
curr_Factors:  [95.81741022 -0.94009944 -0.97564053]
mat_Sqrt:  [[14.10746983  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02153001 0.03400129 1.01326935]
Stock Position:  0.021530008956556268
Bond Position:  [-1.06546768]


portfolio before change:  [0.99575812]
curr_Stock_Price:  95.74971400839205
curr_Factors:  [95.74971401 -0.9597972  -0.99600406]
mat_Sqrt:  [[13.54390171  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00111564  0.01187517 -0.17168486]
Stock Position:  0.0011156391018020653
Bond Position:  [0.88893599]


portfolio before change:  [0.99542771]
curr_Stock_Price:  95.25432767762611
curr_Factors:  [95.25432768 -0.8551618  -1.00238663]
mat_Sqrt:  [[14.86488942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00382091 -0.04522423  0.24245377]
Stock Position:  0.0038209084840494776
Bond Position:  [0.63146964]


portfolio before change:  [0.99191559]
curr_Stock_Price:  94.29382131628525
curr_Factors:  [94.29382132 -0.59375463 -1.0331407 ]
mat_Sqrt:  [[18.53239616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06262827  0.40037382 -0.4535223 ]
Stock Position:  -0.06262826578637078
Bond Position:  [6.89737409]


portfolio before change:  [1.14611655]
curr_Stock_Price:  91.85919531896054
curr_Factors:  [91.85919532 -0.46207449 -1.00902609]
mat_Sqrt:  [[21.09753789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02896931 -0.16663879 -0.53226081]
Stock Position:  -0.028969306197943218
Bond Position:  [3.80721371]


portfolio before change:  [1.12906033]
curr_Stock_Price:  92.48082369885236
curr_Factors:  [92.4808237  -0.50943112 -1.02260581]
mat_Sqrt:  [[19.98464803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00766393 -0.08141134  0.2170778 ]
Stock Position:  0.007663925221728019
Bond Position:  [0.42029421]


portfolio before change:  [1.1377144]
curr_Stock_Price:  93.5963077444979
curr_Factors:  [93.59630774 -0.64210659 -1.03572942]
mat_Sqrt:  [[17.48170546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00137065 0.00850772 0.12739381]
Stock Position:  0.0013706456759514393
Bond Position:  [1.00942703]


portfolio before change:  [1.14038889]
curr_Stock_Price:  95.36342848920316
curr_Factors:  [95.36342849 -0.70496592 -1.05092665]
mat_Sqrt:  [[16.4743164   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01188992 0.03976358 0.25160072]
Stock Position:  0.011889919855541485
Bond Position:  [0.00652536]


portfolio before change:  [1.13289799]
curr_Stock_Price:  94.73327046199252
curr_Factors:  [94.73327046 -0.35195804 -1.0354916 ]
mat_Sqrt:  [[23.6559725   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00549306 -0.02956363 -0.0195143 ]
Stock Position:  -0.005493055862739602
Bond Position:  [1.65327314]


portfolio before change:  [1.12450715]
curr_Stock_Price:  96.33606003552251
curr_Factors:  [96.33606004 -0.2411663  -1.04368097]
mat_Sqrt:  [[26.65549812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00376709 -0.01076192 -0.09511448]
Stock Position:  0.003767089397753022
Bond Position:  [0.7616006]


portfolio before change:  [1.14216521]
curr_Stock_Price:  100.97296534391495
curr_Factors:  [100.97296534  -0.35795871  -1.05591742]
mat_Sqrt:  [[24.55650244  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183592 -0.01217392  0.17891097]
Stock Position:  -0.0018359216290176894
Bond Position:  [1.32754366]


portfolio before change:  [1.14127077]
curr_Stock_Price:  101.64094735353547
curr_Factors:  [101.64094735  -0.21463115  -1.06727655]
mat_Sqrt:  [[28.20611463  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012863   0.15849353 -1.04987105]
Stock Position:  0.001286303958870887
Bond Position:  [1.01052962]


portfolio before change:  [1.14510915]
curr_Stock_Price:  104.42855405117493
curr_Factors:  [104.42855405  -0.17378779  -1.07645778]
mat_Sqrt:  [[29.91193515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00316692 -0.01931717 -0.10163022]
Stock Position:  0.0031669186804983564
Bond Position:  [0.81439241]


portfolio before change:  [1.14835632]
curr_Stock_Price:  105.3895979672406
curr_Factors:  [105.38959797  -0.16899516  -1.09170207]
mat_Sqrt:  [[29.87334785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.44650929e-04 -7.90601076e-03 -1.64868122e-01]
Stock Position:  0.00014465092918535146
Bond Position:  [1.13311161]


portfolio before change:  [1.14864006]
curr_Stock_Price:  105.39256586879554
curr_Factors:  [105.39256587  -0.11576919  -1.08979338]
mat_Sqrt:  [[31.56754488  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00210595  0.00531086  0.15611036]
Stock Position:  -0.002105948826840423
Bond Position:  [1.37059141]


portfolio before change:  [1.15450045]
curr_Stock_Price:  102.77251306817571
curr_Factors:  [ 1.02772513e+02  2.37597756e-02 -1.10328760e+00]
mat_Sqrt:  [[34.91756907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.24510866e-05 -3.87807745e-02 -1.27386799e-01]
Stock Position:  9.245108659955606e-05
Bond Position:  [1.14499902]


portfolio before change:  [1.15482162]
curr_Stock_Price:  103.14988791899326
curr_Factors:  [ 1.03149888e+02 -4.25749421e-02 -1.10248410e+00]
mat_Sqrt:  [[32.82282337  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328555  0.00320173 -0.16445638]
Stock Position:  -0.0032855532745163893
Bond Position:  [1.49372607]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.15162012]
Stock Price:  104.23797848648279
PL:  [-3.08635837]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-2.58295560e-02  1.23241971e-02  4.11493149e-02]
 [ 3.66710161e-02  1.79461202e-01 -2.44391954e-01]
 [ 8.10953291e-02 -5.61129654e-02 -3.07621565e-02]
 [-2.86138149e-01 -2.93877815e-01  1.03829468e+00]
 [-7.01291661e-02  6.38712627e-02 -5.24047881e-02]
 [-1.41982102e+00  1.39108172e+00 -1.99967978e-01]
 [-1.14959484e-02 -2.12280475e-02 -2.06637414e-02]
 [ 1.89426808e-02  3.65040457e-02 -4.51608798e-02]
 [ 1.56948940e-02  2.90561924e-02  5.30314276e-02]
 [ 1.55307933e-01  1.26006077e-01  9.64198219e-02]
 [ 6.54016104e-02  1.96235228e-02 -5.61865769e-02]
 [ 7.47767917e-02  1.74302369e-02 -2.46337890e-02]
 [-5.46899103e-02 -5.76094562e-02  9.71768521e-02]
 [ 2.95044032e-02  3.11687840e-01 -2.04266668e-01]
 [-1.67923210e-02 -2.23939208e-01 -5.84505234e-02]
 [ 5.57814673e-02  5.74618668e-02  8.54976881e-02]
 [-8.44861647e-02  1.63602243e-02  5.83098803e-02]
 [ 4.15537708e-02 -1.44036951e-01 -4.16785019e-02]
 [-9.28563190e-02 -2.10641995e-02 -1.03873149e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.68753098]
curr_Stock_Price:  100.17619914165945
curr_Factors:  [100.17619914  -0.86475937  -0.9719543 ]
mat_Sqrt:  [[15.96209672  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093436  0.00397762  0.11738754]
Stock Position:  -0.0009343585232298084
Bond Position:  [3.78113147]


portfolio before change:  [3.68786688]
curr_Stock_Price:  100.82851725423977
curr_Factors:  [100.82851725  -0.89748612  -0.92342619]
mat_Sqrt:  [[16.32191868  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0014347   0.05792085 -0.69718222]
Stock Position:  0.0014347015364874318
Bond Position:  [3.54320806]


portfolio before change:  [3.68624696]
curr_Stock_Price:  99.08192426344559
curr_Factors:  [99.08192426 -0.81218604 -0.97130632]
mat_Sqrt:  [[16.65074008  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00380536 -0.01811038 -0.08775587]
Stock Position:  0.003805357528298061
Bond Position:  [3.30920481]


portfolio before change:  [3.69657836]
curr_Stock_Price:  101.57945472892705
curr_Factors:  [101.57945473  -0.78062293  -0.97791972]
mat_Sqrt:  [[17.50171099  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00766695 -0.09484866  2.96196571]
Stock Position:  -0.007666947142634426
Bond Position:  [4.47538267]


portfolio before change:  [3.71105156]
curr_Stock_Price:  99.83766361014816
curr_Factors:  [99.83766361 -0.61229242 -1.00263907]
mat_Sqrt:  [[19.85814022  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00341364  0.02061436 -0.14949627]
Stock Position:  -0.0034136420140773176
Bond Position:  [4.05186161]


portfolio before change:  [3.71848663]
curr_Stock_Price:  97.95639484860125
curr_Factors:  [97.95639485 -0.43470891 -1.01376612]
mat_Sqrt:  [[23.0127267   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05113197  0.4489697  -0.57045298]
Stock Position:  -0.05113196528351953
Bond Position:  [8.72718961]


portfolio before change:  [3.67931543]
curr_Stock_Price:  98.76515070048526
curr_Factors:  [98.7651507  -0.25251269 -1.00610324]
mat_Sqrt:  [[28.05393454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071459 -0.00685132 -0.0589479 ]
Stock Position:  -0.0007145904592251461
Bond Position:  [3.74989206]


portfolio before change:  [3.68068743]
curr_Stock_Price:  98.15723514490362
curr_Factors:  [98.15723514 -0.30760075 -0.99582916]
mat_Sqrt:  [[26.659371    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00064426  0.01178163 -0.12883142]
Stock Position:  0.0006442617106918345
Bond Position:  [3.61744848]


portfolio before change:  [3.68171618]
curr_Stock_Price:  98.35013138010285
curr_Factors:  [98.35013138 -0.26944432 -0.99601661]
mat_Sqrt:  [[27.74548018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00116959 0.00937785 0.1512839 ]
Stock Position:  0.0011695944388175098
Bond Position:  [3.56668641]


portfolio before change:  [3.68228697]
curr_Stock_Price:  98.07567990253776
curr_Factors:  [ 9.80756799e+01 -5.72424871e-02 -1.03997021e+00]
mat_Sqrt:  [[32.73768049  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00613087 0.04066829 0.27505891]
Stock Position:  0.006130868967999627
Bond Position:  [3.08099782]


portfolio before change:  [3.69381775]
curr_Stock_Price:  99.83080398186978
curr_Factors:  [99.83080398 -0.28553721 -1.05003561]
mat_Sqrt:  [[26.25624779  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00220664  0.00633346 -0.16028466]
Stock Position:  0.002206644632799779
Bond Position:  [3.47352664]


portfolio before change:  [3.69390549]
curr_Stock_Price:  99.47698684058572
curr_Factors:  [99.47698684 -0.51072239 -1.0525887 ]
mat_Sqrt:  [[20.83460354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00351849  0.00562558 -0.07027334]
Stock Position:  0.003518491371014173
Bond Position:  [3.34389657]


portfolio before change:  [3.69129835]
curr_Stock_Price:  98.49837972881207
curr_Factors:  [98.49837973 -0.60525648 -1.05628264]
mat_Sqrt:  [[18.69957835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249274 -0.01859337  0.27721851]
Stock Position:  -0.0024927433448121866
Bond Position:  [3.93682953]


portfolio before change:  [3.69122596]
curr_Stock_Price:  98.92229684271423
curr_Factors:  [98.92229684 -0.40344431 -1.07123619]
mat_Sqrt:  [[22.63854894  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227186  0.10059682 -0.58271595]
Stock Position:  0.0022718619551535223
Bond Position:  [3.46648816]


portfolio before change:  [3.69732908]
curr_Stock_Price:  101.22718353572054
curr_Factors:  [101.22718354  -0.28261994  -1.10668405]
mat_Sqrt:  [[25.23074632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295017 -0.07227607 -0.16674307]
Stock Position:  -0.0029501657467314456
Bond Position:  [3.99596605]


portfolio before change:  [3.69587889]
curr_Stock_Price:  102.05740793549764
curr_Factors:  [102.05740794  -0.60772847  -1.11850153]
mat_Sqrt:  [[18.16152738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00467818 0.01854574 0.24390111]
Stock Position:  0.0046781838620649305
Bond Position:  [3.21843557]


portfolio before change:  [3.68793307]
curr_Stock_Price:  100.18690947579778
curr_Factors:  [100.18690948  -0.2298604   -1.10084393]
mat_Sqrt:  [[26.47850326  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261511  0.00528024  0.16634186]
Stock Position:  -0.002615109800288046
Bond Position:  [3.94993284]


portfolio before change:  [3.67940813]
curr_Stock_Price:  103.82443858671866
curr_Factors:  [103.82443859  -0.24961911  -1.13298049]
mat_Sqrt:  [[26.05218865  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0001399  -0.04648773 -0.11889716]
Stock Position:  0.00013990236260597274
Bond Position:  [3.66488285]


portfolio before change:  [3.68050929]
curr_Stock_Price:  105.14553391882721
curr_Factors:  [105.14553392   0.11897832  -1.17039585]
mat_Sqrt:  [[36.74227149  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00322133 -0.00679844 -0.29632118]
Stock Position:  -0.0032213318229695246
Bond Position:  [4.01921795]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.6717515]
Stock Price:  108.17618399304651
PL:  [-4.5044325]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-9.50829847e-02  1.75129734e-01  5.36281725e-03]
 [ 8.83207439e-03  1.14707159e-01 -1.26446791e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-3.17363713e-01 -3.38198715e-01  1.08729166e+00]
 [ 1.02054042e-02 -5.47254232e-02  2.74733104e-02]
 [-1.38629567e+00  1.53603067e+00 -2.37496670e-01]
 [ 1.07697354e-02 -6.86691254e-03  3.16702267e-02]
 [-2.44302010e-02 -1.90739829e-01  3.19279206e-01]
 [ 7.89411360e-02  2.72091432e-02  6.22234502e-02]
 [ 1.53243468e-01  1.24713243e-01  9.08059727e-02]
 [-5.87802867e-02 -1.03473110e-01 -1.34862601e-02]
 [-2.91167198e-02  7.48243815e-02 -4.03276570e-03]
 [ 7.82923047e-02 -3.38197368e-03 -6.46526215e-02]
 [ 1.21947592e-02  6.67352383e-01 -4.55313997e-01]
 [ 1.06702179e-01 -5.97923134e-02 -4.08269032e-02]
 [ 5.27232149e-02  5.18430766e-02  6.46325685e-02]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.18741445e-02 -1.24792350e-01 -3.80804119e-02]
 [-1.03915324e-01  1.16679237e-01 -1.47929402e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.25393565]
curr_Stock_Price:  99.04902306644334
curr_Factors:  [99.04902307 -0.94329457 -0.97689774]
mat_Sqrt:  [[14.518484    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00401144  0.05652288  0.01529862]
Stock Position:  -0.0040114447842738415
Bond Position:  [-4.85660597]


portfolio before change:  [-5.26708832]
curr_Stock_Price:  102.02509925092377
curr_Factors:  [102.02509925  -0.9854096   -0.9635096 ]
mat_Sqrt:  [[14.5312231   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00044289  0.03702158 -0.3607175 ]
Stock Position:  0.00044288990078406867
Bond Position:  [-5.31227421]


portfolio before change:  [-5.26915745]
curr_Stock_Price:  100.35223364203125
curr_Factors:  [100.35223364  -0.63556166  -0.94937424]
mat_Sqrt:  [[20.56828713  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00379335  0.01370813 -0.02999186]
Stock Position:  -0.003793351288506553
Bond Position:  [-4.88848618]


portfolio before change:  [-5.27330728]
curr_Stock_Price:  101.1239941151532
curr_Factors:  [101.12399412  -0.60730561  -0.93635343]
mat_Sqrt:  [[21.59989371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00761373 -0.10915317  3.10174046]
Stock Position:  -0.007613729878942753
Bond Position:  [-4.50337651]


portfolio before change:  [-5.28584587]
curr_Stock_Price:  102.6229439388384
curr_Factors:  [102.62294394  -0.73677565  -0.94729478]
mat_Sqrt:  [[19.04855226  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00024372 -0.01766255  0.07837371]
Stock Position:  0.00024372403417277023
Bond Position:  [-5.31085755]


portfolio before change:  [-5.28665497]
curr_Stock_Price:  104.75151088268512
curr_Factors:  [104.75151088  -0.46220406  -0.97496502]
mat_Sqrt:  [[24.88889963  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04504954  0.49575177 -0.67751189]
Stock Position:  -0.04504954189094618
Bond Position:  [-0.56764739]


portfolio before change:  [-5.16838446]
curr_Stock_Price:  102.12301731457376
curr_Factors:  [102.12301731  -0.31105206  -0.92814203]
mat_Sqrt:  [[29.57661583  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00053531 -0.00221629  0.09034634]
Stock Position:  0.0005353110968406916
Bond Position:  [-5.22305205]


portfolio before change:  [-5.16875362]
curr_Stock_Price:  103.87296889163218
curr_Factors:  [103.87296889  -0.17653687  -0.93655613]
mat_Sqrt:  [[34.12655087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.29731081e-05 -6.15610151e-02  9.10814705e-01]
Stock Position:  5.297310806590438e-05
Bond Position:  [-5.1742561]


portfolio before change:  [-5.17012276]
curr_Stock_Price:  102.44931963541316
curr_Factors:  [102.44931964   0.12755052  -0.93113504]
mat_Sqrt:  [[45.86873399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00211901 0.00878171 0.17750618]
Stock Position:  0.0021190139611682083
Bond Position:  [-5.3872143]


portfolio before change:  [-5.18572389]
curr_Stock_Price:  95.72253427216125
curr_Factors:  [ 9.57225343e+01  5.31635935e-02 -9.56133271e-01]
mat_Sqrt:  [[38.80247606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00508308 0.04025103 0.25904416]
Stock Position:  0.005083081395049639
Bond Position:  [-5.67228932]


portfolio before change:  [-5.18264018]
curr_Stock_Price:  96.60820956389281
curr_Factors:  [96.60820956  0.14460483 -0.97341222]
mat_Sqrt:  [[42.17621087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00195974 -0.0333958  -0.03847255]
Stock Position:  -0.0019597426223802567
Bond Position:  [-4.99331295]


portfolio before change:  [-5.19481129]
curr_Stock_Price:  102.18170946465845
curr_Factors:  [102.18170946  -0.13324216  -0.98117805]
mat_Sqrt:  [[33.52637659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043746  0.02414947 -0.01150436]
Stock Position:  -0.0004374597918365867
Bond Position:  [-5.1501109]


portfolio before change:  [-5.19647433]
curr_Stock_Price:  103.03973378414861
curr_Factors:  [103.03973378  -0.57298729  -0.92836551]
mat_Sqrt:  [[22.96019087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00280506 -0.00109153 -0.18443593]
Stock Position:  0.0028050638389457857
Bond Position:  [-5.48550736]


portfolio before change:  [-5.1987992]
curr_Stock_Price:  102.69987435113391
curr_Factors:  [102.69987435  -0.53606132  -0.91002972]
mat_Sqrt:  [[24.18469164  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00229389  0.21538706 -1.2988841 ]
Stock Position:  0.0022938855065907197
Bond Position:  [-5.43438096]


portfolio before change:  [-5.19807793]
curr_Stock_Price:  103.60664688526606
curr_Factors:  [103.60664689  -0.75753842  -0.88032636]
mat_Sqrt:  [[20.14058059  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0042781  -0.01929789 -0.11646779]
Stock Position:  0.004278097506167055
Bond Position:  [-5.64131727]


portfolio before change:  [-5.20477177]
curr_Stock_Price:  102.37167529521129
curr_Factors:  [102.3716753   -0.38069255  -0.90735073]
mat_Sqrt:  [[28.23512548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00270935 0.01673228 0.18437873]
Stock Position:  0.0027093453671918435
Bond Position:  [-5.48213199]


portfolio before change:  [-5.21017547]
curr_Stock_Price:  100.88312518689763
curr_Factors:  [100.88312519  -0.84274046  -0.92605995]
mat_Sqrt:  [[17.20435005  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0039984   0.00525786  0.16709793]
Stock Position:  -0.003998396669671578
Bond Position:  [-4.80680472]


portfolio before change:  [-5.20956805]
curr_Stock_Price:  100.43062476155478
curr_Factors:  [100.43062476  -1.2274352   -0.94528954]
mat_Sqrt:  [[11.43572753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00075447 -0.04027656 -0.10863282]
Stock Position:  0.0007544671811689108
Bond Position:  [-5.28533966]


portfolio before change:  [-5.21040491]
curr_Stock_Price:  101.0729820313596
curr_Factors:  [101.07298203  -1.20271673  -0.93803738]
mat_Sqrt:  [[11.88276156  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00676612  0.03765806 -0.00422001]
Stock Position:  -0.006766123652124345
Bond Position:  [-4.52653261]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.22779823]
Stock Price:  103.4763594890774
PL:  [-8.70415772]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-9.95413651e-02  1.80554374e-01  3.40900145e-03]
 [ 3.93237461e-02  1.19212084e-01 -2.45011876e-01]
 [-7.16084672e-02  2.57498843e-02 -5.37575061e-03]
 [-1.85749983e-01 -1.66355374e-01  6.01732571e-01]
 [-5.71296285e-02  4.46802461e-02 -3.94791156e-02]
 [-1.14817239e+00  1.10813025e+00 -1.47346329e-01]
 [-2.90591039e-03  1.89703573e-02 -1.01748192e-02]
 [-7.36570884e-02 -4.40400385e-03 -3.26962341e-02]
 [ 1.40347849e-01  2.44698956e-02  4.09496248e-02]
 [ 1.55115195e-01  1.23955373e-01  9.39381349e-02]
 [ 1.23864571e-01  3.23306395e-02 -5.27536033e-02]
 [-8.38054796e-02  1.26480203e-01  1.24848486e-01]
 [-1.19585249e-01 -9.04776622e-02  6.58955469e-02]
 [ 3.29178034e-02  2.00588774e-01 -8.09501522e-02]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 3.16555709e-02  1.29729383e-02 -1.09603469e-01]
 [ 4.83990539e-03  2.37009068e-02  8.72966411e-02]
 [-1.87725959e-02 -3.29691228e-02  2.74072090e-02]
 [ 1.20416568e-02 -6.90279385e-02 -1.32731772e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.91779977]
curr_Stock_Price:  99.09139691134168
curr_Factors:  [99.09139691 -0.80384443 -0.97808779]
mat_Sqrt:  [[16.67833223  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0037168   0.05827367  0.00972493]
Stock Position:  -0.0037167983815388937
Bond Position:  [-4.54949703]


portfolio before change:  [-4.92158721]
curr_Stock_Price:  99.80435455029831
curr_Factors:  [99.80435455 -0.82869343 -0.98216656]
mat_Sqrt:  [[16.31935507  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00083612  0.03847553 -0.69895068]
Stock Position:  0.0008361219573869575
Bond Position:  [-5.00503582]


portfolio before change:  [-4.92273149]
curr_Stock_Price:  99.93248980658264
curr_Factors:  [99.93248981 -1.27274082 -0.98037954]
mat_Sqrt:  [[10.49999203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00642378  0.00831074 -0.01533552]
Stock Position:  -0.006423777696707951
Bond Position:  [-4.28078739]


portfolio before change:  [-4.92486812]
curr_Stock_Price:  100.0984824501837
curr_Factors:  [100.09848245  -1.08203612  -0.99679649]
mat_Sqrt:  [[12.51993183  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00773798 -0.05369097  1.71657553]
Stock Position:  -0.007737980220802281
Bond Position:  [-4.15030804]


portfolio before change:  [-4.92698334]
curr_Stock_Price:  100.23773244662294
curr_Factors:  [100.23773245  -0.73391206  -1.02831744]
mat_Sqrt:  [[17.20698132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325844  0.01442049 -0.11262293]
Stock Position:  -0.003258442091864759
Bond Position:  [-4.60036449]


portfolio before change:  [-4.92138885]
curr_Stock_Price:  98.16780783482977
curr_Factors:  [98.16780783 -0.94913245 -1.00725228]
mat_Sqrt:  [[13.87784395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06860239  0.3576475  -0.42033806]
Stock Position:  -0.06860238528888257
Bond Position:  [1.81315693]


portfolio before change:  [-5.00598594]
curr_Stock_Price:  99.40756699767782
curr_Factors:  [99.407567   -1.00139422 -1.05080632]
mat_Sqrt:  [[12.76909376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.69700468e-05  6.12265650e-03 -2.90259270e-02]
Stock Position:  -8.697004676708679e-05
Bond Position:  [-4.99734045]


portfolio before change:  [-5.00726032]
curr_Stock_Price:  99.6938249339436
curr_Factors:  [99.69382493 -1.30490464 -1.01928879]
mat_Sqrt:  [[ 9.75627147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00832594 -0.00142139 -0.09327325]
Stock Position:  -0.008325941215959035
Bond Position:  [-4.1772154]


portfolio before change:  [-5.00213202]
curr_Stock_Price:  98.95243856570085
curr_Factors:  [98.95243857 -1.44111487 -1.02044598]
mat_Sqrt:  [[ 8.44081162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01820933 0.00789762 0.11681788]
Stock Position:  0.018209333402086053
Bond Position:  [-6.80398996]


portfolio before change:  [-5.00794587]
curr_Stock_Price:  98.72658514691962
curr_Factors:  [98.72658515 -1.29656726 -1.05105619]
mat_Sqrt:  [[ 9.43787459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02114804 0.04000642 0.26797935]
Stock Position:  0.02114803701623933
Bond Position:  [-7.09581935]


portfolio before change:  [-5.01842224]
curr_Stock_Price:  98.31509550825108
curr_Factors:  [98.31509551 -1.62326652 -1.04289914]
mat_Sqrt:  [[ 6.83469554  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01751296  0.01043467 -0.15049135]
Stock Position:  0.0175129601609907
Bond Position:  [-6.74021059]


portfolio before change:  [-5.02021332]
curr_Stock_Price:  98.30905331376094
curr_Factors:  [98.30905331 -1.31557276 -1.06909996]
mat_Sqrt:  [[ 9.05614374  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00358908  0.04082131  0.35615798]
Stock Position:  -0.003589080165550699
Bond Position:  [-4.66737425]


portfolio before change:  [-5.02204325]
curr_Stock_Price:  98.49376178737661
curr_Factors:  [98.49376179 -1.26690206 -1.07224687]
mat_Sqrt:  [[ 9.49574953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01312198 -0.02920154  0.18798165]
Stock Position:  -0.013121981760302298
Bond Position:  [-3.7296099]


portfolio before change:  [-5.00877519]
curr_Stock_Price:  97.41156426366447
curr_Factors:  [97.41156426 -1.00081125 -1.12207657]
mat_Sqrt:  [[11.65875169  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0049181   0.06473975 -0.23092825]
Stock Position:  0.004918102404519044
Bond Position:  [-5.48785524]


portfolio before change:  [-5.00946766]
curr_Stock_Price:  97.54976023945557
curr_Factors:  [97.54976024 -0.51123791 -1.14530047]
mat_Sqrt:  [[18.61232929  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00714543 -0.09296045 -0.18429859]
Stock Position:  -0.0071454290578806265
Bond Position:  [-4.31243277]


portfolio before change:  [-5.00633869]
curr_Stock_Price:  96.9609623004184
curr_Factors:  [ 9.69609623e+01 -7.36388607e-02 -1.16325238e+00]
mat_Sqrt:  [[28.14633668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00042389  0.004187   -0.31266819]
Stock Position:  0.00042388984571976683
Bond Position:  [-5.04743946]


portfolio before change:  [-5.00772038]
curr_Stock_Price:  96.67863373910039
curr_Factors:  [96.67863374 -0.56137596 -1.17240524]
mat_Sqrt:  [[17.0749285   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00161038 0.00764943 0.24903302]
Stock Position:  0.0016103836089354272
Bond Position:  [-5.16341007]


portfolio before change:  [-5.00748727]
curr_Stock_Price:  97.625073098127
curr_Factors:  [97.6250731  -0.47459509 -1.14470269]
mat_Sqrt:  [[19.33344665  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102971 -0.01064074  0.07818514]
Stock Position:  -0.0010297137990351994
Bond Position:  [-4.90696138]


portfolio before change:  [-5.00936973]
curr_Stock_Price:  98.26172610093118
curr_Factors:  [98.2617261  -0.50086643 -1.12543384]
mat_Sqrt:  [[19.32373862  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00150811 -0.02227867 -0.3786468 ]
Stock Position:  -0.0015081124992210196
Bond Position:  [-4.86118]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.01212327]
Stock Price:  99.28160677386762
PL:  [-5.01212327]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.32913778e-02  3.34053587e-02  3.74537704e-02]
 [ 1.28391360e-02  1.75883814e-02  1.37273443e-02]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-1.65153408e-01 -1.41058274e-01  4.92001450e-01]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-1.01077319e+00  9.48595082e-01 -1.14290401e-01]
 [-6.37060777e-03  2.22100012e-02 -1.36131082e-02]
 [-6.35844350e-02  4.62807176e-03 -4.11484077e-02]
 [ 1.28486730e-01  2.56305959e-02  4.34087481e-02]
 [ 1.54998876e-01  1.22717749e-01  9.24404076e-02]
 [ 1.21165329e-01  3.22814273e-02 -5.27256406e-02]
 [-4.43658538e-02  1.47228551e-01  3.07380497e-02]
 [-1.87718775e-01 -1.24985946e-01  3.30533481e-02]
 [ 2.88198898e-02  6.11775404e-01 -3.82749984e-01]
 [ 4.69556013e-02 -1.31549261e-01 -4.95789493e-02]
 [ 6.23348432e-02  4.36350150e-02  1.84719034e-01]
 [-6.49210330e-02  1.56955983e-02  6.94106851e-02]
 [ 4.15938867e-02 -1.31018088e-01 -3.91153426e-02]
 [-9.88936772e-02  1.94900296e-01 -1.27231873e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.33755545]
curr_Stock_Price:  100.00601899252514
curr_Factors:  [100.00601899  -1.04907949  -1.04036267]
mat_Sqrt:  [[12.37636023  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00232922  0.01078153  0.10684518]
Stock Position:  -0.0023292242776266486
Bond Position:  [2.57049189]


portfolio before change:  [2.3398211]
curr_Stock_Price:  99.30924355433098
curr_Factors:  [99.30924355 -1.2173854  -1.00764059]
mat_Sqrt:  [[10.73181466  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.001792   0.00567663 0.03916029]
Stock Position:  0.0017920018487430113
Bond Position:  [2.16185875]


portfolio before change:  [2.34183335]
curr_Stock_Price:  100.13051773732327
curr_Factors:  [100.13051774  -1.02360309  -1.0056225 ]
mat_Sqrt:  [[13.16088168  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00592838  0.01370813 -0.02999186]
Stock Position:  -0.005928382337865066
Bond Position:  [2.93544535]


portfolio before change:  [2.34580222]
curr_Stock_Price:  99.58485216583982
curr_Factors:  [99.58485217 -1.12516367 -1.00345133]
mat_Sqrt:  [[11.85079643  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00789124 -0.04552636  1.40354319]
Stock Position:  -0.007891236038198536
Bond Position:  [3.13164979]


portfolio before change:  [2.36251977]
curr_Stock_Price:  97.56558168699083
curr_Factors:  [97.56558169 -1.41982585 -1.01805898]
mat_Sqrt:  [[ 8.52190541  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00666487 -0.04522423  0.24245377]
Stock Position:  0.006664868873592355
Bond Position:  [1.71225796]


portfolio before change:  [2.36487599]
curr_Stock_Price:  97.8548745412552
curr_Factors:  [97.85487454 -1.1407434  -0.98636014]
mat_Sqrt:  [[11.66253964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0720659   0.30615775 -0.3260387 ]
Stock Position:  -0.07206590375702387
Bond Position:  [9.41687596]


portfolio before change:  [2.27467217]
curr_Stock_Price:  99.13923132764597
curr_Factors:  [99.13923133 -1.56911213 -0.99843435]
mat_Sqrt:  [[ 7.60631451  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060683  0.00716825 -0.03883441]
Stock Position:  -0.0006068345366035619
Bond Position:  [2.33483328]


portfolio before change:  [2.27508439]
curr_Stock_Price:  99.42193593999816
curr_Factors:  [99.42193594 -1.36259267 -0.98312024]
mat_Sqrt:  [[ 9.52252327  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00746011  0.0014937  -0.11738495]
Stock Position:  -0.007460114859860565
Bond Position:  [3.01678346]


portfolio before change:  [2.27909052]
curr_Stock_Price:  98.98603977311116
curr_Factors:  [98.98603977 -1.61547666 -0.95347881]
mat_Sqrt:  [[ 7.58386798  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01880034 0.00827224 0.12383308]
Stock Position:  0.018800343999844985
Bond Position:  [0.41811892]


portfolio before change:  [2.27436425]
curr_Stock_Price:  98.72908631254795
curr_Factors:  [98.72908631 -1.36986354 -0.93880418]
mat_Sqrt:  [[ 9.81303765  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02027077 0.03960698 0.26370675]
Stock Position:  0.020270772169159783
Bond Position:  [0.27304943]


portfolio before change:  [2.28753253]
curr_Stock_Price:  99.37533735083383
curr_Factors:  [99.37533735 -1.23995557 -0.93184029]
mat_Sqrt:  [[11.32608085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01032945  0.01041879 -0.15041158]
Stock Position:  0.010329448699836145
Bond Position:  [1.26104008]


portfolio before change:  [2.27983857]
curr_Stock_Price:  98.59995677105516
curr_Factors:  [98.59995677 -1.02877168 -0.9420585 ]
mat_Sqrt:  [[13.73902949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058509  0.04751781  0.0876871 ]
Stock Position:  -0.0005850903580789555
Bond Position:  [2.33752846]


portfolio before change:  [2.2796656]
curr_Stock_Price:  99.89450006603224
curr_Factors:  [99.89450007 -1.14446205 -0.95722557]
mat_Sqrt:  [[12.21209693  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01690819 -0.04033904  0.094292  ]
Stock Position:  -0.016908188571339345
Bond Position:  [3.96870065]


portfolio before change:  [2.26353813]
curr_Stock_Price:  100.90701368851467
curr_Factors:  [100.90701369  -1.28448241  -0.9483849 ]
mat_Sqrt:  [[10.81930594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00698469  0.19744966 -1.09187917]
Stock Position:  0.006984690907931328
Bond Position:  [1.55873383]


portfolio before change:  [2.26923914]
curr_Stock_Price:  101.66742978177584
curr_Factors:  [101.66742978  -1.20906272  -0.91256552]
mat_Sqrt:  [[12.18345342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00081939 -0.04245734 -0.14143494]
Stock Position:  0.0008193867392942146
Bond Position:  [2.18593419]


portfolio before change:  [2.26956606]
curr_Stock_Price:  101.3993946340851
curr_Factors:  [101.39939463  -1.2180237   -0.89579571]
mat_Sqrt:  [[12.24659226  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00889614 0.01408314 0.52695199]
Stock Position:  0.008896141549562704
Bond Position:  [1.3675027]


portfolio before change:  [2.26437582]
curr_Stock_Price:  100.777533892445
curr_Factors:  [100.77753389  -1.43184731  -0.93825403]
mat_Sqrt:  [[ 9.41980241  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00504775  0.00506573  0.19800936]
Stock Position:  -0.005047747668586954
Bond Position:  [2.77307538]


portfolio before change:  [2.2641843]
curr_Stock_Price:  100.95283505782645
curr_Factors:  [100.95283506  -1.3516188   -0.93767589]
mat_Sqrt:  [[10.23034944  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0006711  -0.04228591 -0.11158518]
Stock Position:  0.0006710958984168561
Bond Position:  [2.19643527]


portfolio before change:  [2.265119]
curr_Stock_Price:  101.52730633873824
curr_Factors:  [101.52730634  -1.68047858  -0.93713652]
mat_Sqrt:  [[ 7.40912753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0083285   0.0629038  -0.03629571]
Stock Position:  -0.008328501628873042
Bond Position:  [3.11068934]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.27076771]
Stock Price:  100.9424549263695
PL:  [1.32831278]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 7.35277780e-04 -1.97467723e-02  4.67713815e-02]
 [ 1.34396867e-02  1.97214127e-02  5.54705650e-03]
 [-1.48179937e-02 -1.31631696e-02 -1.25068275e-02]
 [-1.25948650e-01 -8.84056526e-02  3.88500583e-01]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-1.14549645e+00  1.15018030e+00 -1.62126142e-01]
 [-2.27202949e-03  1.78350868e-02 -8.37026557e-03]
 [-2.18115155e-02  8.03229590e-03 -1.95680651e-02]
 [ 4.45352536e-02  2.91664999e-02  5.78858645e-02]
 [ 1.55024555e-01  1.22990970e-01  9.27710494e-02]
 [ 2.95829796e-02 -6.55556773e-02 -3.21702967e-02]
 [ 4.32124810e-02  5.82635710e-02 -1.76308830e-02]
 [-3.41153804e-02  1.37376593e-01  1.25678669e-01]
 [ 1.09280646e-02  8.25510515e-01 -5.44290058e-01]
 [ 1.05504513e-02 -1.84311292e-01 -5.46453260e-02]
 [ 5.58954538e-02  4.58118170e-02  1.11267218e-01]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.03447745e-02 -1.38354367e-01 -4.28068640e-02]
 [-1.39030846e-01  4.85660309e-02 -1.40335473e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.32027964]
curr_Stock_Price:  100.7602111010768
curr_Factors:  [100.7602111   -0.99774799  -0.97613546]
mat_Sqrt:  [[13.99723894  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00044663 -0.00637324  0.13342573]
Stock Position:  0.0004466347298247309
Bond Position:  [8.27527663]


portfolio before change:  [8.32169815]
curr_Stock_Price:  99.30361409156414
curr_Factors:  [99.30361409 -1.21819966 -0.96177801]
mat_Sqrt:  [[11.2256832   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0016567  0.00636506 0.01582421]
Stock Position:  0.0016567001778119404
Bond Position:  [8.15718184]


portfolio before change:  [8.32410555]
curr_Stock_Price:  99.52565335411403
curr_Factors:  [99.52565335 -1.23951737 -0.99111588]
mat_Sqrt:  [[10.69506248  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00187543 -0.00424839 -0.0356785 ]
Stock Position:  -0.0018754317643518488
Bond Position:  [8.51075913]


portfolio before change:  [8.32599289]
curr_Stock_Price:  99.65395159551491
curr_Factors:  [99.6539516  -1.29901911 -0.98327913]
mat_Sqrt:  [[10.16962626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0063613  -0.0285328   1.10828403]
Stock Position:  -0.006361298532136597
Bond Position:  [8.95992143]


portfolio before change:  [8.325465]
curr_Stock_Price:  100.08910675536416
curr_Factors:  [100.08910676  -1.384047    -0.99700241]
mat_Sqrt:  [[ 9.25358874  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00613788 -0.04522423  0.24245377]
Stock Position:  0.006137876205155347
Bond Position:  [7.71113046]


portfolio before change:  [8.32515967]
curr_Stock_Price:  99.72524247114569
curr_Factors:  [99.72524247 -0.86816292 -0.96864434]
mat_Sqrt:  [[15.88875415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05940118  0.3712191  -0.46250076]
Stock Position:  -0.05940117980931698
Bond Position:  [14.24895673]


portfolio before change:  [8.30903996]
curr_Stock_Price:  100.05658943039035
curr_Factors:  [100.05658943  -0.63569425  -0.92094862]
mat_Sqrt:  [[21.0962025   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.61181119e-05  5.75624951e-03 -2.38780378e-02]
Stock Position:  -1.611811188020416e-05
Bond Position:  [8.31065268]


portfolio before change:  [8.3111322]
curr_Stock_Price:  99.16798112707848
curr_Factors:  [99.16798113 -0.58558108 -0.90999485]
mat_Sqrt:  [[22.22547738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108732  0.00259241 -0.05582224]
Stock Position:  -0.0010873217325712739
Bond Position:  [8.4189597]


portfolio before change:  [8.31276043]
curr_Stock_Price:  99.60647029892542
curr_Factors:  [99.6064703  -0.24378116 -0.90151741]
mat_Sqrt:  [[31.68769876  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00196621 0.00941345 0.16513226]
Stock Position:  0.0019662122999917343
Bond Position:  [8.11691296]


portfolio before change:  [8.31078064]
curr_Stock_Price:  97.56738853278048
curr_Factors:  [ 9.75673885e+01 -5.75775559e-02 -9.12592743e-01]
mat_Sqrt:  [[36.97984389  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00538312 0.03969516 0.26464998]
Stock Position:  0.005383116083722403
Bond Position:  [7.78556406]


portfolio before change:  [8.31807828]
curr_Stock_Price:  98.56142315221189
curr_Factors:  [98.56142315  0.23904696 -0.93231171]
mat_Sqrt:  [[49.27491782  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00019553 -0.021158   -0.0917729 ]
Stock Position:  0.00019553048665252984
Bond Position:  [8.29880652]


portfolio before change:  [8.319958]
curr_Stock_Price:  97.56291925145756
curr_Factors:  [97.56291925  0.19093786 -0.95802902]
mat_Sqrt:  [[45.3044987   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0011369   0.01880449 -0.050296  ]
Stock Position:  0.001136897995067049
Bond Position:  [8.20903892]


portfolio before change:  [8.32526474]
curr_Stock_Price:  100.42528559372234
curr_Factors:  [100.42528559   0.25635087  -0.94409369]
mat_Sqrt:  [[50.4847446   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00038785 0.0443381  0.35852626]
Stock Position:  0.0003878508291568558
Bond Position:  [8.28631471]


portfolio before change:  [8.32908836]
curr_Stock_Price:  104.94194165386071
curr_Factors:  [104.94194165  -0.3460632   -0.94667412]
mat_Sqrt:  [[28.80848418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00237194  0.26643237 -1.55270804]
Stock Position:  0.0023719383984163833
Bond Position:  [8.08017254]


portfolio before change:  [8.32392377]
curr_Stock_Price:  101.9128183436592
curr_Factors:  [101.91281834  -0.28843696  -0.89559026]
mat_Sqrt:  [[31.18978086  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00122561 -0.05948621 -0.1558879 ]
Stock Position:  -0.0012256054111168932
Bond Position:  [8.44882867]


portfolio before change:  [8.32589598]
curr_Stock_Price:  102.02725397403835
curr_Factors:  [102.02725397  -0.73341001  -0.88876293]
mat_Sqrt:  [[20.14723432  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00436581 0.0147857  0.3174144 ]
Stock Position:  0.004365813989101809
Bond Position:  [7.88046397]


portfolio before change:  [8.32985682]
curr_Stock_Price:  102.483176663834
curr_Factors:  [102.48317666  -1.00625918  -0.90079902]
mat_Sqrt:  [[15.22045829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00451956  0.00525786  0.16709793]
Stock Position:  -0.004519562725341693
Bond Position:  [8.79303596]


portfolio before change:  [8.33026119]
curr_Stock_Price:  102.88015279422416
curr_Factors:  [102.88015279  -1.04450735  -0.9322411 ]
mat_Sqrt:  [[14.25084644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00023615 -0.04465368 -0.12211607]
Stock Position:  0.0002361539157454941
Bond Position:  [8.30596564]


portfolio before change:  [8.33232444]
curr_Stock_Price:  102.82294829580614
curr_Factors:  [102.8229483   -0.67349701  -0.94215174]
mat_Sqrt:  [[20.4372622   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00645791  0.01567462 -0.0400338 ]
Stock Position:  -0.006457906667204506
Bond Position:  [8.99634544]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.32883242]
Stock Price:  103.71199571625066
PL:  [4.6168367]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.39203408e-01  2.28812326e-01 -1.39722717e-02]
 [ 6.74149981e-02  5.21416862e-02 -1.63840889e-01]
 [ 1.18329568e-01 -6.24813311e-03 -5.99419950e-03]
 [-3.24780267e-01 -3.52047348e-01  9.81519300e-01]
 [-1.04845979e-01  1.15123157e-01 -8.69243351e-02]
 [-1.41355399e+00  1.38945768e+00 -2.00005772e-01]
 [-6.65757193e-03 -2.87462877e-02 -9.87510750e-03]
 [-7.24003704e-02 -2.24247201e-03 -3.84758611e-02]
 [ 1.04190428e-01  2.93425484e-02  6.42704442e-02]
 [-4.96948043e-01  2.73510339e-01 -2.47531108e-01]
 [ 9.54900142e-02  4.80657263e-02 -5.51451143e-02]
 [ 5.07032760e-03  5.86888421e-02 -1.05176532e-02]
 [ 1.51948162e-01  6.28475787e-02 -7.42314323e-02]
 [ 9.21107083e-03  8.71608915e-01 -5.73683911e-01]
 [ 5.97834395e-02 -1.12957859e-01 -4.77937442e-02]
 [ 5.25645642e-02  4.37088520e-02  5.87418809e-02]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 3.50602717e-02 -8.65417236e-02 -4.36632876e-02]
 [-1.39782715e-01  4.79942225e-02 -1.44711622e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.25420273]
curr_Stock_Price:  98.67080443573967
curr_Factors:  [98.67080444 -0.51497337 -1.01085957]
mat_Sqrt:  [[21.45496666  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00444416  0.07384886 -0.039859  ]
Stock Position:  -0.004444162853654379
Bond Position:  [-7.81569361]


portfolio before change:  [-8.25535778]
curr_Stock_Price:  98.49099114740899
curr_Factors:  [98.49099115 -0.28458055 -1.00162341]
mat_Sqrt:  [[27.214805    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00163935  0.01682866 -0.46739245]
Stock Position:  0.001639346442408772
Bond Position:  [-8.41681863]


portfolio before change:  [-8.25825134]
curr_Stock_Price:  98.0096461930957
curr_Factors:  [98.00964619 -0.17190357 -0.98252051]
mat_Sqrt:  [[30.89646626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00374899 -0.00201658 -0.01709978]
Stock Position:  0.0037489922307025886
Bond Position:  [-8.62568874]


portfolio before change:  [-8.25515615]
curr_Stock_Price:  99.4105232258591
curr_Factors:  [99.41052323 -0.28670204 -1.01280412]
mat_Sqrt:  [[27.10591068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00724159 -0.11362279  2.80000136]
Stock Position:  -0.007241588205123961
Bond Position:  [-7.53526608]


portfolio before change:  [-8.25292356]
curr_Stock_Price:  98.84205077657504
curr_Factors:  [ 9.88420508e+01 -5.17865954e-02 -9.89676240e-01]
mat_Sqrt:  [[34.88511709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00284046  0.03715584 -0.24797093]
Stock Position:  -0.002840463973169396
Bond Position:  [-7.97216627]


portfolio before change:  [-8.25287183]
curr_Stock_Price:  98.12209144019832
curr_Factors:  [98.12209144 -0.44624863 -1.01559573]
mat_Sqrt:  [[22.74551952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05147203  0.44844554 -0.5705608 ]
Stock Position:  -0.051472033160863705
Bond Position:  [-3.20232829]


portfolio before change:  [-8.26873805]
curr_Stock_Price:  98.4147850125023
curr_Factors:  [98.41478501 -0.53879574 -1.01960333]
mat_Sqrt:  [[20.71363082  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00070201 -0.00927782 -0.02817093]
Stock Position:  -0.0007020078394951634
Bond Position:  [-8.1996501]


portfolio before change:  [-8.27179108]
curr_Stock_Price:  99.84334886660136
curr_Factors:  [99.84334887 -0.77875994 -1.0028417 ]
mat_Sqrt:  [[16.81045156  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0048013  -0.00072375 -0.10976092]
Stock Position:  -0.0048012966826951635
Bond Position:  [-7.79241354]


portfolio before change:  [-8.2781234]
curr_Stock_Price:  100.7564307236731
curr_Factors:  [100.75643072  -0.72801613  -1.04498149]
mat_Sqrt:  [[17.11077548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00720593 0.00947027 0.18334569]
Stock Position:  0.007205932907624276
Bond Position:  [-9.00416748]


portfolio before change:  [-8.26806699]
curr_Stock_Price:  102.46443051120993
curr_Factors:  [102.46443051  -0.73098106  -1.02113641]
mat_Sqrt:  [[17.76798503  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02767028  0.08827508 -0.70613735]
Stock Position:  -0.027670276260534938
Bond Position:  [-5.43284789]


portfolio before change:  [-8.29473537]
curr_Stock_Price:  103.37913014041484
curr_Factors:  [103.37913014  -0.75903792  -1.01901399]
mat_Sqrt:  [[17.46766041  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00538395  0.01551315 -0.15731366]
Stock Position:  0.005383945992155551
Bond Position:  [-8.85132302]


portfolio before change:  [-8.2944212]
curr_Stock_Price:  103.84853980717773
curr_Factors:  [103.84853981  -0.61510341  -1.01383372]
mat_Sqrt:  [[20.36863788  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00073168  0.01894174 -0.03000394]
Stock Position:  0.0007316753548112864
Bond Position:  [-8.37040462]


portfolio before change:  [-8.29589569]
curr_Stock_Price:  104.6936864197237
curr_Factors:  [104.69368642  -0.58575191  -0.9584523 ]
mat_Sqrt:  [[22.35018518  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00669455  0.02028397 -0.21176161]
Stock Position:  0.006694550481522204
Bond Position:  [-8.99677286]


portfolio before change:  [-8.29242069]
curr_Stock_Price:  105.54878081037653
curr_Factors:  [105.54878081  -0.25447689  -0.93775038]
mat_Sqrt:  [[32.03874512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00218563  0.28131057 -1.63656052]
Stock Position:  0.0021856273524854973
Bond Position:  [-8.52311099]


portfolio before change:  [-8.30056419]
curr_Stock_Price:  102.79787650058563
curr_Factors:  [102.7978765   -0.42923777  -0.91841707]
mat_Sqrt:  [[26.71191861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00100967 -0.03645699 -0.13634225]
Stock Position:  0.0010096674960897642
Bond Position:  [-8.40435586]


portfolio before change:  [-8.30591277]
curr_Stock_Price:  99.5817400333086
curr_Factors:  [99.58174003 -0.32328741 -0.91791155]
mat_Sqrt:  [[28.78285375  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00255281 0.01410697 0.16757424]
Stock Position:  0.0025528126280250033
Bond Position:  [-8.56012629]


portfolio before change:  [-8.30474087]
curr_Stock_Price:  100.87920847553424
curr_Factors:  [100.87920848  -0.51601357  -0.89448163]
mat_Sqrt:  [[24.61678793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00279443  0.00525786  0.16709793]
Stock Position:  -0.0027944269632792875
Bond Position:  [-8.02284129]


portfolio before change:  [-8.30550869]
curr_Stock_Price:  100.4361320881088
curr_Factors:  [100.43613209  -0.47121904  -0.8726697 ]
mat_Sqrt:  [[26.1966957   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00032379 -0.02793122 -0.12455921]
Stock Position:  0.0003237921746465157
Bond Position:  [-8.33802912]


portfolio before change:  [-8.30688242]
curr_Stock_Price:  102.63209634017065
curr_Factors:  [102.63209634  -0.84462315  -0.86444993]
mat_Sqrt:  [[18.57984953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00715506  0.01549007 -0.0412822 ]
Stock Position:  -0.007155055183872439
Bond Position:  [-7.57254411]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.31302937]
Stock Price:  103.22658169417399
PL:  [-11.53961106]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-9.02109936e-02  1.69201842e-01  7.49789155e-03]
 [-8.22796972e-03 -5.67184534e-02  6.69605774e-02]
 [ 2.11064008e-01  1.28494217e-01  3.19235198e-01]
 [ 2.71100487e-02  3.62001558e-02 -6.27960209e-02]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-1.16730733e+00  1.03515176e+00 -1.22155134e-01]
 [-1.15815315e-01 -6.67608021e-02 -1.00030536e-01]
 [ 6.39325065e-02 -5.35567597e-02  5.52764117e-03]
 [ 6.14404539e-02  2.45538895e-02  3.76437393e-02]
 [ 1.53799567e-01  1.10352244e-01  7.73987599e-02]
 [-1.52956131e-03  3.00444692e-02 -5.14545859e-02]
 [-4.96836763e-02  1.44430957e-01  4.34273838e-02]
 [-7.52874701e-03 -3.37232593e-02  1.19909806e-01]
 [ 3.99148504e-02  4.05332949e-01 -1.69543952e-01]
 [-1.93471175e-02  1.28666833e-02 -9.79233373e-02]
 [ 6.04018660e-02  2.82139228e-02  1.66973597e-01]
 [ 1.22511363e-01  2.07512034e-02  1.42645000e-01]
 [-2.65768632e-02 -1.21243312e-02  2.96186670e-02]
 [-7.22081505e-02  1.84401342e-01 -4.25803443e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.94296342]
curr_Stock_Price:  99.2142863948187
curr_Factors:  [99.21428639 -0.84342843 -0.96928905]
mat_Sqrt:  [[16.1927651   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00334361  0.05460966  0.0213894 ]
Stock Position:  -0.003343611245436551
Bond Position:  [-3.61122942]


portfolio before change:  [-3.9384237]
curr_Stock_Price:  97.58651475884838
curr_Factors:  [97.58651476 -0.50303825 -0.96159636]
mat_Sqrt:  [[22.55833675  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027206 -0.0183058   0.19101989]
Stock Position:  -0.00027206371583871845
Bond Position:  [-3.91187395]


portfolio before change:  [-3.938909]
curr_Stock_Price:  95.77519141763659
curr_Factors:  [95.77519142 -0.54354437 -0.97009849]
mat_Sqrt:  [[21.08076126  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01434751 0.04147133 0.91068916]
Stock Position:  0.014347508049157616
Bond Position:  [-5.31304433]


portfolio before change:  [-3.94076301]
curr_Stock_Price:  95.7385590339426
curr_Factors:  [95.73855903 -0.55768038 -0.97652259]
mat_Sqrt:  [[20.64386472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00105025  0.01168355 -0.17913957]
Stock Position:  0.0010502486191147505
Bond Position:  [-4.0413123]


portfolio before change:  [-3.94125504]
curr_Stock_Price:  96.232180378424
curr_Factors:  [96.23218038 -0.54337904 -0.95535482]
mat_Sqrt:  [[21.49950599  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0026418  -0.04522423  0.24245377]
Stock Position:  0.002641799403668014
Bond Position:  [-4.19548116]


portfolio before change:  [-3.94486497]
curr_Stock_Price:  95.26279071145458
curr_Factors:  [95.26279071 -0.84034306 -0.97540197]
mat_Sqrt:  [[15.50084071  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06328319  0.33409379 -0.3484746 ]
Stock Position:  -0.06328319170286954
Bond Position:  [2.08366847]


portfolio before change:  [-3.92644113]
curr_Stock_Price:  94.97988996761049
curr_Factors:  [94.97988997 -1.07226782 -0.95186513]
mat_Sqrt:  [[12.54763549  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0119434  -0.02154696 -0.28535928]
Stock Position:  -0.011943401960446243
Bond Position:  [-2.79205813]


portfolio before change:  [-3.94132277]
curr_Stock_Price:  96.16745294233294
curr_Factors:  [96.16745294 -1.08428746 -0.95945449]
mat_Sqrt:  [[12.4578261   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00434495 -0.01728537  0.01576882]
Stock Position:  0.004344947771106201
Bond Position:  [-4.35916533]


portfolio before change:  [-3.94639455]
curr_Stock_Price:  95.25102101880384
curr_Factors:  [95.25102102 -0.98676636 -0.91615664]
mat_Sqrt:  [[14.20498179  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00521905 0.00792473 0.10738711]
Stock Position:  0.005219048695652643
Bond Position:  [-4.44351427]


portfolio before change:  [-3.94616481]
curr_Stock_Price:  95.50791732079281
curr_Factors:  [95.50791732 -1.17360822 -0.90800169]
mat_Sqrt:  [[11.91263063  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01612776 0.03561603 0.22079712]
Stock Position:  0.016127762754252133
Bond Position:  [-5.48649384]


portfolio before change:  [-3.94254134]
curr_Stock_Price:  95.81764817329716
curr_Factors:  [95.81764817 -0.92861146 -0.91303968]
mat_Sqrt:  [[15.19240679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00038834  0.00969681 -0.14678561]
Stock Position:  -0.00038834420128588433
Bond Position:  [-3.90533111]


portfolio before change:  [-3.94374229]
curr_Stock_Price:  96.39572702458646
curr_Factors:  [96.39572702 -1.12568463 -0.87925606]
mat_Sqrt:  [[12.98144694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00087334  0.04661489  0.12388624]
Stock Position:  -0.0008733427793618649
Bond Position:  [-3.85955578]


portfolio before change:  [-3.94432113]
curr_Stock_Price:  95.95355061524272
curr_Factors:  [95.95355062 -1.30031283 -0.8938935 ]
mat_Sqrt:  [[10.69373334  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094111 -0.01088414  0.3420693 ]
Stock Position:  0.0009411126903085748
Bond Position:  [-4.03462423]


portfolio before change:  [-3.94355455]
curr_Stock_Price:  97.84000018615056
curr_Factors:  [97.84000019 -1.46000882 -0.87656322]
mat_Sqrt:  [[ 9.45705902  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00930999  0.13082065 -0.4836617 ]
Stock Position:  0.009309985045468103
Bond Position:  [-4.85444349]


portfolio before change:  [-3.94446365]
curr_Stock_Price:  97.87272450942777
curr_Factors:  [97.87272451 -1.79675623 -0.87042013]
mat_Sqrt:  [[ 6.79706944  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00540074  0.0041527  -0.27934802]
Stock Position:  -0.005400744339135085
Bond Position:  [-3.41587809]


portfolio before change:  [-3.94818393]
curr_Stock_Price:  98.40343090808568
curr_Factors:  [98.40343091 -1.64609016 -0.88263639]
mat_Sqrt:  [[ 7.84870948  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01277208 0.009106   0.47632919]
Stock Position:  0.012772080783629139
Bond Position:  [-5.2050005]


portfolio before change:  [-3.97276025]
curr_Stock_Price:  96.58110419056274
curr_Factors:  [96.58110419 -1.31160866 -0.88092292]
mat_Sqrt:  [[10.78171372  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01445637 0.00669742 0.40692648]
Stock Position:  0.014456372795351525
Bond Position:  [-5.3689727]


portfolio before change:  [-3.96680323]
curr_Stock_Price:  97.08603236506393
curr_Factors:  [97.08603237 -1.28844581 -0.9431967 ]
mat_Sqrt:  [[10.42237574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00220735 -0.00391311  0.08449381]
Stock Position:  -0.0022073515144269617
Bond Position:  [-3.75250023]


portfolio before change:  [-3.96998595]
curr_Stock_Price:  98.10284984230132
curr_Factors:  [98.10284984 -1.41351002 -0.91353349]
mat_Sqrt:  [[ 9.5732515   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00451874  0.05951528 -0.12146987]
Stock Position:  -0.004518742729048486
Bond Position:  [-3.52668441]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.96688546]
Stock Price:  97.22157071158914
PL:  [-3.96688546]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.32913778e-02  3.34053587e-02  3.74537704e-02]
 [ 3.03976505e-02  1.64028502e-01 -2.18305320e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-2.60342904e-01 -2.59901997e-01  9.41000741e-01]
 [-1.21795813e-02 -2.16788147e-02  5.21551938e-03]
 [-1.35439638e+00  1.49774668e+00 -2.30159605e-01]
 [ 9.70697307e-03 -3.61911514e-03  2.57319643e-02]
 [-8.33534378e-02 -3.73106974e-02  1.30290618e-02]
 [ 4.93150391e-02  2.47474671e-02  6.08984154e-02]
 [-4.43045767e-01  2.61425964e-01 -2.18987372e-01]
 [ 1.17085597e-01  3.22070461e-02 -5.26833767e-02]
 [-4.50499976e-02  1.46868637e-01  3.23705466e-02]
 [-8.28278022e-02 -1.09788225e-01 -4.55417662e-02]
 [ 1.90243739e-02  6.17416307e-01 -4.12252245e-01]
 [ 1.17979397e-01 -6.01382390e-02 -3.21260456e-02]
 [ 1.56188280e-02 -3.42432024e-02 -1.18856284e-01]
 [-8.05704386e-02  1.65045947e-02  5.45694228e-02]
 [ 3.90726693e-02 -1.33773192e-01 -4.38588694e-02]
 [-1.03026697e-01 -7.46394655e-03 -8.61191848e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.96376457]
curr_Stock_Price:  99.9588982963058
curr_Factors:  [99.9588983  -0.96857222 -0.98184763]
mat_Sqrt:  [[14.21558983  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202787  0.01078153  0.10684518]
Stock Position:  -0.002027866522387152
Bond Position:  [2.16646787]


portfolio before change:  [1.96160129]
curr_Stock_Price:  101.29279536339448
curr_Factors:  [101.29279536  -1.0808126   -0.96981636]
mat_Sqrt:  [[13.03171921  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00148242  0.05293997 -0.62276431]
Stock Position:  0.001482416947328151
Bond Position:  [1.81144313]


portfolio before change:  [1.96165877]
curr_Stock_Price:  101.02604659492044
curr_Factors:  [101.02604659  -0.9317622   -0.96034324]
mat_Sqrt:  [[15.23008782  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00512293  0.01370813 -0.02999186]
Stock Position:  -0.005122934248942648
Bond Position:  [2.47920857]


portfolio before change:  [1.96055872]
curr_Stock_Price:  101.36177966921574
curr_Factors:  [101.36177967  -0.87127426  -1.01002999]
mat_Sqrt:  [[15.44664529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00785376 -0.08388301  2.68441319]
Stock Position:  -0.0078537574393933
Bond Position:  [2.75662955]


portfolio before change:  [1.9578657]
curr_Stock_Price:  101.79243407986789
curr_Factors:  [101.79243408  -0.73633567  -1.08771249]
mat_Sqrt:  [[16.42636419  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094605 -0.00699681  0.01487843]
Stock Position:  -0.0009460485089820532
Bond Position:  [2.05416628]


portfolio before change:  [1.95674674]
curr_Stock_Price:  103.51810418659181
curr_Factors:  [103.51810419  -0.81311437  -1.12950887]
mat_Sqrt:  [[14.83698835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07384593  0.48339566 -0.65658129]
Stock Position:  -0.07384593343394782
Bond Position:  [9.60113777]


portfolio before change:  [1.98424944]
curr_Stock_Price:  103.17817867001249
curr_Factors:  [103.17817867  -1.05676193  -1.13609547]
mat_Sqrt:  [[11.51441794  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00123504 -0.00116806  0.07340613]
Stock Position:  0.0012350376345995771
Bond Position:  [1.85682051]


portfolio before change:  [1.98410107]
curr_Stock_Price:  102.68212931859007
curr_Factors:  [102.68212932  -1.20378711  -1.10618215]
mat_Sqrt:  [[10.19267003  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00866406 -0.01204198  0.03716829]
Stock Position:  -0.00866406011733471
Bond Position:  [2.87374521]


portfolio before change:  [1.99318667]
curr_Stock_Price:  101.71640697195029
curr_Factors:  [101.71640697  -0.69650747  -1.06910022]
mat_Sqrt:  [[17.4019266   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00383851 0.00798721 0.17372623]
Stock Position:  0.0038385078411082825
Bond Position:  [1.60274744]


portfolio before change:  [1.99488053]
curr_Stock_Price:  102.05328903108074
curr_Factors:  [102.05328903  -0.75672887  -1.06685285]
mat_Sqrt:  [[16.47614212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02636437  0.08437487 -0.62471002]
Stock Position:  -0.02636436507886631
Bond Position:  [4.6854507]


portfolio before change:  [2.01630863]
curr_Stock_Price:  101.28495675143807
curr_Factors:  [101.28495675  -1.0932027   -1.07928789]
mat_Sqrt:  [[11.53570852  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00978751  0.01039478 -0.15029101]
Stock Position:  0.009787511816793219
Bond Position:  [1.02498092]


portfolio before change:  [2.01990295]
curr_Stock_Price:  101.62600775627547
curr_Factors:  [101.62600776  -0.94062274  -1.07839186]
mat_Sqrt:  [[13.49453633  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00062714  0.04740165  0.09234416]
Stock Position:  -0.0006271391789059512
Bond Position:  [2.0836366]


portfolio before change:  [2.01967041]
curr_Stock_Price:  102.82751248641178
curr_Factors:  [102.82751249  -1.00040018  -1.09421517]
mat_Sqrt:  [[12.65987569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00904704 -0.035434   -0.12991798]
Stock Position:  -0.009047040168965988
Bond Position:  [2.94995505]


portfolio before change:  [2.01933155]
curr_Stock_Price:  102.9464952174528
curr_Factors:  [102.94649522  -0.58634419  -1.09328272]
mat_Sqrt:  [[19.19370736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00317309  0.19927026 -1.17604091]
Stock Position:  0.0031730874816200683
Bond Position:  [1.69267332]


portfolio before change:  [2.02399685]
curr_Stock_Price:  104.28338734813039
curr_Factors:  [104.28338735  -0.4176816   -1.11653659]
mat_Sqrt:  [[22.4860222   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00440923 -0.01940953 -0.09164667]
Stock Position:  0.0044092293301030315
Bond Position:  [1.56418748]


portfolio before change:  [2.03763623]
curr_Stock_Price:  107.28805856608643
curr_Factors:  [107.28805857  -0.44147096  -1.13695776]
mat_Sqrt:  [[22.1334188   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00070628 -0.01105195 -0.3390639 ]
Stock Position:  -0.0007062837381551157
Bond Position:  [2.11341204]


portfolio before change:  [2.03951575]
curr_Stock_Price:  105.37509468293793
curr_Factors:  [105.37509468  -0.16275938  -1.12681299]
mat_Sqrt:  [[29.01909162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227652  0.00532684  0.15567137]
Stock Position:  -0.002276519071472984
Bond Position:  [2.27940416]


portfolio before change:  [2.04329349]
curr_Stock_Price:  103.9660051222489
curr_Factors:  [ 1.03966005e+02  3.03329020e-02 -1.13134658e+00]
mat_Sqrt:  [[34.57221389  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.13854879e-05 -4.31751121e-02 -1.25117146e-01]
Stock Position:  8.13854879330616e-05
Bond Position:  [2.03483216]


portfolio before change:  [2.04387926]
curr_Stock_Price:  104.91216839215129
curr_Factors:  [ 1.04912168e+02  8.29757906e-02 -1.12787966e+00]
mat_Sqrt:  [[36.90029838  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330971 -0.00240898 -0.24567406]
Stock Position:  -0.0033097096410595033
Bond Position:  [2.39110808]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.05929422]
Stock Price:  100.43530901610576
PL:  [1.6239852]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-6.47609404e-02  1.38236029e-01  1.86509813e-02]
 [ 4.20078958e-03 -1.24504165e-02  8.06249721e-02]
 [-7.63259695e-02  3.18084683e-02 -7.04222431e-03]
 [-2.11172466e-02  5.22247740e-02  9.94591175e-02]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-6.76716279e-01  6.09061958e-01 -4.98832996e-02]
 [-2.75652328e-03  1.87028074e-02 -9.74953888e-03]
 [-5.95103312e-02  7.31761305e-03 -4.23569491e-02]
 [ 1.43309391e-01  2.40486423e-02  3.76436645e-02]
 [ 1.54603373e-01  1.18509654e-01  8.73479255e-02]
 [ 1.22449617e-01  3.23048422e-02 -5.27389451e-02]
 [-1.39530426e-01  9.71644943e-02  2.57818789e-01]
 [-1.87718775e-01 -1.24985946e-01  3.30533481e-02]
 [ 3.85327501e-02  4.47163668e-01 -2.44796098e-01]
 [-1.61807669e-02 -2.23052882e-01 -5.83654156e-02]
 [ 6.09564241e-02  4.73111340e-02  1.47947018e-01]
 [-7.75823310e-02  1.60277968e-02  6.23881155e-02]
 [ 4.06467527e-02 -1.19528710e-01 -3.92687160e-02]
 [-1.31308487e-01  5.44390070e-02 -9.53885661e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.89171352]
curr_Stock_Price:  99.22074704197729
curr_Factors:  [99.22074704 -1.34754588 -0.94632635]
mat_Sqrt:  [[10.00890214  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00327074  0.04461549  0.05320606]
Stock Position:  -0.003270739706735057
Bond Position:  [-3.56718828]


portfolio before change:  [-3.89215703]
curr_Stock_Price:  99.08365419705035
curr_Factors:  [99.0836542  -1.27159918 -0.98532173]
mat_Sqrt:  [[10.37131247  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00174682 -0.00401835  0.2300006 ]
Stock Position:  0.0017468244757184383
Bond Position:  [-4.06523879]


portfolio before change:  [-3.89136244]
curr_Stock_Price:  100.12041017150781
curr_Factors:  [100.12041017  -1.2822094   -0.97748026]
mat_Sqrt:  [[10.45085618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00681959  0.01026614 -0.02008951]
Stock Position:  -0.006819592565361503
Bond Position:  [-3.20858203]


portfolio before change:  [-3.88645102]
curr_Stock_Price:  99.2825798442109
curr_Factors:  [99.28257984 -1.70877203 -0.92277452]
mat_Sqrt:  [[ 7.14507693  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00137789 0.01685547 0.28372918]
Stock Position:  0.0013778855240404678
Bond Position:  [-4.02325105]


portfolio before change:  [-3.88795903]
curr_Stock_Price:  98.91820082171226
curr_Factors:  [98.91820082 -1.47907894 -0.93901553]
mat_Sqrt:  [[ 8.81274341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00644491 -0.04522423  0.24245377]
Stock Position:  0.006444914994585058
Bond Position:  [-4.52547843]


portfolio before change:  [-3.8906526]
curr_Stock_Price:  98.67583031692187
curr_Factors:  [98.67583032 -1.5839373  -0.92368683]
mat_Sqrt:  [[ 8.03828624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06998686  0.1965739  -0.14230317]
Stock Position:  -0.06998685993121218
Bond Position:  [3.01535891]


portfolio before change:  [-3.87082991]
curr_Stock_Price:  98.40336837327777
curr_Factors:  [98.40336837 -1.57796687 -0.91293478]
mat_Sqrt:  [[ 8.1512671   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00011396  0.00603631 -0.02781272]
Stock Position:  -0.00011396326296661981
Bond Position:  [-3.85961554]


portfolio before change:  [-3.8718436]
curr_Stock_Price:  98.83035710935195
curr_Factors:  [98.83035711 -1.90631968 -0.89740749]
mat_Sqrt:  [[ 5.98752207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01113361  0.00236175 -0.12083259]
Stock Position:  -0.011133605009964496
Bond Position:  [-2.77150544]


portfolio before change:  [-3.86929557]
curr_Stock_Price:  98.539257053978
curr_Factors:  [98.53925705 -1.77043589 -0.92321903]
mat_Sqrt:  [[ 6.6645344   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02339282 0.00776167 0.1073869 ]
Stock Position:  0.023392824056415767
Bond Position:  [-6.17440707]


portfolio before change:  [-3.88177325]
curr_Stock_Price:  98.07185349516577
curr_Factors:  [98.0718535  -1.75119562 -0.90076538]
mat_Sqrt:  [[ 6.91532121  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02843308 0.03824883 0.24917932]
Stock Position:  0.028433079219917563
Bond Position:  [-6.67025803]


portfolio before change:  [-3.85101421]
curr_Stock_Price:  99.2123142665322
curr_Factors:  [99.21231427 -1.89845949 -0.91225735]
mat_Sqrt:  [[ 5.96879642  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01981614  0.01042634 -0.15044953]
Stock Position:  0.019816142908462536
Bond Position:  [-5.81701961]


portfolio before change:  [-3.85062751]
curr_Stock_Price:  99.3052254421961
curr_Factors:  [99.30522544 -1.86753945 -0.94639339]
mat_Sqrt:  [[ 5.95520336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01126238  0.03135971  0.73548524]
Stock Position:  -0.01126238054931702
Bond Position:  [-2.73221427]


portfolio before change:  [-3.85625886]
curr_Stock_Price:  99.7445828588649
curr_Factors:  [99.74458286 -1.63882096 -0.97747811]
mat_Sqrt:  [[ 7.28861597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02832972 -0.04033904  0.094292  ]
Stock Position:  -0.028329718393072092
Bond Position:  [-1.03052292]


portfolio before change:  [-3.84463402]
curr_Stock_Price:  99.32514698584872
curr_Factors:  [99.32514699 -1.06043298 -0.99337131]
mat_Sqrt:  [[12.7380617   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0062679   0.14432145 -0.69833513]
Stock Position:  0.006267896890134854
Bond Position:  [-4.4671938]


portfolio before change:  [-3.83988116]
curr_Stock_Price:  100.2616336202588
curr_Factors:  [100.26163362  -1.21984276  -1.00060371]
mat_Sqrt:  [[10.88446605  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00676423 -0.07199001 -0.16650028]
Stock Position:  -0.006764230414278878
Bond Position:  [-3.16168837]


portfolio before change:  [-3.83733524]
curr_Stock_Price:  99.7683865951882
curr_Factors:  [99.7683866  -1.02392438 -1.03384842]
mat_Sqrt:  [[12.74422919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00791051 0.0152696  0.42205166]
Stock Position:  0.007910508040885379
Bond Position:  [-4.62655387]


portfolio before change:  [-3.82765676]
curr_Stock_Price:  101.13811693691122
curr_Factors:  [101.13811694  -1.30239872  -1.01406076]
mat_Sqrt:  [[ 9.97445775  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00617334  0.00517295  0.17797593]
Stock Position:  -0.006173343101610934
Bond Position:  [-3.20329647]


portfolio before change:  [-3.82620417]
curr_Stock_Price:  100.77307709685016
curr_Factors:  [100.7730771   -0.77165129  -0.99959925]
mat_Sqrt:  [[17.1435272   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0004802  -0.03857773 -0.11202272]
Stock Position:  0.00048020245649270854
Bond Position:  [-3.87459565]


portfolio before change:  [-3.82645024]
curr_Stock_Price:  102.27807817930037
curr_Factors:  [102.27807818  -0.46965034  -0.97112641]
mat_Sqrt:  [[24.21370039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00504439  0.01757011 -0.0272117 ]
Stock Position:  -0.0050443872584385995
Bond Position:  [-3.31052]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.82579908]
Stock Price:  101.98490385320066
PL:  [-5.81070294]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-5.76089755e-02  1.04039776e-01  2.48280492e-02]
 [ 3.18816875e-02  8.41670645e-02 -1.62216970e-01]
 [ 1.13922995e-01 -2.59676103e-02  2.70831420e-02]
 [-1.84322549e-01 -1.67092597e-01  5.55936934e-01]
 [ 3.73234316e-02 -9.47593482e-02  5.44372494e-02]
 [-9.75290193e-01  9.12186437e-01 -1.07795274e-01]
 [-5.08903230e-03  2.28802937e-02 -1.63898045e-02]
 [-3.66100598e-02  3.08020161e-02 -6.83384095e-02]
 [ 6.14682939e-02  2.78727146e-02  6.10363577e-02]
 [-1.14637381e-01  1.86775632e-01 -4.62440877e-02]
 [ 3.48396515e-02  4.78626303e-02 -5.46659611e-02]
 [ 7.48095059e-02 -7.25185087e-03 -2.53205619e-02]
 [-8.09997134e-02 -7.09348513e-02  8.44948167e-02]
 [ 2.04006078e-02  4.29328917e-01 -3.08429934e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 4.63229026e-02  2.02708803e-02  1.98249027e-02]
 [ 4.32839564e-02  2.21223247e-02  1.08155240e-01]
 [ 4.20605327e-02 -1.17549158e-01 -3.55684805e-02]
 [-9.79919159e-02  8.62583871e-02 -6.71108214e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.692369]
curr_Stock_Price:  99.6240617040569
curr_Factors:  [99.6240617  -0.99852751 -1.00920624]
mat_Sqrt:  [[13.37878132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00233982  0.03357869  0.07082751]
Stock Position:  -0.002339820045816632
Bond Position:  [-0.45926663]


portfolio before change:  [-0.69246747]
curr_Stock_Price:  99.61706554866345
curr_Factors:  [99.61706555 -0.97177407 -0.97686845]
mat_Sqrt:  [[14.19217812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112385  0.0271648  -0.46275986]
Stock Position:  0.0011238456255522132
Bond Position:  [-0.80442167]


portfolio before change:  [-0.69455876]
curr_Stock_Price:  97.9351983540975
curr_Factors:  [97.93519835 -0.80019345 -0.97404013]
mat_Sqrt:  [[16.61112143  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00687194 -0.00838101  0.07726067]
Stock Position:  0.006871944320109633
Bond Position:  [-1.36756399]


portfolio before change:  [-0.68309225]
curr_Stock_Price:  99.65355281852838
curr_Factors:  [99.65355282 -1.05049189 -0.95876193]
mat_Sqrt:  [[13.36241455  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00785412 -0.0539289   1.58593333]
Stock Position:  -0.007854121776023026
Bond Position:  [0.09959889]


portfolio before change:  [-0.67533914]
curr_Stock_Price:  98.66958437603917
curr_Factors:  [98.66958438 -0.97163934 -0.97670614]
mat_Sqrt:  [[14.06136906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00206898 -0.03058345  0.15529432]
Stock Position:  0.0020689818661444974
Bond Position:  [-0.87948472]


portfolio before change:  [-0.6769909]
curr_Stock_Price:  97.9775229105278
curr_Factors:  [97.97752291 -1.15237613 -0.96345191]
mat_Sqrt:  [[11.80956804  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06868113  0.29440691 -0.30750991]
Stock Position:  -0.06868113477023179
Bond Position:  [6.05221655]


portfolio before change:  [-0.78659066]
curr_Stock_Price:  99.59533250230399
curr_Factors:  [99.5953325  -1.04665903 -0.98556828]
mat_Sqrt:  [[13.0513032   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00028841  0.00738458 -0.04675555]
Stock Position:  -0.0002884130931324088
Bond Position:  [-0.75786606]


portfolio before change:  [-0.78663688]
curr_Stock_Price:  99.09856997111632
curr_Factors:  [99.09856997 -0.97501914 -0.99380622]
mat_Sqrt:  [[13.83621804  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00319973  0.00994131 -0.19495046]
Stock Position:  -0.003199728701270287
Bond Position:  [-0.46954834]


portfolio before change:  [-0.79138854]
curr_Stock_Price:  100.54689849734135
curr_Factors:  [100.5468985   -1.26450121  -1.0071289 ]
mat_Sqrt:  [[10.37079997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00767701 0.00899588 0.17411974]
Stock Position:  0.007677014550656689
Bond Position:  [-1.56328854]


portfolio before change:  [-0.79211543]
curr_Stock_Price:  100.50312888854884
curr_Factors:  [100.50312889  -0.93367697  -0.96499406]
mat_Sqrt:  [[15.05210474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00571026  0.06028158 -0.13192151]
Stock Position:  -0.005710264503767411
Bond Position:  [-0.21821598]


portfolio before change:  [-0.79994069]
curr_Stock_Price:  101.86395873965844
curr_Factors:  [101.86395874  -0.55033892  -1.01893452]
mat_Sqrt:  [[21.20770896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0015773   0.0154476  -0.15594677]
Stock Position:  0.0015773003789361154
Bond Position:  [-0.96061075]


portfolio before change:  [-0.80085713]
curr_Stock_Price:  101.43521344606404
curr_Factors:  [101.43521345  -0.45377713  -1.01924209]
mat_Sqrt:  [[23.25223092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00293136 -0.00234052 -0.07223252]
Stock Position:  0.002931361304806182
Bond Position:  [-1.09820039]


portfolio before change:  [-0.80446317]
curr_Stock_Price:  100.29872414577318
curr_Factors:  [100.29872415  -0.37603504  -1.03380542]
mat_Sqrt:  [[24.49116678  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00319429 -0.02289412  0.24104019]
Stock Position:  -0.0031942862399906694
Bond Position:  [-0.48408034]


portfolio before change:  [-0.80375086]
curr_Stock_Price:  100.0378361689496
curr_Factors:  [100.03783617  -0.51347499  -1.02378497]
mat_Sqrt:  [[21.50506559  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0020962   0.13856531 -0.87986475]
Stock Position:  0.002096204224377934
Bond Position:  [-1.01345059]


portfolio before change:  [-0.80654307]
curr_Stock_Price:  98.8266851549305
curr_Factors:  [98.82668515 -0.35071076 -1.00591131]
mat_Sqrt:  [[25.45075966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00522551 -0.09296045 -0.18429859]
Stock Position:  -0.005225505263678241
Bond Position:  [-0.29012371]


portfolio before change:  [-0.80218576]
curr_Stock_Price:  97.97894850262374
curr_Factors:  [97.9789485  -0.90265374 -0.9897266 ]
mat_Sqrt:  [[14.76666533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00369125 0.0065424  0.05655493]
Stock Position:  0.0036912477406344547
Bond Position:  [-1.16385033]


portfolio before change:  [-0.80465435]
curr_Stock_Price:  97.38901509594002
curr_Factors:  [97.3890151  -1.08232981 -0.94889603]
mat_Sqrt:  [[12.77496738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00546982 0.00713995 0.3085368 ]
Stock Position:  0.0054698185063091495
Bond Position:  [-1.33735459]


portfolio before change:  [-0.79249046]
curr_Stock_Price:  99.67396663279217
curr_Factors:  [99.67396663 -1.2259332  -0.98207373]
mat_Sqrt:  [[10.95611329  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00098626 -0.03793883 -0.10146697]
Stock Position:  0.0009862553873040514
Bond Position:  [-0.89079445]


portfolio before change:  [-0.79217529]
curr_Stock_Price:  100.21935980274712
curr_Factors:  [100.2193598   -1.0819608   -1.01279918]
mat_Sqrt:  [[12.3369818   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00662677  0.02783977 -0.01914485]
Stock Position:  -0.0066267740070245496
Bond Position:  [-0.12804424]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.79651565]
Stock Price:  100.86950172501443
PL:  [-1.66601737]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-2.92979828e-02  1.65115302e-02  4.04152720e-02]
 [ 3.86588126e-02  1.84170586e-01 -2.52763507e-01]
 [-6.81410866e-02 -3.94033728e-02 -6.13969087e-02]
 [-2.39804266e-01 -2.30759399e-01  9.38820582e-01]
 [-2.81871528e-02  1.95291605e-03 -1.07010950e-02]
 [-9.84357976e-01  1.00080723e+00 -1.36789469e-01]
 [ 1.16845598e-02 -9.66261229e-03  3.67818752e-02]
 [-8.41216666e-02 -3.68560727e-02  1.23469907e-02]
 [ 8.08009689e-02  2.76716409e-02  6.27500901e-02]
 [-1.73528968e-01  2.00186883e-01 -7.71931494e-02]
 [ 8.57267754e-02  3.16353159e-02 -5.23585158e-02]
 [-8.49797695e-03  1.25159073e-01 -6.15832217e-03]
 [-1.25030235e-01 -1.00269012e-01 -4.77051645e-02]
 [ 3.65404389e-02  3.71907842e-01 -1.70478157e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 5.24850007e-02  2.70701841e-02  7.98382205e-02]
 [-3.53259678e-02  2.24124720e-02  7.06588230e-02]
 [-1.13060523e-02 -1.30880360e-02  2.93176610e-03]
 [-3.75728823e-03 -1.41410419e-02 -1.31077024e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.19467366]
curr_Stock_Price:  100.24013038657407
curr_Factors:  [100.24013039  -0.98811686  -0.99482502]
mat_Sqrt:  [[13.79942225  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00128106  0.00532907  0.11529352]
Stock Position:  -0.0012810571055395358
Bond Position:  [4.32308699]


portfolio before change:  [4.19511396]
curr_Stock_Price:  100.74018834885156
curr_Factors:  [100.74018835  -0.85341019  -1.00572476]
mat_Sqrt:  [[15.69606202  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00157093  0.0594408  -0.72106393]
Stock Position:  0.0015709253076258247
Bond Position:  [4.03685865]


portfolio before change:  [4.19768638]
curr_Stock_Price:  101.73519421376042
curr_Factors:  [101.73519421  -1.02632787  -0.99346788]
mat_Sqrt:  [[13.49848627  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00657236 -0.01271738 -0.17514829]
Stock Position:  -0.0065723560446390265
Bond Position:  [4.8663263]


portfolio before change:  [4.19745416]
curr_Stock_Price:  101.95565730585668
curr_Factors:  [101.95565731  -1.01456222  -0.96615192]
mat_Sqrt:  [[14.0668906   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00677277 -0.07447728  2.6781938 ]
Stock Position:  -0.006772774851811326
Bond Position:  [4.88797687]


portfolio before change:  [4.2037285]
curr_Stock_Price:  101.20970131017393
curr_Factors:  [101.20970131  -0.9105338   -0.94930441]
mat_Sqrt:  [[15.7581298   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190206  0.0006303  -0.03052725]
Stock Position:  -0.0019020573987372506
Bond Position:  [4.39623516]


portfolio before change:  [4.20587723]
curr_Stock_Price:  100.6579090080394
curr_Factors:  [100.65790901  -1.02342076  -0.90907759]
mat_Sqrt:  [[14.57385806  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05544113  0.32300915 -0.39022228]
Stock Position:  -0.0554411250939899
Bond Position:  [9.78646496]


portfolio before change:  [4.19253916]
curr_Stock_Price:  100.94262540215892
curr_Factors:  [100.9426254   -1.00018015  -0.8976035 ]
mat_Sqrt:  [[15.13134832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00113805 -0.00311859  0.10492845]
Stock Position:  0.0011380516629867028
Bond Position:  [4.07766123]


portfolio before change:  [4.19494545]
curr_Stock_Price:  102.16115808617548
curr_Factors:  [102.16115809  -1.10390157  -0.90334485]
mat_Sqrt:  [[13.72618235  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00649303 -0.01189525  0.03522253]
Stock Position:  -0.006493033513428796
Bond Position:  [4.85828128]


portfolio before change:  [4.20499096]
curr_Stock_Price:  100.80111845387067
curr_Factors:  [100.80111845  -0.96879233  -0.901077  ]
mat_Sqrt:  [[15.53786773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00638815 0.00893098 0.17900854]
Stock Position:  0.006388149852777211
Bond Position:  [3.56105831]


portfolio before change:  [4.20760719]
curr_Stock_Price:  101.07128389024483
curr_Factors:  [101.07128389  -0.81676667  -0.8723149 ]
mat_Sqrt:  [[18.66676153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00795119  0.06461004 -0.22021057]
Stock Position:  -0.007951190502967453
Bond Position:  [5.01124422]


portfolio before change:  [4.20968502]
curr_Stock_Price:  100.96754310458233
curr_Factors:  [100.9675431   -0.95148115  -0.86552657]
mat_Sqrt:  [[16.40836696  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00496678  0.01021025 -0.14936427]
Stock Position:  0.004966775190754382
Bond Position:  [3.70820193]


portfolio before change:  [4.21170084]
curr_Stock_Price:  101.18673087826366
curr_Factors:  [101.18673088  -0.86204965  -0.85108816]
mat_Sqrt:  [[18.24388265  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00086566  0.04039492 -0.01756798]
Stock Position:  0.0008656572685466058
Bond Position:  [4.12410782]


portfolio before change:  [4.21237749]
curr_Stock_Price:  100.77720194506769
curr_Factors:  [100.77720195  -0.90578827  -0.8818799 ]
mat_Sqrt:  [[16.86505926  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00920455 -0.03236168 -0.13608956]
Stock Position:  -0.009204553336553137
Bond Position:  [5.13998662]


portfolio before change:  [4.2397919]
curr_Stock_Price:  97.93847069088606
curr_Factors:  [97.93847069 -1.1938136  -0.91159401]
mat_Sqrt:  [[11.92851583  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00651021  0.12003274 -0.48632673]
Stock Position:  0.006510206483054387
Bond Position:  [3.60219223]


portfolio before change:  [4.24328666]
curr_Stock_Price:  98.3369379295891
curr_Factors:  [98.33693793 -1.23146452 -0.90847503]
mat_Sqrt:  [[11.5705165   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01149413 -0.09296045 -0.18429859]
Stock Position:  -0.011494134992013487
Bond Position:  [5.3735847]


portfolio before change:  [4.24390254]
curr_Stock_Price:  98.40024782541666
curr_Factors:  [98.40024783 -1.0691514  -0.93251612]
mat_Sqrt:  [[13.29483756  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00558921 0.00873686 0.22775622]
Stock Position:  0.005589206113472191
Bond Position:  [3.69392327]


portfolio before change:  [4.24070422]
curr_Stock_Price:  97.66277019372141
curr_Factors:  [97.66277019 -0.70379135 -0.9326189 ]
mat_Sqrt:  [[19.01275716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085878  0.00723359  0.20156995]
Stock Position:  -0.000858784925577079
Bond Position:  [4.32457553]


portfolio before change:  [4.24129566]
curr_Stock_Price:  98.23315726648599
curr_Factors:  [98.23315727 -0.65152758 -0.91430016]
mat_Sqrt:  [[20.52238143  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00065193 -0.00422415  0.00836351]
Stock Position:  -0.000651931757004917
Bond Position:  [4.30533697]


portfolio before change:  [4.2423078]
curr_Stock_Price:  98.33182898167729
curr_Factors:  [98.33182898 -0.78989736 -0.86687382]
mat_Sqrt:  [[18.75717946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00178064 -0.004564   -0.37392627]
Stock Position:  -0.0017806409504532799
Bond Position:  [4.41740148]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.24218426]
Stock Price:  99.02148368735035
PL:  [4.24218426]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.39363731e-01  2.29007395e-01 -1.40425307e-02]
 [ 8.98219719e-03  4.88754931e-03 -1.25729081e-02]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-1.98850235e-01 -1.78953171e-01  7.80105477e-01]
 [-8.26657325e-03 -2.74555280e-02  9.10629316e-03]
 [-8.84079988e-01  9.45720022e-01 -1.31223861e-01]
 [ 1.09796147e-02 -7.50830293e-03  3.28429428e-02]
 [-8.08287892e-02 -1.29400573e-02 -2.18500962e-02]
 [ 9.94694469e-02  2.86856604e-02  5.38382847e-02]
 [-1.69442944e-01  1.96401099e-01 -7.82907168e-02]
 [ 1.19789171e-01  3.22563373e-02 -5.27113843e-02]
 [-9.79412665e-02  1.19043666e-01  1.58579158e-01]
 [-1.88219460e-01 -1.32018741e-01  3.87627860e-02]
 [ 4.12951733e-02  5.51236576e-01 -3.04837024e-01]
 [ 9.84647399e-03 -1.85331568e-01 -5.47432960e-02]
 [ 7.24778931e-02  5.68075178e-02  2.65432710e-01]
 [-3.93082588e-02  1.59184272e-02  8.14391511e-02]
 [ 4.47976126e-02 -1.38461940e-01 -3.53664580e-02]
 [-1.02881251e-01  1.32786762e-01 -3.79467177e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.77114743]
curr_Stock_Price:  98.22745256885798
curr_Factors:  [98.22745257 -1.0733881  -0.95511133]
mat_Sqrt:  [[12.92012676  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00739035  0.07391182 -0.04005943]
Stock Position:  -0.0073903463702201765
Bond Position:  [-11.04521253]


portfolio before change:  [-11.77834708]
curr_Stock_Price:  98.82796612234694
curr_Factors:  [98.82796612 -0.92969357 -0.95705598]
mat_Sqrt:  [[14.97872817  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00049493  0.00157745 -0.03586701]
Stock Position:  0.0004949305321348172
Bond Position:  [-11.82726006]


portfolio before change:  [-11.78036922]
curr_Stock_Price:  100.71721736229503
curr_Factors:  [100.71721736  -1.00881033  -0.97052077]
mat_Sqrt:  [[13.91525421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00560699  0.01370813 -0.02999186]
Stock Position:  -0.005606993398448299
Bond Position:  [-11.21564845]


portfolio before change:  [-11.78777759]
curr_Stock_Price:  101.5383542714446
curr_Factors:  [101.53835427  -1.15664666  -0.91701825]
mat_Sqrt:  [[12.76582517  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0059644  -0.05775689  2.22542379]
Stock Position:  -0.0059644036257524066
Bond Position:  [-11.18216186]


portfolio before change:  [-11.78881373]
curr_Stock_Price:  101.24331290110284
curr_Factors:  [101.2433129   -1.17785047  -0.90824831]
mat_Sqrt:  [[12.57144387  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095551 -0.00886123  0.02597772]
Stock Position:  -0.0009555064048039774
Bond Position:  [-11.6920751]


portfolio before change:  [-11.79281208]
curr_Stock_Price:  102.36832840074919
curr_Factors:  [102.3683284   -1.19288915  -0.91182619]
mat_Sqrt:  [[12.47668912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05753302  0.30522982 -0.37434515]
Stock Position:  -0.057533024075546425
Bond Position:  [-5.90325258]


portfolio before change:  [-11.72885036]
curr_Stock_Price:  101.23093441906502
curr_Factors:  [101.23093442  -1.42288193  -0.91386199]
mat_Sqrt:  [[ 9.78313967  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0016509  -0.00242329  0.09369177]
Stock Position:  0.001650904202288567
Bond Position:  [-11.89597294]


portfolio before change:  [-11.7339591]
curr_Stock_Price:  99.93808471323248
curr_Factors:  [99.93808471 -1.32241712 -0.93376301]
mat_Sqrt:  [[10.4684996   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00839951 -0.00417639 -0.06233224]
Stock Position:  -0.008399513100634283
Bond Position:  [-10.89452784]


portfolio before change:  [-11.73502088]
curr_Stock_Price:  99.7401938160478
curr_Factors:  [99.74019382 -1.43726943 -0.94818689]
mat_Sqrt:  [[ 9.18078229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01266935 0.00925826 0.15358564]
Stock Position:  0.01266935354563231
Bond Position:  [-12.99866466]


portfolio before change:  [-11.7259744]
curr_Stock_Price:  100.7107681253457
curr_Factors:  [100.71076813  -1.51409445  -0.96004257]
mat_Sqrt:  [[ 8.48343728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01713147  0.06338818 -0.22334162]
Stock Position:  -0.01713147145495856
Bond Position:  [-10.00065076]


portfolio before change:  [-11.7222516]
curr_Stock_Price:  100.34750238603475
curr_Factors:  [100.34750239  -1.64866931  -0.9823556 ]
mat_Sqrt:  [[ 7.22548441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01600084  0.01041069 -0.15037091]
Stock Position:  0.016000837561854282
Bond Position:  [-13.32789569]


portfolio before change:  [-11.70912587]
curr_Stock_Price:  101.37608127412956
curr_Factors:  [101.37608127  -1.46405006  -0.98039321]
mat_Sqrt:  [[ 8.79685187  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00469165  0.03842118  0.4523822 ]
Stock Position:  -0.004691649410877475
Bond Position:  [-11.23350484]


portfolio before change:  [-11.71064413]
curr_Stock_Price:  101.10102444396435
curr_Factors:  [101.10102444  -1.49035743  -0.9974816 ]
mat_Sqrt:  [[ 8.40041594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02467202 -0.04260887  0.11057944]
Stock Position:  -0.024672022645436435
Bond Position:  [-9.21627736]


portfolio before change:  [-11.68983338]
curr_Stock_Price:  100.16412898581257
curr_Factors:  [100.16412899  -1.39121324  -0.98291899]
mat_Sqrt:  [[ 9.32480355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00982233  0.17791084 -0.86961518]
Stock Position:  0.009822327181590488
Bond Position:  [-12.67367823]


portfolio before change:  [-11.68942106]
curr_Stock_Price:  100.5287199879575
curr_Factors:  [100.52871999  -1.49826642  -0.96571582]
mat_Sqrt:  [[ 8.55453215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00457753 -0.05981551 -0.15616739]
Stock Position:  -0.004577527054770916
Bond Position:  [-11.22924813]


portfolio before change:  [-11.69219916]
curr_Stock_Price:  100.52226025550921
curr_Factors:  [100.52226026  -1.61335507  -0.99685238]
mat_Sqrt:  [[ 7.39032528  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01870755 0.01833455 0.75720564]
Stock Position:  0.01870755330620308
Bond Position:  [-13.5727247]


portfolio before change:  [-11.70502378]
curr_Stock_Price:  100.01813108102084
curr_Factors:  [100.01813108  -1.4638365   -0.98232059]
mat_Sqrt:  [[ 8.66415499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224318  0.00513765  0.23232323]
Stock Position:  -0.0022431762161808696
Bond Position:  [-11.48066549]


portfolio before change:  [-11.70861524]
curr_Stock_Price:  100.33952094484084
curr_Factors:  [100.33952094  -1.36258632  -1.0109471 ]
mat_Sqrt:  [[ 9.34672702  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099661 -0.0446884  -0.10089066]
Stock Position:  0.000996609766488523
Bond Position:  [-11.80861459]


portfolio before change:  [-11.71195316]
curr_Stock_Price:  99.95281764142574
curr_Factors:  [99.95281764 -1.2180587  -0.95296489]
mat_Sqrt:  [[11.40069893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00671458  0.04285674 -0.01082514]
Stock Position:  -0.00671457521177801
Bond Position:  [-11.04081245]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.71032958]
Stock Price:  99.29989121659695
PL:  [-11.71032958]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-8.54712804e-02  1.63434896e-01  9.57499708e-03]
 [ 3.37554608e-02  1.41881169e-01 -2.03085274e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-2.09213008e-01 -1.88929376e-01  8.61959021e-01]
 [-1.37437262e-02 -1.93696917e-02  3.66026214e-03]
 [-9.32977399e-01  1.00710476e+00 -1.42892345e-01]
 [ 9.07473838e-03 -5.65693399e-03  2.43749356e-02]
 [-8.73884875e-02 -2.47888970e-02 -1.22587046e-02]
 [-1.02588188e-01 -9.18115836e-03  1.55304651e-02]
 [-8.97267106e-01  3.60560804e-01 -4.62583756e-01]
 [ 1.38749445e-01  4.50991111e-02 -5.49727521e-02]
 [-7.56896767e-02  1.30749754e-01  1.05482639e-01]
 [ 2.28005847e-02 -8.43909663e-02 -1.03016707e-01]
 [ 2.71388131e-02  8.30310029e-01 -5.02131027e-01]
 [ 1.46949522e-01 -6.23423106e-02 -5.17192094e-03]
 [ 3.25514483e-02 -1.52080625e-02  8.24306592e-03]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.57296811e-02 -1.73969990e-01 -3.67841009e-02]
 [-1.43926864e-01  4.48425314e-02 -1.68832062e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.88071133]
curr_Stock_Price:  99.2221339966797
curr_Factors:  [99.222134   -0.92617251 -0.97154893]
mat_Sqrt:  [[14.8743711   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337196  0.05274839  0.0273148 ]
Stock Position:  -0.003371959960174712
Bond Position:  [-3.54613826]


portfolio before change:  [-3.88566489]
curr_Stock_Price:  100.42823200434785
curr_Factors:  [100.428232    -1.07535116  -0.96395544]
mat_Sqrt:  [[13.06761155  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00162709  0.04579195 -0.57934576]
Stock Position:  0.0016270934493335819
Bond Position:  [-4.049071]


portfolio before change:  [-3.8867739]
curr_Stock_Price:  100.36884856182817
curr_Factors:  [100.36884856  -0.78666256  -1.00627323]
mat_Sqrt:  [[16.70847534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00466965  0.01370813 -0.02999186]
Stock Position:  -0.004669650395043738
Bond Position:  [-3.41808647]


portfolio before change:  [-3.89569676]
curr_Stock_Price:  102.0966504256527
curr_Factors:  [102.09665043  -1.1579494   -0.99280638]
mat_Sqrt:  [[11.88365749  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00604455 -0.06097669  2.45892916]
Stock Position:  -0.006044553758970322
Bond Position:  [-3.27856807]


portfolio before change:  [-3.8936975]
curr_Stock_Price:  101.63027964615084
curr_Factors:  [101.63027965  -1.08224609  -1.00754359]
mat_Sqrt:  [[12.57300217  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00134816 -0.00625154  0.01044171]
Stock Position:  -0.0013481585258749132
Bond Position:  [-3.75668378]


portfolio before change:  [-3.89562384]
curr_Stock_Price:  102.36242260461857
curr_Factors:  [102.3624226   -1.3207255   -1.00278088]
mat_Sqrt:  [[10.02431152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07547359  0.32504166 -0.40763209]
Stock Position:  -0.07547359000926963
Bond Position:  [3.83003568]


portfolio before change:  [-3.95729958]
curr_Stock_Price:  103.19229396260893
curr_Factors:  [103.19229396  -1.71896829  -1.00876738]
mat_Sqrt:  [[ 6.74538462  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00191176 -0.00182577  0.06953491]
Stock Position:  0.0019117567328708375
Bond Position:  [-4.15457814]


portfolio before change:  [-3.95844054]
curr_Stock_Price:  103.13884297125374
curr_Factors:  [103.13884297  -1.65911195  -0.97231847]
mat_Sqrt:  [[ 7.42346291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01279063 -0.00800058 -0.03497067]
Stock Position:  -0.012790634064198586
Bond Position:  [-2.63922934]


portfolio before change:  [-3.97428695]
curr_Stock_Price:  104.32615896471414
curr_Factors:  [104.32615896  -1.49660715  -0.97201799]
mat_Sqrt:  [[ 8.83655417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01146286 -0.00296321  0.04430409]
Stock Position:  -0.011462855232071509
Bond Position:  [-2.77841129]


portfolio before change:  [-3.97772125]
curr_Stock_Price:  104.56515729506937
curr_Factors:  [104.5651573   -1.59507171  -1.01039218]
mat_Sqrt:  [[ 7.7241092   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11886063  0.1163705  -1.3196227 ]
Stock Position:  -0.11886062585648972
Bond Position:  [8.45095879]


portfolio before change:  [-3.91367256]
curr_Stock_Price:  104.04407911004218
curr_Factors:  [104.04407911  -1.6130075   -1.04717687]
mat_Sqrt:  [[ 7.2763566   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01879155  0.01455568 -0.15682196]
Stock Position:  0.01879154693537764
Bond Position:  [-5.86882176]


portfolio before change:  [-3.91885028]
curr_Stock_Price:  103.84663254030984
curr_Factors:  [103.84663254  -1.1098565   -1.05584521]
mat_Sqrt:  [[11.90803544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00230676  0.0421993   0.30091261]
Stock Position:  -0.002306756774123602
Bond Position:  [-3.67930135]


portfolio before change:  [-3.91959552]
curr_Stock_Price:  103.770899970789
curr_Factors:  [103.77089997  -1.14454277  -1.00790072]
mat_Sqrt:  [[12.0581658   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00128161 -0.02723707 -0.29387799]
Stock Position:  -0.0012816083927975376
Bond Position:  [-3.78660186]


portfolio before change:  [-3.92093172]
curr_Stock_Price:  104.07475880895198
curr_Factors:  [104.07475881  -1.15012681  -0.97685977]
mat_Sqrt:  [[12.40528877  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00758774  0.26798141 -1.43244006]
Stock Position:  0.007587737204708114
Bond Position:  [-4.71062364]


portfolio before change:  [-3.91609955]
curr_Stock_Price:  104.86682292690746
curr_Factors:  [104.86682293  -0.94197149  -1.01574411]
mat_Sqrt:  [[14.80515736  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00899472 -0.02012089 -0.01475405]
Stock Position:  0.008994719474120368
Bond Position:  [-4.8593472]


portfolio before change:  [-3.92874595]
curr_Stock_Price:  103.59592059062584
curr_Factors:  [103.59592059  -1.02793228  -0.9977157 ]
mat_Sqrt:  [[13.66516613  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227803 -0.00490838  0.02351517]
Stock Position:  0.0022780348270072166
Bond Position:  [-4.16474106]


portfolio before change:  [-3.92946702]
curr_Stock_Price:  103.73649898452868
curr_Factors:  [103.73649898  -1.05566164  -0.99062029]
mat_Sqrt:  [[13.40425371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00513194  0.00525786  0.16709793]
Stock Position:  -0.005131939263937906
Bond Position:  [-3.39709761]


portfolio before change:  [-3.9354879]
curr_Stock_Price:  104.74420887277847
curr_Factors:  [104.74420887  -0.98766457  -1.01585649]
mat_Sqrt:  [[14.12576194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00019183 -0.05614857 -0.1049348 ]
Stock Position:  0.0001918255851436566
Bond Position:  [-3.95558052]


portfolio before change:  [-3.93680351]
curr_Stock_Price:  103.04170166040726
curr_Factors:  [103.04170166  -1.00941244  -1.00196176]
mat_Sqrt:  [[13.78746123  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01002503  0.01447286 -0.04816309]
Stock Position:  -0.010025028425934276
Bond Position:  [-2.90380752]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.93164416]
Stock Price:  102.45463196866064
PL:  [-6.38627613]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.95450455e-02  4.73708607e-03  4.24793415e-02]
 [ 3.53729643e-02  1.76982091e-01 -2.38576552e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-1.90656120e-01 -1.75030999e-01  5.59195967e-01]
 [ 3.27614376e-02 -8.80245470e-02  4.99011773e-02]
 [-1.21061134e+00  1.24499958e+00 -1.80741994e-01]
 [-2.99780012e-03  1.91349304e-02 -1.04364139e-02]
 [-6.77758413e-02 -1.56419359e-02 -1.21243613e-02]
 [ 7.81123817e-02  2.86067313e-02  5.94683502e-02]
 [-8.74199687e-03  1.66677242e-01  1.39717242e-02]
 [ 7.43979190e-02  4.44275459e-02 -5.75369628e-02]
 [-9.33550225e-02 -3.49750299e-02 -1.55297933e-02]
 [-1.87890830e-02  1.01193115e-01  7.74688920e-02]
 [ 5.47921869e-03  3.88046519e-01 -3.30457242e-01]
 [-5.36967774e-02 -2.77424884e-01 -6.35863868e-02]
 [ 5.54365747e-02  6.90195172e-02  5.74535022e-02]
 [-8.94701815e-02  1.74824935e-02  5.46790478e-02]
 [-5.73459042e-02  5.97049812e-02  4.41504978e-02]
 [ 1.36098278e-01 -1.81220895e-01 -3.47253599e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.25772915]
curr_Stock_Price:  100.37414092042908
curr_Factors:  [100.37414092  -0.962959    -1.00030442]
mat_Sqrt:  [[14.09247821  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.000703    0.00152889  0.12118174]
Stock Position:  -0.0007030014506802432
Bond Position:  [5.32829232]


portfolio before change:  [5.25875578]
curr_Stock_Price:  100.80886038959115
curr_Factors:  [100.80886039  -0.69467857  -0.9921989 ]
mat_Sqrt:  [[18.6593764   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00122191  0.05712072 -0.6805925 ]
Stock Position:  0.0012219083290633706
Bond Position:  [5.1355766]


portfolio before change:  [5.26011797]
curr_Stock_Price:  100.87280670485629
curr_Factors:  [100.8728067   -0.71542184  -0.99194105]
mat_Sqrt:  [[18.29261632  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00426526  0.01370813 -0.02999186]
Stock Position:  -0.0042652585685772765
Bond Position:  [5.69036658]


portfolio before change:  [5.26736894]
curr_Stock_Price:  99.50637169493065
curr_Factors:  [99.50637169 -1.00544487 -1.01583032]
mat_Sqrt:  [[13.18324217  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00851375 -0.05649101  1.59523044]
Stock Position:  -0.008513745897433679
Bond Position:  [6.11454091]


portfolio before change:  [5.272302]
curr_Stock_Price:  99.10652062910681
curr_Factors:  [99.10652063 -1.04159571 -1.05291565]
mat_Sqrt:  [[12.20302515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.002047   -0.0284098   0.14235417]
Stock Position:  0.0020469954829737593
Bond Position:  [5.0694314]


portfolio before change:  [5.27607661]
curr_Stock_Price:  100.33128692617106
curr_Factors:  [100.33128693  -0.9090511   -1.04890213]
mat_Sqrt:  [[14.16146216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07014605  0.40182189 -0.5156066 ]
Stock Position:  -0.07014605292775501
Bond Position:  [12.31392037]


portfolio before change:  [5.32848214]
curr_Stock_Price:  99.62808741822292
curr_Factors:  [99.62808742 -0.87936625 -1.0276027 ]
mat_Sqrt:  [[14.79775049  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.25951816e-05  6.17577222e-03 -2.97721840e-02]
Stock Position:  -8.259518157214498e-05
Bond Position:  [5.33671094]


portfolio before change:  [5.32979413]
curr_Stock_Price:  99.89869493197098
curr_Factors:  [99.89869493 -0.59783608 -1.04846273]
mat_Sqrt:  [[19.25667615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00381393 -0.00504841 -0.03458743]
Stock Position:  -0.0038139299009581355
Bond Position:  [5.71080075]


portfolio before change:  [5.32923098]
curr_Stock_Price:  100.42073870501031
curr_Factors:  [100.42073871  -0.32905316  -1.09671059]
mat_Sqrt:  [[24.13359844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00398161 0.00923278 0.16964665]
Stock Position:  0.003981612301106344
Bond Position:  [4.92939453]


portfolio before change:  [5.32792779]
curr_Stock_Price:  99.78389032929731
curr_Factors:  [99.78389033 -0.19423454 -1.08188596]
mat_Sqrt:  [[27.85148379  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0010101  0.05379485 0.03985744]
Stock Position:  0.0010101012594925425
Bond Position:  [5.22713596]


portfolio before change:  [5.33229315]
curr_Stock_Price:  102.81171260699246
curr_Factors:  [102.81171261  -0.32662083  -1.07322054]
mat_Sqrt:  [[25.35707818  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00282848  0.01433893 -0.16413694]
Stock Position:  0.002828479289979051
Bond Position:  [5.04149235]


portfolio before change:  [5.33727623]
curr_Stock_Price:  104.12780792151969
curr_Factors:  [ 1.04127808e+02 -7.99141174e-02 -1.03133793e+00]
mat_Sqrt:  [[34.27331365  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302464 -0.01128814 -0.04430218]
Stock Position:  -0.00302463535890841
Bond Position:  [5.65222488]


portfolio before change:  [5.34531883]
curr_Stock_Price:  101.9360181911529
curr_Factors:  [ 1.01936018e+02 -7.61458705e-02 -1.03557682e+00]
mat_Sqrt:  [[33.53610626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0005272  0.03265994 0.22099719]
Stock Position:  0.0005271973516495944
Bond Position:  [5.29157843]


portfolio before change:  [5.34587744]
curr_Stock_Price:  100.48599338626677
curr_Factors:  [100.48599339   0.32548574  -1.00405771]
mat_Sqrt:  [[50.98066203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.38061135e-04  1.25241475e-01 -9.42702531e-01]
Stock Position:  0.0003380611351723875
Bond Position:  [5.31190703]


portfolio before change:  [5.34736511]
curr_Stock_Price:  100.95789445057306
curr_Factors:  [100.95789445   0.13072762  -0.98204552]
mat_Sqrt:  [[43.09408034  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00286131 -0.0895385  -0.18139426]
Stock Position:  -0.002861307415710617
Bond Position:  [5.63623668]


portfolio before change:  [5.34659507]
curr_Stock_Price:  101.71953174994299
curr_Factors:  [101.71953175   0.19836038  -0.99593453]
mat_Sqrt:  [[45.81654106  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00177344 0.02227595 0.16389885]
Stock Position:  0.0017734374927248367
Bond Position:  [5.16620184]


portfolio before change:  [5.3448987]
curr_Stock_Price:  100.0346222088451
curr_Factors:  [ 1.00034622e+02  9.55839150e-02 -9.71948103e-01]
mat_Sqrt:  [[41.64378591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00179475  0.00564245  0.1559841 ]
Stock Position:  -0.0017947520110185625
Bond Position:  [5.52443604]


portfolio before change:  [5.35208814]
curr_Stock_Price:  96.79842998076319
curr_Factors:  [96.79842998 -0.13284876 -0.93967336]
mat_Sqrt:  [[33.11905017  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109141  0.0192697   0.12594908]
Stock Position:  -0.0010914109300638288
Bond Position:  [5.45773501]


portfolio before change:  [5.35625422]
curr_Stock_Price:  94.23159181456023
curr_Factors:  [94.23159181 -0.52765872 -0.92537287]
mat_Sqrt:  [[22.03702284  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00128075 -0.05848879 -0.99061786]
Stock Position:  0.0012807480545904864
Bond Position:  [5.23556729]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.35539885]
Stock Price:  92.54161889974796
PL:  [5.35539885]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.20936489e-01  2.06575045e-01 -6.43282692e-03]
 [-6.11265777e-03  8.18861501e-02 -6.19953421e-02]
 [ 6.12123447e-02 -1.42946469e-01 -3.38827854e-01]
 [-3.97071231e-01 -4.28026909e-01  1.65277006e+00]
 [-4.91430498e-02 -1.37921920e-01 -5.51953989e-02]
 [-1.02343382e+00  1.15648458e+00 -1.74237269e-01]
 [ 2.37253382e-03 -2.72594796e-02  9.98932211e-03]
 [-5.16899678e-02 -1.19045721e-01  1.76071206e-01]
 [ 4.23283349e-02 -1.08983170e-04  2.13154825e-02]
 [-2.16531744e-01  2.10506531e-01 -9.91936371e-02]
 [ 4.11821342e-02  5.09699667e-02 -5.52259977e-02]
 [-3.56496216e-03 -6.14357169e-02 -1.80337496e-02]
 [ 8.94078436e-02  9.24322886e-02 -1.92451804e-02]
 [ 1.12129076e-02  6.22855315e-01 -4.35184393e-01]
 [ 2.91787754e-02 -1.57313238e-01 -5.20528876e-02]
 [ 6.52179039e-02  6.27597966e-02  1.75248993e-01]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 3.86384610e-02 -1.06755024e-01 -4.07852606e-02]
 [-1.38735777e-01  4.87904354e-02 -1.38618067e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.30904145]
curr_Stock_Price:  99.04207633862228
curr_Factors:  [99.04207634 -0.47169459 -0.98923172]
mat_Sqrt:  [[22.97986671  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0034849   0.06667181 -0.01835106]
Stock Position:  -0.0034849040344138225
Bond Position:  [-4.96388932]


portfolio before change:  [-5.32147724]
curr_Stock_Price:  102.25440655948172
curr_Factors:  [102.25440656  -0.5904379   -1.00654565]
mat_Sqrt:  [[20.70717663  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.91184662e-05  2.64286413e-02 -1.76855455e-01]
Stock Position:  -9.911846618998514e-05
Bond Position:  [-5.31134194]


portfolio before change:  [-5.32312515]
curr_Stock_Price:  105.48195600992707
curr_Factors:  [105.48195601  -0.45393444  -0.99731379]
mat_Sqrt:  [[24.71206713  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00150248 -0.04613577 -0.96658156]
Stock Position:  -0.0015024816410780515
Bond Position:  [-5.16464045]


portfolio before change:  [-5.32309947]
curr_Stock_Price:  104.60540276012125
curr_Factors:  [104.60540276  -0.56894057  -0.99516121]
mat_Sqrt:  [[21.8913904   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00671824 -0.13814509  4.71489293]
Stock Position:  -0.006718238578293408
Bond Position:  [-4.62033541]


portfolio before change:  [-5.33162042]
curr_Stock_Price:  105.70178027529214
curr_Factors:  [105.70178028  -1.0171795   -0.97194688]
mat_Sqrt:  [[14.46157833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00612402 -0.04451411 -0.15745711]
Stock Position:  -0.006124017402593671
Bond Position:  [-4.68430088]


portfolio before change:  [-5.32774098]
curr_Stock_Price:  104.87705082397164
curr_Factors:  [104.87705082  -1.14460601  -0.93040887]
mat_Sqrt:  [[13.16779184  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06249593  0.37325379 -0.49705043]
Stock Position:  -0.06249593199950391
Bond Position:  [1.22664805]


portfolio before change:  [-5.28778084]
curr_Stock_Price:  104.24255448280694
curr_Factors:  [104.24255448  -1.08724164  -0.94452335]
mat_Sqrt:  [[13.6666076   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.43458996e-05 -8.79795921e-03  2.84967555e-02]
Stock Position:  -8.434589958544863e-05
Bond Position:  [-5.27898841]


portfolio before change:  [-5.28903868]
curr_Stock_Price:  103.5065306642298
curr_Factors:  [103.50653066  -0.83594579  -0.91593892]
mat_Sqrt:  [[17.95287013  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223082 -0.03842184  0.50228214]
Stock Position:  -0.002230823766180744
Bond Position:  [-5.05813385]


portfolio before change:  [-5.29121407]
curr_Stock_Price:  103.91476883635187
curr_Factors:  [103.91476884  -0.51781316  -0.91087707]
mat_Sqrt:  [[24.90032383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.87375449e-03 -3.51741667e-05  6.08071385e-02]
Stock Position:  0.0018737544864382443
Bond Position:  [-5.48592484]


portfolio before change:  [-5.29762081]
curr_Stock_Price:  101.22760864779151
curr_Factors:  [101.22760865  -0.69186305  -0.9115375 ]
mat_Sqrt:  [[20.36812096  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00951536  0.06794069 -0.28297184]
Stock Position:  -0.009515364494588386
Bond Position:  [-4.33440321]


portfolio before change:  [-5.31366005]
curr_Stock_Price:  102.79933052311978
curr_Factors:  [102.79933052  -0.55625471  -0.93482156]
mat_Sqrt:  [[23.14323635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00174191  0.01645049 -0.1575444 ]
Stock Position:  0.0017419074344338602
Bond Position:  [-5.49272697]


portfolio before change:  [-5.31259741]
curr_Stock_Price:  104.19779460209682
curr_Factors:  [104.1977946   -0.44226832  -0.89747738]
mat_Sqrt:  [[27.2906802   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072503 -0.01982829 -0.05144527]
Stock Position:  -0.0007250313634297988
Bond Position:  [-5.23705074]


portfolio before change:  [-5.31308303]
curr_Stock_Price:  103.06156122837326
curr_Factors:  [103.06156123  -0.29638714  -0.90605932]
mat_Sqrt:  [[30.96569657  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00336976  0.02983239 -0.05490114]
Stock Position:  0.003369764321191476
Bond Position:  [-5.6603762]


portfolio before change:  [-5.31855735]
curr_Stock_Price:  101.85701065151603
curr_Factors:  [101.85701065  -0.52884489  -0.87436918]
mat_Sqrt:  [[25.03702934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00197791  0.20102569 -1.24145994]
Stock Position:  0.0019779133323323548
Bond Position:  [-5.52002169]


portfolio before change:  [-5.31985602]
curr_Stock_Price:  101.89822211115471
curr_Factors:  [101.89822211  -0.6786849   -0.86142987]
mat_Sqrt:  [[21.84254606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00062071 -0.05077263 -0.1484924 ]
Stock Position:  -0.0006207108859179468
Bond Position:  [-5.25660668]


portfolio before change:  [-5.32057921]
curr_Stock_Price:  100.94589788921287
curr_Factors:  [100.94589789  -0.63079883  -0.88388867]
mat_Sqrt:  [[22.19566961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00512718 0.02025564 0.4999366 ]
Stock Position:  0.005127182314375892
Bond Position:  [-5.83814724]


portfolio before change:  [-5.32092998]
curr_Stock_Price:  101.16218738285689
curr_Factors:  [101.16218738  -0.4685158   -0.88309285]
mat_Sqrt:  [[26.18315849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262725  0.00525786  0.16709793]
Stock Position:  -0.0026272543080726736
Bond Position:  [-5.05515119]


portfolio before change:  [-5.32036792]
curr_Stock_Price:  100.46716317712348
curr_Factors:  [100.46716318  -0.82419597  -0.91348357]
mat_Sqrt:  [[17.67500333  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00048215 -0.03445504 -0.116349  ]
Stock Position:  0.000482145685135047
Bond Position:  [-5.36880773]


portfolio before change:  [-5.32068744]
curr_Stock_Price:  102.58860759153985
curr_Factors:  [102.58860759  -0.87270108  -0.93507554]
mat_Sqrt:  [[16.82641997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00782139  0.01574705 -0.03954388]
Stock Position:  -0.007821390441732634
Bond Position:  [-4.51830189]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.30865838]
Stock Price:  100.90619792414425
PL:  [-6.2148563]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.60493365e-02  4.70114683e-02  3.50217131e-02]
 [ 2.92617590e-02  7.54209826e-02 -1.70707192e-01]
 [-7.26570186e-02  3.08067741e-02 -7.86443881e-03]
 [-2.20435170e-01 -2.10644289e-01  7.62909409e-01]
 [-4.12266020e-02  2.12028536e-02 -2.36664523e-02]
 [-1.18672504e+00  1.21071036e+00 -1.73127823e-01]
 [ 2.99114768e-03  1.06962861e-02  6.70229347e-03]
 [-2.58887366e-02  4.16083032e-04 -1.10260906e-02]
 [ 5.91374477e-02  2.76157893e-02  5.08442144e-02]
 [-2.41381754e-01  2.15447751e-01 -1.13068726e-01]
 [ 3.42814640e-02  2.74795419e-02 -5.40684762e-02]
 [ 1.15115663e-01 -3.47543528e-02 -3.35834322e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-6.47694939e-03  1.30990655e-01 -1.33826109e-01]
 [-4.99722398e-02 -2.61613586e-01 -4.85281740e-02]
 [ 4.57447360e-02  3.69073811e-02 -4.26502252e-02]
 [ 1.01674521e-01  2.43754771e-02  1.31160991e-01]
 [-4.17378261e-02  7.84942863e-03  4.54362302e-02]
 [ 2.52646751e-02 -7.39023985e-02 -1.84147723e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.55494387]
curr_Stock_Price:  99.78130002818814
curr_Factors:  [99.78130003 -1.10045988 -0.96982838]
mat_Sqrt:  [[12.58735232  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00232808  0.01517289  0.0999072 ]
Stock Position:  -0.002328081609369232
Bond Position:  [0.78724288]


portfolio before change:  [0.55613927]
curr_Stock_Price:  99.35237609976929
curr_Factors:  [99.3523761  -0.81645558 -0.97146276]
mat_Sqrt:  [[16.62245588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00059026  0.02434202 -0.4869801 ]
Stock Position:  0.000590258321258726
Bond Position:  [0.49749571]


portfolio before change:  [0.55656347]
curr_Stock_Price:  99.86029241011188
curr_Factors:  [99.86029241 -1.07283882 -0.95803318]
mat_Sqrt:  [[13.10377204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00518736  0.00994284 -0.02243505]
Stock Position:  -0.005187356272561911
Bond Position:  [1.07457438]


portfolio before change:  [0.55243337]
curr_Stock_Price:  100.70827202614207
curr_Factors:  [100.70827203  -0.98821569  -0.95415295]
mat_Sqrt:  [[14.43793762  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00745983 -0.06798515  2.17636819]
Stock Position:  -0.0074598274844758896
Bond Position:  [1.30369971]


portfolio before change:  [0.55196714]
curr_Stock_Price:  100.81446674192202
curr_Factors:  [100.81446674  -0.73646865  -0.96627699]
mat_Sqrt:  [[18.36664454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227203  0.00684319 -0.0675138 ]
Stock Position:  -0.002272025351202022
Bond Position:  [0.78102017]


portfolio before change:  [0.55328821]
curr_Stock_Price:  100.31896568131053
curr_Factors:  [100.31896568  -0.76337707  -0.97705068]
mat_Sqrt:  [[17.60049486  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05539216  0.39075509 -0.49388549]
Stock Position:  -0.05539215818907222
Bond Position:  [6.11017223]


portfolio before change:  [0.6185376]
curr_Stock_Price:  99.16859253132168
curr_Factors:  [99.16859253 -0.70961454 -0.97555085]
mat_Sqrt:  [[18.38722202  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00035582 0.00345221 0.01911978]
Stock Position:  0.0003558241617607845
Bond Position:  [0.58325102]


portfolio before change:  [0.6186854]
curr_Stock_Price:  99.174129506829
curr_Factors:  [99.17412951 -0.45670286 -0.96653943]
mat_Sqrt:  [[23.89417949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00117411  0.00013429 -0.03145437]
Stock Position:  -0.0011741141959762985
Bond Position:  [0.73512715]


portfolio before change:  [0.61920591]
curr_Stock_Price:  98.88735368405284
curr_Factors:  [98.88735368 -0.50745268 -0.98361657]
mat_Sqrt:  [[22.26268849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00337574 0.00891296 0.14504439]
Stock Position:  0.003375739141164124
Bond Position:  [0.285388]


portfolio before change:  [0.62699758]
curr_Stock_Price:  101.1743516891494
curr_Factors:  [101.17435169  -0.87432056  -0.97429335]
mat_Sqrt:  [[15.93043401  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01384041  0.06953546 -0.3225536 ]
Stock Position:  -0.013840409060546186
Bond Position:  [2.02729199]


portfolio before change:  [0.64996334]
curr_Stock_Price:  99.55164822723367
curr_Factors:  [99.55164823 -0.46640281 -0.9819006 ]
mat_Sqrt:  [[23.39151113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00123353  0.00886898 -0.15424231]
Stock Position:  0.001233525289716306
Bond Position:  [0.52716387]


portfolio before change:  [0.64844936]
curr_Stock_Price:  98.21743303397811
curr_Factors:  [98.21743303 -0.40748971 -1.01097966]
mat_Sqrt:  [[23.77689612  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00425481 -0.01121692 -0.09580418]
Stock Position:  0.004254814012640453
Bond Position:  [0.23055245]


portfolio before change:  [0.64550576]
curr_Stock_Price:  97.51205630398253
curr_Factors:  [97.5120563  -0.24786463 -0.9891734 ]
mat_Sqrt:  [[28.30215631  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00059575 -0.00995959  0.34984664]
Stock Position:  0.0005957540205045068
Bond Position:  [0.58741256]


portfolio before change:  [0.64532904]
curr_Stock_Price:  96.96889634542019
curr_Factors:  [96.96889635 -0.54416468 -0.97054743]
mat_Sqrt:  [[21.32069436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.30933592e-04  4.22770521e-02 -3.81768638e-01]
Stock Position:  -0.00033093359195358993
Bond Position:  [0.67741931]


portfolio before change:  [0.64603001]
curr_Stock_Price:  95.36255620875033
curr_Factors:  [95.36255621 -0.57018886 -0.96800434]
mat_Sqrt:  [[20.48090143  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00553099 -0.08443542 -0.13843737]
Stock Position:  -0.005530990026149779
Bond Position:  [1.17347936]


portfolio before change:  [0.64908351]
curr_Stock_Price:  94.86353200299146
curr_Factors:  [94.863532   -0.56088506 -0.95392523]
mat_Sqrt:  [[20.85573705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00213718  0.01191181 -0.12166922]
Stock Position:  0.0021371809015017598
Bond Position:  [0.44634298]


portfolio before change:  [0.65217051]
curr_Stock_Price:  96.25573897106632
curr_Factors:  [96.25573897 -0.9978861  -0.99772434]
mat_Sqrt:  [[13.08410519  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01019736 0.00786715 0.3741658 ]
Stock Position:  0.01019735528322888
Bond Position:  [-0.32938346]


portfolio before change:  [0.65697227]
curr_Stock_Price:  96.73469790242324
curr_Factors:  [96.7346979  -0.73345071 -1.04171979]
mat_Sqrt:  [[16.39213506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188267  0.00253339  0.12961692]
Stock Position:  -0.001882667292416889
Bond Position:  [0.83909152]


portfolio before change:  [0.65556447]
curr_Stock_Price:  97.59390521213142
curr_Factors:  [97.59390521 -0.82977194 -1.04282792]
mat_Sqrt:  [[15.00247494  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.001827  -0.0238519 -0.5253222]
Stock Position:  -0.0018270042418574418
Bond Position:  [0.83386895]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.65509683]
Stock Price:  97.96398095078112
PL:  [0.65509683]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.46778876e-02 -1.13889550e-03  4.35094058e-02]
 [ 3.43739447e-02  1.09576638e-01 -1.84808923e-01]
 [-8.10577202e-02  2.31884129e-02 -2.13541784e-02]
 [-2.30565711e-01 -2.19231266e-01  8.30862639e-01]
 [-3.33222943e-03 -3.47400236e-02  1.40125994e-02]
 [-1.36266951e+00  1.47074383e+00 -2.21234038e-01]
 [ 1.01228099e-02 -4.88991074e-03  2.80554829e-02]
 [-6.54775817e-02 -8.59599383e-02  1.10441293e-01]
 [ 4.04010668e-02  1.98577684e-02  5.35597401e-02]
 [-4.92563442e-01  2.75764112e-01 -2.41530854e-01]
 [ 8.57681353e-02  5.91911809e-02 -5.87915525e-02]
 [-9.03652471e-02 -5.45284520e-02 -1.59501890e-02]
 [ 2.13900231e-01  1.62482464e-01 -4.31376023e-02]
 [ 1.84060006e-02  8.49986513e-01 -5.38471794e-01]
 [ 1.13676335e-01 -5.98108584e-02 -3.61296620e-02]
 [ 4.10910151e-02  3.64224880e-02 -2.72690161e-02]
 [-8.56146880e-02  1.59351407e-02  5.63398978e-02]
 [ 3.83873635e-02 -1.15927191e-01 -4.20820121e-02]
 [-4.10715313e-02 -3.61754105e-02 -8.65259952e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.42424125]
curr_Stock_Price:  100.39513171132086
curr_Factors:  [100.39513171  -0.90255916  -0.99077154]
mat_Sqrt:  [[15.11644186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039884 -0.00036758  0.12412022]
Stock Position:  -0.00039884011385356825
Bond Position:  [5.46428286]


portfolio before change:  [5.42577877]
curr_Stock_Price:  99.96569495077158
curr_Factors:  [99.96569495 -0.99521996 -1.03434891]
mat_Sqrt:  [[13.13470814  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144786  0.03536571 -0.52720842]
Stock Position:  0.00144786002427584
Bond Position:  [5.28104244]


portfolio before change:  [5.42902834]
curr_Stock_Price:  101.29810485752235
curr_Factors:  [101.29810486  -0.84040517  -1.07679466]
mat_Sqrt:  [[14.89265102  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00541766  0.00748403 -0.06091753]
Stock Position:  -0.005417659256423358
Bond Position:  [5.97782696]


portfolio before change:  [5.43131314]
curr_Stock_Price:  101.15225642600907
curr_Factors:  [101.15225643  -0.97647808  -1.1167391 ]
mat_Sqrt:  [[12.47104661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00847699 -0.07075659  2.37021984]
Stock Position:  -0.008476993398422308
Bond Position:  [6.28878015]


portfolio before change:  [5.42467804]
curr_Stock_Price:  102.12046444604057
curr_Factors:  [102.12046445  -0.66770617  -1.11366002]
mat_Sqrt:  [[17.19789436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043977 -0.01121229  0.03997405]
Stock Position:  -0.0004397746046035312
Bond Position:  [5.46958803]


portfolio before change:  [5.42592001]
curr_Stock_Price:  102.40606836602848
curr_Factors:  [102.40606837  -0.57915972  -1.08267308]
mat_Sqrt:  [[19.43573087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05698856  0.47468053 -0.63111913]
Stock Position:  -0.05698856414526596
Bond Position:  [11.2618948]


portfolio before change:  [5.42518724]
curr_Stock_Price:  102.46833689906657
curr_Factors:  [102.4683369   -0.73366802  -1.04258888]
mat_Sqrt:  [[17.34487273  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00085625 -0.00157821  0.08003448]
Stock Position:  0.0008562451108752838
Bond Position:  [5.33744922]


portfolio before change:  [5.42648978]
curr_Stock_Price:  102.43097609551226
curr_Factors:  [102.4309761   -0.6074463   -1.01993702]
mat_Sqrt:  [[20.12184111  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300571 -0.02774345  0.31505827]
Stock Position:  -0.0030057063766859575
Bond Position:  [5.73436721]


portfolio before change:  [5.42636501]
curr_Stock_Price:  102.94950137672278
curr_Factors:  [102.94950138  -0.31415185  -0.98035279]
mat_Sqrt:  [[28.21162     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00196328 0.00640907 0.15279103]
Stock Position:  0.0019632815471457917
Bond Position:  [5.22424616]


portfolio before change:  [5.42710879]
curr_Stock_Price:  102.66302036971734
curr_Factors:  [102.66302037  -0.12686482  -0.98509104]
mat_Sqrt:  [[33.76740938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01438001  0.08900248 -0.6890203 ]
Stock Position:  -0.014380007722986336
Bond Position:  [6.90340382]


portfolio before change:  [5.39833917]
curr_Stock_Price:  104.7837212169993
curr_Factors:  [104.78372122  -0.30321265  -1.02164161]
mat_Sqrt:  [[27.85588265  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00308192  0.01910387 -0.16771593]
Stock Position:  0.0030819238503024637
Bond Position:  [5.07540372]


portfolio before change:  [5.400572]
curr_Stock_Price:  105.09645616155272
curr_Factors:  [105.09645616  -0.35999771  -0.99867037]
mat_Sqrt:  [[27.01008932  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00387824 -0.01759898 -0.04550145]
Stock Position:  -0.003878241132903262
Bond Position:  [5.8081614]


portfolio before change:  [5.39626734]
curr_Stock_Price:  106.58086133703523
curr_Factors:  [106.58086134  -0.52320615  -1.04921256]
mat_Sqrt:  [[22.12006796  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01077128  0.05244099 -0.12305957]
Stock Position:  0.010771277868879093
Bond Position:  [4.24825527]


portfolio before change:  [5.38685104]
curr_Stock_Price:  105.60804257787242
curr_Factors:  [105.60804258  -0.50948755  -1.0713687 ]
mat_Sqrt:  [[21.7340092   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0037726   0.27433197 -1.53611015]
Stock Position:  0.003772597845766465
Bond Position:  [4.98843436]


portfolio before change:  [5.38298063]
curr_Stock_Price:  104.2515043447123
curr_Factors:  [104.25150434  -0.30217045  -1.10547219]
mat_Sqrt:  [[25.51237556  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00368811 -0.01930387 -0.10306787]
Stock Position:  0.003688114337223666
Bond Position:  [4.99848916]


portfolio before change:  [5.38056165]
curr_Stock_Price:  103.25675377928121
curr_Factors:  [103.25675378  -0.21568941  -1.12457789]
mat_Sqrt:  [[27.03010753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00158932  0.01175531 -0.07779091]
Stock Position:  0.0015893188606872731
Bond Position:  [5.21645375]


portfolio before change:  [5.38186967]
curr_Stock_Price:  103.25910483699383
curr_Factors:  [103.25910484   0.21154896  -1.09077611]
mat_Sqrt:  [[42.86322628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016532   0.00514304  0.16072205]
Stock Position:  -0.0016532028429317388
Bond Position:  [5.55257791]


portfolio before change:  [5.38550131]
curr_Stock_Price:  101.90214835234222
curr_Factors:  [ 1.01902148e+02  8.24026059e-02 -1.12380224e+00]
mat_Sqrt:  [[35.96741504  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00017054 -0.03741534 -0.12004827]
Stock Position:  0.0001705396370190158
Bond Position:  [5.36812295]


portfolio before change:  [5.38675787]
curr_Stock_Price:  101.39999338284619
curr_Factors:  [101.39999338  -0.25906843  -1.11832072]
mat_Sqrt:  [[25.57675335  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258508 -0.01167556 -0.24683458]
Stock Position:  -0.002585075983849145
Bond Position:  [5.64888456]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.38499772]
Stock Price:  102.62724678571978
PL:  [2.75775094]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-2.66074346e-02  2.59052851e-02  3.25165871e-02]
 [ 2.61779594e-02  6.47068958e-02 -1.47571854e-01]
 [ 1.05457776e-01 -3.26208111e-02  1.00723598e-03]
 [-2.24225029e-01 -2.18242390e-01  6.51046553e-01]
 [-3.19709405e-02  7.53886333e-03 -1.44633826e-02]
 [-1.06003793e+00  1.06284483e+00 -1.43744378e-01]
 [-3.64547413e-03  1.83043508e-02 -7.96755719e-03]
 [-8.92787159e-02 -2.99194526e-02 -5.52237712e-04]
 [ 1.06786898e-01  2.69373374e-02  5.35535804e-02]
 [ 1.55261128e-01  1.25508081e-01  9.58171650e-02]
 [ 5.92647525e-03  3.36973627e-02 -5.21129485e-02]
 [ 5.75117025e-02  3.97653091e-02 -2.08033300e-02]
 [-5.00995028e-02 -5.52845055e-02  9.93895524e-02]
 [ 2.80653950e-02  2.54656880e-01 -1.53004821e-01]
 [-5.76905034e-02 -2.80347538e-01 -5.92956253e-02]
 [ 4.14407737e-02  2.07803086e-02 -3.55144873e-02]
 [-8.80488695e-02  1.69562960e-02  5.60314874e-02]
 [ 1.26698947e-02 -8.21462700e-02 -1.04378267e-03]
 [ 3.91832499e-03 -6.12517580e-02 -1.19836307e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.69034812]
curr_Stock_Price:  100.17655427432794
curr_Factors:  [100.17655427  -0.64048073  -0.97345384]
mat_Sqrt:  [[19.94542131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00073611  0.00836089  0.09276077]
Stock Position:  -0.000736114800661927
Bond Position:  [3.76408956]


portfolio before change:  [3.69195969]
curr_Stock_Price:  99.26577561781455
curr_Factors:  [99.26577562 -0.82226659 -0.98039057]
mat_Sqrt:  [[16.36498     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00056604  0.02088406 -0.42098142]
Stock Position:  0.0005660392252789113
Bond Position:  [3.63577137]


portfolio before change:  [3.69225486]
curr_Stock_Price:  98.18124252134103
curr_Factors:  [98.18124252 -0.78583906 -0.99042213]
mat_Sqrt:  [[16.61912257  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00595727 -0.01052832  0.00287336]
Stock Position:  0.005957274931789129
Bond Position:  [3.10736221]


portfolio before change:  [3.69992234]
curr_Stock_Price:  99.33790280933923
curr_Factors:  [99.33790281 -0.78486674 -0.97479568]
mat_Sqrt:  [[17.09634636  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00794785 -0.07043743  1.8572546 ]
Stock Position:  -0.007947853116602739
Bond Position:  [4.4894454]


portfolio before change:  [3.68685163]
curr_Stock_Price:  101.12369475270732
curr_Factors:  [101.12369475  -0.75695099  -0.98814722]
mat_Sqrt:  [[17.65901222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0018905   0.00243316 -0.04126   ]
Stock Position:  -0.0018905022335616957
Bond Position:  [3.8780262]


portfolio before change:  [3.69049699]
curr_Stock_Price:  99.70833985327752
curr_Factors:  [99.70833985 -1.1408669  -1.02368504]
mat_Sqrt:  [[11.44665313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07621681  0.3430317  -0.4100627 ]
Stock Position:  -0.07621680592271454
Bond Position:  [11.28994818]


portfolio before change:  [3.66259266]
curr_Stock_Price:  100.1114947223477
curr_Factors:  [100.11149472  -0.98745358  -1.05512297]
mat_Sqrt:  [[12.98387188  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00011826  0.0059077  -0.02272922]
Stock Position:  -0.00011826094602730502
Bond Position:  [3.67443194]


portfolio before change:  [3.66342052]
curr_Stock_Price:  100.87979638060315
curr_Factors:  [100.87979638  -0.67986155  -1.0672035 ]
mat_Sqrt:  [[17.58180601  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00543168 -0.00965646 -0.00157538]
Stock Position:  -0.005431678841472274
Bond Position:  [4.21136717]


portfolio before change:  [3.66839034]
curr_Stock_Price:  100.15868478473341
curr_Factors:  [100.15868478  -0.62783565  -1.03690963]
mat_Sqrt:  [[18.9539148   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00650088 0.00869399 0.15277346]
Stock Position:  0.006500875376241818
Bond Position:  [3.01727121]


portfolio before change:  [3.66113041]
curr_Stock_Price:  98.92587456286024
curr_Factors:  [98.92587456 -0.97038013 -1.00472511]
mat_Sqrt:  [[13.72563972  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01460325 0.04050756 0.2733397 ]
Stock Position:  0.014603250475616456
Bond Position:  [2.21649108]


portfolio before change:  [3.66678305]
curr_Stock_Price:  99.27500587020499
curr_Factors:  [99.27500587 -0.64575305 -0.97872921]
mat_Sqrt:  [[19.55853132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.10816579e-04  1.08757770e-02 -1.48663737e-01]
Stock Position:  0.00011081657898874013
Bond Position:  [3.65578173]


portfolio before change:  [3.66770201]
curr_Stock_Price:  99.31919115676386
curr_Factors:  [99.31919116 -0.58359425 -0.99934817]
mat_Sqrt:  [[20.39717472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00300935  0.0128342  -0.05934611]
Stock Position:  0.0030093530636557133
Bond Position:  [3.36881549]


portfolio before change:  [3.66638293]
curr_Stock_Price:  98.60096846410049
curr_Factors:  [98.60096846 -0.50493072 -1.04522077]
mat_Sqrt:  [[20.92468568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00196402 -0.017843    0.28353073]
Stock Position:  -0.0019640246177480337
Bond Position:  [3.86003766]


portfolio before change:  [3.66838022]
curr_Stock_Price:  98.07543345885364
curr_Factors:  [98.07543346 -0.50425494 -1.04460579]
mat_Sqrt:  [[20.84004092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00234237  0.08219015 -0.43648017]
Stock Position:  0.002342367501182262
Bond Position:  [3.43865151]


portfolio before change:  [3.66608438]
curr_Stock_Price:  96.72824456100557
curr_Factors:  [96.72824456 -0.5038459  -1.01338803]
mat_Sqrt:  [[21.21421594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00598749 -0.09048178 -0.16915391]
Stock Position:  -0.005987488495779243
Bond Position:  [4.24524363]


portfolio before change:  [3.65916247]
curr_Stock_Price:  98.06158390825163
curr_Factors:  [98.06158391 -0.46680769 -0.99766148]
mat_Sqrt:  [[22.67190571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00169519  0.00670682 -0.10131295]
Stock Position:  0.0016951893048555173
Bond Position:  [3.49292952]


portfolio before change:  [3.66313731]
curr_Stock_Price:  99.89117041534736
curr_Factors:  [99.89117042 -0.88023666 -1.03651179]
mat_Sqrt:  [[14.69243666  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00497877  0.00547262  0.15984224]
Stock Position:  -0.0049787725713957825
Bond Position:  [4.16047273]


portfolio before change:  [3.67080143]
curr_Stock_Price:  98.56074735207176
curr_Factors:  [98.56074735 -0.94206846 -1.10506993]
mat_Sqrt:  [[12.72456901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033881 -0.02651259 -0.00297762]
Stock Position:  -0.000338809408754759
Bond Position:  [3.70419474]


portfolio before change:  [3.67174049]
curr_Stock_Price:  98.52267316604585
curr_Factors:  [98.52267317 -0.59240432 -1.12112028]
mat_Sqrt:  [[17.75668566  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00186105 -0.01976892 -0.34185963]
Stock Position:  -0.0018610523507009058
Bond Position:  [3.85509635]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.67143422]
Stock Price:  99.2051742015408
PL:  [3.67143422]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.73750486e-02  5.35517348e-02  3.38526572e-02]
 [-5.14677096e-03 -4.41583543e-02  9.00642313e-02]
 [ 8.42601682e-02 -5.14514655e-02 -2.92496453e-02]
 [-1.73865415e-01 -1.53239341e-01  5.10430023e-01]
 [-3.12810796e-02  6.52043235e-03 -1.37774416e-02]
 [-1.22665749e+00  1.26828550e+00 -1.84282951e-01]
 [ 4.23341540e-03  3.71651148e-03  1.54955144e-02]
 [-8.76170494e-02 -2.71365830e-02 -7.14356137e-03]
 [-6.61946573e-02  1.55579528e-02  5.29742644e-02]
 [-1.10059749e+00  4.10260824e-01 -5.65579741e-01]
 [ 1.48631814e-01  5.08242073e-02 -5.59913400e-02]
 [ 8.88314141e-03  1.02673899e-01 -1.00145235e-02]
 [-6.62416380e-02 -1.01664139e-01 -8.40255249e-02]
 [ 3.18681368e-02  6.99702755e-01 -4.19778551e-01]
 [ 8.29338661e-02 -7.94059154e-02 -4.45719808e-02]
 [ 3.82424232e-02 -1.82401552e-02  5.74597301e-02]
 [-8.33973048e-02  1.62635441e-02  5.89712113e-02]
 [ 4.96755208e-02 -1.86236944e-01 -3.37089528e-02]
 [-1.13313070e-01  1.24115762e-01 -9.72595250e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.3706493]
curr_Stock_Price:  99.75806754978666
curr_Factors:  [99.75806755 -1.0789631  -1.00799095]
mat_Sqrt:  [[12.37643026  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00238629  0.01728375  0.09657221]
Stock Position:  -0.002386285962452182
Bond Position:  [0.60870057]


portfolio before change:  [0.37402535]
curr_Stock_Price:  98.40707392130136
curr_Factors:  [98.40707392 -0.92516373 -1.01869801]
mat_Sqrt:  [[14.08697977  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00029983 -0.01425205  0.25692818]
Stock Position:  0.00029983197335623407
Bond Position:  [0.34451976]


portfolio before change:  [0.37428884]
curr_Stock_Price:  98.99855873410084
curr_Factors:  [98.99855873 -0.73943102 -0.97962322]
mat_Sqrt:  [[17.74406415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00382027 -0.01660589 -0.0834411 ]
Stock Position:  0.0038202703907296736
Bond Position:  [-0.00391243]


portfolio before change:  [0.37616793]
curr_Stock_Price:  99.49068831295973
curr_Factors:  [99.49068831 -1.07243124 -0.97286667]
mat_Sqrt:  [[12.86829004  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00784519 -0.04945778  1.45611478]
Stock Position:  -0.007845189414220476
Bond Position:  [1.15669122]


portfolio before change:  [0.36873005]
curr_Stock_Price:  100.47563422433821
curr_Factors:  [100.47563422  -0.9858556   -0.98823487]
mat_Sqrt:  [[13.95481743  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00234775  0.00210446 -0.03930321]
Stock Position:  -0.002347749123208401
Bond Position:  [0.60462163]


portfolio before change:  [0.3683553]
curr_Stock_Price:  100.69964611486706
curr_Factors:  [100.69964611  -0.76962866  -1.01977395]
mat_Sqrt:  [[16.82287677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05976305  0.40933739 -0.52570797]
Stock Position:  -0.05976304805555722
Bond Position:  [6.38647309]


portfolio before change:  [0.36654974]
curr_Stock_Price:  100.75657727124188
curr_Factors:  [100.75657727  -0.63625094  -1.02723277]
mat_Sqrt:  [[19.09112902  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00042716 0.0011995  0.04420439]
Stock Position:  0.0004271645620761147
Bond Position:  [0.3235101]


portfolio before change:  [0.36728889]
curr_Stock_Price:  102.29758573390716
curr_Factors:  [102.29758573  -1.19589725  -1.01581232]
mat_Sqrt:  [[11.20294289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0084455  -0.00875829 -0.02037859]
Stock Position:  -0.0084455000316148
Bond Position:  [1.23124315]


portfolio before change:  [0.35984711]
curr_Stock_Price:  103.21519027715493
curr_Factors:  [103.21519028  -0.95626962  -1.05326507]
mat_Sqrt:  [[13.83610304  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00377314  0.00502131  0.15112083]
Stock Position:  -0.0037731416771608554
Bond Position:  [0.74929265]


portfolio before change:  [0.35054505]
curr_Stock_Price:  105.73017737936686
curr_Factors:  [105.73017738  -1.04587443  -1.05024428]
mat_Sqrt:  [[12.9976899   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08711562  0.13241111 -1.61344157]
Stock Position:  -0.08711562119876497
Bond Position:  [9.56129513]


portfolio before change:  [0.445598]
curr_Stock_Price:  104.66650676011993
curr_Factors:  [104.66650676  -1.18946266  -1.02909881]
mat_Sqrt:  [[11.38410065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01296344  0.01640344 -0.15972771]
Stock Position:  0.012963437560690275
Bond Position:  [-0.91123972]


portfolio before change:  [0.42783513]
curr_Stock_Price:  103.31385390285112
curr_Factors:  [103.3138539   -0.73379339  -0.99611465]
mat_Sqrt:  [[18.31762006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00151751  0.03313786 -0.02856865]
Stock Position:  0.0015175092169141596
Bond Position:  [0.27105541]


portfolio before change:  [0.42682992]
curr_Stock_Price:  102.60678685345457
curr_Factors:  [102.60678685  -1.17764511  -0.97862703]
mat_Sqrt:  [[11.87733469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00876841 -0.03281196 -0.23970143]
Stock Position:  -0.008768413511250581
Bond Position:  [1.32652866]


portfolio before change:  [0.43053953]
curr_Stock_Price:  102.22154812214922
curr_Factors:  [102.22154812  -1.4072405   -0.99028279]
mat_Sqrt:  [[ 9.29632548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00957447  0.22582809 -1.19751136]
Stock Position:  0.00957447390123214
Bond Position:  [-0.54817801]


portfolio before change:  [0.43141361]
curr_Stock_Price:  102.32715574362382
curr_Factors:  [102.32715574  -1.27839142  -0.97630066]
mat_Sqrt:  [[10.73471638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00536828 -0.02562815 -0.12715145]
Stock Position:  0.005368281933949762
Bond Position:  [-0.11790741]


portfolio before change:  [0.43552102]
curr_Stock_Price:  103.0977745116992
curr_Factors:  [103.09777451  -1.3813073   -0.99477434]
mat_Sqrt:  [[ 9.57921998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00482796 -0.00588698  0.16391662]
Stock Position:  0.004827959423683414
Bond Position:  [-0.06223085]


portfolio before change:  [0.43270159]
curr_Stock_Price:  102.51701715459798
curr_Factors:  [102.51701715  -1.55694713  -0.95310074]
mat_Sqrt:  [[ 8.33097872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00816712  0.00524904  0.16822845]
Stock Position:  -0.008167116604623414
Bond Position:  [1.26997003]


portfolio before change:  [0.42240085]
curr_Stock_Price:  103.81714236257922
curr_Factors:  [103.81714236  -1.71118503  -0.97413708]
mat_Sqrt:  [[ 7.08024838  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00067501 -0.06010772 -0.09616226]
Stock Position:  0.0006750120088129626
Bond Position:  [0.35232303]


portfolio before change:  [0.42275043]
curr_Stock_Price:  104.20452813200507
curr_Factors:  [104.20452813  -1.52660709  -0.91755333]
mat_Sqrt:  [[ 9.0448467   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00994637  0.04005819 -0.02774544]
Stock Position:  -0.00994636513606092
Bond Position:  [1.45920672]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.41694512]
Stock Price:  104.82487087164904
PL:  [-4.40792575]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.04543081e-01  1.86640106e-01  1.21707720e-03]
 [ 4.14398967e-02  1.81228849e-01 -2.76845189e-01]
 [ 8.34839165e-02 -4.91934085e-02 -3.43857959e-02]
 [-2.01949894e-01 -1.87585791e-01  5.58674646e-01]
 [-1.93586938e-02 -1.10804016e-02 -1.92280049e-03]
 [-1.36999688e+00  1.35498962e+00 -1.95656101e-01]
 [-8.44499826e-03 -2.88358057e-02 -1.38106639e-02]
 [ 9.22212908e-02 -7.51949075e-02 -7.09522058e-03]
 [ 9.20199904e-02  2.67362840e-02  5.04349099e-02]
 [ 1.55364418e-01  1.26607074e-01  9.71471260e-02]
 [ 7.35517716e-02  1.75632259e-02 -5.67412157e-02]
 [ 9.22804702e-02 -5.21348761e-03 -2.85171817e-02]
 [-1.12697730e-02 -1.70364816e-02 -6.20620086e-03]
 [ 7.23556162e-03  4.19929619e-01 -3.42090578e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 4.75038688e-02  3.40486832e-02  1.48416964e-02]
 [-1.08092806e-02  1.81419900e-02  7.97043337e-02]
 [-1.38291146e-02 -2.63320229e-02  1.48664410e-02]
 [ 5.16456077e-02 -9.97992505e-02 -2.22060450e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.50006092]
curr_Stock_Price:  99.14405776182075
curr_Factors:  [99.14405776 -0.62032839 -1.02313343]
mat_Sqrt:  [[19.16550603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00345396  0.06023784  0.00347198]
Stock Position:  -0.0034539601528170423
Bond Position:  [-4.1576213]


portfolio before change:  [-4.50578285]
curr_Stock_Price:  100.49971741744845
curr_Factors:  [100.49971742  -0.58035527  -1.03272895]
mat_Sqrt:  [[20.02678635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00109465  0.05849136 -0.78976226]
Stock Position:  0.0010946485721143795
Bond Position:  [-4.61579473]


portfolio before change:  [-4.50848766]
curr_Stock_Price:  99.08308243878729
curr_Factors:  [99.08308244 -0.60971862 -1.03162769]
mat_Sqrt:  [[19.19428174  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00346058 -0.0158771  -0.0980931 ]
Stock Position:  0.0034605818409233044
Bond Position:  [-4.85137278]


portfolio before change:  [-4.51193367]
curr_Stock_Price:  98.43781324879247
curr_Factors:  [98.43781325 -0.5859822  -1.06446332]
mat_Sqrt:  [[18.89655234  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00667856 -0.06054305  1.59374326]
Stock Position:  -0.006678556816436552
Bond Position:  [-3.85451114]


portfolio before change:  [-4.51678975]
curr_Stock_Price:  99.02062478651473
curr_Factors:  [99.02062479 -0.81793893 -1.06260408]
mat_Sqrt:  [[15.10136511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00145768 -0.00357618 -0.00548521]
Stock Position:  -0.0014576802295764594
Bond Position:  [-4.37244935]


portfolio before change:  [-4.51691581]
curr_Stock_Price:  98.3571074586646
curr_Factors:  [98.35710746 -0.62996945 -1.04824813]
mat_Sqrt:  [[18.36390823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06171611  0.43732102 -0.5581524 ]
Stock Position:  -0.06171610649886783
Bond Position:  [1.55330191]


portfolio before change:  [-4.50954296]
curr_Stock_Price:  98.24393644993555
curr_Factors:  [98.24393645 -0.58140316 -1.05605551]
mat_Sqrt:  [[19.10585564  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00089764 -0.00930672 -0.03939798]
Stock Position:  -0.0008976395892907629
Bond Position:  [-4.42135531]


portfolio before change:  [-4.50840266]
curr_Stock_Price:  95.74206923197838
curr_Factors:  [95.74206923 -0.42954261 -1.03810249]
mat_Sqrt:  [[22.06544249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00341819 -0.02426905 -0.02024069]
Stock Position:  0.003418190629427592
Bond Position:  [-4.83566731]


portfolio before change:  [-4.49697131]
curr_Stock_Price:  99.44005573025865
curr_Factors:  [99.44005573 -0.64973862 -1.07379548]
mat_Sqrt:  [[17.74352945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0060739  0.0086291  0.14387676]
Stock Position:  0.006073903995730317
Bond Position:  [-5.10096066]


portfolio before change:  [-4.50278445]
curr_Stock_Price:  98.69296705274309
curr_Factors:  [98.69296705 -0.51138929 -1.03616032]
mat_Sqrt:  [[20.99877459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0095738  0.04086226 0.27713371]
Stock Position:  0.009573799275336635
Bond Position:  [-5.44765111]


portfolio before change:  [-4.49256884]
curr_Stock_Price:  99.90227688207622
curr_Factors:  [99.90227688 -0.23160381 -1.02976194]
mat_Sqrt:  [[28.29900724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0023165   0.00566851 -0.16186689]
Stock Position:  0.0023164981510683785
Bond Position:  [-4.72399228]


portfolio before change:  [-4.49488533]
curr_Stock_Price:  99.41216560819615
curr_Factors:  [99.41216561 -0.18518527 -1.01541752]
mat_Sqrt:  [[29.92432556  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00285371 -0.00168265 -0.08135158]
Stock Position:  0.0028537059591045746
Bond Position:  [-4.77857842]


portfolio before change:  [-4.48980736]
curr_Stock_Price:  101.61027648998814
curr_Factors:  [101.61027649  -0.38252526  -0.98166451]
mat_Sqrt:  [[25.97033448  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00061663 -0.0054985  -0.01770456]
Stock Position:  -0.0006166330160293062
Bond Position:  [-4.42715111]


portfolio before change:  [-4.4901428]
curr_Stock_Price:  100.35914637541316
curr_Factors:  [100.35914638  -0.10712622  -0.99528666]
mat_Sqrt:  [[33.32614858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.93881246e-04  1.35531702e-01 -9.75889198e-01]
Stock Position:  0.0006938812457316991
Bond Position:  [-4.55978013]


portfolio before change:  [-4.49227321]
curr_Stock_Price:  98.9319214837803
curr_Factors:  [98.93192148 -0.32989549 -1.00787401]
mat_Sqrt:  [[25.96274041  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00512246 -0.09296045 -0.18429859]
Stock Position:  -0.005122459203843507
Bond Position:  [-3.98549848]


portfolio before change:  [-4.49336867]
curr_Stock_Price:  98.95123894744721
curr_Factors:  [98.95123895 -0.44600411 -1.03351197]
mat_Sqrt:  [[22.53593438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00255075 0.01098917 0.04233923]
Stock Position:  0.0025507518246388177
Bond Position:  [-4.74576872]


portfolio before change:  [-4.50009649]
curr_Stock_Price:  96.77884688920213
curr_Factors:  [96.77884689 -0.51261479 -1.01462004]
mat_Sqrt:  [[21.01409955  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00043607 0.0058553  0.22737428]
Stock Position:  0.0004360651559662543
Bond Position:  [-4.54229837]


portfolio before change:  [-4.50075767]
curr_Stock_Price:  97.86707581462969
curr_Factors:  [97.86707581 -0.75675707 -1.00829868]
mat_Sqrt:  [[16.75261623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00096519 -0.00849862  0.04240982]
Stock Position:  -0.0009651935240233647
Bond Position:  [-4.406297]


portfolio before change:  [-4.50083156]
curr_Stock_Price:  96.80219616416872
curr_Factors:  [96.80219616 -0.62282571 -0.98329458]
mat_Sqrt:  [[19.4247765   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072349 -0.03221007 -0.63347665]
Stock Position:  -0.0007234949903242363
Bond Position:  [-4.43079566]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.50448238]
Stock Price:  100.31704654909436
PL:  [-4.82152893]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-8.19889322e-02  1.59197823e-01  1.11010820e-02]
 [ 3.25865725e-02  8.66738483e-02 -1.72069512e-01]
 [ 8.74835583e-02 -4.95341684e-02 -2.37438599e-02]
 [-1.61817023e-01 -1.32731314e-01  4.29366034e-01]
 [ 3.88807674e-02 -9.70584191e-02  5.59857362e-02]
 [-1.24865700e+00  1.18516701e+00 -1.61158597e-01]
 [-6.25363515e-03 -2.10796773e-02 -9.11921955e-03]
 [ 7.03552477e-03  4.79047749e-02 -6.68884062e-02]
 [ 6.10004950e-02  2.55772504e-02  3.90903914e-02]
 [ 1.48243959e-01  1.26818314e-01  9.18024223e-02]
 [ 7.84382906e-02  3.15024332e-02 -5.22830109e-02]
 [-7.40865582e-02  1.31593120e-01  1.01657294e-01]
 [-1.83850678e-01 -1.23149808e-01  2.78398338e-02]
 [ 1.40445899e-02  5.27847148e-01 -3.79180692e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 4.54555603e-02  4.27038759e-02 -1.95310734e-02]
 [-8.47808086e-02  2.22944800e-02  4.89459618e-02]
 [ 4.05627766e-03 -4.10365942e-02 -8.76726731e-03]
 [ 5.24990065e-02 -1.04319316e-01 -2.10822537e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.66571273]
curr_Stock_Price:  99.24923707558021
curr_Factors:  [99.24923708 -0.96776005 -0.95952792]
mat_Sqrt:  [[14.44497019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00326943  0.05138088  0.0316683 ]
Stock Position:  -0.0032694296478539436
Bond Position:  [-3.34122433]


portfolio before change:  [-3.66771634]
curr_Stock_Price:  99.60654850573083
curr_Factors:  [99.60654851 -0.95079368 -0.96096578]
mat_Sqrt:  [[14.72384741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0010293   0.02797386 -0.49086642]
Stock Position:  0.0010292999573607753
Bond Position:  [-3.77024136]


portfolio before change:  [-3.66942534]
curr_Stock_Price:  98.86204200666789
curr_Factors:  [98.86204201 -0.78792669 -0.93746574]
mat_Sqrt:  [[17.60764056  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00411899 -0.01598708 -0.06773462]
Stock Position:  0.004118992727913303
Bond Position:  [-4.07663737]


portfolio before change:  [-3.67429122]
curr_Stock_Price:  97.92817606751517
curr_Factors:  [97.92817607 -0.58391858 -0.93544853]
mat_Sqrt:  [[21.43161579  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00472511 -0.04283885  1.22486178]
Stock Position:  -0.004725108707192804
Bond Position:  [-3.21156994]


portfolio before change:  [-3.67221441]
curr_Stock_Price:  97.31870893508587
curr_Factors:  [97.31870894 -0.66499751 -0.91739283]
mat_Sqrt:  [[19.99737298  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00152504 -0.03132547  0.15971172]
Stock Position:  0.0015250423716307603
Bond Position:  [-3.82062957]


portfolio before change:  [-3.67308151]
curr_Stock_Price:  97.37653134260646
curr_Factors:  [97.37653134 -0.61657719 -0.93545611]
mat_Sqrt:  [[20.62599011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05040399  0.38251101 -0.45974062]
Stock Position:  -0.05040398803701263
Bond Position:  [1.23508402]


portfolio before change:  [-3.71659726]
curr_Stock_Price:  98.24599753300015
curr_Factors:  [98.24599753 -0.63635942 -0.93286816]
mat_Sqrt:  [[20.45540053  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060707 -0.00680344 -0.0260146 ]
Stock Position:  -0.000607074847525953
Bond Position:  [-3.65695459]


portfolio before change:  [-3.71759396]
curr_Stock_Price:  98.38164846287779
curr_Factors:  [98.38164846 -0.86826709 -0.89791922]
mat_Sqrt:  [[16.82167067  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.87883077e-04  1.54611996e-02 -1.90814005e-01]
Stock Position:  0.00018788307662601856
Bond Position:  [-3.73607821]


portfolio before change:  [-3.71872928]
curr_Stock_Price:  97.31088747943491
curr_Factors:  [97.31088748 -0.86150497 -0.86481798]
mat_Sqrt:  [[17.31525555  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00428528 0.00825502 0.11151401]
Stock Position:  0.004285280217572982
Bond Position:  [-4.1357337]


portfolio before change:  [-3.71151683]
curr_Stock_Price:  99.23526861124986
curr_Factors:  [99.23526861 -1.08806556 -0.90369309]
mat_Sqrt:  [[13.54117205  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01424321 0.04093043 0.26188676]
Stock Position:  0.014243207971961302
Bond Position:  [-5.1249454]


portfolio before change:  [-3.70874922]
curr_Stock_Price:  99.51954457557568
curr_Factors:  [99.51954458 -1.03418982 -0.90712762]
mat_Sqrt:  [[14.28252282  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00519491  0.01016737 -0.14914888]
Stock Position:  0.005194913663993898
Bond Position:  [-4.22574466]


portfolio before change:  [-3.70920141]
curr_Stock_Price:  99.63588490211573
curr_Factors:  [99.6358849  -1.31707313 -0.88087947]
mat_Sqrt:  [[11.06259712  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00239316  0.0424715   0.28999996]
Stock Position:  -0.0023931556439347715
Bond Position:  [-3.47075723]


portfolio before change:  [-3.71130638]
curr_Stock_Price:  100.15284525540083
curr_Factors:  [100.15284526  -0.93985826  -0.90864105]
mat_Sqrt:  [[15.77139986  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01289079 -0.03974643  0.0794193 ]
Stock Position:  -0.012890786282814279
Bond Position:  [-2.42025745]


portfolio before change:  [-3.71942104]
curr_Stock_Price:  100.73539481421687
curr_Factors:  [100.73539481  -0.57164828  -0.92663186]
mat_Sqrt:  [[22.51579558  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00197155  0.17036193 -1.08169697]
Stock Position:  0.0019715493987501687
Bond Position:  [-3.91802585]


portfolio before change:  [-3.72279213]
curr_Stock_Price:  99.52240760113729
curr_Factors:  [99.5224076  -0.14306286 -0.94374578]
mat_Sqrt:  [[33.56803162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0039619  -0.09296045 -0.18429859]
Stock Position:  -0.003961896844844194
Bond Position:  [-3.32849462]


portfolio before change:  [-3.72386016]
curr_Stock_Price:  99.58192411440295
curr_Factors:  [99.58192411  0.17415857 -0.98141703]
mat_Sqrt:  [[44.42143856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112976  0.01378262 -0.05571672]
Stock Position:  0.001129762798851797
Bond Position:  [-3.83636411]


portfolio before change:  [-3.72596143]
curr_Stock_Price:  98.57103758065347
curr_Factors:  [ 9.85710376e+01 -4.84566732e-02 -9.97440300e-01]
mat_Sqrt:  [[34.63554646  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202794  0.00719551  0.13962921]
Stock Position:  -0.0020279430079722855
Bond Position:  [-3.52606498]


portfolio before change:  [-3.72738802]
curr_Stock_Price:  98.83976657194685
curr_Factors:  [98.83976657 -0.43530363 -0.99459739]
mat_Sqrt:  [[23.65557927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00025829 -0.0132445  -0.02501057]
Stock Position:  -0.0002582854946697537
Bond Position:  [-3.70185915]


portfolio before change:  [-3.72780262]
curr_Stock_Price:  96.86139531020622
curr_Factors:  [ 9.68613953e+01 -8.19345029e-02 -1.01441930e+00]
mat_Sqrt:  [[32.36013426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.65544063e-04 -3.36689144e-02 -6.01418018e-01]
Stock Position:  -0.0003655440630345541
Bond Position:  [-3.69239551]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.72878941]
Stock Price:  97.03531699003804
PL:  [-3.72878941]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 1.20278266e-02 -5.15513889e-02  5.66060686e-02]
 [ 2.61830549e-02  1.53766516e-01 -2.00717664e-01]
 [-6.17205471e-02 -6.51333037e-02 -7.46761097e-02]
 [-1.52699663e-01 -1.15411591e-01  6.18784163e-01]
 [ 5.18414066e-02 -1.16192011e-01  6.88727314e-02]
 [-1.27508230e+00  1.34372944e+00 -1.98729148e-01]
 [-4.85755612e-03  2.24657236e-02 -1.57308303e-02]
 [-9.31262990e-02 -2.19262354e-02 -1.62116749e-02]
 [ 1.02438580e-01  2.82209962e-02  5.89439446e-02]
 [-2.25725569e-01  2.14100992e-01 -1.02319683e-01]
 [ 6.21651332e-02  1.87641546e-02 -5.59205965e-02]
 [ 3.77415965e-02  6.53410091e-02 -1.64171042e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [ 2.34251395e-02  2.88432722e-01 -1.63104218e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 4.34100046e-02  1.17387304e-02 -1.51657620e-03]
 [ 8.33802152e-02  2.45108247e-02  1.22293353e-01]
 [-3.79828639e-02 -4.49334239e-03  4.56711324e-02]
 [ 6.74051589e-02 -4.99006847e-02 -2.24771701e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.71148992]
curr_Stock_Price:  100.80952771581234
curr_Factors:  [100.80952772  -1.45612391  -1.02360332]
mat_Sqrt:  [[ 8.44441808  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00154654 -0.01663814  0.16148136]
Stock Position:  0.001546537448756879
Bond Position:  [8.55558421]


portfolio before change:  [8.71475463]
curr_Stock_Price:  101.537311937197
curr_Factors:  [101.53731194  -1.29824368  -1.03180935]
mat_Sqrt:  [[ 9.87862476  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00168031  0.04962793 -0.57259163]
Stock Position:  0.0016803140580158506
Bond Position:  [8.54414005]


portfolio before change:  [8.71701207]
curr_Stock_Price:  101.60940393317654
curr_Factors:  [101.60940393  -1.19691218  -1.10017381]
mat_Sqrt:  [[10.21697031  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00883423 -0.02102168 -0.21303016]
Stock Position:  -0.008834225932547322
Bond Position:  [9.6146525]


portfolio before change:  [8.72203747]
curr_Stock_Price:  101.31266657281421
curr_Factors:  [101.31266657  -1.32828962  -1.08649353]
mat_Sqrt:  [[ 9.05600703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00551558 -0.03724893  1.76521898]
Stock Position:  -0.005515583927909574
Bond Position:  [9.28083599]


portfolio before change:  [8.72319799]
curr_Stock_Price:  101.52297615833693
curr_Factors:  [101.52297616  -1.49679644  -1.0404383 ]
mat_Sqrt:  [[ 8.02892307  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00525381 -0.03750081  0.19647473]
Stock Position:  0.0052538053792179715
Bond Position:  [8.18981603]


portfolio before change:  [8.72474087]
curr_Stock_Price:  101.42688647332066
curr_Factors:  [101.42688647  -0.72295471  -1.05722317]
mat_Sqrt:  [[17.1014      0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06089327  0.43368681 -0.56691894]
Stock Position:  -0.0608932657050038
Bond Position:  [14.90095521]


portfolio before change:  [8.80428846]
curr_Stock_Price:  100.18172602610692
curr_Factors:  [100.18172603  -0.83480195  -1.09489775]
mat_Sqrt:  [[14.54556446  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00023944  0.00725078 -0.04487568]
Stock Position:  -0.00023944081254257573
Bond Position:  [8.82827605]


portfolio before change:  [8.80643504]
curr_Stock_Price:  100.43548740106404
curr_Factors:  [100.4354874   -0.85869574  -1.11857933]
mat_Sqrt:  [[13.90488948  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00725724 -0.00707666 -0.0462474 ]
Stock Position:  -0.007257243393374086
Bond Position:  [9.53531982]


portfolio before change:  [8.80830343]
curr_Stock_Price:  100.50655247114142
curr_Factors:  [100.50655247  -0.53390248  -1.07969991]
mat_Sqrt:  [[20.01777312  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00600622 0.00910829 0.16815067]
Stock Position:  0.006006215005513509
Bond Position:  [8.20463947]


portfolio before change:  [8.81334448]
curr_Stock_Price:  101.00430874165987
curr_Factors:  [101.00430874  -0.44389151  -1.03875368]
mat_Sqrt:  [[22.93164865  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0088484   0.0691008  -0.29188958]
Stock Position:  -0.008848395851834733
Bond Position:  [9.70707059]


portfolio before change:  [8.82814986]
curr_Stock_Price:  99.6053760069435
curr_Factors:  [99.60537601 -0.28775594 -1.00557853]
mat_Sqrt:  [[27.32717602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0019973  0.0060561 -0.1595259]
Stock Position:  0.001997301376854669
Bond Position:  [8.62920791]


portfolio before change:  [8.82397708]
curr_Stock_Price:  96.4359237320665
curr_Factors:  [96.43592373 -0.60779785 -0.99292051]
mat_Sqrt:  [[19.45609581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00245312  0.02108872 -0.04683343]
Stock Position:  0.0024531204644130554
Bond Position:  [8.58740814]


portfolio before change:  [8.82615676]
curr_Stock_Price:  96.44919767837008
curr_Factors:  [96.44919768 -0.67134771 -0.97455995]
mat_Sqrt:  [[18.59901768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090656 -0.00995959  0.34984664]
Stock Position:  0.0009065598893236289
Bond Position:  [8.73871979]


portfolio before change:  [8.82952952]
curr_Stock_Price:  97.75943047835447
curr_Factors:  [97.75943048 -0.88200974 -0.94502368]
mat_Sqrt:  [[15.72852977  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00311585  0.09309126 -0.46529093]
Stock Position:  0.003115848327022221
Bond Position:  [8.52492596]


portfolio before change:  [8.83100705]
curr_Stock_Price:  97.54954404384841
curr_Factors:  [97.54954404 -1.09302893 -0.94941683]
mat_Sqrt:  [[12.65325677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01051058 -0.09296045 -0.18429859]
Stock Position:  -0.010510580871440148
Bond Position:  [9.85630942]


portfolio before change:  [8.83506579]
curr_Stock_Price:  97.39785367052374
curr_Factors:  [97.39785367 -1.0048285  -0.96968883]
mat_Sqrt:  [[13.52157887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00336474  0.00378866 -0.00432637]
Stock Position:  0.003364739687342667
Bond Position:  [8.50734736]


portfolio before change:  [8.83350642]
curr_Stock_Price:  96.3022356248839
curr_Factors:  [96.30223562 -0.90313152 -0.98916672]
mat_Sqrt:  [[14.51515521  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00780884 0.00791083 0.3488689 ]
Stock Position:  0.007808837784657916
Bond Position:  [8.08149788]


portfolio before change:  [8.83782758]
curr_Stock_Price:  96.59684166786838
curr_Factors:  [96.59684167 -1.15268866 -1.01993447]
mat_Sqrt:  [[11.00030402  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268879 -0.00145022  0.13028703]
Stock Position:  -0.0026887877533450497
Bond Position:  [9.09755598]


portfolio before change:  [8.84181479]
curr_Stock_Price:  95.95992207747034
curr_Factors:  [95.95992208 -0.9599676  -1.01181935]
mat_Sqrt:  [[13.35837691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00084875 -0.01610538 -0.6412111 ]
Stock Position:  0.0008487477990430448
Bond Position:  [8.76036902]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.84352586]
Stock Price:  95.39520726836625
PL:  [8.84352586]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-2.28345957e-02  1.62308266e-02  3.16544008e-02]
 [ 4.05776289e-02  1.32787363e-01 -2.62526793e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-3.77642274e-01 -4.15311204e-01  1.27649065e+00]
 [ 1.00305666e-02 -5.44673131e-02  2.72994662e-02]
 [-1.64635508e+00  1.80552549e+00 -2.81923327e-01]
 [ 1.15348518e-02 -9.20510544e-03  3.59453711e-02]
 [-7.58104338e-02 -6.62314639e-02  7.21089791e-02]
 [ 8.79988955e-02  2.79215149e-02  5.68572210e-02]
 [ 1.55492685e-01  1.27971815e-01  9.87986860e-02]
 [ 2.65489770e-02 -3.74233892e-03 -4.79803937e-02]
 [-4.75973688e-03  1.20323079e-01 -6.98769379e-03]
 [-5.85226685e-02 -5.99422565e-02  7.10725134e-02]
 [ 9.28908142e-03  5.08149929e-01 -3.81704136e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 4.30136439e-02  2.54854501e-02 -2.41203624e-02]
 [-8.38947532e-02  2.17015191e-02  5.01714192e-02]
 [ 3.78864905e-02 -1.29568710e-01 -4.48333092e-02]
 [-1.28105572e-01  4.75807252e-02 -1.80573011e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.23771428]
curr_Stock_Price:  100.24555615863761
curr_Factors:  [100.24555616  -0.60363815  -1.00640311]
mat_Sqrt:  [[20.03701826  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0006518   0.00523848  0.09030119]
Stock Position:  -0.0006517968112171865
Bond Position:  [4.30305402]


portfolio before change:  [4.23898289]
curr_Stock_Price:  99.94990431379223
curr_Factors:  [99.94990431 -0.79708467 -1.03065209]
mat_Sqrt:  [[16.06964905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0008771   0.04285694 -0.74891587]
Stock Position:  0.0008770993449263126
Bond Position:  [4.15131689]


portfolio before change:  [4.24048498]
curr_Stock_Price:  100.47907257155674
curr_Factors:  [100.47907257  -0.60959968  -1.03275016]
mat_Sqrt:  [[19.44518792  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00401244  0.01370813 -0.02999186]
Stock Position:  -0.0040124445611179555
Bond Position:  [4.64365169]


portfolio before change:  [4.23838851]
curr_Stock_Price:  101.29092776673177
curr_Factors:  [101.29092777  -0.35583375  -1.06881075]
mat_Sqrt:  [[24.36998749  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00828292 -0.13404111  3.64147253]
Stock Position:  -0.008282924057251697
Bond Position:  [5.07737357]


portfolio before change:  [4.2281253]
curr_Stock_Price:  102.68327578770236
curr_Factors:  [102.68327579  -0.4490602   -1.08329108]
mat_Sqrt:  [[22.18237315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00020219 -0.01757925  0.07787778]
Stock Position:  0.00020218544902854012
Bond Position:  [4.20736424]


portfolio before change:  [4.22944235]
curr_Stock_Price:  103.9943520724087
curr_Factors:  [103.99435207  -0.13143759  -1.09273284]
mat_Sqrt:  [[30.57449492  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04367533  0.58273085 -0.80424878]
Stock Position:  -0.04367532775205155
Bond Position:  [8.77142976]


portfolio before change:  [4.33186156]
curr_Stock_Price:  101.69955364809921
curr_Factors:  [101.69955365  -0.32089874  -1.09495047]
mat_Sqrt:  [[24.68445524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00068842 -0.00297094  0.10254214]
Stock Position:  0.000688416476409859
Bond Position:  [4.26184991]


portfolio before change:  [4.33239881]
curr_Stock_Price:  100.93207994856671
curr_Factors:  [100.93207995  -0.30236724  -1.07471376]
mat_Sqrt:  [[25.46657534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00292975 -0.02137611  0.20570685]
Stock Position:  -0.002929749685018504
Bond Position:  [4.62810454]


portfolio before change:  [4.33553926]
curr_Stock_Price:  100.25513727960383
curr_Factors:  [100.25513728  -0.44544402  -1.07267205]
mat_Sqrt:  [[21.96833805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00479346 0.00901163 0.16219783]
Stock Position:  0.004793456939584151
Bond Position:  [3.85497057]


portfolio before change:  [4.32989226]
curr_Stock_Price:  98.87599517627093
curr_Factors:  [98.87599518 -0.39730261 -1.06558115]
mat_Sqrt:  [[22.8964697   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0088128  0.04130273 0.28184515]
Stock Position:  0.008812800504366364
Bond Position:  [3.45851784]


portfolio before change:  [4.32061776]
curr_Stock_Price:  97.72548226780201
curr_Factors:  [97.72548227 -0.28169202 -1.07418061]
mat_Sqrt:  [[25.18603608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00063492 -0.00120783 -0.13687471]
Stock Position:  0.0006349200170305391
Bond Position:  [4.25856989]


portfolio before change:  [4.32281428]
curr_Stock_Price:  99.50799178090996
curr_Factors:  [99.50799178 -0.71895262 -1.07097487]
mat_Sqrt:  [[16.61507578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00110591  0.03883411 -0.01993395]
Stock Position:  0.0011059083980191687
Bond Position:  [4.21276756]


portfolio before change:  [4.32538825]
curr_Stock_Price:  100.88300974268319
curr_Factors:  [100.88300974  -0.40794156  -1.07730608]
mat_Sqrt:  [[22.84457992  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00246232 -0.01934628  0.2027501 ]
Stock Position:  -0.002462322115280081
Bond Position:  [4.57379472]


portfolio before change:  [4.3236146]
curr_Stock_Price:  102.06776414830838
curr_Factors:  [102.06776415  -0.11922317  -1.07136053]
mat_Sqrt:  [[31.03306483  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00113104  0.16400468 -1.08889565]
Stock Position:  0.0011310426854821295
Bond Position:  [4.2081716]


portfolio before change:  [4.32148045]
curr_Stock_Price:  99.25060893431994
curr_Factors:  [99.25060893 -0.24307334 -1.05845924]
mat_Sqrt:  [[27.00752336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0049243  -0.09296045 -0.18429859]
Stock Position:  -0.004924297455958558
Bond Position:  [4.81021997]


portfolio before change:  [4.32695384]
curr_Stock_Price:  98.38334079847212
curr_Factors:  [98.3833408  -0.42210374 -1.02131106]
mat_Sqrt:  [[23.23028208  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186361  0.00822539 -0.06880868]
Stock Position:  0.0018636145302424743
Bond Position:  [4.14360522]


portfolio before change:  [4.32828627]
curr_Stock_Price:  98.54238447313047
curr_Factors:  [98.54238447 -0.21179428 -1.03015926]
mat_Sqrt:  [[28.46095676  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243224  0.00700414  0.14312509]
Stock Position:  -0.0024322355599011958
Bond Position:  [4.56796456]


portfolio before change:  [4.31763272]
curr_Stock_Price:  103.39211307037922
curr_Factors:  [103.39211307  -0.3254468   -1.04200274]
mat_Sqrt:  [[26.33974816  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.68203971e-05 -4.18181214e-02 -1.27896952e-01]
Stock Position:  8.682039707813635e-05
Bond Position:  [4.30865617]


portfolio before change:  [4.31865576]
curr_Stock_Price:  102.76720128406038
curr_Factors:  [102.76720128  -0.36919327  -1.05249712]
mat_Sqrt:  [[24.79831887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00492288  0.01535661 -0.05151245]
Stock Position:  -0.004922879221572472
Bond Position:  [4.82456628]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.32698229]
Stock Price:  101.32084554004867
PL:  [3.00613675]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 2.05594116e-02 -3.70164953e-02  4.19947114e-02]
 [ 3.16163764e-02  1.10004566e-01 -1.58241524e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-3.45863500e-01 -3.79974524e-01  1.06955703e+00]
 [-4.90753255e-02  3.27898029e-02 -3.14705782e-02]
 [-1.29447382e+00  1.31239182e+00 -1.88411204e-01]
 [-6.39552859e-02  2.79866098e-02 -1.07935179e-01]
 [ 6.78858133e-02 -2.95788233e-02 -3.01713866e-02]
 [ 9.57567067e-02  2.50200908e-02  4.08316118e-02]
 [ 1.54827482e-01  1.20894138e-01  9.02335403e-02]
 [ 1.23471261e-01  3.23234687e-02 -5.27495288e-02]
 [-3.09951146e-02  1.54262612e-01 -1.16707299e-03]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [ 3.84276054e-02  3.28987220e-01 -1.38454364e-01]
 [-5.49160513e-02 -3.08070776e-01 -5.01203586e-02]
 [ 3.59727703e-02  6.36878946e-03 -6.58045695e-02]
 [-6.20651293e-02  1.95385532e-02  6.38484095e-02]
 [ 4.41671200e-02 -1.36822226e-01 -3.60862710e-02]
 [ 1.01800180e-02 -7.89347551e-02 -1.02222999e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.41813915]
curr_Stock_Price:  101.2767940492972
curr_Factors:  [101.27679405  -0.91440166  -0.98113106]
mat_Sqrt:  [[15.2156512   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00141799 -0.01194702  0.11979922]
Stock Position:  0.0014179863484132097
Bond Position:  [12.27453004]


portfolio before change:  [12.41956276]
curr_Stock_Price:  100.11641125558651
curr_Factors:  [100.11641126  -1.10188909  -1.01539986]
mat_Sqrt:  [[12.04975907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00180668  0.03550382 -0.45141902]
Stock Position:  0.001806679163945859
Bond Position:  [12.23868452]


portfolio before change:  [12.42303406]
curr_Stock_Price:  100.34403996444166
curr_Factors:  [100.34403996  -0.66444418  -1.03167204]
mat_Sqrt:  [[18.40253571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00423978  0.01370813 -0.02999186]
Stock Position:  -0.004239781936765226
Bond Position:  [12.84847091]


portfolio before change:  [12.42737602]
curr_Stock_Price:  100.07764834877068
curr_Factors:  [100.07764835  -0.38968698  -0.97717681]
mat_Sqrt:  [[25.51030721  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00804001 -0.12263625  3.05114849]
Stock Position:  -0.008040007490275882
Bond Position:  [13.23200107]


portfolio before change:  [12.42581599]
curr_Stock_Price:  100.68317608438237
curr_Factors:  [100.68317608  -0.36185169  -0.96957043]
mat_Sqrt:  [[26.59056887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183546  0.01058286 -0.0897768 ]
Stock Position:  -0.0018354643005740296
Bond Position:  [12.61061636]


portfolio before change:  [12.43001054]
curr_Stock_Price:  100.11574160934052
curr_Factors:  [100.11574161  -0.41837033  -0.94189351]
mat_Sqrt:  [[25.68900514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04145907  0.42357264 -0.53748472]
Stock Position:  -0.041459069216376244
Bond Position:  [16.580716]


portfolio before change:  [12.60359736]
curr_Stock_Price:  96.02879222005666
curr_Factors:  [96.02879222 -0.71524665 -0.90750172]
mat_Sqrt:  [[18.95181471  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00423573  0.00903264 -0.30790902]
Stock Position:  -0.004235727318033294
Bond Position:  [13.01034914]


portfolio before change:  [12.6036364]
curr_Stock_Price:  96.78756476791706
curr_Factors:  [96.78756477 -0.74691761 -0.87350447]
mat_Sqrt:  [[19.14605036  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00290866 -0.00954652 -0.08607057]
Stock Position:  0.0029086601026582235
Bond Position:  [12.32211427]


portfolio before change:  [12.61089483]
curr_Stock_Price:  98.22380014759081
curr_Factors:  [98.22380015 -0.94841864 -0.90480598]
mat_Sqrt:  [[15.39470977  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00709326 0.0080752  0.11648122]
Stock Position:  0.007093256760464133
Bond Position:  [11.9141682]


portfolio before change:  [12.61107726]
curr_Stock_Price:  97.82955497893022
curr_Factors:  [97.82955498 -0.99096161 -0.95582276]
mat_Sqrt:  [[13.96343824  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01417443 0.03901842 0.25741117]
Stock Position:  0.014174427174072662
Bond Position:  [11.22439936]


portfolio before change:  [12.62020573]
curr_Stock_Price:  98.27557017201995
curr_Factors:  [98.27557017 -1.2956671  -0.96212557]
mat_Sqrt:  [[10.27776481  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01160776  0.01043235 -0.15047972]
Stock Position:  0.011607758271505569
Bond Position:  [11.47944666]


portfolio before change:  [12.60933603]
curr_Stock_Price:  97.09188670613887
curr_Factors:  [97.09188671 -0.88128852 -0.98738379]
mat_Sqrt:  [[14.98403795  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.70435626e-05  4.97880439e-02 -3.32933439e-03]
Stock Position:  1.7043562619250758e-05
Bond Position:  [12.60768124]


portfolio before change:  [12.61246577]
curr_Stock_Price:  95.7669993253912
curr_Factors:  [95.76699933 -0.96738408 -0.94682014]
mat_Sqrt:  [[14.12171851  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00119399 -0.00995959  0.34984664]
Stock Position:  0.0011939852364382668
Bond Position:  [12.49812138]


portfolio before change:  [12.61798815]
curr_Stock_Price:  97.7749469562324
curr_Factors:  [97.77494696 -1.21108484 -0.98065641]
mat_Sqrt:  [[10.92361692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00707824  0.10618017 -0.39497176]
Stock Position:  0.00707823813775296
Bond Position:  [11.92591379]


portfolio before change:  [12.61178172]
curr_Stock_Price:  96.47684481318935
curr_Factors:  [96.47684481 -0.74635729 -0.94997794]
mat_Sqrt:  [[17.68943898  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00723774 -0.09942942 -0.14297943]
Stock Position:  -0.0072377371875924
Bond Position:  [13.31005577]


portfolio before change:  [12.6137257]
curr_Stock_Price:  96.66805768123655
curr_Factors:  [96.66805768 -0.60712674 -1.00379498]
mat_Sqrt:  [[19.30494545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00123494  0.00205552 -0.18772212]
Stock Position:  0.0012349422380934169
Bond Position:  [12.49434624]


portfolio before change:  [12.61938935]
curr_Stock_Price:  98.72456549549618
curr_Factors:  [98.7245655  -0.92635211 -1.00155922]
mat_Sqrt:  [[14.35965409  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00313683  0.00630604  0.18214174]
Stock Position:  -0.003136832998584927
Bond Position:  [12.92907183]


portfolio before change:  [12.61686584]
curr_Stock_Price:  100.55959611991558
curr_Factors:  [100.55959612  -1.19033299  -1.03011282]
mat_Sqrt:  [[10.91682023  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00081272 -0.04415918 -0.10294409]
Stock Position:  0.0008127202471135996
Bond Position:  [12.53513902]


portfolio before change:  [12.61905126]
curr_Stock_Price:  99.39222084938386
curr_Factors:  [99.39222085 -0.38851007 -1.01753792]
mat_Sqrt:  [[24.36203213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00110002 -0.02547608 -0.29161376]
Stock Position:  -0.0011000171689406891
Bond Position:  [12.72838441]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.62096939]
Stock Price:  100.54163230088459
PL:  [12.07933709]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.89047310e-02  7.70000375e-02  2.96435755e-02]
 [-6.69251512e-03  8.06573609e-02 -5.94684916e-02]
 [-3.50931935e-02 -8.34343658e-02 -1.31857054e-01]
 [-4.26195094e-01 -4.72448715e-01  1.61321885e+00]
 [-8.91139215e-03 -2.65035918e-02  8.46513820e-03]
 [-1.25078117e+00  1.26719036e+00 -1.82584432e-01]
 [ 2.81205240e-03  1.08562295e-02  6.18617028e-03]
 [ 3.03624269e-03  4.41488947e-02 -6.56331115e-02]
 [ 8.20993458e-02  2.57505117e-02  4.31606004e-02]
 [ 1.54924212e-01  1.21923334e-01  9.14790360e-02]
 [ 1.23640051e-01  3.23265461e-02 -5.27512774e-02]
 [-1.04689577e-01  1.15493524e-01  1.74681907e-01]
 [-1.84029402e-01 -1.23117352e-01  3.48317252e-02]
 [ 5.66293824e-02  4.83431383e-01 -1.98033960e-01]
 [-5.00073568e-02 -2.72077802e-01 -6.30729431e-02]
 [ 5.22254378e-02  3.13333001e-02  7.12983308e-02]
 [-4.98704913e-02  2.11068497e-02  6.66750683e-02]
 [-6.52568134e-03 -4.72697101e-02  1.36001321e-02]
 [ 1.76205766e-04 -6.35592521e-02 -1.00307081e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.35770527]
curr_Stock_Price:  99.88249745857557
curr_Factors:  [99.88249746 -0.80197347 -0.98713144]
mat_Sqrt:  [[16.69133229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162577  0.02485166  0.08456487]
Stock Position:  -0.0016257656457303524
Bond Position:  [1.5200908]


portfolio before change:  [1.35423776]
curr_Stock_Price:  102.24912273885114
curr_Factors:  [102.24912274  -0.57328696  -0.99488324]
mat_Sqrt:  [[21.31139749  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.11084000e-04  2.60320513e-02 -1.69647054e-01]
Stock Position:  -0.00011108399963736813
Bond Position:  [1.36559601]


portfolio before change:  [1.35451495]
curr_Stock_Price:  102.82752183239253
curr_Factors:  [102.82752183  -0.80044573  -1.00607594]
mat_Sqrt:  [[16.88678506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00468055 -0.02692833 -0.37615147]
Stock Position:  -0.004680545775765131
Bond Position:  [1.83580388]


portfolio before change:  [1.35275423]
curr_Stock_Price:  103.30176811698777
curr_Factors:  [103.30176812  -0.32753986  -0.99806673]
mat_Sqrt:  [[27.44126481  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00704546 -0.15248217  4.60206436]
Stock Position:  -0.00704546112750157
Bond Position:  [2.08056282]


portfolio before change:  [1.36242351]
curr_Stock_Price:  102.00319189536202
curr_Factors:  [102.0031919  -0.5466234  -1.0182247]
mat_Sqrt:  [[21.33088462  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00059039 -0.008554    0.02414868]
Stock Position:  -0.0005903869576920749
Bond Position:  [1.42264486]


portfolio before change:  [1.36408526]
curr_Stock_Price:  99.79100793142324
curr_Factors:  [99.79100793 -0.74474553 -1.01471252]
mat_Sqrt:  [[17.17783732  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05992529  0.40898393 -0.52086256]
Stock Position:  -0.059925291855124525
Bond Position:  [7.34409053]


portfolio before change:  [1.42298104]
curr_Stock_Price:  98.83883015471926
curr_Factors:  [98.83883015 -0.91534789 -1.03244595]
mat_Sqrt:  [[14.09326053  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00044637 0.00350383 0.01764742]
Stock Position:  0.00044637063738247305
Bond Position:  [1.37886229]


portfolio before change:  [1.42295517]
curr_Stock_Price:  98.00851738377725
curr_Factors:  [98.00851738 -0.86161217 -1.07279188]
mat_Sqrt:  [[14.16324653  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.52609769e-05  1.42489945e-02 -1.87232998e-01]
Stock Position:  -9.526097692388008e-05
Bond Position:  [1.43229156]


portfolio before change:  [1.42329099]
curr_Stock_Price:  98.24260674699602
curr_Factors:  [98.24260675 -0.82348844 -1.0570522 ]
mat_Sqrt:  [[14.98274727  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00641843 0.00831094 0.12312518]
Stock Position:  0.006418433545127222
Bond Position:  [0.79272735]


portfolio before change:  [1.42397895]
curr_Stock_Price:  98.3189111850602
curr_Factors:  [98.31891119 -1.45104692 -1.05902896]
mat_Sqrt:  [[ 7.98959856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0248429  0.03935059 0.26096423]
Stock Position:  0.024842898770543437
Bond Position:  [-1.01854781]


portfolio before change:  [1.42715787]
curr_Stock_Price:  98.45712344845089
curr_Factors:  [98.45712345 -1.66760119 -1.12304179]
mat_Sqrt:  [[ 6.04346901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01976859  0.01043335 -0.15048471]
Stock Position:  0.019768591581651767
Bond Position:  [-0.51920079]


portfolio before change:  [1.43259322]
curr_Stock_Price:  98.73863863224578
curr_Factors:  [98.73863863 -1.47222838 -1.11860907]
mat_Sqrt:  [[ 7.40117594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00614197  0.03727537  0.49831886]
Stock Position:  -0.006141965163946081
Bond Position:  [2.0390425]


portfolio before change:  [1.43026219]
curr_Stock_Price:  99.20116943750944
curr_Factors:  [99.20116944 -1.58903942 -1.11420741]
mat_Sqrt:  [[ 6.64525435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03040525 -0.03973595  0.09936522]
Stock Position:  -0.030405251613183755
Bond Position:  [4.44649871]


portfolio before change:  [1.42776427]
curr_Stock_Price:  99.31988850180727
curr_Factors:  [99.3198885  -1.78939242 -1.09719522]
mat_Sqrt:  [[ 5.53869107  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02074243  0.15602681 -0.56493577]
Stock Position:  0.02074242556998589
Bond Position:  [-0.63237112]


portfolio before change:  [1.42542102]
curr_Stock_Price:  99.21454211257094
curr_Factors:  [99.21454211 -1.47729502 -1.08018483]
mat_Sqrt:  [[ 7.68910774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01540097 -0.08781273 -0.17992955]
Stock Position:  -0.015400969829816927
Bond Position:  [2.95342119]


portfolio before change:  [1.43380572]
curr_Stock_Price:  98.71806334730194
curr_Factors:  [98.71806335 -1.03655036 -1.08713388]
mat_Sqrt:  [[11.8057146   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00619827 0.01011278 0.20339429]
Stock Position:  0.006198272124747686
Bond Position:  [0.8219243]


portfolio before change:  [1.42916603]
curr_Stock_Price:  97.93636075406425
curr_Factors:  [97.93636075 -0.7176893  -1.109786  ]
mat_Sqrt:  [[15.75003501  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0020287   0.00681221  0.19020541]
Stock Position:  -0.0020286991313879527
Bond Position:  [1.62784944]


portfolio before change:  [1.42931984]
curr_Stock_Price:  98.06116915185429
curr_Factors:  [98.06116915 -0.63963166 -1.09977293]
mat_Sqrt:  [[17.2219868   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00077799 -0.01525623  0.03879739]
Stock Position:  -0.0007779854512982756
Bond Position:  [1.50561]


portfolio before change:  [1.42887894]
curr_Stock_Price:  99.11176320204558
curr_Factors:  [99.1117632  -0.57243447 -1.08365289]
mat_Sqrt:  [[18.91888758  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175871 -0.02051366 -0.28614818]
Stock Position:  -0.0017587117222736422
Bond Position:  [1.60318796]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.43052517]
Stock Price:  98.4036408280186
PL:  [1.43052517]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 1.00081157e-02 -1.40245123e-02  2.59552102e-02]
 [ 6.15062172e-02  1.57061128e-01 -2.31874036e-01]
 [-7.81647606e-02  7.85161040e-03 -3.19447760e-02]
 [-2.76738549e-01 -2.87768624e-01  8.21373072e-01]
 [-2.67140763e-02 -2.21764098e-04 -9.23638866e-03]
 [-1.35269282e+00  1.38215538e+00 -2.02199402e-01]
 [-6.43770031e-04  1.49189001e-02 -3.73488144e-03]
 [-9.26026032e-02 -1.79946955e-02 -2.48312295e-02]
 [ 8.19007896e-02  2.72378012e-02  6.29696112e-02]
 [-1.60705800e-01  1.99278302e-01 -6.81681513e-02]
 [ 4.46657327e-02  3.89042777e-02 -5.51581554e-02]
 [ 3.90815486e-02  6.36075732e-02 -1.67143880e-02]
 [-1.30672928e-01 -9.60933524e-02  6.05509863e-02]
 [ 2.16339678e-02  6.53238684e-01 -4.23128758e-01]
 [ 3.90465589e-02 -1.43011847e-01 -5.06796229e-02]
 [ 6.42327975e-02  6.33902315e-02  1.63385464e-01]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 3.26644791e-02 -1.04064124e-01 -4.89261525e-02]
 [ 3.34581364e-02 -8.45603008e-02 -1.86776050e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.27405322]
curr_Stock_Price:  101.13256868459163
curr_Factors:  [101.13256868  -0.55889096  -1.01488844]
mat_Sqrt:  [[20.96077465  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00059365 -0.00452639  0.07404299]
Stock Position:  0.0005936545490102966
Bond Position:  [11.21401541]


portfolio before change:  [11.27648099]
curr_Stock_Price:  100.49905910608184
curr_Factors:  [100.49905911  -0.32203823  -1.053034  ]
mat_Sqrt:  [[25.40830609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00181968  0.05069126 -0.66147208]
Stock Position:  0.001819684321677872
Bond Position:  [11.09360442]


portfolio before change:  [11.28167699]
curr_Stock_Price:  101.83020161575818
curr_Factors:  [101.83020162  -0.5099664   -1.05347974]
mat_Sqrt:  [[21.32458437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0038961   0.0025341  -0.09112955]
Stock Position:  -0.0038961020752348637
Bond Position:  [11.67841785]


portfolio before change:  [11.29325601]
curr_Stock_Price:  99.60771211981704
curr_Factors:  [99.60771212 -0.62962549 -1.06606184]
mat_Sqrt:  [[18.27533369  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0091827  -0.09287692  2.34314875]
Stock Position:  -0.009182704929137496
Bond Position:  [12.20792424]


portfolio before change:  [11.2811976]
curr_Stock_Price:  101.25328033446527
curr_Factors:  [101.25328033  -0.84353744  -1.05239325]
mat_Sqrt:  [[15.20606571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.88376890e-03 -7.15740547e-05 -2.63488459e-02]
Stock Position:  -0.0018837688974479988
Bond Position:  [11.47193538]


portfolio before change:  [11.28635973]
curr_Stock_Price:  100.03562630268021
curr_Factors:  [100.0356263   -0.54105908  -1.03280087]
mat_Sqrt:  [[20.73175205  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05362959  0.44608873 -0.57681861]
Stock Position:  -0.05362958791751472
Bond Position:  [16.65122914]


portfolio before change:  [11.27053723]
curr_Stock_Price:  100.4082904515315
curr_Factors:  [100.40829045  -0.64670516  -1.00881059]
mat_Sqrt:  [[19.17733345  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.54737303e-05  4.81505431e-03 -1.06545772e-02]
Stock Position:  8.547373027379617e-05
Bond Position:  [11.26195496]


portfolio before change:  [11.27342415]
curr_Stock_Price:  101.23993168220719
curr_Factors:  [101.23993168  -0.95369953  -0.97827308]
mat_Sqrt:  [[14.66583515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00691024 -0.00580776 -0.07083659]
Stock Position:  -0.0069102378103054075
Bond Position:  [11.97301616]


portfolio before change:  [11.27661553]
curr_Stock_Price:  101.21131476804887
curr_Factors:  [101.21131477  -0.70913143  -0.97017388]
mat_Sqrt:  [[18.87626379  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00531431 0.00879096 0.17963477]
Stock Position:  0.005314309103632936
Bond Position:  [10.73874732]


portfolio before change:  [11.27685317]
curr_Stock_Price:  100.75078831423481
curr_Factors:  [100.75078831  -0.47326999  -0.99747693]
mat_Sqrt:  [[23.1478778   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00578641  0.0643168  -0.19446476]
Stock Position:  -0.005786407461389488
Bond Position:  [11.85983829]


portfolio before change:  [11.27753012]
curr_Stock_Price:  101.14626323644683
curr_Factors:  [101.14626324  -0.45680942  -1.02624327]
mat_Sqrt:  [[22.95452152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0018013   0.0125563  -0.15735086]
Stock Position:  0.0018012975706126321
Bond Position:  [11.09533561]


portfolio before change:  [11.27730147]
curr_Stock_Price:  99.47922095924979
curr_Factors:  [99.47922096 -0.62727008 -1.0158677 ]
mat_Sqrt:  [[19.23652857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00252923  0.02052926 -0.0476815 ]
Stock Position:  0.002529228687095182
Bond Position:  [11.02569577]


portfolio before change:  [11.28179732]
curr_Stock_Price:  100.1668143235765
curr_Factors:  [100.16681432  -0.53992227  -1.03807694]
mat_Sqrt:  [[20.67319075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00667183 -0.031014    0.17273511]
Stock Position:  -0.0066718284864243855
Bond Position:  [11.95009312]


portfolio before change:  [11.27012235]
curr_Stock_Price:  102.36454191790925
curr_Factors:  [102.36454192  -0.89379887  -0.9851974 ]
mat_Sqrt:  [[15.63550218  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00438777  0.21083188 -1.20706857]
Stock Position:  0.004387768227064355
Bond Position:  [10.82097047]


portfolio before change:  [11.27121338]
curr_Stock_Price:  101.99657574294484
curr_Factors:  [101.99657574  -0.73473379  -0.96067898]
mat_Sqrt:  [[18.7187646   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.62061540e-05 -4.61568751e-02 -1.44574858e-01]
Stock Position:  -2.6206154034455712e-05
Bond Position:  [11.27388632]


portfolio before change:  [11.27405104]
curr_Stock_Price:  101.2779777928313
curr_Factors:  [101.27797779  -0.74890358  -0.91137688]
mat_Sqrt:  [[19.25149151  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00574102 0.02045911 0.46609325]
Stock Position:  0.005741019724400944
Bond Position:  [10.69261217]


portfolio before change:  [11.29125934]
curr_Stock_Price:  103.80972641366142
curr_Factors:  [103.80972641  -0.68381415  -0.94859413]
mat_Sqrt:  [[20.29047142  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00339025  0.00525786  0.16709793]
Stock Position:  -0.003390252227645334
Bond Position:  [11.6432005]


portfolio before change:  [11.29717028]
curr_Stock_Price:  102.92490325109775
curr_Factors:  [102.92490325  -0.17988232  -0.94124566]
mat_Sqrt:  [[33.54445725  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.27930488e-05 -3.35865517e-02 -1.39572695e-01]
Stock Position:  4.279304882996234e-05
Bond Position:  [11.29276581]


portfolio before change:  [11.29975911]
curr_Stock_Price:  97.43997085598919
curr_Factors:  [97.43997086 -0.21998084 -0.86497152]
mat_Sqrt:  [[32.92670876  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066597 -0.02729172 -0.53282008]
Stock Position:  -0.0006659689037713448
Bond Position:  [11.3646511]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.30303115]
Stock Price:  96.79350232377271
PL:  [11.30303115]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 1.73378022e-02 -2.08489178e-02  2.47804493e-02]
 [-1.09050931e-02  7.10561752e-02 -4.15056347e-02]
 [-4.98245380e-02 -7.43311168e-02 -1.00197834e-01]
 [-2.76278063e-01 -2.76637633e-01  1.06125574e+00]
 [ 1.41695560e-02 -6.61343650e-02  3.06453288e-02]
 [-1.28600597e+00  1.41065353e+00 -2.12618636e-01]
 [ 1.09313730e-02 -7.36087661e-03  3.25733890e-02]
 [-8.57460793e-02 -3.42802272e-02  7.44665885e-03]
 [-6.20927009e-02  1.62332398e-02  5.38171839e-02]
 [-6.82466650e-01  3.13796270e-01 -3.47255461e-01]
 [ 1.24632574e-01  3.69208656e-02 -5.35177089e-02]
 [-9.58836616e-02  1.20126128e-01  1.53669322e-01]
 [-1.76011399e-01 -1.25210210e-01  4.40984351e-02]
 [ 2.78569731e-02  4.32253818e-01 -2.92624948e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 6.29981913e-02  5.15691137e-02  1.65182383e-01]
 [-3.50679858e-02  1.76888073e-02  8.01771063e-02]
 [ 1.31216864e-02 -9.52984751e-02  5.53516969e-03]
 [ 5.88116301e-03 -2.14242054e-02 -1.44669299e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.83301834]
curr_Stock_Price:  101.32909440646525
curr_Factors:  [101.32909441  -0.54710456  -1.00836336]
mat_Sqrt:  [[21.38961803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00084809 -0.00672896  0.07069172]
Stock Position:  0.0008480900705727666
Bond Position:  [12.74708214]


portfolio before change:  [12.83728301]
curr_Stock_Price:  102.59959573718965
curr_Factors:  [102.59959574  -0.47801377  -1.02044546]
mat_Sqrt:  [[22.92836433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00021254  0.02293328 -0.11840402]
Stock Position:  -0.00021253649998063864
Bond Position:  [12.85908917]


portfolio before change:  [12.84047458]
curr_Stock_Price:  102.71065557623254
curr_Factors:  [102.71065558  -0.52893747  -1.05820533]
mat_Sqrt:  [[21.00526396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00406803 -0.02399026 -0.28583653]
Stock Position:  -0.004068033189804519
Bond Position:  [13.25830493]


portfolio before change:  [12.84608816]
curr_Stock_Price:  102.14561689361383
curr_Factors:  [102.14561689  -0.86930841  -1.06787206]
mat_Sqrt:  [[14.72017416  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0078884  -0.08928441  3.02746724]
Stock Position:  -0.00788839593085922
Bond Position:  [13.65185323]


portfolio before change:  [12.84388135]
curr_Stock_Price:  102.85808097500545
curr_Factors:  [102.85808098  -0.70302079  -1.08567832]
mat_Sqrt:  [[17.19555756  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040274 -0.02134477  0.08742259]
Stock Position:  0.00040274279257097417
Bond Position:  [12.802456]


portfolio before change:  [12.84711992]
curr_Stock_Price:  102.95131612658933
curr_Factors:  [102.95131613  -0.81077742  -1.09492986]
mat_Sqrt:  [[15.31065423  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06802179  0.45528647 -0.60654179]
Stock Position:  -0.06802179109485623
Bond Position:  [19.85005284]


portfolio before change:  [12.92751695]
curr_Stock_Price:  101.84234941232586
curr_Factors:  [101.84234941  -0.85413421  -1.11492104]
mat_Sqrt:  [[14.2160381   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00113097 -0.00237571  0.09292281]
Stock Position:  0.001130965987887352
Bond Position:  [12.81233672]


portfolio before change:  [12.93056524]
curr_Stock_Price:  101.7051187922732
curr_Factors:  [101.70511879  -0.77342428  -1.09574736]
mat_Sqrt:  [[15.68815534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0058148  -0.0110639   0.02124324]
Stock Position:  -0.00581479826871902
Bond Position:  [13.52195998]


portfolio before change:  [12.92689101]
curr_Stock_Price:  102.9184257711328
curr_Factors:  [102.91842577  -1.0390658   -1.11235055]
mat_Sqrt:  [[11.97139846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00399233  0.00523926  0.15352545]
Stock Position:  -0.0039923253904861015
Bond Position:  [13.33777486]


portfolio before change:  [12.92943985]
curr_Stock_Price:  103.11530850959322
curr_Factors:  [103.11530851  -1.17457036  -1.13837125]
mat_Sqrt:  [[10.20529035  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06754305  0.10127731 -0.99062317]
Stock Position:  -0.06754305414778604
Bond Position:  [19.89416272]


portfolio before change:  [12.97105654]
curr_Stock_Price:  102.57280237196194
curr_Factors:  [102.57280237  -1.40595313  -1.17061839]
mat_Sqrt:  [[ 7.79904499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0155461   0.01191616 -0.15267113]
Stock Position:  0.0155461031300127
Bond Position:  [11.37644917]


portfolio before change:  [12.96943765]
curr_Stock_Price:  102.28569779391181
curr_Factors:  [102.28569779  -1.31931879  -1.2095928 ]
mat_Sqrt:  [[ 8.15685168  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00490329  0.03877054  0.4383758 ]
Stock Position:  -0.0049032887941074165
Bond Position:  [13.47097396]


portfolio before change:  [12.97626852]
curr_Stock_Price:  101.5794960455134
curr_Factors:  [101.57949605  -0.83773575  -1.19452573]
mat_Sqrt:  [[13.31085986  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.014467   -0.04041142  0.12580056]
Stock Position:  -0.014467004630730598
Bond Position:  [14.44581956]


portfolio before change:  [12.99582416]
curr_Stock_Price:  100.4774205741993
curr_Factors:  [100.47742057  -0.80784282  -1.17382363]
mat_Sqrt:  [[13.84974171  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00406929  0.13950932 -0.83477753]
Stock Position:  0.004069288654304428
Bond Position:  [12.58695253]


portfolio before change:  [12.990568]
curr_Stock_Price:  98.41236768885439
curr_Factors:  [98.41236769 -0.71403482 -1.17015271]
mat_Sqrt:  [[14.95400204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00889348 -0.09296045 -0.18429859]
Stock Position:  -0.00889347735662942
Bond Position:  [13.86579616]


portfolio before change:  [12.9793767]
curr_Stock_Price:  100.0605622730358
curr_Factors:  [100.06056227  -1.13654953  -1.14154204]
mat_Sqrt:  [[10.25416598  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01045842 0.01664386 0.47121936]
Stock Position:  0.010458422987200596
Bond Position:  [11.93290101]


portfolio before change:  [12.97305882]
curr_Stock_Price:  99.17118627723336
curr_Factors:  [99.17118628 -1.19851931 -1.09822744]
mat_Sqrt:  [[ 9.97518745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00151287  0.00570904  0.22872297]
Stock Position:  -0.0015128728057126747
Bond Position:  [13.12309222]


portfolio before change:  [12.97784009]
curr_Stock_Price:  98.17963935478046
curr_Factors:  [98.17963935 -1.45864625 -1.10299961]
mat_Sqrt:  [[ 7.57727015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00068642 -0.03075745  0.0157903 ]
Stock Position:  -0.0006864176020283939
Bond Position:  [13.04523232]


portfolio before change:  [12.98123025]
curr_Stock_Price:  97.99252120375013
curr_Factors:  [97.9925212  -1.05888628 -1.09840019]
mat_Sqrt:  [[11.33170656  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247293 -0.00691463 -0.41270124]
Stock Position:  -0.002472931279156952
Bond Position:  [13.22355902]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.98935449]
Stock Price:  96.04425194163211
PL:  [12.98935449]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-7.77402811e-04 -1.40758641e-02  4.12744195e-02]
 [-4.52910482e-03  8.41482815e-02 -6.95356474e-02]
 [ 1.57956610e-02 -1.14881184e-01 -2.41222591e-01]
 [-2.42232003e-01 -2.27194804e-01  1.06572233e+00]
 [ 1.15508594e-02 -7.13199405e-02  2.67878737e-02]
 [-9.42828289e-01  1.04220236e+00 -1.49775389e-01]
 [ 1.03533035e-02 -5.59429841e-03  2.93433831e-02]
 [-9.29724339e-02 -2.07711243e-02 -1.87441541e-02]
 [ 1.12838738e-01  2.91613594e-02  6.36521396e-02]
 [ 1.17831040e-01  1.37943125e-01  8.05915225e-02]
 [ 9.34303826e-02  9.40226736e-03 -5.78622156e-02]
 [ 5.72117917e-02  4.01532901e-02 -2.07367914e-02]
 [-1.58455021e-01 -1.10164433e-01  4.71592675e-02]
 [ 2.21550717e-02  4.45003206e-01 -3.13961426e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 6.29306264e-02  5.25508129e-02  1.63128575e-01]
 [-8.85109137e-02  1.85053361e-02  5.34471161e-02]
 [-1.20427730e-02 -5.54779636e-02  2.80457998e-02]
 [ 4.49871060e-02 -9.53110661e-02 -2.06229701e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.13681843]
curr_Stock_Price:  100.73708367734831
curr_Factors:  [100.73708368  -0.86172553  -1.00578396]
mat_Sqrt:  [[15.56468394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00030675 -0.00454297  0.11774443]
Stock Position:  0.0003067507874712867
Bond Position:  [8.10591725]


portfolio before change:  [8.13943429]
curr_Stock_Price:  102.6576225721894
curr_Factors:  [102.65762257  -0.86906625  -1.00004522]
mat_Sqrt:  [[15.83603331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.76452463e-05  2.71587411e-02 -1.98365847e-01]
Stock Position:  -9.764524625530784e-05
Bond Position:  [8.14945832]


portfolio before change:  [8.14136844]
curr_Stock_Price:  103.71723378923845
curr_Factors:  [103.71723379  -1.03412816  -1.02985587]
mat_Sqrt:  [[13.16661243  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00432106 -0.03707774 -0.68814091]
Stock Position:  -0.004321059650056097
Bond Position:  [8.5895368]


portfolio before change:  [8.14564205]
curr_Stock_Price:  103.22523423761845
curr_Factors:  [103.22523424  -1.11348412  -1.03459645]
mat_Sqrt:  [[12.04720608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00589915 -0.07332681  3.04020917]
Stock Position:  -0.005899151060429719
Bond Position:  [8.7545833]


portfolio before change:  [8.14852152]
curr_Stock_Price:  103.10817564057321
curr_Factors:  [103.10817564  -1.03736972  -1.06594254]
mat_Sqrt:  [[12.58450666  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00019554 -0.02301841  0.07641835]
Stock Position:  0.00019554118554325232
Bond Position:  [8.12835962]


portfolio before change:  [8.15050353]
curr_Stock_Price:  102.85076550467524
curr_Factors:  [102.8507655   -1.47909693  -1.07371987]
mat_Sqrt:  [[ 8.00816997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0949858   0.33636937 -0.4272675 ]
Stock Position:  -0.09498579572400882
Bond Position:  [17.91986533]


portfolio before change:  [8.22799771]
curr_Stock_Price:  102.08208577685187
curr_Factors:  [102.08208578  -1.13584948  -1.09112299]
mat_Sqrt:  [[11.01000919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138066 -0.00180555  0.0837085 ]
Stock Position:  0.001380658712750712
Bond Position:  [8.08705719]


portfolio before change:  [8.22818534]
curr_Stock_Price:  100.75345071533656
curr_Factors:  [100.75345072  -0.80756449  -1.0497218 ]
mat_Sqrt:  [[15.72717573  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00642445 -0.00670385 -0.05347185]
Stock Position:  -0.00642445014035686
Bond Position:  [8.87547086]


portfolio before change:  [8.23033602]
curr_Stock_Price:  100.76410670611432
curr_Factors:  [100.76410671  -0.56879002  -1.05571296]
mat_Sqrt:  [[19.85149336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0066385  0.00941179 0.18158184]
Stock Position:  0.006638503806730316
Bond Position:  [7.56141312]


portfolio before change:  [8.22196487]
curr_Stock_Price:  99.21831553881948
curr_Factors:  [99.21831554 -0.16880702 -1.05754377]
mat_Sqrt:  [[29.10680058  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0055808  0.04452095 0.22990518]
Stock Position:  0.005580800182203393
Bond Position:  [7.66824728]


portfolio before change:  [8.22689842]
curr_Stock_Price:  99.75878371815061
curr_Factors:  [ 9.97587837e+01 -8.93041640e-02 -1.07097519e+00]
mat_Sqrt:  [[31.26426508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00267201  0.00303457 -0.1650648 ]
Stock Position:  0.002672013461003577
Bond Position:  [7.96034161]


portfolio before change:  [8.22439183]
curr_Stock_Price:  98.07581193963755
curr_Factors:  [98.07581194 -0.56670905 -1.00595025]
mat_Sqrt:  [[20.35001138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00300615  0.01295942 -0.05915629]
Stock Position:  0.003006149078397451
Bond Position:  [7.92956132]


portfolio before change:  [8.23168218]
curr_Stock_Price:  99.84142921259712
curr_Factors:  [99.84142921 -0.7066588  -1.04180008]
mat_Sqrt:  [[17.37659777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.009859   -0.03555542  0.13453226]
Stock Position:  -0.009859001093756795
Bond Position:  [9.21601894]


portfolio before change:  [8.22919305]
curr_Stock_Price:  100.3276267043761
curr_Factors:  [100.3276267   -0.65376308  -1.0763092 ]
mat_Sqrt:  [[17.78523843  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00274969  0.14362417 -0.89564456]
Stock Position:  0.0027496883615115656
Bond Position:  [7.95332334]


portfolio before change:  [8.22795104]
curr_Stock_Price:  99.15273548094963
curr_Factors:  [99.15273548 -0.72760576 -1.12565014]
mat_Sqrt:  [[15.53981671  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00855821 -0.09296045 -0.18429859]
Stock Position:  -0.008558214108321204
Bond Position:  [9.07652138]


portfolio before change:  [8.22184736]
curr_Stock_Price:  100.13110487809782
curr_Factors:  [100.13110488  -1.08857179  -1.14265797]
mat_Sqrt:  [[10.75370789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00994596 0.0169607  0.46536042]
Stock Position:  0.009945964515641939
Bond Position:  [7.22594695]


portfolio before change:  [8.21545629]
curr_Stock_Price:  99.30687227010513
curr_Factors:  [99.30687227 -0.55537982 -1.1916422 ]
mat_Sqrt:  [[17.30841422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00426519  0.00597257  0.15246975]
Stock Position:  -0.004265190324853855
Bond Position:  [8.639019]


portfolio before change:  [8.22494363]
curr_Stock_Price:  97.58893793867743
curr_Factors:  [97.58893794 -0.74832808 -1.18725791]
mat_Sqrt:  [[14.08595437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00125248 -0.01790544  0.08000686]
Stock Position:  -0.0012524774343845957
Bond Position:  [8.34717157]


portfolio before change:  [8.2277454]
curr_Stock_Price:  97.01829480489094
curr_Factors:  [97.0182948  -0.43142592 -1.15215146]
mat_Sqrt:  [[19.91199234  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083189 -0.03076151 -0.58831594]
Stock Position:  -0.0008318929195234866
Bond Position:  [8.30845423]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.23007825]
Stock Price:  96.71118506513872
PL:  [8.23007825]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-7.46482582e-02  1.50266213e-01  1.43180181e-02]
 [-4.41830464e-03 -4.18630491e-02  1.03207536e-01]
 [ 8.99973427e-02 -5.33273648e-02 -1.20413596e-02]
 [-1.18094459e-01 -7.65367691e-02  3.61518376e-01]
 [ 8.37286482e-03 -5.20200735e-02  2.56511837e-02]
 [-9.44060257e-01  9.28983439e-01 -1.15885211e-01]
 [-6.75877040e-03  2.58707680e-02 -2.11432714e-02]
 [-5.55556182e-02  1.24074025e-02 -4.92156246e-02]
 [ 1.42248127e-01  2.42361465e-02  3.95768612e-02]
 [ 1.54774517e-01  1.20330604e-01  8.95515718e-02]
 [ 1.23172516e-01  3.23180220e-02 -5.27464340e-02]
 [-1.59318445e-01  8.67544382e-02  3.05036762e-01]
 [-1.87718775e-01 -1.24985946e-01  3.30533481e-02]
 [ 5.24361776e-02  3.87342429e-01 -1.42509869e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 4.99174544e-02  3.09259836e-02  4.59936154e-02]
 [-7.29449643e-02  1.88055043e-02  6.00361212e-02]
 [ 1.58228923e-02 -7.96503658e-02 -8.06696704e-03]
 [ 1.72326228e-02 -6.09240219e-02 -1.71128960e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.55134814]
curr_Stock_Price:  99.3897157187362
curr_Factors:  [99.38971572 -0.92067321 -1.00572782]
mat_Sqrt:  [[14.47825132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00283547  0.04849821  0.04084532]
Stock Position:  -0.0028354696826108283
Bond Position:  [-2.26953162]


portfolio before change:  [-2.54955]
curr_Stock_Price:  98.55542815759108
curr_Factors:  [98.55542816 -1.0440772  -0.99858687]
mat_Sqrt:  [[12.78094051  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00063404 -0.01351124  0.29442237]
Stock Position:  0.0006340367746434967
Bond Position:  [-2.61203776]


portfolio before change:  [-2.5501684]
curr_Stock_Price:  98.61013842541944
curr_Factors:  [98.61013843 -1.06029642 -0.97195174]
mat_Sqrt:  [[12.92193069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00593209 -0.01721133 -0.03435065]
Stock Position:  0.005932086275331697
Bond Position:  [-3.13513225]


portfolio before change:  [-2.54599116]
curr_Stock_Price:  99.44645851066137
curr_Factors:  [99.44645851 -1.30429348 -1.00078209]
mat_Sqrt:  [[ 9.91990975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00604066 -0.02470214  1.0313113 ]
Stock Position:  -0.006040663028062869
Bond Position:  [-1.94526861]


portfolio before change:  [-2.54994488]
curr_Stock_Price:  100.02045831464073
curr_Factors:  [100.02045831  -1.09349896  -1.01101407]
mat_Sqrt:  [[12.19299636  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00024525 -0.01678941  0.07317569]
Stock Position:  0.00024525043950374554
Bond Position:  [-2.57447494]


portfolio before change:  [-2.55072899]
curr_Stock_Price:  99.44791296106435
curr_Factors:  [99.44791296 -1.31937708 -1.01372127]
mat_Sqrt:  [[ 9.64592618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08066486  0.29982812 -0.33058825]
Stock Position:  -0.0806648591331224
Bond Position:  [5.4712229]


portfolio before change:  [-2.52226941]
curr_Stock_Price:  99.11205910220903
curr_Factors:  [99.1120591  -1.44701762 -0.95263282]
mat_Sqrt:  [[ 8.99438661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064415  0.00834975 -0.06031587]
Stock Position:  -0.0006441544559986148
Bond Position:  [-2.45842594]


portfolio before change:  [-2.52273752]
curr_Stock_Price:  98.88451627594269
curr_Factors:  [98.88451628 -1.71016919 -0.93935197]
mat_Sqrt:  [[ 6.9896571   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0090232   0.00400447 -0.14039848]
Stock Position:  -0.00902319872756096
Bond Position:  [-1.63048288]


portfolio before change:  [-2.52238949]
curr_Stock_Price:  98.80076477611465
curr_Factors:  [98.80076478 -1.54945131 -0.98670645]
mat_Sqrt:  [[ 7.82205711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01985078 0.00782218 0.11290177]
Stock Position:  0.01985077583849904
Bond Position:  [-4.48366132]


portfolio before change:  [-2.5286249]
curr_Stock_Price:  98.54312459472295
curr_Factors:  [98.54312459 -1.92692497 -0.98173228]
mat_Sqrt:  [[ 5.37542164  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03676298 0.03883654 0.25546571]
Stock Position:  0.03676298349530939
Bond Position:  [-6.15136416]


portfolio before change:  [-2.51014276]
curr_Stock_Price:  99.0876988611123
curr_Factors:  [99.08769886 -2.2241556  -0.98333247]
mat_Sqrt:  [[ 4.00890137  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02968459  0.0104306  -0.15047089]
Stock Position:  0.029684587640889923
Bond Position:  [-5.45152024]


portfolio before change:  [-2.51363724]
curr_Stock_Price:  99.0158962035227
curr_Factors:  [99.0158962  -2.00838117 -1.01810122]
mat_Sqrt:  [[ 4.80087414  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01652707  0.02799987  0.87018497]
Stock Position:  -0.016527073903193138
Bond Position:  [-0.87719421]


portfolio before change:  [-2.51957574]
curr_Stock_Price:  99.36194512319223
curr_Factors:  [99.36194512 -1.64358628 -1.03627071]
mat_Sqrt:  [[ 6.81354272  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.030305   -0.04033904  0.094292  ]
Stock Position:  -0.030305003779286972
Bond Position:  [0.49158838]


portfolio before change:  [-2.48823263]
curr_Stock_Price:  98.33174560353783
curr_Factors:  [98.3317456  -1.43810082 -1.05653396]
mat_Sqrt:  [[ 8.11498328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01262016  0.12501423 -0.40654099]
Stock Position:  0.01262016336630224
Bond Position:  [-3.72919533]


portfolio before change:  [-2.4889817]
curr_Stock_Price:  98.34627392137259
curr_Factors:  [98.34627392 -1.02871343 -1.0667601 ]
mat_Sqrt:  [[12.09776991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01099319 -0.09296045 -0.18429859]
Stock Position:  -0.010993189613093514
Bond Position:  [-1.40784246]


portfolio before change:  [-2.49333758]
curr_Stock_Price:  98.71048791908177
curr_Factors:  [98.71048792 -0.85122205 -1.08399334]
mat_Sqrt:  [[14.25311974  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00460381 0.00998132 0.13120698]
Stock Position:  0.0046038062572941975
Bond Position:  [-2.94778154]


portfolio before change:  [-2.49257471]
curr_Stock_Price:  99.03628320675274
curr_Factors:  [99.03628321 -0.87431535 -1.05414487]
mat_Sqrt:  [[14.39708937  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00394882  0.00606945  0.17126634]
Stock Position:  -0.003948817942209385
Bond Position:  [-2.10149846]


portfolio before change:  [-2.49173589]
curr_Stock_Price:  98.6907960944713
curr_Factors:  [98.69079609 -1.12516964 -1.02911646]
mat_Sqrt:  [[11.44674709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018191 -0.02570705 -0.02301281]
Stock Position:  -0.00018191484816935317
Bond Position:  [-2.47378257]


portfolio before change:  [-2.49219312]
curr_Stock_Price:  97.80418616830396
curr_Factors:  [97.80418617 -0.95049792 -1.0784148 ]
mat_Sqrt:  [[12.85913769  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00234347 -0.01966314 -0.48818329]
Stock Position:  -0.0023434692537568744
Bond Position:  [-2.26299202]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.4930845]
Stock Price:  97.94310715891747
PL:  [-2.4930845]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-2.68135053e-02  1.35120911e-02  4.09410761e-02]
 [ 3.29263656e-02  1.70080102e-01 -2.14057738e-01]
 [-6.53850296e-02 -5.04481074e-02 -6.70970892e-02]
 [-1.36953122e-01 -9.46803423e-02  6.03260992e-01]
 [-1.52313156e-02 -1.71735864e-02  2.18112538e-03]
 [-1.07327997e+00  1.13490227e+00 -1.64182479e-01]
 [ 1.13118746e-02 -8.52368793e-03  3.46994695e-02]
 [-9.31262990e-02 -2.19262354e-02 -1.62116749e-02]
 [ 9.90681579e-02  2.61700200e-02  4.81135769e-02]
 [-3.59899128e-02  1.72114117e-01 -1.22082008e-03]
 [ 5.58922311e-02  4.48793158e-02 -5.43276871e-02]
 [-8.23973368e-02  1.27220997e-01  1.21488390e-01]
 [-1.87821728e-01 -1.26432066e-01  3.42273524e-02]
 [ 2.60988486e-02  5.70837211e-01 -3.69241425e-01]
 [-3.32221527e-02 -2.47750984e-01 -6.07370053e-02]
 [ 6.22784061e-02  6.46409761e-02  1.39848938e-01]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 3.69469809e-02 -1.07055673e-01 -4.31995182e-02]
 [-1.25242837e-01  5.56510383e-02 -4.33146680e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.18529926]
curr_Stock_Price:  100.36501028790228
curr_Factors:  [100.36501029  -1.06907959  -1.00177432]
mat_Sqrt:  [[12.65382739  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012406   0.00436101  0.11679349]
Stock Position:  -0.0012405969017729474
Bond Position:  [5.30981178]


portfolio before change:  [5.18589719]
curr_Stock_Price:  100.95317875881072
curr_Factors:  [100.95317876  -1.14137577  -1.03644162]
mat_Sqrt:  [[11.4368368   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00209406  0.05489312 -0.61064714]
Stock Position:  0.0020940640035201925
Bond Position:  [4.97449478]


portfolio before change:  [5.18783945]
curr_Stock_Price:  101.28672909534207
curr_Factors:  [101.2867291   -1.51591474  -0.98962545]
mat_Sqrt:  [[ 8.26818655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01080997 -0.01628206 -0.19140932]
Stock Position:  -0.010809969253243434
Bond Position:  [6.28274588]


portfolio before change:  [5.18592088]
curr_Stock_Price:  101.60952857182473
curr_Factors:  [101.60952857  -1.42638271  -1.00236476]
mat_Sqrt:  [[ 8.95659242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00370002 -0.03055795  1.7209357 ]
Stock Position:  -0.0037000155890620392
Bond Position:  [5.56187772]


portfolio before change:  [5.18762919]
curr_Stock_Price:  101.52367196262988
curr_Factors:  [101.52367196  -1.19960401  -1.03518992]
mat_Sqrt:  [[10.86447257  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168362 -0.00554275  0.00622214]
Stock Position:  -0.0016836195964854777
Bond Position:  [5.35855644]


portfolio before change:  [5.18889363]
curr_Stock_Price:  101.56843829967744
curr_Factors:  [101.5684383   -1.12206239  -1.03130662]
mat_Sqrt:  [[11.79132196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07421836  0.36628813 -0.46836691]
Stock Position:  -0.07421836392634597
Bond Position:  [12.72713695]


portfolio before change:  [5.21694303]
curr_Stock_Price:  101.23338353962603
curr_Factors:  [101.23338354  -1.2110825   -1.03196727]
mat_Sqrt:  [[10.74433684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00155012 -0.00275101  0.09898793]
Stock Position:  0.001550117414379949
Bond Position:  [5.0600194]


portfolio before change:  [5.21701605]
curr_Stock_Price:  100.46432061782575
curr_Factors:  [100.46432062  -0.81147374  -1.03345151]
mat_Sqrt:  [[15.87709339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00635577 -0.00707666 -0.0462474 ]
Stock Position:  -0.006355770848068374
Bond Position:  [5.85554425]


portfolio before change:  [5.2260369]
curr_Stock_Price:  99.27535732442695
curr_Factors:  [99.27535732 -0.74704638 -0.99324677]
mat_Sqrt:  [[17.41974322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00655757 0.00844634 0.13725464]
Stock Position:  0.006557572757350176
Bond Position:  [4.57503152]


portfolio before change:  [5.23226352]
curr_Stock_Price:  100.05044930015295
curr_Factors:  [100.0504493   -0.32196533  -1.01899907]
mat_Sqrt:  [[26.17252408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.22758059e-05  5.55495925e-02 -3.48265987e-03]
Stock Position:  -4.227580588415066e-05
Bond Position:  [5.23649324]


portfolio before change:  [5.23347076]
curr_Stock_Price:  102.46428898340872
curr_Factors:  [102.46428898  -0.72588936  -1.02864877]
mat_Sqrt:  [[17.72500236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00304449  0.01448474 -0.15498177]
Stock Position:  0.0030444898821388702
Bond Position:  [4.92151927]


portfolio before change:  [5.23278821]
curr_Stock_Price:  101.83591051202178
curr_Factors:  [101.83591051  -1.2965764   -1.02969813]
mat_Sqrt:  [[ 9.9451826   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00318041  0.0410604   0.34657256]
Stock Position:  -0.0031804087622453563
Bond Position:  [5.55666803]


portfolio before change:  [5.2374149]
curr_Stock_Price:  100.81800568207947
curr_Factors:  [100.81800568  -1.2775916   -1.01657956]
mat_Sqrt:  [[10.16698607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0203249  -0.04080577  0.09764111]
Stock Position:  -0.02032489622061779
Bond Position:  [7.2865304]


portfolio before change:  [5.2359347]
curr_Stock_Price:  100.98046950173975
curr_Factors:  [100.9804695   -1.07375287  -1.0012029 ]
mat_Sqrt:  [[12.67930776  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00530387  0.18423692 -1.05334301]
Stock Position:  0.005303871259207962
Bond Position:  [4.70034729]


portfolio before change:  [5.23391289]
curr_Stock_Price:  100.37769481307666
curr_Factors:  [100.37769481  -0.77361375  -1.02327847]
mat_Sqrt:  [[16.64396675  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00577939 -0.07996129 -0.17326577]
Stock Position:  -0.0057793914915714424
Bond Position:  [5.81403489]


portfolio before change:  [5.23002625]
curr_Stock_Price:  101.30172589247894
curr_Factors:  [101.30172589  -0.54647485  -0.98652541]
mat_Sqrt:  [[21.86972335  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00475634 0.02086279 0.39895009]
Stock Position:  0.004756335202667754
Bond Position:  [4.74820128]


portfolio before change:  [5.23272726]
curr_Stock_Price:  101.61999794454304
curr_Factors:  [101.61999794  -0.52916433  -0.94543461]
mat_Sqrt:  [[23.25781988  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00295771  0.00525786  0.16709793]
Stock Position:  -0.0029577069678339406
Bond Position:  [5.53328943]


portfolio before change:  [5.23498083]
curr_Stock_Price:  101.3258257771613
curr_Factors:  [101.32582578  -0.52554051  -0.94840972]
mat_Sqrt:  [[23.20554121  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00027046 -0.03455207 -0.1232362 ]
Stock Position:  0.00027046421213572944
Bond Position:  [5.20757582]


portfolio before change:  [5.23632164]
curr_Stock_Price:  101.46913959446663
curr_Factors:  [101.46913959  -0.77324773  -0.97977279]
mat_Sqrt:  [[17.57951291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00652847  0.0179613  -0.01235647]
Stock Position:  -0.006528467203351104
Bond Position:  [5.89875959]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.23862962]
Stock Price:  101.34152919046718
PL:  [3.89710043]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-5.33711847e-03 -7.30566219e-03  3.86055951e-02]
 [ 3.46286292e-02  1.27963400e-01 -1.97978247e-01]
 [ 8.54614574e-02 -5.96287685e-02 -1.47407866e-02]
 [-1.97451770e-01 -1.83366111e-01  5.72453392e-01]
 [-6.43192981e-02  5.52942443e-02 -4.66279325e-02]
 [-1.18674778e+00  1.17207845e+00 -1.61475585e-01]
 [-5.57973314e-04 -1.73392922e-02  1.89551882e-03]
 [-9.07733063e-02 -1.91242037e-02 -1.97734461e-02]
 [ 1.31360307e-01  2.54386807e-02  4.46415456e-02]
 [-5.80158678e-02  1.72388035e-01 -1.81850719e-02]
 [ 1.21091211e-01  3.22800760e-02 -5.27248728e-02]
 [-9.27733357e-02  1.21762404e-01  1.46247493e-01]
 [-1.87718775e-01 -1.24985946e-01  3.30533481e-02]
 [ 2.31743775e-02  4.34801813e-01 -3.07517103e-01]
 [ 2.71568524e-02 -1.60243614e-01 -5.23342715e-02]
 [ 6.24518219e-02  6.28110821e-02  1.44208832e-01]
 [-8.60494190e-02  1.66217705e-02  5.73101602e-02]
 [ 4.13511130e-02 -1.46542731e-01 -4.15330595e-02]
 [-8.50069822e-02  9.91582095e-03 -5.22478822e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.38201333]
curr_Stock_Price:  100.64193169801594
curr_Factors:  [100.6419317   -0.80057221  -1.0208405 ]
mat_Sqrt:  [[16.2835643   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.46021701e-05 -2.35789233e-03  1.10131017e-01]
Stock Position:  6.460217007264104e-05
Bond Position:  [7.37551164]


portfolio before change:  [7.38382997]
curr_Stock_Price:  100.21673107645177
curr_Factors:  [100.21673108  -1.01296265  -1.04181991]
mat_Sqrt:  [[12.8398368   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00158389  0.04130001 -0.56477683]
Stock Position:  0.0015838915053647685
Bond Position:  [7.22509754]


portfolio before change:  [7.38326975]
curr_Stock_Price:  98.72248850359551
curr_Factors:  [98.7224885  -1.14970535 -1.01324684]
mat_Sqrt:  [[11.35162135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00619126 -0.0192451  -0.04205136]
Stock Position:  0.006191259676232264
Bond Position:  [6.77205319]


portfolio before change:  [7.38920974]
curr_Stock_Price:  99.40841720886891
curr_Factors:  [99.40841721 -0.94576306 -1.0229326 ]
mat_Sqrt:  [[13.8812794   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00850279 -0.05918116  1.63305019]
Stock Position:  -0.00850279417553613
Bond Position:  [8.23445905]


portfolio before change:  [7.38987035]
curr_Stock_Price:  99.57286397946196
curr_Factors:  [99.57286398 -0.72482831 -1.01085902]
mat_Sqrt:  [[17.55260464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00356359  0.01784614 -0.13301651]
Stock Position:  -0.0035635904709030255
Bond Position:  [7.74470726]


portfolio before change:  [7.39480156]
curr_Stock_Price:  98.73248033431283
curr_Factors:  [98.73248033 -1.00073858 -1.06089211]
mat_Sqrt:  [[12.5633429   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07804128  0.37828669 -0.4606449 ]
Stock Position:  -0.07804127821364679
Bond Position:  [15.10001052]


portfolio before change:  [7.44312362]
curr_Stock_Price:  98.16167227031092
curr_Factors:  [98.16167227 -0.8839489  -1.05313898]
mat_Sqrt:  [[14.14735897  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00026227 -0.00559623  0.00540739]
Stock Position:  -0.00026226947105894736
Bond Position:  [7.46886843]


portfolio before change:  [7.44450705]
curr_Stock_Price:  100.00718996673778
curr_Factors:  [100.00718997  -1.25192076  -1.08574093]
mat_Sqrt:  [[ 9.65600874  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01022299 -0.00617231 -0.05640814]
Stock Position:  -0.010222987413741292
Bond Position:  [8.46687929]


portfolio before change:  [7.45456838]
curr_Stock_Price:  99.23008425130223
curr_Factors:  [99.23008425 -1.30201602 -1.12480047]
mat_Sqrt:  [[ 8.76375747  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01662134 0.0082103  0.1273499 ]
Stock Position:  0.01662133785567168
Bond Position:  [5.80523162]


portfolio before change:  [7.46365636]
curr_Stock_Price:  99.68952360933663
curr_Factors:  [99.68952361 -1.4339471  -1.13475445]
mat_Sqrt:  [[ 7.6397054   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347387  0.055638   -0.05187695]
Stock Position:  -0.0034738669099961673
Bond Position:  [7.8099645]


portfolio before change:  [7.46656662]
curr_Stock_Price:  99.41388817613262
curr_Factors:  [99.41388818 -1.24440291 -1.08677086]
mat_Sqrt:  [[ 9.66120187  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0121018   0.01041835 -0.15040939]
Stock Position:  0.012101800210295579
Bond Position:  [6.26347961]


portfolio before change:  [7.48390049]
curr_Stock_Price:  100.71681848471407
curr_Factors:  [100.71681848  -1.34386036  -1.13248326]
mat_Sqrt:  [[ 8.46524685  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00449674  0.03929865  0.41720339]
Stock Position:  -0.004496743574937252
Bond Position:  [7.93679819]


portfolio before change:  [7.48829465]
curr_Stock_Price:  100.1809386212219
curr_Factors:  [100.18093862  -1.01816623  -1.13657254]
mat_Sqrt:  [[11.61432414  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01777843 -0.04033904  0.094292  ]
Stock Position:  -0.01777842905261687
Bond Position:  [9.26935436]


portfolio before change:  [7.48250139]
curr_Stock_Price:  100.6371594875696
curr_Factors:  [100.63715949  -0.66757743  -1.15818245]
mat_Sqrt:  [[16.21216192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00303206  0.14033168 -0.8772607 ]
Stock Position:  0.003032060768790668
Bond Position:  [7.1773634]


portfolio before change:  [7.48724082]
curr_Stock_Price:  101.60840345015342
curr_Factors:  [101.60840345  -0.77888026  -1.12800812]
mat_Sqrt:  [[15.09310273  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00107569 -0.0517184  -0.14929511]
Stock Position:  -0.001075685164580905
Bond Position:  [7.59653947]


portfolio before change:  [7.48993668]
curr_Stock_Price:  100.86796280200743
curr_Factors:  [100.8679628   -0.63186995  -1.17604421]
mat_Sqrt:  [[16.54192724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00632995 0.02027219 0.41138766]
Stock Position:  0.006329950764495711
Bond Position:  [6.85144744]


portfolio before change:  [7.48617976]
curr_Stock_Price:  100.00381912252766
curr_Factors:  [100.00381912  -0.40482008  -1.13126504]
mat_Sqrt:  [[21.52302416  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00329685  0.00536465  0.16348994]
Stock Position:  -0.003296847427877234
Bond Position:  [7.8158771]


portfolio before change:  [7.47735377]
curr_Stock_Price:  103.27367276465101
curr_Factors:  [103.27367276  -0.4151253   -1.14675274]
mat_Sqrt:  [[21.66080567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00013667 -0.04729646 -0.11848226]
Stock Position:  0.0001366663406949246
Bond Position:  [7.46323973]


portfolio before change:  [7.47902361]
curr_Stock_Price:  101.83803656977796
curr_Factors:  [101.83803657  -0.45963968  -1.11836679]
mat_Sqrt:  [[21.0179578   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00445562  0.00320032 -0.14904867]
Stock Position:  -0.004455617378342977
Bond Position:  [7.93277493]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.47025394]
Stock Price:  104.2514196747834
PL:  [3.21883426]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-6.10023764e-02  1.20780776e-01  2.18356385e-02]
 [-1.44300260e-02 -7.67241117e-02  1.84415012e-01]
 [ 1.11486642e-01 -2.58410998e-02  1.41314900e-02]
 [-2.22791105e-01 -2.15446848e-01  6.34953104e-01]
 [-5.35892931e-02  3.94537035e-02 -3.59588968e-02]
 [-1.26926615e+00  1.35730508e+00 -2.03365503e-01]
 [ 1.97523475e-03  6.54119373e-03  1.17093806e-02]
 [-7.77148852e-02 -5.61333534e-02  5.12034752e-02]
 [ 1.14164526e-01  2.70601207e-02  5.28603939e-02]
 [-3.13205021e-01  2.31169097e-01 -1.51535148e-01]
 [ 1.18337016e-01  3.32736962e-02 -5.28688181e-02]
 [-6.34661754e-02  1.37180278e-01  7.63150439e-02]
 [-1.88156527e-01 -1.31134758e-01  3.80451418e-02]
 [ 4.18407287e-02  6.61994995e-01 -3.74141260e-01]
 [ 1.02968872e-01 -6.03113338e-02 -4.14906684e-02]
 [ 4.16972301e-02 -1.96604937e-02  9.73994948e-02]
 [-5.99196344e-02  1.57367932e-02  7.17874605e-02]
 [ 5.04111717e-02 -1.83919507e-01 -3.35811001e-02]
 [-1.27763260e-01  5.71352078e-02 -7.47540726e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.70509509]
curr_Stock_Price:  99.3703341239951
curr_Factors:  [99.37033412 -1.2332827  -0.99098094]
mat_Sqrt:  [[10.7466059   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296753  0.03898183  0.062291  ]
Stock Position:  -0.0029675343997643865
Bond Position:  [-2.41021021]


portfolio before change:  [-2.70256693]
curr_Stock_Price:  98.31531887329213
curr_Factors:  [98.31531887 -1.09432225 -1.03657834]
mat_Sqrt:  [[11.67300917  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00064699 -0.0247626   0.5260847 ]
Stock Position:  0.0006469871527141484
Bond Position:  [-2.76617567]


portfolio before change:  [-2.7034528]
curr_Stock_Price:  98.01508325803029
curr_Factors:  [98.01508326 -0.71706296 -1.04501185]
mat_Sqrt:  [[16.82804041  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00648301 -0.00834018  0.04031321]
Stock Position:  0.00648301440526234
Bond Position:  [-3.338886]


portfolio before change:  [-2.69651409]
curr_Stock_Price:  99.2141458545574
curr_Factors:  [99.21414585 -0.76785531 -1.02755238]
mat_Sqrt:  [[16.47547505  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00832509 -0.06953517  1.81134447]
Stock Position:  -0.008325086168567373
Bond Position:  [-1.87054778]


portfolio before change:  [-2.69902574]
curr_Stock_Price:  99.4596636514618
curr_Factors:  [99.45966365 -0.75393032 -1.03855541]
mat_Sqrt:  [[16.56457609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00319211  0.01273363 -0.10258072]
Stock Position:  -0.0031921081671701743
Bond Position:  [-2.38153974]


portfolio before change:  [-2.70719418]
curr_Stock_Price:  101.83207026804776
curr_Factors:  [101.83207027  -0.89899872  -1.12199512]
mat_Sqrt:  [[13.49516194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07659925  0.43806833 -0.58014518]
Stock Position:  -0.07659924535533626
Bond Position:  [5.09306556]


portfolio before change:  [-2.60862884]
curr_Stock_Price:  100.56192826660296
curr_Factors:  [100.56192827  -0.83079915  -1.12236864]
mat_Sqrt:  [[14.26210399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0003997  0.00211116 0.0334036 ]
Stock Position:  0.0003997038333799502
Bond Position:  [-2.64882382]


portfolio before change:  [-2.60882998]
curr_Stock_Price:  101.71565076123186
curr_Factors:  [101.71565076  -0.53661892  -1.13892729]
mat_Sqrt:  [[19.04176971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00413413 -0.01811696  0.14606926]
Stock Position:  -0.004134132151592001
Bond Position:  [-2.18832404]


portfolio before change:  [-2.60256827]
curr_Stock_Price:  100.0686657268014
curr_Factors:  [100.06866573  -0.78807466  -1.14490798]
mat_Sqrt:  [[14.48152899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00900998 0.00873362 0.15079599]
Stock Position:  0.009009976252756584
Bond Position:  [-3.50418457]


portfolio before change:  [-2.59459253]
curr_Stock_Price:  101.05112070785498
curr_Factors:  [101.05112071  -1.09028751  -1.16501473]
mat_Sqrt:  [[10.59438659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02802898  0.07460951 -0.4322876 ]
Stock Position:  -0.02802897612537441
Bond Position:  [0.23776692]


portfolio before change:  [-2.61798938]
curr_Stock_Price:  101.88797941455171
curr_Factors:  [101.88797941  -1.27305476  -1.18325136]
mat_Sqrt:  [[ 8.73700848  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01308654  0.01073904 -0.15082002]
Stock Position:  0.01308653632840122
Bond Position:  [-3.95135012]


portfolio before change:  [-2.61473393]
curr_Stock_Price:  102.21223679484368
curr_Factors:  [102.21223679  -1.03158283  -1.20952688]
mat_Sqrt:  [[10.86929341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182962  0.04427474  0.21770558]
Stock Position:  -0.0018296152836272167
Bond Position:  [-2.42772486]


portfolio before change:  [-2.61373844]
curr_Stock_Price:  101.33636995239988
curr_Factors:  [101.33636995  -1.35094317  -1.16124547]
mat_Sqrt:  [[ 8.21742368  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02520965 -0.04232356  0.1085322 ]
Stock Position:  -0.025209648830381407
Bond Position:  [-0.05908414]


portfolio before change:  [-2.62850234]
curr_Stock_Price:  101.92142869821271
curr_Factors:  [101.9214287   -1.71506426  -1.11407804]
mat_Sqrt:  [[ 6.01983538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01671119  0.21365797 -1.06732087]
Stock Position:  0.01671119224882379
Bond Position:  [-4.33173093]


portfolio before change:  [-2.62363287]
curr_Stock_Price:  102.2776290280236
curr_Factors:  [102.27762903  -1.73287828  -1.12578076]
mat_Sqrt:  [[ 5.86517276  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01401299 -0.0194654  -0.11836133]
Stock Position:  0.014012993105548176
Bond Position:  [-4.05684858]


portfolio before change:  [-2.61850344]
curr_Stock_Price:  102.71606312132336
curr_Factors:  [102.71606312  -1.74920367  -1.11889765]
mat_Sqrt:  [[ 5.83495872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00986565 -0.0063454   0.27785365]
Stock Position:  0.00986564601131163
Bond Position:  [-3.63186376]


portfolio before change:  [-2.61579488]
curr_Stock_Price:  103.08265168359402
curr_Factors:  [103.08265168  -1.78405024  -1.1281608 ]
mat_Sqrt:  [[ 5.60310027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00750546  0.00507903  0.20478964]
Stock Position:  -0.007505455719265734
Bond Position:  [-1.84211261]


portfolio before change:  [-2.61301147]
curr_Stock_Price:  102.65043215604256
curr_Factors:  [102.65043216  -1.537852    -1.13069886]
mat_Sqrt:  [[ 7.11907998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00084478 -0.05935977 -0.09579753]
Stock Position:  0.000844778578647698
Bond Position:  [-2.69972835]


portfolio before change:  [-2.61377087]
curr_Stock_Price:  102.5505417318284
curr_Factors:  [102.55054173  -1.34525774  -1.1382562 ]
mat_Sqrt:  [[ 8.55778875  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01374496  0.01844031 -0.02132526]
Stock Position:  -0.01374496369571225
Bond Position:  [-1.20421739]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.60529386]
Stock Price:  101.91190039864865
PL:  [-4.51719426]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.32913778e-02  3.34053587e-02  3.74537704e-02]
 [ 2.02109380e-02  1.24702556e-01 -5.44626202e-02]
 [-6.09392550e-02  1.23139380e-02 -3.01581955e-03]
 [-1.15791359e-01 -7.09098254e-02  4.76623945e-01]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-8.63257394e-01  8.84096916e-01 -1.14701517e-01]
 [ 1.06940646e-02 -6.63566286e-03  3.12474105e-02]
 [-9.23292029e-02 -1.59421983e-02 -2.93311489e-02]
 [ 8.63410526e-02  3.00866120e-02  5.89407021e-02]
 [ 1.54915919e-01  1.21835106e-01  9.13722654e-02]
 [ 1.23116994e-01  3.23170098e-02 -5.27458588e-02]
 [-3.72381670e-02  1.50978275e-01  1.37300355e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-3.78212569e-02  4.32415502e-02 -8.47003626e-02]
 [-5.99655268e-02 -2.91007346e-01 -6.21598632e-02]
 [ 4.34852598e-02  1.56993752e-02 -5.90773671e-03]
 [ 4.59561280e-02 -1.35719173e-02  1.08850079e-01]
 [-7.84225917e-02  9.50937350e-02  6.18608715e-02]
 [ 1.46945345e-01 -1.78582421e-01 -3.59639082e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.51182104]
curr_Stock_Price:  100.15404885613795
curr_Factors:  [100.15404886  -1.27411668  -0.96687497]
mat_Sqrt:  [[10.65168219  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270636  0.01078153  0.10684518]
Stock Position:  -0.0027063630124596564
Bond Position:  [3.78287426]


portfolio before change:  [3.51065468]
curr_Stock_Price:  100.93450770261298
curr_Factors:  [100.9345077   -1.56039187  -0.96058541]
mat_Sqrt:  [[ 8.11321806  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00425831  0.04024758 -0.1553667 ]
Stock Position:  0.00425831088258056
Bond Position:  [3.08084416]


portfolio before change:  [3.50819744]
curr_Stock_Price:  100.17656694306471
curr_Factors:  [100.17656694  -1.67103631  -0.96537932]
mat_Sqrt:  [[ 7.17439669  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00822944  0.00397431 -0.00860329]
Stock Position:  -0.00822944243522551
Bond Position:  [4.33259473]


portfolio before change:  [3.50320922]
curr_Stock_Price:  100.91434493392622
curr_Factors:  [100.91434493  -1.45954418  -0.92741931]
mat_Sqrt:  [[ 9.27487007  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355534 -0.02288605  1.35967545]
Stock Position:  -0.003555339408448053
Bond Position:  [3.86199397]


portfolio before change:  [3.50679573]
curr_Stock_Price:  100.17717478322429
curr_Factors:  [100.17717478  -1.55209375  -0.91063313]
mat_Sqrt:  [[ 8.53532543  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00665439 -0.04522423  0.24245377]
Stock Position:  0.006654389759873155
Bond Position:  [2.84017776]


portfolio before change:  [3.5135025]
curr_Stock_Price:  101.07833047459789
curr_Factors:  [101.07833047  -1.24650141  -0.9148003 ]
mat_Sqrt:  [[11.64170677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06066166  0.28534105 -0.3272115 ]
Stock Position:  -0.06066165641448533
Bond Position:  [9.64508146]


portfolio before change:  [3.48880572]
curr_Stock_Price:  101.52520844618647
curr_Factors:  [101.52520845  -1.25852059  -0.8833056 ]
mat_Sqrt:  [[11.92313861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00131827 -0.00214165  0.08914016]
Stock Position:  0.001318270047921256
Bond Position:  [3.35496807]


portfolio before change:  [3.4900723]
curr_Stock_Price:  101.84967948860599
curr_Factors:  [101.84967949  -1.21710319  -0.88271347]
mat_Sqrt:  [[12.47443481  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0081423  -0.00514532 -0.0836736 ]
Stock Position:  -0.008142299653340847
Bond Position:  [4.31936291]


portfolio before change:  [3.50486441]
curr_Stock_Price:  100.16561825362207
curr_Factors:  [100.16561825  -1.32438353  -0.87159119]
mat_Sqrt:  [[11.14343215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00937895 0.00971041 0.16814142]
Stock Position:  0.009378948572721537
Bond Position:  [2.56541623]


portfolio before change:  [3.4927692]
curr_Stock_Price:  98.80761474254821
curr_Factors:  [98.80761474 -1.49381672 -0.85616133]
mat_Sqrt:  [[ 9.42340628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02105785 0.03932211 0.26065964]
Stock Position:  0.021057851695840884
Bond Position:  [1.4120931]


portfolio before change:  [3.48755408]
curr_Stock_Price:  98.54319154572839
curr_Factors:  [98.54319155 -1.42386446 -0.86372634]
mat_Sqrt:  [[10.00319105  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0118909   0.01043027 -0.15046925]
Stock Position:  0.01189090282375894
Bond Position:  [2.31578657]


portfolio before change:  [3.4744134]
curr_Stock_Price:  97.3893933433056
curr_Factors:  [97.38939334 -1.02276116 -0.84974667]
mat_Sqrt:  [[14.97241451  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00024159  0.04872803  0.03916797]
Stock Position:  -0.00024159256045035597
Bond Position:  [3.49794195]


portfolio before change:  [3.47574423]
curr_Stock_Price:  95.50094958236757
curr_Factors:  [95.50094958 -1.0007012  -0.85689745]
mat_Sqrt:  [[14.90262754  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00113142 -0.00995959  0.34984664]
Stock Position:  0.0011314195003016235
Bond Position:  [3.36769259]


portfolio before change:  [3.47591932]
curr_Stock_Price:  94.91148355628243
curr_Factors:  [94.91148356 -0.934672   -0.81176766]
mat_Sqrt:  [[16.55196862  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00279628  0.01395615 -0.24162656]
Stock Position:  -0.0027962837914300904
Bond Position:  [3.74131877]


portfolio before change:  [3.47088915]
curr_Stock_Price:  97.04489320727134
curr_Factors:  [97.04489321 -0.73270578 -0.82287374]
mat_Sqrt:  [[20.48297752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00644708 -0.09392222 -0.17732479]
Stock Position:  -0.006447084232645594
Bond Position:  [4.09654575]


portfolio before change:  [3.46791413]
curr_Stock_Price:  97.66521804162596
curr_Factors:  [97.66521804 -0.6365862  -0.79672169]
mat_Sqrt:  [[23.29497325  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00195252  0.00506695 -0.01685313]
Stock Position:  0.0019525229386592878
Bond Position:  [3.27722055]


portfolio before change:  [3.46603763]
curr_Stock_Price:  96.28449131166553
curr_Factors:  [96.28449131 -0.70459506 -0.79845579]
mat_Sqrt:  [[21.41852951  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00305365 -0.00438032  0.31051898]
Stock Position:  0.0030536504109040063
Bond Position:  [3.17201846]


portfolio before change:  [3.46538712]
curr_Stock_Price:  95.81173878468121
curr_Factors:  [95.81173878 -0.68486818 -0.80693784]
mat_Sqrt:  [[21.55438305  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215197  0.03069137  0.17647185]
Stock Position:  -0.002151969122515441
Bond Position:  [3.67157102]


portfolio before change:  [3.47053937]
curr_Stock_Price:  93.84412379757636
curr_Factors:  [93.8441238  -0.50006956 -0.8132802 ]
mat_Sqrt:  [[25.23634944  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00146936 -0.05763723 -1.0259502 ]
Stock Position:  0.001469362330086244
Bond Position:  [3.33264835]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.46797544]
Stock Price:  91.53210125331846
PL:  [3.46797544]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 2.67042791e-02 -3.81860169e-02  3.48809886e-02]
 [ 7.76739188e-02  1.51024868e-01 -2.23882098e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-1.93170215e-01 -1.75921706e-01  5.23770852e-01]
 [-8.25525189e-02  8.22116666e-02 -6.47575497e-02]
 [-1.70824829e+00  1.56034229e+00 -2.19108089e-01]
 [ 1.34314754e-03  1.21680543e-02  1.95302754e-03]
 [-7.11079028e-02 -7.27397271e-02  8.42632960e-02]
 [ 5.42736741e-02  2.51264259e-02  6.12135931e-02]
 [-2.13938940e-02  1.68205066e-01  5.78479601e-03]
 [ 1.02441746e-01  3.19400612e-02 -5.25316741e-02]
 [-1.21774529e-02  1.29919046e-01 -5.34198804e-03]
 [-1.04585819e-01 -8.31015290e-02  6.04182992e-02]
 [ 1.50419269e-02  5.42210021e-01 -3.83876006e-01]
 [ 6.84475149e-02 -1.00401003e-01 -4.65879953e-02]
 [ 4.43204629e-02  1.76452546e-02  4.68374436e-02]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.39944739e-02 -1.91005724e-01 -3.59663515e-02]
 [-1.86396268e-01  1.25438788e-02 -4.16019264e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.11016062]
curr_Stock_Price:  101.4900930746661
curr_Factors:  [101.49009307  -0.77921362  -0.99151541]
mat_Sqrt:  [[17.27451264  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00150682 -0.01232448  0.09950575]
Stock Position:  0.0015068235818850955
Bond Position:  [13.95723295]


portfolio before change:  [14.11202403]
curr_Stock_Price:  100.41078043293196
curr_Factors:  [100.41078043  -0.31291057  -0.99483411]
mat_Sqrt:  [[27.15401437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00231281  0.04874307 -0.63867331]
Stock Position:  0.0023128071626631282
Bond Position:  [13.87979325]


portfolio before change:  [14.1181943]
curr_Stock_Price:  101.57814397716936
curr_Factors:  [101.57814398  -0.35593112  -0.9697661 ]
mat_Sqrt:  [[26.9809532   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00289177  0.01370813 -0.02999186]
Stock Position:  -0.0028917710175650467
Bond Position:  [14.41193503]


portfolio before change:  [14.13314395]
curr_Stock_Price:  97.65451988961954
curr_Factors:  [97.65451989 -0.31664312 -0.95766551]
mat_Sqrt:  [[27.30656946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00447386 -0.05677849  1.49417245]
Stock Position:  -0.0044738613300011
Bond Position:  [14.57003673]


portfolio before change:  [14.12847835]
curr_Stock_Price:  99.51165568372227
curr_Factors:  [99.51165568 -0.37773288 -0.9459739 ]
mat_Sqrt:  [[26.48472098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00298246  0.0265337  -0.18473526]
Stock Position:  -0.0029824634460515922
Bond Position:  [14.42526822]


portfolio before change:  [14.14965375]
curr_Stock_Price:  93.62101215379467
curr_Factors:  [93.62101215  0.21702349 -0.94678914]
mat_Sqrt:  [[45.1273818   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03178713  0.50359831 -0.62505439]
Stock Position:  -0.0317871312818405
Bond Position:  [17.12559715]


portfolio before change:  [13.94742549]
curr_Stock_Price:  100.11767240652888
curr_Factors:  [100.11767241  -0.28205712  -0.94914799]
mat_Sqrt:  [[29.22840799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00014457 0.00392722 0.00557144]
Stock Position:  0.00014457172266242783
Bond Position:  [13.9329513]


portfolio before change:  [13.9511636]
curr_Stock_Price:  101.87759706926244
curr_Factors:  [101.87759707  -0.53143195  -0.95770916]
mat_Sqrt:  [[22.98015362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00299196 -0.02347665  0.24037973]
Stock Position:  -0.002991958421559812
Bond Position:  [14.25597713]


portfolio before change:  [13.95392942]
curr_Stock_Price:  102.14451919889811
curr_Factors:  [102.1445192   -0.46804949  -0.97068141]
mat_Sqrt:  [[24.23160493  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00296711 0.00810952 0.17462534]
Stock Position:  0.0029671066715272845
Bond Position:  [13.65085573]


portfolio before change:  [13.95124277]
curr_Stock_Price:  100.0887154724413
curr_Factors:  [100.08871547  -0.42467152  -0.96469609]
mat_Sqrt:  [[24.94539742  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0005661  0.05428795 0.01650241]
Stock Position:  0.0005661019407102654
Bond Position:  [13.89458235]


portfolio before change:  [13.95475387]
curr_Stock_Price:  100.15410976362463
curr_Factors:  [100.15410976  -1.07224902  -0.97026366]
mat_Sqrt:  [[12.99022845  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00756249  0.01030861 -0.14985824]
Stock Position:  0.007562492133641234
Bond Position:  [13.1973392]


portfolio before change:  [13.9546227]
curr_Stock_Price:  99.70043500438649
curr_Factors:  [99.700435   -0.80225388 -0.95323732]
mat_Sqrt:  [[17.23046149  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00076909  0.04193119 -0.0152392 ]
Stock Position:  0.0007690875055352719
Bond Position:  [13.87794434]


portfolio before change:  [13.95829782]
curr_Stock_Price:  99.96724528361598
curr_Factors:  [99.96724528 -0.41620272 -0.95546364]
mat_Sqrt:  [[25.36007856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00430661 -0.0268209   0.17235659]
Stock Position:  -0.004306611800230426
Bond Position:  [14.38881794]


portfolio before change:  [13.95703946]
curr_Stock_Price:  101.09481860507424
curr_Factors:  [101.09481861  -0.58324068  -0.95509147]
mat_Sqrt:  [[21.7089958   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00218166  0.17499753 -1.0950914 ]
Stock Position:  0.002181663436411131
Bond Position:  [13.73648459]


portfolio before change:  [13.96374635]
curr_Stock_Price:  102.59475057817959
curr_Factors:  [102.59475058  -0.77350805  -0.93574375]
mat_Sqrt:  [[18.5697697   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00207022 -0.03240428 -0.13290258]
Stock Position:  0.0020702201429055327
Bond Position:  [13.75135263]


portfolio before change:  [13.96770863]
curr_Stock_Price:  102.84786780501415
curr_Factors:  [102.84786781  -0.79118003  -0.96134011]
mat_Sqrt:  [[17.82729558  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00322443 0.00569498 0.13361419]
Stock Position:  0.0032244340282793437
Bond Position:  [13.63608247]


portfolio before change:  [13.97188691]
curr_Stock_Price:  103.08630626855586
curr_Factors:  [103.08630627  -0.57787061  -0.9903023 ]
mat_Sqrt:  [[21.48583007  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00320164  0.00525786  0.16709793]
Stock Position:  -0.003201636414324968
Bond Position:  [14.30193178]


portfolio before change:  [13.965979]
curr_Stock_Price:  106.04848981214279
curr_Factors:  [106.04848981  -0.97759362  -0.98339017]
mat_Sqrt:  [[14.92313445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00015654 -0.06164683 -0.10260199]
Stock Position:  -0.00015653595494233969
Bond Position:  [13.9825794]


portfolio before change:  [13.96930587]
curr_Stock_Price:  107.12949695948909
curr_Factors:  [107.12949696  -1.18341473  -0.96337915]
mat_Sqrt:  [[12.51896223  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01536291  0.00404852 -0.11867872]
Stock Position:  -0.015362912133505692
Bond Position:  [15.61512692]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.94617942]
Stock Price:  108.88897565471068
PL:  [5.05720376]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.18001189e-02  3.16050040e-02  3.77693740e-02]
 [ 3.20776815e-02  1.07820421e-01 -1.63896370e-01]
 [-2.73830056e-02  9.67154509e-03 -1.95208644e-02]
 [-2.26864428e-01 -2.21103164e-01  7.46759660e-01]
 [-4.52432220e-02  2.71325277e-02 -2.76602493e-02]
 [-1.37102939e+00  1.22910783e+00 -1.58266555e-01]
 [-3.79258104e-01 -3.77116737e-01 -1.81488971e-01]
 [ 1.52427963e-01 -1.85697195e-01  4.55294139e-02]
 [-1.81378261e-02  2.90601871e-02  5.07769578e-02]
 [ 1.51682933e-01  1.25416338e-01  8.82668049e-02]
 [-1.43595941e-01 -1.02940641e-01  2.51640325e-03]
 [ 8.57932469e-02 -4.01170748e-02 -4.02712525e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-2.67905596e-01  8.95624668e-02 -3.41329946e-01]
 [ 1.21187430e-03  1.45374236e-01  3.43185201e-01]
 [ 8.61282570e-02  3.02542317e-01 -4.95153111e-01]
 [ 4.93388062e-01 -6.88027796e-01  3.07448974e-01]
 [-3.99011176e-01  2.20110690e-01  6.76936636e-01]
 [ 7.44059507e-01 -7.20502968e-01 -1.22793847e+00]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.48995887]
curr_Stock_Price:  100.02523122043772
curr_Factors:  [100.02523122  -0.98159686  -0.99224474]
mat_Sqrt:  [[13.89571985  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198904  0.01020047  0.10774551]
Stock Position:  -0.0019890393262718934
Bond Position:  [2.68891299]


portfolio before change:  [2.49059071]
curr_Stock_Price:  100.04557856964301
curr_Factors:  [100.04557857  -1.08441362  -0.98417544]
mat_Sqrt:  [[12.64215427  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00163194  0.03479889 -0.46755072]
Stock Position:  0.001631939147118322
Bond Position:  [2.32732242]


portfolio before change:  [2.49068121]
curr_Stock_Price:  99.7444605122636
curr_Factors:  [99.74446051 -0.76191712 -0.96906899]
mat_Sqrt:  [[17.6657089   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166387  0.00312148 -0.05568759]
Stock Position:  -0.0016638726296108255
Bond Position:  [2.65664329]


portfolio before change:  [2.49035689]
curr_Stock_Price:  100.33859524098688
curr_Factors:  [100.33859524  -0.92839857  -0.93861721]
mat_Sqrt:  [[15.51077035  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00770853 -0.07136074  2.13029745]
Stock Position:  -0.007708530414808887
Bond Position:  [3.26382]


portfolio before change:  [2.51101118]
curr_Stock_Price:  97.76505229839404
curr_Factors:  [97.7650523  -0.45420636 -0.94594048]
mat_Sqrt:  [[24.10502512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188139  0.00875699 -0.07890699]
Stock Position:  -0.0018813895664151125
Bond Position:  [2.69494533]


portfolio before change:  [2.51791963]
curr_Stock_Price:  94.45120977929335
curr_Factors:  [94.45120978 -0.48633436 -0.97560667]
mat_Sqrt:  [[21.892462    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05264117  0.39669285 -0.45149043]
Stock Position:  -0.05264117054307232
Bond Position:  [7.48994187]


portfolio before change:  [2.5866995]
curr_Stock_Price:  93.18020548441926
curr_Factors:  [93.18020548 -0.22814967 -0.92507956]
mat_Sqrt:  [[29.40915686  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01677311 -0.1217139  -0.51773752]
Stock Position:  -0.0167731097686141
Bond Position:  [4.14962132]


portfolio before change:  [2.57742348]
curr_Stock_Price:  93.79509211198474
curr_Factors:  [93.79509211 -0.13043533 -0.95175343]
mat_Sqrt:  [[31.78275253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00389571 -0.05993351  0.12988274]
Stock Position:  0.0038957083463115657
Bond Position:  [2.21202515]


portfolio before change:  [2.58783287]
curr_Stock_Price:  96.32513842200943
curr_Factors:  [96.32513842 -0.24912303 -0.911339  ]
mat_Sqrt:  [[30.18265128  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.09998475e-05  9.37913507e-03  1.44852527e-01]
Stock Position:  -6.0999847461030736e-05
Bond Position:  [2.59370869]


portfolio before change:  [2.58857828]
curr_Stock_Price:  94.7366261643547
curr_Factors:  [94.73662616 -0.47369593 -0.8974565 ]
mat_Sqrt:  [[24.04550923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00812213 0.04047795 0.25180063]
Stock Position:  0.008122132904450456
Bond Position:  [1.81911481]


portfolio before change:  [2.57893418]
curr_Stock_Price:  93.49324124298687
curr_Factors:  [93.49324124 -0.51246091 -0.89549401]
mat_Sqrt:  [[22.8724751   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00717434 -0.03322395  0.0071786 ]
Stock Position:  -0.007174341724987084
Bond Position:  [3.24968664]


portfolio before change:  [2.59518991]
curr_Stock_Price:  91.34067979319975
curr_Factors:  [91.34067979 -0.35568665 -0.90921203]
mat_Sqrt:  [[25.78254121  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00269113 -0.01294773 -0.11488267]
Stock Position:  0.0026911252745420344
Bond Position:  [2.3493807]


portfolio before change:  [2.58906171]
curr_Stock_Price:  88.84520768866686
curr_Factors:  [ 8.88452077e+01 -3.59516650e-02 -8.84582666e-01]
mat_Sqrt:  [[35.38759324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00047647 -0.00995959  0.34984664]
Stock Position:  0.0004764699111806641
Bond Position:  [2.54672964]


portfolio before change:  [2.58563108]
curr_Stock_Price:  80.30870948635304
curr_Factors:  [80.30870949  0.31151648 -0.85542045]
mat_Sqrt:  [[46.61741154  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00684932  0.02890616 -0.97371933]
Stock Position:  -0.006849316752965835
Bond Position:  [3.13569087]


portfolio before change:  [2.57788712]
curr_Stock_Price:  81.5537942973042
curr_Factors:  [81.5537943  -0.13892146 -0.87315539]
mat_Sqrt:  [[29.64181416  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00340528 0.04691933 0.97901186]
Stock Position:  0.0034052791536012773
Bond Position:  [2.30017369]


portfolio before change:  [2.57716645]
curr_Stock_Price:  81.17327009801218
curr_Factors:  [81.1732701  -0.41150961 -0.86895897]
mat_Sqrt:  [[22.55862405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00207512  0.09764511 -1.412534  ]
Stock Position:  0.0020751151905928685
Bond Position:  [2.40872256]


portfolio before change:  [2.5702345]
curr_Stock_Price:  77.54252956286234
curr_Factors:  [77.54252956 -0.09804286 -0.90414427]
mat_Sqrt:  [[28.46397999  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01460452 -0.22206002  0.87706634]
Stock Position:  0.014604518949899803
Bond Position:  [1.43776316]


portfolio before change:  [2.56925276]
curr_Stock_Price:  77.45069334272159
curr_Factors:  [77.45069334  0.12019594 -0.88957913]
mat_Sqrt:  [[35.88280929  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00601687  0.07104042  1.9311118 ]
Stock Position:  -0.006016868844440739
Bond Position:  [3.03526342]


portfolio before change:  [2.5821801]
curr_Stock_Price:  75.42830732529141
curr_Factors:  [ 7.54283073e+01  6.19727094e-02 -8.64108514e-01]
mat_Sqrt:  [[33.81981348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01024061 -0.23254133 -3.50296667]
Stock Position:  0.01024061128112143
Bond Position:  [1.80974813]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.56718375]
Stock Price:  73.91972093166319
PL:  [2.56718375]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 2.59784729e-02 -4.15451352e-02  4.04302409e-02]
 [ 6.74347699e-02  1.66099325e-01 -2.71840299e-01]
 [-6.34065949e-02 -5.83765671e-02 -7.11889623e-02]
 [-3.20900634e-01 -3.46834936e-01  9.69078232e-01]
 [-3.30127364e-02  9.07685056e-03 -1.54992589e-02]
 [-1.45502259e+00  1.42339018e+00 -2.06277376e-01]
 [ 9.03892017e-03 -5.39613326e-03  3.02724090e-02]
 [-9.28550084e-02 -1.98895760e-02 -2.06768712e-02]
 [ 3.54683360e-02  2.46543179e-02  5.97394983e-02]
 [-1.37382499e-01  1.90230168e-01 -6.01577927e-02]
 [ 1.19939736e-01  3.22590824e-02 -5.27129441e-02]
 [-1.11536530e-01  1.11891487e-01  1.91020038e-01]
 [-1.87718775e-01 -1.24985946e-01  3.30533481e-02]
 [ 4.72682749e-02  6.19529024e-01 -3.20643390e-01]
 [ 2.80641045e-02 -1.58928732e-01 -5.22080125e-02]
 [ 7.49233828e-02  5.63837752e-02  2.92348860e-01]
 [-1.22600614e-02  1.61293492e-02  9.44363453e-02]
 [ 4.14915036e-02 -1.33710684e-01 -3.95364167e-02]
 [-1.01077243e-01  1.60887380e-01 -7.83399761e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.62567963]
curr_Stock_Price:  101.42901860054549
curr_Factors:  [101.4290186   -0.89952688  -0.99551021]
mat_Sqrt:  [[15.24607561  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00168902 -0.01340863  0.11533622]
Stock Position:  0.0016890179954490569
Bond Position:  [13.4543642]


portfolio before change:  [13.62710463]
curr_Stock_Price:  100.28100467876236
curr_Factors:  [100.28100468  -0.4376747   -0.99794562]
mat_Sqrt:  [[23.86364039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00192135  0.05360833 -0.77548471]
Stock Position:  0.0019213532919858307
Bond Position:  [13.43442939]


portfolio before change:  [13.63505124]
curr_Stock_Price:  102.66868953464083
curr_Factors:  [102.66868953  -0.3123292   -1.01970013]
mat_Sqrt:  [[27.09848635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331583 -0.01884096 -0.20308229]
Stock Position:  -0.0033158327243482696
Bond Position:  [13.97548344]


portfolio before change:  [13.64898631]
curr_Stock_Price:  99.51993115370672
curr_Factors:  [99.51993115 -0.35386515 -1.04108013]
mat_Sqrt:  [[24.66567638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00786055 -0.11194049  2.76451046]
Stock Position:  -0.007860548807710177
Bond Position:  [14.43126758]


portfolio before change:  [13.67316708]
curr_Stock_Price:  96.9027470785656
curr_Factors:  [96.90274708 -0.32272685 -1.05882189]
mat_Sqrt:  [[24.34092595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00141012  0.00292954 -0.04421507]
Stock Position:  -0.0014101232249391419
Bond Position:  [13.80981189]


portfolio before change:  [13.67573389]
curr_Stock_Price:  97.53111106382666
curr_Factors:  [97.53111106 -0.54382921 -1.07423231]
mat_Sqrt:  [[19.33873127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06239192  0.45939721 -0.58845194]
Stock Position:  -0.06239191520327667
Bond Position:  [19.7608867]


portfolio before change:  [13.45912772]
curr_Stock_Price:  101.08200400390832
curr_Factors:  [101.082004    -0.66199686  -1.09970598]
mat_Sqrt:  [[17.36105128  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00081313 -0.00174159  0.08635876]
Stock Position:  0.000813128678818066
Bond Position:  [13.37693504]


portfolio before change:  [13.46230354]
curr_Stock_Price:  100.87437961911075
curr_Factors:  [100.87437962  -0.96373404  -1.10937945]
mat_Sqrt:  [[12.68934269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00797012 -0.00641933 -0.05898536]
Stock Position:  -0.007970121244736884
Bond Position:  [14.26628458]


portfolio before change:  [13.46698425]
curr_Stock_Price:  100.73464704323928
curr_Factors:  [100.73464704  -1.36042326  -1.03695501]
mat_Sqrt:  [[ 9.16243095  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00575122 0.00795715 0.17042016]
Stock Position:  0.005751219506564829
Bond Position:  [12.88763718]


portfolio before change:  [13.46812234]
curr_Stock_Price:  100.37225161433172
curr_Factors:  [100.37225161  -1.34803836  -1.03827524]
mat_Sqrt:  [[ 9.23104442  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0120064   0.06139652 -0.17161344]
Stock Position:  -0.012006397307164782
Bond Position:  [14.67323148]


portfolio before change:  [13.47530462]
curr_Stock_Price:  100.07961511777795
curr_Factors:  [100.07961512  -1.37853365  -0.99543517]
mat_Sqrt:  [[ 9.31845834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01242315  0.01041157 -0.15037536]
Stock Position:  0.012423150378279837
Bond Position:  [12.23200051]


portfolio before change:  [13.48167099]
curr_Stock_Price:  100.34589103841712
curr_Factors:  [100.34589104  -1.59413417  -0.97794969]
mat_Sqrt:  [[ 7.66404     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00648548  0.03611282  0.544927  ]
Stock Position:  -0.006485479442550423
Bond Position:  [14.1324622]


portfolio before change:  [13.48852605]
curr_Stock_Price:  99.83374677423899
curr_Factors:  [99.83374677 -1.6942285  -0.92578274]
mat_Sqrt:  [[ 7.26810084  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02840968 -0.04033904  0.094292  ]
Stock Position:  -0.028409682576647395
Bond Position:  [16.3247711]


portfolio before change:  [13.47711607]
curr_Stock_Price:  100.37904262583764
curr_Factors:  [100.37904263  -1.7713728   -0.95862618]
mat_Sqrt:  [[ 6.54665654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01653944  0.19995213 -0.91470634]
Stock Position:  0.016539442523726026
Bond Position:  [11.81690266]


portfolio before change:  [13.48446289]
curr_Stock_Price:  100.64460315754917
curr_Factors:  [100.64460316  -1.76046773  -0.93518193]
mat_Sqrt:  [[ 6.79336145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00221304 -0.05129403 -0.14893493]
Stock Position:  -0.0022130432989945496
Bond Position:  [13.70719375]


portfolio before change:  [13.48870866]
curr_Stock_Price:  100.27472966591856
curr_Factors:  [100.27472967  -1.71459787  -0.93272882]
mat_Sqrt:  [[ 7.10349579  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02056848 0.01819779 0.83398992]
Stock Position:  0.020568483203390237
Bond Position:  [11.42620957]


portfolio before change:  [13.50903515]
curr_Stock_Price:  101.12406684080165
curr_Factors:  [101.12406684  -1.95611498  -0.95389347]
mat_Sqrt:  [[ 5.50876078  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00187139 0.00520573 0.26940061]
Stock Position:  0.0018713948307117693
Bond Position:  [13.31979209]


portfolio before change:  [13.51235427]
curr_Stock_Price:  101.11805903681048
curr_Factors:  [101.11805904  -1.48565782  -0.91852537]
mat_Sqrt:  [[ 9.13493011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00067079 -0.04315494 -0.11278639]
Stock Position:  0.0006707864336291187
Bond Position:  [13.44452564]


portfolio before change:  [13.51582373]
curr_Stock_Price:  101.27893759819904
curr_Factors:  [101.2789376   -1.4836081   -0.94926704]
mat_Sqrt:  [[ 8.89067814  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0078549   0.05192618 -0.02234821]
Stock Position:  -0.007854896022173449
Bond Position:  [14.31135926]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.51968874]
Stock Price:  101.24243566392867
PL:  [12.27725308]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 5.54015250e-03 -2.35357215e-02  4.50793500e-02]
 [ 2.81573705e-02  1.58716915e-01 -2.08872796e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-2.61189052e-01 -2.64139627e-01  9.18843263e-01]
 [ 6.75435309e-04 -4.06564772e-02  1.79974920e-02]
 [-1.09541419e+00  1.18788734e+00 -1.70938007e-01]
 [-2.61747767e-02 -1.05925844e-01 -1.08352436e-02]
 [-1.02854928e-02 -2.21988333e-01  3.80838390e-01]
 [-1.49548827e-02 -4.15646851e-02 -4.07753066e-02]
 [-8.78134352e-01  3.59930420e-01 -4.48293824e-01]
 [ 5.73449564e-02  5.17304239e-02 -5.64580301e-02]
 [ 1.20367254e-02  3.60909676e-02 -1.24378966e-02]
 [ 1.76234102e-02  3.60582597e-02 -6.30076812e-04]
 [-3.67918796e-02  1.08874327e-02 -4.88314386e-02]
 [ 4.38153927e-03  7.42935681e-02 -3.58882174e-02]
 [ 5.74236809e-02  1.22553410e-01 -2.01809120e-01]
 [ 8.94990880e-02 -2.08183123e-01  1.48010861e-01]
 [-1.12130783e-01  1.15131101e-01  1.03571723e-01]
 [ 1.98942775e-01 -2.42915677e-01 -4.37560135e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.17797341]
curr_Stock_Price:  100.86833339600707
curr_Factors:  [100.8683334   -0.95015472  -0.98789813]
mat_Sqrt:  [[14.52342959  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00068425 -0.00759612  0.12859884]
Stock Position:  0.0006842548584882087
Bond Position:  [9.10895376]


portfolio before change:  [9.18063017]
curr_Stock_Price:  101.42257221882367
curr_Factors:  [101.42257222  -1.08365337  -0.98389609]
mat_Sqrt:  [[12.82948732  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00139673  0.05122566 -0.59585595]
Stock Position:  0.001396731115655406
Bond Position:  [9.03897011]


portfolio before change:  [9.18216781]
curr_Stock_Price:  100.90537492036746
curr_Factors:  [100.90537492  -1.06053368  -0.94796495]
mat_Sqrt:  [[13.54049152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00576218  0.01370813 -0.02999186]
Stock Position:  -0.005762179193829448
Bond Position:  [9.76360266]


portfolio before change:  [9.18362294]
curr_Stock_Price:  101.07650286029649
curr_Factors:  [101.07650286  -0.84696124  -0.90763378]
mat_Sqrt:  [[17.48393849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00729517 -0.0852507   2.62120407]
Stock Position:  -0.007295165870476057
Bond Position:  [9.9209928]


portfolio before change:  [9.17691521]
curr_Stock_Price:  102.33600723378551
curr_Factors:  [102.33600723  -0.6592262   -0.89554136]
mat_Sqrt:  [[21.61730217  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018272 -0.01312182  0.05134184]
Stock Position:  -0.00018271524553290552
Bond Position:  [9.19561356]


portfolio before change:  [9.17910202]
curr_Stock_Price:  102.95105662831965
curr_Factors:  [102.95105663  -0.71383296  -0.90251877]
mat_Sqrt:  [[20.44834534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0434182   0.38338899 -0.48763855]
Stock Position:  -0.04341819630844691
Bond Position:  [13.64905121]


portfolio before change:  [9.05749887]
curr_Stock_Price:  105.83039863185736
curr_Factors:  [105.83039863  -0.75416307  -0.89494584]
mat_Sqrt:  [[20.34283762  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00245829 -0.03418742 -0.03090993]
Stock Position:  -0.002458287024407836
Bond Position:  [9.31766037]


portfolio before change:  [9.05993679]
curr_Stock_Price:  105.78638135009082
curr_Factors:  [105.78638135  -0.81385894  -0.89490898]
mat_Sqrt:  [[19.15672582  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115571 -0.07164643  1.08642592]
Stock Position:  0.0011557110257872595
Bond Position:  [8.9376783]


portfolio before change:  [9.0623239]
curr_Stock_Price:  105.91825711280232
curr_Factors:  [105.91825711  -0.98138639  -0.8886738 ]
mat_Sqrt:  [[16.32352705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00194581 -0.01341494 -0.1163206 ]
Stock Position:  -0.0019458088316657825
Bond Position:  [9.26842058]


portfolio before change:  [9.06650706]
curr_Stock_Price:  104.95938972130284
curr_Factors:  [104.95938972  -0.87343244  -0.87548146]
mat_Sqrt:  [[18.25902735  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04908101  0.11616704 -1.2788575 ]
Stock Position:  -0.04908100739920042
Bond Position:  [14.21801965]


portfolio before change:  [9.16896513]
curr_Stock_Price:  102.9442901268684
curr_Factors:  [102.94429013  -0.39768822  -0.86195016]
mat_Sqrt:  [[29.21112363  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00193008  0.01669592 -0.16105905]
Stock Position:  0.0019300845307863867
Bond Position:  [8.97027395]


portfolio before change:  [9.16830682]
curr_Stock_Price:  101.44116510856256
curr_Factors:  [101.44116511  -0.25179091  -0.86609926]
mat_Sqrt:  [[33.16810764  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00050847  0.01164831 -0.03548186]
Stock Position:  0.0005084670042617687
Bond Position:  [9.11672734]


portfolio before change:  [9.17013071]
curr_Stock_Price:  100.545178705956
curr_Factors:  [ 1.00545179e+02 -8.73802386e-02 -8.27763739e-01]
mat_Sqrt:  [[40.26421817  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0006173   0.01163775 -0.00179743]
Stock Position:  0.0006173013883166982
Bond Position:  [9.10806403]


portfolio before change:  [9.16858078]
curr_Stock_Price:  94.345245392771
curr_Factors:  [ 9.43452454e+01 -2.88769075e-02 -8.22729296e-01]
mat_Sqrt:  [[40.25984916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00110624  0.0035139  -0.1393025 ]
Stock Position:  -0.0011062427776619306
Bond Position:  [9.27294953]


portfolio before change:  [9.17404491]
curr_Stock_Price:  91.5017450664525
curr_Factors:  [ 9.15017451e+01  1.76179202e-02 -8.28512752e-01]
mat_Sqrt:  [[40.66888127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0003005   0.02397815 -0.10237909]
Stock Position:  0.0003004999960721947
Bond Position:  [9.14654864]


portfolio before change:  [9.17602399]
curr_Stock_Price:  90.47728745455672
curr_Factors:  [90.47728745  0.24867592 -0.82092277]
mat_Sqrt:  [[51.05237164  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00080791  0.03955394 -0.57570525]
Stock Position:  0.000807909127067878
Bond Position:  [9.10292656]


portfolio before change:  [9.18030498]
curr_Stock_Price:  92.95897471873913
curr_Factors:  [92.95897472  0.14460182 -0.82159073]
mat_Sqrt:  [[47.23661565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00163467 -0.06719081  0.42223379]
Stock Position:  0.0016346741898939793
Bond Position:  [9.02834734]


portfolio before change:  [9.18526657]
curr_Stock_Price:  94.6132634806214
curr_Factors:  [94.61326348 -0.19320597 -0.84083271]
mat_Sqrt:  [[33.64145208  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0020061  0.0371584  0.2954613]
Stock Position:  -0.0020061041439142927
Bond Position:  [9.37507063]


portfolio before change:  [9.19216625]
curr_Stock_Price:  92.34238601441926
curr_Factors:  [ 9.23423860e+01 -5.92191878e-02 -8.05579415e-01]
mat_Sqrt:  [[38.8887363   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00154392 -0.0784007  -1.24823727]
Stock Position:  0.0015439234467730435
Bond Position:  [9.04959667]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.19241782]
Stock Price:  91.03978591796233
PL:  [9.19241782]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-2.77711331e-03 -1.52448142e-02  4.56758633e-02]
 [ 2.48786546e-02  5.97750490e-02 -1.04838653e-01]
 [ 3.25568110e-02 -2.43365868e-02 -3.13132844e-02]
 [-3.17443109e-01 -3.42341850e-01  9.67235086e-01]
 [ 1.40726201e-02 -6.04345342e-02  3.13185521e-02]
 [-1.23895737e+00  1.22388721e+00 -1.72886960e-01]
 [ 1.00288018e-02 -4.60262257e-03  2.75302061e-02]
 [-6.82569235e-02 -7.67550654e-02  9.17811184e-02]
 [ 3.68890419e-02  2.37978225e-02  6.01086016e-02]
 [-3.33152625e-01  2.36907540e-01 -1.60659148e-01]
 [ 8.07256120e-02  4.60462013e-02 -5.47029461e-02]
 [-2.64157975e-02  1.48338555e-01 -2.18304726e-03]
 [-1.37605445e-01 -1.09431430e-01 -2.83901672e-02]
 [ 2.42232182e-02  5.51422300e-01 -3.62369700e-01]
 [ 4.13446527e-02 -1.39681216e-01 -5.03598053e-02]
 [ 4.72160736e-02  1.83156618e-02  7.63911167e-02]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.16315432e-02 -1.40603382e-01 -4.19734714e-02]
 [-1.51630571e-01  3.89837407e-02 -2.13670405e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.46740208]
curr_Stock_Price:  100.65269594505659
curr_Factors:  [100.65269595  -0.95721642  -1.01607326]
mat_Sqrt:  [[13.99060801  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00024549 -0.00492024  0.13030052]
Stock Position:  0.00024549316028623063
Bond Position:  [7.44269253]


portfolio before change:  [7.46896798]
curr_Stock_Price:  99.45099378260059
curr_Factors:  [99.45099378 -0.99136782 -1.03863415]
mat_Sqrt:  [[13.06142235  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120049  0.01929231 -0.29907549]
Stock Position:  0.001200488325249146
Bond Position:  [7.34957822]


portfolio before change:  [7.47082029]
curr_Stock_Price:  99.46322848858274
curr_Factors:  [99.46322849 -0.64610496 -1.01795605]
mat_Sqrt:  [[18.83519146  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112541 -0.0078546  -0.08932808]
Stock Position:  0.0011254108365980687
Bond Position:  [7.35888329]


portfolio before change:  [7.47313871]
curr_Stock_Price:  99.88838302423387
curr_Factors:  [99.88838302 -0.49409812 -1.0113522 ]
mat_Sqrt:  [[22.16696408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00856623 -0.11049036  2.75925247]
Stock Position:  -0.00856622993188313
Bond Position:  [8.32880557]


portfolio before change:  [7.49850424]
curr_Stock_Price:  97.17037636940546
curr_Factors:  [97.17037637 -0.55057603 -0.99863447]
mat_Sqrt:  [[20.64050479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00039385 -0.01950516  0.08934311]
Stock Position:  0.00039385398686729464
Bond Position:  [7.4602333]


portfolio before change:  [7.50098848]
curr_Stock_Price:  98.74188832163624
curr_Factors:  [98.74188832 -0.79572656 -1.00844332]
mat_Sqrt:  [[16.2540056   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06302587  0.3950079  -0.49319838]
Stock Position:  -0.06302586968794788
Bond Position:  [13.72428187]


portfolio before change:  [7.27675152]
curr_Stock_Price:  102.35419015300961
curr_Factors:  [102.35419015  -0.97921539  -1.01496393]
mat_Sqrt:  [[13.93299721  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00105569 -0.00148549  0.07853602]
Stock Position:  0.0010556863682265201
Bond Position:  [7.16869759]


portfolio before change:  [7.27915745]
curr_Stock_Price:  102.93536448070721
curr_Factors:  [102.93536448  -0.96285978  -1.00556566]
mat_Sqrt:  [[14.37766293  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0045341  -0.02477259  0.26182598]
Stock Position:  -0.004534098730612936
Bond Position:  [7.74587656]


portfolio before change:  [7.28704896]
curr_Stock_Price:  101.622028331777
curr_Factors:  [101.62202833  -0.88973146  -0.97912026]
mat_Sqrt:  [[15.68035428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00344484 0.00768071 0.17147311]
Stock Position:  0.0034448436582874536
Bond Position:  [6.93697696]


portfolio before change:  [7.28894942]
curr_Stock_Price:  101.67021553020794
curr_Factors:  [101.67021553  -0.68149035  -0.98750156]
mat_Sqrt:  [[19.15842349  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01657696  0.07646158 -0.45831583]
Stock Position:  -0.016576963533887903
Bond Position:  [8.97433287]


portfolio before change:  [7.27044152]
curr_Stock_Price:  102.92205891395211
curr_Factors:  [102.92205891  -0.74983783  -0.9785688 ]
mat_Sqrt:  [[18.27557308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00432044  0.01486135 -0.15605228]
Stock Position:  0.004320442427157653
Bond Position:  [6.82577269]


portfolio before change:  [7.26556545]
curr_Stock_Price:  101.39843489122337
curr_Factors:  [101.39843489  -0.84948694  -0.97492209]
mat_Sqrt:  [[16.35688037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00020897  0.04787606 -0.00622763]
Stock Position:  0.00020896836407277217
Bond Position:  [7.24437638]


portfolio before change:  [7.26731973]
curr_Stock_Price:  101.12550489852498
curr_Factors:  [101.1255049   -1.01951027  -0.95700435]
mat_Sqrt:  [[14.01107031  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01182909 -0.03531884 -0.08098924]
Stock Position:  -0.011829086358397734
Bond Position:  [8.46354206]


portfolio before change:  [7.27666843]
curr_Stock_Price:  100.514084634701
curr_Factors:  [100.51408463  -0.95963625  -0.93588244]
mat_Sqrt:  [[15.10127492  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00415948  0.17797078 -1.03373989]
Stock Position:  0.004159477850129596
Bond Position:  [6.85858232]


portfolio before change:  [7.28276445]
curr_Stock_Price:  101.56738038605543
curr_Factors:  [101.56738039  -1.1832018   -0.92953005]
mat_Sqrt:  [[12.28022903  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00020787 -0.04508192 -0.14366251]
Stock Position:  0.0002078700285543813
Bond Position:  [7.26165163]


portfolio before change:  [7.28479274]
curr_Stock_Price:  102.59041440881589
curr_Factors:  [102.59041441  -0.93990569  -0.93461574]
mat_Sqrt:  [[15.7402806   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00422788 0.00591135 0.21792259]
Stock Position:  0.0042278797598958575
Bond Position:  [6.85105281]


portfolio before change:  [7.28791535]
curr_Stock_Price:  102.92382628349377
curr_Factors:  [102.92382628  -0.88954391  -0.94516476]
mat_Sqrt:  [[16.43281896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00418612  0.00525786  0.16709793]
Stock Position:  -0.004186123883495916
Bond Position:  [7.71876723]


portfolio before change:  [7.2873747]
curr_Stock_Price:  103.5140096502338
curr_Factors:  [103.51400965  -0.85286924  -0.95357555]
mat_Sqrt:  [[17.00083022  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00025665 -0.04537955 -0.11973863]
Stock Position:  0.0002566462364276524
Bond Position:  [7.26080822]


portfolio before change:  [7.28927828]
curr_Stock_Price:  103.85747460569439
curr_Factors:  [103.85747461  -0.8546841   -0.92946853]
mat_Sqrt:  [[17.44175233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00848737  0.01258195 -0.06095422]
Stock Position:  -0.008487368365745823
Bond Position:  [8.17075492]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.28460752]
Stock Price:  104.6484967910115
PL:  [2.63611073]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-6.92877281e-02  1.43743902e-01  1.66671870e-02]
 [-1.01913100e-02 -6.20172354e-02  1.54175254e-01]
 [ 1.37907188e-01 -1.60228576e-02  1.40266383e-01]
 [ 1.95731227e-02  2.52631025e-02 -2.17975236e-02]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-6.65804885e-01  6.23951677e-01 -5.19081541e-02]
 [-3.88353120e-03  1.60088617e-02 -2.74819207e-03]
 [-9.31262990e-02 -2.19262354e-02 -1.62116749e-02]
 [ 1.99850740e-02  2.86867485e-02  5.87384073e-02]
 [-7.12004452e-03  1.56898098e-01  4.13038160e-03]
 [ 1.21918864e-01  3.22951656e-02 -5.27334468e-02]
 [-1.30094343e-01  1.02128616e-01  2.35302505e-01]
 [-1.87718775e-01 -1.24985946e-01  3.30533481e-02]
 [ 4.60204786e-02  5.24245699e-01 -2.45733265e-01]
 [-5.96396554e-02 -2.79231872e-01 -6.54332122e-02]
 [ 6.40220554e-02  3.66767083e-02  1.96326425e-01]
 [-1.63790114e-02  1.90942964e-02  8.60866349e-02]
 [ 3.68398243e-03 -4.15394890e-02 -7.82110394e-03]
 [-9.98754589e-02  1.79607304e-01 -1.05248948e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.1521623]
curr_Stock_Price:  99.31397609219574
curr_Factors:  [99.31397609 -1.11229426 -1.01676538]
mat_Sqrt:  [[11.81330772  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309346  0.04639314  0.04754685]
Stock Position:  -0.003093456348224508
Bond Position:  [-2.84493885]


portfolio before change:  [-3.1501843]
curr_Stock_Price:  98.44461882000329
curr_Factors:  [98.44461882 -1.09218244 -1.03065742]
mat_Sqrt:  [[11.78295844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0007316  -0.02001598  0.43981908]
Stock Position:  0.0007315961240357465
Bond Position:  [-3.22220601]


portfolio before change:  [-3.15189936]
curr_Stock_Price:  97.20157541872899
curr_Factors:  [97.20157542 -1.14751508 -1.00856474]
mat_Sqrt:  [[11.25381401  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01450782 -0.00517136  0.40014095]
Stock Position:  0.014507818485438341
Bond Position:  [-4.56208218]


portfolio before change:  [-3.1512716]
curr_Stock_Price:  97.32346991129428
curr_Factors:  [97.32346991 -1.01453518 -1.0202579 ]
mat_Sqrt:  [[12.72090992  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00159427  0.00815363 -0.06218227]
Stock Position:  0.001594267327599785
Bond Position:  [-3.30643123]


portfolio before change:  [-3.15209885]
curr_Stock_Price:  97.32313500441172
curr_Factors:  [97.323135   -1.03592399 -1.07801865]
mat_Sqrt:  [[11.75283033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00483266 -0.04522423  0.24245377]
Stock Position:  0.004832655668937664
Bond Position:  [-3.62242805]


portfolio before change:  [-3.14441436]
curr_Stock_Price:  99.10066774034104
curr_Factors:  [99.10066774 -1.93085351 -1.07337454]
mat_Sqrt:  [[ 4.91311481  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11174927  0.20137954 -0.14807952]
Stock Position:  -0.11174926929175556
Bond Position:  [7.93001284]


portfolio before change:  [-3.1560545]
curr_Stock_Price:  99.22257358973509
curr_Factors:  [99.22257359 -2.12530966 -1.06928828]
mat_Sqrt:  [[ 4.06643871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00028937  0.00516684 -0.00783983]
Stock Position:  -0.0002893707343302395
Bond Position:  [-3.12734239]


portfolio before change:  [-3.15697577]
curr_Stock_Price:  99.70406753801184
curr_Factors:  [99.70406754 -2.26697441 -1.06212417]
mat_Sqrt:  [[ 3.57193654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02825111 -0.00707666 -0.0462474 ]
Stock Position:  -0.028251108652182298
Bond Position:  [-0.34022532]


portfolio before change:  [-3.16167262]
curr_Stock_Price:  99.86731018566252
curr_Factors:  [99.86731019 -2.20845188 -1.02547502]
mat_Sqrt:  [[ 3.93501821  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00961385 0.00925861 0.16756433]
Stock Position:  0.009613846035788447
Bond Position:  [-4.12178156]


portfolio before change:  [-3.1652375]
curr_Stock_Price:  99.60369957030063
curr_Factors:  [99.60369957 -2.2436666  -1.00224181]
mat_Sqrt:  [[ 3.87788886  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00664015 0.05063864 0.01178283]
Stock Position:  0.006640148081958468
Bond Position:  [-3.82662082]


portfolio before change:  [-3.16732549]
curr_Stock_Price:  99.43333973422035
curr_Factors:  [99.43333973 -1.84154359 -0.97205904]
mat_Sqrt:  [[ 5.96485559  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01974011  0.01042322 -0.15043385]
Stock Position:  0.019740111920663123
Bond Position:  [-5.13015075]


portfolio before change:  [-3.17139134]
curr_Stock_Price:  99.29235042586707
curr_Factors:  [99.29235043 -1.78575679 -0.94246669]
mat_Sqrt:  [[ 6.48729108  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00943637  0.03296187  0.67125255]
Stock Position:  -0.009436373898000599
Bond Position:  [-2.23443159]


portfolio before change:  [-3.17415937]
curr_Stock_Price:  99.5264824370697
curr_Factors:  [99.52648244 -2.02442368 -0.92653647]
mat_Sqrt:  [[ 5.20418762  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03967659 -0.04033904  0.094292  ]
Stock Position:  -0.039676593717941674
Bond Position:  [0.77471244]


portfolio before change:  [-3.15471149]
curr_Stock_Price:  99.04120439270046
curr_Factors:  [99.04120439 -1.54370963 -0.88574637]
mat_Sqrt:  [[ 8.72401849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01179177  0.16919957 -0.70100861]
Stock Position:  0.011791766726597588
Bond Position:  [-4.32258227]


portfolio before change:  [-3.15815991]
curr_Stock_Price:  98.84041695161095
curr_Factors:  [98.84041695 -1.58831546 -0.86081484]
mat_Sqrt:  [[ 8.53671524  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01522765 -0.0901217  -0.18666274]
Stock Position:  -0.015227651085153953
Bond Position:  [-1.65305253]


portfolio before change:  [-3.1606013]
curr_Stock_Price:  98.9736008693298
curr_Factors:  [98.97360087 -1.61757397 -0.91080836]
mat_Sqrt:  [[ 7.8969044   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01413005 0.01183736 0.56006464]
Stock Position:  0.014130045810919234
Bond Position:  [-4.55910282]


portfolio before change:  [-3.16410253]
curr_Stock_Price:  98.80648814806983
curr_Factors:  [98.80648815 -1.27046201 -0.89783471]
mat_Sqrt:  [[11.3007213   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0004505  0.00616266 0.24558121]
Stock Position:  0.0004504983498817859
Bond Position:  [-3.20861469]


portfolio before change:  [-3.16507427]
curr_Stock_Price:  98.43028007943938
curr_Factors:  [98.43028008 -1.27900013 -0.86179637]
mat_Sqrt:  [[11.57157871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055236 -0.01340681 -0.02231143]
Stock Position:  -0.0005523625233160126
Bond Position:  [-3.11070507]


portfolio before change:  [-3.16631013]
curr_Stock_Price:  99.2596104856063
curr_Factors:  [99.25961049 -1.32013139 -0.86144167]
mat_Sqrt:  [[11.20282173  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00583439  0.05796801 -0.0300246 ]
Stock Position:  -0.005834392280105063
Bond Position:  [-2.58719063]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.16322118]
Stock Price:  98.61929947984812
PL:  [-3.16322118]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-5.65886646e-02  9.90061761e-02  2.57277924e-02]
 [ 3.82639625e-02  1.78292670e-01 -2.57457104e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-2.36188146e-01 -2.34807248e-01  7.58818077e-01]
 [-4.41168438e-02  2.54696729e-02 -2.65402713e-02]
 [-1.03033004e+00  9.93962707e-01 -1.29707161e-01]
 [ 1.06416027e-02 -6.47533964e-03  3.09542760e-02]
 [-3.85879687e-02 -1.54413296e-01  2.46848654e-01]
 [ 4.65355866e-02 -2.24028636e-02 -1.37144117e-02]
 [-1.19072946e+00  4.04398820e-01 -5.69948965e-01]
 [ 1.36861558e-01  5.32799191e-02 -6.24595398e-02]
 [-1.59853175e-01 -1.55574800e-01 -2.77000486e-02]
 [ 2.46185267e-01  2.02371254e-01 -7.62665995e-02]
 [ 1.47467806e-02  1.33794832e+00 -8.06926576e-01]
 [ 1.69782562e-01 -1.54190876e-01  1.78902485e-02]
 [ 1.27097118e-02 -3.90327379e-02 -1.57228740e-01]
 [-6.96795567e-02  1.77340852e-02  5.07468453e-02]
 [ 3.54750239e-02 -1.84330747e-01 -4.06892727e-02]
 [-1.76023013e-01  2.04329029e-02 -3.55643192e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.77315158]
curr_Stock_Price:  99.80880765329493
curr_Factors:  [99.80880765 -0.81296249 -0.98146242]
mat_Sqrt:  [[16.59052122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00187622  0.03195411  0.07339423]
Stock Position:  -0.0018762189266979324
Bond Position:  [0.96041475]


portfolio before change:  [0.77178894]
curr_Stock_Price:  100.66306628113696
curr_Factors:  [100.66306628  -0.90514288  -0.95205378]
mat_Sqrt:  [[15.71447556  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00140664  0.05754371 -0.73445346]
Stock Position:  0.001406638734121387
Bond Position:  [0.63019237]


portfolio before change:  [0.77196949]
curr_Stock_Price:  100.67940289564072
curr_Factors:  [100.6794029   -0.88276194  -0.94317322]
mat_Sqrt:  [[16.21612431  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00481143  0.01370813 -0.02999186]
Stock Position:  -0.0048114294772565016
Bond Position:  [1.25638133]


portfolio before change:  [0.77473087]
curr_Stock_Price:  100.17076999296708
curr_Factors:  [100.17076999  -0.87464738  -0.90801863]
mat_Sqrt:  [[16.84763711  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00767021 -0.07578371  2.16469676]
Stock Position:  -0.007670208160043464
Bond Position:  [1.54306153]


portfolio before change:  [0.78512193]
curr_Stock_Price:  98.86634015770844
curr_Factors:  [98.86634016 -0.67161819 -0.89565807]
mat_Sqrt:  [[20.62476586  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214962  0.0082203  -0.07571201]
Stock Position:  -0.002149618525030637
Bond Position:  [0.99764685]


portfolio before change:  [0.78515062]
curr_Stock_Price:  98.9690356406232
curr_Factors:  [98.96903564 -0.85265897 -0.86897609]
mat_Sqrt:  [[17.693051    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04826271  0.32080008 -0.37001843]
Stock Position:  -0.04826271168871726
Bond Position:  [5.56166465]


portfolio before change:  [0.63406037]
curr_Stock_Price:  102.12842790955084
curr_Factors:  [102.12842791  -0.42528223  -0.90895955]
mat_Sqrt:  [[26.89631657  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00058143 -0.00208991  0.08830393]
Stock Position:  0.0005814307187676864
Bond Position:  [0.57467977]


portfolio before change:  [0.63495413]
curr_Stock_Price:  103.41846298580077
curr_Factors:  [103.41846299  -0.41726728  -0.8958254 ]
mat_Sqrt:  [[27.81820954  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00070888 -0.04983668  0.7041905 ]
Stock Position:  -0.0007088766912433172
Bond Position:  [0.70826506]


portfolio before change:  [0.63392676]
curr_Stock_Price:  105.1175646199653
curr_Factors:  [105.11756462  -0.29845075  -0.9139172 ]
mat_Sqrt:  [[31.27163448  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00125235 -0.00723049 -0.0391234 ]
Stock Position:  0.0012523547086290626
Bond Position:  [0.50228228]


portfolio before change:  [0.6382325]
curr_Stock_Price:  108.45540108266958
curr_Factors:  [108.45540108  -0.36765382  -0.925242  ]
mat_Sqrt:  [[29.76827483  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04113514  0.13051916 -1.62590575]
Stock Position:  -0.041135143049186446
Bond Position:  [5.09956094]


portfolio before change:  [0.74131276]
curr_Stock_Price:  105.9805048835292
curr_Factors:  [ 1.05980505e+02  1.14909944e-02 -8.93645288e-01]
mat_Sqrt:  [[43.86430396  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00307739  0.01719602 -0.17817968]
Stock Position:  0.0030773946771884865
Bond Position:  [0.41516892]


portfolio before change:  [0.74200195]
curr_Stock_Price:  106.17072473690227
curr_Factors:  [106.17072474   0.22361363  -0.9019198 ]
mat_Sqrt:  [[53.87907802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366124 -0.05021155 -0.07902053]
Stock Position:  -0.003661235566763015
Bond Position:  [1.13071798]


portfolio before change:  [0.74358298]
curr_Stock_Price:  105.81611363879838
curr_Factors:  [105.81611364  -0.3316369   -0.86997422]
mat_Sqrt:  [[31.81989419  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00854579  0.06531504 -0.21756738]
Stock Position:  0.00854579435467052
Bond Position:  [-0.16069977]


portfolio before change:  [0.778887]
curr_Stock_Price:  109.95197317361831
curr_Factors:  [109.95197317  -0.57355719  -0.83069246]
mat_Sqrt:  [[26.99884287  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00456098  0.43182096 -2.30193692]
Stock Position:  0.004560978437060535
Bond Position:  [0.27739842]


portfolio before change:  [0.78498778]
curr_Stock_Price:  111.27437001626099
curr_Factors:  [111.27437002  -0.45797845  -0.84793869]
mat_Sqrt:  [[30.14689127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00470895 -0.04976489  0.0510359 ]
Stock Position:  0.004708953609515028
Bond Position:  [0.26100194]


portfolio before change:  [0.79602354]
curr_Stock_Price:  113.60407981412799
curr_Factors:  [113.60407981  -0.51149256  -0.81987147]
mat_Sqrt:  [[30.00474059  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00091159 -0.01259776 -0.44852983]
Stock Position:  -0.0009115891017617963
Bond Position:  [0.89958378]


portfolio before change:  [0.79833783]
curr_Stock_Price:  111.31207751810422
curr_Factors:  [111.31207752  -0.42727318  -0.85040207]
mat_Sqrt:  [[31.02094157  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00179559  0.00572365  0.14476662]
Stock Position:  -0.001795591703423846
Bond Position:  [0.99820887]


portfolio before change:  [0.80428295]
curr_Stock_Price:  108.14012083158518
curr_Factors:  [108.14012083  -0.45722747  -0.80729631]
mat_Sqrt:  [[30.53592976  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034245 -0.05949249 -0.11607517]
Stock Position:  -0.0003424488944287592
Bond Position:  [0.84131541]


portfolio before change:  [0.80511182]
curr_Stock_Price:  106.33397417655448
curr_Factors:  [106.33397418  -0.17379649  -0.7912658 ]
mat_Sqrt:  [[40.50893419  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00442154  0.00659469 -0.1014551 ]
Stock Position:  -0.0044215357447910065
Bond Position:  [1.27527129]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.80500456]
Stock Price:  106.43034594843839
PL:  [-5.62534138]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.38903434e-02 -2.08967523e-03  4.36760782e-02]
 [ 1.91555628e-02  1.21875479e-01 -3.76212401e-02]
 [-6.70653656e-02 -3.28741453e-02 -5.51783570e-02]
 [-5.88375477e-02  1.11703001e-02  3.39084478e-01]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-8.27368992e-01  8.62715435e-01 -1.10438267e-01]
 [ 9.70697307e-03 -3.61911514e-03  2.57319643e-02]
 [-6.75554187e-02 -8.08526705e-02  1.00291204e-01]
 [ 7.33452429e-02  2.65839519e-02  6.24258087e-02]
 [-4.66985054e-01  2.70966742e-01 -2.26921001e-01]
 [ 1.00070041e-01  1.38956790e-02 -5.86286144e-02]
 [-7.95044662e-02 -9.44330495e-03 -1.29789285e-02]
 [ 9.45106952e-02  1.11521646e-01  1.73646041e-02]
 [ 2.11803161e-02  5.94030506e-01 -3.94096553e-01]
 [ 7.69368551e-02 -8.80973912e-02 -4.54065637e-02]
 [ 3.82923369e-02  1.08301223e-02 -3.26721589e-03]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 3.94658100e-02 -1.33740397e-01 -4.23937379e-02]
 [-1.47806061e-01  4.18923412e-02 -1.91410380e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.84469779]
curr_Stock_Price:  100.70025846585993
curr_Factors:  [100.70025847  -1.18306484  -1.00706398]
mat_Sqrt:  [[11.26859379  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047935 -0.00067444  0.12459569]
Stock Position:  -0.0004793459178705799
Bond Position:  [7.89296804]


portfolio before change:  [7.84653717]
curr_Stock_Price:  100.98002055045893
curr_Factors:  [100.98002055  -1.58959069  -1.0206592 ]
mat_Sqrt:  [[ 7.4236644   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00489703  0.03933514 -0.10732293]
Stock Position:  0.004897027309865109
Bond Position:  [7.35203525]


portfolio before change:  [7.84769404]
curr_Stock_Price:  100.84088187219658
curr_Factors:  [100.84088187  -1.66572802  -1.03378585]
mat_Sqrt:  [[ 6.78035851  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01254196 -0.01061008 -0.15740849]
Stock Position:  -0.012541963268669513
Bond Position:  [9.11243668]


portfolio before change:  [7.84134401]
curr_Stock_Price:  101.52884676035838
curr_Factors:  [101.52884676  -1.8013336   -1.01273388]
mat_Sqrt:  [[ 6.08773126  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00207925 0.0036052  0.96731363]
Stock Position:  0.0020792490386739755
Bond Position:  [7.63024025]


portfolio before change:  [7.84243855]
curr_Stock_Price:  101.13771813452561
curr_Factors:  [101.13771813  -1.81821863  -0.98108142]
mat_Sqrt:  [[ 6.15449734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0092286  -0.04522423  0.24245377]
Stock Position:  0.009228598049639892
Bond Position:  [6.9090792]


portfolio before change:  [7.84680739]
curr_Stock_Price:  101.4239315881284
curr_Factors:  [101.42393159  -1.46734563  -0.98708698]
mat_Sqrt:  [[ 8.71352539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07732933  0.27844021 -0.31504963]
Stock Position:  -0.07732932743213974
Bond Position:  [15.6898518]


portfolio before change:  [7.74536347]
curr_Stock_Price:  102.78650484712293
curr_Factors:  [102.78650485  -0.96404136  -1.02447375]
mat_Sqrt:  [[14.07132391  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00101062 -0.00116806  0.07340613]
Stock Position:  0.0010106184456652007
Bond Position:  [7.64148553]


portfolio before change:  [7.74678723]
curr_Stock_Price:  102.3047694452799
curr_Factors:  [102.30476945  -0.58932486  -1.03884584]
mat_Sqrt:  [[20.08123079  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00316652 -0.02609509  0.28610289]
Stock Position:  -0.003166516305269437
Bond Position:  [8.07073695]


portfolio before change:  [7.75087387]
curr_Stock_Price:  101.65146115066125
curr_Factors:  [101.65146115  -0.53504455  -1.0248717 ]
mat_Sqrt:  [[21.36242766  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00428389 0.00857993 0.17808346]
Stock Position:  0.004283889719765073
Bond Position:  [7.31541022]


portfolio before change:  [7.75630907]
curr_Stock_Price:  102.49324684917956
curr_Factors:  [ 1.02493247e+02  6.10294072e-02 -1.01086257e+00]
mat_Sqrt:  [[39.64495703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0115524   0.08745414 -0.64734245]
Stock Position:  -0.011552396301161017
Bond Position:  [8.94035168]


portfolio before change:  [7.78173674]
curr_Stock_Price:  100.4856718516483
curr_Factors:  [ 1.00485672e+02 -8.32291491e-02 -1.02185294e+00]
mat_Sqrt:  [[33.27921597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00273261  0.00448481 -0.16725112]
Stock Position:  0.0027326055102120535
Bond Position:  [7.50714904]


portfolio before change:  [7.79280552]
curr_Stock_Price:  103.84940586958362
curr_Factors:  [103.84940587  -0.1760491   -1.04813748]
mat_Sqrt:  [[30.5313876   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00275393 -0.00304781 -0.03702527]
Stock Position:  -0.0027539326607092522
Bond Position:  [8.07879979]


portfolio before change:  [7.7935401]
curr_Stock_Price:  104.31614564039349
curr_Factors:  [104.31614564  -0.38395118  -1.05593118]
mat_Sqrt:  [[24.71829813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00488786 0.03599346 0.04953638]
Stock Position:  0.00488785636340712
Bond Position:  [7.28365777]


portfolio before change:  [7.78651626]
curr_Stock_Price:  102.50656108366867
curr_Factors:  [102.50656108  -0.69587278  -1.09605614]
mat_Sqrt:  [[17.0815322   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00362916  0.19172252 -1.12424777]
Stock Position:  0.0036291629312319657
Bond Position:  [7.41450325]


portfolio before change:  [7.78896758]
curr_Stock_Price:  102.67118892720485
curr_Factors:  [102.67118893  -0.78317476  -1.12028189]
mat_Sqrt:  [[15.30339789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0032467  -0.02843331 -0.12953229]
Stock Position:  0.0032466955874333424
Bond Position:  [7.45562548]


portfolio before change:  [7.79292206]
curr_Stock_Price:  103.31502741683072
curr_Factors:  [103.31502742  -0.67826121  -1.07869974]
mat_Sqrt:  [[17.82892046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00223435  0.00349541 -0.00932046]
Stock Position:  0.002234353384527523
Bond Position:  [7.56207978]


portfolio before change:  [7.79483625]
curr_Stock_Price:  103.32551287446765
curr_Factors:  [103.32551287  -0.87574019  -1.07163569]
mat_Sqrt:  [[14.73916813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00466714  0.00525786  0.16709793]
Stock Position:  -0.0046671437174244925
Bond Position:  [8.27707127]


portfolio before change:  [7.80080249]
curr_Stock_Price:  102.49058838522504
curr_Factors:  [102.49058839  -0.57194013  -1.07098508]
mat_Sqrt:  [[19.82305716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0001772  -0.04316453 -0.12093753]
Stock Position:  0.0001771967026669462
Bond Position:  [7.78264149]


portfolio before change:  [7.80297195]
curr_Stock_Price:  103.75220998977792
curr_Factors:  [103.75220999  -0.77613967  -1.0849422 ]
mat_Sqrt:  [[16.13391516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00887336  0.01352069 -0.05460405]
Stock Position:  -0.008873355834649887
Bond Position:  [8.72360222]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.80806543]
Stock Price:  103.42400095027647
PL:  [4.38406448]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 2.73143347e-03 -2.21566744e-02  4.71938393e-02]
 [ 3.20255677e-02  1.09296334e-01 -1.66931896e-01]
 [-3.76324883e-02  7.74686663e-03 -1.28295730e-02]
 [-1.83979074e-01 -1.61241906e-01  6.67673390e-01]
 [-1.51007429e-02 -1.73663489e-02  2.31095620e-03]
 [-9.19614120e-01  9.61519047e-01 -1.31459296e-01]
 [ 9.74967799e-04  8.23160220e-03  9.08072678e-03]
 [-5.64212488e-02  9.81146070e-03 -4.43158242e-02]
 [ 1.23752744e-01  2.62491992e-02  4.75717122e-02]
 [ 1.55153346e-01  1.24361290e-01  9.44293605e-02]
 [-1.52956131e-03  3.00444692e-02 -5.14545859e-02]
 [-5.17335057e-02  1.43352586e-01  4.83186660e-02]
 [-9.57585893e-02 -7.84099302e-02  7.73806401e-02]
 [ 2.55009287e-02  3.16625017e-01 -1.77189627e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 3.71337459e-02  5.69623649e-03 -6.10091772e-02]
 [ 1.73021435e-01 -4.45805671e-02  1.67254368e-01]
 [-8.25124260e-02  9.09582085e-02  7.14750341e-02]
 [ 1.36165014e-01 -2.20060780e-02 -2.95004222e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.33461791]
curr_Stock_Price:  100.8880802610685
curr_Factors:  [100.88808026  -1.08111419  -0.9622403 ]
mat_Sqrt:  [[13.07441535  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00059981 -0.00715104  0.13463089]
Stock Position:  0.0005998068086091109
Bond Position:  [9.27410455]


portfolio before change:  [9.33643569]
curr_Stock_Price:  100.05275905672717
curr_Factors:  [100.05275906  -1.09251509  -0.9471454 ]
mat_Sqrt:  [[13.0141489   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00155683  0.03527524 -0.47621024]
Stock Position:  0.0015568254200174273
Bond Position:  [9.18067101]


portfolio before change:  [9.33815925]
curr_Stock_Price:  99.68540794041823
curr_Factors:  [99.68540794 -1.07281315 -0.97970523]
mat_Sqrt:  [[12.80071377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302092  0.00250029 -0.0365992 ]
Stock Position:  -0.003020924622038522
Bond Position:  [9.63930135]


portfolio before change:  [9.33709855]
curr_Stock_Price:  100.83433603198705
curr_Factors:  [100.83433603  -1.15602792  -0.97143147]
mat_Sqrt:  [[12.0133621   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00670954 -0.0520406   1.90468634]
Stock Position:  -0.006709543864613807
Bond Position:  [10.01365095]


portfolio before change:  [9.33451219]
curr_Stock_Price:  101.59296956340654
curr_Factors:  [101.59296956  -1.0776403   -0.98184079]
mat_Sqrt:  [[12.9551481   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00140283 -0.00560497  0.00659251]
Stock Position:  -0.001402833213958951
Bond Position:  [9.47703018]


portfolio before change:  [9.33698152]
curr_Stock_Price:  101.52184405951108
curr_Factors:  [101.52184406  -1.22100912  -0.94736641]
mat_Sqrt:  [[11.61036758  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06461285  0.31032894 -0.37501678]
Stock Position:  -0.06461284513665629
Bond Position:  [15.89659671]


portfolio before change:  [9.42746428]
curr_Stock_Price:  100.1829754189871
curr_Factors:  [100.18297542  -1.07108211  -0.96522832]
mat_Sqrt:  [[13.07481473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00034485 0.00265674 0.02590479]
Stock Position:  0.0003448486458090015
Bond Position:  [9.39291631]


portfolio before change:  [9.42958999]
curr_Stock_Price:  99.53687099747573
curr_Factors:  [99.536871   -1.14516408 -0.91697998]
mat_Sqrt:  [[12.65919823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00501331  0.00316664 -0.12642071]
Stock Position:  -0.005013305055553785
Bond Position:  [9.92859869]


portfolio before change:  [9.43222501]
curr_Stock_Price:  99.50644064357286
curr_Factors:  [99.50644064 -1.26693221 -0.96390929]
mat_Sqrt:  [[10.69077126  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01298516 0.00847189 0.13570885]
Stock Position:  0.01298515995429022
Bond Position:  [8.14011796]


portfolio before change:  [9.42310255]
curr_Stock_Price:  98.64717205836072
curr_Factors:  [98.64717206 -0.8663366  -0.94874781]
mat_Sqrt:  [[16.06214325  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01244005 0.04013743 0.26938068]
Stock Position:  0.012440045955687313
Bond Position:  [8.1959272]


portfolio before change:  [9.43335032]
curr_Stock_Price:  99.30621547379812
curr_Factors:  [99.30621547 -0.77171642 -0.936341  ]
mat_Sqrt:  [[17.99602209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00032784  0.00969681 -0.14678561]
Stock Position:  -0.00032784373400073554
Bond Position:  [9.46590724]


portfolio before change:  [9.43588734]
curr_Stock_Price:  98.78692852769143
curr_Factors:  [98.78692853 -1.12082851 -0.88841913]
mat_Sqrt:  [[13.24629191  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095187  0.04626685  0.1378397 ]
Stock Position:  -0.0009518720663859409
Bond Position:  [9.52991986]


portfolio before change:  [9.43863052]
curr_Stock_Price:  98.40829985771215
curr_Factors:  [98.40829986 -1.00221166 -0.90480599]
mat_Sqrt:  [[14.6158638   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00656606 -0.0253067   0.22074543]
Stock Position:  -0.0065660636659389485
Bond Position:  [10.08478568]


portfolio before change:  [9.44441382]
curr_Stock_Price:  97.91153542722819
curr_Factors:  [97.91153543 -0.86896584 -0.92361258]
mat_Sqrt:  [[16.30523056  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00330956  0.10219028 -0.50547269]
Stock Position:  0.0033095550721444532
Bond Position:  [9.1203702]


portfolio before change:  [9.44526864]
curr_Stock_Price:  97.48079576150833
curr_Factors:  [97.48079576 -0.45240923 -0.92424682]
mat_Sqrt:  [[24.60622217  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00540486 -0.09296045 -0.18429859]
Stock Position:  -0.005404855636506508
Bond Position:  [9.97213827]


portfolio before change:  [9.45064076]
curr_Stock_Price:  96.94816937581776
curr_Factors:  [96.94816938 -0.62524871 -0.88778489]
mat_Sqrt:  [[21.35194615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00121034  0.00183845 -0.1740422 ]
Stock Position:  0.0012103364703262426
Bond Position:  [9.33330085]


portfolio before change:  [9.45009451]
curr_Stock_Price:  94.56878024272767
curr_Factors:  [94.56878024 -1.05080282 -0.811233  ]
mat_Sqrt:  [[14.69183042  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01348111 -0.01438832  0.47713016]
Stock Position:  0.013481105731108277
Bond Position:  [8.17520279]


portfolio before change:  [9.46231768]
curr_Stock_Price:  95.32384550511173
curr_Factors:  [95.32384551 -1.12693389 -0.79901102]
mat_Sqrt:  [[13.89230489  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355275  0.02935664  0.20389838]
Stock Position:  -0.0035527494989789684
Bond Position:  [9.80097943]


portfolio before change:  [9.47178033]
curr_Stock_Price:  93.35013593729909
curr_Factors:  [93.35013594 -0.86543651 -0.8013707 ]
mat_Sqrt:  [[17.6290855   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00405328 -0.00710243 -0.84156493]
Stock Position:  0.004053276492523728
Bond Position:  [9.09340642]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.4768069]
Stock Price:  94.0293231602853
PL:  [9.4768069]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-9.52253270e-02  1.75302926e-01  5.30043797e-03]
 [ 2.20301511e-02  4.92761454e-02 -3.58993654e-02]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-2.41656274e-01 -2.38708636e-01  7.69059595e-01]
 [-2.20072472e-02 -7.17038319e-03 -4.55630443e-03]
 [-1.19674911e+00  1.27123064e+00 -1.88068064e-01]
 [ 2.21309368e-03  6.13922227e-03  1.23344626e-02]
 [-9.31262990e-02 -2.19262354e-02 -1.62116749e-02]
 [ 1.20250366e-01  2.66290665e-02  4.90583266e-02]
 [ 1.39070400e-01  1.29170853e-01  8.72808930e-02]
 [ 1.23919414e-01  3.23316394e-02 -5.27541715e-02]
 [-1.05155034e-01  1.15248656e-01  1.75792577e-01]
 [-1.50489927e-01 -1.06130271e-01  5.09986578e-02]
 [ 5.37608078e-02  3.86449331e-01 -1.39147668e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 5.07802512e-02  2.62257311e-02  6.18656946e-02]
 [ 6.23101024e-02  2.34449423e-02  1.14726095e-01]
 [-4.44581418e-02 -7.41142823e-03  5.88550112e-02]
 [ 4.30145654e-03 -5.41950841e-02 -1.50393628e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.19014449]
curr_Stock_Price:  99.05706468604659
curr_Factors:  [99.05706469 -0.92554041 -0.98788236]
mat_Sqrt:  [[14.61828767  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00399225  0.05657878  0.01512067]
Stock Position:  -0.003992247311151833
Bond Position:  [-4.79468419]


portfolio before change:  [-5.19390084]
curr_Stock_Price:  99.69768851147246
curr_Factors:  [99.69768851 -1.30181374 -1.00533687]
mat_Sqrt:  [[ 9.92435548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00249494  0.01590381 -0.1024109 ]
Stock Position:  0.002494940346785371
Bond Position:  [-5.44264062]


portfolio before change:  [-5.19310251]
curr_Stock_Price:  100.5631032825892
curr_Factors:  [100.56310328  -1.19648064  -1.08080603]
mat_Sqrt:  [[10.31396444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00756477  0.01370813 -0.02999186]
Stock Position:  -0.007564767067285241
Bond Position:  [-4.43236606]


portfolio before change:  [-5.19117425]
curr_Stock_Price:  100.16170351956883
curr_Factors:  [100.16170352  -0.8417622   -1.09582625]
mat_Sqrt:  [[14.42838523  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00924558 -0.07704288  2.19391296]
Stock Position:  -0.00924558334168669
Bond Position:  [-4.26512087]


portfolio before change:  [-5.20359319]
curr_Stock_Price:  101.38959096597037
curr_Factors:  [101.38959097  -0.88604558  -1.08943459]
mat_Sqrt:  [[14.06219876  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00173522 -0.00231423 -0.01299787]
Stock Position:  -0.0017352156455962282
Bond Position:  [-5.02766039]


portfolio before change:  [-5.20520666]
curr_Stock_Price:  101.59498083302348
curr_Factors:  [101.59498083  -0.99165469  -1.0894792 ]
mat_Sqrt:  [[12.67789912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07695672  0.41028793 -0.53650584]
Stock Position:  -0.07695671557597056
Bond Position:  [2.61320938]


portfolio before change:  [-5.1063747]
curr_Stock_Price:  100.31921722640925
curr_Factors:  [100.31921723  -1.17979579  -1.0907259 ]
mat_Sqrt:  [[10.35879153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00057768 0.00198143 0.03518679]
Stock Position:  0.0005776753776276381
Bond Position:  [-5.16432664]


portfolio before change:  [-5.10773385]
curr_Stock_Price:  100.2016596875532
curr_Factors:  [100.20165969  -1.44276252  -1.07419196]
mat_Sqrt:  [[ 8.08677716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01247854 -0.00707666 -0.0462474 ]
Stock Position:  -0.012478539394011876
Bond Position:  [-3.8573635]


portfolio before change:  [-5.101138]
curr_Stock_Price:  99.59579449799213
curr_Factors:  [99.5957945  -1.18556988 -1.09544359]
mat_Sqrt:  [[10.17675783  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0133343  0.00859449 0.13994975]
Stock Position:  0.013334304751378496
Bond Position:  [-6.42917868]


portfolio before change:  [-5.11218758]
curr_Stock_Price:  98.88769005638143
curr_Factors:  [98.88769006 -1.0538707  -1.08828766]
mat_Sqrt:  [[11.60953102  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01578474 0.04168971 0.24898809]
Stock Position:  0.015784739940022198
Bond Position:  [-6.67310405]


portfolio before change:  [-5.12624098]
curr_Stock_Price:  98.10307658525977
curr_Factors:  [98.10307659 -1.36525129 -1.06906498]
mat_Sqrt:  [[ 8.59948627  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01392533  0.01043499 -0.15049297]
Stock Position:  0.01392532981043798
Bond Position:  [-6.49235868]


portfolio before change:  [-5.13375833]
curr_Stock_Price:  97.67981546741461
curr_Factors:  [97.67981547 -1.53574542 -1.02024722]
mat_Sqrt:  [[ 7.58143352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00603402  0.03719634  0.50148729]
Stock Position:  -0.0060340159951248525
Bond Position:  [-4.54435676]


portfolio before change:  [-5.13791249]
curr_Stock_Price:  98.17996799073657
curr_Factors:  [98.17996799 -1.72006062 -1.04697152]
mat_Sqrt:  [[ 6.17043946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02621266 -0.0342534   0.14548498]
Stock Position:  -0.02621265817895335
Bond Position:  [-2.56435455]


portfolio before change:  [-5.14412094]
curr_Stock_Price:  98.39235718565695
curr_Factors:  [98.39235719 -1.47867489 -1.08015997]
mat_Sqrt:  [[ 7.61506309  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0136888   0.12472599 -0.39694957]
Stock Position:  0.01368879639962478
Bond Position:  [-6.49099389]


portfolio before change:  [-5.1370368]
curr_Stock_Price:  99.02843176975476
curr_Factors:  [99.02843177 -1.26071275 -1.09448916]
mat_Sqrt:  [[ 9.39525793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01415534 -0.09296045 -0.18429859]
Stock Position:  -0.014155340863992146
Bond Position:  [-3.73525559]


portfolio before change:  [-5.12863686]
curr_Stock_Price:  98.36904343283882
curr_Factors:  [98.36904343 -1.14755087 -1.09593924]
mat_Sqrt:  [[10.43573573  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00658907 0.00846432 0.17648561]
Stock Position:  0.006589074306237679
Bond Position:  [-5.7767978]


portfolio before change:  [-5.14196549]
curr_Stock_Price:  96.56541404100848
curr_Factors:  [96.56541404 -0.87319608 -1.13484977]
mat_Sqrt:  [[12.96398062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00698197 0.00756682 0.32728162]
Stock Position:  0.006981971817528377
Bond Position:  [-5.81618249]


portfolio before change:  [-5.1448879]
curr_Stock_Price:  96.35513173501172
curr_Factors:  [96.35513174 -0.78486123 -1.15986523]
mat_Sqrt:  [[13.78132209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00246401 -0.00239203  0.16789696]
Stock Position:  -0.002464006297931132
Bond Position:  [-4.90746825]


portfolio before change:  [-5.1507725]
curr_Stock_Price:  98.2453759229988
curr_Factors:  [98.24537592 -1.04166264 -1.15782315]
mat_Sqrt:  [[10.89149696  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00343938 -0.01749139 -0.42903116]
Stock Position:  -0.003439383905406518
Bond Position:  [-4.81286893]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.1554225]
Stock Price:  99.24748375710999
PL:  [-5.1554225]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.05218650e-02 -1.60940129e-02  4.84603991e-02]
 [ 2.50284707e-02  1.14453721e-01 -9.88512235e-02]
 [ 6.26659597e-02 -7.15023757e-02 -1.90672828e-02]
 [-1.73795874e-01 -1.52457082e-01  5.00413635e-01]
 [ 2.15657254e-02 -7.14964899e-02  3.87690806e-02]
 [-1.01470622e+00  9.53675736e-01 -1.17599978e-01]
 [-5.66746258e-04  1.47809518e-02 -3.51560756e-03]
 [ 1.52852127e-02  3.18995459e-02 -3.23972117e-02]
 [ 1.29803076e-01  2.55988324e-02  4.51234231e-02]
 [ 6.81682319e-02  1.43426596e-01  4.78713324e-02]
 [ 1.17462217e-01  3.22139126e-02 -5.26872783e-02]
 [-1.12508803e-01  1.11379995e-01  1.93340066e-01]
 [-1.53604161e-01 -1.28350861e-01  1.56416276e-03]
 [ 3.00225517e-02  6.12384282e-01 -3.80075374e-01]
 [ 1.85841938e-02 -1.72667979e-01 -5.35272983e-02]
 [ 6.30252685e-02  5.90276078e-02  1.59665320e-01]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 3.74896226e-02 -1.22940514e-01 -4.40679640e-02]
 [-1.38946702e-01  4.86300236e-02 -1.39845726e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.92205669]
curr_Stock_Price:  100.5839488029397
curr_Factors:  [100.5839488   -1.30995443  -0.94701499]
mat_Sqrt:  [[10.52784099  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00037188 -0.00519432  0.13824403]
Stock Position:  -0.00037188100445759126
Bond Position:  [6.95946195]


portfolio before change:  [6.92382327]
curr_Stock_Price:  100.51270809510544
curr_Factors:  [100.5127081   -1.36487931  -0.94232329]
mat_Sqrt:  [[10.00496603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00281993  0.03693978 -0.28199503]
Stock Position:  0.0028199313358776967
Bond Position:  [6.64038433]


portfolio before change:  [6.92156187]
curr_Stock_Price:  99.12199931280105
curr_Factors:  [99.12199931 -1.44230356 -0.9027071 ]
mat_Sqrt:  [[ 9.50046506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00465014 -0.02307729 -0.05439365]
Stock Position:  0.0046501413647885605
Bond Position:  [6.46063056]


portfolio before change:  [6.92383685]
curr_Stock_Price:  99.26384933510006
curr_Factors:  [99.26384934 -0.9865796  -0.88262901]
mat_Sqrt:  [[15.31102017  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00671213 -0.04920531  1.42754081]
Stock Position:  -0.006712128853973986
Bond Position:  [7.59010859]


portfolio before change:  [6.91840219]
curr_Stock_Price:  100.35626293670595
curr_Factors:  [100.35626294  -1.17921431  -0.89444217]
mat_Sqrt:  [[12.61731415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00117975 -0.02307539  0.1105974 ]
Stock Position:  0.0011797495704089416
Bond Position:  [6.80000693]


portfolio before change:  [6.91744474]
curr_Stock_Price:  98.10352902953508
curr_Factors:  [98.10352903 -0.96510505 -0.90887305]
mat_Sqrt:  [[15.06004548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05604518  0.30779752 -0.33548   ]
Stock Position:  -0.056045180938288544
Bond Position:  [12.41567478]


portfolio before change:  [6.86832129]
curr_Stock_Price:  99.0354156844663
curr_Factors:  [99.03541568 -1.05421029 -0.91989053]
mat_Sqrt:  [[13.75464661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00012598  0.00477053 -0.01002905]
Stock Position:  0.00012597797341620215
Bond Position:  [6.85584501]


portfolio before change:  [6.86988051]
curr_Stock_Price:  97.8053768809717
curr_Factors:  [97.80537688 -1.0634025  -0.90816736]
mat_Sqrt:  [[13.61823497  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00111495  0.01029553 -0.09242023]
Stock Position:  0.0011149482369780307
Bond Position:  [6.76083258]


portfolio before change:  [6.87326539]
curr_Stock_Price:  99.32513861329001
curr_Factors:  [99.32513861 -1.35546102 -0.89512262]
mat_Sqrt:  [[10.46268433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01378606 0.00826199 0.12872457]
Stock Position:  0.013786060221868426
Bond Position:  [5.50396304]


portfolio before change:  [6.87946618]
curr_Stock_Price:  99.67510307982013
curr_Factors:  [99.67510308 -1.40032111 -0.86859394]
mat_Sqrt:  [[10.3088308   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01040048 0.04629073 0.13656359]
Stock Position:  0.010400477041921256
Bond Position:  [5.84279756]


portfolio before change:  [6.90007856]
curr_Stock_Price:  101.51650899954956
curr_Factors:  [101.516509   -1.6745742  -0.8996442]
mat_Sqrt:  [[ 7.73691508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0146419   0.010397   -0.15030214]
Stock Position:  0.014641896358757216
Bond Position:  [5.41368436]


portfolio before change:  [6.89791238]
curr_Stock_Price:  101.27611865120177
curr_Factors:  [101.27611865  -1.62308145  -0.92533641]
mat_Sqrt:  [[ 7.9203293   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00635177  0.03594774  0.55154539]
Stock Position:  -0.006351766346523824
Bond Position:  [7.54119462]


portfolio before change:  [6.89683228]
curr_Stock_Price:  101.74301860633973
curr_Factors:  [101.74301861  -1.64974769  -0.96734408]
mat_Sqrt:  [[ 7.42875624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02416076 -0.04142506  0.00446212]
Stock Position:  -0.02416075875755421
Bond Position:  [9.35502081]


portfolio before change:  [6.90732437]
curr_Stock_Price:  101.40556874183855
curr_Factors:  [101.40556874  -1.25062974  -1.02066435]
mat_Sqrt:  [[10.46288164  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00740163  0.19764618 -1.08424925]
Stock Position:  0.007401632910321686
Bond Position:  [6.15675757]


portfolio before change:  [6.90608621]
curr_Stock_Price:  101.03030768331729
curr_Factors:  [101.03030768  -1.20523359  -0.98140952]
mat_Sqrt:  [[11.34500364  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243171 -0.05572835 -0.15269848]
Stock Position:  -0.002431706914785538
Bond Position:  [7.1517623]


portfolio before change:  [6.90689922]
curr_Stock_Price:  101.43132468057983
curr_Factors:  [101.43132468  -0.93787079  -0.99823092]
mat_Sqrt:  [[14.63301469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00735773 0.01905108 0.45548072]
Stock Position:  0.007357730286672242
Bond Position:  [6.16059489]


portfolio before change:  [6.90854467]
curr_Stock_Price:  101.44561041449613
curr_Factors:  [101.44561041  -1.04306174  -0.97032869]
mat_Sqrt:  [[13.54655633  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00507803  0.00525786  0.16709793]
Stock Position:  -0.005078029741680811
Bond Position:  [7.42368849]


portfolio before change:  [6.90636696]
curr_Stock_Price:  102.23998504834768
curr_Factors:  [102.23998505  -0.76106892  -0.96478349]
mat_Sqrt:  [[18.20088905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00018676 -0.03967888 -0.12571364]
Stock Position:  0.00018675789502304967
Bond Position:  [6.88727284]


portfolio before change:  [6.90817861]
curr_Stock_Price:  102.71984258296818
curr_Factors:  [102.71984258  -0.78442715  -0.95420912]
mat_Sqrt:  [[18.0540321   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00730445  0.01569527 -0.03989409]
Stock Position:  -0.0073044474506888
Bond Position:  [7.65849031]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.90933813]
Stock Price:  102.82325103181729
PL:  [4.0860871]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 4.48166427e-02 -1.06757375e-01  5.69219145e-02]
 [-2.17269682e-04  9.30019684e-02 -8.84912647e-02]
 [ 1.61667434e-02 -1.15110495e-01 -2.42020087e-01]
 [-3.03231695e-01 -3.10336930e-01  1.20677811e+00]
 [-3.47959041e-02 -1.22178193e-01 -3.58157614e-02]
 [-1.42864352e+00  1.62114787e+00 -2.59620504e-01]
 [-7.15083934e-02 -2.21185443e-01 -1.46182415e-02]
 [ 2.04546862e-02 -2.98621750e-01  5.33304242e-01]
 [-7.42424640e-02 -6.54357251e-02 -7.35451523e-02]
 [-1.06740518e+00  4.02296060e-01 -5.48597660e-01]
 [ 1.62899361e-01  5.90897432e-02 -5.74619135e-02]
 [-8.38750666e-02  1.26443594e-01  1.25014534e-01]
 [ 2.23511312e-01 -4.36375021e-02 -1.57659273e-01]
 [ 2.85214813e-02  9.65922324e-01 -5.72001600e-01]
 [ 1.59985066e-01 -8.27484432e-02  7.34819113e-03]
 [ 2.13794456e-02 -2.47589875e-02 -4.28713357e-02]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.92955183e-02 -2.09989432e-01 -3.15928174e-02]
 [-1.63823569e-01  2.97107730e-02 -2.84638039e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.39588807]
curr_Stock_Price:  101.52611235014706
curr_Factors:  [101.52611235  -1.24523752  -0.97965499]
mat_Sqrt:  [[10.97284429  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00315725 -0.03445579  0.16238238]
Stock Position:  0.0031572508479761714
Bond Position:  [14.07534467]


portfolio before change:  [14.40342928]
curr_Stock_Price:  102.79998523242745
curr_Factors:  [102.79998523  -1.08037348  -1.03220993]
mat_Sqrt:  [[12.43110499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.65898096e-05  3.00162562e-02 -2.52440947e-01]
Stock Position:  5.6589809582293975e-05
Bond Position:  [14.39761185]


portfolio before change:  [14.40708133]
curr_Stock_Price:  103.72239514811855
curr_Factors:  [103.72239515  -1.00359931  -1.05495511]
mat_Sqrt:  [[13.2389552   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00428525 -0.03715175 -0.69041594]
Stock Position:  -0.004285249883558752
Bond Position:  [14.85155772]


portfolio before change:  [14.41462635]
curr_Stock_Price:  102.8282434794533
curr_Factors:  [102.82824348  -0.81538308  -1.02399563]
mat_Sqrt:  [[16.34106636  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00735854 -0.10016081  3.44260205]
Stock Position:  -0.007358540866437128
Bond Position:  [15.17129218]


portfolio before change:  [14.40380752]
curr_Stock_Price:  104.81398002104018
curr_Factors:  [104.81398002  -0.7911452   -1.02814211]
mat_Sqrt:  [[16.99467144  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00394514 -0.03943284 -0.1021724 ]
Stock Position:  -0.00394513570479355
Bond Position:  [14.8173129]


portfolio before change:  [14.40146171]
curr_Stock_Price:  106.34766707242326
curr_Factors:  [106.34766707  -0.70682343  -1.03915679]
mat_Sqrt:  [[18.55489037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06201723  0.52322322 -0.74062503]
Stock Position:  -0.06201723026242854
Bond Position:  [20.99684947]


portfolio before change:  [14.35474281]
curr_Stock_Price:  107.18564010170165
curr_Factors:  [107.1856401   -0.56572373  -1.02055115]
mat_Sqrt:  [[21.9394723   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00545326 -0.07138729 -0.04170177]
Stock Position:  -0.005453258737451938
Bond Position:  [14.93925384]


portfolio before change:  [14.35698928]
curr_Stock_Price:  107.45865377403176
curr_Factors:  [107.45865377  -0.68855677  -1.01338633]
mat_Sqrt:  [[19.59281785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00348899 -0.09637976  1.52136856]
Stock Position:  0.003488985081019235
Bond Position:  [13.98206764]


portfolio before change:  [14.35968028]
curr_Stock_Price:  107.22794072406224
curr_Factors:  [107.22794072  -0.82533894  -1.04716892]
mat_Sqrt:  [[16.48496904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00622457 -0.02111929 -0.20980385]
Stock Position:  -0.0062245683700499444
Bond Position:  [15.02712793]


portfolio before change:  [14.37394796]
curr_Stock_Price:  105.53940070940656
curr_Factors:  [105.53940071  -1.1091245   -1.04620318]
mat_Sqrt:  [[12.22834563  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08973159  0.1298405  -1.56499642]
Stock Position:  -0.08973158745386595
Bond Position:  [23.84416593]


portfolio before change:  [14.34423465]
curr_Stock_Price:  105.93697642903422
curr_Factors:  [105.93697643  -1.09789217  -1.04617307]
mat_Sqrt:  [[12.41343206  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0131496   0.01907113 -0.16392284]
Stock Position:  0.013149597956786293
Bond Position:  [12.951206]


portfolio before change:  [14.34728156]
curr_Stock_Price:  105.92242877933332
curr_Factors:  [105.92242878  -1.0087115   -1.06238135]
mat_Sqrt:  [[13.35130561  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243769  0.04080949  0.35663167]
Stock Position:  -0.002437693518390157
Bond Position:  [14.60548798]


portfolio before change:  [14.35008257]
curr_Stock_Price:  106.27145481695936
curr_Factors:  [106.27145482  -1.12157653  -1.03768469]
mat_Sqrt:  [[12.26482602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01487357 -0.01408394 -0.44975802]
Stock Position:  0.014873572569001382
Bond Position:  [12.76944638]


portfolio before change:  [14.34987269]
curr_Stock_Price:  106.04268389914901
curr_Factors:  [106.0426839   -1.06350409  -1.03865572]
mat_Sqrt:  [[12.95759209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00840667  0.31175009 -1.63176135]
Stock Position:  0.008406670902865454
Bond Position:  [13.45840675]


portfolio before change:  [14.35741165]
curr_Stock_Price:  106.53918672745057
curr_Factors:  [106.53918673  -0.83319493  -1.02653355]
mat_Sqrt:  [[16.58973922  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00871587 -0.02670695  0.02096234]
Stock Position:  0.008715872627988333
Bond Position:  [13.42882967]


portfolio before change:  [14.34383632]
curr_Stock_Price:  104.59641474243327
curr_Factors:  [104.59641474  -0.96297827  -1.01041398]
mat_Sqrt:  [[14.53728927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00052104 -0.00799093 -0.12229999]
Stock Position:  0.0005210368719441019
Bond Position:  [14.28933773]


portfolio before change:  [14.34743753]
curr_Stock_Price:  104.65096643264793
curr_Factors:  [104.65096643  -1.12628286  -1.04590001]
mat_Sqrt:  [[11.92274381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00576963  0.00525786  0.16709793]
Stock Position:  -0.005769629629062937
Bond Position:  [14.95123484]


portfolio before change:  [14.34651984]
curr_Stock_Price:  105.4579449132372
curr_Factors:  [105.45794491  -1.36277755  -1.06389607]
mat_Sqrt:  [[ 9.31511765  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.85202702e-06 -6.77737977e-02 -9.01255144e-02]
Stock Position:  -1.8520270238255927e-06
Bond Position:  [14.34671515]


portfolio before change:  [14.35010796]
curr_Stock_Price:  104.9213904738862
curr_Factors:  [104.92139047  -1.1302245   -1.04948369]
mat_Sqrt:  [[11.86393609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01378708  0.00958911 -0.08119931]
Stock Position:  -0.013787079693271488
Bond Position:  [15.79666753]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.35390506]
Stock Price:  104.93245606772722
PL:  [9.42144899]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.64915458e-01  2.60096918e-01 -2.52401774e-02]
 [-4.42321159e-02 -1.89635847e-01  4.16606101e-01]
 [ 1.95100627e-01  4.27065789e-02  3.07647546e-01]
 [ 1.83256389e-02  4.10527554e-02 -5.95265617e-02]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-7.47349116e-01  5.85309467e-01 -3.36127352e-02]
 [-1.35886202e-01 -8.86409271e-02 -1.03898129e-01]
 [ 1.15032642e-01 -1.29855006e-01  2.79999696e-02]
 [ 5.62811649e-02  2.44666004e-02  3.79730185e-02]
 [ 1.52831407e-01  1.15425694e-01  8.05269556e-02]
 [-7.45614105e-03  2.68320985e-02 -4.96025215e-02]
 [ 1.63911445e-02  9.29611321e-02 -1.16802605e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [ 2.41943068e-02  4.32773037e-01 -2.71684083e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 6.49837386e-02  5.65522532e-02  1.80829978e-01]
 [-8.94784252e-02  1.72180932e-02  5.50824848e-02]
 [ 3.53120801e-02 -8.88937108e-02 -4.35236574e-02]
 [-1.00896795e-01  1.63698180e-01 -8.23803629e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.5557861]
curr_Stock_Price:  98.00247806541746
curr_Factors:  [98.00247807 -0.82309166 -0.99444928]
mat_Sqrt:  [[15.91802033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00734862  0.08394592 -0.0720032 ]
Stock Position:  -0.0073486227670715824
Bond Position:  [-12.83560286]


portfolio before change:  [-13.55365921]
curr_Stock_Price:  97.27632913888851
curr_Factors:  [97.27632914 -1.19726273 -0.99756531]
mat_Sqrt:  [[10.83441498  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.93641584e-04 -6.12047063e-02  1.18846125e+00]
Stock Position:  0.00019364158371003618
Bond Position:  [-13.57249595]


portfolio before change:  [-13.55723965]
curr_Stock_Price:  96.31120105518698
curr_Factors:  [96.31120106 -1.11063711 -0.97164237]
mat_Sqrt:  [[12.00478297  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02220918 0.01378349 0.87763282]
Stock Position:  0.02220917810135786
Bond Position:  [-15.69623227]


portfolio before change:  [-13.56040609]
curr_Stock_Price:  96.34533577428874
curr_Factors:  [96.34533577 -1.74301981 -0.89397118]
mat_Sqrt:  [[ 6.89604458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00211059  0.01324972 -0.16981271]
Stock Position:  0.002110585107657942
Bond Position:  [-13.76375112]


portfolio before change:  [-13.5658138]
curr_Stock_Price:  95.41367821700183
curr_Factors:  [95.41367822 -1.589508   -0.91974933]
mat_Sqrt:  [[ 7.75986257  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00731938 -0.04522423  0.24245377]
Stock Position:  0.007319379903274939
Bond Position:  [-14.26418276]


portfolio before change:  [-13.56842362]
curr_Stock_Price:  95.54438233362194
curr_Factors:  [95.54438233 -1.40669565 -0.90153386]
mat_Sqrt:  [[ 9.5006609   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06680951  0.18890782 -0.09588778]
Stock Position:  -0.06680950929834976
Bond Position:  [-7.18515032]


portfolio before change:  [-13.52215181]
curr_Stock_Price:  94.82489907886018
curr_Factors:  [94.82489908 -1.04216564 -0.88628474]
mat_Sqrt:  [[13.78500828  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01270859 -0.02860874 -0.29639244]
Stock Position:  -0.012708593895895287
Bond Position:  [-12.31706068]


portfolio before change:  [-13.52492384]
curr_Stock_Price:  94.80069368292588
curr_Factors:  [94.80069368 -1.01574674 -0.95441243]
mat_Sqrt:  [[13.21850253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00712952 -0.04191052  0.07987612]
Stock Position:  0.007129519333265434
Bond Position:  [-14.20080722]


portfolio before change:  [-13.53036152]
curr_Stock_Price:  94.5360154045169
curr_Factors:  [94.5360154  -0.98479469 -0.95033649]
mat_Sqrt:  [[13.65150403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00505634 0.00789656 0.10832645]
Stock Position:  0.005056336545683026
Bond Position:  [-14.00836743]


portfolio before change:  [-13.5310308]
curr_Stock_Price:  95.09635211204588
curr_Factors:  [95.09635211 -1.18975787 -0.94057288]
mat_Sqrt:  [[11.29725601  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01706875 0.03725348 0.22972099]
Stock Position:  0.017068753168372506
Bond Position:  [-15.15420696]


portfolio before change:  [-13.52890355]
curr_Stock_Price:  95.44296622371908
curr_Factors:  [95.44296622 -0.942979   -0.90307137]
mat_Sqrt:  [[15.06657146  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00080338  0.00866002 -0.14150219]
Stock Position:  -0.0008033768145508584
Bond Position:  [-13.45222689]


portfolio before change:  [-13.53243587]
curr_Stock_Price:  95.6531307117583
curr_Factors:  [95.65313071 -0.75269905 -0.80793956]
mat_Sqrt:  [[20.08734097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00164196  0.03000308 -0.03332053]
Stock Position:  0.0016419561448992117
Bond Position:  [-13.68949412]


portfolio before change:  [-13.53389682]
curr_Stock_Price:  96.84795401650936
curr_Factors:  [96.84795402 -0.3579258  -0.79171436]
mat_Sqrt:  [[30.67666009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00054964 -0.00995959  0.34984664]
Stock Position:  0.0005496401289901914
Bond Position:  [-13.58712835]


portfolio before change:  [-13.53626631]
curr_Stock_Price:  98.71775761171851
curr_Factors:  [98.71775761 -0.55407248 -0.78599179]
mat_Sqrt:  [[25.84715606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00220823  0.1396769  -0.77503907]
Stock Position:  0.0022082294791621942
Bond Position:  [-13.75425777]


portfolio before change:  [-13.53841837]
curr_Stock_Price:  99.30054720965651
curr_Factors:  [99.30054721 -0.54633886 -0.78168293]
mat_Sqrt:  [[26.31474145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00505394 -0.09296045 -0.18429859]
Stock Position:  -0.005053938258306396
Bond Position:  [-13.03655954]


portfolio before change:  [-13.5470792]
curr_Stock_Price:  100.3692742774676
curr_Factors:  [100.36927428  -0.69114231  -0.79763153]
mat_Sqrt:  [[22.64824312  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00500874 0.01825216 0.51585759]
Stock Position:  0.005008740986581648
Bond Position:  [-14.0498029]


portfolio before change:  [-13.55178198]
curr_Stock_Price:  100.13171242805255
curr_Factors:  [100.13171243  -0.78383882  -0.79487786]
mat_Sqrt:  [[20.65112432  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361821  0.00555712  0.157135  ]
Stock Position:  -0.0036182113070569546
Bond Position:  [-13.18948428]


portfolio before change:  [-13.55532895]
curr_Stock_Price:  100.20058445615639
curr_Factors:  [100.20058446  -0.97136354  -0.78855153]
mat_Sqrt:  [[17.24046024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00048041 -0.02869032 -0.12416088]
Stock Position:  0.0004804104919704884
Bond Position:  [-13.60346637]


portfolio before change:  [-13.55885798]
curr_Stock_Price:  99.93469435315095
curr_Factors:  [99.93469435 -1.17810399 -0.77542442]
mat_Sqrt:  [[14.16803691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00488167  0.05283336 -0.02350082]
Stock Position:  -0.004881666149356561
Bond Position:  [-13.07101017]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.55362788]
Stock Price:  98.19384160339791
PL:  [-13.55362788]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 3.01804153e-02 -1.70990089e-01  4.46546104e-02]
 [ 1.55428314e-02  1.27175282e-01 -8.78611953e-02]
 [-5.49084516e-02 -7.11895073e-02 -8.92719655e-02]
 [-1.35497882e-01 -9.53958642e-02  5.92601315e-01]
 [ 3.13754025e-02 -8.59783647e-02  4.85230178e-02]
 [-9.73615778e-01  1.03011919e+00 -1.45335236e-01]
 [ 1.13861728e-02 -8.75074303e-03  3.51146163e-02]
 [-9.24714772e-02 -1.70102937e-02 -2.69894439e-02]
 [-1.09440543e-02  2.01422250e-02  5.70682633e-02]
 [-5.69698700e-01  2.88913508e-01 -2.87086498e-01]
 [ 4.03622509e-02  4.33673373e-02 -5.39637584e-02]
 [-5.03219959e-02  1.44095151e-01  4.49505357e-02]
 [-1.87718775e-01 -1.24985946e-01  3.30533481e-02]
 [ 3.68440704e-02  4.11752102e-01 -2.26830803e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 5.65337129e-02  2.90981292e-02  1.22492651e-01]
 [ 4.87677133e-02  1.82169020e-02  1.18580470e-01]
 [ 2.11590130e-02 -8.37477690e-02 -1.52807682e-02]
 [-6.67716812e-02  7.99911271e-02 -4.76118692e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.90361462]
curr_Stock_Price:  101.96830216137316
curr_Factors:  [101.96830216  -1.6852326   -0.944734  ]
mat_Sqrt:  [[ 7.34996394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00059759 -0.05518681  0.12738717]
Stock Position:  0.0005975939254443853
Bond Position:  [17.84267898]


portfolio before change:  [17.90788459]
curr_Stock_Price:  101.64825605002511
curr_Factors:  [101.64825605  -1.73761626  -0.90933714]
mat_Sqrt:  [[ 7.20348533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00327172  0.04104565 -0.25064353]
Stock Position:  0.003271719811891346
Bond Position:  [17.57531997]


portfolio before change:  [17.91231164]
curr_Stock_Price:  101.65824385134236
curr_Factors:  [101.65824385  -1.58746547  -0.88616599]
mat_Sqrt:  [[ 8.56757884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01023189 -0.02297631 -0.25466807]
Stock Position:  -0.010231888640211129
Bond Position:  [18.95246747]


portfolio before change:  [17.91857256]
curr_Stock_Price:  101.50947333374474
curr_Factors:  [101.50947333  -1.42929059  -0.88064308]
mat_Sqrt:  [[10.07662569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337477 -0.03078888  1.6905266 ]
Stock Position:  -0.0033747650539082733
Bond Position:  [18.26114318]


portfolio before change:  [17.9226982]
curr_Stock_Price:  101.63991654247056
curr_Factors:  [101.63991654  -1.40296826  -0.91165361]
mat_Sqrt:  [[10.04238339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00236297 -0.0277494   0.13842266]
Stock Position:  0.0023629711064793355
Bond Position:  [17.68252601]


portfolio before change:  [17.92770405]
curr_Stock_Price:  101.88734553212262
curr_Factors:  [101.88734553  -1.11460167  -0.95066315]
mat_Sqrt:  [[12.91775774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06138914  0.33246954 -0.41460097]
Stock Position:  -0.06138913773098408
Bond Position:  [24.18248034]


portfolio before change:  [17.97768425]
curr_Stock_Price:  101.1716843669535
curr_Factors:  [101.17168437  -1.04304677  -0.92328701]
mat_Sqrt:  [[14.16090699  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00118408 -0.00282429  0.10017223]
Stock Position:  0.001184082061599582
Bond Position:  [17.85788867]


portfolio before change:  [17.98248117]
curr_Stock_Price:  101.45197939787599
curr_Factors:  [101.4519794   -1.05490175  -0.93505358]
mat_Sqrt:  [[13.86864097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00731527 -0.00549005 -0.07699337]
Stock Position:  -0.00731527236763963
Bond Position:  [18.72463003]


portfolio before change:  [17.97783874]
curr_Stock_Price:  102.72659715558707
curr_Factors:  [102.72659716  -0.75243683  -0.94201034]
mat_Sqrt:  [[18.87095349  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00025523 0.00650088 0.16279987]
Stock Position:  0.0002552319700711886
Bond Position:  [17.95161962]


portfolio before change:  [17.98238784]
curr_Stock_Price:  102.96416428863382
curr_Factors:  [102.96416429  -0.95015056  -0.96791396]
mat_Sqrt:  [[15.12450813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0376426   0.09324643 -0.81897787]
Stock Position:  -0.03764259694354148
Bond Position:  [21.85822637]


portfolio before change:  [18.02175729]
curr_Stock_Price:  102.06347676573233
curr_Factors:  [102.06347677  -0.70583904  -0.97843049]
mat_Sqrt:  [[18.94093412  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00201676  0.01399675 -0.15394358]
Stock Position:  0.0020167572108741325
Bond Position:  [17.81592004]


portfolio before change:  [18.02752828]
curr_Stock_Price:  102.71623099203222
curr_Factors:  [102.71623099  -1.01677024  -0.97846451]
mat_Sqrt:  [[13.96753058  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084003  0.04650651  0.12823137]
Stock Position:  -0.0008400344401798753
Bond Position:  [18.11381345]


portfolio before change:  [18.03399855]
curr_Stock_Price:  100.40531447420148
curr_Factors:  [100.40531447  -1.29661446  -0.96081498]
mat_Sqrt:  [[10.50431055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01965711 -0.04033904  0.094292  ]
Stock Position:  -0.01965711474106139
Bond Position:  [20.00767733]


portfolio before change:  [18.06594704]
curr_Stock_Price:  99.03451581274287
curr_Factors:  [99.03451581 -0.92203668 -0.98922873]
mat_Sqrt:  [[14.64652375  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00509274  0.13289242 -0.64708514]
Stock Position:  0.00509274239223041
Bond Position:  [17.56158976]


portfolio before change:  [18.06389798]
curr_Stock_Price:  97.76996989623441
curr_Factors:  [97.7699699  -0.94540009 -1.02505594]
mat_Sqrt:  [[13.62847623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00975847 -0.09296045 -0.18429859]
Stock Position:  -0.009758470155422038
Bond Position:  [19.01798331]


portfolio before change:  [18.06138637]
curr_Stock_Price:  98.51462541150028
curr_Factors:  [98.51462541 -1.44860839 -1.0354712 ]
mat_Sqrt:  [[ 8.21634472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01064671 0.00939138 0.34943744]
Stock Position:  0.010646711425537246
Bond Position:  [17.01252958]


portfolio before change:  [18.06706519]
curr_Stock_Price:  98.64848403570647
curr_Factors:  [98.64848404 -1.60904635 -1.02042874]
mat_Sqrt:  [[ 7.11416429  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01078009 0.00587948 0.33827708]
Stock Position:  0.01078009403774959
Bond Position:  [17.00362525]


portfolio before change:  [18.073566]
curr_Stock_Price:  98.85714389682529
curr_Factors:  [98.8571439  -1.31153136 -0.97640259]
mat_Sqrt:  [[10.03161766  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 9.41919343e-05 -2.70294762e-02 -4.35917783e-02]
Stock Position:  9.419193425986288e-05
Bond Position:  [18.06425445]


portfolio before change:  [18.07814218]
curr_Stock_Price:  99.48935350311221
curr_Factors:  [99.4893535  -1.16042981 -1.00874526]
mat_Sqrt:  [[11.36883198  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00529186  0.02581703 -0.13582341]
Stock Position:  -0.005291862254048083
Bond Position:  [18.60462613]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.07550805]
Stock Price:  100.86615870257401
PL:  [17.20934935]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.30796556e-02  3.31497524e-02  3.74985783e-02]
 [ 1.00860323e-02  8.25440937e-03  1.61241292e-02]
 [ 6.59283120e-02 -6.23078469e-02 -2.63804570e-02]
 [-1.68187430e-01 -1.44507399e-01  5.42173769e-01]
 [ 3.39887722e-02 -8.98364421e-02  5.11215380e-02]
 [-8.28748446e-01  8.56500580e-01 -1.08965719e-01]
 [ 9.75709320e-03 -3.77228208e-03  2.60120142e-02]
 [-9.21988515e-02 -1.49636113e-02 -3.14766146e-02]
 [-1.56330641e-01  5.58535072e-03  4.24470397e-02]
 [-6.80880904e-01  3.09240994e-01 -3.51188549e-01]
 [ 1.30824111e-01  4.05077731e-02 -5.41558782e-02]
 [-6.49402341e-02  1.36404807e-01  7.98324280e-02]
 [ 3.20618377e-02 -8.37584661e-02 -1.09006761e-01]
 [ 3.30725853e-02  8.65403053e-01 -5.04988509e-01]
 [ 1.02355107e-01 -6.03966621e-02 -4.15997931e-02]
 [ 4.63462599e-02  7.78690013e-03  8.92766949e-02]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.77287741e-02 -1.85293990e-01 -3.47318314e-02]
 [-1.41562411e-01  5.09318974e-02 -1.63240775e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.83131842]
curr_Stock_Price:  100.06826357033316
curr_Factors:  [100.06826357  -1.03588911  -0.97620012]
mat_Sqrt:  [[13.3800309   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0021419   0.01069904  0.10697301]
Stock Position:  -0.0021418953153646107
Bond Position:  [3.04565417]


portfolio before change:  [2.8341301]
curr_Stock_Price:  99.11108728803592
curr_Factors:  [99.11108729 -1.14774602 -0.95314558]
mat_Sqrt:  [[12.12597344  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00124215 0.0026641  0.04599765]
Stock Position:  0.001242150228685403
Bond Position:  [2.71101925]


portfolio before change:  [2.83489699]
curr_Stock_Price:  99.18277685744395
curr_Factors:  [99.18277686 -1.12245357 -0.9469966 ]
mat_Sqrt:  [[12.52233944  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00381917 -0.02010977 -0.0752561 ]
Stock Position:  0.0038191655823364592
Bond Position:  [2.45610155]


portfolio before change:  [2.83862328]
curr_Stock_Price:  99.99766332425831
curr_Factors:  [99.99766332 -1.1516495  -0.93671716]
mat_Sqrt:  [[12.38864296  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0070237  -0.04663956  1.54667085]
Stock Position:  -0.007023700838921778
Bond Position:  [3.54097695]


portfolio before change:  [2.8371337]
curr_Stock_Price:  100.33579447582046
curr_Factors:  [100.33579448  -1.23869748  -0.96479483]
mat_Sqrt:  [[11.07876482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00235461 -0.02899459  0.14583552]
Stock Position:  0.0023546059406546463
Bond Position:  [2.60088245]


portfolio before change:  [2.83993706]
curr_Stock_Price:  101.25019485552737
curr_Factors:  [101.25019486  -1.40895165  -0.96162623]
mat_Sqrt:  [[ 9.45947376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07147951  0.27643437 -0.31084887]
Stock Position:  -0.07147950816001036
Bond Position:  [10.07725119]


portfolio before change:  [2.77857402]
curr_Stock_Price:  102.14391480194357
curr_Factors:  [102.1439148   -1.52049096  -0.94598941]
mat_Sqrt:  [[ 8.67029119  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00164894 -0.0012175   0.07420504]
Stock Position:  0.001648936489637772
Bond Position:  [2.6101452]


portfolio before change:  [2.77943022]
curr_Stock_Price:  102.26737175607987
curr_Factors:  [102.26737176  -1.67368308  -0.93820959]
mat_Sqrt:  [[ 7.50596474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01354635 -0.00482948 -0.08979402]
Stock Position:  -0.013546349664027103
Bond Position:  [4.16477979]


portfolio before change:  [2.76953415]
curr_Stock_Price:  103.07477649758357
curr_Factors:  [103.0747765   -1.96819756  -0.97011201]
mat_Sqrt:  [[ 5.45834228  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02684443  0.00180266  0.12108959]
Stock Position:  -0.026844426833082143
Bond Position:  [5.53651745]


portfolio before change:  [2.76354339]
curr_Stock_Price:  103.34951005498797
curr_Factors:  [103.34951005  -1.89686397  -0.98244957]
mat_Sqrt:  [[ 5.80548416  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11875726  0.0998071  -1.00184318]
Stock Position:  -0.11875726372737777
Bond Position:  [15.03704841]


portfolio before change:  [2.76826071]
curr_Stock_Price:  103.34144670054843
curr_Factors:  [103.3414467   -1.66767001  -0.99208317]
mat_Sqrt:  [[ 7.23033476  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01770848  0.01307383 -0.15449165]
Stock Position:  0.017708475151285524
Bond Position:  [0.93824126]


portfolio before change:  [2.75517177]
curr_Stock_Price:  102.58906552069351
curr_Factors:  [102.58906552  -1.15682197  -0.98886516]
mat_Sqrt:  [[12.00165104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00173318  0.04402446  0.2277397 ]
Stock Position:  -0.0017331776556466986
Bond Position:  [2.93297685]


portfolio before change:  [2.75356159]
curr_Stock_Price:  103.94121526422755
curr_Factors:  [103.94121526  -1.25969616  -1.00245191]
mat_Sqrt:  [[10.8230426   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00067321 -0.02703293 -0.31096595]
Stock Position:  -0.0006732117580305659
Bond Position:  [2.82353604]


portfolio before change:  [2.75399627]
curr_Stock_Price:  104.34419708163024
curr_Factors:  [104.34419708  -1.38538964  -1.01405371]
mat_Sqrt:  [[ 9.4711626   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01125964  0.27930763 -1.44059165]
Stock Position:  0.011259641569657808
Bond Position:  [1.57911801]


portfolio before change:  [2.73916807]
curr_Stock_Price:  102.99219785995528
curr_Factors:  [102.99219786  -1.12586384  -0.99501372]
mat_Sqrt:  [[12.35147728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00660125 -0.01949294 -0.11867263]
Stock Position:  0.006601248241869819
Bond Position:  [2.05929101]


portfolio before change:  [2.73685448]
curr_Stock_Price:  102.5637205697397
curr_Factors:  [102.56372057  -1.20583557  -0.98384537]
mat_Sqrt:  [[11.48226101  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00576187 0.00251321 0.25468156]
Stock Position:  0.005761868961141289
Bond Position:  [2.14589576]


portfolio before change:  [2.7389404]
curr_Stock_Price:  102.83262349158852
curr_Factors:  [102.83262349  -1.22083286  -0.98068938]
mat_Sqrt:  [[11.37684801  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00604647  0.00525786  0.16709793]
Stock Position:  -0.006046474018209488
Bond Position:  [3.36071519]


portfolio before change:  [2.73009264]
curr_Stock_Price:  104.43488642942937
curr_Factors:  [104.43488643  -1.47351817  -0.97190134]
mat_Sqrt:  [[ 9.05343519  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00031106 -0.05980338 -0.09908025]
Stock Position:  0.0003110632916715629
Bond Position:  [2.69760678]


portfolio before change:  [2.73091799]
curr_Stock_Price:  104.91987247796884
curr_Factors:  [104.91987248  -1.39282701  -0.97492397]
mat_Sqrt:  [[ 9.83006908  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01368232  0.0164382  -0.04656805]
Stock Position:  -0.013682316854179494
Bond Position:  [4.16646493]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.72889922]
Stock Price:  105.14355693950982
PL:  [-2.41465772]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.55826294e-02  4.47090162e-02  3.54332705e-02]
 [ 5.13605650e-02  4.17292210e-02 -1.44149297e-01]
 [ 1.54461559e-01  1.17064494e-02  1.28058841e-01]
 [-7.98137292e-02 -5.17007410e-02  2.26728376e-01]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-1.04995016e+00  8.93808712e-01 -9.35960649e-02]
 [-1.03494394e-01 -3.72676900e-02 -1.05498425e-01]
 [ 9.47831792e-02 -1.04120017e-01  2.45437893e-02]
 [ 1.06947735e-01  2.24050078e-02  3.07225363e-02]
 [ 1.52347508e-01  1.18528996e-01  8.26661008e-02]
 [-1.20964277e-02  2.43169344e-02 -4.81524255e-02]
 [-4.73771423e-02  1.45644376e-01  3.79235559e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-2.19986565e-02  6.49055295e-02 -9.41148383e-02]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 5.20944051e-02  3.25140789e-02  6.82707862e-02]
 [-8.12512686e-02  2.07887146e-02  5.25115023e-02]
 [ 2.64900174e-02 -7.25032876e-02 -3.10993760e-02]
 [-2.41961243e-02 -3.23068673e-02 -8.34033045e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.51248037]
curr_Stock_Price:  99.90200866291796
curr_Factors:  [99.90200866 -0.94817061 -1.00678675]
mat_Sqrt:  [[14.14317874  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00206627  0.01442977  0.10108126]
Stock Position:  -0.0020662719584054485
Bond Position:  [1.71890508]


portfolio before change:  [1.5153822]
curr_Stock_Price:  98.70562298516488
curr_Factors:  [98.70562299 -0.46044371 -1.00087076]
mat_Sqrt:  [[22.89291434  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00133029  0.01346805 -0.41121782]
Stock Position:  0.001330287359699511
Bond Position:  [1.38407536]


portfolio before change:  [1.51349273]
curr_Stock_Price:  97.02513564483942
curr_Factors:  [97.02513564 -0.62908775 -0.98154437]
mat_Sqrt:  [[19.38186731  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00944135 0.00377824 0.36531623]
Stock Position:  0.00944135186080303
Bond Position:  [0.59744429]


portfolio before change:  [1.51689013]
curr_Stock_Price:  97.36915601824694
curr_Factors:  [97.36915602 -0.70017836 -0.95257142]
mat_Sqrt:  [[18.64838791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236408 -0.01668634  0.64679295]
Stock Position:  -0.0023640843910434613
Bond Position:  [1.74707903]


portfolio before change:  [1.52135388]
curr_Stock_Price:  95.66578080283233
curr_Factors:  [95.6657808  -0.85297925 -0.93406256]
mat_Sqrt:  [[16.01969423  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00354547 -0.04522423  0.24245377]
Stock Position:  0.0035454722974993195
Bond Position:  [1.1821735]


portfolio before change:  [1.51917084]
curr_Stock_Price:  94.96668546561538
curr_Factors:  [94.96668547 -0.90166736 -0.91075865]
mat_Sqrt:  [[15.50403222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0571856   0.28847552 -0.26700352]
Stock Position:  -0.057185603430994845
Bond Position:  [6.94989805]


portfolio before change:  [1.49782777]
curr_Stock_Price:  95.37029681178639
curr_Factors:  [95.37029681 -0.8928647  -0.90946974]
mat_Sqrt:  [[15.7278455   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00843322 -0.0120281  -0.30095764]
Stock Position:  -0.008433221551569002
Bond Position:  [2.30210661]


portfolio before change:  [1.49889618]
curr_Stock_Price:  95.31186034240952
curr_Factors:  [95.31186034 -1.14916093 -0.90332206]
mat_Sqrt:  [[12.23953464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00641689 -0.03360459  0.0700166 ]
Stock Position:  0.0064168901918109636
Bond Position:  [0.88729043]


portfolio before change:  [1.5003455]
curr_Stock_Price:  95.50314836321868
curr_Factors:  [95.50314836 -1.35593155 -0.94919982]
mat_Sqrt:  [[ 9.52602803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01236532 0.00723119 0.08764284]
Stock Position:  0.012365316307856238
Bond Position:  [0.31941886]


portfolio before change:  [1.49292149]
curr_Stock_Price:  94.89629944557217
curr_Factors:  [94.89629945 -0.95391825 -0.90347559]
mat_Sqrt:  [[14.81130692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01305869 0.03825507 0.23582338]
Stock Position:  0.01305869130139594
Bond Position:  [0.25370001]


portfolio before change:  [1.49957175]
curr_Stock_Price:  95.40070135008072
curr_Factors:  [95.40070135 -0.9190468  -0.90690374]
mat_Sqrt:  [[15.36566365  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00110388  0.00784826 -0.13736547]
Stock Position:  -0.001103878575748243
Bond Position:  [1.60488254]


portfolio before change:  [1.49918034]
curr_Stock_Price:  96.11878428178902
curr_Factors:  [96.11878428 -1.08367741 -0.92455893]
mat_Sqrt:  [[12.90156243  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00076785  0.04700652  0.10818535]
Stock Position:  -0.000767852363065433
Bond Position:  [1.57298538]


portfolio before change:  [1.49957214]
curr_Stock_Price:  96.12073067095704
curr_Factors:  [96.12073067 -0.92824642 -0.95143785]
mat_Sqrt:  [[14.67170403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00114923 -0.00995959  0.34984664]
Stock Position:  0.0011492273411642564
Bond Position:  [1.38910757]


portfolio before change:  [1.49982999]
curr_Stock_Price:  96.04287263041836
curr_Factors:  [96.04287263 -0.75704043 -0.94890045]
mat_Sqrt:  [[17.44152401  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00160313  0.02094817 -0.26848344]
Stock Position:  -0.0016031272082608
Bond Position:  [1.65379893]


portfolio before change:  [1.49617398]
curr_Stock_Price:  98.58135551045899
curr_Factors:  [98.58135551 -0.70209463 -0.90654528]
mat_Sqrt:  [[19.73201113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00673997 -0.09296045 -0.18429859]
Stock Position:  -0.006739965719159741
Bond Position:  [2.16060893]


portfolio before change:  [1.49531159]
curr_Stock_Price:  98.78945839043617
curr_Factors:  [98.78945839 -0.77059495 -0.9117311 ]
mat_Sqrt:  [[18.36900731  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00395596 0.01049387 0.19475755]
Stock Position:  0.003955958442456164
Bond Position:  [1.1045046]


portfolio before change:  [1.49467134]
curr_Stock_Price:  98.55780456615356
curr_Factors:  [98.55780457 -0.6914908  -0.91715918]
mat_Sqrt:  [[19.72709835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0033603   0.00670953  0.1498007 ]
Stock Position:  -0.003360297762990042
Bond Position:  [1.82585491]


portfolio before change:  [1.4918439]
curr_Stock_Price:  99.53508577217664
curr_Factors:  [99.53508577 -0.81296924 -0.93491825]
mat_Sqrt:  [[17.33318221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00030821 -0.02340034 -0.08871786]
Stock Position:  0.0003082072419924733
Bond Position:  [1.46116647]


portfolio before change:  [1.49216203]
curr_Stock_Price:  99.38191394225989
curr_Factors:  [99.38191394 -0.80779032 -0.92143133]
mat_Sqrt:  [[17.63258304  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00271176 -0.010427   -0.23792641]
Stock Position:  -0.0027117617484031338
Bond Position:  [1.7616621]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.48763581]
Stock Price:  101.21345290836604
PL:  [0.2741829]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.32913778e-02  3.34053587e-02  3.74537704e-02]
 [ 2.95868978e-02  7.94089435e-02 -1.20198888e-01]
 [-6.10373703e-02  2.87660659e-02 -1.28997830e-02]
 [-3.45300545e-01 -3.76057000e-01  1.13021406e+00]
 [-1.21303892e-01  1.39419720e-01 -1.03288732e-01]
 [-1.58045171e+00  1.56356301e+00 -2.27467793e-01]
 [-1.06994335e-02 -1.74001657e-02 -1.89761100e-02]
 [-1.64329021e-02 -2.09975958e-01  3.57443701e-01]
 [-3.84716432e-02 -5.26225792e-02 -5.51167148e-02]
 [-7.68619804e-01  3.35437515e-01 -3.72276058e-01]
 [ 1.68221209e-01  6.00274156e-02 -6.49936885e-02]
 [-2.19554520e-01 -2.08702129e-01 -8.88048881e-03]
 [ 3.76186429e-01  4.83568090e-01  1.36672222e-02]
 [ 1.07809613e-02  1.33639115e+00 -8.19148077e-01]
 [ 1.69050793e-01 -1.48854884e-01  1.71028687e-02]
 [ 1.27097118e-02 -3.90327379e-02 -1.57228740e-01]
 [-7.30092413e-02 -1.44162178e-01  6.03789423e-02]
 [ 6.27762910e-02 -4.27389312e-01 -4.10847275e-03]
 [-2.88756001e-01 -1.24773776e-01 -1.76128723e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.51704235]
curr_Stock_Price:  100.02864540808302
curr_Factors:  [100.02864541  -1.28453776  -1.02025182]
mat_Sqrt:  [[ 9.98083762  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288827  0.01078153  0.10684518]
Stock Position:  -0.002888266475428405
Bond Position:  [2.80595173]


portfolio before change:  [2.51844453]
curr_Stock_Price:  99.78607657043655
curr_Factors:  [99.78607657 -1.13335881 -0.99897015]
mat_Sqrt:  [[11.83072187  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00179707  0.02562913 -0.34289397]
Stock Position:  0.0017970742217451611
Bond Position:  [2.33912154]


portfolio before change:  [2.51922053]
curr_Stock_Price:  99.89244681343578
curr_Factors:  [99.89244681 -0.81883699 -0.99267865]
mat_Sqrt:  [[16.32305342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00354092  0.00928421 -0.03679949]
Stock Position:  -0.0035409232215872495
Bond Position:  [2.87293202]


portfolio before change:  [2.51696307]
curr_Stock_Price:  100.73284515314089
curr_Factors:  [100.73284515  -0.44942069  -0.99383889]
mat_Sqrt:  [[23.78873955  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00804409 -0.12137187  3.22418613]
Stock Position:  -0.00804409494735201
Bond Position:  [3.32726764]


portfolio before change:  [2.54164972]
curr_Stock_Price:  97.76734982478136
curr_Factors:  [97.76734982 -0.16763858 -0.97852876]
mat_Sqrt:  [[31.07561227  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366618  0.04499752 -0.294654  ]
Stock Position:  -0.0036661766636687672
Bond Position:  [2.90008209]


portfolio before change:  [2.54020418]
curr_Stock_Price:  98.3594235437629
curr_Factors:  [ 9.83594235e+01  9.18224055e-02 -9.69892308e-01]
mat_Sqrt:  [[40.87662787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03199193  0.50463779 -0.6489023 ]
Stock Position:  -0.0319919349092542
Bond Position:  [5.68691246]


portfolio before change:  [2.51287494]
curr_Stock_Price:  99.25812341094834
curr_Factors:  [ 9.92581234e+01  8.99844024e-03 -9.72943986e-01]
mat_Sqrt:  [[37.85557338  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00047879 -0.00561588 -0.05413356]
Stock Position:  -0.0004787857653013285
Bond Position:  [2.56039832]


portfolio before change:  [2.5109949]
curr_Stock_Price:  104.52190391546281
curr_Factors:  [104.52190392  -0.28962878  -0.95982126]
mat_Sqrt:  [[29.96250047  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.56197736e-04 -6.77694491e-02  1.01968739e+00]
Stock Position:  0.0004561977358534629
Bond Position:  [2.46331224]


portfolio before change:  [2.51264336]
curr_Stock_Price:  106.78529699474961
curr_Factors:  [106.78529699  -0.37570984  -0.95764384]
mat_Sqrt:  [[28.14772615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214809 -0.01698386 -0.15723265]
Stock Position:  -0.0021480894822170494
Bond Position:  [2.74202773]


portfolio before change:  [2.51394463]
curr_Stock_Price:  106.49868059173231
curr_Factors:  [ 1.06498681e+02  6.84421204e-02 -9.35524622e-01]
mat_Sqrt:  [[44.74814964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01734462  0.10826199 -1.06199997]
Stock Position:  -0.01734461528522949
Bond Position:  [4.36112327]


portfolio before change:  [2.49185687]
curr_Stock_Price:  107.8350132899832
curr_Factors:  [107.83501329   0.14598275  -0.94261628]
mat_Sqrt:  [[48.61678634  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0034393   0.01937377 -0.1854089 ]
Stock Position:  0.003439295053790769
Bond Position:  [2.12098044]


portfolio before change:  [2.49126832]
curr_Stock_Price:  107.50969752619204
curr_Factors:  [107.50969753   0.29317537  -0.93276969]
mat_Sqrt:  [[56.71205139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00465454 -0.06735832 -0.02533356]
Stock Position:  -0.004654537785290762
Bond Position:  [2.99167627]


portfolio before change:  [2.48537189]
curr_Stock_Price:  108.93721803781233
curr_Factors:  [ 1.08937218e+02  1.03526900e-01 -9.53975199e-01]
mat_Sqrt:  [[46.54052489  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01026383 0.15607093 0.03898878]
Stock Position:  0.010263832718541322
Bond Position:  [1.3672585]


portfolio before change:  [2.50858845]
curr_Stock_Price:  111.16588892257586
curr_Factors:  [111.16588892  -0.12615922  -0.96258277]
mat_Sqrt:  [[37.42285414  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0031094   0.43131839 -2.33680146]
Stock Position:  0.0031094036967253655
Bond Position:  [2.16292882]


portfolio before change:  [2.50993535]
curr_Stock_Price:  111.42513548069643
curr_Factors:  [ 1.11425135e+02  6.68577490e-03 -9.36645503e-01]
mat_Sqrt:  [[43.96497116  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00323342 -0.04804271  0.04878972]
Stock Position:  0.0032334156317703703
Bond Position:  [2.14965158]


portfolio before change:  [2.51520899]
curr_Stock_Price:  112.88989070498515
curr_Factors:  [112.8898907   -0.17596939  -0.98066089]
mat_Sqrt:  [[35.50887417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00077029 -0.01259776 -0.44852983]
Stock Position:  -0.0007702861654702045
Bond Position:  [2.60216652]


portfolio before change:  [2.51283012]
curr_Stock_Price:  116.82283507641358
curr_Factors:  [116.82283508  -0.13263375  -0.97948365]
mat_Sqrt:  [[38.41857858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00234552 -0.04652814  0.17224432]
Stock Position:  -0.002345516830424887
Bond Position:  [2.78684005]


portfolio before change:  [2.51901881]
curr_Stock_Price:  114.48139630418262
curr_Factors:  [114.4813963   -0.12558927  -1.02044872]
mat_Sqrt:  [[36.39292316  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069527 -0.13793931 -0.01172033]
Stock Position:  -0.0006952677404794605
Bond Position:  [2.59861403]


portfolio before change:  [2.51752484]
curr_Stock_Price:  117.56466917412192
curr_Factors:  [117.56466917  -0.46614484  -0.98677574]
mat_Sqrt:  [[27.4967544   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01273523 -0.04027056 -0.50244622]
Stock Position:  -0.01273522906464926
Bond Position:  [4.01473783]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.52920499]
Stock Price:  116.72633815838304
PL:  [-14.19713317]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.43520545e-02 -1.53226453e-03  4.35783637e-02]
 [ 1.71214343e-02  3.29331776e-02 -5.52622966e-02]
 [ 8.97342684e-02 -5.24070985e-02 -1.39991690e-02]
 [-1.79138449e-01 -1.57387700e-01  5.66308072e-01]
 [ 6.33809585e-02 -1.33227673e-01  8.03467139e-02]
 [-5.19214438e-01  4.92131153e-01 -2.89462695e-02]
 [ 4.64249447e-03  2.03363860e-03  1.87188119e-02]
 [-9.01805699e-02 -1.84183512e-02 -2.06706827e-02]
 [ 1.07099139e-01  2.77687134e-02  4.87682386e-02]
 [-1.53078099e-02  1.61644445e-01  3.10247283e-03]
 [ 1.22386097e-01  3.23036841e-02 -5.27382871e-02]
 [-1.08162652e-01  1.13666412e-01  1.82969325e-01]
 [-1.87718775e-01 -1.24985946e-01  3.30533481e-02]
 [ 5.84599545e-02  4.16236182e-01 -1.57513229e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 6.00209412e-02  3.86677053e-02  1.48894113e-01]
 [-1.43306036e-02  1.82501185e-02  8.90167038e-02]
 [ 4.74769866e-02 -1.43031959e-01 -3.10376572e-02]
 [-4.61288739e-02 -1.76259131e-03 -5.48620449e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.38238797]
curr_Stock_Price:  100.64197892617813
curr_Factors:  [100.64197893  -1.13790261  -1.01306043]
mat_Sqrt:  [[11.71191163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00049261 -0.00049454  0.12431694]
Stock Position:  -0.0004926121909241295
Bond Position:  [7.43196544]


portfolio before change:  [7.38496722]
curr_Stock_Price:  99.17829793536329
curr_Factors:  [99.17829794 -0.99111251 -0.99365071]
mat_Sqrt:  [[13.62840201  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00092186  0.01062914 -0.15764795]
Stock Position:  0.0009218631804141039
Bond Position:  [7.2935384]


portfolio before change:  [7.38629258]
curr_Stock_Price:  98.63780966704763
curr_Factors:  [98.63780967 -1.01004836 -1.00490644]
mat_Sqrt:  [[13.15102699  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00579264 -0.01691432 -0.03993573]
Stock Position:  0.00579263854175491
Bond Position:  [6.8149194]


portfolio before change:  [7.3955604]
curr_Stock_Price:  99.94358416441565
curr_Factors:  [99.94358416 -1.09477302 -1.043085  ]
mat_Sqrt:  [[11.78406092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00811842 -0.05079666  1.6155193 ]
Stock Position:  -0.008118417571235588
Bond Position:  [8.20694415]


portfolio before change:  [7.39350951]
curr_Stock_Price:  100.44896459903563
curr_Factors:  [100.4489646   -1.39348246  -1.07227821]
mat_Sqrt:  [[ 8.53255727  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00616306 -0.04299905  0.22920681]
Stock Position:  0.00616306182133431
Bond Position:  [6.77443633]


portfolio before change:  [7.39234602]
curr_Stock_Price:  99.98534678478896
curr_Factors:  [99.98534678 -2.14585383 -1.0547614 ]
mat_Sqrt:  [[ 4.07311645  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10426101  0.15883465 -0.08257565]
Stock Position:  -0.1042610064130222
Bond Position:  [17.8169189]


portfolio before change:  [7.40615919]
curr_Stock_Price:  99.89558764033325
curr_Factors:  [99.89558764 -2.07455176 -1.09321991]
mat_Sqrt:  [[ 4.20533454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00211126 0.00065635 0.05339956]
Stock Position:  0.0021112638277012187
Bond Position:  [7.19525325]


portfolio before change:  [7.40665734]
curr_Stock_Price:  99.27942546923619
curr_Factors:  [99.27942547 -1.99561927 -1.08243368]
mat_Sqrt:  [[ 4.57170123  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02147113 -0.0059445  -0.0589677 ]
Stock Position:  -0.02147112870166082
Bond Position:  [9.53829867]


portfolio before change:  [7.41244674]
curr_Stock_Price:  99.12086279098925
curr_Factors:  [99.12086279 -1.75058487 -1.09326686]
mat_Sqrt:  [[ 5.76893918  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02127292 0.00896231 0.13912221]
Stock Position:  0.021272919562885285
Bond Position:  [5.3038566]


portfolio before change:  [7.42175904]
curr_Stock_Price:  99.49627777454808
curr_Factors:  [99.49627777 -1.65962371 -1.10757936]
mat_Sqrt:  [[ 6.25209844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00293038 0.05217052 0.00885049]
Stock Position:  0.0029303783617622365
Bond Position:  [7.1301973]


portfolio before change:  [7.42176274]
curr_Stock_Price:  98.88916512460445
curr_Factors:  [98.88916512 -1.40547841 -1.11223769]
mat_Sqrt:  [[ 7.97477619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0148236   0.01042597 -0.15044765]
Stock Position:  0.014823601114607145
Bond Position:  [5.9558692]


portfolio before change:  [7.42185611]
curr_Stock_Price:  98.7950051446053
curr_Factors:  [98.79500514 -1.47933963 -1.16340343]
mat_Sqrt:  [[ 7.03082453  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00677191  0.03668568  0.52196056]
Stock Position:  -0.0067719135617190255
Bond Position:  [8.09088734]


portfolio before change:  [7.42078435]
curr_Stock_Price:  99.25200066034483
curr_Factors:  [99.25200066 -1.76899437 -1.17664694]
mat_Sqrt:  [[ 5.2175126   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03957526 -0.04033904  0.094292  ]
Stock Position:  -0.039575263853920996
Bond Position:  [11.34870846]


portfolio before change:  [7.42662268]
curr_Stock_Price:  99.17617544796528
curr_Factors:  [99.17617545 -1.68062084 -1.20276874]
mat_Sqrt:  [[ 5.54839247  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02005474  0.13433965 -0.4493414 ]
Stock Position:  0.020054737784769648
Bond Position:  [5.43767049]


portfolio before change:  [7.42279596]
curr_Stock_Price:  98.9175679356737
curr_Factors:  [98.91756794 -1.39857009 -1.16974679]
mat_Sqrt:  [[ 7.58346313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01753725 -0.09296045 -0.18429859]
Stock Position:  -0.017537248661394063
Bond Position:  [9.15753795]


portfolio before change:  [7.42066143]
curr_Stock_Price:  99.16984284450797
curr_Factors:  [99.16984284 -1.434104   -1.1281811 ]
mat_Sqrt:  [[ 7.64880068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01285258 0.01247995 0.42475346]
Stock Position:  0.012852581900900538
Bond Position:  [6.1460729]


portfolio before change:  [7.4173899]
curr_Stock_Price:  98.79573631820554
curr_Factors:  [98.79573632 -1.27201156 -1.10819533]
mat_Sqrt:  [[ 9.14171095  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00082754 0.0058902  0.25393988]
Stock Position:  0.0008275414556177117
Bond Position:  [7.33563233]


portfolio before change:  [7.42003145]
curr_Stock_Price:  99.77140763483439
curr_Factors:  [99.77140763 -1.0588318  -1.13473635]
mat_Sqrt:  [[11.12632033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0010736  -0.04616337 -0.0885418 ]
Stock Position:  0.0010735961847043402
Bond Position:  [7.31291724]


portfolio before change:  [7.42182426]
curr_Stock_Price:  99.73820433996079
curr_Factors:  [99.73820434 -1.12621109 -1.15054098]
mat_Sqrt:  [[10.23483123  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00563637 -0.00056887 -0.15650614]
Stock Position:  -0.005636373290230829
Bond Position:  [7.98398601]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.42676901]
Stock Price:  99.21508316590725
PL:  [7.42676901]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-5.37668412e-02  8.50849961e-02  2.82161676e-02]
 [-3.91861712e-03 -3.96429639e-02  2.75038726e-02]
 [ 1.31426166e-01  8.25518356e-04  3.14750465e-02]
 [-3.31067418e-01 -3.51339932e-01  1.20565708e+00]
 [-2.50360819e-02 -2.69896129e-03 -7.56792888e-03]
 [-1.07071527e+00  1.19522199e+00 -1.78609724e-01]
 [ 3.84334891e-03 -2.25187484e-02  1.31462800e-02]
 [-6.17626696e-02 -8.97193220e-02  1.17082904e-01]
 [-5.21049520e-02 -3.90111884e-03  2.08796710e-02]
 [-6.75688706e-01  3.13950329e-01 -3.41764258e-01]
 [ 8.03485972e-02  4.42750792e-02 -5.44075260e-02]
 [-1.09094262e-02  1.28278657e-01 -5.62331437e-03]
 [-1.32283791e-01 -9.69092227e-02  5.97745068e-02]
 [ 3.34973124e-02  3.84219265e-01 -2.43717530e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 4.78373864e-02  4.67309111e-02  2.31552287e-02]
 [-8.07428085e-02  1.64851356e-02  5.46299227e-02]
 [ 4.35384675e-02 -1.95724922e-01 -3.57280112e-02]
 [-1.12507068e-01 -7.81636507e-02 -1.83730368e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.3166989]
curr_Stock_Price:  99.67141929895101
curr_Factors:  [99.6714193  -1.03524671 -1.00255858]
mat_Sqrt:  [[12.98862109  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00235894  0.02746106  0.08049287]
Stock Position:  -0.0023589369341054487
Bond Position:  [-0.08158031]


portfolio before change:  [-0.3124496]
curr_Stock_Price:  97.86140896223225
curr_Factors:  [97.86140896 -0.51653307 -0.99051504]
mat_Sqrt:  [[21.68247164  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00029501 -0.01279471  0.07846089]
Stock Position:  -0.0002950078233242051
Bond Position:  [-0.28357972]


portfolio before change:  [-0.31240842]
curr_Stock_Price:  97.48149436001931
curr_Factors:  [97.48149436 -0.36139123 -1.01240284]
mat_Sqrt:  [[24.67692238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00559306 0.00026643 0.08978955]
Stock Position:  0.00559305931977722
Bond Position:  [-0.8576282]


portfolio before change:  [-0.28756203]
curr_Stock_Price:  101.96219536476536
curr_Factors:  [101.96219536  -0.61883643  -1.01539265]
mat_Sqrt:  [[19.89310179  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00787613 -0.11339448  3.43940406]
Stock Position:  -0.007876130220289114
Bond Position:  [0.5155055]


portfolio before change:  [-0.28186515]
curr_Stock_Price:  101.25525026804397
curr_Factors:  [101.25525027  -1.0073785   -1.03261191]
mat_Sqrt:  [[13.16621604  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00206071 -0.00087109 -0.02158919]
Stock Position:  -0.002060713724818166
Bond Position:  [-0.07320706]


portfolio before change:  [-0.28645747]
curr_Stock_Price:  103.47487908375393
curr_Factors:  [103.47487908  -1.27305063  -1.07250257]
mat_Sqrt:  [[ 9.91229261  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08708381  0.38575624 -0.50952383]
Stock Position:  -0.08708380522567871
Bond Position:  [8.72452875]


portfolio before change:  [-0.32601925]
curr_Stock_Price:  103.95422410398365
curr_Factors:  [103.9542241   -1.43221667  -1.03098041]
mat_Sqrt:  [[ 8.85297512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00021803 -0.00726789  0.03750268]
Stock Position:  0.0002180286024806975
Bond Position:  [-0.34868425]


portfolio before change:  [-0.32604693]
curr_Stock_Price:  104.22713279449378
curr_Factors:  [104.22713279  -1.40497618  -1.05806094]
mat_Sqrt:  [[ 8.87763661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00632793 -0.02895679  0.33400494]
Stock Position:  -0.006327934369888886
Bond Position:  [0.33349552]


portfolio before change:  [-0.3249116]
curr_Stock_Price:  104.06089371067276
curr_Factors:  [104.06089371  -1.09250024  -1.08378557]
mat_Sqrt:  [[11.80697472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00411953 -0.00125908  0.05956389]
Stock Position:  -0.004119532793072824
Bond Position:  [0.10377067]


portfolio before change:  [-0.32120527]
curr_Stock_Price:  103.16749550593676
curr_Factors:  [103.16749551  -0.86064926  -1.12962689]
mat_Sqrt:  [[14.09863073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04832854  0.10132703 -0.9749583 ]
Stock Position:  -0.04832853723896032
Bond Position:  [4.66472888]


portfolio before change:  [-0.29751787]
curr_Stock_Price:  102.70149608881533
curr_Factors:  [102.70149609  -0.80194284  -1.11475977]
mat_Sqrt:  [[15.10648428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0051819   0.01428972 -0.15520953]
Stock Position:  0.005181901934969079
Bond Position:  [-0.82970695]


portfolio before change:  [-0.30196793]
curr_Stock_Price:  101.88276108207344
curr_Factors:  [101.88276108  -0.74757246  -1.1009604 ]
mat_Sqrt:  [[16.04327718  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00088059  0.04140176 -0.01604175]
Stock Position:  0.0008805863412834273
Bond Position:  [-0.3916845]


portfolio before change:  [-0.30339314]
curr_Stock_Price:  100.37549281992034
curr_Factors:  [100.37549282  -0.58033868  -1.10005449]
mat_Sqrt:  [[18.70002602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00747934 -0.03127732  0.17052003]
Stock Position:  -0.007479341629051965
Bond Position:  [0.44734946]


portfolio before change:  [-0.2981062]
curr_Stock_Price:  99.68357540584029
curr_Factors:  [99.68357541 -0.69666597 -1.11204102]
mat_Sqrt:  [[16.33473672  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00380643  0.12400623 -0.69525828]
Stock Position:  0.0038064347145005477
Bond Position:  [-0.67754523]


portfolio before change:  [-0.29879994]
curr_Stock_Price:  99.54582804882355
curr_Factors:  [99.54582805 -0.51683405 -1.15706044]
mat_Sqrt:  [[18.66637218  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00712474 -0.09296045 -0.18429859]
Stock Position:  -0.0071247416101687866
Bond Position:  [0.41043837]


portfolio before change:  [-0.3210994]
curr_Stock_Price:  102.69009450248346
curr_Factors:  [102.6900945   -0.42935726  -1.18235386]
mat_Sqrt:  [[20.49138479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00303068 0.01508234 0.06605542]
Stock Position:  0.003030680237823443
Bond Position:  [-0.63232024]


portfolio before change:  [-0.3149612]
curr_Stock_Price:  104.76761675951873
curr_Factors:  [104.76761676  -0.12216283  -1.19720668]
mat_Sqrt:  [[28.00477995  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236483  0.00532055  0.15584396]
Stock Position:  -0.002364828724758262
Bond Position:  [-0.06720373]


portfolio before change:  [-0.32119893]
curr_Stock_Price:  107.39822041013869
curr_Factors:  [107.39822041   0.13831389  -1.229947  ]
mat_Sqrt:  [[36.05013132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00010282 -0.06316995 -0.10192207]
Stock Position:  -0.00010281972561576945
Bond Position:  [-0.31015627]


portfolio before change:  [-0.32151003]
curr_Stock_Price:  109.66971872553572
curr_Factors:  [109.66971873   0.1277344   -1.27126153]
mat_Sqrt:  [[34.95096789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00474854 -0.02522721 -0.5241316 ]
Stock Position:  -0.004748536889480727
Bond Position:  [0.19926068]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.33787915]
Stock Price:  113.12740413667346
PL:  [-13.46528329]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-7.54671502e-03 -9.74815761e-03  4.50186163e-02]
 [ 2.98000414e-02  1.63586584e-01 -2.15218879e-01]
 [-3.35536043e-02 -8.43857565e-02 -1.35165794e-01]
 [-3.80345056e-01 -4.14574292e-01  1.44053068e+00]
 [ 1.32022244e-02 -6.28649693e-02  2.99385198e-02]
 [-1.29168699e+00  1.40663177e+00 -2.10010981e-01]
 [-6.08638640e-04 -3.68683946e-02  3.59053281e-03]
 [-2.73147445e-02 -1.81342587e-01  3.00246947e-01]
 [-5.54057391e-03 -3.82194198e-02 -3.59480106e-02]
 [-1.23489984e+00  4.41494612e-01 -6.35421100e-01]
 [ 1.59297331e-01  5.70029995e-02 -5.70906477e-02]
 [-6.53335050e-02  1.36197915e-01  8.07708470e-02]
 [ 1.62539604e-01 -4.31243136e-02 -1.79860676e-01]
 [ 1.66596573e-02  9.08519923e-01 -5.72001635e-01]
 [ 1.63331113e-01 -1.07147511e-01  1.09485216e-02]
 [ 1.27097118e-02 -3.90327379e-02 -1.57228740e-01]
 [-8.50341980e-02  1.60006732e-02  5.61361524e-02]
 [ 4.36326921e-02 -1.80576457e-01 -3.71484935e-02]
 [-1.64282340e-01  2.93618702e-02 -2.87308253e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.94992171]
curr_Stock_Price:  100.83958482145883
curr_Factors:  [100.83958482  -1.20566527  -0.98474058]
mat_Sqrt:  [[11.28105912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.07739527e-05 -3.14620434e-03  1.28425582e-01]
Stock Position:  -3.0773952728212476e-05
Bond Position:  [8.95302494]


portfolio before change:  [8.95215133]
curr_Stock_Price:  101.12930054680795
curr_Factors:  [101.12930055  -0.83471321  -0.97850381]
mat_Sqrt:  [[16.49707153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00116752  0.05279734 -0.61395956]
Stock Position:  0.0011675189281434622
Bond Position:  [8.83408095]


portfolio before change:  [8.95665829]
curr_Stock_Price:  103.09771740899191
curr_Factors:  [103.09771741  -0.67301082  -0.9461863 ]
mat_Sqrt:  [[20.41929173  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00383801 -0.02723539 -0.38559039]
Stock Position:  -0.003838006619817259
Bond Position:  [9.35234801]


portfolio before change:  [8.95982529]
curr_Stock_Price:  102.88181769187793
curr_Factors:  [102.88181769  -0.49161807  -0.92483367]
mat_Sqrt:  [[24.95637208  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00684886 -0.13380328  4.10943307]
Stock Position:  -0.006848855457282714
Bond Position:  [9.66444799]


portfolio before change:  [8.96150084]
curr_Stock_Price:  102.9899911314556
curr_Factors:  [102.98999113  -0.29445405  -0.93230363]
mat_Sqrt:  [[30.20097266  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0002146  -0.02028958  0.08540626]
Stock Position:  0.000214600406731466
Bond Position:  [8.93939915]


portfolio before change:  [8.96387262]
curr_Stock_Price:  103.62675968968983
curr_Factors:  [103.62675969  -0.38461836  -0.9124775 ]
mat_Sqrt:  [[28.3237234   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03698058  0.45398845 -0.59910287]
Stock Position:  -0.036980582783809494
Bond Position:  [12.79605059]


portfolio before change:  [8.9238917]
curr_Stock_Price:  104.7944085405003
curr_Factors:  [104.79440854  -0.66260123  -0.90846829]
mat_Sqrt:  [[21.77866662  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00033985 -0.01189922  0.01024279]
Stock Position:  -0.00033984880073863964
Bond Position:  [8.95950595]


portfolio before change:  [8.92628141]
curr_Stock_Price:  104.354333519295
curr_Factors:  [104.35433352  -0.58019149  -0.88351218]
mat_Sqrt:  [[24.14526961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.26049265e-04 -5.85280681e-02  8.56520968e-01]
Stock Position:  -0.00012604926546628083
Bond Position:  [8.9394352]


portfolio before change:  [8.92833531]
curr_Stock_Price:  105.79215876920513
curr_Factors:  [105.79215877  -0.85034191  -0.8953174 ]
mat_Sqrt:  [[18.46389304  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00112002 -0.01233526 -0.10254967]
Stock Position:  -0.0011200204199053386
Bond Position:  [9.04682469]


portfolio before change:  [8.92938153]
curr_Stock_Price:  106.87764728046844
curr_Factors:  [106.87764728  -0.92834159  -0.90839835]
mat_Sqrt:  [[17.02945946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07484001  0.14249177 -1.81267953]
Stock Position:  -0.07484001004713042
Bond Position:  [16.92810573]


portfolio before change:  [9.03147631]
curr_Stock_Price:  105.57002826127234
curr_Factors:  [105.57002826  -1.05457281  -0.87406841]
mat_Sqrt:  [[15.34413459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01038048  0.01839764 -0.16286373]
Stock Position:  0.010380477223330048
Bond Position:  [7.93560904]


portfolio before change:  [9.0175412]
curr_Stock_Price:  104.03645136638437
curr_Factors:  [104.03645137  -1.08318653  -0.8622544 ]
mat_Sqrt:  [[14.86932562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00141533  0.04395769  0.23041674]
Stock Position:  -0.0014153259135245232
Bond Position:  [9.16478669]


portfolio before change:  [9.01907248]
curr_Stock_Price:  104.5735739179966
curr_Factors:  [104.57357392  -0.91518316  -0.86691436]
mat_Sqrt:  [[17.5981425   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00664973 -0.01391831 -0.51309245]
Stock Position:  0.006649734977657411
Bond Position:  [8.32368593]


portfolio before change:  [9.02477178]
curr_Stock_Price:  105.11767372943105
curr_Factors:  [105.11767373  -0.72287066  -0.88976354]
mat_Sqrt:  [[20.95644468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00407279  0.29322354 -1.63176145]
Stock Position:  0.004072788422162734
Bond Position:  [8.59664974]


portfolio before change:  [9.03751131]
curr_Stock_Price:  107.71788144599678
curr_Factors:  [107.71788145  -1.12563633  -0.9165794 ]
mat_Sqrt:  [[13.97541717  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01028195 -0.03458171  0.03123308]
Stock Position:  0.010281952596245468
Bond Position:  [7.92996116]


portfolio before change:  [9.04208648]
curr_Stock_Price:  107.97001577928583
curr_Factors:  [107.97001578  -0.98807218  -0.9203849 ]
mat_Sqrt:  [[16.01292922  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00170812 -0.01259776 -0.44852983]
Stock Position:  -0.001708119367456811
Bond Position:  [9.22651215]


portfolio before change:  [9.04713153]
curr_Stock_Price:  106.36700174912131
curr_Factors:  [106.36700175  -0.81576083  -0.94404756]
mat_Sqrt:  [[18.30340314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00384133  0.0051642   0.16014082]
Stock Position:  -0.0038413255528541336
Bond Position:  [9.45572182]


portfolio before change:  [9.05274454]
curr_Stock_Price:  105.52125651339325
curr_Factors:  [105.52125651  -1.05250022  -0.94669549]
mat_Sqrt:  [[14.29223971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.66900179e-05 -5.82808009e-02 -1.05974312e-01]
Stock Position:  -5.6690017926537175e-05
Bond Position:  [9.05872655]


portfolio before change:  [9.05489442]
curr_Stock_Price:  107.55135323079026
curr_Factors:  [107.55135323  -1.52889708  -0.9399502 ]
mat_Sqrt:  [[ 9.1077086   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01802358  0.0094765  -0.08196105]
Stock Position:  -0.01802358153734128
Bond Position:  [10.99335501]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.07451753]
Stock Price:  106.61511174848067
PL:  [2.45940578]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.59119806e-02  5.08744951e-02  3.43261364e-02]
 [ 3.85634137e-02  1.08057714e-01 -2.65752641e-01]
 [-5.84156251e-02 -6.90222460e-02 -8.17346783e-02]
 [-3.08046918e-01 -3.13117012e-01  1.31521803e+00]
 [ 1.15388008e-02 -5.66938959e-02  2.87991304e-02]
 [-1.20494418e+00  1.25775950e+00 -1.82546321e-01]
 [ 9.70697307e-03 -3.61911514e-03  2.57319643e-02]
 [-6.71772047e-02 -7.65394702e-02  9.09094264e-02]
 [-4.65627735e-02 -8.69463325e-03  1.28721564e-02]
 [-9.60883989e-01  3.78931042e-01 -4.91603365e-01]
 [ 1.57814408e-01  5.61439065e-02 -5.69378011e-02]
 [-6.89621379e-02  1.32228841e-01  7.99515967e-02]
 [ 2.90477269e-01  2.60799541e-01 -3.40430320e-02]
 [ 1.81308644e-02  1.00020112e+00 -6.19289687e-01]
 [ 1.60019749e-01 -8.30013464e-02  7.38550957e-03]
 [ 1.71845698e-02 -3.16653830e-02 -9.82034973e-02]
 [-8.72444044e-02  1.57557699e-02  5.69824222e-02]
 [ 4.35237275e-02 -1.52695528e-01 -3.98980489e-02]
 [-1.44383892e-01  4.44949542e-02 -1.71492131e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.66254219]
curr_Stock_Price:  99.92092570516303
curr_Factors:  [99.92092571 -0.89142893 -1.0013104 ]
mat_Sqrt:  [[15.05394079  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189455  0.01641967  0.09792291]
Stock Position:  -0.0018945520602303338
Bond Position:  [1.85184759]


portfolio before change:  [1.66391955]
curr_Stock_Price:  99.43831411610091
curr_Factors:  [99.43831412 -0.6203362  -0.99734588]
mat_Sqrt:  [[19.72437953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.23157011e-04  3.48754772e-02 -7.58118313e-01]
Stock Position:  0.00032315701111327525
Bond Position:  [1.63178536]


portfolio before change:  [1.66531621]
curr_Stock_Price:  102.49773035725764
curr_Factors:  [102.49773036  -0.62126514  -0.99737379]
mat_Sqrt:  [[20.31179438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00439098 -0.02227683 -0.23316629]
Stock Position:  -0.004390983473254589
Bond Position:  [2.11538205]


portfolio before change:  [1.66011058]
curr_Stock_Price:  103.80371286145086
curr_Factors:  [103.80371286  -0.88259432  -0.98914626]
mat_Sqrt:  [[15.9707858   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0064802  -0.10105808  3.75195094]
Stock Position:  -0.006480201181744604
Bond Position:  [2.33277952]


portfolio before change:  [1.66830001]
curr_Stock_Price:  102.62995838696467
curr_Factors:  [102.62995839  -0.79721551  -0.99693059]
mat_Sqrt:  [[17.06421853  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00034252 -0.01829788  0.0821559 ]
Stock Position:  0.00034251821192801365
Bond Position:  [1.63314738]


portfolio before change:  [1.66824339]
curr_Stock_Price:  101.27248656130455
curr_Factors:  [101.27248656  -0.70166849  -0.98789974]
mat_Sqrt:  [[18.69482113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05271338  0.40594013 -0.52075384]
Stock Position:  -0.05271338006805736
Bond Position:  [7.00665847]


portfolio before change:  [1.56785435]
curr_Stock_Price:  103.2101526145681
curr_Factors:  [103.21015261  -1.16478332  -0.99541613]
mat_Sqrt:  [[11.90034956  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00119499 -0.00116806  0.07340613]
Stock Position:  0.0011949850233962526
Bond Position:  [1.44451976]


portfolio before change:  [1.56895246]
curr_Stock_Price:  103.82684587343088
curr_Factors:  [103.82684587  -1.4072522   -0.98908146]
mat_Sqrt:  [[ 9.45355538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00679574 -0.02470301  0.25933929]
Stock Position:  -0.006795744788164761
Bond Position:  [2.27453321]


portfolio before change:  [1.56627239]
curr_Stock_Price:  104.30490654500174
curr_Factors:  [104.30490655  -1.13291519  -0.99323495]
mat_Sqrt:  [[12.44312504  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00367352 -0.00280618  0.03672068]
Stock Position:  -0.003673517709466216
Bond Position:  [1.94943831]


portfolio before change:  [1.56377585]
curr_Stock_Price:  105.11719625407967
curr_Factors:  [105.11719625  -0.90107069  -0.99385751]
mat_Sqrt:  [[15.80217641  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06226251  0.12229947 -1.40240757]
Stock Position:  -0.06226250773114916
Bond Position:  [8.10863609]


portfolio before change:  [1.54934013]
curr_Stock_Price:  105.38161115906087
curr_Factors:  [105.38161116  -0.98663135  -0.98548622]
mat_Sqrt:  [[14.66510092  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01075017  0.01812037 -0.1624277 ]
Stock Position:  0.010750171857797964
Bond Position:  [0.41646969]


portfolio before change:  [1.55440013]
curr_Stock_Price:  105.8426154445205
curr_Factors:  [105.84261544  -0.82898555  -1.06230646]
mat_Sqrt:  [[15.96918969  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00160628  0.04267668  0.22807965]
Stock Position:  -0.0016062798326276755
Bond Position:  [1.72441299]


portfolio before change:  [1.55083221]
curr_Stock_Price:  108.33226805145168
curr_Factors:  [108.33226805  -0.4539263   -1.08547069]
mat_Sqrt:  [[23.23839976  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01449169  0.08417269 -0.09711529]
Stock Position:  0.014491692664195992
Bond Position:  [-0.01908573]


portfolio before change:  [1.53365288]
curr_Stock_Price:  107.14713655174312
curr_Factors:  [107.14713655  -0.50911462  -1.03351927]
mat_Sqrt:  [[22.90989954  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00418527  0.32281352 -1.7666611 ]
Stock Position:  0.0041852687018831625
Bond Position:  [1.08521332]


portfolio before change:  [1.53321177]
curr_Stock_Price:  106.97691117934924
curr_Factors:  [106.97691118  -0.4443255   -1.0378538 ]
mat_Sqrt:  [[24.29896446  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00595024 -0.02678857  0.0210688 ]
Stock Position:  0.005950242485385832
Bond Position:  [0.89667321]


portfolio before change:  [1.52779531]
curr_Stock_Price:  106.02893926272576
curr_Factors:  [106.02893926  -0.84065353  -1.00781428]
mat_Sqrt:  [[16.69725371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055846 -0.01021996 -0.28014724]
Stock Position:  -0.0005584633592482471
Bond Position:  [1.58700859]


portfolio before change:  [1.52879074]
curr_Stock_Price:  104.95701597755829
curr_Factors:  [104.95701598  -0.79481779  -1.0329191 ]
mat_Sqrt:  [[16.8746755   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429026  0.00508515  0.16255499]
Stock Position:  -0.004290262238427187
Bond Position:  [1.97908386]


portfolio before change:  [1.53089432]
curr_Stock_Price:  104.58203911135793
curr_Factors:  [104.58203911  -0.50179766  -1.04513265]
mat_Sqrt:  [[22.26556969  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00018911 -0.04928227 -0.11381803]
Stock Position:  0.00018911388068140161
Bond Position:  [1.51111641]


portfolio before change:  [1.53106614]
curr_Stock_Price:  103.49272107321468
curr_Factors:  [103.49272107  -0.62262467  -1.02168035]
mat_Sqrt:  [[19.98928268  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00694382  0.01436068 -0.04892193]
Stock Position:  -0.00694381927205868
Bond Position:  [2.24970089]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.52286037]
Stock Price:  104.75546488271196
PL:  [-3.23260451]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 3.61208597e-03 -2.31180199e-02  4.72430890e-02]
 [ 2.81331140e-02  1.58520814e-01 -2.08851726e-01]
 [-1.61068418e-03 -1.04124916e-01 -2.03814512e-01]
 [-1.16126388e-01 -5.96284649e-02  7.21630022e-01]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-6.63902162e-01  7.60038149e-01 -9.96401627e-02]
 [-2.64104194e-03 -4.34192369e-02 -7.71818116e-04]
 [-5.57095654e-02 -1.03413950e-01  1.44116514e-01]
 [-1.05015105e-01 -1.43883870e-02  7.35000129e-03]
 [-1.05092670e+00  3.97615966e-01 -5.40991837e-01]
 [ 1.57141893e-01  5.57543020e-02 -5.68684841e-02]
 [-1.27821956e-01  1.03324071e-01  2.29880156e-01]
 [ 7.83188912e-02 -7.39189576e-02 -1.04665017e-01]
 [ 2.51277664e-02  8.03911204e-01 -4.94481670e-01]
 [ 6.48558463e-02 -1.05606413e-01 -4.70878352e-02]
 [ 3.42112941e-02 -2.33184589e-02  4.50626678e-02]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.69772039e-02 -1.62997895e-01 -3.72485988e-02]
 [-1.37748093e-01  4.95415845e-02 -1.32869392e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.64728919]
curr_Stock_Price:  100.80143446629349
curr_Factors:  [100.80143447  -0.9882481   -0.97850181]
mat_Sqrt:  [[14.10321353  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00060529 -0.00746131  0.13477138]
Stock Position:  0.000605294321712127
Bond Position:  [8.58627466]


portfolio before change:  [8.64981738]
curr_Stock_Price:  101.43146081145795
curr_Factors:  [101.43146081  -1.16820939  -0.97502356]
mat_Sqrt:  [[11.89538311  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00150137  0.05116237 -0.59579584]
Stock Position:  0.0015013690287952672
Bond Position:  [8.49753133]


portfolio before change:  [8.65420636]
curr_Stock_Price:  102.93963677732815
curr_Factors:  [102.93963678  -1.45437921  -0.96168009]
mat_Sqrt:  [[ 9.18970162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0070153  -0.03360617 -0.58142607]
Stock Position:  -0.0070153046675140735
Bond Position:  [9.37635927]


portfolio before change:  [8.65282434]
curr_Stock_Price:  103.4708187402923
curr_Factors:  [103.47081874  -1.68325408  -0.95761584]
mat_Sqrt:  [[ 7.37738841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00257599 -0.019245    2.05860959]
Stock Position:  0.002575994829776659
Bond Position:  [8.38628404]


portfolio before change:  [8.65562697]
curr_Stock_Price:  103.74480828300022
curr_Factors:  [103.74480828  -2.09365916  -0.95106086]
mat_Sqrt:  [[ 4.93925293  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01149918 -0.04522423  0.24245377]
Stock Position:  0.011499184771270075
Bond Position:  [7.46264625]


portfolio before change:  [8.66116986]
curr_Stock_Price:  104.06456996128937
curr_Factors:  [104.06456996  -1.72671209  -0.91749669]
mat_Sqrt:  [[ 7.3949904   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0715483   0.24530126 -0.28424565]
Stock Position:  -0.07154829942569027
Bond Position:  [16.10681287]


portfolio before change:  [8.63462478]
curr_Stock_Price:  104.49186570892361
curr_Factors:  [104.49186571  -1.54398528  -0.9560353 ]
mat_Sqrt:  [[ 8.5770381   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00135962 -0.0140135  -0.00220178]
Stock Position:  -0.0013596189189660924
Bond Position:  [8.7766939]


portfolio before change:  [8.63623151]
curr_Stock_Price:  104.92413260647278
curr_Factors:  [104.92413261  -1.66007907  -0.96095143]
mat_Sqrt:  [[ 7.63090946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00621174 -0.03337671  0.4111243 ]
Stock Position:  -0.006211735254050825
Bond Position:  [9.28799245]


portfolio before change:  [8.64096395]
curr_Stock_Price:  104.53613328643334
curr_Factors:  [104.53613329  -1.5819035   -0.97787646]
mat_Sqrt:  [[ 8.08291701  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01316997 -0.00464383  0.02096751]
Stock Position:  -0.013169974319545795
Bond Position:  [10.01770214]


portfolio before change:  [8.63172028]
curr_Stock_Price:  105.42819330898145
curr_Factors:  [105.42819331  -1.27165711  -1.03954417]
mat_Sqrt:  [[10.45237059  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.10334432  0.12833    -1.54329913]
Stock Position:  -0.10334432487888376
Bond Position:  [19.52712574]


portfolio before change:  [8.62451721]
curr_Stock_Price:  105.54513691274876
curr_Factors:  [105.54513691  -1.30364976  -1.03972594]
mat_Sqrt:  [[10.13265119  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01548602  0.01799462 -0.16222996]
Stock Position:  0.01548602220301096
Bond Position:  [6.99004288]


portfolio before change:  [8.62168881]
curr_Stock_Price:  105.24963581526075
curr_Factors:  [105.24963582  -1.4880928   -1.0370928 ]
mat_Sqrt:  [[ 8.42454451  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00709913  0.0333477   0.6557841 ]
Stock Position:  -0.007099128909278425
Bond Position:  [9.36886954]


portfolio before change:  [8.62892693]
curr_Stock_Price:  104.56002894895197
curr_Factors:  [104.56002895  -0.99454204  -1.05978546]
mat_Sqrt:  [[13.40240075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00312374 -0.02385724 -0.29858016]
Stock Position:  0.0031237381048517107
Bond Position:  [8.30230878]


portfolio before change:  [8.63030382]
curr_Stock_Price:  104.33627625092858
curr_Factors:  [104.33627625  -0.94449895  -1.03705002]
mat_Sqrt:  [[14.38333341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00613834  0.25946123 -1.41061857]
Stock Position:  0.006138341020790054
Bond Position:  [7.98985217]


portfolio before change:  [8.61865804]
curr_Stock_Price:  102.11360821937512
curr_Factors:  [102.11360822  -1.10583756  -1.01046713]
mat_Sqrt:  [[12.30223936  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0027383  -0.03408432 -0.13432849]
Stock Position:  0.0027383033681593286
Bond Position:  [8.33904]


portfolio before change:  [8.62439499]
curr_Stock_Price:  103.44725711157143
curr_Factors:  [103.44725711  -1.66262151  -0.98694904]
mat_Sqrt:  [[ 7.31181361  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00528594 -0.007526    0.12855125]
Stock Position:  0.005285940568386755
Bond Position:  [8.07757894]


portfolio before change:  [8.62496486]
curr_Stock_Price:  103.1729854856511
curr_Factors:  [103.17298549  -1.62584658  -0.96810904]
mat_Sqrt:  [[ 7.70948534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00892275  0.00525786  0.16709793]
Stock Position:  -0.0089227507230846
Bond Position:  [9.54555169]


portfolio before change:  [8.62404217]
curr_Stock_Price:  103.54387656078268
curr_Factors:  [103.54387656  -1.36356147  -0.95591781]
mat_Sqrt:  [[10.18092808  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00059936 -0.05260734 -0.10625988]
Stock Position:  0.0005993618160148989
Bond Position:  [8.56198193]


portfolio before change:  [8.62612848]
curr_Stock_Price:  103.45302665597471
curr_Factors:  [103.45302666  -1.15299551  -0.95128966]
mat_Sqrt:  [[12.61431773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01033331  0.01598948 -0.03790394]
Stock Position:  -0.0103333091250195
Bond Position:  [9.69514059]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.63673943]
Stock Price:  102.66074775773207
PL:  [5.97599168]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 2.79080691e-02 -4.58795518e-02  4.35381421e-02]
 [ 2.18352453e-02  1.44261613e-01 -1.81941580e-01]
 [-3.43848381e-02 -8.38720947e-02 -1.33379384e-01]
 [-1.27216426e-01 -8.07953472e-02  6.20586357e-01]
 [ 6.79302220e-02 -1.39943680e-01  8.48701279e-02]
 [-9.32908941e-01  9.78233467e-01 -1.35784050e-01]
 [ 1.07173718e-02 -6.70688973e-03  3.13776415e-02]
 [-7.33507787e-02 -6.40761235e-02  6.65587617e-02]
 [-2.56258686e-02  1.90201817e-02  5.61350667e-02]
 [-7.43063729e-01  3.29118970e-01 -3.77369923e-01]
 [ 1.38630174e-01  4.50300143e-02 -5.49604586e-02]
 [-1.42837444e-02  4.62912140e-02 -2.47628295e-04]
 [ 3.52437912e-02 -6.52946914e-02 -1.27601700e-01]
 [ 1.51868727e-02  8.58888342e-01 -5.49599680e-01]
 [ 1.32800170e-01 -6.12658159e-02 -1.83366346e-02]
 [ 2.04152208e-02 -2.63464762e-02 -5.55898631e-02]
 [-7.88354721e-02  1.67004581e-02  5.39604690e-02]
 [ 4.21208201e-02 -2.27456899e-01 -3.33364641e-02]
 [-1.85150829e-01  1.34910547e-02 -4.08770362e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.85076773]
curr_Stock_Price:  101.457393578401
curr_Factors:  [101.45739358  -0.98739526  -1.03047966]
mat_Sqrt:  [[13.48750932  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00203374 -0.01480756  0.1242022 ]
Stock Position:  0.00203374323713792
Bond Position:  [13.64442944]


portfolio before change:  [13.85456107]
curr_Stock_Price:  101.64512778935773
curr_Factors:  [101.64512779  -1.0410215   -1.01456991]
mat_Sqrt:  [[13.01231475  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00108696  0.04656024 -0.51902868]
Stock Position:  0.001086959131259642
Bond Position:  [13.74407697]


portfolio before change:  [13.85829449]
curr_Stock_Price:  101.91834718125983
curr_Factors:  [101.91834718  -1.66870788  -0.97077328]
mat_Sqrt:  [[ 7.27679718  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01081947 -0.0270696  -0.38049426]
Stock Position:  -0.010819473003481699
Bond Position:  [14.9609973]


portfolio before change:  [13.8603734]
curr_Stock_Price:  102.07194149009972
curr_Factors:  [102.07194149  -1.51212487  -0.94192918]
mat_Sqrt:  [[ 8.77251749  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00194152 -0.02607659  1.77036014]
Stock Position:  -0.0019415233247863945
Bond Position:  [14.05854846]


portfolio before change:  [13.865764]
curr_Stock_Price:  101.10593505493517
curr_Factors:  [101.10593505  -1.48753166  -0.95872754]
mat_Sqrt:  [[ 8.75749259  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00647313 -0.04516663  0.24211085]
Stock Position:  0.006473129110405873
Bond Position:  [13.21129223]


portfolio before change:  [13.87268936]
curr_Stock_Price:  101.66549715804898
curr_Factors:  [101.66549716  -1.14731078  -0.92404144]
mat_Sqrt:  [[12.81140471  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05939588  0.31572349 -0.3873541 ]
Stock Position:  -0.05939588137189551
Bond Position:  [19.91120116]


portfolio before change:  [13.87979351]
curr_Stock_Price:  101.62970801794467
curr_Factors:  [101.62970802  -1.18570164  -0.95631287]
mat_Sqrt:  [[11.93316368  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00132013 -0.00216464  0.08951168]
Stock Position:  0.0013201250184025693
Bond Position:  [13.74562959]


portfolio before change:  [13.88456032]
curr_Stock_Price:  102.63717150256026
curr_Factors:  [102.6371715   -1.01164178  -0.93273187]
mat_Sqrt:  [[14.68499931  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00496044 -0.02068048  0.18987362]
Stock Position:  -0.004960436884706941
Bond Position:  [14.39368553]


portfolio before change:  [13.88656579]
curr_Stock_Price:  102.95839306754557
curr_Factors:  [102.95839307  -0.76647566  -0.92939504]
mat_Sqrt:  [[18.88662975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054456  0.00613874  0.16013772]
Stock Position:  -0.0005445581312521218
Bond Position:  [13.94263262]


portfolio before change:  [13.88949199]
curr_Stock_Price:  103.98655791555586
curr_Factors:  [103.98655792  -0.86581685  -0.95809338]
mat_Sqrt:  [[16.78274728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04486232  0.10622269 -1.07653135]
Stock Position:  -0.04486231609331691
Bond Position:  [18.55456982]


portfolio before change:  [13.91518354]
curr_Stock_Price:  103.51729254612418
curr_Factors:  [103.51729255  -0.89124959  -0.91462782]
mat_Sqrt:  [[17.01101837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00803027  0.01453337 -0.15678689]
Stock Position:  0.008030273513619407
Bond Position:  [13.08391137]


portfolio before change:  [13.93359321]
curr_Stock_Price:  105.40244418618406
curr_Factors:  [105.40244419  -0.72090449  -0.90139704]
mat_Sqrt:  [[20.81105406  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00023474  0.01494043 -0.00070641]
Stock Position:  -0.00023473759890333618
Bond Position:  [13.95833513]


portfolio before change:  [13.93767148]
curr_Stock_Price:  102.89647985545095
curr_Factors:  [102.89647986  -0.80621246  -0.87589748]
mat_Sqrt:  [[19.13680587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.15867781e-04 -2.10737710e-02 -3.64012132e-01]
Stock Position:  -0.00021586778093671548
Bond Position:  [13.95988351]


portfolio before change:  [13.94077442]
curr_Stock_Price:  104.69141422966302
curr_Factors:  [104.69141423  -0.64699015  -0.89840097]
mat_Sqrt:  [[22.32318878  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00350847  0.27720502 -1.56785491]
Stock Position:  0.003508466344948098
Bond Position:  [13.57346811]


portfolio before change:  [13.94423089]
curr_Stock_Price:  104.7092788165487
curr_Factors:  [104.70927882  -0.64283284  -0.90849381]
mat_Sqrt:  [[22.1948678   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00525128 -0.01977346 -0.05230931]
Stock Position:  0.005251276492715876
Bond Position:  [13.39437351]


portfolio before change:  [13.94921613]
curr_Stock_Price:  105.02086605725862
curr_Factors:  [105.02086606  -0.45333957  -0.92912125]
mat_Sqrt:  [[26.35605996  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.40007103e-04 -8.50328862e-03 -1.58582406e-01]
Stock Position:  0.00014000710342861505
Bond Position:  [13.93451246]


portfolio before change:  [13.95316432]
curr_Stock_Price:  108.33592483958718
curr_Factors:  [108.33592484  -0.7652613   -0.93990046]
mat_Sqrt:  [[19.68929426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00327142  0.00539005  0.1539342 ]
Stock Position:  -0.0032714159240446413
Bond Position:  [14.30757619]


portfolio before change:  [13.95705729]
curr_Stock_Price:  108.239443759008
curr_Factors:  [108.23944376  -1.14660861  -0.92302774]
mat_Sqrt:  [[13.66324645  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00081338 -0.0734114  -0.09509965]
Stock Position:  -0.0008133793286235309
Bond Position:  [14.04509702]


portfolio before change:  [13.9614124]
curr_Stock_Price:  107.20254870456594
curr_Factors:  [107.2025487   -1.1729042   -0.92933772]
mat_Sqrt:  [[13.09824315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01456233  0.00435422 -0.11661081]
Stock Position:  -0.014562332268330572
Bond Position:  [15.52253153]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.9563068]
Stock Price:  107.81966942398003
PL:  [6.13663737]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-9.55956969e-03 -5.73115065e-03  4.24558252e-02]
 [ 3.53647679e-02  1.76085271e-01 -2.39055214e-01]
 [-7.99364632e-02  3.64924324e-02 -8.56679267e-03]
 [-2.57712123e-01 -2.60534228e-01  8.25517920e-01]
 [ 5.15045845e-02 -1.15694765e-01  6.85378231e-02]
 [-1.04641262e+00  1.04085690e+00 -1.38159646e-01]
 [-2.43905323e-03  1.81342236e-02 -8.84575441e-03]
 [-1.69966472e-02  5.13160579e-02 -9.15706832e-02]
 [ 9.02454473e-02  2.40215809e-02  3.44021007e-02]
 [ 1.53977777e-01  1.16690632e-01  8.41991114e-02]
 [-4.88402958e-02 -2.76961263e-02 -3.11800532e-02]
 [ 1.03692649e-01 -2.01716995e-02 -3.11084617e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-3.27460866e-02 -9.05650932e-03 -2.63149767e-02]
 [-5.58068741e-02 -2.14099998e-01 -6.53262191e-02]
 [ 5.11142714e-02  7.23944346e-02 -1.11988088e-01]
 [ 2.48698171e-02 -6.19949256e-02  1.04089431e-01]
 [-1.35989009e-01  1.20541686e-01  1.46019679e-01]
 [ 1.17544885e-01 -1.64509795e-01 -3.16713112e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.2905033]
curr_Stock_Price:  100.5043341381441
curr_Factors:  [100.50433414  -0.87652209  -1.02561582]
mat_Sqrt:  [[15.00019119  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00013754 -0.00184972  0.12111465]
Stock Position:  -0.0001375433724942502
Bond Position:  [6.30432701]


portfolio before change:  [6.29201673]
curr_Stock_Price:  100.96128124770274
curr_Factors:  [100.96128125  -1.00058394  -1.06514374]
mat_Sqrt:  [[12.79442345  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00175944  0.05683128 -0.68195799]
Stock Position:  0.0017594448188565828
Bond Position:  [6.11438093]


portfolio before change:  [6.29233773]
curr_Stock_Price:  100.27482103588711
curr_Factors:  [100.27482104  -1.31534283  -1.06078299]
mat_Sqrt:  [[ 9.31651667  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00796823  0.01177788 -0.02443867]
Stock Position:  -0.007968231963014811
Bond Position:  [7.09135076]


portfolio before change:  [6.29432886]
curr_Stock_Price:  100.24745323331247
curr_Factors:  [100.24745323  -0.7820713   -1.05054518]
mat_Sqrt:  [[16.0390308   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00887743 -0.08408706  2.35497285]
Stock Position:  -0.008877426037254178
Bond Position:  [7.18426821]


portfolio before change:  [6.30090833]
curr_Stock_Price:  99.70865033700113
curr_Factors:  [99.70865034 -1.22092863 -1.04266244]
mat_Sqrt:  [[10.36734912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00403948 -0.03734032  0.19551933]
Stock Position:  0.00403948140111611
Bond Position:  [5.8981371]


portfolio before change:  [6.3013303]
curr_Stock_Price:  99.44803376136028
curr_Factors:  [99.44803376 -1.18370321 -1.0327378 ]
mat_Sqrt:  [[10.83947132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07953804  0.33593512 -0.39413101]
Stock Position:  -0.07953804122169715
Bond Position:  [14.21123211]


portfolio before change:  [6.30422034]
curr_Stock_Price:  99.45637206540732
curr_Factors:  [99.45637207 -0.94022649 -1.00842987]
mat_Sqrt:  [[14.16908846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.83265583e-05  5.85279551e-03 -2.52344752e-02]
Stock Position:  -3.832655826961625e-05
Bond Position:  [6.30803216]


portfolio before change:  [6.3058382]
curr_Stock_Price:  98.3954247046356
curr_Factors:  [98.3954247  -1.06709749 -1.01027095]
mat_Sqrt:  [[12.32495251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00204574  0.01656219 -0.26122567]
Stock Position:  -0.0020457351161910424
Bond Position:  [6.50712918]


portfolio before change:  [6.3101382]
curr_Stock_Price:  97.08879823262558
curr_Factors:  [97.08879823 -1.11872568 -0.98592893]
mat_Sqrt:  [[11.8339367   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00863374 0.00775293 0.09813962]
Stock Position:  0.008633739889256767
Bond Position:  [5.47189877]


portfolio before change:  [6.30110065]
curr_Stock_Price:  95.88356150577907
curr_Factors:  [95.88356151 -0.53135006 -0.96453101]
mat_Sqrt:  [[21.48281863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00907629 0.03766174 0.24019663]
Stock Position:  0.009076286850321462
Bond Position:  [5.43083394]


portfolio before change:  [6.29958098]
curr_Stock_Price:  95.56652172607907
curr_Factors:  [95.56652173 -0.47260845 -0.91359722]
mat_Sqrt:  [[23.89374966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00254704 -0.00893889 -0.08894801]
Stock Position:  -0.0025470403964881357
Bond Position:  [6.54299277]


portfolio before change:  [6.30196417]
curr_Stock_Price:  95.27314809898401
curr_Factors:  [95.2731481  -0.44655612 -0.92997265]
mat_Sqrt:  [[24.05202624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00387598 -0.00651039 -0.08874378]
Stock Position:  0.0038759782435770175
Bond Position:  [5.93268752]


portfolio before change:  [6.29467081]
curr_Stock_Price:  93.00876032602828
curr_Factors:  [93.00876033 -0.41602936 -0.9067044 ]
mat_Sqrt:  [[24.77809324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00068049 -0.00995959  0.34984664]
Stock Position:  0.0006804851062606601
Bond Position:  [6.23137973]


portfolio before change:  [6.29722527]
curr_Stock_Price:  94.47304795112689
curr_Factors:  [94.47304795 -0.29539674 -0.91332884]
mat_Sqrt:  [[28.20753111  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00141686 -0.00292298 -0.0750693 ]
Stock Position:  -0.0014168649077458853
Bond Position:  [6.43108082]


portfolio before change:  [6.29679024]
curr_Stock_Price:  95.91496729777806
curr_Factors:  [95.9149673  -0.10413833 -0.89282362]
mat_Sqrt:  [[35.39250555  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00318837 -0.06910048 -0.18635752]
Stock Position:  -0.003188373077951578
Bond Position:  [6.60260294]


portfolio before change:  [6.30772]
curr_Stock_Price:  93.00473486484773
curr_Factors:  [ 9.30047349e+01  7.88315005e-02 -9.03796743e-01]
mat_Sqrt:  [[40.75934594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00105576  0.0233652  -0.31947084]
Stock Position:  0.0010557640175876412
Bond Position:  [6.20952895]


portfolio before change:  [6.31197879]
curr_Stock_Price:  95.56800613919481
curr_Factors:  [95.56800614 -0.33774746 -0.87764369]
mat_Sqrt:  [[28.34489516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00118054 -0.02000878  0.29693817]
Stock Position:  0.0011805413929452102
Bond Position:  [6.1991568]


portfolio before change:  [6.31067998]
curr_Stock_Price:  93.15488317213658
curr_Factors:  [93.15488317 -0.47522938 -0.87689311]
mat_Sqrt:  [[24.09829344  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00338519  0.03890466  0.4165535 ]
Stock Position:  -0.003385194016444962
Bond Position:  [6.62602733]


portfolio before change:  [6.30669117]
curr_Stock_Price:  94.82259355357643
curr_Factors:  [94.82259355 -0.11709766 -0.84921038]
mat_Sqrt:  [[36.07859173  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 5.35377605e-04 -5.30953081e-02 -9.03494353e-01]
Stock Position:  0.0005353776054449278
Bond Position:  [6.25592528]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.30913404]
Stock Price:  96.46384784336615
PL:  [6.30913404]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.32913778e-02  3.34053587e-02  3.74537704e-02]
 [ 1.42440322e-02  5.37596013e-02  5.31872537e-02]
 [-6.88639143e-02  2.49335683e-03 -2.37847132e-02]
 [-6.64176742e-02 -5.24966655e-04  3.74579911e-01]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-8.43526351e-01  9.26523247e-01 -1.27616235e-01]
 [ 6.97072932e-03 -1.24385760e-02  1.98588900e-02]
 [-5.47003703e-02 -1.07527742e-01  1.52544453e-01]
 [-9.74847107e-03 -3.08775399e-02 -2.48691126e-02]
 [-9.63519284e-01  3.79973167e-01 -4.92485977e-01]
 [ 1.60792020e-01  5.78689092e-02 -5.72447072e-02]
 [-2.36685783e-02  1.18985490e-01  2.78920175e-02]
 [-2.07269703e-02 -9.61705146e-02 -8.08118512e-02]
 [ 4.41262781e-02  9.59214064e-01 -5.25592817e-01]
 [ 1.60058451e-01 -8.32835604e-02  7.42715311e-03]
 [ 1.94897858e-02 -2.78701019e-02 -6.77967376e-02]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 5.18990235e-02 -2.42313643e-01 -2.72195791e-02]
 [-1.66904231e-01  2.73678808e-02 -3.02568600e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.85710802]
curr_Stock_Price:  99.94545299535282
curr_Factors:  [99.945453   -1.23611544 -1.00102472]
mat_Sqrt:  [[10.67051576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00270159  0.01078153  0.10684518]
Stock Position:  -0.0027015862545474237
Bond Position:  [2.12711928]


portfolio before change:  [1.85673739]
curr_Stock_Price:  100.27950805186974
curr_Factors:  [100.27950805  -1.67145765  -1.013023  ]
mat_Sqrt:  [[ 6.84474165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00527039 0.01735084 0.15172843]
Stock Position:  0.005270391402085423
Bond Position:  [1.32822513]


portfolio before change:  [1.85879545]
curr_Stock_Price:  100.6069902033377
curr_Factors:  [100.6069902   -1.64950225  -0.96793979]
mat_Sqrt:  [[ 7.34323659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00996972  0.00080473 -0.06785117]
Stock Position:  -0.009969717481633202
Bond Position:  [2.86181872]


portfolio before change:  [1.85036752]
curr_Stock_Price:  101.52411489858854
curr_Factors:  [101.5241149   -1.74843891  -0.97789112]
mat_Sqrt:  [[ 6.64567539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.49510336e-03 -1.69432259e-04  1.06857222e+00]
Stock Position:  0.0014951033578939365
Bond Position:  [1.69857847]


portfolio before change:  [1.85157335]
curr_Stock_Price:  102.04657465824745
curr_Factors:  [102.04657466  -1.876257    -0.98046369]
mat_Sqrt:  [[ 5.86327682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00968697 -0.04522423  0.24245377]
Stock Position:  0.009686969231188397
Bond Position:  [0.86305132]


portfolio before change:  [1.85899062]
curr_Stock_Price:  102.78999467033464
curr_Factors:  [102.78999467  -1.50302993  -1.00961267]
mat_Sqrt:  [[ 8.33151591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08167183  0.29903409 -0.3640536 ]
Stock Position:  -0.08167182870723154
Bond Position:  [10.25403746]


portfolio before change:  [1.78318024]
curr_Stock_Price:  103.74961826832433
curr_Factors:  [103.74961827  -1.21106919  -1.01601836]
mat_Sqrt:  [[11.18857237  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0007584  -0.00401453  0.05665189]
Stock Position:  0.0007583983290720805
Bond Position:  [1.7044967]


portfolio before change:  [1.78420594]
curr_Stock_Price:  104.54012974894829
curr_Factors:  [104.54012975  -1.37145435  -1.0411632 ]
mat_Sqrt:  [[ 9.3647577   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00485986 -0.03470443  0.43516686]
Stock Position:  -0.004859855877279709
Bond Position:  [2.2922559]


portfolio before change:  [1.78167585]
curr_Stock_Price:  105.1786727402199
curr_Factors:  [105.17867274  -1.19131809  -1.07417145]
mat_Sqrt:  [[10.91536043  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193559 -0.00996568 -0.07094466]
Stock Position:  -0.0019355942462248997
Bond Position:  [1.98525908]


portfolio before change:  [1.78251205]
curr_Stock_Price:  105.0031033361013
curr_Factors:  [105.00310334  -0.83630254  -1.04964407]
mat_Sqrt:  [[15.92743815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06193625  0.12263581 -1.40492541]
Stock Position:  -0.06193625465643241
Bond Position:  [8.286011]


portfolio before change:  [1.75024713]
curr_Stock_Price:  105.55749090989076
curr_Factors:  [105.55749091  -0.84312823  -1.01558952]
mat_Sqrt:  [[16.45349615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00978026  0.01867711 -0.16330322]
Stock Position:  0.009780257842636185
Bond Position:  [0.71786765]


portfolio before change:  [1.73369343]
curr_Stock_Price:  103.84657591943366
curr_Factors:  [103.84657592  -0.84918057  -1.01385005]
mat_Sqrt:  [[16.11715052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00039167 0.0384024  0.07956816]
Stock Position:  0.0003916739080348293
Bond Position:  [1.69301943]


portfolio before change:  [1.73396189]
curr_Stock_Price:  103.45122836856822
curr_Factors:  [103.45122837  -1.17906683  -1.04306778]
mat_Sqrt:  [[11.21178737  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00507085 -0.0310389  -0.23053372]
Stock Position:  -0.005070854675418365
Bond Position:  [2.25854803]


portfolio before change:  [1.72568946]
curr_Stock_Price:  105.19395954135099
curr_Factors:  [105.19395954  -1.81135213  -1.08449732]
mat_Sqrt:  [[ 5.81218414  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02282083  0.30958501 -1.49937001]
Stock Position:  0.022820826290085833
Bond Position:  [-0.67492362]


portfolio before change:  [1.72837517]
curr_Stock_Price:  105.31904121348003
curr_Factors:  [105.31904121  -1.9429811   -1.08300206]
mat_Sqrt:  [[ 5.10903774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02829776 -0.02687965  0.0211876 ]
Stock Position:  0.028297760568761637
Bond Position:  [-1.25191784]


portfolio before change:  [1.71868629]
curr_Stock_Price:  104.9877125166844
curr_Factors:  [104.98771252  -1.69227607  -1.07540871]
mat_Sqrt:  [[ 6.59398947  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.78194323e-06 -8.99503670e-03 -1.93405221e-01]
Stock Position:  -5.781943234195113e-06
Bond Position:  [1.71929333]


portfolio before change:  [1.71911275]
curr_Stock_Price:  105.57993144709471
curr_Factors:  [105.57993145  -1.78486831  -1.05388937]
mat_Sqrt:  [[ 6.17624592  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0111378   0.00525786  0.16709793]
Stock Position:  -0.011137803897356082
Bond Position:  [2.89504132]


portfolio before change:  [1.71421194]
curr_Stock_Price:  106.08493701851347
curr_Factors:  [106.08493702  -1.87055245  -1.05072064]
mat_Sqrt:  [[ 5.71427237  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054586 -0.07820639 -0.07764988]
Stock Position:  -0.0005458639289170794
Bond Position:  [1.77211988]


portfolio before change:  [1.71480633]
curr_Stock_Price:  105.80776671020263
curr_Factors:  [105.80776671  -1.3348357   -1.07291418]
mat_Sqrt:  [[ 9.52456305  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01758547  0.00883295 -0.0863144 ]
Stock Position:  -0.017585472466204937
Bond Position:  [3.5754859]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.71842519]
Stock Price:  105.6528160219025
PL:  [-3.93439083]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 2.24909055e-02 -3.71103082e-02  3.93900148e-02]
 [ 1.71013817e-04  9.56268704e-02 -8.91292774e-02]
 [-2.58018251e-02 -8.91759762e-02 -1.51825188e-01]
 [-2.57699176e-01 -2.53728205e-01  9.89810005e-01]
 [-3.28295047e-02  8.80634846e-03 -1.53170684e-02]
 [-1.37629423e+00  1.42951993e+00 -2.11324912e-01]
 [ 1.10859444e-02 -7.83324604e-03  3.34370678e-02]
 [-5.83430334e-02 -1.02849669e-01  1.43907724e-01]
 [-6.21845838e-03  7.62469476e-03  3.66447431e-02]
 [-1.20919335e+00  4.34124489e-01 -6.23634572e-01]
 [ 1.60056351e-01  5.74427181e-02 -5.71688809e-02]
 [-1.18851617e-01  1.08043175e-01  2.08475226e-01]
 [ 1.10054572e-01 -7.50426157e-02 -1.16289048e-01]
 [ 3.40127067e-02  9.97198427e-01 -5.74459205e-01]
 [ 1.58182853e-01 -6.96068693e-02  5.40901828e-03]
 [ 1.89960484e-02 -2.86829853e-02 -7.43093387e-02]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 3.92191663e-02 -1.33973504e-01 -4.27652313e-02]
 [-1.37885597e-01  4.94370102e-02 -1.33669717e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.00784053]
curr_Stock_Price:  101.35113278119641
curr_Factors:  [101.35113278  -0.88930258  -1.03912809]
mat_Sqrt:  [[14.73403874  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00155804 -0.0119773   0.11236875]
Stock Position:  0.0015580418261519312
Bond Position:  [12.84993123]


portfolio before change:  [13.01236168]
curr_Stock_Price:  102.19082143942995
curr_Factors:  [102.19082144  -0.73345704  -1.04590844]
mat_Sqrt:  [[17.24420923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.68308550e-05  3.08634397e-02 -2.54261020e-01]
Stock Position:  8.68308550071643e-05
Bond Position:  [13.00348837]


portfolio before change:  [13.01564139]
curr_Stock_Price:  102.51825898787112
curr_Factors:  [102.51825899  -1.23034381  -1.03360835]
mat_Sqrt:  [[10.65563394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00703815 -0.02878142 -0.433115  ]
Stock Position:  -0.007038152983862474
Bond Position:  [13.73718059]


portfolio before change:  [13.0230517]
curr_Stock_Price:  101.9533982554847
curr_Factors:  [101.95339826  -0.93494441  -1.01372423]
mat_Sqrt:  [[14.52464976  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00739757 -0.08189043  2.82365243]
Stock Position:  -0.007397569647184442
Bond Position:  [13.77725906]


portfolio before change:  [13.03269095]
curr_Stock_Price:  101.11602759599462
curr_Factors:  [101.1160276  -0.6818664  -1.0082222]
mat_Sqrt:  [[18.65622824  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183094  0.00284224 -0.04369533]
Stock Position:  -0.0018309435009940497
Bond Position:  [13.21782868]


portfolio before change:  [13.03654876]
curr_Stock_Price:  100.81403081124833
curr_Factors:  [100.81403081  -0.46760488  -1.04083194]
mat_Sqrt:  [[22.30566581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05055358  0.46137557 -0.60285115]
Stock Position:  -0.050553577663593
Bond Position:  [18.13305869]


portfolio before change:  [12.98966705]
curr_Stock_Price:  101.83108134778682
curr_Factors:  [101.83108135  -0.58560563  -1.05225137]
mat_Sqrt:  [[19.79557392  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00082404 -0.00252817  0.09538665]
Stock Position:  0.0008240378716225258
Bond Position:  [12.90575438]


portfolio before change:  [12.99392397]
curr_Stock_Price:  103.08112715492425
curr_Factors:  [103.08112715  -0.70603997  -1.05941093]
mat_Sqrt:  [[17.6381721   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00283261 -0.03319459  0.41052868]
Stock Position:  -0.0028326117092798064
Bond Position:  [13.28591278]


portfolio before change:  [12.99600147]
curr_Stock_Price:  103.52043685380933
curr_Factors:  [103.52043685  -0.69574428  -1.06695457]
mat_Sqrt:  [[17.7621573   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00015865 0.00246086 0.10453725]
Stock Position:  0.0001586520565091284
Bond Position:  [12.97957774]


portfolio before change:  [12.99967893]
curr_Stock_Price:  106.24438040447305
curr_Factors:  [106.2443804   -1.24158207  -1.07231665]
mat_Sqrt:  [[10.50491443  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.11878982  0.14011308 -1.77905585]
Stock Position:  -0.1187898237056591
Bond Position:  [25.62043015]


portfolio before change:  [13.07611765]
curr_Stock_Price:  105.65482817161
curr_Factors:  [105.65482817  -1.07602375  -1.07628544]
mat_Sqrt:  [[12.27872703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01303981  0.01853956 -0.1630869 ]
Stock Position:  0.013039808368814534
Bond Position:  [11.69839893]


portfolio before change:  [13.07750293]
curr_Stock_Price:  105.53675297882674
curr_Factors:  [105.53675298  -1.34914787  -1.09290047]
mat_Sqrt:  [[ 9.17985051  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00590887  0.03487078  0.59472179]
Stock Position:  -0.005908872846598856
Bond Position:  [13.70110619]


portfolio before change:  [13.08189619]
curr_Stock_Price:  105.3730081618616
curr_Factors:  [105.37300816  -1.45336209  -1.07901569]
mat_Sqrt:  [[ 8.37397538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00847855 -0.0242199  -0.33174028]
Stock Position:  0.008478548899272857
Bond Position:  [12.18848598]


portfolio before change:  [13.0944599]
curr_Stock_Price:  106.49539487500378
curr_Factors:  [106.49539488  -1.22739308  -1.10320327]
mat_Sqrt:  [[10.35537177  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01161754  0.32184441 -1.63877221]
Stock Position:  0.0116175441676488
Bond Position:  [11.85724494]


portfolio before change:  [13.08831718]
curr_Stock_Price:  105.71146020356926
curr_Factors:  [105.7114602   -0.86033856  -1.06497159]
mat_Sqrt:  [[15.41595724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00941093 -0.02246552  0.01543042]
Stock Position:  0.00941093173152236
Bond Position:  [12.09347385]


portfolio before change:  [13.08622323]
curr_Stock_Price:  105.16765647199895
curr_Factors:  [105.16765647  -1.04662642  -1.06882122]
mat_Sqrt:  [[12.68104258  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.59858439e-04 -9.25739371e-03 -2.11983860e-01]
Stock Position:  -0.00015985843919515312
Bond Position:  [13.10303517]


portfolio before change:  [13.08969495]
curr_Stock_Price:  103.94438013133917
curr_Factors:  [103.94438013  -0.76271171  -1.05033011]
mat_Sqrt:  [[16.95926213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00405618  0.00525786  0.16709793]
Stock Position:  -0.004056179768103225
Bond Position:  [13.51131204]


portfolio before change:  [13.09873592]
curr_Stock_Price:  102.5483072335104
curr_Factors:  [102.54830723  -0.65240356  -1.05180694]
mat_Sqrt:  [[18.65517287  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00016845 -0.04323976 -0.1219973 ]
Stock Position:  0.00016845317473128936
Bond Position:  [13.08146134]


portfolio before change:  [13.10207417]
curr_Stock_Price:  102.94882193558219
curr_Factors:  [102.94882194  -0.58947939  -1.06849091]
mat_Sqrt:  [[19.61435475  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00665445  0.01595573 -0.03813225]
Stock Position:  -0.0066544545234402605
Bond Position:  [13.78714242]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.10012368]
Stock Price:  103.75996364033303
PL:  [9.34016004]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.60154227e-03 -1.69255958e-02  4.62768270e-02]
 [ 3.85123040e-02  1.76259087e-01 -2.61793874e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-2.11562628e-01 -1.92266038e-01  8.30607703e-01]
 [-1.70990402e-02 -1.44162934e-02  3.24013494e-04]
 [-1.20600680e+00  1.25302288e+00 -1.83667249e-01]
 [-5.92523461e-03  2.43779187e-02 -1.87703335e-02]
 [-9.09663141e-02 -1.93540447e-02 -1.94812863e-02]
 [ 9.26222102e-02  3.01856447e-02  6.20190046e-02]
 [-5.91181314e-02  1.73911743e-01 -1.73179921e-02]
 [ 8.80206299e-03  3.02328341e-02 -5.15616161e-02]
 [-4.72197384e-02  1.45727183e-01  3.75479601e-02]
 [-1.87718775e-01 -1.24985946e-01  3.30533481e-02]
 [ 1.69946855e-02  4.71671424e-01 -3.42692011e-01]
 [-1.35755795e-02 -2.19277180e-01 -5.80028608e-02]
 [ 6.08662576e-02  4.65448234e-02  1.47950049e-01]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.19194488e-02 -1.39754962e-01 -3.95548117e-02]
 [-1.04874423e-01  1.07730623e-01 -4.72528995e-04]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.27813107]
curr_Stock_Price:  100.88095943626524
curr_Factors:  [100.88095944  -1.1431284   -0.96396309]
mat_Sqrt:  [[12.26622695  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00035787 -0.00546271  0.13201491]
Stock Position:  0.0003578731032347928
Bond Position:  [9.24202848]


portfolio before change:  [9.28035845]
curr_Stock_Price:  100.64789718240772
curr_Factors:  [100.64789718  -0.91110631  -0.98904617]
mat_Sqrt:  [[15.05147188  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00139871  0.05688738 -0.74682505]
Stock Position:  0.0013987063078976882
Bond Position:  [9.13958161]


portfolio before change:  [9.28242011]
curr_Stock_Price:  100.48808523676028
curr_Factors:  [100.48808524  -1.03486796  -1.01285356]
mat_Sqrt:  [[12.9658327   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00601756  0.01370813 -0.02999186]
Stock Position:  -0.0060175648035695195
Bond Position:  [9.88711367]


portfolio before change:  [9.27748495]
curr_Stock_Price:  101.71902151831168
curr_Factors:  [101.71902152  -1.11076876  -1.07206838]
mat_Sqrt:  [[11.46589727  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00708725 -0.0620536   2.36949258]
Stock Position:  -0.007087250100240135
Bond Position:  [9.9983931]


portfolio before change:  [9.28649778]
curr_Stock_Price:  100.80005951353519
curr_Factors:  [100.80005951  -1.10493933  -1.09068708]
mat_Sqrt:  [[11.21792046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00178069 -0.00465284  0.00092432]
Stock Position:  -0.001780687861483961
Bond Position:  [9.46599122]


portfolio before change:  [9.28924192]
curr_Stock_Price:  100.58815001603188
curr_Factors:  [100.58815002  -1.03103937  -1.09286714]
mat_Sqrt:  [[12.02668527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08212782  0.4044114  -0.52395154]
Stock Position:  -0.08212782413201088
Bond Position:  [17.55032781]


portfolio before change:  [9.39386404]
curr_Stock_Price:  99.36768672361157
curr_Factors:  [99.36768672 -1.23796433 -1.07404874]
mat_Sqrt:  [[ 9.84352535  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048566  0.00786794 -0.05354654]
Stock Position:  -0.00048565843199036555
Bond Position:  [9.4421228]


portfolio before change:  [9.39587489]
curr_Stock_Price:  100.08830164007954
curr_Factors:  [100.08830164  -1.12236593  -1.06149362]
mat_Sqrt:  [[11.27055141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00877451 -0.00624649 -0.05557469]
Stock Position:  -0.008774507942628879
Bond Position:  [10.27410049]


portfolio before change:  [9.39539793]
curr_Stock_Price:  100.4354226453847
curr_Factors:  [100.43542265  -1.02163648  -1.05825527]
mat_Sqrt:  [[12.548777    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00888082 0.00974237 0.17692296]
Stock Position:  0.008880818058029424
Bond Position:  [8.50344921]


portfolio before change:  [9.39232272]
curr_Stock_Price:  99.84974059160665
curr_Factors:  [99.84974059 -1.1227719  -1.09430493]
mat_Sqrt:  [[10.87633824  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249657  0.05612977 -0.04940341]
Stock Position:  -0.002496572399177159
Bond Position:  [9.64160482]


portfolio before change:  [9.39625041]
curr_Stock_Price:  99.24211090263377
curr_Factors:  [99.2421109  -0.89800023 -1.08577923]
mat_Sqrt:  [[13.65059315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00032587  0.00975761 -0.14709094]
Stock Position:  0.0003258718175528642
Bond Position:  [9.3639102]


portfolio before change:  [9.39885123]
curr_Stock_Price:  100.03858102760208
curr_Factors:  [100.03858103  -0.96057374  -1.10046324]
mat_Sqrt:  [[12.73709938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007701   0.04703325  0.10711388]
Stock Position:  -0.000770101277425446
Bond Position:  [9.47589107]


portfolio before change:  [9.40089957]
curr_Stock_Price:  100.45532121774926
curr_Factors:  [100.45532122  -0.97443931  -1.06439935]
mat_Sqrt:  [[13.07725421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01578959 -0.04033904  0.094292  ]
Stock Position:  -0.01578958659968823
Bond Position:  [10.98704756]


portfolio before change:  [9.40182803]
curr_Stock_Price:  100.57050098765129
curr_Factors:  [100.57050099  -0.55635398  -1.02904567]
mat_Sqrt:  [[20.60346656  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210268  0.1522313  -0.97760492]
Stock Position:  0.002102680048980939
Bond Position:  [9.19036044]


portfolio before change:  [9.40458485]
curr_Stock_Price:  100.7887676267644
curr_Factors:  [100.78876763  -0.76522486  -1.05836876]
mat_Sqrt:  [[16.27179592  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00431269 -0.07077141 -0.16546602]
Stock Position:  -0.004312685045361212
Bond Position:  [9.83925506]


portfolio before change:  [9.41168157]
curr_Stock_Price:  99.7136614408801
curr_Factors:  [99.71366144 -1.03435968 -1.02028136]
mat_Sqrt:  [[12.77719131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00787085 0.01502228 0.42206031]
Stock Position:  0.007870850076316481
Bond Position:  [8.62685029]


portfolio before change:  [9.42821378]
curr_Stock_Price:  101.54005056688915
curr_Factors:  [101.54005057  -0.93471259  -1.04831632]
mat_Sqrt:  [[13.97715761  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00492159  0.00525786  0.16709793]
Stock Position:  -0.0049215883402199895
Bond Position:  [9.92795211]


portfolio before change:  [9.42977483]
curr_Stock_Price:  101.72723744171465
curr_Factors:  [101.72723744  -1.05851093  -1.03206659]
mat_Sqrt:  [[12.57508622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0004229  -0.04510572 -0.11283887]
Stock Position:  0.0004228992580030741
Bond Position:  [9.38675445]


portfolio before change:  [9.43204759]
curr_Stock_Price:  101.55173228208083
curr_Factors:  [101.55173228  -1.30439054  -1.01984523]
mat_Sqrt:  [[ 9.93766985  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00835009  0.03476991 -0.00134799]
Stock Position:  -0.008350091832928794
Bond Position:  [10.28001388]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.42802101]
Stock Price:  102.34177225677459
PL:  [7.08624875]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-9.43030170e-02  1.74180725e-01  5.70462597e-03]
 [ 1.50395051e-02  2.64734302e-02 -1.00734891e-01]
 [ 9.75015529e-02 -3.38563077e-02 -2.02482830e-02]
 [-2.52643430e-01 -2.55392230e-01  7.36712327e-01]
 [-5.96945799e-02  4.84668442e-02 -4.20294926e-02]
 [-1.32972404e+00  1.29883712e+00 -1.84278042e-01]
 [-6.02353942e-02  5.38384188e-02 -1.29331507e-01]
 [-1.30081969e-02 -6.96923393e-03  9.15146269e-03]
 [-6.52982218e-03  2.81120969e-02  4.84610887e-02]
 [ 1.54563510e-01  1.18085513e-01  8.68346452e-02]
 [ 4.56223153e-03  2.39073847e-02 -5.17438278e-02]
 [ 1.21590693e-01 -4.31308094e-02 -3.50199923e-02]
 [-8.47210836e-02 -7.28196518e-02  8.27010158e-02]
 [ 2.75308463e-02  3.35059862e-01 -2.17111512e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 3.62723880e-02  9.15947836e-03 -7.73708003e-02]
 [ 1.21912097e-01 -2.52534572e-02  1.43863151e-01]
 [-6.08853604e-02  4.33902377e-02  5.96215336e-02]
 [-2.90573144e-02  1.13354191e-01 -9.25406303e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.01384896]
curr_Stock_Price:  99.07928879243836
curr_Factors:  [99.07928879 -0.90692457 -1.00871279]
mat_Sqrt:  [[14.58922245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00394703  0.05621659  0.01627371]
Stock Position:  -0.003947028271285581
Bond Position:  [-4.6227802]


portfolio before change:  [-5.01351497]
curr_Stock_Price:  98.7018340595402
curr_Factors:  [98.70183406 -0.61771212 -1.02616955]
mat_Sqrt:  [[19.07201071  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.24224260e-06  8.54426285e-03 -2.87368605e-01]
Stock Position:  -6.242242603598469e-06
Bond Position:  [-5.01289885]


portfolio before change:  [-5.01476774]
curr_Stock_Price:  98.60366495223289
curr_Factors:  [98.60366495 -0.51894485 -1.01765766]
mat_Sqrt:  [[21.21070316  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00407613 -0.01092708 -0.05776272]
Stock Position:  0.004076126042376791
Bond Position:  [-5.41668871]


portfolio before change:  [-5.01302587]
curr_Stock_Price:  99.36326159001817
curr_Factors:  [99.36326159 -0.66228045 -1.01753112]
mat_Sqrt:  [[18.52221599  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00833563 -0.08242749  2.10163521]
Stock Position:  -0.008335632017039386
Bond Position:  [-4.18477029]


portfolio before change:  [-5.01180525]
curr_Stock_Price:  99.09130296778736
curr_Factors:  [99.09130297 -0.65936919 -0.99039125]
mat_Sqrt:  [[19.03503517  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306701  0.01564261 -0.11989844]
Stock Position:  -0.003067005681268834
Bond Position:  [-4.70789166]


portfolio before change:  [-5.01012142]
curr_Stock_Price:  98.15848773627305
curr_Factors:  [98.15848774 -0.54116754 -0.97934656]
mat_Sqrt:  [[21.45739379  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05136764  0.41919788 -0.52569396]
Stock Position:  -0.05136763743400604
Bond Position:  [0.03204819]


portfolio before change:  [-4.96069121]
curr_Stock_Price:  97.19636070023459
curr_Factors:  [ 9.71963607e+01  1.30220588e-02 -9.59498688e-01]
mat_Sqrt:  [[37.72249647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200531  0.01737627 -0.36894679]
Stock Position:  -0.002005311507242127
Bond Position:  [-4.76578223]


portfolio before change:  [-4.96514009]
curr_Stock_Price:  98.82068865542934
curr_Factors:  [98.82068866 -0.2221638  -0.95784699]
mat_Sqrt:  [[30.36516902  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041372 -0.00224931  0.02610658]
Stock Position:  -0.0004137224230611416
Bond Position:  [-4.92425576]


portfolio before change:  [-4.96502918]
curr_Stock_Price:  95.57666996674422
curr_Factors:  [95.57666997 -0.39232674 -0.9036678 ]
mat_Sqrt:  [[26.15222342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00034799 0.00907314 0.138246  ]
Stock Position:  0.0003479862398053057
Bond Position:  [-4.99828855]


portfolio before change:  [-4.96584266]
curr_Stock_Price:  96.83033289610351
curr_Factors:  [96.8303329  -0.56822947 -0.91061486]
mat_Sqrt:  [[22.06772144  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00889954 0.03811194 0.24771507]
Stock Position:  0.008899544179822564
Bond Position:  [-5.82758848]


portfolio before change:  [-4.9583725]
curr_Stock_Price:  97.83344388455738
curr_Factors:  [97.83344388 -0.56661722 -0.8835755 ]
mat_Sqrt:  [[22.94439681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.88074984e-05  7.71607524e-03 -1.47610738e-01]
Stock Position:  -4.880749842558382e-05
Bond Position:  [-4.9535975]


portfolio before change:  [-4.95965085]
curr_Stock_Price:  98.64869252642754
curr_Factors:  [98.64869253 -0.44075771 -0.91787764]
mat_Sqrt:  [[25.35382557  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00416656 -0.01392041 -0.09990229]
Stock Position:  0.004166559685569008
Bond Position:  [-5.37067651]


portfolio before change:  [-4.95625129]
curr_Stock_Price:  99.78689669497746
curr_Factors:  [99.78689669 -0.31912196 -0.95910642]
mat_Sqrt:  [[27.79367551  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297564 -0.02350244  0.23592298]
Stock Position:  -0.0029756430960082977
Bond Position:  [-4.6593211]


portfolio before change:  [-4.95434637]
curr_Stock_Price:  98.7552232130555
curr_Factors:  [98.75522321 -0.40625034 -0.98641552]
mat_Sqrt:  [[24.532001    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00210366  0.10814011 -0.61935871]
Stock Position:  0.0021036585023229827
Bond Position:  [-5.16209364]


portfolio before change:  [-4.95506697]
curr_Stock_Price:  99.02622317045385
curr_Factors:  [99.02622317 -0.58469344 -0.99379001]
mat_Sqrt:  [[20.42789254  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00651037 -0.09296045 -0.18429859]
Stock Position:  -0.006510367052559977
Bond Position:  [-4.31036991]


portfolio before change:  [-4.94468071]
curr_Stock_Price:  97.26534191689072
curr_Factors:  [97.26534192 -0.51412704 -0.9827217 ]
mat_Sqrt:  [[21.77133063  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00102652  0.00295621 -0.22071736]
Stock Position:  0.0010265247702340718
Bond Position:  [-5.04452599]


portfolio before change:  [-4.9481718]
curr_Stock_Price:  95.09315709165364
curr_Factors:  [95.09315709 -0.71959424 -0.98347205]
mat_Sqrt:  [[17.31876729  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00843727 -0.00815052  0.41040153]
Stock Position:  0.008437274859861517
Bond Position:  [-5.75049891]


portfolio before change:  [-4.94093288]
curr_Stock_Price:  96.12153748681033
curr_Factors:  [96.12153749 -0.70753973 -0.98581082]
mat_Sqrt:  [[17.67697336  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00225481  0.01400414  0.17008364]
Stock Position:  -0.0022548074182491317
Bond Position:  [-4.72419732]


portfolio before change:  [-4.94546589]
curr_Stock_Price:  97.60805544182276
curr_Factors:  [97.60805544 -1.26550109 -0.96499169]
mat_Sqrt:  [[10.49047019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236489  0.03658491 -0.26399266]
Stock Position:  -0.0023648858170511183
Bond Position:  [-4.71463398]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.95121027]
Stock Price:  99.53862522523414
PL:  [-4.95121027]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-3.44844872e-02  2.27730497e-02  3.93176226e-02]
 [ 2.27686716e-02  5.26726212e-02 -1.07040954e-01]
 [ 1.20463935e-01 -2.38903778e-02  6.08286606e-02]
 [ 4.24101087e-02  4.06900635e-02 -7.62369304e-02]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-9.95287661e-01  9.81517364e-01 -1.25254584e-01]
 [-3.08666202e-03  1.50955833e-02 -1.59304267e-03]
 [-6.05303499e-02  1.05621753e-02 -5.10398590e-02]
 [ 1.08816631e-01  2.75980411e-02  4.83588538e-02]
 [ 1.22972443e-01  1.28965667e-01  7.44216521e-02]
 [ 1.22922384e-01  3.23134617e-02 -5.27438428e-02]
 [-5.13430739e-02  1.43557984e-01  4.73870218e-02]
 [-1.76949892e-01 -1.19531720e-01  3.82442403e-02]
 [ 3.63259284e-02  5.15471458e-01 -3.00331969e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 6.38161639e-02  5.47434567e-02  1.70146643e-01]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.34758225e-02 -1.50593566e-01 -4.01243341e-02]
 [-2.01042733e-01  1.40501017e-03 -5.01266962e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.16692816]
curr_Stock_Price:  100.48875605193706
curr_Factors:  [100.48875605  -1.31489142  -1.02539936]
mat_Sqrt:  [[ 9.67703028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00225382  0.00734997  0.11216223]
Stock Position:  -0.0022538197297022862
Bond Position:  [6.39341171]


portfolio before change:  [6.17127399]
curr_Stock_Price:  99.26981675925468
curr_Factors:  [99.26981676 -0.89748766 -1.0274892 ]
mat_Sqrt:  [[14.48139479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00080592  0.01700002 -0.30535805]
Stock Position:  0.0008059156165854869
Bond Position:  [6.09127089]


portfolio before change:  [6.17155808]
curr_Stock_Price:  97.7325373909231
curr_Factors:  [97.73253739 -0.91658975 -0.9910429 ]
mat_Sqrt:  [[14.50657347  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00882386 -0.00771059  0.17352724]
Stock Position:  0.008823857058518137
Bond Position:  [5.30918014]


portfolio before change:  [6.16738255]
curr_Stock_Price:  97.10888889718537
curr_Factors:  [97.1088889  -1.01659378 -0.99844881]
mat_Sqrt:  [[12.94604484  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00271543  0.01313266 -0.21748274]
Stock Position:  0.0027154343531571707
Bond Position:  [5.90368974]


portfolio before change:  [6.17253387]
curr_Stock_Price:  98.46234141924627
curr_Factors:  [98.46234142 -1.14856019 -1.0185742 ]
mat_Sqrt:  [[11.27445747  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0050377  -0.04522423  0.24245377]
Stock Position:  0.005037704233411687
Bond Position:  [5.67650972]


portfolio before change:  [6.17802233]
curr_Stock_Price:  99.27008055137024
curr_Factors:  [99.27008055 -1.3024336  -1.04672679]
mat_Sqrt:  [[ 9.4752566   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08659436  0.31678337 -0.35731647]
Stock Position:  -0.086594357047856
Bond Position:  [14.77425113]


portfolio before change:  [6.12588914]
curr_Stock_Price:  99.9147785900663
curr_Factors:  [99.91477859 -1.25901645 -1.06451246]
mat_Sqrt:  [[ 9.78439437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.37749529e-05  4.87207856e-03 -4.54450733e-03]
Stock Position:  -3.37749528620038e-05
Bond Position:  [6.12926376]


portfolio before change:  [6.12745673]
curr_Stock_Price:  98.87591653745768
curr_Factors:  [98.87591654 -1.67605823 -1.02747251]
mat_Sqrt:  [[ 6.62158627  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01038918  0.00340893 -0.14560251]
Stock Position:  -0.010389175599281427
Bond Position:  [7.15469599]


portfolio before change:  [6.12663792]
curr_Stock_Price:  99.12691971093793
curr_Factors:  [99.12691971 -1.74764178 -1.03611128]
mat_Sqrt:  [[ 6.12664921  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02029189 0.00890723 0.13795435]
Stock Position:  0.020291885975785028
Bond Position:  [4.11516576]


portfolio before change:  [6.12377591]
curr_Stock_Price:  98.93517159942336
curr_Factors:  [98.9351716  -1.91338412 -1.03120074]
mat_Sqrt:  [[ 5.20635473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.03159383 0.04162349 0.21230426]
Stock Position:  0.03159383382700269
Bond Position:  [2.99803453]


portfolio before change:  [6.11719174]
curr_Stock_Price:  98.70304509191756
curr_Factors:  [98.70304509 -1.5145175  -1.01221793]
mat_Sqrt:  [[ 7.88829777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0150542   0.01042912 -0.1504635 ]
Stock Position:  0.015054204780216551
Bond Position:  [4.63129589]


portfolio before change:  [6.11017431]
curr_Stock_Price:  98.15998073680417
curr_Factors:  [98.15998074 -1.06398141 -1.00003278]
mat_Sqrt:  [[12.46075884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00099244  0.04633314  0.13518198]
Stock Position:  -0.0009924426043996018
Bond Position:  [6.20759245]


portfolio before change:  [6.1103199]
curr_Stock_Price:  99.57719215181103
curr_Factors:  [99.57719215 -1.29201708 -1.00458344]
mat_Sqrt:  [[10.01749062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01932047 -0.0385787   0.10910017]
Stock Position:  -0.019320470232757826
Bond Position:  [8.03419808]


portfolio before change:  [6.10503377]
curr_Stock_Price:  99.95476745583912
curr_Factors:  [99.95476746 -1.13306896 -0.96280643]
mat_Sqrt:  [[12.29069373  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00652861  0.1663677  -0.85676351]
Stock Position:  0.00652860567111953
Bond Position:  [5.45246851]


portfolio before change:  [6.10204747]
curr_Stock_Price:  99.28853277976191
curr_Factors:  [99.28853278 -1.12891697 -0.95554178]
mat_Sqrt:  [[12.34895362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01076958 -0.09296045 -0.18429859]
Stock Position:  -0.010769582801463807
Bond Position:  [7.17134355]


portfolio before change:  [6.09330453]
curr_Stock_Price:  100.2668434071686
curr_Factors:  [100.26684341  -0.8938004   -0.99149428]
mat_Sqrt:  [[15.2189351   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00720955 0.01766837 0.48538101]
Stock Position:  0.007209549322746246
Bond Position:  [5.37042578]


portfolio before change:  [6.10328964]
curr_Stock_Price:  101.46557729056367
curr_Factors:  [101.46557729  -0.78193022  -1.01442616]
mat_Sqrt:  [[16.83337001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00408651  0.00525786  0.16709793]
Stock Position:  -0.004086514814707921
Bond Position:  [6.51793022]


portfolio before change:  [6.09684335]
curr_Stock_Price:  103.44182701870513
curr_Factors:  [103.44182702  -0.82421961  -1.0397635 ]
mat_Sqrt:  [[16.03904864  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00028341 -0.04860386 -0.11446356]
Stock Position:  0.00028341420109824446
Bond Position:  [6.06752647]


portfolio before change:  [6.09968171]
curr_Stock_Price:  108.10387870177296
curr_Factors:  [108.1038787   -1.23965869  -1.08779473]
mat_Sqrt:  [[10.54486674  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0200086   0.00045347 -0.14299751]
Stock Position:  -0.020008598591344948
Bond Position:  [8.26268883]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.08121206]
Stock Price:  109.13021675865917
PL:  [-3.0490047]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 1.19300049e-02 -2.90855265e-02  4.35172251e-02]
 [ 3.69801055e-02  1.35638431e-01 -2.26483980e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-3.29848328e-01 -3.56069438e-01  1.05906011e+00]
 [-1.13068659e-01  1.27262173e-01 -9.51002928e-02]
 [-1.51738152e+00  1.45838780e+00 -2.10308439e-01]
 [-2.34040482e-01 -1.88881668e-01 -1.56455433e-01]
 [ 2.37189174e-02  3.29107660e-02 -4.48015322e-02]
 [ 7.51387929e-02  2.71053387e-02  5.01574293e-02]
 [ 7.20076528e-02  1.47314699e-01  5.53013172e-02]
 [ 8.01475669e-03  5.53025063e-03 -4.86180449e-02]
 [ 1.19806804e-01 -4.08230719e-02 -3.46242160e-02]
 [ 2.43738011e-02 -1.75652494e-02  1.35287695e-01]
 [ 2.16678324e-02  1.79072485e-01 -1.28464427e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 3.48066040e-02  1.05684428e-02 -8.83497528e-02]
 [-1.87568948e-02  2.38577312e-02  7.58913455e-02]
 [-9.63890208e-02  6.98981502e-02  1.08041604e-01]
 [ 1.61873072e-01 -2.07498039e-01 -3.81777529e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.60161789]
curr_Stock_Price:  101.0478003745003
curr_Factors:  [101.04780037  -0.95099574  -1.03130648]
mat_Sqrt:  [[13.91951004  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00106871 -0.00938731  0.12414253]
Stock Position:  0.00106870593819486
Bond Position:  [10.4936275]


portfolio before change:  [10.6033318]
curr_Stock_Price:  100.19647347034812
curr_Factors:  [100.19647347  -0.93574456  -1.04421779]
mat_Sqrt:  [[13.83457147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00133263  0.04377712 -0.64609575]
Stock Position:  0.0013326278724633445
Bond Position:  [10.46980719]


portfolio before change:  [10.60702126]
curr_Stock_Price:  101.00065772010116
curr_Factors:  [101.00065772  -0.87401242  -1.0693641 ]
mat_Sqrt:  [[14.46526869  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0053938   0.01370813 -0.02999186]
Stock Position:  -0.005393798079702483
Bond Position:  [11.15179842]


portfolio before change:  [10.61266547]
curr_Stock_Price:  100.47117684747552
curr_Factors:  [100.47117685  -0.49157472  -1.02455003]
mat_Sqrt:  [[22.05956161  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00844763 -0.11492092  3.02120371]
Stock Position:  -0.00844762743063121
Bond Position:  [11.46140854]


portfolio before change:  [10.63652201]
curr_Stock_Price:  97.98635793973047
curr_Factors:  [97.98635794 -0.25685923 -1.034407  ]
mat_Sqrt:  [[26.93864919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00395356  0.04107369 -0.27129466]
Stock Position:  -0.003953562847454405
Bond Position:  [11.02391723]


portfolio before change:  [10.64521321]
curr_Stock_Price:  96.48521214427689
curr_Factors:  [96.48521214 -0.44069109 -1.0711376 ]
mat_Sqrt:  [[21.27560397  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05934583  0.47069264 -0.59995144]
Stock Position:  -0.05934583060590126
Bond Position:  [16.37120826]


portfolio before change:  [10.76458705]
curr_Stock_Price:  94.54269100201395
curr_Factors:  [94.542691   -0.34893933 -1.0344278 ]
mat_Sqrt:  [[23.70496125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01284677 -0.0609613  -0.4463238 ]
Stock Position:  -0.012846767373066012
Bond Position:  [11.97915501]


portfolio before change:  [10.72740723]
curr_Stock_Price:  97.66993530148912
curr_Factors:  [97.6699353  -0.7320866  -1.06776095]
mat_Sqrt:  [[16.14719321  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0013186  0.0106219 -0.1278063]
Stock Position:  0.0013186022264414703
Bond Position:  [10.59861944]


portfolio before change:  [10.73191217]
curr_Stock_Price:  99.07669241313097
curr_Factors:  [99.07669241 -0.5903951  -1.07113035]
mat_Sqrt:  [[18.80962624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00483316 0.00874821 0.14308518]
Stock Position:  0.004833162984932507
Bond Position:  [10.25305837]


portfolio before change:  [10.73570876]
curr_Stock_Price:  99.33180463317964
curr_Factors:  [99.33180463 -0.41193914 -1.08906012]
mat_Sqrt:  [[22.14178505  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00512002 0.04754561 0.15775927]
Stock Position:  0.005120024135256599
Bond Position:  [10.22712752]


portfolio before change:  [10.72757776]
curr_Stock_Price:  97.24429542402947
curr_Factors:  [97.24429542 -0.43500659 -1.06844167]
mat_Sqrt:  [[21.6234431   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.60951995e-05  1.78488072e-03 -1.38693749e-01]
Stock Position:  -3.609519945496773e-05
Bond Position:  [10.73108781]


portfolio before change:  [10.73022828]
curr_Stock_Price:  98.14723244431826
curr_Factors:  [ 9.81472324e+01 -9.72585165e-02 -1.07919417e+00]
mat_Sqrt:  [[30.26572955  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00344965 -0.01317559 -0.09877325]
Stock Position:  0.0034496505560601604
Bond Position:  [10.39165462]


portfolio before change:  [10.7348199]
curr_Stock_Price:  98.72508494971083
curr_Factors:  [ 9.87250849e+01  7.22368340e-03 -1.09028812e+00]
mat_Sqrt:  [[33.42401415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144817 -0.00566916  0.38593814]
Stock Position:  0.0014481741935832861
Bond Position:  [10.59184878]


portfolio before change:  [10.73622842]
curr_Stock_Price:  97.86899064614063
curr_Factors:  [97.86899065 -0.33364317 -1.10785782]
mat_Sqrt:  [[23.15310199  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138202  0.0577954  -0.36647325]
Stock Position:  0.001382024706152321
Bond Position:  [10.60097106]


portfolio before change:  [10.73940755]
curr_Stock_Price:  98.25144183970575
curr_Factors:  [98.25144184 -0.63904657 -1.11850488]
mat_Sqrt:  [[16.94509613  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00784847 -0.09296045 -0.18429859]
Stock Position:  -0.00784846999755892
Bond Position:  [11.51053105]


portfolio before change:  [10.75051746]
curr_Stock_Price:  97.20258631241987
curr_Factors:  [97.20258631 -0.47389114 -1.13258741]
mat_Sqrt:  [[19.498134    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00097084  0.00341095 -0.25203725]
Stock Position:  0.0009708395966668605
Bond Position:  [10.65614934]


portfolio before change:  [10.75274011]
curr_Stock_Price:  96.74759941890707
curr_Factors:  [96.74759942 -0.44272241 -1.15950533]
mat_Sqrt:  [[19.48953737  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [8.23159728e-05 7.70004963e-03 2.16496885e-01]
Stock Position:  8.231597278444547e-05
Bond Position:  [10.74477624]


portfolio before change:  [10.75523914]
curr_Stock_Price:  94.46981272894219
curr_Factors:  [94.46981273 -0.6504254  -1.145875  ]
mat_Sqrt:  [[15.67363398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00383237  0.02255953  0.30821262]
Stock Position:  -0.0038323735636829745
Bond Position:  [11.11728275]


portfolio before change:  [10.76201563]
curr_Stock_Price:  93.42690181945584
curr_Factors:  [93.42690182 -0.38466407 -1.15345588]
mat_Sqrt:  [[20.06665307  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00207248 -0.0669697  -1.08910502]
Stock Position:  0.0020724781546141687
Bond Position:  [10.56839042]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.7643272]
Stock Price:  93.26725469134126
PL:  [10.7643272]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-3.58409618e-02  2.44106829e-02  3.90305442e-02]
 [ 2.69026867e-02  1.55387855e-01 -2.03797256e-01]
 [-1.43921841e-02 -9.62265752e-02 -1.76345715e-01]
 [-2.47683377e-01 -2.41145264e-01  9.48535334e-01]
 [ 1.39344976e-03 -4.17164708e-02  1.87114266e-02]
 [-1.31500615e+00  1.46357972e+00 -2.25832689e-01]
 [ 1.12817741e-02 -8.43170093e-03  3.45312808e-02]
 [-4.78863698e-02 -1.13128188e-02 -7.84922717e-03]
 [ 7.00799077e-02  2.67614589e-02  4.73869797e-02]
 [ 1.54681149e-01  1.19337182e-01  8.83493693e-02]
 [-4.75388716e-03  2.82967951e-02 -5.04469796e-02]
 [ 1.18338717e-02  9.88566717e-02 -1.06691770e-02]
 [-3.15845998e-02 -4.59070732e-02  1.08314235e-01]
 [-1.62718539e-02  6.12457482e-02 -8.57430216e-02]
 [-5.01732857e-02 -2.45742833e-01 -5.12659984e-02]
 [ 3.66493315e-02  4.91817047e-03 -5.93565206e-02]
 [-7.43593398e-02  2.04149980e-02  5.63568760e-02]
 [ 6.98976861e-03 -5.11925022e-02 -8.29552153e-03]
 [-1.39478310e-01  4.82257272e-02 -1.42939876e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.21824061]
curr_Stock_Price:  100.24310127508936
curr_Factors:  [100.24310128  -1.08872448  -0.98212459]
mat_Sqrt:  [[12.63851855  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00181122  0.00787851  0.11134328]
Stock Position:  -0.0018112150897381513
Bond Position:  [4.39980243]


portfolio before change:  [4.21694013]
curr_Stock_Price:  101.56849105399307
curr_Factors:  [101.56849105  -1.17668029  -1.0104845 ]
mat_Sqrt:  [[11.39948942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00149315  0.05015121 -0.58137685]
Stock Position:  0.001493150994111222
Bond Position:  [4.06528304]


portfolio before change:  [4.22000782]
curr_Stock_Price:  102.94226084332979
curr_Factors:  [102.94226084  -1.0920914   -1.03262602]
mat_Sqrt:  [[12.29817452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0056944  -0.03105699 -0.50306524]
Stock Position:  -0.0056944036484359705
Bond Position:  [4.80620261]


portfolio before change:  [4.22756584]
curr_Stock_Price:  101.82602163146794
curr_Factors:  [101.82602163  -0.96739033  -1.00301648]
mat_Sqrt:  [[14.19456109  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00727659 -0.0778293   2.70590729]
Stock Position:  -0.007276588758787405
Bond Position:  [4.96851193]


portfolio before change:  [4.22569906]
curr_Stock_Price:  102.253290907962
curr_Factors:  [102.25329091  -0.81826072  -1.03642417]
mat_Sqrt:  [[16.00287016  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00020637 -0.01346393  0.05337849]
Stock Position:  -0.0002063651831141802
Bond Position:  [4.24680058]


portfolio before change:  [4.22635018]
curr_Stock_Price:  104.2435214190514
curr_Factors:  [104.24352142  -0.80665555  -1.06639348]
mat_Sqrt:  [[16.01748087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06632454  0.47236832 -0.6442378 ]
Stock Position:  -0.06632454297267286
Bond Position:  [11.1402541]


portfolio before change:  [4.39673725]
curr_Stock_Price:  101.7165283329664
curr_Factors:  [101.71652833  -0.50346865  -1.0363848 ]
mat_Sqrt:  [[21.80929734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00076157 -0.00272132  0.09850813]
Stock Position:  0.0007615710070541373
Bond Position:  [4.31927289]


portfolio before change:  [4.39618557]
curr_Stock_Price:  99.57406614964557
curr_Factors:  [99.57406615 -0.43070567 -1.06837194]
mat_Sqrt:  [[22.23848042  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0023292  -0.0036512  -0.02239166]
Stock Position:  -0.0023291971883173564
Bond Position:  [4.6281132]


portfolio before change:  [4.39960079]
curr_Stock_Price:  98.60461201569474
curr_Factors:  [98.60461202 -0.6518765  -1.03289379]
mat_Sqrt:  [[18.28987709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00465916 0.00863722 0.13518186]
Stock Position:  0.004659156206641716
Bond Position:  [3.9401865]


portfolio before change:  [4.39324249]
curr_Stock_Price:  97.0284741185353
curr_Factors:  [97.02847412 -0.70308917 -0.99980919]
mat_Sqrt:  [[17.67420313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01115043 0.03851591 0.25203616]
Stock Position:  0.011150431373896331
Bond Position:  [3.31133315]


portfolio before change:  [4.38126036]
curr_Stock_Price:  95.8796333570397
curr_Factors:  [95.87963336 -0.89443839 -1.01403871]
mat_Sqrt:  [[14.21953163  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00065229  0.00913275 -0.14391119]
Stock Position:  -0.0006522911494232967
Bond Position:  [4.44380179]


portfolio before change:  [4.38152264]
curr_Stock_Price:  97.18090081336209
curr_Factors:  [97.18090081 -0.68081613 -1.00521661]
mat_Sqrt:  [[18.00305482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00165722  0.03190585 -0.03043619]
Stock Position:  0.001657222563872983
Bond Position:  [4.22047226]


portfolio before change:  [4.38416038]
curr_Stock_Price:  98.13580587064668
curr_Factors:  [98.13580587 -0.53338572 -1.01801399]
mat_Sqrt:  [[20.79999161  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090605 -0.01481644  0.30899036]
Stock Position:  -0.0009060480185704185
Bond Position:  [4.47307613]


portfolio before change:  [4.386999]
curr_Stock_Price:  96.23722124054918
curr_Factors:  [96.23722124 -0.40323928 -1.01128614]
mat_Sqrt:  [[23.38958369  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090948  0.01976698 -0.24460097]
Stock Position:  -0.0009094791597931513
Bond Position:  [4.47452475]


portfolio before change:  [4.38898019]
curr_Stock_Price:  95.28896764810365
curr_Factors:  [95.28896765 -0.50402363 -1.00308313]
mat_Sqrt:  [[21.11127545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524838 -0.07931316 -0.14624762]
Stock Position:  -0.005248378279342902
Bond Position:  [4.88909273]


portfolio before change:  [4.38268969]
curr_Stock_Price:  96.72044262926043
curr_Factors:  [96.72044263 -0.74553516 -1.01387405]
mat_Sqrt:  [[16.65008933  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00153375  0.00158733 -0.16932763]
Stock Position:  0.0015337545251422606
Bond Position:  [4.23434427]


portfolio before change:  [4.38640154]
curr_Stock_Price:  98.450270298308
curr_Factors:  [98.4502703  -0.74253359 -1.01413287]
mat_Sqrt:  [[16.99442073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00345339  0.00658891  0.16077048]
Stock Position:  -0.0034533890628182253
Bond Position:  [4.72638863]


portfolio before change:  [4.38611699]
curr_Stock_Price:  98.87486579407748
curr_Factors:  [98.87486579 -0.4321669  -1.03569846]
mat_Sqrt:  [[22.78243185  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00022619 -0.01652231 -0.02366481]
Stock Position:  -0.0002261906641313686
Bond Position:  [4.40848156]


portfolio before change:  [4.38631696]
curr_Stock_Price:  102.86393620658538
curr_Factors:  [102.86393621  -0.78638159  -1.03118661]
mat_Sqrt:  [[16.70718562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00793383  0.01556479 -0.04077677]
Stock Position:  -0.00793383311832491
Bond Position:  [5.20242226]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.37857808]
Stock Price:  104.00331617168918
PL:  [0.3752619]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 4.77086876e-02 -1.10878285e-01  6.70173994e-02]
 [ 2.32813100e-02  1.46919892e-01 -1.88480640e-01]
 [-5.51466759e-02 -7.10422964e-02 -8.87599963e-02]
 [-1.02284525e-01 -4.62259154e-02  5.61230786e-01]
 [ 6.03810495e-02 -1.28798954e-01  7.73638508e-02]
 [-7.92819184e-01  8.59659797e-01 -1.12528723e-01]
 [ 1.02491704e-02 -5.27606816e-03  2.87615319e-02]
 [-8.83407830e-02 -2.45031838e-02 -1.25091121e-02]
 [ 3.58859670e-02  2.52123561e-02  5.96140514e-02]
 [-3.35949891e-02  1.65967275e-01 -6.32798087e-03]
 [ 1.20896990e-01  3.22765349e-02 -5.27228607e-02]
 [-7.02895028e-02  1.33590670e-01  9.25967987e-02]
 [-6.48144481e-02 -9.29307116e-02 -1.13124447e-01]
 [ 2.48888550e-02  6.60183179e-01 -4.18063638e-01]
 [ 6.94646094e-02 -9.89269266e-02 -4.64464498e-02]
 [ 5.57459441e-02  2.10672755e-02  1.61813294e-01]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 3.44227029e-02 -1.04443365e-01 -4.64877471e-02]
 [-1.39105279e-01  4.85094230e-02 -1.40768703e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.99102025]
curr_Stock_Price:  101.09688908035366
curr_Factors:  [101.09688908  -1.42381462  -1.00610148]
mat_Sqrt:  [[ 8.90099663  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00435408 -0.03578581  0.19118199]
Stock Position:  0.004354076676198054
Bond Position:  [10.55083664]


portfolio before change:  [10.99597472]
curr_Stock_Price:  101.62890437808147
curr_Factors:  [101.62890438  -1.44838143  -0.9719537 ]
mat_Sqrt:  [[ 9.03397843  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00163801  0.04741819 -0.5376828 ]
Stock Position:  0.0016380112003245098
Bond Position:  [10.82950544]


portfolio before change:  [10.99850546]
curr_Stock_Price:  101.52085937516227
curr_Factors:  [101.52085938  -1.59354875  -0.96884186]
mat_Sqrt:  [[ 7.82930445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01120996 -0.0229288  -0.25320756]
Stock Position:  -0.01120995904854341
Bond Position:  [12.13655014]


portfolio before change:  [10.99363769]
curr_Stock_Price:  102.22579381649903
curr_Factors:  [102.22579382  -1.6316738   -0.98055547]
mat_Sqrt:  [[ 7.50038801  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.78700930e-04 -1.49193500e-02  1.60103522e+00]
Stock Position:  0.00037870092967012467
Bond Position:  [10.95492469]


portfolio before change:  [10.99640668]
curr_Stock_Price:  102.30479705300951
curr_Factors:  [102.30479705  -1.69989964  -1.00102628]
mat_Sqrt:  [[ 6.86908321  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0072618  -0.04156968  0.22069753]
Stock Position:  0.007261799219961999
Bond Position:  [10.25348979]


portfolio before change:  [10.9994552]
curr_Stock_Price:  102.37156136761003
curr_Factors:  [102.37156137  -1.64018253  -1.03789421]
mat_Sqrt:  [[ 7.03242936  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09105128  0.27745401 -0.32101312]
Stock Position:  -0.09105127964535464
Bond Position:  [20.32051687]


portfolio before change:  [11.03273091]
curr_Stock_Price:  102.06190133021919
curr_Factors:  [102.06190133  -1.18466814  -1.02444673]
mat_Sqrt:  [[11.20617133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0013424  -0.00170284  0.08204864]
Stock Position:  0.0013423960962891865
Bond Position:  [10.89572341]


portfolio before change:  [11.03604215]
curr_Stock_Price:  102.49915624986807
curr_Factors:  [102.49915625  -1.31992906  -1.01901277]
mat_Sqrt:  [[ 9.88395502  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00970218 -0.00790837 -0.03568502]
Stock Position:  -0.00970217752037336
Bond Position:  [12.03050716]


portfolio before change:  [11.05666522]
curr_Stock_Price:  100.68357735480062
curr_Factors:  [100.68357735  -1.42538286  -0.95456099]
mat_Sqrt:  [[ 9.31884647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00570898 0.00813725 0.1700623 ]
Stock Position:  0.005708977516279591
Bond Position:  [10.48186494]


portfolio before change:  [11.05569376]
curr_Stock_Price:  100.05434808078216
curr_Factors:  [100.05434808  -1.49771029  -0.93026967]
mat_Sqrt:  [[ 8.82627934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00011429  0.05356571 -0.01805197]
Stock Position:  -0.00011428990074260061
Bond Position:  [11.06712896]


portfolio before change:  [11.05851619]
curr_Stock_Price:  99.57050851166325
curr_Factors:  [99.57050851 -1.32647943 -0.85291563]
mat_Sqrt:  [[11.26241375  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01036398  0.01041721 -0.15040365]
Stock Position:  0.010363977409072576
Bond Position:  [10.02656969]


portfolio before change:  [11.07309836]
curr_Stock_Price:  100.7356229019829
curr_Factors:  [100.7356229   -1.296774    -0.83887224]
mat_Sqrt:  [[11.90374722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202618  0.0431162   0.26415289]
Stock Position:  -0.002026183733159323
Bond Position:  [11.27720724]


portfolio before change:  [11.07361027]
curr_Stock_Price:  101.87458691538698
curr_Factors:  [101.87458692  -1.29768774  -0.83204253]
mat_Sqrt:  [[12.10976621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00882554 -0.02999326 -0.32271256]
Stock Position:  -0.008825544552554264
Bond Position:  [11.97270897]


portfolio before change:  [11.08509303]
curr_Stock_Price:  100.91269614360047
curr_Factors:  [100.91269614  -1.27945266  -0.8329274 ]
mat_Sqrt:  [[12.20536602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00608841  0.2130732  -1.19261919]
Stock Position:  0.006088412203007324
Bond Position:  [10.47069494]


portfolio before change:  [11.09649035]
curr_Stock_Price:  102.354668895475
curr_Factors:  [102.3546689   -1.0578514   -0.83488368]
mat_Sqrt:  [[15.4206705   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00258033 -0.03192853 -0.13249879]
Stock Position:  0.002580328345589369
Bond Position:  [10.8323817]


portfolio before change:  [11.09790336]
curr_Stock_Price:  101.8526276988202
curr_Factors:  [101.8526277   -1.32433388  -0.81670979]
mat_Sqrt:  [[11.97095472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00777518 0.00679943 0.46160829]
Stock Position:  0.007775176352648496
Bond Position:  [10.30598121]


portfolio before change:  [11.10207686]
curr_Stock_Price:  102.05798446707624
curr_Factors:  [102.05798447  -1.07426079  -0.80983249]
mat_Sqrt:  [[15.50942408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00443536  0.00525786  0.16709793]
Stock Position:  -0.004435355920237674
Bond Position:  [11.55474034]


portfolio before change:  [11.10562179]
curr_Stock_Price:  101.9101076872095
curr_Factors:  [101.91010769  -0.75697181  -0.85374627]
mat_Sqrt:  [[20.35594576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00017754 -0.03370895 -0.1326166 ]
Stock Position:  0.00017754118395729967
Bond Position:  [11.08752855]


portfolio before change:  [11.10852936]
curr_Stock_Price:  102.6724286927799
curr_Factors:  [102.67242869  -0.75417068  -0.87835635]
mat_Sqrt:  [[20.06579432  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00658218  0.01565635 -0.04015739]
Stock Position:  -0.006582184670787474
Bond Position:  [11.78433825]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.11049633]
Stock Price:  102.82123685572972
PL:  [8.28925948]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-6.08383192e-02  1.19971417e-01  2.19803093e-02]
 [-8.84571334e-03 -5.71322223e-02  1.27495816e-01]
 [ 9.15942154e-02 -4.61988013e-02 -1.79698417e-02]
 [ 7.20150798e-03  8.54115547e-03  2.64349648e-02]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-1.06394291e+00  9.81069232e-01 -1.18252380e-01]
 [-2.79299076e-02  1.23723954e-02 -5.74490522e-02]
 [ 6.77671581e-02 -4.34683233e-02 -1.24013888e-02]
 [ 3.82098989e-02  2.59074659e-02  4.15300238e-02]
 [ 1.51197637e-01  1.27340161e-01  8.92067107e-02]
 [-1.52956131e-03  3.00444692e-02 -5.14545859e-02]
 [ 2.47011982e-02  8.22107880e-02 -1.35239417e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-1.08351578e-02  5.60125926e-03 -2.34866267e-02]
 [-5.75644039e-02 -1.88788470e-01 -7.24337771e-02]
 [ 4.29224274e-02  3.14294062e-02 -3.29963952e-02]
 [-8.71125418e-02  1.89359935e-02  5.32809937e-02]
 [ 3.99164048e-02 -1.07800616e-01 -3.59333531e-02]
 [-1.56889811e-01  3.49840057e-02 -2.44281072e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.10723353]
curr_Stock_Price:  99.57176319531646
curr_Factors:  [99.5717632  -0.97909397 -1.02242152]
mat_Sqrt:  [[13.45516612  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236805  0.03872061  0.0627037 ]
Stock Position:  -0.0023680528505143233
Bond Position:  [-0.87144234]


portfolio before change:  [-1.10460512]
curr_Stock_Price:  98.3698064023355
curr_Factors:  [98.3698064  -0.99533982 -1.01888089]
mat_Sqrt:  [[13.12492639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00042036 -0.01843935  0.36371007]
Stock Position:  0.0004203600713175913
Bond Position:  [-1.14595586]


portfolio before change:  [-1.10477268]
curr_Stock_Price:  98.6528120083099
curr_Factors:  [98.65281201 -0.81696195 -1.06937023]
mat_Sqrt:  [[14.95842313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0052476  -0.0149106  -0.05126296]
Stock Position:  0.005247601655548468
Bond Position:  [-1.62246334]


portfolio before change:  [-1.10998941]
curr_Stock_Price:  97.73600039588537
curr_Factors:  [97.7360004  -1.14490042 -1.04470168]
mat_Sqrt:  [[10.94264866  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00131056 0.00275665 0.0754116 ]
Stock Position:  0.0013105582648076722
Bond Position:  [-1.23807814]


portfolio before change:  [-1.11081925]
curr_Stock_Price:  97.3390091241781
curr_Factors:  [97.33900912 -0.79688022 -1.01998556]
mat_Sqrt:  [[15.82093466  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00359001 -0.04522423  0.24245377]
Stock Position:  0.003590014329248772
Bond Position:  [-1.46026769]


portfolio before change:  [-1.11203159]
curr_Stock_Price:  97.10301255783885
curr_Factors:  [97.10301256 -1.01590534 -0.97208226]
mat_Sqrt:  [[13.30027615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06675208  0.31663873 -0.33734113]
Stock Position:  -0.0667520841733657
Bond Position:  [5.36979687]


portfolio before change:  [-1.05699331]
curr_Stock_Price:  96.29860822756581
curr_Factors:  [96.29860823 -1.12083837 -0.97299973]
mat_Sqrt:  [[11.8652715   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031294   0.00399317 -0.16388616]
Stock Position:  -0.003129396714433422
Bond Position:  [-0.75563676]


portfolio before change:  [-1.05734498]
curr_Stock_Price:  96.35060894234266
curr_Factors:  [96.35060894 -0.86261993 -0.99624955]
mat_Sqrt:  [[15.01611921  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00375349 -0.01402934 -0.03537771]
Stock Position:  0.0037534865088945705
Bond Position:  [-1.41899569]


portfolio before change:  [-1.06045345]
curr_Stock_Price:  95.61697704299989
curr_Factors:  [95.61697704 -0.7655229  -1.00824265]
mat_Sqrt:  [[16.22551229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00320332 0.0083616  0.1184736 ]
Stock Position:  0.003203320667035434
Bond Position:  [-1.36674529]


portfolio before change:  [-1.06425259]
curr_Stock_Price:  94.53765396429039
curr_Factors:  [94.53765396 -0.89546435 -1.01632095]
mat_Sqrt:  [[13.97420195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01398292 0.04109886 0.25448192]
Stock Position:  0.01398291530003503
Bond Position:  [-2.3861646]


portfolio before change:  [-1.04018651]
curr_Stock_Price:  96.30142736611792
curr_Factors:  [96.30142737 -0.91758119 -1.0343464 ]
mat_Sqrt:  [[13.67481124  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00043144  0.00969681 -0.14678561]
Stock Position:  -0.00043144164657469983
Bond Position:  [-0.99863807]


portfolio before change:  [-1.0402344]
curr_Stock_Price:  95.83367798430011
curr_Factors:  [95.83367798 -0.60372253 -1.05640143]
mat_Sqrt:  [[18.21945899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0021253   0.02653342 -0.03858004]
Stock Position:  0.0021253014170162596
Bond Position:  [-1.24390985]


portfolio before change:  [-1.04045923]
curr_Stock_Price:  95.87422892363413
curr_Factors:  [95.87422892 -0.69588083 -1.09449145]
mat_Sqrt:  [[16.00121956  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00105374 -0.00995959  0.34984664]
Stock Position:  0.0010537398945521797
Bond Position:  [-1.14148573]


portfolio before change:  [-1.04062776]
curr_Stock_Price:  95.98514654085902
curr_Factors:  [95.98514654 -0.57128734 -1.14686272]
mat_Sqrt:  [[17.21951609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084125  0.0018078  -0.06700081]
Stock Position:  -0.000841254371935781
Bond Position:  [-0.95987984]


portfolio before change:  [-1.0409449]
curr_Stock_Price:  96.07684652164161
curr_Factors:  [96.07684652 -0.11160948 -1.11579086]
mat_Sqrt:  [[28.15564909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00393833 -0.06093122 -0.2066334 ]
Stock Position:  -0.003938327663692968
Bond Position:  [-0.6625628]


portfolio before change:  [-1.05189204]
curr_Stock_Price:  98.81442329591744
curr_Factors:  [98.8144233  -0.26086093 -1.1162438 ]
mat_Sqrt:  [[24.93166922  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00170877  0.0101438  -0.09412953]
Stock Position:  0.0017087731550346928
Bond Position:  [-1.22074347]


portfolio before change:  [-1.05154206]
curr_Stock_Price:  99.19785610587256
curr_Factors:  [99.19785611 -0.61220763 -1.10847682]
mat_Sqrt:  [[17.7508242   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00407707  0.00611157  0.15199584]
Stock Position:  -0.004077067643360414
Bond Position:  [-0.64710569]


portfolio before change:  [-1.05488416]
curr_Stock_Price:  99.97790292307073
curr_Factors:  [99.97790292 -0.52432674 -1.07934504]
mat_Sqrt:  [[20.11121076  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00052592 -0.0347925  -0.10250785]
Stock Position:  0.0005259171853715803
Bond Position:  [-1.10746426]


portfolio before change:  [-1.05286916]
curr_Stock_Price:  104.33581885771461
curr_Factors:  [104.33581886  -1.10826401  -1.1059922 ]
mat_Sqrt:  [[11.39709525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01357671  0.01129104 -0.06968659]
Stock Position:  -0.013576713489390504
Bond Position:  [0.36366836]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.05212148]
Stock Price:  104.28744508254924
PL:  [-5.33956656]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.32913778e-02  3.34053587e-02  3.74537704e-02]
 [-7.50072039e-03 -5.27698207e-02  1.41930087e-01]
 [ 1.25030000e-01 -2.39336512e-02  8.85745786e-02]
 [-7.76063880e-03  8.03827539e-03  8.97706010e-02]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-1.07500333e+00  1.04180887e+00 -1.34225415e-01]
 [ 1.66690590e-03  7.59226035e-03  3.28859793e-03]
 [-2.36633847e-02  3.97196532e-02 -7.59879562e-02]
 [ 1.57255892e-01  2.17961577e-02  3.07294300e-02]
 [ 1.54831009e-01  1.20931672e-01  9.02789623e-02]
 [ 7.01649491e-02  3.13515946e-02 -5.21973034e-02]
 [-3.46161667e-02  1.52357654e-01  7.47344480e-03]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-1.82830111e-02  3.70207114e-02 -6.29017492e-02]
 [-5.13905114e-02 -2.96660767e-01 -4.58469211e-02]
 [ 4.20436826e-02  2.03356661e-02 -4.45786704e-02]
 [ 4.99302236e-02  1.46074470e-02  1.07451098e-01]
 [-5.42311328e-02  3.88963707e-02  5.02801369e-02]
 [ 5.65184154e-02 -3.97865902e-02 -2.08850141e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.01963944]
curr_Stock_Price:  100.09200362886446
curr_Factors:  [100.09200363  -1.12603121  -0.97799504]
mat_Sqrt:  [[12.20765909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236141  0.01078153  0.10684518]
Stock Position:  -0.002361412494719062
Bond Position:  [3.25599795]


portfolio before change:  [3.02402794]
curr_Stock_Price:  98.578331134262
curr_Factors:  [98.57833113 -1.17174107 -0.95340371]
mat_Sqrt:  [[11.77179828  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090887 -0.01703139  0.40488703]
Stock Position:  0.0009088707200164869
Bond Position:  [2.93443299]


portfolio before change:  [3.02385835]
curr_Stock_Price:  97.5844689306081
curr_Factors:  [97.58446893 -1.05513466 -0.9593096 ]
mat_Sqrt:  [[13.01723294  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0106186  -0.00772455  0.25267862]
Stock Position:  0.010618598775162883
Bond Position:  [1.98764803]


portfolio before change:  [3.03324942]
curr_Stock_Price:  98.42206486812394
curr_Factors:  [98.42206487 -1.37199092 -0.98665233]
mat_Sqrt:  [[ 9.30565017  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00131152 0.00259434 0.25609054]
Stock Position:  0.0013115165787331417
Bond Position:  [2.90416725]


portfolio before change:  [3.03439405]
curr_Stock_Price:  98.74115411392154
curr_Factors:  [98.74115411 -1.34686085 -1.01312516]
mat_Sqrt:  [[ 9.32329227  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00609199 -0.04522423  0.24245377]
Stock Position:  0.0060919877298816864
Bond Position:  [2.43286415]


portfolio before change:  [3.03317494]
curr_Stock_Price:  98.44118718986455
curr_Factors:  [98.44118719 -1.17183512 -1.05091961]
mat_Sqrt:  [[10.66219768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08344843  0.33624237 -0.38290775]
Stock Position:  -0.08344842824313281
Bond Position:  [11.24793729]


portfolio before change:  [3.10802084]
curr_Stock_Price:  97.57797662977286
curr_Factors:  [97.57797663 -1.37143256 -1.04524963]
mat_Sqrt:  [[ 8.70562722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0004466  0.00245039 0.00938145]
Stock Position:  0.0004466021463969629
Bond Position:  [3.06444231]


portfolio before change:  [3.10902312]
curr_Stock_Price:  98.10656713442475
curr_Factors:  [98.10656713 -1.23441686 -1.06451288]
mat_Sqrt:  [[ 9.84658371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00315507  0.01281946 -0.21677249]
Stock Position:  -0.0031550659581516677
Bond Position:  [3.41855581]


portfolio before change:  [3.11034172]
curr_Stock_Price:  97.95954701147349
curr_Factors:  [97.95954701 -1.48814022 -1.0760882 ]
mat_Sqrt:  [[ 7.54078422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02227588 0.00703468 0.08766251]
Stock Position:  0.022275883763301984
Bond Position:  [0.92820624]


portfolio before change:  [3.11222164]
curr_Stock_Price:  98.03352111876559
curr_Factors:  [98.03352112 -1.47126307 -1.07672472]
mat_Sqrt:  [[ 7.67003883  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02580746 0.03903053 0.25754075]
Stock Position:  0.02580745726184966
Bond Position:  [0.58222574]


portfolio before change:  [3.10176795]
curr_Stock_Price:  97.62281571550172
curr_Factors:  [97.62281572 -1.18502599 -1.10121992]
mat_Sqrt:  [[ 9.92309953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00664206  0.01011868 -0.14890438]
Stock Position:  0.006642061425563983
Bond Position:  [2.45335122]


portfolio before change:  [3.09008811]
curr_Stock_Price:  95.77199555340272
curr_Factors:  [95.77199555 -0.89488988 -1.07409649]
mat_Sqrt:  [[13.36960633  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0001489   0.04917322  0.02131966]
Stock Position:  -0.0001489034393508435
Bond Position:  [3.10434889]


portfolio before change:  [3.09093137]
curr_Stock_Price:  95.32152937067855
curr_Factors:  [95.32152937 -0.73901271 -1.05118738]
mat_Sqrt:  [[15.91171466  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00105967 -0.00995959  0.34984664]
Stock Position:  0.0010596672808628812
Bond Position:  [2.98992226]


portfolio before change:  [3.09234022]
curr_Stock_Price:  95.9455751146935
curr_Factors:  [95.94557511 -0.64680146 -1.0284827 ]
mat_Sqrt:  [[17.96628484  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131168  0.01194838 -0.17944118]
Stock Position:  -0.0013116766206658205
Bond Position:  [3.21818979]


portfolio before change:  [3.09326534]
curr_Stock_Price:  95.85373247297069
curr_Factors:  [95.85373247 -0.77028099 -0.99970954]
mat_Sqrt:  [[16.32720729  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0074296  -0.09574685 -0.1307885 ]
Stock Position:  -0.007429598850293411
Bond Position:  [3.80542012]


portfolio before change:  [3.09466328]
curr_Stock_Price:  95.79363893337944
curr_Factors:  [95.79363893 -0.78631934 -0.99967811]
mat_Sqrt:  [[16.05786608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00231009  0.00656331 -0.12717054]
Stock Position:  0.0023100890144979952
Bond Position:  [2.87337145]


portfolio before change:  [3.09650046]
curr_Stock_Price:  96.27792556028172
curr_Factors:  [96.27792556 -0.6962381  -0.98850428]
mat_Sqrt:  [[17.85880529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00419095 0.00471453 0.30652807]
Stock Position:  0.0041909477425204796
Bond Position:  [2.69300471]


portfolio before change:  [3.09811565]
curr_Stock_Price:  96.50266130538708
curr_Factors:  [96.50266131 -0.57386627 -0.97653879]
mat_Sqrt:  [[20.4741994   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00175968  0.01255375  0.14343524]
Stock Position:  -0.0017596807432089078
Bond Position:  [3.26792953]


portfolio before change:  [3.09929066]
curr_Stock_Price:  96.29925837333397
curr_Factors:  [96.29925837 -0.93180212 -0.97810811]
mat_Sqrt:  [[14.2613116   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 4.04286457e-04 -1.28410668e-02 -5.95791321e-01]
Stock Position:  0.0004042864572325166
Bond Position:  [3.06035818]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.10015056]
Stock Price:  96.53352641134985
PL:  [3.10015056]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-5.38770214e-02  8.56285589e-02  2.81190071e-02]
 [ 1.26410185e-03 -2.31748994e-02  1.43844379e-01]
 [-4.24186828e-02  8.36391667e-03 -1.06204796e-02]
 [-4.50475459e-02 -3.33714692e-02  1.64615925e-01]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-1.22621051e+00  1.21691887e+00 -1.71513079e-01]
 [ 2.35587371e-03  1.12636259e-02  4.87153815e-03]
 [-2.85617545e-02  3.91337366e-02 -7.76487664e-02]
 [ 7.46396150e-02  2.48181568e-02  3.68576934e-02]
 [ 1.54792247e-01  1.20519244e-01  8.97798577e-02]
 [-3.87908734e-03  2.87709609e-02 -5.07203557e-02]
 [-5.56294841e-02  1.41302994e-01  5.76152105e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-2.36391048e-02  4.30592743e-02 -7.32640382e-02]
 [-4.23749418e-02 -2.71396494e-01 -4.65281736e-02]
 [ 4.53666889e-02  2.00789983e-02 -2.24973728e-02]
 [ 1.41034301e-01  1.52242777e-02  1.53833855e-01]
 [-3.07817622e-02 -2.28036585e-02  4.31121049e-02]
 [-1.96265617e-02  1.50086988e-01 -1.03199311e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.47007895]
curr_Stock_Price:  99.39996064697345
curr_Factors:  [99.39996065 -1.35204835 -1.01956332]
mat_Sqrt:  [[ 9.27701702  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330477  0.0276365   0.0802157 ]
Stock Position:  -0.003304768833258951
Bond Position:  [-2.14158506]


portfolio before change:  [-2.47022774]
curr_Stock_Price:  99.28295473291028
curr_Factors:  [99.28295473 -1.5311247  -0.97670169]
mat_Sqrt:  [[ 8.08610785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00320249 -0.00747967  0.41034797]
Stock Position:  0.003202487119757546
Bond Position:  [-2.78818012]


portfolio before change:  [-2.4696831]
curr_Stock_Price:  99.67070702008198
curr_Factors:  [99.67070702 -1.14667228 -1.03794874]
mat_Sqrt:  [[11.21498459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00382339  0.00269944 -0.03029727]
Stock Position:  -0.0038233937339296306
Bond Position:  [-2.08860274]


portfolio before change:  [-2.46491985]
curr_Stock_Price:  98.28830617720021
curr_Factors:  [98.28830618 -1.1929349  -1.01809719]
mat_Sqrt:  [[10.77116841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00169502 -0.0107706   0.46960341]
Stock Position:  -0.0016950235051371863
Bond Position:  [-2.29831886]


portfolio before change:  [-2.46510131]
curr_Stock_Price:  98.05633623566844
curr_Factors:  [98.05633624 -1.06591008 -1.01248565]
mat_Sqrt:  [[12.26986732  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00462901 -0.04522423  0.24245377]
Stock Position:  0.004629013551132727
Bond Position:  [-2.91900542]


portfolio before change:  [-2.4620259]
curr_Stock_Price:  98.8783812155997
curr_Factors:  [98.87838122 -0.87901005 -1.03632148]
mat_Sqrt:  [[14.56409256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06954212  0.39275888 -0.48927908]
Stock Position:  -0.06954212497744328
Bond Position:  [4.41418685]


portfolio before change:  [-2.47313296]
curr_Stock_Price:  99.05396901711073
curr_Factors:  [99.05396902 -0.82479721 -1.02055066]
mat_Sqrt:  [[15.64759104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00036104 0.00363532 0.01389714]
Stock Position:  0.00036104281192121483
Bond Position:  [-2.50889568]


portfolio before change:  [-2.47378724]
curr_Stock_Price:  98.97926075847288
curr_Factors:  [98.97926076 -0.8503973  -1.00484804]
mat_Sqrt:  [[15.48179771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00235267  0.01263036 -0.22151032]
Stock Position:  -0.002352672648065191
Bond Position:  [-2.24092144]


portfolio before change:  [-2.46995976]
curr_Stock_Price:  97.11424407668763
curr_Factors:  [97.11424408 -0.98435084 -1.01129708]
mat_Sqrt:  [[13.20030761  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00660811 0.00801003 0.10514474]
Stock Position:  0.006608114585446302
Bond Position:  [-3.11170182]


portfolio before change:  [-2.46931826]
curr_Stock_Price:  97.32906016527069
curr_Factors:  [97.32906017 -0.70785426 -1.00810408]
mat_Sqrt:  [[17.4989217   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01129895 0.03889742 0.25611694]
Stock Position:  0.011298945992992557
Bond Position:  [-3.56903405]


portfolio before change:  [-2.48322288]
curr_Stock_Price:  96.17742560383952
curr_Factors:  [96.1774256  -0.79953338 -1.03650013]
mat_Sqrt:  [[15.33535828  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054511  0.00928579 -0.14469106]
Stock Position:  -0.0005451120640076313
Bond Position:  [-2.43079541]


portfolio before change:  [-2.48358485]
curr_Stock_Price:  95.72649127579348
curr_Factors:  [95.72649128 -1.13157797 -0.97924366]
mat_Sqrt:  [[11.59615344  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00129573  0.04560535  0.16436016]
Stock Position:  -0.0012957292869047747
Bond Position:  [-2.35954923]


portfolio before change:  [-2.48455863]
curr_Stock_Price:  96.02270838619381
curr_Factors:  [96.02270839 -1.12135194 -1.00397734]
mat_Sqrt:  [[11.46450142  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147072 -0.00995959  0.34984664]
Stock Position:  0.0014707245253600147
Bond Position:  [-2.62578158]


portfolio before change:  [-2.48567132]
curr_Stock_Price:  95.71254288710446
curr_Factors:  [95.71254289 -0.74285218 -0.96278275]
mat_Sqrt:  [[17.38685448  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0017142   0.01389732 -0.20900191]
Stock Position:  -0.0017142046261640982
Bond Position:  [-2.32160044]


portfolio before change:  [-2.48690552]
curr_Stock_Price:  96.09390268406446
curr_Factors:  [96.09390268 -0.94753214 -0.98605778]
mat_Sqrt:  [[13.8978749   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00771852 -0.08759284 -0.13273193]
Stock Position:  -0.007718521252042674
Bond Position:  [-1.74520269]


portfolio before change:  [-2.48449197]
curr_Stock_Price:  95.72467331845255
curr_Factors:  [95.72467332 -1.13297524 -0.97090832]
mat_Sqrt:  [[11.67666639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00384297  0.00648047 -0.06417874]
Stock Position:  0.0038429667179964424
Bond Position:  [-2.85235871]


portfolio before change:  [-2.48129307]
curr_Stock_Price:  96.74265909572695
curr_Factors:  [96.7426591  -1.60554644 -0.97058513]
mat_Sqrt:  [[ 7.35899143  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02385424 0.00491361 0.43884517]
Stock Position:  0.023854239976706278
Bond Position:  [-4.78901567]


portfolio before change:  [-2.48584639]
curr_Stock_Price:  96.60197484044338
curr_Factors:  [96.60197484 -1.51693466 -1.01522475]
mat_Sqrt:  [[ 7.67861945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00346889 -0.00735985  0.12298684]
Stock Position:  -0.0034688941250548915
Bond Position:  [-2.15074436]


portfolio before change:  [-2.48683104]
curr_Stock_Price:  96.7308049709879
curr_Factors:  [96.73080497 -1.42370565 -0.98922984]
mat_Sqrt:  [[ 8.66243987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00116083  0.04844037 -0.29439891]
Stock Position:  -0.0011608339851447676
Bond Position:  [-2.37454263]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.48835691]
Stock Price:  97.53381228452893
PL:  [-2.48835691]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.32913778e-02  3.34053587e-02  3.74537704e-02]
 [ 2.74212770e-02  1.29369365e-01 -1.23316398e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-2.59164443e-01 -2.61303961e-01  8.50461515e-01]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-8.95793633e-01  8.85088969e-01 -1.06944571e-01]
 [ 4.35316654e-03  2.52259046e-03  1.79584719e-02]
 [-9.31262990e-02 -2.19262354e-02 -1.62116749e-02]
 [ 8.30862186e-02  3.05585597e-02  6.10352757e-02]
 [-5.27163198e-02  1.72504511e-01 -1.38961262e-02]
 [ 4.55365203e-02  3.09025722e-02 -5.19421658e-02]
 [-5.27520678e-02  1.42816742e-01  5.07491488e-02]
 [-1.87718775e-01 -1.24985946e-01  3.30533481e-02]
 [ 4.66336457e-02  4.15993714e-01 -2.13510418e-01]
 [-4.65058275e-02 -2.67003031e-01 -6.25856476e-02]
 [ 5.95084367e-02  4.14030512e-02  1.39540862e-01]
 [-4.38491481e-03  1.55791588e-02  9.87474508e-02]
 [ 4.98774759e-02 -1.65430957e-01 -2.39715793e-02]
 [-1.01929667e-01  1.47609369e-01 -5.92534877e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.02965015]
curr_Stock_Price:  99.96720394107781
curr_Factors:  [99.96720394 -1.25792338 -1.04903078]
mat_Sqrt:  [[ 9.95313936  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0028963   0.01078153  0.10684518]
Stock Position:  -0.002896304137917152
Bond Position:  [2.31918557]


portfolio before change:  [2.02825684]
curr_Stock_Price:  100.64847735216516
curr_Factors:  [100.64847735  -1.28438238  -1.06695363]
mat_Sqrt:  [[ 9.5859454   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00298946  0.04175378 -0.35178736]
Stock Position:  0.0029894634826525927
Bond Position:  [1.72737189]


portfolio before change:  [2.02850876]
curr_Stock_Price:  100.58827472479
curr_Factors:  [100.58827472  -1.00523566  -1.04608004]
mat_Sqrt:  [[12.93219587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00603322  0.01370813 -0.02999186]
Stock Position:  -0.006033216575144127
Bond Position:  [2.63537961]


portfolio before change:  [2.02990199]
curr_Stock_Price:  100.46656587361907
curr_Factors:  [100.46656587  -0.79470473  -1.06185259]
mat_Sqrt:  [[15.6938306   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00885081 -0.08433549  2.42612998]
Stock Position:  -0.008850813040957339
Bond Position:  [2.91911278]


portfolio before change:  [2.04128481]
curr_Stock_Price:  99.26295243938621
curr_Factors:  [99.26295244 -1.21286484 -1.04420175]
mat_Sqrt:  [[10.38856649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0054673  -0.04522423  0.24245377]
Stock Position:  0.00546729735705027
Bond Position:  [1.49858474]


portfolio before change:  [2.04349887]
curr_Stock_Price:  99.59938157103315
curr_Factors:  [99.59938157 -1.4847445  -1.05100084]
mat_Sqrt:  [[ 7.88853641  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09342108  0.28566124 -0.30508309]
Stock Position:  -0.09342107760962362
Bond Position:  [11.34818042]


portfolio before change:  [1.98993942]
curr_Stock_Price:  100.2030659560213
curr_Factors:  [100.20306596  -1.54322347  -1.07716422]
mat_Sqrt:  [[ 7.29224244  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00117026 0.00081416 0.05123052]
Stock Position:  0.0011702636003623782
Bond Position:  [1.87267542]


portfolio before change:  [1.9900205]
curr_Stock_Price:  99.8722483756077
curr_Factors:  [99.87224838 -1.53736211 -1.07764277]
mat_Sqrt:  [[ 7.30739594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01380946 -0.00707666 -0.0462474 ]
Stock Position:  -0.013809456627061557
Bond Position:  [3.36920199]


portfolio before change:  [1.98547235]
curr_Stock_Price:  100.26260091063136
curr_Factors:  [100.26260091  -1.19242769  -1.12337544]
mat_Sqrt:  [[ 9.89460464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01028669 0.00986273 0.17411665]
Stock Position:  0.010286690130479718
Bond Position:  [0.95410205]


portfolio before change:  [1.97920765]
curr_Stock_Price:  99.63039949063817
curr_Factors:  [99.63039949 -1.14478853 -1.17367601]
mat_Sqrt:  [[ 9.80608187  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207428  0.05567559 -0.03964178]
Stock Position:  -0.0020742758618081027
Bond Position:  [2.18586858]


portfolio before change:  [1.98021068]
curr_Stock_Price:  99.41032332473902
curr_Factors:  [99.41032332 -1.00896373 -1.18510564]
mat_Sqrt:  [[11.08049767  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00372202  0.00997376 -0.14817654]
Stock Position:  0.0037220197553692502
Bond Position:  [1.61020349]


portfolio before change:  [1.98279994]
curr_Stock_Price:  99.99781505707888
curr_Factors:  [99.99781506 -0.95498841 -1.20618381]
mat_Sqrt:  [[11.51874975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00114948  0.04609391  0.1447732 ]
Stock Position:  -0.00114948203282381
Bond Position:  [2.09774563]


portfolio before change:  [1.98292438]
curr_Stock_Price:  100.34585376845418
curr_Factors:  [100.34585377  -0.99569088  -1.20709951]
mat_Sqrt:  [[11.08765537  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01862291 -0.04033904  0.094292  ]
Stock Position:  -0.018622912671733168
Bond Position:  [3.85165645]


portfolio before change:  [1.99541138]
curr_Stock_Price:  99.72704806339826
curr_Factors:  [99.72704806 -1.23790676 -1.18609497]
mat_Sqrt:  [[ 8.8324744   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00995931  0.13426139 -0.60908579]
Stock Position:  0.009959312795850191
Bond Position:  [1.00219851]


portfolio before change:  [1.99336845]
curr_Stock_Price:  99.49676077945422
curr_Factors:  [99.49676078 -1.24195661 -1.18183169]
mat_Sqrt:  [[ 8.81395961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01290939 -0.08617486 -0.17853943]
Stock Position:  -0.01290938918644256
Bond Position:  [3.27781086]


portfolio before change:  [1.99576092]
curr_Stock_Price:  99.37491852322792
curr_Factors:  [99.37491852 -1.35264943 -1.20086988]
mat_Sqrt:  [[ 7.7320996   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01247313 0.01336278 0.39807124]
Stock Position:  0.012473126729099606
Bond Position:  [0.75624497]


portfolio before change:  [1.99990529]
curr_Stock_Price:  99.69202316793631
curr_Factors:  [99.69202317 -1.51873923 -1.19791369]
mat_Sqrt:  [[ 6.58920528  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00287621 0.00502815 0.28169899]
Stock Position:  0.002876205223082801
Bond Position:  [1.71317057]


portfolio before change:  [1.99982738]
curr_Stock_Price:  99.51600678200164
curr_Factors:  [99.51600678 -1.63721142 -1.16501846]
mat_Sqrt:  [[ 6.03809537  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00185751 -0.05339261 -0.06838424]
Stock Position:  0.001857513753122129
Bond Position:  [1.81497502]


portfolio before change:  [2.00160671]
curr_Stock_Price:  100.2296149933484
curr_Factors:  [100.22961499  -1.57433028  -1.16035739]
mat_Sqrt:  [[ 6.50633319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01122115  0.04764072 -0.01690337]
Stock Position:  -0.011221149476447987
Bond Position:  [3.12629821]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.00483393]
Stock Price:  100.01167398373597
PL:  [1.99315995]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.73204515e-01  2.70182453e-01 -2.88727276e-02]
 [-2.28069813e-02 -1.09145756e-01  2.21107827e-01]
 [ 2.04499069e-01  8.43018427e-02  3.28285881e-01]
 [ 1.18493341e-02  3.74540590e-02 -5.72769388e-02]
 [ 1.42815366e-02 -1.42074262e-01  2.02618667e-02]
 [-1.27957173e+00  1.08469227e+00 -1.24315558e-01]
 [-5.45684288e-01 -6.12934981e-01 -2.05069096e-01]
 [ 2.02463037e-01 -2.76724522e-01  8.77332375e-02]
 [-8.43720470e-03  2.65638238e-02  4.64965301e-02]
 [ 1.46121515e-01  1.52107458e-01  1.03748732e-01]
 [-2.53553282e-01 -1.90740140e-01  4.35291476e-02]
 [-3.75005618e-02  1.50840235e-01  1.43561593e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-5.39244451e-02 -5.79166463e-02  1.33377991e-03]
 [ 3.46400773e-02  2.51155608e-01 -1.39811931e-02]
 [ 5.87841337e-02  6.93845306e-02 -4.50113307e-02]
 [ 1.70191753e-01 -4.34067416e-02  1.66602338e-01]
 [-7.82743026e-02  6.16928853e-02  8.03498737e-02]
 [ 8.27027641e-02  3.43586055e-02 -2.29230122e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.4929818]
curr_Stock_Price:  97.75827197158691
curr_Factors:  [97.75827197 -0.95831907 -0.98663397]
mat_Sqrt:  [[13.97884022  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00886679  0.08720101 -0.08236586]
Stock Position:  -0.008866785193983522
Bond Position:  [-14.6261802]


portfolio before change:  [-15.49680428]
curr_Stock_Price:  97.77693444681881
curr_Factors:  [97.77693445 -0.95948634 -0.97838203]
mat_Sqrt:  [[14.08091497  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.35069309e-06 -3.52266412e-02  6.30759086e-01]
Stock Position:  3.3506930852088417e-06
Bond Position:  [-15.4971319]


portfolio before change:  [-15.50068505]
curr_Stock_Price:  95.98488084405254
curr_Factors:  [95.98488084 -0.90674353 -1.00005491]
mat_Sqrt:  [[14.25905637  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02024806 0.0272083  0.93650824]
Stock Position:  0.020248056970443486
Bond Position:  [-17.44419238]


portfolio before change:  [-15.52306883]
curr_Stock_Price:  95.09481080433625
curr_Factors:  [95.0948108  -0.84002514 -0.96360724]
mat_Sqrt:  [[15.66207238  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00049821  0.01208825 -0.16339516]
Stock Position:  0.0004982102977049481
Bond Position:  [-15.57044605]


portfolio before change:  [-15.52754829]
curr_Stock_Price:  93.91786957147914
curr_Factors:  [93.91786957 -0.60282153 -0.98291601]
mat_Sqrt:  [[19.2340691   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055024 -0.04585427  0.05780147]
Stock Position:  -0.0005502379363478831
Bond Position:  [-15.47587112]


portfolio before change:  [-15.53094602]
curr_Stock_Price:  93.06054956191647
curr_Factors:  [93.06054956 -0.57971472 -0.94719468]
mat_Sqrt:  [[20.213303    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05360508  0.35008293 -0.35463768]
Stock Position:  -0.053605076683513754
Bond Position:  [-10.54242812]


portfolio before change:  [-15.4281394]
curr_Stock_Price:  91.09352412649451
curr_Factors:  [91.09352413 -0.37901947 -0.95996978]
mat_Sqrt:  [[23.87656565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02984762 -0.19782391 -0.58500505]
Stock Position:  -0.029847620527052917
Bond Position:  [-12.70921446]


portfolio before change:  [-15.46028676]
curr_Stock_Price:  92.06410931307622
curr_Factors:  [92.06410931 -0.43331161 -0.99119286]
mat_Sqrt:  [[22.1531723   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00739783 -0.08931246  0.25027851]
Stock Position:  0.007397827747818657
Bond Position:  [-16.14136118]


portfolio before change:  [-15.46337565]
curr_Stock_Price:  92.19211403960487
curr_Factors:  [92.19211404 -0.5755175  -1.00015783]
mat_Sqrt:  [[19.07157984  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00033957 0.00857344 0.13264166]
Stock Position:  0.0003395721619044304
Bond Position:  [-15.49468152]


portfolio before change:  [-15.4672288]
curr_Stock_Price:  92.25396633075196
curr_Factors:  [92.25396633 -0.59217292 -1.00646016]
mat_Sqrt:  [[18.65123181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01063458 0.04909247 0.29596626]
Stock Position:  0.01063457596905427
Bond Position:  [-16.44831061]


portfolio before change:  [-15.48496374]
curr_Stock_Price:  90.97301705019966
curr_Factors:  [90.97301705 -0.60716836 -0.99583266]
mat_Sqrt:  [[18.31209778  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01548717 -0.06156112  0.12417654]
Stock Position:  -0.015487171578105821
Bond Position:  [-14.07604902]


portfolio before change:  [-15.52212898]
curr_Stock_Price:  93.14551058502873
curr_Factors:  [93.14551059 -0.99094549 -0.97761799]
mat_Sqrt:  [[13.00845356  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00029058  0.04868348  0.04095413]
Stock Position:  -0.0002905794372571871
Bond Position:  [-15.49506281]


portfolio before change:  [-15.52606222]
curr_Stock_Price:  93.34853941867757
curr_Factors:  [93.34853942 -1.20069529 -0.99595723]
mat_Sqrt:  [[10.37799501  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0016247  -0.00995959  0.34984664]
Stock Position:  0.00162469950940978
Bond Position:  [-15.67772555]


portfolio before change:  [-15.5306579]
curr_Stock_Price:  92.93261443866896
curr_Factors:  [92.93261444 -1.09399954 -0.9810088 ]
mat_Sqrt:  [[11.66818975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00561136 -0.01869252  0.0038049 ]
Stock Position:  -0.005611356669883888
Bond Position:  [-15.00917985]


portfolio before change:  [-15.53750108]
curr_Stock_Price:  93.48335860722844
curr_Factors:  [93.48335861 -1.12661356 -0.96038258]
mat_Sqrt:  [[11.59747376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00716131  0.08106012 -0.03988445]
Stock Position:  0.007161309758553129
Bond Position:  [-16.20696437]


portfolio before change:  [-15.54557026]
curr_Stock_Price:  92.92243731767506
curr_Factors:  [92.92243732 -0.90614619 -0.93707474]
mat_Sqrt:  [[14.71024522  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00433435  0.02239376 -0.1284048 ]
Stock Position:  0.004334345984424398
Bond Position:  [-15.94832826]


portfolio before change:  [-15.54290048]
curr_Stock_Price:  94.45839249487643
curr_Factors:  [94.45839249 -0.94641563 -0.91293899]
mat_Sqrt:  [[14.7140795   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01327565 -0.01400947  0.4752701 ]
Stock Position:  0.013275648566614283
Bond Position:  [-16.7968969]


portfolio before change:  [-15.53914707]
curr_Stock_Price:  95.05747158346746
curr_Factors:  [95.05747158 -1.39845626 -0.90986378]
mat_Sqrt:  [[ 9.45138823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00521404  0.01991129  0.22921582]
Stock Position:  -0.005214043118603488
Bond Position:  [-15.04351331]


portfolio before change:  [-15.54022923]
curr_Stock_Price:  94.54363177629574
curr_Factors:  [94.54363178 -1.09089739 -0.90154134]
mat_Sqrt:  [[12.89220306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00332951  0.01108919 -0.65392973]
Stock Position:  0.003329514924143304
Bond Position:  [-15.85501367]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.54131178]
Stock Price:  95.40913253301103
PL:  [-15.54131178]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-6.79563880e-02  1.37741943e-01  1.35491230e-02]
 [-2.36997441e-03 -3.38126660e-02  1.40875559e-02]
 [ 1.91753891e-01  5.73574147e-02  2.26168991e-01]
 [ 1.26972389e-02  3.73843906e-02 -5.75835861e-02]
 [ 7.11800544e-03 -5.39744761e-02  2.38761931e-02]
 [-1.67507121e+00  1.51148734e+00 -2.08684649e-01]
 [-3.84268744e-02  1.84661716e-02 -8.06768516e-02]
 [ 6.82697988e-02 -3.19013970e-02 -2.67651094e-02]
 [-3.26234838e-02  2.84995943e-02  5.12672678e-02]
 [ 1.52692019e-01  1.22490205e-01  8.74019001e-02]
 [-3.76530037e-02 -1.02642340e-02 -3.66204974e-02]
 [ 1.02863958e-01 -3.47958291e-02 -3.57076291e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-3.04075033e-02 -7.44287516e-03 -2.61217019e-02]
 [ 2.65271068e-03  7.49546451e-02 -5.03596264e-02]
 [ 5.04224831e-02  6.39631560e-02 -8.83204038e-02]
 [ 2.48896283e-01 -3.01919383e-01  2.14101247e-01]
 [-2.27082897e-01  1.53669059e-01  3.28190844e-01]
 [ 4.06977192e-01 -4.43751663e-01 -7.45259853e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.30738858]
curr_Stock_Price:  99.75009279950235
curr_Factors:  [99.7500928  -0.59719201 -0.99153644]
mat_Sqrt:  [[20.36748058  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182027  0.04445602  0.03865188]
Stock Position:  -0.0018202658038753091
Bond Position:  [0.48896027]


portfolio before change:  [0.31117035]
curr_Stock_Price:  97.73966828179209
curr_Factors:  [97.73966828 -0.43513688 -0.96883564]
mat_Sqrt:  [[24.0067485   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00026644 -0.01091299  0.04018788]
Stock Position:  -0.00026643948267978144
Bond Position:  [0.33721205]


portfolio before change:  [0.31160511]
curr_Stock_Price:  96.42436513391613
curr_Factors:  [96.42436513 -0.48213458 -0.97442742]
mat_Sqrt:  [[22.47035579  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01110924 0.01851203 0.64519718]
Stock Position:  0.01110923559431319
Bond Position:  [-0.75959588]


portfolio before change:  [0.2892493]
curr_Stock_Price:  94.42909830864876
curr_Factors:  [94.42909831 -0.14914459 -0.97936823]
mat_Sqrt:  [[30.54913747  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00028067  0.01206576 -0.16426994]
Stock Position:  0.00028066571223393826
Bond Position:  [0.26274629]


portfolio before change:  [0.28945419]
curr_Stock_Price:  94.92505815379714
curr_Factors:  [ 9.49250582e+01 -3.04980719e-02 -1.00856666e+00]
mat_Sqrt:  [[33.58310066  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.90092080e-05 -1.74201873e-02  6.81121332e-02]
Stock Position:  2.9009207970733557e-05
Bond Position:  [0.28670049]


portfolio before change:  [0.28946692]
curr_Stock_Price:  92.89267872159934
curr_Factors:  [ 9.28926787e+01 -4.93007005e-02 -1.01801947e+00]
mat_Sqrt:  [[31.94848185  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04410656  0.48783044 -0.59531922]
Stock Position:  -0.04410656304520928
Bond Position:  [4.38664371]


portfolio before change:  [0.08563464]
curr_Stock_Price:  97.53890514264201
curr_Factors:  [97.53890514 -0.28479412 -1.01097063]
mat_Sqrt:  [[26.69527492  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191515  0.00595993 -0.2301486 ]
Stock Position:  -0.0019151545161033006
Bond Position:  [0.27243671]


portfolio before change:  [0.08744087]
curr_Stock_Price:  96.63134714551309
curr_Factors:  [ 9.66313471e+01 -6.77946732e-02 -9.62488023e-01]
mat_Sqrt:  [[34.48831245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00163228 -0.01029613 -0.07635341]
Stock Position:  0.0016322790035429805
Bond Position:  [-0.07028845]


portfolio before change:  [0.08261229]
curr_Stock_Price:  93.6839350465955
curr_Factors:  [93.68393505 -0.28264224 -0.96707528]
mat_Sqrt:  [[26.84847996  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060864  0.0091982   0.14625124]
Stock Position:  -0.0006086430711865549
Bond Position:  [0.13963237]


portfolio before change:  [0.08167284]
curr_Stock_Price:  95.2848194425892
curr_Factors:  [95.28481944 -0.48794579 -0.95548551]
mat_Sqrt:  [[22.49828763  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00869115 0.03953354 0.24933329]
Stock Position:  0.008691153255319084
Bond Position:  [-0.74646213]


portfolio before change:  [0.08466007]
curr_Stock_Price:  95.65000326764422
curr_Factors:  [95.65000327 -0.56964772 -0.95931419]
mat_Sqrt:  [[20.7331489   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00227767 -0.00331277 -0.10446809]
Stock Position:  -0.0022776718383616685
Bond Position:  [0.30251939]


portfolio before change:  [0.08781475]
curr_Stock_Price:  94.29816740483814
curr_Factors:  [94.2981674  -0.21318851 -0.95081994]
mat_Sqrt:  [[29.4429151   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00300488 -0.01123031 -0.10186393]
Stock Position:  0.0030048824876135484
Bond Position:  [-0.19554016]


portfolio before change:  [0.09111223]
curr_Stock_Price:  95.41181165368197
curr_Factors:  [95.41181165 -0.45385764 -0.94245401]
mat_Sqrt:  [[23.61520369  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071399 -0.00995959  0.34984664]
Stock Position:  0.0007139944091462128
Bond Position:  [0.02298873]


portfolio before change:  [0.09055694]
curr_Stock_Price:  94.62604795711954
curr_Factors:  [94.62604796 -0.27585595 -0.93640575]
mat_Sqrt:  [[28.15348323  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132342 -0.00240218 -0.07451794]
Stock Position:  -0.0013234186206094393
Bond Position:  [0.21578682]


portfolio before change:  [0.09253093]
curr_Stock_Price:  93.1752329392831
curr_Factors:  [93.17523294 -0.49992701 -0.96905034]
mat_Sqrt:  [[21.44528028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0003578   0.02419151 -0.143662  ]
Stock Position:  0.0003578012384208683
Bond Position:  [0.05919272]


portfolio before change:  [0.09262738]
curr_Stock_Price:  93.40342642635333
curr_Factors:  [93.40342643 -0.22479197 -0.9938269 ]
mat_Sqrt:  [[27.61362085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00164595  0.02064402 -0.25195353]
Stock Position:  0.0016459478807129594
Bond Position:  [-0.06110979]


portfolio before change:  [0.08504544]
curr_Stock_Price:  88.80627996271102
curr_Factors:  [88.80627996 -0.09699031 -1.01484335]
mat_Sqrt:  [[29.2132889   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00790635 -0.09744406  0.61077126]
Stock Position:  0.00790634980093063
Bond Position:  [-0.61708808]


portfolio before change:  [0.07555943]
curr_Stock_Price:  87.62599822126995
curr_Factors:  [87.62599822 -0.43644927 -1.04614059]
mat_Sqrt:  [[19.89538668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00647003  0.04959648  0.93623713]
Stock Position:  -0.006470025364941606
Bond Position:  [0.64250186]


portfolio before change:  [0.08654225]
curr_Stock_Price:  85.95333354501982
curr_Factors:  [85.95333355 -0.22099611 -1.06957232]
mat_Sqrt:  [[23.64699611  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00694681 -0.14322023 -2.12601892]
Stock Position:  0.006946811854348173
Bond Position:  [-0.51055938]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.08087644]
Stock Price:  85.15611070961226
PL:  [0.08087644]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.01430366e-01  1.82818769e-01  1.19105501e-03]
 [ 4.26660849e-02  1.39523591e-01 -2.86303163e-01]
 [ 1.09573215e-01 -3.12080192e-02  2.28677841e-02]
 [-6.81624215e-02 -1.28514873e-02  1.25225270e-01]
 [ 5.49951283e-03 -1.42393093e-01  9.68996072e-03]
 [-1.25462060e+00  1.18810468e+00 -1.60080129e-01]
 [-5.10644719e-04 -1.21861979e-02  9.93555242e-04]
 [ 1.16437707e-02  5.25591037e-02 -7.41956474e-02]
 [ 5.82514965e-02  2.68181843e-02  4.59989311e-02]
 [ 1.30128491e-01  1.32579770e-01  8.41415697e-02]
 [ 3.19386028e-02  1.74488790e-02 -5.36194530e-02]
 [-1.91928144e-03  1.16648510e-01 -7.61788156e-03]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [ 2.80369258e-02  2.81483566e-01 -1.90435967e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 4.92018737e-02  3.69905854e-02  2.99670199e-02]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.50378548e-02 -1.35856316e-01 -3.47600773e-02]
 [-1.11944811e-01  6.00584844e-02 -1.49060849e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.87727177]
curr_Stock_Price:  99.34862924648537
curr_Factors:  [99.34862925 -0.53392218 -1.03295436]
mat_Sqrt:  [[20.73366344  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308047  0.0590045   0.00339775]
Stock Position:  -0.0030804743144459425
Bond Position:  [-2.57123087]


portfolio before change:  [-2.87973666]
curr_Stock_Price:  99.9400956828479
curr_Factors:  [99.94009568 -0.72621926 -1.0534258 ]
mat_Sqrt:  [[16.85969578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.53562246e-04  4.50310454e-02 -8.16743233e-01]
Stock Position:  0.000753562245678862
Bond Position:  [-2.95504774]


portfolio before change:  [-2.88189652]
curr_Stock_Price:  98.05438167688392
curr_Factors:  [98.05438168 -0.85275124 -1.02624042]
mat_Sqrt:  [[14.97722305  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00720232 -0.01007234  0.06523542]
Stock Position:  0.007202321263606925
Bond Position:  [-3.58811568]


portfolio before change:  [-2.89756845]
curr_Stock_Price:  96.00298904953728
curr_Factors:  [96.00298905 -0.15696649 -1.00465351]
mat_Sqrt:  [[30.04689496  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00150512 -0.0041478   0.35723284]
Stock Position:  -0.0015051212159869244
Bond Position:  [-2.75307231]


portfolio before change:  [-2.89486564]
curr_Stock_Price:  93.74991013847382
curr_Factors:  [93.74991014 -0.50016109 -0.96160683]
mat_Sqrt:  [[21.73367253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00099332 -0.04595717  0.02764276]
Stock Position:  -0.0009933158175269036
Bond Position:  [-2.80174238]


portfolio before change:  [-2.89893167]
curr_Stock_Price:  97.13805882852685
curr_Factors:  [97.13805883 -0.70283845 -0.97987879]
mat_Sqrt:  [[18.05488009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05786668  0.38345914 -0.45666405]
Stock Position:  -0.05786668005644015
Bond Position:  [2.7221253]


portfolio before change:  [-2.94660585]
curr_Stock_Price:  97.97368309962378
curr_Factors:  [97.9736831  -1.01257251 -1.01127188]
mat_Sqrt:  [[12.94687582  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00021591 -0.00393308  0.00283434]
Stock Position:  -0.00021590794406993328
Bond Position:  [-2.92545256]


portfolio before change:  [-2.94739381]
curr_Stock_Price:  98.23535030749353
curr_Factors:  [98.23535031 -0.67382413 -1.02770266]
mat_Sqrt:  [[17.918601    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040334  0.01696338 -0.21165953]
Stock Position:  0.0004033367161173886
Bond Position:  [-2.98701573]


portfolio before change:  [-2.94815901]
curr_Stock_Price:  98.18983624503946
curr_Factors:  [98.18983625 -0.64555954 -1.01018408]
mat_Sqrt:  [[18.74935001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00389961 0.00865553 0.13122215]
Stock Position:  0.003899614004758425
Bond Position:  [-3.33106147]


portfolio before change:  [-2.94531776]
curr_Stock_Price:  99.13201172369732
curr_Factors:  [99.13201172 -0.7377811  -1.02197425]
mat_Sqrt:  [[17.05932651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01022119 0.04278994 0.24003248]
Stock Position:  0.010221185996574423
Bond Position:  [-3.95856449]


portfolio before change:  [-2.95516221]
curr_Stock_Price:  98.26570485018689
curr_Factors:  [98.26570485 -0.41733324 -1.03786083]
mat_Sqrt:  [[22.93080059  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00107084  0.0056316  -0.15296137]
Stock Position:  0.0010708442228681836
Bond Position:  [-3.06038947]


portfolio before change:  [-2.95561766]
curr_Stock_Price:  98.55495117147962
curr_Factors:  [98.55495117 -0.71653185 -1.0394212 ]
mat_Sqrt:  [[17.02463181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00119453  0.03764814 -0.0217317 ]
Stock Position:  0.001194534045546799
Bond Position:  [-3.07334491]


portfolio before change:  [-2.95795449]
curr_Stock_Price:  97.24197736484103
curr_Factors:  [97.24197736 -0.35170976 -1.06282899]
mat_Sqrt:  [[23.63346544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071344 -0.00995959  0.34984664]
Stock Position:  0.0007134427005193138
Bond Position:  [-3.02733107]


portfolio before change:  [-2.95765275]
curr_Stock_Price:  98.72586019610321
curr_Factors:  [98.7258602  -0.28170033 -1.07595988]
mat_Sqrt:  [[25.39841346  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00183562  0.09084843 -0.54326081]
Stock Position:  0.0018356240721169174
Bond Position:  [-3.13887631]


portfolio before change:  [-2.95705537]
curr_Stock_Price:  99.47884553841655
curr_Factors:  [99.47884554 -0.34013503 -1.04028913]
mat_Sqrt:  [[25.01613098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00531629 -0.09296045 -0.18429859]
Stock Position:  -0.005316292861932006
Bond Position:  [-2.42819669]


portfolio before change:  [-2.95589558]
curr_Stock_Price:  99.14648727441597
curr_Factors:  [99.14648727 -0.49115782 -1.05806672]
mat_Sqrt:  [[21.05996584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00298526 0.01193866 0.08548757]
Stock Position:  0.0029852630401009713
Bond Position:  [-3.25187392]


portfolio before change:  [-2.95298395]
curr_Stock_Price:  100.39418450072864
curr_Factors:  [100.3941845   -0.56969406  -1.02701527]
mat_Sqrt:  [[20.33604547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00338265  0.00525786  0.16709793]
Stock Position:  -0.0033826545094496393
Bond Position:  [-2.6133851]


portfolio before change:  [-2.9530282]
curr_Stock_Price:  100.21409760331665
curr_Factors:  [100.2140976   -1.10164352  -1.05804413]
mat_Sqrt:  [[11.56081341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00088324 -0.04384744 -0.09916083]
Stock Position:  0.0008832362463059891
Bond Position:  [-3.04154092]


portfolio before change:  [-2.95340542]
curr_Stock_Price:  100.64802925009441
curr_Factors:  [100.64802925  -1.11430498  -1.09657217]
mat_Sqrt:  [[11.03147358  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00906404  0.01938379 -0.00425229]
Stock Position:  -0.009064037783295887
Bond Position:  [-2.04112788]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.95784716]
Stock Price:  101.08176443969052
PL:  [-4.0396116]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.95528358e-02  6.42956271e-02  3.19322140e-02]
 [-1.92729945e-02 -9.38956481e-02  2.48038501e-01]
 [ 1.25581589e-01 -1.43394495e-02  5.58663106e-02]
 [ 2.22855878e-02  3.65965597e-02 -6.10512405e-02]
 [ 3.98175377e-03 -4.55375441e-02  2.12850235e-02]
 [-1.42060235e+00  1.36380244e+00 -1.91642953e-01]
 [-3.64782263e-02  1.41306028e-02 -7.63089172e-02]
 [ 1.06286712e-01 -1.00637206e-01  4.49067827e-03]
 [ 1.88275468e-02  2.65471575e-02  4.40986726e-02]
 [ 1.54448185e-01  1.17526011e-01  8.60268008e-02]
 [-1.56794233e-01 -1.18676773e-01  8.40503109e-03]
 [-3.09951146e-02  1.54262612e-01 -1.16707299e-03]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-2.82339771e-02 -1.51437146e-02 -1.77296543e-02]
 [-8.06724383e-03 -6.83854795e-02 -5.89892402e-02]
 [ 4.59842754e-02  1.32585165e-02  2.52997380e-02]
 [ 6.31936696e-02  2.04132956e-02  1.21094585e-01]
 [-1.06041887e-02 -6.11832021e-02  2.86840825e-02]
 [-2.26009903e-02  1.58936383e-01 -9.94112800e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.56924533]
curr_Stock_Price:  99.63958287859937
curr_Factors:  [99.63958288 -1.18331354 -0.98122428]
mat_Sqrt:  [[11.43892131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261479  0.02075132  0.09109372]
Stock Position:  -0.0026147928760853313
Bond Position:  [-0.30870845]


portfolio before change:  [-0.56599966]
curr_Stock_Price:  98.36879387914068
curr_Factors:  [98.36879388 -1.29759844 -0.99128166]
mat_Sqrt:  [[ 9.97262174  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00122248 -0.03030469  0.7075848 ]
Stock Position:  0.0012224752851395318
Bond Position:  [-0.68625308]


portfolio before change:  [-0.5671023]
curr_Stock_Price:  97.6071839240717
curr_Factors:  [97.60718392 -0.72591216 -1.0183514 ]
mat_Sqrt:  [[17.0591639   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00785843 -0.00462804  0.15937103]
Stock Position:  0.00785842874713728
Bond Position:  [-1.3341414]


portfolio before change:  [-0.58301974]
curr_Stock_Price:  95.6241073191292
curr_Factors:  [95.62410732 -0.67232791 -1.02526004]
mat_Sqrt:  [[17.51113573  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00098759  0.01181149 -0.1741622 ]
Stock Position:  0.000987588538341549
Bond Position:  [-0.67745701]


portfolio before change:  [-0.5824917]
curr_Stock_Price:  96.33029599500179
curr_Factors:  [96.330296   -0.33066144 -1.04507384]
mat_Sqrt:  [[24.33821115  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.98045385e-05 -1.46971792e-02  6.07202475e-02]
Stock Position:  -3.9804538526785096e-05
Bond Position:  [-0.57865732]


portfolio before change:  [-0.5826503]
curr_Stock_Price:  96.67978283106481
curr_Factors:  [96.67978283 -0.69223802 -1.10697691]
mat_Sqrt:  [[15.99361172  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07386301  0.44016534 -0.546704  ]
Stock Position:  -0.07386300939712934
Bond Position:  [6.55840941]


portfolio before change:  [-0.56754173]
curr_Stock_Price:  96.49743501586084
curr_Factors:  [96.49743502 -0.83208711 -1.07690059]
mat_Sqrt:  [[14.30384988  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00343756  0.00456063 -0.2176881 ]
Stock Position:  -0.0034375585618584286
Bond Position:  [-0.23582615]


portfolio before change:  [-0.56322282]
curr_Stock_Price:  95.22389319171255
curr_Factors:  [95.22389319 -0.62771105 -1.07872778]
mat_Sqrt:  [[17.28418734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00501388 -0.03248052  0.01281066]
Stock Position:  0.0050138824881831474
Bond Position:  [-1.04066423]


portfolio before change:  [-0.56494562]
curr_Stock_Price:  94.93218212847263
curr_Factors:  [94.93218213 -0.6412104  -1.0471449 ]
mat_Sqrt:  [[17.54567467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00189494 0.00856806 0.12580124]
Stock Position:  0.0018949437435051468
Bond Position:  [-0.74483677]


portfolio before change:  [-0.56264741]
curr_Stock_Price:  96.24327457842925
curr_Factors:  [96.24327458 -0.49178849 -1.05467372]
mat_Sqrt:  [[20.49983597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00956097 0.03793136 0.24541052]
Stock Position:  0.009560965692940578
Bond Position:  [-1.48282605]


portfolio before change:  [-0.58955891]
curr_Stock_Price:  93.46732650485343
curr_Factors:  [93.4673265  -0.49719328 -1.0720169 ]
mat_Sqrt:  [[19.46079146  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00921357 -0.03830276  0.02397721]
Stock Position:  -0.009213569666284711
Bond Position:  [0.27160882]


portfolio before change:  [-0.58328623]
curr_Stock_Price:  92.7938884442938
curr_Factors:  [92.79388844 -0.80624044 -1.0447306 ]
mat_Sqrt:  [[14.57648686  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.75200919e-05  4.97880439e-02 -3.32933439e-03]
Stock Position:  1.7520091884011316e-05
Bond Position:  [-0.58491198]


portfolio before change:  [-0.5834342]
curr_Stock_Price:  92.69523172552978
curr_Factors:  [92.69523173 -0.60230652 -1.01531026]
mat_Sqrt:  [[18.3880362   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00091696 -0.00995959  0.34984664]
Stock Position:  0.0009169616171372473
Bond Position:  [-0.66843217]


portfolio before change:  [-0.58158584]
curr_Stock_Price:  94.89324506747992
curr_Factors:  [94.89324507 -0.92579008 -0.99565715]
mat_Sqrt:  [[13.89189114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00251544 -0.00488761 -0.05057777]
Stock Position:  -0.002515440483903729
Bond Position:  [-0.34288753]


portfolio before change:  [-0.58282224]
curr_Stock_Price:  95.35068907494784
curr_Factors:  [95.35068907 -1.02152612 -1.03673583]
mat_Sqrt:  [[12.1739644   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00279839 -0.02207132 -0.16827988]
Stock Position:  -0.002798389948629725
Bond Position:  [-0.31599383]


portfolio before change:  [-0.58888743]
curr_Stock_Price:  97.48984042911054
curr_Factors:  [97.48984043 -1.27807763 -1.07169644]
mat_Sqrt:  [[ 9.29962529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00579109 0.00427917 0.07217311]
Stock Position:  0.005791087754798998
Bond Position:  [-1.15345965]


portfolio before change:  [-0.58795313]
curr_Stock_Price:  97.70097483591802
curr_Factors:  [97.70097484 -1.32509627 -1.09144717]
mat_Sqrt:  [[ 8.71781036  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01056215 0.00658836 0.34544914]
Stock Position:  0.010562152762520519
Bond Position:  [-1.61988575]


portfolio before change:  [-0.59279657]
curr_Stock_Price:  97.28075626881176
curr_Factors:  [97.28075627 -1.44509296 -1.09671359]
mat_Sqrt:  [[ 7.6583354   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00225089 -0.01974679  0.0818277 ]
Stock Position:  -0.0022508864987871064
Bond Position:  [-0.37382863]


portfolio before change:  [-0.59159864]
curr_Stock_Price:  96.70702906523941
curr_Factors:  [96.70702907 -1.53685819 -1.06420474]
mat_Sqrt:  [[ 7.17514638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00145648  0.0512965  -0.28359271]
Stock Position:  -0.0014564831206044274
Bond Position:  [-0.45074649]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.59349991]
Stock Price:  97.93503657757422
PL:  [-0.59349991]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-2.58364948e-02  2.26674041e-02  3.27832117e-02]
 [-5.12401569e-03  8.34546063e-02 -6.66115587e-02]
 [-7.44761308e-02 -1.17033756e-02 -4.54481767e-02]
 [-2.35797376e-01 -2.29927190e-01  8.00406800e-01]
 [-1.13713413e-02 -2.28720068e-02  6.01916678e-03]
 [-1.16435571e+00  1.21831211e+00 -1.76649626e-01]
 [ 1.12592478e-02 -8.36286059e-03  3.44054133e-02]
 [-6.74345771e-02 -7.96989160e-02  9.77741677e-02]
 [-3.34231498e-02  1.84242822e-02  5.56394606e-02]
 [-6.60615848e-01  3.07287428e-01 -3.37514250e-01]
 [ 1.32724610e-01  4.16087783e-02 -5.43517650e-02]
 [-1.21582316e-01  1.06606613e-01  2.14991191e-01]
 [ 4.76847771e-02 -8.21283915e-02 -1.18649970e-01]
 [ 3.92951445e-02  9.62624530e-01 -5.39546647e-01]
 [ 1.59481728e-01 -7.90781481e-02  6.80660177e-03]
 [ 1.67099658e-02 -3.24467656e-02 -1.04463722e-01]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 4.72047439e-02 -2.01399788e-01 -3.34244207e-02]
 [-1.43318126e-01  5.68613262e-02 -1.87292126e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.73868678]
curr_Stock_Price:  100.18264792584131
curr_Factors:  [100.18264793  -0.64121751  -0.9906451 ]
mat_Sqrt:  [[19.59221701  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00074099  0.00731587  0.09352138]
Stock Position:  -0.0007409924671521868
Bond Position:  [3.81292136]


portfolio before change:  [3.73802465]
curr_Stock_Price:  102.36279453136778
curr_Factors:  [102.36279453  -0.76430055  -0.99134756]
mat_Sqrt:  [[17.6878012   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.53167080e-05  2.69348584e-02 -1.90024236e-01]
Stock Position:  -9.531670802770033e-05
Bond Position:  [3.74778154]


portfolio before change:  [3.73903998]
curr_Stock_Price:  101.54176337422061
curr_Factors:  [101.54176337  -0.95921906  -1.01395323]
mat_Sqrt:  [[14.11584435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00610251 -0.00377725 -0.129651  ]
Stock Position:  -0.006102514342462894
Bond Position:  [4.35870004]


portfolio before change:  [3.74556584]
curr_Stock_Price:  100.65097442585306
curr_Factors:  [100.65097443  -0.91328354  -1.03219408]
mat_Sqrt:  [[14.3849312   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00829679 -0.07420868  2.28333781]
Stock Position:  -0.008296787222823392
Bond Position:  [4.58064556]


portfolio before change:  [3.73803098]
curr_Stock_Price:  101.69718174754044
curr_Factors:  [101.69718175  -1.12228541  -1.00983205]
mat_Sqrt:  [[12.05985448  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00122816 -0.00738191  0.01717101]
Stock Position:  -0.0012281585095352057
Bond Position:  [3.86293124]


portfolio before change:  [3.73950334]
curr_Stock_Price:  101.28477066759001
curr_Factors:  [101.28477067  -0.84956722  -1.00631909]
mat_Sqrt:  [[15.83226182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06011316  0.39320854 -0.50393221]
Stock Position:  -0.0601131572759463
Bond Position:  [9.82805069]


portfolio before change:  [3.72992039]
curr_Stock_Price:  101.48506410320971
curr_Factors:  [101.4850641   -0.84084025  -1.00575021]
mat_Sqrt:  [[16.01172347  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00103519 -0.0026991   0.09814907]
Stock Position:  0.0010351890998495173
Bond Position:  [3.62486416]


portfolio before change:  [3.73209836]
curr_Stock_Price:  102.7134710496978
curr_Factors:  [102.71347105  -0.84290126  -0.97839203]
mat_Sqrt:  [[16.62071805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00383527 -0.02572271  0.27892249]
Stock Position:  -0.003835272436752272
Bond Position:  [4.1260325]


portfolio before change:  [3.73380227]
curr_Stock_Price:  102.53818197614265
curr_Factors:  [102.53818198  -1.03309612  -0.9829257 ]
mat_Sqrt:  [[13.65647018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00134039  0.00594641  0.15872389]
Stock Position:  -0.0013403867483301982
Bond Position:  [3.87124309]


portfolio before change:  [3.73375489]
curr_Stock_Price:  103.29565855172454
curr_Factors:  [103.29565855  -1.41033795  -0.99995523]
mat_Sqrt:  [[ 9.27481045  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07189213  0.09917659 -0.96283421]
Stock Position:  -0.0718921292945186
Bond Position:  [11.15989973]


portfolio before change:  [3.72753489]
curr_Stock_Price:  103.42098979838359
curr_Factors:  [103.4209898   -1.53024165  -0.99916246]
mat_Sqrt:  [[ 8.24332533  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01578531  0.01342918 -0.15505046]
Stock Position:  0.01578531161419111
Bond Position:  [2.09500234]


portfolio before change:  [3.7346405]
curr_Stock_Price:  103.83794708219665
curr_Factors:  [103.83794708  -1.58489692  -0.98738217]
mat_Sqrt:  [[ 7.92920194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00705449  0.03440714  0.61331003]
Stock Position:  -0.007054485390578068
Bond Position:  [4.46716378]


portfolio before change:  [3.73321644]
curr_Stock_Price:  104.19814284675259
curr_Factors:  [104.19814285  -1.41603634  -0.9928996 ]
mat_Sqrt:  [[ 9.36855029  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00071527 -0.02650682 -0.33847534]
Stock Position:  0.0007152724277682282
Bond Position:  [3.65868638]


portfolio before change:  [3.734658]
curr_Stock_Price:  104.93461705923043
curr_Factors:  [104.93461706  -1.71344583  -0.99584415]
mat_Sqrt:  [[ 6.98697347  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01798426  0.31068573 -1.5391764 ]
Stock Position:  0.01798426115321161
Bond Position:  [1.84748645]


portfolio before change:  [3.74118838]
curr_Stock_Price:  105.2720482631741
curr_Factors:  [105.27204826  -1.80965322  -0.97515573]
mat_Sqrt:  [[ 6.49958927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02226746 -0.02552236  0.01941734]
Stock Position:  0.0222674625055887
Bond Position:  [1.397047]


portfolio before change:  [3.75176293]
curr_Stock_Price:  105.73124916339924
curr_Factors:  [105.73124916  -1.50910498  -0.95482564]
mat_Sqrt:  [[ 8.99770794  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124885 -0.01047215 -0.29800592]
Stock Position:  -0.0012488480857277987
Bond Position:  [3.8838052]


portfolio before change:  [3.75371905]
curr_Stock_Price:  104.94248734156507
curr_Factors:  [104.94248734  -1.50948021  -0.92622529]
mat_Sqrt:  [[ 9.18624227  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00748835  0.00525786  0.16709793]
Stock Position:  -0.0074883520261268465
Bond Position:  [4.53956533]


portfolio before change:  [3.75258798]
curr_Stock_Price:  105.24510345804079
curr_Factors:  [105.24510346  -1.64546449  -0.93167337]
mat_Sqrt:  [[ 7.99770071  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.10945693e-05 -6.50015022e-02 -9.53505686e-02]
Stock Position:  -9.109456925734304e-05
Bond Position:  [3.76217524]


portfolio before change:  [3.75349735]
curr_Stock_Price:  105.58862296173135
curr_Factors:  [105.58862296  -1.4372306   -0.93534765]
mat_Sqrt:  [[ 9.8450854   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01376671  0.01835191 -0.05342923]
Stock Position:  -0.013766710537174955
Bond Position:  [5.20710536]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.7476972]
Stock Price:  106.10451175086098
PL:  [-2.35681455]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.11212746e-01  1.94755280e-01 -1.70579977e-03]
 [-8.83969379e-03 -5.91423646e-02  7.25615616e-02]
 [ 1.23190346e-01 -1.47116319e-02  3.98507622e-02]
 [-2.38070645e-01 -2.36902175e-01  7.00129939e-01]
 [-6.73427883e-02  5.97577761e-02 -4.96342428e-02]
 [-1.26727382e+00  1.26605784e+00 -1.80634174e-01]
 [-4.74000796e-04  1.46148462e-02 -3.25157664e-03]
 [-6.91142596e-02 -8.63836363e-02  1.12729472e-01]
 [ 2.26522066e-02 -2.83919882e-02 -2.16528577e-02]
 [-5.51178862e-01  2.86984527e-01 -2.74753080e-01]
 [ 3.21104929e-02  3.26032559e-02 -5.40454503e-02]
 [-3.09951146e-02  1.54262612e-01 -1.16707299e-03]
 [-1.58065618e-01 -1.17256350e-01 -2.21176067e-03]
 [ 2.38789754e-02  5.57731878e-01 -3.68422540e-01]
 [ 4.57627267e-02 -1.33278096e-01 -4.97449575e-02]
 [ 5.81279663e-02  4.95468884e-02  1.13321746e-01]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 2.70056587e-02 -7.31162388e-02 -3.16746183e-02]
 [-1.57789261e-01  3.06667004e-02 -2.95304859e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.85921713]
curr_Stock_Price:  98.84665862800904
curr_Factors:  [98.84665863 -0.87539329 -0.96555566]
mat_Sqrt:  [[15.68368178  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00457843  0.062857   -0.00486617]
Stock Position:  -0.004578432994930854
Bond Position:  [-6.40665433]


portfolio before change:  [-6.85560153]
curr_Stock_Price:  97.70708447300751
curr_Factors:  [97.70708447 -0.58071712 -0.95258843]
mat_Sqrt:  [[21.08724852  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0002893  -0.01908812  0.20699794]
Stock Position:  -0.00028929860896095713
Bond Position:  [-6.82733501]


portfolio before change:  [-6.85730146]
curr_Stock_Price:  97.68247268903986
curr_Factors:  [97.68247269 -0.67484157 -0.96171889]
mat_Sqrt:  [[19.01373626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0067489  -0.00474816  0.11368313]
Stock Position:  0.006748902338186176
Bond Position:  [-7.51655092]


portfolio before change:  [-6.84725597]
curr_Stock_Price:  99.44940584896555
curr_Factors:  [99.44940585 -0.75056437 -0.97641889]
mat_Sqrt:  [[17.68409707  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00811547 -0.07645985  1.99727584]
Stock Position:  -0.008115465182335035
Bond Position:  [-6.04017778]


portfolio before change:  [-6.84775084]
curr_Stock_Price:  99.32429163848846
curr_Factors:  [99.32429164 -0.67030698 -0.99936533]
mat_Sqrt:  [[18.70363444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00349003  0.01928674 -0.14159268]
Stock Position:  -0.0034900345651555703
Bond Position:  [-6.50110563]


portfolio before change:  [-6.84932041]
curr_Stock_Price:  99.30827176598449
curr_Factors:  [99.30827177 -0.62581612 -0.97771424]
mat_Sqrt:  [[19.97933526  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05233971  0.40861841 -0.51529902]
Stock Position:  -0.05233971135405941
Bond Position:  [-1.65155413]


portfolio before change:  [-6.88059627]
curr_Stock_Price:  99.8979372343374
curr_Factors:  [99.89793723 -0.54382973 -0.97612531]
mat_Sqrt:  [[21.84984876  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.44635998e-05  4.71692131e-03 -9.27584308e-03]
Stock Position:  8.446359976850119e-05
Bond Position:  [-6.88903401]


portfolio before change:  [-6.88226062]
curr_Stock_Price:  100.58609327416396
curr_Factors:  [100.58609327  -0.14531108  -0.96850085]
mat_Sqrt:  [[33.02292686  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00193007 -0.0278802   0.32158581]
Stock Position:  -0.0019300663025987304
Bond Position:  [-6.68812279]


portfolio before change:  [-6.89326028]
curr_Stock_Price:  105.41878400740326
curr_Factors:  [105.41878401  -0.38428746  -0.98863824]
mat_Sqrt:  [[26.70938858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00046564 -0.00916347 -0.06176958]
Stock Position:  0.0004656357128274468
Bond Position:  [-6.94234703]


portfolio before change:  [-6.89617821]
curr_Stock_Price:  102.8800334255562
curr_Factors:  [102.88003343  -0.53473334  -0.99506287]
mat_Sqrt:  [[22.28173696  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02462475  0.09262386 -0.78379406]
Stock Position:  -0.024624746669930433
Bond Position:  [-4.36278345]


portfolio before change:  [-6.82671986]
curr_Stock_Price:  100.01506255193858
curr_Factors:  [100.01506255  -0.49003178  -0.96104217]
mat_Sqrt:  [[23.43538007  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00118341  0.01052266 -0.15417663]
Stock Position:  0.001183408301710475
Bond Position:  [-6.94507852]


portfolio before change:  [-6.82781989]
curr_Stock_Price:  100.55288159141392
curr_Factors:  [100.55288159  -0.8362806   -1.0249671 ]
mat_Sqrt:  [[15.63381308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.63351952e-05  4.97880439e-02 -3.32933439e-03]
Stock Position:  1.6335195248273914e-05
Bond Position:  [-6.82946244]


portfolio before change:  [-6.82951894]
curr_Stock_Price:  101.07495730152567
curr_Factors:  [101.0749573   -1.15300673  -1.0106499 ]
mat_Sqrt:  [[11.61393618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01570974 -0.03784432 -0.00630954]
Stock Position:  -0.015709742211894057
Bond Position:  [-5.24165742]


portfolio before change:  [-6.8348733]
curr_Stock_Price:  101.33236344372457
curr_Factors:  [101.33236344  -0.89887032  -1.04321192]
mat_Sqrt:  [[14.53157114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00430247  0.18000719 -1.05100696]
Stock Position:  0.004302465411412408
Bond Position:  [-7.27085229]


portfolio before change:  [-6.83332507]
curr_Stock_Price:  102.11474691009268
curr_Factors:  [102.11474691  -0.70988017  -1.06384477]
mat_Sqrt:  [[17.32884081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00048493 -0.04301532 -0.14190852]
Stock Position:  0.0004849315920458466
Bond Position:  [-6.88284373]


portfolio before change:  [-6.83609436]
curr_Stock_Price:  99.95284925760855
curr_Factors:  [99.95284926 -0.66457402 -1.02023435]
mat_Sqrt:  [[18.53925179  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00492864 0.01599119 0.3232754 ]
Stock Position:  0.004928644809894978
Bond Position:  [-7.32872646]


portfolio before change:  [-6.83575595]
curr_Stock_Price:  100.39330065536534
curr_Factors:  [100.39330066  -0.40954659  -1.02653399]
mat_Sqrt:  [[23.8793698   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00288072  0.00525786  0.16709793]
Stock Position:  -0.0028807215812076295
Bond Position:  [-6.5465508]


portfolio before change:  [-6.83592198]
curr_Stock_Price:  99.88273021490743
curr_Factors:  [ 9.98827302e+01 -9.15935803e-02 -1.05359040e+00]
mat_Sqrt:  [[31.77922659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0001767  -0.02359816 -0.09035887]
Stock Position:  0.000176697647368266
Bond Position:  [-6.85357102]


portfolio before change:  [-6.83668973]
curr_Stock_Price:  105.23568145100226
curr_Factors:  [105.23568145  -0.29592701  -1.05757844]
mat_Sqrt:  [[27.18585973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00579556  0.00989763 -0.08424226]
Stock Position:  -0.005795561881129927
Bond Position:  [-6.22678983]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.85254244]
Stock Price:  107.70236424614707
PL:  [-14.55490668]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-4.19546568e-02  4.15198867e-02  3.59868934e-02]
 [ 1.16008696e-01  1.55871636e-01 -2.77976910e-01]
 [-8.45464804e-02  4.24730977e-02 -1.05134201e-02]
 [-4.22749255e-01 -4.64814172e-01  1.63855785e+00]
 [-6.54067910e-02  5.68996933e-02 -4.77092461e-02]
 [-1.32358973e+00  1.36024224e+00 -2.00007013e-01]
 [ 7.34079217e-03 -2.52636939e-03  2.58098096e-02]
 [-6.78755334e-02 -7.78090009e-02  9.38936830e-02]
 [ 4.32336731e-02  2.42827047e-02  6.05118753e-02]
 [-5.93971246e-01  2.95408543e-01 -2.98742838e-01]
 [ 1.42841072e-01  4.74694896e-02 -5.53944810e-02]
 [-1.14555640e-01  1.10303198e-01  1.98224208e-01]
 [ 2.95199185e-01 -3.59277376e-02 -1.88720974e-01]
 [ 4.60920907e-02  1.25365233e+00 -6.77678671e-01]
 [ 1.66614892e-01 -1.31092526e-01  1.44818520e-02]
 [ 1.27097118e-02 -3.90327379e-02 -1.57228740e-01]
 [-8.71999365e-02  1.57632701e-02  5.70047424e-02]
 [ 4.98481396e-02 -2.75689758e-01 -2.49720125e-02]
 [-9.60193000e-02  2.39673823e-01 -1.91591621e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.83494932]
curr_Stock_Price:  99.94265963245624
curr_Factors:  [99.94265963 -0.88027319 -1.03044561]
mat_Sqrt:  [[14.78891354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00176711  0.01340049  0.10266059]
Stock Position:  -0.0017671109820175772
Bond Position:  [2.01155909]


portfolio before change:  [1.83541302]
curr_Stock_Price:  99.9648685692553
curr_Factors:  [99.96486857 -0.34937603 -1.02505068]
mat_Sqrt:  [[25.28957111  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00360165  0.05030735 -0.79299075]
Stock Position:  0.0036016451524437613
Bond Position:  [1.47537504]


portfolio before change:  [1.84130079]
curr_Stock_Price:  101.49718977713586
curr_Factors:  [101.49718978  -0.32770512  -1.02720594]
mat_Sqrt:  [[26.18325406  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297987  0.01370813 -0.02999186]
Stock Position:  -0.002979871727350125
Bond Position:  [2.1437494]


portfolio before change:  [1.8352966]
curr_Stock_Price:  103.69198069072321
curr_Factors:  [103.69198069  -0.37367257  -1.07172555]
mat_Sqrt:  [[24.43524752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00749572 -0.15001813  4.67434945]
Stock Position:  -0.007495722328872708
Bond Position:  [2.6125429]


portfolio before change:  [1.87553429]
curr_Stock_Price:  98.41103905746054
curr_Factors:  [98.41103906 -0.52671391 -1.06714844]
mat_Sqrt:  [[19.99116915  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00317794  0.0183643  -0.1361012 ]
Stock Position:  -0.003177943139187744
Bond Position:  [2.18827898]


portfolio before change:  [1.87061603]
curr_Stock_Price:  100.13083001584702
curr_Factors:  [100.13083002  -0.73031501  -1.07702079]
mat_Sqrt:  [[16.43054062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06614254  0.4390163  -0.57056434]
Stock Position:  -0.06614254103144691
Bond Position:  [8.49352356]


portfolio before change:  [1.81741269]
curr_Stock_Price:  100.96731116077268
curr_Factors:  [100.96731116  -0.67775297  -1.09970787]
mat_Sqrt:  [[17.07022925  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00070846 -0.00081538  0.0736282 ]
Stock Position:  0.0007084558926461994
Bond Position:  [1.7458818]


portfolio before change:  [1.81925526]
curr_Stock_Price:  102.95198120672094
curr_Factors:  [102.95198121  -0.89422622  -1.09560722]
mat_Sqrt:  [[14.07540906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00458901 -0.02511275  0.26785254]
Stock Position:  -0.004589014864931696
Bond Position:  [2.29170344]


portfolio before change:  [1.82424193]
curr_Stock_Price:  101.9901908294186
curr_Factors:  [101.99019083  -0.6178791   -1.04324182]
mat_Sqrt:  [[19.37058577  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00312548 0.00783721 0.17262354]
Stock Position:  0.0031254756535849847
Bond Position:  [1.50547407]


portfolio before change:  [1.82774213]
curr_Stock_Price:  102.98964926743454
curr_Factors:  [102.98964927  -0.79607139  -1.02446483]
mat_Sqrt:  [[16.67802981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0356548   0.0953427  -0.85223016]
Stock Position:  -0.03565480233258035
Bond Position:  [5.49981772]


portfolio before change:  [1.79241736]
curr_Stock_Price:  104.0189607997219
curr_Factors:  [104.0189608   -1.04248952  -1.03226985]
mat_Sqrt:  [[13.0633921   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01081062  0.01532071 -0.15802504]
Stock Position:  0.010810621665678767
Bond Position:  [0.66790773]


portfolio before change:  [1.8129461]
curr_Stock_Price:  105.90245550196894
curr_Factors:  [105.9024555  -1.3046496  -1.0295076]
mat_Sqrt:  [[10.26111221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00502653  0.0356002   0.56547849]
Stock Position:  -0.0050265259867871325
Bond Position:  [2.34526755]


portfolio before change:  [1.8056825]
curr_Stock_Price:  107.46416968370384
curr_Factors:  [107.46416968  -1.62555739  -1.03220317]
mat_Sqrt:  [[ 7.53378015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03309666 -0.01159563 -0.53836841]
Stock Position:  0.033096659770719204
Bond Position:  [-1.75102256]


portfolio before change:  [1.83446823]
curr_Stock_Price:  108.3471453113908
curr_Factors:  [108.34714531  -1.86554152  -1.05361943]
mat_Sqrt:  [[ 5.84846619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02798379  0.40461455 -1.93322862]
Stock Position:  0.027983785029534768
Bond Position:  [-1.19749499]


portfolio before change:  [1.82376078]
curr_Stock_Price:  107.97521417168443
curr_Factors:  [107.97521417  -2.13232148  -1.0167908 ]
mat_Sqrt:  [[ 4.63107685  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03083772 -0.04230993  0.04131269]
Stock Position:  0.03083771720669816
Bond Position:  [-1.50594834]


portfolio before change:  [1.81812512]
curr_Stock_Price:  107.80467230418411
curr_Factors:  [107.8046723   -2.50709994  -1.00746929]
mat_Sqrt:  [[ 3.20833392  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0085253  -0.01259776 -0.44852983]
Stock Position:  -0.008525295427088058
Bond Position:  [2.7371918]


portfolio before change:  [1.81881608]
curr_Stock_Price:  107.80390160901108
curr_Factors:  [107.80390161  -2.11463616  -0.97656038]
mat_Sqrt:  [[ 4.89942236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01476628  0.00508757  0.16261866]
Stock Position:  -0.014766277088335816
Bond Position:  [3.41067836]


portfolio before change:  [1.81713118]
curr_Stock_Price:  107.97575726059732
curr_Factors:  [107.97575726  -2.24209387  -0.93620474]
mat_Sqrt:  [[ 4.4978888   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00256213 -0.08897849 -0.0712382 ]
Stock Position:  -0.0025621325555581506
Bond Position:  [2.09377939]


portfolio before change:  [1.81831338]
curr_Stock_Price:  107.71867173635712
curr_Factors:  [107.71867174  -2.38017433  -0.93414779]
mat_Sqrt:  [[ 3.91650946  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01302357  0.07735439 -0.05465576]
Stock Position:  -0.013023569546090179
Bond Position:  [3.221195]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.82026814]
Stock Price:  107.63041949182866
PL:  [-5.81015135]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.45061942e-02  2.22232869e-03  3.87407995e-02]
 [ 3.57822771e-02  9.79700745e-02 -2.11314485e-01]
 [ 8.96453216e-02 -5.30590022e-02 -1.33119346e-02]
 [-1.13166126e-01 -6.82089019e-02  3.37246616e-01]
 [ 3.61051970e-02 -9.29608873e-02  5.32259369e-02]
 [-1.09604993e+00  1.08642876e+00 -1.49551279e-01]
 [-5.32830419e-04  1.47202091e-02 -3.41905480e-03]
 [ 7.38371970e-02 -4.10511613e-02 -2.39269521e-02]
 [ 1.02898903e-02  2.79951236e-02  4.68350155e-02]
 [ 1.51855532e-01  1.28839836e-01  9.20989282e-02]
 [ 1.84321264e-02 -4.82393223e-02 -3.56048508e-02]
 [ 9.57676634e-02 -3.70078709e-02 -3.76047274e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-1.01599590e-01 -2.69334939e-02 -7.43896086e-02]
 [ 7.87653948e-02  2.72024662e-01  4.55521361e-02]
 [ 5.98907008e-02  1.20139762e-01 -1.82779552e-01]
 [ 7.32832194e-02 -1.65944295e-01  1.36341366e-01]
 [-5.64696535e-02  7.78353320e-02  3.24085805e-02]
 [ 4.57262366e-02 -1.26249731e-01 -1.41194433e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.47219417]
curr_Stock_Price:  100.40117673574558
curr_Factors:  [100.40117674  -0.75679878  -0.96507652]
mat_Sqrt:  [[17.94476869  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034242  0.00071725  0.11051672]
Stock Position:  -0.0003424190488163004
Bond Position:  [5.50657345]


portfolio before change:  [5.47384783]
curr_Stock_Price:  99.59267904015417
curr_Factors:  [99.59267904 -0.85852985 -0.94336142]
mat_Sqrt:  [[16.4314534   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00076962  0.03161971 -0.60282141]
Stock Position:  0.0007696182399568023
Bond Position:  [5.39719949]


portfolio before change:  [5.47447621]
curr_Stock_Price:  98.65572878405243
curr_Factors:  [98.65572878 -1.03184655 -0.9125033 ]
mat_Sqrt:  [[14.11568309  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00539098 -0.01712472 -0.03797524]
Stock Position:  0.005390983234283292
Bond Position:  [4.94262483]


portfolio before change:  [5.47803378]
curr_Stock_Price:  99.08640460233934
curr_Factors:  [99.0864046  -1.21223081 -0.90197511]
mat_Sqrt:  [[11.96261452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00486926 -0.02201433  0.96207072]
Stock Position:  -0.004869255974406734
Bond Position:  [5.96051085]


portfolio before change:  [5.47528393]
curr_Stock_Price:  99.957209358948
curr_Factors:  [99.95720936 -1.18444746 -0.89141104]
mat_Sqrt:  [[12.53950034  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00223249 -0.030003    0.15183878]
Stock Position:  0.0022324919993069263
Bond Position:  [5.25213026]


portfolio before change:  [5.4756102]
curr_Stock_Price:  99.51513694305378
curr_Factors:  [99.51513694 -0.85427737 -0.92126817]
mat_Sqrt:  [[16.85697012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05367576  0.35064337 -0.42662817]
Stock Position:  -0.0536757558212431
Bond Position:  [10.81716039]


portfolio before change:  [5.50278993]
curr_Stock_Price:  99.05915646662629
curr_Factors:  [99.05915647 -1.03810272 -0.90078055]
mat_Sqrt:  [[14.25109783  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00012448  0.00475093 -0.00975361]
Stock Position:  0.00012448220185435466
Bond Position:  [5.49045882]


portfolio before change:  [5.50384682]
curr_Stock_Price:  96.52152535511746
curr_Factors:  [96.52152536 -0.51612841 -0.91626697]
mat_Sqrt:  [[23.04319869  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0026287  -0.01324921 -0.06825693]
Stock Position:  0.0026286973426003783
Bond Position:  [5.25012095]


portfolio before change:  [5.50655488]
curr_Stock_Price:  97.05234629333617
curr_Factors:  [97.05234629 -0.44603996 -0.92050139]
mat_Sqrt:  [[24.74712038  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00103303 0.00903539 0.13360726]
Stock Position:  0.001033030433136734
Bond Position:  [5.40629686]


portfolio before change:  [5.50577954]
curr_Stock_Price:  94.99327253111018
curr_Factors:  [94.99327253 -0.14284263 -0.94461972]
mat_Sqrt:  [[32.01945625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00615109 0.04158288 0.26273261]
Stock Position:  0.006151087218002712
Bond Position:  [4.92146764]


portfolio before change:  [5.52579858]
curr_Stock_Price:  98.04777586169065
curr_Factors:  [ 9.80477759e+01  4.81914732e-02 -9.69790843e-01]
mat_Sqrt:  [[39.01146192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.37722858e-05 -1.55691743e-02 -1.01570729e-01]
Stock Position:  3.377228578099098e-05
Bond Position:  [5.52248728]


portfolio before change:  [5.52701285]
curr_Stock_Price:  93.11710858453526
curr_Factors:  [93.11710858 -0.13276549 -0.92924905]
mat_Sqrt:  [[32.19603779  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00250147 -0.01194424 -0.10727582]
Stock Position:  0.0025014702471901793
Bond Position:  [5.29408318]


portfolio before change:  [5.52767201]
curr_Stock_Price:  92.85145221029605
curr_Factors:  [ 9.28514522e+01  4.22102992e-02 -9.47598308e-01]
mat_Sqrt:  [[37.54772982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00044906 -0.00995959  0.34984664]
Stock Position:  0.00044905839824297496
Bond Position:  [5.48597628]


portfolio before change:  [5.52772275]
curr_Stock_Price:  89.9099140765733
curr_Factors:  [ 8.99099141e+01  6.16332654e-02 -9.38493456e-01]
mat_Sqrt:  [[37.41037317  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00326867 -0.00869275 -0.21221285]
Stock Position:  -0.0032686677824957464
Bond Position:  [5.82160839]


portfolio before change:  [5.53282758]
curr_Stock_Price:  88.79348250059994
curr_Factors:  [88.7934825   0.22382319 -0.8995723 ]
mat_Sqrt:  [[45.17591715  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00317847 0.08779558 0.12994757]
Stock Position:  0.003178474205510391
Bond Position:  [5.25059979]


portfolio before change:  [5.53957029]
curr_Stock_Price:  90.50181553012288
curr_Factors:  [ 9.05018155e+01  2.89397336e-02 -8.68056859e-01]
mat_Sqrt:  [[39.10509582  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00120456  0.03877494 -0.52141919]
Stock Position:  0.001204559313343318
Bond Position:  [5.43055548]


portfolio before change:  [5.54465482]
curr_Stock_Price:  93.5956641921188
curr_Factors:  [ 9.35956642e+01  3.68116209e-02 -8.84241989e-01]
mat_Sqrt:  [[40.10711264  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00167652 -0.05355829  0.38894397]
Stock Position:  0.001676524248684164
Bond Position:  [5.38773942]


portfolio before change:  [5.55215559]
curr_Stock_Price:  97.2661551644871
curr_Factors:  [97.26615516  0.26264125 -0.87633781]
mat_Sqrt:  [[52.65464895  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064508  0.02512125  0.09245266]
Stock Position:  -0.0006450752165728443
Bond Position:  [5.61489957]


portfolio before change:  [5.5523577]
curr_Stock_Price:  99.12918289617296
curr_Factors:  [99.1291829   0.17483403 -0.89727531]
mat_Sqrt:  [[48.13370211  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.84186433e-04 -4.07469256e-02 -4.02788417e-01]
Stock Position:  -0.00018418643285264053
Bond Position:  [5.57061595]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.55241855]
Stock Price:  106.36083058331758
PL:  [-0.80841203]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-9.91485464e-02  1.80076420e-01  3.58114811e-03]
 [-1.69974413e-02 -8.65827989e-02  1.66147787e-01]
 [ 7.69675771e-02 -5.80618794e-02 -3.48998062e-02]
 [-2.34896436e-01 -2.28044499e-01  8.35330182e-01]
 [-2.22953371e-02 -6.74508049e-03 -4.84275738e-03]
 [-1.13262324e+00  1.08703368e+00 -1.44458916e-01]
 [-4.96511043e-03 -2.01134992e-02 -6.52513260e-03]
 [ 5.00152152e-02  1.71916243e-03 -4.29417813e-02]
 [-5.47701649e-02  3.04719287e-02  5.59106629e-02]
 [ 1.44148629e-01  1.65625334e-01  1.13348055e-01]
 [-2.74459982e-01 -2.52469824e-01  5.99636897e-02]
 [ 7.72256403e-02 -4.27877508e-02 -4.25616861e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-1.10210918e-01 -2.32039244e-02 -8.74476633e-02]
 [ 6.45245265e-02  2.49993514e-01  1.02666933e-01]
 [ 7.44062483e-02  1.11300261e-01 -7.25297047e-02]
 [ 2.93075848e-01 -2.74667632e-01  2.18355895e-01]
 [-1.74588590e-01  1.34978054e-01  2.23713135e-01]
 [ 3.18992579e-01 -2.63914878e-01 -5.85657404e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.85544877]
curr_Stock_Price:  98.84713367389423
curr_Factors:  [98.84713367 -1.08453362 -1.02361637]
mat_Sqrt:  [[12.00621663  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00513564  0.05811941  0.01021602]
Stock Position:  -0.005135639653034399
Bond Position:  [-6.34780551]


portfolio before change:  [-6.85237426]
curr_Stock_Price:  97.9394269420348
curr_Factors:  [97.93942694 -0.88192374 -1.00478481]
mat_Sqrt:  [[14.84466648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.09479978e-05 -2.79444782e-02  4.73973390e-01]
Stock Position:  -5.0947997809655185e-05
Bond Position:  [-6.84738445]


portfolio before change:  [-6.85415095]
curr_Stock_Price:  99.20789050754823
curr_Factors:  [99.20789051 -0.79753183 -0.99012575]
mat_Sqrt:  [[16.60261087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00349294 -0.01873939 -0.09955943]
Stock Position:  0.0034929357143697677
Bond Position:  [-7.20067773]


portfolio before change:  [-6.84959141]
curr_Stock_Price:  101.0286902733534
curr_Factors:  [101.02869027  -0.95304091  -0.97899505]
mat_Sqrt:  [[14.63430718  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00758046 -0.07360105  2.3829645 ]
Stock Position:  -0.007580458995144272
Bond Position:  [-6.08374756]


portfolio before change:  [-6.85471382]
curr_Stock_Price:  101.50376539074928
curr_Factors:  [101.50376539  -0.68984647  -0.94240769]
mat_Sqrt:  [[19.84281008  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012428  -0.00217697 -0.01381504]
Stock Position:  -0.00124280253307108
Bond Position:  [-6.72856468]


portfolio before change:  [-6.85231711]
curr_Stock_Price:  98.2216180191474
curr_Factors:  [98.22161802 -0.8283336  -0.9396073 ]
mat_Sqrt:  [[16.76486677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05608282  0.35083861 -0.41210108]
Stock Position:  -0.056082818044704365
Bond Position:  [-1.34377198]


portfolio before change:  [-6.84676273]
curr_Stock_Price:  98.1165881530371
curr_Factors:  [98.11658815 -0.73712536 -0.90936914]
mat_Sqrt:  [[18.90945283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055013 -0.0064916  -0.01861439]
Stock Position:  -0.0005501321738340492
Bond Position:  [-6.79278563]


portfolio before change:  [-6.84801869]
curr_Stock_Price:  97.31234057937269
curr_Factors:  [97.31234058 -0.11410053 -0.91442393]
mat_Sqrt:  [[34.79248269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00119568  0.00055486 -0.12250095]
Stock Position:  0.0011956802191690548
Bond Position:  [-6.96437313]


portfolio before change:  [-6.85197561]
curr_Stock_Price:  95.45933488557878
curr_Factors:  [ 9.54593349e+01  9.86720583e-03 -9.32546667e-01]
mat_Sqrt:  [[37.940566    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00097883  0.00983477  0.15949756]
Stock Position:  -0.000978830737812841
Bond Position:  [-6.75853707]


portfolio before change:  [-6.84979]
curr_Stock_Price:  91.50007044379342
curr_Factors:  [91.50007044  0.16082555 -0.94811289]
mat_Sqrt:  [[41.63963184  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00482939 0.05345535 0.32335045]
Stock Position:  0.004829385498549426
Bond Position:  [-7.29167911]


portfolio before change:  [-6.85225134]
curr_Stock_Price:  91.36792289739574
curr_Factors:  [91.3679229  -0.13249656 -0.93688403]
mat_Sqrt:  [[31.35939409  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01000514 -0.08148429  0.17105972]
Stock Position:  -0.010005140127839039
Bond Position:  [-5.93810247]


portfolio before change:  [-6.83990819]
curr_Stock_Price:  89.98584683603634
curr_Factors:  [ 8.99858468e+01 -9.83700869e-03 -9.11592373e-01]
mat_Sqrt:  [[35.80985083  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00167004 -0.01380969 -0.12141664]
Stock Position:  0.0016700365412819788
Bond Position:  [-6.99018784]


portfolio before change:  [-6.84314587]
curr_Stock_Price:  89.0936993877457
curr_Factors:  [89.09369939 -0.0895171  -0.90085816]
mat_Sqrt:  [[33.09272124  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00050951 -0.00995959  0.34984664]
Stock Position:  0.0005095115414102868
Bond Position:  [-6.88854014]


portfolio before change:  [-6.84461436]
curr_Stock_Price:  89.59194612819796
curr_Factors:  [89.59194613 -0.36521734 -0.87741949]
mat_Sqrt:  [[25.85822153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0051356  -0.00748903 -0.24946384]
Stock Position:  -0.00513560372359731
Bond Position:  [-6.38450563]


portfolio before change:  [-6.84875552]
curr_Stock_Price:  90.0874743967613
curr_Factors:  [90.0874744  -0.78664375 -0.85462536]
mat_Sqrt:  [[17.45300833  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00782163 0.08068506 0.29288018]
Stock Position:  0.007821633736743612
Bond Position:  [-7.55338675]


portfolio before change:  [-6.84746765]
curr_Stock_Price:  90.49358531733958
curr_Factors:  [90.49358532 -1.1534445  -0.84231446]
mat_Sqrt:  [[12.2990252   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00669323  0.035922   -0.20690706]
Stock Position:  0.0066932341054608884
Bond Position:  [-7.45316241]


portfolio before change:  [-6.86330379]
curr_Stock_Price:  88.40601188100439
curr_Factors:  [88.40601188 -0.78595944 -0.80881741]
mat_Sqrt:  [[17.94233734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01569368 -0.0886486   0.62290859]
Stock Position:  0.01569367790561091
Bond Position:  [-8.25071927]


portfolio before change:  [-6.83016432]
curr_Stock_Price:  90.64910689974442
curr_Factors:  [90.6491069  -0.8284295  -0.83081261]
mat_Sqrt:  [[17.24899663  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00587692  0.04356398  0.6381913 ]
Stock Position:  -0.005876924891905615
Bond Position:  [-6.29742633]


portfolio before change:  [-6.81709919]
curr_Stock_Price:  88.15806257424343
curr_Factors:  [88.15806257 -0.47510705 -0.79468466]
mat_Sqrt:  [[24.76272898  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00587877 -0.08517816 -1.67071756]
Stock Position:  0.005878769009297652
Bond Position:  [-7.33536008]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.82709938]
Stock Price:  86.76897666466648
PL:  [-6.82709938]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 3.08375631e-02 -1.40741969e-01  8.77117790e-03]
 [ 5.43200485e-03  1.04601880e-01 -1.13326510e-01]
 [ 3.22141447e-02 -1.25027002e-01 -2.76507651e-01]
 [-1.76386089e-01 -1.38334189e-01  9.10802277e-01]
 [ 4.95187830e-03 -7.85612800e-02  1.78741940e-02]
 [-1.00598769e+00  1.12918166e+00 -1.67926126e-01]
 [ 9.70697307e-03 -3.61911514e-03  2.57319643e-02]
 [-6.91434223e-02 -7.36154525e-02  8.53931335e-02]
 [ 2.90627768e-02  3.56396608e-03  2.80140572e-02]
 [-4.67814218e-01  2.68513266e-01 -2.30359582e-01]
 [ 3.79403417e-02  4.93817338e-02 -5.49397498e-02]
 [ 1.10515353e-02  9.98687453e-02 -1.04956067e-02]
 [-1.43239665e-02 -5.39937823e-02 -1.85287659e-02]
 [ 2.27063272e-02  5.53832068e-01 -3.69533585e-01]
 [ 8.27258141e-02 -7.97074454e-02 -4.46009346e-02]
 [ 5.86242542e-02  6.69795099e-02  9.58423827e-02]
 [-8.61643434e-02  1.58730891e-02  5.65328207e-02]
 [ 3.84882629e-02 -1.21153710e-01 -4.24771553e-02]
 [-7.12403774e-02 -2.35260329e-02 -9.56214094e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [28.25778847]
curr_Stock_Price:  103.27356644580865
curr_Factors:  [103.27356645  -1.23589914  -0.97667661]
mat_Sqrt:  [[11.3000337   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00034506 -0.04542428  0.02502173]
Stock Position:  0.00034505545299956834
Bond Position:  [28.22215337]


portfolio before change:  [28.26486313]
curr_Stock_Price:  103.32642633864772
curr_Factors:  [103.32642634  -1.32978452  -0.95427705]
mat_Sqrt:  [[10.52582324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00034687  0.03376011 -0.32328899]
Stock Position:  0.00034687046191648585
Bond Position:  [28.22902225]


portfolio before change:  [28.27197278]
curr_Stock_Price:  103.47491503729279
curr_Factors:  [103.47491504  -1.63657829  -0.99455006]
mat_Sqrt:  [[ 7.44990186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00667778 -0.04035229 -0.78879936]
Stock Position:  -0.006677775655232549
Bond Position:  [28.96295505]


portfolio before change:  [28.27827751]
curr_Stock_Price:  103.61521840128545
curr_Factors:  [103.6152184   -1.43363274  -1.00657346]
mat_Sqrt:  [[ 9.02932864  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.07177093e-03 -4.46471676e-02  2.59826538e+00]
Stock Position:  -0.002071770933968421
Bond Position:  [28.4929445]


portfolio before change:  [28.28454785]
curr_Stock_Price:  104.0273198996371
curr_Factors:  [104.0273199   -1.60697842  -1.04506602]
mat_Sqrt:  [[ 7.33464574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101379 -0.02535554  0.0509901 ]
Stock Position:  -0.001013794191305964
Bond Position:  [28.39001015]


portfolio before change:  [28.29210117]
curr_Stock_Price:  103.57858709124991
curr_Factors:  [103.57858709  -1.40306543  -1.06448714]
mat_Sqrt:  [[ 8.7826488   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09220137  0.36444182 -0.4790465 ]
Stock Position:  -0.09220136685602948
Bond Position:  [37.84218847]


portfolio before change:  [28.32008767]
curr_Stock_Price:  103.37767058001408
curr_Factors:  [103.37767058  -1.29839464  -1.06980043]
mat_Sqrt:  [[ 9.6812779   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00146889 -0.00116806  0.07340613]
Stock Position:  0.0014688907439336168
Bond Position:  [28.16823717]


portfolio before change:  [28.32684103]
curr_Stock_Price:  103.18052605230267
curr_Factors:  [103.18052605  -1.05541344  -1.08924217]
mat_Sqrt:  [[12.08330226  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00552327 -0.02375929  0.24360284]
Stock Position:  -0.005523267709857504
Bond Position:  [28.8967347]


portfolio before change:  [28.33139283]
curr_Stock_Price:  103.66453111348275
curr_Factors:  [103.66453111  -0.53459864  -1.08899296]
mat_Sqrt:  [[20.44152616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00173708 0.00115027 0.07991631]
Stock Position:  0.0017370823282209895
Bond Position:  [28.151319]


portfolio before change:  [28.33586345]
curr_Stock_Price:  102.18614356793246
curr_Factors:  [102.18614357  -0.4424276   -1.08991652]
mat_Sqrt:  [[22.07513725  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02083911  0.08666228 -0.65715177]
Stock Position:  -0.02083910619654227
Bond Position:  [30.46533135]


portfolio before change:  [28.33965753]
curr_Stock_Price:  102.36960691009043
curr_Factors:  [102.36960691  -0.58140672  -1.09920487]
mat_Sqrt:  [[19.06736565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0019303   0.01593789 -0.15672781]
Stock Position:  0.0019303042246335603
Bond Position:  [28.14205304]


portfolio before change:  [28.3467715]
curr_Stock_Price:  102.40979674746755
curr_Factors:  [102.40979675  -0.71431306  -1.06696529]
mat_Sqrt:  [[17.24813515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00169843  0.0322325  -0.02994104]
Stock Position:  0.0016984300357460766
Bond Position:  [28.17283562]


portfolio before change:  [28.35314908]
curr_Stock_Price:  102.01737067799648
curr_Factors:  [102.01737068  -0.5498113   -1.02981313]
mat_Sqrt:  [[21.02093121  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138565 -0.01742642 -0.05285741]
Stock Position:  -0.0013856460201435688
Bond Position:  [28.49450904]


portfolio before change:  [28.36103843]
curr_Stock_Price:  101.46540254603956
curr_Factors:  [101.46540255  -0.82365101  -1.05410673]
mat_Sqrt:  [[15.5173715   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00388765  0.17874853 -1.05417646]
Stock Position:  0.003887649238000007
Bond Position:  [27.96657654]


portfolio before change:  [28.37386337]
curr_Stock_Price:  102.96564708470366
curr_Factors:  [102.96564708  -0.62668197  -1.12356971]
mat_Sqrt:  [[17.88824373  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0032061  -0.02572547 -0.12723405]
Stock Position:  0.0032060985515196703
Bond Position:  [28.04374536]


portfolio before change:  [28.37621014]
curr_Stock_Price:  101.51059356258436
curr_Factors:  [101.51059356  -0.32339906  -1.16026114]
mat_Sqrt:  [[23.02321289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00398989 0.02161754 0.27341164]
Stock Position:  0.003989892041593895
Bond Position:  [27.97119383]


portfolio before change:  [28.38909628]
curr_Stock_Price:  102.98744107710752
curr_Factors:  [ 1.02987441e+02 -4.86535319e-03 -1.16451839e+00]
mat_Sqrt:  [[31.9836012   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223191  0.00512302  0.1612724 ]
Stock Position:  -0.0022319109247258403
Bond Position:  [28.61895507]


portfolio before change:  [28.39750074]
curr_Stock_Price:  102.42790585522388
curr_Factors:  [102.42790586   0.29860378  -1.1870306 ]
mat_Sqrt:  [[42.12883286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.20754649e-04 -3.91021916e-02 -1.21175501e-01]
Stock Position:  0.0001207546489812198
Bond Position:  [28.3851321]


portfolio before change:  [28.40472842]
curr_Stock_Price:  103.50866316630078
curr_Factors:  [103.50866317   0.11036284  -1.20105604]
mat_Sqrt:  [[34.77720397  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00274781 -0.00759299 -0.27278127]
Stock Position:  -0.002747812830194712
Bond Position:  [28.68915085]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [28.40632989]
Stock Price:  105.53635412828896
PL:  [22.86997576]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.01948112e-01  1.83482732e-01  2.35428212e-03]
 [-2.31537413e-03 -3.36226557e-02  1.36533035e-02]
 [ 1.72750321e-01  4.38651412e-02  1.11342333e-01]
 [-6.97409247e-02 -2.60215782e-02  1.55809540e-01]
 [-7.80285793e-02  7.55330445e-02 -6.02593157e-02]
 [-1.36771319e+00  1.33588620e+00 -1.90930037e-01]
 [-7.75495523e-02  3.22615926e-02 -1.35737281e-01]
 [ 8.76149198e-03  3.11598886e-02 -4.05523938e-02]
 [ 6.97571714e-02  2.68645129e-02  4.79493084e-02]
 [ 1.33931652e-01  1.31954984e-01  8.64144541e-02]
 [ 3.91247127e-02  2.09574465e-02 -5.42536519e-02]
 [-3.09951146e-02  1.54262612e-01 -1.16707299e-03]
 [-5.85825130e-02 -5.95809825e-02  9.53005125e-02]
 [ 2.54015736e-02  3.68913774e-01 -2.07922111e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 6.59260523e-02  4.75585994e-02  2.03265956e-01]
 [-8.75284246e-02  1.68692210e-02  5.63643182e-02]
 [ 8.43122769e-03 -3.70603919e-02 -1.88003387e-02]
 [-4.45111635e-02  4.88376021e-02 -7.51642878e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.57199252]
curr_Stock_Price:  99.00892829157549
curr_Factors:  [99.00892829 -0.84478372 -1.00150368]
mat_Sqrt:  [[15.62578803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00409671  0.0592188   0.00671611]
Stock Position:  -0.00409670795316064
Bond Position:  [-5.16638186]


portfolio before change:  [-5.56848295]
curr_Stock_Price:  97.8369312061608
curr_Factors:  [97.83693121 -0.47329059 -0.9841741 ]
mat_Sqrt:  [[22.77896292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00028059 -0.01085167  0.03894907]
Stock Position:  -0.00028059227759635825
Bond Position:  [-5.54103066]


portfolio before change:  [-5.56957646]
curr_Stock_Price:  96.79655559108906
curr_Factors:  [ 9.67965556e+01 -1.20046055e-03 -1.00496135e+00]
mat_Sqrt:  [[35.39071868  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00577643 0.01415741 0.31762869]
Stock Position:  0.005776427304944509
Bond Position:  [-6.12871472]


portfolio before change:  [-5.57279895]
curr_Stock_Price:  96.5039659910949
curr_Factors:  [96.50396599 -0.36894613 -0.98608199]
mat_Sqrt:  [[24.89223707  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00173741 -0.00839843  0.44448125]
Stock Position:  -0.0017374118612124758
Bond Position:  [-5.40513181]


portfolio before change:  [-5.57952487]
curr_Stock_Price:  99.5973411011594
curr_Factors:  [99.5973411  -0.49982537 -1.02385063]
mat_Sqrt:  [[21.70319447  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0034516   0.02437819 -0.17190305]
Stock Position:  -0.003451604444540576
Bond Position:  [-5.23575424]


portfolio before change:  [-5.57446473]
curr_Stock_Price:  97.75204213947728
curr_Factors:  [97.75204214 -0.67650034 -1.05684894]
mat_Sqrt:  [[17.27196748  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06565552  0.43115542 -0.54467025]
Stock Position:  -0.06565551926798242
Bond Position:  [0.84349636]


portfolio before change:  [-5.48379231]
curr_Stock_Price:  96.37422166774293
curr_Factors:  [96.37422167 -0.26323633 -1.0195712 ]
mat_Sqrt:  [[26.72050446  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00369272  0.01041238 -0.38722068]
Stock Position:  -0.0036927236511331138
Bond Position:  [-5.12790894]


portfolio before change:  [-5.49245582]
curr_Stock_Price:  98.37311891841114
curr_Factors:  [98.37311892 -0.33479911 -1.01252405]
mat_Sqrt:  [[25.5706297   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00026766  0.01005681 -0.11568469]
Stock Position:  0.00026766078721701116
Bond Position:  [-5.51878645]


portfolio before change:  [-5.49375121]
curr_Stock_Price:  98.68874339266965
curr_Factors:  [98.68874339 -0.63471043 -0.98795605]
mat_Sqrt:  [[19.47836589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00436528 0.00867048 0.13678603]
Stock Position:  0.004365277828701423
Bond Position:  [-5.92455499]


portfolio before change:  [-5.49280972]
curr_Stock_Price:  99.24376279863885
curr_Factors:  [99.2437628  -0.67630588 -0.96673179]
mat_Sqrt:  [[19.1929189   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00930062 0.04258829 0.24651638]
Stock Position:  0.009300624262033296
Bond Position:  [-6.41583867]


portfolio before change:  [-5.49687742]
curr_Stock_Price:  98.9788844681989
curr_Factors:  [98.97888447 -0.39570877 -0.92731383]
mat_Sqrt:  [[26.36095504  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00122637  0.00676399 -0.15477057]
Stock Position:  0.0012263650232684034
Bond Position:  [-5.61826166]


portfolio before change:  [-5.49893215]
curr_Stock_Price:  98.44887105063749
curr_Factors:  [98.44887105 -0.85228384 -0.93522158]
mat_Sqrt:  [[16.47809496  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.54982351e-05  4.97880439e-02 -3.32933439e-03]
Stock Position:  1.549823505753801e-05
Bond Position:  [-5.50045793]


portfolio before change:  [-5.5003206]
curr_Stock_Price:  97.59936500383658
curr_Factors:  [97.599365   -0.99439039 -0.83929924]
mat_Sqrt:  [[15.5986031   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0032882  -0.01922968  0.27186584]
Stock Position:  -0.0032881979309121023
Bond Position:  [-5.17939457]


portfolio before change:  [-5.50317116]
curr_Stock_Price:  98.07243462543178
curr_Factors:  [98.07243463 -0.91266876 -0.85157568]
mat_Sqrt:  [[16.80139469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0034678   0.11906641 -0.59314391]
Stock Position:  0.00346779896529464
Bond Position:  [-5.84326664]


portfolio before change:  [-5.50204159]
curr_Stock_Price:  98.81946884097685
curr_Factors:  [98.81946884 -1.04891247 -0.86194654]
mat_Sqrt:  [[14.62066042  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00909624 -0.09296045 -0.18429859]
Stock Position:  -0.00909624290153285
Bond Position:  [-4.6031557]


portfolio before change:  [-5.51143286]
curr_Stock_Price:  99.72537440608818
curr_Factors:  [99.72537441 -1.23770267 -0.85590955]
mat_Sqrt:  [[12.29027047  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00952993 0.01534947 0.57986119]
Stock Position:  0.0095299286203553
Bond Position:  [-6.46180856]


portfolio before change:  [-5.50978516]
curr_Stock_Price:  100.06780614557562
curr_Factors:  [100.06780615  -1.07650303  -0.89666458]
mat_Sqrt:  [[13.91100705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00521743  0.00544452  0.16079171]
Stock Position:  -0.005217428958220059
Bond Position:  [-4.98768849]


portfolio before change:  [-5.5053821]
curr_Stock_Price:  98.98487101002776
curr_Factors:  [98.98487101 -0.78245024 -0.87039341]
mat_Sqrt:  [[18.95605445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00015675 -0.01196119 -0.05363213]
Stock Position:  -0.0001567465523640084
Bond Position:  [-5.48986657]


portfolio before change:  [-5.50677417]
curr_Stock_Price:  99.10879885345767
curr_Factors:  [99.10879885 -0.97488546 -0.9104247 ]
mat_Sqrt:  [[15.04292934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331618  0.01576227 -0.21442279]
Stock Position:  -0.0033161809514081083
Bond Position:  [-5.17811146]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.50474547]
Stock Price:  98.10662462424371
PL:  [-5.50474547]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-5.88151012e-03 -1.17585122e-02  4.53710331e-02]
 [ 2.92078088e-02  1.61900989e-01 -2.12889942e-01]
 [-4.46216980e-02 -7.75462169e-02 -1.11379288e-01]
 [-1.86230872e-01 -1.61753285e-01  6.93152751e-01]
 [-8.73047799e-03 -2.67706726e-02  8.64502439e-03]
 [-9.22198414e-01  9.60598752e-01 -1.29525681e-01]
 [ 1.15927986e-02 -9.38219042e-03  3.62691527e-02]
 [-9.30055936e-02 -2.10200642e-02 -1.81983753e-02]
 [ 8.85941235e-03  2.16556855e-02  5.83269993e-02]
 [-1.00468468e-01  1.81373394e-01 -4.12703903e-02]
 [ 1.17988862e-01  3.22235143e-02 -5.26927341e-02]
 [-7.75914322e-02  1.29749281e-01  1.10020589e-01]
 [-1.87718775e-01 -1.24985946e-01  3.30533481e-02]
 [ 3.66704198e-02  6.00050658e-01 -3.35603395e-01]
 [-4.04906672e-02 -2.58285252e-01 -6.17485389e-02]
 [ 6.93792094e-02  6.00967015e-02  2.25363146e-01]
 [-8.53558184e-02  1.65057250e-02  5.77537262e-02]
 [ 3.69006624e-02 -1.00647316e-01 -4.26059697e-02]
 [-1.16514108e-01  7.49170588e-02 -2.68482384e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.48314091]
curr_Stock_Price:  100.78074166229301
curr_Factors:  [100.78074166  -1.14502872  -1.03838718]
mat_Sqrt:  [[11.35356033  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.62828005e-05 -3.79504349e-03  1.29430929e-01]
Stock Position:  8.628280048038557e-05
Bond Position:  [8.47444527]


portfolio before change:  [8.48529925]
curr_Stock_Price:  101.23813874506513
curr_Factors:  [101.23813875  -0.87557431  -1.03141817]
mat_Sqrt:  [[15.0365375   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00125027  0.05225332 -0.60731575]
Stock Position:  0.001250270040383124
Bond Position:  [8.35872424]


portfolio before change:  [8.48871567]
curr_Stock_Price:  102.29909311295111
curr_Factors:  [102.29909311  -1.01748214  -1.04645513]
mat_Sqrt:  [[12.98719065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00640523 -0.02502793 -0.31773411]
Stock Position:  -0.00640523093739051
Bond Position:  [9.14396499]


portfolio before change:  [8.4989746]
curr_Stock_Price:  101.05438340437296
curr_Factors:  [101.0543834   -1.16202461  -1.05518748]
mat_Sqrt:  [[11.00606769  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00706514 -0.05220565  1.97737186]
Stock Position:  -0.0070651400653815215
Bond Position:  [9.21293798]


portfolio before change:  [8.49608867]
curr_Stock_Price:  101.78889848955998
curr_Factors:  [101.78889849  -1.12420853  -1.01008775]
mat_Sqrt:  [[12.04445965  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103204 -0.0086402   0.02466185]
Stock Position:  -0.0010320396925888235
Bond Position:  [8.60113886]


portfolio before change:  [8.49877337]
curr_Stock_Price:  101.27133891895609
curr_Factors:  [101.27133892  -1.31689852  -0.99352856]
mat_Sqrt:  [[10.04802762  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07489593  0.31003191 -0.36950071]
Stock Position:  -0.07489592607131726
Bond Position:  [16.08358408]


portfolio before change:  [8.53944835]
curr_Stock_Price:  100.78194533685686
curr_Factors:  [100.78194534  -1.40266983  -0.92423983]
mat_Sqrt:  [[ 9.83600437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00173659 -0.00302809  0.1034658 ]
Stock Position:  0.0017365869424678015
Bond Position:  [8.36443174]


portfolio before change:  [8.54133874]
curr_Stock_Price:  100.6662106039043
curr_Factors:  [100.6662106   -1.11103971  -0.90945138]
mat_Sqrt:  [[13.34736657  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00756786 -0.0067842  -0.0519149 ]
Stock Position:  -0.00756786168346582
Bond Position:  [9.3031667]


portfolio before change:  [8.53876341]
curr_Stock_Price:  101.31387242514599
curr_Factors:  [101.31387243  -1.33320365  -0.88540491]
mat_Sqrt:  [[11.01893088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00228569 0.00698934 0.16639069]
Stock Position:  0.002285685407672124
Bond Position:  [8.30719177]


portfolio before change:  [8.5394037]
curr_Stock_Price:  100.68527851092655
curr_Factors:  [100.68527851  -1.33160437  -0.83308552]
mat_Sqrt:  [[11.55721261  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00621863  0.05853801 -0.11773294]
Stock Position:  -0.006218632823337644
Bond Position:  [9.16552848]


portfolio before change:  [8.53901007]
curr_Stock_Price:  101.11709342038706
curr_Factors:  [101.11709342  -1.47996127  -0.88375239]
mat_Sqrt:  [[ 9.51210808  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01196481  0.01040009 -0.1503177 ]
Stock Position:  0.011964813603554551
Bond Position:  [7.32916289]


portfolio before change:  [8.53353108]
curr_Stock_Price:  100.50600938230531
curr_Factors:  [100.50600938  -1.35054011  -0.8636952 ]
mat_Sqrt:  [[10.97897654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260941  0.0418764   0.31385812]
Stock Position:  -0.002609406478794185
Bond Position:  [8.79579211]


portfolio before change:  [8.53614207]
curr_Stock_Price:  100.34821008907461
curr_Factors:  [100.34821009  -1.32503094  -0.85473067]
mat_Sqrt:  [[11.34621975  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01819852 -0.04033904  0.094292  ]
Stock Position:  -0.01819852271230896
Bond Position:  [10.36233125]


portfolio before change:  [8.54696678]
curr_Stock_Price:  99.89576631496949
curr_Factors:  [99.89576631 -1.37521981 -0.81448654]
mat_Sqrt:  [[11.18329295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00810589  0.19366552 -0.95738307]
Stock Position:  0.008105885432399377
Bond Position:  [7.73722314]


portfolio before change:  [8.54792751]
curr_Stock_Price:  99.77562920471465
curr_Factors:  [99.7756292  -1.2851148  -0.79447969]
mat_Sqrt:  [[12.47004634  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00848572 -0.08336121 -0.17615139]
Stock Position:  -0.008485717555852238
Bond Position:  [9.39459532]


portfolio before change:  [8.54302259]
curr_Stock_Price:  100.63046084048653
curr_Factors:  [100.63046084  -0.9912918   -0.83424857]
mat_Sqrt:  [[16.2146415   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00787242 0.01939613 0.64289833]
Stock Position:  0.007872419300880486
Bond Position:  [7.75081741]


portfolio before change:  [8.54307104]
curr_Stock_Price:  100.39044574572128
curr_Factors:  [100.39044575  -0.72470775  -0.8208899 ]
mat_Sqrt:  [[21.40167925  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00328001  0.0053272   0.16475531]
Stock Position:  -0.0032800076385829362
Bond Position:  [8.87235247]


portfolio before change:  [8.5450491]
curr_Stock_Price:  100.46370817370212
curr_Factors:  [100.46370817  -1.07321307  -0.81527315]
mat_Sqrt:  [[15.20022648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00050389 -0.03248378 -0.12154297]
Stock Position:  0.0005038877410962348
Bond Position:  [8.49442667]


portfolio before change:  [8.54756275]
curr_Stock_Price:  101.23723969354955
curr_Factors:  [101.23723969  -0.84375555  -0.78720493]
mat_Sqrt:  [[19.81632687  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00513565  0.02417938 -0.00765906]
Stock Position:  -0.005135652288374699
Bond Position:  [9.06748201]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.55204159]
Stock Price:  100.80658725091116
PL:  [7.74545433]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-9.23086247e-02  1.71754090e-01  6.57863734e-03]
 [-7.61248887e-03 -5.27135931e-02  1.07659202e-01]
 [ 9.05934991e-02 -4.54226870e-02 -2.16003198e-02]
 [-2.37573846e-01 -2.33091874e-01  8.30955631e-01]
 [-1.20749156e-02 -2.18333310e-02  5.31959031e-03]
 [-7.58983177e-01  8.20343739e-01 -1.07241379e-01]
 [ 9.70697307e-03 -3.61911514e-03  2.57319643e-02]
 [-8.12460199e-02 -4.21072967e-02  2.25025179e-02]
 [-6.85731487e-02  1.27237601e-02  4.85549117e-02]
 [-3.69848760e-01  2.45256805e-01 -1.79952404e-01]
 [ 4.80951414e-02  4.26960090e-02 -5.39096450e-02]
 [-6.93699357e-02  1.34074435e-01  9.04025370e-02]
 [-1.48639238e-01 -1.17066513e-01 -1.17422318e-02]
 [ 2.87192299e-02  5.90170507e-01 -3.72180805e-01]
 [-1.69574635e-02 -2.24178549e-01 -5.84735057e-02]
 [ 6.05256716e-02  4.83341158e-02  1.41771970e-01]
 [-8.94416895e-02  1.83963143e-02  5.32846885e-02]
 [ 3.91043114e-02 -1.28013839e-01 -4.23143806e-02]
 [-1.29146053e-01  5.60835722e-02 -8.28024230e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.13141595]
curr_Stock_Price:  99.19052975754417
curr_Factors:  [99.19052976 -0.83268113 -0.9653613 ]
mat_Sqrt:  [[16.42821213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00340309  0.05543339  0.01876702]
Stock Position:  -0.003403085415190055
Bond Position:  [-3.7938621]


portfolio before change:  [-4.12945255]
curr_Stock_Price:  98.33484179338873
curr_Factors:  [98.33484179 -0.95392309 -0.97114245]
mat_Sqrt:  [[14.34372932  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.51206405e-04 -1.70132390e-02  3.07121738e-01]
Stock Position:  0.0002512064050034107
Bond Position:  [-4.15415489]


portfolio before change:  [-4.13038321]
curr_Stock_Price:  98.76479787743295
curr_Factors:  [98.76479788 -0.73751296 -0.95961767]
mat_Sqrt:  [[18.09454691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00425059 -0.01466011 -0.0616197 ]
Stock Position:  0.004250589170260602
Bond Position:  [-4.55019179]


portfolio before change:  [-4.12249594]
curr_Stock_Price:  100.88802421656645
curr_Factors:  [100.88802422  -0.93116567  -0.93132304]
mat_Sqrt:  [[15.66646629  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0073747  -0.07523008  2.37048512]
Stock Position:  -0.0073746954178891865
Bond Position:  [-3.37847749]


portfolio before change:  [-4.12930224]
curr_Stock_Price:  101.69640673158604
curr_Factors:  [101.69640673  -1.12154598  -0.93817722]
mat_Sqrt:  [[12.96519902  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00119133 -0.00704668  0.01517531]
Stock Position:  -0.0011913252383353064
Bond Position:  [-4.00814874]


portfolio before change:  [-4.13136228]
curr_Stock_Price:  102.58439489604186
curr_Factors:  [102.5843949   -1.46565956  -0.93102612]
mat_Sqrt:  [[ 9.3371414   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06569696  0.2647648  -0.30592981]
Stock Position:  -0.06569695602668106
Bond Position:  [2.6081202]


portfolio before change:  [-4.15801576]
curr_Stock_Price:  103.00002436687743
curr_Factors:  [103.00002437  -1.4180824   -0.9296629 ]
mat_Sqrt:  [[ 9.84519896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144443 -0.00116806  0.07340613]
Stock Position:  0.0014444339369844368
Bond Position:  [-4.30679249]


portfolio before change:  [-4.15925983]
curr_Stock_Price:  102.88424686324676
curr_Factors:  [102.88424686  -1.35320066  -0.96090344]
mat_Sqrt:  [[10.17059216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0083818  -0.01359007  0.06419342]
Stock Position:  -0.00838179599592642
Bond Position:  [-3.29690506]


portfolio before change:  [-4.1643913]
curr_Stock_Price:  103.39811509719176
curr_Factors:  [103.3981151   -1.01001807  -0.95917787]
mat_Sqrt:  [[14.43117481  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00388497  0.00410658  0.13851365]
Stock Position:  -0.0038849707647066155
Bond Position:  [-3.76269264]


portfolio before change:  [-4.15978529]
curr_Stock_Price:  101.97035790612132
curr_Factors:  [101.97035791  -0.62506686  -0.95031102]
mat_Sqrt:  [[21.10065934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01689609  0.07915629 -0.51335412]
Stock Position:  -0.01689608600007068
Bond Position:  [-2.43688536]


portfolio before change:  [-4.16207205]
curr_Stock_Price:  102.06963865243897
curr_Factors:  [102.06963865  -0.72896479  -0.96652953]
mat_Sqrt:  [[18.73064571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00244552  0.01378008 -0.15378921]
Stock Position:  0.0024455199354457423
Bond Position:  [-4.41168538]


portfolio before change:  [-4.16062253]
curr_Stock_Price:  103.1134135527605
curr_Factors:  [103.11341355  -1.15059321  -0.99808803]
mat_Sqrt:  [[12.0269293   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.001958    0.04327234  0.25789327]
Stock Position:  -0.0019580031635075676
Bond Position:  [-3.95872614]


portfolio before change:  [-4.15828312]
curr_Stock_Price:  101.4130982597801
curr_Factors:  [101.41309826  -1.08827786  -1.02095209]
mat_Sqrt:  [[12.30458934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01421683 -0.03778305 -0.03349732]
Stock Position:  -0.01421682659615946
Bond Position:  [-2.71651068]


portfolio before change:  [-4.15274577]
curr_Stock_Price:  100.97583074187251
curr_Factors:  [100.97583074  -1.21942889  -0.99393996]
mat_Sqrt:  [[11.03985978  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00663199  0.19047671 -1.06172824]
Stock Position:  0.0066319856490205135
Bond Position:  [-4.82241603]


portfolio before change:  [-4.15726474]
curr_Stock_Price:  100.47625048319959
curr_Factors:  [100.47625048  -0.99600026  -1.03086648]
mat_Sqrt:  [[13.23751226  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00563955 -0.07235332 -0.16680864]
Stock Position:  -0.005639546998772231
Bond Position:  [-3.5906242]


portfolio before change:  [-4.15459731]
curr_Stock_Price:  99.8440729321016
curr_Factors:  [99.84407293 -0.92514129 -1.01975356]
mat_Sqrt:  [[14.2779279   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00695696 0.01559977 0.40443597]
Stock Position:  0.006956955831149721
Bond Position:  [-4.84920812]


portfolio before change:  [-4.15709836]
curr_Stock_Price:  99.65884907199559
curr_Factors:  [99.65884907 -0.68165863 -0.98039517]
mat_Sqrt:  [[18.91015444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00395607  0.00593738  0.15200638]
Stock Position:  -0.003956068485839868
Bond Position:  [-3.76284113]


portfolio before change:  [-4.1673663]
curr_Stock_Price:  102.01652217395967
curr_Factors:  [102.01652217  -0.79724225  -1.00015508]
mat_Sqrt:  [[16.90716424  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00025647 -0.04131629 -0.12071115]
Stock Position:  0.0002564717042503929
Bond Position:  [-4.19353065]


portfolio before change:  [-4.16850387]
curr_Stock_Price:  101.66928152517907
curr_Factors:  [101.66928153  -0.88408318  -1.00652962]
mat_Sqrt:  [[15.349953    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00777776  0.0181009  -0.02362123]
Stock Position:  -0.007777759241498577
Bond Position:  [-3.37774468]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.16467009]
Stock Price:  101.06778136693623
PL:  [-5.23245146]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-7.45859331e-02  1.50190380e-01  1.43453311e-02]
 [ 4.49856004e-02  1.74011124e-01 -3.11439106e-01]
 [-8.28074558e-02  3.24645013e-02 -1.49487155e-02]
 [-2.69265805e-01 -2.71582200e-01  9.91454146e-01]
 [-3.54325472e-02  1.26491799e-02 -1.79053200e-02]
 [-1.14221195e+00  1.16259002e+00 -1.65243976e-01]
 [ 8.01690436e-03 -3.66897015e-03  2.75866002e-02]
 [-8.88190879e-02 -2.38062193e-02 -1.02811426e-02]
 [ 8.82014524e-02  2.71623927e-02  5.23980857e-02]
 [-1.20064367e-03  1.61700643e-01  1.42309662e-02]
 [ 5.62407165e-02  3.10977298e-02 -5.20530557e-02]
 [-6.02937136e-02  1.38849242e-01  6.87449476e-02]
 [-1.63370301e-01 -1.15513873e-01  1.78132274e-03]
 [ 3.68991681e-02  4.57779087e-01 -2.58988253e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 5.26218123e-02  2.25460475e-02  8.73485656e-02]
 [ 3.76617759e-02  2.07972555e-02  1.08164472e-01]
 [ 1.46408721e-03 -4.33824756e-02 -2.82823950e-03]
 [-1.30764350e-02  1.01206165e-01 -1.12124192e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.48470159]
curr_Stock_Price:  99.39811729317512
curr_Factors:  [99.39811729 -0.91079968 -1.00774353]
mat_Sqrt:  [[14.59370055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280945  0.04847374  0.04092324]
Stock Position:  -0.0028094465451177094
Bond Position:  [-2.20544789]


portfolio before change:  [-2.48763105]
curr_Stock_Price:  100.24455641021567
curr_Factors:  [100.24455641  -0.60921211  -1.01825031]
mat_Sqrt:  [[19.69077678  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.59957489e-04  5.61618488e-02 -8.88449083e-01]
Stock Position:  0.0008599574885682057
Bond Position:  [-2.5738371]


portfolio before change:  [-2.4873981]
curr_Stock_Price:  101.26377723496448
curr_Factors:  [101.26377723  -0.95857947  -0.96162118]
mat_Sqrt:  [[14.84299627  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00533801  0.01047787 -0.04264452]
Stock Position:  -0.0053380099004632555
Bond Position:  [-1.94685106]


portfolio before change:  [-2.48969405]
curr_Stock_Price:  101.60270065982286
curr_Factors:  [101.60270066  -0.85620686  -0.96311757]
mat_Sqrt:  [[16.47337892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00742547 -0.08765278  2.82834271]
Stock Position:  -0.00742546868591205
Bond Position:  [-1.73524638]


portfolio before change:  [-2.48551864]
curr_Stock_Price:  100.98196126538947
curr_Factors:  [100.98196127  -0.81194972  -0.98560608]
mat_Sqrt:  [[16.733055    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218164  0.00408251 -0.05107889]
Stock Position:  -0.002181637023523344
Bond Position:  [-2.26521265]


portfolio before change:  [-2.48446062]
curr_Stock_Price:  100.23738574469783
curr_Factors:  [100.23738574  -0.88180343  -0.98003317]
mat_Sqrt:  [[15.57558506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06026288  0.37522432 -0.47139507]
Stock Position:  -0.06026287560541201
Bond Position:  [3.55613249]


portfolio before change:  [-2.51581967]
curr_Stock_Price:  100.77251124088411
curr_Factors:  [100.77251124  -0.85929283  -0.98421797]
mat_Sqrt:  [[15.94834115  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0008088  -0.00118416  0.07869689]
Stock Position:  0.0008088032494033707
Bond Position:  [-2.59732481]


portfolio before change:  [-2.516867]
curr_Stock_Price:  100.28053050472803
curr_Factors:  [100.2805305   -0.78921145  -0.99064515]
mat_Sqrt:  [[16.91354811  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00566275 -0.00768342 -0.02932924]
Stock Position:  -0.005662746859640986
Bond Position:  [-1.94900374]


portfolio before change:  [-2.5138336]
curr_Stock_Price:  99.65879887462059
curr_Factors:  [99.65879887 -0.57790138 -1.00169185]
mat_Sqrt:  [[20.53558255  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00508589 0.00876662 0.14947715]
Stock Position:  0.005085887717746088
Bond Position:  [-3.02068707]


portfolio before change:  [-2.51367724]
curr_Stock_Price:  99.83804547439344
curr_Factors:  [99.83804547 -0.88111254 -0.98995261]
mat_Sqrt:  [[15.37102394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00225823 0.05218866 0.04059699]
Stock Position:  0.002258225988698676
Bond Position:  [-2.73913411]


portfolio before change:  [-2.5129312]
curr_Stock_Price:  100.4716902021896
curr_Factors:  [100.4716902   -0.92728945  -0.98365809]
mat_Sqrt:  [[14.86379604  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00349596  0.01003675 -0.14849288]
Stock Position:  0.0034959594676777514
Bond Position:  [-2.86417616]


portfolio before change:  [-2.51593166]
curr_Stock_Price:  99.818270684273
curr_Factors:  [99.81827068 -1.14942947 -0.96446809]
mat_Sqrt:  [[12.05468865  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148645  0.0448134   0.1961102 ]
Stock Position:  -0.001486452907237388
Bond Position:  [-2.3675565]


portfolio before change:  [-2.51800436]
curr_Stock_Price:  100.81442703757793
curr_Factors:  [100.81442704  -1.02768985  -0.99722481]
mat_Sqrt:  [[13.30801942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01402056 -0.03728194  0.00508162]
Stock Position:  -0.014020558162579811
Bond Position:  [-1.10452983]


portfolio before change:  [-2.4993251]
curr_Stock_Price:  99.4624531359335
curr_Factors:  [99.46245314 -1.0245829  -0.98334287]
mat_Sqrt:  [[13.35451378  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00580157  0.14774757 -0.7388214 ]
Stock Position:  0.005801572309621965
Bond Position:  [-3.07636372]


portfolio before change:  [-2.50415882]
curr_Stock_Price:  98.76186174727545
curr_Factors:  [98.76186175 -1.22706185 -0.96937209]
mat_Sqrt:  [[10.98221973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01210985 -0.09296045 -0.18429859]
Stock Position:  -0.012109854096403791
Bond Position:  [-1.30816708]


portfolio before change:  [-2.49624877]
curr_Stock_Price:  98.08166053932194
curr_Factors:  [98.08166054 -1.34649944 -0.98920774]
mat_Sqrt:  [[ 9.48862026  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00790989 0.00727671 0.24918114]
Stock Position:  0.007909891450155354
Bond Position:  [-3.27206405]


portfolio before change:  [-2.49877356]
curr_Stock_Price:  97.86589536539154
curr_Factors:  [97.86589537 -1.23441336 -0.96212949]
mat_Sqrt:  [[10.88140407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00588031 0.00671229 0.30856313]
Stock Position:  0.005880305327587276
Bond Position:  [-3.07425491]


portfolio before change:  [-2.49671171]
curr_Stock_Price:  98.34724963356989
curr_Factors:  [98.34724963 -1.12872746 -0.91937624]
mat_Sqrt:  [[12.68475508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00062821 -0.01400163 -0.00806818]
Stock Position:  -0.000628205704873998
Bond Position:  [-2.43492941]


portfolio before change:  [-2.49659705]
curr_Stock_Price:  97.1956095944567
curr_Factors:  [97.19560959 -1.11590941 -0.85331991]
mat_Sqrt:  [[13.56504444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00112827  0.03266415 -0.31985911]
Stock Position:  -0.0011282725992573072
Bond Position:  [-2.38693391]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.49745596]
Stock Price:  97.42790630855171
PL:  [-2.49745596]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-6.65090160e-02  1.40362963e-01  1.78849143e-02]
 [ 2.44426157e-02  5.81505920e-02 -9.29176416e-02]
 [ 8.39544900e-02 -4.95119648e-02 -3.27436171e-02]
 [-2.60071695e-01 -2.65377278e-01  7.60280096e-01]
 [-4.56797741e-02  2.77770027e-02 -2.80943208e-02]
 [-1.21758686e+00  1.24094173e+00 -1.77659608e-01]
 [-2.29311573e-03  1.78728519e-02 -8.43029458e-03]
 [-5.81139244e-02 -1.86461241e-02  1.31845997e-04]
 [ 7.82163668e-02  2.64175809e-02  4.65391733e-02]
 [ 5.15340977e-03  1.61876624e-01  1.94146124e-02]
 [ 9.17558484e-02  1.07999816e-02 -5.79211277e-02]
 [ 1.17822710e-01 -3.82563385e-02 -3.41840219e-02]
 [-4.83979698e-02 -5.44227127e-02  1.00209737e-01]
 [ 2.56930429e-02  4.73965600e-01 -3.03079602e-01]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 4.14001532e-02  1.58814317e-02 -2.94956839e-02]
 [-1.19254479e-02  2.35802826e-02  7.91737275e-02]
 [ 3.28966705e-02 -7.66237581e-02 -4.18027964e-02]
 [-7.19295845e-02  8.67515142e-02 -4.12820519e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.60185546]
curr_Stock_Price:  99.38334868289503
curr_Factors:  [99.38334868 -1.07751702 -1.02883748]
mat_Sqrt:  [[12.09304003  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00282864  0.04530195  0.05102068]
Stock Position:  -0.0028286355892390225
Bond Position:  [-2.32073618]


portfolio before change:  [-2.6027578]
curr_Stock_Price:  99.49721380121105
curr_Factors:  [99.4972138  -1.0389363  -1.04853294]
mat_Sqrt:  [[12.33770971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00140592  0.01876802 -0.26506817]
Stock Position:  0.0014059190742783236
Bond Position:  [-2.74264283]


portfolio before change:  [-2.60407259]
curr_Stock_Price:  99.04978640064851
curr_Factors:  [99.0497864  -0.6429946  -1.02287867]
mat_Sqrt:  [[18.72293699  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00358727 -0.01597992 -0.09340843]
Stock Position:  0.00358726516474459
Bond Position:  [-2.95939044]


portfolio before change:  [-2.60456379]
curr_Stock_Price:  99.11912551632749
curr_Factors:  [99.11912552 -0.52349444 -0.98878583]
mat_Sqrt:  [[21.84653091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00728034 -0.08565015  2.16886749]
Stock Position:  -0.007280335742292654
Bond Position:  [-1.88294328]


portfolio before change:  [-2.60825269]
curr_Stock_Price:  99.5611527586635
curr_Factors:  [99.56115276 -0.79478854 -0.9649748 ]
mat_Sqrt:  [[17.1330393   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00266996  0.00896499 -0.08014528]
Stock Position:  -0.002669960976714677
Bond Position:  [-2.3424283]


portfolio before change:  [-2.61086124]
curr_Stock_Price:  100.31879220263062
curr_Factors:  [100.3187922   -0.65000479  -0.96288813]
mat_Sqrt:  [[19.99455768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05004088  0.40051222 -0.50681341]
Stock Position:  -0.050040882146350094
Bond Position:  [2.40917961]


portfolio before change:  [-2.60281453]
curr_Stock_Price:  100.17002700049196
curr_Factors:  [100.170027    -0.7820484   -0.95685171]
mat_Sqrt:  [[17.60123207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.07747837e-05  5.76843814e-03 -2.40492839e-02]
Stock Position:  -2.077478365268418e-05
Bond Position:  [-2.60073352]


portfolio before change:  [-2.60345783]
curr_Stock_Price:  99.83497761706093
curr_Factors:  [99.83497762 -0.62637169 -0.93773036]
mat_Sqrt:  [[20.89304951  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296238 -0.00601801  0.00037612]
Stock Position:  -0.0029623792147490764
Bond Position:  [-2.30770877]


portfolio before change:  [-2.60059457]
curr_Stock_Price:  98.67366051763507
curr_Factors:  [98.67366052 -0.71074745 -0.92283435]
mat_Sqrt:  [[19.2639649   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0048333  0.00852624 0.13276331]
Stock Position:  0.004833304168687344
Bond Position:  [-3.07751439]


portfolio before change:  [-2.59467301]
curr_Stock_Price:  100.05802141696398
curr_Factors:  [100.05802142  -0.47474108  -0.91585823]
mat_Sqrt:  [[24.90705069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00169267 0.05224546 0.05538449]
Stock Position:  0.0016926664217478918
Bond Position:  [-2.76403786]


portfolio before change:  [-2.59578513]
curr_Stock_Price:  99.80928911106878
curr_Factors:  [ 9.98092891e+01 -8.46222152e-02 -9.03637181e-01]
mat_Sqrt:  [[37.15141502  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00221088  0.00348568 -0.16523286]
Stock Position:  0.0022108790382055882
Bond Position:  [-2.81645139]


portfolio before change:  [-2.60154138]
curr_Stock_Price:  97.52420176579412
curr_Factors:  [97.52420177 -0.41384096 -0.8569755 ]
mat_Sqrt:  [[27.36552764  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00376517 -0.01234718 -0.0975175 ]
Stock Position:  0.0037651707173440917
Bond Position:  [-2.96873665]


portfolio before change:  [-2.59900357]
curr_Stock_Price:  98.39536827204829
curr_Factors:  [98.39536827 -0.36102784 -0.81611768]
mat_Sqrt:  [[30.32123266  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00128793 -0.01756486  0.28587049]
Stock Position:  -0.0012879335421693257
Bond Position:  [-2.47227687]


portfolio before change:  [-2.60089307]
curr_Stock_Price:  99.38249795635835
curr_Factors:  [99.38249796 -0.68134199 -0.84054572]
mat_Sqrt:  [[21.69514085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0027921   0.15297174 -0.86460174]
Stock Position:  0.0027920999214408864
Bond Position:  [-2.87837893]


portfolio before change:  [-2.60012634]
curr_Stock_Price:  99.91486144592659
curr_Factors:  [99.91486145 -0.4685642  -0.84450637]
mat_Sqrt:  [[26.87638078  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00494833 -0.09296045 -0.18429859]
Stock Position:  -0.004948325433682218
Bond Position:  [-2.10571509]


portfolio before change:  [-2.5896906]
curr_Stock_Price:  97.69951939226918
curr_Factors:  [97.69951939 -0.47449508 -0.81959575]
mat_Sqrt:  [[26.78403014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00144195  0.00512571 -0.08414298]
Stock Position:  0.001441947139550513
Bond Position:  [-2.73056815]


portfolio before change:  [-2.59095499]
curr_Stock_Price:  97.29613180385779
curr_Factors:  [97.2961318  -0.70677205 -0.82629429]
mat_Sqrt:  [[21.00357992  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00043084 0.0076105  0.22586061]
Stock Position:  0.00043083734487443266
Bond Position:  [-2.6328738]


portfolio before change:  [-2.59056773]
curr_Stock_Price:  99.72295611376478
curr_Factors:  [99.72295611 -1.13941345 -0.81666357]
mat_Sqrt:  [[14.10203175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00061856 -0.02473021 -0.11925174]
Stock Position:  0.0006185598928142673
Bond Position:  [-2.65225235]


portfolio before change:  [-2.59129856]
curr_Stock_Price:  99.61353605054275
curr_Factors:  [99.61353605 -0.93877166 -0.81003918]
mat_Sqrt:  [[17.33083388  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361484  0.02799893 -0.1177662 ]
Stock Position:  -0.003614838723531849
Bond Position:  [-2.23121169]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.59445792]
Stock Price:  100.33320458906184
PL:  [-2.9276625]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-5.48086252e-02  9.02245322e-02  2.72974887e-02]
 [ 4.17049970e-02  1.32823244e-01 -2.75542117e-01]
 [-8.00603255e-02  1.79008016e-02 -2.50054586e-02]
 [-1.27091191e-01 -8.41984390e-02  4.95673413e-01]
 [ 5.38884913e-02 -1.19214090e-01  7.09081842e-02]
 [-1.19838336e+00  1.24730875e+00 -1.82859922e-01]
 [ 2.05232079e-03  1.15347178e-02  3.99674847e-03]
 [-2.56536306e-02  4.26647065e-02 -8.35119958e-02]
 [ 1.42799145e-01  2.28069480e-02  3.45997532e-02]
 [ 1.02986182e-01  1.36244614e-01  6.70180355e-02]
 [ 1.23668003e-01  3.23270557e-02 -5.27515670e-02]
 [-1.20755218e-01  1.07041731e-01  2.13017579e-01]
 [-1.31927008e-01 -9.67285190e-02  5.99464860e-02]
 [ 5.92677385e-02  3.38329145e-01 -8.09196143e-02]
 [-6.10123947e-02 -2.88027418e-01 -6.46044755e-02]
 [ 5.46244388e-02  3.38010348e-02  9.48994425e-02]
 [-5.38365236e-02  1.57868978e-02  7.46782895e-02]
 [ 4.96872594e-02 -1.60153834e-01 -3.07068311e-02]
 [-9.88571087e-02  1.95469915e-01 -1.28050673e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.19371156]
curr_Stock_Price:  99.68692328668092
curr_Factors:  [99.68692329 -0.98075528 -1.02598717]
mat_Sqrt:  [[13.40050057  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00229988  0.02911984  0.07787214]
Stock Position:  -0.002299879994627325
Bond Position:  [0.0355564]


portfolio before change:  [-0.19414356]
curr_Stock_Price:  99.87862446579713
curr_Factors:  [99.87862447 -0.75673319 -1.01036634]
mat_Sqrt:  [[17.06204085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 7.36877207e-04  4.28685176e-02 -7.86044963e-01]
Stock Position:  0.0007368772069012244
Bond Position:  [-0.26774184]


portfolio before change:  [-0.19321003]
curr_Stock_Price:  101.23634385963582
curr_Factors:  [101.23634386  -1.0333066   -1.00207886]
mat_Sqrt:  [[13.22451587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00616359  0.00577746 -0.07133361]
Stock Position:  -0.006163594822480907
Bond Position:  [0.43076978]


portfolio before change:  [-0.19042035]
curr_Stock_Price:  100.80121261174997
curr_Factors:  [100.80121261  -1.39515031  -1.05105437]
mat_Sqrt:  [[ 8.73157452  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00493602 -0.02717493  1.41401828]
Stock Position:  -0.004936018504623815
Bond Position:  [0.3071363]


portfolio before change:  [-0.18552548]
curr_Stock_Price:  99.82510756187243
curr_Factors:  [99.82510756 -1.25713979 -1.09587819]
mat_Sqrt:  [[ 9.49154829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00463866 -0.03847618  0.20228131]
Stock Position:  0.004638662541358894
Bond Position:  [-0.64858047]


portfolio before change:  [-0.1817895]
curr_Stock_Price:  100.66546860743208
curr_Factors:  [100.66546861  -1.04586099  -1.09310814]
mat_Sqrt:  [[11.85599556  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.08275169  0.40256717 -0.52164846]
Stock Position:  -0.08275168875438321
Bond Position:  [8.14844803]


portfolio before change:  [-0.01396676]
curr_Stock_Price:  98.66206094390226
curr_Factors:  [98.66206094 -1.07591269 -1.13169663]
mat_Sqrt:  [[10.84919803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00048139 0.00372281 0.01140161]
Stock Position:  0.00048138747653389427
Bond Position:  [-0.06146144]


portfolio before change:  [-0.01423612]
curr_Stock_Price:  98.13444665870453
curr_Factors:  [98.13444666 -1.16080864 -1.11685681]
mat_Sqrt:  [[10.06106467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337852  0.01376997 -0.23823648]
Stock Position:  -0.0033785240136989326
Bond Position:  [0.31731347]


portfolio before change:  [-0.01438283]
curr_Stock_Price:  98.20135565077088
curr_Factors:  [98.20135565 -1.31604095 -1.1391425 ]
mat_Sqrt:  [[ 8.43033547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01832872 0.00736091 0.09870347]
Stock Position:  0.018328717720824297
Bond Position:  [-1.81428776]


portfolio before change:  [-0.0026204]
curr_Stock_Price:  98.86785434699298
curr_Factors:  [98.86785435 -1.31977423 -1.15742677]
mat_Sqrt:  [[ 8.30271987  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01740116 0.04397276 0.1911838 ]
Stock Position:  0.017401164798763604
Bond Position:  [-1.72303622]


portfolio before change:  [-0.00997649]
curr_Stock_Price:  98.46987606882476
curr_Factors:  [98.46987607 -1.70474809 -1.12658324]
mat_Sqrt:  [[ 5.80325716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02059169  0.01043351 -0.15048554]
Stock Position:  0.020591689049030644
Bond Position:  [-2.03763756]


portfolio before change:  [-0.01058012]
curr_Stock_Price:  98.4653038982305
curr_Factors:  [98.4653039  -1.61300009 -1.1266961 ]
mat_Sqrt:  [[ 6.35987068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00871455  0.03454757  0.60767986]
Stock Position:  -0.008714545934570777
Bond Position:  [0.8475003]


portfolio before change:  [-0.01156919]
curr_Stock_Price:  98.60311677262584
curr_Factors:  [98.60311677 -1.35632032 -1.11828549]
mat_Sqrt:  [[ 8.3020051   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01679535 -0.031219    0.17101064]
Stock Position:  -0.016795353287856064
Bond Position:  [1.64450499]


portfolio before change:  [0.00314242]
curr_Stock_Price:  97.75166474588646
curr_Factors:  [97.75166475 -1.5759398  -1.10524293]
mat_Sqrt:  [[ 6.69424028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0167026   0.10919526 -0.23084114]
Stock Position:  0.016702603186813023
Bond Position:  [-1.62956484]


portfolio before change:  [0.01022586]
curr_Stock_Price:  98.20015049684511
curr_Factors:  [98.2001505  -1.39575567 -1.13092206]
mat_Sqrt:  [[ 7.84855954  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0169449  -0.09296045 -0.18429859]
Stock Position:  -0.016944902809034053
Bond Position:  [1.67421787]


portfolio before change:  [-0.00082648]
curr_Stock_Price:  98.87710630225173
curr_Factors:  [98.8771063  -1.2232865  -1.16364465]
mat_Sqrt:  [[ 9.08792479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00890141 0.01090924 0.27072169]
Stock Position:  0.008901406600807172
Bond Position:  [-0.88097181]


portfolio before change:  [0.00869756]
curr_Stock_Price:  99.97180015807648
curr_Factors:  [99.97180016 -1.20536077 -1.14221511]
mat_Sqrt:  [[ 9.55736696  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00370085  0.0050952   0.21303637]
Stock Position:  -0.0037008513625402433
Bond Position:  [0.37867834]


portfolio before change:  [0.00835976]
curr_Stock_Price:  100.08866152517972
curr_Factors:  [100.08866153  -1.59534742  -1.11533348]
mat_Sqrt:  [[ 6.65504697  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00161201 -0.05168943 -0.08759804]
Stock Position:  0.001612008041672301
Bond Position:  [-0.15298397]


portfolio before change:  [0.00878582]
curr_Stock_Price:  100.37669436224358
curr_Factors:  [100.37669436  -1.80221307  -1.11437869]
mat_Sqrt:  [[ 5.43216784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01133448  0.06308764 -0.03652929]
Stock Position:  -0.011334480934005471
Bond Position:  [1.14650355]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.00949128]
Stock Price:  100.33974483935542
PL:  [-0.33025356]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 2.34901268e-02 -4.10177700e-02  4.32385205e-02]
 [ 2.16249461e-02  1.43363784e-01 -1.81289630e-01]
 [-7.06509817e-02 -2.93451170e-02 -5.62058493e-02]
 [-3.22456709e-01 -3.41305868e-01  1.14317418e+00]
 [ 8.86872754e-03 -5.27521080e-02  2.61442288e-02]
 [-1.26622838e+00  1.33895290e+00 -1.98091999e-01]
 [ 1.16381042e-02 -9.52064433e-03  3.65223014e-02]
 [-7.17965211e-02 -6.92790353e-02  7.71124848e-02]
 [ 6.67745439e-02  2.60817927e-02  6.20081659e-02]
 [-6.61802999e-01  3.12118655e-01 -3.32954927e-01]
 [ 1.36379469e-01  5.93071118e-02 -5.73029901e-02]
 [-1.60732952e-01 -1.17304544e-01 -3.54161795e-02]
 [-2.67223351e-02  4.18389597e-02  8.56089407e-02]
 [ 1.18980755e-02  5.19803984e-01 -3.80752531e-01]
 [ 6.29271794e-02 -1.08401632e-01 -4.73562410e-02]
 [ 3.01150010e-02  2.39881131e-02 -1.56996298e-01]
 [-8.26753185e-02  1.62669712e-02  5.53082121e-02]
 [ 3.75592452e-02 -1.16960873e-01 -4.33551250e-02]
 [ 1.08751763e-01 -2.04097580e-01 -2.28118981e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.93489212]
curr_Stock_Price:  101.34193678434697
curr_Factors:  [101.34193678  -0.94549117  -0.97574698]
mat_Sqrt:  [[14.83904915  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00161354 -0.01323843  0.12334746]
Stock Position:  0.0016135424391138596
Bond Position:  [12.77137261]


portfolio before change:  [12.93871191]
curr_Stock_Price:  101.73024017691944
curr_Factors:  [101.73024018  -1.15590879  -0.98501905]
mat_Sqrt:  [[11.95795514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00116101  0.04627046 -0.51716885]
Stock Position:  0.001161014986862265
Bond Position:  [12.82060158]


portfolio before change:  [12.94175982]
curr_Stock_Price:  101.59446042337139
curr_Factors:  [101.59446042  -1.03151453  -1.02378176]
mat_Sqrt:  [[13.00966743  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00677296 -0.0094711  -0.16033964]
Stock Position:  -0.006772963265451396
Bond Position:  [13.62985537]


portfolio before change:  [12.94528538]
curr_Stock_Price:  101.5770865857214
curr_Factors:  [101.57708659  -0.62126665  -1.02933771]
mat_Sqrt:  [[19.49608398  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.008144   -0.110156    3.26115775]
Stock Position:  -0.008143995729565067
Bond Position:  [13.77252874]


portfolio before change:  [12.94107508]
curr_Stock_Price:  102.51690314752999
curr_Factors:  [102.51690315  -0.82375358  -1.02495127]
mat_Sqrt:  [[16.14035797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00021297 -0.01702567  0.07458221]
Stock Position:  0.0002129703042266066
Bond Position:  [12.91924202]


portfolio before change:  [12.94411114]
curr_Stock_Price:  101.60523150858965
curr_Factors:  [101.60523151  -0.72174427  -1.05259659]
mat_Sqrt:  [[17.23175958  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05996782  0.43214519 -0.56510133]
Stock Position:  -0.0599678237303934
Bond Position:  [19.03715575]


portfolio before change:  [12.96673156]
curr_Stock_Price:  101.30739619767142
curr_Factors:  [101.3073962   -0.75657054  -1.06386777]
mat_Sqrt:  [[16.40721395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00104526 -0.00307277  0.10418796]
Stock Position:  0.0010452593863840862
Bond Position:  [12.86083905]


portfolio before change:  [12.97106785]
curr_Stock_Price:  102.37955138404274
curr_Factors:  [102.37955138  -0.72321254  -1.08046448]
mat_Sqrt:  [[16.86111321  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00416328 -0.02235971  0.21998046]
Stock Position:  -0.004163279373917141
Bond Position:  [13.39730252]


portfolio before change:  [12.97749825]
curr_Stock_Price:  101.63959127628728
curr_Factors:  [101.63959128  -0.57296902  -1.09336252]
mat_Sqrt:  [[19.2036736   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00441352 0.00841786 0.17689204]
Stock Position:  0.004413521765733126
Bond Position:  [12.5289097]


portfolio before change:  [12.98750787]
curr_Stock_Price:  103.19775680819798
curr_Factors:  [103.19775681  -0.60827496  -1.10857541]
mat_Sqrt:  [[18.5375192   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03593017  0.10073586 -0.94982773]
Stock Position:  -0.035930168298399345
Bond Position:  [16.69542064]


portfolio before change:  [12.91283581]
curr_Stock_Price:  105.392192389429
curr_Factors:  [105.39219239  -0.70297721  -1.13077137]
mat_Sqrt:  [[16.84308156  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00812135  0.01914129 -0.16346948]
Stock Position:  0.0081213498867862
Bond Position:  [12.05690894]


portfolio before change:  [12.92076665]
curr_Stock_Price:  105.99753980741438
curr_Factors:  [105.99753981  -0.24924047  -1.15361024]
mat_Sqrt:  [[26.06426366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00736284 -0.03785988 -0.1010325 ]
Stock Position:  -0.007362837564405397
Bond Position:  [13.70120932]


portfolio before change:  [12.94784542]
curr_Stock_Price:  102.78505049675886
curr_Factors:  [102.7850505   -0.37914086  -1.16173511]
mat_Sqrt:  [[22.01587855  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.21196088e-05  1.35034662e-02  2.44218479e-01]
Stock Position:  -3.211960882535078e-05
Bond Position:  [12.95114683]


portfolio before change:  [12.95109249]
curr_Stock_Price:  102.50836283756063
curr_Factors:  [102.50836284  -0.16712841  -1.12959035]
mat_Sqrt:  [[28.02860592  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00143717  0.16776601 -1.08618099]
Stock Position:  0.0014371686700704748
Bond Position:  [12.80377069]


portfolio before change:  [12.95557032]
curr_Stock_Price:  103.39655491573494
curr_Factors:  [103.39655492   0.16924799  -1.16897303]
mat_Sqrt:  [[38.04792688  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00081826 -0.03498648 -0.13509417]
Stock Position:  0.0008182636805752967
Bond Position:  [12.87096467]


portfolio before change:  [12.95450599]
curr_Stock_Price:  98.16294770794173
curr_Factors:  [98.16294771  0.47558869 -1.1805655 ]
mat_Sqrt:  [[48.50427906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.11248948e-05  7.74213022e-03 -4.47866738e-01]
Stock Position:  6.112489484923079e-05
Bond Position:  [12.94850579]


portfolio before change:  [12.95802999]
curr_Stock_Price:  102.84946178955899
curr_Factors:  [102.84946179   0.51708324  -1.2096499 ]
mat_Sqrt:  [[51.45459226  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132282  0.00525014  0.15777893]
Stock Position:  -0.0013228186722285798
Bond Position:  [13.09408117]


portfolio before change:  [12.96150053]
curr_Stock_Price:  102.70082662210942
curr_Factors:  [102.70082662   0.68929739  -1.23659955]
mat_Sqrt:  [[59.41329374  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 8.13770593e-05 -3.77489595e-02 -1.23680104e-01]
Stock Position:  8.137705930683762e-05
Bond Position:  [12.95314304]


portfolio before change:  [12.96458995]
curr_Stock_Price:  100.86648284203787
curr_Factors:  [100.86648284   0.60798578  -1.2490914 ]
mat_Sqrt:  [[53.12736072  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.86353226e-04 -6.58722108e-02 -6.50759957e-01]
Stock Position:  0.00038635322608022326
Bond Position:  [12.92561986]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.96590598]
Stock Price:  95.90786114369102
PL:  [12.96590598]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-5.51579784e-02  9.19480308e-02  2.69894178e-02]
 [ 3.14866412e-02  1.66560542e-01 -2.22919615e-01]
 [-8.11862161e-02  2.38696239e-02 -2.08837784e-02]
 [-1.95249882e-01 -1.75624134e-01  7.02660311e-01]
 [-5.86804695e-04 -3.87930518e-02  1.67424242e-02]
 [-9.93189601e-01  1.07320592e+00 -1.53594497e-01]
 [ 1.01726448e-02 -5.04220622e-03  2.83339395e-02]
 [-5.65219467e-02 -1.06547208e-01  1.51135876e-01]
 [ 6.61784538e-02  2.60362371e-02  6.19702776e-02]
 [-7.96294288e-01  3.40957408e-01 -4.05666308e-01]
 [ 7.41583229e-02  4.77597067e-02 -5.49378266e-02]
 [-2.10615415e-02  1.05337579e-01  1.00163383e-02]
 [ 6.06413305e-02 -5.95646973e-02 -6.35096355e-02]
 [ 2.56726482e-02  7.00140626e-01 -4.38363915e-01]
 [ 1.27093816e-01 -6.08316717e-02 -2.36458896e-02]
 [ 3.06473724e-02 -1.16426584e-02 -1.93202575e-02]
 [-8.40717334e-02  1.62908864e-02  5.85749141e-02]
 [ 5.06062639e-02 -1.82425362e-01 -3.36322899e-02]
 [-1.54500407e-01  3.68011851e-02 -2.30373883e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.09228209]
curr_Stock_Price:  99.57364799896044
curr_Factors:  [99.573648   -1.11723408 -1.00913992]
mat_Sqrt:  [[11.87604741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260019  0.0296761   0.0769933 ]
Stock Position:  -0.002600189469414854
Bond Position:  [-0.83337174]


portfolio before change:  [-1.09687877]
curr_Stock_Price:  101.261336261759
curr_Factors:  [101.26133626  -1.05623173  -1.03708494]
mat_Sqrt:  [[12.48325308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00160074  0.05375718 -0.63592761]
Stock Position:  0.0016007360717450565
Bond Position:  [-1.25897144]


portfolio before change:  [-1.09768092]
curr_Stock_Price:  100.95686944043783
curr_Factors:  [100.95686944  -1.1615447   -1.05931978]
mat_Sqrt:  [[10.95536077  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.007355    0.00770389 -0.05957561]
Stock Position:  -0.007355004971400499
Bond Position:  [-0.35514264]


portfolio before change:  [-1.09707375]
curr_Stock_Price:  100.86224456784703
curr_Factors:  [100.86224457  -1.10858983  -0.99897901]
mat_Sqrt:  [[12.25809872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00715193 -0.05668245  2.00449428]
Stock Position:  -0.007151930727862748
Bond Position:  [-0.37571397]


portfolio before change:  [-1.10616691]
curr_Stock_Price:  102.12053614205838
curr_Factors:  [102.12053614  -1.28740922  -0.98597617]
mat_Sqrt:  [[10.51463876  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048388 -0.0125204   0.04776148]
Stock Position:  -0.0004838844500701295
Bond Position:  [-1.05675237]


portfolio before change:  [-1.10664209]
curr_Stock_Price:  102.55651535399106
curr_Factors:  [102.55651535  -1.09043849  -0.9644513 ]
mat_Sqrt:  [[13.13820269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06130783  0.34637572 -0.43816235]
Stock Position:  -0.06130783062493972
Bond Position:  [5.18087538]


portfolio before change:  [-1.07588274]
curr_Stock_Price:  102.07592465707351
curr_Factors:  [102.07592466  -1.16572806  -0.9692496 ]
mat_Sqrt:  [[12.07019558  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00123669 -0.00162737  0.08082884]
Stock Position:  0.0012366866689814218
Bond Position:  [-1.20211867]


portfolio before change:  [-1.07454986]
curr_Stock_Price:  103.39674912575748
curr_Factors:  [103.39674913  -0.87839218  -0.97502761]
mat_Sqrt:  [[16.20230847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00292676 -0.03438796  0.43114859]
Stock Position:  -0.002926763365277368
Bond Position:  [-0.77193204]


portfolio before change:  [-1.06864601]
curr_Stock_Price:  101.31360840123706
curr_Factors:  [101.3136084   -0.79270105  -0.97564332]
mat_Sqrt:  [[17.28564456  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00486778 0.00840316 0.17678395]
Stock Position:  0.00486777962710034
Bond Position:  [-1.56181832]


portfolio before change:  [-1.05520637]
curr_Stock_Price:  104.15476781605695
curr_Factors:  [104.15476782  -0.94521508  -1.00301398]
mat_Sqrt:  [[14.84478875  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05453112  0.11004353 -1.15725306]
Stock Position:  -0.05453111864885325
Bond Position:  [4.62446963]


portfolio before change:  [-0.99494922]
curr_Stock_Price:  103.07096673205727
curr_Factors:  [103.07096673  -0.7179641   -1.00991606]
mat_Sqrt:  [[18.31165232  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00396977  0.01541438 -0.15672233]
Stock Position:  0.003969772582100642
Bond Position:  [-1.40411752]


portfolio before change:  [-0.99004274]
curr_Stock_Price:  104.39536343282579
curr_Factors:  [104.39536343  -0.72822294  -1.03320295]
mat_Sqrt:  [[17.93509441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00013855 0.03399756 0.02857383]
Stock Position:  0.00013855395430382948
Bond Position:  [-1.00450713]


portfolio before change:  [-0.9903985]
curr_Stock_Price:  103.64040455421804
curr_Factors:  [103.64040455  -0.79844379  -1.04898092]
mat_Sqrt:  [[16.33814482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00217399 -0.01922442 -0.18117531]
Stock Position:  0.0021739853499136365
Bond Position:  [-1.21571122]


portfolio before change:  [-0.99082906]
curr_Stock_Price:  103.58217511212915
curr_Factors:  [103.58217511  -0.88030004  -1.10944079]
mat_Sqrt:  [[14.16287968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00558556  0.22596942 -1.25053023]
Stock Position:  0.005585558679363143
Bond Position:  [-1.56939338]


portfolio before change:  [-0.98857565]
curr_Stock_Price:  104.05586228366873
curr_Factors:  [104.05586228  -0.9337373   -1.13211959]
mat_Sqrt:  [[13.18488378  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0083315  -0.01963334 -0.06745514]
Stock Position:  0.008331503512922151
Bond Position:  [-1.85551743]


portfolio before change:  [-0.9915974]
curr_Stock_Price:  103.74885713752604
curr_Factors:  [103.74885714  -0.93709288  -1.13452255]
mat_Sqrt:  [[13.07049906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00186122 -0.00375765 -0.05511532]
Stock Position:  0.001861221484160839
Bond Position:  [-1.184697]


portfolio before change:  [-0.99238163]
curr_Stock_Price:  103.48665318749674
curr_Factors:  [103.48665319  -1.29416415  -1.11355583]
mat_Sqrt:  [[ 9.31590041  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00738413  0.00525786  0.16709793]
Stock Position:  -0.007384129597034988
Bond Position:  [-0.22822277]


portfolio before change:  [-0.99591235]
curr_Stock_Price:  103.95707441353656
curr_Factors:  [103.95707441  -1.0881554   -1.14011201]
mat_Sqrt:  [[11.19772527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0005808  -0.05887753 -0.09594356]
Stock Position:  0.0005808037114659028
Bond Position:  [-1.056291]


portfolio before change:  [-0.99553705]
curr_Stock_Price:  105.05796309486774
curr_Factors:  [105.05796309  -1.43700373  -1.13354818]
mat_Sqrt:  [[ 8.03623195  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01887587  0.01187753 -0.06571926]
Stock Position:  -0.01887587173611127
Bond Position:  [0.98752358]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.00822261]
Stock Price:  105.74309551511486
PL:  [-6.75131813]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.30207154e-01  2.17866324e-01 -1.00298033e-02]
 [ 2.01337499e-02  4.31218060e-02 -5.59764884e-02]
 [ 1.06023574e-01 -5.15789808e-02  8.08702793e-02]
 [-8.24734489e-02 -5.57611693e-02  2.42242495e-01]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-8.49694060e-01  7.12959439e-01 -6.08845147e-02]
 [-3.34717513e-02  2.50745135e-02 -6.98777026e-02]
 [ 1.26098157e-01 -1.54009588e-01  4.22467426e-02]
 [ 7.43828668e-02  2.30720397e-02  3.44770859e-02]
 [ 1.50831001e-01  1.22077473e-01  8.31047292e-02]
 [-3.60265192e-02  1.13461607e-02 -4.06742387e-02]
 [-4.83021879e-02  1.45157729e-01  4.01308902e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-4.48264970e-02 -4.88016473e-02  3.14434845e-03]
 [ 4.54557009e-02  2.57953294e-01 -4.45524397e-03]
 [ 5.96941723e-02  6.15948941e-02 -1.17287531e-02]
 [ 2.04126029e-01 -1.09643674e-01  1.81202716e-01]
 [-1.46043922e-01  1.24042151e-01  1.65931589e-01]
 [ 2.00173110e-01 -8.32482754e-02 -3.88051879e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.34218997]
curr_Stock_Price:  98.28152765531335
curr_Factors:  [98.28152766 -1.1803898  -0.97181812]
mat_Sqrt:  [[11.42299213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00768474  0.07031605 -0.02861224]
Stock Position:  -0.007684738018781755
Bond Position:  [-10.58692218]


portfolio before change:  [-11.35353505]
curr_Stock_Price:  99.41338383656466
curr_Factors:  [99.41338384 -1.12761281 -0.96243838]
mat_Sqrt:  [[12.29552727  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00142408  0.0139175  -0.15968534]
Stock Position:  0.0014240787320051144
Bond Position:  [-11.49510754]


portfolio before change:  [-11.35830268]
curr_Stock_Price:  98.08376132847883
curr_Factors:  [98.08376133 -1.4732756  -0.98684123]
mat_Sqrt:  [[ 8.37880245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01336738 -0.01664704  0.2307004 ]
Stock Position:  0.013367379891353476
Bond Position:  [-12.66942558]


portfolio before change:  [-11.36351585]
curr_Stock_Price:  97.93074576082446
curr_Factors:  [97.93074576 -0.91855621 -0.96339603]
mat_Sqrt:  [[14.91411848  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297759 -0.01799684  0.69105041]
Stock Position:  -0.0029775885058953245
Bond Position:  [-11.07191838]


portfolio before change:  [-11.36489809]
curr_Stock_Price:  97.46524136944798
curr_Factors:  [97.46524137 -0.90009808 -0.91921438]
mat_Sqrt:  [[15.80274016  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00359415 -0.04522423  0.24245377]
Stock Position:  0.0035941476941025634
Bond Position:  [-11.71520256]


portfolio before change:  [-11.37295204]
curr_Stock_Price:  96.03937344070636
curr_Factors:  [96.03937344 -1.28010265 -0.92422824]
mat_Sqrt:  [[10.59547845  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06763166  0.23010667 -0.17368657]
Stock Position:  -0.06763166254319919
Bond Position:  [-4.87764954]


portfolio before change:  [-11.37247217]
curr_Stock_Price:  96.01424572128117
curr_Factors:  [96.01424572 -1.14421799 -0.92610779]
mat_Sqrt:  [[12.1116863   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00351868  0.00809276 -0.19934164]
Stock Position:  -0.0035186812855488394
Bond Position:  [-11.03462864]


portfolio before change:  [-11.36955165]
curr_Stock_Price:  94.40013935938182
curr_Factors:  [94.40013936 -1.13464941 -0.90753492]
mat_Sqrt:  [[12.24794568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00843282 -0.04970638  0.1205182 ]
Stock Position:  0.00843281514261213
Bond Position:  [-12.16561058]


portfolio before change:  [-11.37965938]
curr_Stock_Price:  93.56222856195372
curr_Factors:  [93.56222856 -1.19895458 -0.85766908]
mat_Sqrt:  [[11.96520792  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00719837 0.00744647 0.09835353]
Stock Position:  0.007198373271617775
Bond Position:  [-12.05315523]


portfolio before change:  [-11.37918046]
curr_Stock_Price:  94.04741895136513
curr_Factors:  [94.04741895 -1.11629099 -0.84173927]
mat_Sqrt:  [[13.27349049  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01451869 0.03940033 0.23707466]
Stock Position:  0.014518686177552177
Bond Position:  [-12.74462543]


portfolio before change:  [-11.37525642]
curr_Stock_Price:  94.53717362265601
curr_Factors:  [94.53717362 -0.98056464 -0.83788415]
mat_Sqrt:  [[15.34123568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273857  0.00366196 -0.11603228]
Stock Position:  -0.0027385726269909473
Bond Position:  [-11.11635951]


portfolio before change:  [-11.3801508]
curr_Stock_Price:  95.30945047000705
curr_Factors:  [95.30945047 -1.14975265 -0.82546598]
mat_Sqrt:  [[13.2223733   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079262  0.04684946  0.11448226]
Stock Position:  -0.0007926191941389782
Bond Position:  [-11.3046067]


portfolio before change:  [-11.38204735]
curr_Stock_Price:  94.13618637552625
curr_Factors:  [94.13618638 -1.10061994 -0.84124204]
mat_Sqrt:  [[13.50257681  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00124873 -0.00995959  0.34984664]
Stock Position:  0.0012487337527446543
Bond Position:  [-11.49959838]


portfolio before change:  [-11.38565931]
curr_Stock_Price:  93.54622548096151
curr_Factors:  [93.54622548 -0.97038051 -0.86851436]
mat_Sqrt:  [[14.87319856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364053 -0.01575066  0.00896995]
Stock Position:  -0.0036405251961281818
Bond Position:  [-11.04510192]


portfolio before change:  [-11.38532171]
curr_Stock_Price:  92.6949136512199
curr_Factors:  [92.69491365 -0.8688341  -0.84840606]
mat_Sqrt:  [[16.64439354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00583985  0.08325407 -0.01270957]
Stock Position:  0.005839850726960004
Bond Position:  [-11.92664617]


portfolio before change:  [-11.38480437]
curr_Stock_Price:  93.29413699265817
curr_Factors:  [93.29413699 -1.16738941 -0.85621444]
mat_Sqrt:  [[12.33145628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00566625  0.01987967 -0.03345887]
Stock Position:  0.005666245259134765
Bond Position:  [-11.91343183]


portfolio before change:  [-11.39031591]
curr_Stock_Price:  92.84713716553392
curr_Factors:  [92.84713717 -0.9290228  -0.83787056]
mat_Sqrt:  [[15.86413807  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01378789 -0.03538734  0.51692091]
Stock Position:  0.013787887885856167
Bond Position:  [-12.67048183]


portfolio before change:  [-11.40083272]
curr_Stock_Price:  92.31414857588932
curr_Factors:  [92.31414858 -0.97684512 -0.83403575]
mat_Sqrt:  [[15.09429028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00575405  0.04003443  0.47335664]
Stock Position:  -0.005754048590087758
Bond Position:  [-10.86965262]


portfolio before change:  [-11.39839236]
curr_Stock_Price:  91.4177169169139
curr_Factors:  [91.41771692 -0.84200931 -0.84637522]
mat_Sqrt:  [[16.89562596  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00615363 -0.02686827 -1.107004  ]
Stock Position:  0.0061536263080655155
Bond Position:  [-11.96094283]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.38991436]
Stock Price:  93.28143254261289
PL:  [-11.38991436]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-5.81626021e-02  1.25756342e-01  1.85190704e-02]
 [ 1.87725997e-02  3.88669890e-02 -8.32198299e-02]
 [ 9.78628326e-02 -3.55850155e-02 -1.69083163e-02]
 [-1.20695048e-02 -9.17914626e-03  8.15429585e-02]
 [ 5.98245690e-02 -1.27977430e-01  7.68105323e-02]
 [-1.55274529e+00  1.47785630e+00 -2.12207414e-01]
 [-3.72448196e-01 -3.69697986e-01 -1.85501932e-01]
 [ 2.09164222e-01 -2.89603177e-01  9.46902631e-02]
 [-1.03971191e-01  3.01012359e-02  5.96862242e-02]
 [ 1.35125886e-01  2.06195900e-01  1.35693987e-01]
 [-4.18839618e-01 -3.86773406e-01  1.18350249e-01]
 [ 8.14579784e-02 -4.14684554e-02 -4.14302279e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-6.36796735e-02 -5.07206101e-02 -1.44448108e-02]
 [ 5.46784675e-02  2.59120467e-01  2.36733484e-02]
 [ 6.66446827e-02  1.07794567e-01 -1.17914772e-01]
 [ 2.27013802e-01 -1.38455272e-01  1.88987958e-01]
 [-1.57907794e-01  1.27867288e-01  1.89042642e-01]
 [ 2.60149755e-01 -3.02253475e-01 -5.27448177e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.76925021]
curr_Stock_Price:  99.8083158402316
curr_Factors:  [99.80831584 -0.65520475 -1.00784266]
mat_Sqrt:  [[18.91970728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0015176   0.04058768  0.05282975]
Stock Position:  -0.0015175978347081816
Bond Position:  [0.9207191]


portfolio before change:  [0.77053449]
curr_Stock_Price:  99.11374837247493
curr_Factors:  [99.11374837 -0.85104613 -1.07129282]
mat_Sqrt:  [[14.49681847  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00067043  0.01254427 -0.23740301]
Stock Position:  0.000670430826807614
Bond Position:  [0.70408558]


portfolio before change:  [0.77031339]
curr_Stock_Price:  98.52136591860531
curr_Factors:  [98.52136592 -0.61209937 -1.08245013]
mat_Sqrt:  [[18.09659756  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00481569 -0.01148501 -0.04823472]
Stock Position:  0.004815693992421574
Bond Position:  [0.29586464]


portfolio before change:  [0.76749631]
curr_Stock_Price:  97.92102635361142
curr_Factors:  [97.92102635 -1.15782921 -1.05045301]
mat_Sqrt:  [[10.76046826  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00025108 -0.00296256  0.23261936]
Stock Position:  0.00025107610997518985
Bond Position:  [0.74291068]


portfolio before change:  [0.76763108]
curr_Stock_Price:  97.71797620425569
curr_Factors:  [97.7179762  -0.85343102 -1.05452967]
mat_Sqrt:  [[14.49965478  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00340561 -0.04130454  0.21911907]
Stock Position:  0.003405610026064143
Bond Position:  [0.43484176]


portfolio before change:  [0.76169939]
curr_Stock_Price:  95.94431181619173
curr_Factors:  [95.94431182 -0.33856685 -1.05489532]
mat_Sqrt:  [[23.81476505  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05435266  0.47697607 -0.60536868]
Stock Position:  -0.05435265834221427
Bond Position:  [5.97652779]


portfolio before change:  [0.91082242]
curr_Stock_Price:  93.2281851224225
curr_Factors:  [93.22818512 -0.1929041  -1.02911126]
mat_Sqrt:  [[27.46835832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.017685   -0.11931951 -0.52918538]
Stock Position:  -0.017684999557216967
Bond Position:  [2.55956283]


portfolio before change:  [0.93663476]
curr_Stock_Price:  91.8048112845284
curr_Factors:  [91.80481128 -0.14715098 -1.0061291 ]
mat_Sqrt:  [[28.97358691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00584594 -0.09346902  0.27012496]
Stock Position:  0.005845937910622706
Bond Position:  [0.39994953]


portfolio before change:  [0.92420806]
curr_Stock_Price:  89.66200794576245
curr_Factors:  [ 8.96620079e+01  8.11727749e-02 -9.72254703e-01]
mat_Sqrt:  [[36.78040408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00232851  0.00971513  0.17026818]
Stock Position:  -0.0023285062901771247
Bond Position:  [1.13298661]


portfolio before change:  [0.92994879]
curr_Stock_Price:  87.31825357299458
curr_Factors:  [87.31825357  0.17992933 -0.96588759]
mat_Sqrt:  [[39.78942887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00514996 0.06654944 0.38709717]
Stock Position:  0.0051499574742701485
Bond Position:  [0.4802635]


portfolio before change:  [0.93475759]
curr_Stock_Price:  88.2286920241865
curr_Factors:  [ 8.82286920e+01 -5.01579448e-02 -9.55028346e-01]
mat_Sqrt:  [[32.28962354  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01466822 -0.12483058  0.33762032]
Stock Position:  -0.014668218864108185
Bond Position:  [2.22891535]


portfolio before change:  [0.89937007]
curr_Stock_Price:  90.67921583439077
curr_Factors:  [ 9.06792158e+01 -8.27480565e-02 -9.30950920e-01]
mat_Sqrt:  [[32.9051507   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00196128 -0.01338389 -0.11818891]
Stock Position:  0.0019612843014760913
Bond Position:  [0.72152235]


portfolio before change:  [0.90168023]
curr_Stock_Price:  91.7651168759647
curr_Factors:  [ 9.17651169e+01  2.39911108e-02 -9.42333070e-01]
mat_Sqrt:  [[36.63083147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0004603  -0.00995959  0.34984664]
Stock Position:  0.0004602986810208201
Bond Position:  [0.85944087]


portfolio before change:  [0.90207619]
curr_Stock_Price:  92.15850238014175
curr_Factors:  [92.15850238 -0.3321619  -0.9612648 ]
mat_Sqrt:  [[25.28176144  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304494 -0.01637001 -0.04120702]
Stock Position:  -0.003044942477094301
Bond Position:  [1.18269353]


portfolio before change:  [0.90451582]
curr_Stock_Price:  91.45441010930375
curr_Factors:  [91.45441011 -0.69238201 -0.96853481]
mat_Sqrt:  [[17.37311305  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00646997 0.08363077 0.06753347]
Stock Position:  0.006469969606701228
Bond Position:  [0.31280857]


portfolio before change:  [0.90059481]
curr_Stock_Price:  90.83628913008333
curr_Factors:  [90.83628913 -0.59384686 -1.00066421]
mat_Sqrt:  [[18.44047171  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00350202  0.03479055 -0.33637802]
Stock Position:  0.0035020202014879997
Bond Position:  [0.58248429]


portfolio before change:  [0.90324253]
curr_Stock_Price:  91.55075503090636
curr_Factors:  [91.55075503 -0.82136496 -0.99916408]
mat_Sqrt:  [[14.8257344   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01600789 -0.04468625  0.53913004]
Stock Position:  0.016007891216201244
Bond Position:  [-0.562292]


portfolio before change:  [0.90695776]
curr_Stock_Price:  91.79162518855593
curr_Factors:  [91.79162519 -0.52369144 -0.99964645]
mat_Sqrt:  [[20.00902002  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00465884  0.04126899  0.53928604]
Stock Position:  -0.004658840139284851
Bond Position:  [1.33460027]


portfolio before change:  [0.91355664]
curr_Stock_Price:  90.4468301127348
curr_Factors:  [90.44683011 -0.18370533 -1.00959509]
mat_Sqrt:  [[27.42518473  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00331037 -0.09755189 -1.50466283]
Stock Position:  0.0033103738402905365
Bond Position:  [0.61414382]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.90918141]
Stock Price:  89.07877289067252
PL:  [0.90918141]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-1.04573505e-01  1.86677124e-01  1.20374459e-03]
 [-2.87447615e-02 -1.26608450e-01  3.03690209e-01]
 [ 1.06091157e-01 -4.34527040e-02  4.68226192e-02]
 [ 3.46488802e-02  4.07301206e-02 -7.13786342e-02]
 [-6.92178761e-02  6.25259394e-02 -5.14986761e-02]
 [-1.47563289e+00  1.34323297e+00 -1.83867812e-01]
 [-3.68065537e-02  2.33331269e-02 -7.71927851e-02]
 [-6.67757585e-02 -8.75430363e-02  1.14324896e-01]
 [ 5.87021009e-02  8.01338243e-03  3.34128031e-02]
 [-4.56851940e-01  2.65093001e-01 -2.25648527e-01]
 [ 6.63169186e-02  5.85833147e-02 -5.73172353e-02]
 [-1.14150782e-02 -8.33433360e-03 -1.31849719e-02]
 [ 2.41147889e-01  1.86095331e-01 -7.21301517e-02]
 [ 2.34938997e-02  1.05421124e+00 -6.31689281e-01]
 [ 1.61240835e-01 -9.19053971e-02  8.69939277e-03]
 [ 1.45927402e-02 -3.59325417e-02 -1.32390811e-01]
 [-8.48739659e-02  1.60187621e-02  5.60799127e-02]
 [ 4.60725168e-02 -2.40860228e-01 -3.01485717e-02]
 [-1.74146159e-01  2.18602799e-02 -3.44719227e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.99660361]
curr_Stock_Price:  99.08146276949407
curr_Factors:  [99.08146277 -0.73663517 -0.93654697]
mat_Sqrt:  [[18.59253643  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00356178  0.06024978  0.00343395]
Stock Position:  -0.003561777775584765
Bond Position:  [-4.64369746]


portfolio before change:  [-4.99392341]
curr_Stock_Price:  98.00299217778083
curr_Factors:  [98.00299218 -1.27245666 -0.92859432]
mat_Sqrt:  [[10.84763438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.82351650e-04 -4.08627014e-02  8.66343634e-01]
Stock Position:  0.0006823516499399886
Bond Position:  [-5.06079591]


portfolio before change:  [-4.99511222]
curr_Stock_Price:  98.11516968955173
curr_Factors:  [98.11516969 -1.19204126 -0.94604675]
mat_Sqrt:  [[11.56581752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00923229 -0.0140243   0.1335719 ]
Stock Position:  0.009232294910958548
Bond Position:  [-5.9009404]


portfolio before change:  [-5.00885312]
curr_Stock_Price:  96.78662895275791
curr_Factors:  [96.78662895 -0.83379942 -0.90532574]
mat_Sqrt:  [[17.00289619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00166988  0.01314559 -0.20362338]
Stock Position:  0.0016698789589705662
Bond Position:  [-5.17047507]


portfolio before change:  [-5.00753034]
curr_Stock_Price:  98.35294642003439
curr_Factors:  [98.35294642 -0.48505452 -0.93024191]
mat_Sqrt:  [[23.88536853  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280368  0.02018016 -0.14691139]
Stock Position:  -0.0028036806451365824
Bond Position:  [-4.73178009]


portfolio before change:  [-4.99859045]
curr_Stock_Price:  94.74234377640587
curr_Factors:  [94.74234378 -0.12086711 -0.89114117]
mat_Sqrt:  [[34.4377294   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03597736  0.43352658 -0.52452369]
Stock Position:  -0.03597735643061297
Bond Position:  [-1.59001138]


portfolio before change:  [-5.11328031]
curr_Stock_Price:  97.91912802428548
curr_Factors:  [97.91912802 -0.14045101 -0.91294504]
mat_Sqrt:  [[34.14942874  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00139975  0.00753073 -0.22020953]
Stock Position:  -0.001399748461962347
Bond Position:  [-4.97621816]


portfolio before change:  [-5.11940146]
curr_Stock_Price:  101.40328328716598
curr_Factors:  [101.40328329  -0.24031565  -0.95015211]
mat_Sqrt:  [[30.8346084   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198832 -0.02825439  0.32613711]
Stock Position:  -0.0019883156442625977
Bond Position:  [-4.91777972]


portfolio before change:  [-5.12480162]
curr_Stock_Price:  103.5008201192244
curr_Factors:  [103.50082012  -0.33633743  -0.94838649]
mat_Sqrt:  [[28.64146849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00234479 0.00258631 0.09531743]
Stock Position:  0.0023447884874936904
Bond Position:  [-5.36748915]


portfolio before change:  [-5.12850412]
curr_Stock_Price:  102.49413771410066
curr_Factors:  [102.49413771  -0.56591519  -0.93518608]
mat_Sqrt:  [[22.84436172  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.019646    0.0855584  -0.64371244]
Stock Position:  -0.019646001766043183
Bond Position:  [-3.11490411]


portfolio before change:  [-5.15893977]
curr_Stock_Price:  104.00369825270373
curr_Factors:  [104.00369825  -0.38334497  -0.91803865]
mat_Sqrt:  [[28.30512366  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00235206  0.01890768 -0.16351012]
Stock Position:  0.0023520602424890753
Bond Position:  [-5.40356273]


portfolio before change:  [-5.15784401]
curr_Stock_Price:  105.04398518363631
curr_Factors:  [105.04398518  -0.61032582  -0.90355257]
mat_Sqrt:  [[23.11543957  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00068386 -0.00268989 -0.03761305]
Stock Position:  -0.0006838584244774075
Bond Position:  [-5.0860088]


portfolio before change:  [-5.15987404]
curr_Stock_Price:  106.15293497340474
curr_Factors:  [106.15293497  -0.41505419  -0.92578874]
mat_Sqrt:  [[27.77226614  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00952068  0.06006201 -0.20576725]
Stock Position:  0.009520682697630763
Bond Position:  [-6.17052245]


portfolio before change:  [-5.15683868]
curr_Stock_Price:  106.63380180617037
curr_Factors:  [106.63380181  -0.96871841  -0.92555859]
mat_Sqrt:  [[16.04060871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00684144  0.34024522 -1.80203369]
Stock Position:  0.00684143827596797
Bond Position:  [-5.88636726]


portfolio before change:  [-5.1556599]
curr_Stock_Price:  107.02122811767298
curr_Factors:  [107.02122812  -0.91423686  -0.96953499]
mat_Sqrt:  [[16.2689008   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00886701 -0.02966234  0.02481695]
Stock Position:  0.008867008444635937
Bond Position:  [-6.10461804]


portfolio before change:  [-5.16133451]
curr_Stock_Price:  106.55339715135882
curr_Factors:  [106.55339715  -1.33244318  -0.97259995]
mat_Sqrt:  [[10.62918067  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185961 -0.01159718 -0.37767413]
Stock Position:  -0.0018596090248375271
Bond Position:  [-4.96318685]


portfolio before change:  [-5.1640729]
curr_Stock_Price:  107.35864037947941
curr_Factors:  [107.35864038  -1.33872575  -0.95032991]
mat_Sqrt:  [[10.88210116  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.006447    0.00517003  0.15998038]
Stock Position:  -0.006446998104195263
Bond Position:  [-4.47193195]


portfolio before change:  [-5.16719531]
curr_Stock_Price:  107.66952687334171
curr_Factors:  [107.66952687  -1.53519016  -0.95915832]
mat_Sqrt:  [[ 8.88814287  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00104037 -0.0777373  -0.08600548]
Stock Position:  -0.0010403661322551233
Bond Position:  [-5.05517958]


portfolio before change:  [-5.16658947]
curr_Stock_Price:  105.8722813631886
curr_Factors:  [105.87228136  -1.11743912  -0.99329137]
mat_Sqrt:  [[12.82636703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01377791  0.00705538 -0.0983388 ]
Stock Position:  -0.013777907615858925
Bond Position:  [-3.70789096]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.16127929]
Stock Price:  105.41958049228845
PL:  [-10.58085978]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-6.79555238e-02  1.42122970e-01  1.72510048e-02]
 [ 2.97510648e-02  7.66282549e-02 -1.35463284e-01]
 [-8.41733066e-02  4.22447380e-02 -1.04858325e-02]
 [-2.88218560e-01 -3.02243354e-01  9.19117319e-01]
 [-6.50213906e-03 -3.00603350e-02  1.08607016e-02]
 [-1.05487742e+00  1.09615002e+00 -1.55370297e-01]
 [ 1.17394972e-02 -9.83050104e-03  3.70888425e-02]
 [-7.37621346e-02 -6.26512366e-03 -2.85557749e-02]
 [ 3.85324516e-02  2.39234184e-02  6.02130591e-02]
 [-4.45038716e-01  2.60274589e-01 -2.21858972e-01]
 [ 6.20408497e-02  3.18882654e-02 -5.22262926e-02]
 [-4.39867325e-02  1.47427998e-01  2.98333943e-02]
 [-1.66188531e-01 -1.14081303e-01  4.34315069e-02]
 [ 3.75509891e-02  4.79582084e-01 -2.84583193e-01]
 [ 3.65493413e-02 -1.46631067e-01 -5.10271519e-02]
 [ 5.92060921e-02  2.02674521e-02  2.00502545e-01]
 [-6.51476181e-02  1.56937320e-02  6.93030069e-02]
 [ 4.09900365e-02 -1.31857271e-01 -4.00524590e-02]
 [-1.38319327e-01  4.91071518e-02 -1.36194181e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.97285094]
curr_Stock_Price:  99.46264203286337
curr_Factors:  [99.46264203 -0.97662324 -0.98018996]
mat_Sqrt:  [[14.05486939  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252037  0.04586999  0.04921232]
Stock Position:  -0.0025203683070434755
Bond Position:  [-1.72216845]


portfolio before change:  [-1.97370276]
curr_Stock_Price:  99.62977088827728
curr_Factors:  [99.62977089 -1.03163744 -0.99815505]
mat_Sqrt:  [[13.08764341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00135559  0.02473166 -0.38643904]
Stock Position:  0.0013555851219208513
Bond Position:  [-2.1087594]


portfolio before change:  [-1.97366011]
curr_Stock_Price:  100.05018580334375
curr_Factors:  [100.0501858   -0.77283068  -0.9820254 ]
mat_Sqrt:  [[17.30189162  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00449029  0.01363443 -0.02991316]
Stock Position:  -0.004490292092722689
Bond Position:  [-1.52440555]


portfolio before change:  [-1.97504185]
curr_Stock_Price:  100.27302006051478
curr_Factors:  [100.27302006  -0.65559326  -0.98431756]
mat_Sqrt:  [[19.45269935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0083433  -0.09754862  2.62198588]
Stock Position:  -0.008343299092681918
Bond Position:  [-1.13843405]


portfolio before change:  [-1.9771865]
curr_Stock_Price:  100.49595403683227
curr_Factors:  [100.49595404  -1.09238335  -0.9821372 ]
mat_Sqrt:  [[12.62396403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00082551 -0.00970193  0.03098256]
Stock Position:  -0.0008255131105580886
Bond Position:  [-1.89422577]


portfolio before change:  [-1.97822249]
curr_Stock_Price:  101.17720171107636
curr_Factors:  [101.17720171  -0.99341685  -0.96319238]
mat_Sqrt:  [[14.30006702  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.06033829  0.3537809  -0.44322821]
Stock Position:  -0.06033828829706614
Bond Position:  [4.12663667]


portfolio before change:  [-1.95501886]
curr_Stock_Price:  100.80974264496993
curr_Factors:  [100.80974264  -1.23036268  -0.95322121]
mat_Sqrt:  [[11.35491983  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00152388 -0.00317278  0.10580414]
Stock Position:  0.0015238841970446075
Bond Position:  [-2.10864123]


portfolio before change:  [-1.95707878]
curr_Stock_Price:  99.80395584875343
curr_Factors:  [99.80395585 -1.28798827 -0.94164108]
mat_Sqrt:  [[10.73574114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00753277 -0.00202206 -0.08146168]
Stock Position:  -0.007532774834990229
Bond Position:  [-1.20527806]


portfolio before change:  [-1.96704352]
curr_Stock_Price:  101.08680039494594
curr_Factors:  [101.08680039  -1.13080967  -1.03772398]
mat_Sqrt:  [[11.55878674  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00481943 0.00772125 0.1717711 ]
Stock Position:  0.004819427796473863
Bond Position:  [-2.45422406]


portfolio before change:  [-1.96294816]
curr_Stock_Price:  102.06388593092748
curr_Factors:  [102.06388593  -1.09285935  -1.0434877 ]
mat_Sqrt:  [[12.05225649  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03627513  0.08400326 -0.63290189]
Stock Position:  -0.03627512914784822
Bond Position:  [1.73943248]


portfolio before change:  [-1.91753389]
curr_Stock_Price:  100.8239357336547
curr_Factors:  [100.82393573  -0.9281199   -1.03973203]
mat_Sqrt:  [[14.09082472  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0041083   0.01029189 -0.14898708]
Stock Position:  0.004108302278650502
Bond Position:  [-2.3317491]


portfolio before change:  [-1.91859118]
curr_Stock_Price:  100.7084920843329
curr_Factors:  [100.70849208  -0.95242105  -1.05109273]
mat_Sqrt:  [[13.58160565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00057456  0.04758218  0.08510637]
Stock Position:  -0.000574556684397371
Bond Position:  [-1.86072844]


portfolio before change:  [-1.91858767]
curr_Stock_Price:  99.89264528961813
curr_Factors:  [99.89264529 -0.81294461 -1.06373061]
mat_Sqrt:  [[15.29339202  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01180967 -0.03681958  0.123898  ]
Stock Position:  -0.011809666548554008
Bond Position:  [-0.73888884]


portfolio before change:  [-1.92173526]
curr_Stock_Price:  100.14352810534494
curr_Factors:  [100.14352811  -1.07675847  -1.06742251]
mat_Sqrt:  [[11.73321209  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00659282  0.15478445 -0.81183664]
Stock Position:  0.00659282134368753
Bond Position:  [-2.58196365]


portfolio before change:  [-1.91548624]
curr_Stock_Price:  101.18930071142015
curr_Factors:  [101.18930071  -1.36884229  -1.06858982]
mat_Sqrt:  [[ 8.84242288  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042946 -0.04732497 -0.14556626]
Stock Position:  -0.0004294607706896802
Bond Position:  [-1.8720294]


portfolio before change:  [-1.91606762]
curr_Stock_Price:  101.45315054880277
curr_Factors:  [101.45315055  -1.72965256  -1.00467395]
mat_Sqrt:  [[ 6.588137    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01582702 0.00654129 0.57197795]
Stock Position:  0.015827020468251834
Bond Position:  [-3.52176871]


portfolio before change:  [-1.91826761]
curr_Stock_Price:  101.36978442822543
curr_Factors:  [101.36978443  -1.46977831  -1.03573059]
mat_Sqrt:  [[ 8.2752255   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.005776    0.00506513  0.19770219]
Stock Position:  -0.005776003489831277
Bond Position:  [-1.33275538]


portfolio before change:  [-1.91933967]
curr_Stock_Price:  101.49769825883715
curr_Factors:  [101.49769826  -0.97564402  -1.00684228]
mat_Sqrt:  [[13.97891082  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.000422   -0.04255675 -0.11425852]
Stock Position:  0.0004220006777964428
Bond Position:  [-1.96217177]


portfolio before change:  [-1.91941625]
curr_Stock_Price:  102.47878780464487
curr_Factors:  [102.4787878   -1.00373588  -0.98438919]
mat_Sqrt:  [[14.03467081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0093394   0.01584927 -0.03885241]
Stock Position:  -0.009339401383249771
Bond Position:  [-0.96232572]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.93141156]
Stock Price:  103.73740140949077
PL:  [-5.66881297]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [ 9.71438641e-03 -2.93594388e-02  4.70187935e-02]
 [ 3.37381771e-02  9.07062325e-02 -1.83184958e-01]
 [ 1.00185404e-01 -3.95496348e-02 -5.45160520e-03]
 [-2.29040132e-01 -2.24421781e-01  7.22236903e-01]
 [-2.32136273e-02 -5.38942292e-03 -5.75582968e-03]
 [-1.04202116e+00  9.86833801e-01 -1.22389035e-01]
 [ 3.47720618e-03  1.00315985e-02  8.09404498e-03]
 [-6.44588775e-03  4.15050193e-02 -6.58063917e-02]
 [ 1.37025342e-01  2.36490471e-02  3.87377654e-02]
 [ 1.55123090e-01  1.24039374e-01  9.40397895e-02]
 [-1.52956131e-03  3.00444692e-02 -5.14545859e-02]
 [-5.21940499e-02  1.43110303e-01  4.94176121e-02]
 [-1.87718775e-01 -1.24985946e-01  3.30533481e-02]
 [ 2.73453120e-02  5.77434284e-01 -3.69312350e-01]
 [ 5.19357851e-02 -1.24331474e-01 -4.88858746e-02]
 [ 7.07267951e-02  5.92342922e-02  2.41591975e-01]
 [-6.77415357e-02  1.56723668e-02  6.80703198e-02]
 [ 4.38907066e-02 -1.33275347e-01 -3.61111084e-02]
 [-6.85565488e-02  4.86119164e-03 -3.63608068e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.89339808]
curr_Stock_Price:  100.95852101420721
curr_Factors:  [100.95852101  -0.99065128  -0.96422822]
mat_Sqrt:  [[14.29386255  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0009318  -0.00947572  0.13413153]
Stock Position:  0.0009318046148531052
Bond Position:  [9.79932447]


portfolio before change:  [9.894603]
curr_Stock_Price:  99.62216620660739
curr_Factors:  [99.62216621 -0.93536017 -0.95494255]
mat_Sqrt:  [[15.04554556  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00098774  0.02927531 -0.5225757 ]
Stock Position:  0.0009877366170354654
Bond Position:  [9.79620254]


portfolio before change:  [9.89577535]
curr_Stock_Price:  98.3293078118869
curr_Factors:  [98.32930781 -0.87817729 -0.94393996]
mat_Sqrt:  [[15.89818371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0057239  -0.01276459 -0.01555191]
Stock Position:  0.005723896871464417
Bond Position:  [9.33294853]


portfolio before change:  [9.90784269]
curr_Stock_Price:  100.02986367904816
curr_Factors:  [100.02986368  -0.88934904  -0.98959871]
mat_Sqrt:  [[15.279637    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00833947 -0.07243182  2.06034085]
Stock Position:  -0.008339468134261582
Bond Position:  [10.74203855]


portfolio before change:  [9.91314172]
curr_Stock_Price:  99.71651172498696
curr_Factors:  [99.71651172 -0.91279319 -0.97263599]
mat_Sqrt:  [[15.13336796  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00168427 -0.00173943 -0.01641978]
Stock Position:  -0.0016842676731493348
Bond Position:  [10.08109102]


portfolio before change:  [9.91858125]
curr_Stock_Price:  97.98344833359677
curr_Factors:  [97.98344833 -1.10128933 -0.9929434 ]
mat_Sqrt:  [[12.0681027   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.07172355  0.31849924 -0.34914185]
Stock Position:  -0.07172354546541551
Bond Position:  [16.94630156]


portfolio before change:  [9.89941375]
curr_Stock_Price:  98.30976529682789
curr_Factors:  [98.3097653  -1.13524363 -1.00176705]
mat_Sqrt:  [[11.60124811  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00061865 0.00323768 0.02309006]
Stock Position:  0.000618647889460239
Bond Position:  [9.83859462]


portfolio before change:  [9.9017621]
curr_Stock_Price:  98.1293655836999
curr_Factors:  [98.12936558 -1.12107443 -0.9678456 ]
mat_Sqrt:  [[12.15045526  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093876  0.01339569 -0.18772732]
Stock Position:  -0.0009387619123461995
Bond Position:  [9.99388221]


portfolio before change:  [9.90372088]
curr_Stock_Price:  98.70459556054738
curr_Factors:  [98.70459556 -1.17363521 -0.99341237]
mat_Sqrt:  [[11.30317797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01324937 0.0076327  0.11050806]
Stock Position:  0.013249370883837035
Bond Position:  [8.59594708]


portfolio before change:  [9.90784668]
curr_Stock_Price:  98.85377590325726
curr_Factors:  [98.8537759  -1.27541824 -0.99681226]
mat_Sqrt:  [[10.1900448   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0195915  0.04003354 0.26826934]
Stock Position:  0.01959150492726321
Bond Position:  [7.97115244]


portfolio before change:  [9.91060327]
curr_Stock_Price:  98.89274984653751
curr_Factors:  [98.89274985 -0.81649554 -0.98007822]
mat_Sqrt:  [[16.40296592  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00035968  0.00969681 -0.14678561]
Stock Position:  -0.0003596839199385265
Bond Position:  [9.94617341]


portfolio before change:  [9.91274038]
curr_Stock_Price:  99.8651231591097
curr_Factors:  [99.86512316 -1.0515018  -1.01344422]
mat_Sqrt:  [[12.66540789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101808  0.04618865  0.14097469]
Stock Position:  -0.0010180843689544224
Bond Position:  [10.0144115]


portfolio before change:  [9.91502933]
curr_Stock_Price:  100.07626880202959
curr_Factors:  [100.0762688   -1.07837573  -1.04054162]
mat_Sqrt:  [[12.0253298   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01717079 -0.04033904  0.094292  ]
Stock Position:  -0.0171707920826555
Bond Position:  [11.63341814]


portfolio before change:  [9.89720137]
curr_Stock_Price:  101.28394076519061
curr_Factors:  [101.28394077  -1.08329792  -1.03834574]
mat_Sqrt:  [[12.13731038  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00575317  0.18636611 -1.05354534]
Stock Position:  0.005753171153954046
Bond Position:  [9.31449752]


portfolio before change:  [9.90108154]
curr_Stock_Price:  101.55357541434276
curr_Factors:  [101.55357541  -1.35359245  -1.03192833]
mat_Sqrt:  [[ 9.34709605  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00177359 -0.04012781 -0.13945779]
Stock Position:  0.0017735927528007057
Bond Position:  [9.72096685]


portfolio before change:  [9.90194999]
curr_Stock_Price:  100.67282647261307
curr_Factors:  [100.67282647  -1.45100544  -1.03555092]
mat_Sqrt:  [[ 8.37557349  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01577596 0.01911779 0.68919466]
Stock Position:  0.01577595849640624
Bond Position:  [8.31373966]


portfolio before change:  [9.90880195]
curr_Stock_Price:  100.97539207951407
curr_Factors:  [100.97539208  -1.35924094  -1.04658024]
mat_Sqrt:  [[ 9.10711219  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00556133  0.00505823  0.19418568]
Stock Position:  -0.005561327272193551
Bond Position:  [10.47035915]


portfolio before change:  [9.91478537]
curr_Stock_Price:  100.37022935045331
curr_Factors:  [100.37022935  -1.20308932  -1.01091907]
mat_Sqrt:  [[10.96663246  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00084938 -0.04301443 -0.10301494]
Stock Position:  0.0008493802618685118
Bond Position:  [9.82953288]


portfolio before change:  [9.91721973]
curr_Stock_Price:  100.34275591193312
curr_Factors:  [100.34275591  -0.76338237  -1.01498029]
mat_Sqrt:  [[16.94934559  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00442415  0.00156894 -0.10372726]
Stock Position:  -0.004424146077956494
Bond Position:  [10.36115074]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.91510239]
Stock Price:  101.40690550418384
PL:  [8.50819688]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-9.65406383e-02  1.76862662e-01  3.06267827e-03]
 [ 2.63930728e-02  2.95740507e-02 -1.21403664e-01]
 [ 1.33193742e-01 -6.95811910e-03  7.32369503e-02]
 [-8.24719336e-02 -5.04589731e-02  2.27072962e-01]
 [ 6.80511178e-02 -1.40122157e-01  8.49903367e-02]
 [-8.72883618e-01  7.97677220e-01 -8.17570029e-02]
 [-1.42963166e-02 -1.65416307e-02 -2.69138639e-02]
 [-2.73914877e-02  4.38942011e-02 -8.71418815e-02]
 [ 2.57709003e-02  2.73630932e-02  4.46167398e-02]
 [ 1.55335712e-01  1.26301640e-01  9.67775015e-02]
 [-1.52956131e-03  3.00444692e-02 -5.14545859e-02]
 [-5.63434174e-02  1.40927409e-01  5.93187907e-02]
 [-1.87286533e-03 -3.08586671e-02  1.22636094e-01]
 [-1.41435904e-02 -1.95361452e-02  7.10158709e-03]
 [-2.54245890e-02 -1.24462731e-01 -5.71146412e-02]
 [ 3.83635779e-02  1.44657556e-02 -6.02894651e-02]
 [ 2.60351876e-02  2.36579424e-02  9.72986166e-02]
 [-7.99243138e-02  4.07901640e-02  9.50280012e-02]
 [ 1.05359372e-01 -7.14996993e-02 -2.75627257e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.05497765]
curr_Stock_Price:  99.4522890039241
curr_Factors:  [99.452289   -0.53841398 -1.0056356 ]
mat_Sqrt:  [[21.234526    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281681  0.05708218  0.00873697]
Stock Position:  -0.0028168056169736284
Bond Position:  [-1.77483989]


portfolio before change:  [-2.05305968]
curr_Stock_Price:  98.61384562407883
curr_Factors:  [98.61384562 -0.51358413 -0.99950561]
mat_Sqrt:  [[21.71757716  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00035218  0.00954498 -0.34633086]
Stock Position:  0.00035217701111443843
Bond Position:  [-2.08778921]


portfolio before change:  [-2.05401211]
curr_Stock_Price:  97.39168766052353
curr_Factors:  [97.39168766 -0.69042885 -0.99317019]
mat_Sqrt:  [[18.08606629  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00811248 -0.00224572  0.20892463]
Stock Position:  0.008112480057032682
Bond Position:  [-2.84410024]


portfolio before change:  [-2.05482804]
curr_Stock_Price:  97.37876781759954
curr_Factors:  [97.37876782 -0.7009714  -1.00564861]
mat_Sqrt:  [[17.67211883  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262678 -0.01628556  0.64777596]
Stock Position:  -0.002626779195971583
Bond Position:  [-1.79903552]


portfolio before change:  [-2.05736593]
curr_Stock_Price:  98.17368512677811
curr_Factors:  [98.17368513 -1.01845516 -1.04648416]
mat_Sqrt:  [[12.45097445  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00456168 -0.04522423  0.24245377]
Stock Position:  0.004561681687082495
Bond Position:  [-2.50520303]


portfolio before change:  [-2.06061696]
curr_Stock_Price:  97.59831550906458
curr_Factors:  [97.59831551 -1.51405822 -1.04816767]
mat_Sqrt:  [[ 7.52803723  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.09653871  0.25744922 -0.23322997]
Stock Position:  -0.09653871167124227
Bond Position:  [7.36139868]


portfolio before change:  [-2.0227476]
curr_Stock_Price:  97.22511003553811
curr_Factors:  [97.22511004 -0.95481681 -1.0514374 ]
mat_Sqrt:  [[13.07595179  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0017717  -0.00533879 -0.07677776]
Stock Position:  -0.0017716975903624569
Bond Position:  [-1.85049411]


portfolio before change:  [-2.02561593]
curr_Stock_Price:  98.58293184201233
curr_Factors:  [98.58293184 -1.02077352 -1.08999998]
mat_Sqrt:  [[11.94275281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303275  0.01416679 -0.24859153]
Stock Position:  -0.003032749996207631
Bond Position:  [-1.72663855]


portfolio before change:  [-2.02214031]
curr_Stock_Price:  97.29454931643727
curr_Factors:  [97.29454932 -0.55727171 -1.10018468]
mat_Sqrt:  [[18.54660159  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00218173 0.0088314  0.12727914]
Stock Position:  0.0021817324301857555
Bond Position:  [-2.23441098]


portfolio before change:  [-2.01949432]
curr_Stock_Price:  98.76340724734796
curr_Factors:  [98.76340725 -0.79657217 -1.09210902]
mat_Sqrt:  [[14.94005678  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01344517 0.04076368 0.27607927]
Stock Position:  0.013445166497221333
Bond Position:  [-3.34738478]


portfolio before change:  [-2.03664957]
curr_Stock_Price:  97.54971491115812
curr_Factors:  [97.54971491 -0.90294539 -1.1249308 ]
mat_Sqrt:  [[12.83898125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00045953  0.00969681 -0.14678561]
Stock Position:  -0.00045952891162290505
Bond Position:  [-1.99182266]


portfolio before change:  [-2.03664966]
curr_Stock_Price:  96.4661450903598
curr_Factors:  [96.46614509 -1.062176   -1.11371109]
mat_Sqrt:  [[10.94962294  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00141268  0.04548413  0.16922   ]
Stock Position:  -0.0014126817923584137
Bond Position:  [-1.90037369]


portfolio before change:  [-2.03586583]
curr_Stock_Price:  95.57494447496427
curr_Factors:  [95.57494447 -1.2128582  -1.13066384]
mat_Sqrt:  [[ 9.17413998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0018379  -0.00995959  0.34984664]
Stock Position:  0.001837896896970701
Bond Position:  [-2.21152272]


portfolio before change:  [-2.03676584]
curr_Stock_Price:  95.38610637408837
curr_Factors:  [95.38610637 -1.07842881 -1.11959378]
mat_Sqrt:  [[10.59000194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00157524 -0.00630526  0.02025885]
Stock Position:  -0.0015752389867088692
Bond Position:  [-1.88650993]


portfolio before change:  [-2.03667043]
curr_Stock_Price:  95.026096178608
curr_Factors:  [95.02609618 -0.79380197 -1.1394275 ]
mat_Sqrt:  [[13.74839485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00454518 -0.04017017 -0.16293217]
Stock Position:  -0.004545178944226691
Bond Position:  [-1.60475981]


portfolio before change:  [-2.04219469]
curr_Stock_Price:  96.15323080849221
curr_Factors:  [96.15323081 -0.73675776 -1.13268126]
mat_Sqrt:  [[14.82780386  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00195645  0.0046688  -0.17198906]
Stock Position:  0.001956449699003912
Bond Position:  [-2.23031365]


portfolio before change:  [-2.04181794]
curr_Stock_Price:  96.63083342656599
curr_Factors:  [96.63083343 -0.67417166 -1.1500786 ]
mat_Sqrt:  [[15.59027958  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00325365 0.00763557 0.27756587]
Stock Position:  0.0032536518394418084
Bond Position:  [-2.35622103]


portfolio before change:  [-2.04772712]
curr_Stock_Price:  94.99572993433785
curr_Factors:  [94.99572993 -0.71796677 -1.17678959]
mat_Sqrt:  [[14.28307951  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00365471  0.01316497  0.27108844]
Stock Position:  -0.0036547123398511247
Bond Position:  [-1.70054506]


portfolio before change:  [-2.04706694]
curr_Stock_Price:  94.69875036736332
curr_Factors:  [94.69875037 -1.12371159 -1.15582599]
mat_Sqrt:  [[ 9.69066668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00356037 -0.02307643 -0.78628785]
Stock Position:  0.0035603720834127806
Bond Position:  [-2.38422972]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.05253268]
Stock Price:  93.33102382917596
PL:  [-2.05253268]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 1.19302283e+02 -2.92658751e+01 -2.92566439e+01]
 [-6.90677963e-02  1.43476304e-01  1.67635687e-02]
 [ 5.72106466e-03  1.09266717e-01 -1.12216021e-01]
 [-7.83896219e-02  9.04369519e-03 -3.11215999e-02]
 [-3.55066432e-01 -3.76556977e-01  1.42835283e+00]
 [-9.40580750e-03 -2.57736941e-02  7.97353220e-03]
 [-1.53506866e+00  1.72383602e+00 -2.75057620e-01]
 [ 8.67424886e-03 -6.94779181e-03  2.35153248e-02]
 [-3.32149402e-02 -1.68034476e-01  2.73983143e-01]
 [-5.14881270e-02 -5.71349436e-02 -6.16956674e-02]
 [-1.11880018e+00  4.16727271e-01 -5.72507820e-01]
 [ 1.80552776e-01  6.93167942e-02 -5.92814725e-02]
 [-1.29977439e-01  9.67940849e-02  2.10198473e-01]
 [ 5.59297553e-01  2.58679961e-02 -3.07001257e-01]
 [ 3.61336831e-02  1.39025030e+00 -7.76418958e-01]
 [ 1.68179207e-01 -1.42499359e-01  1.61650463e-02]
 [ 1.27097118e-02 -3.90327379e-02 -1.57228740e-01]
 [-8.17192170e-02  1.63749071e-02  5.49726312e-02]
 [ 4.93405133e-02 -3.06825099e-01 -2.22026816e-02]
 [-1.99166520e-01  2.83189985e-03 -4.90346728e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.30228255 -29.26587507 -29.2566439 ]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93262635  -9.44552056 -83.46106155]
init_Out:  [2.48752752]
Stock Position:  7.932626349696399
Bond position:  [-790.77510745]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.70836624]
curr_Stock_Price:  99.62204506584351
curr_Factors:  [99.62204507 -0.75631542 -0.99292571]
mat_Sqrt:  [[17.32485788  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209866  0.04630678  0.0478218 ]
Stock Position:  -0.0020986590160339868
Bond Position:  [-0.49929354]


portfolio before change:  [-0.71302771]
curr_Stock_Price:  101.78372566798777
curr_Factors:  [101.78372567  -0.56895915  -0.99020792]
mat_Sqrt:  [[21.40625463  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.39137613e-04  3.52656814e-02 -3.20121072e-01]
Stock Position:  0.00023913761317682355
Bond Position:  [-0.73736803]


portfolio before change:  [-0.71326107]
curr_Stock_Price:  101.57886691820866
curr_Factors:  [101.57886692  -0.77682818  -1.01428112]
mat_Sqrt:  [[16.94082212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00489328  0.00291884 -0.08878126]
Stock Position:  -0.00489328408605395
Bond Position:  [-0.21620681]


portfolio before change:  [-0.7229605]
curr_Stock_Price:  103.55001245836584
curr_Factors:  [103.55001246  -0.65641088  -1.00397213]
mat_Sqrt:  [[19.68135412  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00713211 -0.12153324  4.07469304]
Stock Position:  -0.007132105969608692
Bond Position:  [0.01556916]


portfolio before change:  [-0.71204047]
curr_Stock_Price:  102.0194499651737
curr_Factors:  [102.01944997  -0.48187185  -0.99226211]
mat_Sqrt:  [[23.36010201  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00055818 -0.00831842  0.02274627]
Stock Position:  -0.000558184648481135
Bond Position:  [-0.65509478]


portfolio before change:  [-0.71459577]
curr_Stock_Price:  106.30388504095428
curr_Factors:  [106.30388504  -0.33332859  -0.98717155]
mat_Sqrt:  [[28.38332122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04366431  0.55636568 -0.78466283]
Stock Position:  -0.043664305511230794
Bond Position:  [3.92708954]


portfolio before change:  [-0.61871095]
curr_Stock_Price:  104.13041799263462
curr_Factors:  [104.13041799  -0.27382328  -0.97565017]
mat_Sqrt:  [[29.84957723  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00040389 -0.00224239  0.06708268]
Stock Position:  0.00040389457678514733
Bond Position:  [-0.66076866]


portfolio before change:  [-0.61906569]
curr_Stock_Price:  103.66115627058575
curr_Factors:  [103.66115627  -0.32962141  -0.97098356]
mat_Sqrt:  [[28.23387491  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.10438135e-04 -5.42328938e-02  7.81597646e-01]
Stock Position:  -0.0004104381354876942
Bond Position:  [-0.5765192]


portfolio before change:  [-0.62055759]
curr_Stock_Price:  106.94484774894246
curr_Factors:  [106.94484775  -0.59774805  -0.92881044]
mat_Sqrt:  [[23.23720766  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325961 -0.01844022 -0.17600057]
Stock Position:  -0.0032596138488325222
Bond Position:  [-0.27195869]


portfolio before change:  [-0.61843776]
curr_Stock_Price:  106.2736543766778
curr_Factors:  [106.27365438  -0.61375272  -0.93642103]
mat_Sqrt:  [[22.55244908  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05101879  0.13449815 -1.63320546]
Stock Position:  -0.05101879383004988
Bond Position:  [4.8035159]


portfolio before change:  [-0.68551016]
curr_Stock_Price:  107.61185583259649
curr_Factors:  [107.61185583  -1.12688279  -0.93803413]
mat_Sqrt:  [[13.64828555  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01337906  0.0223719  -0.16911354]
Stock Position:  0.013379059716682205
Bond Position:  [-2.1252556]


portfolio before change:  [-0.66634667]
curr_Stock_Price:  109.08392244208
curr_Factors:  [109.08392244  -1.21095724  -0.9062483 ]
mat_Sqrt:  [[13.13016139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00512658  0.03124016  0.59963774]
Stock Position:  -0.005126581739792395
Bond Position:  [-0.10711902]


portfolio before change:  [-0.6712471]
curr_Stock_Price:  110.0345850248356
curr_Factors:  [110.03458502  -1.73684428  -0.90024401]
mat_Sqrt:  [[ 7.87510432  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06373395  0.00834886 -0.87578913]
Stock Position:  0.06373394500603892
Bond Position:  [-7.68418529]


portfolio before change:  [-0.70304053]
curr_Stock_Price:  109.5658843677889
curr_Factors:  [109.56588437  -1.56570593  -0.89947248]
mat_Sqrt:  [[ 9.3124074   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0173351   0.44870136 -2.21490717]
Stock Position:  0.017335096567260566
Bond Position:  [-2.60237572]


portfolio before change:  [-0.71510089]
curr_Stock_Price:  108.90770006341809
curr_Factors:  [108.90770006  -1.95709167  -0.89166659]
mat_Sqrt:  [[ 6.30751936  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02257485 -0.04599147  0.04611438]
Stock Position:  0.022574853077556085
Bond Position:  [-3.17367622]


portfolio before change:  [-0.70925783]
curr_Stock_Price:  109.20168129052387
curr_Factors:  [109.20168129  -1.98344938  -0.93166723]
mat_Sqrt:  [[ 5.91848111  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00462146 -0.01259776 -0.44852983]
Stock Position:  -0.0046214550717754285
Bond Position:  [-0.20458716]


portfolio before change:  [-0.71182758]
curr_Stock_Price:  109.7466614549616
curr_Factors:  [109.74666145  -1.86466388  -0.89620089]
mat_Sqrt:  [[ 6.94005616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0096765   0.00528498  0.15682162]
Stock Position:  -0.009676501199718504
Bond Position:  [0.35013612]


portfolio before change:  [-0.71681322]
curr_Stock_Price:  110.27094025344377
curr_Factors:  [110.27094025  -1.5620861   -0.92596022]
mat_Sqrt:  [[ 9.16043913  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00194554 -0.09902737 -0.06333807]
Stock Position:  -0.0019455400425995124
Bond Position:  [-0.50227669]


portfolio before change:  [-0.71534445]
curr_Stock_Price:  109.45144710866607
curr_Factors:  [109.45144711  -1.45372935  -0.92322765]
mat_Sqrt:  [[10.16066659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02052992  0.00091399 -0.13988227]
Stock Position:  -0.02052991503847157
Bond Position:  [1.53168446]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.75036428]
Stock Price:  111.17589647578964
PL:  [-11.92626076]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  0.3215023716117972
FINAL STD P&L:  7.654798961137063
