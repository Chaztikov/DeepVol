WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-18 21:23:03.964200: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-18 21:23:03.983467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-12-18 21:23:03.984090: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 21:23:03.986281: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 21:23:03.988274: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 21:23:03.990174: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 21:23:03.992614: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 21:23:03.994535: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 21:23:03.999839: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 21:23:04.002251: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 21:23:04.002671: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-18 21:23:04.009333: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2400070000 Hz
2019-12-18 21:23:04.009512: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5607f2ebc800 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-18 21:23:04.009529: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-18 21:23:04.010639: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-12-18 21:23:04.010666: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 21:23:04.010678: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 21:23:04.010688: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 21:23:04.010698: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 21:23:04.010708: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 21:23:04.010718: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 21:23:04.010729: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 21:23:04.012552: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 21:23:04.012580: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 21:23:04.113990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-18 21:23:04.114023: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-18 21:23:04.114035: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-18 21:23:04.117456: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2019-12-18 21:23:04.119717: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5607f34f5b10 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-18 21:23:04.119737: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
INFO   Y0_true: -1.0000e+00
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:232: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:232: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:237: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:237: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:311: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:311: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:317: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:317: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:487: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:487: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:492: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:492: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:494: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:494: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:330: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:330: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:340: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:340: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:342: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:342: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:195: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:195: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-18 21:23:13.072221: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 2.0860e+02,   Y0: 2.5578e+00,  elapsed time   9
INFO   step:     1,    loss: 2.0404e+02,   Y0: 2.5628e+00,  elapsed time  12
INFO   step:     2,    loss: 2.0401e+02,   Y0: 2.5674e+00,  elapsed time  13
INFO   step:     3,    loss: 2.0399e+02,   Y0: 2.5671e+00,  elapsed time  14
INFO   step:     4,    loss: 2.0397e+02,   Y0: 2.5658e+00,  elapsed time  15
INFO   step:     5,    loss: 2.0394e+02,   Y0: 2.5631e+00,  elapsed time  16
INFO   step:     6,    loss: 2.0392e+02,   Y0: 2.5616e+00,  elapsed time  17
INFO   step:     7,    loss: 2.0390e+02,   Y0: 2.5596e+00,  elapsed time  18
INFO   step:     8,    loss: 2.0388e+02,   Y0: 2.5579e+00,  elapsed time  19
INFO   step:     9,    loss: 2.0385e+02,   Y0: 2.5554e+00,  elapsed time  20
INFO   step:    10,    loss: 2.0382e+02,   Y0: 2.5521e+00,  elapsed time  21
INFO   step:    11,    loss: 2.0380e+02,   Y0: 2.5492e+00,  elapsed time  22
INFO   step:    12,    loss: 2.0377e+02,   Y0: 2.5479e+00,  elapsed time  23
INFO   step:    13,    loss: 2.0375e+02,   Y0: 2.5473e+00,  elapsed time  24
INFO   step:    14,    loss: 2.0372e+02,   Y0: 2.5474e+00,  elapsed time  25
INFO   step:    15,    loss: 2.0369e+02,   Y0: 2.5470e+00,  elapsed time  26
INFO   step:    16,    loss: 2.0367e+02,   Y0: 2.5473e+00,  elapsed time  27
INFO   step:    17,    loss: 2.0364e+02,   Y0: 2.5473e+00,  elapsed time  28
INFO   step:    18,    loss: 2.0362e+02,   Y0: 2.5466e+00,  elapsed time  29
INFO   step:    19,    loss: 2.0360e+02,   Y0: 2.5464e+00,  elapsed time  29
INFO   step:    20,    loss: 2.0358e+02,   Y0: 2.5456e+00,  elapsed time  30
INFO   step:    21,    loss: 2.0355e+02,   Y0: 2.5445e+00,  elapsed time  31
INFO   step:    22,    loss: 2.0353e+02,   Y0: 2.5433e+00,  elapsed time  32
INFO   step:    23,    loss: 2.0350e+02,   Y0: 2.5416e+00,  elapsed time  33
INFO   step:    24,    loss: 2.0348e+02,   Y0: 2.5398e+00,  elapsed time  34
INFO   step:    25,    loss: 2.0346e+02,   Y0: 2.5384e+00,  elapsed time  35
INFO   step:    26,    loss: 2.0343e+02,   Y0: 2.5376e+00,  elapsed time  36
INFO   step:    27,    loss: 2.0341e+02,   Y0: 2.5367e+00,  elapsed time  37
INFO   step:    28,    loss: 2.0338e+02,   Y0: 2.5358e+00,  elapsed time  38
INFO   step:    29,    loss: 2.0336e+02,   Y0: 2.5351e+00,  elapsed time  39
INFO   step:    30,    loss: 2.0334e+02,   Y0: 2.5345e+00,  elapsed time  40
INFO   step:    31,    loss: 2.0332e+02,   Y0: 2.5336e+00,  elapsed time  41
INFO   step:    32,    loss: 2.0329e+02,   Y0: 2.5327e+00,  elapsed time  42
INFO   step:    33,    loss: 2.0327e+02,   Y0: 2.5314e+00,  elapsed time  43
INFO   step:    34,    loss: 2.0325e+02,   Y0: 2.5297e+00,  elapsed time  44
INFO   step:    35,    loss: 2.0322e+02,   Y0: 2.5278e+00,  elapsed time  45
INFO   step:    36,    loss: 2.0320e+02,   Y0: 2.5254e+00,  elapsed time  46
INFO   step:    37,    loss: 2.0318e+02,   Y0: 2.5244e+00,  elapsed time  47
INFO   step:    38,    loss: 2.0315e+02,   Y0: 2.5235e+00,  elapsed time  48
INFO   step:    39,    loss: 2.0313e+02,   Y0: 2.5216e+00,  elapsed time  48
INFO   step:    40,    loss: 2.0311e+02,   Y0: 2.5209e+00,  elapsed time  49
INFO   step:    41,    loss: 2.0308e+02,   Y0: 2.5203e+00,  elapsed time  50
INFO   step:    42,    loss: 2.0307e+02,   Y0: 2.5199e+00,  elapsed time  51
INFO   step:    43,    loss: 2.0305e+02,   Y0: 2.5197e+00,  elapsed time  52
INFO   step:    44,    loss: 2.0303e+02,   Y0: 2.5194e+00,  elapsed time  53
INFO   step:    45,    loss: 2.0300e+02,   Y0: 2.5196e+00,  elapsed time  54
INFO   step:    46,    loss: 2.0298e+02,   Y0: 2.5193e+00,  elapsed time  55
INFO   step:    47,    loss: 2.0295e+02,   Y0: 2.5198e+00,  elapsed time  56
INFO   step:    48,    loss: 2.0293e+02,   Y0: 2.5207e+00,  elapsed time  57
INFO   step:    49,    loss: 2.0290e+02,   Y0: 2.5209e+00,  elapsed time  58
INFO   step:    50,    loss: 2.0288e+02,   Y0: 2.5209e+00,  elapsed time  59
INFO   step:    51,    loss: 2.0285e+02,   Y0: 2.5205e+00,  elapsed time  60
INFO   step:    52,    loss: 2.0283e+02,   Y0: 2.5196e+00,  elapsed time  61
INFO   step:    53,    loss: 2.0281e+02,   Y0: 2.5188e+00,  elapsed time  62
INFO   step:    54,    loss: 2.0279e+02,   Y0: 2.5182e+00,  elapsed time  63
INFO   step:    55,    loss: 2.0277e+02,   Y0: 2.5175e+00,  elapsed time  64
INFO   step:    56,    loss: 2.0274e+02,   Y0: 2.5164e+00,  elapsed time  65
INFO   step:    57,    loss: 2.0272e+02,   Y0: 2.5152e+00,  elapsed time  65
INFO   step:    58,    loss: 2.0270e+02,   Y0: 2.5141e+00,  elapsed time  66
INFO   step:    59,    loss: 2.0268e+02,   Y0: 2.5128e+00,  elapsed time  67
INFO   step:    60,    loss: 2.0266e+02,   Y0: 2.5113e+00,  elapsed time  68
INFO   step:    61,    loss: 2.0264e+02,   Y0: 2.5101e+00,  elapsed time  69
INFO   step:    62,    loss: 2.0261e+02,   Y0: 2.5090e+00,  elapsed time  70
INFO   step:    63,    loss: 2.0259e+02,   Y0: 2.5076e+00,  elapsed time  71
INFO   step:    64,    loss: 2.0257e+02,   Y0: 2.5066e+00,  elapsed time  72
INFO   step:    65,    loss: 2.0255e+02,   Y0: 2.5051e+00,  elapsed time  73
INFO   step:    66,    loss: 2.0252e+02,   Y0: 2.5037e+00,  elapsed time  74
INFO   step:    67,    loss: 2.0250e+02,   Y0: 2.5022e+00,  elapsed time  75
INFO   step:    68,    loss: 2.0248e+02,   Y0: 2.5002e+00,  elapsed time  76
INFO   step:    69,    loss: 2.0246e+02,   Y0: 2.4990e+00,  elapsed time  77
INFO   step:    70,    loss: 2.0243e+02,   Y0: 2.4981e+00,  elapsed time  78
INFO   step:    71,    loss: 2.0241e+02,   Y0: 2.4966e+00,  elapsed time  79
INFO   step:    72,    loss: 2.0239e+02,   Y0: 2.4957e+00,  elapsed time  80
INFO   step:    73,    loss: 2.0237e+02,   Y0: 2.4958e+00,  elapsed time  81
INFO   step:    74,    loss: 2.0234e+02,   Y0: 2.4960e+00,  elapsed time  82
INFO   step:    75,    loss: 2.0232e+02,   Y0: 2.4953e+00,  elapsed time  83
INFO   step:    76,    loss: 2.0230e+02,   Y0: 2.4955e+00,  elapsed time  83
INFO   step:    77,    loss: 2.0228e+02,   Y0: 2.4952e+00,  elapsed time  84
INFO   step:    78,    loss: 2.0225e+02,   Y0: 2.4954e+00,  elapsed time  85
INFO   step:    79,    loss: 2.0223e+02,   Y0: 2.4958e+00,  elapsed time  86
INFO   step:    80,    loss: 2.0221e+02,   Y0: 2.4962e+00,  elapsed time  87
INFO   step:    81,    loss: 2.0219e+02,   Y0: 2.4961e+00,  elapsed time  88
INFO   step:    82,    loss: 2.0217e+02,   Y0: 2.4965e+00,  elapsed time  89
INFO   step:    83,    loss: 2.0214e+02,   Y0: 2.4972e+00,  elapsed time  90
INFO   step:    84,    loss: 2.0212e+02,   Y0: 2.4978e+00,  elapsed time  91
INFO   step:    85,    loss: 2.0209e+02,   Y0: 2.4983e+00,  elapsed time  92
INFO   step:    86,    loss: 2.0207e+02,   Y0: 2.4993e+00,  elapsed time  93
INFO   step:    87,    loss: 2.0204e+02,   Y0: 2.5004e+00,  elapsed time  94
INFO   step:    88,    loss: 2.0202e+02,   Y0: 2.5014e+00,  elapsed time  95
INFO   step:    89,    loss: 2.0199e+02,   Y0: 2.5017e+00,  elapsed time  96
INFO   step:    90,    loss: 2.0196e+02,   Y0: 2.5024e+00,  elapsed time  97
INFO   step:    91,    loss: 2.0194e+02,   Y0: 2.5025e+00,  elapsed time  98
INFO   step:    92,    loss: 2.0191e+02,   Y0: 2.5033e+00,  elapsed time  99
INFO   step:    93,    loss: 2.0188e+02,   Y0: 2.5038e+00,  elapsed time 100
INFO   step:    94,    loss: 2.0186e+02,   Y0: 2.5040e+00,  elapsed time 101
INFO   step:    95,    loss: 2.0183e+02,   Y0: 2.5037e+00,  elapsed time 101
INFO   step:    96,    loss: 2.0181e+02,   Y0: 2.5036e+00,  elapsed time 102
INFO   step:    97,    loss: 2.0178e+02,   Y0: 2.5036e+00,  elapsed time 103
INFO   step:    98,    loss: 2.0176e+02,   Y0: 2.5037e+00,  elapsed time 104
INFO   step:    99,    loss: 2.0173e+02,   Y0: 2.5038e+00,  elapsed time 105
INFO   step:   100,    loss: 2.0171e+02,   Y0: 2.5039e+00,  elapsed time 106
INFO   step:   101,    loss: 2.0168e+02,   Y0: 2.5040e+00,  elapsed time 107
INFO   step:   102,    loss: 2.0165e+02,   Y0: 2.5036e+00,  elapsed time 108
INFO   step:   103,    loss: 2.0163e+02,   Y0: 2.5031e+00,  elapsed time 109
INFO   step:   104,    loss: 2.0160e+02,   Y0: 2.5023e+00,  elapsed time 110
INFO   step:   105,    loss: 2.0158e+02,   Y0: 2.5020e+00,  elapsed time 111
INFO   step:   106,    loss: 2.0155e+02,   Y0: 2.5013e+00,  elapsed time 112
INFO   step:   107,    loss: 2.0152e+02,   Y0: 2.5009e+00,  elapsed time 113
INFO   step:   108,    loss: 2.0150e+02,   Y0: 2.5005e+00,  elapsed time 114
INFO   step:   109,    loss: 2.0147e+02,   Y0: 2.4995e+00,  elapsed time 115
INFO   step:   110,    loss: 2.0145e+02,   Y0: 2.4991e+00,  elapsed time 116
INFO   step:   111,    loss: 2.0143e+02,   Y0: 2.4985e+00,  elapsed time 117
INFO   step:   112,    loss: 2.0140e+02,   Y0: 2.4980e+00,  elapsed time 118
INFO   step:   113,    loss: 2.0138e+02,   Y0: 2.4968e+00,  elapsed time 119
INFO   step:   114,    loss: 2.0135e+02,   Y0: 2.4964e+00,  elapsed time 119
INFO   step:   115,    loss: 2.0133e+02,   Y0: 2.4958e+00,  elapsed time 120
INFO   step:   116,    loss: 2.0130e+02,   Y0: 2.4953e+00,  elapsed time 121
INFO   step:   117,    loss: 2.0128e+02,   Y0: 2.4956e+00,  elapsed time 122
INFO   step:   118,    loss: 2.0126e+02,   Y0: 2.4960e+00,  elapsed time 123
INFO   step:   119,    loss: 2.0124e+02,   Y0: 2.4963e+00,  elapsed time 124
INFO   step:   120,    loss: 2.0121e+02,   Y0: 2.4964e+00,  elapsed time 125
INFO   step:   121,    loss: 2.0119e+02,   Y0: 2.4958e+00,  elapsed time 126
INFO   step:   122,    loss: 2.0116e+02,   Y0: 2.4953e+00,  elapsed time 127
INFO   step:   123,    loss: 2.0114e+02,   Y0: 2.4947e+00,  elapsed time 128
INFO   step:   124,    loss: 2.0112e+02,   Y0: 2.4935e+00,  elapsed time 129
INFO   step:   125,    loss: 2.0109e+02,   Y0: 2.4934e+00,  elapsed time 130
INFO   step:   126,    loss: 2.0107e+02,   Y0: 2.4933e+00,  elapsed time 131
INFO   step:   127,    loss: 2.0105e+02,   Y0: 2.4938e+00,  elapsed time 132
INFO   step:   128,    loss: 2.0103e+02,   Y0: 2.4938e+00,  elapsed time 133
INFO   step:   129,    loss: 2.0101e+02,   Y0: 2.4942e+00,  elapsed time 134
INFO   step:   130,    loss: 2.0099e+02,   Y0: 2.4942e+00,  elapsed time 135
INFO   step:   131,    loss: 2.0097e+02,   Y0: 2.4935e+00,  elapsed time 136
INFO   step:   132,    loss: 2.0095e+02,   Y0: 2.4927e+00,  elapsed time 136
INFO   step:   133,    loss: 2.0092e+02,   Y0: 2.4926e+00,  elapsed time 137
INFO   step:   134,    loss: 2.0090e+02,   Y0: 2.4925e+00,  elapsed time 138
INFO   step:   135,    loss: 2.0088e+02,   Y0: 2.4924e+00,  elapsed time 139
INFO   step:   136,    loss: 2.0085e+02,   Y0: 2.4917e+00,  elapsed time 140
INFO   step:   137,    loss: 2.0083e+02,   Y0: 2.4906e+00,  elapsed time 141
INFO   step:   138,    loss: 2.0081e+02,   Y0: 2.4899e+00,  elapsed time 142
INFO   step:   139,    loss: 2.0079e+02,   Y0: 2.4891e+00,  elapsed time 143
INFO   step:   140,    loss: 2.0076e+02,   Y0: 2.4878e+00,  elapsed time 144
INFO   step:   141,    loss: 2.0073e+02,   Y0: 2.4860e+00,  elapsed time 145
INFO   step:   142,    loss: 2.0071e+02,   Y0: 2.4849e+00,  elapsed time 146
INFO   step:   143,    loss: 2.0068e+02,   Y0: 2.4848e+00,  elapsed time 147
INFO   step:   144,    loss: 2.0066e+02,   Y0: 2.4842e+00,  elapsed time 148
INFO   step:   145,    loss: 2.0063e+02,   Y0: 2.4830e+00,  elapsed time 149
INFO   step:   146,    loss: 2.0061e+02,   Y0: 2.4813e+00,  elapsed time 150
INFO   step:   147,    loss: 2.0059e+02,   Y0: 2.4807e+00,  elapsed time 151
INFO   step:   148,    loss: 2.0056e+02,   Y0: 2.4801e+00,  elapsed time 152
INFO   step:   149,    loss: 2.0053e+02,   Y0: 2.4806e+00,  elapsed time 153
Delta:  120 ,  120.05
Other1:  -30.05 ,  -30
Other2:  -30.05 ,  -30
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 3) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 3) dtype=float64>]
num_iterations:  150
total time intervals:  10
# of dimensions:  3
Loss out:  153.97443765431558
Output_Z_Vals:  [[[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
  [ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
  [ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
  ...
  [ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
  [ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
  [ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]]

 [[-5.75341600e-02  2.91827869e-02  4.61988008e-02]
  [-5.36579378e-02  5.31057262e-02  4.98670726e-02]
  [-7.29536449e-02  6.40673079e-02  5.18853233e-02]
  ...
  [ 3.28519413e-02  9.40594723e-02  4.85977246e-02]
  [ 7.30620113e-02  1.49836619e-01  5.14174216e-02]
  [-3.57747351e-02  3.67002037e-02  4.70425911e-02]]

 [[ 5.18590315e-01 -7.06597457e-01  7.19489636e-01]
  [ 3.88431090e-01 -4.41369240e-01  4.66635399e-01]
  [ 5.07545463e-01 -6.51399709e-01  6.81620425e-01]
  ...
  [ 4.07428639e-01 -5.39550869e-01  5.33398224e-01]
  [ 3.46839828e-01 -5.29091815e-01  4.91198918e-01]
  [ 2.63099351e-01 -2.89839550e-01  3.44392357e-01]]

 ...

 [[-1.68745645e-01 -2.30340950e-03  1.78577701e-01]
  [-2.30982801e-01 -2.63842374e-01  3.02793293e-01]
  [-1.16166098e-01 -1.60328909e-01  1.70661008e-01]
  ...
  [-3.75953938e-02 -4.05738018e-01  2.35916516e-01]
  [-5.25723593e-01 -2.81008994e-01  6.31944133e-01]
  [-5.15898921e-02 -3.19365364e-01  1.66076776e-01]]

 [[-1.16294954e-01  8.61100865e-02  1.98471736e-01]
  [-1.16804186e-01  6.58247619e-02  1.51187152e-01]
  [-1.12027725e-01  7.76742119e-02  1.91927283e-01]
  ...
  [-1.49909306e-01  6.28613030e-02  4.75296449e-02]
  [-1.17165680e-01  8.45444935e-02  1.92387067e-01]
  [-1.14785614e-01  4.84791310e-02  1.17942912e-01]]

 [[-6.91083262e-03 -1.77776585e-02  9.65950755e-02]
  [-5.06364694e-03 -4.38089359e-02  1.51910049e-02]
  [-5.21407885e-02 -5.42739389e-02  3.71032194e-02]
  ...
  [ 1.07988087e-02 -3.72804069e-02  1.65499013e-02]
  [-1.16836759e-02 -4.62211007e-02  1.55336469e-02]
  [-1.79711760e-03 -4.06170626e-02  2.08501489e-02]]]
Z_Vals dimensionality:  (10, 200, 3)
X_test:  [[[100.         101.40499814 102.39422814 ... 102.27549967  99.05770156
    96.73455247]
  [ -1.          -0.59703067  -0.4320128  ...  -0.89913813  -0.26046037
    -0.35057385]
  [ -1.          -0.97422742  -1.00266202 ...  -0.91132752  -0.96144447
    -1.05785528]]

 [[100.         100.86867948 100.81373346 ... 108.09104444 107.89015696
   107.97599416]
  [ -1.          -1.37095741  -1.77731077 ...  -1.37346664  -1.35377748
    -1.14363483]
  [ -1.          -1.00875291  -1.06213126 ...  -1.15184948  -1.10022599
    -1.08210393]]

 [[100.         101.683019   102.41651128 ... 100.16735373 101.17044673
   100.84614577]
  [ -1.          -0.88437013  -0.77295253 ...  -0.56395257  -1.19476861
    -1.057537  ]
  [ -1.          -1.02020511  -1.01236436 ...  -1.15701905  -1.16493906
    -1.15173291]]

 ...

 [[100.          99.82537481 100.76941437 ... 103.36403047 103.36309712
   103.97099821]
  [ -1.          -0.79551915  -1.17011799 ...  -2.42414208  -1.72461339
    -1.34269281]
  [ -1.          -1.04770563  -1.04514519 ...  -1.07779249  -1.04760572
    -1.03745946]]

 [[100.          98.97922015  99.71417616 ... 107.7779979  109.35788122
   110.62478696]
  [ -1.          -0.6683536   -0.60591686 ...  -1.08876702  -1.22175742
    -1.27463764]
  [ -1.          -1.07296884  -1.07234906 ...  -1.03030862  -1.04906344
    -1.05064178]]

 [[100.         100.86383198  98.94663576 ... 102.39892142 102.55228763
   102.37101044]
  [ -1.          -0.76388279  -0.95226262 ...  -1.44525341  -1.75188721
    -1.48557716]
  [ -1.          -1.05138881  -0.99175586 ...  -1.08020876  -1.06245734
    -1.10572394]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-5.75341600e-02  2.91827869e-02  4.61988008e-02]
 [ 5.18590315e-01 -7.06597457e-01  7.19489636e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.95919077e-01 -4.37286398e-01 -3.83642236e-01]
 [-5.34597067e-02 -1.26527866e-02  1.51893831e-02]
 [-8.89503726e-02  2.10182513e-02  4.70777555e-02]
 [-1.68745645e-01 -2.30340950e-03  1.78577701e-01]
 [-1.16294954e-01  8.61100865e-02  1.98471736e-01]
 [-6.91083262e-03 -1.77776585e-02  9.65950755e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.2300128]
curr_Stock_Price:  101.40499813510282
curr_Factors:  [101.40499814  -0.59703067  -0.97422742]
mat_Sqrt:  [[21.07029644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0020003   0.0094187   0.13179232]
Stock Position:  -0.002000302081735719
Bond Position:  [13.43285343]


portfolio before change:  [13.23475215]
curr_Stock_Price:  102.39422813905263
curr_Factors:  [102.39422814  -0.4320128   -1.00266202]
mat_Sqrt:  [[24.3895687   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02137069 -0.22805335  2.05250366]
Stock Position:  0.02137069035340934
Bond Position:  [11.0465168]


portfolio before change:  [13.21032563]
curr_Stock_Price:  100.99272188564713
curr_Factors:  [100.99272189  -0.5068869   -0.97246059]
mat_Sqrt:  [[23.00475562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00153047 -0.02755111  0.34758667]
Stock Position:  0.0015304694551074342
Bond Position:  [13.05575935]


portfolio before change:  [13.21712179]
curr_Stock_Price:  101.16694780119785
curr_Factors:  [101.1669478   -0.50739826  -0.92541796]
mat_Sqrt:  [[24.14206813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01360065 -0.14113358 -1.09442451]
Stock Position:  0.013600645983730687
Bond Position:  [11.84118595]


portfolio before change:  [13.22125841]
curr_Stock_Price:  101.03567103951404
curr_Factors:  [ 1.01035671e+02  2.34383609e-02 -9.48798606e-01]
mat_Sqrt:  [[40.04938782  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132192 -0.00408367  0.04333108]
Stock Position:  -0.0013219159887933028
Bond Position:  [13.35481908]


portfolio before change:  [13.22696017]
curr_Stock_Price:  101.77499077470625
curr_Factors:  [101.77499077  -0.73680615  -0.93710509]
mat_Sqrt:  [[19.08405479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00393262  0.00678361  0.13429973]
Stock Position:  -0.003932619886655516
Bond Position:  [13.62720253]


portfolio before change:  [13.23235437]
curr_Stock_Price:  102.1363547419941
curr_Factors:  [102.13635474  -0.88637289  -0.93176369]
mat_Sqrt:  [[16.57958564  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00800767 -0.00074342  0.50943248]
Stock Position:  -0.008007667274686582
Bond Position:  [14.05022832]


portfolio before change:  [13.23826702]
curr_Stock_Price:  102.27549966544599
curr_Factors:  [102.27549967  -0.89913813  -0.91132752]
mat_Sqrt:  [[16.73001647  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347907  0.02779191  0.56618462]
Stock Position:  -0.0034790720297481915
Bond Position:  [13.59409085]


portfolio before change:  [13.25626071]
curr_Stock_Price:  99.05770156089352
curr_Factors:  [99.05770156 -0.26046037 -0.96144447]
mat_Sqrt:  [[29.18916824  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00031442 -0.00573771  0.27555886]
Stock Position:  0.00031442160984815353
Bond Position:  [13.22511483]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.26214448]
Stock Price:  96.73455247246902
PL:  [13.26214448]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-5.36579378e-02  5.31057262e-02  4.98670726e-02]
 [ 3.88431090e-01 -4.41369240e-01  4.66635399e-01]
 [ 6.33546069e-02 -8.91934421e-02  1.02065439e-01]
 [ 5.21590875e-01 -4.65389227e-01 -3.59102727e-01]
 [-1.47663721e-01  1.09999397e-01 -1.21573637e-01]
 [-4.95360287e-02 -7.67477884e-02 -6.37662876e-02]
 [-2.30982801e-01 -2.63842374e-01  3.02793293e-01]
 [-1.16804186e-01  6.58247619e-02  1.51187152e-01]
 [-5.06364694e-03 -4.38089359e-02  1.51910049e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.97641466]
curr_Stock_Price:  100.86867948381557
curr_Factors:  [100.86867948  -1.37095741  -1.00875291]
mat_Sqrt:  [[ 9.33815927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0034952   0.0171398   0.14225688]
Stock Position:  -0.003495196681701226
Bond Position:  [9.32897054]


portfolio before change:  [8.98127236]
curr_Stock_Price:  100.81373346035595
curr_Factors:  [100.81373346  -1.77731077  -1.06213126]
mat_Sqrt:  [[ 5.89339691  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06678466 -0.14245131  1.33118091]
Stock Position:  0.06678466249925333
Bond Position:  [2.2484612]


portfolio before change:  [9.03755256]
curr_Stock_Price:  101.63960696872724
curr_Factors:  [101.63960697  -1.73509678  -1.03602894]
mat_Sqrt:  [[ 6.36177589  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01037165 -0.02878706  0.29116429]
Stock Position:  0.010371646766416514
Bond Position:  [7.98338246]


portfolio before change:  [9.04475206]
curr_Stock_Price:  101.94879724836436
curr_Factors:  [101.94879725  -1.0290899   -1.05215576]
mat_Sqrt:  [[12.72062951  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02777317 -0.15020373 -1.02442012]
Stock Position:  0.027773166382569422
Bond Position:  [6.21331115]


portfolio before change:  [9.09407822]
curr_Stock_Price:  103.61294755386686
curr_Factors:  [103.61294755  -1.27238453  -1.07293516]
mat_Sqrt:  [[ 9.9278368   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01511168  0.03550215 -0.34681575]
Stock Position:  -0.015111680993938935
Bond Position:  [10.65984403]


portfolio before change:  [9.07832941]
curr_Stock_Price:  105.0078989282666
curr_Factors:  [105.00789893  -1.17546118  -1.14223907]
mat_Sqrt:  [[10.34326235  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00756225 -0.02477024 -0.18190747]
Stock Position:  -0.007562250833012049
Bond Position:  [9.87242548]


portfolio before change:  [9.07884413]
curr_Stock_Price:  105.59274106787934
curr_Factors:  [105.59274107  -0.9942869   -1.14087967]
mat_Sqrt:  [[12.48369077  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01786587 -0.08515476  0.86378498]
Stock Position:  -0.017865868519849594
Bond Position:  [10.96535016]


portfolio before change:  [9.03969382]
curr_Stock_Price:  108.09104443883564
curr_Factors:  [108.09104444  -1.37346664  -1.15184948]
mat_Sqrt:  [[ 8.65085156  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00838147  0.02124485  0.43129486]
Stock Position:  -0.008381465513884107
Bond Position:  [9.94565518]


portfolio before change:  [9.04635162]
curr_Stock_Price:  107.89015696241663
curr_Factors:  [107.89015696  -1.35377748  -1.10022599]
mat_Sqrt:  [[ 9.27302991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00117602 -0.01413927  0.04333571]
Stock Position:  -0.0011760188147088844
Bond Position:  [9.17323248]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.05083844]
Stock Price:  107.97599416003989
PL:  [1.07484428]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-7.29536449e-02  6.40673079e-02  5.18853233e-02]
 [ 5.07545463e-01 -6.51399709e-01  6.81620425e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.58282365e-01 -5.10019953e-01 -2.47024550e-01]
 [-1.46436273e-01  1.08465789e-01 -1.15079130e-01]
 [-8.82569141e-02  1.93658965e-02  4.59970785e-02]
 [-1.16166098e-01 -1.60328909e-01  1.70661008e-01]
 [-1.12027725e-01  7.76742119e-02  1.91927283e-01]
 [-5.21407885e-02 -5.42739389e-02  3.71032194e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.43502472]
curr_Stock_Price:  101.68301899722907
curr_Factors:  [101.683019    -0.88437013  -1.02020511]
mat_Sqrt:  [[15.13916474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325546  0.02067763  0.14801439]
Stock Position:  -0.0032554578808553455
Bond Position:  [15.76604951]


portfolio before change:  [15.44052187]
curr_Stock_Price:  102.41651127576839
curr_Factors:  [102.41651128  -0.77295253  -1.01236436]
mat_Sqrt:  [[17.17974458  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02990232 -0.21023835  1.94447335]
Stock Position:  0.029902321197093143
Bond Position:  [12.37803045]


portfolio before change:  [15.44049163]
curr_Stock_Price:  102.20847385606282
curr_Factors:  [102.20847386  -0.56838135  -1.03072288]
mat_Sqrt:  [[20.65402786  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00170466 -0.02755111  0.34758667]
Stock Position:  0.001704659064315764
Bond Position:  [15.26626103]


portfolio before change:  [15.4521037]
curr_Stock_Price:  104.5415117245189
curr_Factors:  [104.54151172  -0.91482893  -1.0313089 ]
mat_Sqrt:  [[14.93110167  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02704096 -0.16460823 -0.70469228]
Stock Position:  0.027040958653988534
Bond Position:  [12.625201]


portfolio before change:  [15.43234699]
curr_Stock_Price:  103.57738597773458
curr_Factors:  [103.57738598  -1.01908536  -1.02571197]
mat_Sqrt:  [[13.40357813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01102588  0.03500718 -0.32828873]
Stock Position:  -0.011025877899971096
Bond Position:  [16.57437861]


portfolio before change:  [15.45779638]
curr_Stock_Price:  102.0210359132804
curr_Factors:  [102.02103591  -1.09548585  -1.04280783]
mat_Sqrt:  [[12.0237679   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00623056  0.00625032  0.13121686]
Stock Position:  -0.006230555453055449
Bond Position:  [16.0934441]


portfolio before change:  [15.47618688]
curr_Stock_Price:  100.36118933301177
curr_Factors:  [100.36118933  -0.95250501  -1.13615614]
mat_Sqrt:  [[12.43001876  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00917594 -0.05174593  0.48684835]
Stock Position:  -0.0091759368143329
Bond Position:  [16.39709481]


portfolio before change:  [15.4861661]
curr_Stock_Price:  100.16735373065424
curr_Factors:  [100.16735373  -0.56395257  -1.15701905]
mat_Sqrt:  [[17.9191631   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031807   0.02506924  0.54751512]
Stock Position:  -0.003180703817339479
Bond Position:  [15.80476879]


portfolio before change:  [15.49087992]
curr_Stock_Price:  101.17044672509384
curr_Factors:  [101.17044673  -1.19476861  -1.16493906]
mat_Sqrt:  [[ 9.55532906  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00582353 -0.01751684  0.10584516]
Stock Position:  -0.005823530151291543
Bond Position:  [16.08004907]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.50081053]
Stock Price:  100.84614577283743
PL:  [14.65466476]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.05823690e-02  9.20613081e-02  4.85431209e-02]
 [ 4.94390960e-01 -6.18251828e-01  6.52881418e-01]
 [-1.08421044e-01 -2.82476026e-02  1.02957954e-02]
 [ 4.12172479e-01 -3.51509475e-01 -3.71214773e-01]
 [-1.36484624e-01  9.83666176e-02 -1.15941275e-01]
 [-7.16761172e-02 -2.05408344e-02  1.50438574e-02]
 [-2.00248347e-01 -2.34101122e-03  2.05122314e-01]
 [-1.17054631e-01  7.87939218e-02  1.79730739e-01]
 [-1.36935928e-02 -4.55074191e-02  1.98481563e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.59621748]
curr_Stock_Price:  99.66170576453061
curr_Factors:  [99.66170576 -0.94409104 -1.00045866]
mat_Sqrt:  [[14.25676894  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00415824 0.02971266 0.13848001]
Stock Position:  0.004158244278263672
Bond Position:  [-1.0106352]


portfolio before change:  [-0.58435479]
curr_Stock_Price:  102.63607059633925
curr_Factors:  [102.6360706   -1.01354178  -0.98102462]
mat_Sqrt:  [[13.96596132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03590585 -0.19953992  1.86248896]
Stock Position:  0.03590584880081571
Bond Position:  [-4.26959002]


portfolio before change:  [-0.72395662]
curr_Stock_Price:  98.80754381117998
curr_Factors:  [98.80754381 -0.44810804 -0.89123929]
mat_Sqrt:  [[25.88921896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00432943 -0.00911687  0.02937104]
Stock Position:  -0.004329425381252727
Bond Position:  [-0.29617674]


portfolio before change:  [-0.72237637]
curr_Stock_Price:  98.40832748216307
curr_Factors:  [98.40832748 -0.8044906  -0.9427613 ]
mat_Sqrt:  [[17.14786256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01543324 -0.1134492  -1.05897242]
Stock Position:  0.015433235964454981
Bond Position:  [-2.24113531]


portfolio before change:  [-0.66583809]
curr_Stock_Price:  102.14436398701143
curr_Factors:  [102.14436399  -0.87678965  -0.96982735]
mat_Sqrt:  [[16.11531636  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00869186  0.03174769 -0.33074818]
Stock Position:  -0.008691857645490358
Bond Position:  [0.22198618]


portfolio before change:  [-0.67553811]
curr_Stock_Price:  103.2731269099567
curr_Factors:  [103.27312691  -0.77768174  -0.9338665 ]
mat_Sqrt:  [[18.64967951  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00390345 -0.00662953  0.04291594]
Stock Position:  -0.003903454903201626
Bond Position:  [-0.27241612]


portfolio before change:  [-0.67740791]
curr_Stock_Price:  103.71723402460628
curr_Factors:  [103.71723402  -0.89054248  -0.8870267 ]
mat_Sqrt:  [[17.53325064  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00906026 -0.00075556  0.58515687]
Stock Position:  -0.009060258705981497
Bond Position:  [0.26229707]


portfolio before change:  [-0.68006728]
curr_Stock_Price:  104.02523334994991
curr_Factors:  [104.02523335  -1.17757681  -0.86305739]
mat_Sqrt:  [[13.51769139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00475551  0.02543063  0.51272177]
Stock Position:  -0.0047555092026548935
Bond Position:  [-0.18537433]


portfolio before change:  [-0.69398807]
curr_Stock_Price:  106.93303479692985
curr_Factors:  [106.9330348   -0.86020082  -0.90548376]
mat_Sqrt:  [[18.29299538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103489 -0.01468746  0.05662127]
Stock Position:  -0.0010348916319685446
Bond Position:  [-0.58332396]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.69490671]
Stock Price:  107.53880297880903
PL:  [-8.23370968]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-9.12796042e-03  1.31369270e-02  4.07749425e-02]
 [ 4.98147351e-01 -7.56113797e-01  7.25550115e-01]
 [-5.39972909e-01  3.93823331e-02 -4.13799402e-01]
 [ 5.00645646e-01 -4.43957434e-01 -3.71575588e-01]
 [-7.18337276e-02  5.78629590e-02  4.88945833e-02]
 [-3.40508075e-02  7.22218438e-02 -9.95866629e-02]
 [-2.11914170e-01  1.18480572e-01  1.92412990e-01]
 [-8.03873696e-02  5.44298277e-02  2.32131613e-01]
 [-2.06312848e-02 -2.69685453e-02  9.19096878e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.39545749]
curr_Stock_Price:  101.04760074353452
curr_Factors:  [101.04760074  -0.47666374  -1.02304742]
mat_Sqrt:  [[22.55328062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [8.32142289e-05 4.23992496e-03 1.16319561e-01]
Stock Position:  8.32142289015177e-05
Bond Position:  [10.3870489]


portfolio before change:  [10.40068082]
curr_Stock_Price:  101.39018055489275
curr_Factors:  [ 1.01390181e+02  4.31611809e-02 -1.06678913e+00]
mat_Sqrt:  [[36.42838576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01350344 -0.24403468  2.06979252]
Stock Position:  0.013503441200774792
Bond Position:  [9.03156448]


portfolio before change:  [10.32143202]
curr_Stock_Price:  95.18689410204249
curr_Factors:  [95.1868941  -0.14042478 -1.04493566]
mat_Sqrt:  [[29.09254094  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02118758  0.01271059 -1.18045451]
Stock Position:  -0.02118757775960806
Bond Position:  [12.33821174]


portfolio before change:  [10.19266103]
curr_Stock_Price:  101.5557977869337
curr_Factors:  [101.55579779  -0.69304634  -1.03276036]
mat_Sqrt:  [[18.07991556  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01848325 -0.14328665 -1.06000173]
Stock Position:  0.018483253621631064
Bond Position:  [8.31557946]


portfolio before change:  [10.16438057]
curr_Stock_Price:  99.8007341419612
curr_Factors:  [99.80073414 -0.57446257 -0.99163485]
mat_Sqrt:  [[20.84424992  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00240075  0.01867519  0.13948264]
Stock Position:  -0.0024007549198344575
Bond Position:  [10.40397767]


portfolio before change:  [10.17553223]
curr_Stock_Price:  97.32302582497142
curr_Factors:  [97.32302582 -0.18767043 -0.97011121]
mat_Sqrt:  [[30.57717981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00129628  0.0233095  -0.28409303]
Stock Position:  -0.0012962813457919765
Bond Position:  [10.30169025]


portfolio before change:  [10.18046216]
curr_Stock_Price:  97.49444110560367
curr_Factors:  [97.49444111 -0.46171917 -0.93826126]
mat_Sqrt:  [[24.04230376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00617467  0.03823944  0.5489007 ]
Stock Position:  -0.006174669800072548
Bond Position:  [10.78245814]


portfolio before change:  [10.19772453]
curr_Stock_Price:  95.57210558535425
curr_Factors:  [95.57210559 -0.32908932 -0.86860008]
mat_Sqrt:  [[28.85235412  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007588   0.01756715  0.66220688]
Stock Position:  -0.0007588032616624096
Bond Position:  [10.27024495]


portfolio before change:  [10.20075824]
curr_Stock_Price:  98.34317575954967
curr_Factors:  [98.34317576 -0.8707026  -0.87704764]
mat_Sqrt:  [[17.12797194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004306  -0.00870406  0.26219276]
Stock Position:  -0.0004305956149511477
Bond Position:  [10.24310438]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.20511191]
Stock Price:  100.12944751232341
PL:  [10.0756644]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-7.24477672e-02  6.37799269e-02  5.18324106e-02]
 [ 4.09624734e-01 -6.57206734e-01  5.94487488e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.26461118e-01 -4.77156346e-01 -2.96216069e-01]
 [-1.12986113e-01  7.06647020e-02 -3.92387212e-02]
 [-2.76265727e-03 -1.93807198e-01 -2.08648133e-01]
 [-6.23885650e-01  1.20167267e-01  6.04629493e-01]
 [-1.14629116e-01  1.33353999e-01  3.17600643e-01]
 [-2.99202887e-02 -4.63346640e-02  2.03286572e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.75544017]
curr_Stock_Price:  101.5973329833398
curr_Factors:  [101.59733298  -0.86298208  -0.98073005]
mat_Sqrt:  [[16.07564113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303867  0.02058488  0.14786344]
Stock Position:  -0.0030386655947552696
Bond Position:  [15.06416049]


portfolio before change:  [14.76663776]
curr_Stock_Price:  100.39166354455668
curr_Factors:  [100.39166354  -0.33709745  -0.99998806]
mat_Sqrt:  [[26.36384769  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01505176 -0.21211256  1.69590733]
Stock Position:  0.015051756694191051
Bond Position:  [13.25556687]


portfolio before change:  [14.7752162]
curr_Stock_Price:  100.52115004700842
curr_Factors:  [100.52115005  -0.50341924  -0.95473554]
mat_Sqrt:  [[23.38777328  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00150541 -0.02755111  0.34758667]
Stock Position:  0.001505405212589047
Bond Position:  [14.62389114]


portfolio before change:  [14.78710781]
curr_Stock_Price:  103.56208045517445
curr_Factors:  [ 1.03562080e+02  6.83483014e-02 -9.48113848e-01]
mat_Sqrt:  [[42.96585357  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00857884 -0.15400155 -0.84502199]
Stock Position:  0.008578838872722417
Bond Position:  [13.89866541]


portfolio before change:  [14.78489829]
curr_Stock_Price:  102.49426800828185
curr_Factors:  [ 1.02494268e+02 -6.26257402e-02 -1.00067969e+00]
mat_Sqrt:  [[35.39255346  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00301112  0.02280693 -0.11193715]
Stock Position:  -0.003011122441127502
Bond Position:  [15.09352108]


portfolio before change:  [14.7755599]
curr_Stock_Price:  108.10248762514499
curr_Factors:  [108.10248763  -0.47408499  -1.02468664]
mat_Sqrt:  [[24.15057314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.003516   -0.062551   -0.59521505]
Stock Position:  -0.0035160038375606413
Bond Position:  [15.15564866]


portfolio before change:  [14.77359077]
curr_Stock_Price:  110.81831317157977
curr_Factors:  [ 1.10818313e+02 -1.06306338e-01 -1.04050477e+00]
mat_Sqrt:  [[35.20122687  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01352047  0.03878382  1.72483965]
Stock Position:  -0.013520469971000374
Bond Position:  [16.27190644]


portfolio before change:  [14.78339573]
curr_Stock_Price:  110.69502066832575
curr_Factors:  [ 1.10695021e+02 -8.98580771e-02 -1.08071831e+00]
mat_Sqrt:  [[34.33627835  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.57566457e-04  4.30398183e-02  9.06026231e-01]
Stock Position:  -0.0006575664572521314
Bond Position:  [14.85618506]


portfolio before change:  [14.79028885]
curr_Stock_Price:  111.51140837621703
curr_Factors:  [111.51140838  -0.47624055  -1.06574384]
mat_Sqrt:  [[23.85854668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00147657 -0.01495445  0.057992  ]
Stock Position:  -0.0014765669964054479
Bond Position:  [14.95494291]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.79381801]
Stock Price:  114.18665601604037
PL:  [0.60716199]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-8.97904759e-02  7.36320415e-02  5.36463858e-02]
 [ 4.97003346e-01 -5.83924991e-01  6.38049818e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.79043331e-01 -4.20398816e-01 -3.88946163e-01]
 [-1.06996825e-01  7.34457500e-02 -6.73009232e-02]
 [-6.18856915e-02 -4.51250147e-02 -1.63314569e-02]
 [-3.22079594e-01  3.66387202e-01  2.22470691e-01]
 [-1.14539997e-01  1.34244788e-01  3.20104807e-01]
 [-2.23688315e-02 -2.55957152e-02  2.08002178e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.34557589]
curr_Stock_Price:  101.79782664022903
curr_Factors:  [101.79782664  -1.41148511  -1.03167106]
mat_Sqrt:  [[ 8.84482537  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00721437  0.02376464  0.15303821]
Stock Position:  -0.007214373718114518
Bond Position:  [17.07998346]


portfolio before change:  [16.34999049]
curr_Stock_Price:  102.36995249674554
curr_Factors:  [102.3699525   -1.17668155  -1.03447527]
mat_Sqrt:  [[11.21706657  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04529273 -0.18846098  1.82017853]
Stock Position:  0.04529272668762609
Bond Position:  [11.71337621]


portfolio before change:  [16.28789134]
curr_Stock_Price:  100.86955032701826
curr_Factors:  [100.86955033  -1.11461603  -1.07780227]
mat_Sqrt:  [[11.26172493  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00312635 -0.02755111  0.34758667]
Stock Position:  0.003126348408772271
Bond Position:  [15.97253798]


portfolio before change:  [16.29590323]
curr_Stock_Price:  100.87710727642387
curr_Factors:  [100.87710728  -0.76350134  -1.08662791]
mat_Sqrt:  [[15.85958047  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01978845 -0.13568313 -1.10955514]
Stock Position:  0.019788447708909546
Bond Position:  [14.29970187]


portfolio before change:  [16.31110526]
curr_Stock_Price:  101.28392987338752
curr_Factors:  [101.28392987  -0.73030914  -1.07396441]
mat_Sqrt:  [[16.6707254   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00634301  0.02370451 -0.1919908 ]
Stock Position:  -0.006343006343765196
Bond Position:  [16.95354987]


portfolio before change:  [16.30359598]
curr_Stock_Price:  103.80452872286999
curr_Factors:  [103.80452872  -0.57803719  -1.08435946]
mat_Sqrt:  [[19.69004049  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00378011 -0.01456404 -0.0465891 ]
Stock Position:  -0.0037801060514939624
Bond Position:  [16.6959881]


portfolio before change:  [16.32360592]
curr_Stock_Price:  100.71999616865106
curr_Factors:  [100.71999617  -0.16563762  -1.05153509]
mat_Sqrt:  [[29.8197715   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00676999  0.11825096  0.63464696]
Stock Position:  -0.006769987481839817
Bond Position:  [17.00547903]


portfolio before change:  [16.30939036]
curr_Stock_Price:  104.07604678375345
curr_Factors:  [104.07604678   0.17343749  -1.15252624]
mat_Sqrt:  [[39.0965061   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.57499296e-04  4.33273189e-02  9.13169913e-01]
Stock Position:  -0.0005574992964883087
Bond Position:  [16.36741269]


portfolio before change:  [16.31181349]
curr_Stock_Price:  114.41261608687742
curr_Factors:  [ 1.14412616e+02  1.05785872e-01 -1.20293618e+00]
mat_Sqrt:  [[38.19333572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0006113  -0.00826098  0.05933723]
Stock Position:  -0.0006113031986228105
Bond Position:  [16.38175428]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.31919653]
Stock Price:  115.7374575891884
PL:  [0.58173894]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 7.30620113e-02  1.49836619e-01  5.14174216e-02]
 [ 3.79820620e-01 -6.47732051e-01  5.62322665e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.39573534e-01 -4.88315019e-01 -3.18243186e-01]
 [-1.34988554e-01  8.82254511e-02 -3.92143996e-02]
 [-5.35008575e-02 -6.67684075e-02 -5.07582866e-02]
 [-2.24178981e-01 -9.56843367e-02  2.42350843e-01]
 [-1.17524781e-01  1.04410298e-01  2.36234753e-01]
 [-4.33864431e-03 -4.14370600e-02  2.12905360e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.64365309]
curr_Stock_Price:  98.77312366620859
curr_Factors:  [98.77312367 -0.7235713  -0.99806768]
mat_Sqrt:  [[17.65795796  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0064641  0.04835956 0.14667959]
Stock Position:  0.006464100806476717
Bond Position:  [-8.28213251]


portfolio before change:  [-7.61311433]
curr_Stock_Price:  104.1382711589902
curr_Factors:  [104.13827116  -1.11927146  -1.05739231]
mat_Sqrt:  [[11.81128908  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03068137 -0.20905462  1.60415004]
Stock Position:  0.030681367627300993
Bond Position:  [-10.80821891]


portfolio before change:  [-7.64014169]
curr_Stock_Price:  103.43354711955521
curr_Factors:  [103.43354712  -0.81391156  -1.1139826 ]
mat_Sqrt:  [[15.04484173  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00234021 -0.02755111  0.34758667]
Stock Position:  0.002340209117743196
Bond Position:  [-7.88219782]


portfolio before change:  [-7.64471568]
curr_Stock_Price:  103.16352486867143
curr_Factors:  [103.16352487  -0.79165452  -1.09255687]
mat_Sqrt:  [[15.67557791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02391845 -0.15760299 -0.90785923]
Stock Position:  0.02391845018970908
Bond Position:  [-10.11222731]


portfolio before change:  [-7.59956714]
curr_Stock_Price:  105.26257071933296
curr_Factors:  [105.26257072  -1.68314315  -1.08366366]
mat_Sqrt:  [[ 6.61705953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01888818  0.02847464 -0.11186777]
Stock Position:  -0.018888180549215334
Bond Position:  [-5.6113487]


portfolio before change:  [-7.5939207]
curr_Stock_Price:  104.81505181327627
curr_Factors:  [104.81505181  -1.26165213  -1.04233961]
mat_Sqrt:  [[10.46677182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00740351 -0.02154941 -0.14479926]
Stock Position:  -0.007403514165563399
Bond Position:  [-6.81792098]


portfolio before change:  [-7.59514222]
curr_Stock_Price:  104.51947813652042
curr_Factors:  [104.51947814  -0.87379485  -1.01746778]
mat_Sqrt:  [[15.77002242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01231709 -0.03088199  0.6913595 ]
Stock Position:  -0.012317091264841406
Bond Position:  [-6.30776627]


portfolio before change:  [-7.58731505]
curr_Stock_Price:  103.62788431583817
curr_Factors:  [103.62788432  -0.61601483  -0.99457953]
mat_Sqrt:  [[20.70162271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00231822  0.03369828  0.673912  ]
Stock Position:  -0.0023182192749844977
Bond Position:  [-7.3470829]


portfolio before change:  [-7.59275029]
curr_Stock_Price:  104.38742218574532
curr_Factors:  [104.38742219  -0.90478902  -0.96307451]
mat_Sqrt:  [[16.12298125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00052416 -0.01337375  0.06073597]
Stock Position:  -0.0005241608960514739
Bond Position:  [-7.53803448]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.59705062]
Stock Price:  105.39927283147833
PL:  [-12.99632345]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-3.02788315e-02  1.18175667e-02  4.31443795e-02]
 [ 4.28515650e-01 -6.05091963e-01  5.85695182e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 3.01857880e-01 -2.64989341e-01 -2.26689815e-01]
 [-7.56787431e-02  1.01054162e-01  6.42200632e-02]
 [-5.11506382e-02  4.56142381e-02  1.87906238e-02]
 [-2.16240166e-01  1.71532668e-01  1.80156427e-01]
 [-1.16833058e-01  1.04927884e-01  2.39375722e-01]
 [-5.97710336e-03 -4.21146309e-02  2.11407729e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.06629407]
curr_Stock_Price:  100.7539261302897
curr_Factors:  [100.75392613  -0.54835927  -1.0007151 ]
mat_Sqrt:  [[21.4046201   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00089045  0.0038141   0.12307891]
Stock Position:  -0.0008904512720930682
Bond Position:  [8.15601053]


portfolio before change:  [8.07027411]
curr_Stock_Price:  100.8650824062421
curr_Factors:  [100.86508241  -0.78426563  -0.99100115]
mat_Sqrt:  [[17.09040207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0248418  -0.19529259  1.67082533]
Stock Position:  0.024841797000002813
Bond Position:  [5.56460421]


portfolio before change:  [8.05831793]
curr_Stock_Price:  100.27176061418933
curr_Factors:  [100.27176061  -0.73071771  -0.96894889]
mat_Sqrt:  [[18.32410692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00192141 -0.02755111  0.34758667]
Stock Position:  0.0019214074635459228
Bond Position:  [7.86565502]


portfolio before change:  [8.05367875]
curr_Stock_Price:  95.80993333942214
curr_Factors:  [95.80993334 -0.50265592 -0.97143273]
mat_Sqrt:  [[21.93925998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00918419 -0.08552494 -0.64668294]
Stock Position:  0.009184188217888306
Bond Position:  [7.17374229]


portfolio before change:  [8.08341796]
curr_Stock_Price:  98.65737430353492
curr_Factors:  [98.6573743  -1.34824661 -0.97548579]
mat_Sqrt:  [[ 9.65929416  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00434217  0.03261509  0.18320197]
Stock Position:  -0.004342168523896077
Bond Position:  [8.5118049]


portfolio before change:  [8.0845031]
curr_Stock_Price:  99.38784492197645
curr_Factors:  [99.38784492 -1.03954335 -1.0278764 ]
mat_Sqrt:  [[12.57373448  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0030225   0.01472193  0.05360442]
Stock Position:  -0.00302249509544322
Bond Position:  [8.38490237]


portfolio before change:  [8.0906375]
curr_Stock_Price:  98.7456930725143
curr_Factors:  [98.74569307 -0.5278944  -1.04665466]
mat_Sqrt:  [[20.45032403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00706355  0.05536193  0.51393614]
Stock Position:  -0.0070635521465818455
Bond Position:  [8.78813285]


portfolio before change:  [8.07041206]
curr_Stock_Price:  102.23127664776979
curr_Factors:  [102.23127665  -0.47488807  -1.06375014]
mat_Sqrt:  [[21.94631982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00212119  0.03386533  0.68287231]
Stock Position:  -0.0021211929372389553
Bond Position:  [8.28726432]


portfolio before change:  [8.06929047]
curr_Stock_Price:  104.71396528792218
curr_Factors:  [104.71396529  -0.86328324  -1.02325808]
mat_Sqrt:  [[15.87413689  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064623 -0.01359244  0.06030874]
Stock Position:  -0.0006462319354558636
Bond Position:  [8.13695998]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.07396393]
Stock Price:  103.77937586955245
PL:  [4.29458806]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.85614206e-03  6.85311525e-02  4.79001148e-02]
 [ 2.54749246e-01 -2.65213916e-01  3.28549110e-01]
 [-4.17171478e-01  4.21568078e-02 -3.59671107e-01]
 [ 2.83985373e-01 -2.52151100e-01 -2.02116016e-01]
 [ 2.98064464e-01 -1.55785642e-01  2.06359459e-01]
 [ 1.88281706e-01  2.33849590e-02 -2.84921903e-01]
 [-1.56625486e-01 -1.33955785e-01  2.10317876e-01]
 [-4.13161074e-02 -1.16659899e-02  1.97366944e-01]
 [ 1.89411280e-01  1.33766991e-01  1.35015937e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.42769523]
curr_Stock_Price:  99.6829540407735
curr_Factors:  [99.68295404 -1.54465453 -1.0034178 ]
mat_Sqrt:  [[ 7.79842945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00354207 0.02211833 0.13664569]
Stock Position:  0.003542068970518654
Bond Position:  [-0.78077913]


portfolio before change:  [-0.43167598]
curr_Stock_Price:  98.66934779857877
curr_Factors:  [98.6693478  -0.43309181 -1.01307529]
mat_Sqrt:  [[23.23377966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01152105 -0.08559742  0.93725916]
Stock Position:  0.011521047901943554
Bond Position:  [-1.56845026]


portfolio before change:  [-0.46195819]
curr_Stock_Price:  96.10900871817088
curr_Factors:  [96.10900872  0.11669861 -0.97736929]
mat_Sqrt:  [[40.64242096  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01185913  0.01360605 -1.02604156]
Stock Position:  -0.011859131471506348
Bond Position:  [0.67781118]


portfolio before change:  [-0.45532801]
curr_Stock_Price:  95.57851506791117
curr_Factors:  [95.57851507 -0.39434012 -1.05549432]
mat_Sqrt:  [[22.423592    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00852934 -0.08138142 -0.57658073]
Stock Position:  0.008529342075220561
Bond Position:  [-1.27054986]


portfolio before change:  [-0.48708667]
curr_Stock_Price:  91.92955427964709
curr_Factors:  [91.92955428 -0.31572623 -0.97085494]
mat_Sqrt:  [[25.3921837   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01214499 -0.0502796   0.5886861 ]
Stock Position:  0.012144989361503883
Bond Position:  [-1.60357013]


portfolio before change:  [-0.50491386]
curr_Stock_Price:  90.52772505301502
curr_Factors:  [90.52772505 -0.33270748 -0.98685458]
mat_Sqrt:  [[24.19374437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00557564  0.00754746 -0.81280288]
Stock Position:  0.005575643805220942
Bond Position:  [-1.00966421]


portfolio before change:  [-0.49659481]
curr_Stock_Price:  92.11032351188427
curr_Factors:  [92.11032351 -0.30636268 -0.97492822]
mat_Sqrt:  [[25.5770669   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00551424 -0.04323404  0.59997836]
Stock Position:  -0.0055142421034053085
Bond Position:  [0.01132381]


portfolio before change:  [-0.48208542]
curr_Stock_Price:  89.48009297089878
curr_Factors:  [89.48009297 -0.75051829 -0.99148883]
mat_Sqrt:  [[15.67409046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.17560243e-04 -3.76518206e-03  5.63032954e-01]
Stock Position:  -0.00021756024348682936
Bond Position:  [-0.46261811]


portfolio before change:  [-0.4823572]
curr_Stock_Price:  89.66583404674793
curr_Factors:  [89.66583405 -0.75666869 -1.06040282]
mat_Sqrt:  [[14.57078215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01676481 0.04317311 0.38516289]
Stock Position:  0.016764808030117217
Bond Position:  [-1.98558769]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.5131539]
Stock Price:  87.88808249270033
PL:  [-0.5131539]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 2.09200260e-02  8.35544420e-02  4.83106547e-02]
 [ 4.57901734e-01 -5.38188870e-01  5.79129731e-01]
 [ 9.16964296e-03 -6.50185342e-02  7.39018953e-02]
 [ 5.77868149e-01 -5.23151751e-01 -3.05996887e-01]
 [-1.49846544e-01  1.11905992e-01 -1.31009044e-01]
 [-8.51470687e-02  1.19558384e-02  4.11507346e-02]
 [-1.27265121e-01  5.56366029e-02  1.69108914e-01]
 [-1.12796546e-01  8.30950219e-02  2.01912522e-01]
 [-4.83132937e-02 -4.63436271e-02  8.50239781e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.22256361]
curr_Stock_Price:  99.76494249638317
curr_Factors:  [99.7649425  -0.96166968 -0.98781905]
mat_Sqrt:  [[14.20122333  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0033685  0.02696708 0.13781685]
Stock Position:  0.0033685039025757872
Bond Position:  [-0.11349499]


portfolio before change:  [0.22841858]
curr_Stock_Price:  101.51994490070238
curr_Factors:  [101.5199449   -1.30502996  -0.99946352]
mat_Sqrt:  [[10.13263895  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04601553 -0.17369971  1.65209593]
Stock Position:  0.046015530025305666
Bond Position:  [-4.44307549]


portfolio before change:  [0.26406184]
curr_Stock_Price:  102.34282693194136
curr_Factors:  [102.34282693  -1.43937636  -0.98527009]
mat_Sqrt:  [[ 9.05830281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00121247 -0.02098464  0.21082154]
Stock Position:  0.001212473427977367
Bond Position:  [0.13997388]


portfolio before change:  [0.26528817]
curr_Stock_Price:  103.29651703170931
curr_Factors:  [103.29651703  -1.43073585  -0.92612195]
mat_Sqrt:  [[ 9.78397512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0417641  -0.1688465  -0.87292395]
Stock Position:  0.04176409760017483
Bond Position:  [-4.04879765]


portfolio before change:  [0.24396226]
curr_Stock_Price:  102.83437369656541
curr_Factors:  [102.8343737   -0.80348112  -0.88592954]
mat_Sqrt:  [[18.98613558  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0080978   0.0361175  -0.37373234]
Stock Position:  -0.008097800470722142
Bond Position:  [1.0766945]


portfolio before change:  [0.24908864]
curr_Stock_Price:  102.26781260877956
curr_Factors:  [102.26781261  -0.93466979  -0.85938388]
mat_Sqrt:  [[17.00557642  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00436955  0.00385873  0.11739159]
Stock Position:  -0.0043695510843342915
Bond Position:  [0.69595307]


portfolio before change:  [0.26286822]
curr_Stock_Price:  99.19392472331721
curr_Factors:  [99.19392472 -0.90392123 -0.80879242]
mat_Sqrt:  [[17.89216881  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00454887  0.01795664  0.48242066]
Stock Position:  -0.004548869165033744
Bond Position:  [0.7140884]


portfolio before change:  [0.25812631]
curr_Stock_Price:  100.31487220760403
curr_Factors:  [100.31487221  -0.67466534  -0.87948049]
mat_Sqrt:  [[21.20353978  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257597  0.0268188   0.57600022]
Stock Position:  -0.002575967290875957
Bond Position:  [0.51653414]


portfolio before change:  [0.26096098]
curr_Stock_Price:  99.3147283241488
curr_Factors:  [99.31472832 -0.95769242 -0.90335105]
mat_Sqrt:  [[15.44446069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00261697 -0.01495734  0.24254974]
Stock Position:  -0.002616970635206642
Bond Position:  [0.5208647]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.25590786]
Stock Price:  101.34517287975417
PL:  [-1.08926502]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.35929431e-02  9.47118610e-02  4.86155523e-02]
 [ 4.06954594e-01 -5.27937596e-01  5.27131787e-01]
 [ 6.04286988e-03 -6.39039571e-02  7.23239604e-02]
 [ 5.18756939e-01 -4.58762715e-01 -3.79583782e-01]
 [-1.41452171e-01  1.22463647e-01 -1.36310297e-01]
 [-6.67575883e-02 -3.31268499e-02 -3.73954127e-03]
 [-2.86383692e-01  2.31497562e-02  2.64512455e-01]
 [-1.17262736e-01  8.95704788e-02  2.03448666e-01]
 [-9.03484331e-03 -4.24786567e-02  2.34832221e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.50296446]
curr_Stock_Price:  99.547377776783
curr_Factors:  [99.54737778 -1.11144528 -1.01654572]
mat_Sqrt:  [[11.8537312   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00530209 0.03056812 0.13868664]
Stock Position:  0.0053020882443353895
Bond Position:  [-2.03077344]


portfolio before change:  [-1.49733507]
curr_Stock_Price:  100.80066317147815
curr_Factors:  [100.80066317  -1.24664888  -1.05245862]
mat_Sqrt:  [[10.11518169  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0402158  -0.17039113  1.50376026]
Stock Position:  0.0402157985478981
Bond Position:  [-5.55111423]


portfolio before change:  [-1.4615915]
curr_Stock_Price:  101.75849139836271
curr_Factors:  [101.7584914   -1.43452464  -1.08444233]
mat_Sqrt:  [[ 8.1959104   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00094701 -0.02062491  0.20632013]
Stock Position:  0.0009470083846521303
Bond Position:  [-1.55795764]


portfolio before change:  [-1.46286537]
curr_Stock_Price:  101.2361119040124
curr_Factors:  [101.2361119   -1.6349332   -1.06988106]
mat_Sqrt:  [[ 6.77094911  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05134143 -0.14806503 -1.08284687]
Stock Position:  0.051341425089442456
Bond Position:  [-6.66047162]


portfolio before change:  [-1.44221666]
curr_Stock_Price:  101.70317666632745
curr_Factors:  [101.70317667  -1.23656445  -1.05981613]
mat_Sqrt:  [[10.23361572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0140985   0.03952497 -0.38885534]
Stock Position:  -0.014098497606130874
Bond Position:  [-0.00835467]


portfolio before change:  [-1.4692988]
curr_Stock_Price:  103.62380410506583
curr_Factors:  [103.62380411  -0.89642279  -1.08332744]
mat_Sqrt:  [[14.31083362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00519068 -0.01069164 -0.01066787]
Stock Position:  -0.005190676580875442
Bond Position:  [-0.93142115]


portfolio before change:  [-1.47365983]
curr_Stock_Price:  104.37422604942722
curr_Factors:  [104.37422605  -0.66612675  -1.04033428]
mat_Sqrt:  [[18.94465312  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01201737  0.00747155  0.75458041]
Stock Position:  -0.012017369085544873
Bond Position:  [-0.21935623]


portfolio before change:  [-1.49434371]
curr_Stock_Price:  106.08626236079988
curr_Factors:  [106.08626236  -0.91219305  -1.08679843]
mat_Sqrt:  [[14.37170119  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00399747  0.02890875  0.58038241]
Stock Position:  -0.003997470620274527
Bond Position:  [-1.07026699]


portfolio before change:  [-1.4874604]
curr_Stock_Price:  104.23044621788031
curr_Factors:  [104.23044622  -0.61348232  -1.12281509]
mat_Sqrt:  [[18.36243246  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00070319 -0.01370993  0.0669911 ]
Stock Position:  -0.0007031895249357234
Bond Position:  [-1.41416665]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.48647084]
Stock Price:  101.81740706547883
PL:  [-3.30387791]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 1.34007603e-01 -7.87290735e-03  2.47383353e-02]
 [ 4.03289544e-01 -6.52444202e-01  5.86270563e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.00798001e-01 -4.41564894e-01 -3.84336265e-01]
 [-8.05924281e-02  2.08012001e-02 -2.75722815e-02]
 [-8.29733547e-02  6.77636951e-03  3.77632460e-02]
 [-3.02931537e-01  1.87631850e-01  2.44883410e-01]
 [-1.15447304e-01  1.25175777e-01  2.94610207e-01]
 [-2.62319857e-02 -5.03413268e-02  1.97247983e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.51192031]
curr_Stock_Price:  100.93619918321912
curr_Factors:  [ 1.00936199e+02 -3.50692124e-02 -1.03088283e+00]
mat_Sqrt:  [[34.76240841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00395399 -0.00254097  0.07057158]
Stock Position:  0.00395399084060385
Bond Position:  [9.11281951]


portfolio before change:  [9.51383003]
curr_Stock_Price:  100.26653784475329
curr_Factors:  [100.26653784  -0.23858244  -0.99247894]
mat_Sqrt:  [[29.27607534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01331401 -0.21057546  1.67246673]
Stock Position:  0.013314008196117577
Bond Position:  [8.17888052]


portfolio before change:  [9.55575143]
curr_Stock_Price:  103.10797693802424
curr_Factors:  [103.10797694  -0.44907925  -1.00806497]
mat_Sqrt:  [[24.01389311  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00146615 -0.02755111  0.34758667]
Stock Position:  0.0014661544312443925
Bond Position:  [9.40457922]


portfolio before change:  [9.55755586]
curr_Stock_Price:  101.1306711675927
curr_Factors:  [101.13067117  -0.73689282  -0.94078234]
mat_Sqrt:  [[18.89199508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01758478 -0.14251446 -1.09640439]
Stock Position:  0.01758478295212369
Bond Position:  [7.77919496]


portfolio before change:  [9.56757557]
curr_Stock_Price:  101.4792191597336
curr_Factors:  [101.47921916  -0.22521114  -0.9026399 ]
mat_Sqrt:  [[32.85168375  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249529  0.00671356 -0.07865604]
Stock Position:  -0.002495292782298789
Bond Position:  [9.82079594]


portfolio before change:  [9.57110454]
curr_Stock_Price:  102.03332807005688
curr_Factors:  [102.03332807  -0.35137305  -0.94929949]
mat_Sqrt:  [[27.78863063  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0026587   0.00218706  0.10772803]
Stock Position:  -0.0026587040104877418
Bond Position:  [9.84238095]


portfolio before change:  [9.57186094]
curr_Stock_Price:  103.60026166788273
curr_Factors:  [103.60026167  -0.55957075  -0.91528457]
mat_Sqrt:  [[23.70496532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00905484  0.06055792  0.69858421]
Stock Position:  -0.009054842580375347
Bond Position:  [10.509945]


portfolio before change:  [9.56598976]
curr_Stock_Price:  104.82915881537913
curr_Factors:  [104.82915882  -0.20795167  -0.90608697]
mat_Sqrt:  [[34.40814553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00086488  0.04040031  0.84044092]
Stock Position:  -0.0008648780161666545
Bond Position:  [9.6566542]


portfolio before change:  [9.5661489]
curr_Stock_Price:  110.22921873429283
curr_Factors:  [110.22921873  -0.66665948  -0.8441536 ]
mat_Sqrt:  [[24.33094333  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00133499 -0.01624759  0.05626936]
Stock Position:  -0.0013349896858399644
Bond Position:  [9.71330377]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.56939184]
Stock Price:  111.4389125577048
PL:  [-1.86952072]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 1.86673072e-02  8.15711159e-02  4.82564565e-02]
 [ 2.94971367e-01 -3.83834609e-01  4.04865397e-01]
 [-2.29823738e-01  2.82825951e-02 -1.60940524e-01]
 [ 3.94930770e-01 -3.34766781e-01 -3.60862954e-01]
 [-6.87009924e-02  1.00731897e-01  8.09631793e-02]
 [-2.83249883e-02  6.66999429e-02 -7.12459788e-02]
 [-1.21712731e-01 -6.95263835e-02  1.67489981e-01]
 [-1.09646098e-01  5.24645123e-02  1.41993763e-01]
 [-6.76618264e-02 -5.61073820e-02  7.27667688e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.52699312]
curr_Stock_Price:  99.92941263598976
curr_Factors:  [99.92941264 -0.76176547 -0.99035136]
mat_Sqrt:  [[17.32840801  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0026066  0.02632696 0.13766224]
Stock Position:  0.0026066012192623327
Bond Position:  [1.266517]


portfolio before change:  [1.52586255]
curr_Stock_Price:  99.25267422731719
curr_Factors:  [99.25267423 -0.87677922 -1.01404224]
mat_Sqrt:  [[14.98196887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01997496 -0.12388209  1.15496829]
Stock Position:  0.019974961975309846
Bond Position:  [-0.45670584]


portfolio before change:  [1.49986797]
curr_Stock_Price:  97.96275073847818
curr_Factors:  [97.96275074 -1.1729829  -1.00185813]
mat_Sqrt:  [[11.13113661  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02307962  0.00912817 -0.45911852]
Stock Position:  -0.023079621938618667
Bond Position:  [3.76081122]


portfolio before change:  [1.50258675]
curr_Stock_Price:  97.92644578657733
curr_Factors:  [97.92644579 -1.24011854 -0.927935  ]
mat_Sqrt:  [[11.2027928   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02257794 -0.10804551 -1.02944156]
Stock Position:  0.02257793659374135
Bond Position:  [-0.70839033]


portfolio before change:  [1.50881326]
curr_Stock_Price:  98.21791592110426
curr_Factors:  [98.21791592 -1.51575775 -0.9504541 ]
mat_Sqrt:  [[ 8.33927919  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00379081  0.03251108  0.23096541]
Stock Position:  -0.003790812085459785
Bond Position:  [1.88113892]


portfolio before change:  [1.51224779]
curr_Stock_Price:  97.5600824747106
curr_Factors:  [97.56008247 -1.01727365 -1.06594352]
mat_Sqrt:  [[12.14905333  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00240784  0.02152731 -0.20324495]
Stock Position:  -0.0024078373139714538
Bond Position:  [1.7471566]


portfolio before change:  [1.51200582]
curr_Stock_Price:  98.023473622033
curr_Factors:  [98.02347362 -0.8134385  -1.15341697]
mat_Sqrt:  [[13.71309905  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00741743 -0.02243954  0.4778023 ]
Stock Position:  -0.00741743315242171
Bond Position:  [2.23908838]


portfolio before change:  [1.50290663]
curr_Stock_Price:  99.40117520687713
curr_Factors:  [99.40117521 -0.86683586 -1.16963129]
mat_Sqrt:  [[12.9707496   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00539309  0.01693285  0.40506868]
Stock Position:  -0.00539309373439503
Bond Position:  [2.03898649]


portfolio before change:  [1.49905016]
curr_Stock_Price:  100.30533484291074
curr_Factors:  [100.30533484  -0.92410557  -1.15966213]
mat_Sqrt:  [[12.48404189  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00514747 -0.01810858  0.20758334]
Stock Position:  -0.005147470978482089
Bond Position:  [2.01536896]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.50528184]
Stock Price:  99.2905178253406
PL:  [1.50528184]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 6.54638177e-02  1.34181242e-01  5.00741530e-02]
 [ 2.04133372e-01 -1.15940582e-01  2.32512015e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.13431139e-01 -3.51220034e-01 -3.86431125e-01]
 [-7.88544748e-02  1.09922054e-01  3.63265406e-02]
 [-2.51649857e-02  5.74054434e-02 -3.18578381e-02]
 [-9.21189613e-03 -2.45936021e-01  1.81396937e-01]
 [-1.10127321e-01  4.08826282e-02  1.14438756e-01]
 [-4.66756000e-02 -5.28792614e-02  3.50829416e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.18983694]
curr_Stock_Price:  98.95642934956935
curr_Factors:  [98.95642935 -0.55960608 -0.95778835]
mat_Sqrt:  [[21.69941315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00475012 0.04330681 0.14284762]
Stock Position:  0.0047501189099229055
Bond Position:  [-6.65989175]


portfolio before change:  [-6.19651813]
curr_Stock_Price:  98.25109866941285
curr_Factors:  [98.25109867 -0.76792668 -1.03543552]
mat_Sqrt:  [[16.18628435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01408158 -0.03741966  0.66329206]
Stock Position:  0.014081577409517139
Bond Position:  [-7.58004858]


portfolio before change:  [-6.1810637]
curr_Stock_Price:  99.61780625231488
curr_Factors:  [99.61780625 -1.14086088 -1.10148586]
mat_Sqrt:  [[10.58030424  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0033277  -0.02755111  0.34758667]
Stock Position:  0.003327699751965723
Bond Position:  [-6.51256185]


portfolio before change:  [-6.18693443]
curr_Stock_Price:  98.83238804321574
curr_Factors:  [98.83238804 -1.30730654 -1.12455069]
mat_Sqrt:  [[ 8.68474578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03026672 -0.11335578 -1.10238044]
Stock Position:  0.03026671516812722
Bond Position:  [-9.17826617]


portfolio before change:  [-6.2011346]
curr_Stock_Price:  98.5148811549257
curr_Factors:  [98.51488115 -1.78667797 -1.0450278 ]
mat_Sqrt:  [[ 5.80373594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00844311  0.03547719  0.10362951]
Stock Position:  -0.008443114216098915
Bond Position:  [-5.36936221]


portfolio before change:  [-6.20140305]
curr_Stock_Price:  98.2286235590086
curr_Factors:  [98.22862356 -1.40924361 -1.06387183]
mat_Sqrt:  [[ 8.28280942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00240862  0.01852753 -0.09088154]
Stock Position:  -0.0024086154315149954
Bond Position:  [-5.96480807]


portfolio before change:  [-6.20288664]
curr_Stock_Price:  97.60604479535726
curr_Factors:  [97.6060448  -1.42792901 -1.06055805]
mat_Sqrt:  [[ 8.1047666   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00276206 -0.07937551  0.51747497]
Stock Position:  -0.0027620636779064718
Bond Position:  [-5.93329253]


portfolio before change:  [-6.21214463]
curr_Stock_Price:  99.88354236072148
curr_Factors:  [99.88354236 -1.21000422 -1.05534746]
mat_Sqrt:  [[10.36726509  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00756443  0.01319481  0.32646192]
Stock Position:  -0.007564432407697198
Bond Position:  [-5.45658232]


portfolio before change:  [-6.22542888]
curr_Stock_Price:  101.27892481255935
curr_Factors:  [101.27892481  -1.33400442  -1.11422085]
mat_Sqrt:  [[ 8.75524605  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00574607 -0.01706671  0.10008187]
Stock Position:  -0.005746070216365679
Bond Position:  [-5.64347306]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.23453837]
Stock Price:  102.37307269286248
PL:  [-8.60761106]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 2.27048022e-02  3.57967031e-02  4.22577418e-02]
 [ 4.20122403e-01 -6.72574043e-01  6.11856432e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.36488429e-01 -4.95789176e-01 -1.73591212e-01]
 [-1.30521869e-01  7.79927369e-02 -3.59772310e-03]
 [-2.93343290e-02 -1.26773339e-01 -1.19499267e-01]
 [-3.87371299e-01 -9.66236270e-02  3.84233831e-01]
 [-1.16229170e-01  1.17360607e-01  2.72640374e-01]
 [-1.32916232e-02 -4.38712805e-02  2.41648657e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.25899191]
curr_Stock_Price:  99.45205339250734
curr_Factors:  [99.45205339 -0.42710674 -1.03061608]
mat_Sqrt:  [[23.14902884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00166908 0.01155334 0.12054957]
Stock Position:  0.0016690807763813178
Bond Position:  [-2.42498542]


portfolio before change:  [-2.25845931]
curr_Stock_Price:  100.49777519514578
curr_Factors:  [100.4977752   -0.27129255  -1.04522363]
mat_Sqrt:  [[26.94019514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01513458 -0.21707234  1.74545609]
Stock Position:  0.015134577558894748
Bond Position:  [-3.77945069]


portfolio before change:  [-2.25838575]
curr_Stock_Price:  100.62752834970989
curr_Factors:  [100.62752835  -0.37406783  -1.07080102]
mat_Sqrt:  [[23.72565656  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00148397 -0.02755111  0.34758667]
Stock Position:  0.0014839663428037823
Bond Position:  [-2.40771362]


portfolio before change:  [-2.25151254]
curr_Stock_Price:  106.0706204578245
curr_Factors:  [106.07062046  -0.22697116  -1.11697285]
mat_Sqrt:  [[27.66480678  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01445344 -0.16001527 -0.49520741]
Stock Position:  0.014453443765999012
Bond Position:  [-3.78459829]


portfolio before change:  [-2.25923661]
curr_Stock_Price:  105.66716659332926
curr_Factors:  [105.66716659  -0.74062975  -1.17640161]
mat_Sqrt:  [[15.53759944  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00742303  0.02517205 -0.0102633 ]
Stock Position:  -0.007423028917286107
Bond Position:  [-1.47486618]


portfolio before change:  [-2.26175445]
curr_Stock_Price:  105.90699040317614
curr_Factors:  [105.9069904   -0.15669198  -1.17894184]
mat_Sqrt:  [[27.85263135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00285806 -0.04091592 -0.34089815]
Stock Position:  -0.002858060813938453
Bond Position:  [-1.95906583]


portfolio before change:  [-2.26563717]
curr_Stock_Price:  106.92269379249733
curr_Factors:  [106.92269379  -0.56210889  -1.20043475]
mat_Sqrt:  [[18.3487683   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.017912   -0.03118514  1.09611217]
Stock Position:  -0.017911998604569716
Bond Position:  [-0.35043803]


portfolio before change:  [-2.23795012]
curr_Stock_Price:  105.36718289662336
curr_Factors:  [105.3671829   -0.24001833  -1.20207019]
mat_Sqrt:  [[24.91232606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146998  0.03787797  0.7777671 ]
Stock Position:  -0.0014699772943197003
Bond Position:  [-2.08306276]


portfolio before change:  [-2.23799855]
curr_Stock_Price:  104.69141459474274
curr_Factors:  [104.69141459  -0.43171355  -1.20973633]
mat_Sqrt:  [[20.2786221   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085381 -0.01415939  0.06893564]
Stock Position:  -0.0008538143393937122
Bond Position:  [-2.14861152]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.23760643]
Stock Price:  102.97360062230445
PL:  [-5.21120706]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-2.53653147e-02  4.30696807e-02  4.73269122e-02]
 [ 4.76362324e-01 -6.01816181e-01  6.28050596e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.50937954e-01 -3.84252935e-01 -4.09107989e-01]
 [-6.05027782e-02  8.70499032e-02  1.31559794e-01]
 [-2.05876386e-02  7.98101507e-02 -1.28478341e-01]
 [-9.37922261e-02 -7.53124642e-02  1.72794185e-01]
 [-9.95579060e-02  4.06565673e-02  1.44887135e-01]
 [-4.68549202e-02 -5.27177563e-02  3.69502099e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.39279997]
curr_Stock_Price:  100.29075040549864
curr_Factors:  [100.29075041  -1.01050155  -0.93741141]
mat_Sqrt:  [[14.29858408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048349  0.01390068  0.13501051]
Stock Position:  -0.00048348755190608187
Bond Position:  [4.4412893]


portfolio before change:  [4.39439667]
curr_Stock_Price:  101.58241761409168
curr_Factors:  [101.58241761  -0.92641993  -0.97229175]
mat_Sqrt:  [[15.21312869  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03166458 -0.19423534  1.79165353]
Stock Position:  0.03166458465054326
Bond Position:  [1.1778316]


portfolio before change:  [4.48061269]
curr_Stock_Price:  104.2866045714164
curr_Factors:  [104.28660457  -0.50209143  -0.94161437]
mat_Sqrt:  [[24.6169966   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00143023 -0.02755111  0.34758667]
Stock Position:  0.0014302344176489732
Bond Position:  [4.33145839]


portfolio before change:  [4.47556488]
curr_Stock_Price:  99.24262121330568
curr_Factors:  [99.24262121 -0.77225331 -0.88475065]
mat_Sqrt:  [[18.92651052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01526926 -0.1240171  -1.16707122]
Stock Position:  0.01526926125463361
Bond Position:  [2.96020337]


portfolio before change:  [4.45851824]
curr_Stock_Price:  98.02926150288579
curr_Factors:  [98.0292615  -0.60837053 -0.84333932]
mat_Sqrt:  [[22.9554682   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069174  0.02809524  0.37530347]
Stock Position:  -0.000691741963879374
Bond Position:  [4.5263292]


portfolio before change:  [4.46168291]
curr_Stock_Price:  96.72684674887446
curr_Factors:  [96.72684675 -0.71541798 -0.90771766]
mat_Sqrt:  [[19.08218829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0015995   0.02575862 -0.36651294]
Stock Position:  -0.0015995016295128205
Bond Position:  [4.61639766]


portfolio before change:  [4.46596398]
curr_Stock_Price:  95.49377756496877
curr_Factors:  [95.49377756 -0.78509967 -0.95467094]
mat_Sqrt:  [[16.76495133  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00440764 -0.02430699  0.49293371]
Stock Position:  -0.004407638994150494
Bond Position:  [4.88686608]


portfolio before change:  [4.4546012]
curr_Stock_Price:  98.6262541699406
curr_Factors:  [98.62625417 -1.03444725 -0.9702446 ]
mat_Sqrt:  [[13.2851337   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00464308  0.01312185  0.41332267]
Stock Position:  -0.004643081335131615
Bond Position:  [4.91253092]


portfolio before change:  [4.44548166]
curr_Stock_Price:  101.11951696551725
curr_Factors:  [101.11951697  -1.36277931  -0.94171917]
mat_Sqrt:  [[10.09262215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00496139 -0.01701458  0.10540866]
Stock Position:  -0.0049613922329791735
Bond Position:  [4.94717524]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.44636798]
Stock Price:  101.43956483887928
PL:  [3.00680314]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 1.21013039e-01 -1.09105837e-01  2.77077560e-02]
 [ 1.04449441e-01  1.52101583e-01  5.67930991e-02]
 [-4.24020286e-01  4.20020714e-02 -3.62689918e-01]
 [ 4.38715162e-01 -3.73300539e-01 -4.00176408e-01]
 [-6.09079985e-02  8.01924055e-02  1.27507935e-01]
 [-3.89248202e-02  7.07272834e-02 -1.04009604e-01]
 [-3.47500005e-01  3.70987470e-01  2.38807201e-01]
 [-1.10751832e-01  1.00939694e-01  2.48185022e-01]
 [ 2.71830043e-02  7.07315478e-03  1.05362833e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-24.64839279]
curr_Stock_Price:  96.6290661472475
curr_Factors:  [96.62906615 -0.81920745 -0.91082878]
mat_Sqrt:  [[17.13020648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00609436 -0.03521376  0.07904252]
Stock Position:  0.006094364688689146
Bond Position:  [-25.23728556]


portfolio before change:  [-24.6655983]
curr_Stock_Price:  95.87694436924257
curr_Factors:  [95.87694437 -0.73410269 -0.89340784]
mat_Sqrt:  [[18.83195214  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00781066 0.04909057 0.1620149 ]
Stock Position:  0.0078106554386976
Bond Position:  [-25.41446007]


portfolio before change:  [-24.67852984]
curr_Stock_Price:  95.84863159332158
curr_Factors:  [95.84863159 -1.03792029 -0.88555282]
mat_Sqrt:  [[14.00335693  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03495451  0.01355611 -1.03465338]
Stock Position:  -0.034954505602753705
Bond Position:  [-21.32818831]


portfolio before change:  [-24.79772748]
curr_Stock_Price:  98.95354952844502
curr_Factors:  [98.95354953 -0.65649636 -0.89570203]
mat_Sqrt:  [[20.95656897  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01340056 -0.12048223 -1.1415919 ]
Stock Position:  0.013400563880435092
Bond Position:  [-26.12376084]


portfolio before change:  [-24.81778134]
curr_Stock_Price:  98.43202538681562
curr_Factors:  [98.43202539 -0.54791593 -0.90450606]
mat_Sqrt:  [[23.03337439  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00080367  0.02588199  0.36374465]
Stock Position:  -0.0008036748624351634
Bond Position:  [-24.738674]


portfolio before change:  [-24.82944917]
curr_Stock_Price:  97.55529669225987
curr_Factors:  [97.55529669  0.56406339 -0.87848914]
mat_Sqrt:  [[71.23566517  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00064179  0.02282713 -0.29671045]
Stock Position:  -0.000641792917623907
Bond Position:  [-24.76683887]


portfolio before change:  [-24.84351479]
curr_Stock_Price:  100.17157799760334
curr_Factors:  [ 1.00171578e+02 -5.28811169e-03 -8.84063844e-01]
mat_Sqrt:  [[41.16270136  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00541816  0.11973569  0.68125047]
Stock Position:  -0.005418162107850538
Bond Position:  [-24.30076894]


portfolio before change:  [-24.84772361]
curr_Stock_Price:  98.70528661585217
curr_Factors:  [98.70528662 -0.14111716 -0.8613951 ]
mat_Sqrt:  [[36.22053583  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109018  0.03257815  0.70800279]
Stock Position:  -0.001090183980309537
Bond Position:  [-24.74011669]


portfolio before change:  [-24.85995295]
curr_Stock_Price:  98.57336843644435
curr_Factors:  [98.57336844  0.11458152 -0.82596741]
mat_Sqrt:  [[48.39590648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00103591 0.00228285 0.30057084]
Stock Position:  0.0010359120826209103
Bond Position:  [-24.96206629]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-24.87489219]
Stock Price:  96.20339438933426
PL:  [-24.87489219]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-8.78459012e-02  7.25273598e-02  5.34429913e-02]
 [ 4.92011344e-01 -5.84265789e-01  6.33630248e-01]
 [ 5.44410826e-03 -6.36905211e-02  7.20217937e-02]
 [ 5.75001984e-01 -5.26290676e-01 -2.36301720e-01]
 [-1.41295427e-01  1.01179467e-01 -8.56549924e-02]
 [-4.84683337e-02 -7.96518194e-02 -7.00501156e-02]
 [-1.78668739e-01 -1.84359090e-01  2.33135894e-01]
 [-1.16877448e-01  6.96185961e-02  1.59536932e-01]
 [-1.20345523e-03 -4.20505475e-02  1.60156571e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.13430095]
curr_Stock_Price:  101.8972737310176
curr_Factors:  [101.89727373  -1.06822679  -1.00066931]
mat_Sqrt:  [[12.87218892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00482686  0.0234081   0.15245798]
Stock Position:  -0.004826864436334913
Bond Position:  [17.62614528]


portfolio before change:  [17.14031535]
curr_Stock_Price:  102.47754220689204
curr_Factors:  [102.47754221  -1.19386525  -1.023068  ]
mat_Sqrt:  [[11.16417985  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0449731  -0.18857097  1.80757073]
Stock Position:  0.04497310409862279
Bond Position:  [12.53158218]


portfolio before change:  [17.17487262]
curr_Stock_Price:  103.10658278283861
curr_Factors:  [103.10658278  -1.35858716  -1.07291758]
mat_Sqrt:  [[ 9.0635285   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00078829 -0.02055603  0.20545813]
Stock Position:  0.0007882936715093412
Bond Position:  [17.09359435]


portfolio before change:  [17.18472372]
curr_Stock_Price:  104.75846749610982
curr_Factors:  [104.7584675   -1.52074325  -1.08723658]
mat_Sqrt:  [[ 7.71894392  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05432589 -0.16985959 -0.67410303]
Stock Position:  0.054325885431148045
Bond Position:  [11.49362722]


portfolio before change:  [17.1689359]
curr_Stock_Price:  104.36204368956389
curr_Factors:  [104.36204369  -1.54637817  -1.02442595]
mat_Sqrt:  [[ 7.98098571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01730695  0.03265553 -0.24434985]
Stock Position:  -0.017306948273233203
Bond Position:  [18.97512439]


portfolio before change:  [17.16103173]
curr_Stock_Price:  105.36707934160074
curr_Factors:  [105.36707934  -1.55793269  -1.00055512]
mat_Sqrt:  [[ 8.15770141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0096873  -0.02570751 -0.19983348]
Stock Position:  -0.009687301518349872
Bond Position:  [18.1817544]


portfolio before change:  [17.174339]
curr_Stock_Price:  104.93206510638687
curr_Factors:  [104.93206511  -1.05803986  -0.95017704]
mat_Sqrt:  [[14.08480055  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01197832 -0.05950164  0.66507181]
Stock Position:  -0.011978317673691997
Bond Position:  [18.43124861]


portfolio before change:  [17.17555057]
curr_Stock_Price:  105.60046941513248
curr_Factors:  [105.60046942  -1.3159571   -0.99935482]
mat_Sqrt:  [[10.42650264  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00672337  0.02246931  0.45511446]
Stock Position:  -0.00672337347697137
Bond Position:  [17.88554196]


portfolio before change:  [17.17919677]
curr_Stock_Price:  106.38858600626041
curr_Factors:  [106.38858601  -1.36522514  -1.03664498]
mat_Sqrt:  [[ 9.63332245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00067659 -0.01357176  0.04568821]
Stock Position:  -0.0006765895176340763
Bond Position:  [17.25117817]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.18646892]
Stock Price:  108.39215487842594
PL:  [8.79431405]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 2.05111510e-02  9.94396453e-02  5.43734239e-02]
 [ 2.21811462e-01 -1.68075757e-01  2.66053912e-01]
 [-5.70309601e-01  3.86969308e-02 -4.27171179e-01]
 [ 8.16435469e-02 -1.35801457e-01  7.81796868e-02]
 [ 2.64238382e-01 -1.55053221e-01  1.88936602e-01]
 [ 4.48366669e-02  7.24614638e-02 -1.75416839e-01]
 [-2.40286820e-01  2.79550102e-02  2.15254010e-01]
 [-7.66223127e-02  3.50933528e-02  1.99508754e-01]
 [ 8.94387258e-02  5.56761379e-02  1.16765556e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.53388349]
curr_Stock_Price:  98.28262055386033
curr_Factors:  [98.28262055 -0.74033794 -0.97661163]
mat_Sqrt:  [[17.65285698  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00294049 0.03209401 0.15511224]
Stock Position:  0.002940493557287968
Bond Position:  [-11.8228829]


portfolio before change:  [-11.53961854]
curr_Stock_Price:  98.34311156668156
curr_Factors:  [98.34311157 -0.4970882  -1.02135032]
mat_Sqrt:  [[21.54241922  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01122488 -0.05424622  0.75897775]
Stock Position:  0.011224884577748112
Bond Position:  [-12.64350861]


portfolio before change:  [-11.58373947]
curr_Stock_Price:  94.97580759843923
curr_Factors:  [94.9758076  -0.10561226 -1.05669639]
mat_Sqrt:  [[29.70494555  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02186863  0.01248938 -1.21860047]
Stock Position:  -0.02186863375716978
Bond Position:  [-9.50674832]


portfolio before change:  [-11.47735739]
curr_Stock_Price:  89.89379630353152
curr_Factors:  [89.8937963   0.14791289 -1.0537285 ]
mat_Sqrt:  [[36.3361576   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0019232  -0.04382973  0.22302489]
Stock Position:  0.0019231959825449772
Bond Position:  [-11.65024078]


portfolio before change:  [-11.47722314]
curr_Stock_Price:  92.99323377783602
curr_Factors:  [92.99323378 -0.24147558 -1.044528  ]
mat_Sqrt:  [[25.70082646  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01055043 -0.05004321  0.53898353]
Stock Position:  0.010550431083576721
Bond Position:  [-12.45834184]


portfolio before change:  [-11.47055872]
curr_Stock_Price:  94.21547263013922
curr_Factors:  [94.21547263 -0.29472485 -1.0705627 ]
mat_Sqrt:  [[24.0538933   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099032  0.02338684 -0.50041542]
Stock Position:  0.0009903173931449672
Bond Position:  [-11.56386194]


portfolio before change:  [-11.4764299]
curr_Stock_Price:  94.12681262451638
curr_Factors:  [94.12681262 -0.1157227  -1.06615925]
mat_Sqrt:  [[28.86878745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00660374  0.00902244  0.61405977]
Stock Position:  -0.006603740701744486
Bond Position:  [-10.85484084]


portfolio before change:  [-11.48802362]
curr_Stock_Price:  95.06036614893084
curr_Factors:  [95.06036615 -0.42850967 -1.08554241]
mat_Sqrt:  [[20.91486256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00137387  0.01132633  0.56914294]
Stock Position:  -0.0013738726753605424
Bond Position:  [-11.35742278]


portfolio before change:  [-11.49409327]
curr_Stock_Price:  95.3438856821585
curr_Factors:  [ 9.53438857e+01 -8.42157622e-02 -1.05649029e+00]
mat_Sqrt:  [[30.47126644  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00409035 0.0179694  0.33309963]
Stock Position:  0.004090353100241342
Bond Position:  [-11.88408343]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.47827238]
Stock Price:  100.66480057845766
PL:  [-12.14307296]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.66633743e-02  1.14870173e-01  5.33637364e-02]
 [ 1.04620697e-01  1.49601555e-01  5.51276334e-02]
 [-1.98001089e-01  1.56965300e-02 -9.40942930e-02]
 [ 3.78482995e-01 -3.22473032e-01 -3.38574296e-01]
 [-5.57721820e-02  9.48356963e-02  1.24304124e-01]
 [-3.62442976e-02  3.29831062e-02  7.20782018e-02]
 [-4.64988767e-02 -2.98790627e-01  1.69414732e-01]
 [-1.11024648e-01  2.00946027e-02  6.48825888e-02]
 [-4.04735765e-02 -5.12428165e-02  3.29467369e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.32554354]
curr_Stock_Price:  98.68714690989601
curr_Factors:  [98.68714691 -1.14992809 -0.9806129 ]
mat_Sqrt:  [[11.72137069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00605765 0.03707419 0.15223189]
Stock Position:  0.006057651369959127
Bond Position:  [-8.92335587]


portfolio before change:  [-8.33890032]
curr_Stock_Price:  97.21892353412672
curr_Factors:  [97.21892353 -0.80999955 -0.98719095]
mat_Sqrt:  [[16.11539266  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00908516 0.04828369 0.15726379]
Stock Position:  0.009085156716882578
Bond Position:  [-9.22214948]


portfolio before change:  [-8.3325183]
curr_Stock_Price:  98.42905624727435
curr_Factors:  [98.42905625 -1.10569106 -0.98773068]
mat_Sqrt:  [[12.13282158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01763843  0.00506603 -0.26842483]
Stock Position:  -0.017638433372493753
Bond Position:  [-6.59638395]


portfolio before change:  [-8.32171365]
curr_Stock_Price:  97.6294574835677
curr_Factors:  [97.62945748 -1.15946557 -0.96989783]
mat_Sqrt:  [[11.60940867  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02097844 -0.10407772 -0.96585822]
Stock Position:  0.020978439245216435
Bond Position:  [-10.36982729]


portfolio before change:  [-8.32285885]
curr_Stock_Price:  97.82208424163998
curr_Factors:  [97.82208424 -1.44352878 -1.01924237]
mat_Sqrt:  [[ 8.33429735  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013247   0.03060809  0.35460507]
Stock Position:  -0.0013247011751859837
Bond Position:  [-8.19327382]


portfolio before change:  [-8.33000876]
curr_Stock_Price:  100.12618734277261
curr_Factors:  [100.12618734  -1.87944604  -1.09557093]
mat_Sqrt:  [[ 5.11109819  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00289541  0.01064525  0.20561905]
Stock Position:  -0.0028954145162721776
Bond Position:  [-8.04010195]


portfolio before change:  [-8.33294883]
curr_Stock_Price:  99.75284097620451
curr_Factors:  [99.75284098 -1.22776093 -1.13478987]
mat_Sqrt:  [[ 9.39469091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00776051 -0.09643426  0.48329307]
Stock Position:  -0.007760512985605699
Bond Position:  [-7.55881561]


portfolio before change:  [-8.34591027]
curr_Stock_Price:  100.93589305097503
curr_Factors:  [100.93589305  -1.6731948   -1.12888908]
mat_Sqrt:  [[ 6.12514062  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01529414  0.00648551  0.18509197]
Stock Position:  -0.015294138975348653
Bond Position:  [-6.80218269]


portfolio before change:  [-8.35770167]
curr_Stock_Price:  101.48443398834672
curr_Factors:  [101.48443399  -1.40421352  -1.15540982]
mat_Sqrt:  [[ 7.84818334  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00563293 -0.01653855  0.09398787]
Stock Position:  -0.005632927550438646
Bond Position:  [-7.78604721]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.36213706]
Stock Price:  101.58054558193592
PL:  [-9.94268264]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-9.94902114e-02  7.42709656e-02  5.39169645e-02]
 [ 3.48074165e-01 -6.33932943e-01  5.30637161e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.41675580e-01 -4.90101980e-01 -3.14108881e-01]
 [-1.40093902e-01  9.63213574e-02 -7.06504229e-02]
 [-3.89139109e-02 -1.02605128e-01 -8.73433061e-02]
 [-5.59039658e-01  3.65647203e-01  4.78912607e-01]
 [-1.16357813e-01  1.16074757e-01  2.69025621e-01]
 [-1.80675878e-02 -4.54429163e-02  2.49029797e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.13526821]
curr_Stock_Price:  102.4017391958544
curr_Factors:  [102.4017392   -0.92559141  -1.0685532 ]
mat_Sqrt:  [[13.93995377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00525999  0.02397085  0.15381009]
Stock Position:  -0.005259985865560963
Bond Position:  [21.67389991]


portfolio before change:  [21.13562579]
curr_Stock_Price:  104.39453447632629
curr_Factors:  [104.39453448  -1.27307259  -1.03655996]
mat_Sqrt:  [[10.3661405   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03154395 -0.20460098  1.51376012]
Stock Position:  0.0315439484864723
Bond Position:  [17.84260997]


portfolio before change:  [21.11461684]
curr_Stock_Price:  103.44562073361114
curr_Factors:  [103.44562073  -0.74575327  -1.03364279]
mat_Sqrt:  [[17.45541668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00201703 -0.02755111  0.34758667]
Stock Position:  0.0020170286646246536
Bond Position:  [20.90596406]


portfolio before change:  [21.12460206]
curr_Stock_Price:  103.21241602494487
curr_Factors:  [103.21241602  -0.62689956  -1.01413293]
mat_Sqrt:  [[20.00048792  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01887538 -0.15817973 -0.89606521]
Stock Position:  0.01887537576731858
Bond Position:  [19.17642892]


portfolio before change:  [21.15464408]
curr_Stock_Price:  104.2959129942071
curr_Factors:  [104.29591299  -0.61536567  -1.02226754]
mat_Sqrt:  [[20.27926562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00664984  0.03108758 -0.20154599]
Stock Position:  -0.006649838671648779
Bond Position:  [21.84819508]


portfolio before change:  [21.1585917]
curr_Stock_Price:  105.34544384386362
curr_Factors:  [105.34544384  -0.24535106  -0.99735504]
mat_Sqrt:  [[30.40292428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00255525 -0.03311566 -0.24916614]
Stock Position:  -0.00255524672304885
Bond Position:  [21.4277753]


portfolio before change:  [21.16443153]
curr_Stock_Price:  107.25396160571638
curr_Factors:  [ 1.07253962e+02  2.50140744e-02 -9.68585496e-01]
mat_Sqrt:  [[41.74702011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00926161  0.11801213  1.36620436]
Stock Position:  -0.009261609768429553
Bond Position:  [22.15777587]


portfolio before change:  [21.1947312]
curr_Stock_Price:  105.17894310154047
curr_Factors:  [105.1789431   -0.38981816  -0.98567637]
mat_Sqrt:  [[26.58025358  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00142021  0.03746297  0.76745522]
Stock Position:  -0.001420209451707164
Bond Position:  [21.34410733]


portfolio before change:  [21.20497231]
curr_Stock_Price:  105.48426224546647
curr_Factors:  [105.48426225  -0.28070211  -1.0091785 ]
mat_Sqrt:  [[29.04020241  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00076653 -0.01466664  0.07104127]
Stock Position:  -0.0007665333899378848
Bond Position:  [21.28582952]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.21582911]
Stock Price:  105.20870425982545
PL:  [16.00712485]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 2.46037717e-02  8.39931352e-02  5.29876402e-02]
 [ 2.13312191e-01 -1.43010210e-01  2.49927640e-01]
 [-3.87496818e-01  4.28272527e-02 -3.46591139e-01]
 [ 3.24573697e-01 -2.83880590e-01 -2.56224166e-01]
 [-5.21279071e-02  9.08148913e-02  1.42004074e-01]
 [-5.16431011e-02  4.02170184e-02  4.17156596e-02]
 [-5.01302455e-02 -3.17229533e-01  1.65465387e-01]
 [-1.11192893e-01  4.21531767e-02  1.14185799e-01]
 [-5.73348251e-02 -5.51050457e-02  4.41065723e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.86892708]
curr_Stock_Price:  97.98820453569348
curr_Factors:  [97.98820454 -0.65169662 -1.0381344 ]
mat_Sqrt:  [[18.08379235  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00290674 0.02710867 0.15115899]
Stock Position:  0.0029067384984173385
Bond Position:  [-14.15375316]


portfolio before change:  [-13.87551452]
curr_Stock_Price:  98.15719014409476
curr_Factors:  [98.15719014 -0.23203243 -1.02983903]
mat_Sqrt:  [[27.79062459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00846101 -0.04615635  0.71297399]
Stock Position:  0.008461005221459338
Bond Position:  [-14.70602302]


portfolio before change:  [-13.89897504]
curr_Stock_Price:  96.25367289476667
curr_Factors:  [96.25367289 -0.3312487  -1.07252076]
mat_Sqrt:  [[23.6465605   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01900921  0.01382244 -0.98872805]
Stock Position:  -0.01900920691092439
Bond Position:  [-12.06926906]


portfolio before change:  [-13.91080116]
curr_Stock_Price:  96.55826075223239
curr_Factors:  [96.55826075 -0.53998115 -1.05601762]
mat_Sqrt:  [[19.57293614  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01095008 -0.09162207 -0.73093623]
Stock Position:  0.010950082984950479
Bond Position:  [-14.96812213]


portfolio before change:  [-13.90524966]
curr_Stock_Price:  97.7488845618034
curr_Factors:  [97.74888456 -0.82099715 -1.05410642]
mat_Sqrt:  [[14.98872455  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.07159877e-04  2.93103801e-02  4.05098097e-01]
Stock Position:  -0.0003071598765164318
Bond Position:  [-13.87522513]


portfolio before change:  [-13.91278045]
curr_Stock_Price:  99.67439717547919
curr_Factors:  [99.67439718 -1.17908416 -1.1164521 ]
mat_Sqrt:  [[10.03794678  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347867  0.01297999  0.11900317]
Stock Position:  -0.0034786659072914244
Bond Position:  [-13.56604652]


portfolio before change:  [-13.9246496]
curr_Stock_Price:  101.13599901478771
curr_Factors:  [101.13599901  -1.24176198  -1.05853216]
mat_Sqrt:  [[10.13679624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00800144 -0.10238539  0.47202669]
Stock Position:  -0.008001440507462213
Bond Position:  [-13.11541592]


portfolio before change:  [-13.92586724]
curr_Stock_Price:  100.46840630577259
curr_Factors:  [100.46840631  -1.27486338  -1.0584073 ]
mat_Sqrt:  [[ 9.74322945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00813697  0.01360488  0.3257403 ]
Stock Position:  -0.008136966703636287
Bond Position:  [-13.10835916]


portfolio before change:  [-13.93718812]
curr_Stock_Price:  101.05401250732118
curr_Factors:  [101.05401251  -0.9376436   -1.09910469]
mat_Sqrt:  [[13.18271979  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00451954 -0.01778508  0.12582377]
Stock Position:  -0.004519543771858558
Bond Position:  [-13.48047008]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.9539285]
Stock Price:  103.26628570294145
PL:  [-17.22021421]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.01903291e-02  9.17161505e-02  4.85336888e-02]
 [ 4.62089798e-01 -6.17395009e-01  6.22746941e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.30933178e-01 -4.82978509e-01 -2.79360203e-01]
 [-1.32183883e-01  8.11751776e-02 -1.52402383e-02]
 [-8.85800480e-02  2.01358515e-02  4.65006464e-02]
 [-1.55314824e-01 -1.62318435e-01  1.91035503e-01]
 [-1.17100454e-01  1.05306294e-01  2.39446737e-01]
 [-1.62733074e-02 -4.69675142e-02  1.84672464e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.27162164]
curr_Stock_Price:  99.77112802201272
curr_Factors:  [99.77112802 -0.79858416 -1.00597275]
mat_Sqrt:  [[16.41707479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00358278 0.02960126 0.13845311]
Stock Position:  0.003582776374142092
Bond Position:  [-0.085836]


portfolio before change:  [0.28283573]
curr_Stock_Price:  102.9131092736723
curr_Factors:  [102.91310927  -1.07485809  -1.04548191]
mat_Sqrt:  [[12.34862881  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0375088  -0.19926338  1.77652368]
Stock Position:  0.03750880069271965
Bond Position:  [-3.57731157]


portfolio before change:  [0.31365729]
curr_Stock_Price:  103.78252284615687
curr_Factors:  [103.78252285  -0.41886881  -1.04808957]
mat_Sqrt:  [[23.93493725  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00147099 -0.02755111  0.34758667]
Stock Position:  0.0014709909382087584
Bond Position:  [0.16099414]


portfolio before change:  [0.31396448]
curr_Stock_Price:  103.9366170590934
curr_Factors:  [103.93661706  -0.28947048  -1.05495874]
mat_Sqrt:  [[27.09507668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01385202 -0.15588064 -0.7969369 ]
Stock Position:  0.013852016170929538
Bond Position:  [-1.12576722]


portfolio before change:  [0.33359132]
curr_Stock_Price:  105.3941569344525
curr_Factors:  [105.39415693  -0.89870203  -1.01075596]
mat_Sqrt:  [[15.6152689   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00760313  0.02619918 -0.04347616]
Stock Position:  -0.007603133220889009
Bond Position:  [1.13491713]


portfolio before change:  [0.36097021]
curr_Stock_Price:  101.86780976149942
curr_Factors:  [101.86780976  -0.85694258  -0.97706277]
mat_Sqrt:  [[16.2756584   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460675  0.00649882  0.1326534 ]
Stock Position:  -0.004606752486029425
Bond Position:  [0.83024999]


portfolio before change:  [0.35301858]
curr_Stock_Price:  103.68402487314891
curr_Factors:  [103.68402487  -1.01070056  -1.04028916]
mat_Sqrt:  [[13.3345489   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01120795 -0.05238805  0.54497112]
Stock Position:  -0.011207951455979071
Bond Position:  [1.5151041]


portfolio before change:  [0.3687083]
curr_Stock_Price:  102.3517588885607
curr_Factors:  [102.35175889  -0.51309704  -1.02306916]
mat_Sqrt:  [[22.02656659  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00212144  0.03398746  0.68307489]
Stock Position:  -0.002121439842112801
Bond Position:  [0.5858414]


portfolio before change:  [0.356134]
curr_Stock_Price:  108.41711641416782
curr_Factors:  [108.41711641  -0.89541581  -1.07379545]
mat_Sqrt:  [[15.13144021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00145993 -0.0151587   0.05268191]
Stock Position:  -0.0014599337482095914
Bond Position:  [0.51441581]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.35517914]
Stock Price:  109.24738098861118
PL:  [-8.89220185]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-5.46151960e-02  5.18050895e-02  4.96855066e-02]
 [ 4.97444272e-01 -6.83718898e-01  6.88557334e-01]
 [ 6.28287879e-02 -7.79658789e-02  9.98069222e-02]
 [ 5.81323020e-01 -5.52091140e-01 -1.32275273e-01]
 [-1.29675121e-01  7.63713777e-02  2.33379322e-03]
 [-5.57544068e-02 -6.09306835e-02 -4.12393802e-02]
 [-1.36589807e-01 -5.16945410e-01  3.21101545e-01]
 [-1.16795336e-01  6.53664967e-02  1.50178565e-01]
 [ 7.29266251e-03 -4.00183018e-02  1.24792432e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.87703682]
curr_Stock_Price:  101.2344069724055
curr_Factors:  [101.23440697  -0.81742496  -1.01013847]
mat_Sqrt:  [[16.27898901  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00208235  0.01672002  0.14173892]
Stock Position:  -0.0020823476717712736
Bond Position:  [12.08784205]


portfolio before change:  [11.8805775]
curr_Stock_Price:  102.43725700974558
curr_Factors:  [102.43725701  -0.58445255  -1.07629579]
mat_Sqrt:  [[19.46274534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02560954 -0.22066933  1.96426242]
Stock Position:  0.02560953788577347
Bond Position:  [9.25720669]


portfolio before change:  [11.97213004]
curr_Stock_Price:  105.83141358367236
curr_Factors:  [105.83141358  -0.26139045  -1.11427291]
mat_Sqrt:  [[26.74062743  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00251629 -0.02516338  0.28472137]
Stock Position:  0.0025162862162746843
Bond Position:  [11.70582792]


portfolio before change:  [11.98094621]
curr_Stock_Price:  107.00845949098455
curr_Factors:  [107.00845949  -1.07692851  -1.11642849]
mat_Sqrt:  [[11.93590277  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03699991 -0.17818665 -0.37734454]
Stock Position:  0.03699990857260195
Bond Position:  [8.02164299]


portfolio before change:  [11.94420743]
curr_Stock_Price:  105.90708923924983
curr_Factors:  [105.90708924  -1.32037089  -1.13837239]
mat_Sqrt:  [[ 9.05954515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01254031  0.02464876  0.00665766]
Stock Position:  -0.012540309018256148
Bond Position:  [13.27231506]


portfolio before change:  [11.96906355]
curr_Stock_Price:  104.45431005806896
curr_Factors:  [104.45431006  -0.98613302  -1.13116477]
mat_Sqrt:  [[12.57174657  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00609381 -0.01966529 -0.11764447]
Stock Position:  -0.006093805919141705
Bond Position:  [12.60558784]


portfolio before change:  [11.96465471]
curr_Stock_Price:  106.2123582569701
curr_Factors:  [106.21235826  -1.45629548  -1.15447647]
mat_Sqrt:  [[ 7.80425052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02262437 -0.16684341  0.91601333]
Stock Position:  -0.022624372173590757
Bond Position:  [14.36764264]


portfolio before change:  [11.98382092]
curr_Stock_Price:  105.68281493985897
curr_Factors:  [105.68281494  -1.32587265  -1.12247333]
mat_Sqrt:  [[ 9.13484592  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0079692   0.02109695  0.42841764]
Stock Position:  -0.007969196766458438
Bond Position:  [12.82602806]


portfolio before change:  [11.98231053]
curr_Stock_Price:  106.67726994327575
curr_Factors:  [106.67726994  -1.78583222  -1.12412667]
mat_Sqrt:  [[ 5.81156103  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00028758 -0.01291585  0.03559981]
Stock Position:  0.0002875777638280645
Bond Position:  [11.95163252]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.98848184]
Stock Price:  107.351886848219
PL:  [4.63659499]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 1.56853626e-02  7.89457688e-02  4.81847139e-02]
 [ 3.29237464e-01 -4.78877861e-01  4.60460935e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.78513422e-01 -4.20841556e-01 -3.84745007e-01]
 [-9.04967504e-02  1.07085547e-01  1.62345667e-02]
 [-3.82081943e-02  4.28007531e-02  3.04419315e-02]
 [-3.89846216e-02 -3.04088007e-01  1.73407039e-01]
 [-1.09785861e-01  5.63167816e-02  1.50280671e-01]
 [ 4.11431371e-02  1.87224973e-02  1.06847368e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.05220288]
curr_Stock_Price:  99.99563416840385
curr_Factors:  [99.99563417 -0.88381479 -1.03563803]
mat_Sqrt:  [[14.66808012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00283853 0.02547964 0.13745758]
Stock Position:  0.002838528518486856
Bond Position:  [1.76836242]


portfolio before change:  [2.05216092]
curr_Stock_Price:  99.66928048845895
curr_Factors:  [99.66928049 -1.00071493 -1.04627735]
mat_Sqrt:  [[12.8695651   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02529053 -0.15455716  1.31356688]
Stock Position:  0.025290530229402024
Bond Position:  [-0.46852804]


portfolio before change:  [2.05457002]
curr_Stock_Price:  99.77380291033245
curr_Factors:  [99.77380291 -0.67642727 -1.08539064]
mat_Sqrt:  [[17.13439313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00205482 -0.02755111  0.34758667]
Stock Position:  0.0020548189562739857
Bond Position:  [1.84955292]


portfolio before change:  [2.05808845]
curr_Stock_Price:  101.03591795264056
curr_Factors:  [101.03591795  -0.69907712  -1.10757118]
mat_Sqrt:  [[16.59045909  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01893099 -0.13582603 -1.09757041]
Stock Position:  0.01893098627110374
Bond Position:  [0.14537887]


portfolio before change:  [2.02896274]
curr_Stock_Price:  99.49355722057275
curr_Factors:  [99.49355722 -1.27240242 -1.15293498]
mat_Sqrt:  [[ 8.80003314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00742317  0.03456171  0.0463127 ]
Stock Position:  -0.007423169500601702
Bond Position:  [2.76752028]


portfolio before change:  [2.03156369]
curr_Stock_Price:  99.32963221700237
curr_Factors:  [99.32963222 -1.4821051  -1.14063519]
mat_Sqrt:  [[ 7.21169233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00322498  0.01381388  0.08684236]
Stock Position:  -0.0032249842078369423
Bond Position:  [2.35190019]


portfolio before change:  [2.03244942]
curr_Stock_Price:  99.41971457135507
curr_Factors:  [99.41971457 -1.27935568 -1.15284834]
mat_Sqrt:  [[ 8.73332709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0075183  -0.09814398  0.49468202]
Stock Position:  -0.007518298780576899
Bond Position:  [2.77991654]


portfolio before change:  [2.03442181]
curr_Stock_Price:  99.34229311155451
curr_Factors:  [99.34229311 -0.84480004 -1.08941882]
mat_Sqrt:  [[14.35864974  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00470896  0.01817616  0.42870892]
Stock Position:  -0.004708961749581533
Bond Position:  [2.50222087]


portfolio before change:  [2.04444889]
curr_Stock_Price:  97.47868523147507
curr_Factors:  [ 9.74786852e+01 -5.80635368e-03 -1.13052287e+00]
mat_Sqrt:  [[31.29018651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00213405 0.00604266 0.3048058 ]
Stock Position:  0.002134054985242231
Bond Position:  [1.83642401]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.05366212]
Stock Price:  101.3655522673519
PL:  [0.68810985]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-3.75429029e-03  2.94104115e-02  4.01738985e-02]
 [ 4.55445053e-01 -6.93153650e-01  6.54671410e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.41514244e-01 -4.93524462e-01 -2.68444651e-01]
 [-1.29585793e-01  7.62003313e-02  2.95954250e-03]
 [-7.80190638e-02 -5.02858506e-03  3.00425414e-02]
 [-1.19355608e-01 -2.19836508e-01  1.73760883e-01]
 [-1.12905595e-01  4.28617246e-02  1.10768660e-01]
 [-3.58269689e-02 -5.00648193e-02  3.12063925e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.54329135]
curr_Stock_Price:  101.94884164410402
curr_Factors:  [101.94884164  -0.45551484  -1.04922526]
mat_Sqrt:  [[22.64028945  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00046155 0.00949217 0.11460495]
Stock Position:  0.00046154655137951747
Bond Position:  [17.49623722]


portfolio before change:  [17.55260239]
curr_Stock_Price:  103.1637297086497
curr_Factors:  [103.16372971  -0.66018169  -1.04452614]
mat_Sqrt:  [[18.75779705  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02386154 -0.22371438  1.86759531]
Stock Position:  0.023861538593828634
Bond Position:  [15.09095707]


portfolio before change:  [17.53380264]
curr_Stock_Price:  102.05956331029637
curr_Factors:  [102.05956331  -0.31219852  -1.07691958]
mat_Sqrt:  [[25.44294509  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00138381 -0.02755111  0.34758667]
Stock Position:  0.0013838050459377962
Bond Position:  [17.3925721]


portfolio before change:  [17.54539864]
curr_Stock_Price:  104.1534571696118
curr_Factors:  [104.15345717  -0.63678356  -1.08266219]
mat_Sqrt:  [[18.6606982   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.020684   -0.15928434 -0.76579787]
Stock Position:  0.02068400367226562
Bond Position:  [15.39108815]


portfolio before change:  [17.5851454]
curr_Stock_Price:  105.70292948483794
curr_Factors:  [105.70292948  -0.63471947  -1.07752925]
mat_Sqrt:  [[19.07510136  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00594636  0.02459355  0.00844275]
Stock Position:  -0.005946356437336462
Bond Position:  [18.2136927]


portfolio before change:  [17.61167407]
curr_Stock_Price:  102.7734808351997
curr_Factors:  [102.77348084  -0.93075347  -1.13525881]
mat_Sqrt:  [[13.02037028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00559993 -0.00162297  0.08570301]
Stock Position:  -0.005599926098049026
Bond Position:  [18.18719797]


portfolio before change:  [17.62488925]
curr_Stock_Price:  102.03788063260421
curr_Factors:  [102.03788063  -1.0228533   -1.15126589]
mat_Sqrt:  [[11.60255041  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01109763 -0.07095193  0.49569143]
Stock Position:  -0.011097625170897307
Bond Position:  [18.7572674]


portfolio before change:  [17.64043606]
curr_Stock_Price:  101.48228149086913
curr_Factors:  [101.48228149  -1.36711938  -1.13374584]
mat_Sqrt:  [[ 8.32296861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0097977   0.01383356  0.31599215]
Stock Position:  -0.00979769696912877
Bond Position:  [18.6347287]


portfolio before change:  [17.65066859]
curr_Stock_Price:  101.38911365293667
curr_Factors:  [101.38911365  -1.6341501   -1.15740641]
mat_Sqrt:  [[ 6.2177569   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00638115 -0.01615835  0.08902315]
Stock Position:  -0.006381148338566709
Bond Position:  [18.29764756]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.66174393]
Stock Price:  101.08756454267272
PL:  [16.57417938]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-4.28244623e-02  4.69514025e-02  4.87339361e-02]
 [ 4.27030327e-01 -5.24264779e-01  5.43749574e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.20955486e-01 -4.59532002e-01 -3.84995025e-01]
 [-1.39244052e-01  1.27518306e-01 -1.42999042e-01]
 [-5.17391665e-02  3.56548364e-02  6.16021585e-02]
 [-1.00420548e-02 -2.77225318e-01  1.77642890e-01]
 [-9.88097589e-02  3.63258944e-02  1.37302266e-01]
 [-5.43996426e-04 -1.12836579e-02  9.55849208e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.80443632]
curr_Stock_Price:  100.84699544356491
curr_Factors:  [100.84699544  -1.08754586  -1.04121299]
mat_Sqrt:  [[11.99926767  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00194118  0.0151535   0.13902435]
Stock Position:  -0.0019411829936936012
Bond Position:  [9.00019879]


portfolio before change:  [8.80842425]
curr_Stock_Price:  101.11141952361004
curr_Factors:  [101.11141952  -1.31848674  -0.969937  ]
mat_Sqrt:  [[10.25534807  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0420276  -0.16920573  1.55116618]
Stock Position:  0.04202759781947414
Bond Position:  [4.55895417]


portfolio before change:  [8.7866893]
curr_Stock_Price:  100.54000927555556
curr_Factors:  [100.54000928  -1.08824235  -0.9620672 ]
mat_Sqrt:  [[12.93900258  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00272108 -0.02755111  0.34758667]
Stock Position:  0.0027210811338812943
Bond Position:  [8.51311177]


portfolio before change:  [8.7923135]
curr_Stock_Price:  101.04222884422092
curr_Factors:  [101.04222884  -1.58291584  -0.98477503]
mat_Sqrt:  [[ 7.75119996  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04496944 -0.14831332 -1.09828364]
Stock Position:  0.04496944096907924
Bond Position:  [4.24850095]


portfolio before change:  [8.80389425]
curr_Stock_Price:  101.25250423493688
curr_Factors:  [101.25250423  -1.41572555  -0.98434733]
mat_Sqrt:  [[ 9.18475052  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0155044   0.04115636 -0.40793646]
Stock Position:  -0.015504399842479134
Bond Position:  [10.37375356]


portfolio before change:  [8.82544898]
curr_Stock_Price:  100.1968967720929
curr_Factors:  [100.19689677  -1.38930599  -0.95603398]
mat_Sqrt:  [[ 9.60032785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00332141  0.01150755  0.17573381]
Stock Position:  -0.0033214142355180876
Bond Position:  [9.15824438]


portfolio before change:  [8.83213229]
curr_Stock_Price:  99.5637209936121
curr_Factors:  [99.56372099 -1.48278132 -0.94937095]
mat_Sqrt:  [[ 8.74642962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347219 -0.08947409  0.50676572]
Stock Position:  -0.003472186268064611
Bond Position:  [9.17783607]


portfolio before change:  [8.83849479]
curr_Stock_Price:  99.0532530872027
curr_Factors:  [99.05325309 -1.22277635 -0.88104039]
mat_Sqrt:  [[12.08349989  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524418  0.01172413  0.39168515]
Stock Position:  -0.005244180880249304
Bond Position:  [9.35794797]


portfolio before change:  [8.85310533]
curr_Stock_Price:  97.1596501508889
curr_Factors:  [97.15965015 -1.03892593 -0.83915431]
mat_Sqrt:  [[14.85409019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112184 -0.00364178  0.27267717]
Stock Position:  0.0011218409604734363
Bond Position:  [8.74410766]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.86039715]
Stock Price:  99.76132903403435
PL:  [8.86039715]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-1.20548379e-02  5.45228963e-02  4.75173126e-02]
 [ 2.60362661e-01 -2.81768665e-01  3.39199840e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.97594806e-01 -4.39537491e-01 -3.79939159e-01]
 [-9.35128266e-02  8.95974499e-02  1.02421267e-02]
 [-4.17680281e-02  4.60825179e-02  1.65898935e-02]
 [-5.45518642e-02 -1.96600285e-01  1.61306001e-01]
 [-7.88026731e-02  1.50215723e-02  1.47811360e-01]
 [ 1.63505445e-02  6.17014949e-04  1.00520563e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.07569013]
curr_Stock_Price:  100.25076733372116
curr_Factors:  [100.25076733  -1.10523821  -1.02963154]
mat_Sqrt:  [[11.85565504  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00074007 0.01759719 0.13555367]
Stock Position:  0.0007400715121255743
Bond Position:  [4.0014974]


portfolio before change:  [4.07660177]
curr_Stock_Price:  98.77846103287223
curr_Factors:  [98.77846103 -0.5821785  -1.0352157 ]
mat_Sqrt:  [[19.59913383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01388254 -0.09094045  0.96764273]
Stock Position:  0.013882539526959257
Bond Position:  [2.70530588]


portfolio before change:  [4.09458275]
curr_Stock_Price:  99.97622344093112
curr_Factors:  [99.97622344 -1.0243533  -1.02188895]
mat_Sqrt:  [[12.91888437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00272532 -0.02755111  0.34758667]
Stock Position:  0.002725318594293382
Bond Position:  [3.82211569]


portfolio before change:  [4.10002141]
curr_Stock_Price:  101.27043237966562
curr_Factors:  [101.27043238  -0.8424936   -1.02954546]
mat_Sqrt:  [[15.57637629  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02120646 -0.14186012 -1.08386067]
Stock Position:  0.02120646219514399
Bond Position:  [1.95243382]


portfolio before change:  [4.0761408]
curr_Stock_Price:  100.09828611100876
curr_Factors:  [100.09828611  -0.75027884  -1.00552595]
mat_Sqrt:  [[17.29379512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00422887  0.02891745  0.02921794]
Stock Position:  -0.004228866934717375
Bond Position:  [4.49944313]


portfolio before change:  [4.08168433]
curr_Stock_Price:  99.31953200748816
curr_Factors:  [99.31953201 -1.30622885 -0.99135867]
mat_Sqrt:  [[ 9.98171314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00290282  0.01487307  0.04732635]
Stock Position:  -0.002902815910745941
Bond Position:  [4.36999065]


portfolio before change:  [4.08532308]
curr_Stock_Price:  98.81891372354963
curr_Factors:  [98.81891372 -1.11335731 -0.99811621]
mat_Sqrt:  [[11.96296342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00516229 -0.06345247  0.46016112]
Stock Position:  -0.00516228943732905
Bond Position:  [4.59545491]


portfolio before change:  [4.09856651]
curr_Stock_Price:  96.69870493194367
curr_Factors:  [96.69870493 -1.08581671 -0.97816469]
mat_Sqrt:  [[12.27566212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00371178  0.00484819  0.42166467]
Stock Position:  -0.0037117785942803825
Bond Position:  [4.45749069]


portfolio before change:  [4.09765237]
curr_Stock_Price:  97.5455880474271
curr_Factors:  [97.54558805 -0.4989161  -0.97336449]
mat_Sqrt:  [[22.37712551  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.65325819e-03 1.99140718e-04 2.86757187e-01]
Stock Position:  0.0016532581939333448
Bond Position:  [3.93638433]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.09493336]
Stock Price:  94.71016327338005
PL:  [4.09493336]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.35017846e-02  9.46316037e-02  4.86133591e-02]
 [ 1.79134146e-01 -4.22143485e-02  1.85079208e-01]
 [-2.27571369e-01  3.31873510e-02 -1.91084019e-01]
 [ 4.41466240e-01 -3.77052544e-01 -4.04803269e-01]
 [-9.31436721e-02  8.03191455e-02 -4.85784070e-03]
 [-9.38169803e-02  3.26142767e-02  5.46618158e-02]
 [-1.35162788e-01 -2.10393782e-01  1.87001176e-01]
 [-1.17336241e-01  9.33769169e-02  2.11826186e-01]
 [-1.30747888e-02 -4.34718746e-02  2.50865514e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.50941011]
curr_Stock_Price:  99.67265094824145
curr_Factors:  [99.67265095 -0.98137417 -1.03574735]
mat_Sqrt:  [[13.26023631  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00473156 0.03054222 0.13868038]
Stock Position:  0.004731555207768421
Bond Position:  [-0.98101676]


portfolio before change:  [-0.51886856]
curr_Stock_Price:  97.77732842047563
curr_Factors:  [97.77732842 -0.17370354 -1.01766135]
mat_Sqrt:  [[29.70537019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00701208 -0.01362462  0.52797946]
Stock Position:  0.007012076011891939
Bond Position:  [-1.20449062]


portfolio before change:  [-0.51840292]
curr_Stock_Price:  97.92964339770914
curr_Factors:  [97.9296434  -0.35084758 -1.02359221]
mat_Sqrt:  [[24.77436633  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01048672  0.01071117 -0.54510952]
Stock Position:  -0.010486721954651534
Bond Position:  [0.50855802]


portfolio before change:  [-0.53378714]
curr_Stock_Price:  99.42091666536024
curr_Factors:  [99.42091667 -0.79215591 -1.06706139]
mat_Sqrt:  [[15.48923428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01819784 -0.12169319 -1.15479105]
Stock Position:  0.018197838933452934
Bond Position:  [-2.34303297]


portfolio before change:  [-0.51696106]
curr_Stock_Price:  100.40992911906761
curr_Factors:  [100.40992912  -0.69654354  -1.08704831]
mat_Sqrt:  [[16.8722328   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460758  0.02592289 -0.01385807]
Stock Position:  -0.00460758209794669
Bond Position:  [-0.05431407]


portfolio before change:  [-0.52235204]
curr_Stock_Price:  101.57405779385569
curr_Factors:  [101.57405779  -1.16411583  -1.05196298]
mat_Sqrt:  [[11.07521088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00686234  0.01052621  0.15593495]
Stock Position:  -0.0068623363748787185
Bond Position:  [0.17468331]


portfolio before change:  [-0.53726412]
curr_Stock_Price:  103.75982104122652
curr_Factors:  [103.75982104  -1.08465698  -1.04290035]
mat_Sqrt:  [[12.36069258  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01132119 -0.0679043   0.5334623 ]
Stock Position:  -0.011321192762566261
Bond Position:  [0.63742081]


portfolio before change:  [-0.55124982]
curr_Stock_Price:  105.02333523458915
curr_Factors:  [105.02333523  -0.84391143  -1.02759187]
mat_Sqrt:  [[16.16226595  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00340527  0.03013727  0.60428115]
Stock Position:  -0.0034052724455362247
Bond Position:  [-0.19361675]


portfolio before change:  [-0.54417216]
curr_Stock_Price:  102.91645723550266
curr_Factors:  [102.91645724  -1.11050865  -1.08799244]
mat_Sqrt:  [[11.42057403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00147345 -0.01403049  0.07156495]
Stock Position:  -0.0014734528365323203
Bond Position:  [-0.39252961]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.54480723]
Stock Price:  103.21423072331298
PL:  [-3.75903795]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-3.03720195e-02  3.98773695e-02  4.74314624e-02]
 [ 4.25659285e-01 -5.85220228e-01  5.73091749e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.88114100e-01 -4.26947649e-01 -3.99960768e-01]
 [-1.53734287e-01  1.20929076e-01 -1.60895355e-01]
 [-8.53165517e-02  1.23596782e-02  4.14148549e-02]
 [-2.56341820e-02 -2.91453318e-01  1.67222647e-01]
 [-1.13466543e-01  4.01872840e-02  1.03088194e-01]
 [ 1.34145663e-02 -3.62451437e-02  1.66537115e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.88938074]
curr_Stock_Price:  100.35336222753142
curr_Factors:  [100.35336223  -1.07973253  -0.95592711]
mat_Sqrt:  [[13.10557809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095762  0.01287037  0.13530876]
Stock Position:  -0.0009576211565601834
Bond Position:  [4.98548124]


portfolio before change:  [4.89136051]
curr_Stock_Price:  100.88968557302103
curr_Factors:  [100.88968557  -0.90814911  -0.95834407]
mat_Sqrt:  [[15.60411278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02712    -0.18887902  1.63487124]
Stock Position:  0.027120001957150322
Bond Position:  [2.15523204]


portfolio before change:  [4.87034701]
curr_Stock_Price:  100.0751065284858
curr_Factors:  [100.07510653  -0.6712108   -0.94049548]
mat_Sqrt:  [[19.96967138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00176308 -0.02755111  0.34758667]
Stock Position:  0.0017630773754979288
Bond Position:  [4.69390686]


portfolio before change:  [4.87360333]
curr_Stock_Price:  100.59055596084892
curr_Factors:  [100.59055596  -1.02478962  -0.9933719 ]
mat_Sqrt:  [[13.36844201  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02388626 -0.13779676 -1.14097674]
Stock Position:  0.023886263333886482
Bond Position:  [2.47087082]


portfolio before change:  [4.91786107]
curr_Stock_Price:  102.39167475518818
curr_Factors:  [102.39167476  -1.21688723  -0.984895  ]
mat_Sqrt:  [[11.32511898  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01429498  0.03902969 -0.45898966]
Stock Position:  -0.014294981782288742
Bond Position:  [6.3815482]


portfolio before change:  [4.9200391]
curr_Stock_Price:  102.46257652067594
curr_Factors:  [102.46257652  -1.27497944  -0.87864039]
mat_Sqrt:  [[11.89214134  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00625118  0.00398907  0.11814505]
Stock Position:  -0.006251176219479734
Bond Position:  [5.56055073]


portfolio before change:  [4.9279271]
curr_Stock_Price:  101.64560564675126
curr_Factors:  [101.64560565  -1.42077723  -0.83864778]
mat_Sqrt:  [[10.6128688   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0048048  -0.09406615  0.47703967]
Stock Position:  -0.00480479524239471
Bond Position:  [5.41631343]


portfolio before change:  [4.93048024]
curr_Stock_Price:  101.67800939869626
curr_Factors:  [101.6780094   -1.64787383  -0.81662759]
mat_Sqrt:  [[ 8.64784047  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00973891  0.01297039  0.29408192]
Stock Position:  -0.00973891216890002
Bond Position:  [5.92071345]


portfolio before change:  [4.92065933]
curr_Stock_Price:  102.99047693982175
curr_Factors:  [102.99047694  -1.79419858  -0.85155895]
mat_Sqrt:  [[ 7.30733756  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0012885  -0.01169807  0.0475084 ]
Stock Position:  0.001288496926910839
Bond Position:  [4.78795642]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.92221583]
Stock Price:  102.34004136657765
PL:  [2.58217446]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-6.56892132e-02  5.99405007e-02  5.11254939e-02]
 [ 4.14059263e-01 -5.82645553e-01  5.61131683e-01]
 [-4.85064664e-02 -5.53874422e-02  7.44186408e-02]
 [ 3.97788227e-01 -3.37055545e-01 -3.72284329e-01]
 [-5.79326949e-02  8.94713672e-02  1.31821848e-01]
 [-3.14499175e-02  6.57889100e-02 -6.73073681e-02]
 [-1.24234814e-01 -4.62732134e-02  1.66406833e-01]
 [-7.52524364e-02  4.83077656e-03  1.35205141e-01]
 [ 4.65901690e-02  2.43554460e-02  1.05872972e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.85134388]
curr_Stock_Price:  101.23116745521105
curr_Factors:  [101.23116746  -1.23335793  -0.99721682]
mat_Sqrt:  [[10.878974    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00395423  0.01934571  0.1458468 ]
Stock Position:  -0.003954229686753346
Bond Position:  [12.25163517]


portfolio before change:  [11.85947471]
curr_Stock_Price:  100.72450068401712
curr_Factors:  [100.72450068  -0.89965943  -1.04671093]
mat_Sqrt:  [[14.38259388  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02848358 -0.18804804  1.6007525 ]
Stock Position:  0.028483579947115662
Bond Position:  [8.99048034]


portfolio before change:  [11.8133147]
curr_Stock_Price:  98.94605945519609
curr_Factors:  [98.94605946 -0.76718146 -1.06382349]
mat_Sqrt:  [[15.85634759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00281412 -0.01787622  0.21229567]
Stock Position:  -0.0028141246924731846
Bond Position:  [12.09176125]


portfolio before change:  [11.82096183]
curr_Stock_Price:  98.3775901650395
curr_Factors:  [98.37759017 -1.51846818 -1.09859025]
mat_Sqrt:  [[ 7.18326923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03522001 -0.10878421 -1.06202357]
Stock Position:  0.0352200123926082
Bond Position:  [8.35610189]


portfolio before change:  [11.82350941]
curr_Stock_Price:  98.3312665206601
curr_Factors:  [98.33126652 -1.02261957 -1.12955886]
mat_Sqrt:  [[11.42911002  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111657  0.02887676  0.37605104]
Stock Position:  -0.001116570453719515
Bond Position:  [11.9333032]


portfolio before change:  [11.8303771]
curr_Stock_Price:  97.52563401950324
curr_Factors:  [97.52563402 -0.93399848 -1.1614822 ]
mat_Sqrt:  [[11.99673549  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00264738  0.02123328 -0.19200919]
Stock Position:  -0.002647376157530218
Bond Position:  [12.08856414]


portfolio before change:  [11.83744055]
curr_Stock_Price:  97.1412299809869
curr_Factors:  [97.14122998 -0.75539123 -1.18702733]
mat_Sqrt:  [[13.92585718  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00716025 -0.01493462  0.47471238]
Stock Position:  -0.007160251640899529
Bond Position:  [12.5329962]


portfolio before change:  [11.85218855]
curr_Stock_Price:  95.95692379486213
curr_Factors:  [95.95692379 -1.02233556 -1.15559689]
mat_Sqrt:  [[10.86956773  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00429343  0.00155913  0.38570263]
Stock Position:  -0.004293429651942409
Bond Position:  [12.26417285]


portfolio before change:  [11.8583642]
curr_Stock_Price:  95.94713346341308
curr_Factors:  [95.94713346 -0.58304594 -1.15717497]
mat_Sqrt:  [[16.83695941  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00434597 0.00786069 0.30202612]
Stock Position:  0.004345970778753655
Bond Position:  [11.44138076]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.86516485]
Stock Price:  96.19530139279718
PL:  [11.86516485]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-4.14005770e-02  4.61425161e-02  4.85850036e-02]
 [ 3.68960171e-01 -5.59612150e-01  5.08094299e-01]
 [-1.32491129e-02 -5.70270901e-02  6.25882066e-02]
 [ 5.56147148e-01 -5.04071020e-01 -2.93077701e-01]
 [-1.30589413e-01  9.19163593e-02 -1.10450849e-01]
 [-5.06239002e-02 -7.38109197e-02 -5.76465980e-02]
 [-2.03379670e-01 -1.76822088e-01  2.52302649e-01]
 [-1.17366147e-01  9.49255859e-02  2.15234623e-01]
 [-1.29691982e-02 -4.56196863e-02  1.87152203e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.69849191]
curr_Stock_Price:  100.7075514726717
curr_Factors:  [100.70755147  -0.88781228  -0.9364543 ]
mat_Sqrt:  [[16.24774609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.001358    0.01489243  0.13859949]
Stock Position:  -0.0013579977714438878
Bond Position:  [7.83525254]


portfolio before change:  [7.70318202]
curr_Stock_Price:  100.13943216318464
curr_Factors:  [100.13943216  -0.93318542  -0.90624741]
mat_Sqrt:  [[15.91290968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02252537 -0.18061404  1.44945161]
Stock Position:  0.022525367214453033
Bond Position:  [5.44750454]


portfolio before change:  [7.78602369]
curr_Stock_Price:  103.69618823649442
curr_Factors:  [103.69618824  -1.29692528  -0.8906533 ]
mat_Sqrt:  [[11.63347567  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0010413  -0.01840541  0.17854673]
Stock Position:  -0.001041301419919077
Bond Position:  [7.89400268]


portfolio before change:  [7.79010856]
curr_Stock_Price:  103.56473568077891
curr_Factors:  [103.56473568  -0.63107316  -0.88592985]
mat_Sqrt:  [[22.7188248   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01731735 -0.16268822 -0.8360691 ]
Stock Position:  0.017317350262715695
Bond Position:  [5.99664176]


portfolio before change:  [7.76417503]
curr_Stock_Price:  101.894006484346
curr_Factors:  [101.89400648  -0.88274418  -0.90683278]
mat_Sqrt:  [[17.01943903  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00789525  0.02966588 -0.31508553]
Stock Position:  -0.007895251381432673
Bond Position:  [8.56865382]


portfolio before change:  [7.74423461]
curr_Stock_Price:  104.96240973192
curr_Factors:  [104.96240973  -1.08341382  -0.97221138]
mat_Sqrt:  [[13.43652957  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0057647  -0.02382237 -0.1644497 ]
Stock Position:  -0.00576469937343785
Bond Position:  [8.34931135]


portfolio before change:  [7.74694859]
curr_Stock_Price:  105.21597442999243
curr_Factors:  [105.21597443  -1.00388011  -0.9769082 ]
mat_Sqrt:  [[14.51564201  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01294963 -0.05706908  0.71974923]
Stock Position:  -0.012949634915412112
Bond Position:  [9.10945704]


portfolio before change:  [7.73116494]
curr_Stock_Price:  106.78663778934057
curr_Factors:  [106.78663779  -0.89134736  -0.98848313]
mat_Sqrt:  [[16.29734684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0033168   0.0306371   0.61400447]
Stock Position:  -0.0033167950865575064
Bond Position:  [8.08535433]


portfolio before change:  [7.73286122]
curr_Stock_Price:  107.49436955686933
curr_Factors:  [107.49436956  -0.95229751  -0.97378751]
mat_Sqrt:  [[15.66381766  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00117858 -0.01472369  0.05338931]
Stock Position:  -0.0011785791775096954
Bond Position:  [7.85955185]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.73757348]
Stock Price:  106.83128099749167
PL:  [0.90629249]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 2.15679959e-02  3.03291477e-02  4.18429879e-02]
 [ 3.17056101e-01 -4.48965599e-01  4.46768334e-01]
 [-3.40532864e-01  4.38883177e-02 -3.25890414e-01]
 [ 3.60227971e-01 -3.16708390e-01 -2.83157394e-01]
 [-2.09952321e-02 -7.58318020e-03  1.21116174e-01]
 [-5.71563961e-02  5.83246851e-02 -4.39162903e-02]
 [-2.66031555e-01 -5.34084775e-02  2.79066721e-01]
 [-5.12639690e-02  4.04815742e-02  2.85949074e-01]
 [ 3.25776207e-01  2.36408273e-01  1.65447704e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.31234881]
curr_Stock_Price:  99.69749759575308
curr_Factors:  [99.6974976  -0.51522382 -1.01238414]
mat_Sqrt:  [[21.63976558  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00167747 0.00978869 0.1193664 ]
Stock Position:  0.0016774706371621162
Bond Position:  [-0.47958843]


portfolio before change:  [-0.31358761]
curr_Stock_Price:  99.10198593153656
curr_Factors:  [99.10198593  0.17491979 -1.06238697]
mat_Sqrt:  [[40.80000911  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00775999 -0.14490302  1.2745057 ]
Stock Position:  0.007759988137475928
Bond Position:  [-1.08261785]


portfolio before change:  [-0.33303182]
curr_Stock_Price:  96.66605881490241
curr_Factors:  [96.66605881  0.10224889 -1.05782035]
mat_Sqrt:  [[37.17702212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01070813  0.01416489 -0.92967464]
Stock Position:  -0.01070812770326441
Bond Position:  [0.70208068]


portfolio before change:  [-0.34107034]
curr_Stock_Price:  97.44954310008468
curr_Factors:  [97.4495431   0.13747431 -1.04775826]
mat_Sqrt:  [[39.21466543  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00606357 -0.10221719 -0.80776923]
Stock Position:  0.006063570295239733
Bond Position:  [-0.9319625]


portfolio before change:  [-0.33628984]
curr_Stock_Price:  98.31480992626703
curr_Factors:  [ 9.83148099e+01  9.57559094e-03 -1.01387102e+00]
mat_Sqrt:  [[36.01297331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.05224482e-05 -2.44746089e-03  3.45510733e-01]
Stock Position:  6.0522448179107244e-05
Bond Position:  [-0.34224009]


portfolio before change:  [-0.33644979]
curr_Stock_Price:  98.500048181917
curr_Factors:  [98.50004818  0.4364496  -1.01425971]
mat_Sqrt:  [[55.2709209   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0009809   0.01882421 -0.12528095]
Stock Position:  -0.0009809008786515402
Bond Position:  [-0.239831]


portfolio before change:  [-0.3286011]
curr_Stock_Price:  90.37625429254577
curr_Factors:  [90.37625429  0.46575533 -0.98806301]
mat_Sqrt:  [[53.60669039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00410339 -0.01723751  0.79609968]
Stock Position:  -0.004103391893587227
Bond Position:  [0.04224809]


portfolio before change:  [-0.31178603]
curr_Stock_Price:  86.28355829736843
curr_Factors:  [86.2835583   0.19595075 -0.9954324 ]
mat_Sqrt:  [[38.78980333  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.96197108e-04 1.30653719e-02 8.15733114e-01]
Stock Position:  0.00039619710802466104
Bond Position:  [-0.34597133]


portfolio before change:  [-0.31232698]
curr_Stock_Price:  85.35494275750688
curr_Factors:  [85.35494276 -0.15601911 -0.98839993]
mat_Sqrt:  [[27.17776879  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01500508 0.07630044 0.47197625]
Stock Position:  0.015005084418256301
Bond Position:  [-1.5930851]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.30525124]
Stock Price:  85.87959694023112
PL:  [-0.30525124]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-2.50488004e-02  4.33271590e-02  4.73241678e-02]
 [ 4.68993082e-01 -6.05735752e-01  6.23241644e-01]
 [ 2.69239191e-02 -8.48481523e-02  1.20810519e-01]
 [ 5.63936835e-01 -5.16427567e-01 -2.29640162e-01]
 [-1.32466163e-01  8.17156905e-02 -1.72176293e-02]
 [-5.56454097e-02 -6.08018994e-02 -3.64229386e-02]
 [-2.64472871e-01 -3.33769605e-02  2.52631109e-01]
 [-1.16913221e-01  7.14711058e-02  1.63614087e-01]
 [-1.25455663e-02 -4.33560582e-02  2.48349030e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.96421049]
curr_Stock_Price:  100.48888307873636
curr_Factors:  [100.48888308  -0.95057655  -1.01227413]
mat_Sqrt:  [[14.11441236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046369  0.01398378  0.13500268]
Stock Position:  -0.00046368744667242453
Bond Position:  [6.01080592]


portfolio before change:  [5.96610361]
curr_Stock_Price:  102.88928744641775
curr_Factors:  [102.88928745  -1.13909063  -1.01196835]
mat_Sqrt:  [[11.97228684  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0394717  -0.19550037  1.77793493]
Stock Position:  0.039471695188751266
Bond Position:  [1.90488901]


portfolio before change:  [6.00397308]
curr_Stock_Price:  103.82455991784336
curr_Factors:  [103.82455992  -1.07731358  -1.023809  ]
mat_Sqrt:  [[12.69972035  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00269807 -0.02738462  0.34463878]
Stock Position:  0.002698067805553322
Bond Position:  [5.72384738]


portfolio before change:  [6.00969833]
curr_Stock_Price:  104.88554568050658
curr_Factors:  [104.88554568  -1.03765122  -1.03880361]
mat_Sqrt:  [[13.14990957  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03130412 -0.16667628 -0.65509946]
Stock Position:  0.03130412381789437
Bond Position:  [2.72634822]


portfolio before change:  [6.0271978]
curr_Stock_Price:  105.40100367810585
curr_Factors:  [105.40100368  -0.93994692  -1.0662736 ]
mat_Sqrt:  [[14.17601766  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00841566  0.02637363 -0.0491171 ]
Stock Position:  -0.008415660473442527
Bond Position:  [6.91421687]


portfolio before change:  [6.04065193]
curr_Stock_Price:  104.21319966285748
curr_Factors:  [104.21319966  -0.51727787  -1.11331721]
mat_Sqrt:  [[20.40630074  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00369941 -0.01962373 -0.10390451]
Stock Position:  -0.003699413608940743
Bond Position:  [6.42617966]


portfolio before change:  [6.04391565]
curr_Stock_Price:  104.19973286938287
curr_Factors:  [104.19973287  -0.71222039  -1.10081006]
mat_Sqrt:  [[17.00111814  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01292373 -0.01077237  0.72068623]
Stock Position:  -0.01292372676191205
Bond Position:  [7.39056452]


portfolio before change:  [6.04478934]
curr_Stock_Price:  104.41813077537837
curr_Factors:  [104.41813078  -1.2002267   -1.07861843]
mat_Sqrt:  [[10.69266714  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00644616  0.0230672   0.46674545]
Stock Position:  -0.006446161309083322
Bond Position:  [6.71788545]


portfolio before change:  [6.05925669]
curr_Stock_Price:  102.6950018520915
curr_Factors:  [102.69500185  -1.27485139  -1.04818965]
mat_Sqrt:  [[10.06156188  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00162263 -0.01399311  0.07084707]
Stock Position:  -0.0016226289177514676
Bond Position:  [6.22589257]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.05975713]
Stock Price:  104.30552521686259
PL:  [1.75423191]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.61204681e-02  9.69371304e-02  4.86763620e-02]
 [ 4.42279511e-01 -6.62084397e-01  6.26965836e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.02981019e-01 -4.41257433e-01 -3.95851158e-01]
 [-7.34239324e-02  9.69579932e-02  7.89103592e-02]
 [-3.51441411e-02  6.98143070e-02 -8.47670931e-02]
 [-3.10382405e-02 -1.73705900e-01  1.67355942e-01]
 [-1.08082217e-01  4.52100090e-02  1.30197859e-01]
 [-6.51148343e-02 -5.55544284e-02  6.95704072e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.04664557]
curr_Stock_Price:  99.60491314362562
curr_Factors:  [99.60491314 -0.81307183 -0.97404449]
mat_Sqrt:  [[16.67807803  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00394792 0.03128632 0.13886011]
Stock Position:  0.00394791879748441
Bond Position:  [-1.43987768]


portfolio before change:  [-1.04232975]
curr_Stock_Price:  100.88050667308478
curr_Factors:  [100.88050667  -0.43759858  -0.95420668]
mat_Sqrt:  [[25.0815236   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01734787 -0.21368682  1.78855902]
Stock Position:  0.017347868154503496
Bond Position:  [-2.79239148]


portfolio before change:  [-1.03798486]
curr_Stock_Price:  101.21146603608994
curr_Factors:  [101.21146604  -0.70525403  -0.91151666]
mat_Sqrt:  [[20.09440385  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00175213 -0.02755111  0.34758667]
Stock Position:  0.001752133383465061
Bond Position:  [-1.21532085]


portfolio before change:  [-1.03944173]
curr_Stock_Price:  100.7268794334745
curr_Factors:  [100.72687943  -1.12900554  -0.93383728]
mat_Sqrt:  [[12.80159628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02594262 -0.14241522 -1.12925317]
Stock Position:  0.025942619681739443
Bond Position:  [-3.65256086]


portfolio before change:  [-1.09521474]
curr_Stock_Price:  98.6474335196995
curr_Factors:  [98.64743352 -1.17459545 -0.92138664]
mat_Sqrt:  [[12.12864643  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309391  0.03129306  0.22510929]
Stock Position:  -0.003093911221375461
Bond Position:  [-0.79000834]


portfolio before change:  [-1.09233097]
curr_Stock_Price:  97.58765071679255
curr_Factors:  [97.58765072 -0.70555159 -0.91897019]
mat_Sqrt:  [[19.22533944  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198677  0.02253247 -0.24181692]
Stock Position:  -0.0019867719816735363
Bond Position:  [-0.89844656]


portfolio before change:  [-1.09235316]
curr_Stock_Price:  97.3726542217529
curr_Factors:  [97.37265422 -1.21924215 -0.97652613]
mat_Sqrt:  [[10.83495121  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00298427 -0.05606334  0.47741992]
Stock Position:  -0.0029842700465763598
Bond Position:  [-0.80176686]


portfolio before change:  [-1.09917638]
curr_Stock_Price:  99.5246849851702
curr_Factors:  [99.52468499 -1.10355278 -1.00956347]
mat_Sqrt:  [[12.0286277   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00600877  0.01459147  0.37141825]
Stock Position:  -0.006008768248828362
Bond Position:  [-0.50115562]


portfolio before change:  [-1.10515578]
curr_Stock_Price:  100.47808417150706
curr_Factors:  [100.47808417  -0.90576926  -1.0252736 ]
mat_Sqrt:  [[14.56901155  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00427303 -0.01793011  0.19846501]
Stock Position:  -0.004273030769649432
Bond Position:  [-0.67580983]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.11283155]
Stock Price:  102.1953155956493
PL:  [-3.30814715]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-5.34001763e-02  5.29592960e-02  4.98401118e-02]
 [ 5.06971069e-01 -5.82704142e-01  6.46603252e-01]
 [ 1.15419474e-02 -8.17503489e-02  1.18348735e-01]
 [ 4.93003376e-01 -4.31006146e-01 -4.00877147e-01]
 [-1.04098670e-01  1.15848194e-01 -3.53125809e-02]
 [-5.15563695e-02  3.47515312e-02  6.56967504e-02]
 [-2.07609968e-01  1.53302490e-01  1.79420195e-01]
 [-1.17079132e-01  8.00626720e-02  1.82523108e-01]
 [-3.48675011e-02 -4.80298479e-02  3.25554022e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.45667095]
curr_Stock_Price:  100.67706126496762
curr_Factors:  [100.67706126  -1.27669666  -0.89715657]
mat_Sqrt:  [[11.45085907  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00283091  0.01709254  0.14217997]
Stock Position:  -0.0028309085702586333
Bond Position:  [7.74167851]


portfolio before change:  [7.4565165]
curr_Stock_Price:  102.09931113707438
curr_Factors:  [102.09931114  -1.12841842  -0.90337816]
mat_Sqrt:  [[13.38519704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03884996 -0.18806695  1.8445791 ]
Stock Position:  0.03884996375875141
Bond Position:  [3.48996196]


portfolio before change:  [7.35304587]
curr_Stock_Price:  99.39104486270013
curr_Factors:  [99.39104486 -1.30010217 -0.90013913]
mat_Sqrt:  [[11.01018467  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00172682 -0.02638481  0.337616  ]
Stock Position:  0.001726815869562993
Bond Position:  [7.18141584]


portfolio before change:  [7.35861609]
curr_Stock_Price:  100.5368595954722
curr_Factors:  [100.5368596   -1.08499551  -0.94670227]
mat_Sqrt:  [[13.18166221  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0245186  -0.13910664 -1.14359092]
Stock Position:  0.02451860050738231
Bond Position:  [4.89359299]


portfolio before change:  [7.33830434]
curr_Stock_Price:  99.60861938485311
curr_Factors:  [99.60861938 -1.55920995 -0.92464543]
mat_Sqrt:  [[ 8.30944917  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01054936  0.03738984 -0.10073696]
Stock Position:  -0.010549364308663229
Bond Position:  [8.38911196]


portfolio before change:  [7.33566662]
curr_Stock_Price:  100.25636718288791
curr_Factors:  [100.25636718  -1.44116435  -0.94665666]
mat_Sqrt:  [[ 9.20649821  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337288  0.01121601  0.18741454]
Stock Position:  -0.003372883935717415
Bond Position:  [7.67381971]


portfolio before change:  [7.34011019]
curr_Stock_Price:  100.07678723977759
curr_Factors:  [100.07678724  -0.64092762  -0.96748281]
mat_Sqrt:  [[20.03593338  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00697214  0.04947817  0.51183588]
Stock Position:  -0.006972135106766771
Bond Position:  [8.03785907]


portfolio before change:  [7.32305518]
curr_Stock_Price:  103.09952593309441
curr_Factors:  [103.09952593  -1.05490197  -0.98651339]
mat_Sqrt:  [[13.38693761  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00474186  0.02584012  0.52068762]
Stock Position:  -0.004741863731043948
Bond Position:  [7.81193909]


portfolio before change:  [7.33342684]
curr_Stock_Price:  101.7362000804633
curr_Factors:  [101.73620008  -0.41601709  -0.94574549]
mat_Sqrt:  [[26.0657087   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00145886 -0.01550157  0.0928715 ]
Stock Position:  -0.0014588595912045157
Bond Position:  [7.48184567]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.34218052]
Stock Price:  98.30075628564613
PL:  [7.34218052]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 6.10804331e-02  1.29134870e-01  5.08152989e-02]
 [ 2.32262562e-01 -1.98897521e-01  2.85883526e-01]
 [-3.54602886e-02 -6.68584376e-02  9.67697028e-02]
 [ 4.33806408e-01 -3.67974399e-01 -4.03994222e-01]
 [-1.00262936e-01  1.02299246e-01  3.29417804e-03]
 [-9.45816955e-02  3.44364202e-02  5.58535385e-02]
 [-1.02904454e-01 -1.08106939e-01  1.68867320e-01]
 [-1.16805863e-01  6.59116186e-02  1.51378314e-01]
 [ 1.20336338e-02 -3.75043854e-02  1.45237294e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.69195268]
curr_Stock_Price:  98.89311964662313
curr_Factors:  [98.89311965 -1.10486006 -0.99489437]
mat_Sqrt:  [[12.11307244  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00807496 0.0416781  0.1449619 ]
Stock Position:  0.00807496264216379
Bond Position:  [-7.49051093]


portfolio before change:  [-6.69730992]
curr_Stock_Price:  98.69360844022299
curr_Factors:  [98.69360844 -1.14724209 -0.97371733]
mat_Sqrt:  [[11.83499441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02112536 -0.0641939   0.81554613]
Stock Position:  0.021125359048999336
Bond Position:  [-8.78224783]


portfolio before change:  [-6.69457286]
curr_Stock_Price:  99.03108347189306
curr_Factors:  [99.03108347 -1.39079816 -0.96377504]
mat_Sqrt:  [[ 9.40141837  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00312237 -0.02157847  0.27605703]
Stock Position:  -0.003122366857235394
Bond Position:  [-6.38536148]


portfolio before change:  [-6.69776015]
curr_Stock_Price:  99.02910186147234
curr_Factors:  [99.02910186 -1.0283115  -0.9891297 ]
mat_Sqrt:  [[13.17040894  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02097345 -0.11876323 -1.15248306]
Stock Position:  0.020973454514344993
Bond Position:  [-8.77474251]


portfolio before change:  [-6.68159551]
curr_Stock_Price:  100.00906010921187
curr_Factors:  [100.00906011  -0.84654859  -0.92095551]
mat_Sqrt:  [[17.07741246  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00460894  0.03301694  0.00939737]
Stock Position:  -0.004608939983882782
Bond Position:  [-6.22065975]


portfolio before change:  [-6.68660759]
curr_Stock_Price:  100.42151326688855
curr_Factors:  [100.42151327  -0.72208502  -0.89673548]
mat_Sqrt:  [[19.89674108  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00382733  0.01111431  0.1593346 ]
Stock Position:  -0.003827327027554249
Bond Position:  [-6.30226161]


portfolio before change:  [-6.68976512]
curr_Stock_Price:  100.42298122085305
curr_Factors:  [100.42298122  -1.03172514  -0.93987768]
mat_Sqrt:  [[13.98224435  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00647262 -0.03489136  0.48173146]
Stock Position:  -0.006472622813855143
Bond Position:  [-6.03976504]


portfolio before change:  [-6.71345549]
curr_Stock_Price:  103.61638988265197
curr_Factors:  [103.61638988  -1.33436768  -0.98173196]
mat_Sqrt:  [[10.22254811  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00708744  0.02127288  0.43184019]
Stock Position:  -0.007087444373574633
Bond Position:  [-5.97908009]


portfolio before change:  [-6.72113602]
curr_Stock_Price:  104.27815762608749
curr_Factors:  [104.27815763  -1.85341298  -1.01704812]
mat_Sqrt:  [[ 5.90973401  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00124248 -0.01210449  0.04143216]
Stock Position:  0.0012424801151763305
Bond Position:  [-6.85069956]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.72378167]
Stock Price:  104.90638000031097
PL:  [-11.63016167]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 2.52892777e-02  8.14058752e-02  5.27555242e-02]
 [ 1.47618242e-01  5.07304874e-02  1.25281843e-01]
 [-9.09403339e-02 -3.73905052e-02  3.19128611e-02]
 [ 3.90260970e-01 -3.33315754e-01 -3.51884612e-01]
 [-5.38666675e-02  9.00332181e-02  1.39835670e-01]
 [-2.06993899e-02  7.57545408e-02 -1.09860067e-01]
 [-6.82938825e-02 -1.15698525e-01  1.59743148e-01]
 [-5.72557015e-02 -1.04313584e-02  1.53465654e-01]
 [ 2.13840314e-02  6.08543352e-03  9.92442464e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.51250041]
curr_Stock_Price:  98.41140253588087
curr_Factors:  [98.41140254 -1.28159062 -0.98768014]
mat_Sqrt:  [[10.17451355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00517714 0.02627363 0.15049683]
Stock Position:  0.005177137790402304
Bond Position:  [-11.0219898]


portfolio before change:  [-10.52075235]
curr_Stock_Price:  97.88223494229253
curr_Factors:  [97.88223494 -1.39678297 -1.01674814]
mat_Sqrt:  [[ 8.76033339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02095201 0.01637319 0.35739423]
Stock Position:  0.0209520118018342
Bond Position:  [-12.57158209]


portfolio before change:  [-10.50853449]
curr_Stock_Price:  98.76545442535135
curr_Factors:  [98.76545443 -1.06795675 -1.03056475]
mat_Sqrt:  [[12.11235976  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00760037 -0.01206773  0.09103851]
Stock Position:  -0.007600373106493869
Bond Position:  [-9.75788019]


portfolio before change:  [-10.50864938]
curr_Stock_Price:  98.13847627412525
curr_Factors:  [98.13847627 -1.0916328  -1.06312105]
mat_Sqrt:  [[11.37736268  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02200818 -0.1075772  -1.00382885]
Stock Position:  0.022008178687677998
Bond Position:  [-12.6684985]


portfolio before change:  [-10.52130173]
curr_Stock_Price:  97.85146878630897
curr_Factors:  [97.85146879 -0.86766437 -1.06136782]
mat_Sqrt:  [[14.21671687  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004885   0.0290581   0.39891225]
Stock Position:  -0.00048850077096932
Bond Position:  [-10.47350121]


portfolio before change:  [-10.52605278]
curr_Stock_Price:  96.85453258837244
curr_Factors:  [96.85453259 -0.95419431 -1.03819814]
mat_Sqrt:  [[13.20793438  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00209428  0.02444967 -0.31340019]
Stock Position:  -0.0020942829102802095
Bond Position:  [-10.32321199]


portfolio before change:  [-10.53127707]
curr_Stock_Price:  96.88384598866759
curr_Factors:  [96.88384599 -0.9602353  -1.05071569]
mat_Sqrt:  [[12.96899893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0045727  -0.03734154  0.45570274]
Stock Position:  -0.00457269770102494
Bond Position:  [-10.08825653]


portfolio before change:  [-10.52498976]
curr_Stock_Price:  94.40550688171767
curr_Factors:  [94.40550688 -1.03749584 -1.04899865]
mat_Sqrt:  [[11.71775148  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00239457 -0.00336671  0.43779479]
Stock Position:  -0.0023945676220477204
Bond Position:  [-10.29892939]


portfolio before change:  [-10.53395661]
curr_Stock_Price:  95.99915425309595
curr_Factors:  [95.99915425 -1.05985781 -1.08558711]
mat_Sqrt:  [[11.23343344  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00381756 0.00196407 0.28311621]
Stock Position:  0.003817564992489316
Bond Position:  [-10.90043962]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.53633005]
Stock Price:  96.80546624545306
PL:  [-10.53633005]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.93562756e-02  9.97859820e-02  4.87542123e-02]
 [ 2.21223158e-01 -1.66340764e-01  2.64937680e-01]
 [ 2.77531032e-02 -8.53620960e-02  1.21842036e-01]
 [ 4.77047977e-01 -4.13708804e-01 -4.01163437e-01]
 [-1.20577346e-01  5.89508707e-02  6.60642862e-02]
 [-6.37977127e-02 -3.97777928e-02 -3.19553165e-03]
 [-3.24799161e-01  3.09186551e-01  2.27519064e-01]
 [-1.04089072e-01  8.72835501e-02  2.36872813e-01]
 [-1.54671352e-03 -3.67890549e-02  2.19055808e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.90519156]
curr_Stock_Price:  99.4966626203752
curr_Factors:  [99.49666262 -0.99765903 -0.99936698]
mat_Sqrt:  [[13.50551465  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00515915 0.03220579 0.1390822 ]
Stock Position:  0.005159145544140285
Bond Position:  [-2.41850932]


portfolio before change:  [-1.91158734]
curr_Stock_Price:  98.4914147592445
curr_Factors:  [98.49141476 -0.88696912 -0.92631121]
mat_Sqrt:  [[16.06573998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0150226  -0.05368625  0.75579346]
Stock Position:  0.015022598968032784
Bond Position:  [-3.39118436]


portfolio before change:  [-1.89618567]
curr_Stock_Price:  99.62954550797139
curr_Factors:  [99.62954551 -0.50823349 -0.89244354]
mat_Sqrt:  [[24.55171552  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00143369 -0.0275505   0.34758141]
Stock Position:  0.0014336896190210123
Bond Position:  [-2.03902351]


portfolio before change:  [-1.89657865]
curr_Stock_Price:  100.06672673189249
curr_Factors:  [100.06672673  -0.15593752  -0.84761748]
mat_Sqrt:  [[36.6818555   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00847048 -0.13352394 -1.14440762]
Stock Position:  0.008470478746048227
Bond Position:  [-2.74419174]


portfolio before change:  [-1.84167424]
curr_Stock_Price:  106.71060810907284
curr_Factors:  [106.71060811  -0.50789396  -0.8526279 ]
mat_Sqrt:  [[27.37413839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00347257  0.01902631  0.18846302]
Stock Position:  -0.0034725744491534
Bond Position:  [-1.47111371]


portfolio before change:  [-1.83140984]
curr_Stock_Price:  103.54288987582392
curr_Factors:  [103.54288988  -0.14109328  -0.84628034]
mat_Sqrt:  [[38.57530503  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188125 -0.01283823 -0.00911596]
Stock Position:  -0.0018812451574919489
Bond Position:  [-1.63662028]


portfolio before change:  [-1.82467551]
curr_Stock_Price:  99.52808016209056
curr_Factors:  [99.52808016 -0.13472575 -0.77277035]
mat_Sqrt:  [[40.16290156  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00535929  0.09978953  0.64904856]
Stock Position:  -0.005359288741546846
Bond Position:  [-1.29127579]


portfolio before change:  [-1.81711522]
curr_Stock_Price:  97.99688899848894
curr_Factors:  [97.996889   -0.30553949 -0.75895288]
mat_Sqrt:  [[33.79941079  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00112194  0.02817064  0.6757322 ]
Stock Position:  -0.0011219405956492143
Bond Position:  [-1.70716853]


portfolio before change:  [-1.82218815]
curr_Stock_Price:  101.75745447340691
curr_Factors:  [ 1.01757454e+02  6.22485332e-03 -7.97109783e-01]
mat_Sqrt:  [[46.14124125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-9.93642526e-05 -1.18736164e-02  6.24905247e-02]
Stock Position:  -9.936425256845219e-05
Bond Position:  [-1.81207709]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.82331137]
Stock Price:  103.94089804239341
PL:  [-5.76420941]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 7.30620113e-02  1.49836619e-01  5.14174216e-02]
 [ 4.95315593e-01 -6.02762115e-01  6.45955026e-01]
 [ 1.88507824e-02 -6.84694967e-02  7.87875098e-02]
 [ 5.63903841e-01 -5.02855777e-01 -3.63302054e-01]
 [-1.40919269e-01  1.28528590e-01 -1.49187379e-01]
 [-9.45816955e-02  3.44364202e-02  5.58535385e-02]
 [-1.17725622e-02 -3.48357495e-01  1.78949742e-01]
 [-1.13193969e-01  4.28508201e-02  1.09899374e-01]
 [-5.44499690e-02 -5.45904437e-02  4.32301770e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.6741293]
curr_Stock_Price:  98.89536692310939
curr_Factors:  [98.89536692 -0.75977577 -1.00135339]
mat_Sqrt:  [[16.99523889  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00671616 0.04835956 0.14667959]
Stock Position:  0.006716164514366758
Bond Position:  [-7.33832685]


portfolio before change:  [-6.65789691]
curr_Stock_Price:  101.85873571066985
curr_Factors:  [101.85873571  -0.96836294  -0.978943  ]
mat_Sqrt:  [[14.53095169  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03469369 -0.19454064  1.84272989]
Stock Position:  0.034693688289788804
Bond Position:  [-10.19175213]


portfolio before change:  [-6.65499502]
curr_Stock_Price:  102.08929735137382
curr_Factors:  [102.08929735  -1.51551896  -0.89602905]
mat_Sqrt:  [[ 9.15499733  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00228913 -0.02209844  0.22475884]
Stock Position:  0.002289125521255981
Bond Position:  [-6.88869024]


portfolio before change:  [-6.65920117]
curr_Stock_Price:  101.75688009260793
curr_Factors:  [101.75688009  -1.92310017  -0.91223459]
mat_Sqrt:  [[ 5.97301412  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06480817 -0.162296   -1.03639964]
Stock Position:  0.06480816989292928
Bond Position:  [-13.25387835]


portfolio before change:  [-6.70319952]
curr_Stock_Price:  101.1802591195988
curr_Factors:  [101.18025912  -1.46298862  -0.88488976]
mat_Sqrt:  [[ 9.66997075  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01500896  0.04148242 -0.42559007]
Stock Position:  -0.015008962345312094
Bond Position:  [-5.18458882]


portfolio before change:  [-6.71010682]
curr_Stock_Price:  101.46771142146036
curr_Factors:  [101.46771142  -1.53061001  -0.95130144]
mat_Sqrt:  [[ 8.4810069   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00897904  0.01111431  0.1593346 ]
Stock Position:  -0.008979044095753229
Bond Position:  [-5.79902377]


portfolio before change:  [-6.71438246]
curr_Stock_Price:  101.6208898588917
curr_Factors:  [101.62088986  -1.55900785  -0.93863995]
mat_Sqrt:  [[ 8.36119468  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0055438 -0.1124319  0.5104938]
Stock Position:  -0.005543798083402913
Bond Position:  [-6.15101676]


portfolio before change:  [-6.71704125]
curr_Stock_Price:  101.54558408323342
curr_Factors:  [101.54558408  -1.48817286  -0.96232175]
mat_Sqrt:  [[ 8.75839957  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00936404  0.01383004  0.31351232]
Stock Position:  -0.009364035643363048
Bond Position:  [-5.76616479]


portfolio before change:  [-6.71581179]
curr_Stock_Price:  101.10632174089697
curr_Factors:  [101.10632174  -1.19019933  -0.89781068]
mat_Sqrt:  [[12.53046201  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00453047 -0.01761899  0.12332366]
Stock Position:  -0.004530469325996589
Bond Position:  [-6.2577527]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.71125199]
Stock Price:  99.40904487962055
PL:  [-6.71125199]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 5.04360282e-02  1.28903549e-01  5.27358079e-02]
 [ 4.43102543e-01 -6.11865022e-01  6.02509809e-01]
 [-2.01405250e-01  2.43392059e-02 -1.20541161e-01]
 [ 3.11904715e-01 -2.73341187e-01 -2.45136532e-01]
 [ 2.79573950e-02  7.24322877e-02  1.74408098e-01]
 [ 4.16220858e-02  7.22277770e-02 -1.34570339e-01]
 [-5.29532662e-02 -1.10445137e-01  1.59200872e-01]
 [-9.47227669e-02  6.68353401e-02  2.18146796e-01]
 [ 1.81026367e-02  1.60305290e-03  1.01386928e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.91604997]
curr_Stock_Price:  98.61269238922232
curr_Factors:  [98.61269239 -0.93626582 -1.02404546]
mat_Sqrt:  [[13.88610498  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0063022  0.04160344 0.15044058]
Stock Position:  0.006302199700390019
Bond Position:  [-9.53752685]


portfolio before change:  [-8.90543162]
curr_Stock_Price:  101.05442821372633
curr_Factors:  [101.05442821  -0.7810186   -1.10998905]
mat_Sqrt:  [[15.25109973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0289286  -0.19747859  1.71879278]
Stock Position:  0.02892859699746791
Bond Position:  [-11.82879445]


portfolio before change:  [-8.98761596]
curr_Stock_Price:  98.41798964706686
curr_Factors:  [98.41798965 -0.76490708 -1.09702574]
mat_Sqrt:  [[15.2914032   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01445534  0.00785544 -0.34387038]
Stock Position:  -0.014455337336198758
Bond Position:  [-7.56495072]


portfolio before change:  [-8.96226321]
curr_Stock_Price:  96.40238982235373
curr_Factors:  [96.40238982 -0.70945583 -1.12576754]
mat_Sqrt:  [[15.38368641  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01339542 -0.08822049 -0.69930629]
Stock Position:  0.013395416973456274
Bond Position:  [-10.25361342]


portfolio before change:  [-8.97367637]
curr_Stock_Price:  95.93319438421962
curr_Factors:  [95.93319438 -0.88387    -1.09292221]
mat_Sqrt:  [[13.28797973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00589582 0.02337742 0.49753776]
Stock Position:  0.005895815557600514
Bond Position:  [-9.53928079]


portfolio before change:  [-8.98475611]
curr_Stock_Price:  94.86312891801639
curr_Factors:  [94.86312892 -0.82580526 -1.10627781]
mat_Sqrt:  [[13.74055993  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.002103    0.02331141 -0.38389172]
Stock Position:  0.002103004810544008
Bond Position:  [-9.18425372]


portfolio before change:  [-8.98725848]
curr_Stock_Price:  95.85737621025413
curr_Factors:  [95.85737621 -0.98665811 -1.04751841]
mat_Sqrt:  [[12.53700782  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00342993 -0.03564601  0.45415577]
Stock Position:  -0.0034299287504345253
Bond Position:  [-8.65847451]


portfolio before change:  [-8.99339414]
curr_Stock_Price:  96.3837263228659
curr_Factors:  [96.38372632 -0.18313622 -1.06135824]
mat_Sqrt:  [[27.7668516   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131635  0.02157101  0.62231209]
Stock Position:  -0.0013163549266311109
Bond Position:  [-8.86651895]


portfolio before change:  [-8.99986868]
curr_Stock_Price:  97.9335898068328
curr_Factors:  [97.93358981 -0.25083391 -1.08584077]
mat_Sqrt:  [[25.72890109  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00152068 0.00051738 0.28922869]
Stock Position:  0.0015206781834813017
Bond Position:  [-9.14879415]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.00153583]
Stock Price:  99.84614990287395
PL:  [-9.00153583]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.09980350e-02  5.98596869e-02  5.08225078e-02]
 [ 2.56056949e-01 -2.69070516e-01  3.31030307e-01]
 [-3.69600333e-02 -6.87251737e-02  1.02787369e-01]
 [ 3.95268149e-01 -3.36649738e-01 -3.56672141e-01]
 [-8.77621848e-02  9.82516403e-02  4.30378728e-02]
 [-4.93188968e-02  5.02222352e-02 -8.14124649e-04]
 [-2.40200522e-01  2.02370673e-01  1.91040550e-01]
 [-1.15571960e-01  1.25080129e-01  2.92841933e-01]
 [-2.49692277e-02 -4.73493040e-02  2.70316586e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.25488194]
curr_Stock_Price:  98.31779870928682
curr_Factors:  [98.31779871 -1.5194833  -1.00344318]
mat_Sqrt:  [[ 7.88749508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00679442 0.01931963 0.14498247]
Stock Position:  0.006794418611553959
Bond Position:  [-11.92289422]


portfolio before change:  [-11.25574136]
curr_Stock_Price:  99.06893180017201
curr_Factors:  [99.0689318  -1.51882353 -1.02987827]
mat_Sqrt:  [[ 7.74551597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03469161 -0.08684214  0.94433733]
Stock Position:  0.03469161248764093
Bond Position:  [-14.69260236]


portfolio before change:  [-11.26681866]
curr_Stock_Price:  98.96143726361635
curr_Factors:  [98.96143726 -0.96943643 -1.00429926]
mat_Sqrt:  [[13.74939141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00218243 -0.02218095  0.29322375]
Stock Position:  -0.002182432367916211
Bond Position:  [-11.05084202]


portfolio before change:  [-11.27034838]
curr_Stock_Price:  98.0463669377027
curr_Factors:  [98.04636694 -1.05199911 -0.97058986]
mat_Sqrt:  [[12.9727569   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01955979 -0.10865324 -1.01748634]
Stock Position:  0.01955979095839185
Bond Position:  [-13.18811483]


portfolio before change:  [-11.24894221]
curr_Stock_Price:  99.47797109464979
curr_Factors:  [99.47797109 -0.88270659 -0.93960466]
mat_Sqrt:  [[16.08078332  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0036641   0.03171058  0.12277507]
Stock Position:  -0.0036640991041085795
Bond Position:  [-10.88444507]


portfolio before change:  [-11.25311456]
curr_Stock_Price:  99.1310279513054
curr_Factors:  [99.13102795 -0.96160777 -0.95200863]
mat_Sqrt:  [[14.62637039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268238  0.01620916 -0.00232247]
Stock Position:  -0.002682381715020907
Bond Position:  [-10.9872073]


portfolio before change:  [-11.25827879]
curr_Stock_Price:  99.00772226300037
curr_Factors:  [99.00772226 -0.45572587 -0.92300552]
mat_Sqrt:  [[24.93983828  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00641126  0.06531485  0.54498551]
Stock Position:  -0.006411260198946178
Bond Position:  [-10.62351452]


portfolio before change:  [-11.28308287]
curr_Stock_Price:  102.04784234512354
curr_Factors:  [ 1.02047842e+02 -7.61537372e-02 -9.84009032e-01]
mat_Sqrt:  [[35.34931367  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085614  0.04036944  0.83539652]
Stock Position:  -0.0008561404168471665
Bond Position:  [-11.19571559]


portfolio before change:  [-11.29200909]
curr_Stock_Price:  105.93384332549262
curr_Factors:  [ 1.05933843e+02  2.32899294e-02 -9.95046882e-01]
mat_Sqrt:  [[40.08722988  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00072633 -0.01528192  0.0771138 ]
Stock Position:  -0.0007263298016212328
Bond Position:  [-11.21506618]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.29900303]
Stock Price:  107.84069948709103
PL:  [-19.13970252]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-6.99434572e-02  6.23572685e-02  5.15704702e-02]
 [ 3.43931591e-01 -4.78587682e-01  4.73915898e-01]
 [-1.58808192e-02 -5.60889857e-02  6.12601086e-02]
 [ 5.63750682e-01 -5.10656005e-01 -3.05882312e-01]
 [-1.47729320e-01  1.06533462e-01 -1.34137290e-01]
 [-8.12826505e-02  2.74780385e-03  3.51284738e-02]
 [-3.80200615e-01  3.08441259e-01  2.73458394e-01]
 [-1.15308660e-01  1.26561598e-01  2.98505994e-01]
 [-2.96786184e-02 -4.89542541e-02  2.75986931e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.49776922]
curr_Stock_Price:  101.0605008072103
curr_Factors:  [101.06050081  -1.63811279  -0.98698909]
mat_Sqrt:  [[ 7.32005234  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0063781   0.02012572  0.1471162 ]
Stock Position:  -0.006378103974792397
Bond Position:  [11.1423436]


portfolio before change:  [10.49145558]
curr_Stock_Price:  102.92409674162957
curr_Factors:  [102.92409674  -2.07426309  -0.98813301]
mat_Sqrt:  [[ 4.81432424  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07124114 -0.15446351  1.35195014]
Stock Position:  0.07124114410439589
Bond Position:  [3.15902517]


portfolio before change:  [10.48036172]
curr_Stock_Price:  102.74619720632276
curr_Factors:  [102.74619721  -1.31396555  -0.99310725]
mat_Sqrt:  [[10.22861353  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00144939 -0.01810264  0.17475804]
Stock Position:  -0.0014493917567486587
Bond Position:  [10.62928121]


portfolio before change:  [10.4848145]
curr_Stock_Price:  103.34174942581616
curr_Factors:  [103.34174943  -1.18906583  -0.99162519]
mat_Sqrt:  [[11.67383993  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03401413 -0.16481352 -0.8725971 ]
Stock Position:  0.03401412891831942
Bond Position:  [6.96973491]


portfolio before change:  [10.46748822]
curr_Stock_Price:  102.7298856123785
curr_Factors:  [102.72988561  -0.88534797  -0.98636254]
mat_Sqrt:  [[15.80604653  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00970286  0.03438353 -0.38265635]
Stock Position:  -0.009702864523457061
Bond Position:  [11.46426238]


portfolio before change:  [10.47837631]
curr_Stock_Price:  102.19864820463125
curr_Factors:  [102.1986482   -0.401956    -1.01809735]
mat_Sqrt:  [[24.701528    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0029776   0.00088685  0.10021176]
Stock Position:  -0.0029775966753408586
Bond Position:  [10.78268267]


portfolio before change:  [10.48023489]
curr_Stock_Price:  103.38554849995575
curr_Factors:  [103.3855485   -0.2924881   -1.00231211]
mat_Sqrt:  [[28.32273918  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00923007  0.09954899  0.78010068]
Stock Position:  -0.009230069309097809
Bond Position:  [11.43449067]


portfolio before change:  [10.46853853]
curr_Stock_Price:  105.27232048170701
curr_Factors:  [105.27232048  -0.15341239  -0.96659407]
mat_Sqrt:  [[34.34800921  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-8.30968131e-04  4.08475800e-02  8.51554513e-01]
Stock Position:  -0.0008309681312590059
Bond Position:  [10.55601647]


portfolio before change:  [10.47265039]
curr_Stock_Price:  106.67727221124304
curr_Factors:  [106.67727221   0.12700851  -0.90881434]
mat_Sqrt:  [[48.81327482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069731 -0.01579992  0.07873139]
Stock Position:  -0.0006973062996207621
Bond Position:  [10.54703712]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.47650521]
Stock Price:  108.71370227009295
PL:  [1.76280294]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-8.40264123e-04  6.43963687e-02  4.77871240e-02]
 [ 2.47520751e-01 -2.43896066e-01  3.14833972e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.58688767e-01 -3.95061573e-01 -4.03529023e-01]
 [-9.23761267e-02  1.04487417e-01  1.79663880e-02]
 [-4.76276350e-02  4.33803256e-02  2.81948439e-02]
 [-4.19143918e-02 -2.00107226e-01  1.61835332e-01]
 [-7.71380505e-02 -3.74279649e-03  1.10327652e-01]
 [-5.44450518e-03 -1.34915176e-02  9.23759815e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.27483]
curr_Stock_Price:  99.89761842716969
curr_Factors:  [99.89761843 -1.38287328 -1.02342145]
mat_Sqrt:  [[ 9.00564068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00244948 0.02078384 0.13632336]
Stock Position:  0.0024494754135793223
Bond Position:  [1.03013324]


portfolio before change:  [1.27313404]
curr_Stock_Price:  98.99491529287103
curr_Factors:  [98.99491529 -1.56779835 -1.03870191]
mat_Sqrt:  [[ 7.3050671   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03586564 -0.07871712  0.89813369]
Stock Position:  0.03586563769722203
Bond Position:  [-2.27738172]


portfolio before change:  [1.33299644]
curr_Stock_Price:  100.69574579178432
curr_Factors:  [100.69574579  -1.13616356  -1.06369245]
mat_Sqrt:  [[11.15901338  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00315512 -0.02755111  0.34758667]
Stock Position:  0.0031551244360227644
Bond Position:  [1.01528883]


portfolio before change:  [1.33084251]
curr_Stock_Price:  99.85213329597673
curr_Factors:  [99.8521333  -1.36006283 -1.0450641 ]
mat_Sqrt:  [[ 9.01205834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03280906 -0.12750557 -1.15115598]
Stock Position:  0.03280905796202192
Bond Position:  [-1.94521192]


portfolio before change:  [1.32355287]
curr_Stock_Price:  99.65960136482443
curr_Factors:  [99.65960136 -1.08707823 -1.09643891]
mat_Sqrt:  [[11.22612051  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0060021   0.03372317  0.0512531 ]
Stock Position:  -0.006002104510543385
Bond Position:  [1.92172021]


portfolio before change:  [1.32545928]
curr_Stock_Price:  99.50210532834106
curr_Factors:  [99.50210533 -1.21069257 -1.04349235]
mat_Sqrt:  [[10.44364734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00316148  0.01400094  0.08043204]
Stock Position:  -0.003161483108821851
Bond Position:  [1.6400335]


portfolio before change:  [1.32819508]
curr_Stock_Price:  98.89619206978122
curr_Factors:  [98.89619207 -1.18692481 -0.93660352]
mat_Sqrt:  [[11.82886116  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00420384 -0.06458433  0.46167116]
Stock Position:  -0.004203837449143837
Bond Position:  [1.7439386]


portfolio before change:  [1.33539774]
curr_Stock_Price:  97.3903141241006
curr_Factors:  [97.39031412 -1.51195671 -0.95482901]
mat_Sqrt:  [[ 8.26426708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00670132 -0.00120798  0.31473408]
Stock Position:  -0.006701321173242559
Bond Position:  [1.98804151]


portfolio before change:  [1.34544561]
curr_Stock_Price:  96.03929635975764
curr_Factors:  [96.03929636 -1.61329361 -0.90074926]
mat_Sqrt:  [[ 7.77345383  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00137104 -0.00435437  0.26352296]
Stock Position:  0.0013710403150573964
Bond Position:  [1.21377186]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.34597104]
Stock Price:  95.97977446559334
PL:  [1.34597104]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-7.86450820e-02  6.73005220e-02  5.24806239e-02]
 [ 4.68091614e-01 -5.61798157e-01  6.00353557e-01]
 [-2.47954569e-02 -5.29112522e-02  5.67613114e-02]
 [ 4.74601234e-01 -4.12542555e-01 -4.01513284e-01]
 [-1.02208572e-01  7.10439078e-02 -6.16775363e-02]
 [-8.49761551e-02  3.57706369e-02  6.36490262e-02]
 [ 1.12916243e-02 -2.68110457e-01  1.87280174e-01]
 [-1.01850890e-01  4.59699213e-02  1.50165398e-01]
 [ 6.37763586e-02  3.75513149e-02  1.09337031e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.18718438]
curr_Stock_Price:  101.65176983033552
curr_Factors:  [101.65176983  -1.09900695  -1.00257596]
mat_Sqrt:  [[12.42822428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00436063  0.02172115  0.14971261]
Stock Position:  -0.004360627614873459
Bond Position:  [15.6304499]


portfolio before change:  [15.19073936]
curr_Stock_Price:  102.62919827835313
curr_Factors:  [102.62919828  -1.36248265  -1.07415884]
mat_Sqrt:  [[ 8.97534147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05302993 -0.18131958  1.71264159]
Stock Position:  0.05302992687183167
Bond Position:  [9.74832048]


portfolio before change:  [15.14192919]
curr_Stock_Price:  101.61683501931589
curr_Factors:  [101.61683502  -1.33205644  -1.0329261 ]
mat_Sqrt:  [[ 9.54699722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00251488 -0.01707703  0.16192422]
Stock Position:  -0.0025148815217353863
Bond Position:  [15.39748349]


portfolio before change:  [15.15295655]
curr_Stock_Price:  100.29403294982242
curr_Factors:  [100.29403295  -1.31305744  -1.04353971]
mat_Sqrt:  [[ 9.50206413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03245956 -0.13314754 -1.14540564]
Stock Position:  0.032459555892923285
Bond Position:  [11.89745678]


portfolio before change:  [15.18113152]
curr_Stock_Price:  100.97872376433706
curr_Factors:  [100.97872376  -0.75685317  -1.01122555]
mat_Sqrt:  [[17.23308562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00582001  0.02292932 -0.17594884]
Stock Position:  -0.005820006459850433
Bond Position:  [15.76882835]


portfolio before change:  [15.19476891]
curr_Stock_Price:  99.9905800447444
curr_Factors:  [99.99058004 -0.82766442 -1.03128959]
mat_Sqrt:  [[15.58208682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00415106  0.01154492  0.18157296]
Stock Position:  -0.004151061542688967
Bond Position:  [15.60983596]


portfolio before change:  [15.20966429]
curr_Stock_Price:  98.28294210377562
curr_Factors:  [98.2829421  -1.60814354 -0.96938359]
mat_Sqrt:  [[ 7.46573104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00069756 -0.08653228  0.53425821]
Stock Position:  -0.0006975590328840668
Bond Position:  [15.27822244]


portfolio before change:  [15.21707307]
curr_Stock_Price:  98.61586907024257
curr_Factors:  [98.61586907 -0.93581977 -0.998437  ]
mat_Sqrt:  [[14.25311418  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00433694  0.01483673  0.42838008]
Stock Position:  -0.004336942422285496
Bond Position:  [15.64476442]


portfolio before change:  [15.24094049]
curr_Stock_Price:  94.91670046158998
curr_Factors:  [94.91670046 -0.7993806  -0.94578381]
mat_Sqrt:  [[16.57400108  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00565704 0.01211963 0.31190812]
Stock Position:  0.0056570417841021545
Bond Position:  [14.70399275]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.25270751]
Stock Price:  95.6968218524006
PL:  [15.25270751]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-9.49031686e-02  7.65364802e-02  5.41811521e-02]
 [ 4.06378357e-01 -6.01885447e-01  5.63727771e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.58164760e-01 -3.95994162e-01 -4.01784740e-01]
 [-4.22460804e-02  9.52573431e-02  1.54327675e-01]
 [-5.14478171e-02  4.35492368e-02  2.75643138e-02]
 [-2.75820516e-01  2.45682126e-01  2.00281690e-01]
 [-1.17340925e-01  9.36194833e-02  2.12360046e-01]
 [-6.45783376e-03 -4.26826846e-02  2.00216721e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.01875183]
curr_Stock_Price:  101.8827046181813
curr_Factors:  [101.88270462  -1.21921392  -0.95676342]
mat_Sqrt:  [[11.56339904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0058997   0.02470204  0.15456375]
Stock Position:  -0.005899696390775209
Bond Position:  [17.61982885]


portfolio before change:  [17.03543758]
curr_Stock_Price:  100.5481209568134
curr_Factors:  [100.54812096  -0.75100026  -1.02407178]
mat_Sqrt:  [[17.04001484  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02339138 -0.19425769  1.60815842]
Stock Position:  0.023391379539020957
Bond Position:  [14.68347832]


portfolio before change:  [17.0600893]
curr_Stock_Price:  101.28805765842321
curr_Factors:  [101.28805766  -0.51278321  -1.05638343]
mat_Sqrt:  [[21.09006083  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00166942 -0.02755111  0.34758667]
Stock Position:  0.0016694155642155003
Bond Position:  [16.89099744]


portfolio before change:  [17.06630694]
curr_Stock_Price:  99.95228187958281
curr_Factors:  [99.95228188 -0.62663429 -1.09344918]
mat_Sqrt:  [[17.89657615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01650141 -0.12780657 -1.14618003]
Stock Position:  0.01650141462014799
Bond Position:  [15.4169529]


portfolio before change:  [17.03097642]
curr_Stock_Price:  97.34396430101228
curr_Factors:  [97.3439643  -0.97236865 -1.08161594]
mat_Sqrt:  [[12.48173217  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00069704 0.03074418 0.4402539 ]
Stock Position:  0.0006970385179456294
Bond Position:  [16.96312393]


portfolio before change:  [17.04092052]
curr_Stock_Price:  99.4391374611243
curr_Factors:  [99.43913746 -1.07995591 -1.10531081]
mat_Sqrt:  [[11.18170598  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00330288  0.01405546  0.07863331]
Stock Position:  -0.0033028792271308405
Bond Position:  [17.36935598]


portfolio before change:  [17.05142195]
curr_Stock_Price:  98.88974462724235
curr_Factors:  [98.88974463 -0.27118874 -1.14381417]
mat_Sqrt:  [[24.02278207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00769222  0.07929357  0.57134791]
Stock Position:  -0.007692220342569552
Bond Position:  [17.81210365]


portfolio before change:  [17.02006913]
curr_Stock_Price:  104.12374646079336
curr_Factors:  [104.12374646  -0.76921271  -1.1020649 ]
mat_Sqrt:  [[16.02744319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00342432  0.03021556  0.6058041 ]
Stock Position:  -0.0034243213334105072
Bond Position:  [17.3766223]


portfolio before change:  [17.02497365]
curr_Stock_Price:  105.22935558248913
curr_Factors:  [105.22935558  -0.923501    -1.07730945]
mat_Sqrt:  [[14.22970754  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007789  -0.01377578  0.05711626]
Stock Position:  -0.0007788981994467799
Bond Position:  [17.10693661]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.03488791]
Stock Price:  103.48503270047547
PL:  [13.54985521]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-7.84656787e-03  5.82279179e-02  4.76185594e-02]
 [ 3.84788361e-01 -4.76286709e-01  4.80816019e-01]
 [ 5.85777641e-02 -8.60513253e-02  9.94122502e-02]
 [ 5.07082742e-01 -4.43549579e-01 -3.91506638e-01]
 [-1.02563294e-01  1.04774809e-01 -6.05209300e-03]
 [-4.11810977e-02  5.54864590e-02 -2.33478031e-02]
 [-2.17704198e-01  1.65131223e-01  1.87663386e-01]
 [-7.84349399e-02  4.73849136e-02  2.21946938e-01]
 [ 3.11727461e-03 -9.66725313e-03  9.80297176e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.75302762]
curr_Stock_Price:  100.21008414765357
curr_Factors:  [100.21008415  -0.92297503  -0.98692913]
mat_Sqrt:  [[14.84057015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00092714 0.01879298 0.1358425 ]
Stock Position:  0.0009271378176265738
Bond Position:  [3.66011906]


portfolio before change:  [3.75526283]
curr_Stock_Price:  100.64658012154341
curr_Factors:  [100.64658012  -1.53209594  -0.98568209]
mat_Sqrt:  [[ 8.11599778  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04752501 -0.15372087  1.37163427]
Stock Position:  0.047525013314254384
Bond Position:  [-1.02796723]


portfolio before change:  [3.79510923]
curr_Stock_Price:  101.49582787916687
curr_Factors:  [101.49582788  -1.73218559  -0.94515483]
mat_Sqrt:  [[ 6.9774064   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00878622 -0.02777295  0.28359548]
Stock Position:  0.00878622342322355
Bond Position:  [2.90334421]


portfolio before change:  [3.78842074]
curr_Stock_Price:  100.56931763788009
curr_Factors:  [100.56931764  -1.66222238  -0.91522275]
mat_Sqrt:  [[ 7.64003419  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04406101 -0.14315501 -1.11685946]
Stock Position:  0.044061007790199516
Bond Position:  [-0.64276475]


portfolio before change:  [3.76364947]
curr_Stock_Price:  100.01440969458716
curr_Factors:  [100.01440969  -0.92454456  -0.90103167]
mat_Sqrt:  [[16.11479904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00511403  0.03381592 -0.01726494]
Stock Position:  -0.005114032376926305
Bond Position:  [4.2751264]


portfolio before change:  [3.77245335]
curr_Stock_Price:  98.71097988847262
curr_Factors:  [98.71097989 -1.03672937 -0.91902163]
mat_Sqrt:  [[13.96347769  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00247938  0.01790818 -0.06660478]
Stock Position:  -0.002479383919658896
Bond Position:  [4.01719577]


portfolio before change:  [3.77468179]
curr_Stock_Price:  98.62251529744124
curr_Factors:  [98.6225153  -0.5172105  -0.91944472]
mat_Sqrt:  [[23.44469768  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00621421  0.05329587  0.53535141]
Stock Position:  -0.006214211057278785
Bond Position:  [4.38754291]


portfolio before change:  [3.79681318]
curr_Stock_Price:  95.41421220548473
curr_Factors:  [95.41421221 -0.38546532 -0.9178632 ]
mat_Sqrt:  [[25.91699722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00090511  0.01529342  0.63315284]
Stock Position:  -0.0009051128011795661
Bond Position:  [3.88317381]


portfolio before change:  [3.79618553]
curr_Stock_Price:  98.25333496671706
curr_Factors:  [98.25333497 -0.42848176 -0.97607168]
mat_Sqrt:  [[24.11889962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00087708 -0.00312009  0.2796515 ]
Stock Position:  0.0008770792816050944
Bond Position:  [3.71000956]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.79389513]
Stock Price:  93.5264349533185
PL:  [3.79389513]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-3.55259065e-02  4.28052100e-02  4.79705375e-02]
 [ 5.06721039e-01 -6.13703450e-01  6.61936683e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.16439562e-01 -4.54402298e-01 -3.90995075e-01]
 [-1.22108241e-01  1.22432496e-01 -9.18988965e-02]
 [-6.70874275e-02  3.29469766e-02  6.53153335e-02]
 [-1.19448487e-02 -3.65786034e-01  2.00205120e-01]
 [-1.13496611e-01  7.20605891e-02  1.74952351e-01]
 [ 4.54162099e-03 -3.84731030e-02  2.00395629e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.79104804]
curr_Stock_Price:  100.71922149398401
curr_Factors:  [100.71922149  -0.80216636  -0.98429655]
mat_Sqrt:  [[16.87568379  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00100715  0.01381532  0.13684659]
Stock Position:  -0.0010071523498264938
Bond Position:  [7.89248764]


portfolio before change:  [7.79320548]
curr_Stock_Price:  102.49630200398062
curr_Factors:  [102.496302    -1.01404911  -0.96455828]
mat_Sqrt:  [[14.17130769  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03645158 -0.19807194  1.88832111]
Stock Position:  0.036451583512827436
Bond Position:  [4.05705297]


portfolio before change:  [7.75692996]
curr_Stock_Price:  101.44546822398613
curr_Factors:  [101.44546822  -1.17265232  -0.90247024]
mat_Sqrt:  [[12.7355696   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00276455 -0.02755111  0.34758667]
Stock Position:  0.0027645466125658233
Bond Position:  [7.47647924]


portfolio before change:  [7.75911508]
curr_Stock_Price:  100.88333055555319
curr_Factors:  [100.88333056  -1.19511096  -0.88166462]
mat_Sqrt:  [[12.64408006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02719641 -0.14665771 -1.11540012]
Stock Position:  0.0271964068814414
Bond Position:  [5.01545098]


portfolio before change:  [7.7469292]
curr_Stock_Price:  100.34302998930225
curr_Factors:  [100.34302999  -1.5212602   -0.89110327]
mat_Sqrt:  [[ 8.99106361  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01288786  0.03951492 -0.26216197]
Stock Position:  -0.012887862958513227
Bond Position:  [9.04013642]


portfolio before change:  [7.74183325]
curr_Stock_Price:  101.08924770535262
curr_Factors:  [101.08924771  -1.90050549  -0.89991582]
mat_Sqrt:  [[ 6.14465412  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00765376  0.01063359  0.18632647]
Stock Position:  -0.007653761555033994
Bond Position:  [8.51554624]


portfolio before change:  [7.74143775]
curr_Stock_Price:  101.69735782368849
curr_Factors:  [101.69735782  -1.64739835  -0.95928463]
mat_Sqrt:  [[ 7.50311551  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00609666 -0.11805693  0.57112948]
Stock Position:  -0.006096655601477982
Bond Position:  [8.36145152]


portfolio before change:  [7.75002532]
curr_Stock_Price:  100.97470006241605
curr_Factors:  [100.97470006  -0.96558734  -0.87267737]
mat_Sqrt:  [[16.0643943   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0039264   0.02325746  0.49909036]
Stock Position:  -0.003926404218540112
Bond Position:  [8.14649281]


portfolio before change:  [7.74512501]
curr_Stock_Price:  103.26039738680763
curr_Factors:  [103.26039739  -1.27842018  -0.88347249]
mat_Sqrt:  [[11.88600025  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 6.55300653e-05 -1.24171406e-02  5.71672951e-02]
Stock Position:  6.553006534655109e-05
Bond Position:  [7.73835835]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.74909559]
Stock Price:  104.79304589328538
PL:  [2.9560497]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-5.93548824e-02  5.63420690e-02  5.04629493e-02]
 [ 5.27371279e-01 -7.27896484e-01  7.38257938e-01]
 [-3.34662064e-04 -7.91043124e-02  1.15789474e-01]
 [ 4.23551196e-01 -3.62875635e-01 -3.83103971e-01]
 [-8.47760378e-02  9.90963668e-02  4.79188868e-02]
 [-9.45816955e-02  3.44364202e-02  5.58535385e-02]
 [-1.70035291e-01 -6.21803475e-03  1.75456198e-01]
 [-1.01692209e-01  3.42795502e-02  1.24239820e-01]
 [-7.52719823e-02 -5.87030211e-02  7.37153747e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.19186758]
curr_Stock_Price:  101.14801680707677
curr_Factors:  [101.14801681  -1.10559374  -0.99493118]
mat_Sqrt:  [[12.37972483  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00303346  0.01818432  0.14395675]
Stock Position:  -0.003033459939253792
Bond Position:  [11.49869603]


portfolio before change:  [11.19529174]
curr_Stock_Price:  101.91500212467254
curr_Factors:  [101.91500212  -0.21862688  -1.059673  ]
mat_Sqrt:  [[28.38438807  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01865414 -0.23492758  2.10604441]
Stock Position:  0.018654138332523346
Bond Position:  [9.29415519]


portfolio before change:  [11.15172864]
curr_Stock_Price:  99.33051723210863
curr_Factors:  [99.33051723 -0.50419211 -1.0644956 ]
mat_Sqrt:  [[20.69237222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00034572 -0.02553081  0.33031514]
Stock Position:  0.000345715085267454
Bond Position:  [11.11738858]


portfolio before change:  [11.15718785]
curr_Stock_Price:  99.03871791853517
curr_Factors:  [99.03871792 -0.69072977 -1.09077347]
mat_Sqrt:  [[16.6766181   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01626701 -0.11711761 -1.09288899]
Stock Position:  0.0162670119835852
Bond Position:  [9.54612384]


portfolio before change:  [11.1695637]
curr_Stock_Price:  99.50601953911885
curr_Factors:  [99.50601954 -0.93195152 -1.13535839]
mat_Sqrt:  [[12.59006775  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00434999  0.03198321  0.13669925]
Stock Position:  -0.004349990477994507
Bond Position:  [11.60241394]


portfolio before change:  [11.17123769]
curr_Stock_Price:  100.45514163026021
curr_Factors:  [100.45514163  -0.72420464  -1.14594004]
mat_Sqrt:  [[15.48027451  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00491925  0.01111431  0.1593346 ]
Stock Position:  -0.004919249647026803
Bond Position:  [11.66540161]


portfolio before change:  [11.1802217]
curr_Stock_Price:  99.8148298734859
curr_Factors:  [99.81482987 -0.73513516 -1.13627035]
mat_Sqrt:  [[15.36222014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00881967 -0.00200686  0.50052769]
Stock Position:  -0.008819668940904947
Bond Position:  [12.06055546]


portfolio before change:  [11.19799581]
curr_Stock_Price:  98.48345097334824
curr_Factors:  [98.48345097 -1.00957505 -1.16477126]
mat_Sqrt:  [[11.19583923  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00619289  0.01106368  0.35442162]
Stock Position:  -0.006192887966745847
Bond Position:  [11.80789279]


portfolio before change:  [11.19368056]
curr_Stock_Price:  100.13383927615097
curr_Factors:  [100.13383928  -1.11157631  -1.18568816]
mat_Sqrt:  [[10.06680337  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00717284 -0.01894632  0.21028945]
Stock Position:  -0.007172842838661109
Bond Position:  [11.91192485]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.1821767]
Stock Price:  102.56820315295845
PL:  [8.61397355]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 4.05667294e-02  1.00851683e-01  4.87833346e-02]
 [ 4.56586112e-01 -5.41294812e-01  5.79479233e-01]
 [ 4.98763927e-02 -8.03277279e-02  9.45792703e-02]
 [ 5.28639681e-01 -4.67311626e-01 -3.81582681e-01]
 [-1.54461620e-01  1.22201050e-01 -1.65519333e-01]
 [-8.37407453e-02  8.60488796e-03  3.89591380e-02]
 [-2.03714881e-01  4.01164454e-02  1.83392603e-01]
 [-1.16836309e-01  1.12511505e-01  2.57419082e-01]
 [-1.67678103e-02 -4.04645618e-02  4.31554484e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.46387221]
curr_Stock_Price:  99.55230675743599
curr_Factors:  [99.55230676 -1.07489126 -1.05507157]
mat_Sqrt:  [[11.8309664   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00601057 0.03254974 0.13916527]
Stock Position:  0.006010569811801498
Bond Position:  [-2.0622383]


portfolio before change:  [-1.45325653]
curr_Stock_Price:  101.49006907282907
curr_Factors:  [101.49006907  -1.28125384  -1.00567884]
mat_Sqrt:  [[10.30911304  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04504563 -0.17470215  1.65309296]
Stock Position:  0.04504562834256416
Bond Position:  [-6.02494046]


portfolio before change:  [-1.41737841]
curr_Stock_Price:  102.35344584835183
curr_Factors:  [102.35344585  -1.60565847  -1.00434924]
mat_Sqrt:  [[ 7.52645592  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00701332 -0.02592566  0.26980833]
Stock Position:  0.0070133243476805645
Bond Position:  [-2.13521632]


portfolio before change:  [-1.42670932]
curr_Stock_Price:  101.1752542775188
curr_Factors:  [101.17525428  -1.53316643  -0.94752399]
mat_Sqrt:  [[ 8.46689449  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04197051 -0.15082418 -1.08854918]
Stock Position:  0.04197050716138194
Bond Position:  [-5.67308605]


portfolio before change:  [-1.36452502]
curr_Stock_Price:  102.72447436822213
curr_Factors:  [102.72447437  -1.53781461  -0.94970247]
mat_Sqrt:  [[ 8.53805569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01912659  0.03944022 -0.47218059]
Stock Position:  -0.019126594278774927
Bond Position:  [0.60024432]


portfolio before change:  [-1.36461596]
curr_Stock_Price:  102.7449242858054
curr_Factors:  [102.74492429  -1.57543668  -0.99238189]
mat_Sqrt:  [[ 7.88081152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00939393  0.00277722  0.11113958]
Stock Position:  -0.009393928404741101
Bond Position:  [-0.3994375]


portfolio before change:  [-1.36486781]
curr_Stock_Price:  102.750468139817
curr_Factors:  [102.75046814  -0.78616523  -0.98236444]
mat_Sqrt:  [[17.52754655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00901959  0.01294753  0.52316805]
Stock Position:  -0.00901959021513891
Bond Position:  [-0.43810069]


portfolio before change:  [-1.36028081]
curr_Stock_Price:  102.21761682135322
curr_Factors:  [102.21761682  -0.40099074  -0.94922899]
mat_Sqrt:  [[26.49309973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00155982  0.03631293  0.73434499]
Stock Position:  -0.0015598229234422781
Bond Position:  [-1.20083943]


portfolio before change:  [-1.35910148]
curr_Stock_Price:  101.0765256299235
curr_Factors:  [101.07652563  -0.19660036  -0.92719443]
mat_Sqrt:  [[32.85431603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00049365 -0.01305988  0.12311048]
Stock Position:  -0.0004936500689500164
Bond Position:  [-1.30920505]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.35870101]
Stock Price:  98.93891222670125
PL:  [-1.35870101]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-1.39418266e-02  5.28615642e-02  4.74719136e-02]
 [ 4.20963587e-01 -6.14365456e-01  5.83406072e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.72060750e-01 -4.12305731e-01 -3.94660981e-01]
 [-1.13172144e-01  1.13266168e-01 -5.01080716e-02]
 [-6.98936838e-02  3.71061952e-02  5.82833037e-02]
 [-1.45644327e-01 -1.17650176e-01  1.74128949e-01]
 [-1.12866073e-01  5.54569156e-02  1.39317371e-01]
 [-4.90807974e-02 -5.34203665e-02  3.61836906e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.97531771]
curr_Stock_Price:  100.49028354266308
curr_Factors:  [100.49028354  -0.79467275  -1.03708046]
mat_Sqrt:  [[16.0917679   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00040634 0.017061   0.13542416]
Stock Position:  0.0004063356370030581
Bond Position:  [5.93448493]


portfolio before change:  [5.97837957]
curr_Stock_Price:  100.72130739155506
curr_Factors:  [100.72130739  -0.7057031   -1.04769049]
mat_Sqrt:  [[17.44344229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02377077 -0.1982856   1.66429513]
Stock Position:  0.02377076851343505
Bond Position:  [3.58415669]


portfolio before change:  [6.01367145]
curr_Stock_Price:  102.13057414998897
curr_Factors:  [102.13057415  -0.50211341  -1.08548294]
mat_Sqrt:  [[20.87716089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00168644 -0.02755111  0.34758667]
Stock Position:  0.0016864398364023277
Bond Position:  [5.84143438]


portfolio before change:  [6.01395841]
curr_Stock_Price:  100.56841555414574
curr_Factors:  [100.56841555  -0.85626755  -1.12203505]
mat_Sqrt:  [[13.90899358  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02209645 -0.1330711  -1.12585793]
Stock Position:  0.022096448419330797
Bond Position:  [3.7917536]


portfolio before change:  [6.01475318]
curr_Stock_Price:  100.5185620549154
curr_Factors:  [100.51856205  -1.09461105  -1.11035917]
mat_Sqrt:  [[11.08255425  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00904846  0.0365565  -0.14294438]
Stock Position:  -0.009048460270550354
Bond Position:  [6.92429139]


portfolio before change:  [6.02476205]
curr_Stock_Price:  99.79513921168997
curr_Factors:  [99.79513921 -0.90853094 -1.16024902]
mat_Sqrt:  [[12.60810066  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00399921  0.01197597  0.16626604]
Stock Position:  -0.003999205369753001
Bond Position:  [6.42386331]


portfolio before change:  [6.02519407]
curr_Stock_Price:  100.49045660665537
curr_Factors:  [100.49045661  -0.84620976  -1.19483697]
mat_Sqrt:  [[13.05297447  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01027472 -0.03797143  0.49674142]
Stock Position:  -0.010274719056035225
Bond Position:  [7.05770528]


portfolio before change:  [6.0216144]
curr_Stock_Price:  101.18238790111806
curr_Factors:  [101.1823879   -1.08595679  -1.16856705]
mat_Sqrt:  [[10.61640949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00688631  0.01789864  0.39743368]
Stock Position:  -0.006886314855968585
Bond Position:  [6.71838818]


portfolio before change:  [6.02146755]
curr_Stock_Price:  101.69164260464997
curr_Factors:  [101.6916426   -0.95720966  -1.15622452]
mat_Sqrt:  [[12.28662096  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00428102 -0.01724135  0.103222  ]
Stock Position:  -0.004281015858471419
Bond Position:  [6.45681108]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.0192284]
Stock Price:  102.96899472172576
PL:  [3.05023368]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-8.93059916e-03 -1.35418477e-03  4.07519738e-02]
 [ 4.28298115e-01 -6.69953272e-01  6.18059085e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.57963124e-01 -5.10079585e-01 -2.38472358e-01]
 [-1.36435529e-01  8.93162701e-02 -4.50232890e-02]
 [-9.41863602e-02  3.34944256e-02  5.52374529e-02]
 [-8.41765565e-02 -2.07717450e-01  1.68057266e-01]
 [-1.08738253e-01  4.90026183e-02  1.36837882e-01]
 [-4.21006039e-02 -4.17492371e-02  8.51482706e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.79169113]
curr_Stock_Price:  100.21495907024425
curr_Factors:  [100.21495907  -0.50618431  -1.00102646]
mat_Sqrt:  [[22.20031997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.00246094e-05 -4.37061254e-04  1.16254038e-01]
Stock Position:  -4.00246093614327e-05
Bond Position:  [3.7957022]


portfolio before change:  [3.79345089]
curr_Stock_Price:  103.6769623544359
curr_Factors:  [103.67696235  -0.89330733  -0.98984862]
mat_Sqrt:  [[15.77022998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02648695 -0.21622649  1.76315054]
Stock Position:  0.026486947790908315
Bond Position:  [1.0473646]


portfolio before change:  [3.80088476]
curr_Stock_Price:  103.93784766393053
curr_Factors:  [103.93784766  -0.78723449  -0.97391817]
mat_Sqrt:  [[17.86137292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00197119 -0.02755111  0.34758667]
Stock Position:  0.0019711853037969367
Bond Position:  [3.596004]


portfolio before change:  [3.8041741]
curr_Stock_Price:  104.69419127663193
curr_Factors:  [104.69419128  -0.74659681  -0.98427129]
mat_Sqrt:  [[18.54454235  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02184824 -0.16462748 -0.68029526]
Stock Position:  0.02184823928381638
Bond Position:  [1.51679036]


portfolio before change:  [3.80736003]
curr_Stock_Price:  104.80529125368612
curr_Factors:  [104.80529125  -0.74435243  -1.02029567]
mat_Sqrt:  [[17.94759577  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00709812  0.0288267  -0.12843891]
Stock Position:  -0.007098124114755308
Bond Position:  [4.55128099]


portfolio before change:  [3.83368314]
curr_Stock_Price:  101.4175089386426
curr_Factors:  [101.41750894  -0.96141195  -1.03892669]
mat_Sqrt:  [[13.72072004  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00554446  0.01081028  0.15757708]
Stock Position:  -0.005544464224619753
Bond Position:  [4.39598889]


portfolio before change:  [3.83801383]
curr_Stock_Price:  101.032953866481
curr_Factors:  [101.03295387  -1.11796946  -1.00894299]
mat_Sqrt:  [[12.04361079  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0076615  -0.06704052  0.4794206 ]
Stock Position:  -0.007661502784605265
Bond Position:  [4.61207809]


portfolio before change:  [3.8512193]
curr_Stock_Price:  99.61040693689843
curr_Factors:  [99.61040694 -1.0811155  -0.96767028]
mat_Sqrt:  [[12.83891596  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00551477  0.01581553  0.39036039]
Stock Position:  -0.005514773959279243
Bond Position:  [4.40054817]


portfolio before change:  [3.86338597]
curr_Stock_Price:  97.80328861802002
curr_Factors:  [97.80328862 -1.50294239 -0.91847258]
mat_Sqrt:  [[ 8.68452961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0038277  -0.01347451  0.24290432]
Stock Position:  -0.0038277045191634617
Bond Position:  [4.23774806]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.86769995]
Stock Price:  97.22994734534115
PL:  [3.86769995]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 4.42598505e-02  1.23189483e-01  5.30956857e-02]
 [ 1.04518448e-01  1.51094209e-01  5.61220081e-02]
 [-2.55060887e-01  4.08089854e-02 -2.56075652e-01]
 [ 3.30345846e-01 -2.83889062e-01 -2.82454058e-01]
 [ 1.65747837e-02  7.81225193e-02  1.73620382e-01]
 [-1.99601814e-02  7.75054550e-02 -1.16130363e-01]
 [-8.83885549e-02 -3.87271962e-02  1.61423261e-01]
 [-1.01572941e-01  7.10159908e-02  2.07519653e-01]
 [ 5.00623208e-03 -8.08350786e-03  9.82199302e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.34774361]
curr_Stock_Price:  98.30609016396701
curr_Factors:  [98.30609016 -0.61629634 -1.06629597]
mat_Sqrt:  [[18.27426293  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00439109 0.03975923 0.15146721]
Stock Position:  0.004391088720468775
Bond Position:  [-11.77941437]


portfolio before change:  [-11.36152749]
curr_Stock_Price:  96.50865419252584
curr_Factors:  [96.50865419 -1.29932309 -1.07397764]
mat_Sqrt:  [[ 8.99196997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01632749 0.04876545 0.16010047]
Stock Position:  0.016327487917978774
Bond Position:  [-12.93727138]


portfolio before change:  [-11.35425945]
curr_Stock_Price:  97.35007561423937
curr_Factors:  [97.35007561 -0.65799117 -1.06029662]
mat_Sqrt:  [[17.46197602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01712303  0.01317104 -0.73051256]
Stock Position:  -0.0171230341131144
Bond Position:  [-9.68733078]


portfolio before change:  [-11.3473006]
curr_Stock_Price:  96.66072797391435
curr_Factors:  [96.66072797 -1.28614344 -1.05998419]
mat_Sqrt:  [[ 9.25421913  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02320472 -0.0916248  -0.80576281]
Stock Position:  0.023204717543460134
Bond Position:  [-13.59028549]


portfolio before change:  [-11.36768612]
curr_Stock_Price:  96.075127991586
curr_Factors:  [96.07512799 -0.93571717 -1.07074287]
mat_Sqrt:  [[12.91862974  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00526074 0.02521393 0.49529062]
Stock Position:  0.005260742786812103
Bond Position:  [-11.87311266]


portfolio before change:  [-11.37059253]
curr_Stock_Price:  96.65140286069834
curr_Factors:  [96.65140286 -0.79658045 -1.02836172]
mat_Sqrt:  [[15.58281248  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00178687  0.02501478 -0.3312876 ]
Stock Position:  -0.0017868698436307113
Bond Position:  [-11.19788905]


portfolio before change:  [-11.37624602]
curr_Stock_Price:  96.68114231393994
curr_Factors:  [96.68114231 -0.88575105 -1.00698321]
mat_Sqrt:  [[14.56591352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00434874 -0.01249915  0.46049563]
Stock Position:  -0.0043487368982743765
Bond Position:  [-10.95580516]


portfolio before change:  [-11.38399512]
curr_Stock_Price:  97.20309485006892
curr_Factors:  [97.20309485 -0.2638782  -1.06137264]
mat_Sqrt:  [[25.83038994  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00173118  0.02292031  0.59199581]
Stock Position:  -0.0017311813998687777
Bond Position:  [-11.21571893]


portfolio before change:  [-11.3912643]
curr_Stock_Price:  98.16192758275291
curr_Factors:  [98.16192758 -0.40079012 -1.06858222]
mat_Sqrt:  [[22.58409967  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00103636 -0.00260894  0.28019412]
Stock Position:  0.0010363597658320457
Bond Position:  [-11.49299537]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.39942951]
Stock Price:  95.82945252578752
PL:  [-11.39942951]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 2.60681561e-02 -7.40119645e-03  4.61951765e-02]
 [ 1.95590023e-01 -9.07450449e-02  2.16302113e-01]
 [-2.00657820e-01  2.68621184e-02 -1.34745816e-01]
 [ 1.54468620e-01 -1.49221948e-01 -3.63575975e-02]
 [ 2.37206522e-01 -1.10455372e-01  1.94493708e-01]
 [ 1.36483617e-01  4.37269755e-02 -2.25982549e-01]
 [-1.03884093e-01 -1.34654681e-01  1.84629836e-01]
 [-6.05951463e-02  2.16320037e-03  1.72115662e-01]
 [ 6.40072248e-02  3.65425580e-02  1.11077871e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.60404674]
curr_Stock_Price:  97.64334457473626
curr_Factors:  [97.64334457 -0.92424588 -1.0012962 ]
mat_Sqrt:  [[14.23607759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00238738 -0.00238873  0.13178198]
Stock Position:  0.0023873812041610154
Bond Position:  [-16.83715862]


portfolio before change:  [-16.61153924]
curr_Stock_Price:  98.03212937932179
curr_Factors:  [98.03212938 -0.39090236 -0.99665911]
mat_Sqrt:  [[24.47699769  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00903784 -0.02928784  0.61704972]
Stock Position:  0.009037842603760612
Bond Position:  [-17.4975382]


portfolio before change:  [-16.61640566]
curr_Stock_Price:  98.46193722525581
curr_Factors:  [ 9.84619372e+01 -8.48788526e-03 -1.02108174e+00]
mat_Sqrt:  [[35.16672846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00633211  0.00866971 -0.38439231]
Stock Position:  -0.006332106991876686
Bond Position:  [-15.99293414]


portfolio before change:  [-16.58625714]
curr_Stock_Price:  92.43756240987402
curr_Factors:  [92.43756241 -0.19972551 -1.05490113]
mat_Sqrt:  [[26.36155708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00442263 -0.04816118 -0.10371811]
Stock Position:  0.004422627737957802
Bond Position:  [-16.99507407]


portfolio before change:  [-16.59206584]
curr_Stock_Price:  93.04601626549304
curr_Factors:  [93.04601627 -0.42344828 -1.0332519 ]
mat_Sqrt:  [[21.68008262  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01173246 -0.03564932  0.55483641]
Stock Position:  0.011732463361044101
Bond Position:  [-17.68372482]


portfolio before change:  [-16.61096104]
curr_Stock_Price:  92.18932296958
curr_Factors:  [92.18932297 -0.66220803 -0.98857191]
mat_Sqrt:  [[17.69114762  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00561189  0.01411282 -0.64466531]
Stock Position:  0.005611894475496523
Bond Position:  [-17.12831779]


portfolio before change:  [-16.61197042]
curr_Stock_Price:  93.53591182526506
curr_Factors:  [93.53591183 -0.6091101  -1.02357025]
mat_Sqrt:  [[18.27739573  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00512562 -0.04345961  0.52669753]
Stock Position:  -0.005125618494637929
Bond Position:  [-16.13254102]


portfolio before change:  [-16.62372369]
curr_Stock_Price:  94.25484473373334
curr_Factors:  [94.25484473 -0.80542726 -1.06818916]
mat_Sqrt:  [[14.47446132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0017286   0.00069817  0.49099808]
Stock Position:  -0.001728604740804168
Bond Position:  [-16.46079431]


portfolio before change:  [-16.63521475]
curr_Stock_Price:  96.1399532978833
curr_Factors:  [96.1399533  -0.19980758 -1.06986541]
mat_Sqrt:  [[27.00796926  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00348564 0.01179406 0.31687425]
Stock Position:  0.003485642250430331
Bond Position:  [-16.97032423]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.63619042]
Stock Price:  98.2949675631023
PL:  [-16.63619042]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-3.26499696e-02  4.11714364e-02  4.76697265e-02]
 [ 3.87536099e-01 -5.61992276e-01  5.26371768e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.23776744e-01 -4.64204024e-01 -3.75056961e-01]
 [-1.37611103e-01  1.15775718e-01 -1.11959272e-01]
 [-7.78038535e-02 -5.69909324e-03  2.76829783e-02]
 [-1.09106804e-01 -3.34442228e-01  2.06552519e-01]
 [-1.17110564e-01  8.16903561e-02  1.86105448e-01]
 [-1.00366417e-02 -4.42893167e-02  1.93257929e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.02792112]
curr_Stock_Price:  100.49691608901192
curr_Factors:  [100.49691609  -1.24306986  -1.04234792]
mat_Sqrt:  [[10.22370729  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00141977  0.01328802  0.13598846]
Stock Position:  -0.0014197729621388683
Bond Position:  [6.17060392]


portfolio before change:  [6.03114162]
curr_Stock_Price:  100.40222905487758
curr_Factors:  [100.40222905  -0.9692504   -1.02353557]
mat_Sqrt:  [[13.68634259  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02778427 -0.18138223  1.50159214]
Stock Position:  0.02778427405242064
Bond Position:  [3.24153858]


portfolio before change:  [6.0360087]
curr_Stock_Price:  100.51905406287074
curr_Factors:  [100.51905406  -1.09768323  -1.04375309]
mat_Sqrt:  [[11.809579    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00298132 -0.02755111  0.34758667]
Stock Position:  0.0029813150669127796
Bond Position:  [5.73632973]


portfolio before change:  [6.04148163]
curr_Stock_Price:  101.39251308011225
curr_Factors:  [101.39251308  -1.51717511  -1.03480299]
mat_Sqrt:  [[ 7.90125143  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04460854 -0.1498212  -1.06993311]
Stock Position:  0.04460854275439796
Bond Position:  [1.51850938]


portfolio before change:  [6.06256]
curr_Stock_Price:  101.84800708355063
curr_Factors:  [101.84800708  -0.98735997  -1.11194835]
mat_Sqrt:  [[12.48057276  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01096361  0.03736645 -0.31938864]
Stock Position:  -0.010963605362611921
Bond Position:  [7.17918136]


portfolio before change:  [6.05371753]
curr_Stock_Price:  102.98202806048168
curr_Factors:  [102.98202806  -1.27494115  -1.16741207]
mat_Sqrt:  [[ 8.95490361  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00818729 -0.00183937  0.07897183]
Stock Position:  -0.008187292122455494
Bond Position:  [6.89686148]


portfolio before change:  [6.05289294]
curr_Stock_Price:  103.5040428903945
curr_Factors:  [103.50404289  -1.20738277  -1.14941632]
mat_Sqrt:  [[ 9.80420697  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01379124 -0.10794076  0.58923684]
Stock Position:  -0.013791241046041076
Bond Position:  [7.48034214]


portfolio before change:  [6.04025857]
curr_Stock_Price:  104.69142511253095
curr_Factors:  [104.69142511  -0.98548217  -1.13845529]
mat_Sqrt:  [[12.51690027  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00498901  0.02636545  0.53090704]
Stock Position:  -0.004989012675597587
Bond Position:  [6.56256542]


portfolio before change:  [6.03611835]
curr_Stock_Price:  106.17915805761368
curr_Factors:  [106.17915806  -0.91759106  -1.14498768]
mat_Sqrt:  [[13.49810212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00112107 -0.01429432  0.05513111]
Stock Position:  -0.0011210686933713044
Bond Position:  [6.15515248]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.04033064]
Stock Price:  105.16767229768023
PL:  [0.87265835]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 2.94973286e-02  6.55237044e-02  5.13306552e-02]
 [ 3.40103218e-01 -5.05245812e-01  4.72183159e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.75725151e-01 -4.17854026e-01 -3.83260510e-01]
 [-5.45073467e-02  8.97451958e-02  1.39036681e-01]
 [-5.30490141e-02  4.91363418e-02  3.88057206e-03]
 [-2.50272211e-02 -3.66095989e-01  1.93844010e-01]
 [-1.12922644e-01  4.17379957e-02  1.08181966e-01]
 [-3.34292487e-02 -4.94148010e-02  3.04310888e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.1687832]
curr_Stock_Price:  98.07648279056205
curr_Factors:  [98.07648279 -0.96981246 -0.98231379]
mat_Sqrt:  [[13.92410296  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00383149 0.02114768 0.14643207]
Stock Position:  0.0038314945716498615
Bond Position:  [-13.54456271]


portfolio before change:  [-13.16900605]
curr_Stock_Price:  99.78629056463046
curr_Factors:  [99.78629056 -0.96719637 -1.04874318]
mat_Sqrt:  [[13.291055    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0250811  -0.16306738  1.34700712]
Stock Position:  0.025081103977369026
Bond Position:  [-15.67175638]


portfolio before change:  [-13.17354019]
curr_Stock_Price:  99.91801134146725
curr_Factors:  [99.91801134 -0.88430344 -1.00335706]
mat_Sqrt:  [[15.13015037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00232701 -0.02755111  0.34758667]
Stock Position:  0.0023270142692154187
Bond Position:  [-13.40605083]


portfolio before change:  [-13.17780864]
curr_Stock_Price:  100.96495330507602
curr_Factors:  [100.96495331  -0.42846499  -1.07160869]
mat_Sqrt:  [[22.52666646  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01385906 -0.13486181 -1.09333556]
Stock Position:  0.013859055957440964
Bond Position:  [-14.57708758]


portfolio before change:  [-13.228076]
curr_Stock_Price:  97.86394919617186
curr_Factors:  [97.8639492  -0.49819511 -1.11866428]
mat_Sqrt:  [[19.42806852  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00040186  0.02896514  0.39663295]
Stock Position:  -0.0004018640154238968
Bond Position:  [-13.188748]


portfolio before change:  [-13.23513426]
curr_Stock_Price:  99.01418569558001
curr_Factors:  [99.0141857  -0.84965429 -1.12156114]
mat_Sqrt:  [[13.79143433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306183  0.01585869  0.01107019]
Stock Position:  -0.003061826702928675
Bond Position:  [-12.93196998]


portfolio before change:  [-13.24725623]
curr_Stock_Price:  100.86091600941478
curr_Factors:  [100.86091601  -1.50802398  -1.10360344]
mat_Sqrt:  [[ 7.40470111  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00812835 -0.11815697  0.552983  ]
Stock Position:  -0.008128350930460071
Bond Position:  [-12.42742331]


portfolio before change:  [-13.25893903]
curr_Stock_Price:  101.53356611972433
curr_Factors:  [101.53356612  -1.3777897   -1.15854659]
mat_Sqrt:  [[ 8.03697809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0102427   0.01347088  0.30861304]
Stock Position:  -0.010242700564067642
Bond Position:  [-12.21896111]


portfolio before change:  [-13.26515631]
curr_Stock_Price:  101.54394128585244
curr_Factors:  [101.54394129  -1.60618455  -1.18006006]
mat_Sqrt:  [[ 6.26041834  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00595875 -0.01594856  0.08681143]
Stock Position:  -0.005958752391317037
Bond Position:  [-12.6600811]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.26934554]
Stock Price:  101.18440407461871
PL:  [-14.45374961]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.54302583e-02  1.47598972e-02  3.57832171e-02]
 [-9.59147403e-02 -7.92199436e-01  2.81701966e-01]
 [ 9.93968883e-03 -6.52930267e-02  7.42905012e-02]
 [ 6.44007051e-01 -6.61598598e-01 -1.07017878e-01]
 [-1.15281964e-01  4.82282644e-02  1.04660449e-01]
 [-2.09691944e-02 -1.48268307e-01 -1.52592857e-01]
 [-2.97902198e-01 -1.23004821e-01  3.47414746e-01]
 [-1.16741454e-01  1.12240059e-01  2.58245603e-01]
 [-2.53812917e-02 -4.75930348e-02  2.67804910e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.50189356]
curr_Stock_Price:  101.43927845878278
curr_Factors:  [101.43927846  -0.3331938   -1.01846989]
mat_Sqrt:  [[26.25343095  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00174253 0.00476374 0.10207956]
Stock Position:  0.0017425276098584157
Bond Position:  [13.32513281]


portfolio before change:  [13.51833457]
curr_Stock_Price:  107.04996973388761
curr_Factors:  [107.04996973  -1.22176493  -0.96455325]
mat_Sqrt:  [[12.02487657  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01664213 -0.25568127  0.8036173 ]
Stock Position:  -0.016642133401609284
Bond Position:  [15.29987445]


portfolio before change:  [13.53295136]
curr_Stock_Price:  106.63145768045341
curr_Factors:  [106.63145768  -1.21500844  -0.9233816 ]
mat_Sqrt:  [[12.56592178  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00093716 -0.02107323  0.21193012]
Stock Position:  0.0009371609044238728
Bond Position:  [13.43302052]


portfolio before change:  [13.54098475]
curr_Stock_Price:  108.03484569489743
curr_Factors:  [108.03484569  -0.95941097  -0.91052861]
mat_Sqrt:  [[16.65173218  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02925304 -0.21353003 -0.30529222]
Stock Position:  0.029253044958990827
Bond Position:  [10.38063655]


portfolio before change:  [13.53267945]
curr_Stock_Price:  107.57346078692767
curr_Factors:  [107.57346079  -0.83379711  -0.87699088]
mat_Sqrt:  [[19.44103387  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00432455  0.01556561  0.29856713]
Stock Position:  -0.0043245481193847305
Bond Position:  [13.99788606]


portfolio before change:  [13.54165117]
curr_Stock_Price:  107.11768498021927
curr_Factors:  [107.11768498  -0.95820806  -0.86258087]
mat_Sqrt:  [[17.34213636  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00475041 -0.04785339 -0.43530495]
Stock Position:  -0.004750407944995788
Bond Position:  [14.05050387]


portfolio before change:  [13.54758599]
curr_Stock_Price:  107.34759819615688
curr_Factors:  [107.3475982   -0.91330994  -0.8459362 ]
mat_Sqrt:  [[18.48253087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01363962 -0.03969964  0.99107757]
Stock Position:  -0.013639620863989389
Bond Position:  [15.01176653]


portfolio before change:  [13.55480005]
curr_Stock_Price:  107.36913137273895
curr_Factors:  [107.36913137  -0.65459588  -0.80037235]
mat_Sqrt:  [[25.06079059  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164067  0.03622532  0.73670282]
Stock Position:  -0.0016406659342433126
Bond Position:  [13.73095693]


portfolio before change:  [13.5633882]
curr_Stock_Price:  106.32019148605187
curr_Factors:  [ 1.06320191e+02 -4.23401928e-02 -7.65612003e-01]
mat_Sqrt:  [[47.39434981  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00062517 -0.01536059  0.07639729]
Stock Position:  -0.0006251722938175817
Bond Position:  [13.62985664]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.56746854]
Stock Price:  110.69705792546831
PL:  [2.87041062]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-8.47506229e-02  7.07689819e-02  5.31192381e-02]
 [ 3.85275792e-01 -4.62121239e-01  4.74152418e-01]
 [-8.00380423e-04 -6.77764409e-02  8.66121054e-02]
 [ 5.24963282e-01 -4.65283103e-01 -3.75031281e-01]
 [-1.48403545e-01  1.16928609e-01 -1.39377066e-01]
 [-8.88853803e-02  2.08633893e-02  4.69764723e-02]
 [-6.12176834e-02 -3.64069980e-01  1.84278647e-01]
 [-1.16904291e-01  7.10086687e-02  1.62596318e-01]
 [-8.09728425e-04 -4.01039471e-02  2.12455180e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.02563629]
curr_Stock_Price:  101.75748677501583
curr_Factors:  [101.75748678  -1.07900049  -0.97532443]
mat_Sqrt:  [[13.04320718  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00455885  0.02284059  0.1515344 ]
Stock Position:  -0.004558851596514261
Bond Position:  [16.48953357]


portfolio before change:  [16.03869776]
curr_Stock_Price:  100.70137968636062
curr_Factors:  [100.70137969  -1.62675288  -0.96145006]
mat_Sqrt:  [[ 7.56820991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05123162 -0.14914899  1.35262487]
Stock Position:  0.05123161894054785
Bond Position:  [10.87960305]


portfolio before change:  [16.09029038]
curr_Stock_Price:  101.60221917832277
curr_Factors:  [101.60221918  -1.27642366  -1.00994029]
mat_Sqrt:  [[10.32637634  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00029482 -0.02187475  0.24708023]
Stock Position:  0.0002948210855363774
Bond Position:  [16.06033591]


portfolio before change:  [16.09826296]
curr_Stock_Price:  101.40005894236383
curr_Factors:  [101.40005894  -1.39864675  -0.99433782]
mat_Sqrt:  [[ 9.26356628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03815321 -0.15016948 -1.06985986]
Stock Position:  0.03815321395693015
Bond Position:  [12.22952482]


portfolio before change:  [16.13967929]
curr_Stock_Price:  102.32527685949113
curr_Factors:  [102.32527686  -1.05930733  -1.034456  ]
mat_Sqrt:  [[12.60877997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01213328  0.03773855 -0.39760397]
Stock Position:  -0.012133276790700904
Bond Position:  [17.38122019]


portfolio before change:  [16.15212579]
curr_Stock_Price:  102.01590283982846
curr_Factors:  [102.01590284  -1.14902956  -1.00562543]
mat_Sqrt:  [[11.82804876  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00634404  0.00673363  0.1340108 ]
Stock Position:  -0.006344041018696794
Bond Position:  [16.79931886]


portfolio before change:  [16.15436356]
curr_Stock_Price:  102.98752223512582
curr_Factors:  [102.98752224  -1.32983978  -1.03205292]
mat_Sqrt:  [[ 9.70571737  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01008863 -0.11750308  0.52569569]
Stock Position:  -0.010088634559336918
Bond Position:  [17.19336703]


portfolio before change:  [16.16011426]
curr_Stock_Price:  103.26983334101733
curr_Factors:  [103.26983334  -1.16322117  -1.09722299]
mat_Sqrt:  [[10.77147181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00642622  0.02291795  0.46384204]
Stock Position:  -0.006426222364613679
Bond Position:  [16.82374917]


portfolio before change:  [16.16737153]
curr_Stock_Price:  103.4498316508636
curr_Factors:  [103.44983165  -1.10280615  -1.10867359]
mat_Sqrt:  [[11.33173326  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041116 -0.01294349  0.06060755]
Stock Position:  -0.0004111629732911222
Bond Position:  [16.20990627]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.17574991]
Stock Price:  102.78974041789282
PL:  [13.38600949]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.78548443e-02  9.84641003e-02  4.87180894e-02]
 [ 2.92101756e-01 -3.75371723e-01  3.99420681e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.66981297e-01 -4.03026048e-01 -4.04724516e-01]
 [-1.32175381e-01  1.26212051e-01 -1.23760140e-01]
 [-8.88981459e-02  3.37313041e-02  5.68477978e-02]
 [ 1.56489889e-02 -3.98259074e-01  2.54191510e-01]
 [-1.13066892e-01  2.38890804e-02  6.74665113e-02]
 [-2.41303155e-04 -4.03196385e-02  1.99849886e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.66112217]
curr_Stock_Price:  99.40135044671247
curr_Factors:  [99.40135045 -1.00497781 -0.94789422]
mat_Sqrt:  [[14.10167618  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00481491 0.03177915 0.13897915]
Stock Position:  0.004814908673838618
Bond Position:  [-3.13973059]


portfolio before change:  [-2.66242801]
curr_Stock_Price:  99.45626585249317
curr_Factors:  [99.45626585 -1.49072652 -0.92395472]
mat_Sqrt:  [[ 8.8909754   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03340587 -0.1211507   1.13943603]
Stock Position:  0.033405865569331436
Bond Position:  [-5.98485066]


portfolio before change:  [-2.64835039]
curr_Stock_Price:  99.96727766731678
curr_Factors:  [99.96727767 -1.17462877 -0.98352936]
mat_Sqrt:  [[11.5499924   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00304832 -0.02755111  0.34758667]
Stock Position:  0.003048320257246959
Bond Position:  [-2.95308267]


portfolio before change:  [-2.65005841]
curr_Stock_Price:  99.89146385344422
curr_Factors:  [99.89146385 -1.07719856 -0.96620347]
mat_Sqrt:  [[12.94464526  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02333783 -0.1300761  -1.15456639]
Stock Position:  0.023337827929699417
Bond Position:  [-4.9813082]


portfolio before change:  [-2.62857525]
curr_Stock_Price:  100.91874191509024
curr_Factors:  [100.91874192  -1.45249967  -1.00571619]
mat_Sqrt:  [[ 8.63738428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01524476  0.04073476 -0.35305323]
Stock Position:  -0.015244764186759014
Bond Position:  [-1.09009282]


portfolio before change:  [-2.6329092]
curr_Stock_Price:  101.16727132749014
curr_Factors:  [101.16727133  -1.71111436  -1.02595491]
mat_Sqrt:  [[ 6.55157862  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01074684  0.01088673  0.16217094]
Stock Position:  -0.01074683953666252
Bond Position:  [-1.54568077]


portfolio before change:  [-2.6338088]
curr_Stock_Price:  101.1790481374397
curr_Factors:  [101.17904814  -2.05569881  -1.07622511]
mat_Sqrt:  [[ 4.41482314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311647 -0.12853756  0.72513762]
Stock Position:  -0.00311647351652847
Bond Position:  [-2.31848697]


portfolio before change:  [-2.63750093]
curr_Stock_Price:  101.99169685140632
curr_Factors:  [101.99169685  -1.80030822  -1.07983113]
mat_Sqrt:  [[ 5.72448193  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0164939   0.00771017  0.19246318]
Stock Position:  -0.016493896027853585
Bond Position:  [-0.95526049]


portfolio before change:  [-2.64643814]
curr_Stock_Price:  102.50458085335094
curr_Factors:  [102.50458085  -1.88937578  -1.12742214]
mat_Sqrt:  [[ 5.01839203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0008752  -0.01301311  0.05701161]
Stock Position:  -0.0008751998951166464
Bond Position:  [-2.55672614]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.64776394]
Stock Price:  102.55842782545008
PL:  [-5.20619177]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-8.83601304e-02  5.82125847e-02  5.12659452e-02]
 [ 4.73449659e-01 -7.13740483e-01  6.81564258e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.54093428e-01 -5.07492753e-01 -2.33391505e-01]
 [-1.42245963e-01  1.00442144e-01 -8.57257449e-02]
 [-2.92134523e-02 -1.27942391e-01 -1.30995463e-01]
 [-1.62880579e-01 -6.38854640e-01  4.56853362e-01]
 [-1.16921742e-01  7.19123467e-02  1.64585206e-01]
 [-2.19539857e-02 -4.94306640e-02  1.76162049e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.45556907]
curr_Stock_Price:  102.063866980561
curr_Factors:  [102.06386698  -0.83215905  -1.03792353]
mat_Sqrt:  [[15.72915799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00419685  0.01878803  0.14624747]
Stock Position:  -0.004196850148790761
Bond Position:  [18.88391583]


portfolio before change:  [18.46184911]
curr_Stock_Price:  102.81783380445296
curr_Factors:  [102.8178338   -0.47324606  -1.08609812]
mat_Sqrt:  [[21.61990982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02159499 -0.23035875  1.94431312]
Stock Position:  0.02159498898254101
Bond Position:  [16.24149912]


portfolio before change:  [18.45961397]
curr_Stock_Price:  102.33818954667909
curr_Factors:  [102.33818955  -0.54095743  -1.07239647]
mat_Sqrt:  [[20.38764362  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00172693 -0.02755111  0.34758667]
Stock Position:  0.001726932080056044
Bond Position:  [18.28288287]


portfolio before change:  [18.47308499]
curr_Stock_Price:  104.84395501425311
curr_Factors:  [104.84395501  -0.90716146  -1.09327279]
mat_Sqrt:  [[14.18292606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02840465 -0.16379258 -0.665801  ]
Stock Position:  0.02840465075660297
Bond Position:  [15.49502906]


portfolio before change:  [18.46073447]
curr_Stock_Price:  104.13632554787557
curr_Factors:  [104.13632555  -0.95132915  -1.07763115]
mat_Sqrt:  [[13.69102576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01017031  0.03241756 -0.24455169]
Stock Position:  -0.010170311070961887
Bond Position:  [19.5198333]


portfolio before change:  [18.44573527]
curr_Stock_Price:  106.57101629316692
curr_Factors:  [106.57101629  -1.26961615  -1.09304528]
mat_Sqrt:  [[10.03571429  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00817769 -0.04129323 -0.37369359]
Stock Position:  -0.008177686009120114
Bond Position:  [19.31723958]


portfolio before change:  [18.43306568]
curr_Stock_Price:  109.30169323405342
curr_Factors:  [109.30169323  -1.89504977  -1.05960079]
mat_Sqrt:  [[ 5.69427529  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03512851 -0.20618945  1.30327548]
Stock Position:  -0.03512851495720379
Bond Position:  [22.27267185]


portfolio before change:  [18.49075484]
curr_Stock_Price:  107.97655786424336
curr_Factors:  [107.97655786  -1.2874282   -1.10031212]
mat_Sqrt:  [[ 9.91624015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00692267  0.02320961  0.46951578]
Stock Position:  -0.006922672323252218
Bond Position:  [19.23824117]


portfolio before change:  [18.48362642]
curr_Stock_Price:  110.39613644106349
curr_Factors:  [110.39613644  -0.8548501   -1.1369005 ]
mat_Sqrt:  [[15.06425227  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188845 -0.01595368  0.05025413]
Stock Position:  -0.001888449854614246
Bond Position:  [18.69210398]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.49208628]
Stock Price:  110.86663921762701
PL:  [7.62544707]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 5.76647204e-02  1.15905001e-01  4.91946951e-02]
 [ 3.48315600e-01 -4.81513022e-01  4.49899386e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.32678962e-01 -3.73151115e-01 -3.88126665e-01]
 [-7.38361357e-02  8.97257130e-02  9.47776911e-02]
 [-5.77607406e-02  4.61885600e-02  1.65021558e-02]
 [-1.29817411e-01 -6.40163618e-02  1.67527972e-01]
 [-1.05018127e-01  2.73973126e-02  9.89616560e-02]
 [-3.89608633e-02 -4.01089755e-02  8.69718662e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.21295279]
curr_Stock_Price:  99.33177239910248
curr_Factors:  [99.3317724  -1.05806092 -1.06426203]
mat_Sqrt:  [[11.8952901   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00768082 0.03740818 0.14033877]
Stock Position:  0.007680817699838539
Bond Position:  [-3.97590202]


portfolio before change:  [-3.2091428]
curr_Stock_Price:  100.0866967597165
curr_Factors:  [100.08669676  -1.41137563  -1.13916729]
mat_Sqrt:  [[ 7.81069433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04376852 -0.15540766  1.28343772]
Stock Position:  0.04376851515202641
Bond Position:  [-7.5897889]


portfolio before change:  [-3.22786019]
curr_Stock_Price:  99.74577694732702
curr_Factors:  [99.74577695 -1.22621631 -1.17921606]
mat_Sqrt:  [[ 8.99970998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00391213 -0.02755111  0.34758667]
Stock Position:  0.003912134487739017
Bond Position:  [-3.61807909]


portfolio before change:  [-3.23037275]
curr_Stock_Price:  99.5660637661382
curr_Factors:  [99.56606377 -0.42182358 -1.21395232]
mat_Sqrt:  [[19.39558535  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01429623 -0.120434   -1.10721734]
Stock Position:  0.014296231865611462
Bond Position:  [-4.65379228]


portfolio before change:  [-3.235027]
curr_Stock_Price:  99.40330956824045
curr_Factors:  [99.40330957 -0.59620818 -1.22389973]
mat_Sqrt:  [[16.10415793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00224629  0.02895885  0.27037437]
Stock Position:  -0.002246285477326848
Bond Position:  [-3.01173879]


portfolio before change:  [-3.23608261]
curr_Stock_Price:  99.20269447115518
curr_Factors:  [99.20269447 -0.79512596 -1.17533074]
mat_Sqrt:  [[13.82817908  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00325162  0.01490729  0.04707606]
Stock Position:  -0.0032516249268498883
Bond Position:  [-2.91351265]


portfolio before change:  [-3.23164485]
curr_Stock_Price:  97.3897916469675
curr_Factors:  [97.38979165 -0.74053087 -1.237849  ]
mat_Sqrt:  [[13.46833708  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0080699  -0.02066119  0.47791067]
Stock Position:  -0.008069904377482933
Bond Position:  [-2.44571854]


portfolio before change:  [-3.24678481]
curr_Stock_Price:  99.1143227173879
curr_Factors:  [99.11432272 -1.20619708 -1.20900485]
mat_Sqrt:  [[ 8.85579488  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00894614  0.00884244  0.28231006]
Stock Position:  -0.008946143379945513
Bond Position:  [-2.36009387]


portfolio before change:  [-3.24550653]
curr_Stock_Price:  98.83949812567262
curr_Factors:  [98.83949813 -0.8670287  -1.22770544]
mat_Sqrt:  [[12.1674356   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00241588 -0.01294512  0.24810653]
Stock Position:  -0.0024158760142572234
Bond Position:  [-3.00672256]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.24977887]
Stock Price:  99.98549882479482
PL:  [-3.24977887]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-3.42998632e-02  3.98203796e-02  4.74928136e-02]
 [ 4.08581158e-01 -5.99429942e-01  5.64520678e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.22426530e-01 -4.76199307e-01 -2.71797222e-01]
 [-1.23278762e-01  8.88017781e-02 -3.38415143e-02]
 [-9.45816955e-02  3.44364202e-02  5.58535385e-02]
 [-2.92524007e-01  7.43096795e-03  2.67992555e-01]
 [-1.17148259e-01  8.36423725e-02  1.90401605e-01]
 [-5.76849450e-03 -4.15205677e-02  2.26383998e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.85417294]
curr_Stock_Price:  100.85326652894229
curr_Factors:  [100.85326653  -0.78675302  -1.0605286 ]
mat_Sqrt:  [[15.90104814  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00103623  0.01285197  0.13548378]
Stock Position:  -0.0010362293204668402
Bond Position:  [8.95868005]


portfolio before change:  [8.8589295]
curr_Stock_Price:  100.58682203845049
curr_Factors:  [100.58682204  -0.77574048  -1.09072341]
mat_Sqrt:  [[15.55772613  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02580424 -0.19346518  1.61042036]
Stock Position:  0.02580424226177448
Bond Position:  [6.26336277]


portfolio before change:  [8.86462699]
curr_Stock_Price:  100.68622522073309
curr_Factors:  [100.68622522  -0.51058609  -1.12559157]
mat_Sqrt:  [[19.60591554  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00179579 -0.02755111  0.34758667]
Stock Position:  0.0017957884056091626
Bond Position:  [8.68381583]


portfolio before change:  [8.87515541]
curr_Stock_Price:  104.13063210509185
curr_Factors:  [104.13063211  -0.22974881  -1.1366229 ]
mat_Sqrt:  [[26.55649841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01392286 -0.15369267 -0.77536182]
Stock Position:  0.013922858794950466
Bond Position:  [7.42535932]


portfolio before change:  [8.86267803]
curr_Stock_Price:  102.96772583046528
curr_Factors:  [ 1.02967726e+02  8.70760220e-02 -1.12912318e+00]
mat_Sqrt:  [[36.31999571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00308535  0.02866065 -0.09654042]
Stock Position:  -0.003085354026753149
Bond Position:  [9.18036992]


portfolio before change:  [8.87305614]
curr_Stock_Price:  101.09216431138769
curr_Factors:  [101.09216431  -0.69187515  -1.07596066]
mat_Sqrt:  [[17.25663667  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00441287  0.01111431  0.1593346 ]
Stock Position:  -0.004412872355832658
Bond Position:  [9.31916296]


portfolio before change:  [8.86340839]
curr_Stock_Price:  104.33460910150606
curr_Factors:  [104.3346091   -0.63733343  -1.10089538]
mat_Sqrt:  [[18.34531665  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01288086  0.00239833  0.76450817]
Stock Position:  -0.012880857821337575
Bond Position:  [10.20732766]


portfolio before change:  [8.8772833]
curr_Stock_Price:  103.65375580338578
curr_Factors:  [103.6537558   -0.95641729  -1.07189292]
mat_Sqrt:  [[13.63644341  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00448865  0.02699546  0.54316278]
Stock Position:  -0.004488653262452912
Bond Position:  [9.34254907]


portfolio before change:  [8.88053195]
curr_Stock_Price:  103.9709539719405
curr_Factors:  [103.97095397  -0.77651737  -1.10118659]
mat_Sqrt:  [[15.90140719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00060515 -0.01340071  0.06458105]
Stock Position:  -0.000605154044457077
Bond Position:  [8.9434504]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.88329636]
Stock Price:  106.79410618001207
PL:  [2.08919018]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 7.30620113e-02  1.49836619e-01  5.14174216e-02]
 [ 2.18972118e-01 -1.59702130e-01  2.60666622e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.09561144e-01 -4.47153284e-01 -3.94424062e-01]
 [-9.25200849e-02  5.95651793e-02 -3.95279280e-02]
 [-9.45816955e-02  3.44364202e-02  5.58535385e-02]
 [-2.30068580e-01  7.21898868e-02  2.03387195e-01]
 [-1.17179903e-01  8.52810566e-02  1.94008155e-01]
 [ 3.37668867e-03 -3.96361782e-02  1.79492445e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.52877714]
curr_Stock_Price:  98.9136937771242
curr_Factors:  [98.91369378 -0.78617339 -0.99263554]
mat_Sqrt:  [[16.70050161  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00683469 0.04835956 0.14667959]
Stock Position:  0.006834694131983334
Bond Position:  [-7.20482199]


portfolio before change:  [-6.53539828]
curr_Stock_Price:  98.47214886554279
curr_Factors:  [98.47214887 -0.86913491 -0.85748644]
mat_Sqrt:  [[17.51665961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01367735 -0.05154364  0.74360932]
Stock Position:  0.013677345643882958
Bond Position:  [-7.8822359]


portfolio before change:  [-6.5157854]
curr_Stock_Price:  100.1943383751754
curr_Factors:  [100.19433838  -1.27575122  -0.94614767]
mat_Sqrt:  [[10.8613736   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00324159 -0.02755111  0.34758667]
Stock Position:  0.003241585927255552
Bond Position:  [-6.84057396]


portfolio before change:  [-6.51748813]
curr_Stock_Price:  100.72445448058515
curr_Factors:  [100.72445448  -1.28108827  -0.90806758]
mat_Sqrt:  [[11.2822733   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02993855 -0.1443181  -1.12518206]
Stock Position:  0.02993854862993204
Bond Position:  [-9.53303211]


portfolio before change:  [-6.52340173]
curr_Stock_Price:  100.68617950844792
curr_Factors:  [100.68617951  -0.71342397  -0.93139158]
mat_Sqrt:  [[19.43728242  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0045495   0.01922458 -0.11276218]
Stock Position:  -0.004549504208595652
Bond Position:  [-6.06532953]


portfolio before change:  [-6.52555689]
curr_Stock_Price:  100.49313276936304
curr_Factors:  [100.49313277  -0.63296421  -0.91167198]
mat_Sqrt:  [[21.44417836  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00355114  0.01111431  0.1593346 ]
Stock Position:  -0.003551142581406256
Bond Position:  [-6.16869144]


portfolio before change:  [-6.53807849]
curr_Stock_Price:  103.15044109507762
curr_Factors:  [103.1504411   -0.74155598  -0.9511134 ]
mat_Sqrt:  [[18.98253094  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00915666  0.02329919  0.58020705]
Stock Position:  -0.009156663271100879
Bond Position:  [-5.59356463]


portfolio before change:  [-6.54299707]
curr_Stock_Price:  103.38208660977807
curr_Factors:  [103.38208661  -0.96657889  -0.98759667]
mat_Sqrt:  [[14.6473019   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00410794  0.02752434  0.55345127]
Stock Position:  -0.004107939611725366
Bond Position:  [-6.1183097]


portfolio before change:  [-6.54969979]
curr_Stock_Price:  104.2688591017449
curr_Factors:  [104.2688591   -1.38236466  -0.99112585]
mat_Sqrt:  [[ 9.71316554  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00010811 -0.01279252  0.0512042 ]
Stock Position:  -0.00010811492273092537
Bond Position:  [-6.53842677]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.55294926]
Stock Price:  104.07867183001825
PL:  [-10.63162109]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 5.83727557e-02  1.16528365e-01  4.92117297e-02]
 [ 1.04620697e-01  1.49601555e-01  5.51276334e-02]
 [-3.98560373e-01  4.25772918e-02 -3.51467722e-01]
 [ 3.15076793e-01 -2.72688968e-01 -2.55530067e-01]
 [ 4.43104233e-02  6.98381393e-02  1.82463292e-01]
 [-8.22012029e-03  7.35004392e-02 -1.00573122e-01]
 [-5.41831276e-02 -9.69381656e-02  1.57111194e-01]
 [-6.89116584e-02 -4.43098922e-04  1.41872327e-01]
 [ 5.26084603e-02  2.88167854e-02  1.07314042e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.15543828]
curr_Stock_Price:  99.08685241189926
curr_Factors:  [99.08685241 -1.04544685 -0.95359616]
mat_Sqrt:  [[13.42278651  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00686924 0.03760937 0.14038737]
Stock Position:  0.00686923768789871
Bond Position:  [-5.83608942]


portfolio before change:  [-5.17403808]
curr_Stock_Price:  96.80406312110973
curr_Factors:  [96.80406312 -0.65771498 -0.90584422]
mat_Sqrt:  [[20.26975287  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00722312 0.04828369 0.15726379]
Stock Position:  0.007223120518456635
Bond Position:  [-5.87326549]


portfolio before change:  [-5.18210333]
curr_Stock_Price:  96.09413621099984
curr_Factors:  [96.09413621 -0.71422527 -0.94237095]
mat_Sqrt:  [[18.33353827  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02517857  0.01374176 -1.00263958]
Stock Position:  -0.025178574976409473
Bond Position:  [-2.76258992]


portfolio before change:  [-5.18428361]
curr_Stock_Price:  96.12585525593619
curr_Factors:  [96.12585526 -0.98772262 -0.98210446]
mat_Sqrt:  [[13.40772787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01545784 -0.08800999 -0.72895616]
Stock Position:  0.01545784162034862
Bond Position:  [-6.67018186]


portfolio before change:  [-5.19868644]
curr_Stock_Price:  95.40991408419781
curr_Factors:  [95.40991408 -1.12854903 -0.96143016]
mat_Sqrt:  [[11.80122463  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00811875 0.02254016 0.52051698]
Stock Position:  0.008118753793174175
Bond Position:  [-5.97329605]


portfolio before change:  [-5.18890664]
curr_Stock_Price:  96.98247032672586
curr_Factors:  [96.98247033 -1.40223659 -0.98663727]
mat_Sqrt:  [[ 8.89648615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154514  0.02372216 -0.28690712]
Stock Position:  -0.001545139083635215
Bond Position:  [-5.03905524]


portfolio before change:  [-5.1897875]
curr_Stock_Price:  95.92153272410654
curr_Factors:  [95.92153272 -0.97133375 -1.00618074]
mat_Sqrt:  [[13.27677145  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00315591 -0.03128666  0.4481945 ]
Stock Position:  -0.003155914810815757
Bond Position:  [-4.88706732]


portfolio before change:  [-5.19207179]
curr_Stock_Price:  95.8708794877079
curr_Factors:  [95.87087949 -1.16947597 -0.99653881]
mat_Sqrt:  [[10.99001902  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.64353675e-03 -1.43009562e-04  4.04722258e-01]
Stock Position:  -0.0036435367474265705
Bond Position:  [-4.84276272]


portfolio before change:  [-5.19381615]
curr_Stock_Price:  95.68489828779715
curr_Factors:  [95.68489829 -0.62800032 -1.04539721]
mat_Sqrt:  [[17.95130748  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00447856 0.00930058 0.30613709]
Stock Position:  0.004478562303996106
Bond Position:  [-5.62234693]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.19854498]
Stock Price:  95.25686810629654
PL:  [-5.19854498]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-8.56015926e-02  7.12524041e-02  5.32082460e-02]
 [ 3.98480639e-01 -5.76586638e-01  5.43763595e-01]
 [ 2.26463365e-02 -8.22141576e-02  1.15534046e-01]
 [ 5.73147361e-01 -5.24131292e-01 -2.40089594e-01]
 [-1.24479925e-01  6.64235665e-02  3.87264720e-02]
 [-4.31601919e-02 -9.25446775e-02 -8.14636539e-02]
 [-3.26576084e-01  8.61026500e-02  2.85326178e-01]
 [-1.15162982e-01  1.02554370e-01  2.38909436e-01]
 [-3.22467648e-02 -4.17577466e-02  6.80155128e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.13528398]
curr_Stock_Price:  101.77131180001142
curr_Factors:  [101.7713118   -1.29260169  -1.03327518]
mat_Sqrt:  [[ 9.94282702  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00605423  0.02299661  0.15178832]
Stock Position:  -0.006054230721592893
Bond Position:  [16.75143098]


portfolio before change:  [16.13249533]
curr_Stock_Price:  103.61571862318662
curr_Factors:  [103.61571862  -1.45763689  -1.09376853]
mat_Sqrt:  [[ 8.07912536  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04849296 -0.18609254  1.55120618]
Stock Position:  0.048492955140258434
Bond Position:  [11.10786293]


portfolio before change:  [16.16320078]
curr_Stock_Price:  104.13435339745276
curr_Factors:  [104.1343534   -1.06223527  -1.0558047 ]
mat_Sqrt:  [[12.52393925  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00235132 -0.02653451  0.32958647]
Stock Position:  0.0023513153103677633
Bond Position:  [15.91834808]


portfolio before change:  [16.17242021]
curr_Stock_Price:  104.66948711901506
curr_Factors:  [104.66948712  -1.37582663  -1.04863979]
mat_Sqrt:  [[ 9.26590214  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04502006 -0.16916265 -0.68490878]
Stock Position:  0.04502005521725499
Bond Position:  [11.46019412]


portfolio before change:  [16.26344255]
curr_Stock_Price:  106.56399403822891
curr_Factors:  [106.56399404  -1.41072687  -1.06432132]
mat_Sqrt:  [[ 8.9683122   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01148669  0.02143811  0.11047585]
Stock Position:  -0.011486694590771626
Bond Position:  [17.4875106]


portfolio before change:  [16.28557359]
curr_Stock_Price:  105.39872423097952
curr_Factors:  [105.39872423  -0.95399155  -1.04948308]
mat_Sqrt:  [[14.21468962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00553508 -0.02986867 -0.23239313]
Stock Position:  -0.005535083487804496
Bond Position:  [16.86896433]


portfolio before change:  [16.29883115]
curr_Stock_Price:  104.52774010314714
curr_Factors:  [104.5277401   -0.55550327  -1.03866379]
mat_Sqrt:  [[21.22724352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01181305  0.02778951  0.81395617]
Stock Position:  -0.011813050161525715
Bond Position:  [17.53362259]


portfolio before change:  [16.34545787]
curr_Stock_Price:  101.32300308418829
curr_Factors:  [101.32300308  -0.38168348  -1.05785796]
mat_Sqrt:  [[24.01724285  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189289  0.03309928  0.68154212]
Stock Position:  -0.0018928889930977374
Bond Position:  [16.53725107]


portfolio before change:  [16.35560815]
curr_Stock_Price:  100.33003304994408
curr_Factors:  [100.33003305  -0.40761013  -1.06832766]
mat_Sqrt:  [[22.93186188  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00117247 -0.01347725  0.19402933]
Stock Position:  -0.0011724700253757556
Bond Position:  [16.4732421]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.36544129]
Stock Price:  98.97011426610939
PL:  [16.36544129]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 5.90002138e-02  1.35111675e-01  5.20048609e-02]
 [ 3.69203752e-01 -5.07934851e-01  4.82373447e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.63196084e-01 -5.06525944e-01 -3.41563342e-01]
 [-1.46508099e-01  1.22952305e-01 -1.49035123e-01]
 [-9.45816955e-02  3.44364202e-02  5.58535385e-02]
 [-1.11447963e-01 -1.54007232e-01  1.73332645e-01]
 [-1.17479227e-01  1.04865632e-01  2.37514777e-01]
 [-6.37628388e-04 -4.08947481e-02  1.87514242e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.56337426]
curr_Stock_Price:  98.78324569224534
curr_Factors:  [98.78324569 -0.90238597 -0.94996097]
mat_Sqrt:  [[15.49598668  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00627228 0.04360711 0.14835539]
Stock Position:  0.006272283189177416
Bond Position:  [-8.18297075]


portfolio before change:  [-7.55787011]
curr_Stock_Price:  100.31325537981769
curr_Factors:  [100.31325538  -1.27961397  -0.93693703]
mat_Sqrt:  [[10.93257474  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03329372 -0.16393527  1.37607718]
Stock Position:  0.03329371720083055
Bond Position:  [-10.89767127]


portfolio before change:  [-7.55175025]
curr_Stock_Price:  100.66077034338922
curr_Factors:  [100.66077034  -1.19890313  -0.92947527]
mat_Sqrt:  [[11.98166731  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0029385  -0.02755111  0.34758667]
Stock Position:  0.0029384955272942254
Bond Position:  [-7.84754147]


portfolio before change:  [-7.55023832]
curr_Stock_Price:  102.51092749972189
curr_Factors:  [102.5109275   -1.32519506  -0.93520745]
mat_Sqrt:  [[10.6927602   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03648081 -0.16348055 -0.97438514]
Stock Position:  0.0364808128082896
Bond Position:  [-11.28992028]


portfolio before change:  [-7.58179366]
curr_Stock_Price:  101.80071949530829
curr_Factors:  [101.8007195   -1.27640736  -0.92025797]
mat_Sqrt:  [[11.31751858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01341568  0.03968269 -0.42515572]
Stock Position:  -0.013415682130888052
Bond Position:  [-6.21606756]


portfolio before change:  [-7.57940661]
curr_Stock_Price:  101.39105994005084
curr_Factors:  [101.39105994  -1.53383743  -0.93441278]
mat_Sqrt:  [[ 8.59116809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00886391  0.01111431  0.1593346 ]
Stock Position:  -0.008863909319418021
Bond Position:  [-6.68068545]


portfolio before change:  [-7.59403343]
curr_Stock_Price:  102.66427286590128
curr_Factors:  [102.66427287  -1.11836484  -0.90857472]
mat_Sqrt:  [[13.52479422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0079486  -0.04970562  0.49446979]
Stock Position:  -0.007948599982870867
Bond Position:  [-6.77799619]


portfolio before change:  [-7.59850887]
curr_Stock_Price:  102.80085024456658
curr_Factors:  [102.80085024  -0.63499748  -0.89937725]
mat_Sqrt:  [[22.16288181  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214733  0.03384524  0.67756355]
Stock Position:  -0.0021473344049462856
Bond Position:  [-7.37776107]


portfolio before change:  [-7.60649094]
curr_Stock_Price:  104.799729224091
curr_Factors:  [104.79972922  -1.19066365  -0.895085  ]
mat_Sqrt:  [[13.01760324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003962  -0.01319872  0.05349259]
Stock Position:  -0.00039620315282181323
Bond Position:  [-7.56496895]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.61041656]
Stock Price:  105.15862146419937
PL:  [-12.76903803]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 1.68821687e-03  6.66224799e-02  4.78479567e-02]
 [ 4.88472135e-01 -5.60730365e-01  6.18559495e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.30017878e-01 -4.78757948e-01 -3.28406863e-01]
 [-1.27784243e-01  8.75148289e-02 -1.03572422e-01]
 [-9.45816955e-02  3.44364202e-02  5.58535385e-02]
 [-2.62407834e-01  1.51420135e-01  2.04506604e-01]
 [-1.16983548e-01  7.51129465e-02  1.71629348e-01]
 [ 6.64011132e-04 -4.17033224e-02  1.49487239e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.28811375]
curr_Stock_Price:  99.8992933206083
curr_Factors:  [99.89929332 -1.20930872 -0.99128457]
mat_Sqrt:  [[11.06259189  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00226479 0.02150231 0.1364969 ]
Stock Position:  0.0022647854256256142
Bond Position:  [1.06186329]


portfolio before change:  [1.29316718]
curr_Stock_Price:  101.89611177310302
curr_Factors:  [101.89611177  -1.23246681  -1.00767863]
mat_Sqrt:  [[10.84613011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04612488 -0.18097495  1.76457807]
Stock Position:  0.04612488062794708
Bond Position:  [-3.40677881]


portfolio before change:  [1.30782893]
curr_Stock_Price:  102.25092162961742
curr_Factors:  [102.25092163  -0.85845126  -1.03501867]
mat_Sqrt:  [[15.39372381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00228717 -0.02755111  0.34758667]
Stock Position:  0.0022871708121244404
Bond Position:  [1.0739636]


portfolio before change:  [1.30998943]
curr_Stock_Price:  102.96070314809636
curr_Factors:  [102.96070315  -0.47322655  -1.06534625]
mat_Sqrt:  [[22.1043537   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01652417 -0.15451846 -0.93685337]
Stock Position:  0.016524167838662566
Bond Position:  [-0.39135051]


portfolio before change:  [1.29367677]
curr_Stock_Price:  101.98534764054719
curr_Factors:  [101.98534764  -0.81728025  -0.99265021]
mat_Sqrt:  [[16.69148466  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00785203  0.02824529 -0.29546329]
Stock Position:  -0.00785202684602373
Bond Position:  [2.09446846]


portfolio before change:  [1.30501862]
curr_Stock_Price:  100.67430379302508
curr_Factors:  [100.67430379  -0.26711455  -0.97687072]
mat_Sqrt:  [[29.01768083  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262431  0.01111431  0.1593346 ]
Stock Position:  -0.002624308102067478
Bond Position:  [1.56921901]


portfolio before change:  [1.30058043]
curr_Stock_Price:  102.66454175904252
curr_Factors:  [102.66454176  -0.59339016  -1.00106103]
mat_Sqrt:  [[20.84294696  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00910402  0.04887064  0.58340042]
Stock Position:  -0.00910401934509477
Bond Position:  [2.2352404]


portfolio before change:  [1.26847535]
curr_Stock_Price:  106.31380646301628
curr_Factors:  [106.31380646  -1.21111081  -1.04289314]
mat_Sqrt:  [[11.16061665  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00596898  0.0242426   0.48961076]
Stock Position:  -0.005968979181618641
Bond Position:  [1.90306025]


portfolio before change:  [1.26731007]
curr_Stock_Price:  106.66848089749521
curr_Factors:  [106.6684809   -1.48436132  -1.04223398]
mat_Sqrt:  [[ 8.52608609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00056266 -0.01345969  0.04264455]
Stock Position:  -0.0005626554048668514
Bond Position:  [1.32732767]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.26758774]
Stock Price:  107.35479809509951
PL:  [-6.08721035]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-7.10542862e-02  6.29883127e-02  5.16866583e-02]
 [ 4.49916379e-01 -4.92713537e-01  5.48955238e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.56277214e-01 -3.91481388e-01 -4.05659911e-01]
 [-3.37364950e-02  9.90828931e-02  1.64939957e-01]
 [-4.69350416e-02  4.65975834e-02  1.45202917e-02]
 [-1.04688406e-01 -1.72695106e-01  1.70422179e-01]
 [-1.11323728e-01  8.00175077e-02  1.99279210e-01]
 [-4.25976217e-02 -4.20610605e-02  8.66937115e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.09297549]
curr_Stock_Price:  101.2616337882714
curr_Factors:  [101.26163379  -1.34731773  -0.98256357]
mat_Sqrt:  [[ 9.85349582  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00483548  0.02032939  0.14744765]
Stock Position:  -0.004835477340921146
Bond Position:  [12.58262382]


portfolio before change:  [12.09785886]
curr_Stock_Price:  101.55312756169346
curr_Factors:  [101.55312756  -1.58738966  -0.98498186]
mat_Sqrt:  [[ 7.75401344  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05950424 -0.15902261  1.56601649]
Stock Position:  0.05950423889613454
Bond Position:  [6.0550173]


portfolio before change:  [12.10220788]
curr_Stock_Price:  101.57532362105808
curr_Factors:  [101.57532362  -0.91432419  -0.98587259]
mat_Sqrt:  [[15.18949174  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00231792 -0.02755111  0.34758667]
Stock Position:  0.002317923233292019
Bond Position:  [11.86676408]


portfolio before change:  [12.10363354]
curr_Stock_Price:  99.62995863448636
curr_Factors:  [99.62995863 -1.15711893 -0.9818458 ]
mat_Sqrt:  [[11.73408887  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02501783 -0.12635007 -1.15723481]
Stock Position:  0.025017828892776227
Bond Position:  [9.61110829]


portfolio before change:  [12.03938802]
curr_Stock_Price:  96.86983588241299
curr_Factors:  [96.86983588 -1.34035714 -0.95241673]
mat_Sqrt:  [[ 9.78249253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00206051 0.03197887 0.47052779]
Stock Position:  0.0020605120412055633
Bond Position:  [11.83978656]


portfolio before change:  [12.05022574]
curr_Stock_Price:  99.25581904049113
curr_Factors:  [99.25581904 -1.12725253 -1.04351307]
mat_Sqrt:  [[11.32411983  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304301  0.01503931  0.04142235]
Stock Position:  -0.0030430097941763832
Bond Position:  [12.35226217]


portfolio before change:  [12.05076057]
curr_Stock_Price:  101.11018223069497
curr_Factors:  [101.11018223  -1.04500066  -1.03886795]
mat_Sqrt:  [[12.58294369  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00835674 -0.05573711  0.48616704]
Stock Position:  -0.008356738164472188
Bond Position:  [12.89571189]


portfolio before change:  [12.06940805]
curr_Stock_Price:  99.65052039384273
curr_Factors:  [99.65052039 -0.50714063 -1.06316122]
mat_Sqrt:  [[20.72555375  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00262056  0.02582554  0.56848812]
Stock Position:  -0.0026205584294108496
Bond Position:  [12.33054806]


portfolio before change:  [12.07540604]
curr_Stock_Price:  99.71494324349247
curr_Factors:  [99.71494324 -0.61978108 -1.05220959]
mat_Sqrt:  [[18.73371568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00178753 -0.01357515  0.24731303]
Stock Position:  -0.0017875268610473057
Bond Position:  [12.25364918]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.07934023]
Stock Price:  100.94243119792108
PL:  [11.13690903]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-2.99035320e-02  3.96112292e-02  4.73824606e-02]
 [ 3.92235590e-01 -5.07340309e-01  5.03255146e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.80926327e-01 -4.21097683e-01 -3.92968058e-01]
 [-1.00112869e-01  8.62140747e-02 -2.50504138e-02]
 [-9.45816955e-02  3.44364202e-02  5.58535385e-02]
 [-2.86321702e-01  3.05565847e-01  2.06588436e-01]
 [-1.10122820e-01  8.99191138e-02  2.25149100e-01]
 [ 3.98270304e-03 -8.19593810e-03  9.70515544e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.17170565]
curr_Stock_Price:  100.51504528863123
curr_Factors:  [100.51504529  -1.07374454  -1.03335814]
mat_Sqrt:  [[12.22159841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00099382  0.01278447  0.13516897]
Stock Position:  -0.0009938159534584403
Bond Position:  [6.27159911]


portfolio before change:  [6.17470634]
curr_Stock_Price:  100.65178479902598
curr_Factors:  [100.6517848   -1.34658802  -1.04944288]
mat_Sqrt:  [[ 9.16723751  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04269571 -0.16374338  1.43564685]
Stock Position:  0.042695709426459096
Bond Position:  [1.87730699]


portfolio before change:  [6.18677099]
curr_Stock_Price:  100.91236727353615
curr_Factors:  [100.91236727  -0.70859236  -1.0521448 ]
mat_Sqrt:  [[17.34866098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00202944 -0.02755111  0.34758667]
Stock Position:  0.0020294405334740006
Bond Position:  [5.98197534]


portfolio before change:  [6.1893482]
curr_Stock_Price:  100.70811408713107
curr_Factors:  [100.70811409  -0.73696286  -1.03245389]
mat_Sqrt:  [[17.16392198  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01833822 -0.13590869 -1.12102849]
Stock Position:  0.018338224412579877
Bond Position:  [4.3425402]


portfolio before change:  [6.18688451]
curr_Stock_Price:  100.45533584125747
curr_Factors:  [100.45533584  -0.79321434  -0.9698522 ]
mat_Sqrt:  [[17.22990724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0050858   0.02782547 -0.07146186]
Stock Position:  -0.005085801579734888
Bond Position:  [6.69778042]


portfolio before change:  [6.18985215]
curr_Stock_Price:  100.53046449593846
curr_Factors:  [100.5304645   -0.25175405  -0.96320123]
mat_Sqrt:  [[29.82972957  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00255287  0.01111431  0.1593346 ]
Stock Position:  -0.0025528670899687142
Bond Position:  [6.44649306]


portfolio before change:  [6.19355282]
curr_Stock_Price:  100.34376612227301
curr_Factors:  [100.34376612  -0.32722716  -0.94067241]
mat_Sqrt:  [[28.23895423  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00643716  0.09862095  0.58933931]
Stock Position:  -0.006437159288692796
Bond Position:  [6.83948162]


portfolio before change:  [6.2082359]
curr_Stock_Price:  98.59416163373207
curr_Factors:  [98.59416163 -0.32173906 -0.84472767]
mat_Sqrt:  [[30.70867902  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00149175  0.02902127  0.64228771]
Stock Position:  -0.0014917538499884344
Bond Position:  [6.35531412]


portfolio before change:  [6.2135099]
curr_Stock_Price:  97.18940516042636
curr_Factors:  [97.18940516 -0.97549216 -0.74138512]
mat_Sqrt:  [[17.45776315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00126707 -0.00264523  0.27686107]
Stock Position:  0.0012670741136466832
Bond Position:  [6.09036372]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.21930132]
Stock Price:  99.35619162541308
PL:  [6.21930132]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 5.52200812e-02  3.97787256e-03  3.35655403e-02]
 [ 4.97929087e-01 -6.73881168e-01  6.84064090e-01]
 [ 2.21397409e-02 -8.41114729e-02  1.20632426e-01]
 [ 3.94155930e-01 -3.42060277e-01 -3.33376736e-01]
 [ 4.94594654e-02  2.31810105e-02  1.62321671e-01]
 [ 9.75633027e-02  5.64393481e-02 -1.96718816e-01]
 [-2.16931214e-01  1.17606333e-01  1.89910937e-01]
 [-1.09392044e-01  7.03390407e-02  1.83088669e-01]
 [-1.43344229e-02 -4.57884268e-02  1.97430001e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.8349657]
curr_Stock_Price:  101.10301652115456
curr_Factors:  [101.10301652  -0.29152852  -1.04885778]
mat_Sqrt:  [[26.46316216  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00237627 0.00128385 0.09575314]
Stock Position:  0.002376269242762461
Bond Position:  [10.59471771]


portfolio before change:  [10.84158851]
curr_Stock_Price:  101.66024386223431
curr_Factors:  [101.66024386  -0.50309003  -1.0326849 ]
mat_Sqrt:  [[21.88631101  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02284568 -0.21749421  1.95144444]
Stock Position:  0.022845680441108334
Bond Position:  [8.51909106]


portfolio before change:  [10.79816539]
curr_Stock_Price:  99.57303429145941
curr_Factors:  [99.57303429 -0.32509503 -1.00773378]
mat_Sqrt:  [[26.26041249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00112696 -0.02714686  0.34413073]
Stock Position:  0.0011269643717125334
Bond Position:  [10.68595013]


portfolio before change:  [10.80203816]
curr_Stock_Price:  98.2672725862332
curr_Factors:  [98.26727259 -0.17892508 -1.05293635]
mat_Sqrt:  [[28.66937863  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00893926 -0.11039948 -0.95103103]
Stock Position:  0.008939256424815918
Bond Position:  [9.92360181]


portfolio before change:  [10.78688472]
curr_Stock_Price:  96.0169194123005
curr_Factors:  [96.01691941 -0.55729461 -1.02271743]
mat_Sqrt:  [[19.77685617  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00441552 0.00748164 0.46305855]
Stock Position:  0.004415516852632846
Bond Position:  [10.36292039]


portfolio before change:  [10.77940374]
curr_Stock_Price:  93.14891346811396
curr_Factors:  [93.14891347 -0.6087884  -1.03035797]
mat_Sqrt:  [[18.08446114  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0038115   0.01821572 -0.56118403]
Stock Position:  0.003811497376270419
Bond Position:  [10.4243669]


portfolio before change:  [10.80024847]
curr_Stock_Price:  97.24999085050611
curr_Factors:  [97.24999085 -0.42230386 -1.04714764]
mat_Sqrt:  [[22.3725193   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00689057  0.03795728  0.54176304]
Stock Position:  -0.006890574636879741
Bond Position:  [11.4703568]


portfolio before change:  [10.79550269]
curr_Stock_Price:  98.77125625695764
curr_Factors:  [98.77125626 -0.53478482 -1.06837769]
mat_Sqrt:  [[19.87860704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00290067  0.02270183  0.52230101]
Stock Position:  -0.0029006725344764422
Bond Position:  [11.08200576]


portfolio before change:  [10.77709427]
curr_Stock_Price:  107.0282432750328
curr_Factors:  [107.02824328  -0.82399477  -1.07157426]
mat_Sqrt:  [[16.07915523  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00122214 -0.01477815  0.05632128]
Stock Position:  -0.0012221365561279518
Bond Position:  [10.9078974]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.78177209]
Stock Price:  107.66441899093435
PL:  [3.1173531]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-2.01431372e-02  1.56565499e-02  4.35499116e-02]
 [ 4.74188685e-01 -6.12862985e-01  6.31597810e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.73998707e-01 -5.24348248e-01 -2.43466110e-01]
 [-1.34347176e-01  8.53174718e-02 -3.03942434e-02]
 [-7.26243755e-02 -1.81370479e-02  1.83736855e-02]
 [-1.78776084e-01 -2.18147895e-01  2.34097068e-01]
 [-1.17243951e-01  8.85977475e-02  2.01307799e-01]
 [-1.08830808e-02 -4.53618781e-02  1.71446334e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.44620984]
curr_Stock_Price:  100.29748463513563
curr_Factors:  [100.29748464  -0.62332932  -0.96017054]
mat_Sqrt:  [[20.58660785  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003914   0.00505313  0.12423578]
Stock Position:  -0.0003914034253147779
Bond Position:  [4.48546661]


portfolio before change:  [4.44740078]
curr_Stock_Price:  102.98615150275627
curr_Factors:  [102.9861515   -1.11006246  -0.95891423]
mat_Sqrt:  [[13.00869309  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03674565 -0.19780068  1.80177275]
Stock Position:  0.03674565242691733
Bond Position:  [0.66310745]


portfolio before change:  [4.49323588]
curr_Stock_Price:  104.22448755622749
curr_Factors:  [104.22448756  -1.05241641  -0.97631072]
mat_Sqrt:  [[13.70581204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00256884 -0.02755111  0.34758667]
Stock Position:  0.0025688427432961703
Bond Position:  [4.22549956]


portfolio before change:  [4.49625422]
curr_Stock_Price:  104.57680915121105
curr_Factors:  [104.57680915  -1.25064462  -0.98823132]
mat_Sqrt:  [[11.14561197  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03743799 -0.16923267 -0.69454104]
Stock Position:  0.03743798530086403
Bond Position:  [0.58110917]


portfolio before change:  [4.51573612]
curr_Stock_Price:  105.08942426309221
curr_Factors:  [105.08942426  -0.74135719  -1.04193932]
mat_Sqrt:  [[17.6637609   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00697111  0.0275361  -0.08670632]
Stock Position:  -0.006971109932089919
Bond Position:  [5.24832605]


portfolio before change:  [4.53226065]
curr_Stock_Price:  103.09552154877669
curr_Factors:  [103.09552155  -0.67125589  -1.03352381]
mat_Sqrt:  [[18.74404775  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00387195 -0.00585371  0.05241501]
Stock Position:  -0.003871953009352491
Bond Position:  [4.93144167]


portfolio before change:  [4.5290362]
curr_Stock_Price:  104.56526801158851
curr_Factors:  [104.56526801  -1.03228461  -1.06774726]
mat_Sqrt:  [[12.80428113  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01370795 -0.07040693  0.66781378]
Stock Position:  -0.013707952134307927
Bond Position:  [5.96241189]


portfolio before change:  [4.50854449]
curr_Stock_Price:  106.27768041087249
curr_Factors:  [106.27768041  -0.9921205   -0.98940015]
mat_Sqrt:  [[14.65138167  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00396326  0.0285948   0.57427512]
Stock Position:  -0.0039632596271952526
Bond Position:  [4.92975053]


portfolio before change:  [4.50417587]
curr_Stock_Price:  108.00204700483233
curr_Factors:  [108.002047    -1.09908677  -1.06622304]
mat_Sqrt:  [[12.38938889  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00134332 -0.01464048  0.04890887]
Stock Position:  -0.0013433190199808468
Bond Position:  [4.64925707]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.50754271]
Stock Price:  107.22662960585359
PL:  [-2.7190869]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 5.61040569e-02  1.34147486e-01  5.24055393e-02]
 [ 3.17578993e-01 -4.50507680e-01  4.47760454e-01]
 [-3.68841233e-01  4.32487416e-02 -3.38368149e-01]
 [ 2.81342033e-01 -2.51700206e-01 -1.90445937e-01]
 [ 1.41460274e-01 -1.02742400e-01  1.52925926e-01]
 [ 8.95315024e-02  5.82973619e-02 -2.27931956e-01]
 [-1.54983930e-01 -2.35422100e-01  3.02513337e-01]
 [-4.50333153e-02  7.81994015e-03  2.30467343e-01]
 [ 2.80489623e-01  2.02675979e-01  1.54834620e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.2742848]
curr_Stock_Price:  98.69360991394335
curr_Factors:  [98.69360991 -0.78973137 -0.94242028]
mat_Sqrt:  [[17.4592318   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00539451 0.04329592 0.14949842]
Stock Position:  0.005394511906886801
Bond Position:  [-8.80668865]


portfolio before change:  [-8.2750039]
curr_Stock_Price:  99.37677454811868
curr_Factors:  [99.37677455 -0.53510279 -0.96597549]
mat_Sqrt:  [[22.15005883  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0143123  -0.14540073  1.27733594]
Stock Position:  0.014312296889152882
Bond Position:  [-9.6973138]


portfolio before change:  [-8.32230448]
curr_Stock_Price:  96.41074379450045
curr_Factors:  [96.41074379 -0.13988253 -0.9649627 ]
mat_Sqrt:  [[31.93723016  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01343517  0.01395847 -0.96527015]
Stock Position:  -0.013435173546941837
Bond Position:  [-7.02700941]


portfolio before change:  [-8.31297815]
curr_Stock_Price:  95.45499012954
curr_Factors:  [ 9.54549901e+01 -7.17174781e-02 -1.02145215e+00]
mat_Sqrt:  [[31.99197844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00597304 -0.08123589 -0.54328925]
Stock Position:  0.0059730388392208915
Bond Position:  [-8.88313451]


portfolio before change:  [-8.31764548]
curr_Stock_Price:  95.41737855640018
curr_Factors:  [95.41737856 -0.1757293  -0.97384092]
mat_Sqrt:  [[30.22563805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00501905 -0.03315997  0.4362551 ]
Stock Position:  0.005019048485826178
Bond Position:  [-8.79654993]


portfolio before change:  [-8.33430023]
curr_Stock_Price:  92.9756064364267
curr_Factors:  [92.97560644 -0.21524343 -0.94897031]
mat_Sqrt:  [[29.02401012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00189171  0.01881539 -0.65022643]
Stock Position:  0.0018917091622681253
Bond Position:  [-8.51018304]


portfolio before change:  [-8.34590387]
curr_Stock_Price:  89.09156097707385
curr_Factors:  [89.09156098 -0.45867434 -0.94682465]
mat_Sqrt:  [[21.84922872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00646654 -0.07598216  0.86298635]
Stock Position:  -0.006466543517474913
Bond Position:  [-7.76978941]


portfolio before change:  [-8.34426792]
curr_Stock_Price:  88.23765611870417
curr_Factors:  [88.23765612 -0.53908133 -0.87786996]
mat_Sqrt:  [[21.39340138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [1.68597439e-04 2.52387483e-03 6.57459179e-01]
Stock Position:  0.00016859743947655266
Bond Position:  [-8.35914457]


portfolio before change:  [-8.34877951]
curr_Stock_Price:  86.27456292942637
curr_Factors:  [86.27456293 -0.64087871 -0.85963094]
mat_Sqrt:  [[19.24064857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0183708  0.06541339 0.44170007]
Stock Position:  0.018370803199525425
Bond Position:  [-9.93371253]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.32583503]
Stock Price:  87.79396183728589
PL:  [-8.32583503]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-5.83726887e-02  5.57841005e-02  5.03602159e-02]
 [ 4.49258732e-01 -4.83138914e-01  5.43543475e-01]
 [ 1.80548654e-02 -6.81857822e-02  7.83858480e-02]
 [ 5.73659020e-01 -5.12956502e-01 -3.56893106e-01]
 [-1.51330005e-01  1.19574263e-01 -1.52235009e-01]
 [-8.71242605e-02  1.66670392e-02  4.42319654e-02]
 [-3.43281265e-02 -3.14287480e-01  1.65273358e-01]
 [-1.15730836e-01  9.42775023e-02  2.18561574e-01]
 [-9.64955745e-03 -4.27139196e-02  2.34822027e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.42119164]
curr_Stock_Price:  100.9247595783999
curr_Factors:  [100.92475958  -1.47101958  -1.00922843]
mat_Sqrt:  [[ 8.44966908  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00434408  0.01800424  0.14366368]
Stock Position:  -0.004344083832928307
Bond Position:  [9.85961725]


portfolio before change:  [9.42329874]
curr_Stock_Price:  101.57482473049512
curr_Factors:  [101.57482473  -1.64999784  -0.99547663]
mat_Sqrt:  [[ 7.20893515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06403009 -0.15593241  1.55057824]
Stock Position:  0.06403008925915836
Bond Position:  [2.91945365]


portfolio before change:  [9.42754735]
curr_Stock_Price:  101.61837478881327
curr_Factors:  [101.61837479  -1.51906452  -0.97385595]
mat_Sqrt:  [[ 8.40060648  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00239708 -0.02200687  0.22361301]
Stock Position:  0.0023970822978333474
Bond Position:  [9.18395974]


portfolio before change:  [9.43297025]
curr_Stock_Price:  101.96453637125823
curr_Factors:  [101.96453637  -1.99611379  -0.90415803]
mat_Sqrt:  [[ 5.6088923   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07062031 -0.165556   -1.01811669]
Stock Position:  0.07062030990102919
Bond Position:  [2.23220309]


portfolio before change:  [9.51163692]
curr_Stock_Price:  103.06266653850153
curr_Factors:  [103.06266654  -1.7486495   -0.91436331]
mat_Sqrt:  [[ 7.18736342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02198259  0.03859243 -0.43428411]
Stock Position:  -0.021982588473541252
Bond Position:  [11.77722111]


portfolio before change:  [9.5284414]
curr_Stock_Price:  102.56616505549735
curr_Factors:  [102.56616506  -1.71316995  -0.92234551]
mat_Sqrt:  [[ 7.35214896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01015938  0.00537926  0.12618149]
Stock Position:  -0.010159383823212844
Bond Position:  [10.57045043]


portfolio before change:  [9.53680079]
curr_Stock_Price:  102.26370102369867
curr_Factors:  [102.26370102  -1.38267163  -0.87242841]
mat_Sqrt:  [[10.72368395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00603762 -0.10143585  0.47147889]
Stock Position:  -0.006037617942618144
Bond Position:  [10.15422995]


portfolio before change:  [9.54521128]
curr_Stock_Price:  101.71181094562755
curr_Factors:  [101.71181095  -0.72529709  -0.83493961]
mat_Sqrt:  [[21.36826184  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242756  0.03042793  0.62349533]
Stock Position:  -0.002427564180372204
Bond Position:  [9.79212323]


portfolio before change:  [9.54311372]
curr_Stock_Price:  104.59323576084424
curr_Factors:  [104.59323576  -0.57839767  -0.85813067]
mat_Sqrt:  [[24.86722173  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00054591 -0.01378586  0.06698819]
Stock Position:  -0.000545907997679672
Bond Position:  [9.600212]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.54968462]
Stock Price:  101.35167119519402
PL:  [8.19801343]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.28967219e-02  1.00104522e-01  5.20579271e-02]
 [ 2.58067456e-01 -2.74999785e-01  3.34844986e-01]
 [-2.33191224e-01  3.55588672e-02 -2.09588272e-01]
 [ 3.81514868e-01 -3.26890999e-01 -3.38815099e-01]
 [ 2.61587449e-03  4.97300602e-02  1.53452619e-01]
 [-5.07529559e-02  5.78904753e-02 -3.33371049e-02]
 [-1.49686801e-01 -8.51448565e-02  1.75607205e-01]
 [-1.11155057e-01  5.23869035e-02  1.37398698e-01]
 [-5.52540199e-02 -5.46626933e-02  4.11075209e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.32180875]
curr_Stock_Price:  98.8137036911171
curr_Factors:  [98.81370369 -1.48997136 -1.04557214]
mat_Sqrt:  [[ 7.82788841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00817037 0.0323086  0.14850678]
Stock Position:  0.008170370919741597
Bond Position:  [-8.12915336]


portfolio before change:  [-7.32441657]
curr_Stock_Price:  98.99212599879509
curr_Factors:  [98.992126   -1.25851367 -1.06091027]
mat_Sqrt:  [[ 9.73391687  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02776717 -0.0887558   0.95521954]
Stock Position:  0.027767168209902073
Bond Position:  [-10.07314758]


portfolio before change:  [-7.36359854]
curr_Stock_Price:  97.76246734235463
curr_Factors:  [97.76246734 -0.53888507 -1.0909724 ]
mat_Sqrt:  [[19.1572888   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01402677  0.01147658 -0.597897  ]
Stock Position:  -0.014026767081250748
Bond Position:  [-5.99230718]


portfolio before change:  [-7.36915181]
curr_Stock_Price:  97.94471663761452
curr_Factors:  [97.94471664 -1.00396556 -1.06890384]
mat_Sqrt:  [[12.32381794  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01993118 -0.10550362 -0.96654517]
Stock Position:  0.019931175654112735
Bond Position:  [-9.32130516]


portfolio before change:  [-7.39645484]
curr_Stock_Price:  96.80874728758405
curr_Factors:  [96.80874729 -0.45431092 -1.06550714]
mat_Sqrt:  [[21.17707641  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00208199 0.01605031 0.43775761]
Stock Position:  0.0020819854613884662
Bond Position:  [-7.59800924]


portfolio before change:  [-7.39681318]
curr_Stock_Price:  98.46178991298102
curr_Factors:  [98.46178991 -0.65468258 -1.03248788]
mat_Sqrt:  [[18.21960286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00251054  0.01868407 -0.09510148]
Stock Position:  -0.0025105388167690314
Bond Position:  [-7.14962103]


portfolio before change:  [-7.40756484]
curr_Stock_Price:  101.3201226074731
curr_Factors:  [101.32012261  -0.89103563  -1.07719258]
mat_Sqrt:  [[14.15484303  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00927041 -0.02748038  0.50095848]
Stock Position:  -0.00927041373514998
Bond Position:  [-6.46828538]


portfolio before change:  [-7.40055232]
curr_Stock_Price:  100.21472710623563
curr_Factors:  [100.21472711  -1.05217268  -1.07550397]
mat_Sqrt:  [[11.9369485   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00606648  0.0169078   0.39196024]
Stock Position:  -0.006066477830553683
Bond Position:  [-6.7926019]


portfolio before change:  [-7.40946704]
curr_Stock_Price:  101.12424602201428
curr_Factors:  [101.12424602  -0.94594633  -1.08569884]
mat_Sqrt:  [[13.25937374  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00437584 -0.01764231  0.11726831]
Stock Position:  -0.004375844518098587
Bond Position:  [-6.96696307]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.41262248]
Stock Price:  101.04908088669373
PL:  [-8.46170337]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-2.78772890e-02  4.10262376e-02  4.73486929e-02]
 [ 2.64285545e-01 -2.93337802e-01  3.46643006e-01]
 [-3.49942503e-02 -5.87293553e-02  7.55420712e-02]
 [ 4.33185021e-01 -3.65393832e-01 -4.09550555e-01]
 [-8.08608755e-02  1.04266377e-01  4.48747791e-02]
 [-5.18108004e-02  4.92906989e-02  3.19718635e-03]
 [-4.86825898e-02 -2.70047434e-01  1.63591842e-01]
 [-1.07071860e-01  5.91794725e-02  1.64692572e-01]
 [-9.28642776e-03 -1.84819367e-02  9.45166181e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.84927995]
curr_Stock_Price:  100.3483060845569
curr_Factors:  [100.34830608  -1.0622472   -0.96551469]
mat_Sqrt:  [[13.20882689  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00074479  0.01324116  0.13507264]
Stock Position:  -0.0007447922437312253
Bond Position:  [4.92401859]


portfolio before change:  [4.85269337]
curr_Stock_Price:  99.07171963033028
curr_Factors:  [99.07171963 -1.25362624 -0.96177657]
mat_Sqrt:  [[10.80967124  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02545558 -0.09467437  0.98887601]
Stock Position:  0.025455577492796182
Bond Position:  [2.33076553]


portfolio before change:  [4.85793023]
curr_Stock_Price:  99.23165240893341
curr_Factors:  [99.23165241 -1.43583322 -0.94844405]
mat_Sqrt:  [[ 9.14474843  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00345142 -0.01895482  0.2155005 ]
Stock Position:  -0.0034514201514161615
Bond Position:  [5.20042035]


portfolio before change:  [4.86160048]
curr_Stock_Price:  98.92181125699662
curr_Factors:  [98.92181126 -1.48005601 -0.95616408]
mat_Sqrt:  [[ 8.65476184  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03177443 -0.11793035 -1.16833374]
Stock Position:  0.031774434231608494
Bond Position:  [1.71841589]


portfolio before change:  [4.86110683]
curr_Stock_Price:  98.87922773880781
curr_Factors:  [98.87922774 -1.3954185  -1.02350026]
mat_Sqrt:  [[ 8.80201274  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00572796  0.03365183  0.12801525]
Stock Position:  -0.005727958590550742
Bond Position:  [5.42748296]


portfolio before change:  [4.86224221]
curr_Stock_Price:  99.15490124240458
curr_Factors:  [99.15490124 -0.90776519 -1.00173287]
mat_Sqrt:  [[14.69026797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00279755  0.0159085   0.00912068]
Stock Position:  -0.002797549765823872
Bond Position:  [5.13963298]


portfolio before change:  [4.86187479]
curr_Stock_Price:  100.20506223607015
curr_Factors:  [100.20506224  -1.20517381  -1.01980132]
mat_Sqrt:  [[10.82917172  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00650214 -0.08715743  0.46668199]
Stock Position:  -0.006502135938246921
Bond Position:  [5.51342173]


portfolio before change:  [4.87368438]
curr_Stock_Price:  98.81287440017589
curr_Factors:  [98.8128744  -0.76903819 -0.99189858]
mat_Sqrt:  [[16.9843296   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361358  0.01910009  0.46982207]
Stock Position:  -0.0036135762717824254
Bond Position:  [5.23075224]


portfolio before change:  [4.87860125]
curr_Stock_Price:  98.17615337541679
curr_Factors:  [98.17615338 -0.69272511 -0.98714028]
mat_Sqrt:  [[18.2999431   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00034066 -0.00596502  0.2696296 ]
Stock Position:  0.00034066152813715594
Bond Position:  [4.84515642]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.8812353]
Stock Price:  98.7951226145777
PL:  [4.8812353]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-1.05801330e-01  8.27275507e-02  5.53210545e-02]
 [ 5.03461847e-01 -6.22048096e-01  6.63128986e-01]
 [-2.16788902e-02 -5.40221912e-02  5.83340956e-02]
 [ 5.54361220e-01 -5.00581808e-01 -3.31211969e-01]
 [-1.47109769e-01  1.13076352e-01 -1.27456593e-01]
 [-7.17127644e-02 -2.15236405e-02  1.36611734e-03]
 [-6.49981265e-02 -4.11542893e-01  2.28906274e-01]
 [-1.15145751e-01  5.13962925e-02  1.23473372e-01]
 [ 1.05679296e-02 -3.80665199e-02  1.45178585e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.41787057]
curr_Stock_Price:  102.43737136279512
curr_Factors:  [102.43737136  -1.04544307  -1.03550035]
mat_Sqrt:  [[12.78545479  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00607114  0.0267002   0.15781557]
Stock Position:  -0.006071139222545374
Bond Position:  [22.03978211]


portfolio before change:  [21.43207095]
curr_Stock_Price:  101.91395517483768
curr_Factors:  [101.91395517  -0.86201326  -1.01732398]
mat_Sqrt:  [[15.56137128  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03289218 -0.20076516  1.89172242]
Stock Position:  0.0328921814991423
Bond Position:  [18.07989864]


portfolio before change:  [21.42943389]
curr_Stock_Price:  101.55887777254162
curr_Factors:  [101.55887777  -1.34085115  -1.06018409]
mat_Sqrt:  [[ 9.20368049  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00225983 -0.01743559  0.16641094]
Stock Position:  -0.0022598270787854164
Bond Position:  [21.65893939]


portfolio before change:  [21.43734552]
curr_Stock_Price:  102.85125276933896
curr_Factors:  [102.85125277  -1.37623678  -1.10274094]
mat_Sqrt:  [[ 8.62190516  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04460407 -0.16156208 -0.94485555]
Stock Position:  0.044604065894466756
Bond Position:  [16.84976147]


portfolio before change:  [21.48619795]
curr_Stock_Price:  103.7575701421381
curr_Factors:  [103.75757014  -1.73138053  -1.15428014]
mat_Sqrt:  [[ 5.79152973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02590768  0.03649524 -0.36359818]
Stock Position:  -0.025907684136026822
Bond Position:  [24.1743163]


portfolio before change:  [21.49824134]
curr_Stock_Price:  103.75937605564307
curr_Factors:  [103.75937606  -1.87259519  -1.16164037]
mat_Sqrt:  [[ 4.99201167  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01518975 -0.00694673  0.00389715]
Stock Position:  -0.015189748456225404
Bond Position:  [23.07432017]


portfolio before change:  [21.51463481]
curr_Stock_Price:  103.43985668314552
curr_Factors:  [103.43985668  -1.49946964  -1.09066395]
mat_Sqrt:  [[ 7.75902563  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0131819  -0.1328249   0.65300588]
Stock Position:  -0.013181896150604912
Bond Position:  [22.87816826]


portfolio before change:  [21.53815583]
curr_Stock_Price:  102.52351805652343
curr_Factors:  [102.52351806  -1.42938199  -1.05757612]
mat_Sqrt:  [[ 8.52611759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0093185   0.01658808  0.35223516]
Stock Position:  -0.009318500411825074
Bond Position:  [22.49352128]


portfolio before change:  [21.530407]
curr_Stock_Price:  104.56230107898834
curr_Factors:  [104.56230108  -1.79757911  -1.10461655]
mat_Sqrt:  [[ 5.74073594  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00100354 -0.01228592  0.04141541]
Stock Position:  0.0010035436700005765
Bond Position:  [21.42547417]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.54159227]
Stock Price:  105.03049086394073
PL:  [16.51110141]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-1.39148287e-01  1.01671423e-01  5.88090075e-02]
 [ 4.78974696e-01 -6.51222833e-01  6.55257806e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.80740255e-01 -5.32438449e-01 -2.08385154e-01]
 [-1.22431028e-01  6.25003189e-02  5.30791255e-02]
 [-3.39364783e-02 -1.15701978e-01 -1.10973524e-01]
 [-3.35347688e-01  8.38862656e-02  3.14018485e-01]
 [-1.17216262e-01  8.71638913e-02  1.98152052e-01]
 [-7.81099058e-03 -3.90655124e-02  1.37884643e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [25.70267951]
curr_Stock_Price:  102.97762525542203
curr_Factors:  [102.97762526  -1.25447547  -0.96114582]
mat_Sqrt:  [[11.23338828  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00947091  0.03281431  0.16776573]
Stock Position:  -0.009470905313078534
Bond Position:  [26.67797085]


portfolio before change:  [25.71571124]
curr_Stock_Price:  103.01041984523388
curr_Factors:  [103.01041985  -0.88058968  -0.95297741]
mat_Sqrt:  [[16.46543034  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02913974 -0.21018127  1.86926813]
Stock Position:  0.02913973830737208
Bond Position:  [22.71401456]


portfolio before change:  [25.74790893]
curr_Stock_Price:  103.72552058943936
curr_Factors:  [103.72552059  -0.95243983  -0.92037432]
mat_Sqrt:  [[15.94163187  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00220856 -0.02755111  0.34758667]
Stock Position:  0.0022085615882313798
Bond Position:  [25.51882473]


portfolio before change:  [25.76399936]
curr_Stock_Price:  105.23230688954072
curr_Factors:  [105.23230689  -1.0609506   -0.89240959]
mat_Sqrt:  [[14.92160505  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02878513 -0.17184377 -0.59446484]
Stock Position:  0.028785125242916234
Bond Position:  [22.73487423]


portfolio before change:  [25.81663877]
curr_Stock_Price:  106.66600315451933
curr_Factors:  [106.66600315  -1.14229198  -0.90431093]
mat_Sqrt:  [[13.77836446  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00717345  0.02017189  0.15141997]
Stock Position:  -0.007173454642762303
Bond Position:  [26.58180251]


portfolio before change:  [25.83344209]
curr_Stock_Price:  106.176825102861
curr_Factors:  [106.1768251   -1.00949414  -0.90350679]
mat_Sqrt:  [[15.67559338  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00511664 -0.03734265 -0.31657658]
Stock Position:  -0.005116643396833369
Bond Position:  [26.37671104]


portfolio before change:  [25.84964603]
curr_Stock_Price:  105.58810223494295
curr_Factors:  [105.58810223  -0.63760609  -0.8887071 ]
mat_Sqrt:  [[22.94803958  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01107396  0.02707418  0.89580733]
Stock Position:  -0.011073962136788447
Bond Position:  [27.01892468]


portfolio before change:  [25.82645461]
curr_Stock_Price:  108.90256709949783
curr_Factors:  [108.9025671   -1.15786761  -0.8858372 ]
mat_Sqrt:  [[14.10809573  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00418032  0.02813202  0.56527265]
Stock Position:  -0.004180322462950103
Bond Position:  [26.28170246]


portfolio before change:  [25.83116529]
curr_Stock_Price:  110.91998535986558
curr_Factors:  [110.91998536  -1.42701778  -0.88823713]
mat_Sqrt:  [[10.95235138  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118428 -0.01260834  0.03933465]
Stock Position:  -0.001184279608176402
Bond Position:  [25.96252557]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [25.84474491]
Stock Price:  110.4174717017055
PL:  [15.42727321]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-5.71099042e-02  5.50667329e-02  5.02281339e-02]
 [ 3.49525196e-01 -5.00401251e-01  4.60494668e-01]
 [-2.14864779e-02 -5.40907789e-02  5.84311970e-02]
 [ 5.22146473e-01 -4.59162847e-01 -3.82995083e-01]
 [-1.13383434e-01  1.12326422e-01 -4.84078430e-02]
 [-8.01500596e-02  3.85410812e-02  5.29421413e-02]
 [-1.91966451e-01  8.42401802e-02  1.87132790e-01]
 [-7.17719574e-02  2.29689158e-02  1.86345603e-01]
 [ 6.75530776e-02  4.13257306e-02  1.08848871e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.08398293]
curr_Stock_Price:  101.26049995412471
curr_Factors:  [101.26049995  -0.93714481  -1.02353078]
mat_Sqrt:  [[14.25376117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00249876  0.01777271  0.14328689]
Stock Position:  -0.0024987565806070433
Bond Position:  [12.33700827]


portfolio before change:  [12.09318752]
curr_Stock_Price:  100.04608084816284
curr_Factors:  [100.04608085  -1.28260417  -0.99825909]
mat_Sqrt:  [[10.22430397  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.033389   -0.16150381  1.31366311]
Stock Position:  0.033389001319824925
Bond Position:  [8.75274879]


portfolio before change:  [12.13175872]
curr_Stock_Price:  101.07018274106345
curr_Factors:  [101.07018274  -1.39817514  -0.94792764]
mat_Sqrt:  [[ 9.67661717  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00212889 -0.01745772  0.16668794]
Stock Position:  -0.002128894161991279
Bond Position:  [12.34692645]


portfolio before change:  [12.1383563]
curr_Stock_Price:  100.87168902251473
curr_Factors:  [100.87168902  -1.89637969  -0.94393755]
mat_Sqrt:  [[ 5.89162626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05944737 -0.14819417 -1.09257837]
Stock Position:  0.059447373230275186
Bond Position:  [6.14179936]


portfolio before change:  [12.11444818]
curr_Stock_Price:  100.41784581078372
curr_Factors:  [100.41784581  -1.08128649  -0.98602399]
mat_Sqrt:  [[12.70542992  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0078971  0.0362532 -0.1380941]
Stock Position:  -0.007897104553434493
Bond Position:  [12.90745841]


portfolio before change:  [12.12695047]
curr_Stock_Price:  99.65212932365661
curr_Factors:  [99.65212932 -0.41963765 -0.94350279]
mat_Sqrt:  [[25.49659677  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00241115  0.01243908  0.15102919]
Stock Position:  -0.0024111502245952377
Bond Position:  [12.36722672]


portfolio before change:  [12.1393402]
curr_Stock_Price:  97.07884631285356
curr_Factors:  [97.07884631 -0.50961545 -0.99062538]
mat_Sqrt:  [[21.65600248  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00630646  0.0271884   0.53383776]
Stock Position:  -0.006306458268497623
Bond Position:  [12.75156389]


portfolio before change:  [12.15740191]
curr_Stock_Price:  95.22608957553334
curr_Factors:  [95.22608958 -0.69016311 -0.9988006 ]
mat_Sqrt:  [[17.58929096  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00165133  0.00741319  0.53159214]
Stock Position:  -0.0016513349127320516
Bond Position:  [12.31465208]


portfolio before change:  [12.16551271]
curr_Stock_Price:  94.04405653290657
curr_Factors:  [94.04405653 -1.09414623 -1.02063332]
mat_Sqrt:  [[11.34734519  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00865465 0.01333782 0.31051553]
Stock Position:  0.00865465341859359
Bond Position:  [11.35159399]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.18058103]
Stock Price:  95.12914988332986
PL:  [12.18058103]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-6.53910404e-02  4.42419715e-02  4.87226250e-02]
 [ 3.73546770e-01 -6.01504312e-01  5.33344330e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.33385196e-01 -4.88515230e-01 -2.33318635e-01]
 [-1.35501068e-01  9.17954377e-02 -1.01037616e-01]
 [-9.37488501e-02  3.24519379e-02  5.45556426e-02]
 [-2.13944057e-01  8.53437558e-02  1.81658677e-01]
 [-1.11537112e-01  8.23949717e-02  2.04021185e-01]
 [-4.97434059e-02 -4.65700807e-02  8.44041724e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.9939619]
curr_Stock_Price:  101.50132132694631
curr_Factors:  [101.50132133  -0.76997258  -1.02792266]
mat_Sqrt:  [[16.81340654  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00276058  0.01427903  0.13899209]
Stock Position:  -0.0027605780847125326
Bond Position:  [14.27416422]


portfolio before change:  [14.0054575]
curr_Stock_Price:  99.92312541582614
curr_Factors:  [99.92312542 -0.32930565 -1.00643124]
mat_Sqrt:  [[26.27621751  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01368666 -0.19413468  1.52148292]
Stock Position:  0.013686660626626702
Bond Position:  [12.63784359]


portfolio before change:  [14.02890485]
curr_Stock_Price:  101.17447886859141
curr_Factors:  [ 1.01174479e+02  6.22916473e-02 -1.09146896e+00]
mat_Sqrt:  [[36.14972091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00097395 -0.02755111  0.34758667]
Stock Position:  0.0009739515247263111
Bond Position:  [13.93036581]


portfolio before change:  [14.0394615]
curr_Stock_Price:  104.86021353087375
curr_Factors:  [104.86021353  -0.22744413  -1.06867614]
mat_Sqrt:  [[28.6888315   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01345616 -0.15766761 -0.66559312]
Stock Position:  0.013456158901453784
Bond Position:  [12.6284458]


portfolio before change:  [14.01654075]
curr_Stock_Price:  102.68748707274703
curr_Factors:  [102.68748707  -0.60742386  -1.09908038]
mat_Sqrt:  [[18.63769287  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00737149  0.02962685 -0.2882322 ]
Stock Position:  -0.007371492825913704
Bond Position:  [14.77350082]


portfolio before change:  [14.03401299]
curr_Stock_Price:  101.31956314678669
curr_Factors:  [101.31956315  -0.81863642  -1.14229864]
mat_Sqrt:  [[14.25837491  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00532939  0.01047382  0.15563206]
Stock Position:  -0.005329394311387638
Bond Position:  [14.57398489]


portfolio before change:  [14.04381117]
curr_Stock_Price:  100.84870908442977
curr_Factors:  [100.84870908  -0.63848301  -1.09259935]
mat_Sqrt:  [[17.85956291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00892757  0.02754458  0.51822164]
Stock Position:  -0.008927565293038398
Bond Position:  [14.9441446]


portfolio before change:  [14.06129416]
curr_Stock_Price:  99.72756964068924
curr_Factors:  [99.72756964 -0.46712921 -1.08071711]
mat_Sqrt:  [[21.21261058  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00250194  0.02659286  0.58201565]
Stock Position:  -0.0025019390419036354
Bond Position:  [14.31080646]


portfolio before change:  [14.06846935]
curr_Stock_Price:  99.7203733765751
curr_Factors:  [99.72037338 -0.75239427 -1.06467333]
mat_Sqrt:  [[16.20471754  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259311 -0.01503043  0.24078161]
Stock Position:  -0.002593106246568587
Bond Position:  [14.32705488]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.06788492]
Stock Price:  102.7089726898645
PL:  [11.35891223]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 2.02403407e-02  8.29560372e-02  4.82943021e-02]
 [ 2.36300993e-01 -2.10807421e-01  2.93545928e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.66623190e-01 -5.17488579e-01 -2.39524203e-01]
 [-1.48182475e-01  1.10452505e-01 -1.23815990e-01]
 [-8.15098581e-02  3.28918831e-03  3.54825514e-02]
 [-1.19614523e-01 -7.84760052e-02  1.72399860e-01]
 [-1.16643605e-01  8.76895524e-02  2.01016064e-01]
 [-5.96478339e-04 -4.01355339e-02  2.09162594e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.18735869]
curr_Stock_Price:  99.76050365354635
curr_Factors:  [99.76050365 -0.86937135 -0.95471862]
mat_Sqrt:  [[16.09779623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00292162 0.02677395 0.1377702 ]
Stock Position:  0.0029216237657409827
Bond Position:  [-0.10410397]


portfolio before change:  [0.18390273]
curr_Stock_Price:  98.5954340671867
curr_Factors:  [98.59543407 -0.74648723 -0.95756802]
mat_Sqrt:  [[17.93886706  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01411404 -0.0680378   0.83740482]
Stock Position:  0.014114041806539197
Bond Position:  [-1.20767735]


portfolio before change:  [0.24161486]
curr_Stock_Price:  102.72721425615639
curr_Factors:  [102.72721426  -0.91905175  -0.94698188]
mat_Sqrt:  [[15.89561756  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00221495 -0.02755111  0.34758667]
Stock Position:  0.0022149548873229958
Bond Position:  [0.01407871]


portfolio before change:  [0.24584254]
curr_Stock_Price:  104.63273330754036
curr_Factors:  [104.63273331  -0.80339983  -0.90883826]
mat_Sqrt:  [[18.88217484  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02182474 -0.16701872 -0.68329588]
Stock Position:  0.021824742455398043
Bond Position:  [-2.03773992]


portfolio before change:  [0.21702475]
curr_Stock_Price:  103.3590110654831
curr_Factors:  [103.35901107  -1.11090176  -0.9108437 ]
mat_Sqrt:  [[13.68722636  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01102563  0.03564839 -0.35321256]
Stock Position:  -0.011025629392338266
Bond Position:  [1.3566229]


portfolio before change:  [0.22614537]
curr_Stock_Price:  102.59332787078921
curr_Factors:  [102.59332787  -0.94829864  -0.86366359]
mat_Sqrt:  [[16.75690939  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00439196  0.00106158  0.10122184]
Stock Position:  -0.004391956070477544
Bond Position:  [0.67673076]


portfolio before change:  [0.23075524]
curr_Stock_Price:  101.62077389728098
curr_Factors:  [101.6207739  -1.0431894  -0.8696338]
mat_Sqrt:  [[15.00561971  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00669365 -0.02532802  0.49180881]
Stock Position:  -0.0066936519964301625
Bond Position:  [0.91096933]


portfolio before change:  [0.2262859]
curr_Stock_Price:  102.35653556707787
curr_Factors:  [102.35653557  -0.97356361  -0.77437246]
mat_Sqrt:  [[17.82364766  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00323794  0.02830168  0.57344288]
Stock Position:  -0.0032379353048407325
Bond Position:  [0.55770974]


portfolio before change:  [0.22140563]
curr_Stock_Price:  103.94989607484686
curr_Factors:  [103.94989607  -1.04608624  -0.81853982]
mat_Sqrt:  [[16.10746702  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00028059 -0.01295369  0.05966827]
Stock Position:  -0.0002805901326869989
Bond Position:  [0.25057295]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.22171811]
Stock Price:  103.28288601252508
PL:  [-3.06116791]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 1.31046050e-02  5.22002988e-02  4.52069820e-02]
 [ 4.58136107e-01 -6.57989401e-01  6.39491727e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.69596982e-01 -4.08724171e-01 -3.98215506e-01]
 [-2.96844479e-02  1.00904522e-01  1.69993255e-01]
 [-3.51368606e-02  6.78966781e-02 -7.61723270e-02]
 [-4.81969968e-02 -1.79385490e-01  1.62304843e-01]
 [-8.70834949e-02  4.54799984e-02  1.92314357e-01]
 [ 5.07306049e-02  2.62888761e-02  1.08487044e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.53919169]
curr_Stock_Price:  100.05703658030009
curr_Factors:  [100.05703658  -0.64953489  -1.05168575]
mat_Sqrt:  [[18.25647382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00180691 0.01684757 0.12896294]
Stock Position:  0.0018069087847687561
Bond Position:  [2.35839776]


portfolio before change:  [2.54229916]
curr_Stock_Price:  101.12403783763077
curr_Factors:  [101.12403784  -0.51079609  -1.09168256]
mat_Sqrt:  [[20.36604828  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02230969 -0.21236517  1.8242919 ]
Stock Position:  0.022309693042071168
Bond Position:  [0.28625292]


portfolio before change:  [2.52142045]
curr_Stock_Price:  100.18176272416345
curr_Factors:  [100.18176272  -0.98677557  -1.04887291]
mat_Sqrt:  [[13.08331404  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00269107 -0.02755111  0.34758667]
Stock Position:  0.002691067087719917
Bond Position:  [2.25182461]


portfolio before change:  [2.52297395]
curr_Stock_Price:  100.34054905942527
curr_Factors:  [100.34054906  -0.76037729  -1.08883375]
mat_Sqrt:  [[15.78971619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01930884 -0.13191516 -1.135998  ]
Stock Position:  0.019308840439666734
Bond Position:  [0.5855143]


portfolio before change:  [2.45360315]
curr_Stock_Price:  96.73268712390579
curr_Factors:  [96.73268712 -1.20244888 -1.02747481]
mat_Sqrt:  [[10.40230781  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00246218 0.03256679 0.48494344]
Stock Position:  0.0024621776054971124
Bond Position:  [2.2154301]


portfolio before change:  [2.45696617]
curr_Stock_Price:  97.64855510583814
curr_Factors:  [97.64855511 -0.79955063 -0.97969923]
mat_Sqrt:  [[16.47962894  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223464  0.02191356 -0.21729845]
Stock Position:  -0.002234644997259965
Bond Position:  [2.67517603]


portfolio before change:  [2.45834589]
curr_Stock_Price:  97.6298545649961
curr_Factors:  [97.62985456 -1.10039285 -1.03459343]
mat_Sqrt:  [[11.54436049  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00447695 -0.05789642  0.46301054]
Stock Position:  -0.004476953876143396
Bond Position:  [2.89543024]


portfolio before change:  [2.46616799]
curr_Stock_Price:  96.20611199353193
curr_Factors:  [96.20611199 -0.48084489 -1.06593518]
mat_Sqrt:  [[20.48540789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188153  0.01467861  0.54861933]
Stock Position:  -0.0018815307723053084
Bond Position:  [2.64718275]


portfolio before change:  [2.46638313]
curr_Stock_Price:  96.79541317519468
curr_Factors:  [96.79541318 -0.15258099 -1.07575009]
mat_Sqrt:  [[28.33983828  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00276084 0.0084847  0.30948334]
Stock Position:  0.0027608352473858216
Bond Position:  [2.19914694]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.46268304]
Stock Price:  95.05683272758384
PL:  [2.46268304]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-1.10249253e-04  6.50390844e-02  4.78046874e-02]
 [ 3.44084501e-01 -5.17745830e-01  4.80948068e-01]
 [ 8.16420071e-03 -6.56154391e-02  7.54686473e-02]
 [ 4.23173950e-01 -3.58079769e-01 -3.93987871e-01]
 [-5.72649565e-02  8.85054910e-02  1.35597673e-01]
 [-1.15582473e-03  7.73594859e-02 -1.13977108e-01]
 [-1.22769688e-01 -8.78718883e-02  1.86924476e-01]
 [-6.81167422e-02  2.96044364e-02  2.12031355e-01]
 [ 2.31465407e-01  1.65799679e-01  1.43859869e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.0052876]
curr_Stock_Price:  99.73621367698364
curr_Factors:  [99.73621368 -1.38904645 -0.95641989]
mat_Sqrt:  [[ 9.55498014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00239916 0.02099127 0.13637347]
Stock Position:  0.0023991561317182417
Bond Position:  [-0.24457035]


portfolio before change:  [-0.00506719]
curr_Stock_Price:  99.87906527026958
curr_Factors:  [99.87906527 -1.06199161 -0.92967213]
mat_Sqrt:  [[13.63031514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02469299 -0.16710175  1.37201097]
Stock Position:  0.024692986574661447
Bond Position:  [-2.47137961]


portfolio before change:  [-0.01709067]
curr_Stock_Price:  99.44220141355855
curr_Factors:  [99.44220141 -1.65231619 -0.89042629]
mat_Sqrt:  [[ 7.82116954  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00130102 -0.02117729  0.21529104]
Stock Position:  0.001301017496987565
Bond Position:  [-0.14646671]


portfolio before change:  [-0.01820078]
curr_Stock_Price:  98.64523779320679
curr_Factors:  [98.64523779 -1.16221304 -0.93927695]
mat_Sqrt:  [[12.06175815  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02235651 -0.11556975 -1.12393773]
Stock Position:  0.022356507404242543
Bond Position:  [-2.22356377]


portfolio before change:  [-0.03321425]
curr_Stock_Price:  98.02343184451851
curr_Factors:  [98.02343184 -0.91713681 -0.95318769]
mat_Sqrt:  [[15.10282862  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00076278  0.02856502  0.38682242]
Stock Position:  -0.0007627769649869039
Bond Position:  [0.04155577]


portfolio before change:  [-0.0320133]
curr_Stock_Price:  96.47622818320205
curr_Factors:  [96.47622818 -1.16048247 -0.94599849]
mat_Sqrt:  [[11.73781502  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00073526  0.02496767 -0.32514496]
Stock Position:  -0.0007352616754948276
Bond Position:  [0.03892198]


portfolio before change:  [-0.03040814]
curr_Stock_Price:  94.31959219573486
curr_Factors:  [94.3195922  -0.59049205 -0.97804602]
mat_Sqrt:  [[19.65144488  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00521848 -0.02836053  0.5332435 ]
Stock Position:  -0.00521847953961526
Bond Position:  [0.46179672]


portfolio before change:  [-0.0310375]
curr_Stock_Price:  94.484451254534
curr_Factors:  [94.48445125 -0.46796771 -0.9737469 ]
mat_Sqrt:  [[22.3476391   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084094  0.00955479  0.60486644]
Stock Position:  -0.0008409408615813701
Bond Position:  [0.04841834]


portfolio before change:  [-0.02544611]
curr_Stock_Price:  87.86428011729937
curr_Factors:  [87.86428012 -0.82089687 -0.93542271]
mat_Sqrt:  [[15.17233605  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01942182 0.05351162 0.41039216]
Stock Position:  0.019421821165481353
Bond Position:  [-1.73193044]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.00742072]
Stock Price:  89.60114158889449
PL:  [0.00742072]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 6.80253408e-02  1.35354763e-01  5.03828581e-02]
 [ 5.15853219e-01 -6.12407813e-01  6.69684199e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.81455173e-01 -4.22149495e-01 -3.92233225e-01]
 [-5.77454122e-02  8.82894984e-02  1.34998498e-01]
 [-2.36800135e-02  7.51708104e-02 -1.07314288e-01]
 [-5.32172689e-02 -2.09173214e-01  1.61296500e-01]
 [-1.10497400e-01  4.73756161e-02  1.28012324e-01]
 [-6.65249032e-02 -5.50661525e-02  7.87219179e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.96235359]
curr_Stock_Price:  98.98511178812721
curr_Factors:  [98.98511179 -1.05457468 -1.02078979]
mat_Sqrt:  [[12.42368804  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00852717 0.04368556 0.14372827]
Stock Position:  0.00852716789928073
Bond Position:  [-6.80641625]


portfolio before change:  [-5.93850774]
curr_Stock_Price:  102.18076916532539
curr_Factors:  [102.18076917  -0.96730949  -1.02471898]
mat_Sqrt:  [[13.93933951  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03784575 -0.19765377  1.91042262]
Stock Position:  0.03784574667644401
Bond Position:  [-9.80561524]


portfolio before change:  [-5.9784575]
curr_Stock_Price:  101.25475410255525
curr_Factors:  [101.2547541   -0.86847197  -1.03084934]
mat_Sqrt:  [[15.15481562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00232323 -0.02755111  0.34758667]
Stock Position:  0.0023232269317166134
Bond Position:  [-6.21369527]


portfolio before change:  [-5.98261924]
curr_Stock_Price:  100.80102449723658
curr_Factors:  [100.8010245   -0.8754966   -1.07004596]
mat_Sqrt:  [[14.40544063  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02188201 -0.13624816 -1.11893222]
Stock Position:  0.021882010011327155
Bond Position:  [-8.18834827]


portfolio before change:  [-6.04758778]
curr_Stock_Price:  98.01913464742411
curr_Factors:  [98.01913465 -0.61773033 -1.04271895]
mat_Sqrt:  [[18.6288868   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00065312  0.02849531  0.38511314]
Stock Position:  -0.0006531222695519178
Bond Position:  [-5.9835693]


portfolio before change:  [-6.04985304]
curr_Stock_Price:  96.90559772933537
curr_Factors:  [96.90559773 -0.88297259 -1.05207553]
mat_Sqrt:  [[13.99484662  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00216089  0.02426127 -0.30613779]
Stock Position:  -0.002160886371336477
Bond Position:  [-5.84045105]


portfolio before change:  [-6.05621172]
curr_Stock_Price:  98.49648349752056
curr_Factors:  [98.4964835  -1.09908162 -1.04715481]
mat_Sqrt:  [[11.51654184  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00546953 -0.06751036  0.46013402]
Stock Position:  -0.00546952922870039
Bond Position:  [-5.51748232]


portfolio before change:  [-6.06704833]
curr_Stock_Price:  99.97324354371868
curr_Factors:  [99.97324354 -1.08071179 -1.1060361 ]
mat_Sqrt:  [[11.22512635  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0066544   0.01529041  0.36518353]
Stock Position:  -0.006654400545073416
Bond Position:  [-5.40178633]


portfolio before change:  [-6.06747115]
curr_Stock_Price:  99.63080025228916
curr_Factors:  [99.63080025 -1.15572804 -1.04626528]
mat_Sqrt:  [[11.01742419  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00559987 -0.01777252  0.22457172]
Stock Position:  -0.00559987427684573
Bond Position:  [-5.50955119]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.07317779]
Stock Price:  100.15780811905137
PL:  [-6.23098591]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 4.54973254e-02  1.14120562e-01  5.16425647e-02]
 [ 1.51344552e-01  3.97410753e-02  1.32352036e-01]
 [-1.19198920e-01 -2.32193621e-02 -1.58616808e-03]
 [ 4.56257088e-01 -3.91911077e-01 -4.04354307e-01]
 [-1.22545031e-01  1.26200714e-01 -1.01659681e-01]
 [-3.82601938e-02  4.22408430e-02  3.28202060e-02]
 [-4.25665045e-02 -2.89331602e-01  1.63963249e-01]
 [-1.13769174e-01  6.58996757e-02  1.60246069e-01]
 [-7.25663793e-03 -4.16789478e-02  2.38331197e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.20351862]
curr_Stock_Price:  98.82861840606975
curr_Factors:  [98.82861841 -1.22099157 -0.99402519]
mat_Sqrt:  [[10.78731019  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00735434 0.03683225 0.14732186]
Stock Position:  0.007354343260137903
Bond Position:  [-7.93033821]


portfolio before change:  [-7.21507216]
curr_Stock_Price:  97.79693161615398
curr_Factors:  [97.79693162 -1.03272903 -0.98139774]
mat_Sqrt:  [[13.0497168   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01428942 0.01282638 0.37756352]
Stock Position:  0.014289422068004263
Bond Position:  [-8.61253379]


portfolio before change:  [-7.20674958]
curr_Stock_Price:  98.68079674515835
curr_Factors:  [98.68079675 -1.06299677 -1.02007089]
mat_Sqrt:  [[12.29045205  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01011048 -0.00749402 -0.0045249 ]
Stock Position:  -0.010110476601493824
Bond Position:  [-6.2090397]


portfolio before change:  [-7.22071636]
curr_Stock_Price:  99.7550769664045
curr_Factors:  [99.75507697 -1.65505635 -1.03269443]
mat_Sqrt:  [[ 6.78671602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04327868 -0.12648876 -1.15351029]
Stock Position:  0.04327867790028388
Bond Position:  [-11.53798421]


portfolio before change:  [-7.20133141]
curr_Stock_Price:  100.33631894973111
curr_Factors:  [100.33631895  -1.69628482  -1.00633144]
mat_Sqrt:  [[ 6.72553496  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01747602  0.04073111 -0.29000677]
Stock Position:  -0.017476024475945543
Bond Position:  [-5.44785145]


portfolio before change:  [-7.19231096]
curr_Stock_Price:  99.6642519738348
curr_Factors:  [99.66425197 -1.54696283 -0.92596856]
mat_Sqrt:  [[ 8.40541101  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00272901  0.01363317  0.09362691]
Stock Position:  -0.0027290065094730375
Bond Position:  [-6.92032657]


portfolio before change:  [-7.20031613]
curr_Stock_Price:  101.32937833655767
curr_Factors:  [101.32937834  -1.2906122   -0.9351408 ]
mat_Sqrt:  [[10.94216178  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00622886 -0.09338137  0.46774151]
Stock Position:  -0.006228861698618387
Bond Position:  [-6.56914945]


portfolio before change:  [-7.20367085]
curr_Stock_Price:  101.34050791798249
curr_Factors:  [101.34050792  -1.05678898  -0.9779781 ]
mat_Sqrt:  [[13.24631146  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00510386  0.02126903  0.45713743]
Stock Position:  -0.0051038635978518645
Bond Position:  [-6.68644272]


portfolio before change:  [-7.21565892]
curr_Stock_Price:  103.03412940860741
curr_Factors:  [103.03412941  -1.08705947  -0.92634053]
mat_Sqrt:  [[13.7585477   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079219 -0.01345182  0.06798926]
Stock Position:  -0.0007921913396197982
Bond Position:  [-7.13403618]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.22020321]
Stock Price:  104.26663788567755
PL:  [-11.4868411]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-5.34340622e-02  5.29785460e-02  4.98436561e-02]
 [ 4.30910005e-01 -5.14041041e-01  5.42184465e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.57518702e-01 -3.94718900e-01 -4.02315955e-01]
 [-1.16821957e-01  7.95938111e-02 -8.37759682e-02]
 [-9.18227504e-02  2.78624780e-02  5.15540331e-02]
 [-1.10104224e-01 -1.98138178e-01  1.71779329e-01]
 [-1.14916017e-01  5.52000588e-02  1.32733075e-01]
 [-3.59303943e-02 -4.48033984e-02  6.41172171e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.4387148]
curr_Stock_Price:  100.9269690017909
curr_Factors:  [100.926969    -1.32787926  -1.025541  ]
mat_Sqrt:  [[ 9.59245558  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0033824   0.01709875  0.14219008]
Stock Position:  -0.0033824048339566545
Bond Position:  [9.78009067]


portfolio before change:  [9.44268279]
curr_Stock_Price:  101.19993413065006
curr_Factors:  [101.19993413  -1.40020247  -1.05904739]
mat_Sqrt:  [[ 8.65249955  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05046574 -0.16590603  1.54670136]
Stock Position:  0.050465735996935684
Bond Position:  [4.33555363]


portfolio before change:  [9.39135253]
curr_Stock_Price:  100.13983715512484
curr_Factors:  [100.13983716  -0.99214566  -1.0174167 ]
mat_Sqrt:  [[13.42347734  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00262287 -0.02755111  0.34758667]
Stock Position:  0.002622872963435174
Bond Position:  [9.12869846]


portfolio before change:  [9.39533802]
curr_Stock_Price:  99.91870576265008
curr_Factors:  [99.91870576 -1.11935672 -1.08628902]
mat_Sqrt:  [[11.0089786   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02678038 -0.12739498 -1.14769544]
Stock Position:  0.026780381233612812
Bond Position:  [6.71947699]


portfolio before change:  [9.44538852]
curr_Stock_Price:  101.66214317231994
curr_Factors:  [101.66214317  -0.75729566  -1.05694498]
mat_Sqrt:  [[16.56702633  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.007103    0.02568879 -0.23898952]
Stock Position:  -0.007103002929502484
Bond Position:  [10.16749502]


portfolio before change:  [9.44955041]
curr_Stock_Price:  101.79210708218187
curr_Factors:  [101.79210708  -1.27465302  -1.11690203]
mat_Sqrt:  [[ 9.3126857   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00811924  0.00899258  0.14706931]
Stock Position:  -0.00811923922170505
Bond Position:  [10.27602487]


portfolio before change:  [9.45699425]
curr_Stock_Price:  101.5082696290835
curr_Factors:  [101.50826963  -1.03758065  -1.09387912]
mat_Sqrt:  [[12.04537176  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00958748 -0.06394882  0.49003861]
Stock Position:  -0.009587475101118794
Bond Position:  [10.43020225]


portfolio before change:  [9.45419573]
curr_Stock_Price:  102.34424771381038
curr_Factors:  [102.34424771  -1.29145815  -1.12909918]
mat_Sqrt:  [[ 9.09554535  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00841668  0.01781574  0.37865052]
Stock Position:  -0.008416683520565777
Bond Position:  [10.31559488]


portfolio before change:  [9.47530357]
curr_Stock_Price:  100.44935041305477
curr_Factors:  [100.44935041  -0.45366012  -1.08659696]
mat_Sqrt:  [[21.5289071   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00148582 -0.01446023  0.18290857]
Stock Position:  -0.0014858152085667072
Bond Position:  [9.62455274]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.47784089]
Stock Price:  101.9812806644311
PL:  [7.49656022]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-3.23837759e-02  4.10202160e-02  4.76418837e-02]
 [ 2.75365207e-01 -3.26013287e-01  3.67665238e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.53405358e-01 -4.94305788e-01 -3.58498036e-01]
 [-1.44968896e-01  1.27814579e-01 -1.56809899e-01]
 [-9.45816955e-02  3.44364202e-02  5.58535385e-02]
 [ 6.70553612e-03 -4.11232773e-01  2.65471844e-01]
 [-1.18401085e-01  2.45472540e-02  5.33280039e-02]
 [-1.87699496e-02 -4.50599846e-02  2.67995004e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.62376711]
curr_Stock_Price:  100.57204385400547
curr_Factors:  [100.57204385  -0.9767791   -1.00318099]
mat_Sqrt:  [[13.88645955  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102875  0.01323922  0.13590903]
Stock Position:  -0.001028750380268632
Bond Position:  [6.72723064]


portfolio before change:  [6.62867968]
curr_Stock_Price:  99.06719573301373
curr_Factors:  [99.06719573 -0.92945103 -0.99685388]
mat_Sqrt:  [[14.4326566   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01966841 -0.10522034  1.04884659]
Stock Position:  0.01966840785336283
Bond Position:  [4.68018567]


portfolio before change:  [6.65390658]
curr_Stock_Price:  100.23079866097389
curr_Factors:  [100.23079866  -1.04479585  -0.99397717]
mat_Sqrt:  [[13.04888249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00269817 -0.02755111  0.34758667]
Stock Position:  0.0026981678957855187
Bond Position:  [6.38346705]


portfolio before change:  [6.66165972]
curr_Stock_Price:  101.92106044487295
curr_Factors:  [101.92106044  -1.84238248  -1.01413431]
mat_Sqrt:  [[ 5.85725934  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06476194 -0.15953651 -1.02269511]
Stock Position:  0.06476194488570744
Bond Position:  [0.06105362]


portfolio before change:  [6.64300224]
curr_Stock_Price:  101.63249578604827
curr_Factors:  [101.63249579  -1.43578118  -1.03377279]
mat_Sqrt:  [[ 8.60040544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01754424  0.04125198 -0.44733499]
Stock Position:  -0.017544235786732573
Bond Position:  [8.42606671]


portfolio before change:  [6.64484764]
curr_Stock_Price:  101.76750804911586
curr_Factors:  [101.76750805  -1.84060657  -1.05265282]
mat_Sqrt:  [[ 5.63744806  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01350812  0.01111431  0.1593346 ]
Stock Position:  -0.013508121787308671
Bond Position:  [8.01953554]


portfolio before change:  [6.6458244]
curr_Stock_Price:  101.9921150459221
curr_Factors:  [101.99211505  -2.07729743  -1.05571979]
mat_Sqrt:  [[ 4.44543748  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00518459 -0.13272481  0.75731728]
Stock Position:  -0.005184594066824088
Bond Position:  [7.17461211]


portfolio before change:  [6.64668337]
curr_Stock_Price:  102.51852611940664
curr_Factors:  [102.51852612  -2.03434944  -1.04424249]
mat_Sqrt:  [[ 4.71831429  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02172489  0.00792259  0.15212995]
Stock Position:  -0.021724891242549692
Bond Position:  [8.8738872]


portfolio before change:  [6.6536929]
curr_Stock_Price:  102.40016056303821
curr_Factors:  [102.40016056  -1.29074745  -1.02791879]
mat_Sqrt:  [[10.0766618   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00223262 -0.01454305  0.07645151]
Stock Position:  -0.002232619862579468
Bond Position:  [6.88231353]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.66023136]
Stock Price:  101.01325233320513
PL:  [5.64697903]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.27639703e-02  9.39820214e-02  4.85956081e-02]
 [ 2.90885298e-01 -3.71784218e-01  3.97112609e-01]
 [-2.57012657e-01  3.86928560e-02 -2.43644402e-01]
 [ 3.82557054e-01 -3.28926327e-01 -3.30426911e-01]
 [-7.28544732e-02  5.79855155e-02  4.46010157e-02]
 [-9.34678643e-02  3.17824123e-02  5.41177579e-02]
 [-2.15774682e-01  1.03250527e-01  1.83147324e-01]
 [-1.16647749e-01  1.13176697e-01  2.60878658e-01]
 [ 4.76061232e-02  2.26039332e-02  1.09694276e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.19558616]
curr_Stock_Price:  99.58613383978386
curr_Factors:  [99.58613384 -0.97532773 -0.9895715 ]
mat_Sqrt:  [[13.95898952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00443209 0.03033257 0.13862974]
Stock Position:  0.0044320906593887
Bond Position:  [-1.63696093]


portfolio before change:  [-1.19788832]
curr_Stock_Price:  99.2514210253901
curr_Factors:  [99.25142103 -0.98081594 -0.98448141]
mat_Sqrt:  [[13.90653515  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02128894 -0.11999284  1.13285174]
Stock Position:  0.021288943027545703
Bond Position:  [-3.31084617]


portfolio before change:  [-1.23927457]
curr_Stock_Price:  97.38517455640809
curr_Factors:  [97.38517456 -0.81584622 -0.99373646]
mat_Sqrt:  [[15.94413917  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01874345  0.01248807 -0.69504966]
Stock Position:  -0.01874345254947809
Bond Position:  [0.58605983]


portfolio before change:  [-1.24578841]
curr_Stock_Price:  97.74833851858148
curr_Factors:  [97.74833852 -0.64311622 -0.96434771]
mat_Sqrt:  [[19.58829642  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01265894 -0.10616052 -0.942616  ]
Stock Position:  0.012658943521139889
Bond Position:  [-2.48317911]


portfolio before change:  [-1.22114552]
curr_Stock_Price:  99.79312160691863
curr_Factors:  [99.79312161 -0.59730273 -0.94913095]
mat_Sqrt:  [[21.25656046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00244226  0.01871474  0.12723428]
Stock Position:  -0.002442261779286305
Bond Position:  [-0.97742459]


portfolio before change:  [-1.22515305]
curr_Stock_Price:  101.23387352308151
curr_Factors:  [101.23387352  -0.60033348  -0.97249569]
mat_Sqrt:  [[21.00171797  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361559  0.01025773  0.1543829 ]
Stock Position:  -0.0036155882863226373
Bond Position:  [-0.85913304]


portfolio before change:  [-1.22767948]
curr_Stock_Price:  101.81379403676698
curr_Factors:  [101.81379404  -0.69648395  -0.98431977]
mat_Sqrt:  [[18.96019669  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00829706  0.03332396  0.52246834]
Stock Position:  -0.008297064012280236
Bond Position:  [-0.38292391]


portfolio before change:  [-1.23758482]
curr_Stock_Price:  102.98455019654118
curr_Factors:  [102.9845502   -0.41533373  -0.94602579]
mat_Sqrt:  [[26.39618417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00152651  0.03652762  0.7442142 ]
Stock Position:  -0.001526509246799043
Bond Position:  [-1.08037796]


portfolio before change:  [-1.23038145]
curr_Stock_Price:  97.91173225260714
curr_Factors:  [97.91173225  0.234593   -0.91875494]
mat_Sqrt:  [[49.39772859  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00151042 0.00729539 0.31292724]
Stock Position:  0.001510421314927389
Bond Position:  [-1.37826941]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.23584145]
Stock Price:  94.75321326566899
PL:  [-1.23584145]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 5.32909727e-02  1.12054290e-01  4.90894671e-02]
 [ 2.02403801e-01 -1.10839834e-01  2.29230377e-01]
 [-3.88391504e-01  4.28070389e-02 -3.46985498e-01]
 [ 3.23499629e-01 -2.81450728e-01 -2.55680604e-01]
 [ 1.22205508e-02  3.72791732e-02  1.52774175e-01]
 [ 3.17498581e-02  7.52923005e-02 -1.63355220e-01]
 [-7.88961774e-02 -1.23596589e-01  1.74843543e-01]
 [-6.43133487e-02  1.69134909e-02  1.94522703e-01]
 [ 1.03129432e-02 -3.17338924e-03  9.80959462e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.38989332]
curr_Stock_Price:  99.30946269706034
curr_Factors:  [99.3094627  -0.89671872 -0.97839157]
mat_Sqrt:  [[15.2279197   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00565962 0.03616537 0.14003859]
Stock Position:  0.00565962430695997
Bond Position:  [-3.95194757]


portfolio before change:  [-3.39878531]
curr_Stock_Price:  98.08755697129308
curr_Factors:  [98.08755697 -0.33206212 -0.96805003]
mat_Sqrt:  [[26.72897996  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00847657 -0.0357734   0.65393046]
Stock Position:  0.008476573734598862
Bond Position:  [-4.23023172]


portfolio before change:  [-3.41706606]
curr_Stock_Price:  96.18052411270524
curr_Factors:  [96.18052411 -0.65961481 -0.97911365]
mat_Sqrt:  [[18.68084043  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02411464  0.01381591 -0.98985304]
Stock Position:  -0.024114636260892264
Bond Position:  [-1.09770771]


portfolio before change:  [-3.41914268]
curr_Stock_Price:  96.24387275644756
curr_Factors:  [96.24387276 -0.5924235  -0.93422696]
mat_Sqrt:  [[20.91015329  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01022748 -0.09083783 -0.72938559]
Stock Position:  0.010227479070971502
Bond Position:  [-4.40347488]


portfolio before change:  [-3.41714701]
curr_Stock_Price:  96.65433120496537
curr_Factors:  [96.6543312  -0.45632326 -0.98388001]
mat_Sqrt:  [[22.89543962  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00222817 0.0120318  0.4358222 ]
Stock Position:  0.002228174206487852
Bond Position:  [-3.6325097]


portfolio before change:  [-3.42307103]
curr_Stock_Price:  94.81097850179714
curr_Factors:  [94.8109785  -0.50424979 -0.99724473]
mat_Sqrt:  [[21.12359547  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00065207  0.02430049 -0.46600697]
Stock Position:  0.0006520712759993241
Bond Position:  [-3.48489455]


portfolio before change:  [-3.42510063]
curr_Stock_Price:  94.37127811721832
curr_Factors:  [94.37127812 -0.77722976 -0.9942039 ]
mat_Sqrt:  [[16.0515129   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00426349 -0.03989063  0.49877996]
Stock Position:  -0.004263488262965869
Bond Position:  [-3.0227498]


portfolio before change:  [-3.42705453]
curr_Stock_Price:  94.47498289853253
curr_Factors:  [94.4749829  -0.66034301 -0.97967988]
mat_Sqrt:  [[18.3258418   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00115433  0.00545881  0.55491913]
Stock Position:  -0.0011543325836628833
Bond Position:  [-3.31799898]


portfolio before change:  [-3.43173314]
curr_Stock_Price:  97.09051679475775
curr_Factors:  [97.09051679 -0.80442305 -1.00943216]
mat_Sqrt:  [[15.82812622  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00187571 -0.00102421  0.27984043]
Stock Position:  0.0018757071146623973
Bond Position:  [-3.61384651]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.42877008]
Stock Price:  99.63378952105845
PL:  [-3.42877008]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 6.66597047e-02  1.31428172e-01  5.01023479e-02]
 [ 1.87869851e-01 -6.79771703e-02  2.01654081e-01]
 [-2.67042510e-01  4.31271286e-02 -2.77963671e-01]
 [ 4.26056723e-01 -3.63589129e-01 -3.88958748e-01]
 [-5.93090919e-02  8.75865341e-02  1.33048437e-01]
 [-1.16010842e-02  7.88608503e-02 -1.48116581e-01]
 [-3.00971490e-01  1.48673368e-01  2.39352701e-01]
 [-9.76126086e-02  8.93395473e-02  2.60484214e-01]
 [-3.24282262e-02 -4.70934722e-02  3.20406078e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.66472152]
curr_Stock_Price:  99.14872486527038
curr_Factors:  [99.14872487 -0.76615555 -0.99124942]
mat_Sqrt:  [[17.10235246  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00606434 0.04241826 0.14292805]
Stock Position:  0.006064339223918725
Bond Position:  [-5.26599302]


portfolio before change:  [-4.6738466]
curr_Stock_Price:  98.0782986798947
curr_Factors:  [98.07829868 -0.75062075 -1.00297453]
mat_Sqrt:  [[16.98228682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01266947 -0.02193954  0.57526296]
Stock Position:  0.01266946780904999
Bond Position:  [-5.91644645]


portfolio before change:  [-4.68857621]
curr_Stock_Price:  97.14924283443523
curr_Factors:  [97.14924283 -0.69202135 -1.01509108]
mat_Sqrt:  [[17.62178563  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01787437  0.01391922 -0.79295298]
Stock Position:  -0.01787437010040191
Bond Position:  [-2.95209469]


portfolio before change:  [-4.72245302]
curr_Stock_Price:  98.96191623085555
curr_Factors:  [98.96191623 -0.80807656 -1.03506028]
mat_Sqrt:  [[15.66765264  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01738892 -0.11734789 -1.10959104]
Stock Position:  0.017388918231778662
Bond Position:  [-6.44329369]


portfolio before change:  [-4.74156643]
curr_Stock_Price:  98.048060673391
curr_Factors:  [98.04806067 -0.45779374 -1.01127109]
mat_Sqrt:  [[22.56484     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0006325   0.02826843  0.37955016]
Stock Position:  -0.0006324958199750645
Bond Position:  [-4.67955144]


portfolio before change:  [-4.74255643]
curr_Stock_Price:  95.91308100247254
curr_Factors:  [95.913081   -0.27907629 -1.01457436]
mat_Sqrt:  [[26.30585969  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00097841  0.02545223 -0.42253538]
Stock Position:  -0.000978407525472817
Bond Position:  [-4.64871435]


portfolio before change:  [-4.74433548]
curr_Stock_Price:  95.35515266135411
curr_Factors:  [95.35515266  0.14148423 -1.02382655]
mat_Sqrt:  [[39.4591536   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00562014  0.04798412  0.68280663]
Stock Position:  -0.005620140824946948
Bond Position:  [-4.2084261]


portfolio before change:  [-4.74991375]
curr_Stock_Price:  95.97320248006304
curr_Factors:  [95.97320248  0.2154475  -1.01427956]
mat_Sqrt:  [[43.17393481  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.06966503e-04  2.88342149e-02  7.43088959e-01]
Stock Position:  -0.0006069665031012558
Bond Position:  [-4.69166123]


portfolio before change:  [-4.75566703]
curr_Stock_Price:  101.58613752797677
curr_Factors:  [101.58613753  -0.40078576  -1.02643598]
mat_Sqrt:  [[24.37810392  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00145626 -0.01519935  0.09140294]
Stock Position:  -0.0014562608862879994
Bond Position:  [-4.60773111]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.76003173]
Stock Price:  103.00089983338616
PL:  [-7.76093157]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-4.93651009e-02  5.06670344e-02  4.94180597e-02]
 [ 4.12023934e-01 -6.09226024e-01  5.72604845e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.95413794e-01 -4.42628616e-01 -3.54395794e-01]
 [-1.31579921e-01  1.08857330e-01 -9.79152279e-02]
 [-6.75314069e-02  4.82047331e-02  8.09705604e-03]
 [-1.26987390e-01 -8.12241446e-02  1.71194519e-01]
 [-1.05690202e-01  5.47248971e-02  1.58683607e-01]
 [ 8.33839911e-03 -6.00670780e-03  9.95797012e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.7018403]
curr_Stock_Price:  100.96014541149417
curr_Factors:  [100.96014541  -1.14115788  -1.03353208]
mat_Sqrt:  [[11.4734525   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00252194  0.01635272  0.14097597]
Stock Position:  -0.002521936325469846
Bond Position:  [9.95645536]


portfolio before change:  [9.70771554]
curr_Stock_Price:  100.6049557914637
curr_Factors:  [100.60495579  -0.71946998  -1.09847457]
mat_Sqrt:  [[16.33413303  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02476707 -0.19662685  1.63348224]
Stock Position:  0.02476707313851241
Bond Position:  [7.21602524]


portfolio before change:  [9.72439117]
curr_Stock_Price:  101.13253979512653
curr_Factors:  [101.1325398   -0.75478881  -1.08587458]
mat_Sqrt:  [[16.05095812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00219352 -0.02755111  0.34758667]
Stock Position:  0.0021935186379567688
Bond Position:  [9.50255505]


portfolio before change:  [9.73136718]
curr_Stock_Price:  102.14622998333198
curr_Factors:  [102.14622998  -0.32052076  -1.11480798]
mat_Sqrt:  [[24.31459212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01368404 -0.14285777 -1.01099256]
Stock Position:  0.01368404069233124
Bond Position:  [8.33359401]


portfolio before change:  [9.7289023]
curr_Stock_Price:  101.66152500581707
curr_Factors:  [101.66152501  -0.90024834  -1.05908169]
mat_Sqrt:  [[14.32947894  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00902659  0.03513355 -0.27932489]
Stock Position:  -0.009026592940975041
Bond Position:  [10.6465595]


portfolio before change:  [9.75550042]
curr_Stock_Price:  99.3047644391664
curr_Factors:  [99.30476444 -0.46604977 -1.05337787]
mat_Sqrt:  [[21.73156714  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257868  0.01555801  0.02309865]
Stock Position:  -0.002578684359102758
Bond Position:  [10.01157607]


portfolio before change:  [9.75835212]
curr_Stock_Price:  100.14059432283673
curr_Factors:  [100.14059432  -0.9180915   -1.03722766]
mat_Sqrt:  [[14.17182713  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00766466 -0.02621498  0.48837031]
Stock Position:  -0.00766466199426847
Bond Position:  [10.52589593]


portfolio before change:  [9.77438774]
curr_Stock_Price:  98.73526735138951
curr_Factors:  [98.73526735 -0.81444087 -1.01158782]
mat_Sqrt:  [[15.90150107  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00390708  0.01766238  0.45268016]
Stock Position:  -0.003907076020199975
Bond Position:  [10.16015394]


portfolio before change:  [9.78083113]
curr_Stock_Price:  98.3866600078514
curr_Factors:  [98.38666001 -0.25575427 -1.01620258]
mat_Sqrt:  [[27.57607021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099503 -0.00193866  0.28407317]
Stock Position:  0.0009950259840352776
Bond Position:  [9.68293384]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.78826651]
Stock Price:  100.99232928057756
PL:  [8.79593723]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-9.28654946e-02  7.53789103e-02  5.39680199e-02]
 [ 3.71209448e-01 -7.23822166e-01  5.92605218e-01]
 [ 1.05985551e-02 -7.47955303e-02  1.00672894e-01]
 [ 5.58407801e-01 -5.11414611e-01 -2.30442730e-01]
 [-1.36891539e-01  9.01894419e-02 -4.82176658e-02]
 [-5.45218136e-02 -6.36280305e-02 -4.00844662e-02]
 [-2.53156704e-01  2.66859467e-02  2.39031129e-01]
 [-1.16782694e-01  6.47118590e-02  1.48737785e-01]
 [-3.10383465e-03 -4.23028264e-02  1.73956707e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.47849048]
curr_Stock_Price:  102.06675704641471
curr_Factors:  [102.06675705  -1.15653889  -1.04604817]
mat_Sqrt:  [[11.28009893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00589203  0.02432844  0.15395574]
Stock Position:  -0.005892028378456705
Bond Position:  [19.07987071]


portfolio before change:  [18.47407458]
curr_Stock_Price:  104.43575901000145
curr_Factors:  [104.43575901  -0.71090399  -1.05057267]
mat_Sqrt:  [[17.94112359  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01919751 -0.2336126   1.69053774]
Stock Position:  0.019197510058755494
Bond Position:  [16.46916804]


portfolio before change:  [18.46502462]
curr_Stock_Price:  103.53529835860222
curr_Factors:  [103.53529836  -1.12720156  -1.05270726]
mat_Sqrt:  [[11.70485587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00135677 -0.02414015  0.28719174]
Stock Position:  0.0013567659449142345
Bond Position:  [18.32455145]


portfolio before change:  [18.47601611]
curr_Stock_Price:  104.8818322792121
curr_Factors:  [104.88183228  -0.91591938  -1.05324799]
mat_Sqrt:  [[14.63867417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02780148 -0.16505836 -0.65738897]
Stock Position:  0.027801479902685874
Bond Position:  [15.56014596]


portfolio before change:  [18.48187919]
curr_Stock_Price:  104.812809350426
curr_Factors:  [104.81280935  -1.05081862  -0.99754786]
mat_Sqrt:  [[13.51512602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00949485  0.02910852 -0.13755158]
Stock Position:  -0.009494849388081037
Bond Position:  [19.47706103]


portfolio before change:  [18.49512548]
curr_Stock_Price:  104.44362764761738
curr_Factors:  [104.44362765  -0.64748039  -0.95966569]
mat_Sqrt:  [[20.93665402  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361529 -0.02053586 -0.11434982]
Stock Position:  -0.0036152882068023256
Bond Position:  [18.8727193]


portfolio before change:  [18.50599935]
curr_Stock_Price:  104.04666254850251
curr_Factors:  [104.04666255  -0.74751811  -0.96802519]
mat_Sqrt:  [[18.71445419  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01062908  0.00861285  0.68188928]
Stock Position:  -0.010629080115580178
Bond Position:  [19.61191966]


portfolio before change:  [18.49744227]
curr_Stock_Price:  105.77451555622595
curr_Factors:  [105.77451556  -1.42883843  -0.96972294]
mat_Sqrt:  [[ 9.60946213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00761879  0.02088566  0.4243075 ]
Stock Position:  -0.007618789414160134
Bond Position:  [19.30331603]


portfolio before change:  [18.50562974]
curr_Stock_Price:  105.96701339779774
curr_Factors:  [105.9670134   -1.23689936  -0.94651944]
mat_Sqrt:  [[11.93779064  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00068589 -0.01365318  0.04962501]
Stock Position:  -0.0006858879297065652
Bond Position:  [18.57831124]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.51485076]
Stock Price:  106.06973386784632
PL:  [12.4451169]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-3.72347363e-02  4.37759688e-02  4.81492740e-02]
 [ 4.97753681e-01 -5.23047741e-01  6.08176098e-01]
 [ 1.08732930e-01 -1.19042444e-01  1.27269802e-01]
 [ 5.76181517e-01 -5.22805460e-01 -2.98755795e-01]
 [-1.47568040e-01  1.11491635e-01 -1.24823179e-01]
 [-6.12847521e-02 -4.74836686e-02 -2.91625949e-02]
 [-1.05695271e-01 -4.47236397e-01  2.51649682e-01]
 [-1.16519815e-01  5.10988019e-02  1.18777057e-01]
 [ 2.02668087e-05 -4.02289563e-02  1.99579774e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.82230143]
curr_Stock_Price:  100.59707622814489
curr_Factors:  [100.59707623  -1.25929221  -1.04034308]
mat_Sqrt:  [[10.0894256   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00183069  0.01412863  0.13735648]
Stock Position:  -0.001830686446394643
Bond Position:  [7.00646314]


portfolio before change:  [6.82294985]
curr_Stock_Price:  102.15698031432747
curr_Factors:  [102.15698031  -1.50841706  -1.03710967]
mat_Sqrt:  [[ 8.0123486   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06429206 -0.16881293  1.73495712]
Stock Position:  0.06429206466993585
Bond Position:  [0.25506666]


portfolio before change:  [6.93525885]
curr_Stock_Price:  103.9018525093193
curr_Factors:  [103.90185251  -1.92940703  -1.05211088]
mat_Sqrt:  [[ 5.26946485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02095323 -0.03842078  0.36306532]
Stock Position:  0.020953234536443814
Bond Position:  [4.75817896]


portfolio before change:  [6.92910376]
curr_Stock_Price:  103.49452786189165
curr_Factors:  [103.49452786  -1.69942193  -1.05422836]
mat_Sqrt:  [[ 6.59207682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06196545 -0.16873474 -0.85226712]
Stock Position:  0.06196545324013631
Bond Position:  [0.51601844]


portfolio before change:  [6.9455835]
curr_Stock_Price:  103.75631338733398
curr_Factors:  [103.75631339  -1.67010334  -1.08756974]
mat_Sqrt:  [[ 6.582219    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02283262  0.03598377 -0.35608578]
Stock Position:  -0.02283262373014749
Bond Position:  [9.31461236]


portfolio before change:  [6.93603449]
curr_Stock_Price:  104.37855817198415
curr_Factors:  [104.37855817  -1.56853954  -1.11434091]
mat_Sqrt:  [[ 7.13593885  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01078066 -0.01532529 -0.08319277]
Stock Position:  -0.010780656452512383
Bond Position:  [8.06130386]


portfolio before change:  [6.93640736]
curr_Stock_Price:  104.71794281711891
curr_Factors:  [104.71794282  -1.3636412   -1.15084454]
mat_Sqrt:  [[ 8.47215356  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01718798 -0.14434493  0.7178865 ]
Stock Position:  -0.01718798425957015
Bond Position:  [8.73629771]


portfolio before change:  [6.947646]
curr_Stock_Price:  104.31827975460004
curr_Factors:  [104.31827975  -1.50749847  -1.19218074]
mat_Sqrt:  [[ 7.01301278  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01167031  0.01649207  0.33883788]
Stock Position:  -0.0116703124252526
Bond Position:  [8.16507292]


portfolio before change:  [6.95698478]
curr_Stock_Price:  103.86797305443575
curr_Factors:  [103.86797305  -1.1514512   -1.21719089]
mat_Sqrt:  [[ 9.72284732  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00042349 -0.01298384  0.05693455]
Stock Position:  -0.000423490085285612
Bond Position:  [7.00097183]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.95983651]
Stock Price:  105.40195651625086
PL:  [1.55787999]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-3.19026544e-02  4.07468986e-02  4.75915604e-02]
 [ 4.80209341e-01 -6.41155766e-01  6.51338970e-01]
 [ 2.19459158e-02 -8.17828616e-02  1.14670064e-01]
 [ 5.12828083e-01 -4.53644476e-01 -3.78332029e-01]
 [-1.50609806e-01  1.12572667e-01 -1.34308300e-01]
 [-6.68772201e-02 -3.27712424e-02 -2.64758987e-03]
 [-1.98908210e-01 -4.13217934e-01  3.44645619e-01]
 [-1.16967073e-01  7.42597637e-02  1.69751593e-01]
 [-2.26778801e-03 -4.32221382e-02  1.37886052e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.88015544]
curr_Stock_Price:  100.35219904779156
curr_Factors:  [100.35219905  -1.21701267  -0.97734587]
mat_Sqrt:  [[11.1822473   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00124042  0.013151    0.13576547]
Stock Position:  -0.0012404163088952883
Bond Position:  [5.00463395]


portfolio before change:  [4.8812251]
curr_Stock_Price:  101.507688218401
curr_Factors:  [101.50768822  -0.6756582   -1.0145814 ]
mat_Sqrt:  [[18.72566313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02575546 -0.20693213  1.85808878]
Stock Position:  0.025755455243834057
Bond Position:  [2.26684838]


portfolio before change:  [4.87640716]
curr_Stock_Price:  101.27660528294976
curr_Factors:  [101.27660528  -1.25377461  -0.94819532]
mat_Sqrt:  [[11.19968337  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00255891 -0.02639531  0.32712178]
Stock Position:  0.0025589105463575705
Bond Position:  [4.61724939]


portfolio before change:  [4.87881253]
curr_Stock_Price:  101.31418699159691
curr_Factors:  [101.31418699  -0.99663139  -0.96014384]
mat_Sqrt:  [[14.31705124  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02395756 -0.14641313 -1.07927597]
Stock Position:  0.023957558280385084
Bond Position:  [2.45157199]


portfolio before change:  [4.92509545]
curr_Stock_Price:  103.19488079308384
curr_Factors:  [103.19488079  -1.06314903  -0.99406493]
mat_Sqrt:  [[13.18929186  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01175549  0.03633267 -0.3831442 ]
Stock Position:  -0.011755488868157655
Bond Position:  [6.13820173]


portfolio before change:  [4.92269652]
curr_Stock_Price:  103.66009325548777
curr_Factors:  [103.66009326  -0.90281702  -1.00001952]
mat_Sqrt:  [[15.4603807   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00479335 -0.01057687 -0.00755284]
Stock Position:  -0.004793352791074485
Bond Position:  [5.41957592]


portfolio before change:  [4.91137878]
curr_Stock_Price:  106.5866892150793
curr_Factors:  [106.58668922  -1.26163098  -1.08660851]
mat_Sqrt:  [[10.18299477  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02090794 -0.13336551  0.98317802]
Stock Position:  -0.020907943123044028
Bond Position:  [7.13988722]


portfolio before change:  [4.90753855]
curr_Stock_Price:  106.94115116119481
curr_Factors:  [106.94115116  -1.22342584  -1.08179226]
mat_Sqrt:  [[10.66599447  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0062965   0.02396724  0.48425405]
Stock Position:  -0.00629650270053671
Bond Position:  [5.58089379]


portfolio before change:  [4.90237306]
curr_Stock_Price:  108.2048098268593
curr_Factors:  [108.20480983  -1.52412183  -1.06896466]
mat_Sqrt:  [[ 8.09251314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102266 -0.01394989  0.03933505]
Stock Position:  -0.0010226591688704894
Bond Position:  [5.0130297]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.90491198]
Stock Price:  108.17373627877737
PL:  [-3.2688243]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-2.70243435e-02  4.17200924e-02  4.73412972e-02]
 [ 5.00791949e-01 -5.73044723e-01  6.36071342e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.57993690e-01 -5.01799610e-01 -3.41651213e-01]
 [-1.51333987e-01  1.16966261e-01 -1.46181573e-01]
 [-9.45816955e-02  3.44364202e-02  5.58535385e-02]
 [-9.03222481e-02 -6.94302930e-02  1.64769344e-01]
 [-1.08223902e-01  3.69301245e-02  1.11091469e-01]
 [-4.57729413e-02 -5.25495126e-02  3.50386777e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.02900258]
curr_Stock_Price:  100.49705244629195
curr_Factors:  [100.49705245  -1.05104266  -1.03461501]
mat_Sqrt:  [[12.48428586  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00070847  0.0134651   0.13505154]
Stock Position:  -0.0007084717221969819
Bond Position:  [6.1002019]


portfolio before change:  [6.03096138]
curr_Stock_Price:  102.03848724160504
curr_Factors:  [102.03848724  -1.17955107  -0.96000021]
mat_Sqrt:  [[12.01071046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0427666  -0.18494939  1.81453449]
Stock Position:  0.04276659613732186
Bond Position:  [1.66712261]


portfolio before change:  [6.01815881]
curr_Stock_Price:  101.7196324428517
curr_Factors:  [101.71963244  -1.0655559   -1.03650416]
mat_Sqrt:  [[12.4305888   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00283237 -0.02755111  0.34758667]
Stock Position:  0.002832373942520279
Bond Position:  [5.73005078]


portfolio before change:  [6.02325734]
curr_Stock_Price:  102.50793914038002
curr_Factors:  [102.50793914  -1.33073497  -0.9778742 ]
mat_Sqrt:  [[10.18922791  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03786597 -0.16195513 -0.97463581]
Stock Position:  0.03786597133547828
Bond Position:  [2.14169465]


portfolio before change:  [6.02232145]
curr_Stock_Price:  102.4549363655823
curr_Factors:  [102.45493637  -1.06988529  -1.00344222]
mat_Sqrt:  [[12.88540843  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01220742  0.0377507  -0.41701534]
Stock Position:  -0.012207415769897801
Bond Position:  [7.27303146]


portfolio before change:  [6.04813789]
curr_Stock_Price:  100.6380887890456
curr_Factors:  [100.63808879  -0.57513593  -0.98861301]
mat_Sqrt:  [[21.06855957  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00361445  0.01111431  0.1593346 ]
Stock Position:  -0.0036144537866213255
Bond Position:  [6.41188961]


portfolio before change:  [6.05816342]
curr_Stock_Price:  98.75155683583935
curr_Factors:  [98.75155684 -0.99570877 -0.91851356]
mat_Sqrt:  [[14.56155511  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00486632 -0.02240853  0.47004108]
Stock Position:  -0.004866324040479317
Bond Position:  [6.53872049]


portfolio before change:  [6.05451453]
curr_Stock_Price:  100.17338315451866
curr_Factors:  [100.17338315  -1.38103577  -0.94323119]
mat_Sqrt:  [[ 9.80248141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0079581   0.01191915  0.31691304]
Stock Position:  -0.00795809935432132
Bond Position:  [6.85170426]


portfolio before change:  [6.05041579]
curr_Stock_Price:  101.11901709565248
curr_Factors:  [101.1190171   -1.41205524  -1.00804764]
mat_Sqrt:  [[ 8.99074149  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00548868 -0.01696028  0.09995559]
Stock Position:  -0.005488682502325329
Bond Position:  [6.60542597]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.04395243]
Stock Price:  102.89847756986535
PL:  [3.14547486]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-4.66912151e-02  4.91480427e-02  4.91383824e-02]
 [ 3.10363618e-01 -4.29228522e-01  4.34070209e-01]
 [-2.29422628e-01  2.66626970e-02 -1.50314368e-01]
 [ 4.43034551e-01 -3.74726924e-01 -4.10847285e-01]
 [-8.71730884e-02  1.11246475e-01  1.41803686e-02]
 [-1.03299073e-02  5.30248986e-02 -1.35964796e-02]
 [-2.32773595e-03 -2.08237113e-01  1.75101000e-01]
 [-9.27839500e-02  3.82805026e-02  1.59364783e-01]
 [-5.85698076e-02 -5.57250760e-02  4.90350766e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.21783285]
curr_Stock_Price:  100.64694715332534
curr_Factors:  [100.64694715  -1.31124649  -0.96998852]
mat_Sqrt:  [[10.28188704  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258985  0.01586246  0.14017813]
Stock Position:  -0.002589853637321369
Bond Position:  [7.47849371]


portfolio before change:  [7.22441268]
curr_Stock_Price:  99.55049442636275
curr_Factors:  [99.55049443 -1.21526706 -0.92438461]
mat_Sqrt:  [[11.71667842  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02657339 -0.13853291  1.23828148]
Stock Position:  0.026573394908489135
Bond Position:  [4.57901808]


portfolio before change:  [7.18715442]
curr_Stock_Price:  98.06222602639387
curr_Factors:  [98.06222603 -0.93155652 -0.88918666]
mat_Sqrt:  [[15.876802    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01603994  0.00860535 -0.42880505]
Stock Position:  -0.016039938011758622
Bond Position:  [8.76006645]


portfolio before change:  [7.17662635]
curr_Stock_Price:  98.99173055709288
curr_Factors:  [98.99173056 -1.46413514 -0.87151455]
mat_Sqrt:  [[ 9.57721298  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02951588 -0.12094259 -1.17203295]
Stock Position:  0.029515881864841786
Bond Position:  [4.25479813]


portfolio before change:  [7.16885947]
curr_Stock_Price:  98.6564936226221
curr_Factors:  [98.65649362 -1.75152386 -0.8100651 ]
mat_Sqrt:  [[ 7.6145058   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00808594  0.03590465  0.04045264]
Stock Position:  -0.00808594052818959
Bond Position:  [7.96659001]


portfolio before change:  [7.17193792]
curr_Stock_Price:  98.76852035305943
curr_Factors:  [98.76852035 -2.03978173 -0.81104826]
mat_Sqrt:  [[ 5.70845807  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00039969  0.01711371 -0.03878697]
Stock Position:  -0.00039969023144468575
Bond Position:  [7.21141473]


portfolio before change:  [7.17562578]
curr_Stock_Price:  98.56522973048291
curr_Factors:  [98.56522973 -1.47897695 -0.83337595]
mat_Sqrt:  [[ 9.76071506  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00093145 -0.06720824  0.49951441]
Stock Position:  -0.0009314498632628751
Bond Position:  [7.26743435]


portfolio before change:  [7.17959024]
curr_Stock_Price:  98.21112121833298
curr_Factors:  [98.21112122 -1.06029976 -0.84631053]
mat_Sqrt:  [[14.59252152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00359361  0.01235498  0.45462337]
Stock Position:  -0.003593606142621436
Bond Position:  [7.53252233]


portfolio before change:  [7.17393942]
curr_Stock_Price:  100.83189308401933
curr_Factors:  [100.83189308  -1.44121228  -0.90975217]
mat_Sqrt:  [[ 9.60698324  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00623873 -0.01798519  0.13988342]
Stock Position:  -0.006238732443050634
Bond Position:  [7.80300263]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.17516542]
Stock Price:  101.26090334496503
PL:  [5.91426207]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 2.52757730e-02  8.73893045e-02  4.84154496e-02]
 [ 1.40010704e-01  7.31661875e-02  1.10847521e-01]
 [-2.99778601e-01  4.48090861e-02 -3.07926790e-01]
 [ 1.67430858e-01 -1.54086394e-01 -6.63026073e-02]
 [ 2.33197003e-01  2.18825888e-02  2.53184967e-01]
 [ 2.35981207e-01  1.35761044e-02 -2.93428569e-01]
 [-1.50111604e-01 -2.60022073e-01  3.69971755e-01]
 [-4.03403334e-02 -1.67810829e-02  1.88678027e-01]
 [ 2.08632570e-01  1.48795736e-01  1.38504066e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.27247636]
curr_Stock_Price:  99.3242673165917
curr_Factors:  [99.32426732 -1.30104503 -0.91338896]
mat_Sqrt:  [[10.847731    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00488552 0.02820478 0.1381158 ]
Stock Position:  0.004885519596481888
Bond Position:  [-3.75772702]


portfolio before change:  [-3.28239327]
curr_Stock_Price:  97.67908536410228
curr_Factors:  [97.67908536 -1.01047483 -0.91943081]
mat_Sqrt:  [[14.17928118  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01252337 0.02361429 0.31621712]
Stock Position:  0.0125233672074385
Bond Position:  [-4.50566432]


portfolio before change:  [-3.29581724]
curr_Stock_Price:  96.78710667819678
curr_Factors:  [96.78710668 -0.79265397 -0.89928835]
mat_Sqrt:  [[17.82445638  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01983159  0.01446207 -0.87842942]
Stock Position:  -0.019831588113818847
Bond Position:  [-1.3763752]


portfolio before change:  [-3.20688831]
curr_Stock_Price:  92.26819052042819
curr_Factors:  [92.26819052 -0.77626582 -0.86328372]
mat_Sqrt:  [[17.9062518   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00683807 -0.04973117 -0.18914288]
Stock Position:  0.006838066580997129
Bond Position:  [-3.83782434]


portfolio before change:  [-3.21913127]
curr_Stock_Price:  90.75847076516396
curr_Factors:  [90.75847077 -1.20610807 -0.85227705]
mat_Sqrt:  [[11.58622267  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02497319 0.00706258 0.72226624]
Stock Position:  0.02497318936174314
Bond Position:  [-5.48565975]


portfolio before change:  [-3.24219922]
curr_Stock_Price:  89.9446207815061
curr_Factors:  [89.94462078 -1.01677578 -0.82503672]
mat_Sqrt:  [[14.25890541  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0125435   0.00438167 -0.83707003]
Stock Position:  0.012543498757205585
Bond Position:  [-4.37041945]


portfolio before change:  [-3.26234943]
curr_Stock_Price:  88.51244785432009
curr_Factors:  [88.51244785 -0.72488212 -0.82214108]
mat_Sqrt:  [[18.84259508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00677551 -0.08392176  1.05542644]
Stock Position:  -0.006775511481751597
Bond Position:  [-2.66263232]


portfolio before change:  [-3.25995983]
curr_Stock_Price:  87.96322741135343
curr_Factors:  [87.96322741 -1.06010404 -0.83207017]
mat_Sqrt:  [[13.25990267  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.96082589e-04 -5.41607123e-03  5.38245893e-01]
Stock Position:  -0.00039608258911212233
Bond Position:  [-3.22511913]


portfolio before change:  [-3.26170469]
curr_Stock_Price:  88.29623473287366
curr_Factors:  [88.29623473 -1.08794191 -0.84738222]
mat_Sqrt:  [[12.74798642  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.02096624 0.04802362 0.39511355]
Stock Position:  0.020966244188561623
Bond Position:  [-5.11294511]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.26444082]
Stock Price:  88.2876965502854
PL:  [-3.26444082]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.28303396e-02  9.40404539e-02  4.85972048e-02]
 [ 4.80034536e-01 -6.43336092e-01  6.52272863e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.46167637e-01 -3.80823328e-01 -4.06165385e-01]
 [-9.58610424e-02  1.06272027e-01  5.82996933e-03]
 [-7.90027821e-02  3.76155238e-02  5.88296698e-02]
 [-8.48654208e-02 -2.79947924e-01  1.71110412e-01]
 [-1.16795163e-01  6.53575260e-02  1.50158821e-01]
 [ 9.93392352e-03 -3.88171930e-02  1.30375723e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.76094389]
curr_Stock_Price:  99.51485021464396
curr_Factors:  [99.51485021 -0.94173876 -0.94783058]
mat_Sqrt:  [[15.04036429  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00411866 0.03035143 0.1386343 ]
Stock Position:  0.0041186588723936685
Bond Position:  [-2.17081161]


portfolio before change:  [-1.75386126]
curr_Stock_Price:  101.49809352037302
curr_Factors:  [101.49809352  -0.6603844   -1.00753494]
mat_Sqrt:  [[19.14651424  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02516692 -0.20763583  1.86075292]
Stock Position:  0.025166917641197852
Bond Position:  [-4.30825542]


portfolio before change:  [-1.7772365]
curr_Stock_Price:  100.65490051788736
curr_Factors:  [100.65490052  -1.05403439  -1.01998271]
mat_Sqrt:  [[12.65029759  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00278318 -0.02755111  0.34758667]
Stock Position:  0.0027831816245822176
Bond Position:  [-2.05737737]


portfolio before change:  [-1.78172583]
curr_Stock_Price:  99.41158060061382
curr_Factors:  [99.4115806  -1.19117243 -1.00844264]
mat_Sqrt:  [[11.01935798  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02591115 -0.1229102  -1.15867679]
Stock Position:  0.02591115007717643
Bond Position:  [-4.35759421]


portfolio before change:  [-1.77719121]
curr_Stock_Price:  99.67069512268854
curr_Factors:  [99.67069512 -1.14490404 -1.00625566]
mat_Sqrt:  [[11.59660069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00629308  0.03429915  0.01663128]
Stock Position:  -0.0062930784733176304
Bond Position:  [-1.14995571]


portfolio before change:  [-1.77884455]
curr_Stock_Price:  99.84202817013501
curr_Factors:  [99.84202817 -0.80257513 -1.02408999]
mat_Sqrt:  [[16.06951645  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00369121  0.01214036  0.16782467]
Stock Position:  -0.0036912118415222267
Bond Position:  [-1.41030647]


portfolio before change:  [-1.79060362]
curr_Stock_Price:  102.83663778748142
curr_Factors:  [102.83663779  -1.20285816  -1.02828104]
mat_Sqrt:  [[11.0452723   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00969481 -0.0903528   0.48813038]
Stock Position:  -0.009694807142023866
Bond Position:  [-0.79362224]


portfolio before change:  [-1.8075423]
curr_Stock_Price:  104.54288929101394
curr_Factors:  [104.54288929  -1.36201119  -1.00021162]
mat_Sqrt:  [[ 9.84904609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00739189  0.02109405  0.42836132]
Stock Position:  -0.007391890743894779
Bond Position:  [-1.03477269]


portfolio before change:  [-1.81676312]
curr_Stock_Price:  105.72030115574869
curr_Factors:  [105.72030116  -1.81639563  -1.01389319]
mat_Sqrt:  [[ 6.23705503  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074902 -0.0125282   0.03719256]
Stock Position:  0.0007490202444325442
Bond Position:  [-1.89594977]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.81726888]
Stock Price:  106.31101171850784
PL:  [-8.1282806]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.26977038e-02  1.12492435e-01  5.37693968e-02]
 [ 2.48916262e-01 -2.48011626e-01  3.17481775e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.29381991e-01 -4.71276217e-01 -3.64978078e-01]
 [-1.52320691e-01  1.16998307e-01 -1.48517730e-01]
 [-7.53228211e-02 -1.23518623e-02  1.43056186e-02]
 [-2.21667810e-02 -4.33266143e-01  2.77578893e-01]
 [-1.16832665e-01  6.72995334e-02  1.54432950e-01]
 [-2.08039505e-02 -4.56512168e-02  2.73412572e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.80030284]
curr_Stock_Price:  98.50120059091309
curr_Factors:  [98.50120059 -1.00278928 -1.02017287]
mat_Sqrt:  [[13.02807431  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00511478 0.03630678 0.15338912]
Stock Position:  0.005114781856717113
Bond Position:  [-10.30411499]


portfolio before change:  [-9.80391998]
curr_Stock_Price:  98.80154633170447
curr_Factors:  [98.80154633 -0.98248146 -1.03049587]
mat_Sqrt:  [[13.19893207  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01993319 -0.08004541  0.90568713]
Stock Position:  0.019933188203341397
Bond Position:  [-11.7733498]


portfolio before change:  [-9.79017292]
curr_Stock_Price:  99.78659753172204
curr_Factors:  [99.78659753 -1.17085021 -1.0038699 ]
mat_Sqrt:  [[11.33974456  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00310484 -0.02755111  0.34758667]
Stock Position:  0.003104838526988173
Bond Position:  [-10.09999419]


portfolio before change:  [-9.78918978]
curr_Stock_Price:  101.73014302656053
curr_Factors:  [101.73014303  -1.44549929  -1.05159538]
mat_Sqrt:  [[ 8.37481494  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04282868 -0.15210374 -1.04118087]
Stock Position:  0.04282868343940595
Bond Position:  [-14.14615787]


portfolio before change:  [-9.73597445]
curr_Stock_Price:  103.13784872852732
curr_Factors:  [103.13784873  -1.47788928  -1.03540477]
mat_Sqrt:  [[ 8.35426657  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01900281  0.03776104 -0.42367975]
Stock Position:  -0.01900281308132111
Bond Position:  [-7.77606519]


portfolio before change:  [-9.74727891]
curr_Stock_Price:  103.52807826370741
curr_Factors:  [103.52807826  -1.84917446  -1.06995375]
mat_Sqrt:  [[ 5.5885209   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01340677 -0.00398655  0.04080995]
Stock Position:  -0.013406769629003746
Bond Position:  [-8.35930181]


portfolio before change:  [-9.75116502]
curr_Stock_Price:  103.50610533864014
curr_Factors:  [103.50610534  -2.00041683  -1.0513195 ]
mat_Sqrt:  [[ 4.89343381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01102422 -0.13983605  0.79185532]
Stock Position:  -0.01102422343299715
Bond Position:  [-8.61009059]


portfolio before change:  [-9.75228345]
curr_Stock_Price:  103.21695231229546
curr_Factors:  [103.21695231  -1.29181884  -0.99012177]
mat_Sqrt:  [[10.53699607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00679242  0.02172083  0.44055422]
Stock Position:  -0.006792420776052612
Bond Position:  [-9.05119048]


portfolio before change:  [-9.75029107]
curr_Stock_Price:  102.25718993013473
curr_Factors:  [102.25718993  -1.34244629  -1.0337999 ]
mat_Sqrt:  [[ 9.49955464  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00258343 -0.01473387  0.077997  ]
Stock Position:  -0.002583432205076919
Bond Position:  [-9.48611655]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.75016677]
Stock Price:  100.37266478379665
PL:  [-10.12283156]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-7.02945772e-02  6.25567342e-02  5.16071959e-02]
 [ 4.95419561e-01 -5.21505269e-01  6.05255223e-01]
 [-1.12511096e-02 -5.77393032e-02  6.35965047e-02]
 [ 5.71492092e-01 -5.17108088e-01 -3.13264767e-01]
 [-1.26718584e-01  7.86072362e-02 -9.65622085e-02]
 [-5.66459434e-02 -5.79320491e-02 -2.86285248e-02]
 [-4.78346894e-01  1.58227763e-01  4.25788623e-01]
 [-1.15633121e-01  1.23318439e-01  2.89388899e-01]
 [-2.13379518e-02 -4.71784028e-02  2.34887016e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.32778934]
curr_Stock_Price:  101.16515462195017
curr_Factors:  [101.16515462  -1.53169768  -1.00017488]
mat_Sqrt:  [[ 8.04364079  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.005842    0.0201901   0.14722097]
Stock Position:  -0.005842001624439896
Bond Position:  [11.91879634]


portfolio before change:  [11.32811457]
curr_Stock_Price:  102.12983394438979
curr_Factors:  [102.12983394  -1.50963106  -0.96169592]
mat_Sqrt:  [[ 8.62718193  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05940699 -0.1683151   1.72662468]
Stock Position:  0.05940699441845965
Bond Position:  [5.26088809]


portfolio before change:  [11.34167378]
curr_Stock_Price:  102.31378708865196
curr_Factors:  [102.31378709  -1.36770449  -0.95171709]
mat_Sqrt:  [[10.06056025  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0009995  -0.01863528  0.18142313]
Stock Position:  -0.0009994983515798262
Bond Position:  [11.44393624]


portfolio before change:  [11.34653233]
curr_Stock_Price:  103.17906330692719
curr_Factors:  [103.17906331  -1.40658925  -0.97709959]
mat_Sqrt:  [[ 9.51412097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04225224 -0.16689592 -0.89365718]
Stock Position:  0.04225224209996057
Bond Position:  [6.98698557]


portfolio before change:  [11.31560831]
curr_Stock_Price:  102.36447012494406
curr_Factors:  [102.36447012  -0.6227115   -0.97530232]
mat_Sqrt:  [[20.70811926  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00629626  0.02537038 -0.2754651 ]
Stock Position:  -0.006296256350434593
Bond Position:  [11.96012125]


portfolio before change:  [11.31092374]
curr_Stock_Price:  104.05851309180905
curr_Factors:  [104.05851309  -0.22874114  -0.95828011]
mat_Sqrt:  [[31.75125073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00234054 -0.01869749 -0.08166921]
Stock Position:  -0.002340539185799282
Bond Position:  [11.55447676]


portfolio before change:  [11.30897099]
curr_Stock_Price:  107.36178240189462
curr_Factors:  [107.3617824   -0.34439739  -0.96008823]
mat_Sqrt:  [[29.12854599  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01232932  0.05106779  1.21465643]
Stock Position:  -0.012329316016822828
Bond Position:  [12.63266833]


portfolio before change:  [11.29543104]
curr_Stock_Price:  108.97240356570029
curr_Factors:  [108.97240357  -0.33264784  -0.98445509]
mat_Sqrt:  [[29.19483288  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00107518  0.03980086  0.82554598]
Stock Position:  -0.0010751761526822073
Bond Position:  [11.41259557]


portfolio before change:  [11.30353921]
curr_Stock_Price:  106.7397979882365
curr_Factors:  [106.73979799  -0.38568338  -0.9653868 ]
mat_Sqrt:  [[27.64165551  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00094689 -0.01522676  0.06700673]
Stock Position:  -0.0009468894449950471
Bond Position:  [11.40461]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.30837535]
Stock Price:  107.65605266116228
PL:  [3.65232269]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 2.57587454e-02 -9.30664604e-02  3.99325187e-02]
 [ 1.04620697e-01  1.49601555e-01  5.51276334e-02]
 [-4.89374105e-01  4.05255209e-02 -3.91496510e-01]
 [ 3.18778836e-01 -2.73569287e-01 -2.67893316e-01]
 [ 4.29717228e-02  8.02319087e-02  1.94434815e-01]
 [ 2.93514430e-02  7.73608022e-02 -1.34742192e-01]
 [-4.87161046e-02 -1.11394444e-01  1.93061019e-01]
 [-3.61060991e-02 -3.89773107e-02  1.50973694e-01]
 [ 8.41020479e-02  5.40712542e-02  1.12128887e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.29205729]
curr_Stock_Price:  97.68268203760351
curr_Factors:  [97.68268204 -1.72831491 -0.95974674]
mat_Sqrt:  [[ 6.64365754  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00224467 -0.03003707  0.11391636]
Stock Position:  0.0022446709317068855
Bond Position:  [-16.51132277]


portfolio before change:  [-16.30259729]
curr_Stock_Price:  96.66592773839209
curr_Factors:  [96.66592774 -1.20096419 -0.94902654]
mat_Sqrt:  [[11.26015357  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01300256 0.04828369 0.15726379]
Stock Position:  0.013002564040555883
Bond Position:  [-17.55950221]


portfolio before change:  [-16.32815448]
curr_Stock_Price:  95.37577919560987
curr_Factors:  [95.3757792  -1.08579733 -0.94495953]
mat_Sqrt:  [[12.51675066  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0448212   0.01307956 -1.11683057]
Stock Position:  -0.04482119790532399
Bond Position:  [-12.05329781]


portfolio before change:  [-16.36919322]
curr_Stock_Price:  96.1568957568727
curr_Factors:  [96.15689576 -1.29500665 -0.96518619]
mat_Sqrt:  [[10.03208399  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02075872 -0.08829411 -0.76422506]
Stock Position:  0.02075872224042904
Bond Position:  [-18.36528751]


portfolio before change:  [-16.39945579]
curr_Stock_Price:  95.14153272594622
curr_Factors:  [95.14153273 -1.57740314 -0.92616769]
mat_Sqrt:  [[ 7.78185525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01272676 0.02589474 0.55466841]
Stock Position:  0.01272676371696426
Bond Position:  [-17.6102996]


portfolio before change:  [-16.40309728]
curr_Stock_Price:  95.54743863574734
curr_Factors:  [95.54743864 -1.14503485 -0.88693289]
mat_Sqrt:  [[12.52410426  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00140837  0.02496809 -0.38438197]
Stock Position:  0.001408365466209202
Bond Position:  [-16.53766299]


portfolio before change:  [-16.41317098]
curr_Stock_Price:  94.26736976618031
curr_Factors:  [94.26736977 -1.04168516 -0.85505593]
mat_Sqrt:  [[14.1454642   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226546 -0.0359524   0.55074935]
Stock Position:  -0.0022654600986791594
Bond Position:  [-16.19961202]


portfolio before change:  [-16.41910773]
curr_Stock_Price:  93.3116772389337
curr_Factors:  [93.31167724 -1.42259228 -0.82605599]
mat_Sqrt:  [[ 9.84828164  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0013449  -0.01257987  0.43068593]
Stock Position:  -0.001344897880102848
Bond Position:  [-16.29361305]


portfolio before change:  [-16.42686008]
curr_Stock_Price:  93.01686473918991
curr_Factors:  [93.01686474 -1.31805857 -0.81746627]
mat_Sqrt:  [[10.99297004  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01073664 0.01745142 0.3198725 ]
Stock Position:  0.010736635253713808
Bond Position:  [-17.42554823]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.44148131]
Stock Price:  92.46675983722648
PL:  [-16.44148131]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-1.18604193e-02  2.75319978e-02  4.42860252e-02]
 [ 2.74050666e-01 -3.22136518e-01  3.65171064e-01]
 [-2.21109388e-01  2.68154427e-02 -1.46425058e-01]
 [ 4.45223587e-01 -3.83428060e-01 -3.93674086e-01]
 [-5.77697976e-02 -3.04563946e-03  2.54363324e-02]
 [ 6.27393013e-02 -3.58627453e-01 -4.22951559e-01]
 [-7.05783537e-01 -1.19710871e-01  7.58449417e-01]
 [-1.15653367e-01  1.23116064e-01  2.88819986e-01]
 [ 1.31991235e-02  3.02994883e-02  1.34824405e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.16083373]
curr_Stock_Price:  100.26150273820633
curr_Factors:  [100.26150274  -0.64978786  -0.98561002]
mat_Sqrt:  [[19.53844213  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00014328 0.00888591 0.1263357 ]
Stock Position:  0.00014327515259743556
Bond Position:  [4.14646874]


portfolio before change:  [4.16271119]
curr_Stock_Price:  98.89145647646906
curr_Factors:  [98.89145648 -0.47030624 -0.98163966]
mat_Sqrt:  [[23.15190236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01221649 -0.10396911  1.0417314 ]
Stock Position:  0.012216493110879032
Bond Position:  [2.95460439]


portfolio before change:  [4.15502259]
curr_Stock_Price:  98.14113779069498
curr_Factors:  [98.14113779 -0.88293211 -0.98150343]
mat_Sqrt:  [[15.2102734   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01614202  0.00865465 -0.41770993]
Stock Position:  -0.01614202402522723
Bond Position:  [5.7392192]


portfolio before change:  [4.13720536]
curr_Stock_Price:  99.42273434335712
curr_Factors:  [ 9.94227343e+01 -6.45970864e-02 -1.01251855e+00]
mat_Sqrt:  [[33.86104245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00846395 -0.12375087 -1.12304259]
Stock Position:  0.008463953123023909
Bond Position:  [3.295696]


portfolio before change:  [4.15498495]
curr_Stock_Price:  101.32862061362044
curr_Factors:  [101.32862061   0.18008638  -1.02762592]
mat_Sqrt:  [[43.41605802  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00122534 -0.00098298  0.07256278]
Stock Position:  -0.0012253373293418114
Bond Position:  [4.27914669]


portfolio before change:  [4.14301915]
curr_Stock_Price:  112.8404751557781
curr_Factors:  [112.84047516  -0.39723429  -1.04840145]
mat_Sqrt:  [[26.58479288  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364117 -0.11574651 -1.20656307]
Stock Position:  -0.0036411736223460837
Bond Position:  [4.55389092]


portfolio before change:  [4.13832136]
curr_Stock_Price:  114.75615082851733
curr_Factors:  [114.75615083  -0.30675351  -1.03559845]
mat_Sqrt:  [[29.97781135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01919425 -0.03863652  2.16364508]
Stock Position:  -0.019194249069265677
Bond Position:  [6.3409795]


portfolio before change:  [4.09641637]
curr_Stock_Price:  117.10457678576627
curr_Factors:  [117.10457679  -0.5516164   -1.04052654]
mat_Sqrt:  [[23.82950252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132471  0.03973554  0.82392303]
Stock Position:  -0.001324713908110893
Bond Position:  [4.25154643]


portfolio before change:  [4.09474948]
curr_Stock_Price:  119.96798171701452
curr_Factors:  [119.96798172  -0.62137062  -1.069578  ]
mat_Sqrt:  [[22.11544586  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00100093 0.00977912 0.03846165]
Stock Position:  0.0010009326735160244
Bond Position:  [3.97466961]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.09251705]
Stock Price:  115.75164389158303
PL:  [-11.65912685]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 1.06961223e-01 -1.16294476e-01  2.94748096e-02]
 [ 1.04567326e-01  1.50380674e-01  5.56466660e-02]
 [-3.14669587e-01  4.44726513e-02 -3.14490424e-01]
 [ 2.85795340e-01 -2.49753376e-01 -2.14849562e-01]
 [ 2.54488528e-01 -1.00914277e-01  2.08072841e-01]
 [ 1.13058953e-01  5.77493037e-02 -1.86629936e-01]
 [-4.49939683e-02 -1.55228078e-01  3.00598666e-01]
 [-4.57827544e-02 -1.26836446e-02  1.81986462e-01]
 [ 1.43092753e-01  9.73076059e-02  1.26958767e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-24.9793392]
curr_Stock_Price:  96.5873384797199
curr_Factors:  [96.58733848 -0.86890451 -0.95365742]
mat_Sqrt:  [[15.60959407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00571695 -0.03753388  0.08408343]
Stock Position:  0.005716947724643861
Bond Position:  [-25.53152396]


portfolio before change:  [-24.99361502]
curr_Stock_Price:  96.32375987626267
curr_Factors:  [96.32375988 -1.01677585 -0.90924556]
mat_Sqrt:  [[14.03695658  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01044546 0.04853515 0.15874445]
Stock Position:  0.010445460882149175
Bond Position:  [-25.99976108]


portfolio before change:  [-25.00301846]
curr_Stock_Price:  96.66837766308177
curr_Factors:  [96.66837766 -0.86069136 -0.90279302]
mat_Sqrt:  [[16.57344894  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.022312    0.01435349 -0.89715364]
Stock Position:  -0.02231199646459184
Bond Position:  [-22.84615396]


portfolio before change:  [-24.98457122]
curr_Stock_Price:  95.32949402950406
curr_Factors:  [95.32949403 -0.82522003 -0.9418945 ]
mat_Sqrt:  [[16.28467879  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01172628 -0.08060756 -0.612906  ]
Stock Position:  0.011726277517262991
Bond Position:  [-26.10243132]


portfolio before change:  [-25.03383452]
curr_Stock_Price:  92.2416583503616
curr_Factors:  [92.24165835 -0.53660461 -0.91647105]
mat_Sqrt:  [[21.57070612  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01281192 -0.03256994  0.5935739 ]
Stock Position:  0.012811920797589292
Bond Position:  [-26.21562734]


portfolio before change:  [-25.03277385]
curr_Stock_Price:  93.34779672458025
curr_Factors:  [93.34779672 -1.23735802 -0.86526265]
mat_Sqrt:  [[11.40112003  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00760902  0.01863851 -0.53240326]
Stock Position:  0.007609015971402653
Bond Position:  [-25.74305873]


portfolio before change:  [-25.04699397]
curr_Stock_Price:  93.1709847277924
curr_Factors:  [93.17098473 -1.46796468 -0.89504356]
mat_Sqrt:  [[ 8.77080074  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174674 -0.05009965  0.85752432]
Stock Position:  -0.0017467414704724193
Bond Position:  [-24.88424834]


portfolio before change:  [-25.05993549]
curr_Stock_Price:  93.45510917205296
curr_Factors:  [93.45510917 -0.98768001 -0.88278088]
mat_Sqrt:  [[14.39700667  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007796  -0.00409363  0.51915672]
Stock Position:  -0.000779603819098307
Bond Position:  [-24.98707753]


portfolio before change:  [-25.07155478]
curr_Stock_Price:  92.32969508171182
curr_Factors:  [92.32969508 -0.49435697 -0.88021279]
mat_Sqrt:  [[23.35464882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00808708 0.03140589 0.36217802]
Stock Position:  0.008087080892838664
Bond Position:  [-25.81823249]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-25.0970153]
Stock Price:  90.77806218539615
PL:  [-25.0970153]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-2.14671046e-02  1.57759330e-02  4.35917579e-02]
 [ 2.18256753e-01 -1.57592419e-01  2.59309309e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.27183884e-01 -4.72942325e-01 -3.46542841e-01]
 [-1.34558924e-01  8.57229285e-02 -3.18775502e-02]
 [-6.27445978e-02 -4.29863436e-02 -1.38109723e-02]
 [-3.85912395e-02 -3.83009313e-01  2.07568321e-01]
 [-1.17249795e-01  8.89003449e-02  2.01973780e-01]
 [-2.61555727e-02 -4.70802820e-02  2.91350408e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.73152141]
curr_Stock_Price:  100.45954427197124
curr_Factors:  [100.45954427  -0.64799216  -1.02761155]
mat_Sqrt:  [[18.80553775  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00049713  0.00509166  0.12435515]
Stock Position:  -0.0004971261980392986
Bond Position:  [5.78146248]


portfolio before change:  [5.7354811]
curr_Stock_Price:  98.31071330175448
curr_Factors:  [98.3107133  -0.51158848 -1.02165496]
mat_Sqrt:  [[21.21884217  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0112645  -0.05086273  0.73973728]
Stock Position:  0.011264498984559461
Bond Position:  [4.62806017]


portfolio before change:  [5.75829354]
curr_Stock_Price:  100.13039743694434
curr_Factors:  [100.13039744  -0.29409272  -0.98537876]
mat_Sqrt:  [[27.85470318  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00126399 -0.02755111  0.34758667]
Stock Position:  0.0012639903418411409
Bond Position:  [5.63172969]


portfolio before change:  [5.76397251]
curr_Stock_Price:  102.39496847191126
curr_Factors:  [102.39496847  -0.49429474  -0.96737121]
mat_Sqrt:  [[23.74024296  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01516021 -0.15264148 -0.98859027]
Stock Position:  0.015160214483088186
Bond Position:  [4.21164282]


portfolio before change:  [5.80588712]
curr_Stock_Price:  105.02080621058857
curr_Factors:  [105.02080621  -0.87873963  -0.91155273]
mat_Sqrt:  [[17.52916601  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00704927  0.02766696 -0.09093778]
Stock Position:  -0.007049267602061659
Bond Position:  [6.54620688]


portfolio before change:  [5.81666662]
curr_Stock_Price:  103.95607415033876
curr_Factors:  [103.95607415  -0.78234071  -0.87978089]
mat_Sqrt:  [[19.72421065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00376889 -0.01387378 -0.03939886]
Stock Position:  -0.0037688859980776744
Bond Position:  [6.20846521]


portfolio before change:  [5.82115481]
curr_Stock_Price:  103.58907460568545
curr_Factors:  [103.58907461  -1.57997339  -0.90064299]
mat_Sqrt:  [[ 8.6695379   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00858212 -0.12361572  0.59213464]
Stock Position:  -0.008582116230541047
Bond Position:  [6.71016829]


portfolio before change:  [5.82157683]
curr_Stock_Price:  103.93093694766958
curr_Factors:  [103.93093695  -0.97716852  -0.88233355]
mat_Sqrt:  [[16.18726046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00357536  0.02869246  0.57617498]
Stock Position:  -0.0035753648864503785
Bond Position:  [6.19316785]


portfolio before change:  [5.83246949]
curr_Stock_Price:  101.7506565723245
curr_Factors:  [101.75065657  -1.49169821  -0.92746347]
mat_Sqrt:  [[ 9.0554211   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0032929  -0.0151951   0.08311416]
Stock Position:  -0.003292903711718565
Bond Position:  [6.1675246]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.83762406]
Stock Price:  101.12201832256244
PL:  [4.71560574]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-5.12222321e-02  5.17220408e-02  4.96123079e-02]
 [ 3.43771623e-01 -5.21216666e-01  4.87215890e-01]
 [-7.65639263e-02 -4.23413254e-02  4.35905958e-02]
 [ 4.41901270e-01 -3.76413163e-01 -4.06690525e-01]
 [-9.35235900e-02  1.03538643e-01  1.75417604e-02]
 [-9.45816955e-02  3.44364202e-02  5.58535385e-02]
 [-1.28053677e-01 -4.12978329e-02  1.69064135e-01]
 [-1.09937326e-01  4.53212875e-02  1.25015295e-01]
 [-7.57376165e-02 -5.89413957e-02  7.34255774e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.08841922]
curr_Stock_Price:  101.00888755344688
curr_Factors:  [101.00888755  -0.96281722  -0.98332826]
mat_Sqrt:  [[14.42644575  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00211677  0.01669322  0.14153011]
Stock Position:  -0.0021167684198838735
Bond Position:  [10.30223164]


portfolio before change:  [10.09614906]
curr_Stock_Price:  99.79125845151222
curr_Factors:  [99.79125845 -0.864563   -0.94604038]
mat_Sqrt:  [[16.32140117  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0206374  -0.16822196  1.38989132]
Stock Position:  0.020637397493617694
Bond Position:  [8.0367172]


portfolio before change:  [10.08129611]
curr_Stock_Price:  98.8767869346673
curr_Factors:  [98.87678693 -0.6512691  -0.99990326]
mat_Sqrt:  [[18.96702871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00402324 -0.0136656   0.12435184]
Stock Position:  -0.0040232406064704416
Bond Position:  [10.47910122]


portfolio before change:  [10.08492942]
curr_Stock_Price:  99.27635338402388
curr_Factors:  [99.27635338 -0.77174504 -1.00266879]
mat_Sqrt:  [[16.83556442  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01675328 -0.12148683 -1.16017487]
Stock Position:  0.016753278479039124
Bond Position:  [8.42172503]


portfolio before change:  [10.09483809]
curr_Stock_Price:  99.61639164502577
curr_Factors:  [99.61639165 -1.04930233 -0.97236171]
mat_Sqrt:  [[13.19268738  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00521563  0.03341695  0.05004176]
Stock Position:  -0.0052156284867236925
Bond Position:  [10.61440018]


portfolio before change:  [10.09651509]
curr_Stock_Price:  100.31266964357631
curr_Factors:  [100.31266964  -0.66387873  -0.99610264]
mat_Sqrt:  [[19.07370409  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00399248  0.01111431  0.1593346 ]
Stock Position:  -0.003992477525213144
Bond Position:  [10.49701117]


portfolio before change:  [10.10816312]
curr_Stock_Price:  98.7101030079331
curr_Factors:  [98.71010301 -0.83790976 -1.06983203]
mat_Sqrt:  [[14.65007587  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00696061 -0.01332882  0.48229292]
Stock Position:  -0.006960611722772639
Bond Position:  [10.79524582]


portfolio before change:  [10.10684246]
curr_Stock_Price:  99.67548343391118
curr_Factors:  [99.67548343 -1.09661269 -1.06583429]
mat_Sqrt:  [[11.4669933   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00655512  0.01462738  0.35663384]
Stock Position:  -0.006555119975085151
Bond Position:  [10.76022721]


portfolio before change:  [10.10895141]
curr_Stock_Price:  100.17471160927752
curr_Factors:  [100.17471161  -1.14683342  -1.08882312]
mat_Sqrt:  [[10.71087126  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00679506 -0.01902325  0.20946273]
Stock Position:  -0.006795063028406309
Bond Position:  [10.78964489]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.10550232]
Stock Price:  101.4764309302329
PL:  [8.62907139]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-6.45205337e-02  5.92765926e-02  5.10032549e-02]
 [ 3.21785058e-01 -3.92908426e-01  3.88870302e-01]
 [ 3.77398015e-02 -7.52027223e-02  8.83199068e-02]
 [ 5.25865849e-01 -4.64821632e-01 -3.81478195e-01]
 [-1.39227196e-01  1.25414968e-01 -1.38070985e-01]
 [-9.45816955e-02  3.44364202e-02  5.58535385e-02]
 [-2.58769254e-01  2.43094552e-01  1.86328036e-01]
 [-7.78804686e-02  3.78863005e-02  2.02128436e-01]
 [ 7.30580726e-02  4.34257184e-02  1.12996801e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.61363379]
curr_Stock_Price:  100.82293793887969
curr_Factors:  [100.82293794  -1.77343778  -0.97939028]
mat_Sqrt:  [[ 6.42719257  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00653625  0.01913144  0.14549809]
Stock Position:  -0.006536252585195616
Bond Position:  [9.27263798]


portfolio before change:  [8.62378423]
curr_Stock_Price:  99.97949385562875
curr_Factors:  [99.97949386 -1.88554142 -0.94873858]
mat_Sqrt:  [[ 5.8748769   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05463277 -0.12681065  1.10933873]
Stock Position:  0.054632766639884665
Bond Position:  [3.16162787]


portfolio before change:  [8.64817596]
curr_Stock_Price:  100.39701834982594
curr_Factors:  [100.39701835  -1.670225    -0.96265652]
mat_Sqrt:  [[ 7.2156407   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00560135 -0.02427157  0.25195211]
Stock Position:  0.005601350899410488
Bond Position:  [8.08581703]


portfolio before change:  [8.65659049]
curr_Stock_Price:  101.17729736245799
curr_Factors:  [101.17729736  -1.56027934  -0.97782713]
mat_Sqrt:  [[ 7.99461286  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0441692  -0.15002054 -1.08825111]
Stock Position:  0.04416919571782378
Bond Position:  [4.18767064]


portfolio before change:  [8.66597688]
curr_Stock_Price:  101.34239043829015
curr_Factors:  [101.34239044  -1.34167181  -0.98085017]
mat_Sqrt:  [[ 9.93419469  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.014275    0.04047751 -0.39387809]
Stock Position:  -0.014274996472244027
Bond Position:  [10.11263915]


portfolio before change:  [8.67724761]
curr_Stock_Price:  100.90714349217288
curr_Factors:  [100.90714349  -0.96318901  -0.96833501]
mat_Sqrt:  [[14.62418556  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00520722  0.01111431  0.1593346 ]
Stock Position:  -0.005207218862264806
Bond Position:  [9.20269319]


portfolio before change:  [8.68142017]
curr_Stock_Price:  100.9897089554067
curr_Factors:  [100.98970896  -0.50452377  -0.97815368]
mat_Sqrt:  [[22.92759417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00746322  0.07845843  0.53154202]
Stock Position:  -0.007463222447223236
Bond Position:  [9.43512884]


portfolio before change:  [8.72641968]
curr_Stock_Price:  95.59247439843283
curr_Factors:  [95.5924744  -0.54229759 -0.96200273]
mat_Sqrt:  [[21.23803725  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00136019  0.01222775  0.57661617]
Stock Position:  -0.0013601852789407118
Bond Position:  [8.85644316]


portfolio before change:  [8.73071944]
curr_Stock_Price:  95.68772895712672
curr_Factors:  [95.68772896 -0.26427988 -0.98286591]
mat_Sqrt:  [[27.49335343  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00381866 0.01401559 0.32234842]
Stock Position:  0.00381865696886973
Bond Position:  [8.36532083]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.73096589]
Stock Price:  94.65666940386774
PL:  [8.73096589]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-5.28289239e-03  6.04850147e-02  4.76802388e-02]
 [ 4.42600029e-01 -5.79292591e-01  5.85694541e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.73350787e-01 -4.10011852e-01 -4.04087982e-01]
 [-8.11361579e-02  9.52253223e-02  6.52606296e-02]
 [-9.31246841e-02  3.46388002e-02  5.70359930e-02]
 [-4.16406227e-02 -2.63187077e-01  1.63134667e-01]
 [-1.12371930e-01  4.46941170e-02  1.16468336e-01]
 [-6.30259501e-02 -5.67738280e-02  5.31204902e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.21452773]
curr_Stock_Price:  100.26827279360202
curr_Factors:  [100.26827279  -0.78841836  -0.9920296 ]
mat_Sqrt:  [[16.90148289  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00099377 0.01952145 0.13601845]
Stock Position:  0.0009937736023848248
Bond Position:  [4.11488377]


portfolio before change:  [4.21747057]
curr_Stock_Price:  101.15869665700727
curr_Factors:  [101.15869666  -0.99136476  -0.97790331]
mat_Sqrt:  [[14.11760319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0314435  -0.18696588  1.6708235 ]
Stock Position:  0.03144349757544488
Bond Position:  [1.03668733]


portfolio before change:  [4.19401711]
curr_Stock_Price:  100.39631562019622
curr_Factors:  [100.39631562  -1.06900096  -0.93726796]
mat_Sqrt:  [[13.50225342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00260757 -0.02755111  0.34758667]
Stock Position:  0.0026075703586592477
Bond Position:  [3.93222666]


portfolio before change:  [4.19507757]
curr_Stock_Price:  100.04881077870806
curr_Factors:  [100.04881078  -0.9172748   -0.9577919 ]
mat_Sqrt:  [[15.34195876  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02002178 -0.13233076 -1.15275054]
Stock Position:  0.020021782062547382
Bond Position:  [2.19192209]


portfolio before change:  [4.18085288]
curr_Stock_Price:  99.28359778695251
curr_Factors:  [99.28359779 -0.84457742 -0.98882311]
mat_Sqrt:  [[15.87236991  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304788  0.03073384  0.18617041]
Stock Position:  -0.0030478813453937927
Bond Position:  [4.48345751]


portfolio before change:  [4.17959704]
curr_Stock_Price:  100.4313214610913
curr_Factors:  [100.43132146  -1.03599349  -0.98425449]
mat_Sqrt:  [[13.31946028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00558669  0.01117962  0.16270781]
Stock Position:  -0.0055866862259853454
Bond Position:  [4.74067533]


portfolio before change:  [4.1808817]
curr_Stock_Price:  100.62576107860114
curr_Factors:  [100.62576108  -1.26300799  -0.93018262]
mat_Sqrt:  [[11.22583361  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00552865 -0.08494326  0.4653778 ]
Stock Position:  -0.005528652704194893
Bond Position:  [4.73720659]


portfolio before change:  [4.18114976]
curr_Stock_Price:  101.00580627118138
curr_Factors:  [101.00580627  -1.40050342  -0.92368746]
mat_Sqrt:  [[ 9.8846902   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00804019  0.01442496  0.33225174]
Stock Position:  -0.008040189436933383
Bond Position:  [4.99325558]


portfolio before change:  [4.18478792]
curr_Stock_Price:  100.86390526650072
curr_Factors:  [100.86390527  -1.28525532  -0.89797635]
mat_Sqrt:  [[11.36502281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00561122 -0.01832367  0.15153797]
Stock Position:  -0.005611223628381769
Bond Position:  [4.75075785]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.19684586]
Stock Price:  99.1384408153447
PL:  [4.19684586]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.29768948e-02  6.02682062e-02  4.95894605e-02]
 [ 1.04009134e-01  1.58529254e-01  6.10750769e-02]
 [-4.51816120e-01  4.13740752e-02 -3.74941738e-01]
 [ 3.12639150e-01 -2.70620077e-01 -2.56432740e-01]
 [-3.54196884e-02  9.83262005e-02  1.62840851e-01]
 [-3.15519506e-02  7.28377135e-02 -9.94302531e-02]
 [-1.24708074e-01 -7.59102091e-03  1.67363688e-01]
 [-8.49029496e-02 -5.05946819e-03  8.46113002e-02]
 [-5.74806883e-02 -5.18493071e-02  8.09689298e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.2737096]
curr_Stock_Price:  97.81108129914955
curr_Factors:  [97.8110813  -0.52541169 -1.01043014]
mat_Sqrt:  [[21.05622084  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00263112 0.01945148 0.14146493]
Stock Position:  0.0026311225338846765
Bond Position:  [-15.53106254]


portfolio before change:  [-15.28853325]
curr_Stock_Price:  95.1292680652616
curr_Factors:  [95.12926807 -0.88081801 -1.02017499]
mat_Sqrt:  [[14.21423152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01047089 0.0511651  0.17423019]
Stock Position:  0.010470891804887398
Bond Position:  [-16.28462153]


portfolio before change:  [-15.29050397]
curr_Stock_Price:  95.71886687954067
curr_Factors:  [95.71886688 -0.75786634 -1.10020593]
mat_Sqrt:  [[14.92956024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03482389  0.01335343 -1.06960442]
Stock Position:  -0.03482388801027472
Bond Position:  [-11.95720087]


portfolio before change:  [-15.31446352]
curr_Stock_Price:  96.23516327922823
curr_Factors:  [96.23516328 -1.12824587 -1.05799092]
mat_Sqrt:  [[10.8109339   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01896737 -0.08734225 -0.73153123]
Stock Position:  0.0189673663753056
Bond Position:  [-17.13979112]


portfolio before change:  [-15.30860196]
curr_Stock_Price:  96.99613304047635
curr_Factors:  [96.99613304 -0.96263801 -1.06545986]
mat_Sqrt:  [[12.763292    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00140174 0.03173464 0.46453962]
Stock Position:  0.001401739680540473
Bond Position:  [-15.44456529]


portfolio before change:  [-15.31608677]
curr_Stock_Price:  97.16692718582446
curr_Factors:  [97.16692719 -0.51039718 -1.03726614]
mat_Sqrt:  [[20.67173037  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00178892  0.02350827 -0.28364684]
Stock Position:  -0.001788922812850244
Bond Position:  [-15.14226263]


portfolio before change:  [-15.325023]
curr_Stock_Price:  97.92895458018371
curr_Factors:  [97.92895458 -0.81525648 -1.03897692]
mat_Sqrt:  [[15.33302295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00600629 -0.00244999  0.47744202]
Stock Position:  -0.006006292107720973
Bond Position:  [-14.73683309]


portfolio before change:  [-15.33423446]
curr_Stock_Price:  98.23550055486625
curr_Factors:  [98.23550055 -1.63543433 -1.04808345]
mat_Sqrt:  [[ 6.71168395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01023059 -0.00163294  0.24137249]
Stock Position:  -0.010230591964138294
Bond Position:  [-14.32922714]


portfolio before change:  [-15.34055282]
curr_Stock_Price:  98.15260736915823
curr_Factors:  [98.15260737 -1.59506256 -1.06950899]
mat_Sqrt:  [[ 6.83428559  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0075409  -0.01673429  0.23098182]
Stock Position:  -0.007540900882647666
Bond Position:  [-14.60039374]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.34182449]
Stock Price:  97.35292155936533
PL:  [-15.34182449]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 1.67607843e-02  7.98925856e-02  4.82105875e-02]
 [ 3.00627237e-01 -4.00514567e-01  4.15596683e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.40689397e-01 -3.74711800e-01 -4.06456452e-01]
 [-9.78654785e-02  1.14230366e-01 -1.72644322e-02]
 [-4.65199011e-02  3.21998969e-02  7.32821711e-02]
 [ 1.95653364e-02 -3.90942772e-01  2.47249380e-01]
 [-1.13548990e-01  1.84402156e-02  5.37538953e-02]
 [-2.84267756e-02 -4.78603567e-02  2.93908782e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.86918245]
curr_Stock_Price:  99.84647200042373
curr_Factors:  [99.846472   -0.85169499 -0.96554058]
mat_Sqrt:  [[16.2224836   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00264508 0.02578522 0.13753139]
Stock Position:  0.002645078031338892
Bond Position:  [0.60508074]


portfolio before change:  [0.86840192]
curr_Stock_Price:  99.43697582712467
curr_Factors:  [99.43697583 -1.21111765 -0.9826665 ]
mat_Sqrt:  [[11.08662999  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02739388 -0.12926552  1.18558166]
Stock Position:  0.02739388449302746
Bond Position:  [-1.85556311]


portfolio before change:  [0.87845444]
curr_Stock_Price:  99.83781461527657
curr_Factors:  [99.83781462 -0.92282829 -1.0229326 ]
mat_Sqrt:  [[14.26467402  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0024682  -0.02755111  0.34758667]
Stock Position:  0.002468200516897505
Bond Position:  [0.63203469]


portfolio before change:  [0.87747704]
curr_Stock_Price:  99.31375344625766
curr_Factors:  [99.31375345 -1.73562179 -1.03043125]
mat_Sqrt:  [[ 6.24781013  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04501323 -0.12093771 -1.15950712]
Stock Position:  0.04501322690464175
Bond Position:  [-3.59295547]


portfolio before change:  [0.88142731]
curr_Stock_Price:  99.4414313472357
curr_Factors:  [99.44143135 -1.57568527 -1.02931798]
mat_Sqrt:  [[ 7.34900986  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01062353  0.03686769 -0.04925062]
Stock Position:  -0.010623525034510714
Bond Position:  [1.93784585]


portfolio before change:  [0.86903393]
curr_Stock_Price:  100.6992576245225
curr_Factors:  [100.69925762  -1.87033711  -0.99961816]
mat_Sqrt:  [[ 5.70979518  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00437642  0.01039247  0.20905364]
Stock Position:  -0.004376420394890115
Bond Position:  [1.30973621]


portfolio before change:  [0.86765712]
curr_Stock_Price:  101.16352808077724
curr_Factors:  [101.16352808  -2.04298588  -1.01746094]
mat_Sqrt:  [[ 4.74120572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0020598  -0.12617624  0.70533366]
Stock Position:  -0.002059803952611375
Bond Position:  [1.07603415]


portfolio before change:  [0.8657323]
curr_Stock_Price:  102.35925628796973
curr_Factors:  [102.35925629  -1.99003132  -1.01523727]
mat_Sqrt:  [[ 5.06938828  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01949198  0.00595155  0.1533449 ]
Stock Position:  -0.019491982649051456
Bond Position:  [2.86091715]


portfolio before change:  [0.88111356]
curr_Stock_Price:  101.64355480243623
curr_Factors:  [101.6435548   -1.58022373  -1.03161577]
mat_Sqrt:  [[ 7.46057606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0043156  -0.01544686  0.08384399]
Stock Position:  -0.004315597327674352
Bond Position:  [1.31976621]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.87827468]
Stock Price:  102.45431879953831
PL:  [-1.57604412]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 6.24097235e-02  1.20082570e-01  4.93088551e-02]
 [ 1.09965053e-01  1.43808692e-01  6.10985484e-02]
 [-7.63392076e-02 -5.06415862e-02  6.60182568e-02]
 [ 4.27934989e-01 -3.61011007e-01 -4.03536220e-01]
 [-7.96391411e-02  9.43618780e-02  7.06991639e-02]
 [-4.37987795e-02  4.40655645e-02  2.51988868e-02]
 [-1.11411572e-02 -2.81047540e-01  1.77821551e-01]
 [-1.07332920e-01  5.77608842e-02  1.60725521e-01]
 [ 2.20928841e-02  5.21181142e-03  1.01412674e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.53666061]
curr_Stock_Price:  99.1648715366896
curr_Factors:  [99.16487154 -0.91733675 -0.97948225]
mat_Sqrt:  [[14.87920853  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00651826 0.03875648 0.14066444]
Stock Position:  0.006518263598743764
Bond Position:  [-5.18304339]


portfolio before change:  [-4.55073682]
curr_Stock_Price:  97.40304662989347
curr_Factors:  [97.40304663 -1.03051183 -0.93784464]
mat_Sqrt:  [[13.60586597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01115633 0.04641406 0.17429715]
Stock Position:  0.011156332740501994
Bond Position:  [-5.63739762]


portfolio before change:  [-4.5372035]
curr_Stock_Price:  98.86882669883992
curr_Factors:  [98.8688267  -1.44665595 -0.98352485]
mat_Sqrt:  [[ 8.70252475  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0084114  -0.0163445   0.18833171]
Stock Position:  -0.00841140473510966
Bond Position:  [-3.70557778]


portfolio before change:  [-4.53806682]
curr_Stock_Price:  98.75113837184304
curr_Factors:  [98.75113837 -1.30479806 -0.93888029]
mat_Sqrt:  [[10.47429935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02595615 -0.1165158  -1.15117651]
Stock Position:  0.025956145648568206
Bond Position:  [-7.10126576]


portfolio before change:  [-4.53009619]
curr_Stock_Price:  99.19504693281952
curr_Factors:  [99.19504693 -0.84168145 -0.95817136]
mat_Sqrt:  [[16.39924461  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00280173  0.03045517  0.20168504]
Stock Position:  -0.0028017264255511174
Bond Position:  [-4.25217881]


portfolio before change:  [-4.53299716]
curr_Stock_Price:  99.47143111319383
curr_Factors:  [99.47143111 -1.30924055 -1.00356476]
mat_Sqrt:  [[ 9.84599889  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00301241  0.0142221   0.07188541]
Stock Position:  -0.003012414784153502
Bond Position:  [-4.23334795]


portfolio before change:  [-4.53537855]
curr_Stock_Price:  99.55913052867568
curr_Factors:  [99.55913053 -1.47666679 -0.96458825]
mat_Sqrt:  [[ 8.6667746   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00371673 -0.0907077   0.50727539]
Stock Position:  -0.0037167314784822087
Bond Position:  [-4.165344]


portfolio before change:  [-4.53547645]
curr_Stock_Price:  99.02498051722814
curr_Factors:  [99.02498052 -0.84327224 -0.9632672 ]
mat_Sqrt:  [[16.26202606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00385773  0.01864225  0.45850517]
Stock Position:  -0.0038577339119047088
Bond Position:  [-4.15346443]


portfolio before change:  [-4.52991471]
curr_Stock_Price:  97.04480381313888
curr_Factors:  [97.04480381 -0.6379678  -0.91293178]
mat_Sqrt:  [[20.57904212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00213117 0.0016821  0.28930213]
Stock Position:  0.0021311738311161443
Bond Position:  [-4.73673406]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.53503007]
Stock Price:  95.75612435601795
PL:  [-4.53503007]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-3.34452779e-02  4.16232382e-02  4.77529124e-02]
 [ 3.61757520e-01 -5.61774914e-01  5.02556532e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.85197470e-01 -4.25041512e-01 -3.96099767e-01]
 [-8.09208310e-02  9.76761026e-02  6.00571047e-02]
 [-7.57423430e-03  7.77679272e-02 -1.15141302e-01]
 [-4.64226665e-02 -2.48635553e-01  1.63435006e-01]
 [-1.13748509e-01  5.01389398e-02  1.24727607e-01]
 [-3.56308564e-02 -4.95398879e-02  3.25166314e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.90043784]
curr_Stock_Price:  100.6069281257477
curr_Factors:  [100.60692813  -0.92187712  -0.99120345]
mat_Sqrt:  [[14.8520893   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00102352  0.01343384  0.13622577]
Stock Position:  -0.001023522494992879
Bond Position:  [7.0034113]


portfolio before change:  [6.90463744]
curr_Stock_Price:  99.92593242087571
curr_Factors:  [99.92593242 -0.68054519 -1.07966719]
mat_Sqrt:  [[17.18809267  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02034371 -0.18131207  1.4336539 ]
Stock Position:  0.020343712634979767
Bond Position:  [4.87177298]


portfolio before change:  [6.91587703]
curr_Stock_Price:  100.35865051542366
curr_Factors:  [100.35865052  -0.79192174  -1.09232875]
mat_Sqrt:  [[15.2487843   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00230891 -0.02755111  0.34758667]
Stock Position:  0.0023089103444048588
Bond Position:  [6.6841579]


portfolio before change:  [6.92001163]
curr_Stock_Price:  100.70153632430402
curr_Factors:  [100.70153632  -1.29784442  -1.11453077]
mat_Sqrt:  [[ 9.0230811   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0351967  -0.13718156 -1.12996238]
Stock Position:  0.0351967033266542
Bond Position:  [3.37564954]


portfolio before change:  [6.87089084]
curr_Stock_Price:  99.2579623504034
curr_Factors:  [99.25796235 -0.9682591  -1.07083023]
mat_Sqrt:  [[12.9181437   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00377172  0.03152483  0.1713262 ]
Stock Position:  -0.00377172417794207
Bond Position:  [7.24526449]


portfolio before change:  [6.88534545]
curr_Stock_Price:  96.38631152235726
curr_Factors:  [96.38631152 -0.90074096 -1.01043306]
mat_Sqrt:  [[14.25617543  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106642  0.02509949 -0.32846608]
Stock Position:  -0.0010664180257460385
Bond Position:  [6.98813355]


portfolio before change:  [6.88528864]
curr_Stock_Price:  99.71685117269786
curr_Factors:  [99.71685117 -1.19905186 -1.00247868]
mat_Sqrt:  [[11.03204421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00578444 -0.08024678  0.46623458]
Stock Position:  -0.0057844361585071774
Bond Position:  [7.4620944]


portfolio before change:  [6.87751552]
curr_Stock_Price:  101.70582724887159
curr_Factors:  [101.70582725  -1.37422437  -0.98505845]
mat_Sqrt:  [[ 9.6099765   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00812219  0.01618227  0.35581314]
Stock Position:  -0.008122186834084345
Bond Position:  [7.70358925]


portfolio before change:  [6.87774017]
curr_Stock_Price:  102.15251725243093
curr_Factors:  [102.15251725  -0.92630897  -1.01598771]
mat_Sqrt:  [[14.64604421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00267005 -0.01598893  0.0927609 ]
Stock Position:  -0.0026700529851043644
Bond Position:  [7.15049281]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.8811639]
Stock Price:  102.20960080393849
PL:  [4.67156309]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 1.72061862e-02  7.89626004e-02  4.80637917e-02]
 [ 4.60306382e-01 -6.56138965e-01  6.40558502e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.77130324e-01 -4.23899528e-01 -3.61674216e-01]
 [-1.30516316e-01  7.79821040e-02 -3.55882423e-03]
 [-2.62880622e-02 -1.34837108e-01 -1.34581144e-01]
 [-3.47903940e-01 -1.72431956e-01  3.85841771e-01]
 [-1.17459436e-01  9.97564717e-02  2.25866831e-01]
 [-1.18276577e-02 -4.48515773e-02  1.96815341e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.27551676]
curr_Stock_Price:  100.14987677247724
curr_Factors:  [100.14987677  -0.72961789  -1.07586814]
mat_Sqrt:  [[16.46409269  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00261996 0.02548507 0.13711262]
Stock Position:  0.00261996459445588
Bond Position:  [3.01312763]


portfolio before change:  [3.27967599]
curr_Stock_Price:  101.16221279553562
curr_Factors:  [101.1622128   -0.52858705  -1.09076233]
mat_Sqrt:  [[20.03289998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02281876 -0.21176794  1.82733511]
Stock Position:  0.02281876483961345
Bond Position:  [0.97127924]


portfolio before change:  [3.28580522]
curr_Stock_Price:  101.40953007743194
curr_Factors:  [ 1.01409530e+02  9.29616127e-02 -1.07546500e+00]
mat_Sqrt:  [[37.96496203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00092738 -0.02755111  0.34758667]
Stock Position:  0.0009273834061194026
Bond Position:  [3.19175971]


portfolio before change:  [3.28775683]
curr_Stock_Price:  101.79267566180354
curr_Factors:  [ 1.01792676e+02  4.12725292e-03 -1.11926807e+00]
mat_Sqrt:  [[33.3746737   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0094915  -0.13681298 -1.03175587]
Stock Position:  0.00949150119101589
Bond Position:  [2.32159152]


portfolio before change:  [3.32469928]
curr_Stock_Price:  105.56250812351817
curr_Factors:  [105.56250812  -0.38066194  -1.15784796]
mat_Sqrt:  [[22.66435381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00508837  0.02516862 -0.01015233]
Stock Position:  -0.005088374818191124
Bond Position:  [3.86184089]


portfolio before change:  [3.32218407]
curr_Stock_Price:  106.43638562047275
curr_Factors:  [106.43638562  -0.67231487  -1.13316156]
mat_Sqrt:  [[17.49772829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00464534 -0.04351849 -0.38392254]
Stock Position:  -0.00464533631173192
Bond Position:  [3.81661688]


portfolio before change:  [3.32022344]
curr_Stock_Price:  107.26935294307842
curr_Factors:  [107.26935294  -0.75078624  -1.12201663]
mat_Sqrt:  [[16.48647122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0184601  -0.05565217  1.10069917]
Stock Position:  -0.01846009612971854
Bond Position:  [5.30042601]


portfolio before change:  [3.3102929]
curr_Stock_Price:  107.95089975415696
curr_Factors:  [107.95089975  -0.77279928  -1.10068675]
mat_Sqrt:  [[16.57988912  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00307552  0.03219626  0.6443352 ]
Stock Position:  -0.0030755246494398023
Bond Position:  [3.64229855]


portfolio before change:  [3.31693197]
curr_Stock_Price:  106.3845114431817
curr_Factors:  [106.38451144  -0.85880356  -1.13780751]
mat_Sqrt:  [[14.44645303  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00117437 -0.01447578  0.05614594]
Stock Position:  -0.001174369321287926
Bond Position:  [3.44186667]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.31919222]
Stock Price:  105.92563531253666
PL:  [-2.60644309]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 5.78770848e-02 -6.20657172e-03  3.32672751e-02]
 [ 1.04144660e-01  1.56550828e-01  5.97570914e-02]
 [-2.01318728e-01  2.71679626e-02 -1.37094826e-01]
 [ 4.42381825e-01 -3.80916474e-01 -3.91131014e-01]
 [-1.48529592e-01  1.10755696e-01 -1.25316429e-01]
 [-9.45816955e-02  3.44364202e-02  5.58535385e-02]
 [-3.07088933e-01  2.21644270e-01  2.19295844e-01]
 [-1.13823054e-01  1.09479226e-01  2.58466678e-01]
 [ 5.26317375e-04 -2.86467153e-02  5.35686784e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.28690683]
curr_Stock_Price:  100.65565640686454
curr_Factors:  [100.65565641  -0.2998736   -1.07005301]
mat_Sqrt:  [[25.57918     0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00247861 -0.00200316  0.09490228]
Stock Position:  0.002478610641309747
Bond Position:  [7.03742065]


portfolio before change:  [7.27615707]
curr_Stock_Price:  94.89866167624581
curr_Factors:  [94.89866168 -0.13480628 -1.00324777]
mat_Sqrt:  [[30.40951505  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00487671 0.05052656 0.17047035]
Stock Position:  0.004876708115654139
Bond Position:  [6.813364]


portfolio before change:  [7.2970229]
curr_Stock_Price:  98.47859563523899
curr_Factors:  [98.47859564  0.21495059 -0.97307882]
mat_Sqrt:  [[46.14141805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00484938  0.00876842 -0.39109338]
Stock Position:  -0.0048493840136556825
Bond Position:  [7.77458343]


portfolio before change:  [7.29666467]
curr_Stock_Price:  99.35427311762416
curr_Factors:  [99.35427312 -0.1029431  -1.01385445]
mat_Sqrt:  [[32.521273    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00875698 -0.12294026 -1.11578791]
Stock Position:  0.008756984757696972
Bond Position:  [6.42662081]


portfolio before change:  [7.33131405]
curr_Stock_Price:  102.94400996557454
curr_Factors:  [102.94400997  -0.76898614  -1.05502866]
mat_Sqrt:  [[16.61274949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00911961  0.03574625 -0.35749289]
Stock Position:  -0.009119609596530964
Bond Position:  [8.27012323]


portfolio before change:  [7.36066203]
curr_Stock_Price:  100.1794311456381
curr_Factors:  [100.17943115  -0.26025994  -1.0602341 ]
mat_Sqrt:  [[26.74824456  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00284697  0.01111431  0.1593346 ]
Stock Position:  -0.00284696570414478
Bond Position:  [7.64586943]


portfolio before change:  [7.35798101]
curr_Stock_Price:  102.46428512772019
curr_Factors:  [102.46428513  -0.43090857  -1.06407314]
mat_Sqrt:  [[22.97789303  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00944745  0.07153538  0.62559   ]
Stock Position:  -0.00944744621997931
Bond Position:  [8.32600684]


portfolio before change:  [7.38197795]
curr_Stock_Price:  100.36499889670336
curr_Factors:  [100.3649989   -0.14479754  -1.0192214 ]
mat_Sqrt:  [[31.33684609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00123549  0.03533427  0.73733349]
Stock Position:  -0.0012354916294248445
Bond Position:  [7.50597807]


portfolio before change:  [7.38537365]
curr_Stock_Price:  100.65494503820898
curr_Factors:  [ 1.00654945e+02  3.53205283e-02 -9.57287245e-01]
mat_Sqrt:  [[40.03409895  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.40217763e-04 -9.24568761e-03  1.52816529e-01]
Stock Position:  0.00014021776264236914
Bond Position:  [7.37126004]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.38967184]
Stock Price:  105.01700448022116
PL:  [2.37266736]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-3.95093220e-02  4.50681244e-02  4.83871862e-02]
 [ 4.61516780e-01 -4.68563040e-01  5.47498144e-01]
 [ 5.85901128e-02 -8.60594481e-02  9.94191089e-02]
 [ 5.68936894e-01 -5.13381740e-01 -3.33194494e-01]
 [-1.57178180e-01  1.26433833e-01 -1.81585597e-01]
 [-8.54561136e-02  1.26922226e-02  4.16323464e-02]
 [-4.71955278e-02 -3.06252869e-01  1.66982159e-01]
 [-1.15118865e-01  9.08404881e-02  2.12595219e-01]
 [-5.69272516e-03 -3.76670657e-02  2.83414354e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.95690681]
curr_Stock_Price:  100.74013394216801
curr_Factors:  [100.74013394  -1.03076764  -1.01400238]
mat_Sqrt:  [[13.03677545  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00156732  0.01454567  0.13803517]
Stock Position:  -0.0015673228880151917
Bond Position:  [8.11479913]


portfolio before change:  [7.9593006]
curr_Stock_Price:  101.80221350542044
curr_Factors:  [101.80221351  -1.78071023  -1.05539268]
mat_Sqrt:  [[ 5.97108673  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07999035 -0.15122807  1.56185981]
Stock Position:  0.07999035402442593
Bond Position:  [-0.18389449]


portfolio before change:  [7.99609679]
curr_Stock_Price:  102.26337105169597
curr_Factors:  [102.26337105  -1.66801137  -1.02581923]
mat_Sqrt:  [[ 6.91519355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00886702 -0.02777557  0.28361504]
Stock Position:  0.008867017499077897
Bond Position:  [7.08932569]


portfolio before change:  [8.00419942]
curr_Stock_Price:  102.77730704131255
curr_Factors:  [102.77730704  -1.51007396  -1.00454327]
mat_Sqrt:  [[ 8.31405412  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04764586 -0.16569324 -0.95051115]
Stock Position:  0.047645858232709094
Bond Position:  [3.10728642]


portfolio before change:  [7.98541652]
curr_Stock_Price:  102.35047175623653
curr_Factors:  [102.35047176  -1.41884644  -0.99155974]
mat_Sqrt:  [[ 9.18890463  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01833037  0.04080634 -0.51801317]
Stock Position:  -0.018330366254957563
Bond Position:  [9.86153815]


portfolio before change:  [7.98370457]
curr_Stock_Price:  102.71292759435559
curr_Factors:  [102.71292759  -1.72864506  -0.94432558]
mat_Sqrt:  [[ 7.09199964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01048606  0.0040964   0.1187655 ]
Stock Position:  -0.010486063339494348
Bond Position:  [9.06075883]


portfolio before change:  [7.98525288]
curr_Stock_Price:  102.99741930699781
curr_Factors:  [102.99741931  -1.36841829  -0.86351932]
mat_Sqrt:  [[11.05371224  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00684151 -0.09884269  0.47635362]
Stock Position:  -0.0068415063343509885
Bond Position:  [8.68991038]


portfolio before change:  [8.00002258]
curr_Stock_Price:  101.4738285072589
curr_Factors:  [101.47382851  -0.71205706  -0.88958126]
mat_Sqrt:  [[20.45367549  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00260004  0.02931864  0.60647498]
Stock Position:  -0.0026000368722014088
Bond Position:  [8.26385828]


portfolio before change:  [8.0040537]
curr_Stock_Price:  101.51299903815709
curr_Factors:  [ 1.01512999e+02 -5.51971553e-02 -8.46951427e-01]
mat_Sqrt:  [[41.18352415  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00018445 -0.01215699  0.08085023]
Stock Position:  -0.00018445025342491968
Bond Position:  [8.0227778]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.00856863]
Stock Price:  98.78844825906377
PL:  [8.00856863]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 9.70607232e-03  7.36815154e-02  4.80408582e-02]
 [ 2.49851089e-01 -2.50768561e-01  3.19255488e-01]
 [ 2.91485939e-03 -7.98282860e-02  1.16489705e-01]
 [ 4.60237379e-01 -3.96209578e-01 -4.04227516e-01]
 [-1.11780038e-01  1.21245437e-01 -6.54657766e-02]
 [-3.96428913e-02  4.87672790e-02  5.14358626e-03]
 [-2.23756295e-02 -2.70623032e-01  1.71893903e-01]
 [-8.18285335e-02 -6.85897680e-03  8.95542302e-02]
 [-6.48797040e-02 -5.44943436e-02  7.89239132e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.2287401]
curr_Stock_Price:  99.70803947243459
curr_Factors:  [99.70803947 -1.35567515 -0.99981699]
mat_Sqrt:  [[ 9.45699017  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00365365 0.02378061 0.1370472 ]
Stock Position:  0.0036536516549490433
Bond Position:  [-0.59303855]


portfolio before change:  [-0.23173801]
curr_Stock_Price:  98.96869338263843
curr_Factors:  [98.96869338 -1.44259996 -1.07688553]
mat_Sqrt:  [[ 7.96708024  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03311513 -0.08093521  0.91074704]
Stock Position:  0.03311513332561175
Bond Position:  [-3.50909948]


portfolio before change:  [-0.22286369]
curr_Stock_Price:  99.2896738101452
curr_Factors:  [99.28967381 -1.14848102 -1.08121585]
mat_Sqrt:  [[10.67969961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00097365 -0.02576447  0.3323127 ]
Stock Position:  0.0009736547513764975
Bond Position:  [-0.31953755]


portfolio before change:  [-0.22250171]
curr_Stock_Price:  99.82557995862237
curr_Factors:  [99.82557996 -1.40897913 -1.01623961]
mat_Sqrt:  [[ 8.83044774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03361651 -0.12787609 -1.15314859]
Stock Position:  0.03361651080526804
Bond Position:  [-3.5782894]


portfolio before change:  [-0.22108845]
curr_Stock_Price:  99.92085619579973
curr_Factors:  [99.9208562  -1.66401559 -1.0066166 ]
mat_Sqrt:  [[ 6.91536843  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01451753  0.0391318  -0.18675564]
Stock Position:  -0.014517529050160764
Bond Position:  [1.22951549]


portfolio before change:  [-0.20998119]
curr_Stock_Price:  99.1981198649385
curr_Factors:  [99.19811986 -1.29787843 -0.91955837]
mat_Sqrt:  [[10.80147028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00265134  0.01573957  0.01467322]
Stock Position:  -0.002651341097867493
Bond Position:  [0.05302686]


portfolio before change:  [-0.21198689]
curr_Stock_Price:  99.96460900621847
curr_Factors:  [99.96460901 -1.39605998 -0.94023248]
mat_Sqrt:  [[ 9.66512214  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00440022 -0.08734321  0.49036546]
Stock Position:  -0.004400216361253544
Bond Position:  [0.22787902]


portfolio before change:  [-0.20444163]
curr_Stock_Price:  98.27576124734803
curr_Factors:  [98.27576125 -1.72495345 -0.94061837]
mat_Sqrt:  [[ 6.83601937  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00950091 -0.00221373  0.25547329]
Stock Position:  -0.009500914514511231
Bond Position:  [0.72926798]


portfolio before change:  [-0.20823516]
curr_Stock_Price:  98.7134300242065
curr_Factors:  [98.71343002 -1.56576061 -0.94216451]
mat_Sqrt:  [[ 8.03892914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00745038 -0.01758797  0.22514796]
Stock Position:  -0.007450375291088563
Bond Position:  [0.52721694]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.20731439]
Stock Price:  98.625233442602
PL:  [-0.20731439]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 2.10720216e-02  7.81577870e-02  4.76554360e-02]
 [ 4.80698574e-01 -5.81875225e-01  6.22026774e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.44206150e-01 -4.93842784e-01 -3.06736745e-01]
 [-1.11133138e-01  6.00866223e-02 -7.59795462e-02]
 [-9.45816955e-02  3.44364202e-02  5.58535385e-02]
 [-1.13400914e-01 -2.38164728e-01  1.72338752e-01]
 [-1.13266304e-01  5.62701427e-02  1.39980876e-01]
 [-4.74588973e-02 -5.31167133e-02  3.52631331e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.85726231]
curr_Stock_Price:  100.09714079341843
curr_Factors:  [100.09714079  -0.7141567   -1.0857762 ]
mat_Sqrt:  [[16.5470563   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00282549 0.02522532 0.13594769]
Stock Position:  0.0028254897651101662
Bond Position:  [2.57443887]


portfolio before change:  [2.86309948]
curr_Stock_Price:  101.70734995579578
curr_Factors:  [101.70734996  -1.07768608  -1.14754191]
mat_Sqrt:  [[10.98874512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04449047 -0.18779942  1.77446925]
Stock Position:  0.04449047357022504
Bond Position:  [-1.66190868]


portfolio before change:  [2.90708657]
curr_Stock_Price:  102.71471720443444
curr_Factors:  [102.7147172   -0.995896    -1.18742297]
mat_Sqrt:  [[11.57255608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00304238 -0.02755111  0.34758667]
Stock Position:  0.0030423767698636566
Bond Position:  [2.5945897]


portfolio before change:  [2.91054808]
curr_Stock_Price:  103.42596850863774
curr_Factors:  [103.42596851  -1.14112819  -1.1871552 ]
mat_Sqrt:  [[10.08019586  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03777591 -0.15938707 -0.87503455]
Stock Position:  0.03777590667321511
Bond Position:  [-0.99646165]


portfolio before change:  [2.86104646]
curr_Stock_Price:  102.12875900511223
curr_Factors:  [102.12875901  -0.57722194  -1.20335261]
mat_Sqrt:  [[17.21291219  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00664485  0.01939287 -0.2167485 ]
Stock Position:  -0.006644852787651128
Bond Position:  [3.53967703]


portfolio before change:  [2.87075322]
curr_Stock_Price:  100.9343797756091
curr_Factors:  [100.93437978  -0.50293933  -1.23976492]
mat_Sqrt:  [[17.66819888  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00431008  0.01111431  0.1593346 ]
Stock Position:  -0.004310079109311242
Bond Position:  [3.30578838]


portfolio before change:  [2.87011881]
curr_Stock_Price:  101.46516121585192
curr_Factors:  [101.46516122  -1.00709586  -1.20556321]
mat_Sqrt:  [[11.10123582  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01142554 -0.07686734  0.49163449]
Stock Position:  -0.011425537426761374
Bond Position:  [4.02941281]


portfolio before change:  [2.87262116]
curr_Stock_Price:  101.42252538471149
curr_Factors:  [101.42252538  -1.07697953  -1.21706091]
mat_Sqrt:  [[10.2292859   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00715658  0.01816111  0.39932648]
Stock Position:  -0.007156582947050327
Bond Position:  [3.59845988]


portfolio before change:  [2.87129267]
curr_Stock_Price:  101.85962908056774
curr_Factors:  [101.85962908  -0.97101832  -1.28319102]
mat_Sqrt:  [[10.69082973  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0047801  -0.01714335  0.1005959 ]
Stock Position:  -0.0047801008371449625
Bond Position:  [3.35819197]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.86956614]
Stock Price:  102.57217568603349
PL:  [0.29739046]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 2.16877392e-02  8.42303478e-02  4.83291251e-02]
 [ 3.86201814e-01 -4.92452241e-01  4.90231825e-01]
 [ 4.76983220e-02 -7.88950342e-02  9.33695103e-02]
 [ 4.95513480e-01 -4.32049639e-01 -4.00764397e-01]
 [-1.32705271e-01  1.24281210e-01 -1.20486289e-01]
 [-4.73747170e-02  4.09026860e-02  3.87079206e-02]
 [-9.36631290e-02 -7.15674364e-02  1.65863339e-01]
 [-1.14812745e-01  9.85237469e-02  2.30836401e-01]
 [-1.41513237e-02 -2.25427602e-02  9.40009988e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.1988357]
curr_Stock_Price:  99.45963824073723
curr_Factors:  [99.45963824 -1.32539226 -0.95810509]
mat_Sqrt:  [[10.13763331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00480845 0.02718523 0.13786954]
Stock Position:  0.004808452507413505
Bond Position:  [-2.67708265]


portfolio before change:  [-2.19462145]
curr_Stock_Price:  100.6145066490773
curr_Factors:  [100.61450665  -1.42703062  -0.96494559]
mat_Sqrt:  [[ 9.20107419  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0419243  -0.15893828  1.39849494]
Stock Position:  0.04192429767642598
Bond Position:  [-6.41281398]


portfolio before change:  [-2.22291797]
curr_Stock_Price:  100.0160635513112
curr_Factors:  [100.01606355  -1.74121538  -0.93185168]
mat_Sqrt:  [[ 6.90512407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00733555 -0.02546326  0.26635722]
Stock Position:  0.007335554226446465
Bond Position:  [-2.95659122]


portfolio before change:  [-2.22170322]
curr_Stock_Price:  100.38323621342681
curr_Factors:  [100.38323621  -1.23870252  -0.879838  ]
mat_Sqrt:  [[12.06676164  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02697625 -0.13944342 -1.14326927]
Stock Position:  0.026976253998646574
Bond Position:  [-4.92966689]


portfolio before change:  [-2.21008618]
curr_Stock_Price:  100.90526904215261
curr_Factors:  [100.90526904  -1.36343029  -0.89754132]
mat_Sqrt:  [[10.51928814  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01254178  0.04011159 -0.34371385]
Stock Position:  -0.012541783671516982
Bond Position:  [-0.94455412]


portfolio before change:  [-2.19687265]
curr_Stock_Price:  99.81404340132335
curr_Factors:  [99.8140434  -1.31924151 -0.94858842]
mat_Sqrt:  [[10.33440856  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00301171  0.01320129  0.11042292]
Stock Position:  -0.0030117127481871144
Bond Position:  [-1.89626143]


portfolio before change:  [-2.19606771]
curr_Stock_Price:  99.23187811818029
curr_Factors:  [99.23187812 -1.01026823 -0.90298676]
mat_Sqrt:  [[14.64654288  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00508073 -0.02309829  0.47316194]
Stock Position:  -0.0050807251301180625
Bond Position:  [-1.69189781]


portfolio before change:  [-2.20654984]
curr_Stock_Price:  101.12845165443308
curr_Factors:  [101.12845165  -0.51619628  -0.91052606]
mat_Sqrt:  [[24.28039339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0019597  0.0317984  0.658512 ]
Stock Position:  -0.0019597041047868862
Bond Position:  [-2.008368]


portfolio before change:  [-2.20261291]
curr_Stock_Price:  98.60696899280632
curr_Factors:  [98.60696899 -0.61454933 -0.91997287]
mat_Sqrt:  [[21.25558612  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.04665336e-05 -7.27564458e-03  2.68158685e-01]
Stock Position:  2.0466533627581152e-05
Bond Position:  [-2.20463105]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.203776]
Stock Price:  95.65122197501125
PL:  [-2.203776]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 2.58183054e-02  1.06127764e-01  5.41702503e-02]
 [ 2.00747956e-01 -1.05956515e-01  2.26088625e-01]
 [-2.41720650e-01  2.95346818e-02 -1.75940454e-01]
 [ 4.10169622e-01 -3.44306732e-01 -3.94451771e-01]
 [-8.12947885e-02  1.12386493e-01  2.50041675e-02]
 [-3.11280534e-02  5.97029930e-02 -4.14769268e-02]
 [-1.82495849e-01  1.07644363e-01  1.77832406e-01]
 [-9.66271969e-02  5.95146171e-02  1.96042434e-01]
 [ 1.33631518e-03 -1.01016130e-02  9.63377624e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.96180156]
curr_Stock_Price:  98.60692376027758
curr_Factors:  [98.60692376 -1.21131413 -0.99106042]
mat_Sqrt:  [[10.90004512  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00537053 0.03425259 0.15453265]
Stock Position:  0.005370528282031528
Bond Position:  [-9.49137283]


portfolio before change:  [-8.96768725]
curr_Stock_Price:  98.394874282098
curr_Factors:  [98.39487428 -1.27753308 -1.05308587]
mat_Sqrt:  [[ 9.56747917  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02354537 -0.03419732  0.64496792]
Stock Position:  0.02354536829763271
Bond Position:  [-11.2844308]


portfolio before change:  [-8.98565737]
curr_Stock_Price:  97.87135302684075
curr_Factors:  [97.87135303 -1.58119874 -0.99424946]
mat_Sqrt:  [[ 7.44993788  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03645743  0.00953228 -0.50190914]
Stock Position:  -0.03645743190823574
Bond Position:  [-5.41751919]


portfolio before change:  [-9.00930746]
curr_Stock_Price:  98.44573933618251
curr_Factors:  [98.44573934 -1.80097762 -1.00657811]
mat_Sqrt:  [[ 5.9414297   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04365467 -0.11112452 -1.12526111]
Stock Position:  0.04365467349967939
Bond Position:  [-13.30692407]


portfolio before change:  [-9.01563651]
curr_Stock_Price:  98.45320877966851
curr_Factors:  [98.45320878 -1.90572125 -0.9729175 ]
mat_Sqrt:  [[ 5.53417579  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00962204  0.03627258  0.07132993]
Stock Position:  -0.009622035770243204
Bond Position:  [-8.06831621]


portfolio before change:  [-9.01680587]
curr_Stock_Price:  98.15537063784092
curr_Factors:  [98.15537064 -1.16889797 -1.03052688]
mat_Sqrt:  [[10.88218215  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00251858  0.01926906 -0.11832213]
Stock Position:  -0.002518582468693079
Bond Position:  [-8.76959347]


portfolio before change:  [-9.02072434]
curr_Stock_Price:  97.96978066914309
curr_Factors:  [97.96978067 -0.60731066 -1.01172749]
mat_Sqrt:  [[19.40674955  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00640103  0.03474207  0.50730635]
Stock Position:  -0.006401028027425262
Bond Position:  [-8.39361703]


portfolio before change:  [-9.02003989]
curr_Stock_Price:  97.20704236379763
curr_Factors:  [97.20704236 -0.47127915 -1.00586659]
mat_Sqrt:  [[22.19123584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200358  0.01920826  0.5592545 ]
Stock Position:  -0.0020035762182673274
Bond Position:  [-8.82527817]


portfolio before change:  [-9.024922]
curr_Stock_Price:  97.44080977240023
curr_Factors:  [97.44080977 -0.84008642 -0.94171721]
mat_Sqrt:  [[16.4026266   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00115464 -0.00326028  0.27482482]
Stock Position:  0.001154644064529504
Bond Position:  [-9.13743145]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.02689843]
Stock Price:  99.68689276720183
PL:  [-9.02689843]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 5.43739023e-02  1.13007717e-01  4.91155213e-02]
 [ 3.08277120e-01 -4.23075146e-01  4.30111348e-01]
 [-1.56849244e-01 -8.96243774e-03 -3.50591871e-02]
 [ 4.15326561e-01 -3.51557963e-01 -3.88354061e-01]
 [-7.82552659e-02  9.63137641e-02  6.93338438e-02]
 [-9.43244721e-02  3.38235149e-02  5.54526847e-02]
 [-6.03610487e-02 -2.76812076e-01  1.65661514e-01]
 [-1.10835158e-01  6.32579439e-02  1.62876483e-01]
 [-3.81013243e-02 -3.94875543e-02  8.83359927e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.28170887]
curr_Stock_Price:  99.19701735075778
curr_Factors:  [99.19701735 -1.16679657 -1.01191839]
mat_Sqrt:  [[11.22780165  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00779023 0.03647308 0.14011291]
Stock Position:  0.007790231116624245
Bond Position:  [-5.05447656]


portfolio before change:  [-4.28189625]
curr_Stock_Price:  99.4974565164518
curr_Factors:  [99.49745652 -1.17241118 -1.02347512]
mat_Sqrt:  [[11.07007783  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02797752 -0.13654692  1.22698795]
Stock Position:  0.02797752491089542
Bond Position:  [-7.06558882]


portfolio before change:  [-4.31099106]
curr_Stock_Price:  98.58382562739723
curr_Factors:  [98.58382563 -1.44668867 -1.0066418 ]
mat_Sqrt:  [[ 8.47886619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01955864 -0.00289261 -0.1000141 ]
Stock Position:  -0.019558643473531864
Bond Position:  [-2.38282516]


portfolio before change:  [-4.31269742]
curr_Stock_Price:  98.61013889925209
curr_Factors:  [98.6101389  -1.31069008 -1.00992623]
mat_Sqrt:  [[ 9.68480123  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02728942 -0.11346484 -1.10786604]
Stock Position:  0.027289424435407435
Bond Position:  [-7.00371136]


portfolio before change:  [-4.302127]
curr_Stock_Price:  99.12583862863181
curr_Factors:  [99.12583863 -0.96319654 -1.04286947]
mat_Sqrt:  [[13.33409293  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.003333    0.03108513  0.19779016]
Stock Position:  -0.0033330043364515195
Bond Position:  [-3.97174015]


portfolio before change:  [-4.31141822]
curr_Stock_Price:  101.31750980643112
curr_Factors:  [101.31750981  -0.84083069  -1.03843105]
mat_Sqrt:  [[15.47146739  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0049188   0.01091649  0.15819107]
Stock Position:  -0.004918799377194436
Bond Position:  [-3.81305772]


portfolio before change:  [-4.31213983]
curr_Stock_Price:  101.07651709223207
curr_Factors:  [101.07651709  -1.20143995  -1.02712717]
mat_Sqrt:  [[10.88418373  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0076303  -0.08934071  0.47258619]
Stock Position:  -0.007630297698981274
Bond Position:  [-3.54089592]


portfolio before change:  [-4.30345759]
curr_Stock_Price:  99.70656578006718
curr_Factors:  [99.70656578 -0.86367654 -0.96410778]
mat_Sqrt:  [[16.02976344  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00403472  0.02041641  0.46464127]
Stock Position:  -0.004034723383932978
Bond Position:  [-3.90116917]


portfolio before change:  [-4.30517724]
curr_Stock_Price:  99.64920905301996
curr_Factors:  [99.64920905 -0.5985657  -0.94488003]
mat_Sqrt:  [[21.28942302  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00132132 -0.01274455  0.251998  ]
Stock Position:  -0.0013213217922529719
Bond Position:  [-4.17350857]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.31062716]
Stock Price:  102.19411623878119
PL:  [-6.5047434]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.28100525e-02  1.12596378e-01  5.37628504e-02]
 [ 2.80251954e-01 -3.40424991e-01  3.76937210e-01]
 [-1.94298603e-01  1.65336545e-02 -9.70411236e-02]
 [ 3.28296578e-01 -2.82329045e-01 -2.81142981e-01]
 [-3.26873523e-02  9.95545434e-02  1.66248341e-01]
 [ 1.23435099e-02  7.58752200e-02 -1.56509077e-01]
 [-1.53205780e-01 -6.00607139e-02  1.90973603e-01]
 [-5.66692209e-02  2.01414914e-02  2.24200025e-01]
 [ 3.18653959e-01  2.30489197e-01  1.64655685e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.52641598]
curr_Stock_Price:  98.28356210171358
curr_Factors:  [98.2835621  -0.74554117 -1.06520029]
mat_Sqrt:  [[16.07259002  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00415415 0.03634032 0.15337045]
Stock Position:  0.004154152353233769
Bond Position:  [-11.93470087]


portfolio before change:  [-11.52834783]
curr_Stock_Price:  99.255359232357
curr_Factors:  [99.25535923 -1.36315011 -1.11446155]
mat_Sqrt:  [[ 8.33183942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03453079 -0.10987169  1.07529694]
Stock Position:  0.03453078793154759
Bond Position:  [-14.95571359]


portfolio before change:  [-11.56430398]
curr_Stock_Price:  98.43069152895924
curr_Factors:  [98.43069153 -1.13532789 -1.06907796]
mat_Sqrt:  [[10.85848514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01940714  0.00533621 -0.27683131]
Stock Position:  -0.019407138168624726
Bond Position:  [-9.65404595]


portfolio before change:  [-11.53533502]
curr_Stock_Price:  96.68920890381234
curr_Factors:  [96.6892089  -1.32833336 -1.09461801]
mat_Sqrt:  [[ 8.57242313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02487959 -0.09112131 -0.80202267]
Stock Position:  0.024879585258991237
Bond Position:  [-13.94092243]


portfolio before change:  [-11.53498172]
curr_Stock_Price:  96.98364725534982
curr_Factors:  [96.98364726 -1.30786193 -1.09758235]
mat_Sqrt:  [[ 8.75038848  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00246497 0.03213109 0.47426024]
Stock Position:  0.002464968749397183
Bond Position:  [-11.77404338]


portfolio before change:  [-11.54533808]
curr_Stock_Price:  95.17109891694467
curr_Factors:  [95.17109892 -0.30187533 -1.06243148]
mat_Sqrt:  [[24.32171329  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.69223569e-04  2.44886219e-02 -4.46476832e-01]
Stock Position:  -0.00016922356932855961
Bond Position:  [-11.52923289]


portfolio before change:  [-11.55093137]
curr_Stock_Price:  94.15010102334489
curr_Factors:  [94.15010102 -0.45705756 -1.08242371]
mat_Sqrt:  [[20.19447527  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00626326 -0.01938451  0.54479453]
Stock Position:  -0.006263262455247437
Bond Position:  [-10.96124457]


portfolio before change:  [-11.54756708]
curr_Stock_Price:  92.73769415587762
curr_Factors:  [92.73769416 -0.23967382 -1.10150998]
mat_Sqrt:  [[24.2542342   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.80083784e-04  6.50063840e-03  6.39580267e-01]
Stock Position:  -0.0002800837841797066
Bond Position:  [-11.52159276]


portfolio before change:  [-11.55151387]
curr_Stock_Price:  86.25587628750499
curr_Factors:  [86.25587629  0.1654505  -1.12746044]
mat_Sqrt:  [[32.9604464   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0121149  0.07439007 0.46971684]
Stock Position:  0.0121149017536901
Bond Position:  [-12.59649533]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.57586815]
Stock Price:  84.76560775531196
PL:  [-11.57586815]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-6.89265248e-02  6.17795655e-02  5.14641033e-02]
 [ 4.27463997e-01 -4.68818325e-01  5.16311205e-01]
 [ 7.08404147e-03 -7.26314085e-02  9.63376793e-02]
 [ 4.92278740e-01 -4.29228708e-01 -3.96701670e-01]
 [-8.92529593e-02  1.02131287e-01  3.06021824e-02]
 [-5.26584454e-02  4.54292015e-02  1.96103694e-02]
 [-1.06186581e-01 -9.27786425e-02  1.69099416e-01]
 [-9.75413882e-02  5.87245134e-02  1.91581076e-01]
 [ 3.20940175e-02  1.24249599e-02  1.04094082e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.39627818]
curr_Stock_Price:  101.29987597380344
curr_Factors:  [101.29987597  -1.22120206  -0.98809881]
mat_Sqrt:  [[11.12043401  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00411951  0.01993927  0.14681276]
Stock Position:  -0.004119511668432088
Bond Position:  [12.8135842]


portfolio before change:  [12.40268555]
curr_Stock_Price:  101.30012380485775
curr_Factors:  [101.3001238   -1.69111008  -1.01458532]
mat_Sqrt:  [[ 6.76926307  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06457992 -0.15131046  1.47289215]
Stock Position:  0.06457991598926831
Bond Position:  [5.86073206]


portfolio before change:  [12.3780273]
curr_Stock_Price:  100.87291134023438
curr_Factors:  [100.87291134  -1.30257766  -0.99233053]
mat_Sqrt:  [[10.1650282   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00117295 -0.02344169  0.27482458]
Stock Position:  0.0011729494002168273
Bond Position:  [12.25970848]


portfolio before change:  [12.38362692]
curr_Stock_Price:  100.41955110434643
curr_Factors:  [100.4195511   -1.50998607  -0.96057402]
mat_Sqrt:  [[ 8.48921757  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03812912 -0.13853297 -1.13167944]
Stock Position:  0.03812912143550442
Bond Position:  [8.55471766]


portfolio before change:  [12.35007864]
curr_Stock_Price:  99.42748238440767
curr_Factors:  [99.42748238 -1.0701392  -0.97450582]
mat_Sqrt:  [[12.86851381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00483031  0.03296273  0.08729951]
Stock Position:  -0.0048303055223962305
Bond Position:  [12.83034376]


portfolio before change:  [12.35575857]
curr_Stock_Price:  99.58002897307564
curr_Factors:  [99.58002897 -1.02882754 -0.90671407]
mat_Sqrt:  [[14.37398558  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00273983  0.01466221  0.05594293]
Stock Position:  -0.002739831509492854
Bond Position:  [12.62859107]


portfolio before change:  [12.35990717]
curr_Stock_Price:  100.37105407614378
curr_Factors:  [100.37105408  -1.01931375  -0.9280828 ]
mat_Sqrt:  [[14.31742488  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00632849 -0.02994418  0.48239357]
Stock Position:  -0.006328489143868567
Bond Position:  [12.99510429]


portfolio before change:  [12.38212316]
curr_Stock_Price:  97.88755201231743
curr_Factors:  [97.88755201 -0.67201195 -0.87260053]
mat_Sqrt:  [[20.88867011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0022236   0.01895326  0.54652748]
Stock Position:  -0.0022235965000271204
Bond Position:  [12.59978558]


portfolio before change:  [12.39039041]
curr_Stock_Price:  97.00349711271808
curr_Factors:  [97.00349711 -0.47358981 -0.89822816]
mat_Sqrt:  [[24.60449277  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00227106 0.00401014 0.29695144]
Stock Position:  0.0022710635761354274
Bond Position:  [12.1700893]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.39745066]
Stock Price:  97.43223296606072
PL:  [12.39745066]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-5.96737421e-02  5.65232081e-02  5.04963007e-02]
 [ 5.17400851e-01 -6.53771912e-01  6.91874466e-01]
 [ 2.45195062e-02 -7.04901838e-02  8.16482473e-02]
 [ 6.09954478e-01 -5.95096088e-01 -1.24723315e-01]
 [-1.35073705e-01  8.67086370e-02 -3.54836271e-02]
 [-4.83044789e-02 -7.95973478e-02 -6.45952679e-02]
 [-1.69405007e-01 -1.47087320e-01  2.05355771e-01]
 [-1.16135771e-01  8.55954634e-02  1.97776261e-01]
 [ 3.19469144e-03 -3.90228927e-02  1.99374745e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.197001]
curr_Stock_Price:  101.14866405881999
curr_Factors:  [101.14866406  -1.15412522  -1.0055256 ]
mat_Sqrt:  [[11.66905577  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00324178  0.01824279  0.14405189]
Stock Position:  -0.0032417769752239476
Bond Position:  [11.52490241]


portfolio before change:  [11.19995442]
curr_Stock_Price:  102.01561531301085
curr_Factors:  [102.01561531  -0.68428062  -0.98121592]
mat_Sqrt:  [[19.29082028  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02722427 -0.21100398  1.97372527]
Stock Position:  0.02722427012779888
Bond Position:  [8.42265376]


portfolio before change:  [11.32955013]
curr_Stock_Price:  106.6211868352995
curr_Factors:  [106.62118684  -1.2440688   -1.04030817]
mat_Sqrt:  [[10.8580341   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00246795 -0.02275061  0.23291972]
Stock Position:  0.0024679547064133333
Bond Position:  [11.06641387]


portfolio before change:  [11.33679094]
curr_Stock_Price:  107.31253550897713
curr_Factors:  [107.31253551  -1.23743232  -1.03195649]
mat_Sqrt:  [[11.09347007  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04173824 -0.19206644 -0.3558009 ]
Stock Position:  0.041738243730046184
Bond Position:  [6.85775417]


portfolio before change:  [11.2475125]
curr_Stock_Price:  105.09135515342915
curr_Factors:  [105.09135515  -1.16363224  -1.01798624]
mat_Sqrt:  [[11.8604762   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01050695  0.02798509 -0.10122491]
Stock Position:  -0.010506951150653357
Bond Position:  [12.35170224]


portfolio before change:  [11.25414988]
curr_Stock_Price:  105.04757636204681
curr_Factors:  [105.04757636  -0.9767934   -1.0240843 ]
mat_Sqrt:  [[14.20417106  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00547288 -0.02568993 -0.18427232]
Stock Position:  -0.005472876455774953
Bond Position:  [11.82906229]


portfolio before change:  [11.26563574]
curr_Stock_Price:  104.02985764502228
curr_Factors:  [104.02985765  -1.00166396  -1.00167685]
mat_Sqrt:  [[14.0319538   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01122517 -0.04747223  0.58582285]
Stock Position:  -0.0112251658901883
Bond Position:  [12.43338815]


portfolio before change:  [11.29186]
curr_Stock_Price:  102.24761142735284
curr_Factors:  [102.24761143  -0.84789433  -0.99717953]
mat_Sqrt:  [[16.15651836  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.003608    0.02762582  0.56420062]
Stock Position:  -0.0036080026104372796
Bond Position:  [11.66076965]


portfolio before change:  [11.29334994]
curr_Stock_Price:  103.45101926876114
curr_Factors:  [103.45101927  -1.24708419  -1.00812197]
mat_Sqrt:  [[10.84703858  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.46354518e-05 -1.25945845e-02  5.68760653e-02]
Stock Position:  -6.463545182986614e-05
Bond Position:  [11.30003654]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.29903268]
Stock Price:  102.9667110971061
PL:  [8.33232158]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.00431411e-02  9.15865641e-02  4.85301476e-02]
 [ 4.70194053e-01 -6.98010933e-01  6.70673287e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.46103911e-01 -4.96081044e-01 -2.91142959e-01]
 [-1.49389139e-01  1.11506471e-01 -1.29031881e-01]
 [-7.50818799e-02 -1.20272299e-02  2.54652709e-02]
 [-3.41703043e-01  2.08297141e-01  2.52918830e-01]
 [-1.16122400e-01  1.08752519e-01  2.50091204e-01]
 [-2.72910846e-02 -3.95293802e-02  6.66520152e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.66309033]
curr_Stock_Price:  99.6532740436332
curr_Factors:  [99.65327404 -1.0522436  -1.02406307]
mat_Sqrt:  [[12.49577046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00469314 0.02955944 0.138443  ]
Stock Position:  0.004693135597119031
Bond Position:  [-1.13077665]


portfolio before change:  [-0.65652631]
curr_Stock_Price:  101.1724169235739
curr_Factors:  [101.17241692  -0.27016203  -0.98829522]
mat_Sqrt:  [[28.74227135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01616482 -0.22528206  1.91324421]
Stock Position:  0.016164824740495753
Bond Position:  [-2.2919607]


portfolio before change:  [-0.61607238]
curr_Stock_Price:  103.74591837610662
curr_Factors:  [103.74591838  -0.8399276   -1.04009225]
mat_Sqrt:  [[15.83028639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0022241  -0.02755111  0.34758667]
Stock Position:  0.0022240959470405178
Bond Position:  [-0.84681325]


portfolio before change:  [-0.61661627]
curr_Stock_Price:  103.69179318262714
curr_Factors:  [103.69179318  -0.84281477  -1.07730148]
mat_Sqrt:  [[15.20017168  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0253558  -0.16010947 -0.83054982]
Stock Position:  0.025355798079080897
Bond Position:  [-3.24580444]


portfolio before change:  [-0.62844154]
curr_Stock_Price:  103.28944097054095
curr_Factors:  [103.28944097  -0.79667113  -1.11563034]
mat_Sqrt:  [[15.25997952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01002403  0.03598856 -0.36809204]
Stock Position:  -0.010024030399323655
Bond Position:  [0.40693496]


portfolio before change:  [-0.62299404]
curr_Stock_Price:  102.76630018715854
curr_Factors:  [102.76630019  -0.48115938  -1.08023333]
mat_Sqrt:  [[21.56485196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00335448 -0.00388177  0.07264533]
Stock Position:  -0.0033544793802351416
Bond Position:  [-0.27826661]


portfolio before change:  [-0.62422386]
curr_Stock_Price:  103.09143099340407
curr_Factors:  [103.09143099  -0.37463634  -1.10799268]
mat_Sqrt:  [[23.40587955  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01057673  0.06722761  0.72150702]
Stock Position:  -0.010576732518505954
Bond Position:  [0.46614664]


portfolio before change:  [-0.60994389]
curr_Stock_Price:  101.76334279556733
curr_Factors:  [101.7633428   -0.30540328  -1.11617296]
mat_Sqrt:  [[24.55888508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00174575  0.03509972  0.71344059]
Stock Position:  -0.0017457523498639544
Bond Position:  [-0.4322903]


portfolio before change:  [-0.60769636]
curr_Stock_Price:  100.3520749730645
curr_Factors:  [100.35207497  -0.34089448  -1.05584882]
mat_Sqrt:  [[24.82724056  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00087624 -0.01275805  0.19013965]
Stock Position:  -0.0008762431672214271
Bond Position:  [-0.51976354]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.60699758]
Stock Price:  99.25793957389162
PL:  [-0.60699758]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.08054712e-02  6.05864679e-02  5.08877110e-02]
 [ 1.03982446e-01  1.58918846e-01  6.13346147e-02]
 [-4.93074980e-01  4.04419064e-02 -3.93127778e-01]
 [ 2.36120772e-01 -2.08505480e-01 -1.53025556e-01]
 [ 5.11497803e-02  5.35986278e-02  1.74174610e-01]
 [ 4.56207431e-02  7.56007138e-02 -2.24610292e-01]
 [-1.61212432e-01  1.03574522e-01  1.73350869e-01]
 [-1.15081888e-01  9.96401259e-02  2.32568224e-01]
 [-1.83780227e-02 -2.61503742e-02  9.36666001e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.33858128]
curr_Stock_Price:  98.05507365034623
curr_Factors:  [98.05507365 -0.77919285 -0.88495336]
mat_Sqrt:  [[18.56694936  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0028847  0.0195542  0.14516848]
Stock Position:  0.002884698053151358
Bond Position:  [-13.62144056]


portfolio before change:  [-13.35436013]
curr_Stock_Price:  94.94680165488232
curr_Factors:  [94.94680165 -0.81932517 -0.87441189]
mat_Sqrt:  [[17.45418913  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00853328 0.05129084 0.17497058]
Stock Position:  0.008533280723172583
Bond Position:  [-14.16456784]


portfolio before change:  [-13.35719355]
curr_Stock_Price:  95.4449255096453
curr_Factors:  [95.44492551 -0.48095491 -0.84400023]
mat_Sqrt:  [[25.37068173  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02227243  0.01305257 -1.12148413]
Stock Position:  -0.02227242800676046
Bond Position:  [-11.23140332]


portfolio before change:  [-13.32708089]
curr_Stock_Price:  93.8407099787472
curr_Factors:  [93.84070998 -0.8401701  -0.82265206]
mat_Sqrt:  [[17.79249275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00912315 -0.06729485 -0.43653932]
Stock Position:  0.009123148784495846
Bond Position:  [-14.18320364]


portfolio before change:  [-13.32026073]
curr_Stock_Price:  95.36579018588522
curr_Factors:  [95.36579019 -0.90415435 -0.80733873]
mat_Sqrt:  [[17.22267519  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00566949 0.01729888 0.49687168]
Stock Position:  0.005669490758963957
Bond Position:  [-13.86093619]


portfolio before change:  [-13.33503955]
curr_Stock_Price:  93.981781836359
curr_Factors:  [ 9.39817818e+01 -8.15587926e-02 -8.03218480e-01]
mat_Sqrt:  [[38.79625342  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 3.91900996e-04  2.44000255e-02 -6.40750643e-01]
Stock Position:  0.0003919009963009251
Bond Position:  [-13.3718711]


portfolio before change:  [-13.33955958]
curr_Stock_Price:  99.51272397376486
curr_Factors:  [99.51272397 -0.7916674  -0.86528594]
mat_Sqrt:  [[18.9789823   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00551585  0.03342853  0.49452178]
Stock Position:  -0.005515852854139469
Bond Position:  [-12.79066203]


portfolio before change:  [-13.35538624]
curr_Stock_Price:  101.22229394228489
curr_Factors:  [101.22229394  -0.54890219  -0.85287917]
mat_Sqrt:  [[24.91668528  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00189713  0.03215871  0.66345241]
Stock Position:  -0.001897128040893103
Bond Position:  [-13.16335459]


portfolio before change:  [-13.35788009]
curr_Stock_Price:  99.06668063809242
curr_Factors:  [99.06668064 -0.50440263 -0.87213015]
mat_Sqrt:  [[25.00961592  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.83782541e-04 -8.43999700e-03  2.67204738e-01]
Stock Position:  -0.00018378254113041222
Bond Position:  [-13.33967336]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.36472432]
Stock Price:  100.00650928958598
PL:  [-13.37123361]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 1.73995600e-02  7.50692002e-02  4.88892625e-02]
 [ 3.17878396e-01 -4.04520573e-01  4.02626834e-01]
 [ 5.80124074e-04 -6.86265102e-02  8.83149821e-02]
 [ 5.03001239e-01 -4.42557642e-01 -3.89386678e-01]
 [-1.43471839e-01  1.16043392e-01 -1.26015130e-01]
 [-5.19382235e-02 -7.06515595e-02 -5.52438130e-02]
 [-2.15648363e-01 -2.25438485e-01  2.68943918e-01]
 [-1.16880200e-01  1.10853226e-01  2.54346968e-01]
 [-2.11452815e-02 -4.80360032e-02  2.07772172e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.30084465]
curr_Stock_Price:  99.19460459895842
curr_Factors:  [99.1946046  -1.6249477  -0.96248421]
mat_Sqrt:  [[ 7.46071844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00572364 0.02422848 0.13946746]
Stock Position:  0.005723641170150251
Bond Position:  [-4.86859898]


portfolio before change:  [-4.29946294]
curr_Stock_Price:  99.86142162223864
curr_Factors:  [99.86142162 -1.73814647 -0.96451309]
mat_Sqrt:  [[ 6.69341277  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04743348 -0.13055845  1.14858229]
Stock Position:  0.04743347658522328
Bond Position:  [-9.03623734]


portfolio before change:  [-4.2930613]
curr_Stock_Price:  100.09165748547798
curr_Factors:  [100.09165749  -1.36596742  -0.98155191]
mat_Sqrt:  [[ 9.56936655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0004806  -0.02214911  0.25193806]
Stock Position:  0.000480597806781796
Bond Position:  [-4.34116513]


portfolio before change:  [-4.29482884]
curr_Stock_Price:  100.93142428724764
curr_Factors:  [100.93142429  -1.29675498  -1.02950824]
mat_Sqrt:  [[ 9.85696288  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03380162 -0.14283486 -1.11081181]
Stock Position:  0.033801620220622
Bond Position:  [-7.70647451]


portfolio before change:  [-4.259627]
curr_Stock_Price:  102.08687305495334
curr_Factors:  [102.08687305  -1.01603672  -1.04048063]
mat_Sqrt:  [[13.05677032  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0111442   0.03745284 -0.35948609]
Stock Position:  -0.011144203957945355
Bond Position:  [-3.12195006]


portfolio before change:  [-4.2922992]
curr_Stock_Price:  104.87853381836291
curr_Factors:  [104.87853382  -1.18583847  -1.06064574]
mat_Sqrt:  [[11.09304855  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00699866 -0.02280269 -0.15759522]
Stock Position:  -0.006998663030997712
Bond Position:  [-3.55828968]


portfolio before change:  [-4.29465877]
curr_Stock_Price:  104.96140443077937
curr_Factors:  [104.96140443  -0.9616349   -1.13760707]
mat_Sqrt:  [[12.86294552  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01607469 -0.07275996  0.76722214]
Stock Position:  -0.01607468937167943
Bond Position:  [-2.6074368]


portfolio before change:  [-4.26739861]
curr_Stock_Price:  103.18443642627797
curr_Factors:  [103.18443643  -0.36616575  -1.13788691]
mat_Sqrt:  [[22.93044217  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00184619  0.03577772  0.7255811 ]
Stock Position:  -0.0018461930244221215
Bond Position:  [-4.07690022]


portfolio before change:  [-4.27817996]
curr_Stock_Price:  107.91980110970223
curr_Factors:  [107.91980111  -0.59910931  -1.17988644]
mat_Sqrt:  [[18.21768126  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146613 -0.01550355  0.05927162]
Stock Position:  -0.0014661282916329438
Bond Position:  [-4.11995569]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.28257864]
Stock Price:  109.51460009953084
PL:  [-13.79717874]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 5.99587271e-02  1.36048257e-01  5.19557413e-02]
 [ 1.04620697e-01  1.49601555e-01  5.51276334e-02]
 [-4.84463574e-01  4.06364654e-02 -3.89332051e-01]
 [ 1.11344050e-01 -1.31600489e-01  2.52287499e-02]
 [ 3.71690762e-01 -1.38017329e-01  2.52056915e-01]
 [ 2.66885315e-01 -3.36754154e-03 -3.50498533e-01]
 [-6.82504829e-02 -1.69417968e-01  2.97474124e-01]
 [-3.88272150e-02 -2.47129822e-02  1.75204252e-01]
 [ 1.44233865e-01  1.00044241e-01  1.24530970e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.48832661]
curr_Stock_Price:  98.79270814163615
curr_Factors:  [98.79270814 -0.94702507 -0.96750325]
mat_Sqrt:  [[14.56316619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0067523  0.04390939 0.14821527]
Stock Position:  0.00675230106812043
Bond Position:  [-8.15540471]


portfolio before change:  [-7.50417298]
curr_Stock_Price:  97.04994616141931
curr_Factors:  [97.04994616 -0.80772829 -0.9532875 ]
mat_Sqrt:  [[16.67999283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00877763 0.04828369 0.15726379]
Stock Position:  0.008777633739792786
Bond Position:  [-8.35604186]


portfolio before change:  [-7.52100466]
curr_Stock_Price:  95.60848545032323
curr_Factors:  [ 9.56084855e+01  2.93230203e-02 -9.68144291e-01]
mat_Sqrt:  [[37.39138407  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01486013  0.01311536 -1.11065597]
Stock Position:  -0.014860128236276141
Bond Position:  [-6.10025031]


portfolio before change:  [-7.45230284]
curr_Stock_Price:  90.77994631521392
curr_Factors:  [90.77994632 -0.15565604 -0.93530062]
mat_Sqrt:  [[30.49253046  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00293944 -0.04247388  0.0719706 ]
Stock Position:  0.0029394415129336527
Bond Position:  [-7.71914518]


portfolio before change:  [-7.45996285]
curr_Stock_Price:  89.48736260468011
curr_Factors:  [89.4873626  -0.5260994  -0.95393847]
mat_Sqrt:  [[20.36992499  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01938981 -0.0445449   0.71904822]
Stock Position:  0.019389810987670474
Bond Position:  [-9.1951059]


portfolio before change:  [-7.48434508]
curr_Stock_Price:  88.46705723989878
curr_Factors:  [88.46705724 -0.31280767 -0.9188925 ]
mat_Sqrt:  [[25.81433814  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00754049 -0.00108687 -0.99987475]
Stock Position:  0.0075404879090306045
Bond Position:  [-8.15142986]


portfolio before change:  [-7.45927307]
curr_Stock_Price:  92.33268806833291
curr_Factors:  [92.33268807 -1.24987566 -0.95351177]
mat_Sqrt:  [[10.19615621  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0041301  -0.05467941  0.84861088]
Stock Position:  -0.0041300984960552425
Bond Position:  [-7.07792998]


portfolio before change:  [-7.46174284]
curr_Stock_Price:  92.0735952646833
curr_Factors:  [92.07359526 -1.01525298 -0.95110912]
mat_Sqrt:  [[12.88709091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00062918 -0.00797608  0.49980896]
Stock Position:  -0.0006291810301884283
Bond Position:  [-7.40381188]


portfolio before change:  [-7.46456816]
curr_Stock_Price:  90.6789044319702
curr_Factors:  [90.67890443 -1.18849173 -0.95642874]
mat_Sqrt:  [[10.6164456   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01790383 0.03228914 0.3552522 ]
Stock Position:  0.017903834813105486
Bond Position:  [-9.08806829]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.48726224]
Stock Price:  89.66521596403499
PL:  [-7.48726224]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-5.04983186e-02  5.13107972e-02  4.95365896e-02]
 [ 5.01776611e-01 -6.23387192e-01  6.62251534e-01]
 [-2.13896276e-02 -5.41253024e-02  5.84800729e-02]
 [ 5.71806331e-01 -5.20994415e-01 -2.65740674e-01]
 [-1.37561009e-01  9.17489038e-02 -5.36223147e-02]
 [-4.54175732e-02 -8.70222912e-02 -7.61032541e-02]
 [-1.74662647e-01 -4.42304728e-01  3.31398389e-01]
 [-1.17019852e-01  7.69928976e-02  1.75766898e-01]
 [-1.07255401e-02 -4.39232439e-02  2.11582439e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.39440896]
curr_Stock_Price:  101.04746853841912
curr_Factors:  [101.04746854  -0.90955334  -0.99390753]
mat_Sqrt:  [[15.06131483  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198608  0.01656049  0.1413141 ]
Stock Position:  -0.0019860770694320926
Bond Position:  [10.59509702]


portfolio before change:  [10.39804941]
curr_Stock_Price:  101.88249607835286
curr_Factors:  [101.88249608  -0.85194735  -1.09190719]
mat_Sqrt:  [[14.58459161  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03494851 -0.20119735  1.88921929]
Stock Position:  0.034948511094642525
Bond Position:  [6.83740786]


portfolio before change:  [10.42336137]
curr_Stock_Price:  102.50891501586483
curr_Factors:  [102.50891502  -1.27997233  -1.09185635]
mat_Sqrt:  [[ 9.56510035  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00214328 -0.01746887  0.16682737]
Stock Position:  -0.0021432826665470075
Bond Position:  [10.64306695]


portfolio before change:  [10.42516852]
curr_Stock_Price:  104.14925918339766
curr_Factors:  [104.14925918  -1.37304479  -1.02688238]
mat_Sqrt:  [[ 9.44889579  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04351987 -0.16815022 -0.75808418]
Stock Position:  0.043519868611683006
Bond Position:  [5.89260644]


portfolio before change:  [10.4600403]
curr_Stock_Price:  104.8828262324845
curr_Factors:  [104.88282623  -1.44722075  -1.09188113]
mat_Sqrt:  [[ 8.27916331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01567531  0.02961183 -0.15296954]
Stock Position:  -0.015675309987318208
Bond Position:  [12.10411111]


portfolio before change:  [10.45956381]
curr_Stock_Price:  105.29940839460929
curr_Factors:  [105.29940839  -1.11043192  -1.09010224]
mat_Sqrt:  [[11.66127639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00675016 -0.02808632 -0.2171014 ]
Stock Position:  -0.006750156078354169
Bond Position:  [11.17035125]


portfolio before change:  [10.45796583]
curr_Stock_Price:  106.36376244752331
curr_Factors:  [106.36376245  -1.32295575  -1.0891629 ]
mat_Sqrt:  [[ 9.53287441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02069694 -0.14275324  0.94538736]
Stock Position:  -0.020696937761784603
Bond Position:  [12.65937]


portfolio before change:  [10.47973829]
curr_Stock_Price:  105.61770073346437
curr_Factors:  [105.61770073  -1.17504101  -1.00872691]
mat_Sqrt:  [[11.89428532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00550058  0.02484935  0.50141403]
Stock Position:  -0.005500580563580124
Bond Position:  [11.06069696]


portfolio before change:  [10.48503252]
curr_Stock_Price:  105.66087731678984
curr_Factors:  [105.66087732  -0.76033718  -0.9811603 ]
mat_Sqrt:  [[18.51788857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00083014 -0.01417617  0.06035858]
Stock Position:  -0.0008301392553774629
Bond Position:  [10.57274577]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.49122236]
Stock Price:  104.57413713586388
PL:  [5.91708523]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.53047339e-02  9.62189463e-02  4.86567363e-02]
 [ 3.18060859e-01 -4.51928770e-01  4.48674732e-01]
 [-2.42628414e-01  3.45243552e-02 -2.08479589e-01]
 [ 4.24267575e-01 -3.63460931e-01 -3.79269640e-01]
 [-2.88478149e-02  6.19041515e-02  1.45516080e-01]
 [-4.40892446e-02  6.39176524e-02 -5.96182813e-02]
 [-2.30455813e-01  1.75465063e-01  1.82208584e-01]
 [-1.02252625e-01  4.47281224e-02  1.46185390e-01]
 [-3.33087078e-02 -3.60357227e-02  8.84018826e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.23714036]
curr_Stock_Price:  99.7069803180421
curr_Factors:  [99.70698032 -0.77593484 -1.00449179]
mat_Sqrt:  [[16.80722853  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00386009 0.03105453 0.13880413]
Stock Position:  0.0038600866709679734
Bond Position:  [-0.62201795]


portfolio before change:  [-0.23812732]
curr_Stock_Price:  99.53188861739807
curr_Factors:  [99.53188862 -0.97754575 -1.01822056]
mat_Sqrt:  [[13.52732578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02346337 -0.14585938  1.27994412]
Stock Position:  0.023463368626136953
Bond Position:  [-2.57348071]


portfolio before change:  [-0.28318617]
curr_Stock_Price:  97.66635148973512
curr_Factors:  [97.66635149 -0.8438492  -1.01146123]
mat_Sqrt:  [[15.27544544  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0182081   0.01114269 -0.59473424]
Stock Position:  -0.018208102590237148
Bond Position:  [1.49513278]


portfolio before change:  [-0.3035907]
curr_Stock_Price:  98.82804775561196
curr_Factors:  [98.82804776 -0.52368354 -0.98874679]
mat_Sqrt:  [[21.77910703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01251926 -0.11730651 -1.08195072]
Stock Position:  0.012519261292297731
Bond Position:  [-1.54084485]


portfolio before change:  [-0.32366917]
curr_Stock_Price:  97.28579608823314
curr_Factors:  [97.28579609 -0.39657677 -0.97910656]
mat_Sqrt:  [[24.58089875  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00054887 0.01997948 0.41511687]
Stock Position:  0.0005488677458273902
Bond Position:  [-0.3770662]


portfolio before change:  [-0.32344604]
curr_Stock_Price:  98.03589054213074
curr_Factors:  [98.03589054 -0.61407765 -0.97108578]
mat_Sqrt:  [[20.08895608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00215101  0.02062933 -0.17007436]
Stock Position:  -0.0021510146651523387
Bond Position:  [-0.1125694]


portfolio before change:  [-0.32816687]
curr_Stock_Price:  100.20441467203794
curr_Factors:  [100.20441467  -0.55659496  -1.03520254]
mat_Sqrt:  [[20.39754895  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00771887  0.05663111  0.51979037]
Stock Position:  -0.007718867894372831
Bond Position:  [0.44529777]


portfolio before change:  [-0.31512328]
curr_Stock_Price:  98.54343466229423
curr_Factors:  [98.54343466 -0.9174112  -1.04743837]
mat_Sqrt:  [[13.8135202   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0045812   0.01443594  0.41702623]
Stock Position:  -0.004581204976580474
Bond Position:  [0.13632439]


portfolio before change:  [-0.3148717]
curr_Stock_Price:  98.50340165048394
curr_Factors:  [98.50340165 -0.97901489 -1.03886128]
mat_Sqrt:  [[13.09479619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00172737 -0.01163048  0.25218596]
Stock Position:  -0.0017273663362840864
Bond Position:  [-0.14472024]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.31414384]
Stock Price:  98.04012778890075
PL:  [-0.31414384]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-3.84086541e-02  2.44751914e-02  4.52225088e-02]
 [ 4.53419765e-01 -5.80362680e-01  5.96181667e-01]
 [-3.90068831e-03 -6.03594522e-02  6.73059156e-02]
 [ 5.12407874e-01 -4.52889256e-01 -3.80222456e-01]
 [-1.56163425e-01  1.33558175e-01 -1.95820883e-01]
 [-8.61936132e-02  1.44495172e-02  4.27816564e-02]
 [-3.99646853e-02 -4.16222233e-01  2.47535404e-01]
 [-1.16369632e-01  4.33217202e-02  1.01660620e-01]
 [ 8.54422154e-04 -3.97475054e-02  2.04316534e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.41494608]
curr_Stock_Price:  100.92397210167748
curr_Factors:  [100.9239721   -0.69456355  -1.06162237]
mat_Sqrt:  [[17.42980319  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138737  0.00789933  0.12900723]
Stock Position:  -0.001387374853360903
Bond Position:  [9.55496546]


portfolio before change:  [9.41918641]
curr_Stock_Price:  101.31200557616837
curr_Factors:  [101.31200558  -1.01564745  -1.07407642]
mat_Sqrt:  [[12.53445245  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03643149 -0.18731125  1.70074035]
Stock Position:  0.03643149185514446
Bond Position:  [5.7282389]


portfolio before change:  [9.45856001]
curr_Stock_Price:  102.31412674456564
curr_Factors:  [102.31412674  -1.35374194  -1.1208893 ]
mat_Sqrt:  [[ 8.61423885  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00028821 -0.01948093  0.19200504]
Stock Position:  -0.00028821436754069814
Bond Position:  [9.48804841]


portfolio before change:  [9.46362302]
curr_Stock_Price:  101.2114904593619
curr_Factors:  [101.21149046  -1.70094033  -1.13324402]
mat_Sqrt:  [[ 5.94783891  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05755866 -0.14616938 -1.08466883]
Stock Position:  0.05755866344886498
Bond Position:  [3.6380249]


portfolio before change:  [9.52418863]
curr_Stock_Price:  102.23212135033593
curr_Factors:  [102.23212135  -1.67689372  -1.17633958]
mat_Sqrt:  [[ 5.89445824  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02864941  0.04310572 -0.55862247]
Stock Position:  -0.028649409420485307
Bond Position:  [12.45307854]


portfolio before change:  [9.52437236]
curr_Stock_Price:  102.44309849771145
curr_Factors:  [102.4430985   -1.56123097  -1.17728389]
mat_Sqrt:  [[ 6.62461762  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01124765  0.00466356  0.12204416]
Stock Position:  -0.011247645239519018
Bond Position:  [10.67661599]


portfolio before change:  [9.5262483]
curr_Stock_Price:  102.75104752989168
curr_Factors:  [102.75104753  -1.72734828  -1.13964136]
mat_Sqrt:  [[ 5.84343851  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01273184 -0.13433515  0.70614961]
Stock Position:  -0.01273184270148878
Bond Position:  [10.83445848]


portfolio before change:  [9.52008111]
curr_Stock_Price:  103.66103195858511
curr_Factors:  [103.66103196  -1.68764816  -1.09404319]
mat_Sqrt:  [[ 6.42010783  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01351616  0.01398203  0.29000945]
Stock Position:  -0.013516164922982472
Bond Position:  [10.92118071]


portfolio before change:  [9.52613981]
curr_Stock_Price:  103.61688118831023
curr_Factors:  [103.61688119  -1.14158221  -1.09651677]
mat_Sqrt:  [[11.0518881   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00027945 -0.01282845  0.05828582]
Stock Position:  -0.00027944633501897256
Bond Position:  [9.55509517]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.53099127]
Stock Price:  103.35665779242005
PL:  [6.17433348]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 4.56190541e-02  5.17598245e-03  3.76200940e-02]
 [ 3.74874022e-01 -6.13239689e-01  5.46695071e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.30042255e-01 -4.74797591e-01 -3.50234058e-01]
 [-1.17474436e-01  7.23957103e-02 -6.14074854e-02]
 [-9.45816955e-02  3.44364202e-02  5.58535385e-02]
 [-3.06838229e-01  2.48480733e-01  2.19697801e-01]
 [-1.14872568e-01  1.30920570e-01  3.10759840e-01]
 [ 3.99958720e-02  1.75536550e-02  1.07027482e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.11960725]
curr_Stock_Price:  98.08268318281276
curr_Factors:  [98.08268318 -0.3490578  -0.97055289]
mat_Sqrt:  [[26.21154951  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0020737  0.00167054 0.10731966]
Stock Position:  0.002073695285117481
Bond Position:  [-13.32300085]


portfolio before change:  [-13.12266987]
curr_Stock_Price:  99.81898060932737
curr_Factors:  [ 9.98189806e+01 -4.43235056e-02 -9.87145666e-01]
mat_Sqrt:  [[35.5837538   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01015325 -0.19792226  1.55956887]
Stock Position:  0.010153247476937284
Bond Position:  [-14.13615668]


portfolio before change:  [-13.0980863]
curr_Stock_Price:  102.93654610050321
curr_Factors:  [102.9365461   -0.3750463   -0.92872746]
mat_Sqrt:  [[27.9478138   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00125978 -0.02755111  0.34758667]
Stock Position:  0.0012597792462657911
Bond Position:  [-13.22776362]


portfolio before change:  [-13.10553097]
curr_Stock_Price:  102.27838670746549
curr_Factors:  [102.27838671  -0.39246484  -0.8880329 ]
mat_Sqrt:  [[28.42305563  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01272324 -0.15324026 -0.99912028]
Stock Position:  0.012723240594125688
Bond Position:  [-14.40684349]


portfolio before change:  [-13.11146866]
curr_Stock_Price:  102.37800985725008
curr_Factors:  [102.37800986  -0.27909257  -0.92865666]
mat_Sqrt:  [[30.59763485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00376603  0.02336562 -0.17517846]
Stock Position:  -0.0037660255381088714
Bond Position:  [-12.72591046]


portfolio before change:  [-13.11144492]
curr_Stock_Price:  100.68171563822769
curr_Factors:  [100.68171564  -0.33621947  -0.99900806]
mat_Sqrt:  [[26.48918869  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00287481  0.01111431  0.1593346 ]
Stock Position:  -0.002874808127008969
Bond Position:  [-12.82200431]


portfolio before change:  [-13.12328353]
curr_Stock_Price:  102.56914791921449
curr_Factors:  [102.56914792  -0.44843642  -0.99202276]
mat_Sqrt:  [[24.29032205  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00869777  0.08019681  0.62673668]
Stock Position:  -0.008697772117541615
Bond Position:  [-12.23116046]


portfolio before change:  [-13.14079604]
curr_Stock_Price:  103.8792996955377
curr_Factors:  [ 1.03879300e+02  3.90549977e-03 -9.85802002e-01]
mat_Sqrt:  [[38.91318514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.35130003e-04  4.22544323e-02  8.86511325e-01]
Stock Position:  -0.0006351300034839769
Bond Position:  [-13.07481918]


portfolio before change:  [-13.14329399]
curr_Stock_Price:  97.51666967197384
curr_Factors:  [ 9.75166697e+01 -9.03644955e-02 -9.07958804e-01]
mat_Sqrt:  [[35.934579    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00182069 0.00566542 0.30531961]
Stock Position:  0.0018206944909104495
Bond Position:  [-13.32084205]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.14511356]
Stock Price:  100.17637884629552
PL:  [-13.32149241]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 4.60248885e-02  1.05657125e-01  4.89146524e-02]
 [ 3.37568387e-01 -4.77624355e-01  4.48458898e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.75105635e-01 -4.12081942e-01 -4.03466263e-01]
 [-1.48360348e-01  1.15168615e-01 -1.35186769e-01]
 [-8.38732761e-02  8.92067878e-03  3.91656723e-02]
 [-3.09271356e-01  1.45981523e-01  2.43506399e-01]
 [-1.15139866e-01  8.83238321e-02  2.06852494e-01]
 [-4.91426904e-02 -4.99128344e-02  6.71079266e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.23945848]
curr_Stock_Price:  99.45451628221474
curr_Factors:  [99.45451628 -0.95456622 -1.01248033]
mat_Sqrt:  [[13.91063784  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00557679 0.03410069 0.13953989]
Stock Position:  0.005576791038639859
Bond Position:  [-2.79409554]


portfolio before change:  [-2.23822639]
curr_Stock_Price:  99.92602223406627
curr_Factors:  [99.92602223 -1.34884935 -0.98587077]
mat_Sqrt:  [[ 9.67659434  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03426981 -0.1541526   1.27932841]
Stock Position:  0.0342698062136993
Bond Position:  [-5.66267181]


portfolio before change:  [-2.24283816]
curr_Stock_Price:  99.87408954533203
curr_Factors:  [99.87408955 -1.23152865 -0.97341826]
mat_Sqrt:  [[11.01175549  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00319732 -0.02755111  0.34758667]
Stock Position:  0.0031973172516699656
Bond Position:  [-2.5621673]


portfolio before change:  [-2.24328334]
curr_Stock_Price:  100.13562758415425
curr_Factors:  [100.13562758  -1.05714705  -0.97304111]
mat_Sqrt:  [[13.1488905   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02347214 -0.13299887 -1.15097695]
Stock Position:  0.02347213669084715
Bond Position:  [-4.59368048]


portfolio before change:  [-2.19263411]
curr_Stock_Price:  102.39135066071267
curr_Factors:  [102.39135066  -0.99773565  -1.02553519]
mat_Sqrt:  [[13.53841775  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01126029  0.03717051 -0.38565022]
Stock Position:  -0.011260291923003693
Bond Position:  [-1.03967761]


portfolio before change:  [-2.19131527]
curr_Stock_Price:  102.22804985976855
curr_Factors:  [102.22804986  -0.81681564  -1.03967863]
mat_Sqrt:  [[15.9699979   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0046373   0.00287914  0.11172876]
Stock Position:  -0.004637301222381817
Bond Position:  [-1.71725301]


portfolio before change:  [-2.19696618]
curr_Stock_Price:  103.26142449526188
curr_Factors:  [103.2614245   -0.49288689  -1.08016953]
mat_Sqrt:  [[21.41748097  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01072803  0.04711533  0.69465598]
Stock Position:  -0.010728034145263549
Bond Position:  [-1.08917409]


portfolio before change:  [-2.18053989]
curr_Stock_Price:  101.67949380731567
curr_Factors:  [101.67949381  -0.64072569  -1.11291597]
mat_Sqrt:  [[17.60501812  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0031177   0.02850639  0.59009259]
Stock Position:  -0.0031177048526162816
Bond Position:  [-1.86353324]


portfolio before change:  [-2.17765007]
curr_Stock_Price:  100.45364868253387
curr_Factors:  [100.45364868  -0.64396234  -1.06904959]
mat_Sqrt:  [[18.11398842  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0025192  -0.0161093   0.19144024]
Stock Position:  -0.002519199850268606
Bond Position:  [-1.92458725]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.16997977]
Stock Price:  97.02683031441808
PL:  [-2.16997977]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-3.17012389e-02  4.06324776e-02  4.75704932e-02]
 [ 4.54172952e-01 -6.26189853e-01  6.19882066e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.98175338e-01 -4.39255407e-01 -3.84011516e-01]
 [-1.49207749e-01  1.26591964e-01 -1.63683848e-01]
 [-8.84869749e-02  1.99140794e-02  4.63556024e-02]
 [-2.74980173e-01  5.26182307e-03  2.50976509e-01]
 [-1.17158707e-01  8.41834307e-02  1.91592410e-01]
 [-2.35109817e-02 -4.62292000e-02  2.86704823e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.76052]
curr_Stock_Price:  100.71537233943828
curr_Factors:  [100.71537234  -0.87260546  -1.04647321]
mat_Sqrt:  [[14.77918504  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00092677  0.01311408  0.13570538]
Stock Position:  -0.0009267684771307422
Bond Position:  [7.85385984]


portfolio before change:  [7.76402402]
curr_Stock_Price:  101.17275924972346
curr_Factors:  [101.17275925  -0.7100217   -1.02616669]
mat_Sqrt:  [[17.82569844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02540632 -0.20210191  1.76835099]
Stock Position:  0.025406318949998185
Bond Position:  [5.19359663]


portfolio before change:  [7.79018198]
curr_Stock_Price:  102.1001076694277
curr_Factors:  [102.10010767  -0.75474917  -1.07968948]
mat_Sqrt:  [[16.30570642  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00215925 -0.02755111  0.34758667]
Stock Position:  0.002159248724451206
Bond Position:  [7.56972246]


portfolio before change:  [7.79183519]
curr_Stock_Price:  101.11245157539166
curr_Factors:  [101.11245158  -1.24782478  -1.09862308]
mat_Sqrt:  [[ 9.67732403  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03411343 -0.14176907 -1.09547797]
Stock Position:  0.03411342642499063
Bond Position:  [4.34254302]


portfolio before change:  [7.82407811]
curr_Stock_Price:  101.99395496451068
curr_Factors:  [101.99395496  -1.39878556  -1.08229536]
mat_Sqrt:  [[ 8.53207534  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01837526  0.04085738 -0.46694446]
Stock Position:  -0.018375259424376313
Bond Position:  [9.69824349]


portfolio before change:  [7.82661777]
curr_Stock_Price:  102.11970399446855
curr_Factors:  [102.11970399  -1.29326447  -1.06112004]
mat_Sqrt:  [[ 9.69646306  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00773063  0.00642724  0.13223963]
Stock Position:  -0.007730626336678892
Bond Position:  [8.61606705]


portfolio before change:  [7.81646117]
curr_Stock_Price:  103.99092539585459
curr_Factors:  [103.9909254   -0.6612789   -1.10071094]
mat_Sqrt:  [[17.85553961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01247096  0.00169825  0.71596612]
Stock Position:  -0.012470961270931478
Bond Position:  [9.11332797]


portfolio before change:  [7.81865602]
curr_Stock_Price:  104.18040179217454
curr_Factors:  [104.18040179  -0.93845881  -1.11339608]
mat_Sqrt:  [[13.38679992  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00454673  0.02717009  0.54655982]
Stock Position:  -0.004546732583937109
Bond Position:  [8.29233645]


portfolio before change:  [7.82795187]
curr_Stock_Price:  103.04801843320867
curr_Factors:  [103.04801843  -0.70294099  -1.14127631]
mat_Sqrt:  [[16.29694682  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00166259 -0.01492041  0.08178891]
Stock Position:  -0.0016625899468117476
Bond Position:  [7.99927847]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.83291887]
Stock Price:  102.46678222443273
PL:  [5.36613664]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-1.66040354e-02  5.05177172e-02  4.74078635e-02]
 [ 3.63141744e-01 -5.73290170e-01  5.16053257e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.22892534e-01 -4.71760052e-01 -3.32916968e-01]
 [-4.30998664e-02 -2.80775195e-02  2.09929412e-02]
 [-5.67380822e-02  5.59759788e-02 -2.68175060e-02]
 [-1.00033068e-01 -1.18479787e-01  1.68595909e-01]
 [-1.10371563e-01  5.43956938e-02  1.44228352e-01]
 [-6.62782214e-02 -5.49572904e-02  7.91101956e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.43497901]
curr_Stock_Price:  100.16998270916532
curr_Factors:  [100.16998271  -1.19582653  -0.98826814]
mat_Sqrt:  [[11.27709753  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00030016 0.01630452 0.13524144]
Stock Position:  0.00030016057604871513
Bond Position:  [3.40491193]


portfolio before change:  [3.4365907]
curr_Stock_Price:  99.86618478262707
curr_Factors:  [99.86618478 -0.49372355 -1.00918327]
mat_Sqrt:  [[22.21847876  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01581829 -0.18502861  1.4721563 ]
Stock Position:  0.01581828856984504
Bond Position:  [1.85687857]


portfolio before change:  [3.47745508]
curr_Stock_Price:  102.39083881580322
curr_Factors:  [102.39083882  -0.36107055  -0.99496257]
mat_Sqrt:  [[26.38416777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00133444 -0.02755111  0.34758667]
Stock Position:  0.0013344395056531211
Bond Position:  [3.3408207]


portfolio before change:  [3.47975561]
curr_Stock_Price:  102.86272863106099
curr_Factors:  [102.86272863  -0.20827907  -1.03606798]
mat_Sqrt:  [[29.63773302  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01210074 -0.1522599  -0.94971944]
Stock Position:  0.012100740786228472
Bond Position:  [2.2350404]


portfolio before change:  [3.45344511]
curr_Stock_Price:  100.59606529829361
curr_Factors:  [100.5960653   -0.14987404  -0.97147939]
mat_Sqrt:  [[32.77807065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00135902 -0.00906198  0.05988702]
Stock Position:  -0.001359018362460466
Bond Position:  [3.59015701]


portfolio before change:  [3.4576418]
curr_Stock_Price:  98.8292257847414
curr_Factors:  [98.82922578 -0.39489397 -0.90497245]
mat_Sqrt:  [[26.93770409  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00188532  0.01806617 -0.07650288]
Stock Position:  -0.0018853178312770234
Bond Position:  [3.6439663]


portfolio before change:  [3.45644179]
curr_Stock_Price:  100.4323801524469
curr_Factors:  [100.43238015  -1.04136206  -0.94631242]
mat_Sqrt:  [[13.76061036  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0065261  -0.03823919  0.4809572 ]
Stock Position:  -0.0065261028052228335
Bond Position:  [4.11187382]


portfolio before change:  [3.46233918]
curr_Stock_Price:  99.84382919739734
curr_Factors:  [99.8438292  -1.07015266 -0.90589446]
mat_Sqrt:  [[13.83996102  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00504536  0.01755613  0.41144334]
Stock Position:  -0.0050453609601507745
Bond Position:  [3.96608734]


portfolio before change:  [3.46536197]
curr_Stock_Price:  99.63784802846679
curr_Factors:  [99.63784803 -1.20355787 -0.89855679]
mat_Sqrt:  [[12.17552073  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00503864 -0.01773739  0.22567937]
Stock Position:  -0.005038637087110974
Bond Position:  [3.96740093]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.46764327]
Stock Price:  99.57888363934605
PL:  [3.46764327]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-9.74264228e-02  7.79699005e-02  5.44450740e-02]
 [ 4.85935277e-01 -6.90221460e-01  6.81238250e-01]
 [-1.40954041e-02 -7.60385026e-02  1.12824207e-01]
 [ 2.08990841e-01 -1.90077570e-01 -1.10332765e-01]
 [-5.18438836e-02  9.09425763e-02  1.42358279e-01]
 [-1.98608304e-02  7.95122749e-02 -1.25111326e-01]
 [-1.99557720e-01  1.13246573e-01  1.82335351e-01]
 [-9.83594048e-02  4.76184580e-02  1.64113730e-01]
 [-3.13147565e-03 -1.43315935e-02  9.65794114e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.73593303]
curr_Stock_Price:  102.0992169160065
curr_Factors:  [102.09921692  -1.06668697  -0.98294172]
mat_Sqrt:  [[13.14861422  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00535397  0.02516468  0.15531664]
Stock Position:  -0.005353973285347799
Bond Position:  [19.28256951]


portfolio before change:  [18.74057048]
curr_Stock_Price:  103.03426894897738
curr_Factors:  [103.03426895  -0.64645164  -0.93698523]
mat_Sqrt:  [[21.14968006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02288931 -0.22276802  1.94338311]
Stock Position:  0.02288931016540799
Bond Position:  [16.38218714]


portfolio before change:  [18.66317261]
curr_Stock_Price:  99.29492466704346
curr_Factors:  [99.29492467  0.17022741 -0.94870592]
mat_Sqrt:  [[45.58669702  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.44484117e-04 -2.45413212e-02  3.21856057e-01]
Stock Position:  -0.00014448411747800072
Bond Position:  [18.67751915]


portfolio before change:  [18.67335849]
curr_Stock_Price:  93.44806098910892
curr_Factors:  [93.44806099 -0.46868064 -0.92696589]
mat_Sqrt:  [[23.14454813  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00638033 -0.06134727 -0.31474867]
Stock Position:  0.00638032928502957
Bond Position:  [18.07712909]


portfolio before change:  [18.70939981]
curr_Stock_Price:  97.67989528763331
curr_Factors:  [97.67989529 -0.87448494 -0.99669973]
mat_Sqrt:  [[15.0369587   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.80744660e-04  2.93515903e-02  4.06108546e-01]
Stock Position:  -0.00028074465977677963
Bond Position:  [18.73682292]


portfolio before change:  [18.71908969]
curr_Stock_Price:  96.5431637936816
curr_Factors:  [96.54316379 -0.64976112 -0.98497714]
mat_Sqrt:  [[18.82624563  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00154936  0.02566248 -0.35690779]
Stock Position:  -0.0015493635000450052
Bond Position:  [18.86867015]


portfolio before change:  [18.72687472]
curr_Stock_Price:  97.60919125399279
curr_Factors:  [97.60919125 -0.51453679 -1.05958789]
mat_Sqrt:  [[20.22353408  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00688417  0.03655017  0.52015201]
Stock Position:  -0.006884173272725224
Bond Position:  [19.39883331]


portfolio before change:  [18.73755782]
curr_Stock_Price:  97.46665368490288
curr_Factors:  [97.46665368 -0.6317364  -1.14492481]
mat_Sqrt:  [[16.49156597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00334351  0.01536879  0.46817079]
Stock Position:  -0.003343512254799913
Bond Position:  [19.06343877]


portfolio before change:  [18.74332065]
curr_Stock_Price:  98.59458943250536
curr_Factors:  [98.59458943 -0.33922615 -1.12419029]
mat_Sqrt:  [[22.8191464   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0005985  -0.0046255   0.27551418]
Stock Position:  0.000598501347559624
Bond Position:  [18.68431166]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.7517605]
Stock Price:  97.08307972826941
PL:  [18.7517605]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-3.33631942e-02  4.15766078e-02  4.77443268e-02]
 [ 4.81209231e-01 -5.86411013e-01  6.24773592e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.34475696e-01 -3.72501435e-01 -3.86710916e-01]
 [-6.11679836e-02  8.67508549e-02  1.30730218e-01]
 [-9.45816955e-02  3.44364202e-02  5.58535385e-02]
 [-9.05091267e-02 -1.36541208e-01  1.66215327e-01]
 [-1.04581185e-01  3.96619754e-02  1.27928296e-01]
 [-2.24639652e-02 -2.87387109e-02  9.20588611e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.52733089]
curr_Stock_Price:  100.55988460866392
curr_Factors:  [100.55988461  -1.10169251  -1.02232581]
mat_Sqrt:  [[12.0219614   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00125858  0.01341879  0.13620127]
Stock Position:  -0.0012585828736352408
Bond Position:  [6.65389384]


portfolio before change:  [6.52921803]
curr_Stock_Price:  101.70453968606995
curr_Factors:  [101.70453969  -1.04197305  -0.98616214]
mat_Sqrt:  [[13.38235096  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03654365 -0.18926334  1.78230516]
Stock Position:  0.036543650763099886
Bond Position:  [2.81256285]


portfolio before change:  [6.4691362]
curr_Stock_Price:  100.02193670440471
curr_Factors:  [100.0219367   -0.15822799  -0.98974617]
mat_Sqrt:  [[31.73484755  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00110945 -0.02755111  0.34758667]
Stock Position:  0.001109445247797763
Bond Position:  [6.35816734]


portfolio before change:  [6.47117712]
curr_Stock_Price:  98.99532738170943
curr_Factors:  [98.99532738 -0.3257987  -0.94870242]
mat_Sqrt:  [[27.67616372  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01009902 -0.12022432 -1.1031786 ]
Stock Position:  0.010099019726785901
Bond Position:  [5.47142135]


portfolio before change:  [6.46707342]
curr_Stock_Price:  98.31802481909443
curr_Factors:  [98.31802482 -0.64294686 -0.9651811 ]
mat_Sqrt:  [[19.68938009  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085197  0.02799872  0.37293692]
Stock Position:  -0.0008519742847934261
Bond Position:  [6.55083785]


portfolio before change:  [6.46857955]
curr_Stock_Price:  100.3956794855524
curr_Factors:  [100.39567949  -0.46552495  -0.96901947]
mat_Sqrt:  [[23.91664735  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00318403  0.01111431  0.1593346 ]
Stock Position:  -0.0031840305117551877
Bond Position:  [6.78824246]


portfolio before change:  [6.47486926]
curr_Stock_Price:  99.48653462674277
curr_Factors:  [99.48653463 -1.01807754 -1.01034822]
mat_Sqrt:  [[13.08670132  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00645326 -0.04406849  0.47416606]
Stock Position:  -0.006453262792954491
Bond Position:  [7.11688202]


portfolio before change:  [6.48061898]
curr_Stock_Price:  99.14711245160665
curr_Factors:  [99.14711245 -1.10765928 -1.03902372]
mat_Sqrt:  [[11.58743968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00607312  0.01280085  0.36494382]
Stock Position:  -0.006073124516765504
Bond Position:  [7.08275173]


portfolio before change:  [6.48495304]
curr_Stock_Price:  99.01673418400541
curr_Factors:  [99.01673418 -0.52617951 -1.08790568]
mat_Sqrt:  [[19.71152872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00048392 -0.00927538  0.26261831]
Stock Position:  -0.0004839195271981162
Bond Position:  [6.53286917]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.48732334]
Stock Price:  100.87023818480012
PL:  [5.61708516]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-4.50557696e-02  4.82189724e-02  4.89673216e-02]
 [ 5.15346356e-01 -6.39771923e-01  6.82956376e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.21011573e-01 -4.67851129e-01 -3.44043462e-01]
 [-7.52211847e-02  1.39621025e-02 -1.99663910e-02]
 [-8.33854659e-02  7.75833745e-03  3.84054750e-02]
 [-3.14227570e-01  1.17368973e-01  2.55865880e-01]
 [-1.17478456e-01  1.00741410e-01  2.28034563e-01]
 [-1.75597995e-02 -4.46458333e-02  2.66588434e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.04961259]
curr_Stock_Price:  100.87790870875759
curr_Factors:  [100.87790871  -1.08203029  -1.02824521]
mat_Sqrt:  [[12.22686352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00206248  0.01556261  0.13969014]
Stock Position:  -0.0020624831882684845
Bond Position:  [9.25767158]


portfolio before change:  [9.05186753]
curr_Stock_Price:  102.02946149845305
curr_Factors:  [102.0294615   -0.77559959  -1.05713304]
mat_Sqrt:  [[16.32224628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03211331 -0.2064855   1.94828444]
Stock Position:  0.03211330942427113
Bond Position:  [5.77536386]


portfolio before change:  [9.05772747]
curr_Stock_Price:  102.1219944704793
curr_Factors:  [102.12199447  -0.72200643  -1.08129921]
mat_Sqrt:  [[16.82494292  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00209261 -0.02755111  0.34758667]
Stock Position:  0.0020926119022414936
Bond Position:  [8.84402577]


portfolio before change:  [9.06287262]
curr_Stock_Price:  102.46703407204409
curr_Factors:  [102.46703407  -0.68734868  -1.08780381]
mat_Sqrt:  [[17.36381841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02046118 -0.1509983  -0.98146023]
Stock Position:  0.020461183999236746
Bond Position:  [6.96627579]


portfolio before change:  [9.04614293]
curr_Stock_Price:  101.4791292764926
curr_Factors:  [101.47912928  -0.20672222  -1.06558272]
mat_Sqrt:  [[28.4329366   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00268867  0.00450625 -0.05695856]
Stock Position:  -0.0026886707476272108
Bond Position:  [9.3189869]


portfolio before change:  [9.04924909]
curr_Stock_Price:  102.05729556539538
curr_Factors:  [102.05729557  -0.51992519  -1.09557051]
mat_Sqrt:  [[20.28818462  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364559  0.00250399  0.10956013]
Stock Position:  -0.0036455857710643294
Bond Position:  [9.42130771]


portfolio before change:  [9.04831306]
curr_Stock_Price:  103.60652726606018
curr_Factors:  [103.60652727  -0.50660812  -1.09386704]
mat_Sqrt:  [[20.90786021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01138526  0.03788067  0.72991414]
Stock Position:  -0.011385255247238801
Bond Position:  [10.22789982]


portfolio before change:  [9.0512102]
curr_Stock_Price:  103.8013485580043
curr_Factors:  [103.80134856  -0.61340341  -1.12748117]
mat_Sqrt:  [[18.203145    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00276696  0.03251415  0.65051914]
Stock Position:  -0.002766958212015709
Bond Position:  [9.3384242]


portfolio before change:  [9.05763829]
curr_Stock_Price:  103.16609798966786
curr_Factors:  [103.16609799  -0.81172442  -1.15168423]
mat_Sqrt:  [[14.48236405  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00146602 -0.01440938  0.07605026]
Stock Position:  -0.0014660160731640405
Bond Position:  [9.20888145]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.06244987]
Stock Price:  103.02559153768738
PL:  [6.03685833]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.67620627e-02  9.75019995e-02  4.86917981e-02]
 [ 2.66692161e-01 -3.00435254e-01  3.51209252e-01]
 [-1.08044753e-01 -2.60104257e-02  4.98000795e-03]
 [ 4.19862260e-01 -3.59159476e-01 -3.81379877e-01]
 [-1.17295131e-01  1.16127230e-01 -6.62093549e-02]
 [-9.45816955e-02  3.44364202e-02  5.58535385e-02]
 [-1.09482763e-01 -1.63281614e-01  1.69109291e-01]
 [-1.08643475e-01  7.47087852e-02  1.95145749e-01]
 [-3.11346328e-02 -3.53256896e-02  8.73186280e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.33756584]
curr_Stock_Price:  99.5682322066147
curr_Factors:  [99.56823221 -1.00677684 -1.01725266]
mat_Sqrt:  [[13.15515454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00506294 0.03146864 0.13890415]
Stock Position:  0.005062939128700067
Bond Position:  [-1.84167374]


portfolio before change:  [-1.34167357]
curr_Stock_Price:  98.9388232935432
curr_Factors:  [98.93882329 -0.87137672 -1.09806915]
mat_Sqrt:  [[13.805345    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02006877 -0.09696506  1.00190224]
Stock Position:  0.02006877484102201
Bond Position:  [-3.32725454]


portfolio before change:  [-1.34757088]
curr_Stock_Price:  98.7278850850776
curr_Factors:  [98.72788509 -1.01237161 -1.08798301]
mat_Sqrt:  [[12.08557763  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00929518 -0.00839483  0.01420658]
Stock Position:  -0.009295175843031613
Bond Position:  [-0.42987783]


portfolio before change:  [-1.34967911]
curr_Stock_Price:  98.93156481099051
curr_Factors:  [98.93156481 -0.80337173 -1.08639559]
mat_Sqrt:  [[14.94924844  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01797417 -0.11591822 -1.08797063]
Stock Position:  0.017974167637167634
Bond Position:  [-3.12789164]


portfolio before change:  [-1.32042172]
curr_Stock_Price:  100.64634436252774
curr_Factors:  [100.64634436  -1.16176307  -1.12176359]
mat_Sqrt:  [[10.25829014  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01044089  0.0374799  -0.18887686]
Stock Position:  -0.010440890790015213
Bond Position:  [-0.26958423]


portfolio before change:  [-1.32492407]
curr_Stock_Price:  101.06465407634032
curr_Factors:  [101.06465408  -0.91242636  -1.13594763]
mat_Sqrt:  [[13.03172096  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00584354  0.01111431  0.1593346 ]
Stock Position:  -0.005843536332995208
Bond Position:  [-0.73434909]


portfolio before change:  [-1.31801703]
curr_Stock_Price:  99.8198070688369
curr_Factors:  [99.81980707 -0.94702976 -1.14935939]
mat_Sqrt:  [[12.26779434  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00882744 -0.05269891  0.48242174]
Stock Position:  -0.008827437983454957
Bond Position:  [-0.43686387]


portfolio before change:  [-1.30481346]
curr_Stock_Price:  98.29931465767615
curr_Factors:  [98.29931466 -0.32224486 -1.17196422]
mat_Sqrt:  [[22.06092552  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00242781  0.02411216  0.5566965 ]
Stock Position:  -0.0024278060529556063
Bond Position:  [-1.06616179]


portfolio before change:  [-1.30867025]
curr_Stock_Price:  99.66827793040851
curr_Factors:  [99.66827793 -0.39738209 -1.19455571]
mat_Sqrt:  [[20.28556693  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101164 -0.01140132  0.24909574]
Stock Position:  -0.001011636437216302
Bond Position:  [-1.20784219]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.30789475]
Stock Price:  98.30457128057391
PL:  [-1.30789475]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-1.16238251e-02  5.49023661e-02  4.75276824e-02]
 [ 3.29719407e-01 -4.55543953e-01  4.38432176e-01]
 [-2.36543886e-01  2.91793813e-02 -1.70629220e-01]
 [ 4.34113117e-01 -3.68200507e-01 -4.01021601e-01]
 [ 1.17667076e-01 -2.73257149e-02  1.70969550e-01]
 [ 4.18558398e-02  7.53316728e-02 -1.68876463e-01]
 [-2.82860870e-01  5.20810270e-02  2.56247536e-01]
 [-4.84701936e-02  2.42369251e-02  2.57460877e-01]
 [ 1.24554943e-01  8.22916690e-02  1.24339797e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.62146987]
curr_Stock_Price:  100.0674106966301
curr_Factors:  [100.0674107  -1.0774406  -0.9408456]
mat_Sqrt:  [[13.29725822  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00069824 0.01771966 0.13558325]
Stock Position:  0.0006982357464028654
Bond Position:  [2.55159923]


portfolio before change:  [2.62260766]
curr_Stock_Price:  99.86928858193984
curr_Factors:  [99.86928858 -1.43047794 -0.93671628]
mat_Sqrt:  [[ 9.36208482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0348455  -0.14702618  1.25072496]
Stock Position:  0.034845495033533055
Bond Position:  [-0.85738714]


portfolio before change:  [2.55370549]
curr_Stock_Price:  97.9042320443137
curr_Factors:  [97.90423204 -0.93263678 -0.90104627]
mat_Sqrt:  [[15.64743061  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01696235  0.0094176  -0.48675767]
Stock Position:  -0.0169623511739061
Bond Position:  [4.21439145]


portfolio before change:  [2.53944879]
curr_Stock_Price:  98.86898151191413
curr_Factors:  [98.86898151 -0.91014818 -0.91429586]
mat_Sqrt:  [[15.94828839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01737467 -0.1188362  -1.14400301]
Stock Position:  0.017374673978595476
Bond Position:  [0.82163247]


portfolio before change:  [2.47177282]
curr_Stock_Price:  94.95023810153921
curr_Factors:  [94.9502381  -0.64297141 -0.90424053]
mat_Sqrt:  [[20.20926184  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00727331 -0.00881934  0.48772854]
Stock Position:  0.007273311230306566
Bond Position:  [1.78117019]


portfolio before change:  [2.47032537]
curr_Stock_Price:  94.62875396059565
curr_Factors:  [94.62875396 -0.61549305 -0.94504925]
mat_Sqrt:  [[19.87413389  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00114526  0.02431319 -0.48175754]
Stock Position:  0.0011452619528160113
Bond Position:  [2.36195066]


portfolio before change:  [2.46981759]
curr_Stock_Price:  93.15393091198258
curr_Factors:  [93.15393091  0.2513418  -0.95124224]
mat_Sqrt:  [[46.26347878  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00475372  0.01680908  0.73100289]
Stock Position:  -0.00475371873141684
Bond Position:  [2.91264517]


portfolio before change:  [2.47774462]
curr_Stock_Price:  91.79281788219218
curr_Factors:  [ 9.17928179e+01 -6.71841320e-02 -9.84837246e-01]
mat_Sqrt:  [[32.05690742  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [2.81721793e-04 7.82243395e-03 7.34464218e-01]
Stock Position:  0.000281721793301208
Bond Position:  [2.45188458]


portfolio before change:  [2.47958677]
curr_Stock_Price:  93.97903480919835
curr_Factors:  [ 9.39790348e+01 -6.95995200e-02 -9.67315594e-01]
mat_Sqrt:  [[33.31995974  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00500401 0.02655952 0.35470683]
Stock Position:  0.00500401007118452
Bond Position:  [2.00931474]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.47666511]
Stock Price:  93.1943492565203
PL:  [2.47666511]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 7.30620113e-02  1.49836619e-01  5.14174216e-02]
 [ 2.91215537e-01 -3.72758138e-01  3.97739195e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.22210053e-01 -4.65470620e-01 -3.61518516e-01]
 [-1.33748671e-01  1.20737610e-01 -1.14640454e-01]
 [-9.45816955e-02  3.44364202e-02  5.58535385e-02]
 [-1.47202937e-01  4.03398490e-02  1.70578417e-01]
 [-1.13475960e-01  8.85210730e-02  2.12171473e-01]
 [-8.63840986e-03 -4.31331659e-02  2.11363534e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.85037197]
curr_Stock_Price:  98.9992310878759
curr_Factors:  [98.99923109 -0.72952435 -1.02879948]
mat_Sqrt:  [[17.06088229  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00669032 0.04835956 0.14667959]
Stock Position:  0.006690323416576678
Bond Position:  [-6.51270885]


portfolio before change:  [-5.85298775]
curr_Stock_Price:  99.0950991094819
curr_Factors:  [99.09509911 -0.54711782 -1.0138756 ]
mat_Sqrt:  [[20.80277864  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.014244   -0.12030717  1.13463921]
Stock Position:  0.014243999748070963
Bond Position:  [-7.26449832]


portfolio before change:  [-5.8310564]
curr_Stock_Price:  100.88985577297662
curr_Factors:  [100.88985577  -0.7706974   -1.03757237]
mat_Sqrt:  [[16.53963492  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00212871 -0.02755111  0.34758667]
Stock Position:  0.002128709367893752
Bond Position:  [-6.04582158]


portfolio before change:  [-5.83199858]
curr_Stock_Price:  101.86767275036296
curr_Factors:  [101.86767275  -1.04818496  -1.03281969]
mat_Sqrt:  [[12.71357081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02779719 -0.15023    -1.0313117 ]
Stock Position:  0.027797194639424802
Bond Position:  [-8.6636341]


portfolio before change:  [-5.85256438]
curr_Stock_Price:  101.28369646597986
curr_Factors:  [101.28369647  -1.16073046  -1.01885465]
mat_Sqrt:  [[11.45401522  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01156835  0.0389679  -0.32703731]
Stock Position:  -0.011568353219214393
Bond Position:  [-4.6808788]


portfolio before change:  [-5.85097368]
curr_Stock_Price:  100.9438277033911
curr_Factors:  [100.9438277   -0.88735235  -1.02937921]
mat_Sqrt:  [[14.84751689  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00512889  0.01111431  0.1593346 ]
Stock Position:  -0.005128893637797594
Bond Position:  [-5.33324353]


portfolio before change:  [-5.84104959]
curr_Stock_Price:  98.4888386574866
curr_Factors:  [98.48883866 -0.7679619  -1.01185648]
mat_Sqrt:  [[16.61199218  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00626953  0.01301963  0.48661274]
Stock Position:  -0.006269532566784738
Bond Position:  [-5.22357061]


portfolio before change:  [-5.85733054]
curr_Stock_Price:  100.66898632470853
curr_Factors:  [100.66898632  -0.53718425  -1.032123  ]
mat_Sqrt:  [[20.9582113   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00248577  0.02857005  0.60526616]
Stock Position:  -0.0024857727565001826
Bond Position:  [-5.60709031]


portfolio before change:  [-5.87150632]
curr_Stock_Price:  105.24363351641747
curr_Factors:  [105.24363352  -0.78522149  -1.01050305]
mat_Sqrt:  [[17.47119355  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00075144 -0.01392117  0.06029613]
Stock Position:  -0.0007514363786223284
Bond Position:  [-5.79242242]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.87697614]
Stock Price:  108.66759518357102
PL:  [-14.54457133]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.71619172e-02  3.65957507e-02  4.87353837e-02]
 [ 2.05707179e-01 -1.20581959e-01  2.35498110e-01]
 [-3.26186037e-01  4.42124581e-02 -3.19566633e-01]
 [ 3.19442009e-01 -2.73806228e-01 -2.68432996e-01]
 [ 6.58526174e-03  8.18155211e-02  1.71315294e-01]
 [ 8.28981499e-02  6.33573289e-02 -1.87155122e-01]
 [-5.71138963e-03 -2.13050458e-01  1.84271111e-01]
 [-8.40923600e-02  2.53000523e-02  1.55520527e-01]
 [-4.01529944e-02 -4.01948784e-02  8.54566198e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.30551356]
curr_Stock_Price:  97.807071268419
curr_Factors:  [97.80707127 -0.9070949  -0.9453734 ]
mat_Sqrt:  [[15.34099382  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00355779 0.01181123 0.13902848]
Stock Position:  0.0035577918053365408
Bond Position:  [-15.65349076]


portfolio before change:  [-15.31151825]
curr_Stock_Price:  98.31975373249617
curr_Factors:  [98.31975373 -0.89565408 -0.99535122]
mat_Sqrt:  [[14.83841846  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01544399 -0.03891766  0.67181056]
Stock Position:  0.015443986872277072
Bond Position:  [-16.82996724]


portfolio before change:  [-15.34685914]
curr_Stock_Price:  96.57643435756957
curr_Factors:  [96.57643436 -0.97009054 -1.00437358]
mat_Sqrt:  [[13.40825615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02851918  0.01426951 -0.91163466]
Stock Position:  -0.028519180138700365
Bond Position:  [-12.59257841]


portfolio before change:  [-15.33949574]
curr_Stock_Price:  96.09741416550554
curr_Factors:  [96.09741417 -1.28962743 -0.93271684]
mat_Sqrt:  [[10.41261591  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02004855 -0.08837058 -0.76576462]
Stock Position:  0.020048553857715815
Bond Position:  [-17.26610992]


portfolio before change:  [-15.34792513]
curr_Stock_Price:  96.10768029856249
curr_Factors:  [96.1076803  -0.97636103 -0.93481899]
mat_Sqrt:  [[14.21487878  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0040982  0.02640585 0.48871485]
Stock Position:  0.004098196957469753
Bond Position:  [-15.74179333]


portfolio before change:  [-15.36595786]
curr_Stock_Price:  93.62857432733738
curr_Factors:  [93.62857433 -0.71353482 -0.96935851]
mat_Sqrt:  [[17.39951416  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00331205  0.02044849 -0.53390147]
Stock Position:  0.003312048294328413
Bond Position:  [-15.67606022]


portfolio before change:  [-15.3629825]
curr_Stock_Price:  96.89403156646331
curr_Factors:  [96.89403157 -1.43156641 -1.01645425]
mat_Sqrt:  [[ 8.37789979  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138292 -0.06876174  0.52567419]
Stock Position:  -0.0013829181152381288
Bond Position:  [-15.22898599]


portfolio before change:  [-15.37053739]
curr_Stock_Price:  96.84955618595153
curr_Factors:  [96.84955619 -0.93139964 -1.02088385]
mat_Sqrt:  [[13.74775203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00343202  0.00816556  0.44365677]
Stock Position:  -0.0034320166546398154
Bond Position:  [-15.0381481]


portfolio before change:  [-15.38129224]
curr_Stock_Price:  97.79182938487233
curr_Factors:  [97.79182938 -1.43385961 -1.02294247]
mat_Sqrt:  [[ 8.38160104  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00368831 -0.01297284  0.24378395]
Stock Position:  -0.003688314445385028
Bond Position:  [-15.02060522]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.38854188]
Stock Price:  97.72064677553053
PL:  [-15.38854188]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-6.53612661e-02  5.97541993e-02  5.10911920e-02]
 [ 3.67605401e-01 -5.28321095e-01  4.91138613e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.71040332e-01 -4.08907748e-01 -4.02050985e-01]
 [ 4.10083978e-02  6.87170610e-03  1.53047871e-01]
 [-6.82045025e-02  4.80701658e-02  7.83680575e-03]
 [-2.72530743e-01  3.15557707e-02  2.35523224e-01]
 [-1.17336733e-01  9.34023783e-02  2.11882223e-01]
 [-1.16380476e-02 -4.47049243e-02  1.98975653e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.4492918]
curr_Stock_Price:  101.18047436646513
curr_Factors:  [101.18047437  -1.43578565  -1.03597847]
mat_Sqrt:  [[ 8.54325149  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0050022   0.01928558  0.14574895]
Stock Position:  -0.005002199154220002
Bond Position:  [11.95541669]


portfolio before change:  [11.46007088]
curr_Stock_Price:  100.22092161275522
curr_Factors:  [100.22092161  -1.14146045  -0.97996845]
mat_Sqrt:  [[12.01250353  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02997007 -0.1705149   1.40108176]
Stock Position:  0.029970068934010115
Bond Position:  [8.45644295]


portfolio before change:  [11.45386333]
curr_Stock_Price:  99.87267982199145
curr_Factors:  [99.87267982 -1.22756286 -1.00447531]
mat_Sqrt:  [[10.7172866   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00328517 -0.02755111  0.34758667]
Stock Position:  0.0032851669548244022
Bond Position:  [11.1257649]


portfolio before change:  [11.46039192]
curr_Stock_Price:  100.16621821360619
curr_Factors:  [100.16621821  -0.79539891  -1.03284867]
mat_Sqrt:  [[16.09620308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01897988 -0.13197441 -1.14693955]
Stock Position:  0.018979884428665897
Bond Position:  [9.55924868]


portfolio before change:  [11.39449522]
curr_Stock_Price:  96.44240612312913
curr_Factors:  [96.44240612 -0.36765271 -1.04910272]
mat_Sqrt:  [[23.38724006  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00314923 0.00221783 0.43660297]
Stock Position:  0.0031492319953451606
Bond Position:  [11.09077571]


portfolio before change:  [11.40875859]
curr_Stock_Price:  99.21025454532419
curr_Factors:  [99.21025455 -0.32633447 -1.09643422]
mat_Sqrt:  [[23.91420637  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00237485  0.01551458  0.02235623]
Stock Position:  -0.002374845262716064
Bond Position:  [11.64436759]


portfolio before change:  [11.40453473]
curr_Stock_Price:  103.44105593983706
curr_Factors:  [103.44105594  -0.61652804  -1.13691968]
mat_Sqrt:  [[17.91349283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01217035  0.01018458  0.6718822 ]
Stock Position:  -0.012170349639590647
Bond Position:  [12.66344855]


portfolio before change:  [11.38771805]
curr_Stock_Price:  105.34321882753386
curr_Factors:  [105.34321883  -0.80998488  -1.10240197]
mat_Sqrt:  [[15.56207586  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00353557  0.03014549  0.60444101]
Stock Position:  -0.003535567821186797
Bond Position:  [11.76016615]


portfolio before change:  [11.39034108]
curr_Stock_Price:  106.26486082479272
curr_Factors:  [106.26486082  -0.85149105  -1.09040134]
mat_Sqrt:  [[15.24180938  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00109579 -0.01442845  0.05676222]
Stock Position:  -0.001095790411198789
Bond Position:  [11.50678509]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.39600599]
Stock Price:  106.34691495742794
PL:  [5.04909104]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-6.63627971e-02  6.03231530e-02  5.11959480e-02]
 [ 3.38938459e-01 -3.44829213e-01  3.72653321e-01]
 [ 1.59756429e-01 -1.52604736e-01  1.55609650e-01]
 [ 5.23867356e-01 -4.59663057e-01 -3.77253073e-01]
 [-1.49949499e-01  1.44019585e-01 -2.05896295e-01]
 [-9.45816955e-02  3.44364202e-02  5.58535385e-02]
 [ 1.95484681e-02 -3.82558935e-01  2.36973285e-01]
 [-1.17746861e-01  1.78482958e-02  4.01217530e-02]
 [ 1.11054163e-02 -3.70811269e-02  1.67889833e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.81917157]
curr_Stock_Price:  100.84885335011693
curr_Factors:  [100.84885335  -1.68321218  -0.94425085]
mat_Sqrt:  [[ 7.287495    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00598272  0.01946921  0.14604779]
Stock Position:  -0.005982721906236968
Bond Position:  [9.42252221]


portfolio before change:  [8.82653108]
curr_Stock_Price:  100.40639987127557
curr_Factors:  [100.40639987  -2.29099496  -0.95076125]
mat_Sqrt:  [[ 3.92540584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.08779169 -0.11129315  1.0630762 ]
Stock Position:  0.08779169466979143
Bond Position:  [0.01168308]


portfolio before change:  [8.82119645]
curr_Stock_Price:  100.34556866347931
curr_Factors:  [100.34556866  -2.52476489  -0.9504363 ]
mat_Sqrt:  [[ 3.10625782  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05162798 -0.04925297  0.44391102]
Stock Position:  0.051627976148943384
Bond Position:  [3.64055783]


portfolio before change:  [8.84503984]
curr_Stock_Price:  100.77213295331607
curr_Factors:  [100.77213295  -2.40481453  -0.9552387 ]
mat_Sqrt:  [[ 3.50015982  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.10086184 -0.14835561 -1.07619801]
Stock Position:  0.10086184179420836
Bond Position:  [-1.3190231]


portfolio before change:  [8.87698249]
curr_Stock_Price:  101.09537042070652
curr_Factors:  [101.09537042  -2.1153016   -0.96635913]
mat_Sqrt:  [[ 4.63855829  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.03504969  0.04648212 -0.58736482]
Stock Position:  -0.035049689870250596
Bond Position:  [12.42034387]


portfolio before change:  [8.86092566]
curr_Stock_Price:  101.73071264751495
curr_Factors:  [101.73071265  -1.78707277  -0.99171214]
mat_Sqrt:  [[ 6.31889491  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01205137  0.01111431  0.1593346 ]
Stock Position:  -0.012051369115261251
Bond Position:  [10.08692003]


portfolio before change:  [8.87176333]
curr_Stock_Price:  101.25002474324815
curr_Factors:  [101.25002474  -1.99226751  -0.94994737]
mat_Sqrt:  [[ 5.34081394  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00190403 -0.12347037  0.67601882]
Stock Position:  -0.001904031563726318
Bond Position:  [9.06454657]


portfolio before change:  [8.87485928]
curr_Stock_Price:  102.00497832490926
curr_Factors:  [102.00497832  -2.23894245  -0.91711786]
mat_Sqrt:  [[ 4.34471998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02437758  0.00576051  0.11445619]
Stock Position:  -0.0243775835311695
Bond Position:  [11.36149416]


portfolio before change:  [8.84981942]
curr_Stock_Price:  103.2652358872057
curr_Factors:  [103.26523589  -1.71541679  -0.97947962]
mat_Sqrt:  [[ 6.97550255  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00099825 -0.01196788  0.0478943 ]
Stock Position:  0.0009982506331332977
Bond Position:  [8.74673483]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.85479457]
Stock Price:  103.86698274827545
PL:  [4.98781182]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-4.49131581e-02  4.81379571e-02  4.89524050e-02]
 [ 3.27262641e-01 -4.69467569e-01  4.51095066e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.27121850e-01 -4.67735052e-01 -3.72519250e-01]
 [-8.38846973e-02  9.91930503e-02  4.97372131e-02]
 [-4.50844680e-02  6.15542597e-02 -4.90201593e-02]
 [-1.94144298e-01  1.37425459e-01  1.75968119e-01]
 [-7.54480702e-02  1.43105981e-02  1.56032287e-01]
 [ 5.47416573e-03 -6.48074765e-03  9.65378664e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.50744414]
curr_Stock_Price:  100.93563480141825
curr_Factors:  [100.9356348   -1.03402222  -1.04243141]
mat_Sqrt:  [[12.65470897  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00198303  0.01553646  0.13964759]
Stock Position:  -0.0019830302687178763
Bond Position:  [9.70760256]


portfolio before change:  [9.51468061]
curr_Stock_Price:  99.73471949074627
curr_Factors:  [99.73471949 -1.21112885 -1.03514647]
mat_Sqrt:  [[10.55118884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03066122 -0.15152001  1.28684866]
Stock Position:  0.03066122448106292
Bond Position:  [6.45669199]


portfolio before change:  [9.51509189]
curr_Stock_Price:  99.64281593237925
curr_Factors:  [99.64281593 -0.91420213 -0.99610909]
mat_Sqrt:  [[14.75055532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0023869  -0.02755111  0.34758667]
Stock Position:  0.0023868983253746575
Bond Position:  [9.27725462]


portfolio before change:  [9.52411408]
curr_Stock_Price:  101.4788394788962
curr_Factors:  [101.47883948  -1.4744642   -1.0169764 ]
mat_Sqrt:  [[ 8.40149531  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04232647 -0.15096084 -1.06269373]
Stock Position:  0.042326472374068905
Bond Position:  [5.22887278]


portfolio before change:  [9.43614924]
curr_Stock_Price:  99.33880941733472
curr_Factors:  [99.33880942 -0.99484966 -1.05014943]
mat_Sqrt:  [[12.85248572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00416141  0.03201442  0.14188642]
Stock Position:  -0.0041614078188138915
Bond Position:  [9.84953854]


portfolio before change:  [9.44620472]
curr_Stock_Price:  98.10617878832417
curr_Factors:  [98.10617879 -0.69665099 -1.05595117]
mat_Sqrt:  [[17.00399291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00250094  0.01986655 -0.13984087]
Stock Position:  -0.0025009393755809056
Bond Position:  [9.69156233]


portfolio before change:  [9.45024733]
curr_Stock_Price:  98.42781114648552
curr_Factors:  [98.42781115 -0.59217556 -1.05287988]
mat_Sqrt:  [[18.99675095  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00685239  0.04435388  0.50198806]
Stock Position:  -0.006852387658748679
Bond Position:  [10.12471285]


portfolio before change:  [9.47235505]
curr_Stock_Price:  95.94048941406508
curr_Factors:  [95.94048941 -0.92283812 -1.05562365]
mat_Sqrt:  [[13.266822    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00306607  0.00461873  0.44511668]
Stock Position:  -0.0030660676934341
Bond Position:  [9.76651508]


portfolio before change:  [9.47391549]
curr_Stock_Price:  97.0246265684842
curr_Factors:  [97.02462657 -0.89926497 -1.08143369]
mat_Sqrt:  [[13.38676013  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00178213 -0.00209165  0.27539566]
Stock Position:  0.001782133831545666
Bond Position:  [9.30100462]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.48285879]
Stock Price:  99.43276944510285
PL:  [9.48285879]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 2.86528942e-02  7.54420718e-02  4.67191395e-02]
 [ 1.04620697e-01  1.49601555e-01  5.51276334e-02]
 [-5.02962083e-01  4.02185253e-02 -3.97485806e-01]
 [ 3.21551395e-01 -2.79129090e-01 -2.56404650e-01]
 [-5.92827444e-02  8.75983788e-02  1.33081295e-01]
 [-6.36522912e-02  5.12902726e-02 -6.48838112e-03]
 [-2.12896311e-01  8.25295423e-02  1.96836842e-01]
 [-4.02978110e-02 -2.44881211e-02  1.71404365e-01]
 [ 5.49822543e-02  3.18487232e-02  1.06064948e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.11126455]
curr_Stock_Price:  99.72285148035564
curr_Factors:  [99.72285148 -0.62915556 -0.96923489]
mat_Sqrt:  [[20.16612878  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00265737 0.02434882 0.1332767 ]
Stock Position:  0.0026573740373583453
Bond Position:  [-0.37626547]


portfolio before change:  [-0.11909299]
curr_Stock_Price:  96.84773634328815
curr_Factors:  [96.84773634 -0.75275299 -0.94869113]
mat_Sqrt:  [[17.66695413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00828727 0.04828369 0.15726379]
Stock Position:  0.008287272768870983
Bond Position:  [-0.92169659]


portfolio before change:  [-0.13255171]
curr_Stock_Price:  95.27933622624188
curr_Factors:  [95.27933623 -1.06431898 -0.92074727]
mat_Sqrt:  [[13.08866657  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04399906  0.01298047 -1.13391637]
Stock Position:  -0.043999055119825735
Bond Position:  [4.05964906]


portfolio before change:  [-0.17067736]
curr_Stock_Price:  96.19199176998671
curr_Factors:  [96.19199177 -0.71529198 -0.9356447 ]
mat_Sqrt:  [[18.4563674   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01149934 -0.09008853 -0.7314511 ]
Stock Position:  0.01149933916284135
Bond Position:  [-1.2768217]


portfolio before change:  [-0.14909468]
curr_Stock_Price:  98.12438565279605
curr_Factors:  [98.12438565 -0.7791109  -0.92446532]
mat_Sqrt:  [[17.86171675  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00079705  0.02827226  0.37964389]
Stock Position:  -0.0007970507484743864
Bond Position:  [-0.07088456]


portfolio before change:  [-0.14998309]
curr_Stock_Price:  99.19453120810064
curr_Factors:  [99.19453121 -0.36476558 -0.93874456]
mat_Sqrt:  [[26.93893789  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00202336  0.01655386 -0.01850955]
Stock Position:  -0.002023359034487644
Bond Position:  [0.05072306]


portfolio before change:  [-0.14439456]
curr_Stock_Price:  96.44506573110455
curr_Factors:  [96.44506573 -0.38427885 -0.98995653]
mat_Sqrt:  [[24.40378402  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00638716  0.0266363   0.56152072]
Stock Position:  -0.006387160563932809
Bond Position:  [0.47161556]


portfolio before change:  [-0.11990542]
curr_Stock_Price:  92.64787364814569
curr_Factors:  [92.64787365 -0.95698447 -1.02197178]
mat_Sqrt:  [[12.80517968  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00080504 -0.00790351  0.48896894]
Stock Position:  -0.0008050381616828131
Bond Position:  [-0.04532035]


portfolio before change:  [-0.12143209]
curr_Stock_Price:  94.51611017166239
curr_Factors:  [94.51611017 -1.09819371 -1.07653667]
mat_Sqrt:  [[10.74069624  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00774007 0.01027913 0.30257377]
Stock Position:  0.007740072215979026
Bond Position:  [-0.85299361]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.10393482]
Stock Price:  96.83183454896188
PL:  [-0.10393482]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 6.59061374e-02  1.29261452e-01  4.99475605e-02]
 [ 4.09767075e-01 -5.34928433e-01  5.33227944e-01]
 [ 1.62435491e-02 -8.27978372e-02  1.19361871e-01]
 [ 5.02121912e-01 -4.41254065e-01 -3.91946741e-01]
 [-9.31018694e-02  1.02581802e-01  2.07326766e-02]
 [-5.15679706e-02  3.79306007e-02  5.14209340e-02]
 [-1.60807869e-02 -3.51533208e-01  1.80619116e-01]
 [-1.13004366e-01  5.39513443e-02  1.35513555e-01]
 [-4.13383670e-02 -5.15267142e-02  3.30823697e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.07876833]
curr_Stock_Price:  98.97043353329352
curr_Factors:  [98.97043353 -0.97332009 -0.95759556]
mat_Sqrt:  [[14.3522324   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00714084 0.04171895 0.14248649]
Stock Position:  0.0071408420033218
Bond Position:  [-6.78550056]


portfolio before change:  [-6.06894514]
curr_Stock_Price:  100.82130544646162
curr_Factors:  [100.82130545  -1.20383907  -0.97324213]
mat_Sqrt:  [[11.43030875  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0358188  -0.17264741  1.5211509 ]
Stock Position:  0.035818801859756805
Bond Position:  [-9.68024351]


portfolio before change:  [-6.12229919]
curr_Stock_Price:  99.4669128670956
curr_Factors:  [99.46691287 -0.95903307 -0.92360079]
mat_Sqrt:  [[15.13774351  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0015661  -0.02672289  0.34050619]
Stock Position:  0.001566095448795041
Bond Position:  [-6.27807387]


portfolio before change:  [-6.12324851]
curr_Stock_Price:  100.86561966355835
curr_Factors:  [100.86561966  -0.96410725  -0.92876607]
mat_Sqrt:  [[15.19423095  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02185339 -0.14241414 -1.11811495]
Stock Position:  0.02185339361434797
Bond Position:  [-8.3275046]


portfolio before change:  [-6.15529485]
curr_Stock_Price:  99.58977434073253
curr_Factors:  [99.58977434 -1.0157519  -0.9356606 ]
mat_Sqrt:  [[14.14904309  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00480106  0.03310813  0.05914456]
Stock Position:  -0.004801060141865699
Bond Position:  [-5.67715835]


portfolio before change:  [-6.16055953]
curr_Stock_Price:  100.09495319454791
curr_Factors:  [100.09495319  -1.29634831  -0.9324747 ]
mat_Sqrt:  [[10.77572871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00309298  0.01224205  0.14668961]
Stock Position:  -0.0030929847830070316
Bond Position:  [-5.85096737]


portfolio before change:  [-6.1681765]
curr_Stock_Price:  101.61152973689525
curr_Factors:  [101.61152974  -1.53834217  -0.96303405]
mat_Sqrt:  [[ 8.32931136  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00611917 -0.11345686  0.51525606]
Stock Position:  -0.006119170930288434
Bond Position:  [-5.54639818]


portfolio before change:  [-6.16838715]
curr_Stock_Price:  101.19264239105993
curr_Factors:  [101.19264239  -1.22653818  -0.99369911]
mat_Sqrt:  [[10.98783514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00676475  0.01741272  0.38658245]
Stock Position:  -0.006764754364957149
Bond Position:  [-5.48384378]


portfolio before change:  [-6.16896225]
curr_Stock_Price:  100.87223061847683
curr_Factors:  [100.87223062  -1.86048587  -0.95528234]
mat_Sqrt:  [[ 6.03808233  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00746981 -0.01663018  0.09437479]
Stock Position:  -0.007469805913456309
Bond Position:  [-5.41546626]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.17021864]
Stock Price:  100.67784582725437
PL:  [-6.84806447]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-2.53994392e-02  4.30419210e-02  4.73272081e-02]
 [ 3.47552946e-01 -3.87884171e-01  4.02191205e-01]
 [ 1.10805444e-01 -1.20405705e-01  1.28420933e-01]
 [ 4.86301586e-01 -4.23921751e-01 -3.97456000e-01]
 [-1.40555179e-01  1.35261900e-01 -1.64005086e-01]
 [-9.45816955e-02  3.44364202e-02  5.58535385e-02]
 [-5.34473236e-02 -3.14729368e-01  1.65091801e-01]
 [-1.14483180e-01  6.16771597e-02  1.48622589e-01]
 [-8.00093981e-03 -4.21202865e-02  2.33762580e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.01930398]
curr_Stock_Price:  99.86540020521468
curr_Factors:  [99.86540021 -1.87873134 -0.99251115]
mat_Sqrt:  [[ 5.65523003  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00122947  0.01389172  0.13501135]
Stock Position:  -0.001229466872399897
Bond Position:  [1.14208518]


portfolio before change:  [1.01923051]
curr_Stock_Price:  100.3897376016185
curr_Factors:  [100.3897376   -2.02748793  -0.99205285]
mat_Sqrt:  [[ 4.9013918   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.07150486 -0.12518908  1.14733956]
Stock Position:  0.07150486453574964
Bond Position:  [-6.15912408]


portfolio before change:  [1.0304682]
curr_Stock_Price:  100.5899760830429
curr_Factors:  [100.58997608  -2.15391723  -0.96774873]
mat_Sqrt:  [[ 4.43437488  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0253568  -0.03886077  0.36634918]
Stock Position:  0.025356797434870276
Bond Position:  [-1.52017144]


portfolio before change:  [1.02556974]
curr_Stock_Price:  100.42677766453818
curr_Factors:  [100.42677766  -1.47615777  -1.01157164]
mat_Sqrt:  [[ 8.34530806  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03818176 -0.13682016 -1.13383134]
Stock Position:  0.03818176057812782
Bond Position:  [-2.80890144]


portfolio before change:  [1.04482223]
curr_Stock_Price:  100.96780291293454
curr_Factors:  [100.96780291  -1.80628645  -0.98483876]
mat_Sqrt:  [[ 6.19459088  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02363713  0.04365559 -0.46786086]
Stock Position:  -0.023637131176029412
Bond Position:  [3.43141144]


portfolio before change:  [1.03219237]
curr_Stock_Price:  101.57472947642066
curr_Factors:  [101.57472948  -1.38986262  -1.06213554]
mat_Sqrt:  [[ 8.74775084  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00870525  0.01111431  0.1593346 ]
Stock Position:  -0.008705247364616557
Bond Position:  [1.91642551]


portfolio before change:  [1.03895552]
curr_Stock_Price:  100.90792479628804
curr_Factors:  [100.9079248   -1.21060378  -1.08828501]
mat_Sqrt:  [[10.12816015  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00829291 -0.10157847  0.47096096]
Stock Position:  -0.008292914277950904
Bond Position:  [1.87577629]


portfolio before change:  [1.03169237]
curr_Stock_Price:  101.89687418800861
curr_Factors:  [101.89687419  -1.16296204  -1.05401371]
mat_Sqrt:  [[11.10044851  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00644622  0.01990622  0.42397888]
Stock Position:  -0.006446219097305786
Bond Position:  [1.68854194]


portfolio before change:  [1.02601025]
curr_Stock_Price:  102.90934312443359
curr_Factors:  [102.90934312  -1.2681769   -1.06861159]
mat_Sqrt:  [[ 9.94490081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00118926 -0.01359426  0.06668596]
Stock Position:  -0.001189257573925348
Bond Position:  [1.14839597]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.02579451]
Stock Price:  103.57369452776179
PL:  [-2.54790002]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-3.20923777e-02  4.08546773e-02  4.76114047e-02]
 [ 4.07427202e-01 -5.89479102e-01  5.58463626e-01]
 [-2.28035158e-01  3.03625112e-02 -1.73235056e-01]
 [ 4.36828189e-01 -3.73351224e-01 -3.99501234e-01]
 [ 2.57639230e-02  1.19923398e-02  1.48851302e-01]
 [ 9.70715607e-02  5.30878991e-02 -2.11812873e-01]
 [-6.26422555e-02 -1.20649077e-01  1.90655892e-01]
 [-6.01241732e-02 -1.34472701e-02  1.38255406e-01]
 [ 2.15363720e-02  7.68428864e-03  9.71579831e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.9897216]
curr_Stock_Price:  100.23992791594945
curr_Factors:  [100.23992792  -1.56015675  -1.02251107]
mat_Sqrt:  [[ 7.57534406  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00185263  0.01318579  0.13582209]
Stock Position:  -0.0018526306132419107
Bond Position:  [4.17542916]


portfolio before change:  [3.99113394]
curr_Stock_Price:  100.60476004467941
curr_Factors:  [100.60476004  -0.83624595  -1.02120255]
mat_Sqrt:  [[15.70141869  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02554522 -0.19025356  1.59314128]
Stock Position:  0.025545220008388422
Bond Position:  [1.42116321]


portfolio before change:  [3.92391243]
curr_Stock_Price:  97.94546533375488
curr_Factors:  [97.94546533 -0.89659517 -1.03763572]
mat_Sqrt:  [[14.15658603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01816814  0.00979946 -0.49419139]
Stock Position:  -0.018168144031064534
Bond Position:  [5.70339975]


portfolio before change:  [3.90186649]
curr_Stock_Price:  99.31590571979514
curr_Factors:  [99.31590572 -0.69084795 -1.07114888]
mat_Sqrt:  [[17.05270606  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01636516 -0.12049859 -1.13966582]
Stock Position:  0.016365164585174785
Bond Position:  [2.27654534]


portfolio before change:  [3.86179344]
curr_Stock_Price:  96.79765410477481
curr_Factors:  [96.7976541  -0.28347961 -1.11252428]
mat_Sqrt:  [[23.96558553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00244501 0.00387051 0.42463133]
Stock Position:  0.0024450057278562216
Bond Position:  [3.62512262]


portfolio before change:  [3.85385787]
curr_Stock_Price:  92.81051257090253
curr_Factors:  [92.81051257 -0.24224742 -1.10188798]
mat_Sqrt:  [[24.20173967  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0026722   0.01713405 -0.60424317]
Stock Position:  0.002672202988315697
Bond Position:  [3.60584934]


portfolio before change:  [3.85816377]
curr_Stock_Price:  93.74701595420082
curr_Factors:  [93.74701595 -0.94352572 -1.09703195]
mat_Sqrt:  [[12.1830076   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00396882 -0.03893932  0.54388819]
Stock Position:  -0.003968820827361376
Bond Position:  [4.23022888]


portfolio before change:  [3.85532163]
curr_Stock_Price:  94.99619915510138
curr_Factors:  [94.99619916 -1.19361607 -1.04055159]
mat_Sqrt:  [[10.17230895  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00340609 -0.00434009  0.39440419]
Stock Position:  -0.0034060918992814444
Bond Position:  [4.17888742]


portfolio before change:  [3.85893887]
curr_Stock_Price:  94.54780451235193
curr_Factors:  [94.54780451 -1.73790127 -1.00872065]
mat_Sqrt:  [[ 6.06469137  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00707987 0.00248009 0.27716468]
Stock Position:  0.007079867465174286
Bond Position:  [3.18955295]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.8563982]
Stock Price:  93.96363464009958
PL:  [3.8563982]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-2.31463845e-02  4.48747380e-02  4.73076725e-02]
 [ 3.91630153e-01 -6.26374625e-01  5.62460166e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.46986344e-01 -4.94048448e-01 -3.25138508e-01]
 [-1.39695302e-01  9.55581138e-02 -6.78582028e-02]
 [-7.02729728e-02 -2.38299060e-02  1.35541943e-02]
 [-3.71512158e-01  3.05439186e-01  2.73205962e-01]
 [-9.97006681e-02  7.74818724e-02  2.27600067e-01]
 [-2.17303649e-02 -4.35946337e-02  2.83644916e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.6073117]
curr_Stock_Price:  100.31779730460396
curr_Factors:  [100.3177973   -1.09967307  -0.98688621]
mat_Sqrt:  [[12.45078717  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034775  0.01448326  0.13495562]
Stock Position:  -0.00034774738878578165
Bond Position:  [4.64219695]


portfolio before change:  [4.60966273]
curr_Stock_Price:  100.23337963802265
curr_Factors:  [100.23337964  -0.50358822  -0.94816739]
mat_Sqrt:  [[23.47053144  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01613017 -0.20216154  1.60454229]
Stock Position:  0.01613017028655459
Bond Position:  [2.99288125]


portfolio before change:  [4.65752347]
curr_Stock_Price:  103.10774033144378
curr_Factors:  [103.10774033  -0.83527083  -0.94947184]
mat_Sqrt:  [[17.30562854  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00203449 -0.02755111  0.34758667]
Stock Position:  0.0020344869709816448
Bond Position:  [4.44775212]


portfolio before change:  [4.65948169]
curr_Stock_Price:  102.97689079373468
curr_Factors:  [102.97689079  -0.76734381  -0.99267107]
mat_Sqrt:  [[17.71638156  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02143612 -0.15945345 -0.92752966]
Stock Position:  0.021436121455110514
Bond Position:  [2.45205656]


portfolio before change:  [4.68775089]
curr_Stock_Price:  104.2384463183615
curr_Factors:  [104.23844632  -0.38796947  -0.93806816]
mat_Sqrt:  [[27.67815296  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00484285  0.03084125 -0.19358056]
Stock Position:  -0.0048428477719821075
Bond Position:  [5.19256181]


portfolio before change:  [4.69523801]
curr_Stock_Price:  103.22866978418428
curr_Factors:  [103.22866978  -0.49798789  -0.92025033]
mat_Sqrt:  [[24.99581492  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0028953  -0.00769107  0.03866634]
Stock Position:  -0.0028953044310096117
Bond Position:  [4.99411644]


portfolio before change:  [4.69673757]
curr_Stock_Price:  103.57340682949147
curr_Factors:  [103.57340683  -0.34213615  -0.94292528]
mat_Sqrt:  [[28.6518834   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00884398  0.09858007  0.77938056]
Stock Position:  -0.008843980994532
Bond Position:  [5.61273882]


portfolio before change:  [4.75822257]
curr_Stock_Price:  96.93861994677204
curr_Factors:  [96.93861995 -0.15653414 -0.98223404]
mat_Sqrt:  [[31.04102809  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0012057   0.02500717  0.64927964]
Stock Position:  -0.0012056971150109252
Bond Position:  [4.87510119]


portfolio before change:  [4.75476218]
curr_Stock_Price:  101.83085691371362
curr_Factors:  [101.83085691  -0.18936763  -0.97753882]
mat_Sqrt:  [[31.7028545   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0007835  -0.01407011  0.080916  ]
Stock Position:  -0.0007835005716352723
Bond Position:  [4.83454671]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.75734925]
Stock Price:  101.61491658019926
PL:  [3.14243267]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.72193286e-02  9.79045830e-02  4.87027995e-02]
 [ 4.46169802e-01 -5.61349894e-01  5.79969099e-01]
 [-2.12285933e-02 -5.51974197e-02  6.14135433e-02]
 [ 5.20767913e-01 -4.62033593e-01 -3.72268308e-01]
 [-1.56842749e-01  1.37947097e-01 -2.07580477e-01]
 [-8.63978513e-02  1.49361706e-02  4.30999386e-02]
 [-1.21526682e-02 -3.85595997e-01  2.24358639e-01]
 [-1.14814116e-01  5.34988147e-02  1.29191088e-01]
 [-1.53199243e-02 -4.39190025e-02  2.62828329e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.75983125]
curr_Stock_Price:  99.51499050262858
curr_Factors:  [99.5149905  -1.01158887 -0.99740055]
mat_Sqrt:  [[13.34736344  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00503061 0.03159857 0.13893553]
Stock Position:  0.005030614136371031
Bond Position:  [-2.26045277]


portfolio before change:  [-1.75214147]
curr_Stock_Price:  101.26831322336199
curr_Factors:  [101.26831322  -1.12359129  -1.06305307]
mat_Sqrt:  [[11.37171585  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03956926 -0.1811749   1.65449041]
Stock Position:  0.03956926445078384
Bond Position:  [-5.75925413]


portfolio before change:  [-1.70346596]
curr_Stock_Price:  102.57124009374017
curr_Factors:  [102.57124009  -1.26302661  -1.04726833]
mat_Sqrt:  [[10.17834722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.001961   -0.01781489  0.17519574]
Stock Position:  -0.0019609993638068264
Bond Position:  [-1.50232382]


portfolio before change:  [-1.70210615]
curr_Stock_Price:  101.49466940720666
curr_Factors:  [101.49466941  -1.34751344  -1.03686099]
mat_Sqrt:  [[ 9.35238927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0374735  -0.1491207  -1.06197786]
Stock Position:  0.03747349909135367
Bond Position:  [-5.50546655]


portfolio before change:  [-1.6884367]
curr_Stock_Price:  101.93292230725905
curr_Factors:  [101.93292231  -1.89308553  -1.00953208]
mat_Sqrt:  [[ 5.59401548  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0305785   0.04452223 -0.59216932]
Stock Position:  -0.030578500160350075
Bond Position:  [1.42851918]


portfolio before change:  [-1.70740213]
curr_Stock_Price:  102.57650743788479
curr_Factors:  [102.57650744  -1.65315494  -0.95769925]
mat_Sqrt:  [[ 7.53647633  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00989206  0.00482063  0.12295213]
Stock Position:  -0.009892060553070205
Bond Position:  [-0.69270911]


portfolio before change:  [-1.70487133]
curr_Stock_Price:  102.28564374603269
curr_Factors:  [102.28564375  -1.76640105  -0.92991875]
mat_Sqrt:  [[ 6.89950406  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00653164 -0.12445057  0.64003275]
Stock Position:  -0.006531644254099178
Bond Position:  [-1.0367779]


portfolio before change:  [-1.70496608]
curr_Stock_Price:  102.22076361531279
curr_Factors:  [102.22076362  -1.41533126  -0.95394916]
mat_Sqrt:  [[ 9.56254974  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00810691  0.01726667  0.36854621]
Stock Position:  -0.008106906366132906
Bond Position:  [-0.87627192]


portfolio before change:  [-1.70951499]
curr_Stock_Price:  102.72782063109663
curr_Factors:  [102.72782063  -1.07864861  -0.94212945]
mat_Sqrt:  [[13.61680799  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00138945 -0.0141748   0.07497761]
Stock Position:  -0.0013894513552967951
Bond Position:  [-1.56677968]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.71017107]
Stock Price:  102.6360551347915
PL:  [-4.3462262]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 4.56135488e-02  1.05294976e-01  4.89047560e-02]
 [ 2.73330539e-01 -3.20012764e-01  3.63804718e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.70128117e-01 -4.06525412e-01 -4.04458822e-01]
 [-4.58893187e-02  1.27866946e-02  8.23509823e-02]
 [-4.53103146e-02  6.50763286e-02 -6.98584672e-02]
 [-2.16260302e-01 -8.93965791e-02  2.25814956e-01]
 [-4.86817168e-02  2.69451811e-02  2.62955046e-01]
 [ 1.72177364e-01  1.19292075e-01  1.33317111e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.70952144]
curr_Stock_Price:  99.2691621050205
curr_Factors:  [99.26916211 -1.20077722 -0.99584926]
mat_Sqrt:  [[11.03650578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00698495 0.03398381 0.13951166]
Stock Position:  0.006984949647374506
Bond Position:  [-4.40291154]


portfolio before change:  [-3.71214234]
curr_Stock_Price:  99.20919065201868
curr_Factors:  [99.20919065 -1.3970948  -1.02102915]
mat_Sqrt:  [[ 8.83840744  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0319367  -0.10328368  1.0378336 ]
Stock Position:  0.031936696322288315
Bond Position:  [-6.88055614]


portfolio before change:  [-3.69428416]
curr_Stock_Price:  99.87611377346802
curr_Factors:  [99.87611377 -0.88662519 -1.00827232]
mat_Sqrt:  [[15.01474984  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0023449  -0.02755111  0.34758667]
Stock Position:  0.0023448992612977067
Bond Position:  [-3.92848359]


portfolio before change:  [-3.69605182]
curr_Stock_Price:  99.96015784072672
curr_Factors:  [99.96015784 -0.87493206 -0.95853111]
mat_Sqrt:  [[15.97952986  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01906105 -0.13120551 -1.15380844]
Stock Position:  0.019061052276065943
Bond Position:  [-5.60139761]


portfolio before change:  [-3.70489178]
curr_Stock_Price:  99.64335686615014
curr_Factors:  [99.64335687 -0.34132674 -0.99546654]
mat_Sqrt:  [[26.174983    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00101125  0.00412689  0.23492443]
Stock Position:  -0.0010112488593870888
Bond Position:  [-3.60412755]


portfolio before change:  [-3.70489512]
curr_Stock_Price:  97.86420008499206
curr_Factors:  [ 9.78642001e+01  1.24062511e-02 -1.03678267e+00]
mat_Sqrt:  [[35.13523188  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131738  0.02100329 -0.19928676]
Stock Position:  -0.001317380364310246
Bond Position:  [-3.57597075]


portfolio before change:  [-3.69843254]
curr_Stock_Price:  91.60100232505707
curr_Factors:  [ 9.16010023e+01 -3.62924736e-02 -1.05018114e+00]
mat_Sqrt:  [[30.90656428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00609625 -0.02885262  0.64418722]
Stock Position:  -0.0060962459428890075
Bond Position:  [-3.1400103]


portfolio before change:  [-3.69120413]
curr_Stock_Price:  90.15768707684899
curr_Factors:  [ 9.01576871e+01  6.16849596e-02 -1.05657312e+00]
mat_Sqrt:  [[33.33713896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.14781639e-04 8.69651979e-03 7.50137553e-01]
Stock Position:  0.00031478163932101023
Bond Position:  [-3.71958412]


portfolio before change:  [-3.69263418]
curr_Stock_Price:  91.52438325717254
curr_Factors:  [91.52438326 -0.25720738 -1.02516703]
mat_Sqrt:  [[25.38684214  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00881327 0.03850135 0.38031661]
Stock Position:  0.008813266192821499
Bond Position:  [-4.49926293]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.7144472]
Stock Price:  89.30468085771466
PL:  [-3.7144472]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 6.69278742e-02  1.32199235e-01  5.01574316e-02]
 [ 4.83421881e-01 -6.37636231e-01  6.52526237e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.90220073e-01 -5.43244066e-01 -1.89387523e-01]
 [-1.38949830e-01  9.41306760e-02 -6.26361207e-02]
 [-7.85217612e-02 -4.38194003e-03  2.37518067e-02]
 [-9.95778785e-03 -4.49742585e-01  3.04047733e-01]
 [-1.52995129e-01  6.86864185e-02  3.71826704e-02]
 [ 3.21780716e-02 -3.21824228e-02  7.60481043e-03]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.39240963]
curr_Stock_Price:  99.18305954797782
curr_Factors:  [99.18305955 -0.65365103 -0.97879614]
mat_Sqrt:  [[19.38539721  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00537267 0.04266712 0.14308519]
Stock Position:  0.00537266643489528
Bond Position:  [-4.92528713]


portfolio before change:  [-4.38206197]
curr_Stock_Price:  101.56752301584302
curr_Factors:  [101.56752302  -0.70612194  -0.98759539]
mat_Sqrt:  [[18.6716532   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02605347 -0.20579621  1.86147573]
Stock Position:  0.026053466488712082
Bond Position:  [-7.02824802]


portfolio before change:  [-4.32583192]
curr_Stock_Price:  103.86069392333859
curr_Factors:  [103.86069392  -0.96501252  -1.01713321]
mat_Sqrt:  [[14.3092301   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00246052 -0.02755111  0.34758667]
Stock Position:  0.0024605150356566494
Bond Position:  [-4.58138272]


portfolio before change:  [-4.32368529]
curr_Stock_Price:  105.66433828534015
curr_Factors:  [105.66433829  -1.69826063  -1.0508567 ]
mat_Sqrt:  [[ 6.76086016  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.06517991 -0.17533127 -0.54026989]
Stock Position:  0.06517991291282788
Bond Position:  [-11.21087766]


portfolio before change:  [-4.39629904]
curr_Stock_Price:  104.63630820176598
curr_Factors:  [104.6363082   -1.33139026  -1.02820168]
mat_Sqrt:  [[ 9.88381597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01340788  0.03038055 -0.17868342]
Stock Position:  -0.013407881194994038
Bond Position:  [-2.99334785]


portfolio before change:  [-4.38067341]
curr_Stock_Price:  103.35924740201679
curr_Factors:  [103.3592474   -1.95727582  -1.05847558]
mat_Sqrt:  [[ 5.065533    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01472064 -0.00141427  0.06775729]
Stock Position:  -0.01472064318194819
Bond Position:  [-2.85915881]


portfolio before change:  [-4.38890825]
curr_Stock_Price:  103.8215169590482
curr_Factors:  [103.82151696  -2.21347165  -1.05512369]
mat_Sqrt:  [[ 3.95143141  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01004639 -0.1451538   0.86736355]
Stock Position:  -0.010046390974192711
Bond Position:  [-3.3458767]


portfolio before change:  [-4.39154091]
curr_Stock_Price:  103.91700432599237
curr_Factors:  [103.91700433  -2.63228267  -1.08019208]
mat_Sqrt:  [[ 2.53734381  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.05178041  0.02216845  0.10607181]
Stock Position:  -0.05178040560830189
Bond Position:  [0.98932372]


portfolio before change:  [-4.4019271]
curr_Stock_Price:  104.12714118067315
curr_Factors:  [104.12714118  -2.83636845  -1.09321449]
mat_Sqrt:  [[ 2.04629271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01327336 -0.01038683  0.02169441]
Stock Position:  0.013273363729735466
Bond Position:  [-5.78404452]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.40535935]
Stock Price:  104.08649519538972
PL:  [-8.49185455]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-1.01934307e-01  5.80959466e-02  5.14902335e-02]
 [ 3.97704021e-01 -6.05330853e-01  5.57480592e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 2.88612782e-01 -2.54765380e-01 -2.11236137e-01]
 [-4.53153760e-02  9.38775175e-02  1.50499964e-01]
 [-3.61749587e-02  6.63287538e-02 -6.94921828e-02]
 [-3.14816185e-02 -1.52594605e-01  1.67016382e-01]
 [-6.79289382e-02 -9.99770061e-03  1.23181810e-01]
 [ 7.53134604e-03 -3.68555069e-03  9.52158688e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.97817525]
curr_Stock_Price:  102.25584611505087
curr_Factors:  [102.25584612  -0.79621709  -0.97884299]
mat_Sqrt:  [[17.32963218  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00459128  0.01875039  0.1468873 ]
Stock Position:  -0.004591275839839672
Bond Position:  [20.44766004]


portfolio before change:  [19.99687747]
curr_Stock_Price:  100.40977147063928
curr_Factors:  [100.40977147  -0.70456537  -0.98805193]
mat_Sqrt:  [[18.47913448  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02099322 -0.19536969  1.59033696]
Stock Position:  0.020993224969185972
Bond Position:  [17.88895255]


portfolio before change:  [19.9903789]
curr_Stock_Price:  99.67404465704662
curr_Factors:  [99.67404466 -0.50776615 -1.05568549]
mat_Sqrt:  [[20.87294175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00168678 -0.02755111  0.34758667]
Stock Position:  0.00168678072392885
Bond Position:  [19.82225065]


portfolio before change:  [19.99346213]
curr_Stock_Price:  95.62468500984073
curr_Factors:  [95.62468501 -0.53093818 -1.03079395]
mat_Sqrt:  [[20.05942004  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00964587 -0.08222517 -0.6025979 ]
Stock Position:  0.009645873118978006
Bond Position:  [19.07107855]


portfolio before change:  [20.02054598]
curr_Stock_Price:  97.4436943240993
curr_Factors:  [97.44369432 -1.09143033 -1.01837348]
mat_Sqrt:  [[11.81619339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.86585459e-04 3.02988385e-02 4.29334507e-01]
Stock Position:  0.00038658545874955484
Bond Position:  [19.98287567]


portfolio before change:  [20.03065584]
curr_Stock_Price:  97.74355227730231
curr_Factors:  [97.74355228 -0.81462616 -1.00262253]
mat_Sqrt:  [[15.88060496  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00231859  0.02140751 -0.19824185]
Stock Position:  -0.002318594978887137
Bond Position:  [20.25728355]


portfolio before change:  [20.04310844]
curr_Stock_Price:  96.74233186708243
curr_Factors:  [96.74233187 -1.19002223 -0.9853237 ]
mat_Sqrt:  [[10.98691637  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00259743 -0.0492497   0.47645125]
Stock Position:  -0.002597433583956832
Bond Position:  [20.29439022]


portfolio before change:  [20.05470465]
curr_Stock_Price:  96.18544327162061
curr_Factors:  [96.18544327 -1.37743576 -0.9892817 ]
mat_Sqrt:  [[ 9.02104849  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00496897 -0.00322674  0.35140342]
Stock Position:  -0.0049689710256144385
Bond Position:  [20.53264733]


portfolio before change:  [20.06713924]
curr_Stock_Price:  95.74959918054248
curr_Factors:  [95.74959918 -1.45653793 -1.0199973 ]
mat_Sqrt:  [[ 8.04621026  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00325804 -0.00118951  0.27162437]
Stock Position:  0.003258042375497602
Bond Position:  [19.75518299]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.07712199]
Stock Price:  95.78111899570558
PL:  [20.07712199]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 6.63892277e-02  1.30650474e-01  5.00467902e-02]
 [ 1.39631024e-01  7.42859179e-02  1.10127126e-01]
 [-2.33604549e-01  3.56852026e-02 -2.10640768e-01]
 [ 4.45040245e-01 -3.81503782e-01 -4.03021560e-01]
 [-4.83966511e-02  9.24923064e-02  1.46657314e-01]
 [-1.32609774e-02  7.77435731e-02 -1.16083080e-01]
 [-1.92378907e-01  4.21993277e-02  1.92010309e-01]
 [-1.07130028e-01  6.08560255e-02  1.68306918e-01]
 [-3.36685473e-02 -4.46238121e-02  6.09578330e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.02067687]
curr_Stock_Price:  99.10384392296353
curr_Factors:  [99.10384392 -1.10251471 -1.06316149]
mat_Sqrt:  [[11.36447241  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00908743 0.04216726 0.14276956]
Stock Position:  0.00908743481743528
Bond Position:  [-5.92127659]


portfolio before change:  [-5.03761006]
curr_Stock_Price:  97.56635698337911
curr_Factors:  [97.56635698 -0.7777572  -1.08041589]
mat_Sqrt:  [[15.21618459  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01165037 0.02397568 0.31416204]
Stock Position:  0.011650369895592115
Bond Position:  [-6.17429421]


portfolio before change:  [-5.03843293]
curr_Stock_Price:  97.76077540299774
curr_Factors:  [97.7607754  -0.49445796 -1.08059464]
mat_Sqrt:  [[20.2361544   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01330871  0.01151735 -0.60089948]
Stock Position:  -0.013308714653621326
Bond Position:  [-3.73736267]


portfolio before change:  [-5.06535765]
curr_Stock_Price:  99.64341964578844
curr_Factors:  [99.64341965 -1.18101803 -1.116728  ]
mat_Sqrt:  [[10.01267688  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0284539  -0.12312982 -1.14970833]
Stock Position:  0.028453897311669175
Bond Position:  [-7.90060128]


portfolio before change:  [-5.12674492]
curr_Stock_Price:  97.62485687380892
curr_Factors:  [97.62485687 -0.93410528 -1.07791657]
mat_Sqrt:  [[13.05420485  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [3.21398889e-05 2.98517635e-02 4.18372495e-01]
Stock Position:  3.213988888893252e-05
Bond Position:  [-5.12988257]


portfolio before change:  [-5.12934617]
curr_Stock_Price:  96.51507052369527
curr_Factors:  [96.51507052 -0.85970522 -1.0121408 ]
mat_Sqrt:  [[14.8478213   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00142021  0.02509163 -0.33115272]
Stock Position:  -0.001420208136176403
Bond Position:  [-4.99227468]


portfolio before change:  [-5.13093095]
curr_Stock_Price:  95.87292618963036
curr_Factors:  [95.87292619 -0.42341248 -1.05032339]
mat_Sqrt:  [[21.96143051  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00658295  0.01361977  0.54775197]
Stock Position:  -0.006582952989052068
Bond Position:  [-4.49980399]


portfolio before change:  [-5.14992113]
curr_Stock_Price:  98.41581357092159
curr_Factors:  [98.41581357 -0.62878464 -1.07806074]
mat_Sqrt:  [[17.85629521  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00337989  0.0196412   0.48013279]
Stock Position:  -0.00337989138727862
Bond Position:  [-4.81728637]


portfolio before change:  [-5.15960569]
curr_Stock_Price:  100.5683435747803
curr_Factors:  [100.56834357  -0.42430052  -1.03427796]
mat_Sqrt:  [[23.38884152  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00129696 -0.01440227  0.17389573]
Stock Position:  -0.0012969594610738324
Bond Position:  [-5.02917263]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.16123704]
Stock Price:  99.8868519058596
PL:  [-5.16123704]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-7.95057779e-02  6.77894695e-02  5.25706491e-02]
 [ 3.99597395e-01 -5.81139532e-01  5.47076373e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.80005266e-01 -5.28417868e-01 -2.62513588e-01]
 [-1.55601760e-01  1.21213950e-01 -1.65838082e-01]
 [-7.28342142e-02 -1.80855954e-02  1.29437152e-02]
 [-1.01230183e-01 -2.77543286e-01  1.88727605e-01]
 [-1.17266581e-01  8.97696031e-02  2.03886915e-01]
 [-7.53350269e-03 -4.23216566e-02  2.22697995e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.55170273]
curr_Stock_Price:  101.69773044655872
curr_Factors:  [101.69773045  -0.95770934  -0.97312877]
mat_Sqrt:  [[14.74887596  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00372485  0.02187896  0.14996943]
Stock Position:  -0.003724851416714295
Bond Position:  [15.93051167]


portfolio before change:  [15.56406419]
curr_Stock_Price:  100.5180306630003
curr_Factors:  [100.51803066  -0.87032022  -0.98048068]
mat_Sqrt:  [[15.79251689  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02486268 -0.18756198  1.56065661]
Stock Position:  0.024862679257914674
Bond Position:  [13.06491663]


portfolio before change:  [15.60292387]
curr_Stock_Price:  101.81819579570998
curr_Factors:  [101.8181958   -1.1022773   -0.92925163]
mat_Sqrt:  [[13.35191601  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00263693 -0.02755111  0.34758667]
Stock Position:  0.002636930593360188
Bond Position:  [15.33443635]


portfolio before change:  [15.61683148]
curr_Stock_Price:  104.18400748872396
curr_Factors:  [104.18400749  -1.46822007  -0.97664525]
mat_Sqrt:  [[ 9.03669322  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0463175  -0.17054613 -0.7488782 ]
Stock Position:  0.046317502301548574
Bond Position:  [10.79128848]


portfolio before change:  [15.55258646]
curr_Stock_Price:  102.68042870179119
curr_Factors:  [102.6804287   -1.38274449  -0.96631102]
mat_Sqrt:  [[ 9.8017998   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01680412  0.03912163 -0.47308989]
Stock Position:  -0.016804120242424857
Bond Position:  [17.27804073]


portfolio before change:  [15.5483755]
curr_Stock_Price:  103.44524975269161
curr_Factors:  [103.44524975  -1.28821089  -0.98214239]
mat_Sqrt:  [[10.68337935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00691577 -0.0058371   0.03692482]
Stock Position:  -0.006915770158796425
Bond Position:  [16.26377907]


portfolio before change:  [15.55306518]
curr_Stock_Price:  103.94327664554878
curr_Factors:  [103.94327665  -1.24029178  -0.98739877]
mat_Sqrt:  [[11.20269952  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01065454 -0.08957671  0.53838732]
Stock Position:  -0.010654539796094105
Bond Position:  [16.66053296]


portfolio before change:  [15.55255327]
curr_Stock_Price:  104.77336985265408
curr_Factors:  [104.77336985  -0.90270609  -1.02789077]
mat_Sqrt:  [[15.19859187  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00377168  0.02897301  0.58163262]
Stock Position:  -0.0037716780421977974
Bond Position:  [15.94772469]


portfolio before change:  [15.56144451]
curr_Stock_Price:  104.53067089941767
curr_Factors:  [104.5306709   -0.73809499  -1.03451999]
mat_Sqrt:  [[17.7585227   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0006547  -0.01365926  0.06352954]
Stock Position:  -0.0006547037195075491
Bond Position:  [15.62988113]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.56801429]
Stock Price:  106.43552683260417
PL:  [9.13248746]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-5.45725664e-02  5.36253120e-02  4.99627389e-02]
 [ 4.96309005e-01 -6.30228096e-01  6.60658008e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.80658257e-01 -5.28655976e-01 -2.60120630e-01]
 [-1.36193807e-01  8.88534189e-02 -4.33300122e-02]
 [-5.38989978e-02 -6.55416933e-02 -4.65693046e-02]
 [-2.31655981e-01 -1.11477425e-02  2.33611848e-01]
 [-1.16897058e-01  7.06340828e-02  1.61771899e-01]
 [ 9.05631084e-04 -4.07645599e-02  1.74132889e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.34938962]
curr_Stock_Price:  101.04179223519381
curr_Factors:  [101.04179224  -0.99848322  -0.97031482]
mat_Sqrt:  [[14.10791766  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00236943  0.0173075   0.14252979]
Stock Position:  -0.0023694314664608157
Bond Position:  [10.58880122]


portfolio before change:  [10.35082914]
curr_Stock_Price:  102.6692720987658
curr_Factors:  [102.6692721   -0.94593523  -0.9685228 ]
mat_Sqrt:  [[15.13567956  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03320105 -0.20340524  1.88467341]
Stock Position:  0.03320105204482939
Bond Position:  [6.9421013]


portfolio before change:  [10.34505885]
curr_Stock_Price:  102.39090105593031
curr_Factors:  [102.39090106  -0.97689933  -0.91131364]
mat_Sqrt:  [[15.4960458   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00227207 -0.02755111  0.34758667]
Stock Position:  0.00227206838853813
Bond Position:  [10.11241972]


portfolio before change:  [10.35420789]
curr_Stock_Price:  104.19171338811896
curr_Factors:  [104.19171339  -1.21250566  -0.87800158]
mat_Sqrt:  [[12.88063927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0325799  -0.17062298 -0.74205175]
Stock Position:  0.03257989747130418
Bond Position:  [6.95965255]


portfolio before change:  [10.38002317]
curr_Stock_Price:  104.87724602005777
curr_Factors:  [104.87724602  -1.10991381  -0.92651251]
mat_Sqrt:  [[13.68587482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00927243  0.02867732 -0.12360846]
Stock Position:  -0.009272434727662024
Bond Position:  [11.35249059]


portfolio before change:  [10.38658301]
curr_Stock_Price:  104.78210686838217
curr_Factors:  [104.78210687  -1.12006576  -0.89369532]
mat_Sqrt:  [[13.98691078  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00548967 -0.02115349 -0.13284926]
Stock Position:  -0.005489672501251057
Bond Position:  [10.96180246]


portfolio before change:  [10.39522578]
curr_Stock_Price:  104.20638903520783
curr_Factors:  [104.20638904  -0.83163724  -0.93447037]
mat_Sqrt:  [[17.81900942  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01045208 -0.00359792  0.66642958]
Stock Position:  -0.010452078492288693
Bond Position:  [11.48439914]


portfolio before change:  [10.40384581]
curr_Stock_Price:  103.93119100417242
curr_Factors:  [103.931191    -1.31068614  -0.88830459]
mat_Sqrt:  [[11.52753281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00602535  0.02279705  0.4614902 ]
Stock Position:  -0.006025347011222742
Bond Position:  [11.0300673]


portfolio before change:  [10.40267786]
curr_Stock_Price:  105.0405648619131
curr_Factors:  [105.04056486  -1.33110022  -0.91991861]
mat_Sqrt:  [[11.05992018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00034909 -0.01315671  0.04967527]
Stock Position:  -0.0003490917719533048
Bond Position:  [10.43934666]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.40794877]
Stock Price:  104.89752478384013
PL:  [5.51042399]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-7.28843021e-02  6.40279153e-02  5.18780703e-02]
 [ 3.32900065e-01 -4.90117662e-01  4.68096933e-01]
 [-2.26172459e-01  2.67588546e-02 -1.49027543e-01]
 [ 4.24619232e-01 -3.59804744e-01 -3.92791571e-01]
 [-5.68111765e-02  8.87094913e-02  1.36163581e-01]
 [ 1.59176313e-02  7.89632685e-02 -1.89424459e-01]
 [-1.68809517e-01 -7.36547618e-02  2.10816717e-01]
 [-6.00179220e-02  2.51721958e-02  2.25747937e-01]
 [ 5.03729183e-02  2.52969967e-02  1.09439574e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.48162247]
curr_Stock_Price:  101.31063668346545
curr_Factors:  [101.31063668  -1.31601015  -0.97502801]
mat_Sqrt:  [[10.24872441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00480305  0.02066492  0.14799369]
Stock Position:  -0.004803045712999685
Bond Position:  [12.96822208]


portfolio before change:  [12.49573718]
curr_Stock_Price:  99.72227362848993
curr_Factors:  [99.72227363 -1.01551347 -0.98208497]
mat_Sqrt:  [[13.52839231  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02427525 -0.1581848   1.33535026]
Stock Position:  0.02427524976699566
Bond Position:  [10.07495408]


portfolio before change:  [12.46079474]
curr_Stock_Price:  98.0752800958821
curr_Factors:  [98.0752801  -1.02095642 -0.95180276]
mat_Sqrt:  [[13.63958417  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01841188  0.00863638 -0.4251341 ]
Stock Position:  -0.01841188469497721
Bond Position:  [14.26654548]


portfolio before change:  [12.45730789]
curr_Stock_Price:  98.65218455052522
curr_Factors:  [98.65218455 -1.04773149 -0.92411125]
mat_Sqrt:  [[13.73239491  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01973408 -0.11612648 -1.12052502]
Stock Position:  0.019734078021409404
Bond Position:  [10.51049799]


portfolio before change:  [12.44476697]
curr_Stock_Price:  97.75031881180078
curr_Factors:  [97.75031881 -0.61339287 -0.90660578]
mat_Sqrt:  [[21.37918562  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00051027  0.02863087  0.3884368 ]
Stock Position:  -0.0005102698065470893
Bond Position:  [12.494646]


portfolio before change:  [12.45245622]
curr_Stock_Price:  94.92755610029097
curr_Factors:  [94.9275561  -0.17706495 -0.88454143]
mat_Sqrt:  [[32.83541482  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.01921155e-04  2.54852853e-02 -5.40375257e-01]
Stock Position:  -0.0002019211546489858
Bond Position:  [12.4716241]


portfolio before change:  [12.45897977]
curr_Stock_Price:  93.5102754544865
curr_Factors:  [93.51027545 -0.35850443 -0.84991702]
mat_Sqrt:  [[27.92856153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00504184 -0.02377197  0.60140141]
Stock Position:  -0.0050418439929899245
Bond Position:  [12.93044399]


portfolio before change:  [12.46363517]
curr_Stock_Price:  93.86955631296952
curr_Factors:  [93.86955631 -0.47732576 -0.87530531]
mat_Sqrt:  [[24.27082604  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-3.62536664e-04  8.12429127e-03  6.43996029e-01]
Stock Position:  -0.0003625366635593017
Bond Position:  [12.49766633]


portfolio before change:  [12.46866048]
curr_Stock_Price:  97.24877357395363
curr_Factors:  [ 9.72487736e+01 -1.79402582e-02 -9.01482232e-01]
mat_Sqrt:  [[38.77787612  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00200826 0.00816457 0.31220064]
Stock Position:  0.002008256083393596
Bond Position:  [12.27336004]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.48101716]
Stock Price:  100.34522247002276
PL:  [12.13579469]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-1.35273190e-01  9.94700421e-02  5.84036885e-02]
 [ 4.35259643e-01 -4.90095918e-01  5.34162643e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.06430155e-01 -4.44227609e-01 -3.96616585e-01]
 [-8.77871717e-02  2.50971738e-02 -5.70706364e-02]
 [-7.09786792e-02 -2.22315335e-02  1.35865401e-02]
 [-2.53544505e-01  2.82459431e-01  1.86670820e-01]
 [-1.16021537e-01  1.19436009e-01  2.78474697e-01]
 [-2.01755972e-02 -4.26692410e-02  3.19434106e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.2180981]
curr_Stock_Price:  102.66435463014678
curr_Factors:  [102.66435463  -1.56349683  -0.9512058 ]
mat_Sqrt:  [[ 8.30420774  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01240905  0.03210382  0.16660947]
Stock Position:  -0.012409052522201466
Bond Position:  [24.49206547]


portfolio before change:  [23.24669031]
curr_Stock_Price:  101.34732342026939
curr_Factors:  [101.34732342  -1.56517044  -0.92357744]
mat_Sqrt:  [[ 8.41323105  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05280429 -0.15817778  1.52381734]
Stock Position:  0.05280429400962517
Bond Position:  [17.89511645]


portfolio before change:  [23.23828645]
curr_Stock_Price:  101.01868239230696
curr_Factors:  [101.01868239  -1.16051789  -0.87706982]
mat_Sqrt:  [[13.16705353  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00267395 -0.02755111  0.34758667]
Stock Position:  0.002673952506700075
Bond Position:  [22.96816729]


portfolio before change:  [23.24894357]
curr_Stock_Price:  100.70834323986492
curr_Factors:  [100.70834324  -1.00657975  -0.86777927]
mat_Sqrt:  [[15.45402719  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02166384 -0.14337384 -1.13143672]
Stock Position:  0.02166383870447323
Bond Position:  [21.06721427]


portfolio before change:  [23.27481771]
curr_Stock_Price:  101.41633889222192
curr_Factors:  [101.41633889  -0.51210623  -0.88907808]
mat_Sqrt:  [[24.97936039  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00377567  0.00810008 -0.16280664]
Stock Position:  -0.0037756662287332316
Bond Position:  [23.65773196]


portfolio before change:  [23.27935138]
curr_Stock_Price:  103.34928571726904
curr_Factors:  [103.34928572  -0.76012692  -0.86405943]
mat_Sqrt:  [[20.36724608  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00357158 -0.0071752   0.03875862]
Stock Position:  -0.003571584040562932
Bond Position:  [23.64847204]


portfolio before change:  [23.29661334]
curr_Stock_Price:  101.82761599749618
curr_Factors:  [101.827616    -0.59260226  -0.792629  ]
mat_Sqrt:  [[25.48398175  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00619149  0.09116339  0.53251989]
Stock Position:  -0.0061914850925457445
Bond Position:  [23.92707751]


portfolio before change:  [23.28897944]
curr_Stock_Price:  104.99332261915677
curr_Factors:  [104.99332262  -0.40582387  -0.80912408]
mat_Sqrt:  [[31.15419192  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00111697  0.03854781  0.7944108 ]
Stock Position:  -0.0011169718272887668
Bond Position:  [23.40625403]


portfolio before change:  [23.30459816]
curr_Stock_Price:  101.49040701545528
curr_Factors:  [101.49040702  -0.28885353  -0.81501629]
mat_Sqrt:  [[33.65273966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00066458 -0.01377144  0.09112566]
Stock Position:  -0.0006645817967825966
Bond Position:  [23.37204683]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.31451324]
Stock Price:  104.15953972525843
PL:  [19.15497352]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.88269457e-02  1.95790473e-02  3.98614061e-02]
 [ 1.04629252e-01  1.49476678e-01  5.50444433e-02]
 [-6.74901570e-01  3.63338657e-02 -4.73273124e-01]
 [ 4.77066730e-01 -4.18882795e-01 -3.83524962e-01]
 [-1.51475540e-01  1.13328846e-01 -1.38050494e-01]
 [-7.99437607e-02 -4.42467648e-04  3.30419648e-02]
 [-1.87641408e-01  4.56624116e-03  1.80456319e-01]
 [-1.12070807e-01  5.75915577e-02  1.46465610e-01]
 [-7.60774760e-03 -1.69241675e-02  9.44709070e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.36751534]
curr_Stock_Price:  98.17751135072314
curr_Factors:  [98.17751135 -0.36986631 -0.95170019]
mat_Sqrt:  [[26.18562722  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00194611 0.00631911 0.1137135 ]
Stock Position:  0.0019461125365948337
Bond Position:  [-12.55857983]


portfolio before change:  [-12.37566419]
curr_Stock_Price:  97.21765492218742
curr_Factors:  [97.21765492 -0.63551945 -0.99104213]
mat_Sqrt:  [[19.11342085  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00765833 0.04824339 0.15702648]
Stock Position:  0.007658333473861602
Bond Position:  [-13.12018941]


portfolio before change:  [-12.40479034]
curr_Stock_Price:  94.27126806375617
curr_Factors:  [94.27126806  0.20398722 -0.9971136 ]
mat_Sqrt:  [[42.65097253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01791498  0.0117267  -1.35011649]
Stock Position:  -0.01791498240535517
Bond Position:  [-10.71592223]


portfolio before change:  [-12.52956815]
curr_Stock_Price:  100.93711386260169
curr_Factors:  [100.93711386  -0.34416328  -1.03667668]
mat_Sqrt:  [[25.37229231  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01234717 -0.13519384 -1.09408996]
Stock Position:  0.012347167097488796
Bond Position:  [-13.77585556]


portfolio before change:  [-12.5082297]
curr_Stock_Price:  103.22331475255277
curr_Factors:  [103.22331475  -1.1834484   -1.03513835]
mat_Sqrt:  [[11.22684732  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01394174  0.03657673 -0.39381963]
Stock Position:  -0.01394174344850183
Bond Position:  [-11.06911672]


portfolio before change:  [-12.50660131]
curr_Stock_Price:  102.70943852492591
curr_Factors:  [102.70943852  -1.0408532   -1.05427254]
mat_Sqrt:  [[12.63888626  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00579872 -0.00014281  0.09425953]
Stock Position:  -0.0057987242455894965
Bond Position:  [-11.9110176]


portfolio before change:  [-12.50783701]
curr_Stock_Price:  101.89524331422052
curr_Factors:  [101.89524331  -0.79123127  -1.04162282]
mat_Sqrt:  [[16.2987949   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00919539  0.00147375  0.51479165]
Stock Position:  -0.009195393696027405
Bond Position:  [-11.57087013]


portfolio before change:  [-12.5017476]
curr_Stock_Price:  100.60369519507628
curr_Factors:  [100.6036952   -1.03878621  -1.0509082 ]
mat_Sqrt:  [[12.44718607  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00565733  0.0185876   0.41782562]
Stock Position:  -0.005657327793965231
Bond Position:  [-11.93259952]


portfolio before change:  [-12.49268343]
curr_Stock_Price:  97.94661657337805
curr_Factors:  [97.94661657 -0.73818765 -1.0601267 ]
mat_Sqrt:  [[16.21778124  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00050694 -0.00546225  0.2694992 ]
Stock Position:  0.0005069382911313915
Bond Position:  [-12.54233632]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.49834455]
Stock Price:  99.15310005310872
PL:  [-12.49834455]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-2.93065995e-02  3.98635207e-02  4.73610861e-02]
 [ 3.56179575e-01 -5.52832743e-01  5.02960932e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.67143542e-01 -4.05464340e-01 -3.94743601e-01]
 [-1.19330323e-01  5.65630610e-02  7.47997548e-02]
 [-6.25004598e-02  5.22912984e-02 -1.14099656e-02]
 [-2.89704955e-01  2.61629557e-01  2.12308359e-01]
 [-1.17203628e-01  1.05289237e-01  2.39106024e-01]
 [-1.65579271e-02 -4.39241448e-02  2.76454039e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.023888]
curr_Stock_Price:  100.24423581557818
curr_Factors:  [100.24423582  -1.24290902  -0.96249741]
mat_Sqrt:  [[11.04748871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00104114  0.0128659   0.135108  ]
Stock Position:  -0.0010411371794966688
Bond Position:  [4.128256]


portfolio before change:  [4.02629647]
curr_Stock_Price:  99.91399054935357
curr_Factors:  [99.91399055 -0.79887675 -0.93111198]
mat_Sqrt:  [[17.71339253  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01953322 -0.178426    1.43480754]
Stock Position:  0.019533216681085697
Bond Position:  [2.07465484]


portfolio before change:  [4.03073034]
curr_Stock_Price:  100.08786267458764
curr_Factors:  [100.08786267  -0.38579108  -0.93704931]
mat_Sqrt:  [[26.6611656   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00132058 -0.02755111  0.34758667]
Stock Position:  0.0013205752641337477
Bond Position:  [3.89855678]


portfolio before change:  [4.03281229]
curr_Stock_Price:  100.18796031281006
curr_Factors:  [ 1.00187960e+02 -3.21526755e-02 -9.46888865e-01]
mat_Sqrt:  [[37.6377104   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00807174 -0.13086305 -1.12609362]
Stock Position:  0.008071739136132605
Bond Position:  [3.22412121]


portfolio before change:  [4.08837288]
curr_Stock_Price:  106.87154158111373
curr_Factors:  [106.87154158  -0.34334814  -0.9230102 ]
mat_Sqrt:  [[30.12240455  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00307134  0.01825565  0.21338288]
Stock Position:  -0.0030713351867739194
Bond Position:  [4.41661121]


portfolio before change:  [4.11424174]
curr_Stock_Price:  99.16804963737874
curr_Factors:  [99.16804964 -0.31086195 -0.89526121]
mat_Sqrt:  [[29.68650953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182425  0.01687694 -0.03254946]
Stock Position:  -0.0018242492480552719
Bond Position:  [4.29514898]


portfolio before change:  [4.10996429]
curr_Stock_Price:  102.69035487506748
curr_Factors:  [102.69035488  -0.52365155  -0.88141147]
mat_Sqrt:  [[25.19524211  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0076587   0.08444058  0.60565665]
Stock Position:  -0.007658699306639982
Bond Position:  [4.89643884]


portfolio before change:  [4.11493613]
curr_Stock_Price:  102.3609251829484
curr_Factors:  [102.36092518  -0.5695175   -0.93875228]
mat_Sqrt:  [[22.65170825  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00207067  0.03398195  0.68210293]
Stock Position:  -0.0020706712182523047
Bond Position:  [4.32689195]


portfolio before change:  [4.11337968]
curr_Stock_Price:  104.15765405051573
curr_Factors:  [ 1.04157654e+02 -7.70034307e-02 -8.85598414e-01]
mat_Sqrt:  [[39.77759487  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0004998  -0.01417646  0.07886464]
Stock Position:  -0.000499799226020731
Bond Position:  [4.16543759]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.1170388]
Stock Price:  101.0046223165125
PL:  [3.11241648]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 5.84607990e-02  1.16605880e-01  4.92138479e-02]
 [ 2.77905443e-01 -3.33504798e-01  3.72485007e-01]
 [ 1.00517092e-02 -8.14183328e-02  1.18027607e-01]
 [ 5.51837498e-01 -5.02453674e-01 -2.62308351e-01]
 [-1.20599563e-01  6.98913070e-02 -1.03878696e-01]
 [-9.45816955e-02  3.44364202e-02  5.58535385e-02]
 [-2.48272384e-01  2.40209332e-01  1.85872952e-01]
 [-1.17399310e-01  1.05664446e-01  2.39760387e-01]
 [-2.20100327e-02 -4.85713069e-02  1.79246040e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.17044901]
curr_Stock_Price:  99.08495977042914
curr_Factors:  [99.08495977 -0.93042758 -0.92028028]
mat_Sqrt:  [[15.56881373  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00592907 0.03763439 0.14039341]
Stock Position:  0.005929071462065152
Bond Position:  [-5.75793082]


portfolio before change:  [-5.17395845]
curr_Stock_Price:  98.97874608729421
curr_Factors:  [98.97874609 -0.55446561 -0.87747897]
mat_Sqrt:  [[23.64048158  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01209207 -0.10763821  1.06259605]
Stock Position:  0.012092065205860128
Bond Position:  [-6.3708159]


portfolio before change:  [-5.17079707]
curr_Stock_Price:  99.50368428089571
curr_Factors:  [99.50368428 -0.12252031 -0.88991317]
mat_Sqrt:  [[36.15304551  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00048473 -0.02627765  0.33669991]
Stock Position:  0.0004847322195842033
Bond Position:  [-5.21902971]


portfolio before change:  [-5.17113253]
curr_Stock_Price:  104.19637462035203
curr_Factors:  [104.19637462  -0.46305157  -0.91345842]
mat_Sqrt:  [[26.30521861  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01504382 -0.16216623 -0.74829271]
Stock Position:  0.01504382490933081
Bond Position:  [-6.73864455]


portfolio before change:  [-5.20913964]
curr_Stock_Price:  101.89397199742976
curr_Factors:  [101.893972    -0.79721823  -0.85913346]
mat_Sqrt:  [[19.44482745  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00655893  0.02255732 -0.29633701]
Stock Position:  -0.006558927300176694
Bond Position:  [-4.54082449]


portfolio before change:  [-5.20670169]
curr_Stock_Price:  101.17603041321378
curr_Factors:  [101.17603041  -0.67501435  -0.84746673]
mat_Sqrt:  [[22.07356631  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00344989  0.01111431  0.1593346 ]
Stock Position:  -0.0034498881538097366
Bond Position:  [-4.85765571]


portfolio before change:  [-5.21039243]
curr_Stock_Price:  101.54163746769099
curr_Factors:  [101.54163747  -0.58366902  -0.88109579]
mat_Sqrt:  [[23.46955683  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00687268  0.07752723  0.5302438 ]
Stock Position:  -0.006872677792363932
Bond Position:  [-4.51252948]


portfolio before change:  [-5.25147658]
curr_Stock_Price:  107.1911560491352
curr_Factors:  [107.19115605  -0.72915509  -0.93378791]
mat_Sqrt:  [[20.32132335  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00230742  0.03410305  0.68396965]
Stock Position:  -0.0023074166968709868
Bond Position:  [-5.00414192]


portfolio before change:  [-5.26165239]
curr_Stock_Price:  110.5165673627485
curr_Factors:  [110.51656736  -0.86713991  -0.92362333]
mat_Sqrt:  [[18.43778685  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00153303 -0.01567632  0.05113391]
Stock Position:  -0.0015330345736075247
Bond Position:  [-5.09222667]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.26794193]
Stock Price:  112.95799117040845
PL:  [-18.2259331]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 2.27983523e-02  6.10937099e-02  4.54829611e-02]
 [ 3.89194069e-01 -6.09638950e-01  5.51817700e-01]
 [-4.51048964e-03 -7.81739633e-02  1.14889636e-01]
 [ 4.83270784e-01 -4.27948363e-01 -3.72509715e-01]
 [-1.00906886e-01  6.44550587e-02 -5.95702313e-02]
 [-5.70270295e-02  5.58263816e-02 -2.62897888e-02]
 [-2.95795266e-01  3.04771356e-01  2.10554286e-01]
 [-1.16492901e-01  1.03323897e-01  2.36751157e-01]
 [ 3.18794581e-02  1.17146011e-02  1.04830283e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.57082671]
curr_Stock_Price:  99.93493943271258
curr_Factors:  [99.93493943 -0.63957065 -1.05704963]
mat_Sqrt:  [[18.31827296  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00243217 0.01971791 0.12975023]
Stock Position:  0.002432173835526246
Bond Position:  [1.32776757]


portfolio before change:  [1.57218]
curr_Stock_Price:  100.21832319415589
curr_Factors:  [100.21832319  -0.54175276  -1.08596619]
mat_Sqrt:  [[19.68057475  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01917583 -0.19676013  1.5741823 ]
Stock Position:  0.01917583002625545
Bond Position:  [-0.34958953]


portfolio before change:  [1.5546396]
curr_Stock_Price:  99.31272670033425
curr_Factors:  [99.3127267  -0.20986769 -1.11241887]
mat_Sqrt:  [[26.46934227  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.12736673e-04 -2.52305382e-02  3.27748151e-01]
Stock Position:  0.00011273667286615168
Bond Position:  [1.54344341]


portfolio before change:  [1.55566103]
curr_Stock_Price:  101.52600876669543
curr_Factors:  [101.52600877  -0.38164341  -1.08362243]
mat_Sqrt:  [[23.45419012  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01363841 -0.13811974 -1.06266653]
Stock Position:  0.013638414362263233
Bond Position:  [0.17100726]


portfolio before change:  [1.55137794]
curr_Stock_Price:  101.2056913974344
curr_Factors:  [101.2056914   -0.68385135  -1.08355424]
mat_Sqrt:  [[17.28345021  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00578066  0.02080278 -0.16993729]
Stock Position:  -0.005780661449374953
Bond Position:  [2.13641378]


portfolio before change:  [1.56734227]
curr_Stock_Price:  98.62884838043914
curr_Factors:  [98.62884838 -0.34443514 -1.0620701 ]
mat_Sqrt:  [[24.16387048  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0021105   0.01801789 -0.07499745]
Stock Position:  -0.0021105020334889323
Bond Position:  [1.77549865]


portfolio before change:  [1.56543459]
curr_Stock_Price:  99.95348347290593
curr_Factors:  [99.95348347 -0.25172271 -1.02243142]
mat_Sqrt:  [[27.95373385  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00681858  0.09836453  0.60065277]
Stock Position:  -0.006818583171428571
Bond Position:  [2.24697573]


portfolio before change:  [1.5524986]
curr_Stock_Price:  102.01546098492706
curr_Factors:  [102.01546098  -0.53225621  -0.96700692]
mat_Sqrt:  [[22.77950546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00206657  0.03334764  0.67538515]
Stock Position:  -0.0020665668872259188
Bond Position:  [1.76332037]


portfolio before change:  [1.56246626]
curr_Stock_Price:  97.61890253755013
curr_Factors:  [97.61890254 -0.16896544 -0.98625807]
mat_Sqrt:  [[30.74869747  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00181045 0.00378087 0.29905162]
Stock Position:  0.00181045337037289
Bond Position:  [1.38573179]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.56924706]
Stock Price:  100.9814649231652
PL:  [0.58778214]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 5.03380863e-02  1.09454527e-01  4.90184236e-02]
 [ 1.04620697e-01  1.49601555e-01  5.51276334e-02]
 [-2.36261402e-01  3.35963670e-02 -1.98797575e-01]
 [ 3.97296511e-01 -3.41053017e-01 -3.54883181e-01]
 [-1.10925148e-01  1.10509930e-01 -3.85504897e-02]
 [-9.45816955e-02  3.44364202e-02  5.58535385e-02]
 [-8.04792272e-02 -1.68134476e-01  1.63308176e-01]
 [-1.11824001e-01  4.00416013e-02  1.07570467e-01]
 [-5.38682919e-02 -5.42913839e-02  3.89746430e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.62292466]
curr_Stock_Price:  99.40616661234208
curr_Factors:  [99.40616661 -0.74487679 -0.95910348]
mat_Sqrt:  [[18.08773146  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0045714  0.0353263  0.13983592]
Stock Position:  0.004571399237719906
Bond Position:  [-3.07734994]


portfolio before change:  [-2.63574045]
curr_Stock_Price:  96.93936596799475
curr_Factors:  [96.93936597 -0.63281898 -1.01190098]
mat_Sqrt:  [[18.71575592  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00782287 0.04828369 0.15726379]
Stock Position:  0.007822866920807222
Bond Position:  [-3.39408421]


portfolio before change:  [-2.63094658]
curr_Stock_Price:  97.76915596482226
curr_Factors:  [97.76915596 -0.77859954 -1.03606214]
mat_Sqrt:  [[15.925912    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01695243  0.01084318 -0.56711415]
Stock Position:  -0.016952433075582824
Bond Position:  [-0.97352151]


portfolio before change:  [-2.64321756]
curr_Stock_Price:  98.4642829383709
curr_Factors:  [98.46428294 -0.85638939 -1.12282845]
mat_Sqrt:  [[13.60552599  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01875996 -0.11007439 -1.01238293]
Stock Position:  0.0187599604521216
Bond Position:  [-4.49040361]


portfolio before change:  [-2.60523118]
curr_Stock_Price:  100.60885812750263
curr_Factors:  [100.60885813  -0.95171518  -1.18479839]
mat_Sqrt:  [[11.87846065  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00810176  0.03566693 -0.10997382]
Stock Position:  -0.008101764325392238
Bond Position:  [-1.79012192]


portfolio before change:  [-2.60627017]
curr_Stock_Price:  100.62659660108541
curr_Factors:  [100.6265966   -0.96897642  -1.14609949]
mat_Sqrt:  [[12.13799597  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0062738   0.01111431  0.1593346 ]
Stock Position:  -0.006273798007740856
Bond Position:  [-1.97495923]


portfolio before change:  [-2.59177508]
curr_Stock_Price:  98.15874169345282
curr_Factors:  [98.15874169 -0.96872386 -1.13291018]
mat_Sqrt:  [[12.00054356  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00678839 -0.05426517  0.46587277]
Stock Position:  -0.006788391807219231
Bond Position:  [-1.92543508]


portfolio before change:  [-2.61128541]
curr_Stock_Price:  100.89096081091697
curr_Factors:  [100.89096081  -1.36420622  -1.07418535]
mat_Sqrt:  [[ 8.80789761  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00927495  0.01292337  0.3068686 ]
Stock Position:  -0.009274950438485884
Bond Position:  [-1.67552675]


portfolio before change:  [-2.61513676]
curr_Stock_Price:  101.21585491116477
curr_Factors:  [101.21585491  -0.86416704  -1.10097142]
mat_Sqrt:  [[14.18403378  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00401824 -0.01752247  0.11118381]
Stock Position:  -0.00401823694537248
Bond Position:  [-2.20842747]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.61514179]
Stock Price:  100.94223738225057
PL:  [-3.55737917]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 6.42782635e-02  1.24580853e-01  4.96131851e-02]
 [ 3.13878746e-01 -4.39595131e-01  4.40739712e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.99633527e-01 -4.39994446e-01 -3.86940566e-01]
 [-7.78854484e-02  2.77727585e-02 -3.21364326e-02]
 [-4.61483803e-02 -8.47994337e-02 -6.87843112e-02]
 [-1.31834513e-01 -2.22934552e-01  2.02192420e-01]
 [-1.15670204e-01  7.39921605e-02  1.72946131e-01]
 [-1.17292962e-02 -4.27043162e-02  2.58243214e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.32025892]
curr_Stock_Price:  99.06607085734379
curr_Factors:  [99.06607086 -0.77030535 -0.91746085]
mat_Sqrt:  [[18.32050296  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00544938 0.0402083  0.14153261]
Stock Position:  0.005449384928955056
Bond Position:  [-5.86010807]


portfolio before change:  [-5.32078417]
curr_Stock_Price:  99.50750308100112
curr_Factors:  [99.50750308 -0.98675859 -0.91401368]
mat_Sqrt:  [[14.87171049  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02112147 -0.14187872  1.25730772]
Stock Position:  0.021121469722799786
Bond Position:  [-7.42252888]


portfolio before change:  [-5.28905807]
curr_Stock_Price:  101.18533590284248
curr_Factors:  [101.1853359   -0.59265576  -0.94345129]
mat_Sqrt:  [[21.77683514  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00161677 -0.02755111  0.34758667]
Stock Position:  0.0016167673392093154
Bond Position:  [-5.45265121]


portfolio before change:  [-5.29201669]
curr_Stock_Price:  101.04207565851429
curr_Factors:  [101.04207566  -0.7789757   -0.94034063]
mat_Sqrt:  [[18.10558927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0182726  -0.1420076  -1.10383373]
Stock Position:  0.018272596360843715
Bond Position:  [-7.13831776]


portfolio before change:  [-5.30176004]
curr_Stock_Price:  100.704231366928
curr_Factors:  [100.70423137  -0.58407895  -0.89586165]
mat_Sqrt:  [[22.92544017  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00343619  0.00896362 -0.0916763 ]
Stock Position:  -0.0034361904955733822
Bond Position:  [-4.95572111]


portfolio before change:  [-5.3195062]
curr_Stock_Price:  105.14743244942227
curr_Factors:  [105.14743245  -0.78717451  -0.93088786]
mat_Sqrt:  [[18.86486337  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00410809 -0.0273689  -0.19622249]
Stock Position:  -0.004108088644164215
Bond Position:  [-4.88755123]


portfolio before change:  [-5.31932154]
curr_Stock_Price:  104.50746461053906
curr_Factors:  [104.50746461  -1.17140774  -0.92479761]
mat_Sqrt:  [[12.84626559  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01059207 -0.07195182  0.57679869]
Stock Position:  -0.010592065245146779
Bond Position:  [-4.21237166]


portfolio before change:  [-5.29687266]
curr_Stock_Price:  102.18916327043169
curr_Factors:  [102.18916327  -1.1060128   -0.88860912]
mat_Sqrt:  [[13.90437752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00469378  0.02388087  0.49336717]
Stock Position:  -0.004693783365385279
Bond Position:  [-4.81721886]


portfolio before change:  [-5.30462127]
curr_Stock_Price:  103.32671024212262
curr_Factors:  [103.32671024  -0.68625531  -0.89852879]
mat_Sqrt:  [[21.18115376  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00071643 -0.01378276  0.0736696 ]
Stock Position:  -0.0007164345677997059
Bond Position:  [-5.23059444]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.30658936]
Stock Price:  102.4224248450982
PL:  [-7.7290142]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-8.55932694e-02  7.12476758e-02  5.32073754e-02]
 [ 4.75631629e-01 -5.73474132e-01  6.13149375e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.75986394e-01 -5.30829672e-01 -1.81691288e-01]
 [-1.34506013e-01  8.56216145e-02 -3.15069069e-02]
 [-4.91628550e-02 -7.74172445e-02 -6.15276221e-02]
 [-2.13214298e-01 -9.47497130e-02  2.13427370e-01]
 [-1.13703411e-01  1.03848802e-01  2.46106753e-01]
 [-3.55681443e-02 -4.60548445e-02  5.54610186e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.56595312]
curr_Stock_Price:  101.69952721944566
curr_Factors:  [101.69952722  -1.38737697  -1.0278318 ]
mat_Sqrt:  [[ 9.08671891  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00662384  0.02299509  0.15178583]
Stock Position:  -0.006623841793820894
Bond Position:  [16.2395947]


portfolio before change:  [15.57430182]
curr_Stock_Price:  101.66527743647588
curr_Factors:  [101.66527744  -1.11382395  -0.97946881]
mat_Sqrt:  [[12.53334966  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03859545 -0.18508798  1.7491445 ]
Stock Position:  0.03859545274251211
Bond Position:  [11.65048441]


portfolio before change:  [15.56887988]
curr_Stock_Price:  101.37382778270174
curr_Factors:  [101.37382778  -0.52314511  -1.0201511 ]
mat_Sqrt:  [[21.66111552  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0016254  -0.02755111  0.34758667]
Stock Position:  0.0016254045537737382
Bond Position:  [15.4041064]


portfolio before change:  [15.58383582]
curr_Stock_Price:  105.83545817978714
curr_Factors:  [105.83545818  -1.24977371  -1.05145132]
mat_Sqrt:  [[10.59794994  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04062518 -0.17132454 -0.51831467]
Stock Position:  0.04062518355122632
Bond Position:  [11.2842509]


portfolio before change:  [15.56611116]
curr_Stock_Price:  105.26024375374917
curr_Factors:  [105.26024375  -1.32240125  -1.10812056]
mat_Sqrt:  [[ 9.26194421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0133298   0.02763426 -0.08988044]
Stock Position:  -0.013329803316581268
Bond Position:  [16.96920951]


portfolio before change:  [15.58001948]
curr_Stock_Price:  104.85351640685093
curr_Factors:  [104.85351641  -0.84838387  -1.14567889]
mat_Sqrt:  [[14.27488272  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00543086 -0.02498631 -0.17552118]
Stock Position:  -0.005430857728466427
Bond Position:  [16.14946401]


portfolio before change:  [15.59546057]
curr_Stock_Price:  103.49749928443889
curr_Factors:  [103.49749928  -0.80315356  -1.15505402]
mat_Sqrt:  [[14.60464848  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01294035 -0.03058034  0.60884888]
Stock Position:  -0.0129403540680296
Bond Position:  [16.93475486]


portfolio before change:  [15.64264895]
curr_Stock_Price:  100.50539562832665
curr_Factors:  [100.50539563  -0.17911028  -1.14585842]
mat_Sqrt:  [[26.71546777  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00158219  0.03351706  0.70207406]
Stock Position:  -0.001582193223488316
Bond Position:  [15.8016679]


portfolio before change:  [15.65030986]
curr_Stock_Price:  100.65828301613271
curr_Factors:  [100.65828302  -0.44797023  -1.14588084]
mat_Sqrt:  [[20.44790395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00164555 -0.01486414  0.15821485]
Stock Position:  -0.0016455533621660447
Bond Position:  [15.81594843]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.65666221]
Stock Price:  101.60483542520986
PL:  [14.05182678]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 7.23533696e-02  1.49180999e-01  5.14587132e-02]
 [ 4.80054380e-01 -6.11854780e-01  6.36485758e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.18696682e-01 -4.61844810e-01 -3.63766160e-01]
 [-1.55225965e-01  1.26076476e-01 -1.76280136e-01]
 [-8.55490357e-02  1.29136349e-02  4.17771550e-02]
 [-1.39809999e-01 -1.65228651e-01  1.76237567e-01]
 [-1.12514954e-01  8.67827588e-02  2.11062191e-01]
 [-7.52670618e-03 -1.73865400e-02  9.52366633e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.85824362]
curr_Stock_Price:  98.61998095407276
curr_Factors:  [98.61998095 -0.60280666 -1.0154481 ]
mat_Sqrt:  [[19.5508571   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00579559 0.04814796 0.14679739]
Stock Position:  0.005795591403284923
Bond Position:  [-9.42980473]


portfolio before change:  [-8.84568867]
curr_Stock_Price:  101.60000870582674
curr_Factors:  [101.60000871  -0.87411011  -1.09802637]
mat_Sqrt:  [[14.13857872  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03430912 -0.19747528  1.8157167 ]
Stock Position:  0.03430911740376667
Bond Position:  [-12.3314953]


portfolio before change:  [-8.81526145]
curr_Stock_Price:  102.66662047678442
curr_Factors:  [102.66662048  -1.0635807   -1.14097915]
mat_Sqrt:  [[11.324032    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00310915 -0.02755111  0.34758667]
Stock Position:  0.0031091466173589575
Bond Position:  [-9.13446703]


portfolio before change:  [-8.82259086]
curr_Stock_Price:  101.77858609036251
curr_Factors:  [101.77858609  -1.30820823  -1.11136561]
mat_Sqrt:  [[ 9.05417421  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03867493 -0.14905977 -1.0377236 ]
Stock Position:  0.03867492942024943
Bond Position:  [-12.75887049]


portfolio before change:  [-8.79786251]
curr_Stock_Price:  102.58296719782624
curr_Factors:  [102.5829672   -1.50524951  -1.12446822]
mat_Sqrt:  [[ 7.39610998  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02237308  0.04069101 -0.50287816]
Stock Position:  -0.022373077843423066
Bond Position:  [-6.5027658]


portfolio before change:  [-8.79070003]
curr_Stock_Price:  102.11746688806033
curr_Factors:  [102.11746689  -0.91296541  -1.09976924]
mat_Sqrt:  [[13.645218    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00545138  0.00416786  0.11917859]
Stock Position:  -0.005451384139629433
Bond Position:  [-8.23401849]


portfolio before change:  [-8.79568556]
curr_Stock_Price:  102.2765999416104
curr_Factors:  [102.27659994  -0.96673907  -1.12384224]
mat_Sqrt:  [[12.64294805  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0108806  -0.05332732  0.50275672]
Stock Position:  -0.010880596308235659
Bond Position:  [-7.68285517]


portfolio before change:  [-8.77694006]
curr_Stock_Price:  100.20062091302205
curr_Factors:  [100.20062091  -0.44887006  -1.10448991]
mat_Sqrt:  [[21.19604098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00243997  0.02800901  0.60210168]
Stock Position:  -0.0024399654663647932
Bond Position:  [-8.53245401]


portfolio before change:  [-8.77685331]
curr_Stock_Price:  98.41615210614431
curr_Factors:  [98.41615211 -0.52663687 -1.05646968]
mat_Sqrt:  [[20.20840059  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00041391 -0.00561148  0.27168369]
Stock Position:  0.0004139062693955209
Bond Position:  [-8.81758837]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.78300565]
Stock Price:  94.20641105734835
PL:  [-8.78300565]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 1.90626247e-02  8.19191591e-02  4.82659675e-02]
 [ 2.49498590e-01 -2.49728991e-01  3.18586666e-01]
 [-2.21354516e-01  2.26836184e-02 -1.20064058e-01]
 [ 4.28656154e-01 -3.62730729e-01 -3.96766552e-01]
 [-1.02112704e-01  1.10150205e-01 -1.75149228e-02]
 [-5.78248181e-02  3.46211099e-02  6.84601524e-02]
 [-6.42049014e-02 -2.29451311e-01  1.67603990e-01]
 [-1.16961318e-01  7.39617459e-02  1.69095691e-01]
 [-1.35336045e-02 -4.34163075e-02  2.57588785e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.20411036]
curr_Stock_Price:  99.71114493525918
curr_Factors:  [99.71114494 -1.02532559 -0.96909198]
mat_Sqrt:  [[13.56997841  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00336305 0.02643929 0.13768937]
Stock Position:  0.0033630526937421263
Bond Position:  [-0.53944419]


portfolio before change:  [-0.2065096]
curr_Stock_Price:  99.07795427793592
curr_Factors:  [99.07795428 -1.6972521  -0.93855433]
mat_Sqrt:  [[ 7.10004077  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03712008 -0.08059969  0.90883908]
Stock Position:  0.037120083137125684
Bond Position:  [-3.8842915]


portfolio before change:  [-0.23883336]
curr_Stock_Price:  98.2594989421321
curr_Factors:  [98.25949894 -1.08081811 -0.86790489]
mat_Sqrt:  [[13.99764259  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01723377  0.00732111 -0.34250934]
Stock Position:  -0.0172337744207133
Bond Position:  [1.45454868]


portfolio before change:  [-0.24454594]
curr_Stock_Price:  98.63318562804203
curr_Factors:  [98.63318563 -1.01611734 -0.87314088]
mat_Sqrt:  [[14.91175091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01834958 -0.11707084 -1.13186454]
Stock Position:  0.018349583628161942
Bond Position:  [-2.05442383]


portfolio before change:  [-0.22606169]
curr_Stock_Price:  99.69651837294695
curr_Factors:  [99.69651837 -1.27831268 -0.87449368]
mat_Sqrt:  [[11.58052022  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00718479  0.03555083 -0.0499652 ]
Stock Position:  -0.0071847900000951695
Bond Position:  [0.49023685]


portfolio before change:  [-0.23055047]
curr_Stock_Price:  100.35540370554861
curr_Factors:  [100.35540371  -1.41306649  -0.81190693]
mat_Sqrt:  [[10.84543771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00339161  0.01117392  0.19529776]
Stock Position:  -0.0033916052607400266
Bond Position:  [0.10981545]


portfolio before change:  [-0.2371208]
curr_Stock_Price:  102.30883125168255
curr_Factors:  [102.30883125  -1.27714007  -0.84236728]
mat_Sqrt:  [[12.28634694  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00625324 -0.07405509  0.47812753]
Stock Position:  -0.006253236480589957
Bond Position:  [0.40264051]


portfolio before change:  [-0.24340102]
curr_Stock_Price:  103.34534958280561
curr_Factors:  [103.34534958  -1.29010465  -0.78678372]
mat_Sqrt:  [[12.95119313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00520009  0.02387105  0.48238294]
Stock Position:  -0.005200094334316342
Bond Position:  [0.29400454]


portfolio before change:  [-0.23746223]
curr_Stock_Price:  102.23157009987347
curr_Factors:  [102.2315701   -1.42142138  -0.7922823 ]
mat_Sqrt:  [[11.17341013  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00153381 -0.01401255  0.07348291]
Stock Position:  -0.001533812140817338
Bond Position:  [-0.0806582]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.23738502]
Stock Price:  102.15493599627662
PL:  [-2.39232102]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-6.63877919e-02  6.03373521e-02  5.11985624e-02]
 [ 4.70775089e-01 -5.90908028e-01  6.17436053e-01]
 [ 5.29167373e-02 -8.23276090e-02  9.62679609e-02]
 [ 5.72096187e-01 -5.18793463e-01 -2.95333900e-01]
 [-1.57336507e-01  1.23943093e-01 -1.76158528e-01]
 [-8.20545477e-02  4.58706046e-03  3.63313888e-02]
 [-2.10957166e-01  1.85709453e-01  1.81085664e-01]
 [-1.12939029e-01  7.76608951e-02  1.89227935e-01]
 [-4.53483400e-02 -5.20292491e-02  3.60810822e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.60464786]
curr_Stock_Price:  101.3261484482189
curr_Factors:  [101.32614845  -0.92119653  -0.94291125]
mat_Sqrt:  [[15.7090461   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00277678  0.0194738   0.14605525]
Stock Position:  -0.0027767834180266147
Bond Position:  [12.88600863]


portfolio before change:  [12.61050577]
curr_Stock_Price:  101.53743724602344
curr_Factors:  [101.53743725  -0.98306868  -0.92618358]
mat_Sqrt:  [[15.04694995  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03164695 -0.19071475  1.7613732 ]
Stock Position:  0.03164695178135012
Bond Position:  [9.39715539]


portfolio before change:  [12.70019297]
curr_Stock_Price:  104.2229231773429
curr_Factors:  [104.22292318  -1.52251292  -1.0003089 ]
mat_Sqrt:  [[ 8.36210576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00666845 -0.02657112  0.2746257 ]
Stock Position:  0.0066684518599442
Bond Position:  [12.00518742]


portfolio before change:  [12.70156162]
curr_Stock_Price:  103.52779307137317
curr_Factors:  [103.52779307  -1.29514479  -0.95393726]
mat_Sqrt:  [[10.92177016  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03716551 -0.16743987 -0.84250541]
Stock Position:  0.03716550782413484
Bond Position:  [8.85389862]


portfolio before change:  [12.66177902]
curr_Stock_Price:  102.33823152815069
curr_Factors:  [102.33823153  -1.33956496  -0.88364158]
mat_Sqrt:  [[11.07928091  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01516298  0.04000246 -0.50253125]
Stock Position:  -0.015162982085747108
Bond Position:  [14.21353179]


portfolio before change:  [12.66621093]
curr_Stock_Price:  102.51475591372153
curr_Factors:  [102.51475591  -0.90386366  -0.86943777]
mat_Sqrt:  [[17.40409153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00423476  0.00148047  0.10364334]
Stock Position:  -0.0042347573353487215
Bond Position:  [13.10033604]


portfolio before change:  [12.67876918]
curr_Stock_Price:  101.09638605663723
curr_Factors:  [101.09638606  -0.70056012  -0.83074706]
mat_Sqrt:  [[21.86237674  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00622464  0.05993747  0.51658699]
Stock Position:  -0.006224640076574978
Bond Position:  [13.3080578]


portfolio before change:  [12.68922318]
curr_Stock_Price:  100.48618115489526
curr_Factors:  [100.48618115  -0.8350308   -0.81405477]
mat_Sqrt:  [[19.31601699  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00302653  0.02506495  0.53981463]
Stock Position:  -0.003026533628283164
Bond Position:  [12.99334799]


portfolio before change:  [12.69300669]
curr_Stock_Price:  101.38317645058598
curr_Factors:  [101.38317645  -1.05017778  -0.78644574]
mat_Sqrt:  [[16.15587303  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00300843 -0.01679237  0.10292928]
Stock Position:  -0.0030084258454715377
Bond Position:  [12.99801046]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.70119574]
Stock Price:  100.821946020952
PL:  [11.87924972]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 2.02680019e-02  8.29803906e-02  4.82949676e-02]
 [ 2.83908941e-01 -3.51209959e-01  3.83875871e-01]
 [-2.14978257e-01  2.54522038e-02 -1.34089182e-01]
 [ 3.97661431e-01 -3.34993020e-01 -3.78805096e-01]
 [-6.19057976e-02  1.00321224e-01  9.74933626e-02]
 [-4.80308686e-03  6.16603033e-02 -5.03833170e-02]
 [-3.55146659e-02 -2.17132243e-01  1.68970710e-01]
 [-9.44022804e-02  3.78591330e-02  1.53673340e-01]
 [-7.26770398e-03 -1.68084297e-02  9.47470938e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.31812122]
curr_Stock_Price:  99.7769909622473
curr_Factors:  [99.77699096 -1.1495952  -1.04293191]
mat_Sqrt:  [[11.13853256  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00422537 0.02678181 0.1377721 ]
Stock Position:  0.004225374570458531
Bond Position:  [-0.10347394]


portfolio before change:  [0.31610665]
curr_Stock_Price:  99.31245854064873
curr_Factors:  [99.31245854 -1.39093591 -1.06046073]
mat_Sqrt:  [[ 8.5580673   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03395356 -0.11335253  1.09509101]
Stock Position:  0.03395355896089843
Bond Position:  [-3.05590477]


portfolio before change:  [0.27656853]
curr_Stock_Price:  98.19299449451746
curr_Factors:  [98.19299449 -1.24316506 -1.0855098 ]
mat_Sqrt:  [[ 9.56642916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0247902   0.00821466 -0.38251911]
Stock Position:  -0.024790199501754935
Bond Position:  [2.71079245]


portfolio before change:  [0.2755009]
curr_Stock_Price:  98.29074951752366
curr_Factors:  [98.29074952 -1.7851401  -1.07001268]
mat_Sqrt:  [[ 5.6563406   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04454435 -0.10811853 -1.0806255 ]
Stock Position:  0.04454434735791456
Bond Position:  [-4.10279639]


portfolio before change:  [0.25590306]
curr_Stock_Price:  97.89685161038803
curr_Factors:  [97.89685161 -1.64061677 -1.00634799]
mat_Sqrt:  [[ 6.93755655  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00310297  0.03237854  0.27812143]
Stock Position:  -0.003102974937946343
Bond Position:  [0.55967454]


portfolio before change:  [0.25659488]
curr_Stock_Price:  97.76410317872107
curr_Factors:  [97.76410318 -1.87135616 -1.03936011]
mat_Sqrt:  [[ 5.32195755  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00046997  0.01990078 -0.14372958]
Stock Position:  -0.00046997400000464847
Bond Position:  [0.30254147]


portfolio before change:  [0.25662338]
curr_Stock_Price:  98.02542104011323
curr_Factors:  [98.02542104 -1.22499863 -1.0455526 ]
mat_Sqrt:  [[10.12163902  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00448006 -0.07007913  0.4820264 ]
Stock Position:  -0.004480064695576804
Bond Position:  [0.69578361]


portfolio before change:  [0.2579202]
curr_Stock_Price:  97.81362814038631
curr_Factors:  [97.81362814 -0.9095943  -1.01729136]
mat_Sqrt:  [[14.24175666  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00388336  0.01221898  0.43838726]
Stock Position:  -0.0038833606954312145
Bond Position:  [0.6377658]


portfolio before change:  [0.25727447]
curr_Stock_Price:  98.06204494441992
curr_Factors:  [98.06204494 -0.68033089 -1.05873906]
mat_Sqrt:  [[17.22790484  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0005016  -0.0054249   0.27028709]
Stock Position:  0.0005015966408862942
Bond Position:  [0.20808688]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.2581071]
Stock Price:  99.51452085050038
PL:  [0.2581071]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 6.47882104e-02  1.26047095e-01  4.97179313e-02]
 [ 3.30653771e-01 -4.83998042e-01  4.64626131e-01]
 [-5.08866569e-02 -5.68267884e-02  7.78507784e-02]
 [ 4.30775525e-01 -3.66025902e-01 -4.02787971e-01]
 [-1.11086977e-01  1.13586488e-01 -4.60731927e-02]
 [-8.35333400e-02  3.33519549e-02  5.84792326e-02]
 [ 2.70804378e-02 -4.39571782e-01  3.10675863e-01]
 [-1.13691029e-01  2.02563529e-02  5.74376798e-02]
 [ 2.32652795e-02 -3.38621605e-02  1.26312707e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.24456286]
curr_Stock_Price:  99.07561506140948
curr_Factors:  [99.07561506 -1.14372906 -1.03707115]
mat_Sqrt:  [[11.19070067  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00899551 0.04068153 0.14183142]
Stock Position:  0.008995513247601124
Bond Position:  [-6.13579887]


portfolio before change:  [-5.2424198]
curr_Stock_Price:  99.6549841913008
curr_Factors:  [99.65498419 -0.92650758 -1.04798275]
mat_Sqrt:  [[13.83530603  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02361346 -0.1562097   1.32544902]
Stock Position:  0.023613463686876897
Bond Position:  [-7.59561915]


portfolio before change:  [-5.26404484]
curr_Stock_Price:  98.90006424158501
curr_Factors:  [98.90006424 -0.98744801 -1.04275203]
mat_Sqrt:  [[12.98649352  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00358797 -0.01834077  0.2220866 ]
Stock Position:  -0.00358797029038784
Bond Position:  [-4.90919434]


portfolio before change:  [-5.26751075]
curr_Stock_Price:  99.1817551234396
curr_Factors:  [99.18175512 -1.11098368 -1.08814796]
mat_Sqrt:  [[10.99919889  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02489655 -0.11813435 -1.14904197]
Stock Position:  0.02489654503474024
Bond Position:  [-7.73679378]


portfolio before change:  [-5.24168819]
curr_Stock_Price:  100.3743672001287
curr_Factors:  [100.3743672   -1.16815266  -1.10839644]
mat_Sqrt:  [[10.30220314  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00944515  0.03665988 -0.13143399]
Stock Position:  -0.00944515285616767
Bond Position:  [-4.29363695]


portfolio before change:  [-5.24960245]
curr_Stock_Price:  100.98493540692552
curr_Factors:  [100.98493541  -1.65010792  -1.05764727]
mat_Sqrt:  [[ 6.73431543  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00962063  0.0107643   0.16682497]
Stock Position:  -0.009620633007422965
Bond Position:  [-4.27806345]


portfolio before change:  [-5.26156804]
curr_Stock_Price:  102.0062836365
curr_Factors:  [102.00628364  -2.40803524  -1.0501912 ]
mat_Sqrt:  [[ 3.21172437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.39643419e-04 -1.41871183e-01  8.86271763e-01]
Stock Position:  0.00023964341892330874
Bond Position:  [-5.28601317]


portfolio before change:  [-5.26411108]
curr_Stock_Price:  102.42616520804256
curr_Factors:  [102.42616521  -1.93892192  -1.06216297]
mat_Sqrt:  [[ 5.09396914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01920542  0.00653771  0.16385371]
Stock Position:  -0.019205416893842055
Bond Position:  [-3.29697388]


portfolio before change:  [-5.27559467]
curr_Stock_Price:  102.93824413114734
curr_Factors:  [102.93824413  -2.34305481  -1.03184912]
mat_Sqrt:  [[ 3.52269142  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00537417 -0.01092897  0.0360335 ]
Stock Position:  0.005374169911695244
Bond Position:  [-5.82880229]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.278196]
Stock Price:  102.99663454179857
PL:  [-8.27483054]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 4.58613692e-02  8.34041038e-02  4.62438487e-02]
 [ 4.21431084e-01 -6.40158666e-01  5.96785596e-01]
 [ 1.43196800e-02 -7.70868766e-02  1.05262967e-01]
 [ 5.32210502e-01 -4.71582639e-01 -3.76343601e-01]
 [-1.56848276e-01  1.48334966e-01 -2.31740788e-01]
 [-7.05556999e-02  3.30336557e-02  6.38767535e-02]
 [-1.12182686e-02 -3.59790909e-01  1.93237461e-01]
 [-9.81805899e-02  1.01906414e-02  8.01462633e-02]
 [-7.50928219e-02 -5.81916240e-02  7.53852012e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.11773742]
curr_Stock_Price:  99.59594946597046
curr_Factors:  [99.59594947 -0.60754701 -1.05054567]
mat_Sqrt:  [[18.97322572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00381198 0.02691856 0.13192083]
Stock Position:  0.0038119847275109014
Bond Position:  [-1.49739566]


portfolio before change:  [-1.10373162]
curr_Stock_Price:  103.46655497044911
curr_Factors:  [103.46655497  -1.04135856  -1.07397073]
mat_Sqrt:  [[12.47740146  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03306599 -0.20661032  1.70246319]
Stock Position:  0.03306598691067033
Bond Position:  [-4.52495537]


portfolio before change:  [-1.12037813]
curr_Stock_Price:  103.03156193019409
curr_Factors:  [103.03156193  -1.14798234  -1.04679199]
mat_Sqrt:  [[11.47603602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00174896 -0.02487968  0.30028595]
Stock Position:  0.0017489576086516913
Bond Position:  [-1.30057597]


portfolio before change:  [-1.1239882]
curr_Stock_Price:  101.33934464433861
curr_Factors:  [101.33934464  -1.69579317  -1.00342251]
mat_Sqrt:  [[ 6.81590636  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05268973 -0.15220264 -1.07360354]
Stock Position:  0.05268973249442646
Bond Position:  [-6.46353116]


portfolio before change:  [-1.11742086]
curr_Stock_Price:  101.52533756081199
curr_Factors:  [101.52533756  -2.28729649  -1.02642489]
mat_Sqrt:  [[ 3.69354616  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04707493  0.0478749  -0.66109196]
Stock Position:  -0.04707492777974823
Bond Position:  [3.66187708]


portfolio before change:  [-1.09744761]
curr_Stock_Price:  101.13995513992523
curr_Factors:  [101.13995514  -1.92840882  -1.0007563 ]
mat_Sqrt:  [[ 5.40508475  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00939374  0.01066157  0.1822226 ]
Stock Position:  -0.009393737149592888
Bond Position:  [-0.14736546]


portfolio before change:  [-1.09520749]
curr_Stock_Price:  100.89364000660471
curr_Factors:  [100.89364001  -1.59370044  -1.03134576]
mat_Sqrt:  [[ 7.30837317  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00618686 -0.11612202  0.55125269]
Stock Position:  -0.006186855498712198
Bond Position:  [-0.47099312]


portfolio before change:  [-1.08791661]
curr_Stock_Price:  99.67711907270375
curr_Factors:  [99.67711907 -1.67820057 -1.00211224]
mat_Sqrt:  [[ 6.83204022  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01167157  0.00328902  0.22863498]
Stock Position:  -0.011671571574548867
Bond Position:  [0.07547202]


portfolio before change:  [-1.08047527]
curr_Stock_Price:  99.04279198143162
curr_Factors:  [99.04279198 -1.64135634 -0.97971225]
mat_Sqrt:  [[ 7.20289771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00993811 -0.01878127  0.215053  ]
Stock Position:  -0.009938111089659748
Bond Position:  [-0.096177]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.07486057]
Stock Price:  98.4729853997217
PL:  [-1.07486057]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 2.01519825e-02  8.28782454e-02  4.82921763e-02]
 [ 2.54765538e-01 -2.65261963e-01  3.28580022e-01]
 [-2.43648069e-01  3.40857169e-02 -2.06263059e-01]
 [ 4.12350138e-01 -3.53480395e-01 -3.62084135e-01]
 [-1.25586703e-01  1.03925716e-01 -9.44223503e-02]
 [-7.09235375e-02 -2.26394017e-02  9.95207537e-03]
 [-7.01419386e-02 -3.54848623e-01  1.97837648e-01]
 [-1.16831828e-01  6.72561952e-02  1.54337568e-01]
 [-1.83221027e-03 -4.19952897e-02  1.68761777e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.1034531]
curr_Stock_Price:  99.87601022057643
curr_Factors:  [99.87601022 -0.92649429 -1.02325798]
mat_Sqrt:  [[14.21328728  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00330163 0.02674884 0.13776414]
Stock Position:  0.003301631197877679
Bond Position:  [0.77369935]


portfolio before change:  [1.09997559]
curr_Stock_Price:  98.70554289857786
curr_Factors:  [98.7055429  -0.50331798 -0.94416563]
mat_Sqrt:  [[23.21172401  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01153255 -0.08561293  0.93734734]
Stock Position:  0.011532546336241057
Bond Position:  [-0.03835065]


portfolio before change:  [1.08865324]
curr_Stock_Price:  97.72543218776347
curr_Factors:  [97.72543219 -0.49799102 -0.90262806]
mat_Sqrt:  [[24.08388032  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01157594  0.01100112 -0.5884111 ]
Stock Position:  -0.011575942832650024
Bond Position:  [2.21991726]


portfolio before change:  [1.08266557]
curr_Stock_Price:  98.3385928611991
curr_Factors:  [98.33859286 -0.44544913 -0.90138039]
mat_Sqrt:  [[25.57427664  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01041226 -0.11408531 -1.03292525]
Stock Position:  0.010412264785787963
Bond Position:  [0.0587381]


portfolio before change:  [1.11309673]
curr_Stock_Price:  101.25839812733803
curr_Factors:  [101.25839813  -0.95109906  -0.92748736]
mat_Sqrt:  [[15.47288639  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00799119  0.03354188 -0.26936068]
Stock Position:  -0.007991193973755185
Bond Position:  [1.92227223]


portfolio before change:  [1.09653212]
curr_Stock_Price:  103.45156050037025
curr_Factors:  [103.4515605   -1.01278199  -0.9458744 ]
mat_Sqrt:  [[14.59161575  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00503805 -0.00730684  0.0283905 ]
Stock Position:  -0.00503805256579083
Bond Position:  [1.61772652]


portfolio before change:  [1.09382403]
curr_Stock_Price:  104.14967830532471
curr_Factors:  [104.14967831  -1.39654649  -0.93821812]
mat_Sqrt:  [[10.08515424  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01013288 -0.1145269   0.56437574]
Stock Position:  -0.01013288118943047
Bond Position:  [2.14916035]


portfolio before change:  [1.07615767]
curr_Stock_Price:  105.99922225618919
curr_Factors:  [105.99922226  -1.40336666  -0.94432128]
mat_Sqrt:  [[10.13245679  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00706632  0.02170684  0.44028212]
Stock Position:  -0.007066320812870041
Bond Position:  [1.82518218]


portfolio before change:  [1.0770653]
curr_Stock_Price:  105.99995648342006
curr_Factors:  [105.99995648  -1.29824172  -0.96354454]
mat_Sqrt:  [[11.04140637  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00063032 -0.01355392  0.04814304]
Stock Position:  -0.0006303207496421312
Bond Position:  [1.14387927]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.07668444]
Stock Price:  107.51179977193372
PL:  [-6.43511534]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 7.03372011e-02  1.42002017e-01  5.08577286e-02]
 [ 3.55341537e-01 -5.10234248e-01  4.70780110e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.37591180e-01 -4.85472129e-01 -3.30860980e-01]
 [-1.20701732e-01  9.45574715e-02 -8.30745350e-02]
 [-7.53337519e-02 -1.14270759e-02  2.58577850e-02]
 [-2.61446060e-01  2.22314974e-01  1.86050970e-01]
 [-1.11744011e-01  1.02711977e-01  2.49279678e-01]
 [-2.06505272e-02 -3.18478784e-02  8.06089925e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.98941535]
curr_Stock_Price:  99.10778555816992
curr_Factors:  [99.10778556 -0.66884301 -1.00213625]
mat_Sqrt:  [[18.63848893  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00588591 0.04583095 0.14508294]
Stock Position:  0.0058859134012727255
Bond Position:  [-5.5727552]


portfolio before change:  [-4.98637689]
curr_Stock_Price:  100.09752795520475
curr_Factors:  [100.09752796  -1.23438888  -1.06072161]
mat_Sqrt:  [[10.08485212  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0344366  -0.1646774   1.34300461]
Stock Position:  0.034436597699656145
Bond Position:  [-8.43339519]


portfolio before change:  [-5.00338882]
curr_Stock_Price:  99.72599947503781
curr_Factors:  [99.72599948 -0.77061117 -1.02436277]
mat_Sqrt:  [[16.56765793  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00212511 -0.02755111  0.34758667]
Stock Position:  0.0021251088084700016
Bond Position:  [-5.21531742]


portfolio before change:  [-4.99925045]
curr_Stock_Price:  102.90074310812086
curr_Factors:  [102.90074311  -0.7247073   -1.06966322]
mat_Sqrt:  [[17.10540251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02168659 -0.15668546 -0.94385428]
Stock Position:  0.021686591828724077
Bond Position:  [-7.23081687]


portfolio before change:  [-5.03378057]
curr_Stock_Price:  101.47526306880413
curr_Factors:  [101.47526307  -0.82502867  -1.08100455]
mat_Sqrt:  [[15.08622131  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00784542  0.03051829 -0.23698852]
Stock Position:  -0.007845423004742494
Bond Position:  [-4.23766421]


portfolio before change:  [-5.04604904]
curr_Stock_Price:  102.76889667243083
curr_Factors:  [102.76889667  -0.5327062   -1.09998457]
mat_Sqrt:  [[20.08135903  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00360474 -0.00368807  0.07376506]
Stock Position:  -0.0036047408735349422
Bond Position:  [-4.67559379]


portfolio before change:  [-5.04016024]
curr_Stock_Price:  100.48657462883403
curr_Factors:  [100.48657463  -0.45460317  -1.08057212]
mat_Sqrt:  [[21.64660964  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00822709  0.07175185  0.53075163]
Stock Position:  -0.008227094866295645
Bond Position:  [-4.21344766]


portfolio before change:  [-5.03297388]
curr_Stock_Price:  99.356940239441
curr_Factors:  [ 9.93569402e+01 -7.67746219e-02 -1.06589839e+00]
mat_Sqrt:  [[31.69141466  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00125883  0.03315015  0.71112554]
Stock Position:  -0.0012588272164213423
Bond Position:  [-4.90790066]


portfolio before change:  [-5.03607513]
curr_Stock_Price:  99.87066448032232
curr_Factors:  [99.87066448 -0.25724688 -1.10905623]
mat_Sqrt:  [[25.47182378  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00041996 -0.01027886  0.22995502]
Stock Position:  -0.0004199623293732893
Bond Position:  [-4.99413322]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.03895969]
Stock Price:  100.79186461330013
PL:  [-5.83082431]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 4.18750699e-02  7.57319772e-04  3.50603805e-02]
 [ 2.39961443e-01 -2.21602604e-01  3.00491160e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.69515363e-01 -4.07301338e-01 -4.02050825e-01]
 [-1.34844268e-01  1.21100822e-01 -1.17996038e-01]
 [-7.45040645e-02  3.64674518e-02  6.31968546e-02]
 [-4.32872669e-02 -2.87680769e-01  1.64506422e-01]
 [-1.11752185e-01  3.10636896e-02  8.75136806e-02]
 [-4.69205827e-02 -5.25961597e-02  3.61798517e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.16832721]
curr_Stock_Price:  100.76679106855781
curr_Factors:  [100.76679107  -0.32104084  -1.00800217]
mat_Sqrt:  [[26.67604139  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00184384 0.00024442 0.10001751]
Stock Position:  0.0018438390717325827
Bond Position:  [7.98252946]


portfolio before change:  [8.16814251]
curr_Stock_Price:  98.5014300700289
curr_Factors:  [98.50143007 -0.40558447 -1.02519925]
mat_Sqrt:  [[23.55380429  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01087147 -0.07152193  0.85721764]
Stock Position:  0.010871471072623587
Bond Position:  [7.09728706]


portfolio before change:  [8.19994163]
curr_Stock_Price:  101.09993604005369
curr_Factors:  [101.09993604  -0.91876753  -1.03949936]
mat_Sqrt:  [[14.26547961  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00246806 -0.02755111  0.34758667]
Stock Position:  0.0024680611349195553
Bond Position:  [7.9504208]


portfolio before change:  [8.20155433]
curr_Stock_Price:  100.14230215177895
curr_Factors:  [100.14230215  -0.87009532  -1.04045714]
mat_Sqrt:  [[14.8209206   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02053226 -0.13145594 -1.14693909]
Stock Position:  0.020532263366303812
Bond Position:  [6.14540621]


portfolio before change:  [8.22930115]
curr_Stock_Price:  101.34398882589997
curr_Factors:  [101.34398883  -1.17530413  -1.02947654]
mat_Sqrt:  [[11.17567882  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01200916  0.03908512 -0.33660985]
Stock Position:  -0.012009159244185415
Bond Position:  [9.44635725]


portfolio before change:  [8.25041218]
curr_Stock_Price:  99.97947407232222
curr_Factors:  [99.97947407 -0.9574817  -0.97836818]
mat_Sqrt:  [[14.42719584  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00375403  0.01176982  0.18028304]
Stock Position:  -0.003754033265175266
Bond Position:  [8.62573846]


portfolio before change:  [8.25113407]
curr_Stock_Price:  100.93632697162151
curr_Factors:  [100.93632697  -1.27152024  -0.97145177]
mat_Sqrt:  [[10.71364205  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0063872  -0.09284857  0.46929103]
Stock Position:  -0.006387195381831654
Bond Position:  [8.89583412]


portfolio before change:  [8.2550983]
curr_Stock_Price:  101.01222972466998
curr_Factors:  [101.01222972  -1.58847933  -0.99109738]
mat_Sqrt:  [[ 7.65734167  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01143317  0.01002576  0.24965217]
Stock Position:  -0.01143316894911685
Bond Position:  [9.40998819]


portfolio before change:  [8.24895451]
curr_Stock_Price:  101.96121910102472
curr_Factors:  [101.9612191   -0.72752679  -1.04143831]
mat_Sqrt:  [[17.38534203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00289161 -0.01697534  0.10321105]
Stock Position:  -0.0028916053201227233
Bond Position:  [8.54378612]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.25406906]
Stock Price:  101.67017297352484
PL:  [6.58389609]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 7.57455703e-03  1.81456625e-02  4.15968592e-02]
 [ 1.04137142e-01  1.56660580e-01  5.98302059e-02]
 [-9.73676024e-01  2.95836010e-02 -6.04966636e-01]
 [ 1.22153850e-01 -1.25127591e-01 -2.28618918e-03]
 [ 2.63552493e-01 -1.06479069e-01  2.09829132e-01]
 [ 1.45934205e-01  4.13130920e-02 -2.27953099e-01]
 [-1.61153413e-01 -1.16251407e-01  2.08598116e-01]
 [-5.54296458e-02  1.11559239e-02  2.07546421e-01]
 [ 3.80995599e-03 -9.17969624e-03  9.82326153e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.12086227]
curr_Stock_Price:  99.87820527137686
curr_Factors:  [99.87820527 -0.53627732 -0.98705227]
mat_Sqrt:  [[21.7719381   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00090802 0.00585649 0.11866426]
Stock Position:  0.0009080242700783944
Bond Position:  [1.03017044]


portfolio before change:  [1.11688228]
curr_Stock_Price:  94.92767326408102
curr_Factors:  [94.92767326 -0.24928256 -0.94735797]
mat_Sqrt:  [[28.6878801   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00517041 0.05056198 0.17067892]
Stock Position:  0.005170411252709697
Bond Position:  [0.62606717]


portfolio before change:  [1.10224035]
curr_Stock_Price:  92.03524442834238
curr_Factors:  [92.03524443 -0.28606479 -0.99789773]
mat_Sqrt:  [[25.4880337   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04280933  0.00954807 -1.72580142]
Stock Position:  -0.04280932798710423
Bond Position:  [5.04220731]


portfolio before change:  [1.12942376]
curr_Stock_Price:  91.45916252951314
curr_Factors:  [91.45916253 -0.50215637 -1.01405285]
mat_Sqrt:  [[20.07917776  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00478832 -0.04038476 -0.00652186]
Stock Position:  0.004788324612349982
Bond Position:  [0.6914876]


portfolio before change:  [1.13333947]
curr_Stock_Price:  92.2047001414848
curr_Factors:  [92.20470014 -0.48837751 -1.02276766]
mat_Sqrt:  [[20.34562576  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01399066 -0.03436597  0.59858411]
Stock Position:  0.013990660191109198
Bond Position:  [-0.15666516]


portfolio before change:  [1.13099026]
curr_Stock_Price:  92.04238790893704
curr_Factors:  [92.04238791 -0.76469334 -0.97158433]
mat_Sqrt:  [[16.21556431  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00665018  0.01333374 -0.65028674]
Stock Position:  0.006650183184266356
Bond Position:  [0.51889152]


portfolio before change:  [1.13400969]
curr_Stock_Price:  92.45740132733972
curr_Factors:  [92.45740133 -0.31215541 -0.98913147]
mat_Sqrt:  [[25.16517572  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00565477 -0.03751998  0.59507236]
Stock Position:  -0.005654767575830988
Bond Position:  [1.6568348]


portfolio before change:  [1.12873515]
curr_Stock_Price:  93.53669590034492
curr_Factors:  [93.5366959  -0.59738348 -0.95115488]
mat_Sqrt:  [[19.88201318  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-5.42561582e-04  3.60055896e-03  5.92072171e-01]
Stock Position:  -0.0005425615822546332
Bond Position:  [1.17948457]


portfolio before change:  [1.12679023]
curr_Stock_Price:  98.20863016424738
curr_Factors:  [98.20863016 -0.45127152 -0.93240702]
mat_Sqrt:  [[24.61646574  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00089322 -0.00296273  0.28023031]
Stock Position:  0.0008932154277332204
Bond Position:  [1.03906876]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.12528653]
Stock Price:  95.94337684992254
PL:  [1.12528653]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 2.79368433e-02  7.14133419e-02  5.18590440e-02]
 [ 1.27177253e-01  1.11013841e-01  8.64977012e-02]
 [-2.39485433e-01  3.15220799e-02 -1.87379908e-01]
 [ 4.09521369e-01 -3.48738526e-01 -3.74638317e-01]
 [ 4.16323953e-02  2.24580513e-02  1.58982975e-01]
 [ 4.69887008e-02  7.24525662e-02 -1.99175725e-01]
 [-1.66993142e-01  6.80001327e-03  1.91468463e-01]
 [-5.01645469e-02  1.68533560e-03  2.01589006e-01]
 [ 6.79562775e-02  4.04481608e-02  1.10626067e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.43679823]
curr_Stock_Price:  98.4209475114844
curr_Factors:  [98.42094751 -1.41197005 -0.96668245]
mat_Sqrt:  [[ 9.12119811  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00582157 0.02304856 0.14793942]
Stock Position:  0.0058215722386872545
Bond Position:  [-11.00976288]


portfolio before change:  [-10.44686709]
curr_Stock_Price:  97.63720636760127
curr_Factors:  [97.63720637 -1.31458944 -1.01526994]
mat_Sqrt:  [[ 9.50102082  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01762907 0.03582956 0.24675387]
Stock Position:  0.01762906645586159
Bond Position:  [-12.16811989]


portfolio before change:  [-10.45065501]
curr_Stock_Price:  97.76753999353657
curr_Factors:  [97.76753999 -1.09042854 -0.99182956]
mat_Sqrt:  [[12.18656989  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02226219  0.01017371 -0.53454272]
Stock Position:  -0.022262193625948983
Bond Position:  [-8.27413511]


portfolio before change:  [-10.47193335]
curr_Stock_Price:  98.53746561040876
curr_Factors:  [98.53746561 -1.05175594 -1.03223583]
mat_Sqrt:  [[12.26126444  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02135691 -0.11255488 -1.06873884]
Stock Position:  0.021356907375410513
Bond Position:  [-12.57638887]


portfolio before change:  [-10.528448]
curr_Stock_Price:  96.18577254587186
curr_Factors:  [96.18577255 -0.51254899 -1.0044759 ]
mat_Sqrt:  [[21.09965228  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00372844 0.0072483  0.45353418]
Stock Position:  0.003728444841322866
Bond Position:  [-10.88707135]


portfolio before change:  [-10.54199641]
curr_Stock_Price:  94.01234433520573
curr_Factors:  [94.01234434 -0.14480714 -0.97577802]
mat_Sqrt:  [[30.65638433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00068897  0.02338397 -0.5681929 ]
Stock Position:  0.0006889737608483634
Bond Position:  [-10.60676845]


portfolio before change:  [-10.54614417]
curr_Stock_Price:  95.69157225266588
curr_Factors:  [95.69157225 -0.51293297 -0.94787164]
mat_Sqrt:  [[22.20518043  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00569785  0.00219469  0.54620623]
Stock Position:  -0.005697848695237701
Bond Position:  [-10.00090807]


portfolio before change:  [-10.53698677]
curr_Stock_Price:  93.2065797675389
curr_Factors:  [93.20657977 -0.68802448 -0.94667091]
mat_Sqrt:  [[18.17637949  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-4.77066717e-04  5.43939726e-04  5.75077322e-01]
Stock Position:  -0.00047706671741590604
Bond Position:  [-10.49252101]


portfolio before change:  [-10.54311571]
curr_Stock_Price:  95.05406473388844
curr_Factors:  [95.05406473 -0.64733241 -0.97785848]
mat_Sqrt:  [[18.71368241  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00527925 0.01305459 0.31558538]
Stock Position:  0.005279248251195915
Bond Position:  [-11.04492972]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.5506411]
Stock Price:  94.67493169158246
PL:  [-10.5506411]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-1.50278693e-02  5.19053966e-02  4.74457845e-02]
 [ 3.03087255e-01 -4.07769505e-01  4.20264249e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.35597339e-01 -3.69016338e-01 -4.01013955e-01]
 [-4.14577026e-02  9.56117645e-02  1.55310859e-01]
 [ 1.43148233e-02  7.90514739e-02 -1.18920016e-01]
 [ 9.67567052e-04 -2.78090314e-01  2.81593016e-01]
 [-4.98088959e-02 -4.18191998e-02  1.04421650e-01]
 [ 1.20049848e-02  8.71484994e-04  9.45145933e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.50667897]
curr_Stock_Price:  100.17902306258087
curr_Factors:  [100.17902306  -1.06033815  -0.96404389]
mat_Sqrt:  [[13.23118807  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00039695 0.01675239 0.13534962]
Stock Position:  0.00039694890721085114
Bond Position:  [3.46691302]


portfolio before change:  [3.5081446]
curr_Stock_Price:  99.5032089809003
curr_Factors:  [99.50320898 -1.29156394 -0.91011522]
mat_Sqrt:  [[11.00677222  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02776815 -0.13160704  1.19889692]
Stock Position:  0.027768152878144846
Bond Position:  [0.74512428]


portfolio before change:  [3.52865777]
curr_Stock_Price:  100.22851878647613
curr_Factors:  [100.22851879  -1.18323784  -0.91040233]
mat_Sqrt:  [[12.35193334  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00285041 -0.02755111  0.34758667]
Stock Position:  0.0028504101208297952
Bond Position:  [3.24296539]


portfolio before change:  [3.52602602]
curr_Stock_Price:  98.7362291708199
curr_Factors:  [98.73622917 -0.85068955 -0.84050167]
mat_Sqrt:  [[18.19707236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01530002 -0.11909951 -1.14398119]
Stock Position:  0.01530001962084635
Bond Position:  [2.01535978]


portfolio before change:  [3.50196386]
curr_Stock_Price:  97.09766342092158
curr_Factors:  [97.09766342 -1.01837446 -0.89604322]
mat_Sqrt:  [[14.31488098  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00068192 0.03085856 0.44305865]
Stock Position:  0.0006819241815806657
Bond Position:  [3.43575062]


portfolio before change:  [3.50303685]
curr_Stock_Price:  96.15134094087362
curr_Factors:  [96.15134094 -1.30118144 -0.86336537]
mat_Sqrt:  [[11.03836137  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00055957  0.02551375 -0.3392457 ]
Stock Position:  0.0005595659502508402
Bond Position:  [3.44923383]


portfolio before change:  [3.50481552]
curr_Stock_Price:  96.2471757724203
curr_Factors:  [96.24717577 -1.81775548 -0.87697607]
mat_Sqrt:  [[ 6.50250885  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 2.58754435e-04 -8.97532629e-02  8.03306493e-01]
Stock Position:  0.0002587544354385677
Bond Position:  [3.47991114]


portfolio before change:  [3.50632571]
curr_Stock_Price:  95.3575076082862
curr_Factors:  [95.35750761 -1.77754494 -0.88426596]
mat_Sqrt:  [[ 6.65802018  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00556175 -0.01349709  0.2978859 ]
Stock Position:  -0.005561747082621617
Bond Position:  [4.03668005]


portfolio before change:  [3.51378503]
curr_Stock_Price:  94.3793126781819
curr_Factors:  [94.37931268 -2.03222777 -0.90010566]
mat_Sqrt:  [[ 5.02782997  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00626027 0.00028127 0.26962383]
Stock Position:  0.006260272658305105
Bond Position:  [2.92294479]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.51077121]
Stock Price:  93.66438274049166
PL:  [3.51077121]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-3.27516296e-02  4.12291878e-02  4.76803597e-02]
 [ 1.75679389e-01 -3.20257823e-02  1.78524251e-01]
 [-6.05026930e-03 -6.45437321e-02  8.01362746e-02]
 [ 4.67031023e-01 -4.02638732e-01 -4.05459160e-01]
 [-1.46976206e-01  1.18464507e-01 -1.39675753e-01]
 [-7.64767844e-02 -9.11237998e-03  2.23910358e-02]
 [-2.84734650e-02 -2.89848260e-01  1.65568980e-01]
 [-1.13352590e-01  7.93580862e-02  1.91847896e-01]
 [ 3.43047728e-02  1.35907839e-02  1.05299157e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.7714316]
curr_Stock_Price:  100.5906622603449
curr_Factors:  [100.59066226  -0.8143341   -0.96080939]
mat_Sqrt:  [[17.04600623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00085668  0.01330666  0.13601879]
Stock Position:  -0.0008566841985719006
Bond Position:  [6.85760603]


portfolio before change:  [6.77716398]
curr_Stock_Price:  97.90271572114435
curr_Factors:  [97.90271572 -0.5924656  -0.94145547]
mat_Sqrt:  [[21.1164682   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00973568 -0.01033628  0.50928   ]
Stock Position:  0.009735684091218486
Bond Position:  [5.82401407]


portfolio before change:  [6.81490175]
curr_Stock_Price:  101.47976634638376
curr_Factors:  [101.47976635  -1.31754773  -0.92805203]
mat_Sqrt:  [[10.74305687  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00026691 -0.0208314   0.22860649]
Stock Position:  -0.00026691238260764783
Bond Position:  [6.84198796]


portfolio before change:  [6.81876284]
curr_Stock_Price:  99.83414664954746
curr_Factors:  [99.83414665 -1.09513834 -0.94204402]
mat_Sqrt:  [[13.0179336   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02320481 -0.12995109 -1.15666212]
Stock Position:  0.023204814306442133
Bond Position:  [4.50213]


portfolio before change:  [6.87120319]
curr_Stock_Price:  101.99700514808188
curr_Factors:  [101.99700515  -1.12111433  -0.89290536]
mat_Sqrt:  [[13.61161892  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01111594  0.03823426 -0.39845605]
Stock Position:  -0.01111593954829221
Bond Position:  [8.00499574]


portfolio before change:  [6.85946499]
curr_Stock_Price:  103.41314328459885
curr_Factors:  [103.41314328  -1.61600815  -0.87376786]
mat_Sqrt:  [[ 8.57590095  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00860158 -0.00294101  0.06387539]
Stock Position:  -0.008601579078511203
Bond Position:  [7.74898132]


portfolio before change:  [6.87701768]
curr_Stock_Price:  101.82305950531817
curr_Factors:  [101.82305951  -1.40264717  -0.82764968]
mat_Sqrt:  [[10.94562406  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00491903 -0.09354812  0.47232221]
Stock Position:  -0.0049190312496678445
Bond Position:  [7.37788849]


portfolio before change:  [6.88621871]
curr_Stock_Price:  100.70268280592968
curr_Factors:  [100.70268281  -0.81875491  -0.84524016]
mat_Sqrt:  [[19.07116249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304087  0.02561271  0.54728865]
Stock Position:  -0.0030408686868373717
Bond Position:  [7.19244235]


portfolio before change:  [6.89986176]
curr_Stock_Price:  97.39904668381872
curr_Factors:  [97.39904668 -0.25093125 -0.90658061]
mat_Sqrt:  [[30.60932081  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00191357 0.00438641 0.30038918]
Stock Position:  0.0019135700741174865
Bond Position:  [6.71348186]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.89585031]
Stock Price:  93.54811579502524
PL:  [6.89585031]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 1.23552157e-02  6.96815655e-02  4.73501933e-02]
 [ 3.03969103e-01 -4.10370199e-01  4.21937442e-01]
 [-6.79645956e-02 -5.34898084e-02  7.00214494e-02]
 [ 3.61166681e-01 -3.10314739e-01 -3.10579999e-01]
 [-7.58698108e-02  1.06811520e-01  5.03985555e-02]
 [-4.14599706e-02  6.10447987e-02 -4.69393917e-02]
 [-1.06691806e-01  1.29945994e-02  1.64798232e-01]
 [-9.86967446e-02  4.44982992e-02  1.56082047e-01]
 [ 2.43081717e-02  7.67669637e-03  1.00767841e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.8276046]
curr_Stock_Price:  99.96731549753942
curr_Factors:  [99.9673155  -0.67604251 -0.95948039]
mat_Sqrt:  [[19.47867724  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00186071 0.02248963 0.13507692]
Stock Position:  0.0018607127655763894
Bond Position:  [1.64159414]


portfolio before change:  [1.82730893]
curr_Stock_Price:  99.36718234232812
curr_Factors:  [99.36718234 -0.88315202 -0.90521627]
mat_Sqrt:  [[16.61745429  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01843425 -0.13244641  1.20367008]
Stock Position:  0.018434246982344728
Bond Position:  [-0.00445025]


portfolio before change:  [1.8168935]
curr_Stock_Price:  98.80229898625738
curr_Factors:  [98.80229899 -1.22143366 -0.94968162]
mat_Sqrt:  [[11.26843666  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00573195 -0.01726376  0.1997517 ]
Stock Position:  -0.0057319476030134086
Bond Position:  [2.3832231]


portfolio before change:  [1.82692624]
curr_Stock_Price:  97.2599206938427
curr_Factors:  [97.25992069 -0.90225139 -0.98510249]
mat_Sqrt:  [[14.73216374  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0159126  -0.10015365 -0.88599829]
Stock Position:  0.015912603047772794
Bond Position:  [0.27926773]


portfolio before change:  [1.84463423]
curr_Stock_Price:  98.3639714295831
curr_Factors:  [98.36397143 -1.70806169 -0.95196115]
mat_Sqrt:  [[ 6.8802277   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00636308  0.03447327  0.14377305]
Stock Position:  -0.0063630798899413895
Bond Position:  [2.47053204]


portfolio before change:  [1.84627977]
curr_Stock_Price:  98.29954379365431
curr_Factors:  [98.29954379 -0.84972197 -0.91832587]
mat_Sqrt:  [[16.77637338  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00229971  0.01970212 -0.13390502]
Stock Position:  -0.002299705402425439
Bond Position:  [2.07233976]


portfolio before change:  [1.84864477]
curr_Stock_Price:  97.72182668559599
curr_Factors:  [97.72182669 -0.88790371 -0.90887676]
mat_Sqrt:  [[16.20539914  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00434423  0.00419399  0.47012349]
Stock Position:  -0.004344230949951422
Bond Position:  [2.27317096]


portfolio before change:  [1.84674204]
curr_Stock_Price:  98.42151444152722
curr_Factors:  [98.42151444 -0.95102035 -0.94531293]
mat_Sqrt:  [[14.774846    0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0039089   0.01436176  0.44525863]
Stock Position:  -0.0039089038886019846
Bond Position:  [2.23146228]


portfolio before change:  [1.85616087]
curr_Stock_Price:  96.2974349969957
curr_Factors:  [96.297435   -0.9189035  -0.95118255]
mat_Sqrt:  [[14.84043619  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00312958 0.00247764 0.2874626 ]
Stock Position:  0.0031295791848443533
Bond Position:  [1.55479042]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.84836979]
Stock Price:  93.55947298780484
PL:  [1.84836979]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-7.45544330e-04 -3.98592936e-03  3.98348528e-02]
 [ 1.26947537e-01  1.11691305e-01  8.60618457e-02]
 [-2.64654163e-01  3.81138330e-02 -2.44405815e-01]
 [ 3.97233561e-01 -3.42872748e-01 -3.36226804e-01]
 [ 1.03676631e-01 -3.53863137e-02  1.62526295e-01]
 [ 1.00812431e-01  5.95251313e-02 -2.06167896e-01]
 [-1.05848307e-01 -1.89023002e-01  2.78104754e-01]
 [-4.38668999e-02  1.70548853e-03  2.20080834e-01]
 [ 2.79359727e-01  2.01970513e-01  1.54375325e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.09625569]
curr_Stock_Price:  100.25336035992814
curr_Factors:  [100.25336036  -0.46491629  -1.02277977]
mat_Sqrt:  [[22.64648205  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0002902  -0.00128645  0.11363775]
Stock Position:  0.00029020341926383264
Bond Position:  [4.06716182]


portfolio before change:  [4.09747012]
curr_Stock_Price:  97.42893672299263
curr_Factors:  [97.42893672 -0.73020568 -0.99487467]
mat_Sqrt:  [[17.35781613  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0096391  0.03604821 0.24551049]
Stock Position:  0.00963910025700823
Bond Position:  [3.15834283]


portfolio before change:  [4.09813801]
curr_Stock_Price:  97.33435523280001
curr_Factors:  [97.33435523 -0.82289479 -0.88352313]
mat_Sqrt:  [[17.66762904  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01736302  0.01230119 -0.69722176]
Stock Position:  -0.017363016664293057
Bond Position:  [5.78815604]


portfolio before change:  [4.09037519]
curr_Stock_Price:  97.94816690469735
curr_Factors:  [97.9481669  -0.17066803 -0.88429804]
mat_Sqrt:  [[34.10596697  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00758263 -0.1106617  -0.95916148]
Stock Position:  0.007582630495422706
Bond Position:  [3.34767043]


portfolio before change:  [4.0724683]
curr_Stock_Price:  95.36579863932702
curr_Factors:  [95.36579864 -0.49798771 -0.89885509]
mat_Sqrt:  [[23.59128122  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00549478 -0.01142088  0.46364228]
Stock Position:  0.00549478298661311
Bond Position:  [3.54845393]


portfolio before change:  [4.06268726]
curr_Stock_Price:  93.26276627586797
curr_Factors:  [93.26276628 -0.81947393 -0.86437185]
mat_Sqrt:  [[17.31503449  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0040935   0.01921165 -0.58813962]
Stock Position:  0.004093500462068605
Bond Position:  [3.68091608]


portfolio before change:  [4.05602736]
curr_Stock_Price:  91.18610250347123
curr_Factors:  [91.1861025  -0.81863392 -0.88384197]
mat_Sqrt:  [[16.61700568  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00527559 -0.06100691  0.79335545]
Stock Position:  -0.005275593736973589
Bond Position:  [4.53708819]


portfolio before change:  [4.07701564]
curr_Stock_Price:  87.63784295381336
curr_Factors:  [87.63784295 -0.7041652  -0.84252771]
mat_Sqrt:  [[18.66257142  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [7.52867066e-05 5.50444056e-04 6.27829360e-01]
Stock Position:  7.528670656058734e-05
Bond Position:  [4.07041768]


portfolio before change:  [4.07893784]
curr_Stock_Price:  86.12999016153879
curr_Factors:  [86.12999016 -0.74102769 -0.82124768]
mat_Sqrt:  [[18.05788252  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01949833 0.0651857  0.44038983]
Stock Position:  0.019498328005204166
Bond Position:  [2.39954704]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.07274094]
Stock Price:  85.75062560312517
PL:  [4.07274094]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 7.30620113e-02  1.49836619e-01  5.14174216e-02]
 [ 3.53090650e-01 -5.33978735e-01  4.81832824e-01]
 [-2.06977493e-02 -7.45675401e-02  1.11401484e-01]
 [ 4.28146633e-01 -3.62163721e-01 -4.02146169e-01]
 [-6.74899990e-02  9.07950701e-02  1.06838094e-01]
 [-8.89781077e-03  7.98981232e-02 -1.51921251e-01]
 [-1.36663956e-01 -3.06334191e-03  1.80212928e-01]
 [-1.12652634e-01  8.40524293e-02  2.04495345e-01]
 [-5.91480027e-02 -5.23559967e-02  8.18913061e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.02797783]
curr_Stock_Price:  98.72466574410493
curr_Factors:  [98.72466574 -0.66250694 -1.03733504]
mat_Sqrt:  [[18.03822001  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00632783 0.04835956 0.14667959]
Stock Position:  0.0063278316970147
Bond Position:  [-8.6526909]


portfolio before change:  [-8.02450708]
curr_Stock_Price:  99.95702709497908
curr_Factors:  [99.95702709 -1.00206254 -1.0713657 ]
mat_Sqrt:  [[12.56998878  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02724318 -0.1723409   1.37453493]
Stock Position:  0.027243175517779484
Bond Position:  [-10.74765391]


portfolio before change:  [-8.05357229]
curr_Stock_Price:  99.08744991754735
curr_Factors:  [99.08744992 -1.04399134 -1.03207258]
mat_Sqrt:  [[12.42783703  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00106045 -0.02406657  0.31779743]
Stock Position:  -0.0010604461517266552
Bond Position:  [-7.94849539]


portfolio before change:  [-8.05732835]
curr_Stock_Price:  98.88075601000753
curr_Factors:  [98.88075601 -1.23100846 -0.99008455]
mat_Sqrt:  [[10.72761899  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02536747 -0.11688784 -1.14721108]
Stock Position:  0.025367467844769433
Bond Position:  [-10.56568275]


portfolio before change:  [-8.06885365]
curr_Stock_Price:  98.63472664176906
curr_Factors:  [98.63472664 -0.92855543 -0.96266858]
mat_Sqrt:  [[14.88269888  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00182415  0.02930398  0.30477934]
Stock Position:  -0.0018241515532766912
Bond Position:  [-7.88892896]


portfolio before change:  [-8.06780068]
curr_Stock_Price:  95.89458926151066
curr_Factors:  [95.89458926 -0.40277699 -0.94857682]
mat_Sqrt:  [[24.82610571  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00095059  0.02578701 -0.43338904]
Stock Position:  -0.0009505908962221182
Bond Position:  [-7.97664415]


portfolio before change:  [-8.07215881]
curr_Stock_Price:  96.28257363513049
curr_Factors:  [96.28257364 -0.67242904 -0.93463275]
mat_Sqrt:  [[19.30232495  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00520681 -0.00098869  0.51409732]
Stock Position:  -0.005206805319503261
Bond Position:  [-7.57083419]


portfolio before change:  [-8.09673474]
curr_Stock_Price:  100.27534188636379
curr_Factors:  [100.27534189  -0.58115385  -0.98933707]
mat_Sqrt:  [[20.85156291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00257789  0.0271278   0.5833683 ]
Stock Position:  -0.0025778914923515264
Bond Position:  [-7.83823579]


portfolio before change:  [-8.10032697]
curr_Stock_Price:  100.14815836773481
curr_Factors:  [100.14815837  -0.78828374  -0.95864244]
mat_Sqrt:  [[17.45671689  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304291 -0.01689783  0.2336131 ]
Stock Position:  -0.0030429051008104583
Bond Position:  [-7.79558563]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.10211779]
Stock Price:  99.45541610917034
PL:  [-8.10211779]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 2.16075305e-02  9.53016517e-02  5.40021838e-02]
 [ 2.48676806e-01 -2.47305437e-01  3.17027438e-01]
 [-5.00514632e-01  4.02738210e-02 -3.96407021e-01]
 [ 3.26300631e-01 -2.84638447e-01 -2.57486438e-01]
 [-5.08900316e-02  3.12379430e-03  4.28073940e-02]
 [-4.38850458e-02  6.54570465e-02 -6.99742930e-02]
 [-1.83365232e-01  5.51051248e-02  1.85820921e-01]
 [-8.37591336e-02  2.86783084e-02  1.64122801e-01]
 [-9.85431669e-03 -1.77976263e-02  9.28016673e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.8229437]
curr_Stock_Price:  98.49834589732005
curr_Factors:  [98.4983459  -1.16699435 -0.97515333]
mat_Sqrt:  [[11.56394502  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.004504   0.03075848 0.1540532 ]
Stock Position:  0.004504003456978782
Bond Position:  [-10.26658059]


portfolio before change:  [-9.82769043]
curr_Stock_Price:  98.58445756146845
curr_Factors:  [98.58445756 -0.37172918 -1.005565  ]
mat_Sqrt:  [[24.86893522  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01057177 -0.07981749  0.90439104]
Stock Position:  0.010571773501810103
Bond Position:  [-10.86990299]


portfolio before change:  [-9.86661356]
curr_Stock_Price:  95.41688911197794
curr_Factors:  [95.41688911 -0.42658073 -1.00520014]
mat_Sqrt:  [[22.79348437  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02514798  0.01299832 -1.13083889]
Stock Position:  -0.025147976849123635
Bond Position:  [-7.46707184]


portfolio before change:  [-9.89571963]
curr_Stock_Price:  96.42578137651059
curr_Factors:  [96.42578138 -0.51871144 -0.98084974]
mat_Sqrt:  [[21.52494343  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01001814 -0.09186666 -0.73453714]
Stock Position:  0.010018137947375553
Bond Position:  [-10.86172641]


portfolio before change:  [-9.86385783]
curr_Stock_Price:  100.14843110348305
curr_Factors:  [100.1484311   -0.33982354  -1.01698899]
mat_Sqrt:  [[25.78623615  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00160994  0.0010082   0.12211758]
Stock Position:  -0.0016099428706937758
Bond Position:  [-9.70262458]


portfolio before change:  [-9.86503316]
curr_Stock_Price:  97.86438126203508
curr_Factors:  [97.86438126 -0.17778741 -1.00789588]
mat_Sqrt:  [[29.90122247  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0014985   0.02112617 -0.19961718]
Stock Position:  -0.0014985047814938765
Bond Position:  [-9.71838292]


portfolio before change:  [-9.86782055]
curr_Stock_Price:  96.48098570239878
curr_Factors:  [96.4809857  -0.5005172  -1.04780951]
mat_Sqrt:  [[20.51218787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00654179  0.0177851   0.53009536]
Stock Position:  -0.006541789201885339
Bond Position:  [-9.23666228]


portfolio before change:  [-9.87401705]
curr_Stock_Price:  96.7220541042024
curr_Factors:  [96.7220541  -0.866072   -1.00153815]
mat_Sqrt:  [[14.94282565  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00297158  0.00925588  0.46819667]
Stock Position:  -0.002971577993598866
Bond Position:  [-9.58659992]


portfolio before change:  [-9.88038286]
curr_Stock_Price:  97.25083241766445
curr_Factors:  [97.25083242 -1.09973044 -1.04323221]
mat_Sqrt:  [[11.40818291  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00047824 -0.00574416  0.26473733]
Stock Position:  0.00047823734146095745
Bond Position:  [-9.92689183]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.88516538]
Stock Price:  97.63172755308537
PL:  [-9.88516538]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.95816418e-02  9.99843977e-02  4.87596344e-02]
 [ 2.02500944e-01 -1.11126321e-01  2.29414693e-01]
 [-1.83573798e-01  9.32414331e-03 -7.85183872e-02]
 [ 4.20567314e-01 -3.58012137e-01 -3.84890657e-01]
 [-1.34540180e-01  1.15184937e-01 -1.03546959e-01]
 [-8.26061835e-02  5.90148370e-03  3.71910511e-02]
 [-3.70892227e-01  3.78437638e-01  2.46553969e-01]
 [-1.16602449e-01  1.13629486e-01  2.62151529e-01]
 [-1.61248229e-02 -4.71624509e-02  1.77344234e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.02034284]
curr_Stock_Price:  99.48214367034666
curr_Factors:  [99.48214367 -0.98575802 -0.99083271]
mat_Sqrt:  [[13.7823314   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0050749  0.03226983 0.13909766]
Stock Position:  0.005074895398324454
Bond Position:  [-2.52520431]


portfolio before change:  [-2.02714484]
curr_Stock_Price:  98.39067534161786
curr_Factors:  [98.39067534 -1.17033389 -0.95419235]
mat_Sqrt:  [[11.75665891  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01927813 -0.03586587  0.65445626]
Stock Position:  0.019278134893521558
Bond Position:  [-3.92393355]


portfolio before change:  [-2.0268225]
curr_Stock_Price:  98.50919323851235
curr_Factors:  [98.50919324 -0.91527856 -0.97159421]
mat_Sqrt:  [[14.92857412  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01324293  0.00300935 -0.2239911 ]
Stock Position:  -0.013242926752467155
Bond Position:  [-0.72227247]


portfolio before change:  [-2.02996846]
curr_Stock_Price:  98.71947459733461
curr_Factors:  [98.7194746  -0.92334553 -0.99165401]
mat_Sqrt:  [[14.54551496  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01848837 -0.11554792 -1.09798591]
Stock Position:  0.018488373667842388
Bond Position:  [-3.855131]


portfolio before change:  [-1.97864701]
curr_Stock_Price:  101.59963596289604
curr_Factors:  [101.59963596  -0.96532081  -1.03388935]
mat_Sqrt:  [[13.76088008  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00960437  0.03717578 -0.29539065]
Stock Position:  -0.009604370273401877
Bond Position:  [-1.00284649]


portfolio before change:  [-1.98820398]
curr_Stock_Price:  102.54247917075998
curr_Factors:  [102.54247917  -1.16065722  -1.07894925]
mat_Sqrt:  [[10.92081588  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00675865  0.0019047   0.10609572]
Stock Position:  -0.006758648575584299
Bond Position:  [-1.29515539]


portfolio before change:  [-1.98556931]
curr_Stock_Price:  102.05681892579568
curr_Factors:  [102.05681893  -0.1626989   -1.09425795]
mat_Sqrt:  [[29.03705748  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00837951  0.12214022  0.70334985]
Stock Position:  -0.00837951124025746
Bond Position:  [-1.13038305]


portfolio before change:  [-2.03009171]
curr_Stock_Price:  107.30259826415143
curr_Factors:  [107.30259826  -0.43959983  -1.11211994]
mat_Sqrt:  [[22.73562522  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0017548   0.03667376  0.74784534]
Stock Position:  -0.001754799819706438
Bond Position:  [-1.84179713]


portfolio before change:  [-2.03371896]
curr_Stock_Price:  108.84472673266373
curr_Factors:  [108.84472673  -0.94559799  -1.13697176]
mat_Sqrt:  [[13.56309625  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00163177 -0.01522162  0.05059137]
Stock Position:  -0.0016317655980232224
Bond Position:  [-1.85610988]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.03577863]
Stock Price:  109.53807392671075
PL:  [-11.57385256]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-5.55658418e-04  6.46469397e-02  4.77939713e-02]
 [ 4.43056881e-01 -5.30710447e-01  5.61723751e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.31622805e-01 -3.71730167e-01 -3.81729271e-01]
 [-1.05936554e-02  8.70136966e-03  1.33323241e-01]
 [-8.82234546e-02  1.92861702e-02  4.59449357e-02]
 [-3.39493881e-01  2.34167625e-01  2.45994206e-01]
 [-1.15611678e-01  1.23532767e-01  2.89991414e-01]
 [-2.23470233e-02 -4.80276602e-02  2.21387058e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.69427704]
curr_Stock_Price:  100.07659065216681
curr_Factors:  [100.07659065  -0.98287076  -0.99210847]
mat_Sqrt:  [[13.8870475   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00161274 0.02086471 0.1363429 ]
Stock Position:  0.001612743560053515
Bond Position:  [2.53287916]


portfolio before change:  [2.69755608]
curr_Stock_Price:  101.32432929589802
curr_Factors:  [101.3243293   -1.31927335  -1.04616415]
mat_Sqrt:  [[ 9.51518609  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04722845 -0.17128606  1.60244151]
Stock Position:  0.04722844518047895
Bond Position:  [-2.08783445]


portfolio before change:  [2.67649881]
curr_Stock_Price:  100.90057846851187
curr_Factors:  [100.90057847  -0.78421982  -1.03095205]
mat_Sqrt:  [[16.42761541  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00214322 -0.02755111  0.34758667]
Stock Position:  0.0021432249850777793
Bond Position:  [2.46024617]


portfolio before change:  [2.67402752]
curr_Stock_Price:  99.17340861504415
curr_Factors:  [99.17340862 -0.25106847 -1.05247481]
mat_Sqrt:  [[26.93230871  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01031562 -0.1199754  -1.08896736]
Stock Position:  0.010315622934291398
Bond Position:  [1.65099204]


portfolio before change:  [2.65918132]
curr_Stock_Price:  97.65416874758502
curr_Factors:  [ 9.76541687e+01 -4.41081333e-02 -1.09495793e+00]
mat_Sqrt:  [[31.26084271  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0005885  0.00280835 0.3803341 ]
Stock Position:  0.000588499713028858
Bond Position:  [2.60171187]


portfolio before change:  [2.66279004]
curr_Stock_Price:  101.57521917559406
curr_Factors:  [101.57521918  -0.471943    -1.12548897]
mat_Sqrt:  [[20.56041513  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00364332  0.00622458  0.13106811]
Stock Position:  -0.0036433219076450517
Bond Position:  [3.03286126]


portfolio before change:  [2.65942863]
curr_Stock_Price:  102.91416766965641
curr_Factors:  [102.91416767  -0.3686962   -1.08028304]
mat_Sqrt:  [[24.16526013  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00999291  0.07557728  0.701753  ]
Stock Position:  -0.00999290950881819
Bond Position:  [3.68784059]


portfolio before change:  [2.62797136]
curr_Stock_Price:  106.24669529534926
curr_Factors:  [106.2466953   -0.14095471  -1.16468899]
mat_Sqrt:  [[28.79264573  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00108366  0.03987003  0.82726479]
Stock Position:  -0.0010836589528832711
Bond Position:  [2.74310655]


portfolio before change:  [2.6281781]
curr_Stock_Price:  107.32190345198659
curr_Factors:  [107.32190345  -0.46670177  -1.16253086]
mat_Sqrt:  [[21.04367692  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00131306 -0.01550086  0.06315557]
Stock Position:  -0.0013130587419110243
Bond Position:  [2.76909806]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.63427832]
Stock Price:  103.73080696983618
PL:  [-1.09652865]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.73807856e-02  9.80467321e-02  4.87066840e-02]
 [ 3.54425722e-01 -5.55064880e-01  5.11234473e-01]
 [ 1.41307477e-02 -8.23271178e-02  1.18906589e-01]
 [ 3.30768731e-01 -2.88111060e-01 -2.63184884e-01]
 [-1.25566080e-02  4.70840840e-02  1.46570236e-01]
 [-2.25311024e-02  7.93370053e-02 -1.36199680e-01]
 [-4.87500957e-02 -1.31559161e-01  1.58182667e-01]
 [-8.01744313e-02  1.39332562e-02  1.41336552e-01]
 [ 8.78919233e-02  5.54413501e-02  1.15092537e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.75640541]
curr_Stock_Price:  99.64150832948235
curr_Factors:  [99.64150833 -0.98638519 -1.04899089]
mat_Sqrt:  [[13.01630433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00517326 0.03164445 0.13894661]
Stock Position:  0.005173258057300867
Bond Position:  [-1.27187664]


portfolio before change:  [-0.75666438]
curr_Stock_Price:  99.71440822931392
curr_Factors:  [99.71440823 -0.38443177 -1.01761344]
mat_Sqrt:  [[24.53903153  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01407875 -0.17914642  1.45840965]
Stock Position:  0.01407874948877604
Bond Position:  [-2.16051855]


portfolio before change:  [-0.76093383]
curr_Stock_Price:  99.48790193116632
curr_Factors:  [99.48790193 -0.42567728 -1.00184272]
mat_Sqrt:  [[23.8674605   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00090489 -0.02657096  0.3392074 ]
Stock Position:  0.0009048931234216543
Bond Position:  [-0.85095975]


portfolio before change:  [-0.76404791]
curr_Stock_Price:  96.51684284449361
curr_Factors:  [96.51684284 -0.5259472  -0.9734913 ]
mat_Sqrt:  [[21.5479145   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01012794 -0.09298744 -0.75079322]
Stock Position:  0.010127936891109397
Bond Position:  [-1.7415644]


portfolio before change:  [-0.75918966]
curr_Stock_Price:  97.08253006264911
curr_Factors:  [97.08253006 -0.38829169 -0.96666149]
mat_Sqrt:  [[25.04334865  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00107705 0.01519632 0.41812409]
Stock Position:  0.001077049035976542
Bond Position:  [-0.86375231]


portfolio before change:  [-0.76006898]
curr_Stock_Price:  96.66719462705666
curr_Factors:  [96.66719463 -0.19192285 -0.95074282]
mat_Sqrt:  [[30.83370563  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00110717  0.02560591 -0.38853978]
Stock Position:  -0.0011071697832460245
Bond Position:  [-0.65304199]


portfolio before change:  [-0.76117113]
curr_Stock_Price:  97.36767252781031
curr_Factors:  [97.36767253 -1.0702768  -0.93768192]
mat_Sqrt:  [[13.07282349  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331341 -0.04246054  0.45125112]
Stock Position:  -0.0033134077981306223
Bond Position:  [-0.43855233]


portfolio before change:  [-0.75994686]
curr_Stock_Price:  96.93198739584744
curr_Factors:  [96.9319874  -1.1418412  -0.98279989]
mat_Sqrt:  [[11.58103082  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00418617  0.00449694  0.40319384]
Stock Position:  -0.004186165732188228
Bond Position:  [-0.3541735]


portfolio before change:  [-0.7495747]
curr_Stock_Price:  94.41195045143958
curr_Factors:  [94.41195045 -0.57157842 -0.94869249]
mat_Sqrt:  [[20.64342276  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00594388 0.01789362 0.32832697]
Stock Position:  0.005943879010545021
Bond Position:  [-1.31074791]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.76265084]
Stock Price:  92.32230417723507
PL:  [-0.76265084]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-3.93226686e-03  6.16741249e-02  4.77127335e-02]
 [ 2.71382292e-01 -3.14267110e-01  3.60108170e-01]
 [-5.75016015e-02 -5.11144269e-02  6.39553925e-02]
 [ 4.69875612e-01 -4.06619192e-01 -4.02667480e-01]
 [-1.23706822e-01  1.26314521e-01 -1.04587225e-01]
 [-3.80886322e-02  3.28694963e-02  7.15800349e-02]
 [-2.81612969e-02 -3.05258729e-01  1.71479163e-01]
 [-1.10940813e-01  4.07201449e-02  1.11689173e-01]
 [-7.26440073e-02 -5.76036271e-02  7.55304672e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.8601849]
curr_Stock_Price:  99.97142341336837
curr_Factors:  [99.97142341 -1.31905191 -1.01803464]
mat_Sqrt:  [[ 9.65810857  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00190474 0.01990524 0.13611115]
Stock Position:  0.0019047448045846555
Bond Position:  [1.66976485]


portfolio before change:  [1.85968846]
curr_Stock_Price:  99.27236289550626
curr_Factors:  [99.2723629  -1.63194482 -1.02276415]
mat_Sqrt:  [[ 6.98076315  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04021617 -0.10142927  1.02728838]
Stock Position:  0.0402161703359242
Bond Position:  [-2.1326658]


portfolio before change:  [1.85030268]
curr_Stock_Price:  99.06550143642342
curr_Factors:  [99.06550144 -1.44189377 -1.02611921]
mat_Sqrt:  [[ 8.3961081   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00653642 -0.01649711  0.18244693]
Stock Position:  -0.006536415413492974
Bond Position:  [2.49783596]


portfolio before change:  [1.84488328]
curr_Stock_Price:  100.08573036642315
curr_Factors:  [100.08573037  -1.52624774  -1.01684893]
mat_Sqrt:  [[ 7.86899578  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03871913 -0.13123578 -1.14869824]
Stock Position:  0.03871912889313495
Bond Position:  [-2.03034902]


portfolio before change:  [1.85741454]
curr_Stock_Price:  100.43560116139575
curr_Factors:  [100.43560116  -1.66295221  -1.03324968]
mat_Sqrt:  [[ 6.77551135  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01760336  0.04076784 -0.29835824]
Stock Position:  -0.017603358657347665
Bond Position:  [3.62541845]


portfolio before change:  [1.85823412]
curr_Stock_Price:  100.49204369560923
curr_Factors:  [100.4920437   -1.9037881   -0.94413912]
mat_Sqrt:  [[ 5.82495539  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00287864  0.01060858  0.20419792]
Stock Position:  -0.0028786419394522143
Bond Position:  [2.14751474]


portfolio before change:  [1.85849558]
curr_Stock_Price:  100.77431981244476
curr_Factors:  [100.77431981  -1.39054491  -0.97476968]
mat_Sqrt:  [[ 9.46469891  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00586061 -0.09852183  0.48918232]
Stock Position:  -0.005860612900576734
Bond Position:  [2.44909486]


portfolio before change:  [1.86236211]
curr_Stock_Price:  100.3235686815597
curr_Factors:  [100.32356868  -1.31371729  -1.00223508]
mat_Sqrt:  [[ 9.89914388  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00806437  0.01314237  0.31861812]
Stock Position:  -0.00806437324101714
Bond Position:  [2.67140881]


portfolio before change:  [1.86594932]
curr_Stock_Price:  100.04441885089021
curr_Factors:  [100.04441885  -1.1648843   -0.97099084]
mat_Sqrt:  [[11.81936325  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00583658 -0.01859149  0.2154674 ]
Stock Position:  -0.005836583995505981
Bond Position:  [2.44986697]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.87052195]
Stock Price:  99.4708988003153
PL:  [1.87052195]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-6.09113310e-02  5.72262625e-02  5.06257473e-02]
 [ 5.05977962e-01 -5.48691401e-01  6.28613717e-01]
 [-1.79593279e-02 -5.53480754e-02  6.02111833e-02]
 [ 5.31860652e-01 -4.70592599e-01 -3.79739342e-01]
 [-1.17465547e-01  1.22309302e-01 -8.09708186e-02]
 [-9.45816955e-02  3.44364202e-02  5.58535385e-02]
 [-1.00461985e-01 -1.11879295e-01  1.69039444e-01]
 [-1.17204653e-01  9.37091184e-02  2.12961546e-01]
 [-1.02929649e-02 -4.29550615e-02  2.34959925e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.1545198]
curr_Stock_Price:  101.26939365676581
curr_Factors:  [101.26939366  -0.99918694  -1.0019812 ]
mat_Sqrt:  [[13.68932171  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00284135  0.0184697   0.14442117]
Stock Position:  -0.002841348350937956
Bond Position:  [12.44226142]


portfolio before change:  [12.15810927]
curr_Stock_Price:  102.19614157922764
curr_Factors:  [102.19614158  -1.35431723  -0.94283187]
mat_Sqrt:  [[10.27531925  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05082976 -0.17708939  1.79325996]
Stock Position:  0.05082976245983033
Bond Position:  [6.96350367]


portfolio before change:  [12.11683222]
curr_Stock_Price:  101.31556161084505
curr_Factors:  [101.31556161  -1.40932019  -0.90541046]
mat_Sqrt:  [[10.00924709  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0016951  -0.01786351  0.17176575]
Stock Position:  -0.001695097546003174
Bond Position:  [12.28857198]


portfolio before change:  [12.12310513]
curr_Stock_Price:  101.24059187289507
curr_Factors:  [101.24059187  -1.45528863  -0.91590272]
mat_Sqrt:  [[ 9.45277581  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03790287 -0.15188311 -1.08329064]
Stock Position:  0.037902874115806874
Bond Position:  [8.28579572]


portfolio before change:  [12.08481494]
curr_Stock_Price:  100.12104301597546
curr_Factors:  [100.12104302  -1.61473327  -0.93313176]
mat_Sqrt:  [[ 7.83432602  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01391662  0.03947516 -0.23098721]
Stock Position:  -0.013916623346855703
Bond Position:  [13.47816178]


portfolio before change:  [12.0770738]
curr_Stock_Price:  101.16166195260571
curr_Factors:  [101.16166195  -1.47891249  -0.93623014]
mat_Sqrt:  [[ 9.03925916  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00842451  0.01111431  0.1593346 ]
Stock Position:  -0.00842451063233483
Bond Position:  [12.9293113]


portfolio before change:  [12.08713644]
curr_Stock_Price:  100.73476885517525
curr_Factors:  [100.73476886  -1.06049856  -0.90935695]
mat_Sqrt:  [[14.05018413  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00631979 -0.03610889  0.48222248]
Stock Position:  -0.006319790404596673
Bond Position:  [12.72375907]


portfolio before change:  [12.0815066]
curr_Stock_Price:  102.63250837643905
curr_Factors:  [102.63250838  -0.80989322  -0.9336922 ]
mat_Sqrt:  [[17.94962642  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00304217  0.03024449  0.60752001]
Stock Position:  -0.003042167253064466
Bond Position:  [12.39373185]


portfolio before change:  [12.08160227]
curr_Stock_Price:  104.6385599841588
curr_Factors:  [104.63855998  -0.56050328  -0.93879783]
mat_Sqrt:  [[23.36434203  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00061055 -0.01386369  0.06702753]
Stock Position:  -0.0006105470775875474
Bond Position:  [12.14548903]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.08540784]
Stock Price:  108.35439270728422
PL:  [3.73101513]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.76491789e-02  9.82830294e-02  4.87131413e-02]
 [ 1.57160612e-01  2.25886955e-02  1.43387260e-01]
 [-2.41465652e-01  2.89668455e-02 -1.72148578e-01]
 [ 2.95455613e-01 -2.56716305e-01 -2.27273253e-01]
 [ 2.17784009e-02  7.88346498e-02  1.78091118e-01]
 [-1.80066894e-02  6.74638700e-02 -7.47230856e-02]
 [-3.77394456e-02 -2.21929488e-01  1.61385380e-01]
 [-1.13613359e-01  4.95747043e-02  1.23849742e-01]
 [-3.51729139e-02 -4.93499694e-02  3.25600627e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.55853025]
curr_Stock_Price:  99.41428583828203
curr_Factors:  [99.41428584 -0.96861137 -0.94197164]
mat_Sqrt:  [[14.71272569  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00459838 0.03172071 0.13896503]
Stock Position:  0.004598376125696578
Bond Position:  [-3.01567453]


portfolio before change:  [-2.56740846]
curr_Stock_Price:  97.81154740740553
curr_Factors:  [97.81154741 -0.8598956  -0.88636063]
mat_Sqrt:  [[17.0608508   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01119758 0.00729047 0.40904394]
Stock Position:  0.011197584135568208
Bond Position:  [-3.66266149]


portfolio before change:  [-2.56908289]
curr_Stock_Price:  97.82560008563024
curr_Factors:  [97.82560009 -1.20082069 -0.89728373]
mat_Sqrt:  [[12.00210301  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02255376  0.00934901 -0.49109198]
Stock Position:  -0.022553755852095975
Bond Position:  [-0.36274819]


portfolio before change:  [-2.51495735]
curr_Stock_Price:  95.4177099631011
curr_Factors:  [95.41770996 -0.85305385 -0.8798674 ]
mat_Sqrt:  [[16.86672843  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01165974 -0.08285483 -0.64834733]
Stock Position:  0.011659739422636888
Bond Position:  [-3.62750298]


portfolio before change:  [-2.5133274]
curr_Stock_Price:  95.71309843923638
curr_Factors:  [95.71309844 -1.1464307  -0.88406385]
mat_Sqrt:  [[12.56431439  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00590746 0.02544377 0.50804439]
Stock Position:  0.005907457528644965
Bond Position:  [-3.07874846]


portfolio before change:  [-2.50306875]
curr_Stock_Price:  97.71030334984273
curr_Factors:  [97.71030335 -1.34286578 -0.84668554]
mat_Sqrt:  [[10.94032715  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00178134  0.02177387 -0.21316416]
Stock Position:  -0.0017813425785671894
Bond Position:  [-2.32901323]


portfolio before change:  [-2.50837784]
curr_Stock_Price:  100.03680305855218
curr_Factors:  [100.03680306  -1.25561014  -0.86284007]
mat_Sqrt:  [[12.02620409  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00416573 -0.07162743  0.46038757]
Stock Position:  -0.00416573338888877
Bond Position:  [-2.09165119]


portfolio before change:  [-2.51577216]
curr_Stock_Price:  101.56071896537043
curr_Factors:  [101.56071897  -1.44916777  -0.85058667]
mat_Sqrt:  [[10.18486089  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00767936  0.01600017  0.35330884]
Stock Position:  -0.007679362824236693
Bond Position:  [-1.73585055]


portfolio before change:  [-2.51619732]
curr_Stock_Price:  101.50303402832085
curr_Factors:  [101.50303403  -1.30091992  -0.80331255]
mat_Sqrt:  [[12.37720197  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00311865 -0.01592763  0.0928848 ]
Stock Position:  -0.003118648253101678
Bond Position:  [-2.19964506]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.50941501]
Stock Price:  98.97552583334286
PL:  [-2.50941501]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-1.16153388e-02  3.02286019e-04  4.10528412e-02]
 [ 1.04046423e-01  1.57984898e-01  6.07124386e-02]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.64169480e-01 -5.06015529e-01 -3.48580369e-01]
 [-1.27243415e-01  1.18487730e-01 -9.44994286e-02]
 [-7.80664304e-02 -4.92052856e-03  3.00546543e-02]
 [-7.95301949e-02 -3.66267261e-01  2.01548684e-01]
 [-1.17086049e-01  8.04208856e-02  1.83311494e-01]
 [ 3.46189889e-03 -4.08171812e-02  1.44156730e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.05494832]
curr_Stock_Price:  100.2481520842724
curr_Factors:  [100.24815208  -0.47469473  -0.95624054]
mat_Sqrt:  [[23.96785035  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-1.32417331e-04  9.75623931e-05  1.17112329e-01]
Stock Position:  -0.00013241733129743094
Bond Position:  [4.06822292]


portfolio before change:  [4.05765789]
curr_Stock_Price:  95.15104404113215
curr_Factors:  [95.15104404 -0.82615561 -0.98717047]
mat_Sqrt:  [[15.5201548   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00958031 0.05098941 0.17319569]
Stock Position:  0.00958030587747149
Bond Position:  [3.14608178]


portfolio before change:  [4.11384652]
curr_Stock_Price:  100.8518225329379
curr_Factors:  [100.85182253  -1.1699506   -0.988026  ]
mat_Sqrt:  [[11.65430623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00302104 -0.02755111  0.34758667]
Stock Position:  0.0030210357537891366
Bond Position:  [3.80916956]


portfolio before change:  [4.12000374]
curr_Stock_Price:  102.25933873719923
curr_Factors:  [102.25933874  -1.66142468  -0.9593848 ]
mat_Sqrt:  [[ 7.43874867  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.05239131 -0.16331581 -0.99440277]
Stock Position:  0.052391314755326296
Bond Position:  [-1.23749746]


portfolio before change:  [4.05211968]
curr_Stock_Price:  100.97543974072927
curr_Factors:  [100.97543974  -1.10547917  -0.99526383]
mat_Sqrt:  [[12.35590787  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00990189  0.03824175 -0.26958057]
Stock Position:  -0.009901888585047272
Bond Position:  [5.05196724]


portfolio before change:  [4.03424186]
curr_Stock_Price:  103.03610096613502
curr_Factors:  [103.03610097  -1.26750219  -1.01217195]
mat_Sqrt:  [[10.54240069  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00691834 -0.00158809  0.08573756]
Stock Position:  -0.0069183434221208265
Bond Position:  [4.74708099]


portfolio before change:  [4.03243601]
curr_Stock_Price:  103.64028910999762
curr_Factors:  [103.64028911  -1.32912741  -1.04913682]
mat_Sqrt:  [[ 9.60863249  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01177621 -0.11821225  0.5749623 ]
Stock Position:  -0.01177620580887668
Bond Position:  [5.25292539]


portfolio before change:  [4.02708613]
curr_Stock_Price:  104.31767203510192
curr_Factors:  [104.31767204  -1.01826382  -1.10258265]
mat_Sqrt:  [[12.51082561  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00505577  0.02595573  0.52293667]
Stock Position:  -0.0050557736697337255
Bond Position:  [4.55449267]


portfolio before change:  [4.01921361]
curr_Stock_Price:  106.3253443016152
curr_Factors:  [106.3253443   -1.57281095  -1.06088636]
mat_Sqrt:  [[ 7.63548432  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00025241 -0.01317369  0.0411239 ]
Stock Position:  -0.0002524118089841078
Bond Position:  [4.04605138]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.02088808]
Stock Price:  107.70826906440374
PL:  [-3.68738099]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-5.77268233e-02  2.99251997e-02  4.63994075e-02]
 [ 4.40597519e-01 -5.41235564e-01  5.64746298e-01]
 [ 7.94638205e-03 -7.31624094e-02  9.74013917e-02]
 [ 4.76977544e-01 -4.13710207e-01 -4.03842155e-01]
 [-3.48978178e-02  9.29693154e-02  1.56554925e-01]
 [-2.83058138e-02  7.42055447e-02 -1.03180727e-01]
 [-2.83140216e-01  1.54072394e-01  2.18675920e-01]
 [-7.55194513e-02  4.84659215e-02  2.32926963e-01]
 [ 1.96606644e-02  2.57245913e-03  1.02025072e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.75497991]
curr_Stock_Price:  101.21901731969982
curr_Factors:  [101.21901732  -0.6783048   -0.98410816]
mat_Sqrt:  [[19.1992978   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00219524  0.00965832  0.13236459]
Stock Position:  -0.00219524320905081
Bond Position:  [11.97718027]


portfolio before change:  [11.76089105]
curr_Stock_Price:  101.25497839722168
curr_Factors:  [101.2549784   -1.24029268  -0.98447094]
mat_Sqrt:  [[10.94495095  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04069426 -0.17468303  1.61106399]
Stock Position:  0.040694255233524775
Bond Position:  [7.64039512]


portfolio before change:  [11.72189671]
curr_Stock_Price:  100.20285206600069
curr_Factors:  [100.20285207  -1.3377056   -0.99518456]
mat_Sqrt:  [[ 9.72117491  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0013264  -0.02361307  0.27785906]
Stock Position:  0.0013263976521240188
Bond Position:  [11.58898788]


portfolio before change:  [11.72761359]
curr_Stock_Price:  100.14324362378157
curr_Factors:  [100.14324362  -1.16742367  -0.95443834]
mat_Sqrt:  [[11.99799546  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0258456  -0.1335244  -1.15204926]
Stock Position:  0.025845597981499033
Bond Position:  [9.13935157]


portfolio before change:  [11.65041415]
curr_Stock_Price:  96.97944542894265
curr_Factors:  [96.97944543 -0.69823879 -0.95445387]
mat_Sqrt:  [[18.57481049  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00086333 0.03000572 0.44660762]
Stock Position:  0.0008633253348401539
Bond Position:  [11.56668934]


portfolio before change:  [11.65632768]
curr_Stock_Price:  97.12856882073898
curr_Factors:  [97.12856882 -0.79041309 -0.97127853]
mat_Sqrt:  [[16.68222752  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00205131  0.02394974 -0.29434589]
Stock Position:  -0.002051305682507118
Bond Position:  [11.85556807]


portfolio before change:  [11.66358862]
curr_Stock_Price:  96.47938671708432
curr_Factors:  [96.47938672 -0.11403253 -0.9246649 ]
mat_Sqrt:  [[34.14553886  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00606385  0.04972665  0.62382153]
Stock Position:  -0.0060638458846546785
Bond Position:  [12.24862475]


portfolio before change:  [11.68035813]
curr_Stock_Price:  94.72412021567825
curr_Factors:  [94.72412022 -0.21793474 -0.97327835]
mat_Sqrt:  [[28.78215503  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-6.28179828e-04  1.56423089e-02  6.64475792e-01]
Stock Position:  -0.0006281798279355965
Bond Position:  [11.73986191]


portfolio before change:  [11.6841959]
curr_Stock_Price:  97.96144975798293
curr_Factors:  [97.96144976 -0.24064818 -0.99776444]
mat_Sqrt:  [[28.39353295  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0014444  0.00083026 0.29104913]
Stock Position:  0.0014443974314781362
Bond Position:  [11.54270064]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.68649206]
Stock Price:  95.55447080643198
PL:  [11.68649206]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-5.86650085e-02  5.59501627e-02  5.03907914e-02]
 [ 4.53926832e-01 -6.20798708e-01  6.16949081e-01]
 [-7.08477068e-03 -7.76004291e-02  1.14334910e-01]
 [ 3.50742500e-01 -3.04769558e-01 -2.82971524e-01]
 [-4.19707957e-02  9.53810995e-02  1.54670982e-01]
 [-9.45816955e-02  3.44364202e-02  5.58535385e-02]
 [-2.05883954e-01  1.66921531e-01  1.78966606e-01]
 [-1.03646165e-01  6.72463451e-02  1.92937239e-01]
 [ 7.62893043e-03 -1.33209189e-02  8.71103154e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.94054077]
curr_Stock_Price:  100.9902421697513
curr_Factors:  [100.99024217  -1.18434891  -0.95342317]
mat_Sqrt:  [[11.90849275  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00310352  0.01805784  0.1437509 ]
Stock Position:  -0.003103520564736334
Bond Position:  [10.25396607]


portfolio before change:  [9.94504913]
curr_Stock_Price:  101.18998600715028
curr_Factors:  [101.18998601  -0.74098923  -0.92237549]
mat_Sqrt:  [[19.17553168  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02363121 -0.20036192  1.759984  ]
Stock Position:  0.02363121074123739
Bond Position:  [7.55380724]


portfolio before change:  [9.90412159]
curr_Stock_Price:  99.29819194519149
curr_Factors:  [99.29819195 -0.52954702 -0.89256822]
mat_Sqrt:  [[23.95104896  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.72695521e-05 -2.50454308e-02  3.26165674e-01]
Stock Position:  1.7269552116619483e-05
Bond Position:  [9.90240676]


portfolio before change:  [9.90903234]
curr_Stock_Price:  96.88368946172838
curr_Factors:  [96.88368946 -0.3395721  -0.91747808]
mat_Sqrt:  [[27.56263348  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00837258 -0.09836395 -0.80723899]
Stock Position:  0.008372580000746529
Bond Position:  [9.0978659]


portfolio before change:  [9.91539613]
curr_Stock_Price:  97.10031557531225
curr_Factors:  [97.10031558 -0.79137093 -0.92216698]
mat_Sqrt:  [[17.50010198  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00051833 0.03078412 0.44123326]
Stock Position:  0.0005183325053776089
Bond Position:  [9.86506588]


portfolio before change:  [9.92194416]
curr_Stock_Price:  100.21465526041649
curr_Factors:  [100.21465526  -0.42532418  -0.937411  ]
mat_Sqrt:  [[25.65091553  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00296876  0.01111431  0.1593346 ]
Stock Position:  -0.0029687569951611587
Bond Position:  [10.21945711]


portfolio before change:  [9.92782001]
curr_Stock_Price:  99.9570243639706
curr_Factors:  [99.95702436 -0.6455815  -0.93701866]
mat_Sqrt:  [[20.53519374  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00658771  0.05387369  0.51054191]
Stock Position:  -0.006587706730547469
Bond Position:  [10.58630757]


portfolio before change:  [9.94485826]
curr_Stock_Price:  98.17434411755185
curr_Factors:  [98.17434412 -0.56066281 -0.93186096]
mat_Sqrt:  [[22.07004251  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00228982  0.02170366  0.55039624]
Stock Position:  -0.002289819486884033
Bond Position:  [10.16965978]


portfolio before change:  [9.94656701]
curr_Stock_Price:  99.64928352471686
curr_Factors:  [ 9.96492835e+01  9.84102201e-02 -9.27766227e-01]
mat_Sqrt:  [[43.47999078  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00052188 -0.00429931  0.24850148]
Stock Position:  0.0005218751778936002
Bond Position:  [9.89456253]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.94945841]
Stock Price:  95.70749693394112
PL:  [9.94945841]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 2.98745513e-02  6.40999778e-02  5.12029255e-02]
 [ 8.07893866e-02  1.58398466e-01  5.27072995e-02]
 [-5.50409146e-01  3.91465453e-02 -4.18399476e-01]
 [ 2.50790480e-01 -2.24718028e-01 -1.64430363e-01]
 [ 1.06166421e-01  3.26720194e-02  1.89066351e-01]
 [ 1.77685797e-02  7.47656418e-02 -1.15794689e-01]
 [-2.11999397e-01  1.90376899e-02  2.03206833e-01]
 [-8.99464600e-02  6.61323637e-02  2.30550068e-01]
 [ 9.43365543e-02  6.03336908e-02  1.16471469e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.07697926]
curr_Stock_Price:  97.9619720929774
curr_Factors:  [97.96197209 -0.90184193 -1.02368917]
mat_Sqrt:  [[14.28268927  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00373954 0.02068818 0.14606769]
Stock Position:  0.0037395379025966357
Bond Position:  [-14.44331177]


portfolio before change:  [-14.09889128]
curr_Stock_Price:  94.03406614893647
curr_Factors:  [94.03406615 -0.3653263  -1.05601623]
mat_Sqrt:  [[22.69885751  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00545759 0.05112289 0.15035925]
Stock Position:  0.005457594968093636
Bond Position:  [-14.61209113]


portfolio before change:  [-14.10051383]
curr_Stock_Price:  95.07579316246135
curr_Factors:  [95.07579316 -0.34166561 -1.03701777]
mat_Sqrt:  [[23.95054359  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02621334  0.01263449 -1.19357724]
Stock Position:  -0.02621334350285138
Bond Position:  [-11.6082594]


portfolio before change:  [-14.09876465]
curr_Stock_Price:  94.78759018294765
curr_Factors:  [94.78759018 -0.53047274 -1.06640558]
mat_Sqrt:  [[19.19711827  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00892613 -0.07252743 -0.46907406]
Stock Position:  0.008926126065640572
Bond Position:  [-14.94485062]


portfolio before change:  [-14.10762058]
curr_Stock_Price:  94.63280410222337
curr_Factors:  [94.6328041  -0.90308393 -1.10080817]
mat_Sqrt:  [[12.7574075   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.01186985 0.01054485 0.53935367]
Stock Position:  0.011869854916656198
Bond Position:  [-15.23089823]


portfolio before change:  [-14.10275695]
curr_Stock_Price:  95.68428966719115
curr_Factors:  [95.68428967 -0.94292132 -1.08305254]
mat_Sqrt:  [[12.61744346  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00074449  0.02413051 -0.33033002]
Stock Position:  0.0007444900041016524
Bond Position:  [-14.17399295]


portfolio before change:  [-14.11060728]
curr_Stock_Price:  94.66136168533036
curr_Factors:  [94.66136169 -0.26241659 -1.08712412]
mat_Sqrt:  [[24.5513097   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00678717  0.00614439  0.57969253]
Stock Position:  -0.006787170448275074
Bond Position:  [-13.46812448]


portfolio before change:  [-14.12601094]
curr_Stock_Price:  95.9384648913284
curr_Factors:  [95.93846489 -0.14477708 -1.00234656]
mat_Sqrt:  [[30.46514822  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00096459  0.02134413  0.65769517]
Stock Position:  -0.0009645911436911872
Bond Position:  [-14.03346955]


portfolio before change:  [-14.13136859]
curr_Stock_Price:  94.21665326283254
curr_Factors:  [94.21665326 -0.52596442 -0.98262478]
mat_Sqrt:  [[20.84278313  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00625765 0.01947261 0.33226068]
Stock Position:  0.006257645903382062
Bond Position:  [-14.72094304]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.15630838]
Stock Price:  91.40769272005001
PL:  [-14.15630838]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 7.22905498e-03 -4.96187117e-04  3.89416716e-02]
 [ 3.39044853e-01 -5.06422166e-01  4.76908496e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 4.87256128e-01 -4.30359814e-01 -3.79029917e-01]
 [-1.38975826e-01  1.18276986e-01 -1.20901856e-01]
 [-8.93063607e-02  2.18664904e-02  4.76325229e-02]
 [-1.00091484e-01 -2.44001315e-01  1.71301928e-01]
 [-1.14245217e-01  5.82617728e-02  1.41609554e-01]
 [-4.03680413e-02 -4.80162986e-02  5.15125646e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.0718049]
curr_Stock_Price:  100.50244921498216
curr_Factors:  [100.50244921  -0.44020805  -1.03190999]
mat_Sqrt:  [[23.05918223  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00065383 -0.00016014  0.11108975]
Stock Position:  0.0006538265961699163
Bond Position:  [6.00609373]


portfolio before change:  [6.07430059]
curr_Stock_Price:  99.72530929269458
curr_Factors:  [99.72530929 -0.85151927 -1.03185953]
mat_Sqrt:  [[15.16576671  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02195869 -0.16344705  1.36048719]
Stock Position:  0.021958691982908122
Bond Position:  [3.88446324]


portfolio before change:  [6.0801428]
curr_Stock_Price:  99.90289251814521
curr_Factors:  [99.90289252 -1.22020216 -1.05434172]
mat_Sqrt:  [[10.27439377  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00342678 -0.02755111  0.34758667]
Stock Position:  0.0034267789024100426
Bond Position:  [5.73779768]


portfolio before change:  [6.08783421]
curr_Stock_Price:  101.30998553810508
curr_Factors:  [101.30998554  -0.68500227  -1.07879521]
mat_Sqrt:  [[17.36379866  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01854664 -0.13889803 -1.08126685]
Stock Position:  0.01854664102439796
Bond Position:  [4.20887428]


portfolio before change:  [6.09837785]
curr_Stock_Price:  101.76498277069656
curr_Factors:  [101.76498277  -1.08192376  -1.07258908]
mat_Sqrt:  [[11.8006336   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01182238  0.03817373 -0.34489934]
Stock Position:  -0.011822384331883876
Bond Position:  [7.30148258]


portfolio before change:  [6.10208939]
curr_Stock_Price:  101.75991666826023
curr_Factors:  [101.75991667  -0.87717841  -1.11291002]
mat_Sqrt:  [[13.90888508  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00540086  0.00705738  0.13588233]
Stock Position:  -0.005400859489430967
Bond Position:  [6.65168041]


portfolio before change:  [6.10502337]
curr_Stock_Price:  101.83262721046889
curr_Factors:  [101.83262721  -1.08605969  -1.11437131]
mat_Sqrt:  [[11.27851465  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01019028 -0.07875109  0.48867672]
Stock Position:  -0.010190276598601255
Bond Position:  [7.142726]


portfolio before change:  [6.10766419]
curr_Stock_Price:  101.92403163754254
curr_Factors:  [101.92403164  -1.13481662  -1.19273803]
mat_Sqrt:  [[ 9.94105448  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00738822  0.01880391  0.40397264]
Stock Position:  -0.007388215548029561
Bond Position:  [6.8607009]


portfolio before change:  [6.11978353]
curr_Stock_Price:  100.74808702345106
curr_Factors:  [100.74808702  -0.52464017  -1.2141683 ]
mat_Sqrt:  [[17.70442754  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0022398  -0.01549719  0.14695101]
Stock Position:  -0.002239799558684478
Bond Position:  [6.34543905]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.12847476]
Stock Price:  98.28459837532218
PL:  [6.12847476]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.60128416e-02  9.68423745e-02  4.86737726e-02]
 [ 3.59614166e-01 -4.99928216e-01  4.69535045e-01]
 [-4.20958505e-02 -5.06566734e-02  5.65250898e-02]
 [ 4.66260701e-01 -4.01530695e-01 -4.05867971e-01]
 [-1.33330042e-01  1.19159105e-01 -1.10011504e-01]
 [-6.24275115e-02  4.88311133e-02  5.38897581e-03]
 [-2.63695718e-01  2.92172835e-01  1.96032258e-01]
 [-1.17235406e-01  1.07531843e-01  2.44711367e-01]
 [-6.46465902e-03 -4.20360138e-02  2.19121948e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.6867633]
curr_Stock_Price:  99.27203158458417
curr_Factors:  [99.27203158 -1.42951004 -0.99847148]
mat_Sqrt:  [[ 8.75725375  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.0075042  0.03125574 0.13885273]
Stock Position:  0.007504201958077104
Bond Position:  [-4.43172068]


portfolio before change:  [-3.68203903]
curr_Stock_Price:  100.1969377981783
curr_Factors:  [100.1969378   -1.31066407  -0.98325981]
mat_Sqrt:  [[10.10685339  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03496738 -0.16135114  1.33945279]
Stock Position:  0.0349673802862275
Bond Position:  [-7.18566346]


portfolio before change:  [-3.71884075]
curr_Stock_Price:  99.2472532211476
curr_Factors:  [99.24725322 -1.54921004 -0.88763963]
mat_Sqrt:  [[ 8.67776985  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00471296 -0.01634937  0.16125035]
Stock Position:  -0.0047129580172470785
Bond Position:  [-3.25109261]


portfolio before change:  [-3.72303976]
curr_Stock_Price:  99.79320883152018
curr_Factors:  [99.79320883 -1.22783544 -0.93387295]
mat_Sqrt:  [[11.48901939  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0262382  -0.12959347 -1.15782835]
Stock Position:  0.026238195639473112
Bond Position:  [-6.3414335]


portfolio before change:  [-3.68984213]
curr_Stock_Price:  101.17932346265178
curr_Factors:  [101.17932346  -1.11339317  -0.89695369]
mat_Sqrt:  [[13.55218196  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00970049  0.03845844 -0.3138322 ]
Stock Position:  -0.009700489270537817
Bond Position:  [-2.70835319]


portfolio before change:  [-3.67408861]
curr_Stock_Price:  99.4156980606263
curr_Factors:  [99.41569806 -0.63494462 -0.90447177]
mat_Sqrt:  [[21.32528884  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0024084   0.01576017  0.01537325]
Stock Position:  -0.0024084026505763567
Bond Position:  [-3.43465558]


portfolio before change:  [-3.67896739]
curr_Stock_Price:  100.72819314212616
curr_Factors:  [100.72819314  -0.45950188  -0.88048787]
mat_Sqrt:  [[26.37551123  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00621945  0.09429838  0.55922547]
Stock Position:  -0.006219453679305732
Bond Position:  [-3.05249306]


portfolio before change:  [-3.69132305]
curr_Stock_Price:  102.4693478148373
curr_Factors:  [102.46934781  -0.55236317  -0.91324895]
mat_Sqrt:  [[23.66392154  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00191575  0.03470575  0.69809342]
Stock Position:  -0.0019157459557123753
Bond Position:  [-3.49501781]


portfolio before change:  [-3.69704898]
curr_Stock_Price:  104.54581639723138
curr_Factors:  [104.5458164   -0.79278264  -0.95563928]
mat_Sqrt:  [[18.19603086  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00058103 -0.01356707  0.06250939]
Stock Position:  -0.0005810287121114055
Bond Position:  [-3.63630486]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.6985726]
Stock Price:  104.03812013580162
PL:  [-7.73669273]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-7.14265298e-02  6.31997783e-02  5.17255934e-02]
 [ 4.87327642e-01 -6.14352771e-01  6.44428415e-01]
 [ 3.21295972e-03 -7.02477237e-02  9.15626315e-02]
 [ 4.76055699e-01 -4.16559226e-01 -3.91286947e-01]
 [-5.24235558e-02  5.13600411e-02  1.20744170e-01]
 [-5.90223222e-02  5.46407776e-02 -2.15832547e-02]
 [-1.97905983e-01  1.08706390e-01  1.78045013e-01]
 [-1.09055976e-01  6.48997312e-02  1.71794099e-01]
 [-6.92537736e-02 -5.63408778e-02  7.67821901e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.76204087]
curr_Stock_Price:  101.34599348425837
curr_Factors:  [101.34599348  -1.34147546  -1.01513737]
mat_Sqrt:  [[ 9.60157839  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00499579  0.02039764  0.14755872]
Stock Position:  -0.004995791794949279
Bond Position:  [13.26834436]


portfolio before change:  [12.76690479]
curr_Stock_Price:  101.70067517678788
curr_Factors:  [101.70067518  -0.87351167  -1.04189811]
mat_Sqrt:  [[14.97862465  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03294473 -0.1982815   1.83837489]
Stock Position:  0.032944734113339744
Bond Position:  [9.41640308]


portfolio before change:  [12.7009689]
curr_Stock_Price:  99.55631829510092
curr_Factors:  [99.5563183  -1.37041078 -1.05686941]
mat_Sqrt:  [[ 8.78849356  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00086065 -0.02267236  0.2612027 ]
Stock Position:  0.0008606534204922478
Bond Position:  [12.61528541]


portfolio before change:  [12.70825099]
curr_Stock_Price:  100.68670406718653
curr_Factors:  [100.68670407  -0.63893262  -1.05986938]
mat_Sqrt:  [[18.4158508   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01689603 -0.13444391 -1.11623275]
Stock Position:  0.016896031161296423
Bond Position:  [11.0070453]


portfolio before change:  [12.68548053]
curr_Stock_Price:  99.01321281712212
curr_Factors:  [99.01321282 -0.43377713 -1.02144182]
mat_Sqrt:  [[23.10466053  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00074846  0.01657638  0.34444951]
Stock Position:  -0.0007484607200250802
Bond Position:  [12.75958803]


portfolio before change:  [12.69204644]
curr_Stock_Price:  98.76667774988587
curr_Factors:  [98.76667775 -0.29227504 -1.03848338]
mat_Sqrt:  [[26.1017368   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00200272  0.01763524 -0.06157102]
Stock Position:  -0.0020027205070198796
Bond Position:  [12.88984849]


portfolio before change:  [12.69652725]
curr_Stock_Price:  99.74820693555723
curr_Factors:  [99.74820694 -0.64789985 -1.03988199]
mat_Sqrt:  [[18.44636331  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00755559  0.03508484  0.50791286]
Stock Position:  -0.007555586734930722
Bond Position:  [13.45018348]


portfolio before change:  [12.71115467]
curr_Stock_Price:  98.70253722364974
curr_Factors:  [98.70253722 -0.62090121 -1.06159208]
mat_Sqrt:  [[18.3497759   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00331018  0.0209463   0.49008075]
Stock Position:  -0.003310179405362285
Bond Position:  [13.03787777]


portfolio before change:  [12.71269145]
curr_Stock_Price:  100.20813240453323
curr_Factors:  [100.2081324   -0.96358195  -1.09403011]
mat_Sqrt:  [[12.80245935  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00508349 -0.01818394  0.21903822]
Stock Position:  -0.005083492665209284
Bond Position:  [13.22209875]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.71875859]
Stock Price:  100.3154521491985
PL:  [12.40330644]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 5.22115836e-03  5.50425876e-02  3.91699046e-02]
 [ 3.17555229e-01 -4.50437596e-01  4.47715364e-01]
 [-4.95117568e-01  4.03957578e-02 -3.94028108e-01]
 [ 1.31771436e-01 -1.31164939e-01 -6.60187892e-03]
 [ 4.01102035e-01 -2.21641907e-01  2.30630426e-01]
 [ 9.92327236e-02  5.40765218e-02 -2.29046061e-01]
 [-1.41582659e-01 -1.16312473e-01  2.02098366e-01]
 [-5.74345058e-02  7.06132652e-03  1.92430692e-01]
 [ 1.30948227e-01  8.84141527e-02  1.23894719e-01]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [28.10543887]
curr_Stock_Price:  103.28057927675287
curr_Factors:  [103.28057928  -0.40307364  -1.04367617]
mat_Sqrt:  [[24.30542424  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00100604 0.01776492 0.11174084]
Stock Position:  0.0010060389218579074
Bond Position:  [28.00153459]


portfolio before change:  [28.11539669]
curr_Stock_Price:  99.25842451194167
curr_Factors:  [99.25842451 -0.26474684 -1.10113012]
mat_Sqrt:  [[25.32646371  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01251653 -0.14537811  1.27720731]
Stock Position:  0.01251653445777532
Bond Position:  [26.8730252]


portfolio before change:  [28.08123747]
curr_Stock_Price:  95.4555268402582
curr_Factors:  [95.45552684 -0.48019521 -1.09761829]
mat_Sqrt:  [[19.70449831  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02879051  0.01303767 -1.12405252]
Stock Position:  -0.02879050559827772
Bond Position:  [30.82945035]


portfolio before change:  [28.20049904]
curr_Stock_Price:  91.8486784061495
curr_Factors:  [91.84867841 -0.14092757 -1.03769422]
mat_Sqrt:  [[28.2620702   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00366746 -0.0423333  -0.01883332]
Stock Position:  0.0036674561273811967
Bond Position:  [27.86364804]


portfolio before change:  [28.20773471]
curr_Stock_Price:  90.02189824994275
curr_Factors:  [90.02189825 -0.14691043 -0.98798756]
mat_Sqrt:  [[28.93798123  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01392415 -0.07153462  0.65792441]
Stock Position:  0.01392415061694527
Bond Position:  [26.95425624]


portfolio before change:  [28.25886103]
curr_Stock_Price:  92.72553339501552
curr_Factors:  [92.7255334  -0.21557928 -0.99348958]
mat_Sqrt:  [[27.6762604   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00229501  0.01745312 -0.65340466]
Stock Position:  0.002295007166632958
Bond Position:  [28.04605527]


portfolio before change:  [28.27361314]
curr_Stock_Price:  93.04168778500939
curr_Factors:  [93.04168779 -0.43017755 -0.93905859]
mat_Sqrt:  [[23.66060685  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00524381 -0.03753969  0.57653038]
Stock Position:  -0.005243808329014758
Bond Position:  [28.76150592]


portfolio before change:  [28.28341382]
curr_Stock_Price:  93.91579874418674
curr_Factors:  [93.91579874 -0.71502322 -0.97749171]
mat_Sqrt:  [[17.28577125  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00096689  0.00227903  0.5489512 ]
Stock Position:  -0.000966885879091898
Bond Position:  [28.37421968]


portfolio before change:  [28.29883386]
curr_Stock_Price:  92.64431197864717
curr_Factors:  [92.64431198 -0.53365332 -1.01281557]
mat_Sqrt:  [[19.73312441  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00883213 0.02853555 0.35343715]
Stock Position:  0.008832133725665273
Bond Position:  [27.48058691]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [28.32579241]
Stock Price:  94.1405329672272
PL:  [28.32579241]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 4.64711633e-02  9.95013773e-02  4.81452125e-02]
 [ 5.23069491e-01 -6.44803837e-01  6.92584907e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.09615075e-01 -4.53039353e-01 -3.66717774e-01]
 [-1.34639869e-01  9.89030167e-02 -6.72537090e-02]
 [-8.01608220e-02  7.47404824e-05  3.33802305e-02]
 [-3.16116364e-01  1.87543634e-01  2.51225862e-01]
 [-1.16247630e-01  1.19019810e-01  2.74901558e-01]
 [ 3.97212227e-03 -8.01312922e-03  9.67766616e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.89064153]
curr_Stock_Price:  99.49849717315776
curr_Factors:  [99.49849717 -0.629841   -0.96169786]
mat_Sqrt:  [[20.25909193  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00378148 0.03211393 0.13734489]
Stock Position:  0.003781482284587939
Bond Position:  [-2.26689334]


portfolio before change:  [-1.88182586]
curr_Stock_Price:  102.12958358452636
curr_Factors:  [102.12958358  -0.75749718  -0.95928157]
mat_Sqrt:  [[18.34695623  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02904148 -0.20810954  1.97575196]
Stock Position:  0.02904147990419194
Bond Position:  [-4.8478201]


portfolio before change:  [-1.94340028]
curr_Stock_Price:  100.09284488135155
curr_Factors:  [100.09284488  -0.67986068  -0.93231739]
mat_Sqrt:  [[19.96379007  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0017636  -0.02755111  0.34758667]
Stock Position:  0.0017635967758878812
Bond Position:  [-2.1199237]


portfolio before change:  [-1.94158807]
curr_Stock_Price:  101.72157987180212
curr_Factors:  [101.72157987  -0.59989357  -0.97497003]
mat_Sqrt:  [[21.06000771  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01625274 -0.14621782 -1.04614373]
Stock Position:  0.01625274106334737
Bond Position:  [-3.59484257]


portfolio before change:  [-1.92345454]
curr_Stock_Price:  102.94792081357842
curr_Factors:  [102.94792081  -0.19489794  -1.02650661]
mat_Sqrt:  [[30.35067283  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00422328  0.03192081 -0.19185611]
Stock Position:  -0.004223283022612196
Bond Position:  [-1.48867634]


portfolio before change:  [-1.92106294]
curr_Stock_Price:  102.20534126415447
curr_Factors:  [102.20534126  -0.23993705  -0.96593906]
mat_Sqrt:  [[30.60329948  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-2.39620747e-03  2.41223870e-05  9.52245064e-02]
Stock Position:  -0.0023962074656025574
Bond Position:  [-1.67615774]


portfolio before change:  [-1.92516272]
curr_Stock_Price:  103.56644685547367
curr_Factors:  [103.56644686  -0.51007558  -0.9702524 ]
mat_Sqrt:  [[23.5678955   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00961278  0.06052945  0.71667746]
Stock Position:  -0.009612776676640504
Bond Position:  [-0.9296016]


portfolio before change:  [-1.9107397]
curr_Stock_Price:  102.0176808497844
curr_Factors:  [102.01768085  -0.21102416  -0.99426804]
mat_Sqrt:  [[30.56495011  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00117254  0.03841348  0.78421763]
Stock Position:  -0.0011725446130562637
Bond Position:  [-1.79111942]


portfolio before change:  [-1.90618352]
curr_Stock_Price:  97.36800137460911
curr_Factors:  [97.36800137 -0.79303221 -1.02570011]
mat_Sqrt:  [[15.79613525  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.0013985  -0.00258623  0.27607688]
Stock Position:  0.001398500461989307
Bond Position:  [-2.04235272]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.91028207]
Stock Price:  95.16770450171124
PL:  [-1.91028207]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-7.95932970e-02  6.39245167e-02  5.19819369e-02]
 [ 4.89035157e-01 -6.53470020e-01  6.65637667e-01]
 [-4.32617196e-03 -7.82150282e-02  1.14929354e-01]
 [ 5.18626072e-01 -4.64852203e-01 -3.48277989e-01]
 [-1.39632123e-01  9.54371377e-02 -6.74156286e-02]
 [-5.95791840e-02 -5.12809967e-02 -2.83980744e-02]
 [-2.48198948e-01  8.91057302e-03  2.41900993e-01]
 [-1.17180176e-01  1.07854800e-01  2.45917859e-01]
 [-1.38992423e-02 -3.82249281e-02  4.69814859e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.80605855]
curr_Stock_Price:  101.85588699937828
curr_Factors:  [101.855887    -0.87010887  -1.02850718]
mat_Sqrt:  [[15.25554267  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00366647  0.02063155  0.14829   ]
Stock Position:  -0.0036664701129828906
Bond Position:  [17.17951011]


portfolio before change:  [16.81159636]
curr_Stock_Price:  102.68886475266643
curr_Factors:  [102.68886475  -0.81114366  -1.01298111]
mat_Sqrt:  [[16.56975281  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.02966362 -0.21090654  1.89887899]
Stock Position:  0.029663621001730738
Bond Position:  [13.7654728]


portfolio before change:  [16.7178537]
curr_Stock_Price:  99.29659110279623
curr_Factors:  [99.2965911  -0.67417362 -0.95477147]
mat_Sqrt:  [[19.47567309  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 1.62670032e-04 -2.52437918e-02  3.27861456e-01]
Stock Position:  0.00016267003229464294
Bond Position:  [16.70170112]


portfolio before change:  [16.72670296]
curr_Stock_Price:  102.3476611419887
curr_Factors:  [102.34766114  -0.32274245  -0.97739038]
mat_Sqrt:  [[27.88928693  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01264452 -0.1500304  -0.99354016]
Stock Position:  0.012644517137174056
Bond Position:  [15.4325662]


portfolio before change:  [16.76102657]
curr_Stock_Price:  104.45176673729773
curr_Factors:  [104.45176674  -1.08471392  -0.97586321]
mat_Sqrt:  [[13.30511136  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01006472  0.0308022  -0.19231802]
Stock Position:  -0.010064722695418972
Bond Position:  [17.81230464]


portfolio before change:  [16.77125056]
curr_Stock_Price:  104.32105104367523
curr_Factors:  [104.32105104  -1.10202597  -0.96505937]
mat_Sqrt:  [[13.20225741  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00574475 -0.01655087 -0.0810118 ]
Stock Position:  -0.005744745301317168
Bond Position:  [17.37054843]


portfolio before change:  [16.78040617]
curr_Stock_Price:  104.23955716883223
curr_Factors:  [104.23955717  -0.78171058  -0.95055291]
mat_Sqrt:  [[18.43826628  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01068442  0.00287588  0.6900762 ]
Stock Position:  -0.01068442380338376
Bond Position:  [17.89414578]


portfolio before change:  [16.78298966]
curr_Stock_Price:  104.83536115303771
curr_Factors:  [104.83536115  -0.56295208  -1.00752304]
mat_Sqrt:  [[21.8001318   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00206268  0.03480999  0.7015352 ]
Stock Position:  -0.0020626772026716127
Bond Position:  [16.99923117]


portfolio before change:  [16.79957428]
curr_Stock_Price:  100.91672546292169
curr_Factors:  [100.91672546  -0.15385147  -0.96766527]
mat_Sqrt:  [[32.87718454  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0003684  -0.01233704  0.1340251 ]
Stock Position:  -0.0003683958231860174
Bond Position:  [16.83675158]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.80702067]
Stock Price:  103.5608702736001
PL:  [13.2461504]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 3.28519413e-02  9.40594723e-02  4.85977246e-02]
 [ 4.07428639e-01 -5.39550869e-01  5.33398224e-01]
 [-8.55646330e-03 -5.86998433e-02  6.49563656e-02]
 [ 5.07283456e-01 -4.47601932e-01 -3.83495240e-01]
 [-1.35348749e-01  1.26569510e-01 -1.31864891e-01]
 [-8.57336121e-02  1.33534387e-02  4.20647965e-02]
 [-3.75953938e-02 -4.05738018e-01  2.35916516e-01]
 [-1.49909306e-01  6.28613030e-02  4.75296449e-02]
 [ 1.07988087e-02 -3.72804069e-02  1.65499013e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.70185848]
curr_Stock_Price:  99.82537481048463
curr_Factors:  [99.82537481 -0.79551915 -1.04770563]
mat_Sqrt:  [[15.8029656   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00392152 0.03035756 0.13863578]
Stock Position:  0.003921524684609423
Bond Position:  [0.31039081]


portfolio before change:  [0.70571579]
curr_Stock_Price:  100.76941437420969
curr_Factors:  [100.76941437  -1.17011799  -1.04514519]
mat_Sqrt:  [[10.99644127  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.03693674 -0.17413929  1.52163666]
Stock Position:  0.03693674397979659
Bond Position:  [-3.01637827]


portfolio before change:  [0.72574898]
curr_Stock_Price:  101.3526211147869
curr_Factors:  [101.35262111  -1.40335932  -1.0673765 ]
mat_Sqrt:  [[ 8.5665914   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00084974 -0.01894529  0.18530243]
Stock Position:  -0.0008497377430626375
Bond Position:  [0.81187213]


portfolio before change:  [0.72635744]
curr_Stock_Price:  101.11439967421616
curr_Factors:  [101.11439967  -1.50658712  -1.09729288]
mat_Sqrt:  [[ 7.48104538  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.04513226 -0.1444629  -1.09400517]
Stock Position:  0.04513225611936599
Bond Position:  [-3.83716354]


portfolio before change:  [0.727306]
curr_Stock_Price:  101.17793788474609
curr_Factors:  [101.17793788  -1.36741118  -1.07157993]
mat_Sqrt:  [[ 8.82765688  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0154548   0.04085013 -0.37617383]
Stock Position:  -0.015454799170871322
Bond Position:  [2.29099071]


portfolio before change:  [0.70430095]
curr_Stock_Price:  102.74061306327499
curr_Factors:  [102.74061306  -1.92977873  -1.12639395]
mat_Sqrt:  [[ 4.83574308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01538986  0.0043098   0.11999916]
Stock Position:  -0.01538986065839798
Bond Position:  [2.28546467]


portfolio before change:  [0.70894465]
curr_Stock_Price:  102.51314673170735
curr_Factors:  [102.51314673  -1.6771702   -1.10431991]
mat_Sqrt:  [[ 6.35029298  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01137901 -0.13095138  0.67300415]
Stock Position:  -0.011379012434731873
Bond Position:  [1.87544302]


portfolio before change:  [0.70020039]
curr_Stock_Price:  103.36403047148016
curr_Factors:  [103.36403047  -2.42414208  -1.07779249]
mat_Sqrt:  [[ 3.1152907   0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.04088731  0.0202884   0.13558885]
Stock Position:  -0.04088730722009082
Bond Position:  [4.92647726]


portfolio before change:  [0.7027024]
curr_Stock_Price:  103.36309711767166
curr_Factors:  [103.36309712  -1.72461339  -1.04760572]
mat_Sqrt:  [[ 6.46258182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00101619 -0.0120322   0.04721226]
Stock Position:  0.001016190152613625
Bond Position:  [0.59766584]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.70361905]
Stock Price:  103.97099820757013
PL:  [-3.26737915]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [ 7.30620113e-02  1.49836619e-01  5.14174216e-02]
 [ 3.46839828e-01 -5.29091815e-01  4.91198918e-01]
 [ 2.77616520e-02 -8.53640006e-02  1.21843878e-01]
 [ 5.32928124e-01 -4.84524663e-01 -2.82255153e-01]
 [-1.26651256e-01  7.05812508e-02  2.35161640e-02]
 [ 1.55914993e-02 -2.40117153e-01 -2.70315333e-01]
 [-5.25723593e-01 -2.81008994e-01  6.31944133e-01]
 [-1.17165680e-01  8.45444935e-02  1.92387067e-01]
 [-1.16836759e-02 -4.62211007e-02  1.55336469e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.00908074]
curr_Stock_Price:  98.97922015365877
curr_Factors:  [98.97922015 -0.6683536  -1.07296884]
mat_Sqrt:  [[17.34991308  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [0.00657887 0.04835956 0.14667959]
Stock Position:  0.00657886986599759
Bond Position:  [-6.66025215]


portfolio before change:  [-6.00757652]
curr_Stock_Price:  99.71417615742341
curr_Factors:  [99.71417616 -0.60591686 -1.07234906]
mat_Sqrt:  [[18.61638194  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01821541 -0.17076365  1.40125379]
Stock Position:  0.018215406945140157
Bond Position:  [-7.82391082]


portfolio before change:  [-5.96330238]
curr_Stock_Price:  102.35957807756122
curr_Factors:  [102.35957808  -0.96117525  -1.01943306]
mat_Sqrt:  [[14.12411436  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00249276 -0.02755111  0.34758667]
Stock Position:  0.0024927634323691755
Bond Position:  [-6.21846059]


portfolio before change:  [-5.96264398]
curr_Stock_Price:  103.87131749792974
curr_Factors:  [103.8713175   -0.32543446  -1.042397  ]
mat_Sqrt:  [[26.45172428  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01423007 -0.15637966 -0.80519539]
Stock Position:  0.01423006851976568
Bond Position:  [-7.44073995]


portfolio before change:  [-5.93636302]
curr_Stock_Price:  105.97968805280107
curr_Factors:  [105.97968805  -0.27976341  -1.05632825]
mat_Sqrt:  [[27.85899204  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0038567   0.02278     0.06708507]
Stock Position:  -0.0038566973665924873
Bond Position:  [-5.52763144]


portfolio before change:  [-5.95264536]
curr_Stock_Price:  109.48471664967748
curr_Factors:  [109.48471665  -0.57851473  -1.06082744]
mat_Sqrt:  [[21.25182532  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00416906 -0.07749748 -0.7711344 ]
Stock Position:  -0.004169058156004513
Bond Position:  [-5.49619721]


portfolio before change:  [-5.96681666]
curr_Stock_Price:  112.22454672775997
curr_Factors:  [112.22454673  -0.73384217  -1.05721505]
mat_Sqrt:  [[18.71723068  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.02426049 -0.09069526  1.80276071]
Stock Position:  -0.02426049374319349
Bond Position:  [-3.24419375]


portfolio before change:  [-5.86056369]
curr_Stock_Price:  107.77799789809897
curr_Factors:  [107.7779979   -1.08876702  -1.03030862]
mat_Sqrt:  [[12.94873236  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00468287  0.02728662  0.54882675]
Stock Position:  -0.00468287241555401
Bond Position:  [-5.35585308]


portfolio before change:  [-5.87064068]
curr_Stock_Price:  109.35788122007995
curr_Factors:  [109.35788122  -1.22175742  -1.04906344]
mat_Sqrt:  [[11.28873087  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00158988 -0.0149178   0.04431317]
Stock Position:  -0.0015898798850640487
Bond Position:  [-5.69677479]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.87550401]
Stock Price:  110.6247869604753
PL:  [-16.50029097]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 1.19290961e+02 -2.92808602e+01 -2.92872338e+01]
 [-3.57747351e-02  3.67002037e-02  4.70425911e-02]
 [ 2.63099351e-01 -2.89839550e-01  3.44392357e-01]
 [-2.14166314e-01  2.32929556e-02 -1.19762608e-01]
 [ 3.78212258e-01 -3.28344813e-01 -3.15508435e-01]
 [-6.95124220e-02  5.74155937e-02  5.83545456e-02]
 [-9.45816955e-02  3.44364202e-02  5.58535385e-02]
 [-5.15898921e-02 -3.19365364e-01  1.66076776e-01]
 [-1.14785614e-01  4.84791310e-02  1.17942912e-01]
 [-1.79711760e-03 -4.06170626e-02  2.08501489e-02]]
curr_Factors:  [100.  -1.  -1.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [119.29096094 -29.28086023 -29.28723381]
mat_Sqrt:  [[13.53352832  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [  7.93110239  -9.450357   -83.54832605]
init_Out:  [2.48224158]
Stock Position:  7.9311023879180595
Bond position:  [-790.62799721]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.93796863]
curr_Stock_Price:  100.86383198254107
curr_Factors:  [100.86383198  -0.76388279  -1.05138881]
mat_Sqrt:  [[16.41999505  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00113769  0.01184494  0.13419942]
Stock Position:  -0.0011376866182380488
Bond Position:  [9.05272007]


portfolio before change:  [8.9446773]
curr_Stock_Price:  98.94663575543284
curr_Factors:  [98.94663576 -0.95226262 -0.99175586]
mat_Sqrt:  [[14.16199823  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.01936414 -0.09354531  0.98245553]
Stock Position:  0.019364138561030718
Bond Position:  [7.02866093]


portfolio before change:  [8.93557873]
curr_Stock_Price:  98.29523722311248
curr_Factors:  [98.29523722 -1.13809442 -0.98885237]
mat_Sqrt:  [[11.71685953  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.01995911  0.00751777 -0.34164938]
Stock Position:  -0.01995911096336288
Bond Position:  [10.89746428]


portfolio before change:  [8.95118838]
curr_Stock_Price:  97.78621874215465
curr_Factors:  [97.78621874 -0.2609653  -1.01538408]
mat_Sqrt:  [[27.28765147  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [ 0.00904388 -0.10597283 -0.90005774]
Stock Position:  0.009043880673477132
Bond Position:  [8.06682149]


portfolio before change:  [8.97333633]
curr_Stock_Price:  99.78906801873453
curr_Factors:  [99.78906802 -0.53262274 -1.0623299 ]
mat_Sqrt:  [[20.24901182  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00226584  0.0185308   0.16646928]
Stock Position:  -0.0022658360663885975
Bond Position:  [9.199442]


portfolio before change:  [8.97472011]
curr_Stock_Price:  101.20889666828009
curr_Factors:  [101.20889667  -1.07054167  -1.11999669]
mat_Sqrt:  [[11.32087433  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00672663  0.01111431  0.1593346 ]
Stock Position:  -0.00672663017597627
Bond Position:  [9.65551492]


portfolio before change:  [8.98139506]
curr_Stock_Price:  100.93446659858816
curr_Factors:  [100.9344666   -1.22765282  -1.09066991]
mat_Sqrt:  [[ 9.93584305  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0083415  -0.10307473  0.47377081]
Stock Position:  -0.00834149590448063
Bond Position:  [9.8233395]


portfolio before change:  [8.97409221]
curr_Stock_Price:  102.39892141809057
curr_Factors:  [102.39892142  -1.44525341  -1.08020876]
mat_Sqrt:  [[ 8.19409689  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.00986257  0.01564657  0.3364583 ]
Stock Position:  -0.009862570352071326
Bond Position:  [9.98400878]


portfolio before change:  [8.97757288]
curr_Stock_Price:  102.5522876289053
curr_Factors:  [102.55228763  -1.75188721  -1.06245734]
mat_Sqrt:  [[ 6.14739395  0.          0.        ]
 [-0.63245553  3.09838668  0.        ]
 [-0.07155418  0.          0.35054244]]
grads:  [-0.0009487  -0.0131091   0.05947967]
Stock Position:  -0.0009486982635895676
Bond Position:  [9.07486406]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.98228342]
Stock Price:  102.3710104366603
PL:  [6.61127299]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  -0.04541885159583774
FINAL STD P&L:  9.13385516653307
